Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2F46649010
	for <lists+amd-gfx@lfdr.de>; Mon, 17 Jun 2019 21:46:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B39DC89E50;
	Mon, 17 Jun 2019 19:46:55 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qt1-x842.google.com (mail-qt1-x842.google.com
 [IPv6:2607:f8b0:4864:20::842])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E94B489ECD
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:46:53 +0000 (UTC)
Received: by mail-qt1-x842.google.com with SMTP id h21so12248742qtn.13
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 12:46:53 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=9tCoHv9MweuvXfF5FZWds81Owcf/F+O/NUrZ2/ISY1Q=;
 b=pX1fFV7VAQ1Yw7WOG4/IFwsJOdwIqdLMqAraGZnyGLaSE9QKmh+ao6Gv+12gkJlBUG
 I7sBw6tNKMMPB4/6s9/bZo/INhIcDcOnW8ED92nlvSKa11xSjwOjyp73eTCIo+/xBjTG
 Vtj+Ml6zwslqy9d9MmgA2w6vCZ+se1GSOYpHOGby3I0oKgPT/10lbAd5tirqfyh4h1PH
 GhIi98QocqQdpYhXAnVNPEy4fa2cZsBh/b7oYg7szgaZA3/WeMdhJhS0qECeACQ8mfI+
 XMTHTOTkhcuoWZSvnLGMiGDpZseGC73dcmYzu3+58i6f7vXyOT6QzvFvSMK+54cGo0y5
 CHtA==
X-Gm-Message-State: APjAAAVu0FbshoVGpFujGZxoBq96r69VTvVMJK1P6/DvFluJIGPN05Tc
 uL9W/whILhvE9UbDL9UGYAt4r6SRtMkgeQ==
X-Google-Smtp-Source: APXvYqyPwa3YrlUP605XSR0QRERb/bTz1WyNgWNSyCAi+7x1MjvPElEK6vY+t2tqOAeLX44HD3pnOg==
X-Received: by 2002:ac8:2cd1:: with SMTP id 17mr93465976qtx.356.1560800811914; 
 Mon, 17 Jun 2019 12:46:51 -0700 (PDT)
Received: from localhost.localdomain ([71.219.5.136])
 by smtp.gmail.com with ESMTPSA id u4sm6559420qkb.16.2019.06.17.12.46.50
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 12:46:51 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 354/459] drm/amd/display: fix pstate allow handling in dcn2
Date: Mon, 17 Jun 2019 14:44:55 -0500
Message-Id: <20190617194540.18497-55-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617194540.18497-1-alexander.deucher@amd.com>
References: <20190617194540.18497-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=9tCoHv9MweuvXfF5FZWds81Owcf/F+O/NUrZ2/ISY1Q=;
 b=Q5BAioWJT79b8Wy3QfLb8T9wZ8/iZbA8qB9/11LeR13LCe3THi26+BrLOzXoRjNY1I
 2qw8y1YllB8zVNw3EzOSzzLgeujcQtKLp9sAkDbXg6sxXxRktRqWa4TFDipEmLPevFVV
 +kXVWRg6ckTH9WCGSZPd7Rfd7ryU+DO8uk3vfwHmDIkAjbjcqej0M3Wf0H+UQ+IGigne
 KLl9U21IBnI6lmmYW8gbHAhnxIDSfo9LU7f/vrWgiKWLAyfHkpgU7omS5io+sTomIrDy
 14eizMR2bawE8Cc3RWgzfu/Wc1ZXqGrMFy6vGGaHz28Ejh+9znM+8ok6NMjrkiX6e0pC
 oJRg==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Dmytro Laktyushkin <Dmytro.Laktyushkin@amd.com>,
 Leo Li <sunpeng.li@amd.com>, Alex Deucher <alexander.deucher@amd.com>,
 Jun Lei <Jun.Lei@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogSnVuIExlaSA8SnVuLkxlaUBhbWQuY29tPgoKW3doeV0KcHN0YXRlIGFsbG93L2Jsb2Nr
IGlzIG5vdCBiZWluZyBoYW5kbGVkIHByb3Blcmx5IG9uIERDTjIKCltob3ddCkRNTCBuZWVkcyB0
byBiZSB1cGRhdGVkIHRvIGNhbGN1bGF0ZSBwc3RhdGUgc3VwcG9ydCBhdCBib3RoIG1pbiBhbmQg
bWF4Cm1wYyBjb21iaW5lIHJhdGhlciB0aGFuIGp1c3QgbWluCmNsb2NrIG1hbmFnZXIgbmVlZHMg
dG8gdXBkYXRlIGN1cnJlbnQgdG8gbmV3IHBzdGF0ZSBzdXBwb3J0IGJlZm9yZQpzZW5kaW5nIHRv
IHBwbGliL3NtdQoKU2lnbmVkLW9mZi1ieTogSnVuIExlaSA8SnVuLkxlaUBhbWQuY29tPgpSZXZp
ZXdlZC1ieTogRG15dHJvIExha3R5dXNoa2luIDxEbXl0cm8uTGFrdHl1c2hraW5AYW1kLmNvbT4K
QWNrZWQtYnk6IExlbyBMaSA8c3VucGVuZy5saUBhbWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBBbGV4
IERldWNoZXIgPGFsZXhhbmRlci5kZXVjaGVyQGFtZC5jb20+Ci0tLQogLi4uL2RybS9hbWQvZGlz
cGxheS9kYy9jbGtfbWdyL2RjbjIwL2RjbjIwX2Nsa19tZ3IuYyB8ICA3ICsrKysrLS0KIC4uLi9h
bWQvZGlzcGxheS9kYy9kbWwvZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMC5jICAgfCAxMiArKysr
LS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgOSBpbnNlcnRpb25zKCspLCAxMCBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xrX21nci9k
Y24yMC9kY24yMF9jbGtfbWdyLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xr
X21nci9kY24yMC9kY24yMF9jbGtfbWdyLmMKaW5kZXggNTgxNGNhY2JlMWJlLi4zNDQwMmRmZmQy
Y2EgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9jbGtfbWdyL2Rj
bjIwL2RjbjIwX2Nsa19tZ3IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMv
Y2xrX21nci9kY24yMC9kY24yMF9jbGtfbWdyLmMKQEAgLTE5MSwxMCArMTkxLDEzIEBAIHZvaWQg
ZGNuMl91cGRhdGVfY2xvY2tzKHN0cnVjdCBjbGtfbWdyICpjbGtfbWdyX2Jhc2UsCiAJCQlwcF9z
bXUtPnNldF9oYXJkX21pbl9zb2NjbGtfYnlfZnJlcSgmcHBfc211LT5wcF9zbXUsIGNsa19tZ3Jf
YmFzZS0+Y2xrcy5zb2NjbGtfa2h6IC8gMTAwMCk7CiAJfQogCi0JaWYgKCFzYWZlX3RvX2xvd2Vy
ICYmIHBwX3NtdSAmJiBwcF9zbXUtPnNldF9wc3RhdGVfaGFuZHNoYWtlX3N1cHBvcnQpCisJaWYg
KCFzYWZlX3RvX2xvd2VyICYmIHBwX3NtdSAmJiBwcF9zbXUtPnNldF9wc3RhdGVfaGFuZHNoYWtl
X3N1cHBvcnQpIHsKKwkJY2xrX21ncl9iYXNlLT5jbGtzLnBfc3RhdGVfY2hhbmdlX3N1cHBvcnQg
PSBmYWxzZTsKIAkJcHBfc211LT5zZXRfcHN0YXRlX2hhbmRzaGFrZV9zdXBwb3J0KCZwcF9zbXUt
PnBwX3NtdSwgZmFsc2UpOwotCWVsc2UgaWYgKHNhZmVfdG9fbG93ZXIgJiYgcHBfc211ICYmIHBw
X3NtdS0+c2V0X3BzdGF0ZV9oYW5kc2hha2Vfc3VwcG9ydCkKKwl9IGVsc2UgaWYgKHNhZmVfdG9f
bG93ZXIgJiYgcHBfc211ICYmIHBwX3NtdS0+c2V0X3BzdGF0ZV9oYW5kc2hha2Vfc3VwcG9ydCkg
eworCQljbGtfbWdyX2Jhc2UtPmNsa3MucF9zdGF0ZV9jaGFuZ2Vfc3VwcG9ydCA9IG5ld19jbG9j
a3MtPnBfc3RhdGVfY2hhbmdlX3N1cHBvcnQ7CiAJCXBwX3NtdS0+c2V0X3BzdGF0ZV9oYW5kc2hh
a2Vfc3VwcG9ydCgmcHBfc211LT5wcF9zbXUsIGNsa19tZ3JfYmFzZS0+Y2xrcy5wX3N0YXRlX2No
YW5nZV9zdXBwb3J0KTsKKwl9CiAKIAlpZiAoc2hvdWxkX3NldF9jbG9jayhzYWZlX3RvX2xvd2Vy
LCBuZXdfY2xvY2tzLT5kcmFtY2xrX2toeiwgY2xrX21ncl9iYXNlLT5jbGtzLmRyYW1jbGtfa2h6
KSkgewogCQljbGtfbWdyX2Jhc2UtPmNsa3MuZHJhbWNsa19raHogPSBuZXdfY2xvY2tzLT5kcmFt
Y2xrX2toejsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwv
ZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2RtbC9kY24yMC9kaXNwbGF5X21vZGVfdmJhXzIwLmMKaW5kZXggYjdlZGIzOWNkOTAyLi4y
MWQ5MGM2ZjNjODggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
bWwvZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kbWwvZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMC5jCkBAIC0yNTkyLDggKzI1
OTIsOSBAQCBzdGF0aWMgdm9pZCBkbWwyMF9ESVNQQ0xLRFBQQ0xLRENGQ0xLRGVlcFNsZWVwUHJl
ZmV0Y2hQYXJhbWV0ZXJzV2F0ZXJtYXJrc0FuZFBlcgogCQkJbW9kZV9saWItPnZiYS5EUkFNQ2xv
Y2tDaGFuZ2VTdXBwb3J0WzBdWzBdID0gZG1fZHJhbV9jbG9ja19jaGFuZ2VfdW5zdXBwb3J0ZWQ7
CiAJCX0KIAl9Ci0JZm9yIChrID0gMTsgayA8PSBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVz
OyBrKyspCi0JCW1vZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFtrXVswXSA9IG1v
ZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFswXVswXTsKKwlmb3IgKGsgPSAwOyBr
IDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7IGsrKykKKwkJZm9yIChqID0gMDsgaiA8
IDI7IGorKykKKwkJCW1vZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFtrXVtqXSA9
IG1vZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFswXVswXTsKIAogCS8vWEZDIFBh
cmFtZXRlcnM6CiAJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXM7ICsraykgewpAQCAtNTA2MSwxMiArNTA2Miw3IEBAIHZvaWQgZG1sMjBfTW9kZVN1cHBv
cnRBbmRTeXN0ZW1Db25maWd1cmF0aW9uRnVsbChzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9k
ZV9sCiAJCQlpZiAobG9jYWxzLT5Nb2RlU3VwcG9ydFtpXVswXSA9PSB0cnVlIHx8IGxvY2Fscy0+
TW9kZVN1cHBvcnRbaV1bMV0gPT0gdHJ1ZSkgewogCQkJCW1vZGVfbGliLT52YmEuVm9sdGFnZUxl
dmVsID0gaTsKIAkJCQlpZiAobG9jYWxzLT5Nb2RlU3VwcG9ydFtpXVsxXSA9PSB0cnVlICYmIChs
b2NhbHMtPk1vZGVTdXBwb3J0W2ldWzBdID09IGZhbHNlCi0JCQkJCQl8fCBtb2RlX2xpYi0+dmJh
LldoZW5Ub0RvTVBDQ29tYmluZSA9PSBkbV9tcGNfYWx3YXlzX3doZW5fcG9zc2libGUKLQkJCQkJ
CXx8IChtb2RlX2xpYi0+dmJhLldoZW5Ub0RvTVBDQ29tYmluZSA9PSBkbV9tcGNfcmVkdWNlX3Zv
bHRhZ2VfYW5kX2Nsb2NrcwotCQkJCQkJCSYmICgobG9jYWxzLT5EUkFNQ2xvY2tDaGFuZ2VTdXBw
b3J0W2ldWzFdID09IGRtX2RyYW1fY2xvY2tfY2hhbmdlX3ZhY3RpdmUKLQkJCQkJCQkJJiYgbG9j
YWxzLT5EUkFNQ2xvY2tDaGFuZ2VTdXBwb3J0W2ldWzBdICE9IGRtX2RyYW1fY2xvY2tfY2hhbmdl
X3ZhY3RpdmUpCi0JCQkJCQkJfHwgKGxvY2Fscy0+RFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFtpXVsx
XSA9PSBkbV9kcmFtX2Nsb2NrX2NoYW5nZV92YmxhbmsKLQkJCQkJCQkJJiYgbG9jYWxzLT5EUkFN
Q2xvY2tDaGFuZ2VTdXBwb3J0W2ldWzBdID09IGRtX2RyYW1fY2xvY2tfY2hhbmdlX3Vuc3VwcG9y
dGVkKSkpKSkgeworCQkJCQkJfHwgbW9kZV9saWItPnZiYS5XaGVuVG9Eb01QQ0NvbWJpbmUgPT0g
ZG1fbXBjX2Fsd2F5c193aGVuX3Bvc3NpYmxlKSkgewogCQkJCQlNYXhpbXVtTVBDQ29tYmluZSA9
IDE7CiAJCQkJfSBlbHNlIHsKIAkJCQkJTWF4aW11bU1QQ0NvbWJpbmUgPSAwOwotLSAKMi4yMC4x
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4
IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
