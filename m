Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id AB53110D184
	for <lists+amd-gfx@lfdr.de>; Fri, 29 Nov 2019 07:43:16 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F34A16E891;
	Fri, 29 Nov 2019 06:43:14 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM04-CO1-obe.outbound.protection.outlook.com
 (mail-eopbgr690061.outbound.protection.outlook.com [40.107.69.61])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8E6F56E891
 for <amd-gfx@lists.freedesktop.org>; Fri, 29 Nov 2019 06:43:13 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=V4/nySpPVYT69TXzUlPtMXnqrhdgKjlD5p6pX9yJeJ0fBE7QXlNYZadlVhfj0BIcT6KH2lQf3DjucD5J7EQQqMvNG2sHrKaC9zAfeIdbE2KXhycWUmg8CHoHBqvmW9orq1j0EQComDMH7JC7J+rgQ5jv10KTStmg9nUnsDZSGAtUkRaOwI9dAHnugSnvwIGE2nQM4pmrGFD1V3GMV5Zu1jOuqZTjRj3TcKZQoqHJ3GkDqwU7dSbZwWymYxgPpvlDeYFw0pX9ekbM5S2egwJt7u+NaDbOArywNmT8FPpXv/SfVCs3/G0vc+/lQIkPJ/bRJ3q+ALYqIVUXE7ujDCkUIQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=oumSNh+uhE7VxtWzKg9XZI+Uyg4upYW7KC37tp7gSJ8=;
 b=T5syCPa+6rUrzDeULHAstYFCNU/n2K/1x6NiYyaYVQ0a2RAYP/1dCMMl6qcAroSf69+srC20rTyglyr7nGpGXNiNzPdikYg6YOpwgsbtG52S9uQdLYk7gtim0e+7Kk5Zj9/dchNizvrL4hZ2SU7OVCyvAfBB/ukMYAljD2jcJcAQ3IC1B667LO4VRaSU98bwWlaPQ+1cLQFv+Vur4Ou1VZScFwDjanqhFafhrRhK6qdm32SZenyv+3yBLXuo8zQAdyGO6/9YNhcsVLoh4Qqg3bfANyT4qq7HMn9HkcQoXALVt0vTVezraU0egQZiJe2kVEqn104eB5Yn6cNEK/aL/Q==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from MN2PR12MB3933.namprd12.prod.outlook.com (10.255.236.82) by
 MN2PR12MB3551.namprd12.prod.outlook.com (20.179.83.30) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2495.17; Fri, 29 Nov 2019 06:43:11 +0000
Received: from MN2PR12MB3933.namprd12.prod.outlook.com
 ([fe80::411d:b54b:4cfe:ee5]) by MN2PR12MB3933.namprd12.prod.outlook.com
 ([fe80::411d:b54b:4cfe:ee5%3]) with mapi id 15.20.2474.023; Fri, 29 Nov 2019
 06:43:11 +0000
From: "Liu, Monk" <Monk.Liu@amd.com>
To: "Yuan, Xiaojie" <Xiaojie.Yuan@amd.com>, "amd-gfx@lists.freedesktop.org"
 <amd-gfx@lists.freedesktop.org>, "Koenig, Christian"
 <Christian.Koenig@amd.com>, "Deucher, Alexander" <Alexander.Deucher@amd.com>, 
 "Zhang, Hawking" <Hawking.Zhang@amd.com>
Subject: RE: [PATCH] drm/amdgpu: fix calltrace during kmd unload(v2)
Thread-Topic: [PATCH] drm/amdgpu: fix calltrace during kmd unload(v2)
Thread-Index: AQHVpbksiGWmgoAiuUKrlE1C0eBCKKehsbYAgAADNDA=
Date: Fri, 29 Nov 2019 06:43:11 +0000
Message-ID: <MN2PR12MB393313A4BC6C78EEECA7429584460@MN2PR12MB3933.namprd12.prod.outlook.com>
References: <1574924274-23221-1-git-send-email-Monk.Liu@amd.com>
 <MN2PR12MB30870DE444CD767A90607EDE89460@MN2PR12MB3087.namprd12.prod.outlook.com>
In-Reply-To: <MN2PR12MB30870DE444CD767A90607EDE89460@MN2PR12MB3087.namprd12.prod.outlook.com>
Accept-Language: en-US, zh-CN
Content-Language: en-US
X-Mentions: Christian.Koenig@amd.com, Alexander.Deucher@amd.com,
 Hawking.Zhang@amd.com
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
msip_labels: MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_Enabled=True;
 MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_SiteId=3dd8961f-e488-4e60-8e11-a82d994e183d;
 MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_SetDate=2019-11-29T06:31:05.672Z;
 MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_Name=Internal
 Distribution
 Only; MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_ContentBits=0;
 MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_Method=Standard; 
x-originating-ip: [180.167.199.189]
x-ms-publictraffictype: Email
x-ms-office365-filtering-ht: Tenant
x-ms-office365-filtering-correlation-id: 59c8f46f-8599-43f4-f264-08d77497675b
x-ms-traffictypediagnostic: MN2PR12MB3551:|MN2PR12MB3551:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <MN2PR12MB35516F04C414B9C2B9D8383C84460@MN2PR12MB3551.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:8882;
x-forefront-prvs: 0236114672
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(346002)(366004)(39860400002)(136003)(396003)(376002)(199004)(189003)(43544003)(13464003)(74316002)(316002)(110136005)(6246003)(966005)(229853002)(76116006)(33656002)(3846002)(66476007)(6116002)(66446008)(86362001)(256004)(14444005)(2501003)(446003)(478600001)(11346002)(66556008)(76176011)(6436002)(7696005)(305945005)(25786009)(66946007)(7736002)(6306002)(55016002)(186003)(8676002)(9686003)(64756008)(102836004)(52536014)(6636002)(26005)(8936002)(99286004)(66066001)(53546011)(45080400002)(5660300002)(6506007)(71200400001)(81156014)(14454004)(81166006)(2906002)(71190400001);
 DIR:OUT; SFP:1101; SCL:1; SRVR:MN2PR12MB3551;
 H:MN2PR12MB3933.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: CYvwpsQmjY9EmCN6aJkpADg2gIIq04R10U2WVV8PiBeUdle/MmXmlA8kqwf0aFZSWy/D4rxctb4dbSVFwpCnJ2tWV29OJwTvq9X56NjeaSR/X/KNnGv2c9t5ooHGY5GdKM96ihJmNxppCcHGlAz2b9mlYPy3HkzMF39jTbFQmSXbzoFfOFwVlddkPQGFPmf6KUAQNt56tJStjZcLpl5k7lu+8ja4W1B+9V9RTTviXE9+P7DCKe3NrO5c0c3bkZMbIEwThoE2ZtAS3FLfVrmGmb3/0dMVIGACWKm4Bri5cbX/F576gWiqz8qrigQwP9PM1XlhTNhWqMENmqZ2LX68DKLCrT4FgcLYOysRPMU24rFVfR7KJIgpyuvUtnkPTuqwG+HICEMk5FehIPZpzWb8atCh+fnjhH/Z5wWRgovrx8J5fS8QmKYzx6pBD/ALbmgaUn+OtyKM4MNqb3CJycs38H15rIBhN4kjdNg7OeqmcWE=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 59c8f46f-8599-43f4-f264-08d77497675b
X-MS-Exchange-CrossTenant-originalarrivaltime: 29 Nov 2019 06:43:11.7238 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 07AEYOroZ9W6RBEP4KauAz7k1A+sWR1wFNZ4QSOzQ3THCtsF+g87SuTV8tgBVMDw
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR12MB3551
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=oumSNh+uhE7VxtWzKg9XZI+Uyg4upYW7KC37tp7gSJ8=;
 b=DvDHlmChvDyf41E+wjwudwTrYJSvtkkuco60gtPhbW6XbdFEcioa89QHGQvZn6r7CR5J1DiMFd0yOKsS99dniU7zhZWC1CSo7KfKIMpzEAvqs79K4PPgwIvniQ9CTMEyO9d/jMGeQONStquDl8/8U0gngPB7PH2agmJMnP8NltQ=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Monk.Liu@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QEtvZW5pZywgQ2hyaXN0aWFuIEBEZXVjaGVyLCBBbGV4YW5kZXJAWmhhbmcsIEhhd2tpbmcKCkNh
biB5b3UgZ3V5cyBoZWxwIHRvIHJldmlldyB0aGUgcGF0Y2ggZm9yIG1lID8gdGhhbmtzIGZvciBY
aWFvamllIHdobyBoZWxwZWQgdG8gdmVyaWZ5IHRoZSBTMyBpc3N1ZSB0ZXN0aW5nIGFnYWluc3Qg
dGhpcyBwYXRjaCAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTW9uayBM
aXV8R1BVIFZpcnR1YWxpemF0aW9uIFRlYW0gfEFNRAoKCi0tLS0tT3JpZ2luYWwgTWVzc2FnZS0t
LS0tCkZyb206IFl1YW4sIFhpYW9qaWUgPFhpYW9qaWUuWXVhbkBhbWQuY29tPiAKU2VudDogRnJp
ZGF5LCBOb3ZlbWJlciAyOSwgMjAxOSAyOjMxIFBNClRvOiBMaXUsIE1vbmsgPE1vbmsuTGl1QGFt
ZC5jb20+OyBhbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpTdWJqZWN0OiBSZTogW1BBVENI
XSBkcm0vYW1kZ3B1OiBmaXggY2FsbHRyYWNlIGR1cmluZyBrbWQgdW5sb2FkKHYyKQoKW0FNRCBP
ZmZpY2lhbCBVc2UgT25seSAtIEludGVybmFsIERpc3RyaWJ1dGlvbiBPbmx5XQoKVGVzdGVkIG9u
IG5hdmkxNCBhbmQgczMvYmFjbyB3b3JrcyBmaW5lIHdpdGggcGF0Y2ggYXBwbGllZC4KClJldmll
d2VkLWJ5OiBYaWFvamllIFl1YW4gPHhpYW9qaWUueXVhbkBhbWQuY29tPgoKQlIsClhpYW9qaWUK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KRnJvbTogYW1kLWdmeCA8
YW1kLWdmeC1ib3VuY2VzQGxpc3RzLmZyZWVkZXNrdG9wLm9yZz4gb24gYmVoYWxmIG9mIE1vbmsg
TGl1IDxNb25rLkxpdUBhbWQuY29tPgpTZW50OiBUaHVyc2RheSwgTm92ZW1iZXIgMjgsIDIwMTkg
Mjo1NyBQTQpUbzogYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKQ2M6IExpdSwgTW9uawpT
dWJqZWN0OiBbUEFUQ0hdIGRybS9hbWRncHU6IGZpeCBjYWxsdHJhY2UgZHVyaW5nIGttZCB1bmxv
YWQodjIpCgprZXJuZWwgd291bGQgcmVwb3J0IGEgd2FybmluZyBvbiBkb3VibGUgdW5waW4gb24g
dGhlIGNzYiBCTyBiZWNhdXNlIHdlIHVucGluIGl0IGR1cmluZyBod19maW5pIGJ1dCBhY3R1YWxs
eSB3ZSBkb24ndCBuZWVkIHRvIHBpbi91bnBpbiBpdCBkdXJpbmcgaHdfaW5pdC9maW5pIHNpbmNl
IGl0IGlzIGNyZWF0ZWQgd2l0aCBrZXJuZWwgcGlubmVkCgp2MjoKZ2V0X2NzYiBpbiBpbml0X3Js
YyBzbyBod19pbml0KCkgd2lsbCBtYWtlIENTSUIgY29udGVudCBiYWNrIGV2ZW4gYWZ0ZXIgcmVz
ZXQgb3IgczMuCnRha2UgY2FyZSBvZiBnZng3LzggYXMgd2VsbAoKdjM6CnVzZSBib19jcmVhdGVf
a2VybmVsIGluc3RlYWQgb2YgYm9fY3JlYXRlX3Jlc2VydmVkIGZvciBDU0Igb3RoZXJ3aXNlIHRo
ZSBib19mcmVlX2tlcm5lbCgpIG9uIENTQiBpcyBub3QgYWxpZ25lZCBhbmQgd291bGQgbGVkIHRv
IGl0cyBpbnRlcm5hbCByZXNlcnZlIHBlbmRpbmcgdGhlcmUgZm9yZXZlcgoKU2lnbmVkLW9mZi1i
eTogTW9uayBMaXUgPE1vbmsuTGl1QGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3JsYy5jIHwgMTAgKy0tLS0tICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9nZnhfdjEwXzAuYyAgfCA1OCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIGRy
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92N18wLmMgICB8ICAyICsrCiBkcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9nZnhfdjhfMC5jICAgfCA0MCArLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYyAgIHwgNDAgKy0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0KIDUgZmlsZXMgY2hhbmdlZCwgNiBpbnNlcnRpb25zKCspLCAxNDQgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3JsYy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3JsYy5jCmluZGV4IGM4
NzkzZTYuLjYzNzNiZmIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9ybGMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmxjLmMK
QEAgLTEyNCwxMyArMTI0LDEyIEBAIGludCBhbWRncHVfZ2Z4X3JsY19pbml0X3NyKHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2LCB1MzIgZHdzKQogICovCiBpbnQgYW1kZ3B1X2dmeF9ybGNfaW5p
dF9jc2Ioc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpICB7Ci0gICAgICAgdm9sYXRpbGUgdTMy
ICpkc3RfcHRyOwogICAgICAgIHUzMiBkd3M7CiAgICAgICAgaW50IHI7CgogICAgICAgIC8qIGFs
bG9jYXRlIGNsZWFyIHN0YXRlIGJsb2NrICovCiAgICAgICAgYWRldi0+Z2Z4LnJsYy5jbGVhcl9z
dGF0ZV9zaXplID0gZHdzID0gYWRldi0+Z2Z4LnJsYy5mdW5jcy0+Z2V0X2NzYl9zaXplKGFkZXYp
OwotICAgICAgIHIgPSBhbWRncHVfYm9fY3JlYXRlX3Jlc2VydmVkKGFkZXYsIGR3cyAqIDQsIFBB
R0VfU0laRSwKKyAgICAgICByID0gYW1kZ3B1X2JvX2NyZWF0ZV9rZXJuZWwoYWRldiwgZHdzICog
NCwgUEFHRV9TSVpFLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFNREdQ
VV9HRU1fRE9NQUlOX1ZSQU0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
JmFkZXYtPmdmeC5ybGMuY2xlYXJfc3RhdGVfb2JqLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICZhZGV2LT5nZngucmxjLmNsZWFyX3N0YXRlX2dwdV9hZGRyLApAQCAtMTQx
LDEzICsxNDAsNiBAQCBpbnQgYW1kZ3B1X2dmeF9ybGNfaW5pdF9jc2Ioc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYpCiAgICAgICAgICAgICAgICByZXR1cm4gcjsKICAgICAgICB9CgotICAgICAg
IC8qIHNldCB1cCB0aGUgY3MgYnVmZmVyICovCi0gICAgICAgZHN0X3B0ciA9IGFkZXYtPmdmeC5y
bGMuY3NfcHRyOwotICAgICAgIGFkZXYtPmdmeC5ybGMuZnVuY3MtPmdldF9jc2JfYnVmZmVyKGFk
ZXYsIGRzdF9wdHIpOwotICAgICAgIGFtZGdwdV9ib19rdW5tYXAoYWRldi0+Z2Z4LnJsYy5jbGVh
cl9zdGF0ZV9vYmopOwotICAgICAgIGFtZGdwdV9ib191bnBpbihhZGV2LT5nZngucmxjLmNsZWFy
X3N0YXRlX29iaik7Ci0gICAgICAgYW1kZ3B1X2JvX3VucmVzZXJ2ZShhZGV2LT5nZngucmxjLmNs
ZWFyX3N0YXRlX29iaik7Ci0KICAgICAgICByZXR1cm4gMDsKIH0KCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2dmeF92MTBfMC5jCmluZGV4IDczNzI5MDQuLjc3MDNiMjUgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92MTBfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2dmeF92MTBfMC5jCkBAIC05OTEsMzkgKzk5MSw2IEBAIHN0YXRpYyBpbnQg
Z2Z4X3YxMF8wX3JsY19pbml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogICAgICAgIHJl
dHVybiAwOwogfQoKLXN0YXRpYyBpbnQgZ2Z4X3YxMF8wX2NzYl92cmFtX3BpbihzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldikgLXsKLSAgICAgICBpbnQgcjsKLQotICAgICAgIHIgPSBhbWRncHVf
Ym9fcmVzZXJ2ZShhZGV2LT5nZngucmxjLmNsZWFyX3N0YXRlX29iaiwgZmFsc2UpOwotICAgICAg
IGlmICh1bmxpa2VseShyICE9IDApKQotICAgICAgICAgICAgICAgcmV0dXJuIHI7Ci0KLSAgICAg
ICByID0gYW1kZ3B1X2JvX3BpbihhZGV2LT5nZngucmxjLmNsZWFyX3N0YXRlX29iaiwKLSAgICAg
ICAgICAgICAgICAgICAgICAgQU1ER1BVX0dFTV9ET01BSU5fVlJBTSk7Ci0gICAgICAgaWYgKCFy
KQotICAgICAgICAgICAgICAgYWRldi0+Z2Z4LnJsYy5jbGVhcl9zdGF0ZV9ncHVfYWRkciA9Ci0g
ICAgICAgICAgICAgICAgICAgICAgIGFtZGdwdV9ib19ncHVfb2Zmc2V0KGFkZXYtPmdmeC5ybGMu
Y2xlYXJfc3RhdGVfb2JqKTsKLQotICAgICAgIGFtZGdwdV9ib191bnJlc2VydmUoYWRldi0+Z2Z4
LnJsYy5jbGVhcl9zdGF0ZV9vYmopOwotCi0gICAgICAgcmV0dXJuIHI7Ci19Ci0KLXN0YXRpYyB2
b2lkIGdmeF92MTBfMF9jc2JfdnJhbV91bnBpbihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikg
LXsKLSAgICAgICBpbnQgcjsKLQotICAgICAgIGlmICghYWRldi0+Z2Z4LnJsYy5jbGVhcl9zdGF0
ZV9vYmopCi0gICAgICAgICAgICAgICByZXR1cm47Ci0KLSAgICAgICByID0gYW1kZ3B1X2JvX3Jl
c2VydmUoYWRldi0+Z2Z4LnJsYy5jbGVhcl9zdGF0ZV9vYmosIHRydWUpOwotICAgICAgIGlmIChs
aWtlbHkociA9PSAwKSkgewotICAgICAgICAgICAgICAgYW1kZ3B1X2JvX3VucGluKGFkZXYtPmdm
eC5ybGMuY2xlYXJfc3RhdGVfb2JqKTsKLSAgICAgICAgICAgICAgIGFtZGdwdV9ib191bnJlc2Vy
dmUoYWRldi0+Z2Z4LnJsYy5jbGVhcl9zdGF0ZV9vYmopOwotICAgICAgIH0KLX0KLQogc3RhdGlj
IHZvaWQgZ2Z4X3YxMF8wX21lY19maW5pKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KSAgewog
ICAgICAgIGFtZGdwdV9ib19mcmVlX2tlcm5lbCgmYWRldi0+Z2Z4Lm1lYy5ocGRfZW9wX29iaiwg
TlVMTCwgTlVMTCk7IEBAIC0xNzg1LDI1ICsxNzUyLDcgQEAgc3RhdGljIHZvaWQgZ2Z4X3YxMF8w
X2VuYWJsZV9ndWlfaWRsZV9pbnRlcnJ1cHQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCgog
c3RhdGljIGludCBnZnhfdjEwXzBfaW5pdF9jc2Ioc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYp
ICB7Ci0gICAgICAgaW50IHI7Ci0KLSAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KSB7Ci0g
ICAgICAgICAgICAgICByID0gYW1kZ3B1X2JvX3Jlc2VydmUoYWRldi0+Z2Z4LnJsYy5jbGVhcl9z
dGF0ZV9vYmosIGZhbHNlKTsKLSAgICAgICAgICAgICAgIGlmIChyKQotICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gcjsKLQotICAgICAgICAgICAgICAgciA9IGFtZGdwdV9ib19rbWFwKGFk
ZXYtPmdmeC5ybGMuY2xlYXJfc3RhdGVfb2JqLAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICh2b2lkICoqKSZhZGV2LT5nZngucmxjLmNzX3B0cik7Ci0gICAgICAgICAgICAgICBp
ZiAoIXIpIHsKLSAgICAgICAgICAgICAgICAgICAgICAgYWRldi0+Z2Z4LnJsYy5mdW5jcy0+Z2V0
X2NzYl9idWZmZXIoYWRldiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGFkZXYtPmdmeC5ybGMuY3NfcHRyKTsKLSAgICAgICAgICAgICAgICAgICAgICAgYW1kZ3B1X2Jv
X2t1bm1hcChhZGV2LT5nZngucmxjLmNsZWFyX3N0YXRlX29iaik7Ci0gICAgICAgICAgICAgICB9
Ci0KLSAgICAgICAgICAgICAgIGFtZGdwdV9ib191bnJlc2VydmUoYWRldi0+Z2Z4LnJsYy5jbGVh
cl9zdGF0ZV9vYmopOwotICAgICAgICAgICAgICAgaWYgKHIpCi0gICAgICAgICAgICAgICAgICAg
ICAgIHJldHVybiByOwotICAgICAgIH0KKyAgICAgICBhZGV2LT5nZngucmxjLmZ1bmNzLT5nZXRf
Y3NiX2J1ZmZlcihhZGV2LCBhZGV2LT5nZngucmxjLmNzX3B0cik7CgogICAgICAgIC8qIGNzaWIg
Ki8KICAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tUkxDX0NTSUJfQUREUl9ISSwgQEAgLTM3
NzQsMTAgKzM3MjMsNiBAQCBzdGF0aWMgaW50IGdmeF92MTBfMF9od19pbml0KHZvaWQgKmhhbmRs
ZSkKICAgICAgICBpbnQgcjsKICAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhhbmRsZTsKCi0gICAgICAgciA9IGdmeF92MTBfMF9jc2Jf
dnJhbV9waW4oYWRldik7Ci0gICAgICAgaWYgKHIpCi0gICAgICAgICAgICAgICByZXR1cm4gcjsK
LQogICAgICAgIGlmICghYW1kZ3B1X2VtdV9tb2RlKQogICAgICAgICAgICAgICAgZ2Z4X3YxMF8w
X2luaXRfZ29sZGVuX3JlZ2lzdGVycyhhZGV2KTsKCkBAIC0zODY1LDcgKzM4MTAsNiBAQCBzdGF0
aWMgaW50IGdmeF92MTBfMF9od19maW5pKHZvaWQgKmhhbmRsZSkKICAgICAgICB9CiAgICAgICAg
Z2Z4X3YxMF8wX2NwX2VuYWJsZShhZGV2LCBmYWxzZSk7CiAgICAgICAgZ2Z4X3YxMF8wX2VuYWJs
ZV9ndWlfaWRsZV9pbnRlcnJ1cHQoYWRldiwgZmFsc2UpOwotICAgICAgIGdmeF92MTBfMF9jc2Jf
dnJhbV91bnBpbihhZGV2KTsKCiAgICAgICAgcmV0dXJuIDA7CiB9CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjdfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvZ2Z4X3Y3XzAuYwppbmRleCA0M2FlOGZjLi42NDhkNzY3IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjdfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2dmeF92N18wLmMKQEAgLTQ1NTQsNiArNDU1NCw4IEBAIHN0YXRpYyBpbnQgZ2Z4
X3Y3XzBfaHdfaW5pdCh2b2lkICpoYW5kbGUpCgogICAgICAgIGdmeF92N18wX2NvbnN0YW50c19p
bml0KGFkZXYpOwoKKyAgICAgICAvKiBpbml0IENTQiAqLworICAgICAgIGFkZXYtPmdmeC5ybGMu
ZnVuY3MtPmdldF9jc2JfYnVmZmVyKGFkZXYsIGFkZXYtPmdmeC5ybGMuY3NfcHRyKTsKICAgICAg
ICAvKiBpbml0IHJsYyAqLwogICAgICAgIHIgPSBhZGV2LT5nZngucmxjLmZ1bmNzLT5yZXN1bWUo
YWRldik7CiAgICAgICAgaWYgKHIpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nZnhfdjhfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y4XzAuYwpp
bmRleCA4MGI3OTU4Li4zM2M0ZWU5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nZnhfdjhfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OF8w
LmMKQEAgLTEzMjEsMzkgKzEzMjEsNiBAQCBzdGF0aWMgaW50IGdmeF92OF8wX3JsY19pbml0KHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogICAgICAgIHJldHVybiAwOwogfQoKLXN0YXRpYyBp
bnQgZ2Z4X3Y4XzBfY3NiX3ZyYW1fcGluKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KSAtewot
ICAgICAgIGludCByOwotCi0gICAgICAgciA9IGFtZGdwdV9ib19yZXNlcnZlKGFkZXYtPmdmeC5y
bGMuY2xlYXJfc3RhdGVfb2JqLCBmYWxzZSk7Ci0gICAgICAgaWYgKHVubGlrZWx5KHIgIT0gMCkp
Ci0gICAgICAgICAgICAgICByZXR1cm4gcjsKLQotICAgICAgIHIgPSBhbWRncHVfYm9fcGluKGFk
ZXYtPmdmeC5ybGMuY2xlYXJfc3RhdGVfb2JqLAotICAgICAgICAgICAgICAgICAgICAgICBBTURH
UFVfR0VNX0RPTUFJTl9WUkFNKTsKLSAgICAgICBpZiAoIXIpCi0gICAgICAgICAgICAgICBhZGV2
LT5nZngucmxjLmNsZWFyX3N0YXRlX2dwdV9hZGRyID0KLSAgICAgICAgICAgICAgICAgICAgICAg
YW1kZ3B1X2JvX2dwdV9vZmZzZXQoYWRldi0+Z2Z4LnJsYy5jbGVhcl9zdGF0ZV9vYmopOwotCi0g
ICAgICAgYW1kZ3B1X2JvX3VucmVzZXJ2ZShhZGV2LT5nZngucmxjLmNsZWFyX3N0YXRlX29iaik7
Ci0KLSAgICAgICByZXR1cm4gcjsKLX0KLQotc3RhdGljIHZvaWQgZ2Z4X3Y4XzBfY3NiX3ZyYW1f
dW5waW4oc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpIC17Ci0gICAgICAgaW50IHI7Ci0KLSAg
ICAgICBpZiAoIWFkZXYtPmdmeC5ybGMuY2xlYXJfc3RhdGVfb2JqKQotICAgICAgICAgICAgICAg
cmV0dXJuOwotCi0gICAgICAgciA9IGFtZGdwdV9ib19yZXNlcnZlKGFkZXYtPmdmeC5ybGMuY2xl
YXJfc3RhdGVfb2JqLCB0cnVlKTsKLSAgICAgICBpZiAobGlrZWx5KHIgPT0gMCkpIHsKLSAgICAg
ICAgICAgICAgIGFtZGdwdV9ib191bnBpbihhZGV2LT5nZngucmxjLmNsZWFyX3N0YXRlX29iaik7
Ci0gICAgICAgICAgICAgICBhbWRncHVfYm9fdW5yZXNlcnZlKGFkZXYtPmdmeC5ybGMuY2xlYXJf
c3RhdGVfb2JqKTsKLSAgICAgICB9Ci19Ci0KIHN0YXRpYyB2b2lkIGdmeF92OF8wX21lY19maW5p
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KSAgewogICAgICAgIGFtZGdwdV9ib19mcmVlX2tl
cm5lbCgmYWRldi0+Z2Z4Lm1lYy5ocGRfZW9wX29iaiwgTlVMTCwgTlVMTCk7IEBAIC0zOTE2LDYg
KzM4ODMsNyBAQCBzdGF0aWMgdm9pZCBnZnhfdjhfMF9lbmFibGVfZ3VpX2lkbGVfaW50ZXJydXB0
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAoKIHN0YXRpYyB2b2lkIGdmeF92OF8wX2luaXRf
Y3NiKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KSAgeworICAgICAgIGFkZXYtPmdmeC5ybGMu
ZnVuY3MtPmdldF9jc2JfYnVmZmVyKGFkZXYsIGFkZXYtPmdmeC5ybGMuY3NfcHRyKTsKICAgICAg
ICAvKiBjc2liICovCiAgICAgICAgV1JFRzMyKG1tUkxDX0NTSUJfQUREUl9ISSwKICAgICAgICAg
ICAgICAgICAgICAgICAgYWRldi0+Z2Z4LnJsYy5jbGVhcl9zdGF0ZV9ncHVfYWRkciA+PiAzMik7
IEBAIC00ODM2LDEwICs0ODA0LDYgQEAgc3RhdGljIGludCBnZnhfdjhfMF9od19pbml0KHZvaWQg
KmhhbmRsZSkKICAgICAgICBnZnhfdjhfMF9pbml0X2dvbGRlbl9yZWdpc3RlcnMoYWRldik7CiAg
ICAgICAgZ2Z4X3Y4XzBfY29uc3RhbnRzX2luaXQoYWRldik7CgotICAgICAgIHIgPSBnZnhfdjhf
MF9jc2JfdnJhbV9waW4oYWRldik7Ci0gICAgICAgaWYgKHIpCi0gICAgICAgICAgICAgICByZXR1
cm4gcjsKLQogICAgICAgIHIgPSBhZGV2LT5nZngucmxjLmZ1bmNzLT5yZXN1bWUoYWRldik7CiAg
ICAgICAgaWYgKHIpCiAgICAgICAgICAgICAgICByZXR1cm4gcjsKQEAgLTQ5NTcsOCArNDkyMSw2
IEBAIHN0YXRpYyBpbnQgZ2Z4X3Y4XzBfaHdfZmluaSh2b2lkICpoYW5kbGUpCiAgICAgICAgICAg
ICAgICBwcl9lcnIoInJsYyBpcyBidXN5LCBza2lwIGhhbHQgcmxjXG4iKTsKICAgICAgICBhbWRn
cHVfZ2Z4X3JsY19leGl0X3NhZmVfbW9kZShhZGV2KTsKCi0gICAgICAgZ2Z4X3Y4XzBfY3NiX3Zy
YW1fdW5waW4oYWRldik7Ci0KICAgICAgICByZXR1cm4gMDsKIH0KCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvZ2Z4X3Y5XzAuYwppbmRleCBlOTA1YWM1Li42YTI1MWEzIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2dmeF92OV8wLmMKQEAgLTE2ODUsMzkgKzE2ODUsNiBAQCBzdGF0aWMgaW50IGdm
eF92OV8wX3JsY19pbml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogICAgICAgIHJldHVy
biAwOwogfQoKLXN0YXRpYyBpbnQgZ2Z4X3Y5XzBfY3NiX3ZyYW1fcGluKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2KSAtewotICAgICAgIGludCByOwotCi0gICAgICAgciA9IGFtZGdwdV9ib19y
ZXNlcnZlKGFkZXYtPmdmeC5ybGMuY2xlYXJfc3RhdGVfb2JqLCBmYWxzZSk7Ci0gICAgICAgaWYg
KHVubGlrZWx5KHIgIT0gMCkpCi0gICAgICAgICAgICAgICByZXR1cm4gcjsKLQotICAgICAgIHIg
PSBhbWRncHVfYm9fcGluKGFkZXYtPmdmeC5ybGMuY2xlYXJfc3RhdGVfb2JqLAotICAgICAgICAg
ICAgICAgICAgICAgICBBTURHUFVfR0VNX0RPTUFJTl9WUkFNKTsKLSAgICAgICBpZiAoIXIpCi0g
ICAgICAgICAgICAgICBhZGV2LT5nZngucmxjLmNsZWFyX3N0YXRlX2dwdV9hZGRyID0KLSAgICAg
ICAgICAgICAgICAgICAgICAgYW1kZ3B1X2JvX2dwdV9vZmZzZXQoYWRldi0+Z2Z4LnJsYy5jbGVh
cl9zdGF0ZV9vYmopOwotCi0gICAgICAgYW1kZ3B1X2JvX3VucmVzZXJ2ZShhZGV2LT5nZngucmxj
LmNsZWFyX3N0YXRlX29iaik7Ci0KLSAgICAgICByZXR1cm4gcjsKLX0KLQotc3RhdGljIHZvaWQg
Z2Z4X3Y5XzBfY3NiX3ZyYW1fdW5waW4oc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpIC17Ci0g
ICAgICAgaW50IHI7Ci0KLSAgICAgICBpZiAoIWFkZXYtPmdmeC5ybGMuY2xlYXJfc3RhdGVfb2Jq
KQotICAgICAgICAgICAgICAgcmV0dXJuOwotCi0gICAgICAgciA9IGFtZGdwdV9ib19yZXNlcnZl
KGFkZXYtPmdmeC5ybGMuY2xlYXJfc3RhdGVfb2JqLCB0cnVlKTsKLSAgICAgICBpZiAobGlrZWx5
KHIgPT0gMCkpIHsKLSAgICAgICAgICAgICAgIGFtZGdwdV9ib191bnBpbihhZGV2LT5nZngucmxj
LmNsZWFyX3N0YXRlX29iaik7Ci0gICAgICAgICAgICAgICBhbWRncHVfYm9fdW5yZXNlcnZlKGFk
ZXYtPmdmeC5ybGMuY2xlYXJfc3RhdGVfb2JqKTsKLSAgICAgICB9Ci19Ci0KIHN0YXRpYyB2b2lk
IGdmeF92OV8wX21lY19maW5pKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KSAgewogICAgICAg
IGFtZGdwdV9ib19mcmVlX2tlcm5lbCgmYWRldi0+Z2Z4Lm1lYy5ocGRfZW9wX29iaiwgTlVMTCwg
TlVMTCk7IEBAIC0yNDA1LDYgKzIzNzIsNyBAQCBzdGF0aWMgdm9pZCBnZnhfdjlfMF9lbmFibGVf
Z3VpX2lkbGVfaW50ZXJydXB0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAoKIHN0YXRpYyB2
b2lkIGdmeF92OV8wX2luaXRfY3NiKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KSAgeworICAg
ICAgIGFkZXYtPmdmeC5ybGMuZnVuY3MtPmdldF9jc2JfYnVmZmVyKGFkZXYsIGFkZXYtPmdmeC5y
bGMuY3NfcHRyKTsKICAgICAgICAvKiBjc2liICovCiAgICAgICAgV1JFRzMyX1JMQyhTT0MxNV9S
RUdfT0ZGU0VUKEdDLCAwLCBtbVJMQ19DU0lCX0FERFJfSEkpLAogICAgICAgICAgICAgICAgICAg
ICAgICBhZGV2LT5nZngucmxjLmNsZWFyX3N0YXRlX2dwdV9hZGRyID4+IDMyKTsgQEAgLTM2OTYs
MTAgKzM2NjQsNiBAQCBzdGF0aWMgaW50IGdmeF92OV8wX2h3X2luaXQodm9pZCAqaGFuZGxlKQoK
ICAgICAgICBnZnhfdjlfMF9jb25zdGFudHNfaW5pdChhZGV2KTsKCi0gICAgICAgciA9IGdmeF92
OV8wX2NzYl92cmFtX3BpbihhZGV2KTsKLSAgICAgICBpZiAocikKLSAgICAgICAgICAgICAgIHJl
dHVybiByOwotCiAgICAgICAgciA9IGFkZXYtPmdmeC5ybGMuZnVuY3MtPnJlc3VtZShhZGV2KTsK
ICAgICAgICBpZiAocikKICAgICAgICAgICAgICAgIHJldHVybiByOwpAQCAtMzc4MSw4ICszNzQ1
LDYgQEAgc3RhdGljIGludCBnZnhfdjlfMF9od19maW5pKHZvaWQgKmhhbmRsZSkKICAgICAgICBn
ZnhfdjlfMF9jcF9lbmFibGUoYWRldiwgZmFsc2UpOwogICAgICAgIGFkZXYtPmdmeC5ybGMuZnVu
Y3MtPnN0b3AoYWRldik7CgotICAgICAgIGdmeF92OV8wX2NzYl92cmFtX3VucGluKGFkZXYpOwot
CiAgICAgICAgcmV0dXJuIDA7CiB9CgotLQoyLjcuNAoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9uYW0xMS5zYWZlbGlua3MucHJvdGVjdGlvbi5vdXRs
b29rLmNvbS8/dXJsPWh0dHBzJTNBJTJGJTJGbGlzdHMuZnJlZWRlc2t0b3Aub3JnJTJGbWFpbG1h
biUyRmxpc3RpbmZvJTJGYW1kLWdmeCZhbXA7ZGF0YT0wMiU3QzAxJTdDWGlhb2ppZS5ZdWFuJTQw
YW1kLmNvbSU3QzQ3NzNjZTE3MTg5ZjRmYTgzYWFmMDhkNzczZDA1MWEwJTdDM2RkODk2MWZlNDg4
NGU2MDhlMTFhODJkOTk0ZTE4M2QlN0MwJTdDMCU3QzYzNzEwNTIxMDg3Mzc4NDE1NCZhbXA7c2Rh
dGE9T09yM1VLZEhsMFB5MHNZbXNOWDJ0NVVUNEUxZmJ4S2pSSHh6WmV5VXRjOCUzRCZhbXA7cmVz
ZXJ2ZWQ9MAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
YW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
