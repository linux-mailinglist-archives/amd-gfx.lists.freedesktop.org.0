Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 23EBD21C1DF
	for <lists+amd-gfx@lfdr.de>; Sat, 11 Jul 2020 05:26:22 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C49F16E28E;
	Sat, 11 Jul 2020 03:26:18 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM11-CO1-obe.outbound.protection.outlook.com
 (mail-co1nam11on2072.outbound.protection.outlook.com [40.107.220.72])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9261D6E28E
 for <amd-gfx@lists.freedesktop.org>; Sat, 11 Jul 2020 03:26:17 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=MZZ2TOxAF9thTb7FCqKgm7wslk1ouJCTPCdU7EMLWEakAAn9aZiKxbq0yVP5hjw/R7qABs66zvr+nwUwZPLo/QFHtEal6vNCPo36cRXkUS3WNiOvdKGaZnAP56nRPlgmy2F8uEbxiJAG3ZvX9G2exru9SIiEiNLEiIgXHCGBjoWP1OwlSUhwXHfHqjsR70cCeUT8qdzIFX6El6Ma9WR7Zp5ivN6JG3x9syunSNcl+E+2p+oNUQX2egBkN5lnDqstT+8B3RYnQeoVSAsaaKOZzdjkaUE7phhiazJJDWmxzCEj8gnwnrSFTr1v+KYTCdnOV1uaUL1nnHwInyXkwmjV+A==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=6m9ebGiTnP6wmYOtZDRuNu8iLRzHqJkB6h7HL1hRGG8=;
 b=UHu4mcQTAdaa7rpXREfZettKQlshJq2ysWBhOBrXc3PHgUyq4tjwfnvon93r1eKmtKrqU5g4YhMnHnWuN0RflAgSHLnp40EWRs+gTdsROGc/4RfJbUVEt6+DM+60PU7CLrEf+Tpga7wgcOfJKykhDWIOuQbYZO0ZfkH4JgI2ieIY/MgyjMZLUCuMYFYBuAsNbq9D7VtvKOkU8Iu8gWtUuoI1qeFL8+7rcJeLadEJBnqnYqQTiYVToK80D0OI+/dmuaP6YOUxPS2X9fiZCmoeioMZcBUepb9lgiccBHqscDhhOXf8c8O58yg3LzjyaUG+8wID49JsLZEdQZeaUUOnrA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=6m9ebGiTnP6wmYOtZDRuNu8iLRzHqJkB6h7HL1hRGG8=;
 b=Wyawgi10gDEzTQ03cGiDrQ3XMB3P0lC3nKmCKJ0FExLHjYTQ6AmvW0QjK72PKrsB+U5u4tEhabCHdQp3jVdkWtK1I4l8Fl6KY2/vHZckre12AMAJ3NHzm4kM4jUP7MsjtxinEOjTcOJn1iROkz/JnMsxOLjB+Y86X1xUaM66g34=
Received: from DM5PR12MB2533.namprd12.prod.outlook.com (2603:10b6:4:b0::10) by
 DM5PR12MB2533.namprd12.prod.outlook.com (2603:10b6:4:b0::10) with
 Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.3174.20; Sat, 11 Jul 2020 03:26:11 +0000
Received: from DM5PR12MB2533.namprd12.prod.outlook.com
 ([fe80::2d85:c08d:4782:e3a]) by DM5PR12MB2533.namprd12.prod.outlook.com
 ([fe80::2d85:c08d:4782:e3a%7]) with mapi id 15.20.3174.024; Sat, 11 Jul 2020
 03:26:11 +0000
From: "Li, Dennis" <Dennis.Li@amd.com>
To: "Grodzovsky, Andrey" <Andrey.Grodzovsky@amd.com>,
 "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>, "Deucher,
 Alexander" <Alexander.Deucher@amd.com>, "Zhou1, Tao" <Tao.Zhou1@amd.com>,
 "Zhang, Hawking" <Hawking.Zhang@amd.com>, "Chen, Guchun"
 <Guchun.Chen@amd.com>, "Koenig, Christian" <Christian.Koenig@amd.com>
Subject: RE: [PATCH v2] drm/amdgpu: fix system hang issue during GPU reset
Thread-Topic: [PATCH v2] drm/amdgpu: fix system hang issue during GPU reset
Thread-Index: AQHWVPw2uPUSRy+wOEGvOPUoL/1b2qkA7cgAgAAgtjCAAA3VgIAAZYsw
Date: Sat, 11 Jul 2020 03:26:10 +0000
Message-ID: <DM5PR12MB25339F0B05F9605DBA9286D3ED620@DM5PR12MB2533.namprd12.prod.outlook.com>
References: <20200708074800.10093-1-Dennis.Li@amd.com>
 <9b37bb53-1579-9a68-3317-e51f4e38f26f@amd.com>
 <DM5PR12MB25331941DBCCFBE97F1C99A8ED650@DM5PR12MB2533.namprd12.prod.outlook.com>
 <66c807cd-b3a4-a66d-a31d-7947419ab7f9@amd.com>
In-Reply-To: <66c807cd-b3a4-a66d-a31d-7947419ab7f9@amd.com>
Accept-Language: zh-CN, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
msip_labels: MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_Enabled=true;
 MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_SetDate=2020-07-11T03:26:02Z; 
 MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_Method=Standard;
 MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_Name=Internal Use Only -
 Unrestricted;
 MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_SiteId=3dd8961f-e488-4e60-8e11-a82d994e183d;
 MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_ActionId=7000e8f5-0d09-4f17-91bf-ce6fbd660ae1;
 MSIP_Label_76546daa-41b6-470c-bb85-f6f40f044d7f_ContentBits=1
msip_justification: I confirm the recipients are approved for sharing this
 content
authentication-results: amd.com; dkim=none (message not signed)
 header.d=none;amd.com; dmarc=none action=none header.from=amd.com;
x-originating-ip: [180.167.199.185]
x-ms-publictraffictype: Email
x-ms-office365-filtering-ht: Tenant
x-ms-office365-filtering-correlation-id: 2beb1dca-2f04-4988-9399-08d8254a28c4
x-ms-traffictypediagnostic: DM5PR12MB2533:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <DM5PR12MB253321EC2E8382F8F2953D94ED620@DM5PR12MB2533.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:5516;
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: 9lOwauxPjWTqwAreFI6JRK6A6fyCPaEPSVpZA6p7guJvIMnC6w1OkLimb5GPadIvagKqai6ew0ttnpLcOWbY3aetGdtTElpUi6XxOhWOPFgzeZFSdIlLeQ9l1lCzOHYvlvn4odnIlumSq8e4rtp+NnnGms8ROtI0JD/ndcHru+jOpry6QKapcynJuTktPn+VaNjVhjSiQ3xpG2kL6I2rm8ciemCQxeaZC/VwSAqFA8n5cnGDRwMdRJjLCT40u6kaWChoqM/GTGnwpjN3KtuFre/HbXX5/sNW9Ca2Q++uoE+W0qr85kXhzkhte1LvutHVL+v68LLXiKmJjKmRQVzkZ1j0hwq2bO/KinQAfeS/IIipKAcuab6IBnVf9itpzRil
x-forefront-antispam-report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:DM5PR12MB2533.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFTY:;
 SFS:(4636009)(396003)(346002)(376002)(366004)(136003)(39860400002)(478600001)(83380400001)(26005)(71200400001)(7696005)(5660300002)(8676002)(6636002)(33656002)(6506007)(86362001)(8936002)(53546011)(76116006)(52536014)(64756008)(66476007)(66556008)(66946007)(66446008)(9686003)(110136005)(55016002)(316002)(2906002)(186003)(921003)(559001)(579004);
 DIR:OUT; SFP:1101; 
x-ms-exchange-antispam-messagedata: wc5+6Bs9wHHRKbCVM1a4Rr0yNlaQhXHytuYh7b/tIpM1Tx+2NSN+7MhEaZL4THvSRu9De84jOysMo9dEIzkfwH6/Sz0VJL+QbDqbTxKbqQgFvR7cOMLtuqt0Iu9zA4Su+NHlsW7GROw7sPFIqQhgKX1rc+yl4Y1GuKy2x286LPIKu9VmjxNIQWA+QhpWlSGtKhvK57CN5349KqNa2SQMuVlbCjndoVHQURhPUEXl7ujdZSVDzBnTdQQpjRd+AanxcOJlt3z1vedpAb27UoduhFn7UOmLnIpCvDlIcmFk85bcibuNPEwLwX2mvuvloOqcNA5xr54CgnJdUMykbehmgoOmRunNfFv5XaR6kQcPPqgPfEvsk+ANBoYyFgeXkEZ/PsE7rqCMQuuFEXpygXembPzV2mAOqOmciicKhxZ+Qfy4+0IoBiFBQsxj8t3cxffUcx5mrOqSZvjzniPUbBsxnnzIeZWXMHj23YLkqc6SY19esGaJTlsUHCNJcJM57EZ3
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: DM5PR12MB2533.namprd12.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 2beb1dca-2f04-4988-9399-08d8254a28c4
X-MS-Exchange-CrossTenant-originalarrivaltime: 11 Jul 2020 03:26:11.1276 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: jffAuBHggYiiGCa8aWN/ZuXHtaKZN5Ve0vPwXiGs5Ap6fWOSRJPXkjlXt/LhxOhv
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM5PR12MB2533
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

W0FNRCBPZmZpY2lhbCBVc2UgT25seSAtIEludGVybmFsIERpc3RyaWJ1dGlvbiBPbmx5XQ0KDQoN
Cg0KLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCkZyb206IEdyb2R6b3Zza3ksIEFuZHJleSA8
QW5kcmV5Lkdyb2R6b3Zza3lAYW1kLmNvbT4gDQpTZW50OiBTYXR1cmRheSwgSnVseSAxMSwgMjAy
MCAxOjU0IEFNDQpUbzogTGksIERlbm5pcyA8RGVubmlzLkxpQGFtZC5jb20+OyBhbWQtZ2Z4QGxp
c3RzLmZyZWVkZXNrdG9wLm9yZzsgRGV1Y2hlciwgQWxleGFuZGVyIDxBbGV4YW5kZXIuRGV1Y2hl
ckBhbWQuY29tPjsgWmhvdTEsIFRhbyA8VGFvLlpob3UxQGFtZC5jb20+OyBaaGFuZywgSGF3a2lu
ZyA8SGF3a2luZy5aaGFuZ0BhbWQuY29tPjsgQ2hlbiwgR3VjaHVuIDxHdWNodW4uQ2hlbkBhbWQu
Y29tPjsgS29lbmlnLCBDaHJpc3RpYW4gPENocmlzdGlhbi5Lb2VuaWdAYW1kLmNvbT4NClN1Ympl
Y3Q6IFJlOiBbUEFUQ0ggdjJdIGRybS9hbWRncHU6IGZpeCBzeXN0ZW0gaGFuZyBpc3N1ZSBkdXJp
bmcgR1BVIHJlc2V0DQoNCg0KT24gNy8xMC8yMCAxOjI0IFBNLCBMaSwgRGVubmlzIHdyb3RlOg0K
PiBbQU1EIE9mZmljaWFsIFVzZSBPbmx5IC0gSW50ZXJuYWwgRGlzdHJpYnV0aW9uIE9ubHldDQo+
DQo+IEhpLCBBbmRyZXksDQo+ICAgICAgICBQbGVhc2Ugc2VlIG15IGJlbG93IGNvbW1lbnRzLg0K
Pg0KPiBCZXN0IFJlZ2FyZHMNCj4gRGVubmlzIExpDQo+IC0tLS0tT3JpZ2luYWwgTWVzc2FnZS0t
LS0tDQo+IEZyb206IEdyb2R6b3Zza3ksIEFuZHJleSA8QW5kcmV5Lkdyb2R6b3Zza3lAYW1kLmNv
bT4NCj4gU2VudDogRnJpZGF5LCBKdWx5IDEwLCAyMDIwIDExOjA4IFBNDQo+IFRvOiBMaSwgRGVu
bmlzIDxEZW5uaXMuTGlAYW1kLmNvbT47IGFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnOyBE
ZXVjaGVyLCBBbGV4YW5kZXIgPEFsZXhhbmRlci5EZXVjaGVyQGFtZC5jb20+OyBaaG91MSwgVGFv
IDxUYW8uWmhvdTFAYW1kLmNvbT47IFpoYW5nLCBIYXdraW5nIDxIYXdraW5nLlpoYW5nQGFtZC5j
b20+OyBDaGVuLCBHdWNodW4gPEd1Y2h1bi5DaGVuQGFtZC5jb20+OyBLb2VuaWcsIENocmlzdGlh
biA8Q2hyaXN0aWFuLktvZW5pZ0BhbWQuY29tPg0KPiBTdWJqZWN0OiBSZTogW1BBVENIIHYyXSBk
cm0vYW1kZ3B1OiBmaXggc3lzdGVtIGhhbmcgaXNzdWUgZHVyaW5nIEdQVSByZXNldA0KPg0KPg0K
PiBPbiA3LzgvMjAgMzo0OCBBTSwgRGVubmlzIExpIHdyb3RlOg0KPj4gRHVyaW5nIEdQVSByZXNl
dCwgZHJpdmVyIHNob3VsZCBob2xkIG9uIGFsbCBleHRlcm5hbCBhY2Nlc3MgdG8NCj4+IEdQVSwg
b3RoZXJ3aXNlIHBzcCB3aWxsIHJhbmRvbWx5IGZhaWwgdG8gZG8gcG9zdCwgYW5kIHRoZW4gY2F1
c2UNCj4+IHN5c3RlbSBoYW5nLg0KPj4NCj4+IHYyOg0KPj4gMS4gYWRkIHJ3bG9jayBmb3Igc29t
ZSBpb2N0bHMsIGRlYnVnZnMgYW5kIGZpbGUtY2xvc2UgZnVuY3Rpb24uDQo+PiAyLiBjaGFuZ2Ug
dG8gdXNlIGRxbS0+aXNfcmVzZXR0aW5nIGFuZCBkcW1fbG9jayBmb3IgcHJvdGVjdGlvbiBpbiBr
ZmQNCj4+IGRyaXZlci4NCj4+IDMuIHJlbW92ZSB0cnlfbG9jayBhbmQgY2hhbmdlIGFkZXYtPmlu
X2dwdV9yZXNldCBhcyBhdG9taWMsIHRvIGF2b2lkDQo+PiByZS1lbnRlciBHUFUgcmVjb3Zlcnkg
Zm9yIHRoZSBzYW1lIEdQVSBoYW5nLg0KPg0KPiBTdGlsbCBhZGV2LT5pbl9ncHVfcmVzZXQgaXMg
cHJvbmUgdG8gcmFjZSwgbm8gPyBJIG1lYW4gaWYgdGhlIHJlc2V0IHN0YXJ0cyByaWdodCBBRlRF
UiB3ZSBjaGVja2VkIGZvciB0aGUgZmxhZyB2YWx1ZSB0aGVuIHdlIHN0aWxsIGhhdmUgYSBwcm9i
bGVtLg0KPiBbRGVubmlzXTogcmlnaHQsIGFkZXYtPmluX2dwdV9yZXNldCBjYW4ndCBzb2x2ZSBy
YWNlIGlzc3VlLCBzbyBJIGludHJvZHVjZWQgYWRldi0+cmVzZXRfc2VtLg0KDQoNClRoZW4gd2h5
IGtlZXAgaW5fZ3B1X3Jlc2V0IGFuZCBub3QgY29udmVydCBhbGwgdGhvc2UgcGxhY2VzIGl0J3Mg
dXNlZCB0byB1c2luZyANCnJlc2V0X3NlbSA/DQoNCltEZW5uaXMgTGldIEJlY2F1c2Ugc29tZSBm
dW5jdGlvbnMgYXJlIGFsc28gY2FsbGVkIGJ5IGFtZGdwdV9kZXZpY2VfZ3B1X3JlY292ZXIsIGFk
ZXYtPmluX2dwdV9yZXNldCBoZWxwIHRoZXNlIGZ1bmN0aW9ucyB0byBza2lwIHNvbWUgc3RlcHMu
IA0KDQpBbHNvIGJlbGxvdyB0aGVyZSB3YXMgYSBjb21tZW50IG9uIGFtZGdwdV9kZXZpY2VfbG9j
a19hZGV2LCB0YWtlIGEgbG9vayBwbGVhc2UuDQoNCkFuZHJleQ0KDQo+DQo+IEkgcmVjZW50bHkg
d29ya2VkIChhbmQgc3RpbGwgZG8pIG9uIGRldmljZSB1bnBsdWcgc3VwcG9ydCwgSSB3YXMgdGhp
bmtpbmcgLSBjYW4gd2UgdXNlIHNvbWV0aGluZyBhbGlrZSBkcm1fZGV2X2VudGVyL2RybV9kZXZf
ZXhpdCBhbmQgZHJtX2Rldl91bnBsdWcgZm9yIG91ciBjYXVzZSBhbmQgdGhpcyB3b3VsZCByZXBs
YWNlIGJvdGggYWRldi0+aW5fZ3B1X3Jlc2V0IGFuZCB0aGUgbG9ja19yZXNldCBtdXRleChvciBy
d19zZW1hcGhvdGUpID8gSW4gb3VyIGNhc2Ugd2UgYWxzbyB3b3VsZCBuZWVkIGEgICdkcm1fZGV2
X3BsdWdfYmFjaycgZnVuY3Rpb24gdG9vLiBNYXliZSB3ZSBjYW4gZXZlbiB1c2UgdGhlIGV4aXN0
aW5nIGRybSBoZWxwZXJzIGFzIGlzIGFzIGJlY2F1c2Ugd2hpbGUgZGV2aWNlIGlzIGJlaW5nIHJl
c2V0IGl0J3MgZWZmZWN0aXZlbHkgdGhlIHNhbWUgYXMgaWYgaXQncyB1bnBsdWdnZWQgaSB0aGlu
ay4uLg0KPiBbRGVubmlzXTogV2hlbiBHUFUgZG8gYmFjbyByZXNldCwgYnVzIGlzIHN0aWxsIGFj
dGl2ZSB3aGljaCBpcyBkaWZmZXJlbnQgdW5wbHVnLiBJIHByZWZlciB0byB1c2UgYWRldi0+cmVz
ZXRfc2VtLg0KPg0KPiBTb21lIG1vcmUgYmVsbG93DQo+DQo+PiBTaWduZWQtb2ZmLWJ5OiBEZW5u
aXMgTGkgPERlbm5pcy5MaUBhbWQuY29tPg0KPj4gQ2hhbmdlLUlkOiBJN2Y3N2E3Mjc5NTQ2MjU4
N2VkN2Q1ZjUxZmU1M2E1OTRhMGYxZjcwOA0KPj4NCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdS5oDQo+PiBpbmRleCA4MGYzMmIzYmViODguLmYyMzU0OTI3OTlkNyAxMDA2NDQNCj4+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5oDQo+PiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaA0KPj4gQEAgLTk2Myw5ICs5NjMsOSBAQCBzdHJ1
Y3QgYW1kZ3B1X2RldmljZSB7DQo+PiAgICAJYm9vbCAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBpbl9zdXNwZW5kOw0KPj4gICAgCWJvb2wJCQkJaW5faGliZXJuYXRlOw0KPj4gICAgDQo+PiAt
CWJvb2wgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5fZ3B1X3Jlc2V0Ow0KPj4gKwlhdG9t
aWNfdCAgICAgICAgICAgICAgICAgICAgICAgIGluX2dwdV9yZXNldDsNCj4+ICAgIAllbnVtIHBw
X21wMV9zdGF0ZSAgICAgICAgICAgICAgIG1wMV9zdGF0ZTsNCj4+IC0Jc3RydWN0IG11dGV4ICBs
b2NrX3Jlc2V0Ow0KPj4gKwlzdHJ1Y3Qgcndfc2VtYXBob3JlCXJlc2V0X3NlbTsNCj4+ICAgIAlz
dHJ1Y3QgYW1kZ3B1X2Rvb3JiZWxsX2luZGV4IGRvb3JiZWxsX2luZGV4Ow0KPj4gICAgDQo+PiAg
ICAJc3RydWN0IG11dGV4CQkJbm90aWZpZXJfbG9jazsNCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92MTAuYyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3YxMC5jDQo+PiBpbmRleCA2OTFjODk3
MDViY2QuLmFmNzFkOGU5MzA4MSAxMDA2NDQNCj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3YxMC5jDQo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92MTAuYw0KPj4gQEAgLTU0Myw3ICs1NDMsNyBA
QCBzdGF0aWMgaW50IGtnZF9ocWRfZGVzdHJveShzdHJ1Y3Qga2dkX2RldiAqa2dkLCB2b2lkICpt
cWQsDQo+PiAgICAJdWludDMyX3QgdGVtcDsNCj4+ICAgIAlzdHJ1Y3QgdjEwX2NvbXB1dGVfbXFk
ICptID0gZ2V0X21xZChtcWQpOw0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQp
DQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0
dXJuIC1FSU87DQo+PiAgICANCj4+ICAgICNpZiAwDQo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjcuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y3LmMNCj4+IGluZGV4IDBiN2U3ODc0ODU0
MC4uNzUwYTgzMDhjODY4IDEwMDY0NA0KPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjcuYw0KPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjcuYw0KPj4gQEAgLTQyNSw3ICs0MjUsNyBAQCBzdGF0
aWMgaW50IGtnZF9ocWRfZGVzdHJveShzdHJ1Y3Qga2dkX2RldiAqa2dkLCB2b2lkICptcWQsDQo+
PiAgICAJdW5zaWduZWQgbG9uZyBmbGFncywgZW5kX2ppZmZpZXM7DQo+PiAgICAJaW50IHJldHJ5
Ow0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNf
cmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FSU87DQo+PiAgICAN
Cj4+ICAgIAlhY3F1aXJlX3F1ZXVlKGtnZCwgcGlwZV9pZCwgcXVldWVfaWQpOw0KPj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y4LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92OC5jDQo+PiBp
bmRleCBjY2Q2MzViODEyYjUuLjAyNzc5M2UwYzFjYSAxMDA2NDQNCj4+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y4LmMNCj4+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y4LmMNCj4+IEBAIC00MjEs
NyArNDIxLDcgQEAgc3RhdGljIGludCBrZ2RfaHFkX2Rlc3Ryb3koc3RydWN0IGtnZF9kZXYgKmtn
ZCwgdm9pZCAqbXFkLA0KPj4gICAgCWludCByZXRyeTsNCj4+ICAgIAlzdHJ1Y3QgdmlfbXFkICpt
ID0gZ2V0X21xZChtcWQpOw0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+
PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJu
IC1FSU87DQo+PiAgICANCj4+ICAgIAlhY3F1aXJlX3F1ZXVlKGtnZCwgcGlwZV9pZCwgcXVldWVf
aWQpOw0KPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9h
bWRrZmRfZ2Z4X3Y5LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2Zk
X2dmeF92OS5jDQo+PiBpbmRleCBkZjg0MWMyYWM1ZTcuLmU0YTc3ZjdhNGMyZCAxMDA2NDQNCj4+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y5LmMN
Cj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y5
LmMNCj4+IEBAIC01NDEsNyArNTQxLDcgQEAgaW50IGtnZF9nZnhfdjlfaHFkX2Rlc3Ryb3koc3Ry
dWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFkLA0KPj4gICAgCXVpbnQzMl90IHRlbXA7DQo+PiAg
ICAJc3RydWN0IHY5X21xZCAqbSA9IGdldF9tcWQobXFkKTsNCj4+ICAgIA0KPj4gLQlpZiAoYWRl
di0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNl
dCkpDQo+PiAgICAJCXJldHVybiAtRUlPOw0KPj4gICAgDQo+PiAgICAJYWNxdWlyZV9xdWV1ZShr
Z2QsIHBpcGVfaWQsIHF1ZXVlX2lkKTsNCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9jcy5jDQo+PiBpbmRleCBmZmJjYWY0YmZiOGIuLmE5NGIzZjg2MmZjMiAxMDA2NDQNCj4+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jDQo+PiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3MuYw0KPj4gQEAgLTEyOTIsNiArMTI5Miw4
IEBAIGludCBhbWRncHVfY3NfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwgc3RydWN0IGRybV9maWxlICpmaWxwKQ0KPj4gICAgCXBhcnNlci5hZGV2ID0gYWRldjsNCj4+
ICAgIAlwYXJzZXIuZmlscCA9IGZpbHA7DQo+PiAgICANCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5y
ZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCXIgPSBhbWRncHVfY3NfcGFyc2VyX2luaXQoJnBhcnNl
ciwgZGF0YSk7DQo+PiAgICAJaWYgKHIpIHsNCj4+ICAgIAkJRFJNX0VSUk9SKCJGYWlsZWQgdG8g
aW5pdGlhbGl6ZSBwYXJzZXIgJWQhXG4iLCByKTsNCj4+IEBAIC0xMzMxLDYgKzEzMzMsOCBAQCBp
bnQgYW1kZ3B1X2NzX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsIHN0
cnVjdCBkcm1fZmlsZSAqZmlscCkNCj4+ICAgIG91dDoNCj4+ICAgIAlhbWRncHVfY3NfcGFyc2Vy
X2ZpbmkoJnBhcnNlciwgciwgcmVzZXJ2ZWRfYnVmZmVycyk7DQo+PiAgICANCj4+ICsJdXBfcmVh
ZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlyZXR1cm4gcjsNCj4+ICAgIH0NCj4+
ICAgIA0KPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9j
dHguYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jdHguYw0KPj4gaW5kZXgg
ODg0MmM1NWQ0NDkwLi5kODVkMTNmN2EwNDMgMTAwNjQ0DQo+PiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfY3R4LmMNCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9jdHguYw0KPj4gQEAgLTM1OCw2ICszNTgsOCBAQCBzdGF0aWMgaW50IGFt
ZGdwdV9jdHhfcXVlcnkyKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KPj4gICAgCWlmIChh
dG9taWNfcmVhZCgmY3R4LT5ndWlsdHkpKQ0KPj4gICAgCQlvdXQtPnN0YXRlLmZsYWdzIHw9IEFN
REdQVV9DVFhfUVVFUlkyX0ZMQUdTX0dVSUxUWTsNCj4+ICAgIA0KPj4gKwlkb3duX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJLypxdWVyeSB1ZSBjb3VudCovDQo+PiAgICAJ
cmFzX2NvdW50ZXIgPSBhbWRncHVfcmFzX3F1ZXJ5X2Vycm9yX2NvdW50KGFkZXYsIGZhbHNlKTsN
Cj4+ICAgIAkvKnJhcyBjb3VudGVyIGlzIG1vbm90b25pYyBpbmNyZWFzaW5nKi8NCj4+IEBAIC0z
NzMsNiArMzc1LDggQEAgc3RhdGljIGludCBhbWRncHVfY3R4X3F1ZXJ5MihzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqYWRldiwNCj4+ICAgIAkJY3R4LT5yYXNfY291bnRlcl9jZSA9IHJhc19jb3VudGVy
Ow0KPj4gICAgCX0NCj4+ICAgIA0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4g
Kw0KPj4gICAgCW11dGV4X3VubG9jaygmbWdyLT5sb2NrKTsNCj4+ICAgIAlyZXR1cm4gMDsNCj4+
ICAgIH0NCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
ZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RlYnVnZnMuYw0K
Pj4gaW5kZXggYWVhZGE3YzlmYmVhLi5lY2JmZjUzMmEyMWIgMTAwNjQ0DQo+PiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGVidWdmcy5jDQo+PiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGVidWdmcy5jDQo+PiBAQCAtMTAwLDE0ICsxMDAs
MTQgQEAgc3RhdGljIGludCBhbWRncHVfZGVidWdmc19hdXRvZHVtcF9vcGVuKHN0cnVjdCBpbm9k
ZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQ0KPj4gICAgDQo+PiAgICAJZmlsZS0+cHJpdmF0
ZV9kYXRhID0gYWRldjsNCj4+ICAgIA0KPj4gLQltdXRleF9sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0
KTsNCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gICAgCWlmIChhZGV2LT5h
dXRvZHVtcC5kdW1waW5nLmRvbmUpIHsNCj4+ICAgIAkJcmVpbml0X2NvbXBsZXRpb24oJmFkZXYt
PmF1dG9kdW1wLmR1bXBpbmcpOw0KPj4gICAgCQlyZXQgPSAwOw0KPj4gICAgCX0gZWxzZSB7DQo+
PiAgICAJCXJldCA9IC1FQlVTWTsNCj4+ICAgIAl9DQo+PiAtCW11dGV4X3VubG9jaygmYWRldi0+
bG9ja19yZXNldCk7DQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICANCj4+
ICAgIAlyZXR1cm4gcmV0Ow0KPj4gICAgfQ0KPj4gQEAgLTEyNiw3ICsxMjYsNyBAQCBzdGF0aWMg
dW5zaWduZWQgaW50IGFtZGdwdV9kZWJ1Z2ZzX2F1dG9kdW1wX3BvbGwoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCBwb2xsXw0KPj4gICAgDQo+PiAgICAJcG9sbF93YWl0KGZpbGUsICZhZGV2LT5h
dXRvZHVtcC5ncHVfaGFuZywgcG9sbF90YWJsZSk7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmlu
X2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0K
Pj4gICAgCQlyZXR1cm4gUE9MTElOIHwgUE9MTFJETk9STSB8IFBPTExXUk5PUk07DQo+PiAgICAN
Cj4+ICAgIAlyZXR1cm4gMDsNCj4+IEBAIC0xMTg4LDcgKzExODgsNyBAQCBzdGF0aWMgaW50IGFt
ZGdwdV9kZWJ1Z2ZzX3Rlc3RfaWIoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQ0KPj4g
ICAgCX0NCj4+ICAgIA0KPj4gICAgCS8qIEF2b2lkIGFjY2lkZW50bHkgdW5wYXJraW5nIHRoZSBz
Y2hlZCB0aHJlYWQgZHVyaW5nIEdQVSByZXNldCAqLw0KPj4gLQltdXRleF9sb2NrKCZhZGV2LT5s
b2NrX3Jlc2V0KTsNCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gICAgDQo+
PiAgICAJLyogaG9sZCBvbiB0aGUgc2NoZWR1bGVyICovDQo+PiAgICAJZm9yIChpID0gMDsgaSA8
IEFNREdQVV9NQVhfUklOR1M7IGkrKykgew0KPj4gQEAgLTEyMTUsNyArMTIxNSw3IEBAIHN0YXRp
YyBpbnQgYW1kZ3B1X2RlYnVnZnNfdGVzdF9pYihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpDQo+PiAgICAJCWt0aHJlYWRfdW5wYXJrKHJpbmctPnNjaGVkLnRocmVhZCk7DQo+PiAgICAJ
fQ0KPj4gICAgDQo+PiAtCW11dGV4X3VubG9jaygmYWRldi0+bG9ja19yZXNldCk7DQo+PiArCXVw
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICANCj4+ICAgIAlwbV9ydW50aW1lX21hcmtf
bGFzdF9idXN5KGRldi0+ZGV2KTsNCj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChk
ZXYtPmRldik7DQo+PiBAQCAtMTM5NSw3ICsxMzk1LDcgQEAgc3RhdGljIGludCBhbWRncHVfZGVi
dWdmc19pYl9wcmVlbXB0KHZvaWQgKmRhdGEsIHU2NCB2YWwpDQo+PiAgICAJCXJldHVybiAtRU5P
TUVNOw0KPj4gICAgDQo+PiAgICAJLyogQXZvaWQgYWNjaWRlbnRseSB1bnBhcmtpbmcgdGhlIHNj
aGVkIHRocmVhZCBkdXJpbmcgR1BVIHJlc2V0ICovDQo+PiAtCW11dGV4X2xvY2soJmFkZXYtPmxv
Y2tfcmVzZXQpOw0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICANCj4+
ICAgIAkvKiBzdG9wIHRoZSBzY2hlZHVsZXIgKi8NCj4+ICAgIAlrdGhyZWFkX3BhcmsocmluZy0+
c2NoZWQudGhyZWFkKTsNCj4+IEBAIC0xNDM2LDcgKzE0MzYsNyBAQCBzdGF0aWMgaW50IGFtZGdw
dV9kZWJ1Z2ZzX2liX3ByZWVtcHQodm9pZCAqZGF0YSwgdTY0IHZhbCkNCj4+ICAgIAkvKiByZXN0
YXJ0IHRoZSBzY2hlZHVsZXIgKi8NCj4+ICAgIAlrdGhyZWFkX3VucGFyayhyaW5nLT5zY2hlZC50
aHJlYWQpOw0KPj4gICAgDQo+PiAtCW11dGV4X3VubG9jaygmYWRldi0+bG9ja19yZXNldCk7DQo+
PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICANCj4+ICAgIAl0dG1fYm9fdW5s
b2NrX2RlbGF5ZWRfd29ya3F1ZXVlKCZhZGV2LT5tbWFuLmJkZXYsIHJlc2NoZWQpOw0KPj4gICAg
DQo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rldmlj
ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jDQo+PiBpbmRl
eCAyOTEzZTQxZjYzYTUuLjRmM2VjOTc0NmQwYyAxMDA2NDQNCj4+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYw0KPj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jDQo+PiBAQCAtMTkyOSw3ICsxOTI5LDcgQEAgc3Rh
dGljIGludCBhbWRncHVfZGV2aWNlX2Z3X2xvYWRpbmcoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYpDQo+PiAgICAJCQlpZiAoYWRldi0+aXBfYmxvY2tzW2ldLnN0YXR1cy5odyA9PSB0cnVlKQ0K
Pj4gICAgCQkJCWJyZWFrOw0KPj4gICAgDQo+PiAtCQkJaWYgKGFkZXYtPmluX2dwdV9yZXNldCB8
fCBhZGV2LT5pbl9zdXNwZW5kKSB7DQo+PiArCQkJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9n
cHVfcmVzZXQpIHx8IGFkZXYtPmluX3N1c3BlbmQpIHsNCj4+ICAgIAkJCQlyID0gYWRldi0+aXBf
YmxvY2tzW2ldLnZlcnNpb24tPmZ1bmNzLT5yZXN1bWUoYWRldik7DQo+PiAgICAJCQkJaWYgKHIp
IHsNCj4+ICAgIAkJCQkJRFJNX0VSUk9SKCJyZXN1bWUgb2YgSVAgYmxvY2sgPCVzPiBmYWlsZWQg
JWRcbiIsDQo+PiBAQCAtMjEwMCw3ICsyMTAwLDcgQEAgc3RhdGljIGJvb2wgYW1kZ3B1X2Rldmlj
ZV9jaGVja192cmFtX2xvc3Qoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpDQo+PiAgICAJCQlB
TURHUFVfUkVTRVRfTUFHSUNfTlVNKSkNCj4+ICAgIAkJcmV0dXJuIHRydWU7DQo+PiAgICANCj4+
IC0JaWYgKCFhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmICghYXRvbWljX3JlYWQoJmFkZXYt
PmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiBmYWxzZTsNCj4+ICAgIA0KPj4gICAgCS8q
DQo+PiBAQCAtMzAyNiw3ICszMDI2LDggQEAgaW50IGFtZGdwdV9kZXZpY2VfaW5pdChzdHJ1Y3Qg
YW1kZ3B1X2RldmljZSAqYWRldiwNCj4+ICAgIAltdXRleF9pbml0KCZhZGV2LT5tbl9sb2NrKTsN
Cj4+ICAgIAltdXRleF9pbml0KCZhZGV2LT52aXJ0LnZmX2Vycm9ycy5sb2NrKTsNCj4+ICAgIAlo
YXNoX2luaXQoYWRldi0+bW5faGFzaCk7DQo+PiAtCW11dGV4X2luaXQoJmFkZXYtPmxvY2tfcmVz
ZXQpOw0KPj4gKwlpbml0X3J3c2VtKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKwlhdG9taWNfc2V0
KCZhZGV2LT5pbl9ncHVfcmVzZXQsIDApOw0KPj4gICAgCW11dGV4X2luaXQoJmFkZXYtPnBzcC5t
dXRleCk7DQo+PiAgICAJbXV0ZXhfaW5pdCgmYWRldi0+bm90aWZpZXJfbG9jayk7DQo+PiAgICAN
Cj4+IEBAIC00MTMxLDE2ICs0MTMyLDE0IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RvX2FzaWNfcmVz
ZXQoc3RydWN0IGFtZGdwdV9oaXZlX2luZm8gKmhpdmUsDQo+PiAgICAJcmV0dXJuIHI7DQo+PiAg
ICB9DQo+PiAgICANCj4+IC1zdGF0aWMgYm9vbCBhbWRncHVfZGV2aWNlX2xvY2tfYWRldihzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCB0cnlsb2NrKQ0KPj4gK3N0YXRpYyBib29sIGFt
ZGdwdV9kZXZpY2VfbG9ja19hZGV2KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQ0KPj4gICAg
ew0KPj4gLQlpZiAodHJ5bG9jaykgew0KPj4gLQkJaWYgKCFtdXRleF90cnlsb2NrKCZhZGV2LT5s
b2NrX3Jlc2V0KSkNCj4+IC0JCQlyZXR1cm4gZmFsc2U7DQo+PiAtCX0gZWxzZQ0KPj4gLQkJbXV0
ZXhfbG9jaygmYWRldi0+bG9ja19yZXNldCk7DQo+PiArCWlmIChhdG9taWNfY21weGNoZygmYWRl
di0+aW5fZ3B1X3Jlc2V0LCAwLCAxKSAhPSAwKQ0KPj4gKwkJcmV0dXJuIGZhbHNlOw0KPj4gKw0K
Pj4gKwlkb3duX3dyaXRlKCZhZGV2LT5yZXNldF9zZW0pOw0KPg0KPiBJbiBWMSBDaHJpc3RpYW4g
cmFpc2VkIGEgY29uY2VybiBvZiB0aGlzIGNoYW5nZSBpbmNyZWFzaW5nwqAgdGhlIGNoYW5jZSBm
b3IgZ3B1DQo+IHJlY292ZXJ5IGFib3J0IGR1ZSB0byBjb2xsaXNpb24gb2YgYW1kZ3B1X2Rldmlj
ZV9sb2NrX2FkZXYgZG9pbmcgZG93bl93cml0ZQ0KPiB0cnlsb2NrIHdpdGggcmVhZCBzaWRlIGxv
Y2sgb2YgYW55IG9mIHRoZSBtYW55IG9wZXJhdGlvbnMgaGVyZS4gSSB1bmRlcnN0YW5kIHRoZQ0K
PiBuZWVkIGZvciB0aGlzIGJ1dCBiZWZvcmUgdGhlICd0cnlsb2NrJ8KgIHdhcyB1c2VkIG9ubHkg
Zm9yIFhHTUkgY2FzZSBiZWNhdXNlIHdlDQo+IGtuZXcgWEdNSSBoYW5nIG9uIG9uY2UgY2FyZCB3
aWxsIHRyaWdnZXIgaGFuZ3Mgb24gYWxsIG90aGVyIGNhcmRzIGluIHRoZSBoaXZlDQo+IGJ1dCBu
b3cgdGhlICd0cnlsb2NrJyBsb2dpYyAoaW1wbGVtZW50ZWQgYnkgYXRvbWljX2NtcHhjaGcpIGFs
c28gYXBwbGllcyB0byB0aGUNCj4gbW9yZSBjb21tb24gbm9uIFhHTUkgY2FzZQ0KPg0KPiBBbmRy
ZXkNCltEZW5uaXNdIFllcywgd2UgYWxzbyBuZWVkICd0cnlsb2NrJyBsb2dpYyBmb3Igbm9uIFhH
TUkgY2FzZS4gRHJpdmVyIGhhcyBtdWx0aS1wYXRocyB0byBkZXRlY3QgR1BVIGhhbmcsIGFuZCB0
aGVuIHRyaWdnZXIgZ3B1X3JlY292ZXJ5LiBUaGUgJ3RyeWxvY2snIGxvZ2ljIGhlcmUgaXMgdXNl
ZCB0byBhdm9pZCByZS1lbnRlcmluZyAgZ3B1X3JlY292ZXJ5IGZvciB0aGUgc2FtZSBHUFUgaGFu
Zy4gDQoNCg0KDQo+DQo+PiAgICANCj4+ICAgIAlhdG9taWNfaW5jKCZhZGV2LT5ncHVfcmVzZXRf
Y291bnRlcik7DQo+PiAtCWFkZXYtPmluX2dwdV9yZXNldCA9IHRydWU7DQo+PiAgICAJc3dpdGNo
IChhbWRncHVfYXNpY19yZXNldF9tZXRob2QoYWRldikpIHsNCj4+ICAgIAljYXNlIEFNRF9SRVNF
VF9NRVRIT0RfTU9ERTE6DQo+PiAgICAJCWFkZXYtPm1wMV9zdGF0ZSA9IFBQX01QMV9TVEFURV9T
SFVURE9XTjsNCj4+IEBAIC00MTYwLDggKzQxNTksOCBAQCBzdGF0aWMgdm9pZCBhbWRncHVfZGV2
aWNlX3VubG9ja19hZGV2KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQ0KPj4gICAgew0KPj4g
ICAgCWFtZGdwdV92Zl9lcnJvcl90cmFuc19hbGwoYWRldik7DQo+PiAgICAJYWRldi0+bXAxX3N0
YXRlID0gUFBfTVAxX1NUQVRFX05PTkU7DQo+PiAtCWFkZXYtPmluX2dwdV9yZXNldCA9IGZhbHNl
Ow0KPj4gLQltdXRleF91bmxvY2soJmFkZXYtPmxvY2tfcmVzZXQpOw0KPj4gKwlhdG9taWNfc2V0
KCZhZGV2LT5pbl9ncHVfcmVzZXQsIDApOw0KPj4gKwl1cF93cml0ZSgmYWRldi0+cmVzZXRfc2Vt
KTsNCj4+ICAgIH0NCj4+ICAgIA0KPj4gICAgc3RhdGljIHZvaWQgYW1kZ3B1X2RldmljZV9yZXN1
bWVfZGlzcGxheV9hdWRpbyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikNCj4+IEBAIC00Mjk3
LDcgKzQyOTYsNyBAQCBpbnQgYW1kZ3B1X2RldmljZV9ncHVfcmVjb3ZlcihzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqYWRldiwNCj4+ICAgIA0KPj4gICAgCS8qIGJsb2NrIGFsbCBzY2hlZHVsZXJzIGFu
ZCByZXNldCBnaXZlbiBqb2IncyByaW5nICovDQo+PiAgICAJbGlzdF9mb3JfZWFjaF9lbnRyeSh0
bXBfYWRldiwgZGV2aWNlX2xpc3RfaGFuZGxlLCBnbWMueGdtaS5oZWFkKSB7DQo+PiAtCQlpZiAo
IWFtZGdwdV9kZXZpY2VfbG9ja19hZGV2KHRtcF9hZGV2LCAhaGl2ZSkpIHsNCj4+ICsJCWlmICgh
YW1kZ3B1X2RldmljZV9sb2NrX2FkZXYodG1wX2FkZXYpKSB7DQo+PiAgICAJCQlEUk1fSU5GTygi
QmFpbGluZyBvbiBURFIgZm9yIHNfam9iOiVsbHgsIGFzIGFub3RoZXIgYWxyZWFkeSBpbiBwcm9n
cmVzcyIsDQo+PiAgICAJCQkJICBqb2IgPyBqb2ItPmJhc2UuaWQgOiAtMSk7DQo+PiAgICAJCQlt
dXRleF91bmxvY2soJmhpdmUtPmhpdmVfbG9jayk7DQo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2dlbS5jDQo+PiBpbmRleCA3N2Q5ODhhMDAzM2YuLjk2ZGYzNjY5YTlkMiAxMDA2
NDQNCj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZW0uYw0KPj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dlbS5jDQo+PiBAQCAtNjcw
LDYgKzY3MCw4IEBAIGludCBhbWRncHVfZ2VtX3ZhX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsIHZvaWQgKmRhdGEsDQo+PiAgICAJCWJvX3ZhID0gTlVMTDsNCj4+ICAgIAl9DQo+PiAgICAN
Cj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCXN3aXRjaCAo
YXJncy0+b3BlcmF0aW9uKSB7DQo+PiAgICAJY2FzZSBBTURHUFVfVkFfT1BfTUFQOg0KPj4gICAg
CQl2YV9mbGFncyA9IGFtZGdwdV9nZW1fdmFfbWFwX2ZsYWdzKGFkZXYsIGFyZ3MtPmZsYWdzKTsN
Cj4+IEBAIC02OTksNiArNzAxLDggQEAgaW50IGFtZGdwdV9nZW1fdmFfaW9jdGwoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwNCj4+ICAgIAkJYW1kZ3B1X2dlbV92YV91cGRhdGVf
dm0oYWRldiwgJmZwcml2LT52bSwgYm9fdmEsDQo+PiAgICAJCQkJCWFyZ3MtPm9wZXJhdGlvbik7
DQo+PiAgICANCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIGVy
cm9yX2JhY2tvZmY6DQo+PiAgICAJdHRtX2V1X2JhY2tvZmZfcmVzZXJ2YXRpb24oJnRpY2tldCwg
Jmxpc3QpOw0KPj4gICAgDQo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2dmeC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dmeC5j
DQo+PiBpbmRleCBkNjEyMDMzYTIzYWMuLmM5ZjEzZjgzNmE3YSAxMDA2NDQNCj4+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZnguYw0KPj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dmeC5jDQo+PiBAQCAtNzEwLDcgKzcxMCw3IEBAIHVp
bnQzMl90IGFtZGdwdV9raXFfcnJlZyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgdWludDMy
X3QgcmVnKQ0KPj4gICAgCSAqDQo+PiAgICAJICogYWxzbyBkb24ndCB3YWl0IGFueW1vcmUgZm9y
IElSUSBjb250ZXh0DQo+PiAgICAJICogKi8NCj4+IC0JaWYgKHIgPCAxICYmIChhZGV2LT5pbl9n
cHVfcmVzZXQgfHwgaW5faW50ZXJydXB0KCkpKQ0KPj4gKwlpZiAociA8IDEgJiYgKGF0b21pY19y
ZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpIHx8IGluX2ludGVycnVwdCgpKSkNCj4+ICAgIAkJZ290
byBmYWlsZWRfa2lxX3JlYWQ7DQo+PiAgICANCj4+ICAgIAltaWdodF9zbGVlcCgpOw0KPj4gQEAg
LTc2OCw3ICs3NjgsNyBAQCB2b2lkIGFtZGdwdV9raXFfd3JlZyhzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwgdWludDMyX3QgcmVnLCB1aW50MzJfdCB2KQ0KPj4gICAgCSAqDQo+PiAgICAJICog
YWxzbyBkb24ndCB3YWl0IGFueW1vcmUgZm9yIElSUSBjb250ZXh0DQo+PiAgICAJICogKi8NCj4+
IC0JaWYgKHIgPCAxICYmIChhZGV2LT5pbl9ncHVfcmVzZXQgfHwgaW5faW50ZXJydXB0KCkpKQ0K
Pj4gKwlpZiAociA8IDEgJiYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpIHx8IGlu
X2ludGVycnVwdCgpKSkNCj4+ICAgIAkJZ290byBmYWlsZWRfa2lxX3dyaXRlOw0KPj4gICAgDQo+
PiAgICAJbWlnaHRfc2xlZXAoKTsNCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfam9iLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
am9iLmMNCj4+IGluZGV4IDkzNzAyOWFkNTI3MS4uMzY3NTI4ZGUxNjU4IDEwMDY0NA0KPj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5jDQo+PiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfam9iLmMNCj4+IEBAIC0yMjYsOCArMjI2LDEw
IEBAIHN0YXRpYyBzdHJ1Y3QgZG1hX2ZlbmNlICphbWRncHVfam9iX3J1bihzdHJ1Y3QgZHJtX3Nj
aGVkX2pvYiAqc2NoZWRfam9iKQ0KPj4gICAgCWlmIChmaW5pc2hlZC0+ZXJyb3IgPCAwKSB7DQo+
PiAgICAJCURSTV9JTkZPKCJTa2lwIHNjaGVkdWxpbmcgSUJzIVxuIik7DQo+PiAgICAJfSBlbHNl
IHsNCj4+ICsJCWRvd25fcmVhZCgmcmluZy0+YWRldi0+cmVzZXRfc2VtKTsNCj4+ICAgIAkJciA9
IGFtZGdwdV9pYl9zY2hlZHVsZShyaW5nLCBqb2ItPm51bV9pYnMsIGpvYi0+aWJzLCBqb2IsDQo+
PiAgICAJCQkJICAgICAgICZmZW5jZSk7DQo+PiArCQl1cF9yZWFkKCZyaW5nLT5hZGV2LT5yZXNl
dF9zZW0pOw0KPj4gICAgCQlpZiAocikNCj4+ICAgIAkJCURSTV9FUlJPUigiRXJyb3Igc2NoZWR1
bGluZyBJQnMgKCVkKVxuIiwgcik7DQo+PiAgICAJfQ0KPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9rbXMuYw0KPj4gaW5kZXggOWMyYzVlNGVkMWViLi5lZWJiZTIxMDNlMzIgMTAw
NjQ0DQo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfa21zLmMNCj4+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYw0KPj4gQEAgLTEw
ODQsNiArMTA4NCw4IEBAIHZvaWQgYW1kZ3B1X2RyaXZlcl9wb3N0Y2xvc2Vfa21zKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsDQo+PiAgICAJaWYgKCFmcHJpdikNCj4+ICAgIAkJcmV0dXJuOw0KPj4g
ICAgDQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9y
dW50aW1lX2dldF9zeW5jKGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gICAgCWlmIChhbWRncHVfZGV2
aWNlX2lwX2dldF9pcF9ibG9jayhhZGV2LCBBTURfSVBfQkxPQ0tfVFlQRV9VVkQpICE9IE5VTEwp
DQo+PiBAQCAtMTEyMiw2ICsxMTI0LDggQEAgdm9pZCBhbWRncHVfZHJpdmVyX3Bvc3RjbG9zZV9r
bXMoc3RydWN0IGRybV9kZXZpY2UgKmRldiwNCj4+ICAgIA0KPj4gICAgCXBtX3J1bnRpbWVfbWFy
a19sYXN0X2J1c3koZGV2LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5k
KGRldi0+ZGV2KTsNCj4+ICsNCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICAg
IH0NCj4+ICAgIA0KPj4gICAgLyoNCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9w
bS5jDQo+PiBpbmRleCBkMjQwMTM3OWJkMzMuLjYxYjIzYWU5MDZkNyAxMDA2NDQNCj4+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jDQo+PiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uYw0KPj4gQEAgLTE2Myw3ICsxNjMsNyBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bvd2VyX2RwbV9zdGF0ZShzdHJ1Y3QgZGV2aWNlICpk
ZXYsDQo+PiAgICAJZW51bSBhbWRfcG1fc3RhdGVfdHlwZSBwbTsNCj4+ICAgIAlpbnQgcmV0Ow0K
Pj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVh
ZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0K
Pj4gICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsNCj4+IEBAIC0xNzIs
NiArMTcyLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wb3dlcl9kcG1fc3RhdGUoc3Ry
dWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcmV0Ow0KPj4gICAgCX0NCj4+ICAgIA0K
Pj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJaWYgKGlzX3N1
cHBvcnRfc3dfc211KGFkZXYpKSB7DQo+PiAgICAJCWlmIChhZGV2LT5zbXUucHB0X2Z1bmNzLT5n
ZXRfY3VycmVudF9wb3dlcl9zdGF0ZSkNCj4+ICAgIAkJCXBtID0gc211X2dldF9jdXJyZW50X3Bv
d2VyX3N0YXRlKCZhZGV2LT5zbXUpOw0KPj4gQEAgLTE4Myw2ICsxODUsOCBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfZ2V0X3Bvd2VyX2RwbV9zdGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAg
ICAJCXBtID0gYWRldi0+cG0uZHBtLnVzZXJfc3RhdGU7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiAr
CXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJcG1fcnVudGltZV9tYXJr
X2xhc3RfYnVzeShkZGV2LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5k
KGRkZXYtPmRldik7DQo+PiAgICANCj4+IEBAIC0yMDEsNyArMjA1LDcgQEAgc3RhdGljIHNzaXpl
X3QgYW1kZ3B1X3NldF9wb3dlcl9kcG1fc3RhdGUoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAg
CWVudW0gYW1kX3BtX3N0YXRlX3R5cGUgIHN0YXRlOw0KPj4gICAgCWludCByZXQ7DQo+PiAgICAN
Cj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2
LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAgICAJ
aWYgKHN0cm5jbXAoImJhdHRlcnkiLCBidWYsIHN0cmxlbigiYmF0dGVyeSIpKSA9PSAwKQ0KPj4g
QEAgLTIxOSw2ICsyMjMsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3Bvd2VyX2RwbV9z
dGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiByZXQ7DQo+PiAgICAJfQ0K
Pj4gICAgDQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlp
ZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsNCj4+ICAgIAkJbXV0ZXhfbG9jaygmYWRldi0+
cG0ubXV0ZXgpOw0KPj4gICAgCQlhZGV2LT5wbS5kcG0udXNlcl9zdGF0ZSA9IHN0YXRlOw0KPj4g
QEAgLTIzMiw2ICsyMzgsOSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3Bvd2VyX2RwbV9z
dGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICANCj4+ICAgIAkJYW1kZ3B1X3BtX2NvbXB1
dGVfY2xvY2tzKGFkZXYpOw0KPj4gICAgCX0NCj4+ICsNCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRl
dik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsNCj4+ICAg
IA0KPj4gQEAgLTMwNyw3ICszMTYsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bvd2Vy
X2RwbV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJ
ZW51bSBhbWRfZHBtX2ZvcmNlZF9sZXZlbCBsZXZlbCA9IDB4ZmY7DQo+PiAgICAJaW50IHJldDsN
Cj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3Jl
YWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAgICAN
Cj4+ICAgIAlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7DQo+PiBAQCAtMzE2
LDYgKzMyNSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcG93ZXJfZHBtX2ZvcmNlX3Bl
cmZvcm1hbmNlX2xldmVsKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJcmV0dXJuIHJldDsN
Cj4+ICAgIAl9DQo+PiAgICANCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4g
Kw0KPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkNCj4+ICAgIAkJbGV2ZWwgPSBz
bXVfZ2V0X3BlcmZvcm1hbmNlX2xldmVsKCZhZGV2LT5zbXUpOw0KPj4gICAgCWVsc2UgaWYgKGFk
ZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0X3BlcmZvcm1hbmNlX2xldmVsKQ0KPj4gQEAgLTMy
Myw2ICszMzQsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bvd2VyX2RwbV9mb3JjZV9w
ZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJZWxzZQ0KPj4gICAg
CQlsZXZlbCA9IGFkZXYtPnBtLmRwbS5mb3JjZWRfbGV2ZWw7DQo+PiAgICANCj4+ICsJdXBfcmVh
ZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9i
dXN5KGRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+
ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTM0OSw3ICszNjIsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfc2V0X3Bvd2VyX2RwbV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3QgZGV2aWNlICpk
ZXYsDQo+PiAgICAJZW51bSBhbWRfZHBtX2ZvcmNlZF9sZXZlbCBjdXJyZW50X2xldmVsID0gMHhm
ZjsNCj4+ICAgIAlpbnQgcmV0ID0gMDsNCj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jl
c2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJ
CXJldHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAgIAlpZiAoc3RybmNtcCgibG93IiwgYnVmLCBz
dHJsZW4oImxvdyIpKSA9PSAwKSB7DQo+PiBAQCAtMzgwLDYgKzM5Myw4IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBtX2ZvcmNlX3BlcmZvcm1hbmNlX2xldmVsKHN0cnVjdCBk
ZXZpY2UgKmRldiwNCj4+ICAgIAkJcmV0dXJuIHJldDsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJ
ZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCWlmIChpc19zdXBwb3J0
X3N3X3NtdShhZGV2KSkNCj4+ICAgIAkJY3VycmVudF9sZXZlbCA9IHNtdV9nZXRfcGVyZm9ybWFu
Y2VfbGV2ZWwoJmFkZXYtPnNtdSk7DQo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBw
X2Z1bmNzLT5nZXRfcGVyZm9ybWFuY2VfbGV2ZWwpDQo+PiBAQCAtMzg4LDcgKzQwMyw4IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBtX2ZvcmNlX3BlcmZvcm1hbmNlX2xldmVs
KHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAlpZiAoY3VycmVudF9sZXZlbCA9PSBsZXZlbCkg
ew0KPj4gICAgCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7DQo+PiAgICAJ
CXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7DQo+PiAtCQlyZXR1cm4gY291
bnQ7DQo+PiArCQlyZXQgPSBjb3VudDsNCj4+ICsJCWdvdG8gcHJvX2VuZDsNCj4+ICAgIAl9DQo+
PiAgICANCj4+ICAgIAlpZiAoYWRldi0+YXNpY190eXBlID09IENISVBfUkFWRU4pIHsNCj4+IEBA
IC00MDksNyArNDI1LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wb3dlcl9kcG1fZm9y
Y2VfcGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlwcl9lcnIo
IkN1cnJlbnRseSBub3QgaW4gYW55IHByb2ZpbGUgbW9kZSFcbiIpOw0KPj4gICAgCQlwbV9ydW50
aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7DQo+PiAgICAJCXBtX3J1bnRpbWVfcHV0X2F1
dG9zdXNwZW5kKGRkZXYtPmRldik7DQo+PiAtCQlyZXR1cm4gLUVJTlZBTDsNCj4+ICsJCXJldCA9
IC1FSU5WQUw7DQo+PiArCQlnb3RvIHByb19lbmQ7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiAgICAJ
aWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7DQo+PiBAQCAtNDE3LDcgKzQzNCw4IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBtX2ZvcmNlX3BlcmZvcm1hbmNlX2xldmVs
KHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJaWYgKHJldCkgew0KPj4gICAgCQkJcG1fcnVu
dGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOw0KPj4gICAgCQkJcG1fcnVudGltZV9wdXRf
YXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsNCj4+IC0JCQlyZXR1cm4gLUVJTlZBTDsNCj4+ICsJCQly
ZXQgPSAtRUlOVkFMOw0KPj4gKwkJCWdvdG8gcHJvX2VuZDsNCj4+ICAgIAkJfQ0KPj4gICAgCX0g
ZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5mb3JjZV9wZXJmb3JtYW5jZV9sZXZl
bCkgew0KPj4gICAgCQltdXRleF9sb2NrKCZhZGV2LT5wbS5tdXRleCk7DQo+PiBAQCAtNDI1LDE0
ICs0NDMsMTYgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wb3dlcl9kcG1fZm9yY2VfcGVy
Zm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQkJbXV0ZXhfdW5sb2Nr
KCZhZGV2LT5wbS5tdXRleCk7DQo+PiAgICAJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRk
ZXYtPmRldik7DQo+PiAgICAJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYp
Ow0KPj4gLQkJCXJldHVybiAtRUlOVkFMOw0KPj4gKwkJCXJldCA9IC1FSU5WQUw7DQo+PiArCQkJ
Z290byBwcm9fZW5kOw0KPj4gICAgCQl9DQo+PiAgICAJCXJldCA9IGFtZGdwdV9kcG1fZm9yY2Vf
cGVyZm9ybWFuY2VfbGV2ZWwoYWRldiwgbGV2ZWwpOw0KPj4gICAgCQlpZiAocmV0KSB7DQo+PiAg
ICAJCQltdXRleF91bmxvY2soJmFkZXYtPnBtLm11dGV4KTsNCj4+ICAgIAkJCXBtX3J1bnRpbWVf
bWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsNCj4+ICAgIAkJCXBtX3J1bnRpbWVfcHV0X2F1dG9z
dXNwZW5kKGRkZXYtPmRldik7DQo+PiAtCQkJcmV0dXJuIC1FSU5WQUw7DQo+PiArCQkJcmV0ID0g
LUVJTlZBTDsNCj4+ICsJCQlnb3RvIHByb19lbmQ7DQo+PiAgICAJCX0gZWxzZSB7DQo+PiAgICAJ
CQlhZGV2LT5wbS5kcG0uZm9yY2VkX2xldmVsID0gbGV2ZWw7DQo+PiAgICAJCX0NCj4+IEBAIC00
NDEsNyArNDYxLDkgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wb3dlcl9kcG1fZm9yY2Vf
cGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCXBtX3J1bnRpbWVf
bWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsNCj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3Vz
cGVuZChkZGV2LT5kZXYpOw0KPj4gICAgDQo+PiAtCXJldHVybiBjb3VudDsNCj4+ICtwcm9fZW5k
Og0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKwlyZXR1cm4gcmV0Ow0KPj4g
ICAgfQ0KPj4gICAgDQo+PiAgICBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX251bV9zdGF0
ZXMoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gQEAgLTQ1Myw3ICs0NzUsNyBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfZ2V0X3BwX251bV9zdGF0ZXMoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAg
CXN0cnVjdCBwcF9zdGF0ZXNfaW5mbyBkYXRhOw0KPj4gICAgCWludCBpLCBidWZfbGVuLCByZXQ7
DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19y
ZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAg
DQo+PiAgICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOw0KPj4gQEAgLTQ5
Nyw3ICs1MTksNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2N1cl9zdGF0ZShzdHJ1
Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJZW51bSBhbWRfcG1fc3RhdGVfdHlwZSBwbSA9IDA7DQo+
PiAgICAJaW50IGkgPSAwLCByZXQgPSAwOw0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVf
cmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAg
IAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5
bmMoZGRldi0+ZGV2KTsNCj4+IEBAIC01MzgsNyArNTYwLDcgQEAgc3RhdGljIHNzaXplX3QgYW1k
Z3B1X2dldF9wcF9mb3JjZV9zdGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJc3RydWN0
IGRybV9kZXZpY2UgKmRkZXYgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsNCj4+ICAgIAlzdHJ1Y3Qg
YW1kZ3B1X2RldmljZSAqYWRldiA9IGRkZXYtPmRldl9wcml2YXRlOw0KPj4gICAgDQo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1
X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCWlmIChhZGV2
LT5wcF9mb3JjZV9zdGF0ZV9lbmFibGVkKQ0KPj4gQEAgLTU1OCw3ICs1ODAsNyBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfc2V0X3BwX2ZvcmNlX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+
ICAgIAl1bnNpZ25lZCBsb25nIGlkeDsNCj4+ICAgIAlpbnQgcmV0Ow0KPj4gICAgDQo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1
X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCWlmIChzdHJs
ZW4oYnVmKSA9PSAxKQ0KPj4gQEAgLTU4NCw2ICs2MDYsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfc2V0X3BwX2ZvcmNlX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJCXJldHVy
biByZXQ7DQo+PiAgICAJCX0NCj4+ICAgIA0KPj4gKwkJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9z
ZW0pOw0KPj4gICAgCQkvKiBvbmx5IHNldCB1c2VyIHNlbGVjdGVkIHBvd2VyIHN0YXRlcyAqLw0K
Pj4gICAgCQlpZiAoc3RhdGUgIT0gUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9CT09UICYmDQo+
PiAgICAJCSAgICBzdGF0ZSAhPSBQT1dFUl9TVEFURV9UWVBFX0RFRkFVTFQpIHsNCj4+IEBAIC01
OTEsNiArNjE0LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9mb3JjZV9zdGF0ZShz
dHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCQkJCUFNRF9QUF9UQVNLX0VOQUJMRV9VU0VSX1NU
QVRFLCAmc3RhdGUpOw0KPj4gICAgCQkJYWRldi0+cHBfZm9yY2Vfc3RhdGVfZW5hYmxlZCA9IHRy
dWU7DQo+PiAgICAJCX0NCj4+ICsJCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+
PiAgICAJCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsNCj4+ICAgIAkJcG1f
cnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsNCj4+ICAgIAl9DQo+PiBAQCAtNjE4
LDcgKzY0Myw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfdGFibGUoc3RydWN0IGRl
dmljZSAqZGV2LA0KPj4gICAgCWNoYXIgKnRhYmxlID0gTlVMTDsNCj4+ICAgIAlpbnQgc2l6ZSwg
cmV0Ow0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9t
aWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+
ICAgIA0KPj4gICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsNCj4+IEBA
IC02NjIsNyArNjg3LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF90YWJsZShzdHJ1
Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBkZGV2
LT5kZXZfcHJpdmF0ZTsNCj4+ICAgIAlpbnQgcmV0ID0gMDsNCj4+ICAgIA0KPj4gLQlpZiAoYWRl
di0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNl
dCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAgIAlyZXQgPSBwbV9ydW50
aW1lX2dldF9zeW5jKGRkZXYtPmRldik7DQo+PiBAQCAtNjcxLDE2ICs2OTYsMjEgQEAgc3RhdGlj
IHNzaXplX3QgYW1kZ3B1X3NldF9wcF90YWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJ
CXJldHVybiByZXQ7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsNCj4+
ICAgIAkJcmV0ID0gc211X3N5c19zZXRfcHBfdGFibGUoJmFkZXYtPnNtdSwgKHZvaWQgKilidWYs
IGNvdW50KTsNCj4+ICAgIAkJaWYgKHJldCkgew0KPj4gICAgCQkJcG1fcnVudGltZV9tYXJrX2xh
c3RfYnVzeShkZGV2LT5kZXYpOw0KPj4gICAgCQkJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQo
ZGRldi0+ZGV2KTsNCj4+ICsJCQl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gICAgCQkJ
cmV0dXJuIHJldDsNCj4+ICAgIAkJfQ0KPj4gICAgCX0gZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5
LnBwX2Z1bmNzLT5zZXRfcHBfdGFibGUpDQo+PiAgICAJCWFtZGdwdV9kcG1fc2V0X3BwX3RhYmxl
KGFkZXYsIGJ1ZiwgY291bnQpOw0KPj4gICAgDQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3Nl
bSk7DQo+PiArDQo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOw0K
Pj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7DQo+PiAgICANCj4+
IEBAIC03NjksNyArNzk5LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9vZF9jbGtf
dm9sdGFnZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJY29uc3QgY2hhciBkZWxpbWl0ZXJb
M10gPSB7JyAnLCAnXG4nLCAnXDAnfTsNCj4+ICAgIAl1aW50MzJfdCB0eXBlOw0KPj4gICAgDQo+
PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+
aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCWlm
IChjb3VudCA+IDEyNykNCj4+IEBAIC04MTMsNiArODQzLDEwIEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9zZXRfcHBfb2RfY2xrX3ZvbHRhZ2Uoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQly
ZXR1cm4gcmV0Ow0KPj4gICAgCX0NCj4+ICAgIA0KPj4gKwlyZXQgPSBjb3VudDsNCj4+ICsNCj4+
ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCWlmIChpc19zdXBw
b3J0X3N3X3NtdShhZGV2KSkgew0KPj4gICAgCQlyZXQgPSBzbXVfb2RfZWRpdF9kcG1fdGFibGUo
JmFkZXYtPnNtdSwgdHlwZSwNCj4+ICAgIAkJCQkJICAgIHBhcmFtZXRlciwgcGFyYW1ldGVyX3Np
emUpOw0KPj4gQEAgLTgyMCw3ICs4NTQsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3Bw
X29kX2Nsa192b2x0YWdlKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJaWYgKHJldCkgew0K
Pj4gICAgCQkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOw0KPj4gICAgCQkJ
cG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsNCj4+IC0JCQlyZXR1cm4gLUVJ
TlZBTDsNCj4+ICsJCQlyZXQgPSAtRUlOVkFMOw0KPj4gKwkJCWdvdG8gcHJvX2VuZDsNCj4+ICAg
IAkJfQ0KPj4gICAgCX0gZWxzZSB7DQo+PiAgICAJCWlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVu
Y3MtPm9kbl9lZGl0X2RwbV90YWJsZSkgew0KPj4gQEAgLTgyOSw3ICs4NjQsOCBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfc2V0X3BwX29kX2Nsa192b2x0YWdlKHN0cnVjdCBkZXZpY2UgKmRldiwN
Cj4+ICAgIAkJCWlmIChyZXQpIHsNCj4+ICAgIAkJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGRkZXYtPmRldik7DQo+PiAgICAJCQkJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+
ZGV2KTsNCj4+IC0JCQkJcmV0dXJuIC1FSU5WQUw7DQo+PiArCQkJCXJldCA9IC1FSU5WQUw7DQo+
PiArCQkJCWdvdG8gcHJvX2VuZDsNCj4+ICAgIAkJCX0NCj4+ICAgIAkJfQ0KPj4gICAgDQo+PiBA
QCAtODQwLDE4ICs4NzYsMjIgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9vZF9jbGtf
dm9sdGFnZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCQkJCQlOVUxMKTsNCj4+ICAgIAkJ
CQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7DQo+PiAgICAJCQkJcG1fcnVu
dGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsNCj4+IC0JCQkJcmV0dXJuIGNvdW50Ow0K
Pj4gKwkJCQlyZXQgPSBjb3VudDsNCj4+ICsJCQkJZ290byBwcm9fZW5kOw0KPj4gICAgCQkJfSBl
bHNlIHsNCj4+ICAgIAkJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7DQo+
PiAgICAJCQkJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsNCj4+IC0JCQkJ
cmV0dXJuIC1FSU5WQUw7DQo+PiArCQkJCXJldCA9IC1FSU5WQUw7DQo+PiArCQkJCWdvdG8gcHJv
X2VuZDsNCj4+ICAgIAkJCX0NCj4+ICAgIAkJfQ0KPj4gICAgCX0NCj4+ICAgIAlwbV9ydW50aW1l
X21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1
c3BlbmQoZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gLQlyZXR1cm4gY291bnQ7DQo+PiArcHJvX2Vu
ZDoNCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsJcmV0dXJuIHJldDsNCj4+
ICAgIH0NCj4+ICAgIA0KPj4gICAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9vZF9jbGtf
dm9sdGFnZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiBAQCAtODYzLDcgKzkwMyw3IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfb2RfY2xrX3ZvbHRhZ2Uoc3RydWN0IGRldmljZSAqZGV2
LA0KPj4gICAgCXNzaXplX3Qgc2l6ZTsNCj4+ICAgIAlpbnQgcmV0Ow0KPj4gICAgDQo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1
X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCXJldCA9IHBt
X3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsNCj4+IEBAIC05MTcsNyArOTU3LDcgQEAgc3Rh
dGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9mZWF0dXJlcyhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+
PiAgICAJdWludDY0X3QgZmVhdHVyZW1hc2s7DQo+PiAgICAJaW50IHJldDsNCj4+ICAgIA0KPj4g
LQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmlu
X2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAgIAlyZXQg
PSBrc3RydG91NjQoYnVmLCAwLCAmZmVhdHVyZW1hc2spOw0KPj4gQEAgLTkzMiwxMSArOTcyLDEz
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZmVhdHVyZXMoc3RydWN0IGRldmljZSAq
ZGV2LA0KPj4gICAgCQlyZXR1cm4gcmV0Ow0KPj4gICAgCX0NCj4+ICAgIA0KPj4gKwlkb3duX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYp
KSB7DQo+PiAgICAJCXJldCA9IHNtdV9zeXNfc2V0X3BwX2ZlYXR1cmVfbWFzaygmYWRldi0+c211
LCBmZWF0dXJlbWFzayk7DQo+PiAgICAJCWlmIChyZXQpIHsNCj4+ICAgIAkJCXBtX3J1bnRpbWVf
bWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsNCj4+ICAgIAkJCXBtX3J1bnRpbWVfcHV0X2F1dG9z
dXNwZW5kKGRkZXYtPmRldik7DQo+PiArCQkJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+
ICAgIAkJCXJldHVybiAtRUlOVkFMOw0KPj4gICAgCQl9DQo+PiAgICAJfSBlbHNlIGlmIChhZGV2
LT5wb3dlcnBsYXkucHBfZnVuY3MtPnNldF9wcGZlYXR1cmVfc3RhdHVzKSB7DQo+PiBAQCAtOTQ0
LDkgKzk4NiwxMiBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2ZlYXR1cmVzKHN0cnVj
dCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJaWYgKHJldCkgew0KPj4gICAgCQkJcG1fcnVudGltZV9t
YXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOw0KPj4gICAgCQkJcG1fcnVudGltZV9wdXRfYXV0b3N1
c3BlbmQoZGRldi0+ZGV2KTsNCj4+ICsJCQl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4g
ICAgCQkJcmV0dXJuIC1FSU5WQUw7DQo+PiAgICAJCX0NCj4+ICAgIAl9DQo+PiArCXVwX3JlYWQo
JmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVz
eShkZGV2LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRl
dik7DQo+PiAgICANCj4+IEBAIC05NjIsNyArMTAwNyw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9nZXRfcHBfZmVhdHVyZXMoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCXNzaXplX3Qgc2l6
ZTsNCj4+ICAgIAlpbnQgcmV0Ow0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQp
DQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0
dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRl
di0+ZGV2KTsNCj4+IEBAIC05NzEsNiArMTAxNiw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9n
ZXRfcHBfZmVhdHVyZXMoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcmV0Ow0K
Pj4gICAgCX0NCj4+ICAgIA0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAr
DQo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPj4gICAgCQlzaXplID0gc211
X3N5c19nZXRfcHBfZmVhdHVyZV9tYXNrKCZhZGV2LT5zbXUsIGJ1Zik7DQo+PiAgICAJZWxzZSBp
ZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfcHBmZWF0dXJlX3N0YXR1cykNCj4+IEBA
IC05NzgsNiArMTAyNSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZmVhdHVyZXMo
c3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCWVsc2UNCj4+ICAgIAkJc2l6ZSA9IHNucHJpbnRm
KGJ1ZiwgUEFHRV9TSVpFLCAiXG4iKTsNCj4+ICAgIA0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOw0KPj4gKw0KPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2
KTsNCj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOw0KPj4gICAg
DQo+PiBAQCAtMTAyMyw3ICsxMDcyLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9k
cG1fc2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJc3NpemVfdCBzaXplOw0KPj4gICAg
CWludCByZXQ7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYg
KGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJN
Ow0KPj4gICAgDQo+PiAgICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOw0K
Pj4gQEAgLTEwMzIsNiArMTA4MSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBt
X3NjbGsoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcmV0Ow0KPj4gICAgCX0N
Cj4+ICAgIA0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJ
aWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPj4gICAgCQlzaXplID0gc211X3ByaW50X2Ns
a19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX1NDTEssIGJ1Zik7DQo+PiAgICAJZWxzZSBpZiAoYWRl
di0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5wcmludF9jbG9ja19sZXZlbHMpDQo+PiBAQCAtMTAzOSw2
ICsxMDkwLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fc2NsayhzdHJ1Y3Qg
ZGV2aWNlICpkZXYsDQo+PiAgICAJZWxzZQ0KPj4gICAgCQlzaXplID0gc25wcmludGYoYnVmLCBQ
QUdFX1NJWkUsICJcbiIpOw0KPj4gICAgDQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7
DQo+PiArDQo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOw0KPj4g
ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7DQo+PiAgICANCj4+IEBA
IC0xMDkxLDcgKzExNDQsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9zY2xr
KHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAlpbnQgcmV0Ow0KPj4gICAgCXVpbnQzMl90IG1h
c2sgPSAwOw0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChh
dG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsN
Cj4+ICAgIA0KPj4gICAgCXJldCA9IGFtZGdwdV9yZWFkX21hc2soYnVmLCBjb3VudCwgJm1hc2sp
Ow0KPj4gQEAgLTExMDQsMTEgKzExNTcsMTUgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9w
cF9kcG1fc2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiByZXQ7DQo+PiAg
ICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+
ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpDQo+PiAgICAJCXJldCA9IHNtdV9mb3Jj
ZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9TQ0xLLCBtYXNrLCB0cnVlKTsNCj4+ICAgIAll
bHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNlX2Nsb2NrX2xldmVsKQ0KPj4g
ICAgCQlyZXQgPSBhbWRncHVfZHBtX2ZvcmNlX2Nsb2NrX2xldmVsKGFkZXYsIFBQX1NDTEssIG1h
c2spOw0KPj4gICAgDQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAg
ICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRp
bWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7DQo+PiAgICANCj4+IEBAIC0xMTI3LDcgKzEx
ODQsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9tY2xrKHN0cnVjdCBkZXZp
Y2UgKmRldiwNCj4+ICAgIAlzc2l6ZV90IHNpemU7DQo+PiAgICAJaW50IHJldDsNCj4+ICAgIA0K
Pj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYt
PmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAgIAly
ZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7DQo+PiBAQCAtMTEzNiw2ICsxMTkz
LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fbWNsayhzdHJ1Y3QgZGV2aWNl
ICpkZXYsDQo+PiAgICAJCXJldHVybiByZXQ7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiArCWRvd25f
cmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19z
bXUoYWRldikpDQo+PiAgICAJCXNpemUgPSBzbXVfcHJpbnRfY2xrX2xldmVscygmYWRldi0+c211
LCBTTVVfTUNMSywgYnVmKTsNCj4+ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVu
Y3MtPnByaW50X2Nsb2NrX2xldmVscykNCj4+IEBAIC0xMTQzLDYgKzEyMDIsOCBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9tY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAg
IAllbHNlDQo+PiAgICAJCXNpemUgPSBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIlxuIik7DQo+
PiAgICANCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9y
dW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRf
YXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTExNTksNyArMTIyMCw3IEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX21jbGsoc3RydWN0IGRldmljZSAqZGV2
LA0KPj4gICAgCXVpbnQzMl90IG1hc2sgPSAwOw0KPj4gICAgCWludCByZXQ7DQo+PiAgICANCj4+
IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5p
bl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAgICAJcmV0
ID0gYW1kZ3B1X3JlYWRfbWFzayhidWYsIGNvdW50LCAmbWFzayk7DQo+PiBAQCAtMTE3MiwxMSAr
MTIzMywxNSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9tY2xrKHN0cnVjdCBk
ZXZpY2UgKmRldiwNCj4+ICAgIAkJcmV0dXJuIHJldDsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJ
ZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCWlmIChpc19zdXBwb3J0
X3N3X3NtdShhZGV2KSkNCj4+ICAgIAkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYt
PnNtdSwgU01VX01DTEssIG1hc2ssIHRydWUpOw0KPj4gICAgCWVsc2UgaWYgKGFkZXYtPnBvd2Vy
cGxheS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpDQo+PiAgICAJCXJldCA9IGFtZGdwdV9k
cG1fZm9yY2VfY2xvY2tfbGV2ZWwoYWRldiwgUFBfTUNMSywgbWFzayk7DQo+PiAgICANCj4+ICsJ
dXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtf
bGFzdF9idXN5KGRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQo
ZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTExOTUsNyArMTI2MCw3IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9nZXRfcHBfZHBtX3NvY2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJ
c3NpemVfdCBzaXplOw0KPj4gICAgCWludCByZXQ7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmlu
X2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0K
Pj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAgICAJcmV0ID0gcG1fcnVudGltZV9n
ZXRfc3luYyhkZGV2LT5kZXYpOw0KPj4gQEAgLTEyMDQsNiArMTI2OSw4IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9nZXRfcHBfZHBtX3NvY2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJ
CXJldHVybiByZXQ7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpDQo+PiAg
ICAJCXNpemUgPSBzbXVfcHJpbnRfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfU09DQ0xLLCBi
dWYpOw0KPj4gICAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+cHJpbnRfY2xv
Y2tfbGV2ZWxzKQ0KPj4gQEAgLTEyMTEsNiArMTI3OCw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9nZXRfcHBfZHBtX3NvY2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJZWxzZQ0KPj4g
ICAgCQlzaXplID0gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICJcbiIpOw0KPj4gICAgDQo+PiAr
CXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJcG1fcnVudGltZV9tYXJr
X2xhc3RfYnVzeShkZGV2LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5k
KGRkZXYtPmRldik7DQo+PiAgICANCj4+IEBAIC0xMjI3LDcgKzEyOTYsNyBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfc2V0X3BwX2RwbV9zb2NjbGsoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAg
CWludCByZXQ7DQo+PiAgICAJdWludDMyX3QgbWFzayA9IDA7DQo+PiAgICANCj4+IC0JaWYgKGFk
ZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVz
ZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAgICAJcmV0ID0gYW1kZ3B1
X3JlYWRfbWFzayhidWYsIGNvdW50LCAmbWFzayk7DQo+PiBAQCAtMTI0MCw2ICsxMzA5LDggQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fc29jY2xrKHN0cnVjdCBkZXZpY2UgKmRl
diwNCj4+ICAgIAkJcmV0dXJuIHJldDsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJZG93bl9yZWFk
KCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShh
ZGV2KSkNCj4+ICAgIAkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01V
X1NPQ0NMSywgbWFzaywgdHJ1ZSk7DQo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBw
X2Z1bmNzLT5mb3JjZV9jbG9ja19sZXZlbCkNCj4+IEBAIC0xMjQ3LDYgKzEzMTgsOCBAQCBzdGF0
aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9zb2NjbGsoc3RydWN0IGRldmljZSAqZGV2LA0K
Pj4gICAgCWVsc2UNCj4+ICAgIAkJcmV0ID0gMDsNCj4+ICAgIA0KPj4gKwl1cF9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRl
di0+ZGV2KTsNCj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOw0K
Pj4gICAgDQo+PiBAQCAtMTI2NSw3ICsxMzM4LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dl
dF9wcF9kcG1fZmNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJc3NpemVfdCBzaXplOw0K
Pj4gICAgCWludCByZXQ7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+
ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4g
LUVQRVJNOw0KPj4gICAgDQo+PiAgICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5k
ZXYpOw0KPj4gQEAgLTEyNzQsNiArMTM0Nyw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRf
cHBfZHBtX2ZjbGsoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcmV0Ow0KPj4g
ICAgCX0NCj4+ICAgIA0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+
PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPj4gICAgCQlzaXplID0gc211X3By
aW50X2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX0ZDTEssIGJ1Zik7DQo+PiAgICAJZWxzZSBp
ZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5wcmludF9jbG9ja19sZXZlbHMpDQo+PiBAQCAt
MTI4MSw2ICsxMzU2LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fZmNsayhz
dHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJZWxzZQ0KPj4gICAgCQlzaXplID0gc25wcmludGYo
YnVmLCBQQUdFX1NJWkUsICJcbiIpOw0KPj4gICAgDQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0
X3NlbSk7DQo+PiArDQo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYp
Ow0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7DQo+PiAgICAN
Cj4+IEBAIC0xMjk3LDcgKzEzNzQsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2Rw
bV9mY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAlpbnQgcmV0Ow0KPj4gICAgCXVpbnQz
Ml90IG1hc2sgPSAwOw0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiAr
CWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1F
UEVSTTsNCj4+ICAgIA0KPj4gICAgCXJldCA9IGFtZGdwdV9yZWFkX21hc2soYnVmLCBjb3VudCwg
Jm1hc2spOw0KPj4gQEAgLTEzMTAsNiArMTM4Nyw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9z
ZXRfcHBfZHBtX2ZjbGsoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcmV0Ow0K
Pj4gICAgCX0NCj4+ICAgIA0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAr
DQo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPj4gICAgCQlyZXQgPSBzbXVf
Zm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfRkNMSywgbWFzaywgdHJ1ZSk7DQo+PiAg
ICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5mb3JjZV9jbG9ja19sZXZlbCkN
Cj4+IEBAIC0xMzE3LDYgKzEzOTYsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2Rw
bV9mY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAllbHNlDQo+PiAgICAJCXJldCA9IDA7
DQo+PiAgICANCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlw
bV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9w
dXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTEzMzUsNyArMTQxNiw3
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX2RjZWZjbGsoc3RydWN0IGRldmlj
ZSAqZGV2LA0KPj4gICAgCXNzaXplX3Qgc2l6ZTsNCj4+ICAgIAlpbnQgcmV0Ow0KPj4gICAgDQo+
PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+
aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCXJl
dCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsNCj4+IEBAIC0xMzQ0LDYgKzE0MjUs
OCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9kY2VmY2xrKHN0cnVjdCBkZXZp
Y2UgKmRldiwNCj4+ICAgIAkJcmV0dXJuIHJldDsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJZG93
bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCWlmIChpc19zdXBwb3J0X3N3
X3NtdShhZGV2KSkNCj4+ICAgIAkJc2l6ZSA9IHNtdV9wcmludF9jbGtfbGV2ZWxzKCZhZGV2LT5z
bXUsIFNNVV9EQ0VGQ0xLLCBidWYpOw0KPj4gICAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5w
cF9mdW5jcy0+cHJpbnRfY2xvY2tfbGV2ZWxzKQ0KPj4gQEAgLTEzNTEsNiArMTQzNCw4IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX2RjZWZjbGsoc3RydWN0IGRldmljZSAqZGV2
LA0KPj4gICAgCWVsc2UNCj4+ICAgIAkJc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAi
XG4iKTsNCj4+ICAgIA0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4g
ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsNCj4+ICAgIAlwbV9ydW50
aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOw0KPj4gICAgDQo+PiBAQCAtMTM2Nyw3ICsx
NDUyLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fZGNlZmNsayhzdHJ1Y3Qg
ZGV2aWNlICpkZXYsDQo+PiAgICAJaW50IHJldDsNCj4+ICAgIAl1aW50MzJfdCBtYXNrID0gMDsN
Cj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3Jl
YWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAgICAN
Cj4+ICAgIAlyZXQgPSBhbWRncHVfcmVhZF9tYXNrKGJ1ZiwgY291bnQsICZtYXNrKTsNCj4+IEBA
IC0xMzgwLDYgKzE0NjUsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9kY2Vm
Y2xrKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJcmV0dXJuIHJldDsNCj4+ICAgIAl9DQo+
PiAgICANCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCWlm
IChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkNCj4+ICAgIAkJcmV0ID0gc211X2ZvcmNlX2Nsa19s
ZXZlbHMoJmFkZXYtPnNtdSwgU01VX0RDRUZDTEssIG1hc2ssIHRydWUpOw0KPj4gICAgCWVsc2Ug
aWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpDQo+PiBAQCAt
MTM4Nyw2ICsxNDc0LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fZGNlZmNs
ayhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJZWxzZQ0KPj4gICAgCQlyZXQgPSAwOw0KPj4g
ICAgDQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJcG1fcnVu
dGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1
dG9zdXNwZW5kKGRkZXYtPmRldik7DQo+PiAgICANCj4+IEBAIC0xNDA1LDcgKzE0OTQsNyBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9wY2llKHN0cnVjdCBkZXZpY2UgKmRldiwN
Cj4+ICAgIAlzc2l6ZV90IHNpemU7DQo+PiAgICAJaW50IHJldDsNCj4+ICAgIA0KPj4gLQlpZiAo
YWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9y
ZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAgIAlyZXQgPSBwbV9y
dW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7DQo+PiBAQCAtMTQxNCw2ICsxNTAzLDggQEAgc3Rh
dGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fcGNpZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+
PiAgICAJCXJldHVybiByZXQ7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikp
DQo+PiAgICAJCXNpemUgPSBzbXVfcHJpbnRfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfUENJ
RSwgYnVmKTsNCj4+ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPnByaW50
X2Nsb2NrX2xldmVscykNCj4+IEBAIC0xNDIxLDYgKzE1MTIsOCBAQCBzdGF0aWMgc3NpemVfdCBh
bWRncHVfZ2V0X3BwX2RwbV9wY2llKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAllbHNlDQo+
PiAgICAJCXNpemUgPSBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIlxuIik7DQo+PiAgICANCj4+
ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21h
cmtfbGFzdF9idXN5KGRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3Bl
bmQoZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTE0MzcsNyArMTUzMCw3IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3BjaWUoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAg
CWludCByZXQ7DQo+PiAgICAJdWludDMyX3QgbWFzayA9IDA7DQo+PiAgICANCj4+IC0JaWYgKGFk
ZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVz
ZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAgICAJcmV0ID0gYW1kZ3B1
X3JlYWRfbWFzayhidWYsIGNvdW50LCAmbWFzayk7DQo+PiBAQCAtMTQ1MCw2ICsxNTQzLDggQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fcGNpZShzdHJ1Y3QgZGV2aWNlICpkZXYs
DQo+PiAgICAJCXJldHVybiByZXQ7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRl
dikpDQo+PiAgICAJCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9Q
Q0lFLCBtYXNrLCB0cnVlKTsNCj4+ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVu
Y3MtPmZvcmNlX2Nsb2NrX2xldmVsKQ0KPj4gQEAgLTE0NTcsNiArMTU1Miw4IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3BjaWUoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAg
CWVsc2UNCj4+ICAgIAkJcmV0ID0gMDsNCj4+ICAgIA0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOw0KPj4gKw0KPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2
KTsNCj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOw0KPj4gICAg
DQo+PiBAQCAtMTQ3NSw3ICsxNTcyLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9z
Y2xrX29kKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAl1aW50MzJfdCB2YWx1ZSA9IDA7DQo+
PiAgICAJaW50IHJldDsNCj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4g
KwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAt
RVBFUk07DQo+PiAgICANCj4+ICAgIAlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRl
dik7DQo+PiBAQCAtMTQ4NCwxMSArMTU4MSwxNSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0
X3BwX3NjbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcmV0Ow0KPj4g
ICAgCX0NCj4+ICAgIA0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+
PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPj4gICAgCQl2YWx1ZSA9IHNtdV9n
ZXRfb2RfcGVyY2VudGFnZSgmKGFkZXYtPnNtdSksIFNNVV9PRF9TQ0xLKTsNCj4+ICAgIAllbHNl
IGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9zY2xrX29kKQ0KPj4gICAgCQl2YWx1
ZSA9IGFtZGdwdV9kcG1fZ2V0X3NjbGtfb2QoYWRldik7DQo+PiAgICANCj4+ICsJdXBfcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2
KTsNCj4+ICAgIA0KPj4gQEAgLTE1MDUsNyArMTYwNiw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9zZXRfcHBfc2Nsa19vZChzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJaW50IHJldDsNCj4+
ICAgIAlsb25nIGludCB2YWx1ZTsNCj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0
KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJl
dHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAgIAlyZXQgPSBrc3RydG9sKGJ1ZiwgMCwgJnZhbHVl
KTsNCj4+IEBAIC0xNTE5LDYgKzE2MjAsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3Bw
X3NjbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcmV0Ow0KPj4gICAg
CX0NCj4+ICAgIA0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAg
ICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7DQo+PiAgICAJCXZhbHVlID0gc211X3Nl
dF9vZF9wZXJjZW50YWdlKCYoYWRldi0+c211KSwgU01VX09EX1NDTEssICh1aW50MzJfdCl2YWx1
ZSk7DQo+PiAgICAJfSBlbHNlIHsNCj4+IEBAIC0xNTMzLDYgKzE2MzYsOCBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfc2V0X3BwX3NjbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQl9
DQo+PiAgICAJfQ0KPj4gICAgDQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAr
DQo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOw0KPj4gICAgCXBt
X3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7DQo+PiAgICANCj4+IEBAIC0xNTQ4
LDcgKzE2NTMsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX21jbGtfb2Qoc3RydWN0
IGRldmljZSAqZGV2LA0KPj4gICAgCXVpbnQzMl90IHZhbHVlID0gMDsNCj4+ICAgIAlpbnQgcmV0
Ow0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNf
cmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAg
IA0KPj4gICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsNCj4+IEBAIC0x
NTU3LDExICsxNjYyLDE1IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfbWNsa19vZChz
dHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiByZXQ7DQo+PiAgICAJfQ0KPj4gICAg
DQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlpZiAoaXNf
c3VwcG9ydF9zd19zbXUoYWRldikpDQo+PiAgICAJCXZhbHVlID0gc211X2dldF9vZF9wZXJjZW50
YWdlKCYoYWRldi0+c211KSwgU01VX09EX01DTEspOw0KPj4gICAgCWVsc2UgaWYgKGFkZXYtPnBv
d2VycGxheS5wcF9mdW5jcy0+Z2V0X21jbGtfb2QpDQo+PiAgICAJCXZhbHVlID0gYW1kZ3B1X2Rw
bV9nZXRfbWNsa19vZChhZGV2KTsNCj4+ICAgIA0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9z
ZW0pOw0KPj4gKw0KPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsN
Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOw0KPj4gICAgDQo+
PiBAQCAtMTU3OCw3ICsxNjg3LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9tY2xr
X29kKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAlpbnQgcmV0Ow0KPj4gICAgCWxvbmcgaW50
IHZhbHVlOw0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChh
dG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsN
Cj4+ICAgIA0KPj4gICAgCXJldCA9IGtzdHJ0b2woYnVmLCAwLCAmdmFsdWUpOw0KPj4gQEAgLTE1
OTIsNiArMTcwMSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfbWNsa19vZChzdHJ1
Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiByZXQ7DQo+PiAgICAJfQ0KPj4gICAgDQo+
PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlpZiAoaXNfc3Vw
cG9ydF9zd19zbXUoYWRldikpIHsNCj4+ICAgIAkJdmFsdWUgPSBzbXVfc2V0X29kX3BlcmNlbnRh
Z2UoJihhZGV2LT5zbXUpLCBTTVVfT0RfTUNMSywgKHVpbnQzMl90KXZhbHVlKTsNCj4+ICAgIAl9
IGVsc2Ugew0KPj4gQEAgLTE2MDYsNiArMTcxNyw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9z
ZXRfcHBfbWNsa19vZChzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCX0NCj4+ICAgIAl9DQo+
PiAgICANCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9y
dW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRf
YXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTE2NDEsNyArMTc1NCw3IEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfcG93ZXJfcHJvZmlsZV9tb2RlKHN0cnVjdCBk
ZXZpY2UgKmRldiwNCj4+ICAgIAlzc2l6ZV90IHNpemU7DQo+PiAgICAJaW50IHJldDsNCj4+ICAg
IA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFk
ZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAg
IAlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7DQo+PiBAQCAtMTY1MCw2ICsx
NzYzLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9wb3dlcl9wcm9maWxlX21vZGUo
c3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcmV0Ow0KPj4gICAgCX0NCj4+ICAg
IA0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJaWYgKGlz
X3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPj4gICAgCQlzaXplID0gc211X2dldF9wb3dlcl9wcm9m
aWxlX21vZGUoJmFkZXYtPnNtdSwgYnVmKTsNCj4+ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBs
YXkucHBfZnVuY3MtPmdldF9wb3dlcl9wcm9maWxlX21vZGUpDQo+PiBAQCAtMTY1Nyw2ICsxNzcy
LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9wb3dlcl9wcm9maWxlX21vZGUoc3Ry
dWN0IGRldmljZSAqZGV2LA0KPj4gICAgCWVsc2UNCj4+ICAgIAkJc2l6ZSA9IHNucHJpbnRmKGJ1
ZiwgUEFHRV9TSVpFLCAiXG4iKTsNCj4+ICAgIA0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9z
ZW0pOw0KPj4gKw0KPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsN
Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOw0KPj4gICAgDQo+
PiBAQCAtMTY4MSw3ICsxNzk4LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9wb3dl
cl9wcm9maWxlX21vZGUoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCWxvbmcgaW50IHByb2Zp
bGVfbW9kZSA9IDA7DQo+PiAgICAJY29uc3QgY2hhciBkZWxpbWl0ZXJbM10gPSB7JyAnLCAnXG4n
LCAnXDAnfTsNCj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAo
YXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07
DQo+PiAgICANCj4+ICAgIAl0bXBbMF0gPSAqKGJ1Zik7DQo+PiBAQCAtMTcxNSwxMSArMTgzMiwx
NSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX3Bvd2VyX3Byb2ZpbGVfbW9kZShzdHJ1
Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiByZXQ7DQo+PiAgICAJfQ0KPj4gICAgDQo+
PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlpZiAoaXNfc3Vw
cG9ydF9zd19zbXUoYWRldikpDQo+PiAgICAJCXJldCA9IHNtdV9zZXRfcG93ZXJfcHJvZmlsZV9t
b2RlKCZhZGV2LT5zbXUsIHBhcmFtZXRlciwgcGFyYW1ldGVyX3NpemUsIHRydWUpOw0KPj4gICAg
CWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+c2V0X3Bvd2VyX3Byb2ZpbGVfbW9k
ZSkNCj4+ICAgIAkJcmV0ID0gYW1kZ3B1X2RwbV9zZXRfcG93ZXJfcHJvZmlsZV9tb2RlKGFkZXYs
IHBhcmFtZXRlciwgcGFyYW1ldGVyX3NpemUpOw0KPj4gICAgDQo+PiArCXVwX3JlYWQoJmFkZXYt
PnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2
LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7DQo+
PiAgICANCj4+IEBAIC0xNzQ1LDcgKzE4NjYsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0
X2dwdV9idXN5X3BlcmNlbnQoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCXN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2ID0gZGRldi0+ZGV2X3ByaXZhdGU7DQo+PiAgICAJaW50IHIsIHZhbHVl
LCBzaXplID0gc2l6ZW9mKHZhbHVlKTsNCj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jl
c2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJ
CXJldHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAgIAlyID0gcG1fcnVudGltZV9nZXRfc3luYyhk
ZGV2LT5kZXYpOw0KPj4gQEAgLTE3NTQsOSArMTg3NSwxMSBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfZ2V0X2dwdV9idXN5X3BlcmNlbnQoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1
cm4gcjsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Ow0KPj4gICAgCS8qIHJlYWQgdGhlIElQIGJ1c3kgc2Vuc29yICovDQo+PiAgICAJciA9IGFtZGdw
dV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9HUFVfTE9BRCwNCj4+ICAg
IAkJCQkgICAodm9pZCAqKSZ2YWx1ZSwgJnNpemUpOw0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOw0KPj4gICAgDQo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5k
ZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7DQo+PiBA
QCAtMTc4Myw3ICsxOTA2LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9tZW1fYnVzeV9w
ZXJjZW50KHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiA9IGRkZXYtPmRldl9wcml2YXRlOw0KPj4gICAgCWludCByLCB2YWx1ZSwgc2l6ZSA9IHNp
emVvZih2YWx1ZSk7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJ
aWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQ
RVJNOw0KPj4gICAgDQo+PiAgICAJciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsN
Cj4+IEBAIC0xNzkyLDEwICsxOTE1LDE0IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfbWVt
X2J1c3lfcGVyY2VudChzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiByOw0KPj4g
ICAgCX0NCj4+ICAgIA0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+
PiAgICAJLyogcmVhZCB0aGUgSVAgYnVzeSBzZW5zb3IgKi8NCj4+ICAgIAlyID0gYW1kZ3B1X2Rw
bV9yZWFkX3NlbnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX01FTV9MT0FELA0KPj4gICAgCQkJ
CSAgICh2b2lkICopJnZhbHVlLCAmc2l6ZSk7DQo+PiAgICANCj4+ICsJdXBfcmVhZCgmYWRldi0+
cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYt
PmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsNCj4+
ICAgIA0KPj4gQEAgLTE4MjYsNyArMTk1Myw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRf
cGNpZV9idyhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJdWludDY0X3QgY291bnQwID0gMCwg
Y291bnQxID0gMDsNCj4+ICAgIAlpbnQgcmV0Ow0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9n
cHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+
ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCWlmIChhZGV2LT5mbGFncyAmIEFN
RF9JU19BUFUpDQo+PiBAQCAtMTg0MSw4ICsxOTY4LDEyIEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9nZXRfcGNpZV9idyhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiByZXQ7DQo+
PiAgICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsN
Cj4+ICAgIAlhbWRncHVfYXNpY19nZXRfcGNpZV91c2FnZShhZGV2LCAmY291bnQwLCAmY291bnQx
KTsNCj4+ICAgIA0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAg
CXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsNCj4+ICAgIAlwbV9ydW50aW1l
X3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOw0KPj4gICAgDQo+PiBAQCAtMTg2Nyw3ICsxOTk4
LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF91bmlxdWVfaWQoc3RydWN0IGRldmljZSAq
ZGV2LA0KPj4gICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gZGV2X2dldF9kcnZkYXRhKGRl
dik7DQo+PiAgICAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBkZGV2LT5kZXZfcHJpdmF0
ZTsNCj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWlj
X3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAg
ICANCj4+ICAgIAlpZiAoYWRldi0+dW5pcXVlX2lkKQ0KPj4gQEAgLTIxMzQsNyArMjI2NSw3IEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93X3RlbXAoc3RydWN0IGRldmljZSAqZGV2
LA0KPj4gICAgCWludCBjaGFubmVsID0gdG9fc2Vuc29yX2Rldl9hdHRyKGF0dHIpLT5pbmRleDsN
Cj4+ICAgIAlpbnQgciwgdGVtcCA9IDAsIHNpemUgPSBzaXplb2YodGVtcCk7DQo+PiAgICANCj4+
IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5p
bl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAgICAJaWYg
KGNoYW5uZWwgPj0gUFBfVEVNUF9NQVgpDQo+PiBAQCAtMjE0Niw2ICsyMjc3LDggQEAgc3RhdGlj
IHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfdGVtcChzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAg
ICAJCXJldHVybiByOw0KPj4gICAgCX0NCj4+ICAgIA0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJl
c2V0X3NlbSk7DQo+PiArDQo+PiAgICAJc3dpdGNoIChjaGFubmVsKSB7DQo+PiAgICAJY2FzZSBQ
UF9URU1QX0pVTkNUSU9OOg0KPj4gICAgCQkvKiBnZXQgY3VycmVudCBqdW5jdGlvbiB0ZW1wZXJh
dHVyZSAqLw0KPj4gQEAgLTIxNjcsNiArMjMwMCw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9o
d21vbl9zaG93X3RlbXAoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlicmVhazsNCj4+ICAg
IAl9DQo+PiAgICANCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAg
IAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7DQo+PiAgICAJcG1f
cnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAg
LTIyNzAsNyArMjQwNSw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfcHdtMV9l
bmFibGUoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCXUzMiBwd21fbW9kZSA9IDA7DQo+PiAg
ICAJaW50IHJldDsNCj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlp
ZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBF
Uk07DQo+PiAgICANCj4+ICAgIAlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRkZXYt
PmRldik7DQo+PiBAQCAtMjI3OSwxOCArMjQxNCwyMyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVf
aHdtb25fZ2V0X3B3bTFfZW5hYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJcmV0dXJu
IHJldDsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Ow0KPj4gKw0KPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgew0KPj4gICAgCQlw
d21fbW9kZSA9IHNtdV9nZXRfZmFuX2NvbnRyb2xfbW9kZSgmYWRldi0+c211KTsNCj4+ICAgIAl9
IGVsc2Ugew0KPj4gICAgCQlpZiAoIWFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0X2Zhbl9j
b250cm9sX21vZGUpIHsNCj4+ICAgIAkJCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+
ZGRldi0+ZGV2KTsNCj4+ICAgIAkJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRk
ZXYtPmRldik7DQo+PiArCQkJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICAgIAkJCXJl
dHVybiAtRUlOVkFMOw0KPj4gICAgCQl9DQo+PiAgICANCj4+ICAgIAkJcHdtX21vZGUgPSBhbWRn
cHVfZHBtX2dldF9mYW5fY29udHJvbF9tb2RlKGFkZXYpOw0KPj4gICAgCX0NCj4+ICAgIA0KPj4g
Kwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCXBtX3J1bnRpbWVfbWFy
a19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsNCj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRv
c3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOw0KPj4gICAgDQo+PiBAQCAtMjMwNiw3ICsyNDQ2LDcg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9wd20xX2VuYWJsZShzdHJ1Y3QgZGV2
aWNlICpkZXYsDQo+PiAgICAJaW50IGVyciwgcmV0Ow0KPj4gICAgCWludCB2YWx1ZTsNCj4+ICAg
IA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFk
ZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAg
IAllcnIgPSBrc3RydG9pbnQoYnVmLCAxMCwgJnZhbHVlKTsNCj4+IEBAIC0yMzE5LDE4ICsyNDU5
LDIzIEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zZXRfcHdtMV9lbmFibGUoc3RydWN0
IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcmV0Ow0KPj4gICAgCX0NCj4+ICAgIA0KPj4g
Kwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJaWYgKGlzX3N1cHBv
cnRfc3dfc211KGFkZXYpKSB7DQo+PiAgICAJCXNtdV9zZXRfZmFuX2NvbnRyb2xfbW9kZSgmYWRl
di0+c211LCB2YWx1ZSk7DQo+PiAgICAJfSBlbHNlIHsNCj4+ICAgIAkJaWYgKCFhZGV2LT5wb3dl
cnBsYXkucHBfZnVuY3MtPnNldF9mYW5fY29udHJvbF9tb2RlKSB7DQo+PiAgICAJCQlwbV9ydW50
aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7DQo+PiAgICAJCQlwbV9ydW50aW1l
X3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOw0KPj4gKwkJCXVwX3JlYWQoJmFkZXYt
PnJlc2V0X3NlbSk7DQo+PiAgICAJCQlyZXR1cm4gLUVJTlZBTDsNCj4+ICAgIAkJfQ0KPj4gICAg
DQo+PiAgICAJCWFtZGdwdV9kcG1fc2V0X2Zhbl9jb250cm9sX21vZGUoYWRldiwgdmFsdWUpOw0K
Pj4gICAgCX0NCj4+ICAgIA0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0K
Pj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsNCj4+ICAg
IAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOw0KPj4gICAgDQo+
PiBAQCAtMjM2MCw3ICsyNTA1LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9w
d20xKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAl1MzIgdmFsdWU7DQo+PiAgICAJdTMyIHB3
bV9tb2RlOw0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChh
dG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsN
Cj4+ICAgIA0KPj4gICAgCWVyciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2
KTsNCj4+IEBAIC0yMzY5LDExICsyNTE0LDE1IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21v
bl9zZXRfcHdtMShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiBlcnI7DQo+PiAg
ICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+
ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpDQo+PiAgICAJCXB3bV9tb2RlID0gc211
X2dldF9mYW5fY29udHJvbF9tb2RlKCZhZGV2LT5zbXUpOw0KPj4gICAgCWVsc2UNCj4+ICAgIAkJ
cHdtX21vZGUgPSBhbWRncHVfZHBtX2dldF9mYW5fY29udHJvbF9tb2RlKGFkZXYpOw0KPj4gICAg
DQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJaWYgKHB3bV9t
b2RlICE9IEFNRF9GQU5fQ1RSTF9NQU5VQUwpIHsNCj4+ICAgIAkJcHJfaW5mbygibWFudWFsIGZh
biBzcGVlZCBjb250cm9sIHNob3VsZCBiZSBlbmFibGVkIGZpcnN0XG4iKTsNCj4+ICAgIAkJcG1f
cnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOw0KPj4gQEAgLTI0MTQsNyAr
MjU2Myw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfcHdtMShzdHJ1Y3QgZGV2
aWNlICpkZXYsDQo+PiAgICAJaW50IGVycjsNCj4+ICAgIAl1MzIgc3BlZWQgPSAwOw0KPj4gICAg
DQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRl
di0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAg
CWVyciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsNCj4+IEBAIC0yNDIz
LDYgKzI1NzIsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X3B3bTEoc3RydWN0
IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gZXJyOw0KPj4gICAgCX0NCj4+ICAgIA0KPj4g
Kwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJaWYgKGlzX3N1cHBv
cnRfc3dfc211KGFkZXYpKQ0KPj4gICAgCQllcnIgPSBzbXVfZ2V0X2Zhbl9zcGVlZF9wZXJjZW50
KCZhZGV2LT5zbXUsICZzcGVlZCk7DQo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBw
X2Z1bmNzLT5nZXRfZmFuX3NwZWVkX3BlcmNlbnQpDQo+PiBAQCAtMjQzMCw2ICsyNTgxLDggQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dldF9wd20xKHN0cnVjdCBkZXZpY2UgKmRldiwN
Cj4+ICAgIAllbHNlDQo+PiAgICAJCWVyciA9IC1FSU5WQUw7DQo+PiAgICANCj4+ICsJdXBfcmVh
ZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9i
dXN5KGFkZXYtPmRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQo
YWRldi0+ZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTI0NDksNyArMjYwMiw3IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfZmFuMV9pbnB1dChzdHJ1Y3QgZGV2aWNlICpkZXYs
DQo+PiAgICAJaW50IGVycjsNCj4+ICAgIAl1MzIgc3BlZWQgPSAwOw0KPj4gICAgDQo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1
X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCWVyciA9IHBt
X3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsNCj4+IEBAIC0yNDU4LDYgKzI2MTEs
OCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X2ZhbjFfaW5wdXQoc3RydWN0IGRl
dmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gZXJyOw0KPj4gICAgCX0NCj4+ICAgIA0KPj4gKwlk
b3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJaWYgKGlzX3N1cHBvcnRf
c3dfc211KGFkZXYpKQ0KPj4gICAgCQllcnIgPSBzbXVfZ2V0X2Zhbl9zcGVlZF9ycG0oJmFkZXYt
PnNtdSwgJnNwZWVkKTsNCj4+ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3Mt
PmdldF9mYW5fc3BlZWRfcnBtKQ0KPj4gQEAgLTI0NjUsNiArMjYyMCw4IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9od21vbl9nZXRfZmFuMV9pbnB1dChzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAg
ICAJZWxzZQ0KPj4gICAgCQllcnIgPSAtRUlOVkFMOw0KPj4gICAgDQo+PiArCXVwX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShh
ZGV2LT5kZGV2LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYt
PmRkZXYtPmRldik7DQo+PiAgICANCj4+IEBAIC0yNDgzLDcgKzI2NDAsNyBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfaHdtb25fZ2V0X2ZhbjFfbWluKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAg
IAl1MzIgc2l6ZSA9IHNpemVvZihtaW5fcnBtKTsNCj4+ICAgIAlpbnQgcjsNCj4+ICAgIA0KPj4g
LQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmlu
X2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAgIAlyID0g
cG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOw0KPj4gQEAgLTI0OTIsOSArMjY0
OSwxMyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X2ZhbjFfbWluKHN0cnVjdCBk
ZXZpY2UgKmRldiwNCj4+ICAgIAkJcmV0dXJuIHI7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiArCWRv
d25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlyID0gYW1kZ3B1X2RwbV9y
ZWFkX3NlbnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX01JTl9GQU5fUlBNLA0KPj4gICAgCQkJ
CSAgICh2b2lkICopJm1pbl9ycG0sICZzaXplKTsNCj4+ICAgIA0KPj4gKwl1cF9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRl
di0+ZGRldi0+ZGV2KTsNCj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5k
ZGV2LT5kZXYpOw0KPj4gICAgDQo+PiBAQCAtMjUxMyw3ICsyNjc0LDcgQEAgc3RhdGljIHNzaXpl
X3QgYW1kZ3B1X2h3bW9uX2dldF9mYW4xX21heChzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJ
dTMyIHNpemUgPSBzaXplb2YobWF4X3JwbSk7DQo+PiAgICAJaW50IHI7DQo+PiAgICANCj4+IC0J
aWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9n
cHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAgICAJciA9IHBt
X3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsNCj4+IEBAIC0yNTIyLDkgKzI2ODMs
MTMgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dldF9mYW4xX21heChzdHJ1Y3QgZGV2
aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiByOw0KPj4gICAgCX0NCj4+ICAgIA0KPj4gKwlkb3du
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJciA9IGFtZGdwdV9kcG1fcmVh
ZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9NQVhfRkFOX1JQTSwNCj4+ICAgIAkJCQkg
ICAodm9pZCAqKSZtYXhfcnBtLCAmc2l6ZSk7DQo+PiAgICANCj4+ICsJdXBfcmVhZCgmYWRldi0+
cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYt
PmRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRl
di0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTI1NDIsNyArMjcwNyw3IEBAIHN0YXRpYyBzc2l6ZV90
IGFtZGdwdV9od21vbl9nZXRfZmFuMV90YXJnZXQoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAg
CWludCBlcnI7DQo+PiAgICAJdTMyIHJwbSA9IDA7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmlu
X2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0K
Pj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAgICAJZXJyID0gcG1fcnVudGltZV9n
ZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOw0KPj4gQEAgLTI1NTEsNiArMjcxNiw4IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfZmFuMV90YXJnZXQoc3RydWN0IGRldmljZSAqZGV2
LA0KPj4gICAgCQlyZXR1cm4gZXJyOw0KPj4gICAgCX0NCj4+ICAgIA0KPj4gKwlkb3duX3JlYWQo
JmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFk
ZXYpKQ0KPj4gICAgCQllcnIgPSBzbXVfZ2V0X2Zhbl9zcGVlZF9ycG0oJmFkZXYtPnNtdSwgJnJw
bSk7DQo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfZmFuX3Nw
ZWVkX3JwbSkNCj4+IEBAIC0yNTU4LDYgKzI3MjUsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVf
aHdtb25fZ2V0X2ZhbjFfdGFyZ2V0KHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAllbHNlDQo+
PiAgICAJCWVyciA9IC1FSU5WQUw7DQo+PiAgICANCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYt
PmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2
KTsNCj4+ICAgIA0KPj4gQEAgLTI1NzYsNyArMjc0NSw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9od21vbl9zZXRfZmFuMV90YXJnZXQoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCXUzMiB2
YWx1ZTsNCj4+ICAgIAl1MzIgcHdtX21vZGU7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmluX2dw
dV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4g
ICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAgICAJZXJyID0gcG1fcnVudGltZV9nZXRf
c3luYyhhZGV2LT5kZGV2LT5kZXYpOw0KPj4gQEAgLTI1ODUsMTEgKzI3NTQsMTUgQEAgc3RhdGlj
IHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9mYW4xX3RhcmdldChzdHJ1Y3QgZGV2aWNlICpkZXYs
DQo+PiAgICAJCXJldHVybiBlcnI7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRl
dikpDQo+PiAgICAJCXB3bV9tb2RlID0gc211X2dldF9mYW5fY29udHJvbF9tb2RlKCZhZGV2LT5z
bXUpOw0KPj4gICAgCWVsc2UNCj4+ICAgIAkJcHdtX21vZGUgPSBhbWRncHVfZHBtX2dldF9mYW5f
Y29udHJvbF9tb2RlKGFkZXYpOw0KPj4gICAgDQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3Nl
bSk7DQo+PiArDQo+PiAgICAJaWYgKHB3bV9tb2RlICE9IEFNRF9GQU5fQ1RSTF9NQU5VQUwpIHsN
Cj4+ICAgIAkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOw0KPj4g
ICAgCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOw0KPj4gQEAg
LTI2MDMsNiArMjc3Niw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zZXRfZmFuMV90
YXJnZXQoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gZXJyOw0KPj4gICAgCX0N
Cj4+ICAgIA0KPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJ
aWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPj4gICAgCQllcnIgPSBzbXVfc2V0X2Zhbl9z
cGVlZF9ycG0oJmFkZXYtPnNtdSwgdmFsdWUpOw0KPj4gICAgCWVsc2UgaWYgKGFkZXYtPnBvd2Vy
cGxheS5wcF9mdW5jcy0+c2V0X2Zhbl9zcGVlZF9ycG0pDQo+PiBAQCAtMjYxMCw2ICsyNzg1LDgg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9mYW4xX3RhcmdldChzdHJ1Y3QgZGV2
aWNlICpkZXYsDQo+PiAgICAJZWxzZQ0KPj4gICAgCQllcnIgPSAtRUlOVkFMOw0KPj4gICAgDQo+
PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJcG1fcnVudGltZV9t
YXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1
dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7DQo+PiAgICANCj4+IEBAIC0yNjI3LDcgKzI4MDQs
NyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X2ZhbjFfZW5hYmxlKHN0cnVjdCBk
ZXZpY2UgKmRldiwNCj4+ICAgIAl1MzIgcHdtX21vZGUgPSAwOw0KPj4gICAgCWludCByZXQ7DQo+
PiAgICANCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFk
KCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+
PiAgICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOw0KPj4gQEAg
LTI2MzYsMTggKzI4MTMsMjMgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dldF9mYW4x
X2VuYWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiByZXQ7DQo+PiAgICAJ
fQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAg
IAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsNCj4+ICAgIAkJcHdtX21vZGUgPSBzbXVf
Z2V0X2Zhbl9jb250cm9sX21vZGUoJmFkZXYtPnNtdSk7DQo+PiAgICAJfSBlbHNlIHsNCj4+ICAg
IAkJaWYgKCFhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9mYW5fY29udHJvbF9tb2RlKSB7
DQo+PiAgICAJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7DQo+
PiAgICAJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOw0KPj4g
KwkJCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICAJCQlyZXR1cm4gLUVJTlZBTDsN
Cj4+ICAgIAkJfQ0KPj4gICAgDQo+PiAgICAJCXB3bV9tb2RlID0gYW1kZ3B1X2RwbV9nZXRfZmFu
X2NvbnRyb2xfbW9kZShhZGV2KTsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJdXBfcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFk
ZXYtPmRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+
ZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTI2NjQsNyArMjg0Niw3IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9od21vbl9zZXRfZmFuMV9lbmFibGUoc3RydWN0IGRldmljZSAqZGV2LA0KPj4g
ICAgCWludCB2YWx1ZTsNCj4+ICAgIAl1MzIgcHdtX21vZGU7DQo+PiAgICANCj4+IC0JaWYgKGFk
ZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVz
ZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAgICAJZXJyID0ga3N0cnRv
aW50KGJ1ZiwgMTAsICZ2YWx1ZSk7DQo+PiBAQCAtMjY4NCwxNyArMjg2NiwyMiBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfaHdtb25fc2V0X2ZhbjFfZW5hYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwN
Cj4+ICAgIAkJcmV0dXJuIGVycjsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJZG93bl9yZWFkKCZh
ZGV2LT5yZXNldF9zZW0pOw0KPj4gKw0KPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2
KSkgew0KPj4gICAgCQlzbXVfc2V0X2Zhbl9jb250cm9sX21vZGUoJmFkZXYtPnNtdSwgcHdtX21v
ZGUpOw0KPj4gICAgCX0gZWxzZSB7DQo+PiAgICAJCWlmICghYWRldi0+cG93ZXJwbGF5LnBwX2Z1
bmNzLT5zZXRfZmFuX2NvbnRyb2xfbW9kZSkgew0KPj4gICAgCQkJcG1fcnVudGltZV9tYXJrX2xh
c3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOw0KPj4gICAgCQkJcG1fcnVudGltZV9wdXRfYXV0b3N1
c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsNCj4+ICsJCQl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Ow0KPj4gICAgCQkJcmV0dXJuIC1FSU5WQUw7DQo+PiAgICAJCX0NCj4+ICAgIAkJYW1kZ3B1X2Rw
bV9zZXRfZmFuX2NvbnRyb2xfbW9kZShhZGV2LCBwd21fbW9kZSk7DQo+PiAgICAJfQ0KPj4gICAg
DQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiArDQo+PiAgICAJcG1fcnVudGlt
ZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0
X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7DQo+PiAgICANCj4+IEBAIC0yNzA5LDcgKzI4
OTYsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd192ZGRnZngoc3RydWN0IGRl
dmljZSAqZGV2LA0KPj4gICAgCXUzMiB2ZGRnZng7DQo+PiAgICAJaW50IHIsIHNpemUgPSBzaXpl
b2YodmRkZ2Z4KTsNCj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlp
ZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBF
Uk07DQo+PiAgICANCj4+ICAgIAlyID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5k
ZXYpOw0KPj4gQEAgLTI3MTgsOSArMjkwNSwxMSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdt
b25fc2hvd192ZGRnZngoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcjsNCj4+
ICAgIAl9DQo+PiAgICANCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gICAg
CS8qIGdldCB0aGUgdm9sdGFnZSAqLw0KPj4gICAgCXIgPSBhbWRncHVfZHBtX3JlYWRfc2Vuc29y
KGFkZXYsIEFNREdQVV9QUF9TRU5TT1JfVkRER0ZYLA0KPj4gICAgCQkJCSAgICh2b2lkICopJnZk
ZGdmeCwgJnNpemUpOw0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gICAgDQo+
PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOw0KPj4gICAg
CXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7DQo+PiBAQCAtMjc0
Niw3ICsyOTM1LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfdmRkbmIoc3Ry
dWN0IGRldmljZSAqZGV2LA0KPj4gICAgCXUzMiB2ZGRuYjsNCj4+ICAgIAlpbnQgciwgc2l6ZSA9
IHNpemVvZih2ZGRuYik7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+
ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4g
LUVQRVJNOw0KPj4gICAgDQo+PiAgICAJLyogb25seSBBUFVzIGhhdmUgdmRkbmIgKi8NCj4+IEBA
IC0yNzU5LDkgKzI5NDgsMTEgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfdmRk
bmIoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcjsNCj4+ICAgIAl9DQo+PiAg
ICANCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gICAgCS8qIGdldCB0aGUg
dm9sdGFnZSAqLw0KPj4gICAgCXIgPSBhbWRncHVfZHBtX3JlYWRfc2Vuc29yKGFkZXYsIEFNREdQ
VV9QUF9TRU5TT1JfVkRETkIsDQo+PiAgICAJCQkJICAgKHZvaWQgKikmdmRkbmIsICZzaXplKTsN
Cj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICAgIA0KPj4gICAgCXBtX3J1bnRp
bWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsNCj4+ICAgIAlwbV9ydW50aW1lX3B1
dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOw0KPj4gQEAgLTI3ODgsNyArMjk3OSw3IEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93X3Bvd2VyX2F2ZyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsDQo+PiAgICAJaW50IHIsIHNpemUgPSBzaXplb2YodTMyKTsNCj4+ICAgIAl1bnNpZ25l
ZCB1dzsNCj4+ICAgIA0KPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRv
bWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+
PiAgICANCj4+ICAgIAlyID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOw0K
Pj4gQEAgLTI3OTcsOSArMjk4OCwxMSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hv
d19wb3dlcl9hdmcoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcjsNCj4+ICAg
IAl9DQo+PiAgICANCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gICAgCS8q
IGdldCB0aGUgdm9sdGFnZSAqLw0KPj4gICAgCXIgPSBhbWRncHVfZHBtX3JlYWRfc2Vuc29yKGFk
ZXYsIEFNREdQVV9QUF9TRU5TT1JfR1BVX1BPV0VSLA0KPj4gICAgCQkJCSAgICh2b2lkICopJnF1
ZXJ5LCAmc2l6ZSk7DQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICANCj4+
ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7DQo+PiAgICAJ
cG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsNCj4+IEBAIC0yODI5
LDcgKzMwMjIsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19wb3dlcl9jYXBf
bWF4KHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAlzc2l6ZV90IHNpemU7DQo+PiAgICAJaW50
IHI7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21p
Y19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4g
ICAgDQo+PiAgICAJciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsNCj4+
IEBAIC0yODM4LDYgKzMwMzEsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19w
b3dlcl9jYXBfbWF4KHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJcmV0dXJuIHI7DQo+PiAg
ICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+
ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsNCj4+ICAgIAkJc211X2dldF9wb3dl
cl9saW1pdCgmYWRldi0+c211LCAmbGltaXQsIHRydWUpOw0KPj4gICAgCQlzaXplID0gc25wcmlu
dGYoYnVmLCBQQUdFX1NJWkUsICIldVxuIiwgbGltaXQgKiAxMDAwMDAwKTsNCj4+IEBAIC0yODQ4
LDYgKzMwNDMsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19wb3dlcl9jYXBf
bWF4KHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgUEFH
RV9TSVpFLCAiXG4iKTsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRk
ZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+
ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTI4NjMsNyArMzA2MCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9od21vbl9zaG93X3Bvd2VyX2NhcChzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJc3Np
emVfdCBzaXplOw0KPj4gICAgCWludCByOw0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVf
cmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAg
IAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCXIgPSBwbV9ydW50aW1lX2dldF9zeW5j
KGFkZXYtPmRkZXYtPmRldik7DQo+PiBAQCAtMjg3Miw2ICszMDY5LDggQEAgc3RhdGljIHNzaXpl
X3QgYW1kZ3B1X2h3bW9uX3Nob3dfcG93ZXJfY2FwKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAg
IAkJcmV0dXJuIHI7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsNCj4+
ICAgIAkJc211X2dldF9wb3dlcl9saW1pdCgmYWRldi0+c211LCAmbGltaXQsIGZhbHNlKTsNCj4+
ICAgIAkJc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJXVcbiIsIGxpbWl0ICogMTAw
MDAwMCk7DQo+PiBAQCAtMjg4Miw2ICszMDgxLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3
bW9uX3Nob3dfcG93ZXJfY2FwKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJc2l6ZSA9IHNu
cHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiXG4iKTsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJdXBf
cmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFz
dF9idXN5KGFkZXYtPmRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3Bl
bmQoYWRldi0+ZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTI4OTgsNyArMzA5OSw3IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zZXRfcG93ZXJfY2FwKHN0cnVjdCBkZXZpY2UgKmRl
diwNCj4+ICAgIAlpbnQgZXJyOw0KPj4gICAgCXUzMiB2YWx1ZTsNCj4+ICAgIA0KPj4gLQlpZiAo
YWRldi0+aW5fZ3B1X3Jlc2V0KQ0KPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9y
ZXNldCkpDQo+PiAgICAJCXJldHVybiAtRVBFUk07DQo+PiAgICANCj4+ICAgIAlpZiAoYW1kZ3B1
X3NyaW92X3ZmKGFkZXYpKQ0KPj4gQEAgLTI5MTcsNiArMzExOCw4IEBAIHN0YXRpYyBzc2l6ZV90
IGFtZGdwdV9od21vbl9zZXRfcG93ZXJfY2FwKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAgIAkJ
cmV0dXJuIGVycjsNCj4+ICAgIAl9DQo+PiAgICANCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOw0KPj4gKw0KPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkNCj4+ICAg
IAkJZXJyID0gc211X3NldF9wb3dlcl9saW1pdCgmYWRldi0+c211LCB2YWx1ZSk7DQo+PiAgICAJ
ZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzICYmIGFkZXYtPnBvd2VycGxheS5wcF9m
dW5jcy0+c2V0X3Bvd2VyX2xpbWl0KQ0KPj4gQEAgLTI5MjQsNiArMzEyNyw4IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9od21vbl9zZXRfcG93ZXJfY2FwKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+
ICAgIAllbHNlDQo+PiAgICAJCWVyciA9IC1FSU5WQUw7DQo+PiAgICANCj4+ICsJdXBfcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsNCj4+ICsNCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGFkZXYtPmRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRl
di0+ZGRldi0+ZGV2KTsNCj4+ICAgIA0KPj4gQEAgLTI5NDEsNyArMzE0Niw3IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9od21vbl9zaG93X3NjbGsoc3RydWN0IGRldmljZSAqZGV2LA0KPj4gICAg
CXVpbnQzMl90IHNjbGs7DQo+PiAgICAJaW50IHIsIHNpemUgPSBzaXplb2Yoc2Nsayk7DQo+PiAg
ICANCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZh
ZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVQRVJNOw0KPj4gICAgDQo+PiAg
ICAJciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsNCj4+IEBAIC0yOTUw
LDkgKzMxNTUsMTEgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfc2NsayhzdHJ1
Y3QgZGV2aWNlICpkZXYsDQo+PiAgICAJCXJldHVybiByOw0KPj4gICAgCX0NCj4+ICAgIA0KPj4g
Kwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICAJLyogZ2V0IHRoZSBzY2xrICov
DQo+PiAgICAJciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNP
Ul9HRlhfU0NMSywNCj4+ICAgIAkJCQkgICAodm9pZCAqKSZzY2xrLCAmc2l6ZSk7DQo+PiArCXVw
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICANCj4+ICAgIAlwbV9ydW50aW1lX21hcmtf
bGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7DQo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1
c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsNCj4+IEBAIC0yOTc4LDcgKzMxODUsNyBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19tY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4+ICAg
IAl1aW50MzJfdCBtY2xrOw0KPj4gICAgCWludCByLCBzaXplID0gc2l6ZW9mKG1jbGspOw0KPj4g
ICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgm
YWRldi0+aW5fZ3B1X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4g
ICAgCXIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRkZXYtPmRldik7DQo+PiBAQCAtMjk4
Nyw5ICszMTk0LDExIEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93X21jbGsoc3Ry
dWN0IGRldmljZSAqZGV2LA0KPj4gICAgCQlyZXR1cm4gcjsNCj4+ICAgIAl9DQo+PiAgICANCj4+
ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gICAgCS8qIGdldCB0aGUgc2NsayAq
Lw0KPj4gICAgCXIgPSBhbWRncHVfZHBtX3JlYWRfc2Vuc29yKGFkZXYsIEFNREdQVV9QUF9TRU5T
T1JfR0ZYX01DTEssDQo+PiAgICAJCQkJICAgKHZvaWQgKikmbWNsaywgJnNpemUpOw0KPj4gKwl1
cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gICAgDQo+PiAgICAJcG1fcnVudGltZV9tYXJr
X2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOw0KPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9z
dXNwZW5kKGFkZXYtPmRkZXYtPmRldik7DQo+PiBAQCAtMzg3MCw3ICs0MDc5LDcgQEAgc3RhdGlj
IGludCBhbWRncHVfZGVidWdmc19wbV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0
YSkNCj4+ICAgIAl1MzIgZmxhZ3MgPSAwOw0KPj4gICAgCWludCByOw0KPj4gICAgDQo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1
X3Jlc2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsNCj4+ICAgIA0KPj4gICAgCXIgPSBwbV9y
dW50aW1lX2dldF9zeW5jKGRldi0+ZGV2KTsNCj4+IEBAIC0zODc5LDcgKzQwODgsMTAgQEAgc3Rh
dGljIGludCBhbWRncHVfZGVidWdmc19wbV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
ZGF0YSkNCj4+ICAgIAkJcmV0dXJuIHI7DQo+PiAgICAJfQ0KPj4gICAgDQo+PiArCWRvd25fcmVh
ZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICAgIAlhbWRncHVfZGV2aWNlX2lwX2dldF9jbG9ja2dh
dGluZ19zdGF0ZShhZGV2LCAmZmxhZ3MpOw0KPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Ow0KPj4gKw0KPj4gICAgCXNlcV9wcmludGYobSwgIkNsb2NrIEdhdGluZyBGbGFncyBNYXNrOiAw
eCV4XG4iLCBmbGFncyk7DQo+PiAgICAJYW1kZ3B1X3BhcnNlX2NnX3N0YXRlKG0sIGZsYWdzKTsN
Cj4+ICAgIAlzZXFfcHJpbnRmKG0sICJcbiIpOw0KPj4gQEAgLTM4OTEsNiArNDEwMyw3IEBAIHN0
YXRpYyBpbnQgYW1kZ3B1X2RlYnVnZnNfcG1faW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQg
KmRhdGEpDQo+PiAgICAJCXJldHVybiAwOw0KPj4gICAgCX0NCj4+ICAgIA0KPj4gKwlkb3duX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICAJaWYgKCFpc19zdXBwb3J0X3N3X3NtdShhZGV2
KSAmJg0KPj4gICAgCSAgICBhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmRlYnVnZnNfcHJpbnRf
Y3VycmVudF9wZXJmb3JtYW5jZV9sZXZlbCkgew0KPj4gICAgCQltdXRleF9sb2NrKCZhZGV2LT5w
bS5tdXRleCk7DQo+PiBAQCAtMzkwMyw2ICs0MTE2LDcgQEAgc3RhdGljIGludCBhbWRncHVfZGVi
dWdmc19wbV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkNCj4+ICAgIAl9IGVs
c2Ugew0KPj4gICAgCQlyID0gYW1kZ3B1X2RlYnVnZnNfcG1faW5mb19wcChtLCBhZGV2KTsNCj4+
ICAgIAl9DQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+PiAgICANCj4+ICAgIAlw
bV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRldi0+ZGV2KTsNCj4+ICAgIAlwbV9ydW50aW1lX3B1
dF9hdXRvc3VzcGVuZChkZXYtPmRldik7DQo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X3BzcC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3BzcC5jDQo+PiBpbmRleCBlMjA2OTViNDRkYmUuLmFiMDg4M2VlYWRiMyAxMDA2NDQNCj4+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wc3AuYw0KPj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BzcC5jDQo+PiBAQCAtMTY4Miw3ICsx
NjgyLDcgQEAgc3RhdGljIGludCBwc3BfbG9hZF9zbXVfZncoc3RydWN0IHBzcF9jb250ZXh0ICpw
c3ApDQo+PiAgICAJCXJldHVybiAwOw0KPj4gICAgDQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmlu
X2dwdV9yZXNldCAmJiByYXMgJiYgcmFzLT5zdXBwb3J0ZWQpIHsNCj4+ICsJaWYgKGF0b21pY19y
ZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpICYmIHJhcyAmJiByYXMtPnN1cHBvcnRlZCkgew0KPj4g
ICAgCQlyZXQgPSBhbWRncHVfZHBtX3NldF9tcDFfc3RhdGUoYWRldiwgUFBfTVAxX1NUQVRFX1VO
TE9BRCk7DQo+PiAgICAJCWlmIChyZXQpIHsNCj4+ICAgIAkJCURSTV9XQVJOKCJGYWlsZWQgdG8g
c2V0IE1QMSBzdGF0ZSBwcmVwYXJlIGZvciByZWxvYWRcbiIpOw0KPj4gQEAgLTE3OTYsNyArMTc5
Niw3IEBAIHN0YXRpYyBpbnQgcHNwX2xvYWRfZncoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYp
DQo+PiAgICAJaW50IHJldDsNCj4+ICAgIAlzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCA9ICZhZGV2
LT5wc3A7DQo+PiAgICANCj4+IC0JaWYgKGFtZGdwdV9zcmlvdl92ZihhZGV2KSAmJiBhZGV2LT5p
bl9ncHVfcmVzZXQpIHsNCj4+ICsJaWYgKGFtZGdwdV9zcmlvdl92ZihhZGV2KSAmJiBhdG9taWNf
cmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkgew0KPj4gICAgCQlwc3BfcmluZ19zdG9wKHBzcCwg
UFNQX1JJTkdfVFlQRV9fS00pOyAvKiBzaG91bGQgbm90IGRlc3Ryb3kgcmluZywgb25seSBzdG9w
ICovDQo+PiAgICAJCWdvdG8gc2tpcF9tZW1hbGxvYzsNCj4+ICAgIAl9DQo+PiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jhcy5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jhcy5jDQo+PiBpbmRleCBhYjhlN2M5MWM2NDUuLjNlNTM0
MjYyZTM4MSAxMDA2NDQNCj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9yYXMuYw0KPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jhcy5j
DQo+PiBAQCAtMTk3NSw3ICsxOTc1LDcgQEAgaW50IGFtZGdwdV9yYXNfbGF0ZV9pbml0KHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2LA0KPj4gICAgCQkJYW1kZ3B1X3Jhc19yZXF1ZXN0X3Jlc2V0
X29uX2Jvb3QoYWRldiwNCj4+ICAgIAkJCQkJcmFzX2Jsb2NrLT5ibG9jayk7DQo+PiAgICAJCQly
ZXR1cm4gMDsNCj4+IC0JCX0gZWxzZSBpZiAoYWRldi0+aW5fc3VzcGVuZCB8fCBhZGV2LT5pbl9n
cHVfcmVzZXQpIHsNCj4+ICsJCX0gZWxzZSBpZiAoYWRldi0+aW5fc3VzcGVuZCB8fCBhdG9taWNf
cmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkgew0KPj4gICAgCQkJLyogaW4gcmVzdW1lIHBoYXNl
LCBpZiBmYWlsIHRvIGVuYWJsZSByYXMsDQo+PiAgICAJCQkgKiBjbGVhbiB1cCBhbGwgcmFzIGZz
IG5vZGVzLCBhbmQgZGlzYWJsZSByYXMgKi8NCj4+ICAgIAkJCWdvdG8gY2xlYW51cDsNCj4+IEBA
IC0xOTg0LDcgKzE5ODQsNyBAQCBpbnQgYW1kZ3B1X3Jhc19sYXRlX2luaXQoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsDQo+PiAgICAJfQ0KPj4gICAgDQo+PiAgICAJLyogaW4gcmVzdW1lIHBo
YXNlLCBubyBuZWVkIHRvIGNyZWF0ZSByYXMgZnMgbm9kZSAqLw0KPj4gLQlpZiAoYWRldi0+aW5f
c3VzcGVuZCB8fCBhZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhZGV2LT5pbl9zdXNwZW5k
IHx8IGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gMDsN
Cj4+ICAgIA0KPj4gICAgCWlmIChpaF9pbmZvLT5jYikgew0KPj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV90dG0uYw0KPj4gaW5kZXggNTZiZWFmYmQzYWI5Li4yZTY3MGFhNjg3NTgg
MTAwNjQ0DQo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMN
Cj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYw0KPj4gQEAg
LTIwOTMsNyArMjA5Myw3IEBAIHZvaWQgYW1kZ3B1X3R0bV9zZXRfYnVmZmVyX2Z1bmNzX3N0YXR1
cyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCBlbmFibGUpDQo+PiAgICAJdWludDY0
X3Qgc2l6ZTsNCj4+ICAgIAlpbnQgcjsNCj4+ICAgIA0KPj4gLQlpZiAoIWFkZXYtPm1tYW4uaW5p
dGlhbGl6ZWQgfHwgYWRldi0+aW5fZ3B1X3Jlc2V0IHx8DQo+PiArCWlmICghYWRldi0+bW1hbi5p
bml0aWFsaXplZCB8fCBhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSB8fA0KPj4gICAg
CSAgICBhZGV2LT5tbWFuLmJ1ZmZlcl9mdW5jc19lbmFibGVkID09IGVuYWJsZSkNCj4+ICAgIAkJ
cmV0dXJuOw0KPj4gICAgDQo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3Vjb2RlLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdWNv
ZGUuYw0KPj4gaW5kZXggNzQ0NDA0YTA1ZmVlLi5kYTZmYTI4YjFiNWYgMTAwNjQ0DQo+PiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdWNvZGUuYw0KPj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Vjb2RlLmMNCj4+IEBAIC02MjgsNyArNjI4
LDcgQEAgaW50IGFtZGdwdV91Y29kZV9pbml0X2JvKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
KQ0KPj4gICAgCXN0cnVjdCBhbWRncHVfZmlybXdhcmVfaW5mbyAqdWNvZGUgPSBOVUxMOw0KPj4g
ICAgDQo+PiAgICAgLyogZm9yIGJhcmVtZXRhbCwgdGhlIHVjb2RlIGlzIGFsbG9jYXRlZCBpbiBn
dHQsIHNvIGRvbid0IG5lZWQgdG8gZmlsbCB0aGUgYm8gd2hlbiByZXNldC9zdXNwZW5kICovDQo+
PiAtCWlmICghYW1kZ3B1X3NyaW92X3ZmKGFkZXYpICYmIChhZGV2LT5pbl9ncHVfcmVzZXQgfHwg
YWRldi0+aW5fc3VzcGVuZCkpDQo+PiArCWlmICghYW1kZ3B1X3NyaW92X3ZmKGFkZXYpICYmIChh
dG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSB8fCBhZGV2LT5pbl9zdXNwZW5kKSkNCj4+
ICAgIAkJcmV0dXJuIDA7DQo+PiAgICAJLyoNCj4+ICAgIAkgKiBpZiBTTVUgbG9hZGVkIGZpcm13
YXJlLCBpdCBuZWVkbid0IGFkZCBTTUMsIFVWRCwgYW5kIFZDRQ0KPj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92aXJ0LmggYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfdmlydC5oDQo+PiBpbmRleCBmODI2OTQ1OTg5YzcuLjMzNmZhOGJh
MjQ2NSAxMDA2NDQNCj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92
aXJ0LmgNCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92aXJ0LmgN
Cj4+IEBAIC0zMjUsOSArMzI1LDkgQEAgc3RhdGljIGlubGluZSBib29sIGlzX3ZpcnR1YWxfbWFj
aGluZSh2b2lkKQ0KPj4gICAgI2RlZmluZSBhbWRncHVfc3Jpb3ZfaXNfcHBfb25lX3ZmKGFkZXYp
IFwNCj4+ICAgIAkoKGFkZXYpLT52aXJ0LmdpbV9mZWF0dXJlICYgQU1ER0lNX0ZFQVRVUkVfUFBf
T05FX1ZGKQ0KPj4gICAgI2RlZmluZSBhbWRncHVfc3Jpb3ZfaXNfZGVidWcoYWRldikgXA0KPj4g
LQkoKCFhZGV2LT5pbl9ncHVfcmVzZXQpICYmIGFkZXYtPnZpcnQudGRyX2RlYnVnKQ0KPj4gKwko
KCFhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkgJiYgYWRldi0+dmlydC50ZHJfZGVi
dWcpDQo+PiAgICAjZGVmaW5lIGFtZGdwdV9zcmlvdl9pc19ub3JtYWwoYWRldikgXA0KPj4gLQko
KCFhZGV2LT5pbl9ncHVfcmVzZXQpICYmICghYWRldi0+dmlydC50ZHJfZGVidWcpKQ0KPj4gKwko
KCFhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkgJiYgKCFhZGV2LT52aXJ0LnRkcl9k
ZWJ1ZykpDQo+PiAgICANCj4+ICAgIGJvb2wgYW1kZ3B1X3ZpcnRfbW1pb19ibG9ja2VkKHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2KTsNCj4+ICAgIHZvaWQgYW1kZ3B1X3ZpcnRfaW5pdF9zZXR0
aW5nKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KTsNCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2dmeF92MTBfMC5jDQo+PiBpbmRleCBhNjE3MGEzNDZiMzkuLmIzYzFlMDVkYTQ1ZSAxMDA2
NDQNCj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92MTBfMC5jDQo+PiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYw0KPj4gQEAgLTYxMDIs
NyArNjEwMiw3IEBAIHN0YXRpYyBpbnQgZ2Z4X3YxMF8wX2dmeF9pbml0X3F1ZXVlKHN0cnVjdCBh
bWRncHVfcmluZyAqcmluZykNCj4+ICAgIAlzdHJ1Y3QgdjEwX2dmeF9tcWQgKm1xZCA9IHJpbmct
Pm1xZF9wdHI7DQo+PiAgICAJaW50IG1xZF9pZHggPSByaW5nIC0gJmFkZXYtPmdmeC5nZnhfcmlu
Z1swXTsNCj4+ICAgIA0KPj4gLQlpZiAoIWFkZXYtPmluX2dwdV9yZXNldCAmJiAhYWRldi0+aW5f
c3VzcGVuZCkgew0KPj4gKwlpZiAoIWF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpICYm
ICFhZGV2LT5pbl9zdXNwZW5kKSB7DQo+PiAgICAJCW1lbXNldCgodm9pZCAqKW1xZCwgMCwgc2l6
ZW9mKCptcWQpKTsNCj4+ICAgIAkJbXV0ZXhfbG9jaygmYWRldi0+c3JibV9tdXRleCk7DQo+PiAg
ICAJCW52X2dyYm1fc2VsZWN0KGFkZXYsIHJpbmctPm1lLCByaW5nLT5waXBlLCByaW5nLT5xdWV1
ZSwgMCk7DQo+PiBAQCAtNjExNCw3ICs2MTE0LDcgQEAgc3RhdGljIGludCBnZnhfdjEwXzBfZ2Z4
X2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQ0KPj4gICAgCQltdXRleF91bmxv
Y2soJmFkZXYtPnNyYm1fbXV0ZXgpOw0KPj4gICAgCQlpZiAoYWRldi0+Z2Z4Lm1lLm1xZF9iYWNr
dXBbbXFkX2lkeF0pDQo+PiAgICAJCQltZW1jcHkoYWRldi0+Z2Z4Lm1lLm1xZF9iYWNrdXBbbXFk
X2lkeF0sIG1xZCwgc2l6ZW9mKCptcWQpKTsNCj4+IC0JfSBlbHNlIGlmIChhZGV2LT5pbl9ncHVf
cmVzZXQpIHsNCj4+ICsJfSBlbHNlIGlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0
KSkgew0KPj4gICAgCQkvKiByZXNldCBtcWQgd2l0aCB0aGUgYmFja3VwIGNvcHkgKi8NCj4+ICAg
IAkJaWYgKGFkZXYtPmdmeC5tZS5tcWRfYmFja3VwW21xZF9pZHhdKQ0KPj4gICAgCQkJbWVtY3B5
KG1xZCwgYWRldi0+Z2Z4Lm1lLm1xZF9iYWNrdXBbbXFkX2lkeF0sIHNpemVvZigqbXFkKSk7DQo+
PiBAQCAtNjQ2Myw3ICs2NDYzLDcgQEAgc3RhdGljIGludCBnZnhfdjEwXzBfa2lxX2luaXRfcXVl
dWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQ0KPj4gICAgDQo+PiAgICAJZ2Z4X3YxMF8wX2tp
cV9zZXR0aW5nKHJpbmcpOw0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsg
LyogZm9yIEdQVV9SRVNFVCBjYXNlICovDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5f
Z3B1X3Jlc2V0KSkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8NCj4+ICAgIAkJLyogcmVzZXQg
TVFEIHRvIGEgY2xlYW4gc3RhdHVzICovDQo+PiAgICAJCWlmIChhZGV2LT5nZngubWVjLm1xZF9i
YWNrdXBbbXFkX2lkeF0pDQo+PiAgICAJCQltZW1jcHkobXFkLCBhZGV2LT5nZngubWVjLm1xZF9i
YWNrdXBbbXFkX2lkeF0sIHNpemVvZigqbXFkKSk7DQo+PiBAQCAtNjQ5OSw3ICs2NDk5LDcgQEAg
c3RhdGljIGludCBnZnhfdjEwXzBfa2NxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpy
aW5nKQ0KPj4gICAgCXN0cnVjdCB2MTBfY29tcHV0ZV9tcWQgKm1xZCA9IHJpbmctPm1xZF9wdHI7
DQo+PiAgICAJaW50IG1xZF9pZHggPSByaW5nIC0gJmFkZXYtPmdmeC5jb21wdXRlX3JpbmdbMF07
DQo+PiAgICANCj4+IC0JaWYgKCFhZGV2LT5pbl9ncHVfcmVzZXQgJiYgIWFkZXYtPmluX3N1c3Bl
bmQpIHsNCj4+ICsJaWYgKCFhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSAmJiAhYWRl
di0+aW5fc3VzcGVuZCkgew0KPj4gICAgCQltZW1zZXQoKHZvaWQgKiltcWQsIDAsIHNpemVvZigq
bXFkKSk7DQo+PiAgICAJCW11dGV4X2xvY2soJmFkZXYtPnNyYm1fbXV0ZXgpOw0KPj4gICAgCQlu
dl9ncmJtX3NlbGVjdChhZGV2LCByaW5nLT5tZSwgcmluZy0+cGlwZSwgcmluZy0+cXVldWUsIDAp
Ow0KPj4gQEAgLTY1MDksNyArNjUwOSw3IEBAIHN0YXRpYyBpbnQgZ2Z4X3YxMF8wX2tjcV9pbml0
X3F1ZXVlKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZykNCj4+ICAgIA0KPj4gICAgCQlpZiAoYWRl
di0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdKQ0KPj4gICAgCQkJbWVtY3B5KGFkZXYtPmdm
eC5tZWMubXFkX2JhY2t1cFttcWRfaWR4XSwgbXFkLCBzaXplb2YoKm1xZCkpOw0KPj4gLQl9IGVs
c2UgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8NCj4+
ICsJfSBlbHNlIGlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkgeyAvKiBmb3Ig
R1BVX1JFU0VUIGNhc2UgKi8NCj4+ICAgIAkJLyogcmVzZXQgTVFEIHRvIGEgY2xlYW4gc3RhdHVz
ICovDQo+PiAgICAJCWlmIChhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0pDQo+PiAg
ICAJCQltZW1jcHkobXFkLCBhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0sIHNpemVv
ZigqbXFkKSk7DQo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4
X3Y4XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OF8wLmMNCj4+IGluZGV4
IDMzZjFjNGE0NmViZS4uYzcwZjNiYzVjZWEyIDEwMDY0NA0KPj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvZ2Z4X3Y4XzAuYw0KPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvZ2Z4X3Y4XzAuYw0KPj4gQEAgLTQ2MzIsNyArNDYzMiw3IEBAIHN0YXRpYyBpbnQgZ2Z4
X3Y4XzBfa2lxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQ0KPj4gICAgDQo+
PiAgICAJZ2Z4X3Y4XzBfa2lxX3NldHRpbmcocmluZyk7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYt
PmluX2dwdV9yZXNldCkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8NCj4+ICsJaWYgKGF0b21p
Y19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKSB7IC8qIGZvciBHUFVfUkVTRVQgY2FzZSAqLw0K
Pj4gICAgCQkvKiByZXNldCBNUUQgdG8gYSBjbGVhbiBzdGF0dXMgKi8NCj4+ICAgIAkJaWYgKGFk
ZXYtPmdmeC5tZWMubXFkX2JhY2t1cFttcWRfaWR4XSkNCj4+ICAgIAkJCW1lbWNweShtcWQsIGFk
ZXYtPmdmeC5tZWMubXFkX2JhY2t1cFttcWRfaWR4XSwgc2l6ZW9mKHN0cnVjdCB2aV9tcWRfYWxs
b2NhdGlvbikpOw0KPj4gQEAgLTQ2NjksNyArNDY2OSw3IEBAIHN0YXRpYyBpbnQgZ2Z4X3Y4XzBf
a2NxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQ0KPj4gICAgCXN0cnVjdCB2
aV9tcWQgKm1xZCA9IHJpbmctPm1xZF9wdHI7DQo+PiAgICAJaW50IG1xZF9pZHggPSByaW5nIC0g
JmFkZXYtPmdmeC5jb21wdXRlX3JpbmdbMF07DQo+PiAgICANCj4+IC0JaWYgKCFhZGV2LT5pbl9n
cHVfcmVzZXQgJiYgIWFkZXYtPmluX3N1c3BlbmQpIHsNCj4+ICsJaWYgKCFhdG9taWNfcmVhZCgm
YWRldi0+aW5fZ3B1X3Jlc2V0KSAmJiAhYWRldi0+aW5fc3VzcGVuZCkgew0KPj4gICAgCQltZW1z
ZXQoKHZvaWQgKiltcWQsIDAsIHNpemVvZihzdHJ1Y3QgdmlfbXFkX2FsbG9jYXRpb24pKTsNCj4+
ICAgIAkJKChzdHJ1Y3QgdmlfbXFkX2FsbG9jYXRpb24gKiltcWQpLT5keW5hbWljX2N1X21hc2sg
PSAweEZGRkZGRkZGOw0KPj4gICAgCQkoKHN0cnVjdCB2aV9tcWRfYWxsb2NhdGlvbiAqKW1xZCkt
PmR5bmFtaWNfcmJfbWFzayA9IDB4RkZGRkZGRkY7DQo+PiBAQCAtNDY4MSw3ICs0NjgxLDcgQEAg
c3RhdGljIGludCBnZnhfdjhfMF9rY3FfaW5pdF9xdWV1ZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJp
bmcpDQo+PiAgICANCj4+ICAgIAkJaWYgKGFkZXYtPmdmeC5tZWMubXFkX2JhY2t1cFttcWRfaWR4
XSkNCj4+ICAgIAkJCW1lbWNweShhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0sIG1x
ZCwgc2l6ZW9mKHN0cnVjdCB2aV9tcWRfYWxsb2NhdGlvbikpOw0KPj4gLQl9IGVsc2UgaWYgKGFk
ZXYtPmluX2dwdV9yZXNldCkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8NCj4+ICsJfSBlbHNl
IGlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkgeyAvKiBmb3IgR1BVX1JFU0VU
IGNhc2UgKi8NCj4+ICAgIAkJLyogcmVzZXQgTVFEIHRvIGEgY2xlYW4gc3RhdHVzICovDQo+PiAg
ICAJCWlmIChhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0pDQo+PiAgICAJCQltZW1j
cHkobXFkLCBhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0sIHNpemVvZihzdHJ1Y3Qg
dmlfbXFkX2FsbG9jYXRpb24pKTsNCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9nZnhfdjlfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAu
Yw0KPj4gaW5kZXggY2I5ZDYwYTRlMDVlLi45MDIwYTBmNDBlMjggMTAwNjQ0DQo+PiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jDQo+PiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jDQo+PiBAQCAtMzY4NCw3ICszNjg0LDcgQEAgc3Rh
dGljIGludCBnZnhfdjlfMF9raXFfaW5pdF9xdWV1ZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcp
DQo+PiAgICANCj4+ICAgIAlnZnhfdjlfMF9raXFfc2V0dGluZyhyaW5nKTsNCj4+ICAgIA0KPj4g
LQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KSB7IC8qIGZvciBHUFVfUkVTRVQgY2FzZSAqLw0KPj4g
KwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpIHsgLyogZm9yIEdQVV9SRVNF
VCBjYXNlICovDQo+PiAgICAJCS8qIHJlc2V0IE1RRCB0byBhIGNsZWFuIHN0YXR1cyAqLw0KPj4g
ICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdKQ0KPj4gICAgCQkJbWVt
Y3B5KG1xZCwgYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdLCBzaXplb2Yoc3RydWN0
IHY5X21xZF9hbGxvY2F0aW9uKSk7DQo+PiBAQCAtMzcyMiw3ICszNzIyLDcgQEAgc3RhdGljIGlu
dCBnZnhfdjlfMF9rY3FfaW5pdF9xdWV1ZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpDQo+PiAg
ICAJc3RydWN0IHY5X21xZCAqbXFkID0gcmluZy0+bXFkX3B0cjsNCj4+ICAgIAlpbnQgbXFkX2lk
eCA9IHJpbmcgLSAmYWRldi0+Z2Z4LmNvbXB1dGVfcmluZ1swXTsNCj4+ICAgIA0KPj4gLQlpZiAo
IWFkZXYtPmluX2dwdV9yZXNldCAmJiAhYWRldi0+aW5fc3VzcGVuZCkgew0KPj4gKwlpZiAoIWF0
b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpICYmICFhZGV2LT5pbl9zdXNwZW5kKSB7DQo+
PiAgICAJCW1lbXNldCgodm9pZCAqKW1xZCwgMCwgc2l6ZW9mKHN0cnVjdCB2OV9tcWRfYWxsb2Nh
dGlvbikpOw0KPj4gICAgCQkoKHN0cnVjdCB2OV9tcWRfYWxsb2NhdGlvbiAqKW1xZCktPmR5bmFt
aWNfY3VfbWFzayA9IDB4RkZGRkZGRkY7DQo+PiAgICAJCSgoc3RydWN0IHY5X21xZF9hbGxvY2F0
aW9uICopbXFkKS0+ZHluYW1pY19yYl9tYXNrID0gMHhGRkZGRkZGRjsNCj4+IEBAIC0zNzM0LDcg
KzM3MzQsNyBAQCBzdGF0aWMgaW50IGdmeF92OV8wX2tjcV9pbml0X3F1ZXVlKHN0cnVjdCBhbWRn
cHVfcmluZyAqcmluZykNCj4+ICAgIA0KPj4gICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFj
a3VwW21xZF9pZHhdKQ0KPj4gICAgCQkJbWVtY3B5KGFkZXYtPmdmeC5tZWMubXFkX2JhY2t1cFtt
cWRfaWR4XSwgbXFkLCBzaXplb2Yoc3RydWN0IHY5X21xZF9hbGxvY2F0aW9uKSk7DQo+PiAtCX0g
ZWxzZSBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KSB7IC8qIGZvciBHUFVfUkVTRVQgY2FzZSAqLw0K
Pj4gKwl9IGVsc2UgaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKSB7IC8qIGZv
ciBHUFVfUkVTRVQgY2FzZSAqLw0KPj4gICAgCQkvKiByZXNldCBNUUQgdG8gYSBjbGVhbiBzdGF0
dXMgKi8NCj4+ICAgIAkJaWYgKGFkZXYtPmdmeC5tZWMubXFkX2JhY2t1cFttcWRfaWR4XSkNCj4+
ICAgIAkJCW1lbWNweShtcWQsIGFkZXYtPmdmeC5tZWMubXFkX2JhY2t1cFttcWRfaWR4XSwgc2l6
ZW9mKHN0cnVjdCB2OV9tcWRfYWxsb2NhdGlvbikpOw0KPj4gQEAgLTM5MjgsNyArMzkyOCw3IEBA
IHN0YXRpYyBpbnQgZ2Z4X3Y5XzBfaHdfZmluaSh2b2lkICpoYW5kbGUpDQo+PiAgICAJLyogVXNl
IGRlaW5pdGlhbGl6ZSBzZXF1ZW5jZSBmcm9tIENBSUwgd2hlbiB1bmJpbmRpbmcgZGV2aWNlIGZy
b20gZHJpdmVyLA0KPj4gICAgCSAqIG90aGVyd2lzZSBLSVEgaXMgaGFuZ2luZyB3aGVuIGJpbmRp
bmcgYmFjaw0KPj4gICAgCSAqLw0KPj4gLQlpZiAoIWFkZXYtPmluX2dwdV9yZXNldCAmJiAhYWRl
di0+aW5fc3VzcGVuZCkgew0KPj4gKwlpZiAoIWF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVz
ZXQpICYmICFhZGV2LT5pbl9zdXNwZW5kKSB7DQo+PiAgICAJCW11dGV4X2xvY2soJmFkZXYtPnNy
Ym1fbXV0ZXgpOw0KPj4gICAgCQlzb2MxNV9ncmJtX3NlbGVjdChhZGV2LCBhZGV2LT5nZngua2lx
LnJpbmcubWUsDQo+PiAgICAJCQkJYWRldi0+Z2Z4LmtpcS5yaW5nLnBpcGUsDQo+PiBAQCAtNDA4
Niw3ICs0MDg2LDcgQEAgc3RhdGljIHVpbnQ2NF90IGdmeF92OV8wX2tpcV9yZWFkX2Nsb2NrKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQ0KPj4gICAgCSAqDQo+PiAgICAJICogYWxzbyBkb24n
dCB3YWl0IGFueW1vcmUgZm9yIElSUSBjb250ZXh0DQo+PiAgICAJICogKi8NCj4+IC0JaWYgKHIg
PCAxICYmIChhZGV2LT5pbl9ncHVfcmVzZXQgfHwgaW5faW50ZXJydXB0KCkpKQ0KPj4gKwlpZiAo
ciA8IDEgJiYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpIHx8IGluX2ludGVycnVw
dCgpKSkNCj4+ICAgIAkJZ290byBmYWlsZWRfa2lxX3JlYWQ7DQo+PiAgICANCj4+ICAgIAltaWdo
dF9zbGVlcCgpOw0KPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dt
Y192MTBfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3YxMF8wLmMNCj4+IGlu
ZGV4IDhmMjlmNzlmODIwZC4uYjc2MWJmNTllZDExIDEwMDY0NA0KPj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvZ21jX3YxMF8wLmMNCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2dtY192MTBfMC5jDQo+PiBAQCAtMzU2LDcgKzM1Niw3IEBAIHN0YXRpYyB2b2lk
IGdtY192MTBfMF9mbHVzaF9ncHVfdGxiKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1aW50
MzJfdCB2bWlkLA0KPj4gICAgCSAqLw0KPj4gICAgCWlmIChhZGV2LT5nZngua2lxLnJpbmcuc2No
ZWQucmVhZHkgJiYNCj4+ICAgIAkgICAgKGFtZGdwdV9zcmlvdl9ydW50aW1lKGFkZXYpIHx8ICFh
bWRncHVfc3Jpb3ZfdmYoYWRldikpICYmDQo+PiAtCSAgICAhYWRldi0+aW5fZ3B1X3Jlc2V0KSB7
DQo+PiArCSAgICAhYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpIHsNCj4+ICAgIA0K
Pj4gICAgCQlzdHJ1Y3QgYW1kZ3B1X3ZtaHViICpodWIgPSAmYWRldi0+dm1odWJbdm1odWJdOw0K
Pj4gICAgCQljb25zdCB1bnNpZ25lZCBlbmcgPSAxNzsNCj4+IEBAIC0zODEsNyArMzgxLDcgQEAg
c3RhdGljIHZvaWQgZ21jX3YxMF8wX2ZsdXNoX2dwdV90bGIoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYsIHVpbnQzMl90IHZtaWQsDQo+PiAgICANCj4+ICAgIAlpZiAoIWFkZXYtPm1tYW4uYnVm
ZmVyX2Z1bmNzX2VuYWJsZWQgfHwNCj4+ICAgIAkgICAgIWFkZXYtPmliX3Bvb2xfcmVhZHkgfHwN
Cj4+IC0JICAgIGFkZXYtPmluX2dwdV9yZXNldCB8fA0KPj4gKwkgICAgYXRvbWljX3JlYWQoJmFk
ZXYtPmluX2dwdV9yZXNldCkgfHwNCj4+ICAgIAkgICAgcmluZy0+c2NoZWQucmVhZHkgPT0gZmFs
c2UpIHsNCj4+ICAgIAkJZ21jX3YxMF8wX2ZsdXNoX3ZtX2h1YihhZGV2LCB2bWlkLCBBTURHUFVf
R0ZYSFVCXzAsIDApOw0KPj4gICAgCQltdXRleF91bmxvY2soJmFkZXYtPm1tYW4uZ3R0X3dpbmRv
d19sb2NrKTsNCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNf
djdfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y3XzAuYw0KPj4gaW5kZXgg
ZTE4Mjk2ZGMxMzg2Li5kODNiODM0NTliYTcgMTAwNjQ0DQo+PiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9nbWNfdjdfMC5jDQo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nbWNfdjdfMC5jDQo+PiBAQCAtNDM0LDcgKzQzNCw3IEBAIHN0YXRpYyBpbnQgZ21jX3Y3
XzBfZmx1c2hfZ3B1X3RsYl9wYXNpZChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwNCj4+ICAg
IAlpbnQgdm1pZDsNCj4+ICAgIAl1bnNpZ25lZCBpbnQgdG1wOw0KPj4gICAgDQo+PiAtCWlmIChh
ZGV2LT5pbl9ncHVfcmVzZXQpDQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jl
c2V0KSkNCj4+ICAgIAkJcmV0dXJuIC1FSU87DQo+PiAgICANCj4+ICAgIAlmb3IgKHZtaWQgPSAx
OyB2bWlkIDwgMTY7IHZtaWQrKykgew0KPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2dtY192OF8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjhf
MC5jDQo+PiBpbmRleCBhOWU3MjJiOGE0NTguLjU4NTRkZjZkY2MzMiAxMDA2NDQNCj4+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OF8wLmMNCj4+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OF8wLmMNCj4+IEBAIC02MzUsNyArNjM1LDcgQEAgc3Rh
dGljIGludCBnbWNfdjhfMF9mbHVzaF9ncHVfdGxiX3Bhc2lkKHN0cnVjdCBhbWRncHVfZGV2aWNl
ICphZGV2LA0KPj4gICAgCWludCB2bWlkOw0KPj4gICAgCXVuc2lnbmVkIGludCB0bXA7DQo+PiAg
ICANCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZh
ZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVJTzsNCj4+ICAgIA0KPj4gICAg
CWZvciAodm1pZCA9IDE7IHZtaWQgPCAxNjsgdm1pZCsrKSB7DQo+PiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2dtY192OV8wLmMNCj4+IGluZGV4IDZlNGYzZmY0ODEwZi4uYjgyYTFhZjg2ZjQzIDEw
MDY0NA0KPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAuYw0KPj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAuYw0KPj4gQEAgLTUwMSw3
ICs1MDEsNyBAQCBzdGF0aWMgdm9pZCBnbWNfdjlfMF9mbHVzaF9ncHVfdGxiKHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2LCB1aW50MzJfdCB2bWlkLA0KPj4gICAgCSAqLw0KPj4gICAgCWlmIChh
ZGV2LT5nZngua2lxLnJpbmcuc2NoZWQucmVhZHkgJiYNCj4+ICAgIAkJCShhbWRncHVfc3Jpb3Zf
cnVudGltZShhZGV2KSB8fCAhYW1kZ3B1X3NyaW92X3ZmKGFkZXYpKSAmJg0KPj4gLQkJCSFhZGV2
LT5pbl9ncHVfcmVzZXQpIHsNCj4+ICsJCQkhYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNl
dCkpIHsNCj4+ICAgIAkJdWludDMyX3QgcmVxID0gaHViLT52bV9pbnZfZW5nMF9yZXEgKyBodWIt
PmVuZ19kaXN0YW5jZSAqIGVuZzsNCj4+ICAgIAkJdWludDMyX3QgYWNrID0gaHViLT52bV9pbnZf
ZW5nMF9hY2sgKyBodWItPmVuZ19kaXN0YW5jZSAqIGVuZzsNCj4+ICAgIA0KPj4gQEAgLTU5Niw3
ICs1OTYsNyBAQCBzdGF0aWMgaW50IGdtY192OV8wX2ZsdXNoX2dwdV90bGJfcGFzaWQoc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQo+PiAgICAJc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nID0g
JmFkZXYtPmdmeC5raXEucmluZzsNCj4+ICAgIAlzdHJ1Y3QgYW1kZ3B1X2tpcSAqa2lxID0gJmFk
ZXYtPmdmeC5raXE7DQo+PiAgICANCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkNCj4+ICsJ
aWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQ0KPj4gICAgCQlyZXR1cm4gLUVJ
TzsNCj4+ICAgIA0KPj4gICAgCWlmIChyaW5nLT5zY2hlZC5yZWFkeSkgew0KPj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X2FpLmMgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9teGdwdV9haS5jDQo+PiBpbmRleCA1ZmQ2N2UxY2MyYTAuLmZlMzFjYmVj
Y2ZlOSAxMDA2NDQNCj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X2Fp
LmMNCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X2FpLmMNCj4+IEBA
IC0yMzgsMjAgKzIzOCwxNiBAQCBzdGF0aWMgdm9pZCB4Z3B1X2FpX21haWxib3hfZmxyX3dvcmso
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQ0KPj4gICAgCXN0cnVjdCBhbWRncHVfdmlydCAqdmly
dCA9IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgYW1kZ3B1X3ZpcnQsIGZscl93b3JrKTsNCj4+
ICAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGNvbnRhaW5lcl9vZih2aXJ0LCBzdHJ1
Y3QgYW1kZ3B1X2RldmljZSwgdmlydCk7DQo+PiAgICAJaW50IHRpbWVvdXQgPSBBSV9NQUlMQk9Y
X1BPTExfRkxSX1RJTUVET1VUOw0KPj4gLQlpbnQgbG9ja2VkOw0KPj4gICAgDQo+PiAgICAJLyog
YmxvY2sgYW1kZ3B1X2dwdV9yZWNvdmVyIHRpbGwgbXNnIEZMUiBDT01QTEVURSByZWNlaXZlZCwN
Cj4+ICAgIAkgKiBvdGhlcndpc2UgdGhlIG1haWxib3ggbXNnIHdpbGwgYmUgcnVpbmVkL3Jlc2V0
ZWQgYnkNCj4+ICAgIAkgKiB0aGUgVkYgRkxSLg0KPj4gICAgCSAqDQo+PiAtCSAqIHdlIGNhbiB1
bmxvY2sgdGhlIGxvY2tfcmVzZXQgdG8gYWxsb3cgImFtZGdwdV9qb2JfdGltZWRvdXQiDQo+PiAr
CSAqIHdlIGNhbiB1bmxvY2sgdGhlIHJlc2V0X3NlbSB0byBhbGxvdyAiYW1kZ3B1X2pvYl90aW1l
ZG91dCINCj4+ICAgIAkgKiB0byBydW4gZ3B1X3JlY292ZXIoKSBhZnRlciBGTFJfTk9USUZJQ0FU
SU9OX0NNUEwgcmVjZWl2ZWQNCj4+ICAgIAkgKiB3aGljaCBtZWFucyBob3N0IHNpZGUgaGFkIGZp
bmlzaGVkIHRoaXMgVkYncyBGTFIuDQo+PiAgICAJICovDQo+PiAtCWxvY2tlZCA9IG11dGV4X3Ry
eWxvY2soJmFkZXYtPmxvY2tfcmVzZXQpOw0KPj4gLQlpZiAobG9ja2VkKQ0KPj4gLQkJYWRldi0+
aW5fZ3B1X3Jlc2V0ID0gdHJ1ZTsNCj4+IC0NCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9z
ZW0pOw0KPj4gICAgCWRvIHsNCj4+ICAgIAkJaWYgKHhncHVfYWlfbWFpbGJveF9wZWVrX21zZyhh
ZGV2KSA9PSBJREhfRkxSX05PVElGSUNBVElPTl9DTVBMKQ0KPj4gICAgCQkJZ290byBmbHJfZG9u
ZTsNCj4+IEBAIC0yNjEsMTAgKzI1Nyw3IEBAIHN0YXRpYyB2b2lkIHhncHVfYWlfbWFpbGJveF9m
bHJfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspDQo+PiAgICAJfSB3aGlsZSAodGltZW91
dCA+IDEpOw0KPj4gICAgDQo+PiAgICBmbHJfZG9uZToNCj4+IC0JaWYgKGxvY2tlZCkgew0KPj4g
LQkJYWRldi0+aW5fZ3B1X3Jlc2V0ID0gZmFsc2U7DQo+PiAtCQltdXRleF91bmxvY2soJmFkZXYt
PmxvY2tfcmVzZXQpOw0KPj4gLQl9DQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7DQo+
PiAgICANCj4+ICAgIAkvKiBUcmlnZ2VyIHJlY292ZXJ5IGZvciB3b3JsZCBzd2l0Y2ggZmFpbHVy
ZSBpZiBubyBURFIgKi8NCj4+ICAgIAlpZiAoYW1kZ3B1X2RldmljZV9zaG91bGRfcmVjb3Zlcl9n
cHUoYWRldikNCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9teGdw
dV9udi5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbXhncHVfbnYuYw0KPj4gaW5kZXgg
Y2UyYmYxZmI3OWVkLi42ZjU1MTcyZTgzMzcgMTAwNjQ0DQo+PiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9teGdwdV9udi5jDQo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9teGdwdV9udi5jDQo+PiBAQCAtMjU5LDIwICsyNTksMTYgQEAgc3RhdGljIHZvaWQgeGdw
dV9udl9tYWlsYm94X2Zscl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykNCj4+ICAgIAlz
dHJ1Y3QgYW1kZ3B1X3ZpcnQgKnZpcnQgPSBjb250YWluZXJfb2Yod29yaywgc3RydWN0IGFtZGdw
dV92aXJ0LCBmbHJfd29yayk7DQo+PiAgICAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBj
b250YWluZXJfb2YodmlydCwgc3RydWN0IGFtZGdwdV9kZXZpY2UsIHZpcnQpOw0KPj4gICAgCWlu
dCB0aW1lb3V0ID0gTlZfTUFJTEJPWF9QT0xMX0ZMUl9USU1FRE9VVDsNCj4+IC0JaW50IGxvY2tl
ZDsNCj4+ICAgIA0KPj4gICAgCS8qIGJsb2NrIGFtZGdwdV9ncHVfcmVjb3ZlciB0aWxsIG1zZyBG
TFIgQ09NUExFVEUgcmVjZWl2ZWQsDQo+PiAgICAJICogb3RoZXJ3aXNlIHRoZSBtYWlsYm94IG1z
ZyB3aWxsIGJlIHJ1aW5lZC9yZXNldGVkIGJ5DQo+PiAgICAJICogdGhlIFZGIEZMUi4NCj4+ICAg
IAkgKg0KPj4gLQkgKiB3ZSBjYW4gdW5sb2NrIHRoZSBsb2NrX3Jlc2V0IHRvIGFsbG93ICJhbWRn
cHVfam9iX3RpbWVkb3V0Ig0KPj4gKwkgKiB3ZSBjYW4gdW5sb2NrIHRoZSByZXNldF9zZW0gdG8g
YWxsb3cgImFtZGdwdV9qb2JfdGltZWRvdXQiDQo+PiAgICAJICogdG8gcnVuIGdwdV9yZWNvdmVy
KCkgYWZ0ZXIgRkxSX05PVElGSUNBVElPTl9DTVBMIHJlY2VpdmVkDQo+PiAgICAJICogd2hpY2gg
bWVhbnMgaG9zdCBzaWRlIGhhZCBmaW5pc2hlZCB0aGlzIFZGJ3MgRkxSLg0KPj4gICAgCSAqLw0K
Pj4gLQlsb2NrZWQgPSBtdXRleF90cnlsb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsNCj4+IC0JaWYg
KGxvY2tlZCkNCj4+IC0JCWFkZXYtPmluX2dwdV9yZXNldCA9IHRydWU7DQo+PiAtDQo+PiArCWRv
d25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsNCj4+ICAgIAlkbyB7DQo+PiAgICAJCWlmICh4Z3B1
X252X21haWxib3hfcGVla19tc2coYWRldikgPT0gSURIX0ZMUl9OT1RJRklDQVRJT05fQ01QTCkN
Cj4+ICAgIAkJCWdvdG8gZmxyX2RvbmU7DQo+PiBAQCAtMjgyLDEwICsyNzgsNyBAQCBzdGF0aWMg
dm9pZCB4Z3B1X252X21haWxib3hfZmxyX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQ0K
Pj4gICAgCX0gd2hpbGUgKHRpbWVvdXQgPiAxKTsNCj4+ICAgIA0KPj4gICAgZmxyX2RvbmU6DQo+
PiAtCWlmIChsb2NrZWQpIHsNCj4+IC0JCWFkZXYtPmluX2dwdV9yZXNldCA9IGZhbHNlOw0KPj4g
LQkJbXV0ZXhfdW5sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsNCj4+IC0JfQ0KPj4gKwl1cF9yZWFk
KCZhZGV2LT5yZXNldF9zZW0pOw0KPj4gICAgDQo+PiAgICAJLyogVHJpZ2dlciByZWNvdmVyeSBm
b3Igd29ybGQgc3dpdGNoIGZhaWx1cmUgaWYgbm8gVERSICovDQo+PiAgICAJaWYgKGFtZGdwdV9k
ZXZpY2Vfc2hvdWxkX3JlY292ZXJfZ3B1KGFkZXYpDQo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRrZmQva2ZkX2NoYXJkZXYuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
a2ZkL2tmZF9jaGFyZGV2LmMNCj4+IGluZGV4IGU5Yjk2YWQzZDlhNS4uMzkzNjQyYzMyMzg3IDEw
MDY0NA0KPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2NoYXJkZXYuYw0K
Pj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2NoYXJkZXYuYw0KPj4gQEAg
LTE0ODIsMTMgKzE0ODIsMjAgQEAgc3RhdGljIGludCBrZmRfaW9jdGxfbWFwX21lbW9yeV90b19n
cHUoc3RydWN0IGZpbGUgKmZpbGVwLA0KPj4gICAgDQo+PiAgICAJLyogRmx1c2ggVExCcyBhZnRl
ciB3YWl0aW5nIGZvciB0aGUgcGFnZSB0YWJsZSB1cGRhdGVzIHRvIGNvbXBsZXRlICovDQo+PiAg
ICAJZm9yIChpID0gMDsgaSA8IGFyZ3MtPm5fZGV2aWNlczsgaSsrKSB7DQo+PiArCQlzdHJ1Y3Qg
ZGV2aWNlX3F1ZXVlX21hbmFnZXIgKmRxbTsNCj4+ICsNCj4+ICAgIAkJcGVlciA9IGtmZF9kZXZp
Y2VfYnlfaWQoZGV2aWNlc19hcnJbaV0pOw0KPj4gICAgCQlpZiAoV0FSTl9PTl9PTkNFKCFwZWVy
KSkNCj4+ICAgIAkJCWNvbnRpbnVlOw0KPj4gICAgCQlwZWVyX3BkZCA9IGtmZF9nZXRfcHJvY2Vz
c19kZXZpY2VfZGF0YShwZWVyLCBwKTsNCj4+ICAgIAkJaWYgKFdBUk5fT05fT05DRSghcGVlcl9w
ZGQpKQ0KPj4gICAgCQkJY29udGludWU7DQo+PiArDQo+PiArCQlkcW0gPSBwZWVyX3BkZC0+ZGV2
LT5kcW07DQo+PiArDQo+PiArCQlkcW1fbG9jayhkcW0pOw0KPj4gICAgCQlrZmRfZmx1c2hfdGxi
KHBlZXJfcGRkKTsNCj4+ICsJCWRxbV91bmxvY2soZHFtKTsNCj4+ICAgIAl9DQo+PiAgICANCj4+
ICAgIAlrZnJlZShkZXZpY2VzX2Fycik7DQo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRrZmQva2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGtmZC9rZmRfZGV2aWNlX3F1ZXVlX21hbmFnZXIuYw0KPj4gaW5kZXggZGQ1NTAwMjVk
MWMxLi4wYjU0MDljZWRlNTIgMTAwNjQ0DQo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGtmZC9rZmRfZGV2aWNlX3F1ZXVlX21hbmFnZXIuYw0KPj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRrZmQva2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmMNCj4+IEBAIC0zMDQsMTUgKzMw
NCwxNyBAQCBzdGF0aWMgdm9pZCBkZWFsbG9jYXRlX3ZtaWQoc3RydWN0IGRldmljZV9xdWV1ZV9t
YW5hZ2VyICpkcW0sDQo+PiAgICAJCQkJc3RydWN0IHFjbV9wcm9jZXNzX2RldmljZSAqcXBkLA0K
Pj4gICAgCQkJCXN0cnVjdCBxdWV1ZSAqcSkNCj4+ICAgIHsNCj4+IC0JLyogT24gR0ZYIHY3LCBD
UCBkb2Vzbid0IGZsdXNoIFRDIGF0IGRlcXVldWUgKi8NCj4+IC0JaWYgKHEtPmRldmljZS0+ZGV2
aWNlX2luZm8tPmFzaWNfZmFtaWx5ID09IENISVBfSEFXQUlJKQ0KPj4gLQkJaWYgKGZsdXNoX3Rl
eHR1cmVfY2FjaGVfbm9jcHNjaChxLT5kZXZpY2UsIHFwZCkpDQo+PiAtCQkJcHJfZXJyKCJGYWls
ZWQgdG8gZmx1c2ggVENcbiIpOw0KPj4gKwlpZiAoIWRxbS0+aXNfcmVzZXR0aW5nKSB7DQo+PiAr
CQkvKiBPbiBHRlggdjcsIENQIGRvZXNuJ3QgZmx1c2ggVEMgYXQgZGVxdWV1ZSAqLw0KPj4gKwkJ
aWYgKHEtPmRldmljZS0+ZGV2aWNlX2luZm8tPmFzaWNfZmFtaWx5ID09IENISVBfSEFXQUlJKQ0K
Pj4gKwkJCWlmIChmbHVzaF90ZXh0dXJlX2NhY2hlX25vY3BzY2gocS0+ZGV2aWNlLCBxcGQpKQ0K
Pj4gKwkJCQlwcl9lcnIoIkZhaWxlZCB0byBmbHVzaCBUQ1xuIik7DQo+PiAgICANCj4+IC0Ja2Zk
X2ZsdXNoX3RsYihxcGRfdG9fcGRkKHFwZCkpOw0KPj4gKwkJa2ZkX2ZsdXNoX3RsYihxcGRfdG9f
cGRkKHFwZCkpOw0KPj4gICAgDQo+PiAtCS8qIFJlbGVhc2UgdGhlIHZtaWQgbWFwcGluZyAqLw0K
Pj4gLQlzZXRfcGFzaWRfdm1pZF9tYXBwaW5nKGRxbSwgMCwgcXBkLT52bWlkKTsNCj4+ICsJCS8q
IFJlbGVhc2UgdGhlIHZtaWQgbWFwcGluZyAqLw0KPj4gKwkJc2V0X3Bhc2lkX3ZtaWRfbWFwcGlu
ZyhkcW0sIDAsIHFwZC0+dm1pZCk7DQo+PiArCX0NCj4+ICAgIAlkcW0tPnZtaWRfcGFzaWRbcXBk
LT52bWlkXSA9IDA7DQo+PiAgICANCj4+ICAgIAlxcGQtPnZtaWQgPSAwOw0KPj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9wcm9jZXNzLmMgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGtmZC9rZmRfcHJvY2Vzcy5jDQo+PiBpbmRleCAwMTNjMmIwMThlZGMuLjcx
YmU4OTdkNGMyYSAxMDA2NDQNCj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tm
ZF9wcm9jZXNzLmMNCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9wcm9j
ZXNzLmMNCj4+IEBAIC0xNTUxLDYgKzE1NTEsMTAgQEAgaW50IGtmZF9yZXNlcnZlZF9tZW1fbW1h
cChzdHJ1Y3Qga2ZkX2RldiAqZGV2LCBzdHJ1Y3Qga2ZkX3Byb2Nlc3MgKnByb2Nlc3MsDQo+PiAg
ICB2b2lkIGtmZF9mbHVzaF90bGIoc3RydWN0IGtmZF9wcm9jZXNzX2RldmljZSAqcGRkKQ0KPj4g
ICAgew0KPj4gICAgCXN0cnVjdCBrZmRfZGV2ICpkZXYgPSBwZGQtPmRldjsNCj4+ICsJc3RydWN0
IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0gPSBkZXYtPmRxbTsNCj4+ICsNCj4+ICsJaWYgKGRx
bS0+aXNfcmVzZXR0aW5nKQ0KPj4gKwkJcmV0dXJuOw0KPj4gICAgDQo+PiAgICAJaWYgKGRldi0+
ZHFtLT5zY2hlZF9wb2xpY3kgPT0gS0ZEX1NDSEVEX1BPTElDWV9OT19IV1MpIHsNCj4+ICAgIAkJ
LyogTm90aGluZyB0byBmbHVzaCB1bnRpbCBhIFZNSUQgaXMgYXNzaWduZWQsIHdoaWNoDQo+PiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVf
ZG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtLmMN
Cj4+IGluZGV4IGI0ZTEyMGU5NTQzOC4uZGIzMzIyODJjMDFlIDEwMDY0NA0KPj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYw0KPj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYw0KPj4gQEAg
LTE2NDAsNyArMTY0MCw3IEBAIHN0YXRpYyBpbnQgZG1fc3VzcGVuZCh2b2lkICpoYW5kbGUpDQo+
PiAgICAJc3RydWN0IGFtZGdwdV9kaXNwbGF5X21hbmFnZXIgKmRtID0gJmFkZXYtPmRtOw0KPj4g
ICAgCWludCByZXQgPSAwOw0KPj4gICAgDQo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsN
Cj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKSB7DQo+PiAgICAJCW11
dGV4X2xvY2soJmRtLT5kY19sb2NrKTsNCj4+ICAgIAkJZG0tPmNhY2hlZF9kY19zdGF0ZSA9IGRj
X2NvcHlfc3RhdGUoZG0tPmRjLT5jdXJyZW50X3N0YXRlKTsNCj4+ICAgIA0KPj4gQEAgLTE4MjYs
NyArMTgyNiw3IEBAIHN0YXRpYyBpbnQgZG1fcmVzdW1lKHZvaWQgKmhhbmRsZSkNCj4+ICAgIAlz
dHJ1Y3QgZGNfc3RhdGUgKmRjX3N0YXRlOw0KPj4gICAgCWludCBpLCByLCBqOw0KPj4gICAgDQo+
PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsNCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2
LT5pbl9ncHVfcmVzZXQpKSB7DQo+PiAgICAJCWRjX3N0YXRlID0gZG0tPmNhY2hlZF9kY19zdGF0
ZTsNCj4+ICAgIA0KPj4gICAgCQlyID0gZG1fZG11Yl9od19pbml0KGFkZXYpOw0KPj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2FtZGdwdV9zbXUuYyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2FtZGdwdV9zbXUuYw0KPj4gaW5kZXggZmU0OTQ4YWE2
NjJmLi42OTEzNGEwZDY2MGMgMTAwNjQ0DQo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bv
d2VycGxheS9hbWRncHVfc211LmMNCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJw
bGF5L2FtZGdwdV9zbXUuYw0KPj4gQEAgLTEzNDEsNyArMTM0MSw3IEBAIHN0YXRpYyBpbnQgc211
X2Rpc2FibGVfZHBtcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4+ICAgIAl1aW50NjRfdCBm
ZWF0dXJlc190b19kaXNhYmxlOw0KPj4gICAgCWludCByZXQgPSAwOw0KPj4gICAgCWJvb2wgdXNl
X2JhY28gPSAhc211LT5pc19hcHUgJiYNCj4+IC0JCSgoYWRldi0+aW5fZ3B1X3Jlc2V0ICYmDQo+
PiArCQkoKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpICYmDQo+PiAgICAJCSAgKGFt
ZGdwdV9hc2ljX3Jlc2V0X21ldGhvZChhZGV2KSA9PSBBTURfUkVTRVRfTUVUSE9EX0JBQ08pKSB8
fA0KPj4gICAgCQkgKChhZGV2LT5pbl9ydW5wbSB8fCBhZGV2LT5pbl9oaWJlcm5hdGUpICYmIGFt
ZGdwdV9hc2ljX3N1cHBvcnRzX2JhY28oYWRldikpKTsNCj4+ICAgIA0KPj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2h3bWdyL3ZlZ2EyMF9od21nci5jIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaHdtZ3IvdmVnYTIwX2h3bWdyLmMNCj4+IGluZGV4
IDNiODgzOTY0MTc3MC4uMTNlMzA0MDY2ZDk0IDEwMDY0NA0KPj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9wb3dlcnBsYXkvaHdtZ3IvdmVnYTIwX2h3bWdyLmMNCj4+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvcG93ZXJwbGF5L2h3bWdyL3ZlZ2EyMF9od21nci5jDQo+PiBAQCAtNDg0LDcg
KzQ4NCw3IEBAIHN0YXRpYyBpbnQgdmVnYTIwX3NldHVwX2FzaWNfdGFzayhzdHJ1Y3QgcHBfaHdt
Z3IgKmh3bWdyKQ0KPj4gICAgew0KPj4gICAgCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0g
KHN0cnVjdCBhbWRncHVfZGV2aWNlICopKGh3bWdyLT5hZGV2KTsNCj4+ICAgIAlpbnQgcmV0ID0g
MDsNCj4+IC0JYm9vbCB1c2VfYmFjbyA9IChhZGV2LT5pbl9ncHVfcmVzZXQgJiYNCj4+ICsJYm9v
bCB1c2VfYmFjbyA9IChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSAmJg0KPj4gICAg
CQkJIChhbWRncHVfYXNpY19yZXNldF9tZXRob2QoYWRldikgPT0gQU1EX1JFU0VUX01FVEhPRF9C
QUNPKSkgfHwNCj4+ICAgIAkJKGFkZXYtPmluX3J1bnBtICYmIGFtZGdwdV9hc2ljX3N1cHBvcnRz
X2JhY28oYWRldikpOw0KPj4gICAgDQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2Ft
ZC1nZngK
