Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 002331038A2
	for <lists+amd-gfx@lfdr.de>; Wed, 20 Nov 2019 12:23:45 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 84AD86E264;
	Wed, 20 Nov 2019 11:23:44 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wm1-x342.google.com (mail-wm1-x342.google.com
 [IPv6:2a00:1450:4864:20::342])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5D5106E264
 for <amd-gfx@lists.freedesktop.org>; Wed, 20 Nov 2019 11:23:43 +0000 (UTC)
Received: by mail-wm1-x342.google.com with SMTP id b11so6559753wmb.5
 for <amd-gfx@lists.freedesktop.org>; Wed, 20 Nov 2019 03:23:43 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:reply-to:subject:to:references:from:message-id
 :date:user-agent:mime-version:in-reply-to:content-transfer-encoding
 :content-language;
 bh=xa+qGZ8WeHZIYFVM4SzWDk5luDevNWO6kJpcKsoXdJo=;
 b=WCdLPRWPEcy3zvaoAMW//pjFNguZaGUN3e5elm8Z8W5Oj8LPF4dDoJXDuRTammOdid
 JnYAqcLS2FlAX8RNK1FHZwgaeEn3c3CDnBgDHLk2uz0L7cpjVsZrVHFZz4WXcrEJ/AEB
 JZQrypMmoqF1A8NnnWzUKg5I1auwZkk459lzW0X9V6On00v15iXTZtaoazWuJxd5/vFa
 IDuzVaemIoSZXFiGpVk6/4fhXqljXAK6bNQa5yRTnDjI2Lt7oWxAdsSJBQ+6oNU1H+8h
 VZOnnQcInr/avwVEnlE+xVioYagRaSCRyiIdXYCfh9s7lyCsCRHBVH1lBlfULt4jyxe0
 OuEg==
X-Gm-Message-State: APjAAAVNOkHyDJsfs1fC3IP+olNmF3smW1HrYuO8qCWu+qWRwlNC8O/E
 4uGK/Gla8PIgmFFwei0vvfCfCAnO
X-Google-Smtp-Source: APXvYqxmfwpKYAobYbXIQpe5c5jzoYl6V4ocBIf+wG7UI6unvKF3es330UPvkMlu20Iu4QmM24wMgA==
X-Received: by 2002:a1c:a512:: with SMTP id o18mr2497312wme.4.1574249021973;
 Wed, 20 Nov 2019 03:23:41 -0800 (PST)
Received: from ?IPv6:2a02:908:1252:fb60:be8a:bd56:1f94:86e7?
 ([2a02:908:1252:fb60:be8a:bd56:1f94:86e7])
 by smtp.gmail.com with ESMTPSA id z8sm30214151wrp.49.2019.11.20.03.23.40
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Wed, 20 Nov 2019 03:23:41 -0800 (PST)
Subject: Re: [PATCH 1/2] drm/amdgpu: invalidate mmhub semphore workaround in
 amdgpu_virt
To: "Changfeng.Zhu" <changfeng.zhu@amd.com>, Christian.Koenig@amd.com,
 Jack.Xiao@amd.com, Tao.Zhou1@amd.com, Ray.Huang@amd.com,
 Xinmei.Huang@amd.com, amd-gfx@lists.freedesktop.org,
 "Deng, Emily" <Emily.Deng@amd.com>, "monk.liu" <monk.liu@amd.com>
References: <20191120091418.26526-1-changfeng.zhu@amd.com>
From: =?UTF-8?Q?Christian_K=c3=b6nig?= <ckoenig.leichtzumerken@gmail.com>
Message-ID: <657609f7-bbe2-17fe-d3c1-2b16ec8868a1@gmail.com>
Date: Wed, 20 Nov 2019 12:23:40 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <20191120091418.26526-1-changfeng.zhu@amd.com>
Content-Language: en-US
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=reply-to:subject:to:references:from:message-id:date:user-agent
 :mime-version:in-reply-to:content-transfer-encoding:content-language;
 bh=xa+qGZ8WeHZIYFVM4SzWDk5luDevNWO6kJpcKsoXdJo=;
 b=fA3gv3cZboaHKa4Cr8LjnpHV7IBy226ohgwtel7SqagPcc+PSxarE+Q0LEgrvCG0cy
 JmE9NJS689N484fR6FpgOdXzLXh73qxdF2qRvO7/luONCuAlN8kvO75ZhIFz0xkbVEoT
 WlswVcVj/g3Q6S+EWtOKIHd8Pum0jneL4+9wRh74c4cnn5tgBqBpBwSHXoDHxrJ7vccA
 YOv36x3qX095tvOBE0EVshB+xI9j3gKTTSHvOlnzyVaHZoFgAl8CHWqSX6GHNnmKn4wm
 SLcWm3JfSQG6S8oQzRauXJpDYEUcRW3+3hvMVaGjboe3Yw4gC5tgTR07avQPf91LKpBS
 Tajg==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Reply-To: christian.koenig@amd.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

SGkgQ2hhbmdmZW5nLAoKW2FkZGluZyBNb25rIGFuZCBFbWlseSBhcyB3ZWxsXS4KCkkgdGhvdWdo
dCBtb3JlIGFib3V0IHRoaXMgYW5kIGNhbWUgdG8gdGhlIGNvbmNsdXNpb24gdGhhdCB0aGlzIHdv
bid0IAp3b3JrIGFuZCBtaWdodCByZXN1bHQgaW4gYSBsb2NrdXAgYXMgd2VsbC4KCldlIGFyZSB1
c2luZyB0aGUgS0lRIG9uIFNSSU9WIGZvciBHUFVWTSBpbnZhbGlkYXRpb24gYmVjYXVzZSB3ZSBu
ZWVkIGFuIAphdG9taWMgcmVhZC9tb2RpZnkvd3JpdGUgY3ljbGUgc2luY2Ugd2UgZm91bmQgdGhh
dCB0aGUgaW52YWxpZGF0aW9uIAplbmdpbmUgaXMgcmVzZXR0ZWQgd2l0aCBldmVyeSB3b3JsZCBz
d2l0Y2guCgpOb3cgYWNjZXNzaW5nIHRoZSBzZW1hcGhvcmUgcmVnaXN0ZXJzIGlzIG5vdCBhdG9t
aWMgYW55IG1vcmUgYW5kIHdlIApjb3VsZCBoYXZlIGEgd29ybGQgc3dpdGNoIGluIGJldHdlZW4g
Z3JhYmJpbmcgdGhlIHNlbWFwaG9yZSBhbmQgc2VuZGluZyAKdGhlIFZNIGludmFsaWRhdGlvbi4g
VGhhdCBlaXRoZXIgd29uJ3Qgd29yayBvciBjb3VsZCByZXN1bHQgaW4gYSBsb2NrdXAgCmFzIHdl
bGwuCgpRdWVzdGlvbiBmb3IgRW1pbHkgYW5kIE1vbms6IERvIHdlIHN1cHBvcnQgcG93ZXIgZ2F0
aW5nIG9mIHRoZSBNTUhVQiAKd2l0aCBTUklPVj8gSSBkb24ndCB0aGluayBzbyBhbmQgd2hlbiB0
aGF0J3MgY29ycmVjdCB3ZSBjb3VsZCBqdXN0IGRyb3AgCnRoaXMgcGF0Y2guCgpSZWdhcmRzLApD
aHJpc3RpYW4uCgpBbSAyMC4xMS4xOSB1bSAxMDoxNCBzY2hyaWViIENoYW5nZmVuZy5aaHU6Cj4g
RnJvbTogY2hhbmd6aHUgPENoYW5nZmVuZy5aaHVAYW1kLmNvbT4KPgo+IEl0IG1heSBsb3NlIGdw
dXZtIGludmFsaWRhdGUgYWNrbm93bGRlZ2Ugc3RhdGUgYWNyb3NzIHBvd2VyLWdhdGluZyBvZmYK
PiBjeWNsZS4gVG8gYXZvaWQgdGhpcyBpc3N1ZSBpbiB2aXJ0IGludmFsaWRhdGlvbiwgYWRkIHNl
bWFwaG9yZSBhY3F1aXJlCj4gYmVmb3JlIGludmFsaWRhdGlvbiBhbmQgc2VtYXBob3JlIHJlbGVh
c2UgYWZ0ZXIgaW52YWxpZGF0aW9uLgo+Cj4gQ2hhbmdlLUlkOiBJZTk4MzA0ZTQ3NTE2NmI1M2Vl
ZDAzMzQ2MmQ3NjQyM2I2YjBmYzI1Ygo+IFNpZ25lZC1vZmYtYnk6IGNoYW5nemh1IDxDaGFuZ2Zl
bmcuWmh1QGFtZC5jb20+Cj4gLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfdmlydC5jIHwgMjYgKysrKysrKysrKysrKysrKysrKysrKy0tCj4gICBkcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfdmlydC5oIHwgIDMgKystCj4gICBkcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9nbWNfdjlfMC5jICAgIHwgIDMgKystCj4gICAzIGZpbGVzIGNoYW5nZWQsIDI4
IGluc2VydGlvbnMoKyksIDQgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZpcnQuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV92aXJ0LmMKPiBpbmRleCBmMDRlYjFhNjQyNzEuLjcwZmZhZjkxY2QxMiAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdmlydC5jCj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZpcnQuYwo+IEBAIC0xMzUsNyAr
MTM1LDggQEAgdm9pZCBhbWRncHVfdmlydF9raXFfd3JlZyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiwgdWludDMyX3QgcmVnLCB1aW50MzJfdCB2KQo+ICAgCj4gICB2b2lkIGFtZGdwdV92aXJ0
X2tpcV9yZWdfd3JpdGVfcmVnX3dhaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4gICAJ
CQkJCXVpbnQzMl90IHJlZzAsIHVpbnQzMl90IHJlZzEsCj4gLQkJCQkJdWludDMyX3QgcmVmLCB1
aW50MzJfdCBtYXNrKQo+ICsJCQkJCXVpbnQzMl90IHJlZiwgdWludDMyX3QgbWFzaywKPiArCQkJ
CQl1aW50MzJfdCBzZW0pCj4gICB7Cj4gICAJc3RydWN0IGFtZGdwdV9raXEgKmtpcSA9ICZhZGV2
LT5nZngua2lxOwo+ICAgCXN0cnVjdCBhbWRncHVfcmluZyAqcmluZyA9ICZraXEtPnJpbmc7Cj4g
QEAgLTE0NCw5ICsxNDUsMzAgQEAgdm9pZCBhbWRncHVfdmlydF9raXFfcmVnX3dyaXRlX3JlZ193
YWl0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICAgCXVpbnQzMl90IHNlcTsKPiAgIAo+
ICAgCXNwaW5fbG9ja19pcnFzYXZlKCZraXEtPnJpbmdfbG9jaywgZmxhZ3MpOwo+IC0JYW1kZ3B1
X3JpbmdfYWxsb2MocmluZywgMzIpOwo+ICsJYW1kZ3B1X3JpbmdfYWxsb2MocmluZywgNjApOwo+
ICsKPiArCS8qCj4gKwkgKiBJdCBtYXkgbG9zZSBncHV2bSBpbnZhbGlkYXRlIGFja25vd2xkZWdl
IHN0YXRlIGFjcm9zcyBwb3dlci1nYXRpbmcKPiArCSAqIG9mZiBjeWNsZSwgYWRkIHNlbWFwaG9y
ZSBhY3F1aXJlIGJlZm9yZSBpbnZhbGlkYXRpb24gYW5kIHNlbWFwaG9yZQo+ICsJICogcmVsZWFz
ZSBhZnRlciBpbnZhbGlkYXRpb24gdG8gYXZvaWQgZW50ZXJpbmcgcG93ZXIgZ2F0ZWQgc3RhdGUK
PiArCSAqIHRvIFdBIHRoZSBJc3N1ZQo+ICsJICovCj4gKwo+ICsJLyogYSByZWFkIHJldHVybiB2
YWx1ZSBvZiAxIG1lYW5zIHNlbWFwaG9yZSBhY3VxaXJlICovCj4gKwlpZiAocmluZy0+ZnVuY3Mt
PnZtaHViID09IEFNREdQVV9NTUhVQl8wIHx8Cj4gKwkgICAgcmluZy0+ZnVuY3MtPnZtaHViID09
IEFNREdQVV9NTUhVQl8xKQo+ICsJYW1kZ3B1X3JpbmdfZW1pdF9yZWdfd2FpdChyaW5nLCBzZW0s
IDB4MSwgMHgxKTsKPiArCj4gICAJYW1kZ3B1X3JpbmdfZW1pdF9yZWdfd3JpdGVfcmVnX3dhaXQo
cmluZywgcmVnMCwgcmVnMSwKPiAgIAkJCQkJICAgIHJlZiwgbWFzayk7Cj4gKwkvKgo+ICsJICog
YWRkIHNlbWFwaG9yZSByZWxlYXNlIGFmdGVyIGludmFsaWRhdGlvbiwKPiArCSAqIHdyaXRlIHdp
dGggMCBtZWFucyBzZW1hcGhvcmUgcmVsZWFzZQo+ICsJICovCj4gKwlpZiAocmluZy0+ZnVuY3Mt
PnZtaHViID09IEFNREdQVV9NTUhVQl8wIHx8Cj4gKwkgICAgcmluZy0+ZnVuY3MtPnZtaHViID09
IEFNREdQVV9NTUhVQl8xKQo+ICsJYW1kZ3B1X3JpbmdfZW1pdF93cmVnKHJpbmcsIHNlbSwgMCk7
Cj4gKwo+ICAgCWFtZGdwdV9mZW5jZV9lbWl0X3BvbGxpbmcocmluZywgJnNlcSk7Cj4gICAJYW1k
Z3B1X3JpbmdfY29tbWl0KHJpbmcpOwo+ICAgCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmtpcS0+
cmluZ19sb2NrLCBmbGFncyk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV92aXJ0LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdmly
dC5oCj4gaW5kZXggYjBiMmJkYzc1MGRmLi5iZGE2YTJmMzdkYzAgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZpcnQuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92aXJ0LmgKPiBAQCAtMjk1LDcgKzI5NSw4IEBAIHVpbnQz
Ml90IGFtZGdwdV92aXJ0X2tpcV9ycmVnKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1aW50
MzJfdCByZWcpOwo+ICAgdm9pZCBhbWRncHVfdmlydF9raXFfd3JlZyhzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldiwgdWludDMyX3QgcmVnLCB1aW50MzJfdCB2KTsKPiAgIHZvaWQgYW1kZ3B1X3Zp
cnRfa2lxX3JlZ193cml0ZV9yZWdfd2FpdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAg
IAkJCQkJdWludDMyX3QgcmVnMCwgdWludDMyX3QgcnJlZzEsCj4gLQkJCQkJdWludDMyX3QgcmVm
LCB1aW50MzJfdCBtYXNrKTsKPiArCQkJCQl1aW50MzJfdCByZWYsIHVpbnQzMl90IG1hc2ssCj4g
KwkJCQkJdWludDMyX3Qgc2VtKTsKPiAgIGludCBhbWRncHVfdmlydF9yZXF1ZXN0X2Z1bGxfZ3B1
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBib29sIGluaXQpOwo+ICAgaW50IGFtZGdwdV92
aXJ0X3JlbGVhc2VfZnVsbF9ncHUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIGJvb2wgaW5p
dCk7Cj4gICBpbnQgYW1kZ3B1X3ZpcnRfcmVzZXRfZ3B1KHN0cnVjdCBhbWRncHVfZGV2aWNlICph
ZGV2KTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAu
YyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMKPiBpbmRleCBmMjVjZDk3
YmE1ZjIuLjFhZTU5YWY3ODM2YSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nbWNfdjlfMC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5
XzAuYwo+IEBAIC00NDgsOSArNDQ4LDEwIEBAIHN0YXRpYyB2b2lkIGdtY192OV8wX2ZsdXNoX2dw
dV90bGIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHVpbnQzMl90IHZtaWQsCj4gICAJCQkh
YWRldi0+aW5fZ3B1X3Jlc2V0KSB7Cj4gICAJCXVpbnQzMl90IHJlcSA9IGh1Yi0+dm1faW52X2Vu
ZzBfcmVxICsgZW5nOwo+ICAgCQl1aW50MzJfdCBhY2sgPSBodWItPnZtX2ludl9lbmcwX2FjayAr
IGVuZzsKPiArCQl1aW50MzJfdCBzZW0gPSBodWItPnZtX2ludl9lbmcwX3NlbSArIGVuZzsKPiAg
IAo+ICAgCQlhbWRncHVfdmlydF9raXFfcmVnX3dyaXRlX3JlZ193YWl0KGFkZXYsIHJlcSwgYWNr
LCB0bXAsCj4gLQkJCQkxIDw8IHZtaWQpOwo+ICsJCQkJCQkgICAxIDw8IHZtaWQsIHNlbSk7Cj4g
ICAJCXJldHVybjsKPiAgIAl9Cj4gICAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
YW1kLWdmeA==
