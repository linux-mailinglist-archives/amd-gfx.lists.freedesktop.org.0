Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 8C69F4C4A1
	for <lists+amd-gfx@lfdr.de>; Thu, 20 Jun 2019 02:53:29 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2AA746E49B;
	Thu, 20 Jun 2019 00:53:28 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM05-DM3-obe.outbound.protection.outlook.com
 (mail-eopbgr730079.outbound.protection.outlook.com [40.107.73.79])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 06E146E49B
 for <amd-gfx@lists.freedesktop.org>; Thu, 20 Jun 2019 00:53:26 +0000 (UTC)
Received: from CH2PR12MB3831.namprd12.prod.outlook.com (52.132.245.141) by
 CH2PR12MB3734.namprd12.prod.outlook.com (52.132.244.140) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1987.13; Thu, 20 Jun 2019 00:53:25 +0000
Received: from CH2PR12MB3831.namprd12.prod.outlook.com
 ([fe80::3459:726f:43e7:a64c]) by CH2PR12MB3831.namprd12.prod.outlook.com
 ([fe80::3459:726f:43e7:a64c%4]) with mapi id 15.20.1987.014; Thu, 20 Jun 2019
 00:53:25 +0000
From: "Kim, Jonathan" <Jonathan.Kim@amd.com>
To: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 1/2] drm/amdgpu: update df_v3_6 for xgmi perfmons
Thread-Topic: [PATCH 1/2] drm/amdgpu: update df_v3_6 for xgmi perfmons
Thread-Index: AQHVJwKQQHmqSIL4IUytMthKTBpOhQ==
Date: Thu, 20 Jun 2019 00:53:25 +0000
Message-ID: <20190620005313.56371-1-jonathan.kim@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: YTBPR01CA0026.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b01:14::39) To CH2PR12MB3831.namprd12.prod.outlook.com
 (2603:10b6:610:29::13)
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.17.1
x-originating-ip: [165.204.55.251]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 08531477-d244-4f22-6cf6-08d6f519b316
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);
 SRVR:CH2PR12MB3734; 
x-ms-traffictypediagnostic: CH2PR12MB3734:
x-microsoft-antispam-prvs: <CH2PR12MB3734DBF2ED42CCEC584AE8CF85E40@CH2PR12MB3734.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:3968;
x-forefront-prvs: 0074BBE012
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(136003)(39860400002)(376002)(346002)(366004)(396003)(189003)(199004)(1076003)(2351001)(316002)(66066001)(50226002)(54906003)(3846002)(81166006)(186003)(68736007)(5660300002)(71190400001)(36756003)(8676002)(476003)(52116002)(2501003)(81156014)(6506007)(386003)(66556008)(64756008)(66476007)(6116002)(66446008)(66946007)(72206003)(2616005)(2906002)(305945005)(71200400001)(8936002)(7736002)(73956011)(6916009)(25786009)(486006)(99286004)(6512007)(4326008)(6436002)(478600001)(30864003)(5640700003)(102836004)(86362001)(6486002)(26005)(53936002)(14454004)(53946003)(256004);
 DIR:OUT; SFP:1101; SCL:1; SRVR:CH2PR12MB3734;
 H:CH2PR12MB3831.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: dPg8VdXEF7eEkYKSwN2VLMWQE0CVKJ3iFsOMvbn5SAnIwp2Tv4Lrp4bgdRjDqdVW5c932PHVLWD13TbWqFGQWjZiPDTQDMVgyFQJVcvV2dBRNYosmsajNTMNkfZk3pQfugB5/JVnaBGk3Omr/8b0f4CI1Wdbv3eXAXNvPvhhRnpg6fJOMdvdo0gYWUnFLh1QVx8skU1P+trvJI8Qh9riA2e9YJqxgaAzAhF2kzYhNEwzZg1Aqs0uY4nj3EevNUYkmH6wjEVHMVGd4+0UB2symEimWv9xix7UiAxDff2QS9/F8k8jhyrdfKCNNUu+uNFrsGD8lZ0Zav+avurza389qfQdYACf7OqV924JO8HIryklYk8YMSrHHr4shs5DXN//p8h3G5MW+nupGQ8Ca69mFoJERg8rFiP0aiP7w2Or5W8=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 08531477-d244-4f22-6cf6-08d6f519b316
X-MS-Exchange-CrossTenant-originalarrivaltime: 20 Jun 2019 00:53:25.1540 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: jokim@amd.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: CH2PR12MB3734
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=i7jYYGHiEtPrpIrw4rmsg2/vO4zRQQzjdTo0sXC0zCE=;
 b=HPucEQW20+lc9N9cMDQUtE9z+0gU6e/jTKT8lsDGNrkTTrYU2xnS3W7O87I5BWUkG3L8lhwvKceWbN+SboBdDTJlhGGDot/ML3vEA+OnVZR0tK++hfBbjO+IfxkNsEzsOUOoaMFKDg8mtLdsI2MDDIeZGraTCFIxbnX2nN77KOU=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Jonathan.Kim@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Kim, Jonathan" <Jonathan.Kim@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

djQ6IGZpeGVkIGt6YWxsb2MgZXJyb3IgY2hlY2sgYW5kIG1vZGlmaWVkIGRmIGZ1bmMgaW5pdCB0
byByZXR1cm4gZXJyb3IgY29kZQ0KDQp2MzogZml4ZWQgY2xlYW51cCBieSBhZGRpbmcgZmluaSB0
byBmcmVlIHVwIGFkZXYgZGYgY29uZmlnIGNvdW50ZXJzDQoNCnYyOiBzaW1wbGlmaWVkIGJ5IHJl
bW92aW5nIHhnbWkgcmVmZXJlbmNlcyBpbiBmdW5jdGlvbiBuYW1lcyBhbmQgbW92aW5nIHRvDQpn
ZW5lcmljIGRmIGZ1bmN0aW9uIG5hbWVzLiAgZml4ZWQgaXNzdWUgYnkgcmVtb3ZpbmcgaGFyZGNv
ZGVkIGNha2UgdHggZGF0YQ0KZXZlbnRzLiBzdHJlYW1saW5lZCBlcnJvciBoYW5kbGluZyBieSBo
YXZpbmcgIGRmX3YzXzZfcG1jX2dldF9jdHJsIHJldHVybg0KZXJyb3IgY29kZS4NCg0KYWRkIHBt
dSBhdHRyaWJ1dGUgZ3JvdXBzIGFuZCBzdHJ1Y3R1cmVzIGZvciBwZXJmIGV2ZW50cy4NCmFkZCBz
eXNmcyB0byB0cmFjayBhdmFpbGFibGUgZGYgcGVyZm1vbiBjb3VudGVycw0KZml4IG92ZXJmbG93
IGhhbmRsaW5nIGluIHBlcmZtb24gY291bnRlciByZWFkcy4NCg0KQ2hhbmdlLUlkOiBJNjFmNzMx
YzAwNjZiMTc4MzQ2NTZjNzQ2ZTdlZmUwMzhjNGY2MmFjZg0KU2lnbmVkLW9mZi1ieTogSm9uYXRo
YW4gS2ltIDxKb25hdGhhbi5LaW1AYW1kLmNvbT4NCi0tLQ0KIGRyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdS5oICB8ICAxNyArDQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZGZf
djNfNi5jIHwgNDQ5ICsrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLQ0KIGRyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2RmX3YzXzYuaCB8ICAxOSArLQ0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L3NvYzE1LmMgICB8ICAgNCArDQogNCBmaWxlcyBjaGFuZ2VkLCAyMzEgaW5zZXJ0aW9ucygr
KSwgMjU4IGRlbGV0aW9ucygtKQ0KDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaA0KaW5k
ZXggZDM1NWU5YTA5YWQxLi45MWNmY2M3YmU1YzEgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHUuaA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1LmgNCkBAIC03MzIsNiArNzMyLDcgQEAgc3RydWN0IGFtZF9wb3dlcnBsYXkgew0KIH07
DQogDQogI2RlZmluZSBBTURHUFVfUkVTRVRfTUFHSUNfTlVNIDY0DQorI2RlZmluZSBBTURHUFVf
TUFYX0RGX1BFUkZNT05TIDE2DQogc3RydWN0IGFtZGdwdV9kZXZpY2Ugew0KIAlzdHJ1Y3QgZGV2
aWNlCQkJKmRldjsNCiAJc3RydWN0IGRybV9kZXZpY2UJCSpkZGV2Ow0KQEAgLTk2Miw2ICs5NjMs
NyBAQCBzdHJ1Y3QgYW1kZ3B1X2RldmljZSB7DQogCWxvbmcJCQkJY29tcHV0ZV90aW1lb3V0Ow0K
IA0KIAl1aW50NjRfdAkJCXVuaXF1ZV9pZDsNCisJdWludDY0X3QJZGZfcGVyZm1vbl9jb25maWdf
YXNzaWduX21hc2tbQU1ER1BVX01BWF9ERl9QRVJGTU9OU107DQogfTsNCiANCiBzdGF0aWMgaW5s
aW5lIHN0cnVjdCBhbWRncHVfZGV2aWNlICphbWRncHVfdHRtX2FkZXYoc3RydWN0IHR0bV9ib19k
ZXZpY2UgKmJkZXYpDQpAQCAtMTIwMSw0ICsxMjAzLDE5IEBAIHN0YXRpYyBpbmxpbmUgaW50IGFt
ZGdwdV9kbV9kaXNwbGF5X3Jlc3VtZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikgeyByZXR1
cm4NCiAjZW5kaWYNCiANCiAjaW5jbHVkZSAiYW1kZ3B1X29iamVjdC5oIg0KKw0KKy8qIHVzZWQg
YnkgZGZfdjNfNi5jIGFuZCBhbWRncHVfcG11LmMgKi8NCisjZGVmaW5lIEFNREdQVV9QTVVfQVRU
UihfbmFtZSwgX29iamVjdCkJCQkJXA0KK3N0YXRpYyBzc2l6ZV90CQkJCQkJCQlcDQorX25hbWUj
I19zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwJCQkJCVwNCisJCQkgICAgICAgc3RydWN0IGRldmlj
ZV9hdHRyaWJ1dGUgKmF0dHIsCQlcDQorCQkJICAgICAgIGNoYXIgKnBhZ2UpCQkJCVwNCit7CQkJ
CQkJCQkJXA0KKwlCVUlMRF9CVUdfT04oc2l6ZW9mKF9vYmplY3QpID49IFBBR0VfU0laRSAtIDEp
OwkJCVwNCisJcmV0dXJuIHNwcmludGYocGFnZSwgX29iamVjdCAiXG4iKTsJCQkJXA0KK30JCQkJ
CQkJCQlcDQorCQkJCQkJCQkJXA0KK3N0YXRpYyBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSBwbXVf
YXR0cl8jI19uYW1lID0gX19BVFRSX1JPKF9uYW1lKQ0KKw0KICNlbmRpZg0KKw0KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2RmX3YzXzYuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2RmX3YzXzYuYw0KaW5kZXggOGMwOWJmOTk0YWNkLi4xMmUzZTY3MDEzZDkg
MTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9kZl92M182LmMNCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2RmX3YzXzYuYw0KQEAgLTMwLDggKzMwLDEwNCBA
QA0KIHN0YXRpYyB1MzIgZGZfdjNfNl9jaGFubmVsX251bWJlcltdID0gezEsIDIsIDAsIDQsIDAs
IDgsIDAsDQogCQkJCSAgICAgICAxNiwgMzIsIDAsIDAsIDAsIDIsIDQsIDh9Ow0KIA0KKy8qIGlu
aXQgZGYgZm9ybWF0IGF0dHJzICovDQorQU1ER1BVX1BNVV9BVFRSKGV2ZW50LAkJImNvbmZpZzow
LTciKTsNCitBTURHUFVfUE1VX0FUVFIoaW5zdGFuY2UsCSJjb25maWc6OC0xNSIpOw0KK0FNREdQ
VV9QTVVfQVRUUih1bWFzaywJCSJjb25maWc6MTYtMjMiKTsNCisNCisvKiBkZiBmb3JtYXQgYXR0
cmlidXRlcyAgKi8NCitzdGF0aWMgc3RydWN0IGF0dHJpYnV0ZSAqZGZfdjNfNl9mb3JtYXRfYXR0
cnNbXSA9IHsNCisJJnBtdV9hdHRyX2V2ZW50LmF0dHIsDQorCSZwbXVfYXR0cl9pbnN0YW5jZS5h
dHRyLA0KKwkmcG11X2F0dHJfdW1hc2suYXR0ciwNCisJTlVMTA0KK307DQorDQorLyogZGYgZm9y
bWF0IGF0dHJpYnV0ZSBncm91cCAqLw0KK3N0YXRpYyBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIGRm
X3YzXzZfZm9ybWF0X2F0dHJfZ3JvdXAgPSB7DQorCS5uYW1lID0gImZvcm1hdCIsDQorCS5hdHRy
cyA9IGRmX3YzXzZfZm9ybWF0X2F0dHJzLA0KK307DQorDQorLyogZGYgZXZlbnQgYXR0cnMgKi8N
CitBTURHUFVfUE1VX0FUVFIoY2FrZTBfcGNzb3V0X3R4ZGF0YSwNCisJCSAgICAgICJldmVudD0w
eDcsaW5zdGFuY2U9MHg0Nix1bWFzaz0weDIiKTsNCitBTURHUFVfUE1VX0FUVFIoY2FrZTFfcGNz
b3V0X3R4ZGF0YSwNCisJCSAgICAgICJldmVudD0weDcsaW5zdGFuY2U9MHg0Nyx1bWFzaz0weDIi
KTsNCitBTURHUFVfUE1VX0FUVFIoY2FrZTBfcGNzb3V0X3R4bWV0YSwNCisJCSAgICAgICJldmVu
dD0weDcsaW5zdGFuY2U9MHg0Nix1bWFzaz0weDQiKTsNCitBTURHUFVfUE1VX0FUVFIoY2FrZTFf
cGNzb3V0X3R4bWV0YSwNCisJCSAgICAgICJldmVudD0weDcsaW5zdGFuY2U9MHg0Nyx1bWFzaz0w
eDQiKTsNCitBTURHUFVfUE1VX0FUVFIoY2FrZTBfZnRpaW5zdGF0X3JlcWFsbG9jLA0KKwkJICAg
ICAgImV2ZW50PTB4YixpbnN0YW5jZT0weDQ2LHVtYXNrPTB4NCIpOw0KK0FNREdQVV9QTVVfQVRU
UihjYWtlMV9mdGlpbnN0YXRfcmVxYWxsb2MsDQorCQkgICAgICAiZXZlbnQ9MHhiLGluc3RhbmNl
PTB4NDcsdW1hc2s9MHg0Iik7DQorQU1ER1BVX1BNVV9BVFRSKGNha2UwX2Z0aWluc3RhdF9yc3Bh
bGxvYywNCisJCSAgICAgICJldmVudD0weGIsaW5zdGFuY2U9MHg0Nix1bWFzaz0weDgiKTsNCitB
TURHUFVfUE1VX0FUVFIoY2FrZTFfZnRpaW5zdGF0X3JzcGFsbG9jLA0KKwkJICAgICAgImV2ZW50
PTB4YixpbnN0YW5jZT0weDQ3LHVtYXNrPTB4OCIpOw0KKw0KKy8qIGRmIGV2ZW50IGF0dHJpYnV0
ZXMgICovDQorc3RhdGljIHN0cnVjdCBhdHRyaWJ1dGUgKmRmX3YzXzZfZXZlbnRfYXR0cnNbXSA9
IHsNCisJJnBtdV9hdHRyX2Nha2UwX3Bjc291dF90eGRhdGEuYXR0ciwNCisJJnBtdV9hdHRyX2Nh
a2UxX3Bjc291dF90eGRhdGEuYXR0ciwNCisJJnBtdV9hdHRyX2Nha2UwX3Bjc291dF90eG1ldGEu
YXR0ciwNCisJJnBtdV9hdHRyX2Nha2UxX3Bjc291dF90eG1ldGEuYXR0ciwNCisJJnBtdV9hdHRy
X2Nha2UwX2Z0aWluc3RhdF9yZXFhbGxvYy5hdHRyLA0KKwkmcG11X2F0dHJfY2FrZTFfZnRpaW5z
dGF0X3JlcWFsbG9jLmF0dHIsDQorCSZwbXVfYXR0cl9jYWtlMF9mdGlpbnN0YXRfcnNwYWxsb2Mu
YXR0ciwNCisJJnBtdV9hdHRyX2Nha2UxX2Z0aWluc3RhdF9yc3BhbGxvYy5hdHRyLA0KKwlOVUxM
DQorfTsNCisNCisvKiBkZiBldmVudCBhdHRyaWJ1dGUgZ3JvdXAgKi8NCitzdGF0aWMgc3RydWN0
IGF0dHJpYnV0ZV9ncm91cCBkZl92M182X2V2ZW50X2F0dHJfZ3JvdXAgPSB7DQorCS5uYW1lID0g
ImV2ZW50cyIsDQorCS5hdHRycyA9IGRmX3YzXzZfZXZlbnRfYXR0cnMNCit9Ow0KKw0KKy8qIGRm
IGV2ZW50IGF0dHIgZ3JvdXBzICAqLw0KK2NvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKmRm
X3YzXzZfYXR0cl9ncm91cHNbXSA9IHsNCisJCSZkZl92M182X2Zvcm1hdF9hdHRyX2dyb3VwLA0K
KwkJJmRmX3YzXzZfZXZlbnRfYXR0cl9ncm91cCwNCisJCU5VTEwNCit9Ow0KKw0KKy8qIGdldCB0
aGUgbnVtYmVyIG9mIGRmIGNvdW50ZXJzIGF2YWlsYWJsZSAqLw0KK3N0YXRpYyBzc2l6ZV90IGRm
X3YzXzZfZ2V0X2RmX2NudHJfYXZhaWwoc3RydWN0IGRldmljZSAqZGV2LA0KKwkJc3RydWN0IGRl
dmljZV9hdHRyaWJ1dGUgKmF0dHIsDQorCQljaGFyICpidWYpDQorew0KKwlzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqYWRldjsNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXY7DQorCWludCBpLCBjb3Vu
dDsNCisNCisJZGRldiA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOw0KKwlhZGV2ID0gZGRldi0+ZGV2
X3ByaXZhdGU7DQorCWNvdW50ID0gMDsNCisNCisJZm9yIChpID0gMDsgaSA8IERGX1YzXzZfTUFY
X0NPVU5URVJTOyBpKyspIHsNCisJCWlmIChhZGV2LT5kZl9wZXJmbW9uX2NvbmZpZ19hc3NpZ25f
bWFza1tpXSA9PSAwKQ0KKwkJCWNvdW50Kys7DQorCX0NCisNCisJcmV0dXJuIHNucHJpbnRmKGJ1
ZiwgUEFHRV9TSVpFLAkiJWlcbiIsIGNvdW50KTsNCit9DQorDQorLyogZGV2aWNlIGF0dHIgZm9y
IGF2YWlsYWJsZSBwZXJmbW9uIGNvdW50ZXJzICovDQorc3RhdGljIERFVklDRV9BVFRSKGRmX2Nu
dHJfYXZhaWwsIFNfSVJVR08sIGRmX3YzXzZfZ2V0X2RmX2NudHJfYXZhaWwsIE5VTEwpOw0KKw0K
Ky8qIGluaXQgcGVyZm1vbnMgKi8NCiBzdGF0aWMgdm9pZCBkZl92M182X2luaXQoc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYpDQogew0KKwlpbnQgaSwgcmV0Ow0KKw0KKwlyZXQgPSBkZXZpY2Vf
Y3JlYXRlX2ZpbGUoYWRldi0+ZGV2LCAmZGV2X2F0dHJfZGZfY250cl9hdmFpbCk7DQorCWlmIChy
ZXQpDQorCQlEUk1fRVJST1IoImZhaWxlZCB0byBjcmVhdGUgZmlsZSBmb3IgYXZhaWxhYmxlIGRm
IGNvdW50ZXJzXG4iKTsNCisNCisJZm9yIChpID0gMDsgaSA8IEFNREdQVV9NQVhfREZfUEVSRk1P
TlM7IGkrKykNCisJCWFkZXYtPmRmX3BlcmZtb25fY29uZmlnX2Fzc2lnbl9tYXNrW2ldID0gMDsN
CiB9DQogDQogc3RhdGljIHZvaWQgZGZfdjNfNl9lbmFibGVfYnJvYWRjYXN0X21vZGUoc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQpAQCAtMTA1LDI4ICsyMDEsMTkgQEAgc3RhdGljIHZvaWQg
ZGZfdjNfNl9nZXRfY2xvY2tnYXRpbmdfc3RhdGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
DQogCQkqZmxhZ3MgfD0gQU1EX0NHX1NVUFBPUlRfREZfTUdDRzsNCiB9DQogDQotLyogaG9sZCBj
b3VudGVyIGFzc2lnbm1lbnQgcGVyIGdwdSBzdHJ1Y3QgKi8NCi1zdHJ1Y3QgZGZfdjNfNl9ldmVu
dF9tYXNrIHsNCi0JCXN0cnVjdCBhbWRncHVfZGV2aWNlIGdwdTsNCi0JCXVpbnQ2NF90IGNvbmZp
Z19hc3NpZ25fbWFza1tBTURHUFVfREZfTUFYX0NPVU5URVJTXTsNCi19Ow0KLQ0KIC8qIGdldCBh
c3NpZ25lZCBkZiBwZXJmbW9uIGN0ciBhcyBpbnQgKi8NCi1zdGF0aWMgdm9pZCBkZl92M182X3Bt
Y19jb25maWdfMl9jbnRyKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KLQkJCQkgICAgICB1
aW50NjRfdCBjb25maWcsDQotCQkJCSAgICAgIGludCAqY291bnRlcikNCitzdGF0aWMgaW50IGRm
X3YzXzZfcG1jX2NvbmZpZ18yX2NudHIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQorCQkJ
CSAgICAgIHVpbnQ2NF90IGNvbmZpZykNCiB7DQotCXN0cnVjdCBkZl92M182X2V2ZW50X21hc2sg
Km1hc2s7DQogCWludCBpOw0KIA0KLQltYXNrID0gY29udGFpbmVyX29mKGFkZXYsIHN0cnVjdCBk
Zl92M182X2V2ZW50X21hc2ssIGdwdSk7DQotDQotCWZvciAoaSA9IDA7IGkgPCBBTURHUFVfREZf
TUFYX0NPVU5URVJTOyBpKyspIHsNCi0JCWlmICgoY29uZmlnICYgMHgwRkZGRkZGVUwpID09IG1h
c2stPmNvbmZpZ19hc3NpZ25fbWFza1tpXSkgew0KLQkJCSpjb3VudGVyID0gaTsNCi0JCQlyZXR1
cm47DQotCQl9DQorCWZvciAoaSA9IDA7IGkgPCBERl9WM182X01BWF9DT1VOVEVSUzsgaSsrKSB7
DQorCQlpZiAoKGNvbmZpZyAmIDB4MEZGRkZGRlVMKSA9PQ0KKwkJCQkJYWRldi0+ZGZfcGVyZm1v
bl9jb25maWdfYXNzaWduX21hc2tbaV0pDQorCQkJcmV0dXJuIGk7DQogCX0NCisNCisJcmV0dXJu
IC1FSU5WQUw7DQogfQ0KIA0KIC8qIGdldCBhZGRyZXNzIGJhc2VkIG9uIGNvdW50ZXIgYXNzaWdu
bWVudCAqLw0KQEAgLTEzNiwxMCArMjIzLDcgQEAgc3RhdGljIHZvaWQgZGZfdjNfNl9wbWNfZ2V0
X2FkZHIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQogCQkJCSB1aW50MzJfdCAqbG9fYmFz
ZV9hZGRyLA0KIAkJCQkgdWludDMyX3QgKmhpX2Jhc2VfYWRkcikNCiB7DQotDQotCWludCB0YXJn
ZXRfY250ciA9IC0xOw0KLQ0KLQlkZl92M182X3BtY19jb25maWdfMl9jbnRyKGFkZXYsIGNvbmZp
ZywgJnRhcmdldF9jbnRyKTsNCisJaW50IHRhcmdldF9jbnRyID0gZGZfdjNfNl9wbWNfY29uZmln
XzJfY250cihhZGV2LCBjb25maWcpOw0KIA0KIAlpZiAodGFyZ2V0X2NudHIgPCAwKQ0KIAkJcmV0
dXJuOw0KQEAgLTE3Nyw0MCArMjYxLDM4IEBAIHN0YXRpYyB2b2lkIGRmX3YzXzZfcG1jX2dldF9y
ZWFkX3NldHRpbmdzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KIH0NCiANCiAvKiBnZXQg
Y29udHJvbCBjb3VudGVyIHNldHRpbmdzIGkuZS4gYWRkcmVzcyBhbmQgdmFsdWVzIHRvIHNldCAq
Lw0KLXN0YXRpYyB2b2lkIGRmX3YzXzZfcG1jX2dldF9jdHJsX3NldHRpbmdzKHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2LA0KK3N0YXRpYyBpbnQgZGZfdjNfNl9wbWNfZ2V0X2N0cmxfc2V0dGlu
Z3Moc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQogCQkJCQkgIHVpbnQ2NF90IGNvbmZpZywN
CiAJCQkJCSAgdWludDMyX3QgKmxvX2Jhc2VfYWRkciwNCiAJCQkJCSAgdWludDMyX3QgKmhpX2Jh
c2VfYWRkciwNCiAJCQkJCSAgdWludDMyX3QgKmxvX3ZhbCwNCiAJCQkJCSAgdWludDMyX3QgKmhp
X3ZhbCkNCiB7DQotDQotCXVpbnQzMl90IGV2ZW50c2VsLCBpbnN0YW5jZSwgdW5pdG1hc2s7DQot
CXVpbnQzMl90IGVzXzVfMCwgZXNfMTNfMCwgZXNfMTNfNiwgZXNfMTNfMTIsIGVzXzExXzgsIGVz
XzdfMDsNCi0NCiAJZGZfdjNfNl9wbWNfZ2V0X2FkZHIoYWRldiwgY29uZmlnLCAxLCBsb19iYXNl
X2FkZHIsIGhpX2Jhc2VfYWRkcik7DQogDQotCWlmIChsb192YWwgPT0gTlVMTCB8fCBoaV92YWwg
PT0gTlVMTCkNCi0JCXJldHVybjsNCi0NCiAJaWYgKCgqbG9fYmFzZV9hZGRyID09IDApIHx8ICgq
aGlfYmFzZV9hZGRyID09IDApKSB7DQotCQlEUk1fRVJST1IoIkRGIFBNQyBhZGRyZXNzaW5nIG5v
dCByZXRyaWV2ZWQhIExvOiAleCwgSGk6ICV4IiwNCisJCURSTV9FUlJPUigiW0RGIFBNQ10gYWRk
cmVzc2luZyBub3QgcmV0cmlldmVkISBMbzogJXgsIEhpOiAleCIsDQogCQkJCSpsb19iYXNlX2Fk
ZHIsICpoaV9iYXNlX2FkZHIpOw0KLQkJcmV0dXJuOw0KKwkJcmV0dXJuIC1FTlhJTzsNCisJfQ0K
Kw0KKwlpZiAobG9fdmFsICYmIGhpX3ZhbCkgew0KKwkJdWludDMyX3QgZXZlbnRzZWwsIGluc3Rh
bmNlLCB1bml0bWFzazsNCisJCXVpbnQzMl90IGluc3RhbmNlXzEwLCBpbnN0YW5jZV81NDMyLCBp
bnN0YW5jZV83NjsNCisNCisJCWV2ZW50c2VsID0gREZfVjNfNl9HRVRfRVZFTlQoY29uZmlnKSAm
IDB4M2Y7DQorCQl1bml0bWFzayA9IERGX1YzXzZfR0VUX1VOSVRNQVNLKGNvbmZpZykgJiAweGY7
DQorCQlpbnN0YW5jZSA9IERGX1YzXzZfR0VUX0lOU1RBTkNFKGNvbmZpZyk7DQorDQorCQlpbnN0
YW5jZV8xMCA9IGluc3RhbmNlICYgMHgzOw0KKwkJaW5zdGFuY2VfNTQzMiA9IChpbnN0YW5jZSA+
PiAyKSAmIDB4ZjsNCisJCWluc3RhbmNlXzc2ID0gKGluc3RhbmNlID4+IDYpICYgMHgzOw0KKw0K
KwkJKmxvX3ZhbCA9ICh1bml0bWFzayA8PCA4KSB8IChpbnN0YW5jZV8xMCA8PCA2KSB8IGV2ZW50
c2VsOw0KKwkJKmhpX3ZhbCA9IChpbnN0YW5jZV83NiA8PCAyOSkgfCBpbnN0YW5jZV81NDMyOw0K
IAl9DQogDQotCWV2ZW50c2VsID0gR0VUX0VWRU5UKGNvbmZpZyk7DQotCWluc3RhbmNlID0gR0VU
X0lOU1RBTkNFKGNvbmZpZyk7DQotCXVuaXRtYXNrID0gR0VUX1VOSVRNQVNLKGNvbmZpZyk7DQot
DQotCWVzXzVfMCA9IGV2ZW50c2VsICYgMHgzRlVMOw0KLQllc18xM182ID0gaW5zdGFuY2U7DQot
CWVzXzEzXzAgPSAoZXNfMTNfNiA8PCA2KSArIGVzXzVfMDsNCi0JZXNfMTNfMTIgPSAoZXNfMTNf
MCAmIDB4MDMwMDBVTCkgPj4gMTI7DQotCWVzXzExXzggPSAoZXNfMTNfMCAmIDB4MEYwMFVMKSA+
PiA4Ow0KLQllc183XzAgPSBlc18xM18wICYgMHgwRkZVTDsNCi0JKmxvX3ZhbCA9IChlc183XzAg
JiAweEZGVUwpIHwgKCh1bml0bWFzayAmIDB4MEZVTCkgPDwgOCk7DQotCSpoaV92YWwgPSAoZXNf
MTFfOCB8ICgoZXNfMTNfMTIpPDwoMjkpKSk7DQorCXJldHVybiAwOw0KIH0NCiANCiAvKiBhc3Np
Z24gZGYgcGVyZm9ybWFuY2UgY291bnRlcnMgZm9yIHJlYWQgKi8NCkBAIC0yMTgsMjYgKzMwMCwy
MSBAQCBzdGF0aWMgaW50IGRmX3YzXzZfcG1jX2Fzc2lnbl9jbnRyKHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LA0KIAkJCQkgICB1aW50NjRfdCBjb25maWcsDQogCQkJCSAgIGludCAqaXNfYXNz
aWduZWQpDQogew0KLQ0KLQlzdHJ1Y3QgZGZfdjNfNl9ldmVudF9tYXNrICptYXNrOw0KIAlpbnQg
aSwgdGFyZ2V0X2NudHI7DQogDQotCXRhcmdldF9jbnRyID0gLTE7DQotDQogCSppc19hc3NpZ25l
ZCA9IDA7DQogDQotCWRmX3YzXzZfcG1jX2NvbmZpZ18yX2NudHIoYWRldiwgY29uZmlnLCAmdGFy
Z2V0X2NudHIpOw0KKwl0YXJnZXRfY250ciA9IGRmX3YzXzZfcG1jX2NvbmZpZ18yX2NudHIoYWRl
diwgY29uZmlnKTsNCiANCiAJaWYgKHRhcmdldF9jbnRyID49IDApIHsNCiAJCSppc19hc3NpZ25l
ZCA9IDE7DQogCQlyZXR1cm4gMDsNCiAJfQ0KIA0KLQltYXNrID0gY29udGFpbmVyX29mKGFkZXYs
IHN0cnVjdCBkZl92M182X2V2ZW50X21hc2ssIGdwdSk7DQotDQotCWZvciAoaSA9IDA7IGkgPCBB
TURHUFVfREZfTUFYX0NPVU5URVJTOyBpKyspIHsNCi0JCWlmIChtYXNrLT5jb25maWdfYXNzaWdu
X21hc2tbaV0gPT0gMFVMTCkgew0KLQkJCW1hc2stPmNvbmZpZ19hc3NpZ25fbWFza1tpXSA9IGNv
bmZpZyAmIDB4MEZGRkZGRlVMOw0KKwlmb3IgKGkgPSAwOyBpIDwgREZfVjNfNl9NQVhfQ09VTlRF
UlM7IGkrKykgew0KKwkJaWYgKGFkZXYtPmRmX3BlcmZtb25fY29uZmlnX2Fzc2lnbl9tYXNrW2ld
ID09IDBVKSB7DQorCQkJYWRldi0+ZGZfcGVyZm1vbl9jb25maWdfYXNzaWduX21hc2tbaV0gPQ0K
KwkJCQkJCQljb25maWcgJiAweDBGRkZGRkZVTDsNCiAJCQlyZXR1cm4gMDsNCiAJCX0NCiAJfQ0K
QEAgLTI0OSw2NiArMzI2LDE3IEBAIHN0YXRpYyBpbnQgZGZfdjNfNl9wbWNfYXNzaWduX2NudHIo
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQogc3RhdGljIHZvaWQgZGZfdjNfNl9wbWNfcmVs
ZWFzZV9jbnRyKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KIAkJCQkgICAgIHVpbnQ2NF90
IGNvbmZpZykNCiB7DQotDQotCXN0cnVjdCBkZl92M182X2V2ZW50X21hc2sgKm1hc2s7DQotCWlu
dCB0YXJnZXRfY250cjsNCi0NCi0JdGFyZ2V0X2NudHIgPSAtMTsNCi0NCi0JZGZfdjNfNl9wbWNf
Y29uZmlnXzJfY250cihhZGV2LCBjb25maWcsICZ0YXJnZXRfY250cik7DQotDQotCW1hc2sgPSBj
b250YWluZXJfb2YoYWRldiwgc3RydWN0IGRmX3YzXzZfZXZlbnRfbWFzaywgZ3B1KTsNCisJaW50
IHRhcmdldF9jbnRyID0gZGZfdjNfNl9wbWNfY29uZmlnXzJfY250cihhZGV2LCBjb25maWcpOw0K
IA0KIAlpZiAodGFyZ2V0X2NudHIgPj0gMCkNCi0JCW1hc2stPmNvbmZpZ19hc3NpZ25fbWFza1t0
YXJnZXRfY250cl0gPSAwVUxMOw0KLQ0KKwkJYWRldi0+ZGZfcGVyZm1vbl9jb25maWdfYXNzaWdu
X21hc2tbdGFyZ2V0X2NudHJdID0gMFVMTDsNCiB9DQogDQotLyoNCi0gKiBnZXQgeGdtaSBsaW5r
IGNvdW50ZXJzIHZpYSBwcm9ncmFtbWFibGUgZGF0YSBmYWJyaWMgKGRmKSBjb3VudGVycyAobWF4
IDQpDQotICogdXNpbmcgY2FrZSB0eCBldmVudC4NCi0gKg0KLSAqIEBhZGV2IC0+IGFtZGdwdSBk
ZXZpY2UNCi0gKiBAaW5zdGFuY2UtPiBjdXJyZW50bHkgY2FrZSBoYXMgMiBsaW5rcyB0byBwb2xs
IG9uIHZlZ2EyMA0KLSAqIEBjb3VudCAtPiBjb3VudGVycyB0byBwYXNzDQotICoNCi0gKi8NCi0N
Ci1zdGF0aWMgdm9pZCBkZl92M182X2dldF94Z21pX2xpbmtfY250cihzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldiwNCi0JCQkJICAgICAgIGludCBpbnN0YW5jZSwNCi0JCQkJICAgICAgIHVpbnQ2
NF90ICpjb3VudCkNCi17DQotCXVpbnQzMl90IGxvX2Jhc2VfYWRkciwgaGlfYmFzZV9hZGRyLCBs
b192YWwsIGhpX3ZhbDsNCi0JdWludDY0X3QgY29uZmlnOw0KLQ0KLQljb25maWcgPSBHRVRfSU5T
VEFOQ0VfQ09ORklHKGluc3RhbmNlKTsNCi0NCi0JZGZfdjNfNl9wbWNfZ2V0X3JlYWRfc2V0dGlu
Z3MoYWRldiwgY29uZmlnLCAmbG9fYmFzZV9hZGRyLA0KLQkJCQkgICAgICAmaGlfYmFzZV9hZGRy
KTsNCi0NCi0JaWYgKChsb19iYXNlX2FkZHIgPT0gMCkgfHwgKGhpX2Jhc2VfYWRkciA9PSAwKSkN
Ci0JCXJldHVybjsNCi0NCi0JbG9fdmFsID0gUlJFRzMyX1BDSUUobG9fYmFzZV9hZGRyKTsNCi0J
aGlfdmFsID0gUlJFRzMyX1BDSUUoaGlfYmFzZV9hZGRyKTsNCiANCi0JKmNvdW50ICA9ICgoaGlf
dmFsIHwgMFVMTCkgPDwgMzIpIHwgKGxvX3ZhbCB8IDBVTEwpOw0KLX0NCi0NCi0vKg0KLSAqIHJl
c2V0IHhnbWkgbGluayBjb3VudGVycw0KLSAqDQotICogQGFkZXYgLT4gYW1kZ3B1IGRldmljZQ0K
LSAqIEBpbnN0YW5jZS0+IGN1cnJlbnRseSBjYWtlIGhhcyAyIGxpbmtzIHRvIHBvbGwgb24gdmVn
YTIwDQotICoNCi0gKi8NCi1zdGF0aWMgdm9pZCBkZl92M182X3Jlc2V0X3hnbWlfbGlua19jbnRy
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KLQkJCQkJIGludCBpbnN0YW5jZSkNCitzdGF0
aWMgdm9pZCBkZl92M182X3Jlc2V0X3BlcmZtb25fY250cihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiwNCisJCQkJCSB1aW50NjRfdCBjb25maWcpDQogew0KIAl1aW50MzJfdCBsb19iYXNlX2Fk
ZHIsIGhpX2Jhc2VfYWRkcjsNCi0JdWludDY0X3QgY29uZmlnOw0KLQ0KLQljb25maWcgPSAwVUxM
IHwgKDB4N1VMTCkgfCAoKDB4NDZVTEwgKyBpbnN0YW5jZSkgPDwgOCkgfCAoMHgyIDw8IDE2KTsN
CiANCiAJZGZfdjNfNl9wbWNfZ2V0X3JlYWRfc2V0dGluZ3MoYWRldiwgY29uZmlnLCAmbG9fYmFz
ZV9hZGRyLA0KIAkJCQkgICAgICAmaGlfYmFzZV9hZGRyKTsNCkBAIC0zMjAsMTg1ICszNDgsMTA2
IEBAIHN0YXRpYyB2b2lkIGRmX3YzXzZfcmVzZXRfeGdtaV9saW5rX2NudHIoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsDQogCVdSRUczMl9QQ0lFKGhpX2Jhc2VfYWRkciwgMFVMKTsNCiB9DQog
DQotLyoNCi0gKiBhZGQgeGdtaSBsaW5rIGNvdW50ZXJzDQotICoNCi0gKiBAYWRldiAtPiBhbWRn
cHUgZGV2aWNlDQotICogQGluc3RhbmNlLT4gY3VycmVudGx5IGNha2UgaGFzIDIgbGlua3MgdG8g
cG9sbCBvbiB2ZWdhMjANCi0gKg0KLSAqLw0KIA0KLXN0YXRpYyBpbnQgZGZfdjNfNl9hZGRfeGdt
aV9saW5rX2NudHIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQotCQkJCSAgICAgIGludCBp
bnN0YW5jZSkNCitzdGF0aWMgaW50IGRmX3YzXzZfYWRkX3BlcmZtb25fY250cihzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiwNCisJCQkJICAgICAgdWludDY0X3QgY29uZmlnKQ0KIHsNCiAJdWlu
dDMyX3QgbG9fYmFzZV9hZGRyLCBoaV9iYXNlX2FkZHIsIGxvX3ZhbCwgaGlfdmFsOw0KLQl1aW50
NjRfdCBjb25maWc7DQogCWludCByZXQsIGlzX2Fzc2lnbmVkOw0KIA0KLQlpZiAoaW5zdGFuY2Ug
PCAwIHx8IGluc3RhbmNlID4gMSkNCi0JCXJldHVybiAtRUlOVkFMOw0KLQ0KLQljb25maWcgPSBH
RVRfSU5TVEFOQ0VfQ09ORklHKGluc3RhbmNlKTsNCi0NCiAJcmV0ID0gZGZfdjNfNl9wbWNfYXNz
aWduX2NudHIoYWRldiwgY29uZmlnLCAmaXNfYXNzaWduZWQpOw0KIA0KIAlpZiAocmV0IHx8IGlz
X2Fzc2lnbmVkKQ0KIAkJcmV0dXJuIHJldDsNCiANCi0JZGZfdjNfNl9wbWNfZ2V0X2N0cmxfc2V0
dGluZ3MoYWRldiwNCisJcmV0ID0gZGZfdjNfNl9wbWNfZ2V0X2N0cmxfc2V0dGluZ3MoYWRldiwN
CiAJCQljb25maWcsDQogCQkJJmxvX2Jhc2VfYWRkciwNCiAJCQkmaGlfYmFzZV9hZGRyLA0KIAkJ
CSZsb192YWwsDQogCQkJJmhpX3ZhbCk7DQogDQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0K
Kw0KKwlEUk1fREVCVUdfRFJJVkVSKCJjb25maWc9JWxseCBhZGRyPSUwOHg6JTA4eCB2YWw9JTA4
eDolMDh4IiwNCisJCQljb25maWcsIGxvX2Jhc2VfYWRkciwgaGlfYmFzZV9hZGRyLCBsb192YWws
IGhpX3ZhbCk7DQorDQogCVdSRUczMl9QQ0lFKGxvX2Jhc2VfYWRkciwgbG9fdmFsKTsNCiAJV1JF
RzMyX1BDSUUoaGlfYmFzZV9hZGRyLCBoaV92YWwpOw0KIA0KIAlyZXR1cm4gcmV0Ow0KIH0NCiAN
Ci0NCi0vKg0KLSAqIHN0YXJ0IHhnbWkgbGluayBjb3VudGVycw0KLSAqDQotICogQGFkZXYgLT4g
YW1kZ3B1IGRldmljZQ0KLSAqIEBpbnN0YW5jZS0+IGN1cnJlbnRseSBjYWtlIGhhcyAyIGxpbmtz
IHRvIHBvbGwgb24gdmVnYTIwDQotICogQGlzX2VuYWJsZSAtPiBlaXRoZXIgcmVzdW1lIG9yIGFz
c2lnbiBldmVudCB2aWEgZGYgcGVyZm1vbg0KLSAqDQotICovDQotDQotc3RhdGljIGludCBkZl92
M182X3N0YXJ0X3hnbWlfbGlua19jbnRyKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KLQkJ
CQkJaW50IGluc3RhbmNlLA0KLQkJCQkJaW50IGlzX2VuYWJsZSkNCitzdGF0aWMgaW50IGRmX3Yz
XzZfcG1jX3N0YXJ0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1aW50NjRfdCBjb25maWcs
DQorCQkJICAgICBpbnQgaXNfZW5hYmxlKQ0KIHsNCiAJdWludDMyX3QgbG9fYmFzZV9hZGRyLCBo
aV9iYXNlX2FkZHIsIGxvX3ZhbDsNCi0JdWludDY0X3QgY29uZmlnOw0KLQlpbnQgcmV0Ow0KLQ0K
LQlpZiAoaW5zdGFuY2UgPCAwIHx8IGluc3RhbmNlID4gMSkNCi0JCXJldHVybiAtRUlOVkFMOw0K
LQ0KLQlpZiAoaXNfZW5hYmxlKSB7DQorCWludCByZXQgPSAwOw0KIA0KLQkJcmV0ID0gZGZfdjNf
Nl9hZGRfeGdtaV9saW5rX2NudHIoYWRldiwgaW5zdGFuY2UpOw0KLQ0KLQkJaWYgKHJldCkNCi0J
CQlyZXR1cm4gcmV0Ow0KKwlzd2l0Y2ggKGFkZXYtPmFzaWNfdHlwZSkgew0KKwljYXNlIENISVBf
VkVHQTIwOg0KIA0KLQl9IGVsc2Ugew0KKwkJZGZfdjNfNl9yZXNldF9wZXJmbW9uX2NudHIoYWRl
diwgY29uZmlnKTsNCiANCi0JCWNvbmZpZyA9IEdFVF9JTlNUQU5DRV9DT05GSUcoaW5zdGFuY2Up
Ow0KKwkJaWYgKGlzX2VuYWJsZSkgew0KKwkJCXJldCA9IGRmX3YzXzZfYWRkX3BlcmZtb25fY250
cihhZGV2LCBjb25maWcpOw0KKwkJfSBlbHNlIHsNCisJCQlyZXQgPSBkZl92M182X3BtY19nZXRf
Y3RybF9zZXR0aW5ncyhhZGV2LA0KKwkJCQkJY29uZmlnLA0KKwkJCQkJJmxvX2Jhc2VfYWRkciwN
CisJCQkJCSZoaV9iYXNlX2FkZHIsDQorCQkJCQlOVUxMLA0KKwkJCQkJTlVMTCk7DQogDQotCQlk
Zl92M182X3BtY19nZXRfY3RybF9zZXR0aW5ncyhhZGV2LA0KLQkJCQljb25maWcsDQotCQkJCSZs
b19iYXNlX2FkZHIsDQotCQkJCSZoaV9iYXNlX2FkZHIsDQotCQkJCU5VTEwsDQotCQkJCU5VTEwp
Ow0KKwkJCWlmIChyZXQpDQorCQkJCXJldHVybiByZXQ7DQogDQotCQlpZiAobG9fYmFzZV9hZGRy
ID09IDApDQotCQkJcmV0dXJuIC1FSU5WQUw7DQorCQkJbG9fdmFsID0gUlJFRzMyX1BDSUUobG9f
YmFzZV9hZGRyKTsNCiANCi0JCWxvX3ZhbCA9IFJSRUczMl9QQ0lFKGxvX2Jhc2VfYWRkcik7DQor
CQkJRFJNX0RFQlVHX0RSSVZFUigiY29uZmlnPSVsbHggYWRkcj0lMDh4OiUwOHggdmFsPSUwOHgi
LA0KKwkJCQljb25maWcsIGxvX2Jhc2VfYWRkciwgaGlfYmFzZV9hZGRyLCBsb192YWwpOw0KIA0K
LQkJV1JFRzMyX1BDSUUobG9fYmFzZV9hZGRyLCBsb192YWwgfCAoMVVMTCA8PCAyMikpOw0KKwkJ
CVdSRUczMl9QQ0lFKGxvX2Jhc2VfYWRkciwgbG9fdmFsIHwgKDFVTEwgPDwgMjIpKTsNCisJCX0N
CiANCi0JCXJldCA9IDA7DQorCQlicmVhazsNCisJZGVmYXVsdDoNCisJCWJyZWFrOw0KIAl9DQog
DQogCXJldHVybiByZXQ7DQotDQogfQ0KIA0KLS8qDQotICogc3RhcnQgeGdtaSBsaW5rIGNvdW50
ZXJzDQotICoNCi0gKiBAYWRldiAtPiBhbWRncHUgZGV2aWNlDQotICogQGluc3RhbmNlLT4gY3Vy
cmVudGx5IGNha2UgaGFzIDIgbGlua3MgdG8gcG9sbCBvbiB2ZWdhMjANCi0gKiBAaXNfZW5hYmxl
IC0+IGVpdGhlciBwYXVzZSBvciB1bmFzc2lnbiBldmVudCB2aWEgZGYgcGVyZm1vbg0KLSAqDQot
ICovDQotDQotc3RhdGljIGludCBkZl92M182X3N0b3BfeGdtaV9saW5rX2NudHIoc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYsDQotCQkJCSAgICAgICBpbnQgaW5zdGFuY2UsDQotCQkJCSAgICAg
ICBpbnQgaXNfZGlzYWJsZSkNCitzdGF0aWMgaW50IGRmX3YzXzZfcG1jX3N0b3Aoc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYsIHVpbnQ2NF90IGNvbmZpZywNCisJCQkgICAgaW50IGlzX2Rpc2Fi
bGUpDQogew0KLQ0KIAl1aW50MzJfdCBsb19iYXNlX2FkZHIsIGhpX2Jhc2VfYWRkciwgbG9fdmFs
Ow0KLQl1aW50NjRfdCBjb25maWc7DQotDQotCWNvbmZpZyA9IEdFVF9JTlNUQU5DRV9DT05GSUco
aW5zdGFuY2UpOw0KLQ0KLQlpZiAoaXNfZGlzYWJsZSkgew0KLQkJZGZfdjNfNl9yZXNldF94Z21p
X2xpbmtfY250cihhZGV2LCBpbnN0YW5jZSk7DQotCQlkZl92M182X3BtY19yZWxlYXNlX2NudHIo
YWRldiwgY29uZmlnKTsNCi0JfSBlbHNlIHsNCi0NCi0JCWRmX3YzXzZfcG1jX2dldF9jdHJsX3Nl
dHRpbmdzKGFkZXYsDQotCQkJCWNvbmZpZywNCi0JCQkJJmxvX2Jhc2VfYWRkciwNCi0JCQkJJmhp
X2Jhc2VfYWRkciwNCi0JCQkJTlVMTCwNCi0JCQkJTlVMTCk7DQotDQotCQlpZiAoKGxvX2Jhc2Vf
YWRkciA9PSAwKSB8fCAoaGlfYmFzZV9hZGRyID09IDApKQ0KLQkJCXJldHVybiAtRUlOVkFMOw0K
LQ0KLQkJbG9fdmFsID0gUlJFRzMyX1BDSUUobG9fYmFzZV9hZGRyKTsNCi0NCi0JCVdSRUczMl9Q
Q0lFKGxvX2Jhc2VfYWRkciwgbG9fdmFsICYgfigxVUxMIDw8IDIyKSk7DQotCX0NCi0NCi0JcmV0
dXJuIDA7DQotfQ0KLQ0KLXN0YXRpYyBpbnQgZGZfdjNfNl9wbWNfc3RhcnQoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsIHVpbnQ2NF90IGNvbmZpZywNCi0JCQkgICAgIGludCBpc19lbmFibGUp
DQotew0KLQlpbnQgeGdtaV90eF9saW5rLCByZXQgPSAwOw0KKwlpbnQgcmV0ID0gMDsNCiANCiAJ
c3dpdGNoIChhZGV2LT5hc2ljX3R5cGUpIHsNCiAJY2FzZSBDSElQX1ZFR0EyMDoNCi0JCXhnbWlf
dHhfbGluayA9IElTX0RGX1hHTUlfMF9UWChjb25maWcpID8gMA0KLQkJCQkJOiAoSVNfREZfWEdN
SV8xX1RYKGNvbmZpZykgPyAxIDogLTEpOw0KLQ0KLQkJaWYgKHhnbWlfdHhfbGluayA+PSAwKQ0K
LQkJCXJldCA9IGRmX3YzXzZfc3RhcnRfeGdtaV9saW5rX2NudHIoYWRldiwgeGdtaV90eF9saW5r
LA0KLQkJCQkJCSAgICAgIGlzX2VuYWJsZSk7DQorCQlyZXQgPSBkZl92M182X3BtY19nZXRfY3Ry
bF9zZXR0aW5ncyhhZGV2LA0KKwkJCWNvbmZpZywNCisJCQkmbG9fYmFzZV9hZGRyLA0KKwkJCSZo
aV9iYXNlX2FkZHIsDQorCQkJTlVMTCwNCisJCQlOVUxMKTsNCiANCiAJCWlmIChyZXQpDQogCQkJ
cmV0dXJuIHJldDsNCiANCi0JCXJldCA9IDA7DQotCQlicmVhazsNCi0JZGVmYXVsdDoNCi0JCWJy
ZWFrOw0KLQl9DQorCQlsb192YWwgPSBSUkVHMzJfUENJRShsb19iYXNlX2FkZHIpOw0KIA0KLQly
ZXR1cm4gcmV0Ow0KLX0NCisJCURSTV9ERUJVR19EUklWRVIoImNvbmZpZz0lbGx4IGFkZHI9JTA4
eDolMDh4IHZhbD0lMDh4IiwNCisJCQkJY29uZmlnLCBsb19iYXNlX2FkZHIsIGhpX2Jhc2VfYWRk
ciwgbG9fdmFsKTsNCiANCi1zdGF0aWMgaW50IGRmX3YzXzZfcG1jX3N0b3Aoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsIHVpbnQ2NF90IGNvbmZpZywNCi0JCQkgICAgaW50IGlzX2Rpc2FibGUp
DQotew0KLQlpbnQgeGdtaV90eF9saW5rLCByZXQgPSAwOw0KKwkJV1JFRzMyX1BDSUUobG9fYmFz
ZV9hZGRyLCBsb192YWwgJiB+KDFVTEwgPDwgMjIpKTsNCiANCi0Jc3dpdGNoIChhZGV2LT5hc2lj
X3R5cGUpIHsNCi0JY2FzZSBDSElQX1ZFR0EyMDoNCi0JCQl4Z21pX3R4X2xpbmsgPSBJU19ERl9Y
R01JXzBfVFgoY29uZmlnKSA/IDANCi0JCQkJOiAoSVNfREZfWEdNSV8xX1RYKGNvbmZpZykgPyAx
IDogLTEpOw0KLQ0KLQkJCWlmICh4Z21pX3R4X2xpbmsgPj0gMCkgew0KLQkJCQlyZXQgPSBkZl92
M182X3N0b3BfeGdtaV9saW5rX2NudHIoYWRldiwNCi0JCQkJCQkJCSAgeGdtaV90eF9saW5rLA0K
LQkJCQkJCQkJICBpc19kaXNhYmxlKTsNCi0JCQkJaWYgKHJldCkNCi0JCQkJCXJldHVybiByZXQ7
DQotCQkJfQ0KLQ0KLQkJCXJldCA9IDA7DQotCQkJYnJlYWs7DQorCQlpZiAoaXNfZGlzYWJsZSkN
CisJCQlkZl92M182X3BtY19yZWxlYXNlX2NudHIoYWRldiwgY29uZmlnKTsNCisNCisJCWJyZWFr
Ow0KIAlkZWZhdWx0Og0KIAkJYnJlYWs7DQogCX0NCkBAIC01MTAsMjQgKzQ1OSwzNCBAQCBzdGF0
aWMgdm9pZCBkZl92M182X3BtY19nZXRfY291bnQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
DQogCQkJCSAgdWludDY0X3QgY29uZmlnLA0KIAkJCQkgIHVpbnQ2NF90ICpjb3VudCkNCiB7DQot
DQotCWludCB4Z21pX3R4X2xpbms7DQorCXVpbnQzMl90IGxvX2Jhc2VfYWRkciwgaGlfYmFzZV9h
ZGRyLCBsb192YWwsIGhpX3ZhbDsNCisJKmNvdW50ID0gMDsNCiANCiAJc3dpdGNoIChhZGV2LT5h
c2ljX3R5cGUpIHsNCiAJY2FzZSBDSElQX1ZFR0EyMDoNCi0JCXhnbWlfdHhfbGluayA9IElTX0RG
X1hHTUlfMF9UWChjb25maWcpID8gMA0KLQkJCQkJOiAoSVNfREZfWEdNSV8xX1RYKGNvbmZpZykg
PyAxIDogLTEpOw0KIA0KLQkJaWYgKHhnbWlfdHhfbGluayA+PSAwKSB7DQotCQkJZGZfdjNfNl9y
ZXNldF94Z21pX2xpbmtfY250cihhZGV2LCB4Z21pX3R4X2xpbmspOw0KLQkJCWRmX3YzXzZfZ2V0
X3hnbWlfbGlua19jbnRyKGFkZXYsIHhnbWlfdHhfbGluaywgY291bnQpOw0KLQkJfQ0KKwkJZGZf
djNfNl9wbWNfZ2V0X3JlYWRfc2V0dGluZ3MoYWRldiwgY29uZmlnLCAmbG9fYmFzZV9hZGRyLA0K
KwkJCQkgICAgICAmaGlfYmFzZV9hZGRyKTsNCisNCisJCWlmICgobG9fYmFzZV9hZGRyID09IDAp
IHx8IChoaV9iYXNlX2FkZHIgPT0gMCkpDQorCQkJcmV0dXJuOw0KKw0KKwkJbG9fdmFsID0gUlJF
RzMyX1BDSUUobG9fYmFzZV9hZGRyKTsNCisJCWhpX3ZhbCA9IFJSRUczMl9QQ0lFKGhpX2Jhc2Vf
YWRkcik7DQorDQorCQkqY291bnQgID0gKChoaV92YWwgfCAwVUxMKSA8PCAzMikgfCAobG9fdmFs
IHwgMFVMTCk7DQorDQorCQlpZiAoKmNvdW50ID49IERGX1YzXzZfUEVSRk1PTl9PVkVSRkxPVykN
CisJCQkqY291bnQgPSAwOw0KKw0KKwkJRFJNX0RFQlVHX0RSSVZFUigiY29uZmlnPSVsbHggYWRk
cj0lMDh4OiUwOHggdmFsPSUwOHg6JTA4eCIsDQorCQkJY29uZmlnLCBsb19iYXNlX2FkZHIsIGhp
X2Jhc2VfYWRkciwgbG9fdmFsLCBoaV92YWwpOw0KIA0KIAkJYnJlYWs7DQorDQogCWRlZmF1bHQ6
DQogCQlicmVhazsNCiAJfQ0KLQ0KIH0NCiANCiBjb25zdCBzdHJ1Y3QgYW1kZ3B1X2RmX2Z1bmNz
IGRmX3YzXzZfZnVuY3MgPSB7DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvZGZfdjNfNi5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZGZfdjNfNi5oDQppbmRl
eCBmY2ZmZDgwNzc2NGQuLjc2OTk4NTQxYmMzMCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2RmX3YzXzYuaA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
ZGZfdjNfNi5oDQpAQCAtMzYsMjIgKzM2LDE1IEBAIGVudW0gREZfVjNfNl9NR0NHIHsNCiB9Ow0K
IA0KIC8qIERlZmluZWQgaW4gZ2xvYmFsX2ZlYXR1cmVzLmggYXMgRlRJX1BFUkZNT05fVklTSUJM
RSAqLw0KLSNkZWZpbmUgQU1ER1BVX0RGX01BWF9DT1VOVEVSUwkJNA0KKyNkZWZpbmUgREZfVjNf
Nl9NQVhfQ09VTlRFUlMJCTQNCiANCiAvKiBnZXQgZmxhZ3MgZnJvbSBkZiBwZXJmbW9uIGNvbmZp
ZyAqLw0KLSNkZWZpbmUgR0VUX0VWRU5UKHgpCQkJKHggJiAweEZGVUwpDQotI2RlZmluZSBHRVRf
SU5TVEFOQ0UoeCkJCQkoKHggPj4gOCkgJiAweEZGVUwpDQotI2RlZmluZSBHRVRfVU5JVE1BU0so
eCkJCQkoKHggPj4gMTYpICYgMHhGRlVMKQ0KLSNkZWZpbmUgR0VUX0lOU1RBTkNFX0NPTkZJRyh4
KQkJKDBVTEwgfCAoMHgwN1VMTCkgXA0KLQkJCQkJfCAoKDB4MDQ2VUxMICsgeCkgPDwgOCkgXA0K
LQkJCQkJfCAoMHgwMiA8PCAxNikpDQotDQotLyogZGYgZXZlbnQgY29uZiBtYWNyb3MgKi8NCi0j
ZGVmaW5lIElTX0RGX1hHTUlfMF9UWCh4KSAoR0VUX0VWRU5UKHgpID09IDB4NyBcDQotCQkmJiBH
RVRfSU5TVEFOQ0UoeCkgPT0gMHg0NiAmJiBHRVRfVU5JVE1BU0soeCkgPT0gMHgyKQ0KLSNkZWZp
bmUgSVNfREZfWEdNSV8xX1RYKHgpIChHRVRfRVZFTlQoeCkgPT0gMHg3IFwNCi0JCSYmIEdFVF9J
TlNUQU5DRSh4KSA9PSAweDQ3ICYmIEdFVF9VTklUTUFTSyh4KSA9PSAweDIpDQorI2RlZmluZSBE
Rl9WM182X0dFVF9FVkVOVCh4KQkJKHggJiAweEZGVUwpDQorI2RlZmluZSBERl9WM182X0dFVF9J
TlNUQU5DRSh4KQkJKCh4ID4+IDgpICYgMHhGRlVMKQ0KKyNkZWZpbmUgREZfVjNfNl9HRVRfVU5J
VE1BU0soeCkJCSgoeCA+PiAxNikgJiAweEZGVUwpDQorI2RlZmluZSBERl9WM182X1BFUkZNT05f
T1ZFUkZMT1cJMHhGRkZGRkZGRkZGRkZVTEwNCiANCitleHRlcm4gY29uc3Qgc3RydWN0IGF0dHJp
YnV0ZV9ncm91cCAqZGZfdjNfNl9hdHRyX2dyb3Vwc1tdOw0KIGV4dGVybiBjb25zdCBzdHJ1Y3Qg
YW1kZ3B1X2RmX2Z1bmNzIGRmX3YzXzZfZnVuY3M7DQogDQogI2VuZGlmDQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc29jMTUuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L3NvYzE1LmMNCmluZGV4IDc4YmQ0ZmMwN2JhYi4uN2ZlZTI0ZWE3ODYzIDEwMDY0NA0K
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc29jMTUuYw0KKysrIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvc29jMTUuYw0KQEAgLTEwNjYsNiArMTA2Niw3IEBAIHN0YXRpYyB2
b2lkIHNvYzE1X2Rvb3JiZWxsX3JhbmdlX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYp
DQogc3RhdGljIGludCBzb2MxNV9jb21tb25faHdfaW5pdCh2b2lkICpoYW5kbGUpDQogew0KIAlz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhhbmRs
ZTsNCisJaW50IHJldDsNCiANCiAJLyogZW5hYmxlIHBjaWUgZ2VuMi8zIGxpbmsgKi8NCiAJc29j
MTVfcGNpZV9nZW4zX2VuYWJsZShhZGV2KTsNCkBAIC0xMDc5LDYgKzEwODAsOSBAQCBzdGF0aWMg
aW50IHNvYzE1X2NvbW1vbl9od19pbml0KHZvaWQgKmhhbmRsZSkNCiAJICovDQogCWlmIChhZGV2
LT5uYmlvX2Z1bmNzLT5yZW1hcF9oZHBfcmVnaXN0ZXJzKQ0KIAkJYWRldi0+bmJpb19mdW5jcy0+
cmVtYXBfaGRwX3JlZ2lzdGVycyhhZGV2KTsNCisNCisJYWRldi0+ZGZfZnVuY3MtPmluaXQoYWRl
dik7DQorDQogCS8qIGVuYWJsZSB0aGUgZG9vcmJlbGwgYXBlcnR1cmUgKi8NCiAJc29jMTVfZW5h
YmxlX2Rvb3JiZWxsX2FwZXJ0dXJlKGFkZXYsIHRydWUpOw0KIAkvKiBIVyBkb29yYmVsbCByb3V0
aW5nIHBvbGljeTogZG9vcmJlbGwgd3JpdGluZyBub3QNCi0tIA0KMi4xNy4xDQoNCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBs
aXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
