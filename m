Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 34C3B16C1B2
	for <lists+amd-gfx@lfdr.de>; Tue, 25 Feb 2020 14:07:42 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id ACCCD6E8E1;
	Tue, 25 Feb 2020 13:07:40 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wr1-x443.google.com (mail-wr1-x443.google.com
 [IPv6:2a00:1450:4864:20::443])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 853E96E8E1
 for <amd-gfx@lists.freedesktop.org>; Tue, 25 Feb 2020 13:07:39 +0000 (UTC)
Received: by mail-wr1-x443.google.com with SMTP id m16so14620721wrx.11
 for <amd-gfx@lists.freedesktop.org>; Tue, 25 Feb 2020 05:07:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=xX2AvMZoGx83s2n7Nk+VV3IAeSOYoer6dYe7ungh9yg=;
 b=oi1B1vP3UAkwCA9hRDQ4DeOFj8+P+pCk2TTiq9LRGvH5oOkZxU5KZa45WrE/iF61KC
 JupssdRSDC1a8lTYpSrIOPvZ+QaYq5wfsvYy1uQ6XpIpgM67QmgFQoaWrfTro5Wz1gTd
 EiZCCv23bs1zI8cfcxVbmWWv5LSBOdcJQFPWPt0yYCv0kVLm+WadRJaoADoKCux63Op8
 4pLwhmTQ2wACwjwPW9AQe1IQnWvWomjRR7ylmuEIpCUJiVuyvJGhGI4yeCmFGoGDk0/2
 UwhwcwP8JQltmY+7NIjMhG7NqUKnTNphMdMVoXLfg9aNJN9FPAwp0aDqShFgtDEDt8jq
 uS6g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=xX2AvMZoGx83s2n7Nk+VV3IAeSOYoer6dYe7ungh9yg=;
 b=b09SnoJzn+4mcabDYUlEX5R4gy7gJdZGzYZlU5Nj5CABTb8xekyn7PS6UIaDihRLwh
 51PufAo0s4ZuNZbfoAt/PXcDHwWHSJB8XDj6pcP9uJy+hI7oULoQ9PDWccU/pcxtaayK
 yhZXb1219y9BjMM2+Fq4hmrwFJOcVQjblKM1E9u+DBijKSs5hZ8kzsGabegV3j73g83s
 9W5WhmtRJ9M+1t5uj/iY6plECFWZr0Da6+uyz9b4nLJIeOCkTFP/YuN4F0NwTjrxTCnM
 dx42czR1wJaDdfsgTPhqZp10ZcZInKWe6ZJEHprQCzNpJPF3Z23tzo8pSHCldFHoFQWD
 XGrA==
X-Gm-Message-State: APjAAAXEyKYn3id1jETcp0vVOB0EG1WaM1fZe0H34zoFCElxf2v8qqs1
 03ksvGhVV4m62FQXTT6adnM=
X-Google-Smtp-Source: APXvYqwiVmrlt32z9wVpFK5hTwmmJNf5dqEUj01oU3r0SBpmOgnc57RVQsTwzT1UXedjjnd4d46Ugg==
X-Received: by 2002:a5d:514b:: with SMTP id u11mr72535176wrt.322.1582636057875; 
 Tue, 25 Feb 2020 05:07:37 -0800 (PST)
Received: from abel.fritz.box ([2a02:908:1252:fb60:d47c:58ac:99e0:bc39])
 by smtp.gmail.com with ESMTPSA id h71sm4444013wme.26.2020.02.25.05.07.36
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 25 Feb 2020 05:07:37 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: nirmoy.aiemd@gmail.com,
	amd-gfx@lists.freedesktop.org
Subject: [PATCH] drm/amdgpu: stop disable the scheduler during HW fini
Date: Tue, 25 Feb 2020 14:07:36 +0100
Message-Id: <20200225130736.2929-1-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
MIME-Version: 1.0
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

V2hlbiB3ZSBzdG9wIHRoZSBIVyBmb3IgZXhhbXBsZSBmb3IgR1BVIHJlc2V0IHdlIHNob3VsZCBu
b3Qgc3RvcCB0aGUKZnJvbnQtZW5kIHNjaGVkdWxlci4gT3RoZXJ3aXNlIHdlIHJ1biBpbnRvIGlu
dGVybWVkaWF0ZSBmYWlsdXJlcyBkdXJpbmcKY29tbWFuZCBzdWJtaXNzaW9uLgoKVGhlIHNjaGVk
dWxlciBzaG91bGQgb25seSBiZSBzdG9wcGVkIGluIHZlcnkgZmV3IGNhc2VzOgoxLiBXZSBjYW4n
dCBnZXQgdGhlIGhhcmR3YXJlIHdvcmtpbmcgaW4gcmluZyBvciBJQiB0ZXN0IGFmdGVyIGEgR1BV
IHJlc2V0LgoyLiBUaGUgS0lRIHNjaGVkdWxlciBpcyBub3QgdXNlZCBpbiB0aGUgZnJvbnQtZW5k
IGFuZCBzaG91bGQgYmUgZGlzYWJsZWQgZHVyaW5nIEdQVSByZXNldC4KMy4gSW4gYW1kZ3B1X3Jp
bmdfZmluaSgpIHdoZW4gdGhlIGRyaXZlciB1bmxvYWRzLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXN0
aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2Npa19zZG1hLmMgIHwgIDIgLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2dmeF92MTBfMC5jIHwgIDggLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2dmeF92Nl8wLmMgIHwgIDUgLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92
N18wLmMgIHwgMjUgKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvZ2Z4X3Y4XzAuYyAgfCAgNyAtLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nZnhfdjlfMC5jICB8ICA5IC0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvanBlZ192Ml8wLmMgfCAgMyAtLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3NkbWFf
djJfNC5jIHwgIDIgLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3NkbWFfdjNfMC5jIHwg
IDIgLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3NkbWFfdjRfMC5jIHwgIDQgLS0tLQog
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc2RtYV92NV8wLmMgfCAgMyAtLS0KIGRyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L3NpX2RtYS5jICAgIHwgIDEgLQogZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvdXZkX3Y0XzIuYyAgfCAgMyAtLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L3V2ZF92NV8wLmMgIHwgIDMgLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS91dmRfdjZf
MC5jICB8ICAzIC0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvdXZkX3Y3XzAuYyAgfCAg
NyAtLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS92Y2VfdjRfMC5jICB8ICA0IC0t
LS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3Zjbl92MV8wLmMgIHwgIDMgLS0tCiBkcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS92Y25fdjJfMC5jICB8ICA5IC0tLS0tLS0tLQogZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvdmNuX3YyXzUuYyAgfCAxMSArLS0tLS0tLS0tLQogMjAgZmls
ZXMgY2hhbmdlZCwgMTAgaW5zZXJ0aW9ucygrKSwgMTA0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Npa19zZG1hLmMgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9jaWtfc2RtYS5jCmluZGV4IDQyNzRjY2Y3NjVkZS4uY2IzYjNhMGExMzQ4
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9jaWtfc2RtYS5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Npa19zZG1hLmMKQEAgLTMyMCw4ICszMjAsNiBA
QCBzdGF0aWMgdm9pZCBjaWtfc2RtYV9nZnhfc3RvcChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
dikKIAkJV1JFRzMyKG1tU0RNQTBfR0ZYX1JCX0NOVEwgKyBzZG1hX29mZnNldHNbaV0sIHJiX2Nu
dGwpOwogCQlXUkVHMzIobW1TRE1BMF9HRlhfSUJfQ05UTCArIHNkbWFfb2Zmc2V0c1tpXSwgMCk7
CiAJfQotCXNkbWEwLT5zY2hlZC5yZWFkeSA9IGZhbHNlOwotCXNkbWExLT5zY2hlZC5yZWFkeSA9
IGZhbHNlOwogfQogCiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2dmeF92MTBfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3YxMF8wLmMKaW5k
ZXggN2I2MTU4MzIwNDAwLi4zNmNlNjdjZTQ4MDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2dmeF92MTBfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2dmeF92MTBfMC5jCkBAIC0yMzkxLDEwICsyMzkxLDYgQEAgc3RhdGljIGludCBnZnhfdjEwXzBf
Y3BfZ2Z4X2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCBlbmFibGUpCiAJ
dG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIENQX01FX0NOVEwsIE1FX0hBTFQsIGVuYWJsZSA/IDAg
OiAxKTsKIAl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgQ1BfTUVfQ05UTCwgUEZQX0hBTFQsIGVu
YWJsZSA/IDAgOiAxKTsKIAl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgQ1BfTUVfQ05UTCwgQ0Vf
SEFMVCwgZW5hYmxlID8gMCA6IDEpOwotCWlmICghZW5hYmxlKSB7Ci0JCWZvciAoaSA9IDA7IGkg
PCBhZGV2LT5nZngubnVtX2dmeF9yaW5nczsgaSsrKQotCQkJYWRldi0+Z2Z4LmdmeF9yaW5nW2ld
LnNjaGVkLnJlYWR5ID0gZmFsc2U7Ci0JfQogCVdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9NRV9D
TlRMLCB0bXApOwogCiAJZm9yIChpID0gMDsgaSA8IGFkZXYtPnVzZWNfdGltZW91dDsgaSsrKSB7
CkBAIC0yODY5LDE2ICsyODY1LDEyIEBAIHN0YXRpYyBpbnQgZ2Z4X3YxMF8wX2NwX2dmeF9yZXN1
bWUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiAKIHN0YXRpYyB2b2lkIGdmeF92MTBfMF9j
cF9jb21wdXRlX2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCBlbmFibGUp
CiB7Ci0JaW50IGk7Ci0KIAlpZiAoZW5hYmxlKSB7CiAJCVdSRUczMl9TT0MxNShHQywgMCwgbW1D
UF9NRUNfQ05UTCwgMCk7CiAJfSBlbHNlIHsKIAkJV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX01F
Q19DTlRMLAogCQkJICAgICAoQ1BfTUVDX0NOVExfX01FQ19NRTFfSEFMVF9NQVNLIHwKIAkJCSAg
ICAgIENQX01FQ19DTlRMX19NRUNfTUUyX0hBTFRfTUFTSykpOwotCQlmb3IgKGkgPSAwOyBpIDwg
YWRldi0+Z2Z4Lm51bV9jb21wdXRlX3JpbmdzOyBpKyspCi0JCQlhZGV2LT5nZnguY29tcHV0ZV9y
aW5nW2ldLnNjaGVkLnJlYWR5ID0gZmFsc2U7CiAJCWFkZXYtPmdmeC5raXEucmluZy5zY2hlZC5y
ZWFkeSA9IGZhbHNlOwogCX0KIAl1ZGVsYXkoNTApOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvZ2Z4X3Y2XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dm
eF92Nl8wLmMKaW5kZXggMzFmNDRkMDVlNjA2Li5lNDYyYTA5OWRiZGEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92Nl8wLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvZ2Z4X3Y2XzAuYwpAQCAtMTk1MCw3ICsxOTUwLDYgQEAgc3RhdGljIGludCBn
ZnhfdjZfMF9yaW5nX3Rlc3RfaWIoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nLCBsb25nIHRpbWVv
dXQpCiAKIHN0YXRpYyB2b2lkIGdmeF92Nl8wX2NwX2dmeF9lbmFibGUoc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYsIGJvb2wgZW5hYmxlKQogewotCWludCBpOwogCWlmIChlbmFibGUpIHsKIAkJ
V1JFRzMyKG1tQ1BfTUVfQ05UTCwgMCk7CiAJfSBlbHNlIHsKQEAgLTE5NTgsMTAgKzE5NTcsNiBA
QCBzdGF0aWMgdm9pZCBnZnhfdjZfMF9jcF9nZnhfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNl
ICphZGV2LCBib29sIGVuYWJsZSkKIAkJCQkgICAgICBDUF9NRV9DTlRMX19QRlBfSEFMVF9NQVNL
IHwKIAkJCQkgICAgICBDUF9NRV9DTlRMX19DRV9IQUxUX01BU0spKTsKIAkJV1JFRzMyKG1tU0NS
QVRDSF9VTVNLLCAwKTsKLQkJZm9yIChpID0gMDsgaSA8IGFkZXYtPmdmeC5udW1fZ2Z4X3Jpbmdz
OyBpKyspCi0JCQlhZGV2LT5nZnguZ2Z4X3JpbmdbaV0uc2NoZWQucmVhZHkgPSBmYWxzZTsKLQkJ
Zm9yIChpID0gMDsgaSA8IGFkZXYtPmdmeC5udW1fY29tcHV0ZV9yaW5nczsgaSsrKQotCQkJYWRl
di0+Z2Z4LmNvbXB1dGVfcmluZ1tpXS5zY2hlZC5yZWFkeSA9IGZhbHNlOwogCX0KIAl1ZGVsYXko
NTApOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y3XzAu
YyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92N18wLmMKaW5kZXggOGYyMGE1ZGQ0
NGZlLi45YmM4NjczYzgzYWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2dmeF92N18wLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y3XzAuYwpA
QCAtMjQzMSwxNSArMjQzMSwxMiBAQCBzdGF0aWMgaW50IGdmeF92N18wX3JpbmdfdGVzdF9pYihz
dHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsIGxvbmcgdGltZW91dCkKICAqLwogc3RhdGljIHZvaWQg
Z2Z4X3Y3XzBfY3BfZ2Z4X2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCBl
bmFibGUpCiB7Ci0JaW50IGk7Ci0KLQlpZiAoZW5hYmxlKSB7CisJaWYgKGVuYWJsZSkKIAkJV1JF
RzMyKG1tQ1BfTUVfQ05UTCwgMCk7Ci0JfSBlbHNlIHsKLQkJV1JFRzMyKG1tQ1BfTUVfQ05UTCwg
KENQX01FX0NOVExfX01FX0hBTFRfTUFTSyB8IENQX01FX0NOVExfX1BGUF9IQUxUX01BU0sgfCBD
UF9NRV9DTlRMX19DRV9IQUxUX01BU0spKTsKLQkJZm9yIChpID0gMDsgaSA8IGFkZXYtPmdmeC5u
dW1fZ2Z4X3JpbmdzOyBpKyspCi0JCQlhZGV2LT5nZnguZ2Z4X3JpbmdbaV0uc2NoZWQucmVhZHkg
PSBmYWxzZTsKLQl9CisJZWxzZQorCQlXUkVHMzIobW1DUF9NRV9DTlRMLCAoQ1BfTUVfQ05UTF9f
TUVfSEFMVF9NQVNLIHwKKwkJCQkgICAgICBDUF9NRV9DTlRMX19QRlBfSEFMVF9NQVNLIHwKKwkJ
CQkgICAgICBDUF9NRV9DTlRMX19DRV9IQUxUX01BU0spKTsKIAl1ZGVsYXkoNTApOwogfQogCkBA
IC0yNzAwLDE1ICsyNjk3LDExIEBAIHN0YXRpYyB2b2lkIGdmeF92N18wX3Jpbmdfc2V0X3dwdHJf
Y29tcHV0ZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpCiAgKi8KIHN0YXRpYyB2b2lkIGdmeF92
N18wX2NwX2NvbXB1dGVfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBib29sIGVu
YWJsZSkKIHsKLQlpbnQgaTsKLQotCWlmIChlbmFibGUpIHsKKwlpZiAoZW5hYmxlKQogCQlXUkVH
MzIobW1DUF9NRUNfQ05UTCwgMCk7Ci0JfSBlbHNlIHsKLQkJV1JFRzMyKG1tQ1BfTUVDX0NOVEws
IChDUF9NRUNfQ05UTF9fTUVDX01FMV9IQUxUX01BU0sgfCBDUF9NRUNfQ05UTF9fTUVDX01FMl9I
QUxUX01BU0spKTsKLQkJZm9yIChpID0gMDsgaSA8IGFkZXYtPmdmeC5udW1fY29tcHV0ZV9yaW5n
czsgaSsrKQotCQkJYWRldi0+Z2Z4LmNvbXB1dGVfcmluZ1tpXS5zY2hlZC5yZWFkeSA9IGZhbHNl
OwotCX0KKwllbHNlCisJCVdSRUczMihtbUNQX01FQ19DTlRMLCAoQ1BfTUVDX0NOVExfX01FQ19N
RTFfSEFMVF9NQVNLIHwKKwkJCQkgICAgICAgQ1BfTUVDX0NOVExfX01FQ19NRTJfSEFMVF9NQVNL
KSk7CiAJdWRlbGF5KDUwKTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvZ2Z4X3Y4XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OF8wLmMK
aW5kZXggZmEyNDU5NzNkZTEyLi43YjZiMDNjMDI3NTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2dmeF92OF8wLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvZ2Z4X3Y4XzAuYwpAQCAtNDExMSw3ICs0MTExLDYgQEAgc3RhdGljIGludCBnZnhfdjhfMF9y
bGNfcmVzdW1lKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogCiBzdGF0aWMgdm9pZCBnZnhf
djhfMF9jcF9nZnhfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBib29sIGVuYWJs
ZSkKIHsKLQlpbnQgaTsKIAl1MzIgdG1wID0gUlJFRzMyKG1tQ1BfTUVfQ05UTCk7CiAKIAlpZiAo
ZW5hYmxlKSB7CkBAIC00MTIyLDggKzQxMjEsNiBAQCBzdGF0aWMgdm9pZCBnZnhfdjhfMF9jcF9n
ZnhfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBib29sIGVuYWJsZSkKIAkJdG1w
ID0gUkVHX1NFVF9GSUVMRCh0bXAsIENQX01FX0NOVEwsIE1FX0hBTFQsIDEpOwogCQl0bXAgPSBS
RUdfU0VUX0ZJRUxEKHRtcCwgQ1BfTUVfQ05UTCwgUEZQX0hBTFQsIDEpOwogCQl0bXAgPSBSRUdf
U0VUX0ZJRUxEKHRtcCwgQ1BfTUVfQ05UTCwgQ0VfSEFMVCwgMSk7Ci0JCWZvciAoaSA9IDA7IGkg
PCBhZGV2LT5nZngubnVtX2dmeF9yaW5nczsgaSsrKQotCQkJYWRldi0+Z2Z4LmdmeF9yaW5nW2ld
LnNjaGVkLnJlYWR5ID0gZmFsc2U7CiAJfQogCVdSRUczMihtbUNQX01FX0NOVEwsIHRtcCk7CiAJ
dWRlbGF5KDUwKTsKQEAgLTQzMTEsMTQgKzQzMDgsMTAgQEAgc3RhdGljIGludCBnZnhfdjhfMF9j
cF9nZnhfcmVzdW1lKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogCiBzdGF0aWMgdm9pZCBn
ZnhfdjhfMF9jcF9jb21wdXRlX2VuYWJsZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9v
bCBlbmFibGUpCiB7Ci0JaW50IGk7Ci0KIAlpZiAoZW5hYmxlKSB7CiAJCVdSRUczMihtbUNQX01F
Q19DTlRMLCAwKTsKIAl9IGVsc2UgewogCQlXUkVHMzIobW1DUF9NRUNfQ05UTCwgKENQX01FQ19D
TlRMX19NRUNfTUUxX0hBTFRfTUFTSyB8IENQX01FQ19DTlRMX19NRUNfTUUyX0hBTFRfTUFTSykp
OwotCQlmb3IgKGkgPSAwOyBpIDwgYWRldi0+Z2Z4Lm51bV9jb21wdXRlX3JpbmdzOyBpKyspCi0J
CQlhZGV2LT5nZnguY29tcHV0ZV9yaW5nW2ldLnNjaGVkLnJlYWR5ID0gZmFsc2U7CiAJCWFkZXYt
PmdmeC5raXEucmluZy5zY2hlZC5yZWFkeSA9IGZhbHNlOwogCX0KIAl1ZGVsYXkoNTApOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OV8wLmMKaW5kZXggMWM3YTE2YjkxNjg2Li5hMmY5ODgy
YmQ5YjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OV8wLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYwpAQCAtMzAzNCwxNiAr
MzAzNCwxMSBAQCBzdGF0aWMgaW50IGdmeF92OV8wX3JsY19yZXN1bWUoc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYpCiAKIHN0YXRpYyB2b2lkIGdmeF92OV8wX2NwX2dmeF9lbmFibGUoc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYsIGJvb2wgZW5hYmxlKQogewotCWludCBpOwogCXUzMiB0bXAg
PSBSUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfTUVfQ05UTCk7CiAKIAl0bXAgPSBSRUdfU0VUX0ZJ
RUxEKHRtcCwgQ1BfTUVfQ05UTCwgTUVfSEFMVCwgZW5hYmxlID8gMCA6IDEpOwogCXRtcCA9IFJF
R19TRVRfRklFTEQodG1wLCBDUF9NRV9DTlRMLCBQRlBfSEFMVCwgZW5hYmxlID8gMCA6IDEpOwog
CXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBDUF9NRV9DTlRMLCBDRV9IQUxULCBlbmFibGUgPyAw
IDogMSk7Ci0JaWYgKCFlbmFibGUpIHsKLQkJZm9yIChpID0gMDsgaSA8IGFkZXYtPmdmeC5udW1f
Z2Z4X3JpbmdzOyBpKyspCi0JCQlhZGV2LT5nZnguZ2Z4X3JpbmdbaV0uc2NoZWQucmVhZHkgPSBm
YWxzZTsKLQl9CiAJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1DUF9NRV9DTlRMLCB0bXApOwog
CXVkZWxheSg1MCk7CiB9CkBAIC0zMjM5LDE1ICszMjM0LDExIEBAIHN0YXRpYyBpbnQgZ2Z4X3Y5
XzBfY3BfZ2Z4X3Jlc3VtZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAogc3RhdGljIHZv
aWQgZ2Z4X3Y5XzBfY3BfY29tcHV0ZV9lbmFibGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
IGJvb2wgZW5hYmxlKQogewotCWludCBpOwotCiAJaWYgKGVuYWJsZSkgewogCQlXUkVHMzJfU09D
MTVfUkxDKEdDLCAwLCBtbUNQX01FQ19DTlRMLCAwKTsKIAl9IGVsc2UgewogCQlXUkVHMzJfU09D
MTVfUkxDKEdDLCAwLCBtbUNQX01FQ19DTlRMLAogCQkJKENQX01FQ19DTlRMX19NRUNfTUUxX0hB
TFRfTUFTSyB8IENQX01FQ19DTlRMX19NRUNfTUUyX0hBTFRfTUFTSykpOwotCQlmb3IgKGkgPSAw
OyBpIDwgYWRldi0+Z2Z4Lm51bV9jb21wdXRlX3JpbmdzOyBpKyspCi0JCQlhZGV2LT5nZnguY29t
cHV0ZV9yaW5nW2ldLnNjaGVkLnJlYWR5ID0gZmFsc2U7CiAJCWFkZXYtPmdmeC5raXEucmluZy5z
Y2hlZC5yZWFkeSA9IGZhbHNlOwogCX0KIAl1ZGVsYXkoNTApOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvanBlZ192Ml8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9qcGVnX3YyXzAuYwppbmRleCBmZjJlNmUxY2NkZTcuLjQ3MTcxMGE0MmEwYyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvanBlZ192Ml8wLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvanBlZ192Ml8wLmMKQEAgLTE2OSwxNCArMTY5LDExIEBAIHN0
YXRpYyBpbnQganBlZ192Ml8wX2h3X2luaXQodm9pZCAqaGFuZGxlKQogc3RhdGljIGludCBqcGVn
X3YyXzBfaHdfZmluaSh2b2lkICpoYW5kbGUpCiB7CiAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7Ci0Jc3RydWN0IGFtZGdwdV9yaW5n
ICpyaW5nID0gJmFkZXYtPmpwZWcuaW5zdC0+cmluZ19kZWM7CiAKIAlpZiAoYWRldi0+anBlZy5j
dXJfc3RhdGUgIT0gQU1EX1BHX1NUQVRFX0dBVEUgJiYKIAkgICAgICBSUkVHMzJfU09DMTUoSlBF
RywgMCwgbW1VVkRfSlJCQ19TVEFUVVMpKQogCQlqcGVnX3YyXzBfc2V0X3Bvd2VyZ2F0aW5nX3N0
YXRlKGFkZXYsIEFNRF9QR19TVEFURV9HQVRFKTsKIAotCXJpbmctPnNjaGVkLnJlYWR5ID0gZmFs
c2U7Ci0KIAlyZXR1cm4gMDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvc2RtYV92Ml80LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zZG1hX3YyXzQu
YwppbmRleCBmZDdmYTYwODI1NjMuLjA1Yjc5YWNlZDZlOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvc2RtYV92Ml80LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvc2RtYV92Ml80LmMKQEAgLTM1NSw4ICszNTUsNiBAQCBzdGF0aWMgdm9pZCBzZG1hX3Yy
XzRfZ2Z4X3N0b3Aoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiAJCWliX2NudGwgPSBSRUdf
U0VUX0ZJRUxEKGliX2NudGwsIFNETUEwX0dGWF9JQl9DTlRMLCBJQl9FTkFCTEUsIDApOwogCQlX
UkVHMzIobW1TRE1BMF9HRlhfSUJfQ05UTCArIHNkbWFfb2Zmc2V0c1tpXSwgaWJfY250bCk7CiAJ
fQotCXNkbWEwLT5zY2hlZC5yZWFkeSA9IGZhbHNlOwotCXNkbWExLT5zY2hlZC5yZWFkeSA9IGZh
bHNlOwogfQogCiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3Nk
bWFfdjNfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc2RtYV92M18wLmMKaW5kZXgg
NGE4YTdmMGYzYTljLi4xNDQ4ZDliZWI3YTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L3NkbWFfdjNfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3Nk
bWFfdjNfMC5jCkBAIC01MjksOCArNTI5LDYgQEAgc3RhdGljIHZvaWQgc2RtYV92M18wX2dmeF9z
dG9wKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogCQlpYl9jbnRsID0gUkVHX1NFVF9GSUVM
RChpYl9jbnRsLCBTRE1BMF9HRlhfSUJfQ05UTCwgSUJfRU5BQkxFLCAwKTsKIAkJV1JFRzMyKG1t
U0RNQTBfR0ZYX0lCX0NOVEwgKyBzZG1hX29mZnNldHNbaV0sIGliX2NudGwpOwogCX0KLQlzZG1h
MC0+c2NoZWQucmVhZHkgPSBmYWxzZTsKLQlzZG1hMS0+c2NoZWQucmVhZHkgPSBmYWxzZTsKIH0K
IAogLyoqCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zZG1hX3Y0XzAu
YyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3NkbWFfdjRfMC5jCmluZGV4IDdjZWE0NTEz
YzMwMy4uMGM2ZWI2NWY5NmYzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9zZG1hX3Y0XzAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zZG1hX3Y0XzAu
YwpAQCAtOTIzLDggKzkyMyw2IEBAIHN0YXRpYyB2b2lkIHNkbWFfdjRfMF9nZnhfc3RvcChzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAkJaWJfY250bCA9IFJSRUczMl9TRE1BKGksIG1tU0RN
QTBfR0ZYX0lCX0NOVEwpOwogCQlpYl9jbnRsID0gUkVHX1NFVF9GSUVMRChpYl9jbnRsLCBTRE1B
MF9HRlhfSUJfQ05UTCwgSUJfRU5BQkxFLCAwKTsKIAkJV1JFRzMyX1NETUEoaSwgbW1TRE1BMF9H
RlhfSUJfQ05UTCwgaWJfY250bCk7Ci0KLQkJc2RtYVtpXS0+c2NoZWQucmVhZHkgPSBmYWxzZTsK
IAl9CiB9CiAKQEAgLTk3MSw4ICs5NjksNiBAQCBzdGF0aWMgdm9pZCBzZG1hX3Y0XzBfcGFnZV9z
dG9wKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogCQlpYl9jbnRsID0gUkVHX1NFVF9GSUVM
RChpYl9jbnRsLCBTRE1BMF9QQUdFX0lCX0NOVEwsCiAJCQkJCUlCX0VOQUJMRSwgMCk7CiAJCVdS
RUczMl9TRE1BKGksIG1tU0RNQTBfUEFHRV9JQl9DTlRMLCBpYl9jbnRsKTsKLQotCQlzZG1hW2ld
LT5zY2hlZC5yZWFkeSA9IGZhbHNlOwogCX0KIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvc2RtYV92NV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9z
ZG1hX3Y1XzAuYwppbmRleCA3ZWU2MDNkYjhjNTcuLjVhZjY2YTI0YjBhMiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc2RtYV92NV8wLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvc2RtYV92NV8wLmMKQEAgLTUwMiw5ICs1MDIsNiBAQCBzdGF0aWMgdm9p
ZCBzZG1hX3Y1XzBfZ2Z4X3N0b3Aoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiAJCWliX2Nu
dGwgPSBSRUdfU0VUX0ZJRUxEKGliX2NudGwsIFNETUEwX0dGWF9JQl9DTlRMLCBJQl9FTkFCTEUs
IDApOwogCQlXUkVHMzIoc2RtYV92NV8wX2dldF9yZWdfb2Zmc2V0KGFkZXYsIGksIG1tU0RNQTBf
R0ZYX0lCX0NOVEwpLCBpYl9jbnRsKTsKIAl9Ci0KLQlzZG1hMC0+c2NoZWQucmVhZHkgPSBmYWxz
ZTsKLQlzZG1hMS0+c2NoZWQucmVhZHkgPSBmYWxzZTsKIH0KIAogLyoqCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zaV9kbWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L3NpX2RtYS5jCmluZGV4IDdmNjRkNzMwNDNjZi4uYTg1NDg2NzhjMzdkIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zaV9kbWEuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9zaV9kbWEuYwpAQCAtMTI0LDcgKzEyNCw2IEBAIHN0YXRpYyB2b2lk
IHNpX2RtYV9zdG9wKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogCiAJCWlmIChhZGV2LT5t
bWFuLmJ1ZmZlcl9mdW5jc19yaW5nID09IHJpbmcpCiAJCQlhbWRncHVfdHRtX3NldF9idWZmZXJf
ZnVuY3Nfc3RhdHVzKGFkZXYsIGZhbHNlKTsKLQkJcmluZy0+c2NoZWQucmVhZHkgPSBmYWxzZTsK
IAl9CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3V2ZF92NF8y
LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS91dmRfdjRfMi5jCmluZGV4IDgyYWJkOGU3
MjhhYi4uOTU3ZTE0ZTJjMTU1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS91dmRfdjRfMi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3V2ZF92NF8yLmMK
QEAgLTIxMCwxMyArMjEwLDEwIEBAIHN0YXRpYyBpbnQgdXZkX3Y0XzJfaHdfaW5pdCh2b2lkICpo
YW5kbGUpCiBzdGF0aWMgaW50IHV2ZF92NF8yX2h3X2Zpbmkodm9pZCAqaGFuZGxlKQogewogCXN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gKHN0cnVjdCBhbWRncHVfZGV2aWNlICopaGFuZGxl
OwotCXN0cnVjdCBhbWRncHVfcmluZyAqcmluZyA9ICZhZGV2LT51dmQuaW5zdC0+cmluZzsKIAog
CWlmIChSUkVHMzIobW1VVkRfU1RBVFVTKSAhPSAwKQogCQl1dmRfdjRfMl9zdG9wKGFkZXYpOwog
Ci0JcmluZy0+c2NoZWQucmVhZHkgPSBmYWxzZTsKLQogCXJldHVybiAwOwogfQogCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS91dmRfdjVfMC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvdXZkX3Y1XzAuYwppbmRleCAwZmE4YWFlMmQ3OGUuLjJhYWQ2Njg5ODIz
YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvdXZkX3Y1XzAuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS91dmRfdjVfMC5jCkBAIC0yMDgsMTMgKzIwOCwx
MCBAQCBzdGF0aWMgaW50IHV2ZF92NV8wX2h3X2luaXQodm9pZCAqaGFuZGxlKQogc3RhdGljIGlu
dCB1dmRfdjVfMF9od19maW5pKHZvaWQgKmhhbmRsZSkKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhhbmRsZTsKLQlzdHJ1Y3QgYW1kZ3B1
X3JpbmcgKnJpbmcgPSAmYWRldi0+dXZkLmluc3QtPnJpbmc7CiAKIAlpZiAoUlJFRzMyKG1tVVZE
X1NUQVRVUykgIT0gMCkKIAkJdXZkX3Y1XzBfc3RvcChhZGV2KTsKIAotCXJpbmctPnNjaGVkLnJl
YWR5ID0gZmFsc2U7Ci0KIAlyZXR1cm4gMDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvdXZkX3Y2XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3V2
ZF92Nl8wLmMKaW5kZXggZTBhYWRjYWY2YzhiLi5hOWQwNmVjNWQwOWEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3V2ZF92Nl8wLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvdXZkX3Y2XzAuYwpAQCAtNTM1LDEzICs1MzUsMTAgQEAgc3RhdGljIGludCB1
dmRfdjZfMF9od19pbml0KHZvaWQgKmhhbmRsZSkKIHN0YXRpYyBpbnQgdXZkX3Y2XzBfaHdfZmlu
aSh2b2lkICpoYW5kbGUpCiB7CiAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0
IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7Ci0Jc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nID0gJmFk
ZXYtPnV2ZC5pbnN0LT5yaW5nOwogCiAJaWYgKFJSRUczMihtbVVWRF9TVEFUVVMpICE9IDApCiAJ
CXV2ZF92Nl8wX3N0b3AoYWRldik7CiAKLQlyaW5nLT5zY2hlZC5yZWFkeSA9IGZhbHNlOwotCiAJ
cmV0dXJuIDA7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3V2
ZF92N18wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS91dmRfdjdfMC5jCmluZGV4IDA5
OTUzNzhkODI2My4uYWYzYjFjOWQzMzc3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS91dmRfdjdfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3V2ZF92
N18wLmMKQEAgLTU5OCw3ICs1OTgsNiBAQCBzdGF0aWMgaW50IHV2ZF92N18wX2h3X2luaXQodm9p
ZCAqaGFuZGxlKQogc3RhdGljIGludCB1dmRfdjdfMF9od19maW5pKHZvaWQgKmhhbmRsZSkKIHsK
IAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhh
bmRsZTsKLQlpbnQgaTsKIAogCWlmICghYW1kZ3B1X3NyaW92X3ZmKGFkZXYpKQogCQl1dmRfdjdf
MF9zdG9wKGFkZXYpOwpAQCAtNjA3LDEyICs2MDYsNiBAQCBzdGF0aWMgaW50IHV2ZF92N18wX2h3
X2Zpbmkodm9pZCAqaGFuZGxlKQogCQlEUk1fREVCVUcoIkZvciBTUklPViBjbGllbnQsIHNob3Vs
ZG4ndCBkbyBhbnl0aGluZy5cbiIpOwogCX0KIAotCWZvciAoaSA9IDA7IGkgPCBhZGV2LT51dmQu
bnVtX3V2ZF9pbnN0OyArK2kpIHsKLQkJaWYgKGFkZXYtPnV2ZC5oYXJ2ZXN0X2NvbmZpZyAmICgx
IDw8IGkpKQotCQkJY29udGludWU7Ci0JCWFkZXYtPnV2ZC5pbnN0W2ldLnJpbmcuc2NoZWQucmVh
ZHkgPSBmYWxzZTsKLQl9Ci0KIAlyZXR1cm4gMDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvdmNlX3Y0XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L3ZjZV92NF8wLmMKaW5kZXggM2ZkMTAyZWZiN2FmLi41ZTk4NmRlYTQ2NDUgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3ZjZV92NF8wLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvdmNlX3Y0XzAuYwpAQCAtNTM5LDcgKzUzOSw2IEBAIHN0YXRpYyBpbnQg
dmNlX3Y0XzBfaHdfaW5pdCh2b2lkICpoYW5kbGUpCiBzdGF0aWMgaW50IHZjZV92NF8wX2h3X2Zp
bmkodm9pZCAqaGFuZGxlKQogewogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gKHN0cnVj
dCBhbWRncHVfZGV2aWNlICopaGFuZGxlOwotCWludCBpOwogCiAJaWYgKCFhbWRncHVfc3Jpb3Zf
dmYoYWRldikpIHsKIAkJLyogdmNlX3Y0XzBfd2FpdF9mb3JfaWRsZShoYW5kbGUpOyAqLwpAQCAt
NTQ5LDkgKzU0OCw2IEBAIHN0YXRpYyBpbnQgdmNlX3Y0XzBfaHdfZmluaSh2b2lkICpoYW5kbGUp
CiAJCURSTV9ERUJVRygiRm9yIFNSSU9WIGNsaWVudCwgc2hvdWxkbid0IGRvIGFueXRoaW5nLlxu
Iik7CiAJfQogCi0JZm9yIChpID0gMDsgaSA8IGFkZXYtPnZjZS5udW1fcmluZ3M7IGkrKykKLQkJ
YWRldi0+dmNlLnJpbmdbaV0uc2NoZWQucmVhZHkgPSBmYWxzZTsKLQogCXJldHVybiAwOwogfQog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS92Y25fdjFfMC5jIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvdmNuX3YxXzAuYwppbmRleCA3MWY2MWFmZGM2NTUuLmRm
OTJjNGUxZWZhYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvdmNuX3Yx
XzAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS92Y25fdjFfMC5jCkBAIC0yMjcs
MTQgKzIyNywxMSBAQCBzdGF0aWMgaW50IHZjbl92MV8wX2h3X2luaXQodm9pZCAqaGFuZGxlKQog
c3RhdGljIGludCB2Y25fdjFfMF9od19maW5pKHZvaWQgKmhhbmRsZSkKIHsKIAlzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhhbmRsZTsKLQlzdHJ1
Y3QgYW1kZ3B1X3JpbmcgKnJpbmcgPSAmYWRldi0+dmNuLmluc3QtPnJpbmdfZGVjOwogCiAJaWYg
KChhZGV2LT5wZ19mbGFncyAmIEFNRF9QR19TVVBQT1JUX1ZDTl9EUEcpIHx8CiAJCVJSRUczMl9T
T0MxNShWQ04sIDAsIG1tVVZEX1NUQVRVUykpCiAJCXZjbl92MV8wX3NldF9wb3dlcmdhdGluZ19z
dGF0ZShhZGV2LCBBTURfUEdfU1RBVEVfR0FURSk7CiAKLQlyaW5nLT5zY2hlZC5yZWFkeSA9IGZh
bHNlOwotCiAJcmV0dXJuIDA7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L3Zjbl92Ml8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS92Y25fdjJfMC5j
CmluZGV4IGMzODdjODFmODY5NS4uMzc1MDgyNzdjYmRmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS92Y25fdjJfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L3Zjbl92Ml8wLmMKQEAgLTIzMiwyMSArMjMyLDEyIEBAIHN0YXRpYyBpbnQgdmNuX3YyXzBf
aHdfaW5pdCh2b2lkICpoYW5kbGUpCiBzdGF0aWMgaW50IHZjbl92Ml8wX2h3X2Zpbmkodm9pZCAq
aGFuZGxlKQogewogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICopaGFuZGxlOwotCXN0cnVjdCBhbWRncHVfcmluZyAqcmluZyA9ICZhZGV2LT52Y24u
aW5zdC0+cmluZ19kZWM7Ci0JaW50IGk7CiAKIAlpZiAoKGFkZXYtPnBnX2ZsYWdzICYgQU1EX1BH
X1NVUFBPUlRfVkNOX0RQRykgfHwKIAkgICAgKGFkZXYtPnZjbi5jdXJfc3RhdGUgIT0gQU1EX1BH
X1NUQVRFX0dBVEUgJiYKIAkgICAgICBSUkVHMzJfU09DMTUoVkNOLCAwLCBtbVVWRF9TVEFUVVMp
KSkKIAkJdmNuX3YyXzBfc2V0X3Bvd2VyZ2F0aW5nX3N0YXRlKGFkZXYsIEFNRF9QR19TVEFURV9H
QVRFKTsKIAotCXJpbmctPnNjaGVkLnJlYWR5ID0gZmFsc2U7Ci0KLQlmb3IgKGkgPSAwOyBpIDwg
YWRldi0+dmNuLm51bV9lbmNfcmluZ3M7ICsraSkgewotCQlyaW5nID0gJmFkZXYtPnZjbi5pbnN0
LT5yaW5nX2VuY1tpXTsKLQkJcmluZy0+c2NoZWQucmVhZHkgPSBmYWxzZTsKLQl9Ci0KIAlyZXR1
cm4gMDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvdmNuX3Yy
XzUuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3Zjbl92Ml81LmMKaW5kZXggMmQ2NGJh
MWFkZjk5Li45MGExOTk0ODU3ZGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L3Zjbl92Ml81LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvdmNuX3YyXzUu
YwpAQCAtMzA3LDI1ICszMDcsMTYgQEAgc3RhdGljIGludCB2Y25fdjJfNV9od19pbml0KHZvaWQg
KmhhbmRsZSkKIHN0YXRpYyBpbnQgdmNuX3YyXzVfaHdfZmluaSh2b2lkICpoYW5kbGUpCiB7CiAJ
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5k
bGU7Ci0Jc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nOwotCWludCBpLCBqOworCWludCBpOwogCiAJ
Zm9yIChpID0gMDsgaSA8IGFkZXYtPnZjbi5udW1fdmNuX2luc3Q7ICsraSkgewogCQlpZiAoYWRl
di0+dmNuLmhhcnZlc3RfY29uZmlnICYgKDEgPDwgaSkpCiAJCQljb250aW51ZTsKLQkJcmluZyA9
ICZhZGV2LT52Y24uaW5zdFtpXS5yaW5nX2RlYzsKIAogCQlpZiAoKGFkZXYtPnBnX2ZsYWdzICYg
QU1EX1BHX1NVUFBPUlRfVkNOX0RQRykgfHwKIAkJICAgIChhZGV2LT52Y24uY3VyX3N0YXRlICE9
IEFNRF9QR19TVEFURV9HQVRFICYmCiAJCSAgICAgUlJFRzMyX1NPQzE1KFZDTiwgaSwgbW1VVkRf
U1RBVFVTKSkpCiAJCQl2Y25fdjJfNV9zZXRfcG93ZXJnYXRpbmdfc3RhdGUoYWRldiwgQU1EX1BH
X1NUQVRFX0dBVEUpOwotCi0JCXJpbmctPnNjaGVkLnJlYWR5ID0gZmFsc2U7Ci0KLQkJZm9yIChq
ID0gMDsgaiA8IGFkZXYtPnZjbi5udW1fZW5jX3JpbmdzOyArK2opIHsKLQkJCXJpbmcgPSAmYWRl
di0+dmNuLmluc3RbaV0ucmluZ19lbmNbal07Ci0JCQlyaW5nLT5zY2hlZC5yZWFkeSA9IGZhbHNl
OwotCQl9CiAJfQogCiAJcmV0dXJuIDA7Ci0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vYW1kLWdmeAo=
