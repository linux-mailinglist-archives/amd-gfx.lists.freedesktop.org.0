Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 18EED6CC7E
	for <lists+amd-gfx@lfdr.de>; Thu, 18 Jul 2019 12:02:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9D2B46E391;
	Thu, 18 Jul 2019 10:02:53 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM02-BL2-obe.outbound.protection.outlook.com
 (mail-eopbgr750070.outbound.protection.outlook.com [40.107.75.70])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E396C6E391
 for <amd-gfx@lists.freedesktop.org>; Thu, 18 Jul 2019 10:02:51 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=CqRw0tetwc/YirjiQETZRdAPsNn4ksJmwl5dVJUmz7q31K2NsFezK7g+91aynDEhP8nwJTMXxSagFBi0bG2Pt4IUHLRCSXZeCaJn1/hulPFwYWujP7kwGtqYZj34HUQ/RhlVvoH+pD7EwFQE0NOXFLd5qEvZR8+YsUo0BY4YuH3gOFn/tLXyQ3n11bvRxKTg+UlEujrnhTlLBQgdQ1RYWzSC/jWIrQzXcuOX59dOuIfyfxH63vSrw9XclJ8OJ1tMIoyEJbHMhnjUnw4NU9LQpf5q7cguE/rB9EvctHSCFGijHzbZ3OsSpXevfElJgraxzs/aL/5uD5C4KvteSKVWkA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=5UCazwj1eYPXTqKUiFU0VqahLAGDc4stNTjyyZZsIXk=;
 b=JRTMyjL2Z6ZzGfGtzHC7CFdveRqkqOZozWikcn4CmM1net70VIK+F+en+G13GfI4v19lnwggxwRX3U4WOz648dnW3s03oJTGiPU0rFke36FUTNhv3hn9wRjXPmph6tYg1S71xrKocKnyGDMN7AF43nitXLyEIpe5BPFzVsTxq2+VDPcNSFZntOZYEO/JigX/j5C/fsRZcjnXr1AEiiYne2cB6wKmnYsr2k+Lz7ifElMDQB1GuOglyWxSR4+6B4w4r0WgO8Ue1EOI/Wj9vXnJoBOAAqbW8glA2BMIlbbwYqVD6XXl789gDjtO2qnTxthzzGNj5A+APrgZwfH9AqlMOA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1;spf=none (sender ip is
 165.204.84.17) smtp.rcpttodomain=lists.freedesktop.org
 smtp.mailfrom=amd.com;dmarc=permerror action=none
 header.from=amd.com;dkim=none (message not signed);arc=none
Received: from DM3PR12CA0098.namprd12.prod.outlook.com (2603:10b6:0:55::18) by
 DM5PR12MB1929.namprd12.prod.outlook.com (2603:10b6:3:106::9) with
 Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2073.14; Thu, 18 Jul 2019 10:02:50 +0000
Received: from BY2NAM03FT043.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e4a::204) by DM3PR12CA0098.outlook.office365.com
 (2603:10b6:0:55::18) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.2094.12 via Frontend
 Transport; Thu, 18 Jul 2019 10:02:50 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV02.amd.com (165.204.84.17) by
 BY2NAM03FT043.mail.protection.outlook.com (10.152.85.147) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.2052.18 via Frontend Transport; Thu, 18 Jul 2019 10:02:49 +0000
Received: from gc-System-Product-Name.amd.com (10.34.1.3) by
 SATLEXCHOV02.amd.com (10.181.40.72) with Microsoft SMTP Server id 14.3.389.1; 
 Thu, 18 Jul 2019 05:02:48 -0500
From: Chengming Gui <Jack.Gui@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 2/3] drm/amd/powerplay: force sclk limit for peak profile
Date: Thu, 18 Jul 2019 18:02:17 +0800
Message-ID: <1563444138-23948-2-git-send-email-Jack.Gui@amd.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1563444138-23948-1-git-send-email-Jack.Gui@amd.com>
References: <1563444138-23948-1-git-send-email-Jack.Gui@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(346002)(39850400004)(396003)(376002)(136003)(2980300002)(428003)(189003)(199004)(81156014)(76176011)(478600001)(486006)(48376002)(81166006)(5660300002)(47776003)(4326008)(50466002)(70586007)(70206006)(8936002)(86362001)(50226002)(476003)(11346002)(51416003)(426003)(53416004)(7696005)(2351001)(446003)(6916009)(356004)(8676002)(336012)(305945005)(16586007)(316002)(53936002)(2616005)(14444005)(68736007)(36756003)(26005)(126002)(6666004)(2906002)(186003);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM5PR12MB1929; H:SATLEXCHOV02.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; MX:1; A:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 19f03867-aa5f-4360-c54b-08d70b671770
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328);
 SRVR:DM5PR12MB1929; 
X-MS-TrafficTypeDiagnostic: DM5PR12MB1929:
X-Microsoft-Antispam-PRVS: <DM5PR12MB19296984F79CEF806D02CEB48BC80@DM5PR12MB1929.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:1013;
X-Forefront-PRVS: 01026E1310
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: SfZ00snLRdqyoHapT4+zZgj+bVpTjZYq85o+EOu8G74cJNLWRlIdQHgJnssJBmFLpDKnEXhJZjiNSVFQVKGF4Y5zHRTRAxqP9RU25YVQes4wSgNnjk4Bq1RTMcxwCA3GlIuAbZFMsZQGknVE5f4SAiZmL3J3nRVMPOUYZzAR0Lh6a6JOEEmum3WKZbdJVuKi8gt2IaDWCTbdxNx8Vv24yDXrxOvKurdvLv0KydQv+7tRNWJR6+/ZGwxESSVQU+/pBL9TR5GSJMBJ8VkrFBTMin9ktYS8fYOZ6lpsL1sfUtgUH4y+c2Vq30r1q4pP0Y7Y5XAqo6N8JK+LpmRO3Lw0nZYFDVyVn/eLMEsy7Ve72HUFBnRgAUVe6NcwBmICXczvAtIB7O6PE23BDqcB/mSrVaUBDx63SXRRmkgg/dnWXUI=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 18 Jul 2019 10:02:49.7356 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 19f03867-aa5f-4360-c54b-08d70b671770
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV02.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM5PR12MB1929
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=5UCazwj1eYPXTqKUiFU0VqahLAGDc4stNTjyyZZsIXk=;
 b=Ly9K9OrC+f2nY8r8KtLJoBEOncr3XXGhD1TsUK4RgfMIHXVJBJ5wZIhOMLc6Rkb8PcgBvX4IzL9+OHbJb22JiKpzHf6Cbbzj5n8WlPb2B6Y7kZZRnwLAp4G5g64mbHe/OaHVwA3x9F7WVSBeQY8u366hKM5xLGbf/xsUCxYYX2s=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Chengming Gui <Jack.Gui@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

Zm9yY2UgZGlmZmVyZW50IEdGWCBjbG9ja3Mgd2l0aCBkaWZmZXJlbnQgU0tVcyBmb3IgbmF2aTEw
OgpYTCAgKG90aGVyIHJldl9pZCk6ICAxNjI1TUh6ClhUICAgICAgICAgKEYxL0MxKTogIDE3NTVN
SHoKWFRYICAgICAgICAoRjAvQzApOiAgMTgzME1IegoKU2lnbmVkLW9mZi1ieTogQ2hlbmdtaW5n
IEd1aSA8SmFjay5HdWlAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxh
eS9hbWRncHVfc211LmMgICAgIHwgIDIgKwogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkv
aW5jL2FtZGdwdV9zbXUuaCB8ICAyICsKIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25h
dmkxMF9wcHQuYyAgICAgfCA2NiArKysrKysrKysrKysrKysrKysrKysrKysrLQogMyBmaWxlcyBj
aGFuZ2VkLCA2OCBpbnNlcnRpb25zKCspLCAyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2FtZGdwdV9zbXUuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvcG93ZXJwbGF5L2FtZGdwdV9zbXUuYwppbmRleCAxMjI5ODVjLi42OTM0MTRmIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9hbWRncHVfc211LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jCkBAIC02NjQsNiArNjY0
LDggQEAgc3RhdGljIGludCBzbXVfc3dfaW5pdCh2b2lkICpoYW5kbGUpCiAJc211LT53YXRlcm1h
cmtzX2JpdG1hcCA9IDA7CiAJc211LT5wb3dlcl9wcm9maWxlX21vZGUgPSBQUF9TTUNfUE9XRVJf
UFJPRklMRV9CT09UVVBfREVGQVVMVDsKIAlzbXUtPmRlZmF1bHRfcG93ZXJfcHJvZmlsZV9tb2Rl
ID0gUFBfU01DX1BPV0VSX1BST0ZJTEVfQk9PVFVQX0RFRkFVTFQ7CisJc211LT5zbXVfZHBtLmRl
ZmF1bHRfc2Nsa19saW1pdCA9IDA7CisJc211LT5zbXVfZHBtLnBlYWtfc2Nsa19saW1pdCA9IDA7
CiAKIAlzbXUtPndvcmtsb2FkX21hc2sgPSAxIDw8IHNtdS0+d29ya2xvYWRfcHJvcml0eVtQUF9T
TUNfUE9XRVJfUFJPRklMRV9CT09UVVBfREVGQVVMVF07CiAJc211LT53b3JrbG9hZF9wcm9yaXR5
W1BQX1NNQ19QT1dFUl9QUk9GSUxFX0JPT1RVUF9ERUZBVUxUXSA9IDA7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMvYW1kZ3B1X3NtdS5oIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5jL2FtZGdwdV9zbXUuaAppbmRleCAxMzVhMzIzLi5hY2I1
MjJiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMvYW1kZ3B1
X3NtdS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2luYy9hbWRncHVfc211
LmgKQEAgLTQ0MSw2ICs0NDEsOCBAQCBzdHJ1Y3Qgc211X2RwbV9jb250ZXh0IHsKIAl2b2lkICpk
cG1fY29udGV4dDsKIAl2b2lkICpnb2xkZW5fZHBtX2NvbnRleHQ7CiAJYm9vbCBlbmFibGVfdW1k
X3BzdGF0ZTsKKwl1aW50MzJfdCBkZWZhdWx0X3NjbGtfbGltaXQ7CisJdWludDMyX3QgcGVha19z
Y2xrX2xpbWl0OwogCWVudW0gYW1kX2RwbV9mb3JjZWRfbGV2ZWwgZHBtX2xldmVsOwogCWVudW0g
YW1kX2RwbV9mb3JjZWRfbGV2ZWwgc2F2ZWRfZHBtX2xldmVsOwogCWVudW0gYW1kX2RwbV9mb3Jj
ZWRfbGV2ZWwgcmVxdWVzdGVkX2RwbV9sZXZlbDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvcG93ZXJwbGF5L25hdmkxMF9wcHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJw
bGF5L25hdmkxMF9wcHQuYwppbmRleCA4OTVhNGU1Li5iNGRlYjllIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0LmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9wb3dlcnBsYXkvbmF2aTEwX3BwdC5jCkBAIC0zNyw2ICszNywxNSBAQAogCiAjaW5j
bHVkZSAiYXNpY19yZWcvbXAvbXBfMTFfMF9zaF9tYXNrLmgiCiAKKyNkZWZpbmUgTlZfTlYxMF9G
MCAweEYwCisjZGVmaW5lIE5WX05WMTBfQzAgMHhDMAorI2RlZmluZSBOVl9OVjEwX0YxIDB4RjEK
KyNkZWZpbmUgTlZfTlYxMF9DMSAweEMxCisKKyNkZWZpbmUgTlZfTlYxMF9QRUFLX1NDTEtfWFRY
IDE4MzAKKyNkZWZpbmUgTlZfTlYxMF9QRUFLX1NDTEtfWFQgIDE3NTUKKyNkZWZpbmUgTlZfTlYx
MF9QRUFLX1NDTEtfWEwgIDE2MjUKKwogI2RlZmluZSBGRUFUVVJFX01BU0soZmVhdHVyZSkgKDFV
TEwgPDwgZmVhdHVyZSkKICNkZWZpbmUgU01DX0RQTV9GRUFUVVJFICggXAogCUZFQVRVUkVfTUFT
SyhGRUFUVVJFX0RQTV9QUkVGRVRDSEVSX0JJVCkgfCBcCkBAIC02NzUsNiArNjg0LDcgQEAgc3Rh
dGljIGludCBuYXZpMTBfZm9yY2VfY2xrX2xldmVscyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwK
IAogCWludCByZXQgPSAwLCBzaXplID0gMDsKIAl1aW50MzJfdCBzb2Z0X21pbl9sZXZlbCA9IDAs
IHNvZnRfbWF4X2xldmVsID0gMCwgbWluX2ZyZXEgPSAwLCBtYXhfZnJlcSA9IDA7CisJc3RydWN0
IHNtdV9kcG1fY29udGV4dCAqc211X2RwbV9jdHggPSAmKHNtdS0+c211X2RwbSk7CiAKIAlzb2Z0
X21pbl9sZXZlbCA9IG1hc2sgPyAoZmZzKG1hc2spIC0gMSkgOiAwOwogCXNvZnRfbWF4X2xldmVs
ID0gbWFzayA/IChmbHMobWFzaykgLSAxKSA6IDA7CkBAIC02ODIsNiArNjkyLDIzIEBAIHN0YXRp
YyBpbnQgbmF2aTEwX2ZvcmNlX2Nsa19sZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCiAJ
c3dpdGNoIChjbGtfdHlwZSkgewogCWNhc2UgU01VX0dGWENMSzoKIAljYXNlIFNNVV9TQ0xLOgor
CQlpZiAoc211X2RwbV9jdHgtPnBlYWtfc2Nsa19saW1pdCkgeworCQkJbWF4X2ZyZXEgPSBzbXVf
ZHBtX2N0eC0+cGVha19zY2xrX2xpbWl0OworCQkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9ieV9p
bmRleChzbXUsIGNsa190eXBlLCBzb2Z0X21pbl9sZXZlbCwgJm1pbl9mcmVxKTsKKwkJCWlmIChy
ZXQpCisJCQkJcmV0dXJuIHNpemU7CisJCX0gZWxzZSB7CisJCQlyZXQgPSBzbXVfZ2V0X2RwbV9m
cmVxX2J5X2luZGV4KHNtdSwgY2xrX3R5cGUsIHNvZnRfbWluX2xldmVsLCAmbWluX2ZyZXEpOwor
CQkJaWYgKHJldCkKKwkJCQlyZXR1cm4gc2l6ZTsKKwkJCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFf
YnlfaW5kZXgoc211LCBjbGtfdHlwZSwgc29mdF9tYXhfbGV2ZWwsICZtYXhfZnJlcSk7CisJCQlp
ZiAocmV0KQorCQkJCXJldHVybiBzaXplOworCQl9CisJCXJldCA9IHNtdV9zZXRfc29mdF9mcmVx
X3JhbmdlKHNtdSwgY2xrX3R5cGUsIG1pbl9mcmVxLCBtYXhfZnJlcSk7CisJCWlmIChyZXQpCisJ
CQlyZXR1cm4gc2l6ZTsKKwkJYnJlYWs7CiAJY2FzZSBTTVVfU09DQ0xLOgogCWNhc2UgU01VX01D
TEs6CiAJY2FzZSBTTVVfVUNMSzoKQEAgLTY5MCwxMSArNzE3LDkgQEAgc3RhdGljIGludCBuYXZp
MTBfZm9yY2VfY2xrX2xldmVscyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKIAkJcmV0ID0gc211
X2dldF9kcG1fZnJlcV9ieV9pbmRleChzbXUsIGNsa190eXBlLCBzb2Z0X21pbl9sZXZlbCwgJm1p
bl9mcmVxKTsKIAkJaWYgKHJldCkKIAkJCXJldHVybiBzaXplOwotCiAJCXJldCA9IHNtdV9nZXRf
ZHBtX2ZyZXFfYnlfaW5kZXgoc211LCBjbGtfdHlwZSwgc29mdF9tYXhfbGV2ZWwsICZtYXhfZnJl
cSk7CiAJCWlmIChyZXQpCiAJCQlyZXR1cm4gc2l6ZTsKLQogCQlyZXQgPSBzbXVfc2V0X3NvZnRf
ZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCBtaW5fZnJlcSwgbWF4X2ZyZXEpOwogCQlpZiAocmV0
KQogCQkJcmV0dXJuIHNpemU7CkBAIC04MzgsNiArODYzLDcgQEAgc3RhdGljIGludCBuYXZpMTBf
dW5mb3JjZV9kcG1fbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQogCWludCByZXQgPSAw
LCBpID0gMDsKIAl1aW50MzJfdCBtaW5fZnJlcSwgbWF4X2ZyZXE7CiAJZW51bSBzbXVfY2xrX3R5
cGUgY2xrX3R5cGU7CisJc3RydWN0IHNtdV9kcG1fY29udGV4dCAqc211X2RwbV9jdHggPSAmKHNt
dS0+c211X2RwbSk7CiAKIAllbnVtIHNtdV9jbGtfdHlwZSBjbGtzW10gPSB7CiAJCVNNVV9HRlhD
TEssCkBAIC04NTEsMTAgKzg3NywxOCBAQCBzdGF0aWMgaW50IG5hdmkxMF91bmZvcmNlX2RwbV9s
ZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCiAJCWlmIChyZXQpCiAJCQlyZXR1cm4gcmV0
OwogCisJCWlmIChjbGtfdHlwZSA9PSBTTVVfR0ZYQ0xLICYmIHNtdV9kcG1fY3R4LT5kZWZhdWx0
X3NjbGtfbGltaXQgIT0gMCkgeworCQkJbWF4X2ZyZXEgPSBzbXVfZHBtX2N0eC0+ZGVmYXVsdF9z
Y2xrX2xpbWl0OworCQkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9HRlhD
TEssCisJCQkJCQkgICAgICZtaW5fZnJlcSwgTlVMTCk7CisJCQlpZiAocmV0KQorCQkJCXJldHVy
biByZXQ7CisJCX0KIAkJcmV0ID0gc211X3NldF9zb2Z0X2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlw
ZSwgbWluX2ZyZXEsIG1heF9mcmVxKTsKIAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7CiAJfQor
CXNtdV9kcG1fY3R4LT5wZWFrX3NjbGtfbGltaXQgPSAwOwogCiAJcmV0dXJuIHJldDsKIH0KQEAg
LTE1MzEsNiArMTU2NSwzMyBAQCBzdGF0aWMgaW50IG5hdmkxMF9zZXRfcHBmZWF0dXJlX3N0YXR1
cyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKIAlyZXR1cm4gMDsKIH0KIAorc3RhdGljIGludCBu
YXZpMTBfYXBwbHlfY2xvY2tzX2FkanVzdF9ydWxlcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkK
K3sKKwlpbnQgcmV0ID0gMDsKKwlzdHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpzbXVfZHBtX2N0eCA9
ICYoc211LT5zbXVfZHBtKTsKKwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IHNtdS0+YWRl
djsKKworCWlmIChzbXVfZHBtX2N0eC0+ZGVmYXVsdF9zY2xrX2xpbWl0ID09IDApIHsKKwkJcmV0
ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9TQ0xLLCBOVUxMLAorCQkJCQkgICAg
ICZzbXVfZHBtX2N0eC0+ZGVmYXVsdF9zY2xrX2xpbWl0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisK
KwlpZiAoc211X2RwbV9jdHgtPmRwbV9sZXZlbCA9PSBBTURfRFBNX0ZPUkNFRF9MRVZFTF9QUk9G
SUxFX1BFQUsgJiYKKwkgICAgc211X2RwbV9jdHgtPmRwbV9sZXZlbCAhPSBzbXVfZHBtX2N0eC0+
c2F2ZWRfZHBtX2xldmVsKSB7CisJCWlmIChhZGV2LT5yZXZfaWQgPT0gTlZfTlYxMF9GMCB8fCBh
ZGV2LT5yZXZfaWQgPT0gTlZfTlYxMF9DMCkKKwkJCXNtdV9kcG1fY3R4LT5wZWFrX3NjbGtfbGlt
aXQgPSBOVl9OVjEwX1BFQUtfU0NMS19YVFg7CisJCWVsc2UgaWYgKGFkZXYtPnJldl9pZCA9PSBO
Vl9OVjEwX0YxIHx8IGFkZXYtPnJldl9pZCA9PSBOVl9OVjEwX0MxKQorCQkJc211X2RwbV9jdHgt
PnBlYWtfc2Nsa19saW1pdCA9IE5WX05WMTBfUEVBS19TQ0xLX1hUOworCQllbHNlCisJCQlzbXVf
ZHBtX2N0eC0+cGVha19zY2xrX2xpbWl0ID0gTlZfTlYxMF9QRUFLX1NDTEtfWEw7CisJfSBlbHNl
IGlmIChzbXVfZHBtX2N0eC0+ZHBtX2xldmVsICE9IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJ
TEVfUEVBSyAmJiBzbXVfZHBtX2N0eC0+cGVha19zY2xrX2xpbWl0ICE9IDApIHsKKwkJc211X2Rw
bV9jdHgtPnBlYWtfc2Nsa19saW1pdCA9IDA7CisJfQorCisJcmV0dXJuIDA7Cit9CisKIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgcHB0YWJsZV9mdW5jcyBuYXZpMTBfcHB0X2Z1bmNzID0gewogCS50YWJs
ZXNfaW5pdCA9IG5hdmkxMF90YWJsZXNfaW5pdCwKIAkuYWxsb2NfZHBtX2NvbnRleHQgPSBuYXZp
MTBfYWxsb2NhdGVfZHBtX2NvbnRleHQsCkBAIC0xNTY2LDYgKzE2MjcsNyBAQCBzdGF0aWMgY29u
c3Qgc3RydWN0IHBwdGFibGVfZnVuY3MgbmF2aTEwX3BwdF9mdW5jcyA9IHsKIAkuZ2V0X3VjbGtf
ZHBtX3N0YXRlcyA9IG5hdmkxMF9nZXRfdWNsa19kcG1fc3RhdGVzLAogCS5nZXRfcHBmZWF0dXJl
X3N0YXR1cyA9IG5hdmkxMF9nZXRfcHBmZWF0dXJlX3N0YXR1cywKIAkuc2V0X3BwZmVhdHVyZV9z
dGF0dXMgPSBuYXZpMTBfc2V0X3BwZmVhdHVyZV9zdGF0dXMsCisJLmFwcGx5X2Nsb2Nrc19hZGp1
c3RfcnVsZXMgPSBuYXZpMTBfYXBwbHlfY2xvY2tzX2FkanVzdF9ydWxlcywKIH07CiAKIHZvaWQg
bmF2aTEwX3NldF9wcHRfZnVuY3Moc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCi0tIAoyLjcuNAoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBt
YWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
