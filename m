Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D3129F373A
	for <lists+amd-gfx@lfdr.de>; Thu,  7 Nov 2019 19:29:26 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2F1566E513;
	Thu,  7 Nov 2019 18:29:25 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM05-DM3-obe.outbound.protection.outlook.com
 (mail-eopbgr730062.outbound.protection.outlook.com [40.107.73.62])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0E8446E513
 for <amd-gfx@lists.freedesktop.org>; Thu,  7 Nov 2019 18:29:21 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=I4FWbrotLuGH5yyIY9VMP/qPLELW3oBbv1umh3+2uwaG8bSFKhLtQlGYmQgZMnYnSe1ZC7tjYROaBrlNjORYn0+mThVnSfdk/BMzkIGDhb/OrK4vCiM2Im1lAQ1LwA4fS7ywyK4XvjQfgC1QJNbKpQJV9VPwrj/jhESrJ/izvaa8d8fYEBlqNK7Mi5gvXNHE3QK3kG6huBBhtAAr/Irl/cpqXNbB6hG+DaN8o6oFFC3xvLw6jsQhcJQOGjlgoWbiId0tmRhg2i3ymFYPtMHkRccCBHqATshYFMkv66oFIH6bolVwGHDsTM9rFMZ+kYffEQbCbNI4nZSqmjjKXGfNQw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=CMFPgmWQHtEOwAoco4T+uBLtWNFyOnDz21GjJkS6UT8=;
 b=WjQSq4no8P0rBfMn/olPq6+enkjRJgCsWZl9ebbN6KXnkEp3TwSR2NABmvkQk96Qek8UF7oKJNkztyxRbaq172zTynCTqrInmpRVULrfhhLcIj67iU8WkL3ha6+dT2IzXEcxeyR56Ers5Vu4acC48fbb/DgOr/UT8AgdFPGNwWA76kW5FMwnhSrePzvogLXhq80DYjTZweqlRRRSeJ3M//7fDfVoYwUu+F8lOHzdu37iV+1ZbMdNZ/TpEeRUH1Mdy2QVRX5yCN9BNygI0tlS0hNEoN9kpPYbNZOQq3SktV6hxULwYNfRVkMNmIWE7zqTtRJBO0GggkHbzYRMxo/Bdg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from DM6PR12MB2778.namprd12.prod.outlook.com (20.176.114.145) by
 DM6PR12MB3194.namprd12.prod.outlook.com (20.179.105.13) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2430.23; Thu, 7 Nov 2019 18:29:18 +0000
Received: from DM6PR12MB2778.namprd12.prod.outlook.com
 ([fe80::304d:db58:2aa:d69e]) by DM6PR12MB2778.namprd12.prod.outlook.com
 ([fe80::304d:db58:2aa:d69e%6]) with mapi id 15.20.2430.020; Thu, 7 Nov 2019
 18:29:18 +0000
From: "Zhao, Yong" <Yong.Zhao@amd.com>
To: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: [PATCH] drm/amdkfd: Use kernel queue v9 functions for v10
Thread-Topic: [PATCH] drm/amdkfd: Use kernel queue v9 functions for v10
Thread-Index: AQHVlZlD+yh3+0BPTUaSHEBaN6H79Q==
Date: Thu, 7 Nov 2019 18:29:17 +0000
Message-ID: <20191107182903.4306-1-Yong.Zhao@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: YTOPR0101CA0014.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:15::27) To DM6PR12MB2778.namprd12.prod.outlook.com
 (2603:10b6:5:50::17)
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.17.1
x-originating-ip: [165.204.55.251]
x-ms-publictraffictype: Email
x-ms-office365-filtering-ht: Tenant
x-ms-office365-filtering-correlation-id: 56a03c20-bcb6-48b7-e85e-08d763b06626
x-ms-traffictypediagnostic: DM6PR12MB3194:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <DM6PR12MB3194F600BB96DDDCEADF6554F0780@DM6PR12MB3194.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:10000;
x-forefront-prvs: 0214EB3F68
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(346002)(136003)(366004)(39860400002)(376002)(396003)(51234002)(189003)(199004)(99286004)(5660300002)(1076003)(6506007)(386003)(71190400001)(66066001)(316002)(66946007)(66556008)(64756008)(66446008)(2351001)(71200400001)(30864003)(102836004)(186003)(26005)(52116002)(256004)(14444005)(66476007)(6116002)(3846002)(476003)(2616005)(486006)(6916009)(25786009)(7736002)(478600001)(5640700003)(14454004)(305945005)(2501003)(81166006)(4326008)(50226002)(8676002)(8936002)(81156014)(86362001)(6486002)(6436002)(6512007)(2906002)(36756003);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM6PR12MB3194;
 H:DM6PR12MB2778.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: Q8FPKjP0BeZazzJd0GqBT1cjvk2YIimWCJaNrIWtWEwPAURuwp9ZYQx3DY7ZwngVKJkMGnsYota+3R97RTiazTilXWz8kOwehtOlDo0Tovv199/7jEFPGhcSjNodB38MGxg7mWoUnWDBHNzJo3HNKFDGkGGUTCS1dTc6a3wZlKkxYGmne5V00w1lVD4r9W69thMq4SXLD+y9iWKKx/A5fmSccfQuyXWGigVczGi1GGnateL2XxoIM4nn04iaUvcq/qCI835sZVdPfUO3qVnr+2bQ8j6mbFtF3t05icIJZs/ouUZJEcLGBE3l2q89cryf+qGaEMBYJF8rhSBPZOsDilUQIlFMxOgzzTlNFAxYoIf0QJ9c7t+ThJCpZGFtN96+emBjliPh9tuSz2rH+mkKEtAmJ0ONIZU/PrcHedJr3TnS/F2rIGZVj9ymxjrnzg3SlseqZtBHva/D8YIwzF1sng==
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 56a03c20-bcb6-48b7-e85e-08d763b06626
X-MS-Exchange-CrossTenant-originalarrivaltime: 07 Nov 2019 18:29:18.2550 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: LCWpiqaVr8PmY2vVljAm2IF7sCGp6sWD6eZpKc+cfxRxk6eL161SocHSjaKyfnCl
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB3194
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=CMFPgmWQHtEOwAoco4T+uBLtWNFyOnDz21GjJkS6UT8=;
 b=Hw6/FHmcOPJOkbzxnR+KvE3aUjRcB1nKc0zJeuL2ZSlztO3h+OOG7ziBwUZZvuNNA2NQQTagRsdLxQn7fFM7d7Jv2vc3fJWpxQUEzmuQnwG1xssv1dNrrKdOHkDhxISNamxN1008G3Nm92b6Oqhp/YFGUiFpLb5lNaDM26npd6Y=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Yong.Zhao@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Zhao, Yong" <Yong.Zhao@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

VGhlIGtlcm5lbCBxdWV1ZSBmdW5jdGlvbnMgZm9yIHY5IGFuZCB2MTAgYXJlIHRoZSBzYW1lIGV4
Y2VwdApwbV9tYXBfcHJvY2Vzc192KiB3aGljaCBoYXZlIHNtYWxsIGRpZmZlcmVuY2UsIHNvIHRo
ZXkgc2hvdWxkIGJlIHJldXNlZC4KVGhpcyBlbGltaW5hdGVzIHRoZSBuZWVkIG9mIHJlYXBwbHlp
bmcgc2V2ZXJhbCBwYXRjaGVzIHdoaWNoIHdlcmUKYXBwbGllZCBvbiB2OSBidXQgbm90IG9uIHYx
MCwgc3VjaCBhcyBiaWdnZXIgR1dTIGFuZCBtb3JlIHRoYW4gMgpTRE1BIGVuZ2luZSBzdXBwb3J0
IHdoaWNoIHdlcmUgaW50cm9kdWNlZCBvbiBBcmN0dXJ1cy4KCkNoYW5nZS1JZDogSTJkMzg1OTYx
ZTNjODg0ZGIxNGUzMGI1YWZjOThkMGQ5ZTRjYjE4MDIKU2lnbmVkLW9mZi1ieTogWW9uZyBaaGFv
IDxZb25nLlpoYW9AYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9NYWtl
ZmlsZSAgICAgICAgICAgfCAgIDEgLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2tl
cm5lbF9xdWV1ZS5jIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2Vy
bmVsX3F1ZXVlLmggfCAgIDEgLQogLi4uL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1
ZXVlX3YxMC5jIHwgMzE3IC0tLS0tLS0tLS0tLS0tLS0tLQogLi4uL2dwdS9kcm0vYW1kL2FtZGtm
ZC9rZmRfa2VybmVsX3F1ZXVlX3Y5LmMgIHwgIDQ4ICsrLQogZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRrZmQva2ZkX3ByaXYuaCAgICAgICAgIHwgICAzIC0KIDYgZmlsZXMgY2hhbmdlZCwgNDMgaW5z
ZXJ0aW9ucygrKSwgMzMxIGRlbGV0aW9ucygtKQogZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMv
Z3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9rZXJuZWxfcXVldWVfdjEwLmMKCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1ka2ZkL01ha2VmaWxlCmluZGV4IDQ4MTU1MDYwYTU3Yy4uMDE3YThiNzE1NmRhIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGtmZC9NYWtlZmlsZQpAQCAtNDEsNyArNDEsNiBAQCBBTURLRkRfRklMRVMJ
Oj0gJChBTURLRkRfUEFUSCkva2ZkX21vZHVsZS5vIFwKIAkJJChBTURLRkRfUEFUSCkva2ZkX2tl
cm5lbF9xdWV1ZV9jaWsubyBcCiAJCSQoQU1ES0ZEX1BBVEgpL2tmZF9rZXJuZWxfcXVldWVfdmku
byBcCiAJCSQoQU1ES0ZEX1BBVEgpL2tmZF9rZXJuZWxfcXVldWVfdjkubyBcCi0JCSQoQU1ES0ZE
X1BBVEgpL2tmZF9rZXJuZWxfcXVldWVfdjEwLm8gXAogCQkkKEFNREtGRF9QQVRIKS9rZmRfcGFj
a2V0X21hbmFnZXIubyBcCiAJCSQoQU1ES0ZEX1BBVEgpL2tmZF9wcm9jZXNzX3F1ZXVlX21hbmFn
ZXIubyBcCiAJCSQoQU1ES0ZEX1BBVEgpL2tmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5vIFwKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9rZXJuZWxfcXVldWUuYyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9rZXJuZWxfcXVldWUuYwppbmRleCAxMWQy
NDQ4OTEzOTMuLjBkOTY2NDA4ZWE4NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRrZmQva2ZkX2tlcm5lbF9xdWV1ZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2Zk
L2tmZF9rZXJuZWxfcXVldWUuYwpAQCAtMzMyLDEyICszMzIsMTAgQEAgc3RydWN0IGtlcm5lbF9x
dWV1ZSAqa2VybmVsX3F1ZXVlX2luaXQoc3RydWN0IGtmZF9kZXYgKmRldiwKIAljYXNlIENISVBf
UkFWRU46CiAJY2FzZSBDSElQX1JFTk9JUjoKIAljYXNlIENISVBfQVJDVFVSVVM6Ci0JCWtlcm5l
bF9xdWV1ZV9pbml0X3Y5KCZrcS0+b3BzX2FzaWNfc3BlY2lmaWMpOwotCQlicmVhazsKIAljYXNl
IENISVBfTkFWSTEwOgogCWNhc2UgQ0hJUF9OQVZJMTI6CiAJY2FzZSBDSElQX05BVkkxNDoKLQkJ
a2VybmVsX3F1ZXVlX2luaXRfdjEwKCZrcS0+b3BzX2FzaWNfc3BlY2lmaWMpOworCQlrZXJuZWxf
cXVldWVfaW5pdF92OSgma3EtPm9wc19hc2ljX3NwZWNpZmljKTsKIAkJYnJlYWs7CiAJZGVmYXVs
dDoKIAkJV0FSTigxLCAiVW5leHBlY3RlZCBBU0lDIGZhbWlseSAldSIsCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVlLmggYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVlLmgKaW5kZXggMzY1ZmM2NzRmZWE0Li5h
NzExNmE5MzkwMjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9r
ZXJuZWxfcXVldWUuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVs
X3F1ZXVlLmgKQEAgLTEwMiw2ICsxMDIsNSBAQCBzdHJ1Y3Qga2VybmVsX3F1ZXVlIHsKIHZvaWQg
a2VybmVsX3F1ZXVlX2luaXRfY2lrKHN0cnVjdCBrZXJuZWxfcXVldWVfb3BzICpvcHMpOwogdm9p
ZCBrZXJuZWxfcXVldWVfaW5pdF92aShzdHJ1Y3Qga2VybmVsX3F1ZXVlX29wcyAqb3BzKTsKIHZv
aWQga2VybmVsX3F1ZXVlX2luaXRfdjkoc3RydWN0IGtlcm5lbF9xdWV1ZV9vcHMgKm9wcyk7Ci12
b2lkIGtlcm5lbF9xdWV1ZV9pbml0X3YxMChzdHJ1Y3Qga2VybmVsX3F1ZXVlX29wcyAqb3BzKTsK
IAogI2VuZGlmIC8qIEtGRF9LRVJORUxfUVVFVUVfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9rZXJuZWxfcXVldWVfdjEwLmMgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVlX3YxMC5jCmRlbGV0ZWQgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCBiZmQ2MjIxYWNhZTkuLjAwMDAwMDAwMDAwMAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVlX3YxMC5jCisrKyAvZGV2L251bGwKQEAgLTEs
MzE3ICswLDAgQEAKLS8qCi0gKiBDb3B5cmlnaHQgMjAxOCBBZHZhbmNlZCBNaWNybyBEZXZpY2Vz
LCBJbmMuCi0gKgotICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFy
Z2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKLSAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBh
bmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCi0gKiB0
byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0
aG91dCBsaW1pdGF0aW9uCi0gKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJn
ZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKLSAqIGFuZC9vciBzZWxsIGNvcGll
cyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQotICog
U29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcg
Y29uZGl0aW9uczoKLSAqCi0gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBw
ZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgotICogYWxsIGNvcGllcyBvciBz
dWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCi0gKgotICogVEhFIFNPRlRXQVJF
IElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJF
U1MgT1IKLSAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJB
TlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAotICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBV
UlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCi0gKiBUSEUgQ09Q
WVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERB
TUFHRVMgT1IKLSAqIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09O
VFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAotICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4g
Q09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SCi0gKiBPVEhFUiBERUFM
SU5HUyBJTiBUSEUgU09GVFdBUkUuCi0gKgotICovCi0KLSNpbmNsdWRlICJrZmRfa2VybmVsX3F1
ZXVlLmgiCi0jaW5jbHVkZSAia2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmgiCi0jaW5jbHVkZSAi
a2ZkX3BtNF9oZWFkZXJzX2FpLmgiCi0jaW5jbHVkZSAia2ZkX3BtNF9vcGNvZGVzLmgiCi0jaW5j
bHVkZSAiZ2MvZ2NfMTBfMV8wX3NoX21hc2suaCIKLQotc3RhdGljIGJvb2wgaW5pdGlhbGl6ZV92
MTAoc3RydWN0IGtlcm5lbF9xdWV1ZSAqa3EsIHN0cnVjdCBrZmRfZGV2ICpkZXYsCi0JCQllbnVt
IGtmZF9xdWV1ZV90eXBlIHR5cGUsIHVuc2lnbmVkIGludCBxdWV1ZV9zaXplKTsKLXN0YXRpYyB2
b2lkIHVuaW5pdGlhbGl6ZV92MTAoc3RydWN0IGtlcm5lbF9xdWV1ZSAqa3EpOwotc3RhdGljIHZv
aWQgc3VibWl0X3BhY2tldF92MTAoc3RydWN0IGtlcm5lbF9xdWV1ZSAqa3EpOwotCi12b2lkIGtl
cm5lbF9xdWV1ZV9pbml0X3YxMChzdHJ1Y3Qga2VybmVsX3F1ZXVlX29wcyAqb3BzKQotewotCW9w
cy0+aW5pdGlhbGl6ZSA9IGluaXRpYWxpemVfdjEwOwotCW9wcy0+dW5pbml0aWFsaXplID0gdW5p
bml0aWFsaXplX3YxMDsKLQlvcHMtPnN1Ym1pdF9wYWNrZXQgPSBzdWJtaXRfcGFja2V0X3YxMDsK
LX0KLQotc3RhdGljIGJvb2wgaW5pdGlhbGl6ZV92MTAoc3RydWN0IGtlcm5lbF9xdWV1ZSAqa3Es
IHN0cnVjdCBrZmRfZGV2ICpkZXYsCi0JCQllbnVtIGtmZF9xdWV1ZV90eXBlIHR5cGUsIHVuc2ln
bmVkIGludCBxdWV1ZV9zaXplKQotewotCWludCByZXR2YWw7Ci0KLQlyZXR2YWwgPSBrZmRfZ3R0
X3NhX2FsbG9jYXRlKGRldiwgUEFHRV9TSVpFLCAma3EtPmVvcF9tZW0pOwotCWlmIChyZXR2YWwg
IT0gMCkKLQkJcmV0dXJuIGZhbHNlOwotCi0Ja3EtPmVvcF9ncHVfYWRkciA9IGtxLT5lb3BfbWVt
LT5ncHVfYWRkcjsKLQlrcS0+ZW9wX2tlcm5lbF9hZGRyID0ga3EtPmVvcF9tZW0tPmNwdV9wdHI7
Ci0KLQltZW1zZXQoa3EtPmVvcF9rZXJuZWxfYWRkciwgMCwgUEFHRV9TSVpFKTsKLQotCXJldHVy
biB0cnVlOwotfQotCi1zdGF0aWMgdm9pZCB1bmluaXRpYWxpemVfdjEwKHN0cnVjdCBrZXJuZWxf
cXVldWUgKmtxKQotewotCWtmZF9ndHRfc2FfZnJlZShrcS0+ZGV2LCBrcS0+ZW9wX21lbSk7Ci19
Ci0KLXN0YXRpYyB2b2lkIHN1Ym1pdF9wYWNrZXRfdjEwKHN0cnVjdCBrZXJuZWxfcXVldWUgKmtx
KQotewotCSprcS0+d3B0cjY0X2tlcm5lbCA9IGtxLT5wZW5kaW5nX3dwdHI2NDsKLQl3cml0ZV9r
ZXJuZWxfZG9vcmJlbGw2NChrcS0+cXVldWUtPnByb3BlcnRpZXMuZG9vcmJlbGxfcHRyLAotCQkJ
CWtxLT5wZW5kaW5nX3dwdHI2NCk7Ci19Ci0KLXN0YXRpYyBpbnQgcG1fbWFwX3Byb2Nlc3NfdjEw
KHN0cnVjdCBwYWNrZXRfbWFuYWdlciAqcG0sCi0JCXVpbnQzMl90ICpidWZmZXIsIHN0cnVjdCBx
Y21fcHJvY2Vzc19kZXZpY2UgKnFwZCkKLXsKLQlzdHJ1Y3QgcG00X21lc19tYXBfcHJvY2VzcyAq
cGFja2V0OwotCXVpbnQ2NF90IHZtX3BhZ2VfdGFibGVfYmFzZV9hZGRyID0gcXBkLT5wYWdlX3Rh
YmxlX2Jhc2U7Ci0KLQlwYWNrZXQgPSAoc3RydWN0IHBtNF9tZXNfbWFwX3Byb2Nlc3MgKilidWZm
ZXI7Ci0JbWVtc2V0KGJ1ZmZlciwgMCwgc2l6ZW9mKHN0cnVjdCBwbTRfbWVzX21hcF9wcm9jZXNz
KSk7Ci0KLQlwYWNrZXQtPmhlYWRlci51MzJBbGwgPSBwbV9idWlsZF9wbTRfaGVhZGVyKElUX01B
UF9QUk9DRVNTLAotCQkJCQlzaXplb2Yoc3RydWN0IHBtNF9tZXNfbWFwX3Byb2Nlc3MpKTsKLQlw
YWNrZXQtPmJpdGZpZWxkczIuZGlxX2VuYWJsZSA9IChxcGQtPmlzX2RlYnVnKSA/IDEgOiAwOwot
CXBhY2tldC0+Yml0ZmllbGRzMi5wcm9jZXNzX3F1YW50dW0gPSAxOwotCXBhY2tldC0+Yml0Zmll
bGRzMi5wYXNpZCA9IHFwZC0+cHFtLT5wcm9jZXNzLT5wYXNpZDsKLQlwYWNrZXQtPmJpdGZpZWxk
czE0Lmdkc19zaXplID0gcXBkLT5nZHNfc2l6ZTsKLQlwYWNrZXQtPmJpdGZpZWxkczE0Lm51bV9n
d3MgPSBxcGQtPm51bV9nd3M7Ci0JcGFja2V0LT5iaXRmaWVsZHMxNC5udW1fb2FjID0gcXBkLT5u
dW1fb2FjOwotCXBhY2tldC0+Yml0ZmllbGRzMTQuc2RtYV9lbmFibGUgPSAxOwotCi0JcGFja2V0
LT5iaXRmaWVsZHMxNC5udW1fcXVldWVzID0gKHFwZC0+aXNfZGVidWcpID8gMCA6IHFwZC0+cXVl
dWVfY291bnQ7Ci0KLQlwYWNrZXQtPnNoX21lbV9jb25maWcgPSBxcGQtPnNoX21lbV9jb25maWc7
Ci0JcGFja2V0LT5zaF9tZW1fYmFzZXMgPSBxcGQtPnNoX21lbV9iYXNlczsKLQlpZiAocXBkLT50
YmFfYWRkcikgewotCQlwYWNrZXQtPnNxX3NoYWRlcl90YmFfbG8gPSBsb3dlcl8zMl9iaXRzKHFw
ZC0+dGJhX2FkZHIgPj4gOCk7Ci0JCXBhY2tldC0+c3Ffc2hhZGVyX3RiYV9oaSA9ICgxIDw8IFNR
X1NIQURFUl9UQkFfSElfX1RSQVBfRU5fX1NISUZUKSB8Ci0JCQl1cHBlcl8zMl9iaXRzKHFwZC0+
dGJhX2FkZHIgPj4gOCk7Ci0JCXBhY2tldC0+c3Ffc2hhZGVyX3RtYV9sbyA9IGxvd2VyXzMyX2Jp
dHMocXBkLT50bWFfYWRkciA+PiA4KTsKLQkJcGFja2V0LT5zcV9zaGFkZXJfdG1hX2hpID0gdXBw
ZXJfMzJfYml0cyhxcGQtPnRtYV9hZGRyID4+IDgpOwotCX0KLQotCXBhY2tldC0+Z2RzX2FkZHJf
bG8gPSBsb3dlcl8zMl9iaXRzKHFwZC0+Z2RzX2NvbnRleHRfYXJlYSk7Ci0JcGFja2V0LT5nZHNf
YWRkcl9oaSA9IHVwcGVyXzMyX2JpdHMocXBkLT5nZHNfY29udGV4dF9hcmVhKTsKLQotCXBhY2tl
dC0+dm1fY29udGV4dF9wYWdlX3RhYmxlX2Jhc2VfYWRkcl9sbzMyID0KLQkJCWxvd2VyXzMyX2Jp
dHModm1fcGFnZV90YWJsZV9iYXNlX2FkZHIpOwotCXBhY2tldC0+dm1fY29udGV4dF9wYWdlX3Rh
YmxlX2Jhc2VfYWRkcl9oaTMyID0KLQkJCXVwcGVyXzMyX2JpdHModm1fcGFnZV90YWJsZV9iYXNl
X2FkZHIpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgcG1fcnVubGlzdF92MTAoc3Ry
dWN0IHBhY2tldF9tYW5hZ2VyICpwbSwgdWludDMyX3QgKmJ1ZmZlciwKLQkJCXVpbnQ2NF90IGli
LCBzaXplX3QgaWJfc2l6ZV9pbl9kd29yZHMsIGJvb2wgY2hhaW4pCi17Ci0Jc3RydWN0IHBtNF9t
ZXNfcnVubGlzdCAqcGFja2V0OwotCi0JaW50IGNvbmN1cnJlbnRfcHJvY19jbnQgPSAwOwotCXN0
cnVjdCBrZmRfZGV2ICprZmQgPSBwbS0+ZHFtLT5kZXY7Ci0KLQkvKiBEZXRlcm1pbmUgdGhlIG51
bWJlciBvZiBwcm9jZXNzZXMgdG8gbWFwIHRvZ2V0aGVyIHRvIEhXOgotCSAqIGl0IGNhbiBub3Qg
ZXhjZWVkIHRoZSBudW1iZXIgb2YgVk1JRHMgYXZhaWxhYmxlIHRvIHRoZQotCSAqIHNjaGVkdWxl
ciwgYW5kIGl0IGlzIGRldGVybWluZWQgYnkgdGhlIHNtYWxsZXIgb2YgdGhlIG51bWJlcgotCSAq
IG9mIHByb2Nlc3NlcyBpbiB0aGUgcnVubGlzdCBhbmQga2ZkIG1vZHVsZSBwYXJhbWV0ZXIKLQkg
KiBod3NfbWF4X2NvbmNfcHJvYy4KLQkgKiBOb3RlOiB0aGUgYXJiaXRyYXRpb24gYmV0d2VlbiB0
aGUgbnVtYmVyIG9mIFZNSURzIGFuZAotCSAqIGh3c19tYXhfY29uY19wcm9jIGhhcyBiZWVuIGRv
bmUgaW4KLQkgKiBrZ2Qya2ZkX2RldmljZV9pbml0KCkuCi0JICovCi0JY29uY3VycmVudF9wcm9j
X2NudCA9IG1pbihwbS0+ZHFtLT5wcm9jZXNzZXNfY291bnQsCi0JCQlrZmQtPm1heF9wcm9jX3Bl
cl9xdWFudHVtKTsKLQotCi0JcGFja2V0ID0gKHN0cnVjdCBwbTRfbWVzX3J1bmxpc3QgKilidWZm
ZXI7Ci0KLQltZW1zZXQoYnVmZmVyLCAwLCBzaXplb2Yoc3RydWN0IHBtNF9tZXNfcnVubGlzdCkp
OwotCXBhY2tldC0+aGVhZGVyLnUzMkFsbCA9IHBtX2J1aWxkX3BtNF9oZWFkZXIoSVRfUlVOX0xJ
U1QsCi0JCQkJCQlzaXplb2Yoc3RydWN0IHBtNF9tZXNfcnVubGlzdCkpOwotCi0JcGFja2V0LT5i
aXRmaWVsZHM0LmliX3NpemUgPSBpYl9zaXplX2luX2R3b3JkczsKLQlwYWNrZXQtPmJpdGZpZWxk
czQuY2hhaW4gPSBjaGFpbiA/IDEgOiAwOwotCXBhY2tldC0+Yml0ZmllbGRzNC5vZmZsb2FkX3Bv
bGxpbmcgPSAwOwotCXBhY2tldC0+Yml0ZmllbGRzNC52YWxpZCA9IDE7Ci0JcGFja2V0LT5iaXRm
aWVsZHM0LnByb2Nlc3NfY250ID0gY29uY3VycmVudF9wcm9jX2NudDsKLQlwYWNrZXQtPm9yZGlu
YWwyID0gbG93ZXJfMzJfYml0cyhpYik7Ci0JcGFja2V0LT5pYl9iYXNlX2hpID0gdXBwZXJfMzJf
Yml0cyhpYik7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBwbV9tYXBfcXVldWVzX3Yx
MChzdHJ1Y3QgcGFja2V0X21hbmFnZXIgKnBtLCB1aW50MzJfdCAqYnVmZmVyLAotCQlzdHJ1Y3Qg
cXVldWUgKnEsIGJvb2wgaXNfc3RhdGljKQotewotCXN0cnVjdCBwbTRfbWVzX21hcF9xdWV1ZXMg
KnBhY2tldDsKLQlib29sIHVzZV9zdGF0aWMgPSBpc19zdGF0aWM7Ci0KLQlwYWNrZXQgPSAoc3Ry
dWN0IHBtNF9tZXNfbWFwX3F1ZXVlcyAqKWJ1ZmZlcjsKLQltZW1zZXQoYnVmZmVyLCAwLCBzaXpl
b2Yoc3RydWN0IHBtNF9tZXNfbWFwX3F1ZXVlcykpOwotCi0JcGFja2V0LT5oZWFkZXIudTMyQWxs
ID0gcG1fYnVpbGRfcG00X2hlYWRlcihJVF9NQVBfUVVFVUVTLAotCQkJCQlzaXplb2Yoc3RydWN0
IHBtNF9tZXNfbWFwX3F1ZXVlcykpOwotCXBhY2tldC0+Yml0ZmllbGRzMi5udW1fcXVldWVzID0g
MTsKLQlwYWNrZXQtPmJpdGZpZWxkczIucXVldWVfc2VsID0KLQkJcXVldWVfc2VsX19tZXNfbWFw
X3F1ZXVlc19fbWFwX3RvX2h3c19kZXRlcm1pbmVkX3F1ZXVlX3Nsb3RzX3ZpOwotCi0JcGFja2V0
LT5iaXRmaWVsZHMyLmVuZ2luZV9zZWwgPQotCQllbmdpbmVfc2VsX19tZXNfbWFwX3F1ZXVlc19f
Y29tcHV0ZV92aTsKLQlwYWNrZXQtPmJpdGZpZWxkczIucXVldWVfdHlwZSA9Ci0JCXF1ZXVlX3R5
cGVfX21lc19tYXBfcXVldWVzX19ub3JtYWxfY29tcHV0ZV92aTsKLQotCXN3aXRjaCAocS0+cHJv
cGVydGllcy50eXBlKSB7Ci0JY2FzZSBLRkRfUVVFVUVfVFlQRV9DT01QVVRFOgotCQlpZiAodXNl
X3N0YXRpYykKLQkJCXBhY2tldC0+Yml0ZmllbGRzMi5xdWV1ZV90eXBlID0KLQkJcXVldWVfdHlw
ZV9fbWVzX21hcF9xdWV1ZXNfX25vcm1hbF9sYXRlbmN5X3N0YXRpY19xdWV1ZV92aTsKLQkJYnJl
YWs7Ci0JY2FzZSBLRkRfUVVFVUVfVFlQRV9ESVE6Ci0JCXBhY2tldC0+Yml0ZmllbGRzMi5xdWV1
ZV90eXBlID0KLQkJCXF1ZXVlX3R5cGVfX21lc19tYXBfcXVldWVzX19kZWJ1Z19pbnRlcmZhY2Vf
cXVldWVfdmk7Ci0JCWJyZWFrOwotCWNhc2UgS0ZEX1FVRVVFX1RZUEVfU0RNQToKLQljYXNlIEtG
RF9RVUVVRV9UWVBFX1NETUFfWEdNSToKLQkJcGFja2V0LT5iaXRmaWVsZHMyLmVuZ2luZV9zZWwg
PSBxLT5wcm9wZXJ0aWVzLnNkbWFfZW5naW5lX2lkICsKLQkJCQllbmdpbmVfc2VsX19tZXNfbWFw
X3F1ZXVlc19fc2RtYTBfdmk7Ci0JCXVzZV9zdGF0aWMgPSBmYWxzZTsgLyogbm8gc3RhdGljIHF1
ZXVlcyB1bmRlciBTRE1BICovCi0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCVdBUk4oMSwgInF1ZXVl
IHR5cGUgJWRcbiIsIHEtPnByb3BlcnRpZXMudHlwZSk7Ci0JCXJldHVybiAtRUlOVkFMOwotCX0K
LQlwYWNrZXQtPmJpdGZpZWxkczMuZG9vcmJlbGxfb2Zmc2V0ID0KLQkJCXEtPnByb3BlcnRpZXMu
ZG9vcmJlbGxfb2ZmOwotCi0JcGFja2V0LT5tcWRfYWRkcl9sbyA9Ci0JCQlsb3dlcl8zMl9iaXRz
KHEtPmdhcnRfbXFkX2FkZHIpOwotCi0JcGFja2V0LT5tcWRfYWRkcl9oaSA9Ci0JCQl1cHBlcl8z
Ml9iaXRzKHEtPmdhcnRfbXFkX2FkZHIpOwotCi0JcGFja2V0LT53cHRyX2FkZHJfbG8gPQotCQkJ
bG93ZXJfMzJfYml0cygodWludDY0X3QpcS0+cHJvcGVydGllcy53cml0ZV9wdHIpOwotCi0JcGFj
a2V0LT53cHRyX2FkZHJfaGkgPQotCQkJdXBwZXJfMzJfYml0cygodWludDY0X3QpcS0+cHJvcGVy
dGllcy53cml0ZV9wdHIpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgcG1fdW5tYXBf
cXVldWVzX3YxMChzdHJ1Y3QgcGFja2V0X21hbmFnZXIgKnBtLCB1aW50MzJfdCAqYnVmZmVyLAot
CQkJZW51bSBrZmRfcXVldWVfdHlwZSB0eXBlLAotCQkJZW51bSBrZmRfdW5tYXBfcXVldWVzX2Zp
bHRlciBmaWx0ZXIsCi0JCQl1aW50MzJfdCBmaWx0ZXJfcGFyYW0sIGJvb2wgcmVzZXQsCi0JCQl1
bnNpZ25lZCBpbnQgc2RtYV9lbmdpbmUpCi17Ci0Jc3RydWN0IHBtNF9tZXNfdW5tYXBfcXVldWVz
ICpwYWNrZXQ7Ci0KLQlwYWNrZXQgPSAoc3RydWN0IHBtNF9tZXNfdW5tYXBfcXVldWVzICopYnVm
ZmVyOwotCW1lbXNldChidWZmZXIsIDAsIHNpemVvZihzdHJ1Y3QgcG00X21lc191bm1hcF9xdWV1
ZXMpKTsKLQotCXBhY2tldC0+aGVhZGVyLnUzMkFsbCA9IHBtX2J1aWxkX3BtNF9oZWFkZXIoSVRf
VU5NQVBfUVVFVUVTLAotCQkJCQlzaXplb2Yoc3RydWN0IHBtNF9tZXNfdW5tYXBfcXVldWVzKSk7
Ci0Jc3dpdGNoICh0eXBlKSB7Ci0JY2FzZSBLRkRfUVVFVUVfVFlQRV9DT01QVVRFOgotCWNhc2Ug
S0ZEX1FVRVVFX1RZUEVfRElROgotCQlwYWNrZXQtPmJpdGZpZWxkczIuZW5naW5lX3NlbCA9Ci0J
CQllbmdpbmVfc2VsX19tZXNfdW5tYXBfcXVldWVzX19jb21wdXRlOwotCQlicmVhazsKLQljYXNl
IEtGRF9RVUVVRV9UWVBFX1NETUE6Ci0JY2FzZSBLRkRfUVVFVUVfVFlQRV9TRE1BX1hHTUk6Ci0J
CXBhY2tldC0+Yml0ZmllbGRzMi5lbmdpbmVfc2VsID0KLQkJCWVuZ2luZV9zZWxfX21lc191bm1h
cF9xdWV1ZXNfX3NkbWEwICsgc2RtYV9lbmdpbmU7Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCVdB
Uk4oMSwgInF1ZXVlIHR5cGUgJWRcbiIsIHR5cGUpOwotCQlicmVhazsKLQl9Ci0KLQlpZiAocmVz
ZXQpCi0JCXBhY2tldC0+Yml0ZmllbGRzMi5hY3Rpb24gPQotCQkJYWN0aW9uX19tZXNfdW5tYXBf
cXVldWVzX19yZXNldF9xdWV1ZXM7Ci0JZWxzZQotCQlwYWNrZXQtPmJpdGZpZWxkczIuYWN0aW9u
ID0KLQkJCWFjdGlvbl9fbWVzX3VubWFwX3F1ZXVlc19fcHJlZW1wdF9xdWV1ZXM7Ci0KLQlzd2l0
Y2ggKGZpbHRlcikgewotCWNhc2UgS0ZEX1VOTUFQX1FVRVVFU19GSUxURVJfU0lOR0xFX1FVRVVF
OgotCQlwYWNrZXQtPmJpdGZpZWxkczIucXVldWVfc2VsID0KLQkJCXF1ZXVlX3NlbF9fbWVzX3Vu
bWFwX3F1ZXVlc19fcGVyZm9ybV9yZXF1ZXN0X29uX3NwZWNpZmllZF9xdWV1ZXM7Ci0JCXBhY2tl
dC0+Yml0ZmllbGRzMi5udW1fcXVldWVzID0gMTsKLQkJcGFja2V0LT5iaXRmaWVsZHMzYi5kb29y
YmVsbF9vZmZzZXQwID0gZmlsdGVyX3BhcmFtOwotCQlicmVhazsKLQljYXNlIEtGRF9VTk1BUF9R
VUVVRVNfRklMVEVSX0JZX1BBU0lEOgotCQlwYWNrZXQtPmJpdGZpZWxkczIucXVldWVfc2VsID0K
LQkJCXF1ZXVlX3NlbF9fbWVzX3VubWFwX3F1ZXVlc19fcGVyZm9ybV9yZXF1ZXN0X29uX3Bhc2lk
X3F1ZXVlczsKLQkJcGFja2V0LT5iaXRmaWVsZHMzYS5wYXNpZCA9IGZpbHRlcl9wYXJhbTsKLQkJ
YnJlYWs7Ci0JY2FzZSBLRkRfVU5NQVBfUVVFVUVTX0ZJTFRFUl9BTExfUVVFVUVTOgotCQlwYWNr
ZXQtPmJpdGZpZWxkczIucXVldWVfc2VsID0KLQkJCXF1ZXVlX3NlbF9fbWVzX3VubWFwX3F1ZXVl
c19fdW5tYXBfYWxsX3F1ZXVlczsKLQkJYnJlYWs7Ci0JY2FzZSBLRkRfVU5NQVBfUVVFVUVTX0ZJ
TFRFUl9EWU5BTUlDX1FVRVVFUzoKLQkJLyogaW4gdGhpcyBjYXNlLCB3ZSBkbyBub3QgcHJlZW1w
dCBzdGF0aWMgcXVldWVzICovCi0JCXBhY2tldC0+Yml0ZmllbGRzMi5xdWV1ZV9zZWwgPQotCQkJ
cXVldWVfc2VsX19tZXNfdW5tYXBfcXVldWVzX191bm1hcF9hbGxfbm9uX3N0YXRpY19xdWV1ZXM7
Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCVdBUk4oMSwgImZpbHRlciAlZFxuIiwgZmlsdGVyKTsK
LQkJYnJlYWs7Ci0JfQotCi0JcmV0dXJuIDA7Ci0KLX0KLQotc3RhdGljIGludCBwbV9xdWVyeV9z
dGF0dXNfdjEwKHN0cnVjdCBwYWNrZXRfbWFuYWdlciAqcG0sIHVpbnQzMl90ICpidWZmZXIsCi0J
CQl1aW50NjRfdCBmZW5jZV9hZGRyZXNzLAl1aW50MzJfdCBmZW5jZV92YWx1ZSkKLXsKLQlzdHJ1
Y3QgcG00X21lc19xdWVyeV9zdGF0dXMgKnBhY2tldDsKLQotCXBhY2tldCA9IChzdHJ1Y3QgcG00
X21lc19xdWVyeV9zdGF0dXMgKilidWZmZXI7Ci0JbWVtc2V0KGJ1ZmZlciwgMCwgc2l6ZW9mKHN0
cnVjdCBwbTRfbWVzX3F1ZXJ5X3N0YXR1cykpOwotCi0KLQlwYWNrZXQtPmhlYWRlci51MzJBbGwg
PSBwbV9idWlsZF9wbTRfaGVhZGVyKElUX1FVRVJZX1NUQVRVUywKLQkJCQkJc2l6ZW9mKHN0cnVj
dCBwbTRfbWVzX3F1ZXJ5X3N0YXR1cykpOwotCi0JcGFja2V0LT5iaXRmaWVsZHMyLmNvbnRleHRf
aWQgPSAwOwotCXBhY2tldC0+Yml0ZmllbGRzMi5pbnRlcnJ1cHRfc2VsID0KLQkJCWludGVycnVw
dF9zZWxfX21lc19xdWVyeV9zdGF0dXNfX2NvbXBsZXRpb25fc3RhdHVzOwotCXBhY2tldC0+Yml0
ZmllbGRzMi5jb21tYW5kID0KLQkJCWNvbW1hbmRfX21lc19xdWVyeV9zdGF0dXNfX2ZlbmNlX29u
bHlfYWZ0ZXJfd3JpdGVfYWNrOwotCi0JcGFja2V0LT5hZGRyX2hpID0gdXBwZXJfMzJfYml0cygo
dWludDY0X3QpZmVuY2VfYWRkcmVzcyk7Ci0JcGFja2V0LT5hZGRyX2xvID0gbG93ZXJfMzJfYml0
cygodWludDY0X3QpZmVuY2VfYWRkcmVzcyk7Ci0JcGFja2V0LT5kYXRhX2hpID0gdXBwZXJfMzJf
Yml0cygodWludDY0X3QpZmVuY2VfdmFsdWUpOwotCXBhY2tldC0+ZGF0YV9sbyA9IGxvd2VyXzMy
X2JpdHMoKHVpbnQ2NF90KWZlbmNlX3ZhbHVlKTsKLQotCXJldHVybiAwOwotfQotCi1jb25zdCBz
dHJ1Y3QgcGFja2V0X21hbmFnZXJfZnVuY3Mga2ZkX3YxMF9wbV9mdW5jcyA9IHsKLQkubWFwX3By
b2Nlc3MJCQk9IHBtX21hcF9wcm9jZXNzX3YxMCwKLQkucnVubGlzdAkJCT0gcG1fcnVubGlzdF92
MTAsCi0JLnNldF9yZXNvdXJjZXMJCQk9IHBtX3NldF9yZXNvdXJjZXNfdmksCi0JLm1hcF9xdWV1
ZXMJCQk9IHBtX21hcF9xdWV1ZXNfdjEwLAotCS51bm1hcF9xdWV1ZXMJCQk9IHBtX3VubWFwX3F1
ZXVlc192MTAsCi0JLnF1ZXJ5X3N0YXR1cwkJCT0gcG1fcXVlcnlfc3RhdHVzX3YxMCwKLQkucmVs
ZWFzZV9tZW0JCQk9IE5VTEwsCi0JLm1hcF9wcm9jZXNzX3NpemUJCT0gc2l6ZW9mKHN0cnVjdCBw
bTRfbWVzX21hcF9wcm9jZXNzKSwKLQkucnVubGlzdF9zaXplCQkJPSBzaXplb2Yoc3RydWN0IHBt
NF9tZXNfcnVubGlzdCksCi0JLnNldF9yZXNvdXJjZXNfc2l6ZQkJPSBzaXplb2Yoc3RydWN0IHBt
NF9tZXNfc2V0X3Jlc291cmNlcyksCi0JLm1hcF9xdWV1ZXNfc2l6ZQkJPSBzaXplb2Yoc3RydWN0
IHBtNF9tZXNfbWFwX3F1ZXVlcyksCi0JLnVubWFwX3F1ZXVlc19zaXplCQk9IHNpemVvZihzdHJ1
Y3QgcG00X21lc191bm1hcF9xdWV1ZXMpLAotCS5xdWVyeV9zdGF0dXNfc2l6ZQkJPSBzaXplb2Yo
c3RydWN0IHBtNF9tZXNfcXVlcnlfc3RhdHVzKSwKLQkucmVsZWFzZV9tZW1fc2l6ZQkJPSAwLAot
fTsKLQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2tlcm5lbF9x
dWV1ZV92OS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2tlcm5lbF9xdWV1ZV92
OS5jCmluZGV4IGYwZTQ5MTBhODg2NS4uOTRkNTlhMjU2MDA3IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVlX3Y5LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRrZmQva2ZkX2tlcm5lbF9xdWV1ZV92OS5jCkBAIC0yNSw2ICsyNSw3IEBA
CiAjaW5jbHVkZSAia2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmgiCiAjaW5jbHVkZSAia2ZkX3Bt
NF9oZWFkZXJzX2FpLmgiCiAjaW5jbHVkZSAia2ZkX3BtNF9vcGNvZGVzLmgiCisjaW5jbHVkZSAi
Z2MvZ2NfMTBfMV8wX3NoX21hc2suaCIKIAogc3RhdGljIGJvb2wgaW5pdGlhbGl6ZV92OShzdHJ1
Y3Qga2VybmVsX3F1ZXVlICprcSwgc3RydWN0IGtmZF9kZXYgKmRldiwKIAkJCWVudW0ga2ZkX3F1
ZXVlX3R5cGUgdHlwZSwgdW5zaWduZWQgaW50IHF1ZXVlX3NpemUpCkBAIC02Miw4ICs2Myw5IEBA
IHZvaWQga2VybmVsX3F1ZXVlX2luaXRfdjkoc3RydWN0IGtlcm5lbF9xdWV1ZV9vcHMgKm9wcykK
IAlvcHMtPnN1Ym1pdF9wYWNrZXQgPSBzdWJtaXRfcGFja2V0X3Y5OwogfQogCi1zdGF0aWMgaW50
IHBtX21hcF9wcm9jZXNzX3Y5KHN0cnVjdCBwYWNrZXRfbWFuYWdlciAqcG0sCi0JCXVpbnQzMl90
ICpidWZmZXIsIHN0cnVjdCBxY21fcHJvY2Vzc19kZXZpY2UgKnFwZCkKK3N0YXRpYyBpbnQgcG1f
bWFwX3Byb2Nlc3NfdjlfYmFzZShzdHJ1Y3QgcGFja2V0X21hbmFnZXIgKnBtLAorCQl1aW50MzJf
dCAqYnVmZmVyLCBzdHJ1Y3QgcWNtX3Byb2Nlc3NfZGV2aWNlICpxcGQsCisJCXVuc2lnbmVkIGlu
dCBzcV9zaGFkZXJfdGJhX2hpX3RyYXBfZW4pCiB7CiAJc3RydWN0IHBtNF9tZXNfbWFwX3Byb2Nl
c3MgKnBhY2tldDsKIAl1aW50NjRfdCB2bV9wYWdlX3RhYmxlX2Jhc2VfYWRkciA9IHFwZC0+cGFn
ZV90YWJsZV9iYXNlOwpAQCAtODUsMTAgKzg3LDE0IEBAIHN0YXRpYyBpbnQgcG1fbWFwX3Byb2Nl
c3Nfdjkoc3RydWN0IHBhY2tldF9tYW5hZ2VyICpwbSwKIAogCXBhY2tldC0+c2hfbWVtX2NvbmZp
ZyA9IHFwZC0+c2hfbWVtX2NvbmZpZzsKIAlwYWNrZXQtPnNoX21lbV9iYXNlcyA9IHFwZC0+c2hf
bWVtX2Jhc2VzOwotCXBhY2tldC0+c3Ffc2hhZGVyX3RiYV9sbyA9IGxvd2VyXzMyX2JpdHMocXBk
LT50YmFfYWRkciA+PiA4KTsKLQlwYWNrZXQtPnNxX3NoYWRlcl90YmFfaGkgPSB1cHBlcl8zMl9i
aXRzKHFwZC0+dGJhX2FkZHIgPj4gOCk7Ci0JcGFja2V0LT5zcV9zaGFkZXJfdG1hX2xvID0gbG93
ZXJfMzJfYml0cyhxcGQtPnRtYV9hZGRyID4+IDgpOwotCXBhY2tldC0+c3Ffc2hhZGVyX3RtYV9o
aSA9IHVwcGVyXzMyX2JpdHMocXBkLT50bWFfYWRkciA+PiA4KTsKKwlpZiAocXBkLT50YmFfYWRk
cikgeworCQlwYWNrZXQtPnNxX3NoYWRlcl90YmFfbG8gPSBsb3dlcl8zMl9iaXRzKHFwZC0+dGJh
X2FkZHIgPj4gOCk7CisJCXBhY2tldC0+c3Ffc2hhZGVyX3RiYV9oaSA9IHVwcGVyXzMyX2JpdHMo
cXBkLT50YmFfYWRkciA+PiA4KQorCQkJCXwgc3Ffc2hhZGVyX3RiYV9oaV90cmFwX2VuOworCisJ
CXBhY2tldC0+c3Ffc2hhZGVyX3RtYV9sbyA9IGxvd2VyXzMyX2JpdHMocXBkLT50bWFfYWRkciA+
PiA4KTsKKwkJcGFja2V0LT5zcV9zaGFkZXJfdG1hX2hpID0gdXBwZXJfMzJfYml0cyhxcGQtPnRt
YV9hZGRyID4+IDgpOworCX0KIAogCXBhY2tldC0+Z2RzX2FkZHJfbG8gPSBsb3dlcl8zMl9iaXRz
KHFwZC0+Z2RzX2NvbnRleHRfYXJlYSk7CiAJcGFja2V0LT5nZHNfYWRkcl9oaSA9IHVwcGVyXzMy
X2JpdHMocXBkLT5nZHNfY29udGV4dF9hcmVhKTsKQEAgLTEwMSw2ICsxMDcsMTIgQEAgc3RhdGlj
IGludCBwbV9tYXBfcHJvY2Vzc192OShzdHJ1Y3QgcGFja2V0X21hbmFnZXIgKnBtLAogCXJldHVy
biAwOwogfQogCitzdGF0aWMgaW50IHBtX21hcF9wcm9jZXNzX3Y5KHN0cnVjdCBwYWNrZXRfbWFu
YWdlciAqcG0sCisJCXVpbnQzMl90ICpidWZmZXIsIHN0cnVjdCBxY21fcHJvY2Vzc19kZXZpY2Ug
KnFwZCkKK3sKKwlyZXR1cm4gcG1fbWFwX3Byb2Nlc3NfdjlfYmFzZShwbSwgYnVmZmVyLCBxcGQs
IDApOworfQorCiBzdGF0aWMgaW50IHBtX3J1bmxpc3Rfdjkoc3RydWN0IHBhY2tldF9tYW5hZ2Vy
ICpwbSwgdWludDMyX3QgKmJ1ZmZlciwKIAkJCXVpbnQ2NF90IGliLCBzaXplX3QgaWJfc2l6ZV9p
bl9kd29yZHMsIGJvb2wgY2hhaW4pCiB7CkBAIC0zNTIsMyArMzY0LDI3IEBAIGNvbnN0IHN0cnVj
dCBwYWNrZXRfbWFuYWdlcl9mdW5jcyBrZmRfdjlfcG1fZnVuY3MgPSB7CiAJLnF1ZXJ5X3N0YXR1
c19zaXplCT0gc2l6ZW9mKHN0cnVjdCBwbTRfbWVzX3F1ZXJ5X3N0YXR1cyksCiAJLnJlbGVhc2Vf
bWVtX3NpemUJPSAwLAogfTsKKworc3RhdGljIGludCBwbV9tYXBfcHJvY2Vzc192MTAoc3RydWN0
IHBhY2tldF9tYW5hZ2VyICpwbSwKKwkJdWludDMyX3QgKmJ1ZmZlciwgc3RydWN0IHFjbV9wcm9j
ZXNzX2RldmljZSAqcXBkKQoreworCXJldHVybiBwbV9tYXBfcHJvY2Vzc192OV9iYXNlKHBtLCBi
dWZmZXIsIHFwZCwKKwkJCTEgPDwgU1FfU0hBREVSX1RCQV9ISV9fVFJBUF9FTl9fU0hJRlQpOwor
fQorCitjb25zdCBzdHJ1Y3QgcGFja2V0X21hbmFnZXJfZnVuY3Mga2ZkX3YxMF9wbV9mdW5jcyA9
IHsKKwkubWFwX3Byb2Nlc3MJCT0gcG1fbWFwX3Byb2Nlc3NfdjEwLAorCS5ydW5saXN0CQk9IHBt
X3J1bmxpc3RfdjksCisJLnNldF9yZXNvdXJjZXMJCT0gcG1fc2V0X3Jlc291cmNlc192OSwKKwku
bWFwX3F1ZXVlcwkJPSBwbV9tYXBfcXVldWVzX3Y5LAorCS51bm1hcF9xdWV1ZXMJCT0gcG1fdW5t
YXBfcXVldWVzX3Y5LAorCS5xdWVyeV9zdGF0dXMJCT0gcG1fcXVlcnlfc3RhdHVzX3Y5LAorCS5y
ZWxlYXNlX21lbQkJPSBOVUxMLAorCS5tYXBfcHJvY2Vzc19zaXplCT0gc2l6ZW9mKHN0cnVjdCBw
bTRfbWVzX21hcF9wcm9jZXNzKSwKKwkucnVubGlzdF9zaXplCQk9IHNpemVvZihzdHJ1Y3QgcG00
X21lc19ydW5saXN0KSwKKwkuc2V0X3Jlc291cmNlc19zaXplCT0gc2l6ZW9mKHN0cnVjdCBwbTRf
bWVzX3NldF9yZXNvdXJjZXMpLAorCS5tYXBfcXVldWVzX3NpemUJPSBzaXplb2Yoc3RydWN0IHBt
NF9tZXNfbWFwX3F1ZXVlcyksCisJLnVubWFwX3F1ZXVlc19zaXplCT0gc2l6ZW9mKHN0cnVjdCBw
bTRfbWVzX3VubWFwX3F1ZXVlcyksCisJLnF1ZXJ5X3N0YXR1c19zaXplCT0gc2l6ZW9mKHN0cnVj
dCBwbTRfbWVzX3F1ZXJ5X3N0YXR1cyksCisJLnJlbGVhc2VfbWVtX3NpemUJPSAwLAorfTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9wcml2LmggYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfcHJpdi5oCmluZGV4IDYyZGI0ZDIwZWQzMi4uNTEyN2Rk
ZWUyNGM4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfcHJpdi5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9wcml2LmgKQEAgLTk5Niw5ICs5
OTYsNiBAQCB2b2lkIHBtX3JlbGVhc2VfaWIoc3RydWN0IHBhY2tldF9tYW5hZ2VyICpwbSk7CiAK
IC8qIEZvbGxvd2luZyBQTSBmdW5jcyBjYW4gYmUgc2hhcmVkIGFtb25nIFZJIGFuZCBBSSAqLwog
dW5zaWduZWQgaW50IHBtX2J1aWxkX3BtNF9oZWFkZXIodW5zaWduZWQgaW50IG9wY29kZSwgc2l6
ZV90IHBhY2tldF9zaXplKTsKLWludCBwbV9zZXRfcmVzb3VyY2VzX3ZpKHN0cnVjdCBwYWNrZXRf
bWFuYWdlciAqcG0sIHVpbnQzMl90ICpidWZmZXIsCi0JCQlzdHJ1Y3Qgc2NoZWR1bGluZ19yZXNv
dXJjZXMgKnJlcyk7Ci0KIAogdWludDY0X3Qga2ZkX2dldF9udW1iZXJfZWxlbXMoc3RydWN0IGtm
ZF9kZXYgKmtmZCk7CiAKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9hbWQtZ2Z4
