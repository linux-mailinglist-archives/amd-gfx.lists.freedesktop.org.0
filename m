Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 98AD648DF6
	for <lists+amd-gfx@lfdr.de>; Mon, 17 Jun 2019 21:18:03 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C8E7C8941E;
	Mon, 17 Jun 2019 19:18:01 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qt1-x82e.google.com (mail-qt1-x82e.google.com
 [IPv6:2607:f8b0:4864:20::82e])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8E34B8945B
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:17:59 +0000 (UTC)
Received: by mail-qt1-x82e.google.com with SMTP id j19so12136104qtr.12
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 12:17:59 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=6tCEd9K0q1gxXluafxCt5fjFVb7RX6fiZOxSKap04Xc=;
 b=ZQpf/xB/D7XujXL51IJnX8sLREm5X2W0JgPk1AqAcs/MtWuFlxDbTDVGg1MAPU2N0x
 rzCajecP4q1nw9GW3PY8ZeNz016BiGOF8ojSRTNlxvCh5i7WCvtjkN1bMtkdma2bAtLL
 eSbX28ztcMOIFcNjIQTjqotNm3Zxvai789Y2FBioguHe/BcLQXWHgyDmy6/UjLQWeldh
 TnXuoU61xJ6MjDC1ZnRF3gIFL5C/LHMWCQZZQXS/0dWdDtUIHYWTwB1qhmNDCO4SrP9F
 CKpQfcL5shzLYuPdQOf8G+NdluIauqgeTML3J/LhIo9YoUUCpAARSZbgB31v1vm0iM6O
 h+Nw==
X-Gm-Message-State: APjAAAXMwoZy0kwCIAI4gtvKoXLWS1gh1qIOd+D9+/2RpgGSh1HhShPN
 b5XHbQEpU7XcrOChpLyH2rYp94gtTiU=
X-Google-Smtp-Source: APXvYqxg+LJfIrS634Gd7WQjEcUMNMYEz5ae3mL4Q02sH5k3KJCwEhpLJg8XXOVfgSjoD/ThOfyiog==
X-Received: by 2002:ac8:7549:: with SMTP id b9mr16902840qtr.198.1560799077706; 
 Mon, 17 Jun 2019 12:17:57 -0700 (PDT)
Received: from localhost.localdomain ([71.219.5.136])
 by smtp.gmail.com with ESMTPSA id s35sm7754876qth.79.2019.06.17.12.17.56
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 12:17:57 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 056/459] drm/amdgpu: add gmc v10 ip block for navi10 (v6)
Date: Mon, 17 Jun 2019 14:10:17 -0500
Message-Id: <20190617191700.17899-45-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617191700.17899-1-alexander.deucher@amd.com>
References: <20190617191700.17899-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=6tCEd9K0q1gxXluafxCt5fjFVb7RX6fiZOxSKap04Xc=;
 b=gKG3w2x/LILHacCp0KYl2HxZvv1wXSggKcmGBvdbT6GL3ZcI28jfAXhuNS+lCnu+8a
 BqAjPQQnpcm/dnWvTWloTLafOJ0zXK7mZzgfcjcSOOBMWGAKUAzWuYgnnPqEZmcd7Q1U
 NtdTenXrzzNaTbDtmnymqErTGIolUvjI/t22sTMDQ89NjDDhtjXwsweQZiV3fhTNMiSj
 l79BIzbyoQ5K0rN1Cd3Nr5A2rJFdCKPx+hLmg2YzEPF3jryjSKAl81zJBdrwM2ooCY2c
 i96hB9zYCPB8J2nN9Kn5JRq+E6sLada1hT0RHMw4AUjaCV1h2+aEEk16i3zk0Ag/CUjF
 DVag==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>, Huang Rui <ray.huang@amd.com>,
 Hawking Zhang <Hawking.Zhang@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogSGF3a2luZyBaaGFuZyA8SGF3a2luZy5aaGFuZ0BhbWQuY29tPgoKR01DIGluIHRoZSBH
UFUgbWVtb3J5IGNvbnRyb2xsZXIuCgp2MTogYWRkIHBsYWNlIGhvbGRlciBhbmQgaW5pdGlhbCBi
YXNpYyBpbXBsZW1lbnRhdGlvbiAoUmF5KQp2MjogcmV0aXJlIHVudXNlZCBhbWRncHVfZ2FydF9z
ZXRfZGVmYXVsdHMgKEhhd2tpbmcpCnYzOiByZS13b3JrIGdldF92bV9wZGUgZnVuY3Rpb24gKEhh
d2tpbmcpCnY0OiByZXBsYWNlIGxlZ2FjeSBhbWRncHVfdnJhbS9ndHRfbG9jYXRpb24gd2l0aAog
ICAgYW1kZ3B1X2dtY192cmFtL2d0dF9sb2NhdGlvbiAoSGF3a2luZykKdjU6IHNxdWFzaCBpbiB1
cGRhdGVzIChBbGV4KQp2NjogdXNlIGdldF92Ymlvc19mYl9zaXplIChBbGV4KQoKU2lnbmVkLW9m
Zi1ieTogSHVhbmcgUnVpIDxyYXkuaHVhbmdAYW1kLmNvbT4KU2lnbmVkLW9mZi1ieTogSGF3a2lu
ZyBaaGFuZyA8SGF3a2luZy5aaGFuZ0BhbWQuY29tPgpSZXZpZXdlZC1ieTogQWxleCBEZXVjaGVy
IDxhbGV4YW5kZXIuZGV1Y2hlckBhbWQuY29tPgpSZXZpZXdlZC1ieTogSGF3a2luZyBaaGFuZyA8
SGF3a2luZy5aaGFuZ0BhbWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBBbGV4IERldWNoZXIgPGFsZXhh
bmRlci5kZXVjaGVyQGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvTWFr
ZWZpbGUgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBfMC5j
IHwgOTE2ICsrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2dtY192MTBfMC5oIHwgIDMwICsKIDMgZmlsZXMgY2hhbmdlZCwgOTQ3IGluc2VydGlvbnMo
KyksIDEgZGVsZXRpb24oLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9nbWNfdjEwXzAuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2dtY192MTBfMC5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9NYWtlZmlsZQppbmRl
eCAzZTZhMTI2OTI2ZWUuLjcyNzY4MmI0NTNlOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvTWFr
ZWZpbGUKQEAgLTc2LDcgKzc2LDcgQEAgYW1kZ3B1LXkgKz0gXAogCWdtY192N18wLm8gXAogCWdt
Y192OF8wLm8gXAogCWdmeGh1Yl92MV8wLm8gbW1odWJfdjFfMC5vIGdtY192OV8wLm8gZ2Z4aHVi
X3YxXzEubyBcCi0JZ2Z4aHViX3YyXzAubyBtbWh1Yl92Ml8wLm8KKwlnZnhodWJfdjJfMC5vIG1t
aHViX3YyXzAubyBnbWNfdjEwXzAubwogCiAjIGFkZCBJSCBibG9jawogYW1kZ3B1LXkgKz0gXApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3YxMF8wLmMgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjEwXzAuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMDAwMDAuLmI0MTE2OTI2MWY3ZAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBfMC5jCkBAIC0wLDAgKzEsOTE2IEBACisvKgor
ICogQ29weXJpZ2h0IDIwMTkgQWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5jLgorICoKKyAqIFBl
cm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29u
IG9idGFpbmluZyBhCisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9j
dW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVhbCBpbiB0aGUgU29m
dHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgor
ICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3Ry
aWJ1dGUsIHN1YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJl
LCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlzIGZ1cm5p
c2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CisgKgor
ICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ug
c2hhbGwgYmUgaW5jbHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlv
bnMgb2YgdGhlIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMg
SVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVE
LCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5U
QUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZS
SU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIENPUFlSSUdIVCBIT0xERVIoUykg
T1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SCisgKiBPVEhF
UiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9U
SEVSV0lTRSwKKyAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBU
SEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgorICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRX
QVJFLgorICoKKyAqLworI2luY2x1ZGUgPGxpbnV4L2Zpcm13YXJlLmg+CisjaW5jbHVkZSAiYW1k
Z3B1LmgiCisjaW5jbHVkZSAiYW1kZ3B1X2F0b21maXJtd2FyZS5oIgorI2luY2x1ZGUgImdtY192
MTBfMC5oIgorCisjaW5jbHVkZSAiaGRwL2hkcF81XzBfMF9vZmZzZXQuaCIKKyNpbmNsdWRlICJo
ZHAvaGRwXzVfMF8wX3NoX21hc2suaCIKKyNpbmNsdWRlICJnYy9nY18xMF8xXzBfc2hfbWFzay5o
IgorI2luY2x1ZGUgIm1taHViL21taHViXzJfMF8wX3NoX21hc2suaCIKKyNpbmNsdWRlICJkY24v
ZGNuXzJfMF8wX29mZnNldC5oIgorI2luY2x1ZGUgImRjbi9kY25fMl8wXzBfc2hfbWFzay5oIgor
I2luY2x1ZGUgIm9zcy9vc3NzeXNfNV8wXzBfb2Zmc2V0LmgiCisjaW5jbHVkZSAiaXZzcmNpZC92
bWMvaXJxc3Jjc192bWNfMV8wLmgiCisjaW5jbHVkZSAibmF2aTEwX2VudW0uaCIKKworI2luY2x1
ZGUgInNvYzE1LmgiCisjaW5jbHVkZSAic29jMTVfY29tbW9uLmgiCisKKyNpbmNsdWRlICJuYmlv
X3YyXzMuaCIKKworI2luY2x1ZGUgImdmeGh1Yl92Ml8wLmgiCisjaW5jbHVkZSAibW1odWJfdjJf
MC5oIgorI2luY2x1ZGUgImF0aHViX3YyXzAuaCIKKy8qIFhYWCBNb3ZlIHRoaXMgbWFjcm8gdG8g
bmF2aTEwIGhlYWRlciBmaWxlLCB3aGljaCBpcyBsaWtlIHZpZC5oIGZvciBWSS4qLworI2RlZmlu
ZSBBTURHUFVfTlVNX09GX1ZNSURTCQkJOAorCisjaWYgMAorc3RhdGljIGNvbnN0IHN0cnVjdCBz
b2MxNV9yZWdfZ29sZGVuIGdvbGRlbl9zZXR0aW5nc19uYXZpMTBfaGRwW10gPQoreworCS8qIFRP
RE8gYWRkIGdvbGRlbiBzZXR0aW5nIGZvciBoZHAgKi8KK307CisjZW5kaWYKKworc3RhdGljIGlu
dAorZ21jX3YxMF8wX3ZtX2ZhdWx0X2ludGVycnVwdF9zdGF0ZShzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwKKwkJCQkgICBzdHJ1Y3QgYW1kZ3B1X2lycV9zcmMgKnNyYywgdW5zaWduZWQgdHlw
ZSwKKwkJCQkgICBlbnVtIGFtZGdwdV9pbnRlcnJ1cHRfc3RhdGUgc3RhdGUpCit7CisJc3RydWN0
IGFtZGdwdV92bWh1YiAqaHViOworCXUzMiB0bXAsIHJlZywgYml0c1tBTURHUFVfTUFYX1ZNSFVC
U10sIGk7CisKKwliaXRzW0FNREdQVV9HRlhIVUJdID0gR0NWTV9DT05URVhUMV9DTlRMX19SQU5H
RV9QUk9URUNUSU9OX0ZBVUxUX0VOQUJMRV9JTlRFUlJVUFRfTUFTSyB8CisJCUdDVk1fQ09OVEVY
VDFfQ05UTF9fRFVNTVlfUEFHRV9QUk9URUNUSU9OX0ZBVUxUX0VOQUJMRV9JTlRFUlJVUFRfTUFT
SyB8CisJCUdDVk1fQ09OVEVYVDFfQ05UTF9fUERFMF9QUk9URUNUSU9OX0ZBVUxUX0VOQUJMRV9J
TlRFUlJVUFRfTUFTSyB8CisJCUdDVk1fQ09OVEVYVDFfQ05UTF9fVkFMSURfUFJPVEVDVElPTl9G
QVVMVF9FTkFCTEVfSU5URVJSVVBUX01BU0sgfAorCQlHQ1ZNX0NPTlRFWFQxX0NOVExfX1JFQURf
UFJPVEVDVElPTl9GQVVMVF9FTkFCTEVfSU5URVJSVVBUX01BU0sgfAorCQlHQ1ZNX0NPTlRFWFQx
X0NOVExfX1dSSVRFX1BST1RFQ1RJT05fRkFVTFRfRU5BQkxFX0lOVEVSUlVQVF9NQVNLIHwKKwkJ
R0NWTV9DT05URVhUMV9DTlRMX19FWEVDVVRFX1BST1RFQ1RJT05fRkFVTFRfRU5BQkxFX0lOVEVS
UlVQVF9NQVNLOworCisJYml0c1tBTURHUFVfTU1IVUJdID0gTU1WTV9DT05URVhUMV9DTlRMX19S
QU5HRV9QUk9URUNUSU9OX0ZBVUxUX0VOQUJMRV9JTlRFUlJVUFRfTUFTSyB8CisJCU1NVk1fQ09O
VEVYVDFfQ05UTF9fRFVNTVlfUEFHRV9QUk9URUNUSU9OX0ZBVUxUX0VOQUJMRV9JTlRFUlJVUFRf
TUFTSyB8CisJCU1NVk1fQ09OVEVYVDFfQ05UTF9fUERFMF9QUk9URUNUSU9OX0ZBVUxUX0VOQUJM
RV9JTlRFUlJVUFRfTUFTSyB8CisJCU1NVk1fQ09OVEVYVDFfQ05UTF9fVkFMSURfUFJPVEVDVElP
Tl9GQVVMVF9FTkFCTEVfSU5URVJSVVBUX01BU0sgfAorCQlNTVZNX0NPTlRFWFQxX0NOVExfX1JF
QURfUFJPVEVDVElPTl9GQVVMVF9FTkFCTEVfSU5URVJSVVBUX01BU0sgfAorCQlNTVZNX0NPTlRF
WFQxX0NOVExfX1dSSVRFX1BST1RFQ1RJT05fRkFVTFRfRU5BQkxFX0lOVEVSUlVQVF9NQVNLIHwK
KwkJTU1WTV9DT05URVhUMV9DTlRMX19FWEVDVVRFX1BST1RFQ1RJT05fRkFVTFRfRU5BQkxFX0lO
VEVSUlVQVF9NQVNLOworCisJc3dpdGNoIChzdGF0ZSkgeworCWNhc2UgQU1ER1BVX0lSUV9TVEFU
RV9ESVNBQkxFOgorCQkvKiBNTSBIVUIgKi8KKwkJaHViID0gJmFkZXYtPnZtaHViW0FNREdQVV9N
TUhVQl07CisJCWZvciAoaSA9IDA7IGk8IDE2OyBpKyspIHsKKwkJCXJlZyA9IGh1Yi0+dm1fY29u
dGV4dDBfY250bCArIGk7CisJCQl0bXAgPSBSUkVHMzIocmVnKTsKKwkJCXRtcCAmPSB+Yml0c1tB
TURHUFVfTU1IVUJdOworCQkJV1JFRzMyKHJlZywgdG1wKTsKKwkJfQorCisJCS8qIEdGWCBIVUIg
Ki8KKwkJaHViID0gJmFkZXYtPnZtaHViW0FNREdQVV9HRlhIVUJdOworCQlmb3IgKGkgPSAwOyBp
IDwgMTY7IGkrKykgeworCQkJcmVnID0gaHViLT52bV9jb250ZXh0MF9jbnRsICsgaTsKKwkJCXRt
cCA9IFJSRUczMihyZWcpOworCQkJdG1wICY9IH5iaXRzW0FNREdQVV9HRlhIVUJdOworCQkJV1JF
RzMyKHJlZywgdG1wKTsKKwkJfQorCQlicmVhazsKKwljYXNlIEFNREdQVV9JUlFfU1RBVEVfRU5B
QkxFOgorCQkvKiBNTSBIVUIgKi8KKwkJaHViID0gJmFkZXYtPnZtaHViW0FNREdQVV9NTUhVQl07
CisJCWZvciAoaSA9IDA7IGk8IDE2OyBpKyspIHsKKwkJCXJlZyA9IGh1Yi0+dm1fY29udGV4dDBf
Y250bCArIGk7CisJCQl0bXAgPSBSUkVHMzIocmVnKTsKKwkJCXRtcCB8PSBiaXRzW0FNREdQVV9N
TUhVQl07CisJCQlXUkVHMzIocmVnLCB0bXApOworCQl9CisKKwkJLyogR0ZYIEhVQiAqLworCQlo
dWIgPSAmYWRldi0+dm1odWJbQU1ER1BVX0dGWEhVQl07CisJCWZvciAoaSA9IDA7IGkgPCAxNjsg
aSsrKSB7CisJCQlyZWcgPSBodWItPnZtX2NvbnRleHQwX2NudGwgKyBpOworCQkJdG1wID0gUlJF
RzMyKHJlZyk7CisJCQl0bXAgfD0gYml0c1tBTURHUFVfR0ZYSFVCXTsKKwkJCVdSRUczMihyZWcs
IHRtcCk7CisJCX0KKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJYnJlYWs7CisJfQorCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgZ21jX3YxMF8wX3Byb2Nlc3NfaW50ZXJydXB0KHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2LAorCQkJCSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2lycV9zcmMgKnNv
dXJjZSwKKwkJCQkgICAgICAgc3RydWN0IGFtZGdwdV9pdl9lbnRyeSAqZW50cnkpCit7CisJc3Ry
dWN0IGFtZGdwdV92bWh1YiAqaHViID0gJmFkZXYtPnZtaHViW2VudHJ5LT52bWlkX3NyY107CisJ
dWludDMyX3Qgc3RhdHVzID0gMDsKKwl1NjQgYWRkcjsKKworCWFkZHIgPSAodTY0KWVudHJ5LT5z
cmNfZGF0YVswXSA8PCAxMjsKKwlhZGRyIHw9ICgodTY0KWVudHJ5LT5zcmNfZGF0YVsxXSAmIDB4
ZikgPDwgNDQ7CisKKwlpZiAoIWFtZGdwdV9zcmlvdl92ZihhZGV2KSkgeworCQlzdGF0dXMgPSBS
UkVHMzIoaHViLT52bV9sMl9wcm9fZmF1bHRfc3RhdHVzKTsKKwkJV1JFRzMyX1AoaHViLT52bV9s
Ml9wcm9fZmF1bHRfY250bCwgMSwgfjEpOworCX0KKworCWlmIChwcmludGtfcmF0ZWxpbWl0KCkp
IHsKKwkJZGV2X2VycihhZGV2LT5kZXYsCisJCQkiWyVzXSBWTUMgcGFnZSBmYXVsdCAoc3JjX2lk
OiV1IHJpbmc6JXUgdm1pZDoldSBwYXNpZDoldSlcbiIsCisJCQllbnRyeS0+dm1pZF9zcmMgPyAi
bW1odWIiIDogImdmeGh1YiIsCisJCQllbnRyeS0+c3JjX2lkLCBlbnRyeS0+cmluZ19pZCwgZW50
cnktPnZtaWQsCisJCQllbnRyeS0+cGFzaWQpOworCQlkZXZfZXJyKGFkZXYtPmRldiwgIiAgYXQg
cGFnZSAweCUwMTZsbHggZnJvbSAlZFxuIiwKKwkJCWFkZHIsIGVudHJ5LT5jbGllbnRfaWQpOwor
CQlpZiAoIWFtZGdwdV9zcmlvdl92ZihhZGV2KSkKKwkJCWRldl9lcnIoYWRldi0+ZGV2LAorCQkJ
CSJWTV9MMl9QUk9URUNUSU9OX0ZBVUxUX1NUQVRVUzoweCUwOFhcbiIsCisJCQkJc3RhdHVzKTsK
Kwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBhbWRncHVfaXJxX3Ny
Y19mdW5jcyBnbWNfdjEwXzBfaXJxX2Z1bmNzID0geworCS5zZXQgPSBnbWNfdjEwXzBfdm1fZmF1
bHRfaW50ZXJydXB0X3N0YXRlLAorCS5wcm9jZXNzID0gZ21jX3YxMF8wX3Byb2Nlc3NfaW50ZXJy
dXB0LAorfTsKKworc3RhdGljIHZvaWQgZ21jX3YxMF8wX3NldF9pcnFfZnVuY3Moc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYpCit7CisJYWRldi0+Z21jLnZtX2ZhdWx0Lm51bV90eXBlcyA9IDE7
CisJYWRldi0+Z21jLnZtX2ZhdWx0LmZ1bmNzID0gJmdtY192MTBfMF9pcnFfZnVuY3M7Cit9CisK
K3N0YXRpYyB1aW50MzJfdCBnbWNfdjEwXzBfZ2V0X2ludmFsaWRhdGVfcmVxKHVuc2lnbmVkIGlu
dCB2bWlkLAorCQkJCQkgICAgIHVpbnQzMl90IGZsdXNoX3R5cGUpCit7CisJdTMyIHJlcSA9IDA7
CisKKwkvKiBpbnZhbGlkYXRlIHVzaW5nIGxlZ2FjeSBtb2RlIG9uIHZtaWQqLworCXJlcSA9IFJF
R19TRVRfRklFTEQocmVxLCBHQ1ZNX0lOVkFMSURBVEVfRU5HMF9SRVEsCisJCQkgICAgUEVSX1ZN
SURfSU5WQUxJREFURV9SRVEsIDEgPDwgdm1pZCk7CisJcmVxID0gUkVHX1NFVF9GSUVMRChyZXEs
IEdDVk1fSU5WQUxJREFURV9FTkcwX1JFUSwgRkxVU0hfVFlQRSwgZmx1c2hfdHlwZSk7CisJcmVx
ID0gUkVHX1NFVF9GSUVMRChyZXEsIEdDVk1fSU5WQUxJREFURV9FTkcwX1JFUSwgSU5WQUxJREFU
RV9MMl9QVEVTLCAxKTsKKwlyZXEgPSBSRUdfU0VUX0ZJRUxEKHJlcSwgR0NWTV9JTlZBTElEQVRF
X0VORzBfUkVRLCBJTlZBTElEQVRFX0wyX1BERTAsIDEpOworCXJlcSA9IFJFR19TRVRfRklFTEQo
cmVxLCBHQ1ZNX0lOVkFMSURBVEVfRU5HMF9SRVEsIElOVkFMSURBVEVfTDJfUERFMSwgMSk7CisJ
cmVxID0gUkVHX1NFVF9GSUVMRChyZXEsIEdDVk1fSU5WQUxJREFURV9FTkcwX1JFUSwgSU5WQUxJ
REFURV9MMl9QREUyLCAxKTsKKwlyZXEgPSBSRUdfU0VUX0ZJRUxEKHJlcSwgR0NWTV9JTlZBTElE
QVRFX0VORzBfUkVRLCBJTlZBTElEQVRFX0wxX1BURVMsIDEpOworCXJlcSA9IFJFR19TRVRfRklF
TEQocmVxLCBHQ1ZNX0lOVkFMSURBVEVfRU5HMF9SRVEsCisJCQkgICAgQ0xFQVJfUFJPVEVDVElP
Tl9GQVVMVF9TVEFUVVNfQUREUiwJMCk7CisKKwlyZXR1cm4gcmVxOworfQorCisvKgorICogR0FS
VAorICogVk1JRCAwIGlzIHRoZSBwaHlzaWNhbCBHUFUgYWRkcmVzc2VzIGFzIHVzZWQgYnkgdGhl
IGtlcm5lbC4KKyAqIFZNSURzIDEtMTUgYXJlIHVzZWQgZm9yIHVzZXJzcGFjZSBjbGllbnRzIGFu
ZCBhcmUgaGFuZGxlZAorICogYnkgdGhlIGFtZGdwdSB2bS9oc2EgY29kZS4KKyAqLworCitzdGF0
aWMgdm9pZCBnbWNfdjEwXzBfZmx1c2hfdm1faHViKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
LCB1aW50MzJfdCB2bWlkLAorCQkJCSAgIHVuc2lnbmVkIGludCB2bWh1YiwgdWludDMyX3QgZmx1
c2hfdHlwZSkKK3sKKwlzdHJ1Y3QgYW1kZ3B1X3ZtaHViICpodWIgPSAmYWRldi0+dm1odWJbdm1o
dWJdOworCXUzMiB0bXAgPSBnbWNfdjEwXzBfZ2V0X2ludmFsaWRhdGVfcmVxKHZtaWQsIGZsdXNo
X3R5cGUpOworCS8qIFVzZSByZWdpc3RlciAxNyBmb3IgR0FSVCAqLworCWNvbnN0IHVuc2lnbmVk
IGVuZyA9IDE3OworCXVuc2lnbmVkIGludCBpOworCisJV1JFRzMyX05PX0tJUShodWItPnZtX2lu
dl9lbmcwX3JlcSArIGVuZywgdG1wKTsKKworCS8qIFdhaXQgZm9yIEFDSyB3aXRoIGEgZGVsYXku
Ki8KKwlmb3IgKGkgPSAwOyBpIDwgYWRldi0+dXNlY190aW1lb3V0OyBpKyspIHsKKwkJdG1wID0g
UlJFRzMyX05PX0tJUShodWItPnZtX2ludl9lbmcwX2FjayArIGVuZyk7CisJCXRtcCAmPSAxIDw8
IHZtaWQ7CisJCWlmICh0bXApCisJCQlicmVhazsKKworCQl1ZGVsYXkoMSk7CisJfQorCisJaWYg
KGkgPCBhZGV2LT51c2VjX3RpbWVvdXQpCisJCXJldHVybjsKKworCURSTV9FUlJPUigiVGltZW91
dCB3YWl0aW5nIGZvciBWTSBmbHVzaCBBQ0shXG4iKTsKK30KKworLyoqCisgKiBnbWNfdjEwXzBf
Zmx1c2hfZ3B1X3RsYiAtIGdhcnQgdGxiIGZsdXNoIGNhbGxiYWNrCisgKgorICogQGFkZXY6IGFt
ZGdwdV9kZXZpY2UgcG9pbnRlcgorICogQHZtaWQ6IHZtIGluc3RhbmNlIHRvIGZsdXNoCisgKgor
ICogRmx1c2ggdGhlIFRMQiBmb3IgdGhlIHJlcXVlc3RlZCBwYWdlIHRhYmxlLgorICovCitzdGF0
aWMgdm9pZCBnbWNfdjEwXzBfZmx1c2hfZ3B1X3RsYihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwKKwkJCQkgICAgdWludDMyX3Qgdm1pZCwgdWludDMyX3QgZmx1c2hfdHlwZSkKK3sKKwlzdHJ1
Y3QgYW1kZ3B1X3JpbmcgKnJpbmcgPSBhZGV2LT5tbWFuLmJ1ZmZlcl9mdW5jc19yaW5nOworCXN0
cnVjdCBkbWFfZmVuY2UgKmZlbmNlOworCXN0cnVjdCBhbWRncHVfam9iICpqb2I7CisKKwlpbnQg
cjsKKworCS8qIGZsdXNoIGhkcCBjYWNoZSAqLworCWFkZXYtPm5iaW9fZnVuY3MtPmhkcF9mbHVz
aChhZGV2LCBOVUxMKTsKKworCW11dGV4X2xvY2soJmFkZXYtPm1tYW4uZ3R0X3dpbmRvd19sb2Nr
KTsKKworCWdtY192MTBfMF9mbHVzaF92bV9odWIoYWRldiwgdm1pZCwgQU1ER1BVX01NSFVCLCAw
KTsKKwlpZiAoIWFkZXYtPm1tYW4uYnVmZmVyX2Z1bmNzX2VuYWJsZWQgfHwgIWFkZXYtPmliX3Bv
b2xfcmVhZHkgfHwKKwkgICAgYWRldi0+YXNpY190eXBlICE9IENISVBfTkFWSTEwKSB7CisJCWdt
Y192MTBfMF9mbHVzaF92bV9odWIoYWRldiwgdm1pZCwgQU1ER1BVX0dGWEhVQiwgMCk7CisJCW11
dGV4X3VubG9jaygmYWRldi0+bW1hbi5ndHRfd2luZG93X2xvY2spOworCQlyZXR1cm47CisJfQor
CisJLyogVGhlIFNETUEgb24gTmF2aSBoYXMgYSBidWcgd2hpY2ggY2FuIHRoZW9yZXRpY2FsbHkg
cmVzdWx0IGluIG1lbW9yeQorCSAqIGNvcnJ1cHRpb24gaWYgYW4gaW52YWxpZGF0aW9uIGhhcHBl
bnMgYXQgdGhlIHNhbWUgdGltZSBhcyBhbiBWQQorCSAqIHRyYW5zbGF0aW9uLiBBdm9pZCB0aGlz
IGJ5IGRvaW5nIHRoZSBpbnZhbGlkYXRpb24gZnJvbSB0aGUgU0RNQQorCSAqIGl0c2VsZi4KKwkg
Ki8KKwlyID0gYW1kZ3B1X2pvYl9hbGxvY193aXRoX2liKGFkZXYsIDE2ICogNCwgJmpvYik7CisJ
aWYgKHIpCisJCWdvdG8gZXJyb3JfYWxsb2M7CisKKwlqb2ItPnZtX3BkX2FkZHIgPSBhbWRncHVf
Z21jX3BkX2FkZHIoYWRldi0+Z2FydC5ibyk7CisJam9iLT52bV9uZWVkc19mbHVzaCA9IHRydWU7
CisJYW1kZ3B1X3JpbmdfcGFkX2liKHJpbmcsICZqb2ItPmlic1swXSk7CisJciA9IGFtZGdwdV9q
b2Jfc3VibWl0KGpvYiwgJmFkZXYtPm1tYW4uZW50aXR5LAorCQkJICAgICAgQU1ER1BVX0ZFTkNF
X09XTkVSX1VOREVGSU5FRCwgJmZlbmNlKTsKKwlpZiAocikKKwkJZ290byBlcnJvcl9zdWJtaXQ7
CisKKwltdXRleF91bmxvY2soJmFkZXYtPm1tYW4uZ3R0X3dpbmRvd19sb2NrKTsKKworCWRtYV9m
ZW5jZV93YWl0KGZlbmNlLCBmYWxzZSk7CisJZG1hX2ZlbmNlX3B1dChmZW5jZSk7CisKKwlyZXR1
cm47CisKK2Vycm9yX3N1Ym1pdDoKKwlhbWRncHVfam9iX2ZyZWUoam9iKTsKKworZXJyb3JfYWxs
b2M6CisJbXV0ZXhfdW5sb2NrKCZhZGV2LT5tbWFuLmd0dF93aW5kb3dfbG9jayk7CisJRFJNX0VS
Uk9SKCJFcnJvciBmbHVzaGluZyBHUFUgVExCIHVzaW5nIHRoZSBTRE1BICglZCkhXG4iLCByKTsK
K30KKworc3RhdGljIHVpbnQ2NF90IGdtY192MTBfMF9lbWl0X2ZsdXNoX2dwdV90bGIoc3RydWN0
IGFtZGdwdV9yaW5nICpyaW5nLAorCQkJCQkgICAgIHVuc2lnbmVkIHZtaWQsIHVpbnQ2NF90IHBk
X2FkZHIpCit7CisJc3RydWN0IGFtZGdwdV92bWh1YiAqaHViID0gJnJpbmctPmFkZXYtPnZtaHVi
W3JpbmctPmZ1bmNzLT52bWh1Yl07CisJdWludDMyX3QgcmVxID0gZ21jX3YxMF8wX2dldF9pbnZh
bGlkYXRlX3JlcSh2bWlkLCAwKTsKKwl1bnNpZ25lZCBlbmcgPSByaW5nLT52bV9pbnZfZW5nOwor
CisJYW1kZ3B1X3JpbmdfZW1pdF93cmVnKHJpbmcsIGh1Yi0+Y3R4MF9wdGJfYWRkcl9sbzMyICsg
KDIgKiB2bWlkKSwKKwkJCSAgICAgIGxvd2VyXzMyX2JpdHMocGRfYWRkcikpOworCisJYW1kZ3B1
X3JpbmdfZW1pdF93cmVnKHJpbmcsIGh1Yi0+Y3R4MF9wdGJfYWRkcl9oaTMyICsgKDIgKiB2bWlk
KSwKKwkJCSAgICAgIHVwcGVyXzMyX2JpdHMocGRfYWRkcikpOworCisJYW1kZ3B1X3JpbmdfZW1p
dF93cmVnKHJpbmcsIGh1Yi0+dm1faW52X2VuZzBfcmVxICsgZW5nLCByZXEpOworCisJLyogd2Fp
dCBmb3IgdGhlIGludmFsaWRhdGUgdG8gY29tcGxldGUgKi8KKwlhbWRncHVfcmluZ19lbWl0X3Jl
Z193YWl0KHJpbmcsIGh1Yi0+dm1faW52X2VuZzBfYWNrICsgZW5nLAorCQkJCSAgMSA8PCB2bWlk
LCAxIDw8IHZtaWQpOworCisJcmV0dXJuIHBkX2FkZHI7Cit9CisKK3N0YXRpYyB2b2lkIGdtY192
MTBfMF9lbWl0X3Bhc2lkX21hcHBpbmcoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nLCB1bnNpZ25l
ZCB2bWlkLAorCQkJCQkgdW5zaWduZWQgcGFzaWQpCit7CisJc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYgPSByaW5nLT5hZGV2OworCXVpbnQzMl90IHJlZzsKKworCWlmIChyaW5nLT5mdW5jcy0+
dm1odWIgPT0gQU1ER1BVX0dGWEhVQikKKwkJcmVnID0gU09DMTVfUkVHX09GRlNFVChPU1NTWVMs
IDAsIG1tSUhfVk1JRF8wX0xVVCkgKyB2bWlkOworCWVsc2UKKwkJcmVnID0gU09DMTVfUkVHX09G
RlNFVChPU1NTWVMsIDAsIG1tSUhfVk1JRF8wX0xVVF9NTSkgKyB2bWlkOworCisJYW1kZ3B1X3Jp
bmdfZW1pdF93cmVnKHJpbmcsIHJlZywgcGFzaWQpOworfQorCisvKgorICogUFRFIGZvcm1hdCBv
biBOQVZJIDEwOgorICogNjM6NTkgcmVzZXJ2ZWQKKyAqIDU4OjU3IHJlc2VydmVkCisgKiA1NiBG
CisgKiA1NSBMCisgKiA1NCByZXNlcnZlZAorICogNTM6NTIgU1cKKyAqIDUxIFQKKyAqIDUwOjQ4
IG10eXBlCisgKiA0NzoxMiA0ayBwaHlzaWNhbCBwYWdlIGJhc2UgYWRkcmVzcworICogMTE6NyBm
cmFnbWVudAorICogNiB3cml0ZQorICogNSByZWFkCisgKiA0IGV4ZQorICogMyBaCisgKiAyIHNu
b29wZWQKKyAqIDEgc3lzdGVtCisgKiAwIHZhbGlkCisgKgorICogUERFIGZvcm1hdCBvbiBOQVZJ
IDEwOgorICogNjM6NTkgYmxvY2sgZnJhZ21lbnQgc2l6ZQorICogNTg6NTUgcmVzZXJ2ZWQKKyAq
IDU0IFAKKyAqIDUzOjQ4IHJlc2VydmVkCisgKiA0Nzo2IHBoeXNpY2FsIGJhc2UgYWRkcmVzcyBv
ZiBQRCBvciBQVEUKKyAqIDU6MyByZXNlcnZlZAorICogMiBDCisgKiAxIHN5c3RlbQorICogMCB2
YWxpZAorICovCitzdGF0aWMgdWludDY0X3QgZ21jX3YxMF8wX2dldF92bV9wdGVfZmxhZ3Moc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCisJCQkJCSAgIHVpbnQzMl90IGZsYWdzKQoreworCXVp
bnQ2NF90IHB0ZV9mbGFnID0gMDsKKworCWlmIChmbGFncyAmIEFNREdQVV9WTV9QQUdFX0VYRUNV
VEFCTEUpCisJCXB0ZV9mbGFnIHw9IEFNREdQVV9QVEVfRVhFQ1VUQUJMRTsKKwlpZiAoZmxhZ3Mg
JiBBTURHUFVfVk1fUEFHRV9SRUFEQUJMRSkKKwkJcHRlX2ZsYWcgfD0gQU1ER1BVX1BURV9SRUFE
QUJMRTsKKwlpZiAoZmxhZ3MgJiBBTURHUFVfVk1fUEFHRV9XUklURUFCTEUpCisJCXB0ZV9mbGFn
IHw9IEFNREdQVV9QVEVfV1JJVEVBQkxFOworCisJc3dpdGNoIChmbGFncyAmIEFNREdQVV9WTV9N
VFlQRV9NQVNLKSB7CisJY2FzZSBBTURHUFVfVk1fTVRZUEVfREVGQVVMVDoKKwkJcHRlX2ZsYWcg
fD0gQU1ER1BVX1BURV9NVFlQRV9OVjEwKE1UWVBFX05DKTsKKwkJYnJlYWs7CisJY2FzZSBBTURH
UFVfVk1fTVRZUEVfTkM6CisJCXB0ZV9mbGFnIHw9IEFNREdQVV9QVEVfTVRZUEVfTlYxMChNVFlQ
RV9OQyk7CisJCWJyZWFrOworCWNhc2UgQU1ER1BVX1ZNX01UWVBFX1dDOgorCQlwdGVfZmxhZyB8
PSBBTURHUFVfUFRFX01UWVBFX05WMTAoTVRZUEVfV0MpOworCQlicmVhazsKKwljYXNlIEFNREdQ
VV9WTV9NVFlQRV9DQzoKKwkJcHRlX2ZsYWcgfD0gQU1ER1BVX1BURV9NVFlQRV9OVjEwKE1UWVBF
X0NDKTsKKwkJYnJlYWs7CisJY2FzZSBBTURHUFVfVk1fTVRZUEVfVUM6CisJCXB0ZV9mbGFnIHw9
IEFNREdQVV9QVEVfTVRZUEVfTlYxMChNVFlQRV9VQyk7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJ
CXB0ZV9mbGFnIHw9IEFNREdQVV9QVEVfTVRZUEVfTlYxMChNVFlQRV9OQyk7CisJCWJyZWFrOwor
CX0KKworCWlmIChmbGFncyAmIEFNREdQVV9WTV9QQUdFX1BSVCkKKwkJcHRlX2ZsYWcgfD0gQU1E
R1BVX1BURV9QUlQ7CisKKwlyZXR1cm4gcHRlX2ZsYWc7Cit9CisKK3N0YXRpYyB2b2lkIGdtY192
MTBfMF9nZXRfdm1fcGRlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBpbnQgbGV2ZWwsCisJ
CQkJIHVpbnQ2NF90ICphZGRyLCB1aW50NjRfdCAqZmxhZ3MpCit7CisJaWYgKCEoKmZsYWdzICYg
QU1ER1BVX1BERV9QVEUpICYmICEoKmZsYWdzICYgQU1ER1BVX1BURV9TWVNURU0pKQorCQkqYWRk
ciA9IGFkZXYtPnZtX21hbmFnZXIudnJhbV9iYXNlX29mZnNldCArICphZGRyIC0KKwkJCWFkZXYt
PmdtYy52cmFtX3N0YXJ0OworCUJVR19PTigqYWRkciAmIDB4RkZGRjAwMDAwMDAwMDAzRlVMTCk7
CisKKwlpZiAoIWFkZXYtPmdtYy50cmFuc2xhdGVfZnVydGhlcikKKwkJcmV0dXJuOworCisJaWYg
KGxldmVsID09IEFNREdQVV9WTV9QREIxKSB7CisJCS8qIFNldCB0aGUgYmxvY2sgZnJhZ21lbnQg
c2l6ZSAqLworCQlpZiAoISgqZmxhZ3MgJiBBTURHUFVfUERFX1BURSkpCisJCQkqZmxhZ3MgfD0g
QU1ER1BVX1BERV9CRlMoMHg5KTsKKworCX0gZWxzZSBpZiAobGV2ZWwgPT0gQU1ER1BVX1ZNX1BE
QjApIHsKKwkJaWYgKCpmbGFncyAmIEFNREdQVV9QREVfUFRFKQorCQkJKmZsYWdzICY9IH5BTURH
UFVfUERFX1BURTsKKwkJZWxzZQorCQkJKmZsYWdzIHw9IEFNREdQVV9QVEVfVEY7CisJfQorfQor
CitzdGF0aWMgY29uc3Qgc3RydWN0IGFtZGdwdV9nbWNfZnVuY3MgZ21jX3YxMF8wX2dtY19mdW5j
cyA9IHsKKwkuZmx1c2hfZ3B1X3RsYiA9IGdtY192MTBfMF9mbHVzaF9ncHVfdGxiLAorCS5lbWl0
X2ZsdXNoX2dwdV90bGIgPSBnbWNfdjEwXzBfZW1pdF9mbHVzaF9ncHVfdGxiLAorCS5lbWl0X3Bh
c2lkX21hcHBpbmcgPSBnbWNfdjEwXzBfZW1pdF9wYXNpZF9tYXBwaW5nLAorCS5nZXRfdm1fcHRl
X2ZsYWdzID0gZ21jX3YxMF8wX2dldF92bV9wdGVfZmxhZ3MsCisJLmdldF92bV9wZGUgPSBnbWNf
djEwXzBfZ2V0X3ZtX3BkZQorfTsKKworc3RhdGljIHZvaWQgZ21jX3YxMF8wX3NldF9nbWNfZnVu
Y3Moc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCit7CisJaWYgKGFkZXYtPmdtYy5nbWNfZnVu
Y3MgPT0gTlVMTCkKKwkJYWRldi0+Z21jLmdtY19mdW5jcyA9ICZnbWNfdjEwXzBfZ21jX2Z1bmNz
OworfQorCitzdGF0aWMgaW50IGdtY192MTBfMF9lYXJseV9pbml0KHZvaWQgKmhhbmRsZSkKK3sK
KwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhh
bmRsZTsKKworCWdtY192MTBfMF9zZXRfZ21jX2Z1bmNzKGFkZXYpOworCWdtY192MTBfMF9zZXRf
aXJxX2Z1bmNzKGFkZXYpOworCisJYWRldi0+Z21jLnNoYXJlZF9hcGVydHVyZV9zdGFydCA9IDB4
MjAwMDAwMDAwMDAwMDAwMFVMTDsKKwlhZGV2LT5nbWMuc2hhcmVkX2FwZXJ0dXJlX2VuZCA9CisJ
CWFkZXYtPmdtYy5zaGFyZWRfYXBlcnR1cmVfc3RhcnQgKyAoNFVMTCA8PCAzMCkgLSAxOworCWFk
ZXYtPmdtYy5wcml2YXRlX2FwZXJ0dXJlX3N0YXJ0ID0gMHgxMDAwMDAwMDAwMDAwMDAwVUxMOwor
CWFkZXYtPmdtYy5wcml2YXRlX2FwZXJ0dXJlX2VuZCA9CisJCWFkZXYtPmdtYy5wcml2YXRlX2Fw
ZXJ0dXJlX3N0YXJ0ICsgKDRVTEwgPDwgMzApIC0gMTsKKworCXJldHVybiAwOworfQorCitzdGF0
aWMgaW50IGdtY192MTBfMF9sYXRlX2luaXQodm9pZCAqaGFuZGxlKQoreworCXN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2ID0gKHN0cnVjdCBhbWRncHVfZGV2aWNlICopaGFuZGxlOworCXVuc2ln
bmVkIHZtX2ludl9lbmdbQU1ER1BVX01BWF9WTUhVQlNdID0geyA0LCA0IH07CisJdW5zaWduZWQg
aTsKKworCWZvcihpID0gMDsgaSA8IGFkZXYtPm51bV9yaW5nczsgKytpKSB7CisJCXN0cnVjdCBh
bWRncHVfcmluZyAqcmluZyA9IGFkZXYtPnJpbmdzW2ldOworCQl1bnNpZ25lZCB2bWh1YiA9IHJp
bmctPmZ1bmNzLT52bWh1YjsKKworCQlyaW5nLT52bV9pbnZfZW5nID0gdm1faW52X2VuZ1t2bWh1
Yl0rKzsKKwkJZGV2X2luZm8oYWRldi0+ZGV2LCAicmluZyAldSglcykgdXNlcyBWTSBpbnYgZW5n
ICV1IG9uIGh1YiAldVxuIiwKKwkJCSByaW5nLT5pZHgsIHJpbmctPm5hbWUsIHJpbmctPnZtX2lu
dl9lbmcsCisJCQkgcmluZy0+ZnVuY3MtPnZtaHViKTsKKwl9CisKKwkvKiBFbmdpbmUgMTcgaXMg
dXNlZCBmb3IgR0FSVCBmbHVzaGVzICovCisJZm9yKGkgPSAwOyBpIDwgQU1ER1BVX01BWF9WTUhV
QlM7ICsraSkKKwkJQlVHX09OKHZtX2ludl9lbmdbaV0gPiAxNyk7CisKKwlyZXR1cm4gYW1kZ3B1
X2lycV9nZXQoYWRldiwgJmFkZXYtPmdtYy52bV9mYXVsdCwgMCk7Cit9CisKK3N0YXRpYyB2b2lk
IGdtY192MTBfMF92cmFtX2d0dF9sb2NhdGlvbihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwK
KwkJCQkJc3RydWN0IGFtZGdwdV9nbWMgKm1jKQoreworCXU2NCBiYXNlID0gMDsKKworCWlmICgh
YW1kZ3B1X3NyaW92X3ZmKGFkZXYpKQorCQliYXNlID0gZ2Z4aHViX3YyXzBfZ2V0X2ZiX2xvY2F0
aW9uKGFkZXYpOworCisJYW1kZ3B1X2dtY192cmFtX2xvY2F0aW9uKGFkZXYsICZhZGV2LT5nbWMs
IGJhc2UpOworCWFtZGdwdV9nbWNfZ2FydF9sb2NhdGlvbihhZGV2LCBtYyk7CisKKwkvKiBiYXNl
IG9mZnNldCBvZiB2cmFtIHBhZ2VzICovCisJYWRldi0+dm1fbWFuYWdlci52cmFtX2Jhc2Vfb2Zm
c2V0ID0gZ2Z4aHViX3YyXzBfZ2V0X21jX2ZiX29mZnNldChhZGV2KTsKK30KKworLyoqCisgKiBn
bWNfdjEwXzBfbWNfaW5pdCAtIGluaXRpYWxpemUgdGhlIG1lbW9yeSBjb250cm9sbGVyIGRyaXZl
ciBwYXJhbXMKKyAqCisgKiBAYWRldjogYW1kZ3B1X2RldmljZSBwb2ludGVyCisgKgorICogTG9v
ayB1cCB0aGUgYW1vdW50IG9mIHZyYW0sIHZyYW0gd2lkdGgsIGFuZCBkZWNpZGUgaG93IHRvIHBs
YWNlCisgKiB2cmFtIGFuZCBnYXJ0IHdpdGhpbiB0aGUgR1BVJ3MgcGh5c2ljYWwgYWRkcmVzcyBz
cGFjZS4KKyAqIFJldHVybnMgMCBmb3Igc3VjY2Vzcy4KKyAqLworc3RhdGljIGludCBnbWNfdjEw
XzBfbWNfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKK3sKKwlpbnQgY2hhbnNpemUs
IG51bWNoYW47CisKKwlpZiAoIWFtZGdwdV9lbXVfbW9kZSkKKwkJYWRldi0+Z21jLnZyYW1fd2lk
dGggPSBhbWRncHVfYXRvbWZpcm13YXJlX2dldF92cmFtX3dpZHRoKGFkZXYpOworCWVsc2Ugewor
CQkvKiBoYXJkIGNvZGUgdnJhbV93aWR0aCBmb3IgZW11bGF0aW9uICovCisJCWNoYW5zaXplID0g
MTI4OworCQludW1jaGFuID0gMTsKKwkJYWRldi0+Z21jLnZyYW1fd2lkdGggPSBudW1jaGFuICog
Y2hhbnNpemU7CisJfQorCisJLyogQ291bGQgYXBlciBzaXplIHJlcG9ydCAwID8gKi8KKwlhZGV2
LT5nbWMuYXBlcl9iYXNlID0gcGNpX3Jlc291cmNlX3N0YXJ0KGFkZXYtPnBkZXYsIDApOworCWFk
ZXYtPmdtYy5hcGVyX3NpemUgPSBwY2lfcmVzb3VyY2VfbGVuKGFkZXYtPnBkZXYsIDApOworCisJ
Lyogc2l6ZSBpbiBNQiBvbiBzaSAqLworCWFkZXYtPmdtYy5tY192cmFtX3NpemUgPQorCQlhZGV2
LT5uYmlvX2Z1bmNzLT5nZXRfbWVtc2l6ZShhZGV2KSAqIDEwMjRVTEwgKiAxMDI0VUxMOworCWFk
ZXYtPmdtYy5yZWFsX3ZyYW1fc2l6ZSA9IGFkZXYtPmdtYy5tY192cmFtX3NpemU7CisJYWRldi0+
Z21jLnZpc2libGVfdnJhbV9zaXplID0gYWRldi0+Z21jLmFwZXJfc2l6ZTsKKworCS8qIEluIGNh
c2UgdGhlIFBDSSBCQVIgaXMgbGFyZ2VyIHRoYW4gdGhlIGFjdHVhbCBhbW91bnQgb2YgdnJhbSAq
LworCWlmIChhZGV2LT5nbWMudmlzaWJsZV92cmFtX3NpemUgPiBhZGV2LT5nbWMucmVhbF92cmFt
X3NpemUpCisJCWFkZXYtPmdtYy52aXNpYmxlX3ZyYW1fc2l6ZSA9IGFkZXYtPmdtYy5yZWFsX3Zy
YW1fc2l6ZTsKKworCS8qIHNldCB0aGUgZ2FydCBzaXplICovCisJaWYgKGFtZGdwdV9nYXJ0X3Np
emUgPT0gLTEpIHsKKwkJc3dpdGNoIChhZGV2LT5hc2ljX3R5cGUpIHsKKwkJY2FzZSBDSElQX05B
VkkxMDoKKwkJZGVmYXVsdDoKKwkJCWFkZXYtPmdtYy5nYXJ0X3NpemUgPSA1MTJVTEwgPDwgMjA7
CisJCQlicmVhazsKKwkJfQorCX0gZWxzZQorCQlhZGV2LT5nbWMuZ2FydF9zaXplID0gKHU2NClh
bWRncHVfZ2FydF9zaXplIDw8IDIwOworCisJZ21jX3YxMF8wX3ZyYW1fZ3R0X2xvY2F0aW9uKGFk
ZXYsICZhZGV2LT5nbWMpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZ21jX3YxMF8w
X2dhcnRfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKK3sKKwlpbnQgcjsKKworCWlm
IChhZGV2LT5nYXJ0LmJvKSB7CisJCVdBUk4oMSwgIk5BVkkxMCBQQ0lFIEdBUlQgYWxyZWFkeSBp
bml0aWFsaXplZFxuIik7CisJCXJldHVybiAwOworCX0KKworCS8qIEluaXRpYWxpemUgY29tbW9u
IGdhcnQgc3RydWN0dXJlICovCisJciA9IGFtZGdwdV9nYXJ0X2luaXQoYWRldik7CisJaWYgKHIp
CisJCXJldHVybiByOworCisJYWRldi0+Z2FydC50YWJsZV9zaXplID0gYWRldi0+Z2FydC5udW1f
Z3B1X3BhZ2VzICogODsKKwlhZGV2LT5nYXJ0LmdhcnRfcHRlX2ZsYWdzID0gQU1ER1BVX1BURV9N
VFlQRV9OVjEwKE1UWVBFX1VDKSB8CisJCQkJIEFNREdQVV9QVEVfRVhFQ1VUQUJMRTsKKworCXJl
dHVybiBhbWRncHVfZ2FydF90YWJsZV92cmFtX2FsbG9jKGFkZXYpOworfQorCitzdGF0aWMgdW5z
aWduZWQgZ21jX3YxMF8wX2dldF92Ymlvc19mYl9zaXplKHN0cnVjdCBhbWRncHVfZGV2aWNlICph
ZGV2KQoreworCXUzMiBkMXZnYV9jb250cm9sID0gUlJFRzMyX1NPQzE1KERDRSwgMCwgbW1EMVZH
QV9DT05UUk9MKTsKKwl1bnNpZ25lZCBzaXplOworCisJaWYgKFJFR19HRVRfRklFTEQoZDF2Z2Ff
Y29udHJvbCwgRDFWR0FfQ09OVFJPTCwgRDFWR0FfTU9ERV9FTkFCTEUpKSB7CisJCXNpemUgPSA5
ICogMTAyNCAqIDEwMjQ7IC8qIHJlc2VydmUgOE1CIGZvciB2Z2EgZW11bGF0b3IgYW5kIDEgTUIg
Zm9yIEZCICovCisJfSBlbHNlIHsKKwkJdTMyIHZpZXdwb3J0OworCQl1MzIgcGl0Y2g7CisKKwkJ
dmlld3BvcnQgPSBSUkVHMzJfU09DMTUoRENFLCAwLCBtbUhVQlAwX0RDU1VSRl9QUklfVklFV1BP
UlRfRElNRU5TSU9OKTsKKwkJcGl0Y2ggPSBSUkVHMzJfU09DMTUoRENFLCAwLCBtbUhVQlBSRVEw
X0RDU1VSRl9TVVJGQUNFX1BJVENIKTsKKwkJc2l6ZSA9IChSRUdfR0VUX0ZJRUxEKHZpZXdwb3J0
LAorCQkJCQlIVUJQMF9EQ1NVUkZfUFJJX1ZJRVdQT1JUX0RJTUVOU0lPTiwgUFJJX1ZJRVdQT1JU
X0hFSUdIVCkgKgorCQkJCVJFR19HRVRfRklFTEQocGl0Y2gsIEhVQlBSRVEwX0RDU1VSRl9TVVJG
QUNFX1BJVENILCBQSVRDSCkgKgorCQkJCTQpOworCX0KKwkvKiByZXR1cm4gMCBpZiB0aGUgcHJl
LU9TIGJ1ZmZlciB1c2VzIHVwIG1vc3Qgb2YgdnJhbSAqLworCWlmICgoYWRldi0+Z21jLnJlYWxf
dnJhbV9zaXplIC0gc2l6ZSkgPCAoOCAqIDEwMjQgKiAxMDI0KSkgeworCQlEUk1fRVJST1IoIldh
cm5pbmc6IHByZS1PUyBidWZmZXIgdXNlcyBtb3N0IG9mIHZyYW0sIFwKKwkJCQliZSBhd2FyZSBv
ZiBnYXJ0IHRhYmxlIG92ZXJ3cml0ZVxuIik7CisJCXJldHVybiAwOworCX0KKworCXJldHVybiBz
aXplOworfQorCisKKworc3RhdGljIGludCBnbWNfdjEwXzBfc3dfaW5pdCh2b2lkICpoYW5kbGUp
Cit7CisJaW50IHI7CisJaW50IGRtYV9iaXRzOworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
ID0gKHN0cnVjdCBhbWRncHVfZGV2aWNlICopaGFuZGxlOworCisJZ2Z4aHViX3YyXzBfaW5pdChh
ZGV2KTsKKwltbWh1Yl92Ml8wX2luaXQoYWRldik7CisKKwlzcGluX2xvY2tfaW5pdCgmYWRldi0+
Z21jLmludmFsaWRhdGVfbG9jayk7CisKKwlhZGV2LT5nbWMudnJhbV90eXBlID0gYW1kZ3B1X2F0
b21maXJtd2FyZV9nZXRfdnJhbV90eXBlKGFkZXYpOworCXN3aXRjaCAoYWRldi0+YXNpY190eXBl
KSB7CisJY2FzZSBDSElQX05BVkkxMDoKKwkJLyoKKwkJICogVG8gZnVsZmlsbCA0LWxldmVsIHBh
Z2Ugc3VwcG9ydCwKKwkJICogdm0gc2l6ZSBpcyAyNTZUQiAoNDhiaXQpLCBtYXhpbXVtIHNpemUg
b2YgTmF2aTEwLAorCQkgKiBibG9jayBzaXplIDUxMiAoOWJpdCkKKwkJICovCisJCWFtZGdwdV92
bV9hZGp1c3Rfc2l6ZShhZGV2LCAyNTYgKiAxMDI0LCA5LCAzLCA0OCk7CisJCWJyZWFrOworCWRl
ZmF1bHQ6CisJCWJyZWFrOworCX0KKworCS8qIFRoaXMgaW50ZXJydXB0IGlzIFZNQyBwYWdlIGZh
dWx0LiovCisJciA9IGFtZGdwdV9pcnFfYWRkX2lkKGFkZXYsIFNPQzE1X0lIX0NMSUVOVElEX1ZN
QywKKwkJCSAgICAgIFZNQ18xXzBfX1NSQ0lEX19WTV9GQVVMVCwKKwkJCSAgICAgICZhZGV2LT5n
bWMudm1fZmF1bHQpOworCXIgPSBhbWRncHVfaXJxX2FkZF9pZChhZGV2LCBTT0MxNV9JSF9DTElF
TlRJRF9VVENMMiwKKwkJCSAgICAgIFVUQ0wyXzFfMF9fU1JDSURfX0ZBVUxULAorCQkJICAgICAg
JmFkZXYtPmdtYy52bV9mYXVsdCk7CisJaWYgKHIpCisJCXJldHVybiByOworCisJLyoKKwkgKiBT
ZXQgdGhlIGludGVybmFsIE1DIGFkZHJlc3MgbWFzayBUaGlzIGlzIHRoZSBtYXggYWRkcmVzcyBv
ZiB0aGUgR1BVJ3MKKwkgKiBpbnRlcm5hbCBhZGRyZXNzIHNwYWNlLgorCSAqLworCWFkZXYtPmdt
Yy5tY19tYXNrID0gMHhmZmZmZmZmZmZmZmZVTEw7IC8qIDQ4IGJpdCBNQyAqLworCisJLyoKKwkg
KiBSZXNlcnZlIDhNIHN0b2xlbiBtZW1vcnkgZm9yIG5hdmkxMCBsaWtlIHZlZ2ExMAorCSAqIFRP
RE86IHdpbGwgY2hlY2sgaWYgaXQncyByZWFsbHkgbmVlZGVkIG9uIGFzaWMuCisJICovCisJaWYg
KGFtZGdwdV9lbXVfbW9kZSA9PSAxKQorCQlhZGV2LT5nbWMuc3RvbGVuX3NpemUgPSAwOworCWVs
c2UKKwkJYWRldi0+Z21jLnN0b2xlbl9zaXplID0gOSAqIDEwMjQgKjEwMjQ7CisKKwkvKgorCSAq
IFNldCBETUEgbWFzayArIG5lZWRfZG1hMzIgZmxhZ3MuCisJICogUENJRSAtIGNhbiBoYW5kbGUg
NDQtYml0cy4KKwkgKiBJR1AgLSBjYW4gaGFuZGxlIDQ0LWJpdHMKKwkgKiBQQ0kgLSBkbWEzMiBm
b3IgbGVnYWN5IHBjaSBnYXJ0LCA0NCBiaXRzIG9uIG5hdmkxMAorCSAqLworCWFkZXYtPm5lZWRf
ZG1hMzIgPSBmYWxzZTsKKwlkbWFfYml0cyA9IGFkZXYtPm5lZWRfZG1hMzIgPyAzMiA6IDQ0Owor
CisJciA9IHBjaV9zZXRfZG1hX21hc2soYWRldi0+cGRldiwgRE1BX0JJVF9NQVNLKGRtYV9iaXRz
KSk7CisJaWYgKHIpIHsKKwkJYWRldi0+bmVlZF9kbWEzMiA9IHRydWU7CisJCWRtYV9iaXRzID0g
MzI7CisJCXByaW50ayhLRVJOX1dBUk5JTkcgImFtZGdwdTogTm8gc3VpdGFibGUgRE1BIGF2YWls
YWJsZS5cbiIpOworCX0KKworCXIgPSBwY2lfc2V0X2NvbnNpc3RlbnRfZG1hX21hc2soYWRldi0+
cGRldiwgRE1BX0JJVF9NQVNLKGRtYV9iaXRzKSk7CisJaWYgKHIpIHsKKwkJcGNpX3NldF9jb25z
aXN0ZW50X2RtYV9tYXNrKGFkZXYtPnBkZXYsIERNQV9CSVRfTUFTSygzMikpOworCQlwcmludGso
S0VSTl9XQVJOSU5HICJhbWRncHU6IE5vIGNvaGVyZW50IERNQSBhdmFpbGFibGUuXG4iKTsKKwl9
CisKKwlyID0gZ21jX3YxMF8wX21jX2luaXQoYWRldik7CisJaWYgKHIpCisJCXJldHVybiByOwor
CisJYWRldi0+Z21jLnN0b2xlbl9zaXplID0gZ21jX3YxMF8wX2dldF92Ymlvc19mYl9zaXplKGFk
ZXYpOworCisJLyogTWVtb3J5IG1hbmFnZXIgKi8KKwlyID0gYW1kZ3B1X2JvX2luaXQoYWRldik7
CisJaWYgKHIpCisJCXJldHVybiByOworCisJciA9IGdtY192MTBfMF9nYXJ0X2luaXQoYWRldik7
CisJaWYgKHIpCisJCXJldHVybiByOworCisJLyoKKwkgKiBudW1iZXIgb2YgVk1zCisJICogVk1J
RCAwIGlzIHJlc2VydmVkIGZvciBTeXN0ZW0KKwkgKiBhbWRncHUgZ3JhcGhpY3MvY29tcHV0ZSB3
aWxsIHVzZSBWTUlEcyAxLTcKKwkgKiBhbWRrZmQgd2lsbCB1c2UgVk1JRHMgOC0xNQorCSAqLwor
CWFkZXYtPnZtX21hbmFnZXIuaWRfbWdyW0FNREdQVV9HRlhIVUJdLm51bV9pZHMgPSBBTURHUFVf
TlVNX09GX1ZNSURTOworCWFkZXYtPnZtX21hbmFnZXIuaWRfbWdyW0FNREdQVV9NTUhVQl0ubnVt
X2lkcyA9IEFNREdQVV9OVU1fT0ZfVk1JRFM7CisKKwlhbWRncHVfdm1fbWFuYWdlcl9pbml0KGFk
ZXYpOworCisJcmV0dXJuIDA7Cit9CisKKy8qKgorICogZ21jX3Y4XzBfZ2FydF9maW5pIC0gdm0g
ZmluaSBjYWxsYmFjaworICoKKyAqIEBhZGV2OiBhbWRncHVfZGV2aWNlIHBvaW50ZXIKKyAqCisg
KiBUZWFycyBkb3duIHRoZSBkcml2ZXIgR0FSVC9WTSBzZXR1cCAoQ0lLKS4KKyAqLworc3RhdGlj
IHZvaWQgZ21jX3YxMF8wX2dhcnRfZmluaShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKK3sK
KwlhbWRncHVfZ2FydF90YWJsZV92cmFtX2ZyZWUoYWRldik7CisJYW1kZ3B1X2dhcnRfZmluaShh
ZGV2KTsKK30KKworc3RhdGljIGludCBnbWNfdjEwXzBfc3dfZmluaSh2b2lkICpoYW5kbGUpCit7
CisJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKilo
YW5kbGU7CisKKwlhbWRncHVfdm1fbWFuYWdlcl9maW5pKGFkZXYpOworCWdtY192MTBfMF9nYXJ0
X2ZpbmkoYWRldik7CisJYW1kZ3B1X2dlbV9mb3JjZV9yZWxlYXNlKGFkZXYpOworCWFtZGdwdV9i
b19maW5pKGFkZXYpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGdtY192MTBfMF9p
bml0X2dvbGRlbl9yZWdpc3RlcnMoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCit7CisJc3dp
dGNoIChhZGV2LT5hc2ljX3R5cGUpIHsKKwljYXNlIENISVBfTkFWSTEwOgorCQlicmVhazsKKwlk
ZWZhdWx0OgorCQlicmVhazsKKwl9Cit9CisKKy8qKgorICogZ21jX3YxMF8wX2dhcnRfZW5hYmxl
IC0gZ2FydCBlbmFibGUKKyAqCisgKiBAYWRldjogYW1kZ3B1X2RldmljZSBwb2ludGVyCisgKi8K
K3N0YXRpYyBpbnQgZ21jX3YxMF8wX2dhcnRfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNlICph
ZGV2KQoreworCWludCByOworCWJvb2wgdmFsdWU7CisJdTMyIHRtcDsKKworCWlmIChhZGV2LT5n
YXJ0LmJvID09IE5VTEwpIHsKKwkJZGV2X2VycihhZGV2LT5kZXYsICJObyBWUkFNIG9iamVjdCBm
b3IgUENJRSBHQVJULlxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXIgPSBhbWRncHVf
Z2FydF90YWJsZV92cmFtX3BpbihhZGV2KTsKKwlpZiAocikKKwkJcmV0dXJuIHI7CisKKwlyID0g
Z2Z4aHViX3YyXzBfZ2FydF9lbmFibGUoYWRldik7CisJaWYgKHIpCisJCXJldHVybiByOworCisJ
ciA9IG1taHViX3YyXzBfZ2FydF9lbmFibGUoYWRldik7CisJaWYgKHIpCisJCXJldHVybiByOwor
CisJdG1wID0gUlJFRzMyX1NPQzE1KEhEUCwgMCwgbW1IRFBfTUlTQ19DTlRMKTsKKwl0bXAgfD0g
SERQX01JU0NfQ05UTF9fRkxVU0hfSU5WQUxJREFURV9DQUNIRV9NQVNLOworCVdSRUczMl9TT0Mx
NShIRFAsIDAsIG1tSERQX01JU0NfQ05UTCwgdG1wKTsKKworCXRtcCA9IFJSRUczMl9TT0MxNShI
RFAsIDAsIG1tSERQX0hPU1RfUEFUSF9DTlRMKTsKKwlXUkVHMzJfU09DMTUoSERQLCAwLCBtbUhE
UF9IT1NUX1BBVEhfQ05UTCwgdG1wKTsKKworCS8qIEZsdXNoIEhEUCBhZnRlciBpdCBpcyBpbml0
aWFsaXplZCAqLworCWFkZXYtPm5iaW9fZnVuY3MtPmhkcF9mbHVzaChhZGV2LCBOVUxMKTsKKwor
CXZhbHVlID0gKGFtZGdwdV92bV9mYXVsdF9zdG9wID09IEFNREdQVV9WTV9GQVVMVF9TVE9QX0FM
V0FZUykgPworCQlmYWxzZSA6IHRydWU7CisKKwlnZnhodWJfdjJfMF9zZXRfZmF1bHRfZW5hYmxl
X2RlZmF1bHQoYWRldiwgdmFsdWUpOworCW1taHViX3YyXzBfc2V0X2ZhdWx0X2VuYWJsZV9kZWZh
dWx0KGFkZXYsIHZhbHVlKTsKKwlnbWNfdjEwXzBfZmx1c2hfZ3B1X3RsYihhZGV2LCAwLCAwKTsK
KworCURSTV9JTkZPKCJQQ0lFIEdBUlQgb2YgJXVNIGVuYWJsZWQgKHRhYmxlIGF0IDB4JTAxNmxs
WCkuXG4iLAorCQkgKHVuc2lnbmVkKShhZGV2LT5nbWMuZ2FydF9zaXplID4+IDIwKSwKKwkJICh1
bnNpZ25lZCBsb25nIGxvbmcpYW1kZ3B1X2JvX2dwdV9vZmZzZXQoYWRldi0+Z2FydC5ibykpOwor
CisJYWRldi0+Z2FydC5yZWFkeSA9IHRydWU7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGlu
dCBnbWNfdjEwXzBfaHdfaW5pdCh2b2lkICpoYW5kbGUpCit7CisJaW50IHI7CisJc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7CisKKwkv
KiBUaGUgc2VxdWVuY2Ugb2YgdGhlc2UgdHdvIGZ1bmN0aW9uIGNhbGxzIG1hdHRlcnMuKi8KKwln
bWNfdjEwXzBfaW5pdF9nb2xkZW5fcmVnaXN0ZXJzKGFkZXYpOworCisJciA9IGdtY192MTBfMF9n
YXJ0X2VuYWJsZShhZGV2KTsKKwlpZiAocikKKwkJcmV0dXJuIHI7CisKKwlyZXR1cm4gMDsKK30K
KworLyoqCisgKiBnbWNfdjEwXzBfZ2FydF9kaXNhYmxlIC0gZ2FydCBkaXNhYmxlCisgKgorICog
QGFkZXY6IGFtZGdwdV9kZXZpY2UgcG9pbnRlcgorICoKKyAqIFRoaXMgZGlzYWJsZXMgYWxsIFZN
IHBhZ2UgdGFibGUuCisgKi8KK3N0YXRpYyB2b2lkIGdtY192MTBfMF9nYXJ0X2Rpc2FibGUoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCit7CisJZ2Z4aHViX3YyXzBfZ2FydF9kaXNhYmxlKGFk
ZXYpOworCW1taHViX3YyXzBfZ2FydF9kaXNhYmxlKGFkZXYpOworCWFtZGdwdV9nYXJ0X3RhYmxl
X3ZyYW1fdW5waW4oYWRldik7Cit9CisKK3N0YXRpYyBpbnQgZ21jX3YxMF8wX2h3X2Zpbmkodm9p
ZCAqaGFuZGxlKQoreworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gKHN0cnVjdCBhbWRn
cHVfZGV2aWNlICopaGFuZGxlOworCisJaWYgKGFtZGdwdV9zcmlvdl92ZihhZGV2KSkgeworCQkv
KiBmdWxsIGFjY2VzcyBtb2RlLCBzbyBkb24ndCB0b3VjaCBhbnkgR01DIHJlZ2lzdGVyICovCisJ
CURSTV9ERUJVRygiRm9yIFNSSU9WIGNsaWVudCwgc2hvdWxkbid0IGRvIGFueXRoaW5nLlxuIik7
CisJCXJldHVybiAwOworCX0KKworCWFtZGdwdV9pcnFfcHV0KGFkZXYsICZhZGV2LT5nbWMudm1f
ZmF1bHQsIDApOworCWdtY192MTBfMF9nYXJ0X2Rpc2FibGUoYWRldik7CisKKwlyZXR1cm4gMDsK
K30KKworc3RhdGljIGludCBnbWNfdjEwXzBfc3VzcGVuZCh2b2lkICpoYW5kbGUpCit7CisJc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7
CisKKwlnbWNfdjEwXzBfaHdfZmluaShhZGV2KTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMg
aW50IGdtY192MTBfMF9yZXN1bWUodm9pZCAqaGFuZGxlKQoreworCWludCByOworCXN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2ID0gKHN0cnVjdCBhbWRncHVfZGV2aWNlICopaGFuZGxlOworCisJ
ciA9IGdtY192MTBfMF9od19pbml0KGFkZXYpOworCWlmIChyKQorCQlyZXR1cm4gcjsKKworCWFt
ZGdwdV92bWlkX3Jlc2V0X2FsbChhZGV2KTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgYm9v
bCBnbWNfdjEwXzBfaXNfaWRsZSh2b2lkICpoYW5kbGUpCit7CisJLyogTUMgaXMgYWx3YXlzIHJl
YWR5IGluIEdNQyB2MTAuKi8KKwlyZXR1cm4gdHJ1ZTsKK30KKworc3RhdGljIGludCBnbWNfdjEw
XzBfd2FpdF9mb3JfaWRsZSh2b2lkICpoYW5kbGUpCit7CisJLyogVGhlcmUgaXMgbm8gbmVlZCB0
byB3YWl0IGZvciBNQyBpZGxlIGluIEdNQyB2MTAuKi8KKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
IGludCBnbWNfdjEwXzBfc29mdF9yZXNldCh2b2lkICpoYW5kbGUpCit7CisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgZ21jX3YxMF8wX3NldF9jbG9ja2dhdGluZ19zdGF0ZSh2b2lkICpoYW5k
bGUsCisJCQkJCSAgIGVudW0gYW1kX2Nsb2NrZ2F0aW5nX3N0YXRlIHN0YXRlKQoreworCWludCBy
OworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gKHN0cnVjdCBhbWRncHVfZGV2aWNlICop
aGFuZGxlOworCisJciA9IG1taHViX3YyXzBfc2V0X2Nsb2NrZ2F0aW5nKGFkZXYsIHN0YXRlKTsK
KwlpZiAocikKKwkJcmV0dXJuIHI7CisKKwlyZXR1cm4gYXRodWJfdjJfMF9zZXRfY2xvY2tnYXRp
bmcoYWRldiwgc3RhdGUpOworfQorCitzdGF0aWMgdm9pZCBnbWNfdjEwXzBfZ2V0X2Nsb2NrZ2F0
aW5nX3N0YXRlKHZvaWQgKmhhbmRsZSwgdTMyICpmbGFncykKK3sKKwlzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhhbmRsZTsKKworCW1taHViX3Yy
XzBfZ2V0X2Nsb2NrZ2F0aW5nKGFkZXYsIGZsYWdzKTsKKworCWF0aHViX3YyXzBfZ2V0X2Nsb2Nr
Z2F0aW5nKGFkZXYsIGZsYWdzKTsKK30KKworc3RhdGljIGludCBnbWNfdjEwXzBfc2V0X3Bvd2Vy
Z2F0aW5nX3N0YXRlKHZvaWQgKmhhbmRsZSwKKwkJCQkJICAgZW51bSBhbWRfcG93ZXJnYXRpbmdf
c3RhdGUgc3RhdGUpCit7CisJcmV0dXJuIDA7Cit9CisKK2NvbnN0IHN0cnVjdCBhbWRfaXBfZnVu
Y3MgZ21jX3YxMF8wX2lwX2Z1bmNzID0geworCS5uYW1lID0gImdtY192MTBfMCIsCisJLmVhcmx5
X2luaXQgPSBnbWNfdjEwXzBfZWFybHlfaW5pdCwKKwkubGF0ZV9pbml0ID0gZ21jX3YxMF8wX2xh
dGVfaW5pdCwKKwkuc3dfaW5pdCA9IGdtY192MTBfMF9zd19pbml0LAorCS5zd19maW5pID0gZ21j
X3YxMF8wX3N3X2ZpbmksCisJLmh3X2luaXQgPSBnbWNfdjEwXzBfaHdfaW5pdCwKKwkuaHdfZmlu
aSA9IGdtY192MTBfMF9od19maW5pLAorCS5zdXNwZW5kID0gZ21jX3YxMF8wX3N1c3BlbmQsCisJ
LnJlc3VtZSA9IGdtY192MTBfMF9yZXN1bWUsCisJLmlzX2lkbGUgPSBnbWNfdjEwXzBfaXNfaWRs
ZSwKKwkud2FpdF9mb3JfaWRsZSA9IGdtY192MTBfMF93YWl0X2Zvcl9pZGxlLAorCS5zb2Z0X3Jl
c2V0ID0gZ21jX3YxMF8wX3NvZnRfcmVzZXQsCisJLnNldF9jbG9ja2dhdGluZ19zdGF0ZSA9IGdt
Y192MTBfMF9zZXRfY2xvY2tnYXRpbmdfc3RhdGUsCisJLnNldF9wb3dlcmdhdGluZ19zdGF0ZSA9
IGdtY192MTBfMF9zZXRfcG93ZXJnYXRpbmdfc3RhdGUsCisJLmdldF9jbG9ja2dhdGluZ19zdGF0
ZSA9IGdtY192MTBfMF9nZXRfY2xvY2tnYXRpbmdfc3RhdGUsCit9OworCitjb25zdCBzdHJ1Y3Qg
YW1kZ3B1X2lwX2Jsb2NrX3ZlcnNpb24gZ21jX3YxMF8wX2lwX2Jsb2NrID0KK3sKKwkudHlwZSA9
IEFNRF9JUF9CTE9DS19UWVBFX0dNQywKKwkubWFqb3IgPSAxMCwKKwkubWlub3IgPSAwLAorCS5y
ZXYgPSAwLAorCS5mdW5jcyA9ICZnbWNfdjEwXzBfaXBfZnVuY3MsCit9OwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3YxMF8wLmggYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9nbWNfdjEwXzAuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAw
MDAwMDAuLjdkYWE1M2Q4OTk2YwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2dtY192MTBfMC5oCkBAIC0wLDAgKzEsMzAgQEAKKy8qCisgKiBDb3B5cmlnaHQg
MjAxOSBBZHZhbmNlZCBNaWNybyBEZXZpY2VzLCBJbmMuCisgKgorICogUGVybWlzc2lvbiBpcyBo
ZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEK
KyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZp
bGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0
IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRz
IHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGlj
ZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJt
aXQgcGVyc29ucyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNv
LCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUg
Y29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNs
dWRlZCBpbgorICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29m
dHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQg
V0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElORyBC
VVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAorICog
RklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElO
IE5PIEVWRU5UIFNIQUxMCisgKiBUSEUgQ09QWVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1IoUykg
QkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IKKyAqIE9USEVSIExJQUJJTElUWSwg
V0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAorICog
QVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBP
UiBUSEUgVVNFIE9SCisgKiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCisgKgorICov
CisKKyNpZm5kZWYgX19HTUNfVjEwXzBfSF9fCisjZGVmaW5lIF9fR01DX1YxMF8wX0hfXworCitl
eHRlcm4gY29uc3Qgc3RydWN0IGFtZF9pcF9mdW5jcyBnbWNfdjEwXzBfaXBfZnVuY3M7CitleHRl
cm4gY29uc3Qgc3RydWN0IGFtZGdwdV9pcF9ibG9ja192ZXJzaW9uIGdtY192MTBfMF9pcF9ibG9j
azsKKworI2VuZGlmCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
YW1kLWdmeA==
