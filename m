Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EF582B891C
	for <lists+amd-gfx@lfdr.de>; Fri, 20 Sep 2019 04:15:44 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7C0CB6FC51;
	Fri, 20 Sep 2019 02:15:43 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-io1-xd41.google.com (mail-io1-xd41.google.com
 [IPv6:2607:f8b0:4864:20::d41])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B7CB36F573
 for <amd-gfx@lists.freedesktop.org>; Fri, 20 Sep 2019 02:15:41 +0000 (UTC)
Received: by mail-io1-xd41.google.com with SMTP id m11so12727569ioo.0
 for <amd-gfx@lists.freedesktop.org>; Thu, 19 Sep 2019 19:15:41 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=JXJqSnBRkZZc77vReG/Za6ckQFN5HI2U+uZljrHnJXY=;
 b=iSfbFKFpmXoa6hTDgAxQtXVBxBoAZTBf0HFG00Re5MBJtt/QzxezfnvL2/A+AKQDf0
 he5Rg88XDypLM/W9QmDMm7dxxkBSO7BrQQIlvB4ZSIog6crSinXtLaZuTe1Fcl6m1Hgx
 PrbkITcnectSYBpymB7lOcW2R0thNT9CkBgZaQHl9ddy6x3mskGXBXsa9C3atPmwH1+k
 bFe2RxeX/7/OX3FQfCdWx0y2oSB4qfe/ChOOovProM67pVO9awQ+2H+VA3HBXQnz4LKo
 eM1POteaBNWMmoMAq8m4LTTD+Vc/DLNkOEUfF/FLQbApaJxhuak0D3h6OqkzfQ9GWtIh
 WcLA==
X-Gm-Message-State: APjAAAWslGKBDzVcDfvBvjh2gPNeUITKldQlczSJVdlNuPIDzZFjcLOO
 ig272O7dK/yrGeVH7OBpHDgFqapT
X-Google-Smtp-Source: APXvYqwY9pfHW0ZGX3gpkKW9m+V/snTHybqMi1W+Vqh30DGL9w7tFfehCay5gdyiINBoQH6JKaDRrw==
X-Received: by 2002:a5d:9712:: with SMTP id h18mr14391022iol.253.1568945740637; 
 Thu, 19 Sep 2019 19:15:40 -0700 (PDT)
Received: from crimson.amd.com ([165.204.55.251])
 by smtp.gmail.com with ESMTPSA id i26sm585800ion.40.2019.09.19.19.15.39
 for <amd-gfx@lists.freedesktop.org>
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 19 Sep 2019 19:15:39 -0700 (PDT)
From: =?UTF-8?q?Marek=20Ol=C5=A1=C3=A1k?= <maraeo@gmail.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH] drm/amdgpu: remove gfx9 NGG
Date: Thu, 19 Sep 2019 22:15:31 -0400
Message-Id: <20190920021531.3007-1-maraeo@gmail.com>
X-Mailer: git-send-email 2.17.1
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=JXJqSnBRkZZc77vReG/Za6ckQFN5HI2U+uZljrHnJXY=;
 b=o+9e3rPCEdojPw4c+NjKGeN7rVKjVn0tvEE8WkkcJt7EuS1MXb31jnqoHsccZgTn/m
 ZVcO/AnQT7HoJxjffPHS4UIiqB5+OiUOysh21cT7kYeE2IL7Y3q3K0QRWQFG+hDJbKAY
 bD0noGgFRa9g/ZzCI/3+vuphhD+XgZ3kpLb7cRnQwFcUx0o/ech8CnLo3Gu88dwSn9lI
 wVTmRoaNAJK3odEgytig9UlDqxMo4H6NKgnK9xf7kIi1w6JtzEYkJ3wUO2Kj1dB7IOwp
 EbWydR1ZPpa60V16kNfEgcrgoD1zmd5s9gLVFy9N8ucbulZBy3tc3+Uq7ehAiY9nHo0s
 Nw8g==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogTWFyZWsgT2zFocOhayA8bWFyZWsub2xzYWtAYW1kLmNvbT4KCk5ldmVyIHVzZWQuCgpT
aWduZWQtb2ZmLWJ5OiBNYXJlayBPbMWhw6FrIDxtYXJlay5vbHNha0BhbWQuY29tPgotLS0KIGRy
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5oICAgICB8ICAgNSAtCiBkcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHJ2LmMgfCAgNDEgLS0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9nZnguaCB8ICAyNSAtLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9rbXMuYyB8ICAxMSAtLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
Z2Z4X3Y5XzAuYyAgIHwgMTk1IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogNSBmaWxlcyBjaGFu
Z2VkLCAyNzcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaAppbmRl
eCA2ZmYwMmJiNjAxNDAuLjgwMTE2ZTYzZTIwOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1LmgKQEAgLTE0MCwyNSArMTQwLDIwIEBAIGV4dGVybiBpbnQgYW1kZ3B1X2RjOwogZXh0ZXJu
IGludCBhbWRncHVfc2NoZWRfam9iczsKIGV4dGVybiBpbnQgYW1kZ3B1X3NjaGVkX2h3X3N1Ym1p
c3Npb247CiBleHRlcm4gdWludCBhbWRncHVfcGNpZV9nZW5fY2FwOwogZXh0ZXJuIHVpbnQgYW1k
Z3B1X3BjaWVfbGFuZV9jYXA7CiBleHRlcm4gdWludCBhbWRncHVfY2dfbWFzazsKIGV4dGVybiB1
aW50IGFtZGdwdV9wZ19tYXNrOwogZXh0ZXJuIHVpbnQgYW1kZ3B1X3NkbWFfcGhhc2VfcXVhbnR1
bTsKIGV4dGVybiBjaGFyICphbWRncHVfZGlzYWJsZV9jdTsKIGV4dGVybiBjaGFyICphbWRncHVf
dmlydHVhbF9kaXNwbGF5OwogZXh0ZXJuIHVpbnQgYW1kZ3B1X3BwX2ZlYXR1cmVfbWFzazsKLWV4
dGVybiBpbnQgYW1kZ3B1X25nZzsKLWV4dGVybiBpbnQgYW1kZ3B1X3ByaW1fYnVmX3Blcl9zZTsK
LWV4dGVybiBpbnQgYW1kZ3B1X3Bvc19idWZfcGVyX3NlOwotZXh0ZXJuIGludCBhbWRncHVfY250
bF9zYl9idWZfcGVyX3NlOwotZXh0ZXJuIGludCBhbWRncHVfcGFyYW1fYnVmX3Blcl9zZTsKIGV4
dGVybiBpbnQgYW1kZ3B1X2pvYl9oYW5nX2xpbWl0OwogZXh0ZXJuIGludCBhbWRncHVfbGJwdzsK
IGV4dGVybiBpbnQgYW1kZ3B1X2NvbXB1dGVfbXVsdGlwaXBlOwogZXh0ZXJuIGludCBhbWRncHVf
Z3B1X3JlY292ZXJ5OwogZXh0ZXJuIGludCBhbWRncHVfZW11X21vZGU7CiBleHRlcm4gdWludCBh
bWRncHVfc211X21lbW9yeV9wb29sX3NpemU7CiBleHRlcm4gdWludCBhbWRncHVfZGNfZmVhdHVy
ZV9tYXNrOwogZXh0ZXJuIHVpbnQgYW1kZ3B1X2RtX2FibV9sZXZlbDsKIGV4dGVybiBzdHJ1Y3Qg
YW1kZ3B1X21ncHVfaW5mbyBtZ3B1X2luZm87CiBleHRlcm4gaW50IGFtZGdwdV9yYXNfZW5hYmxl
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rydi5jIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rydi5jCmluZGV4IGI0OWVkMzljMWZl
YS4uY2JlNGVmNDgxM2Y4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rydi5j
CkBAIC0xMTksMjUgKzExOSwyMCBAQCBpbnQgYW1kZ3B1X3NjaGVkX2pvYnMgPSAzMjsKIGludCBh
bWRncHVfc2NoZWRfaHdfc3VibWlzc2lvbiA9IDI7CiB1aW50IGFtZGdwdV9wY2llX2dlbl9jYXAg
PSAwOwogdWludCBhbWRncHVfcGNpZV9sYW5lX2NhcCA9IDA7CiB1aW50IGFtZGdwdV9jZ19tYXNr
ID0gMHhmZmZmZmZmZjsKIHVpbnQgYW1kZ3B1X3BnX21hc2sgPSAweGZmZmZmZmZmOwogdWludCBh
bWRncHVfc2RtYV9waGFzZV9xdWFudHVtID0gMzI7CiBjaGFyICphbWRncHVfZGlzYWJsZV9jdSA9
IE5VTEw7CiBjaGFyICphbWRncHVfdmlydHVhbF9kaXNwbGF5ID0gTlVMTDsKIC8qIE92ZXJEcml2
ZShiaXQgMTQpIGRpc2FibGVkIGJ5IGRlZmF1bHQqLwogdWludCBhbWRncHVfcHBfZmVhdHVyZV9t
YXNrID0gMHhmZmZmYmZmZjsKLWludCBhbWRncHVfbmdnID0gMDsKLWludCBhbWRncHVfcHJpbV9i
dWZfcGVyX3NlID0gMDsKLWludCBhbWRncHVfcG9zX2J1Zl9wZXJfc2UgPSAwOwotaW50IGFtZGdw
dV9jbnRsX3NiX2J1Zl9wZXJfc2UgPSAwOwotaW50IGFtZGdwdV9wYXJhbV9idWZfcGVyX3NlID0g
MDsKIGludCBhbWRncHVfam9iX2hhbmdfbGltaXQgPSAwOwogaW50IGFtZGdwdV9sYnB3ID0gLTE7
CiBpbnQgYW1kZ3B1X2NvbXB1dGVfbXVsdGlwaXBlID0gLTE7CiBpbnQgYW1kZ3B1X2dwdV9yZWNv
dmVyeSA9IC0xOyAvKiBhdXRvICovCiBpbnQgYW1kZ3B1X2VtdV9tb2RlID0gMDsKIHVpbnQgYW1k
Z3B1X3NtdV9tZW1vcnlfcG9vbF9zaXplID0gMDsKIC8qIEZCQyAoYml0IDApIGRpc2FibGVkIGJ5
IGRlZmF1bHQqLwogdWludCBhbWRncHVfZGNfZmVhdHVyZV9tYXNrID0gMDsKIGludCBhbWRncHVf
YXN5bmNfZ2Z4X3JpbmcgPSAxOwogaW50IGFtZGdwdV9tY2JwID0gMDsKQEAgLTQ0Myw1NiArNDM4
LDIwIEBAIG1vZHVsZV9wYXJhbV9uYW1lZChkaXNhYmxlX2N1LCBhbWRncHVfZGlzYWJsZV9jdSwg
Y2hhcnAsIDA0NDQpOwogICogRE9DOiB2aXJ0dWFsX2Rpc3BsYXkgKGNoYXJwKQogICogU2V0IHRv
IGVuYWJsZSB2aXJ0dWFsIGRpc3BsYXkgZmVhdHVyZS4gVGhpcyBmZWF0dXJlIHByb3ZpZGVzIGEg
dmlydHVhbCBkaXNwbGF5IGhhcmR3YXJlIG9uIGhlYWRsZXNzIGJvYXJkcwogICogb3IgaW4gdmly
dHVhbGl6ZWQgZW52aXJvbm1lbnRzLiBJdCB3aWxsIGJlIHNldCBsaWtlIHh4eHg6eHg6eHgueCx4
O3h4eHg6eHg6eHgueCx4LiBJdCdzIHRoZSBwY2kgYWRkcmVzcyBvZgogICogdGhlIGRldmljZSwg
cGx1cyB0aGUgbnVtYmVyIG9mIGNydGNzIHRvIGV4cG9zZS4gRS5nLiwgMDAwMDoyNjowMC4wLDQg
d291bGQgZW5hYmxlIDQgdmlydHVhbCBjcnRjcyBvbiB0aGUgcGNpCiAgKiBkZXZpY2UgYXQgMjY6
MDAuMC4gVGhlIGRlZmF1bHQgaXMgTlVMTC4KICAqLwogTU9EVUxFX1BBUk1fREVTQyh2aXJ0dWFs
X2Rpc3BsYXksCiAJCSAiRW5hYmxlIHZpcnR1YWwgZGlzcGxheSBmZWF0dXJlICh0aGUgdmlydHVh
bF9kaXNwbGF5IHdpbGwgYmUgc2V0IGxpa2UgeHh4eDp4eDp4eC54LHg7eHh4eDp4eDp4eC54LHgp
Iik7CiBtb2R1bGVfcGFyYW1fbmFtZWQodmlydHVhbF9kaXNwbGF5LCBhbWRncHVfdmlydHVhbF9k
aXNwbGF5LCBjaGFycCwgMDQ0NCk7CiAKLS8qKgotICogRE9DOiBuZ2cgKGludCkKLSAqIFNldCB0
byBlbmFibGUgTmV4dCBHZW5lcmF0aW9uIEdyYXBoaWNzICgxID0gZW5hYmxlKS4gVGhlIGRlZmF1
bHQgaXMgMCAoZGlzYWJsZWQpLgotICovCi1NT0RVTEVfUEFSTV9ERVNDKG5nZywgIk5leHQgR2Vu
ZXJhdGlvbiBHcmFwaGljcyAoMSA9IGVuYWJsZSwgMCA9IGRpc2FibGUoZGVmYXVsdCBkZXBlbmRp
bmcgb24gZ2Z4KSkiKTsKLW1vZHVsZV9wYXJhbV9uYW1lZChuZ2csIGFtZGdwdV9uZ2csIGludCwg
MDQ0NCk7Ci0KLS8qKgotICogRE9DOiBwcmltX2J1Zl9wZXJfc2UgKGludCkKLSAqIE92ZXJyaWRl
IHRoZSBzaXplIG9mIFByaW1pdGl2ZSBCdWZmZXIgcGVyIFNoYWRlciBFbmdpbmUgaW4gQnl0ZS4g
VGhlIGRlZmF1bHQgaXMgMCAoZGVwZW5kaW5nIG9uIGdmeCkuCi0gKi8KLU1PRFVMRV9QQVJNX0RF
U0MocHJpbV9idWZfcGVyX3NlLCAidGhlIHNpemUgb2YgUHJpbWl0aXZlIEJ1ZmZlciBwZXIgU2hh
ZGVyIEVuZ2luZSAoZGVmYXVsdCBkZXBlbmRpbmcgb24gZ2Z4KSIpOwotbW9kdWxlX3BhcmFtX25h
bWVkKHByaW1fYnVmX3Blcl9zZSwgYW1kZ3B1X3ByaW1fYnVmX3Blcl9zZSwgaW50LCAwNDQ0KTsK
LQotLyoqCi0gKiBET0M6IHBvc19idWZfcGVyX3NlIChpbnQpCi0gKiBPdmVycmlkZSB0aGUgc2l6
ZSBvZiBQb3NpdGlvbiBCdWZmZXIgcGVyIFNoYWRlciBFbmdpbmUgaW4gQnl0ZS4gVGhlIGRlZmF1
bHQgaXMgMCAoZGVwZW5kaW5nIG9uIGdmeCkuCi0gKi8KLU1PRFVMRV9QQVJNX0RFU0MocG9zX2J1
Zl9wZXJfc2UsICJ0aGUgc2l6ZSBvZiBQb3NpdGlvbiBCdWZmZXIgcGVyIFNoYWRlciBFbmdpbmUg
KGRlZmF1bHQgZGVwZW5kaW5nIG9uIGdmeCkiKTsKLW1vZHVsZV9wYXJhbV9uYW1lZChwb3NfYnVm
X3Blcl9zZSwgYW1kZ3B1X3Bvc19idWZfcGVyX3NlLCBpbnQsIDA0NDQpOwotCi0vKioKLSAqIERP
QzogY250bF9zYl9idWZfcGVyX3NlIChpbnQpCi0gKiBPdmVycmlkZSB0aGUgc2l6ZSBvZiBDb250
cm9sIFNpZGViYW5kIHBlciBTaGFkZXIgRW5naW5lIGluIEJ5dGUuIFRoZSBkZWZhdWx0IGlzIDAg
KGRlcGVuZGluZyBvbiBnZngpLgotICovCi1NT0RVTEVfUEFSTV9ERVNDKGNudGxfc2JfYnVmX3Bl
cl9zZSwgInRoZSBzaXplIG9mIENvbnRyb2wgU2lkZWJhbmQgcGVyIFNoYWRlciBFbmdpbmUgKGRl
ZmF1bHQgZGVwZW5kaW5nIG9uIGdmeCkiKTsKLW1vZHVsZV9wYXJhbV9uYW1lZChjbnRsX3NiX2J1
Zl9wZXJfc2UsIGFtZGdwdV9jbnRsX3NiX2J1Zl9wZXJfc2UsIGludCwgMDQ0NCk7Ci0KLS8qKgot
ICogRE9DOiBwYXJhbV9idWZfcGVyX3NlIChpbnQpCi0gKiBPdmVycmlkZSB0aGUgc2l6ZSBvZiBP
ZmYtQ2hpcCBQYXJhbWV0ZXIgQ2FjaGUgcGVyIFNoYWRlciBFbmdpbmUgaW4gQnl0ZS4KLSAqIFRo
ZSBkZWZhdWx0IGlzIDAgKGRlcGVuZGluZyBvbiBnZngpLgotICovCi1NT0RVTEVfUEFSTV9ERVND
KHBhcmFtX2J1Zl9wZXJfc2UsICJ0aGUgc2l6ZSBvZiBPZmYtQ2hpcCBQYXJhbWV0ZXIgQ2FjaGUg
cGVyIFNoYWRlciBFbmdpbmUgKGRlZmF1bHQgZGVwZW5kaW5nIG9uIGdmeCkiKTsKLW1vZHVsZV9w
YXJhbV9uYW1lZChwYXJhbV9idWZfcGVyX3NlLCBhbWRncHVfcGFyYW1fYnVmX3Blcl9zZSwgaW50
LCAwNDQ0KTsKLQogLyoqCiAgKiBET0M6IGpvYl9oYW5nX2xpbWl0IChpbnQpCiAgKiBTZXQgaG93
IG11Y2ggdGltZSBhbGxvdyBhIGpvYiBoYW5nIGFuZCBub3QgZHJvcCBpdC4gVGhlIGRlZmF1bHQg
aXMgMC4KICAqLwogTU9EVUxFX1BBUk1fREVTQyhqb2JfaGFuZ19saW1pdCwgImhvdyBtdWNoIHRp
bWUgYWxsb3cgYSBqb2IgaGFuZyBhbmQgbm90IGRyb3AgaXQgKGRlZmF1bHQgMCkiKTsKIG1vZHVs
ZV9wYXJhbV9uYW1lZChqb2JfaGFuZ19saW1pdCwgYW1kZ3B1X2pvYl9oYW5nX2xpbWl0LCBpbnQg
LDA0NDQpOwogCiAvKioKICAqIERPQzogbGJwdyAoaW50KQogICogT3ZlcnJpZGUgTG9hZCBCYWxh
bmNpbmcgUGVyIFdhdHQgKExCUFcpIHN1cHBvcnQgKDEgPSBlbmFibGUsIDAgPSBkaXNhYmxlKS4g
VGhlIGRlZmF1bHQgaXMgLTEgKGF1dG8sIGVuYWJsZWQpLgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dmeC5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2dmeC5oCmluZGV4IDZlZDA1NjBkNzI5OS4uNTljNTQ2NGM5NmJlIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ2Z4LmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dmeC5oCkBAIC0xOTMsNDIgKzE5MywyMCBAQCBz
dHJ1Y3QgYW1kZ3B1X2dmeF9mdW5jcyB7CiAJCQkJdWludDMyX3Qgc2l6ZSwgdWludDMyX3QgKmRz
dCk7CiAJdm9pZCAoKnJlYWRfd2F2ZV9zZ3Bycykoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
IHVpbnQzMl90IHNpbWQsCiAJCQkJdWludDMyX3Qgd2F2ZSwgdWludDMyX3Qgc3RhcnQsIHVpbnQz
Ml90IHNpemUsCiAJCQkJdWludDMyX3QgKmRzdCk7CiAJdm9pZCAoKnNlbGVjdF9tZV9waXBlX3Ep
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1MzIgbWUsIHUzMiBwaXBlLAogCQkJCSB1MzIg
cXVldWUsIHUzMiB2bWlkKTsKIAlpbnQgKCpyYXNfZXJyb3JfaW5qZWN0KShzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqYWRldiwgdm9pZCAqaW5qZWN0X2lmKTsKIAlpbnQgKCpxdWVyeV9yYXNfZXJyb3Jf
Y291bnQpIChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgdm9pZCAqcmFzX2Vycm9yX3N0YXR1
cyk7CiB9OwogCi1zdHJ1Y3QgYW1kZ3B1X25nZ19idWYgewotCXN0cnVjdCBhbWRncHVfYm8JKmJv
OwotCXVpbnQ2NF90CQlncHVfYWRkcjsKLQl1aW50MzJfdAkJc2l6ZTsKLQl1aW50MzJfdAkJYm9f
c2l6ZTsKLX07Ci0KLWVudW0gewotCU5HR19QUklNID0gMCwKLQlOR0dfUE9TLAotCU5HR19DTlRM
LAotCU5HR19QQVJBTSwKLQlOR0dfQlVGX01BWAotfTsKLQotc3RydWN0IGFtZGdwdV9uZ2cgewot
CXN0cnVjdCBhbWRncHVfbmdnX2J1ZglidWZbTkdHX0JVRl9NQVhdOwotCXVpbnQzMl90CQlnZHNf
cmVzZXJ2ZV9hZGRyOwotCXVpbnQzMl90CQlnZHNfcmVzZXJ2ZV9zaXplOwotCWJvb2wJCQlpbml0
OwotfTsKLQogc3RydWN0IHNxX3dvcmsgewogCXN0cnVjdCB3b3JrX3N0cnVjdAl3b3JrOwogCXVu
c2lnbmVkIGloX2RhdGE7CiB9OwogCiBzdHJ1Y3QgYW1kZ3B1X3BmcCB7CiAJc3RydWN0IGFtZGdw
dV9ibwkJKnBmcF9md19vYmo7CiAJdWludDY0X3QJCQlwZnBfZndfZ3B1X2FkZHI7CiAJdWludDMy
X3QJCQkqcGZwX2Z3X3B0cjsKIH07CkBAIC0zMDMsMjMgKzI4MSwyMCBAQCBzdHJ1Y3QgYW1kZ3B1
X2dmeCB7CiAJdWludDMyX3QJCQlnZnhfY3VycmVudF9zdGF0dXM7CiAJLyogY2UgcmFtIHNpemUq
LwogCXVuc2lnbmVkCQkJY2VfcmFtX3NpemU7CiAJc3RydWN0IGFtZGdwdV9jdV9pbmZvCQljdV9p
bmZvOwogCWNvbnN0IHN0cnVjdCBhbWRncHVfZ2Z4X2Z1bmNzCSpmdW5jczsKIAogCS8qIHJlc2V0
IG1hc2sgKi8KIAl1aW50MzJfdCAgICAgICAgICAgICAgICAgICAgICAgIGdyYm1fc29mdF9yZXNl
dDsKIAl1aW50MzJfdCAgICAgICAgICAgICAgICAgICAgICAgIHNyYm1fc29mdF9yZXNldDsKIAot
CS8qIE5HRyAqLwotCXN0cnVjdCBhbWRncHVfbmdnCQluZ2c7Ci0KIAkvKiBnZnggb2ZmICovCiAJ
Ym9vbCAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZnhfb2ZmX3N0YXRlOyAvKiB0cnVlOiBl
bmFibGVkLCBmYWxzZTogZGlzYWJsZWQgKi8KIAlzdHJ1Y3QgbXV0ZXggICAgICAgICAgICAgICAg
ICAgIGdmeF9vZmZfbXV0ZXg7CiAJdWludDMyX3QgICAgICAgICAgICAgICAgICAgICAgICBnZnhf
b2ZmX3JlcV9jb3VudDsgLyogZGVmYXVsdCAxLCBlbmFibGUgZ2Z4IG9mZjogZGVjIDEsIGRpc2Fi
bGUgZ2Z4IG9mZjogYWRkIDEgKi8KIAlzdHJ1Y3QgZGVsYXllZF93b3JrICAgICAgICAgICAgIGdm
eF9vZmZfZGVsYXlfd29yazsKIAogCS8qIHBpcGUgcmVzZXJ2YXRpb24gKi8KIAlzdHJ1Y3QgbXV0
ZXgJCQlwaXBlX3Jlc2VydmVfbXV0ZXg7CiAJREVDTEFSRV9CSVRNQVAJCQkocGlwZV9yZXNlcnZl
X2JpdG1hcCwgQU1ER1BVX01BWF9DT01QVVRFX1FVRVVFUyk7CiAKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9rbXMuYwppbmRleCA3YzY4OTc0ZmU4ZjIuLjZjYzc5ZDNhNGUyNiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ttcy5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYwpAQCAtNzYwLDMxICs3NjAsMjAg
QEAgc3RhdGljIGludCBhbWRncHVfaW5mb19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2
b2lkICpkYXRhLCBzdHJ1Y3QgZHJtX2ZpbGUKIAkJZGV2X2luZm8uY2VfcmFtX3NpemUgPSBhZGV2
LT5nZnguY2VfcmFtX3NpemU7CiAJCW1lbWNweSgmZGV2X2luZm8uY3VfYW9fYml0bWFwWzBdLCAm
YWRldi0+Z2Z4LmN1X2luZm8uYW9fY3VfYml0bWFwWzBdLAogCQkgICAgICAgc2l6ZW9mKGFkZXYt
PmdmeC5jdV9pbmZvLmFvX2N1X2JpdG1hcCkpOwogCQltZW1jcHkoJmRldl9pbmZvLmN1X2JpdG1h
cFswXSwgJmFkZXYtPmdmeC5jdV9pbmZvLmJpdG1hcFswXSwKIAkJICAgICAgIHNpemVvZihhZGV2
LT5nZnguY3VfaW5mby5iaXRtYXApKTsKIAkJZGV2X2luZm8udnJhbV90eXBlID0gYWRldi0+Z21j
LnZyYW1fdHlwZTsKIAkJZGV2X2luZm8udnJhbV9iaXRfd2lkdGggPSBhZGV2LT5nbWMudnJhbV93
aWR0aDsKIAkJZGV2X2luZm8udmNlX2hhcnZlc3RfY29uZmlnID0gYWRldi0+dmNlLmhhcnZlc3Rf
Y29uZmlnOwogCQlkZXZfaW5mby5nY19kb3VibGVfb2ZmY2hpcF9sZHNfYnVmID0KIAkJCWFkZXYt
PmdmeC5jb25maWcuZG91YmxlX29mZmNoaXBfbGRzX2J1ZjsKLQotCQlpZiAoYW1kZ3B1X25nZykg
ewotCQkJZGV2X2luZm8ucHJpbV9idWZfZ3B1X2FkZHIgPSBhZGV2LT5nZngubmdnLmJ1ZltOR0df
UFJJTV0uZ3B1X2FkZHI7Ci0JCQlkZXZfaW5mby5wcmltX2J1Zl9zaXplID0gYWRldi0+Z2Z4Lm5n
Zy5idWZbTkdHX1BSSU1dLnNpemU7Ci0JCQlkZXZfaW5mby5wb3NfYnVmX2dwdV9hZGRyID0gYWRl
di0+Z2Z4Lm5nZy5idWZbTkdHX1BPU10uZ3B1X2FkZHI7Ci0JCQlkZXZfaW5mby5wb3NfYnVmX3Np
emUgPSBhZGV2LT5nZngubmdnLmJ1ZltOR0dfUE9TXS5zaXplOwotCQkJZGV2X2luZm8uY250bF9z
Yl9idWZfZ3B1X2FkZHIgPSBhZGV2LT5nZngubmdnLmJ1ZltOR0dfQ05UTF0uZ3B1X2FkZHI7Ci0J
CQlkZXZfaW5mby5jbnRsX3NiX2J1Zl9zaXplID0gYWRldi0+Z2Z4Lm5nZy5idWZbTkdHX0NOVExd
LnNpemU7Ci0JCQlkZXZfaW5mby5wYXJhbV9idWZfZ3B1X2FkZHIgPSBhZGV2LT5nZngubmdnLmJ1
ZltOR0dfUEFSQU1dLmdwdV9hZGRyOwotCQkJZGV2X2luZm8ucGFyYW1fYnVmX3NpemUgPSBhZGV2
LT5nZngubmdnLmJ1ZltOR0dfUEFSQU1dLnNpemU7Ci0JCX0KIAkJZGV2X2luZm8ud2F2ZV9mcm9u
dF9zaXplID0gYWRldi0+Z2Z4LmN1X2luZm8ud2F2ZV9mcm9udF9zaXplOwogCQlkZXZfaW5mby5u
dW1fc2hhZGVyX3Zpc2libGVfdmdwcnMgPSBhZGV2LT5nZnguY29uZmlnLm1heF9ncHJzOwogCQlk
ZXZfaW5mby5udW1fY3VfcGVyX3NoID0gYWRldi0+Z2Z4LmNvbmZpZy5tYXhfY3VfcGVyX3NoOwog
CQlkZXZfaW5mby5udW1fdGNjX2Jsb2NrcyA9IGFkZXYtPmdmeC5jb25maWcubWF4X3RleHR1cmVf
Y2hhbm5lbF9jYWNoZXM7CiAJCWRldl9pbmZvLmdzX3ZndF90YWJsZV9kZXB0aCA9IGFkZXYtPmdm
eC5jb25maWcuZ3Nfdmd0X3RhYmxlX2RlcHRoOwogCQlkZXZfaW5mby5nc19wcmltX2J1ZmZlcl9k
ZXB0aCA9IGFkZXYtPmdmeC5jb25maWcuZ3NfcHJpbV9idWZmZXJfZGVwdGg7CiAJCWRldl9pbmZv
Lm1heF9nc193YXZlc19wZXJfdmd0ID0gYWRldi0+Z2Z4LmNvbmZpZy5tYXhfZ3NfdGhyZWFkczsK
IAogCQlpZiAoYWRldi0+ZmFtaWx5ID49IEFNREdQVV9GQU1JTFlfTlYpCiAJCQlkZXZfaW5mby5w
YV9zY190aWxlX3N0ZWVyaW5nX292ZXJyaWRlID0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2dmeF92OV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhf
djlfMC5jCmluZGV4IDlhMWY5MWNmMGVlOC4uMjY2ZWY4NzRmMmEzIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2dmeF92OV8wLmMKQEAgLTE5NDYsMjA0ICsxOTQ2LDIwIEBAIHN0YXRpYyBpbnQg
Z2Z4X3Y5XzBfZ3B1X2Vhcmx5X2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiAJCQkJ
CU5VTV9TSEFERVJfRU5HSU5FUyk7CiAJYWRldi0+Z2Z4LmNvbmZpZy5nYl9hZGRyX2NvbmZpZ19m
aWVsZHMucGlwZV9pbnRlcmxlYXZlX3NpemUgPSAxIDw8ICg4ICsKIAkJCVJFR19HRVRfRklFTEQo
CiAJCQkJCWFkZXYtPmdmeC5jb25maWcuZ2JfYWRkcl9jb25maWcsCiAJCQkJCUdCX0FERFJfQ09O
RklHLAogCQkJCQlQSVBFX0lOVEVSTEVBVkVfU0laRSkpOwogCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgZ2Z4X3Y5XzBfbmdnX2NyZWF0ZV9idWYoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYsCi0JCQkJICAgc3RydWN0IGFtZGdwdV9uZ2dfYnVmICpuZ2dfYnVmLAotCQkJCSAgIGludCBz
aXplX3NlLAotCQkJCSAgIGludCBkZWZhdWx0X3NpemVfc2UpCi17Ci0JaW50IHI7Ci0KLQlpZiAo
c2l6ZV9zZSA8IDApIHsKLQkJZGV2X2VycihhZGV2LT5kZXYsICJCdWZmZXIgc2l6ZSBpcyBpbnZh
bGlkOiAlZFxuIiwgc2l6ZV9zZSk7Ci0JCXJldHVybiAtRUlOVkFMOwotCX0KLQlzaXplX3NlID0g
c2l6ZV9zZSA/IHNpemVfc2UgOiBkZWZhdWx0X3NpemVfc2U7Ci0KLQluZ2dfYnVmLT5zaXplID0g
c2l6ZV9zZSAqIGFkZXYtPmdmeC5jb25maWcubWF4X3NoYWRlcl9lbmdpbmVzOwotCXIgPSBhbWRn
cHVfYm9fY3JlYXRlX2tlcm5lbChhZGV2LCBuZ2dfYnVmLT5zaXplLAotCQkJCSAgICBQQUdFX1NJ
WkUsIEFNREdQVV9HRU1fRE9NQUlOX1ZSQU0sCi0JCQkJICAgICZuZ2dfYnVmLT5ibywKLQkJCQkg
ICAgJm5nZ19idWYtPmdwdV9hZGRyLAotCQkJCSAgICBOVUxMKTsKLQlpZiAocikgewotCQlkZXZf
ZXJyKGFkZXYtPmRldiwgIiglZCkgZmFpbGVkIHRvIGNyZWF0ZSBOR0cgYnVmZmVyXG4iLCByKTsK
LQkJcmV0dXJuIHI7Ci0JfQotCW5nZ19idWYtPmJvX3NpemUgPSBhbWRncHVfYm9fc2l6ZShuZ2df
YnVmLT5ibyk7Ci0KLQlyZXR1cm4gcjsKLX0KLQotc3RhdGljIGludCBnZnhfdjlfMF9uZ2dfZmlu
aShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKLXsKLQlpbnQgaTsKLQotCWZvciAoaSA9IDA7
IGkgPCBOR0dfQlVGX01BWDsgaSsrKQotCQlhbWRncHVfYm9fZnJlZV9rZXJuZWwoJmFkZXYtPmdm
eC5uZ2cuYnVmW2ldLmJvLAotCQkJCSAgICAgICZhZGV2LT5nZngubmdnLmJ1ZltpXS5ncHVfYWRk
ciwKLQkJCQkgICAgICBOVUxMKTsKLQotCW1lbXNldCgmYWRldi0+Z2Z4Lm5nZy5idWZbMF0sIDAs
Ci0JCQlzaXplb2Yoc3RydWN0IGFtZGdwdV9uZ2dfYnVmKSAqIE5HR19CVUZfTUFYKTsKLQotCWFk
ZXYtPmdmeC5uZ2cuaW5pdCA9IGZhbHNlOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQg
Z2Z4X3Y5XzBfbmdnX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCi17Ci0JaW50IHI7
Ci0KLQlpZiAoIWFtZGdwdV9uZ2cgfHwgYWRldi0+Z2Z4Lm5nZy5pbml0ID09IHRydWUpCi0JCXJl
dHVybiAwOwotCi0JLyogR0RTIHJlc2VydmUgbWVtb3J5OiA2NCBieXRlcyBhbGlnbm1lbnQgKi8K
LQlhZGV2LT5nZngubmdnLmdkc19yZXNlcnZlX3NpemUgPSBBTElHTig1ICogNCwgMHg0MCk7Ci0J
YWRldi0+Z2RzLmdkc19zaXplIC09IGFkZXYtPmdmeC5uZ2cuZ2RzX3Jlc2VydmVfc2l6ZTsKLQlh
ZGV2LT5nZngubmdnLmdkc19yZXNlcnZlX2FkZHIgPSBSUkVHMzJfU09DMTUoR0MsIDAsIG1tR0RT
X1ZNSUQwX0JBU0UpOwotCWFkZXYtPmdmeC5uZ2cuZ2RzX3Jlc2VydmVfYWRkciArPSBSUkVHMzJf
U09DMTUoR0MsIDAsIG1tR0RTX1ZNSUQwX1NJWkUpOwotCi0JLyogUHJpbWl0aXZlIEJ1ZmZlciAq
LwotCXIgPSBnZnhfdjlfMF9uZ2dfY3JlYXRlX2J1ZihhZGV2LCAmYWRldi0+Z2Z4Lm5nZy5idWZb
TkdHX1BSSU1dLAotCQkJCSAgICBhbWRncHVfcHJpbV9idWZfcGVyX3NlLAotCQkJCSAgICA2NCAq
IDEwMjQpOwotCWlmIChyKSB7Ci0JCWRldl9lcnIoYWRldi0+ZGV2LCAiRmFpbGVkIHRvIGNyZWF0
ZSBQcmltaXRpdmUgQnVmZmVyXG4iKTsKLQkJZ290byBlcnI7Ci0JfQotCi0JLyogUG9zaXRpb24g
QnVmZmVyICovCi0JciA9IGdmeF92OV8wX25nZ19jcmVhdGVfYnVmKGFkZXYsICZhZGV2LT5nZngu
bmdnLmJ1ZltOR0dfUE9TXSwKLQkJCQkgICAgYW1kZ3B1X3Bvc19idWZfcGVyX3NlLAotCQkJCSAg
ICAyNTYgKiAxMDI0KTsKLQlpZiAocikgewotCQlkZXZfZXJyKGFkZXYtPmRldiwgIkZhaWxlZCB0
byBjcmVhdGUgUG9zaXRpb24gQnVmZmVyXG4iKTsKLQkJZ290byBlcnI7Ci0JfQotCi0JLyogQ29u
dHJvbCBTaWRlYmFuZCAqLwotCXIgPSBnZnhfdjlfMF9uZ2dfY3JlYXRlX2J1ZihhZGV2LCAmYWRl
di0+Z2Z4Lm5nZy5idWZbTkdHX0NOVExdLAotCQkJCSAgICBhbWRncHVfY250bF9zYl9idWZfcGVy
X3NlLAotCQkJCSAgICAyNTYpOwotCWlmIChyKSB7Ci0JCWRldl9lcnIoYWRldi0+ZGV2LCAiRmFp
bGVkIHRvIGNyZWF0ZSBDb250cm9sIFNpZGViYW5kIEJ1ZmZlclxuIik7Ci0JCWdvdG8gZXJyOwot
CX0KLQotCS8qIFBhcmFtZXRlciBDYWNoZSwgbm90IGNyZWF0ZWQgYnkgZGVmYXVsdCAqLwotCWlm
IChhbWRncHVfcGFyYW1fYnVmX3Blcl9zZSA8PSAwKQotCQlnb3RvIG91dDsKLQotCXIgPSBnZnhf
djlfMF9uZ2dfY3JlYXRlX2J1ZihhZGV2LCAmYWRldi0+Z2Z4Lm5nZy5idWZbTkdHX1BBUkFNXSwK
LQkJCQkgICAgYW1kZ3B1X3BhcmFtX2J1Zl9wZXJfc2UsCi0JCQkJICAgIDUxMiAqIDEwMjQpOwot
CWlmIChyKSB7Ci0JCWRldl9lcnIoYWRldi0+ZGV2LCAiRmFpbGVkIHRvIGNyZWF0ZSBQYXJhbWV0
ZXIgQ2FjaGVcbiIpOwotCQlnb3RvIGVycjsKLQl9Ci0KLW91dDoKLQlhZGV2LT5nZngubmdnLmlu
aXQgPSB0cnVlOwotCXJldHVybiAwOwotZXJyOgotCWdmeF92OV8wX25nZ19maW5pKGFkZXYpOwot
CXJldHVybiByOwotfQotCi1zdGF0aWMgaW50IGdmeF92OV8wX25nZ19lbihzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqYWRldikKLXsKLQlzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcgPSAmYWRldi0+Z2Z4
LmdmeF9yaW5nWzBdOwotCWludCByOwotCXUzMiBkYXRhLCBiYXNlOwotCi0JaWYgKCFhbWRncHVf
bmdnKQotCQlyZXR1cm4gMDsKLQotCS8qIFByb2dyYW0gYnVmZmVyIHNpemUgKi8KLQlkYXRhID0g
UkVHX1NFVF9GSUVMRCgwLCBXRF9CVUZfUkVTT1VSQ0VfMSwgSU5ERVhfQlVGX1NJWkUsCi0JCQkg
ICAgIGFkZXYtPmdmeC5uZ2cuYnVmW05HR19QUklNXS5zaXplID4+IDgpOwotCWRhdGEgPSBSRUdf
U0VUX0ZJRUxEKGRhdGEsIFdEX0JVRl9SRVNPVVJDRV8xLCBQT1NfQlVGX1NJWkUsCi0JCQkgICAg
IGFkZXYtPmdmeC5uZ2cuYnVmW05HR19QT1NdLnNpemUgPj4gOCk7Ci0JV1JFRzMyX1NPQzE1KEdD
LCAwLCBtbVdEX0JVRl9SRVNPVVJDRV8xLCBkYXRhKTsKLQotCWRhdGEgPSBSRUdfU0VUX0ZJRUxE
KDAsIFdEX0JVRl9SRVNPVVJDRV8yLCBDTlRMX1NCX0JVRl9TSVpFLAotCQkJICAgICBhZGV2LT5n
ZngubmdnLmJ1ZltOR0dfQ05UTF0uc2l6ZSA+PiA4KTsKLQlkYXRhID0gUkVHX1NFVF9GSUVMRChk
YXRhLCBXRF9CVUZfUkVTT1VSQ0VfMiwgUEFSQU1fQlVGX1NJWkUsCi0JCQkgICAgIGFkZXYtPmdm
eC5uZ2cuYnVmW05HR19QQVJBTV0uc2l6ZSA+PiAxMCk7Ci0JV1JFRzMyX1NPQzE1KEdDLCAwLCBt
bVdEX0JVRl9SRVNPVVJDRV8yLCBkYXRhKTsKLQotCS8qIFByb2dyYW0gYnVmZmVyIGJhc2UgYWRk
cmVzcyAqLwotCWJhc2UgPSBsb3dlcl8zMl9iaXRzKGFkZXYtPmdmeC5uZ2cuYnVmW05HR19QUklN
XS5ncHVfYWRkcik7Ci0JZGF0YSA9IFJFR19TRVRfRklFTEQoMCwgV0RfSU5ERVhfQlVGX0JBU0Us
IEJBU0UsIGJhc2UpOwotCVdSRUczMl9TT0MxNShHQywgMCwgbW1XRF9JTkRFWF9CVUZfQkFTRSwg
ZGF0YSk7Ci0KLQliYXNlID0gdXBwZXJfMzJfYml0cyhhZGV2LT5nZngubmdnLmJ1ZltOR0dfUFJJ
TV0uZ3B1X2FkZHIpOwotCWRhdGEgPSBSRUdfU0VUX0ZJRUxEKDAsIFdEX0lOREVYX0JVRl9CQVNF
X0hJLCBCQVNFX0hJLCBiYXNlKTsKLQlXUkVHMzJfU09DMTUoR0MsIDAsIG1tV0RfSU5ERVhfQlVG
X0JBU0VfSEksIGRhdGEpOwotCi0JYmFzZSA9IGxvd2VyXzMyX2JpdHMoYWRldi0+Z2Z4Lm5nZy5i
dWZbTkdHX1BPU10uZ3B1X2FkZHIpOwotCWRhdGEgPSBSRUdfU0VUX0ZJRUxEKDAsIFdEX1BPU19C
VUZfQkFTRSwgQkFTRSwgYmFzZSk7Ci0JV1JFRzMyX1NPQzE1KEdDLCAwLCBtbVdEX1BPU19CVUZf
QkFTRSwgZGF0YSk7Ci0KLQliYXNlID0gdXBwZXJfMzJfYml0cyhhZGV2LT5nZngubmdnLmJ1ZltO
R0dfUE9TXS5ncHVfYWRkcik7Ci0JZGF0YSA9IFJFR19TRVRfRklFTEQoMCwgV0RfUE9TX0JVRl9C
QVNFX0hJLCBCQVNFX0hJLCBiYXNlKTsKLQlXUkVHMzJfU09DMTUoR0MsIDAsIG1tV0RfUE9TX0JV
Rl9CQVNFX0hJLCBkYXRhKTsKLQotCWJhc2UgPSBsb3dlcl8zMl9iaXRzKGFkZXYtPmdmeC5uZ2cu
YnVmW05HR19DTlRMXS5ncHVfYWRkcik7Ci0JZGF0YSA9IFJFR19TRVRfRklFTEQoMCwgV0RfQ05U
TF9TQl9CVUZfQkFTRSwgQkFTRSwgYmFzZSk7Ci0JV1JFRzMyX1NPQzE1KEdDLCAwLCBtbVdEX0NO
VExfU0JfQlVGX0JBU0UsIGRhdGEpOwotCi0JYmFzZSA9IHVwcGVyXzMyX2JpdHMoYWRldi0+Z2Z4
Lm5nZy5idWZbTkdHX0NOVExdLmdwdV9hZGRyKTsKLQlkYXRhID0gUkVHX1NFVF9GSUVMRCgwLCBX
RF9DTlRMX1NCX0JVRl9CQVNFX0hJLCBCQVNFX0hJLCBiYXNlKTsKLQlXUkVHMzJfU09DMTUoR0Ms
IDAsIG1tV0RfQ05UTF9TQl9CVUZfQkFTRV9ISSwgZGF0YSk7Ci0KLQkvKiBDbGVhciBHRFMgcmVz
ZXJ2ZWQgbWVtb3J5ICovCi0JciA9IGFtZGdwdV9yaW5nX2FsbG9jKHJpbmcsIDE3KTsKLQlpZiAo
cikgewotCQlEUk1fRVJST1IoImFtZGdwdTogTkdHIGZhaWxlZCB0byBsb2NrIHJpbmcgJXMgKCVk
KS5cbiIsCi0JCQkgIHJpbmctPm5hbWUsIHIpOwotCQlyZXR1cm4gcjsKLQl9Ci0KLQlnZnhfdjlf
MF93cml0ZV9kYXRhX3RvX3JlZyhyaW5nLCAwLCBmYWxzZSwKLQkJCQkgICBTT0MxNV9SRUdfT0ZG
U0VUKEdDLCAwLCBtbUdEU19WTUlEMF9TSVpFKSwKLQkJCSAgICAgICAgICAgKGFkZXYtPmdkcy5n
ZHNfc2l6ZSArCi0JCQkJICAgIGFkZXYtPmdmeC5uZ2cuZ2RzX3Jlc2VydmVfc2l6ZSkpOwotCi0J
YW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgUEFDS0VUMyhQQUNLRVQzX0RNQV9EQVRBLCA1KSk7Ci0J
YW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgKFBBQ0tFVDNfRE1BX0RBVEFfQ1BfU1lOQyB8Ci0JCQkJ
UEFDS0VUM19ETUFfREFUQV9EU1RfU0VMKDEpIHwKLQkJCQlQQUNLRVQzX0RNQV9EQVRBX1NSQ19T
RUwoMikpKTsKLQlhbWRncHVfcmluZ193cml0ZShyaW5nLCAwKTsKLQlhbWRncHVfcmluZ193cml0
ZShyaW5nLCAwKTsKLQlhbWRncHVfcmluZ193cml0ZShyaW5nLCBhZGV2LT5nZngubmdnLmdkc19y
ZXNlcnZlX2FkZHIpOwotCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIDApOwotCWFtZGdwdV9yaW5n
X3dyaXRlKHJpbmcsIFBBQ0tFVDNfRE1BX0RBVEFfQ01EX1JBV19XQUlUIHwKLQkJCQlhZGV2LT5n
ZngubmdnLmdkc19yZXNlcnZlX3NpemUpOwotCi0JZ2Z4X3Y5XzBfd3JpdGVfZGF0YV90b19yZWco
cmluZywgMCwgZmFsc2UsCi0JCQkJICAgU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1HRFNfVk1J
RDBfU0laRSksIDApOwotCi0JYW1kZ3B1X3JpbmdfY29tbWl0KHJpbmcpOwotCi0JcmV0dXJuIDA7
Ci19Ci0KIHN0YXRpYyBpbnQgZ2Z4X3Y5XzBfY29tcHV0ZV9yaW5nX2luaXQoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsIGludCByaW5nX2lkLAogCQkJCSAgICAgIGludCBtZWMsIGludCBwaXBl
LCBpbnQgcXVldWUpCiB7CiAJaW50IHI7CiAJdW5zaWduZWQgaXJxX3R5cGU7CiAJc3RydWN0IGFt
ZGdwdV9yaW5nICpyaW5nID0gJmFkZXYtPmdmeC5jb21wdXRlX3JpbmdbcmluZ19pZF07CiAKIAly
aW5nID0gJmFkZXYtPmdmeC5jb21wdXRlX3JpbmdbcmluZ19pZF07CiAKIAkvKiBtZWMwIGlzIG1l
MSAqLwpAQCAtMjI5NywyNCArMjExMywyMCBAQCBzdGF0aWMgaW50IGdmeF92OV8wX3N3X2luaXQo
dm9pZCAqaGFuZGxlKQogCXIgPSBhbWRncHVfZ2Z4X21xZF9zd19pbml0KGFkZXYsIHNpemVvZihz
dHJ1Y3QgdjlfbXFkX2FsbG9jYXRpb24pKTsKIAlpZiAocikKIAkJcmV0dXJuIHI7CiAKIAlhZGV2
LT5nZnguY2VfcmFtX3NpemUgPSAweDgwMDA7CiAKIAlyID0gZ2Z4X3Y5XzBfZ3B1X2Vhcmx5X2lu
aXQoYWRldik7CiAJaWYgKHIpCiAJCXJldHVybiByOwogCi0JciA9IGdmeF92OV8wX25nZ19pbml0
KGFkZXYpOwotCWlmIChyKQotCQlyZXR1cm4gcjsKLQogCXJldHVybiAwOwogfQogCiAKIHN0YXRp
YyBpbnQgZ2Z4X3Y5XzBfc3dfZmluaSh2b2lkICpoYW5kbGUpCiB7CiAJaW50IGk7CiAJc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7CiAK
IAlpZiAoYW1kZ3B1X3Jhc19pc19zdXBwb3J0ZWQoYWRldiwgQU1ER1BVX1JBU19CTE9DS19fR0ZY
KSAmJgpAQCAtMjMzNCwyMSArMjE0NiwyMCBAQCBzdGF0aWMgaW50IGdmeF92OV8wX3N3X2Zpbmko
dm9pZCAqaGFuZGxlKQogCWZvciAoaSA9IDA7IGkgPCBhZGV2LT5nZngubnVtX2dmeF9yaW5nczsg
aSsrKQogCQlhbWRncHVfcmluZ19maW5pKCZhZGV2LT5nZnguZ2Z4X3JpbmdbaV0pOwogCWZvciAo
aSA9IDA7IGkgPCBhZGV2LT5nZngubnVtX2NvbXB1dGVfcmluZ3M7IGkrKykKIAkJYW1kZ3B1X3Jp
bmdfZmluaSgmYWRldi0+Z2Z4LmNvbXB1dGVfcmluZ1tpXSk7CiAKIAlhbWRncHVfZ2Z4X21xZF9z
d19maW5pKGFkZXYpOwogCWFtZGdwdV9nZnhfa2lxX2ZyZWVfcmluZygmYWRldi0+Z2Z4LmtpcS5y
aW5nLCAmYWRldi0+Z2Z4LmtpcS5pcnEpOwogCWFtZGdwdV9nZnhfa2lxX2ZpbmkoYWRldik7CiAK
IAlnZnhfdjlfMF9tZWNfZmluaShhZGV2KTsKLQlnZnhfdjlfMF9uZ2dfZmluaShhZGV2KTsKIAlh
bWRncHVfYm9fdW5yZWYoJmFkZXYtPmdmeC5ybGMuY2xlYXJfc3RhdGVfb2JqKTsKIAlpZiAoYWRl
di0+YXNpY190eXBlID09IENISVBfUkFWRU4gfHwgYWRldi0+YXNpY190eXBlID09IENISVBfUkVO
T0lSKSB7CiAJCWFtZGdwdV9ib19mcmVlX2tlcm5lbCgmYWRldi0+Z2Z4LnJsYy5jcF90YWJsZV9v
YmosCiAJCQkJJmFkZXYtPmdmeC5ybGMuY3BfdGFibGVfZ3B1X2FkZHIsCiAJCQkJKHZvaWQgKiop
JmFkZXYtPmdmeC5ybGMuY3BfdGFibGVfcHRyKTsKIAl9CiAJZ2Z4X3Y5XzBfZnJlZV9taWNyb2Nv
ZGUoYWRldik7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTM4NjQsMjYgKzM2NzUsMjAgQEAgc3RhdGlj
IGludCBnZnhfdjlfMF9od19pbml0KHZvaWQgKmhhbmRsZSkKIAkJcmV0dXJuIHI7CiAKIAlyID0g
YWRldi0+Z2Z4LnJsYy5mdW5jcy0+cmVzdW1lKGFkZXYpOwogCWlmIChyKQogCQlyZXR1cm4gcjsK
IAogCXIgPSBnZnhfdjlfMF9jcF9yZXN1bWUoYWRldik7CiAJaWYgKHIpCiAJCXJldHVybiByOwog
Ci0JaWYgKGFkZXYtPmFzaWNfdHlwZSAhPSBDSElQX0FSQ1RVUlVTKSB7Ci0JCXIgPSBnZnhfdjlf
MF9uZ2dfZW4oYWRldik7Ci0JCWlmIChyKQotCQkJcmV0dXJuIHI7Ci0JfQotCiAJcmV0dXJuIHI7
CiB9CiAKIHN0YXRpYyBpbnQgZ2Z4X3Y5XzBfa2NxX2Rpc2FibGUoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYpCiB7CiAJaW50IHIsIGk7CiAJc3RydWN0IGFtZGdwdV9yaW5nICpraXFfcmluZyA9
ICZhZGV2LT5nZngua2lxLnJpbmc7CiAKIAlyID0gYW1kZ3B1X3JpbmdfYWxsb2Moa2lxX3Jpbmcs
IDYgKiBhZGV2LT5nZngubnVtX2NvbXB1dGVfcmluZ3MpOwogCWlmIChyKQotLSAKMi4xNy4xCgpf
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1h
aWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
