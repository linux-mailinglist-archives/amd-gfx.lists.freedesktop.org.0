Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7404DB59D
	for <lists+amd-gfx@lfdr.de>; Sun, 28 Apr 2019 09:44:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3B732891AB;
	Sun, 28 Apr 2019 07:44:17 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM01-BY2-obe.outbound.protection.outlook.com
 (mail-eopbgr810043.outbound.protection.outlook.com [40.107.81.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5AAAC8913E
 for <amd-gfx@lists.freedesktop.org>; Sun, 28 Apr 2019 07:44:14 +0000 (UTC)
Received: from BYAPR12MB3176.namprd12.prod.outlook.com (20.179.92.82) by
 BYAPR12MB2933.namprd12.prod.outlook.com (20.179.91.202) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1835.12; Sun, 28 Apr 2019 07:44:13 +0000
Received: from BYAPR12MB3176.namprd12.prod.outlook.com
 ([fe80::9118:73f2:809c:22c7]) by BYAPR12MB3176.namprd12.prod.outlook.com
 ([fe80::9118:73f2:809c:22c7%4]) with mapi id 15.20.1835.010; Sun, 28 Apr 2019
 07:44:13 +0000
From: "Kuehling, Felix" <Felix.Kuehling@amd.com>
To: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 12/27] drm/amdkfd: Allocate hiq and sdma mqd from mqd trunk
Thread-Topic: [PATCH 12/27] drm/amdkfd: Allocate hiq and sdma mqd from mqd
 trunk
Thread-Index: AQHU/ZYr8/r2y8dTS0mkvBIPhUDTpA==
Date: Sun, 28 Apr 2019 07:44:11 +0000
Message-ID: <20190428074331.30107-13-Felix.Kuehling@amd.com>
References: <20190428074331.30107-1-Felix.Kuehling@amd.com>
In-Reply-To: <20190428074331.30107-1-Felix.Kuehling@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [165.204.55.251]
x-mailer: git-send-email 2.17.1
x-clientproxiedby: YTXPR0101CA0015.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00::28) To BYAPR12MB3176.namprd12.prod.outlook.com
 (2603:10b6:a03:133::18)
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 50429c64-4d9b-4485-1f08-08d6cbad4dd7
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600141)(711020)(4605104)(4618075)(2017052603328)(7193020);
 SRVR:BYAPR12MB2933; 
x-ms-traffictypediagnostic: BYAPR12MB2933:
x-microsoft-antispam-prvs: <BYAPR12MB2933E1DA87D663A7D65017A792380@BYAPR12MB2933.namprd12.prod.outlook.com>
x-forefront-prvs: 0021920B5A
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(39860400002)(396003)(136003)(346002)(376002)(366004)(199004)(189003)(50226002)(81156014)(76176011)(54906003)(6512007)(4326008)(81166006)(8676002)(2616005)(3846002)(97736004)(186003)(8936002)(6116002)(6506007)(86362001)(36756003)(305945005)(6486002)(6436002)(7736002)(386003)(5640700003)(14444005)(25786009)(11346002)(26005)(6916009)(1076003)(99286004)(256004)(5660300002)(2351001)(486006)(52116002)(2906002)(73956011)(71200400001)(2501003)(14454004)(53936002)(71190400001)(66476007)(66556008)(68736007)(66066001)(476003)(316002)(72206003)(102836004)(478600001)(64756008)(66946007)(66446008)(446003);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BYAPR12MB2933;
 H:BYAPR12MB3176.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: SZEq6cR1L8oflPycvnsZvvDFHfWvXDIJgK+sk7CB5U/UUCdi4raGqBd8UAuGjFlsjxBM0SlkdQ4BpI6dtzMv3XovcHlRn9Ze3/z0govK4sbmNaixdjMgcY/o2XFezM8mWmHtKNSbjn+lKQT1i0f2+eqHD/JnPuKzOr9ci8neoOvaMC2ejnsOS8MaskTR6gcA21QTSvOgMdZxFBgt2NlSimz3v54UdykwwjOlAD8grR1vCix3cgyYgcCTUd3ZrQLrPrZKxO2PoKsdGvvA/LDt1Gak4Oi36QO1WIzV0xzm6kMFsD5T4Ww8biwFcZflSNEMDQ8EBx4I/wrM5EVDYeY4Ogw9EOTJ+kIn63YdcZyPbpXK4bZkLwZ6PIkV5WUelEU1UbiZWsqNlVr6LqmZnoXMUwy8WmrarsOHlf0kupGlMZQ=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 50429c64-4d9b-4485-1f08-08d6cbad4dd7
X-MS-Exchange-CrossTenant-originalarrivaltime: 28 Apr 2019 07:44:11.7149 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BYAPR12MB2933
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amd-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=6kCt8xeGDCYsABysLbsklrkiVSgPrCaHUMc8yoq2BAU=;
 b=IUv2LIL4j3TL42UKvmbCkxIuVRWm2WD5383E455bgypJ/OzEiy5tU48T/cOqTUMowGTgwfZQfLXJiyWN5uzMzwltTWHzcOFYoTzo7BAliTvANHGuF8IMQyTCJ8U8lLA7hxpDJYSLPLcMG56CvMtvb/w2jkvZcI+ed787XkF8JLc=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Felix.Kuehling@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Zeng, Oak" <Oak.Zeng@amd.com>, "Kuehling, Felix" <Felix.Kuehling@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogT2FrIFplbmcgPG96ZW5nQGFtZC5jb20+DQoNCkluc3RlYWQgb2YgYWxsb2NhdCBoaXEg
YW5kIHNkbWEgbXFkIGZyb20gc3ViLWFsbG9jYXRvciwgYWxsb2NhdGUNCnRoZW0gZnJvbSBhIG1x
ZCB0cnVuayBwb29sLiBUaGlzIGlzIGRvbmUgZm9yIGFsbCBhc2ljcw0KDQpTaWduZWQtb2ZmLWJ5
OiBPYWsgWmVuZyA8b3plbmdAYW1kLmNvbT4NClJldmlld2VkLWJ5OiBGZWxpeCBLdWVobGluZyA8
RmVsaXguS3VlaGxpbmdAYW1kLmNvbT4NClNpZ25lZC1vZmYtYnk6IEZlbGl4IEt1ZWhsaW5nIDxG
ZWxpeC5LdWVobGluZ0BhbWQuY29tPg0KLS0tDQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQv
a2ZkX21xZF9tYW5hZ2VyLmMgIHwgNDkgKysrKysrKysrKysrKysrKysrKw0KIGRyaXZlcnMvZ3B1
L2RybS9hbWQvYW1ka2ZkL2tmZF9tcWRfbWFuYWdlci5oICB8ICA3ICsrKw0KIC4uLi9ncHUvZHJt
L2FtZC9hbWRrZmQva2ZkX21xZF9tYW5hZ2VyX2Npay5jICB8IDIwICsrKy0tLS0tDQogLi4uL2dw
dS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXJfdjkuYyAgIHwgMjIgKysrLS0tLS0tDQog
Li4uL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXJfdmkuYyAgIHwgMjIgKysrLS0t
LS0tDQogNSBmaWxlcyBjaGFuZ2VkLCA4MCBpbnNlcnRpb25zKCspLCA0MCBkZWxldGlvbnMoLSkN
Cg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9tcWRfbWFuYWdl
ci5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX21xZF9tYW5hZ2VyLmMNCmluZGV4
IGVlYjJiNjBhMzZiNS4uOTMwNzgxMWJjNDI3IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRrZmQva2ZkX21xZF9tYW5hZ2VyLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1ka2ZkL2tmZF9tcWRfbWFuYWdlci5jDQpAQCAtMjMsNiArMjMsNTUgQEANCiANCiAjaW5jbHVk
ZSAia2ZkX21xZF9tYW5hZ2VyLmgiDQogI2luY2x1ZGUgImFtZGdwdV9hbWRrZmQuaCINCisjaW5j
bHVkZSAia2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmgiDQorDQorc3RydWN0IGtmZF9tZW1fb2Jq
ICphbGxvY2F0ZV9oaXFfbXFkKHN0cnVjdCBrZmRfZGV2ICpkZXYpDQorew0KKwlzdHJ1Y3Qga2Zk
X21lbV9vYmogKm1xZF9tZW1fb2JqID0gTlVMTDsNCisNCisJbXFkX21lbV9vYmogPSBremFsbG9j
KHNpemVvZihzdHJ1Y3Qga2ZkX21lbV9vYmopLCBHRlBfS0VSTkVMKTsNCisJaWYgKCFtcWRfbWVt
X29iaikNCisJCXJldHVybiBOVUxMOw0KKw0KKwltcWRfbWVtX29iai0+Z3R0X21lbSA9IGRldi0+
ZHFtLT5oaXFfc2RtYV9tcWQuZ3R0X21lbTsNCisJbXFkX21lbV9vYmotPmdwdV9hZGRyID0gZGV2
LT5kcW0tPmhpcV9zZG1hX21xZC5ncHVfYWRkcjsNCisJbXFkX21lbV9vYmotPmNwdV9wdHIgPSBk
ZXYtPmRxbS0+aGlxX3NkbWFfbXFkLmNwdV9wdHI7DQorDQorCXJldHVybiBtcWRfbWVtX29iajsN
Cit9DQorDQorc3RydWN0IGtmZF9tZW1fb2JqICphbGxvY2F0ZV9zZG1hX21xZChzdHJ1Y3Qga2Zk
X2RldiAqZGV2LA0KKwkJCQkJc3RydWN0IHF1ZXVlX3Byb3BlcnRpZXMgKnEpDQorew0KKwlzdHJ1
Y3Qga2ZkX21lbV9vYmogKm1xZF9tZW1fb2JqID0gTlVMTDsNCisJdWludDY0X3Qgb2Zmc2V0Ow0K
Kw0KKwltcWRfbWVtX29iaiA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBrZmRfbWVtX29iaiksIEdG
UF9LRVJORUwpOw0KKwlpZiAoIW1xZF9tZW1fb2JqKQ0KKwkJcmV0dXJuIE5VTEw7DQorDQorCW9m
ZnNldCA9IChxLT5zZG1hX2VuZ2luZV9pZCAqDQorCQlkZXYtPmRldmljZV9pbmZvLT5udW1fc2Rt
YV9xdWV1ZXNfcGVyX2VuZ2luZSArDQorCQlxLT5zZG1hX3F1ZXVlX2lkKSAqDQorCQlkZXYtPmRx
bS0+bXFkX21ncnNbS0ZEX01RRF9UWVBFX1NETUFdLT5tcWRfc2l6ZTsNCisNCisJb2Zmc2V0ICs9
IGRldi0+ZHFtLT5tcWRfbWdyc1tLRkRfTVFEX1RZUEVfSElRXS0+bXFkX3NpemU7DQorDQorCW1x
ZF9tZW1fb2JqLT5ndHRfbWVtID0gKHZvaWQgKikoKHVpbnQ2NF90KWRldi0+ZHFtLT5oaXFfc2Rt
YV9tcWQuZ3R0X21lbQ0KKwkJCQkrIG9mZnNldCk7DQorCW1xZF9tZW1fb2JqLT5ncHVfYWRkciA9
IGRldi0+ZHFtLT5oaXFfc2RtYV9tcWQuZ3B1X2FkZHIgKyBvZmZzZXQ7DQorCW1xZF9tZW1fb2Jq
LT5jcHVfcHRyID0gKHVpbnQzMl90ICopKCh1aW50NjRfdCkNCisJCQkJZGV2LT5kcW0tPmhpcV9z
ZG1hX21xZC5jcHVfcHRyICsgb2Zmc2V0KTsNCisNCisJcmV0dXJuIG1xZF9tZW1fb2JqOw0KK30N
CisNCit2b2lkIHVuaW5pdF9tcWRfaGlxX3NkbWEoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9p
ZCAqbXFkLA0KKwkJCXN0cnVjdCBrZmRfbWVtX29iaiAqbXFkX21lbV9vYmopDQorew0KKwlXQVJO
X09OKCFtcWRfbWVtX29iai0+Z3R0X21lbSk7DQorCWtmcmVlKG1xZF9tZW1fb2JqKTsNCit9DQog
DQogdm9pZCBtcWRfc3ltbWV0cmljYWxseV9tYXBfY3VfbWFzayhzdHJ1Y3QgbXFkX21hbmFnZXIg
Km1tLA0KIAkJY29uc3QgdWludDMyX3QgKmN1X21hc2ssIHVpbnQzMl90IGN1X21hc2tfY291bnQs
DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX21xZF9tYW5hZ2Vy
LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXIuaA0KaW5kZXgg
MDA5ZDIzMmZiNjBiLi41NmFmMjU2YTE5MWIgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXIuaA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRrZmQva2ZkX21xZF9tYW5hZ2VyLmgNCkBAIC0xMDIsNiArMTAyLDEzIEBAIHN0cnVjdCBtcWRf
bWFuYWdlciB7DQogCXVpbnQzMl90IG1xZF9zaXplOw0KIH07DQogDQorc3RydWN0IGtmZF9tZW1f
b2JqICphbGxvY2F0ZV9oaXFfbXFkKHN0cnVjdCBrZmRfZGV2ICpkZXYpOw0KKw0KK3N0cnVjdCBr
ZmRfbWVtX29iaiAqYWxsb2NhdGVfc2RtYV9tcWQoc3RydWN0IGtmZF9kZXYgKmRldiwNCisJCQkJ
CXN0cnVjdCBxdWV1ZV9wcm9wZXJ0aWVzICpxKTsNCit2b2lkIHVuaW5pdF9tcWRfaGlxX3NkbWEo
c3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KKwkJCQlzdHJ1Y3Qga2ZkX21lbV9v
YmogKm1xZF9tZW1fb2JqKTsNCisNCiB2b2lkIG1xZF9zeW1tZXRyaWNhbGx5X21hcF9jdV9tYXNr
KHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sDQogCQljb25zdCB1aW50MzJfdCAqY3VfbWFzaywgdWlu
dDMyX3QgY3VfbWFza19jb3VudCwNCiAJCXVpbnQzMl90ICpzZV9tYXNrKTsNCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXJfY2lrLmMgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXJfY2lrLmMNCmluZGV4IGEwMDQw
MjA3N2UzNC4uNmU4NTA5ZWMyOWQ5IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRrZmQva2ZkX21xZF9tYW5hZ2VyX2Npay5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGtmZC9rZmRfbXFkX21hbmFnZXJfY2lrLmMNCkBAIC03MSw2ICs3MSw5IEBAIHN0YXRpYyBzdHJ1
Y3Qga2ZkX21lbV9vYmogKmFsbG9jYXRlX21xZChzdHJ1Y3Qga2ZkX2RldiAqa2ZkLA0KIHsNCiAJ
c3RydWN0IGtmZF9tZW1fb2JqICptcWRfbWVtX29iajsNCiANCisJaWYgKHEtPnR5cGUgPT0gS0ZE
X1FVRVVFX1RZUEVfSElRKQ0KKwkJcmV0dXJuIGFsbG9jYXRlX2hpcV9tcWQoa2ZkKTsNCisNCiAJ
aWYgKGtmZF9ndHRfc2FfYWxsb2NhdGUoa2ZkLCBzaXplb2Yoc3RydWN0IGNpa19tcWQpLA0KIAkJ
CSZtcWRfbWVtX29iaikpDQogCQlyZXR1cm4gTlVMTDsNCkBAIC0xNDgsMTIgKzE1MSwxMCBAQCBz
dGF0aWMgaW50IGluaXRfbXFkX3NkbWEoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqKm1x
ZCwNCiB7DQogCWludCByZXR2YWw7DQogCXN0cnVjdCBjaWtfc2RtYV9ybGNfcmVnaXN0ZXJzICpt
Ow0KKwlzdHJ1Y3Qga2ZkX2RldiAqZGV2ID0gbW0tPmRldjsNCiANCi0JcmV0dmFsID0ga2ZkX2d0
dF9zYV9hbGxvY2F0ZShtbS0+ZGV2LA0KLQkJCQkJc2l6ZW9mKHN0cnVjdCBjaWtfc2RtYV9ybGNf
cmVnaXN0ZXJzKSwNCi0JCQkJCW1xZF9tZW1fb2JqKTsNCi0NCi0JaWYgKHJldHZhbCAhPSAwKQ0K
KwkqbXFkX21lbV9vYmogPSBhbGxvY2F0ZV9zZG1hX21xZChkZXYsIHEpOw0KKwlpZiAoISptcWRf
bWVtX29iaikNCiAJCXJldHVybiAtRU5PTUVNOw0KIA0KIAltID0gKHN0cnVjdCBjaWtfc2RtYV9y
bGNfcmVnaXN0ZXJzICopICgqbXFkX21lbV9vYmopLT5jcHVfcHRyOw0KQEAgLTE3NSwxMSArMTc2
LDYgQEAgc3RhdGljIHZvaWQgdW5pbml0X21xZChzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lk
ICptcWQsDQogCWtmZF9ndHRfc2FfZnJlZShtbS0+ZGV2LCBtcWRfbWVtX29iaik7DQogfQ0KIA0K
LXN0YXRpYyB2b2lkIHVuaW5pdF9tcWRfc2RtYShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lk
ICptcWQsDQotCQkJCXN0cnVjdCBrZmRfbWVtX29iaiAqbXFkX21lbV9vYmopDQotew0KLQlrZmRf
Z3R0X3NhX2ZyZWUobW0tPmRldiwgbXFkX21lbV9vYmopOw0KLX0NCiANCiBzdGF0aWMgaW50IGxv
YWRfbXFkKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKm1xZCwgdWludDMyX3QgcGlwZV9p
ZCwNCiAJCSAgICB1aW50MzJfdCBxdWV1ZV9pZCwgc3RydWN0IHF1ZXVlX3Byb3BlcnRpZXMgKnAs
DQpAQCAtNDE5LDcgKzQxNSw3IEBAIHN0cnVjdCBtcWRfbWFuYWdlciAqbXFkX21hbmFnZXJfaW5p
dF9jaWsoZW51bSBLRkRfTVFEX1RZUEUgdHlwZSwNCiAJCWJyZWFrOw0KIAljYXNlIEtGRF9NUURf
VFlQRV9ISVE6DQogCQltcWQtPmluaXRfbXFkID0gaW5pdF9tcWRfaGlxOw0KLQkJbXFkLT51bmlu
aXRfbXFkID0gdW5pbml0X21xZDsNCisJCW1xZC0+dW5pbml0X21xZCA9IHVuaW5pdF9tcWRfaGlx
X3NkbWE7DQogCQltcWQtPmxvYWRfbXFkID0gbG9hZF9tcWQ7DQogCQltcWQtPnVwZGF0ZV9tcWQg
PSB1cGRhdGVfbXFkX2hpcTsNCiAJCW1xZC0+ZGVzdHJveV9tcWQgPSBkZXN0cm95X21xZDsNCkBA
IC00NDMsNyArNDM5LDcgQEAgc3RydWN0IG1xZF9tYW5hZ2VyICptcWRfbWFuYWdlcl9pbml0X2Np
ayhlbnVtIEtGRF9NUURfVFlQRSB0eXBlLA0KIAkJYnJlYWs7DQogCWNhc2UgS0ZEX01RRF9UWVBF
X1NETUE6DQogCQltcWQtPmluaXRfbXFkID0gaW5pdF9tcWRfc2RtYTsNCi0JCW1xZC0+dW5pbml0
X21xZCA9IHVuaW5pdF9tcWRfc2RtYTsNCisJCW1xZC0+dW5pbml0X21xZCA9IHVuaW5pdF9tcWRf
aGlxX3NkbWE7DQogCQltcWQtPmxvYWRfbXFkID0gbG9hZF9tcWRfc2RtYTsNCiAJCW1xZC0+dXBk
YXRlX21xZCA9IHVwZGF0ZV9tcWRfc2RtYTsNCiAJCW1xZC0+ZGVzdHJveV9tcWQgPSBkZXN0cm95
X21xZF9zZG1hOw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9t
cWRfbWFuYWdlcl92OS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX21xZF9tYW5h
Z2VyX3Y5LmMNCmluZGV4IDhmODE2NjE4OWZkNS4uNDc1MDMzODE5OWI2IDEwMDY0NA0KLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX21xZF9tYW5hZ2VyX3Y5LmMNCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9tcWRfbWFuYWdlcl92OS5jDQpAQCAtNzMsNiAr
NzMsOSBAQCBzdGF0aWMgc3RydWN0IGtmZF9tZW1fb2JqICphbGxvY2F0ZV9tcWQoc3RydWN0IGtm
ZF9kZXYgKmtmZCwNCiAJaW50IHJldHZhbDsNCiAJc3RydWN0IGtmZF9tZW1fb2JqICptcWRfbWVt
X29iaiA9IE5VTEw7DQogDQorCWlmIChxLT50eXBlID09IEtGRF9RVUVVRV9UWVBFX0hJUSkNCisJ
CXJldHVybiBhbGxvY2F0ZV9oaXFfbXFkKGtmZCk7DQorDQogCS8qIEZyb20gVjksICBmb3IgQ1dT
UiwgdGhlIGNvbnRyb2wgc3RhY2sgaXMgbG9jYXRlZCBvbiB0aGUgbmV4dCBwYWdlDQogCSAqIGJv
dW5kYXJ5IGFmdGVyIHRoZSBtcWQsIHdlIHdpbGwgdXNlIHRoZSBndHQgYWxsb2NhdGlvbiBmdW5j
dGlvbg0KIAkgKiBpbnN0ZWFkIG9mIHN1Yi1hbGxvY2F0aW9uIGZ1bmN0aW9uLg0KQEAgLTM0Niwx
MyArMzQ5LDEwIEBAIHN0YXRpYyBpbnQgaW5pdF9tcWRfc2RtYShzdHJ1Y3QgbXFkX21hbmFnZXIg
Km1tLCB2b2lkICoqbXFkLA0KIHsNCiAJaW50IHJldHZhbDsNCiAJc3RydWN0IHY5X3NkbWFfbXFk
ICptOw0KKwlzdHJ1Y3Qga2ZkX2RldiAqZGV2ID0gbW0tPmRldjsNCiANCi0NCi0JcmV0dmFsID0g
a2ZkX2d0dF9zYV9hbGxvY2F0ZShtbS0+ZGV2LA0KLQkJCXNpemVvZihzdHJ1Y3Qgdjlfc2RtYV9t
cWQpLA0KLQkJCW1xZF9tZW1fb2JqKTsNCi0NCi0JaWYgKHJldHZhbCAhPSAwKQ0KKwkqbXFkX21l
bV9vYmogPSBhbGxvY2F0ZV9zZG1hX21xZChkZXYsIHEpOw0KKwlpZiAoISptcWRfbWVtX29iaikN
CiAJCXJldHVybiAtRU5PTUVNOw0KIA0KIAltID0gKHN0cnVjdCB2OV9zZG1hX21xZCAqKSAoKm1x
ZF9tZW1fb2JqKS0+Y3B1X3B0cjsNCkBAIC0zNjgsMTIgKzM2OCw2IEBAIHN0YXRpYyBpbnQgaW5p
dF9tcWRfc2RtYShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICoqbXFkLA0KIAlyZXR1cm4g
cmV0dmFsOw0KIH0NCiANCi1zdGF0aWMgdm9pZCB1bmluaXRfbXFkX3NkbWEoc3RydWN0IG1xZF9t
YW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KLQkJc3RydWN0IGtmZF9tZW1fb2JqICptcWRfbWVtX29i
aikNCi17DQotCWtmZF9ndHRfc2FfZnJlZShtbS0+ZGV2LCBtcWRfbWVtX29iaik7DQotfQ0KLQ0K
IHN0YXRpYyBpbnQgbG9hZF9tcWRfc2RtYShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICpt
cWQsDQogCQl1aW50MzJfdCBwaXBlX2lkLCB1aW50MzJfdCBxdWV1ZV9pZCwNCiAJCXN0cnVjdCBx
dWV1ZV9wcm9wZXJ0aWVzICpwLCBzdHJ1Y3QgbW1fc3RydWN0ICptbXMpDQpAQCAtNDg0LDcgKzQ3
OCw3IEBAIHN0cnVjdCBtcWRfbWFuYWdlciAqbXFkX21hbmFnZXJfaW5pdF92OShlbnVtIEtGRF9N
UURfVFlQRSB0eXBlLA0KIAkJYnJlYWs7DQogCWNhc2UgS0ZEX01RRF9UWVBFX0hJUToNCiAJCW1x
ZC0+aW5pdF9tcWQgPSBpbml0X21xZF9oaXE7DQotCQltcWQtPnVuaW5pdF9tcWQgPSB1bmluaXRf
bXFkOw0KKwkJbXFkLT51bmluaXRfbXFkID0gdW5pbml0X21xZF9oaXFfc2RtYTsNCiAJCW1xZC0+
bG9hZF9tcWQgPSBsb2FkX21xZDsNCiAJCW1xZC0+dXBkYXRlX21xZCA9IHVwZGF0ZV9tcWRfaGlx
Ow0KIAkJbXFkLT5kZXN0cm95X21xZCA9IGRlc3Ryb3lfbXFkOw0KQEAgLTUwOCw3ICs1MDIsNyBA
QCBzdHJ1Y3QgbXFkX21hbmFnZXIgKm1xZF9tYW5hZ2VyX2luaXRfdjkoZW51bSBLRkRfTVFEX1RZ
UEUgdHlwZSwNCiAJCWJyZWFrOw0KIAljYXNlIEtGRF9NUURfVFlQRV9TRE1BOg0KIAkJbXFkLT5p
bml0X21xZCA9IGluaXRfbXFkX3NkbWE7DQotCQltcWQtPnVuaW5pdF9tcWQgPSB1bmluaXRfbXFk
X3NkbWE7DQorCQltcWQtPnVuaW5pdF9tcWQgPSB1bmluaXRfbXFkX2hpcV9zZG1hOw0KIAkJbXFk
LT5sb2FkX21xZCA9IGxvYWRfbXFkX3NkbWE7DQogCQltcWQtPnVwZGF0ZV9tcWQgPSB1cGRhdGVf
bXFkX3NkbWE7DQogCQltcWQtPmRlc3Ryb3lfbXFkID0gZGVzdHJveV9tcWRfc2RtYTsNCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXJfdmkuYyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9tcWRfbWFuYWdlcl92aS5jDQppbmRleCAz
Mjk2ZmZiZGU2YWMuLjE4Njk3YzIxNTJhOCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1ka2ZkL2tmZF9tcWRfbWFuYWdlcl92aS5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGtmZC9rZmRfbXFkX21hbmFnZXJfdmkuYw0KQEAgLTczLDYgKzczLDkgQEAgc3RhdGljIHN0
cnVjdCBrZmRfbWVtX29iaiAqYWxsb2NhdGVfbXFkKHN0cnVjdCBrZmRfZGV2ICprZmQsDQogew0K
IAlzdHJ1Y3Qga2ZkX21lbV9vYmogKm1xZF9tZW1fb2JqOw0KIA0KKwlpZiAocS0+dHlwZSA9PSBL
RkRfUVVFVUVfVFlQRV9ISVEpDQorCQlyZXR1cm4gYWxsb2NhdGVfaGlxX21xZChrZmQpOw0KKw0K
IAlpZiAoa2ZkX2d0dF9zYV9hbGxvY2F0ZShrZmQsIHNpemVvZihzdHJ1Y3QgdmlfbXFkKSwNCiAJ
CQkmbXFkX21lbV9vYmopKQ0KIAkJcmV0dXJuIE5VTEw7DQpAQCAtMzQxLDEzICszNDQsMTAgQEAg
c3RhdGljIGludCBpbml0X21xZF9zZG1hKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKipt
cWQsDQogew0KIAlpbnQgcmV0dmFsOw0KIAlzdHJ1Y3Qgdmlfc2RtYV9tcWQgKm07DQorCXN0cnVj
dCBrZmRfZGV2ICpkZXYgPSBtbS0+ZGV2Ow0KIA0KLQ0KLQlyZXR2YWwgPSBrZmRfZ3R0X3NhX2Fs
bG9jYXRlKG1tLT5kZXYsDQotCQkJc2l6ZW9mKHN0cnVjdCB2aV9zZG1hX21xZCksDQotCQkJbXFk
X21lbV9vYmopOw0KLQ0KLQlpZiAocmV0dmFsICE9IDApDQorCSptcWRfbWVtX29iaiA9IGFsbG9j
YXRlX3NkbWFfbXFkKGRldiwgcSk7DQorCWlmICghKm1xZF9tZW1fb2JqKQ0KIAkJcmV0dXJuIC1F
Tk9NRU07DQogDQogCW0gPSAoc3RydWN0IHZpX3NkbWFfbXFkICopICgqbXFkX21lbV9vYmopLT5j
cHVfcHRyOw0KQEAgLTM2MywxMiArMzYzLDYgQEAgc3RhdGljIGludCBpbml0X21xZF9zZG1hKHN0
cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKiptcWQsDQogCXJldHVybiByZXR2YWw7DQogfQ0K
IA0KLXN0YXRpYyB2b2lkIHVuaW5pdF9tcWRfc2RtYShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2
b2lkICptcWQsDQotCQlzdHJ1Y3Qga2ZkX21lbV9vYmogKm1xZF9tZW1fb2JqKQ0KLXsNCi0Ja2Zk
X2d0dF9zYV9mcmVlKG1tLT5kZXYsIG1xZF9tZW1fb2JqKTsNCi19DQotDQogc3RhdGljIGludCBs
b2FkX21xZF9zZG1hKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKm1xZCwNCiAJCXVpbnQz
Ml90IHBpcGVfaWQsIHVpbnQzMl90IHF1ZXVlX2lkLA0KIAkJc3RydWN0IHF1ZXVlX3Byb3BlcnRp
ZXMgKnAsIHN0cnVjdCBtbV9zdHJ1Y3QgKm1tcykNCkBAIC00NzgsNyArNDcyLDcgQEAgc3RydWN0
IG1xZF9tYW5hZ2VyICptcWRfbWFuYWdlcl9pbml0X3ZpKGVudW0gS0ZEX01RRF9UWVBFIHR5cGUs
DQogCQlicmVhazsNCiAJY2FzZSBLRkRfTVFEX1RZUEVfSElROg0KIAkJbXFkLT5pbml0X21xZCA9
IGluaXRfbXFkX2hpcTsNCi0JCW1xZC0+dW5pbml0X21xZCA9IHVuaW5pdF9tcWQ7DQorCQltcWQt
PnVuaW5pdF9tcWQgPSB1bmluaXRfbXFkX2hpcV9zZG1hOw0KIAkJbXFkLT5sb2FkX21xZCA9IGxv
YWRfbXFkOw0KIAkJbXFkLT51cGRhdGVfbXFkID0gdXBkYXRlX21xZF9oaXE7DQogCQltcWQtPmRl
c3Ryb3lfbXFkID0gZGVzdHJveV9tcWQ7DQpAQCAtNTAyLDcgKzQ5Niw3IEBAIHN0cnVjdCBtcWRf
bWFuYWdlciAqbXFkX21hbmFnZXJfaW5pdF92aShlbnVtIEtGRF9NUURfVFlQRSB0eXBlLA0KIAkJ
YnJlYWs7DQogCWNhc2UgS0ZEX01RRF9UWVBFX1NETUE6DQogCQltcWQtPmluaXRfbXFkID0gaW5p
dF9tcWRfc2RtYTsNCi0JCW1xZC0+dW5pbml0X21xZCA9IHVuaW5pdF9tcWRfc2RtYTsNCisJCW1x
ZC0+dW5pbml0X21xZCA9IHVuaW5pdF9tcWRfaGlxX3NkbWE7DQogCQltcWQtPmxvYWRfbXFkID0g
bG9hZF9tcWRfc2RtYTsNCiAJCW1xZC0+dXBkYXRlX21xZCA9IHVwZGF0ZV9tcWRfc2RtYTsNCiAJ
CW1xZC0+ZGVzdHJveV9tcWQgPSBkZXN0cm95X21xZF9zZG1hOw0KLS0gDQoyLjE3LjENCg0KX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWls
aW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
