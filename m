Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 97223B878B1
	for <lists+amd-gfx@lfdr.de>; Fri, 19 Sep 2025 02:58:24 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9D39B10E919;
	Fri, 19 Sep 2025 00:58:22 +0000 (UTC)
Authentication-Results: gabe.freedesktop.org;
	dkim=pass (1024-bit key; unprotected) header.d=amd.com header.i=@amd.com header.b="A/O7Ecjk";
	dkim-atps=neutral
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from MW6PR02CU001.outbound.protection.outlook.com
 (mail-westus2azon11012017.outbound.protection.outlook.com [52.101.48.17])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D195010E919
 for <amd-gfx@lists.freedesktop.org>; Fri, 19 Sep 2025 00:58:20 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector10001; d=microsoft.com; cv=none;
 b=HNlw5+VwbX7W1JD1Zwg0bxG5cWi3Ug//ho6UfoNiykw0ZC27hAaGoq5hIaP6w7cQrOS3YOs84n/5CghxXZYKPdo+PVNRSNPJJoXRPIBFbz4G3tkIZNeZ8SbcwBsY2K7tr0oTS2SlyjthhvmCECB5txIuqHa2N0bbPsgdrySKpoIJlBLYYdBnGpQPHejQOejwUeTZmYqoc235GSAzGZ90XQ0/PyU/bR667czChnA+xLHTrk96Ib/5g+gL1zPFFhhAyx9tvPzONUQcfu9qpKM238Uv9q6Cn1zhVzI8McySovvs+F7vpgPMfZrEf48SBEAFRItVEx/2GAdauDwofZkMng==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector10001;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=llsU0k73tinO5pet7uFPqaYHtxe4SpVlBYrnxCJ66IE=;
 b=yX6+1ZcgIMXfPlWQBfUgjNuwcYjnXD1w6/fWs4qk/+qvbaryQaxe5yCy9b+GpFlLdxBC6L47i6itT9h6iNOu7ywLKsFDq99GyUiIQqHHIEhWmh1hr0y3ZhPOyoyfy2kv42n4361fvXFJjE9nQ8C4c8QaUnWbhHQ2P275onLf3mPu3l4clWpBR8H3PX8hAJP+h/v7950R10PjzjsgUGQECmbMLqL6X5NNbU2Vm20MZU88vU+3hzreO8zdPjImbnuzBhDiCNsboePtooqISXGTC3xmxJlQcFprSh0w6/d6Hd6dyQE8dzz6fAr0bTxKOsh9HwfpiQoeVHHInY8ba6pm0g==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=amd.com; s=selector1; 
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=llsU0k73tinO5pet7uFPqaYHtxe4SpVlBYrnxCJ66IE=;
 b=A/O7EcjkH8KS56IxeCK+q3M4WsGB54x3Wj2EWj4JJpEzvxqU/LamMULf/2C19J73142VqdN/tqie0I/2ttKBsVd0XxdhiA1oFhoSkZma3qf9cNVYld1WYGTCIHTRDvvT3/hU0G+Y94aDDE9Kfwe+azAY28pe6uwF9x1wB1EIHAA=
Received: from BY5PR12MB4212.namprd12.prod.outlook.com (2603:10b6:a03:202::8)
 by DM4PR12MB7670.namprd12.prod.outlook.com (2603:10b6:8:105::16) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.9137.13; Fri, 19 Sep
 2025 00:58:17 +0000
Received: from BY5PR12MB4212.namprd12.prod.outlook.com
 ([fe80::7798:cbd1:1f9a:6459]) by BY5PR12MB4212.namprd12.prod.outlook.com
 ([fe80::7798:cbd1:1f9a:6459%4]) with mapi id 15.20.9137.012; Fri, 19 Sep 2025
 00:58:16 +0000
From: "Chai, Thomas" <YiPeng.Chai@amd.com>
To: Alex Deucher <alexdeucher@gmail.com>
CC: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>, "Zhang,
 Hawking" <Hawking.Zhang@amd.com>, "Zhou1, Tao" <Tao.Zhou1@amd.com>, "Li,
 Candice" <Candice.Li@amd.com>, "Yang, Stanley" <Stanley.Yang@amd.com>
Subject: RE: [PATCH 13/21] drm/amd/ras: Add eeprom ras functions
Thread-Topic: [PATCH 13/21] drm/amd/ras: Add eeprom ras functions
Thread-Index: AQHcKDxC1XyoKFqnXE63q5FGjitNZbSZYZ2AgABO0VA=
Date: Fri, 19 Sep 2025 00:58:16 +0000
Message-ID: <BY5PR12MB42123A55A5B304B4439458DDFC11A@BY5PR12MB4212.namprd12.prod.outlook.com>
References: <20250918013232.2629215-1-YiPeng.Chai@amd.com>
 <20250918013232.2629215-13-YiPeng.Chai@amd.com>
 <CADnq5_PGiYD8HxgDGSHBbaMeovv0Ly9vjGtFEoKs7ur9+eQvhg@mail.gmail.com>
In-Reply-To: <CADnq5_PGiYD8HxgDGSHBbaMeovv0Ly9vjGtFEoKs7ur9+eQvhg@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
msip_labels: MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_Enabled=True;
 MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_SiteId=3dd8961f-e488-4e60-8e11-a82d994e183d;
 MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_SetDate=2025-09-19T00:58:02.0000000Z;
 MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_Name=AMD
 Internal Distribution
 Only; MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_ContentBits=3;
 MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_Method=Standard
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=amd.com;
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: BY5PR12MB4212:EE_|DM4PR12MB7670:EE_
x-ms-office365-filtering-correlation-id: 345bbaed-a17c-4adb-7827-08ddf7179de5
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0; ARA:13230040|1800799024|376014|366016|38070700021;
x-microsoft-antispam-message-info: =?utf-8?B?TzV1WnJHUHZwRURwYm8xMXdlWnNkTUFhdmFKb2FIVSt0MmxYVWhJdTNJMDdI?=
 =?utf-8?B?ZnJFQnZwOC91TkJNNzVnOFB3NFFubzZUY04xSmV0Nk9uOTFnS1gvUjlXVkFp?=
 =?utf-8?B?SFhYOWxTV0JRREdwWHNZL1FXYnhtK0NVRldpa1RxS1JMK200eWNoWlQxQy9p?=
 =?utf-8?B?c0pxQ0NLT1E2MUx0OHh6c0pzZHo0Nk1tY2J1YlZKSXc3NlFwWE0xVlF6Vi9r?=
 =?utf-8?B?K25nYXhKcDltRW5EejNKSCtVUTV0MjlZRFp3c2kxN01YSjVvZWRpZUMwVm9F?=
 =?utf-8?B?WEpmQmtnVmxSZjFFUGI3clRFMVlubWVoUkh2NHJlSnBMY2xkeWRzUmxnYUtR?=
 =?utf-8?B?SlpZVHVuVG13RUtuT1BTczU5UW1LdGxEQytLb3l5bVMweDhDU2VvTTc0aHhn?=
 =?utf-8?B?ZGNLZlJrci9GNTBLb3FzeGdTaVRBQmpQakwzTVh2R2xLS0FCQXhMKzRZbFNW?=
 =?utf-8?B?UkdXbFgxamVOeWt1WkFFTXZJeUNBejJmRHNLQTZDN2NMbU1pbXc0Y3E1SS91?=
 =?utf-8?B?cGVJSE5FQlcwZXVxMG9kY2dvbzVTR2oyVVlkc2VKenRnZWpUQlRxZG8rT3B0?=
 =?utf-8?B?YUFvbHpoa3VJQnQzUUZJUXZaNHI5RDlZRTFsMG9HYlk3aHJubTBpRG9QczBs?=
 =?utf-8?B?NWo3T3J4MzdUYmJLM2g4TmhabzRYY0tyUXlLN2ZOcHBBbk9OdkRDb25BQXNZ?=
 =?utf-8?B?dlVsaXo4c1NPQ3R2akRuN0p0SWlpd2N1QktVMHFXUmcxQjNKdUZhRXB6c21C?=
 =?utf-8?B?Y1pzN2NWUXJqSm5NaCt6T3RMV2dVWWdoUmUzYkl3Q1hEOE9MTmJxYUEzKyta?=
 =?utf-8?B?eXJXcnN2SnpvY2FuUTE2VU9IbWNPM1pTb0dhcTM4Mnk0ZTQ5amx4K2RCaVRS?=
 =?utf-8?B?NkY2NlVZMjBDNVRQU1dvRXBCVndLUWpYMlkzNVR2TEV0K2VoUEtDUnluVWpy?=
 =?utf-8?B?SmNDdGhiWWl0cEZWWExDbCtCVFhuSFVYeUNuUzRmcWpuWFpPbFJ5bmVteHNO?=
 =?utf-8?B?UGRQNEZvWWdZbklCNXN2KzNmYzhhL21rN2hYWjBKRlZXaWNrOEtmb1VLZ0Vj?=
 =?utf-8?B?c0wxRHlJU2tXN2xNeElpVlo3cDFCZ0drZFY4Z3VEcmFBNExjb3hPQTJUNUt1?=
 =?utf-8?B?ZWZwczFwRndTU3k1SHFSUjlOczd3QWNZYjVBREdyaUxQdmg2Y2pLc040ZGcz?=
 =?utf-8?B?YTRLRHowZmloRUJVNFlUd3BRWDlBNkFXbEpSbkFqSktEQzhaK0xOeUFFaVdh?=
 =?utf-8?B?S0NGNkpBUUpUbzgxZzJ0YVArbnRMNldyUG5kOUtvVUlSNmpnMGJBWHpkdStD?=
 =?utf-8?B?N3hCY3RRSStjTG52N2RLNE1oQThJSG45OEdNdjkxQ3NPTHlBeFNZQkJUdEV6?=
 =?utf-8?B?dGp2bTM2TmFlMmpOOThKR25qejNSWS9vbGlaQjh3RE9QMlloQjNiZHBCc2Jr?=
 =?utf-8?B?YllRTjhiOXNjZmE2a0tzUmlOMU9qUEdTQ2kxNjFzQXp5Y1c2S29HTmpEN2xD?=
 =?utf-8?B?Lzc1aTVFUW1mQW9nTEJVWVpLWjduL0lmU2plRkFQUnJGUzFRM01oMVNrTDM5?=
 =?utf-8?B?cFltQlZEVzllN2s4Yk5QbHZXMFo5eEVTVTN6VWx1V2VOeVdoSGwwQ1RMc2JN?=
 =?utf-8?B?dVYzc3NqNU41dWRJZllFV2Y1K3RpblR6ODF3emlWeDNHM1lOT2hvVTdUZDNi?=
 =?utf-8?B?VE9PaFFwUmc1M3J5cDdwamVzMVhqSkd3WmtaYklXVWRqVFpsMkhUU0xyUUhM?=
 =?utf-8?B?b0NMZThuNXM3NDJQcnZ2RnRmSjlCQXN4YnJMSHBOU01KTVJNdUYxakZvVkVP?=
 =?utf-8?B?STdwZ3ZrZ2t3Y2ZQS1g1VlVCYmswRGdKM0pFUlppK1NKanRiWS9KazE5S1ZW?=
 =?utf-8?B?VkxPOFZYRnIwcTZ3eGdqbHFVZ2N3WC9US3c1TTUvcGxEaGVUUzdmQnI2VTdl?=
 =?utf-8?B?aUQxUWZWUHpxL09zUURJdktQbStMKzFDeHg0MW1TM1c4c05FS2FLVlZydnpi?=
 =?utf-8?Q?NBJnwSqH0uBVGIY1HzzwgFgmKXo2bs=3D?=
x-forefront-antispam-report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:BY5PR12MB4212.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(13230040)(1800799024)(376014)(366016)(38070700021); DIR:OUT; SFP:1101; 
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?VjAraEgxOFd5TTNyZFdWMTFrWSs2YkZKVWF5MFIyQUZtYUszRTNMM3BxVmpK?=
 =?utf-8?B?bnNCcjJKTmtScTI4ZFI4ZFMyc3RIdlJIUHg1MS9DSHRPbDVmOTd6WjZ0RXZi?=
 =?utf-8?B?REhrcndkY0FFZmc0SVRPS1lWR1pEaVZ2WThVUDNGTEF4YkhNU2xGYXdoMER2?=
 =?utf-8?B?enZHZWhKWGc0cmZPMlBZUlRCSnUvSGJlRDRHeXZsenYxRlZOODhyTlpCK3dj?=
 =?utf-8?B?ZVJLeGN1NjEvUHVPT1NJSDRJT2h1dGV0OUNNWTltVTFyZGM0d0R3SVQyTEp5?=
 =?utf-8?B?QkFWQmFaeFBNWWEzSlhLNW9zakg2TW1zTUhmWld5ZGJPR20zNjloaFdYOXBq?=
 =?utf-8?B?ZEpDV2NMYkxIN1JmNk1kbXFibzdOSVFYU01PS0lWNnFodkRqdGdwNzM0ck40?=
 =?utf-8?B?OGM1QktOVDI4NHcvUVA0YkpncHlEMGtLdlVVUUpmd1BrMllUZC9CYVpCSktW?=
 =?utf-8?B?MHNUMmlpVmdhdjc2Z2JiZnQvSVI0bFFkbFFjYTlPNzloUnVzMnp2WWlrejQ5?=
 =?utf-8?B?SkZGVmxnQkk5ME5scU1XbXkza3JyS29NdEVzMThldFFkLzZDQXZ2ektTUGdY?=
 =?utf-8?B?QjJteW1qbThOTXYrUUxudGJkamdMVXZUVWFnZHhOcjE1TERZTlRWT29pSTZh?=
 =?utf-8?B?Y1FDT1RidDlsd3ZkSjAwdTJxWGNDclZBSEg2aUtRVFRyMnQvUEpERThOdzBr?=
 =?utf-8?B?R1J5V2VISzJNWndXQkorZjhRYnpIeVBMOXRob3MzM095eTY3eVZLdFpkanVm?=
 =?utf-8?B?Q216NEQ4eXRqai84TzBrblQ0cmJrM2gzakJPbThkUy9zSk5Cdyt3SVFQK1Nu?=
 =?utf-8?B?THhWV3hoQ3pmc2s3eTBaaVZZZWNLczRiYkVNZXhITzVISFMzMlVlYkpIVTdM?=
 =?utf-8?B?WGZ2ZWFFdVFzdVh6YjRRVCtzVkJkT0RmaHd6Wjh3Qy9EQ3NLSkVGZm1ReHly?=
 =?utf-8?B?RTBPdDJsQWVNcTB4dmtseUZYVVhvNUtGTmZkd0JwZWlpNXpKby8wNmpCNmJw?=
 =?utf-8?B?b293dlJ1NDZxUUNObFRzVHRvenZlUzBEclhVa2kzS0RYcm9EM3ZXeEUrRnM3?=
 =?utf-8?B?TzUydE5Sejh4RThlTkFodkx4NlJiQldtM082RjRGekZRNjkwaUdERVNXTmdv?=
 =?utf-8?B?ZEJ5bzRPYlI4ZnA3bnV5dmt1NWRBemhmRm8vd0NxVjkwVmpvT2VIcmVhMms3?=
 =?utf-8?B?YmhlMnpwYlNRUjIzeWY5MXcyL3RZVnhoQjRhS3p6Qjl5WUNKZmZ5R3Z2N2pj?=
 =?utf-8?B?WmZ5TUJwZ0p0dUVaVkhXbVR6NjZrWWJMaEpwOHNieHJBQ0JIWHpCc3JuUU0x?=
 =?utf-8?B?bldyK0xEWEtISkVTZXlmcitNR1JtM1pGMCtKUmFCK2ZKekRpSzcrWlFGaXBM?=
 =?utf-8?B?THJScDMxTFFsNy8zT2JjeEtFaFJZOHFlRHgwYjBhSEc4d1RvYUdFaVhLcS9L?=
 =?utf-8?B?MW0waVBvRE9zYi9YTHlyNHpBcS9aWkFEcHRNSTcwN2dlNFd1N29ObmtWN3E3?=
 =?utf-8?B?by9Vc04wZFQ3L0EvN1FGS1hWd2YrbXIyczNJaHVOQWw5cWxDTmFBUmlRTE5P?=
 =?utf-8?B?OXlmVmRVaWUvaDB5TENKRndZajYzeDRkUmg0OEo4Q211bnZCTjNyMW9WSzZY?=
 =?utf-8?B?eFlKcmYwaEI3Q0I0MVE2VytJYVloaytEUnVLRWJjU0dYUVQyS1RvZWw3YnY2?=
 =?utf-8?B?UE1kcmt2TGFyakZ5azdNSTBrLzNyRUtuNkxhSGd5bEFYcFdGVDFDQ0ZPeU1p?=
 =?utf-8?B?ZEdXL08vckZPN0xrYm5LNHlqMGZqM2ZwMWczMGFKUjkyR2tlU2hkRlF2U0VS?=
 =?utf-8?B?TzRsVk9FWlVhQmx4emJTcEpCRUsvcHMvSkFKSUozejhWK2xwNTV4a25MTU1D?=
 =?utf-8?B?d1Zwc0VQTW9aQ3crUlp5Qm1tVmh2MVVjTWo0UDFJMDZ0ZmZlL0VqN3htYVNq?=
 =?utf-8?B?bXZ2V1g4ZWhOd2RvNVhmbldDUGN5ZUppOXdJRU5CK1dYN01xdzVMdG1HMllT?=
 =?utf-8?B?SS8rZW43MFc2TGw5c013L01jRjZyRXUwRGZiRSt2RWxKTXFEUVZKZXlFdkg1?=
 =?utf-8?B?TEM5T0pTWm9yK2oyMVEyRzJzV05rdDdWNkFlOGlHdTdzc29NczBtaE5ESzBY?=
 =?utf-8?Q?4q+A=3D?=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: BY5PR12MB4212.namprd12.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 345bbaed-a17c-4adb-7827-08ddf7179de5
X-MS-Exchange-CrossTenant-originalarrivaltime: 19 Sep 2025 00:58:16.1416 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 8epuQw6OaJSlFzJIPmZ/5r97r3nrZb2gjoKbQqki+oHVf5hK0U0Kdb66JzexUF0Wx0arBYkhKOwsR5RFQv5lrw==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM4PR12MB7670
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

W0FNRCBPZmZpY2lhbCBVc2UgT25seSAtIEFNRCBJbnRlcm5hbCBEaXN0cmlidXRpb24gT25seV0N
Cg0KT2ssIHdpbGwgdXBkYXRlLg0KDQotLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0tLQ0KRnJvbTog
YW1kLWdmeCA8YW1kLWdmeC1ib3VuY2VzQGxpc3RzLmZyZWVkZXNrdG9wLm9yZz4gT24gQmVoYWxm
IE9mIEFsZXggRGV1Y2hlcg0KU2VudDogRnJpZGF5LCBTZXB0ZW1iZXIgMTksIDIwMjUgNDoxNiBB
TQ0KVG86IENoYWksIFRob21hcyA8WWlQZW5nLkNoYWlAYW1kLmNvbT4NCkNjOiBhbWQtZ2Z4QGxp
c3RzLmZyZWVkZXNrdG9wLm9yZzsgWmhhbmcsIEhhd2tpbmcgPEhhd2tpbmcuWmhhbmdAYW1kLmNv
bT47IFpob3UxLCBUYW8gPFRhby5aaG91MUBhbWQuY29tPjsgTGksIENhbmRpY2UgPENhbmRpY2Uu
TGlAYW1kLmNvbT47IFlhbmcsIFN0YW5sZXkgPFN0YW5sZXkuWWFuZ0BhbWQuY29tPg0KU3ViamVj
dDogUmU6IFtQQVRDSCAxMy8yMV0gZHJtL2FtZC9yYXM6IEFkZCBlZXByb20gcmFzIGZ1bmN0aW9u
cw0KDQpPbiBXZWQsIFNlcCAxNywgMjAyNSBhdCA5OjQ04oCvUE0gWWlQZW5nIENoYWkgPFlpUGVu
Zy5DaGFpQGFtZC5jb20+IHdyb3RlOg0KPg0KPiBBZGQgZWVwcm9tIHJhcyBmdW5jdGlvbnMuDQo+
DQo+IFNpZ25lZC1vZmYtYnk6IFlpUGVuZyBDaGFpIDxZaVBlbmcuQ2hhaUBhbWQuY29tPg0KPiBS
ZXZpZXdlZC1ieTogVGFvIFpob3UgPHRhby56aG91MUBhbWQuY29tPg0KPiAtLS0NCj4gIGRyaXZl
cnMvZ3B1L2RybS9hbWQvcmFzL3Jhc2NvcmUvcmFzX2VlcHJvbS5jIHwgMTM2OCArKysrKysrKysr
KysrKysrKysNCj4gIGRyaXZlcnMvZ3B1L2RybS9hbWQvcmFzL3Jhc2NvcmUvcmFzX2VlcHJvbS5o
IHwgIDIxNyArKysNCj4gIDIgZmlsZXMgY2hhbmdlZCwgMTU4NSBpbnNlcnRpb25zKCspDQo+ICBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2FtZC9yYXMvcmFzY29yZS9yYXNfZWVw
cm9tLmMNCj4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYW1kL3Jhcy9yYXNj
b3JlL3Jhc19lZXByb20uaA0KPg0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9y
YXMvcmFzY29yZS9yYXNfZWVwcm9tLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Jhcy9yYXNjb3Jl
L3Jhc19lZXByb20uYw0KPiBuZXcgZmlsZSBtb2RlIDEwMDY0NA0KPiBpbmRleCAwMDAwMDAwMDAw
MDAuLjllMGE0ZjYwNWRiMA0KPiAtLS0gL2Rldi9udWxsDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvcmFzL3Jhc2NvcmUvcmFzX2VlcHJvbS5jDQo+IEBAIC0wLDAgKzEsMTM2OCBAQA0KPiAr
Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVA0KPiArLyoNCj4gKyAqIENvcHlyaWdodCAy
MDI1IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4NCj4gKyAqDQo+ICsgKiBQZXJtaXNzaW9u
IGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5p
bmcgYQ0KPiArICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50
YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwNCj4gKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3
YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24NCj4g
KyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0
cmlidXRlLCBzdWJsaWNlbnNlLA0KPiArICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0
d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlDQo+ICsgKiBTb2Z0d2FyZSBp
cyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25z
Og0KPiArICoNCj4gKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1p
c3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluDQo+ICsgKiBhbGwgY29waWVzIG9yIHN1
YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4NCj4gKyAqDQo+ICsgKiBUSEUgU09G
VFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwg
RVhQUkVTUyBPUg0KPiArICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBU
SEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksDQo+ICsgKiBGSVRORVNTIEZPUiBBIFBB
UlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwN
Cj4gKyAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9S
IEFOWSBDTEFJTSwgREFNQUdFUyBPUg0KPiArICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElO
IEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsDQo+ICsgKiBBUklTSU5H
IEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBV
U0UgT1INCj4gKyAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4NCj4gKyAqDQo+ICsg
Ki8NCj4gKw0KPiArI2luY2x1ZGUgInJhc19lZXByb20uaCINCj4gKyNpbmNsdWRlICJyYXMuaCIN
Cj4gKw0KPiArLyogVGhlc2UgYXJlIG1lbW9yeSBhZGRyZXNzZXMgYXMgd291bGQgYmUgc2VlbiBi
eSBvbmUgb3IgbW9yZSBFRVBST00NCj4gKyAqIGNoaXBzIHN0cnVuZyBvbiB0aGUgSTJDIGJ1cywg
dXN1YWxseSBieSBtYW5pcHVsYXRpbmcgcGlucyAxLTMgb2YgYQ0KPiArICogc2V0IG9mIEVFUFJP
TSBkZXZpY2VzLiBUaGV5IGZvcm0gYSBjb250aW51b3VzIG1lbW9yeSBzcGFjZS4NCj4gKyAqDQo+
ICsgKiBUaGUgSTJDIGRldmljZSBhZGRyZXNzIGluY2x1ZGVzIHRoZSBkZXZpY2UgdHlwZSBpZGVu
dGlmaWVyLCAxMDEwYiwNCj4gKyAqIHdoaWNoIGlzIGEgcmVzZXJ2ZWQgdmFsdWUgYW5kIGluZGlj
YXRlcyB0aGF0IHRoaXMgaXMgYW4gSTJDIEVFUFJPTQ0KPiArICogZGV2aWNlLiBJdCBhbHNvIGlu
Y2x1ZGVzIHRoZSB0b3AgMyBiaXRzIG9mIHRoZSAxOSBiaXQgRUVQUk9NIG1lbW9yeQ0KPiArICog
YWRkcmVzcywgbmFtZWx5IGJpdHMgMTgsIDE3LCBhbmQgMTYuIFRoaXMgbWFrZXMgdXAgdGhlIDcg
Yml0DQo+ICsgKiBhZGRyZXNzIHNlbnQgb24gdGhlIEkyQyBidXMgd2l0aCBiaXQgMCBiZWluZyB0
aGUgZGlyZWN0aW9uIGJpdCwNCj4gKyAqIHdoaWNoIGlzIG5vdCByZXByZXNlbnRlZCBoZXJlLCBh
bmQgc2VudCBieSB0aGUgaGFyZHdhcmUgZGlyZWN0bHkuDQo+ICsgKg0KPiArICogRm9yIGluc3Rh
bmNlLA0KPiArICogICA1MGggPSAxMDEwMDAwYiA9PiBkZXZpY2UgdHlwZSBpZGVudGlmaWVyIDEw
MTBiLCBiaXRzIDE4OjE2ID0gMDAwYiwgYWRkcmVzcyAwLg0KPiArICogICA1NGggPSAxMDEwMTAw
YiA9PiAtLSItLSwgYml0cyAxODoxNiA9IDEwMGIsIGFkZHJlc3MgNDAwMDBoLg0KPiArICogICA1
NmggPSAxMDEwMTEwYiA9PiAtLSItLSwgYml0cyAxODoxNiA9IDExMGIsIGFkZHJlc3MgNjAwMDBo
Lg0KPiArICogRGVwZW5kaW5nIG9uIHRoZSBzaXplIG9mIHRoZSBJMkMgRUVQUk9NIGRldmljZShz
KSwgYml0cyAxODoxNiBtYXkNCj4gKyAqIGFkZHJlc3MgbWVtb3J5IGluIGEgZGV2aWNlIG9yIGEg
ZGV2aWNlIG9uIHRoZSBJMkMgYnVzLCBkZXBlbmRpbmcgb24NCj4gKyAqIHRoZSBzdGF0dXMgb2Yg
cGlucyAxLTMuDQo+ICsgKg0KPiArICogVGhlIFJBUyB0YWJsZSBsaXZlcyBlaXRoZXIgYXQgYWRk
cmVzcyAwIG9yIGFkZHJlc3MgNDAwMDBoIG9mIEVFUFJPTS4NCj4gKyAqLw0KPiArI2RlZmluZSBF
RVBST01fSTJDX01BRERSXzAgICAgICAweDANCj4gKyNkZWZpbmUgRUVQUk9NX0kyQ19NQUREUl80
ICAgICAgMHg0MDAwMA0KPiArDQo+ICsjZGVmaW5lIEVFUFJPTV9QQUdFX0JJVFMgICA4DQo+ICsj
ZGVmaW5lIEVFUFJPTV9QQUdFX1NJWkUgICAoMVUgPDwgRUVQUk9NX1BBR0VfQklUUykNCj4gKyNk
ZWZpbmUgRUVQUk9NX1BBR0VfTUFTSyAgIChFRVBST01fUEFHRV9TSVpFIC0gMSkNCj4gKw0KPiAr
I2RlZmluZSBFRVBST01fT0ZGU0VUX1NJWkUgMg0KPiArI2RlZmluZSBNQUtFX0kyQ19BRERSKF9h
YSkgKCgweEEgPDwgMykgfCAoKChfYWEpID4+IDE2KSAmIDB4RikpDQo+ICsNCj4gKy8qDQo+ICsg
KiBUaGUgMiBtYWNyb3MgYmVsbG93IHJlcHJlc2VudCB0aGUgYWN0dWFsIHNpemUgaW4gYnl0ZXMg
dGhhdA0KPiArICogdGhvc2UgZW50aXRpZXMgb2NjdXB5IGluIHRoZSBFRVBST00gbWVtb3J5Lg0K
PiArICogUkFTX1RBQkxFX1JFQ09SRF9TSVpFIGlzIGRpZmZlcmVudCB0aGFuIHNpemVvZihlZXBy
b21fdW1jX3JlY29yZCkgd2hpY2gNCj4gKyAqIHVzZXMgdWludDY0IHRvIHN0b3JlIDZiIGZpZWxk
cyBzdWNoIGFzIHJldGlyZWRfcGFnZS4NCj4gKyAqLw0KPiArI2RlZmluZSBSQVNfVEFCTEVfSEVB
REVSX1NJWkUgICAyMA0KPiArI2RlZmluZSBSQVNfVEFCTEVfUkVDT1JEX1NJWkUgICAyNA0KPiAr
DQo+ICsvKiBUYWJsZSBoZHIgaXMgJ0FNRFInICovDQo+ICsjZGVmaW5lIFJBU19UQUJMRV9IRFJf
VkFMICAgICAgIDB4NDE0ZDQ0NTINCj4gKw0KPiArLyogQmFkIEdQVSB0YWcg4oCYQkFER+KAmSAq
Lw0KPiArI2RlZmluZSBSQVNfVEFCTEVfSERSX0JBRCAgICAgICAweDQyNDE0NDQ3DQo+ICsNCj4g
Ky8qDQo+ICsgKiBFRVBST00gVGFibGUgc3RydWN0dXJlIHYxDQo+ICsgKiAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4gKyAqIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfA0KPiArICogfCAgICAgRUVQUk9NIFRBQkxFIEhFQURFUiAgICAgICB8DQo+ICsgKiB8ICAg
ICAgKCBzaXplIDIwIEJ5dGVzICkgICAgICAgIHwNCj4gKyAqIHwgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgfA0KPiArICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQo+
ICsgKiB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCj4gKyAqIHwgICAgQkFEIFBB
R0UgUkVDT1JEIEFSRUEgICAgICAgfA0KPiArICogfCAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8DQo+ICsgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4gKyAqLw0K
PiArDQo+ICsvKiBBc3N1bWUgMi1NYml0IHNpemUgRUVQUk9NIGFuZCB0YWtlIHVwIHRoZSB3aG9s
ZSBzcGFjZS4gKi8NCj4gKyNkZWZpbmUgUkFTX1RCTF9TSVpFX0JZVEVTICAgICAgKDI1NiAqIDEw
MjQpDQo+ICsjZGVmaW5lIFJBU19UQUJMRV9TVEFSVCAgICAgICAgIDANCj4gKyNkZWZpbmUgUkFT
X0hEUl9TVEFSVCAgICAgICAgICAgUkFTX1RBQkxFX1NUQVJUDQo+ICsjZGVmaW5lIFJBU19SRUNP
UkRfU1RBUlQgICAgICAgIChSQVNfSERSX1NUQVJUICsgUkFTX1RBQkxFX0hFQURFUl9TSVpFKQ0K
PiArI2RlZmluZSBSQVNfTUFYX1JFQ09SRF9DT1VOVCAgICAoKFJBU19UQkxfU0laRV9CWVRFUyAt
IFJBU19UQUJMRV9IRUFERVJfU0laRSkgXA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAvIFJBU19UQUJMRV9SRUNPUkRfU0laRSkNCj4gKw0KPiArLyoNCj4gKyAqIEVFUFJPTSBU
YWJsZSBzdHJ1Y3RydWUgdjIuMQ0KPiArICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tDQo+ICsgKiB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCj4gKyAqIHwgICAg
IEVFUFJPTSBUQUJMRSBIRUFERVIgICAgICAgfA0KPiArICogfCAgICAgICggc2l6ZSAyMCBCeXRl
cyApICAgICAgICB8DQo+ICsgKiB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCj4g
KyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KPiArICogfCAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8DQo+ICsgKiB8ICAgICBFRVBST00gVEFCTEUgUkFTIElORk8g
ICAgIHwNCj4gKyAqIHwgKGF2YWlsYWJsZSBpbmZvIHNpemUgNCBCeXRlcykgfA0KPiArICogfCAg
KCByZXNlcnZlZCBzaXplIDI1MiBCeXRlcyApICB8DQo+ICsgKiB8ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHwNCj4gKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0K
PiArICogfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8DQo+ICsgKiB8ICAgICBCQUQg
UEFHRSBSRUNPUkQgQVJFQSAgICAgIHwNCj4gKyAqIHwgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfA0KPiArICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQo+ICsgKi8N
Cj4gKw0KPiArLyogRUVQUk9NIFRhYmxlIFYyXzEgKi8NCj4gKyNkZWZpbmUgUkFTX1RBQkxFX1Yy
XzFfSU5GT19TSVpFICAgICAgIDI1Ng0KPiArI2RlZmluZSBSQVNfVEFCTEVfVjJfMV9JTkZPX1NU
QVJUICAgICAgUkFTX1RBQkxFX0hFQURFUl9TSVpFDQo+ICsjZGVmaW5lIFJBU19SRUNPUkRfU1RB
UlRfVjJfMSAgICAgICAgICAoUkFTX0hEUl9TVEFSVCArIFJBU19UQUJMRV9IRUFERVJfU0laRSAr
IFwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJBU19UQUJMRV9W
Ml8xX0lORk9fU0laRSkNCj4gKyNkZWZpbmUgUkFTX01BWF9SRUNPUkRfQ09VTlRfVjJfMSAgICAg
ICgoUkFTX1RCTF9TSVpFX0JZVEVTIC0gUkFTX1RBQkxFX0hFQURFUl9TSVpFIC0gXA0KPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkFTX1RBQkxFX1YyXzFfSU5GT19T
SVpFKSBcDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvIFJBU19U
QUJMRV9SRUNPUkRfU0laRSkNCj4gKw0KPiArLyogR2l2ZW4gYSB6ZXJvLWJhc2VkIGluZGV4IG9m
IGFuIEVFUFJPTSBSQVMgcmVjb3JkLCB5aWVsZHMgdGhlIEVFUFJPTQ0KPiArICogb2Zmc2V0IG9m
ZiBvZiBSQVNfVEFCTEVfU1RBUlQuICBUaGF0IGlzLCB0aGlzIGlzIHNvbWV0aGluZyB5b3UgY2Fu
DQo+ICsgKiBhZGQgdG8gY29udHJvbC0+aTJjX2FkZHJlc3MsIGFuZCB0aGVuIHRlbGwgSTJDIGxh
eWVyIHRvIHJlYWQNCj4gKyAqIGZyb20vd3JpdGUgdG8gdGhlcmUuIF9OIGlzIHRoZSBzbyBjYWxs
ZWQgYWJzb2x1dGUgaW5kZXgsDQo+ICsgKiBiZWNhdXNlIGl0IHN0YXJ0cyByaWdodCBhZnRlciB0
aGUgdGFibGUgaGVhZGVyLg0KPiArICovDQo+ICsjZGVmaW5lIFJBU19JTkRFWF9UT19PRkZTRVQo
X0MsIF9OKSAoKF9DKS0+cmFzX3JlY29yZF9vZmZzZXQgKyBcDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAoX04pICogUkFTX1RBQkxFX1JFQ09SRF9TSVpFKQ0KPiArDQo+
ICsjZGVmaW5lIFJBU19PRkZTRVRfVE9fSU5ERVgoX0MsIF9PKSAoKChfTykgLSBcDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKF9DKS0+cmFzX3JlY29yZF9vZmZzZXQp
IC8gUkFTX1RBQkxFX1JFQ09SRF9TSVpFKQ0KPiArDQo+ICsvKiBHaXZlbiBhIDAtYmFzZWQgcmVs
YXRpdmUgcmVjb3JkIGluZGV4LCAwLCAxLCAyLCAuLi4sIGV0Yy4sIG9mZg0KPiArICogb2YgImZy
aSIsIHJldHVybiB0aGUgYWJzb2x1dGUgcmVjb3JkIGluZGV4IG9mZiBvZiB0aGUgZW5kIG9mDQo+
ICsgKiB0aGUgdGFibGUgaGVhZGVyLg0KPiArICovDQo+ICsjZGVmaW5lIFJBU19SSV9UT19BSShf
QywgX0kpICgoKF9JKSArIChfQyktPnJhc19mcmkpICUgXA0KPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAoX0MpLT5yYXNfbWF4X3JlY29yZF9jb3VudCkNCj4gKw0KPiArI2RlZmluZSBS
QVNfTlVNX1JFQ1MoX3RibF9oZHIpICAoKChfdGJsX2hkciktPnRibF9zaXplIC0gXA0KPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkFTX1RBQkxFX0hFQURFUl9TSVpFKSAvIFJB
U19UQUJMRV9SRUNPUkRfU0laRSkNCj4gKw0KPiArI2RlZmluZSBSQVNfTlVNX1JFQ1NfVjJfMShf
dGJsX2hkcikgICgoKF90YmxfaGRyKS0+dGJsX3NpemUgLSBcDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFJBU19UQUJMRV9IRUFERVJfU0laRSAtIFwNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkFTX1RBQkxFX1YyXzFfSU5GT19TSVpF
KSAvIFJBU19UQUJMRV9SRUNPUkRfU0laRSkNCj4gKw0KPiArI2RlZmluZSB0b19yYXNfY29yZV9j
b250ZXh0KHgpIChjb250YWluZXJfb2YoeCwgc3RydWN0IHJhc19jb3JlX2NvbnRleHQsIHJhc19l
ZXByb20pKQ0KPiArDQo+ICtzdGF0aWMgYm9vbCBfX2lzX3Jhc19lZXByb21fc3VwcG9ydGVkKHN0
cnVjdCByYXNfY29yZV9jb250ZXh0ICpyYXNfY29yZSkNCj4gK3sNCj4gKyAgICAgICByZXR1cm4g
cmFzX2NvcmUtPnJhc19lZXByb21fc3VwcG9ydGVkOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgYm9v
bCBfX2dldF9lZXByb21faTJjX2FkZHIoc3RydWN0IHJhc19jb3JlX2NvbnRleHQgKnJhc19jb3Jl
LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHJhc19lZXByb21f
Y29udHJvbCAqY29udHJvbCkNCj4gK3sNCj4gKyAgICAgICBpbnQgcmV0ID0gLUVJTlZBTDsNCj4g
Kw0KPiArICAgICAgIGlmIChjb250cm9sLT5zeXNfZnVuYyAmJg0KPiArICAgICAgICAgICAgICAg
Y29udHJvbC0+c3lzX2Z1bmMtPnVwZGF0ZV9lZXByb21faTJjX2NvbmZpZykNCj4gKyAgICAgICAg
ICAgICAgIHJldCA9IGNvbnRyb2wtPnN5c19mdW5jLT51cGRhdGVfZWVwcm9tX2kyY19jb25maWco
cmFzX2NvcmUpOw0KPiArICAgICAgIGVsc2UNCj4gKyAgICAgICAgICAgICAgIFJBU19ERVZfV0FS
TihyYXNfY29yZS0+ZGV2LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAiTm8gZWVwcm9tIGky
YyBzeXN0ZW0gY29uZmlnIVxuIik7DQo+ICsNCj4gKyAgICAgICByZXR1cm4gIXJldCA/IHRydWUg
OiBmYWxzZTsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBfX3Jhc19lZXByb21feGZlcihzdHJ1
Y3QgcmFzX2NvcmVfY29udGV4dCAqcmFzX2NvcmUsIHUzMiBlZXByb21fYWRkciwNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1OCAqZWVwcm9tX2J1ZiwgdTMyIGJ1Zl9zaXplLCBi
b29sIHJlYWQpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0IHJhc19lZXByb21fY29udHJvbCAqY29u
dHJvbCA9ICZyYXNfY29yZS0+cmFzX2VlcHJvbTsNCj4gKyAgICAgICBpbnQgcmV0Ow0KPiArDQo+
ICsgICAgICAgaWYgKGNvbnRyb2wtPnN5c19mdW5jICYmIGNvbnRyb2wtPnN5c19mdW5jLT5lZXBy
b21faTJjX3hmZXIpIHsNCj4gKyAgICAgICAgICAgICAgIHJldCA9IGNvbnRyb2wtPnN5c19mdW5j
LT5lZXByb21faTJjX3hmZXIocmFzX2NvcmUsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZWVwcm9tX2FkZHIsIGVlcHJvbV9idWYsIGJ1Zl9zaXplLCByZWFkKTsNCj4gKw0KPiAr
ICAgICAgICAgICAgICAgaWYgKChyZXQgPiAwKSAmJiAhcmVhZCkgew0KPiArICAgICAgICAgICAg
ICAgICAgICAgICAvKiBBY2NvcmRpbmcgdG8gRUVQUk9NIHNwZWNzIHRoZSBsZW5ndGggb2YgdGhl
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAqIHNlbGYtd3JpdGluZyBjeWNsZSwgdFdSICh0
VyksIGlzIDEwIG1zLg0KPiArICAgICAgICAgICAgICAgICAgICAgICAgKg0KPiArICAgICAgICAg
ICAgICAgICAgICAgICAgKiBUT0RPOiBVc2UgcG9sbGluZyBvbiBBQ0ssIGFrYSBBY2tub3dsZWRn
ZQ0KPiArICAgICAgICAgICAgICAgICAgICAgICAgKiBQb2xsaW5nLCB0byBtaW5pbWl6ZSB3YWl0
aW5nIGZvciB0aGUNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICogaW50ZXJuYWwgd3JpdGUg
Y3ljbGUgdG8gY29tcGxldGUsIGFzIGl0IGlzDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAq
IHVzdWFsbHkgc21hbGxlciB0aGFuIHRXUiAodFcpLg0KPiArICAgICAgICAgICAgICAgICAgICAg
ICAgKi8NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgbXNsZWVwKDEwKTsNCj4gKyAgICAgICAg
ICAgICAgIH0NCj4gKw0KPiArICAgICAgICAgICAgICAgcmV0dXJuIHJldDsNCj4gKyAgICAgICB9
DQo+ICsNCj4gKyAgICAgICBSQVNfREVWX0VSUihyYXNfY29yZS0+ZGV2LCAiRXJyb3I6IE5vIGVl
cHJvbSBpMmMgc3lzdGVtIHhmZXIgZnVuY3Rpb24hXG4iKTsNCj4gKyAgICAgICByZXR1cm4gLUVJ
TlZBTDsNCj4gK30NCj4gKw0KPiArDQo+ICsvKioNCj4gKyAqIF9fZWVwcm9tX3hmZXIgLS0gUmVh
ZC93cml0ZSBmcm9tL3RvIGFuIEkyQyBFRVBST00gZGV2aWNlDQo+ICsgKiBAaTJjX2FkYXA6IHBv
aW50ZXIgdG8gdGhlIEkyQyBhZGFwdGVyIHRvIHVzZQ0KPiArICogQGVlcHJvbV9hZGRyOiBFRVBS
T00gYWRkcmVzcyBmcm9tIHdoaWNoIHRvIHJlYWQvd3JpdGUNCj4gKyAqIEBlZXByb21fYnVmOiBw
b2ludGVyIHRvIGRhdGEgYnVmZmVyIHRvIHJlYWQgaW50by93cml0ZSBmcm9tDQo+ICsgKiBAYnVm
X3NpemU6IHRoZSBzaXplIG9mIEBlZXByb21fYnVmDQo+ICsgKiBAcmVhZDogVHJ1ZSBpZiByZWFk
aW5nIGZyb20gdGhlIEVFUFJPTSwgZmFsc2UgaWYgd3JpdGluZw0KPiArICoNCj4gKyAqIFJldHVy
bnMgdGhlIG51bWJlciBvZiBieXRlcyByZWFkL3dyaXR0ZW47IC1lcnJubyBvbiBlcnJvci4NCj4g
KyAqLw0KPiArc3RhdGljIGludCBfX2VlcHJvbV94ZmVyKHN0cnVjdCByYXNfY29yZV9jb250ZXh0
ICpyYXNfY29yZSwgdTMyIGVlcHJvbV9hZGRyLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1OCAqZWVwcm9tX2J1ZiwgdTMyIGJ1Zl9zaXplLCBib29sIHJlYWQpDQo+ICt7DQo+ICsg
ICAgICAgdTE2IGxpbWl0Ow0KPiArICAgICAgIHUxNiBwczsgLyogUGFydGlhbCBzaXplICovDQo+
ICsgICAgICAgaW50IHJlcyA9IDAsIHI7DQo+ICsNCj4gKyAgICAgICBpZiAocmVhZCkNCj4gKyAg
ICAgICAgICAgICAgIGxpbWl0ID0gcmFzX2NvcmUtPnJhc19lZXByb20ubWF4X3JlYWRfbGVuOw0K
PiArICAgICAgIGVsc2UNCj4gKyAgICAgICAgICAgICAgIGxpbWl0ID0gcmFzX2NvcmUtPnJhc19l
ZXByb20ubWF4X3dyaXRlX2xlbjsNCj4gKw0KPiArICAgICAgIGlmIChsaW1pdCAmJiAobGltaXQg
PD0gRUVQUk9NX09GRlNFVF9TSVpFKSkgew0KPiArICAgICAgICAgICAgICAgUkFTX0RFVl9FUlIo
cmFzX2NvcmUtPmRldiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFkZHI6
MHglMDRYIHNpemU6MHglMDJYOnF1aXJrIG1heF8lc19sZW4gbXVzdCBiZSA+ICVkIiwNCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZXByb21fYWRkciwgYnVmX3NpemUsDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZCA/ICJyZWFkIiA6ICJ3cml0ZSIsIEVF
UFJPTV9PRkZTRVRfU0laRSk7DQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4g
KyAgICAgICB9DQo+ICsNCj4gKyAgICAgICByYXNfY29yZV9kb3duX2dwdV9yZXNldF9sb2NrKHJh
c19jb3JlKTsNCj4gKw0KPiArICAgICAgIGlmIChsaW1pdCA9PSAwKSB7DQo+ICsgICAgICAgICAg
ICAgICByZXMgPSBfX3Jhc19lZXByb21feGZlcihyYXNfY29yZSwgZWVwcm9tX2FkZHIsDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZXByb21fYnVmLCBidWZfc2l6
ZSwgcmVhZCk7DQo+ICsgICAgICAgfSBlbHNlIHsNCj4gKyAgICAgICAgICAgICAgIC8qIFRoZSAi
bGltaXQiIGluY2x1ZGVzIGFsbCBkYXRhIGJ5dGVzIHNlbnQvcmVjZWl2ZWQsDQo+ICsgICAgICAg
ICAgICAgICAgKiB3aGljaCB3b3VsZCBpbmNsdWRlIHRoZSBFRVBST01fT0ZGU0VUX1NJWkUgYnl0
ZXMuDQo+ICsgICAgICAgICAgICAgICAgKiBBY2NvdW50IGZvciB0aGVtIGhlcmUuDQo+ICsgICAg
ICAgICAgICAgICAgKi8NCj4gKyAgICAgICAgICAgICAgIGxpbWl0IC09IEVFUFJPTV9PRkZTRVRf
U0laRTsNCj4gKyAgICAgICAgICAgICAgIGZvciAoIDsgYnVmX3NpemUgPiAwOw0KPiArICAgICAg
ICAgICAgICAgICAgICAgICBidWZfc2l6ZSAtPSBwcywgZWVwcm9tX2FkZHIgKz0gcHMsIGVlcHJv
bV9idWYgKz0gcHMpIHsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcHMgPSAoYnVmX3NpemUg
PCBsaW1pdCkgPyBidWZfc2l6ZSA6IGxpbWl0Ow0KPiArDQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIHIgPSBfX3Jhc19lZXByb21feGZlcihyYXNfY29yZSwgZWVwcm9tX2FkZHIsDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVlcHJvbV9idWYsIHBz
LCByZWFkKTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgPCAwKQ0KPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiArDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIHJlcyArPSByOw0KPiArICAgICAgICAgICAgICAgfQ0KPiArICAgICAgIH0NCj4gKw0K
PiArICAgICAgIHJhc19jb3JlX3VwX2dwdV9yZXNldF9sb2NrKHJhc19jb3JlKTsNCj4gKw0KPiAr
ICAgICAgIHJldHVybiByZXM7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgX19lZXByb21fcmVh
ZChzdHJ1Y3QgcmFzX2NvcmVfY29udGV4dCAqcmFzX2NvcmUsDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHUzMiBlZXByb21fYWRkciwgdTggKmVlcHJvbV9idWYsIHUzMiBieXRlcykN
Cj4gK3sNCj4gKyAgICAgICByZXR1cm4gX19lZXByb21feGZlcihyYXNfY29yZSwgZWVwcm9tX2Fk
ZHIsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIGVlcHJvbV9idWYsIGJ5dGVzLCB0cnVl
KTsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBfX2VlcHJvbV93cml0ZShzdHJ1Y3QgcmFzX2Nv
cmVfY29udGV4dCAqcmFzX2NvcmUsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
MzIgZWVwcm9tX2FkZHIsIHU4ICplZXByb21fYnVmLCB1MzIgYnl0ZXMpDQo+ICt7DQo+ICsgICAg
ICAgcmV0dXJuIF9fZWVwcm9tX3hmZXIocmFzX2NvcmUsIGVlcHJvbV9hZGRyLA0KPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICBlZXByb21fYnVmLCBieXRlcywgZmFsc2UpOw0KPiArfQ0KPiAr
DQo+ICtzdGF0aWMgdm9pZA0KPiArX19lbmNvZGVfdGFibGVfaGVhZGVyX3RvX2J1ZihzdHJ1Y3Qg
cmFzX2VlcHJvbV90YWJsZV9oZWFkZXIgKmhkciwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBjaGFyICpidWYpDQo+ICt7DQo+ICsgICAgICAgdTMyICpwcCA9ICh1aW50
MzJfdCAqKWJ1ZjsNCj4gKw0KPiArICAgICAgIHBwWzBdID0gY3B1X3RvX2xlMzIoaGRyLT5oZWFk
ZXIpOw0KPiArICAgICAgIHBwWzFdID0gY3B1X3RvX2xlMzIoaGRyLT52ZXJzaW9uKTsNCj4gKyAg
ICAgICBwcFsyXSA9IGNwdV90b19sZTMyKGhkci0+Zmlyc3RfcmVjX29mZnNldCk7DQo+ICsgICAg
ICAgcHBbM10gPSBjcHVfdG9fbGUzMihoZHItPnRibF9zaXplKTsNCj4gKyAgICAgICBwcFs0XSA9
IGNwdV90b19sZTMyKGhkci0+Y2hlY2tzdW0pOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdm9pZA0K
PiArX19kZWNvZGVfdGFibGVfaGVhZGVyX2Zyb21fYnVmKHN0cnVjdCByYXNfZWVwcm9tX3RhYmxl
X2hlYWRlciAqaGRyLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
Y2hhciAqYnVmKQ0KPiArew0KPiArICAgICAgIHUzMiAqcHAgPSAodWludDMyX3QgKilidWY7DQo+
ICsNCj4gKyAgICAgICBoZHItPmhlYWRlciAgICAgICAgICAgPSBsZTMyX3RvX2NwdShwcFswXSk7
DQo+ICsgICAgICAgaGRyLT52ZXJzaW9uICAgICAgICAgID0gbGUzMl90b19jcHUocHBbMV0pOw0K
PiArICAgICAgIGhkci0+Zmlyc3RfcmVjX29mZnNldCA9IGxlMzJfdG9fY3B1KHBwWzJdKTsNCj4g
KyAgICAgICBoZHItPnRibF9zaXplICAgICAgICAgPSBsZTMyX3RvX2NwdShwcFszXSk7DQo+ICsg
ICAgICAgaGRyLT5jaGVja3N1bSAgICAgICAgID0gbGUzMl90b19jcHUocHBbNF0pOw0KPiArfQ0K
PiArDQo+ICtzdGF0aWMgaW50IF9fd3JpdGVfdGFibGVfaGVhZGVyKHN0cnVjdCByYXNfZWVwcm9t
X2NvbnRyb2wgKmNvbnRyb2wpDQo+ICt7DQo+ICsgICAgICAgdTggYnVmW1JBU19UQUJMRV9IRUFE
RVJfU0laRV07DQo+ICsgICAgICAgc3RydWN0IHJhc19jb3JlX2NvbnRleHQgKnJhc19jb3JlID0g
dG9fcmFzX2NvcmVfY29udGV4dChjb250cm9sKTsNCj4gKyAgICAgICBpbnQgcmVzOw0KPiArDQo+
ICsgICAgICAgbWVtc2V0KGJ1ZiwgMCwgc2l6ZW9mKGJ1ZikpOw0KPiArICAgICAgIF9fZW5jb2Rl
X3RhYmxlX2hlYWRlcl90b19idWYoJmNvbnRyb2wtPnRibF9oZHIsIGJ1Zik7DQo+ICsNCj4gKyAg
ICAgICAvKiBpMmMgbWF5IGJlIHVuc3RhYmxlIGluIGdwdSByZXNldCAqLw0KPiArICAgICAgIHJl
cyA9IF9fZWVwcm9tX3dyaXRlKHJhc19jb3JlLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29udHJvbC0+aTJjX2FkZHJlc3MgKw0KPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29udHJvbC0+cmFzX2hlYWRlcl9vZmZzZXQsDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBidWYsIFJBU19UQUJMRV9IRUFERVJfU0laRSk7DQo+ICsNCj4g
KyAgICAgICBpZiAocmVzIDwgMCkgew0KPiArICAgICAgICAgICAgICAgUkFTX0RFVl9FUlIocmFz
X2NvcmUtPmRldiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIkZhaWxlZCB0byB3cml0ZSBF
RVBST00gdGFibGUgaGVhZGVyOiVkXG4iLCByZXMpOw0KPiArICAgICAgIH0gZWxzZSBpZiAocmVz
IDwgUkFTX1RBQkxFX0hFQURFUl9TSVpFKSB7DQo+ICsgICAgICAgICAgICAgICBSQVNfREVWX0VS
UihyYXNfY29yZS0+ZGV2LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAiU2hvcnQgd3JpdGU6
JWQgb3V0IG9mICVkXG4iLCByZXMsIFJBU19UQUJMRV9IRUFERVJfU0laRSk7DQo+ICsgICAgICAg
ICAgICAgICByZXMgPSAtRUlPOw0KPiArICAgICAgIH0gZWxzZSB7DQo+ICsgICAgICAgICAgICAg
ICByZXMgPSAwOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIHJldHVybiByZXM7DQo+ICt9
DQo+ICsNCj4gK3N0YXRpYyB2b2lkDQo+ICtfX2VuY29kZV90YWJsZV9yYXNfaW5mb190b19idWYo
c3RydWN0IHJhc19lZXByb21fdGFibGVfcmFzX2luZm8gKnJhaSwNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGNoYXIgKmJ1ZikNCj4gK3sNCj4gKyAgICAgICB1MzIg
KnBwID0gKHVpbnQzMl90ICopYnVmOw0KPiArICAgICAgIHUzMiB0bXA7DQo+ICsNCj4gKyAgICAg
ICB0bXAgPSAoKHVpbnQzMl90KShyYWktPnJtYV9zdGF0dXMpICYgMHhGRikgfA0KPiArICAgICAg
ICAgICAgICgoKHVpbnQzMl90KShyYWktPmhlYWx0aF9wZXJjZW50KSA8PCA4KSAmIDB4RkYwMCkg
fA0KPiArICAgICAgICAgICAgICgoKHVpbnQzMl90KShyYWktPmVjY19wYWdlX3RocmVzaG9sZCkg
PDwgMTYpICYgMHhGRkZGMDAwMCk7DQo+ICsgICAgICAgcHBbMF0gPSBjcHVfdG9fbGUzMih0bXAp
Ow0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdm9pZA0KPiArX19kZWNvZGVfdGFibGVfcmFzX2luZm9f
ZnJvbV9idWYoc3RydWN0IHJhc19lZXByb21fdGFibGVfcmFzX2luZm8gKnJhaSwNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgY2hhciAqYnVmKQ0KPiArew0KPiAr
ICAgICAgIHUzMiAqcHAgPSAodWludDMyX3QgKilidWY7DQo+ICsgICAgICAgdTMyIHRtcDsNCj4g
Kw0KPiArICAgICAgIHRtcCA9IGxlMzJfdG9fY3B1KHBwWzBdKTsNCj4gKyAgICAgICByYWktPnJt
YV9zdGF0dXMgPSB0bXAgJiAweEZGOw0KPiArICAgICAgIHJhaS0+aGVhbHRoX3BlcmNlbnQgPSAo
dG1wID4+IDgpICYgMHhGRjsNCj4gKyAgICAgICByYWktPmVjY19wYWdlX3RocmVzaG9sZCA9ICh0
bXAgPj4gMTYpICYgMHhGRkZGOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IF9fd3JpdGVfdGFi
bGVfcmFzX2luZm8oc3RydWN0IHJhc19lZXByb21fY29udHJvbCAqY29udHJvbCkNCj4gK3sNCj4g
KyAgICAgICBzdHJ1Y3QgcmFzX2NvcmVfY29udGV4dCAqcmFzX2NvcmUgPSB0b19yYXNfY29yZV9j
b250ZXh0KGNvbnRyb2wpOw0KPiArICAgICAgIHU4ICpidWY7DQo+ICsgICAgICAgaW50IHJlczsN
Cj4gKw0KPiArICAgICAgIGJ1ZiA9IGt6YWxsb2MoUkFTX1RBQkxFX1YyXzFfSU5GT19TSVpFLCBH
RlBfS0VSTkVMKTsNCj4gKyAgICAgICBpZiAoIWJ1Zikgew0KPiArICAgICAgICAgICAgICAgUkFT
X0RFVl9FUlIocmFzX2NvcmUtPmRldiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIkZhaWxl
ZCB0byBhbGxvYyBidWYgdG8gd3JpdGUgdGFibGUgcmFzIGluZm9cbiIpOw0KPiArICAgICAgICAg
ICAgICAgcmV0dXJuIC1FTk9NRU07DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgX19lbmNv
ZGVfdGFibGVfcmFzX2luZm9fdG9fYnVmKCZjb250cm9sLT50YmxfcmFpLCBidWYpOw0KPiArDQo+
ICsgICAgICAgLyogaTJjIG1heSBiZSB1bnN0YWJsZSBpbiBncHUgcmVzZXQgKi8NCj4gKyAgICAg
ICByZXMgPSBfX2VlcHJvbV93cml0ZShyYXNfY29yZSwNCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnRyb2wtPmkyY19hZGRyZXNzICsNCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnRyb2wtPnJhc19pbmZvX29mZnNldCwNCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGJ1ZiwgUkFTX1RBQkxFX1YyXzFfSU5GT19TSVpFKTsNCj4g
Kw0KPiArICAgICAgIGlmIChyZXMgPCAwKSB7DQo+ICsgICAgICAgICAgICAgICBSQVNfREVWX0VS
UihyYXNfY29yZS0+ZGV2LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAiRmFpbGVkIHRvIHdy
aXRlIEVFUFJPTSB0YWJsZSByYXMgaW5mbzolZFxuIiwgcmVzKTsNCj4gKyAgICAgICB9IGVsc2Ug
aWYgKHJlcyA8IFJBU19UQUJMRV9WMl8xX0lORk9fU0laRSkgew0KPiArICAgICAgICAgICAgICAg
UkFTX0RFVl9FUlIocmFzX2NvcmUtPmRldiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIlNo
b3J0IHdyaXRlOiVkIG91dCBvZiAlZFxuIiwgcmVzLCBSQVNfVEFCTEVfVjJfMV9JTkZPX1NJWkUp
Ow0KPiArICAgICAgICAgICAgICAgcmVzID0gLUVJTzsNCj4gKyAgICAgICB9IGVsc2Ugew0KPiAr
ICAgICAgICAgICAgICAgcmVzID0gMDsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICBrZnJl
ZShidWYpOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIHJlczsNCj4gK30NCj4gKw0KPiArc3RhdGlj
IHU4IF9fY2FsY19oZHJfYnl0ZV9zdW0oY29uc3Qgc3RydWN0IHJhc19lZXByb21fY29udHJvbCAq
Y29udHJvbCkNCj4gK3sNCj4gKyAgICAgICBpbnQgaWk7DQo+ICsgICAgICAgdTggICpwcCwgY3N1
bTsNCj4gKyAgICAgICB1MzIgc3o7DQo+ICsNCj4gKyAgICAgICAvKiBIZWFkZXIgY2hlY2tzdW0s
IHNraXAgY2hlY2tzdW0gZmllbGQgaW4gdGhlIGNhbGN1bGF0aW9uICovDQo+ICsgICAgICAgc3og
PSBzaXplb2YoY29udHJvbC0+dGJsX2hkcikgLSBzaXplb2YoY29udHJvbC0+dGJsX2hkci5jaGVj
a3N1bSk7DQo+ICsgICAgICAgcHAgPSAodTggKikgJmNvbnRyb2wtPnRibF9oZHI7DQo+ICsgICAg
ICAgY3N1bSA9IDA7DQo+ICsgICAgICAgZm9yIChpaSA9IDA7IGlpIDwgc3o7IGlpKyssIHBwKysp
DQo+ICsgICAgICAgICAgICAgICBjc3VtICs9ICpwcDsNCj4gKw0KPiArICAgICAgIHJldHVybiBj
c3VtOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdTggX19jYWxjX3Jhc19pbmZvX2J5dGVfc3VtKGNv
bnN0IHN0cnVjdCByYXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2wpDQo+ICt7DQo+ICsgICAgICAg
aW50IGlpOw0KPiArICAgICAgIHU4ICAqcHAsIGNzdW07DQo+ICsgICAgICAgdTMyIHN6Ow0KPiAr
DQo+ICsgICAgICAgc3ogPSBzaXplb2YoY29udHJvbC0+dGJsX3JhaSk7DQo+ICsgICAgICAgcHAg
PSAodTggKikgJmNvbnRyb2wtPnRibF9yYWk7DQo+ICsgICAgICAgY3N1bSA9IDA7DQo+ICsgICAg
ICAgZm9yIChpaSA9IDA7IGlpIDwgc3o7IGlpKyssIHBwKyspDQo+ICsgICAgICAgICAgICAgICBj
c3VtICs9ICpwcDsNCj4gKw0KPiArICAgICAgIHJldHVybiBjc3VtOw0KPiArfQ0KPiArDQo+ICtz
dGF0aWMgaW50IHJhc19lZXByb21fY29ycmVjdF9oZWFkZXJfdGFnKA0KPiArICAgICAgIHN0cnVj
dCByYXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2wsDQo+ICsgICAgICAgdWludDMyX3QgaGVhZGVy
KQ0KPiArew0KPiArICAgICAgIHN0cnVjdCByYXNfZWVwcm9tX3RhYmxlX2hlYWRlciAqaGRyID0g
JmNvbnRyb2wtPnRibF9oZHI7DQo+ICsgICAgICAgdTggKmhoOw0KPiArICAgICAgIGludCByZXM7
DQo+ICsgICAgICAgdTggY3N1bTsNCj4gKw0KPiArICAgICAgIGNzdW0gPSAtaGRyLT5jaGVja3N1
bTsNCj4gKw0KPiArICAgICAgIGhoID0gKHZvaWQgKikgJmhkci0+aGVhZGVyOw0KPiArICAgICAg
IGNzdW0gLT0gKGhoWzBdICsgaGhbMV0gKyBoaFsyXSArIGhoWzNdKTsNCj4gKyAgICAgICBoaCA9
ICh2b2lkICopICZoZWFkZXI7DQo+ICsgICAgICAgY3N1bSArPSBoaFswXSArIGhoWzFdICsgaGhb
Ml0gKyBoaFszXTsNCj4gKyAgICAgICBjc3VtID0gLWNzdW07DQo+ICsgICAgICAgbXV0ZXhfbG9j
aygmY29udHJvbC0+cmFzX3RibF9tdXRleCk7DQo+ICsgICAgICAgaGRyLT5oZWFkZXIgPSBoZWFk
ZXI7DQo+ICsgICAgICAgaGRyLT5jaGVja3N1bSA9IGNzdW07DQo+ICsgICAgICAgcmVzID0gX193
cml0ZV90YWJsZV9oZWFkZXIoY29udHJvbCk7DQo+ICsgICAgICAgbXV0ZXhfdW5sb2NrKCZjb250
cm9sLT5yYXNfdGJsX211dGV4KTsNCj4gKw0KPiArICAgICAgIHJldHVybiByZXM7DQo+ICt9DQo+
ICsNCj4gK3N0YXRpYyB2b2lkIHJhc19zZXRfZWVwcm9tX3RhYmxlX3ZlcnNpb24oc3RydWN0IHJh
c19lZXByb21fY29udHJvbCAqY29udHJvbCkNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgcmFzX2Vl
cHJvbV90YWJsZV9oZWFkZXIgKmhkciA9ICZjb250cm9sLT50YmxfaGRyOw0KPiArDQo+ICsgICAg
ICAgaGRyLT52ZXJzaW9uID0gUkFTX1RBQkxFX1ZFUl9WMzsNCj4gK30NCj4gKw0KPiArLyoqDQo+
ICsgKiByYXNfZWVwcm9tX3Jlc2V0X3RhYmxlIC0tIFJlc2V0IHRoZSBSQVMgRUVQUk9NIHRhYmxl
DQo+ICsgKiBAY29udHJvbDogcG9pbnRlciB0byBjb250cm9sIHN0cnVjdHVyZQ0KPiArICoNCj4g
KyAqIFJlc2V0IHRoZSBjb250ZW50cyBvZiB0aGUgaGVhZGVyIG9mIHRoZSBSQVMgRUVQUk9NIHRh
YmxlLg0KPiArICogUmV0dXJuIDAgb24gc3VjY2VzcywgLWVycm5vIG9uIGVycm9yLg0KPiArICov
DQo+ICtpbnQgcmFzX2VlcHJvbV9yZXNldF90YWJsZShzdHJ1Y3QgcmFzX2NvcmVfY29udGV4dCAq
cmFzX2NvcmUpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0IHJhc19lZXByb21fY29udHJvbCAqY29u
dHJvbCA9ICZyYXNfY29yZS0+cmFzX2VlcHJvbTsNCj4gKyAgICAgICBzdHJ1Y3QgcmFzX2VlcHJv
bV90YWJsZV9oZWFkZXIgKmhkciA9ICZjb250cm9sLT50YmxfaGRyOw0KPiArICAgICAgIHN0cnVj
dCByYXNfZWVwcm9tX3RhYmxlX3Jhc19pbmZvICpyYWkgPSAmY29udHJvbC0+dGJsX3JhaTsNCj4g
KyAgICAgICB1OCBjc3VtOw0KPiArICAgICAgIGludCByZXM7DQo+ICsNCj4gKyAgICAgICBtdXRl
eF9sb2NrKCZjb250cm9sLT5yYXNfdGJsX211dGV4KTsNCj4gKw0KPiArICAgICAgIGhkci0+aGVh
ZGVyID0gUkFTX1RBQkxFX0hEUl9WQUw7DQo+ICsgICAgICAgcmFzX3NldF9lZXByb21fdGFibGVf
dmVyc2lvbihjb250cm9sKTsNCj4gKw0KPiArICAgICAgIGlmIChoZHItPnZlcnNpb24gPj0gUkFT
X1RBQkxFX1ZFUl9WMl8xKSB7DQo+ICsgICAgICAgICAgICAgICBoZHItPmZpcnN0X3JlY19vZmZz
ZXQgPSBSQVNfUkVDT1JEX1NUQVJUX1YyXzE7DQo+ICsgICAgICAgICAgICAgICBoZHItPnRibF9z
aXplID0gUkFTX1RBQkxFX0hFQURFUl9TSVpFICsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBSQVNfVEFCTEVfVjJfMV9JTkZPX1NJWkU7DQo+ICsgICAgICAgICAgICAgICByYWkt
PnJtYV9zdGF0dXMgPSBSQVNfR1BVX0hFQUxUSF9VU0FCTEU7DQo+ICsgICAgICAgICAgICAgICAv
KioNCj4gKyAgICAgICAgICAgICAgICAqIEdQVSBoZWFsdGggcmVwcmVzZW50ZWQgYXMgYSBwZXJj
ZW50YWdlLg0KPiArICAgICAgICAgICAgICAgICogMCBtZWFucyB3b3JzdCBoZWFsdGgsIDEwMCBt
ZWFucyBmdWxseSBoZWFsdGguDQo+ICsgICAgICAgICAgICAgICAgKi8NCj4gKyAgICAgICAgICAg
ICAgIHJhaS0+aGVhbHRoX3BlcmNlbnQgPSAxMDA7DQo+ICsgICAgICAgICAgICAgICAvKiBlY2Nf
cGFnZV90aHJlc2hvbGQgPSAwIG1lYW5zIGRpc2FibGUgYmFkIHBhZ2UgcmV0aXJlbWVudCAqLw0K
PiArICAgICAgICAgICAgICAgcmFpLT5lY2NfcGFnZV90aHJlc2hvbGQgPSBjb250cm9sLT5yZWNv
cmRfdGhyZXNob2xkX2NvdW50Ow0KPiArICAgICAgIH0gZWxzZSB7DQo+ICsgICAgICAgICAgICAg
ICBoZHItPmZpcnN0X3JlY19vZmZzZXQgPSBSQVNfUkVDT1JEX1NUQVJUOw0KPiArICAgICAgICAg
ICAgICAgaGRyLT50Ymxfc2l6ZSA9IFJBU19UQUJMRV9IRUFERVJfU0laRTsNCj4gKyAgICAgICB9
DQo+ICsNCj4gKyAgICAgICBjc3VtID0gX19jYWxjX2hkcl9ieXRlX3N1bShjb250cm9sKTsNCj4g
KyAgICAgICBpZiAoaGRyLT52ZXJzaW9uID49IFJBU19UQUJMRV9WRVJfVjJfMSkNCj4gKyAgICAg
ICAgICAgICAgIGNzdW0gKz0gX19jYWxjX3Jhc19pbmZvX2J5dGVfc3VtKGNvbnRyb2wpOw0KPiAr
ICAgICAgIGNzdW0gPSAtY3N1bTsNCj4gKyAgICAgICBoZHItPmNoZWNrc3VtID0gY3N1bTsNCj4g
KyAgICAgICByZXMgPSBfX3dyaXRlX3RhYmxlX2hlYWRlcihjb250cm9sKTsNCj4gKyAgICAgICBp
ZiAoIXJlcyAmJiBoZHItPnZlcnNpb24gPiBSQVNfVEFCTEVfVkVSX1YxKQ0KPiArICAgICAgICAg
ICAgICAgcmVzID0gX193cml0ZV90YWJsZV9yYXNfaW5mbyhjb250cm9sKTsNCj4gKw0KPiArICAg
ICAgIGNvbnRyb2wtPnJhc19udW1fcmVjcyA9IDA7DQo+ICsgICAgICAgY29udHJvbC0+cmFzX2Zy
aSA9IDA7DQo+ICsNCj4gKyAgICAgICBjb250cm9sLT5iYWRfY2hhbm5lbF9iaXRtYXAgPSAwOw0K
PiArICAgICAgIHJhc19jb3JlX2V2ZW50X25vdGlmeShyYXNfY29yZSwgUkFTX0VWRU5UX0lEX19V
UERBVEVfQkFEX1BBR0VfTlVNLA0KPiArICAgICAgICAgICAgICAgJmNvbnRyb2wtPnJhc19udW1f
cmVjcyk7DQo+ICsgICAgICAgcmFzX2NvcmVfZXZlbnRfbm90aWZ5KHJhc19jb3JlLCBSQVNfRVZF
TlRfSURfX1VQREFURV9CQURfQ0hBTk5FTF9CSVRNQVAsDQo+ICsgICAgICAgICAgICAgICAmY29u
dHJvbC0+YmFkX2NoYW5uZWxfYml0bWFwKTsNCj4gKyAgICAgICBjb250cm9sLT51cGRhdGVfY2hh
bm5lbF9mbGFnID0gZmFsc2U7DQo+ICsNCj4gKyAgICAgICBtdXRleF91bmxvY2soJmNvbnRyb2wt
PnJhc190YmxfbXV0ZXgpOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIHJlczsNCj4gK30NCj4gKw0K
PiArc3RhdGljIHZvaWQNCj4gK19fZW5jb2RlX3RhYmxlX3JlY29yZF90b19idWYoc3RydWN0IHJh
c19lZXByb21fY29udHJvbCAqY29udHJvbCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgZWVwcm9tX3VtY19yZWNvcmQgKnJlY29yZCwNCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBjaGFyICpidWYpDQo+ICt7DQo+ICsgICAgICAgX19sZTY0IHRt
cCA9IDA7DQo+ICsgICAgICAgaW50IGkgPSAwOw0KPiArDQo+ICsgICAgICAgLyogTmV4dCBhcmUg
YWxsIHJlY29yZCBmaWVsZHMgYWNjb3JkaW5nIHRvIEVFUFJPTSBwYWdlIHNwZWMgaW4gTEUgZm9y
YW10ICovDQo+ICsgICAgICAgYnVmW2krK10gPSByZWNvcmQtPmVycl90eXBlOw0KPiArDQo+ICsg
ICAgICAgYnVmW2krK10gPSByZWNvcmQtPmJhbms7DQo+ICsNCj4gKyAgICAgICB0bXAgPSBjcHVf
dG9fbGU2NChyZWNvcmQtPnRzKTsNCj4gKyAgICAgICBtZW1jcHkoYnVmICsgaSwgJnRtcCwgOCk7
DQo+ICsgICAgICAgaSArPSA4Ow0KPiArDQo+ICsgICAgICAgdG1wID0gY3B1X3RvX2xlNjQoKHJl
Y29yZC0+b2Zmc2V0ICYgMHhmZmZmZmZmZmZmZmYpKTsNCj4gKyAgICAgICBtZW1jcHkoYnVmICsg
aSwgJnRtcCwgNik7DQo+ICsgICAgICAgaSArPSA2Ow0KPiArDQo+ICsgICAgICAgYnVmW2krK10g
PSByZWNvcmQtPm1lbV9jaGFubmVsOw0KPiArICAgICAgIGJ1ZltpKytdID0gcmVjb3JkLT5tY3Vt
Y19pZDsNCj4gKw0KPiArICAgICAgIHRtcCA9IGNwdV90b19sZTY0KChyZWNvcmQtPnJldGlyZWRf
cm93X3BmbiAmIDB4ZmZmZmZmZmZmZmZmKSk7DQo+ICsgICAgICAgbWVtY3B5KGJ1ZiArIGksICZ0
bXAsIDYpOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdm9pZA0KPiArX19kZWNvZGVfdGFibGVfcmVj
b3JkX2Zyb21fYnVmKHN0cnVjdCByYXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2wsDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZWVwcm9tX3VtY19yZWNvcmQgKnJlY29y
ZCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGNoYXIgKmJ1ZikN
Cj4gK3sNCj4gKyAgICAgICBfX2xlNjQgdG1wID0gMDsNCj4gKyAgICAgICBpbnQgaSA9ICAwOw0K
PiArDQo+ICsgICAgICAgLyogTmV4dCBhcmUgYWxsIHJlY29yZCBmaWVsZHMgYWNjb3JkaW5nIHRv
IEVFUFJPTSBwYWdlIHNwZWMgaW4gTEUgZm9yYW10ICovDQo+ICsgICAgICAgcmVjb3JkLT5lcnJf
dHlwZSA9IGJ1ZltpKytdOw0KPiArDQo+ICsgICAgICAgcmVjb3JkLT5iYW5rID0gYnVmW2krK107
DQo+ICsNCj4gKyAgICAgICBtZW1jcHkoJnRtcCwgYnVmICsgaSwgOCk7DQo+ICsgICAgICAgcmVj
b3JkLT50cyA9IGxlNjRfdG9fY3B1KHRtcCk7DQo+ICsgICAgICAgaSArPSA4Ow0KPiArDQo+ICsg
ICAgICAgbWVtY3B5KCZ0bXAsIGJ1ZiArIGksIDYpOw0KPiArICAgICAgIHJlY29yZC0+b2Zmc2V0
ID0gKGxlNjRfdG9fY3B1KHRtcCkgJiAweGZmZmZmZmZmZmZmZik7DQo+ICsgICAgICAgaSArPSA2
Ow0KPiArDQo+ICsgICAgICAgcmVjb3JkLT5tZW1fY2hhbm5lbCA9IGJ1ZltpKytdOw0KPiArICAg
ICAgIHJlY29yZC0+bWN1bWNfaWQgPSBidWZbaSsrXTsNCj4gKw0KPiArICAgICAgIG1lbWNweSgm
dG1wLCBidWYgKyBpLCAgNik7DQo+ICsgICAgICAgcmVjb3JkLT5yZXRpcmVkX3Jvd19wZm4gPSAo
bGU2NF90b19jcHUodG1wKSAmIDB4ZmZmZmZmZmZmZmZmKTsNCj4gK30NCj4gKw0KPiArYm9vbCBy
YXNfZWVwcm9tX2NoZWNrX3NhZmV0eV93YXRlcm1hcmsoc3RydWN0IHJhc19jb3JlX2NvbnRleHQg
KnJhc19jb3JlKQ0KPiArew0KPiArICAgICAgIHN0cnVjdCByYXNfZWVwcm9tX2NvbnRyb2wgKmNv
bnRyb2wgPSAmcmFzX2NvcmUtPnJhc19lZXByb207DQo+ICsgICAgICAgYm9vbCByZXQgPSBmYWxz
ZTsNCj4gKyAgICAgICBpbnQgYmFkX3BhZ2VfY291bnQ7DQo+ICsNCj4gKyAgICAgICBpZiAoIV9f
aXNfcmFzX2VlcHJvbV9zdXBwb3J0ZWQocmFzX2NvcmUpIHx8DQo+ICsgICAgICAgICAgICFjb250
cm9sLT5yZWNvcmRfdGhyZXNob2xkX2NvbmZpZykNCj4gKyAgICAgICAgICAgICAgIHJldHVybiBm
YWxzZTsNCj4gKw0KPiArICAgICAgIGJhZF9wYWdlX2NvdW50ID0gcmFzX3VtY19nZXRfYmFkcGFn
ZV9jb3VudChyYXNfY29yZSk7DQo+ICsgICAgICAgaWYgKGNvbnRyb2wtPnRibF9oZHIuaGVhZGVy
ID09IFJBU19UQUJMRV9IRFJfQkFEKSB7DQo+ICsgICAgICAgICAgICAgICBpZiAoYmFkX3BhZ2Vf
Y291bnQgPiBjb250cm9sLT5yZWNvcmRfdGhyZXNob2xkX2NvdW50KQ0KPiArICAgICAgICAgICAg
ICAgICAgICAgICBSQVNfREVWX1dBUk4ocmFzX2NvcmUtPmRldiwgIlJBUyByZWNvcmRzOiVkIGV4
Y2VlZCB0aHJlc2hvbGQ6JWQiLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJh
ZF9wYWdlX2NvdW50LCBjb250cm9sLT5yZWNvcmRfdGhyZXNob2xkX2NvdW50KTsNCj4gKw0KPiAr
ICAgICAgICAgICAgICAgaWYgKChjb250cm9sLT5yZWNvcmRfdGhyZXNob2xkX2NvbmZpZyA9PSBX
QVJOX05PTlNUT1BfT1ZFUl9USFJFU0hPTEQpIHx8DQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IChjb250cm9sLT5yZWNvcmRfdGhyZXNob2xkX2NvbmZpZyA9PSBOT05TVE9QX09WRVJfVEhSRVNI
T0xEKSkgew0KPiArICAgICAgICAgICAgICAgICAgICAgICBSQVNfREVWX1dBUk4ocmFzX2NvcmUt
PmRldiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUGxlYXNlIGNvbnN1bHQg
QU1EIFNlcnZpY2UgQWN0aW9uIEd1aWRlIChTQUcpIGZvciBhcHByb3ByaWF0ZSBzZXJ2aWNlIHBy
b2NlZHVyZXMuXG4iKTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gZmFsc2U7DQo+
ICsgICAgICAgICAgICAgICB9IGVsc2Ugew0KPiArICAgICAgICAgICAgICAgICAgICAgICByYXNf
Y29yZS0+aXNfcm1hID0gdHJ1ZTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgUkFTX0RFVl9X
QVJOKHJhc19jb3JlLT5kZXYsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlBs
ZWFzZSBjb25zaWRlciBhZGp1c3RpbmcgdGhlIGN1c3RvbWl6ZWQgdGhyZXNob2xkLlxuIik7DQo+
ICsgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IHRydWU7DQo+ICsgICAgICAgICAgICAgICB9
DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAr
LyoqDQo+ICsgKiBfX3Jhc19lZXByb21fd3JpdGUgLS0gd3JpdGUgaW5kZXhlZCBmcm9tIGJ1ZmZl
ciB0byBFRVBST00NCj4gKyAqIEBjb250cm9sOiBwb2ludGVyIHRvIGNvbnRyb2wgc3RydWN0dXJl
DQo+ICsgKiBAYnVmOiBwb2ludGVyIHRvIGJ1ZmZlciBjb250YWluaW5nIGRhdGEgdG8gd3JpdGUN
Cj4gKyAqIEBmcmk6IHN0YXJ0IHdyaXRpbmcgYXQgdGhpcyBpbmRleA0KPiArICogQG51bTogbnVt
YmVyIG9mIHJlY29yZHMgdG8gd3JpdGUNCj4gKyAqDQo+ICsgKiBUaGUgY2FsbGVyIG11c3QgaG9s
ZCB0aGUgdGFibGUgbXV0ZXggaW4gQGNvbnRyb2wuDQo+ICsgKiBSZXR1cm4gMCBvbiBzdWNjZXNz
LCAtZXJybm8gb3RoZXJ3aXNlLg0KPiArICovDQo+ICtzdGF0aWMgaW50IF9fcmFzX2VlcHJvbV93
cml0ZShzdHJ1Y3QgcmFzX2VlcHJvbV9jb250cm9sICpjb250cm9sLA0KPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1OCAqYnVmLCBjb25zdCB1MzIgZnJpLCBjb25zdCB1MzIgbnVtKQ0K
PiArew0KPiArICAgICAgIHN0cnVjdCByYXNfY29yZV9jb250ZXh0ICpyYXNfY29yZSA9IHRvX3Jh
c19jb3JlX2NvbnRleHQoY29udHJvbCk7DQo+ICsgICAgICAgdTMyIGJ1Zl9zaXplOw0KPiArICAg
ICAgIGludCByZXM7DQo+ICsNCj4gKyAgICAgICAvKiBpMmMgbWF5IGJlIHVuc3RhYmxlIGluIGdw
dSByZXNldCAqLw0KPiArICAgICAgIGJ1Zl9zaXplID0gbnVtICogUkFTX1RBQkxFX1JFQ09SRF9T
SVpFOw0KPiArICAgICAgIHJlcyA9IF9fZWVwcm9tX3dyaXRlKHJhc19jb3JlLA0KPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC0+aTJjX2FkZHJlc3MgKyBSQVNfSU5ERVhf
VE9fT0ZGU0VUKGNvbnRyb2wsIGZyaSksDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBidWYsIGJ1Zl9zaXplKTsNCj4gKyAgICAgICBpZiAocmVzIDwgMCkgew0KPiArICAgICAgICAg
ICAgICAgUkFTX0RFVl9FUlIocmFzX2NvcmUtPmRldiwNCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgIldyaXRpbmcgJWQgRUVQUk9NIHRhYmxlIHJlY29yZHMgZXJyb3I6JWRcbiIsIG51bSwgcmVz
KTsNCj4gKyAgICAgICB9IGVsc2UgaWYgKHJlcyA8IGJ1Zl9zaXplKSB7DQo+ICsgICAgICAgICAg
ICAgICAvKiBTaG9ydCB3cml0ZSwgcmV0dXJuIGVycm9yLiovDQo+ICsgICAgICAgICAgICAgICBS
QVNfREVWX0VSUihyYXNfY29yZS0+ZGV2LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAiV3Jv
dGUgJWQgcmVjb3JkcyBvdXQgb2YgJWRcbiIsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIChy
ZXMvUkFTX1RBQkxFX1JFQ09SRF9TSVpFKSwgbnVtKTsNCj4gKyAgICAgICAgICAgICAgIHJlcyA9
IC1FSU87DQo+ICsgICAgICAgfSBlbHNlIHsNCj4gKyAgICAgICAgICAgICAgIHJlcyA9IDA7DQo+
ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgcmV0dXJuIHJlczsNCj4gK30NCj4gKw0KPiArc3Rh
dGljIGludCByYXNfZWVwcm9tX2FwcGVuZF90YWJsZShzdHJ1Y3QgcmFzX2VlcHJvbV9jb250cm9s
ICpjb250cm9sLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBl
ZXByb21fdW1jX3JlY29yZCAqcmVjb3JkLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IHUzMiBudW0pDQo+ICt7DQo+ICsgICAgICAgdTMyIGEsIGIsIGk7DQo+ICsg
ICAgICAgdTggKmJ1ZiwgKnBwOw0KPiArICAgICAgIGludCByZXM7DQo+ICsNCj4gKyAgICAgICBi
dWYgPSBrY2FsbG9jKG51bSwgUkFTX1RBQkxFX1JFQ09SRF9TSVpFLCBHRlBfS0VSTkVMKTsNCj4g
KyAgICAgICBpZiAoIWJ1ZikNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KPiAr
DQo+ICsgICAgICAgLyogRW5jb2RlIGFsbCBvZiB0aGVtIGluIG9uZSBnby4NCj4gKyAgICAgICAg
Ki8NCj4gKyAgICAgICBwcCA9IGJ1ZjsNCj4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtOyBp
KyssIHBwICs9IFJBU19UQUJMRV9SRUNPUkRfU0laRSkgew0KPiArICAgICAgICAgICAgICAgX19l
bmNvZGVfdGFibGVfcmVjb3JkX3RvX2J1Zihjb250cm9sLCAmcmVjb3JkW2ldLCBwcCk7DQo+ICsN
Cj4gKyAgICAgICAgICAgICAgIC8qIHVwZGF0ZSBiYWQgY2hhbm5lbCBiaXRtYXAgKi8NCj4gKyAg
ICAgICAgICAgICAgIGlmICgocmVjb3JkW2ldLm1lbV9jaGFubmVsIDwgQklUU19QRVJfVFlQRShj
b250cm9sLT5iYWRfY2hhbm5lbF9iaXRtYXApKSAmJg0KPiArICAgICAgICAgICAgICAgICAgICEo
Y29udHJvbC0+YmFkX2NoYW5uZWxfYml0bWFwICYgKDEgPDwgcmVjb3JkW2ldLm1lbV9jaGFubmVs
KSkpIHsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC0+YmFkX2NoYW5uZWxfYml0
bWFwIHw9IDEgPDwgcmVjb3JkW2ldLm1lbV9jaGFubmVsOw0KPiArICAgICAgICAgICAgICAgICAg
ICAgICBjb250cm9sLT51cGRhdGVfY2hhbm5lbF9mbGFnID0gdHJ1ZTsNCj4gKyAgICAgICAgICAg
ICAgIH0NCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICAvKiBhLCBmaXJzdCByZWNvcmQgaW5k
ZXggdG8gd3JpdGUgaW50by4NCj4gKyAgICAgICAgKiBiLCBsYXN0IHJlY29yZCBpbmRleCB0byB3
cml0ZSBpbnRvLg0KPiArICAgICAgICAqIGEgPSBmaXJzdCBpbmRleCB0byByZWFkIChmcmkpICsg
bnVtYmVyIG9mIHJlY29yZHMgaW4gdGhlIHRhYmxlLA0KPiArICAgICAgICAqIGIgPSBhICsgQG51
bSAtIDEuDQo+ICsgICAgICAgICogTGV0IE4gPSBjb250cm9sLT5yYXNfbWF4X251bV9yZWNvcmRf
Y291bnQsIHRoZW4gd2UgaGF2ZSwNCj4gKyAgICAgICAgKiBjYXNlIDA6IDAgPD0gYSA8PSBiIDwg
TiwNCj4gKyAgICAgICAgKiAgIGp1c3QgYXBwZW5kIEBudW0gcmVjb3JkcyBzdGFydGluZyBhdCBh
Ow0KPiArICAgICAgICAqIGNhc2UgMTogMCA8PSBhIDwgTiA8PSBiLA0KPiArICAgICAgICAqICAg
YXBwZW5kIChOIC0gYSkgcmVjb3JkcyBzdGFydGluZyBhdCBhLCBhbmQNCj4gKyAgICAgICAgKiAg
IGFwcGVuZCB0aGUgcmVtYWluZGVyLCAgYiAlIE4gKyAxLCBzdGFydGluZyBhdCAwLg0KPiArICAg
ICAgICAqIGNhc2UgMjogMCA8PSBmcmkgPCBOIDw9IGEgPD0gYiwgdGhlbiBtb2R1bG8gTiB3ZSBn
ZXQgdHdvIHN1YmNhc2VzLA0KPiArICAgICAgICAqIGNhc2UgMmE6IDAgPD0gYSA8PSBiIDwgTg0K
PiArICAgICAgICAqICAgYXBwZW5kIG51bSByZWNvcmRzIHN0YXJ0aW5nIGF0IGE7IGFuZCBmaXgg
ZnJpIGlmIGIgb3Zlcndyb3RlIGl0LA0KPiArICAgICAgICAqICAgYW5kIHNpbmNlIGEgPD0gYiwg
aWYgYiBvdmVyd3JvdGUgaXQgdGhlbiBhIG11c3QndmUgYWxzbywNCj4gKyAgICAgICAgKiAgIGFu
ZCBpZiBiIGRpZG4ndCBvdmVyd3JpdGUgaXQsIHRoZW4gYSBkaWRuJ3QgYWxzby4NCj4gKyAgICAg
ICAgKiBjYXNlIDJiOiAwIDw9IGIgPCBhIDwgTg0KPiArICAgICAgICAqICAgd3JpdGUgbnVtIHJl
Y29yZHMgc3RhcnRpbmcgYXQgYSwgd2hpY2ggd3JhcHMgYXJvdW5kIDA9Tg0KPiArICAgICAgICAq
ICAgYW5kIG92ZXJ3cml0ZSBmcmkgdW5jb25kaXRpb25hbGx5LiBOb3cgZnJvbSBjYXNlIDJhLA0K
PiArICAgICAgICAqICAgdGhpcyBtZWFucyB0aGF0IGIgZWNsaXBzZWQgZnJpIHRvIG92ZXJ3cml0
ZSBpdCBhbmQgd3JhcA0KPiArICAgICAgICAqICAgYXJvdW5kIDAgYWdhaW4sIGkuZS4gYiA9IDJO
K3IgcHJlIG1vZHVsbyBOLCBzbyB3ZSB1bmNvbmRpdGlvbmFsbHkNCj4gKyAgICAgICAgKiAgIHNl
dCBmcmkgPSBiICsgMSAobW9kIE4pLg0KPiArICAgICAgICAqIE5vdywgc2luY2UgZnJpIGlzIHVw
ZGF0ZWQgaW4gZXZlcnkgY2FzZSwgZXhjZXB0IHRoZSB0cml2aWFsIGNhc2UgMCwNCj4gKyAgICAg
ICAgKiB0aGUgbnVtYmVyIG9mIHJlY29yZHMgcHJlc2VudCBpbiB0aGUgdGFibGUgYWZ0ZXIgd3Jp
dGluZywgaXMsDQo+ICsgICAgICAgICogbnVtX3JlY3MgLSAxID0gYiAtIGZyaSAobW9kIE4pLCBh
bmQgd2UgdGFrZSB0aGUgcG9zaXRpdmUgdmFsdWUsDQo+ICsgICAgICAgICogYnkgYWRkaW5nIGFu
IGFyYml0cmFyeSBtdWx0aXBsZSBvZiBOIGJlZm9yZSB0YWtpbmcgdGhlIG1vZHVsbyBODQo+ICsg
ICAgICAgICogYXMgc2hvd24gYmVsb3cuDQo+ICsgICAgICAgICovDQo+ICsgICAgICAgYSA9IGNv
bnRyb2wtPnJhc19mcmkgKyBjb250cm9sLT5yYXNfbnVtX3JlY3M7DQo+ICsgICAgICAgYiA9IGEg
KyBudW0gIC0gMTsNCj4gKyAgICAgICBpZiAoYiA8IGNvbnRyb2wtPnJhc19tYXhfcmVjb3JkX2Nv
dW50KSB7DQo+ICsgICAgICAgICAgICAgICByZXMgPSBfX3Jhc19lZXByb21fd3JpdGUoY29udHJv
bCwgYnVmLCBhLCBudW0pOw0KPiArICAgICAgIH0gZWxzZSBpZiAoYSA8IGNvbnRyb2wtPnJhc19t
YXhfcmVjb3JkX2NvdW50KSB7DQo+ICsgICAgICAgICAgICAgICB1MzIgZzAsIGcxOw0KPiArDQo+
ICsgICAgICAgICAgICAgICBnMCA9IGNvbnRyb2wtPnJhc19tYXhfcmVjb3JkX2NvdW50IC0gYTsN
Cj4gKyAgICAgICAgICAgICAgIGcxID0gYiAlIGNvbnRyb2wtPnJhc19tYXhfcmVjb3JkX2NvdW50
ICsgMTsNCj4gKyAgICAgICAgICAgICAgIHJlcyA9IF9fcmFzX2VlcHJvbV93cml0ZShjb250cm9s
LCBidWYsIGEsIGcwKTsNCj4gKyAgICAgICAgICAgICAgIGlmIChyZXMpDQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gT3V0Ow0KPiArICAgICAgICAgICAgICAgcmVzID0gX19yYXNfZWVw
cm9tX3dyaXRlKGNvbnRyb2wsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGJ1ZiArIGcwICogUkFTX1RBQkxFX1JFQ09SRF9TSVpFLA0KPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwLCBnMSk7DQo+ICsgICAg
ICAgICAgICAgICBpZiAocmVzKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBnb3RvIE91dDsN
Cj4gKyAgICAgICAgICAgICAgIGlmIChnMSA+IGNvbnRyb2wtPnJhc19mcmkpDQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnRyb2wtPnJhc19mcmkgPSBnMSAlIGNvbnRyb2wtPnJhc19tYXhf
cmVjb3JkX2NvdW50Ow0KPiArICAgICAgIH0gZWxzZSB7DQo+ICsgICAgICAgICAgICAgICBhICU9
IGNvbnRyb2wtPnJhc19tYXhfcmVjb3JkX2NvdW50Ow0KPiArICAgICAgICAgICAgICAgYiAlPSBj
b250cm9sLT5yYXNfbWF4X3JlY29yZF9jb3VudDsNCj4gKw0KPiArICAgICAgICAgICAgICAgaWYg
KGEgPD0gYikgew0KPiArICAgICAgICAgICAgICAgICAgICAgICAvKiBOb3RlIHRoYXQsIGIgLSBh
ICsgMSA9IG51bS4gKi8NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX19yYXNfZWVw
cm9tX3dyaXRlKGNvbnRyb2wsIGJ1ZiwgYSwgbnVtKTsNCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgaWYgKHJlcykNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIE91dDsN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIgPj0gY29udHJvbC0+cmFzX2ZyaSkNCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLT5yYXNfZnJpID0gKGIgKyAx
KSAlIGNvbnRyb2wtPnJhc19tYXhfcmVjb3JkX2NvdW50Ow0KPiArICAgICAgICAgICAgICAgfSBl
bHNlIHsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgdTMyIGcwLCBnMTsNCj4gKw0KPiArICAg
ICAgICAgICAgICAgICAgICAgICAvKiBiIDwgYSwgd2hpY2ggbWVhbnMsIHdlIHdyaXRlIGZyb20N
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICogYSB0byB0aGUgZW5kIG9mIHRoZSB0YWJsZSwg
YW5kIGZyb20NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICogdGhlIHN0YXJ0IG9mIHRoZSB0
YWJsZSB0byBiLg0KPiArICAgICAgICAgICAgICAgICAgICAgICAgKi8NCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgZzAgPSBjb250cm9sLT5yYXNfbWF4X3JlY29yZF9jb3VudCAtIGE7DQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGcxID0gYiArIDE7DQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIHJlcyA9IF9fcmFzX2VlcHJvbV93cml0ZShjb250cm9sLCBidWYsIGEsIGcwKTsNCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcykNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBnb3RvIE91dDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX19yYXNf
ZWVwcm9tX3dyaXRlKGNvbnRyb2wsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBidWYgKyBnMCAqIFJBU19UQUJMRV9SRUNPUkRfU0laRSwgMCwgZzEp
Ow0KPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzKQ0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGdvdG8gT3V0Ow0KPiArICAgICAgICAgICAgICAgICAgICAgICBjb250
cm9sLT5yYXNfZnJpID0gZzEgJSBjb250cm9sLT5yYXNfbWF4X3JlY29yZF9jb3VudDsNCj4gKyAg
ICAgICAgICAgICAgIH0NCj4gKyAgICAgICB9DQo+ICsgICAgICAgY29udHJvbC0+cmFzX251bV9y
ZWNzID0gMSArDQo+ICsgICAgICAgICAgICAgICAoY29udHJvbC0+cmFzX21heF9yZWNvcmRfY291
bnQgKyBiIC0gY29udHJvbC0+cmFzX2ZyaSkNCj4gKyAgICAgICAgICAgICAgICUgY29udHJvbC0+
cmFzX21heF9yZWNvcmRfY291bnQ7DQo+ICtPdXQ6DQo+ICsgICAgICAga2ZyZWUoYnVmKTsNCj4g
KyAgICAgICByZXR1cm4gcmVzOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IHJhc19lZXByb21f
dXBkYXRlX2hlYWRlcihzdHJ1Y3QgcmFzX2VlcHJvbV9jb250cm9sICpjb250cm9sKQ0KPiArew0K
PiArICAgICAgIHN0cnVjdCByYXNfY29yZV9jb250ZXh0ICpyYXNfY29yZSA9IHRvX3Jhc19jb3Jl
X2NvbnRleHQoY29udHJvbCk7DQo+ICsgICAgICAgaW50IHRocmVzaG9sZF9jb25maWcgPSBjb250
cm9sLT5yZWNvcmRfdGhyZXNob2xkX2NvbmZpZzsNCj4gKyAgICAgICB1OCAqYnVmLCAqcHAsIGNz
dW07DQo+ICsgICAgICAgdTMyIGJ1Zl9zaXplOw0KPiArICAgICAgIGludCBiYWRfcGFnZV9jb3Vu
dDsNCj4gKyAgICAgICBpbnQgcmVzOw0KPiArDQo+ICsgICAgICAgYmFkX3BhZ2VfY291bnQgPSBy
YXNfdW1jX2dldF9iYWRwYWdlX2NvdW50KHJhc19jb3JlKTsNCj4gKyAgICAgICAvKiBNb2RpZnkg
dGhlIGhlYWRlciBpZiBpdCBleGNlZWRzLg0KPiArICAgICAgICAqLw0KPiArICAgICAgIGlmICh0
aHJlc2hvbGRfY29uZmlnICE9IDAgJiYNCj4gKyAgICAgICAgICAgICAgIGJhZF9wYWdlX2NvdW50
ID4gY29udHJvbC0+cmVjb3JkX3RocmVzaG9sZF9jb3VudCkgew0KPiArICAgICAgICAgICAgICAg
UkFTX0RFVl9XQVJOKHJhc19jb3JlLT5kZXYsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICJT
YXZlZCBiYWQgcGFnZXMgJWQgcmVhY2hlcyB0aHJlc2hvbGQgdmFsdWUgJWRcbiIsDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgIGJhZF9wYWdlX2NvdW50LCBjb250cm9sLT5yZWNvcmRfdGhyZXNo
b2xkX2NvdW50KTsNCj4gKyAgICAgICAgICAgICAgIGNvbnRyb2wtPnRibF9oZHIuaGVhZGVyID0g
UkFTX1RBQkxFX0hEUl9CQUQ7DQo+ICsgICAgICAgICAgICAgICBpZiAoY29udHJvbC0+dGJsX2hk
ci52ZXJzaW9uID49IFJBU19UQUJMRV9WRVJfVjJfMSkgew0KPiArICAgICAgICAgICAgICAgICAg
ICAgICBjb250cm9sLT50YmxfcmFpLnJtYV9zdGF0dXMgPSBSQVNfR1BVX1JFVElSRURfX0VDQ19S
RUFDSF9USFJFU0hPTEQ7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wtPnRibF9y
YWkuaGVhbHRoX3BlcmNlbnQgPSAwOw0KPiArICAgICAgICAgICAgICAgfQ0KPiArDQo+ICsgICAg
ICAgICAgICAgICBpZiAoKHRocmVzaG9sZF9jb25maWcgIT0gV0FSTl9OT05TVE9QX09WRVJfVEhS
RVNIT0xEKSAmJg0KPiArICAgICAgICAgICAgICAgICAgICAgICAodGhyZXNob2xkX2NvbmZpZyAh
PSBOT05TVE9QX09WRVJfVEhSRVNIT0xEKSkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmFz
X2NvcmUtPmlzX3JtYSA9IHRydWU7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIC8qIGlnbm9yZSB0
aGUgLUVOT1RTVVBQIHJldHVybiB2YWx1ZSAqLw0KPiArICAgICAgICAgICAgICAgcmFzX2NvcmVf
ZXZlbnRfbm90aWZ5KHJhc19jb3JlLCBSQVNfRVZFTlRfSURfX0RFVklDRV9STUEsIE5VTEwpOw0K
PiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIGlmIChjb250cm9sLT50YmxfaGRyLnZlcnNpb24g
Pj0gUkFTX1RBQkxFX1ZFUl9WMl8xKQ0KPiArICAgICAgICAgICAgICAgY29udHJvbC0+dGJsX2hk
ci50Ymxfc2l6ZSA9IFJBU19UQUJMRV9IRUFERVJfU0laRSArDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgUkFTX1RBQkxFX1YyXzFfSU5GT19TSVpFICsNCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLT5yYXNf
bnVtX3JlY3MgKiBSQVNfVEFCTEVfUkVDT1JEX1NJWkU7DQo+ICsgICAgICAgZWxzZQ0KPiArICAg
ICAgICAgICAgICAgY29udHJvbC0+dGJsX2hkci50Ymxfc2l6ZSA9IFJBU19UQUJMRV9IRUFERVJf
U0laRSArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29u
dHJvbC0+cmFzX251bV9yZWNzICogUkFTX1RBQkxFX1JFQ09SRF9TSVpFOw0KPiArICAgICAgIGNv
bnRyb2wtPnRibF9oZHIuY2hlY2tzdW0gPSAwOw0KPiArDQo+ICsgICAgICAgYnVmX3NpemUgPSBj
b250cm9sLT5yYXNfbnVtX3JlY3MgKiBSQVNfVEFCTEVfUkVDT1JEX1NJWkU7DQo+ICsgICAgICAg
YnVmID0ga2NhbGxvYyhjb250cm9sLT5yYXNfbnVtX3JlY3MsIFJBU19UQUJMRV9SRUNPUkRfU0la
RSwgR0ZQX0tFUk5FTCk7DQo+ICsgICAgICAgaWYgKCFidWYpIHsNCj4gKyAgICAgICAgICAgICAg
IFJBU19ERVZfRVJSKHJhc19jb3JlLT5kZXYsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICJh
bGxvY2F0aW5nIG1lbW9yeSBmb3IgdGFibGUgb2Ygc2l6ZSAlZCBieXRlcyBmYWlsZWRcbiIsDQo+
ICsgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wtPnRibF9oZHIudGJsX3NpemUpOw0KPiAr
ICAgICAgICAgICAgICAgcmVzID0gLUVOT01FTTsNCj4gKyAgICAgICAgICAgICAgIGdvdG8gT3V0
Ow0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIHJlcyA9IF9fZWVwcm9tX3JlYWQocmFzX2Nv
cmUsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wtPmkyY19hZGRyZXNz
ICsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC0+cmFzX3JlY29yZF9v
ZmZzZXQsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZiwgYnVmX3NpemUpOw0K
PiArICAgICAgIGlmIChyZXMgPCAwKSB7DQo+ICsgICAgICAgICAgICAgICBSQVNfREVWX0VSUihy
YXNfY29yZS0+ZGV2LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAiRUVQUk9NIGZhaWxlZCBy
ZWFkaW5nIHJlY29yZHM6JWRcbiIsIHJlcyk7DQo+ICsgICAgICAgICAgICAgICBnb3RvIE91dDsN
Cj4gKyAgICAgICB9IGVsc2UgaWYgKHJlcyA8IGJ1Zl9zaXplKSB7DQo+ICsgICAgICAgICAgICAg
ICBSQVNfREVWX0VSUihyYXNfY29yZS0+ZGV2LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAi
RUVQUk9NIHJlYWQgJWQgb3V0IG9mICVkIGJ5dGVzXG4iLCByZXMsIGJ1Zl9zaXplKTsNCj4gKyAg
ICAgICAgICAgICAgIHJlcyA9IC1FSU87DQo+ICsgICAgICAgICAgICAgICBnb3RvIE91dDsNCj4g
KyAgICAgICB9DQo+ICsNCj4gKyAgICAgICAvKioNCj4gKyAgICAgICAgKiBiYWQgcGFnZSByZWNv
cmRzIGhhdmUgYmVlbiBzdG9yZWQgaW4gZWVwcm9tLA0KPiArICAgICAgICAqIG5vdyBjYWxjdWxh
dGUgZ3B1IGhlYWx0aCBwZXJjZW50DQo+ICsgICAgICAgICovDQo+ICsgICAgICAgaWYgKHRocmVz
aG9sZF9jb25maWcgIT0gMCAmJg0KPiArICAgICAgICAgICBjb250cm9sLT50YmxfaGRyLnZlcnNp
b24gPj0gUkFTX1RBQkxFX1ZFUl9WMl8xICYmDQo+ICsgICAgICAgICAgIGJhZF9wYWdlX2NvdW50
IDw9IGNvbnRyb2wtPnJlY29yZF90aHJlc2hvbGRfY291bnQpDQo+ICsgICAgICAgICAgICAgICBj
b250cm9sLT50YmxfcmFpLmhlYWx0aF9wZXJjZW50ID0gKChjb250cm9sLT5yZWNvcmRfdGhyZXNo
b2xkX2NvdW50IC0NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgYmFkX3BhZ2VfY291bnQpICog
MTAwKSAvIGNvbnRyb2wtPnJlY29yZF90aHJlc2hvbGRfY291bnQ7DQo+ICsNCj4gKyAgICAgICAv
KiBSZWNhbGMgdGhlIGNoZWNrc3VtLg0KPiArICAgICAgICAqLw0KPiArICAgICAgIGNzdW0gPSAw
Ow0KPiArICAgICAgIGZvciAocHAgPSBidWY7IHBwIDwgYnVmICsgYnVmX3NpemU7IHBwKyspDQo+
ICsgICAgICAgICAgICAgICBjc3VtICs9ICpwcDsNCj4gKw0KPiArICAgICAgIGNzdW0gKz0gX19j
YWxjX2hkcl9ieXRlX3N1bShjb250cm9sKTsNCj4gKyAgICAgICBpZiAoY29udHJvbC0+dGJsX2hk
ci52ZXJzaW9uID49IFJBU19UQUJMRV9WRVJfVjJfMSkNCj4gKyAgICAgICAgICAgICAgIGNzdW0g
Kz0gX19jYWxjX3Jhc19pbmZvX2J5dGVfc3VtKGNvbnRyb2wpOw0KPiArICAgICAgIC8qIGF2b2lk
IHNpZ24gZXh0ZW5zaW9uIHdoZW4gYXNzaWduaW5nIHRvICJjaGVja3N1bSIgKi8NCj4gKyAgICAg
ICBjc3VtID0gLWNzdW07DQo+ICsgICAgICAgY29udHJvbC0+dGJsX2hkci5jaGVja3N1bSA9IGNz
dW07DQo+ICsgICAgICAgcmVzID0gX193cml0ZV90YWJsZV9oZWFkZXIoY29udHJvbCk7DQo+ICsg
ICAgICAgaWYgKCFyZXMgJiYgY29udHJvbC0+dGJsX2hkci52ZXJzaW9uID4gUkFTX1RBQkxFX1ZF
Ul9WMSkNCj4gKyAgICAgICAgICAgICAgIHJlcyA9IF9fd3JpdGVfdGFibGVfcmFzX2luZm8oY29u
dHJvbCk7DQo+ICtPdXQ6DQo+ICsgICAgICAga2ZyZWUoYnVmKTsNCj4gKyAgICAgICByZXR1cm4g
cmVzOw0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIHJhc19jb3JlX2VlcHJvbV9hcHBlbmQgLS0g
YXBwZW5kIHJlY29yZHMgdG8gdGhlIEVFUFJPTSBSQVMgdGFibGUNCj4gKyAqIEBjb250cm9sOiBw
b2ludGVyIHRvIGNvbnRyb2wgc3RydWN0dXJlDQo+ICsgKiBAcmVjb3JkOiBhcnJheSBvZiByZWNv
cmRzIHRvIGFwcGVuZA0KPiArICogQG51bTogbnVtYmVyIG9mIHJlY29yZHMgaW4gQHJlY29yZCBh
cnJheQ0KPiArICoNCj4gKyAqIEFwcGVuZCBAbnVtIHJlY29yZHMgdG8gdGhlIHRhYmxlLCBjYWxj
dWxhdGUgdGhlIGNoZWNrc3VtIGFuZCB3cml0ZQ0KPiArICogdGhlIHRhYmxlIGJhY2sgdG8gRUVQ
Uk9NLiBUaGUgbWF4aW11bSBudW1iZXIgb2YgcmVjb3JkcyB0aGF0DQo+ICsgKiBjYW4gYmUgYXBw
ZW5kZWQgaXMgYmV0d2VlbiAxIGFuZCBjb250cm9sLT5yYXNfbWF4X3JlY29yZF9jb3VudCwNCj4g
KyAqIHJlZ2FyZGxlc3Mgb2YgaG93IG1hbnkgcmVjb3JkcyBhcmUgYWxyZWFkeSBzdG9yZWQgaW4g
dGhlIHRhYmxlLg0KPiArICoNCj4gKyAqIFJldHVybiAwIG9uIHN1Y2Nlc3Mgb3IgaWYgRUVQUk9N
IGlzIG5vdCBzdXBwb3J0ZWQsIC1lcnJubyBvbiBlcnJvci4NCj4gKyAqLw0KPiAraW50IHJhc19l
ZXByb21fYXBwZW5kKHN0cnVjdCByYXNfY29yZV9jb250ZXh0ICpyYXNfY29yZSwNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGVlcHJvbV91bWNfcmVjb3JkICpyZWNvcmQsIGNv
bnN0IHUzMiBudW0pDQo+ICt7DQo+ICsgICAgICAgc3RydWN0IHJhc19lZXByb21fY29udHJvbCAq
Y29udHJvbCA9ICZyYXNfY29yZS0+cmFzX2VlcHJvbTsNCj4gKyAgICAgICBpbnQgcmVzOw0KPiAr
DQo+ICsgICAgICAgaWYgKCFfX2lzX3Jhc19lZXByb21fc3VwcG9ydGVkKHJhc19jb3JlKSkNCj4g
KyAgICAgICAgICAgICAgIHJldHVybiAwOw0KPiArDQo+ICsgICAgICAgaWYgKG51bSA9PSAwKSB7
DQo+ICsgICAgICAgICAgICAgICBSQVNfREVWX0VSUihyYXNfY29yZS0+ZGV2LCAid2lsbCBub3Qg
YXBwZW5kIDAgcmVjb3Jkc1xuIik7DQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsN
Cj4gKyAgICAgICB9IGVsc2UgaWYgKChudW0gKyBjb250cm9sLT5yYXNfbnVtX3JlY3MpID4gY29u
dHJvbC0+cmFzX21heF9yZWNvcmRfY291bnQpIHsNCj4gKyAgICAgICAgICAgICAgIFJBU19ERVZf
RVJSKHJhc19jb3JlLT5kZXYsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICJjYW5ub3QgYXBw
ZW5kICVkIHJlY29yZHMgdGhhbiB0aGUgc2l6ZSBvZiB0YWJsZSAlZFxuIiwNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgbnVtLCBjb250cm9sLT5yYXNfbWF4X3JlY29yZF9jb3VudCk7DQo+ICsg
ICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAg
ICBtdXRleF9sb2NrKCZjb250cm9sLT5yYXNfdGJsX211dGV4KTsNCj4gKyAgICAgICByZXMgPSBy
YXNfZWVwcm9tX2FwcGVuZF90YWJsZShjb250cm9sLCByZWNvcmQsIG51bSk7DQo+ICsgICAgICAg
aWYgKCFyZXMpDQo+ICsgICAgICAgICAgICAgICByZXMgPSByYXNfZWVwcm9tX3VwZGF0ZV9oZWFk
ZXIoY29udHJvbCk7DQo+ICsNCj4gKyAgICAgICBtdXRleF91bmxvY2soJmNvbnRyb2wtPnJhc190
YmxfbXV0ZXgpOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIHJlczsNCj4gK30NCj4gKw0KPiArLyoq
DQo+ICsgKiBfX3Jhc19lZXByb21fcmVhZCAtLSByZWFkIGluZGV4ZWQgZnJvbSBFRVBST00gaW50
byBidWZmZXINCj4gKyAqIEBjb250cm9sOiBwb2ludGVyIHRvIGNvbnRyb2wgc3RydWN0dXJlDQo+
ICsgKiBAYnVmOiBwb2ludGVyIHRvIGJ1ZmZlciB0byByZWFkIGludG8NCj4gKyAqIEBmcmk6IGZp
cnN0IHJlY29yZCBpbmRleCwgc3RhcnQgcmVhZGluZyBhdCB0aGlzIGluZGV4LCBhYnNvbHV0ZSBp
bmRleA0KPiArICogQG51bTogbnVtYmVyIG9mIHJlY29yZHMgdG8gcmVhZA0KPiArICoNCj4gKyAq
IFRoZSBjYWxsZXIgbXVzdCBob2xkIHRoZSB0YWJsZSBtdXRleCBpbiBAY29udHJvbC4NCj4gKyAq
IFJldHVybiAwIG9uIHN1Y2Nlc3MsIC1lcnJubyBvdGhlcndpc2UuDQo+ICsgKi8NCj4gK3N0YXRp
YyBpbnQgX19yYXNfZWVwcm9tX3JlYWQoc3RydWN0IHJhc19lZXByb21fY29udHJvbCAqY29udHJv
bCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICB1OCAqYnVmLCBjb25zdCB1MzIgZnJp
LCBjb25zdCB1MzIgbnVtKQ0KPiArew0KPiArICAgICAgIHN0cnVjdCByYXNfY29yZV9jb250ZXh0
ICpyYXNfY29yZSA9IHRvX3Jhc19jb3JlX2NvbnRleHQoY29udHJvbCk7DQo+ICsgICAgICAgdTMy
IGJ1Zl9zaXplOw0KPiArICAgICAgIGludCByZXM7DQo+ICsNCj4gKyAgICAgICAvKiBpMmMgbWF5
IGJlIHVuc3RhYmxlIGluIGdwdSByZXNldCAqLw0KPiArICAgICAgIGJ1Zl9zaXplID0gbnVtICog
UkFTX1RBQkxFX1JFQ09SRF9TSVpFOw0KPiArICAgICAgIHJlcyA9IF9fZWVwcm9tX3JlYWQocmFz
X2NvcmUsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wtPmkyY19hZGRy
ZXNzICsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkFTX0lOREVYX1RPX09GRlNF
VChjb250cm9sLCBmcmkpLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWYsIGJ1
Zl9zaXplKTsNCj4gKyAgICAgICBpZiAocmVzIDwgMCkgew0KPiArICAgICAgICAgICAgICAgUkFT
X0RFVl9FUlIocmFzX2NvcmUtPmRldiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIlJlYWRp
bmcgJWQgRUVQUk9NIHRhYmxlIHJlY29yZHMgZXJyb3I6JWRcbiIsIG51bSwgcmVzKTsNCj4gKyAg
ICAgICB9IGVsc2UgaWYgKHJlcyA8IGJ1Zl9zaXplKSB7DQo+ICsgICAgICAgICAgICAgICAvKiBT
aG9ydCByZWFkLCByZXR1cm4gZXJyb3IuDQo+ICsgICAgICAgICAgICAgICAgKi8NCj4gKyAgICAg
ICAgICAgICAgIFJBU19ERVZfRVJSKHJhc19jb3JlLT5kZXYsDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICJSZWFkICVkIHJlY29yZHMgb3V0IG9mICVkXG4iLA0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAocmVzL1JBU19UQUJMRV9SRUNPUkRfU0laRSksIG51bSk7DQo+ICsgICAgICAgICAg
ICAgICByZXMgPSAtRUlPOw0KPiArICAgICAgIH0gZWxzZSB7DQo+ICsgICAgICAgICAgICAgICBy
ZXMgPSAwOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIHJldHVybiByZXM7DQo+ICt9DQo+
ICsNCj4gKy8qKg0KPiArICogcmFzX2VlcHJvbV9yZWFkIC0tIHJlYWQgRUVQUk9NDQo+ICsgKiBA
Y29udHJvbDogcG9pbnRlciB0byBjb250cm9sIHN0cnVjdHVyZQ0KPiArICogQHJlY29yZDogYXJy
YXkgb2YgcmVjb3JkcyB0byByZWFkIGludG8NCj4gKyAqIEBudW06IG51bWJlciBvZiByZWNvcmRz
IGluIEByZWNvcmQNCj4gKyAqDQo+ICsgKiBSZWFkcyBudW0gcmVjb3JkcyBmcm9tIHRoZSBSQVMg
dGFibGUgaW4gRUVQUk9NIGFuZA0KPiArICogd3JpdGVzIHRoZSBkYXRhIGludG8gQHJlY29yZCBh
cnJheS4NCj4gKyAqDQo+ICsgKiBSZXR1cm5zIDAgb24gc3VjY2VzcywgLWVycm5vIG9uIGVycm9y
Lg0KPiArICovDQo+ICtpbnQgcmFzX2VlcHJvbV9yZWFkKHN0cnVjdCByYXNfY29yZV9jb250ZXh0
ICpyYXNfY29yZSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBlZXByb21fdW1j
X3JlY29yZCAqcmVjb3JkLCBjb25zdCB1MzIgbnVtKQ0KPiArew0KPiArICAgICAgIHN0cnVjdCBy
YXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2wgPSAmcmFzX2NvcmUtPnJhc19lZXByb207DQo+ICsg
ICAgICAgaW50IGksIHJlczsNCj4gKyAgICAgICB1OCAqYnVmLCAqcHA7DQo+ICsgICAgICAgdTMy
IGcwLCBnMTsNCj4gKw0KPiArICAgICAgIGlmICghX19pc19yYXNfZWVwcm9tX3N1cHBvcnRlZChy
YXNfY29yZSkpDQo+ICsgICAgICAgICAgICAgICByZXR1cm4gMDsNCj4gKw0KPiArICAgICAgIGlm
IChudW0gPT0gMCkgew0KPiArICAgICAgICAgICAgICAgUkFTX0RFVl9FUlIocmFzX2NvcmUtPmRl
diwgIndpbGwgbm90IHJlYWQgMCByZWNvcmRzXG4iKTsNCj4gKyAgICAgICAgICAgICAgIHJldHVy
biAtRUlOVkFMOw0KPiArICAgICAgIH0gZWxzZSBpZiAobnVtID4gY29udHJvbC0+cmFzX251bV9y
ZWNzKSB7DQo+ICsgICAgICAgICAgICAgICBSQVNfREVWX0VSUihyYXNfY29yZS0+ZGV2LA0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAidG9vIG1hbnkgcmVjb3JkcyB0byByZWFkOiVkIGF2YWls
YWJsZTolZFxuIiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgbnVtLCBjb250cm9sLT5yYXNf
bnVtX3JlY3MpOw0KPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ICsgICAgICAg
fQ0KPiArDQo+ICsgICAgICAgYnVmID0ga2NhbGxvYyhudW0sIFJBU19UQUJMRV9SRUNPUkRfU0la
RSwgR0ZQX0tFUk5FTCk7DQo+ICsgICAgICAgaWYgKCFidWYpDQo+ICsgICAgICAgICAgICAgICBy
ZXR1cm4gLUVOT01FTTsNCj4gKw0KPiArICAgICAgIC8qIERldGVybWluZSBob3cgbWFueSByZWNv
cmRzIHRvIHJlYWQsIGZyb20gdGhlIGZpcnN0IHJlY29yZA0KPiArICAgICAgICAqIGluZGV4LCBm
cmksIHRvIHRoZSBlbmQgb2YgdGhlIHRhYmxlLCBhbmQgZnJvbSB0aGUgYmVnaW5uaW5nDQo+ICsg
ICAgICAgICogb2YgdGhlIHRhYmxlLCBzdWNoIHRoYXQgdGhlIHRvdGFsIG51bWJlciBvZiByZWNv
cmRzIGlzDQo+ICsgICAgICAgICogQG51bSwgYW5kIHdlIGhhbmRsZSB3cmFwIGFyb3VuZCB3aGVu
IGZyaSA+IDAgYW5kDQo+ICsgICAgICAgICogZnJpICsgbnVtID4gUkFTX01BWF9SRUNPUkRfQ09V
TlQuDQo+ICsgICAgICAgICoNCj4gKyAgICAgICAgKiBGaXJzdCB3ZSBjb21wdXRlIHRoZSBpbmRl
eCBvZiB0aGUgbGFzdCBlbGVtZW50DQo+ICsgICAgICAgICogd2hpY2ggd291bGQgYmUgZmV0Y2hl
ZCBmcm9tIGVhY2ggcmVnaW9uLA0KPiArICAgICAgICAqIGcwIGlzIGluIFtmcmksIGZyaSArIG51
bSAtIDFdLCBhbmQNCj4gKyAgICAgICAgKiBnMSBpcyBpbiBbMCwgUkFTX01BWF9SRUNPUkRfQ09V
TlQgLSAxXS4NCj4gKyAgICAgICAgKiBUaGVuLCBpZiBnMCA8IFJBU19NQVhfUkVDT1JEX0NPVU5U
LCB0aGUgaW5kZXggb2YNCj4gKyAgICAgICAgKiB0aGUgbGFzdCBlbGVtZW50IHRvIGZldGNoLCB3
ZSBzZXQgZzAgdG8gX3RoZSBudW1iZXJfDQo+ICsgICAgICAgICogb2YgZWxlbWVudHMgdG8gZmV0
Y2gsIEBudW0sIHNpbmNlIHdlIGtub3cgdGhhdCB0aGUgbGFzdA0KPiArICAgICAgICAqIGluZGV4
ZWQgdG8gYmUgZmV0Y2hlZCBkb2VzIG5vdCBleGNlZWQgdGhlIHRhYmxlLg0KPiArICAgICAgICAq
DQo+ICsgICAgICAgICogSWYsIGhvd2V2ZXIsIGcwID49IFJBU19NQVhfUkVDT1JEX0NPVU5ULCB0
aGVuDQo+ICsgICAgICAgICogd2Ugc2V0IGcwIHRvIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8g
cmVhZA0KPiArICAgICAgICAqIHVudGlsIHRoZSBlbmQgb2YgdGhlIHRhYmxlLCBhbmQgZzEgdG8g
dGhlIG51bWJlciBvZg0KPiArICAgICAgICAqIGVsZW1lbnRzIHRvIHJlYWQgZnJvbSB0aGUgYmVn
aW5uaW5nIG9mIHRoZSB0YWJsZS4NCj4gKyAgICAgICAgKi8NCj4gKyAgICAgICBnMCA9IGNvbnRy
b2wtPnJhc19mcmkgKyBudW0gLSAxOw0KPiArICAgICAgIGcxID0gZzAgJSBjb250cm9sLT5yYXNf
bWF4X3JlY29yZF9jb3VudDsNCj4gKyAgICAgICBpZiAoZzAgPCBjb250cm9sLT5yYXNfbWF4X3Jl
Y29yZF9jb3VudCkgew0KPiArICAgICAgICAgICAgICAgZzAgPSBudW07DQo+ICsgICAgICAgICAg
ICAgICBnMSA9IDA7DQo+ICsgICAgICAgfSBlbHNlIHsNCj4gKyAgICAgICAgICAgICAgIGcwID0g
Y29udHJvbC0+cmFzX21heF9yZWNvcmRfY291bnQgLSBjb250cm9sLT5yYXNfZnJpOw0KPiArICAg
ICAgICAgICAgICAgZzEgKz0gMTsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICBtdXRleF9s
b2NrKCZjb250cm9sLT5yYXNfdGJsX211dGV4KTsNCj4gKyAgICAgICByZXMgPSBfX3Jhc19lZXBy
b21fcmVhZChjb250cm9sLCBidWYsIGNvbnRyb2wtPnJhc19mcmksIGcwKTsNCj4gKyAgICAgICBp
ZiAocmVzKQ0KPiArICAgICAgICAgICAgICAgZ290byBPdXQ7DQo+ICsgICAgICAgaWYgKGcxKSB7
DQo+ICsgICAgICAgICAgICAgICByZXMgPSBfX3Jhc19lZXByb21fcmVhZChjb250cm9sLA0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmICsgZzAgKiBSQVNfVEFC
TEVfUkVDT1JEX1NJWkUsIDAsIGcxKTsNCj4gKyAgICAgICAgICAgICAgIGlmIChyZXMpDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGdvdG8gT3V0Ow0KPiArICAgICAgIH0NCj4gKw0KPiArICAg
ICAgIHJlcyA9IDA7DQo+ICsNCj4gKyAgICAgICAvKiBSZWFkIHVwIGV2ZXJ5dGhpbmc/IFRoZW4g
dHJhbnNmb3JtLg0KPiArICAgICAgICAqLw0KPiArICAgICAgIHBwID0gYnVmOw0KPiArICAgICAg
IGZvciAoaSA9IDA7IGkgPCBudW07IGkrKywgcHAgKz0gUkFTX1RBQkxFX1JFQ09SRF9TSVpFKSB7
DQo+ICsgICAgICAgICAgICAgICBfX2RlY29kZV90YWJsZV9yZWNvcmRfZnJvbV9idWYoY29udHJv
bCwgJnJlY29yZFtpXSwgcHApOw0KPiArDQo+ICsgICAgICAgICAgICAgICAvKiB1cGRhdGUgYmFk
IGNoYW5uZWwgYml0bWFwICovDQo+ICsgICAgICAgICAgICAgICBpZiAoKHJlY29yZFtpXS5tZW1f
Y2hhbm5lbCA8IEJJVFNfUEVSX1RZUEUoY29udHJvbC0+YmFkX2NoYW5uZWxfYml0bWFwKSkgJiYN
Cj4gKyAgICAgICAgICAgICAgICAgICAhKGNvbnRyb2wtPmJhZF9jaGFubmVsX2JpdG1hcCAmICgx
IDw8IHJlY29yZFtpXS5tZW1fY2hhbm5lbCkpKSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IGNvbnRyb2wtPmJhZF9jaGFubmVsX2JpdG1hcCB8PSAxIDw8IHJlY29yZFtpXS5tZW1fY2hhbm5l
bDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC0+dXBkYXRlX2NoYW5uZWxfZmxh
ZyA9IHRydWU7DQo+ICsgICAgICAgICAgICAgICB9DQo+ICsgICAgICAgfQ0KPiArT3V0Og0KPiAr
ICAgICAgIGtmcmVlKGJ1Zik7DQo+ICsgICAgICAgbXV0ZXhfdW5sb2NrKCZjb250cm9sLT5yYXNf
dGJsX211dGV4KTsNCj4gKw0KPiArICAgICAgIHJldHVybiByZXM7DQo+ICt9DQo+ICsNCj4gK3Vp
bnQzMl90IHJhc19lZXByb21fbWF4X3JlY29yZF9jb3VudChzdHJ1Y3QgcmFzX2NvcmVfY29udGV4
dCAqcmFzX2NvcmUpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0IHJhc19lZXByb21fY29udHJvbCAq
Y29udHJvbCA9ICZyYXNfY29yZS0+cmFzX2VlcHJvbTsNCj4gKw0KPiArICAgICAgIC8qIGdldCBh
dmFpbGFibGUgZWVwcm9tIHRhYmxlIHZlcnNpb24gZmlyc3QgYmVmb3JlIGVlcHJvbSB0YWJsZSBp
bml0ICovDQo+ICsgICAgICAgcmFzX3NldF9lZXByb21fdGFibGVfdmVyc2lvbihjb250cm9sKTsN
Cj4gKw0KPiArICAgICAgIGlmIChjb250cm9sLT50YmxfaGRyLnZlcnNpb24gPj0gUkFTX1RBQkxF
X1ZFUl9WMl8xKQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIFJBU19NQVhfUkVDT1JEX0NPVU5U
X1YyXzE7DQo+ICsgICAgICAgZWxzZQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIFJBU19NQVhf
UkVDT1JEX0NPVU5UOw0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIF9fdmVyaWZ5X3Jhc190YWJs
ZV9jaGVja3N1bSAtLSB2ZXJpZnkgdGhlIFJBUyBFRVBST00gdGFibGUgY2hlY2tzdW0NCj4gKyAq
IEBjb250cm9sOiBwb2ludGVyIHRvIGNvbnRyb2wgc3RydWN0dXJlDQo+ICsgKg0KPiArICogQ2hl
Y2sgdGhlIGNoZWNrc3VtIG9mIHRoZSBzdG9yZWQgaW4gRUVQUk9NIFJBUyB0YWJsZS4NCj4gKyAq
DQo+ICsgKiBSZXR1cm4gMCBpZiB0aGUgY2hlY2tzdW0gaXMgY29ycmVjdCwNCj4gKyAqIHBvc2l0
aXZlIGlmIGl0IGlzIG5vdCBjb3JyZWN0LCBhbmQNCj4gKyAqIC1lcnJubyBvbiBJL08gZXJyb3Iu
DQo+ICsgKi8NCj4gK3N0YXRpYyBpbnQgX192ZXJpZnlfcmFzX3RhYmxlX2NoZWNrc3VtKHN0cnVj
dCByYXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2wpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0IHJh
c19jb3JlX2NvbnRleHQgKnJhc19jb3JlID0gdG9fcmFzX2NvcmVfY29udGV4dChjb250cm9sKTsN
Cj4gKyAgICAgICBpbnQgYnVmX3NpemUsIHJlczsNCj4gKyAgICAgICB1OCAgY3N1bSwgKmJ1Ziwg
KnBwOw0KPiArDQo+ICsgICAgICAgaWYgKGNvbnRyb2wtPnRibF9oZHIudmVyc2lvbiA+PSBSQVNf
VEFCTEVfVkVSX1YyXzEpDQo+ICsgICAgICAgICAgICAgICBidWZfc2l6ZSA9IFJBU19UQUJMRV9I
RUFERVJfU0laRSArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIFJBU19UQUJMRV9WMl8x
X0lORk9fU0laRSArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wtPnJhc19u
dW1fcmVjcyAqIFJBU19UQUJMRV9SRUNPUkRfU0laRTsNCj4gKyAgICAgICBlbHNlDQo+ICsgICAg
ICAgICAgICAgICBidWZfc2l6ZSA9IFJBU19UQUJMRV9IRUFERVJfU0laRSArDQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbnRyb2wtPnJhc19udW1fcmVjcyAqIFJBU19UQUJMRV9SRUNP
UkRfU0laRTsNCj4gKw0KPiArICAgICAgIGJ1ZiA9IGt6YWxsb2MoYnVmX3NpemUsIEdGUF9LRVJO
RUwpOw0KPiArICAgICAgIGlmICghYnVmKSB7DQo+ICsgICAgICAgICAgICAgICBSQVNfREVWX0VS
UihyYXNfY29yZS0+ZGV2LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAiT3V0IG9mIG1lbW9y
eSBjaGVja2luZyBSQVMgdGFibGUgY2hlY2tzdW0uXG4iKTsNCj4gKyAgICAgICAgICAgICAgIHJl
dHVybiAtRU5PTUVNOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIHJlcyA9IF9fZWVwcm9t
X3JlYWQocmFzX2NvcmUsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRy
b2wtPmkyY19hZGRyZXNzICsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29u
dHJvbC0+cmFzX2hlYWRlcl9vZmZzZXQsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGJ1ZiwgYnVmX3NpemUpOw0KPiArICAgICAgIGlmIChyZXMgPCBidWZfc2l6ZSkgew0KPiAr
ICAgICAgICAgICAgICAgUkFTX0RFVl9FUlIocmFzX2NvcmUtPmRldiwNCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgIlBhcnRpYWwgcmVhZCBmb3IgY2hlY2tzdW0sIHJlczolZFxuIiwgcmVzKTsN
Cj4gKyAgICAgICAgICAgICAgIC8qIE9uIHBhcnRpYWwgcmVhZHMsIHJldHVybiAtRUlPLg0KPiAr
ICAgICAgICAgICAgICAgICovDQo+ICsgICAgICAgICAgICAgICBpZiAocmVzID49IDApDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IC1FSU87DQo+ICsgICAgICAgICAgICAgICBnb3Rv
IE91dDsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICBjc3VtID0gMDsNCj4gKyAgICAgICBm
b3IgKHBwID0gYnVmOyBwcCA8IGJ1ZiArIGJ1Zl9zaXplOyBwcCsrKQ0KPiArICAgICAgICAgICAg
ICAgY3N1bSArPSAqcHA7DQo+ICtPdXQ6DQo+ICsgICAgICAga2ZyZWUoYnVmKTsNCj4gKyAgICAg
ICByZXR1cm4gcmVzIDwgMCA/IHJlcyA6IGNzdW07DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQg
X19yZWFkX3RhYmxlX3Jhc19pbmZvKHN0cnVjdCByYXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2wp
DQo+ICt7DQo+ICsgICAgICAgc3RydWN0IHJhc19lZXByb21fdGFibGVfcmFzX2luZm8gKnJhaSA9
ICZjb250cm9sLT50YmxfcmFpOw0KPiArICAgICAgIHN0cnVjdCByYXNfY29yZV9jb250ZXh0ICpy
YXNfY29yZSA9IHRvX3Jhc19jb3JlX2NvbnRleHQoY29udHJvbCk7DQo+ICsgICAgICAgdW5zaWdu
ZWQgY2hhciAqYnVmOw0KPiArICAgICAgIGludCByZXM7DQo+ICsNCj4gKyAgICAgICBidWYgPSBr
emFsbG9jKFJBU19UQUJMRV9WMl8xX0lORk9fU0laRSwgR0ZQX0tFUk5FTCk7DQo+ICsgICAgICAg
aWYgKCFidWYpIHsNCj4gKyAgICAgICAgICAgICAgIFJBU19ERVZfRVJSKHJhc19jb3JlLT5kZXYs
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICJGYWlsZWQgdG8gYWxsb2MgYnVmIHRvIHJlYWQg
RUVQUk9NIHRhYmxlIHJhcyBpbmZvXG4iKTsNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5P
TUVNOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIC8qKg0KPiArICAgICAgICAqIEVFUFJP
TSB0YWJsZSBWMl8xIHN1cHBvcnRzIHJhcyBpbmZvLA0KPiArICAgICAgICAqIHJlYWQgRUVQUk9N
IHRhYmxlIHJhcyBpbmZvDQo+ICsgICAgICAgICovDQo+ICsgICAgICAgcmVzID0gX19lZXByb21f
cmVhZChyYXNfY29yZSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC0+
aTJjX2FkZHJlc3MgKyBjb250cm9sLT5yYXNfaW5mb19vZmZzZXQsDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJ1ZiwgUkFTX1RBQkxFX1YyXzFfSU5GT19TSVpFKTsNCj4gKyAgICAg
ICBpZiAocmVzIDwgUkFTX1RBQkxFX1YyXzFfSU5GT19TSVpFKSB7DQo+ICsgICAgICAgICAgICAg
ICBSQVNfREVWX0VSUihyYXNfY29yZS0+ZGV2LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAi
RmFpbGVkIHRvIHJlYWQgRUVQUk9NIHRhYmxlIHJhcyBpbmZvLCByZXM6JWRcbiIsIHJlcyk7DQo+
ICsgICAgICAgICAgICAgICByZXMgPSByZXMgPj0gMCA/IC1FSU8gOiByZXM7DQo+ICsgICAgICAg
ICAgICAgICBnb3RvIE91dDsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICBfX2RlY29kZV90
YWJsZV9yYXNfaW5mb19mcm9tX2J1ZihyYWksIGJ1Zik7DQo+ICsNCj4gK091dDoNCj4gKyAgICAg
ICBrZnJlZShidWYpOw0KPiArICAgICAgIHJldHVybiByZXMgPT0gUkFTX1RBQkxFX1YyXzFfSU5G
T19TSVpFID8gMCA6IHJlczsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBfX2NoZWNrX3Jhc190
YWJsZV9zdGF0dXMoc3RydWN0IHJhc19jb3JlX2NvbnRleHQgKnJhc19jb3JlKQ0KPiArew0KPiAr
ICAgICAgIHN0cnVjdCByYXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2wgPSAmcmFzX2NvcmUtPnJh
c19lZXByb207DQo+ICsgICAgICAgdW5zaWduZWQgY2hhciBidWZbUkFTX1RBQkxFX0hFQURFUl9T
SVpFXSA9IHsgMCB9Ow0KPiArICAgICAgIHN0cnVjdCByYXNfZWVwcm9tX3RhYmxlX2hlYWRlciAq
aGRyOw0KPiArICAgICAgIGludCByZXM7DQo+ICsNCj4gKyAgICAgICBoZHIgPSAmY29udHJvbC0+
dGJsX2hkcjsNCj4gKw0KPiArICAgICAgIGlmICghX19pc19yYXNfZWVwcm9tX3N1cHBvcnRlZChy
YXNfY29yZSkpDQo+ICsgICAgICAgICAgICAgICByZXR1cm4gMDsNCj4gKw0KPiArICAgICAgIGlm
ICghX19nZXRfZWVwcm9tX2kyY19hZGRyKHJhc19jb3JlLCBjb250cm9sKSkNCj4gKyAgICAgICAg
ICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsgICAgICAgY29udHJvbC0+cmFzX2hlYWRl
cl9vZmZzZXQgPSBSQVNfSERSX1NUQVJUOw0KPiArICAgICAgIGNvbnRyb2wtPnJhc19pbmZvX29m
ZnNldCA9IFJBU19UQUJMRV9WMl8xX0lORk9fU1RBUlQ7DQo+ICsgICAgICAgbXV0ZXhfaW5pdCgm
Y29udHJvbC0+cmFzX3RibF9tdXRleCk7DQo+ICsNCj4gKyAgICAgICAvKiBSZWFkIHRoZSB0YWJs
ZSBoZWFkZXIgZnJvbSBFRVBST00gYWRkcmVzcyAqLw0KPiArICAgICAgIHJlcyA9IF9fZWVwcm9t
X3JlYWQocmFzX2NvcmUsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wt
PmkyY19hZGRyZXNzICsgY29udHJvbC0+cmFzX2hlYWRlcl9vZmZzZXQsDQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGJ1ZiwgUkFTX1RBQkxFX0hFQURFUl9TSVpFKTsNCj4gKyAgICAg
ICBpZiAocmVzIDwgUkFTX1RBQkxFX0hFQURFUl9TSVpFKSB7DQo+ICsgICAgICAgICAgICAgICBS
QVNfREVWX0VSUihyYXNfY29yZS0+ZGV2LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAiRmFp
bGVkIHRvIHJlYWQgRUVQUk9NIHRhYmxlIGhlYWRlciwgcmVzOiVkXG4iLCByZXMpOw0KPiArICAg
ICAgICAgICAgICAgcmV0dXJuIHJlcyA+PSAwID8gLUVJTyA6IHJlczsNCj4gKyAgICAgICB9DQo+
ICsNCj4gKyAgICAgICBfX2RlY29kZV90YWJsZV9oZWFkZXJfZnJvbV9idWYoaGRyLCBidWYpOw0K
PiArDQo+ICsgICAgICAgaWYgKGhkci0+aGVhZGVyICE9IFJBU19UQUJMRV9IRFJfVkFMICYmDQo+
ICsgICAgICAgICAgIGhkci0+aGVhZGVyICE9IFJBU19UQUJMRV9IRFJfQkFEKSB7DQo+ICsgICAg
ICAgICAgICAgICBSQVNfREVWX0lORk8ocmFzX2NvcmUtPmRldiwgIkNyZWF0aW5nIGEgbmV3IEVF
UFJPTSB0YWJsZSIpOw0KPiArICAgICAgICAgICAgICAgcmV0dXJuIHJhc19lZXByb21fcmVzZXRf
dGFibGUocmFzX2NvcmUpOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIHN3aXRjaCAoaGRy
LT52ZXJzaW9uKSB7DQo+ICsgICAgICAgY2FzZSBSQVNfVEFCTEVfVkVSX1YyXzE6DQo+ICsgICAg
ICAgY2FzZSBSQVNfVEFCTEVfVkVSX1YzOg0KPiArICAgICAgICAgICAgICAgY29udHJvbC0+cmFz
X251bV9yZWNzID0gUkFTX05VTV9SRUNTX1YyXzEoaGRyKTsNCj4gKyAgICAgICAgICAgICAgIGNv
bnRyb2wtPnJhc19yZWNvcmRfb2Zmc2V0ID0gUkFTX1JFQ09SRF9TVEFSVF9WMl8xOw0KPiArICAg
ICAgICAgICAgICAgY29udHJvbC0+cmFzX21heF9yZWNvcmRfY291bnQgPSBSQVNfTUFYX1JFQ09S
RF9DT1VOVF9WMl8xOw0KPiArICAgICAgICAgICAgICAgYnJlYWs7DQo+ICsgICAgICAgY2FzZSBS
QVNfVEFCTEVfVkVSX1YxOg0KPiArICAgICAgICAgICAgICAgY29udHJvbC0+cmFzX251bV9yZWNz
ID0gUkFTX05VTV9SRUNTKGhkcik7DQo+ICsgICAgICAgICAgICAgICBjb250cm9sLT5yYXNfcmVj
b3JkX29mZnNldCA9IFJBU19SRUNPUkRfU1RBUlQ7DQo+ICsgICAgICAgICAgICAgICBjb250cm9s
LT5yYXNfbWF4X3JlY29yZF9jb3VudCA9IFJBU19NQVhfUkVDT1JEX0NPVU5UOw0KPiArICAgICAg
ICAgICAgICAgYnJlYWs7DQo+ICsgICAgICAgZGVmYXVsdDoNCj4gKyAgICAgICAgICAgICAgIFJB
U19ERVZfRVJSKHJhc19jb3JlLT5kZXYsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICJSQVMg
aGVhZGVyIGludmFsaWQsIHVuc3VwcG9ydGVkIHZlcnNpb246ICV1IiwNCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgaGRyLT52ZXJzaW9uKTsNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlO
VkFMOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIGlmIChjb250cm9sLT5yYXNfbnVtX3Jl
Y3MgPiBjb250cm9sLT5yYXNfbWF4X3JlY29yZF9jb3VudCkgew0KPiArICAgICAgICAgICAgICAg
UkFTX0RFVl9FUlIocmFzX2NvcmUtPmRldiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIlJB
UyBoZWFkZXIgaW52YWxpZCwgcmVjb3JkcyBpbiBoZWFkZXI6ICV1IG1heCBhbGxvd2VkIDoldSIs
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wtPnJhc19udW1fcmVjcywgY29udHJv
bC0+cmFzX21heF9yZWNvcmRfY291bnQpOw0KPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5W
QUw7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgY29udHJvbC0+cmFzX2ZyaSA9IFJBU19P
RkZTRVRfVE9fSU5ERVgoY29udHJvbCwgaGRyLT5maXJzdF9yZWNfb2Zmc2V0KTsNCj4gKw0KPiAr
ICAgICAgIHJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtpbnQgcmFzX2VlcHJvbV9jaGVja19zdG9y
YWdlX3N0YXR1cyhzdHJ1Y3QgcmFzX2NvcmVfY29udGV4dCAqcmFzX2NvcmUpDQo+ICt7DQo+ICsg
ICAgICAgc3RydWN0IHJhc19lZXByb21fY29udHJvbCAqY29udHJvbCA9ICZyYXNfY29yZS0+cmFz
X2VlcHJvbTsNCj4gKyAgICAgICBzdHJ1Y3QgcmFzX2VlcHJvbV90YWJsZV9oZWFkZXIgKmhkcjsN
Cj4gKyAgICAgICBpbnQgYmFkX3BhZ2VfY291bnQ7DQo+ICsgICAgICAgaW50IHJlcyA9IDA7DQo+
ICsNCj4gKyAgICAgICBpZiAoIV9faXNfcmFzX2VlcHJvbV9zdXBwb3J0ZWQocmFzX2NvcmUpKQ0K
PiArICAgICAgICAgICAgICAgcmV0dXJuIDA7DQo+ICsNCj4gKyAgICAgICBpZiAoIV9fZ2V0X2Vl
cHJvbV9pMmNfYWRkcihyYXNfY29yZSwgY29udHJvbCkpDQo+ICsgICAgICAgICAgICAgICByZXR1
cm4gLUVJTlZBTDsNCj4gKw0KPiArICAgICAgIGhkciA9ICZjb250cm9sLT50YmxfaGRyOw0KPiAr
DQo+ICsgICAgICAgYmFkX3BhZ2VfY291bnQgPSByYXNfdW1jX2dldF9iYWRwYWdlX2NvdW50KHJh
c19jb3JlKTsNCj4gKyAgICAgICBpZiAoaGRyLT5oZWFkZXIgPT0gUkFTX1RBQkxFX0hEUl9WQUwp
IHsNCj4gKyAgICAgICAgICAgICAgIFJBU19ERVZfSU5GTyhyYXNfY29yZS0+ZGV2LA0KPiArICAg
ICAgICAgICAgICAgICAgICAgICAiRm91bmQgZXhpc3RpbmcgRUVQUk9NIHRhYmxlIHdpdGggJWQg
cmVjb3Jkc1xuIiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgYmFkX3BhZ2VfY291bnQpOw0K
PiArDQo+ICsgICAgICAgICAgICAgICBpZiAoaGRyLT52ZXJzaW9uID49IFJBU19UQUJMRV9WRVJf
VjJfMSkgew0KPiArICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfX3JlYWRfdGFibGVfcmFz
X2luZm8oY29udHJvbCk7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMpDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlczsNCj4gKyAgICAgICAgICAg
ICAgIH0NCj4gKw0KPiArICAgICAgICAgICAgICAgcmVzID0gX192ZXJpZnlfcmFzX3RhYmxlX2No
ZWNrc3VtKGNvbnRyb2wpOw0KPiArICAgICAgICAgICAgICAgaWYgKHJlcykNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgUkFTX0RFVl9FUlIocmFzX2NvcmUtPmRldiwNCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAiUkFTIHRhYmxlIGluY29ycmVjdCBjaGVja3N1bSBvciBlcnJv
cjolZFxuIiwgcmVzKTsNCj4gKw0KPiArICAgICAgICAgICAgICAgLyogV2FybiBpZiB3ZSBhcmUg
YXQgOTAlIG9mIHRoZSB0aHJlc2hvbGQgb3IgYWJvdmUNCj4gKyAgICAgICAgICAgICAgICAqLw0K
PiArICAgICAgICAgICAgICAgaWYgKDEwICogYmFkX3BhZ2VfY291bnQgPj0gOSAqIGNvbnRyb2wt
PnJlY29yZF90aHJlc2hvbGRfY291bnQpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIFJBU19E
RVZfV0FSTihyYXNfY29yZS0+ZGV2LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICJSQVMgcmVjb3JkczoldSBleGNlZWRzIDkwJSUgb2YgdGhyZXNob2xkOiVkXG4iLA0KPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhZF9wYWdlX2NvdW50LA0KPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wtPnJlY29yZF90aHJlc2hvbGRfY291bnQpOw0K
PiArDQo+ICsgICAgICAgfSBlbHNlIGlmIChoZHItPmhlYWRlciA9PSBSQVNfVEFCTEVfSERSX0JB
RCAmJg0KPiArICAgICAgICAgICAgICAgICAgY29udHJvbC0+cmVjb3JkX3RocmVzaG9sZF9jb25m
aWcgIT0gMCkgew0KPiArICAgICAgICAgICAgICAgaWYgKGhkci0+dmVyc2lvbiA+PSBSQVNfVEFC
TEVfVkVSX1YyXzEpIHsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX19yZWFkX3Rh
YmxlX3Jhc19pbmZvKGNvbnRyb2wpOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVz
KQ0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7DQo+ICsgICAg
ICAgICAgICAgICB9DQo+ICsNCj4gKyAgICAgICAgICAgICAgIHJlcyA9IF9fdmVyaWZ5X3Jhc190
YWJsZV9jaGVja3N1bShjb250cm9sKTsNCj4gKyAgICAgICAgICAgICAgIGlmIChyZXMpDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIFJBU19ERVZfRVJSKHJhc19jb3JlLT5kZXYsDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIlJBUyBUYWJsZSBpbmNvcnJlY3QgY2hlY2tzdW0g
b3IgZXJyb3I6JWRcbiIsIHJlcyk7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIGlmIChjb250cm9s
LT5yZWNvcmRfdGhyZXNob2xkX2NvdW50ID49IGJhZF9wYWdlX2NvdW50KSB7DQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIC8qIFRoaXMgbWVhbnMgdGhhdCwgdGhlIHRocmVzaG9sZCB3YXMgaW5j
cmVhc2VkIHNpbmNlDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAqIHRoZSBsYXN0IHRpbWUg
dGhlIHN5c3RlbSB3YXMgYm9vdGVkLCBhbmQgbm93LA0KPiArICAgICAgICAgICAgICAgICAgICAg
ICAgKiByYXMtPnJlY29yZF90aHJlc2hvbGRfY291bnQgLSBjb250cm9sLT5udW1fcmVjcyA+IDAs
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAqIHNvIHRoYXQgYXQgbGVhc3Qgb25lIG1vcmUg
cmVjb3JkIGNhbiBiZSBzYXZlZCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICogYmVmb3Jl
IHRoZSBwYWdlIGNvdW50IHRocmVzaG9sZCBpcyByZWFjaGVkLg0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgKi8NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgUkFTX0RFVl9JTkZPKHJhc19j
b3JlLT5kZXYsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInJlY29yZHM6JWQg
dGhyZXNob2xkOiVkLCByZXNldHRpbmcgUkFTIHRhYmxlIGhlYWRlciBzaWduYXR1cmUiLA0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhZF9wYWdlX2NvdW50LA0KPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wtPnJlY29yZF90aHJlc2hvbGRfY291bnQp
Ow0KPiArICAgICAgICAgICAgICAgICAgICAgICByZXMgPSByYXNfZWVwcm9tX2NvcnJlY3RfaGVh
ZGVyX3RhZyhjb250cm9sLCBSQVNfVEFCTEVfSERSX1ZBTCk7DQo+ICsgICAgICAgICAgICAgICB9
IGVsc2Ugew0KPiArICAgICAgICAgICAgICAgICAgICAgICBSQVNfREVWX0VSUihyYXNfY29yZS0+
ZGV2LCAiUkFTIHJlY29yZHM6JWQgZXhjZWVkIHRocmVzaG9sZDolZCIsDQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYmFkX3BhZ2VfY291bnQsIGNvbnRyb2wtPnJlY29yZF90aHJl
c2hvbGRfY291bnQpOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGNvbnRyb2wtPnJl
Y29yZF90aHJlc2hvbGRfY29uZmlnID09IFdBUk5fTk9OU1RPUF9PVkVSX1RIUkVTSE9MRCkgfHwN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY29udHJvbC0+cmVjb3JkX3RocmVz
aG9sZF9jb25maWcgPT0gTk9OU1RPUF9PVkVSX1RIUkVTSE9MRCkpIHsNCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBSQVNfREVWX1dBUk4ocmFzX2NvcmUtPmRldiwNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAiUGxlYXNlIGNvbnN1bHQgQU1EIFNlcnZpY2UgQWN0
aW9uIEd1aWRlIChTQUcpIGZvciBhcHByb3ByaWF0ZSBzZXJ2aWNlIHByb2NlZHVyZXNcbiIpOw0K
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IDA7DQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIH0gZWxzZSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cmFzX2NvcmUtPmlzX3JtYSA9IHRydWU7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgUkFTX0RFVl9FUlIocmFzX2NvcmUtPmRldiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAiVXNlciBkZWZpbmVkIHRocmVzaG9sZCBpcyBzZXQsIHJ1bnRpbWUgc2VydmljZSB3
aWxsIGJlIGhhbHQgd2hlbiB0aHJlc2hvbGQgaXMgcmVhY2hlZFxuIik7DQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIH0NCj4gKyAgICAgICAgICAgICAgIH0NCj4gKyAgICAgICB9DQo+ICsNCj4g
KyAgICAgICByZXR1cm4gcmVzIDwgMCA/IHJlcyA6IDA7DQo+ICt9DQo+ICsNCj4gK2ludCByYXNf
ZWVwcm9tX2h3X2luaXQoc3RydWN0IHJhc19jb3JlX2NvbnRleHQgKnJhc19jb3JlKQ0KPiArew0K
PiArICAgICAgIHN0cnVjdCByYXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2w7DQo+ICsgICAgICAg
c3RydWN0IHJhc19lZXByb21fY29uZmlnICplZXByb21fY2ZnOw0KPiArDQo+ICsgICAgICAgaWYg
KCFyYXNfY29yZSkNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsg
ICAgICAgcmFzX2NvcmUtPmlzX3JtYSA9IGZhbHNlOw0KPiArDQo+ICsgICAgICAgY29udHJvbCA9
ICZyYXNfY29yZS0+cmFzX2VlcHJvbTsNCj4gKw0KPiArICAgICAgIG1lbXNldChjb250cm9sLCAw
LCBzaXplb2YoKmNvbnRyb2wpKTsNCj4gKw0KPiArICAgICAgIGVlcHJvbV9jZmcgPSAmcmFzX2Nv
cmUtPmNvbmZpZy0+ZWVwcm9tX2NmZzsNCj4gKyAgICAgICBjb250cm9sLT5yZWNvcmRfdGhyZXNo
b2xkX2NvbmZpZyA9DQo+ICsgICAgICAgICAgICAgICBlZXByb21fY2ZnLT5lZXByb21fcmVjb3Jk
X3RocmVzaG9sZF9jb25maWc7DQo+ICsNCj4gKyAgICAgICBjb250cm9sLT5yZWNvcmRfdGhyZXNo
b2xkX2NvdW50ID0gcmFzX2VlcHJvbV9tYXhfcmVjb3JkX2NvdW50KHJhc19jb3JlKTsNCj4gKyAg
ICAgICBpZiAoZWVwcm9tX2NmZy0+ZWVwcm9tX3JlY29yZF90aHJlc2hvbGRfY291bnQgPA0KPiAr
ICAgICAgICAgICAgICAgY29udHJvbC0+cmVjb3JkX3RocmVzaG9sZF9jb3VudCkNCj4gKyAgICAg
ICAgICAgICAgIGNvbnRyb2wtPnJlY29yZF90aHJlc2hvbGRfY291bnQgPQ0KPiArICAgICAgICAg
ICAgICAgICAgICAgICBlZXByb21fY2ZnLT5lZXByb21fcmVjb3JkX3RocmVzaG9sZF9jb3VudDsN
Cj4gKw0KPiArICAgICAgIGNvbnRyb2wtPnN5c19mdW5jID0gZWVwcm9tX2NmZy0+ZWVwcm9tX3N5
c19mbjsNCj4gKyAgICAgICBjb250cm9sLT5tYXhfcmVhZF9sZW4gPSBlZXByb21fY2ZnLT5tYXhf
aTJjX3JlYWRfbGVuOw0KPiArICAgICAgIGNvbnRyb2wtPm1heF93cml0ZV9sZW4gPSBlZXByb21f
Y2ZnLT5tYXhfaTJjX3dyaXRlX2xlbjsNCj4gKyAgICAgICBjb250cm9sLT5pMmNfYWRhcHRlciA9
IGVlcHJvbV9jZmctPmVlcHJvbV9pMmNfYWRhcHRlcjsNCj4gKyAgICAgICBjb250cm9sLT5pMmNf
cG9ydCA9IGVlcHJvbV9jZmctPmVlcHJvbV9pMmNfcG9ydDsNCj4gKyAgICAgICBjb250cm9sLT5p
MmNfYWRkcmVzcyA9IGVlcHJvbV9jZmctPmVlcHJvbV9pMmNfYWRkcjsNCj4gKw0KPiArICAgICAg
IGNvbnRyb2wtPnVwZGF0ZV9jaGFubmVsX2ZsYWcgPSBmYWxzZTsNCj4gKw0KPiArICAgICAgIHJl
dHVybiBfX2NoZWNrX3Jhc190YWJsZV9zdGF0dXMocmFzX2NvcmUpOw0KPiArfQ0KPiArDQo+ICtp
bnQgcmFzX2VlcHJvbV9od19maW5pKHN0cnVjdCByYXNfY29yZV9jb250ZXh0ICpyYXNfY29yZSkN
Cj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgcmFzX2VlcHJvbV9jb250cm9sICpjb250cm9sOw0KPiAr
DQo+ICsgICAgICAgaWYgKCFyYXNfY29yZSkNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlO
VkFMOw0KPiArDQo+ICsgICAgICAgY29udHJvbCA9ICZyYXNfY29yZS0+cmFzX2VlcHJvbTsNCj4g
KyAgICAgICBtdXRleF9kZXN0cm95KCZjb250cm9sLT5yYXNfdGJsX211dGV4KTsNCj4gKw0KPiAr
ICAgICAgIHJldHVybiAwOw0KPiArfQ0KPiArDQo+ICt1aW50MzJfdCByYXNfZWVwcm9tX2dldF9y
ZWNvcmRfY291bnQoc3RydWN0IHJhc19jb3JlX2NvbnRleHQgKnJhc19jb3JlKQ0KPiArew0KPiAr
ICAgICAgIGlmICghcmFzX2NvcmUpDQo+ICsgICAgICAgICAgICAgICByZXR1cm4gMDsNCj4gKw0K
PiArICAgICAgIHJldHVybiByYXNfY29yZS0+cmFzX2VlcHJvbS5yYXNfbnVtX3JlY3M7DQo+ICt9
DQo+ICsNCj4gK3ZvaWQgcmFzX2VlcHJvbV9zeW5jX2luZm8oc3RydWN0IHJhc19jb3JlX2NvbnRl
eHQgKnJhc19jb3JlKQ0KPiArew0KPiArICAgICAgIHN0cnVjdCByYXNfZWVwcm9tX2NvbnRyb2wg
KmNvbnRyb2w7DQo+ICsNCj4gKyAgICAgICBpZiAoIXJhc19jb3JlKQ0KPiArICAgICAgICAgICAg
ICAgcmV0dXJuOw0KPiArDQo+ICsgICAgICAgY29udHJvbCA9ICZyYXNfY29yZS0+cmFzX2VlcHJv
bTsNCj4gKyAgICAgICByYXNfY29yZV9ldmVudF9ub3RpZnkocmFzX2NvcmUsIFJBU19FVkVOVF9J
RF9fVVBEQVRFX0JBRF9QQUdFX05VTSwNCj4gKyAgICAgICAgICAgICAgICZjb250cm9sLT5yYXNf
bnVtX3JlY3MpOw0KPiArICAgICAgIHJhc19jb3JlX2V2ZW50X25vdGlmeShyYXNfY29yZSwgUkFT
X0VWRU5UX0lEX19VUERBVEVfQkFEX0NIQU5ORUxfQklUTUFQLA0KPiArICAgICAgICAgICAgICAg
JmNvbnRyb2wtPmJhZF9jaGFubmVsX2JpdG1hcCk7DQo+ICt9DQo+ICsNCj4gK2VudW0gcmFzX2dw
dV9oZWFsdGhfc3RhdHVzDQo+ICsgICAgICAgcmFzX2VlcHJvbV9jaGVja19ncHVfc3RhdHVzKHN0
cnVjdCByYXNfY29yZV9jb250ZXh0ICpyYXNfY29yZSkNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3Qg
cmFzX2VlcHJvbV9jb250cm9sICpjb250cm9sID0gJnJhc19jb3JlLT5yYXNfZWVwcm9tOw0KPiAr
ICAgICAgIHN0cnVjdCByYXNfZWVwcm9tX3RhYmxlX3Jhc19pbmZvICpyYWkgPSAmY29udHJvbC0+
dGJsX3JhaTsNCj4gKw0KPiArICAgICAgIGlmICghX19pc19yYXNfZWVwcm9tX3N1cHBvcnRlZChy
YXNfY29yZSkgfHwNCj4gKyAgICAgICAgICAgIWNvbnRyb2wtPnJlY29yZF90aHJlc2hvbGRfY29u
ZmlnKQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIFJBU19HUFVfSEVBTFRIX05PTkU7DQo+ICsN
Cj4gKyAgICAgICBpZiAoY29udHJvbC0+dGJsX2hkci5oZWFkZXIgPT0gUkFTX1RBQkxFX0hEUl9C
QUQpDQo+ICsgICAgICAgICAgICAgICByZXR1cm4gUkFTX0dQVV9JTl9CQURfU1RBVFVTOw0KPiAr
DQo+ICsgICAgICAgcmV0dXJuIHJhaS0+cm1hX3N0YXR1czsNCj4gK30NCj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvcmFzL3Jhc2NvcmUvcmFzX2VlcHJvbS5oIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9yYXMvcmFzY29yZS9yYXNfZWVwcm9tLmgNCj4gbmV3IGZpbGUgbW9kZSAxMDA2
NDQNCj4gaW5kZXggMDAwMDAwMDAwMDAwLi5kYjdlYjkyODVmODkNCj4gLS0tIC9kZXYvbnVsbA0K
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Jhcy9yYXNjb3JlL3Jhc19lZXByb20uaA0KPiBA
QCAtMCwwICsxLDIxNyBAQA0KPiArLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVCAqLw0K
PiArLyoNCj4gKyAqIENvcHlyaWdodCAyMDI1IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4N
Cj4gKyAqDQo+ICsgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJn
ZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQ0KPiArICogY29weSBvZiB0aGlzIHNvZnR3YXJl
IGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwNCj4g
KyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGlu
ZyB3aXRob3V0IGxpbWl0YXRpb24NCj4gKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2Rp
ZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLA0KPiArICogYW5kL29y
IHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdo
b20gdGhlDQo+ICsgKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8g
dGhlIGZvbGxvd2luZyBjb25kaXRpb25zOg0KPiArICoNCj4gKyAqIFRoZSBhYm92ZSBjb3B5cmln
aHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGlu
DQo+ICsgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2Fy
ZS4NCj4gKyAqDQo+ICsgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9V
VCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUg0KPiArICogSU1QTElFRCwgSU5DTFVE
SU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFks
DQo+ICsgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VN
RU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwNCj4gKyAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9S
IEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUg0KPiArICogT1RI
RVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBP
VEhFUldJU0UsDQo+ICsgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJ
VEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1INCj4gKyAqIE9USEVSIERFQUxJTkdTIElOIFRI
RSBTT0ZUV0FSRS4NCj4gKyAqDQo+ICsgKi8NCj4gKw0KPiArI2lmbmRlZiBfX1JBU19FRVBST01f
SF9fDQo+ICsjZGVmaW5lIF9fUkFTX0VFUFJPTV9IX18NCj4gKyNpbmNsdWRlICJyYXNfc3lzLmgi
DQo+ICsNCj4gKyNkZWZpbmUgUkFTX1RBQkxFX1ZFUl9WMSAgICAgICAgICAgMHgwMDAxMDAwMA0K
PiArI2RlZmluZSBSQVNfVEFCTEVfVkVSX1YyXzEgICAgICAgICAweDAwMDIxMDAwDQo+ICsjZGVm
aW5lIFJBU19UQUJMRV9WRVJfVjMgICAgICAgICAgIDB4MDAwMzAwMDANCj4gKw0KPiArI2RlZmlu
ZSBOT05TVE9QX09WRVJfVEhSRVNIT0xEICAgICAgICAgICAgICAtMg0KPiArI2RlZmluZSBXQVJO
X05PTlNUT1BfT1ZFUl9USFJFU0hPTEQgICAgICAgICAtMQ0KPiArI2RlZmluZSBESVNBQkxFX1JF
VElSRV9QQUdFICAgICAgICAgICAgICAgICAwDQo+ICsNCj4gKy8qDQo+ICsgKiBCYWQgYWRkcmVz
cyBwZm4gOiBlZXByb21fdW1jX3JlY29yZC5yZXRpcmVkX3Jvd19wZm5bMzk6MF0sDQo+ICsgKiBu
cHMgbW9kZTogZWVwcm9tX3VtY19yZWNvcmQucmV0aXJlZF9yb3dfcGZuWzQ3OjQwXQ0KPiArICov
DQo+ICsjZGVmaW5lIEVFUFJPTV9SRUNPUkRfVU1DX0FERFJfTUFTSyAweEZGRkZGRkZGRkZVTEwN
Cj4gKyNkZWZpbmUgRUVQUk9NX1JFQ09SRF9VTUNfTlBTX01BU0sgIDB4RkYwMDAwMDAwMDAwVUxM
DQo+ICsjZGVmaW5lIEVFUFJPTV9SRUNPUkRfVU1DX05QU19TSElGVCA0MA0KPiArDQo+ICsjZGVm
aW5lIEVFUFJPTV9SRUNPUkRfVU1DX05QU19NT0RFKFJFQ09SRCkgXA0KPiArICAgICAgICgoKFJF
Q09SRCktPnJldGlyZWRfcm93X3BmbiAmIEVFUFJPTV9SRUNPUkRfVU1DX05QU19NQVNLKSA+PiBc
DQo+ICsgICAgICAgICAgICAgICBFRVBST01fUkVDT1JEX1VNQ19OUFNfU0hJRlQpDQo+ICsNCj4g
KyNkZWZpbmUgRUVQUk9NX1JFQ09SRF9VTUNfQUREUl9QRk4oUkVDT1JEKSBcDQo+ICsgICAgICAg
KChSRUNPUkQpLT5yZXRpcmVkX3Jvd19wZm4gJiBFRVBST01fUkVDT1JEX1VNQ19BRERSX01BU0sp
DQo+ICsNCj4gKyNkZWZpbmUgRUVQUk9NX1JFQ09SRF9TRVRVUF9VTUNfQUREUl9BTkRfTlBTKFJF
Q09SRCwgQUREUiwgTlBTKSBcDQo+ICtkbyB7IFwNCj4gKyAgICAgICB1aW50NjRfdCB0bXAgPSAo
TlBTKTsgXA0KPiArICAgICAgIHRtcCA9ICgodG1wIDw8IEVFUFJPTV9SRUNPUkRfVU1DX05QU19T
SElGVCkgJiBFRVBST01fUkVDT1JEX1VNQ19OUFNfTUFTSyk7IFwNCj4gKyAgICAgICB0bXAgfD0g
KEFERFIpICYgRUVQUk9NX1JFQ09SRF9VTUNfQUREUl9NQVNLOyBcDQo+ICsgICAgICAgKFJFQ09S
RCktPnJldGlyZWRfcm93X3BmbiA9IHRtcDsgXA0KPiArfSB3aGlsZSAoMCkNCj4gKw0KPiArZW51
bSByYXNfZ3B1X2hlYWx0aF9zdGF0dXMgew0KPiArICAgICAgIFJBU19HUFVfSEVBTFRIX05PTkUg
PSAwLA0KPiArICAgICAgIFJBU19HUFVfSEVBTFRIX1VTQUJMRSA9IDEsDQo+ICsgICAgICAgUkFT
X0dQVV9SRVRJUkVEX19FQ0NfUkVBQ0hfVEhSRVNIT0xEID0gMiwNCj4gKyAgICAgICBSQVNfR1BV
X0lOX0JBRF9TVEFUVVMgPSAzLA0KPiArfTsNCj4gKw0KPiArZW51bSByYXNfZWVwcm9tX2Vycl90
eXBlIHsNCj4gKyAgICAgICBSQVNfRUVQUk9NX0VSUl9OQSwNCj4gKyAgICAgICBSQVNfRUVQUk9N
X0VSUl9SRUNPVkVSQUJMRSwNCj4gKyAgICAgICBSQVNfRUVQUk9NX0VSUl9OT05fUkVDT1ZFUkFC
TEUsDQo+ICsgICAgICAgUkFTX0VFUFJPTV9FUlJfQ09VTlQsDQo+ICt9Ow0KPiArDQo+ICtzdHJ1
Y3QgcmFzX2VlcHJvbV90YWJsZV9oZWFkZXIgew0KPiArICAgICAgIHVpbnQzMl90IGhlYWRlcjsN
Cj4gKyAgICAgICB1aW50MzJfdCB2ZXJzaW9uOw0KPiArICAgICAgIHVpbnQzMl90IGZpcnN0X3Jl
Y19vZmZzZXQ7DQo+ICsgICAgICAgdWludDMyX3QgdGJsX3NpemU7DQo+ICsgICAgICAgdWludDMy
X3QgY2hlY2tzdW07DQo+ICt9IF9fcGFja2VkOw0KPiArDQo+ICtzdHJ1Y3QgcmFzX2VlcHJvbV90
YWJsZV9yYXNfaW5mbyB7DQo+ICsgICAgICAgdTggIHJtYV9zdGF0dXM7DQo+ICsgICAgICAgdTgg
IGhlYWx0aF9wZXJjZW50Ow0KPiArICAgICAgIHUxNiBlY2NfcGFnZV90aHJlc2hvbGQ7DQo+ICsg
ICAgICAgdTMyIHBhZGRpbmdbNjQgLSAxXTsNCj4gK30gX19wYWNrZWQ7DQo+ICsNCj4gK3N0cnVj
dCByYXNfZWVwcm9tX2NvbnRyb2wgew0KPiArICAgICAgIHN0cnVjdCByYXNfZWVwcm9tX3RhYmxl
X2hlYWRlciB0YmxfaGRyOw0KPiArICAgICAgIHN0cnVjdCByYXNfZWVwcm9tX3RhYmxlX3Jhc19p
bmZvIHRibF9yYWk7DQo+ICsNCj4gKyAgICAgICAvKiByZWNvcmQgdGhyZXNob2xkICovDQo+ICsg
ICAgICAgaW50IHJlY29yZF90aHJlc2hvbGRfY29uZmlnOw0KPiArICAgICAgIHVpbnQzMl90IHJl
Y29yZF90aHJlc2hvbGRfY291bnQ7DQo+ICsgICAgICAgYm9vbCB1cGRhdGVfY2hhbm5lbF9mbGFn
Ow0KPiArDQo+ICsgICAgICAgY29uc3Qgc3RydWN0IHJhc19lZXByb21fc3lzX2Z1bmMgKnN5c19m
dW5jOw0KPiArICAgICAgIHZvaWQgKmkyY19hZGFwdGVyOw0KPiArICAgICAgIHUzMiBpMmNfcG9y
dDsNCj4gKyAgICAgICB1MTYgbWF4X3JlYWRfbGVuOw0KPiArICAgICAgIHUxNiBtYXhfd3JpdGVf
bGVuOw0KPiArDQo+ICsgICAgICAgLyogQmFzZSBJMkMgRUVQUFJPTSAxOS1iaXQgbWVtb3J5IGFk
ZHJlc3MsDQo+ICsgICAgICAgICogd2hlcmUgdGhlIHRhYmxlIGlzIGxvY2F0ZWQuIEZvciBtb3Jl
IGluZm9ybWF0aW9uLA0KPiArICAgICAgICAqIHNlZSB0b3Agb2YgYW1kZ3B1X2VlcHJvbS5jLg0K
PiArICAgICAgICAqLw0KPiArICAgICAgIHUzMiBpMmNfYWRkcmVzczsNCj4gKw0KPiArICAgICAg
IC8qIFRoZSBieXRlIG9mZnNldCBvZmYgb2YgQGkyY19hZGRyZXNzDQo+ICsgICAgICAgICogd2hl
cmUgdGhlIHRhYmxlIGhlYWRlciBpcyBmb3VuZCwNCj4gKyAgICAgICAgKiBhbmQgd2hlcmUgdGhl
IHJlY29yZHMgc3RhcnQtLWFsd2F5cw0KPiArICAgICAgICAqIHJpZ2h0IGFmdGVyIHRoZSBoZWFk
ZXIuDQo+ICsgICAgICAgICovDQo+ICsgICAgICAgdTMyIHJhc19oZWFkZXJfb2Zmc2V0Ow0KPiAr
ICAgICAgIHUzMiByYXNfaW5mb19vZmZzZXQ7DQo+ICsgICAgICAgdTMyIHJhc19yZWNvcmRfb2Zm
c2V0Ow0KPiArDQo+ICsgICAgICAgLyogTnVtYmVyIG9mIHJlY29yZHMgaW4gdGhlIHRhYmxlLg0K
PiArICAgICAgICAqLw0KPiArICAgICAgIHUzMiByYXNfbnVtX3JlY3M7DQo+ICsNCj4gKyAgICAg
ICAvKiBGaXJzdCByZWNvcmQgaW5kZXggdG8gcmVhZCwgMC1iYXNlZC4NCj4gKyAgICAgICAgKiBS
YW5nZSBpcyBbMCwgbnVtX3JlY3MtMV0uIFRoaXMgaXMNCj4gKyAgICAgICAgKiBhbiBhYnNvbHV0
ZSBpbmRleCwgc3RhcnRpbmcgcmlnaHQgYWZ0ZXINCj4gKyAgICAgICAgKiB0aGUgdGFibGUgaGVh
ZGVyLg0KPiArICAgICAgICAqLw0KPiArICAgICAgIHUzMiByYXNfZnJpOw0KPiArDQo+ICsgICAg
ICAgLyogTWF4aW11bSBwb3NzaWJsZSBudW1iZXIgb2YgcmVjb3Jkcw0KPiArICAgICAgICAqIHdl
IGNvdWxkIHN0b3JlLCBpLmUuIHRoZSBtYXhpbXVtIGNhcGFjaXR5DQo+ICsgICAgICAgICogb2Yg
dGhlIHRhYmxlLg0KPiArICAgICAgICAqLw0KPiArICAgICAgIHUzMiByYXNfbWF4X3JlY29yZF9j
b3VudDsNCj4gKw0KPiArICAgICAgIC8qIFByb3RlY3QgdGFibGUgYWNjZXNzIHZpYSB0aGlzIG11
dGV4Lg0KPiArICAgICAgICAqLw0KPiArICAgICAgIHN0cnVjdCBtdXRleCByYXNfdGJsX211dGV4
Ow0KPiArDQo+ICsgICAgICAgLyogUmVjb3JkIGNoYW5uZWwgaW5mbyB3aGljaCBvY2N1cnJlZCBi
YWQgcGFnZXMNCj4gKyAgICAgICAgKi8NCj4gKyAgICAgICB1MzIgYmFkX2NoYW5uZWxfYml0bWFw
Ow0KPiArfTsNCj4gKw0KPiArLyoNCj4gKyAqIFJlcHJlc2VudHMgc2luZ2xlIHRhYmxlIHJlY29y
ZC4gUGFja2VkIHRvIGJlIGVhc2lseSBzZXJpYWxpemVkIGludG8gYnl0ZQ0KPiArICogc3RyZWFt
Lg0KPiArICovDQo+ICtzdHJ1Y3QgZWVwcm9tX3VtY19yZWNvcmQgew0KPiArDQo+ICsgICAgICAg
dW5pb24gew0KPiArICAgICAgICAgICAgICAgdWludDY0X3QgYWRkcmVzczsNCj4gKyAgICAgICAg
ICAgICAgIHVpbnQ2NF90IG9mZnNldDsNCj4gKyAgICAgICB9Ow0KPiArDQo+ICsgICAgICAgdWlu
dDY0X3QgcmV0aXJlZF9yb3dfcGZuOw0KPiArICAgICAgIHVpbnQ2NF90IHRzOw0KPiArDQo+ICsg
ICAgICAgZW51bSByYXNfZWVwcm9tX2Vycl90eXBlIGVycl90eXBlOw0KPiArDQo+ICsgICAgICAg
dW5pb24gew0KPiArICAgICAgICAgICAgICAgdW5zaWduZWQgY2hhciBiYW5rOw0KPiArICAgICAg
ICAgICAgICAgdW5zaWduZWQgY2hhciBjdTsNCj4gKyAgICAgICB9Ow0KPiArDQo+ICsgICAgICAg
dW5zaWduZWQgY2hhciBtZW1fY2hhbm5lbDsNCj4gKyAgICAgICB1bnNpZ25lZCBjaGFyIG1jdW1j
X2lkOw0KPiArDQo+ICsgICAgICAgLyogVGhlIGZvbGxvd2luZyB2YXJpYWJsZXMgd2lsbCBub3Qg
YmUgc2F2ZWQgdG8gZWVwcm9tLg0KPiArICAgICAgICAqLw0KPiArICAgICAgIHVpbnQ2NF90IGN1
cl9ucHNfcmV0aXJlZF9yb3dfcGZuOw0KPiArICAgICAgIHVpbnQzMl90IGN1cl9ucHNfYmFuazsN
Cj4gKyAgICAgICB1aW50MzJfdCBjdXJfbnBzOw0KPiArfTsNCj4gKw0KPiArc3RydWN0IGVlcHJv
bV9pMmNfbXNnIHsNCj4gKyAgICAgICB1aW50MTZfdCBhZGRyOyAgLyogc2xhdmUgYWRkcmVzcyAg
ICAgICAgICAgICAgICAgICAgICAgICovDQo+ICsgICAgICAgdWludDE2X3QgZmxhZ3M7DQo+ICsj
ZGVmaW5lIEkyQ19NX1dSICAgICAgICAgICAgICAgMHgwMDAwICAvKiB3cml0ZSBkYXRhLCB0byBz
bGF2ZSAgICAgICAgICovDQo+ICsjZGVmaW5lIEkyQ19NX1JEICAgICAgICAgICAgICAgMHgwMDAx
ICAvKiByZWFkIGRhdGEsIGZyb20gc2xhdmUgdG8gbWFzdGVyICovDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBJMkNfTV9SRCBpcyBndWFyYW50ZWVkIHRvIGJl
IDB4MDAwMSEgKi8NCj4gKyNkZWZpbmUgSTJDX01fVEVOICAgICAgICAgICAgICAweDAwMTAgIC8q
IHRoaXMgaXMgYSB0ZW4gYml0IGNoaXAgYWRkcmVzcyAqLw0KPiArI2RlZmluZSBJMkNfTV9ETUFf
U0FGRSAgICAgICAgIDB4MDIwMCAgLyogdGhlIGJ1ZmZlciBvZiB0aGlzIG1lc3NhZ2UgaXMgRE1B
IHNhZmUgKi8NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIG1h
a2VzIG9ubHkgc2Vuc2UgaW4ga2VybmVsc3BhY2UgKi8NCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIC8qIHVzZXJzcGFjZSBidWZmZXJzIGFyZSBjb3BpZWQgYW55d2F5
ICovDQo+ICsjZGVmaW5lIEkyQ19NX1JFQ1ZfTEVOICAgICAgICAgMHgwNDAwICAvKiBsZW5ndGgg
d2lsbCBiZSBmaXJzdCByZWNlaXZlZCBieXRlICovDQo+ICsjZGVmaW5lIEkyQ19NX05PX1JEX0FD
SyAgICAgICAgICAgICAgICAweDA4MDAgIC8qIGlmIEkyQ19GVU5DX1BST1RPQ09MX01BTkdMSU5H
ICovDQo+ICsjZGVmaW5lIEkyQ19NX0lHTk9SRV9OQUsgICAgICAgMHgxMDAwICAvKiBpZiBJMkNf
RlVOQ19QUk9UT0NPTF9NQU5HTElORyAqLw0KPiArI2RlZmluZSBJMkNfTV9SRVZfRElSX0FERFIg
ICAgIDB4MjAwMCAgLyogaWYgSTJDX0ZVTkNfUFJPVE9DT0xfTUFOR0xJTkcgKi8NCj4gKyNkZWZp
bmUgSTJDX01fTk9TVEFSVCAgICAgICAgICAweDQwMDAgIC8qIGlmIEkyQ19GVU5DX05PU1RBUlQg
Ki8NCj4gKyNkZWZpbmUgSTJDX01fU1RPUCAgICAgICAgICAgICAweDgwMDAgIC8qIGlmIEkyQ19G
VU5DX1BST1RPQ09MX01BTkdMSU5HICovDQo+ICsgICAgICAgdWludDE2X3QgbGVuOyAgICAgICAg
ICAgLyogbXNnIGxlbmd0aCAgICAgICAgICAgICAgICAgICAgICAgICAgICovDQo+ICsgICAgICAg
dWludDhfdCAqYnVmOyAgICAgICAgICAgLyogcG9pbnRlciB0byBtc2cgZGF0YSAgICAgICAgICAg
ICAgICAgICovDQo+ICt9Ow0KDQpUaGlzIGlzIGEgZHVwbGljYXRlIG9mIHRoZSBleGlzdGluZyBp
biBrZXJuZWwgaTJjX21zZyBzdHJ1Y3R1cmUuICBKdXN0DQp1c2Ugc3RydWN0IGkyY19tc2cuDQoN
CkFsZXgNCg0KPiArDQo+ICtzdHJ1Y3QgcmFzX2NvcmVfY29udGV4dDsNCj4gK2ludCByYXNfZWVw
cm9tX2h3X2luaXQoc3RydWN0IHJhc19jb3JlX2NvbnRleHQgKnJhc19jb3JlKTsNCj4gK2ludCBy
YXNfZWVwcm9tX2h3X2Zpbmkoc3RydWN0IHJhc19jb3JlX2NvbnRleHQgKnJhc19jb3JlKTsNCj4g
Kw0KPiAraW50IHJhc19lZXByb21fcmVzZXRfdGFibGUoc3RydWN0IHJhc19jb3JlX2NvbnRleHQg
KnJhc19jb3JlKTsNCj4gKw0KPiArYm9vbCByYXNfZWVwcm9tX2NoZWNrX3NhZmV0eV93YXRlcm1h
cmsoc3RydWN0IHJhc19jb3JlX2NvbnRleHQgKnJhc19jb3JlKTsNCj4gKw0KPiAraW50IHJhc19l
ZXByb21fcmVhZChzdHJ1Y3QgcmFzX2NvcmVfY29udGV4dCAqcmFzX2NvcmUsDQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgZWVwcm9tX3VtY19yZWNvcmQgKnJlY29yZHMsIGNvbnN0
IHUzMiBudW0pOw0KPiArDQo+ICtpbnQgcmFzX2VlcHJvbV9hcHBlbmQoc3RydWN0IHJhc19jb3Jl
X2NvbnRleHQgKnJhc19jb3JlLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
ZWVwcm9tX3VtY19yZWNvcmQgKnJlY29yZHMsIGNvbnN0IHUzMiBudW0pOw0KPiArDQo+ICt1aW50
MzJfdCByYXNfZWVwcm9tX21heF9yZWNvcmRfY291bnQoc3RydWN0IHJhc19jb3JlX2NvbnRleHQg
KnJhc19jb3JlKTsNCj4gK3VpbnQzMl90IHJhc19lZXByb21fZ2V0X3JlY29yZF9jb3VudChzdHJ1
Y3QgcmFzX2NvcmVfY29udGV4dCAqcmFzX2NvcmUpOw0KPiArdm9pZCByYXNfZWVwcm9tX3N5bmNf
aW5mbyhzdHJ1Y3QgcmFzX2NvcmVfY29udGV4dCAqcmFzX2NvcmUpOw0KPiArDQo+ICtpbnQgcmFz
X2VlcHJvbV9jaGVja19zdG9yYWdlX3N0YXR1cyhzdHJ1Y3QgcmFzX2NvcmVfY29udGV4dCAqcmFz
X2NvcmUpOw0KPiArZW51bSByYXNfZ3B1X2hlYWx0aF9zdGF0dXMNCj4gKyAgICAgICByYXNfZWVw
cm9tX2NoZWNrX2dwdV9zdGF0dXMoc3RydWN0IHJhc19jb3JlX2NvbnRleHQgKnJhc19jb3JlKTsN
Cj4gKyNlbmRpZg0KPiAtLQ0KPiAyLjM0LjENCj4NCg==
