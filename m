Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E27E01A2BE
	for <lists+amd-gfx@lfdr.de>; Fri, 10 May 2019 19:58:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1B6E26E7A8;
	Fri, 10 May 2019 17:58:05 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wm1-x344.google.com (mail-wm1-x344.google.com
 [IPv6:2a00:1450:4864:20::344])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C2C5C6E7A8
 for <amd-gfx@lists.freedesktop.org>; Fri, 10 May 2019 17:58:02 +0000 (UTC)
Received: by mail-wm1-x344.google.com with SMTP id y2so8408036wmi.5
 for <amd-gfx@lists.freedesktop.org>; Fri, 10 May 2019 10:58:02 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=klBloGVUmYr6u7cH8MyeBDH+3iSMjdyyrH2DPnQrXzg=;
 b=lbByMeguPBJhIK/VbUKUieWNZNO+R6JJ2W/L9Qzoc7QUAji8Jqm+2K8nPmgKbTPvnl
 CX6UK3rWIiefkZNz7doJMnXH1zvljdiB7250UkStLkGUHq7zbOFqmlbI2Q1Lh4Up6MAZ
 cD4N1sq95KTIOJtulqMsvszPiYnj2vbEu6RErkCsav4i59MVzGFDEdHHQcKYWh8pZPlR
 aa9/NSnlsvTwQ8NUsqwqvZrn8/3ZJgWVKEW7WB2x+ybv5sLIItR0UMEysUDb4ob57hYj
 aEw0zkJqEVbxR4VnVW4xfk06pElwiwhM/ekpY2ZDEAFeqf+QZxN8/2otiESuF6gDGZPl
 BukQ==
X-Gm-Message-State: APjAAAVfup5z2C/g1MBy7H6LK9v9f5oUsBxzgTznBPI+1eOq93k/9Q1A
 iC0ZLNpH7MZiV8sPLUbXunhNgBF0
X-Google-Smtp-Source: APXvYqx6aIgisuDAi5u0+4XsJdzvZi0Hjmud5Lf5ozo4oqHTCbuNslatmVEGyEVXgI19Dez/0Y5kHg==
X-Received: by 2002:a1c:741a:: with SMTP id p26mr7986873wmc.38.1557511081286; 
 Fri, 10 May 2019 10:58:01 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:286c:644e:46f:e35b])
 by smtp.gmail.com with ESMTPSA id b206sm2819491wmd.28.2019.05.10.10.58.00
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Fri, 10 May 2019 10:58:00 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: Oak.Zeng@amd.com, Felix.Kuehling@amd.com, Sean.Keely@amd.com,
 amd-gfx@lists.freedesktop.org
Subject: [PATCH] drm/amdgpu: remove static GDS, GWS and OA allocation
Date: Fri, 10 May 2019 19:57:59 +0200
Message-Id: <20190510175759.78078-1-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=klBloGVUmYr6u7cH8MyeBDH+3iSMjdyyrH2DPnQrXzg=;
 b=lc+NVVRUEmoT6nz39h2JaGS3a6mkMkHx3RKvyN5cFqqKqyoTdSry1G4cAOB/Niedvj
 tKyGcjVwaKZI2ZrpdGdmAQVHCylPVuU+X+PjP+XSfUysjZKF0JFsO7YAB0dfmPSJ14Uq
 a00bydqNNxmCYUcu+qcfSuuf/qBeu+WJZyo1XWWkghgM9D1UhjdfIiQmMBogrb6jUsMZ
 oY+uP5Jztwx9aCgq0S1oDsESdMX3ccAqa7cqjL3VJxyd3i00AflBKoDj/cZcEIn9MXwC
 ++T9rBqup+jUKPmCwq+qZwpyY02HUt4RpHzsRZa1IxWXMs/psTchitVufrAcuFZyr+fY
 17NA==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QXMgZmFyIGFzIHdlIGtub3cgdGhpcyB3YXMgbmV2ZXIgdXNlZCBieSB1c2Vyc3BhY2UgYW5kIHNv
IHNob3VsZCBiZSByZW1vdmVkLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hy
aXN0aWFuLmtvZW5pZ0BhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9ib19saXN0LmMgfCAgNiArKy0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfZ2RzLmggICAgIHwgMjEgKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9rbXMuYyAgICAgfCAxMSArKystLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV90dG0uYyAgICAgfCAyNCArKy0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9nZnhfdjdfMC5jICAgICAgIHwgMzIgKysrLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OF8wLmMgICAgICAgfCAzMiArKystLS0tLS0tLS0tLS0t
LQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYyAgICAgICB8IDM5ICsrKyst
LS0tLS0tLS0tLS0tLS0tLQogNyBmaWxlcyBjaGFuZ2VkLCAyOCBpbnNlcnRpb25zKCspLCAxMzcg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2JvX2xpc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9ib19saXN0
LmMKaW5kZXggNWM3OWRhOGUxMTUwLi5kNDk3NDY3YjdmYzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9ib19saXN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2JvX2xpc3QuYwpAQCAtODEsOSArODEsOSBAQCBpbnQgYW1kZ3B1
X2JvX2xpc3RfY3JlYXRlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgZHJtX2Zp
bGUgKmZpbHAsCiAJCXJldHVybiAtRU5PTUVNOwogCiAJa3JlZl9pbml0KCZsaXN0LT5yZWZjb3Vu
dCk7Ci0JbGlzdC0+Z2RzX29iaiA9IGFkZXYtPmdkcy5nZHNfZ2Z4X2JvOwotCWxpc3QtPmd3c19v
YmogPSBhZGV2LT5nZHMuZ3dzX2dmeF9ibzsKLQlsaXN0LT5vYV9vYmogPSBhZGV2LT5nZHMub2Ff
Z2Z4X2JvOworCWxpc3QtPmdkc19vYmogPSBOVUxMOworCWxpc3QtPmd3c19vYmogPSBOVUxMOwor
CWxpc3QtPm9hX29iaiA9IE5VTEw7CiAKIAlhcnJheSA9IGFtZGdwdV9ib19saXN0X2FycmF5X2Vu
dHJ5KGxpc3QsIDApOwogCW1lbXNldChhcnJheSwgMCwgbnVtX2VudHJpZXMgKiBzaXplb2Yoc3Ry
dWN0IGFtZGdwdV9ib19saXN0X2VudHJ5KSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfZ2RzLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfZ2RzLmgKaW5kZXggZjg5ZjU3MzRkOTg1Li5kYWQyMTg2ZjRlZDUgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZHMuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfZ2RzLmgKQEAgLTI3LDI2ICsyNywxMSBAQAogc3RydWN0IGFt
ZGdwdV9yaW5nOwogc3RydWN0IGFtZGdwdV9ibzsKIAotc3RydWN0IGFtZGdwdV9nZHNfYXNpY19p
bmZvIHsKLQl1aW50MzJfdAl0b3RhbF9zaXplOwotCXVpbnQzMl90CWdmeF9wYXJ0aXRpb25fc2l6
ZTsKLQl1aW50MzJfdAljc19wYXJ0aXRpb25fc2l6ZTsKLX07Ci0KIHN0cnVjdCBhbWRncHVfZ2Rz
IHsKLQlzdHJ1Y3QgYW1kZ3B1X2dkc19hc2ljX2luZm8JbWVtOwotCXN0cnVjdCBhbWRncHVfZ2Rz
X2FzaWNfaW5mbwlnd3M7Ci0Jc3RydWN0IGFtZGdwdV9nZHNfYXNpY19pbmZvCW9hOworCXVpbnQz
Ml90IGdkc19zaXplOworCXVpbnQzMl90IGd3c19zaXplOworCXVpbnQzMl90IG9hX3NpemU7CiAJ
dWludDMyX3QJCQlnZHNfY29tcHV0ZV9tYXhfd2F2ZV9pZDsKLQotCS8qIEF0IHByZXNlbnQsIEdE
UywgR1dTIGFuZCBPQSByZXNvdXJjZXMgZm9yIGdmeCAoZ3JhcGhpY3MpCi0JICogaXMgYWx3YXlz
IHByZS1hbGxvY2F0ZWQgYW5kIGF2YWlsYWJsZSBmb3IgZ3JhcGhpY3Mgb3BlcmF0aW9uLgotCSAq
IFN1Y2ggcmVzb3VyY2UgaXMgc2hhcmVkIGJldHdlZW4gYWxsIGdmeCBjbGllbnRzLgotCSAqIFRP
RE86IG1vdmUgdGhpcyBvcGVyYXRpb24gdG8gdXNlciBzcGFjZQotCSAqICovCi0Jc3RydWN0IGFt
ZGdwdV9ibyoJCWdkc19nZnhfYm87Ci0Jc3RydWN0IGFtZGdwdV9ibyoJCWd3c19nZnhfYm87Ci0J
c3RydWN0IGFtZGdwdV9ibyoJCW9hX2dmeF9ibzsKIH07CiAKIHN0cnVjdCBhbWRncHVfZ2RzX3Jl
Z19vZmZzZXQgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2ttcy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ttcy5jCmluZGV4IGRh
N2I0ZmU4YWRlMy4uODdhOTM4NzRkNzFlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfa21zLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2ttcy5jCkBAIC01OTAsMTMgKzU5MCwxMCBAQCBzdGF0aWMgaW50IGFtZGdwdV9pbmZvX2lv
Y3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsIHN0cnVjdCBkcm1fZmlsZQog
CQlzdHJ1Y3QgZHJtX2FtZGdwdV9pbmZvX2dkcyBnZHNfaW5mbzsKIAogCQltZW1zZXQoJmdkc19p
bmZvLCAwLCBzaXplb2YoZ2RzX2luZm8pKTsKLQkJZ2RzX2luZm8uZ2RzX2dmeF9wYXJ0aXRpb25f
c2l6ZSA9IGFkZXYtPmdkcy5tZW0uZ2Z4X3BhcnRpdGlvbl9zaXplOwotCQlnZHNfaW5mby5jb21w
dXRlX3BhcnRpdGlvbl9zaXplID0gYWRldi0+Z2RzLm1lbS5jc19wYXJ0aXRpb25fc2l6ZTsKLQkJ
Z2RzX2luZm8uZ2RzX3RvdGFsX3NpemUgPSBhZGV2LT5nZHMubWVtLnRvdGFsX3NpemU7Ci0JCWdk
c19pbmZvLmd3c19wZXJfZ2Z4X3BhcnRpdGlvbiA9IGFkZXYtPmdkcy5nd3MuZ2Z4X3BhcnRpdGlv
bl9zaXplOwotCQlnZHNfaW5mby5nd3NfcGVyX2NvbXB1dGVfcGFydGl0aW9uID0gYWRldi0+Z2Rz
Lmd3cy5jc19wYXJ0aXRpb25fc2l6ZTsKLQkJZ2RzX2luZm8ub2FfcGVyX2dmeF9wYXJ0aXRpb24g
PSBhZGV2LT5nZHMub2EuZ2Z4X3BhcnRpdGlvbl9zaXplOwotCQlnZHNfaW5mby5vYV9wZXJfY29t
cHV0ZV9wYXJ0aXRpb24gPSBhZGV2LT5nZHMub2EuY3NfcGFydGl0aW9uX3NpemU7CisJCWdkc19p
bmZvLmNvbXB1dGVfcGFydGl0aW9uX3NpemUgPSBhZGV2LT5nZHMuZ2RzX3NpemU7CisJCWdkc19p
bmZvLmdkc190b3RhbF9zaXplID0gYWRldi0+Z2RzLmdkc19zaXplOworCQlnZHNfaW5mby5nd3Nf
cGVyX2NvbXB1dGVfcGFydGl0aW9uID0gYWRldi0+Z2RzLmd3c19zaXplOworCQlnZHNfaW5mby5v
YV9wZXJfY29tcHV0ZV9wYXJ0aXRpb24gPSBhZGV2LT5nZHMub2Ffc2l6ZTsKIAkJcmV0dXJuIGNv
cHlfdG9fdXNlcihvdXQsICZnZHNfaW5mbywKIAkJCQkgICAgbWluKChzaXplX3Qpc2l6ZSwgc2l6
ZW9mKGdkc19pbmZvKSkpID8gLUVGQVVMVCA6IDA7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3R0bS5jCmluZGV4IGMxNDE5ODczN2RjZC4uYjI1OTIyZTNkMWVkIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCkBAIC0xNzU4LDQ0ICsxNzU4LDI2IEBA
IGludCBhbWRncHVfdHRtX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiAKIAkvKiBJ
bml0aWFsaXplIHZhcmlvdXMgb24tY2hpcCBtZW1vcnkgcG9vbHMgKi8KIAlyID0gdHRtX2JvX2lu
aXRfbW0oJmFkZXYtPm1tYW4uYmRldiwgQU1ER1BVX1BMX0dEUywKLQkJCSAgIGFkZXYtPmdkcy5t
ZW0udG90YWxfc2l6ZSk7CisJCQkgICBhZGV2LT5nZHMuZ2RzX3NpemUpOwogCWlmIChyKSB7CiAJ
CURSTV9FUlJPUigiRmFpbGVkIGluaXRpYWxpemluZyBHRFMgaGVhcC5cbiIpOwogCQlyZXR1cm4g
cjsKIAl9CiAKLQlyID0gYW1kZ3B1X2JvX2NyZWF0ZV9rZXJuZWwoYWRldiwgYWRldi0+Z2RzLm1l
bS5nZnhfcGFydGl0aW9uX3NpemUsCi0JCQkJICAgIDQsIEFNREdQVV9HRU1fRE9NQUlOX0dEUywK
LQkJCQkgICAgJmFkZXYtPmdkcy5nZHNfZ2Z4X2JvLCBOVUxMLCBOVUxMKTsKLQlpZiAocikKLQkJ
cmV0dXJuIHI7Ci0KIAlyID0gdHRtX2JvX2luaXRfbW0oJmFkZXYtPm1tYW4uYmRldiwgQU1ER1BV
X1BMX0dXUywKLQkJCSAgIGFkZXYtPmdkcy5nd3MudG90YWxfc2l6ZSk7CisJCQkgICBhZGV2LT5n
ZHMuZ3dzX3NpemUpOwogCWlmIChyKSB7CiAJCURSTV9FUlJPUigiRmFpbGVkIGluaXRpYWxpemlu
ZyBnd3MgaGVhcC5cbiIpOwogCQlyZXR1cm4gcjsKIAl9CiAKLQlyID0gYW1kZ3B1X2JvX2NyZWF0
ZV9rZXJuZWwoYWRldiwgYWRldi0+Z2RzLmd3cy5nZnhfcGFydGl0aW9uX3NpemUsCi0JCQkJICAg
IDEsIEFNREdQVV9HRU1fRE9NQUlOX0dXUywKLQkJCQkgICAgJmFkZXYtPmdkcy5nd3NfZ2Z4X2Jv
LCBOVUxMLCBOVUxMKTsKLQlpZiAocikKLQkJcmV0dXJuIHI7Ci0KIAlyID0gdHRtX2JvX2luaXRf
bW0oJmFkZXYtPm1tYW4uYmRldiwgQU1ER1BVX1BMX09BLAotCQkJICAgYWRldi0+Z2RzLm9hLnRv
dGFsX3NpemUpOworCQkJICAgYWRldi0+Z2RzLm9hX3NpemUpOwogCWlmIChyKSB7CiAJCURSTV9F
UlJPUigiRmFpbGVkIGluaXRpYWxpemluZyBvYSBoZWFwLlxuIik7CiAJCXJldHVybiByOwogCX0K
IAotCXIgPSBhbWRncHVfYm9fY3JlYXRlX2tlcm5lbChhZGV2LCBhZGV2LT5nZHMub2EuZ2Z4X3Bh
cnRpdGlvbl9zaXplLAotCQkJCSAgICAxLCBBTURHUFVfR0VNX0RPTUFJTl9PQSwKLQkJCQkgICAg
JmFkZXYtPmdkcy5vYV9nZnhfYm8sIE5VTEwsIE5VTEwpOwotCWlmIChyKQotCQlyZXR1cm4gcjsK
LQogCS8qIFJlZ2lzdGVyIGRlYnVnZnMgZW50cmllcyBmb3IgYW1kZ3B1X3R0bSAqLwogCXIgPSBh
bWRncHVfdHRtX2RlYnVnZnNfaW5pdChhZGV2KTsKIAlpZiAocikgewpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y3XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2dmeF92N18wLmMKaW5kZXggYTU5ZTBmZGY1YTk3Li40Y2QxNzMxZDYyZmQgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92N18wLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y3XzAuYwpAQCAtNDQ5MywxMiArNDQ5Myw4IEBAIHN0
YXRpYyBpbnQgZ2Z4X3Y3XzBfc3dfaW5pdCh2b2lkICpoYW5kbGUpCiAKIHN0YXRpYyBpbnQgZ2Z4
X3Y3XzBfc3dfZmluaSh2b2lkICpoYW5kbGUpCiB7Ci0JaW50IGk7CiAJc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7Ci0KLQlhbWRncHVf
Ym9fZnJlZV9rZXJuZWwoJmFkZXYtPmdkcy5vYV9nZnhfYm8sIE5VTEwsIE5VTEwpOwotCWFtZGdw
dV9ib19mcmVlX2tlcm5lbCgmYWRldi0+Z2RzLmd3c19nZnhfYm8sIE5VTEwsIE5VTEwpOwotCWFt
ZGdwdV9ib19mcmVlX2tlcm5lbCgmYWRldi0+Z2RzLmdkc19nZnhfYm8sIE5VTEwsIE5VTEwpOwor
CWludCBpOwogCiAJZm9yIChpID0gMDsgaSA8IGFkZXYtPmdmeC5udW1fZ2Z4X3JpbmdzOyBpKysp
CiAJCWFtZGdwdV9yaW5nX2ZpbmkoJmFkZXYtPmdmeC5nZnhfcmluZ1tpXSk7CkBAIC01MDcwLDMw
ICs1MDY2LDEwIEBAIHN0YXRpYyB2b2lkIGdmeF92N18wX3NldF9pcnFfZnVuY3Moc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYpCiBzdGF0aWMgdm9pZCBnZnhfdjdfMF9zZXRfZ2RzX2luaXQoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiB7CiAJLyogaW5pdCBhc2NpIGdkcyBpbmZvICovCi0J
YWRldi0+Z2RzLm1lbS50b3RhbF9zaXplID0gUlJFRzMyKG1tR0RTX1ZNSUQwX1NJWkUpOwotCWFk
ZXYtPmdkcy5nd3MudG90YWxfc2l6ZSA9IDY0OwotCWFkZXYtPmdkcy5vYS50b3RhbF9zaXplID0g
MTY7CisJYWRldi0+Z2RzLmdkc19zaXplID0gUlJFRzMyKG1tR0RTX1ZNSUQwX1NJWkUpOworCWFk
ZXYtPmdkcy5nd3Nfc2l6ZSA9IDY0OworCWFkZXYtPmdkcy5vYV9zaXplID0gMTY7CiAJYWRldi0+
Z2RzLmdkc19jb21wdXRlX21heF93YXZlX2lkID0gUlJFRzMyKG1tR0RTX0NPTVBVVEVfTUFYX1dB
VkVfSUQpOwotCi0JaWYgKGFkZXYtPmdkcy5tZW0udG90YWxfc2l6ZSA9PSA2NCAqIDEwMjQpIHsK
LQkJYWRldi0+Z2RzLm1lbS5nZnhfcGFydGl0aW9uX3NpemUgPSA0MDk2OwotCQlhZGV2LT5nZHMu
bWVtLmNzX3BhcnRpdGlvbl9zaXplID0gNDA5NjsKLQotCQlhZGV2LT5nZHMuZ3dzLmdmeF9wYXJ0
aXRpb25fc2l6ZSA9IDQ7Ci0JCWFkZXYtPmdkcy5nd3MuY3NfcGFydGl0aW9uX3NpemUgPSA0Owot
Ci0JCWFkZXYtPmdkcy5vYS5nZnhfcGFydGl0aW9uX3NpemUgPSA0OwotCQlhZGV2LT5nZHMub2Eu
Y3NfcGFydGl0aW9uX3NpemUgPSAxOwotCX0gZWxzZSB7Ci0JCWFkZXYtPmdkcy5tZW0uZ2Z4X3Bh
cnRpdGlvbl9zaXplID0gMTAyNDsKLQkJYWRldi0+Z2RzLm1lbS5jc19wYXJ0aXRpb25fc2l6ZSA9
IDEwMjQ7Ci0KLQkJYWRldi0+Z2RzLmd3cy5nZnhfcGFydGl0aW9uX3NpemUgPSAxNjsKLQkJYWRl
di0+Z2RzLmd3cy5jc19wYXJ0aXRpb25fc2l6ZSA9IDE2OwotCi0JCWFkZXYtPmdkcy5vYS5nZnhf
cGFydGl0aW9uX3NpemUgPSA0OwotCQlhZGV2LT5nZHMub2EuY3NfcGFydGl0aW9uX3NpemUgPSA0
OwotCX0KIH0KIAogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhf
djhfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y4XzAuYwppbmRleCAwMjk1
NWU2ZTlkZDkuLjI1NDAwYjcwODcyMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvZ2Z4X3Y4XzAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjhf
MC5jCkBAIC0yMDU3LDEyICsyMDU3LDggQEAgc3RhdGljIGludCBnZnhfdjhfMF9zd19pbml0KHZv
aWQgKmhhbmRsZSkKIAogc3RhdGljIGludCBnZnhfdjhfMF9zd19maW5pKHZvaWQgKmhhbmRsZSkK
IHsKLQlpbnQgaTsKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqKWhhbmRsZTsKLQotCWFtZGdwdV9ib19mcmVlX2tlcm5lbCgmYWRldi0+Z2RzLm9h
X2dmeF9ibywgTlVMTCwgTlVMTCk7Ci0JYW1kZ3B1X2JvX2ZyZWVfa2VybmVsKCZhZGV2LT5nZHMu
Z3dzX2dmeF9ibywgTlVMTCwgTlVMTCk7Ci0JYW1kZ3B1X2JvX2ZyZWVfa2VybmVsKCZhZGV2LT5n
ZHMuZ2RzX2dmeF9ibywgTlVMTCwgTlVMTCk7CisJaW50IGk7CiAKIAlmb3IgKGkgPSAwOyBpIDwg
YWRldi0+Z2Z4Lm51bV9nZnhfcmluZ3M7IGkrKykKIAkJYW1kZ3B1X3JpbmdfZmluaSgmYWRldi0+
Z2Z4LmdmeF9yaW5nW2ldKTsKQEAgLTcwMTAsMzAgKzcwMDYsMTAgQEAgc3RhdGljIHZvaWQgZ2Z4
X3Y4XzBfc2V0X3JsY19mdW5jcyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIHN0YXRpYyB2
b2lkIGdmeF92OF8wX3NldF9nZHNfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIHsK
IAkvKiBpbml0IGFzY2kgZ2RzIGluZm8gKi8KLQlhZGV2LT5nZHMubWVtLnRvdGFsX3NpemUgPSBS
UkVHMzIobW1HRFNfVk1JRDBfU0laRSk7Ci0JYWRldi0+Z2RzLmd3cy50b3RhbF9zaXplID0gNjQ7
Ci0JYWRldi0+Z2RzLm9hLnRvdGFsX3NpemUgPSAxNjsKKwlhZGV2LT5nZHMuZ2RzX3NpemUgPSBS
UkVHMzIobW1HRFNfVk1JRDBfU0laRSk7CisJYWRldi0+Z2RzLmd3c19zaXplID0gNjQ7CisJYWRl
di0+Z2RzLm9hX3NpemUgPSAxNjsKIAlhZGV2LT5nZHMuZ2RzX2NvbXB1dGVfbWF4X3dhdmVfaWQg
PSBSUkVHMzIobW1HRFNfQ09NUFVURV9NQVhfV0FWRV9JRCk7Ci0KLQlpZiAoYWRldi0+Z2RzLm1l
bS50b3RhbF9zaXplID09IDY0ICogMTAyNCkgewotCQlhZGV2LT5nZHMubWVtLmdmeF9wYXJ0aXRp
b25fc2l6ZSA9IDQwOTY7Ci0JCWFkZXYtPmdkcy5tZW0uY3NfcGFydGl0aW9uX3NpemUgPSA0MDk2
OwotCi0JCWFkZXYtPmdkcy5nd3MuZ2Z4X3BhcnRpdGlvbl9zaXplID0gNDsKLQkJYWRldi0+Z2Rz
Lmd3cy5jc19wYXJ0aXRpb25fc2l6ZSA9IDQ7Ci0KLQkJYWRldi0+Z2RzLm9hLmdmeF9wYXJ0aXRp
b25fc2l6ZSA9IDQ7Ci0JCWFkZXYtPmdkcy5vYS5jc19wYXJ0aXRpb25fc2l6ZSA9IDE7Ci0JfSBl
bHNlIHsKLQkJYWRldi0+Z2RzLm1lbS5nZnhfcGFydGl0aW9uX3NpemUgPSAxMDI0OwotCQlhZGV2
LT5nZHMubWVtLmNzX3BhcnRpdGlvbl9zaXplID0gMTAyNDsKLQotCQlhZGV2LT5nZHMuZ3dzLmdm
eF9wYXJ0aXRpb25fc2l6ZSA9IDE2OwotCQlhZGV2LT5nZHMuZ3dzLmNzX3BhcnRpdGlvbl9zaXpl
ID0gMTY7Ci0KLQkJYWRldi0+Z2RzLm9hLmdmeF9wYXJ0aXRpb25fc2l6ZSA9IDQ7Ci0JCWFkZXYt
Pmdkcy5vYS5jc19wYXJ0aXRpb25fc2l6ZSA9IDQ7Ci0JfQogfQogCiBzdGF0aWMgdm9pZCBnZnhf
djhfMF9zZXRfdXNlcl9jdV9pbmFjdGl2ZV9iaXRtYXAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYwppbmRleCBmYzZkOGMxZmQzMmIu
LmZhYzM4NDI5Njg1ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4
X3Y5XzAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jCkBAIC0x
NDYxLDggKzE0NjEsNyBAQCBzdGF0aWMgaW50IGdmeF92OV8wX25nZ19pbml0KHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2KQogCiAJLyogR0RTIHJlc2VydmUgbWVtb3J5OiA2NCBieXRlcyBhbGln
bm1lbnQgKi8KIAlhZGV2LT5nZngubmdnLmdkc19yZXNlcnZlX3NpemUgPSBBTElHTig1ICogNCwg
MHg0MCk7Ci0JYWRldi0+Z2RzLm1lbS50b3RhbF9zaXplIC09IGFkZXYtPmdmeC5uZ2cuZ2RzX3Jl
c2VydmVfc2l6ZTsKLQlhZGV2LT5nZHMubWVtLmdmeF9wYXJ0aXRpb25fc2l6ZSAtPSBhZGV2LT5n
ZngubmdnLmdkc19yZXNlcnZlX3NpemU7CisJYWRldi0+Z2RzLmdkc19zaXplIC09IGFkZXYtPmdm
eC5uZ2cuZ2RzX3Jlc2VydmVfc2l6ZTsKIAlhZGV2LT5nZngubmdnLmdkc19yZXNlcnZlX2FkZHIg
PSBSUkVHMzJfU09DMTUoR0MsIDAsIG1tR0RTX1ZNSUQwX0JBU0UpOwogCWFkZXYtPmdmeC5uZ2cu
Z2RzX3Jlc2VydmVfYWRkciArPSBSUkVHMzJfU09DMTUoR0MsIDAsIG1tR0RTX1ZNSUQwX1NJWkUp
OwogCkBAIC0xNTcwLDcgKzE1NjksNyBAQCBzdGF0aWMgaW50IGdmeF92OV8wX25nZ19lbihzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAogCWdmeF92OV8wX3dyaXRlX2RhdGFfdG9fcmVnKHJp
bmcsIDAsIGZhbHNlLAogCQkJCSAgIFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tR0RTX1ZNSUQw
X1NJWkUpLAotCQkJICAgICAgICAgICAoYWRldi0+Z2RzLm1lbS50b3RhbF9zaXplICsKKwkJCSAg
ICAgICAgICAgKGFkZXYtPmdkcy5nZHNfc2l6ZSArCiAJCQkJICAgIGFkZXYtPmdmeC5uZ2cuZ2Rz
X3Jlc2VydmVfc2l6ZSkpOwogCiAJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgUEFDS0VUMyhQQUNL
RVQzX0RNQV9EQVRBLCA1KSk7CkBAIC0xNzg0LDEwICsxNzgzLDYgQEAgc3RhdGljIGludCBnZnhf
djlfMF9zd19maW5pKHZvaWQgKmhhbmRsZSkKIAkJa2ZyZWUocmFzX2lmKTsKIAl9CiAKLQlhbWRn
cHVfYm9fZnJlZV9rZXJuZWwoJmFkZXYtPmdkcy5vYV9nZnhfYm8sIE5VTEwsIE5VTEwpOwotCWFt
ZGdwdV9ib19mcmVlX2tlcm5lbCgmYWRldi0+Z2RzLmd3c19nZnhfYm8sIE5VTEwsIE5VTEwpOwot
CWFtZGdwdV9ib19mcmVlX2tlcm5lbCgmYWRldi0+Z2RzLmdkc19nZnhfYm8sIE5VTEwsIE5VTEwp
OwotCiAJZm9yIChpID0gMDsgaSA8IGFkZXYtPmdmeC5udW1fZ2Z4X3JpbmdzOyBpKyspCiAJCWFt
ZGdwdV9yaW5nX2ZpbmkoJmFkZXYtPmdmeC5nZnhfcmluZ1tpXSk7CiAJZm9yIChpID0gMDsgaSA8
IGFkZXYtPmdmeC5udW1fY29tcHV0ZV9yaW5nczsgaSsrKQpAQCAtNTMwOSwxMyArNTMwNCwxMyBA
QCBzdGF0aWMgdm9pZCBnZnhfdjlfMF9zZXRfZ2RzX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYpCiAJY2FzZSBDSElQX1ZFR0ExMDoKIAljYXNlIENISVBfVkVHQTEyOgogCWNhc2UgQ0hJ
UF9WRUdBMjA6Ci0JCWFkZXYtPmdkcy5tZW0udG90YWxfc2l6ZSA9IDB4MTAwMDA7CisJCWFkZXYt
Pmdkcy5nZHNfc2l6ZSA9IDB4MTAwMDA7CiAJCWJyZWFrOwogCWNhc2UgQ0hJUF9SQVZFTjoKLQkJ
YWRldi0+Z2RzLm1lbS50b3RhbF9zaXplID0gMHgxMDAwOworCQlhZGV2LT5nZHMuZ2RzX3NpemUg
PSAweDEwMDA7CiAJCWJyZWFrOwogCWRlZmF1bHQ6Ci0JCWFkZXYtPmdkcy5tZW0udG90YWxfc2l6
ZSA9IDB4MTAwMDA7CisJCWFkZXYtPmdkcy5nZHNfc2l6ZSA9IDB4MTAwMDA7CiAJCWJyZWFrOwog
CX0KIApAQCAtNTMzOSwyOCArNTMzNCw4IEBAIHN0YXRpYyB2b2lkIGdmeF92OV8wX3NldF9nZHNf
aW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAkJYnJlYWs7CiAJfQogCi0JYWRldi0+
Z2RzLmd3cy50b3RhbF9zaXplID0gNjQ7Ci0JYWRldi0+Z2RzLm9hLnRvdGFsX3NpemUgPSAxNjsK
LQotCWlmIChhZGV2LT5nZHMubWVtLnRvdGFsX3NpemUgPT0gNjQgKiAxMDI0KSB7Ci0JCWFkZXYt
Pmdkcy5tZW0uZ2Z4X3BhcnRpdGlvbl9zaXplID0gNDA5NjsKLQkJYWRldi0+Z2RzLm1lbS5jc19w
YXJ0aXRpb25fc2l6ZSA9IDQwOTY7Ci0KLQkJYWRldi0+Z2RzLmd3cy5nZnhfcGFydGl0aW9uX3Np
emUgPSA0OwotCQlhZGV2LT5nZHMuZ3dzLmNzX3BhcnRpdGlvbl9zaXplID0gNDsKLQotCQlhZGV2
LT5nZHMub2EuZ2Z4X3BhcnRpdGlvbl9zaXplID0gNDsKLQkJYWRldi0+Z2RzLm9hLmNzX3BhcnRp
dGlvbl9zaXplID0gMTsKLQl9IGVsc2UgewotCQlhZGV2LT5nZHMubWVtLmdmeF9wYXJ0aXRpb25f
c2l6ZSA9IDEwMjQ7Ci0JCWFkZXYtPmdkcy5tZW0uY3NfcGFydGl0aW9uX3NpemUgPSAxMDI0Owot
Ci0JCWFkZXYtPmdkcy5nd3MuZ2Z4X3BhcnRpdGlvbl9zaXplID0gMTY7Ci0JCWFkZXYtPmdkcy5n
d3MuY3NfcGFydGl0aW9uX3NpemUgPSAxNjsKLQotCQlhZGV2LT5nZHMub2EuZ2Z4X3BhcnRpdGlv
bl9zaXplID0gNDsKLQkJYWRldi0+Z2RzLm9hLmNzX3BhcnRpdGlvbl9zaXplID0gNDsKLQl9CisJ
YWRldi0+Z2RzLmd3c19zaXplID0gNjQ7CisJYWRldi0+Z2RzLm9hX3NpemUgPSAxNjsKIH0KIAog
c3RhdGljIHZvaWQgZ2Z4X3Y5XzBfc2V0X3VzZXJfY3VfaW5hY3RpdmVfYml0bWFwKHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2LAotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2FtZC1nZng=
