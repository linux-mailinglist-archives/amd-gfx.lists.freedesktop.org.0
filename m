Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 196B248FE8
	for <lists+amd-gfx@lfdr.de>; Mon, 17 Jun 2019 21:46:22 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4D71889DD3;
	Mon, 17 Jun 2019 19:46:20 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qt1-x833.google.com (mail-qt1-x833.google.com
 [IPv6:2607:f8b0:4864:20::833])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 04EEE89DC5
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:46:16 +0000 (UTC)
Received: by mail-qt1-x833.google.com with SMTP id p15so12313581qtl.3
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 12:46:15 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=xwaJLbTeos1Ks9gJMQ23mSxEddmNY18b0ZvPGFtex5E=;
 b=cnxXp8yUJ9VxWxfgfoRIZtVpUXvVqNapGziBpCr0e7MGWu1cuna4qZBPbHaD3svufD
 HU9WCargw3bnznfxetP+fN5ap+B3FuG8XF1/UD414MwKDrDOOuDU+il0+53T1R3nTCEY
 oVr1EheviAarPyq1FMAJtRcHZF7u81gtvnALa70BOkLSILgjjtOIsYmf3JqIyjgvOFQc
 3FI9f12qSt4Qq6dJvRXiogTRwjQdgUMQB4yfQmelIMaMnqFasWSP1ZX2/6Xu9hTqSRmB
 syyE680RrYRI/SbFij5RuKqbv7l8lM3Ltt73TwZMMjAdM8QO7VFnA2eJorCoJdPMr/WC
 rPgQ==
X-Gm-Message-State: APjAAAWldkYZHo0k9VVXHPQquuXT7P3Gq/1pDDdZDjjYoCxt4pbe1/3H
 HVC3jlRI6b/MRZzqcqjFfsH31YTEKCc=
X-Google-Smtp-Source: APXvYqx8Ce8/AtheB4YrCD/rvQ42uXAsdVkvDBEJLwzT3PHg+sAtKEcUez04Newn0Xo7acBdz0kQnw==
X-Received: by 2002:ac8:35c2:: with SMTP id l2mr39169190qtb.123.1560800773295; 
 Mon, 17 Jun 2019 12:46:13 -0700 (PDT)
Received: from localhost.localdomain ([71.219.5.136])
 by smtp.gmail.com with ESMTPSA id u4sm6559420qkb.16.2019.06.17.12.46.09
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 12:46:12 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 321/459] drm/amd/display: Add DCN2 changes to DML
Date: Mon, 17 Jun 2019 14:44:22 -0500
Message-Id: <20190617194540.18497-22-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617194540.18497-1-alexander.deucher@amd.com>
References: <20190617194540.18497-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=xwaJLbTeos1Ks9gJMQ23mSxEddmNY18b0ZvPGFtex5E=;
 b=h0zW/nbwtZhEx76SX/PGzlENXM3nPGYiXOaygDovBrPFLxm9EyJ/RWKfrCCIX7Mc4N
 6KfTBthuV8Vgc6f2p5TcnVMVF17ll1nxVR2SXBejNCRs19wjlsoo+vtfvxKNyEeRpTlI
 7CdhSusQGF2Xy0G3iNRY3t9FwP1gSbwGopa5ndjjcUdmMvFfOaW0hZRHdwT2BTaIOk9o
 QrReK5STQ24ZXgnxzTOcHIR1ctUx+wpb4VfG342m17kWY3mvCeENEVJRQCHN4SXlIBDb
 HJgUNWhqc/BjDNo0QFhTMfGn4fN1Er1cggneumTieK8ti35BoQaXpP0Y64jxeeumGWkt
 6OaA==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>,
 Harry Wentland <harry.wentland@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogSGFycnkgV2VudGxhbmQgPGhhcnJ5LndlbnRsYW5kQGFtZC5jb20+CgpVcGRhdGUgRE1M
IChEaXNwbGF5IE1vZGUgTGliKSB0byBzdXBwb3J0IERDTjIKClNpZ25lZC1vZmYtYnk6IEhhcnJ5
IFdlbnRsYW5kIDxoYXJyeS53ZW50bGFuZEBhbWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBBbGV4IERl
dWNoZXIgPGFsZXhhbmRlci5kZXVjaGVyQGFtZC5jb20+Ci0tLQogLi4uL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvY2FsY3MvZGNuX2NhbGNzLmMgIHwgICAgNyArCiBkcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvZG1sL01ha2VmaWxlICAgfCAgIDE1ICstCiAuLi4vZGMvZG1sL2RjbjIwL2Rp
c3BsYXlfbW9kZV92YmFfMjAuYyAgICAgICAgfCA1MTA0ICsrKysrKysrKysrKysrKysrCiAuLi4v
ZGMvZG1sL2RjbjIwL2Rpc3BsYXlfbW9kZV92YmFfMjAuaCAgICAgICAgfCAgIDMyICsKIC4uLi9k
Yy9kbWwvZGNuMjAvZGlzcGxheV9ycV9kbGdfY2FsY18yMC5jICAgICB8IDE2OTggKysrKysrCiAu
Li4vZGMvZG1sL2RjbjIwL2Rpc3BsYXlfcnFfZGxnX2NhbGNfMjAuaCAgICAgfCAgIDcxICsKIC4u
Li9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV9saWIuYyB8ICAgMjIgKwogLi4u
L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5oIHwgICAyOSArLQogLi4u
L2FtZC9kaXNwbGF5L2RjL2RtbC9kaXNwbGF5X21vZGVfc3RydWN0cy5oIHwgICAyNiArCiAuLi4v
ZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kaXNwbGF5X21vZGVfdmJhLmMgfCAgODQ1ICsrKwogLi4u
L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX3ZiYS5oIHwgIDg0OCArKysKIDEx
IGZpbGVzIGNoYW5nZWQsIDg2OTMgaW5zZXJ0aW9ucygrKSwgNCBkZWxldGlvbnMoLSkKIGNyZWF0
ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2RjbjIwL2Rp
c3BsYXlfbW9kZV92YmFfMjAuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9kbWwvZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMC5oCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24yMC9kaXNwbGF5
X3JxX2RsZ19jYWxjXzIwLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvZG1sL2RjbjIwL2Rpc3BsYXlfcnFfZGxnX2NhbGNfMjAuaAogY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2Rl
X3ZiYS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2Rj
L2RtbC9kaXNwbGF5X21vZGVfdmJhLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvY2FsY3MvZGNuX2NhbGNzLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvY2FsY3MvZGNuX2NhbGNzLmMKaW5kZXggNWMxZTBhZGIxNDJiLi5lZjgwNDk0ODY5NGUg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9jYWxjcy9kY25fY2Fs
Y3MuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2FsY3MvZGNuX2NhbGNz
LmMKQEAgLTMxLDYgKzMxLDcgQEAKICNpbmNsdWRlICJyZXNvdXJjZS5oIgogI2luY2x1ZGUgImRj
bjEwL2RjbjEwX3Jlc291cmNlLmgiCiAjaW5jbHVkZSAiZGNuMTAvZGNuMTBfaHViYnViLmgiCisj
aW5jbHVkZSAiZG1sL2RtbDFfZGlzcGxheV9ycV9kbGdfY2FsYy5oIgogCiAjaW5jbHVkZSAiZGNu
X2NhbGNfbWF0aC5oIgogCkBAIC01Miw3ICs1MywxMyBAQAogICogcmVtYWluIGFzLWlzIGFzIGl0
IHByb3ZpZGVzIHVzIHdpdGggYSBndWFyYW50ZWUgZnJvbSBIVyB0aGF0IGl0IGlzIGNvcnJlY3Qu
CiAgKi8KIAorI2lmZGVmIENPTkZJR19EUk1fQU1EX0RDX0RDTjJfMAorLyogRGVmYXVsdHMgZnJv
bSBzcHJlYWRzaGVldCByZXYjMjQ3LgorICogUlYyIGRlbHRhOiBkcmFtX2Nsb2NrX2NoYW5nZV9s
YXRlbmN5LCBtYXhfbnVtX2RwcAorICovCisjZWxzZQogLyogRGVmYXVsdHMgZnJvbSBzcHJlYWRz
aGVldCByZXYjMjQ3ICovCisjZW5kaWYKIGNvbnN0IHN0cnVjdCBkY25fc29jX2JvdW5kaW5nX2Jv
eCBkY24xMF9zb2NfZGVmYXVsdHMgPSB7CiAJCS8qIGxhdGVuY2llcyAqLwogCQkuc3JfZXhpdF90
aW1lID0gMTcsIC8qdXMqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2RtbC9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvTWFr
ZWZpbGUKaW5kZXggZDk3Y2E2NTI4ZjlkLi43NDRmZWZiNjc3ODkgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9NYWtlZmlsZQpAQCAtMzMsMTMgKzMzLDI0IEBAIGVuZGlm
CiBkbWxfY2NmbGFncyA6PSAtbWhhcmQtZmxvYXQgLW1zc2UgJChjY19zdGFja19hbGlnbikKIAog
Q0ZMQUdTX2Rpc3BsYXlfbW9kZV9saWIubyA6PSAkKGRtbF9jY2ZsYWdzKQotQ0ZMQUdTX2Rpc3Bs
YXlfcGlwZV9jbG9ja3MubyA6PSAkKGRtbF9jY2ZsYWdzKQorQ0ZMQUdTX2Rpc3BsYXlfbW9kZV92
YmEubyA6PSAkKGRtbF9jY2ZsYWdzKQoraWZkZWYgQ09ORklHX0RSTV9BTURfRENfRENOMl8wCitD
RkxBR1NfZGlzcGxheV9tb2RlX3ZiYV8yMC5vIDo9ICQoZG1sX2NjZmxhZ3MpCitDRkxBR1NfZGlz
cGxheV9ycV9kbGdfY2FsY18yMC5vIDo9ICQoZG1sX2NjZmxhZ3MpCitlbmRpZgoraWZkZWYgQ09O
RklHX0RSTV9BTURfRENOM0FHCitDRkxBR1NfZGlzcGxheV9tb2RlX3ZiYV8zYWcubyA6PSAkKGRt
bF9jY2ZsYWdzKQorZW5kaWYKIENGTEFHU19kbWwxX2Rpc3BsYXlfcnFfZGxnX2NhbGMubyA6PSAk
KGRtbF9jY2ZsYWdzKQogQ0ZMQUdTX2Rpc3BsYXlfcnFfZGxnX2hlbHBlcnMubyA6PSAkKGRtbF9j
Y2ZsYWdzKQogQ0ZMQUdTX2RtbF9jb21tb25fZGVmcy5vIDo9ICQoZG1sX2NjZmxhZ3MpCiAKIERN
TCA9IGRpc3BsYXlfbW9kZV9saWIubyBkaXNwbGF5X3JxX2RsZ19oZWxwZXJzLm8gZG1sMV9kaXNw
bGF5X3JxX2RsZ19jYWxjLm8gXAotCWRtbF9jb21tb25fZGVmcy5vCisJZG1sX2NvbW1vbl9kZWZz
Lm8gZGlzcGxheV9tb2RlX3ZiYS5vCisKK2lmZGVmIENPTkZJR19EUk1fQU1EX0RDX0RDTjJfMAor
RE1MICs9IGRjbjIwL2Rpc3BsYXlfcnFfZGxnX2NhbGNfMjAubyBkY24yMC9kaXNwbGF5X21vZGVf
dmJhXzIwLm8KK2VuZGlmCiAKIEFNRF9EQUxfRE1MID0gJChhZGRwcmVmaXggJChBTUREQUxQQVRI
KS9kYy9kbWwvLCQoRE1MKSkKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNw
bGF5L2RjL2RtbC9kY24yMC9kaXNwbGF5X21vZGVfdmJhXzIwLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZG1sL2RjbjIwL2Rpc3BsYXlfbW9kZV92YmFfMjAuYwpuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmI3ZWRiMzljZDkwMgotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGNuMjAvZGlzcGxheV9t
b2RlX3ZiYV8yMC5jCkBAIC0wLDAgKzEsNTEwNCBAQAorLyoKKyAqIENvcHlyaWdodCAyMDE4IEFk
dmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KKyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBn
cmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29w
eSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRo
ZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJp
Y3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNl
LCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAor
ICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJz
b25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1Ympl
Y3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmln
aHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGlu
CisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4K
KyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5U
WSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1Qg
TElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNT
IEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZF
TlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFC
TEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgorICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVS
IElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsCisgKiBBUklTSU5H
IEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBV
U0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KKyAqCisgKiBBdXRob3Jz
OiBBTUQKKyAqCisgKi8KKworI2luY2x1ZGUgIi4uL2Rpc3BsYXlfbW9kZV9saWIuaCIKKyNpbmNs
dWRlICJkaXNwbGF5X21vZGVfdmJhXzIwLmgiCisjaW5jbHVkZSAiLi4vZG1sX2lubGluZV9kZWZz
LmgiCisKKy8qCisgKiBOT1RFOgorICogICBUaGlzIGZpbGUgaXMgZ2NjLXBhcnNlYWJsZSBIVyBn
b3NwZWwsIGNvbWluZyBzdHJhaWdodCBmcm9tIEhXIGVuZ2luZWVycy4KKyAqCisgKiBJdCBkb2Vz
bid0IGFkaGVyZSB0byBMaW51eCBrZXJuZWwgc3R5bGUgYW5kIHNvbWV0aW1lcyB3aWxsIGRvIHRo
aW5ncyBpbiBvZGQKKyAqIHdheXMuIFVubGVzcyB0aGVyZSBpcyBzb21ldGhpbmcgY2xlYXJseSB3
cm9uZyB3aXRoIGl0IHRoZSBjb2RlIHNob3VsZAorICogcmVtYWluIGFzLWlzIGFzIGl0IHByb3Zp
ZGVzIHVzIHdpdGggYSBndWFyYW50ZWUgZnJvbSBIVyB0aGF0IGl0IGlzIGNvcnJlY3QuCisgKi8K
KworI2RlZmluZSBCUFBfSU5WQUxJRCAwCisjZGVmaW5lIEJQUF9CTEVOREVEX1BJUEUgMHhmZmZm
ZmZmZgorCitzdGF0aWMgZG91YmxlIGFkanVzdF9SZXR1cm5CVygKKwkJc3RydWN0IGRpc3BsYXlf
bW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgUmV0dXJuQlcsCisJCWJvb2wgRENDRW5hYmxl
ZEFueVBsYW5lLAorCQlkb3VibGUgUmV0dXJuQmFuZHdpZHRoVG9EQ04pOworc3RhdGljIHVuc2ln
bmVkIGludCBkc2NjZUNvbXB1dGVEZWxheSgKKwkJdW5zaWduZWQgaW50IGJwYywKKwkJZG91Ymxl
IGJwcCwKKwkJdW5zaWduZWQgaW50IHNsaWNlV2lkdGgsCisJCXVuc2lnbmVkIGludCBudW1TbGlj
ZXMsCisJCWVudW0gb3V0cHV0X2Zvcm1hdF9jbGFzcyBwaXhlbEZvcm1hdCk7CitzdGF0aWMgdW5z
aWduZWQgaW50IGRzY0NvbXB1dGVEZWxheShlbnVtIG91dHB1dF9mb3JtYXRfY2xhc3MgcGl4ZWxG
b3JtYXQpOworLy8gU3VwZXIgbW9uc3RlciBmdW5jdGlvbiB3aXRoIHNvbWUgNDUgYXJndW1lbnQK
K3N0YXRpYyBib29sIENhbGN1bGF0ZVByZWZldGNoU2NoZWR1bGUoCisJCXN0cnVjdCBkaXNwbGF5
X21vZGVfbGliICptb2RlX2xpYiwKKwkJZG91YmxlIERQUENMSywKKwkJZG91YmxlIERJU1BDTEss
CisJCWRvdWJsZSBQaXhlbENsb2NrLAorCQlkb3VibGUgRENGQ0xLRGVlcFNsZWVwLAorCQl1bnNp
Z25lZCBpbnQgRFNDRGVsYXksCisJCXVuc2lnbmVkIGludCBEUFBQZXJQbGFuZSwKKwkJYm9vbCBT
Y2FsZXJFbmFibGVkLAorCQl1bnNpZ25lZCBpbnQgTnVtYmVyT2ZDdXJzb3JzLAorCQlkb3VibGUg
RFBQQ0xLRGVsYXlTdWJ0b3RhbCwKKwkJZG91YmxlIERQUENMS0RlbGF5U0NMLAorCQlkb3VibGUg
RFBQQ0xLRGVsYXlTQ0xMQk9ubHksCisJCWRvdWJsZSBEUFBDTEtEZWxheUNOVkNGb3JtYXRlciwK
KwkJZG91YmxlIERQUENMS0RlbGF5Q05WQ0N1cnNvciwKKwkJZG91YmxlIERJU1BDTEtEZWxheVN1
YnRvdGFsLAorCQl1bnNpZ25lZCBpbnQgU2NhbGVyUmVjb3V0V2lkdGgsCisJCWVudW0gb3V0cHV0
X2Zvcm1hdF9jbGFzcyBPdXRwdXRGb3JtYXQsCisJCXVuc2lnbmVkIGludCBWQmxhbmssCisJCXVu
c2lnbmVkIGludCBIVG90YWwsCisJCXVuc2lnbmVkIGludCBNYXhJbnRlckRDTlRpbGVSZXBlYXRl
cnMsCisJCXVuc2lnbmVkIGludCBWU3RhcnR1cCwKKwkJdW5zaWduZWQgaW50IFBhZ2VUYWJsZUxl
dmVscywKKwkJYm9vbCBHUFVWTUVuYWJsZSwKKwkJYm9vbCBEeW5hbWljTWV0YWRhdGFFbmFibGUs
CisJCXVuc2lnbmVkIGludCBEeW5hbWljTWV0YWRhdGFMaW5lc0JlZm9yZUFjdGl2ZVJlcXVpcmVk
LAorCQl1bnNpZ25lZCBpbnQgRHluYW1pY01ldGFkYXRhVHJhbnNtaXR0ZWRCeXRlcywKKwkJYm9v
bCBEQ0NFbmFibGUsCisJCWRvdWJsZSBVcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seSwKKwkJZG91
YmxlIFVyZ2VudEV4dHJhTGF0ZW5jeSwKKwkJZG91YmxlIFRDYWxjLAorCQl1bnNpZ25lZCBpbnQg
UERFQW5kTWV0YVBURUJ5dGVzRnJhbWUsCisJCXVuc2lnbmVkIGludCBNZXRhUm93Qnl0ZSwKKwkJ
dW5zaWduZWQgaW50IFBpeGVsUFRFQnl0ZXNQZXJSb3csCisJCWRvdWJsZSBQcmVmZXRjaFNvdXJj
ZUxpbmVzWSwKKwkJdW5zaWduZWQgaW50IFN3YXRoV2lkdGhZLAorCQlkb3VibGUgQnl0ZVBlclBp
eGVsREVUWSwKKwkJZG91YmxlIFZJbml0UHJlRmlsbFksCisJCXVuc2lnbmVkIGludCBNYXhOdW1T
d2F0aFksCisJCWRvdWJsZSBQcmVmZXRjaFNvdXJjZUxpbmVzQywKKwkJZG91YmxlIEJ5dGVQZXJQ
aXhlbERFVEMsCisJCWRvdWJsZSBWSW5pdFByZUZpbGxDLAorCQl1bnNpZ25lZCBpbnQgTWF4TnVt
U3dhdGhDLAorCQl1bnNpZ25lZCBpbnQgU3dhdGhIZWlnaHRZLAorCQl1bnNpZ25lZCBpbnQgU3dh
dGhIZWlnaHRDLAorCQlkb3VibGUgVFdhaXQsCisJCWJvb2wgWEZDRW5hYmxlZCwKKwkJZG91Ymxl
IFhGQ1JlbW90ZVN1cmZhY2VGbGlwRGVsYXksCisJCWJvb2wgSW50ZXJsYWNlRW5hYmxlLAorCQli
b29sIFByb2dyZXNzaXZlVG9JbnRlcmxhY2VVbml0SW5PUFAsCisJCWRvdWJsZSAqRFNUWEFmdGVy
U2NhbGVyLAorCQlkb3VibGUgKkRTVFlBZnRlclNjYWxlciwKKwkJZG91YmxlICpEZXN0aW5hdGlv
bkxpbmVzRm9yUHJlZmV0Y2gsCisJCWRvdWJsZSAqUHJlZmV0Y2hCYW5kd2lkdGgsCisJCWRvdWJs
ZSAqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxhbmssCisJCWRvdWJsZSAqRGVzdGlu
YXRpb25MaW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rLAorCQlkb3VibGUgKlZSYXRpb1ByZWZldGNo
WSwKKwkJZG91YmxlICpWUmF0aW9QcmVmZXRjaEMsCisJCWRvdWJsZSAqUmVxdWlyZWRQcmVmZXRj
aFBpeERhdGFCVywKKwkJdW5zaWduZWQgaW50ICpWU3RhcnR1cFJlcXVpcmVkV2hlbk5vdEVub3Vn
aFRpbWVGb3JEeW5hbWljTWV0YWRhdGEsCisJCWRvdWJsZSAqVG5vX2J3LAorCQl1bnNpZ25lZCBp
bnQgKlZVcGRhdGVPZmZzZXRQaXgsCisJCWRvdWJsZSAqVlVwZGF0ZVdpZHRoUGl4LAorCQlkb3Vi
bGUgKlZSZWFkeU9mZnNldFBpeCk7CitzdGF0aWMgZG91YmxlIFJvdW5kVG9ERlNHcmFudWxhcml0
eVVwKGRvdWJsZSBDbG9jaywgZG91YmxlIFZDT1NwZWVkKTsKK3N0YXRpYyBkb3VibGUgUm91bmRU
b0RGU0dyYW51bGFyaXR5RG93bihkb3VibGUgQ2xvY2ssIGRvdWJsZSBWQ09TcGVlZCk7CitzdGF0
aWMgZG91YmxlIENhbGN1bGF0ZVByZWZldGNoU291cmNlTGluZXMoCisJCXN0cnVjdCBkaXNwbGF5
X21vZGVfbGliICptb2RlX2xpYiwKKwkJZG91YmxlIFZSYXRpbywKKwkJZG91YmxlIHZ0YXBzLAor
CQlib29sIEludGVybGFjZSwKKwkJYm9vbCBQcm9ncmVzc2l2ZVRvSW50ZXJsYWNlVW5pdEluT1BQ
LAorCQl1bnNpZ25lZCBpbnQgU3dhdGhIZWlnaHQsCisJCXVuc2lnbmVkIGludCBWaWV3cG9ydFlT
dGFydCwKKwkJZG91YmxlICpWSW5pdFByZUZpbGwsCisJCXVuc2lnbmVkIGludCAqTWF4TnVtU3dh
dGgpOworc3RhdGljIHVuc2lnbmVkIGludCBDYWxjdWxhdGVWTUFuZFJvd0J5dGVzKAorCQlzdHJ1
Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWJvb2wgRENDRW5hYmxlLAorCQl1bnNp
Z25lZCBpbnQgQmxvY2tIZWlnaHQyNTZCeXRlcywKKwkJdW5zaWduZWQgaW50IEJsb2NrV2lkdGgy
NTZCeXRlcywKKwkJZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNzIFNvdXJjZVBpeGVsRm9ybWF0LAor
CQl1bnNpZ25lZCBpbnQgU3VyZmFjZVRpbGluZywKKwkJdW5zaWduZWQgaW50IEJ5dGVQZXJQaXhl
bCwKKwkJZW51bSBzY2FuX2RpcmVjdGlvbl9jbGFzcyBTY2FuRGlyZWN0aW9uLAorCQl1bnNpZ25l
ZCBpbnQgVmlld3BvcnRXaWR0aCwKKwkJdW5zaWduZWQgaW50IFZpZXdwb3J0SGVpZ2h0LAorCQl1
bnNpZ25lZCBpbnQgU3dhdGhXaWR0aFksCisJCWJvb2wgR1BVVk1FbmFibGUsCisJCXVuc2lnbmVk
IGludCBWTU1QYWdlU2l6ZSwKKwkJdW5zaWduZWQgaW50IFBURUJ1ZmZlclNpemVJblJlcXVlc3Rz
THVtYSwKKwkJdW5zaWduZWQgaW50IFBERVByb2Nlc3NpbmdCdWZJbjY0S0JSZXFzLAorCQl1bnNp
Z25lZCBpbnQgUGl0Y2gsCisJCXVuc2lnbmVkIGludCBEQ0NNZXRhUGl0Y2gsCisJCXVuc2lnbmVk
IGludCAqTWFjcm9UaWxlV2lkdGgsCisJCXVuc2lnbmVkIGludCAqTWV0YVJvd0J5dGUsCisJCXVu
c2lnbmVkIGludCAqUGl4ZWxQVEVCeXRlc1BlclJvdywKKwkJYm9vbCAqUFRFQnVmZmVyU2l6ZU5v
dEV4Y2VlZGVkLAorCQl1bnNpZ25lZCBpbnQgKmRwdGVfcm93X2hlaWdodCwKKwkJdW5zaWduZWQg
aW50ICptZXRhX3Jvd19oZWlnaHQpOworc3RhdGljIGRvdWJsZSBDYWxjdWxhdGVUV2FpdCgKKwkJ
dW5zaWduZWQgaW50IFByZWZldGNoTW9kZSwKKwkJZG91YmxlIERSQU1DbG9ja0NoYW5nZUxhdGVu
Y3ksCisJCWRvdWJsZSBVcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seSwKKwkJZG91YmxlIFNSRW50
ZXJQbHVzRXhpdFRpbWUpOworc3RhdGljIGRvdWJsZSBDYWxjdWxhdGVSZW1vdGVTdXJmYWNlRmxp
cERlbGF5KAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRvdWJsZSBW
UmF0aW8sCisJCWRvdWJsZSBTd2F0aFdpZHRoLAorCQlkb3VibGUgQnBwLAorCQlkb3VibGUgTGlu
ZVRpbWUsCisJCWRvdWJsZSBYRkNUU2x2VnVwZGF0ZU9mZnNldCwKKwkJZG91YmxlIFhGQ1RTbHZW
dXBkYXRlV2lkdGgsCisJCWRvdWJsZSBYRkNUU2x2VnJlYWR5T2Zmc2V0LAorCQlkb3VibGUgWEZD
WEJVRkxhdGVuY3lUb2xlcmFuY2UsCisJCWRvdWJsZSBYRkNGaWxsQldPdmVyaGVhZCwKKwkJZG91
YmxlIFhGQ1NsdkNodW5rU2l6ZSwKKwkJZG91YmxlIFhGQ0J1c1RyYW5zcG9ydFRpbWUsCisJCWRv
dWJsZSBUQ2FsYywKKwkJZG91YmxlIFRXYWl0LAorCQlkb3VibGUgKlNyY0FjdGl2ZURyYWluUmF0
ZSwKKwkJZG91YmxlICpUSW5pdFhGaWxsLAorCQlkb3VibGUgKlRzbHZDaGspOworc3RhdGljIHZv
aWQgQ2FsY3VsYXRlQWN0aXZlUm93QmFuZHdpZHRoKAorCQlib29sIEdQVVZNRW5hYmxlLAorCQll
bnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MgU291cmNlUGl4ZWxGb3JtYXQsCisJCWRvdWJsZSBWUmF0
aW8sCisJCWJvb2wgRENDRW5hYmxlLAorCQlkb3VibGUgTGluZVRpbWUsCisJCXVuc2lnbmVkIGlu
dCBNZXRhUm93Qnl0ZUx1bWEsCisJCXVuc2lnbmVkIGludCBNZXRhUm93Qnl0ZUNocm9tYSwKKwkJ
dW5zaWduZWQgaW50IG1ldGFfcm93X2hlaWdodF9sdW1hLAorCQl1bnNpZ25lZCBpbnQgbWV0YV9y
b3dfaGVpZ2h0X2Nocm9tYSwKKwkJdW5zaWduZWQgaW50IFBpeGVsUFRFQnl0ZXNQZXJSb3dMdW1h
LAorCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVCeXRlc1BlclJvd0Nocm9tYSwKKwkJdW5zaWduZWQg
aW50IGRwdGVfcm93X2hlaWdodF9sdW1hLAorCQl1bnNpZ25lZCBpbnQgZHB0ZV9yb3dfaGVpZ2h0
X2Nocm9tYSwKKwkJZG91YmxlICptZXRhX3Jvd19idywKKwkJZG91YmxlICpkcHRlX3Jvd19idywK
KwkJZG91YmxlICpxdWFsX3Jvd19idyk7CitzdGF0aWMgdm9pZCBDYWxjdWxhdGVGbGlwU2NoZWR1
bGUoCisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJZG91YmxlIFVyZ2Vu
dEV4dHJhTGF0ZW5jeSwKKwkJZG91YmxlIFVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5LAorCQl1
bnNpZ25lZCBpbnQgR1BVVk1NYXhQYWdlVGFibGVMZXZlbHMsCisJCWJvb2wgR1BVVk1FbmFibGUs
CisJCWRvdWJsZSBCYW5kd2lkdGhBdmFpbGFibGVGb3JJbW1lZGlhdGVGbGlwLAorCQl1bnNpZ25l
ZCBpbnQgVG90SW1tZWRpYXRlRmxpcEJ5dGVzLAorCQllbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3Mg
U291cmNlUGl4ZWxGb3JtYXQsCisJCXVuc2lnbmVkIGludCBJbW1lZGlhdGVGbGlwQnl0ZXMsCisJ
CWRvdWJsZSBMaW5lVGltZSwKKwkJZG91YmxlIFZSYXRpbywKKwkJZG91YmxlIFRub19idywKKwkJ
ZG91YmxlIFBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lLAorCQl1bnNpZ25lZCBpbnQgTWV0YVJvd0J5
dGUsCisJCXVuc2lnbmVkIGludCBQaXhlbFBURUJ5dGVzUGVyUm93LAorCQlib29sIERDQ0VuYWJs
ZSwKKwkJdW5zaWduZWQgaW50IGRwdGVfcm93X2hlaWdodCwKKwkJdW5zaWduZWQgaW50IG1ldGFf
cm93X2hlaWdodCwKKwkJZG91YmxlIHF1YWxfcm93X2J3LAorCQlkb3VibGUgKkRlc3RpbmF0aW9u
TGluZXNUb1JlcXVlc3RWTUluSW1tZWRpYXRlRmxpcCwKKwkJZG91YmxlICpEZXN0aW5hdGlvbkxp
bmVzVG9SZXF1ZXN0Um93SW5JbW1lZGlhdGVGbGlwLAorCQlkb3VibGUgKmZpbmFsX2ZsaXBfYncs
CisJCWJvb2wgKkltbWVkaWF0ZUZsaXBTdXBwb3J0ZWRGb3JQaXBlKTsKK3N0YXRpYyBkb3VibGUg
Q2FsY3VsYXRlV3JpdGVCYWNrRGVsYXkoCisJCWVudW0gc291cmNlX2Zvcm1hdF9jbGFzcyBXcml0
ZWJhY2tQaXhlbEZvcm1hdCwKKwkJZG91YmxlIFdyaXRlYmFja0hSYXRpbywKKwkJZG91YmxlIFdy
aXRlYmFja1ZSYXRpbywKKwkJdW5zaWduZWQgaW50IFdyaXRlYmFja0x1bWFIVGFwcywKKwkJdW5z
aWduZWQgaW50IFdyaXRlYmFja0x1bWFWVGFwcywKKwkJdW5zaWduZWQgaW50IFdyaXRlYmFja0No
cm9tYUhUYXBzLAorCQl1bnNpZ25lZCBpbnQgV3JpdGViYWNrQ2hyb21hVlRhcHMsCisJCXVuc2ln
bmVkIGludCBXcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoKTsKKworc3RhdGljIHZvaWQgZG1sMjBf
RGlzcGxheVBpcGVDb25maWd1cmF0aW9uKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xp
Yik7CitzdGF0aWMgdm9pZCBkbWwyMF9ESVNQQ0xLRFBQQ0xLRENGQ0xLRGVlcFNsZWVwUHJlZmV0
Y2hQYXJhbWV0ZXJzV2F0ZXJtYXJrc0FuZFBlcmZvcm1hbmNlQ2FsY3VsYXRpb24oCisJCXN0cnVj
dCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYik7CisKK3ZvaWQgZG1sMjBfcmVjYWxjdWxhdGUo
c3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliKQoreworCU1vZGVTdXBwb3J0QW5kU3lz
dGVtQ29uZmlndXJhdGlvbihtb2RlX2xpYik7CisJbW9kZV9saWItPnZiYS5GYWJyaWNBbmREUkFN
QmFuZHdpZHRoID0gZG1sX21pbigKKwkJbW9kZV9saWItPnZiYS5EUkFNU3BlZWQgKiBtb2RlX2xp
Yi0+dmJhLk51bWJlck9mQ2hhbm5lbHMgKiBtb2RlX2xpYi0+dmJhLkRSQU1DaGFubmVsV2lkdGgs
CisJCW1vZGVfbGliLT52YmEuRmFicmljQ2xvY2sgKiBtb2RlX2xpYi0+dmJhLkZhYnJpY0RhdGFw
YXRoVG9EQ05EYXRhUmV0dXJuKSAvIDEwMDAuMDsKKwlQaXhlbENsb2NrQWRqdXN0bWVudEZvclBy
b2dyZXNzaXZlVG9JbnRlcmxhY2VVbml0KG1vZGVfbGliKTsKKwlkbWwyMF9EaXNwbGF5UGlwZUNv
bmZpZ3VyYXRpb24obW9kZV9saWIpOworCWRtbDIwX0RJU1BDTEtEUFBDTEtEQ0ZDTEtEZWVwU2xl
ZXBQcmVmZXRjaFBhcmFtZXRlcnNXYXRlcm1hcmtzQW5kUGVyZm9ybWFuY2VDYWxjdWxhdGlvbiht
b2RlX2xpYik7Cit9CisKK3N0YXRpYyBkb3VibGUgYWRqdXN0X1JldHVybkJXKAorCQlzdHJ1Y3Qg
ZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRvdWJsZSBSZXR1cm5CVywKKwkJYm9vbCBE
Q0NFbmFibGVkQW55UGxhbmUsCisJCWRvdWJsZSBSZXR1cm5CYW5kd2lkdGhUb0RDTikKK3sKKwlk
b3VibGUgQ3JpdGljYWxDb21wcmVzc2lvbjsKKworCWlmIChEQ0NFbmFibGVkQW55UGxhbmUKKwkJ
CSYmIFJldHVybkJhbmR3aWR0aFRvRENOCisJCQkJCT4gbW9kZV9saWItPnZiYS5EQ0ZDTEsgKiBt
b2RlX2xpYi0+dmJhLlJldHVybkJ1c1dpZHRoIC8gNC4wKQorCQlSZXR1cm5CVyA9CisJCQkJZG1s
X21pbigKKwkJCQkJCVJldHVybkJXLAorCQkJCQkJUmV0dXJuQmFuZHdpZHRoVG9EQ04gKiA0CisJ
CQkJCQkJCSogKDEuMAorCQkJCQkJCQkJCS0gbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5UGl4
ZWxEYXRhT25seQorCQkJCQkJCQkJCQkJLyAoKG1vZGVfbGliLT52YmEuUk9CQnVmZmVyU2l6ZUlu
S0J5dGUKKwkJCQkJCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLlBpeGVsQ2h1bmtTaXplSW5LQnl0
ZSkKKwkJCQkJCQkJCQkJCQkJKiAxMDI0CisJCQkJCQkJCQkJCQkJCS8gUmV0dXJuQmFuZHdpZHRo
VG9EQ04KKwkJCQkJCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLkRDRkNMSworCQkJCQkJCQkJCQkJ
CQkJCSogbW9kZV9saWItPnZiYS5SZXR1cm5CdXNXaWR0aAorCQkJCQkJCQkJCQkJCQkJCS8gNCkK
KwkJCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeVBpeGVsRGF0YU9ubHkpKTsK
KworCUNyaXRpY2FsQ29tcHJlc3Npb24gPSAyLjAgKiBtb2RlX2xpYi0+dmJhLlJldHVybkJ1c1dp
ZHRoICogbW9kZV9saWItPnZiYS5EQ0ZDTEsKKwkJCSogbW9kZV9saWItPnZiYS5VcmdlbnRMYXRl
bmN5UGl4ZWxEYXRhT25seQorCQkJLyAoUmV0dXJuQmFuZHdpZHRoVG9EQ04gKiBtb2RlX2xpYi0+
dmJhLlVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5CisJCQkJCSsgKG1vZGVfbGliLT52YmEuUk9C
QnVmZmVyU2l6ZUluS0J5dGUKKwkJCQkJCQktIG1vZGVfbGliLT52YmEuUGl4ZWxDaHVua1NpemVJ
bktCeXRlKQorCQkJCQkJCSogMTAyNCk7CisKKwlpZiAoRENDRW5hYmxlZEFueVBsYW5lICYmIENy
aXRpY2FsQ29tcHJlc3Npb24gPiAxLjAgJiYgQ3JpdGljYWxDb21wcmVzc2lvbiA8IDQuMCkKKwkJ
UmV0dXJuQlcgPQorCQkJCWRtbF9taW4oCisJCQkJCQlSZXR1cm5CVywKKwkJCQkJCTQuMCAqIFJl
dHVybkJhbmR3aWR0aFRvRENOCisJCQkJCQkJCSogKG1vZGVfbGliLT52YmEuUk9CQnVmZmVyU2l6
ZUluS0J5dGUKKwkJCQkJCQkJCQktIG1vZGVfbGliLT52YmEuUGl4ZWxDaHVua1NpemVJbktCeXRl
KQorCQkJCQkJCQkqIDEwMjQKKwkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlJldHVybkJ1c1dpZHRo
CisJCQkJCQkJCSogbW9kZV9saWItPnZiYS5EQ0ZDTEsKKwkJCQkJCQkJKiBtb2RlX2xpYi0+dmJh
LlVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5CisJCQkJCQkJCS8gZG1sX3BvdygKKwkJCQkJCQkJ
CQkoUmV0dXJuQmFuZHdpZHRoVG9EQ04KKwkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5Vcmdl
bnRMYXRlbmN5UGl4ZWxEYXRhT25seQorCQkJCQkJCQkJCQkJKyAobW9kZV9saWItPnZiYS5ST0JC
dWZmZXJTaXplSW5LQnl0ZQorCQkJCQkJCQkJCQkJCQktIG1vZGVfbGliLT52YmEuUGl4ZWxDaHVu
a1NpemVJbktCeXRlKQorCQkJCQkJCQkJCQkJCQkqIDEwMjQpLAorCQkJCQkJCQkJCTIpKTsKKwor
CXJldHVybiBSZXR1cm5CVzsKK30KKworc3RhdGljIHVuc2lnbmVkIGludCBkc2NjZUNvbXB1dGVE
ZWxheSgKKwkJdW5zaWduZWQgaW50IGJwYywKKwkJZG91YmxlIGJwcCwKKwkJdW5zaWduZWQgaW50
IHNsaWNlV2lkdGgsCisJCXVuc2lnbmVkIGludCBudW1TbGljZXMsCisJCWVudW0gb3V0cHV0X2Zv
cm1hdF9jbGFzcyBwaXhlbEZvcm1hdCkKK3sKKwkvLyB2YWxpZCBicGMgICAgICAgICA9IHNvdXJj
ZSBiaXRzIHBlciBjb21wb25lbnQgaW4gdGhlIHNldCBvZiB7OCwgMTAsIDEyfQorCS8vIHZhbGlk
IGJwcCAgICAgICAgID0gaW5jcmVtZW50cyBvZiAxLzE2IG9mIGEgYml0CisJLy8gICAgICAgICAg
ICAgICAgICAgIG1pbiA9IDYvNy84IGluIE40MjAvTjQyMi80NDQsIHJlc3BlY3RpdmVseQorCS8v
ICAgICAgICAgICAgICAgICAgICBtYXggPSBzdWNoIHRoYXQgY29tcHJlc3Npb24gaXMgMToxCisJ
Ly92YWxpZCBzbGljZVdpZHRoICA9IG51bWJlciBvZiBwaXhlbHMgcGVyIHNsaWNlIGxpbmUsIG11
c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIDUxODQvbnVtU2xpY2VzIChvciA0MDk2L251bVNs
aWNlcyBpbiA0MjAgbW9kZSkKKwkvL3ZhbGlkIG51bVNsaWNlcyAgID0gbnVtYmVyIG9mIHNsaWNl
cyBpbiB0aGUgaG9yaXppb250YWwgZGlyZWN0aW9uIHBlciBEU0MgZW5naW5lIGluIHRoZSBzZXQg
b2YgezEsIDIsIDMsIDR9CisJLy92YWxpZCBwaXhlbEZvcm1hdCA9IHBpeGVsL2NvbG9yIGZvcm1h
dCBpbiB0aGUgc2V0IG9mIHs6TjQ0NF9SR0IsIDpTNDIyLCA6TjQyMiwgOk40MjB9CisKKwkvLyBm
aXhlZCB2YWx1ZQorCXVuc2lnbmVkIGludCByY01vZGVsU2l6ZSA9IDgxOTI7CisKKwkvLyBONDIy
L040MjAgb3BlcmF0ZSBhdCAyIHBpeGVscyBwZXIgY2xvY2sKKwl1bnNpZ25lZCBpbnQgcGl4ZWxz
UGVyQ2xvY2ssIGxzdGFsbCwgRCwgaW5pdGFsWG1pdERlbGF5LCB3LCBzLCBpeCwgd3gsIHAsIGww
LCBhLCBheCwgbCwKKwkJCURlbGF5LCBwaXhlbHM7CisKKwlpZiAocGl4ZWxGb3JtYXQgPT0gZG1f
bjQyMiB8fCBwaXhlbEZvcm1hdCA9PSBkbV80MjApCisJCXBpeGVsc1BlckNsb2NrID0gMjsKKwkv
LyAjYWxsIG90aGVyIG1vZGVzIG9wZXJhdGUgYXQgMSBwaXhlbCBwZXIgY2xvY2sKKwllbHNlCisJ
CXBpeGVsc1BlckNsb2NrID0gMTsKKworCS8vaW5pdGlhbCB0cmFuc21pdCBkZWxheSBhcyBwZXIg
UFBTCisJaW5pdGFsWG1pdERlbGF5ID0gZG1sX3JvdW5kKHJjTW9kZWxTaXplIC8gMi4wIC8gYnBw
IC8gcGl4ZWxzUGVyQ2xvY2spOworCisJLy9jb21wdXRlIHNzbSBkZWxheQorCWlmIChicGMgPT0g
OCkKKwkJRCA9IDgxOworCWVsc2UgaWYgKGJwYyA9PSAxMCkKKwkJRCA9IDg5OworCWVsc2UKKwkJ
RCA9IDExMzsKKworCS8vZGl2aWRlIGJ5IHBpeGVsIHBlciBjeWNsZSB0byBjb21wdXRlIHNsaWNl
IHdpZHRoIGFzIHNlZW4gYnkgRFNDCisJdyA9IHNsaWNlV2lkdGggLyBwaXhlbHNQZXJDbG9jazsK
KworCS8vNDIyIG1vZGUgaGFzIGFuIGFkZGl0aW9uYWwgY3ljbGUgb2YgZGVsYXkKKwlpZiAocGl4
ZWxGb3JtYXQgPT0gZG1fczQyMikKKwkJcyA9IDE7CisJZWxzZQorCQlzID0gMDsKKworCS8vbWFp
biBjYWxjdWxhdGlvbiBmb3IgdGhlIGRzY2NlCisJaXggPSBpbml0YWxYbWl0RGVsYXkgKyA0NTsK
Kwl3eCA9ICh3ICsgMikgLyAzOworCXAgPSAzICogd3ggLSB3OworCWwwID0gaXggLyB3OworCWEg
PSBpeCArIHAgKiBsMDsKKwlheCA9IChhICsgMikgLyAzICsgRCArIDYgKyAxOworCWwgPSAoYXgg
KyB3eCAtIDEpIC8gd3g7CisJaWYgKChpeCAlIHcpID09IDAgJiYgcCAhPSAwKQorCQlsc3RhbGwg
PSAxOworCWVsc2UKKwkJbHN0YWxsID0gMDsKKwlEZWxheSA9IGwgKiB3eCAqIChudW1TbGljZXMg
LSAxKSArIGF4ICsgcyArIGxzdGFsbCArIDIyOworCisJLy9kc2MgcHJvY2Vzc2VzIDMgcGl4ZWwg
Y29udGFpbmVycyBwZXIgY3ljbGUgYW5kIGEgY29udGFpbmVyIGNhbiBjb250YWluIDEgb3IgMiBw
aXhlbHMKKwlwaXhlbHMgPSBEZWxheSAqIDMgKiBwaXhlbHNQZXJDbG9jazsKKwlyZXR1cm4gcGl4
ZWxzOworfQorCitzdGF0aWMgdW5zaWduZWQgaW50IGRzY0NvbXB1dGVEZWxheShlbnVtIG91dHB1
dF9mb3JtYXRfY2xhc3MgcGl4ZWxGb3JtYXQpCit7CisJdW5zaWduZWQgaW50IERlbGF5ID0gMDsK
KworCWlmIChwaXhlbEZvcm1hdCA9PSBkbV80MjApIHsKKwkJLy8gICBzZnIKKwkJRGVsYXkgPSBE
ZWxheSArIDI7CisJCS8vICAgZHNjY2lmCisJCURlbGF5ID0gRGVsYXkgKyAwOworCQkvLyAgIGRz
Y2MgLSBpbnB1dCBkZXNlcmlhbGl6ZXIKKwkJRGVsYXkgPSBEZWxheSArIDM7CisJCS8vICAgZHNj
YyBnZXRzIHBpeGVscyBldmVyeSBvdGhlciBjeWNsZQorCQlEZWxheSA9IERlbGF5ICsgMjsKKwkJ
Ly8gICBkc2NjIC0gaW5wdXQgY2RjIGZpZm8KKwkJRGVsYXkgPSBEZWxheSArIDEyOworCQkvLyAg
IGRzY2MgZ2V0cyBwaXhlbHMgZXZlcnkgb3RoZXIgY3ljbGUKKwkJRGVsYXkgPSBEZWxheSArIDEz
OworCQkvLyAgIGRzY2MgLSBjZGMgdW5jZXJ0YWludHkKKwkJRGVsYXkgPSBEZWxheSArIDI7CisJ
CS8vICAgZHNjYyAtIG91dHB1dCBjZGMgZmlmbworCQlEZWxheSA9IERlbGF5ICsgNzsKKwkJLy8g
ICBkc2NjIGdldHMgcGl4ZWxzIGV2ZXJ5IG90aGVyIGN5Y2xlCisJCURlbGF5ID0gRGVsYXkgKyAz
OworCQkvLyAgIGRzY2MgLSBjZGMgdW5jZXJ0YWludHkKKwkJRGVsYXkgPSBEZWxheSArIDI7CisJ
CS8vICAgZHNjYyAtIG91dHB1dCBzZXJpYWxpemVyCisJCURlbGF5ID0gRGVsYXkgKyAxOworCQkv
LyAgIHNmdAorCQlEZWxheSA9IERlbGF5ICsgMTsKKwl9IGVsc2UgaWYgKHBpeGVsRm9ybWF0ID09
IGRtX240MjIpIHsKKwkJLy8gICBzZnIKKwkJRGVsYXkgPSBEZWxheSArIDI7CisJCS8vICAgZHNj
Y2lmCisJCURlbGF5ID0gRGVsYXkgKyAxOworCQkvLyAgIGRzY2MgLSBpbnB1dCBkZXNlcmlhbGl6
ZXIKKwkJRGVsYXkgPSBEZWxheSArIDU7CisJCS8vICBkc2NjIC0gaW5wdXQgY2RjIGZpZm8KKwkJ
RGVsYXkgPSBEZWxheSArIDI1OworCQkvLyAgIGRzY2MgLSBjZGMgdW5jZXJ0YWludHkKKwkJRGVs
YXkgPSBEZWxheSArIDI7CisJCS8vICAgZHNjYyAtIG91dHB1dCBjZGMgZmlmbworCQlEZWxheSA9
IERlbGF5ICsgMTA7CisJCS8vICAgZHNjYyAtIGNkYyB1bmNlcnRhaW50eQorCQlEZWxheSA9IERl
bGF5ICsgMjsKKwkJLy8gICBkc2NjIC0gb3V0cHV0IHNlcmlhbGl6ZXIKKwkJRGVsYXkgPSBEZWxh
eSArIDE7CisJCS8vICAgc2Z0CisJCURlbGF5ID0gRGVsYXkgKyAxOworCX0gZWxzZSB7CisJCS8v
ICAgc2ZyCisJCURlbGF5ID0gRGVsYXkgKyAyOworCQkvLyAgIGRzY2NpZgorCQlEZWxheSA9IERl
bGF5ICsgMDsKKwkJLy8gICBkc2NjIC0gaW5wdXQgZGVzZXJpYWxpemVyCisJCURlbGF5ID0gRGVs
YXkgKyAzOworCQkvLyAgIGRzY2MgLSBpbnB1dCBjZGMgZmlmbworCQlEZWxheSA9IERlbGF5ICsg
MTI7CisJCS8vICAgZHNjYyAtIGNkYyB1bmNlcnRhaW50eQorCQlEZWxheSA9IERlbGF5ICsgMjsK
KwkJLy8gICBkc2NjIC0gb3V0cHV0IGNkYyBmaWZvCisJCURlbGF5ID0gRGVsYXkgKyA3OworCQkv
LyAgIGRzY2MgLSBvdXRwdXQgc2VyaWFsaXplcgorCQlEZWxheSA9IERlbGF5ICsgMTsKKwkJLy8g
ICBkc2NjIC0gY2RjIHVuY2VydGFpbnR5CisJCURlbGF5ID0gRGVsYXkgKyAyOworCQkvLyAgIHNm
dAorCQlEZWxheSA9IERlbGF5ICsgMTsKKwl9CisKKwlyZXR1cm4gRGVsYXk7Cit9CisKK3N0YXRp
YyBib29sIENhbGN1bGF0ZVByZWZldGNoU2NoZWR1bGUoCisJCXN0cnVjdCBkaXNwbGF5X21vZGVf
bGliICptb2RlX2xpYiwKKwkJZG91YmxlIERQUENMSywKKwkJZG91YmxlIERJU1BDTEssCisJCWRv
dWJsZSBQaXhlbENsb2NrLAorCQlkb3VibGUgRENGQ0xLRGVlcFNsZWVwLAorCQl1bnNpZ25lZCBp
bnQgRFNDRGVsYXksCisJCXVuc2lnbmVkIGludCBEUFBQZXJQbGFuZSwKKwkJYm9vbCBTY2FsZXJF
bmFibGVkLAorCQl1bnNpZ25lZCBpbnQgTnVtYmVyT2ZDdXJzb3JzLAorCQlkb3VibGUgRFBQQ0xL
RGVsYXlTdWJ0b3RhbCwKKwkJZG91YmxlIERQUENMS0RlbGF5U0NMLAorCQlkb3VibGUgRFBQQ0xL
RGVsYXlTQ0xMQk9ubHksCisJCWRvdWJsZSBEUFBDTEtEZWxheUNOVkNGb3JtYXRlciwKKwkJZG91
YmxlIERQUENMS0RlbGF5Q05WQ0N1cnNvciwKKwkJZG91YmxlIERJU1BDTEtEZWxheVN1YnRvdGFs
LAorCQl1bnNpZ25lZCBpbnQgU2NhbGVyUmVjb3V0V2lkdGgsCisJCWVudW0gb3V0cHV0X2Zvcm1h
dF9jbGFzcyBPdXRwdXRGb3JtYXQsCisJCXVuc2lnbmVkIGludCBWQmxhbmssCisJCXVuc2lnbmVk
IGludCBIVG90YWwsCisJCXVuc2lnbmVkIGludCBNYXhJbnRlckRDTlRpbGVSZXBlYXRlcnMsCisJ
CXVuc2lnbmVkIGludCBWU3RhcnR1cCwKKwkJdW5zaWduZWQgaW50IFBhZ2VUYWJsZUxldmVscywK
KwkJYm9vbCBHUFVWTUVuYWJsZSwKKwkJYm9vbCBEeW5hbWljTWV0YWRhdGFFbmFibGUsCisJCXVu
c2lnbmVkIGludCBEeW5hbWljTWV0YWRhdGFMaW5lc0JlZm9yZUFjdGl2ZVJlcXVpcmVkLAorCQl1
bnNpZ25lZCBpbnQgRHluYW1pY01ldGFkYXRhVHJhbnNtaXR0ZWRCeXRlcywKKwkJYm9vbCBEQ0NF
bmFibGUsCisJCWRvdWJsZSBVcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seSwKKwkJZG91YmxlIFVy
Z2VudEV4dHJhTGF0ZW5jeSwKKwkJZG91YmxlIFRDYWxjLAorCQl1bnNpZ25lZCBpbnQgUERFQW5k
TWV0YVBURUJ5dGVzRnJhbWUsCisJCXVuc2lnbmVkIGludCBNZXRhUm93Qnl0ZSwKKwkJdW5zaWdu
ZWQgaW50IFBpeGVsUFRFQnl0ZXNQZXJSb3csCisJCWRvdWJsZSBQcmVmZXRjaFNvdXJjZUxpbmVz
WSwKKwkJdW5zaWduZWQgaW50IFN3YXRoV2lkdGhZLAorCQlkb3VibGUgQnl0ZVBlclBpeGVsREVU
WSwKKwkJZG91YmxlIFZJbml0UHJlRmlsbFksCisJCXVuc2lnbmVkIGludCBNYXhOdW1Td2F0aFks
CisJCWRvdWJsZSBQcmVmZXRjaFNvdXJjZUxpbmVzQywKKwkJZG91YmxlIEJ5dGVQZXJQaXhlbERF
VEMsCisJCWRvdWJsZSBWSW5pdFByZUZpbGxDLAorCQl1bnNpZ25lZCBpbnQgTWF4TnVtU3dhdGhD
LAorCQl1bnNpZ25lZCBpbnQgU3dhdGhIZWlnaHRZLAorCQl1bnNpZ25lZCBpbnQgU3dhdGhIZWln
aHRDLAorCQlkb3VibGUgVFdhaXQsCisJCWJvb2wgWEZDRW5hYmxlZCwKKwkJZG91YmxlIFhGQ1Jl
bW90ZVN1cmZhY2VGbGlwRGVsYXksCisJCWJvb2wgSW50ZXJsYWNlRW5hYmxlLAorCQlib29sIFBy
b2dyZXNzaXZlVG9JbnRlcmxhY2VVbml0SW5PUFAsCisJCWRvdWJsZSAqRFNUWEFmdGVyU2NhbGVy
LAorCQlkb3VibGUgKkRTVFlBZnRlclNjYWxlciwKKwkJZG91YmxlICpEZXN0aW5hdGlvbkxpbmVz
Rm9yUHJlZmV0Y2gsCisJCWRvdWJsZSAqUHJlZmV0Y2hCYW5kd2lkdGgsCisJCWRvdWJsZSAqRGVz
dGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxhbmssCisJCWRvdWJsZSAqRGVzdGluYXRpb25M
aW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rLAorCQlkb3VibGUgKlZSYXRpb1ByZWZldGNoWSwKKwkJ
ZG91YmxlICpWUmF0aW9QcmVmZXRjaEMsCisJCWRvdWJsZSAqUmVxdWlyZWRQcmVmZXRjaFBpeERh
dGFCVywKKwkJdW5zaWduZWQgaW50ICpWU3RhcnR1cFJlcXVpcmVkV2hlbk5vdEVub3VnaFRpbWVG
b3JEeW5hbWljTWV0YWRhdGEsCisJCWRvdWJsZSAqVG5vX2J3LAorCQl1bnNpZ25lZCBpbnQgKlZV
cGRhdGVPZmZzZXRQaXgsCisJCWRvdWJsZSAqVlVwZGF0ZVdpZHRoUGl4LAorCQlkb3VibGUgKlZS
ZWFkeU9mZnNldFBpeCkKK3sKKwlib29sIE15RXJyb3IgPSBmYWxzZTsKKwl1bnNpZ25lZCBpbnQg
RFBQQ3ljbGVzLCBESVNQQ0xLQ3ljbGVzOworCWRvdWJsZSBEU1RUb3RhbFBpeGVsc0FmdGVyU2Nh
bGVyLCBUb3RhbFJlcGVhdGVyRGVsYXlUaW1lOworCWRvdWJsZSBUZG0sIExpbmVUaW1lLCBUc2V0
dXA7CisJZG91YmxlIGRzdF95X3ByZWZldGNoX2VxdTsKKwlkb3VibGUgVHN3X290bzsKKwlkb3Vi
bGUgcHJlZmV0Y2hfYndfb3RvOworCWRvdWJsZSBUdm1fb3RvOworCWRvdWJsZSBUcjBfb3RvOwor
CWRvdWJsZSBUcHJlX290bzsKKwlkb3VibGUgZHN0X3lfcHJlZmV0Y2hfb3RvOworCWRvdWJsZSBU
aW1lRm9yRmV0Y2hpbmdNZXRhUFRFID0gMDsKKwlkb3VibGUgVGltZUZvckZldGNoaW5nUm93SW5W
QmxhbmsgPSAwOworCWRvdWJsZSBMaW5lc1RvUmVxdWVzdFByZWZldGNoUGl4ZWxEYXRhID0gMDsK
KworCWlmIChTY2FsZXJFbmFibGVkKQorCQlEUFBDeWNsZXMgPSBEUFBDTEtEZWxheVN1YnRvdGFs
ICsgRFBQQ0xLRGVsYXlTQ0w7CisJZWxzZQorCQlEUFBDeWNsZXMgPSBEUFBDTEtEZWxheVN1YnRv
dGFsICsgRFBQQ0xLRGVsYXlTQ0xMQk9ubHk7CisKKwlEUFBDeWNsZXMgPSBEUFBDeWNsZXMgKyBE
UFBDTEtEZWxheUNOVkNGb3JtYXRlciArIE51bWJlck9mQ3Vyc29ycyAqIERQUENMS0RlbGF5Q05W
Q0N1cnNvcjsKKworCURJU1BDTEtDeWNsZXMgPSBESVNQQ0xLRGVsYXlTdWJ0b3RhbDsKKworCWlm
IChEUFBDTEsgPT0gMC4wIHx8IERJU1BDTEsgPT0gMC4wKQorCQlyZXR1cm4gdHJ1ZTsKKworCSpE
U1RYQWZ0ZXJTY2FsZXIgPSBEUFBDeWNsZXMgKiBQaXhlbENsb2NrIC8gRFBQQ0xLICsgRElTUENM
S0N5Y2xlcyAqIFBpeGVsQ2xvY2sgLyBESVNQQ0xLCisJCQkrIERTQ0RlbGF5OworCisJaWYgKERQ
UFBlclBsYW5lID4gMSkKKwkJKkRTVFhBZnRlclNjYWxlciA9ICpEU1RYQWZ0ZXJTY2FsZXIgKyBT
Y2FsZXJSZWNvdXRXaWR0aDsKKworCWlmIChPdXRwdXRGb3JtYXQgPT0gZG1fNDIwIHx8IChJbnRl
cmxhY2VFbmFibGUgJiYgUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCkpCisJCSpEU1RZ
QWZ0ZXJTY2FsZXIgPSAxOworCWVsc2UKKwkJKkRTVFlBZnRlclNjYWxlciA9IDA7CisKKwlEU1RU
b3RhbFBpeGVsc0FmdGVyU2NhbGVyID0gKChkb3VibGUpICgqRFNUWUFmdGVyU2NhbGVyICogSFRv
dGFsKSkgKyAqRFNUWEFmdGVyU2NhbGVyOworCSpEU1RZQWZ0ZXJTY2FsZXIgPSBkbWxfZmxvb3Io
RFNUVG90YWxQaXhlbHNBZnRlclNjYWxlciAvIEhUb3RhbCwgMSk7CisJKkRTVFhBZnRlclNjYWxl
ciA9IERTVFRvdGFsUGl4ZWxzQWZ0ZXJTY2FsZXIgLSAoKGRvdWJsZSkgKCpEU1RZQWZ0ZXJTY2Fs
ZXIgKiBIVG90YWwpKTsKKworCSpWVXBkYXRlT2Zmc2V0UGl4ID0gZG1sX2NlaWwoSFRvdGFsIC8g
NC4wLCAxKTsKKwlUb3RhbFJlcGVhdGVyRGVsYXlUaW1lID0gTWF4SW50ZXJEQ05UaWxlUmVwZWF0
ZXJzICogKDIuMCAvIERQUENMSyArIDMuMCAvIERJU1BDTEspOworCSpWVXBkYXRlV2lkdGhQaXgg
PSAoMTQuMCAvIERDRkNMS0RlZXBTbGVlcCArIDEyLjAgLyBEUFBDTEsgKyBUb3RhbFJlcGVhdGVy
RGVsYXlUaW1lKQorCQkJKiBQaXhlbENsb2NrOworCisJKlZSZWFkeU9mZnNldFBpeCA9IGRtbF9t
YXgoCisJCQkxNTAuMCAvIERQUENMSywKKwkJCVRvdGFsUmVwZWF0ZXJEZWxheVRpbWUgKyAyMC4w
IC8gRENGQ0xLRGVlcFNsZWVwICsgMTAuMCAvIERQUENMSykKKwkJCSogUGl4ZWxDbG9jazsKKwor
CVRzZXR1cCA9IChkb3VibGUpICgqVlVwZGF0ZU9mZnNldFBpeCArICpWVXBkYXRlV2lkdGhQaXgg
KyAqVlJlYWR5T2Zmc2V0UGl4KSAvIFBpeGVsQ2xvY2s7CisKKwlMaW5lVGltZSA9IChkb3VibGUp
IEhUb3RhbCAvIFBpeGVsQ2xvY2s7CisKKwlpZiAoRHluYW1pY01ldGFkYXRhRW5hYmxlKSB7CisJ
CWRvdWJsZSBUZG1iZiwgVGRtZWMsIFRkbXNrczsKKworCQlUZG0gPSBkbWxfbWF4KDAuMCwgVXJn
ZW50RXh0cmFMYXRlbmN5IC0gVENhbGMpOworCQlUZG1iZiA9IER5bmFtaWNNZXRhZGF0YVRyYW5z
bWl0dGVkQnl0ZXMgLyA0LjAgLyBESVNQQ0xLOworCQlUZG1lYyA9IExpbmVUaW1lOworCQlpZiAo
RHluYW1pY01ldGFkYXRhTGluZXNCZWZvcmVBY3RpdmVSZXF1aXJlZCA9PSAwKQorCQkJVGRtc2tz
ID0gVkJsYW5rICogTGluZVRpbWUgLyAyLjA7CisJCWVsc2UKKwkJCVRkbXNrcyA9IER5bmFtaWNN
ZXRhZGF0YUxpbmVzQmVmb3JlQWN0aXZlUmVxdWlyZWQgKiBMaW5lVGltZTsKKwkJaWYgKEludGVy
bGFjZUVuYWJsZSAmJiAhUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCkKKwkJCVRkbXNr
cyA9IFRkbXNrcyAvIDI7CisJCWlmIChWU3RhcnR1cCAqIExpbmVUaW1lCisJCQkJPCBUc2V0dXAg
KyBUV2FpdCArIFVyZ2VudEV4dHJhTGF0ZW5jeSArIFRkbWJmICsgVGRtZWMgKyBUZG1za3MpIHsK
KwkJCU15RXJyb3IgPSB0cnVlOworCQkJKlZTdGFydHVwUmVxdWlyZWRXaGVuTm90RW5vdWdoVGlt
ZUZvckR5bmFtaWNNZXRhZGF0YSA9IChUc2V0dXAgKyBUV2FpdAorCQkJCQkrIFVyZ2VudEV4dHJh
TGF0ZW5jeSArIFRkbWJmICsgVGRtZWMgKyBUZG1za3MpIC8gTGluZVRpbWU7CisJCX0gZWxzZQor
CQkJKlZTdGFydHVwUmVxdWlyZWRXaGVuTm90RW5vdWdoVGltZUZvckR5bmFtaWNNZXRhZGF0YSA9
IDAuMDsKKwl9IGVsc2UKKwkJVGRtID0gMDsKKworCWlmIChHUFVWTUVuYWJsZSkgeworCQlpZiAo
UGFnZVRhYmxlTGV2ZWxzID09IDQpCisJCQkqVG5vX2J3ID0gVXJnZW50RXh0cmFMYXRlbmN5ICsg
VXJnZW50TGF0ZW5jeVBpeGVsRGF0YU9ubHk7CisJCWVsc2UgaWYgKFBhZ2VUYWJsZUxldmVscyA9
PSAzKQorCQkJKlRub19idyA9IFVyZ2VudEV4dHJhTGF0ZW5jeTsKKwkJZWxzZQorCQkJKlRub19i
dyA9IDA7CisJfSBlbHNlIGlmIChEQ0NFbmFibGUpCisJCSpUbm9fYncgPSBMaW5lVGltZTsKKwll
bHNlCisJCSpUbm9fYncgPSBMaW5lVGltZSAvIDQ7CisKKwlkc3RfeV9wcmVmZXRjaF9lcXUgPSBW
U3RhcnR1cCAtIGRtbF9tYXgoVENhbGMgKyBUV2FpdCwgWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxh
eSkgLyBMaW5lVGltZQorCQkJLSAoVHNldHVwICsgVGRtKSAvIExpbmVUaW1lCisJCQktICgqRFNU
WUFmdGVyU2NhbGVyICsgKkRTVFhBZnRlclNjYWxlciAvIEhUb3RhbCk7CisKKwlUc3dfb3RvID0g
ZG1sX21heChQcmVmZXRjaFNvdXJjZUxpbmVzWSwgUHJlZmV0Y2hTb3VyY2VMaW5lc0MpICogTGlu
ZVRpbWU7CisKKwlwcmVmZXRjaF9id19vdG8gPSAoTWV0YVJvd0J5dGUgKyBQaXhlbFBURUJ5dGVz
UGVyUm93CisJCQkrIFByZWZldGNoU291cmNlTGluZXNZICogU3dhdGhXaWR0aFkgKiBkbWxfY2Vp
bChCeXRlUGVyUGl4ZWxERVRZLCAxKQorCQkJKyBQcmVmZXRjaFNvdXJjZUxpbmVzQyAqIFN3YXRo
V2lkdGhZIC8gMiAqIGRtbF9jZWlsKEJ5dGVQZXJQaXhlbERFVEMsIDIpKQorCQkJLyBUc3dfb3Rv
OworCisJaWYgKEdQVVZNRW5hYmxlID09IHRydWUpIHsKKwkJVHZtX290byA9CisJCQkJZG1sX21h
eCgKKwkJCQkJCSpUbm9fYncgKyBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZSAvIHByZWZldGNoX2J3
X290bywKKwkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCVVyZ2VudEV4dHJhTGF0ZW5jeQorCQkJCQkJ
CQkJCSsgVXJnZW50TGF0ZW5jeVBpeGVsRGF0YU9ubHkKKwkJCQkJCQkJCQkJCSogKFBhZ2VUYWJs
ZUxldmVscworCQkJCQkJCQkJCQkJCQktIDEpLAorCQkJCQkJCQlMaW5lVGltZSAvIDQuMCkpOwor
CX0gZWxzZQorCQlUdm1fb3RvID0gTGluZVRpbWUgLyA0LjA7CisKKwlpZiAoKEdQVVZNRW5hYmxl
ID09IHRydWUgfHwgRENDRW5hYmxlID09IHRydWUpKSB7CisJCVRyMF9vdG8gPSBkbWxfbWF4KAor
CQkJCShNZXRhUm93Qnl0ZSArIFBpeGVsUFRFQnl0ZXNQZXJSb3cpIC8gcHJlZmV0Y2hfYndfb3Rv
LAorCQkJCWRtbF9tYXgoVXJnZW50TGF0ZW5jeVBpeGVsRGF0YU9ubHksIGRtbF9tYXgoTGluZVRp
bWUgLSBUdm1fb3RvLCBMaW5lVGltZSAvIDQpKSk7CisJfSBlbHNlCisJCVRyMF9vdG8gPSBMaW5l
VGltZSAtIFR2bV9vdG87CisKKwlUcHJlX290byA9IFR2bV9vdG8gKyBUcjBfb3RvICsgVHN3X290
bzsKKworCWRzdF95X3ByZWZldGNoX290byA9IFRwcmVfb3RvIC8gTGluZVRpbWU7CisKKwlpZiAo
ZHN0X3lfcHJlZmV0Y2hfb3RvIDwgZHN0X3lfcHJlZmV0Y2hfZXF1KQorCQkqRGVzdGluYXRpb25M
aW5lc0ZvclByZWZldGNoID0gZHN0X3lfcHJlZmV0Y2hfb3RvOworCWVsc2UKKwkJKkRlc3RpbmF0
aW9uTGluZXNGb3JQcmVmZXRjaCA9IGRzdF95X3ByZWZldGNoX2VxdTsKKworCSpEZXN0aW5hdGlv
bkxpbmVzRm9yUHJlZmV0Y2ggPSBkbWxfZmxvb3IoNC4wICogKCpEZXN0aW5hdGlvbkxpbmVzRm9y
UHJlZmV0Y2ggKyAwLjEyNSksIDEpCisJCQkvIDQ7CisKKwlkbWxfcHJpbnQoIkRNTDogVlN0YXJ0
dXA6ICVkXG4iLCBWU3RhcnR1cCk7CisJZG1sX3ByaW50KCJETUw6IFRDYWxjOiAlZlxuIiwgVENh
bGMpOworCWRtbF9wcmludCgiRE1MOiBUV2FpdDogJWZcbiIsIFRXYWl0KTsKKwlkbWxfcHJpbnQo
IkRNTDogWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheTogJWZcbiIsIFhGQ1JlbW90ZVN1cmZhY2VG
bGlwRGVsYXkpOworCWRtbF9wcmludCgiRE1MOiBMaW5lVGltZTogJWZcbiIsIExpbmVUaW1lKTsK
KwlkbWxfcHJpbnQoIkRNTDogVHNldHVwOiAlZlxuIiwgVHNldHVwKTsKKwlkbWxfcHJpbnQoIkRN
TDogVGRtOiAlZlxuIiwgVGRtKTsKKwlkbWxfcHJpbnQoIkRNTDogRFNUWUFmdGVyU2NhbGVyOiAl
ZlxuIiwgKkRTVFlBZnRlclNjYWxlcik7CisJZG1sX3ByaW50KCJETUw6IERTVFhBZnRlclNjYWxl
cjogJWZcbiIsICpEU1RYQWZ0ZXJTY2FsZXIpOworCWRtbF9wcmludCgiRE1MOiBIVG90YWw6ICVk
XG4iLCBIVG90YWwpOworCisJKlByZWZldGNoQmFuZHdpZHRoID0gMDsKKwkqRGVzdGluYXRpb25M
aW5lc1RvUmVxdWVzdFZNSW5WQmxhbmsgPSAwOworCSpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0
Um93SW5WQmxhbmsgPSAwOworCSpWUmF0aW9QcmVmZXRjaFkgPSAwOworCSpWUmF0aW9QcmVmZXRj
aEMgPSAwOworCSpSZXF1aXJlZFByZWZldGNoUGl4RGF0YUJXID0gMDsKKwlpZiAoKkRlc3RpbmF0
aW9uTGluZXNGb3JQcmVmZXRjaCA+IDEpIHsKKwkJKlByZWZldGNoQmFuZHdpZHRoID0gKFBERUFu
ZE1ldGFQVEVCeXRlc0ZyYW1lICsgMiAqIE1ldGFSb3dCeXRlCisJCQkJKyAyICogUGl4ZWxQVEVC
eXRlc1BlclJvdworCQkJCSsgUHJlZmV0Y2hTb3VyY2VMaW5lc1kgKiBTd2F0aFdpZHRoWSAqIGRt
bF9jZWlsKEJ5dGVQZXJQaXhlbERFVFksIDEpCisJCQkJKyBQcmVmZXRjaFNvdXJjZUxpbmVzQyAq
IFN3YXRoV2lkdGhZIC8gMgorCQkJCQkJKiBkbWxfY2VpbChCeXRlUGVyUGl4ZWxERVRDLCAyKSkK
KwkJCQkvICgqRGVzdGluYXRpb25MaW5lc0ZvclByZWZldGNoICogTGluZVRpbWUgLSAqVG5vX2J3
KTsKKwkJaWYgKEdQVVZNRW5hYmxlKSB7CisJCQlUaW1lRm9yRmV0Y2hpbmdNZXRhUFRFID0KKwkJ
CQkJZG1sX21heCgKKwkJCQkJCQkqVG5vX2J3CisJCQkJCQkJCQkrIChkb3VibGUpIFBERUFuZE1l
dGFQVEVCeXRlc0ZyYW1lCisJCQkJCQkJCQkJCS8gKlByZWZldGNoQmFuZHdpZHRoLAorCQkJCQkJ
CWRtbF9tYXgoCisJCQkJCQkJCQlVcmdlbnRFeHRyYUxhdGVuY3kKKwkJCQkJCQkJCQkJKyBVcmdl
bnRMYXRlbmN5UGl4ZWxEYXRhT25seQorCQkJCQkJCQkJCQkJCSogKFBhZ2VUYWJsZUxldmVscwor
CQkJCQkJCQkJCQkJCQkJLSAxKSwKKwkJCQkJCQkJCUxpbmVUaW1lIC8gNCkpOworCQl9IGVsc2Ug
eworCQkJaWYgKE51bWJlck9mQ3Vyc29ycyA+IDAgfHwgWEZDRW5hYmxlZCkKKwkJCQlUaW1lRm9y
RmV0Y2hpbmdNZXRhUFRFID0gTGluZVRpbWUgLyA0OworCQkJZWxzZQorCQkJCVRpbWVGb3JGZXRj
aGluZ01ldGFQVEUgPSAwLjA7CisJCX0KKworCQlpZiAoKEdQVVZNRW5hYmxlID09IHRydWUgfHwg
RENDRW5hYmxlID09IHRydWUpKSB7CisJCQlUaW1lRm9yRmV0Y2hpbmdSb3dJblZCbGFuayA9CisJ
CQkJCWRtbF9tYXgoCisJCQkJCQkJKE1ldGFSb3dCeXRlICsgUGl4ZWxQVEVCeXRlc1BlclJvdykK
KwkJCQkJCQkJCS8gKlByZWZldGNoQmFuZHdpZHRoLAorCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJ
CQlVcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seSwKKwkJCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJ
CQkJCUxpbmVUaW1lCisJCQkJCQkJCQkJCQkJLSBUaW1lRm9yRmV0Y2hpbmdNZXRhUFRFLAorCQkJ
CQkJCQkJCQlMaW5lVGltZQorCQkJCQkJCQkJCQkJCS8gNC4wKSkpOworCQl9IGVsc2UgeworCQkJ
aWYgKE51bWJlck9mQ3Vyc29ycyA+IDAgfHwgWEZDRW5hYmxlZCkKKwkJCQlUaW1lRm9yRmV0Y2hp
bmdSb3dJblZCbGFuayA9IExpbmVUaW1lIC0gVGltZUZvckZldGNoaW5nTWV0YVBURTsKKwkJCWVs
c2UKKwkJCQlUaW1lRm9yRmV0Y2hpbmdSb3dJblZCbGFuayA9IDAuMDsKKwkJfQorCisJCSpEZXN0
aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JblZCbGFuayA9IGRtbF9mbG9vcigKKwkJCQk0LjAgKiAo
VGltZUZvckZldGNoaW5nTWV0YVBURSAvIExpbmVUaW1lICsgMC4xMjUpLAorCQkJCTEpIC8gNC4w
OworCisJCSpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5WQmxhbmsgPSBkbWxfZmxvb3Io
CisJCQkJNC4wICogKFRpbWVGb3JGZXRjaGluZ1Jvd0luVkJsYW5rIC8gTGluZVRpbWUgKyAwLjEy
NSksCisJCQkJMSkgLyA0LjA7CisKKwkJTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0YSA9
CisJCQkJKkRlc3RpbmF0aW9uTGluZXNGb3JQcmVmZXRjaAorCQkJCQkJLSAoKE51bWJlck9mQ3Vy
c29ycyA+IDAgfHwgR1BVVk1FbmFibGUKKwkJCQkJCQkJfHwgRENDRW5hYmxlKSA/CisJCQkJCQkJ
CSgqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxhbmsKKwkJCQkJCQkJCQkrICpEZXN0
aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5WQmxhbmspIDoKKwkJCQkJCQkJMC4wKTsKKworCQlp
ZiAoTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0YSA+IDApIHsKKworCQkJKlZSYXRpb1By
ZWZldGNoWSA9IChkb3VibGUpIFByZWZldGNoU291cmNlTGluZXNZCisJCQkJCS8gTGluZXNUb1Jl
cXVlc3RQcmVmZXRjaFBpeGVsRGF0YTsKKwkJCSpWUmF0aW9QcmVmZXRjaFkgPSBkbWxfbWF4KCpW
UmF0aW9QcmVmZXRjaFksIDEuMCk7CisJCQlpZiAoKFN3YXRoSGVpZ2h0WSA+IDQpICYmIChWSW5p
dFByZUZpbGxZID4gMykpIHsKKwkJCQlpZiAoTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0
YSA+IChWSW5pdFByZUZpbGxZIC0gMy4wKSAvIDIuMCkgeworCQkJCQkqVlJhdGlvUHJlZmV0Y2hZ
ID0KKwkJCQkJCQlkbWxfbWF4KAorCQkJCQkJCQkJKGRvdWJsZSkgUHJlZmV0Y2hTb3VyY2VMaW5l
c1kKKwkJCQkJCQkJCQkJLyBMaW5lc1RvUmVxdWVzdFByZWZldGNoUGl4ZWxEYXRhLAorCQkJCQkJ
CQkJKGRvdWJsZSkgTWF4TnVtU3dhdGhZCisJCQkJCQkJCQkJCSogU3dhdGhIZWlnaHRZCisJCQkJ
CQkJCQkJCS8gKExpbmVzVG9SZXF1ZXN0UHJlZmV0Y2hQaXhlbERhdGEKKwkJCQkJCQkJCQkJCQkt
IChWSW5pdFByZUZpbGxZCisJCQkJCQkJCQkJCQkJCQktIDMuMCkKKwkJCQkJCQkJCQkJCQkJCS8g
Mi4wKSk7CisJCQkJCSpWUmF0aW9QcmVmZXRjaFkgPSBkbWxfbWF4KCpWUmF0aW9QcmVmZXRjaFks
IDEuMCk7CisJCQkJfSBlbHNlIHsKKwkJCQkJTXlFcnJvciA9IHRydWU7CisJCQkJCSpWUmF0aW9Q
cmVmZXRjaFkgPSAwOworCQkJCX0KKwkJCX0KKworCQkJKlZSYXRpb1ByZWZldGNoQyA9IChkb3Vi
bGUpIFByZWZldGNoU291cmNlTGluZXNDCisJCQkJCS8gTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBp
eGVsRGF0YTsKKwkJCSpWUmF0aW9QcmVmZXRjaEMgPSBkbWxfbWF4KCpWUmF0aW9QcmVmZXRjaEMs
IDEuMCk7CisKKwkJCWlmICgoU3dhdGhIZWlnaHRDID4gNCkpIHsKKwkJCQlpZiAoTGluZXNUb1Jl
cXVlc3RQcmVmZXRjaFBpeGVsRGF0YSA+IChWSW5pdFByZUZpbGxDIC0gMy4wKSAvIDIuMCkgewor
CQkJCQkqVlJhdGlvUHJlZmV0Y2hDID0KKwkJCQkJCQlkbWxfbWF4KAorCQkJCQkJCQkJKlZSYXRp
b1ByZWZldGNoQywKKwkJCQkJCQkJCShkb3VibGUpIE1heE51bVN3YXRoQworCQkJCQkJCQkJCQkq
IFN3YXRoSGVpZ2h0QworCQkJCQkJCQkJCQkvIChMaW5lc1RvUmVxdWVzdFByZWZldGNoUGl4ZWxE
YXRhCisJCQkJCQkJCQkJCQkJLSAoVkluaXRQcmVGaWxsQworCQkJCQkJCQkJCQkJCQkJLSAzLjAp
CisJCQkJCQkJCQkJCQkJCQkvIDIuMCkpOworCQkJCQkqVlJhdGlvUHJlZmV0Y2hDID0gZG1sX21h
eCgqVlJhdGlvUHJlZmV0Y2hDLCAxLjApOworCQkJCX0gZWxzZSB7CisJCQkJCU15RXJyb3IgPSB0
cnVlOworCQkJCQkqVlJhdGlvUHJlZmV0Y2hDID0gMDsKKwkJCQl9CisJCQl9CisKKwkJCSpSZXF1
aXJlZFByZWZldGNoUGl4RGF0YUJXID0KKwkJCQkJRFBQUGVyUGxhbmUKKwkJCQkJCQkqICgoZG91
YmxlKSBQcmVmZXRjaFNvdXJjZUxpbmVzWQorCQkJCQkJCQkJLyBMaW5lc1RvUmVxdWVzdFByZWZl
dGNoUGl4ZWxEYXRhCisJCQkJCQkJCQkqIGRtbF9jZWlsKAorCQkJCQkJCQkJCQlCeXRlUGVyUGl4
ZWxERVRZLAorCQkJCQkJCQkJCQkxKQorCQkJCQkJCQkJKyAoZG91YmxlKSBQcmVmZXRjaFNvdXJj
ZUxpbmVzQworCQkJCQkJCQkJCQkvIExpbmVzVG9SZXF1ZXN0UHJlZmV0Y2hQaXhlbERhdGEKKwkJ
CQkJCQkJCQkJKiBkbWxfY2VpbCgKKwkJCQkJCQkJCQkJCQlCeXRlUGVyUGl4ZWxERVRDLAorCQkJ
CQkJCQkJCQkJCTIpCisJCQkJCQkJCQkJCS8gMikKKwkJCQkJCQkqIFN3YXRoV2lkdGhZIC8gTGlu
ZVRpbWU7CisJCX0gZWxzZSB7CisJCQlNeUVycm9yID0gdHJ1ZTsKKwkJCSpWUmF0aW9QcmVmZXRj
aFkgPSAwOworCQkJKlZSYXRpb1ByZWZldGNoQyA9IDA7CisJCQkqUmVxdWlyZWRQcmVmZXRjaFBp
eERhdGFCVyA9IDA7CisJCX0KKworCX0gZWxzZSB7CisJCU15RXJyb3IgPSB0cnVlOworCX0KKwor
CWlmIChNeUVycm9yKSB7CisJCSpQcmVmZXRjaEJhbmR3aWR0aCA9IDA7CisJCVRpbWVGb3JGZXRj
aGluZ01ldGFQVEUgPSAwOworCQlUaW1lRm9yRmV0Y2hpbmdSb3dJblZCbGFuayA9IDA7CisJCSpE
ZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JblZCbGFuayA9IDA7CisJCSpEZXN0aW5hdGlvbkxp
bmVzVG9SZXF1ZXN0Um93SW5WQmxhbmsgPSAwOworCQkqRGVzdGluYXRpb25MaW5lc0ZvclByZWZl
dGNoID0gMDsKKwkJTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0YSA9IDA7CisJCSpWUmF0
aW9QcmVmZXRjaFkgPSAwOworCQkqVlJhdGlvUHJlZmV0Y2hDID0gMDsKKwkJKlJlcXVpcmVkUHJl
ZmV0Y2hQaXhEYXRhQlcgPSAwOworCX0KKworCXJldHVybiBNeUVycm9yOworfQorCitzdGF0aWMg
ZG91YmxlIFJvdW5kVG9ERlNHcmFudWxhcml0eVVwKGRvdWJsZSBDbG9jaywgZG91YmxlIFZDT1Nw
ZWVkKQoreworCXJldHVybiBWQ09TcGVlZCAqIDQgLyBkbWxfZmxvb3IoVkNPU3BlZWQgKiA0IC8g
Q2xvY2ssIDEpOworfQorCitzdGF0aWMgZG91YmxlIFJvdW5kVG9ERlNHcmFudWxhcml0eURvd24o
ZG91YmxlIENsb2NrLCBkb3VibGUgVkNPU3BlZWQpCit7CisJcmV0dXJuIFZDT1NwZWVkICogNCAv
IGRtbF9jZWlsKFZDT1NwZWVkICogNCAvIENsb2NrLCAxKTsKK30KKworc3RhdGljIGRvdWJsZSBD
YWxjdWxhdGVQcmVmZXRjaFNvdXJjZUxpbmVzKAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAq
bW9kZV9saWIsCisJCWRvdWJsZSBWUmF0aW8sCisJCWRvdWJsZSB2dGFwcywKKwkJYm9vbCBJbnRl
cmxhY2UsCisJCWJvb2wgUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCwKKwkJdW5zaWdu
ZWQgaW50IFN3YXRoSGVpZ2h0LAorCQl1bnNpZ25lZCBpbnQgVmlld3BvcnRZU3RhcnQsCisJCWRv
dWJsZSAqVkluaXRQcmVGaWxsLAorCQl1bnNpZ25lZCBpbnQgKk1heE51bVN3YXRoKQoreworCXVu
c2lnbmVkIGludCBNYXhQYXJ0aWFsU3dhdGg7CisKKwlpZiAoUHJvZ3Jlc3NpdmVUb0ludGVybGFj
ZVVuaXRJbk9QUCkKKwkJKlZJbml0UHJlRmlsbCA9IGRtbF9mbG9vcigoVlJhdGlvICsgdnRhcHMg
KyAxKSAvIDIuMCwgMSk7CisJZWxzZQorCQkqVkluaXRQcmVGaWxsID0gZG1sX2Zsb29yKChWUmF0
aW8gKyB2dGFwcyArIDEgKyBJbnRlcmxhY2UgKiAwLjUgKiBWUmF0aW8pIC8gMi4wLCAxKTsKKwor
CWlmICghbW9kZV9saWItPnZiYS5JZ25vcmVWaWV3cG9ydFBvc2l0aW9uaW5nKSB7CisKKwkJKk1h
eE51bVN3YXRoID0gZG1sX2NlaWwoKCpWSW5pdFByZUZpbGwgLSAxLjApIC8gU3dhdGhIZWlnaHQs
IDEpICsgMS4wOworCisJCWlmICgqVkluaXRQcmVGaWxsID4gMS4wKQorCQkJTWF4UGFydGlhbFN3
YXRoID0gKHVuc2lnbmVkIGludCkgKCpWSW5pdFByZUZpbGwgLSAyKSAlIFN3YXRoSGVpZ2h0Owor
CQllbHNlCisJCQlNYXhQYXJ0aWFsU3dhdGggPSAodW5zaWduZWQgaW50KSAoKlZJbml0UHJlRmls
bCArIFN3YXRoSGVpZ2h0IC0gMikKKwkJCQkJJSBTd2F0aEhlaWdodDsKKwkJTWF4UGFydGlhbFN3
YXRoID0gZG1sX21heCgxVSwgTWF4UGFydGlhbFN3YXRoKTsKKworCX0gZWxzZSB7CisKKwkJaWYg
KFZpZXdwb3J0WVN0YXJ0ICE9IDApCisJCQlkbWxfcHJpbnQoCisJCQkJCSJXQVJOSU5HIERNTDog
dXNpbmcgdmlld3BvcnQgeSBwb3NpdGlvbiBvZiAwIGV2ZW4gdGhvdWdoIGFjdHVhbCB2aWV3cG9y
dCB5IHBvc2l0aW9uIGlzIG5vbi16ZXJvIGluIHByZWZldGNoIHNvdXJjZSBsaW5lcyBjYWxjdWxh
dGlvblxuIik7CisKKwkJKk1heE51bVN3YXRoID0gZG1sX2NlaWwoKlZJbml0UHJlRmlsbCAvIFN3
YXRoSGVpZ2h0LCAxKTsKKworCQlpZiAoKlZJbml0UHJlRmlsbCA+IDEuMCkKKwkJCU1heFBhcnRp
YWxTd2F0aCA9ICh1bnNpZ25lZCBpbnQpICgqVkluaXRQcmVGaWxsIC0gMSkgJSBTd2F0aEhlaWdo
dDsKKwkJZWxzZQorCQkJTWF4UGFydGlhbFN3YXRoID0gKHVuc2lnbmVkIGludCkgKCpWSW5pdFBy
ZUZpbGwgKyBTd2F0aEhlaWdodCAtIDEpCisJCQkJCSUgU3dhdGhIZWlnaHQ7CisJfQorCisJcmV0
dXJuICpNYXhOdW1Td2F0aCAqIFN3YXRoSGVpZ2h0ICsgTWF4UGFydGlhbFN3YXRoOworfQorCitz
dGF0aWMgdW5zaWduZWQgaW50IENhbGN1bGF0ZVZNQW5kUm93Qnl0ZXMoCisJCXN0cnVjdCBkaXNw
bGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJYm9vbCBEQ0NFbmFibGUsCisJCXVuc2lnbmVkIGlu
dCBCbG9ja0hlaWdodDI1NkJ5dGVzLAorCQl1bnNpZ25lZCBpbnQgQmxvY2tXaWR0aDI1NkJ5dGVz
LAorCQllbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MgU291cmNlUGl4ZWxGb3JtYXQsCisJCXVuc2ln
bmVkIGludCBTdXJmYWNlVGlsaW5nLAorCQl1bnNpZ25lZCBpbnQgQnl0ZVBlclBpeGVsLAorCQll
bnVtIHNjYW5fZGlyZWN0aW9uX2NsYXNzIFNjYW5EaXJlY3Rpb24sCisJCXVuc2lnbmVkIGludCBW
aWV3cG9ydFdpZHRoLAorCQl1bnNpZ25lZCBpbnQgVmlld3BvcnRIZWlnaHQsCisJCXVuc2lnbmVk
IGludCBTd2F0aFdpZHRoLAorCQlib29sIEdQVVZNRW5hYmxlLAorCQl1bnNpZ25lZCBpbnQgVk1N
UGFnZVNpemUsCisJCXVuc2lnbmVkIGludCBQVEVCdWZmZXJTaXplSW5SZXF1ZXN0c0x1bWEsCisJ
CXVuc2lnbmVkIGludCBQREVQcm9jZXNzaW5nQnVmSW42NEtCUmVxcywKKwkJdW5zaWduZWQgaW50
IFBpdGNoLAorCQl1bnNpZ25lZCBpbnQgRENDTWV0YVBpdGNoLAorCQl1bnNpZ25lZCBpbnQgKk1h
Y3JvVGlsZVdpZHRoLAorCQl1bnNpZ25lZCBpbnQgKk1ldGFSb3dCeXRlLAorCQl1bnNpZ25lZCBp
bnQgKlBpeGVsUFRFQnl0ZXNQZXJSb3csCisJCWJvb2wgKlBURUJ1ZmZlclNpemVOb3RFeGNlZWRl
ZCwKKwkJdW5zaWduZWQgaW50ICpkcHRlX3Jvd19oZWlnaHQsCisJCXVuc2lnbmVkIGludCAqbWV0
YV9yb3dfaGVpZ2h0KQoreworCXVuc2lnbmVkIGludCBNZXRhUmVxdWVzdEhlaWdodDsKKwl1bnNp
Z25lZCBpbnQgTWV0YVJlcXVlc3RXaWR0aDsKKwl1bnNpZ25lZCBpbnQgTWV0YVN1cmZXaWR0aDsK
Kwl1bnNpZ25lZCBpbnQgTWV0YVN1cmZIZWlnaHQ7CisJdW5zaWduZWQgaW50IE1QREVCeXRlc0Zy
YW1lOworCXVuc2lnbmVkIGludCBNZXRhUFRFQnl0ZXNGcmFtZTsKKwl1bnNpZ25lZCBpbnQgREND
TWV0YVN1cmZhY2VCeXRlczsKKworCXVuc2lnbmVkIGludCBNYWNyb1RpbGVTaXplQnl0ZXM7CisJ
dW5zaWduZWQgaW50IE1hY3JvVGlsZUhlaWdodDsKKwl1bnNpZ25lZCBpbnQgRFBERTBCeXRlc0Zy
YW1lOworCXVuc2lnbmVkIGludCBFeHRyYURQREVCeXRlc0ZyYW1lOworCXVuc2lnbmVkIGludCBQ
REVBbmRNZXRhUFRFQnl0ZXNGcmFtZTsKKworCWlmIChEQ0NFbmFibGUgPT0gdHJ1ZSkgeworCQlN
ZXRhUmVxdWVzdEhlaWdodCA9IDggKiBCbG9ja0hlaWdodDI1NkJ5dGVzOworCQlNZXRhUmVxdWVz
dFdpZHRoID0gOCAqIEJsb2NrV2lkdGgyNTZCeXRlczsKKwkJaWYgKFNjYW5EaXJlY3Rpb24gPT0g
ZG1faG9yeikgeworCQkJKm1ldGFfcm93X2hlaWdodCA9IE1ldGFSZXF1ZXN0SGVpZ2h0OworCQkJ
TWV0YVN1cmZXaWR0aCA9IGRtbF9jZWlsKChkb3VibGUpIFN3YXRoV2lkdGggLSAxLCBNZXRhUmVx
dWVzdFdpZHRoKQorCQkJCQkrIE1ldGFSZXF1ZXN0V2lkdGg7CisJCQkqTWV0YVJvd0J5dGUgPSBN
ZXRhU3VyZldpZHRoICogTWV0YVJlcXVlc3RIZWlnaHQgKiBCeXRlUGVyUGl4ZWwgLyAyNTYuMDsK
KwkJfSBlbHNlIHsKKwkJCSptZXRhX3Jvd19oZWlnaHQgPSBNZXRhUmVxdWVzdFdpZHRoOworCQkJ
TWV0YVN1cmZIZWlnaHQgPSBkbWxfY2VpbCgoZG91YmxlKSBTd2F0aFdpZHRoIC0gMSwgTWV0YVJl
cXVlc3RIZWlnaHQpCisJCQkJCSsgTWV0YVJlcXVlc3RIZWlnaHQ7CisJCQkqTWV0YVJvd0J5dGUg
PSBNZXRhU3VyZkhlaWdodCAqIE1ldGFSZXF1ZXN0V2lkdGggKiBCeXRlUGVyUGl4ZWwgLyAyNTYu
MDsKKwkJfQorCQlpZiAoU2NhbkRpcmVjdGlvbiA9PSBkbV9ob3J6KSB7CisJCQlEQ0NNZXRhU3Vy
ZmFjZUJ5dGVzID0gRENDTWV0YVBpdGNoCisJCQkJCSogKGRtbF9jZWlsKFZpZXdwb3J0SGVpZ2h0
IC0gMSwgNjQgKiBCbG9ja0hlaWdodDI1NkJ5dGVzKQorCQkJCQkJCSsgNjQgKiBCbG9ja0hlaWdo
dDI1NkJ5dGVzKSAqIEJ5dGVQZXJQaXhlbAorCQkJCQkvIDI1NjsKKwkJfSBlbHNlIHsKKwkJCURD
Q01ldGFTdXJmYWNlQnl0ZXMgPSBEQ0NNZXRhUGl0Y2gKKwkJCQkJKiAoZG1sX2NlaWwoCisJCQkJ
CQkJKGRvdWJsZSkgVmlld3BvcnRIZWlnaHQgLSAxLAorCQkJCQkJCTY0ICogQmxvY2tIZWlnaHQy
NTZCeXRlcykKKwkJCQkJCQkrIDY0ICogQmxvY2tIZWlnaHQyNTZCeXRlcykgKiBCeXRlUGVyUGl4
ZWwKKwkJCQkJLyAyNTY7CisJCX0KKwkJaWYgKEdQVVZNRW5hYmxlID09IHRydWUpIHsKKwkJCU1l
dGFQVEVCeXRlc0ZyYW1lID0gKGRtbF9jZWlsKAorCQkJCQkoZG91YmxlKSAoRENDTWV0YVN1cmZh
Y2VCeXRlcyAtIFZNTVBhZ2VTaXplKQorCQkJCQkJCS8gKDggKiBWTU1QYWdlU2l6ZSksCisJCQkJ
CTEpICsgMSkgKiA2NDsKKwkJCU1QREVCeXRlc0ZyYW1lID0gMTI4ICogKG1vZGVfbGliLT52YmEu
R1BVVk1NYXhQYWdlVGFibGVMZXZlbHMgLSAxKTsKKwkJfSBlbHNlIHsKKwkJCU1ldGFQVEVCeXRl
c0ZyYW1lID0gMDsKKwkJCU1QREVCeXRlc0ZyYW1lID0gMDsKKwkJfQorCX0gZWxzZSB7CisJCU1l
dGFQVEVCeXRlc0ZyYW1lID0gMDsKKwkJTVBERUJ5dGVzRnJhbWUgPSAwOworCQkqTWV0YVJvd0J5
dGUgPSAwOworCX0KKworCWlmIChTdXJmYWNlVGlsaW5nID09IGRtX3N3X2xpbmVhciB8fCBTdXJm
YWNlVGlsaW5nID09IGRtX3N3X2dmeDdfMmRfdGhpbl9nbCB8fCBTdXJmYWNlVGlsaW5nID09IGRt
X3N3X2dmeDdfMmRfdGhpbl9sdnApIHsKKwkJTWFjcm9UaWxlU2l6ZUJ5dGVzID0gMjU2OworCQlN
YWNyb1RpbGVIZWlnaHQgPSBCbG9ja0hlaWdodDI1NkJ5dGVzOworCX0gZWxzZSBpZiAoU3VyZmFj
ZVRpbGluZyA9PSBkbV9zd180a2JfcyB8fCBTdXJmYWNlVGlsaW5nID09IGRtX3N3XzRrYl9zX3gK
KwkJCXx8IFN1cmZhY2VUaWxpbmcgPT0gZG1fc3dfNGtiX2QgfHwgU3VyZmFjZVRpbGluZyA9PSBk
bV9zd180a2JfZF94KSB7CisJCU1hY3JvVGlsZVNpemVCeXRlcyA9IDQwOTY7CisJCU1hY3JvVGls
ZUhlaWdodCA9IDQgKiBCbG9ja0hlaWdodDI1NkJ5dGVzOworCX0gZWxzZSBpZiAoU3VyZmFjZVRp
bGluZyA9PSBkbV9zd182NGtiX3MgfHwgU3VyZmFjZVRpbGluZyA9PSBkbV9zd182NGtiX3NfdAor
CQkJfHwgU3VyZmFjZVRpbGluZyA9PSBkbV9zd182NGtiX3NfeCB8fCBTdXJmYWNlVGlsaW5nID09
IGRtX3N3XzY0a2JfZAorCQkJfHwgU3VyZmFjZVRpbGluZyA9PSBkbV9zd182NGtiX2RfdCB8fCBT
dXJmYWNlVGlsaW5nID09IGRtX3N3XzY0a2JfZF94CisJCQl8fCBTdXJmYWNlVGlsaW5nID09IGRt
X3N3XzY0a2Jfcl94KSB7CisJCU1hY3JvVGlsZVNpemVCeXRlcyA9IDY1NTM2OworCQlNYWNyb1Rp
bGVIZWlnaHQgPSAxNiAqIEJsb2NrSGVpZ2h0MjU2Qnl0ZXM7CisJfSBlbHNlIHsKKwkJTWFjcm9U
aWxlU2l6ZUJ5dGVzID0gMjYyMTQ0OworCQlNYWNyb1RpbGVIZWlnaHQgPSAzMiAqIEJsb2NrSGVp
Z2h0MjU2Qnl0ZXM7CisJfQorCSpNYWNyb1RpbGVXaWR0aCA9IE1hY3JvVGlsZVNpemVCeXRlcyAv
IEJ5dGVQZXJQaXhlbCAvIE1hY3JvVGlsZUhlaWdodDsKKworCWlmIChHUFVWTUVuYWJsZSA9PSB0
cnVlICYmIG1vZGVfbGliLT52YmEuR1BVVk1NYXhQYWdlVGFibGVMZXZlbHMgPiAxKSB7CisJCWlm
IChTY2FuRGlyZWN0aW9uID09IGRtX2hvcnopIHsKKwkJCURQREUwQnl0ZXNGcmFtZSA9CisJCQkJ
CTY0CisJCQkJCQkJKiAoZG1sX2NlaWwoCisJCQkJCQkJCQkoKFBpdGNoCisJCQkJCQkJCQkJCSog
KGRtbF9jZWlsKAorCQkJCQkJCQkJCQkJCVZpZXdwb3J0SGVpZ2h0CisJCQkJCQkJCQkJCQkJCQkt
IDEsCisJCQkJCQkJCQkJCQkJTWFjcm9UaWxlSGVpZ2h0KQorCQkJCQkJCQkJCQkJCSsgTWFjcm9U
aWxlSGVpZ2h0KQorCQkJCQkJCQkJCQkqIEJ5dGVQZXJQaXhlbCkKKwkJCQkJCQkJCQkJLSBNYWNy
b1RpbGVTaXplQnl0ZXMpCisJCQkJCQkJCQkJCS8gKDgKKwkJCQkJCQkJCQkJCQkqIDIwOTcxNTIp
LAorCQkJCQkJCQkJMSkgKyAxKTsKKwkJfSBlbHNlIHsKKwkJCURQREUwQnl0ZXNGcmFtZSA9CisJ
CQkJCTY0CisJCQkJCQkJKiAoZG1sX2NlaWwoCisJCQkJCQkJCQkoKFBpdGNoCisJCQkJCQkJCQkJ
CSogKGRtbF9jZWlsKAorCQkJCQkJCQkJCQkJCShkb3VibGUpIFN3YXRoV2lkdGgKKwkJCQkJCQkJ
CQkJCQkJCS0gMSwKKwkJCQkJCQkJCQkJCQlNYWNyb1RpbGVIZWlnaHQpCisJCQkJCQkJCQkJCQkJ
KyBNYWNyb1RpbGVIZWlnaHQpCisJCQkJCQkJCQkJCSogQnl0ZVBlclBpeGVsKQorCQkJCQkJCQkJ
CQktIE1hY3JvVGlsZVNpemVCeXRlcykKKwkJCQkJCQkJCQkJLyAoOAorCQkJCQkJCQkJCQkJCSog
MjA5NzE1MiksCisJCQkJCQkJCQkxKSArIDEpOworCQl9CisJCUV4dHJhRFBERUJ5dGVzRnJhbWUg
PSAxMjggKiAobW9kZV9saWItPnZiYS5HUFVWTU1heFBhZ2VUYWJsZUxldmVscyAtIDIpOworCX0g
ZWxzZSB7CisJCURQREUwQnl0ZXNGcmFtZSA9IDA7CisJCUV4dHJhRFBERUJ5dGVzRnJhbWUgPSAw
OworCX0KKworCVBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lID0gTWV0YVBURUJ5dGVzRnJhbWUgKyBN
UERFQnl0ZXNGcmFtZSArIERQREUwQnl0ZXNGcmFtZQorCQkJKyBFeHRyYURQREVCeXRlc0ZyYW1l
OworCisJaWYgKEdQVVZNRW5hYmxlID09IHRydWUpIHsKKwkJdW5zaWduZWQgaW50IFBURVJlcXVl
c3RTaXplOworCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVSZXFIZWlnaHQ7CisJCXVuc2lnbmVkIGlu
dCBQaXhlbFBURVJlcVdpZHRoOworCQlkb3VibGUgRnJhY3Rpb25PZlBURVJldHVybkRyb3A7CisJ
CXVuc2lnbmVkIGludCBFZmZlY3RpdmVQREVQcm9jZXNzaW5nQnVmSW42NEtCUmVxczsKKworCQlp
ZiAoU3VyZmFjZVRpbGluZyA9PSBkbV9zd19saW5lYXIpIHsKKwkJCVBpeGVsUFRFUmVxSGVpZ2h0
ID0gMTsKKwkJCVBpeGVsUFRFUmVxV2lkdGggPSA4LjAgKiBWTU1QYWdlU2l6ZSAvIEJ5dGVQZXJQ
aXhlbDsKKwkJCVBURVJlcXVlc3RTaXplID0gNjQ7CisJCQlGcmFjdGlvbk9mUFRFUmV0dXJuRHJv
cCA9IDA7CisJCX0gZWxzZSBpZiAoTWFjcm9UaWxlU2l6ZUJ5dGVzID09IDQwOTYpIHsKKwkJCVBp
eGVsUFRFUmVxSGVpZ2h0ID0gTWFjcm9UaWxlSGVpZ2h0OworCQkJUGl4ZWxQVEVSZXFXaWR0aCA9
IDggKiAqTWFjcm9UaWxlV2lkdGg7CisJCQlQVEVSZXF1ZXN0U2l6ZSA9IDY0OworCQkJaWYgKFNj
YW5EaXJlY3Rpb24gPT0gZG1faG9yeikKKwkJCQlGcmFjdGlvbk9mUFRFUmV0dXJuRHJvcCA9IDA7
CisJCQllbHNlCisJCQkJRnJhY3Rpb25PZlBURVJldHVybkRyb3AgPSA3IC8gODsKKwkJfSBlbHNl
IGlmIChWTU1QYWdlU2l6ZSA9PSA0MDk2ICYmIE1hY3JvVGlsZVNpemVCeXRlcyA+IDQwOTYpIHsK
KwkJCVBpeGVsUFRFUmVxSGVpZ2h0ID0gMTYgKiBCbG9ja0hlaWdodDI1NkJ5dGVzOworCQkJUGl4
ZWxQVEVSZXFXaWR0aCA9IDE2ICogQmxvY2tXaWR0aDI1NkJ5dGVzOworCQkJUFRFUmVxdWVzdFNp
emUgPSAxMjg7CisJCQlGcmFjdGlvbk9mUFRFUmV0dXJuRHJvcCA9IDA7CisJCX0gZWxzZSB7CisJ
CQlQaXhlbFBURVJlcUhlaWdodCA9IE1hY3JvVGlsZUhlaWdodDsKKwkJCVBpeGVsUFRFUmVxV2lk
dGggPSA4ICogKk1hY3JvVGlsZVdpZHRoOworCQkJUFRFUmVxdWVzdFNpemUgPSA2NDsKKwkJCUZy
YWN0aW9uT2ZQVEVSZXR1cm5Ecm9wID0gMDsKKwkJfQorCisJCWlmIChTb3VyY2VQaXhlbEZvcm1h
dCA9PSBkbV80MjBfOCB8fCBTb3VyY2VQaXhlbEZvcm1hdCA9PSBkbV80MjBfMTApCisJCQlFZmZl
Y3RpdmVQREVQcm9jZXNzaW5nQnVmSW42NEtCUmVxcyA9IFBERVByb2Nlc3NpbmdCdWZJbjY0S0JS
ZXFzIC8gMjsKKwkJZWxzZQorCQkJRWZmZWN0aXZlUERFUHJvY2Vzc2luZ0J1ZkluNjRLQlJlcXMg
PSBQREVQcm9jZXNzaW5nQnVmSW42NEtCUmVxczsKKworCQlpZiAoU3VyZmFjZVRpbGluZyA9PSBk
bV9zd19saW5lYXIpIHsKKwkJCSpkcHRlX3Jvd19oZWlnaHQgPQorCQkJCQlkbWxfbWluKAorCQkJ
CQkJCTEyOCwKKwkJCQkJCQkxCisJCQkJCQkJCQk8PCAodW5zaWduZWQgaW50KSBkbWxfZmxvb3Io
CisJCQkJCQkJCQkJCWRtbF9sb2cyKAorCQkJCQkJCQkJCQkJCWRtbF9taW4oCisJCQkJCQkJCQkJ
CQkJCQkoZG91YmxlKSBQVEVCdWZmZXJTaXplSW5SZXF1ZXN0c0x1bWEKKwkJCQkJCQkJCQkJCQkJ
CQkJKiBQaXhlbFBURVJlcVdpZHRoLAorCQkJCQkJCQkJCQkJCQkJRWZmZWN0aXZlUERFUHJvY2Vz
c2luZ0J1ZkluNjRLQlJlcXMKKwkJCQkJCQkJCQkJCQkJCQkJKiA2NTUzNi4wCisJCQkJCQkJCQkJ
CQkJCQkJCS8gQnl0ZVBlclBpeGVsKQorCQkJCQkJCQkJCQkJCQkJLyBQaXRjaCksCisJCQkJCQkJ
CQkJCTEpKTsKKwkJCSpQaXhlbFBURUJ5dGVzUGVyUm93ID0gUFRFUmVxdWVzdFNpemUKKwkJCQkJ
KiAoZG1sX2NlaWwoCisJCQkJCQkJKGRvdWJsZSkgKFBpdGNoICogKmRwdGVfcm93X2hlaWdodCAt
IDEpCisJCQkJCQkJCQkvIFBpeGVsUFRFUmVxV2lkdGgsCisJCQkJCQkJMSkgKyAxKTsKKwkJfSBl
bHNlIGlmIChTY2FuRGlyZWN0aW9uID09IGRtX2hvcnopIHsKKwkJCSpkcHRlX3Jvd19oZWlnaHQg
PSBQaXhlbFBURVJlcUhlaWdodDsKKwkJCSpQaXhlbFBURUJ5dGVzUGVyUm93ID0gUFRFUmVxdWVz
dFNpemUKKwkJCQkJKiAoZG1sX2NlaWwoKChkb3VibGUpIFN3YXRoV2lkdGggLSAxKSAvIFBpeGVs
UFRFUmVxV2lkdGgsIDEpCisJCQkJCQkJKyAxKTsKKwkJfSBlbHNlIHsKKwkJCSpkcHRlX3Jvd19o
ZWlnaHQgPSBkbWxfbWluKFBpeGVsUFRFUmVxV2lkdGgsICpNYWNyb1RpbGVXaWR0aCk7CisJCQkq
UGl4ZWxQVEVCeXRlc1BlclJvdyA9IFBURVJlcXVlc3RTaXplCisJCQkJCSogKGRtbF9jZWlsKAor
CQkJCQkJCSgoZG91YmxlKSBTd2F0aFdpZHRoIC0gMSkKKwkJCQkJCQkJCS8gUGl4ZWxQVEVSZXFI
ZWlnaHQsCisJCQkJCQkJMSkgKyAxKTsKKwkJfQorCQlpZiAoKlBpeGVsUFRFQnl0ZXNQZXJSb3cg
KiAoMSAtIEZyYWN0aW9uT2ZQVEVSZXR1cm5Ecm9wKQorCQkJCTw9IDY0ICogUFRFQnVmZmVyU2l6
ZUluUmVxdWVzdHNMdW1hKSB7CisJCQkqUFRFQnVmZmVyU2l6ZU5vdEV4Y2VlZGVkID0gdHJ1ZTsK
KwkJfSBlbHNlIHsKKwkJCSpQVEVCdWZmZXJTaXplTm90RXhjZWVkZWQgPSBmYWxzZTsKKwkJfQor
CX0gZWxzZSB7CisJCSpQaXhlbFBURUJ5dGVzUGVyUm93ID0gMDsKKwkJKlBURUJ1ZmZlclNpemVO
b3RFeGNlZWRlZCA9IHRydWU7CisJfQorCisJcmV0dXJuIFBERUFuZE1ldGFQVEVCeXRlc0ZyYW1l
OworfQorCitzdGF0aWMgdm9pZCBkbWwyMF9ESVNQQ0xLRFBQQ0xLRENGQ0xLRGVlcFNsZWVwUHJl
ZmV0Y2hQYXJhbWV0ZXJzV2F0ZXJtYXJrc0FuZFBlcmZvcm1hbmNlQ2FsY3VsYXRpb24oCisJCXN0
cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYikKK3sKKwl1bnNpZ25lZCBpbnQgaiwgazsK
KworCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRElTUENMSyA9IDAuMDsKKwltb2RlX2xpYi0+dmJh
LkRJU1BDTEtXaXRoUmFtcGluZyA9IDA7CisJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aG91dFJh
bXBpbmcgPSAwOworCW1vZGVfbGliLT52YmEuR2xvYmFsRFBQQ0xLID0gMC4wOworCisJLy8gZG1s
X21sLT52YmEuRElTUENMSyBhbmQgZG1sX21sLT52YmEuRFBQQ0xLIENhbGN1bGF0aW9uCisJLy8K
Kwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytr
KSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSkgeworCQkJbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tESVNQQ0xLID0KKwkJCQkJZG1sX21heCgKKwkJCQkJCQltb2RlX2xp
Yi0+dmJhLldyaXRlYmFja0RJU1BDTEssCisJCQkJCQkJQ2FsY3VsYXRlV3JpdGVCYWNrRElTUENM
SygKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRba10sCisJCQkJ
CQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJh
LldyaXRlYmFja0hSYXRpb1trXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrVlJh
dGlvW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRhcHNba10sCisJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFWVGFwc1trXSwKKwkJCQkJCQkJCW1v
ZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hSFRhcHNba10sCisJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLldyaXRlYmFja0Nocm9tYVZUYXBzW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0
ZWJhY2tEZXN0aW5hdGlvbldpZHRoW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IVG90YWxb
a10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYUxpbmVCdWZmZXJXaWR0
aCkpOworCQl9CisJfQorCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZB
Y3RpdmVQbGFuZXM7ICsraykgeworCQlpZiAobW9kZV9saWItPnZiYS5IUmF0aW9ba10gPiAxKSB7
CisJCQltb2RlX2xpYi0+dmJhLlBTQ0xfVEhST1VHSFBVVF9MVU1BW2tdID0gZG1sX21pbigKKwkJ
CQkJbW9kZV9saWItPnZiYS5NYXhEQ0hVQlRvUFNDTFRocm91Z2hwdXQsCisJCQkJCW1vZGVfbGli
LT52YmEuTWF4UFNDTFRvTEJUaHJvdWdocHV0CisJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhSYXRp
b1trXQorCQkJCQkJCS8gZG1sX2NlaWwoCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLmh0YXBzW2td
CisJCQkJCQkJCQkJCS8gNi4wLAorCQkJCQkJCQkJMSkpOworCQl9IGVsc2UgeworCQkJbW9kZV9s
aWItPnZiYS5QU0NMX1RIUk9VR0hQVVRfTFVNQVtrXSA9IGRtbF9taW4oCisJCQkJCW1vZGVfbGli
LT52YmEuTWF4RENIVUJUb1BTQ0xUaHJvdWdocHV0LAorCQkJCQltb2RlX2xpYi0+dmJhLk1heFBT
Q0xUb0xCVGhyb3VnaHB1dCk7CisJCX0KKworCQltb2RlX2xpYi0+dmJhLkRQUENMS1VzaW5nU2lu
Z2xlRFBQTHVtYSA9CisJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCQkqIGRt
bF9tYXgoCisJCQkJCQkJCW1vZGVfbGliLT52YmEudnRhcHNba10gLyA2LjAKKwkJCQkJCQkJCQkq
IGRtbF9taW4oCisJCQkJCQkJCQkJCQkxLjAsCisJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhS
YXRpb1trXSksCisJCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IUmF0
aW9ba10KKwkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5WUmF0aW9ba10KKwkJCQkJCQkJCQkJ
CS8gbW9kZV9saWItPnZiYS5QU0NMX1RIUk9VR0hQVVRfTFVNQVtrXSwKKwkJCQkJCQkJCQkxLjAp
KTsKKworCQlpZiAoKG1vZGVfbGliLT52YmEuaHRhcHNba10gPiA2IHx8IG1vZGVfbGliLT52YmEu
dnRhcHNba10gPiA2KQorCQkJCSYmIG1vZGVfbGliLT52YmEuRFBQQ0xLVXNpbmdTaW5nbGVEUFBM
dW1hCisJCQkJCQk8IDIgKiBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pIHsKKwkJCW1vZGVf
bGliLT52YmEuRFBQQ0xLVXNpbmdTaW5nbGVEUFBMdW1hID0gMiAqIG1vZGVfbGliLT52YmEuUGl4
ZWxDbG9ja1trXTsKKwkJfQorCisJCWlmICgobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1h
dFtrXSAhPSBkbV80MjBfOAorCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRb
a10gIT0gZG1fNDIwXzEwKSkgeworCQkJbW9kZV9saWItPnZiYS5QU0NMX1RIUk9VR0hQVVRfQ0hS
T01BW2tdID0gMC4wOworCQkJbW9kZV9saWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQUFtrXSA9
CisJCQkJCW1vZGVfbGliLT52YmEuRFBQQ0xLVXNpbmdTaW5nbGVEUFBMdW1hOworCQl9IGVsc2Ug
eworCQkJaWYgKG1vZGVfbGliLT52YmEuSFJhdGlvW2tdID4gMSkgeworCQkJCW1vZGVfbGliLT52
YmEuUFNDTF9USFJPVUdIUFVUX0NIUk9NQVtrXSA9CisJCQkJCQlkbWxfbWluKAorCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLk1heERDSFVCVG9QU0NMVGhyb3VnaHB1dCwKKwkJCQkJCQkJbW9kZV9saWIt
PnZiYS5NYXhQU0NMVG9MQlRocm91Z2hwdXQKKwkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuSFJh
dGlvW2tdCisJCQkJCQkJCQkJLyAyCisJCQkJCQkJCQkJLyBkbWxfY2VpbCgKKwkJCQkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuSFRBUHNDaHJvbWFba10KKwkJCQkJCQkJCQkJCQkJLyA2LjAsCisJCQkJ
CQkJCQkJCQkxLjApKTsKKwkJCX0gZWxzZSB7CisJCQkJbW9kZV9saWItPnZiYS5QU0NMX1RIUk9V
R0hQVVRfQ0hST01BW2tdID0gZG1sX21pbigKKwkJCQkJCW1vZGVfbGliLT52YmEuTWF4RENIVUJU
b1BTQ0xUaHJvdWdocHV0LAorCQkJCQkJbW9kZV9saWItPnZiYS5NYXhQU0NMVG9MQlRocm91Z2hw
dXQpOworCQkJfQorCQkJbW9kZV9saWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQUENocm9tYSA9
CisJCQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXQorCQkJCQkJCSogZG1sX21heCgKKwkJ
CQkJCQkJCW1vZGVfbGliLT52YmEuVlRBUHNDaHJvbWFba10KKwkJCQkJCQkJCQkJLyA2LjAKKwkJ
CQkJCQkJCQkJKiBkbWxfbWluKAorCQkJCQkJCQkJCQkJCTEuMCwKKwkJCQkJCQkJCQkJCQltb2Rl
X2xpYi0+dmJhLkhSYXRpb1trXQorCQkJCQkJCQkJCQkJCQkJLyAyKSwKKwkJCQkJCQkJCWRtbF9t
YXgoCisJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuSFJhdGlvW2tdCisJCQkJCQkJCQkJCQkJKiBt
b2RlX2xpYi0+dmJhLlZSYXRpb1trXQorCQkJCQkJCQkJCQkJCS8gNAorCQkJCQkJCQkJCQkJCS8g
bW9kZV9saWItPnZiYS5QU0NMX1RIUk9VR0hQVVRfQ0hST01BW2tdLAorCQkJCQkJCQkJCQkxLjAp
KTsKKworCQkJaWYgKChtb2RlX2xpYi0+dmJhLkhUQVBzQ2hyb21hW2tdID4gNiB8fCBtb2RlX2xp
Yi0+dmJhLlZUQVBzQ2hyb21hW2tdID4gNikKKwkJCQkJJiYgbW9kZV9saWItPnZiYS5EUFBDTEtV
c2luZ1NpbmdsZURQUENocm9tYQorCQkJCQkJCTwgMiAqIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9j
a1trXSkgeworCQkJCW1vZGVfbGliLT52YmEuRFBQQ0xLVXNpbmdTaW5nbGVEUFBDaHJvbWEgPSAy
CisJCQkJCQkqIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXTsKKwkJCX0KKworCQkJbW9kZV9s
aWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQUFtrXSA9IGRtbF9tYXgoCisJCQkJCW1vZGVfbGli
LT52YmEuRFBQQ0xLVXNpbmdTaW5nbGVEUFBMdW1hLAorCQkJCQltb2RlX2xpYi0+dmJhLkRQUENM
S1VzaW5nU2luZ2xlRFBQQ2hyb21hKTsKKwkJfQorCX0KKworCWZvciAoayA9IDA7IGsgPCBtb2Rl
X2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKG1vZGVfbGliLT52
YmEuQmxlbmRpbmdBbmRUaW1pbmdba10gIT0gaykKKwkJCWNvbnRpbnVlOworCQlpZiAobW9kZV9s
aWItPnZiYS5PRE1Db21iaW5lRW5hYmxlZFtrXSkgeworCQkJbW9kZV9saWItPnZiYS5ESVNQQ0xL
V2l0aFJhbXBpbmcgPQorCQkJCQlkbWxfbWF4KAorCQkJCQkJCW1vZGVfbGliLT52YmEuRElTUENM
S1dpdGhSYW1waW5nLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSAvIDIKKwkJ
CQkJCQkJCSogKDEKKwkJCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0ND
TEtEb3duU3ByZWFkaW5nCisJCQkJCQkJCQkJCQkJLyAxMDApCisJCQkJCQkJCQkqICgxCisJCQkJ
CQkJCQkJCSsgbW9kZV9saWItPnZiYS5ESVNQQ0xLUmFtcGluZ01hcmdpbgorCQkJCQkJCQkJCQkJ
CS8gMTAwKSk7CisJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRob3V0UmFtcGluZyA9CisJCQkJ
CWRtbF9tYXgoCisJCQkJCQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aG91dFJhbXBpbmcsCisJ
CQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdIC8gMgorCQkJCQkJCQkJKiAoMQorCQkJ
CQkJCQkJCQkrIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcK
KwkJCQkJCQkJCQkJCQkvIDEwMCkpOworCQl9IGVsc2UgaWYgKCFtb2RlX2xpYi0+dmJhLk9ETUNv
bWJpbmVFbmFibGVkW2tdKSB7CisJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRoUmFtcGluZyA9
CisJCQkJCWRtbF9tYXgoCisJCQkJCQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aFJhbXBpbmcs
CisJCQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCQkJCQkqICgxCisJCQkJ
CQkJCQkJCSsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGluZwor
CQkJCQkJCQkJCQkJCS8gMTAwKQorCQkJCQkJCQkJKiAoMQorCQkJCQkJCQkJCQkrIG1vZGVfbGli
LT52YmEuRElTUENMS1JhbXBpbmdNYXJnaW4KKwkJCQkJCQkJCQkJCQkvIDEwMCkpOworCQkJbW9k
ZV9saWItPnZiYS5ESVNQQ0xLV2l0aG91dFJhbXBpbmcgPQorCQkJCQlkbWxfbWF4KAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRSYW1waW5nLAorCQkJCQkJCW1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja1trXQorCQkJCQkJCQkJKiAoMQorCQkJCQkJCQkJCQkrIG1vZGVfbGliLT52
YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcKKwkJCQkJCQkJCQkJCQkvIDEwMCkp
OworCQl9CisJfQorCisJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aFJhbXBpbmcgPSBkbWxfbWF4
KAorCQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aFJhbXBpbmcsCisJCQltb2RlX2xpYi0+dmJh
LldyaXRlYmFja0RJU1BDTEspOworCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRSYW1waW5n
ID0gZG1sX21heCgKKwkJCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRSYW1waW5nLAorCQkJ
bW9kZV9saWItPnZiYS5Xcml0ZWJhY2tESVNQQ0xLKTsKKworCUFTU0VSVChtb2RlX2xpYi0+dmJh
LkRJU1BDTEtEUFBDTEtWQ09TcGVlZCAhPSAwKTsKKwltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRo
UmFtcGluZ1JvdW5kZWRUb0RGU0dyYW51bGFyaXR5ID0gUm91bmRUb0RGU0dyYW51bGFyaXR5VXAo
CisJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRoUmFtcGluZywKKwkJCW1vZGVfbGliLT52YmEu
RElTUENMS0RQUENMS1ZDT1NwZWVkKTsKKwltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRob3V0UmFt
cGluZ1JvdW5kZWRUb0RGU0dyYW51bGFyaXR5ID0gUm91bmRUb0RGU0dyYW51bGFyaXR5VXAoCisJ
CQltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRob3V0UmFtcGluZywKKwkJCW1vZGVfbGliLT52YmEu
RElTUENMS0RQUENMS1ZDT1NwZWVkKTsKKwltb2RlX2xpYi0+dmJhLk1heERpc3BjbGtSb3VuZGVk
VG9ERlNHcmFudWxhcml0eSA9IFJvdW5kVG9ERlNHcmFudWxhcml0eURvd24oCisJCQltb2RlX2xp
Yi0+dmJhLnNvYy5jbG9ja19saW1pdHNbbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlc10uZGlz
cGNsa19taHosCisJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtWQ09TcGVlZCk7CisJaWYg
KG1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRSYW1waW5nUm91bmRlZFRvREZTR3JhbnVsYXJp
dHkKKwkJCT4gbW9kZV9saWItPnZiYS5NYXhEaXNwY2xrUm91bmRlZFRvREZTR3JhbnVsYXJpdHkp
IHsKKwkJbW9kZV9saWItPnZiYS5ESVNQQ0xLX2NhbGN1bGF0ZWQgPQorCQkJCW1vZGVfbGliLT52
YmEuRElTUENMS1dpdGhvdXRSYW1waW5nUm91bmRlZFRvREZTR3JhbnVsYXJpdHk7CisJfSBlbHNl
IGlmIChtb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRoUmFtcGluZ1JvdW5kZWRUb0RGU0dyYW51bGFy
aXR5CisJCQk+IG1vZGVfbGliLT52YmEuTWF4RGlzcGNsa1JvdW5kZWRUb0RGU0dyYW51bGFyaXR5
KSB7CisJCW1vZGVfbGliLT52YmEuRElTUENMS19jYWxjdWxhdGVkID0gbW9kZV9saWItPnZiYS5N
YXhEaXNwY2xrUm91bmRlZFRvREZTR3JhbnVsYXJpdHk7CisJfSBlbHNlIHsKKwkJbW9kZV9saWIt
PnZiYS5ESVNQQ0xLX2NhbGN1bGF0ZWQgPQorCQkJCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhS
YW1waW5nUm91bmRlZFRvREZTR3JhbnVsYXJpdHk7CisJfQorCURUUkFDRSgiICAgZGlzcGNsa19t
aHogKGNhbGN1bGF0ZWQpID0gJWYiLCBtb2RlX2xpYi0+dmJhLkRJU1BDTEtfY2FsY3VsYXRlZCk7
CisKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsg
KytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdID09IDApIHsKKwkJCW1v
ZGVfbGliLT52YmEuRFBQQ0xLX2NhbGN1bGF0ZWRba10gPSAwOworCQl9IGVsc2UgeworCQkJbW9k
ZV9saWItPnZiYS5EUFBDTEtfY2FsY3VsYXRlZFtrXSA9IG1vZGVfbGliLT52YmEuRFBQQ0xLVXNp
bmdTaW5nbGVEUFBba10KKwkJCQkJLyBtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdCisJCQkJ
CSogKDEgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0NDTEtEb3duU3ByZWFkaW5nIC8g
MTAwKTsKKwkJfQorCQltb2RlX2xpYi0+dmJhLkdsb2JhbERQUENMSyA9IGRtbF9tYXgoCisJCQkJ
bW9kZV9saWItPnZiYS5HbG9iYWxEUFBDTEssCisJCQkJbW9kZV9saWItPnZiYS5EUFBDTEtfY2Fs
Y3VsYXRlZFtrXSk7CisJfQorCW1vZGVfbGliLT52YmEuR2xvYmFsRFBQQ0xLID0gUm91bmRUb0RG
U0dyYW51bGFyaXR5VXAoCisJCQltb2RlX2xpYi0+dmJhLkdsb2JhbERQUENMSywKKwkJCW1vZGVf
bGliLT52YmEuRElTUENMS0RQUENMS1ZDT1NwZWVkKTsKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9s
aWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCW1vZGVfbGliLT52YmEuRFBQ
Q0xLX2NhbGN1bGF0ZWRba10gPSBtb2RlX2xpYi0+dmJhLkdsb2JhbERQUENMSyAvIDI1NQorCQkJ
CSogZG1sX2NlaWwoCisJCQkJCQltb2RlX2xpYi0+dmJhLkRQUENMS19jYWxjdWxhdGVkW2tdICog
MjU1CisJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5HbG9iYWxEUFBDTEssCisJCQkJCQkxKTsKKwkJ
RFRSQUNFKCIgICBkcHBjbGtfbWh6WyVpXSAoY2FsY3VsYXRlZCkgPSAlZiIsIGssIG1vZGVfbGli
LT52YmEuRFBQQ0xLX2NhbGN1bGF0ZWRba10pOworCX0KKworCS8vIFVyZ2VudCBXYXRlcm1hcmsK
Kwltb2RlX2xpYi0+dmJhLkRDQ0VuYWJsZWRBbnlQbGFuZSA9IGZhbHNlOworCWZvciAoayA9IDA7
IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spCisJCWlmIChtb2Rl
X2xpYi0+dmJhLkRDQ0VuYWJsZVtrXSkKKwkJCW1vZGVfbGliLT52YmEuRENDRW5hYmxlZEFueVBs
YW5lID0gdHJ1ZTsKKworCW1vZGVfbGliLT52YmEuUmV0dXJuQmFuZHdpZHRoVG9EQ04gPSBkbWxf
bWluKAorCQkJbW9kZV9saWItPnZiYS5SZXR1cm5CdXNXaWR0aCAqIG1vZGVfbGliLT52YmEuRENG
Q0xLLAorCQkJbW9kZV9saWItPnZiYS5GYWJyaWNBbmREUkFNQmFuZHdpZHRoICogMTAwMCkKKwkJ
CSogbW9kZV9saWItPnZiYS5QZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQb3J0QldSZWNl
aXZlZEFmdGVyVXJnTGF0ZW5jeVBpeGVsRGF0YU9ubHkgLyAxMDA7CisKKwltb2RlX2xpYi0+dmJh
LlJldHVybkJXID0gbW9kZV9saWItPnZiYS5SZXR1cm5CYW5kd2lkdGhUb0RDTjsKKwltb2RlX2xp
Yi0+dmJhLlJldHVybkJXID0gYWRqdXN0X1JldHVybkJXKAorCQkJbW9kZV9saWIsCisJCQltb2Rl
X2xpYi0+dmJhLlJldHVybkJXLAorCQkJbW9kZV9saWItPnZiYS5EQ0NFbmFibGVkQW55UGxhbmUs
CisJCQltb2RlX2xpYi0+dmJhLlJldHVybkJhbmR3aWR0aFRvRENOKTsKKworCS8vIExldCdzIGRv
IHRoaXMgY2FsY3VsYXRpb24gYWdhaW4/PworCW1vZGVfbGliLT52YmEuUmV0dXJuQmFuZHdpZHRo
VG9EQ04gPSBkbWxfbWluKAorCQkJbW9kZV9saWItPnZiYS5SZXR1cm5CdXNXaWR0aCAqIG1vZGVf
bGliLT52YmEuRENGQ0xLLAorCQkJbW9kZV9saWItPnZiYS5GYWJyaWNBbmREUkFNQmFuZHdpZHRo
ICogMTAwMCk7CisJbW9kZV9saWItPnZiYS5SZXR1cm5CVyA9IGFkanVzdF9SZXR1cm5CVygKKwkJ
CW1vZGVfbGliLAorCQkJbW9kZV9saWItPnZiYS5SZXR1cm5CVywKKwkJCW1vZGVfbGliLT52YmEu
RENDRW5hYmxlZEFueVBsYW5lLAorCQkJbW9kZV9saWItPnZiYS5SZXR1cm5CYW5kd2lkdGhUb0RD
Tik7CisKKwlEVFJBQ0UoIiAgIGRjZmNsa19taHogICAgICAgICA9ICVmIiwgbW9kZV9saWItPnZi
YS5EQ0ZDTEspOworCURUUkFDRSgiICAgcmV0dXJuX2J3X3RvX2RjbiAgID0gJWYiLCBtb2RlX2xp
Yi0+dmJhLlJldHVybkJhbmR3aWR0aFRvRENOKTsKKwlEVFJBQ0UoIiAgIHJldHVybl9idXNfYncg
ICAgICA9ICVmIiwgbW9kZV9saWItPnZiYS5SZXR1cm5CVyk7CisKKwlmb3IgKGsgPSAwOyBrIDwg
bW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWJvb2wgTWFpblBs
YW5lRG9lc09ETUNvbWJpbmUgPSBmYWxzZTsKKworCQlpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VT
Y2FuW2tdID09IGRtX2hvcnopCisJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhTaW5nbGVEUFBZ
W2tdID0gbW9kZV9saWItPnZiYS5WaWV3cG9ydFdpZHRoW2tdOworCQllbHNlCisJCQltb2RlX2xp
Yi0+dmJhLlN3YXRoV2lkdGhTaW5nbGVEUFBZW2tdID0gbW9kZV9saWItPnZiYS5WaWV3cG9ydEhl
aWdodFtrXTsKKworCQlpZiAobW9kZV9saWItPnZiYS5PRE1Db21iaW5lRW5hYmxlZFtrXSA9PSB0
cnVlKQorCQkJTWFpblBsYW5lRG9lc09ETUNvbWJpbmUgPSB0cnVlOworCQlmb3IgKGogPSAwOyBq
IDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytqKQorCQkJaWYgKG1vZGVf
bGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdba10gPT0gagorCQkJCQkmJiBtb2RlX2xpYi0+dmJh
Lk9ETUNvbWJpbmVFbmFibGVkW2pdID09IHRydWUpCisJCQkJTWFpblBsYW5lRG9lc09ETUNvbWJp
bmUgPSB0cnVlOworCisJCWlmIChNYWluUGxhbmVEb2VzT0RNQ29tYmluZSA9PSB0cnVlKQorCQkJ
bW9kZV9saWItPnZiYS5Td2F0aFdpZHRoWVtrXSA9IGRtbF9taW4oCisJCQkJCShkb3VibGUpIG1v
ZGVfbGliLT52YmEuU3dhdGhXaWR0aFNpbmdsZURQUFlba10sCisJCQkJCWRtbF9yb3VuZCgKKwkJ
CQkJCQltb2RlX2xpYi0+dmJhLkhBY3RpdmVba10gLyAyLjAKKwkJCQkJCQkJCSogbW9kZV9saWIt
PnZiYS5IUmF0aW9ba10pKTsKKwkJZWxzZSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5EUFBQZXJQ
bGFuZVtrXSA9PSAwKSB7CisJCQkJbW9kZV9saWItPnZiYS5Td2F0aFdpZHRoWVtrXSA9IDA7CisJ
CQl9IGVsc2UgeworCQkJCW1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlba10gPSBtb2RlX2xpYi0+
dmJhLlN3YXRoV2lkdGhTaW5nbGVEUFBZW2tdCisJCQkJCQkvIG1vZGVfbGliLT52YmEuRFBQUGVy
UGxhbmVba107CisJCQl9CisJCX0KKwl9CisKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZi
YS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJj
ZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF82NCkgeworCQkJbW9kZV9saWItPnZiYS5CeXRlUGVy
UGl4ZWxERVRZW2tdID0gODsKKwkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUQ1trXSA9
IDA7CisJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBk
bV80NDRfMzIpIHsKKwkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUWVtrXSA9IDQ7CisJ
CQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10gPSAwOworCQl9IGVsc2UgaWYgKG1v
ZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzE2KSB7CisJCQltb2Rl
X2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVFlba10gPSAyOworCQkJbW9kZV9saWItPnZiYS5CeXRl
UGVyUGl4ZWxERVRDW2tdID0gMDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBp
eGVsRm9ybWF0W2tdID09IGRtXzQ0NF84KSB7CisJCQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhl
bERFVFlba10gPSAxOworCQkJbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRDW2tdID0gMDsK
KwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQy
MF84KSB7CisJCQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVFlba10gPSAxOworCQkJbW9k
ZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRDW2tdID0gMjsKKwkJfSBlbHNlIHsgLy8gZG1fNDIw
XzEwCisJCQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVFlba10gPSA0LjAgLyAzLjA7CisJ
CQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10gPSA4LjAgLyAzLjA7CisJCX0KKwl9
CisKKwltb2RlX2xpYi0+dmJhLlRvdGFsRGF0YVJlYWRCYW5kd2lkdGggPSAwLjA7CisJZm9yIChr
ID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlt
b2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUx1bWFba10gPSBtb2RlX2xpYi0+dmJhLlN3
YXRoV2lkdGhTaW5nbGVEUFBZW2tdCisJCQkJKiBkbWxfY2VpbChtb2RlX2xpYi0+dmJhLkJ5dGVQ
ZXJQaXhlbERFVFlba10sIDEpCisJCQkJLyAobW9kZV9saWItPnZiYS5IVG90YWxba10gLyBtb2Rl
X2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pCisJCQkJKiBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXTsK
KwkJbW9kZV9saWItPnZiYS5SZWFkQmFuZHdpZHRoUGxhbmVDaHJvbWFba10gPSBtb2RlX2xpYi0+
dmJhLlN3YXRoV2lkdGhTaW5nbGVEUFBZW2tdCisJCQkJLyAyICogZG1sX2NlaWwobW9kZV9saWIt
PnZiYS5CeXRlUGVyUGl4ZWxERVRDW2tdLCAyKQorCQkJCS8gKG1vZGVfbGliLT52YmEuSFRvdGFs
W2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKQorCQkJCSogbW9kZV9saWItPnZiYS5W
UmF0aW9ba10gLyAyOworCQlEVFJBQ0UoCisJCQkJIiAgIHJlYWRfYndbJWldID0gJWZCcHMiLAor
CQkJCWssCisJCQkJbW9kZV9saWItPnZiYS5SZWFkQmFuZHdpZHRoUGxhbmVMdW1hW2tdCisJCQkJ
CQkrIG1vZGVfbGliLT52YmEuUmVhZEJhbmR3aWR0aFBsYW5lQ2hyb21hW2tdKTsKKwkJbW9kZV9s
aWItPnZiYS5Ub3RhbERhdGFSZWFkQmFuZHdpZHRoICs9IG1vZGVfbGliLT52YmEuUmVhZEJhbmR3
aWR0aFBsYW5lTHVtYVtrXQorCQkJCSsgbW9kZV9saWItPnZiYS5SZWFkQmFuZHdpZHRoUGxhbmVD
aHJvbWFba107CisJfQorCisJbW9kZV9saWItPnZiYS5Ub3RhbERDQ0FjdGl2ZURQUCA9IDA7CisJ
bW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZURQUCA9IDA7CisJZm9yIChrID0gMDsgayA8IG1vZGVf
bGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQltb2RlX2xpYi0+dmJhLlRv
dGFsQWN0aXZlRFBQID0gbW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZURQUAorCQkJCSsgbW9kZV9s
aWItPnZiYS5EUFBQZXJQbGFuZVtrXTsKKwkJaWYgKG1vZGVfbGliLT52YmEuRENDRW5hYmxlW2td
KQorCQkJbW9kZV9saWItPnZiYS5Ub3RhbERDQ0FjdGl2ZURQUCA9IG1vZGVfbGliLT52YmEuVG90
YWxEQ0NBY3RpdmVEUFAKKwkJCQkJKyBtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdOworCX0K
KworCW1vZGVfbGliLT52YmEuVXJnZW50Um91bmRUcmlwQW5kT3V0T2ZPcmRlckxhdGVuY3kgPQor
CQkJKG1vZGVfbGliLT52YmEuUm91bmRUcmlwUGluZ0xhdGVuY3lDeWNsZXMgKyAzMikgLyBtb2Rl
X2xpYi0+dmJhLkRDRkNMSworCQkJCQkrIG1vZGVfbGliLT52YmEuVXJnZW50T3V0T2ZPcmRlclJl
dHVyblBlckNoYW5uZWxQaXhlbERhdGFPbmx5CisJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLk51bWJl
ck9mQ2hhbm5lbHMKKwkJCQkJCQkvIG1vZGVfbGliLT52YmEuUmV0dXJuQlc7CisKKwltb2RlX2xp
Yi0+dmJhLkxhc3RQaXhlbE9mTGluZUV4dHJhV2F0ZXJtYXJrID0gMDsKKwlmb3IgKGsgPSAwOyBr
IDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWRvdWJsZSBE
YXRhRmFicmljTGluZURlbGl2ZXJ5VGltZUx1bWEsIERhdGFGYWJyaWNMaW5lRGVsaXZlcnlUaW1l
Q2hyb21hOworCisJCWlmIChtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSA8PSAxLjApCisJCQltb2Rl
X2xpYi0+dmJhLkRpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWFba10gPQorCQkJCQkoZG91
YmxlKSBtb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdCisJCQkJCQkJKiBtb2RlX2xpYi0+dmJh
LkRQUFBlclBsYW5lW2tdCisJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkhSYXRpb1trXQorCQkJCQkJ
CS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdOworCQllbHNlCisJCQltb2RlX2xpYi0+dmJh
LkRpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWFba10gPQorCQkJCQkoZG91YmxlKSBtb2Rl
X2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdCisJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBTQ0xfVEhS
T1VHSFBVVF9MVU1BW2tdCisJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkRQUENMS1trXTsKKworCQlE
YXRhRmFicmljTGluZURlbGl2ZXJ5VGltZUx1bWEgPSBtb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhT
aW5nbGVEUFBZW2tdCisJCQkJKiBtb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0WVtrXQorCQkJCSog
ZG1sX2NlaWwobW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRZW2tdLCAxKQorCQkJCS8gKG1v
ZGVfbGliLT52YmEuUmV0dXJuQlcgKiBtb2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUx1
bWFba10KKwkJCQkJCS8gbW9kZV9saWItPnZiYS5Ub3RhbERhdGFSZWFkQmFuZHdpZHRoKTsKKwkJ
bW9kZV9saWItPnZiYS5MYXN0UGl4ZWxPZkxpbmVFeHRyYVdhdGVybWFyayA9IGRtbF9tYXgoCisJ
CQkJbW9kZV9saWItPnZiYS5MYXN0UGl4ZWxPZkxpbmVFeHRyYVdhdGVybWFyaywKKwkJCQlEYXRh
RmFicmljTGluZURlbGl2ZXJ5VGltZUx1bWEKKwkJCQkJCS0gbW9kZV9saWItPnZiYS5EaXNwbGF5
UGlwZUxpbmVEZWxpdmVyeVRpbWVMdW1hW2tdKTsKKworCQlpZiAobW9kZV9saWItPnZiYS5CeXRl
UGVyUGl4ZWxERVRDW2tdID09IDApCisJCQltb2RlX2xpYi0+dmJhLkRpc3BsYXlQaXBlTGluZURl
bGl2ZXJ5VGltZUNocm9tYVtrXSA9IDAuMDsKKwkJZWxzZSBpZiAobW9kZV9saWItPnZiYS5WUmF0
aW9ba10gLyAyLjAgPD0gMS4wKQorCQkJbW9kZV9saWItPnZiYS5EaXNwbGF5UGlwZUxpbmVEZWxp
dmVyeVRpbWVDaHJvbWFba10gPQorCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdIC8g
Mi4wCisJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdCisJCQkJCQkJLyAobW9k
ZV9saWItPnZiYS5IUmF0aW9ba10gLyAyLjApCisJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVs
Q2xvY2tba107CisJCWVsc2UKKwkJCW1vZGVfbGliLT52YmEuRGlzcGxheVBpcGVMaW5lRGVsaXZl
cnlUaW1lQ2hyb21hW2tdID0KKwkJCQkJbW9kZV9saWItPnZiYS5Td2F0aFdpZHRoWVtrXSAvIDIu
MAorCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QU0NMX1RIUk9VR0hQVVRfQ0hST01BW2tdCisJCQkJ
CQkJLyBtb2RlX2xpYi0+dmJhLkRQUENMS1trXTsKKworCQlEYXRhRmFicmljTGluZURlbGl2ZXJ5
VGltZUNocm9tYSA9IG1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFNpbmdsZURQUFlba10gLyAyLjAK
KwkJCQkqIG1vZGVfbGliLT52YmEuU3dhdGhIZWlnaHRDW2tdCisJCQkJKiBkbWxfY2VpbChtb2Rl
X2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10sIDIpCisJCQkJLyAobW9kZV9saWItPnZiYS5S
ZXR1cm5CVworCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtr
XQorCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlRvdGFsRGF0YVJlYWRCYW5kd2lkdGgpOworCQltb2Rl
X2xpYi0+dmJhLkxhc3RQaXhlbE9mTGluZUV4dHJhV2F0ZXJtYXJrID0KKwkJCQlkbWxfbWF4KAor
CQkJCQkJbW9kZV9saWItPnZiYS5MYXN0UGl4ZWxPZkxpbmVFeHRyYVdhdGVybWFyaywKKwkJCQkJ
CURhdGFGYWJyaWNMaW5lRGVsaXZlcnlUaW1lQ2hyb21hCisJCQkJCQkJCS0gbW9kZV9saWItPnZi
YS5EaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVDaHJvbWFba10pOworCX0KKworCW1vZGVfbGli
LT52YmEuVXJnZW50RXh0cmFMYXRlbmN5ID0gbW9kZV9saWItPnZiYS5VcmdlbnRSb3VuZFRyaXBB
bmRPdXRPZk9yZGVyTGF0ZW5jeQorCQkJKyAobW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZURQUCAq
IG1vZGVfbGliLT52YmEuUGl4ZWxDaHVua1NpemVJbktCeXRlCisJCQkJCSsgbW9kZV9saWItPnZi
YS5Ub3RhbERDQ0FjdGl2ZURQUAorCQkJCQkJCSogbW9kZV9saWItPnZiYS5NZXRhQ2h1bmtTaXpl
KSAqIDEwMjQuMAorCQkJCQkvIG1vZGVfbGliLT52YmEuUmV0dXJuQlc7CisKKwlpZiAobW9kZV9s
aWItPnZiYS5HUFVWTUVuYWJsZSkKKwkJbW9kZV9saWItPnZiYS5VcmdlbnRFeHRyYUxhdGVuY3kg
Kz0gbW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZURQUAorCQkJCSogbW9kZV9saWItPnZiYS5QVEVH
cm91cFNpemUgLyBtb2RlX2xpYi0+dmJhLlJldHVybkJXOworCisJbW9kZV9saWItPnZiYS5Vcmdl
bnRXYXRlcm1hcmsgPSBtb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5CisJ
CQkrIG1vZGVfbGliLT52YmEuTGFzdFBpeGVsT2ZMaW5lRXh0cmFXYXRlcm1hcmsKKwkJCSsgbW9k
ZV9saWItPnZiYS5VcmdlbnRFeHRyYUxhdGVuY3k7CisKKwlEVFJBQ0UoIiAgIHVyZ2VudF9leHRy
YV9sYXRlbmN5ID0gJWZ1cyIsIG1vZGVfbGliLT52YmEuVXJnZW50RXh0cmFMYXRlbmN5KTsKKwlE
VFJBQ0UoIiAgIHdtX3VyZ2VudCA9ICVmdXMiLCBtb2RlX2xpYi0+dmJhLlVyZ2VudFdhdGVybWFy
ayk7CisKKwltb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3kgPSBtb2RlX2xpYi0+dmJhLlVyZ2Vu
dExhdGVuY3lQaXhlbERhdGFPbmx5OworCisJbW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZVdyaXRl
YmFjayA9IDA7CisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXM7ICsraykgeworCQlpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tFbmFibGVba10pCisJ
CQltb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlV3JpdGViYWNrID0gbW9kZV9saWItPnZiYS5Ub3Rh
bEFjdGl2ZVdyaXRlYmFjayArIG1vZGVfbGliLT52YmEuQWN0aXZlV3JpdGViYWNrc1BlclBsYW5l
W2tdOworCX0KKworCWlmIChtb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlV3JpdGViYWNrIDw9IDEp
CisJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrVXJnZW50V2F0ZXJtYXJrID0gbW9kZV9saWItPnZi
YS5Xcml0ZWJhY2tMYXRlbmN5OworCWVsc2UKKwkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tVcmdl
bnRXYXRlcm1hcmsgPSBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0xhdGVuY3kKKwkJCQkrIG1vZGVf
bGliLT52YmEuV3JpdGViYWNrQ2h1bmtTaXplICogMTAyNC4wIC8gMzIKKwkJCQkJCS8gbW9kZV9s
aWItPnZiYS5TT0NDTEs7CisKKwlEVFJBQ0UoIiAgIHdtX3diX3VyZ2VudCA9ICVmdXMiLCBtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja1VyZ2VudFdhdGVybWFyayk7CisKKwkvLyBOQiBQLVN0YXRlL0RS
QU0gQ2xvY2sgQ2hhbmdlIFdhdGVybWFyaworCW1vZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hhbmdl
V2F0ZXJtYXJrID0gbW9kZV9saWItPnZiYS5EUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5CisJCQkrIG1v
ZGVfbGliLT52YmEuVXJnZW50V2F0ZXJtYXJrOworCisJRFRSQUNFKCIgICB3bV9wc3RhdGVfY2hh
bmdlID0gJWZ1cyIsIG1vZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrKTsKKwor
CURUUkFDRSgiICAgY2FsY3VsYXRpbmcgd2IgcHN0YXRlIHdhdGVybWFyayIpOworCURUUkFDRSgi
ICAgICAgdG90YWwgd2Igb3V0cHV0cyAlZCIsIG1vZGVfbGliLT52YmEuVG90YWxBY3RpdmVXcml0
ZWJhY2spOworCURUUkFDRSgiICAgICAgc29jY2xrIGZyZXF1ZW5jeSAlZiBNaHoiLCBtb2RlX2xp
Yi0+dmJhLlNPQ0NMSyk7CisKKwlpZiAobW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZVdyaXRlYmFj
ayA8PSAxKQorCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0RSQU1DbG9ja0NoYW5nZVdhdGVybWFy
ayA9CisJCQkJbW9kZV9saWItPnZiYS5EUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5CisJCQkJCQkrIG1v
ZGVfbGliLT52YmEuV3JpdGViYWNrTGF0ZW5jeTsKKwllbHNlCisJCW1vZGVfbGliLT52YmEuV3Jp
dGViYWNrRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrID0KKwkJCQltb2RlX2xpYi0+dmJhLkRSQU1D
bG9ja0NoYW5nZUxhdGVuY3kKKwkJCQkJCSsgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMYXRlbmN5
CisJCQkJCQkrIG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2h1bmtTaXplICogMTAyNC4wIC8gMzIK
KwkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlNPQ0NMSzsKKworCURUUkFDRSgiICAgd21fd2JfcHN0
YXRlICVmdXMiLCBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0RSQU1DbG9ja0NoYW5nZVdhdGVybWFy
ayk7CisKKwkvLyBTdHV0dGVyIEVmZmljaWVuY3kKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCW1vZGVfbGliLT52YmEuTGluZXNJ
bkRFVFlba10gPSBtb2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVZW2tdCisJCQkJLyBtb2RlX2xp
Yi0+dmJhLkJ5dGVQZXJQaXhlbERFVFlba10gLyBtb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2td
OworCQltb2RlX2xpYi0+dmJhLkxpbmVzSW5ERVRZUm91bmRlZERvd25Ub1N3YXRoW2tdID0gZG1s
X2Zsb29yKAorCQkJCW1vZGVfbGliLT52YmEuTGluZXNJbkRFVFlba10sCisJCQkJbW9kZV9saWIt
PnZiYS5Td2F0aEhlaWdodFlba10pOworCQltb2RlX2xpYi0+dmJhLkZ1bGxERVRCdWZmZXJpbmdU
aW1lWVtrXSA9CisJCQkJbW9kZV9saWItPnZiYS5MaW5lc0luREVUWVJvdW5kZWREb3duVG9Td2F0
aFtrXQorCQkJCQkJKiAobW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJCQkJLyBtb2RlX2xp
Yi0+dmJhLlBpeGVsQ2xvY2tba10pCisJCQkJCQkvIG1vZGVfbGliLT52YmEuVlJhdGlvW2tdOwor
CQlpZiAobW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRDW2tdID4gMCkgeworCQkJbW9kZV9s
aWItPnZiYS5MaW5lc0luREVUQ1trXSA9IG1vZGVfbGliLT52YmEuREVUQnVmZmVyU2l6ZUNba10K
KwkJCQkJLyBtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10KKwkJCQkJLyAobW9kZV9s
aWItPnZiYS5Td2F0aFdpZHRoWVtrXSAvIDIpOworCQkJbW9kZV9saWItPnZiYS5MaW5lc0luREVU
Q1JvdW5kZWREb3duVG9Td2F0aFtrXSA9IGRtbF9mbG9vcigKKwkJCQkJbW9kZV9saWItPnZiYS5M
aW5lc0luREVUQ1trXSwKKwkJCQkJbW9kZV9saWItPnZiYS5Td2F0aEhlaWdodENba10pOworCQkJ
bW9kZV9saWItPnZiYS5GdWxsREVUQnVmZmVyaW5nVGltZUNba10gPQorCQkJCQltb2RlX2xpYi0+
dmJhLkxpbmVzSW5ERVRDUm91bmRlZERvd25Ub1N3YXRoW2tdCisJCQkJCQkJKiAobW9kZV9saWIt
PnZiYS5IVG90YWxba10KKwkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKQor
CQkJCQkJCS8gKG1vZGVfbGliLT52YmEuVlJhdGlvW2tdIC8gMik7CisJCX0gZWxzZSB7CisJCQlt
b2RlX2xpYi0+dmJhLkxpbmVzSW5ERVRDW2tdID0gMDsKKwkJCW1vZGVfbGliLT52YmEuTGluZXNJ
bkRFVENSb3VuZGVkRG93blRvU3dhdGhba10gPSAwOworCQkJbW9kZV9saWItPnZiYS5GdWxsREVU
QnVmZmVyaW5nVGltZUNba10gPSA5OTk5OTk7CisJCX0KKwl9CisKKwltb2RlX2xpYi0+dmJhLk1p
bkZ1bGxERVRCdWZmZXJpbmdUaW1lID0gOTk5OTk5LjA7CisJZm9yIChrID0gMDsgayA8IG1vZGVf
bGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlpZiAobW9kZV9saWItPnZi
YS5GdWxsREVUQnVmZmVyaW5nVGltZVlba10KKwkJCQk8IG1vZGVfbGliLT52YmEuTWluRnVsbERF
VEJ1ZmZlcmluZ1RpbWUpIHsKKwkJCW1vZGVfbGliLT52YmEuTWluRnVsbERFVEJ1ZmZlcmluZ1Rp
bWUgPQorCQkJCQltb2RlX2xpYi0+dmJhLkZ1bGxERVRCdWZmZXJpbmdUaW1lWVtrXTsKKwkJCW1v
ZGVfbGliLT52YmEuRnJhbWVUaW1lRm9yTWluRnVsbERFVEJ1ZmZlcmluZ1RpbWUgPQorCQkJCQko
ZG91YmxlKSBtb2RlX2xpYi0+dmJhLlZUb3RhbFtrXSAqIG1vZGVfbGliLT52YmEuSFRvdGFsW2td
CisJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba107CisJCX0KKwkJaWYgKG1vZGVf
bGliLT52YmEuRnVsbERFVEJ1ZmZlcmluZ1RpbWVDW2tdCisJCQkJPCBtb2RlX2xpYi0+dmJhLk1p
bkZ1bGxERVRCdWZmZXJpbmdUaW1lKSB7CisJCQltb2RlX2xpYi0+dmJhLk1pbkZ1bGxERVRCdWZm
ZXJpbmdUaW1lID0KKwkJCQkJbW9kZV9saWItPnZiYS5GdWxsREVUQnVmZmVyaW5nVGltZUNba107
CisJCQltb2RlX2xpYi0+dmJhLkZyYW1lVGltZUZvck1pbkZ1bGxERVRCdWZmZXJpbmdUaW1lID0K
KwkJCQkJKGRvdWJsZSkgbW9kZV9saWItPnZiYS5WVG90YWxba10gKiBtb2RlX2xpYi0+dmJhLkhU
b3RhbFtrXQorCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdOworCQl9CisJfQor
CisJbW9kZV9saWItPnZiYS5BdmVyYWdlUmVhZEJhbmR3aWR0aEdCeXRlUGVyU2Vjb25kID0gMC4w
OworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyAr
K2spIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuRENDRW5hYmxlW2tdKSB7CisJCQltb2RlX2xpYi0+
dmJhLkF2ZXJhZ2VSZWFkQmFuZHdpZHRoR0J5dGVQZXJTZWNvbmQgPQorCQkJCQltb2RlX2xpYi0+
dmJhLkF2ZXJhZ2VSZWFkQmFuZHdpZHRoR0J5dGVQZXJTZWNvbmQKKwkJCQkJCQkrIG1vZGVfbGli
LT52YmEuUmVhZEJhbmR3aWR0aFBsYW5lTHVtYVtrXQorCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJh
LkRDQ1JhdGVba10KKwkJCQkJCQkJCS8gMTAwMAorCQkJCQkJCSsgbW9kZV9saWItPnZiYS5SZWFk
QmFuZHdpZHRoUGxhbmVDaHJvbWFba10KKwkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5EQ0NSYXRl
W2tdCisJCQkJCQkJCQkvIDEwMDA7CisJCX0gZWxzZSB7CisJCQltb2RlX2xpYi0+dmJhLkF2ZXJh
Z2VSZWFkQmFuZHdpZHRoR0J5dGVQZXJTZWNvbmQgPQorCQkJCQltb2RlX2xpYi0+dmJhLkF2ZXJh
Z2VSZWFkQmFuZHdpZHRoR0J5dGVQZXJTZWNvbmQKKwkJCQkJCQkrIG1vZGVfbGliLT52YmEuUmVh
ZEJhbmR3aWR0aFBsYW5lTHVtYVtrXQorCQkJCQkJCQkJLyAxMDAwCisJCQkJCQkJKyBtb2RlX2xp
Yi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXQorCQkJCQkJCQkJLyAxMDAwOworCQl9
CisJCWlmIChtb2RlX2xpYi0+dmJhLkRDQ0VuYWJsZVtrXSkgeworCQkJbW9kZV9saWItPnZiYS5B
dmVyYWdlUmVhZEJhbmR3aWR0aEdCeXRlUGVyU2Vjb25kID0KKwkJCQkJbW9kZV9saWItPnZiYS5B
dmVyYWdlUmVhZEJhbmR3aWR0aEdCeXRlUGVyU2Vjb25kCisJCQkJCQkJKyBtb2RlX2xpYi0+dmJh
LlJlYWRCYW5kd2lkdGhQbGFuZUx1bWFba10KKwkJCQkJCQkJCS8gMTAwMCAvIDI1NgorCQkJCQkJ
CSsgbW9kZV9saWItPnZiYS5SZWFkQmFuZHdpZHRoUGxhbmVDaHJvbWFba10KKwkJCQkJCQkJCS8g
MTAwMCAvIDI1NjsKKwkJfQorCQlpZiAobW9kZV9saWItPnZiYS5HUFVWTUVuYWJsZSkgeworCQkJ
bW9kZV9saWItPnZiYS5BdmVyYWdlUmVhZEJhbmR3aWR0aEdCeXRlUGVyU2Vjb25kID0KKwkJCQkJ
bW9kZV9saWItPnZiYS5BdmVyYWdlUmVhZEJhbmR3aWR0aEdCeXRlUGVyU2Vjb25kCisJCQkJCQkJ
KyBtb2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUx1bWFba10KKwkJCQkJCQkJCS8gMTAw
MCAvIDUxMgorCQkJCQkJCSsgbW9kZV9saWItPnZiYS5SZWFkQmFuZHdpZHRoUGxhbmVDaHJvbWFb
a10KKwkJCQkJCQkJCS8gMTAwMCAvIDUxMjsKKwkJfQorCX0KKworCW1vZGVfbGliLT52YmEuUGFy
dE9mQnVyc3RUaGF0Rml0c0luUk9CID0KKwkJCWRtbF9taW4oCisJCQkJCW1vZGVfbGliLT52YmEu
TWluRnVsbERFVEJ1ZmZlcmluZ1RpbWUKKwkJCQkJCQkqIG1vZGVfbGliLT52YmEuVG90YWxEYXRh
UmVhZEJhbmR3aWR0aCwKKwkJCQkJbW9kZV9saWItPnZiYS5ST0JCdWZmZXJTaXplSW5LQnl0ZSAq
IDEwMjQKKwkJCQkJCQkqIG1vZGVfbGliLT52YmEuVG90YWxEYXRhUmVhZEJhbmR3aWR0aAorCQkJ
CQkJCS8gKG1vZGVfbGliLT52YmEuQXZlcmFnZVJlYWRCYW5kd2lkdGhHQnl0ZVBlclNlY29uZAor
CQkJCQkJCQkJKiAxMDAwKSk7CisJbW9kZV9saWItPnZiYS5TdHV0dGVyQnVyc3RUaW1lID0gbW9k
ZV9saWItPnZiYS5QYXJ0T2ZCdXJzdFRoYXRGaXRzSW5ST0IKKwkJCSogKG1vZGVfbGliLT52YmEu
QXZlcmFnZVJlYWRCYW5kd2lkdGhHQnl0ZVBlclNlY29uZCAqIDEwMDApCisJCQkvIG1vZGVfbGli
LT52YmEuVG90YWxEYXRhUmVhZEJhbmR3aWR0aCAvIG1vZGVfbGliLT52YmEuUmV0dXJuQlcKKwkJ
CSsgKG1vZGVfbGliLT52YmEuTWluRnVsbERFVEJ1ZmZlcmluZ1RpbWUKKwkJCQkJKiBtb2RlX2xp
Yi0+dmJhLlRvdGFsRGF0YVJlYWRCYW5kd2lkdGgKKwkJCQkJLSBtb2RlX2xpYi0+dmJhLlBhcnRP
ZkJ1cnN0VGhhdEZpdHNJblJPQikKKwkJCQkJLyAobW9kZV9saWItPnZiYS5EQ0ZDTEsgKiA2NCk7
CisJaWYgKG1vZGVfbGliLT52YmEuVG90YWxBY3RpdmVXcml0ZWJhY2sgPT0gMCkgeworCQltb2Rl
X2xpYi0+dmJhLlN0dXR0ZXJFZmZpY2llbmN5Tm90SW5jbHVkaW5nVkJsYW5rID0gKDEKKwkJCQkt
IChtb2RlX2xpYi0+dmJhLlNSRXhpdFRpbWUgKyBtb2RlX2xpYi0+dmJhLlN0dXR0ZXJCdXJzdFRp
bWUpCisJCQkJCQkvIG1vZGVfbGliLT52YmEuTWluRnVsbERFVEJ1ZmZlcmluZ1RpbWUpICogMTAw
OworCX0gZWxzZSB7CisJCW1vZGVfbGliLT52YmEuU3R1dHRlckVmZmljaWVuY3lOb3RJbmNsdWRp
bmdWQmxhbmsgPSAwOworCX0KKworCW1vZGVfbGliLT52YmEuU21hbGxlc3RWQmxhbmsgPSA5OTk5
OTk7CisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7
ICsraykgeworCQlpZiAobW9kZV9saWItPnZiYS5TeW5jaHJvbml6ZWRWQmxhbmsgfHwgbW9kZV9s
aWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyA9PSAxKSB7CisJCQltb2RlX2xpYi0+dmJhLlZC
bGFua1RpbWUgPSAoZG91YmxlKSAobW9kZV9saWItPnZiYS5WVG90YWxba10KKwkJCQkJLSBtb2Rl
X2xpYi0+dmJhLlZBY3RpdmVba10pICogbW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJLyBt
b2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba107CisJCX0gZWxzZSB7CisJCQltb2RlX2xpYi0+dmJh
LlZCbGFua1RpbWUgPSAwOworCQl9CisJCW1vZGVfbGliLT52YmEuU21hbGxlc3RWQmxhbmsgPSBk
bWxfbWluKAorCQkJCW1vZGVfbGliLT52YmEuU21hbGxlc3RWQmxhbmssCisJCQkJbW9kZV9saWIt
PnZiYS5WQmxhbmtUaW1lKTsKKwl9CisKKwltb2RlX2xpYi0+dmJhLlN0dXR0ZXJFZmZpY2llbmN5
ID0gKG1vZGVfbGliLT52YmEuU3R1dHRlckVmZmljaWVuY3lOb3RJbmNsdWRpbmdWQmxhbmsgLyAx
MDAKKwkJCSogKG1vZGVfbGliLT52YmEuRnJhbWVUaW1lRm9yTWluRnVsbERFVEJ1ZmZlcmluZ1Rp
bWUKKwkJCQkJLSBtb2RlX2xpYi0+dmJhLlNtYWxsZXN0VkJsYW5rKQorCQkJKyBtb2RlX2xpYi0+
dmJhLlNtYWxsZXN0VkJsYW5rKQorCQkJLyBtb2RlX2xpYi0+dmJhLkZyYW1lVGltZUZvck1pbkZ1
bGxERVRCdWZmZXJpbmdUaW1lICogMTAwOworCisJLy8gZG1sX21sLT52YmEuRENGQ0xLIERlZXAg
U2xlZXAKKwltb2RlX2xpYi0+dmJhLkRDRkNMS0RlZXBTbGVlcCA9IDguMDsKKworCWZvciAoayA9
IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyBrKyspIHsKKwkJaWYg
KG1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUQ1trXSA+IDApIHsKKwkJCW1vZGVfbGliLT52
YmEuRENGQ0xLRGVlcFNsZWVwUGVyUGxhbmVba10gPQorCQkJCQlkbWxfbWF4KAorCQkJCQkJCTEu
MSAqIG1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlba10KKwkJCQkJCQkJCSogZG1sX2NlaWwoCisJ
CQkJCQkJCQkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUWVtrXSwKKwkJCQkJCQkJCQkJ
MSkgLyAzMgorCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkRpc3BsYXlQaXBlTGluZURlbGl2ZXJ5
VGltZUx1bWFba10sCisJCQkJCQkJMS4xICogbW9kZV9saWItPnZiYS5Td2F0aFdpZHRoWVtrXSAv
IDIuMAorCQkJCQkJCQkJKiBkbWxfY2VpbCgKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5CeXRl
UGVyUGl4ZWxERVRDW2tdLAorCQkJCQkJCQkJCQkyKSAvIDMyCisJCQkJCQkJCQkvIG1vZGVfbGli
LT52YmEuRGlzcGxheVBpcGVMaW5lRGVsaXZlcnlUaW1lQ2hyb21hW2tdKTsKKwkJfSBlbHNlCisJ
CQltb2RlX2xpYi0+dmJhLkRDRkNMS0RlZXBTbGVlcFBlclBsYW5lW2tdID0gMS4xICogbW9kZV9s
aWItPnZiYS5Td2F0aFdpZHRoWVtrXQorCQkJCQkqIGRtbF9jZWlsKG1vZGVfbGliLT52YmEuQnl0
ZVBlclBpeGVsREVUWVtrXSwgMSkgLyA2NC4wCisJCQkJCS8gbW9kZV9saWItPnZiYS5EaXNwbGF5
UGlwZUxpbmVEZWxpdmVyeVRpbWVMdW1hW2tdOworCQltb2RlX2xpYi0+dmJhLkRDRkNMS0RlZXBT
bGVlcFBlclBsYW5lW2tdID0gZG1sX21heCgKKwkJCQltb2RlX2xpYi0+dmJhLkRDRkNMS0RlZXBT
bGVlcFBlclBsYW5lW2tdLAorCQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSAvIDE2LjAp
OworCQltb2RlX2xpYi0+dmJhLkRDRkNMS0RlZXBTbGVlcCA9IGRtbF9tYXgoCisJCQkJbW9kZV9s
aWItPnZiYS5EQ0ZDTEtEZWVwU2xlZXAsCisJCQkJbW9kZV9saWItPnZiYS5EQ0ZDTEtEZWVwU2xl
ZXBQZXJQbGFuZVtrXSk7CisKKwkJRFRSQUNFKAorCQkJCSIgICBkY2ZjbGtfZGVlcHNsZWVwX3Bl
cl9wbGFuZVslaV0gPSAlZk1IeiIsCisJCQkJaywKKwkJCQltb2RlX2xpYi0+dmJhLkRDRkNMS0Rl
ZXBTbGVlcFBlclBsYW5lW2tdKTsKKwl9CisKKwlEVFJBQ0UoIiAgIGRjZmNsa19kZWVwc2xlZXBf
bWh6ID0gJWZNSHoiLCBtb2RlX2xpYi0+dmJhLkRDRkNMS0RlZXBTbGVlcCk7CisKKwkvLyBTdHV0
dGVyIFdhdGVybWFyaworCW1vZGVfbGliLT52YmEuU3R1dHRlckV4aXRXYXRlcm1hcmsgPSBtb2Rl
X2xpYi0+dmJhLlNSRXhpdFRpbWUKKwkJCSsgbW9kZV9saWItPnZiYS5MYXN0UGl4ZWxPZkxpbmVF
eHRyYVdhdGVybWFyaworCQkJKyBtb2RlX2xpYi0+dmJhLlVyZ2VudEV4dHJhTGF0ZW5jeSArIDEw
IC8gbW9kZV9saWItPnZiYS5EQ0ZDTEtEZWVwU2xlZXA7CisJbW9kZV9saWItPnZiYS5TdHV0dGVy
RW50ZXJQbHVzRXhpdFdhdGVybWFyayA9IG1vZGVfbGliLT52YmEuU1JFbnRlclBsdXNFeGl0VGlt
ZQorCQkJKyBtb2RlX2xpYi0+dmJhLkxhc3RQaXhlbE9mTGluZUV4dHJhV2F0ZXJtYXJrCisJCQkr
IG1vZGVfbGliLT52YmEuVXJnZW50RXh0cmFMYXRlbmN5OworCisJRFRSQUNFKCIgICB3bV9jc3Rh
dGVfZXhpdCAgICAgICA9ICVmdXMiLCBtb2RlX2xpYi0+dmJhLlN0dXR0ZXJFeGl0V2F0ZXJtYXJr
KTsKKwlEVFJBQ0UoIiAgIHdtX2NzdGF0ZV9lbnRlcl9leGl0ID0gJWZ1cyIsIG1vZGVfbGliLT52
YmEuU3R1dHRlckVudGVyUGx1c0V4aXRXYXRlcm1hcmspOworCisJLy8gVXJnZW50IExhdGVuY3kg
U3VwcG9ydGVkCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXM7ICsraykgeworCQltb2RlX2xpYi0+dmJhLkVmZmVjdGl2ZURFVFBsdXNMQkxpbmVzTHVt
YSA9CisJCQkJZG1sX2Zsb29yKAorCQkJCQkJbW9kZV9saWItPnZiYS5MaW5lc0luREVUWVtrXQor
CQkJCQkJCQkrIGRtbF9taW4oCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5MaW5lc0luREVUWVtr
XQorCQkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkRQUENMS1trXQorCQkJCQkJCQkJCQkJKiBt
b2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVFlba10KKwkJCQkJCQkJCQkJCSogbW9kZV9saWIt
PnZiYS5QU0NMX1RIUk9VR0hQVVRfTFVNQVtrXQorCQkJCQkJCQkJCQkJLyAobW9kZV9saWItPnZi
YS5SZXR1cm5CVworCQkJCQkJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba10p
LAorCQkJCQkJCQkJCShkb3VibGUpIG1vZGVfbGliLT52YmEuRWZmZWN0aXZlTEJMYXRlbmN5SGlk
aW5nU291cmNlTGluZXNMdW1hKSwKKwkJCQkJCW1vZGVfbGliLT52YmEuU3dhdGhIZWlnaHRZW2td
KTsKKworCQltb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3lTdXBwb3J0VXNMdW1hID0gbW9kZV9s
aWItPnZiYS5FZmZlY3RpdmVERVRQbHVzTEJMaW5lc0x1bWEKKwkJCQkqIChtb2RlX2xpYi0+dmJh
LkhUb3RhbFtrXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkKKwkJCQkvIG1vZGVfbGli
LT52YmEuVlJhdGlvW2tdCisJCQkJLSBtb2RlX2xpYi0+dmJhLkVmZmVjdGl2ZURFVFBsdXNMQkxp
bmVzTHVtYQorCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdCisJCQkJCQkqIG1v
ZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUWVtrXQorCQkJCQkJLyAobW9kZV9saWItPnZiYS5S
ZXR1cm5CVworCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba10pOworCisJCWlm
IChtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10gPiAwKSB7CisJCQltb2RlX2xpYi0+
dmJhLkVmZmVjdGl2ZURFVFBsdXNMQkxpbmVzQ2hyb21hID0KKwkJCQkJZG1sX2Zsb29yKAorCQkJ
CQkJCW1vZGVfbGliLT52YmEuTGluZXNJbkRFVENba10KKwkJCQkJCQkJCSsgZG1sX21pbigKKwkJ
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5MaW5lc0luREVUQ1trXQorCQkJCQkJCQkJCQkJCSogbW9k
ZV9saWItPnZiYS5EUFBDTEtba10KKwkJCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuQnl0ZVBl
clBpeGVsREVUQ1trXQorCQkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5QU0NMX1RIUk9VR0hQ
VVRfQ0hST01BW2tdCisJCQkJCQkJCQkJCQkJLyAobW9kZV9saWItPnZiYS5SZXR1cm5CVworCQkJ
CQkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdKSwKKwkJCQkJCQkJCQkJ
KGRvdWJsZSkgbW9kZV9saWItPnZiYS5FZmZlY3RpdmVMQkxhdGVuY3lIaWRpbmdTb3VyY2VMaW5l
c0Nocm9tYSksCisJCQkJCQkJbW9kZV9saWItPnZiYS5Td2F0aEhlaWdodENba10pOworCQkJbW9k
ZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5U3VwcG9ydFVzQ2hyb21hID0KKwkJCQkJbW9kZV9saWIt
PnZiYS5FZmZlY3RpdmVERVRQbHVzTEJMaW5lc0Nocm9tYQorCQkJCQkJCSogKG1vZGVfbGliLT52
YmEuSFRvdGFsW2tdCisJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkKKwkJ
CQkJCQkvIChtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSAvIDIpCisJCQkJCQkJLSBtb2RlX2xpYi0+
dmJhLkVmZmVjdGl2ZURFVFBsdXNMQkxpbmVzQ2hyb21hCisJCQkJCQkJCQkqIChtb2RlX2xpYi0+
dmJhLlN3YXRoV2lkdGhZW2tdCisJCQkJCQkJCQkJCS8gMikKKwkJCQkJCQkJCSogbW9kZV9saWIt
PnZiYS5CeXRlUGVyUGl4ZWxERVRDW2tdCisJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLlJldHVy
bkJXCisJCQkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5EUFBQZXJQbGFuZVtrXSk7CisJCQltb2Rl
X2xpYi0+dmJhLlVyZ2VudExhdGVuY3lTdXBwb3J0VXNba10gPSBkbWxfbWluKAorCQkJCQltb2Rl
X2xpYi0+dmJhLlVyZ2VudExhdGVuY3lTdXBwb3J0VXNMdW1hLAorCQkJCQltb2RlX2xpYi0+dmJh
LlVyZ2VudExhdGVuY3lTdXBwb3J0VXNDaHJvbWEpOworCQl9IGVsc2UgeworCQkJbW9kZV9saWIt
PnZiYS5VcmdlbnRMYXRlbmN5U3VwcG9ydFVzW2tdID0KKwkJCQkJbW9kZV9saWItPnZiYS5Vcmdl
bnRMYXRlbmN5U3VwcG9ydFVzTHVtYTsKKwkJfQorCX0KKworCW1vZGVfbGliLT52YmEuTWluVXJn
ZW50TGF0ZW5jeVN1cHBvcnRVcyA9IDk5OTk5OTsKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCW1vZGVfbGliLT52YmEuTWluVXJn
ZW50TGF0ZW5jeVN1cHBvcnRVcyA9IGRtbF9taW4oCisJCQkJbW9kZV9saWItPnZiYS5NaW5Vcmdl
bnRMYXRlbmN5U3VwcG9ydFVzLAorCQkJCW1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeVN1cHBv
cnRVc1trXSk7CisJfQorCisJLy8gTm9uLVVyZ2VudCBMYXRlbmN5IFRvbGVyYW5jZQorCW1vZGVf
bGliLT52YmEuTm9uVXJnZW50TGF0ZW5jeVRvbGVyYW5jZSA9IG1vZGVfbGliLT52YmEuTWluVXJn
ZW50TGF0ZW5jeVN1cHBvcnRVcworCQkJLSBtb2RlX2xpYi0+dmJhLlVyZ2VudFdhdGVybWFyazsK
KworCS8vIERTQ0NMSworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0
aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKChtb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5n
W2tdICE9IGspIHx8ICFtb2RlX2xpYi0+dmJhLkRTQ0VuYWJsZWRba10pIHsKKwkJCW1vZGVfbGli
LT52YmEuRFNDQ0xLX2NhbGN1bGF0ZWRba10gPSAwLjA7CisJCX0gZWxzZSB7CisJCQlpZiAobW9k
ZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10gPT0gZG1fNDIwCisJCQkJCXx8IG1vZGVfbGliLT52
YmEuT3V0cHV0Rm9ybWF0W2tdID09IGRtX240MjIpCisJCQkJbW9kZV9saWItPnZiYS5EU0NGb3Jt
YXRGYWN0b3IgPSAyOworCQkJZWxzZQorCQkJCW1vZGVfbGliLT52YmEuRFNDRm9ybWF0RmFjdG9y
ID0gMTsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLk9ETUNvbWJpbmVFbmFibGVkW2tdKQorCQkJCW1v
ZGVfbGliLT52YmEuRFNDQ0xLX2NhbGN1bGF0ZWRba10gPQorCQkJCQkJbW9kZV9saWItPnZiYS5Q
aXhlbENsb2NrQmFja0VuZFtrXSAvIDYKKwkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkRTQ0Zvcm1h
dEZhY3RvcgorCQkJCQkJCQkvICgxCisJCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLkRJU1BDTEtE
UFBDTEtEU0NDTEtEb3duU3ByZWFkaW5nCisJCQkJCQkJCQkJCQkvIDEwMCk7CisJCQllbHNlCisJ
CQkJbW9kZV9saWItPnZiYS5EU0NDTEtfY2FsY3VsYXRlZFtrXSA9CisJCQkJCQltb2RlX2xpYi0+
dmJhLlBpeGVsQ2xvY2tCYWNrRW5kW2tdIC8gMworCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuRFND
Rm9ybWF0RmFjdG9yCisJCQkJCQkJCS8gKDEKKwkJCQkJCQkJCQktIG1vZGVfbGliLT52YmEuRElT
UENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcKKwkJCQkJCQkJCQkJCS8gMTAwKTsKKwkJfQor
CX0KKworCS8vIERTQyBEZWxheQorCS8vIFRPRE8KKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWRvdWJsZSBicHAgPSBtb2RlX2xp
Yi0+dmJhLk91dHB1dEJwcFtrXTsKKwkJdW5zaWduZWQgaW50IHNsaWNlcyA9IG1vZGVfbGliLT52
YmEuTnVtYmVyT2ZEU0NTbGljZXNba107CisKKwkJaWYgKG1vZGVfbGliLT52YmEuRFNDRW5hYmxl
ZFtrXSAmJiBicHAgIT0gMCkgeworCQkJaWYgKCFtb2RlX2xpYi0+dmJhLk9ETUNvbWJpbmVFbmFi
bGVkW2tdKSB7CisJCQkJbW9kZV9saWItPnZiYS5EU0NEZWxheVtrXSA9CisJCQkJCQlkc2NjZUNv
bXB1dGVEZWxheSgKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5EU0NJbnB1dEJpdFBlckNvbXBvbmVu
dFtrXSwKKwkJCQkJCQkJYnBwLAorCQkJCQkJCQlkbWxfY2VpbCgKKwkJCQkJCQkJCQkoZG91Ymxl
KSBtb2RlX2xpYi0+dmJhLkhBY3RpdmVba10KKwkJCQkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5O
dW1iZXJPZkRTQ1NsaWNlc1trXSwKKwkJCQkJCQkJCQkxKSwKKwkJCQkJCQkJc2xpY2VzLAorCQkJ
CQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dEZvcm1hdFtrXSkKKwkJCQkJCQkJKyBkc2NDb21wdXRl
RGVsYXkoCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10pOworCQkJfSBl
bHNlIHsKKwkJCQltb2RlX2xpYi0+dmJhLkRTQ0RlbGF5W2tdID0KKwkJCQkJCTIKKwkJCQkJCQkJ
KiAoZHNjY2VDb21wdXRlRGVsYXkoCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5EU0NJbnB1dEJp
dFBlckNvbXBvbmVudFtrXSwKKwkJCQkJCQkJCQlicHAsCisJCQkJCQkJCQkJZG1sX2NlaWwoCisJ
CQkJCQkJCQkJCQkoZG91YmxlKSBtb2RlX2xpYi0+dmJhLkhBY3RpdmVba10KKwkJCQkJCQkJCQkJ
CQkJLyBtb2RlX2xpYi0+dmJhLk51bWJlck9mRFNDU2xpY2VzW2tdLAorCQkJCQkJCQkJCQkJMSks
CisJCQkJCQkJCQkJc2xpY2VzIC8gMi4wLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0cHV0
Rm9ybWF0W2tdKQorCQkJCQkJCQkJCSsgZHNjQ29tcHV0ZURlbGF5KAorCQkJCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10pKTsKKwkJCX0KKwkJCW1vZGVfbGliLT52YmEuRFND
RGVsYXlba10gPSBtb2RlX2xpYi0+dmJhLkRTQ0RlbGF5W2tdCisJCQkJCSogbW9kZV9saWItPnZi
YS5QaXhlbENsb2NrW2tdCisJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtr
XTsKKwkJfSBlbHNlIHsKKwkJCW1vZGVfbGliLT52YmEuRFNDRGVsYXlba10gPSAwOworCQl9CisJ
fQorCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7
ICsraykKKwkJZm9yIChqID0gMDsgaiA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFu
ZXM7ICsraikgLy8gTnVtYmVyT2ZQbGFuZXMKKwkJCWlmIChqICE9IGsgJiYgbW9kZV9saWItPnZi
YS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBqCisJCQkJCSYmIG1vZGVfbGliLT52YmEuRFNDRW5h
YmxlZFtqXSkKKwkJCQltb2RlX2xpYi0+dmJhLkRTQ0RlbGF5W2tdID0gbW9kZV9saWItPnZiYS5E
U0NEZWxheVtqXTsKKworCS8vIFByZWZldGNoCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52
YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQl1bnNpZ25lZCBpbnQgUERFQW5kTWV0
YVBURUJ5dGVzRnJhbWVZOworCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVCeXRlc1BlclJvd1k7CisJ
CXVuc2lnbmVkIGludCBNZXRhUm93Qnl0ZVk7CisJCXVuc2lnbmVkIGludCBNZXRhUm93Qnl0ZUM7
CisJCXVuc2lnbmVkIGludCBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZUM7CisJCXVuc2lnbmVkIGlu
dCBQaXhlbFBURUJ5dGVzUGVyUm93QzsKKworCQlDYWxjdWxhdGUyNTZCQmxvY2tTaXplcygKKwkJ
CQltb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdLAorCQkJCW1vZGVfbGliLT52YmEu
U3VyZmFjZVRpbGluZ1trXSwKKwkJCQlkbWxfY2VpbChtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhl
bERFVFlba10sIDEpLAorCQkJCWRtbF9jZWlsKG1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVU
Q1trXSwgMiksCisJCQkJJm1vZGVfbGliLT52YmEuQmxvY2tIZWlnaHQyNTZCeXRlc1lba10sCisJ
CQkJJm1vZGVfbGliLT52YmEuQmxvY2tIZWlnaHQyNTZCeXRlc0Nba10sCisJCQkJJm1vZGVfbGli
LT52YmEuQmxvY2tXaWR0aDI1NkJ5dGVzWVtrXSwKKwkJCQkmbW9kZV9saWItPnZiYS5CbG9ja1dp
ZHRoMjU2Qnl0ZXNDW2tdKTsKKwkJUERFQW5kTWV0YVBURUJ5dGVzRnJhbWVZID0gQ2FsY3VsYXRl
Vk1BbmRSb3dCeXRlcygKKwkJCQltb2RlX2xpYiwKKwkJCQltb2RlX2xpYi0+dmJhLkRDQ0VuYWJs
ZVtrXSwKKwkJCQltb2RlX2xpYi0+dmJhLkJsb2NrSGVpZ2h0MjU2Qnl0ZXNZW2tdLAorCQkJCW1v
ZGVfbGliLT52YmEuQmxvY2tXaWR0aDI1NkJ5dGVzWVtrXSwKKwkJCQltb2RlX2xpYi0+dmJhLlNv
dXJjZVBpeGVsRm9ybWF0W2tdLAorCQkJCW1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSwK
KwkJCQlkbWxfY2VpbChtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVFlba10sIDEpLAorCQkJ
CW1vZGVfbGliLT52YmEuU291cmNlU2NhbltrXSwKKwkJCQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0
V2lkdGhba10sCisJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydEhlaWdodFtrXSwKKwkJCQltb2Rl
X2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdLAorCQkJCW1vZGVfbGliLT52YmEuR1BVVk1FbmFibGUs
CisJCQkJbW9kZV9saWItPnZiYS5WTU1QYWdlU2l6ZSwKKwkJCQltb2RlX2xpYi0+dmJhLlBURUJ1
ZmZlclNpemVJblJlcXVlc3RzTHVtYSwKKwkJCQltb2RlX2xpYi0+dmJhLlBERVByb2Nlc3NpbmdC
dWZJbjY0S0JSZXFzLAorCQkJCW1vZGVfbGliLT52YmEuUGl0Y2hZW2tdLAorCQkJCW1vZGVfbGli
LT52YmEuRENDTWV0YVBpdGNoWVtrXSwKKwkJCQkmbW9kZV9saWItPnZiYS5NYWNyb1RpbGVXaWR0
aFlba10sCisJCQkJJk1ldGFSb3dCeXRlWSwKKwkJCQkmUGl4ZWxQVEVCeXRlc1BlclJvd1ksCisJ
CQkJJm1vZGVfbGliLT52YmEuUFRFQnVmZmVyU2l6ZU5vdEV4Y2VlZGVkW21vZGVfbGliLT52YmEu
Vm9sdGFnZUxldmVsXVswXSwKKwkJCQkmbW9kZV9saWItPnZiYS5kcHRlX3Jvd19oZWlnaHRba10s
CisJCQkJJm1vZGVfbGliLT52YmEubWV0YV9yb3dfaGVpZ2h0W2tdKTsKKwkJbW9kZV9saWItPnZi
YS5QcmVmZXRjaFNvdXJjZUxpbmVzWVtrXSA9IENhbGN1bGF0ZVByZWZldGNoU291cmNlTGluZXMo
CisJCQkJbW9kZV9saWIsCisJCQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10sCisJCQkJbW9kZV9s
aWItPnZiYS52dGFwc1trXSwKKwkJCQltb2RlX2xpYi0+dmJhLkludGVybGFjZVtrXSwKKwkJCQlt
b2RlX2xpYi0+dmJhLlByb2dyZXNzaXZlVG9JbnRlcmxhY2VVbml0SW5PUFAsCisJCQkJbW9kZV9s
aWItPnZiYS5Td2F0aEhlaWdodFlba10sCisJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydFlTdGFy
dFlba10sCisJCQkJJm1vZGVfbGliLT52YmEuVkluaXRQcmVGaWxsWVtrXSwKKwkJCQkmbW9kZV9s
aWItPnZiYS5NYXhOdW1Td2F0aFlba10pOworCisJCWlmICgobW9kZV9saWItPnZiYS5Tb3VyY2VQ
aXhlbEZvcm1hdFtrXSAhPSBkbV80NDRfNjQKKwkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBp
eGVsRm9ybWF0W2tdICE9IGRtXzQ0NF8zMgorCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4
ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzE2CisJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhl
bEZvcm1hdFtrXSAhPSBkbV80NDRfOCkpIHsKKwkJCVBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lQyA9
CisJCQkJCUNhbGN1bGF0ZVZNQW5kUm93Qnl0ZXMoCisJCQkJCQkJbW9kZV9saWIsCisJCQkJCQkJ
bW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5CbG9ja0hl
aWdodDI1NkJ5dGVzQ1trXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkJsb2NrV2lkdGgyNTZCeXRl
c0Nba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSwKKwkJCQkJ
CQltb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10sCisJCQkJCQkJZG1sX2NlaWwoCisJCQkJ
CQkJCQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10sCisJCQkJCQkJCQkyKSwKKwkJ
CQkJCQltb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5W
aWV3cG9ydFdpZHRoW2tdIC8gMiwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0SGVpZ2h0
W2tdIC8gMiwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdIC8gMiwKKwkJCQkJ
CQltb2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlLAorCQkJCQkJCW1vZGVfbGliLT52YmEuVk1NUGFn
ZVNpemUsCisJCQkJCQkJbW9kZV9saWItPnZiYS5QVEVCdWZmZXJTaXplSW5SZXF1ZXN0c0x1bWEs
CisJCQkJCQkJbW9kZV9saWItPnZiYS5QREVQcm9jZXNzaW5nQnVmSW42NEtCUmVxcywKKwkJCQkJ
CQltb2RlX2xpYi0+dmJhLlBpdGNoQ1trXSwKKwkJCQkJCQkwLAorCQkJCQkJCSZtb2RlX2xpYi0+
dmJhLk1hY3JvVGlsZVdpZHRoQ1trXSwKKwkJCQkJCQkmTWV0YVJvd0J5dGVDLAorCQkJCQkJCSZQ
aXhlbFBURUJ5dGVzUGVyUm93QywKKwkJCQkJCQkmbW9kZV9saWItPnZiYS5QVEVCdWZmZXJTaXpl
Tm90RXhjZWVkZWRbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdWzBdLAorCQkJCQkJCSZtb2Rl
X2xpYi0+dmJhLmRwdGVfcm93X2hlaWdodF9jaHJvbWFba10sCisJCQkJCQkJJm1vZGVfbGliLT52
YmEubWV0YV9yb3dfaGVpZ2h0X2Nocm9tYVtrXSk7CisJCQltb2RlX2xpYi0+dmJhLlByZWZldGNo
U291cmNlTGluZXNDW2tdID0gQ2FsY3VsYXRlUHJlZmV0Y2hTb3VyY2VMaW5lcygKKwkJCQkJbW9k
ZV9saWIsCisJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdIC8gMiwKKwkJCQkJbW9kZV9saWIt
PnZiYS5WVEFQc0Nocm9tYVtrXSwKKwkJCQkJbW9kZV9saWItPnZiYS5JbnRlcmxhY2Vba10sCisJ
CQkJCW1vZGVfbGliLT52YmEuUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCwKKwkJCQkJ
bW9kZV9saWItPnZiYS5Td2F0aEhlaWdodENba10sCisJCQkJCW1vZGVfbGliLT52YmEuVmlld3Bv
cnRZU3RhcnRDW2tdLAorCQkJCQkmbW9kZV9saWItPnZiYS5WSW5pdFByZUZpbGxDW2tdLAorCQkJ
CQkmbW9kZV9saWItPnZiYS5NYXhOdW1Td2F0aENba10pOworCQl9IGVsc2UgeworCQkJUGl4ZWxQ
VEVCeXRlc1BlclJvd0MgPSAwOworCQkJUERFQW5kTWV0YVBURUJ5dGVzRnJhbWVDID0gMDsKKwkJ
CU1ldGFSb3dCeXRlQyA9IDA7CisJCQltb2RlX2xpYi0+dmJhLk1heE51bVN3YXRoQ1trXSA9IDA7
CisJCQltb2RlX2xpYi0+dmJhLlByZWZldGNoU291cmNlTGluZXNDW2tdID0gMDsKKwkJfQorCisJ
CW1vZGVfbGliLT52YmEuUGl4ZWxQVEVCeXRlc1BlclJvd1trXSA9IFBpeGVsUFRFQnl0ZXNQZXJS
b3dZICsgUGl4ZWxQVEVCeXRlc1BlclJvd0M7CisJCW1vZGVfbGliLT52YmEuUERFQW5kTWV0YVBU
RUJ5dGVzRnJhbWVba10gPSBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZVkKKwkJCQkrIFBERUFuZE1l
dGFQVEVCeXRlc0ZyYW1lQzsKKwkJbW9kZV9saWItPnZiYS5NZXRhUm93Qnl0ZVtrXSA9IE1ldGFS
b3dCeXRlWSArIE1ldGFSb3dCeXRlQzsKKworCQlDYWxjdWxhdGVBY3RpdmVSb3dCYW5kd2lkdGgo
CisJCQkJbW9kZV9saWItPnZiYS5HUFVWTUVuYWJsZSwKKwkJCQltb2RlX2xpYi0+dmJhLlNvdXJj
ZVBpeGVsRm9ybWF0W2tdLAorCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCW1vZGVf
bGliLT52YmEuRENDRW5hYmxlW2tdLAorCQkJCW1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9k
ZV9saWItPnZiYS5QaXhlbENsb2NrW2tdLAorCQkJCU1ldGFSb3dCeXRlWSwKKwkJCQlNZXRhUm93
Qnl0ZUMsCisJCQkJbW9kZV9saWItPnZiYS5tZXRhX3Jvd19oZWlnaHRba10sCisJCQkJbW9kZV9s
aWItPnZiYS5tZXRhX3Jvd19oZWlnaHRfY2hyb21hW2tdLAorCQkJCVBpeGVsUFRFQnl0ZXNQZXJS
b3dZLAorCQkJCVBpeGVsUFRFQnl0ZXNQZXJSb3dDLAorCQkJCW1vZGVfbGliLT52YmEuZHB0ZV9y
b3dfaGVpZ2h0W2tdLAorCQkJCW1vZGVfbGliLT52YmEuZHB0ZV9yb3dfaGVpZ2h0X2Nocm9tYVtr
XSwKKwkJCQkmbW9kZV9saWItPnZiYS5tZXRhX3Jvd19id1trXSwKKwkJCQkmbW9kZV9saWItPnZi
YS5kcHRlX3Jvd19id1trXSwKKwkJCQkmbW9kZV9saWItPnZiYS5xdWFsX3Jvd19id1trXSk7CisJ
fQorCisJbW9kZV9saWItPnZiYS5UQ2FsYyA9IDI0LjAgLyBtb2RlX2xpYi0+dmJhLkRDRkNMS0Rl
ZXBTbGVlcDsKKworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZl
UGxhbmVzOyArK2spIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdba10g
PT0gaykgeworCQkJaWYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrRW5hYmxlW2tdID09IHRydWUp
IHsKKwkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0RlbGF5W21vZGVfbGliLT52YmEuVm9sdGFn
ZUxldmVsXVtrXSA9CisJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0xhdGVuY3kKKwkJCQkJ
CQkJKyBDYWxjdWxhdGVXcml0ZUJhY2tEZWxheSgKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldy
aXRlYmFja1BpeGVsRm9ybWF0W2tdLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNr
SFJhdGlvW2tdLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrVlJhdGlvW2tdLAor
CQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYUhUYXBzW2tdLAorCQkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYVZUYXBzW2tdLAorCQkJCQkJCQkJCW1vZGVfbGli
LT52YmEuV3JpdGViYWNrQ2hyb21hSFRhcHNba10sCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tDaHJvbWFWVGFwc1trXSwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0Rlc3RpbmF0aW9uV2lkdGhba10pCisJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkRJU1BDTEs7
CisJCQl9IGVsc2UKKwkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0RlbGF5W21vZGVfbGliLT52
YmEuVm9sdGFnZUxldmVsXVtrXSA9IDA7CisJCQlmb3IgKGogPSAwOyBqIDwgbW9kZV9saWItPnZi
YS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytqKSB7CisJCQkJaWYgKG1vZGVfbGliLT52YmEuQmxl
bmRpbmdBbmRUaW1pbmdbal0gPT0gaworCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tF
bmFibGVbal0gPT0gdHJ1ZSkgeworCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0RlbGF5W21v
ZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXVtrXSA9CisJCQkJCQkJZG1sX21heCgKKwkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVsYXlbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxd
W2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMYXRlbmN5CisJCQkJCQkJCQkJ
CSsgQ2FsY3VsYXRlV3JpdGVCYWNrRGVsYXkoCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tQaXhlbEZvcm1hdFtqXSwKKwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRl
YmFja0hSYXRpb1tqXSwKKwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja1ZSYXRp
b1tqXSwKKwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFIVGFwc1tqXSwK
KwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFWVGFwc1tqXSwKKwkJCQkJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYUhUYXBzW2pdLAorCQkJCQkJCQkJ
CQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hVlRhcHNbal0sCisJCQkJCQkJCQkJCQkJ
bW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoW2pdKQorCQkJCQkJCQkJCQkJ
CS8gbW9kZV9saWItPnZiYS5ESVNQQ0xLKTsKKwkJCQl9CisJCQl9CisJCX0KKwl9CisKKwlmb3Ig
KGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKQorCQlm
b3IgKGogPSAwOyBqIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytqKQor
CQkJaWYgKG1vZGVfbGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdba10gPT0gaikKKwkJCQltb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0RlbGF5W21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXVtrXSA9
CisJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0RlbGF5W21vZGVfbGliLT52YmEuVm9sdGFn
ZUxldmVsXVtqXTsKKworCW1vZGVfbGliLT52YmEuVlN0YXJ0dXBMaW5lcyA9IDEzOworCWZvciAo
ayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJ
bW9kZV9saWItPnZiYS5NYXhWU3RhcnR1cExpbmVzW2tdID0KKwkJCQltb2RlX2xpYi0+dmJhLlZU
b3RhbFtrXSAtIG1vZGVfbGliLT52YmEuVkFjdGl2ZVtrXQorCQkJCQkJLSBkbWxfbWF4KAorCQkJ
CQkJCQkxLjAsCisJCQkJCQkJCWRtbF9jZWlsKAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3Jp
dGViYWNrRGVsYXlbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdW2tdCisJCQkJCQkJCQkJCQkv
IChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEu
UGl4ZWxDbG9ja1trXSksCisJCQkJCQkJCQkJMSkpOworCX0KKworCWZvciAoayA9IDA7IGsgPCBt
b2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spCisJCW1vZGVfbGliLT52YmEu
TWF4aW11bU1heFZTdGFydHVwTGluZXMgPSBkbWxfbWF4KAorCQkJCW1vZGVfbGliLT52YmEuTWF4
aW11bU1heFZTdGFydHVwTGluZXMsCisJCQkJbW9kZV9saWItPnZiYS5NYXhWU3RhcnR1cExpbmVz
W2tdKTsKKworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxh
bmVzOyArK2spIHsKKwkJbW9kZV9saWItPnZiYS5jdXJzb3JfYndba10gPSAwLjA7CisJCWZvciAo
aiA9IDA7IGogPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQ3Vyc29yc1trXTsgKytqKQorCQkJbW9k
ZV9saWItPnZiYS5jdXJzb3JfYndba10gKz0gbW9kZV9saWItPnZiYS5DdXJzb3JXaWR0aFtrXVtq
XQorCQkJCQkqIG1vZGVfbGliLT52YmEuQ3Vyc29yQlBQW2tdW2pdIC8gOC4wCisJCQkJCS8gKG1v
ZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKQorCQkJ
CQkqIG1vZGVfbGliLT52YmEuVlJhdGlvW2tdOworCX0KKworCWRvIHsKKwkJZG91YmxlIE1heFRv
dGFsUkRCYW5kd2lkdGggPSAwOworCQlib29sIERlc3RpbmF0aW9uTGluZVRpbWVzRm9yUHJlZmV0
Y2hMZXNzVGhhbjIgPSBmYWxzZTsKKwkJYm9vbCBWUmF0aW9QcmVmZXRjaE1vcmVUaGFuNCA9IGZh
bHNlOworCQlib29sIHByZWZldGNoX3ZtX2J3X3ZhbGlkID0gdHJ1ZTsKKwkJYm9vbCBwcmVmZXRj
aF9yb3dfYndfdmFsaWQgPSB0cnVlOworCQlkb3VibGUgVFdhaXQgPSBDYWxjdWxhdGVUV2FpdCgK
KwkJCQltb2RlX2xpYi0+dmJhLlByZWZldGNoTW9kZVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZl
bF1bbW9kZV9saWItPnZiYS5tYXhNcGNDb21iXSwKKwkJCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9j
a0NoYW5nZUxhdGVuY3ksCisJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5UGl4ZWxEYXRh
T25seSwKKwkJCQltb2RlX2xpYi0+dmJhLlNSRW50ZXJQbHVzRXhpdFRpbWUpOworCisJCWZvciAo
ayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJ
CWlmIChtb2RlX2xpYi0+dmJhLlhGQ0VuYWJsZWRba10gPT0gdHJ1ZSkgeworCQkJCW1vZGVfbGli
LT52YmEuWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSA9CisJCQkJCQlDYWxjdWxhdGVSZW1vdGVT
dXJmYWNlRmxpcERlbGF5KAorCQkJCQkJCQltb2RlX2xpYiwKKwkJCQkJCQkJbW9kZV9saWItPnZi
YS5WUmF0aW9ba10sCisJCQkJCQkJCW1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlba10sCisJCQkJ
CQkJCWRtbF9jZWlsKAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUWVtr
XSwKKwkJCQkJCQkJCQkxKSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJ
CQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSwKKwkJCQkJCQkJbW9kZV9saWItPnZi
YS5YRkNUU2x2VnVwZGF0ZU9mZnNldCwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5YRkNUU2x2VnVw
ZGF0ZVdpZHRoLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1RTbHZWcmVhZHlPZmZzZXQsCisJ
CQkJCQkJCW1vZGVfbGliLT52YmEuWEZDWEJVRkxhdGVuY3lUb2xlcmFuY2UsCisJCQkJCQkJCW1v
ZGVfbGliLT52YmEuWEZDRmlsbEJXT3ZlcmhlYWQsCisJCQkJCQkJCW1vZGVfbGliLT52YmEuWEZD
U2x2Q2h1bmtTaXplLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ0J1c1RyYW5zcG9ydFRpbWUs
CisJCQkJCQkJCW1vZGVfbGliLT52YmEuVENhbGMsCisJCQkJCQkJCVRXYWl0LAorCQkJCQkJCQkm
bW9kZV9saWItPnZiYS5TcmNBY3RpdmVEcmFpblJhdGUsCisJCQkJCQkJCSZtb2RlX2xpYi0+dmJh
LlRJbml0WEZpbGwsCisJCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlRzbHZDaGspOworCQkJfSBlbHNl
IHsKKwkJCQltb2RlX2xpYi0+dmJhLlhGQ1JlbW90ZVN1cmZhY2VGbGlwRGVsYXkgPSAwOworCQkJ
fQorCQkJbW9kZV9saWItPnZiYS5FcnJvclJlc3VsdFtrXSA9CisJCQkJCUNhbGN1bGF0ZVByZWZl
dGNoU2NoZWR1bGUoCisJCQkJCQkJbW9kZV9saWIsCisJCQkJCQkJbW9kZV9saWItPnZiYS5EUFBD
TEtba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLLAorCQkJCQkJCW1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja1trXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRDRkNMS0RlZXBTbGVlcCwK
KwkJCQkJCQltb2RlX2xpYi0+dmJhLkRTQ0RlbGF5W2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEu
RFBQUGVyUGxhbmVba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5TY2FsZXJFbmFibGVkW2tdLAor
CQkJCQkJCW1vZGVfbGliLT52YmEuTnVtYmVyT2ZDdXJzb3JzW2tdLAorCQkJCQkJCW1vZGVfbGli
LT52YmEuRFBQQ0xLRGVsYXlTdWJ0b3RhbCwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRQUENMS0Rl
bGF5U0NMLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRFBQQ0xLRGVsYXlTQ0xMQk9ubHksCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5EUFBDTEtEZWxheUNOVkNGb3JtYXRlciwKKwkJCQkJCQltb2RlX2xp
Yi0+dmJhLkRQUENMS0RlbGF5Q05WQ0N1cnNvciwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRJU1BD
TEtEZWxheVN1YnRvdGFsLAorCQkJCQkJCSh1bnNpZ25lZCBpbnQpIChtb2RlX2xpYi0+dmJhLlN3
YXRoV2lkdGhZW2tdCisJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuSFJhdGlvW2tdKSwKKwkJCQkJ
CQltb2RlX2xpYi0+dmJhLk91dHB1dEZvcm1hdFtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZU
b3RhbFtrXQorCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLlZBY3RpdmVba10sCisJCQkJCQkJbW9k
ZV9saWItPnZiYS5IVG90YWxba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5NYXhJbnRlckRDTlRp
bGVSZXBlYXRlcnMsCisJCQkJCQkJZG1sX21pbigKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuVlN0
YXJ0dXBMaW5lcywKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuTWF4VlN0YXJ0dXBMaW5lc1trXSks
CisJCQkJCQkJbW9kZV9saWItPnZiYS5HUFVWTU1heFBhZ2VUYWJsZUxldmVscywKKwkJCQkJCQlt
b2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRHluYW1pY01l
dGFkYXRhRW5hYmxlW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRHluYW1pY01ldGFkYXRhTGlu
ZXNCZWZvcmVBY3RpdmVSZXF1aXJlZFtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkR5bmFtaWNN
ZXRhZGF0YVRyYW5zbWl0dGVkQnl0ZXNba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5EQ0NFbmFi
bGVba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seSwK
KwkJCQkJCQltb2RlX2xpYi0+dmJhLlVyZ2VudEV4dHJhTGF0ZW5jeSwKKwkJCQkJCQltb2RlX2xp
Yi0+dmJhLlRDYWxjLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUERFQW5kTWV0YVBURUJ5dGVzRnJh
bWVba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5NZXRhUm93Qnl0ZVtrXSwKKwkJCQkJCQltb2Rl
X2xpYi0+dmJhLlBpeGVsUFRFQnl0ZXNQZXJSb3dba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5Q
cmVmZXRjaFNvdXJjZUxpbmVzWVtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZ
W2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUWVtrXSwKKwkJCQkJCQlt
b2RlX2xpYi0+dmJhLlZJbml0UHJlRmlsbFlba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5NYXhO
dW1Td2F0aFlba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5QcmVmZXRjaFNvdXJjZUxpbmVzQ1tr
XSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10sCisJCQkJCQkJbW9k
ZV9saWItPnZiYS5WSW5pdFByZUZpbGxDW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuTWF4TnVt
U3dhdGhDW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuU3dhdGhIZWlnaHRZW2tdLAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuU3dhdGhIZWlnaHRDW2tdLAorCQkJCQkJCVRXYWl0LAorCQkJCQkJCW1v
ZGVfbGliLT52YmEuWEZDRW5hYmxlZFtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1JlbW90
ZVN1cmZhY2VGbGlwRGVsYXksCisJCQkJCQkJbW9kZV9saWItPnZiYS5JbnRlcmxhY2Vba10sCisJ
CQkJCQkJbW9kZV9saWItPnZiYS5Qcm9ncmVzc2l2ZVRvSW50ZXJsYWNlVW5pdEluT1BQLAorCQkJ
CQkJCSZtb2RlX2xpYi0+dmJhLkRTVFhBZnRlclNjYWxlcltrXSwKKwkJCQkJCQkmbW9kZV9saWIt
PnZiYS5EU1RZQWZ0ZXJTY2FsZXJba10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEuRGVzdGluYXRp
b25MaW5lc0ZvclByZWZldGNoW2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlByZWZldGNoQmFu
ZHdpZHRoW2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLkRlc3RpbmF0aW9uTGluZXNUb1JlcXVl
c3RWTUluVkJsYW5rW2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLkRlc3RpbmF0aW9uTGluZXNU
b1JlcXVlc3RSb3dJblZCbGFua1trXSwKKwkJCQkJCQkmbW9kZV9saWItPnZiYS5WUmF0aW9QcmVm
ZXRjaFlba10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEuVlJhdGlvUHJlZmV0Y2hDW2tdLAorCQkJ
CQkJCSZtb2RlX2xpYi0+dmJhLlJlcXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldMdW1hW2tdLAorCQkJ
CQkJCSZtb2RlX2xpYi0+dmJhLlZTdGFydHVwUmVxdWlyZWRXaGVuTm90RW5vdWdoVGltZUZvckR5
bmFtaWNNZXRhZGF0YSwKKwkJCQkJCQkmbW9kZV9saWItPnZiYS5Ubm9fYndba10sCisJCQkJCQkJ
Jm1vZGVfbGliLT52YmEuVlVwZGF0ZU9mZnNldFBpeFtrXSwKKwkJCQkJCQkmbW9kZV9saWItPnZi
YS5WVXBkYXRlV2lkdGhQaXhba10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEuVlJlYWR5T2Zmc2V0
UGl4W2tdKTsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdID09IGsp
IHsKKwkJCQltb2RlX2xpYi0+dmJhLlZTdGFydHVwW2tdID0gZG1sX21pbigKKwkJCQkJCW1vZGVf
bGliLT52YmEuVlN0YXJ0dXBMaW5lcywKKwkJCQkJCW1vZGVfbGliLT52YmEuTWF4VlN0YXJ0dXBM
aW5lc1trXSk7CisJCQkJaWYgKG1vZGVfbGliLT52YmEuVlN0YXJ0dXBSZXF1aXJlZFdoZW5Ob3RF
bm91Z2hUaW1lRm9yRHluYW1pY01ldGFkYXRhCisJCQkJCQkhPSAwKSB7CisJCQkJCW1vZGVfbGli
LT52YmEuVlN0YXJ0dXBba10gPQorCQkJCQkJCW1vZGVfbGliLT52YmEuVlN0YXJ0dXBSZXF1aXJl
ZFdoZW5Ob3RFbm91Z2hUaW1lRm9yRHluYW1pY01ldGFkYXRhOworCQkJCX0KKwkJCX0gZWxzZSB7
CisJCQkJbW9kZV9saWItPnZiYS5WU3RhcnR1cFtrXSA9CisJCQkJCQlkbWxfbWluKAorCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLlZTdGFydHVwTGluZXMsCisJCQkJCQkJCW1vZGVfbGliLT52YmEuTWF4
VlN0YXJ0dXBMaW5lc1ttb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdXSk7CisJCQl9
CisJCX0KKworCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBs
YW5lczsgKytrKSB7CisKKwkJCWlmIChtb2RlX2xpYi0+dmJhLlBERUFuZE1ldGFQVEVCeXRlc0Zy
YW1lW2tdID09IDApCisJCQkJbW9kZV9saWItPnZiYS5wcmVmZXRjaF92bV9id1trXSA9IDA7CisJ
CQllbHNlIGlmIChtb2RlX2xpYi0+dmJhLkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluVkJs
YW5rW2tdID4gMCkgeworCQkJCW1vZGVfbGliLT52YmEucHJlZmV0Y2hfdm1fYndba10gPQorCQkJ
CQkJKGRvdWJsZSkgbW9kZV9saWItPnZiYS5QREVBbmRNZXRhUFRFQnl0ZXNGcmFtZVtrXQorCQkJ
CQkJCQkvIChtb2RlX2xpYi0+dmJhLkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluVkJsYW5r
W2tdCisJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkJCS8gbW9k
ZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKTsKKwkJCX0gZWxzZSB7CisJCQkJbW9kZV9saWItPnZi
YS5wcmVmZXRjaF92bV9id1trXSA9IDA7CisJCQkJcHJlZmV0Y2hfdm1fYndfdmFsaWQgPSBmYWxz
ZTsKKwkJCX0KKwkJCWlmIChtb2RlX2xpYi0+dmJhLk1ldGFSb3dCeXRlW2tdICsgbW9kZV9saWIt
PnZiYS5QaXhlbFBURUJ5dGVzUGVyUm93W2tdCisJCQkJCT09IDApCisJCQkJbW9kZV9saWItPnZi
YS5wcmVmZXRjaF9yb3dfYndba10gPSAwOworCQkJZWxzZSBpZiAobW9kZV9saWItPnZiYS5EZXN0
aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5WQmxhbmtba10gPiAwKSB7CisJCQkJbW9kZV9saWIt
PnZiYS5wcmVmZXRjaF9yb3dfYndba10gPQorCQkJCQkJKGRvdWJsZSkgKG1vZGVfbGliLT52YmEu
TWV0YVJvd0J5dGVba10KKwkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLlBpeGVsUFRFQnl0ZXNQZXJS
b3dba10pCisJCQkJCQkJCS8gKG1vZGVfbGliLT52YmEuRGVzdGluYXRpb25MaW5lc1RvUmVxdWVz
dFJvd0luVkJsYW5rW2tdCisJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJ
CQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKTsKKwkJCX0gZWxzZSB7CisJCQkJ
bW9kZV9saWItPnZiYS5wcmVmZXRjaF9yb3dfYndba10gPSAwOworCQkJCXByZWZldGNoX3Jvd19i
d192YWxpZCA9IGZhbHNlOworCQkJfQorCisJCQlNYXhUb3RhbFJEQmFuZHdpZHRoID0KKwkJCQkJ
TWF4VG90YWxSREJhbmR3aWR0aCArIG1vZGVfbGliLT52YmEuY3Vyc29yX2J3W2tdCisJCQkJCQkJ
KyBkbWxfbWF4KAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5wcmVmZXRjaF92bV9id1trXSwKKwkJ
CQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEucHJlZmV0Y2hfcm93X2J3
W2tdLAorCQkJCQkJCQkJCQlkbWxfbWF4KAorCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuUmVh
ZEJhbmR3aWR0aFBsYW5lTHVtYVtrXQorCQkJCQkJCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLlJl
YWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXSwKKwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlJl
cXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldMdW1hW2tdKQorCQkJCQkJCQkJCQkJCSsgbW9kZV9saWIt
PnZiYS5tZXRhX3Jvd19id1trXQorCQkJCQkJCQkJCQkJCSsgbW9kZV9saWItPnZiYS5kcHRlX3Jv
d19id1trXSkpOworCisJCQlpZiAobW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxpbmVzRm9yUHJl
ZmV0Y2hba10gPCAyKQorCQkJCURlc3RpbmF0aW9uTGluZVRpbWVzRm9yUHJlZmV0Y2hMZXNzVGhh
bjIgPSB0cnVlOworCQkJaWYgKG1vZGVfbGliLT52YmEuVlJhdGlvUHJlZmV0Y2hZW2tdID4gNAor
CQkJCQl8fCBtb2RlX2xpYi0+dmJhLlZSYXRpb1ByZWZldGNoQ1trXSA+IDQpCisJCQkJVlJhdGlv
UHJlZmV0Y2hNb3JlVGhhbjQgPSB0cnVlOworCQl9CisKKwkJaWYgKE1heFRvdGFsUkRCYW5kd2lk
dGggPD0gbW9kZV9saWItPnZiYS5SZXR1cm5CVyAmJiBwcmVmZXRjaF92bV9id192YWxpZAorCQkJ
CSYmIHByZWZldGNoX3Jvd19id192YWxpZCAmJiAhVlJhdGlvUHJlZmV0Y2hNb3JlVGhhbjQKKwkJ
CQkmJiAhRGVzdGluYXRpb25MaW5lVGltZXNGb3JQcmVmZXRjaExlc3NUaGFuMikKKwkJCW1vZGVf
bGliLT52YmEuUHJlZmV0Y2hNb2RlU3VwcG9ydGVkID0gdHJ1ZTsKKwkJZWxzZSB7CisJCQltb2Rl
X2xpYi0+dmJhLlByZWZldGNoTW9kZVN1cHBvcnRlZCA9IGZhbHNlOworCQkJZG1sX3ByaW50KAor
CQkJCQkiRE1MOiBDYWxjdWxhdGVQcmVmZXRjaFNjaGVkdWxlICoqKmZhaWxlZCoqKi4gQmFuZHdp
ZHRoIHZpb2xhdGlvbi4gUmVzdWx0cyBhcmUgTk9UIHZhbGlkXG4iKTsKKwkJfQorCisJCWlmICht
b2RlX2xpYi0+dmJhLlByZWZldGNoTW9kZVN1cHBvcnRlZCA9PSB0cnVlKSB7CisJCQlkb3VibGUg
ZmluYWxfZmxpcF9id1tEQ19fTlVNX0RQUF9fTUFYXTsKKwkJCXVuc2lnbmVkIGludCBJbW1lZGlh
dGVGbGlwQnl0ZXNbRENfX05VTV9EUFBfX01BWF07CisJCQlkb3VibGUgdG90YWxfZGNuX3JlYWRf
Yndfd2l0aF9mbGlwID0gMDsKKworCQkJbW9kZV9saWItPnZiYS5CYW5kd2lkdGhBdmFpbGFibGVG
b3JJbW1lZGlhdGVGbGlwID0gbW9kZV9saWItPnZiYS5SZXR1cm5CVzsKKwkJCWZvciAoayA9IDA7
IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJCQltb2Rl
X2xpYi0+dmJhLkJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAgPQorCQkJCQkJbW9k
ZV9saWItPnZiYS5CYW5kd2lkdGhBdmFpbGFibGVGb3JJbW1lZGlhdGVGbGlwCisJCQkJCQkJCS0g
bW9kZV9saWItPnZiYS5jdXJzb3JfYndba10KKwkJCQkJCQkJLSBkbWxfbWF4KAorCQkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuUmVhZEJhbmR3aWR0aFBsYW5lTHVtYVtrXQorCQkJCQkJCQkJCQkJKyBt
b2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXQorCQkJCQkJCQkJCQkJKyBt
b2RlX2xpYi0+dmJhLnF1YWxfcm93X2J3W2tdLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuUHJl
ZmV0Y2hCYW5kd2lkdGhba10pOworCQkJfQorCisJCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCQkJSW1tZWRpYXRlRmxpcEJ5dGVz
W2tdID0gMDsKKwkJCQlpZiAoKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0g
ZG1fNDIwXzgKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0g
ZG1fNDIwXzEwKSkgeworCQkJCQlJbW1lZGlhdGVGbGlwQnl0ZXNba10gPQorCQkJCQkJCW1vZGVf
bGliLT52YmEuUERFQW5kTWV0YVBURUJ5dGVzRnJhbWVba10KKwkJCQkJCQkJCSsgbW9kZV9saWIt
PnZiYS5NZXRhUm93Qnl0ZVtrXQorCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLlBpeGVsUFRFQnl0
ZXNQZXJSb3dba107CisJCQkJfQorCQkJfQorCQkJbW9kZV9saWItPnZiYS5Ub3RJbW1lZGlhdGVG
bGlwQnl0ZXMgPSAwOworCQkJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZB
Y3RpdmVQbGFuZXM7ICsraykgeworCQkJCWlmICgobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZv
cm1hdFtrXSAhPSBkbV80MjBfOAorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZv
cm1hdFtrXSAhPSBkbV80MjBfMTApKSB7CisJCQkJCW1vZGVfbGliLT52YmEuVG90SW1tZWRpYXRl
RmxpcEJ5dGVzID0KKwkJCQkJCQltb2RlX2xpYi0+dmJhLlRvdEltbWVkaWF0ZUZsaXBCeXRlcwor
CQkJCQkJCQkJKyBJbW1lZGlhdGVGbGlwQnl0ZXNba107CisJCQkJfQorCQkJfQorCQkJZm9yIChr
ID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQkJ
CUNhbGN1bGF0ZUZsaXBTY2hlZHVsZSgKKwkJCQkJCW1vZGVfbGliLAorCQkJCQkJbW9kZV9saWIt
PnZiYS5VcmdlbnRFeHRyYUxhdGVuY3ksCisJCQkJCQltb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVu
Y3lQaXhlbERhdGFPbmx5LAorCQkJCQkJbW9kZV9saWItPnZiYS5HUFVWTU1heFBhZ2VUYWJsZUxl
dmVscywKKwkJCQkJCW1vZGVfbGliLT52YmEuR1BVVk1FbmFibGUsCisJCQkJCQltb2RlX2xpYi0+
dmJhLkJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAsCisJCQkJCQltb2RlX2xpYi0+
dmJhLlRvdEltbWVkaWF0ZUZsaXBCeXRlcywKKwkJCQkJCW1vZGVfbGliLT52YmEuU291cmNlUGl4
ZWxGb3JtYXRba10sCisJCQkJCQlJbW1lZGlhdGVGbGlwQnl0ZXNba10sCisJCQkJCQltb2RlX2xp
Yi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSwK
KwkJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCQkJbW9kZV9saWItPnZiYS5Ubm9f
Yndba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lW2tdLAor
CQkJCQkJbW9kZV9saWItPnZiYS5NZXRhUm93Qnl0ZVtrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEu
UGl4ZWxQVEVCeXRlc1BlclJvd1trXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuRENDRW5hYmxlW2td
LAorCQkJCQkJbW9kZV9saWItPnZiYS5kcHRlX3Jvd19oZWlnaHRba10sCisJCQkJCQltb2RlX2xp
Yi0+dmJhLm1ldGFfcm93X2hlaWdodFtrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEucXVhbF9yb3df
Yndba10sCisJCQkJCQkmbW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1J
bkltbWVkaWF0ZUZsaXBba10sCisJCQkJCQkmbW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxpbmVz
VG9SZXF1ZXN0Um93SW5JbW1lZGlhdGVGbGlwW2tdLAorCQkJCQkJJmZpbmFsX2ZsaXBfYndba10s
CisJCQkJCQkmbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkRm9yUGlwZVtrXSk7
CisJCQl9CisJCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBs
YW5lczsgKytrKSB7CisJCQkJdG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwID0KKwkJCQkJCXRv
dGFsX2Rjbl9yZWFkX2J3X3dpdGhfZmxpcAorCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuY3Vyc29y
X2J3W2tdCisJCQkJCQkJCSsgZG1sX21heCgKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLnByZWZl
dGNoX3ZtX2J3W2tdLAorCQkJCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLnByZWZldGNoX3Jvd19id1trXSwKKwkJCQkJCQkJCQkJCWZpbmFsX2ZsaXBfYndba10KKwkJ
CQkJCQkJCQkJCQkJKyBkbWxfbWF4KAorCQkJCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuUmVh
ZEJhbmR3aWR0aFBsYW5lTHVtYVtrXQorCQkJCQkJCQkJCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJh
LlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXSwKKwkJCQkJCQkJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLlJlcXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldMdW1hW2tdKSkpOworCQkJfQorCQkJbW9kZV9s
aWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkID0gdHJ1ZTsKKwkJCWlmICh0b3RhbF9kY25f
cmVhZF9id193aXRoX2ZsaXAgPiBtb2RlX2xpYi0+dmJhLlJldHVybkJXKSB7CisJCQkJbW9kZV9s
aWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkID0gZmFsc2U7CisJCQl9CisJCQlmb3IgKGsg
PSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCQkJ
aWYgKG1vZGVfbGliLT52YmEuSW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclBpcGVba10gPT0gZmFs
c2UpIHsKKwkJCQkJbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkID0gZmFsc2U7
CisJCQkJfQorCQkJfQorCQl9IGVsc2UgeworCQkJbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlw
U3VwcG9ydGVkID0gZmFsc2U7CisJCX0KKworCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZi
YS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5FcnJv
clJlc3VsdFtrXSkgeworCQkJCW1vZGVfbGliLT52YmEuUHJlZmV0Y2hNb2RlU3VwcG9ydGVkID0g
ZmFsc2U7CisJCQkJZG1sX3ByaW50KAorCQkJCQkJIkRNTDogQ2FsY3VsYXRlUHJlZmV0Y2hTY2hl
ZHVsZSAqKipmYWlsZWQqKiouIFByZWZldGNoIHNjaGVkdWxlIHZpb2xhdGlvbi4gUmVzdWx0cyBh
cmUgTk9UIHZhbGlkXG4iKTsKKwkJCX0KKwkJfQorCisJCW1vZGVfbGliLT52YmEuVlN0YXJ0dXBM
aW5lcyA9IG1vZGVfbGliLT52YmEuVlN0YXJ0dXBMaW5lcyArIDE7CisJfSB3aGlsZSAoISgobW9k
ZV9saWItPnZiYS5QcmVmZXRjaE1vZGVTdXBwb3J0ZWQKKwkJCSYmICghbW9kZV9saWItPnZiYS5J
bW1lZGlhdGVGbGlwU3VwcG9ydAorCQkJCQl8fCBtb2RlX2xpYi0+dmJhLkltbWVkaWF0ZUZsaXBT
dXBwb3J0ZWQpKQorCQkJfHwgbW9kZV9saWItPnZiYS5NYXhpbXVtTWF4VlN0YXJ0dXBMaW5lcyA8
IG1vZGVfbGliLT52YmEuVlN0YXJ0dXBMaW5lcykpOworCisJLy9EaXNwbGF5IFBpcGVsaW5lIERl
bGl2ZXJ5IFRpbWUgaW4gUHJlZmV0Y2gKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5O
dW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLlZSYXRpb1By
ZWZldGNoWVtrXSA8PSAxKSB7CisJCQltb2RlX2xpYi0+dmJhLkRpc3BsYXlQaXBlTGluZURlbGl2
ZXJ5VGltZUx1bWFQcmVmZXRjaFtrXSA9CisJCQkJCW1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlb
a10gKiBtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdCisJCQkJCQkJLyBtb2RlX2xpYi0+dmJh
LkhSYXRpb1trXQorCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdOworCQl9IGVs
c2UgeworCQkJbW9kZV9saWItPnZiYS5EaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVMdW1hUHJl
ZmV0Y2hba10gPQorCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdCisJCQkJCQkJLyBt
b2RlX2xpYi0+dmJhLlBTQ0xfVEhST1VHSFBVVF9MVU1BW2tdCisJCQkJCQkJLyBtb2RlX2xpYi0+
dmJhLkRQUENMS1trXTsKKwkJfQorCQlpZiAobW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRD
W2tdID09IDApIHsKKwkJCW1vZGVfbGliLT52YmEuRGlzcGxheVBpcGVMaW5lRGVsaXZlcnlUaW1l
Q2hyb21hUHJlZmV0Y2hba10gPSAwOworCQl9IGVsc2UgeworCQkJaWYgKG1vZGVfbGliLT52YmEu
VlJhdGlvUHJlZmV0Y2hDW2tdIDw9IDEpIHsKKwkJCQltb2RlX2xpYi0+dmJhLkRpc3BsYXlQaXBl
TGluZURlbGl2ZXJ5VGltZUNocm9tYVByZWZldGNoW2tdID0KKwkJCQkJCW1vZGVfbGliLT52YmEu
U3dhdGhXaWR0aFlba10KKwkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdCisJ
CQkJCQkJCS8gbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJLyBtb2RlX2xpYi0+dmJh
LlBpeGVsQ2xvY2tba107CisJCQl9IGVsc2UgeworCQkJCW1vZGVfbGliLT52YmEuRGlzcGxheVBp
cGVMaW5lRGVsaXZlcnlUaW1lQ2hyb21hUHJlZmV0Y2hba10gPQorCQkJCQkJbW9kZV9saWItPnZi
YS5Td2F0aFdpZHRoWVtrXQorCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuUFNDTF9USFJPVUdIUFVU
X0xVTUFba10KKwkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkRQUENMS1trXTsKKwkJCX0KKwkJfQor
CX0KKworCS8vIE1pbiBUVFVWQmxhbmsKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5O
dW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLlByZWZldGNo
TW9kZVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1bbW9kZV9saWItPnZiYS5tYXhNcGNDb21i
XSA9PSAwKSB7CisJCQltb2RlX2xpYi0+dmJhLkFsbG93RFJBTUNsb2NrQ2hhbmdlRHVyaW5nVkJs
YW5rW2tdID0gdHJ1ZTsKKwkJCW1vZGVfbGliLT52YmEuQWxsb3dEUkFNU2VsZlJlZnJlc2hEdXJp
bmdWQmxhbmtba10gPSB0cnVlOworCQkJbW9kZV9saWItPnZiYS5NaW5UVFVWQmxhbmtba10gPSBk
bWxfbWF4KAorCQkJCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZVdhdGVybWFyaywKKwkJ
CQkJZG1sX21heCgKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlN0dXR0ZXJFbnRlclBsdXNFeGl0V2F0
ZXJtYXJrLAorCQkJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50V2F0ZXJtYXJrKSk7CisJCX0gZWxz
ZSBpZiAobW9kZV9saWItPnZiYS5QcmVmZXRjaE1vZGVbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2
ZWxdW21vZGVfbGliLT52YmEubWF4TXBjQ29tYl0gPT0gMSkgeworCQkJbW9kZV9saWItPnZiYS5B
bGxvd0RSQU1DbG9ja0NoYW5nZUR1cmluZ1ZCbGFua1trXSA9IGZhbHNlOworCQkJbW9kZV9saWIt
PnZiYS5BbGxvd0RSQU1TZWxmUmVmcmVzaER1cmluZ1ZCbGFua1trXSA9IHRydWU7CisJCQltb2Rl
X2xpYi0+dmJhLk1pblRUVVZCbGFua1trXSA9IGRtbF9tYXgoCisJCQkJCW1vZGVfbGliLT52YmEu
U3R1dHRlckVudGVyUGx1c0V4aXRXYXRlcm1hcmssCisJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50
V2F0ZXJtYXJrKTsKKwkJfSBlbHNlIHsKKwkJCW1vZGVfbGliLT52YmEuQWxsb3dEUkFNQ2xvY2tD
aGFuZ2VEdXJpbmdWQmxhbmtba10gPSBmYWxzZTsKKwkJCW1vZGVfbGliLT52YmEuQWxsb3dEUkFN
U2VsZlJlZnJlc2hEdXJpbmdWQmxhbmtba10gPSBmYWxzZTsKKwkJCW1vZGVfbGliLT52YmEuTWlu
VFRVVkJsYW5rW2tdID0gbW9kZV9saWItPnZiYS5VcmdlbnRXYXRlcm1hcms7CisJCX0KKwkJaWYg
KCFtb2RlX2xpYi0+dmJhLkR5bmFtaWNNZXRhZGF0YUVuYWJsZVtrXSkKKwkJCW1vZGVfbGliLT52
YmEuTWluVFRVVkJsYW5rW2tdID0gbW9kZV9saWItPnZiYS5UQ2FsYworCQkJCQkrIG1vZGVfbGli
LT52YmEuTWluVFRVVkJsYW5rW2tdOworCX0KKworCS8vIERDQyBDb25maWd1cmF0aW9uCisJbW9k
ZV9saWItPnZiYS5BY3RpdmVEUFBzID0gMDsKKwkvLyBOQiBQLVN0YXRlL0RSQU0gQ2xvY2sgQ2hh
bmdlIFN1cHBvcnQKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2
ZVBsYW5lczsgKytrKSB7CisJCW1vZGVfbGliLT52YmEuQWN0aXZlRFBQcyA9IG1vZGVfbGliLT52
YmEuQWN0aXZlRFBQcyArIG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba107CisJfQorCisJZm9y
IChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgewor
CQlkb3VibGUgRWZmZWN0aXZlTEJMYXRlbmN5SGlkaW5nWTsKKwkJZG91YmxlIEVmZmVjdGl2ZUxC
TGF0ZW5jeUhpZGluZ0M7CisJCWRvdWJsZSBEUFBPdXRwdXRCdWZmZXJMaW5lc1k7CisJCWRvdWJs
ZSBEUFBPdXRwdXRCdWZmZXJMaW5lc0M7CisJCWRvdWJsZSBEUFBPUFBCdWZmZXJpbmdZOworCQlk
b3VibGUgTWF4REVUQnVmZmVyaW5nVGltZVk7CisJCWRvdWJsZSBBY3RpdmVEUkFNQ2xvY2tDaGFu
Z2VMYXRlbmN5TWFyZ2luWTsKKworCQltb2RlX2xpYi0+dmJhLkxCTGF0ZW5jeUhpZGluZ1NvdXJj
ZUxpbmVzWSA9CisJCQkJZG1sX21pbigKKwkJCQkJCW1vZGVfbGliLT52YmEuTWF4TGluZUJ1ZmZl
ckxpbmVzLAorCQkJCQkJKHVuc2lnbmVkIGludCkgZG1sX2Zsb29yKAorCQkJCQkJCQkoZG91Ymxl
KSBtb2RlX2xpYi0+dmJhLkxpbmVCdWZmZXJTaXplCisJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJh
LkxCQml0UGVyUGl4ZWxba10KKwkJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZ
W2tdCisJCQkJCQkJCQkJCQkvIGRtbF9tYXgoCisJCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEu
SFJhdGlvW2tdLAorCQkJCQkJCQkJCQkJCQkxLjApKSwKKwkJCQkJCQkJMSkpIC0gKG1vZGVfbGli
LT52YmEudnRhcHNba10gLSAxKTsKKworCQltb2RlX2xpYi0+dmJhLkxCTGF0ZW5jeUhpZGluZ1Nv
dXJjZUxpbmVzQyA9CisJCQkJZG1sX21pbigKKwkJCQkJCW1vZGVfbGliLT52YmEuTWF4TGluZUJ1
ZmZlckxpbmVzLAorCQkJCQkJKHVuc2lnbmVkIGludCkgZG1sX2Zsb29yKAorCQkJCQkJCQkoZG91
YmxlKSBtb2RlX2xpYi0+dmJhLkxpbmVCdWZmZXJTaXplCisJCQkJCQkJCQkJLyBtb2RlX2xpYi0+
dmJhLkxCQml0UGVyUGl4ZWxba10KKwkJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLlN3YXRoV2lk
dGhZW2tdCisJCQkJCQkJCQkJCQkvIDIuMAorCQkJCQkJCQkJCQkJLyBkbWxfbWF4KAorCQkJCQkJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLkhSYXRpb1trXQorCQkJCQkJCQkJCQkJCQkJCS8gMiwKKwkJ
CQkJCQkJCQkJCQkJMS4wKSksCisJCQkJCQkJCTEpKQorCQkJCQkJLSAobW9kZV9saWItPnZiYS5W
VEFQc0Nocm9tYVtrXSAtIDEpOworCisJCUVmZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ1kgPSBtb2Rl
X2xpYi0+dmJhLkxCTGF0ZW5jeUhpZGluZ1NvdXJjZUxpbmVzWQorCQkJCS8gbW9kZV9saWItPnZi
YS5WUmF0aW9ba10KKwkJCQkqIChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvIG1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja1trXSk7CisKKwkJRWZmZWN0aXZlTEJMYXRlbmN5SGlkaW5nQyA9IG1vZGVf
bGliLT52YmEuTEJMYXRlbmN5SGlkaW5nU291cmNlTGluZXNDCisJCQkJLyAobW9kZV9saWItPnZi
YS5WUmF0aW9ba10gLyAyKQorCQkJCSogKG1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9kZV9s
aWItPnZiYS5QaXhlbENsb2NrW2tdKTsKKworCQlpZiAobW9kZV9saWItPnZiYS5Td2F0aFdpZHRo
WVtrXSA+IDIgKiBtb2RlX2xpYi0+dmJhLkRQUE91dHB1dEJ1ZmZlclBpeGVscykgeworCQkJRFBQ
T3V0cHV0QnVmZmVyTGluZXNZID0gbW9kZV9saWItPnZiYS5EUFBPdXRwdXRCdWZmZXJQaXhlbHMK
KwkJCQkJLyBtb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdOworCQl9IGVsc2UgaWYgKG1vZGVf
bGliLT52YmEuU3dhdGhXaWR0aFlba10gPiBtb2RlX2xpYi0+dmJhLkRQUE91dHB1dEJ1ZmZlclBp
eGVscykgeworCQkJRFBQT3V0cHV0QnVmZmVyTGluZXNZID0gMC41OworCQl9IGVsc2UgeworCQkJ
RFBQT3V0cHV0QnVmZmVyTGluZXNZID0gMTsKKwkJfQorCisJCWlmIChtb2RlX2xpYi0+dmJhLlN3
YXRoV2lkdGhZW2tdIC8gMiA+IDIgKiBtb2RlX2xpYi0+dmJhLkRQUE91dHB1dEJ1ZmZlclBpeGVs
cykgeworCQkJRFBQT3V0cHV0QnVmZmVyTGluZXNDID0gbW9kZV9saWItPnZiYS5EUFBPdXRwdXRC
dWZmZXJQaXhlbHMKKwkJCQkJLyAobW9kZV9saWItPnZiYS5Td2F0aFdpZHRoWVtrXSAvIDIpOwor
CQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlba10gLyAyID4gbW9kZV9saWIt
PnZiYS5EUFBPdXRwdXRCdWZmZXJQaXhlbHMpIHsKKwkJCURQUE91dHB1dEJ1ZmZlckxpbmVzQyA9
IDAuNTsKKwkJfSBlbHNlIHsKKwkJCURQUE91dHB1dEJ1ZmZlckxpbmVzQyA9IDE7CisJCX0KKwor
CQlEUFBPUFBCdWZmZXJpbmdZID0gKG1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdKQorCQkJCSogKERQUE91dHB1dEJ1ZmZlckxpbmVzWSArIG1vZGVf
bGliLT52YmEuT1BQT3V0cHV0QnVmZmVyTGluZXMpOworCQlNYXhERVRCdWZmZXJpbmdUaW1lWSA9
IG1vZGVfbGliLT52YmEuRnVsbERFVEJ1ZmZlcmluZ1RpbWVZW2tdCisJCQkJKyAobW9kZV9saWIt
PnZiYS5MaW5lc0luREVUWVtrXQorCQkJCQkJLSBtb2RlX2xpYi0+dmJhLkxpbmVzSW5ERVRZUm91
bmRlZERvd25Ub1N3YXRoW2tdKQorCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0WVtr
XQorCQkJCQkJKiAobW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJCQkJLyBtb2RlX2xpYi0+
dmJhLlBpeGVsQ2xvY2tba10pOworCisJCUFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJn
aW5ZID0gRFBQT1BQQnVmZmVyaW5nWSArIEVmZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ1kKKwkJCQkr
IE1heERFVEJ1ZmZlcmluZ1RpbWVZIC0gbW9kZV9saWItPnZiYS5EUkFNQ2xvY2tDaGFuZ2VXYXRl
cm1hcms7CisKKwkJaWYgKG1vZGVfbGliLT52YmEuQWN0aXZlRFBQcyA+IDEpIHsKKwkJCUFjdGl2
ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5ZID0KKwkJCQkJQWN0aXZlRFJBTUNsb2NrQ2hh
bmdlTGF0ZW5jeU1hcmdpblkKKwkJCQkJCQktICgxIC0gMSAvIChtb2RlX2xpYi0+dmJhLkFjdGl2
ZURQUHMgLSAxKSkKKwkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5Td2F0aEhlaWdodFlba10KKwkJ
CQkJCQkJCSogKG1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJCQkJCS8gbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdKTsKKwkJfQorCisJCWlmIChtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQ
aXhlbERFVENba10gPiAwKSB7CisJCQlkb3VibGUgRFBQT1BQQnVmZmVyaW5nQyA9IChtb2RlX2xp
Yi0+dmJhLkhUb3RhbFtrXQorCQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkKKwkJ
CQkJKiAoRFBQT3V0cHV0QnVmZmVyTGluZXNDCisJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLk9QUE91
dHB1dEJ1ZmZlckxpbmVzKTsKKwkJCWRvdWJsZSBNYXhERVRCdWZmZXJpbmdUaW1lQyA9CisJCQkJ
CW1vZGVfbGliLT52YmEuRnVsbERFVEJ1ZmZlcmluZ1RpbWVDW2tdCisJCQkJCQkJKyAobW9kZV9s
aWItPnZiYS5MaW5lc0luREVUQ1trXQorCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLkxpbmVzSW5E
RVRDUm91bmRlZERvd25Ub1N3YXRoW2tdKQorCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlN3YXRo
SGVpZ2h0Q1trXQorCQkJCQkJCQkJKiAobW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJCQkJ
CQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pOworCQkJZG91YmxlIEFjdGl2ZURSQU1D
bG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5DID0gRFBQT1BQQnVmZmVyaW5nQworCQkJCQkrIEVmZmVj
dGl2ZUxCTGF0ZW5jeUhpZGluZ0MgKyBNYXhERVRCdWZmZXJpbmdUaW1lQworCQkJCQktIG1vZGVf
bGliLT52YmEuRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrOworCisJCQlpZiAobW9kZV9saWItPnZi
YS5BY3RpdmVEUFBzID4gMSkgeworCQkJCUFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJn
aW5DID0KKwkJCQkJCUFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5DCisJCQkJCQkJ
CS0gKDEKKwkJCQkJCQkJCQktIDEKKwkJCQkJCQkJCQkJCS8gKG1vZGVfbGliLT52YmEuQWN0aXZl
RFBQcworCQkJCQkJCQkJCQkJCQktIDEpKQorCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5Td2F0
aEhlaWdodENba10KKwkJCQkJCQkJCQkqIChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJ
CQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pOworCQkJfQorCQkJbW9kZV9saWIt
PnZiYS5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luW2tdID0gZG1sX21pbigKKwkJ
CQkJQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1hcmdpblksCisJCQkJCUFjdGl2ZURSQU1D
bG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5DKTsKKwkJfSBlbHNlIHsKKwkJCW1vZGVfbGliLT52YmEu
QWN0aXZlRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1hcmdpbltrXSA9CisJCQkJCUFjdGl2ZURSQU1D
bG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5ZOworCQl9CisKKwkJaWYgKG1vZGVfbGliLT52YmEuV3Jp
dGViYWNrRW5hYmxlW2tdKSB7CisJCQlkb3VibGUgV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlTGF0
ZW5jeU1hcmdpbjsKKworCQkJaWYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRb
a10gPT0gZG1fNDQ0XzMyKSB7CisJCQkJV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1h
cmdpbiA9CisJCQkJCQkoZG91YmxlKSAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tJbnRlcmZhY2VM
dW1hQnVmZmVyU2l6ZQorCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuV3JpdGViYWNrSW50ZXJmYWNl
Q2hyb21hQnVmZmVyU2l6ZSkKKwkJCQkJCQkJLyAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEZXN0
aW5hdGlvbldpZHRoW2tdCisJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3Rp
bmF0aW9uSGVpZ2h0W2tdCisJCQkJCQkJCQkJLyAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tTb3Vy
Y2VIZWlnaHRba10KKwkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJ
CQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKQorCQkJCQkJCQkJCSogNCkKKwkJ
CQkJCQkJLSBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0RSQU1DbG9ja0NoYW5nZVdhdGVybWFyazsK
KwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSA9PSBk
bV80MjBfMTApIHsKKwkJCQlXcml0ZWJhY2tEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luID0K
KwkJCQkJCWRtbF9taW4oCisJCQkJCQkJCShkb3VibGUpIG1vZGVfbGliLT52YmEuV3JpdGViYWNr
SW50ZXJmYWNlTHVtYUJ1ZmZlclNpemUKKwkJCQkJCQkJCQkqIDguMCAvIDEwLAorCQkJCQkJCQky
LjAKKwkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuV3JpdGViYWNrSW50ZXJmYWNlQ2hyb21hQnVm
ZmVyU2l6ZQorCQkJCQkJCQkJCSogOCAvIDEwKQorCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLldy
aXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuV3Jp
dGViYWNrRGVzdGluYXRpb25IZWlnaHRba10KKwkJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLldy
aXRlYmFja1NvdXJjZUhlaWdodFtrXQorCQkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhUb3Rh
bFtrXQorCQkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pKQorCQkJCQkJ
CQktIG1vZGVfbGliLT52YmEuV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrOworCQkJ
fSBlbHNlIHsKKwkJCQlXcml0ZWJhY2tEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luID0KKwkJ
CQkJCWRtbF9taW4oCisJCQkJCQkJCShkb3VibGUpIG1vZGVfbGliLT52YmEuV3JpdGViYWNrSW50
ZXJmYWNlTHVtYUJ1ZmZlclNpemUsCisJCQkJCQkJCTIuMAorCQkJCQkJCQkJCSogbW9kZV9saWIt
PnZiYS5Xcml0ZWJhY2tJbnRlcmZhY2VDaHJvbWFCdWZmZXJTaXplKQorCQkJCQkJCQkvIChtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJCQkJCQkqIG1vZGVf
bGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25IZWlnaHRba10KKwkJCQkJCQkJCQkvIChtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja1NvdXJjZUhlaWdodFtrXQorCQkJCQkJCQkJCQkJKiBtb2RlX2xp
Yi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tb
a10pKQorCQkJCQkJCQktIG1vZGVfbGliLT52YmEuV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlV2F0
ZXJtYXJrOworCQkJfQorCQkJbW9kZV9saWItPnZiYS5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRl
bmN5TWFyZ2luW2tdID0gZG1sX21pbigKKwkJCQkJbW9kZV9saWItPnZiYS5BY3RpdmVEUkFNQ2xv
Y2tDaGFuZ2VMYXRlbmN5TWFyZ2luW2tdLAorCQkJCQlXcml0ZWJhY2tEUkFNQ2xvY2tDaGFuZ2VM
YXRlbmN5TWFyZ2luKTsKKwkJfQorCX0KKworCW1vZGVfbGliLT52YmEuTWluQWN0aXZlRFJBTUNs
b2NrQ2hhbmdlTWFyZ2luID0gOTk5OTk5OworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuQWN0aXZl
RFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1hcmdpbltrXQorCQkJCTwgbW9kZV9saWItPnZiYS5NaW5B
Y3RpdmVEUkFNQ2xvY2tDaGFuZ2VNYXJnaW4pIHsKKwkJCW1vZGVfbGliLT52YmEuTWluQWN0aXZl
RFJBTUNsb2NrQ2hhbmdlTWFyZ2luID0KKwkJCQkJbW9kZV9saWItPnZiYS5BY3RpdmVEUkFNQ2xv
Y2tDaGFuZ2VMYXRlbmN5TWFyZ2luW2tdOworCQl9CisJfQorCisJbW9kZV9saWItPnZiYS5NaW5B
Y3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5U3VwcG9ydGVkID0KKwkJCW1vZGVfbGliLT52YmEu
TWluQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTWFyZ2luCisJCQkJCSsgbW9kZV9saWItPnZiYS5EUkFN
Q2xvY2tDaGFuZ2VMYXRlbmN5OworCisJaWYgKG1vZGVfbGliLT52YmEuTWluQWN0aXZlRFJBTUNs
b2NrQ2hhbmdlTWFyZ2luID4gMCkgeworCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZVN1
cHBvcnRbMF1bMF0gPSBkbV9kcmFtX2Nsb2NrX2NoYW5nZV92YWN0aXZlOworCX0gZWxzZSB7CisJ
CWlmIChtb2RlX2xpYi0+dmJhLlN5bmNocm9uaXplZFZCbGFuayB8fCBtb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzID09IDEpIHsKKwkJCW1vZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hh
bmdlU3VwcG9ydFswXVswXSA9IGRtX2RyYW1fY2xvY2tfY2hhbmdlX3ZibGFuazsKKwkJCWZvciAo
ayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJ
CQlpZiAoIW1vZGVfbGliLT52YmEuQWxsb3dEUkFNQ2xvY2tDaGFuZ2VEdXJpbmdWQmxhbmtba10p
IHsKKwkJCQkJbW9kZV9saWItPnZiYS5EUkFNQ2xvY2tDaGFuZ2VTdXBwb3J0WzBdWzBdID0KKwkJ
CQkJCQlkbV9kcmFtX2Nsb2NrX2NoYW5nZV91bnN1cHBvcnRlZDsKKwkJCQl9CisJCQl9CisJCX0g
ZWxzZSB7CisJCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZVN1cHBvcnRbMF1bMF0gPSBk
bV9kcmFtX2Nsb2NrX2NoYW5nZV91bnN1cHBvcnRlZDsKKwkJfQorCX0KKwlmb3IgKGsgPSAxOyBr
IDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7IGsrKykKKwkJbW9kZV9saWItPnZiYS5E
UkFNQ2xvY2tDaGFuZ2VTdXBwb3J0W2tdWzBdID0gbW9kZV9saWItPnZiYS5EUkFNQ2xvY2tDaGFu
Z2VTdXBwb3J0WzBdWzBdOworCisJLy9YRkMgUGFyYW1ldGVyczoKKwlmb3IgKGsgPSAwOyBrIDwg
bW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmIChtb2RlX2xp
Yi0+dmJhLlhGQ0VuYWJsZWRba10gPT0gdHJ1ZSkgeworCQkJZG91YmxlIFRXYWl0OworCisJCQlt
b2RlX2xpYi0+dmJhLlhGQ1NsYXZlVlVwZGF0ZU9mZnNldFtrXSA9IG1vZGVfbGliLT52YmEuWEZD
VFNsdlZ1cGRhdGVPZmZzZXQ7CisJCQltb2RlX2xpYi0+dmJhLlhGQ1NsYXZlVnVwZGF0ZVdpZHRo
W2tdID0gbW9kZV9saWItPnZiYS5YRkNUU2x2VnVwZGF0ZVdpZHRoOworCQkJbW9kZV9saWItPnZi
YS5YRkNTbGF2ZVZSZWFkeU9mZnNldFtrXSA9IG1vZGVfbGliLT52YmEuWEZDVFNsdlZyZWFkeU9m
ZnNldDsKKwkJCVRXYWl0ID0gQ2FsY3VsYXRlVFdhaXQoCisJCQkJCW1vZGVfbGliLT52YmEuUHJl
ZmV0Y2hNb2RlW21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXVttb2RlX2xpYi0+dmJhLm1heE1w
Y0NvbWJdLAorCQkJCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZUxhdGVuY3ksCisJCQkJ
CW1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeVBpeGVsRGF0YU9ubHksCisJCQkJCW1vZGVfbGli
LT52YmEuU1JFbnRlclBsdXNFeGl0VGltZSk7CisJCQltb2RlX2xpYi0+dmJhLlhGQ1JlbW90ZVN1
cmZhY2VGbGlwRGVsYXkgPSBDYWxjdWxhdGVSZW1vdGVTdXJmYWNlRmxpcERlbGF5KAorCQkJCQlt
b2RlX2xpYiwKKwkJCQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10sCisJCQkJCW1vZGVfbGliLT52
YmEuU3dhdGhXaWR0aFlba10sCisJCQkJCWRtbF9jZWlsKG1vZGVfbGliLT52YmEuQnl0ZVBlclBp
eGVsREVUWVtrXSwgMSksCisJCQkJCW1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdLAorCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1RTbHZWdXBkYXRlT2Zm
c2V0LAorCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1RTbHZWdXBkYXRlV2lkdGgsCisJCQkJCW1vZGVf
bGliLT52YmEuWEZDVFNsdlZyZWFkeU9mZnNldCwKKwkJCQkJbW9kZV9saWItPnZiYS5YRkNYQlVG
TGF0ZW5jeVRvbGVyYW5jZSwKKwkJCQkJbW9kZV9saWItPnZiYS5YRkNGaWxsQldPdmVyaGVhZCwK
KwkJCQkJbW9kZV9saWItPnZiYS5YRkNTbHZDaHVua1NpemUsCisJCQkJCW1vZGVfbGliLT52YmEu
WEZDQnVzVHJhbnNwb3J0VGltZSwKKwkJCQkJbW9kZV9saWItPnZiYS5UQ2FsYywKKwkJCQkJVFdh
aXQsCisJCQkJCSZtb2RlX2xpYi0+dmJhLlNyY0FjdGl2ZURyYWluUmF0ZSwKKwkJCQkJJm1vZGVf
bGliLT52YmEuVEluaXRYRmlsbCwKKwkJCQkJJm1vZGVfbGliLT52YmEuVHNsdkNoayk7CisJCQlt
b2RlX2xpYi0+dmJhLlhGQ1JlbW90ZVN1cmZhY2VGbGlwTGF0ZW5jeVtrXSA9CisJCQkJCWRtbF9m
bG9vcigKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1JlbW90ZVN1cmZhY2VGbGlwRGVsYXkKKwkJ
CQkJCQkJCS8gKG1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJCQkJCS8gbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdKSwKKwkJCQkJCQkxKTsKKwkJCW1vZGVfbGliLT52YmEuWEZDVHJh
bnNmZXJEZWxheVtrXSA9CisJCQkJCWRtbF9jZWlsKAorCQkJCQkJCW1vZGVfbGliLT52YmEuWEZD
QnVzVHJhbnNwb3J0VGltZQorCQkJCQkJCQkJLyAobW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJ
CQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pLAorCQkJCQkJCTEpOworCQkJ
bW9kZV9saWItPnZiYS5YRkNQcmVjaGFyZ2VEZWxheVtrXSA9CisJCQkJCWRtbF9jZWlsKAorCQkJ
CQkJCShtb2RlX2xpYi0+dmJhLlhGQ0J1c1RyYW5zcG9ydFRpbWUKKwkJCQkJCQkJCSsgbW9kZV9s
aWItPnZiYS5USW5pdFhGaWxsCisJCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuVHNsdkNoaykKKwkJ
CQkJCQkJCS8gKG1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJCQkJCS8gbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdKSwKKwkJCQkJCQkxKTsKKwkJCW1vZGVfbGliLT52YmEuSW5pdEZp
bGxMZXZlbCA9IG1vZGVfbGliLT52YmEuWEZDWEJVRkxhdGVuY3lUb2xlcmFuY2UKKwkJCQkJKiBt
b2RlX2xpYi0+dmJhLlNyY0FjdGl2ZURyYWluUmF0ZTsKKwkJCW1vZGVfbGliLT52YmEuRmluYWxG
aWxsTWFyZ2luID0KKwkJCQkJKG1vZGVfbGliLT52YmEuRGVzdGluYXRpb25MaW5lc1RvUmVxdWVz
dFZNSW5WQmxhbmtba10KKwkJCQkJCQkrIG1vZGVfbGliLT52YmEuRGVzdGluYXRpb25MaW5lc1Rv
UmVxdWVzdFJvd0luVkJsYW5rW2tdKQorCQkJCQkJCSogbW9kZV9saWItPnZiYS5IVG90YWxba10K
KwkJCQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXQorCQkJCQkJCSogbW9kZV9saWIt
PnZiYS5TcmNBY3RpdmVEcmFpblJhdGUKKwkJCQkJCQkrIG1vZGVfbGliLT52YmEuWEZDRmlsbENv
bnN0YW50OworCQkJbW9kZV9saWItPnZiYS5GaW5hbEZpbGxMZXZlbCA9IG1vZGVfbGliLT52YmEu
WEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheQorCQkJCQkqIG1vZGVfbGliLT52YmEuU3JjQWN0aXZl
RHJhaW5SYXRlCisJCQkJCSsgbW9kZV9saWItPnZiYS5GaW5hbEZpbGxNYXJnaW47CisJCQltb2Rl
X2xpYi0+dmJhLlJlbWFpbmluZ0ZpbGxMZXZlbCA9IGRtbF9tYXgoCisJCQkJCTAuMCwKKwkJCQkJ
bW9kZV9saWItPnZiYS5GaW5hbEZpbGxMZXZlbCAtIG1vZGVfbGliLT52YmEuSW5pdEZpbGxMZXZl
bCk7CisJCQltb2RlX2xpYi0+dmJhLlRGaW5hbHhGaWxsID0gbW9kZV9saWItPnZiYS5SZW1haW5p
bmdGaWxsTGV2ZWwKKwkJCQkJLyAobW9kZV9saWItPnZiYS5TcmNBY3RpdmVEcmFpblJhdGUKKwkJ
CQkJCQkqIG1vZGVfbGliLT52YmEuWEZDRmlsbEJXT3ZlcmhlYWQgLyAxMDApOworCQkJbW9kZV9s
aWItPnZiYS5YRkNQcmVmZXRjaE1hcmdpbltrXSA9CisJCQkJCW1vZGVfbGliLT52YmEuWEZDUmVt
b3RlU3VyZmFjZUZsaXBEZWxheQorCQkJCQkJCSsgbW9kZV9saWItPnZiYS5URmluYWx4RmlsbAor
CQkJCQkJCSsgKG1vZGVfbGliLT52YmEuRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxh
bmtba10KKwkJCQkJCQkJCSsgbW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0
Um93SW5WQmxhbmtba10pCisJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJ
CQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXTsKKwkJfSBlbHNlIHsKKwkJCW1vZGVf
bGliLT52YmEuWEZDU2xhdmVWVXBkYXRlT2Zmc2V0W2tdID0gMDsKKwkJCW1vZGVfbGliLT52YmEu
WEZDU2xhdmVWdXBkYXRlV2lkdGhba10gPSAwOworCQkJbW9kZV9saWItPnZiYS5YRkNTbGF2ZVZS
ZWFkeU9mZnNldFtrXSA9IDA7CisJCQltb2RlX2xpYi0+dmJhLlhGQ1JlbW90ZVN1cmZhY2VGbGlw
TGF0ZW5jeVtrXSA9IDA7CisJCQltb2RlX2xpYi0+dmJhLlhGQ1ByZWNoYXJnZURlbGF5W2tdID0g
MDsKKwkJCW1vZGVfbGliLT52YmEuWEZDVHJhbnNmZXJEZWxheVtrXSA9IDA7CisJCQltb2RlX2xp
Yi0+dmJhLlhGQ1ByZWZldGNoTWFyZ2luW2tdID0gMDsKKwkJfQorCX0KKwl7CisJCXVuc2lnbmVk
IGludCBWU3RhcnR1cE1hcmdpbiA9IDA7CisJCWJvb2wgRmlyc3RNYWluUGxhbmUgPSB0cnVlOwor
CisJCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyAr
K2spIHsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdID09IGspIHsK
KwkJCQl1bnNpZ25lZCBpbnQgTWFyZ2luID0gKG1vZGVfbGliLT52YmEuTWF4VlN0YXJ0dXBMaW5l
c1trXSAtIG1vZGVfbGliLT52YmEuVlN0YXJ0dXBba10pCisJCQkJCQkqIG1vZGVfbGliLT52YmEu
SFRvdGFsW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdOworCisJCQkJaWYgKEZpcnN0
TWFpblBsYW5lKSB7CisJCQkJCVZTdGFydHVwTWFyZ2luID0gTWFyZ2luOworCQkJCQlGaXJzdE1h
aW5QbGFuZSA9IGZhbHNlOworCQkJCX0gZWxzZQorCQkJCQlWU3RhcnR1cE1hcmdpbiA9IGRtbF9t
aW4oVlN0YXJ0dXBNYXJnaW4sIE1hcmdpbik7CisJCX0KKworCQlpZiAobW9kZV9saWItPnZiYS5V
c2VNYXhpbXVtVlN0YXJ0dXApCisJCQltb2RlX2xpYi0+dmJhLlZTdGFydHVwW2tdID0gbW9kZV9s
aWItPnZiYS5NYXhWU3RhcnR1cExpbmVzW21vZGVfbGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdb
a11dOworCX0KK30KK30KKworc3RhdGljIHZvaWQgZG1sMjBfRGlzcGxheVBpcGVDb25maWd1cmF0
aW9uKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYikKK3sKKwlkb3VibGUgQnl0ZVBl
clBpeERFVFk7CisJZG91YmxlIEJ5dGVQZXJQaXhERVRDOworCWRvdWJsZSBSZWFkMjU2Qnl0ZXNC
bG9ja0hlaWdodFk7CisJZG91YmxlIFJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0QzsKKwlkb3VibGUg
UmVhZDI1NkJ5dGVzQmxvY2tXaWR0aFk7CisJZG91YmxlIFJlYWQyNTZCeXRlc0Jsb2NrV2lkdGhD
OworCWRvdWJsZSBNYXhpbXVtU3dhdGhIZWlnaHRZOworCWRvdWJsZSBNYXhpbXVtU3dhdGhIZWln
aHRDOworCWRvdWJsZSBNaW5pbXVtU3dhdGhIZWlnaHRZOworCWRvdWJsZSBNaW5pbXVtU3dhdGhI
ZWlnaHRDOworCWRvdWJsZSBTd2F0aFdpZHRoOworCWRvdWJsZSBTd2F0aFdpZHRoR3JhbnVsYXJp
dHlZOworCWRvdWJsZSBTd2F0aFdpZHRoR3JhbnVsYXJpdHlDOworCWRvdWJsZSBSb3VuZGVkVXBN
YXhTd2F0aFNpemVCeXRlc1k7CisJZG91YmxlIFJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5dGVzQzsK
Kwl1bnNpZ25lZCBpbnQgaiwgazsKKworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJYm9vbCBNYWluUGxhbmVEb2VzT0RNQ29tYmlu
ZSA9IGZhbHNlOworCisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09
IGRtXzQ0NF82NCkgeworCQkJQnl0ZVBlclBpeERFVFkgPSA4OworCQkJQnl0ZVBlclBpeERFVEMg
PSAwOworCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0g
ZG1fNDQ0XzMyKSB7CisJCQlCeXRlUGVyUGl4REVUWSA9IDQ7CisJCQlCeXRlUGVyUGl4REVUQyA9
IDA7CisJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBk
bV80NDRfMTYpIHsKKwkJCUJ5dGVQZXJQaXhERVRZID0gMjsKKwkJCUJ5dGVQZXJQaXhERVRDID0g
MDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRt
XzQ0NF84KSB7CisJCQlCeXRlUGVyUGl4REVUWSA9IDE7CisJCQlCeXRlUGVyUGl4REVUQyA9IDA7
CisJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80
MjBfOCkgeworCQkJQnl0ZVBlclBpeERFVFkgPSAxOworCQkJQnl0ZVBlclBpeERFVEMgPSAyOwor
CQl9IGVsc2UgeworCQkJQnl0ZVBlclBpeERFVFkgPSA0LjAgLyAzLjA7CisJCQlCeXRlUGVyUGl4
REVUQyA9IDguMCAvIDMuMDsKKwkJfQorCisJCWlmICgobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhl
bEZvcm1hdFtrXSA9PSBkbV80NDRfNjQKKwkJCQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVs
Rm9ybWF0W2tdID09IGRtXzQ0NF8zMgorCQkJCXx8IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxG
b3JtYXRba10gPT0gZG1fNDQ0XzE2CisJCQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZv
cm1hdFtrXSA9PSBkbV80NDRfOCkpIHsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxp
bmdba10gPT0gZG1fc3dfbGluZWFyKSB7CisJCQkJUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRZID0g
MTsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBk
bV80NDRfNjQpIHsKKwkJCQlSZWFkMjU2Qnl0ZXNCbG9ja0hlaWdodFkgPSA0OworCQkJfSBlbHNl
IGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF8zMgorCQkJ
CQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF8xNikgewor
CQkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0WSA9IDg7CisJCQl9IGVsc2UgeworCQkJCVJlYWQy
NTZCeXRlc0Jsb2NrSGVpZ2h0WSA9IDE2OworCQkJfQorCQkJUmVhZDI1NkJ5dGVzQmxvY2tXaWR0
aFkgPSAyNTYgLyBkbWxfY2VpbChCeXRlUGVyUGl4REVUWSwgMSkKKwkJCQkJLyBSZWFkMjU2Qnl0
ZXNCbG9ja0hlaWdodFk7CisJCQlSZWFkMjU2Qnl0ZXNCbG9ja0hlaWdodEMgPSAwOworCQkJUmVh
ZDI1NkJ5dGVzQmxvY2tXaWR0aEMgPSAwOworCQl9IGVsc2UgeworCQkJaWYgKG1vZGVfbGliLT52
YmEuU3VyZmFjZVRpbGluZ1trXSA9PSBkbV9zd19saW5lYXIpIHsKKwkJCQlSZWFkMjU2Qnl0ZXNC
bG9ja0hlaWdodFkgPSAxOworCQkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0QyA9IDE7CisJCQl9
IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDIwXzgp
IHsKKwkJCQlSZWFkMjU2Qnl0ZXNCbG9ja0hlaWdodFkgPSAxNjsKKwkJCQlSZWFkMjU2Qnl0ZXNC
bG9ja0hlaWdodEMgPSA4OworCQkJfSBlbHNlIHsKKwkJCQlSZWFkMjU2Qnl0ZXNCbG9ja0hlaWdo
dFkgPSA4OworCQkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0QyA9IDg7CisJCQl9CisJCQlSZWFk
MjU2Qnl0ZXNCbG9ja1dpZHRoWSA9IDI1NiAvIGRtbF9jZWlsKEJ5dGVQZXJQaXhERVRZLCAxKQor
CQkJCQkvIFJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0WTsKKwkJCVJlYWQyNTZCeXRlc0Jsb2NrV2lk
dGhDID0gMjU2IC8gZG1sX2NlaWwoQnl0ZVBlclBpeERFVEMsIDIpCisJCQkJCS8gUmVhZDI1NkJ5
dGVzQmxvY2tIZWlnaHRDOworCQl9CisKKwkJaWYgKG1vZGVfbGliLT52YmEuU291cmNlU2Nhbltr
XSA9PSBkbV9ob3J6KSB7CisJCQlNYXhpbXVtU3dhdGhIZWlnaHRZID0gUmVhZDI1NkJ5dGVzQmxv
Y2tIZWlnaHRZOworCQkJTWF4aW11bVN3YXRoSGVpZ2h0QyA9IFJlYWQyNTZCeXRlc0Jsb2NrSGVp
Z2h0QzsKKwkJfSBlbHNlIHsKKwkJCU1heGltdW1Td2F0aEhlaWdodFkgPSBSZWFkMjU2Qnl0ZXNC
bG9ja1dpZHRoWTsKKwkJCU1heGltdW1Td2F0aEhlaWdodEMgPSBSZWFkMjU2Qnl0ZXNCbG9ja1dp
ZHRoQzsKKwkJfQorCisJCWlmICgobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9
PSBkbV80NDRfNjQKKwkJCQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09
IGRtXzQ0NF8zMgorCQkJCXx8IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0g
ZG1fNDQ0XzE2CisJCQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBk
bV80NDRfOCkpIHsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10gPT0gZG1f
c3dfbGluZWFyCisJCQkJCXx8IChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09
IGRtXzQ0NF82NAorCQkJCQkJCSYmIChtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10KKwkJ
CQkJCQkJCT09IGRtX3N3XzRrYl9zCisJCQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZhY2VU
aWxpbmdba10KKwkJCQkJCQkJCQkJPT0gZG1fc3dfNGtiX3NfeAorCQkJCQkJCQkJfHwgbW9kZV9s
aWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJCT09IGRtX3N3XzY0a2JfcworCQkJ
CQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJCT09IGRt
X3N3XzY0a2Jfc190CisJCQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10K
KwkJCQkJCQkJCQkJPT0gZG1fc3dfNjRrYl9zX3gKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEu
U3VyZmFjZVRpbGluZ1trXQorCQkJCQkJCQkJCQk9PSBkbV9zd192YXJfcworCQkJCQkJCQkJfHwg
bW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJCT09IGRtX3N3X3Zhcl9z
X3gpCisJCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdID09IGRtX2hvcnopKSB7
CisJCQkJTWluaW11bVN3YXRoSGVpZ2h0WSA9IE1heGltdW1Td2F0aEhlaWdodFk7CisJCQl9IGVs
c2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzgKKwkJ
CQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdICE9IGRtX2hvcnopIHsKKwkJCQlNaW5p
bXVtU3dhdGhIZWlnaHRZID0gTWF4aW11bVN3YXRoSGVpZ2h0WTsKKwkJCX0gZWxzZSB7CisJCQkJ
TWluaW11bVN3YXRoSGVpZ2h0WSA9IE1heGltdW1Td2F0aEhlaWdodFkgLyAyLjA7CisJCQl9CisJ
CQlNaW5pbXVtU3dhdGhIZWlnaHRDID0gTWF4aW11bVN3YXRoSGVpZ2h0QzsKKwkJfSBlbHNlIHsK
KwkJCWlmIChtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10gPT0gZG1fc3dfbGluZWFyKSB7
CisJCQkJTWluaW11bVN3YXRoSGVpZ2h0WSA9IE1heGltdW1Td2F0aEhlaWdodFk7CisJCQkJTWlu
aW11bVN3YXRoSGVpZ2h0QyA9IE1heGltdW1Td2F0aEhlaWdodEM7CisJCQl9IGVsc2UgaWYgKG1v
ZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDIwXzgKKwkJCQkJJiYgbW9k
ZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdID09IGRtX2hvcnopIHsKKwkJCQlNaW5pbXVtU3dhdGhI
ZWlnaHRZID0gTWF4aW11bVN3YXRoSGVpZ2h0WSAvIDIuMDsKKwkJCQlNaW5pbXVtU3dhdGhIZWln
aHRDID0gTWF4aW11bVN3YXRoSGVpZ2h0QzsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5T
b3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfMTAKKwkJCQkJJiYgbW9kZV9saWItPnZiYS5T
b3VyY2VTY2FuW2tdID09IGRtX2hvcnopIHsKKwkJCQlNaW5pbXVtU3dhdGhIZWlnaHRDID0gTWF4
aW11bVN3YXRoSGVpZ2h0QyAvIDIuMDsKKwkJCQlNaW5pbXVtU3dhdGhIZWlnaHRZID0gTWF4aW11
bVN3YXRoSGVpZ2h0WTsKKwkJCX0gZWxzZSB7CisJCQkJTWluaW11bVN3YXRoSGVpZ2h0WSA9IE1h
eGltdW1Td2F0aEhlaWdodFk7CisJCQkJTWluaW11bVN3YXRoSGVpZ2h0QyA9IE1heGltdW1Td2F0
aEhlaWdodEM7CisJCQl9CisJCX0KKworCQlpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2td
ID09IGRtX2hvcnopIHsKKwkJCVN3YXRoV2lkdGggPSBtb2RlX2xpYi0+dmJhLlZpZXdwb3J0V2lk
dGhba107CisJCX0gZWxzZSB7CisJCQlTd2F0aFdpZHRoID0gbW9kZV9saWItPnZiYS5WaWV3cG9y
dEhlaWdodFtrXTsKKwkJfQorCisJCWlmIChtb2RlX2xpYi0+dmJhLk9ETUNvbWJpbmVFbmFibGVk
W2tdID09IHRydWUpIHsKKwkJCU1haW5QbGFuZURvZXNPRE1Db21iaW5lID0gdHJ1ZTsKKwkJfQor
CQlmb3IgKGogPSAwOyBqIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytq
KSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBqCisJCQkJ
CSYmIG1vZGVfbGliLT52YmEuT0RNQ29tYmluZUVuYWJsZWRbal0gPT0gdHJ1ZSkgeworCQkJCU1h
aW5QbGFuZURvZXNPRE1Db21iaW5lID0gdHJ1ZTsKKwkJCX0KKwkJfQorCisJCWlmIChNYWluUGxh
bmVEb2VzT0RNQ29tYmluZSA9PSB0cnVlKSB7CisJCQlTd2F0aFdpZHRoID0gZG1sX21pbigKKwkJ
CQkJU3dhdGhXaWR0aCwKKwkJCQkJbW9kZV9saWItPnZiYS5IQWN0aXZlW2tdIC8gMi4wICogbW9k
ZV9saWItPnZiYS5IUmF0aW9ba10pOworCQl9IGVsc2UgeworCQkJaWYgKG1vZGVfbGliLT52YmEu
RFBQUGVyUGxhbmVba10gPT0gMCkKKwkJCQlTd2F0aFdpZHRoID0gMDsKKwkJCWVsc2UKKwkJCQlT
d2F0aFdpZHRoID0gU3dhdGhXaWR0aCAvIG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba107CisJ
CX0KKworCQlTd2F0aFdpZHRoR3JhbnVsYXJpdHlZID0gMjU2IC8gZG1sX2NlaWwoQnl0ZVBlclBp
eERFVFksIDEpIC8gTWF4aW11bVN3YXRoSGVpZ2h0WTsKKwkJUm91bmRlZFVwTWF4U3dhdGhTaXpl
Qnl0ZXNZID0gKGRtbF9jZWlsKAorCQkJCShkb3VibGUpIChTd2F0aFdpZHRoIC0gMSksCisJCQkJ
U3dhdGhXaWR0aEdyYW51bGFyaXR5WSkgKyBTd2F0aFdpZHRoR3JhbnVsYXJpdHlZKSAqIEJ5dGVQ
ZXJQaXhERVRZCisJCQkJKiBNYXhpbXVtU3dhdGhIZWlnaHRZOworCQlpZiAobW9kZV9saWItPnZi
YS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfMTApIHsKKwkJCVJvdW5kZWRVcE1heFN3
YXRoU2l6ZUJ5dGVzWSA9IGRtbF9jZWlsKFJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5dGVzWSwgMjU2
KQorCQkJCQkrIDI1NjsKKwkJfQorCQlpZiAoTWF4aW11bVN3YXRoSGVpZ2h0QyA+IDApIHsKKwkJ
CVN3YXRoV2lkdGhHcmFudWxhcml0eUMgPSAyNTYuMCAvIGRtbF9jZWlsKEJ5dGVQZXJQaXhERVRD
LCAyKQorCQkJCQkvIE1heGltdW1Td2F0aEhlaWdodEM7CisJCQlSb3VuZGVkVXBNYXhTd2F0aFNp
emVCeXRlc0MgPSAoZG1sX2NlaWwoCisJCQkJCShkb3VibGUpIChTd2F0aFdpZHRoIC8gMi4wIC0g
MSksCisJCQkJCVN3YXRoV2lkdGhHcmFudWxhcml0eUMpICsgU3dhdGhXaWR0aEdyYW51bGFyaXR5
QykKKwkJCQkJKiBCeXRlUGVyUGl4REVUQyAqIE1heGltdW1Td2F0aEhlaWdodEM7CisJCQlpZiAo
bW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfMTApIHsKKwkJCQlS
b3VuZGVkVXBNYXhTd2F0aFNpemVCeXRlc0MgPSBkbWxfY2VpbCgKKwkJCQkJCVJvdW5kZWRVcE1h
eFN3YXRoU2l6ZUJ5dGVzQywKKwkJCQkJCTI1NikgKyAyNTY7CisJCQl9CisJCX0gZWxzZQorCQkJ
Um91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNDID0gMC4wOworCisJCWlmIChSb3VuZGVkVXBNYXhT
d2F0aFNpemVCeXRlc1kgKyBSb3VuZGVkVXBNYXhTd2F0aFNpemVCeXRlc0MKKwkJCQk8PSBtb2Rl
X2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVJbktCeXRlICogMTAyNC4wIC8gMi4wKSB7CisJCQltb2Rl
X2xpYi0+dmJhLlN3YXRoSGVpZ2h0WVtrXSA9IE1heGltdW1Td2F0aEhlaWdodFk7CisJCQltb2Rl
X2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSA9IE1heGltdW1Td2F0aEhlaWdodEM7CisJCX0gZWxz
ZSB7CisJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0WVtrXSA9IE1pbmltdW1Td2F0aEhlaWdo
dFk7CisJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSA9IE1pbmltdW1Td2F0aEhlaWdo
dEM7CisJCX0KKworCQlpZiAobW9kZV9saWItPnZiYS5Td2F0aEhlaWdodENba10gPT0gMCkgewor
CQkJbW9kZV9saWItPnZiYS5ERVRCdWZmZXJTaXplWVtrXSA9IG1vZGVfbGliLT52YmEuREVUQnVm
ZmVyU2l6ZUluS0J5dGUgKiAxMDI0OworCQkJbW9kZV9saWItPnZiYS5ERVRCdWZmZXJTaXplQ1tr
XSA9IDA7CisJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Td2F0aEhlaWdodFlba10gPD0gbW9k
ZV9saWItPnZiYS5Td2F0aEhlaWdodENba10pIHsKKwkJCW1vZGVfbGliLT52YmEuREVUQnVmZmVy
U2l6ZVlba10gPSBtb2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVJbktCeXRlCisJCQkJCSogMTAy
NC4wIC8gMjsKKwkJCW1vZGVfbGliLT52YmEuREVUQnVmZmVyU2l6ZUNba10gPSBtb2RlX2xpYi0+
dmJhLkRFVEJ1ZmZlclNpemVJbktCeXRlCisJCQkJCSogMTAyNC4wIC8gMjsKKwkJfSBlbHNlIHsK
KwkJCW1vZGVfbGliLT52YmEuREVUQnVmZmVyU2l6ZVlba10gPSBtb2RlX2xpYi0+dmJhLkRFVEJ1
ZmZlclNpemVJbktCeXRlCisJCQkJCSogMTAyNC4wICogMiAvIDM7CisJCQltb2RlX2xpYi0+dmJh
LkRFVEJ1ZmZlclNpemVDW2tdID0gbW9kZV9saWItPnZiYS5ERVRCdWZmZXJTaXplSW5LQnl0ZQor
CQkJCQkqIDEwMjQuMCAvIDM7CisJCX0KKwl9Cit9CisKK3N0YXRpYyBkb3VibGUgQ2FsY3VsYXRl
VFdhaXQoCisJCXVuc2lnbmVkIGludCBQcmVmZXRjaE1vZGUsCisJCWRvdWJsZSBEUkFNQ2xvY2tD
aGFuZ2VMYXRlbmN5LAorCQlkb3VibGUgVXJnZW50TGF0ZW5jeVBpeGVsRGF0YU9ubHksCisJCWRv
dWJsZSBTUkVudGVyUGx1c0V4aXRUaW1lKQoreworCWlmIChQcmVmZXRjaE1vZGUgPT0gMCkgewor
CQlyZXR1cm4gZG1sX21heCgKKwkJCQlEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5ICsgVXJnZW50TGF0
ZW5jeVBpeGVsRGF0YU9ubHksCisJCQkJZG1sX21heChTUkVudGVyUGx1c0V4aXRUaW1lLCBVcmdl
bnRMYXRlbmN5UGl4ZWxEYXRhT25seSkpOworCX0gZWxzZSBpZiAoUHJlZmV0Y2hNb2RlID09IDEp
IHsKKwkJcmV0dXJuIGRtbF9tYXgoU1JFbnRlclBsdXNFeGl0VGltZSwgVXJnZW50TGF0ZW5jeVBp
eGVsRGF0YU9ubHkpOworCX0gZWxzZSB7CisJCXJldHVybiBVcmdlbnRMYXRlbmN5UGl4ZWxEYXRh
T25seTsKKwl9Cit9CisKK3N0YXRpYyBkb3VibGUgQ2FsY3VsYXRlUmVtb3RlU3VyZmFjZUZsaXBE
ZWxheSgKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgVlJh
dGlvLAorCQlkb3VibGUgU3dhdGhXaWR0aCwKKwkJZG91YmxlIEJwcCwKKwkJZG91YmxlIExpbmVU
aW1lLAorCQlkb3VibGUgWEZDVFNsdlZ1cGRhdGVPZmZzZXQsCisJCWRvdWJsZSBYRkNUU2x2VnVw
ZGF0ZVdpZHRoLAorCQlkb3VibGUgWEZDVFNsdlZyZWFkeU9mZnNldCwKKwkJZG91YmxlIFhGQ1hC
VUZMYXRlbmN5VG9sZXJhbmNlLAorCQlkb3VibGUgWEZDRmlsbEJXT3ZlcmhlYWQsCisJCWRvdWJs
ZSBYRkNTbHZDaHVua1NpemUsCisJCWRvdWJsZSBYRkNCdXNUcmFuc3BvcnRUaW1lLAorCQlkb3Vi
bGUgVENhbGMsCisJCWRvdWJsZSBUV2FpdCwKKwkJZG91YmxlICpTcmNBY3RpdmVEcmFpblJhdGUs
CisJCWRvdWJsZSAqVEluaXRYRmlsbCwKKwkJZG91YmxlICpUc2x2Q2hrKQoreworCWRvdWJsZSBU
U2x2U2V0dXAsIEF2Z2ZpbGxSYXRlLCByZXN1bHQ7CisKKwkqU3JjQWN0aXZlRHJhaW5SYXRlID0g
VlJhdGlvICogU3dhdGhXaWR0aCAqIEJwcCAvIExpbmVUaW1lOworCVRTbHZTZXR1cCA9IFhGQ1RT
bHZWdXBkYXRlT2Zmc2V0ICsgWEZDVFNsdlZ1cGRhdGVXaWR0aCArIFhGQ1RTbHZWcmVhZHlPZmZz
ZXQ7CisJKlRJbml0WEZpbGwgPSBYRkNYQlVGTGF0ZW5jeVRvbGVyYW5jZSAvICgxICsgWEZDRmls
bEJXT3ZlcmhlYWQgLyAxMDApOworCUF2Z2ZpbGxSYXRlID0gKlNyY0FjdGl2ZURyYWluUmF0ZSAq
ICgxICsgWEZDRmlsbEJXT3ZlcmhlYWQgLyAxMDApOworCSpUc2x2Q2hrID0gWEZDU2x2Q2h1bmtT
aXplIC8gQXZnZmlsbFJhdGU7CisJZG1sX3ByaW50KAorCQkJIkRNTDo6Q2FsY3VsYXRlUmVtb3Rl
U3VyZmFjZUZsaXBEZWxheTogU3JjQWN0aXZlRHJhaW5SYXRlOiAlZlxuIiwKKwkJCSpTcmNBY3Rp
dmVEcmFpblJhdGUpOworCWRtbF9wcmludCgiRE1MOjpDYWxjdWxhdGVSZW1vdGVTdXJmYWNlRmxp
cERlbGF5OiBUU2x2U2V0dXA6ICVmXG4iLCBUU2x2U2V0dXApOworCWRtbF9wcmludCgiRE1MOjpD
YWxjdWxhdGVSZW1vdGVTdXJmYWNlRmxpcERlbGF5OiBUSW5pdFhGaWxsOiAlZlxuIiwgKlRJbml0
WEZpbGwpOworCWRtbF9wcmludCgiRE1MOjpDYWxjdWxhdGVSZW1vdGVTdXJmYWNlRmxpcERlbGF5
OiBBdmdmaWxsUmF0ZTogJWZcbiIsIEF2Z2ZpbGxSYXRlKTsKKwlkbWxfcHJpbnQoIkRNTDo6Q2Fs
Y3VsYXRlUmVtb3RlU3VyZmFjZUZsaXBEZWxheTogVHNsdkNoazogJWZcbiIsICpUc2x2Q2hrKTsK
KwlyZXN1bHQgPSAyICogWEZDQnVzVHJhbnNwb3J0VGltZSArIFRTbHZTZXR1cCArIFRDYWxjICsg
VFdhaXQgKyAqVHNsdkNoayArICpUSW5pdFhGaWxsOyAvLyBUT0RPOiBUaGlzIGRvZXNuJ3Qgc2Vl
bSB0byBtYXRjaCBwcm9ncmFtbWluZyBndWlkZQorCWRtbF9wcmludCgiRE1MOjpDYWxjdWxhdGVS
ZW1vdGVTdXJmYWNlRmxpcERlbGF5OiBSZW1vdGVTdXJmYWNlRmxpcERlbGF5OiAlZlxuIiwgcmVz
dWx0KTsKKwlyZXR1cm4gcmVzdWx0OworfQorCitzdGF0aWMgZG91YmxlIENhbGN1bGF0ZVdyaXRl
QmFja0RlbGF5KAorCQllbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MgV3JpdGViYWNrUGl4ZWxGb3Jt
YXQsCisJCWRvdWJsZSBXcml0ZWJhY2tIUmF0aW8sCisJCWRvdWJsZSBXcml0ZWJhY2tWUmF0aW8s
CisJCXVuc2lnbmVkIGludCBXcml0ZWJhY2tMdW1hSFRhcHMsCisJCXVuc2lnbmVkIGludCBXcml0
ZWJhY2tMdW1hVlRhcHMsCisJCXVuc2lnbmVkIGludCBXcml0ZWJhY2tDaHJvbWFIVGFwcywKKwkJ
dW5zaWduZWQgaW50IFdyaXRlYmFja0Nocm9tYVZUYXBzLAorCQl1bnNpZ25lZCBpbnQgV3JpdGVi
YWNrRGVzdGluYXRpb25XaWR0aCkKK3sKKwlkb3VibGUgQ2FsY3VsYXRlV3JpdGVCYWNrRGVsYXkg
PQorCQkJZG1sX21heCgKKwkJCQkJZG1sX2NlaWwoV3JpdGViYWNrTHVtYUhUYXBzIC8gNC4wLCAx
KSAvIFdyaXRlYmFja0hSYXRpbywKKwkJCQkJV3JpdGViYWNrTHVtYVZUYXBzICogZG1sX2NlaWwo
MS4wIC8gV3JpdGViYWNrVlJhdGlvLCAxKQorCQkJCQkJCSogZG1sX2NlaWwoCisJCQkJCQkJCQlX
cml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoCisJCQkJCQkJCQkJCS8gNC4wLAorCQkJCQkJCQkJMSkK
KwkJCQkJCQkrIGRtbF9jZWlsKDEuMCAvIFdyaXRlYmFja1ZSYXRpbywgMSkKKwkJCQkJCQkJCSog
KGRtbF9jZWlsKAorCQkJCQkJCQkJCQlXcml0ZWJhY2tMdW1hVlRhcHMKKwkJCQkJCQkJCQkJCQkv
IDQuMCwKKwkJCQkJCQkJCQkJMSkgKyA0KSk7CisKKwlpZiAoV3JpdGViYWNrUGl4ZWxGb3JtYXQg
IT0gZG1fNDQ0XzMyKSB7CisJCUNhbGN1bGF0ZVdyaXRlQmFja0RlbGF5ID0KKwkJCQlkbWxfbWF4
KAorCQkJCQkJQ2FsY3VsYXRlV3JpdGVCYWNrRGVsYXksCisJCQkJCQlkbWxfbWF4KAorCQkJCQkJ
CQlkbWxfY2VpbCgKKwkJCQkJCQkJCQlXcml0ZWJhY2tDaHJvbWFIVGFwcworCQkJCQkJCQkJCQkJ
LyAyLjAsCisJCQkJCQkJCQkJMSkKKwkJCQkJCQkJCQkvICgyCisJCQkJCQkJCQkJCQkqIFdyaXRl
YmFja0hSYXRpbyksCisJCQkJCQkJCVdyaXRlYmFja0Nocm9tYVZUYXBzCisJCQkJCQkJCQkJKiBk
bWxfY2VpbCgKKwkJCQkJCQkJCQkJCTEKKwkJCQkJCQkJCQkJCQkJLyAoMgorCQkJCQkJCQkJCQkJ
CQkJCSogV3JpdGViYWNrVlJhdGlvKSwKKwkJCQkJCQkJCQkJCTEpCisJCQkJCQkJCQkJKiBkbWxf
Y2VpbCgKKwkJCQkJCQkJCQkJCVdyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGgKKwkJCQkJCQkJCQkJ
CQkJLyAyLjAKKwkJCQkJCQkJCQkJCQkJLyAyLjAsCisJCQkJCQkJCQkJCQkxKQorCQkJCQkJCQkJ
CSsgZG1sX2NlaWwoCisJCQkJCQkJCQkJCQkxCisJCQkJCQkJCQkJCQkJCS8gKDIKKwkJCQkJCQkJ
CQkJCQkJCQkqIFdyaXRlYmFja1ZSYXRpbyksCisJCQkJCQkJCQkJCQkxKQorCQkJCQkJCQkJCQkJ
KiAoZG1sX2NlaWwoCisJCQkJCQkJCQkJCQkJCVdyaXRlYmFja0Nocm9tYVZUYXBzCisJCQkJCQkJ
CQkJCQkJCQkJLyA0LjAsCisJCQkJCQkJCQkJCQkJCTEpCisJCQkJCQkJCQkJCQkJCSsgNCkpKTsK
Kwl9CisJcmV0dXJuIENhbGN1bGF0ZVdyaXRlQmFja0RlbGF5OworfQorCitzdGF0aWMgdm9pZCBD
YWxjdWxhdGVBY3RpdmVSb3dCYW5kd2lkdGgoCisJCWJvb2wgR1BVVk1FbmFibGUsCisJCWVudW0g
c291cmNlX2Zvcm1hdF9jbGFzcyBTb3VyY2VQaXhlbEZvcm1hdCwKKwkJZG91YmxlIFZSYXRpbywK
KwkJYm9vbCBEQ0NFbmFibGUsCisJCWRvdWJsZSBMaW5lVGltZSwKKwkJdW5zaWduZWQgaW50IE1l
dGFSb3dCeXRlTHVtYSwKKwkJdW5zaWduZWQgaW50IE1ldGFSb3dCeXRlQ2hyb21hLAorCQl1bnNp
Z25lZCBpbnQgbWV0YV9yb3dfaGVpZ2h0X2x1bWEsCisJCXVuc2lnbmVkIGludCBtZXRhX3Jvd19o
ZWlnaHRfY2hyb21hLAorCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVCeXRlc1BlclJvd0x1bWEsCisJ
CXVuc2lnbmVkIGludCBQaXhlbFBURUJ5dGVzUGVyUm93Q2hyb21hLAorCQl1bnNpZ25lZCBpbnQg
ZHB0ZV9yb3dfaGVpZ2h0X2x1bWEsCisJCXVuc2lnbmVkIGludCBkcHRlX3Jvd19oZWlnaHRfY2hy
b21hLAorCQlkb3VibGUgKm1ldGFfcm93X2J3LAorCQlkb3VibGUgKmRwdGVfcm93X2J3LAorCQlk
b3VibGUgKnF1YWxfcm93X2J3KQoreworCWlmIChEQ0NFbmFibGUgIT0gdHJ1ZSkgeworCQkqbWV0
YV9yb3dfYncgPSAwOworCX0gZWxzZSBpZiAoU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDIwXzgg
fHwgU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDIwXzEwKSB7CisJCSptZXRhX3Jvd19idyA9IFZS
YXRpbyAqIE1ldGFSb3dCeXRlTHVtYSAvIChtZXRhX3Jvd19oZWlnaHRfbHVtYSAqIExpbmVUaW1l
KQorCQkJCSsgVlJhdGlvIC8gMiAqIE1ldGFSb3dCeXRlQ2hyb21hCisJCQkJCQkvIChtZXRhX3Jv
d19oZWlnaHRfY2hyb21hICogTGluZVRpbWUpOworCX0gZWxzZSB7CisJCSptZXRhX3Jvd19idyA9
IFZSYXRpbyAqIE1ldGFSb3dCeXRlTHVtYSAvIChtZXRhX3Jvd19oZWlnaHRfbHVtYSAqIExpbmVU
aW1lKTsKKwl9CisKKwlpZiAoR1BVVk1FbmFibGUgIT0gdHJ1ZSkgeworCQkqZHB0ZV9yb3dfYncg
PSAwOworCX0gZWxzZSBpZiAoU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDIwXzggfHwgU291cmNl
UGl4ZWxGb3JtYXQgPT0gZG1fNDIwXzEwKSB7CisJCSpkcHRlX3Jvd19idyA9IFZSYXRpbyAqIFBp
eGVsUFRFQnl0ZXNQZXJSb3dMdW1hIC8gKGRwdGVfcm93X2hlaWdodF9sdW1hICogTGluZVRpbWUp
CisJCQkJKyBWUmF0aW8gLyAyICogUGl4ZWxQVEVCeXRlc1BlclJvd0Nocm9tYQorCQkJCQkJLyAo
ZHB0ZV9yb3dfaGVpZ2h0X2Nocm9tYSAqIExpbmVUaW1lKTsKKwl9IGVsc2UgeworCQkqZHB0ZV9y
b3dfYncgPSBWUmF0aW8gKiBQaXhlbFBURUJ5dGVzUGVyUm93THVtYSAvIChkcHRlX3Jvd19oZWln
aHRfbHVtYSAqIExpbmVUaW1lKTsKKwl9CisKKwlpZiAoKFNvdXJjZVBpeGVsRm9ybWF0ID09IGRt
XzQyMF84IHx8IFNvdXJjZVBpeGVsRm9ybWF0ID09IGRtXzQyMF8xMCkpIHsKKwkJKnF1YWxfcm93
X2J3ID0gKm1ldGFfcm93X2J3ICsgKmRwdGVfcm93X2J3OworCX0gZWxzZSB7CisJCSpxdWFsX3Jv
d19idyA9IDA7CisJfQorfQorCitzdGF0aWMgdm9pZCBDYWxjdWxhdGVGbGlwU2NoZWR1bGUoCisJ
CXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJZG91YmxlIFVyZ2VudEV4dHJh
TGF0ZW5jeSwKKwkJZG91YmxlIFVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5LAorCQl1bnNpZ25l
ZCBpbnQgR1BVVk1NYXhQYWdlVGFibGVMZXZlbHMsCisJCWJvb2wgR1BVVk1FbmFibGUsCisJCWRv
dWJsZSBCYW5kd2lkdGhBdmFpbGFibGVGb3JJbW1lZGlhdGVGbGlwLAorCQl1bnNpZ25lZCBpbnQg
VG90SW1tZWRpYXRlRmxpcEJ5dGVzLAorCQllbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MgU291cmNl
UGl4ZWxGb3JtYXQsCisJCXVuc2lnbmVkIGludCBJbW1lZGlhdGVGbGlwQnl0ZXMsCisJCWRvdWJs
ZSBMaW5lVGltZSwKKwkJZG91YmxlIFZSYXRpbywKKwkJZG91YmxlIFRub19idywKKwkJZG91Ymxl
IFBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lLAorCQl1bnNpZ25lZCBpbnQgTWV0YVJvd0J5dGUsCisJ
CXVuc2lnbmVkIGludCBQaXhlbFBURUJ5dGVzUGVyUm93LAorCQlib29sIERDQ0VuYWJsZSwKKwkJ
dW5zaWduZWQgaW50IGRwdGVfcm93X2hlaWdodCwKKwkJdW5zaWduZWQgaW50IG1ldGFfcm93X2hl
aWdodCwKKwkJZG91YmxlIHF1YWxfcm93X2J3LAorCQlkb3VibGUgKkRlc3RpbmF0aW9uTGluZXNU
b1JlcXVlc3RWTUluSW1tZWRpYXRlRmxpcCwKKwkJZG91YmxlICpEZXN0aW5hdGlvbkxpbmVzVG9S
ZXF1ZXN0Um93SW5JbW1lZGlhdGVGbGlwLAorCQlkb3VibGUgKmZpbmFsX2ZsaXBfYncsCisJCWJv
b2wgKkltbWVkaWF0ZUZsaXBTdXBwb3J0ZWRGb3JQaXBlKQoreworCWRvdWJsZSBtaW5fcm93X3Rp
bWUgPSAwLjA7CisKKwlpZiAoU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDIwXzggfHwgU291cmNl
UGl4ZWxGb3JtYXQgPT0gZG1fNDIwXzEwKSB7CisJCSpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0
Vk1JbkltbWVkaWF0ZUZsaXAgPSAwLjA7CisJCSpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93
SW5JbW1lZGlhdGVGbGlwID0gMC4wOworCQkqZmluYWxfZmxpcF9idyA9IHF1YWxfcm93X2J3Owor
CQkqSW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclBpcGUgPSB0cnVlOworCX0gZWxzZSB7CisJCWRv
dWJsZSBUaW1lRm9yRmV0Y2hpbmdNZXRhUFRFSW1tZWRpYXRlRmxpcDsKKwkJZG91YmxlIFRpbWVG
b3JGZXRjaGluZ1Jvd0luVkJsYW5rSW1tZWRpYXRlRmxpcDsKKworCQlpZiAoR1BVVk1FbmFibGUg
PT0gdHJ1ZSkgeworCQkJbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwQldbMF0gPSBCYW5kd2lk
dGhBdmFpbGFibGVGb3JJbW1lZGlhdGVGbGlwCisJCQkJCSogSW1tZWRpYXRlRmxpcEJ5dGVzIC8g
VG90SW1tZWRpYXRlRmxpcEJ5dGVzOworCQkJVGltZUZvckZldGNoaW5nTWV0YVBURUltbWVkaWF0
ZUZsaXAgPQorCQkJCQlkbWxfbWF4KAorCQkJCQkJCVRub19idworCQkJCQkJCQkJKyBQREVBbmRN
ZXRhUFRFQnl0ZXNGcmFtZQorCQkJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuSW1tZWRpYXRlRmxp
cEJXWzBdLAorCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCQlVcmdlbnRFeHRyYUxhdGVuY3kKKwkJ
CQkJCQkJCQkJKyBVcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seQorCQkJCQkJCQkJCQkJCSogKEdQ
VVZNTWF4UGFnZVRhYmxlTGV2ZWxzCisJCQkJCQkJCQkJCQkJCQktIDEpLAorCQkJCQkJCQkJTGlu
ZVRpbWUgLyA0LjApKTsKKwkJfSBlbHNlIHsKKwkJCVRpbWVGb3JGZXRjaGluZ01ldGFQVEVJbW1l
ZGlhdGVGbGlwID0gMDsKKwkJfQorCisJCSpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1Jbklt
bWVkaWF0ZUZsaXAgPSBkbWxfZmxvb3IoCisJCQkJNC4wICogKFRpbWVGb3JGZXRjaGluZ01ldGFQ
VEVJbW1lZGlhdGVGbGlwIC8gTGluZVRpbWUgKyAwLjEyNSksCisJCQkJMSkgLyA0LjA7CisKKwkJ
aWYgKChHUFVWTUVuYWJsZSA9PSB0cnVlIHx8IERDQ0VuYWJsZSA9PSB0cnVlKSkgeworCQkJbW9k
ZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwQldbMF0gPSBCYW5kd2lkdGhBdmFpbGFibGVGb3JJbW1l
ZGlhdGVGbGlwCisJCQkJCSogSW1tZWRpYXRlRmxpcEJ5dGVzIC8gVG90SW1tZWRpYXRlRmxpcEJ5
dGVzOworCQkJVGltZUZvckZldGNoaW5nUm93SW5WQmxhbmtJbW1lZGlhdGVGbGlwID0gZG1sX21h
eCgKKwkJCQkJKE1ldGFSb3dCeXRlICsgUGl4ZWxQVEVCeXRlc1BlclJvdykKKwkJCQkJCQkvIG1v
ZGVfbGliLT52YmEuSW1tZWRpYXRlRmxpcEJXWzBdLAorCQkJCQlkbWxfbWF4KFVyZ2VudExhdGVu
Y3lQaXhlbERhdGFPbmx5LCBMaW5lVGltZSAvIDQuMCkpOworCQl9IGVsc2UgeworCQkJVGltZUZv
ckZldGNoaW5nUm93SW5WQmxhbmtJbW1lZGlhdGVGbGlwID0gMDsKKwkJfQorCisJCSpEZXN0aW5h
dGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5JbW1lZGlhdGVGbGlwID0gZG1sX2Zsb29yKAorCQkJCTQu
MCAqIChUaW1lRm9yRmV0Y2hpbmdSb3dJblZCbGFua0ltbWVkaWF0ZUZsaXAgLyBMaW5lVGltZSAr
IDAuMTI1KSwKKwkJCQkxKSAvIDQuMDsKKworCQlpZiAoR1BVVk1FbmFibGUgPT0gdHJ1ZSkgewor
CQkJKmZpbmFsX2ZsaXBfYncgPQorCQkJCQlkbWxfbWF4KAorCQkJCQkJCVBERUFuZE1ldGFQVEVC
eXRlc0ZyYW1lCisJCQkJCQkJCQkvICgqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5JbW1l
ZGlhdGVGbGlwCisJCQkJCQkJCQkJCSogTGluZVRpbWUpLAorCQkJCQkJCShNZXRhUm93Qnl0ZSAr
IFBpeGVsUFRFQnl0ZXNQZXJSb3cpCisJCQkJCQkJCQkvIChUaW1lRm9yRmV0Y2hpbmdSb3dJblZC
bGFua0ltbWVkaWF0ZUZsaXAKKwkJCQkJCQkJCQkJKiBMaW5lVGltZSkpOworCQl9IGVsc2UgaWYg
KE1ldGFSb3dCeXRlICsgUGl4ZWxQVEVCeXRlc1BlclJvdyA+IDApIHsKKwkJCSpmaW5hbF9mbGlw
X2J3ID0gKE1ldGFSb3dCeXRlICsgUGl4ZWxQVEVCeXRlc1BlclJvdykKKwkJCQkJLyAoVGltZUZv
ckZldGNoaW5nUm93SW5WQmxhbmtJbW1lZGlhdGVGbGlwICogTGluZVRpbWUpOworCQl9IGVsc2Ug
eworCQkJKmZpbmFsX2ZsaXBfYncgPSAwOworCQl9CisKKwkJaWYgKEdQVVZNRW5hYmxlICYmICFE
Q0NFbmFibGUpCisJCQltaW5fcm93X3RpbWUgPSBkcHRlX3Jvd19oZWlnaHQgKiBMaW5lVGltZSAv
IFZSYXRpbzsKKwkJZWxzZSBpZiAoIUdQVVZNRW5hYmxlICYmIERDQ0VuYWJsZSkKKwkJCW1pbl9y
b3dfdGltZSA9IG1ldGFfcm93X2hlaWdodCAqIExpbmVUaW1lIC8gVlJhdGlvOworCQllbHNlCisJ
CQltaW5fcm93X3RpbWUgPSBkbWxfbWluKGRwdGVfcm93X2hlaWdodCwgbWV0YV9yb3dfaGVpZ2h0
KSAqIExpbmVUaW1lCisJCQkJCS8gVlJhdGlvOworCisJCWlmICgqRGVzdGluYXRpb25MaW5lc1Rv
UmVxdWVzdFZNSW5JbW1lZGlhdGVGbGlwID49IDgKKwkJCQl8fCAqRGVzdGluYXRpb25MaW5lc1Rv
UmVxdWVzdFJvd0luSW1tZWRpYXRlRmxpcCA+PSAxNgorCQkJCXx8IFRpbWVGb3JGZXRjaGluZ01l
dGFQVEVJbW1lZGlhdGVGbGlwCisJCQkJCQkrIDIgKiBUaW1lRm9yRmV0Y2hpbmdSb3dJblZCbGFu
a0ltbWVkaWF0ZUZsaXAKKwkJCQkJCT4gbWluX3Jvd190aW1lKQorCQkJKkltbWVkaWF0ZUZsaXBT
dXBwb3J0ZWRGb3JQaXBlID0gZmFsc2U7CisJCWVsc2UKKwkJCSpJbW1lZGlhdGVGbGlwU3VwcG9y
dGVkRm9yUGlwZSA9IHRydWU7CisJfQorfQorCitzdGF0aWMgdW5zaWduZWQgaW50IFRydW5jVG9W
YWxpZEJQUCgKKwkJZG91YmxlIERlY2ltYWxCUFAsCisJCWJvb2wgRFNDRW5hYmxlZCwKKwkJZW51
bSBvdXRwdXRfZW5jb2Rlcl9jbGFzcyBPdXRwdXQsCisJCWVudW0gb3V0cHV0X2Zvcm1hdF9jbGFz
cyBGb3JtYXQsCisJCXVuc2lnbmVkIGludCBEU0NJbnB1dEJpdFBlckNvbXBvbmVudCkKK3sKKwlp
ZiAoT3V0cHV0ID09IGRtX2hkbWkpIHsKKwkJaWYgKEZvcm1hdCA9PSBkbV80MjApIHsKKwkJCWlm
IChEZWNpbWFsQlBQID49IDE4KQorCQkJCXJldHVybiAxODsKKwkJCWVsc2UgaWYgKERlY2ltYWxC
UFAgPj0gMTUpCisJCQkJcmV0dXJuIDE1OworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAxMikK
KwkJCQlyZXR1cm4gMTI7CisJCQllbHNlCisJCQkJcmV0dXJuIEJQUF9JTlZBTElEOworCQl9IGVs
c2UgaWYgKEZvcm1hdCA9PSBkbV80NDQpIHsKKwkJCWlmIChEZWNpbWFsQlBQID49IDM2KQorCQkJ
CXJldHVybiAzNjsKKwkJCWVsc2UgaWYgKERlY2ltYWxCUFAgPj0gMzApCisJCQkJcmV0dXJuIDMw
OworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAyNCkKKwkJCQlyZXR1cm4gMjQ7CisJCQllbHNl
IGlmIChEZWNpbWFsQlBQID49IDE4KQorCQkJCXJldHVybiAxODsKKwkJCWVsc2UKKwkJCQlyZXR1
cm4gQlBQX0lOVkFMSUQ7CisJCX0gZWxzZSB7CisJCQlpZiAoRGVjaW1hbEJQUCAvIDEuNSA+PSAy
NCkKKwkJCQlyZXR1cm4gMjQ7CisJCQllbHNlIGlmIChEZWNpbWFsQlBQIC8gMS41ID49IDIwKQor
CQkJCXJldHVybiAyMDsKKwkJCWVsc2UgaWYgKERlY2ltYWxCUFAgLyAxLjUgPj0gMTYpCisJCQkJ
cmV0dXJuIDE2OworCQkJZWxzZQorCQkJCXJldHVybiBCUFBfSU5WQUxJRDsKKwkJfQorCX0gZWxz
ZSB7CisJCWlmIChEU0NFbmFibGVkKSB7CisJCQlpZiAoRm9ybWF0ID09IGRtXzQyMCkgeworCQkJ
CWlmIChEZWNpbWFsQlBQIDwgNikKKwkJCQkJcmV0dXJuIEJQUF9JTlZBTElEOworCQkJCWVsc2Ug
aWYgKERlY2ltYWxCUFAgPj0gMS41ICogRFNDSW5wdXRCaXRQZXJDb21wb25lbnQgLSAxIC8gMTYp
CisJCQkJCXJldHVybiAxLjUgKiBEU0NJbnB1dEJpdFBlckNvbXBvbmVudCAtIDEgLyAxNjsKKwkJ
CQllbHNlCisJCQkJCXJldHVybiBkbWxfZmxvb3IoMTYgKiBEZWNpbWFsQlBQLCAxKSAvIDE2Owor
CQkJfSBlbHNlIGlmIChGb3JtYXQgPT0gZG1fbjQyMikgeworCQkJCWlmIChEZWNpbWFsQlBQIDwg
NykKKwkJCQkJcmV0dXJuIEJQUF9JTlZBTElEOworCQkJCWVsc2UgaWYgKERlY2ltYWxCUFAgPj0g
MiAqIERTQ0lucHV0Qml0UGVyQ29tcG9uZW50IC0gMSAvIDE2KQorCQkJCQlyZXR1cm4gMiAqIERT
Q0lucHV0Qml0UGVyQ29tcG9uZW50IC0gMSAvIDE2OworCQkJCWVsc2UKKwkJCQkJcmV0dXJuIGRt
bF9mbG9vcigxNiAqIERlY2ltYWxCUFAsIDEpIC8gMTY7CisJCQl9IGVsc2UgeworCQkJCWlmIChE
ZWNpbWFsQlBQIDwgOCkKKwkJCQkJcmV0dXJuIEJQUF9JTlZBTElEOworCQkJCWVsc2UgaWYgKERl
Y2ltYWxCUFAgPj0gMyAqIERTQ0lucHV0Qml0UGVyQ29tcG9uZW50IC0gMSAvIDE2KQorCQkJCQly
ZXR1cm4gMyAqIERTQ0lucHV0Qml0UGVyQ29tcG9uZW50IC0gMSAvIDE2OworCQkJCWVsc2UKKwkJ
CQkJcmV0dXJuIGRtbF9mbG9vcigxNiAqIERlY2ltYWxCUFAsIDEpIC8gMTY7CisJCQl9CisJCX0g
ZWxzZSBpZiAoRm9ybWF0ID09IGRtXzQyMCkgeworCQkJaWYgKERlY2ltYWxCUFAgPj0gMTgpCisJ
CQkJcmV0dXJuIDE4OworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAxNSkKKwkJCQlyZXR1cm4g
MTU7CisJCQllbHNlIGlmIChEZWNpbWFsQlBQID49IDEyKQorCQkJCXJldHVybiAxMjsKKwkJCWVs
c2UKKwkJCQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCX0gZWxzZSBpZiAoRm9ybWF0ID09IGRtX3M0
MjIgfHwgRm9ybWF0ID09IGRtX240MjIpIHsKKwkJCWlmIChEZWNpbWFsQlBQID49IDI0KQorCQkJ
CXJldHVybiAyNDsKKwkJCWVsc2UgaWYgKERlY2ltYWxCUFAgPj0gMjApCisJCQkJcmV0dXJuIDIw
OworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAxNikKKwkJCQlyZXR1cm4gMTY7CisJCQllbHNl
CisJCQkJcmV0dXJuIEJQUF9JTlZBTElEOworCQl9IGVsc2UgeworCQkJaWYgKERlY2ltYWxCUFAg
Pj0gMzYpCisJCQkJcmV0dXJuIDM2OworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAzMCkKKwkJ
CQlyZXR1cm4gMzA7CisJCQllbHNlIGlmIChEZWNpbWFsQlBQID49IDI0KQorCQkJCXJldHVybiAy
NDsKKwkJCWVsc2UgaWYgKERlY2ltYWxCUFAgPj0gMTgpCisJCQkJcmV0dXJuIDE4OworCQkJZWxz
ZQorCQkJCXJldHVybiBCUFBfSU5WQUxJRDsKKwkJfQorCX0KK30KKwordm9pZCBkbWwyMF9Nb2Rl
U3VwcG9ydEFuZFN5c3RlbUNvbmZpZ3VyYXRpb25GdWxsKHN0cnVjdCBkaXNwbGF5X21vZGVfbGli
ICptb2RlX2xpYikKK3sKKwlzdHJ1Y3QgdmJhX3ZhcnNfc3QgKmxvY2FscyA9ICZtb2RlX2xpYi0+
dmJhOworCisJaW50IGk7CisJdW5zaWduZWQgaW50IGosIGssIG07CisKKwkvKk1PREUgU1VQUE9S
VCwgVk9MVEFHRSBTVEFURSBBTkQgU09DIENPTkZJR1VSQVRJT04qLworCisJLypTY2FsZSBSYXRp
bywgdGFwcyBTdXBwb3J0IENoZWNrKi8KKworCW1vZGVfbGliLT52YmEuU2NhbGVSYXRpb0FuZFRh
cHNTdXBwb3J0ID0gdHJ1ZTsKKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVy
T2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuU2NhbGVyRW5h
YmxlZFtrXSA9PSBmYWxzZQorCQkJCSYmICgobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1h
dFtrXSAhPSBkbV80NDRfNjQKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3Jt
YXRba10gIT0gZG1fNDQ0XzMyCisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9y
bWF0W2tdICE9IGRtXzQ0NF8xNgorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZv
cm1hdFtrXSAhPSBkbV9tb25vXzE2CisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVs
Rm9ybWF0W2tdICE9IGRtX21vbm9fOCkKKwkJCQkJCXx8IG1vZGVfbGliLT52YmEuSFJhdGlvW2td
ICE9IDEuMAorCQkJCQkJfHwgbW9kZV9saWItPnZiYS5odGFwc1trXSAhPSAxLjAKKwkJCQkJCXx8
IG1vZGVfbGliLT52YmEuVlJhdGlvW2tdICE9IDEuMAorCQkJCQkJfHwgbW9kZV9saWItPnZiYS52
dGFwc1trXSAhPSAxLjApKSB7CisJCQltb2RlX2xpYi0+dmJhLlNjYWxlUmF0aW9BbmRUYXBzU3Vw
cG9ydCA9IGZhbHNlOworCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEudnRhcHNba10gPCAxLjAg
fHwgbW9kZV9saWItPnZiYS52dGFwc1trXSA+IDguMAorCQkJCXx8IG1vZGVfbGliLT52YmEuaHRh
cHNba10gPCAxLjAgfHwgbW9kZV9saWItPnZiYS5odGFwc1trXSA+IDguMAorCQkJCXx8IChtb2Rl
X2xpYi0+dmJhLmh0YXBzW2tdID4gMS4wCisJCQkJCQkmJiAobW9kZV9saWItPnZiYS5odGFwc1tr
XSAlIDIpID09IDEpCisJCQkJfHwgbW9kZV9saWItPnZiYS5IUmF0aW9ba10gPiBtb2RlX2xpYi0+
dmJhLk1heEhTQ0xSYXRpbworCQkJCXx8IG1vZGVfbGliLT52YmEuVlJhdGlvW2tdID4gbW9kZV9s
aWItPnZiYS5NYXhWU0NMUmF0aW8KKwkJCQl8fCBtb2RlX2xpYi0+dmJhLkhSYXRpb1trXSA+IG1v
ZGVfbGliLT52YmEuaHRhcHNba10KKwkJCQl8fCBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSA+IG1v
ZGVfbGliLT52YmEudnRhcHNba10KKwkJCQl8fCAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZv
cm1hdFtrXSAhPSBkbV80NDRfNjQKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxG
b3JtYXRba10gIT0gZG1fNDQ0XzMyCisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVs
Rm9ybWF0W2tdICE9IGRtXzQ0NF8xNgorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhl
bEZvcm1hdFtrXSAhPSBkbV9tb25vXzE2CisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBp
eGVsRm9ybWF0W2tdICE9IGRtX21vbm9fOAorCQkJCQkJJiYgKG1vZGVfbGliLT52YmEuSFJhdGlv
W2tdIC8gMi4wCisJCQkJCQkJCT4gbW9kZV9saWItPnZiYS5IVEFQc0Nocm9tYVtrXQorCQkJCQkJ
CQl8fCBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSAvIDIuMAorCQkJCQkJCQkJCT4gbW9kZV9saWIt
PnZiYS5WVEFQc0Nocm9tYVtrXSkpKSB7CisJCQltb2RlX2xpYi0+dmJhLlNjYWxlUmF0aW9BbmRU
YXBzU3VwcG9ydCA9IGZhbHNlOworCQl9CisJfQorCS8qU291cmNlIEZvcm1hdCwgUGl4ZWwgRm9y
bWF0IGFuZCBTY2FuIFN1cHBvcnQgQ2hlY2sqLworCisJbW9kZV9saWItPnZiYS5Tb3VyY2VGb3Jt
YXRQaXhlbEFuZFNjYW5TdXBwb3J0ID0gdHJ1ZTsKKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGli
LT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKChtb2RlX2xpYi0+
dmJhLlN1cmZhY2VUaWxpbmdba10gPT0gZG1fc3dfbGluZWFyCisJCQkJJiYgbW9kZV9saWItPnZi
YS5Tb3VyY2VTY2FuW2tdICE9IGRtX2hvcnopCisJCQkJfHwgKChtb2RlX2xpYi0+dmJhLlN1cmZh
Y2VUaWxpbmdba10gPT0gZG1fc3dfNGtiX2QKKwkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFj
ZVRpbGluZ1trXSA9PSBkbV9zd180a2JfZF94CisJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZh
Y2VUaWxpbmdba10gPT0gZG1fc3dfNjRrYl9kCisJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZh
Y2VUaWxpbmdba10gPT0gZG1fc3dfNjRrYl9kX3QKKwkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3Vy
ZmFjZVRpbGluZ1trXSA9PSBkbV9zd182NGtiX2RfeAorCQkJCQkJfHwgbW9kZV9saWItPnZiYS5T
dXJmYWNlVGlsaW5nW2tdID09IGRtX3N3X3Zhcl9kCisJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1
cmZhY2VUaWxpbmdba10gPT0gZG1fc3dfdmFyX2RfeCkKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEu
U291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzY0KQorCQkJCXx8IChtb2RlX2xpYi0+dmJh
LlN1cmZhY2VUaWxpbmdba10gPT0gZG1fc3dfNjRrYl9yX3gKKwkJCQkJCSYmIChtb2RlX2xpYi0+
dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtX21vbm9fOAorCQkJCQkJCQl8fCBtb2RlX2xp
Yi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdCisJCQkJCQkJCQkJPT0gZG1fNDIwXzgKKwkJCQkJ
CQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXQorCQkJCQkJCQkJCT09IGRt
XzQyMF8xMCkpCisJCQkJfHwgKCgobW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdID09IGRt
X3N3X2dmeDdfMmRfdGhpbl9nbAorCQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5n
W2tdCisJCQkJCQkJCT09IGRtX3N3X2dmeDdfMmRfdGhpbl9sdnApCisJCQkJCQkmJiAhKChtb2Rl
X2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdCisJCQkJCQkJCT09IGRtXzQ0NF82NAorCQkJ
CQkJCQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdCisJCQkJCQkJCQkJPT0g
ZG1fNDQ0XzMyKQorCQkJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10KKwkJCQkJ
CQkJCQk9PSBkbV9ob3J6CisJCQkJCQkJCSYmIG1vZGVfbGliLT52YmEuU3VwcG9ydEdGWDdDb21w
YXRpYmxlVGlsaW5nSW4zMmJwcEFuZDY0YnBwCisJCQkJCQkJCQkJPT0gdHJ1ZQorCQkJCQkJCQkm
JiBtb2RlX2xpYi0+dmJhLkRDQ0VuYWJsZVtrXQorCQkJCQkJCQkJCT09IGZhbHNlKSkKKwkJCQkJ
CXx8IChtb2RlX2xpYi0+dmJhLkRDQ0VuYWJsZVtrXSA9PSB0cnVlCisJCQkJCQkJCSYmIChtb2Rl
X2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10KKwkJCQkJCQkJCQk9PSBkbV9zd19saW5lYXIKKwkJ
CQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdCisJCQkJCQkJCQkJ
CQk9PSBkbV80MjBfOAorCQkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3Jt
YXRba10KKwkJCQkJCQkJCQkJCT09IGRtXzQyMF8xMCkpKSkgeworCQkJbW9kZV9saWItPnZiYS5T
b3VyY2VGb3JtYXRQaXhlbEFuZFNjYW5TdXBwb3J0ID0gZmFsc2U7CisJCX0KKwl9CisJLypCYW5k
d2lkdGggU3VwcG9ydCBDaGVjayovCisKKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEu
TnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuU291
cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzY0KSB7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhl
bEluREVUWVtrXSA9IDguMDsKKwkJCWxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRDW2tdID0gMC4w
OworCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1f
NDQ0XzMyKSB7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSA9IDQuMDsKKwkJCWxv
Y2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRDW2tdID0gMC4wOworCQl9IGVsc2UgaWYgKG1vZGVfbGli
LT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzE2CisJCQkJfHwgbW9kZV9saWIt
PnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV9tb25vXzE2KSB7CisJCQlsb2NhbHMtPkJ5
dGVQZXJQaXhlbEluREVUWVtrXSA9IDIuMDsKKwkJCWxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRD
W2tdID0gMC4wOworCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRb
a10gPT0gZG1fbW9ub184KSB7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSA9IDEu
MDsKKwkJCWxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRDW2tdID0gMC4wOworCQl9IGVsc2UgaWYg
KG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDIwXzgpIHsKKwkJCWxv
Y2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdID0gMS4wOworCQkJbG9jYWxzLT5CeXRlUGVyUGl4
ZWxJbkRFVENba10gPSAyLjA7CisJCX0gZWxzZSB7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbElu
REVUWVtrXSA9IDQuMCAvIDM7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSA9IDgu
MCAvIDM7CisJCX0KKwkJaWYgKG1vZGVfbGliLT52YmEuU291cmNlU2NhbltrXSA9PSBkbV9ob3J6
KSB7CisJCQlsb2NhbHMtPlN3YXRoV2lkdGhZU2luZ2xlRFBQW2tdID0gbW9kZV9saWItPnZiYS5W
aWV3cG9ydFdpZHRoW2tdOworCQl9IGVsc2UgeworCQkJbG9jYWxzLT5Td2F0aFdpZHRoWVNpbmds
ZURQUFtrXSA9IG1vZGVfbGliLT52YmEuVmlld3BvcnRIZWlnaHRba107CisJCX0KKwl9CisJZm9y
IChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysr
KSB7CisJCWxvY2Fscy0+UmVhZEJhbmR3aWR0aEx1bWFba10gPSBsb2NhbHMtPlN3YXRoV2lkdGhZ
U2luZ2xlRFBQW2tdICogZG1sX2NlaWwobG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10sIDEu
MCkKKwkJCQkvIChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxD
bG9ja1trXSkgKiBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXTsKKwkJbG9jYWxzLT5SZWFkQmFuZHdp
ZHRoQ2hyb21hW2tdID0gbG9jYWxzLT5Td2F0aFdpZHRoWVNpbmdsZURQUFtrXSAvIDIgKiBkbWxf
Y2VpbChsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSwgMi4wKQorCQkJCS8gKG1vZGVfbGli
LT52YmEuSFRvdGFsW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKSAqIG1vZGVfbGli
LT52YmEuVlJhdGlvW2tdIC8gMi4wOworCQlsb2NhbHMtPlJlYWRCYW5kd2lkdGhba10gPSBsb2Nh
bHMtPlJlYWRCYW5kd2lkdGhMdW1hW2tdICsgbG9jYWxzLT5SZWFkQmFuZHdpZHRoQ2hyb21hW2td
OworCX0KKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFu
ZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrRW5hYmxlW2tdID09
IHRydWUKKwkJCQkmJiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja1BpeGVsRm9ybWF0W2tdID09IGRt
XzQ0NF8zMikgeworCQkJbG9jYWxzLT5Xcml0ZUJhbmR3aWR0aFtrXSA9IG1vZGVfbGliLT52YmEu
V3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFtrXQorCQkJCQkqIG1vZGVfbGliLT52YmEuV3JpdGVi
YWNrRGVzdGluYXRpb25IZWlnaHRba10KKwkJCQkJLyAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tT
b3VyY2VIZWlnaHRba10KKwkJCQkJCQkqIG1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJ
LyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pICogNC4wOworCQl9IGVsc2UgaWYgKG1vZGVf
bGliLT52YmEuV3JpdGViYWNrRW5hYmxlW2tdID09IHRydWUKKwkJCQkmJiBtb2RlX2xpYi0+dmJh
LldyaXRlYmFja1BpeGVsRm9ybWF0W2tdID09IGRtXzQyMF8xMCkgeworCQkJbG9jYWxzLT5Xcml0
ZUJhbmR3aWR0aFtrXSA9IG1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFtr
XQorCQkJCQkqIG1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25IZWlnaHRba10KKwkJ
CQkJLyAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tTb3VyY2VIZWlnaHRba10KKwkJCQkJCQkqIG1v
ZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tb
a10pICogMy4wOworCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrRW5hYmxlW2td
ID09IHRydWUpIHsKKwkJCWxvY2Fscy0+V3JpdGVCYW5kd2lkdGhba10gPSBtb2RlX2xpYi0+dmJh
LldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJKiBtb2RlX2xpYi0+dmJhLldyaXRl
YmFja0Rlc3RpbmF0aW9uSGVpZ2h0W2tdCisJCQkJCS8gKG1vZGVfbGliLT52YmEuV3JpdGViYWNr
U291cmNlSGVpZ2h0W2tdCisJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJ
CS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKSAqIDEuNTsKKwkJfSBlbHNlIHsKKwkJCWxv
Y2Fscy0+V3JpdGVCYW5kd2lkdGhba10gPSAwLjA7CisJCX0KKwl9CisJbW9kZV9saWItPnZiYS5E
Q0NFbmFibGVkSW5BbnlQbGFuZSA9IGZhbHNlOworCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlpZiAobW9kZV9saWItPnZi
YS5EQ0NFbmFibGVba10gPT0gdHJ1ZSkgeworCQkJbW9kZV9saWItPnZiYS5EQ0NFbmFibGVkSW5B
bnlQbGFuZSA9IHRydWU7CisJCX0KKwl9CisJZm9yIChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJh
LnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJbG9jYWxzLT5GYWJyaWNBbmREUkFNQmFuZHdpZHRo
UGVyU3RhdGVbaV0gPSBkbWxfbWluKAorCQkJCW1vZGVfbGliLT52YmEuRFJBTVNwZWVkUGVyU3Rh
dGVbaV0gKiBtb2RlX2xpYi0+dmJhLk51bWJlck9mQ2hhbm5lbHMKKwkJCQkJCSogbW9kZV9saWIt
PnZiYS5EUkFNQ2hhbm5lbFdpZHRoLAorCQkJCW1vZGVfbGliLT52YmEuRmFicmljQ2xvY2tQZXJT
dGF0ZVtpXQorCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkZhYnJpY0RhdGFwYXRoVG9EQ05EYXRhUmV0
dXJuKSAvIDEwMDA7CisJCWxvY2Fscy0+UmV0dXJuQldUb0RDTlBlclN0YXRlID0gZG1sX21pbihs
b2NhbHMtPlJldHVybkJ1c1dpZHRoICogbG9jYWxzLT5EQ0ZDTEtQZXJTdGF0ZVtpXSwKKwkJCQls
b2NhbHMtPkZhYnJpY0FuZERSQU1CYW5kd2lkdGhQZXJTdGF0ZVtpXSAqIDEwMDApCisJCQkJKiBs
b2NhbHMtPlBlcmNlbnRPZklkZWFsRFJBTUZhYnJpY0FuZFNEUFBvcnRCV1JlY2VpdmVkQWZ0ZXJV
cmdMYXRlbmN5UGl4ZWxEYXRhT25seSAvIDEwMDsKKworCQlsb2NhbHMtPlJldHVybkJXUGVyU3Rh
dGVbaV0gPSBsb2NhbHMtPlJldHVybkJXVG9EQ05QZXJTdGF0ZTsKKworCQlpZiAobG9jYWxzLT5E
Q0NFbmFibGVkSW5BbnlQbGFuZSA9PSB0cnVlICYmIGxvY2Fscy0+UmV0dXJuQldUb0RDTlBlclN0
YXRlID4gbG9jYWxzLT5EQ0ZDTEtQZXJTdGF0ZVtpXSAqIGxvY2Fscy0+UmV0dXJuQnVzV2lkdGgg
LyA0KSB7CisJCQlsb2NhbHMtPlJldHVybkJXUGVyU3RhdGVbaV0gPSBkbWxfbWluKGxvY2Fscy0+
UmV0dXJuQldQZXJTdGF0ZVtpXSwKKwkJCQkJbG9jYWxzLT5SZXR1cm5CV1RvRENOUGVyU3RhdGUg
KiA0ICogKDEgLSBsb2NhbHMtPlVyZ2VudExhdGVuY3kgLworCQkJCQkoKGxvY2Fscy0+Uk9CQnVm
ZmVyU2l6ZUluS0J5dGUgLSBsb2NhbHMtPlBpeGVsQ2h1bmtTaXplSW5LQnl0ZSkgKiAxMDI0CisJ
CQkJCS8gKGxvY2Fscy0+UmV0dXJuQldUb0RDTlBlclN0YXRlIC0gbG9jYWxzLT5EQ0ZDTEtQZXJT
dGF0ZVtpXQorCQkJCQkqIGxvY2Fscy0+UmV0dXJuQnVzV2lkdGggLyA0KSArIGxvY2Fscy0+VXJn
ZW50TGF0ZW5jeSkpKTsKKwkJfQorCQlsb2NhbHMtPkNyaXRpY2FsUG9pbnQgPSAyICogbG9jYWxz
LT5SZXR1cm5CdXNXaWR0aCAqIGxvY2Fscy0+RENGQ0xLUGVyU3RhdGVbaV0gKgorCQkJCWxvY2Fs
cy0+VXJnZW50TGF0ZW5jeSAvIChsb2NhbHMtPlJldHVybkJXVG9EQ05QZXJTdGF0ZSAqIGxvY2Fs
cy0+VXJnZW50TGF0ZW5jeQorCQkJCSsgKGxvY2Fscy0+Uk9CQnVmZmVyU2l6ZUluS0J5dGUgLSBs
b2NhbHMtPlBpeGVsQ2h1bmtTaXplSW5LQnl0ZSkgKiAxMDI0KTsKKworCQlpZiAobG9jYWxzLT5E
Q0NFbmFibGVkSW5BbnlQbGFuZSAmJiBsb2NhbHMtPkNyaXRpY2FsUG9pbnQgPiAxICYmIGxvY2Fs
cy0+Q3JpdGljYWxQb2ludCA8IDQpIHsKKwkJCWxvY2Fscy0+UmV0dXJuQldQZXJTdGF0ZVtpXSA9
IGRtbF9taW4obG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldLAorCQkJCTQgKiBsb2NhbHMtPlJl
dHVybkJXVG9EQ05QZXJTdGF0ZSAqCisJCQkJKGxvY2Fscy0+Uk9CQnVmZmVyU2l6ZUluS0J5dGUg
LSBsb2NhbHMtPlBpeGVsQ2h1bmtTaXplSW5LQnl0ZSkgKiAxMDI0CisJCQkJKiBsb2NhbHMtPlJl
dHVybkJ1c1dpZHRoICogbG9jYWxzLT5EQ0ZDTEtQZXJTdGF0ZVtpXSAqIGxvY2Fscy0+VXJnZW50
TGF0ZW5jeSAvCisJCQkJZG1sX3BvdygobG9jYWxzLT5SZXR1cm5CV1RvRENOUGVyU3RhdGUgKiBs
b2NhbHMtPlVyZ2VudExhdGVuY3kKKwkJCQkrIChsb2NhbHMtPlJPQkJ1ZmZlclNpemVJbktCeXRl
IC0gbG9jYWxzLT5QaXhlbENodW5rU2l6ZUluS0J5dGUpICogMTAyNCksIDIpKTsKKwkJfQorCisJ
CWxvY2Fscy0+UmV0dXJuQldUb0RDTlBlclN0YXRlID0gZG1sX21pbihsb2NhbHMtPlJldHVybkJ1
c1dpZHRoICoKKwkJCQlsb2NhbHMtPkRDRkNMS1BlclN0YXRlW2ldLCBsb2NhbHMtPkZhYnJpY0Fu
ZERSQU1CYW5kd2lkdGhQZXJTdGF0ZVtpXSAqIDEwMDApOworCisJCWlmIChsb2NhbHMtPkRDQ0Vu
YWJsZWRJbkFueVBsYW5lID09IHRydWUgJiYgbG9jYWxzLT5SZXR1cm5CV1RvRENOUGVyU3RhdGUg
PiBsb2NhbHMtPkRDRkNMS1BlclN0YXRlW2ldICogbG9jYWxzLT5SZXR1cm5CdXNXaWR0aCAvIDQp
IHsKKwkJCWxvY2Fscy0+UmV0dXJuQldQZXJTdGF0ZVtpXSA9IGRtbF9taW4obG9jYWxzLT5SZXR1
cm5CV1BlclN0YXRlW2ldLAorCQkJCQlsb2NhbHMtPlJldHVybkJXVG9EQ05QZXJTdGF0ZSAqIDQg
KiAoMSAtIGxvY2Fscy0+VXJnZW50TGF0ZW5jeSAvCisJCQkJCSgobG9jYWxzLT5ST0JCdWZmZXJT
aXplSW5LQnl0ZSAtIGxvY2Fscy0+UGl4ZWxDaHVua1NpemVJbktCeXRlKSAqIDEwMjQKKwkJCQkJ
LyAobG9jYWxzLT5SZXR1cm5CV1RvRENOUGVyU3RhdGUgLSBsb2NhbHMtPkRDRkNMS1BlclN0YXRl
W2ldCisJCQkJCSogbG9jYWxzLT5SZXR1cm5CdXNXaWR0aCAvIDQpICsgbG9jYWxzLT5VcmdlbnRM
YXRlbmN5KSkpOworCQl9CisJCWxvY2Fscy0+Q3JpdGljYWxQb2ludCA9IDIgKiBsb2NhbHMtPlJl
dHVybkJ1c1dpZHRoICogbG9jYWxzLT5EQ0ZDTEtQZXJTdGF0ZVtpXSAqCisJCQkJbG9jYWxzLT5V
cmdlbnRMYXRlbmN5IC8gKGxvY2Fscy0+UmV0dXJuQldUb0RDTlBlclN0YXRlICogbG9jYWxzLT5V
cmdlbnRMYXRlbmN5CisJCQkJKyAobG9jYWxzLT5ST0JCdWZmZXJTaXplSW5LQnl0ZSAtIGxvY2Fs
cy0+UGl4ZWxDaHVua1NpemVJbktCeXRlKSAqIDEwMjQpOworCisJCWlmIChsb2NhbHMtPkRDQ0Vu
YWJsZWRJbkFueVBsYW5lICYmIGxvY2Fscy0+Q3JpdGljYWxQb2ludCA+IDEgJiYgbG9jYWxzLT5D
cml0aWNhbFBvaW50IDwgNCkgeworCQkJbG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldID0gZG1s
X21pbihsb2NhbHMtPlJldHVybkJXUGVyU3RhdGVbaV0sCisJCQkJNCAqIGxvY2Fscy0+UmV0dXJu
QldUb0RDTlBlclN0YXRlICoKKwkJCQkobG9jYWxzLT5ST0JCdWZmZXJTaXplSW5LQnl0ZSAtIGxv
Y2Fscy0+UGl4ZWxDaHVua1NpemVJbktCeXRlKSAqIDEwMjQKKwkJCQkqIGxvY2Fscy0+UmV0dXJu
QnVzV2lkdGggKiBsb2NhbHMtPkRDRkNMS1BlclN0YXRlW2ldICogbG9jYWxzLT5VcmdlbnRMYXRl
bmN5IC8KKwkJCQlkbWxfcG93KChsb2NhbHMtPlJldHVybkJXVG9EQ05QZXJTdGF0ZSAqIGxvY2Fs
cy0+VXJnZW50TGF0ZW5jeQorCQkJCSsgKGxvY2Fscy0+Uk9CQnVmZmVyU2l6ZUluS0J5dGUgLSBs
b2NhbHMtPlBpeGVsQ2h1bmtTaXplSW5LQnl0ZSkgKiAxMDI0KSwgMikpOworCQl9CisJfQorCS8q
V3JpdGViYWNrIExhdGVuY3kgc3VwcG9ydCBjaGVjayovCisKKwltb2RlX2xpYi0+dmJhLldyaXRl
YmFja0xhdGVuY3lTdXBwb3J0ID0gdHJ1ZTsKKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52
YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVfbGliLT52YmEu
V3JpdGViYWNrRW5hYmxlW2tdID09IHRydWUpIHsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLldyaXRl
YmFja1BpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF8zMikgeworCQkJCWlmIChsb2NhbHMtPldyaXRl
QmFuZHdpZHRoW2tdCisJCQkJCQk+IChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0ludGVyZmFjZUx1
bWFCdWZmZXJTaXplCisJCQkJCQkJCSsgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tJbnRlcmZhY2VD
aHJvbWFCdWZmZXJTaXplKQorCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuV3JpdGViYWNrTGF0ZW5j
eSkgeworCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0xhdGVuY3lTdXBwb3J0ID0gZmFsc2U7
CisJCQkJfQorCQkJfSBlbHNlIHsKKwkJCQlpZiAobG9jYWxzLT5Xcml0ZUJhbmR3aWR0aFtrXQor
CQkJCQkJPiAxLjUKKwkJCQkJCQkJKiBkbWxfbWluKAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEu
V3JpdGViYWNrSW50ZXJmYWNlTHVtYUJ1ZmZlclNpemUsCisJCQkJCQkJCQkJMi4wCisJCQkJCQkJ
CQkJCQkqIG1vZGVfbGliLT52YmEuV3JpdGViYWNrSW50ZXJmYWNlQ2hyb21hQnVmZmVyU2l6ZSkK
KwkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0xhdGVuY3kpIHsKKwkJCQkJbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tMYXRlbmN5U3VwcG9ydCA9IGZhbHNlOworCQkJCX0KKwkJCX0KKwkJ
fQorCX0KKwkvKlJlLW9yZGVyaW5nIEJ1ZmZlciBTdXBwb3J0IENoZWNrKi8KKworCWZvciAoaSA9
IDA7IGkgPD0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJCWxvY2Fscy0+
VXJnZW50Um91bmRUcmlwQW5kT3V0T2ZPcmRlckxhdGVuY3lQZXJTdGF0ZVtpXSA9CisJCQkJKG1v
ZGVfbGliLT52YmEuUm91bmRUcmlwUGluZ0xhdGVuY3lDeWNsZXMgKyAzMi4wKSAvIG1vZGVfbGli
LT52YmEuRENGQ0xLUGVyU3RhdGVbaV0KKwkJCQkrIGxvY2Fscy0+VXJnZW50T3V0T2ZPcmRlclJl
dHVyblBlckNoYW5uZWwgKiBtb2RlX2xpYi0+dmJhLk51bWJlck9mQ2hhbm5lbHMgLyBsb2NhbHMt
PlJldHVybkJXUGVyU3RhdGVbaV07CisJCWlmICgobW9kZV9saWItPnZiYS5ST0JCdWZmZXJTaXpl
SW5LQnl0ZSAtIG1vZGVfbGliLT52YmEuUGl4ZWxDaHVua1NpemVJbktCeXRlKSAqIDEwMjQuMCAv
IGxvY2Fscy0+UmV0dXJuQldQZXJTdGF0ZVtpXQorCQkJCT4gbG9jYWxzLT5VcmdlbnRSb3VuZFRy
aXBBbmRPdXRPZk9yZGVyTGF0ZW5jeVBlclN0YXRlW2ldKSB7CisJCQlsb2NhbHMtPlJPQlN1cHBv
cnRbaV0gPSB0cnVlOworCQl9IGVsc2UgeworCQkJbG9jYWxzLT5ST0JTdXBwb3J0W2ldID0gZmFs
c2U7CisJCX0KKwl9CisJLypXcml0ZWJhY2sgTW9kZSBTdXBwb3J0IENoZWNrKi8KKworCW1vZGVf
bGliLT52YmEuVG90YWxOdW1iZXJPZkFjdGl2ZVdyaXRlYmFjayA9IDA7CisJZm9yIChrID0gMDsg
ayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlm
IChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9PSB0cnVlKSB7CisJCQlpZiAobW9k
ZV9saWItPnZiYS5BY3RpdmVXcml0ZWJhY2tzUGVyUGxhbmVba10gPT0gMCkKKwkJCQltb2RlX2xp
Yi0+dmJhLkFjdGl2ZVdyaXRlYmFja3NQZXJQbGFuZVtrXSA9IDE7CisJCQltb2RlX2xpYi0+dmJh
LlRvdGFsTnVtYmVyT2ZBY3RpdmVXcml0ZWJhY2sgPQorCQkJCQltb2RlX2xpYi0+dmJhLlRvdGFs
TnVtYmVyT2ZBY3RpdmVXcml0ZWJhY2sKKwkJCQkJCQkrIG1vZGVfbGliLT52YmEuQWN0aXZlV3Jp
dGViYWNrc1BlclBsYW5lW2tdOworCQl9CisJfQorCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTW9k
ZVN1cHBvcnQgPSB0cnVlOworCWlmIChtb2RlX2xpYi0+dmJhLlRvdGFsTnVtYmVyT2ZBY3RpdmVX
cml0ZWJhY2sgPiBtb2RlX2xpYi0+dmJhLk1heE51bVdyaXRlYmFjaykgeworCQltb2RlX2xpYi0+
dmJhLldyaXRlYmFja01vZGVTdXBwb3J0ID0gZmFsc2U7CisJfQorCWZvciAoayA9IDA7IGsgPD0g
bW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlpZiAobW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tFbmFibGVba10gPT0gdHJ1ZQorCQkJCSYmIG1vZGVfbGliLT52
YmEuV3JpdGViYWNrMTBicGM0MjBTdXBwb3J0ZWQgIT0gdHJ1ZQorCQkJCSYmIG1vZGVfbGliLT52
YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRba10gPT0gZG1fNDIwXzEwKSB7CisJCQltb2RlX2xpYi0+
dmJhLldyaXRlYmFja01vZGVTdXBwb3J0ID0gZmFsc2U7CisJCX0KKwl9CisJLypXcml0ZWJhY2sg
U2NhbGUgUmF0aW8gYW5kIFRhcHMgU3VwcG9ydCBDaGVjayovCisKKwltb2RlX2xpYi0+dmJhLldy
aXRlYmFja1NjYWxlUmF0aW9BbmRUYXBzU3VwcG9ydCA9IHRydWU7CisJZm9yIChrID0gMDsgayA8
PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmICht
b2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9PSB0cnVlKSB7CisJCQlpZiAobW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tMdW1hQW5kQ2hyb21hU2NhbGluZ1N1cHBvcnRlZCA9PSBmYWxzZQor
CQkJCQkmJiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10gIT0gMS4wCisJCQkJCQkJ
fHwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWUmF0aW9ba10gIT0gMS4wKSkgeworCQkJCW1vZGVf
bGliLT52YmEuV3JpdGViYWNrU2NhbGVSYXRpb0FuZFRhcHNTdXBwb3J0ID0gZmFsc2U7CisJCQl9
CisJCQlpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10gPiBtb2RlX2xpYi0+dmJh
LldyaXRlYmFja01heEhTQ0xSYXRpbworCQkJCQl8fCBtb2RlX2xpYi0+dmJhLldyaXRlYmFja1ZS
YXRpb1trXQorCQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tNYXhWU0NMUmF0aW8KKwkJ
CQkJfHwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10KKwkJCQkJCQk8IG1vZGVfbGli
LT52YmEuV3JpdGViYWNrTWluSFNDTFJhdGlvCisJCQkJCXx8IG1vZGVfbGliLT52YmEuV3JpdGVi
YWNrVlJhdGlvW2tdCisJCQkJCQkJPCBtb2RlX2xpYi0+dmJhLldyaXRlYmFja01pblZTQ0xSYXRp
bworCQkJCQl8fCBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFIVGFwc1trXQorCQkJCQkJCT4g
bW9kZV9saWItPnZiYS5Xcml0ZWJhY2tNYXhIU0NMVGFwcworCQkJCQl8fCBtb2RlX2xpYi0+dmJh
LldyaXRlYmFja0x1bWFWVGFwc1trXQorCQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tN
YXhWU0NMVGFwcworCQkJCQl8fCBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0hSYXRpb1trXQorCQkJ
CQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRhcHNba10KKwkJCQkJfHwgbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tWUmF0aW9ba10KKwkJCQkJCQk+IG1vZGVfbGliLT52YmEuV3JpdGVi
YWNrTHVtYVZUYXBzW2tdCisJCQkJCXx8IChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFIVGFw
c1trXSA+IDIuMAorCQkJCQkJCSYmICgobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRhcHNb
a10gJSAyKQorCQkJCQkJCQkJPT0gMSkpCisJCQkJCXx8IChtb2RlX2xpYi0+dmJhLldyaXRlYmFj
a1BpeGVsRm9ybWF0W2tdICE9IGRtXzQ0NF8zMgorCQkJCQkJCSYmIChtb2RlX2xpYi0+dmJhLldy
aXRlYmFja0Nocm9tYUhUYXBzW2tdCisJCQkJCQkJCQk+IG1vZGVfbGliLT52YmEuV3JpdGViYWNr
TWF4SFNDTFRhcHMKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hVlRh
cHNba10KKwkJCQkJCQkJCQkJPiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja01heFZTQ0xUYXBzCisJ
CQkJCQkJCQl8fCAyLjAKKwkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0hSYXRp
b1trXQorCQkJCQkJCQkJCQk+IG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hSFRhcHNba10K
KwkJCQkJCQkJCXx8IDIuMAorCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuV3JpdGViYWNrVlJh
dGlvW2tdCisJCQkJCQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFWVGFwc1tr
XQorCQkJCQkJCQkJfHwgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hSFRhcHNba10gPiAy
LjAKKwkJCQkJCQkJCQkmJiAoKG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hSFRhcHNba10g
JSAyKSA9PSAxKSkpKSkgeworCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrU2NhbGVSYXRpb0Fu
ZFRhcHNTdXBwb3J0ID0gZmFsc2U7CisJCQl9CisJCQlpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJh
Y2tWUmF0aW9ba10gPCAxLjApIHsKKwkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFWRXh0
cmEgPQorCQkJCQkJZG1sX21heCgxLjAgLSAyLjAgLyBkbWxfY2VpbCgxLjAgLyBtb2RlX2xpYi0+
dmJhLldyaXRlYmFja1ZSYXRpb1trXSwgMS4wKSwgMC4wKTsKKwkJCX0gZWxzZSB7CisJCQkJbW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVkV4dHJhID0gLTE7CisJCQl9CisJCQlpZiAoKG1vZGVf
bGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzMyCisJCQkJCSYmIG1v
ZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYVZUYXBzW2tdCisJCQkJCQkJPiAobW9kZV9saWItPnZi
YS5Xcml0ZWJhY2tMaW5lQnVmZmVyTHVtYUJ1ZmZlclNpemUKKwkJCQkJCQkJCSsgbW9kZV9saWIt
PnZiYS5Xcml0ZWJhY2tMaW5lQnVmZmVyQ2hyb21hQnVmZmVyU2l6ZSkKKwkJCQkJCQkJCS8gMy4w
CisJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFtrXQor
CQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFWRXh0cmEpCisJCQkJCXx8ICht
b2RlX2xpYi0+dmJhLldyaXRlYmFja1BpeGVsRm9ybWF0W2tdID09IGRtXzQyMF84CisJCQkJCQkJ
JiYgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVlRhcHNba10KKwkJCQkJCQkJCT4gbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tMaW5lQnVmZmVyTHVtYUJ1ZmZlclNpemUKKwkJCQkJCQkJCQkJKiA4
LjAgLyAxMC4wIC8gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoW2tdCisJ
CQkJCQkJCQkJCS0gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVkV4dHJhKQorCQkJCQl8fCAo
bW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfMTAKKwkJCQkJ
CQkmJiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFWVGFwc1trXQorCQkJCQkJCQkJPiBtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0xpbmVCdWZmZXJMdW1hQnVmZmVyU2l6ZQorCQkJCQkJCQkJCQkq
IDguMCAvIDEwLjAKKwkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0
aW9uV2lkdGhba10KKwkJCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFWRXh0
cmEpKSB7CisJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tTY2FsZVJhdGlvQW5kVGFwc1N1cHBv
cnQgPSBmYWxzZTsKKwkJCX0KKwkJCWlmICgyLjAgKiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja1ZS
YXRpb1trXSA8IDEpIHsKKwkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYVZFeHRyYSA9
IDAuMDsKKwkJCX0gZWxzZSB7CisJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFWRXh0
cmEgPSAtMTsKKwkJCX0KKwkJCWlmICgobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1h
dFtrXSA9PSBkbV80MjBfOAorCQkJCQkmJiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYVZU
YXBzW2tdCisJCQkJCQkJPiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0xpbmVCdWZmZXJDaHJvbWFC
dWZmZXJTaXplCisJCQkJCQkJCQkqIDguMCAvIDEwLjAgLyBtb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJCQkJCS0gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tD
aHJvbWFWRXh0cmEpCisJCQkJCXx8IChtb2RlX2xpYi0+dmJhLldyaXRlYmFja1BpeGVsRm9ybWF0
W2tdID09IGRtXzQyMF8xMAorCQkJCQkJCSYmIG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21h
VlRhcHNba10KKwkJCQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMaW5lQnVmZmVyQ2hy
b21hQnVmZmVyU2l6ZQorCQkJCQkJCQkJCQkqIDguMCAvIDEwLjAKKwkJCQkJCQkJCQkJLyBtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJCQkJCQkJLSBtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYVZFeHRyYSkpIHsKKwkJCQltb2RlX2xpYi0+dmJhLldy
aXRlYmFja1NjYWxlUmF0aW9BbmRUYXBzU3VwcG9ydCA9IGZhbHNlOworCQkJfQorCQl9CisJfQor
CS8qTWF4aW11bSBESVNQQ0xLL0RQUENMSyBTdXBwb3J0IGNoZWNrKi8KKworCW1vZGVfbGliLT52
YmEuV3JpdGViYWNrUmVxdWlyZWRESVNQQ0xLID0gMC4wOworCWZvciAoayA9IDA7IGsgPD0gbW9k
ZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlpZiAobW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tFbmFibGVba10gPT0gdHJ1ZSkgeworCQkJbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tSZXF1aXJlZERJU1BDTEsgPQorCQkJCQlkbWxfbWF4KAorCQkJCQkJCW1vZGVfbGli
LT52YmEuV3JpdGViYWNrUmVxdWlyZWRESVNQQ0xLLAorCQkJCQkJCUNhbGN1bGF0ZVdyaXRlQmFj
a0RJU1BDTEsoCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja1BpeGVsRm9ybWF0W2td
LAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdLAorCQkJCQkJCQkJbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRl
YmFja1ZSYXRpb1trXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYUhUYXBz
W2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVlRhcHNba10sCisJCQkJ
CQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYUhUYXBzW2tdLAorCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFWVGFwc1trXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52
YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEu
SFRvdGFsW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFMaW5lQnVm
ZmVyV2lkdGgpKTsKKwkJfQorCX0KKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVt
YmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuSFJhdGlv
W2tdID4gMS4wKSB7CisJCQlsb2NhbHMtPlBTQ0xfRkFDVE9SW2tdID0gZG1sX21pbigKKwkJCQkJ
bW9kZV9saWItPnZiYS5NYXhEQ0hVQlRvUFNDTFRocm91Z2hwdXQsCisJCQkJCW1vZGVfbGliLT52
YmEuTWF4UFNDTFRvTEJUaHJvdWdocHV0CisJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhSYXRpb1tr
XQorCQkJCQkJCS8gZG1sX2NlaWwoCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLmh0YXBzW2tdCisJ
CQkJCQkJCQkJCS8gNi4wLAorCQkJCQkJCQkJMS4wKSk7CisJCX0gZWxzZSB7CisJCQlsb2NhbHMt
PlBTQ0xfRkFDVE9SW2tdID0gZG1sX21pbigKKwkJCQkJbW9kZV9saWItPnZiYS5NYXhEQ0hVQlRv
UFNDTFRocm91Z2hwdXQsCisJCQkJCW1vZGVfbGliLT52YmEuTWF4UFNDTFRvTEJUaHJvdWdocHV0
KTsKKwkJfQorCQlpZiAobG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVENba10gPT0gMC4wKSB7CisJ
CQlsb2NhbHMtPlBTQ0xfRkFDVE9SX0NIUk9NQVtrXSA9IDAuMDsKKwkJCWxvY2Fscy0+TWluRFBQ
Q0xLVXNpbmdTaW5nbGVEUFBba10gPQorCQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10K
KwkJCQkJCQkqIGRtbF9tYXgzKAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS52dGFwc1trXSAvIDYu
MAorCQkJCQkJCQkJCQkqIGRtbF9taW4oCisJCQkJCQkJCQkJCQkJMS4wLAorCQkJCQkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuSFJhdGlvW2tdKSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuSFJhdGlv
W2tdCisJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5WUmF0aW9ba10KKwkJCQkJCQkJCQkJLyBs
b2NhbHMtPlBTQ0xfRkFDVE9SW2tdLAorCQkJCQkJCQkJMS4wKTsKKwkJCWlmICgobW9kZV9saWIt
PnZiYS5odGFwc1trXSA+IDYuMCB8fCBtb2RlX2xpYi0+dmJhLnZ0YXBzW2tdID4gNi4wKQorCQkJ
CQkmJiBsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdCisJCQkJCQkJPCAyLjAgKiBt
b2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pIHsKKwkJCQlsb2NhbHMtPk1pbkRQUENMS1VzaW5n
U2luZ2xlRFBQW2tdID0gMi4wCisJCQkJCQkqIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXTsK
KwkJCX0KKwkJfSBlbHNlIHsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLkhSYXRpb1trXSAvIDIuMCA+
IDEuMCkgeworCQkJCWxvY2Fscy0+UFNDTF9GQUNUT1JfQ0hST01BW2tdID0KKwkJCQkJCWRtbF9t
aW4oCisJCQkJCQkJCW1vZGVfbGliLT52YmEuTWF4RENIVUJUb1BTQ0xUaHJvdWdocHV0LAorCQkJ
CQkJCQltb2RlX2xpYi0+dmJhLk1heFBTQ0xUb0xCVGhyb3VnaHB1dAorCQkJCQkJCQkJCSogbW9k
ZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJCQkvIDIuMAorCQkJCQkJCQkJCS8gZG1sX2Nl
aWwoCisJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhUQVBzQ2hyb21hW2tdCisJCQkJCQkJCQkJ
CQkJCS8gNi4wLAorCQkJCQkJCQkJCQkJMS4wKSk7CisJCQl9IGVsc2UgeworCQkJCWxvY2Fscy0+
UFNDTF9GQUNUT1JfQ0hST01BW2tdID0gZG1sX21pbigKKwkJCQkJCW1vZGVfbGliLT52YmEuTWF4
RENIVUJUb1BTQ0xUaHJvdWdocHV0LAorCQkJCQkJbW9kZV9saWItPnZiYS5NYXhQU0NMVG9MQlRo
cm91Z2hwdXQpOworCQkJfQorCQkJbG9jYWxzLT5NaW5EUFBDTEtVc2luZ1NpbmdsZURQUFtrXSA9
CisJCQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXQorCQkJCQkJCSogZG1sX21heDUoCisJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLnZ0YXBzW2tdIC8gNi4wCisJCQkJCQkJCQkJCSogZG1sX21p
bigKKwkJCQkJCQkJCQkJCQkxLjAsCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IUmF0aW9b
a10pLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJCQkJKiBtb2Rl
X2xpYi0+dmJhLlZSYXRpb1trXQorCQkJCQkJCQkJCQkvIGxvY2Fscy0+UFNDTF9GQUNUT1Jba10s
CisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlZUQVBzQ2hyb21hW2tdCisJCQkJCQkJCQkJCS8gNi4w
CisJCQkJCQkJCQkJCSogZG1sX21pbigKKwkJCQkJCQkJCQkJCQkxLjAsCisJCQkJCQkJCQkJCQkJ
bW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJCQkJCQkJCS8gMi4wKSwKKwkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuSFJhdGlvW2tdCisJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5WUmF0
aW9ba10KKwkJCQkJCQkJCQkJLyA0LjAKKwkJCQkJCQkJCQkJLyBsb2NhbHMtPlBTQ0xfRkFDVE9S
X0NIUk9NQVtrXSwKKwkJCQkJCQkJCTEuMCk7CisJCQlpZiAoKG1vZGVfbGliLT52YmEuaHRhcHNb
a10gPiA2LjAgfHwgbW9kZV9saWItPnZiYS52dGFwc1trXSA+IDYuMAorCQkJCQl8fCBtb2RlX2xp
Yi0+dmJhLkhUQVBzQ2hyb21hW2tdID4gNi4wCisJCQkJCXx8IG1vZGVfbGliLT52YmEuVlRBUHND
aHJvbWFba10gPiA2LjApCisJCQkJCSYmIGxvY2Fscy0+TWluRFBQQ0xLVXNpbmdTaW5nbGVEUFBb
a10KKwkJCQkJCQk8IDIuMCAqIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkgeworCQkJCWxv
Y2Fscy0+TWluRFBQQ0xLVXNpbmdTaW5nbGVEUFBba10gPSAyLjAKKwkJCQkJCSogbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdOworCQkJfQorCQl9CisJfQorCWZvciAoayA9IDA7IGsgPD0gbW9k
ZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlDYWxjdWxhdGUy
NTZCQmxvY2tTaXplcygKKwkJCQltb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdLAor
CQkJCW1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSwKKwkJCQlkbWxfY2VpbChsb2NhbHMt
PkJ5dGVQZXJQaXhlbEluREVUWVtrXSwgMS4wKSwKKwkJCQlkbWxfY2VpbChsb2NhbHMtPkJ5dGVQ
ZXJQaXhlbEluREVUQ1trXSwgMi4wKSwKKwkJCQkmbG9jYWxzLT5SZWFkMjU2QmxvY2tIZWlnaHRZ
W2tdLAorCQkJCSZsb2NhbHMtPlJlYWQyNTZCbG9ja0hlaWdodENba10sCisJCQkJJmxvY2Fscy0+
UmVhZDI1NkJsb2NrV2lkdGhZW2tdLAorCQkJCSZsb2NhbHMtPlJlYWQyNTZCbG9ja1dpZHRoQ1tr
XSk7CisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikgeworCQkJ
bG9jYWxzLT5NYXhTd2F0aEhlaWdodFlba10gPSBsb2NhbHMtPlJlYWQyNTZCbG9ja0hlaWdodFlb
a107CisJCQlsb2NhbHMtPk1heFN3YXRoSGVpZ2h0Q1trXSA9IGxvY2Fscy0+UmVhZDI1NkJsb2Nr
SGVpZ2h0Q1trXTsKKwkJfSBlbHNlIHsKKwkJCWxvY2Fscy0+TWF4U3dhdGhIZWlnaHRZW2tdID0g
bG9jYWxzLT5SZWFkMjU2QmxvY2tXaWR0aFlba107CisJCQlsb2NhbHMtPk1heFN3YXRoSGVpZ2h0
Q1trXSA9IGxvY2Fscy0+UmVhZDI1NkJsb2NrV2lkdGhDW2tdOworCQl9CisJCWlmICgobW9kZV9s
aWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80NDRfNjQKKwkJCQl8fCBtb2RlX2xp
Yi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF8zMgorCQkJCXx8IG1vZGVfbGli
LT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzE2CisJCQkJfHwgbW9kZV9saWIt
PnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV9tb25vXzE2CisJCQkJfHwgbW9kZV9saWIt
PnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV9tb25vXzgpKSB7CisJCQlpZiAobW9kZV9s
aWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdID09IGRtX3N3X2xpbmVhcgorCQkJCQl8fCAobW9kZV9s
aWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80NDRfNjQKKwkJCQkJCQkmJiAobW9k
ZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQk9PSBkbV9zd180a2JfcworCQkJ
CQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJCT09IGRt
X3N3XzRrYl9zX3gKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXQor
CQkJCQkJCQkJCQk9PSBkbV9zd182NGtiX3MKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3Vy
ZmFjZVRpbGluZ1trXQorCQkJCQkJCQkJCQk9PSBkbV9zd182NGtiX3NfdAorCQkJCQkJCQkJfHwg
bW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJCT09IGRtX3N3XzY0a2Jf
c194CisJCQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10KKwkJCQkJCQkJ
CQkJPT0gZG1fc3dfdmFyX3MKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGlu
Z1trXQorCQkJCQkJCQkJCQk9PSBkbV9zd192YXJfc194KQorCQkJCQkJCSYmIG1vZGVfbGliLT52
YmEuU291cmNlU2NhbltrXSA9PSBkbV9ob3J6KSkgeworCQkJCWxvY2Fscy0+TWluU3dhdGhIZWln
aHRZW2tdID0gbG9jYWxzLT5NYXhTd2F0aEhlaWdodFlba107CisJCQl9IGVsc2UgeworCQkJCWxv
Y2Fscy0+TWluU3dhdGhIZWlnaHRZW2tdID0gbG9jYWxzLT5NYXhTd2F0aEhlaWdodFlba10KKwkJ
CQkJCS8gMi4wOworCQkJfQorCQkJbG9jYWxzLT5NaW5Td2F0aEhlaWdodENba10gPSBsb2NhbHMt
Pk1heFN3YXRoSGVpZ2h0Q1trXTsKKwkJfSBlbHNlIHsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLlN1
cmZhY2VUaWxpbmdba10gPT0gZG1fc3dfbGluZWFyKSB7CisJCQkJbG9jYWxzLT5NaW5Td2F0aEhl
aWdodFlba10gPSBsb2NhbHMtPk1heFN3YXRoSGVpZ2h0WVtrXTsKKwkJCQlsb2NhbHMtPk1pblN3
YXRoSGVpZ2h0Q1trXSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRDW2tdOworCQkJfSBlbHNlIGlm
IChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQyMF84CisJCQkJCSYm
IG1vZGVfbGliLT52YmEuU291cmNlU2NhbltrXSA9PSBkbV9ob3J6KSB7CisJCQkJbG9jYWxzLT5N
aW5Td2F0aEhlaWdodFlba10gPSBsb2NhbHMtPk1heFN3YXRoSGVpZ2h0WVtrXQorCQkJCQkJLyAy
LjA7CisJCQkJbG9jYWxzLT5NaW5Td2F0aEhlaWdodENba10gPSBsb2NhbHMtPk1heFN3YXRoSGVp
Z2h0Q1trXTsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtr
XSA9PSBkbV80MjBfMTAKKwkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdID09IGRt
X2hvcnopIHsKKwkJCQlsb2NhbHMtPk1pblN3YXRoSGVpZ2h0Q1trXSA9IGxvY2Fscy0+TWF4U3dh
dGhIZWlnaHRDW2tdCisJCQkJCQkvIDIuMDsKKwkJCQlsb2NhbHMtPk1pblN3YXRoSGVpZ2h0WVtr
XSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRZW2tdOworCQkJfSBlbHNlIHsKKwkJCQlsb2NhbHMt
Pk1pblN3YXRoSGVpZ2h0WVtrXSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRZW2tdOworCQkJCWxv
Y2Fscy0+TWluU3dhdGhIZWlnaHRDW2tdID0gbG9jYWxzLT5NYXhTd2F0aEhlaWdodENba107CisJ
CQl9CisJCX0KKwkJaWYgKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSA9PSBkbV9zd19s
aW5lYXIpIHsKKwkJCW1vZGVfbGliLT52YmEuTWF4aW11bVN3YXRoV2lkdGhTdXBwb3J0ID0gODE5
Mi4wOworCQl9IGVsc2UgeworCQkJbW9kZV9saWItPnZiYS5NYXhpbXVtU3dhdGhXaWR0aFN1cHBv
cnQgPSA1MTIwLjA7CisJCX0KKwkJbW9kZV9saWItPnZiYS5NYXhpbXVtU3dhdGhXaWR0aEluREVU
QnVmZmVyID0KKwkJCQlkbWxfbWluKAorCQkJCQkJbW9kZV9saWItPnZiYS5NYXhpbXVtU3dhdGhX
aWR0aFN1cHBvcnQsCisJCQkJCQltb2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVJbktCeXRlICog
MTAyNC4wIC8gMi4wCisJCQkJCQkJCS8gKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdCisJ
CQkJCQkJCQkJKiBsb2NhbHMtPk1pblN3YXRoSGVpZ2h0WVtrXQorCQkJCQkJCQkJCSsgbG9jYWxz
LT5CeXRlUGVyUGl4ZWxJbkRFVENba10KKwkJCQkJCQkJCQkJCS8gMi4wCisJCQkJCQkJCQkJCQkq
IGxvY2Fscy0+TWluU3dhdGhIZWlnaHRDW2tdKSk7CisJCWlmIChsb2NhbHMtPkJ5dGVQZXJQaXhl
bEluREVUQ1trXSA9PSAwLjApIHsKKwkJCW1vZGVfbGliLT52YmEuTWF4aW11bVN3YXRoV2lkdGhJ
bkxpbmVCdWZmZXIgPQorCQkJCQltb2RlX2xpYi0+dmJhLkxpbmVCdWZmZXJTaXplCisJCQkJCQkJ
KiBkbWxfbWF4KG1vZGVfbGliLT52YmEuSFJhdGlvW2tdLCAxLjApCisJCQkJCQkJLyBtb2RlX2xp
Yi0+dmJhLkxCQml0UGVyUGl4ZWxba10KKwkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLnZ0YXBzW2td
CisJCQkJCQkJCQkrIGRtbF9tYXgoCisJCQkJCQkJCQkJCWRtbF9jZWlsKAorCQkJCQkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCQkJCQkJCQkJCTEuMCkKKwkJCQkJCQkJCQkJ
CQktIDIsCisJCQkJCQkJCQkJCTAuMCkpOworCQl9IGVsc2UgeworCQkJbW9kZV9saWItPnZiYS5N
YXhpbXVtU3dhdGhXaWR0aEluTGluZUJ1ZmZlciA9CisJCQkJCWRtbF9taW4oCisJCQkJCQkJbW9k
ZV9saWItPnZiYS5MaW5lQnVmZmVyU2l6ZQorCQkJCQkJCQkJKiBkbWxfbWF4KAorCQkJCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLkhSYXRpb1trXSwKKwkJCQkJCQkJCQkJMS4wKQorCQkJCQkJCQkJLyBt
b2RlX2xpYi0+dmJhLkxCQml0UGVyUGl4ZWxba10KKwkJCQkJCQkJCS8gKG1vZGVfbGliLT52YmEu
dnRhcHNba10KKwkJCQkJCQkJCQkJKyBkbWxfbWF4KAorCQkJCQkJCQkJCQkJCWRtbF9jZWlsKAor
CQkJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10sCisJCQkJCQkJCQkJCQkJCQkx
LjApCisJCQkJCQkJCQkJCQkJCQktIDIsCisJCQkJCQkJCQkJCQkJMC4wKSksCisJCQkJCQkJMi4w
ICogbW9kZV9saWItPnZiYS5MaW5lQnVmZmVyU2l6ZQorCQkJCQkJCQkJKiBkbWxfbWF4KAorCQkJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLkhSYXRpb1trXQorCQkJCQkJCQkJCQkJCS8gMi4wLAorCQkJ
CQkJCQkJCQkxLjApCisJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuTEJCaXRQZXJQaXhlbFtrXQor
CQkJCQkJCQkJLyAobW9kZV9saWItPnZiYS5WVEFQc0Nocm9tYVtrXQorCQkJCQkJCQkJCQkrIGRt
bF9tYXgoCisJCQkJCQkJCQkJCQkJZG1sX2NlaWwoCisJCQkJCQkJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLlZSYXRpb1trXQorCQkJCQkJCQkJCQkJCQkJCQkvIDIuMCwKKwkJCQkJCQkJCQkJCQkJCTEu
MCkKKwkJCQkJCQkJCQkJCQkJCS0gMiwKKwkJCQkJCQkJCQkJCQkwLjApKSk7CisJCX0KKwkJbG9j
YWxzLT5NYXhpbXVtU3dhdGhXaWR0aFtrXSA9IGRtbF9taW4oCisJCQkJbW9kZV9saWItPnZiYS5N
YXhpbXVtU3dhdGhXaWR0aEluREVUQnVmZmVyLAorCQkJCW1vZGVfbGliLT52YmEuTWF4aW11bVN3
YXRoV2lkdGhJbkxpbmVCdWZmZXIpOworCX0KKwlmb3IgKGkgPSAwOyBpIDw9IG1vZGVfbGliLT52
YmEuc29jLm51bV9zdGF0ZXM7IGkrKykgeworCQlmb3IgKGogPSAwOyBqIDwgMjsgaisrKSB7CisJ
CQltb2RlX2xpYi0+dmJhLk1heERpc3BjbGtSb3VuZGVkRG93blRvREZTR3JhbnVsYXJpdHkgPSBS
b3VuZFRvREZTR3JhbnVsYXJpdHlEb3duKAorCQkJCW1vZGVfbGliLT52YmEuTWF4RGlzcGNsa1tp
XSwKKwkJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtWQ09TcGVlZCk7CisJCQltb2RlX2xp
Yi0+dmJhLk1heERwcGNsa1JvdW5kZWREb3duVG9ERlNHcmFudWxhcml0eSA9IFJvdW5kVG9ERlNH
cmFudWxhcml0eURvd24oCisJCQkJbW9kZV9saWItPnZiYS5NYXhEcHBjbGtbaV0sCisJCQkJbW9k
ZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLVkNPU3BlZWQpOworCQkJbG9jYWxzLT5SZXF1aXJlZERJ
U1BDTEtbaV1bal0gPSAwLjA7CisJCQlsb2NhbHMtPkRJU1BDTEtfRFBQQ0xLX1N1cHBvcnRbaV1b
al0gPSB0cnVlOworCQkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0
aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJbW9kZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElT
UENMS1dpdGhvdXRPRE1Db21iaW5lID0KKwkJCQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1tr
XSAqICgxLjAgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0NDTEtEb3duU3ByZWFkaW5n
IC8gMTAwLjApCisJCQkJCQkJCSogKDEuMCArIG1vZGVfbGliLT52YmEuRElTUENMS1JhbXBpbmdN
YXJnaW4gLyAxMDAuMCk7CisJCQkJaWYgKG1vZGVfbGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BD
TEtXaXRob3V0T0RNQ29tYmluZSA+PSBtb2RlX2xpYi0+dmJhLk1heERpc3BjbGtbaV0KKwkJCQkJ
CSYmIGkgPT0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlcykKKwkJCQkJbW9kZV9saWItPnZi
YS5QbGFuZVJlcXVpcmVkRElTUENMS1dpdGhvdXRPRE1Db21iaW5lID0gbW9kZV9saWItPnZiYS5Q
aXhlbENsb2NrW2tdCisJCQkJCQkJKiAoMSArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RT
Q0NMS0Rvd25TcHJlYWRpbmcgLyAxMDAuMCk7CisKKwkJCQltb2RlX2xpYi0+dmJhLlBsYW5lUmVx
dWlyZWRESVNQQ0xLV2l0aE9ETUNvbWJpbmUgPSBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10g
LyAyCisJCQkJCSogKDEgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0NDTEtEb3duU3By
ZWFkaW5nIC8gMTAwLjApICogKDEgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtSYW1waW5nTWFyZ2lu
IC8gMTAwLjApOworCQkJCWlmIChtb2RlX2xpYi0+dmJhLlBsYW5lUmVxdWlyZWRESVNQQ0xLV2l0
aE9ETUNvbWJpbmUgPj0gbW9kZV9saWItPnZiYS5NYXhEaXNwY2xrW2ldCisJCQkJCQkmJiBpID09
IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXMpCisJCQkJCW1vZGVfbGliLT52YmEuUGxhbmVS
ZXF1aXJlZERJU1BDTEtXaXRoT0RNQ29tYmluZSA9IG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1tr
XSAvIDIKKwkJCQkJCQkqICgxICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93
blNwcmVhZGluZyAvIDEwMC4wKTsKKwkJCQlpZiAobW9kZV9saWItPnZiYS5PRE1DYXBhYmlsaXR5
ID09IGZhbHNlIHx8IG1vZGVfbGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BDTEtXaXRob3V0T0RN
Q29tYmluZSA8PSBtb2RlX2xpYi0+dmJhLk1heERpc3BjbGtSb3VuZGVkRG93blRvREZTR3JhbnVs
YXJpdHkpIHsKKwkJCQkJbG9jYWxzLT5PRE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbaV1ba10gPSBm
YWxzZTsKKwkJCQkJbW9kZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElTUENMSyA9IG1vZGVfbGli
LT52YmEuUGxhbmVSZXF1aXJlZERJU1BDTEtXaXRob3V0T0RNQ29tYmluZTsKKwkJCQl9IGVsc2Ug
eworCQkJCQlsb2NhbHMtPk9ETUNvbWJpbmVFbmFibGVQZXJTdGF0ZVtpXVtrXSA9IHRydWU7CisJ
CQkJCW1vZGVfbGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BDTEsgPSBtb2RlX2xpYi0+dmJhLlBs
YW5lUmVxdWlyZWRESVNQQ0xLV2l0aE9ETUNvbWJpbmU7CisJCQkJfQorCQkJCWlmIChsb2NhbHMt
Pk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdICogKDEuMCArIG1vZGVfbGliLT52YmEuRElTUENM
S0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcgLyAxMDAuMCkgPD0gbW9kZV9saWItPnZiYS5NYXhE
cHBjbGtSb3VuZGVkRG93blRvREZTR3JhbnVsYXJpdHkKKwkJCQkJCSYmIGxvY2Fscy0+U3dhdGhX
aWR0aFlTaW5nbGVEUFBba10gPD0gbG9jYWxzLT5NYXhpbXVtU3dhdGhXaWR0aFtrXQorCQkJCQkJ
JiYgbG9jYWxzLT5PRE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbaV1ba10gPT0gZmFsc2UpIHsKKwkJ
CQkJbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdID0gMTsKKwkJCQkJbG9jYWxzLT5SZXF1aXJlZERQ
UENMS1tpXVtqXVtrXSA9CisJCQkJCQlsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2td
ICogKDEuMCArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcg
LyAxMDAuMCk7CisJCQkJfSBlbHNlIHsKKwkJCQkJbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdID0g
MjsKKwkJCQkJbG9jYWxzLT5SZXF1aXJlZERQUENMS1tpXVtqXVtrXSA9CisJCQkJCQlsb2NhbHMt
Pk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdICogKDEuMCArIG1vZGVfbGliLT52YmEuRElTUENM
S0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcgLyAxMDAuMCkgLyAyLjA7CisJCQkJfQorCQkJCWxv
Y2Fscy0+UmVxdWlyZWRESVNQQ0xLW2ldW2pdID0gZG1sX21heCgKKwkJCQkJCWxvY2Fscy0+UmVx
dWlyZWRESVNQQ0xLW2ldW2pdLAorCQkJCQkJbW9kZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElT
UENMSyk7CisJCQkJaWYgKChsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdIC8gbG9j
YWxzLT5Ob09mRFBQW2ldW2pdW2tdICogKDEuMCArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENM
S0RTQ0NMS0Rvd25TcHJlYWRpbmcgLyAxMDAuMCkKKwkJCQkJCT4gbW9kZV9saWItPnZiYS5NYXhE
cHBjbGtSb3VuZGVkRG93blRvREZTR3JhbnVsYXJpdHkpCisJCQkJCQl8fCAobW9kZV9saWItPnZi
YS5QbGFuZVJlcXVpcmVkRElTUENMSyA+IG1vZGVfbGliLT52YmEuTWF4RGlzcGNsa1JvdW5kZWRE
b3duVG9ERlNHcmFudWxhcml0eSkpIHsKKwkJCQkJbG9jYWxzLT5ESVNQQ0xLX0RQUENMS19TdXBw
b3J0W2ldW2pdID0gZmFsc2U7CisJCQkJfQorCQkJfQorCQkJbG9jYWxzLT5Ub3RhbE51bWJlck9m
QWN0aXZlRFBQW2ldW2pdID0gMC4wOworCQkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKQorCQkJCWxvY2Fscy0+VG90YWxOdW1iZXJP
ZkFjdGl2ZURQUFtpXVtqXSA9IGxvY2Fscy0+VG90YWxOdW1iZXJPZkFjdGl2ZURQUFtpXVtqXSAr
IGxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXTsKKwkJCWlmIChqID09IDEpIHsKKwkJCQl3aGlsZSAo
bG9jYWxzLT5Ub3RhbE51bWJlck9mQWN0aXZlRFBQW2ldW2pdIDwgbW9kZV9saWItPnZiYS5NYXhO
dW1EUFAKKwkJCQkJCSYmIGxvY2Fscy0+VG90YWxOdW1iZXJPZkFjdGl2ZURQUFtpXVtqXSA8IDIg
KiBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzKSB7CisJCQkJCWRvdWJsZSBCV09m
Tm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aDsKKwkJCQkJdW5zaWduZWQgaW50IE51bWJl
ck9mTm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aDsKKworCQkJCQlCV09mTm9uU3BsaXRQ
bGFuZU9mTWF4aW11bUJhbmR3aWR0aCA9IDA7CisJCQkJCU51bWJlck9mTm9uU3BsaXRQbGFuZU9m
TWF4aW11bUJhbmR3aWR0aCA9IDA7CisJCQkJCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJCQkJCWlmIChsb2NhbHMtPlJlYWRCYW5k
d2lkdGhba10gPiBCV09mTm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aCAmJiBsb2NhbHMt
Pk5vT2ZEUFBbaV1bal1ba10gPT0gMSkgeworCQkJCQkJCUJXT2ZOb25TcGxpdFBsYW5lT2ZNYXhp
bXVtQmFuZHdpZHRoID0gbG9jYWxzLT5SZWFkQmFuZHdpZHRoW2tdOworCQkJCQkJCU51bWJlck9m
Tm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aCA9IGs7CisJCQkJCQl9CisJCQkJCX0KKwkJ
CQkJbG9jYWxzLT5Ob09mRFBQW2ldW2pdW051bWJlck9mTm9uU3BsaXRQbGFuZU9mTWF4aW11bUJh
bmR3aWR0aF0gPSAyOworCQkJCQlsb2NhbHMtPlJlcXVpcmVkRFBQQ0xLW2ldW2pdW051bWJlck9m
Tm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aF0gPQorCQkJCQkJbG9jYWxzLT5NaW5EUFBD
TEtVc2luZ1NpbmdsZURQUFtOdW1iZXJPZk5vblNwbGl0UGxhbmVPZk1heGltdW1CYW5kd2lkdGhd
CisJCQkJCQkJKiAoMSArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJl
YWRpbmcgLyAxMDApIC8gMjsKKwkJCQkJbG9jYWxzLT5Ub3RhbE51bWJlck9mQWN0aXZlRFBQW2ld
W2pdID0gbG9jYWxzLT5Ub3RhbE51bWJlck9mQWN0aXZlRFBQW2ldW2pdICsgMTsKKwkJCQl9CisJ
CQl9CisJCQlpZiAobG9jYWxzLT5Ub3RhbE51bWJlck9mQWN0aXZlRFBQW2ldW2pdID4gbW9kZV9s
aWItPnZiYS5NYXhOdW1EUFApIHsKKwkJCQlsb2NhbHMtPlJlcXVpcmVkRElTUENMS1tpXVtqXSA9
IDAuMDsKKwkJCQlsb2NhbHMtPkRJU1BDTEtfRFBQQ0xLX1N1cHBvcnRbaV1bal0gPSB0cnVlOwor
CQkJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAt
IDE7IGsrKykgeworCQkJCQlsb2NhbHMtPk9ETUNvbWJpbmVFbmFibGVQZXJTdGF0ZVtpXVtrXSA9
IGZhbHNlOworCQkJCQlpZiAobG9jYWxzLT5Td2F0aFdpZHRoWVNpbmdsZURQUFtrXSA8PSBsb2Nh
bHMtPk1heGltdW1Td2F0aFdpZHRoW2tdKSB7CisJCQkJCQlsb2NhbHMtPk5vT2ZEUFBbaV1bal1b
a10gPSAxOworCQkJCQkJbG9jYWxzLT5SZXF1aXJlZERQUENMS1tpXVtqXVtrXSA9IGxvY2Fscy0+
TWluRFBQQ0xLVXNpbmdTaW5nbGVEUFBba10KKwkJCQkJCQkqICgxLjAgKyBtb2RlX2xpYi0+dmJh
LkRJU1BDTEtEUFBDTEtEU0NDTEtEb3duU3ByZWFkaW5nIC8gMTAwLjApOworCQkJCQl9IGVsc2Ug
eworCQkJCQkJbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdID0gMjsKKwkJCQkJCWxvY2Fscy0+UmVx
dWlyZWREUFBDTEtbaV1bal1ba10gPSBsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2td
CisJCQkJCQkJCQkJKiAoMS4wICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93
blNwcmVhZGluZyAvIDEwMC4wKSAvIDIuMDsKKwkJCQkJfQorCQkJCQlpZiAoaSAhPSBtb2RlX2xp
Yi0+dmJhLnNvYy5udW1fc3RhdGVzKSB7CisJCQkJCQltb2RlX2xpYi0+dmJhLlBsYW5lUmVxdWly
ZWRESVNQQ0xLID0KKwkJCQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCQkJ
CQkJKiAoMS4wICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGlu
ZyAvIDEwMC4wKQorCQkJCQkJCQkJCSogKDEuMCArIG1vZGVfbGliLT52YmEuRElTUENMS1JhbXBp
bmdNYXJnaW4gLyAxMDAuMCk7CisJCQkJCX0gZWxzZSB7CisJCQkJCQltb2RlX2xpYi0+dmJhLlBs
YW5lUmVxdWlyZWRESVNQQ0xLID0gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCQkJ
KiAoMS4wICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGluZyAv
IDEwMC4wKTsKKwkJCQkJfQorCQkJCQlsb2NhbHMtPlJlcXVpcmVkRElTUENMS1tpXVtqXSA9IGRt
bF9tYXgoCisJCQkJCQkJbG9jYWxzLT5SZXF1aXJlZERJU1BDTEtbaV1bal0sCisJCQkJCQkJbW9k
ZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElTUENMSyk7CisJCQkJCWlmIChsb2NhbHMtPk1pbkRQ
UENMS1VzaW5nU2luZ2xlRFBQW2tdIC8gbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdICogKDEuMCAr
IG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcgLyAxMDAuMCkK
KwkJCQkJCQk+IG1vZGVfbGliLT52YmEuTWF4RHBwY2xrUm91bmRlZERvd25Ub0RGU0dyYW51bGFy
aXR5CisJCQkJCQkJfHwgbW9kZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElTUENMSyA+IG1vZGVf
bGliLT52YmEuTWF4RGlzcGNsa1JvdW5kZWREb3duVG9ERlNHcmFudWxhcml0eSkKKwkJCQkJCWxv
Y2Fscy0+RElTUENMS19EUFBDTEtfU3VwcG9ydFtpXVtqXSA9IGZhbHNlOworCQkJCX0KKwkJCQls
b2NhbHMtPlRvdGFsTnVtYmVyT2ZBY3RpdmVEUFBbaV1bal0gPSAwLjA7CisJCQkJZm9yIChrID0g
MDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKQorCQkJ
CQlsb2NhbHMtPlRvdGFsTnVtYmVyT2ZBY3RpdmVEUFBbaV1bal0gPSBsb2NhbHMtPlRvdGFsTnVt
YmVyT2ZBY3RpdmVEUFBbaV1bal0gKyBsb2NhbHMtPk5vT2ZEUFBbaV1bal1ba107CisJCQl9CisJ
CQlsb2NhbHMtPlJlcXVpcmVkRElTUENMS1tpXVtqXSA9IGRtbF9tYXgoCisJCQkJCWxvY2Fscy0+
UmVxdWlyZWRESVNQQ0xLW2ldW2pdLAorCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja1JlcXVp
cmVkRElTUENMSyk7CisJCQlpZiAobW9kZV9saWItPnZiYS5NYXhEaXNwY2xrUm91bmRlZERvd25U
b0RGU0dyYW51bGFyaXR5CisJCQkJCTwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tSZXF1aXJlZERJ
U1BDTEspIHsKKwkJCQlsb2NhbHMtPkRJU1BDTEtfRFBQQ0xLX1N1cHBvcnRbaV1bal0gPSBmYWxz
ZTsKKwkJCX0KKwkJfQorCX0KKwkvKlZpZXdwb3J0IFNpemUgQ2hlY2sqLworCisJZm9yIChpID0g
MDsgaSA8PSBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJbG9jYWxzLT5W
aWV3cG9ydFNpemVTdXBwb3J0W2ldID0gdHJ1ZTsKKwkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xp
Yi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQlpZiAobG9jYWxzLT5P
RE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbaV1ba10gPT0gdHJ1ZSkgeworCQkJCWlmIChkbWxfbWlu
KGxvY2Fscy0+U3dhdGhXaWR0aFlTaW5nbGVEUFBba10sIGRtbF9yb3VuZChtb2RlX2xpYi0+dmJh
LkhBY3RpdmVba10gLyAyLjAgKiBtb2RlX2xpYi0+dmJhLkhSYXRpb1trXSkpCisJCQkJCQk+IGxv
Y2Fscy0+TWF4aW11bVN3YXRoV2lkdGhba10pIHsKKwkJCQkJbG9jYWxzLT5WaWV3cG9ydFNpemVT
dXBwb3J0W2ldID0gZmFsc2U7CisJCQkJfQorCQkJfSBlbHNlIHsKKwkJCQlpZiAobG9jYWxzLT5T
d2F0aFdpZHRoWVNpbmdsZURQUFtrXSAvIDIuMCA+IGxvY2Fscy0+TWF4aW11bVN3YXRoV2lkdGhb
a10pIHsKKwkJCQkJbG9jYWxzLT5WaWV3cG9ydFNpemVTdXBwb3J0W2ldID0gZmFsc2U7CisJCQkJ
fQorCQkJfQorCQl9CisJfQorCS8qVG90YWwgQXZhaWxhYmxlIFBpcGVzIFN1cHBvcnQgQ2hlY2sq
LworCisJZm9yIChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzOyBpKysp
IHsKKwkJZm9yIChqID0gMDsgaiA8IDI7IGorKykgeworCQkJaWYgKGxvY2Fscy0+VG90YWxOdW1i
ZXJPZkFjdGl2ZURQUFtpXVtqXSA8PSBtb2RlX2xpYi0+dmJhLk1heE51bURQUCkKKwkJCQlsb2Nh
bHMtPlRvdGFsQXZhaWxhYmxlUGlwZXNTdXBwb3J0W2ldW2pdID0gdHJ1ZTsKKwkJCWVsc2UKKwkJ
CQlsb2NhbHMtPlRvdGFsQXZhaWxhYmxlUGlwZXNTdXBwb3J0W2ldW2pdID0gZmFsc2U7CisJCX0K
Kwl9CisJLypUb3RhbCBBdmFpbGFibGUgT1RHIFN1cHBvcnQgQ2hlY2sqLworCisJbW9kZV9saWIt
PnZiYS5Ub3RhbE51bWJlck9mQWN0aXZlT1RHID0gMC4wOworCWZvciAoayA9IDA7IGsgPD0gbW9k
ZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlpZiAobW9kZV9s
aWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBrKSB7CisJCQltb2RlX2xpYi0+dmJhLlRv
dGFsTnVtYmVyT2ZBY3RpdmVPVEcgPSBtb2RlX2xpYi0+dmJhLlRvdGFsTnVtYmVyT2ZBY3RpdmVP
VEcKKwkJCQkJKyAxLjA7CisJCX0KKwl9CisJaWYgKG1vZGVfbGliLT52YmEuVG90YWxOdW1iZXJP
ZkFjdGl2ZU9URyA8PSBtb2RlX2xpYi0+dmJhLk1heE51bU9URykgeworCQltb2RlX2xpYi0+dmJh
Lk51bWJlck9mT1RHU3VwcG9ydCA9IHRydWU7CisJfSBlbHNlIHsKKwkJbW9kZV9saWItPnZiYS5O
dW1iZXJPZk9UR1N1cHBvcnQgPSBmYWxzZTsKKwl9CisJLypEaXNwbGF5IElPIGFuZCBEU0MgU3Vw
cG9ydCBDaGVjayovCisKKwltb2RlX2xpYi0+dmJhLk5vbnN1cHBvcnRlZERTQ0lucHV0QlBDID0g
ZmFsc2U7CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxh
bmVzIC0gMTsgaysrKSB7CisJCWlmICghKG1vZGVfbGliLT52YmEuRFNDSW5wdXRCaXRQZXJDb21w
b25lbnRba10gPT0gMTIuMAorCQkJCXx8IG1vZGVfbGliLT52YmEuRFNDSW5wdXRCaXRQZXJDb21w
b25lbnRba10gPT0gMTAuMAorCQkJCXx8IG1vZGVfbGliLT52YmEuRFNDSW5wdXRCaXRQZXJDb21w
b25lbnRba10gPT0gOC4wKSkgeworCQkJbW9kZV9saWItPnZiYS5Ob25zdXBwb3J0ZWREU0NJbnB1
dEJQQyA9IHRydWU7CisJCX0KKwl9CisJZm9yIChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJhLnNv
Yy5udW1fc3RhdGVzOyBpKyspIHsKKwkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQlsb2NhbHMtPlJlcXVpcmVzRFNDW2ld
W2tdID0gMDsKKwkJCWxvY2Fscy0+UmVxdWlyZXNGRUNbaV1ba10gPSAwOworCQkJaWYgKG1vZGVf
bGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdba10gPT0gaykgeworCQkJCWlmIChtb2RlX2xpYi0+
dmJhLk91dHB1dFtrXSA9PSBkbV9oZG1pKSB7CisJCQkJCWxvY2Fscy0+UmVxdWlyZXNEU0NbaV1b
a10gPSAwOworCQkJCQlsb2NhbHMtPlJlcXVpcmVzRkVDW2ldW2tdID0gMDsKKwkJCQkJbG9jYWxz
LT5PdXRwdXRCcHBQZXJTdGF0ZVtpXVtrXSA9IFRydW5jVG9WYWxpZEJQUCgKKwkJCQkJCQlkbWxf
bWluKDYwMC4wLCBtb2RlX2xpYi0+dmJhLlBIWUNMS1BlclN0YXRlW2ldKSAvIG1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja0JhY2tFbmRba10gKiAyNCwKKwkJCQkJCQlmYWxzZSwKKwkJCQkJCQltb2Rl
X2xpYi0+dmJhLk91dHB1dFtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dEZvcm1hdFtr
XSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9uZW50W2tdKTsKKwkJ
CQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuT3V0cHV0W2tdID09IGRtX2RwCisJCQkJCQl8fCBt
b2RlX2xpYi0+dmJhLk91dHB1dFtrXSA9PSBkbV9lZHApIHsKKwkJCQkJaWYgKG1vZGVfbGliLT52
YmEuT3V0cHV0W2tdID09IGRtX2VkcCkgeworCQkJCQkJbW9kZV9saWItPnZiYS5FZmZlY3RpdmVG
RUNPdmVyaGVhZCA9IDAuMDsKKwkJCQkJfSBlbHNlIHsKKwkJCQkJCW1vZGVfbGliLT52YmEuRWZm
ZWN0aXZlRkVDT3ZlcmhlYWQgPQorCQkJCQkJCQltb2RlX2xpYi0+dmJhLkZFQ092ZXJoZWFkOwor
CQkJCQl9CisJCQkJCWlmIChtb2RlX2xpYi0+dmJhLlBIWUNMS1BlclN0YXRlW2ldID49IDI3MC4w
KSB7CisJCQkJCQltb2RlX2xpYi0+dmJhLk91dGJwcCA9IFRydW5jVG9WYWxpZEJQUCgKKwkJCQkJ
CQkJKDEuMCAtIG1vZGVfbGliLT52YmEuRG93bnNwcmVhZGluZyAvIDEwMC4wKSAqIDI3MC4wCisJ
CQkJCQkJCSogbW9kZV9saWItPnZiYS5PdXRwdXRMaW5rRFBMYW5lc1trXSAvIG1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja0JhY2tFbmRba10gKiA4LjAsCisJCQkJCQkJCWZhbHNlLAorCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLk91dHB1dFtrXSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3Jt
YXRba10sCisJCQkJCQkJCW1vZGVfbGliLT52YmEuRFNDSW5wdXRCaXRQZXJDb21wb25lbnRba10p
OworCQkJCQkJbW9kZV9saWItPnZiYS5PdXRicHBEU0MgPSBUcnVuY1RvVmFsaWRCUFAoCisJCQkJ
CQkJCSgxLjAgLSBtb2RlX2xpYi0+dmJhLkRvd25zcHJlYWRpbmcgLyAxMDAuMCkgKiAoMS4wIC0g
bW9kZV9saWItPnZiYS5FZmZlY3RpdmVGRUNPdmVyaGVhZCAvIDEwMC4wKSAqIDI3MC4wCisJCQkJ
CQkJCSogbW9kZV9saWItPnZiYS5PdXRwdXRMaW5rRFBMYW5lc1trXSAvIG1vZGVfbGliLT52YmEu
UGl4ZWxDbG9ja0JhY2tFbmRba10gKiA4LjAsCisJCQkJCQkJCXRydWUsCisJCQkJCQkJCW1vZGVf
bGliLT52YmEuT3V0cHV0W2tdLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dEZvcm1hdFtr
XSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5EU0NJbnB1dEJpdFBlckNvbXBvbmVudFtrXSk7CisJ
CQkJCQlpZiAobW9kZV9saWItPnZiYS5EU0NFbmFibGVkW2tdID09IHRydWUpIHsKKwkJCQkJCQls
b2NhbHMtPlJlcXVpcmVzRFNDW2ldW2tdID0gdHJ1ZTsKKwkJCQkJCQlpZiAobW9kZV9saWItPnZi
YS5PdXRwdXRba10gPT0gZG1fZHApIHsKKwkJCQkJCQkJbG9jYWxzLT5SZXF1aXJlc0ZFQ1tpXVtr
XSA9IHRydWU7CisJCQkJCQkJfSBlbHNlIHsKKwkJCQkJCQkJbG9jYWxzLT5SZXF1aXJlc0ZFQ1tp
XVtrXSA9IGZhbHNlOworCQkJCQkJCX0KKwkJCQkJCQltb2RlX2xpYi0+dmJhLk91dGJwcCA9IG1v
ZGVfbGliLT52YmEuT3V0YnBwRFNDOworCQkJCQkJfSBlbHNlIHsKKwkJCQkJCQlsb2NhbHMtPlJl
cXVpcmVzRFNDW2ldW2tdID0gZmFsc2U7CisJCQkJCQkJbG9jYWxzLT5SZXF1aXJlc0ZFQ1tpXVtr
XSA9IGZhbHNlOworCQkJCQkJfQorCQkJCQkJbG9jYWxzLT5PdXRwdXRCcHBQZXJTdGF0ZVtpXVtr
XSA9IG1vZGVfbGliLT52YmEuT3V0YnBwOworCQkJCQl9CisJCQkJCWlmIChtb2RlX2xpYi0+dmJh
Lk91dGJwcCA9PSBCUFBfSU5WQUxJRCAmJiBtb2RlX2xpYi0+dmJhLlBIWUNMS1BlclN0YXRlW2ld
ID49IDU0MC4wKSB7CisJCQkJCQltb2RlX2xpYi0+dmJhLk91dGJwcCA9IFRydW5jVG9WYWxpZEJQ
UCgKKwkJCQkJCQkJKDEuMCAtIG1vZGVfbGliLT52YmEuRG93bnNwcmVhZGluZyAvIDEwMC4wKSAq
IDU0MC4wCisJCQkJCQkJCSogbW9kZV9saWItPnZiYS5PdXRwdXRMaW5rRFBMYW5lc1trXSAvIG1v
ZGVfbGliLT52YmEuUGl4ZWxDbG9ja0JhY2tFbmRba10gKiA4LjAsCisJCQkJCQkJCQlmYWxzZSwK
KwkJCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0cHV0W2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5PdXRwdXRGb3JtYXRba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVy
Q29tcG9uZW50W2tdKTsKKwkJCQkJCW1vZGVfbGliLT52YmEuT3V0YnBwRFNDID0gVHJ1bmNUb1Zh
bGlkQlBQKAorCQkJCQkJCQkoMS4wIC0gbW9kZV9saWItPnZiYS5Eb3duc3ByZWFkaW5nIC8gMTAw
LjApICogKDEuMCAtIG1vZGVfbGliLT52YmEuRWZmZWN0aXZlRkVDT3ZlcmhlYWQgLyAxMDAuMCkg
KiA1NDAuMAorCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuT3V0cHV0TGlua0RQTGFuZXNba10gLyBt
b2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNrRW5kW2tdICogOC4wLAorCQkJCQkJCQl0cnVlLAor
CQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dFtrXSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5P
dXRwdXRGb3JtYXRba10sCisJCQkJCQkJCW1vZGVfbGliLT52YmEuRFNDSW5wdXRCaXRQZXJDb21w
b25lbnRba10pOworCQkJCQkJaWYgKG1vZGVfbGliLT52YmEuRFNDRW5hYmxlZFtrXSA9PSB0cnVl
KSB7CisJCQkJCQkJbG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9IHRydWU7CisJCQkJCQkJaWYg
KG1vZGVfbGliLT52YmEuT3V0cHV0W2tdID09IGRtX2RwKSB7CisJCQkJCQkJCWxvY2Fscy0+UmVx
dWlyZXNGRUNbaV1ba10gPSB0cnVlOworCQkJCQkJCX0gZWxzZSB7CisJCQkJCQkJCWxvY2Fscy0+
UmVxdWlyZXNGRUNbaV1ba10gPSBmYWxzZTsKKwkJCQkJCQl9CisJCQkJCQkJbW9kZV9saWItPnZi
YS5PdXRicHAgPSBtb2RlX2xpYi0+dmJhLk91dGJwcERTQzsKKwkJCQkJCX0gZWxzZSB7CisJCQkJ
CQkJbG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9IGZhbHNlOworCQkJCQkJCWxvY2Fscy0+UmVx
dWlyZXNGRUNbaV1ba10gPSBmYWxzZTsKKwkJCQkJCX0KKwkJCQkJCWxvY2Fscy0+T3V0cHV0QnBw
UGVyU3RhdGVbaV1ba10gPSBtb2RlX2xpYi0+dmJhLk91dGJwcDsKKwkJCQkJfQorCQkJCQlpZiAo
bW9kZV9saWItPnZiYS5PdXRicHAgPT0gQlBQX0lOVkFMSUQKKwkJCQkJCQkmJiBtb2RlX2xpYi0+
dmJhLlBIWUNMS1BlclN0YXRlW2ldCisJCQkJCQkJCQk+PSA4MTAuMCkgeworCQkJCQkJbW9kZV9s
aWItPnZiYS5PdXRicHAgPSBUcnVuY1RvVmFsaWRCUFAoCisJCQkJCQkJCSgxLjAgLSBtb2RlX2xp
Yi0+dmJhLkRvd25zcHJlYWRpbmcgLyAxMDAuMCkgKiA4MTAuMAorCQkJCQkJCQkqIG1vZGVfbGli
LT52YmEuT3V0cHV0TGlua0RQTGFuZXNba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNr
RW5kW2tdICogOC4wLAorCQkJCQkJCQlmYWxzZSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRw
dXRba10sCisJCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0W2tdLAorCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9uZW50W2tdKTsKKwkJCQkJCW1vZGVfbGli
LT52YmEuT3V0YnBwRFNDID0gVHJ1bmNUb1ZhbGlkQlBQKAorCQkJCQkJCQkoMS4wIC0gbW9kZV9s
aWItPnZiYS5Eb3duc3ByZWFkaW5nIC8gMTAwLjApICogKDEuMCAtIG1vZGVfbGliLT52YmEuRWZm
ZWN0aXZlRkVDT3ZlcmhlYWQgLyAxMDAuMCkgKiA4MTAuMAorCQkJCQkJCQkqIG1vZGVfbGliLT52
YmEuT3V0cHV0TGlua0RQTGFuZXNba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNrRW5k
W2tdICogOC4wLAorCQkJCQkJCQl0cnVlLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dFtr
XSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10sCisJCQkJCQkJCW1vZGVf
bGliLT52YmEuRFNDSW5wdXRCaXRQZXJDb21wb25lbnRba10pOworCQkJCQkJaWYgKG1vZGVfbGli
LT52YmEuRFNDRW5hYmxlZFtrXSA9PSB0cnVlIHx8IG1vZGVfbGliLT52YmEuT3V0YnBwID09IEJQ
UF9JTlZBTElEKSB7CisJCQkJCQkJbG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9IHRydWU7CisJ
CQkJCQkJaWYgKG1vZGVfbGliLT52YmEuT3V0cHV0W2tdID09IGRtX2RwKSB7CisJCQkJCQkJCWxv
Y2Fscy0+UmVxdWlyZXNGRUNbaV1ba10gPSB0cnVlOworCQkJCQkJCX0gZWxzZSB7CisJCQkJCQkJ
CWxvY2Fscy0+UmVxdWlyZXNGRUNbaV1ba10gPSBmYWxzZTsKKwkJCQkJCQl9CisJCQkJCQkJbW9k
ZV9saWItPnZiYS5PdXRicHAgPSBtb2RlX2xpYi0+dmJhLk91dGJwcERTQzsKKwkJCQkJCX0gZWxz
ZSB7CisJCQkJCQkJbG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9IGZhbHNlOworCQkJCQkJCWxv
Y2Fscy0+UmVxdWlyZXNGRUNbaV1ba10gPSBmYWxzZTsKKwkJCQkJCX0KKwkJCQkJCWxvY2Fscy0+
T3V0cHV0QnBwUGVyU3RhdGVbaV1ba10gPQorCQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dGJwcDsK
KwkJCQkJfQorCQkJCX0KKwkJCX0gZWxzZSB7CisJCQkJbG9jYWxzLT5PdXRwdXRCcHBQZXJTdGF0
ZVtpXVtrXSA9IEJQUF9CTEVOREVEX1BJUEU7CisJCQl9CisJCX0KKwl9CisJZm9yIChpID0gMDsg
aSA8PSBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJbG9jYWxzLT5ESU9T
dXBwb3J0W2ldID0gdHJ1ZTsKKwkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJl
ck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQlpZiAobG9jYWxzLT5PdXRwdXRCcHBQZXJT
dGF0ZVtpXVtrXSA9PSBCUFBfSU5WQUxJRAorCQkJCQl8fCAobW9kZV9saWItPnZiYS5PdXRwdXRG
b3JtYXRba10gPT0gZG1fNDIwCisJCQkJCQkJJiYgbW9kZV9saWItPnZiYS5JbnRlcmxhY2Vba10g
PT0gdHJ1ZQorCQkJCQkJCSYmIG1vZGVfbGliLT52YmEuUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVu
aXRJbk9QUCA9PSB0cnVlKSkgeworCQkJCWxvY2Fscy0+RElPU3VwcG9ydFtpXSA9IGZhbHNlOwor
CQkJfQorCQl9CisJfQorCWZvciAoaSA9IDA7IGkgPD0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0
YXRlczsgaSsrKSB7CisJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFj
dGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJbG9jYWxzLT5EU0NDTEtSZXF1aXJlZE1vcmVUaGFu
U3VwcG9ydGVkW2ldID0gZmFsc2U7CisJCQlpZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRp
bWluZ1trXSA9PSBrKSB7CisJCQkJaWYgKChtb2RlX2xpYi0+dmJhLk91dHB1dFtrXSA9PSBkbV9k
cAorCQkJCQkJfHwgbW9kZV9saWItPnZiYS5PdXRwdXRba10gPT0gZG1fZWRwKSkgeworCQkJCQlp
ZiAobW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10gPT0gZG1fNDIwCisJCQkJCQkJfHwgbW9k
ZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10KKwkJCQkJCQkJCT09IGRtX240MjIpIHsKKwkJCQkJ
CW1vZGVfbGliLT52YmEuRFNDRm9ybWF0RmFjdG9yID0gMjsKKwkJCQkJfSBlbHNlIHsKKwkJCQkJ
CW1vZGVfbGliLT52YmEuRFNDRm9ybWF0RmFjdG9yID0gMTsKKwkJCQkJfQorCQkJCQlpZiAobG9j
YWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9PSB0cnVlKSB7CisJCQkJCQlpZiAobG9jYWxzLT5PRE1D
b21iaW5lRW5hYmxlUGVyU3RhdGVbaV1ba10KKwkJCQkJCQkJPT0gdHJ1ZSkgeworCQkJCQkJCWlm
IChtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNrRW5kW2tdIC8gNi4wIC8gbW9kZV9saWItPnZi
YS5EU0NGb3JtYXRGYWN0b3IKKwkJCQkJCQkJCT4gKDEuMCAtIG1vZGVfbGliLT52YmEuRElTUENM
S0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcgLyAxMDAuMCkgKiBtb2RlX2xpYi0+dmJhLk1heERT
Q0NMS1tpXSkgeworCQkJCQkJCQlsb2NhbHMtPkRTQ0NMS1JlcXVpcmVkTW9yZVRoYW5TdXBwb3J0
ZWRbaV0gPQorCQkJCQkJCQkJCXRydWU7CisJCQkJCQkJfQorCQkJCQkJfSBlbHNlIHsKKwkJCQkJ
CQlpZiAobW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtrXSAvIDMuMCAvIG1vZGVfbGli
LT52YmEuRFNDRm9ybWF0RmFjdG9yCisJCQkJCQkJCQk+ICgxLjAgLSBtb2RlX2xpYi0+dmJhLkRJ
U1BDTEtEUFBDTEtEU0NDTEtEb3duU3ByZWFkaW5nIC8gMTAwLjApICogbW9kZV9saWItPnZiYS5N
YXhEU0NDTEtbaV0pIHsKKwkJCQkJCQkJbG9jYWxzLT5EU0NDTEtSZXF1aXJlZE1vcmVUaGFuU3Vw
cG9ydGVkW2ldID0KKwkJCQkJCQkJCQl0cnVlOworCQkJCQkJCX0KKwkJCQkJCX0KKwkJCQkJfQor
CQkJCX0KKwkJCX0KKwkJfQorCX0KKwlmb3IgKGkgPSAwOyBpIDw9IG1vZGVfbGliLT52YmEuc29j
Lm51bV9zdGF0ZXM7IGkrKykgeworCQlsb2NhbHMtPk5vdEVub3VnaERTQ1VuaXRzW2ldID0gZmFs
c2U7CisJCW1vZGVfbGliLT52YmEuVG90YWxEU0NVbml0c1JlcXVpcmVkID0gMC4wOworCQlmb3Ig
KGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKysp
IHsKKwkJCWlmIChsb2NhbHMtPlJlcXVpcmVzRFNDW2ldW2tdID09IHRydWUpIHsKKwkJCQlpZiAo
bG9jYWxzLT5PRE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbaV1ba10gPT0gdHJ1ZSkgeworCQkJCQlt
b2RlX2xpYi0+dmJhLlRvdGFsRFNDVW5pdHNSZXF1aXJlZCA9CisJCQkJCQkJbW9kZV9saWItPnZi
YS5Ub3RhbERTQ1VuaXRzUmVxdWlyZWQgKyAyLjA7CisJCQkJfSBlbHNlIHsKKwkJCQkJbW9kZV9s
aWItPnZiYS5Ub3RhbERTQ1VuaXRzUmVxdWlyZWQgPQorCQkJCQkJCW1vZGVfbGliLT52YmEuVG90
YWxEU0NVbml0c1JlcXVpcmVkICsgMS4wOworCQkJCX0KKwkJCX0KKwkJfQorCQlpZiAobW9kZV9s
aWItPnZiYS5Ub3RhbERTQ1VuaXRzUmVxdWlyZWQgPiBtb2RlX2xpYi0+dmJhLk51bWJlck9mRFND
KSB7CisJCQlsb2NhbHMtPk5vdEVub3VnaERTQ1VuaXRzW2ldID0gdHJ1ZTsKKwkJfQorCX0KKwkv
KkRTQyBEZWxheSBwZXIgc3RhdGUqLworCisJZm9yIChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJh
LnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5C
bGVuZGluZ0FuZFRpbWluZ1trXSAhPSBrKSB7CisJCQkJbW9kZV9saWItPnZiYS5zbGljZXMgPSAw
OworCQkJfSBlbHNlIGlmIChsb2NhbHMtPlJlcXVpcmVzRFNDW2ldW2tdID09IDAKKwkJCQkJfHwg
bG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9PSBmYWxzZSkgeworCQkJCW1vZGVfbGliLT52YmEu
c2xpY2VzID0gMDsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0Vu
ZFtrXSA+IDMyMDAuMCkgeworCQkJCW1vZGVfbGliLT52YmEuc2xpY2VzID0gZG1sX2NlaWwoCisJ
CQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNrRW5kW2tdIC8gNDAwLjAsCisJCQkJCQk0
LjApOworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNrRW5kW2tdID4g
MTM2MC4wKSB7CisJCQkJbW9kZV9saWItPnZiYS5zbGljZXMgPSA4LjA7CisJCQl9IGVsc2UgaWYg
KG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja0JhY2tFbmRba10gPiA2ODAuMCkgeworCQkJCW1vZGVf
bGliLT52YmEuc2xpY2VzID0gNC4wOworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlBpeGVs
Q2xvY2tCYWNrRW5kW2tdID4gMzQwLjApIHsKKwkJCQltb2RlX2xpYi0+dmJhLnNsaWNlcyA9IDIu
MDsKKwkJCX0gZWxzZSB7CisJCQkJbW9kZV9saWItPnZiYS5zbGljZXMgPSAxLjA7CisJCQl9CisJ
CQlpZiAobG9jYWxzLT5PdXRwdXRCcHBQZXJTdGF0ZVtpXVtrXSA9PSBCUFBfQkxFTkRFRF9QSVBF
CisJCQkJCXx8IGxvY2Fscy0+T3V0cHV0QnBwUGVyU3RhdGVbaV1ba10gPT0gQlBQX0lOVkFMSUQp
IHsKKwkJCQltb2RlX2xpYi0+dmJhLmJwcCA9IDAuMDsKKwkJCX0gZWxzZSB7CisJCQkJbW9kZV9s
aWItPnZiYS5icHAgPSBsb2NhbHMtPk91dHB1dEJwcFBlclN0YXRlW2ldW2tdOworCQkJfQorCQkJ
aWYgKGxvY2Fscy0+UmVxdWlyZXNEU0NbaV1ba10gPT0gdHJ1ZSAmJiBtb2RlX2xpYi0+dmJhLmJw
cCAhPSAwLjApIHsKKwkJCQlpZiAobG9jYWxzLT5PRE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbaV1b
a10gPT0gZmFsc2UpIHsKKwkJCQkJbG9jYWxzLT5EU0NEZWxheVBlclN0YXRlW2ldW2tdID0KKwkJ
CQkJCQlkc2NjZUNvbXB1dGVEZWxheSgKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuRFNDSW5wdXRC
aXRQZXJDb21wb25lbnRba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLmJwcCwKKwkJCQkJCQkJ
CWRtbF9jZWlsKAorCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhBY3RpdmVba10KKwkJCQkJCQkJ
CQkJCQkvIG1vZGVfbGliLT52YmEuc2xpY2VzLAorCQkJCQkJCQkJCQkxLjApLAorCQkJCQkJCQkJ
bW9kZV9saWItPnZiYS5zbGljZXMsCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dEZvcm1h
dFtrXSkKKwkJCQkJCQkJCSsgZHNjQ29tcHV0ZURlbGF5KAorCQkJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLk91dHB1dEZvcm1hdFtrXSk7CisJCQkJfSBlbHNlIHsKKwkJCQkJbG9jYWxzLT5EU0NEZWxh
eVBlclN0YXRlW2ldW2tdID0KKwkJCQkJCQkyLjAgKiAoZHNjY2VDb21wdXRlRGVsYXkoCisJCQkJ
CQkJCQkJCW1vZGVfbGliLT52YmEuRFNDSW5wdXRCaXRQZXJDb21wb25lbnRba10sCisJCQkJCQkJ
CQkJCW1vZGVfbGliLT52YmEuYnBwLAorCQkJCQkJCQkJCQlkbWxfY2VpbChtb2RlX2xpYi0+dmJh
LkhBY3RpdmVba10gLyBtb2RlX2xpYi0+dmJhLnNsaWNlcywgMS4wKSwKKwkJCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5zbGljZXMgLyAyLAorCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dEZv
cm1hdFtrXSkKKwkJCQkJCQkJCSsgZHNjQ29tcHV0ZURlbGF5KG1vZGVfbGliLT52YmEuT3V0cHV0
Rm9ybWF0W2tdKSk7CisJCQkJfQorCQkJCWxvY2Fscy0+RFNDRGVsYXlQZXJTdGF0ZVtpXVtrXSA9
CisJCQkJCQlsb2NhbHMtPkRTQ0RlbGF5UGVyU3RhdGVbaV1ba10gKiBtb2RlX2xpYi0+dmJhLlBp
eGVsQ2xvY2tba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNrRW5kW2tdOworCQkJfSBl
bHNlIHsKKwkJCQlsb2NhbHMtPkRTQ0RlbGF5UGVyU3RhdGVbaV1ba10gPSAwLjA7CisJCQl9CisJ
CX0KKwkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVz
IC0gMTsgaysrKSB7CisJCQlmb3IgKG0gPSAwOyBtIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZB
Y3RpdmVQbGFuZXMgLSAxOyBtKyspIHsKKwkJCQlmb3IgKGogPSAwOyBqIDw9IG1vZGVfbGliLT52
YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBqKyspIHsKKwkJCQkJaWYgKG1vZGVfbGliLT52
YmEuQmxlbmRpbmdBbmRUaW1pbmdba10gPT0gbSAmJiBsb2NhbHMtPlJlcXVpcmVzRFNDW2ldW21d
ID09IHRydWUpCisJCQkJCQlsb2NhbHMtPkRTQ0RlbGF5UGVyU3RhdGVbaV1ba10gPSBsb2NhbHMt
PkRTQ0RlbGF5UGVyU3RhdGVbaV1bbV07CisJCQkJfQorCQkJfQorCQl9CisJfQorCisJLy9QcmVm
ZXRjaCBDaGVjaworCWZvciAoaSA9IDA7IGkgPD0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRl
czsgaSsrKSB7CisJCWZvciAoaiA9IDA7IGogPCAyOyBqKyspIHsKKwkJCWZvciAoayA9IDA7IGsg
PD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJCWlm
IChsb2NhbHMtPk9ETUNvbWJpbmVFbmFibGVQZXJTdGF0ZVtpXVtrXSA9PSB0cnVlKQorCQkJCQls
b2NhbHMtPlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba10gPSBkbWxfbWluKGxvY2Fscy0+U3dh
dGhXaWR0aFlTaW5nbGVEUFBba10sIGRtbF9yb3VuZChsb2NhbHMtPkhBY3RpdmVba10gLyAyICog
bG9jYWxzLT5IUmF0aW9ba10pKTsKKwkJCQllbHNlCisJCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFlQ
ZXJTdGF0ZVtpXVtqXVtrXSA9IGxvY2Fscy0+U3dhdGhXaWR0aFlTaW5nbGVEUFBba10gLyBsb2Nh
bHMtPk5vT2ZEUFBbaV1bal1ba107CisJCQkJbG9jYWxzLT5Td2F0aFdpZHRoR3JhbnVsYXJpdHlZ
ID0gMjU2ICAvIGRtbF9jZWlsKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdLCAxKSAvIGxv
Y2Fscy0+TWF4U3dhdGhIZWlnaHRZW2tdOworCQkJCWxvY2Fscy0+Um91bmRlZFVwTWF4U3dhdGhT
aXplQnl0ZXNZID0gKGRtbF9jZWlsKGxvY2Fscy0+U3dhdGhXaWR0aFlQZXJTdGF0ZVtpXVtqXVtr
XSAtIDEsIGxvY2Fscy0+U3dhdGhXaWR0aEdyYW51bGFyaXR5WSkKKwkJCQkJCSsgbG9jYWxzLT5T
d2F0aFdpZHRoR3JhbnVsYXJpdHlZKSAqIGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdICog
bG9jYWxzLT5NYXhTd2F0aEhlaWdodFlba107CisJCQkJaWYgKGxvY2Fscy0+U291cmNlUGl4ZWxG
b3JtYXRba10gPT0gZG1fNDIwXzEwKSB7CisJCQkJCWxvY2Fscy0+Um91bmRlZFVwTWF4U3dhdGhT
aXplQnl0ZXNZID0gZG1sX2NlaWwobG9jYWxzLT5Sb3VuZGVkVXBNYXhTd2F0aFNpemVCeXRlc1ks
IDI1NikgKyAyNTY7CisJCQkJfQorCQkJCWlmIChsb2NhbHMtPk1heFN3YXRoSGVpZ2h0Q1trXSA+
IDApIHsKKwkJCQkJbG9jYWxzLT5Td2F0aFdpZHRoR3JhbnVsYXJpdHlDID0gMjU2IC8gZG1sX2Nl
aWwobG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVENba10sIDIpIC8gbG9jYWxzLT5NYXhTd2F0aEhl
aWdodENba107CisKKwkJCQkJbG9jYWxzLT5Sb3VuZGVkVXBNYXhTd2F0aFNpemVCeXRlc0MgPSAo
ZG1sX2NlaWwobG9jYWxzLT5Td2F0aFdpZHRoWVBlclN0YXRlW2ldW2pdW2tdIC8gMiAtIDEsIGxv
Y2Fscy0+U3dhdGhXaWR0aEdyYW51bGFyaXR5QykKKwkJCQkJKyBsb2NhbHMtPlN3YXRoV2lkdGhH
cmFudWxhcml0eUMpICogbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVENba10gKiBsb2NhbHMtPk1h
eFN3YXRoSGVpZ2h0Q1trXTsKKwkJCQl9CisJCQkJaWYgKGxvY2Fscy0+U291cmNlUGl4ZWxGb3Jt
YXRba10gPT0gZG1fNDIwXzEwKSB7CisJCQkJCWxvY2Fscy0+Um91bmRlZFVwTWF4U3dhdGhTaXpl
Qnl0ZXNDID0gZG1sX2NlaWwobG9jYWxzLT5Sb3VuZGVkVXBNYXhTd2F0aFNpemVCeXRlc0MsIDI1
NikgICsgMjU2OworCQkJCX0gZWxzZSB7CisJCQkJCWxvY2Fscy0+Um91bmRlZFVwTWF4U3dhdGhT
aXplQnl0ZXNDID0gMDsKKwkJCQl9CisKKwkJCQlpZiAobG9jYWxzLT5Sb3VuZGVkVXBNYXhTd2F0
aFNpemVCeXRlc1kgKyBsb2NhbHMtPlJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5dGVzQyA8PSBsb2Nh
bHMtPkRFVEJ1ZmZlclNpemVJbktCeXRlICogMTAyNCAvIDIpIHsKKwkJCQkJbG9jYWxzLT5Td2F0
aEhlaWdodFlQZXJTdGF0ZVtpXVtqXVtrXSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRZW2tdOwor
CQkJCQlsb2NhbHMtPlN3YXRoSGVpZ2h0Q1BlclN0YXRlW2ldW2pdW2tdID0gbG9jYWxzLT5NYXhT
d2F0aEhlaWdodENba107CisJCQkJfSBlbHNlIHsKKwkJCQkJbG9jYWxzLT5Td2F0aEhlaWdodFlQ
ZXJTdGF0ZVtpXVtqXVtrXSA9IGxvY2Fscy0+TWluU3dhdGhIZWlnaHRZW2tdOworCQkJCQlsb2Nh
bHMtPlN3YXRoSGVpZ2h0Q1BlclN0YXRlW2ldW2pdW2tdID0gbG9jYWxzLT5NaW5Td2F0aEhlaWdo
dENba107CisJCQkJfQorCisJCQkJaWYgKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRDW2tdID09
IDApIHsKKwkJCQkJbG9jYWxzLT5MaW5lc0luREVUTHVtYSA9IGxvY2Fscy0+REVUQnVmZmVyU2l6
ZUluS0J5dGUgKiAxMDI0IC8gbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10gLyBsb2NhbHMt
PlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba107CisJCQkJCWxvY2Fscy0+TGluZXNJbkRFVENo
cm9tYSA9IDA7CisJCQkJfSBlbHNlIGlmIChsb2NhbHMtPlN3YXRoSGVpZ2h0WVBlclN0YXRlW2ld
W2pdW2tdIDw9IGxvY2Fscy0+U3dhdGhIZWlnaHRDUGVyU3RhdGVbaV1bal1ba10pIHsKKwkJCQkJ
bG9jYWxzLT5MaW5lc0luREVUTHVtYSA9IGxvY2Fscy0+REVUQnVmZmVyU2l6ZUluS0J5dGUgKiAx
MDI0IC8gMiAvIGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdIC8KKwkJCQkJCQlsb2NhbHMt
PlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba107CisJCQkJCWxvY2Fscy0+TGluZXNJbkRFVENo
cm9tYSA9IGxvY2Fscy0+REVUQnVmZmVyU2l6ZUluS0J5dGUgKiAxMDI0IC8gMiAvIGxvY2Fscy0+
Qnl0ZVBlclBpeGVsSW5ERVRDW2tdIC8gKGxvY2Fscy0+U3dhdGhXaWR0aFlQZXJTdGF0ZVtpXVtq
XVtrXSAvIDIpOworCQkJCX0gZWxzZSB7CisJCQkJCWxvY2Fscy0+TGluZXNJbkRFVEx1bWEgPSBs
b2NhbHMtPkRFVEJ1ZmZlclNpemVJbktCeXRlICogMTAyNCAqIDIgLyAzIC8gbG9jYWxzLT5CeXRl
UGVyUGl4ZWxJbkRFVFlba10gLyBsb2NhbHMtPlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba107
CisJCQkJCWxvY2Fscy0+TGluZXNJbkRFVENocm9tYSA9IGxvY2Fscy0+REVUQnVmZmVyU2l6ZUlu
S0J5dGUgKiAxMDI0IC8gMyAvIGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdIC8gKGxvY2Fs
cy0+U3dhdGhXaWR0aFlQZXJTdGF0ZVtpXVtqXVtrXSAvIDIpOworCQkJCX0KKworCQkJCWxvY2Fs
cy0+RWZmZWN0aXZlTEJMYXRlbmN5SGlkaW5nU291cmNlTGluZXNMdW1hID0gZG1sX21pbihsb2Nh
bHMtPk1heExpbmVCdWZmZXJMaW5lcywKKwkJCQkJZG1sX2Zsb29yKGxvY2Fscy0+TGluZUJ1ZmZl
clNpemUgLyBsb2NhbHMtPkxCQml0UGVyUGl4ZWxba10gLyAobG9jYWxzLT5Td2F0aFdpZHRoWVBl
clN0YXRlW2ldW2pdW2tdCisJCQkJCS8gZG1sX21heChsb2NhbHMtPkhSYXRpb1trXSwgMSkpLCAx
KSkgLSAobG9jYWxzLT52dGFwc1trXSAtIDEpOworCisJCQkJbG9jYWxzLT5FZmZlY3RpdmVMQkxh
dGVuY3lIaWRpbmdTb3VyY2VMaW5lc0Nocm9tYSA9ICBkbWxfbWluKGxvY2Fscy0+TWF4TGluZUJ1
ZmZlckxpbmVzLAorCQkJCQkJZG1sX2Zsb29yKGxvY2Fscy0+TGluZUJ1ZmZlclNpemUgLyBsb2Nh
bHMtPkxCQml0UGVyUGl4ZWxba10KKwkJCQkJCS8gKGxvY2Fscy0+U3dhdGhXaWR0aFlQZXJTdGF0
ZVtpXVtqXVtrXSAvIDIKKwkJCQkJCS8gZG1sX21heChsb2NhbHMtPkhSYXRpb1trXSAvIDIsIDEp
KSwgMSkpIC0gKGxvY2Fscy0+VlRBUHNDaHJvbWFba10gLSAxKTsKKworCQkJCWxvY2Fscy0+RWZm
ZWN0aXZlREVUTEJMaW5lc0x1bWEgPSBkbWxfZmxvb3IobG9jYWxzLT5MaW5lc0luREVUTHVtYSAr
ICBkbWxfbWluKAorCQkJCQkJbG9jYWxzLT5MaW5lc0luREVUTHVtYSAqIGxvY2Fscy0+UmVxdWly
ZWRESVNQQ0xLW2ldW2pdICogbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10gKgorCQkJCQkJ
bG9jYWxzLT5QU0NMX0ZBQ1RPUltrXSAvIGxvY2Fscy0+UmV0dXJuQldQZXJTdGF0ZVtpXSwKKwkJ
CQkJCWxvY2Fscy0+RWZmZWN0aXZlTEJMYXRlbmN5SGlkaW5nU291cmNlTGluZXNMdW1hKSwKKwkJ
CQkJCWxvY2Fscy0+U3dhdGhIZWlnaHRZUGVyU3RhdGVbaV1bal1ba10pOworCisJCQkJbG9jYWxz
LT5FZmZlY3RpdmVERVRMQkxpbmVzQ2hyb21hID0gZG1sX2Zsb29yKGxvY2Fscy0+TGluZXNJbkRF
VENocm9tYSArIGRtbF9taW4oCisJCQkJCQlsb2NhbHMtPkxpbmVzSW5ERVRDaHJvbWEgKiBsb2Nh
bHMtPlJlcXVpcmVkRElTUENMS1tpXVtqXSAqIGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRDW2td
ICoKKwkJCQkJCWxvY2Fscy0+UFNDTF9GQUNUT1JfQ0hST01BW2tdIC8gbG9jYWxzLT5SZXR1cm5C
V1BlclN0YXRlW2ldLAorCQkJCQkJbG9jYWxzLT5FZmZlY3RpdmVMQkxhdGVuY3lIaWRpbmdTb3Vy
Y2VMaW5lc0Nocm9tYSksCisJCQkJCQlsb2NhbHMtPlN3YXRoSGVpZ2h0Q1BlclN0YXRlW2ldW2pd
W2tdKTsKKworCQkJCWlmIChsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSA9PSAwKSB7CisJ
CQkJCWxvY2Fscy0+VXJnZW50TGF0ZW5jeVN1cHBvcnRVc1BlclN0YXRlW2ldW2pdW2tdID0gbG9j
YWxzLT5FZmZlY3RpdmVERVRMQkxpbmVzTHVtYSAqIChsb2NhbHMtPkhUb3RhbFtrXSAvIGxvY2Fs
cy0+UGl4ZWxDbG9ja1trXSkKKwkJCQkJCQkvIGxvY2Fscy0+VlJhdGlvW2tdIC0gbG9jYWxzLT5F
ZmZlY3RpdmVERVRMQkxpbmVzTHVtYSAqIGxvY2Fscy0+U3dhdGhXaWR0aFlQZXJTdGF0ZVtpXVtq
XVtrXSAqCisJCQkJCQkJCWRtbF9jZWlsKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdLCAx
KSAvIChsb2NhbHMtPlJldHVybkJXUGVyU3RhdGVbaV0gLyBsb2NhbHMtPk5vT2ZEUFBbaV1bal1b
a10pOworCQkJCX0gZWxzZSB7CisJCQkJCWxvY2Fscy0+VXJnZW50TGF0ZW5jeVN1cHBvcnRVc1Bl
clN0YXRlW2ldW2pdW2tdID0gZG1sX21pbigKKwkJCQkJCWxvY2Fscy0+RWZmZWN0aXZlREVUTEJM
aW5lc0x1bWEgKiAobG9jYWxzLT5IVG90YWxba10gLyBsb2NhbHMtPlBpeGVsQ2xvY2tba10pCisJ
CQkJCQkvIGxvY2Fscy0+VlJhdGlvW2tdIC0gbG9jYWxzLT5FZmZlY3RpdmVERVRMQkxpbmVzTHVt
YSAqIGxvY2Fscy0+U3dhdGhXaWR0aFlQZXJTdGF0ZVtpXVtqXVtrXSAqCisJCQkJCQlkbWxfY2Vp
bChsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSwgMSkgLyAobG9jYWxzLT5SZXR1cm5CV1Bl
clN0YXRlW2ldIC8gbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdKSwKKwkJCQkJCQlsb2NhbHMtPkVm
ZmVjdGl2ZURFVExCTGluZXNDaHJvbWEgKiAobG9jYWxzLT5IVG90YWxba10gLyBsb2NhbHMtPlBp
eGVsQ2xvY2tba10pIC8gKGxvY2Fscy0+VlJhdGlvW2tdIC8gMikgLQorCQkJCQkJCWxvY2Fscy0+
RWZmZWN0aXZlREVUTEJMaW5lc0Nocm9tYSAqIGxvY2Fscy0+U3dhdGhXaWR0aFlQZXJTdGF0ZVtp
XVtqXVtrXSAvIDIgKgorCQkJCQkJCWRtbF9jZWlsKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRD
W2tdLCAyKSAvIChsb2NhbHMtPlJldHVybkJXUGVyU3RhdGVbaV0gLyBsb2NhbHMtPk5vT2ZEUFBb
aV1bal1ba10pKTsKKwkJCQl9CisJCQl9CisJCX0KKwl9CisKKwlmb3IgKGkgPSAwOyBpIDw9IGxv
Y2Fscy0+c29jLm51bV9zdGF0ZXM7IGkrKykgeworCQlmb3IgKGogPSAwOyBqIDwgMjsgaisrKSB7
CisJCQlsb2NhbHMtPlVyZ2VudExhdGVuY3lTdXBwb3J0W2ldW2pdID0gdHJ1ZTsKKwkJCWZvciAo
ayA9IDA7IGsgPCBsb2NhbHMtPk51bWJlck9mQWN0aXZlUGxhbmVzOyBrKyspIHsKKwkJCQlpZiAo
bG9jYWxzLT5VcmdlbnRMYXRlbmN5U3VwcG9ydFVzUGVyU3RhdGVbaV1bal1ba10gPCBsb2NhbHMt
PlVyZ2VudExhdGVuY3kpCisJCQkJCWxvY2Fscy0+VXJnZW50TGF0ZW5jeVN1cHBvcnRbaV1bal0g
PSBmYWxzZTsKKwkJCX0KKwkJfQorCX0KKworCisJLypQcmVmZXRjaCBDaGVjayovCisJZm9yIChp
ID0gMDsgaSA8PSBsb2NhbHMtPnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJZm9yIChqID0gMDsg
aiA8IDI7IGorKykgeworCQkJbG9jYWxzLT5Ub3RhbE51bWJlck9mRENDQWN0aXZlRFBQW2ldW2pd
ID0gMDsKKwkJCWZvciAoayA9IDA7IGsgPCBsb2NhbHMtPk51bWJlck9mQWN0aXZlUGxhbmVzOyBr
KyspIHsKKwkJCQlpZiAobG9jYWxzLT5EQ0NFbmFibGVba10gPT0gdHJ1ZSkgeworCQkJCQlsb2Nh
bHMtPlRvdGFsTnVtYmVyT2ZEQ0NBY3RpdmVEUFBbaV1bal0gPQorCQkJCQkJbG9jYWxzLT5Ub3Rh
bE51bWJlck9mRENDQWN0aXZlRFBQW2ldW2pdICsgbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdOwor
CQkJCX0KKwkJCX0KKwkJfQorCX0KKworCUNhbGN1bGF0ZU1pbkFuZE1heFByZWZldGNoTW9kZShs
b2NhbHMtPkFsbG93RFJBTVNlbGZSZWZyZXNoT3JEUkFNQ2xvY2tDaGFuZ2VJblZibGFuaywgJmxv
Y2Fscy0+TWluUHJlZmV0Y2hNb2RlLCAmbG9jYWxzLT5NYXhQcmVmZXRjaE1vZGUpOworCisJZm9y
IChpID0gMDsgaSA8PSBsb2NhbHMtPnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJZm9yIChqID0g
MDsgaiA8IDI7IGorKykgeworCQkJZm9yIChrID0gMDsgayA8IGxvY2Fscy0+TnVtYmVyT2ZBY3Rp
dmVQbGFuZXM7IGsrKykgeworCQkJCWxvY2Fscy0+Tm9PZkRQUFRoaXNTdGF0ZVtrXSA9IGxvY2Fs
cy0+Tm9PZkRQUFtpXVtqXVtrXTsKKwkJCQlsb2NhbHMtPlJlcXVpcmVkRFBQQ0xLVGhpc1N0YXRl
W2tdID0gbG9jYWxzLT5SZXF1aXJlZERQUENMS1tpXVtqXVtrXTsKKwkJCQlsb2NhbHMtPlN3YXRo
SGVpZ2h0WVRoaXNTdGF0ZVtrXSA9IGxvY2Fscy0+U3dhdGhIZWlnaHRZUGVyU3RhdGVbaV1bal1b
a107CisJCQkJbG9jYWxzLT5Td2F0aEhlaWdodENUaGlzU3RhdGVba10gPSBsb2NhbHMtPlN3YXRo
SGVpZ2h0Q1BlclN0YXRlW2ldW2pdW2tdOworCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFlUaGlzU3Rh
dGVba10gPSBsb2NhbHMtPlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba107CisJCQkJbW9kZV9s
aWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtEZWVwU2xlZXAgPSBkbWxfbWF4KAorCQkJCQkJbW9kZV9s
aWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtEZWVwU2xlZXAsCisJCQkJCQltb2RlX2xpYi0+dmJhLlBp
eGVsQ2xvY2tba10gLyAxNi4wKTsKKwkJCQlpZiAobW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxJ
bkRFVENba10gPT0gMC4wKSB7CisJCQkJCWlmIChtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSA8PSAx
LjApIHsKKwkJCQkJCW1vZGVfbGliLT52YmEuUHJvamVjdGVkRENGQ0xLRGVlcFNsZWVwID0KKwkJ
CQkJCQkJZG1sX21heCgKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlByb2plY3RlZERDRkNMS0Rl
ZXBTbGVlcCwKKwkJCQkJCQkJCQkxLjEKKwkJCQkJCQkJCQkJCSogZG1sX2NlaWwoCisJCQkJCQkJ
CQkJCQkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsSW5ERVRZW2tdLAorCQkJCQkJCQkJCQkJ
CQkxLjApCisJCQkJCQkJCQkJCQkvIDY0LjAKKwkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5I
UmF0aW9ba10KKwkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdCisJCQkJ
CQkJCQkJCQkvIG1vZGVfbGliLT52YmEuTm9PZkRQUFtpXVtqXVtrXSk7CisJCQkJCX0gZWxzZSB7
CisJCQkJCQltb2RlX2xpYi0+dmJhLlByb2plY3RlZERDRkNMS0RlZXBTbGVlcCA9CisJCQkJCQkJ
CWRtbF9tYXgoCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtEZWVwU2xl
ZXAsCisJCQkJCQkJCQkJMS4xCisJCQkJCQkJCQkJCQkqIGRtbF9jZWlsKAorCQkJCQkJCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbEluREVUWVtrXSwKKwkJCQkJCQkJCQkJCQkJMS4w
KQorCQkJCQkJCQkJCQkJLyA2NC4wCisJCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuUFNDTF9G
QUNUT1Jba10KKwkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5SZXF1aXJlZERQUENMS1tpXVtq
XVtrXSk7CisJCQkJCX0KKwkJCQl9IGVsc2UgeworCQkJCQlpZiAobW9kZV9saWItPnZiYS5WUmF0
aW9ba10gPD0gMS4wKSB7CisJCQkJCQltb2RlX2xpYi0+dmJhLlByb2plY3RlZERDRkNMS0RlZXBT
bGVlcCA9CisJCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Qcm9qZWN0
ZWREQ0ZDTEtEZWVwU2xlZXAsCisJCQkJCQkJCQkJMS4xCisJCQkJCQkJCQkJCQkqIGRtbF9jZWls
KAorCQkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbEluREVUWVtrXSwKKwkJ
CQkJCQkJCQkJCQkJMS4wKQorCQkJCQkJCQkJCQkJLyAzMi4wCisJCQkJCQkJCQkJCQkqIG1vZGVf
bGliLT52YmEuSFJhdGlvW2tdCisJCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9j
a1trXQorCQkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLk5vT2ZEUFBbaV1bal1ba10pOworCQkJ
CQl9IGVsc2UgeworCQkJCQkJbW9kZV9saWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtEZWVwU2xlZXAg
PQorCQkJCQkJCQlkbWxfbWF4KAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuUHJvamVjdGVkRENG
Q0xLRGVlcFNsZWVwLAorCQkJCQkJCQkJCTEuMQorCQkJCQkJCQkJCQkJKiBkbWxfY2VpbCgKKwkJ
CQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxJbkRFVFlba10sCisJCQkJCQkJ
CQkJCQkJCTEuMCkKKwkJCQkJCQkJCQkJCS8gMzIuMAorCQkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+
dmJhLlBTQ0xfRkFDVE9SW2tdCisJCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuUmVxdWlyZWRE
UFBDTEtbaV1bal1ba10pOworCQkJCQl9CisJCQkJCWlmIChtb2RlX2xpYi0+dmJhLlZSYXRpb1tr
XSAvIDIuMCA8PSAxLjApIHsKKwkJCQkJCW1vZGVfbGliLT52YmEuUHJvamVjdGVkRENGQ0xLRGVl
cFNsZWVwID0KKwkJCQkJCQkJZG1sX21heCgKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlByb2pl
Y3RlZERDRkNMS0RlZXBTbGVlcCwKKwkJCQkJCQkJCQkxLjEKKwkJCQkJCQkJCQkJCSogZG1sX2Nl
aWwoCisJCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsSW5ERVRDW2tdLAor
CQkJCQkJCQkJCQkJCQkyLjApCisJCQkJCQkJCQkJCQkvIDMyLjAKKwkJCQkJCQkJCQkJCSogbW9k
ZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJCQkJCS8gMi4wCisJCQkJCQkJCQkJCQkqIG1v
ZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXQorCQkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLk5v
T2ZEUFBbaV1bal1ba10pOworCQkJCQl9IGVsc2UgeworCQkJCQkJbW9kZV9saWItPnZiYS5Qcm9q
ZWN0ZWREQ0ZDTEtEZWVwU2xlZXAgPQorCQkJCQkJCQlkbWxfbWF4KAorCQkJCQkJCQkJCW1vZGVf
bGliLT52YmEuUHJvamVjdGVkRENGQ0xLRGVlcFNsZWVwLAorCQkJCQkJCQkJCTEuMQorCQkJCQkJ
CQkJCQkJKiBkbWxfY2VpbCgKKwkJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4
ZWxJbkRFVENba10sCisJCQkJCQkJCQkJCQkJCTIuMCkKKwkJCQkJCQkJCQkJCS8gMzIuMAorCQkJ
CQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlBTQ0xfRkFDVE9SX0NIUk9NQVtrXQorCQkJCQkJCQkJ
CQkJKiBtb2RlX2xpYi0+dmJhLlJlcXVpcmVkRFBQQ0xLW2ldW2pdW2tdKTsKKwkJCQkJfQorCQkJ
CX0KKwkJCX0KKwkJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2
ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJCW1vZGVfbGliLT52YmEuUERFQW5kTWV0YVBURUJ5dGVz
UGVyRnJhbWVZID0gQ2FsY3VsYXRlVk1BbmRSb3dCeXRlcygKKwkJCQkJCW1vZGVfbGliLAorCQkJ
CQkJbW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlJlYWQy
NTZCbG9ja0hlaWdodFlba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlJlYWQyNTZCbG9ja1dpZHRo
WVtrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10sCisJCQkJCQlt
b2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10sCisJCQkJCQlkbWxfY2VpbChtb2RlX2xpYi0+
dmJhLkJ5dGVQZXJQaXhlbEluREVUWVtrXSwgMS4wKSwKKwkJCQkJCW1vZGVfbGliLT52YmEuU291
cmNlU2NhbltrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuVmlld3BvcnRXaWR0aFtrXSwKKwkJCQkJ
CW1vZGVfbGliLT52YmEuVmlld3BvcnRIZWlnaHRba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlN3
YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLkdQVVZNRW5h
YmxlLAorCQkJCQkJbW9kZV9saWItPnZiYS5WTU1QYWdlU2l6ZSwKKwkJCQkJCW1vZGVfbGliLT52
YmEuUFRFQnVmZmVyU2l6ZUluUmVxdWVzdHNMdW1hLAorCQkJCQkJbW9kZV9saWItPnZiYS5QREVQ
cm9jZXNzaW5nQnVmSW42NEtCUmVxcywKKwkJCQkJCW1vZGVfbGliLT52YmEuUGl0Y2hZW2tdLAor
CQkJCQkJbW9kZV9saWItPnZiYS5EQ0NNZXRhUGl0Y2hZW2tdLAorCQkJCQkJJm1vZGVfbGliLT52
YmEuTWFjcm9UaWxlV2lkdGhZW2tdLAorCQkJCQkJJm1vZGVfbGliLT52YmEuTWV0YVJvd0J5dGVz
WSwKKwkJCQkJCSZtb2RlX2xpYi0+dmJhLkRQVEVCeXRlc1BlclJvd1ksCisJCQkJCQkmbW9kZV9s
aWItPnZiYS5QVEVCdWZmZXJTaXplTm90RXhjZWVkZWRZW2ldW2pdW2tdLAorCQkJCQkJJm1vZGVf
bGliLT52YmEuZHB0ZV9yb3dfaGVpZ2h0W2tdLAorCQkJCQkJJm1vZGVfbGliLT52YmEubWV0YV9y
b3dfaGVpZ2h0W2tdKTsKKwkJCQltb2RlX2xpYi0+dmJhLlByZWZldGNoTGluZXNZW2tdID0gQ2Fs
Y3VsYXRlUHJlZmV0Y2hTb3VyY2VMaW5lcygKKwkJCQkJCW1vZGVfbGliLAorCQkJCQkJbW9kZV9s
aWItPnZiYS5WUmF0aW9ba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLnZ0YXBzW2tdLAorCQkJCQkJ
bW9kZV9saWItPnZiYS5JbnRlcmxhY2Vba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlByb2dyZXNz
aXZlVG9JbnRlcmxhY2VVbml0SW5PUFAsCisJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0
WVBlclN0YXRlW2ldW2pdW2tdLAorCQkJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydFlTdGFydFlb
a10sCisJCQkJCQkmbW9kZV9saWItPnZiYS5QcmVmaWxsWVtrXSwKKwkJCQkJCSZtb2RlX2xpYi0+
dmJhLk1heE51bVN3WVtrXSk7CisJCQkJaWYgKChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9y
bWF0W2tdICE9IGRtXzQ0NF82NAorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZv
cm1hdFtrXSAhPSBkbV80NDRfMzIKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxG
b3JtYXRba10gIT0gZG1fNDQ0XzE2CisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVs
Rm9ybWF0W2tdICE9IGRtX21vbm9fMTYKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4
ZWxGb3JtYXRba10gIT0gZG1fbW9ub184KSkgeworCQkJCQltb2RlX2xpYi0+dmJhLlBERUFuZE1l
dGFQVEVCeXRlc1BlckZyYW1lQyA9IENhbGN1bGF0ZVZNQW5kUm93Qnl0ZXMoCisJCQkJCQkJbW9k
ZV9saWIsCisJCQkJCQkJbW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10sCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5SZWFkMjU2QmxvY2tIZWlnaHRZW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUmVh
ZDI1NkJsb2NrV2lkdGhZW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3Jt
YXRba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdLAorCQkJCQkJCWRt
bF9jZWlsKG1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsSW5ERVRDW2tdLCAyLjApLAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuU291cmNlU2NhbltrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZpZXdw
b3J0V2lkdGhba10gLyAyLjAsCisJCQkJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydEhlaWdodFtr
XSAvIDIuMCwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1b
a10gLyAyLjAsCisJCQkJCQkJbW9kZV9saWItPnZiYS5HUFVWTUVuYWJsZSwKKwkJCQkJCQltb2Rl
X2xpYi0+dmJhLlZNTVBhZ2VTaXplLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUFRFQnVmZmVyU2l6
ZUluUmVxdWVzdHNMdW1hLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUERFUHJvY2Vzc2luZ0J1Zklu
NjRLQlJlcXMsCisJCQkJCQkJbW9kZV9saWItPnZiYS5QaXRjaENba10sCisJCQkJCQkJMC4wLAor
CQkJCQkJCSZtb2RlX2xpYi0+dmJhLk1hY3JvVGlsZVdpZHRoQ1trXSwKKwkJCQkJCQkmbW9kZV9s
aWItPnZiYS5NZXRhUm93Qnl0ZXNDLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLkRQVEVCeXRlc1Bl
clJvd0MsCisJCQkJCQkJJm1vZGVfbGliLT52YmEuUFRFQnVmZmVyU2l6ZU5vdEV4Y2VlZGVkQ1tp
XVtqXVtrXSwKKwkJCQkJCQkmbW9kZV9saWItPnZiYS5kcHRlX3Jvd19oZWlnaHRfY2hyb21hW2td
LAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLm1ldGFfcm93X2hlaWdodF9jaHJvbWFba10pOworCQkJ
CQltb2RlX2xpYi0+dmJhLlByZWZldGNoTGluZXNDW2tdID0gQ2FsY3VsYXRlUHJlZmV0Y2hTb3Vy
Y2VMaW5lcygKKwkJCQkJCQltb2RlX2xpYiwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZSYXRpb1tr
XSAvIDIuMCwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZUQVBzQ2hyb21hW2tdLAorCQkJCQkJCW1v
ZGVfbGliLT52YmEuSW50ZXJsYWNlW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUHJvZ3Jlc3Np
dmVUb0ludGVybGFjZVVuaXRJbk9QUCwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0
Q1BlclN0YXRlW2ldW2pdW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuVmlld3BvcnRZU3RhcnRD
W2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlByZWZpbGxDW2tdLAorCQkJCQkJCSZtb2RlX2xp
Yi0+dmJhLk1heE51bVN3Q1trXSk7CisJCQkJfSBlbHNlIHsKKwkJCQkJbW9kZV9saWItPnZiYS5Q
REVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFtZUMgPSAwLjA7CisJCQkJCW1vZGVfbGliLT52YmEuTWV0
YVJvd0J5dGVzQyA9IDAuMDsKKwkJCQkJbW9kZV9saWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dDID0g
MC4wOworCQkJCQlsb2NhbHMtPlByZWZldGNoTGluZXNDW2tdID0gMC4wOworCQkJCQlsb2NhbHMt
PlBURUJ1ZmZlclNpemVOb3RFeGNlZWRlZENbaV1bal1ba10gPSB0cnVlOworCQkJCQlsb2NhbHMt
PlBURUJ1ZmZlclNpemVJblJlcXVlc3RzRm9yTHVtYSA9IG1vZGVfbGliLT52YmEuUFRFQnVmZmVy
U2l6ZUluUmVxdWVzdHNMdW1hICsgbW9kZV9saWItPnZiYS5QVEVCdWZmZXJTaXplSW5SZXF1ZXN0
c0Nocm9tYTsKKwkJCQl9CisJCQkJbG9jYWxzLT5QREVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFtZVtr
XSA9CisJCQkJCQltb2RlX2xpYi0+dmJhLlBERUFuZE1ldGFQVEVCeXRlc1BlckZyYW1lWSArIG1v
ZGVfbGliLT52YmEuUERFQW5kTWV0YVBURUJ5dGVzUGVyRnJhbWVDOworCQkJCWxvY2Fscy0+TWV0
YVJvd0J5dGVzW2tdID0gbW9kZV9saWItPnZiYS5NZXRhUm93Qnl0ZXNZICsgbW9kZV9saWItPnZi
YS5NZXRhUm93Qnl0ZXNDOworCQkJCWxvY2Fscy0+RFBURUJ5dGVzUGVyUm93W2tdID0gbW9kZV9s
aWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dZICsgbW9kZV9saWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dD
OworCisJCQkJQ2FsY3VsYXRlQWN0aXZlUm93QmFuZHdpZHRoKAorCQkJCQkJbW9kZV9saWItPnZi
YS5HUFVWTUVuYWJsZSwKKwkJCQkJCW1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10s
CisJCQkJCQltb2RlX2xpYi0+dmJhLlZSYXRpb1trXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuREND
RW5hYmxlW2tdLAorCQkJCQkJbW9kZV9saWItPnZiYS5IVG90YWxba10gLyBtb2RlX2xpYi0+dmJh
LlBpeGVsQ2xvY2tba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLk1ldGFSb3dCeXRlc1ksCisJCQkJ
CQltb2RlX2xpYi0+dmJhLk1ldGFSb3dCeXRlc0MsCisJCQkJCQltb2RlX2xpYi0+dmJhLm1ldGFf
cm93X2hlaWdodFtrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEubWV0YV9yb3dfaGVpZ2h0X2Nocm9t
YVtrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuRFBURUJ5dGVzUGVyUm93WSwKKwkJCQkJCW1vZGVf
bGliLT52YmEuRFBURUJ5dGVzUGVyUm93QywKKwkJCQkJCW1vZGVfbGliLT52YmEuZHB0ZV9yb3df
aGVpZ2h0W2tdLAorCQkJCQkJbW9kZV9saWItPnZiYS5kcHRlX3Jvd19oZWlnaHRfY2hyb21hW2td
LAorCQkJCQkJJm1vZGVfbGliLT52YmEubWV0YV9yb3dfYndba10sCisJCQkJCQkmbW9kZV9saWIt
PnZiYS5kcHRlX3Jvd19id1trXSwKKwkJCQkJCSZtb2RlX2xpYi0+dmJhLnF1YWxfcm93X2J3W2td
KTsKKwkJCX0KKwkJCW1vZGVfbGliLT52YmEuRXh0cmFMYXRlbmN5ID0KKwkJCQkJbW9kZV9saWIt
PnZiYS5VcmdlbnRSb3VuZFRyaXBBbmRPdXRPZk9yZGVyTGF0ZW5jeVBlclN0YXRlW2ldCisJCQkJ
CQkJKyAobW9kZV9saWItPnZiYS5Ub3RhbE51bWJlck9mQWN0aXZlRFBQW2ldW2pdCisJCQkJCQkJ
CQkqIG1vZGVfbGliLT52YmEuUGl4ZWxDaHVua1NpemVJbktCeXRlCisJCQkJCQkJCQkrIG1vZGVf
bGliLT52YmEuVG90YWxOdW1iZXJPZkRDQ0FjdGl2ZURQUFtpXVtqXQorCQkJCQkJCQkJCQkqIG1v
ZGVfbGliLT52YmEuTWV0YUNodW5rU2l6ZSkKKwkJCQkJCQkJCSogMTAyNC4wCisJCQkJCQkJCQkv
IG1vZGVfbGliLT52YmEuUmV0dXJuQldQZXJTdGF0ZVtpXTsKKwkJCWlmIChtb2RlX2xpYi0+dmJh
LkdQVVZNRW5hYmxlID09IHRydWUpIHsKKwkJCQltb2RlX2xpYi0+dmJhLkV4dHJhTGF0ZW5jeSA9
IG1vZGVfbGliLT52YmEuRXh0cmFMYXRlbmN5CisJCQkJCQkrIG1vZGVfbGliLT52YmEuVG90YWxO
dW1iZXJPZkFjdGl2ZURQUFtpXVtqXQorCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuUFRFR3JvdXBT
aXplCisJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5SZXR1cm5CV1BlclN0YXRlW2ldOworCQkJfQor
CQkJbW9kZV9saWItPnZiYS5UaW1lQ2FsYyA9IDI0LjAgLyBtb2RlX2xpYi0+dmJhLlByb2plY3Rl
ZERDRkNMS0RlZXBTbGVlcDsKKworCQkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJaWYgKG1vZGVfbGliLT52YmEuQmxl
bmRpbmdBbmRUaW1pbmdba10gPT0gaykgeworCQkJCQlpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJh
Y2tFbmFibGVba10gPT0gdHJ1ZSkgeworCQkJCQkJbG9jYWxzLT5Xcml0ZWJhY2tEZWxheVtpXVtr
XSA9IG1vZGVfbGliLT52YmEuV3JpdGViYWNrTGF0ZW5jeQorCQkJCQkJCQkrIENhbGN1bGF0ZVdy
aXRlQmFja0RlbGF5KAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3Jt
YXRba10sCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10sCisJCQkJ
CQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWUmF0aW9ba10sCisJCQkJCQkJCQkJbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRhcHNba10sCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tMdW1hVlRhcHNba10sCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tD
aHJvbWFIVGFwc1trXSwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYVZU
YXBzW2tdLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0
aFtrXSkgLyBsb2NhbHMtPlJlcXVpcmVkRElTUENMS1tpXVtqXTsKKwkJCQkJfSBlbHNlIHsKKwkJ
CQkJCWxvY2Fscy0+V3JpdGViYWNrRGVsYXlbaV1ba10gPSAwLjA7CisJCQkJCX0KKwkJCQkJZm9y
IChtID0gMDsgbSA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgbSsr
KSB7CisJCQkJCQlpZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1ttXSA9PSBrCisJ
CQkJCQkJCSYmIG1vZGVfbGliLT52YmEuV3JpdGViYWNrRW5hYmxlW21dCisJCQkJCQkJCQkJPT0g
dHJ1ZSkgeworCQkJCQkJCWxvY2Fscy0+V3JpdGViYWNrRGVsYXlbaV1ba10gPSBkbWxfbWF4KGxv
Y2Fscy0+V3JpdGViYWNrRGVsYXlbaV1ba10sCisJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3Jp
dGViYWNrTGF0ZW5jeSArIENhbGN1bGF0ZVdyaXRlQmFja0RlbGF5KAorCQkJCQkJCQkJCQkJCW1v
ZGVfbGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRbbV0sCisJCQkJCQkJCQkJCQkJbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9bbV0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tWUmF0aW9bbV0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tM
dW1hSFRhcHNbbV0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVlRh
cHNbbV0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFIVGFwc1tt
XSwKKwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYVZUYXBzW21dLAor
CQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFttXSkg
LyBsb2NhbHMtPlJlcXVpcmVkRElTUENMS1tpXVtqXSk7CisJCQkJCQl9CisJCQkJCX0KKwkJCQl9
CisJCQl9CisJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXMgLSAxOyBrKyspIHsKKwkJCQlmb3IgKG0gPSAwOyBtIDw9IG1vZGVfbGliLT52YmEuTnVt
YmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBtKyspIHsKKwkJCQkJaWYgKG1vZGVfbGliLT52YmEuQmxl
bmRpbmdBbmRUaW1pbmdba10gPT0gbSkgeworCQkJCQkJbG9jYWxzLT5Xcml0ZWJhY2tEZWxheVtp
XVtrXSA9IGxvY2Fscy0+V3JpdGViYWNrRGVsYXlbaV1bbV07CisJCQkJCX0KKwkJCQl9CisJCQl9
CisJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMg
LSAxOyBrKyspIHsKKwkJCQlmb3IgKG0gPSAwOyBtIDwgbG9jYWxzLT5OdW1iZXJPZkN1cnNvcnNb
a107IG0rKykKKwkJCQkJbG9jYWxzLT5jdXJzb3JfYndba10gPSBsb2NhbHMtPk51bWJlck9mQ3Vy
c29yc1trXSAqIGxvY2Fscy0+Q3Vyc29yV2lkdGhba11bbV0gKiBsb2NhbHMtPkN1cnNvckJQUFtr
XVttXQorCQkJCQkJLyA4IC8gKGxvY2Fscy0+SFRvdGFsW2tdIC8gbG9jYWxzLT5QaXhlbENsb2Nr
W2tdKSAqIGxvY2Fscy0+VlJhdGlvW2tdOworCQkJfQorCisJCQlmb3IgKGsgPSAwOyBrIDw9IG1v
ZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQlsb2NhbHMt
Pk1heGltdW1WU3RhcnR1cFtrXSA9IG1vZGVfbGliLT52YmEuVlRvdGFsW2tdIC0gbW9kZV9saWIt
PnZiYS5WQWN0aXZlW2tdCisJCQkJCS0gZG1sX21heCgxLjAsIGRtbF9jZWlsKGxvY2Fscy0+V3Jp
dGViYWNrRGVsYXlbaV1ba10gLyAobW9kZV9saWItPnZiYS5IVG90YWxba10gLyBtb2RlX2xpYi0+
dmJhLlBpeGVsQ2xvY2tba10pLCAxLjApKTsKKwkJCX0KKworCQkJbW9kZV9saWItPnZiYS5OZXh0
UHJlZmV0Y2hNb2RlID0gbW9kZV9saWItPnZiYS5NaW5QcmVmZXRjaE1vZGU7CisJCQlkbyB7CisJ
CQkJbW9kZV9saWItPnZiYS5QcmVmZXRjaE1vZGVbaV1bal0gPSBtb2RlX2xpYi0+dmJhLk5leHRQ
cmVmZXRjaE1vZGU7CisJCQkJbW9kZV9saWItPnZiYS5OZXh0UHJlZmV0Y2hNb2RlID0gbW9kZV9s
aWItPnZiYS5OZXh0UHJlZmV0Y2hNb2RlICsgMTsKKworCQkJCW1vZGVfbGliLT52YmEuVFdhaXQg
PSBDYWxjdWxhdGVUV2FpdCgKKwkJCQkJCW1vZGVfbGliLT52YmEuUHJlZmV0Y2hNb2RlW2ldW2pd
LAorCQkJCQkJbW9kZV9saWItPnZiYS5EUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5LAorCQkJCQkJbW9k
ZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5LAorCQkJCQkJbW9kZV9saWItPnZiYS5TUkVudGVyUGx1
c0V4aXRUaW1lKTsKKwkJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZB
Y3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKworCQkJCQlpZiAobW9kZV9saWItPnZiYS5YRkNFbmFi
bGVkW2tdID09IHRydWUpIHsKKwkJCQkJCW1vZGVfbGliLT52YmEuWEZDUmVtb3RlU3VyZmFjZUZs
aXBEZWxheSA9CisJCQkJCQkJCUNhbGN1bGF0ZVJlbW90ZVN1cmZhY2VGbGlwRGVsYXkoCisJCQkJ
CQkJCQkJbW9kZV9saWIsCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10sCisJCQkJ
CQkJCQkJbG9jYWxzLT5Td2F0aFdpZHRoWVBlclN0YXRlW2ldW2pdW2tdLAorCQkJCQkJCQkJCWRt
bF9jZWlsKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdLCAxLjApLAorCQkJCQkJCQkJCW1v
ZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdLAorCQkJ
CQkJCQkJCW1vZGVfbGliLT52YmEuWEZDVFNsdlZ1cGRhdGVPZmZzZXQsCisJCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5YRkNUU2x2VnVwZGF0ZVdpZHRoLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEu
WEZDVFNsdlZyZWFkeU9mZnNldCwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1hCVUZMYXRl
bmN5VG9sZXJhbmNlLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuWEZDRmlsbEJXT3ZlcmhlYWQs
CisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5YRkNTbHZDaHVua1NpemUsCisJCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5YRkNCdXNUcmFuc3BvcnRUaW1lLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEu
VGltZUNhbGMsCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5UV2FpdCwKKwkJCQkJCQkJCQkmbW9k
ZV9saWItPnZiYS5TcmNBY3RpdmVEcmFpblJhdGUsCisJCQkJCQkJCQkJJm1vZGVfbGliLT52YmEu
VEluaXRYRmlsbCwKKwkJCQkJCQkJCQkmbW9kZV9saWItPnZiYS5Uc2x2Q2hrKTsKKwkJCQkJfSBl
bHNlIHsKKwkJCQkJCW1vZGVfbGliLT52YmEuWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSA9IDAu
MDsKKwkJCQkJfQorCQkJCQltb2RlX2xpYi0+dmJhLklzRXJyb3JSZXN1bHRbaV1bal1ba10gPQor
CQkJCQkJCUNhbGN1bGF0ZVByZWZldGNoU2NoZWR1bGUoCisJCQkJCQkJCQltb2RlX2xpYiwKKwkJ
CQkJCQkJCW1vZGVfbGliLT52YmEuUmVxdWlyZWREUFBDTEtbaV1bal1ba10sCisJCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLlJlcXVpcmVkRElTUENMS1tpXVtqXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja1trXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuUHJvamVjdGVkRENGQ0xL
RGVlcFNsZWVwLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5EU0NEZWxheVBlclN0YXRlW2ldW2td
LAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Ob09mRFBQW2ldW2pdW2tdLAorCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5TY2FsZXJFbmFibGVkW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5OdW1i
ZXJPZkN1cnNvcnNba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRQUENMS0RlbGF5U3VidG90
YWwsCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRQUENMS0RlbGF5U0NMLAorCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5EUFBDTEtEZWxheVNDTExCT25seSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEu
RFBQQ0xLRGVsYXlDTlZDRm9ybWF0ZXIsCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRQUENMS0Rl
bGF5Q05WQ0N1cnNvciwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuRElTUENMS0RlbGF5U3VidG90
YWwsCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba10K
KwkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkhSYXRpb1trXSwKKwkJCQkJCQkJCW1vZGVfbGli
LT52YmEuT3V0cHV0Rm9ybWF0W2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5WVG90YWxba10K
KwkJCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLlZBY3RpdmVba10sCisJCQkJCQkJCQltb2RlX2xp
Yi0+dmJhLkhUb3RhbFtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuTWF4SW50ZXJEQ05UaWxl
UmVwZWF0ZXJzLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5NYXhpbXVtVlN0YXJ0dXBba10sCisJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLkdQVVZNTWF4UGFnZVRhYmxlTGV2ZWxzLAorCQkJCQkJCQkJ
bW9kZV9saWItPnZiYS5HUFVWTUVuYWJsZSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuRHluYW1p
Y01ldGFkYXRhRW5hYmxlW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5EeW5hbWljTWV0YWRh
dGFMaW5lc0JlZm9yZUFjdGl2ZVJlcXVpcmVkW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5E
eW5hbWljTWV0YWRhdGFUcmFuc21pdHRlZEJ5dGVzW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5EQ0NFbmFibGVba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3lQaXhl
bERhdGFPbmx5LAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5FeHRyYUxhdGVuY3ksCisJCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLlRpbWVDYWxjLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5QREVBbmRN
ZXRhUFRFQnl0ZXNQZXJGcmFtZVtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuTWV0YVJvd0J5
dGVzW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dba10sCisJCQkJ
CQkJCQltb2RlX2xpYi0+dmJhLlByZWZldGNoTGluZXNZW2tdLAorCQkJCQkJCQkJbW9kZV9saWIt
PnZiYS5Td2F0aFdpZHRoWVBlclN0YXRlW2ldW2pdW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5CeXRlUGVyUGl4ZWxJbkRFVFlba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlByZWZpbGxZ
W2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5NYXhOdW1Td1lba10sCisJCQkJCQkJCQltb2Rl
X2xpYi0+dmJhLlByZWZldGNoTGluZXNDW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5CeXRl
UGVyUGl4ZWxJbkRFVENba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlByZWZpbGxDW2tdLAor
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5NYXhOdW1Td0Nba10sCisJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLlN3YXRoSGVpZ2h0WVBlclN0YXRlW2ldW2pdW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5Td2F0aEhlaWdodENQZXJTdGF0ZVtpXVtqXVtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEu
VFdhaXQsCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ0VuYWJsZWRba10sCisJCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLlhGQ1JlbW90ZVN1cmZhY2VGbGlwRGVsYXksCisJCQkJCQkJCQltb2RlX2xp
Yi0+dmJhLkludGVybGFjZVtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuUHJvZ3Jlc3NpdmVU
b0ludGVybGFjZVVuaXRJbk9QUCwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuRFNUWEFmdGVyU2Nh
bGVyLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5EU1RZQWZ0ZXJTY2FsZXIsCisJCQkJCQkJCQkm
bW9kZV9saWItPnZiYS5MaW5lVGltZXNGb3JQcmVmZXRjaFtrXSwKKwkJCQkJCQkJCSZtb2RlX2xp
Yi0+dmJhLlByZWZldGNoQldba10sCisJCQkJCQkJCQkmbW9kZV9saWItPnZiYS5MaW5lc0Zvck1l
dGFQVEVba10sCisJCQkJCQkJCQkmbW9kZV9saWItPnZiYS5MaW5lc0Zvck1ldGFBbmREUFRFUm93
W2tdLAorCQkJCQkJCQkJJm1vZGVfbGliLT52YmEuVlJhdGlvUHJlWVtpXVtqXVtrXSwKKwkJCQkJ
CQkJCSZtb2RlX2xpYi0+dmJhLlZSYXRpb1ByZUNbaV1bal1ba10sCisJCQkJCQkJCQkmbW9kZV9s
aWItPnZiYS5SZXF1aXJlZFByZWZldGNoUGl4ZWxEYXRhQldMdW1hW2ldW2pdW2tdLAorCQkJCQkJ
CQkJJm1vZGVfbGliLT52YmEuVlN0YXJ0dXBSZXF1aXJlZFdoZW5Ob3RFbm91Z2hUaW1lRm9yRHlu
YW1pY01ldGFkYXRhLAorCQkJCQkJCQkJJm1vZGVfbGliLT52YmEuVG5vX2J3W2tdLAorCQkJCQkJ
CQkJJm1vZGVfbGliLT52YmEuVlVwZGF0ZU9mZnNldFBpeFtrXSwKKwkJCQkJCQkJCSZtb2RlX2xp
Yi0+dmJhLlZVcGRhdGVXaWR0aFBpeFtrXSwKKwkJCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlZSZWFk
eU9mZnNldFBpeFtrXSk7CisJCQkJfQorCQkJCW1vZGVfbGliLT52YmEuTWF4aW11bVJlYWRCYW5k
d2lkdGhXaXRob3V0UHJlZmV0Y2ggPSAwLjA7CisJCQkJbW9kZV9saWItPnZiYS5NYXhpbXVtUmVh
ZEJhbmR3aWR0aFdpdGhQcmVmZXRjaCA9IDAuMDsKKwkJCQlsb2NhbHMtPnByZWZldGNoX3ZtX2J3
X3ZhbGlkID0gdHJ1ZTsKKwkJCQlsb2NhbHMtPnByZWZldGNoX3Jvd19id192YWxpZCA9IHRydWU7
CisJCQkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVz
IC0gMTsgaysrKSB7CisJCQkJCWlmIChsb2NhbHMtPlBERUFuZE1ldGFQVEVCeXRlc1BlckZyYW1l
W2tdID09IDApCisJCQkJCQlsb2NhbHMtPnByZWZldGNoX3ZtX2J3W2tdID0gMDsKKwkJCQkJZWxz
ZSBpZiAobG9jYWxzLT5MaW5lc0Zvck1ldGFQVEVba10gPiAwKQorCQkJCQkJbG9jYWxzLT5wcmVm
ZXRjaF92bV9id1trXSA9IGxvY2Fscy0+UERFQW5kTWV0YVBURUJ5dGVzUGVyRnJhbWVba10KKwkJ
CQkJCQkvIChsb2NhbHMtPkxpbmVzRm9yTWV0YVBURVtrXSAqIGxvY2Fscy0+SFRvdGFsW2tdIC8g
bG9jYWxzLT5QaXhlbENsb2NrW2tdKTsKKwkJCQkJZWxzZSB7CisJCQkJCQlsb2NhbHMtPnByZWZl
dGNoX3ZtX2J3W2tdID0gMDsKKwkJCQkJCWxvY2Fscy0+cHJlZmV0Y2hfdm1fYndfdmFsaWQgPSBm
YWxzZTsKKwkJCQkJfQorCQkJCQlpZiAobG9jYWxzLT5NZXRhUm93Qnl0ZXNba10gKyBsb2NhbHMt
PkRQVEVCeXRlc1BlclJvd1trXSA9PSAwKQorCQkJCQkJbG9jYWxzLT5wcmVmZXRjaF9yb3dfYndb
a10gPSAwOworCQkJCQllbHNlIGlmIChsb2NhbHMtPkxpbmVzRm9yTWV0YUFuZERQVEVSb3dba10g
PiAwKQorCQkJCQkJbG9jYWxzLT5wcmVmZXRjaF9yb3dfYndba10gPSAobG9jYWxzLT5NZXRhUm93
Qnl0ZXNba10gKyBsb2NhbHMtPkRQVEVCeXRlc1BlclJvd1trXSkKKwkJCQkJCQkvIChsb2NhbHMt
PkxpbmVzRm9yTWV0YUFuZERQVEVSb3dba10gKiBsb2NhbHMtPkhUb3RhbFtrXSAvIGxvY2Fscy0+
UGl4ZWxDbG9ja1trXSk7CisJCQkJCWVsc2UgeworCQkJCQkJbG9jYWxzLT5wcmVmZXRjaF9yb3df
Yndba10gPSAwOworCQkJCQkJbG9jYWxzLT5wcmVmZXRjaF9yb3dfYndfdmFsaWQgPSBmYWxzZTsK
KwkJCQkJfQorCisJCQkJCW1vZGVfbGliLT52YmEuTWF4aW11bVJlYWRCYW5kd2lkdGhXaXRob3V0
UHJlZmV0Y2ggPSBtb2RlX2xpYi0+dmJhLk1heGltdW1SZWFkQmFuZHdpZHRoV2l0aFByZWZldGNo
CisJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLmN1cnNvcl9id1trXSArIG1vZGVfbGliLT52YmEuUmVh
ZEJhbmR3aWR0aFtrXSArIG1vZGVfbGliLT52YmEubWV0YV9yb3dfYndba10gKyBtb2RlX2xpYi0+
dmJhLmRwdGVfcm93X2J3W2tdOworCQkJCQltb2RlX2xpYi0+dmJhLk1heGltdW1SZWFkQmFuZHdp
ZHRoV2l0aFByZWZldGNoID0KKwkJCQkJCQltb2RlX2xpYi0+dmJhLk1heGltdW1SZWFkQmFuZHdp
ZHRoV2l0aFByZWZldGNoCisJCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuY3Vyc29yX2J3W2tdCisJ
CQkJCQkJCQkrIGRtbF9tYXgzKAorCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLnByZWZldGNoX3Zt
X2J3W2tdLAorCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLnByZWZldGNoX3Jvd19id1trXSwKKwkJ
CQkJCQkJCQkJZG1sX21heChtb2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhba10sCisJCQkJCQkJ
CQkJCW1vZGVfbGliLT52YmEuUmVxdWlyZWRQcmVmZXRjaFBpeGVsRGF0YUJXTHVtYVtpXVtqXVtr
XSkKKwkJCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLm1ldGFfcm93X2J3W2tdICsgbW9kZV9saWIt
PnZiYS5kcHRlX3Jvd19id1trXSk7CisJCQkJfQorCQkJCWxvY2Fscy0+QmFuZHdpZHRoV2l0aG91
dFByZWZldGNoU3VwcG9ydGVkW2ldID0gdHJ1ZTsKKwkJCQlpZiAobW9kZV9saWItPnZiYS5NYXhp
bXVtUmVhZEJhbmR3aWR0aFdpdGhvdXRQcmVmZXRjaCA+IGxvY2Fscy0+UmV0dXJuQldQZXJTdGF0
ZVtpXSkgeworCQkJCQlsb2NhbHMtPkJhbmR3aWR0aFdpdGhvdXRQcmVmZXRjaFN1cHBvcnRlZFtp
XSA9IGZhbHNlOworCQkJCX0KKworCQkJCWxvY2Fscy0+UHJlZmV0Y2hTdXBwb3J0ZWRbaV1bal0g
PSB0cnVlOworCQkJCWlmIChtb2RlX2xpYi0+dmJhLk1heGltdW1SZWFkQmFuZHdpZHRoV2l0aFBy
ZWZldGNoID4gbG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldKSB7CisJCQkJCWxvY2Fscy0+UHJl
ZmV0Y2hTdXBwb3J0ZWRbaV1bal0gPSBmYWxzZTsKKwkJCQl9CisJCQkJZm9yIChrID0gMDsgayA8
PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJCWlm
IChsb2NhbHMtPkxpbmVUaW1lc0ZvclByZWZldGNoW2tdIDwgMi4wCisJCQkJCQkJfHwgbG9jYWxz
LT5MaW5lc0Zvck1ldGFQVEVba10gPj0gOC4wCisJCQkJCQkJfHwgbG9jYWxzLT5MaW5lc0Zvck1l
dGFBbmREUFRFUm93W2tdID49IDE2LjAKKwkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLklzRXJyb3JS
ZXN1bHRbaV1bal1ba10gPT0gdHJ1ZSkgeworCQkJCQkJbG9jYWxzLT5QcmVmZXRjaFN1cHBvcnRl
ZFtpXVtqXSA9IGZhbHNlOworCQkJCQl9CisJCQkJfQorCQkJCWxvY2Fscy0+VlJhdGlvSW5QcmVm
ZXRjaFN1cHBvcnRlZFtpXVtqXSA9IHRydWU7CisJCQkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xp
Yi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJCWlmIChsb2NhbHMt
PlZSYXRpb1ByZVlbaV1bal1ba10gPiA0LjAKKwkJCQkJCQl8fCBsb2NhbHMtPlZSYXRpb1ByZUNb
aV1bal1ba10gPiA0LjAKKwkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLklzRXJyb3JSZXN1bHRbaV1b
al1ba10gPT0gdHJ1ZSkgeworCQkJCQkJbG9jYWxzLT5WUmF0aW9JblByZWZldGNoU3VwcG9ydGVk
W2ldW2pdID0gZmFsc2U7CisJCQkJCX0KKwkJCQl9CisJCQl9IHdoaWxlICgobG9jYWxzLT5QcmVm
ZXRjaFN1cHBvcnRlZFtpXVtqXSAhPSB0cnVlIHx8IGxvY2Fscy0+VlJhdGlvSW5QcmVmZXRjaFN1
cHBvcnRlZFtpXVtqXSAhPSB0cnVlKQorCQkJCQkmJiBtb2RlX2xpYi0+dmJhLk5leHRQcmVmZXRj
aE1vZGUgPCBtb2RlX2xpYi0+dmJhLk1heFByZWZldGNoTW9kZSk7CisKKwkJCWlmIChtb2RlX2xp
Yi0+dmJhLlByZWZldGNoU3VwcG9ydGVkW2ldW2pdID09IHRydWUKKwkJCQkJJiYgbW9kZV9saWIt
PnZiYS5WUmF0aW9JblByZWZldGNoU3VwcG9ydGVkW2ldW2pdID09IHRydWUpIHsKKwkJCQltb2Rl
X2xpYi0+dmJhLkJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAgPQorCQkJCQkJbW9k
ZV9saWItPnZiYS5SZXR1cm5CV1BlclN0YXRlW2ldOworCQkJCWZvciAoayA9IDA7IGsgPD0gbW9k
ZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJCQltb2RlX2xp
Yi0+dmJhLkJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAgPQorCQkJCQkJCW1vZGVf
bGliLT52YmEuQmFuZHdpZHRoQXZhaWxhYmxlRm9ySW1tZWRpYXRlRmxpcAorCQkJCQkJCQkJLSBt
b2RlX2xpYi0+dmJhLmN1cnNvcl9id1trXQorCQkJCQkJCQkJLSBkbWxfbWF4KAorCQkJCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhba10gKyBtb2RlX2xpYi0+dmJhLnF1YWxfcm93
X2J3W2tdLAorCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlByZWZldGNoQldba10pOworCQkJCX0K
KwkJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMg
LSAxOyBrKyspIHsKKwkJCQkJbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwQnl0ZXNba10gPSAw
LjA7CisJCQkJCWlmICgobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80
MjBfOAorCQkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1f
NDIwXzEwKSkgeworCQkJCQkJbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwQnl0ZXNba10gPQor
CQkJCQkJCQltb2RlX2xpYi0+dmJhLlBERUFuZE1ldGFQVEVCeXRlc1BlckZyYW1lW2tdCisJCQkJ
CQkJCQkJKyBtb2RlX2xpYi0+dmJhLk1ldGFSb3dCeXRlc1trXQorCQkJCQkJCQkJCSsgbW9kZV9s
aWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dba107CisJCQkJCX0KKwkJCQl9CisJCQkJbW9kZV9saWIt
PnZiYS5Ub3RJbW1lZGlhdGVGbGlwQnl0ZXMgPSAwLjA7CisJCQkJZm9yIChrID0gMDsgayA8PSBt
b2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJCWlmICgo
bW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80MjBfOAorCQkJCQkJCSYm
IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fNDIwXzEwKSkgeworCQkJ
CQkJbW9kZV9saWItPnZiYS5Ub3RJbW1lZGlhdGVGbGlwQnl0ZXMgPQorCQkJCQkJCQltb2RlX2xp
Yi0+dmJhLlRvdEltbWVkaWF0ZUZsaXBCeXRlcworCQkJCQkJCQkJCSsgbW9kZV9saWItPnZiYS5J
bW1lZGlhdGVGbGlwQnl0ZXNba107CisJCQkJCX0KKwkJCQl9CisKKwkJCQlmb3IgKGsgPSAwOyBr
IDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQkJ
Q2FsY3VsYXRlRmxpcFNjaGVkdWxlKAorCQkJCQkJCW1vZGVfbGliLAorCQkJCQkJCW1vZGVfbGli
LT52YmEuRXh0cmFMYXRlbmN5LAorCQkJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeVBp
eGVsRGF0YU9ubHksCisJCQkJCQkJbW9kZV9saWItPnZiYS5HUFVWTU1heFBhZ2VUYWJsZUxldmVs
cywKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlLAorCQkJCQkJCW1vZGVfbGliLT52
YmEuQmFuZHdpZHRoQXZhaWxhYmxlRm9ySW1tZWRpYXRlRmxpcCwKKwkJCQkJCQltb2RlX2xpYi0+
dmJhLlRvdEltbWVkaWF0ZUZsaXBCeXRlcywKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlNvdXJjZVBp
eGVsRm9ybWF0W2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuSW1tZWRpYXRlRmxpcEJ5dGVzW2td
LAorCQkJCQkJCW1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJCQkvIG1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja1trXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZSYXRpb1trXSwKKwkJCQkJ
CQltb2RlX2xpYi0+dmJhLlRub19id1trXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlBERUFuZE1l
dGFQVEVCeXRlc1BlckZyYW1lW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuTWV0YVJvd0J5dGVz
W2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRFBURUJ5dGVzUGVyUm93W2tdLAorCQkJCQkJCW1v
ZGVfbGliLT52YmEuRENDRW5hYmxlW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuZHB0ZV9yb3df
aGVpZ2h0W2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEubWV0YV9yb3dfaGVpZ2h0W2tdLAorCQkJ
CQkJCW1vZGVfbGliLT52YmEucXVhbF9yb3dfYndba10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEu
RGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5JbW1lZGlhdGVGbGlwW2tdLAorCQkJCQkJCSZt
b2RlX2xpYi0+dmJhLkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJbkltbWVkaWF0ZUZsaXBb
a10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEuZmluYWxfZmxpcF9id1trXSwKKwkJCQkJCQkmbW9k
ZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkRm9yUGlwZVtrXSk7CisJCQkJfQorCQkJ
CW1vZGVfbGliLT52YmEudG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwID0gMC4wOworCQkJCWZv
ciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsr
KykgeworCQkJCQltb2RlX2xpYi0+dmJhLnRvdGFsX2Rjbl9yZWFkX2J3X3dpdGhfZmxpcCA9CisJ
CQkJCQkJbW9kZV9saWItPnZiYS50b3RhbF9kY25fcmVhZF9id193aXRoX2ZsaXAKKwkJCQkJCQkJ
CSsgbW9kZV9saWItPnZiYS5jdXJzb3JfYndba10KKwkJCQkJCQkJCSsgZG1sX21heDMoCisJCQkJ
CQkJCQkJCW1vZGVfbGliLT52YmEucHJlZmV0Y2hfdm1fYndba10sCisJCQkJCQkJCQkJCW1vZGVf
bGliLT52YmEucHJlZmV0Y2hfcm93X2J3W2tdLAorCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLmZp
bmFsX2ZsaXBfYndba10KKwkJCQkJCQkJCQkJCQkrIGRtbF9tYXgoCisJCQkJCQkJCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhba10sCisJCQkJCQkJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLlJlcXVpcmVkUHJlZmV0Y2hQaXhlbERhdGFCV0x1bWFbaV1bal1ba10pKTsKKwkJCQl9CisJ
CQkJbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkRm9yU3RhdGVbaV1bal0gPSB0
cnVlOworCQkJCWlmIChtb2RlX2xpYi0+dmJhLnRvdGFsX2Rjbl9yZWFkX2J3X3dpdGhfZmxpcAor
CQkJCQkJPiBtb2RlX2xpYi0+dmJhLlJldHVybkJXUGVyU3RhdGVbaV0pIHsKKwkJCQkJbW9kZV9s
aWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkRm9yU3RhdGVbaV1bal0gPSBmYWxzZTsKKwkJ
CQl9CisJCQkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxh
bmVzIC0gMTsgaysrKSB7CisJCQkJCWlmIChtb2RlX2xpYi0+dmJhLkltbWVkaWF0ZUZsaXBTdXBw
b3J0ZWRGb3JQaXBlW2tdID09IGZhbHNlKSB7CisJCQkJCQltb2RlX2xpYi0+dmJhLkltbWVkaWF0
ZUZsaXBTdXBwb3J0ZWRGb3JTdGF0ZVtpXVtqXSA9IGZhbHNlOworCQkJCQl9CisJCQkJfQorCQkJ
fSBlbHNlIHsKKwkJCQltb2RlX2xpYi0+dmJhLkltbWVkaWF0ZUZsaXBTdXBwb3J0ZWRGb3JTdGF0
ZVtpXVtqXSA9IGZhbHNlOworCQkJfQorCQl9CisJfQorCisJLypWZXJ0aWNhbCBBY3RpdmUgQlcg
c3VwcG9ydCovCisJbW9kZV9saWItPnZiYS5NYXhUb3RhbFZBY3RpdmVSREJhbmR3aWR0aCA9IDA7
CisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7IGsr
KykKKwkJbW9kZV9saWItPnZiYS5NYXhUb3RhbFZBY3RpdmVSREJhbmR3aWR0aCA9IG1vZGVfbGli
LT52YmEuTWF4VG90YWxWQWN0aXZlUkRCYW5kd2lkdGggKyBtb2RlX2xpYi0+dmJhLlJlYWRCYW5k
d2lkdGhba107CisJZm9yIChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVz
OyBpKyspIHsKKwkJbW9kZV9saWItPnZiYS5NYXhUb3RhbFZlcnRpY2FsQWN0aXZlQXZhaWxhYmxl
QmFuZHdpZHRoW2ldID0gZG1sX21pbihtb2RlX2xpYi0+dmJhLlJldHVybkJ1c1dpZHRoICoKKwkJ
CQltb2RlX2xpYi0+dmJhLkRDRkNMS1BlclN0YXRlW2ldLCBtb2RlX2xpYi0+dmJhLkZhYnJpY0Fu
ZERSQU1CYW5kd2lkdGhQZXJTdGF0ZVtpXSAqIDEwMDApICoKKwkJCQltb2RlX2xpYi0+dmJhLk1h
eEF2ZXJhZ2VQZXJjZW50T2ZJZGVhbERSQU1CV0Rpc3BsYXlDYW5Vc2VJbk5vcm1hbFN5c3RlbU9w
ZXJhdGlvbiAvIDEwMDsKKwkJaWYgKG1vZGVfbGliLT52YmEuTWF4VG90YWxWQWN0aXZlUkRCYW5k
d2lkdGggPD0gbW9kZV9saWItPnZiYS5NYXhUb3RhbFZlcnRpY2FsQWN0aXZlQXZhaWxhYmxlQmFu
ZHdpZHRoW2ldKQorCQkJbW9kZV9saWItPnZiYS5Ub3RhbFZlcnRpY2FsQWN0aXZlQmFuZHdpZHRo
U3VwcG9ydFtpXSA9IHRydWU7CisJCWVsc2UKKwkJCW1vZGVfbGliLT52YmEuVG90YWxWZXJ0aWNh
bEFjdGl2ZUJhbmR3aWR0aFN1cHBvcnRbaV0gPSBmYWxzZTsKKwl9CisKKwkvKlBURSBCdWZmZXIg
U2l6ZSBDaGVjayovCisKKwlmb3IgKGkgPSAwOyBpIDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9z
dGF0ZXM7IGkrKykgeworCQlmb3IgKGogPSAwOyBqIDwgMjsgaisrKSB7CisJCQlsb2NhbHMtPlBU
RUJ1ZmZlclNpemVOb3RFeGNlZWRlZFtpXVtqXSA9IHRydWU7CisJCQlmb3IgKGsgPSAwOyBrIDw9
IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQlpZiAo
bG9jYWxzLT5QVEVCdWZmZXJTaXplTm90RXhjZWVkZWRZW2ldW2pdW2tdID09IGZhbHNlCisJCQkJ
CQl8fCBsb2NhbHMtPlBURUJ1ZmZlclNpemVOb3RFeGNlZWRlZENbaV1bal1ba10gPT0gZmFsc2Up
IHsKKwkJCQkJbG9jYWxzLT5QVEVCdWZmZXJTaXplTm90RXhjZWVkZWRbaV1bal0gPSBmYWxzZTsK
KwkJCQl9CisJCQl9CisJCX0KKwl9CisJLypDdXJzb3IgU3VwcG9ydCBDaGVjayovCisJbW9kZV9s
aWItPnZiYS5DdXJzb3JTdXBwb3J0ID0gdHJ1ZTsKKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGli
LT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJZm9yIChqID0gMDsgaiA8
IDI7IGorKykgeworCQkJaWYgKG1vZGVfbGliLT52YmEuQ3Vyc29yV2lkdGhba11bal0gPiAwLjAp
IHsKKwkJCQlpZiAoZG1sX2Zsb29yKAorCQkJCQkJZG1sX2Zsb29yKAorCQkJCQkJCQltb2RlX2xp
Yi0+dmJhLkN1cnNvckJ1ZmZlclNpemUKKwkJCQkJCQkJCQktIG1vZGVfbGliLT52YmEuQ3Vyc29y
Q2h1bmtTaXplLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLkN1cnNvckNodW5rU2l6ZSkgKiAxMDI0
LjAKKwkJCQkJCQkJLyAobW9kZV9saWItPnZiYS5DdXJzb3JXaWR0aFtrXVtqXQorCQkJCQkJCQkJ
CSogbW9kZV9saWItPnZiYS5DdXJzb3JCUFBba11bal0KKwkJCQkJCQkJCQkvIDguMCksCisJCQkJ
CQkxLjApCisJCQkJCQkqIChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvIG1vZGVfbGliLT52YmEu
UGl4ZWxDbG9ja1trXSkKKwkJCQkJCS8gbW9kZV9saWItPnZiYS5WUmF0aW9ba10gPCBtb2RlX2xp
Yi0+dmJhLlVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5CisJCQkJCQl8fCAobW9kZV9saWItPnZi
YS5DdXJzb3JCUFBba11bal0gPT0gNjQuMAorCQkJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLkN1cnNv
cjY0QnBwU3VwcG9ydCA9PSBmYWxzZSkpIHsKKwkJCQkJbW9kZV9saWItPnZiYS5DdXJzb3JTdXBw
b3J0ID0gZmFsc2U7CisJCQkJfQorCQkJfQorCQl9CisJfQorCS8qVmFsaWQgUGl0Y2ggQ2hlY2sq
LworCisJbW9kZV9saWItPnZiYS5QaXRjaFN1cHBvcnQgPSB0cnVlOworCWZvciAoayA9IDA7IGsg
PD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlsb2Nh
bHMtPkFsaWduZWRZUGl0Y2hba10gPSBkbWxfY2VpbCgKKwkJCQlkbWxfbWF4KG1vZGVfbGliLT52
YmEuUGl0Y2hZW2tdLCBtb2RlX2xpYi0+dmJhLlZpZXdwb3J0V2lkdGhba10pLAorCQkJCWxvY2Fs
cy0+TWFjcm9UaWxlV2lkdGhZW2tdKTsKKwkJaWYgKGxvY2Fscy0+QWxpZ25lZFlQaXRjaFtrXSA+
IG1vZGVfbGliLT52YmEuUGl0Y2hZW2tdKSB7CisJCQltb2RlX2xpYi0+dmJhLlBpdGNoU3VwcG9y
dCA9IGZhbHNlOworCQl9CisJCWlmIChtb2RlX2xpYi0+dmJhLkRDQ0VuYWJsZVtrXSA9PSB0cnVl
KSB7CisJCQlsb2NhbHMtPkFsaWduZWREQ0NNZXRhUGl0Y2hba10gPSBkbWxfY2VpbCgKKwkJCQkJ
ZG1sX21heCgKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRDQ01ldGFQaXRjaFlba10sCisJCQkJCQkJ
bW9kZV9saWItPnZiYS5WaWV3cG9ydFdpZHRoW2tdKSwKKwkJCQkJNjQuMCAqIGxvY2Fscy0+UmVh
ZDI1NkJsb2NrV2lkdGhZW2tdKTsKKwkJfSBlbHNlIHsKKwkJCWxvY2Fscy0+QWxpZ25lZERDQ01l
dGFQaXRjaFtrXSA9IG1vZGVfbGliLT52YmEuRENDTWV0YVBpdGNoWVtrXTsKKwkJfQorCQlpZiAo
bG9jYWxzLT5BbGlnbmVkRENDTWV0YVBpdGNoW2tdID4gbW9kZV9saWItPnZiYS5EQ0NNZXRhUGl0
Y2hZW2tdKSB7CisJCQltb2RlX2xpYi0+dmJhLlBpdGNoU3VwcG9ydCA9IGZhbHNlOworCQl9CisJ
CWlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQ0NF82NAorCQkJ
CSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzMyCisJCQkJ
JiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80NDRfMTYKKwkJCQkm
JiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtX21vbm9fMTYKKwkJCQkm
JiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtX21vbm9fOCkgeworCQkJ
bG9jYWxzLT5BbGlnbmVkQ1BpdGNoW2tdID0gZG1sX2NlaWwoCisJCQkJCWRtbF9tYXgoCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5QaXRjaENba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9y
dFdpZHRoW2tdIC8gMi4wKSwKKwkJCQkJbG9jYWxzLT5NYWNyb1RpbGVXaWR0aENba10pOworCQl9
IGVsc2UgeworCQkJbG9jYWxzLT5BbGlnbmVkQ1BpdGNoW2tdID0gbW9kZV9saWItPnZiYS5QaXRj
aENba107CisJCX0KKwkJaWYgKGxvY2Fscy0+QWxpZ25lZENQaXRjaFtrXSA+IG1vZGVfbGliLT52
YmEuUGl0Y2hDW2tdKSB7CisJCQltb2RlX2xpYi0+dmJhLlBpdGNoU3VwcG9ydCA9IGZhbHNlOwor
CQl9CisJfQorCS8qTW9kZSBTdXBwb3J0LCBWb2x0YWdlIFN0YXRlIGFuZCBTT0MgQ29uZmlndXJh
dGlvbiovCisKKwlmb3IgKGkgPSBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzOyBpID49IDA7
IGktLSkgeworCQlmb3IgKGogPSAwOyBqIDwgMjsgaisrKSB7CisJCQllbnVtIGRtX3ZhbGlkYXRp
b25fc3RhdHVzIHN0YXR1cyA9IERNTF9WQUxJREFUSU9OX09LOworCisJCQlpZiAobW9kZV9saWIt
PnZiYS5TY2FsZVJhdGlvQW5kVGFwc1N1cHBvcnQgIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERN
TF9GQUlMX1NDQUxFX1JBVElPX1RBUDsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Tb3Vy
Y2VGb3JtYXRQaXhlbEFuZFNjYW5TdXBwb3J0ICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxf
RkFJTF9TT1VSQ0VfUElYRUxfRk9STUFUOworCQkJfSBlbHNlIGlmIChsb2NhbHMtPlZpZXdwb3J0
U2l6ZVN1cHBvcnRbaV0gIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERNTF9GQUlMX1ZJRVdQT1JU
X1NJWkU7CisJCQl9IGVsc2UgaWYgKGxvY2Fscy0+RElPU3VwcG9ydFtpXSAhPSB0cnVlKSB7CisJ
CQkJc3RhdHVzID0gRE1MX0ZBSUxfRElPX1NVUFBPUlQ7CisJCQl9IGVsc2UgaWYgKGxvY2Fscy0+
Tm90RW5vdWdoRFNDVW5pdHNbaV0gIT0gZmFsc2UpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9O
T1RfRU5PVUdIX0RTQzsKKwkJCX0gZWxzZSBpZiAobG9jYWxzLT5EU0NDTEtSZXF1aXJlZE1vcmVU
aGFuU3VwcG9ydGVkW2ldICE9IGZhbHNlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfRFNDX0NM
S19SRVFVSVJFRDsKKwkJCX0gZWxzZSBpZiAobG9jYWxzLT5VcmdlbnRMYXRlbmN5U3VwcG9ydFtp
XVtqXSAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfVVJHRU5UX0xBVEVOQ1k7CisJ
CQl9IGVsc2UgaWYgKGxvY2Fscy0+Uk9CU3VwcG9ydFtpXSAhPSB0cnVlKSB7CisJCQkJc3RhdHVz
ID0gRE1MX0ZBSUxfUkVPUkRFUklOR19CVUZGRVI7CisJCQl9IGVsc2UgaWYgKGxvY2Fscy0+RElT
UENMS19EUFBDTEtfU3VwcG9ydFtpXVtqXSAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZB
SUxfRElTUENMS19EUFBDTEs7CisJCQl9IGVsc2UgaWYgKGxvY2Fscy0+VG90YWxBdmFpbGFibGVQ
aXBlc1N1cHBvcnRbaV1bal0gIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERNTF9GQUlMX1RPVEFM
X0FWQUlMQUJMRV9QSVBFUzsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5OdW1iZXJPZk9U
R1N1cHBvcnQgIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERNTF9GQUlMX05VTV9PVEc7CisJCQl9
IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrTW9kZVN1cHBvcnQgIT0gdHJ1ZSkgewor
CQkJCXN0YXR1cyA9IERNTF9GQUlMX1dSSVRFQkFDS19NT0RFOworCQkJfSBlbHNlIGlmIChtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0xhdGVuY3lTdXBwb3J0ICE9IHRydWUpIHsKKwkJCQlzdGF0dXMg
PSBETUxfRkFJTF9XUklURUJBQ0tfTEFURU5DWTsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZi
YS5Xcml0ZWJhY2tTY2FsZVJhdGlvQW5kVGFwc1N1cHBvcnQgIT0gdHJ1ZSkgeworCQkJCXN0YXR1
cyA9IERNTF9GQUlMX1dSSVRFQkFDS19TQ0FMRV9SQVRJT19UQVA7CisJCQl9IGVsc2UgaWYgKG1v
ZGVfbGliLT52YmEuQ3Vyc29yU3VwcG9ydCAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZB
SUxfQ1VSU09SX1NVUFBPUlQ7CisJCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuUGl0Y2hTdXBw
b3J0ICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9QSVRDSF9TVVBQT1JUOworCQkJ
fSBlbHNlIGlmIChsb2NhbHMtPlByZWZldGNoU3VwcG9ydGVkW2ldW2pdICE9IHRydWUpIHsKKwkJ
CQlzdGF0dXMgPSBETUxfRkFJTF9QUkVGRVRDSF9TVVBQT1JUOworCQkJfSBlbHNlIGlmIChsb2Nh
bHMtPlRvdGFsVmVydGljYWxBY3RpdmVCYW5kd2lkdGhTdXBwb3J0W2ldICE9IHRydWUpIHsKKwkJ
CQlzdGF0dXMgPSBETUxfRkFJTF9UT1RBTF9WX0FDVElWRV9CVzsKKwkJCX0gZWxzZSBpZiAobG9j
YWxzLT5WUmF0aW9JblByZWZldGNoU3VwcG9ydGVkW2ldW2pdICE9IHRydWUpIHsKKwkJCQlzdGF0
dXMgPSBETUxfRkFJTF9WX1JBVElPX1BSRUZFVENIOworCQkJfSBlbHNlIGlmIChsb2NhbHMtPlBU
RUJ1ZmZlclNpemVOb3RFeGNlZWRlZFtpXVtqXSAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1M
X0ZBSUxfUFRFX0JVRkZFUl9TSVpFOworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLk5vbnN1
cHBvcnRlZERTQ0lucHV0QlBDICE9IGZhbHNlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfRFND
X0lOUFVUX0JQQzsKKwkJCX0KKworCQkJaWYgKHN0YXR1cyA9PSBETUxfVkFMSURBVElPTl9PSykg
eworCQkJCWxvY2Fscy0+TW9kZVN1cHBvcnRbaV1bal0gPSB0cnVlOworCQkJfSBlbHNlIHsKKwkJ
CQlsb2NhbHMtPk1vZGVTdXBwb3J0W2ldW2pdID0gZmFsc2U7CisJCQl9CisJCQlsb2NhbHMtPlZh
bGlkYXRpb25TdGF0dXNbaV0gPSBzdGF0dXM7CisJCX0KKwl9CisJeworCQl1bnNpZ25lZCBpbnQg
TWF4aW11bU1QQ0NvbWJpbmUgPSAwOworCQltb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbCA9IG1v
ZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXMgKyAxOworCQlmb3IgKGkgPSBtb2RlX2xpYi0+dmJh
LlZvbHRhZ2VPdmVycmlkZUxldmVsOyBpIDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7
IGkrKykgeworCQkJaWYgKGxvY2Fscy0+TW9kZVN1cHBvcnRbaV1bMF0gPT0gdHJ1ZSB8fCBsb2Nh
bHMtPk1vZGVTdXBwb3J0W2ldWzFdID09IHRydWUpIHsKKwkJCQltb2RlX2xpYi0+dmJhLlZvbHRh
Z2VMZXZlbCA9IGk7CisJCQkJaWYgKGxvY2Fscy0+TW9kZVN1cHBvcnRbaV1bMV0gPT0gdHJ1ZSAm
JiAobG9jYWxzLT5Nb2RlU3VwcG9ydFtpXVswXSA9PSBmYWxzZQorCQkJCQkJfHwgbW9kZV9saWIt
PnZiYS5XaGVuVG9Eb01QQ0NvbWJpbmUgPT0gZG1fbXBjX2Fsd2F5c193aGVuX3Bvc3NpYmxlCisJ
CQkJCQl8fCAobW9kZV9saWItPnZiYS5XaGVuVG9Eb01QQ0NvbWJpbmUgPT0gZG1fbXBjX3JlZHVj
ZV92b2x0YWdlX2FuZF9jbG9ja3MKKwkJCQkJCQkmJiAoKGxvY2Fscy0+RFJBTUNsb2NrQ2hhbmdl
U3VwcG9ydFtpXVsxXSA9PSBkbV9kcmFtX2Nsb2NrX2NoYW5nZV92YWN0aXZlCisJCQkJCQkJCSYm
IGxvY2Fscy0+RFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFtpXVswXSAhPSBkbV9kcmFtX2Nsb2NrX2No
YW5nZV92YWN0aXZlKQorCQkJCQkJCXx8IChsb2NhbHMtPkRSQU1DbG9ja0NoYW5nZVN1cHBvcnRb
aV1bMV0gPT0gZG1fZHJhbV9jbG9ja19jaGFuZ2VfdmJsYW5rCisJCQkJCQkJCSYmIGxvY2Fscy0+
RFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFtpXVswXSA9PSBkbV9kcmFtX2Nsb2NrX2NoYW5nZV91bnN1
cHBvcnRlZCkpKSkpIHsKKwkJCQkJTWF4aW11bU1QQ0NvbWJpbmUgPSAxOworCQkJCX0gZWxzZSB7
CisJCQkJCU1heGltdW1NUENDb21iaW5lID0gMDsKKwkJCQl9CisJCQkJYnJlYWs7CisJCQl9CisJ
CX0KKwkJbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydCA9CisJCQlsb2NhbHMtPklt
bWVkaWF0ZUZsaXBTdXBwb3J0ZWRGb3JTdGF0ZVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1b
TWF4aW11bU1QQ0NvbWJpbmVdOworCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVt
YmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCW1vZGVfbGliLT52YmEuRFBQUGVyUGxh
bmVba10gPSBsb2NhbHMtPk5vT2ZEUFBbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdW01heGlt
dW1NUENDb21iaW5lXVtrXTsKKwkJCWxvY2Fscy0+RFBQQ0xLW2tdID0gbG9jYWxzLT5SZXF1aXJl
ZERQUENMS1ttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1bTWF4aW11bU1QQ0NvbWJpbmVdW2td
OworCQl9CisJCW1vZGVfbGliLT52YmEuRElTUENMSyA9IGxvY2Fscy0+UmVxdWlyZWRESVNQQ0xL
W21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXVtNYXhpbXVtTVBDQ29tYmluZV07CisJCW1vZGVf
bGliLT52YmEubWF4TXBjQ29tYiA9IE1heGltdW1NUENDb21iaW5lOworCX0KKwltb2RlX2xpYi0+
dmJhLkRDRkNMSyA9IG1vZGVfbGliLT52YmEuRENGQ0xLUGVyU3RhdGVbbW9kZV9saWItPnZiYS5W
b2x0YWdlTGV2ZWxdOworCW1vZGVfbGliLT52YmEuRFJBTVNwZWVkID0gbW9kZV9saWItPnZiYS5E
UkFNU3BlZWRQZXJTdGF0ZVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF07CisJbW9kZV9saWIt
PnZiYS5GYWJyaWNDbG9jayA9IG1vZGVfbGliLT52YmEuRmFicmljQ2xvY2tQZXJTdGF0ZVttb2Rl
X2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF07CisJbW9kZV9saWItPnZiYS5TT0NDTEsgPSBtb2RlX2xp
Yi0+dmJhLlNPQ0NMS1BlclN0YXRlW21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXTsKKwltb2Rl
X2xpYi0+dmJhLlJldHVybkJXID0gbG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW21vZGVfbGliLT52
YmEuVm9sdGFnZUxldmVsXTsKKwltb2RlX2xpYi0+dmJhLkZhYnJpY0FuZERSQU1CYW5kd2lkdGgg
PSBsb2NhbHMtPkZhYnJpY0FuZERSQU1CYW5kd2lkdGhQZXJTdGF0ZVttb2RlX2xpYi0+dmJhLlZv
bHRhZ2VMZXZlbF07CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0
aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGlt
aW5nW2tdID09IGspIHsKKwkJCW1vZGVfbGliLT52YmEuT0RNQ29tYmluZUVuYWJsZWRba10gPQor
CQkJCQlsb2NhbHMtPk9ETUNvbWJpbmVFbmFibGVQZXJTdGF0ZVttb2RlX2xpYi0+dmJhLlZvbHRh
Z2VMZXZlbF1ba107CisJCX0gZWxzZSB7CisJCQltb2RlX2xpYi0+dmJhLk9ETUNvbWJpbmVFbmFi
bGVkW2tdID0gMDsKKwkJfQorCQltb2RlX2xpYi0+dmJhLkRTQ0VuYWJsZWRba10gPQorCQkJCWxv
Y2Fscy0+UmVxdWlyZXNEU0NbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdW2tdOworCQltb2Rl
X2xpYi0+dmJhLk91dHB1dEJwcFtrXSA9CisJCQkJbG9jYWxzLT5PdXRwdXRCcHBQZXJTdGF0ZVtt
b2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1ba107CisJfQorfQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24yMC9kaXNwbGF5X21vZGVfdmJhXzIwLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2RjbjIwL2Rpc3BsYXlfbW9kZV92
YmFfMjAuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjkyYjY4MDVm
NDM0MgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
bWwvZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMC5oCkBAIC0wLDAgKzEsMzIgQEAKKy8qCisgKiBD
b3B5cmlnaHQgMjAxOCBBZHZhbmNlZCBNaWNybyBEZXZpY2VzLCBJbmMuCisgKgorICogUGVybWlz
c2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0
YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVu
dGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRoZSBTb2Z0d2Fy
ZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uCisgKiB0
aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0
ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFu
ZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMgZnVybmlzaGVk
IHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBU
aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFs
bCBiZSBpbmNsdWRlZCBpbgorICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBv
ZiB0aGUgU29mdHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIs
IFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyAqIElNUExJRUQsIElO
Q0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklM
SVRZLAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdF
TUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUgQ09QWVJJR0hUIEhPTERFUihTKSBPUiBB
VVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IKKyAqIE9USEVSIExJ
QUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJX
SVNFLAorICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBT
T0ZUV0FSRSBPUiBUSEUgVVNFIE9SCisgKiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUu
CisgKgorICogQXV0aG9yczogQU1ECisgKgorICovCisKKyNpZm5kZWYgX0RDTjIwX0RJU1BMQVlf
TU9ERV9WQkFfSF8KKyNkZWZpbmUgX0RDTjIwX0RJU1BMQVlfTU9ERV9WQkFfSF8KKwordm9pZCBk
bWwyMF9yZWNhbGN1bGF0ZShzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIpOwordm9p
ZCBkbWwyMF9Nb2RlU3VwcG9ydEFuZFN5c3RlbUNvbmZpZ3VyYXRpb25GdWxsKHN0cnVjdCBkaXNw
bGF5X21vZGVfbGliICptb2RlX2xpYik7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24yMC9kaXNwbGF5X3JxX2RsZ19jYWxjXzIwLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2RjbjIwL2Rpc3BsYXlfcnFfZGxn
X2NhbGNfMjAuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmVjNTE4
YWIwZjY5NAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9k
Yy9kbWwvZGNuMjAvZGlzcGxheV9ycV9kbGdfY2FsY18yMC5jCkBAIC0wLDAgKzEsMTY5OCBAQAor
LyoKKyAqIENvcHlyaWdodCAyMDE4IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KKyAqCisg
KiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBl
cnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVk
IGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhl
IFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRp
b24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBk
aXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0
d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBpcyBm
dXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgor
ICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90
aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBv
cnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQg
IkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1Q
TElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJD
SEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9O
SU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQgSE9MREVS
KFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgorICog
T1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBP
UiBPVEhFUldJU0UsCisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJ
VEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBT
T0ZUV0FSRS4KKyAqCisgKiBBdXRob3JzOiBBTUQKKyAqCisgKi8KKworI2luY2x1ZGUgIi4uL2Rp
c3BsYXlfbW9kZV9saWIuaCIKKyNpbmNsdWRlICIuLi9kaXNwbGF5X21vZGVfdmJhLmgiCisjaW5j
bHVkZSAiZGlzcGxheV9ycV9kbGdfY2FsY18yMC5oIgorCisvLyBGdW5jdGlvbjogZG1sMjBfcnFf
ZGxnX2dldF9ycV9wYXJhbXMKKy8vICBDYWxjdWxhdGUgcmVxdWVzdG9yIHJlbGF0ZWQgcGFyYW1l
dGVycyB0aGF0IHJlZ2lzdGVyIGRlZmluaXRpb24gYWdub3N0aWMKKy8vICAoaS5lLiB0aGlzIGxh
eWVyIGRvZXMgdHJ5IHRvIHNlcGFyYXRlIHJlYWwgdmFsdWVzIGZyb20gcmVnaXN0ZXIgZGVmaW5p
dGlvbikKKy8vIElucHV0OgorLy8gIHBpcGVfc3JjX3BhcmFtIC0gcGlwZSBzb3VyY2UgY29uZmln
dXJhdGlvbiAoZS5nLiB2cCwgcGl0Y2gsIGV0Yy4pCisvLyBPdXRwdXQ6CisvLyAgcnFfcGFyYW0g
LSB2YWx1ZXMgdGhhdCBjYW4gYmUgdXNlZCB0byBzZXR1cCBSUSAoZS5nLiBzd2F0aF9oZWlnaHQs
IHBsYW5lMV9hZGRyLCBldGMuKQorLy8KK3N0YXRpYyB2b2lkIGRtbDIwX3JxX2RsZ19nZXRfcnFf
cGFyYW1zKAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRpc3BsYXlf
cnFfcGFyYW1zX3N0ICogcnFfcGFyYW0sCisJCWNvbnN0IGRpc3BsYXlfcGlwZV9zb3VyY2VfcGFy
YW1zX3N0IHBpcGVfc3JjX3BhcmFtKTsKKworLy8gRnVuY3Rpb246IGRtbDIwX3JxX2RsZ19nZXRf
ZGxnX3BhcmFtcworLy8gIENhbGN1bGF0ZSBkZWFkbGluZSByZWxhdGVkIHBhcmFtZXRlcnMKKy8v
CitzdGF0aWMgdm9pZCBkbWwyMF9ycV9kbGdfZ2V0X2RsZ19wYXJhbXMoc3RydWN0IGRpc3BsYXlf
bW9kZV9saWIgKm1vZGVfbGliLAorCQljb25zdCBkaXNwbGF5X2UyZV9waXBlX3BhcmFtc19zdCAq
ZTJlX3BpcGVfcGFyYW0sCisJCWNvbnN0IHVuc2lnbmVkIGludCBudW1fcGlwZXMsCisJCWNvbnN0
IHVuc2lnbmVkIGludCBwaXBlX2lkeCwKKwkJZGlzcGxheV9kbGdfcmVnc19zdCAqZGlzcF9kbGdf
cmVncywKKwkJZGlzcGxheV90dHVfcmVnc19zdCAqZGlzcF90dHVfcmVncywKKwkJY29uc3QgZGlz
cGxheV9ycV9kbGdfcGFyYW1zX3N0IHJxX2RsZ19wYXJhbSwKKwkJY29uc3QgZGlzcGxheV9kbGdf
c3lzX3BhcmFtc19zdCBkbGdfc3lzX3BhcmFtLAorCQljb25zdCBib29sIGNzdGF0ZV9lbiwKKwkJ
Y29uc3QgYm9vbCBwc3RhdGVfZW4pOworLyoKKyAqIE5PVEU6CisgKiAgIFRoaXMgZmlsZSBpcyBn
Y2MtcGFyc2VhYmxlIEhXIGdvc3BlbCwgY29taW5nIHN0cmFpZ2h0IGZyb20gSFcgZW5naW5lZXJz
LgorICoKKyAqIEl0IGRvZXNuJ3QgYWRoZXJlIHRvIExpbnV4IGtlcm5lbCBzdHlsZSBhbmQgc29t
ZXRpbWVzIHdpbGwgZG8gdGhpbmdzIGluIG9kZAorICogd2F5cy4gVW5sZXNzIHRoZXJlIGlzIHNv
bWV0aGluZyBjbGVhcmx5IHdyb25nIHdpdGggaXQgdGhlIGNvZGUgc2hvdWxkCisgKiByZW1haW4g
YXMtaXMgYXMgaXQgcHJvdmlkZXMgdXMgd2l0aCBhIGd1YXJhbnRlZSBmcm9tIEhXIHRoYXQgaXQg
aXMgY29ycmVjdC4KKyAqLworCitzdGF0aWMgdm9pZCBjYWxjdWxhdGVfdHR1X2N1cnNvcihzdHJ1
Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRvdWJsZSAqcmVmY3ljX3Blcl9yZXFf
ZGVsaXZlcnlfcHJlX2N1ciwKKwkJZG91YmxlICpyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIs
CisJCWRvdWJsZSByZWZjbGtfZnJlcV9pbl9taHosCisJCWRvdWJsZSByZWZfZnJlcV90b19waXhf
ZnJlcSwKKwkJZG91YmxlIGhzY2FsZV9waXhlbF9yYXRlX2wsCisJCWRvdWJsZSBoc2NsX3JhdGlv
LAorCQlkb3VibGUgdnJhdGlvX3ByZV9sLAorCQlkb3VibGUgdnJhdGlvX2wsCisJCXVuc2lnbmVk
IGludCBjdXJfd2lkdGgsCisJCWVudW0gY3Vyc29yX2JwcCBjdXJfYnBwKTsKKworI2luY2x1ZGUg
Ii4uL2RtbF9pbmxpbmVfZGVmcy5oIgorCitzdGF0aWMgdW5zaWduZWQgaW50IGdldF9ieXRlc19w
ZXJfZWxlbWVudChlbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3Mgc291cmNlX2Zvcm1hdCwgYm9vbCBp
c19jaHJvbWEpCit7CisJdW5zaWduZWQgaW50IHJldF92YWwgPSAwOworCisJaWYgKHNvdXJjZV9m
b3JtYXQgPT0gZG1fNDQ0XzE2KSB7CisJCWlmICghaXNfY2hyb21hKQorCQkJcmV0X3ZhbCA9IDI7
CisJfSBlbHNlIGlmIChzb3VyY2VfZm9ybWF0ID09IGRtXzQ0NF8zMikgeworCQlpZiAoIWlzX2No
cm9tYSkKKwkJCXJldF92YWwgPSA0OworCX0gZWxzZSBpZiAoc291cmNlX2Zvcm1hdCA9PSBkbV80
NDRfNjQpIHsKKwkJaWYgKCFpc19jaHJvbWEpCisJCQlyZXRfdmFsID0gODsKKwl9IGVsc2UgaWYg
KHNvdXJjZV9mb3JtYXQgPT0gZG1fNDIwXzgpIHsKKwkJaWYgKGlzX2Nocm9tYSkKKwkJCXJldF92
YWwgPSAyOworCQllbHNlCisJCQlyZXRfdmFsID0gMTsKKwl9IGVsc2UgaWYgKHNvdXJjZV9mb3Jt
YXQgPT0gZG1fNDIwXzEwKSB7CisJCWlmIChpc19jaHJvbWEpCisJCQlyZXRfdmFsID0gNDsKKwkJ
ZWxzZQorCQkJcmV0X3ZhbCA9IDI7CisJfSBlbHNlIGlmIChzb3VyY2VfZm9ybWF0ID09IGRtXzQ0
NF84KSB7CisJCXJldF92YWwgPSAxOworCX0KKwlyZXR1cm4gcmV0X3ZhbDsKK30KKworc3RhdGlj
IGJvb2wgaXNfZHVhbF9wbGFuZShlbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3Mgc291cmNlX2Zvcm1h
dCkKK3sKKwlib29sIHJldF92YWwgPSAwOworCisJaWYgKChzb3VyY2VfZm9ybWF0ID09IGRtXzQy
MF84KSB8fCAoc291cmNlX2Zvcm1hdCA9PSBkbV80MjBfMTApKQorCQlyZXRfdmFsID0gMTsKKwor
CXJldHVybiByZXRfdmFsOworfQorCitzdGF0aWMgZG91YmxlIGdldF9yZWZjeWNfcGVyX2RlbGl2
ZXJ5KHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJZG91YmxlIHJlZmNsa19m
cmVxX2luX21oeiwKKwkJZG91YmxlIHBjbGtfZnJlcV9pbl9taHosCisJCWJvb2wgb2RtX2NvbWJp
bmUsCisJCXVuc2lnbmVkIGludCByZWNvdXRfd2lkdGgsCisJCXVuc2lnbmVkIGludCBoYWN0aXZl
LAorCQlkb3VibGUgdnJhdGlvLAorCQlkb3VibGUgaHNjYWxlX3BpeGVsX3JhdGUsCisJCXVuc2ln
bmVkIGludCBkZWxpdmVyeV93aWR0aCwKKwkJdW5zaWduZWQgaW50IHJlcV9wZXJfc3dhdGhfdWIp
Cit7CisJZG91YmxlIHJlZmN5Y19wZXJfZGVsaXZlcnkgPSAwLjA7CisKKwlpZiAodnJhdGlvIDw9
IDEuMCkgeworCQlpZiAob2RtX2NvbWJpbmUpCisJCQlyZWZjeWNfcGVyX2RlbGl2ZXJ5ID0gKGRv
dWJsZSkgcmVmY2xrX2ZyZXFfaW5fbWh6CisJCQkJCSogZG1sX21pbigoZG91YmxlKSByZWNvdXRf
d2lkdGgsIChkb3VibGUpIGhhY3RpdmUgLyAyLjApCisJCQkJCS8gcGNsa19mcmVxX2luX21oeiAv
IChkb3VibGUpIHJlcV9wZXJfc3dhdGhfdWI7CisJCWVsc2UKKwkJCXJlZmN5Y19wZXJfZGVsaXZl
cnkgPSAoZG91YmxlKSByZWZjbGtfZnJlcV9pbl9taHogKiAoZG91YmxlKSByZWNvdXRfd2lkdGgK
KwkJCQkJLyBwY2xrX2ZyZXFfaW5fbWh6IC8gKGRvdWJsZSkgcmVxX3Blcl9zd2F0aF91YjsKKwl9
IGVsc2UgeworCQlyZWZjeWNfcGVyX2RlbGl2ZXJ5ID0gKGRvdWJsZSkgcmVmY2xrX2ZyZXFfaW5f
bWh6ICogKGRvdWJsZSkgZGVsaXZlcnlfd2lkdGgKKwkJCQkvIChkb3VibGUpIGhzY2FsZV9waXhl
bF9yYXRlIC8gKGRvdWJsZSkgcmVxX3Blcl9zd2F0aF91YjsKKwl9CisKKwlkbWxfcHJpbnQoIkRN
TF9ETEc6ICVzOiByZWZjbGtfZnJlcV9pbl9taHogPSAlMy4yZlxuIiwgX19mdW5jX18sIHJlZmNs
a19mcmVxX2luX21oeik7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogcGNsa19mcmVxX2luX21o
eiAgID0gJTMuMmZcbiIsIF9fZnVuY19fLCBwY2xrX2ZyZXFfaW5fbWh6KTsKKwlkbWxfcHJpbnQo
IkRNTF9ETEc6ICVzOiByZWNvdXRfd2lkdGggICAgICAgPSAlZFxuIiwgX19mdW5jX18sIHJlY291
dF93aWR0aCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogdnJhdGlvICAgICAgICAgICAgID0g
JTMuMmZcbiIsIF9fZnVuY19fLCB2cmF0aW8pOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJl
cV9wZXJfc3dhdGhfdWIgICA9ICVkXG4iLCBfX2Z1bmNfXywgcmVxX3Blcl9zd2F0aF91Yik7CisJ
ZG1sX3ByaW50KCJETUxfRExHOiAlczogcmVmY3ljX3Blcl9kZWxpdmVyeT0gJTMuMmZcbiIsIF9f
ZnVuY19fLCByZWZjeWNfcGVyX2RlbGl2ZXJ5KTsKKworCXJldHVybiByZWZjeWNfcGVyX2RlbGl2
ZXJ5OworCit9CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgZ2V0X2Jsa19zaXplX2J5dGVzKGNvbnN0
IGVudW0gc291cmNlX21hY3JvX3RpbGVfc2l6ZSB0aWxlX3NpemUpCit7CisJaWYgKHRpbGVfc2l6
ZSA9PSBkbV8yNTZrX3RpbGUpCisJCXJldHVybiAoMjU2ICogMTAyNCk7CisJZWxzZSBpZiAodGls
ZV9zaXplID09IGRtXzY0a190aWxlKQorCQlyZXR1cm4gKDY0ICogMTAyNCk7CisJZWxzZQorCQly
ZXR1cm4gKDQgKiAxMDI0KTsKK30KKworc3RhdGljIHZvaWQgZXh0cmFjdF9ycV9zaXppbmdfcmVn
cyhzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRpc3BsYXlfZGF0YV9ycV9y
ZWdzX3N0ICpycV9yZWdzLAorCQljb25zdCBkaXNwbGF5X2RhdGFfcnFfc2l6aW5nX3BhcmFtc19z
dCBycV9zaXppbmcpCit7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogcnFfc2l6aW5nIHBhcmFt
XG4iLCBfX2Z1bmNfXyk7CisJcHJpbnRfX2RhdGFfcnFfc2l6aW5nX3BhcmFtc19zdChtb2RlX2xp
YiwgcnFfc2l6aW5nKTsKKworCXJxX3JlZ3MtPmNodW5rX3NpemUgPSBkbWxfbG9nMihycV9zaXpp
bmcuY2h1bmtfYnl0ZXMpIC0gMTA7CisKKwlpZiAocnFfc2l6aW5nLm1pbl9jaHVua19ieXRlcyA9
PSAwKQorCQlycV9yZWdzLT5taW5fY2h1bmtfc2l6ZSA9IDA7CisJZWxzZQorCQlycV9yZWdzLT5t
aW5fY2h1bmtfc2l6ZSA9IGRtbF9sb2cyKHJxX3NpemluZy5taW5fY2h1bmtfYnl0ZXMpIC0gOCAr
IDE7CisKKwlycV9yZWdzLT5tZXRhX2NodW5rX3NpemUgPSBkbWxfbG9nMihycV9zaXppbmcubWV0
YV9jaHVua19ieXRlcykgLSAxMDsKKwlpZiAocnFfc2l6aW5nLm1pbl9tZXRhX2NodW5rX2J5dGVz
ID09IDApCisJCXJxX3JlZ3MtPm1pbl9tZXRhX2NodW5rX3NpemUgPSAwOworCWVsc2UKKwkJcnFf
cmVncy0+bWluX21ldGFfY2h1bmtfc2l6ZSA9IGRtbF9sb2cyKHJxX3NpemluZy5taW5fbWV0YV9j
aHVua19ieXRlcykgLSA2ICsgMTsKKworCXJxX3JlZ3MtPmRwdGVfZ3JvdXBfc2l6ZSA9IGRtbF9s
b2cyKHJxX3NpemluZy5kcHRlX2dyb3VwX2J5dGVzKSAtIDY7CisJcnFfcmVncy0+bXB0ZV9ncm91
cF9zaXplID0gZG1sX2xvZzIocnFfc2l6aW5nLm1wdGVfZ3JvdXBfYnl0ZXMpIC0gNjsKK30KKwor
c3RhdGljIHZvaWQgZXh0cmFjdF9ycV9yZWdzKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2Rl
X2xpYiwKKwkJZGlzcGxheV9ycV9yZWdzX3N0ICpycV9yZWdzLAorCQljb25zdCBkaXNwbGF5X3Jx
X3BhcmFtc19zdCBycV9wYXJhbSkKK3sKKwl1bnNpZ25lZCBpbnQgZGV0aWxlX2J1Zl9zaXplX2lu
X2J5dGVzID0gbW9kZV9saWItPmlwLmRldF9idWZmZXJfc2l6ZV9rYnl0ZXMgKiAxMDI0OworCXVu
c2lnbmVkIGludCBkZXRpbGVfYnVmX3BsYW5lMV9hZGRyID0gMDsKKworCWV4dHJhY3RfcnFfc2l6
aW5nX3JlZ3MobW9kZV9saWIsICYocnFfcmVncy0+cnFfcmVnc19sKSwgcnFfcGFyYW0uc2l6aW5n
LnJxX2wpOworCisJcnFfcmVncy0+cnFfcmVnc19sLnB0ZV9yb3dfaGVpZ2h0X2xpbmVhciA9IGRt
bF9mbG9vcihkbWxfbG9nMihycV9wYXJhbS5kbGcucnFfbC5kcHRlX3Jvd19oZWlnaHQpLAorCQkJ
MSkgLSAzOworCisJaWYgKHJxX3BhcmFtLnl1djQyMCkgeworCQlleHRyYWN0X3JxX3NpemluZ19y
ZWdzKG1vZGVfbGliLCAmKHJxX3JlZ3MtPnJxX3JlZ3NfYyksIHJxX3BhcmFtLnNpemluZy5ycV9j
KTsKKwkJcnFfcmVncy0+cnFfcmVnc19jLnB0ZV9yb3dfaGVpZ2h0X2xpbmVhciA9IGRtbF9mbG9v
cihkbWxfbG9nMihycV9wYXJhbS5kbGcucnFfYy5kcHRlX3Jvd19oZWlnaHQpLAorCQkJCTEpIC0g
MzsKKwl9CisKKwlycV9yZWdzLT5ycV9yZWdzX2wuc3dhdGhfaGVpZ2h0ID0gZG1sX2xvZzIocnFf
cGFyYW0uZGxnLnJxX2wuc3dhdGhfaGVpZ2h0KTsKKwlycV9yZWdzLT5ycV9yZWdzX2Muc3dhdGhf
aGVpZ2h0ID0gZG1sX2xvZzIocnFfcGFyYW0uZGxnLnJxX2Muc3dhdGhfaGVpZ2h0KTsKKworCS8v
IEZJWE1FOiB0YWtlIHRoZSBtYXggYmV0d2VlbiBsdW1hLCBjaHJvbWEgY2h1bmsgc2l6ZT8KKwkv
LyBva2F5IGZvciBub3csIGFzIHdlIGFyZSBzZXR0aW5nIGNodW5rX2J5dGVzIHRvIDhrYiBhbnl3
YXlzCisJaWYgKHJxX3BhcmFtLnNpemluZy5ycV9sLmNodW5rX2J5dGVzID49IDMyICogMTAyNCkg
eyAvLzMya2IKKwkJcnFfcmVncy0+ZHJxX2V4cGFuc2lvbl9tb2RlID0gMDsKKwl9IGVsc2Ugewor
CQlycV9yZWdzLT5kcnFfZXhwYW5zaW9uX21vZGUgPSAyOworCX0KKwlycV9yZWdzLT5wcnFfZXhw
YW5zaW9uX21vZGUgPSAxOworCXJxX3JlZ3MtPm1ycV9leHBhbnNpb25fbW9kZSA9IDE7CisJcnFf
cmVncy0+Y3JxX2V4cGFuc2lvbl9tb2RlID0gMTsKKworCWlmIChycV9wYXJhbS55dXY0MjApIHsK
KwkJaWYgKChkb3VibGUpIHJxX3BhcmFtLm1pc2MucnFfbC5zdG9yZWRfc3dhdGhfYnl0ZXMKKwkJ
CQkvIChkb3VibGUpIHJxX3BhcmFtLm1pc2MucnFfYy5zdG9yZWRfc3dhdGhfYnl0ZXMgPD0gMS41
KSB7CisJCQlkZXRpbGVfYnVmX3BsYW5lMV9hZGRyID0gKGRldGlsZV9idWZfc2l6ZV9pbl9ieXRl
cyAvIDIuMCAvIDY0LjApOyAvLyBoYWxmIHRvIGNocm9tYQorCQl9IGVsc2UgeworCQkJZGV0aWxl
X2J1Zl9wbGFuZTFfYWRkciA9IGRtbF9yb3VuZF90b19tdWx0aXBsZSgodW5zaWduZWQgaW50KSAo
KDIuMCAqIGRldGlsZV9idWZfc2l6ZV9pbl9ieXRlcykgLyAzLjApLAorCQkJCQkyNTYsCisJCQkJ
CTApIC8gNjQuMDsgLy8gMi8zIHRvIGNocm9tYQorCQl9CisJfQorCXJxX3JlZ3MtPnBsYW5lMV9i
YXNlX2FkZHJlc3MgPSBkZXRpbGVfYnVmX3BsYW5lMV9hZGRyOworfQorCitzdGF0aWMgdm9pZCBo
YW5kbGVfZGV0X2J1Zl9zcGxpdChzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJ
CWRpc3BsYXlfcnFfcGFyYW1zX3N0ICpycV9wYXJhbSwKKwkJY29uc3QgZGlzcGxheV9waXBlX3Nv
dXJjZV9wYXJhbXNfc3QgcGlwZV9zcmNfcGFyYW0pCit7CisJdW5zaWduZWQgaW50IHRvdGFsX3N3
YXRoX2J5dGVzID0gMDsKKwl1bnNpZ25lZCBpbnQgc3dhdGhfYnl0ZXNfbCA9IDA7CisJdW5zaWdu
ZWQgaW50IHN3YXRoX2J5dGVzX2MgPSAwOworCXVuc2lnbmVkIGludCBmdWxsX3N3YXRoX2J5dGVz
X3BhY2tlZF9sID0gMDsKKwl1bnNpZ25lZCBpbnQgZnVsbF9zd2F0aF9ieXRlc19wYWNrZWRfYyA9
IDA7CisJYm9vbCByZXExMjhfbCA9IDA7CisJYm9vbCByZXExMjhfYyA9IDA7CisJYm9vbCBzdXJm
X2xpbmVhciA9IChwaXBlX3NyY19wYXJhbS5zd19tb2RlID09IGRtX3N3X2xpbmVhcik7CisJYm9v
bCBzdXJmX3ZlcnQgPSAocGlwZV9zcmNfcGFyYW0uc291cmNlX3NjYW4gPT0gZG1fdmVydCk7CisJ
dW5zaWduZWQgaW50IGxvZzJfc3dhdGhfaGVpZ2h0X2wgPSAwOworCXVuc2lnbmVkIGludCBsb2cy
X3N3YXRoX2hlaWdodF9jID0gMDsKKwl1bnNpZ25lZCBpbnQgZGV0aWxlX2J1Zl9zaXplX2luX2J5
dGVzID0gbW9kZV9saWItPmlwLmRldF9idWZmZXJfc2l6ZV9rYnl0ZXMgKiAxMDI0OworCisJZnVs
bF9zd2F0aF9ieXRlc19wYWNrZWRfbCA9IHJxX3BhcmFtLT5taXNjLnJxX2wuZnVsbF9zd2F0aF9i
eXRlczsKKwlmdWxsX3N3YXRoX2J5dGVzX3BhY2tlZF9jID0gcnFfcGFyYW0tPm1pc2MucnFfYy5m
dWxsX3N3YXRoX2J5dGVzOworCisJaWYgKHJxX3BhcmFtLT55dXY0MjBfMTBicGMpIHsKKwkJZnVs
bF9zd2F0aF9ieXRlc19wYWNrZWRfbCA9IGRtbF9yb3VuZF90b19tdWx0aXBsZShycV9wYXJhbS0+
bWlzYy5ycV9sLmZ1bGxfc3dhdGhfYnl0ZXMgKiAyIC8gMywKKwkJCQkyNTYsCisJCQkJMSkgKyAy
NTY7CisJCWZ1bGxfc3dhdGhfYnl0ZXNfcGFja2VkX2MgPSBkbWxfcm91bmRfdG9fbXVsdGlwbGUo
cnFfcGFyYW0tPm1pc2MucnFfYy5mdWxsX3N3YXRoX2J5dGVzICogMiAvIDMsCisJCQkJMjU2LAor
CQkJCTEpICsgMjU2OworCX0KKworCWlmIChycV9wYXJhbS0+eXV2NDIwKSB7CisJCXRvdGFsX3N3
YXRoX2J5dGVzID0gMiAqIGZ1bGxfc3dhdGhfYnl0ZXNfcGFja2VkX2wgKyAyICogZnVsbF9zd2F0
aF9ieXRlc19wYWNrZWRfYzsKKworCQlpZiAodG90YWxfc3dhdGhfYnl0ZXMgPD0gZGV0aWxlX2J1
Zl9zaXplX2luX2J5dGVzKSB7IC8vZnVsbCAyNTZiIHJlcXVlc3QKKwkJCXJlcTEyOF9sID0gMDsK
KwkJCXJlcTEyOF9jID0gMDsKKwkJCXN3YXRoX2J5dGVzX2wgPSBmdWxsX3N3YXRoX2J5dGVzX3Bh
Y2tlZF9sOworCQkJc3dhdGhfYnl0ZXNfYyA9IGZ1bGxfc3dhdGhfYnl0ZXNfcGFja2VkX2M7CisJ
CX0gZWxzZSB7IC8vMTI4YiByZXF1ZXN0IChmb3IgbHVtYSBvbmx5IGZvciB5dXY0MjAgOGJwYykK
KwkJCXJlcTEyOF9sID0gMTsKKwkJCXJlcTEyOF9jID0gMDsKKwkJCXN3YXRoX2J5dGVzX2wgPSBm
dWxsX3N3YXRoX2J5dGVzX3BhY2tlZF9sIC8gMjsKKwkJCXN3YXRoX2J5dGVzX2MgPSBmdWxsX3N3
YXRoX2J5dGVzX3BhY2tlZF9jOworCQl9CisJCS8vIE5vdGU6IGFzc3VtcHRpb24sIHRoZSBjb25m
aWcgdGhhdCBwYXNzIGluIHdpbGwgZml0IGludG8KKwkJLy8gICAgICAgdGhlIGRldGlsZWQgYnVm
ZmVyLgorCX0gZWxzZSB7CisJCXRvdGFsX3N3YXRoX2J5dGVzID0gMiAqIGZ1bGxfc3dhdGhfYnl0
ZXNfcGFja2VkX2w7CisKKwkJaWYgKHRvdGFsX3N3YXRoX2J5dGVzIDw9IGRldGlsZV9idWZfc2l6
ZV9pbl9ieXRlcykKKwkJCXJlcTEyOF9sID0gMDsKKwkJZWxzZQorCQkJcmVxMTI4X2wgPSAxOwor
CisJCXN3YXRoX2J5dGVzX2wgPSB0b3RhbF9zd2F0aF9ieXRlczsKKwkJc3dhdGhfYnl0ZXNfYyA9
IDA7CisJfQorCXJxX3BhcmFtLT5taXNjLnJxX2wuc3RvcmVkX3N3YXRoX2J5dGVzID0gc3dhdGhf
Ynl0ZXNfbDsKKwlycV9wYXJhbS0+bWlzYy5ycV9jLnN0b3JlZF9zd2F0aF9ieXRlcyA9IHN3YXRo
X2J5dGVzX2M7CisKKwlpZiAoc3VyZl9saW5lYXIpIHsKKwkJbG9nMl9zd2F0aF9oZWlnaHRfbCA9
IDA7CisJCWxvZzJfc3dhdGhfaGVpZ2h0X2MgPSAwOworCX0gZWxzZSBpZiAoIXN1cmZfdmVydCkg
eworCQlsb2cyX3N3YXRoX2hlaWdodF9sID0gZG1sX2xvZzIocnFfcGFyYW0tPm1pc2MucnFfbC5i
bGsyNTZfaGVpZ2h0KSAtIHJlcTEyOF9sOworCQlsb2cyX3N3YXRoX2hlaWdodF9jID0gZG1sX2xv
ZzIocnFfcGFyYW0tPm1pc2MucnFfYy5ibGsyNTZfaGVpZ2h0KSAtIHJlcTEyOF9jOworCX0gZWxz
ZSB7CisJCWxvZzJfc3dhdGhfaGVpZ2h0X2wgPSBkbWxfbG9nMihycV9wYXJhbS0+bWlzYy5ycV9s
LmJsazI1Nl93aWR0aCkgLSByZXExMjhfbDsKKwkJbG9nMl9zd2F0aF9oZWlnaHRfYyA9IGRtbF9s
b2cyKHJxX3BhcmFtLT5taXNjLnJxX2MuYmxrMjU2X3dpZHRoKSAtIHJlcTEyOF9jOworCX0KKwly
cV9wYXJhbS0+ZGxnLnJxX2wuc3dhdGhfaGVpZ2h0ID0gMSA8PCBsb2cyX3N3YXRoX2hlaWdodF9s
OworCXJxX3BhcmFtLT5kbGcucnFfYy5zd2F0aF9oZWlnaHQgPSAxIDw8IGxvZzJfc3dhdGhfaGVp
Z2h0X2M7CisKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZXExMjhfbCA9ICUwZFxuIiwgX19m
dW5jX18sIHJlcTEyOF9sKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZXExMjhfYyA9ICUw
ZFxuIiwgX19mdW5jX18sIHJlcTEyOF9jKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBmdWxs
X3N3YXRoX2J5dGVzX3BhY2tlZF9sID0gJTBkXG4iLAorCQkJX19mdW5jX18sCisJCQlmdWxsX3N3
YXRoX2J5dGVzX3BhY2tlZF9sKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBmdWxsX3N3YXRo
X2J5dGVzX3BhY2tlZF9jID0gJTBkXG4iLAorCQkJX19mdW5jX18sCisJCQlmdWxsX3N3YXRoX2J5
dGVzX3BhY2tlZF9jKTsKK30KKworc3RhdGljIHZvaWQgZ2V0X21ldGFfYW5kX3B0ZV9hdHRyKHN0
cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJZGlzcGxheV9kYXRhX3JxX2RsZ19w
YXJhbXNfc3QgKnJxX2RsZ19wYXJhbSwKKwkJZGlzcGxheV9kYXRhX3JxX21pc2NfcGFyYW1zX3N0
ICpycV9taXNjX3BhcmFtLAorCQlkaXNwbGF5X2RhdGFfcnFfc2l6aW5nX3BhcmFtc19zdCAqcnFf
c2l6aW5nX3BhcmFtLAorCQl1bnNpZ25lZCBpbnQgdnBfd2lkdGgsCisJCXVuc2lnbmVkIGludCB2
cF9oZWlnaHQsCisJCXVuc2lnbmVkIGludCBkYXRhX3BpdGNoLAorCQl1bnNpZ25lZCBpbnQgbWV0
YV9waXRjaCwKKwkJdW5zaWduZWQgaW50IHNvdXJjZV9mb3JtYXQsCisJCXVuc2lnbmVkIGludCB0
aWxpbmcsCisJCXVuc2lnbmVkIGludCBtYWNyb190aWxlX3NpemUsCisJCXVuc2lnbmVkIGludCBz
b3VyY2Vfc2NhbiwKKwkJdW5zaWduZWQgaW50IGlzX2Nocm9tYSkKK3sKKwlib29sIHN1cmZfbGlu
ZWFyID0gKHRpbGluZyA9PSBkbV9zd19saW5lYXIpOworCWJvb2wgc3VyZl92ZXJ0ID0gKHNvdXJj
ZV9zY2FuID09IGRtX3ZlcnQpOworCisJdW5zaWduZWQgaW50IGJ5dGVzX3Blcl9lbGVtZW50Owor
CXVuc2lnbmVkIGludCBieXRlc19wZXJfZWxlbWVudF95ID0gZ2V0X2J5dGVzX3Blcl9lbGVtZW50
KChlbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MpKHNvdXJjZV9mb3JtYXQpLAorCQkJZmFsc2UpOwor
CXVuc2lnbmVkIGludCBieXRlc19wZXJfZWxlbWVudF9jID0gZ2V0X2J5dGVzX3Blcl9lbGVtZW50
KChlbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MpKHNvdXJjZV9mb3JtYXQpLAorCQkJdHJ1ZSk7CisK
Kwl1bnNpZ25lZCBpbnQgYmxrMjU2X3dpZHRoID0gMDsKKwl1bnNpZ25lZCBpbnQgYmxrMjU2X2hl
aWdodCA9IDA7CisKKwl1bnNpZ25lZCBpbnQgYmxrMjU2X3dpZHRoX3kgPSAwOworCXVuc2lnbmVk
IGludCBibGsyNTZfaGVpZ2h0X3kgPSAwOworCXVuc2lnbmVkIGludCBibGsyNTZfd2lkdGhfYyA9
IDA7CisJdW5zaWduZWQgaW50IGJsazI1Nl9oZWlnaHRfYyA9IDA7CisJdW5zaWduZWQgaW50IGxv
ZzJfYnl0ZXNfcGVyX2VsZW1lbnQ7CisJdW5zaWduZWQgaW50IGxvZzJfYmxrMjU2X3dpZHRoOwor
CXVuc2lnbmVkIGludCBsb2cyX2JsazI1Nl9oZWlnaHQ7CisJdW5zaWduZWQgaW50IGJsa19ieXRl
czsKKwl1bnNpZ25lZCBpbnQgbG9nMl9ibGtfYnl0ZXM7CisJdW5zaWduZWQgaW50IGxvZzJfYmxr
X2hlaWdodDsKKwl1bnNpZ25lZCBpbnQgbG9nMl9ibGtfd2lkdGg7CisJdW5zaWduZWQgaW50IGxv
ZzJfbWV0YV9yZXFfYnl0ZXM7CisJdW5zaWduZWQgaW50IGxvZzJfbWV0YV9yZXFfaGVpZ2h0Owor
CXVuc2lnbmVkIGludCBsb2cyX21ldGFfcmVxX3dpZHRoOworCXVuc2lnbmVkIGludCBtZXRhX3Jl
cV93aWR0aDsKKwl1bnNpZ25lZCBpbnQgbWV0YV9yZXFfaGVpZ2h0OworCXVuc2lnbmVkIGludCBs
b2cyX21ldGFfcm93X2hlaWdodDsKKwl1bnNpZ25lZCBpbnQgbWV0YV9yb3dfd2lkdGhfdWI7CisJ
dW5zaWduZWQgaW50IGxvZzJfbWV0YV9jaHVua19ieXRlczsKKwl1bnNpZ25lZCBpbnQgbG9nMl9t
ZXRhX2NodW5rX2hlaWdodDsKKworCS8vZnVsbCBzaXplZCBtZXRhIGNodW5rIHdpZHRoIGluIHVu
aXQgb2YgZGF0YSBlbGVtZW50cworCXVuc2lnbmVkIGludCBsb2cyX21ldGFfY2h1bmtfd2lkdGg7
CisJdW5zaWduZWQgaW50IGxvZzJfbWluX21ldGFfY2h1bmtfYnl0ZXM7CisJdW5zaWduZWQgaW50
IG1pbl9tZXRhX2NodW5rX3dpZHRoOworCXVuc2lnbmVkIGludCBtZXRhX2NodW5rX3dpZHRoOwor
CXVuc2lnbmVkIGludCBtZXRhX2NodW5rX3Blcl9yb3dfaW50OworCXVuc2lnbmVkIGludCBtZXRh
X3Jvd19yZW1haW5kZXI7CisJdW5zaWduZWQgaW50IG1ldGFfY2h1bmtfdGhyZXNob2xkOworCXVu
c2lnbmVkIGludCBtZXRhX2Jsa19ieXRlczsKKwl1bnNpZ25lZCBpbnQgbWV0YV9ibGtfaGVpZ2h0
OworCXVuc2lnbmVkIGludCBtZXRhX2Jsa193aWR0aDsKKwl1bnNpZ25lZCBpbnQgbWV0YV9zdXJm
YWNlX2J5dGVzOworCXVuc2lnbmVkIGludCB2bXBnX2J5dGVzOworCXVuc2lnbmVkIGludCBtZXRh
X3B0ZV9yZXFfcGVyX2ZyYW1lX3ViOworCXVuc2lnbmVkIGludCBtZXRhX3B0ZV9ieXRlc19wZXJf
ZnJhbWVfdWI7CisJY29uc3QgdW5zaWduZWQgaW50IGxvZzJfdm1wZ19ieXRlcyA9IGRtbF9sb2cy
KG1vZGVfbGliLT5zb2Mudm1tX3BhZ2Vfc2l6ZV9ieXRlcyk7CisJY29uc3QgdW5zaWduZWQgaW50
IGRwdGVfYnVmX2luX3B0ZV9yZXFzID0gbW9kZV9saWItPmlwLmRwdGVfYnVmZmVyX3NpemVfaW5f
cHRlX3JlcXNfbHVtYTsKKwljb25zdCB1bnNpZ25lZCBpbnQgcGRlX3Byb2NfYnVmZmVyX3NpemVf
NjRrX3JlcXMgPQorCQkJbW9kZV9saWItPmlwLnBkZV9wcm9jX2J1ZmZlcl9zaXplXzY0a19yZXFz
OworCisJdW5zaWduZWQgaW50IGxvZzJfdm1wZ19oZWlnaHQgPSAwOworCXVuc2lnbmVkIGludCBs
b2cyX3ZtcGdfd2lkdGggPSAwOworCXVuc2lnbmVkIGludCBsb2cyX2RwdGVfcmVxX2hlaWdodF9w
dGVzID0gMDsKKwl1bnNpZ25lZCBpbnQgbG9nMl9kcHRlX3JlcV9oZWlnaHQgPSAwOworCXVuc2ln
bmVkIGludCBsb2cyX2RwdGVfcmVxX3dpZHRoID0gMDsKKwl1bnNpZ25lZCBpbnQgbG9nMl9kcHRl
X3Jvd19oZWlnaHRfbGluZWFyID0gMDsKKwl1bnNpZ25lZCBpbnQgbG9nMl9kcHRlX3Jvd19oZWln
aHQgPSAwOworCXVuc2lnbmVkIGludCBsb2cyX2RwdGVfZ3JvdXBfd2lkdGggPSAwOworCXVuc2ln
bmVkIGludCBkcHRlX3Jvd193aWR0aF91YiA9IDA7CisJdW5zaWduZWQgaW50IGRwdGVfcmVxX2hl
aWdodCA9IDA7CisJdW5zaWduZWQgaW50IGRwdGVfcmVxX3dpZHRoID0gMDsKKwl1bnNpZ25lZCBp
bnQgZHB0ZV9ncm91cF93aWR0aCA9IDA7CisJdW5zaWduZWQgaW50IGxvZzJfZHB0ZV9ncm91cF9i
eXRlcyA9IDA7CisJdW5zaWduZWQgaW50IGxvZzJfZHB0ZV9ncm91cF9sZW5ndGggPSAwOworCXVu
c2lnbmVkIGludCBwZGVfYnVmX2VudHJpZXM7CisJYm9vbCB5dXY0MjAgPSAoc291cmNlX2Zvcm1h
dCA9PSBkbV80MjBfOCB8fCBzb3VyY2VfZm9ybWF0ID09IGRtXzQyMF8xMCk7CisKKwlDYWxjdWxh
dGUyNTZCQmxvY2tTaXplcygoZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNzKShzb3VyY2VfZm9ybWF0
KSwKKwkJCShlbnVtIGRtX3N3aXp6bGVfbW9kZSkodGlsaW5nKSwKKwkJCWJ5dGVzX3Blcl9lbGVt
ZW50X3ksCisJCQlieXRlc19wZXJfZWxlbWVudF9jLAorCQkJJmJsazI1Nl9oZWlnaHRfeSwKKwkJ
CSZibGsyNTZfaGVpZ2h0X2MsCisJCQkmYmxrMjU2X3dpZHRoX3ksCisJCQkmYmxrMjU2X3dpZHRo
X2MpOworCisJaWYgKCFpc19jaHJvbWEpIHsKKwkJYmxrMjU2X3dpZHRoID0gYmxrMjU2X3dpZHRo
X3k7CisJCWJsazI1Nl9oZWlnaHQgPSBibGsyNTZfaGVpZ2h0X3k7CisJCWJ5dGVzX3Blcl9lbGVt
ZW50ID0gYnl0ZXNfcGVyX2VsZW1lbnRfeTsKKwl9IGVsc2UgeworCQlibGsyNTZfd2lkdGggPSBi
bGsyNTZfd2lkdGhfYzsKKwkJYmxrMjU2X2hlaWdodCA9IGJsazI1Nl9oZWlnaHRfYzsKKwkJYnl0
ZXNfcGVyX2VsZW1lbnQgPSBieXRlc19wZXJfZWxlbWVudF9jOworCX0KKworCWxvZzJfYnl0ZXNf
cGVyX2VsZW1lbnQgPSBkbWxfbG9nMihieXRlc19wZXJfZWxlbWVudCk7CisKKwlkbWxfcHJpbnQo
IkRNTF9ETEc6ICVzOiBzdXJmX2xpbmVhciAgICAgICAgPSAlZFxuIiwgX19mdW5jX18sIHN1cmZf
bGluZWFyKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBzdXJmX3ZlcnQgICAgICAgICAgPSAl
ZFxuIiwgX19mdW5jX18sIHN1cmZfdmVydCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogYmxr
MjU2X3dpZHRoICAgICAgID0gJWRcbiIsIF9fZnVuY19fLCBibGsyNTZfd2lkdGgpOworCWRtbF9w
cmludCgiRE1MX0RMRzogJXM6IGJsazI1Nl9oZWlnaHQgICAgICA9ICVkXG4iLCBfX2Z1bmNfXywg
YmxrMjU2X2hlaWdodCk7CisKKwlsb2cyX2JsazI1Nl93aWR0aCA9IGRtbF9sb2cyKChkb3VibGUp
IGJsazI1Nl93aWR0aCk7CisJbG9nMl9ibGsyNTZfaGVpZ2h0ID0gZG1sX2xvZzIoKGRvdWJsZSkg
YmxrMjU2X2hlaWdodCk7CisJYmxrX2J5dGVzID0gc3VyZl9saW5lYXIgPworCQkJMjU2IDogZ2V0
X2Jsa19zaXplX2J5dGVzKChlbnVtIHNvdXJjZV9tYWNyb190aWxlX3NpemUpIG1hY3JvX3RpbGVf
c2l6ZSk7CisJbG9nMl9ibGtfYnl0ZXMgPSBkbWxfbG9nMigoZG91YmxlKSBibGtfYnl0ZXMpOwor
CWxvZzJfYmxrX2hlaWdodCA9IDA7CisJbG9nMl9ibGtfd2lkdGggPSAwOworCisJLy8gcmVtZW1i
ZXIgbG9nIHJ1bGUKKwkvLyAiKyIgaW4gbG9nIGlzIG11bHRpcGx5CisJLy8gIi0iIGluIGxvZyBp
cyBkaXZpZGUKKwkvLyAiLzIiIGlzIGxpa2Ugc3F1YXJlIHJvb3QKKwkvLyBibGsgaXMgdmVydGlj
YWwgYmlhc2VkCisJaWYgKHRpbGluZyAhPSBkbV9zd19saW5lYXIpCisJCWxvZzJfYmxrX2hlaWdo
dCA9IGxvZzJfYmxrMjU2X2hlaWdodAorCQkJCSsgZG1sX2NlaWwoKGRvdWJsZSkgKGxvZzJfYmxr
X2J5dGVzIC0gOCkgLyAyLjAsIDEpOworCWVsc2UKKwkJbG9nMl9ibGtfaGVpZ2h0ID0gMDsgIC8v
IGJsayBoZWlnaHQgb2YgMQorCisJbG9nMl9ibGtfd2lkdGggPSBsb2cyX2Jsa19ieXRlcyAtIGxv
ZzJfYnl0ZXNfcGVyX2VsZW1lbnQgLSBsb2cyX2Jsa19oZWlnaHQ7CisKKwlpZiAoIXN1cmZfdmVy
dCkgeworCQlycV9kbGdfcGFyYW0tPnN3YXRoX3dpZHRoX3ViID0gZG1sX3JvdW5kX3RvX211bHRp
cGxlKHZwX3dpZHRoIC0gMSwgYmxrMjU2X3dpZHRoLCAxKQorCQkJCSsgYmxrMjU2X3dpZHRoOwor
CQlycV9kbGdfcGFyYW0tPnJlcV9wZXJfc3dhdGhfdWIgPSBycV9kbGdfcGFyYW0tPnN3YXRoX3dp
ZHRoX3ViID4+IGxvZzJfYmxrMjU2X3dpZHRoOworCX0gZWxzZSB7CisJCXJxX2RsZ19wYXJhbS0+
c3dhdGhfd2lkdGhfdWIgPSBkbWxfcm91bmRfdG9fbXVsdGlwbGUodnBfaGVpZ2h0IC0gMSwgYmxr
MjU2X2hlaWdodCwgMSkKKwkJCQkrIGJsazI1Nl9oZWlnaHQ7CisJCXJxX2RsZ19wYXJhbS0+cmVx
X3Blcl9zd2F0aF91YiA9IHJxX2RsZ19wYXJhbS0+c3dhdGhfd2lkdGhfdWIgPj4gbG9nMl9ibGsy
NTZfaGVpZ2h0OworCX0KKworCWlmICghc3VyZl92ZXJ0KQorCQlycV9taXNjX3BhcmFtLT5mdWxs
X3N3YXRoX2J5dGVzID0gcnFfZGxnX3BhcmFtLT5zd2F0aF93aWR0aF91YiAqIGJsazI1Nl9oZWln
aHQKKwkJCQkqIGJ5dGVzX3Blcl9lbGVtZW50OworCWVsc2UKKwkJcnFfbWlzY19wYXJhbS0+ZnVs
bF9zd2F0aF9ieXRlcyA9IHJxX2RsZ19wYXJhbS0+c3dhdGhfd2lkdGhfdWIgKiBibGsyNTZfd2lk
dGgKKwkJCQkqIGJ5dGVzX3Blcl9lbGVtZW50OworCisJcnFfbWlzY19wYXJhbS0+YmxrMjU2X2hl
aWdodCA9IGJsazI1Nl9oZWlnaHQ7CisJcnFfbWlzY19wYXJhbS0+YmxrMjU2X3dpZHRoID0gYmxr
MjU2X3dpZHRoOworCisJLy8gLS0tLS0tLQorCS8vIG1ldGEKKwkvLyAtLS0tLS0tCisJbG9nMl9t
ZXRhX3JlcV9ieXRlcyA9IDY7IC8vIG1ldGEgcmVxdWVzdCBpcyA2NGIgYW5kIGlzIDh4OGJ5dGUg
bWV0YSBlbGVtZW50CisKKwkvLyBlYWNoIDY0YiBtZXRhIHJlcXVlc3QgZm9yIGRjbiBpcyA4eDgg
bWV0YSBlbGVtZW50cyBhbmQKKwkvLyBhIG1ldGEgZWxlbWVudCBjb3ZlcnMgb25lIDI1NmIgYmxv
Y2sgb2YgdGhlIHRoZSBkYXRhIHN1cmZhY2UuCisJbG9nMl9tZXRhX3JlcV9oZWlnaHQgPSBsb2cy
X2JsazI1Nl9oZWlnaHQgKyAzOyAvLyBtZXRhIHJlcSBpcyA4eDggYnl0ZSwgZWFjaCBieXRlIHJl
cHJlc2VudCAxIGJsazI1NgorCWxvZzJfbWV0YV9yZXFfd2lkdGggPSBsb2cyX21ldGFfcmVxX2J5
dGVzICsgOCAtIGxvZzJfYnl0ZXNfcGVyX2VsZW1lbnQKKwkJCS0gbG9nMl9tZXRhX3JlcV9oZWln
aHQ7CisJbWV0YV9yZXFfd2lkdGggPSAxIDw8IGxvZzJfbWV0YV9yZXFfd2lkdGg7CisJbWV0YV9y
ZXFfaGVpZ2h0ID0gMSA8PCBsb2cyX21ldGFfcmVxX2hlaWdodDsKKwlsb2cyX21ldGFfcm93X2hl
aWdodCA9IDA7CisJbWV0YV9yb3dfd2lkdGhfdWIgPSAwOworCisJLy8gdGhlIGRpbWVuc2lvbnMg
b2YgYSBtZXRhIHJvdyBhcmUgbWV0YV9yb3dfd2lkdGggeCBtZXRhX3Jvd19oZWlnaHQgaW4gZWxl
bWVudHMuCisJLy8gY2FsY3VsYXRlIHVwcGVyIGJvdW5kIG9mIHRoZSBtZXRhX3Jvd193aWR0aAor
CWlmICghc3VyZl92ZXJ0KSB7CisJCWxvZzJfbWV0YV9yb3dfaGVpZ2h0ID0gbG9nMl9tZXRhX3Jl
cV9oZWlnaHQ7CisJCW1ldGFfcm93X3dpZHRoX3ViID0gZG1sX3JvdW5kX3RvX211bHRpcGxlKHZw
X3dpZHRoIC0gMSwgbWV0YV9yZXFfd2lkdGgsIDEpCisJCQkJKyBtZXRhX3JlcV93aWR0aDsKKwkJ
cnFfZGxnX3BhcmFtLT5tZXRhX3JlcV9wZXJfcm93X3ViID0gbWV0YV9yb3dfd2lkdGhfdWIgLyBt
ZXRhX3JlcV93aWR0aDsKKwl9IGVsc2UgeworCQlsb2cyX21ldGFfcm93X2hlaWdodCA9IGxvZzJf
bWV0YV9yZXFfd2lkdGg7CisJCW1ldGFfcm93X3dpZHRoX3ViID0gZG1sX3JvdW5kX3RvX211bHRp
cGxlKHZwX2hlaWdodCAtIDEsIG1ldGFfcmVxX2hlaWdodCwgMSkKKwkJCQkrIG1ldGFfcmVxX2hl
aWdodDsKKwkJcnFfZGxnX3BhcmFtLT5tZXRhX3JlcV9wZXJfcm93X3ViID0gbWV0YV9yb3dfd2lk
dGhfdWIgLyBtZXRhX3JlcV9oZWlnaHQ7CisJfQorCXJxX2RsZ19wYXJhbS0+bWV0YV9ieXRlc19w
ZXJfcm93X3ViID0gcnFfZGxnX3BhcmFtLT5tZXRhX3JlcV9wZXJfcm93X3ViICogNjQ7CisKKwly
cV9kbGdfcGFyYW0tPm1ldGFfcm93X2hlaWdodCA9IDEgPDwgbG9nMl9tZXRhX3Jvd19oZWlnaHQ7
CisKKwlsb2cyX21ldGFfY2h1bmtfYnl0ZXMgPSBkbWxfbG9nMihycV9zaXppbmdfcGFyYW0tPm1l
dGFfY2h1bmtfYnl0ZXMpOworCWxvZzJfbWV0YV9jaHVua19oZWlnaHQgPSBsb2cyX21ldGFfcm93
X2hlaWdodDsKKworCS8vZnVsbCBzaXplZCBtZXRhIGNodW5rIHdpZHRoIGluIHVuaXQgb2YgZGF0
YSBlbGVtZW50cworCWxvZzJfbWV0YV9jaHVua193aWR0aCA9IGxvZzJfbWV0YV9jaHVua19ieXRl
cyArIDggLSBsb2cyX2J5dGVzX3Blcl9lbGVtZW50CisJCQktIGxvZzJfbWV0YV9jaHVua19oZWln
aHQ7CisJbG9nMl9taW5fbWV0YV9jaHVua19ieXRlcyA9IGRtbF9sb2cyKHJxX3NpemluZ19wYXJh
bS0+bWluX21ldGFfY2h1bmtfYnl0ZXMpOworCW1pbl9tZXRhX2NodW5rX3dpZHRoID0gMQorCQkJ
PDwgKGxvZzJfbWluX21ldGFfY2h1bmtfYnl0ZXMgKyA4IC0gbG9nMl9ieXRlc19wZXJfZWxlbWVu
dAorCQkJCQktIGxvZzJfbWV0YV9jaHVua19oZWlnaHQpOworCW1ldGFfY2h1bmtfd2lkdGggPSAx
IDw8IGxvZzJfbWV0YV9jaHVua193aWR0aDsKKwltZXRhX2NodW5rX3Blcl9yb3dfaW50ID0gKHVu
c2lnbmVkIGludCkgKG1ldGFfcm93X3dpZHRoX3ViIC8gbWV0YV9jaHVua193aWR0aCk7CisJbWV0
YV9yb3dfcmVtYWluZGVyID0gbWV0YV9yb3dfd2lkdGhfdWIgJSBtZXRhX2NodW5rX3dpZHRoOwor
CW1ldGFfY2h1bmtfdGhyZXNob2xkID0gMDsKKwltZXRhX2Jsa19ieXRlcyA9IDQwOTY7CisJbWV0
YV9ibGtfaGVpZ2h0ID0gYmxrMjU2X2hlaWdodCAqIDY0OworCW1ldGFfYmxrX3dpZHRoID0gbWV0
YV9ibGtfYnl0ZXMgKiAyNTYgLyBieXRlc19wZXJfZWxlbWVudCAvIG1ldGFfYmxrX2hlaWdodDsK
KwltZXRhX3N1cmZhY2VfYnl0ZXMgPSBtZXRhX3BpdGNoCisJCQkqIChkbWxfcm91bmRfdG9fbXVs
dGlwbGUodnBfaGVpZ2h0IC0gMSwgbWV0YV9ibGtfaGVpZ2h0LCAxKSArIG1ldGFfYmxrX2hlaWdo
dCkKKwkJCSogYnl0ZXNfcGVyX2VsZW1lbnQgLyAyNTY7CisJdm1wZ19ieXRlcyA9IG1vZGVfbGli
LT5zb2Mudm1tX3BhZ2Vfc2l6ZV9ieXRlczsKKwltZXRhX3B0ZV9yZXFfcGVyX2ZyYW1lX3ViID0g
KGRtbF9yb3VuZF90b19tdWx0aXBsZShtZXRhX3N1cmZhY2VfYnl0ZXMgLSB2bXBnX2J5dGVzLAor
CQkJOCAqIHZtcGdfYnl0ZXMsCisJCQkxKSArIDggKiB2bXBnX2J5dGVzKSAvICg4ICogdm1wZ19i
eXRlcyk7CisJbWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1lX3ViID0gbWV0YV9wdGVfcmVxX3Blcl9m
cmFtZV91YiAqIDY0OyAvLzY0QiBtcHRlIHJlcXVlc3QKKwlycV9kbGdfcGFyYW0tPm1ldGFfcHRl
X2J5dGVzX3Blcl9mcmFtZV91YiA9IG1ldGFfcHRlX2J5dGVzX3Blcl9mcmFtZV91YjsKKworCWRt
bF9wcmludCgiRE1MX0RMRzogJXM6IG1ldGFfYmxrX2hlaWdodCAgICAgICAgICAgICA9ICVkXG4i
LCBfX2Z1bmNfXywgbWV0YV9ibGtfaGVpZ2h0KTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBt
ZXRhX2Jsa193aWR0aCAgICAgICAgICAgICAgPSAlZFxuIiwgX19mdW5jX18sIG1ldGFfYmxrX3dp
ZHRoKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBtZXRhX3N1cmZhY2VfYnl0ZXMgICAgICAg
ICAgPSAlZFxuIiwgX19mdW5jX18sIG1ldGFfc3VyZmFjZV9ieXRlcyk7CisJZG1sX3ByaW50KCJE
TUxfRExHOiAlczogbWV0YV9wdGVfcmVxX3Blcl9mcmFtZV91YiAgID0gJWRcbiIsCisJCQlfX2Z1
bmNfXywKKwkJCW1ldGFfcHRlX3JlcV9wZXJfZnJhbWVfdWIpOworCWRtbF9wcmludCgiRE1MX0RM
RzogJXM6IG1ldGFfcHRlX2J5dGVzX3Blcl9mcmFtZV91YiA9ICVkXG4iLAorCQkJX19mdW5jX18s
CisJCQltZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWIpOworCisJaWYgKCFzdXJmX3ZlcnQpCisJ
CW1ldGFfY2h1bmtfdGhyZXNob2xkID0gMiAqIG1pbl9tZXRhX2NodW5rX3dpZHRoIC0gbWV0YV9y
ZXFfd2lkdGg7CisJZWxzZQorCQltZXRhX2NodW5rX3RocmVzaG9sZCA9IDIgKiBtaW5fbWV0YV9j
aHVua193aWR0aCAtIG1ldGFfcmVxX2hlaWdodDsKKworCWlmIChtZXRhX3Jvd19yZW1haW5kZXIg
PD0gbWV0YV9jaHVua190aHJlc2hvbGQpCisJCXJxX2RsZ19wYXJhbS0+bWV0YV9jaHVua3NfcGVy
X3Jvd191YiA9IG1ldGFfY2h1bmtfcGVyX3Jvd19pbnQgKyAxOworCWVsc2UKKwkJcnFfZGxnX3Bh
cmFtLT5tZXRhX2NodW5rc19wZXJfcm93X3ViID0gbWV0YV9jaHVua19wZXJfcm93X2ludCArIDI7
CisKKwkvLyAtLS0tLS0KKwkvLyBkcHRlCisJLy8gLS0tLS0tCisJaWYgKHN1cmZfbGluZWFyKSB7
CisJCWxvZzJfdm1wZ19oZWlnaHQgPSAwOyAgIC8vIG9uZSBsaW5lIGhpZ2gKKwl9IGVsc2Ugewor
CQlsb2cyX3ZtcGdfaGVpZ2h0ID0gKGxvZzJfdm1wZ19ieXRlcyAtIDgpIC8gMiArIGxvZzJfYmxr
MjU2X2hlaWdodDsKKwl9CisJbG9nMl92bXBnX3dpZHRoID0gbG9nMl92bXBnX2J5dGVzIC0gbG9n
Ml9ieXRlc19wZXJfZWxlbWVudCAtIGxvZzJfdm1wZ19oZWlnaHQ7CisKKwkvLyBvbmx5IDMgcG9z
c2libGUgc2hhcGVzIGZvciBkcHRlIHJlcXVlc3QgaW4gZGltZW5zaW9ucyBvZiBwdGVzOiA4eDEs
IDR4MiwgMng0LgorCWlmIChzdXJmX2xpbmVhcikgeyAvL29uZSA2NEIgUFRFIHJlcXVlc3QgcmV0
dXJucyA4IFBURXMKKwkJbG9nMl9kcHRlX3JlcV9oZWlnaHRfcHRlcyA9IDA7CisJCWxvZzJfZHB0
ZV9yZXFfd2lkdGggPSBsb2cyX3ZtcGdfd2lkdGggKyAzOworCQlsb2cyX2RwdGVfcmVxX2hlaWdo
dCA9IDA7CisJfSBlbHNlIGlmIChsb2cyX2Jsa19ieXRlcyA9PSAxMikgeyAvLzRLQiB0aWxlIG1l
YW5zIDRrQiBwYWdlIHNpemUKKwkJLy9vbmUgNjRCIHJlcSBnaXZlcyA4eDEgUFRFcyBmb3IgNEtC
IHRpbGUKKwkJbG9nMl9kcHRlX3JlcV9oZWlnaHRfcHRlcyA9IDA7CisJCWxvZzJfZHB0ZV9yZXFf
d2lkdGggPSBsb2cyX2Jsa193aWR0aCArIDM7CisJCWxvZzJfZHB0ZV9yZXFfaGVpZ2h0ID0gbG9n
Ml9ibGtfaGVpZ2h0ICsgMDsKKwl9IGVsc2UgaWYgKChsb2cyX2Jsa19ieXRlcyA+PSAxNikgJiYg
KGxvZzJfdm1wZ19ieXRlcyA9PSAxMikpIHsgLy8gdGlsZSBibG9jayA+PSA2NEtCCisJCS8vdHdv
IDY0QiByZXFzIG9mIDJ4NCBQVEVzIGdpdmUgMTYgUFRFcyB0byBjb3ZlciA2NEtCCisJCWxvZzJf
ZHB0ZV9yZXFfaGVpZ2h0X3B0ZXMgPSA0OworCQlsb2cyX2RwdGVfcmVxX3dpZHRoID0gbG9nMl9i
bGsyNTZfd2lkdGggKyA0OyAvLyBsb2cyXzY0S0Jfd2lkdGgKKwkJbG9nMl9kcHRlX3JlcV9oZWln
aHQgPSBsb2cyX2JsazI1Nl9oZWlnaHQgKyA0OyAvLyBsb2cyXzY0S0JfaGVpZ2h0CisJfSBlbHNl
IHsgLy82NEtCIHBhZ2Ugc2l6ZSBhbmQgbXVzdCA2NEtCIHRpbGUgYmxvY2sKKwkJIC8vb25lIDY0
QiByZXEgZ2l2ZXMgOHgxIFBURXMgZm9yIDY0S0IgdGlsZQorCQlsb2cyX2RwdGVfcmVxX2hlaWdo
dF9wdGVzID0gMDsKKwkJbG9nMl9kcHRlX3JlcV93aWR0aCA9IGxvZzJfYmxrX3dpZHRoICsgMzsK
KwkJbG9nMl9kcHRlX3JlcV9oZWlnaHQgPSBsb2cyX2Jsa19oZWlnaHQgKyAwOworCX0KKworCS8v
IFRoZSBkcHRlIHJlcXVlc3QgZGltZW5zaW9ucyBpbiBkYXRhIGVsZW1lbnRzIGlzIGRwdGVfcmVx
X3dpZHRoIHggZHB0ZV9yZXFfaGVpZ2h0CisJLy8gbG9nMl92bXBnX3dpZHRoIGlzIGhvdyBtdWNo
IDEgcHRlIHJlcHJlc2VudCwgbm93IGNhbGN1bGF0aW5nIGhvdyBtdWNoIGEgNjRiIHB0ZSByZXEg
cmVwcmVzZW50CisJLy8gVGhhdCBkZXBlbmRzIG9uIHRoZSBwdGUgc2hhcGUgKGkuZS4gOHgxLCA0
eDIsIDJ4NCkKKwkvL2xvZzJfZHB0ZV9yZXFfaGVpZ2h0ICAgID0gbG9nMl92bXBnX2hlaWdodCAr
IGxvZzJfZHB0ZV9yZXFfaGVpZ2h0X3B0ZXM7CisJLy9sb2cyX2RwdGVfcmVxX3dpZHRoICAgICA9
IGxvZzJfdm1wZ193aWR0aCArIGxvZzJfZHB0ZV9yZXFfd2lkdGhfcHRlczsKKwlkcHRlX3JlcV9o
ZWlnaHQgPSAxIDw8IGxvZzJfZHB0ZV9yZXFfaGVpZ2h0OworCWRwdGVfcmVxX3dpZHRoID0gMSA8
PCBsb2cyX2RwdGVfcmVxX3dpZHRoOworCisJLy8gY2FsY3VsYXRlIHBpdGNoIGRwdGUgcm93IGJ1
ZmZlciBjYW4gaG9sZAorCS8vIHJvdW5kIHRoZSByZXN1bHQgZG93biB0byBhIHBvd2VyIG9mIHR3
by4KKwlwZGVfYnVmX2VudHJpZXMgPSB5dXY0MjAgPyAocGRlX3Byb2NfYnVmZmVyX3NpemVfNjRr
X3JlcXMgPj4gMSkgOiBwZGVfcHJvY19idWZmZXJfc2l6ZV82NGtfcmVxczsKKwlpZiAoc3VyZl9s
aW5lYXIpIHsKKwkJdW5zaWduZWQgaW50IGRwdGVfcm93X2hlaWdodDsKKworCQlsb2cyX2RwdGVf
cm93X2hlaWdodF9saW5lYXIgPSBkbWxfZmxvb3IoZG1sX2xvZzIoZG1sX21pbig2NCAqIDEwMjQg
KiBwZGVfYnVmX2VudHJpZXMKKwkJCQkJCQkJCQkvIGJ5dGVzX3Blcl9lbGVtZW50LAorCQkJCQkJ
CQlkcHRlX2J1Zl9pbl9wdGVfcmVxcworCQkJCQkJCQkJCSogZHB0ZV9yZXFfd2lkdGgpCisJCQkJ
CQkJCS8gZGF0YV9waXRjaCksCisJCQkJMSk7CisKKwkJQVNTRVJUKGxvZzJfZHB0ZV9yb3dfaGVp
Z2h0X2xpbmVhciA+PSAzKTsKKworCQlpZiAobG9nMl9kcHRlX3Jvd19oZWlnaHRfbGluZWFyID4g
NykKKwkJCWxvZzJfZHB0ZV9yb3dfaGVpZ2h0X2xpbmVhciA9IDc7CisKKwkJbG9nMl9kcHRlX3Jv
d19oZWlnaHQgPSBsb2cyX2RwdGVfcm93X2hlaWdodF9saW5lYXI7CisJCS8vIEZvciBsaW5lYXIs
IHRoZSBkcHRlIHJvdyBpcyBwaXRjaCBkZXBlbmRlbnQgYW5kIHRoZSBwdGUgcmVxdWVzdHMgd3Jh
cCBhdCB0aGUgcGl0Y2ggYm91bmRhcnkuCisJCS8vIHRoZSBkcHRlX3Jvd193aWR0aF91YiBpcyB0
aGUgdXBwZXIgYm91bmQgb2YgZGF0YV9waXRjaCpkcHRlX3Jvd19oZWlnaHQgaW4gZWxlbWVudHMg
d2l0aCB0aGlzIHVuaXF1ZSBidWZmZXJpbmcuCisJCWRwdGVfcm93X2hlaWdodCA9IDEgPDwgbG9n
Ml9kcHRlX3Jvd19oZWlnaHQ7CisJCWRwdGVfcm93X3dpZHRoX3ViID0gZG1sX3JvdW5kX3RvX211
bHRpcGxlKGRhdGFfcGl0Y2ggKiBkcHRlX3Jvd19oZWlnaHQgLSAxLAorCQkJCWRwdGVfcmVxX3dp
ZHRoLAorCQkJCTEpICsgZHB0ZV9yZXFfd2lkdGg7CisJCXJxX2RsZ19wYXJhbS0+ZHB0ZV9yZXFf
cGVyX3Jvd191YiA9IGRwdGVfcm93X3dpZHRoX3ViIC8gZHB0ZV9yZXFfd2lkdGg7CisJfSBlbHNl
IHsKKwkJLy8gdGhlIHVwcGVyIGJvdW5kIG9mIHRoZSBkcHRlX3Jvd193aWR0aCB3aXRob3V0IGRl
cGVuZGVuY3kgb24gdmlld3BvcnQgcG9zaXRpb24gZm9sbG93cy4KKwkJLy8gZm9yIHRpbGVkIG1v
ZGUsIHJvdyBoZWlnaHQgaXMgdGhlIHNhbWUgYXMgcmVxIGhlaWdodCBhbmQgcm93IHN0b3JlIHVw
IHRvIHZwIHNpemUgdXBwZXIgYm91bmQKKwkJaWYgKCFzdXJmX3ZlcnQpIHsKKwkJCWxvZzJfZHB0
ZV9yb3dfaGVpZ2h0ID0gbG9nMl9kcHRlX3JlcV9oZWlnaHQ7CisJCQlkcHRlX3Jvd193aWR0aF91
YiA9IGRtbF9yb3VuZF90b19tdWx0aXBsZSh2cF93aWR0aCAtIDEsIGRwdGVfcmVxX3dpZHRoLCAx
KQorCQkJCQkrIGRwdGVfcmVxX3dpZHRoOworCQkJcnFfZGxnX3BhcmFtLT5kcHRlX3JlcV9wZXJf
cm93X3ViID0gZHB0ZV9yb3dfd2lkdGhfdWIgLyBkcHRlX3JlcV93aWR0aDsKKwkJfSBlbHNlIHsK
KwkJCWxvZzJfZHB0ZV9yb3dfaGVpZ2h0ID0KKwkJCQkJKGxvZzJfYmxrX3dpZHRoIDwgbG9nMl9k
cHRlX3JlcV93aWR0aCkgPworCQkJCQkJCWxvZzJfYmxrX3dpZHRoIDogbG9nMl9kcHRlX3JlcV93
aWR0aDsKKwkJCWRwdGVfcm93X3dpZHRoX3ViID0gZG1sX3JvdW5kX3RvX211bHRpcGxlKHZwX2hl
aWdodCAtIDEsIGRwdGVfcmVxX2hlaWdodCwgMSkKKwkJCQkJKyBkcHRlX3JlcV9oZWlnaHQ7CisJ
CQlycV9kbGdfcGFyYW0tPmRwdGVfcmVxX3Blcl9yb3dfdWIgPSBkcHRlX3Jvd193aWR0aF91YiAv
IGRwdGVfcmVxX2hlaWdodDsKKwkJfQorCX0KKwlpZiAobG9nMl9ibGtfYnl0ZXMgPj0gMTYgJiYg
bG9nMl92bXBnX2J5dGVzID09IDEyKSAvLyB0aWxlIGJsb2NrID49IDY0S0IKKwkJcnFfZGxnX3Bh
cmFtLT5kcHRlX2J5dGVzX3Blcl9yb3dfdWIgPSBycV9kbGdfcGFyYW0tPmRwdGVfcmVxX3Blcl9y
b3dfdWIgKiAxMjg7IC8vMio2NEIgZHB0ZSByZXF1ZXN0CisJZWxzZQorCQlycV9kbGdfcGFyYW0t
PmRwdGVfYnl0ZXNfcGVyX3Jvd191YiA9IHJxX2RsZ19wYXJhbS0+ZHB0ZV9yZXFfcGVyX3Jvd191
YiAqIDY0OyAvLzY0QiBkcHRlIHJlcXVlc3QKKworCXJxX2RsZ19wYXJhbS0+ZHB0ZV9yb3dfaGVp
Z2h0ID0gMSA8PCBsb2cyX2RwdGVfcm93X2hlaWdodDsKKworCS8vIHRoZSBkcHRlX2dyb3VwX2J5
dGVzIGlzIHJlZHVjZWQgZm9yIHRoZSBzcGVjaWZpYyBjYXNlIG9mIHZlcnRpY2FsCisJLy8gYWNj
ZXNzIG9mIGEgdGlsZSBzdXJmYWNlIHRoYXQgaGFzIGRwdGUgcmVxdWVzdCBvZiA4eDEgcHRlcy4K
KwlpZiAoIXN1cmZfbGluZWFyICYgKGxvZzJfZHB0ZV9yZXFfaGVpZ2h0X3B0ZXMgPT0gMCkgJiBz
dXJmX3ZlcnQpIC8vcmVkdWNlZCwgaW4gdGhpcyBjYXNlLCB3aWxsIGhhdmUgcGFnZSBmYXVsdCB3
aXRoaW4gYSBncm91cAorCQlycV9zaXppbmdfcGFyYW0tPmRwdGVfZ3JvdXBfYnl0ZXMgPSA1MTI7
CisJZWxzZQorCQkvL2Z1bGwgc2l6ZQorCQlycV9zaXppbmdfcGFyYW0tPmRwdGVfZ3JvdXBfYnl0
ZXMgPSAyMDQ4OworCisJLy9zaW5jZSBwdGUgcmVxdWVzdCBzaXplIGlzIDY0Ynl0ZSwgdGhlIG51
bWJlciBvZiBkYXRhIHB0ZSByZXF1ZXN0cyBwZXIgZnVsbCBzaXplZCBncm91cCBpcyBhcyBmb2xs
b3dzLgorCWxvZzJfZHB0ZV9ncm91cF9ieXRlcyA9IGRtbF9sb2cyKHJxX3NpemluZ19wYXJhbS0+
ZHB0ZV9ncm91cF9ieXRlcyk7CisJbG9nMl9kcHRlX2dyb3VwX2xlbmd0aCA9IGxvZzJfZHB0ZV9n
cm91cF9ieXRlcyAtIDY7IC8vbGVuZ3RoIGluIDY0YiByZXF1ZXN0cworCisJLy8gZnVsbCBzaXpl
ZCBkYXRhIHB0ZSBncm91cCB3aWR0aCBpbiBlbGVtZW50cworCWlmICghc3VyZl92ZXJ0KQorCQls
b2cyX2RwdGVfZ3JvdXBfd2lkdGggPSBsb2cyX2RwdGVfZ3JvdXBfbGVuZ3RoICsgbG9nMl9kcHRl
X3JlcV93aWR0aDsKKwllbHNlCisJCWxvZzJfZHB0ZV9ncm91cF93aWR0aCA9IGxvZzJfZHB0ZV9n
cm91cF9sZW5ndGggKyBsb2cyX2RwdGVfcmVxX2hlaWdodDsKKworCS8vQnV0IGlmIHRoZSB0aWxl
IGJsb2NrID49NjRLQiBhbmQgdGhlIHBhZ2Ugc2l6ZSBpcyA0S0IsIHRoZW4gZWFjaCBkUFRFIHJl
cXVlc3QgaXMgMio2NEIKKwlpZiAoKGxvZzJfYmxrX2J5dGVzID49IDE2KSAmJiAobG9nMl92bXBn
X2J5dGVzID09IDEyKSkgLy8gdGlsZSBibG9jayA+PSA2NEtCCisJCWxvZzJfZHB0ZV9ncm91cF93
aWR0aCA9IGxvZzJfZHB0ZV9ncm91cF93aWR0aCAtIDE7CisKKwlkcHRlX2dyb3VwX3dpZHRoID0g
MSA8PCBsb2cyX2RwdGVfZ3JvdXBfd2lkdGg7CisKKwkvLyBzaW5jZSBkcHRlIGdyb3VwcyBhcmUg
b25seSBhbGlnbmVkIHRvIGRwdGVfcmVxX3dpZHRoIGFuZCBub3QgZHB0ZV9ncm91cF93aWR0aCwK
KwkvLyB0aGUgdXBwZXIgYm91bmQgZm9yIHRoZSBkcHRlIGdyb3VwcyBwZXIgcm93IGlzIGFzIGZv
bGxvd3MuCisJcnFfZGxnX3BhcmFtLT5kcHRlX2dyb3Vwc19wZXJfcm93X3ViID0gZG1sX2NlaWwo
KGRvdWJsZSkgZHB0ZV9yb3dfd2lkdGhfdWIgLyBkcHRlX2dyb3VwX3dpZHRoLAorCQkJMSk7Cit9
CisKK3N0YXRpYyB2b2lkIGdldF9zdXJmX3JxX3BhcmFtKHN0cnVjdCBkaXNwbGF5X21vZGVfbGli
ICptb2RlX2xpYiwKKwkJZGlzcGxheV9kYXRhX3JxX3NpemluZ19wYXJhbXNfc3QgKnJxX3Npemlu
Z19wYXJhbSwKKwkJZGlzcGxheV9kYXRhX3JxX2RsZ19wYXJhbXNfc3QgKnJxX2RsZ19wYXJhbSwK
KwkJZGlzcGxheV9kYXRhX3JxX21pc2NfcGFyYW1zX3N0ICpycV9taXNjX3BhcmFtLAorCQljb25z
dCBkaXNwbGF5X3BpcGVfc291cmNlX3BhcmFtc19zdCBwaXBlX3NyY19wYXJhbSwKKwkJYm9vbCBp
c19jaHJvbWEpCit7CisJYm9vbCBtb2RlXzQyMiA9IDA7CisJdW5zaWduZWQgaW50IHZwX3dpZHRo
ID0gMDsKKwl1bnNpZ25lZCBpbnQgdnBfaGVpZ2h0ID0gMDsKKwl1bnNpZ25lZCBpbnQgZGF0YV9w
aXRjaCA9IDA7CisJdW5zaWduZWQgaW50IG1ldGFfcGl0Y2ggPSAwOworCXVuc2lnbmVkIGludCBw
cGUgPSBtb2RlXzQyMiA/IDIgOiAxOworCisJLy8gRklYTUUgY2hlY2sgaWYgcHBlIGFwcGx5IGZv
ciBib3RoIGx1bWEgYW5kIGNocm9tYSBpbiA0MjIgY2FzZQorCWlmIChpc19jaHJvbWEpIHsKKwkJ
dnBfd2lkdGggPSBwaXBlX3NyY19wYXJhbS52aWV3cG9ydF93aWR0aF9jIC8gcHBlOworCQl2cF9o
ZWlnaHQgPSBwaXBlX3NyY19wYXJhbS52aWV3cG9ydF9oZWlnaHRfYzsKKwkJZGF0YV9waXRjaCA9
IHBpcGVfc3JjX3BhcmFtLmRhdGFfcGl0Y2hfYzsKKwkJbWV0YV9waXRjaCA9IHBpcGVfc3JjX3Bh
cmFtLm1ldGFfcGl0Y2hfYzsKKwl9IGVsc2UgeworCQl2cF93aWR0aCA9IHBpcGVfc3JjX3BhcmFt
LnZpZXdwb3J0X3dpZHRoIC8gcHBlOworCQl2cF9oZWlnaHQgPSBwaXBlX3NyY19wYXJhbS52aWV3
cG9ydF9oZWlnaHQ7CisJCWRhdGFfcGl0Y2ggPSBwaXBlX3NyY19wYXJhbS5kYXRhX3BpdGNoOwor
CQltZXRhX3BpdGNoID0gcGlwZV9zcmNfcGFyYW0ubWV0YV9waXRjaDsKKwl9CisKKwlycV9zaXpp
bmdfcGFyYW0tPmNodW5rX2J5dGVzID0gODE5MjsKKworCWlmIChycV9zaXppbmdfcGFyYW0tPmNo
dW5rX2J5dGVzID09IDY0ICogMTAyNCkKKwkJcnFfc2l6aW5nX3BhcmFtLT5taW5fY2h1bmtfYnl0
ZXMgPSAwOworCWVsc2UKKwkJcnFfc2l6aW5nX3BhcmFtLT5taW5fY2h1bmtfYnl0ZXMgPSAxMDI0
OworCisJcnFfc2l6aW5nX3BhcmFtLT5tZXRhX2NodW5rX2J5dGVzID0gMjA0ODsKKwlycV9zaXpp
bmdfcGFyYW0tPm1pbl9tZXRhX2NodW5rX2J5dGVzID0gMjU2OworCisJcnFfc2l6aW5nX3BhcmFt
LT5tcHRlX2dyb3VwX2J5dGVzID0gMjA0ODsKKworCWdldF9tZXRhX2FuZF9wdGVfYXR0cihtb2Rl
X2xpYiwKKwkJCXJxX2RsZ19wYXJhbSwKKwkJCXJxX21pc2NfcGFyYW0sCisJCQlycV9zaXppbmdf
cGFyYW0sCisJCQl2cF93aWR0aCwKKwkJCXZwX2hlaWdodCwKKwkJCWRhdGFfcGl0Y2gsCisJCQlt
ZXRhX3BpdGNoLAorCQkJcGlwZV9zcmNfcGFyYW0uc291cmNlX2Zvcm1hdCwKKwkJCXBpcGVfc3Jj
X3BhcmFtLnN3X21vZGUsCisJCQlwaXBlX3NyY19wYXJhbS5tYWNyb190aWxlX3NpemUsCisJCQlw
aXBlX3NyY19wYXJhbS5zb3VyY2Vfc2NhbiwKKwkJCWlzX2Nocm9tYSk7Cit9CisKK3N0YXRpYyB2
b2lkIGRtbDIwX3JxX2RsZ19nZXRfcnFfcGFyYW1zKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICpt
b2RlX2xpYiwKKwkJZGlzcGxheV9ycV9wYXJhbXNfc3QgKnJxX3BhcmFtLAorCQljb25zdCBkaXNw
bGF5X3BpcGVfc291cmNlX3BhcmFtc19zdCBwaXBlX3NyY19wYXJhbSkKK3sKKwkvLyBnZXQgcGFy
YW0gZm9yIGx1bWEgc3VyZmFjZQorCXJxX3BhcmFtLT55dXY0MjAgPSBwaXBlX3NyY19wYXJhbS5z
b3VyY2VfZm9ybWF0ID09IGRtXzQyMF84CisJCQl8fCBwaXBlX3NyY19wYXJhbS5zb3VyY2VfZm9y
bWF0ID09IGRtXzQyMF8xMDsKKwlycV9wYXJhbS0+eXV2NDIwXzEwYnBjID0gcGlwZV9zcmNfcGFy
YW0uc291cmNlX2Zvcm1hdCA9PSBkbV80MjBfMTA7CisKKwlnZXRfc3VyZl9ycV9wYXJhbShtb2Rl
X2xpYiwKKwkJCSYocnFfcGFyYW0tPnNpemluZy5ycV9sKSwKKwkJCSYocnFfcGFyYW0tPmRsZy5y
cV9sKSwKKwkJCSYocnFfcGFyYW0tPm1pc2MucnFfbCksCisJCQlwaXBlX3NyY19wYXJhbSwKKwkJ
CTApOworCisJaWYgKGlzX2R1YWxfcGxhbmUoKGVudW0gc291cmNlX2Zvcm1hdF9jbGFzcykocGlw
ZV9zcmNfcGFyYW0uc291cmNlX2Zvcm1hdCkpKSB7CisJCS8vIGdldCBwYXJhbSBmb3IgY2hyb21h
IHN1cmZhY2UKKwkJZ2V0X3N1cmZfcnFfcGFyYW0obW9kZV9saWIsCisJCQkJJihycV9wYXJhbS0+
c2l6aW5nLnJxX2MpLAorCQkJCSYocnFfcGFyYW0tPmRsZy5ycV9jKSwKKwkJCQkmKHJxX3BhcmFt
LT5taXNjLnJxX2MpLAorCQkJCXBpcGVfc3JjX3BhcmFtLAorCQkJCTEpOworCX0KKworCS8vIGNh
bGN1bGF0ZSBob3cgdG8gc3BsaXQgdGhlIGRldCBidWZmZXIgc3BhY2UgYmV0d2VlbiBsdW1hIGFu
ZCBjaHJvbWEKKwloYW5kbGVfZGV0X2J1Zl9zcGxpdChtb2RlX2xpYiwgcnFfcGFyYW0sIHBpcGVf
c3JjX3BhcmFtKTsKKwlwcmludF9fcnFfcGFyYW1zX3N0KG1vZGVfbGliLCAqcnFfcGFyYW0pOwor
fQorCit2b2lkIGRtbDIwX3JxX2RsZ19nZXRfcnFfcmVnKHN0cnVjdCBkaXNwbGF5X21vZGVfbGli
ICptb2RlX2xpYiwKKwkJZGlzcGxheV9ycV9yZWdzX3N0ICpycV9yZWdzLAorCQljb25zdCBkaXNw
bGF5X3BpcGVfcGFyYW1zX3N0IHBpcGVfcGFyYW0pCit7CisJZGlzcGxheV9ycV9wYXJhbXNfc3Qg
cnFfcGFyYW0gPSB7MH07CisKKwltZW1zZXQocnFfcmVncywgMCwgc2l6ZW9mKCpycV9yZWdzKSk7
CisJZG1sMjBfcnFfZGxnX2dldF9ycV9wYXJhbXMobW9kZV9saWIsICZycV9wYXJhbSwgcGlwZV9w
YXJhbS5zcmMpOworCWV4dHJhY3RfcnFfcmVncyhtb2RlX2xpYiwgcnFfcmVncywgcnFfcGFyYW0p
OworCisJcHJpbnRfX3JxX3JlZ3Nfc3QobW9kZV9saWIsICpycV9yZWdzKTsKK30KKworLy8gTm90
ZTogY3VycmVudGx5IHRha2VuIGluIGFzIGlzLgorLy8gTmljZSB0byBkZWNvdXBsZSBjb2RlIGZy
b20gaHcgcmVnaXN0ZXIgaW1wbGVtZW50IGFuZCBleHRyYWN0IGNvZGUgdGhhdCBhcmUgcmVwZWF0
ZWQgZm9yIGx1bWEgYW5kIGNocm9tYS4KK3N0YXRpYyB2b2lkIGRtbDIwX3JxX2RsZ19nZXRfZGxn
X3BhcmFtcyhzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWNvbnN0IGRpc3Bs
YXlfZTJlX3BpcGVfcGFyYW1zX3N0ICplMmVfcGlwZV9wYXJhbSwKKwkJY29uc3QgdW5zaWduZWQg
aW50IG51bV9waXBlcywKKwkJY29uc3QgdW5zaWduZWQgaW50IHBpcGVfaWR4LAorCQlkaXNwbGF5
X2RsZ19yZWdzX3N0ICpkaXNwX2RsZ19yZWdzLAorCQlkaXNwbGF5X3R0dV9yZWdzX3N0ICpkaXNw
X3R0dV9yZWdzLAorCQljb25zdCBkaXNwbGF5X3JxX2RsZ19wYXJhbXNfc3QgcnFfZGxnX3BhcmFt
LAorCQljb25zdCBkaXNwbGF5X2RsZ19zeXNfcGFyYW1zX3N0IGRsZ19zeXNfcGFyYW0sCisJCWNv
bnN0IGJvb2wgY3N0YXRlX2VuLAorCQljb25zdCBib29sIHBzdGF0ZV9lbikKK3sKKwljb25zdCBk
aXNwbGF5X3BpcGVfc291cmNlX3BhcmFtc19zdCAqc3JjID0gJmUyZV9waXBlX3BhcmFtW3BpcGVf
aWR4XS5waXBlLnNyYzsKKwljb25zdCBkaXNwbGF5X3BpcGVfZGVzdF9wYXJhbXNfc3QgKmRzdCA9
ICZlMmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0ucGlwZS5kZXN0OworCWNvbnN0IGRpc3BsYXlfb3V0
cHV0X3BhcmFtc19zdCAqZG91dCA9ICZlMmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0uZG91dDsKKwlj
b25zdCBkaXNwbGF5X2Nsb2Nrc19hbmRfY2ZnX3N0ICpjbGtzID0gJmUyZV9waXBlX3BhcmFtW3Bp
cGVfaWR4XS5jbGtzX2NmZzsKKwljb25zdCBzY2FsZXJfcmF0aW9fZGVwdGhfc3QgKnNjbCA9ICZl
MmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0ucGlwZS5zY2FsZV9yYXRpb19kZXB0aDsKKwljb25zdCBz
Y2FsZXJfdGFwc19zdCAqdGFwcyA9ICZlMmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0ucGlwZS5zY2Fs
ZV90YXBzOworCisJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCS8vIFNlY3Rpb24gMS4x
NS4yLjE6IE9URyBkZXBlbmRlbnQgUGFyYW1zCisJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQorCS8vIFRpbWluZworCXVuc2lnbmVkIGludCBodG90YWwgPSBkc3QtPmh0b3RhbDsKKy8vICAg
IHVuc2lnbmVkIGludCBoYmxhbmtfc3RhcnQgPSBkc3QuaGJsYW5rX3N0YXJ0OyAvLyBUT0RPOiBS
ZW1vdmUKKwl1bnNpZ25lZCBpbnQgaGJsYW5rX2VuZCA9IGRzdC0+aGJsYW5rX2VuZDsKKwl1bnNp
Z25lZCBpbnQgdmJsYW5rX3N0YXJ0ID0gZHN0LT52Ymxhbmtfc3RhcnQ7CisJdW5zaWduZWQgaW50
IHZibGFua19lbmQgPSBkc3QtPnZibGFua19lbmQ7CisJdW5zaWduZWQgaW50IG1pbl92Ymxhbmsg
PSBtb2RlX2xpYi0+aXAubWluX3ZibGFua19saW5lczsKKworCWRvdWJsZSBkcHBjbGtfZnJlcV9p
bl9taHogPSBjbGtzLT5kcHBjbGtfbWh6OworCWRvdWJsZSBkaXNwY2xrX2ZyZXFfaW5fbWh6ID0g
Y2xrcy0+ZGlzcGNsa19taHo7CisJZG91YmxlIHJlZmNsa19mcmVxX2luX21oeiA9IGNsa3MtPnJl
ZmNsa19taHo7CisJZG91YmxlIHBjbGtfZnJlcV9pbl9taHogPSBkc3QtPnBpeGVsX3JhdGVfbWh6
OworCWJvb2wgaW50ZXJsYWNlZCA9IGRzdC0+aW50ZXJsYWNlZDsKKworCWRvdWJsZSByZWZfZnJl
cV90b19waXhfZnJlcSA9IHJlZmNsa19mcmVxX2luX21oeiAvIHBjbGtfZnJlcV9pbl9taHo7CisK
Kwlkb3VibGUgbWluX2RjZmNsa19taHo7CisJZG91YmxlIHRfY2FsY191czsKKwlkb3VibGUgbWlu
X3R0dV92Ymxhbms7CisKKwlkb3VibGUgbWluX2RzdF95X3R0dV92Ymxhbms7CisJdW5zaWduZWQg
aW50IGRsZ192Ymxhbmtfc3RhcnQ7CisJYm9vbCBkdWFsX3BsYW5lOworCWJvb2wgbW9kZV80MjI7
CisJdW5zaWduZWQgaW50IGFjY2Vzc19kaXI7CisJdW5zaWduZWQgaW50IHZwX2hlaWdodF9sOwor
CXVuc2lnbmVkIGludCB2cF93aWR0aF9sOworCXVuc2lnbmVkIGludCB2cF9oZWlnaHRfYzsKKwl1
bnNpZ25lZCBpbnQgdnBfd2lkdGhfYzsKKworCS8vIFNjYWxpbmcKKwl1bnNpZ25lZCBpbnQgaHRh
cHNfbDsKKwl1bnNpZ25lZCBpbnQgaHRhcHNfYzsKKwlkb3VibGUgaHJhdGlvX2w7CisJZG91Ymxl
IGhyYXRpb19jOworCWRvdWJsZSB2cmF0aW9fbDsKKwlkb3VibGUgdnJhdGlvX2M7CisJYm9vbCBz
Y2xfZW5hYmxlOworCisJZG91YmxlIGxpbmVfdGltZV9pbl91czsKKwkvLyAgICBkb3VibGUgdmlu
aXRfbDsKKwkvLyAgICBkb3VibGUgdmluaXRfYzsKKwkvLyAgICBkb3VibGUgdmluaXRfYm90X2w7
CisJLy8gICAgZG91YmxlIHZpbml0X2JvdF9jOworCisJLy8gICAgdW5zaWduZWQgaW50IHN3YXRo
X2hlaWdodF9sOworCXVuc2lnbmVkIGludCBzd2F0aF93aWR0aF91Yl9sOworCS8vICAgIHVuc2ln
bmVkIGludCBkcHRlX2J5dGVzX3Blcl9yb3dfdWJfbDsKKwl1bnNpZ25lZCBpbnQgZHB0ZV9ncm91
cHNfcGVyX3Jvd191Yl9sOworCS8vICAgIHVuc2lnbmVkIGludCBtZXRhX3B0ZV9ieXRlc19wZXJf
ZnJhbWVfdWJfbDsKKwkvLyAgICB1bnNpZ25lZCBpbnQgbWV0YV9ieXRlc19wZXJfcm93X3ViX2w7
CisKKwkvLyAgICB1bnNpZ25lZCBpbnQgc3dhdGhfaGVpZ2h0X2M7CisJdW5zaWduZWQgaW50IHN3
YXRoX3dpZHRoX3ViX2M7CisJLy8gICB1bnNpZ25lZCBpbnQgZHB0ZV9ieXRlc19wZXJfcm93X3Vi
X2M7CisJdW5zaWduZWQgaW50IGRwdGVfZ3JvdXBzX3Blcl9yb3dfdWJfYzsKKworCXVuc2lnbmVk
IGludCBtZXRhX2NodW5rc19wZXJfcm93X3ViX2w7CisJdW5zaWduZWQgaW50IG1ldGFfY2h1bmtz
X3Blcl9yb3dfdWJfYzsKKwl1bnNpZ25lZCBpbnQgdnVwZGF0ZV9vZmZzZXQ7CisJdW5zaWduZWQg
aW50IHZ1cGRhdGVfd2lkdGg7CisJdW5zaWduZWQgaW50IHZyZWFkeV9vZmZzZXQ7CisKKwl1bnNp
Z25lZCBpbnQgZHBwY2xrX2RlbGF5X3N1YnRvdGFsOworCXVuc2lnbmVkIGludCBkaXNwY2xrX2Rl
bGF5X3N1YnRvdGFsOworCXVuc2lnbmVkIGludCBwaXhlbF9yYXRlX2RlbGF5X3N1YnRvdGFsOwor
CisJdW5zaWduZWQgaW50IHZzdGFydHVwX3N0YXJ0OworCXVuc2lnbmVkIGludCBkc3RfeF9hZnRl
cl9zY2FsZXI7CisJdW5zaWduZWQgaW50IGRzdF95X2FmdGVyX3NjYWxlcjsKKwlkb3VibGUgbGlu
ZV93YWl0OworCWRvdWJsZSBkc3RfeV9wcmVmZXRjaDsKKwlkb3VibGUgZHN0X3lfcGVyX3ZtX3Zi
bGFuazsKKwlkb3VibGUgZHN0X3lfcGVyX3Jvd192Ymxhbms7CisJZG91YmxlIGRzdF95X3Blcl92
bV9mbGlwOworCWRvdWJsZSBkc3RfeV9wZXJfcm93X2ZsaXA7CisJZG91YmxlIG1pbl9kc3RfeV9w
ZXJfdm1fdmJsYW5rOworCWRvdWJsZSBtaW5fZHN0X3lfcGVyX3Jvd192Ymxhbms7CisJZG91Ymxl
IGxzdzsKKwlkb3VibGUgdnJhdGlvX3ByZV9sOworCWRvdWJsZSB2cmF0aW9fcHJlX2M7CisJdW5z
aWduZWQgaW50IHJlcV9wZXJfc3dhdGhfdWJfbDsKKwl1bnNpZ25lZCBpbnQgcmVxX3Blcl9zd2F0
aF91Yl9jOworCXVuc2lnbmVkIGludCBtZXRhX3Jvd19oZWlnaHRfbDsKKwl1bnNpZ25lZCBpbnQg
bWV0YV9yb3dfaGVpZ2h0X2M7CisJdW5zaWduZWQgaW50IHN3YXRoX3dpZHRoX3BpeGVsc191Yl9s
OworCXVuc2lnbmVkIGludCBzd2F0aF93aWR0aF9waXhlbHNfdWJfYzsKKwl1bnNpZ25lZCBpbnQg
c2NhbGVyX3JlY19pbl93aWR0aF9sOworCXVuc2lnbmVkIGludCBzY2FsZXJfcmVjX2luX3dpZHRo
X2M7CisJdW5zaWduZWQgaW50IGRwdGVfcm93X2hlaWdodF9sOworCXVuc2lnbmVkIGludCBkcHRl
X3Jvd19oZWlnaHRfYzsKKwlkb3VibGUgaHNjYWxlX3BpeGVsX3JhdGVfbDsKKwlkb3VibGUgaHNj
YWxlX3BpeGVsX3JhdGVfYzsKKwlkb3VibGUgbWluX2hyYXRpb19mYWN0X2w7CisJZG91YmxlIG1p
bl9ocmF0aW9fZmFjdF9jOworCWRvdWJsZSByZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2w7
CisJZG91YmxlIHJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfYzsKKwlkb3VibGUgcmVmY3lj
X3Blcl9saW5lX2RlbGl2ZXJ5X2w7CisJZG91YmxlIHJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9j
OworCisJZG91YmxlIHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9sOworCWRvdWJsZSByZWZj
eWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfYzsKKwlkb3VibGUgcmVmY3ljX3Blcl9yZXFfZGVsaXZl
cnlfbDsKKwlkb3VibGUgcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfYzsKKworCXVuc2lnbmVkIGlu
dCBmdWxsX3JlY291dF93aWR0aDsKKwlkb3VibGUgeGZjX3RyYW5zZmVyX2RlbGF5OworCWRvdWJs
ZSB4ZmNfcHJlY2hhcmdlX2RlbGF5OworCWRvdWJsZSB4ZmNfcmVtb3RlX3N1cmZhY2VfZmxpcF9s
YXRlbmN5OworCWRvdWJsZSB4ZmNfZHN0X3lfZGVsdGFfZHJxX2xpbWl0OworCWRvdWJsZSB4ZmNf
cHJlZmV0Y2hfbWFyZ2luOworCWRvdWJsZSByZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfY3Vy
MDsKKwlkb3VibGUgcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfY3VyMDsKKwlkb3VibGUgcmVmY3lj
X3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1cjE7CisJZG91YmxlIHJlZmN5Y19wZXJfcmVxX2RlbGl2
ZXJ5X2N1cjE7CisKKwltZW1zZXQoZGlzcF9kbGdfcmVncywgMCwgc2l6ZW9mKCpkaXNwX2RsZ19y
ZWdzKSk7CisJbWVtc2V0KGRpc3BfdHR1X3JlZ3MsIDAsIHNpemVvZigqZGlzcF90dHVfcmVncykp
OworCisJZG1sX3ByaW50KCJETUxfRExHOiAlczogIGNzdGF0ZV9lbiA9ICVkXG4iLCBfX2Z1bmNf
XywgY3N0YXRlX2VuKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiAgcHN0YXRlX2VuID0gJWRc
biIsIF9fZnVuY19fLCBwc3RhdGVfZW4pOworCisJZG1sX3ByaW50KCJETUxfRExHOiAlczogZHBw
Y2xrX2ZyZXFfaW5fbWh6ICAgICA9ICUzLjJmXG4iLCBfX2Z1bmNfXywgZHBwY2xrX2ZyZXFfaW5f
bWh6KTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBkaXNwY2xrX2ZyZXFfaW5fbWh6ICAgID0g
JTMuMmZcbiIsIF9fZnVuY19fLCBkaXNwY2xrX2ZyZXFfaW5fbWh6KTsKKwlkbWxfcHJpbnQoIkRN
TF9ETEc6ICVzOiByZWZjbGtfZnJlcV9pbl9taHogICAgID0gJTMuMmZcbiIsIF9fZnVuY19fLCBy
ZWZjbGtfZnJlcV9pbl9taHopOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHBjbGtfZnJlcV9p
bl9taHogICAgICAgPSAlMy4yZlxuIiwgX19mdW5jX18sIHBjbGtfZnJlcV9pbl9taHopOworCWRt
bF9wcmludCgiRE1MX0RMRzogJXM6IGludGVybGFjZWQgICAgICAgICAgICAgPSAlZFxuIiwgX19m
dW5jX18sIGludGVybGFjZWQpOworCUFTU0VSVChyZWZfZnJlcV90b19waXhfZnJlcSA8IDQuMCk7
CisKKwlkaXNwX2RsZ19yZWdzLT5yZWZfZnJlcV90b19waXhfZnJlcSA9CisJCQkodW5zaWduZWQg
aW50KSAocmVmX2ZyZXFfdG9fcGl4X2ZyZXEgKiBkbWxfcG93KDIsIDE5KSk7CisJZGlzcF9kbGdf
cmVncy0+cmVmY3ljX3Blcl9odG90YWwgPSAodW5zaWduZWQgaW50KSAocmVmX2ZyZXFfdG9fcGl4
X2ZyZXEgKiAoZG91YmxlKSBodG90YWwKKwkJCSogZG1sX3BvdygyLCA4KSk7CisJZGlzcF9kbGdf
cmVncy0+ZGxnX3ZibGFua19lbmQgPSBpbnRlcmxhY2VkID8gKHZibGFua19lbmQgLyAyKSA6IHZi
bGFua19lbmQ7IC8vIDE1IGJpdHMKKwlkaXNwX2RsZ19yZWdzLT5yZWZjeWNfaF9ibGFua19lbmQg
PSAodW5zaWduZWQgaW50KSAoKGRvdWJsZSkgaGJsYW5rX2VuZAorCQkJKiAoZG91YmxlKSByZWZf
ZnJlcV90b19waXhfZnJlcSk7CisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19oX2JsYW5r
X2VuZCA8ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwgMTMpKTsKKworCW1pbl9kY2ZjbGtfbWh6
ID0gZGxnX3N5c19wYXJhbS5kZWVwc2xlZXBfZGNmY2xrX21oejsKKwl0X2NhbGNfdXMgPSBnZXRf
dGNhbGMobW9kZV9saWIsIGUyZV9waXBlX3BhcmFtLCBudW1fcGlwZXMpOworCW1pbl90dHVfdmJs
YW5rID0gZ2V0X21pbl90dHVfdmJsYW5rKG1vZGVfbGliLCBlMmVfcGlwZV9wYXJhbSwgbnVtX3Bp
cGVzLCBwaXBlX2lkeCk7CisKKwltaW5fZHN0X3lfdHR1X3ZibGFuayA9IG1pbl90dHVfdmJsYW5r
ICogcGNsa19mcmVxX2luX21oeiAvIChkb3VibGUpIGh0b3RhbDsKKwlkbGdfdmJsYW5rX3N0YXJ0
ID0gaW50ZXJsYWNlZCA/ICh2Ymxhbmtfc3RhcnQgLyAyKSA6IHZibGFua19zdGFydDsKKworCWRp
c3BfZGxnX3JlZ3MtPm1pbl9kc3RfeV9uZXh0X3N0YXJ0ID0gKHVuc2lnbmVkIGludCkgKCgoZG91
YmxlKSBkbGdfdmJsYW5rX3N0YXJ0CisJCQkrIG1pbl9kc3RfeV90dHVfdmJsYW5rKSAqIGRtbF9w
b3coMiwgMikpOworCUFTU0VSVChkaXNwX2RsZ19yZWdzLT5taW5fZHN0X3lfbmV4dF9zdGFydCA8
ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwgMTgpKTsKKworCWRtbF9wcmludCgiRE1MX0RMRzog
JXM6IG1pbl9kY2ZjbGtfbWh6ICAgICAgICAgICAgICAgICAgICAgICAgID0gJTMuMmZcbiIsCisJ
CQlfX2Z1bmNfXywKKwkJCW1pbl9kY2ZjbGtfbWh6KTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVz
OiBtaW5fdHR1X3ZibGFuayAgICAgICAgICAgICAgICAgICAgICAgICA9ICUzLjJmXG4iLAorCQkJ
X19mdW5jX18sCisJCQltaW5fdHR1X3ZibGFuayk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczog
bWluX2RzdF95X3R0dV92YmxhbmsgICAgICAgICAgICAgICAgICAgPSAlMy4yZlxuIiwKKwkJCV9f
ZnVuY19fLAorCQkJbWluX2RzdF95X3R0dV92YmxhbmspOworCWRtbF9wcmludCgiRE1MX0RMRzog
JXM6IHRfY2FsY191cyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gJTMuMmZcbiIsCisJ
CQlfX2Z1bmNfXywKKwkJCXRfY2FsY191cyk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogZGlz
cF9kbGdfcmVncy0+bWluX2RzdF95X25leHRfc3RhcnQgICAgPSAweCUweFxuIiwKKwkJCV9fZnVu
Y19fLAorCQkJZGlzcF9kbGdfcmVncy0+bWluX2RzdF95X25leHRfc3RhcnQpOworCWRtbF9wcmlu
dCgiRE1MX0RMRzogJXM6IHJlZl9mcmVxX3RvX3BpeF9mcmVxICAgICAgICAgICAgICAgICAgID0g
JTMuMmZcbiIsCisJCQlfX2Z1bmNfXywKKwkJCXJlZl9mcmVxX3RvX3BpeF9mcmVxKTsKKworCS8v
IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKwkvLyBTZWN0aW9uIDEuMTUuMi4yOiBQcmVmZXRj
aCwgQWN0aXZlIGFuZCBUVFUKKwkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisJLy8gUHJl
ZmV0Y2ggQ2FsYworCS8vIFNvdXJjZQorLy8gICAgICAgICAgICAgZGNjX2VuICAgICAgICAgICAg
ICA9IHNyYy5kY2M7CisJZHVhbF9wbGFuZSA9IGlzX2R1YWxfcGxhbmUoKGVudW0gc291cmNlX2Zv
cm1hdF9jbGFzcykoc3JjLT5zb3VyY2VfZm9ybWF0KSk7CisJbW9kZV80MjIgPSAwOyAvLyBGSVhN
RQorCWFjY2Vzc19kaXIgPSAoc3JjLT5zb3VyY2Vfc2NhbiA9PSBkbV92ZXJ0KTsgLy8gdnAgYWNj
ZXNzIGRpcmVjdGlvbjogaG9yaXpvbnRhbCBvciB2ZXJ0aWNhbCBhY2Nlc3NlZAorLy8gICAgICBi
eXRlc19wZXJfZWxlbWVudF9sID0gZ2V0X2J5dGVzX3Blcl9lbGVtZW50KHNvdXJjZV9mb3JtYXRf
Y2xhc3Moc3JjLnNvdXJjZV9mb3JtYXQpLCAwKTsKKy8vICAgICAgYnl0ZXNfcGVyX2VsZW1lbnRf
YyA9IGdldF9ieXRlc19wZXJfZWxlbWVudChzb3VyY2VfZm9ybWF0X2NsYXNzKHNyYy5zb3VyY2Vf
Zm9ybWF0KSwgMSk7CisJdnBfaGVpZ2h0X2wgPSBzcmMtPnZpZXdwb3J0X2hlaWdodDsKKwl2cF93
aWR0aF9sID0gc3JjLT52aWV3cG9ydF93aWR0aDsKKwl2cF9oZWlnaHRfYyA9IHNyYy0+dmlld3Bv
cnRfaGVpZ2h0X2M7CisJdnBfd2lkdGhfYyA9IHNyYy0+dmlld3BvcnRfd2lkdGhfYzsKKworCS8v
IFNjYWxpbmcKKwlodGFwc19sID0gdGFwcy0+aHRhcHM7CisJaHRhcHNfYyA9IHRhcHMtPmh0YXBz
X2M7CisJaHJhdGlvX2wgPSBzY2wtPmhzY2xfcmF0aW87CisJaHJhdGlvX2MgPSBzY2wtPmhzY2xf
cmF0aW9fYzsKKwl2cmF0aW9fbCA9IHNjbC0+dnNjbF9yYXRpbzsKKwl2cmF0aW9fYyA9IHNjbC0+
dnNjbF9yYXRpb19jOworCXNjbF9lbmFibGUgPSBzY2wtPnNjbF9lbmFibGU7CisKKwlsaW5lX3Rp
bWVfaW5fdXMgPSAoaHRvdGFsIC8gcGNsa19mcmVxX2luX21oeik7CisvLyAgICAgdmluaXRfbCAg
ICAgICAgID0gc2NsLnZpbml0OworLy8gICAgIHZpbml0X2MgICAgICAgICA9IHNjbC52aW5pdF9j
OworLy8gICAgIHZpbml0X2JvdF9sICAgICA9IHNjbC52aW5pdF9ib3Q7CisvLyAgICAgdmluaXRf
Ym90X2MgICAgID0gc2NsLnZpbml0X2JvdF9jOworCisvLyAgICB1bnNpZ25lZCBpbnQgc3dhdGhf
aGVpZ2h0X2wgICAgICAgICAgICAgICAgID0gcnFfZGxnX3BhcmFtLnJxX2wuc3dhdGhfaGVpZ2h0
OworCXN3YXRoX3dpZHRoX3ViX2wgPSBycV9kbGdfcGFyYW0ucnFfbC5zd2F0aF93aWR0aF91YjsK
Ky8vICAgIHVuc2lnbmVkIGludCBkcHRlX2J5dGVzX3Blcl9yb3dfdWJfbCAgICAgICAgPSBycV9k
bGdfcGFyYW0ucnFfbC5kcHRlX2J5dGVzX3Blcl9yb3dfdWI7CisJZHB0ZV9ncm91cHNfcGVyX3Jv
d191Yl9sID0gcnFfZGxnX3BhcmFtLnJxX2wuZHB0ZV9ncm91cHNfcGVyX3Jvd191YjsKKy8vICAg
IHVuc2lnbmVkIGludCBtZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWJfbCAgPSBycV9kbGdfcGFy
YW0ucnFfbC5tZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWI7CisvLyAgICB1bnNpZ25lZCBpbnQg
bWV0YV9ieXRlc19wZXJfcm93X3ViX2wgICAgICAgID0gcnFfZGxnX3BhcmFtLnJxX2wubWV0YV9i
eXRlc19wZXJfcm93X3ViOworCisvLyAgICB1bnNpZ25lZCBpbnQgc3dhdGhfaGVpZ2h0X2MgICAg
ICAgICAgICAgICAgID0gcnFfZGxnX3BhcmFtLnJxX2Muc3dhdGhfaGVpZ2h0OworCXN3YXRoX3dp
ZHRoX3ViX2MgPSBycV9kbGdfcGFyYW0ucnFfYy5zd2F0aF93aWR0aF91YjsKKwkvLyAgIGRwdGVf
Ynl0ZXNfcGVyX3Jvd191Yl9jICAgICAgICA9IHJxX2RsZ19wYXJhbS5ycV9jLmRwdGVfYnl0ZXNf
cGVyX3Jvd191YjsKKwlkcHRlX2dyb3Vwc19wZXJfcm93X3ViX2MgPSBycV9kbGdfcGFyYW0ucnFf
Yy5kcHRlX2dyb3Vwc19wZXJfcm93X3ViOworCisJbWV0YV9jaHVua3NfcGVyX3Jvd191Yl9sID0g
cnFfZGxnX3BhcmFtLnJxX2wubWV0YV9jaHVua3NfcGVyX3Jvd191YjsKKwltZXRhX2NodW5rc19w
ZXJfcm93X3ViX2MgPSBycV9kbGdfcGFyYW0ucnFfYy5tZXRhX2NodW5rc19wZXJfcm93X3ViOwor
CXZ1cGRhdGVfb2Zmc2V0ID0gZHN0LT52dXBkYXRlX29mZnNldDsKKwl2dXBkYXRlX3dpZHRoID0g
ZHN0LT52dXBkYXRlX3dpZHRoOworCXZyZWFkeV9vZmZzZXQgPSBkc3QtPnZyZWFkeV9vZmZzZXQ7
CisKKwlkcHBjbGtfZGVsYXlfc3VidG90YWwgPSBtb2RlX2xpYi0+aXAuZHBwY2xrX2RlbGF5X3N1
YnRvdGFsOworCWRpc3BjbGtfZGVsYXlfc3VidG90YWwgPSBtb2RlX2xpYi0+aXAuZGlzcGNsa19k
ZWxheV9zdWJ0b3RhbDsKKworCWlmIChzY2xfZW5hYmxlKQorCQlkcHBjbGtfZGVsYXlfc3VidG90
YWwgKz0gbW9kZV9saWItPmlwLmRwcGNsa19kZWxheV9zY2w7CisJZWxzZQorCQlkcHBjbGtfZGVs
YXlfc3VidG90YWwgKz0gbW9kZV9saWItPmlwLmRwcGNsa19kZWxheV9zY2xfbGJfb25seTsKKwor
CWRwcGNsa19kZWxheV9zdWJ0b3RhbCArPSBtb2RlX2xpYi0+aXAuZHBwY2xrX2RlbGF5X2NudmNf
Zm9ybWF0dGVyCisJCQkrIHNyYy0+bnVtX2N1cnNvcnMgKiBtb2RlX2xpYi0+aXAuZHBwY2xrX2Rl
bGF5X2NudmNfY3Vyc29yOworCisJaWYgKGRvdXQtPmRzY19lbmFibGUpIHsKKwkJZG91YmxlIGRz
Y19kZWxheSA9IGdldF9kc2NfZGVsYXkobW9kZV9saWIsIGUyZV9waXBlX3BhcmFtLCBudW1fcGlw
ZXMsIHBpcGVfaWR4KTsKKworCQlkaXNwY2xrX2RlbGF5X3N1YnRvdGFsICs9IGRzY19kZWxheTsK
Kwl9CisKKwlwaXhlbF9yYXRlX2RlbGF5X3N1YnRvdGFsID0gZHBwY2xrX2RlbGF5X3N1YnRvdGFs
ICogcGNsa19mcmVxX2luX21oeiAvIGRwcGNsa19mcmVxX2luX21oegorCQkJKyBkaXNwY2xrX2Rl
bGF5X3N1YnRvdGFsICogcGNsa19mcmVxX2luX21oeiAvIGRpc3BjbGtfZnJlcV9pbl9taHo7CisK
Kwl2c3RhcnR1cF9zdGFydCA9IGRzdC0+dnN0YXJ0dXBfc3RhcnQ7CisJaWYgKGludGVybGFjZWQp
IHsKKwkJaWYgKHZzdGFydHVwX3N0YXJ0IC8gMi4wCisJCQkJLSAoZG91YmxlKSAodnJlYWR5X29m
ZnNldCArIHZ1cGRhdGVfd2lkdGggKyB2dXBkYXRlX29mZnNldCkgLyBodG90YWwKKwkJCQk8PSB2
YmxhbmtfZW5kIC8gMi4wKQorCQkJZGlzcF9kbGdfcmVncy0+dnJlYWR5X2FmdGVyX3Zjb3VudDAg
PSAxOworCQllbHNlCisJCQlkaXNwX2RsZ19yZWdzLT52cmVhZHlfYWZ0ZXJfdmNvdW50MCA9IDA7
CisJfSBlbHNlIHsKKwkJaWYgKHZzdGFydHVwX3N0YXJ0CisJCQkJLSAoZG91YmxlKSAodnJlYWR5
X29mZnNldCArIHZ1cGRhdGVfd2lkdGggKyB2dXBkYXRlX29mZnNldCkgLyBodG90YWwKKwkJCQk8
PSB2YmxhbmtfZW5kKQorCQkJZGlzcF9kbGdfcmVncy0+dnJlYWR5X2FmdGVyX3Zjb3VudDAgPSAx
OworCQllbHNlCisJCQlkaXNwX2RsZ19yZWdzLT52cmVhZHlfYWZ0ZXJfdmNvdW50MCA9IDA7CisJ
fQorCisJLy8gVE9ETzogV2hlcmUgaXMgdGhpcyBjb21pbmcgZnJvbT8KKwlpZiAoaW50ZXJsYWNl
ZCkKKwkJdnN0YXJ0dXBfc3RhcnQgPSB2c3RhcnR1cF9zdGFydCAvIDI7CisKKwkvLyBUT0RPOiBX
aGF0IGlmIHRoaXMgbWluX3ZibGFuayBkb2Vzbid0IG1hdGNoIHRoZSB2YWx1ZSBpbiB0aGUgZG1s
X2NvbmZpZ19zZXR0aW5ncy5jcHA/CisJaWYgKHZzdGFydHVwX3N0YXJ0ID49IG1pbl92Ymxhbmsp
IHsKKwkJZG1sX3ByaW50KCJXQVJOSU5HOiBETUxfRExHOiAlczogdmJsYW5rX3N0YXJ0PSVkIHZi
bGFua19lbmQ9JWRcbiIsCisJCQkJX19mdW5jX18sCisJCQkJdmJsYW5rX3N0YXJ0LAorCQkJCXZi
bGFua19lbmQpOworCQlkbWxfcHJpbnQoIldBUk5JTkc6IERNTF9ETEc6ICVzOiB2c3RhcnR1cF9z
dGFydD0lZCBzaG91bGQgYmUgbGVzcyB0aGFuIG1pbl92Ymxhbms9JWRcbiIsCisJCQkJX19mdW5j
X18sCisJCQkJdnN0YXJ0dXBfc3RhcnQsCisJCQkJbWluX3ZibGFuayk7CisJCW1pbl92Ymxhbmsg
PSB2c3RhcnR1cF9zdGFydCArIDE7CisJCWRtbF9wcmludCgiV0FSTklORzogRE1MX0RMRzogJXM6
IHZzdGFydHVwX3N0YXJ0PSVkIHNob3VsZCBiZSBsZXNzIHRoYW4gbWluX3ZibGFuaz0lZFxuIiwK
KwkJCQlfX2Z1bmNfXywKKwkJCQl2c3RhcnR1cF9zdGFydCwKKwkJCQltaW5fdmJsYW5rKTsKKwl9
CisKKwlkc3RfeF9hZnRlcl9zY2FsZXIgPSBnZXRfZHN0X3hfYWZ0ZXJfc2NhbGVyKG1vZGVfbGli
LCBlMmVfcGlwZV9wYXJhbSwgbnVtX3BpcGVzLCBwaXBlX2lkeCk7CisJZHN0X3lfYWZ0ZXJfc2Nh
bGVyID0gZ2V0X2RzdF95X2FmdGVyX3NjYWxlcihtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51
bV9waXBlcywgcGlwZV9pZHgpOworCisJZG1sX3ByaW50KCJETUxfRExHOiAlczogaHRvdGFsICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAlZFxuIiwgX19mdW5jX18sIGh0b3RhbCk7
CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogcGl4ZWxfcmF0ZV9kZWxheV9zdWJ0b3RhbCAgICAg
ICAgICAgICAgPSAlZFxuIiwKKwkJCV9fZnVuY19fLAorCQkJcGl4ZWxfcmF0ZV9kZWxheV9zdWJ0
b3RhbCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogZHN0X3hfYWZ0ZXJfc2NhbGVyICAgICAg
ICAgICAgICAgICAgICAgPSAlZFxuIiwKKwkJCV9fZnVuY19fLAorCQkJZHN0X3hfYWZ0ZXJfc2Nh
bGVyKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBkc3RfeV9hZnRlcl9zY2FsZXIgICAgICAg
ICAgICAgICAgICAgICA9ICVkXG4iLAorCQkJX19mdW5jX18sCisJCQlkc3RfeV9hZnRlcl9zY2Fs
ZXIpOworCisJLy8gTHdhaXQKKwlsaW5lX3dhaXQgPSBtb2RlX2xpYi0+c29jLnVyZ2VudF9sYXRl
bmN5X3VzOworCWlmIChjc3RhdGVfZW4pCisJCWxpbmVfd2FpdCA9IGRtbF9tYXgobW9kZV9saWIt
PnNvYy5zcl9lbnRlcl9wbHVzX2V4aXRfdGltZV91cywgbGluZV93YWl0KTsKKwlpZiAocHN0YXRl
X2VuKQorCQlsaW5lX3dhaXQgPSBkbWxfbWF4KG1vZGVfbGliLT5zb2MuZHJhbV9jbG9ja19jaGFu
Z2VfbGF0ZW5jeV91cworCQkJCQkJKyBtb2RlX2xpYi0+c29jLnVyZ2VudF9sYXRlbmN5X3VzLAor
CQkJCWxpbmVfd2FpdCk7CisJbGluZV93YWl0ID0gbGluZV93YWl0IC8gbGluZV90aW1lX2luX3Vz
OworCisJZHN0X3lfcHJlZmV0Y2ggPSBnZXRfZHN0X3lfcHJlZmV0Y2gobW9kZV9saWIsIGUyZV9w
aXBlX3BhcmFtLCBudW1fcGlwZXMsIHBpcGVfaWR4KTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVz
OiBkc3RfeV9wcmVmZXRjaCAoYWZ0ZXIgcm5kKSA9ICUzLjJmXG4iLCBfX2Z1bmNfXywgZHN0X3lf
cHJlZmV0Y2gpOworCisJZHN0X3lfcGVyX3ZtX3ZibGFuayA9IGdldF9kc3RfeV9wZXJfdm1fdmJs
YW5rKG1vZGVfbGliLAorCQkJZTJlX3BpcGVfcGFyYW0sCisJCQludW1fcGlwZXMsCisJCQlwaXBl
X2lkeCk7CisJZHN0X3lfcGVyX3Jvd192YmxhbmsgPSBnZXRfZHN0X3lfcGVyX3Jvd192Ymxhbmso
bW9kZV9saWIsCisJCQllMmVfcGlwZV9wYXJhbSwKKwkJCW51bV9waXBlcywKKwkJCXBpcGVfaWR4
KTsKKwlkc3RfeV9wZXJfdm1fZmxpcCA9IGdldF9kc3RfeV9wZXJfdm1fZmxpcChtb2RlX2xpYiwg
ZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcywgcGlwZV9pZHgpOworCWRzdF95X3Blcl9yb3dfZmxp
cCA9IGdldF9kc3RfeV9wZXJfcm93X2ZsaXAobW9kZV9saWIsIGUyZV9waXBlX3BhcmFtLCBudW1f
cGlwZXMsIHBpcGVfaWR4KTsKKworCW1pbl9kc3RfeV9wZXJfdm1fdmJsYW5rID0gOC4wOworCW1p
bl9kc3RfeV9wZXJfcm93X3ZibGFuayA9IDE2LjA7CisKKwkvLyBtYWdpYyEKKwlpZiAoaHRvdGFs
IDw9IDc1KSB7CisJCW1pbl92YmxhbmsgPSAzMDA7CisJCW1pbl9kc3RfeV9wZXJfdm1fdmJsYW5r
ID0gMTAwLjA7CisJCW1pbl9kc3RfeV9wZXJfcm93X3ZibGFuayA9IDEwMC4wOworCX0KKworCWRt
bF9wcmludCgiRE1MX0RMRzogJXM6IGRzdF95X3Blcl92bV92YmxhbmsgICAgPSAlMy4yZlxuIiwg
X19mdW5jX18sIGRzdF95X3Blcl92bV92YmxhbmspOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6
IGRzdF95X3Blcl9yb3dfdmJsYW5rICAgPSAlMy4yZlxuIiwgX19mdW5jX18sIGRzdF95X3Blcl9y
b3dfdmJsYW5rKTsKKworCUFTU0VSVChkc3RfeV9wZXJfdm1fdmJsYW5rIDwgbWluX2RzdF95X3Bl
cl92bV92YmxhbmspOworCUFTU0VSVChkc3RfeV9wZXJfcm93X3ZibGFuayA8IG1pbl9kc3RfeV9w
ZXJfcm93X3ZibGFuayk7CisKKwlBU1NFUlQoZHN0X3lfcHJlZmV0Y2ggPiAoZHN0X3lfcGVyX3Zt
X3ZibGFuayArIGRzdF95X3Blcl9yb3dfdmJsYW5rKSk7CisJbHN3ID0gZHN0X3lfcHJlZmV0Y2gg
LSAoZHN0X3lfcGVyX3ZtX3ZibGFuayArIGRzdF95X3Blcl9yb3dfdmJsYW5rKTsKKworCWRtbF9w
cmludCgiRE1MX0RMRzogJXM6IGxzdyA9ICUzLjJmXG4iLCBfX2Z1bmNfXywgbHN3KTsKKworCXZy
YXRpb19wcmVfbCA9IGdldF92cmF0aW9fcHJlZmV0Y2hfbChtb2RlX2xpYiwgZTJlX3BpcGVfcGFy
YW0sIG51bV9waXBlcywgcGlwZV9pZHgpOworCXZyYXRpb19wcmVfYyA9IGdldF92cmF0aW9fcHJl
ZmV0Y2hfYyhtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcywgcGlwZV9pZHgpOwor
CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogdnJhdGlvX3ByZV9sPSUzLjJmXG4iLCBfX2Z1bmNf
XywgdnJhdGlvX3ByZV9sKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiB2cmF0aW9fcHJlX2M9
JTMuMmZcbiIsIF9fZnVuY19fLCB2cmF0aW9fcHJlX2MpOworCisJLy8gQWN0aXZlCisJcmVxX3Bl
cl9zd2F0aF91Yl9sID0gcnFfZGxnX3BhcmFtLnJxX2wucmVxX3Blcl9zd2F0aF91YjsKKwlyZXFf
cGVyX3N3YXRoX3ViX2MgPSBycV9kbGdfcGFyYW0ucnFfYy5yZXFfcGVyX3N3YXRoX3ViOworCW1l
dGFfcm93X2hlaWdodF9sID0gcnFfZGxnX3BhcmFtLnJxX2wubWV0YV9yb3dfaGVpZ2h0OworCW1l
dGFfcm93X2hlaWdodF9jID0gcnFfZGxnX3BhcmFtLnJxX2MubWV0YV9yb3dfaGVpZ2h0OworCXN3
YXRoX3dpZHRoX3BpeGVsc191Yl9sID0gMDsKKwlzd2F0aF93aWR0aF9waXhlbHNfdWJfYyA9IDA7
CisJc2NhbGVyX3JlY19pbl93aWR0aF9sID0gMDsKKwlzY2FsZXJfcmVjX2luX3dpZHRoX2MgPSAw
OworCWRwdGVfcm93X2hlaWdodF9sID0gcnFfZGxnX3BhcmFtLnJxX2wuZHB0ZV9yb3dfaGVpZ2h0
OworCWRwdGVfcm93X2hlaWdodF9jID0gcnFfZGxnX3BhcmFtLnJxX2MuZHB0ZV9yb3dfaGVpZ2h0
OworCisJaWYgKG1vZGVfNDIyKSB7CisJCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9sID0gc3dhdGhf
d2lkdGhfdWJfbCAqIDI7ICAvLyAqMiBmb3IgMiBwaXhlbCBwZXIgZWxlbWVudAorCQlzd2F0aF93
aWR0aF9waXhlbHNfdWJfYyA9IHN3YXRoX3dpZHRoX3ViX2MgKiAyOworCX0gZWxzZSB7CisJCXN3
YXRoX3dpZHRoX3BpeGVsc191Yl9sID0gc3dhdGhfd2lkdGhfdWJfbCAqIDE7CisJCXN3YXRoX3dp
ZHRoX3BpeGVsc191Yl9jID0gc3dhdGhfd2lkdGhfdWJfYyAqIDE7CisJfQorCisJaHNjYWxlX3Bp
eGVsX3JhdGVfbCA9IDAuOworCWhzY2FsZV9waXhlbF9yYXRlX2MgPSAwLjsKKwltaW5faHJhdGlv
X2ZhY3RfbCA9IDEuMDsKKwltaW5faHJhdGlvX2ZhY3RfYyA9IDEuMDsKKworCWlmIChodGFwc19s
IDw9IDEpCisJCW1pbl9ocmF0aW9fZmFjdF9sID0gMi4wOworCWVsc2UgaWYgKGh0YXBzX2wgPD0g
NikgeworCQlpZiAoKGhyYXRpb19sICogMi4wKSA+IDQuMCkKKwkJCW1pbl9ocmF0aW9fZmFjdF9s
ID0gNC4wOworCQllbHNlCisJCQltaW5faHJhdGlvX2ZhY3RfbCA9IGhyYXRpb19sICogMi4wOwor
CX0gZWxzZSB7CisJCWlmIChocmF0aW9fbCA+IDQuMCkKKwkJCW1pbl9ocmF0aW9fZmFjdF9sID0g
NC4wOworCQllbHNlCisJCQltaW5faHJhdGlvX2ZhY3RfbCA9IGhyYXRpb19sOworCX0KKworCWhz
Y2FsZV9waXhlbF9yYXRlX2wgPSBtaW5faHJhdGlvX2ZhY3RfbCAqIGRwcGNsa19mcmVxX2luX21o
ejsKKworCWlmIChodGFwc19jIDw9IDEpCisJCW1pbl9ocmF0aW9fZmFjdF9jID0gMi4wOworCWVs
c2UgaWYgKGh0YXBzX2MgPD0gNikgeworCQlpZiAoKGhyYXRpb19jICogMi4wKSA+IDQuMCkKKwkJ
CW1pbl9ocmF0aW9fZmFjdF9jID0gNC4wOworCQllbHNlCisJCQltaW5faHJhdGlvX2ZhY3RfYyA9
IGhyYXRpb19jICogMi4wOworCX0gZWxzZSB7CisJCWlmIChocmF0aW9fYyA+IDQuMCkKKwkJCW1p
bl9ocmF0aW9fZmFjdF9jID0gNC4wOworCQllbHNlCisJCQltaW5faHJhdGlvX2ZhY3RfYyA9IGhy
YXRpb19jOworCX0KKworCWhzY2FsZV9waXhlbF9yYXRlX2MgPSBtaW5faHJhdGlvX2ZhY3RfYyAq
IGRwcGNsa19mcmVxX2luX21oejsKKworCXJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfbCA9
IDAuOworCXJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfYyA9IDAuOworCXJlZmN5Y19wZXJf
bGluZV9kZWxpdmVyeV9sID0gMC47CisJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2MgPSAwLjsK
KworCXJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9sID0gMC47CisJcmVmY3ljX3Blcl9yZXFf
ZGVsaXZlcnlfcHJlX2MgPSAwLjsKKwlyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9sID0gMC47CisJ
cmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfYyA9IDAuOworCisJZnVsbF9yZWNvdXRfd2lkdGggPSAw
OworCS8vIEluIE9ETQorCWlmIChzcmMtPmlzX2hzcGxpdCkgeworCQkvLyBUaGlzICJoYWNrIiAg
aXMgb25seSBhbGxvd2VkIChhbmQgdmFsaWQpIGZvciBNUEMgY29tYmluZS4gSW4gT0RNCisJCS8v
IGNvbWJpbmUsIHlvdSBNVVNUIHNwZWNpZnkgdGhlIGZ1bGxfcmVjb3V0X3dpZHRoLi4uYWNjb3Jk
aW5nIHRvIE9zd2luCisJCWlmIChkc3QtPmZ1bGxfcmVjb3V0X3dpZHRoID09IDAgJiYgIWRzdC0+
b2RtX2NvbWJpbmUpIHsKKwkJCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IFdhcm5pbmc6IGZ1bGxf
cmVjb3V0X3dpZHRoIG5vdCBzZXQgaW4gaHNwbGl0IG1vZGVcbiIsCisJCQkJCV9fZnVuY19fKTsK
KwkJCWZ1bGxfcmVjb3V0X3dpZHRoID0gZHN0LT5yZWNvdXRfd2lkdGggKiAyOyAvLyBhc3N1bWUg
aGFsZiBzcGxpdCBmb3IgZGNuMQorCQl9IGVsc2UKKwkJCWZ1bGxfcmVjb3V0X3dpZHRoID0gZHN0
LT5mdWxsX3JlY291dF93aWR0aDsKKwl9IGVsc2UKKwkJZnVsbF9yZWNvdXRfd2lkdGggPSBkc3Qt
PnJlY291dF93aWR0aDsKKworCS8vIEFzIG9mIERDTjIsIG1wY19jb21iaW5lIGFuZCBvZG1fY29t
YmluZSBhcmUgbXV0dWFsbHkgZXhjbHVzaXZlCisJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3By
ZV9sID0gZ2V0X3JlZmN5Y19wZXJfZGVsaXZlcnkobW9kZV9saWIsCisJCQlyZWZjbGtfZnJlcV9p
bl9taHosCisJCQlwY2xrX2ZyZXFfaW5fbWh6LAorCQkJZHN0LT5vZG1fY29tYmluZSwKKwkJCWZ1
bGxfcmVjb3V0X3dpZHRoLAorCQkJZHN0LT5oYWN0aXZlLAorCQkJdnJhdGlvX3ByZV9sLAorCQkJ
aHNjYWxlX3BpeGVsX3JhdGVfbCwKKwkJCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9sLAorCQkJMSk7
IC8vIHBlciBsaW5lCisKKwlyZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfbCA9IGdldF9yZWZjeWNf
cGVyX2RlbGl2ZXJ5KG1vZGVfbGliLAorCQkJcmVmY2xrX2ZyZXFfaW5fbWh6LAorCQkJcGNsa19m
cmVxX2luX21oeiwKKwkJCWRzdC0+b2RtX2NvbWJpbmUsCisJCQlmdWxsX3JlY291dF93aWR0aCwK
KwkJCWRzdC0+aGFjdGl2ZSwKKwkJCXZyYXRpb19sLAorCQkJaHNjYWxlX3BpeGVsX3JhdGVfbCwK
KwkJCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9sLAorCQkJMSk7IC8vIHBlciBsaW5lCisKKwlkbWxf
cHJpbnQoIkRNTF9ETEc6ICVzOiBmdWxsX3JlY291dF93aWR0aCAgICAgICAgICAgICAgPSAlZFxu
IiwKKwkJCV9fZnVuY19fLAorCQkJZnVsbF9yZWNvdXRfd2lkdGgpOworCWRtbF9wcmludCgiRE1M
X0RMRzogJXM6IGhzY2FsZV9waXhlbF9yYXRlX2wgICAgICAgICAgICA9ICUzLjJmXG4iLAorCQkJ
X19mdW5jX18sCisJCQloc2NhbGVfcGl4ZWxfcmF0ZV9sKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6
ICVzOiByZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2wgPSAlMy4yZlxuIiwKKwkJCV9fZnVu
Y19fLAorCQkJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9sKTsKKwlkbWxfcHJpbnQoIkRN
TF9ETEc6ICVzOiByZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfbCAgICAgPSAlMy4yZlxuIiwKKwkJ
CV9fZnVuY19fLAorCQkJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2wpOworCisJaWYgKGR1YWxf
cGxhbmUpIHsKKwkJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9jID0gZ2V0X3JlZmN5Y19w
ZXJfZGVsaXZlcnkobW9kZV9saWIsCisJCQkJcmVmY2xrX2ZyZXFfaW5fbWh6LAorCQkJCXBjbGtf
ZnJlcV9pbl9taHosCisJCQkJZHN0LT5vZG1fY29tYmluZSwKKwkJCQlmdWxsX3JlY291dF93aWR0
aCwKKwkJCQlkc3QtPmhhY3RpdmUsCisJCQkJdnJhdGlvX3ByZV9jLAorCQkJCWhzY2FsZV9waXhl
bF9yYXRlX2MsCisJCQkJc3dhdGhfd2lkdGhfcGl4ZWxzX3ViX2MsCisJCQkJMSk7IC8vIHBlciBs
aW5lCisKKwkJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2MgPSBnZXRfcmVmY3ljX3Blcl9kZWxp
dmVyeShtb2RlX2xpYiwKKwkJCQlyZWZjbGtfZnJlcV9pbl9taHosCisJCQkJcGNsa19mcmVxX2lu
X21oeiwKKwkJCQlkc3QtPm9kbV9jb21iaW5lLAorCQkJCWZ1bGxfcmVjb3V0X3dpZHRoLAorCQkJ
CWRzdC0+aGFjdGl2ZSwKKwkJCQl2cmF0aW9fYywKKwkJCQloc2NhbGVfcGl4ZWxfcmF0ZV9jLAor
CQkJCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9jLAorCQkJCTEpOyAgLy8gcGVyIGxpbmUKKworCQlk
bWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2MgPSAl
My4yZlxuIiwKKwkJCQlfX2Z1bmNfXywKKwkJCQlyZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJl
X2MpOworCQlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlf
YyAgICAgPSAlMy4yZlxuIiwKKwkJCQlfX2Z1bmNfXywKKwkJCQlyZWZjeWNfcGVyX2xpbmVfZGVs
aXZlcnlfYyk7CisJfQorCisJLy8gVFRVIC0gTHVtYSAvIENocm9tYQorCWlmIChhY2Nlc3NfZGly
KSB7ICAvLyB2ZXJ0aWNhbCBhY2Nlc3MKKwkJc2NhbGVyX3JlY19pbl93aWR0aF9sID0gdnBfaGVp
Z2h0X2w7CisJCXNjYWxlcl9yZWNfaW5fd2lkdGhfYyA9IHZwX2hlaWdodF9jOworCX0gZWxzZSB7
CisJCXNjYWxlcl9yZWNfaW5fd2lkdGhfbCA9IHZwX3dpZHRoX2w7CisJCXNjYWxlcl9yZWNfaW5f
d2lkdGhfYyA9IHZwX3dpZHRoX2M7CisJfQorCisJcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJl
X2wgPSBnZXRfcmVmY3ljX3Blcl9kZWxpdmVyeShtb2RlX2xpYiwKKwkJCXJlZmNsa19mcmVxX2lu
X21oeiwKKwkJCXBjbGtfZnJlcV9pbl9taHosCisJCQlkc3QtPm9kbV9jb21iaW5lLAorCQkJZnVs
bF9yZWNvdXRfd2lkdGgsCisJCQlkc3QtPmhhY3RpdmUsCisJCQl2cmF0aW9fcHJlX2wsCisJCQlo
c2NhbGVfcGl4ZWxfcmF0ZV9sLAorCQkJc2NhbGVyX3JlY19pbl93aWR0aF9sLAorCQkJcmVxX3Bl
cl9zd2F0aF91Yl9sKTsgIC8vIHBlciByZXEKKwlyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9sID0g
Z2V0X3JlZmN5Y19wZXJfZGVsaXZlcnkobW9kZV9saWIsCisJCQlyZWZjbGtfZnJlcV9pbl9taHos
CisJCQlwY2xrX2ZyZXFfaW5fbWh6LAorCQkJZHN0LT5vZG1fY29tYmluZSwKKwkJCWZ1bGxfcmVj
b3V0X3dpZHRoLAorCQkJZHN0LT5oYWN0aXZlLAorCQkJdnJhdGlvX2wsCisJCQloc2NhbGVfcGl4
ZWxfcmF0ZV9sLAorCQkJc2NhbGVyX3JlY19pbl93aWR0aF9sLAorCQkJcmVxX3Blcl9zd2F0aF91
Yl9sKTsgIC8vIHBlciByZXEKKworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJlZmN5Y19wZXJf
cmVxX2RlbGl2ZXJ5X3ByZV9sID0gJTMuMmZcbiIsCisJCQlfX2Z1bmNfXywKKwkJCXJlZmN5Y19w
ZXJfcmVxX2RlbGl2ZXJ5X3ByZV9sKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZWZjeWNf
cGVyX3JlcV9kZWxpdmVyeV9sICAgICA9ICUzLjJmXG4iLAorCQkJX19mdW5jX18sCisJCQlyZWZj
eWNfcGVyX3JlcV9kZWxpdmVyeV9sKTsKKworCUFTU0VSVChyZWZjeWNfcGVyX3JlcV9kZWxpdmVy
eV9wcmVfbCA8IGRtbF9wb3coMiwgMTMpKTsKKwlBU1NFUlQocmVmY3ljX3Blcl9yZXFfZGVsaXZl
cnlfbCA8IGRtbF9wb3coMiwgMTMpKTsKKworCWlmIChkdWFsX3BsYW5lKSB7CisJCXJlZmN5Y19w
ZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jID0gZ2V0X3JlZmN5Y19wZXJfZGVsaXZlcnkobW9kZV9saWIs
CisJCQkJcmVmY2xrX2ZyZXFfaW5fbWh6LAorCQkJCXBjbGtfZnJlcV9pbl9taHosCisJCQkJZHN0
LT5vZG1fY29tYmluZSwKKwkJCQlmdWxsX3JlY291dF93aWR0aCwKKwkJCQlkc3QtPmhhY3RpdmUs
CisJCQkJdnJhdGlvX3ByZV9jLAorCQkJCWhzY2FsZV9waXhlbF9yYXRlX2MsCisJCQkJc2NhbGVy
X3JlY19pbl93aWR0aF9jLAorCQkJCXJlcV9wZXJfc3dhdGhfdWJfYyk7ICAvLyBwZXIgcmVxCisJ
CXJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2MgPSBnZXRfcmVmY3ljX3Blcl9kZWxpdmVyeShtb2Rl
X2xpYiwKKwkJCQlyZWZjbGtfZnJlcV9pbl9taHosCisJCQkJcGNsa19mcmVxX2luX21oeiwKKwkJ
CQlkc3QtPm9kbV9jb21iaW5lLAorCQkJCWZ1bGxfcmVjb3V0X3dpZHRoLAorCQkJCWRzdC0+aGFj
dGl2ZSwKKwkJCQl2cmF0aW9fYywKKwkJCQloc2NhbGVfcGl4ZWxfcmF0ZV9jLAorCQkJCXNjYWxl
cl9yZWNfaW5fd2lkdGhfYywKKwkJCQlyZXFfcGVyX3N3YXRoX3ViX2MpOyAgLy8gcGVyIHJlcQor
CisJCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9j
ID0gJTMuMmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlf
cHJlX2MpOworCQlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX3JlcV9kZWxpdmVy
eV9jICAgICA9ICUzLjJmXG4iLAorCQkJCV9fZnVuY19fLAorCQkJCXJlZmN5Y19wZXJfcmVxX2Rl
bGl2ZXJ5X2MpOworCisJCUFTU0VSVChyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfYyA8IGRt
bF9wb3coMiwgMTMpKTsKKwkJQVNTRVJUKHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2MgPCBkbWxf
cG93KDIsIDEzKSk7CisJfQorCisJLy8gWEZDCisJeGZjX3RyYW5zZmVyX2RlbGF5ID0gZ2V0X3hm
Y190cmFuc2Zlcl9kZWxheShtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcywgcGlw
ZV9pZHgpOworCXhmY19wcmVjaGFyZ2VfZGVsYXkgPSBnZXRfeGZjX3ByZWNoYXJnZV9kZWxheSht
b2RlX2xpYiwKKwkJCWUyZV9waXBlX3BhcmFtLAorCQkJbnVtX3BpcGVzLAorCQkJcGlwZV9pZHgp
OworCXhmY19yZW1vdGVfc3VyZmFjZV9mbGlwX2xhdGVuY3kgPSBnZXRfeGZjX3JlbW90ZV9zdXJm
YWNlX2ZsaXBfbGF0ZW5jeShtb2RlX2xpYiwKKwkJCWUyZV9waXBlX3BhcmFtLAorCQkJbnVtX3Bp
cGVzLAorCQkJcGlwZV9pZHgpOworCXhmY19kc3RfeV9kZWx0YV9kcnFfbGltaXQgPSB4ZmNfcmVt
b3RlX3N1cmZhY2VfZmxpcF9sYXRlbmN5OworCXhmY19wcmVmZXRjaF9tYXJnaW4gPSBnZXRfeGZj
X3ByZWZldGNoX21hcmdpbihtb2RlX2xpYiwKKwkJCWUyZV9waXBlX3BhcmFtLAorCQkJbnVtX3Bp
cGVzLAorCQkJcGlwZV9pZHgpOworCisJLy8gVFRVIC0gQ3Vyc29yCisJcmVmY3ljX3Blcl9yZXFf
ZGVsaXZlcnlfcHJlX2N1cjAgPSAwLjA7CisJcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfY3VyMCA9
IDAuMDsKKwlpZiAoc3JjLT5udW1fY3Vyc29ycyA+IDApIHsKKwkJY2FsY3VsYXRlX3R0dV9jdXJz
b3IobW9kZV9saWIsCisJCQkJJnJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIwLAorCQkJ
CSZyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIwLAorCQkJCXJlZmNsa19mcmVxX2luX21oeiwK
KwkJCQlyZWZfZnJlcV90b19waXhfZnJlcSwKKwkJCQloc2NhbGVfcGl4ZWxfcmF0ZV9sLAorCQkJ
CXNjbC0+aHNjbF9yYXRpbywKKwkJCQl2cmF0aW9fcHJlX2wsCisJCQkJdnJhdGlvX2wsCisJCQkJ
c3JjLT5jdXIwX3NyY193aWR0aCwKKwkJCQkoZW51bSBjdXJzb3JfYnBwKShzcmMtPmN1cjBfYnBw
KSk7CisJfQorCisJcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1cjEgPSAwLjA7CisJcmVm
Y3ljX3Blcl9yZXFfZGVsaXZlcnlfY3VyMSA9IDAuMDsKKwlpZiAoc3JjLT5udW1fY3Vyc29ycyA+
IDEpIHsKKwkJY2FsY3VsYXRlX3R0dV9jdXJzb3IobW9kZV9saWIsCisJCQkJJnJlZmN5Y19wZXJf
cmVxX2RlbGl2ZXJ5X3ByZV9jdXIxLAorCQkJCSZyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIx
LAorCQkJCXJlZmNsa19mcmVxX2luX21oeiwKKwkJCQlyZWZfZnJlcV90b19waXhfZnJlcSwKKwkJ
CQloc2NhbGVfcGl4ZWxfcmF0ZV9sLAorCQkJCXNjbC0+aHNjbF9yYXRpbywKKwkJCQl2cmF0aW9f
cHJlX2wsCisJCQkJdnJhdGlvX2wsCisJCQkJc3JjLT5jdXIxX3NyY193aWR0aCwKKwkJCQkoZW51
bSBjdXJzb3JfYnBwKShzcmMtPmN1cjFfYnBwKSk7CisJfQorCisJLy8gVFRVIC0gTWlzYworCS8v
IGFsbCBoYXJkLWNvZGVkCisKKwkvLyBBc3NpZ25tZW50IHRvIHJlZ2lzdGVyIHN0cnVjdHVyZXMK
KwlkaXNwX2RsZ19yZWdzLT5kc3RfeV9hZnRlcl9zY2FsZXIgPSBkc3RfeV9hZnRlcl9zY2FsZXI7
IC8vIGluIHRlcm1zIG9mIGxpbmUKKwlkaXNwX2RsZ19yZWdzLT5yZWZjeWNfeF9hZnRlcl9zY2Fs
ZXIgPSBkc3RfeF9hZnRlcl9zY2FsZXIgKiByZWZfZnJlcV90b19waXhfZnJlcTsgLy8gaW4gdGVy
bXMgb2YgcmVmY2xrCisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPnJlZmN5Y194X2FmdGVyX3NjYWxl
ciA8ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwgMTMpKTsKKwlkaXNwX2RsZ19yZWdzLT5kc3Rf
eV9wcmVmZXRjaCA9ICh1bnNpZ25lZCBpbnQpIChkc3RfeV9wcmVmZXRjaCAqIGRtbF9wb3coMiwg
MikpOworCWRpc3BfZGxnX3JlZ3MtPmRzdF95X3Blcl92bV92YmxhbmsgPSAodW5zaWduZWQgaW50
KSAoZHN0X3lfcGVyX3ZtX3ZibGFuayAqIGRtbF9wb3coMiwgMikpOworCWRpc3BfZGxnX3JlZ3Mt
PmRzdF95X3Blcl9yb3dfdmJsYW5rID0gKHVuc2lnbmVkIGludCkgKGRzdF95X3Blcl9yb3dfdmJs
YW5rICogZG1sX3BvdygyLCAyKSk7CisJZGlzcF9kbGdfcmVncy0+ZHN0X3lfcGVyX3ZtX2ZsaXAg
PSAodW5zaWduZWQgaW50KSAoZHN0X3lfcGVyX3ZtX2ZsaXAgKiBkbWxfcG93KDIsIDIpKTsKKwlk
aXNwX2RsZ19yZWdzLT5kc3RfeV9wZXJfcm93X2ZsaXAgPSAodW5zaWduZWQgaW50KSAoZHN0X3lf
cGVyX3Jvd19mbGlwICogZG1sX3BvdygyLCAyKSk7CisKKwlkaXNwX2RsZ19yZWdzLT52cmF0aW9f
cHJlZmV0Y2ggPSAodW5zaWduZWQgaW50KSAodnJhdGlvX3ByZV9sICogZG1sX3BvdygyLCAxOSkp
OworCWRpc3BfZGxnX3JlZ3MtPnZyYXRpb19wcmVmZXRjaF9jID0gKHVuc2lnbmVkIGludCkgKHZy
YXRpb19wcmVfYyAqIGRtbF9wb3coMiwgMTkpKTsKKworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19w
ZXJfcHRlX2dyb3VwX3ZibGFua19sID0KKwkJCSh1bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJfcm93
X3ZibGFuayAqIChkb3VibGUpIGh0b3RhbAorCQkJCQkqIHJlZl9mcmVxX3RvX3BpeF9mcmVxIC8g
KGRvdWJsZSkgZHB0ZV9ncm91cHNfcGVyX3Jvd191Yl9sKTsKKwlBU1NFUlQoZGlzcF9kbGdfcmVn
cy0+cmVmY3ljX3Blcl9wdGVfZ3JvdXBfdmJsYW5rX2wgPCAodW5zaWduZWQgaW50KSBkbWxfcG93
KDIsIDEzKSk7CisKKwlpZiAoZHVhbF9wbGFuZSkgeworCQlkaXNwX2RsZ19yZWdzLT5yZWZjeWNf
cGVyX3B0ZV9ncm91cF92YmxhbmtfYyA9ICh1bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJfcm93X3Zi
bGFuaworCQkJCSogKGRvdWJsZSkgaHRvdGFsICogcmVmX2ZyZXFfdG9fcGl4X2ZyZXEKKwkJCQkv
IChkb3VibGUpIGRwdGVfZ3JvdXBzX3Blcl9yb3dfdWJfYyk7CisJCUFTU0VSVChkaXNwX2RsZ19y
ZWdzLT5yZWZjeWNfcGVyX3B0ZV9ncm91cF92YmxhbmtfYworCQkJCQkJPCAodW5zaWduZWQgaW50
KSBkbWxfcG93KDIsIDEzKSk7CisJfQorCisJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRh
X2NodW5rX3ZibGFua19sID0KKwkJCSh1bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJfcm93X3ZibGFu
ayAqIChkb3VibGUpIGh0b3RhbAorCQkJCQkqIHJlZl9mcmVxX3RvX3BpeF9mcmVxIC8gKGRvdWJs
ZSkgbWV0YV9jaHVua3NfcGVyX3Jvd191Yl9sKTsKKwlBU1NFUlQoZGlzcF9kbGdfcmVncy0+cmVm
Y3ljX3Blcl9tZXRhX2NodW5rX3ZibGFua19sIDwgKHVuc2lnbmVkIGludCkgZG1sX3BvdygyLCAx
MykpOworCisJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX3ZibGFua19jID0K
KwkJCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfbWV0YV9jaHVua192YmxhbmtfbDsgLy8gZGNj
IGZvciA0OjI6MCBpcyBub3Qgc3VwcG9ydGVkIGluIGRjbjEuMC4gIGFzc2lnbmVkIHRvIGJlIHRo
ZSBzYW1lIGFzIF9sIGZvciBub3cKKworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dy
b3VwX2ZsaXBfbCA9ICh1bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJfcm93X2ZsaXAgKiBodG90YWwK
KwkJCSogcmVmX2ZyZXFfdG9fcGl4X2ZyZXEpIC8gZHB0ZV9ncm91cHNfcGVyX3Jvd191Yl9sOwor
CWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfbWV0YV9jaHVua19mbGlwX2wgPSAodW5zaWduZWQg
aW50KSAoZHN0X3lfcGVyX3Jvd19mbGlwICogaHRvdGFsCisJCQkqIHJlZl9mcmVxX3RvX3BpeF9m
cmVxKSAvIG1ldGFfY2h1bmtzX3Blcl9yb3dfdWJfbDsKKworCWlmIChkdWFsX3BsYW5lKSB7CisJ
CWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dyb3VwX2ZsaXBfYyA9ICh1bnNpZ25lZCBp
bnQpIChkc3RfeV9wZXJfcm93X2ZsaXAKKwkJCQkqIGh0b3RhbCAqIHJlZl9mcmVxX3RvX3BpeF9m
cmVxKSAvIGRwdGVfZ3JvdXBzX3Blcl9yb3dfdWJfYzsKKwkJZGlzcF9kbGdfcmVncy0+cmVmY3lj
X3Blcl9tZXRhX2NodW5rX2ZsaXBfYyA9ICh1bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJfcm93X2Zs
aXAKKwkJCQkqIGh0b3RhbCAqIHJlZl9mcmVxX3RvX3BpeF9mcmVxKSAvIG1ldGFfY2h1bmtzX3Bl
cl9yb3dfdWJfYzsKKwl9CisKKwlkaXNwX2RsZ19yZWdzLT5kc3RfeV9wZXJfcHRlX3Jvd19ub21f
bCA9ICh1bnNpZ25lZCBpbnQpICgoZG91YmxlKSBkcHRlX3Jvd19oZWlnaHRfbAorCQkJLyAoZG91
YmxlKSB2cmF0aW9fbCAqIGRtbF9wb3coMiwgMikpOworCUFTU0VSVChkaXNwX2RsZ19yZWdzLT5k
c3RfeV9wZXJfcHRlX3Jvd19ub21fbCA8ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwgMTcpKTsK
KworCWlmIChkdWFsX3BsYW5lKSB7CisJCWRpc3BfZGxnX3JlZ3MtPmRzdF95X3Blcl9wdGVfcm93
X25vbV9jID0gKHVuc2lnbmVkIGludCkgKChkb3VibGUpIGRwdGVfcm93X2hlaWdodF9jCisJCQkJ
LyAoZG91YmxlKSB2cmF0aW9fYyAqIGRtbF9wb3coMiwgMikpOworCQlpZiAoZGlzcF9kbGdfcmVn
cy0+ZHN0X3lfcGVyX3B0ZV9yb3dfbm9tX2MgPj0gKHVuc2lnbmVkIGludCkgZG1sX3BvdygyLCAx
NykpIHsKKwkJCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IFdhcm5pbmcgZHN0X3lfcGVyX3B0ZV9y
b3dfbm9tX2MgJXUgbGFyZ2VyIHRoYW4gc3VwcG9ydGVkIGJ5IHJlZ2lzdGVyIGZvcm1hdCBVMTUu
MiAldVxuIiwKKwkJCQkJX19mdW5jX18sCisJCQkJCWRpc3BfZGxnX3JlZ3MtPmRzdF95X3Blcl9w
dGVfcm93X25vbV9jLAorCQkJCQkodW5zaWduZWQgaW50KSBkbWxfcG93KDIsIDE3KSAtIDEpOwor
CQl9CisJfQorCisJZGlzcF9kbGdfcmVncy0+ZHN0X3lfcGVyX21ldGFfcm93X25vbV9sID0gKHVu
c2lnbmVkIGludCkgKChkb3VibGUpIG1ldGFfcm93X2hlaWdodF9sCisJCQkvIChkb3VibGUpIHZy
YXRpb19sICogZG1sX3BvdygyLCAyKSk7CisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPmRzdF95X3Bl
cl9tZXRhX3Jvd19ub21fbCA8ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwgMTcpKTsKKworCWRp
c3BfZGxnX3JlZ3MtPmRzdF95X3Blcl9tZXRhX3Jvd19ub21fYyA9IGRpc3BfZGxnX3JlZ3MtPmRz
dF95X3Blcl9tZXRhX3Jvd19ub21fbDsgLy8gVE9ETzogZGNjIGZvciA0OjI6MCBpcyBub3Qgc3Vw
cG9ydGVkIGluIGRjbjEuMC4gIGFzc2lnbmVkIHRvIGJlIHRoZSBzYW1lIGFzIF9sIGZvciBub3cK
KworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dyb3VwX25vbV9sID0gKHVuc2lnbmVk
IGludCkgKChkb3VibGUpIGRwdGVfcm93X2hlaWdodF9sCisJCQkvIChkb3VibGUpIHZyYXRpb19s
ICogKGRvdWJsZSkgaHRvdGFsICogcmVmX2ZyZXFfdG9fcGl4X2ZyZXEKKwkJCS8gKGRvdWJsZSkg
ZHB0ZV9ncm91cHNfcGVyX3Jvd191Yl9sKTsKKwlpZiAoZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Bl
cl9wdGVfZ3JvdXBfbm9tX2wgPj0gKHVuc2lnbmVkIGludCkgZG1sX3BvdygyLCAyMykpCisJCWRp
c3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dyb3VwX25vbV9sID0gZG1sX3BvdygyLCAyMykg
LSAxOworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfbWV0YV9jaHVua19ub21fbCA9ICh1bnNp
Z25lZCBpbnQpICgoZG91YmxlKSBtZXRhX3Jvd19oZWlnaHRfbAorCQkJLyAoZG91YmxlKSB2cmF0
aW9fbCAqIChkb3VibGUpIGh0b3RhbCAqIHJlZl9mcmVxX3RvX3BpeF9mcmVxCisJCQkvIChkb3Vi
bGUpIG1ldGFfY2h1bmtzX3Blcl9yb3dfdWJfbCk7CisJaWYgKGRpc3BfZGxnX3JlZ3MtPnJlZmN5
Y19wZXJfbWV0YV9jaHVua19ub21fbCA+PSAodW5zaWduZWQgaW50KSBkbWxfcG93KDIsIDIzKSkK
KwkJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX25vbV9sID0gZG1sX3Bvdygy
LCAyMykgLSAxOworCisJaWYgKGR1YWxfcGxhbmUpIHsKKwkJZGlzcF9kbGdfcmVncy0+cmVmY3lj
X3Blcl9wdGVfZ3JvdXBfbm9tX2MgPQorCQkJCSh1bnNpZ25lZCBpbnQpICgoZG91YmxlKSBkcHRl
X3Jvd19oZWlnaHRfYyAvIChkb3VibGUpIHZyYXRpb19jCisJCQkJCQkqIChkb3VibGUpIGh0b3Rh
bCAqIHJlZl9mcmVxX3RvX3BpeF9mcmVxCisJCQkJCQkvIChkb3VibGUpIGRwdGVfZ3JvdXBzX3Bl
cl9yb3dfdWJfYyk7CisJCWlmIChkaXNwX2RsZ19yZWdzLT5yZWZjeWNfcGVyX3B0ZV9ncm91cF9u
b21fYyA+PSAodW5zaWduZWQgaW50KSBkbWxfcG93KDIsIDIzKSkKKwkJCWRpc3BfZGxnX3JlZ3Mt
PnJlZmN5Y19wZXJfcHRlX2dyb3VwX25vbV9jID0gZG1sX3BvdygyLCAyMykgLSAxOworCisJCS8v
IFRPRE86IElzIHRoaXMgdGhlIHJpZ2h0IGNhbGN1bGF0aW9uPyBEb2VzIGh0b3RhbCBuZWVkIHRv
IGJlIGhhbHZlZD8KKwkJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX25vbV9j
ID0KKwkJCQkodW5zaWduZWQgaW50KSAoKGRvdWJsZSkgbWV0YV9yb3dfaGVpZ2h0X2MgLyAoZG91
YmxlKSB2cmF0aW9fYworCQkJCQkJKiAoZG91YmxlKSBodG90YWwgKiByZWZfZnJlcV90b19waXhf
ZnJlcQorCQkJCQkJLyAoZG91YmxlKSBtZXRhX2NodW5rc19wZXJfcm93X3ViX2MpOworCQlpZiAo
ZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX25vbV9jID49ICh1bnNpZ25lZCBp
bnQpIGRtbF9wb3coMiwgMjMpKQorCQkJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2No
dW5rX25vbV9jID0gZG1sX3BvdygyLCAyMykgLSAxOworCX0KKworCWRpc3BfZGxnX3JlZ3MtPnJl
ZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfbCA9ICh1bnNpZ25lZCBpbnQpIGRtbF9mbG9vcihy
ZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2wsCisJCQkxKTsKKwlkaXNwX2RsZ19yZWdzLT5y
ZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfbCA9ICh1bnNpZ25lZCBpbnQpIGRtbF9mbG9vcihyZWZj
eWNfcGVyX2xpbmVfZGVsaXZlcnlfbCwKKwkJCTEpOworCUFTU0VSVChkaXNwX2RsZ19yZWdzLT5y
ZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2wgPCAodW5zaWduZWQgaW50KSBkbWxfcG93KDIs
IDEzKSk7CisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9s
IDwgKHVuc2lnbmVkIGludCkgZG1sX3BvdygyLCAxMykpOworCisJZGlzcF9kbGdfcmVncy0+cmVm
Y3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9jID0gKHVuc2lnbmVkIGludCkgZG1sX2Zsb29yKHJl
ZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfYywKKwkJCTEpOworCWRpc3BfZGxnX3JlZ3MtPnJl
ZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9jID0gKHVuc2lnbmVkIGludCkgZG1sX2Zsb29yKHJlZmN5
Y19wZXJfbGluZV9kZWxpdmVyeV9jLAorCQkJMSk7CisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPnJl
ZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfYyA8ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwg
MTMpKTsKKwlBU1NFUlQoZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2Mg
PCAodW5zaWduZWQgaW50KSBkbWxfcG93KDIsIDEzKSk7CisKKwlkaXNwX2RsZ19yZWdzLT5jaHVu
a19oZGxfYWRqdXN0X2N1cjAgPSAzOworCWRpc3BfZGxnX3JlZ3MtPmRzdF95X29mZnNldF9jdXIw
ID0gMDsKKwlkaXNwX2RsZ19yZWdzLT5jaHVua19oZGxfYWRqdXN0X2N1cjEgPSAzOworCWRpc3Bf
ZGxnX3JlZ3MtPmRzdF95X29mZnNldF9jdXIxID0gMDsKKworCWRpc3BfZGxnX3JlZ3MtPnhmY19y
ZWdfdHJhbnNmZXJfZGVsYXkgPSB4ZmNfdHJhbnNmZXJfZGVsYXk7CisJZGlzcF9kbGdfcmVncy0+
eGZjX3JlZ19wcmVjaGFyZ2VfZGVsYXkgPSB4ZmNfcHJlY2hhcmdlX2RlbGF5OworCWRpc3BfZGxn
X3JlZ3MtPnhmY19yZWdfcmVtb3RlX3N1cmZhY2VfZmxpcF9sYXRlbmN5ID0geGZjX3JlbW90ZV9z
dXJmYWNlX2ZsaXBfbGF0ZW5jeTsKKwlkaXNwX2RsZ19yZWdzLT54ZmNfcmVnX3ByZWZldGNoX21h
cmdpbiA9IGRtbF9jZWlsKHhmY19wcmVmZXRjaF9tYXJnaW4gKiByZWZjbGtfZnJlcV9pbl9taHos
CisJCQkxKTsKKworCS8vIHNsYXZlIGhhcyB0byBoYXZlIHRoaXMgdmFsdWUgYWxzbyBzZXQgdG8g
b2ZmCisJaWYgKHNyYy0+eGZjX2VuYWJsZSAmJiAhc3JjLT54ZmNfc2xhdmUpCisJCWRpc3BfZGxn
X3JlZ3MtPmRzdF95X2RlbHRhX2RycV9saW1pdCA9IGRtbF9jZWlsKHhmY19kc3RfeV9kZWx0YV9k
cnFfbGltaXQsIDEpOworCWVsc2UKKwkJZGlzcF9kbGdfcmVncy0+ZHN0X3lfZGVsdGFfZHJxX2xp
bWl0ID0gMHg3ZmZmOyAvLyBvZmYKKworCWRpc3BfdHR1X3JlZ3MtPnJlZmN5Y19wZXJfcmVxX2Rl
bGl2ZXJ5X3ByZV9sID0gKHVuc2lnbmVkIGludCkgKHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3By
ZV9sCisJCQkqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9yZWdzLT5yZWZjeWNfcGVyX3Jl
cV9kZWxpdmVyeV9sID0gKHVuc2lnbmVkIGludCkgKHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2wK
KwkJCSogZG1sX3BvdygyLCAxMCkpOworCWRpc3BfdHR1X3JlZ3MtPnJlZmN5Y19wZXJfcmVxX2Rl
bGl2ZXJ5X3ByZV9jID0gKHVuc2lnbmVkIGludCkgKHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3By
ZV9jCisJCQkqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9yZWdzLT5yZWZjeWNfcGVyX3Jl
cV9kZWxpdmVyeV9jID0gKHVuc2lnbmVkIGludCkgKHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2MK
KwkJCSogZG1sX3BvdygyLCAxMCkpOworCWRpc3BfdHR1X3JlZ3MtPnJlZmN5Y19wZXJfcmVxX2Rl
bGl2ZXJ5X3ByZV9jdXIwID0KKwkJCSh1bnNpZ25lZCBpbnQpIChyZWZjeWNfcGVyX3JlcV9kZWxp
dmVyeV9wcmVfY3VyMCAqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9yZWdzLT5yZWZjeWNf
cGVyX3JlcV9kZWxpdmVyeV9jdXIwID0gKHVuc2lnbmVkIGludCkgKHJlZmN5Y19wZXJfcmVxX2Rl
bGl2ZXJ5X2N1cjAKKwkJCSogZG1sX3BvdygyLCAxMCkpOworCWRpc3BfdHR1X3JlZ3MtPnJlZmN5
Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIxID0KKwkJCSh1bnNpZ25lZCBpbnQpIChyZWZjeWNf
cGVyX3JlcV9kZWxpdmVyeV9wcmVfY3VyMSAqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9y
ZWdzLT5yZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIxID0gKHVuc2lnbmVkIGludCkgKHJlZmN5
Y19wZXJfcmVxX2RlbGl2ZXJ5X2N1cjEKKwkJCSogZG1sX3BvdygyLCAxMCkpOworCWRpc3BfdHR1
X3JlZ3MtPnFvc19sZXZlbF9sb3dfd20gPSAwOworCUFTU0VSVChkaXNwX3R0dV9yZWdzLT5xb3Nf
bGV2ZWxfbG93X3dtIDwgZG1sX3BvdygyLCAxNCkpOworCWRpc3BfdHR1X3JlZ3MtPnFvc19sZXZl
bF9oaWdoX3dtID0gKHVuc2lnbmVkIGludCkgKDQuMCAqIChkb3VibGUpIGh0b3RhbAorCQkJKiBy
ZWZfZnJlcV90b19waXhfZnJlcSk7CisJLypBU1NFUlQoZGlzcF90dHVfcmVncy0+cW9zX2xldmVs
X2hpZ2hfd20gPCBkbWxfcG93KDIsIDE0KSk7Ki8KKworCWRpc3BfdHR1X3JlZ3MtPnFvc19sZXZl
bF9mbGlwID0gMTQ7CisJZGlzcF90dHVfcmVncy0+cW9zX2xldmVsX2ZpeGVkX2wgPSA4OworCWRp
c3BfdHR1X3JlZ3MtPnFvc19sZXZlbF9maXhlZF9jID0gODsKKwlkaXNwX3R0dV9yZWdzLT5xb3Nf
bGV2ZWxfZml4ZWRfY3VyMCA9IDg7CisJZGlzcF90dHVfcmVncy0+cW9zX3JhbXBfZGlzYWJsZV9s
ID0gMDsKKwlkaXNwX3R0dV9yZWdzLT5xb3NfcmFtcF9kaXNhYmxlX2MgPSAwOworCWRpc3BfdHR1
X3JlZ3MtPnFvc19yYW1wX2Rpc2FibGVfY3VyMCA9IDA7CisKKwlkaXNwX3R0dV9yZWdzLT5taW5f
dHR1X3ZibGFuayA9IG1pbl90dHVfdmJsYW5rICogcmVmY2xrX2ZyZXFfaW5fbWh6OworCUFTU0VS
VChkaXNwX3R0dV9yZWdzLT5taW5fdHR1X3ZibGFuayA8IGRtbF9wb3coMiwgMjQpKTsKKworCXBy
aW50X190dHVfcmVnc19zdChtb2RlX2xpYiwgKmRpc3BfdHR1X3JlZ3MpOworCXByaW50X19kbGdf
cmVnc19zdChtb2RlX2xpYiwgKmRpc3BfZGxnX3JlZ3MpOworfQorCit2b2lkIGRtbDIwX3JxX2Rs
Z19nZXRfZGxnX3JlZyhzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRpc3Bs
YXlfZGxnX3JlZ3Nfc3QgKmRsZ19yZWdzLAorCQlkaXNwbGF5X3R0dV9yZWdzX3N0ICp0dHVfcmVn
cywKKwkJZGlzcGxheV9lMmVfcGlwZV9wYXJhbXNfc3QgKmUyZV9waXBlX3BhcmFtLAorCQljb25z
dCB1bnNpZ25lZCBpbnQgbnVtX3BpcGVzLAorCQljb25zdCB1bnNpZ25lZCBpbnQgcGlwZV9pZHgs
CisJCWNvbnN0IGJvb2wgY3N0YXRlX2VuLAorCQljb25zdCBib29sIHBzdGF0ZV9lbikKK3sKKwlk
aXNwbGF5X3JxX3BhcmFtc19zdCBycV9wYXJhbSA9IHswfTsKKwlkaXNwbGF5X2RsZ19zeXNfcGFy
YW1zX3N0IGRsZ19zeXNfcGFyYW0gPSB7MH07CisKKwkvLyBHZXQgd2F0ZXJtYXJrIGFuZCBUZXgu
CisJZGxnX3N5c19wYXJhbS50X3VyZ193bV91cyA9IGdldF93bV91cmdlbnQobW9kZV9saWIsIGUy
ZV9waXBlX3BhcmFtLCBudW1fcGlwZXMpOworCWRsZ19zeXNfcGFyYW0uZGVlcHNsZWVwX2RjZmNs
a19taHogPSBnZXRfY2xrX2RjZl9kZWVwc2xlZXAobW9kZV9saWIsCisJCQllMmVfcGlwZV9wYXJh
bSwKKwkJCW51bV9waXBlcyk7CisJZGxnX3N5c19wYXJhbS50X2V4dHJhX3VzID0gZ2V0X3VyZ2Vu
dF9leHRyYV9sYXRlbmN5KG1vZGVfbGliLCBlMmVfcGlwZV9wYXJhbSwgbnVtX3BpcGVzKTsKKwlk
bGdfc3lzX3BhcmFtLm1lbV90cmlwX3VzID0gZ2V0X3dtX21lbW9yeV90cmlwKG1vZGVfbGliLCBl
MmVfcGlwZV9wYXJhbSwgbnVtX3BpcGVzKTsKKwlkbGdfc3lzX3BhcmFtLnRfbWNsa193bV91cyA9
IGdldF93bV9kcmFtX2Nsb2NrX2NoYW5nZShtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9w
aXBlcyk7CisJZGxnX3N5c19wYXJhbS50X3NyX3dtX3VzID0gZ2V0X3dtX3N0dXR0ZXJfZW50ZXJf
ZXhpdChtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcyk7CisJZGxnX3N5c19wYXJh
bS50b3RhbF9mbGlwX2J3ID0gZ2V0X3RvdGFsX2ltbWVkaWF0ZV9mbGlwX2J3KG1vZGVfbGliLAor
CQkJZTJlX3BpcGVfcGFyYW0sCisJCQludW1fcGlwZXMpOworCWRsZ19zeXNfcGFyYW0udG90YWxf
ZmxpcF9ieXRlcyA9IGdldF90b3RhbF9pbW1lZGlhdGVfZmxpcF9ieXRlcyhtb2RlX2xpYiwKKwkJ
CWUyZV9waXBlX3BhcmFtLAorCQkJbnVtX3BpcGVzKTsKKwlkbGdfc3lzX3BhcmFtLnRfc3J4X2Rl
bGF5X3VzID0gbW9kZV9saWItPmlwLmRjZmNsa19jc3RhdGVfbGF0ZW5jeQorCQkJLyBkbGdfc3lz
X3BhcmFtLmRlZXBzbGVlcF9kY2ZjbGtfbWh6OyAvLyBUT0RPOiBEZXByZWNhdGVkCisKKwlwcmlu
dF9fZGxnX3N5c19wYXJhbXNfc3QobW9kZV9saWIsIGRsZ19zeXNfcGFyYW0pOworCisJLy8gc3lz
dGVtIHBhcmFtZXRlciBjYWxjdWxhdGlvbiBkb25lCisKKwlkbWxfcHJpbnQoIkRNTF9ETEc6IENh
bGN1bGF0aW9uIGZvciBwaXBlWyVkXSBzdGFydFxuXG4iLCBwaXBlX2lkeCk7CisJZG1sMjBfcnFf
ZGxnX2dldF9ycV9wYXJhbXMobW9kZV9saWIsICZycV9wYXJhbSwgZTJlX3BpcGVfcGFyYW1bcGlw
ZV9pZHhdLnBpcGUuc3JjKTsKKwlkbWwyMF9ycV9kbGdfZ2V0X2RsZ19wYXJhbXMobW9kZV9saWIs
CisJCQllMmVfcGlwZV9wYXJhbSwKKwkJCW51bV9waXBlcywKKwkJCXBpcGVfaWR4LAorCQkJZGxn
X3JlZ3MsCisJCQl0dHVfcmVncywKKwkJCXJxX3BhcmFtLmRsZywKKwkJCWRsZ19zeXNfcGFyYW0s
CisJCQljc3RhdGVfZW4sCisJCQlwc3RhdGVfZW4pOworCWRtbF9wcmludCgiRE1MX0RMRzogQ2Fs
Y3VsYXRpb24gZm9yIHBpcGVbJWRdIGVuZFxuIiwgcGlwZV9pZHgpOworfQorCitzdGF0aWMgdm9p
ZCBjYWxjdWxhdGVfdHR1X2N1cnNvcihzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIs
CisJCWRvdWJsZSAqcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1ciwKKwkJZG91YmxlICpy
ZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIsCisJCWRvdWJsZSByZWZjbGtfZnJlcV9pbl9taHos
CisJCWRvdWJsZSByZWZfZnJlcV90b19waXhfZnJlcSwKKwkJZG91YmxlIGhzY2FsZV9waXhlbF9y
YXRlX2wsCisJCWRvdWJsZSBoc2NsX3JhdGlvLAorCQlkb3VibGUgdnJhdGlvX3ByZV9sLAorCQlk
b3VibGUgdnJhdGlvX2wsCisJCXVuc2lnbmVkIGludCBjdXJfd2lkdGgsCisJCWVudW0gY3Vyc29y
X2JwcCBjdXJfYnBwKQoreworCXVuc2lnbmVkIGludCBjdXJfc3JjX3dpZHRoID0gY3VyX3dpZHRo
OworCXVuc2lnbmVkIGludCBjdXJfcmVxX3NpemUgPSAwOworCXVuc2lnbmVkIGludCBjdXJfcmVx
X3dpZHRoID0gMDsKKwlkb3VibGUgY3VyX3dpZHRoX3ViID0gMC4wOworCWRvdWJsZSBjdXJfcmVx
X3Blcl93aWR0aCA9IDAuMDsKKwlkb3VibGUgaGFjdGl2ZV9jdXIgPSAwLjA7CisKKwlBU1NFUlQo
Y3VyX3NyY193aWR0aCA8PSAyNTYpOworCisJKnJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9j
dXIgPSAwLjA7CisJKnJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2N1ciA9IDAuMDsKKwlpZiAoY3Vy
X3NyY193aWR0aCA+IDApIHsKKwkJdW5zaWduZWQgaW50IGN1cl9iaXRfcGVyX3BpeGVsID0gMDsK
KworCQlpZiAoY3VyX2JwcCA9PSBkbV9jdXJfMmJpdCkgeworCQkJY3VyX3JlcV9zaXplID0gNjQ7
IC8vIGJ5dGUKKwkJCWN1cl9iaXRfcGVyX3BpeGVsID0gMjsKKwkJfSBlbHNlIHsgLy8gMzJiaXQK
KwkJCWN1cl9iaXRfcGVyX3BpeGVsID0gMzI7CisJCQlpZiAoY3VyX3NyY193aWR0aCA+PSAxICYm
IGN1cl9zcmNfd2lkdGggPD0gMTYpCisJCQkJY3VyX3JlcV9zaXplID0gNjQ7CisJCQllbHNlIGlm
IChjdXJfc3JjX3dpZHRoID49IDE3ICYmIGN1cl9zcmNfd2lkdGggPD0gMzEpCisJCQkJY3VyX3Jl
cV9zaXplID0gMTI4OworCQkJZWxzZQorCQkJCWN1cl9yZXFfc2l6ZSA9IDI1NjsKKwkJfQorCisJ
CWN1cl9yZXFfd2lkdGggPSAoZG91YmxlKSBjdXJfcmVxX3NpemUgLyAoKGRvdWJsZSkgY3VyX2Jp
dF9wZXJfcGl4ZWwgLyA4LjApOworCQljdXJfd2lkdGhfdWIgPSBkbWxfY2VpbCgoZG91YmxlKSBj
dXJfc3JjX3dpZHRoIC8gKGRvdWJsZSkgY3VyX3JlcV93aWR0aCwgMSkKKwkJCQkqIChkb3VibGUp
IGN1cl9yZXFfd2lkdGg7CisJCWN1cl9yZXFfcGVyX3dpZHRoID0gY3VyX3dpZHRoX3ViIC8gKGRv
dWJsZSkgY3VyX3JlcV93aWR0aDsKKwkJaGFjdGl2ZV9jdXIgPSAoZG91YmxlKSBjdXJfc3JjX3dp
ZHRoIC8gaHNjbF9yYXRpbzsgLy8gRklYTUU6IG9zd2luIHRvIHRoaW5rIGFib3V0IHdoYXQgdG8g
ZG8gZm9yIGN1cnNvcgorCisJCWlmICh2cmF0aW9fcHJlX2wgPD0gMS4wKSB7CisJCQkqcmVmY3lj
X3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1ciA9IGhhY3RpdmVfY3VyICogcmVmX2ZyZXFfdG9fcGl4
X2ZyZXEKKwkJCQkJLyAoZG91YmxlKSBjdXJfcmVxX3Blcl93aWR0aDsKKwkJfSBlbHNlIHsKKwkJ
CSpyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfY3VyID0gKGRvdWJsZSkgcmVmY2xrX2ZyZXFf
aW5fbWh6CisJCQkJCSogKGRvdWJsZSkgY3VyX3NyY193aWR0aCAvIGhzY2FsZV9waXhlbF9yYXRl
X2wKKwkJCQkJLyAoZG91YmxlKSBjdXJfcmVxX3Blcl93aWR0aDsKKwkJfQorCisJCUFTU0VSVCgq
cmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1ciA8IGRtbF9wb3coMiwgMTMpKTsKKworCQlp
ZiAodnJhdGlvX2wgPD0gMS4wKSB7CisJCQkqcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfY3VyID0g
aGFjdGl2ZV9jdXIgKiByZWZfZnJlcV90b19waXhfZnJlcQorCQkJCQkvIChkb3VibGUpIGN1cl9y
ZXFfcGVyX3dpZHRoOworCQl9IGVsc2UgeworCQkJKnJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2N1
ciA9IChkb3VibGUpIHJlZmNsa19mcmVxX2luX21oegorCQkJCQkqIChkb3VibGUpIGN1cl9zcmNf
d2lkdGggLyBoc2NhbGVfcGl4ZWxfcmF0ZV9sCisJCQkJCS8gKGRvdWJsZSkgY3VyX3JlcV9wZXJf
d2lkdGg7CisJCX0KKworCQlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBjdXJfcmVxX3dpZHRoICAg
ICAgICAgICAgICAgICAgICAgPSAlZFxuIiwKKwkJCQlfX2Z1bmNfXywKKwkJCQljdXJfcmVxX3dp
ZHRoKTsKKwkJZG1sX3ByaW50KCJETUxfRExHOiAlczogY3VyX3dpZHRoX3ViICAgICAgICAgICAg
ICAgICAgICAgID0gJTMuMmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJY3VyX3dpZHRoX3ViKTsK
KwkJZG1sX3ByaW50KCJETUxfRExHOiAlczogY3VyX3JlcV9wZXJfd2lkdGggICAgICAgICAgICAg
ICAgID0gJTMuMmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJY3VyX3JlcV9wZXJfd2lkdGgpOwor
CQlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBoYWN0aXZlX2N1ciAgICAgICAgICAgICAgICAgICAg
ICAgPSAlMy4yZlxuIiwKKwkJCQlfX2Z1bmNfXywKKwkJCQloYWN0aXZlX2N1cik7CisJCWRtbF9w
cmludCgiRE1MX0RMRzogJXM6IHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIgICA9ICUz
LjJmXG4iLAorCQkJCV9fZnVuY19fLAorCQkJCSpyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVf
Y3VyKTsKKwkJZG1sX3ByaW50KCJETUxfRExHOiAlczogcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlf
Y3VyICAgICAgID0gJTMuMmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJKnJlZmN5Y19wZXJfcmVx
X2RlbGl2ZXJ5X2N1cik7CisKKwkJQVNTRVJUKCpyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIg
PCBkbWxfcG93KDIsIDEzKSk7CisJfQorfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9kaXNwbGF5L2RjL2RtbC9kY24yMC9kaXNwbGF5X3JxX2RsZ19jYWxjXzIwLmggYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2RjbjIwL2Rpc3BsYXlfcnFfZGxnX2NhbGNfMjAu
aApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmViYjI2MTA1Y2Y1OQot
LS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGNu
MjAvZGlzcGxheV9ycV9kbGdfY2FsY18yMC5oCkBAIC0wLDAgKzEsNzEgQEAKKy8qCisgKiBDb3B5
cmlnaHQgMjAxOCBBZHZhbmNlZCBNaWNybyBEZXZpY2VzLCBJbmMuCisgKgorICogUGVybWlzc2lv
biBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWlu
aW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0
aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3
aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUg
cmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwg
c3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0
byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRv
IGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUg
YWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBi
ZSBpbmNsdWRlZCBpbgorICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0
aGUgU29mdHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJ
VEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xV
RElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZ
LAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVO
VC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUgQ09QWVJJR0hUIEhPTERFUihTKSBPUiBBVVRI
T1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IKKyAqIE9USEVSIExJQUJJ
TElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNF
LAorICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZU
V0FSRSBPUiBUSEUgVVNFIE9SCisgKiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCisg
KgorICogQXV0aG9yczogQU1ECisgKgorICovCisKKyNpZm5kZWYgX19ETUwyMF9ESVNQTEFZX1JR
X0RMR19DQUxDX0hfXworI2RlZmluZSBfX0RNTDIwX0RJU1BMQVlfUlFfRExHX0NBTENfSF9fCisK
KyNpbmNsdWRlICIuLi9kbWxfY29tbW9uX2RlZnMuaCIKKyNpbmNsdWRlICIuLi9kaXNwbGF5X3Jx
X2RsZ19oZWxwZXJzLmgiCisKK3N0cnVjdCBkaXNwbGF5X21vZGVfbGliOworCisKKy8vIEZ1bmN0
aW9uOiBkbWxfcnFfZGxnX2dldF9ycV9yZWcKKy8vICBNYWluIGVudHJ5IHBvaW50IGZvciB0ZXN0
IHRvIGdldCB0aGUgcmVnaXN0ZXIgdmFsdWVzIG91dCBvZiB0aGlzIERNTCBjbGFzcy4KKy8vICBU
aGlzIGZ1bmN0aW9uIGNhbGxzIDxnZXRfcnFfcGFyYW0+IGFuZCA8ZXh0cmFjdF9ycV9yZWdzPiBm
dWNudGlvbnMgdG8gY2FsY3VsYXRlCisvLyAgYW5kIHRoZW4gcG9wdWxhdGUgdGhlIHJxX3JlZ3Mg
c3RydWN0CisvLyBJbnB1dDoKKy8vICBwaXBlX3NyY19wYXJhbSAtIHBpcGUgc291cmNlIGNvbmZp
Z3VyYXRpb24gKGUuZy4gdnAsIHBpdGNoLCBldGMuKQorLy8gT3V0cHV0OgorLy8gIHJxX3JlZ3Mg
LSBzdHJ1Y3QgdGhhdCBob2xkcyBhbGwgdGhlIFJRIHJlZ2lzdGVycyBmaWVsZCB2YWx1ZS4KKy8v
ICAgICAgICAgICAgU2VlIGFsc286IDxkaXNwbGF5X3JxX3JlZ3Nfc3Q+Cit2b2lkIGRtbDIwX3Jx
X2RsZ19nZXRfcnFfcmVnKAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJ
CWRpc3BsYXlfcnFfcmVnc19zdCAqcnFfcmVncywKKwkJY29uc3QgZGlzcGxheV9waXBlX3BhcmFt
c19zdCBwaXBlX3BhcmFtKTsKKworCisvLyBGdW5jdGlvbjogZG1sX3JxX2RsZ19nZXRfZGxnX3Jl
ZworLy8gICBDYWxjdWxhdGUgYW5kIHJldHVybiBETEcgYW5kIFRUVSByZWdpc3RlciBzdHJ1Y3Qg
Z2l2ZW4gdGhlIHN5c3RlbSBzZXR0aW5nCisvLyBPdXRwdXQ6CisvLyAgZGxnX3JlZ3MgLSBvdXRw
dXQgRExHIHJlZ2lzdGVyIHN0cnVjdAorLy8gIHR0dV9yZWdzIC0gb3V0cHV0IERMRyBUVFUgcmVn
aXN0ZXIgc3RydWN0CisvLyBJbnB1dDoKKy8vICBlMmVfcGlwZV9wYXJhbSAtICJjb21wYWN0ZWQi
IGFycmF5IG9mIGUyZSBwaXBlIHBhcmFtIHN0cnVjdAorLy8gIG51bV9waXBlcyAtIG51bSBvZiBh
Y3RpdmUgInBpcGUiIG9yICJyb3V0ZSIKKy8vICBwaXBlX2lkeCAtIGluZGV4IHRoYXQgaWRlbnRp
ZmllcyB0aGUgZTJlX3BpcGVfcGFyYW0gdGhhdCBjb3JyZXNwb25kaW5nIHRvIHRoaXMgZGxnCisv
LyAgY3N0YXRlIC0gMDogd2hlbiBjYWxjdWxhdGUgbWluX3R0dV92YmxhbmsgaXQgaXMgYXNzdW1l
ZCBjc3RhdGUgaXMgbm90IHJlcXVpcmVkLiAxOiBOb3JtYWwgbW9kZSwgY3N0YXRlIGlzIGNvbnNp
ZGVyZWQuCisvLyAgICAgICAgICAgQWRkZWQgZm9yIGxlZ2FjeSBvciB1bnJlYWxpc3RpYyB0aW1p
bmcgdGVzdHMuCit2b2lkIGRtbDIwX3JxX2RsZ19nZXRfZGxnX3JlZygKKwkJc3RydWN0IGRpc3Bs
YXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkaXNwbGF5X2RsZ19yZWdzX3N0ICpkbGdfcmVncywK
KwkJZGlzcGxheV90dHVfcmVnc19zdCAqdHR1X3JlZ3MsCisJCWRpc3BsYXlfZTJlX3BpcGVfcGFy
YW1zX3N0ICplMmVfcGlwZV9wYXJhbSwKKwkJY29uc3QgdW5zaWduZWQgaW50IG51bV9waXBlcywK
KwkJY29uc3QgdW5zaWduZWQgaW50IHBpcGVfaWR4LAorCQljb25zdCBib29sIGNzdGF0ZV9lbiwK
KwkJY29uc3QgYm9vbCBwc3RhdGVfZW4pOworCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5jIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kaXNwbGF5X21vZGVfbGliLmMKaW5kZXggODBmZmQ3
ZDk1OGIyLi45MTgxMGM3ZDVjZjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5jCkBAIC0yNSw2ICsyNSwxOSBAQAogCiAj
aW5jbHVkZSAiZGlzcGxheV9tb2RlX2xpYi5oIgogI2luY2x1ZGUgImRjX2ZlYXR1cmVzLmgiCisj
aWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzApCisjaW5jbHVkZSAiZGNuMjAvZGlz
cGxheV9tb2RlX3ZiYV8yMC5oIgorI2luY2x1ZGUgImRjbjIwL2Rpc3BsYXlfcnFfZGxnX2NhbGNf
MjAuaCIKKyNlbmRpZgorCisjaWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzApCitj
b25zdCBzdHJ1Y3QgZG1sX2Z1bmNzIGRtbDIwX2Z1bmNzID0geworCS52YWxpZGF0ZSA9IGRtbDIw
X01vZGVTdXBwb3J0QW5kU3lzdGVtQ29uZmlndXJhdGlvbkZ1bGwsCisJLnJlY2FsY3VsYXRlID0g
ZG1sMjBfcmVjYWxjdWxhdGUsCisJLnJxX2RsZ19nZXRfZGxnX3JlZyA9IGRtbDIwX3JxX2RsZ19n
ZXRfZGxnX3JlZywKKwkucnFfZGxnX2dldF9ycV9yZWcgPSBkbWwyMF9ycV9kbGdfZ2V0X3JxX3Jl
ZworfTsKKyNlbmRpZgogCiB2b2lkIGRtbF9pbml0X2luc3RhbmNlKHN0cnVjdCBkaXNwbGF5X21v
ZGVfbGliICpsaWIsCiAJCWNvbnN0IHN0cnVjdCBfdmNzX2RwaV9zb2NfYm91bmRpbmdfYm94X3N0
ICpzb2NfYmIsCkBAIC0zNCw2ICs0NywxNSBAQCB2b2lkIGRtbF9pbml0X2luc3RhbmNlKHN0cnVj
dCBkaXNwbGF5X21vZGVfbGliICpsaWIsCiAJbGliLT5zb2MgPSAqc29jX2JiOwogCWxpYi0+aXAg
PSAqaXBfcGFyYW1zOwogCWxpYi0+cHJvamVjdCA9IHByb2plY3Q7CisJc3dpdGNoIChwcm9qZWN0
KSB7CisjaWZkZWYgQ09ORklHX0RSTV9BTURfRENfRENOMl8wCisJY2FzZSBETUxfUFJPSkVDVF9O
QVZJMTA6CisJCWxpYi0+ZnVuY3MgPSBkbWwyMF9mdW5jczsKKwkJYnJlYWs7CisjZW5kaWYKKwlk
ZWZhdWx0OgorCQlicmVhazsKKwl9CiB9CiAKIGNvbnN0IGNoYXIgKmRtbF9nZXRfc3RhdHVzX21l
c3NhZ2UoZW51bSBkbV92YWxpZGF0aW9uX3N0YXR1cyBzdGF0dXMpCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV9saWIuaCBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5oCmluZGV4IDFi
NTQ2ZGJhMzRiZC4uZjIzMzFjMDlmYWQ4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV9saWIuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV9saWIuaApAQCAtMjcsMTggKzI3LDQzIEBA
CiAKIAogI2luY2x1ZGUgImRtbF9jb21tb25fZGVmcy5oIgotI2luY2x1ZGUgImRtbDFfZGlzcGxh
eV9ycV9kbGdfY2FsYy5oIgorI2luY2x1ZGUgImRpc3BsYXlfbW9kZV92YmEuaCIKIAogZW51bSBk
bWxfcHJvamVjdCB7CiAJRE1MX1BST0pFQ1RfVU5ERUZJTkVELAotCURNTF9QUk9KRUNUX1JBVkVO
MQorCURNTF9QUk9KRUNUX1JBVkVOMSwKKyNpZmRlZiBDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzAK
KwlETUxfUFJPSkVDVF9OQVZJMTAsCisjZW5kaWYKK307CisKK3N0cnVjdCBkbWxfZnVuY3Mgewor
CXZvaWQgKCpycV9kbGdfZ2V0X2RsZ19yZWcpKAorCQkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIg
Km1vZGVfbGliLAorCQkJZGlzcGxheV9kbGdfcmVnc19zdCAqZGxnX3JlZ3MsCisJCQlkaXNwbGF5
X3R0dV9yZWdzX3N0ICp0dHVfcmVncywKKwkJCWRpc3BsYXlfZTJlX3BpcGVfcGFyYW1zX3N0ICpl
MmVfcGlwZV9wYXJhbSwKKwkJCWNvbnN0IHVuc2lnbmVkIGludCBudW1fcGlwZXMsCisJCQljb25z
dCB1bnNpZ25lZCBpbnQgcGlwZV9pZHgsCisJCQljb25zdCBib29sIGNzdGF0ZV9lbiwKKwkJCWNv
bnN0IGJvb2wgcHN0YXRlX2VuKTsKKwl2b2lkICgqcnFfZGxnX2dldF9ycV9yZWcpKAorCQlzdHJ1
Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRpc3BsYXlfcnFfcmVnc19zdCAqcnFf
cmVncywKKwkJY29uc3QgZGlzcGxheV9waXBlX3BhcmFtc19zdCBwaXBlX3BhcmFtKTsKKwl2b2lk
ICgqcmVjYWxjdWxhdGUpKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYik7CisJdm9p
ZCAoKnZhbGlkYXRlKShzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIpOwogfTsKIAog
c3RydWN0IGRpc3BsYXlfbW9kZV9saWIgewogCXN0cnVjdCBfdmNzX2RwaV9pcF9wYXJhbXNfc3Qg
aXA7CiAJc3RydWN0IF92Y3NfZHBpX3NvY19ib3VuZGluZ19ib3hfc3Qgc29jOwogCWVudW0gZG1s
X3Byb2plY3QgcHJvamVjdDsKKyNpZmRlZiBDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzAKKwlzdHJ1
Y3QgdmJhX3ZhcnNfc3QgdmJhOworI2VuZGlmCiAJc3RydWN0IGRhbF9sb2dnZXIgKmxvZ2dlcjsK
KwlzdHJ1Y3QgZG1sX2Z1bmNzIGZ1bmNzOwogfTsKIAogdm9pZCBkbWxfaW5pdF9pbnN0YW5jZShz
dHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbGliLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2RtbC9kaXNwbGF5X21vZGVfc3RydWN0cy5oIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kaXNwbGF5X21vZGVfc3RydWN0cy5oCmluZGV4IDZjYzU5
ZjEzODA5NS4uMTM5YTg3NDBjMDcwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV9zdHJ1Y3RzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2RtbC9kaXNwbGF5X21vZGVfc3RydWN0cy5oCkBAIC01Nyw2ICs1Nyw3
IEBAIHN0cnVjdCBfdmNzX2RwaV92b2x0YWdlX3NjYWxpbmdfc3QgewogCWRvdWJsZSBkc2NjbGtf
bWh6OwogCWRvdWJsZSBkY2ZjbGtfbWh6OwogCWRvdWJsZSBzb2NjbGtfbWh6OworCWRvdWJsZSBw
aHljbGtfZDE4X21oejsKIAlkb3VibGUgZHJhbV9zcGVlZF9tdHM7CiAJZG91YmxlIGZhYnJpY2Ns
a19taHo7CiAJZG91YmxlIGRpc3BjbGtfbWh6OwpAQCAtOTcsNiArOTgsNyBAQCBzdHJ1Y3QgX3Zj
c19kcGlfc29jX2JvdW5kaW5nX2JveF9zdCB7CiAJdW5zaWduZWQgaW50IG51bV9iYW5rczsKIAl1
bnNpZ25lZCBpbnQgbnVtX2NoYW5zOwogCXVuc2lnbmVkIGludCB2bW1fcGFnZV9zaXplX2J5dGVz
OworCXVuc2lnbmVkIGludCBob3N0dm1fbWluX3BhZ2Vfc2l6ZV9ieXRlczsKIAlkb3VibGUgZHJh
bV9jbG9ja19jaGFuZ2VfbGF0ZW5jeV91czsKIAlkb3VibGUgd3JpdGViYWNrX2RyYW1fY2xvY2tf
Y2hhbmdlX2xhdGVuY3lfdXM7CiAJdW5zaWduZWQgaW50IHJldHVybl9idXNfd2lkdGhfYnl0ZXM7
CkBAIC0xMzUsNiArMTM3LDIxIEBAIHN0cnVjdCBfdmNzX2RwaV9pcF9wYXJhbXNfc3QgewogCXVu
c2lnbmVkIGludCB3cml0ZWJhY2tfbHVtYV9idWZmZXJfc2l6ZV9rYnl0ZXM7CiAJdW5zaWduZWQg
aW50IHdyaXRlYmFja19jaHJvbWFfYnVmZmVyX3NpemVfa2J5dGVzOwogCXVuc2lnbmVkIGludCB3
cml0ZWJhY2tfY2hyb21hX2xpbmVfYnVmZmVyX3dpZHRoX3BpeGVsczsKKworCXVuc2lnbmVkIGlu
dCB3cml0ZWJhY2tfaW50ZXJmYWNlX2J1ZmZlcl9zaXplX2tieXRlczsKKwl1bnNpZ25lZCBpbnQg
d3JpdGViYWNrX2xpbmVfYnVmZmVyX2J1ZmZlcl9zaXplOworCisjaWZkZWYgQ09ORklHX0RSTV9B
TURfRENfRENOMl8wCisJdW5zaWduZWQgaW50IHdyaXRlYmFja18xMGJwYzQyMF9zdXBwb3J0ZWQ7
CisJZG91YmxlIHdyaXRlYmFja19tYXhfaHNjbF9yYXRpbzsKKwlkb3VibGUgd3JpdGViYWNrX21h
eF92c2NsX3JhdGlvOworCWRvdWJsZSB3cml0ZWJhY2tfbWluX2hzY2xfcmF0aW87CisJZG91Ymxl
IHdyaXRlYmFja19taW5fdnNjbF9yYXRpbzsKKwl1bnNpZ25lZCBpbnQgd3JpdGViYWNrX21heF9o
c2NsX3RhcHM7CisJdW5zaWduZWQgaW50IHdyaXRlYmFja19tYXhfdnNjbF90YXBzOworCXVuc2ln
bmVkIGludCB3cml0ZWJhY2tfbGluZV9idWZmZXJfbHVtYV9idWZmZXJfc2l6ZTsKKwl1bnNpZ25l
ZCBpbnQgd3JpdGViYWNrX2xpbmVfYnVmZmVyX2Nocm9tYV9idWZmZXJfc2l6ZTsKKyNlbmRpZgog
CXVuc2lnbmVkIGludCBtYXhfcGFnZV90YWJsZV9sZXZlbHM7CiAJdW5zaWduZWQgaW50IG1heF9u
dW1fZHBwOwogCXVuc2lnbmVkIGludCBtYXhfbnVtX290ZzsKQEAgLTE1Miw2ICsxNjksMTMgQEAg
c3RydWN0IF92Y3NfZHBpX2lwX3BhcmFtc19zdCB7CiAJdW5zaWduZWQgaW50IG1heF9oc2NsX3Rh
cHM7CiAJdW5zaWduZWQgaW50IG1heF92c2NsX3RhcHM7CiAJdW5zaWduZWQgaW50IHhmY19zdXBw
b3J0ZWQ7CisJdW5zaWduZWQgaW50IHB0b2lfc3VwcG9ydGVkOworCXVuc2lnbmVkIGludCBnZng3
X2NvbXBhdF90aWxpbmdfc3VwcG9ydGVkOworCisJYm9vbCBvZG1fY29tYmluZV80dG8xX3N1cHBv
cnRlZDsKKwlib29sIGR5bmFtaWNfbWV0YWRhdGFfdm1fZW5hYmxlZDsKKwl1bnNpZ25lZCBpbnQg
bWF4X251bV9oZG1pX2ZybF9vdXRwdXRzOworCiAJdW5zaWduZWQgaW50IHhmY19maWxsX2NvbnN0
YW50X2J5dGVzOwogCWRvdWJsZSBkaXNwY2xrX3JhbXBfbWFyZ2luX3BlcmNlbnQ7CiAJZG91Ymxl
IHhmY19maWxsX2J3X292ZXJoZWFkX3BlcmNlbnQ7CkBAIC0yMTgsNiArMjQyLDcgQEAgc3RydWN0
IF92Y3NfZHBpX2Rpc3BsYXlfcGlwZV9zb3VyY2VfcGFyYW1zX3N0IHsKIAl1bnNpZ25lZCBpbnQg
aHNwbGl0X2dycDsKIAl1bnNpZ25lZCBjaGFyIHhmY19lbmFibGU7CiAJdW5zaWduZWQgY2hhciB4
ZmNfc2xhdmU7CisJdW5zaWduZWQgY2hhciBpbW1lZGlhdGVfZmxpcDsKIAlzdHJ1Y3QgX3Zjc19k
cGlfZGlzcGxheV94ZmNfcGFyYW1zX3N0IHhmY19wYXJhbXM7CiAJLy9mb3IgdnN0YXJ0dXBsaW5l
cyBjYWxjdWxhdGlvbiBmcmVlc3luYwogCXVuc2lnbmVkIGNoYXIgdl90b3RhbF9taW47CkBAIC0y
MjUsNiArMjUwLDcgQEAgc3RydWN0IF92Y3NfZHBpX2Rpc3BsYXlfcGlwZV9zb3VyY2VfcGFyYW1z
X3N0IHsKIH07CiBzdHJ1Y3Qgd3JpdGViYWNrX3N0IHsKIAlpbnQgd2Jfc3JjX2hlaWdodDsKKwlp
bnQgd2Jfc3JjX3dpZHRoOwogCWludCB3Yl9kc3Rfd2lkdGg7CiAJaW50IHdiX2RzdF9oZWlnaHQ7
CiAJaW50IHdiX3BpeGVsX2Zvcm1hdDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX3ZiYS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2RtbC9kaXNwbGF5X21vZGVfdmJhLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5k
ZXggMDAwMDAwMDAwMDAwLi5lNWU0YzRiYTkwMTEKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV92YmEuYwpAQCAtMCwwICsx
LDg0NSBAQAorLyoKKyAqIENvcHlyaWdodCAyMDE3IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIElu
Yy4KKyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwg
dG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBh
c3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRl
YWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0
IGxpbWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBw
dWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9m
IHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0
d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25k
aXRpb25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1p
c3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0
YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMg
UFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBP
UgorICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElF
UyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9T
RSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBDT1BZUklH
SFQgSE9MREVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdF
UyBPUgorICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFD
VCwgVE9SVCBPUiBPVEhFUldJU0UsCisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05O
RUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERFQUxJTkdT
IElOIFRIRSBTT0ZUV0FSRS4KKyAqCisgKiBBdXRob3JzOiBBTUQKKyAqCisgKi8KKworI2lmZGVm
IENPTkZJR19EUk1fQU1EX0RDX0RDTjJfMAorCisjaW5jbHVkZSAiZGlzcGxheV9tb2RlX2xpYi5o
IgorI2luY2x1ZGUgImRpc3BsYXlfbW9kZV92YmEuaCIKKyNpbmNsdWRlICJkbWxfaW5saW5lX2Rl
ZnMuaCIKKworLyoKKyAqIE5PVEU6CisgKiAgIFRoaXMgZmlsZSBpcyBnY2MtcGFyc2FibGUgSFcg
Z29zcGVsLCBjb21pbmcgc3RyYWlnaHQgZnJvbSBIVyBlbmdpbmVlcnMuCisgKgorICogSXQgZG9l
c24ndCBhZGhlcmUgdG8gTGludXgga2VybmVsIHN0eWxlIGFuZCBzb21ldGltZXMgd2lsbCBkbyB0
aGluZ3MgaW4gb2RkCisgKiB3YXlzLiBVbmxlc3MgdGhlcmUgaXMgc29tZXRoaW5nIGNsZWFybHkg
d3Jvbmcgd2l0aCBpdCB0aGUgY29kZSBzaG91bGQKKyAqIHJlbWFpbiBhcy1pcyBhcyBpdCBwcm92
aWRlcyB1cyB3aXRoIGEgZ3VhcmFudGVlIGZyb20gSFcgdGhhdCBpdCBpcyBjb3JyZWN0LgorICov
CisKKworc3RhdGljIHZvaWQgZmV0Y2hfc29jYmJfcGFyYW1zKHN0cnVjdCBkaXNwbGF5X21vZGVf
bGliICptb2RlX2xpYik7CitzdGF0aWMgdm9pZCBmZXRjaF9pcF9wYXJhbXMoc3RydWN0IGRpc3Bs
YXlfbW9kZV9saWIgKm1vZGVfbGliKTsKK3N0YXRpYyB2b2lkIGZldGNoX3BpcGVfcGFyYW1zKHN0
cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYik7CitzdGF0aWMgdm9pZCByZWNhbGN1bGF0
ZV9wYXJhbXMoCisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJY29uc3Qg
ZGlzcGxheV9lMmVfcGlwZV9wYXJhbXNfc3QgKnBpcGVzLAorCQl1bnNpZ25lZCBpbnQgbnVtX3Bp
cGVzKTsKKworc3RhdGljIHVuc2lnbmVkIGludCBDdXJzb3JCcHBFbnVtVG9CaXRzKGVudW0gY3Vy
c29yX2JwcCBlYnBwKTsKKwordW5zaWduZWQgaW50IGRtbF9nZXRfdm9sdGFnZV9sZXZlbCgKKwkJ
c3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQljb25zdCBkaXNwbGF5X2UyZV9w
aXBlX3BhcmFtc19zdCAqcGlwZXMsCisJCXVuc2lnbmVkIGludCBudW1fcGlwZXMpCit7CisJYm9v
bCBuZWVkX3JlY2FsY3VsYXRlID0gbWVtY21wKCZtb2RlX2xpYi0+c29jLCAmbW9kZV9saWItPnZi
YS5zb2MsIHNpemVvZihtb2RlX2xpYi0+dmJhLnNvYykpICE9IDAKKwkJCXx8IG1lbWNtcCgmbW9k
ZV9saWItPmlwLCAmbW9kZV9saWItPnZiYS5pcCwgc2l6ZW9mKG1vZGVfbGliLT52YmEuaXApKSAh
PSAwCisJCQl8fCBudW1fcGlwZXMgIT0gbW9kZV9saWItPnZiYS5jYWNoZV9udW1fcGlwZXMKKwkJ
CXx8IG1lbWNtcChwaXBlcywgbW9kZV9saWItPnZiYS5jYWNoZV9waXBlcywKKwkJCQkJc2l6ZW9m
KGRpc3BsYXlfZTJlX3BpcGVfcGFyYW1zX3N0KSAqIG51bV9waXBlcykgIT0gMDsKKworCW1vZGVf
bGliLT52YmEuc29jID0gbW9kZV9saWItPnNvYzsKKwltb2RlX2xpYi0+dmJhLmlwID0gbW9kZV9s
aWItPmlwOworCW1lbWNweShtb2RlX2xpYi0+dmJhLmNhY2hlX3BpcGVzLCBwaXBlcywgc2l6ZW9m
KCpwaXBlcykgKiBudW1fcGlwZXMpOworCW1vZGVfbGliLT52YmEuY2FjaGVfbnVtX3BpcGVzID0g
bnVtX3BpcGVzOworCisJaWYgKG5lZWRfcmVjYWxjdWxhdGUgJiYgcGlwZXNbMF0uY2xrc19jZmcu
ZHBwY2xrX21oeiAhPSAwKQorCQltb2RlX2xpYi0+ZnVuY3MucmVjYWxjdWxhdGUobW9kZV9saWIp
OworCWVsc2UgeworCQlmZXRjaF9zb2NiYl9wYXJhbXMobW9kZV9saWIpOworCQlmZXRjaF9pcF9w
YXJhbXMobW9kZV9saWIpOworCQlmZXRjaF9waXBlX3BhcmFtcyhtb2RlX2xpYik7CisJCVBpeGVs
Q2xvY2tBZGp1c3RtZW50Rm9yUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXQobW9kZV9saWIpOwor
CX0KKwkJbW9kZV9saWItPmZ1bmNzLnZhbGlkYXRlKG1vZGVfbGliKTsKKworCS8qIGNoZWNrIGlm
IE1vZGUgU3VwcG9ydCBWYWxpZGF0aW9uIGZhaWxlZCAqLworCWlmIChtb2RlX2xpYi0+dmJhLlZv
bHRhZ2VMZXZlbCA+IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXMpIHsKKwkJLyogZ2V0IHRo
ZSB2YWxpZGF0aW9uIHN0YXR1cyBmb3IgaGlnaGVzdCB2b2x0YWdlIGxldmVsIGFuZCBvdXRwdXQg
Y29uc29sZSBtZXNzYWdlICovCisJCWVudW0gZG1fdmFsaWRhdGlvbl9zdGF0dXMgc3RhdHVzID0g
bW9kZV9saWItPnZiYS5WYWxpZGF0aW9uU3RhdHVzW21vZGVfbGliLT52YmEuc29jLm51bV9zdGF0
ZXNdOworCQlpZiAoc3RhdHVzICE9IERNTF9GQUlMX1BJVENIX1NVUFBPUlQpIHsKKwkJCS8qQWxp
Z25lZFlQaXRjaCBpcyBiYXNlZCBvbiBzd2l6emxlIG1vZGUsIHNvIGl0IGlzIG5vcm1hbCBpZiBz
b21lIHN3aXp6bGUgbW9kZSBub3Qgc3VwcG9ydGVkKi8KKwkJCWRtX291dHB1dF90b19jb25zb2xl
KCJNb2RlIFZhbGlkYXRpb24gRXJyb3I6ICVzIGZhaWxlZCB2YWxpZGF0aW9uLlxuIiwgZG1sX2dl
dF9zdGF0dXNfbWVzc2FnZShzdGF0dXMpKTsKKwkJfQorCX0KKworCXJldHVybiBtb2RlX2xpYi0+
dmJhLlZvbHRhZ2VMZXZlbDsKK30KKworI2RlZmluZSBkbWxfZ2V0X2F0dHJfZnVuYyhhdHRyLCB2
YXIpICBkb3VibGUgZ2V0XyMjYXR0cihzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIs
IGNvbnN0IGRpc3BsYXlfZTJlX3BpcGVfcGFyYW1zX3N0ICpwaXBlcywgdW5zaWduZWQgaW50IG51
bV9waXBlcykgXAoreyBcCisJcmVjYWxjdWxhdGVfcGFyYW1zKG1vZGVfbGliLCBwaXBlcywgbnVt
X3BpcGVzKTsgXAorCXJldHVybiB2YXI7IFwKK30KKworZG1sX2dldF9hdHRyX2Z1bmMoY2xrX2Rj
Zl9kZWVwc2xlZXAsIG1vZGVfbGliLT52YmEuRENGQ0xLRGVlcFNsZWVwKTsKK2RtbF9nZXRfYXR0
cl9mdW5jKHdtX3VyZ2VudCwgbW9kZV9saWItPnZiYS5VcmdlbnRXYXRlcm1hcmspOworZG1sX2dl
dF9hdHRyX2Z1bmMod21fbWVtb3J5X3RyaXAsIG1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeSk7
CitkbWxfZ2V0X2F0dHJfZnVuYyh3bV93cml0ZWJhY2tfdXJnZW50LCBtb2RlX2xpYi0+dmJhLldy
aXRlYmFja1VyZ2VudFdhdGVybWFyayk7CitkbWxfZ2V0X2F0dHJfZnVuYyh3bV9zdHV0dGVyX2V4
aXQsIG1vZGVfbGliLT52YmEuU3R1dHRlckV4aXRXYXRlcm1hcmspOworZG1sX2dldF9hdHRyX2Z1
bmMod21fc3R1dHRlcl9lbnRlcl9leGl0LCBtb2RlX2xpYi0+dmJhLlN0dXR0ZXJFbnRlclBsdXNF
eGl0V2F0ZXJtYXJrKTsKK2RtbF9nZXRfYXR0cl9mdW5jKHdtX2RyYW1fY2xvY2tfY2hhbmdlLCBt
b2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZVdhdGVybWFyayk7CitkbWxfZ2V0X2F0dHJfZnVu
Yyh3bV93cml0ZWJhY2tfZHJhbV9jbG9ja19jaGFuZ2UsIG1vZGVfbGliLT52YmEuV3JpdGViYWNr
RFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrKTsKK2RtbF9nZXRfYXR0cl9mdW5jKHdtX3hmY191bmRl
cmZsb3csIG1vZGVfbGliLT52YmEuVXJnZW50V2F0ZXJtYXJrKTsgLy8geGZjX3VuZGVyZmxvdyBt
YXBzIHRvIHVyZ2VudAorZG1sX2dldF9hdHRyX2Z1bmMoc3R1dHRlcl9lZmZpY2llbmN5LCBtb2Rl
X2xpYi0+dmJhLlN0dXR0ZXJFZmZpY2llbmN5KTsKK2RtbF9nZXRfYXR0cl9mdW5jKHN0dXR0ZXJf
ZWZmaWNpZW5jeV9ub192YmxhbmssIG1vZGVfbGliLT52YmEuU3R1dHRlckVmZmljaWVuY3lOb3RJ
bmNsdWRpbmdWQmxhbmspOworZG1sX2dldF9hdHRyX2Z1bmModXJnZW50X2xhdGVuY3ksIG1vZGVf
bGliLT52YmEuVXJnZW50TGF0ZW5jeSk7CitkbWxfZ2V0X2F0dHJfZnVuYyh1cmdlbnRfZXh0cmFf
bGF0ZW5jeSwgbW9kZV9saWItPnZiYS5VcmdlbnRFeHRyYUxhdGVuY3kpOworZG1sX2dldF9hdHRy
X2Z1bmMobm9udXJnZW50X2xhdGVuY3ksIG1vZGVfbGliLT52YmEuTm9uVXJnZW50TGF0ZW5jeVRv
bGVyYW5jZSk7CitkbWxfZ2V0X2F0dHJfZnVuYygKKwkJZHJhbV9jbG9ja19jaGFuZ2VfbGF0ZW5j
eSwKKwkJbW9kZV9saWItPnZiYS5NaW5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5U3VwcG9y
dGVkKTsKK2RtbF9nZXRfYXR0cl9mdW5jKGRpc3BjbGtfY2FsY3VsYXRlZCwgbW9kZV9saWItPnZi
YS5ESVNQQ0xLX2NhbGN1bGF0ZWQpOworZG1sX2dldF9hdHRyX2Z1bmModG90YWxfZGF0YV9yZWFk
X2J3LCBtb2RlX2xpYi0+dmJhLlRvdGFsRGF0YVJlYWRCYW5kd2lkdGgpOworZG1sX2dldF9hdHRy
X2Z1bmMocmV0dXJuX2J3LCBtb2RlX2xpYi0+dmJhLlJldHVybkJXKTsKK2RtbF9nZXRfYXR0cl9m
dW5jKHRjYWxjLCBtb2RlX2xpYi0+dmJhLlRDYWxjKTsKK2RtbF9nZXRfYXR0cl9mdW5jKGZyYWN0
aW9uX29mX3VyZ2VudF9iYW5kd2lkdGgsIG1vZGVfbGliLT52YmEuRnJhY3Rpb25PZlVyZ2VudEJh
bmR3aWR0aCk7CitkbWxfZ2V0X2F0dHJfZnVuYyhmcmFjdGlvbl9vZl91cmdlbnRfYmFuZHdpZHRo
X2ltbV9mbGlwLCBtb2RlX2xpYi0+dmJhLkZyYWN0aW9uT2ZVcmdlbnRCYW5kd2lkdGhJbW1lZGlh
dGVGbGlwKTsKKworI2RlZmluZSBkbWxfZ2V0X3BpcGVfYXR0cl9mdW5jKGF0dHIsIHZhcikgIGRv
dWJsZSBnZXRfIyNhdHRyKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwgY29uc3Qg
ZGlzcGxheV9lMmVfcGlwZV9wYXJhbXNfc3QgKnBpcGVzLCB1bnNpZ25lZCBpbnQgbnVtX3BpcGVz
LCB1bnNpZ25lZCBpbnQgd2hpY2hfcGlwZSkgXAore1wKKwl1bnNpZ25lZCBpbnQgd2hpY2hfcGxh
bmU7IFwKKwlyZWNhbGN1bGF0ZV9wYXJhbXMobW9kZV9saWIsIHBpcGVzLCBudW1fcGlwZXMpOyBc
CisJd2hpY2hfcGxhbmUgPSBtb2RlX2xpYi0+dmJhLnBpcGVfcGxhbmVbd2hpY2hfcGlwZV07IFwK
KwlyZXR1cm4gdmFyW3doaWNoX3BsYW5lXTsgXAorfQorCitkbWxfZ2V0X3BpcGVfYXR0cl9mdW5j
KGRzY19kZWxheSwgbW9kZV9saWItPnZiYS5EU0NEZWxheSk7CitkbWxfZ2V0X3BpcGVfYXR0cl9m
dW5jKGRwcGNsa19jYWxjdWxhdGVkLCBtb2RlX2xpYi0+dmJhLkRQUENMS19jYWxjdWxhdGVkKTsK
K2RtbF9nZXRfcGlwZV9hdHRyX2Z1bmMoZHNjY2xrX2NhbGN1bGF0ZWQsIG1vZGVfbGliLT52YmEu
RFNDQ0xLX2NhbGN1bGF0ZWQpOworZG1sX2dldF9waXBlX2F0dHJfZnVuYyhtaW5fdHR1X3ZibGFu
aywgbW9kZV9saWItPnZiYS5NaW5UVFVWQmxhbmspOworZG1sX2dldF9waXBlX2F0dHJfZnVuYyh2
cmF0aW9fcHJlZmV0Y2hfbCwgbW9kZV9saWItPnZiYS5WUmF0aW9QcmVmZXRjaFkpOworZG1sX2dl
dF9waXBlX2F0dHJfZnVuYyh2cmF0aW9fcHJlZmV0Y2hfYywgbW9kZV9saWItPnZiYS5WUmF0aW9Q
cmVmZXRjaEMpOworZG1sX2dldF9waXBlX2F0dHJfZnVuYyhkc3RfeF9hZnRlcl9zY2FsZXIsIG1v
ZGVfbGliLT52YmEuRFNUWEFmdGVyU2NhbGVyKTsKK2RtbF9nZXRfcGlwZV9hdHRyX2Z1bmMoZHN0
X3lfYWZ0ZXJfc2NhbGVyLCBtb2RlX2xpYi0+dmJhLkRTVFlBZnRlclNjYWxlcik7CitkbWxfZ2V0
X3BpcGVfYXR0cl9mdW5jKGRzdF95X3Blcl92bV92YmxhbmssIG1vZGVfbGliLT52YmEuRGVzdGlu
YXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxhbmspOworZG1sX2dldF9waXBlX2F0dHJfZnVuYyhk
c3RfeV9wZXJfcm93X3ZibGFuaywgbW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxpbmVzVG9SZXF1
ZXN0Um93SW5WQmxhbmspOworZG1sX2dldF9waXBlX2F0dHJfZnVuYyhkc3RfeV9wcmVmZXRjaCwg
bW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxpbmVzRm9yUHJlZmV0Y2gpOworZG1sX2dldF9waXBl
X2F0dHJfZnVuYyhkc3RfeV9wZXJfdm1fZmxpcCwgbW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxp
bmVzVG9SZXF1ZXN0Vk1JbkltbWVkaWF0ZUZsaXApOworZG1sX2dldF9waXBlX2F0dHJfZnVuYygK
KwkJZHN0X3lfcGVyX3Jvd19mbGlwLAorCQltb2RlX2xpYi0+dmJhLkRlc3RpbmF0aW9uTGluZXNU
b1JlcXVlc3RSb3dJbkltbWVkaWF0ZUZsaXApOworCitkbWxfZ2V0X3BpcGVfYXR0cl9mdW5jKHhm
Y190cmFuc2Zlcl9kZWxheSwgbW9kZV9saWItPnZiYS5YRkNUcmFuc2ZlckRlbGF5KTsKK2RtbF9n
ZXRfcGlwZV9hdHRyX2Z1bmMoeGZjX3ByZWNoYXJnZV9kZWxheSwgbW9kZV9saWItPnZiYS5YRkNQ
cmVjaGFyZ2VEZWxheSk7CitkbWxfZ2V0X3BpcGVfYXR0cl9mdW5jKHhmY19yZW1vdGVfc3VyZmFj
ZV9mbGlwX2xhdGVuY3ksIG1vZGVfbGliLT52YmEuWEZDUmVtb3RlU3VyZmFjZUZsaXBMYXRlbmN5
KTsKK2RtbF9nZXRfcGlwZV9hdHRyX2Z1bmMoeGZjX3ByZWZldGNoX21hcmdpbiwgbW9kZV9saWIt
PnZiYS5YRkNQcmVmZXRjaE1hcmdpbik7CitkbWxfZ2V0X3BpcGVfYXR0cl9mdW5jKHJlZmN5Y19w
ZXJfdm1fZ3JvdXBfdmJsYW5rLCBtb2RlX2xpYi0+dmJhLlRpbWVQZXJWTUdyb3VwVkJsYW5rKTsK
K2RtbF9nZXRfcGlwZV9hdHRyX2Z1bmMocmVmY3ljX3Blcl92bV9ncm91cF9mbGlwLCBtb2RlX2xp
Yi0+dmJhLlRpbWVQZXJWTUdyb3VwRmxpcCk7CitkbWxfZ2V0X3BpcGVfYXR0cl9mdW5jKHJlZmN5
Y19wZXJfdm1fcmVxX3ZibGFuaywgbW9kZV9saWItPnZiYS5UaW1lUGVyVk1SZXF1ZXN0VkJsYW5r
KTsKK2RtbF9nZXRfcGlwZV9hdHRyX2Z1bmMocmVmY3ljX3Blcl92bV9yZXFfZmxpcCwgbW9kZV9s
aWItPnZiYS5UaW1lUGVyVk1SZXF1ZXN0RmxpcCk7CisKK3Vuc2lnbmVkIGludCBnZXRfdnN0YXJ0
dXBfY2FsY3VsYXRlZCgKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlj
b25zdCBkaXNwbGF5X2UyZV9waXBlX3BhcmFtc19zdCAqcGlwZXMsCisJCXVuc2lnbmVkIGludCBu
dW1fcGlwZXMsCisJCXVuc2lnbmVkIGludCB3aGljaF9waXBlKQoreworCXVuc2lnbmVkIGludCB3
aGljaF9wbGFuZTsKKworCXJlY2FsY3VsYXRlX3BhcmFtcyhtb2RlX2xpYiwgcGlwZXMsIG51bV9w
aXBlcyk7CisJd2hpY2hfcGxhbmUgPSBtb2RlX2xpYi0+dmJhLnBpcGVfcGxhbmVbd2hpY2hfcGlw
ZV07CisJcmV0dXJuIG1vZGVfbGliLT52YmEuVlN0YXJ0dXBbd2hpY2hfcGxhbmVdOworfQorCitk
b3VibGUgZ2V0X3RvdGFsX2ltbWVkaWF0ZV9mbGlwX2J5dGVzKAorCQlzdHJ1Y3QgZGlzcGxheV9t
b2RlX2xpYiAqbW9kZV9saWIsCisJCWNvbnN0IGRpc3BsYXlfZTJlX3BpcGVfcGFyYW1zX3N0ICpw
aXBlcywKKwkJdW5zaWduZWQgaW50IG51bV9waXBlcykKK3sKKwlyZWNhbGN1bGF0ZV9wYXJhbXMo
bW9kZV9saWIsIHBpcGVzLCBudW1fcGlwZXMpOworCXJldHVybiBtb2RlX2xpYi0+dmJhLlRvdElt
bWVkaWF0ZUZsaXBCeXRlczsKK30KKworZG91YmxlIGdldF90b3RhbF9pbW1lZGlhdGVfZmxpcF9i
dygKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQljb25zdCBkaXNwbGF5
X2UyZV9waXBlX3BhcmFtc19zdCAqcGlwZXMsCisJCXVuc2lnbmVkIGludCBudW1fcGlwZXMpCit7
CisJdW5zaWduZWQgaW50IGs7CisJZG91YmxlIGltbWVkaWF0ZV9mbGlwX2J3ID0gMC4wOworCXJl
Y2FsY3VsYXRlX3BhcmFtcyhtb2RlX2xpYiwgcGlwZXMsIG51bV9waXBlcyk7CisJZm9yIChrID0g
MDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykKKwkJaW1tZWRp
YXRlX2ZsaXBfYncgKz0gbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwQldba107CisJcmV0dXJu
IGltbWVkaWF0ZV9mbGlwX2J3OworfQorCitkb3VibGUgZ2V0X3RvdGFsX3ByZWZldGNoX2J3KAor
CQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWNvbnN0IGRpc3BsYXlfZTJl
X3BpcGVfcGFyYW1zX3N0ICpwaXBlcywKKwkJdW5zaWduZWQgaW50IG51bV9waXBlcykKK3sKKwl1
bnNpZ25lZCBpbnQgazsKKwlkb3VibGUgdG90YWxfcHJlZmV0Y2hfYncgPSAwLjA7CisKKwlyZWNh
bGN1bGF0ZV9wYXJhbXMobW9kZV9saWIsIHBpcGVzLCBudW1fcGlwZXMpOworCWZvciAoayA9IDA7
IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spCisJCXRvdGFsX3By
ZWZldGNoX2J3ICs9IG1vZGVfbGliLT52YmEuUHJlZmV0Y2hCYW5kd2lkdGhba107CisJcmV0dXJu
IHRvdGFsX3ByZWZldGNoX2J3OworfQorCitzdGF0aWMgdm9pZCBmZXRjaF9zb2NiYl9wYXJhbXMo
c3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliKQoreworCXNvY19ib3VuZGluZ19ib3hf
c3QgKnNvYyA9ICZtb2RlX2xpYi0+dmJhLnNvYzsKKwlpbnQgaTsKKworCS8vIFNPQyBCb3VuZGlu
ZyBCb3ggUGFyYW1ldGVycworCW1vZGVfbGliLT52YmEuUmV0dXJuQnVzV2lkdGggPSBzb2MtPnJl
dHVybl9idXNfd2lkdGhfYnl0ZXM7CisJbW9kZV9saWItPnZiYS5OdW1iZXJPZkNoYW5uZWxzID0g
c29jLT5udW1fY2hhbnM7CisJbW9kZV9saWItPnZiYS5QZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNB
bmRTRFBQb3J0QldSZWNlaXZlZEFmdGVyVXJnTGF0ZW5jeVBpeGVsRGF0YU9ubHkgPQorCQkJc29j
LT5wY3RfaWRlYWxfZHJhbV9zZHBfYndfYWZ0ZXJfdXJnZW50X3BpeGVsX29ubHk7IC8vIHRoZXJl
J3MgYWx3YXlzIHRoYXQgb25lIGJhc3RhcmQgdmFyaWFibGUgdGhhdCdzIHNvIGxvbmcgaXQgdGhy
b3dzIGV2ZXJ5dGhpbmcgb3V0IG9mIGFsaWdubWVudCEKKwltb2RlX2xpYi0+dmJhLlBlcmNlbnRP
ZklkZWFsRFJBTUZhYnJpY0FuZFNEUFBvcnRCV1JlY2VpdmVkQWZ0ZXJVcmdMYXRlbmN5UGl4ZWxN
aXhlZFdpdGhWTURhdGEgPQorCQkJc29jLT5wY3RfaWRlYWxfZHJhbV9zZHBfYndfYWZ0ZXJfdXJn
ZW50X3BpeGVsX2FuZF92bTsKKwltb2RlX2xpYi0+dmJhLlBlcmNlbnRPZklkZWFsRFJBTUZhYnJp
Y0FuZFNEUFBvcnRCV1JlY2VpdmVkQWZ0ZXJVcmdMYXRlbmN5Vk1EYXRhT25seSA9CisJCQlzb2Mt
PnBjdF9pZGVhbF9kcmFtX3NkcF9id19hZnRlcl91cmdlbnRfdm1fb25seTsKKwltb2RlX2xpYi0+
dmJhLk1heEF2ZXJhZ2VQZXJjZW50T2ZJZGVhbFNEUFBvcnRCV0Rpc3BsYXlDYW5Vc2VJbk5vcm1h
bFN5c3RlbU9wZXJhdGlvbiA9CisJCQlzb2MtPm1heF9hdmdfc2RwX2J3X3VzZV9ub3JtYWxfcGVy
Y2VudDsKKwltb2RlX2xpYi0+dmJhLk1heEF2ZXJhZ2VQZXJjZW50T2ZJZGVhbERSQU1CV0Rpc3Bs
YXlDYW5Vc2VJbk5vcm1hbFN5c3RlbU9wZXJhdGlvbiA9CisJCQlzb2MtPm1heF9hdmdfZHJhbV9i
d191c2Vfbm9ybWFsX3BlcmNlbnQ7CisJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5UGl4ZWxE
YXRhT25seSA9IHNvYy0+dXJnZW50X2xhdGVuY3lfcGl4ZWxfZGF0YV9vbmx5X3VzOworCW1vZGVf
bGliLT52YmEuVXJnZW50TGF0ZW5jeVBpeGVsTWl4ZWRXaXRoVk1EYXRhID0gc29jLT51cmdlbnRf
bGF0ZW5jeV9waXhlbF9taXhlZF93aXRoX3ZtX2RhdGFfdXM7CisJbW9kZV9saWItPnZiYS5Vcmdl
bnRMYXRlbmN5Vk1EYXRhT25seSA9IHNvYy0+dXJnZW50X2xhdGVuY3lfdm1fZGF0YV9vbmx5X3Vz
OworCW1vZGVfbGliLT52YmEuUm91bmRUcmlwUGluZ0xhdGVuY3lDeWNsZXMgPSBzb2MtPnJvdW5k
X3RyaXBfcGluZ19sYXRlbmN5X2RjZmNsa19jeWNsZXM7CisJbW9kZV9saWItPnZiYS5VcmdlbnRP
dXRPZk9yZGVyUmV0dXJuUGVyQ2hhbm5lbFBpeGVsRGF0YU9ubHkgPQorCQkJc29jLT51cmdlbnRf
b3V0X29mX29yZGVyX3JldHVybl9wZXJfY2hhbm5lbF9waXhlbF9vbmx5X2J5dGVzOworCW1vZGVf
bGliLT52YmEuVXJnZW50T3V0T2ZPcmRlclJldHVyblBlckNoYW5uZWxQaXhlbE1peGVkV2l0aFZN
RGF0YSA9CisJCQlzb2MtPnVyZ2VudF9vdXRfb2Zfb3JkZXJfcmV0dXJuX3Blcl9jaGFubmVsX3Bp
eGVsX2FuZF92bV9ieXRlczsKKwltb2RlX2xpYi0+dmJhLlVyZ2VudE91dE9mT3JkZXJSZXR1cm5Q
ZXJDaGFubmVsVk1EYXRhT25seSA9CisJCQlzb2MtPnVyZ2VudF9vdXRfb2Zfb3JkZXJfcmV0dXJu
X3Blcl9jaGFubmVsX3ZtX29ubHlfYnl0ZXM7CisJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMYXRl
bmN5ID0gc29jLT53cml0ZWJhY2tfbGF0ZW5jeV91czsKKwltb2RlX2xpYi0+dmJhLlNSRXhpdFRp
bWUgPSBzb2MtPnNyX2V4aXRfdGltZV91czsKKwltb2RlX2xpYi0+dmJhLlNSRW50ZXJQbHVzRXhp
dFRpbWUgPSBzb2MtPnNyX2VudGVyX3BsdXNfZXhpdF90aW1lX3VzOworCW1vZGVfbGliLT52YmEu
RFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeSA9IHNvYy0+ZHJhbV9jbG9ja19jaGFuZ2VfbGF0ZW5jeV91
czsKKwltb2RlX2xpYi0+dmJhLkRvd25zcHJlYWRpbmcgPSBzb2MtPmRvd25zcHJlYWRfcGVyY2Vu
dDsKKwltb2RlX2xpYi0+dmJhLkRSQU1DaGFubmVsV2lkdGggPSBzb2MtPmRyYW1fY2hhbm5lbF93
aWR0aF9ieXRlczsgICAvLyBuZXchCisJbW9kZV9saWItPnZiYS5GYWJyaWNEYXRhcGF0aFRvRENO
RGF0YVJldHVybiA9IHNvYy0+ZmFicmljX2RhdGFwYXRoX3RvX2Rjbl9kYXRhX3JldHVybl9ieXRl
czsgLy8gbmV3IQorCW1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRp
bmcgPSBzb2MtPmRjbl9kb3duc3ByZWFkX3BlcmNlbnQ7ICAgLy8gbmV3CisJbW9kZV9saWItPnZi
YS5ESVNQQ0xLRFBQQ0xLVkNPU3BlZWQgPSBzb2MtPmRpc3BjbGtfZHBwY2xrX3Zjb19zcGVlZF9t
aHo7ICAgLy8gbmV3CisJbW9kZV9saWItPnZiYS5WTU1QYWdlU2l6ZSA9IHNvYy0+dm1tX3BhZ2Vf
c2l6ZV9ieXRlczsKKwltb2RlX2xpYi0+dmJhLkdQVVZNTWluUGFnZVNpemUgPSBzb2MtPnZtbV9w
YWdlX3NpemVfYnl0ZXMgLyAxMDI0OworCW1vZGVfbGliLT52YmEuSG9zdFZNTWluUGFnZVNpemUg
PSBzb2MtPmhvc3R2bV9taW5fcGFnZV9zaXplX2J5dGVzIC8gMTAyNDsKKwkvLyBTZXQgdGhlIHZv
bHRhZ2Ugc2NhbGluZyBjbG9ja3MgYXMgdGhlIGRlZmF1bHRzLiBNb3N0IG9mIHRoZXNlIHdpbGwK
KwkvLyBiZSBzZXQgdG8gZGlmZmVyZW50IHZhbHVlcyBieSB0aGUgdGVzdAorCWZvciAoaSA9IDA7
IGkgPCBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzOyBpKyspCisJCWlmIChzb2MtPmNsb2Nr
X2xpbWl0c1tpXS5zdGF0ZSA9PSBtb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbCkKKwkJCWJyZWFr
OworCisJbW9kZV9saWItPnZiYS5EQ0ZDTEsgPSBzb2MtPmNsb2NrX2xpbWl0c1tpXS5kY2ZjbGtf
bWh6OworCW1vZGVfbGliLT52YmEuU09DQ0xLID0gc29jLT5jbG9ja19saW1pdHNbaV0uc29jY2xr
X21oejsKKwltb2RlX2xpYi0+dmJhLkRSQU1TcGVlZCA9IHNvYy0+Y2xvY2tfbGltaXRzW2ldLmRy
YW1fc3BlZWRfbXRzOworCW1vZGVfbGliLT52YmEuRmFicmljQ2xvY2sgPSBzb2MtPmNsb2NrX2xp
bWl0c1tpXS5mYWJyaWNjbGtfbWh6OworCisJbW9kZV9saWItPnZiYS5YRkNCdXNUcmFuc3BvcnRU
aW1lID0gc29jLT54ZmNfYnVzX3RyYW5zcG9ydF90aW1lX3VzOworCW1vZGVfbGliLT52YmEuWEZD
WEJVRkxhdGVuY3lUb2xlcmFuY2UgPSBzb2MtPnhmY194YnVmX2xhdGVuY3lfdG9sZXJhbmNlX3Vz
OworCW1vZGVfbGliLT52YmEuVXNlVXJnZW50QnVyc3RCYW5kd2lkdGggPSBzb2MtPnVzZV91cmdl
bnRfYnVyc3RfYnc7CisKKwltb2RlX2xpYi0+dmJhLlN1cHBvcnRHRlg3Q29tcGF0aWJsZVRpbGlu
Z0luMzJicHBBbmQ2NGJwcCA9IGZhbHNlOworCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYUFu
ZENocm9tYVNjYWxpbmdTdXBwb3J0ZWQgPSB0cnVlOworCW1vZGVfbGliLT52YmEuTWF4SFNDTFJh
dGlvID0gNDsKKwltb2RlX2xpYi0+dmJhLk1heFZTQ0xSYXRpbyA9IDQ7CisJbW9kZV9saWItPnZi
YS5DdXJzb3I2NEJwcFN1cHBvcnQgPSB0cnVlOworCWZvciAoaSA9IDA7IGkgPD0gbW9kZV9saWIt
PnZiYS5zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJCW1vZGVfbGliLT52YmEuRENGQ0xLUGVyU3Rh
dGVbaV0gPSBzb2MtPmNsb2NrX2xpbWl0c1tpXS5kY2ZjbGtfbWh6OworCQltb2RlX2xpYi0+dmJh
LkZhYnJpY0Nsb2NrUGVyU3RhdGVbaV0gPSBzb2MtPmNsb2NrX2xpbWl0c1tpXS5mYWJyaWNjbGtf
bWh6OworCQltb2RlX2xpYi0+dmJhLlNPQ0NMS1BlclN0YXRlW2ldID0gc29jLT5jbG9ja19saW1p
dHNbaV0uc29jY2xrX21oejsKKwkJbW9kZV9saWItPnZiYS5QSFlDTEtQZXJTdGF0ZVtpXSA9IHNv
Yy0+Y2xvY2tfbGltaXRzW2ldLnBoeWNsa19taHo7CisJCW1vZGVfbGliLT52YmEuUEhZQ0xLRDE4
UGVyU3RhdGVbaV0gPSBzb2MtPmNsb2NrX2xpbWl0c1tpXS5waHljbGtfZDE4X21oejsKKwkJbW9k
ZV9saWItPnZiYS5NYXhEcHBjbGtbaV0gPSBzb2MtPmNsb2NrX2xpbWl0c1tpXS5kcHBjbGtfbWh6
OworCQltb2RlX2xpYi0+dmJhLk1heERTQ0NMS1tpXSA9IHNvYy0+Y2xvY2tfbGltaXRzW2ldLmRz
Y2Nsa19taHo7CisJCW1vZGVfbGliLT52YmEuRFJBTVNwZWVkUGVyU3RhdGVbaV0gPSBzb2MtPmNs
b2NrX2xpbWl0c1tpXS5kcmFtX3NwZWVkX210czsKKwkJLy9tb2RlX2xpYi0+dmJhLkRSQU1TcGVl
ZFBlclN0YXRlW2ldID0gc29jLT5jbG9ja19saW1pdHNbaV0uZHJhbV9zcGVlZF9taHo7CisJCW1v
ZGVfbGliLT52YmEuTWF4RGlzcGNsa1tpXSA9IHNvYy0+Y2xvY2tfbGltaXRzW2ldLmRpc3BjbGtf
bWh6OworCX0KK30KKworc3RhdGljIHZvaWQgZmV0Y2hfaXBfcGFyYW1zKHN0cnVjdCBkaXNwbGF5
X21vZGVfbGliICptb2RlX2xpYikKK3sKKwlpcF9wYXJhbXNfc3QgKmlwID0gJm1vZGVfbGliLT52
YmEuaXA7CisKKwkvLyBJUCBQYXJhbWV0ZXJzCisJbW9kZV9saWItPnZiYS5NYXhOdW1EUFAgPSBp
cC0+bWF4X251bV9kcHA7CisJbW9kZV9saWItPnZiYS5NYXhOdW1PVEcgPSBpcC0+bWF4X251bV9v
dGc7CisJbW9kZV9saWItPnZiYS5NYXhOdW1IRE1JRlJMT3V0cHV0cyA9IGlwLT5tYXhfbnVtX2hk
bWlfZnJsX291dHB1dHM7CisJbW9kZV9saWItPnZiYS5NYXhOdW1Xcml0ZWJhY2sgPSBpcC0+bWF4
X251bV93YjsKKwltb2RlX2xpYi0+dmJhLkN1cnNvckNodW5rU2l6ZSA9IGlwLT5jdXJzb3JfY2h1
bmtfc2l6ZTsKKwltb2RlX2xpYi0+dmJhLkN1cnNvckJ1ZmZlclNpemUgPSBpcC0+Y3Vyc29yX2J1
ZmZlcl9zaXplOworCisJbW9kZV9saWItPnZiYS5NYXhEQ0hVQlRvUFNDTFRocm91Z2hwdXQgPSBp
cC0+bWF4X2RjaHViX3BzY2xfYndfcGl4X3Blcl9jbGs7CisJbW9kZV9saWItPnZiYS5NYXhQU0NM
VG9MQlRocm91Z2hwdXQgPSBpcC0+bWF4X3BzY2xfbGJfYndfcGl4X3Blcl9jbGs7CisJbW9kZV9s
aWItPnZiYS5ST0JCdWZmZXJTaXplSW5LQnl0ZSA9IGlwLT5yb2JfYnVmZmVyX3NpemVfa2J5dGVz
OworCW1vZGVfbGliLT52YmEuREVUQnVmZmVyU2l6ZUluS0J5dGUgPSBpcC0+ZGV0X2J1ZmZlcl9z
aXplX2tieXRlczsKKwltb2RlX2xpYi0+dmJhLlBpeGVsQ2h1bmtTaXplSW5LQnl0ZSA9IGlwLT5w
aXhlbF9jaHVua19zaXplX2tieXRlczsKKwltb2RlX2xpYi0+dmJhLk1ldGFDaHVua1NpemUgPSBp
cC0+bWV0YV9jaHVua19zaXplX2tieXRlczsKKwltb2RlX2xpYi0+dmJhLldyaXRlYmFja0NodW5r
U2l6ZSA9IGlwLT53cml0ZWJhY2tfY2h1bmtfc2l6ZV9rYnl0ZXM7CisJbW9kZV9saWItPnZiYS5M
aW5lQnVmZmVyU2l6ZSA9IGlwLT5saW5lX2J1ZmZlcl9zaXplX2JpdHM7CisJbW9kZV9saWItPnZi
YS5NYXhMaW5lQnVmZmVyTGluZXMgPSBpcC0+bWF4X2xpbmVfYnVmZmVyX2xpbmVzOworCW1vZGVf
bGliLT52YmEuUFRFQnVmZmVyU2l6ZUluUmVxdWVzdHNMdW1hID0gaXAtPmRwdGVfYnVmZmVyX3Np
emVfaW5fcHRlX3JlcXNfbHVtYTsKKwltb2RlX2xpYi0+dmJhLlBURUJ1ZmZlclNpemVJblJlcXVl
c3RzQ2hyb21hID0gaXAtPmRwdGVfYnVmZmVyX3NpemVfaW5fcHRlX3JlcXNfY2hyb21hOworCW1v
ZGVfbGliLT52YmEuRFBQT3V0cHV0QnVmZmVyUGl4ZWxzID0gaXAtPmRwcF9vdXRwdXRfYnVmZmVy
X3BpeGVsczsKKwltb2RlX2xpYi0+dmJhLk9QUE91dHB1dEJ1ZmZlckxpbmVzID0gaXAtPm9wcF9v
dXRwdXRfYnVmZmVyX2xpbmVzOworCW1vZGVfbGliLT52YmEuTWF4SFNDTFJhdGlvID0gaXAtPm1h
eF9oc2NsX3JhdGlvOworCW1vZGVfbGliLT52YmEuTWF4VlNDTFJhdGlvID0gaXAtPm1heF92c2Ns
X3JhdGlvOworCW1vZGVfbGliLT52YmEuV3JpdGViYWNrSW50ZXJmYWNlTHVtYUJ1ZmZlclNpemUg
PSBpcC0+d3JpdGViYWNrX2x1bWFfYnVmZmVyX3NpemVfa2J5dGVzICogMTAyNDsKKwltb2RlX2xp
Yi0+dmJhLldyaXRlYmFja0ludGVyZmFjZUNocm9tYUJ1ZmZlclNpemUgPSBpcC0+d3JpdGViYWNr
X2Nocm9tYV9idWZmZXJfc2l6ZV9rYnl0ZXMgKiAxMDI0OworCisJbW9kZV9saWItPnZiYS5Xcml0
ZWJhY2tJbnRlcmZhY2VCdWZmZXJTaXplID0gaXAtPndyaXRlYmFja19pbnRlcmZhY2VfYnVmZmVy
X3NpemVfa2J5dGVzOworCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTGluZUJ1ZmZlclNpemUgPSBp
cC0+d3JpdGViYWNrX2xpbmVfYnVmZmVyX2J1ZmZlcl9zaXplOworCW1vZGVfbGliLT52YmEuV3Jp
dGViYWNrU3VwcG9ydEludGVybGVhdmVBbmRVc2luZ1dob2xlQnVmZmVyRm9yQVNpbmdsZVN0cmVh
bSA9IGZhbHNlOworCW1vZGVfbGliLT52YmEuTWluVm9sdGFnZUxldmVsID0gMDsKKwltb2RlX2xp
Yi0+dmJhLk1heFZvbHRhZ2VMZXZlbCA9IDU7CisKKwltb2RlX2xpYi0+dmJhLldyaXRlYmFja0No
cm9tYUxpbmVCdWZmZXJXaWR0aCA9CisJCQlpcC0+d3JpdGViYWNrX2Nocm9tYV9saW5lX2J1ZmZl
cl93aWR0aF9waXhlbHM7CisJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMaW5lQnVmZmVyTHVtYUJ1
ZmZlclNpemUgPQorCQkJaXAtPndyaXRlYmFja19saW5lX2J1ZmZlcl9sdW1hX2J1ZmZlcl9zaXpl
OworCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTGluZUJ1ZmZlckNocm9tYUJ1ZmZlclNpemUgPQor
CQkJaXAtPndyaXRlYmFja19saW5lX2J1ZmZlcl9jaHJvbWFfYnVmZmVyX3NpemU7CisJbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2sxMGJwYzQyMFN1cHBvcnRlZCA9IGlwLT53cml0ZWJhY2tfMTBicGM0
MjBfc3VwcG9ydGVkOworCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTWF4SFNDTFJhdGlvID0gaXAt
PndyaXRlYmFja19tYXhfaHNjbF9yYXRpbzsKKwltb2RlX2xpYi0+dmJhLldyaXRlYmFja01heFZT
Q0xSYXRpbyA9IGlwLT53cml0ZWJhY2tfbWF4X3ZzY2xfcmF0aW87CisJbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tNaW5IU0NMUmF0aW8gPSBpcC0+d3JpdGViYWNrX21pbl9oc2NsX3JhdGlvOworCW1v
ZGVfbGliLT52YmEuV3JpdGViYWNrTWluVlNDTFJhdGlvID0gaXAtPndyaXRlYmFja19taW5fdnNj
bF9yYXRpbzsKKwltb2RlX2xpYi0+dmJhLldyaXRlYmFja01heEhTQ0xUYXBzID0gaXAtPndyaXRl
YmFja19tYXhfaHNjbF90YXBzOworCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTWF4VlNDTFRhcHMg
PSBpcC0+d3JpdGViYWNrX21heF92c2NsX3RhcHM7CisJbW9kZV9saWItPnZiYS5HUFVWTU1heFBh
Z2VUYWJsZUxldmVscyA9IGlwLT5ncHV2bV9tYXhfcGFnZV90YWJsZV9sZXZlbHM7CisJbW9kZV9s
aWItPnZiYS5Ib3N0Vk1NYXhOb25DYWNoZWRQYWdlVGFibGVMZXZlbHMgPSBpcC0+aG9zdHZtX21h
eF9wYWdlX3RhYmxlX2xldmVsczsKKwltb2RlX2xpYi0+dmJhLkhvc3RWTU1heFBhZ2VUYWJsZUxl
dmVscyA9IGlwLT5ob3N0dm1fbWF4X3BhZ2VfdGFibGVfbGV2ZWxzOworCW1vZGVfbGliLT52YmEu
SG9zdFZNQ2FjaGVkUGFnZVRhYmxlTGV2ZWxzID0gaXAtPmhvc3R2bV9jYWNoZWRfcGFnZV90YWJs
ZV9sZXZlbHM7CisJbW9kZV9saWItPnZiYS5NYXhJbnRlckRDTlRpbGVSZXBlYXRlcnMgPSBpcC0+
bWF4X2ludGVyX2Rjbl90aWxlX3JlcGVhdGVyczsKKwltb2RlX2xpYi0+dmJhLk51bWJlck9mRFND
ID0gaXAtPm51bV9kc2M7CisJbW9kZV9saWItPnZiYS5PRE1DYXBhYmlsaXR5ID0gaXAtPm9kbV9j
YXBhYmxlOworCW1vZGVfbGliLT52YmEuRElTUENMS1JhbXBpbmdNYXJnaW4gPSBpcC0+ZGlzcGNs
a19yYW1wX21hcmdpbl9wZXJjZW50OworCisJbW9kZV9saWItPnZiYS5YRkNTdXBwb3J0ZWQgPSBp
cC0+eGZjX3N1cHBvcnRlZDsKKwltb2RlX2xpYi0+dmJhLlhGQ0ZpbGxCV092ZXJoZWFkID0gaXAt
PnhmY19maWxsX2J3X292ZXJoZWFkX3BlcmNlbnQ7CisJbW9kZV9saWItPnZiYS5YRkNGaWxsQ29u
c3RhbnQgPSBpcC0+eGZjX2ZpbGxfY29uc3RhbnRfYnl0ZXM7CisJbW9kZV9saWItPnZiYS5EUFBD
TEtEZWxheVN1YnRvdGFsID0gaXAtPmRwcGNsa19kZWxheV9zdWJ0b3RhbDsKKwltb2RlX2xpYi0+
dmJhLkRQUENMS0RlbGF5U0NMID0gaXAtPmRwcGNsa19kZWxheV9zY2w7CisJbW9kZV9saWItPnZi
YS5EUFBDTEtEZWxheVNDTExCT25seSA9IGlwLT5kcHBjbGtfZGVsYXlfc2NsX2xiX29ubHk7CisJ
bW9kZV9saWItPnZiYS5EUFBDTEtEZWxheUNOVkNGb3JtYXRlciA9IGlwLT5kcHBjbGtfZGVsYXlf
Y252Y19mb3JtYXR0ZXI7CisJbW9kZV9saWItPnZiYS5EUFBDTEtEZWxheUNOVkNDdXJzb3IgPSBp
cC0+ZHBwY2xrX2RlbGF5X2NudmNfY3Vyc29yOworCW1vZGVfbGliLT52YmEuRElTUENMS0RlbGF5
U3VidG90YWwgPSBpcC0+ZGlzcGNsa19kZWxheV9zdWJ0b3RhbDsKKwltb2RlX2xpYi0+dmJhLkR5
bmFtaWNNZXRhZGF0YVZNRW5hYmxlZCA9IGlwLT5keW5hbWljX21ldGFkYXRhX3ZtX2VuYWJsZWQ7
CisJbW9kZV9saWItPnZiYS5PRE1Db21iaW5lNFRvMVN1cHBvcnRlZCA9IGlwLT5vZG1fY29tYmlu
ZV80dG8xX3N1cHBvcnRlZDsKKwltb2RlX2xpYi0+dmJhLlByb2dyZXNzaXZlVG9JbnRlcmxhY2VV
bml0SW5PUFAgPSBpcC0+cHRvaV9zdXBwb3J0ZWQ7CisJbW9kZV9saWItPnZiYS5QREVQcm9jZXNz
aW5nQnVmSW42NEtCUmVxcyA9IGlwLT5wZGVfcHJvY19idWZmZXJfc2l6ZV82NGtfcmVxczsKKwlt
b2RlX2xpYi0+dmJhLlBURUdyb3VwU2l6ZSA9IGlwLT5wdGVfZ3JvdXBfc2l6ZV9ieXRlczsKKwlt
b2RlX2xpYi0+dmJhLlN1cHBvcnRHRlg3Q29tcGF0aWJsZVRpbGluZ0luMzJicHBBbmQ2NGJwcCA9
IGlwLT5nZng3X2NvbXBhdF90aWxpbmdfc3VwcG9ydGVkOworfQorCitzdGF0aWMgdm9pZCBmZXRj
aF9waXBlX3BhcmFtcyhzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIpCit7CisJZGlz
cGxheV9lMmVfcGlwZV9wYXJhbXNfc3QgKnBpcGVzID0gbW9kZV9saWItPnZiYS5jYWNoZV9waXBl
czsKKwlpcF9wYXJhbXNfc3QgKmlwID0gJm1vZGVfbGliLT52YmEuaXA7CisKKwl1bnNpZ25lZCBp
bnQgT1RHSW5zdFBsYW5lW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBqLCBrOwor
CWJvb2wgUGxhbmVWaXNpdGVkW0RDX19OVU1fRFBQX19NQVhdOworCWJvb2wgdmlzaXRlZFtEQ19f
TlVNX0RQUF9fTUFYXTsKKworCS8vIENvbnZlcnQgUGlwZXMgdG8gUGxhbmVzCisJZm9yIChrID0g
MDsgayA8IG1vZGVfbGliLT52YmEuY2FjaGVfbnVtX3BpcGVzOyArK2spCisJCXZpc2l0ZWRba10g
PSBmYWxzZTsKKworCW1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgPSAwOworCWZv
ciAoaiA9IDA7IGogPCBtb2RlX2xpYi0+dmJhLmNhY2hlX251bV9waXBlczsgKytqKSB7CisJCWRp
c3BsYXlfcGlwZV9zb3VyY2VfcGFyYW1zX3N0ICpzcmMgPSAmcGlwZXNbal0ucGlwZS5zcmM7CisJ
CWRpc3BsYXlfcGlwZV9kZXN0X3BhcmFtc19zdCAqZHN0ID0gJnBpcGVzW2pdLnBpcGUuZGVzdDsK
KwkJc2NhbGVyX3JhdGlvX2RlcHRoX3N0ICpzY2wgPSAmcGlwZXNbal0ucGlwZS5zY2FsZV9yYXRp
b19kZXB0aDsKKwkJc2NhbGVyX3RhcHNfc3QgKnRhcHMgPSAmcGlwZXNbal0ucGlwZS5zY2FsZV90
YXBzOworCQlkaXNwbGF5X291dHB1dF9wYXJhbXNfc3QgKmRvdXQgPSAmcGlwZXNbal0uZG91dDsK
KwkJZGlzcGxheV9jbG9ja3NfYW5kX2NmZ19zdCAqY2xrcyA9ICZwaXBlc1tqXS5jbGtzX2NmZzsK
KworCQlpZiAodmlzaXRlZFtqXSkKKwkJCWNvbnRpbnVlOworCQl2aXNpdGVkW2pdID0gdHJ1ZTsK
KworCQltb2RlX2xpYi0+dmJhLnBpcGVfcGxhbmVbal0gPSBtb2RlX2xpYi0+dmJhLk51bWJlck9m
QWN0aXZlUGxhbmVzOworCisJCW1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVbbW9kZV9saWItPnZi
YS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPSAxOworCQltb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5b
bW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPQorCQkJCShlbnVtIHNjYW5fZGly
ZWN0aW9uX2NsYXNzKSAoc3JjLT5zb3VyY2Vfc2Nhbik7CisJCW1vZGVfbGliLT52YmEuVmlld3Bv
cnRXaWR0aFttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9CisJCQkJc3JjLT52
aWV3cG9ydF93aWR0aDsKKwkJbW9kZV9saWItPnZiYS5WaWV3cG9ydFdpZHRoQ2hyb21hW21vZGVf
bGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0KKwkJCQlzcmMtPnZpZXdwb3J0X3dpZHRo
X2M7CisJCW1vZGVfbGliLT52YmEuVmlld3BvcnRIZWlnaHRbbW9kZV9saWItPnZiYS5OdW1iZXJP
ZkFjdGl2ZVBsYW5lc10gPQorCQkJCXNyYy0+dmlld3BvcnRfaGVpZ2h0OworCQltb2RlX2xpYi0+
dmJhLlZpZXdwb3J0SGVpZ2h0Q2hyb21hW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFu
ZXNdID0KKwkJCQlzcmMtPnZpZXdwb3J0X2hlaWdodF9jOworCQltb2RlX2xpYi0+dmJhLlZpZXdw
b3J0WVN0YXJ0WVttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9CisJCQkJc3Jj
LT52aWV3cG9ydF95X3k7CisJCW1vZGVfbGliLT52YmEuVmlld3BvcnRZU3RhcnRDW21vZGVfbGli
LT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0KKwkJCQlzcmMtPnZpZXdwb3J0X3lfYzsKKwkJ
bW9kZV9saWItPnZiYS5QaXRjaFlbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10g
PSBzcmMtPmRhdGFfcGl0Y2g7CisJCW1vZGVfbGliLT52YmEuU3VyZmFjZUhlaWdodFlbbW9kZV9s
aWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPSBzcmMtPnZpZXdwb3J0X2hlaWdodDsKKwkJ
bW9kZV9saWItPnZiYS5QaXRjaENbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10g
PSBzcmMtPmRhdGFfcGl0Y2hfYzsKKwkJbW9kZV9saWItPnZiYS5TdXJmYWNlSGVpZ2h0Q1ttb2Rl
X2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9IHNyYy0+dmlld3BvcnRfaGVpZ2h0X2M7
CisJCW1vZGVfbGliLT52YmEuRENDTWV0YVBpdGNoWVttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0
aXZlUGxhbmVzXSA9IHNyYy0+bWV0YV9waXRjaDsKKwkJbW9kZV9saWItPnZiYS5EQ0NNZXRhUGl0
Y2hDW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0gc3JjLT5tZXRhX3BpdGNo
X2M7CisJCW1vZGVfbGliLT52YmEuSFJhdGlvW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXNdID0gc2NsLT5oc2NsX3JhdGlvOworCQltb2RlX2xpYi0+dmJhLkhSYXRpb0Nocm9tYVtt
b2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9IHNjbC0+aHNjbF9yYXRpb19jOwor
CQltb2RlX2xpYi0+dmJhLlZSYXRpb1ttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVz
XSA9IHNjbC0+dnNjbF9yYXRpbzsKKwkJbW9kZV9saWItPnZiYS5WUmF0aW9DaHJvbWFbbW9kZV9s
aWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPSBzY2wtPnZzY2xfcmF0aW9fYzsKKwkJbW9k
ZV9saWItPnZiYS5TY2FsZXJFbmFibGVkW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFu
ZXNdID0gc2NsLT5zY2xfZW5hYmxlOworCQltb2RlX2xpYi0+dmJhLkludGVybGFjZVttb2RlX2xp
Yi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9IGRzdC0+aW50ZXJsYWNlZDsKKwkJaWYgKGRz
dC0+aW50ZXJsYWNlZCAmJiAhaXAtPnB0b2lfc3VwcG9ydGVkKSB7CisJCQltb2RlX2xpYi0+dmJh
LlZSYXRpb1ttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSAqPSAyLjA7CisJCQlt
b2RlX2xpYi0+dmJhLlZSYXRpb0Nocm9tYVttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxh
bmVzXSAqPSAyLjA7CisJCX0KKwkJbW9kZV9saWItPnZiYS5odGFwc1ttb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzXSA9IHRhcHMtPmh0YXBzOworCQltb2RlX2xpYi0+dmJhLnZ0YXBz
W21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0gdGFwcy0+dnRhcHM7CisJCW1v
ZGVfbGliLT52YmEuSFRBUHNDaHJvbWFbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5l
c10gPSB0YXBzLT5odGFwc19jOworCQltb2RlX2xpYi0+dmJhLlZUQVBzQ2hyb21hW21vZGVfbGli
LT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0gdGFwcy0+dnRhcHNfYzsKKwkJbW9kZV9saWIt
PnZiYS5IVG90YWxbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPSBkc3QtPmh0
b3RhbDsKKwkJbW9kZV9saWItPnZiYS5WVG90YWxbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2
ZVBsYW5lc10gPSBkc3QtPnZ0b3RhbDsKKwkJbW9kZV9saWItPnZiYS5EQ0NFbmFibGVbbW9kZV9s
aWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPQorCQkJCXNyYy0+ZGNjX3VzZV9nbG9iYWwg
PworCQkJCQkJaXAtPmRjY19zdXBwb3J0ZWQgOiBzcmMtPmRjYyAmJiBpcC0+ZGNjX3N1cHBvcnRl
ZDsKKwkJbW9kZV9saWItPnZiYS5EQ0NSYXRlW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXNdID0gc3JjLT5kY2NfcmF0ZTsKKwkJLyogVE9ETzogTmVlZHMgdG8gYmUgc2V0IGJhc2Vk
IG9uIHNyYy0+ZGNjX3JhdGVfbHVtYS9jaHJvbWEgKi8KKwkJbW9kZV9saWItPnZiYS5EQ0NSYXRl
THVtYVttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9IDA7CisJCW1vZGVfbGli
LT52YmEuRENDUmF0ZUNocm9tYVttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9
IDA7CisKKwkJbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFttb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzXSA9CisJCQkJKGVudW0gc291cmNlX2Zvcm1hdF9jbGFzcykgKHNy
Yy0+c291cmNlX2Zvcm1hdCk7CisJCW1vZGVfbGliLT52YmEuSEFjdGl2ZVttb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzXSA9IGRzdC0+aGFjdGl2ZTsKKwkJbW9kZV9saWItPnZiYS5W
QWN0aXZlW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0gZHN0LT52YWN0aXZl
OworCQltb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFj
dGl2ZVBsYW5lc10gPQorCQkJCShlbnVtIGRtX3N3aXp6bGVfbW9kZSkgKHNyYy0+c3dfbW9kZSk7
CisJCW1vZGVfbGliLT52YmEuU2NhbGVyUmVjb3V0V2lkdGhbbW9kZV9saWItPnZiYS5OdW1iZXJP
ZkFjdGl2ZVBsYW5lc10gPQorCQkJCWRzdC0+cmVjb3V0X3dpZHRoOyAvLyBUT0RPOiBvciBzaG91
bGQgdGhpcyBiZSBmdWxsX3JlY291dF93aWR0aD8/Py4uLm1heWJlIG9ubHkgd2hlbiBpbiBoc3Bs
aXQgbW9kZT8KKwkJbW9kZV9saWItPnZiYS5PRE1Db21iaW5lRW5hYmxlZFttb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzXSA9CisJCQkJZHN0LT5vZG1fY29tYmluZTsKKwkJbW9kZV9s
aWItPnZiYS5PdXRwdXRGb3JtYXRbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10g
PQorCQkJCShlbnVtIG91dHB1dF9mb3JtYXRfY2xhc3MpIChkb3V0LT5vdXRwdXRfZm9ybWF0KTsK
KwkJbW9kZV9saWItPnZiYS5PdXRwdXRbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5l
c10gPQorCQkJCShlbnVtIG91dHB1dF9lbmNvZGVyX2NsYXNzKSAoZG91dC0+b3V0cHV0X3R5cGUp
OworCQltb2RlX2xpYi0+dmJhLk91dHB1dEJwcFttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZl
UGxhbmVzXSA9IGRvdXQtPm91dHB1dF9icHA7CisJCW1vZGVfbGliLT52YmEuT3V0cHV0TGlua0RQ
TGFuZXNbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPQorCQkJCWRvdXQtPmRw
X2xhbmVzOworCQkvKiBUT0RPOiBOZWVkcyB0byBiZSBzZXQgYmFzZWQgb24gZG91dC0+YXVkaW8u
YXVkaW9fc2FtcGxlX3JhdGVfa2h6L3NhbXBsZV9sYXlvdXQgKi8KKwkJbW9kZV9saWItPnZiYS5B
dWRpb1NhbXBsZVJhdGVbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPQorCQkJ
NDQuMSAqIDEwMDA7CisJCW1vZGVfbGliLT52YmEuQXVkaW9TYW1wbGVMYXlvdXRbbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPQorCQkJMTsKKwkJbW9kZV9saWItPnZiYS5EUkFN
Q2xvY2tDaGFuZ2VMYXRlbmN5T3ZlcnJpZGUgPSAwLjA7CisKKwkJbW9kZV9saWItPnZiYS5EU0NF
bmFibGVkW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0gZG91dC0+ZHNjX2Vu
YWJsZTsKKwkJbW9kZV9saWItPnZiYS5OdW1iZXJPZkRTQ1NsaWNlc1ttb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzXSA9CisJCQkJZG91dC0+ZHNjX3NsaWNlczsKKwkJbW9kZV9saWIt
PnZiYS5EU0NJbnB1dEJpdFBlckNvbXBvbmVudFttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZl
UGxhbmVzXSA9CisJCQkJZG91dC0+b3V0cHV0X2JwYyA9PSAwID8gMTIgOiBkb3V0LT5vdXRwdXRf
YnBjOworCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVttb2RlX2xpYi0+dmJhLk51bWJl
ck9mQWN0aXZlUGxhbmVzXSA9IGRvdXQtPndiX2VuYWJsZTsKKwkJbW9kZV9saWItPnZiYS5BY3Rp
dmVXcml0ZWJhY2tzUGVyUGxhbmVbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10g
PQorCQkJCWRvdXQtPm51bV9hY3RpdmVfd2I7CisJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrU291
cmNlSGVpZ2h0W21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0KKwkJCQlkb3V0
LT53Yi53Yl9zcmNfaGVpZ2h0OworCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja1NvdXJjZVdpZHRo
W21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0KKwkJCQlkb3V0LT53Yi53Yl9z
cmNfd2lkdGg7CisJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFttb2Rl
X2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9CisJCQkJZG91dC0+d2Iud2JfZHN0X3dp
ZHRoOworCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uSGVpZ2h0W21vZGVfbGli
LT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0KKwkJCQlkb3V0LT53Yi53Yl9kc3RfaGVpZ2h0
OworCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja1BpeGVsRm9ybWF0W21vZGVfbGliLT52YmEuTnVt
YmVyT2ZBY3RpdmVQbGFuZXNdID0KKwkJCQkoZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNzKSAoZG91
dC0+d2Iud2JfcGl4ZWxfZm9ybWF0KTsKKwkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIVGFwc1tt
b2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9CisJCQkJZG91dC0+d2Iud2JfaHRh
cHNfbHVtYTsKKwkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWVGFwc1ttb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzXSA9CisJCQkJZG91dC0+d2Iud2JfdnRhcHNfbHVtYTsKKwkJbW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRhcHNbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2
ZVBsYW5lc10gPQorCQkJCWRvdXQtPndiLndiX2h0YXBzX2x1bWE7CisJCW1vZGVfbGliLT52YmEu
V3JpdGViYWNrTHVtYVZUYXBzW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0K
KwkJCQlkb3V0LT53Yi53Yl92dGFwc19sdW1hOworCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0No
cm9tYUhUYXBzW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0KKwkJCQlkb3V0
LT53Yi53Yl9odGFwc19jaHJvbWE7CisJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hVlRh
cHNbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPQorCQkJCWRvdXQtPndiLndi
X3Z0YXBzX2Nocm9tYTsKKwkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9bbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPQorCQkJCWRvdXQtPndiLndiX2hyYXRpbzsKKwkJ
bW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWUmF0aW9bbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2
ZVBsYW5lc10gPQorCQkJCWRvdXQtPndiLndiX3ZyYXRpbzsKKworCQltb2RlX2xpYi0+dmJhLkR5
bmFtaWNNZXRhZGF0YUVuYWJsZVttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9
CisJCQkJc3JjLT5keW5hbWljX21ldGFkYXRhX2VuYWJsZTsKKwkJbW9kZV9saWItPnZiYS5EeW5h
bWljTWV0YWRhdGFMaW5lc0JlZm9yZUFjdGl2ZVJlcXVpcmVkW21vZGVfbGliLT52YmEuTnVtYmVy
T2ZBY3RpdmVQbGFuZXNdID0KKwkJCQlzcmMtPmR5bmFtaWNfbWV0YWRhdGFfbGluZXNfYmVmb3Jl
X2FjdGl2ZTsKKwkJbW9kZV9saWItPnZiYS5EeW5hbWljTWV0YWRhdGFUcmFuc21pdHRlZEJ5dGVz
W21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0KKwkJCQlzcmMtPmR5bmFtaWNf
bWV0YWRhdGFfeG1pdF9ieXRlczsKKworCQltb2RlX2xpYi0+dmJhLlhGQ0VuYWJsZWRbbW9kZV9s
aWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPSBzcmMtPnhmY19lbmFibGUKKwkJCQkmJiBp
cC0+eGZjX3N1cHBvcnRlZDsKKwkJbW9kZV9saWItPnZiYS5YRkNTbHZDaHVua1NpemUgPSBzcmMt
PnhmY19wYXJhbXMueGZjX3Nsdl9jaHVua19zaXplX2J5dGVzOworCQltb2RlX2xpYi0+dmJhLlhG
Q1RTbHZWdXBkYXRlT2Zmc2V0ID0gc3JjLT54ZmNfcGFyYW1zLnhmY190c2x2X3Z1cGRhdGVfb2Zm
c2V0X3VzOworCQltb2RlX2xpYi0+dmJhLlhGQ1RTbHZWdXBkYXRlV2lkdGggPSBzcmMtPnhmY19w
YXJhbXMueGZjX3RzbHZfdnVwZGF0ZV93aWR0aF91czsKKwkJbW9kZV9saWItPnZiYS5YRkNUU2x2
VnJlYWR5T2Zmc2V0ID0gc3JjLT54ZmNfcGFyYW1zLnhmY190c2x2X3ZyZWFkeV9vZmZzZXRfdXM7
CisJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1ttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZl
UGxhbmVzXSA9IGRzdC0+cGl4ZWxfcmF0ZV9taHo7CisJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9j
a0JhY2tFbmRbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gPSBkc3QtPnBpeGVs
X3JhdGVfbWh6OworCQltb2RlX2xpYi0+dmJhLkRQUENMS1ttb2RlX2xpYi0+dmJhLk51bWJlck9m
QWN0aXZlUGxhbmVzXSA9IGNsa3MtPmRwcGNsa19taHo7CisJCWlmIChpcC0+aXNfbGluZV9idWZm
ZXJfYnBwX2ZpeGVkKQorCQkJbW9kZV9saWItPnZiYS5MQkJpdFBlclBpeGVsW21vZGVfbGliLT52
YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdID0KKwkJCQkJaXAtPmxpbmVfYnVmZmVyX2ZpeGVkX2Jw
cDsKKwkJZWxzZSB7CisJCQl1bnNpZ25lZCBpbnQgbGJfZGVwdGg7CisKKwkJCXN3aXRjaCAoc2Ns
LT5sYl9kZXB0aCkgeworCQkJY2FzZSBkbV9sYl82OgorCQkJCWxiX2RlcHRoID0gMTg7CisJCQkJ
YnJlYWs7CisJCQljYXNlIGRtX2xiXzg6CisJCQkJbGJfZGVwdGggPSAyNDsKKwkJCQlicmVhazsK
KwkJCWNhc2UgZG1fbGJfMTA6CisJCQkJbGJfZGVwdGggPSAzMDsKKwkJCQlicmVhazsKKwkJCWNh
c2UgZG1fbGJfMTI6CisJCQkJbGJfZGVwdGggPSAzNjsKKwkJCQlicmVhazsKKwkJCWNhc2UgZG1f
bGJfMTY6CisJCQkJbGJfZGVwdGggPSA0ODsKKwkJCQlicmVhazsKKwkJCWRlZmF1bHQ6CisJCQkJ
bGJfZGVwdGggPSAzNjsKKwkJCX0KKwkJCW1vZGVfbGliLT52YmEuTEJCaXRQZXJQaXhlbFttb2Rl
X2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSA9IGxiX2RlcHRoOworCQl9CisJCW1vZGVf
bGliLT52YmEuTnVtYmVyT2ZDdXJzb3JzW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFu
ZXNdID0gMDsKKwkJLy8gVGhlIERNTCBzcHJlYWRzaGVldCBhc3N1bWVzIHRoYXQgdGhlIHR3byBj
dXJzb3JzIHV0aWxpemUgdGhlIHNhbWUgYW1vdW50IG9mIGJhbmR3aWR0aC4gV2UnbGwKKwkJLy8g
Y2FsY3VsYXRlIHRoaW5ncyBhIGxpdHRsZSBtb3JlIGFjY3VyYXRlbHkKKwkJZm9yIChrID0gMDsg
ayA8IERDX19OVU1fQ1VSU09SX19NQVg7ICsraykgeworCQkJc3dpdGNoIChrKSB7CisJCQljYXNl
IDA6CisJCQkJbW9kZV9saWItPnZiYS5DdXJzb3JCUFBbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFj
dGl2ZVBsYW5lc11bMF0gPQorCQkJCQkJQ3Vyc29yQnBwRW51bVRvQml0cygKKwkJCQkJCQkJKGVu
dW0gY3Vyc29yX2JwcCkgKHNyYy0+Y3VyMF9icHApKTsKKwkJCQltb2RlX2xpYi0+dmJhLkN1cnNv
cldpZHRoW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdWzBdID0KKwkJCQkJCXNy
Yy0+Y3VyMF9zcmNfd2lkdGg7CisJCQkJaWYgKHNyYy0+Y3VyMF9zcmNfd2lkdGggPiAwKQorCQkJ
CQltb2RlX2xpYi0+dmJhLk51bWJlck9mQ3Vyc29yc1ttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0
aXZlUGxhbmVzXSsrOworCQkJCWJyZWFrOworCQkJY2FzZSAxOgorCQkJCW1vZGVfbGliLT52YmEu
Q3Vyc29yQlBQW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdWzFdID0KKwkJCQkJ
CUN1cnNvckJwcEVudW1Ub0JpdHMoCisJCQkJCQkJCShlbnVtIGN1cnNvcl9icHApIChzcmMtPmN1
cjFfYnBwKSk7CisJCQkJbW9kZV9saWItPnZiYS5DdXJzb3JXaWR0aFttb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzXVsxXSA9CisJCQkJCQlzcmMtPmN1cjFfc3JjX3dpZHRoOworCQkJ
CWlmIChzcmMtPmN1cjFfc3JjX3dpZHRoID4gMCkKKwkJCQkJbW9kZV9saWItPnZiYS5OdW1iZXJP
ZkN1cnNvcnNbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10rKzsKKwkJCQlicmVh
azsKKwkJCWRlZmF1bHQ6CisJCQkJZG1sX3ByaW50KAorCQkJCQkJIkVSUk9SOiBOdW1iZXIgb2Yg
Y3Vyc29ycyBzcGVjaWZpZWQgZXhjZWVkcyBzdXBwb3J0ZWQgbWF4aW11bVxuIikKKwkJCQk7CisJ
CQl9CisJCX0KKworCQlPVEdJbnN0UGxhbmVbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBs
YW5lc10gPSBkc3QtPm90Z19pbnN0OworCisJCWlmIChqID09IDApCisJCQltb2RlX2xpYi0+dmJh
LlVzZU1heGltdW1WU3RhcnR1cCA9IGRzdC0+dXNlX21heGltdW1fdnN0YXJ0dXA7CisJCWVsc2UK
KwkJCW1vZGVfbGliLT52YmEuVXNlTWF4aW11bVZTdGFydHVwID0gbW9kZV9saWItPnZiYS5Vc2VN
YXhpbXVtVlN0YXJ0dXAKKwkJCQkJCQkJCXx8IGRzdC0+dXNlX21heGltdW1fdnN0YXJ0dXA7CisK
KwkJaWYgKGRzdC0+b2RtX2NvbWJpbmUgJiYgIXNyYy0+aXNfaHNwbGl0KQorCQkJZG1sX3ByaW50
KAorCQkJCQkiRVJST1I6IE9ETSBDb21iaW5lIGlzIHNwZWNpZmllZCBidXQgaXNfaHNwbGl0IGhh
cyBub3QgYmUgc3BlY2lmaWVkIGZvciBwaXBlICVpXG4iLAorCQkJCQlqKTsKKworCQlpZiAoc3Jj
LT5pc19oc3BsaXQpIHsKKwkJCWZvciAoayA9IGogKyAxOyBrIDwgbW9kZV9saWItPnZiYS5jYWNo
ZV9udW1fcGlwZXM7ICsraykgeworCQkJCWRpc3BsYXlfcGlwZV9zb3VyY2VfcGFyYW1zX3N0ICpz
cmNfayA9ICZwaXBlc1trXS5waXBlLnNyYzsKKwkJCQlkaXNwbGF5X291dHB1dF9wYXJhbXNfc3Qg
KmRvdXRfayA9ICZwaXBlc1trXS5kb3V0OworCisJCQkJaWYgKHNyY19rLT5pc19oc3BsaXQgJiYg
IXZpc2l0ZWRba10KKwkJCQkJCSYmIHNyYy0+aHNwbGl0X2dycCA9PSBzcmNfay0+aHNwbGl0X2dy
cCkgeworCQkJCQltb2RlX2xpYi0+dmJhLnBpcGVfcGxhbmVba10gPQorCQkJCQkJCW1vZGVfbGli
LT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7CisJCQkJCW1vZGVfbGliLT52YmEuRFBQUGVyUGxh
bmVbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10rKzsKKwkJCQkJaWYgKG1vZGVf
bGliLT52YmEuU291cmNlU2Nhblttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXQor
CQkJCQkJCT09IGRtX2hvcnopCisJCQkJCQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0V2lkdGhbbW9k
ZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gKz0KKwkJCQkJCQkJc3JjX2stPnZpZXdw
b3J0X3dpZHRoOworCQkJCQllbHNlCisJCQkJCQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0SGVpZ2h0
W21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdICs9CisJCQkJCQkJCXNyY19rLT52
aWV3cG9ydF9oZWlnaHQ7CisKKwkJCQkJbW9kZV9saWItPnZiYS5OdW1iZXJPZkRTQ1NsaWNlc1tt
b2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSArPQorCQkJCQkJCWRvdXRfay0+ZHNj
X3NsaWNlczsKKwkJCQkJdmlzaXRlZFtrXSA9IHRydWU7CisJCQkJfQorCQkJfQorCQl9CisKKwkJ
aWYgKHBpcGVzW2tdLnBpcGUuc3JjLmltbWVkaWF0ZV9mbGlwKQorCQkJbW9kZV9saWItPnZiYS5J
bW1lZGlhdGVGbGlwU3VwcG9ydCA9IHRydWU7CisKKwkJbW9kZV9saWItPnZiYS5OdW1iZXJPZkFj
dGl2ZVBsYW5lcysrOworCX0KKworCS8vIGhhbmRsZSBvdmVybGF5cyB0aHJvdWdoIEJsZW5kaW5n
QW5kVGltaW5nCisJLy8gQmxlbmRpbmdBbmRUaW1pbmcgdGVsbHMgeW91IHdoaWNoIGluc3RhbmNl
IHRvIGxvb2sgYXQgdG8gZ2V0IHRpbWluZywgdGhlIHNvIGNhbGxlZCAnbWFzdGVyJworCisJZm9y
IChqID0gMDsgaiA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraikKKwkJ
UGxhbmVWaXNpdGVkW2pdID0gZmFsc2U7CisKKwlmb3IgKGogPSAwOyBqIDwgbW9kZV9saWItPnZi
YS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytqKSB7CisJCWZvciAoayA9IGogKyAxOyBrIDwgbW9k
ZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCQlpZiAoIVBsYW5lVmlz
aXRlZFtrXSAmJiBPVEdJbnN0UGxhbmVbal0gPT0gT1RHSW5zdFBsYW5lW2tdKSB7CisJCQkJLy8g
ZG9lc24ndCBtYXR0ZXIsIHNvIGNob29zZSB0aGUgc21hbGxlciBvbmUKKwkJCQltb2RlX2xpYi0+
dmJhLkJsZW5kaW5nQW5kVGltaW5nW2pdID0gajsKKwkJCQlQbGFuZVZpc2l0ZWRbal0gPSB0cnVl
OworCQkJCW1vZGVfbGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdba10gPSBqOworCQkJCVBsYW5l
VmlzaXRlZFtrXSA9IHRydWU7CisJCQl9CisJCX0KKworCQlpZiAoIVBsYW5lVmlzaXRlZFtqXSkg
eworCQkJbW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1tqXSA9IGo7CisJCQlQbGFuZVZp
c2l0ZWRbal0gPSB0cnVlOworCQl9CisJfQorCisJLy8gVE9ETzogT0RNQ29tYmluZUVuYWJsZWQg
PT4gMiAqIERQUFBlclBsYW5lLi4uYWN0dWFsbHkgbWF5YmUgbm90IHNpbmNlIGFsbCBwaXBlcyBh
cmUgc3BlY2lmaWVkCisJLy8gRG8gd2Ugd2FudCB0aGUgZHNjY2xrIHRvIGF1dG9tYXRpY2FsbHkg
YmUgaGFsdmVkPyBHdWVzcyBub3Qgc2luY2UgdGhlIHZhbHVlIGlzIHNwZWNpZmllZAorCisJbW9k
ZV9saWItPnZiYS5TeW5jaHJvbml6ZWRWQmxhbmsgPSBwaXBlc1swXS5waXBlLmRlc3Quc3luY2hy
b25pemVkX3ZibGFua19hbGxfcGxhbmVzOworCWZvciAoayA9IDE7IGsgPCBtb2RlX2xpYi0+dmJh
LmNhY2hlX251bV9waXBlczsgKytrKQorCQlBU1NFUlQobW9kZV9saWItPnZiYS5TeW5jaHJvbml6
ZWRWQmxhbmsgPT0gcGlwZXNba10ucGlwZS5kZXN0LnN5bmNocm9uaXplZF92YmxhbmtfYWxsX3Bs
YW5lcyk7CisKKwltb2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlID0gZmFsc2U7CisJbW9kZV9saWIt
PnZiYS5Ib3N0Vk1FbmFibGUgPSBmYWxzZTsKKwltb2RlX2xpYi0+dmJhLk92ZXJyaWRlR1BVVk1Q
YWdlVGFibGVMZXZlbHMgPSAwOworCW1vZGVfbGliLT52YmEuT3ZlcnJpZGVIb3N0Vk1QYWdlVGFi
bGVMZXZlbHMgPSAwOworCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuY2FjaGVfbnVt
X3BpcGVzOyArK2spIHsKKwkJbW9kZV9saWItPnZiYS5HUFVWTUVuYWJsZSA9IG1vZGVfbGliLT52
YmEuR1BVVk1FbmFibGUgfHwgISFwaXBlc1trXS5waXBlLnNyYy5ncHV2bSB8fCAhIXBpcGVzW2td
LnBpcGUuc3JjLnZtOworCQltb2RlX2xpYi0+dmJhLk92ZXJyaWRlR1BVVk1QYWdlVGFibGVMZXZl
bHMgPQorCQkJCShwaXBlc1trXS5waXBlLnNyYy5ncHV2bV9sZXZlbHNfZm9yY2VfZW4KKwkJCQkJ
CSYmIG1vZGVfbGliLT52YmEuT3ZlcnJpZGVHUFVWTVBhZ2VUYWJsZUxldmVscworCQkJCQkJCQk8
IHBpcGVzW2tdLnBpcGUuc3JjLmdwdXZtX2xldmVsc19mb3JjZSkgPworCQkJCQkJcGlwZXNba10u
cGlwZS5zcmMuZ3B1dm1fbGV2ZWxzX2ZvcmNlIDoKKwkJCQkJCW1vZGVfbGliLT52YmEuT3ZlcnJp
ZGVHUFVWTVBhZ2VUYWJsZUxldmVsczsKKworCQltb2RlX2xpYi0+dmJhLkhvc3RWTUVuYWJsZSA9
IG1vZGVfbGliLT52YmEuSG9zdFZNRW5hYmxlIHx8ICEhcGlwZXNba10ucGlwZS5zcmMuaG9zdHZt
IHx8ICEhcGlwZXNba10ucGlwZS5zcmMudm07CisJCW1vZGVfbGliLT52YmEuT3ZlcnJpZGVIb3N0
Vk1QYWdlVGFibGVMZXZlbHMgPQorCQkJCShwaXBlc1trXS5waXBlLnNyYy5ob3N0dm1fbGV2ZWxz
X2ZvcmNlX2VuCisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLk92ZXJyaWRlSG9zdFZNUGFnZVRhYmxl
TGV2ZWxzCisJCQkJCQkJCTwgcGlwZXNba10ucGlwZS5zcmMuaG9zdHZtX2xldmVsc19mb3JjZSkg
PworCQkJCQkJcGlwZXNba10ucGlwZS5zcmMuaG9zdHZtX2xldmVsc19mb3JjZSA6CisJCQkJCQlt
b2RlX2xpYi0+dmJhLk92ZXJyaWRlSG9zdFZNUGFnZVRhYmxlTGV2ZWxzOworCX0KKworCW1vZGVf
bGliLT52YmEuQWxsb3dEUkFNU2VsZlJlZnJlc2hPckRSQU1DbG9ja0NoYW5nZUluVmJsYW5rID0g
ZG1fdHJ5X3RvX2FsbG93X3NlbGZfcmVmcmVzaF9hbmRfbWNsa19zd2l0Y2g7CisKKwlpZiAobW9k
ZV9saWItPnZiYS5PdmVycmlkZUdQVVZNUGFnZVRhYmxlTGV2ZWxzKQorCQltb2RlX2xpYi0+dmJh
LkdQVVZNTWF4UGFnZVRhYmxlTGV2ZWxzID0gbW9kZV9saWItPnZiYS5PdmVycmlkZUdQVVZNUGFn
ZVRhYmxlTGV2ZWxzOworCisJaWYgKG1vZGVfbGliLT52YmEuT3ZlcnJpZGVIb3N0Vk1QYWdlVGFi
bGVMZXZlbHMpCisJCW1vZGVfbGliLT52YmEuSG9zdFZNTWF4UGFnZVRhYmxlTGV2ZWxzID0gbW9k
ZV9saWItPnZiYS5PdmVycmlkZUhvc3RWTVBhZ2VUYWJsZUxldmVsczsKKworCW1vZGVfbGliLT52
YmEuR1BVVk1FbmFibGUgPSBtb2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlICYmICEhaXAtPmdwdXZt
X2VuYWJsZTsKKwltb2RlX2xpYi0+dmJhLkhvc3RWTUVuYWJsZSA9IG1vZGVfbGliLT52YmEuSG9z
dFZNRW5hYmxlICYmICEhaXAtPmhvc3R2bV9lbmFibGU7Cit9CisKKy8vIGluIHdtIG1vZGUgd2Ug
cHVsbCB0aGUgcGFyYW1ldGVycyBuZWVkZWQgZnJvbSB0aGUgZGlzcGxheV9lMmVfcGlwZV9wYXJh
bXNfc3Qgc3RydWN0cworLy8gcmF0aGVyIHRoYW4gd29ya2luZyB0aGVtIG91dCBhcyBpbiByZWNh
bGN1bGF0ZV9tcworc3RhdGljIHZvaWQgcmVjYWxjdWxhdGVfcGFyYW1zKAorCQlzdHJ1Y3QgZGlz
cGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWNvbnN0IGRpc3BsYXlfZTJlX3BpcGVfcGFyYW1z
X3N0ICpwaXBlcywKKwkJdW5zaWduZWQgaW50IG51bV9waXBlcykKK3sKKwkvLyBUaGlzIGlzIG9u
bHkgc2FmZSB0byB1c2UgbWVtY21wIGJlY2F1c2UgdGhlcmUgYXJlIG5vbi1QT0QgdHlwZXMgaW4g
c3RydWN0IGRpc3BsYXlfbW9kZV9saWIKKwlpZiAobWVtY21wKCZtb2RlX2xpYi0+c29jLCAmbW9k
ZV9saWItPnZiYS5zb2MsIHNpemVvZihtb2RlX2xpYi0+dmJhLnNvYykpICE9IDAKKwkJCXx8IG1l
bWNtcCgmbW9kZV9saWItPmlwLCAmbW9kZV9saWItPnZiYS5pcCwgc2l6ZW9mKG1vZGVfbGliLT52
YmEuaXApKSAhPSAwCisJCQl8fCBudW1fcGlwZXMgIT0gbW9kZV9saWItPnZiYS5jYWNoZV9udW1f
cGlwZXMKKwkJCXx8IG1lbWNtcCgKKwkJCQkJcGlwZXMsCisJCQkJCW1vZGVfbGliLT52YmEuY2Fj
aGVfcGlwZXMsCisJCQkJCXNpemVvZihkaXNwbGF5X2UyZV9waXBlX3BhcmFtc19zdCkgKiBudW1f
cGlwZXMpICE9IDApIHsKKwkJbW9kZV9saWItPnZiYS5zb2MgPSBtb2RlX2xpYi0+c29jOworCQlt
b2RlX2xpYi0+dmJhLmlwID0gbW9kZV9saWItPmlwOworCQltZW1jcHkobW9kZV9saWItPnZiYS5j
YWNoZV9waXBlcywgcGlwZXMsIHNpemVvZigqcGlwZXMpICogbnVtX3BpcGVzKTsKKwkJbW9kZV9s
aWItPnZiYS5jYWNoZV9udW1fcGlwZXMgPSBudW1fcGlwZXM7CisJCW1vZGVfbGliLT5mdW5jcy5y
ZWNhbGN1bGF0ZShtb2RlX2xpYik7CisJfQorfQorCitib29sIENhbGN1bGF0ZTI1NkJCbG9ja1Np
emVzKAorCQllbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MgU291cmNlUGl4ZWxGb3JtYXQsCisJCWVu
dW0gZG1fc3dpenpsZV9tb2RlIFN1cmZhY2VUaWxpbmcsCisJCXVuc2lnbmVkIGludCBCeXRlUGVy
UGl4ZWxZLAorCQl1bnNpZ25lZCBpbnQgQnl0ZVBlclBpeGVsQywKKwkJdW5zaWduZWQgaW50ICpC
bG9ja0hlaWdodDI1NkJ5dGVzWSwKKwkJdW5zaWduZWQgaW50ICpCbG9ja0hlaWdodDI1NkJ5dGVz
QywKKwkJdW5zaWduZWQgaW50ICpCbG9ja1dpZHRoMjU2Qnl0ZXNZLAorCQl1bnNpZ25lZCBpbnQg
KkJsb2NrV2lkdGgyNTZCeXRlc0MpCit7CisJaWYgKChTb3VyY2VQaXhlbEZvcm1hdCA9PSBkbV80
NDRfNjQgfHwgU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDQ0XzMyCisJCQl8fCBTb3VyY2VQaXhl
bEZvcm1hdCA9PSBkbV80NDRfMTYgfHwgU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDQ0XzgpKSB7
CisJCWlmIChTdXJmYWNlVGlsaW5nID09IGRtX3N3X2xpbmVhcikgeworCQkJKkJsb2NrSGVpZ2h0
MjU2Qnl0ZXNZID0gMTsKKwkJfSBlbHNlIGlmIChTb3VyY2VQaXhlbEZvcm1hdCA9PSBkbV80NDRf
NjQpIHsKKwkJCSpCbG9ja0hlaWdodDI1NkJ5dGVzWSA9IDQ7CisJCX0gZWxzZSBpZiAoU291cmNl
UGl4ZWxGb3JtYXQgPT0gZG1fNDQ0XzgpIHsKKwkJCSpCbG9ja0hlaWdodDI1NkJ5dGVzWSA9IDE2
OworCQl9IGVsc2UgeworCQkJKkJsb2NrSGVpZ2h0MjU2Qnl0ZXNZID0gODsKKwkJfQorCQkqQmxv
Y2tXaWR0aDI1NkJ5dGVzWSA9IDI1NiAvIEJ5dGVQZXJQaXhlbFkgLyAqQmxvY2tIZWlnaHQyNTZC
eXRlc1k7CisJCSpCbG9ja0hlaWdodDI1NkJ5dGVzQyA9IDA7CisJCSpCbG9ja1dpZHRoMjU2Qnl0
ZXNDID0gMDsKKwl9IGVsc2UgeworCQlpZiAoU3VyZmFjZVRpbGluZyA9PSBkbV9zd19saW5lYXIp
IHsKKwkJCSpCbG9ja0hlaWdodDI1NkJ5dGVzWSA9IDE7CisJCQkqQmxvY2tIZWlnaHQyNTZCeXRl
c0MgPSAxOworCQl9IGVsc2UgaWYgKFNvdXJjZVBpeGVsRm9ybWF0ID09IGRtXzQyMF84KSB7CisJ
CQkqQmxvY2tIZWlnaHQyNTZCeXRlc1kgPSAxNjsKKwkJCSpCbG9ja0hlaWdodDI1NkJ5dGVzQyA9
IDg7CisJCX0gZWxzZSB7CisJCQkqQmxvY2tIZWlnaHQyNTZCeXRlc1kgPSA4OworCQkJKkJsb2Nr
SGVpZ2h0MjU2Qnl0ZXNDID0gODsKKwkJfQorCQkqQmxvY2tXaWR0aDI1NkJ5dGVzWSA9IDI1NiAv
IEJ5dGVQZXJQaXhlbFkgLyAqQmxvY2tIZWlnaHQyNTZCeXRlc1k7CisJCSpCbG9ja1dpZHRoMjU2
Qnl0ZXNDID0gMjU2IC8gQnl0ZVBlclBpeGVsQyAvICpCbG9ja0hlaWdodDI1NkJ5dGVzQzsKKwl9
CisJcmV0dXJuIHRydWU7Cit9CisKK2Jvb2wgQ2FsY3VsYXRlTWluQW5kTWF4UHJlZmV0Y2hNb2Rl
KAorCQllbnVtIHNlbGZfcmVmcmVzaF9hZmZpbml0eSBBbGxvd0RSQU1TZWxmUmVmcmVzaE9yRFJB
TUNsb2NrQ2hhbmdlSW5WYmxhbmssCisJCXVuc2lnbmVkIGludCAqTWluUHJlZmV0Y2hNb2RlLAor
CQl1bnNpZ25lZCBpbnQgKk1heFByZWZldGNoTW9kZSkKK3sKKwlpZiAoQWxsb3dEUkFNU2VsZlJl
ZnJlc2hPckRSQU1DbG9ja0NoYW5nZUluVmJsYW5rCisJCQk9PSBkbV9uZWl0aGVyX3NlbGZfcmVm
cmVzaF9ub3JfbWNsa19zd2l0Y2gpIHsKKwkJKk1pblByZWZldGNoTW9kZSA9IDI7CisJCSpNYXhQ
cmVmZXRjaE1vZGUgPSAyOworCQlyZXR1cm4gZmFsc2U7CisJfSBlbHNlIGlmIChBbGxvd0RSQU1T
ZWxmUmVmcmVzaE9yRFJBTUNsb2NrQ2hhbmdlSW5WYmxhbmsgPT0gZG1fYWxsb3dfc2VsZl9yZWZy
ZXNoKSB7CisJCSpNaW5QcmVmZXRjaE1vZGUgPSAxOworCQkqTWF4UHJlZmV0Y2hNb2RlID0gMTsK
KwkJcmV0dXJuIGZhbHNlOworCX0gZWxzZSBpZiAoQWxsb3dEUkFNU2VsZlJlZnJlc2hPckRSQU1D
bG9ja0NoYW5nZUluVmJsYW5rCisJCQk9PSBkbV9hbGxvd19zZWxmX3JlZnJlc2hfYW5kX21jbGtf
c3dpdGNoKSB7CisJCSpNaW5QcmVmZXRjaE1vZGUgPSAwOworCQkqTWF4UHJlZmV0Y2hNb2RlID0g
MDsKKwkJcmV0dXJuIGZhbHNlOworCX0gZWxzZSBpZiAoQWxsb3dEUkFNU2VsZlJlZnJlc2hPckRS
QU1DbG9ja0NoYW5nZUluVmJsYW5rCisJCQk9PSBkbV90cnlfdG9fYWxsb3dfc2VsZl9yZWZyZXNo
X2FuZF9tY2xrX3N3aXRjaCkgeworCQkqTWluUHJlZmV0Y2hNb2RlID0gMDsKKwkJKk1heFByZWZl
dGNoTW9kZSA9IDI7CisJCXJldHVybiBmYWxzZTsKKwl9CisJKk1pblByZWZldGNoTW9kZSA9IDA7
CisJKk1heFByZWZldGNoTW9kZSA9IDI7CisJcmV0dXJuIHRydWU7Cit9CisKK3ZvaWQgUGl4ZWxD
bG9ja0FkanVzdG1lbnRGb3JQcm9ncmVzc2l2ZVRvSW50ZXJsYWNlVW5pdChzdHJ1Y3QgZGlzcGxh
eV9tb2RlX2xpYiAqbW9kZV9saWIpCit7CisJdW5zaWduZWQgaW50IGs7CisKKwkvL1Byb2dyZXNz
aXZlIFRvIEludGVybGFjZSBVbml0IEVmZmVjdAorCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+
dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuSW50
ZXJsYWNlW2tdID09IDEKKwkJCQkmJiBtb2RlX2xpYi0+dmJhLlByb2dyZXNzaXZlVG9JbnRlcmxh
Y2VVbml0SW5PUFAgPT0gdHJ1ZSkgeworCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdID0g
MiAqIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja0JhY2tFbmRba107CisJCX0KKwl9Cit9CisKK3N0
YXRpYyB1bnNpZ25lZCBpbnQgQ3Vyc29yQnBwRW51bVRvQml0cyhlbnVtIGN1cnNvcl9icHAgZWJw
cCkKK3sKKwlzd2l0Y2ggKGVicHApIHsKKwljYXNlIGRtX2N1cl8yYml0OgorCQlyZXR1cm4gMjsK
KwljYXNlIGRtX2N1cl8zMmJpdDoKKwkJcmV0dXJuIDMyOworCWNhc2UgZG1fY3VyXzY0Yml0Ogor
CQlyZXR1cm4gNjQ7CisJZGVmYXVsdDoKKwkJcmV0dXJuIDA7CisJfQorfQorCit2b2lkIE1vZGVT
dXBwb3J0QW5kU3lzdGVtQ29uZmlndXJhdGlvbihzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9k
ZV9saWIpCit7CisJc29jX2JvdW5kaW5nX2JveF9zdCAqc29jID0gJm1vZGVfbGliLT52YmEuc29j
OworCXVuc2lnbmVkIGludCBrOworCXVuc2lnbmVkIGludCB0b3RhbF9waXBlcyA9IDA7CisKKwlt
b2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbCA9IG1vZGVfbGliLT52YmEuY2FjaGVfcGlwZXNbMF0u
Y2xrc19jZmcudm9sdGFnZTsKKwltb2RlX2xpYi0+dmJhLlJldHVybkJXID0gbW9kZV9saWItPnZi
YS5SZXR1cm5CV1BlclN0YXRlW21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXTsKKwltb2RlX2xp
Yi0+dmJhLkZhYnJpY0FuZERSQU1CYW5kd2lkdGggPSBtb2RlX2xpYi0+dmJhLkZhYnJpY0FuZERS
QU1CYW5kd2lkdGhQZXJTdGF0ZVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF07CisKKwlmZXRj
aF9zb2NiYl9wYXJhbXMobW9kZV9saWIpOworCWZldGNoX2lwX3BhcmFtcyhtb2RlX2xpYik7CisJ
ZmV0Y2hfcGlwZV9wYXJhbXMobW9kZV9saWIpOworCisJbW9kZV9saWItPnZiYS5EQ0ZDTEsgPSBt
b2RlX2xpYi0+dmJhLmNhY2hlX3BpcGVzWzBdLmNsa3NfY2ZnLmRjZmNsa19taHo7CisJbW9kZV9s
aWItPnZiYS5TT0NDTEsgPSBtb2RlX2xpYi0+dmJhLmNhY2hlX3BpcGVzWzBdLmNsa3NfY2ZnLnNv
Y2Nsa19taHo7CisJaWYgKG1vZGVfbGliLT52YmEuY2FjaGVfcGlwZXNbMF0uY2xrc19jZmcuZGlz
cGNsa19taHogPiAwLjApCisJCW1vZGVfbGliLT52YmEuRElTUENMSyA9IG1vZGVfbGliLT52YmEu
Y2FjaGVfcGlwZXNbMF0uY2xrc19jZmcuZGlzcGNsa19taHo7CisJZWxzZQorCQltb2RlX2xpYi0+
dmJhLkRJU1BDTEsgPSBzb2MtPmNsb2NrX2xpbWl0c1ttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZl
bF0uZGlzcGNsa19taHo7CisKKwkvLyBUb3RhbCBBdmFpbGFibGUgUGlwZXMgU3VwcG9ydCBDaGVj
aworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyAr
K2spCisJCXRvdGFsX3BpcGVzICs9IG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba107CisJQVNT
RVJUKHRvdGFsX3BpcGVzIDw9IERDX19OVU1fRFBQX19NQVgpOworfQorCitkb3VibGUgQ2FsY3Vs
YXRlV3JpdGVCYWNrRElTUENMSygKKwkJZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNzIFdyaXRlYmFj
a1BpeGVsRm9ybWF0LAorCQlkb3VibGUgUGl4ZWxDbG9jaywKKwkJZG91YmxlIFdyaXRlYmFja0hS
YXRpbywKKwkJZG91YmxlIFdyaXRlYmFja1ZSYXRpbywKKwkJdW5zaWduZWQgaW50IFdyaXRlYmFj
a0x1bWFIVGFwcywKKwkJdW5zaWduZWQgaW50IFdyaXRlYmFja0x1bWFWVGFwcywKKwkJdW5zaWdu
ZWQgaW50IFdyaXRlYmFja0Nocm9tYUhUYXBzLAorCQl1bnNpZ25lZCBpbnQgV3JpdGViYWNrQ2hy
b21hVlRhcHMsCisJCWRvdWJsZSBXcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoLAorCQl1bnNpZ25l
ZCBpbnQgSFRvdGFsLAorCQl1bnNpZ25lZCBpbnQgV3JpdGViYWNrQ2hyb21hTGluZUJ1ZmZlcldp
ZHRoKQoreworCWRvdWJsZSBDYWxjdWxhdGVXcml0ZUJhY2tESVNQQ0xLID0gMS4wMSAqIFBpeGVs
Q2xvY2sgKiBkbWxfbWF4KAorCQlkbWxfY2VpbChXcml0ZWJhY2tMdW1hSFRhcHMgLyA0LjAsIDEp
IC8gV3JpdGViYWNrSFJhdGlvLAorCQlkbWxfbWF4KChXcml0ZWJhY2tMdW1hVlRhcHMgKiBkbWxf
Y2VpbCgxLjAgLyBXcml0ZWJhY2tWUmF0aW8sIDEpICogZG1sX2NlaWwoV3JpdGViYWNrRGVzdGlu
YXRpb25XaWR0aCAvIDQuMCwgMSkKKwkJCSsgZG1sX2NlaWwoV3JpdGViYWNrRGVzdGluYXRpb25X
aWR0aCAvIDQuMCwgMSkpIC8gKGRvdWJsZSkgSFRvdGFsICsgZG1sX2NlaWwoMS4wIC8gV3JpdGVi
YWNrVlJhdGlvLCAxKQorCQkJKiAoZG1sX2NlaWwoV3JpdGViYWNrTHVtYVZUYXBzIC8gNC4wLCAx
KSArIDQuMCkgLyAoZG91YmxlKSBIVG90YWwsCisJCQlkbWxfY2VpbCgxLjAgLyBXcml0ZWJhY2tW
UmF0aW8sIDEpICogV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aCAvIChkb3VibGUpIEhUb3RhbCkp
OworCWlmIChXcml0ZWJhY2tQaXhlbEZvcm1hdCAhPSBkbV80NDRfMzIpIHsKKwkJQ2FsY3VsYXRl
V3JpdGVCYWNrRElTUENMSyA9IGRtbF9tYXgoQ2FsY3VsYXRlV3JpdGVCYWNrRElTUENMSywgMS4w
MSAqIFBpeGVsQ2xvY2sgKiBkbWxfbWF4KAorCQkJZG1sX2NlaWwoV3JpdGViYWNrQ2hyb21hSFRh
cHMgLyAyLjAsIDEpIC8gKDIgKiBXcml0ZWJhY2tIUmF0aW8pLAorCQkJZG1sX21heCgoV3JpdGVi
YWNrQ2hyb21hVlRhcHMgKiBkbWxfY2VpbCgxIC8gKDIgKiBXcml0ZWJhY2tWUmF0aW8pLCAxKSAq
IGRtbF9jZWlsKFdyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGggLyAyLjAgLyAyLjAsIDEpCisJCQkJ
KyBkbWxfY2VpbChXcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoIC8gMi4wIC8gV3JpdGViYWNrQ2hy
b21hTGluZUJ1ZmZlcldpZHRoLCAxKSkgLyBIVG90YWwKKwkJCQkrIGRtbF9jZWlsKDEgLyAoMiAq
IFdyaXRlYmFja1ZSYXRpbyksIDEpICogKGRtbF9jZWlsKFdyaXRlYmFja0Nocm9tYVZUYXBzIC8g
NC4wLCAxKSArIDQpIC8gSFRvdGFsLAorCQkJCWRtbF9jZWlsKDEuMCAvICgyICogV3JpdGViYWNr
VlJhdGlvKSwgMSkgKiBXcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoIC8gMi4wIC8gSFRvdGFsKSkp
OworCX0KKwlyZXR1cm4gQ2FsY3VsYXRlV3JpdGVCYWNrRElTUENMSzsKK30KKworI2VuZGlmCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9k
ZV92YmEuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2Rl
X3ZiYS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZDQ4OGMwNTEz
MWY5Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2Rt
bC9kaXNwbGF5X21vZGVfdmJhLmgKQEAgLTAsMCArMSw4NDggQEAKKy8qCisgKiBDb3B5cmlnaHQg
MjAxNyBBZHZhbmNlZCBNaWNybyBEZXZpY2VzLCBJbmMuCisgKgorICogUGVybWlzc2lvbiBpcyBo
ZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEK
KyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZp
bGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0
IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRz
IHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGlj
ZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJt
aXQgcGVyc29ucyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNv
LCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUg
Y29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNs
dWRlZCBpbgorICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29m
dHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQg
V0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElORyBC
VVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAorICog
RklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElO
IE5PIEVWRU5UIFNIQUxMCisgKiBUSEUgQ09QWVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1IoUykg
QkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IKKyAqIE9USEVSIExJQUJJTElUWSwg
V0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAorICog
QVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBP
UiBUSEUgVVNFIE9SCisgKiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCisgKgorICog
QXV0aG9yczogQU1ECisgKgorICovCisKKyNpZm5kZWYgX19ETUwyX0RJU1BMQVlfTU9ERV9WQkFf
SF9fCisjZGVmaW5lIF9fRE1MMl9ESVNQTEFZX01PREVfVkJBX0hfXworCisjaW5jbHVkZSAiZG1s
X2NvbW1vbl9kZWZzLmgiCisKK3N0cnVjdCBkaXNwbGF5X21vZGVfbGliOworCit2b2lkIE1vZGVT
dXBwb3J0QW5kU3lzdGVtQ29uZmlndXJhdGlvbihzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9k
ZV9saWIpOworCisjZGVmaW5lIGRtbF9nZXRfYXR0cl9kZWNsKGF0dHIpIGRvdWJsZSBnZXRfIyNh
dHRyKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwgY29uc3QgZGlzcGxheV9lMmVf
cGlwZV9wYXJhbXNfc3QgKnBpcGVzLCB1bnNpZ25lZCBpbnQgbnVtX3BpcGVzKQorCitkbWxfZ2V0
X2F0dHJfZGVjbChjbGtfZGNmX2RlZXBzbGVlcCk7CitkbWxfZ2V0X2F0dHJfZGVjbCh3bV91cmdl
bnQpOworZG1sX2dldF9hdHRyX2RlY2wod21fbWVtb3J5X3RyaXApOworZG1sX2dldF9hdHRyX2Rl
Y2wod21fd3JpdGViYWNrX3VyZ2VudCk7CitkbWxfZ2V0X2F0dHJfZGVjbCh3bV9zdHV0dGVyX2V4
aXQpOworZG1sX2dldF9hdHRyX2RlY2wod21fc3R1dHRlcl9lbnRlcl9leGl0KTsKK2RtbF9nZXRf
YXR0cl9kZWNsKHdtX2RyYW1fY2xvY2tfY2hhbmdlKTsKK2RtbF9nZXRfYXR0cl9kZWNsKHdtX3dy
aXRlYmFja19kcmFtX2Nsb2NrX2NoYW5nZSk7CitkbWxfZ2V0X2F0dHJfZGVjbCh3bV94ZmNfdW5k
ZXJmbG93KTsKK2RtbF9nZXRfYXR0cl9kZWNsKHN0dXR0ZXJfZWZmaWNpZW5jeV9ub192Ymxhbmsp
OworZG1sX2dldF9hdHRyX2RlY2woc3R1dHRlcl9lZmZpY2llbmN5KTsKK2RtbF9nZXRfYXR0cl9k
ZWNsKHVyZ2VudF9sYXRlbmN5KTsKK2RtbF9nZXRfYXR0cl9kZWNsKHVyZ2VudF9leHRyYV9sYXRl
bmN5KTsKK2RtbF9nZXRfYXR0cl9kZWNsKG5vbnVyZ2VudF9sYXRlbmN5KTsKK2RtbF9nZXRfYXR0
cl9kZWNsKGRyYW1fY2xvY2tfY2hhbmdlX2xhdGVuY3kpOworZG1sX2dldF9hdHRyX2RlY2woZGlz
cGNsa19jYWxjdWxhdGVkKTsKK2RtbF9nZXRfYXR0cl9kZWNsKHRvdGFsX2RhdGFfcmVhZF9idyk7
CitkbWxfZ2V0X2F0dHJfZGVjbChyZXR1cm5fYncpOworZG1sX2dldF9hdHRyX2RlY2wodGNhbGMp
OworZG1sX2dldF9hdHRyX2RlY2woZnJhY3Rpb25fb2ZfdXJnZW50X2JhbmR3aWR0aCk7CitkbWxf
Z2V0X2F0dHJfZGVjbChmcmFjdGlvbl9vZl91cmdlbnRfYmFuZHdpZHRoX2ltbV9mbGlwKTsKKwor
I2RlZmluZSBkbWxfZ2V0X3BpcGVfYXR0cl9kZWNsKGF0dHIpIGRvdWJsZSBnZXRfIyNhdHRyKHN0
cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwgY29uc3QgZGlzcGxheV9lMmVfcGlwZV9w
YXJhbXNfc3QgKnBpcGVzLCB1bnNpZ25lZCBpbnQgbnVtX3BpcGVzLCB1bnNpZ25lZCBpbnQgd2hp
Y2hfcGlwZSkKKworZG1sX2dldF9waXBlX2F0dHJfZGVjbChkc2NfZGVsYXkpOworZG1sX2dldF9w
aXBlX2F0dHJfZGVjbChkcHBjbGtfY2FsY3VsYXRlZCk7CitkbWxfZ2V0X3BpcGVfYXR0cl9kZWNs
KGRzY2Nsa19jYWxjdWxhdGVkKTsKK2RtbF9nZXRfcGlwZV9hdHRyX2RlY2wobWluX3R0dV92Ymxh
bmspOworZG1sX2dldF9waXBlX2F0dHJfZGVjbCh2cmF0aW9fcHJlZmV0Y2hfbCk7CitkbWxfZ2V0
X3BpcGVfYXR0cl9kZWNsKHZyYXRpb19wcmVmZXRjaF9jKTsKK2RtbF9nZXRfcGlwZV9hdHRyX2Rl
Y2woZHN0X3hfYWZ0ZXJfc2NhbGVyKTsKK2RtbF9nZXRfcGlwZV9hdHRyX2RlY2woZHN0X3lfYWZ0
ZXJfc2NhbGVyKTsKK2RtbF9nZXRfcGlwZV9hdHRyX2RlY2woZHN0X3lfcGVyX3ZtX3ZibGFuayk7
CitkbWxfZ2V0X3BpcGVfYXR0cl9kZWNsKGRzdF95X3Blcl9yb3dfdmJsYW5rKTsKK2RtbF9nZXRf
cGlwZV9hdHRyX2RlY2woZHN0X3lfcHJlZmV0Y2gpOworZG1sX2dldF9waXBlX2F0dHJfZGVjbChk
c3RfeV9wZXJfdm1fZmxpcCk7CitkbWxfZ2V0X3BpcGVfYXR0cl9kZWNsKGRzdF95X3Blcl9yb3df
ZmxpcCk7CitkbWxfZ2V0X3BpcGVfYXR0cl9kZWNsKHhmY190cmFuc2Zlcl9kZWxheSk7CitkbWxf
Z2V0X3BpcGVfYXR0cl9kZWNsKHhmY19wcmVjaGFyZ2VfZGVsYXkpOworZG1sX2dldF9waXBlX2F0
dHJfZGVjbCh4ZmNfcmVtb3RlX3N1cmZhY2VfZmxpcF9sYXRlbmN5KTsKK2RtbF9nZXRfcGlwZV9h
dHRyX2RlY2woeGZjX3ByZWZldGNoX21hcmdpbik7CitkbWxfZ2V0X3BpcGVfYXR0cl9kZWNsKHJl
ZmN5Y19wZXJfdm1fZ3JvdXBfdmJsYW5rKTsKK2RtbF9nZXRfcGlwZV9hdHRyX2RlY2wocmVmY3lj
X3Blcl92bV9ncm91cF9mbGlwKTsKK2RtbF9nZXRfcGlwZV9hdHRyX2RlY2wocmVmY3ljX3Blcl92
bV9yZXFfdmJsYW5rKTsKK2RtbF9nZXRfcGlwZV9hdHRyX2RlY2wocmVmY3ljX3Blcl92bV9yZXFf
ZmxpcCk7CisKK3Vuc2lnbmVkIGludCBnZXRfdnN0YXJ0dXBfY2FsY3VsYXRlZCgKKwkJc3RydWN0
IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQljb25zdCBkaXNwbGF5X2UyZV9waXBlX3Bh
cmFtc19zdCAqcGlwZXMsCisJCXVuc2lnbmVkIGludCBudW1fcGlwZXMsCisJCXVuc2lnbmVkIGlu
dCB3aGljaF9waXBlKTsKKworZG91YmxlIGdldF90b3RhbF9pbW1lZGlhdGVfZmxpcF9ieXRlcygK
KwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQljb25zdCBkaXNwbGF5X2Uy
ZV9waXBlX3BhcmFtc19zdCAqcGlwZXMsCisJCXVuc2lnbmVkIGludCBudW1fcGlwZXMpOworZG91
YmxlIGdldF90b3RhbF9pbW1lZGlhdGVfZmxpcF9idygKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9s
aWIgKm1vZGVfbGliLAorCQljb25zdCBkaXNwbGF5X2UyZV9waXBlX3BhcmFtc19zdCAqcGlwZXMs
CisJCXVuc2lnbmVkIGludCBudW1fcGlwZXMpOworZG91YmxlIGdldF90b3RhbF9wcmVmZXRjaF9i
dygKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQljb25zdCBkaXNwbGF5
X2UyZV9waXBlX3BhcmFtc19zdCAqcGlwZXMsCisJCXVuc2lnbmVkIGludCBudW1fcGlwZXMpOwor
dW5zaWduZWQgaW50IGRtbF9nZXRfdm9sdGFnZV9sZXZlbCgKKwkJc3RydWN0IGRpc3BsYXlfbW9k
ZV9saWIgKm1vZGVfbGliLAorCQljb25zdCBkaXNwbGF5X2UyZV9waXBlX3BhcmFtc19zdCAqcGlw
ZXMsCisJCXVuc2lnbmVkIGludCBudW1fcGlwZXMpOworCit2b2lkIFBpeGVsQ2xvY2tBZGp1c3Rt
ZW50Rm9yUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXQoc3RydWN0IGRpc3BsYXlfbW9kZV9saWIg
Km1vZGVfbGliKTsKKworYm9vbCBDYWxjdWxhdGUyNTZCQmxvY2tTaXplcygKKwkJZW51bSBzb3Vy
Y2VfZm9ybWF0X2NsYXNzIFNvdXJjZVBpeGVsRm9ybWF0LAorCQllbnVtIGRtX3N3aXp6bGVfbW9k
ZSBTdXJmYWNlVGlsaW5nLAorCQl1bnNpZ25lZCBpbnQgQnl0ZVBlclBpeGVsWSwKKwkJdW5zaWdu
ZWQgaW50IEJ5dGVQZXJQaXhlbEMsCisJCXVuc2lnbmVkIGludCAqQmxvY2tIZWlnaHQyNTZCeXRl
c1ksCisJCXVuc2lnbmVkIGludCAqQmxvY2tIZWlnaHQyNTZCeXRlc0MsCisJCXVuc2lnbmVkIGlu
dCAqQmxvY2tXaWR0aDI1NkJ5dGVzWSwKKwkJdW5zaWduZWQgaW50ICpCbG9ja1dpZHRoMjU2Qnl0
ZXNDKTsKKworc3RydWN0IHZiYV92YXJzX3N0IHsKKwlpcF9wYXJhbXNfc3QgaXA7CisJc29jX2Jv
dW5kaW5nX2JveF9zdCBzb2M7CisKKwlpbnQgbWF4TXBjQ29tYjsKKwlib29sIFVzZU1heGltdW1W
U3RhcnR1cDsKKworCWRvdWJsZSBXcml0ZWJhY2tESVNQQ0xLOworCWRvdWJsZSBEUFBDTEtVc2lu
Z1NpbmdsZURQUEx1bWE7CisJZG91YmxlIERQUENMS1VzaW5nU2luZ2xlRFBQQ2hyb21hOworCWRv
dWJsZSBESVNQQ0xLV2l0aFJhbXBpbmc7CisJZG91YmxlIERJU1BDTEtXaXRob3V0UmFtcGluZzsK
Kwlkb3VibGUgR2xvYmFsRFBQQ0xLOworCWRvdWJsZSBESVNQQ0xLV2l0aFJhbXBpbmdSb3VuZGVk
VG9ERlNHcmFudWxhcml0eTsKKwlkb3VibGUgRElTUENMS1dpdGhvdXRSYW1waW5nUm91bmRlZFRv
REZTR3JhbnVsYXJpdHk7CisJZG91YmxlIE1heERpc3BjbGtSb3VuZGVkVG9ERlNHcmFudWxhcml0
eTsKKwlib29sIERDQ0VuYWJsZWRBbnlQbGFuZTsKKwlkb3VibGUgUmV0dXJuQmFuZHdpZHRoVG9E
Q047CisJdW5zaWduZWQgaW50IFRvdGFsQWN0aXZlRFBQOworCXVuc2lnbmVkIGludCBUb3RhbERD
Q0FjdGl2ZURQUDsKKwlkb3VibGUgVXJnZW50Um91bmRUcmlwQW5kT3V0T2ZPcmRlckxhdGVuY3k7
CisJZG91YmxlIFN0dXR0ZXJQZXJpb2Q7CisJZG91YmxlIEZyYW1lVGltZUZvck1pbkZ1bGxERVRC
dWZmZXJpbmdUaW1lOworCWRvdWJsZSBBdmVyYWdlUmVhZEJhbmR3aWR0aDsKKwlkb3VibGUgVG90
YWxSb3dSZWFkQmFuZHdpZHRoOworCWRvdWJsZSBQYXJ0T2ZCdXJzdFRoYXRGaXRzSW5ST0I7CisJ
ZG91YmxlIFN0dXR0ZXJCdXJzdFRpbWU7CisJdW5zaWduZWQgaW50IE5leHRQcmVmZXRjaE1vZGU7
CisJZG91YmxlIE5leHRNYXhWU3RhcnR1cDsKKwlkb3VibGUgVkJsYW5rVGltZTsKKwlkb3VibGUg
U21hbGxlc3RWQmxhbms7CisJZG91YmxlIERDRkNMS0RlZXBTbGVlcFBlclBsYW5lW0RDX19OVU1f
RFBQX19NQVhdOworCWRvdWJsZSBFZmZlY3RpdmVERVRQbHVzTEJMaW5lc0x1bWE7CisJZG91Ymxl
IEVmZmVjdGl2ZURFVFBsdXNMQkxpbmVzQ2hyb21hOworCWRvdWJsZSBVcmdlbnRMYXRlbmN5U3Vw
cG9ydFVzTHVtYTsKKwlkb3VibGUgVXJnZW50TGF0ZW5jeVN1cHBvcnRVc0Nocm9tYTsKKwl1bnNp
Z25lZCBpbnQgRFNDRm9ybWF0RmFjdG9yOworCisJYm9vbCBQcmVmZXRjaE1vZGVTdXBwb3J0ZWQ7
CisJZW51bSBzZWxmX3JlZnJlc2hfYWZmaW5pdHkgQWxsb3dEUkFNU2VsZlJlZnJlc2hPckRSQU1D
bG9ja0NoYW5nZUluVmJsYW5rOyAvLyBNb2RlIFN1cHBvcnQgb25seQorCWRvdWJsZSBYRkNSZW1v
dGVTdXJmYWNlRmxpcERlbGF5OworCWRvdWJsZSBUSW5pdFhGaWxsOworCWRvdWJsZSBUc2x2Q2hr
OworCWRvdWJsZSBTcmNBY3RpdmVEcmFpblJhdGU7CisJYm9vbCBJbW1lZGlhdGVGbGlwU3VwcG9y
dGVkOworCWVudW0gbXBjX2NvbWJpbmVfYWZmaW5pdHkgV2hlblRvRG9NUENDb21iaW5lOyAvLyBN
b2RlIFN1cHBvcnQgb25seQorCisJYm9vbCBQcmVmZXRjaEVSUk9SOworCisJdW5zaWduZWQgaW50
IFZTdGFydHVwTGluZXM7CisJdW5zaWduZWQgaW50IEFjdGl2ZURQUHM7CisJdW5zaWduZWQgaW50
IExCTGF0ZW5jeUhpZGluZ1NvdXJjZUxpbmVzWTsKKwl1bnNpZ25lZCBpbnQgTEJMYXRlbmN5SGlk
aW5nU291cmNlTGluZXNDOworCWRvdWJsZSBBY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFy
Z2luW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBNaW5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VN
YXJnaW47CisJZG91YmxlIEluaXRGaWxsTGV2ZWw7CisJZG91YmxlIEZpbmFsRmlsbE1hcmdpbjsK
Kwlkb3VibGUgRmluYWxGaWxsTGV2ZWw7CisJZG91YmxlIFJlbWFpbmluZ0ZpbGxMZXZlbDsKKwlk
b3VibGUgVEZpbmFseEZpbGw7CisKKwkvLworCS8vIFNPQyBCb3VuZGluZyBCb3ggUGFyYW1ldGVy
cworCS8vCisJZG91YmxlIFNSRXhpdFRpbWU7CisJZG91YmxlIFNSRW50ZXJQbHVzRXhpdFRpbWU7
CisJZG91YmxlIFVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5OworCWRvdWJsZSBVcmdlbnRMYXRl
bmN5UGl4ZWxNaXhlZFdpdGhWTURhdGE7CisJZG91YmxlIFVyZ2VudExhdGVuY3lWTURhdGFPbmx5
OworCWRvdWJsZSBVcmdlbnRMYXRlbmN5OyAvLyBtYXggb2YgdGhlIGFib3ZlIHRocmVlCisJZG91
YmxlIFdyaXRlYmFja0xhdGVuY3k7CisJZG91YmxlIFBlcmNlbnRPZklkZWFsRFJBTUZhYnJpY0Fu
ZFNEUFBvcnRCV1JlY2VpdmVkQWZ0ZXJVcmdMYXRlbmN5UGl4ZWxEYXRhT25seTsgLy8gTW9kZSBT
dXBwb3J0CisJZG91YmxlIFBlcmNlbnRPZklkZWFsRFJBTUZhYnJpY0FuZFNEUFBvcnRCV1JlY2Vp
dmVkQWZ0ZXJVcmdMYXRlbmN5UGl4ZWxNaXhlZFdpdGhWTURhdGE7IC8vIE1vZGUgU3VwcG9ydAor
CWRvdWJsZSBQZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQb3J0QldSZWNlaXZlZEFmdGVy
VXJnTGF0ZW5jeVZNRGF0YU9ubHk7IC8vIE1vZGUgU3VwcG9ydAorCWRvdWJsZSBNYXhBdmVyYWdl
UGVyY2VudE9mSWRlYWxTRFBQb3J0QldEaXNwbGF5Q2FuVXNlSW5Ob3JtYWxTeXN0ZW1PcGVyYXRp
b247IC8vIE1vZGUgU3VwcG9ydAorCWRvdWJsZSBNYXhBdmVyYWdlUGVyY2VudE9mSWRlYWxEUkFN
QldEaXNwbGF5Q2FuVXNlSW5Ob3JtYWxTeXN0ZW1PcGVyYXRpb247IC8vIE1vZGUgU3VwcG9ydAor
CWRvdWJsZSBOdW1iZXJPZkNoYW5uZWxzOworCWRvdWJsZSBEUkFNQ2hhbm5lbFdpZHRoOworCWRv
dWJsZSBGYWJyaWNEYXRhcGF0aFRvRENORGF0YVJldHVybjsKKwlkb3VibGUgUmV0dXJuQnVzV2lk
dGg7CisJZG91YmxlIERvd25zcHJlYWRpbmc7CisJZG91YmxlIERJU1BDTEtEUFBDTEtEU0NDTEtE
b3duU3ByZWFkaW5nOworCWRvdWJsZSBESVNQQ0xLRFBQQ0xLVkNPU3BlZWQ7CisJZG91YmxlIFJv
dW5kVHJpcFBpbmdMYXRlbmN5Q3ljbGVzOworCWRvdWJsZSBVcmdlbnRPdXRPZk9yZGVyUmV0dXJu
UGVyQ2hhbm5lbDsKKwlkb3VibGUgVXJnZW50T3V0T2ZPcmRlclJldHVyblBlckNoYW5uZWxQaXhl
bERhdGFPbmx5OworCWRvdWJsZSBVcmdlbnRPdXRPZk9yZGVyUmV0dXJuUGVyQ2hhbm5lbFBpeGVs
TWl4ZWRXaXRoVk1EYXRhOworCWRvdWJsZSBVcmdlbnRPdXRPZk9yZGVyUmV0dXJuUGVyQ2hhbm5l
bFZNRGF0YU9ubHk7CisJdW5zaWduZWQgaW50IFZNTVBhZ2VTaXplOworCWRvdWJsZSBEUkFNQ2xv
Y2tDaGFuZ2VMYXRlbmN5OworCWRvdWJsZSBYRkNCdXNUcmFuc3BvcnRUaW1lOworCWJvb2wgVXNl
VXJnZW50QnVyc3RCYW5kd2lkdGg7CisJZG91YmxlIFhGQ1hCVUZMYXRlbmN5VG9sZXJhbmNlOwor
CisJLy8KKwkvLyBJUCBQYXJhbWV0ZXJzCisJLy8KKwl1bnNpZ25lZCBpbnQgUk9CQnVmZmVyU2l6
ZUluS0J5dGU7CisJZG91YmxlIERFVEJ1ZmZlclNpemVJbktCeXRlOworCWRvdWJsZSBERVRCdWZm
ZXJTaXplSW5UaW1lOworCXVuc2lnbmVkIGludCBEUFBPdXRwdXRCdWZmZXJQaXhlbHM7CisJdW5z
aWduZWQgaW50IE9QUE91dHB1dEJ1ZmZlckxpbmVzOworCXVuc2lnbmVkIGludCBQaXhlbENodW5r
U2l6ZUluS0J5dGU7CisJZG91YmxlIFJldHVybkJXOworCWJvb2wgR1BVVk1FbmFibGU7CisJYm9v
bCBIb3N0Vk1FbmFibGU7CisJdW5zaWduZWQgaW50IEdQVVZNTWF4UGFnZVRhYmxlTGV2ZWxzOwor
CXVuc2lnbmVkIGludCBIb3N0Vk1NYXhQYWdlVGFibGVMZXZlbHM7CisJdW5zaWduZWQgaW50IEhv
c3RWTUNhY2hlZFBhZ2VUYWJsZUxldmVsczsKKwl1bnNpZ25lZCBpbnQgT3ZlcnJpZGVHUFVWTVBh
Z2VUYWJsZUxldmVsczsKKwl1bnNpZ25lZCBpbnQgT3ZlcnJpZGVIb3N0Vk1QYWdlVGFibGVMZXZl
bHM7CisJdW5zaWduZWQgaW50IE1ldGFDaHVua1NpemU7CisJZG91YmxlIE1pblBpeGVsQ2h1bmtT
aXplQnl0ZXM7CisJZG91YmxlIE1pbk1ldGFDaHVua1NpemVCeXRlczsKKwl1bnNpZ25lZCBpbnQg
V3JpdGViYWNrQ2h1bmtTaXplOworCWJvb2wgT0RNQ2FwYWJpbGl0eTsKKwl1bnNpZ25lZCBpbnQg
TnVtYmVyT2ZEU0M7CisJdW5zaWduZWQgaW50IExpbmVCdWZmZXJTaXplOworCXVuc2lnbmVkIGlu
dCBNYXhMaW5lQnVmZmVyTGluZXM7CisJdW5zaWduZWQgaW50IFdyaXRlYmFja0ludGVyZmFjZUx1
bWFCdWZmZXJTaXplOworCXVuc2lnbmVkIGludCBXcml0ZWJhY2tJbnRlcmZhY2VDaHJvbWFCdWZm
ZXJTaXplOworCXVuc2lnbmVkIGludCBXcml0ZWJhY2tDaHJvbWFMaW5lQnVmZmVyV2lkdGg7CisJ
ZG91YmxlIE1heERDSFVCVG9QU0NMVGhyb3VnaHB1dDsKKwlkb3VibGUgTWF4UFNDTFRvTEJUaHJv
dWdocHV0OworCXVuc2lnbmVkIGludCBQVEVCdWZmZXJTaXplSW5SZXF1ZXN0c0x1bWE7CisJdW5z
aWduZWQgaW50IFBURUJ1ZmZlclNpemVJblJlcXVlc3RzQ2hyb21hOworCWRvdWJsZSBESVNQQ0xL
UmFtcGluZ01hcmdpbjsKKwl1bnNpZ25lZCBpbnQgTWF4SW50ZXJEQ05UaWxlUmVwZWF0ZXJzOwor
CWJvb2wgWEZDU3VwcG9ydGVkOworCWRvdWJsZSBYRkNTbHZDaHVua1NpemU7CisJZG91YmxlIFhG
Q0ZpbGxCV092ZXJoZWFkOworCWRvdWJsZSBYRkNGaWxsQ29uc3RhbnQ7CisJZG91YmxlIFhGQ1RT
bHZWdXBkYXRlT2Zmc2V0OworCWRvdWJsZSBYRkNUU2x2VnVwZGF0ZVdpZHRoOworCWRvdWJsZSBY
RkNUU2x2VnJlYWR5T2Zmc2V0OworCWRvdWJsZSBEUFBDTEtEZWxheVN1YnRvdGFsOworCWRvdWJs
ZSBEUFBDTEtEZWxheVNDTDsKKwlkb3VibGUgRFBQQ0xLRGVsYXlTQ0xMQk9ubHk7CisJZG91Ymxl
IERQUENMS0RlbGF5Q05WQ0Zvcm1hdGVyOworCWRvdWJsZSBEUFBDTEtEZWxheUNOVkNDdXJzb3I7
CisJZG91YmxlIERJU1BDTEtEZWxheVN1YnRvdGFsOworCWJvb2wgUHJvZ3Jlc3NpdmVUb0ludGVy
bGFjZVVuaXRJbk9QUDsKKwkvLyBQaXBlL1BsYW5lIFBhcmFtZXRlcnMKKwlpbnQgVm9sdGFnZUxl
dmVsOworCWRvdWJsZSBGYWJyaWNDbG9jazsKKwlkb3VibGUgRFJBTVNwZWVkOworCWRvdWJsZSBE
SVNQQ0xLOworCWRvdWJsZSBTT0NDTEs7CisJZG91YmxlIERDRkNMSzsKKworCXVuc2lnbmVkIGlu
dCBOdW1iZXJPZkFjdGl2ZVBsYW5lczsKKwl1bnNpZ25lZCBpbnQgTnVtYmVyT2ZEU0NTbGljZXNb
RENfX05VTV9EUFBfX01BWF07CisJdW5zaWduZWQgaW50IFZpZXdwb3J0V2lkdGhbRENfX05VTV9E
UFBfX01BWF07CisJdW5zaWduZWQgaW50IFZpZXdwb3J0SGVpZ2h0W0RDX19OVU1fRFBQX19NQVhd
OworCXVuc2lnbmVkIGludCBWaWV3cG9ydFlTdGFydFlbRENfX05VTV9EUFBfX01BWF07CisJdW5z
aWduZWQgaW50IFZpZXdwb3J0WVN0YXJ0Q1tEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBp
bnQgUGl0Y2hZW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBQaXRjaENbRENfX05V
TV9EUFBfX01BWF07CisJZG91YmxlIEhSYXRpb1tEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUg
VlJhdGlvW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBodGFwc1tEQ19fTlVNX0RQ
UF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgdnRhcHNbRENfX05VTV9EUFBfX01BWF07CisJdW5zaWdu
ZWQgaW50IEhUQVBzQ2hyb21hW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBWVEFQ
c0Nocm9tYVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgSFRvdGFsW0RDX19OVU1f
RFBQX19NQVhdOworCXVuc2lnbmVkIGludCBWVG90YWxbRENfX05VTV9EUFBfX01BWF07CisJaW50
IERQUFBlclBsYW5lW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBQaXhlbENsb2NrW0RDX19O
VU1fRFBQX19NQVhdOworCWRvdWJsZSBQaXhlbENsb2NrQmFja0VuZFtEQ19fTlVNX0RQUF9fTUFY
XTsKKwlib29sIERDQ0VuYWJsZVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgREND
TWV0YVBpdGNoWVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgRENDTWV0YVBpdGNo
Q1tEQ19fTlVNX0RQUF9fTUFYXTsKKwllbnVtIHNjYW5fZGlyZWN0aW9uX2NsYXNzIFNvdXJjZVNj
YW5bRENfX05VTV9EUFBfX01BWF07CisJZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNzIFNvdXJjZVBp
eGVsRm9ybWF0W0RDX19OVU1fRFBQX19NQVhdOworCWJvb2wgV3JpdGViYWNrRW5hYmxlW0RDX19O
VU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBBY3RpdmVXcml0ZWJhY2tzUGVyUGxhbmVbRENf
X05VTV9EUFBfX01BWF07CisJZG91YmxlIFdyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhbRENfX05V
TV9EUFBfX01BWF07CisJZG91YmxlIFdyaXRlYmFja0Rlc3RpbmF0aW9uSGVpZ2h0W0RDX19OVU1f
RFBQX19NQVhdOworCWRvdWJsZSBXcml0ZWJhY2tTb3VyY2VIZWlnaHRbRENfX05VTV9EUFBfX01B
WF07CisJZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNzIFdyaXRlYmFja1BpeGVsRm9ybWF0W0RDX19O
VU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBXcml0ZWJhY2tMdW1hSFRhcHNbRENfX05VTV9E
UFBfX01BWF07CisJdW5zaWduZWQgaW50IFdyaXRlYmFja0x1bWFWVGFwc1tEQ19fTlVNX0RQUF9f
TUFYXTsKKwl1bnNpZ25lZCBpbnQgV3JpdGViYWNrQ2hyb21hSFRhcHNbRENfX05VTV9EUFBfX01B
WF07CisJdW5zaWduZWQgaW50IFdyaXRlYmFja0Nocm9tYVZUYXBzW0RDX19OVU1fRFBQX19NQVhd
OworCWRvdWJsZSBXcml0ZWJhY2tIUmF0aW9bRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIFdy
aXRlYmFja1ZSYXRpb1tEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgSEFjdGl2ZVtE
Q19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgVkFjdGl2ZVtEQ19fTlVNX0RQUF9fTUFY
XTsKKwlib29sIEludGVybGFjZVtEQ19fTlVNX0RQUF9fTUFYXTsKKwllbnVtIGRtX3N3aXp6bGVf
bW9kZSBTdXJmYWNlVGlsaW5nW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBTY2Fs
ZXJSZWNvdXRXaWR0aFtEQ19fTlVNX0RQUF9fTUFYXTsKKwlib29sIER5bmFtaWNNZXRhZGF0YUVu
YWJsZVtEQ19fTlVNX0RQUF9fTUFYXTsKKwlpbnQgRHluYW1pY01ldGFkYXRhTGluZXNCZWZvcmVB
Y3RpdmVSZXF1aXJlZFtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgRHluYW1pY01l
dGFkYXRhVHJhbnNtaXR0ZWRCeXRlc1tEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgRENDUmF0
ZVtEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgQXZlcmFnZURDQ0NvbXByZXNzaW9uUmF0ZTsK
Kwlib29sIE9ETUNvbWJpbmVFbmFibGVkW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBPdXRw
dXRCcHBbRENfX05VTV9EUFBfX01BWF07CisJYm9vbCBEU0NFbmFibGVkW0RDX19OVU1fRFBQX19N
QVhdOworCXVuc2lnbmVkIGludCBEU0NJbnB1dEJpdFBlckNvbXBvbmVudFtEQ19fTlVNX0RQUF9f
TUFYXTsKKwllbnVtIG91dHB1dF9mb3JtYXRfY2xhc3MgT3V0cHV0Rm9ybWF0W0RDX19OVU1fRFBQ
X19NQVhdOworCWVudW0gb3V0cHV0X2VuY29kZXJfY2xhc3MgT3V0cHV0W0RDX19OVU1fRFBQX19N
QVhdOworCXVuc2lnbmVkIGludCBCbGVuZGluZ0FuZFRpbWluZ1tEQ19fTlVNX0RQUF9fTUFYXTsK
Kwlib29sIFN5bmNocm9uaXplZFZCbGFuazsKKwl1bnNpZ25lZCBpbnQgTnVtYmVyT2ZDdXJzb3Jz
W0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBDdXJzb3JXaWR0aFtEQ19fTlVNX0RQ
UF9fTUFYXVtEQ19fTlVNX0NVUlNPUl9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgQ3Vyc29yQlBQW0RD
X19OVU1fRFBQX19NQVhdW0RDX19OVU1fQ1VSU09SX19NQVhdOworCWJvb2wgWEZDRW5hYmxlZFtE
Q19fTlVNX0RQUF9fTUFYXTsKKwlib29sIFNjYWxlckVuYWJsZWRbRENfX05VTV9EUFBfX01BWF07
CisKKwkvLyBJbnRlcm1lZGlhdGVzL0luZm9ybWF0aW9uYWwKKwlib29sIEltbWVkaWF0ZUZsaXBT
dXBwb3J0OworCWRvdWJsZSBERVRCdWZmZXJTaXplWVtEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3Vi
bGUgREVUQnVmZmVyU2l6ZUNbRENfX05VTV9EUFBfX01BWF07CisJdW5zaWduZWQgaW50IFN3YXRo
SGVpZ2h0WVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgU3dhdGhIZWlnaHRDW0RD
X19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBMQkJpdFBlclBpeGVsW0RDX19OVU1fRFBQ
X19NQVhdOworCWRvdWJsZSBMYXN0UGl4ZWxPZkxpbmVFeHRyYVdhdGVybWFyazsKKwlkb3VibGUg
VG90YWxEYXRhUmVhZEJhbmR3aWR0aDsKKwl1bnNpZ25lZCBpbnQgVG90YWxBY3RpdmVXcml0ZWJh
Y2s7CisJdW5zaWduZWQgaW50IEVmZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ1NvdXJjZUxpbmVzTHVt
YTsKKwl1bnNpZ25lZCBpbnQgRWZmZWN0aXZlTEJMYXRlbmN5SGlkaW5nU291cmNlTGluZXNDaHJv
bWE7CisJZG91YmxlIEJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXA7CisJdW5zaWdu
ZWQgaW50IFByZWZldGNoTW9kZVtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVsyXTsKKwl1bnNpZ25l
ZCBpbnQgTWluUHJlZmV0Y2hNb2RlOworCXVuc2lnbmVkIGludCBNYXhQcmVmZXRjaE1vZGU7CisJ
Ym9vbCBBbnlMaW5lc0ZvclZNT3JSb3dUb29MYXJnZTsKKwlkb3VibGUgTWF4VlN0YXJ0dXA7CisJ
Ym9vbCBJZ25vcmVWaWV3cG9ydFBvc2l0aW9uaW5nOworCWJvb2wgRXJyb3JSZXN1bHRbRENfX05V
TV9EUFBfX01BWF07CisJLy8KKwkvLyBDYWxjdWxhdGVkIGRtbF9tbC0+dmJhLk91dHB1dHMKKwkv
LworCWRvdWJsZSBEQ0ZDTEtEZWVwU2xlZXA7CisJZG91YmxlIFVyZ2VudFdhdGVybWFyazsKKwlk
b3VibGUgVXJnZW50RXh0cmFMYXRlbmN5OworCWRvdWJsZSBXcml0ZWJhY2tVcmdlbnRXYXRlcm1h
cms7CisJZG91YmxlIFN0dXR0ZXJFeGl0V2F0ZXJtYXJrOworCWRvdWJsZSBTdHV0dGVyRW50ZXJQ
bHVzRXhpdFdhdGVybWFyazsKKwlkb3VibGUgRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrOworCWRv
dWJsZSBXcml0ZWJhY2tEUkFNQ2xvY2tDaGFuZ2VXYXRlcm1hcms7CisJZG91YmxlIFN0dXR0ZXJF
ZmZpY2llbmN5OworCWRvdWJsZSBTdHV0dGVyRWZmaWNpZW5jeU5vdEluY2x1ZGluZ1ZCbGFuazsK
Kwlkb3VibGUgTm9uVXJnZW50TGF0ZW5jeVRvbGVyYW5jZTsKKwlkb3VibGUgTWluQWN0aXZlRFJB
TUNsb2NrQ2hhbmdlTGF0ZW5jeVN1cHBvcnRlZDsKKworCS8vIFRoZXNlIGFyZSB0aGUgY2xvY2tz
IGNhbGN1YXRlZCBieSB0aGUgbGlicmFyeSBidXQgdGhleSBhcmUgbm90IGFjdHVhbGx5CisJLy8g
dXNlZCBleHBsaWNpdGx5LiBUaGV5IGFyZSBmZXRjaGVkIGJ5IHRlc3RzIGFuZCB0aGVuIHBvc3Np
Ymx5IHVzZWQuIFRoZQorCS8vIHVsdGltYXRlIHZhbHVlcyB0byB1c2UgYXJlIHRoZSBvbmVzIHNw
ZWNpZmllZCBieSB0aGUgcGFyYW1ldGVycyB0byBETUwKKwlkb3VibGUgRElTUENMS19jYWxjdWxh
dGVkOworCWRvdWJsZSBEUFBDTEtfY2FsY3VsYXRlZFtEQ19fTlVNX0RQUF9fTUFYXTsKKworCXVu
c2lnbmVkIGludCBWVXBkYXRlT2Zmc2V0UGl4W0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBW
VXBkYXRlV2lkdGhQaXhbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIFZSZWFkeU9mZnNldFBp
eFtEQ19fTlVNX0RQUF9fTUFYXTsKKworCXVuc2lnbmVkIGludCBUb3RJbW1lZGlhdGVGbGlwQnl0
ZXM7CisJZG91YmxlIFRDYWxjOworCisJZGlzcGxheV9lMmVfcGlwZV9wYXJhbXNfc3QgY2FjaGVf
cGlwZXNbRENfX05VTV9EUFBfX01BWF07CisJdW5zaWduZWQgaW50IGNhY2hlX251bV9waXBlczsK
Kwl1bnNpZ25lZCBpbnQgcGlwZV9wbGFuZVtEQ19fTlVNX0RQUF9fTUFYXTsKKworCS8qIHZiYSBt
b2RlIHN1cHBvcnQgKi8KKwkvKmlucHV0cyovCisJYm9vbCBTdXBwb3J0R0ZYN0NvbXBhdGlibGVU
aWxpbmdJbjMyYnBwQW5kNjRicHA7CisJZG91YmxlIE1heEhTQ0xSYXRpbzsKKwlkb3VibGUgTWF4
VlNDTFJhdGlvOworCXVuc2lnbmVkIGludCBNYXhOdW1Xcml0ZWJhY2s7CisJYm9vbCBXcml0ZWJh
Y2tMdW1hQW5kQ2hyb21hU2NhbGluZ1N1cHBvcnRlZDsKKwlib29sIEN1cnNvcjY0QnBwU3VwcG9y
dDsKKwlkb3VibGUgRENGQ0xLUGVyU3RhdGVbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV07CisJZG91
YmxlIEZhYnJpY0Nsb2NrUGVyU3RhdGVbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV07CisJZG91Ymxl
IFNPQ0NMS1BlclN0YXRlW0RDX19WT0xUQUdFX1NUQVRFUyArIDFdOworCWRvdWJsZSBQSFlDTEtQ
ZXJTdGF0ZVtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXTsKKwlkb3VibGUgTWF4RHBwY2xrW0RDX19W
T0xUQUdFX1NUQVRFUyArIDFdOworCWRvdWJsZSBNYXhEU0NDTEtbRENfX1ZPTFRBR0VfU1RBVEVT
ICsgMV07CisJZG91YmxlIERSQU1TcGVlZFBlclN0YXRlW0RDX19WT0xUQUdFX1NUQVRFUyArIDFd
OworCWRvdWJsZSBNYXhEaXNwY2xrW0RDX19WT0xUQUdFX1NUQVRFUyArIDFdOworCWludCBWb2x0
YWdlT3ZlcnJpZGVMZXZlbDsKKworCS8qb3V0cHV0cyovCisJYm9vbCBTY2FsZVJhdGlvQW5kVGFw
c1N1cHBvcnQ7CisJYm9vbCBTb3VyY2VGb3JtYXRQaXhlbEFuZFNjYW5TdXBwb3J0OworCWRvdWJs
ZSBUb3RhbEJhbmR3aWR0aENvbnN1bWVkR0J5dGVQZXJTZWNvbmQ7CisJYm9vbCBEQ0NFbmFibGVk
SW5BbnlQbGFuZTsKKwlib29sIFdyaXRlYmFja0xhdGVuY3lTdXBwb3J0OworCWJvb2wgV3JpdGVi
YWNrTW9kZVN1cHBvcnQ7CisJYm9vbCBXcml0ZWJhY2sxMGJwYzQyMFN1cHBvcnRlZDsKKwlib29s
IEJhbmR3aWR0aFN1cHBvcnRbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV07CisJdW5zaWduZWQgaW50
IFRvdGFsTnVtYmVyT2ZBY3RpdmVXcml0ZWJhY2s7CisJZG91YmxlIENyaXRpY2FsUG9pbnQ7CisJ
ZG91YmxlIFJldHVybkJXVG9EQ05QZXJTdGF0ZTsKKwlib29sIElzRXJyb3JSZXN1bHRbRENfX1ZP
TFRBR0VfU1RBVEVTICsgMV1bMl1bRENfX05VTV9EUFBfX01BWF07CisJYm9vbCBwcmVmZXRjaF92
bV9id192YWxpZDsKKwlib29sIHByZWZldGNoX3Jvd19id192YWxpZDsKKwlib29sIE51bWJlck9m
T1RHU3VwcG9ydDsKKwlib29sIE5vbnN1cHBvcnRlZERTQ0lucHV0QlBDOworCWJvb2wgV3JpdGVi
YWNrU2NhbGVSYXRpb0FuZFRhcHNTdXBwb3J0OworCWJvb2wgQ3Vyc29yU3VwcG9ydDsKKwlib29s
IFBpdGNoU3VwcG9ydDsKKwllbnVtIGRtX3ZhbGlkYXRpb25fc3RhdHVzIFZhbGlkYXRpb25TdGF0
dXNbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV07CisKKwlkb3VibGUgV3JpdGViYWNrTGluZUJ1ZmZl
ckx1bWFCdWZmZXJTaXplOworCWRvdWJsZSBXcml0ZWJhY2tMaW5lQnVmZmVyQ2hyb21hQnVmZmVy
U2l6ZTsKKwlkb3VibGUgV3JpdGViYWNrTWluSFNDTFJhdGlvOworCWRvdWJsZSBXcml0ZWJhY2tN
aW5WU0NMUmF0aW87CisJZG91YmxlIFdyaXRlYmFja01heEhTQ0xSYXRpbzsKKwlkb3VibGUgV3Jp
dGViYWNrTWF4VlNDTFJhdGlvOworCWRvdWJsZSBXcml0ZWJhY2tNYXhIU0NMVGFwczsKKwlkb3Vi
bGUgV3JpdGViYWNrTWF4VlNDTFRhcHM7CisJdW5zaWduZWQgaW50IE1heE51bURQUDsKKwl1bnNp
Z25lZCBpbnQgTWF4TnVtT1RHOworCWRvdWJsZSBDdXJzb3JCdWZmZXJTaXplOworCWRvdWJsZSBD
dXJzb3JDaHVua1NpemU7CisJdW5zaWduZWQgaW50IE1vZGU7CisJZG91YmxlIE91dHB1dExpbmtE
UExhbmVzW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBGb3JjZWRPdXRwdXRMaW5rQlBQW0RD
X19OVU1fRFBQX19NQVhdOyAvLyBNb2RlIFN1cHBvcnQgb25seQorCWRvdWJsZSBJbW1lZGlhdGVG
bGlwQldbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIE1heE1heFZTdGFydHVwOworCisJZG91
YmxlIFdyaXRlYmFja0x1bWFWRXh0cmE7CisJZG91YmxlIFdyaXRlYmFja0Nocm9tYVZFeHRyYTsK
Kwlkb3VibGUgV3JpdGViYWNrUmVxdWlyZWRESVNQQ0xLOworCWRvdWJsZSBNYXhpbXVtU3dhdGhX
aWR0aFN1cHBvcnQ7CisJZG91YmxlIE1heGltdW1Td2F0aFdpZHRoSW5ERVRCdWZmZXI7CisJZG91
YmxlIE1heGltdW1Td2F0aFdpZHRoSW5MaW5lQnVmZmVyOworCWRvdWJsZSBNYXhEaXNwY2xrUm91
bmRlZERvd25Ub0RGU0dyYW51bGFyaXR5OworCWRvdWJsZSBNYXhEcHBjbGtSb3VuZGVkRG93blRv
REZTR3JhbnVsYXJpdHk7CisJZG91YmxlIFBsYW5lUmVxdWlyZWRESVNQQ0xLV2l0aG91dE9ETUNv
bWJpbmU7CisJZG91YmxlIFBsYW5lUmVxdWlyZWRESVNQQ0xLV2l0aE9ETUNvbWJpbmU7CisJZG91
YmxlIFBsYW5lUmVxdWlyZWRESVNQQ0xLOworCWRvdWJsZSBUb3RhbE51bWJlck9mQWN0aXZlT1RH
OworCWRvdWJsZSBGRUNPdmVyaGVhZDsKKwlkb3VibGUgRWZmZWN0aXZlRkVDT3ZlcmhlYWQ7CisJ
dW5zaWduZWQgaW50IE91dGJwcDsKKwl1bnNpZ25lZCBpbnQgT3V0YnBwRFNDOworCWRvdWJsZSBU
b3RhbERTQ1VuaXRzUmVxdWlyZWQ7CisJZG91YmxlIGJwcDsKKwl1bnNpZ25lZCBpbnQgc2xpY2Vz
OworCWRvdWJsZSBTd2F0aFdpZHRoR3JhbnVsYXJpdHlZOworCWRvdWJsZSBSb3VuZGVkVXBNYXhT
d2F0aFNpemVCeXRlc1k7CisJZG91YmxlIFN3YXRoV2lkdGhHcmFudWxhcml0eUM7CisJZG91Ymxl
IFJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5dGVzQzsKKwlkb3VibGUgRWZmZWN0aXZlREVUTEJMaW5l
c0x1bWE7CisJZG91YmxlIEVmZmVjdGl2ZURFVExCTGluZXNDaHJvbWE7CisJZG91YmxlIFByb2pl
Y3RlZERDRkNMS0RlZXBTbGVlcDsKKwlkb3VibGUgUERFQW5kTWV0YVBURUJ5dGVzUGVyRnJhbWVZ
OworCWRvdWJsZSBQREVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFtZUM7CisJdW5zaWduZWQgaW50IE1l
dGFSb3dCeXRlc1k7CisJdW5zaWduZWQgaW50IE1ldGFSb3dCeXRlc0M7CisJdW5zaWduZWQgaW50
IERQVEVCeXRlc1BlclJvd0M7CisJdW5zaWduZWQgaW50IERQVEVCeXRlc1BlclJvd1k7CisJZG91
YmxlIEV4dHJhTGF0ZW5jeTsKKwlkb3VibGUgVGltZUNhbGM7CisJZG91YmxlIFRXYWl0OworCWRv
dWJsZSBNYXhpbXVtUmVhZEJhbmR3aWR0aFdpdGhQcmVmZXRjaDsKKwlkb3VibGUgTWF4aW11bVJl
YWRCYW5kd2lkdGhXaXRob3V0UHJlZmV0Y2g7CisJZG91YmxlIHRvdGFsX2Rjbl9yZWFkX2J3X3dp
dGhfZmxpcDsKKwlkb3VibGUgdG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwX25vX3VyZ2VudF9i
dXJzdDsKKwlkb3VibGUgRnJhY3Rpb25PZlVyZ2VudEJhbmR3aWR0aDsKKwlkb3VibGUgRnJhY3Rp
b25PZlVyZ2VudEJhbmR3aWR0aEltbWVkaWF0ZUZsaXA7IC8vIE1vZGUgU3VwcG9ydCBkZWJ1Z2dp
bmcgb3V0cHV0CisKKwkvKiBtcyBsb2NhbHMgKi8KKwlkb3VibGUgSWRlYWxTRFBQb3J0QmFuZHdp
ZHRoUGVyU3RhdGVbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV07CisJdW5zaWduZWQgaW50IE5vT2ZE
UFBbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV1bMl1bRENfX05VTV9EUFBfX01BWF07CisJaW50IE5v
T2ZEUFBUaGlzU3RhdGVbRENfX05VTV9EUFBfX01BWF07CisJYm9vbCBPRE1Db21iaW5lRW5hYmxl
UGVyU3RhdGVbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV1bRENfX05VTV9EUFBfX01BWF07CisJdW5z
aWduZWQgaW50IFN3YXRoV2lkdGhZVGhpc1N0YXRlW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2ln
bmVkIGludCBTd2F0aEhlaWdodENQZXJTdGF0ZVtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVsyXVtE
Q19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgU3dhdGhIZWlnaHRZVGhpc1N0YXRlW0RD
X19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBTd2F0aEhlaWdodENUaGlzU3RhdGVbRENf
X05VTV9EUFBfX01BWF07CisJZG91YmxlIFZSYXRpb1ByZVlbRENfX1ZPTFRBR0VfU1RBVEVTICsg
MV1bMl1bRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIFZSYXRpb1ByZUNbRENfX1ZPTFRBR0Vf
U1RBVEVTICsgMV1bMl1bRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIFJlcXVpcmVkUHJlZmV0
Y2hQaXhlbERhdGFCV0x1bWFbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV1bMl1bRENfX05VTV9EUFBf
X01BWF07CisJZG91YmxlIFJlcXVpcmVkUHJlZmV0Y2hQaXhlbERhdGFCV0Nocm9tYVtEQ19fVk9M
VEFHRV9TVEFURVMgKyAxXVsyXVtEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgUmVxdWlyZWRE
UFBDTEtbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV1bMl1bRENfX05VTV9EUFBfX01BWF07CisJZG91
YmxlIFJlcXVpcmVkRFBQQ0xLVGhpc1N0YXRlW0RDX19OVU1fRFBQX19NQVhdOworCWJvb2wgUFRF
QnVmZmVyU2l6ZU5vdEV4Y2VlZGVkWVtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVsyXVtEQ19fTlVN
X0RQUF9fTUFYXTsKKwlib29sIFBURUJ1ZmZlclNpemVOb3RFeGNlZWRlZENbRENfX1ZPTFRBR0Vf
U1RBVEVTICsgMV1bMl1bRENfX05VTV9EUFBfX01BWF07CisJYm9vbCBCYW5kd2lkdGhXaXRob3V0
UHJlZmV0Y2hTdXBwb3J0ZWRbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV07CisJYm9vbCBQcmVmZXRj
aFN1cHBvcnRlZFtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVsyXTsKKwlib29sIFZSYXRpb0luUHJl
ZmV0Y2hTdXBwb3J0ZWRbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV1bMl07CisJZG91YmxlIFJlcXVp
cmVkRElTUENMS1tEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVsyXTsKKwlib29sIERJU1BDTEtfRFBQ
Q0xLX1N1cHBvcnRbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV1bMl07CisJYm9vbCBUb3RhbEF2YWls
YWJsZVBpcGVzU3VwcG9ydFtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVsyXTsKKwl1bnNpZ25lZCBp
bnQgVG90YWxOdW1iZXJPZkFjdGl2ZURQUFtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVsyXTsKKwl1
bnNpZ25lZCBpbnQgVG90YWxOdW1iZXJPZkRDQ0FjdGl2ZURQUFtEQ19fVk9MVEFHRV9TVEFURVMg
KyAxXVsyXTsKKwlib29sIE1vZGVTdXBwb3J0W0RDX19WT0xUQUdFX1NUQVRFUyArIDFdWzJdOwor
CWRvdWJsZSBSZXR1cm5CV1BlclN0YXRlW0RDX19WT0xUQUdFX1NUQVRFUyArIDFdOworCWJvb2wg
RElPU3VwcG9ydFtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXTsKKwlib29sIE5vdEVub3VnaERTQ1Vu
aXRzW0RDX19WT0xUQUdFX1NUQVRFUyArIDFdOworCWJvb2wgRFNDQ0xLUmVxdWlyZWRNb3JlVGhh
blN1cHBvcnRlZFtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXTsKKwlkb3VibGUgVXJnZW50Um91bmRU
cmlwQW5kT3V0T2ZPcmRlckxhdGVuY3lQZXJTdGF0ZVtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXTsK
Kwlib29sIFJPQlN1cHBvcnRbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV07CisJYm9vbCBQVEVCdWZm
ZXJTaXplTm90RXhjZWVkZWRbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV1bMl07CisJYm9vbCBUb3Rh
bFZlcnRpY2FsQWN0aXZlQmFuZHdpZHRoU3VwcG9ydFtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXTsK
Kwlkb3VibGUgTWF4VG90YWxWZXJ0aWNhbEFjdGl2ZUF2YWlsYWJsZUJhbmR3aWR0aFtEQ19fVk9M
VEFHRV9TVEFURVMgKyAxXTsKKwlkb3VibGUgUHJlZmV0Y2hCV1tEQ19fTlVNX0RQUF9fTUFYXTsK
Kwlkb3VibGUgUERFQW5kTWV0YVBURUJ5dGVzUGVyRnJhbWVbRENfX05VTV9EUFBfX01BWF07CisJ
ZG91YmxlIE1ldGFSb3dCeXRlc1tEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgRFBURUJ5dGVz
UGVyUm93W0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBQcmVmZXRjaExpbmVzWVtEQ19fTlVN
X0RQUF9fTUFYXTsKKwlkb3VibGUgUHJlZmV0Y2hMaW5lc0NbRENfX05VTV9EUFBfX01BWF07CisJ
dW5zaWduZWQgaW50IE1heE51bVN3WVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQg
TWF4TnVtU3dDW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBQcmVmaWxsWVtEQ19fTlVNX0RQ
UF9fTUFYXTsKKwlkb3VibGUgUHJlZmlsbENbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIExp
bmVUaW1lc0ZvclByZWZldGNoW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBMaW5lc0Zvck1l
dGFQVEVbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIExpbmVzRm9yTWV0YUFuZERQVEVSb3db
RENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIE1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW0RDX19O
VU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBTd2F0aFdpZHRoWVNpbmdsZURQUFtEQ19fTlVN
X0RQUF9fTUFYXTsKKwlkb3VibGUgQnl0ZVBlclBpeGVsSW5ERVRZW0RDX19OVU1fRFBQX19NQVhd
OworCWRvdWJsZSBCeXRlUGVyUGl4ZWxJbkRFVENbRENfX05VTV9EUFBfX01BWF07CisJYm9vbCBS
ZXF1aXJlc0RTQ1tEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1
bnNpZ25lZCBpbnQgTnVtYmVyT2ZEU0NTbGljZVtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVtEQ19f
TlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgUmVxdWlyZXNGRUNbRENfX1ZPTFRBR0VfU1RBVEVTICsg
MV1bRENfX05VTV9EUFBfX01BWF07CisJdW5zaWduZWQgaW50IE91dHB1dEJwcFBlclN0YXRlW0RD
X19WT0xUQUdFX1NUQVRFUyArIDFdW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBEU0NEZWxh
eVBlclN0YXRlW0RDX19WT0xUQUdFX1NUQVRFUyArIDFdW0RDX19OVU1fRFBQX19NQVhdOworCWJv
b2wgVmlld3BvcnRTaXplU3VwcG9ydFtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXTsKKwl1bnNpZ25l
ZCBpbnQgUmVhZDI1NkJsb2NrSGVpZ2h0WVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBp
bnQgUmVhZDI1NkJsb2NrV2lkdGhZW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBS
ZWFkMjU2QmxvY2tIZWlnaHRDW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBSZWFk
MjU2QmxvY2tXaWR0aENbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIE1heFN3YXRoSGVpZ2h0
WVtEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgTWF4U3dhdGhIZWlnaHRDW0RDX19OVU1fRFBQ
X19NQVhdOworCWRvdWJsZSBNaW5Td2F0aEhlaWdodFlbRENfX05VTV9EUFBfX01BWF07CisJZG91
YmxlIE1pblN3YXRoSGVpZ2h0Q1tEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgUmVhZEJhbmR3
aWR0aEx1bWFbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIFJlYWRCYW5kd2lkdGhDaHJvbWFb
RENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIFJlYWRCYW5kd2lkdGhbRENfX05VTV9EUFBfX01B
WF07CisJZG91YmxlIFdyaXRlQmFuZHdpZHRoW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBQ
U0NMX0ZBQ1RPUltEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgUFNDTF9GQUNUT1JfQ0hST01B
W0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBNYXhpbXVtVlN0YXJ0dXBbRENfX05VTV9EUFBf
X01BWF07CisJdW5zaWduZWQgaW50IE1hY3JvVGlsZVdpZHRoWVtEQ19fTlVNX0RQUF9fTUFYXTsK
Kwl1bnNpZ25lZCBpbnQgTWFjcm9UaWxlV2lkdGhDW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJs
ZSBBbGlnbmVkRENDTWV0YVBpdGNoW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBBbGlnbmVk
WVBpdGNoW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBBbGlnbmVkQ1BpdGNoW0RDX19OVU1f
RFBQX19NQVhdOworCWRvdWJsZSBNYXhpbXVtU3dhdGhXaWR0aFtEQ19fTlVNX0RQUF9fTUFYXTsK
Kwlkb3VibGUgY3Vyc29yX2J3W0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBjdXJzb3JfYndf
cHJlW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBUbm9fYndbRENfX05VTV9EUFBfX01BWF07
CisJZG91YmxlIHByZWZldGNoX3Ztcm93X2J3W0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBE
ZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JbkltbWVkaWF0ZUZsaXBbRENfX05VTV9EUFBfX01B
WF07CisJZG91YmxlIERlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJbkltbWVkaWF0ZUZsaXBb
RENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIGZpbmFsX2ZsaXBfYndbRENfX05VTV9EUFBfX01B
WF07CisJYm9vbCBJbW1lZGlhdGVGbGlwU3VwcG9ydGVkRm9yU3RhdGVbRENfX1ZPTFRBR0VfU1RB
VEVTICsgMV1bMl07CisJZG91YmxlIFdyaXRlYmFja0RlbGF5W0RDX19WT0xUQUdFX1NUQVRFUyAr
IDFdW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCB2bV9ncm91cF9ieXRlc1tEQ19f
TlVNX0RQUF9fTUFYXTsKKwlsb25nIGRwdGVfZ3JvdXBfYnl0ZXNbRENfX05VTV9EUFBfX01BWF07
CisJdW5zaWduZWQgaW50IGRwdGVfcm93X2hlaWdodFtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNp
Z25lZCBpbnQgbWV0YV9yZXFfaGVpZ2h0W0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGlu
dCBtZXRhX3JlcV93aWR0aFtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgbWV0YV9y
b3dfaGVpZ2h0W0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBtZXRhX3Jvd193aWR0
aFtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgZHB0ZV9yb3dfaGVpZ2h0X2Nocm9t
YVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgbWV0YV9yZXFfaGVpZ2h0X2Nocm9t
YVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgbWV0YV9yZXFfd2lkdGhfY2hyb21h
W0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBtZXRhX3Jvd19oZWlnaHRfY2hyb21h
W0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBtZXRhX3Jvd193aWR0aF9jaHJvbWFb
RENfX05VTV9EUFBfX01BWF07CisJYm9vbCBJbW1lZGlhdGVGbGlwU3VwcG9ydGVkRm9yUGlwZVtE
Q19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgbWV0YV9yb3dfYndbRENfX05VTV9EUFBfX01BWF07
CisJZG91YmxlIGRwdGVfcm93X2J3W0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBEaXNwbGF5
UGlwZUxpbmVEZWxpdmVyeVRpbWVMdW1hW0RDX19OVU1fRFBQX19NQVhdOyAgICAgICAgICAgICAg
ICAgICAgIC8vIFdNCisJZG91YmxlIERpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUNocm9tYVtE
Q19fTlVNX0RQUF9fTUFYXTsgICAgICAgICAgICAgICAgICAgICAvLyBXTQorCWRvdWJsZSBEaXNw
bGF5UGlwZVJlcXVlc3REZWxpdmVyeVRpbWVMdW1hW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJs
ZSBEaXNwbGF5UGlwZVJlcXVlc3REZWxpdmVyeVRpbWVDaHJvbWFbRENfX05VTV9EUFBfX01BWF07
CisJZW51bSBjbG9ja19jaGFuZ2Vfc3VwcG9ydCBEUkFNQ2xvY2tDaGFuZ2VTdXBwb3J0W0RDX19W
T0xUQUdFX1NUQVRFUyArIDFdWzJdOworCWRvdWJsZSBVcmdlbnRCdXJzdEZhY3RvckN1cnNvcltE
Q19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgVXJnZW50QnVyc3RGYWN0b3JDdXJzb3JQcmVbRENf
X05VTV9EUFBfX01BWF07CisJZG91YmxlIFVyZ2VudEJ1cnN0RmFjdG9yTHVtYVtEQ19fTlVNX0RQ
UF9fTUFYXTsKKwlkb3VibGUgVXJnZW50QnVyc3RGYWN0b3JMdW1hUHJlW0RDX19OVU1fRFBQX19N
QVhdOworCWRvdWJsZSBVcmdlbnRCdXJzdEZhY3RvckNocm9tYVtEQ19fTlVNX0RQUF9fTUFYXTsK
Kwlkb3VibGUgVXJnZW50QnVyc3RGYWN0b3JDaHJvbWFQcmVbRENfX05VTV9EUFBfX01BWF07CisK
Kwlib29sICAgICAgICAgICBNUENDb21iaW5lW0RDX19WT0xUQUdFX1NUQVRFUyArIDFdWzJdW0RD
X19OVU1fRFBQX19NQVhdOworCWRvdWJsZSAgICAgICAgIFN3YXRoV2lkdGhDU2luZ2xlRFBQW0RD
X19OVU1fRFBQX19NQVhdOworCWRvdWJsZSAgICAgICAgIE1heGltdW1Td2F0aFdpZHRoSW5MaW5l
QnVmZmVyTHVtYTsKKwlkb3VibGUgICAgICAgICBNYXhpbXVtU3dhdGhXaWR0aEluTGluZUJ1ZmZl
ckNocm9tYTsKKwlkb3VibGUgICAgICAgICBNYXhpbXVtU3dhdGhXaWR0aEx1bWFbRENfX05VTV9E
UFBfX01BWF07CisJZG91YmxlICAgICAgICAgTWF4aW11bVN3YXRoV2lkdGhDaHJvbWFbRENfX05V
TV9EUFBfX01BWF07CisJYm9vbCBvZG1fY29tYmluZV9kdW1teVtEQ19fTlVNX0RQUF9fTUFYXTsK
Kwlkb3VibGUgICAgICAgICBkdW1teTFbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlICAgICAg
ICAgZHVtbXkyW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSAgICAgICAgIGR1bW15M1tEQ19f
TlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgICAgICAgICBkdW1teTRbRENfX05VTV9EUFBfX01BWF07
CisJZG91YmxlICAgICAgICAgZHVtbXk1OworCWRvdWJsZSAgICAgICAgIGR1bW15NjsKKwlkb3Vi
bGUgICAgICAgICBkdW1teTdbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlICAgICAgICAgZHVt
bXk4W0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCAgICAgICAgZHVtbXlpbnRlZ2Vy
MW1zW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCAgICAgICAgZHVtbXlpbnRlZ2Vy
Mm1zW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCAgICAgICAgZHVtbXlpbnRlZ2Vy
M1tEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgICAgICAgIGR1bW15aW50ZWdlcjQ7
CisJdW5zaWduZWQgaW50ICAgICAgICBkdW1teWludGVnZXI1OworCXVuc2lnbmVkIGludCAgICAg
ICAgZHVtbXlpbnRlZ2VyNjsKKwl1bnNpZ25lZCBpbnQgICAgICAgIGR1bW15aW50ZWdlcjc7CisJ
dW5zaWduZWQgaW50ICAgICAgICBkdW1teWludGVnZXI4OworCXVuc2lnbmVkIGludCAgICAgICAg
ZHVtbXlpbnRlZ2VyOTsKKwl1bnNpZ25lZCBpbnQgICAgICAgIGR1bW15aW50ZWdlcjEwOworCXVu
c2lnbmVkIGludCAgICAgICAgZHVtbXlpbnRlZ2VyMTE7CisJdW5zaWduZWQgaW50ICAgICAgICBk
dW1teWludGVnZXIxMjsKKwlib29sICAgICAgICAgICBkdW1teXNpbmdsZXN0cmluZzsKKwlib29s
ICAgICAgICAgICBTaW5nbGVEUFBWaWV3cG9ydFNpemVTdXBwb3J0UGVyUGxhbmVbRENfX05VTV9E
UFBfX01BWF07CisJZG91YmxlICAgICAgICAgUGxhbmVSZXF1aXJlZERJU1BDTEtXaXRoT0RNQ29t
YmluZTJUbzE7CisJZG91YmxlICAgICAgICAgUGxhbmVSZXF1aXJlZERJU1BDTEtXaXRoT0RNQ29t
YmluZTRUbzE7CisJdW5zaWduZWQgaW50ICAgVG90YWxOdW1iZXJPZlNpbmdsZURQUFBsYW5lc1tE
Q19fVk9MVEFHRV9TVEFURVMgKyAxXVsyXTsKKwlib29sICAgICAgICAgICBMaW5rRFNDRW5hYmxl
OworCWJvb2wgICAgICAgICAgIE9ETUNvbWJpbmU0VG8xU3VwcG9ydENoZWNrT0tbRENfX1ZPTFRB
R0VfU1RBVEVTICsgMV07CisJYm9vbCBPRE1Db21iaW5lRW5hYmxlVGhpc1N0YXRlW0RDX19OVU1f
RFBQX19NQVhdOworCWRvdWJsZSAgICAgICAgIFN3YXRoV2lkdGhDVGhpc1N0YXRlW0RDX19OVU1f
RFBQX19NQVhdOworCWJvb2wgICAgICAgICAgIFZpZXdwb3J0U2l6ZVN1cHBvcnRQZXJQbGFuZVtE
Q19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgICAgICAgICBBbGlnbmVkRENDTWV0YVBpdGNoWVtE
Q19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgICAgICAgICBBbGlnbmVkRENDTWV0YVBpdGNoQ1tE
Q19fTlVNX0RQUF9fTUFYXTsKKworCXVuc2lnbmVkIGludCBOb3RFbm91Z2hVcmdlbnRMYXRlbmN5
SGlkaW5nOworCXVuc2lnbmVkIGludCBOb3RFbm91Z2hVcmdlbnRMYXRlbmN5SGlkaW5nUHJlOwor
CWxvbmcgUFRFQnVmZmVyU2l6ZUluUmVxdWVzdHNGb3JMdW1hOworCisJLy8gTWlzc2luZyBmcm9t
IFZCQQorCWxvbmcgZHB0ZV9ncm91cF9ieXRlc19jaHJvbWE7CisJdW5zaWduZWQgaW50IHZtX2dy
b3VwX2J5dGVzX2Nocm9tYTsKKwlkb3VibGUgZHN0X3hfYWZ0ZXJfc2NhbGVyOworCWRvdWJsZSBk
c3RfeV9hZnRlcl9zY2FsZXI7CisJdW5zaWduZWQgaW50IFZTdGFydHVwUmVxdWlyZWRXaGVuTm90
RW5vdWdoVGltZUZvckR5bmFtaWNNZXRhZGF0YTsKKworCS8qIHBlcmYgbG9jYWxzKi8KKwlkb3Vi
bGUgUHJlZmV0Y2hCYW5kd2lkdGhbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIFZJbml0UHJl
RmlsbFlbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIFZJbml0UHJlRmlsbENbRENfX05VTV9E
UFBfX01BWF07CisJdW5zaWduZWQgaW50IE1heE51bVN3YXRoWVtEQ19fTlVNX0RQUF9fTUFYXTsK
Kwl1bnNpZ25lZCBpbnQgTWF4TnVtU3dhdGhDW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVk
IGludCBWU3RhcnR1cFtEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgRFNUWUFmdGVyU2NhbGVy
W0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBEU1RYQWZ0ZXJTY2FsZXJbRENfX05VTV9EUFBf
X01BWF07CisJYm9vbCBBbGxvd0RSQU1DbG9ja0NoYW5nZUR1cmluZ1ZCbGFua1tEQ19fTlVNX0RQ
UF9fTUFYXTsKKwlib29sIEFsbG93RFJBTVNlbGZSZWZyZXNoRHVyaW5nVkJsYW5rW0RDX19OVU1f
RFBQX19NQVhdOworCWRvdWJsZSBWUmF0aW9QcmVmZXRjaFlbRENfX05VTV9EUFBfX01BWF07CisJ
ZG91YmxlIFZSYXRpb1ByZWZldGNoQ1tEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgRGVzdGlu
YXRpb25MaW5lc0ZvclByZWZldGNoW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBEZXN0aW5h
dGlvbkxpbmVzVG9SZXF1ZXN0Vk1JblZCbGFua1tEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUg
RGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rW0RDX19OVU1fRFBQX19NQVhdOwor
CWRvdWJsZSBNaW5UVFVWQmxhbmtbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIEJ5dGVQZXJQ
aXhlbERFVFlbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIEJ5dGVQZXJQaXhlbERFVENbRENf
X05VTV9EUFBfX01BWF07CisJdW5zaWduZWQgaW50IFN3YXRoV2lkdGhZW0RDX19OVU1fRFBQX19N
QVhdOworCXVuc2lnbmVkIGludCBTd2F0aFdpZHRoU2luZ2xlRFBQWVtEQ19fTlVNX0RQUF9fTUFY
XTsKKwlkb3VibGUgQ3Vyc29yUmVxdWVzdERlbGl2ZXJ5VGltZVtEQ19fTlVNX0RQUF9fTUFYXTsK
Kwlkb3VibGUgQ3Vyc29yUmVxdWVzdERlbGl2ZXJ5VGltZVByZWZldGNoW0RDX19OVU1fRFBQX19N
QVhdOworCWRvdWJsZSBSZWFkQmFuZHdpZHRoUGxhbmVMdW1hW0RDX19OVU1fRFBQX19NQVhdOwor
CWRvdWJsZSBSZWFkQmFuZHdpZHRoUGxhbmVDaHJvbWFbRENfX05VTV9EUFBfX01BWF07CisJZG91
YmxlIERpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWFQcmVmZXRjaFtEQ19fTlVNX0RQUF9f
TUFYXTsKKwlkb3VibGUgRGlzcGxheVBpcGVMaW5lRGVsaXZlcnlUaW1lQ2hyb21hUHJlZmV0Y2hb
RENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIERpc3BsYXlQaXBlUmVxdWVzdERlbGl2ZXJ5VGlt
ZUx1bWFQcmVmZXRjaFtEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgRGlzcGxheVBpcGVSZXF1
ZXN0RGVsaXZlcnlUaW1lQ2hyb21hUHJlZmV0Y2hbRENfX05VTV9EUFBfX01BWF07CisJZG91Ymxl
IFBpeGVsUFRFQnl0ZXNQZXJSb3dbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIFBERUFuZE1l
dGFQVEVCeXRlc0ZyYW1lW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBNZXRhUm93Qnl0ZVtE
Q19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgUHJlZmV0Y2hTb3VyY2VMaW5lc1lbRENfX05VTV9E
UFBfX01BWF07CisJZG91YmxlIFJlcXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldMdW1hW0RDX19OVU1f
RFBQX19NQVhdOworCWRvdWJsZSBSZXF1aXJlZFByZWZldGNoUGl4RGF0YUJXQ2hyb21hW0RDX19O
VU1fRFBQX19NQVhdOworCWRvdWJsZSBQcmVmZXRjaFNvdXJjZUxpbmVzQ1tEQ19fTlVNX0RQUF9f
TUFYXTsKKwlkb3VibGUgUFNDTF9USFJPVUdIUFVUX0xVTUFbRENfX05VTV9EUFBfX01BWF07CisJ
ZG91YmxlIFBTQ0xfVEhST1VHSFBVVF9DSFJPTUFbRENfX05VTV9EUFBfX01BWF07CisJZG91Ymxl
IERTQ0NMS19jYWxjdWxhdGVkW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBEU0NE
ZWxheVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgTWF4VlN0YXJ0dXBMaW5lc1tE
Q19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgRFBQQ0xLVXNpbmdTaW5nbGVEUFBbRENfX05VTV9E
UFBfX01BWF07CisJZG91YmxlIERQUENMS1tEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBp
bnQgRENDWU1heFVuY29tcHJlc3NlZEJsb2NrW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVk
IGludCBEQ0NZTWF4Q29tcHJlc3NlZEJsb2NrW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVk
IGludCBEQ0NZSW5kZXBlbmRlbnQ2NEJ5dGVCbG9ja1tEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3Vi
bGUgTWF4aW11bURDQ0NvbXByZXNzaW9uWVN1cmZhY2VbRENfX05VTV9EUFBfX01BWF07CisJdW5z
aWduZWQgaW50IEJsb2NrSGVpZ2h0MjU2Qnl0ZXNZW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2ln
bmVkIGludCBCbG9ja0hlaWdodDI1NkJ5dGVzQ1tEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25l
ZCBpbnQgQmxvY2tXaWR0aDI1NkJ5dGVzWVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBp
bnQgQmxvY2tXaWR0aDI1NkJ5dGVzQ1tEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgWEZDU2xh
dmVWVXBkYXRlT2Zmc2V0W0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBYRkNTbGF2ZVZ1cGRh
dGVXaWR0aFtEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgWEZDU2xhdmVWUmVhZHlPZmZzZXRb
RENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIFhGQ1RyYW5zZmVyRGVsYXlbRENfX05VTV9EUFBf
X01BWF07CisJZG91YmxlIFhGQ1ByZWNoYXJnZURlbGF5W0RDX19OVU1fRFBQX19NQVhdOworCWRv
dWJsZSBYRkNSZW1vdGVTdXJmYWNlRmxpcExhdGVuY3lbRENfX05VTV9EUFBfX01BWF07CisJZG91
YmxlIFhGQ1ByZWZldGNoTWFyZ2luW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBk
cHRlX3Jvd193aWR0aF9sdW1hX3ViW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBk
cHRlX3Jvd193aWR0aF9jaHJvbWFfdWJbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIEZ1bGxE
RVRCdWZmZXJpbmdUaW1lWVtEQ19fTlVNX0RQUF9fTUFYXTsgICAgICAgICAgICAgICAgICAgICAv
LyBXTQorCWRvdWJsZSBGdWxsREVUQnVmZmVyaW5nVGltZUNbRENfX05VTV9EUFBfX01BWF07ICAg
ICAgICAgICAgICAgICAgICAgLy8gV00KKwlkb3VibGUgRFNUX1lfUEVSX1BURV9ST1dfTk9NX0xb
RENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIERTVF9ZX1BFUl9QVEVfUk9XX05PTV9DW0RDX19O
VU1fRFBQX19NQVhdOworCWRvdWJsZSBEU1RfWV9QRVJfTUVUQV9ST1dfTk9NX0xbRENfX05VTV9E
UFBfX01BWF07CisJZG91YmxlIFRpbWVQZXJNZXRhQ2h1bmtOb21pbmFsW0RDX19OVU1fRFBQX19N
QVhdOworCWRvdWJsZSBUaW1lUGVyTWV0YUNodW5rVkJsYW5rW0RDX19OVU1fRFBQX19NQVhdOwor
CWRvdWJsZSBUaW1lUGVyTWV0YUNodW5rRmxpcFtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25l
ZCBpbnQgc3dhdGhfd2lkdGhfbHVtYV91YltEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBp
bnQgc3dhdGhfd2lkdGhfY2hyb21hX3ViW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGlu
dCBQaXhlbFBURVJlcVdpZHRoWVtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgUGl4
ZWxQVEVSZXFIZWlnaHRZW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBQVEVSZXF1
ZXN0U2l6ZVlbRENfX05VTV9EUFBfX01BWF07CisJdW5zaWduZWQgaW50IFBpeGVsUFRFUmVxV2lk
dGhDW0RDX19OVU1fRFBQX19NQVhdOworCXVuc2lnbmVkIGludCBQaXhlbFBURVJlcUhlaWdodENb
RENfX05VTV9EUFBfX01BWF07CisJdW5zaWduZWQgaW50IFBURVJlcXVlc3RTaXplQ1tEQ19fTlVN
X0RQUF9fTUFYXTsKKwlkb3VibGUgdGltZV9wZXJfcHRlX2dyb3VwX25vbV9sdW1hW0RDX19OVU1f
RFBQX19NQVhdOworCWRvdWJsZSB0aW1lX3Blcl9wdGVfZ3JvdXBfbm9tX2Nocm9tYVtEQ19fTlVN
X0RQUF9fTUFYXTsKKwlkb3VibGUgdGltZV9wZXJfcHRlX2dyb3VwX3ZibGFua19sdW1hW0RDX19O
VU1fRFBQX19NQVhdOworCWRvdWJsZSB0aW1lX3Blcl9wdGVfZ3JvdXBfdmJsYW5rX2Nocm9tYVtE
Q19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgdGltZV9wZXJfcHRlX2dyb3VwX2ZsaXBfbHVtYVtE
Q19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgdGltZV9wZXJfcHRlX2dyb3VwX2ZsaXBfY2hyb21h
W0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBUaW1lUGVyVk1Hcm91cFZCbGFua1tEQ19fTlVN
X0RQUF9fTUFYXTsKKwlkb3VibGUgVGltZVBlclZNR3JvdXBGbGlwW0RDX19OVU1fRFBQX19NQVhd
OworCWRvdWJsZSBUaW1lUGVyVk1SZXF1ZXN0VkJsYW5rW0RDX19OVU1fRFBQX19NQVhdOworCWRv
dWJsZSBUaW1lUGVyVk1SZXF1ZXN0RmxpcFtEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBp
bnQgZHBkZTBfYnl0ZXNfcGVyX2ZyYW1lX3ViX2xbRENfX05VTV9EUFBfX01BWF07CisJdW5zaWdu
ZWQgaW50IG1ldGFfcHRlX2J5dGVzX3Blcl9mcmFtZV91Yl9sW0RDX19OVU1fRFBQX19NQVhdOwor
CXVuc2lnbmVkIGludCBkcGRlMF9ieXRlc19wZXJfZnJhbWVfdWJfY1tEQ19fTlVNX0RQUF9fTUFY
XTsKKwl1bnNpZ25lZCBpbnQgbWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1lX3ViX2NbRENfX05VTV9E
UFBfX01BWF07CisJZG91YmxlIExpbmVzVG9GaW5pc2hTd2F0aFRyYW5zZmVyU3R1dHRlckNyaXRp
Y2FsUGxhbmU7CisJdW5zaWduZWQgaW50IEJ5dGVQZXJQaXhlbFlDcml0aWNhbFBsYW5lOworCWRv
dWJsZSBTd2F0aFdpZHRoWUNyaXRpY2FsUGxhbmU7CisJZG91YmxlIExpbmVzSW5ERVRZW0RDX19O
VU1fRFBQX19NQVhdOworCWRvdWJsZSBMaW5lc0luREVUWVJvdW5kZWREb3duVG9Td2F0aFtEQ19f
TlVNX0RQUF9fTUFYXTsKKworCXVuc2lnbmVkIGludCBTd2F0aFdpZHRoU2luZ2xlRFBQQ1tEQ19f
TlVNX0RQUF9fTUFYXTsKKwl1bnNpZ25lZCBpbnQgU3dhdGhXaWR0aENbRENfX05VTV9EUFBfX01B
WF07CisJdW5zaWduZWQgaW50IEJ5dGVQZXJQaXhlbFlbRENfX05VTV9EUFBfX01BWF07CisJdW5z
aWduZWQgaW50IEJ5dGVQZXJQaXhlbENbRENfX05VTV9EUFBfX01BWF07CisJbG9uZyBkdW1teWlu
dGVnZXIxOworCWxvbmcgZHVtbXlpbnRlZ2VyMjsKKwlkb3VibGUgRmluYWxEUkFNQ2xvY2tDaGFu
Z2VMYXRlbmN5OworCWRvdWJsZSBUZG1kbF92bVtEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUg
VGRtZGxbRENfX05VTV9EUFBfX01BWF07CisJdW5zaWduZWQgaW50IFRoaXNWU3RhcnR1cDsKKwli
b29sIFdyaXRlYmFja0FsbG93RFJBTUNsb2NrQ2hhbmdlRW5kUG9zaXRpb25bRENfX05VTV9EUFBf
X01BWF07CisJZG91YmxlIERTVF9ZX1BFUl9NRVRBX1JPV19OT01fQ1tEQ19fTlVNX0RQUF9fTUFY
XTsKKwlkb3VibGUgVGltZVBlckNocm9tYU1ldGFDaHVua05vbWluYWxbRENfX05VTV9EUFBfX01B
WF07CisJZG91YmxlIFRpbWVQZXJDaHJvbWFNZXRhQ2h1bmtWQmxhbmtbRENfX05VTV9EUFBfX01B
WF07CisJZG91YmxlIFRpbWVQZXJDaHJvbWFNZXRhQ2h1bmtGbGlwW0RDX19OVU1fRFBQX19NQVhd
OworCXVuc2lnbmVkIGludCBEQ0NDTWF4VW5jb21wcmVzc2VkQmxvY2tbRENfX05VTV9EUFBfX01B
WF07CisJdW5zaWduZWQgaW50IERDQ0NNYXhDb21wcmVzc2VkQmxvY2tbRENfX05VTV9EUFBfX01B
WF07CisJdW5zaWduZWQgaW50IERDQ0NJbmRlcGVuZGVudDY0Qnl0ZUJsb2NrW0RDX19OVU1fRFBQ
X19NQVhdOworCWRvdWJsZSBWU3RhcnR1cE1hcmdpbjsKKworCS8qIE1pc3NpbmcgZnJvbSBWQkEg
Ki8KKwl1bnNpZ25lZCBpbnQgTWF4aW11bU1heFZTdGFydHVwTGluZXM7CisJZG91YmxlIEZhYnJp
Y0FuZERSQU1CYW5kd2lkdGg7CisJZG91YmxlIExpbmVzSW5ERVRMdW1hOworCWRvdWJsZSBMaW5l
c0luREVUQ2hyb21hOworCXVuc2lnbmVkIGludCBJbW1lZGlhdGVGbGlwQnl0ZXNbRENfX05VTV9E
UFBfX01BWF07CisJdW5zaWduZWQgaW50IExpbmVzSW5ERVRDW0RDX19OVU1fRFBQX19NQVhdOwor
CXVuc2lnbmVkIGludCBMaW5lc0luREVUQ1JvdW5kZWREb3duVG9Td2F0aFtEQ19fTlVNX0RQUF9f
TUFYXTsKKwlkb3VibGUgVXJnZW50TGF0ZW5jeVN1cHBvcnRVc1BlclN0YXRlW0RDX19WT0xUQUdF
X1NUQVRFUyArIDFdWzJdW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBVcmdlbnRMYXRlbmN5
U3VwcG9ydFVzW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBGYWJyaWNBbmREUkFNQmFuZHdp
ZHRoUGVyU3RhdGVbRENfX1ZPTFRBR0VfU1RBVEVTICsgMV07CisJYm9vbCBVcmdlbnRMYXRlbmN5
U3VwcG9ydFtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVsyXTsKKwl1bnNpZ25lZCBpbnQgU3dhdGhX
aWR0aFlQZXJTdGF0ZVtEQ19fVk9MVEFHRV9TVEFURVMgKyAxXVsyXVtEQ19fTlVNX0RQUF9fTUFY
XTsKKwl1bnNpZ25lZCBpbnQgU3dhdGhIZWlnaHRZUGVyU3RhdGVbRENfX1ZPTFRBR0VfU1RBVEVT
ICsgMV1bMl1bRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIHF1YWxfcm93X2J3W0RDX19OVU1f
RFBQX19NQVhdOworCWRvdWJsZSBwcmVmZXRjaF9yb3dfYndbRENfX05VTV9EUFBfX01BWF07CisJ
ZG91YmxlIHByZWZldGNoX3ZtX2J3W0RDX19OVU1fRFBQX19NQVhdOworCisJZG91YmxlIFBURUdy
b3VwU2l6ZTsKKwl1bnNpZ25lZCBpbnQgUERFUHJvY2Vzc2luZ0J1ZkluNjRLQlJlcXM7CisKKwlk
b3VibGUgTWF4VG90YWxWQWN0aXZlUkRCYW5kd2lkdGg7CisJZG91YmxlIE1pblVyZ2VudExhdGVu
Y3lTdXBwb3J0VXM7CisJZG91YmxlIE1pbkZ1bGxERVRCdWZmZXJpbmdUaW1lOworCWRvdWJsZSBB
dmVyYWdlUmVhZEJhbmR3aWR0aEdCeXRlUGVyU2Vjb25kOworCWJvb2wgICBGaXJzdE1haW5QbGFu
ZTsKKworCXVuc2lnbmVkIGludCBWaWV3cG9ydFdpZHRoQ2hyb21hW0RDX19OVU1fRFBQX19NQVhd
OworCXVuc2lnbmVkIGludCBWaWV3cG9ydEhlaWdodENocm9tYVtEQ19fTlVNX0RQUF9fTUFYXTsK
Kwlkb3VibGUgSFJhdGlvQ2hyb21hW0RDX19OVU1fRFBQX19NQVhdOworCWRvdWJsZSBWUmF0aW9D
aHJvbWFbRENfX05VTV9EUFBfX01BWF07CisJbG9uZyBXcml0ZWJhY2tTb3VyY2VXaWR0aFtEQ19f
TlVNX0RQUF9fTUFYXTsKKworCWJvb2wgTW9kZUlzU3VwcG9ydGVkOworCWJvb2wgT0RNQ29tYmlu
ZTRUbzFTdXBwb3J0ZWQ7CisKKwl1bnNpZ25lZCBpbnQgU3VyZmFjZUhlaWdodFlbRENfX05VTV9E
UFBfX01BWF07CisJdW5zaWduZWQgaW50IFN1cmZhY2VIZWlnaHRDW0RDX19OVU1fRFBQX19NQVhd
OworCXVuc2lnbmVkIGludCBXcml0ZWJhY2tIVGFwc1tEQ19fTlVNX0RQUF9fTUFYXTsKKwl1bnNp
Z25lZCBpbnQgV3JpdGViYWNrVlRhcHNbRENfX05VTV9EUFBfX01BWF07CisJYm9vbCBEU0NFbmFi
bGVbRENfX05VTV9EUFBfX01BWF07CisKKwlkb3VibGUgRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU92
ZXJyaWRlOworCisJZG91YmxlIEdQVVZNTWluUGFnZVNpemU7CisJZG91YmxlIEhvc3RWTU1pblBh
Z2VTaXplOworCisJYm9vbCAgIE1QQ0NvbWJpbmVFbmFibGVbRENfX05VTV9EUFBfX01BWF07CisJ
dW5zaWduZWQgaW50IEhvc3RWTU1heE5vbkNhY2hlZFBhZ2VUYWJsZUxldmVsczsKKwlib29sICAg
RHluYW1pY01ldGFkYXRhVk1FbmFibGVkOworCWRvdWJsZSAgICAgICBXcml0ZWJhY2tJbnRlcmZh
Y2VCdWZmZXJTaXplOworCWRvdWJsZSAgICAgICBXcml0ZWJhY2tMaW5lQnVmZmVyU2l6ZTsKKwor
CWRvdWJsZSBEQ0NSYXRlTHVtYVtEQ19fTlVNX0RQUF9fTUFYXTsKKwlkb3VibGUgRENDUmF0ZUNo
cm9tYVtEQ19fTlVNX0RQUF9fTUFYXTsKKworCWRvdWJsZSBQSFlDTEtEMThQZXJTdGF0ZVtEQ19f
Vk9MVEFHRV9TVEFURVMgKyAxXTsKKwlpbnQgTWluVm9sdGFnZUxldmVsOworCWludCBNYXhWb2x0
YWdlTGV2ZWw7CisKKwlib29sIFdyaXRlYmFja1N1cHBvcnRJbnRlcmxlYXZlQW5kVXNpbmdXaG9s
ZUJ1ZmZlckZvckFTaW5nbGVTdHJlYW07CisJYm9vbCBOdW1iZXJPZkhETUlGUkxTdXBwb3J0Owor
CXVuc2lnbmVkIGludCBNYXhOdW1IRE1JRlJMT3V0cHV0czsKKwlpbnQgICAgQXVkaW9TYW1wbGVS
YXRlW0RDX19OVU1fRFBQX19NQVhdOworCWludCAgICBBdWRpb1NhbXBsZUxheW91dFtEQ19fTlVN
X0RQUF9fTUFYXTsKK307CisKK2Jvb2wgQ2FsY3VsYXRlTWluQW5kTWF4UHJlZmV0Y2hNb2RlKAor
CQllbnVtIHNlbGZfcmVmcmVzaF9hZmZpbml0eSBBbGxvd0RSQU1TZWxmUmVmcmVzaE9yRFJBTUNs
b2NrQ2hhbmdlSW5WYmxhbmssCisJCXVuc2lnbmVkIGludCAqTWluUHJlZmV0Y2hNb2RlLAorCQl1
bnNpZ25lZCBpbnQgKk1heFByZWZldGNoTW9kZSk7CisKK2RvdWJsZSBDYWxjdWxhdGVXcml0ZUJh
Y2tESVNQQ0xLKAorCQllbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MgV3JpdGViYWNrUGl4ZWxGb3Jt
YXQsCisJCWRvdWJsZSBQaXhlbENsb2NrLAorCQlkb3VibGUgV3JpdGViYWNrSFJhdGlvLAorCQlk
b3VibGUgV3JpdGViYWNrVlJhdGlvLAorCQl1bnNpZ25lZCBpbnQgV3JpdGViYWNrTHVtYUhUYXBz
LAorCQl1bnNpZ25lZCBpbnQgV3JpdGViYWNrTHVtYVZUYXBzLAorCQl1bnNpZ25lZCBpbnQgV3Jp
dGViYWNrQ2hyb21hSFRhcHMsCisJCXVuc2lnbmVkIGludCBXcml0ZWJhY2tDaHJvbWFWVGFwcywK
KwkJZG91YmxlIFdyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGgsCisJCXVuc2lnbmVkIGludCBIVG90
YWwsCisJCXVuc2lnbmVkIGludCBXcml0ZWJhY2tDaHJvbWFMaW5lQnVmZmVyV2lkdGgpOworCisj
ZW5kaWYgLyogX0RNTDJfRElTUExBWV9NT0RFX1ZCQV9IXyAqLwotLSAKMi4yMC4xCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxpbmcg
bGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNr
dG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
