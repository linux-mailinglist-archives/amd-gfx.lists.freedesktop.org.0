Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C26FC3800D
	for <lists+amd-gfx@lfdr.de>; Thu,  6 Jun 2019 23:56:33 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 34887899BE;
	Thu,  6 Jun 2019 21:56:32 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM01-SN1-obe.outbound.protection.outlook.com
 (mail-eopbgr820071.outbound.protection.outlook.com [40.107.82.71])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5EAF2899BE
 for <amd-gfx@lists.freedesktop.org>; Thu,  6 Jun 2019 21:56:31 +0000 (UTC)
Received: from DM6PR12MB3947.namprd12.prod.outlook.com (10.255.174.156) by
 DM6PR12MB3370.namprd12.prod.outlook.com (20.178.198.25) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1965.12; Thu, 6 Jun 2019 21:56:29 +0000
Received: from DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::5964:8c3c:1b5b:c480]) by DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::5964:8c3c:1b5b:c480%2]) with mapi id 15.20.1965.011; Thu, 6 Jun 2019
 21:56:29 +0000
From: "Kuehling, Felix" <Felix.Kuehling@amd.com>
To: "Zeng, Oak" <Oak.Zeng@amd.com>, "amd-gfx@lists.freedesktop.org"
 <amd-gfx@lists.freedesktop.org>
Subject: Re: [PATCH 4/6] drm/amdkfd: Separate mqd allocation and initialization
Thread-Topic: [PATCH 4/6] drm/amdkfd: Separate mqd allocation and
 initialization
Thread-Index: AQHVHLB/Te5ecassikKIqS4azVZPE6aPK/mA
Date: Thu, 6 Jun 2019 21:56:29 +0000
Message-ID: <99043cbc-b831-af05-fd24-8558789b6365@amd.com>
References: <1559857240-6854-1-git-send-email-Oak.Zeng@amd.com>
In-Reply-To: <1559857240-6854-1-git-send-email-Oak.Zeng@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [165.204.55.251]
user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.0
x-clientproxiedby: YTXPR0101CA0049.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:1::26) To DM6PR12MB3947.namprd12.prod.outlook.com
 (2603:10b6:5:1cb::28)
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 33b42e6d-4336-417b-f2a5-08d6eac9d450
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);
 SRVR:DM6PR12MB3370; 
x-ms-traffictypediagnostic: DM6PR12MB3370:
x-microsoft-antispam-prvs: <DM6PR12MB3370AF57303CE6ECB38A565D92170@DM6PR12MB3370.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:4125;
x-forefront-prvs: 00603B7EEF
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(376002)(39860400002)(346002)(136003)(396003)(366004)(189003)(199004)(51234002)(99286004)(58126008)(8936002)(76176011)(229853002)(66556008)(64756008)(6486002)(110136005)(25786009)(68736007)(6116002)(36756003)(66946007)(486006)(2906002)(66476007)(4326008)(66446008)(31686004)(65806001)(446003)(66066001)(65956001)(476003)(6246003)(2616005)(52116002)(11346002)(73956011)(316002)(86362001)(6512007)(81166006)(53946003)(72206003)(54906003)(6436002)(71190400001)(65826007)(71200400001)(64126003)(53936002)(305945005)(81156014)(186003)(6506007)(386003)(102836004)(2501003)(26005)(30864003)(53546011)(7736002)(8676002)(478600001)(3846002)(256004)(31696002)(5660300002)(14454004)(14444005)(559001)(569006);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM6PR12MB3370;
 H:DM6PR12MB3947.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: DmKiS2IRcWL/Ld4BQe6OiFdKZIlirmpv6OThdWmX68Qq4yRbHfvh2dU1IoqVErP0wK+Cn7uKgmJWMgjTTeujkZul+keDt0wLKDJJnKVHdyz18oP2zhDHvQGtt7Zo4Ng9/4zBO1sZFFRbrx6fMaMkeWFrzYBqje1s4hifn0qSwzabvddtxq/plhsjtAOAWYIge2KFlIZcgo/IOphrW9U6P6cyLCweaerARco35EDxJq/SvjyrCJBmjeyHRlQ7RRrGsHX4f7PHr2dOdnPw1F9MbKZC8+jodjWer1WE710siWma9FFGxCxvqxqVxGEtscpY8H1tK4cOIHAHu9p4fJi1wagk/09BBf60emX5hCCgQgZ46znnRmP6sC87Nr/Cmlxq8yqnmysSOXkOlrTU9BOeiI7iPjdOkRsUl/fGZ51pOsY=
Content-ID: <C21569FF4C6018429E300FD379230764@namprd12.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 33b42e6d-4336-417b-f2a5-08d6eac9d450
X-MS-Exchange-CrossTenant-originalarrivaltime: 06 Jun 2019 21:56:29.2983 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: fkuehlin@amd.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB3370
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=512prO+VtO3UABiprkA001C/JJnoXo+ICAUrgFdsE8I=;
 b=0AnPa4QkyOmg8IzjeZsJ4x3t2i47ilA37LrYHQqh0F7z3Cj1MeK+CbRXonPAXnYu02/RN45tU8mI78eWwhiJVeeoZL7vP75TpfAx7xF9PnoD1EVEP8DiYtYavAtsDw2FccgGldcdTvEefw80nCu+uyxAoWqsuKznF/jzwBZs2JU=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Felix.Kuehling@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Zhao, Yong" <Yong.Zhao@amd.com>, "Freehill,
 Chris" <Chris.Freehill@amd.com>, "Liu, Alex" <Alex.Liu@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

T24gMjAxOS0wNi0wNiA1OjQwIHAubS4sIFplbmcsIE9hayB3cm90ZToNCj4gSW50cm9kdWNlIGEg
bmV3IG1xZCBhbGxvY2F0aW9uIGludGVyZmFjZSBhbmQgc3BsaXQgdGhlIG9yaWdpbmFsDQo+IGlu
aXRfbXFkIGZ1bmN0aW9uIGludG8gdHdvIGZ1bmN0aW9uczogYWxsb2NhdGVfbXFkIGFuZCBpbml0
X21xZC4NCj4gQWxzbyByZW5hbWVkIHVuaW5pdF9tcWQgdG8gZnJlZV9tcWQuIFRoaXMgaXMgcHJl
cGFyYXRpb24gd29yayB0bw0KPiBmaXggYSBjaXJjdWxhciBsb2NrIGRlcGVuZGVuY3kuDQo+DQo+
IENoYW5nZS1JZDogSTI2ZTUzZWUxYWJjZGQ2ODhhZDExZDM1YjQzM2RhNzdlM2ZhMWJlZTcNCj4g
U2lnbmVkLW9mZi1ieTogT2FrIFplbmcgPE9hay5aZW5nQGFtZC5jb20+DQoNClJldmlld2VkLWJ5
OiBGZWxpeCBLdWVobGluZyA8RmVsaXguS3VlaGxpbmdAYW1kLmNvbT4NCg0KDQo+IC0tLQ0KPiAg
IC4uLi9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmMgIHwgNDAg
KysrKystLS0tLQ0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9rZXJuZWxfcXVl
dWUuYyAgICAgIHwgMTYgKystLQ0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9t
cWRfbWFuYWdlci5jICAgICAgIHwgIDQgKy0NCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtm
ZC9rZmRfbXFkX21hbmFnZXIuaCAgICAgICB8IDE4ICsrKy0tDQo+ICAgZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRrZmQva2ZkX21xZF9tYW5hZ2VyX2Npay5jICAgfCA3OCArKysrKysrLS0tLS0tLS0t
LS0tDQo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX21xZF9tYW5hZ2VyX3Y5LmMg
ICAgfCA3OCArKysrKysrLS0tLS0tLS0tLS0tDQo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRr
ZmQva2ZkX21xZF9tYW5hZ2VyX3ZpLmMgICAgfCA4OCArKysrKysrKy0tLS0tLS0tLS0tLS0tDQo+
ICAgNyBmaWxlcyBjaGFuZ2VkLCAxMjkgaW5zZXJ0aW9ucygrKSwgMTkzIGRlbGV0aW9ucygtKQ0K
Pg0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZV9x
dWV1ZV9tYW5hZ2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfZGV2aWNlX3F1
ZXVlX21hbmFnZXIuYw0KPiBpbmRleCAzYzA0MmViLi5lNWIzZmI5IDEwMDY0NA0KPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfZGV2aWNlX3F1ZXVlX21hbmFnZXIuYw0KPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfZGV2aWNlX3F1ZXVlX21hbmFnZXIu
Yw0KPiBAQCAtMzE5LDExICszMTksMTMgQEAgc3RhdGljIGludCBjcmVhdGVfcXVldWVfbm9jcHNj
aChzdHJ1Y3QgZGV2aWNlX3F1ZXVlX21hbmFnZXIgKmRxbSwNCj4gICAJaWYgKHJldHZhbCkNCj4g
ICAJCWdvdG8gb3V0X2RlYWxsb2NhdGVfaHFkOw0KPiAgIA0KPiAtCXJldHZhbCA9IG1xZF9tZ3It
PmluaXRfbXFkKG1xZF9tZ3IsICZxLT5tcWQsICZxLT5tcWRfbWVtX29iaiwNCj4gLQkJCQkmcS0+
Z2FydF9tcWRfYWRkciwgJnEtPnByb3BlcnRpZXMpOw0KPiAtCWlmIChyZXR2YWwpDQo+ICsJcS0+
bXFkX21lbV9vYmogPSBtcWRfbWdyLT5hbGxvY2F0ZV9tcWQobXFkX21nci0+ZGV2LCAmcS0+cHJv
cGVydGllcyk7DQo+ICsJaWYgKCFxLT5tcWRfbWVtX29iaikgew0KPiArCQlyZXR2YWwgPSAtRU5P
TUVNOw0KPiAgIAkJZ290byBvdXRfZGVhbGxvY2F0ZV9kb29yYmVsbDsNCj4gLQ0KPiArCX0NCj4g
KwltcWRfbWdyLT5pbml0X21xZChtcWRfbWdyLCAmcS0+bXFkLCBxLT5tcWRfbWVtX29iaiwNCj4g
KwkJCQkmcS0+Z2FydF9tcWRfYWRkciwgJnEtPnByb3BlcnRpZXMpOw0KPiAgIAlpZiAocS0+cHJv
cGVydGllcy5pc19hY3RpdmUpIHsNCj4gICANCj4gICAJCWlmIChXQVJOKHEtPnByb2Nlc3MtPm1t
ICE9IGN1cnJlbnQtPm1tLA0KPiBAQCAtMzMzLDcgKzMzNSw3IEBAIHN0YXRpYyBpbnQgY3JlYXRl
X3F1ZXVlX25vY3BzY2goc3RydWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0sDQo+ICAgCQkJ
cmV0dmFsID0gbXFkX21nci0+bG9hZF9tcWQobXFkX21nciwgcS0+bXFkLCBxLT5waXBlLA0KPiAg
IAkJCQkJcS0+cXVldWUsICZxLT5wcm9wZXJ0aWVzLCBjdXJyZW50LT5tbSk7DQo+ICAgCQlpZiAo
cmV0dmFsKQ0KPiAtCQkJZ290byBvdXRfdW5pbml0X21xZDsNCj4gKwkJCWdvdG8gb3V0X2ZyZWVf
bXFkOw0KPiAgIAl9DQo+ICAgDQo+ICAgCWxpc3RfYWRkKCZxLT5saXN0LCAmcXBkLT5xdWV1ZXNf
bGlzdCk7DQo+IEBAIC0zNTUsOCArMzU3LDggQEAgc3RhdGljIGludCBjcmVhdGVfcXVldWVfbm9j
cHNjaChzdHJ1Y3QgZGV2aWNlX3F1ZXVlX21hbmFnZXIgKmRxbSwNCj4gICAJCQlkcW0tPnRvdGFs
X3F1ZXVlX2NvdW50KTsNCj4gICAJZ290byBvdXRfdW5sb2NrOw0KPiAgIA0KPiAtb3V0X3VuaW5p
dF9tcWQ6DQo+IC0JbXFkX21nci0+dW5pbml0X21xZChtcWRfbWdyLCBxLT5tcWQsIHEtPm1xZF9t
ZW1fb2JqKTsNCj4gK291dF9mcmVlX21xZDoNCj4gKwltcWRfbWdyLT5mcmVlX21xZChtcWRfbWdy
LCBxLT5tcWQsIHEtPm1xZF9tZW1fb2JqKTsNCj4gICBvdXRfZGVhbGxvY2F0ZV9kb29yYmVsbDoN
Cj4gICAJZGVhbGxvY2F0ZV9kb29yYmVsbChxcGQsIHEpOw0KPiAgIG91dF9kZWFsbG9jYXRlX2hx
ZDoNCj4gQEAgLTQ1MCw3ICs0NTIsNyBAQCBzdGF0aWMgaW50IGRlc3Ryb3lfcXVldWVfbm9jcHNj
aF9sb2NrZWQoc3RydWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0sDQo+ICAgCWlmIChyZXR2
YWwgPT0gLUVUSU1FKQ0KPiAgIAkJcXBkLT5yZXNldF93YXZlZnJvbnRzID0gdHJ1ZTsNCj4gICAN
Cj4gLQltcWRfbWdyLT51bmluaXRfbXFkKG1xZF9tZ3IsIHEtPm1xZCwgcS0+bXFkX21lbV9vYmop
Ow0KPiArCW1xZF9tZ3ItPmZyZWVfbXFkKG1xZF9tZ3IsIHEtPm1xZCwgcS0+bXFkX21lbV9vYmop
Ow0KPiAgIA0KPiAgIAlsaXN0X2RlbCgmcS0+bGlzdCk7DQo+ICAgCWlmIChsaXN0X2VtcHR5KCZx
cGQtPnF1ZXVlc19saXN0KSkgew0KPiBAQCAtNDg5LDcgKzQ5MSw3IEBAIHN0YXRpYyBpbnQgZGVz
dHJveV9xdWV1ZV9ub2Nwc2NoKHN0cnVjdCBkZXZpY2VfcXVldWVfbWFuYWdlciAqZHFtLA0KPiAg
IA0KPiAgIHN0YXRpYyBpbnQgdXBkYXRlX3F1ZXVlKHN0cnVjdCBkZXZpY2VfcXVldWVfbWFuYWdl
ciAqZHFtLCBzdHJ1Y3QgcXVldWUgKnEpDQo+ICAgew0KPiAtCWludCByZXR2YWw7DQo+ICsJaW50
IHJldHZhbCA9IDA7DQo+ICAgCXN0cnVjdCBtcWRfbWFuYWdlciAqbXFkX21ncjsNCj4gICAJc3Ry
dWN0IGtmZF9wcm9jZXNzX2RldmljZSAqcGRkOw0KPiAgIAlib29sIHByZXZfYWN0aXZlID0gZmFs
c2U7DQo+IEBAIC01MjcsNyArNTI5LDcgQEAgc3RhdGljIGludCB1cGRhdGVfcXVldWUoc3RydWN0
IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0sIHN0cnVjdCBxdWV1ZSAqcSkNCj4gICAJCX0NCj4g
ICAJfQ0KPiAgIA0KPiAtCXJldHZhbCA9IG1xZF9tZ3ItPnVwZGF0ZV9tcWQobXFkX21nciwgcS0+
bXFkLCAmcS0+cHJvcGVydGllcyk7DQo+ICsJbXFkX21nci0+dXBkYXRlX21xZChtcWRfbWdyLCBx
LT5tcWQsICZxLT5wcm9wZXJ0aWVzKTsNCj4gICANCj4gICAJLyoNCj4gICAJICogY2hlY2sgYWN0
aXZlIHN0YXRlIHZzLiB0aGUgcHJldmlvdXMgc3RhdGUgYW5kIG1vZGlmeQ0KPiBAQCAtMTE2MCwx
MSArMTE2MiwxMyBAQCBzdGF0aWMgaW50IGNyZWF0ZV9xdWV1ZV9jcHNjaChzdHJ1Y3QgZGV2aWNl
X3F1ZXVlX21hbmFnZXIgKmRxbSwgc3RydWN0IHF1ZXVlICpxLA0KPiAgIAkJZHFtLT5hc2ljX29w
cy5pbml0X3NkbWFfdm0oZHFtLCBxLCBxcGQpOw0KPiAgIAlxLT5wcm9wZXJ0aWVzLnRiYV9hZGRy
ID0gcXBkLT50YmFfYWRkcjsNCj4gICAJcS0+cHJvcGVydGllcy50bWFfYWRkciA9IHFwZC0+dG1h
X2FkZHI7DQo+IC0JcmV0dmFsID0gbXFkX21nci0+aW5pdF9tcWQobXFkX21nciwgJnEtPm1xZCwg
JnEtPm1xZF9tZW1fb2JqLA0KPiAtCQkJCSZxLT5nYXJ0X21xZF9hZGRyLCAmcS0+cHJvcGVydGll
cyk7DQo+IC0JaWYgKHJldHZhbCkNCj4gKwlxLT5tcWRfbWVtX29iaiA9IG1xZF9tZ3ItPmFsbG9j
YXRlX21xZChtcWRfbWdyLT5kZXYsICZxLT5wcm9wZXJ0aWVzKTsNCj4gKwlpZiAoIXEtPm1xZF9t
ZW1fb2JqKSB7DQo+ICsJCXJldHZhbCA9IC1FTk9NRU07DQo+ICAgCQlnb3RvIG91dF9kZWFsbG9j
YXRlX2Rvb3JiZWxsOw0KPiAtDQo+ICsJfQ0KPiArCW1xZF9tZ3ItPmluaXRfbXFkKG1xZF9tZ3Is
ICZxLT5tcWQsIHEtPm1xZF9tZW1fb2JqLA0KPiArCQkJCSZxLT5nYXJ0X21xZF9hZGRyLCAmcS0+
cHJvcGVydGllcyk7DQo+ICAgCWRxbV9sb2NrKGRxbSk7DQo+ICAgDQo+ICAgCWxpc3RfYWRkKCZx
LT5saXN0LCAmcXBkLT5xdWV1ZXNfbGlzdCk7DQo+IEBAIC0xMzczLDggKzEzNzcsOCBAQCBzdGF0
aWMgaW50IGRlc3Ryb3lfcXVldWVfY3BzY2goc3RydWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpk
cW0sDQo+ICAgDQo+ICAgCWRxbV91bmxvY2soZHFtKTsNCj4gICANCj4gLQkvKiBEbyB1bmluaXRf
bXFkIGFmdGVyIGRxbV91bmxvY2soZHFtKSB0byBhdm9pZCBjaXJjdWxhciBsb2NraW5nICovDQo+
IC0JbXFkX21nci0+dW5pbml0X21xZChtcWRfbWdyLCBxLT5tcWQsIHEtPm1xZF9tZW1fb2JqKTsN
Cj4gKwkvKiBEbyBmcmVlX21xZCBhZnRlciBkcW1fdW5sb2NrKGRxbSkgdG8gYXZvaWQgY2lyY3Vs
YXIgbG9ja2luZyAqLw0KPiArCW1xZF9tZ3ItPmZyZWVfbXFkKG1xZF9tZ3IsIHEtPm1xZCwgcS0+
bXFkX21lbV9vYmopOw0KPiAgIA0KPiAgIAlyZXR1cm4gcmV0dmFsOw0KPiAgIA0KPiBAQCAtMTYx
NSwxNCArMTYxOSwxNCBAQCBzdGF0aWMgaW50IHByb2Nlc3NfdGVybWluYXRpb25fY3BzY2goc3Ry
dWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0sDQo+ICAgCQlrZmRfZGVjX2NvbXB1dGVfYWN0
aXZlKGRxbS0+ZGV2KTsNCj4gICANCj4gICAJLyogTGFzdGx5LCBmcmVlIG1xZCByZXNvdXJjZXMu
DQo+IC0JICogRG8gdW5pbml0X21xZCgpIGFmdGVyIGRxbV91bmxvY2sgdG8gYXZvaWQgY2lyY3Vs
YXIgbG9ja2luZy4NCj4gKwkgKiBEbyBmcmVlX21xZCgpIGFmdGVyIGRxbV91bmxvY2sgdG8gYXZv
aWQgY2lyY3VsYXIgbG9ja2luZy4NCj4gICAJICovDQo+ICAgCWxpc3RfZm9yX2VhY2hfZW50cnlf
c2FmZShxLCBuZXh0LCAmcXBkLT5xdWV1ZXNfbGlzdCwgbGlzdCkgew0KPiAgIAkJbXFkX21nciA9
IGRxbS0+bXFkX21ncnNbZ2V0X21xZF90eXBlX2Zyb21fcXVldWVfdHlwZSgNCj4gICAJCQkJcS0+
cHJvcGVydGllcy50eXBlKV07DQo+ICAgCQlsaXN0X2RlbCgmcS0+bGlzdCk7DQo+ICAgCQlxcGQt
PnF1ZXVlX2NvdW50LS07DQo+IC0JCW1xZF9tZ3ItPnVuaW5pdF9tcWQobXFkX21nciwgcS0+bXFk
LCBxLT5tcWRfbWVtX29iaik7DQo+ICsJCW1xZF9tZ3ItPmZyZWVfbXFkKG1xZF9tZ3IsIHEtPm1x
ZCwgcS0+bXFkX21lbV9vYmopOw0KPiAgIAl9DQo+ICAgDQo+ICAgCXJldHVybiByZXR2YWw7DQo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVl
LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVlLmMNCj4gaW5k
ZXggMWNjMDNiMy4uMjI5NTAwYyAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRrZmQva2ZkX2tlcm5lbF9xdWV1ZS5jDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
a2ZkL2tmZF9rZXJuZWxfcXVldWUuYw0KPiBAQCAtMTMyLDEzICsxMzIsMTQgQEAgc3RhdGljIGJv
b2wgaW5pdGlhbGl6ZShzdHJ1Y3Qga2VybmVsX3F1ZXVlICprcSwgc3RydWN0IGtmZF9kZXYgKmRl
diwNCj4gICAJa3EtPnF1ZXVlLT5kZXZpY2UgPSBkZXY7DQo+ICAgCWtxLT5xdWV1ZS0+cHJvY2Vz
cyA9IGtmZF9nZXRfcHJvY2VzcyhjdXJyZW50KTsNCj4gICANCj4gLQlyZXR2YWwgPSBrcS0+bXFk
X21nci0+aW5pdF9tcWQoa3EtPm1xZF9tZ3IsICZrcS0+cXVldWUtPm1xZCwNCj4gLQkJCQkJJmtx
LT5xdWV1ZS0+bXFkX21lbV9vYmosDQo+ICsJa3EtPnF1ZXVlLT5tcWRfbWVtX29iaiA9IGtxLT5t
cWRfbWdyLT5hbGxvY2F0ZV9tcWQoa3EtPm1xZF9tZ3ItPmRldiwNCj4gKwkJCQkJJmtxLT5xdWV1
ZS0+cHJvcGVydGllcyk7DQo+ICsJaWYgKCFrcS0+cXVldWUtPm1xZF9tZW1fb2JqKQ0KPiArCQln
b3RvIGVycl9hbGxvY2F0ZV9tcWQ7DQo+ICsJa3EtPm1xZF9tZ3ItPmluaXRfbXFkKGtxLT5tcWRf
bWdyLCAma3EtPnF1ZXVlLT5tcWQsDQo+ICsJCQkJCWtxLT5xdWV1ZS0+bXFkX21lbV9vYmosDQo+
ICAgCQkJCQkma3EtPnF1ZXVlLT5nYXJ0X21xZF9hZGRyLA0KPiAgIAkJCQkJJmtxLT5xdWV1ZS0+
cHJvcGVydGllcyk7DQo+IC0JaWYgKHJldHZhbCAhPSAwKQ0KPiAtCQlnb3RvIGVycl9pbml0X21x
ZDsNCj4gLQ0KPiAgIAkvKiBhc3NpZ24gSElRIHRvIEhRRCAqLw0KPiAgIAlpZiAodHlwZSA9PSBL
RkRfUVVFVUVfVFlQRV9ISVEpIHsNCj4gICAJCXByX2RlYnVnKCJBc3NpZ25pbmcgaGlxIHRvIGhx
ZFxuIik7DQo+IEBAIC0xNjQsNyArMTY1LDggQEAgc3RhdGljIGJvb2wgaW5pdGlhbGl6ZShzdHJ1
Y3Qga2VybmVsX3F1ZXVlICprcSwgc3RydWN0IGtmZF9kZXYgKmRldiwNCj4gICANCj4gICAJcmV0
dXJuIHRydWU7DQo+ICAgZXJyX2FsbG9jX2ZlbmNlOg0KPiAtZXJyX2luaXRfbXFkOg0KPiArCWtx
LT5tcWRfbWdyLT5mcmVlX21xZChrcS0+bXFkX21nciwga3EtPnF1ZXVlLT5tcWQsIGtxLT5xdWV1
ZS0+bXFkX21lbV9vYmopOw0KPiArZXJyX2FsbG9jYXRlX21xZDoNCj4gICAJdW5pbml0X3F1ZXVl
KGtxLT5xdWV1ZSk7DQo+ICAgZXJyX2luaXRfcXVldWU6DQo+ICAgCWtmZF9ndHRfc2FfZnJlZShk
ZXYsIGtxLT53cHRyX21lbSk7DQo+IEBAIC0xOTMsNyArMTk1LDcgQEAgc3RhdGljIHZvaWQgdW5p
bml0aWFsaXplKHN0cnVjdCBrZXJuZWxfcXVldWUgKmtxKQ0KPiAgIAllbHNlIGlmIChrcS0+cXVl
dWUtPnByb3BlcnRpZXMudHlwZSA9PSBLRkRfUVVFVUVfVFlQRV9ESVEpDQo+ICAgCQlrZmRfZ3R0
X3NhX2ZyZWUoa3EtPmRldiwga3EtPmZlbmNlX21lbV9vYmopOw0KPiAgIA0KPiAtCWtxLT5tcWRf
bWdyLT51bmluaXRfbXFkKGtxLT5tcWRfbWdyLCBrcS0+cXVldWUtPm1xZCwNCj4gKwlrcS0+bXFk
X21nci0+ZnJlZV9tcWQoa3EtPm1xZF9tZ3IsIGtxLT5xdWV1ZS0+bXFkLA0KPiAgIAkJCQlrcS0+
cXVldWUtPm1xZF9tZW1fb2JqKTsNCj4gICANCj4gICAJa2ZkX2d0dF9zYV9mcmVlKGtxLT5kZXYs
IGtxLT5ycHRyX21lbSk7DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtm
ZC9rZmRfbXFkX21hbmFnZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9tcWRf
bWFuYWdlci5jDQo+IGluZGV4IGNjMDRiMzYyLi5kNmNmMzkxIDEwMDY0NA0KPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXIuYw0KPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXIuYw0KPiBAQCAtNDUsNyArNDUsNyBA
QCBpbnQgcGlwZV9wcmlvcml0eV9tYXBbXSA9IHsNCj4gICAJS0ZEX1BJUEVfUFJJT1JJVFlfQ1Nf
SElHSA0KPiAgIH07DQo+ICAgDQo+IC1zdHJ1Y3Qga2ZkX21lbV9vYmogKmFsbG9jYXRlX2hpcV9t
cWQoc3RydWN0IGtmZF9kZXYgKmRldikNCj4gK3N0cnVjdCBrZmRfbWVtX29iaiAqYWxsb2NhdGVf
aGlxX21xZChzdHJ1Y3Qga2ZkX2RldiAqZGV2LCBzdHJ1Y3QgcXVldWVfcHJvcGVydGllcyAqcSkN
Cj4gICB7DQo+ICAgCXN0cnVjdCBrZmRfbWVtX29iaiAqbXFkX21lbV9vYmogPSBOVUxMOw0KPiAg
IA0KPiBAQCAtODYsNyArODYsNyBAQCBzdHJ1Y3Qga2ZkX21lbV9vYmogKmFsbG9jYXRlX3NkbWFf
bXFkKHN0cnVjdCBrZmRfZGV2ICpkZXYsDQo+ICAgCXJldHVybiBtcWRfbWVtX29iajsNCj4gICB9
DQo+ICAgDQo+IC12b2lkIHVuaW5pdF9tcWRfaGlxX3NkbWEoc3RydWN0IG1xZF9tYW5hZ2VyICpt
bSwgdm9pZCAqbXFkLA0KPiArdm9pZCBmcmVlX21xZF9oaXFfc2RtYShzdHJ1Y3QgbXFkX21hbmFn
ZXIgKm1tLCB2b2lkICptcWQsDQo+ICAgCQkJc3RydWN0IGtmZF9tZW1fb2JqICptcWRfbWVtX29i
aikNCj4gICB7DQo+ICAgCVdBUk5fT04oIW1xZF9tZW1fb2JqLT5ndHRfbWVtKTsNCj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9tcWRfbWFuYWdlci5oIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX21xZF9tYW5hZ2VyLmgNCj4gaW5kZXggNjZiOGM2
Ny4uNTUwYjYxZSAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2Zk
X21xZF9tYW5hZ2VyLmgNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX21x
ZF9tYW5hZ2VyLmgNCj4gQEAgLTM5LDcgKzM5LDcgQEANCj4gICAgKiBAZGVzdHJveV9tcWQ6IERl
c3Ryb3lzIHRoZSBIUUQgc2xvdCBhbmQgYnkgdGhhdCBwcmVlbXB0IHRoZSByZWxldmFudCBxdWV1
ZS4NCj4gICAgKiBVc2VkIG9ubHkgZm9yIG5vIGNwIHNjaGVkdWxpbmcuDQo+ICAgICoNCj4gLSAq
IEB1bmluaXRfbXFkOiBSZWxlYXNlcyB0aGUgbXFkIGJ1ZmZlciBmcm9tIGxvY2FsIGdwdSBtZW1v
cnkuDQo+ICsgKiBAZnJlZV9tcWQ6IFJlbGVhc2VzIHRoZSBtcWQgYnVmZmVyIGZyb20gbG9jYWwg
Z3B1IG1lbW9yeS4NCj4gICAgKg0KPiAgICAqIEBpc19vY2N1cGllZDogQ2hlY2tzIGlmIHRoZSBy
ZWxldmFudCBIUUQgc2xvdCBpcyBvY2N1cGllZC4NCj4gICAgKg0KPiBAQCAtNjQsOCArNjQsMTEg
QEANCj4gICAgKi8NCj4gICBleHRlcm4gaW50IHBpcGVfcHJpb3JpdHlfbWFwW107DQo+ICAgc3Ry
dWN0IG1xZF9tYW5hZ2VyIHsNCj4gLQlpbnQJKCppbml0X21xZCkoc3RydWN0IG1xZF9tYW5hZ2Vy
ICptbSwgdm9pZCAqKm1xZCwNCj4gLQkJCXN0cnVjdCBrZmRfbWVtX29iaiAqKm1xZF9tZW1fb2Jq
LCB1aW50NjRfdCAqZ2FydF9hZGRyLA0KPiArCXN0cnVjdCBrZmRfbWVtX29iaioJKCphbGxvY2F0
ZV9tcWQpKHN0cnVjdCBrZmRfZGV2ICprZmQsDQo+ICsJCXN0cnVjdCBxdWV1ZV9wcm9wZXJ0aWVz
ICpxKTsNCj4gKw0KPiArCXZvaWQJKCppbml0X21xZCkoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwg
dm9pZCAqKm1xZCwNCj4gKwkJCXN0cnVjdCBrZmRfbWVtX29iaiAqbXFkX21lbV9vYmosIHVpbnQ2
NF90ICpnYXJ0X2FkZHIsDQo+ICAgCQkJc3RydWN0IHF1ZXVlX3Byb3BlcnRpZXMgKnEpOw0KPiAg
IA0KPiAgIAlpbnQJKCpsb2FkX21xZCkoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFk
LA0KPiBAQCAtNzMsNyArNzYsNyBAQCBzdHJ1Y3QgbXFkX21hbmFnZXIgew0KPiAgIAkJCQlzdHJ1
Y3QgcXVldWVfcHJvcGVydGllcyAqcCwNCj4gICAJCQkJc3RydWN0IG1tX3N0cnVjdCAqbW1zKTsN
Cj4gICANCj4gLQlpbnQJKCp1cGRhdGVfbXFkKShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lk
ICptcWQsDQo+ICsJdm9pZAkoKnVwZGF0ZV9tcWQpKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZv
aWQgKm1xZCwNCj4gICAJCQkJc3RydWN0IHF1ZXVlX3Byb3BlcnRpZXMgKnEpOw0KPiAgIA0KPiAg
IAlpbnQJKCpkZXN0cm95X21xZCkoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0K
PiBAQCAtODEsNyArODQsNyBAQCBzdHJ1Y3QgbXFkX21hbmFnZXIgew0KPiAgIAkJCQl1bnNpZ25l
ZCBpbnQgdGltZW91dCwgdWludDMyX3QgcGlwZV9pZCwNCj4gICAJCQkJdWludDMyX3QgcXVldWVf
aWQpOw0KPiAgIA0KPiAtCXZvaWQJKCp1bmluaXRfbXFkKShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1t
LCB2b2lkICptcWQsDQo+ICsJdm9pZAkoKmZyZWVfbXFkKShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1t
LCB2b2lkICptcWQsDQo+ICAgCQkJCXN0cnVjdCBrZmRfbWVtX29iaiAqbXFkX21lbV9vYmopOw0K
PiAgIA0KPiAgIAlib29sCSgqaXNfb2NjdXBpZWQpKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZv
aWQgKm1xZCwNCj4gQEAgLTEwMiwxMSArMTA1LDEyIEBAIHN0cnVjdCBtcWRfbWFuYWdlciB7DQo+
ICAgCXVpbnQzMl90IG1xZF9zaXplOw0KPiAgIH07DQo+ICAgDQo+IC1zdHJ1Y3Qga2ZkX21lbV9v
YmogKmFsbG9jYXRlX2hpcV9tcWQoc3RydWN0IGtmZF9kZXYgKmRldik7DQo+ICtzdHJ1Y3Qga2Zk
X21lbV9vYmogKmFsbG9jYXRlX2hpcV9tcWQoc3RydWN0IGtmZF9kZXYgKmRldiwNCj4gKwkJCQlz
dHJ1Y3QgcXVldWVfcHJvcGVydGllcyAqcSk7DQo+ICAgDQo+ICAgc3RydWN0IGtmZF9tZW1fb2Jq
ICphbGxvY2F0ZV9zZG1hX21xZChzdHJ1Y3Qga2ZkX2RldiAqZGV2LA0KPiAgIAkJCQkJc3RydWN0
IHF1ZXVlX3Byb3BlcnRpZXMgKnEpOw0KPiAtdm9pZCB1bmluaXRfbXFkX2hpcV9zZG1hKHN0cnVj
dCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKm1xZCwNCj4gK3ZvaWQgZnJlZV9tcWRfaGlxX3NkbWEo
c3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiAgIAkJCQlzdHJ1Y3Qga2ZkX21l
bV9vYmogKm1xZF9tZW1fb2JqKTsNCj4gICANCj4gICB2b2lkIG1xZF9zeW1tZXRyaWNhbGx5X21h
cF9jdV9tYXNrKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sDQo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXJfY2lrLmMgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXJfY2lrLmMNCj4gaW5kZXggZTkxMTQzOC4uMjg4
NzZhYyAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX21xZF9t
YW5hZ2VyX2Npay5jDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9tcWRf
bWFuYWdlcl9jaWsuYw0KPiBAQCAtNzcsOSArNzcsNiBAQCBzdGF0aWMgc3RydWN0IGtmZF9tZW1f
b2JqICphbGxvY2F0ZV9tcWQoc3RydWN0IGtmZF9kZXYgKmtmZCwNCj4gICB7DQo+ICAgCXN0cnVj
dCBrZmRfbWVtX29iaiAqbXFkX21lbV9vYmo7DQo+ICAgDQo+IC0JaWYgKHEtPnR5cGUgPT0gS0ZE
X1FVRVVFX1RZUEVfSElRKQ0KPiAtCQlyZXR1cm4gYWxsb2NhdGVfaGlxX21xZChrZmQpOw0KPiAt
DQo+ICAgCWlmIChrZmRfZ3R0X3NhX2FsbG9jYXRlKGtmZCwgc2l6ZW9mKHN0cnVjdCBjaWtfbXFk
KSwNCj4gICAJCQkmbXFkX21lbV9vYmopKQ0KPiAgIAkJcmV0dXJuIE5VTEw7DQo+IEBAIC04Nywy
MSArODQsMTUgQEAgc3RhdGljIHN0cnVjdCBrZmRfbWVtX29iaiAqYWxsb2NhdGVfbXFkKHN0cnVj
dCBrZmRfZGV2ICprZmQsDQo+ICAgCXJldHVybiBtcWRfbWVtX29iajsNCj4gICB9DQo+ICAgDQo+
IC1zdGF0aWMgaW50IGluaXRfbXFkKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKiptcWQs
DQo+IC0JCXN0cnVjdCBrZmRfbWVtX29iaiAqKm1xZF9tZW1fb2JqLCB1aW50NjRfdCAqZ2FydF9h
ZGRyLA0KPiArc3RhdGljIHZvaWQgaW5pdF9tcWQoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9p
ZCAqKm1xZCwNCj4gKwkJc3RydWN0IGtmZF9tZW1fb2JqICptcWRfbWVtX29iaiwgdWludDY0X3Qg
KmdhcnRfYWRkciwNCj4gICAJCXN0cnVjdCBxdWV1ZV9wcm9wZXJ0aWVzICpxKQ0KPiAgIHsNCj4g
ICAJdWludDY0X3QgYWRkcjsNCj4gICAJc3RydWN0IGNpa19tcWQgKm07DQo+IC0JaW50IHJldHZh
bDsNCj4gLQlzdHJ1Y3Qga2ZkX2RldiAqa2ZkID0gbW0tPmRldjsNCj4gLQ0KPiAtCSptcWRfbWVt
X29iaiA9IGFsbG9jYXRlX21xZChrZmQsIHEpOw0KPiAtCWlmICghKm1xZF9tZW1fb2JqKQ0KPiAt
CQlyZXR1cm4gLUVOT01FTTsNCj4gICANCj4gLQltID0gKHN0cnVjdCBjaWtfbXFkICopICgqbXFk
X21lbV9vYmopLT5jcHVfcHRyOw0KPiAtCWFkZHIgPSAoKm1xZF9tZW1fb2JqKS0+Z3B1X2FkZHI7
DQo+ICsJbSA9IChzdHJ1Y3QgY2lrX21xZCAqKSBtcWRfbWVtX29iai0+Y3B1X3B0cjsNCj4gKwlh
ZGRyID0gbXFkX21lbV9vYmotPmdwdV9hZGRyOw0KPiAgIA0KPiAgIAltZW1zZXQobSwgMCwgQUxJ
R04oc2l6ZW9mKHN0cnVjdCBjaWtfbXFkKSwgMjU2KSk7DQo+ICAgDQo+IEBAIC0xNDQsMzcgKzEz
NSwyNyBAQCBzdGF0aWMgaW50IGluaXRfbXFkKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQg
KiptcWQsDQo+ICAgCSptcWQgPSBtOw0KPiAgIAlpZiAoZ2FydF9hZGRyKQ0KPiAgIAkJKmdhcnRf
YWRkciA9IGFkZHI7DQo+IC0JcmV0dmFsID0gbW0tPnVwZGF0ZV9tcWQobW0sIG0sIHEpOw0KPiAt
DQo+IC0JcmV0dXJuIHJldHZhbDsNCj4gKwltbS0+dXBkYXRlX21xZChtbSwgbSwgcSk7DQo+ICAg
fQ0KPiAgIA0KPiAtc3RhdGljIGludCBpbml0X21xZF9zZG1hKHN0cnVjdCBtcWRfbWFuYWdlciAq
bW0sIHZvaWQgKiptcWQsDQo+IC0JCQlzdHJ1Y3Qga2ZkX21lbV9vYmogKiptcWRfbWVtX29iaiwg
dWludDY0X3QgKmdhcnRfYWRkciwNCj4gK3N0YXRpYyB2b2lkIGluaXRfbXFkX3NkbWEoc3RydWN0
IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqKm1xZCwNCj4gKwkJCXN0cnVjdCBrZmRfbWVtX29iaiAq
bXFkX21lbV9vYmosIHVpbnQ2NF90ICpnYXJ0X2FkZHIsDQo+ICAgCQkJc3RydWN0IHF1ZXVlX3By
b3BlcnRpZXMgKnEpDQo+ICAgew0KPiAtCWludCByZXR2YWw7DQo+ICAgCXN0cnVjdCBjaWtfc2Rt
YV9ybGNfcmVnaXN0ZXJzICptOw0KPiAtCXN0cnVjdCBrZmRfZGV2ICpkZXYgPSBtbS0+ZGV2Ow0K
PiAgIA0KPiAtCSptcWRfbWVtX29iaiA9IGFsbG9jYXRlX3NkbWFfbXFkKGRldiwgcSk7DQo+IC0J
aWYgKCEqbXFkX21lbV9vYmopDQo+IC0JCXJldHVybiAtRU5PTUVNOw0KPiAtDQo+IC0JbSA9IChz
dHJ1Y3QgY2lrX3NkbWFfcmxjX3JlZ2lzdGVycyAqKSAoKm1xZF9tZW1fb2JqKS0+Y3B1X3B0cjsN
Cj4gKwltID0gKHN0cnVjdCBjaWtfc2RtYV9ybGNfcmVnaXN0ZXJzICopIG1xZF9tZW1fb2JqLT5j
cHVfcHRyOw0KPiAgIA0KPiAgIAltZW1zZXQobSwgMCwgc2l6ZW9mKHN0cnVjdCBjaWtfc2RtYV9y
bGNfcmVnaXN0ZXJzKSk7DQo+ICAgDQo+ICAgCSptcWQgPSBtOw0KPiAgIAlpZiAoZ2FydF9hZGRy
KQ0KPiAtCQkqZ2FydF9hZGRyID0gKCptcWRfbWVtX29iaiktPmdwdV9hZGRyOw0KPiAtDQo+IC0J
cmV0dmFsID0gbW0tPnVwZGF0ZV9tcWQobW0sIG0sIHEpOw0KPiArCQkqZ2FydF9hZGRyID0gbXFk
X21lbV9vYmotPmdwdV9hZGRyOw0KPiAgIA0KPiAtCXJldHVybiByZXR2YWw7DQo+ICsJbW0tPnVw
ZGF0ZV9tcWQobW0sIG0sIHEpOw0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyB2b2lkIHVuaW5pdF9t
cWQoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiArc3RhdGljIHZvaWQgZnJl
ZV9tcWQoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiAgIAkJCXN0cnVjdCBr
ZmRfbWVtX29iaiAqbXFkX21lbV9vYmopDQo+ICAgew0KPiAgIAlrZmRfZ3R0X3NhX2ZyZWUobW0t
PmRldiwgbXFkX21lbV9vYmopOw0KPiBAQCAtMjAzLDcgKzE4NCw3IEBAIHN0YXRpYyBpbnQgbG9h
ZF9tcWRfc2RtYShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICAgCQkJCQkg
ICAgICAgbW1zKTsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IF9fdXBkYXRlX21xZChzdHJ1
Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICtzdGF0aWMgdm9pZCBfX3VwZGF0ZV9t
cWQoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiAgIAkJCXN0cnVjdCBxdWV1
ZV9wcm9wZXJ0aWVzICpxLCB1bnNpZ25lZCBpbnQgYXRjX2JpdCkNCj4gICB7DQo+ICAgCXN0cnVj
dCBjaWtfbXFkICptOw0KPiBAQCAtMjM3LDIzICsyMTgsMjEgQEAgc3RhdGljIGludCBfX3VwZGF0
ZV9tcWQoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiAgIAlzZXRfcHJpb3Jp
dHkobSwgcSk7DQo+ICAgDQo+ICAgCXEtPmlzX2FjdGl2ZSA9IFFVRVVFX0lTX0FDVElWRSgqcSk7
DQo+IC0NCj4gLQlyZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHVwZGF0ZV9t
cWQoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiArc3RhdGljIHZvaWQgdXBk
YXRlX21xZChzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICAgCQkJc3RydWN0
IHF1ZXVlX3Byb3BlcnRpZXMgKnEpDQo+ICAgew0KPiAtCXJldHVybiBfX3VwZGF0ZV9tcWQobW0s
IG1xZCwgcSwgMSk7DQo+ICsJX191cGRhdGVfbXFkKG1tLCBtcWQsIHEsIDEpOw0KPiAgIH0NCj4g
ICANCj4gLXN0YXRpYyBpbnQgdXBkYXRlX21xZF9oYXdhaWkoc3RydWN0IG1xZF9tYW5hZ2VyICpt
bSwgdm9pZCAqbXFkLA0KPiArc3RhdGljIHZvaWQgdXBkYXRlX21xZF9oYXdhaWkoc3RydWN0IG1x
ZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiAgIAkJCXN0cnVjdCBxdWV1ZV9wcm9wZXJ0aWVz
ICpxKQ0KPiAgIHsNCj4gLQlyZXR1cm4gX191cGRhdGVfbXFkKG1tLCBtcWQsIHEsIDApOw0KPiAr
CV9fdXBkYXRlX21xZChtbSwgbXFkLCBxLCAwKTsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50
IHVwZGF0ZV9tcWRfc2RtYShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICtz
dGF0aWMgdm9pZCB1cGRhdGVfbXFkX3NkbWEoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAq
bXFkLA0KPiAgIAkJCQlzdHJ1Y3QgcXVldWVfcHJvcGVydGllcyAqcSkNCj4gICB7DQo+ICAgCXN0
cnVjdCBjaWtfc2RtYV9ybGNfcmVnaXN0ZXJzICptOw0KPiBAQCAtMjc4LDggKzI1Nyw2IEBAIHN0
YXRpYyBpbnQgdXBkYXRlX21xZF9zZG1hKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKm1x
ZCwNCj4gICAJbS0+c2RtYV9xdWV1ZV9pZCA9IHEtPnNkbWFfcXVldWVfaWQ7DQo+ICAgDQo+ICAg
CXEtPmlzX2FjdGl2ZSA9IFFVRVVFX0lTX0FDVElWRSgqcSk7DQo+IC0NCj4gLQlyZXR1cm4gMDsN
Cj4gICB9DQo+ICAgDQo+ICAgc3RhdGljIGludCBkZXN0cm95X21xZChzdHJ1Y3QgbXFkX21hbmFn
ZXIgKm1tLCB2b2lkICptcWQsDQo+IEBAIC0zMjYsMTQgKzMwMywxNCBAQCBzdGF0aWMgYm9vbCBp
c19vY2N1cGllZF9zZG1hKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKm1xZCwNCj4gICAg
KiBxdWV1ZXMgYnV0IHdpdGggZGlmZmVyZW50IGluaXRpYWwgdmFsdWVzLg0KPiAgICAqLw0KPiAg
IA0KPiAtc3RhdGljIGludCBpbml0X21xZF9oaXEoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9p
ZCAqKm1xZCwNCj4gLQkJc3RydWN0IGtmZF9tZW1fb2JqICoqbXFkX21lbV9vYmosIHVpbnQ2NF90
ICpnYXJ0X2FkZHIsDQo+ICtzdGF0aWMgdm9pZCBpbml0X21xZF9oaXEoc3RydWN0IG1xZF9tYW5h
Z2VyICptbSwgdm9pZCAqKm1xZCwNCj4gKwkJc3RydWN0IGtmZF9tZW1fb2JqICptcWRfbWVtX29i
aiwgdWludDY0X3QgKmdhcnRfYWRkciwNCj4gICAJCXN0cnVjdCBxdWV1ZV9wcm9wZXJ0aWVzICpx
KQ0KPiAgIHsNCj4gLQlyZXR1cm4gaW5pdF9tcWQobW0sIG1xZCwgbXFkX21lbV9vYmosIGdhcnRf
YWRkciwgcSk7DQo+ICsJaW5pdF9tcWQobW0sIG1xZCwgbXFkX21lbV9vYmosIGdhcnRfYWRkciwg
cSk7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCB1cGRhdGVfbXFkX2hpcShzdHJ1Y3QgbXFk
X21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICtzdGF0aWMgdm9pZCB1cGRhdGVfbXFkX2hpcShz
dHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICAgCQkJCXN0cnVjdCBxdWV1ZV9w
cm9wZXJ0aWVzICpxKQ0KPiAgIHsNCj4gICAJc3RydWN0IGNpa19tcWQgKm07DQo+IEBAIC0zNjAs
NyArMzM3LDYgQEAgc3RhdGljIGludCB1cGRhdGVfbXFkX2hpcShzdHJ1Y3QgbXFkX21hbmFnZXIg
Km1tLCB2b2lkICptcWQsDQo+ICAgCXEtPmlzX2FjdGl2ZSA9IFFVRVVFX0lTX0FDVElWRSgqcSk7
DQo+ICAgDQo+ICAgCXNldF9wcmlvcml0eShtLCBxKTsNCj4gLQlyZXR1cm4gMDsNCj4gICB9DQo+
ICAgDQo+ICAgI2lmIGRlZmluZWQoQ09ORklHX0RFQlVHX0ZTKQ0KPiBAQCAtMzk5LDggKzM3NSw5
IEBAIHN0cnVjdCBtcWRfbWFuYWdlciAqbXFkX21hbmFnZXJfaW5pdF9jaWsoZW51bSBLRkRfTVFE
X1RZUEUgdHlwZSwNCj4gICAJc3dpdGNoICh0eXBlKSB7DQo+ICAgCWNhc2UgS0ZEX01RRF9UWVBF
X0NQOg0KPiAgIAljYXNlIEtGRF9NUURfVFlQRV9DT01QVVRFOg0KPiArCQltcWQtPmFsbG9jYXRl
X21xZCA9IGFsbG9jYXRlX21xZDsNCj4gICAJCW1xZC0+aW5pdF9tcWQgPSBpbml0X21xZDsNCj4g
LQkJbXFkLT51bmluaXRfbXFkID0gdW5pbml0X21xZDsNCj4gKwkJbXFkLT5mcmVlX21xZCA9IGZy
ZWVfbXFkOw0KPiAgIAkJbXFkLT5sb2FkX21xZCA9IGxvYWRfbXFkOw0KPiAgIAkJbXFkLT51cGRh
dGVfbXFkID0gdXBkYXRlX21xZDsNCj4gICAJCW1xZC0+ZGVzdHJveV9tcWQgPSBkZXN0cm95X21x
ZDsNCj4gQEAgLTQxMSw4ICszODgsOSBAQCBzdHJ1Y3QgbXFkX21hbmFnZXIgKm1xZF9tYW5hZ2Vy
X2luaXRfY2lrKGVudW0gS0ZEX01RRF9UWVBFIHR5cGUsDQo+ICAgI2VuZGlmDQo+ICAgCQlicmVh
azsNCj4gICAJY2FzZSBLRkRfTVFEX1RZUEVfSElROg0KPiArCQltcWQtPmFsbG9jYXRlX21xZCA9
IGFsbG9jYXRlX2hpcV9tcWQ7DQo+ICAgCQltcWQtPmluaXRfbXFkID0gaW5pdF9tcWRfaGlxOw0K
PiAtCQltcWQtPnVuaW5pdF9tcWQgPSB1bmluaXRfbXFkX2hpcV9zZG1hOw0KPiArCQltcWQtPmZy
ZWVfbXFkID0gZnJlZV9tcWRfaGlxX3NkbWE7DQo+ICAgCQltcWQtPmxvYWRfbXFkID0gbG9hZF9t
cWQ7DQo+ICAgCQltcWQtPnVwZGF0ZV9tcWQgPSB1cGRhdGVfbXFkX2hpcTsNCj4gICAJCW1xZC0+
ZGVzdHJveV9tcWQgPSBkZXN0cm95X21xZDsNCj4gQEAgLTQyMyw4ICs0MDEsOSBAQCBzdHJ1Y3Qg
bXFkX21hbmFnZXIgKm1xZF9tYW5hZ2VyX2luaXRfY2lrKGVudW0gS0ZEX01RRF9UWVBFIHR5cGUs
DQo+ICAgI2VuZGlmDQo+ICAgCQlicmVhazsNCj4gICAJY2FzZSBLRkRfTVFEX1RZUEVfRElROg0K
PiArCQltcWQtPmFsbG9jYXRlX21xZCA9IGFsbG9jYXRlX2hpcV9tcWQ7DQo+ICAgCQltcWQtPmlu
aXRfbXFkID0gaW5pdF9tcWRfaGlxOw0KPiAtCQltcWQtPnVuaW5pdF9tcWQgPSB1bmluaXRfbXFk
Ow0KPiArCQltcWQtPmZyZWVfbXFkID0gZnJlZV9tcWQ7DQo+ICAgCQltcWQtPmxvYWRfbXFkID0g
bG9hZF9tcWQ7DQo+ICAgCQltcWQtPnVwZGF0ZV9tcWQgPSB1cGRhdGVfbXFkX2hpcTsNCj4gICAJ
CW1xZC0+ZGVzdHJveV9tcWQgPSBkZXN0cm95X21xZDsNCj4gQEAgLTQzNSw4ICs0MTQsOSBAQCBz
dHJ1Y3QgbXFkX21hbmFnZXIgKm1xZF9tYW5hZ2VyX2luaXRfY2lrKGVudW0gS0ZEX01RRF9UWVBF
IHR5cGUsDQo+ICAgI2VuZGlmDQo+ICAgCQlicmVhazsNCj4gICAJY2FzZSBLRkRfTVFEX1RZUEVf
U0RNQToNCj4gKwkJbXFkLT5hbGxvY2F0ZV9tcWQgPSBhbGxvY2F0ZV9zZG1hX21xZDsNCj4gICAJ
CW1xZC0+aW5pdF9tcWQgPSBpbml0X21xZF9zZG1hOw0KPiAtCQltcWQtPnVuaW5pdF9tcWQgPSB1
bmluaXRfbXFkX2hpcV9zZG1hOw0KPiArCQltcWQtPmZyZWVfbXFkID0gZnJlZV9tcWRfaGlxX3Nk
bWE7DQo+ICAgCQltcWQtPmxvYWRfbXFkID0gbG9hZF9tcWRfc2RtYTsNCj4gICAJCW1xZC0+dXBk
YXRlX21xZCA9IHVwZGF0ZV9tcWRfc2RtYTsNCj4gICAJCW1xZC0+ZGVzdHJveV9tcWQgPSBkZXN0
cm95X21xZF9zZG1hOw0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQv
a2ZkX21xZF9tYW5hZ2VyX3Y5LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFk
X21hbmFnZXJfdjkuYw0KPiBpbmRleCA4MTg5NDRiLi4wYzU4ZjkxIDEwMDY0NA0KPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXJfdjkuYw0KPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfbXFkX21hbmFnZXJfdjkuYw0KPiBAQCAtNzks
OSArNzksNiBAQCBzdGF0aWMgc3RydWN0IGtmZF9tZW1fb2JqICphbGxvY2F0ZV9tcWQoc3RydWN0
IGtmZF9kZXYgKmtmZCwNCj4gICAJaW50IHJldHZhbDsNCj4gICAJc3RydWN0IGtmZF9tZW1fb2Jq
ICptcWRfbWVtX29iaiA9IE5VTEw7DQo+ICAgDQo+IC0JaWYgKHEtPnR5cGUgPT0gS0ZEX1FVRVVF
X1RZUEVfSElRKQ0KPiAtCQlyZXR1cm4gYWxsb2NhdGVfaGlxX21xZChrZmQpOw0KPiAtDQo+ICAg
CS8qIEZyb20gVjksICBmb3IgQ1dTUiwgdGhlIGNvbnRyb2wgc3RhY2sgaXMgbG9jYXRlZCBvbiB0
aGUgbmV4dCBwYWdlDQo+ICAgCSAqIGJvdW5kYXJ5IGFmdGVyIHRoZSBtcWQsIHdlIHdpbGwgdXNl
IHRoZSBndHQgYWxsb2NhdGlvbiBmdW5jdGlvbg0KPiAgIAkgKiBpbnN0ZWFkIG9mIHN1Yi1hbGxv
Y2F0aW9uIGZ1bmN0aW9uLg0KPiBAQCAtMTEwLDIxICsxMDcsMTUgQEAgc3RhdGljIHN0cnVjdCBr
ZmRfbWVtX29iaiAqYWxsb2NhdGVfbXFkKHN0cnVjdCBrZmRfZGV2ICprZmQsDQo+ICAgDQo+ICAg
fQ0KPiAgIA0KPiAtc3RhdGljIGludCBpbml0X21xZChzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2
b2lkICoqbXFkLA0KPiAtCQkJc3RydWN0IGtmZF9tZW1fb2JqICoqbXFkX21lbV9vYmosIHVpbnQ2
NF90ICpnYXJ0X2FkZHIsDQo+ICtzdGF0aWMgdm9pZCBpbml0X21xZChzdHJ1Y3QgbXFkX21hbmFn
ZXIgKm1tLCB2b2lkICoqbXFkLA0KPiArCQkJc3RydWN0IGtmZF9tZW1fb2JqICptcWRfbWVtX29i
aiwgdWludDY0X3QgKmdhcnRfYWRkciwNCj4gICAJCQlzdHJ1Y3QgcXVldWVfcHJvcGVydGllcyAq
cSkNCj4gICB7DQo+IC0JaW50IHJldHZhbDsNCj4gICAJdWludDY0X3QgYWRkcjsNCj4gICAJc3Ry
dWN0IHY5X21xZCAqbTsNCj4gLQlzdHJ1Y3Qga2ZkX2RldiAqa2ZkID0gbW0tPmRldjsNCj4gLQ0K
PiAtCSptcWRfbWVtX29iaiA9IGFsbG9jYXRlX21xZChrZmQsIHEpOw0KPiAtCWlmICghKm1xZF9t
ZW1fb2JqKQ0KPiAtCQlyZXR1cm4gLUVOT01FTTsNCj4gICANCj4gLQltID0gKHN0cnVjdCB2OV9t
cWQgKikgKCptcWRfbWVtX29iaiktPmNwdV9wdHI7DQo+IC0JYWRkciA9ICgqbXFkX21lbV9vYmop
LT5ncHVfYWRkcjsNCj4gKwltID0gKHN0cnVjdCB2OV9tcWQgKikgbXFkX21lbV9vYmotPmNwdV9w
dHI7DQo+ICsJYWRkciA9IG1xZF9tZW1fb2JqLT5ncHVfYWRkcjsNCj4gICANCj4gICAJbWVtc2V0
KG0sIDAsIHNpemVvZihzdHJ1Y3QgdjlfbXFkKSk7DQo+ICAgDQo+IEBAIC0xNzMsOSArMTY0LDcg
QEAgc3RhdGljIGludCBpbml0X21xZChzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICoqbXFk
LA0KPiAgIAkqbXFkID0gbTsNCj4gICAJaWYgKGdhcnRfYWRkcikNCj4gICAJCSpnYXJ0X2FkZHIg
PSBhZGRyOw0KPiAtCXJldHZhbCA9IG1tLT51cGRhdGVfbXFkKG1tLCBtLCBxKTsNCj4gLQ0KPiAt
CXJldHVybiByZXR2YWw7DQo+ICsJbW0tPnVwZGF0ZV9tcWQobW0sIG0sIHEpOw0KPiAgIH0NCj4g
ICANCj4gICBzdGF0aWMgaW50IGxvYWRfbXFkKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQg
Km1xZCwNCj4gQEAgLTE5MCw3ICsxNzksNyBAQCBzdGF0aWMgaW50IGxvYWRfbXFkKHN0cnVjdCBt
cWRfbWFuYWdlciAqbW0sIHZvaWQgKm1xZCwNCj4gICAJCQkJCSAgd3B0cl9zaGlmdCwgMCwgbW1z
KTsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IHVwZGF0ZV9tcWQoc3RydWN0IG1xZF9tYW5h
Z2VyICptbSwgdm9pZCAqbXFkLA0KPiArc3RhdGljIHZvaWQgdXBkYXRlX21xZChzdHJ1Y3QgbXFk
X21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICAgCQkgICAgICBzdHJ1Y3QgcXVldWVfcHJvcGVy
dGllcyAqcSkNCj4gICB7DQo+ICAgCXN0cnVjdCB2OV9tcWQgKm07DQo+IEBAIC0yNTIsOCArMjQx
LDYgQEAgc3RhdGljIGludCB1cGRhdGVfbXFkKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQg
Km1xZCwNCj4gICAJc2V0X3ByaW9yaXR5KG0sIHEpOw0KPiAgIA0KPiAgIAlxLT5pc19hY3RpdmUg
PSBRVUVVRV9JU19BQ1RJVkUoKnEpOw0KPiAtDQo+IC0JcmV0dXJuIDA7DQo+ICAgfQ0KPiAgIA0K
PiAgIA0KPiBAQCAtMjY3LDcgKzI1NCw3IEBAIHN0YXRpYyBpbnQgZGVzdHJveV9tcWQoc3RydWN0
IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiAgIAkJcGlwZV9pZCwgcXVldWVfaWQpOw0K
PiAgIH0NCj4gICANCj4gLXN0YXRpYyB2b2lkIHVuaW5pdF9tcWQoc3RydWN0IG1xZF9tYW5hZ2Vy
ICptbSwgdm9pZCAqbXFkLA0KPiArc3RhdGljIHZvaWQgZnJlZV9tcWQoc3RydWN0IG1xZF9tYW5h
Z2VyICptbSwgdm9pZCAqbXFkLA0KPiAgIAkJCXN0cnVjdCBrZmRfbWVtX29iaiAqbXFkX21lbV9v
YmopDQo+ICAgew0KPiAgIAlzdHJ1Y3Qga2ZkX2RldiAqa2ZkID0gbW0tPmRldjsNCj4gQEAgLTMx
MSw2MiArMjk4LDQ3IEBAIHN0YXRpYyBpbnQgZ2V0X3dhdmVfc3RhdGUoc3RydWN0IG1xZF9tYW5h
Z2VyICptbSwgdm9pZCAqbXFkLA0KPiAgIAlyZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+IC1zdGF0
aWMgaW50IGluaXRfbXFkX2hpcShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICoqbXFkLA0K
PiAtCQkJc3RydWN0IGtmZF9tZW1fb2JqICoqbXFkX21lbV9vYmosIHVpbnQ2NF90ICpnYXJ0X2Fk
ZHIsDQo+ICtzdGF0aWMgdm9pZCBpbml0X21xZF9oaXEoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwg
dm9pZCAqKm1xZCwNCj4gKwkJCXN0cnVjdCBrZmRfbWVtX29iaiAqbXFkX21lbV9vYmosIHVpbnQ2
NF90ICpnYXJ0X2FkZHIsDQo+ICAgCQkJc3RydWN0IHF1ZXVlX3Byb3BlcnRpZXMgKnEpDQo+ICAg
ew0KPiAgIAlzdHJ1Y3QgdjlfbXFkICptOw0KPiAtCWludCByZXR2YWwgPSBpbml0X21xZChtbSwg
bXFkLCBtcWRfbWVtX29iaiwgZ2FydF9hZGRyLCBxKTsNCj4gICANCj4gLQlpZiAocmV0dmFsICE9
IDApDQo+IC0JCXJldHVybiByZXR2YWw7DQo+ICsJaW5pdF9tcWQobW0sIG1xZCwgbXFkX21lbV9v
YmosIGdhcnRfYWRkciwgcSk7DQo+ICAgDQo+ICAgCW0gPSBnZXRfbXFkKCptcWQpOw0KPiAgIA0K
PiAgIAltLT5jcF9ocWRfcHFfY29udHJvbCB8PSAxIDw8IENQX0hRRF9QUV9DT05UUk9MX19QUklW
X1NUQVRFX19TSElGVCB8DQo+ICAgCQkJMSA8PCBDUF9IUURfUFFfQ09OVFJPTF9fS01EX1FVRVVF
X19TSElGVDsNCj4gLQ0KPiAtCXJldHVybiByZXR2YWw7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGlj
IGludCB1cGRhdGVfbXFkX2hpcShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+
ICtzdGF0aWMgdm9pZCB1cGRhdGVfbXFkX2hpcShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lk
ICptcWQsDQo+ICAgCQkJc3RydWN0IHF1ZXVlX3Byb3BlcnRpZXMgKnEpDQo+ICAgew0KPiAgIAlz
dHJ1Y3QgdjlfbXFkICptOw0KPiAtCWludCByZXR2YWwgPSB1cGRhdGVfbXFkKG1tLCBtcWQsIHEp
Ow0KPiAgIA0KPiAtCWlmIChyZXR2YWwgIT0gMCkNCj4gLQkJcmV0dXJuIHJldHZhbDsNCj4gKwl1
cGRhdGVfbXFkKG1tLCBtcWQsIHEpOw0KPiAgIA0KPiAgIAkvKiBUT0RPOiB3aGF0J3MgdGhlIHBv
aW50PyB1cGRhdGVfbXFkIGFscmVhZHkgZG9lcyB0aGlzLiAqLw0KPiAgIAltID0gZ2V0X21xZCht
cWQpOw0KPiAgIAltLT5jcF9ocWRfdm1pZCA9IHEtPnZtaWQ7DQo+IC0JcmV0dXJuIHJldHZhbDsN
Cj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50IGluaXRfbXFkX3NkbWEoc3RydWN0IG1xZF9tYW5h
Z2VyICptbSwgdm9pZCAqKm1xZCwNCj4gLQkJc3RydWN0IGtmZF9tZW1fb2JqICoqbXFkX21lbV9v
YmosIHVpbnQ2NF90ICpnYXJ0X2FkZHIsDQo+ICtzdGF0aWMgdm9pZCBpbml0X21xZF9zZG1hKHN0
cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKiptcWQsDQo+ICsJCXN0cnVjdCBrZmRfbWVtX29i
aiAqbXFkX21lbV9vYmosIHVpbnQ2NF90ICpnYXJ0X2FkZHIsDQo+ICAgCQlzdHJ1Y3QgcXVldWVf
cHJvcGVydGllcyAqcSkNCj4gICB7DQo+IC0JaW50IHJldHZhbDsNCj4gICAJc3RydWN0IHY5X3Nk
bWFfbXFkICptOw0KPiAtCXN0cnVjdCBrZmRfZGV2ICpkZXYgPSBtbS0+ZGV2Ow0KPiAtDQo+IC0J
Km1xZF9tZW1fb2JqID0gYWxsb2NhdGVfc2RtYV9tcWQoZGV2LCBxKTsNCj4gLQlpZiAoISptcWRf
bWVtX29iaikNCj4gLQkJcmV0dXJuIC1FTk9NRU07DQo+ICAgDQo+IC0JbSA9IChzdHJ1Y3Qgdjlf
c2RtYV9tcWQgKikgKCptcWRfbWVtX29iaiktPmNwdV9wdHI7DQo+ICsJbSA9IChzdHJ1Y3Qgdjlf
c2RtYV9tcWQgKikgbXFkX21lbV9vYmotPmNwdV9wdHI7DQo+ICAgDQo+ICAgCW1lbXNldChtLCAw
LCBzaXplb2Yoc3RydWN0IHY5X3NkbWFfbXFkKSk7DQo+ICAgDQo+ICAgCSptcWQgPSBtOw0KPiAg
IAlpZiAoZ2FydF9hZGRyKQ0KPiAtCQkqZ2FydF9hZGRyID0gKCptcWRfbWVtX29iaiktPmdwdV9h
ZGRyOw0KPiArCQkqZ2FydF9hZGRyID0gbXFkX21lbV9vYmotPmdwdV9hZGRyOw0KPiAgIA0KPiAt
CXJldHZhbCA9IG1tLT51cGRhdGVfbXFkKG1tLCBtLCBxKTsNCj4gLQ0KPiAtCXJldHVybiByZXR2
YWw7DQo+ICsJbW0tPnVwZGF0ZV9tcWQobW0sIG0sIHEpOw0KPiAgIH0NCj4gICANCj4gICBzdGF0
aWMgaW50IGxvYWRfbXFkX3NkbWEoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0K
PiBAQCAtMzgwLDcgKzM1Miw3IEBAIHN0YXRpYyBpbnQgbG9hZF9tcWRfc2RtYShzdHJ1Y3QgbXFk
X21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICAgDQo+ICAgI2RlZmluZSBTRE1BX1JMQ19EVU1N
WV9ERUZBVUxUIDB4Zg0KPiAgIA0KPiAtc3RhdGljIGludCB1cGRhdGVfbXFkX3NkbWEoc3RydWN0
IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiArc3RhdGljIHZvaWQgdXBkYXRlX21xZF9z
ZG1hKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKm1xZCwNCj4gICAJCXN0cnVjdCBxdWV1
ZV9wcm9wZXJ0aWVzICpxKQ0KPiAgIHsNCj4gICAJc3RydWN0IHY5X3NkbWFfbXFkICptOw0KPiBA
QCAtNDA0LDggKzM3Niw2IEBAIHN0YXRpYyBpbnQgdXBkYXRlX21xZF9zZG1hKHN0cnVjdCBtcWRf
bWFuYWdlciAqbW0sIHZvaWQgKm1xZCwNCj4gICAJbS0+c2RtYXhfcmxjeF9kdW1teV9yZWcgPSBT
RE1BX1JMQ19EVU1NWV9ERUZBVUxUOw0KPiAgIA0KPiAgIAlxLT5pc19hY3RpdmUgPSBRVUVVRV9J
U19BQ1RJVkUoKnEpOw0KPiAtDQo+IC0JcmV0dXJuIDA7DQo+ICAgfQ0KPiAgIA0KPiAgIC8qDQo+
IEBAIC00NjIsOCArNDMyLDkgQEAgc3RydWN0IG1xZF9tYW5hZ2VyICptcWRfbWFuYWdlcl9pbml0
X3Y5KGVudW0gS0ZEX01RRF9UWVBFIHR5cGUsDQo+ICAgCXN3aXRjaCAodHlwZSkgew0KPiAgIAlj
YXNlIEtGRF9NUURfVFlQRV9DUDoNCj4gICAJY2FzZSBLRkRfTVFEX1RZUEVfQ09NUFVURToNCj4g
KwkJbXFkLT5hbGxvY2F0ZV9tcWQgPSBhbGxvY2F0ZV9tcWQ7DQo+ICAgCQltcWQtPmluaXRfbXFk
ID0gaW5pdF9tcWQ7DQo+IC0JCW1xZC0+dW5pbml0X21xZCA9IHVuaW5pdF9tcWQ7DQo+ICsJCW1x
ZC0+ZnJlZV9tcWQgPSBmcmVlX21xZDsNCj4gICAJCW1xZC0+bG9hZF9tcWQgPSBsb2FkX21xZDsN
Cj4gICAJCW1xZC0+dXBkYXRlX21xZCA9IHVwZGF0ZV9tcWQ7DQo+ICAgCQltcWQtPmRlc3Ryb3lf
bXFkID0gZGVzdHJveV9tcWQ7DQo+IEBAIC00NzUsOCArNDQ2LDkgQEAgc3RydWN0IG1xZF9tYW5h
Z2VyICptcWRfbWFuYWdlcl9pbml0X3Y5KGVudW0gS0ZEX01RRF9UWVBFIHR5cGUsDQo+ICAgI2Vu
ZGlmDQo+ICAgCQlicmVhazsNCj4gICAJY2FzZSBLRkRfTVFEX1RZUEVfSElROg0KPiArCQltcWQt
PmFsbG9jYXRlX21xZCA9IGFsbG9jYXRlX2hpcV9tcWQ7DQo+ICAgCQltcWQtPmluaXRfbXFkID0g
aW5pdF9tcWRfaGlxOw0KPiAtCQltcWQtPnVuaW5pdF9tcWQgPSB1bmluaXRfbXFkX2hpcV9zZG1h
Ow0KPiArCQltcWQtPmZyZWVfbXFkID0gZnJlZV9tcWRfaGlxX3NkbWE7DQo+ICAgCQltcWQtPmxv
YWRfbXFkID0gbG9hZF9tcWQ7DQo+ICAgCQltcWQtPnVwZGF0ZV9tcWQgPSB1cGRhdGVfbXFkX2hp
cTsNCj4gICAJCW1xZC0+ZGVzdHJveV9tcWQgPSBkZXN0cm95X21xZDsNCj4gQEAgLTQ4Nyw4ICs0
NTksOSBAQCBzdHJ1Y3QgbXFkX21hbmFnZXIgKm1xZF9tYW5hZ2VyX2luaXRfdjkoZW51bSBLRkRf
TVFEX1RZUEUgdHlwZSwNCj4gICAjZW5kaWYNCj4gICAJCWJyZWFrOw0KPiAgIAljYXNlIEtGRF9N
UURfVFlQRV9ESVE6DQo+ICsJCW1xZC0+YWxsb2NhdGVfbXFkID0gYWxsb2NhdGVfaGlxX21xZDsN
Cj4gICAJCW1xZC0+aW5pdF9tcWQgPSBpbml0X21xZF9oaXE7DQo+IC0JCW1xZC0+dW5pbml0X21x
ZCA9IHVuaW5pdF9tcWQ7DQo+ICsJCW1xZC0+ZnJlZV9tcWQgPSBmcmVlX21xZDsNCj4gICAJCW1x
ZC0+bG9hZF9tcWQgPSBsb2FkX21xZDsNCj4gICAJCW1xZC0+dXBkYXRlX21xZCA9IHVwZGF0ZV9t
cWRfaGlxOw0KPiAgIAkJbXFkLT5kZXN0cm95X21xZCA9IGRlc3Ryb3lfbXFkOw0KPiBAQCAtNDk5
LDggKzQ3Miw5IEBAIHN0cnVjdCBtcWRfbWFuYWdlciAqbXFkX21hbmFnZXJfaW5pdF92OShlbnVt
IEtGRF9NUURfVFlQRSB0eXBlLA0KPiAgICNlbmRpZg0KPiAgIAkJYnJlYWs7DQo+ICAgCWNhc2Ug
S0ZEX01RRF9UWVBFX1NETUE6DQo+ICsJCW1xZC0+YWxsb2NhdGVfbXFkID0gYWxsb2NhdGVfc2Rt
YV9tcWQ7DQo+ICAgCQltcWQtPmluaXRfbXFkID0gaW5pdF9tcWRfc2RtYTsNCj4gLQkJbXFkLT51
bmluaXRfbXFkID0gdW5pbml0X21xZF9oaXFfc2RtYTsNCj4gKwkJbXFkLT5mcmVlX21xZCA9IGZy
ZWVfbXFkX2hpcV9zZG1hOw0KPiAgIAkJbXFkLT5sb2FkX21xZCA9IGxvYWRfbXFkX3NkbWE7DQo+
ICAgCQltcWQtPnVwZGF0ZV9tcWQgPSB1cGRhdGVfbXFkX3NkbWE7DQo+ICAgCQltcWQtPmRlc3Ry
b3lfbXFkID0gZGVzdHJveV9tcWRfc2RtYTsNCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1ka2ZkL2tmZF9tcWRfbWFuYWdlcl92aS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRrZmQva2ZkX21xZF9tYW5hZ2VyX3ZpLmMNCj4gaW5kZXggMDBlNmE1OS4uN2QxNDRmNSAxMDA2
NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX21xZF9tYW5hZ2VyX3Zp
LmMNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX21xZF9tYW5hZ2VyX3Zp
LmMNCj4gQEAgLTgwLDkgKzgwLDYgQEAgc3RhdGljIHN0cnVjdCBrZmRfbWVtX29iaiAqYWxsb2Nh
dGVfbXFkKHN0cnVjdCBrZmRfZGV2ICprZmQsDQo+ICAgew0KPiAgIAlzdHJ1Y3Qga2ZkX21lbV9v
YmogKm1xZF9tZW1fb2JqOw0KPiAgIA0KPiAtCWlmIChxLT50eXBlID09IEtGRF9RVUVVRV9UWVBF
X0hJUSkNCj4gLQkJcmV0dXJuIGFsbG9jYXRlX2hpcV9tcWQoa2ZkKTsNCj4gLQ0KPiAgIAlpZiAo
a2ZkX2d0dF9zYV9hbGxvY2F0ZShrZmQsIHNpemVvZihzdHJ1Y3QgdmlfbXFkKSwNCj4gICAJCQkm
bXFkX21lbV9vYmopKQ0KPiAgIAkJcmV0dXJuIE5VTEw7DQo+IEBAIC05MCwyMSArODcsMTUgQEAg
c3RhdGljIHN0cnVjdCBrZmRfbWVtX29iaiAqYWxsb2NhdGVfbXFkKHN0cnVjdCBrZmRfZGV2ICpr
ZmQsDQo+ICAgCXJldHVybiBtcWRfbWVtX29iajsNCj4gICB9DQo+ICAgDQo+IC1zdGF0aWMgaW50
IGluaXRfbXFkKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKiptcWQsDQo+IC0JCQlzdHJ1
Y3Qga2ZkX21lbV9vYmogKiptcWRfbWVtX29iaiwgdWludDY0X3QgKmdhcnRfYWRkciwNCj4gK3N0
YXRpYyB2b2lkIGluaXRfbXFkKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKiptcWQsDQo+
ICsJCQlzdHJ1Y3Qga2ZkX21lbV9vYmogKm1xZF9tZW1fb2JqLCB1aW50NjRfdCAqZ2FydF9hZGRy
LA0KPiAgIAkJCXN0cnVjdCBxdWV1ZV9wcm9wZXJ0aWVzICpxKQ0KPiAgIHsNCj4gLQlpbnQgcmV0
dmFsOw0KPiAgIAl1aW50NjRfdCBhZGRyOw0KPiAgIAlzdHJ1Y3QgdmlfbXFkICptOw0KPiAtCXN0
cnVjdCBrZmRfZGV2ICprZmQgPSBtbS0+ZGV2Ow0KPiAtDQo+IC0JKm1xZF9tZW1fb2JqID0gYWxs
b2NhdGVfbXFkKGtmZCwgcSk7DQo+IC0JaWYgKCEqbXFkX21lbV9vYmopDQo+IC0JCXJldHVybiAt
RU5PTUVNOw0KPiAgIA0KPiAtCW0gPSAoc3RydWN0IHZpX21xZCAqKSAoKm1xZF9tZW1fb2JqKS0+
Y3B1X3B0cjsNCj4gLQlhZGRyID0gKCptcWRfbWVtX29iaiktPmdwdV9hZGRyOw0KPiArCW0gPSAo
c3RydWN0IHZpX21xZCAqKSBtcWRfbWVtX29iai0+Y3B1X3B0cjsNCj4gKwlhZGRyID0gbXFkX21l
bV9vYmotPmdwdV9hZGRyOw0KPiAgIA0KPiAgIAltZW1zZXQobSwgMCwgc2l6ZW9mKHN0cnVjdCB2
aV9tcWQpKTsNCj4gICANCj4gQEAgLTE1OSw5ICsxNTAsNyBAQCBzdGF0aWMgaW50IGluaXRfbXFk
KHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKiptcWQsDQo+ICAgCSptcWQgPSBtOw0KPiAg
IAlpZiAoZ2FydF9hZGRyKQ0KPiAgIAkJKmdhcnRfYWRkciA9IGFkZHI7DQo+IC0JcmV0dmFsID0g
bW0tPnVwZGF0ZV9tcWQobW0sIG0sIHEpOw0KPiAtDQo+IC0JcmV0dXJuIHJldHZhbDsNCj4gKwlt
bS0+dXBkYXRlX21xZChtbSwgbSwgcSk7DQo+ICAgfQ0KPiAgIA0KPiAgIHN0YXRpYyBpbnQgbG9h
ZF9tcWQoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiBAQCAtMTc3LDcgKzE2
Niw3IEBAIHN0YXRpYyBpbnQgbG9hZF9tcWQoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAq
bXFkLA0KPiAgIAkJCQkJICB3cHRyX3NoaWZ0LCB3cHRyX21hc2ssIG1tcyk7DQo+ICAgfQ0KPiAg
IA0KPiAtc3RhdGljIGludCBfX3VwZGF0ZV9tcWQoc3RydWN0IG1xZF9tYW5hZ2VyICptbSwgdm9p
ZCAqbXFkLA0KPiArc3RhdGljIHZvaWQgX191cGRhdGVfbXFkKHN0cnVjdCBtcWRfbWFuYWdlciAq
bW0sIHZvaWQgKm1xZCwNCj4gICAJCQlzdHJ1Y3QgcXVldWVfcHJvcGVydGllcyAqcSwgdW5zaWdu
ZWQgaW50IG10eXBlLA0KPiAgIAkJCXVuc2lnbmVkIGludCBhdGNfYml0KQ0KPiAgIHsNCj4gQEAg
LTI0NSwyMSArMjM0LDE5IEBAIHN0YXRpYyBpbnQgX191cGRhdGVfbXFkKHN0cnVjdCBtcWRfbWFu
YWdlciAqbW0sIHZvaWQgKm1xZCwNCj4gICAJc2V0X3ByaW9yaXR5KG0sIHEpOw0KPiAgIA0KPiAg
IAlxLT5pc19hY3RpdmUgPSBRVUVVRV9JU19BQ1RJVkUoKnEpOw0KPiAtDQo+IC0JcmV0dXJuIDA7
DQo+ICAgfQ0KPiAgIA0KPiAgIA0KPiAtc3RhdGljIGludCB1cGRhdGVfbXFkKHN0cnVjdCBtcWRf
bWFuYWdlciAqbW0sIHZvaWQgKm1xZCwNCj4gK3N0YXRpYyB2b2lkIHVwZGF0ZV9tcWQoc3RydWN0
IG1xZF9tYW5hZ2VyICptbSwgdm9pZCAqbXFkLA0KPiAgIAkJCXN0cnVjdCBxdWV1ZV9wcm9wZXJ0
aWVzICpxKQ0KPiAgIHsNCj4gLQlyZXR1cm4gX191cGRhdGVfbXFkKG1tLCBtcWQsIHEsIE1UWVBF
X0NDLCAxKTsNCj4gKwlfX3VwZGF0ZV9tcWQobW0sIG1xZCwgcSwgTVRZUEVfQ0MsIDEpOw0KPiAg
IH0NCj4gICANCj4gLXN0YXRpYyBpbnQgdXBkYXRlX21xZF90b25nYShzdHJ1Y3QgbXFkX21hbmFn
ZXIgKm1tLCB2b2lkICptcWQsDQo+ICtzdGF0aWMgdm9pZCB1cGRhdGVfbXFkX3RvbmdhKHN0cnVj
dCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKm1xZCwNCj4gICAJCQlzdHJ1Y3QgcXVldWVfcHJvcGVy
dGllcyAqcSkNCj4gICB7DQo+IC0JcmV0dXJuIF9fdXBkYXRlX21xZChtbSwgbXFkLCBxLCBNVFlQ
RV9VQywgMCk7DQo+ICsJX191cGRhdGVfbXFkKG1tLCBtcWQsIHEsIE1UWVBFX1VDLCAwKTsNCj4g
ICB9DQo+ICAgDQo+ICAgc3RhdGljIGludCBkZXN0cm95X21xZChzdHJ1Y3QgbXFkX21hbmFnZXIg
Km1tLCB2b2lkICptcWQsDQo+IEBAIC0yNzIsNyArMjU5LDcgQEAgc3RhdGljIGludCBkZXN0cm95
X21xZChzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICAgCQlwaXBlX2lkLCBx
dWV1ZV9pZCk7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIHZvaWQgdW5pbml0X21xZChzdHJ1Y3Qg
bXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICtzdGF0aWMgdm9pZCBmcmVlX21xZChzdHJ1
Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICAgCQkJc3RydWN0IGtmZF9tZW1fb2Jq
ICptcWRfbWVtX29iaikNCj4gICB7DQo+ICAgCWtmZF9ndHRfc2FfZnJlZShtbS0+ZGV2LCBtcWRf
bWVtX29iaik7DQo+IEBAIC0zMDksNjEgKzI5Niw0NCBAQCBzdGF0aWMgaW50IGdldF93YXZlX3N0
YXRlKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKm1xZCwNCj4gICAJcmV0dXJuIDA7DQo+
ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCBpbml0X21xZF9oaXEoc3RydWN0IG1xZF9tYW5hZ2Vy
ICptbSwgdm9pZCAqKm1xZCwNCj4gLQkJCXN0cnVjdCBrZmRfbWVtX29iaiAqKm1xZF9tZW1fb2Jq
LCB1aW50NjRfdCAqZ2FydF9hZGRyLA0KPiArc3RhdGljIHZvaWQgaW5pdF9tcWRfaGlxKHN0cnVj
dCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKiptcWQsDQo+ICsJCQlzdHJ1Y3Qga2ZkX21lbV9vYmog
Km1xZF9tZW1fb2JqLCB1aW50NjRfdCAqZ2FydF9hZGRyLA0KPiAgIAkJCXN0cnVjdCBxdWV1ZV9w
cm9wZXJ0aWVzICpxKQ0KPiAgIHsNCj4gICAJc3RydWN0IHZpX21xZCAqbTsNCj4gLQlpbnQgcmV0
dmFsID0gaW5pdF9tcWQobW0sIG1xZCwgbXFkX21lbV9vYmosIGdhcnRfYWRkciwgcSk7DQo+IC0N
Cj4gLQlpZiAocmV0dmFsICE9IDApDQo+IC0JCXJldHVybiByZXR2YWw7DQo+ICsJaW5pdF9tcWQo
bW0sIG1xZCwgbXFkX21lbV9vYmosIGdhcnRfYWRkciwgcSk7DQo+ICAgDQo+ICAgCW0gPSBnZXRf
bXFkKCptcWQpOw0KPiAgIA0KPiAgIAltLT5jcF9ocWRfcHFfY29udHJvbCB8PSAxIDw8IENQX0hR
RF9QUV9DT05UUk9MX19QUklWX1NUQVRFX19TSElGVCB8DQo+ICAgCQkJMSA8PCBDUF9IUURfUFFf
Q09OVFJPTF9fS01EX1FVRVVFX19TSElGVDsNCj4gLQ0KPiAtCXJldHVybiByZXR2YWw7DQo+ICAg
fQ0KPiAgIA0KPiAtc3RhdGljIGludCB1cGRhdGVfbXFkX2hpcShzdHJ1Y3QgbXFkX21hbmFnZXIg
Km1tLCB2b2lkICptcWQsDQo+ICtzdGF0aWMgdm9pZCB1cGRhdGVfbXFkX2hpcShzdHJ1Y3QgbXFk
X21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICAgCQkJc3RydWN0IHF1ZXVlX3Byb3BlcnRpZXMg
KnEpDQo+ICAgew0KPiAgIAlzdHJ1Y3QgdmlfbXFkICptOw0KPiAtCWludCByZXR2YWwgPSBfX3Vw
ZGF0ZV9tcWQobW0sIG1xZCwgcSwgTVRZUEVfVUMsIDApOw0KPiAtDQo+IC0JaWYgKHJldHZhbCAh
PSAwKQ0KPiAtCQlyZXR1cm4gcmV0dmFsOw0KPiArCV9fdXBkYXRlX21xZChtbSwgbXFkLCBxLCBN
VFlQRV9VQywgMCk7DQo+ICAgDQo+ICAgCW0gPSBnZXRfbXFkKG1xZCk7DQo+ICAgCW0tPmNwX2hx
ZF92bWlkID0gcS0+dm1pZDsNCj4gLQlyZXR1cm4gcmV0dmFsOw0KPiAgIH0NCj4gICANCj4gLXN0
YXRpYyBpbnQgaW5pdF9tcWRfc2RtYShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICoqbXFk
LA0KPiAtCQlzdHJ1Y3Qga2ZkX21lbV9vYmogKiptcWRfbWVtX29iaiwgdWludDY0X3QgKmdhcnRf
YWRkciwNCj4gK3N0YXRpYyB2b2lkIGluaXRfbXFkX3NkbWEoc3RydWN0IG1xZF9tYW5hZ2VyICpt
bSwgdm9pZCAqKm1xZCwNCj4gKwkJc3RydWN0IGtmZF9tZW1fb2JqICptcWRfbWVtX29iaiwgdWlu
dDY0X3QgKmdhcnRfYWRkciwNCj4gICAJCXN0cnVjdCBxdWV1ZV9wcm9wZXJ0aWVzICpxKQ0KPiAg
IHsNCj4gLQlpbnQgcmV0dmFsOw0KPiAgIAlzdHJ1Y3Qgdmlfc2RtYV9tcWQgKm07DQo+IC0Jc3Ry
dWN0IGtmZF9kZXYgKmRldiA9IG1tLT5kZXY7DQo+IC0NCj4gLQkqbXFkX21lbV9vYmogPSBhbGxv
Y2F0ZV9zZG1hX21xZChkZXYsIHEpOw0KPiAtCWlmICghKm1xZF9tZW1fb2JqKQ0KPiAtCQlyZXR1
cm4gLUVOT01FTTsNCj4gICANCj4gLQltID0gKHN0cnVjdCB2aV9zZG1hX21xZCAqKSAoKm1xZF9t
ZW1fb2JqKS0+Y3B1X3B0cjsNCj4gKwltID0gKHN0cnVjdCB2aV9zZG1hX21xZCAqKSBtcWRfbWVt
X29iai0+Y3B1X3B0cjsNCj4gICANCj4gICAJbWVtc2V0KG0sIDAsIHNpemVvZihzdHJ1Y3Qgdmlf
c2RtYV9tcWQpKTsNCj4gICANCj4gICAJKm1xZCA9IG07DQo+ICAgCWlmIChnYXJ0X2FkZHIpDQo+
IC0JCSpnYXJ0X2FkZHIgPSAoKm1xZF9tZW1fb2JqKS0+Z3B1X2FkZHI7DQo+ICsJCSpnYXJ0X2Fk
ZHIgPSBtcWRfbWVtX29iai0+Z3B1X2FkZHI7DQo+ICAgDQo+IC0JcmV0dmFsID0gbW0tPnVwZGF0
ZV9tcWQobW0sIG0sIHEpOw0KPiAtDQo+IC0JcmV0dXJuIHJldHZhbDsNCj4gKwltbS0+dXBkYXRl
X21xZChtbSwgbSwgcSk7DQo+ICAgfQ0KPiAgIA0KPiAgIHN0YXRpYyBpbnQgbG9hZF9tcWRfc2Rt
YShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+IEBAIC0zNzUsNyArMzQ1LDcg
QEAgc3RhdGljIGludCBsb2FkX21xZF9zZG1hKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQg
Km1xZCwNCj4gICAJCQkJCSAgICAgICBtbXMpOw0KPiAgIH0NCj4gICANCj4gLXN0YXRpYyBpbnQg
dXBkYXRlX21xZF9zZG1hKHN0cnVjdCBtcWRfbWFuYWdlciAqbW0sIHZvaWQgKm1xZCwNCj4gK3N0
YXRpYyB2b2lkIHVwZGF0ZV9tcWRfc2RtYShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICpt
cWQsDQo+ICAgCQlzdHJ1Y3QgcXVldWVfcHJvcGVydGllcyAqcSkNCj4gICB7DQo+ICAgCXN0cnVj
dCB2aV9zZG1hX21xZCAqbTsNCj4gQEAgLTQwMCw4ICszNzAsNiBAQCBzdGF0aWMgaW50IHVwZGF0
ZV9tcWRfc2RtYShzdHJ1Y3QgbXFkX21hbmFnZXIgKm1tLCB2b2lkICptcWQsDQo+ICAgCW0tPnNk
bWFfcXVldWVfaWQgPSBxLT5zZG1hX3F1ZXVlX2lkOw0KPiAgIA0KPiAgIAlxLT5pc19hY3RpdmUg
PSBRVUVVRV9JU19BQ1RJVkUoKnEpOw0KPiAtDQo+IC0JcmV0dXJuIDA7DQo+ICAgfQ0KPiAgIA0K
PiAgIC8qDQo+IEBAIC00NTgsOCArNDI2LDkgQEAgc3RydWN0IG1xZF9tYW5hZ2VyICptcWRfbWFu
YWdlcl9pbml0X3ZpKGVudW0gS0ZEX01RRF9UWVBFIHR5cGUsDQo+ICAgCXN3aXRjaCAodHlwZSkg
ew0KPiAgIAljYXNlIEtGRF9NUURfVFlQRV9DUDoNCj4gICAJY2FzZSBLRkRfTVFEX1RZUEVfQ09N
UFVURToNCj4gKwkJbXFkLT5hbGxvY2F0ZV9tcWQgPSBhbGxvY2F0ZV9tcWQ7DQo+ICAgCQltcWQt
PmluaXRfbXFkID0gaW5pdF9tcWQ7DQo+IC0JCW1xZC0+dW5pbml0X21xZCA9IHVuaW5pdF9tcWQ7
DQo+ICsJCW1xZC0+ZnJlZV9tcWQgPSBmcmVlX21xZDsNCj4gICAJCW1xZC0+bG9hZF9tcWQgPSBs
b2FkX21xZDsNCj4gICAJCW1xZC0+dXBkYXRlX21xZCA9IHVwZGF0ZV9tcWQ7DQo+ICAgCQltcWQt
PmRlc3Ryb3lfbXFkID0gZGVzdHJveV9tcWQ7DQo+IEBAIC00NzEsOCArNDQwLDkgQEAgc3RydWN0
IG1xZF9tYW5hZ2VyICptcWRfbWFuYWdlcl9pbml0X3ZpKGVudW0gS0ZEX01RRF9UWVBFIHR5cGUs
DQo+ICAgI2VuZGlmDQo+ICAgCQlicmVhazsNCj4gICAJY2FzZSBLRkRfTVFEX1RZUEVfSElROg0K
PiArCQltcWQtPmFsbG9jYXRlX21xZCA9IGFsbG9jYXRlX2hpcV9tcWQ7DQo+ICAgCQltcWQtPmlu
aXRfbXFkID0gaW5pdF9tcWRfaGlxOw0KPiAtCQltcWQtPnVuaW5pdF9tcWQgPSB1bmluaXRfbXFk
X2hpcV9zZG1hOw0KPiArCQltcWQtPmZyZWVfbXFkID0gZnJlZV9tcWRfaGlxX3NkbWE7DQo+ICAg
CQltcWQtPmxvYWRfbXFkID0gbG9hZF9tcWQ7DQo+ICAgCQltcWQtPnVwZGF0ZV9tcWQgPSB1cGRh
dGVfbXFkX2hpcTsNCj4gICAJCW1xZC0+ZGVzdHJveV9tcWQgPSBkZXN0cm95X21xZDsNCj4gQEAg
LTQ4Myw4ICs0NTMsOSBAQCBzdHJ1Y3QgbXFkX21hbmFnZXIgKm1xZF9tYW5hZ2VyX2luaXRfdmko
ZW51bSBLRkRfTVFEX1RZUEUgdHlwZSwNCj4gICAjZW5kaWYNCj4gICAJCWJyZWFrOw0KPiAgIAlj
YXNlIEtGRF9NUURfVFlQRV9ESVE6DQo+ICsJCW1xZC0+YWxsb2NhdGVfbXFkID0gYWxsb2NhdGVf
aGlxX21xZDsNCj4gICAJCW1xZC0+aW5pdF9tcWQgPSBpbml0X21xZF9oaXE7DQo+IC0JCW1xZC0+
dW5pbml0X21xZCA9IHVuaW5pdF9tcWQ7DQo+ICsJCW1xZC0+ZnJlZV9tcWQgPSBmcmVlX21xZDsN
Cj4gICAJCW1xZC0+bG9hZF9tcWQgPSBsb2FkX21xZDsNCj4gICAJCW1xZC0+dXBkYXRlX21xZCA9
IHVwZGF0ZV9tcWRfaGlxOw0KPiAgIAkJbXFkLT5kZXN0cm95X21xZCA9IGRlc3Ryb3lfbXFkOw0K
PiBAQCAtNDk1LDggKzQ2Niw5IEBAIHN0cnVjdCBtcWRfbWFuYWdlciAqbXFkX21hbmFnZXJfaW5p
dF92aShlbnVtIEtGRF9NUURfVFlQRSB0eXBlLA0KPiAgICNlbmRpZg0KPiAgIAkJYnJlYWs7DQo+
ICAgCWNhc2UgS0ZEX01RRF9UWVBFX1NETUE6DQo+ICsJCW1xZC0+YWxsb2NhdGVfbXFkID0gYWxs
b2NhdGVfc2RtYV9tcWQ7DQo+ICAgCQltcWQtPmluaXRfbXFkID0gaW5pdF9tcWRfc2RtYTsNCj4g
LQkJbXFkLT51bmluaXRfbXFkID0gdW5pbml0X21xZF9oaXFfc2RtYTsNCj4gKwkJbXFkLT5mcmVl
X21xZCA9IGZyZWVfbXFkX2hpcV9zZG1hOw0KPiAgIAkJbXFkLT5sb2FkX21xZCA9IGxvYWRfbXFk
X3NkbWE7DQo+ICAgCQltcWQtPnVwZGF0ZV9tcWQgPSB1cGRhdGVfbXFkX3NkbWE7DQo+ICAgCQlt
cWQtPmRlc3Ryb3lfbXFkID0gZGVzdHJveV9tcWRfc2RtYTsNCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vYW1kLWdmeA==
