Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id AD7761A0F1D
	for <lists+amd-gfx@lfdr.de>; Tue,  7 Apr 2020 16:27:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3A7D36E885;
	Tue,  7 Apr 2020 14:27:36 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wm1-x343.google.com (mail-wm1-x343.google.com
 [IPv6:2a00:1450:4864:20::343])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E9FA96E885
 for <amd-gfx@lists.freedesktop.org>; Tue,  7 Apr 2020 14:27:34 +0000 (UTC)
Received: by mail-wm1-x343.google.com with SMTP id t203so1947408wmt.2
 for <amd-gfx@lists.freedesktop.org>; Tue, 07 Apr 2020 07:27:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=+EMPjx25oZujJyuGlOqOp+1nNF9Zcsucn6/wH65P8tk=;
 b=OYI4nqIbvhYAd1/Nm/cmguPBD6x33cRuJTL5T+iiVV9zuuCdL3aIBa1uR2x0YTnOGN
 YvJrsvGDa4g4G18IBSPTkLS9ifo2Zl0dbhaLkklxlmtM1ZjC2F41wH2jRYJarS95ytp6
 vsmbXYfrebcXCOxGEdRaFxkPM5MPy4AExgcVtUM4ugVxA6ZYoD7XXHKkMP/vMSZh46Jf
 6jQv6kb6uh8g1Ot1OzBKhyegmU51gq+S5tpqeQMiVrrp+R5knUgcvmHAwymFZM2IJI3k
 TdMARGpGATfGPNKZo3VD57OHU2bcgyQRFSdB4anE/CyHO5gzYgKykt/F5+qGYwxk83e9
 v0Iw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=+EMPjx25oZujJyuGlOqOp+1nNF9Zcsucn6/wH65P8tk=;
 b=fFLmyOL6uWYsXfAg98tyDsPFJ2CC03bp+kJE3xivq1wTnGdGbZ7HUXTZ4bfRXLdrE/
 rdcI+IXVyRRc9CKUdokBbUy6YpMh3SvrM7n56GSrDDleKflrEB0S40PvaRGwF4F+Ew1x
 S7q9s4E54kU0h20xHmL98I9EMib6fc/JY6/8HybbNueVac6j+Ly1pkYsREJqcUte18lR
 CArIRQzKknm9c1pOp9hZKVuepglgSy6wQnygA0WjaqgWpEyqDrDy6GhrDur2GWXoIfAu
 D5XbGfDP2RK3FmC7viNkCGJ0BHQ79aprWZdvkSWVwr0OYFC7cKQjajGDpVRBRbPCTh6s
 edUQ==
X-Gm-Message-State: AGi0PuY0+08Bz25OYzA8fJw4QwIFR7I+Sk7qybH+wo6Z0SxhqmFTRfjl
 nuelll7gQn5VTT/gp6pqJoXQX9MU
X-Google-Smtp-Source: APiQypLemnnDb8vQ8N8fSERAo/tP8MRzHf6+SrHF1cJcE0843mqvO8g0kt1EYiDGaocz2p2fFXSqKw==
X-Received: by 2002:a1c:a9d3:: with SMTP id s202mr2680379wme.160.1586269650208; 
 Tue, 07 Apr 2020 07:27:30 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:cb4:6800:b8cb:179f])
 by smtp.gmail.com with ESMTPSA id r4sm2733782wrj.57.2020.04.07.07.27.29
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 07 Apr 2020 07:27:29 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: amd-gfx@lists.freedesktop.org, Felix.Kuehling@amd.com, Alex.Sierra@amd.com
Subject: [PATCH 4/4] drm/amdgpu: add new unlocked flag for PTE updates
Date: Tue,  7 Apr 2020 16:27:25 +0200
Message-Id: <20200407142725.17668-4-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200407142725.17668-1-christian.koenig@amd.com>
References: <20200407142725.17668-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

Rm9yIEhNTSBzdXBwb3J0IHdlIG5lZWQgdGhlIGFiaWxpdHkgdG8gaW52YWxpZGF0ZSBQVEVzIGZy
b20KYSBNTSBjYWxsYmFjayB3aGVyZSB3ZSBjYW4ndCBsb2NrIHRoZSByb290IFBELgoKQWRkIGEg
bmV3IGZsYWcgdG8gYmV0dGVyIHN1cHBvcnQgdGhpcyBpbnN0ZWFkIG9mIGFzc3VtaW5nCnRoYXQg
YWxsIGludmFsaWRhdGlvbiB1cGRhdGVzIGFyZSB1bmxvY2tlZC4KClNpZ25lZC1vZmYtYnk6IENo
cmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYyAgICAgIHwgNDIgKysrKysrKysrKysrLS0tLS0t
LS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uaCAgICAgIHwgIDkgKysr
Ky0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bV9zZG1hLmMgfCAxMiArKyst
LS0KIDMgZmlsZXMgY2hhbmdlZCwgMzcgaW5zZXJ0aW9ucygrKSwgMjYgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYwppbmRleCAxZWU4N2I0NjBiOTYuLjRj
YTRmNjFiMzRjYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3ZtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMKQEAgLTE0
NDYsNyArMTQ0Niw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3ZtX3VwZGF0ZV9wdGVzKHN0cnVjdCBh
bWRncHVfdm1fdXBkYXRlX3BhcmFtcyAqcGFyYW1zLAogCQl1aW50NjRfdCBpbmNyLCBlbnRyeV9l
bmQsIHBlX3N0YXJ0OwogCQlzdHJ1Y3QgYW1kZ3B1X2JvICpwdDsKIAotCQlpZiAoZmxhZ3MgJiAo
QU1ER1BVX1BURV9WQUxJRCB8IEFNREdQVV9QVEVfUFJUKSkgeworCQlpZiAoIXBhcmFtcy0+dW5s
b2NrZWQpIHsKIAkJCS8qIG1ha2Ugc3VyZSB0aGF0IHRoZSBwYWdlIHRhYmxlcyBjb3ZlcmluZyB0
aGUKIAkJCSAqIGFkZHJlc3MgcmFuZ2UgYXJlIGFjdHVhbGx5IGFsbG9jYXRlZAogCQkJICovCkBA
IC0xNDU4LDggKzE0NTgsMTIgQEAgc3RhdGljIGludCBhbWRncHVfdm1fdXBkYXRlX3B0ZXMoc3Ry
dWN0IGFtZGdwdV92bV91cGRhdGVfcGFyYW1zICpwYXJhbXMsCiAKIAkJc2hpZnQgPSBhbWRncHVf
dm1fbGV2ZWxfc2hpZnQoYWRldiwgY3Vyc29yLmxldmVsKTsKIAkJcGFyZW50X3NoaWZ0ID0gYW1k
Z3B1X3ZtX2xldmVsX3NoaWZ0KGFkZXYsIGN1cnNvci5sZXZlbCAtIDEpOwotCQlpZiAoYWRldi0+
YXNpY190eXBlIDwgQ0hJUF9WRUdBMTAgJiYKLQkJICAgIChmbGFncyAmIEFNREdQVV9QVEVfVkFM
SUQpKSB7CisJCWlmIChwYXJhbXMtPnVubG9ja2VkKSB7CisJCQkvKiBVbmxvY2tlZCB1cGRhdGVz
IGFyZSBvbmx5IGFsbG93ZWQgb24gdGhlIGxlYXZlcyAqLworCQkJaWYgKGFtZGdwdV92bV9wdF9k
ZXNjZW5kYW50KGFkZXYsICZjdXJzb3IpKQorCQkJCWNvbnRpbnVlOworCQl9IGVsc2UgaWYgKGFk
ZXYtPmFzaWNfdHlwZSA8IENISVBfVkVHQTEwICYmCisJCQkgICAoZmxhZ3MgJiBBTURHUFVfUFRF
X1ZBTElEKSkgewogCQkJLyogTm8gaHVnZSBwYWdlIHN1cHBvcnQgYmVmb3JlIEdNQyB2OSAqLwog
CQkJaWYgKGN1cnNvci5sZXZlbCAhPSBBTURHUFVfVk1fUFRCKSB7CiAJCQkJaWYgKCFhbWRncHVf
dm1fcHRfZGVzY2VuZGFudChhZGV2LCAmY3Vyc29yKSkKQEAgLTE1NTgsNiArMTU2Miw3IEBAIHN0
YXRpYyBpbnQgYW1kZ3B1X3ZtX3VwZGF0ZV9wdGVzKHN0cnVjdCBhbWRncHVfdm1fdXBkYXRlX3Bh
cmFtcyAqcGFyYW1zLAogICogQGFkZXY6IGFtZGdwdV9kZXZpY2UgcG9pbnRlcgogICogQHZtOiBy
ZXF1ZXN0ZWQgdm0KICAqIEBpbW1lZGlhdGU6IGltbWVkaWF0ZSBzdWJtaXNzaW9uIGluIGEgcGFn
ZSBmYXVsdAorICogQHVubG9ja2VkOiB1bmxvY2tlZCBpbnZhbGlkYXRpb24gZHVyaW5nIE1NIGNh
bGxiYWNrCiAgKiBAcmVzdjogZmVuY2VzIHdlIG5lZWQgdG8gc3luYyB0bwogICogQHN0YXJ0OiBz
dGFydCBvZiBtYXBwZWQgcmFuZ2UKICAqIEBsYXN0OiBsYXN0IG1hcHBlZCBlbnRyeQpAQCAtMTU3
Myw3ICsxNTc4LDcgQEAgc3RhdGljIGludCBhbWRncHVfdm1fdXBkYXRlX3B0ZXMoc3RydWN0IGFt
ZGdwdV92bV91cGRhdGVfcGFyYW1zICpwYXJhbXMsCiAgKi8KIHN0YXRpYyBpbnQgYW1kZ3B1X3Zt
X2JvX3VwZGF0ZV9tYXBwaW5nKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCQkJCSAgICAg
ICBzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwgYm9vbCBpbW1lZGlhdGUsCi0JCQkJICAgICAgIHN0cnVj
dCBkbWFfcmVzdiAqcmVzdiwKKwkJCQkgICAgICAgYm9vbCB1bmxvY2tlZCwgc3RydWN0IGRtYV9y
ZXN2ICpyZXN2LAogCQkJCSAgICAgICB1aW50NjRfdCBzdGFydCwgdWludDY0X3QgbGFzdCwKIAkJ
CQkgICAgICAgdWludDY0X3QgZmxhZ3MsIHVpbnQ2NF90IGFkZHIsCiAJCQkJICAgICAgIGRtYV9h
ZGRyX3QgKnBhZ2VzX2FkZHIsCkBAIC0xNjAzLDExICsxNjA4LDEyIEBAIHN0YXRpYyBpbnQgYW1k
Z3B1X3ZtX2JvX3VwZGF0ZV9tYXBwaW5nKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCQln
b3RvIGVycm9yX3VubG9jazsKIAl9CiAKLQlpZiAoZmxhZ3MgJiAoQU1ER1BVX1BURV9WQUxJRCB8
IEFNREdQVV9QVEVfUFJUKSkgewotCQlzdHJ1Y3QgYW1kZ3B1X2JvICpyb290ID0gdm0tPnJvb3Qu
YmFzZS5ibzsKKwlpZiAoIXVubG9ja2VkICYmICFkbWFfZmVuY2VfaXNfc2lnbmFsZWQodm0tPmxh
c3RfdW5sb2NrZWQpKSB7CisJCXN0cnVjdCBkbWFfZmVuY2UgKnRtcCA9IGRtYV9mZW5jZV9nZXRf
c3R1YigpOwogCi0JCWlmICghZG1hX2ZlbmNlX2lzX3NpZ25hbGVkKHZtLT5sYXN0X2ltbWVkaWF0
ZSkpCi0JCQlhbWRncHVfYm9fZmVuY2Uocm9vdCwgdm0tPmxhc3RfaW1tZWRpYXRlLCB0cnVlKTsK
KwkJYW1kZ3B1X2JvX2ZlbmNlKHZtLT5yb290LmJhc2UuYm8sIHZtLT5sYXN0X3VubG9ja2VkLCB0
cnVlKTsKKwkJc3dhcCh2bS0+bGFzdF91bmxvY2tlZCwgdG1wKTsKKwkJZG1hX2ZlbmNlX3B1dCh0
bXApOwogCX0KIAogCXIgPSB2bS0+dXBkYXRlX2Z1bmNzLT5wcmVwYXJlKCZwYXJhbXMsIHJlc3Ys
IHN5bmNfbW9kZSk7CkBAIC0xNzIxLDcgKzE3MjcsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV92bV9i
b19zcGxpdF9tYXBwaW5nKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCQl9CiAKIAkJbGFz
dCA9IG1pbigodWludDY0X3QpbWFwcGluZy0+bGFzdCwgc3RhcnQgKyBtYXhfZW50cmllcyAtIDEp
OwotCQlyID0gYW1kZ3B1X3ZtX2JvX3VwZGF0ZV9tYXBwaW5nKGFkZXYsIHZtLCBmYWxzZSwgcmVz
diwKKwkJciA9IGFtZGdwdV92bV9ib191cGRhdGVfbWFwcGluZyhhZGV2LCB2bSwgZmFsc2UsIGZh
bHNlLCByZXN2LAogCQkJCQkJc3RhcnQsIGxhc3QsIGZsYWdzLCBhZGRyLAogCQkJCQkJZG1hX2Fk
ZHIsIGZlbmNlKTsKIAkJaWYgKHIpCkBAIC0yMDE4LDcgKzIwMjQsNyBAQCBpbnQgYW1kZ3B1X3Zt
X2NsZWFyX2ZyZWVkKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCQkgICAgbWFwcGluZy0+
c3RhcnQgPCBBTURHUFVfR01DX0hPTEVfU1RBUlQpCiAJCQlpbml0X3B0ZV92YWx1ZSA9IEFNREdQ
VV9QVEVfREVGQVVMVF9BVEM7CiAKLQkJciA9IGFtZGdwdV92bV9ib191cGRhdGVfbWFwcGluZyhh
ZGV2LCB2bSwgZmFsc2UsIHJlc3YsCisJCXIgPSBhbWRncHVfdm1fYm9fdXBkYXRlX21hcHBpbmco
YWRldiwgdm0sIGZhbHNlLCBmYWxzZSwgcmVzdiwKIAkJCQkJCW1hcHBpbmctPnN0YXJ0LCBtYXBw
aW5nLT5sYXN0LAogCQkJCQkJaW5pdF9wdGVfdmFsdWUsIDAsIE5VTEwsICZmKTsKIAkJYW1kZ3B1
X3ZtX2ZyZWVfbWFwcGluZyhhZGV2LCB2bSwgbWFwcGluZywgZik7CkBAIC0yNTg5LDcgKzI1OTUs
NyBAQCBib29sIGFtZGdwdV92bV9ldmljdGFibGUoc3RydWN0IGFtZGdwdV9ibyAqYm8pCiAJCXJl
dHVybiBmYWxzZTsKIAogCS8qIERvbid0IGV2aWN0IFZNIHBhZ2UgdGFibGVzIHdoaWxlIHRoZXkg
YXJlIHVwZGF0ZWQgKi8KLQlpZiAoIWRtYV9mZW5jZV9pc19zaWduYWxlZChib19iYXNlLT52bS0+
bGFzdF9pbW1lZGlhdGUpKSB7CisJaWYgKCFkbWFfZmVuY2VfaXNfc2lnbmFsZWQoYm9fYmFzZS0+
dm0tPmxhc3RfdW5sb2NrZWQpKSB7CiAJCWFtZGdwdV92bV9ldmljdGlvbl91bmxvY2soYm9fYmFz
ZS0+dm0pOwogCQlyZXR1cm4gZmFsc2U7CiAJfQpAQCAtMjc2Niw3ICsyNzcyLDcgQEAgbG9uZyBh
bWRncHVfdm1fd2FpdF9pZGxlKHN0cnVjdCBhbWRncHVfdm0gKnZtLCBsb25nIHRpbWVvdXQpCiAJ
aWYgKHRpbWVvdXQgPD0gMCkKIAkJcmV0dXJuIHRpbWVvdXQ7CiAKLQlyZXR1cm4gZG1hX2ZlbmNl
X3dhaXRfdGltZW91dCh2bS0+bGFzdF9pbW1lZGlhdGUsIHRydWUsIHRpbWVvdXQpOworCXJldHVy
biBkbWFfZmVuY2Vfd2FpdF90aW1lb3V0KHZtLT5sYXN0X3VubG9ja2VkLCB0cnVlLCB0aW1lb3V0
KTsKIH0KIAogLyoqCkBAIC0yODM4LDcgKzI4NDQsNyBAQCBpbnQgYW1kZ3B1X3ZtX2luaXQoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtLAogCWVsc2UKIAkJ
dm0tPnVwZGF0ZV9mdW5jcyA9ICZhbWRncHVfdm1fc2RtYV9mdW5jczsKIAl2bS0+bGFzdF91cGRh
dGUgPSBOVUxMOwotCXZtLT5sYXN0X2ltbWVkaWF0ZSA9IGRtYV9mZW5jZV9nZXRfc3R1YigpOwor
CXZtLT5sYXN0X3VubG9ja2VkID0gZG1hX2ZlbmNlX2dldF9zdHViKCk7CiAKIAltdXRleF9pbml0
KCZ2bS0+ZXZpY3Rpb25fbG9jayk7CiAJdm0tPmV2aWN0aW5nID0gZmFsc2U7CkBAIC0yODkyLDcg
KzI4OTgsNyBAQCBpbnQgYW1kZ3B1X3ZtX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
IHN0cnVjdCBhbWRncHVfdm0gKnZtLAogCXZtLT5yb290LmJhc2UuYm8gPSBOVUxMOwogCiBlcnJv
cl9mcmVlX2RlbGF5ZWQ6Ci0JZG1hX2ZlbmNlX3B1dCh2bS0+bGFzdF9pbW1lZGlhdGUpOworCWRt
YV9mZW5jZV9wdXQodm0tPmxhc3RfdW5sb2NrZWQpOwogCWRybV9zY2hlZF9lbnRpdHlfZGVzdHJv
eSgmdm0tPmRlbGF5ZWQpOwogCiBlcnJvcl9mcmVlX2ltbWVkaWF0ZToKQEAgLTMwOTMsOCArMzA5
OSw4IEBAIHZvaWQgYW1kZ3B1X3ZtX2Zpbmkoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHN0
cnVjdCBhbWRncHVfdm0gKnZtKQogCQl2bS0+cGFzaWQgPSAwOwogCX0KIAotCWRtYV9mZW5jZV93
YWl0KHZtLT5sYXN0X2ltbWVkaWF0ZSwgZmFsc2UpOwotCWRtYV9mZW5jZV9wdXQodm0tPmxhc3Rf
aW1tZWRpYXRlKTsKKwlkbWFfZmVuY2Vfd2FpdCh2bS0+bGFzdF91bmxvY2tlZCwgZmFsc2UpOwor
CWRtYV9mZW5jZV9wdXQodm0tPmxhc3RfdW5sb2NrZWQpOwogCiAJbGlzdF9mb3JfZWFjaF9lbnRy
eV9zYWZlKG1hcHBpbmcsIHRtcCwgJnZtLT5mcmVlZCwgbGlzdCkgewogCQlpZiAobWFwcGluZy0+
ZmxhZ3MgJiBBTURHUFVfUFRFX1BSVCAmJiBwcnRfZmluaV9uZWVkZWQpIHsKQEAgLTMzNDcsOCAr
MzM1Myw4IEBAIGJvb2wgYW1kZ3B1X3ZtX2hhbmRsZV9mYXVsdChzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwgdW5zaWduZWQgaW50IHBhc2lkLAogCQl2YWx1ZSA9IDA7CiAJfQogCi0JciA9IGFt
ZGdwdV92bV9ib191cGRhdGVfbWFwcGluZyhhZGV2LCB2bSwgdHJ1ZSwgTlVMTCwgYWRkciwgYWRk
ciArIDEsCi0JCQkJCWZsYWdzLCB2YWx1ZSwgTlVMTCwgTlVMTCk7CisJciA9IGFtZGdwdV92bV9i
b191cGRhdGVfbWFwcGluZyhhZGV2LCB2bSwgdHJ1ZSwgZmFsc2UsIE5VTEwsIGFkZHIsCisJCQkJ
CWFkZHIgKyAxLCBmbGFncywgdmFsdWUsIE5VTEwsIE5VTEwpOwogCWlmIChyKQogCQlnb3RvIGVy
cm9yX3VubG9jazsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3ZtLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uaAppbmRleCAw
YjY0MjAwZWM0NWYuLmVhNzcxZDg0YmYyYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3ZtLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3ZtLmgKQEAgLTIxMCw2ICsyMTAsMTEgQEAgc3RydWN0IGFtZGdwdV92bV91cGRhdGVfcGFy
YW1zIHsKIAkgKi8KIAlib29sIGltbWVkaWF0ZTsKIAorCS8qKgorCSAqIEB1bmxvY2tlZDogdHJ1
ZSBpZiB0aGUgcm9vdCBCTyBpcyBub3QgbG9ja2VkCisJICovCisJYm9vbCB1bmxvY2tlZDsKKwog
CS8qKgogCSAqIEBwYWdlc19hZGRyOgogCSAqCkBAIC0yNzcsOCArMjgyLDggQEAgc3RydWN0IGFt
ZGdwdV92bSB7CiAJc3RydWN0IGRybV9zY2hlZF9lbnRpdHkJaW1tZWRpYXRlOwogCXN0cnVjdCBk
cm1fc2NoZWRfZW50aXR5CWRlbGF5ZWQ7CiAKLQkvKiBMYXN0IHN1Ym1pc3Npb24gdG8gdGhlIHNj
aGVkdWxlciBlbnRpdGllcyAqLwotCXN0cnVjdCBkbWFfZmVuY2UJKmxhc3RfaW1tZWRpYXRlOwor
CS8qIExhc3QgdW5sb2NrZWQgc3VibWlzc2lvbiB0byB0aGUgc2NoZWR1bGVyIGVudGl0aWVzICov
CisJc3RydWN0IGRtYV9mZW5jZQkqbGFzdF91bmxvY2tlZDsKIAogCXVuc2lnbmVkIGludAkJcGFz
aWQ7CiAJLyogZGVkaWNhdGVkIHRvIHZtICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfdm1fc2RtYS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3ZtX3NkbWEuYwppbmRleCBjNzhiY2ViZDkzNzguLjhkOWM2ZmViYTY2MCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtX3NkbWEuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm1fc2RtYS5jCkBAIC05Miw4ICs5Miw4
IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3ZtX3NkbWFfY29tbWl0KHN0cnVjdCBhbWRncHVfdm1fdXBk
YXRlX3BhcmFtcyAqcCwKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2liICppYiA9IHAtPmpvYi0+aWJzOwog
CXN0cnVjdCBkcm1fc2NoZWRfZW50aXR5ICplbnRpdHk7Ci0Jc3RydWN0IGRtYV9mZW5jZSAqZiwg
KnRtcDsKIAlzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmc7CisJc3RydWN0IGRtYV9mZW5jZSAqZjsK
IAlpbnQgcjsKIAogCWVudGl0eSA9IHAtPmltbWVkaWF0ZSA/ICZwLT52bS0+aW1tZWRpYXRlIDog
JnAtPnZtLT5kZWxheWVkOwpAQCAtMTA2LDEzICsxMDYsMTMgQEAgc3RhdGljIGludCBhbWRncHVf
dm1fc2RtYV9jb21taXQoc3RydWN0IGFtZGdwdV92bV91cGRhdGVfcGFyYW1zICpwLAogCWlmIChy
KQogCQlnb3RvIGVycm9yOwogCi0JaWYgKHAtPmltbWVkaWF0ZSkgewotCQl0bXAgPSBkbWFfZmVu
Y2VfZ2V0KGYpOwotCQlzd2FwKHAtPnZtLT5sYXN0X2ltbWVkaWF0ZSwgZik7CisJaWYgKHAtPnVu
bG9ja2VkKSB7CisJCXN0cnVjdCBkbWFfZmVuY2UgKnRtcCA9IGRtYV9mZW5jZV9nZXQoZik7CisK
KwkJc3dhcChwLT52bS0+bGFzdF91bmxvY2tlZCwgZik7CiAJCWRtYV9mZW5jZV9wdXQodG1wKTsK
IAl9IGVsc2UgewotCQlkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKHAtPnZtLT5yb290LmJhc2Uu
Ym8tPnRiby5iYXNlLnJlc3YsCi0JCQkJCSAgZik7CisJCWFtZGdwdV9ib19mZW5jZShwLT52bS0+
cm9vdC5iYXNlLmJvLCBmLCB0cnVlKTsKIAl9CiAKIAlpZiAoZmVuY2UgJiYgIXAtPmltbWVkaWF0
ZSkKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KYW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4Cg==
