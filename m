Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8FCB749088
	for <lists+amd-gfx@lfdr.de>; Mon, 17 Jun 2019 21:51:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E4E4E6E08C;
	Mon, 17 Jun 2019 19:51:05 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qk1-x735.google.com (mail-qk1-x735.google.com
 [IPv6:2607:f8b0:4864:20::735])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 90DAB6E083
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:50:52 +0000 (UTC)
Received: by mail-qk1-x735.google.com with SMTP id r6so7029579qkc.0
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 12:50:52 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Uf4H+AUDDYI7s8RKGGimuWs4tSrBdlMwN05DHACR6Fk=;
 b=GmYHpvetE1sb6FqhlW28X56aFXHeNzK7rYpDo2dVsCSCNcqNsH4xKjzi6qkJh0pVvr
 qy439JgxU9WHAOifgPt3Cu3dCb7WWSP37quOedHLQQwoejT2FchO9fJ3ciZU79KuY8ey
 1J4IioTnxcyPhHjaQe3lOiLfvl65EgfERYen7iahnn2dx1EKOCH5UYgE6WNDJcX44Cpp
 IVIRgmv9ybhPStTLE7kA9eGyRfA2CtalBvxgVOEZWrdjNYS9Mk7m/sVbFGo7g3YRYXGy
 PRlrSIDr/I8K7tgy4WQUdpp1rNFc8201yJc1GjSZjzbfkH6+Y/Gfip5SUxrpEiB6iKM6
 tu/w==
X-Gm-Message-State: APjAAAXFsQx4Hwy1nZeTcPc+6qGAy9NjKm6tisBIqpoXf/KMtfhN4RyL
 eyFnJFUlfvbB39clKdIJZLTE0f3Kl6WrDQ==
X-Google-Smtp-Source: APXvYqzL1+PESlJsQ8Gbp+RUg8u5NOnmz/mL0SHA7saXziu7xO/lZ+RGxSgt/dDOHaKOucpk3TT2oA==
X-Received: by 2002:a37:a142:: with SMTP id k63mr22710745qke.278.1560801051040; 
 Mon, 17 Jun 2019 12:50:51 -0700 (PDT)
Received: from localhost.localdomain ([71.219.5.136])
 by smtp.gmail.com with ESMTPSA id a51sm7520252qta.85.2019.06.17.12.50.49
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 12:50:50 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 454/459] drm/amd/display: move vmid determination logic to a
 module
Date: Mon, 17 Jun 2019 14:49:43 -0500
Message-Id: <20190617194948.18667-55-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617194948.18667-1-alexander.deucher@amd.com>
References: <20190617194948.18667-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Uf4H+AUDDYI7s8RKGGimuWs4tSrBdlMwN05DHACR6Fk=;
 b=XGiI6XX+70E0eC29WP5G62xV+fLA0V/z/1wbbW55RVSmbfuA7hc4KJafOcGaaVFm7V
 nsX5TPuKwj0q0HdnAf8Sao31dy4wWVy3knYxycDtWi0OKQk7i4cj3+K0jkYJymTNgGnL
 gssRciLjhwPRSX6vLJMdMqwbh9Cc2ac+8gT5BiIreYV6URcKkU6dc+DkxG5wuOcZIpvN
 g/enw7lNjOcVSCjTggktwhByoguzDGC3gf0IgyqfIVrZTPU69P74YQazHtpbW3WMEP5F
 1+hR5RgZwb3OyjdbkALOquGqePxNLvbOvziBr3joO+0ON6b8MoehnZVuzpfpoixMlgrA
 H3Fg==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>,
 Charlene Liu <Charlene.Liu@amd.com>,
 Dmytro Laktyushkin <Dmytro.Laktyushkin@amd.com>,
 Bhawanpreet Lakha <Bhawanpreet.Lakha@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogRG15dHJvIExha3R5dXNoa2luIDxEbXl0cm8uTGFrdHl1c2hraW5AYW1kLmNvbT4KCkN1
cnJlbnRseSB2bWlkIGlzIGRlY2lkZWQgaW50ZXJuYWxseSBpbnNpZGUgZGMuIFdpdGggdGhlIGlu
dHJvZHVjdGlvbgpvZiBuZXcgYXNpY3Mgd2UgYXJlIHJlcXVpcmVkIHRvIGNvb3JkaW5hdGUgdm1p
ZCB1c2Ugd2l0aCBleHRlcm5hbApjb21wb25lbnRzLgoKVGhpcyBjaGFuZ2UgY29udmVydHMgdm1p
ZCBsb2dpYyB0byBhIERBTCBtb2R1bGUgYWxsb3dpbmcgdm1pZCB0byBiZQpwYXNzZWQgaW4gYXMg
YSBwYXJhbWV0ZXIgdG8gREMuCgpTaWduZWQtb2ZmLWJ5OiBEbXl0cm8gTGFrdHl1c2hraW4gPERt
eXRyby5MYWt0eXVzaGtpbkBhbWQuY29tPgpSZXZpZXdlZC1ieTogQ2hhcmxlbmUgTGl1IDxDaGFy
bGVuZS5MaXVAYW1kLmNvbT4KQWNrZWQtYnk6IEJoYXdhbnByZWV0IExha2hhIDxCaGF3YW5wcmVl
dC5MYWtoYUBhbWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBBbGV4IERldWNoZXIgPGFsZXhhbmRlci5k
ZXVjaGVyQGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL01ha2Vm
aWxlICAgICAgIHwgICA3ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9k
Yy5jICAgICAgfCAgMjAgLS0tCiAuLi4vZHJtL2FtZC9kaXNwbGF5L2RjL2NvcmUvZGNfdm1faGVs
cGVyLmMgICAgfCAgOTMgKysrLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9k
Yy9kYy5oICAgICAgICAgICB8ICAxNyArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2Rj
L2RjX2h3X3R5cGVzLmggIHwgICAyICsKIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEw
L2RjbjEwX2h1YnAuYyB8ICAgMyArLQogLi4uL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAv
ZGNuMTBfaHVicC5oIHwgICAzICstCiAuLi4vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfaHdf
c2VxdWVuY2VyLmMgfCAgIDMgKy0KIC4uLi9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBf
aHViYnViLmMgICB8ICA3MiArKysrLS0tLQogLi4uL2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9k
Y24yMF9odWJidWIuaCAgIHwgIDEyICstCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24y
MC9kY24yMF9odWJwLmMgfCAgIDUgKy0KIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIw
L2RjbjIwX2h1YnAuaCB8ICAgMyArLQogLi4uL2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24y
MF9od3NlcS5jICAgIHwgIDgzICsrKystLS0tLQogLi4uL2RybS9hbWQvZGlzcGxheS9kYy9kY24y
MC9kY24yMF9yZXNvdXJjZS5jIHwgICAyICstCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
Y24yMC9kY24yMF92bWlkLmMgfCAgIDcgKy0KIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2Rj
bjIwL2RjbjIwX3ZtaWQuaCB8ICAgMSAtCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMv
aHcvZGNodWJidWIuaCAgfCAgMTYgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9p
bmMvaHcvaHVicC5oICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2lu
Yy9ody92bWlkLmggIHwgICAxICsKIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9od19z
ZXF1ZW5jZXIuaCB8ICAxNyArLQogLi4uL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL3ZtX2hl
bHBlci5oICAgIHwgIDE2ICstCiAuLi4vZHJtL2FtZC9kaXNwbGF5L21vZHVsZXMvaW5jL21vZF92
bWlkLmggICAgfCAgNDQgKysrKysKIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L21vZHVsZXMvdm1p
ZC92bWlkLmMgICB8IDE1OCArKysrKysrKysrKysrKysrKysKIDIzIGZpbGVzIGNoYW5nZWQsIDM1
NyBpbnNlcnRpb25zKCspLCAyMzEgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L21vZHVsZXMvaW5jL21vZF92bWlkLmgKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvbW9kdWxlcy92bWlkL3ZtaWQu
YwoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9NYWtlZmlsZSBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9NYWtlZmlsZQppbmRleCAwMGVhYTY5YmE1
M2QuLjU1Y2U1YjY1NzM5MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9NYWtlZmls
ZQpAQCAtNTAsOCArNTAsMTEgQEAgQU1EX0RDID0gJChhZGRzdWZmaXggL01ha2VmaWxlLCAkKGFk
ZHByZWZpeCAkKEZVTExfQU1EX0RJU1BMQVlfUEFUSCkvZGMvLCQoRENfTEkKIGluY2x1ZGUgJChB
TURfREMpCiAKIERJU1BMQVlfQ09SRSA9IGRjLm8gZGNfbGluay5vIGRjX3Jlc291cmNlLm8gZGNf
aHdfc2VxdWVuY2VyLm8gZGNfc2luay5vIFwKLWRjX3N1cmZhY2UubyBkY19saW5rX2h3c3MubyBk
Y19saW5rX2RwLm8gZGNfbGlua19kZGMubyBkY19kZWJ1Zy5vIGRjX3N0cmVhbS5vIFwKLWRjX3Zt
X2hlbHBlci5vCitkY19zdXJmYWNlLm8gZGNfbGlua19od3NzLm8gZGNfbGlua19kcC5vIGRjX2xp
bmtfZGRjLm8gZGNfZGVidWcubyBkY19zdHJlYW0ubworCitpZmRlZiBDT05GSUdfRFJNX0FNRF9E
Q19EQ04yXzAKK0RJU1BMQVlfQ09SRSArPSBkY192bV9oZWxwZXIubworZW5kaWYKIAogQU1EX0RJ
U1BMQVlfQ09SRSA9ICQoYWRkcHJlZml4ICQoQU1EREFMUEFUSCkvZGMvY29yZS8sJChESVNQTEFZ
X0NPUkUpKQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29y
ZS9kYy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2NvcmUvZGMuYwppbmRleCA4
YmM4YWMzYTc3MTguLmEyOWJiOWJmM2Y5YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9kaXNwbGF5L2RjL2NvcmUvZGMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvY29yZS9kYy5jCkBAIC04MDgsMjYgKzgwOCw2IEBAIHZvaWQgZGNfZGVzdHJveShzdHJ1Y3Qg
ZGMgKipkYykKIAkqZGMgPSBOVUxMOwogfQogCi0jaWZkZWYgQ09ORklHX0RSTV9BTURfRENfRENO
Ml8wCi1ib29sIGRjX2luaXRfbWVtb3J5X2h1YihzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgZGNfYWRk
cl9zcGFjZV9jb25maWcgKmNvbmZpZykKLXsKLQkvLyBNZW1vcnkgaHViIGluaXQgaXNuJ3QgZG9u
ZSBhcyBwYXJ0IG9mIGRjX2NyZWF0ZSBiZWNhdXNlIGluIHdpbmRvd3MsIGRhbC9kYyBpcwotCS8v
IGNvbnN0cnVjdGVkIGJlZm9yZSB0aGUgdm0gY29uZmlnIGlzIHNldHVwIGluIGttZCBzbyB0aGVy
ZSdzIG5vIHdheQotCS8vIHRoZXkgY2FuIGdpdmUgaXQgdG8gdXMgYXQgYm9vdC9kY19jcmVhdGUK
LQlib29sIHZtU3VwcG9ydGVkOwotCi0JLy8gQ2FsbCBIV1NTIHRvIHNldHVwIEhVQkJVQiBmb3Ig
YWRkcmVzcyBjb25maWcKLQlkYy0+aHdzcy5pbml0X2RjaHViKGRjLT5od3NlcSwgZGMsIGNvbmZp
Zyk7Ci0KLQkvLyBQcmUtaW5pdCBzeXN0ZW0gYXBlcnR1cmUgc3RhcnQvZW5kIGZvciBhbGwgSFVC
UCBpbnN0YW5jZXMgKGlmIG5vdCBnYXRpbmc/KQotCS8vIG9yIGNhY2hlIHN5c3RlbSBhcGVydHVy
ZSBpZiB1c2luZyBwb3dlciBnYXRpbmcKLQltZW1jcHkoJmRjLT52bV9jb25maWcsIGNvbmZpZywg
c2l6ZW9mKHN0cnVjdCBkY19hZGRyX3NwYWNlX2NvbmZpZykpOwotCi0Jdm1TdXBwb3J0ZWQgPSAo
ZGMtPmN0eC0+YXNpY19pZC5jaGlwX2ZhbWlseSA9PSBGQU1JTFlfTlYpID8gdHJ1ZSA6IGZhbHNl
OwotCXJldHVybiB2bVN1cHBvcnRlZDsKLX0KLQotI2VuZGlmCiBzdGF0aWMgdm9pZCBlbmFibGVf
dGltaW5nX211bHRpc3luYygKIAkJc3RydWN0IGRjICpkYywKIAkJc3RydWN0IGRjX3N0YXRlICpj
dHgpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kY192
bV9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9jb3JlL2RjX3ZtX2hl
bHBlci5jCmluZGV4IDZjZTg3YjY4MmEzMi4uYTk2ZDhkZTkzODBlIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kY192bV9oZWxwZXIuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kY192bV9oZWxwZXIuYwpAQCAtMjQsOCAr
MjQsOSBAQAogICovCiAKICNpbmNsdWRlICJ2bV9oZWxwZXIuaCIKKyNpbmNsdWRlICJkYy5oIgog
Ci1zdGF0aWMgdm9pZCBtYXJrX3ZtaWRfdXNlZChzdHJ1Y3Qgdm1faGVscGVyICp2bV9oZWxwZXIs
IHVuc2lnbmVkIGludCBwb3MsIHVpbnQ4X3QgaHVicF9pZHgpCit2b2lkIHZtX2hlbHBlcl9tYXJr
X3ZtaWRfdXNlZChzdHJ1Y3Qgdm1faGVscGVyICp2bV9oZWxwZXIsIHVuc2lnbmVkIGludCBwb3Ms
IHVpbnQ4X3QgaHVicF9pZHgpCiB7CiAJc3RydWN0IHZtaWRfdXNhZ2Ugdm1pZHMgPSB2bV9oZWxw
ZXItPmh1YnBfdm1pZF91c2FnZVtodWJwX2lkeF07CiAKQEAgLTMzLDkxICszNCw0MyBAQCBzdGF0
aWMgdm9pZCBtYXJrX3ZtaWRfdXNlZChzdHJ1Y3Qgdm1faGVscGVyICp2bV9oZWxwZXIsIHVuc2ln
bmVkIGludCBwb3MsIHVpbnQ4XwogCXZtaWRzLnZtaWRfdXNhZ2VbMV0gPSAxIDw8IHBvczsKIH0K
IAotc3RhdGljIHZvaWQgYWRkX3B0Yl90b190YWJsZShzdHJ1Y3Qgdm1faGVscGVyICp2bV9oZWxw
ZXIsIHVuc2lnbmVkIGludCB2bWlkLCB1aW50NjRfdCBwdGIpCitpbnQgZGNfc2V0dXBfc3lzdGVt
X2NvbnRleHQoc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3BoeV9hZGRyX3NwYWNlX2NvbmZpZyAq
cGFfY29uZmlnKQogewotCXZtX2hlbHBlci0+cHRiX2Fzc2lnbmVkX3RvX3ZtaWRbdm1pZF0gPSBw
dGI7Ci0Jdm1faGVscGVyLT5udW1fdm1pZHNfYXZhaWxhYmxlLS07Ci19Ci0KLXN0YXRpYyB2b2lk
IGNsZWFyX2VudHJ5X2Zyb21fdm1pZF90YWJsZShzdHJ1Y3Qgdm1faGVscGVyICp2bV9oZWxwZXIs
IHVuc2lnbmVkIGludCB2bWlkKQotewotCXZtX2hlbHBlci0+cHRiX2Fzc2lnbmVkX3RvX3ZtaWRb
dm1pZF0gPSAwOwotCXZtX2hlbHBlci0+bnVtX3ZtaWRzX2F2YWlsYWJsZSsrOwotfQotCi1zdGF0
aWMgdm9pZCBldmljdF92bWlkcyhzdHJ1Y3Qgdm1faGVscGVyICp2bV9oZWxwZXIpCi17Ci0JaW50
IGk7Ci0JdWludDE2X3Qgb3JkID0gMDsKKwlpbnQgbnVtX3ZtaWRzID0gMDsKIAotCWZvciAoaSA9
IDA7IGkgPCB2bV9oZWxwZXItPm51bV92bWlkOyBpKyspCi0JCW9yZCB8PSB2bV9oZWxwZXItPmh1
YnBfdm1pZF91c2FnZVtpXS52bWlkX3VzYWdlWzBdIHwgdm1faGVscGVyLT5odWJwX3ZtaWRfdXNh
Z2VbaV0udm1pZF91c2FnZVsxXTsKKwkvKiBDYWxsIEhXU1MgdG8gc2V0dXAgSFVCQlVCIGZvciBh
ZGRyZXNzIGNvbmZpZyAqLworCWlmIChkYy0+aHdzcy5pbml0X3N5c19jdHgpIHsKKwkJbnVtX3Zt
aWRzID0gZGMtPmh3c3MuaW5pdF9zeXNfY3R4KGRjLT5od3NlcSwgZGMsIHBhX2NvbmZpZyk7CiAK
LQkvLyBBdCB0aGlzIHBvaW50IGFueSBwb3NpdGlvbnMgd2l0aCB2YWx1ZSAwIGFyZSB1bnVzZWQg
dm1pZHMsIGV2aWN0IHRoZW0KLQlmb3IgKGkgPSAxOyBpIDwgdm1faGVscGVyLT5udW1fdm1pZDsg
aSsrKSB7Ci0JCWlmIChvcmQgJiAoMXUgPDwgaSkpCi0JCQljbGVhcl9lbnRyeV9mcm9tX3ZtaWRf
dGFibGUodm1faGVscGVyLCBpKTsKKwkJLyogUHJlLWluaXQgc3lzdGVtIGFwZXJ0dXJlIHN0YXJ0
L2VuZCBmb3IgYWxsIEhVQlAgaW5zdGFuY2VzIChpZiBub3QgZ2F0aW5nPykKKwkJICogb3IgY2Fj
aGUgc3lzdGVtIGFwZXJ0dXJlIGlmIHVzaW5nIHBvd2VyIGdhdGluZworCQkgKi8KKwkJbWVtY3B5
KCZkYy0+dm1fcGFfY29uZmlnLCBwYV9jb25maWcsIHNpemVvZihzdHJ1Y3QgZGNfcGh5X2FkZHJf
c3BhY2VfY29uZmlnKSk7CisJCWRjLT52bV9wYV9jb25maWcudmFsaWQgPSB0cnVlOwogCX0KLX0K
LQotLy8gUmV0dXJuIHZhbHVlIG9mIC0xIGluZGljYXRlcyB2bWlkIHRhYmxlIHVuaXRpYWxpemVk
IG9yIHB0YiBkbmUgaW4gdGhlIHRhYmxlCi1zdGF0aWMgaW50IGdldF9leGlzdGluZ192bWlkX2Zv
cl9wdGIoc3RydWN0IHZtX2hlbHBlciAqdm1faGVscGVyLCB1aW50NjRfdCBwdGIpCi17Ci0JaW50
IGk7CiAKLQlmb3IgKGkgPSAwOyBpIDwgdm1faGVscGVyLT5udW1fdm1pZDsgaSsrKSB7Ci0JCWlm
ICh2bV9oZWxwZXItPnB0Yl9hc3NpZ25lZF90b192bWlkW2ldID09IHB0YikKLQkJCXJldHVybiBp
OwotCX0KLQotCXJldHVybiAtMTsKKwlyZXR1cm4gbnVtX3ZtaWRzOwogfQogCi0vLyBFeHBlY3Rl
ZCB0byBiZSBjYWxsZWQgb25seSB3aGVuIHRoZXJlJ3MgYW4gYXZhaWxhYmxlIHZtaWQKLXN0YXRp
YyBpbnQgZ2V0X25leHRfYXZhaWxhYmxlX3ZtaWQoc3RydWN0IHZtX2hlbHBlciAqdm1faGVscGVy
KQordm9pZCBkY19zZXR1cF92bV9jb250ZXh0KHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBkY192aXJ0
dWFsX2FkZHJfc3BhY2VfY29uZmlnICp2YV9jb25maWcsIGludCB2bWlkKQogewotCWludCBpOwot
Ci0JZm9yIChpID0gMTsgaSA8IHZtX2hlbHBlci0+bnVtX3ZtaWQ7IGkrKykgewotCQlpZiAodm1f
aGVscGVyLT5wdGJfYXNzaWduZWRfdG9fdm1pZFtpXSA9PSAwKQotCQkJcmV0dXJuIGk7Ci0JfQot
Ci0JcmV0dXJuIC0xOworCWRjLT5od3NzLmluaXRfdm1fY3R4KGRjLT5od3NlcSwgZGMsIHZhX2Nv
bmZpZywgdm1pZCk7CiB9CiAKLXVpbnQ4X3QgZ2V0X3ZtaWRfZm9yX3B0YihzdHJ1Y3Qgdm1faGVs
cGVyICp2bV9oZWxwZXIsIGludDY0X3QgcHRiLCB1aW50OF90IGh1YnBfaWR4KQoraW50IGRjX2dl
dF92bWlkX3VzZV92ZWN0b3Ioc3RydWN0IGRjICpkYykKIHsKLQl1bnNpZ25lZCBpbnQgdm1pZCA9
IDA7Ci0JaW50IHZtaWRfZXhpc3RzID0gLTE7Ci0KLQkvLyBQaHlzaWNhbCBhZGRyZXNzIGdldHMg
dm1pZCAwCi0JaWYgKHB0YiA9PSAwKQotCQlyZXR1cm4gMDsKLQotCXZtaWRfZXhpc3RzID0gZ2V0
X2V4aXN0aW5nX3ZtaWRfZm9yX3B0Yih2bV9oZWxwZXIsIHB0Yik7Ci0KLQlpZiAodm1pZF9leGlz
dHMgIT0gLTEpIHsKLQkJbWFya192bWlkX3VzZWQodm1faGVscGVyLCB2bWlkX2V4aXN0cywgaHVi
cF9pZHgpOwotCQl2bWlkID0gdm1pZF9leGlzdHM7Ci0JfSBlbHNlIHsKLQkJaWYgKHZtX2hlbHBl
ci0+bnVtX3ZtaWRzX2F2YWlsYWJsZSA9PSAwKQotCQkJZXZpY3Rfdm1pZHModm1faGVscGVyKTsK
LQotCQl2bWlkID0gZ2V0X25leHRfYXZhaWxhYmxlX3ZtaWQodm1faGVscGVyKTsKLQkJbWFya192
bWlkX3VzZWQodm1faGVscGVyLCB2bWlkLCBodWJwX2lkeCk7Ci0JCWFkZF9wdGJfdG9fdGFibGUo
dm1faGVscGVyLCB2bWlkLCBwdGIpOwotCX0KKwlpbnQgaTsKKwlpbnQgaW5fdXNlID0gMDsKIAot
CXJldHVybiB2bWlkOworCWZvciAoaSA9IDA7IGkgPCBkYy0+dm1faGVscGVyLT5udW1fdm1pZDsg
aSsrKQorCQlpbl91c2UgfD0gZGMtPnZtX2hlbHBlci0+aHVicF92bWlkX3VzYWdlW2ldLnZtaWRf
dXNhZ2VbMF0KKwkJCXwgZGMtPnZtX2hlbHBlci0+aHVicF92bWlkX3VzYWdlW2ldLnZtaWRfdXNh
Z2VbMV07CisJcmV0dXJuIGluX3VzZTsKIH0KIAotdm9pZCBpbml0X3ZtX2hlbHBlcihzdHJ1Y3Qg
dm1faGVscGVyICp2bV9oZWxwZXIsIHVuc2lnbmVkIGludCBudW1fdm1pZCwgdW5zaWduZWQgaW50
IG51bV9odWJwKQordm9pZCB2bV9oZWxwZXJfaW5pdChzdHJ1Y3Qgdm1faGVscGVyICp2bV9oZWxw
ZXIsIHVuc2lnbmVkIGludCBudW1fdm1pZCkKIHsKIAl2bV9oZWxwZXItPm51bV92bWlkID0gbnVt
X3ZtaWQ7Ci0Jdm1faGVscGVyLT5udW1faHVicCA9IG51bV9odWJwOwotCXZtX2hlbHBlci0+bnVt
X3ZtaWRzX2F2YWlsYWJsZSA9IG51bV92bWlkIC0gMTsKIAogCW1lbXNldCh2bV9oZWxwZXItPmh1
YnBfdm1pZF91c2FnZSwgMCwgc2l6ZW9mKHZtX2hlbHBlci0+aHVicF92bWlkX3VzYWdlWzBdKSAq
IE1BWF9IVUJQKTsKLQltZW1zZXQodm1faGVscGVyLT5wdGJfYXNzaWduZWRfdG9fdm1pZCwgMCwg
c2l6ZW9mKHZtX2hlbHBlci0+cHRiX2Fzc2lnbmVkX3RvX3ZtaWRbMF0pICogTUFYX1ZNSUQpOwog
fQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjLmggYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGMuaAppbmRleCAwN2EyNjRmZGNlNGUuLjVlYmZl
ZWU5ZDA4ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjLmgK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjLmgKQEAgLTQwMywyMSArNDAz
LDE3IEBAIHN0cnVjdCBkY19waHlfYWRkcl9zcGFjZV9jb25maWcgewogCQl1aW50NjRfdCBwYWdl
X3RhYmxlX2VuZF9hZGRyOwogCQl1aW50NjRfdCBwYWdlX3RhYmxlX2Jhc2VfYWRkcjsKIAl9IGdh
cnRfY29uZmlnOworCisJYm9vbCB2YWxpZDsKIH07CiAKIHN0cnVjdCBkY192aXJ0dWFsX2FkZHJf
c3BhY2VfY29uZmlnIHsKKwl1aW50NjRfdAlwYWdlX3RhYmxlX2Jhc2VfYWRkcjsKIAl1aW50NjRf
dAlwYWdlX3RhYmxlX3N0YXJ0X2FkZHI7CiAJdWludDY0X3QJcGFnZV90YWJsZV9lbmRfYWRkcjsK
IAl1aW50MzJfdAlwYWdlX3RhYmxlX2Jsb2NrX3NpemVfaW5fYnl0ZXM7CiAJdWludDhfdAkJcGFn
ZV90YWJsZV9kZXB0aDsgLy8gMSA9IDEgbGV2ZWwsIDIgPSAyIGxldmVsLCBldGMuICAwID0gaW52
YWxpZAogfTsKLQotc3RydWN0IGRjX2FkZHJfc3BhY2VfY29uZmlnIHsKLQlzdHJ1Y3QgZGNfcGh5
X2FkZHJfc3BhY2VfY29uZmlnCQlwYV9jb25maWc7Ci0Jc3RydWN0IGRjX3ZpcnR1YWxfYWRkcl9z
cGFjZV9jb25maWcJdmFfY29uZmlnOwotCXVpbnQzMl90CXZhbGlkOjE7Ci19OwotCiAjZW5kaWYK
IAogc3RydWN0IGRjX2JvdW5kaW5nX2JveF9vdmVycmlkZXMgewpAQCAtNDQ5LDcgKzQ0NSw3IEBA
IHN0cnVjdCBkYyB7CiAjZW5kaWYKIAlzdHJ1Y3QgZGNfY29udGV4dCAqY3R4OwogI2lmZGVmIENP
TkZJR19EUk1fQU1EX0RDX0RDTjJfMAotCXN0cnVjdCBkY19hZGRyX3NwYWNlX2NvbmZpZyB2bV9j
b25maWc7CisJc3RydWN0IGRjX3BoeV9hZGRyX3NwYWNlX2NvbmZpZyB2bV9wYV9jb25maWc7CiAj
ZW5kaWYKIAogCXVpbnQ4X3QgbGlua19jb3VudDsKQEAgLTUzOSw4ICs1MzUsMTEgQEAgc3RydWN0
IGRjX2NhbGxiYWNrX2luaXQgewogfTsKIAogc3RydWN0IGRjICpkY19jcmVhdGUoY29uc3Qgc3Ry
dWN0IGRjX2luaXRfZGF0YSAqaW5pdF9wYXJhbXMpOworaW50IGRjX2dldF92bWlkX3VzZV92ZWN0
b3Ioc3RydWN0IGRjICpkYyk7CiAjaWZkZWYgQ09ORklHX0RSTV9BTURfRENfRENOMl8wCi1ib29s
IGRjX2luaXRfbWVtb3J5X2h1YihzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgZGNfYWRkcl9zcGFjZV9j
b25maWcgKmNvbmZpZyk7Cit2b2lkIGRjX3NldHVwX3ZtX2NvbnRleHQoc3RydWN0IGRjICpkYywg
c3RydWN0IGRjX3ZpcnR1YWxfYWRkcl9zcGFjZV9jb25maWcgKnZhX2NvbmZpZywgaW50IHZtaWQp
OworLyogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHZtaWRzIHN1cHBvcnRlZCAqLworaW50IGRjX3Nl
dHVwX3N5c3RlbV9jb250ZXh0KHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBkY19waHlfYWRkcl9zcGFj
ZV9jb25maWcgKnBhX2NvbmZpZyk7CiAjZW5kaWYKIHZvaWQgZGNfaW5pdF9jYWxsYmFja3Moc3Ry
dWN0IGRjICpkYywKIAkJY29uc3Qgc3RydWN0IGRjX2NhbGxiYWNrX2luaXQgKmluaXRfcGFyYW1z
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY19od190eXBl
cy5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjX2h3X3R5cGVzLmgKaW5kZXgg
NmIxNDMxZDYzZGFiLi4yMmRiNTY4MmFhNmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9kY19od190eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9kYy9kY19od190eXBlcy5oCkBAIC05OSw2ICs5OSw4IEBAIHN0cnVjdCBkY19wbGFuZV9h
ZGRyZXNzIHsKIAl9OwogCiAJdW5pb24gbGFyZ2VfaW50ZWdlciBwYWdlX3RhYmxlX2Jhc2U7CisK
Kwl1aW50OF90IHZtaWQ7CiB9OwogCiBzdHJ1Y3QgZGNfc2l6ZSB7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfaHVicC5jIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX2h1YnAuYwppbmRleCBhNDhkMzE0MDEx
YTkuLjkzNGJhY2MwYzZhZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2RjbjEwL2RjbjEwX2h1YnAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvZGNuMTAvZGNuMTBfaHVicC5jCkBAIC0zMzksOCArMzM5LDcgQEAgdm9pZCBodWJwMV9wcm9n
cmFtX3BpeGVsX2Zvcm1hdCgKIGJvb2wgaHVicDFfcHJvZ3JhbV9zdXJmYWNlX2ZsaXBfYW5kX2Fk
ZHIoCiAJc3RydWN0IGh1YnAgKmh1YnAsCiAJY29uc3Qgc3RydWN0IGRjX3BsYW5lX2FkZHJlc3Mg
KmFkZHJlc3MsCi0JYm9vbCBmbGlwX2ltbWVkaWF0ZSwKLQl1aW50OF90IHZtaWQpCisJYm9vbCBm
bGlwX2ltbWVkaWF0ZSkKIHsKIAlzdHJ1Y3QgZGNuMTBfaHVicCAqaHVicDEgPSBUT19EQ04xMF9I
VUJQKGh1YnApOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMv
ZGNuMTAvZGNuMTBfaHVicC5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEw
L2RjbjEwX2h1YnAuaAppbmRleCA5MWRjNDJlNTgwZWMuLjMxYzhmZGQzMjA2YyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX2h1YnAuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfaHVicC5oCkBAIC03
MjAsOCArNzIwLDcgQEAgdm9pZCBodWJwMV9kY2NfY29udHJvbChzdHJ1Y3QgaHVicCAqaHVicCwK
IGJvb2wgaHVicDFfcHJvZ3JhbV9zdXJmYWNlX2ZsaXBfYW5kX2FkZHIoCiAJc3RydWN0IGh1YnAg
Kmh1YnAsCiAJY29uc3Qgc3RydWN0IGRjX3BsYW5lX2FkZHJlc3MgKmFkZHJlc3MsCi0JYm9vbCBm
bGlwX2ltbWVkaWF0ZSwKLQl1aW50OF90IHZtaWQpOworCWJvb2wgZmxpcF9pbW1lZGlhdGUpOwog
CiAjZW5kaWYKIGJvb2wgaHVicDFfaXNfZmxpcF9wZW5kaW5nKHN0cnVjdCBodWJwICpodWJwKTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9o
d19zZXF1ZW5jZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24x
MF9od19zZXF1ZW5jZXIuYwppbmRleCAwYjE1MDNkZTBmN2EuLmU2YjdlMTBjNjEyZiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX2h3X3NlcXVl
bmNlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9o
d19zZXF1ZW5jZXIuYwpAQCAtMTI5Niw4ICsxMjk2LDcgQEAgc3RhdGljIHZvaWQgZGNuMTBfdXBk
YXRlX3BsYW5lX2FkZHIoY29uc3Qgc3RydWN0IGRjICpkYywgc3RydWN0IHBpcGVfY3R4ICpwaXBl
X2MKIAlwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnAtPmZ1bmNzLT5odWJwX3Byb2dyYW1fc3VyZmFj
ZV9mbGlwX2FuZF9hZGRyKAogCQkJcGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwLAogCQkJJnBsYW5l
X3N0YXRlLT5hZGRyZXNzLAotCQkJcGxhbmVfc3RhdGUtPmZsaXBfaW1tZWRpYXRlLAotCQkJMCk7
CisJCQlwbGFuZV9zdGF0ZS0+ZmxpcF9pbW1lZGlhdGUpOwogCiAJcGxhbmVfc3RhdGUtPnN0YXR1
cy5yZXF1ZXN0ZWRfYWRkcmVzcyA9IHBsYW5lX3N0YXRlLT5hZGRyZXNzOwogCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHViYnViLmMgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHViYnViLmMKaW5kZXgg
NzI0ZjFjNWVmNjE0Li5lY2U2ZTEzNjQzN2IgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9odWJidWIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHViYnViLmMKQEAgLTQ3LDYgKzQ3LDExIEBACiAj
ZGVmaW5lIEZOKHJlZ19uYW1lLCBmaWVsZF9uYW1lKSBcCiAJaHViYnViMS0+c2hpZnRzLT5maWVs
ZF9uYW1lLCBodWJidWIxLT5tYXNrcy0+ZmllbGRfbmFtZQogCisjaWZkZWYgTlVNX1ZNSUQKKyN1
bmRlZiBOVU1fVk1JRAorI2VuZGlmCisjZGVmaW5lIE5VTV9WTUlEIDE2CisKIGJvb2wgaHViYnVi
Ml9kY2Nfc3VwcG9ydF9zd2l6emxlKAogCQllbnVtIHN3aXp6bGVfbW9kZV92YWx1ZXMgc3dpenps
ZSwKIAkJdW5zaWduZWQgaW50IGJ5dGVzX3Blcl9lbGVtZW50LApAQCAtMjk0LDE1ICsyOTksNiBA
QCBib29sIGh1YmJ1YjJfZ2V0X2RjY19jb21wcmVzc2lvbl9jYXAoc3RydWN0IGh1YmJ1YiAqaHVi
YnViLAogCXJldHVybiB0cnVlOwogfQogCi12b2lkIGh1YmJ1YjJfc2V0dXBfdm1pZF9wdGIoc3Ry
dWN0IGh1YmJ1YiAqaHViYnViLAotCQl1aW50NjRfdCBwdGIsCi0JCXVpbnQ4X3Qgdm1pZCkKLXsK
LQlzdHJ1Y3QgZGNuMjBfaHViYnViICpodWJidWIxID0gVE9fRENOMjBfSFVCQlVCKGh1YmJ1Yik7
Ci0KLQlkY24yMF92bWlkX3NldF9wdGIoJmh1YmJ1YjEtPnZtaWRbdm1pZF0sIHB0Yik7Ci19Ci0K
IHN0YXRpYyBlbnVtIGRjbl9odWJidWJfcGFnZV90YWJsZV9kZXB0aCBwYWdlX3RhYmxlX2RlcHRo
X3RvX2h3KHVuc2lnbmVkIGludCBwYWdlX3RhYmxlX2RlcHRoKQogewogCWVudW0gZGNuX2h1YmJ1
Yl9wYWdlX3RhYmxlX2RlcHRoIGRlcHRoID0gMDsKQEAgLTM0Nyw0OSArMzQzLDUzIEBAIHN0YXRp
YyBlbnVtIGRjbl9odWJidWJfcGFnZV90YWJsZV9ibG9ja19zaXplIHBhZ2VfdGFibGVfYmxvY2tf
c2l6ZV90b19odyh1bnNpZ25lCiAJcmV0dXJuIGJsb2NrX3NpemU7CiB9CiAKLXZvaWQgaHViYnVi
Ml9pbml0X2RjaHViKHN0cnVjdCBodWJidWIgKmh1YmJ1YiwKLQkJc3RydWN0IGh1YmJ1Yl9hZGRy
X2NvbmZpZyAqY29uZmlnKQordm9pZCBodWJidWIyX2luaXRfdm1fY3R4KHN0cnVjdCBodWJidWIg
Kmh1YmJ1YiwKKwkJc3RydWN0IGRjbl9odWJidWJfdmlydF9hZGRyX2NvbmZpZyAqdmFfY29uZmln
LAorCQlpbnQgdm1pZCkKIHsKLQlpbnQgaTsKIAlzdHJ1Y3QgZGNuMjBfaHViYnViICpodWJidWIx
ID0gVE9fRENOMjBfSFVCQlVCKGh1YmJ1Yik7Ci0Jc3RydWN0IGRjbl92bWlkX3BhZ2VfdGFibGVf
Y29uZmlnIHBoeXNfY29uZmlnOwogCXN0cnVjdCBkY25fdm1pZF9wYWdlX3RhYmxlX2NvbmZpZyB2
aXJ0X2NvbmZpZzsKIAorCXZpcnRfY29uZmlnLnBhZ2VfdGFibGVfc3RhcnRfYWRkciA9IHZhX2Nv
bmZpZy0+cGFnZV90YWJsZV9zdGFydF9hZGRyID4+IDEyOworCXZpcnRfY29uZmlnLnBhZ2VfdGFi
bGVfZW5kX2FkZHIgPSB2YV9jb25maWctPnBhZ2VfdGFibGVfZW5kX2FkZHIgPj4gMTI7CisJdmly
dF9jb25maWcuZGVwdGggPSBwYWdlX3RhYmxlX2RlcHRoX3RvX2h3KHZhX2NvbmZpZy0+cGFnZV90
YWJsZV9kZXB0aCk7CisJdmlydF9jb25maWcuYmxvY2tfc2l6ZSA9IHBhZ2VfdGFibGVfYmxvY2tf
c2l6ZV90b19odyh2YV9jb25maWctPnBhZ2VfdGFibGVfYmxvY2tfc2l6ZSk7CisJdmlydF9jb25m
aWcucGFnZV90YWJsZV9iYXNlX2FkZHIgPSB2YV9jb25maWctPnBhZ2VfdGFibGVfYmFzZV9hZGRy
OworCisJZGNuMjBfdm1pZF9zZXR1cCgmaHViYnViMS0+dm1pZFt2bWlkXSwgJnZpcnRfY29uZmln
KTsKK30KKworaW50IGh1YmJ1YjJfaW5pdF9kY2h1Yl9zeXNfY3R4KHN0cnVjdCBodWJidWIgKmh1
YmJ1YiwKKwkJc3RydWN0IGRjbl9odWJidWJfcGh5c19hZGRyX2NvbmZpZyAqcGFfY29uZmlnKQor
eworCXN0cnVjdCBkY24yMF9odWJidWIgKmh1YmJ1YjEgPSBUT19EQ04yMF9IVUJCVUIoaHViYnVi
KTsKKwlzdHJ1Y3QgZGNuX3ZtaWRfcGFnZV90YWJsZV9jb25maWcgcGh5c19jb25maWc7CisKIAlS
RUdfU0VUKERDTl9WTV9GQl9MT0NBVElPTl9CQVNFLCAwLAotCQkJRkJfQkFTRSwgY29uZmlnLT5w
YV9jb25maWcuc3lzdGVtX2FwZXJ0dXJlLmZiX2Jhc2UpOworCQkJRkJfQkFTRSwgcGFfY29uZmln
LT5zeXN0ZW1fYXBlcnR1cmUuZmJfYmFzZSk7CiAJUkVHX1NFVChEQ05fVk1fRkJfTE9DQVRJT05f
VE9QLCAwLAotCQkJRkJfVE9QLCBjb25maWctPnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuZmJf
dG9wKTsKKwkJCUZCX1RPUCwgcGFfY29uZmlnLT5zeXN0ZW1fYXBlcnR1cmUuZmJfdG9wKTsKIAlS
RUdfU0VUKERDTl9WTV9GQl9PRkZTRVQsIDAsCi0JCQlGQl9PRkZTRVQsIGNvbmZpZy0+cGFfY29u
ZmlnLnN5c3RlbV9hcGVydHVyZS5mYl9vZmZzZXQpOworCQkJRkJfT0ZGU0VULCBwYV9jb25maWct
PnN5c3RlbV9hcGVydHVyZS5mYl9vZmZzZXQpOwogCVJFR19TRVQoRENOX1ZNX0FHUF9CT1QsIDAs
Ci0JCQlBR1BfQk9ULCBjb25maWctPnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuYWdwX2JvdCk7
CisJCQlBR1BfQk9ULCBwYV9jb25maWctPnN5c3RlbV9hcGVydHVyZS5hZ3BfYm90KTsKIAlSRUdf
U0VUKERDTl9WTV9BR1BfVE9QLCAwLAotCQkJQUdQX1RPUCwgY29uZmlnLT5wYV9jb25maWcuc3lz
dGVtX2FwZXJ0dXJlLmFncF90b3ApOworCQkJQUdQX1RPUCwgcGFfY29uZmlnLT5zeXN0ZW1fYXBl
cnR1cmUuYWdwX3RvcCk7CiAJUkVHX1NFVChEQ05fVk1fQUdQX0JBU0UsIDAsCi0JCQlBR1BfQkFT
RSwgY29uZmlnLT5wYV9jb25maWcuc3lzdGVtX2FwZXJ0dXJlLmFncF9iYXNlKTsKKwkJCUFHUF9C
QVNFLCBwYV9jb25maWctPnN5c3RlbV9hcGVydHVyZS5hZ3BfYmFzZSk7CiAKLQlpZiAoY29uZmln
LT5wYV9jb25maWcuZ2FydF9jb25maWcucGFnZV90YWJsZV9zdGFydF9hZGRyICE9IGNvbmZpZy0+
cGFfY29uZmlnLmdhcnRfY29uZmlnLnBhZ2VfdGFibGVfZW5kX2FkZHIpIHsKKwlpZiAocGFfY29u
ZmlnLT5nYXJ0X2NvbmZpZy5wYWdlX3RhYmxlX3N0YXJ0X2FkZHIgIT0gcGFfY29uZmlnLT5nYXJ0
X2NvbmZpZy5wYWdlX3RhYmxlX2VuZF9hZGRyKSB7CiAJCXBoeXNfY29uZmlnLmRlcHRoID0gMTsK
IAkJcGh5c19jb25maWcuYmxvY2tfc2l6ZSA9IDQwOTY7Ci0JCXBoeXNfY29uZmlnLnBhZ2VfdGFi
bGVfc3RhcnRfYWRkciA9IGNvbmZpZy0+cGFfY29uZmlnLmdhcnRfY29uZmlnLnBhZ2VfdGFibGVf
c3RhcnRfYWRkciA+PiAxMjsKLQkJcGh5c19jb25maWcucGFnZV90YWJsZV9lbmRfYWRkciA9IGNv
bmZpZy0+cGFfY29uZmlnLmdhcnRfY29uZmlnLnBhZ2VfdGFibGVfZW5kX2FkZHIgPj4gMTI7CisJ
CXBoeXNfY29uZmlnLnBhZ2VfdGFibGVfc3RhcnRfYWRkciA9IHBhX2NvbmZpZy0+Z2FydF9jb25m
aWcucGFnZV90YWJsZV9zdGFydF9hZGRyID4+IDEyOworCQlwaHlzX2NvbmZpZy5wYWdlX3RhYmxl
X2VuZF9hZGRyID0gcGFfY29uZmlnLT5nYXJ0X2NvbmZpZy5wYWdlX3RhYmxlX2VuZF9hZGRyID4+
IDEyOworCQlwaHlzX2NvbmZpZy5wYWdlX3RhYmxlX2Jhc2VfYWRkciA9IHBhX2NvbmZpZy0+Z2Fy
dF9jb25maWcucGFnZV90YWJsZV9iYXNlX2FkZHI7CiAKIAkJLy8gSW5pdCBWTUlEIDAgYmFzZWQg
b24gUEEgY29uZmlnCiAJCWRjbjIwX3ZtaWRfc2V0dXAoJmh1YmJ1YjEtPnZtaWRbMF0sICZwaHlz
X2NvbmZpZyk7Ci0JCWRjbjIwX3ZtaWRfc2V0X3B0YigmaHViYnViMS0+dm1pZFswXSwgY29uZmln
LT5wYV9jb25maWcuZ2FydF9jb25maWcucGFnZV90YWJsZV9iYXNlX2FkZHIpOwogCX0KIAotCWlm
IChjb25maWctPnZhX2NvbmZpZy5wYWdlX3RhYmxlX3N0YXJ0X2FkZHIgIT0gY29uZmlnLT52YV9j
b25maWcucGFnZV90YWJsZV9lbmRfYWRkcikgewotCQkvLyBJbml0IFZNSUQgMS0xNSBiYXNlZCBv
biBWQSBjb25maWcKLQkJZm9yIChpID0gMTsgaSA8IDE2OyBpKyspIHsKLQkJCXZpcnRfY29uZmln
LnBhZ2VfdGFibGVfc3RhcnRfYWRkciA9IGNvbmZpZy0+dmFfY29uZmlnLnBhZ2VfdGFibGVfc3Rh
cnRfYWRkciA+PiAxMjsKLQkJCXZpcnRfY29uZmlnLnBhZ2VfdGFibGVfZW5kX2FkZHIgPSBjb25m
aWctPnZhX2NvbmZpZy5wYWdlX3RhYmxlX2VuZF9hZGRyID4+IDEyOwotCQkJdmlydF9jb25maWcu
ZGVwdGggPSBwYWdlX3RhYmxlX2RlcHRoX3RvX2h3KGNvbmZpZy0+dmFfY29uZmlnLnBhZ2VfdGFi
bGVfZGVwdGgpOwotCQkJdmlydF9jb25maWcuYmxvY2tfc2l6ZSA9IHBhZ2VfdGFibGVfYmxvY2tf
c2l6ZV90b19odyhjb25maWctPnZhX2NvbmZpZy5wYWdlX3RhYmxlX2Jsb2NrX3NpemUpOwotCi0J
CQlkY24yMF92bWlkX3NldHVwKCZodWJidWIxLT52bWlkW2ldLCAmdmlydF9jb25maWcpOwotCQl9
Ci0JfQorCXJldHVybiBOVU1fVk1JRDsKIH0KIAogdm9pZCBodWJidWIyX3VwZGF0ZV9kY2h1Yihz
dHJ1Y3QgaHViYnViICpodWJidWIsCkBAIC01NjQsOCArNTY0LDggQEAgc3RhdGljIHZvaWQgaHVi
YnViMl9wcm9ncmFtX3dhdGVybWFya3MoCiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaHViYnViX2Z1
bmNzIGh1YmJ1YjJfZnVuY3MgPSB7CiAJLnVwZGF0ZV9kY2h1YiA9IGh1YmJ1YjJfdXBkYXRlX2Rj
aHViLAotCS5pbml0X2RjaHViID0gaHViYnViMl9pbml0X2RjaHViLAotCS5zZXR1cF92bWlkX3B0
YiA9IGh1YmJ1YjJfc2V0dXBfdm1pZF9wdGIsCisJLmluaXRfZGNodWJfc3lzX2N0eCA9IGh1YmJ1
YjJfaW5pdF9kY2h1Yl9zeXNfY3R4LAorCS5pbml0X3ZtX2N0eCA9IGh1YmJ1YjJfaW5pdF92bV9j
dHgsCiAJLmRjY19zdXBwb3J0X3N3aXp6bGUgPSBodWJidWIyX2RjY19zdXBwb3J0X3N3aXp6bGUs
CiAJLmRjY19zdXBwb3J0X3BpeGVsX2Zvcm1hdCA9IGh1YmJ1YjJfZGNjX3N1cHBvcnRfcGl4ZWxf
Zm9ybWF0LAogCS5nZXRfZGNjX2NvbXByZXNzaW9uX2NhcCA9IGh1YmJ1YjJfZ2V0X2RjY19jb21w
cmVzc2lvbl9jYXAsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMv
ZGNuMjAvZGNuMjBfaHViYnViLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNu
MjAvZGNuMjBfaHViYnViLmgKaW5kZXggNmNhNGE1YTlmOGM3Li5hN2I2Y2EyNmE5YWQgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9odWJidWIu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHViYnVi
LmgKQEAgLTg5LDkgKzg5LDExIEBAIGJvb2wgaHViYnViMl9pbml0aWFsaXplX3ZtaWRzKHN0cnVj
dCBodWJidWIgKmh1YmJ1YiwKIAkJY29uc3Qgc3RydWN0IGRjX2RjY19zdXJmYWNlX3BhcmFtICpp
bnB1dCwKIAkJc3RydWN0IGRjX3N1cmZhY2VfZGNjX2NhcCAqb3V0cHV0KTsKIAotdm9pZCBodWJi
dWIyX2luaXRfZGNodWIoc3RydWN0IGh1YmJ1YiAqaHViYnViLAotCQlzdHJ1Y3QgaHViYnViX2Fk
ZHJfY29uZmlnICpjb25maWcpOwotCitpbnQgaHViYnViMl9pbml0X2RjaHViX3N5c19jdHgoc3Ry
dWN0IGh1YmJ1YiAqaHViYnViLAorCQlzdHJ1Y3QgZGNuX2h1YmJ1Yl9waHlzX2FkZHJfY29uZmln
ICpwYV9jb25maWcpOwordm9pZCBodWJidWIyX2luaXRfdm1fY3R4KHN0cnVjdCBodWJidWIgKmh1
YmJ1YiwKKwkJc3RydWN0IGRjbl9odWJidWJfdmlydF9hZGRyX2NvbmZpZyAqdmFfY29uZmlnLAor
CQlpbnQgdm1pZCk7CiB2b2lkIGh1YmJ1YjJfdXBkYXRlX2RjaHViKHN0cnVjdCBodWJidWIgKmh1
YmJ1YiwKIAkJc3RydWN0IGRjaHViX2luaXRfZGF0YSAqZGhfZGF0YSk7CiAKQEAgLTEwMiw4ICsx
MDQsNCBAQCB2b2lkIGh1YmJ1YjJfZ2V0X2RjaHViX3JlZl9mcmVxKHN0cnVjdCBodWJidWIgKmh1
YmJ1YiwKIHZvaWQgaHViYnViMl93bV9yZWFkX3N0YXRlKHN0cnVjdCBodWJidWIgKmh1YmJ1YiwK
IAkJc3RydWN0IGRjbl9odWJidWJfd20gKndtKTsKIAotdm9pZCBodWJidWIyX3NldHVwX3ZtaWRf
cHRiKHN0cnVjdCBodWJidWIgKmh1YmJ1YiwKLQkJdWludDY0X3QgcHRiLAotCQl1aW50OF90IHZt
aWQpOwotCiAjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9k
Yy9kY24yMC9kY24yMF9odWJwLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNu
MjAvZGNuMjBfaHVicC5jCmluZGV4IGRjYmEyYzUzMjZiMi4uZDNmN2RkMzc0ZDUwIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHVicC5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9odWJwLmMKQEAg
LTQ0Nyw4ICs0NDcsNyBAQCBib29sIGh1YnAyX2RtZGF0YV9zdGF0dXNfZG9uZShzdHJ1Y3QgaHVi
cCAqaHVicCkKIGJvb2wgaHVicDJfcHJvZ3JhbV9zdXJmYWNlX2ZsaXBfYW5kX2FkZHIoCiAJc3Ry
dWN0IGh1YnAgKmh1YnAsCiAJY29uc3Qgc3RydWN0IGRjX3BsYW5lX2FkZHJlc3MgKmFkZHJlc3Ms
Ci0JYm9vbCBmbGlwX2ltbWVkaWF0ZSwKLQl1aW50OF90IHZtaWQpCisJYm9vbCBmbGlwX2ltbWVk
aWF0ZSkKIHsKIAlzdHJ1Y3QgZGNuMjBfaHVicCAqaHVicDIgPSBUT19EQ04yMF9IVUJQKGh1YnAp
OwogCkBAIC00NTgsNyArNDU3LDcgQEAgYm9vbCBodWJwMl9wcm9ncmFtX3N1cmZhY2VfZmxpcF9h
bmRfYWRkcigKIAogCS8vIFByb2dyYW0gVk1JRCByZWcKIAlSRUdfVVBEQVRFKFZNSURfU0VUVElO
R1NfMCwKLQkJCVZNSUQsIHZtaWQpOworCQkJVk1JRCwgYWRkcmVzcy0+dm1pZCk7CiAKIAlpZiAo
YWRkcmVzcy0+dHlwZSA9PSBQTE5fQUREUl9UWVBFX0dSUEhfU1RFUkVPKSB7CiAJCVJFR19VUERB
VEUoRENTVVJGX0ZMSVBfQ09OVFJPTCwgU1VSRkFDRV9GTElQX01PREVfRk9SX1NURVJFT1NZTkMs
IDB4MSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAv
ZGNuMjBfaHVicC5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIw
X2h1YnAuaAppbmRleCBmNzkwYWI5ZGI2ZWIuLmQ1YWNjMzQ4YmUyMiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h1YnAuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHVicC5oCkBAIC0yNjAsOCAr
MjYwLDcgQEAgdm9pZCBodWJwMl9wcm9ncmFtX2RlYWRsaW5lKAogYm9vbCBodWJwMl9wcm9ncmFt
X3N1cmZhY2VfZmxpcF9hbmRfYWRkcigKIAlzdHJ1Y3QgaHVicCAqaHVicCwKIAljb25zdCBzdHJ1
Y3QgZGNfcGxhbmVfYWRkcmVzcyAqYWRkcmVzcywKLQlib29sIGZsaXBfaW1tZWRpYXRlLAotCXVp
bnQ4X3Qgdm1pZCk7CisJYm9vbCBmbGlwX2ltbWVkaWF0ZSk7CiAKIHZvaWQgaHVicDJfcHJvZ3Jh
bV9zdXJmYWNlX2NvbmZpZygKIAlzdHJ1Y3QgaHVicCAqaHVicCwKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9od3NlcS5jIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h3c2VxLmMKaW5kZXggZDU1YjE1ZmJm
ZTk5Li4yMGJjM2I5ZmU4NzkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9kY24yMC9kY24yMF9od3NlcS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9kY24yMC9kY24yMF9od3NlcS5jCkBAIC0xMTIyLDE1ICsxMTIyLDEzIEBAIHZvaWQgZGNu
MjBfZW5hYmxlX3BsYW5lKAogCQlwcmludF9ycV9kbGdfdHR1KGRjLCBwaXBlX2N0eCk7CiAJfQog
Ki8KLQlpZiAoZGMtPnZtX2NvbmZpZy52YWxpZCkgeworCWlmIChkYy0+dm1fcGFfY29uZmlnLnZh
bGlkKSB7CiAJCXN0cnVjdCB2bV9zeXN0ZW1fYXBlcnR1cmVfcGFyYW0gYXB0OwogCiAJCWFwdC5z
eXNfZGVmYXVsdC5xdWFkX3BhcnQgPSAwOwotCQlhcHQuc3lzX2hpZ2gucXVhZF9wYXJ0ID0gMDsK
LQkJYXB0LnN5c19sb3cucXVhZF9wYXJ0ID0gMDsKIAotCQlhcHQuc3lzX2hpZ2gucXVhZF9wYXJ0
ID0gZGMtPnZtX2NvbmZpZy5wYV9jb25maWcuc3lzdGVtX2FwZXJ0dXJlLnN0YXJ0X2FkZHI7Ci0J
CWFwdC5zeXNfbG93LnF1YWRfcGFydCA9IGRjLT52bV9jb25maWcucGFfY29uZmlnLnN5c3RlbV9h
cGVydHVyZS5lbmRfYWRkcjsKKwkJYXB0LnN5c19oaWdoLnF1YWRfcGFydCA9IGRjLT52bV9wYV9j
b25maWcuc3lzdGVtX2FwZXJ0dXJlLnN0YXJ0X2FkZHI7CisJCWFwdC5zeXNfbG93LnF1YWRfcGFy
dCA9IGRjLT52bV9wYV9jb25maWcuc3lzdGVtX2FwZXJ0dXJlLmVuZF9hZGRyOwogCiAJCS8vIFBy
b2dyYW0gc3lzdGVtIGFwZXJ0dXJlIHNldHRpbmdzCiAJCXBpcGVfY3R4LT5wbGFuZV9yZXMuaHVi
cC0+ZnVuY3MtPmh1YnBfc2V0X3ZtX3N5c3RlbV9hcGVydHVyZV9zZXR0aW5ncyhwaXBlX2N0eC0+
cGxhbmVfcmVzLmh1YnAsICZhcHQpOwpAQCAtMTU2NSwyNiArMTU2Myw0MyBAQCB2b2lkIGRjbjIw
X2Rpc2FibGVfc3RyZWFtKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsIGludCBvcHRpb24pCiAJ
ZGNlMTEwX2Rpc2FibGVfc3RyZWFtKHBpcGVfY3R4LCBvcHRpb24pOwogfQogCi1zdGF0aWMgdm9p
ZCBkY24yMF9pbml0X2RjaHViKHN0cnVjdCBkY2VfaHdzZXEgKmh3cywgc3RydWN0IGRjICpkYywg
c3RydWN0IGRjX2FkZHJfc3BhY2VfY29uZmlnICpjb25maWcpCitzdGF0aWMgdm9pZCBkY24yMF9p
bml0X3ZtX2N0eCgKKwkJc3RydWN0IGRjZV9od3NlcSAqaHdzLAorCQlzdHJ1Y3QgZGMgKmRjLAor
CQlzdHJ1Y3QgZGNfdmlydHVhbF9hZGRyX3NwYWNlX2NvbmZpZyAqdmFfY29uZmlnLAorCQlpbnQg
dm1pZCkKIHsKLQlzdHJ1Y3QgaHViYnViX2FkZHJfY29uZmlnIGh1YmJ1Yl9jb25maWc7Ci0KLQlo
dWJidWJfY29uZmlnLnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuZmJfdG9wID0gY29uZmlnLT5w
YV9jb25maWcuc3lzdGVtX2FwZXJ0dXJlLmZiX3RvcDsKLQlodWJidWJfY29uZmlnLnBhX2NvbmZp
Zy5zeXN0ZW1fYXBlcnR1cmUuZmJfb2Zmc2V0ID0gY29uZmlnLT5wYV9jb25maWcuc3lzdGVtX2Fw
ZXJ0dXJlLmZiX29mZnNldDsKLQlodWJidWJfY29uZmlnLnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1
cmUuZmJfYmFzZSA9IGNvbmZpZy0+cGFfY29uZmlnLnN5c3RlbV9hcGVydHVyZS5mYl9iYXNlOwot
CWh1YmJ1Yl9jb25maWcucGFfY29uZmlnLnN5c3RlbV9hcGVydHVyZS5hZ3BfdG9wID0gY29uZmln
LT5wYV9jb25maWcuc3lzdGVtX2FwZXJ0dXJlLmFncF90b3A7Ci0JaHViYnViX2NvbmZpZy5wYV9j
b25maWcuc3lzdGVtX2FwZXJ0dXJlLmFncF9ib3QgPSBjb25maWctPnBhX2NvbmZpZy5zeXN0ZW1f
YXBlcnR1cmUuYWdwX2JvdDsKLQlodWJidWJfY29uZmlnLnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1
cmUuYWdwX2Jhc2UgPSBjb25maWctPnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuYWdwX2Jhc2U7
Ci0JaHViYnViX2NvbmZpZy5wYV9jb25maWcuZ2FydF9jb25maWcucGFnZV90YWJsZV9zdGFydF9h
ZGRyID0gY29uZmlnLT5wYV9jb25maWcuZ2FydF9jb25maWcucGFnZV90YWJsZV9zdGFydF9hZGRy
OwotCWh1YmJ1Yl9jb25maWcucGFfY29uZmlnLmdhcnRfY29uZmlnLnBhZ2VfdGFibGVfZW5kX2Fk
ZHIgPSBjb25maWctPnBhX2NvbmZpZy5nYXJ0X2NvbmZpZy5wYWdlX3RhYmxlX2VuZF9hZGRyOwot
CWh1YmJ1Yl9jb25maWcucGFfY29uZmlnLmdhcnRfY29uZmlnLnBhZ2VfdGFibGVfYmFzZV9hZGRy
ID0gY29uZmlnLT5wYV9jb25maWcuZ2FydF9jb25maWcucGFnZV90YWJsZV9iYXNlX2FkZHI7Ci0K
LQlodWJidWJfY29uZmlnLnZhX2NvbmZpZy5wYWdlX3RhYmxlX3N0YXJ0X2FkZHIgPSBjb25maWct
PnZhX2NvbmZpZy5wYWdlX3RhYmxlX3N0YXJ0X2FkZHI7Ci0JaHViYnViX2NvbmZpZy52YV9jb25m
aWcucGFnZV90YWJsZV9lbmRfYWRkciA9IGNvbmZpZy0+dmFfY29uZmlnLnBhZ2VfdGFibGVfZW5k
X2FkZHI7Ci0JaHViYnViX2NvbmZpZy52YV9jb25maWcucGFnZV90YWJsZV9ibG9ja19zaXplID0g
Y29uZmlnLT52YV9jb25maWcucGFnZV90YWJsZV9ibG9ja19zaXplX2luX2J5dGVzOwotCWh1YmJ1
Yl9jb25maWcudmFfY29uZmlnLnBhZ2VfdGFibGVfZGVwdGggPSBjb25maWctPnZhX2NvbmZpZy5w
YWdlX3RhYmxlX2RlcHRoOwotCi0JZGMtPnJlc19wb29sLT5odWJidWItPmZ1bmNzLT5pbml0X2Rj
aHViKGRjLT5yZXNfcG9vbC0+aHViYnViLCAmaHViYnViX2NvbmZpZyk7CisJc3RydWN0IGRjbl9o
dWJidWJfdmlydF9hZGRyX2NvbmZpZyBjb25maWc7CisKKwlpZiAodm1pZCA9PSAwKSB7CisJCUFT
U0VSVCgwKTsgLyogVk1JRCBjYW5ub3QgYmUgMCBmb3Igdm0gY29udGV4dCAqLworCQlyZXR1cm47
CisJfQorCisJY29uZmlnLnBhZ2VfdGFibGVfc3RhcnRfYWRkciA9IHZhX2NvbmZpZy0+cGFnZV90
YWJsZV9zdGFydF9hZGRyOworCWNvbmZpZy5wYWdlX3RhYmxlX2VuZF9hZGRyID0gdmFfY29uZmln
LT5wYWdlX3RhYmxlX2VuZF9hZGRyOworCWNvbmZpZy5wYWdlX3RhYmxlX2Jsb2NrX3NpemUgPSB2
YV9jb25maWctPnBhZ2VfdGFibGVfYmxvY2tfc2l6ZV9pbl9ieXRlczsKKwljb25maWcucGFnZV90
YWJsZV9kZXB0aCA9IHZhX2NvbmZpZy0+cGFnZV90YWJsZV9kZXB0aDsKKwljb25maWcucGFnZV90
YWJsZV9iYXNlX2FkZHIgPSB2YV9jb25maWctPnBhZ2VfdGFibGVfYmFzZV9hZGRyOworCisJZGMt
PnJlc19wb29sLT5odWJidWItPmZ1bmNzLT5pbml0X3ZtX2N0eChkYy0+cmVzX3Bvb2wtPmh1YmJ1
YiwgJmNvbmZpZywgdm1pZCk7Cit9CisKK3N0YXRpYyBpbnQgZGNuMjBfaW5pdF9zeXNfY3R4KHN0
cnVjdCBkY2VfaHdzZXEgKmh3cywgc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3BoeV9hZGRyX3Nw
YWNlX2NvbmZpZyAqcGFfY29uZmlnKQoreworCXN0cnVjdCBkY25faHViYnViX3BoeXNfYWRkcl9j
b25maWcgY29uZmlnOworCisJY29uZmlnLnN5c3RlbV9hcGVydHVyZS5mYl90b3AgPSBwYV9jb25m
aWctPnN5c3RlbV9hcGVydHVyZS5mYl90b3A7CisJY29uZmlnLnN5c3RlbV9hcGVydHVyZS5mYl9v
ZmZzZXQgPSBwYV9jb25maWctPnN5c3RlbV9hcGVydHVyZS5mYl9vZmZzZXQ7CisJY29uZmlnLnN5
c3RlbV9hcGVydHVyZS5mYl9iYXNlID0gcGFfY29uZmlnLT5zeXN0ZW1fYXBlcnR1cmUuZmJfYmFz
ZTsKKwljb25maWcuc3lzdGVtX2FwZXJ0dXJlLmFncF90b3AgPSBwYV9jb25maWctPnN5c3RlbV9h
cGVydHVyZS5hZ3BfdG9wOworCWNvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuYWdwX2JvdCA9IHBhX2Nv
bmZpZy0+c3lzdGVtX2FwZXJ0dXJlLmFncF9ib3Q7CisJY29uZmlnLnN5c3RlbV9hcGVydHVyZS5h
Z3BfYmFzZSA9IHBhX2NvbmZpZy0+c3lzdGVtX2FwZXJ0dXJlLmFncF9iYXNlOworCWNvbmZpZy5n
YXJ0X2NvbmZpZy5wYWdlX3RhYmxlX3N0YXJ0X2FkZHIgPSBwYV9jb25maWctPmdhcnRfY29uZmln
LnBhZ2VfdGFibGVfc3RhcnRfYWRkcjsKKwljb25maWcuZ2FydF9jb25maWcucGFnZV90YWJsZV9l
bmRfYWRkciA9IHBhX2NvbmZpZy0+Z2FydF9jb25maWcucGFnZV90YWJsZV9lbmRfYWRkcjsKKwlj
b25maWcuZ2FydF9jb25maWcucGFnZV90YWJsZV9iYXNlX2FkZHIgPSBwYV9jb25maWctPmdhcnRf
Y29uZmlnLnBhZ2VfdGFibGVfYmFzZV9hZGRyOworCisJcmV0dXJuIGRjLT5yZXNfcG9vbC0+aHVi
YnViLT5mdW5jcy0+aW5pdF9kY2h1Yl9zeXNfY3R4KGRjLT5yZXNfcG9vbC0+aHViYnViLCAmY29u
ZmlnKTsKIH0KIAogc3RhdGljIGJvb2wgcGF0Y2hfYWRkcmVzc19mb3Jfc2JzX3RiX3N0ZXJlbygK
QEAgLTE2MTksMzAgKzE2MzQsMTkgQEAgc3RhdGljIHZvaWQgZGNuMjBfdXBkYXRlX3BsYW5lX2Fk
ZHIoY29uc3Qgc3RydWN0IGRjICpkYywgc3RydWN0IHBpcGVfY3R4ICpwaXBlX2MKIAlib29sIGFk
ZHJfcGF0Y2hlZCA9IGZhbHNlOwogCVBIWVNJQ0FMX0FERFJFU1NfTE9DIGFkZHI7CiAJc3RydWN0
IGRjX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSA9IHBpcGVfY3R4LT5wbGFuZV9zdGF0ZTsKLQl1
aW50OF90IHZtaWQ7CiAKIAlpZiAocGxhbmVfc3RhdGUgPT0gTlVMTCkKIAkJcmV0dXJuOwogCiAJ
YWRkcl9wYXRjaGVkID0gcGF0Y2hfYWRkcmVzc19mb3Jfc2JzX3RiX3N0ZXJlbyhwaXBlX2N0eCwg
JmFkZHIpOwogCi0JLy8gQ2FsbCBIZWxwZXIgdG8gYXNzaWduIGNvcnJlY3QgVk1JRCB0byB0aGlz
IFBUQgotCXZtaWQgPSBnZXRfdm1pZF9mb3JfcHRiKGRjLT52bV9oZWxwZXIsCi0JCQlwbGFuZV9z
dGF0ZS0+YWRkcmVzcy5wYWdlX3RhYmxlX2Jhc2UucXVhZF9wYXJ0LAotCQkJcGlwZV9jdHgtPnBp
cGVfaWR4KTsKLQotCS8vIENhbGwgaHViYnViIHRvIHByb2dyYW0gUFRCIG9mIFZNSUQgb25seSBp
ZiBpdHMgVkEKLQkvLyBQQSBQVEIgaXMgYSBvbmUtdGltZSBzZXR1cCBhdCBpbml0Ci0JaWYgKHZt
aWQgPiAwICYmIGRjLT5yZXNfcG9vbC0+aHViYnViLT5mdW5jcy0+c2V0dXBfdm1pZF9wdGIpCi0J
CWRjLT5yZXNfcG9vbC0+aHViYnViLT5mdW5jcy0+c2V0dXBfdm1pZF9wdGIoZGMtPnJlc19wb29s
LT5odWJidWIsCi0JCQkJcGxhbmVfc3RhdGUtPmFkZHJlc3MucGFnZV90YWJsZV9iYXNlLnF1YWRf
cGFydCwKLQkJCQl2bWlkKTsKKwkvLyBDYWxsIEhlbHBlciB0byB0cmFjayBWTUlEIHVzZQorCXZt
X2hlbHBlcl9tYXJrX3ZtaWRfdXNlZChkYy0+dm1faGVscGVyLCBwbGFuZV9zdGF0ZS0+YWRkcmVz
cy52bWlkLCBwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnAtPmluc3QpOwogCiAJcGlwZV9jdHgtPnBs
YW5lX3Jlcy5odWJwLT5mdW5jcy0+aHVicF9wcm9ncmFtX3N1cmZhY2VfZmxpcF9hbmRfYWRkcigK
IAkJCXBpcGVfY3R4LT5wbGFuZV9yZXMuaHVicCwKIAkJCSZwbGFuZV9zdGF0ZS0+YWRkcmVzcywK
LQkJCXBsYW5lX3N0YXRlLT5mbGlwX2ltbWVkaWF0ZSwKLQkJCXZtaWQpOworCQkJcGxhbmVfc3Rh
dGUtPmZsaXBfaW1tZWRpYXRlKTsKIAogCXBsYW5lX3N0YXRlLT5zdGF0dXMucmVxdWVzdGVkX2Fk
ZHJlc3MgPSBwbGFuZV9zdGF0ZS0+YWRkcmVzczsKIApAQCAtMTk5MSw3ICsxOTk1LDggQEAgdm9p
ZCBkY24yMF9od19zZXF1ZW5jZXJfY29uc3RydWN0KHN0cnVjdCBkYyAqZGMpCiAJZGMtPmh3c3Mu
YmxhbmtfcGl4ZWxfZGF0YSA9IGRjbjIwX2JsYW5rX3BpeGVsX2RhdGE7CiAJZGMtPmh3c3MuZG1k
YXRhX3N0YXR1c19kb25lID0gZGNuMjBfZG1kYXRhX3N0YXR1c19kb25lOwogCWRjLT5od3NzLmRp
c2FibGVfc3RyZWFtID0gZGNuMjBfZGlzYWJsZV9zdHJlYW07Ci0JZGMtPmh3c3MuaW5pdF9kY2h1
YiA9IGRjbjIwX2luaXRfZGNodWI7CisJZGMtPmh3c3MuaW5pdF9zeXNfY3R4ID0gZGNuMjBfaW5p
dF9zeXNfY3R4OworCWRjLT5od3NzLmluaXRfdm1fY3R4ID0gZGNuMjBfaW5pdF92bV9jdHg7CiAJ
ZGMtPmh3c3MuZGlzYWJsZV9zdHJlYW1fZ2F0aW5nID0gZGNuMjBfZGlzYWJsZV9zdHJlYW1fZ2F0
aW5nOwogCWRjLT5od3NzLmVuYWJsZV9zdHJlYW1fZ2F0aW5nID0gZGNuMjBfZW5hYmxlX3N0cmVh
bV9nYXRpbmc7CiAJZGMtPmh3c3Muc2V0dXBfdnVwZGF0ZV9pbnRlcnJ1cHQgPSBkY24yMF9zZXR1
cF92dXBkYXRlX2ludGVycnVwdDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9kYy9kY24yMC9kY24yMF9yZXNvdXJjZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNw
bGF5L2RjL2RjbjIwL2RjbjIwX3Jlc291cmNlLmMKaW5kZXggMjZhZjg2MGRmN2Q0Li40Y2M2NmMy
Y2NiMWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9k
Y24yMF9yZXNvdXJjZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24y
MC9kY24yMF9yZXNvdXJjZS5jCkBAIC0yODk5LDcgKzI4OTksNyBAQCBzdGF0aWMgYm9vbCBjb25z
dHJ1Y3QoCiAKIAkvLyBJbml0IHRoZSB2bV9oZWxwZXIKIAlpZiAoZGMtPnZtX2hlbHBlcikKLQkJ
aW5pdF92bV9oZWxwZXIoZGMtPnZtX2hlbHBlciwgMTYsIHBvb2wtPmJhc2UucGlwZV9jb3VudCk7
CisJCXZtX2hlbHBlcl9pbml0KGRjLT52bV9oZWxwZXIsIDE2KTsKIAogCS8qKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAJICogIENyZWF0ZSByZXNvdXJj
ZXMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF92bWlkLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfdm1pZC5jCmluZGV4IDUwOTUzYzBiZDRlMy4uMjc2
NzllZjZlYmU4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNu
MjAvZGNuMjBfdm1pZC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24y
MC9kY24yMF92bWlkLmMKQEAgLTUxLDEyICs1MSw5IEBAIHZvaWQgZGNuMjBfdm1pZF9zZXR1cChz
dHJ1Y3QgZGNuMjBfdm1pZCAqdm1pZCwgY29uc3Qgc3RydWN0IGRjbl92bWlkX3BhZ2VfdGFibGVf
CiAJUkVHX1NFVF8yKENOVEwsIDAsCiAJCQlWTV9DT05URVhUMF9QQUdFX1RBQkxFX0RFUFRILCBj
b25maWctPmRlcHRoLAogCQkJVk1fQ09OVEVYVDBfUEFHRV9UQUJMRV9CTE9DS19TSVpFLCBjb25m
aWctPmJsb2NrX3NpemUpOwotfQogCi12b2lkIGRjbjIwX3ZtaWRfc2V0X3B0YihzdHJ1Y3QgZGNu
MjBfdm1pZCAqdm1pZCwgdWludDY0X3QgYmFzZSkKLXsKIAlSRUdfU0VUKFBBR0VfVEFCTEVfQkFT
RV9BRERSX0hJMzIsIDAsCi0JCQlWTV9DT05URVhUMF9QQUdFX0RJUkVDVE9SWV9FTlRSWV9ISTMy
LCAoYmFzZSA+PiAzMikgJiAweEZGRkZGRkZGKTsKKwkJCVZNX0NPTlRFWFQwX1BBR0VfRElSRUNU
T1JZX0VOVFJZX0hJMzIsIChjb25maWctPnBhZ2VfdGFibGVfYmFzZV9hZGRyID4+IDMyKSAmIDB4
RkZGRkZGRkYpOwogCVJFR19TRVQoUEFHRV9UQUJMRV9CQVNFX0FERFJfTE8zMiwgMCwKLQkJCVZN
X0NPTlRFWFQwX1BBR0VfRElSRUNUT1JZX0VOVFJZX0xPMzIsIGJhc2UgJiAweEZGRkZGRkZGKTsK
KwkJCVZNX0NPTlRFWFQwX1BBR0VfRElSRUNUT1JZX0VOVFJZX0xPMzIsIGNvbmZpZy0+cGFnZV90
YWJsZV9iYXNlX2FkZHIgJiAweEZGRkZGRkZGKTsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF92bWlkLmggYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfdm1pZC5oCmluZGV4IDljMmY3MDE2YWYyYS4uMDJm
YWZiMDEzZmM2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNu
MjAvZGNuMjBfdm1pZC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24y
MC9kY24yMF92bWlkLmgKQEAgLTg2LDYgKzg2LDUgQEAgc3RydWN0IGRjbjIwX3ZtaWQgewogfTsK
IAogdm9pZCBkY24yMF92bWlkX3NldHVwKHN0cnVjdCBkY24yMF92bWlkICp2bWlkLCBjb25zdCBz
dHJ1Y3QgZGNuX3ZtaWRfcGFnZV90YWJsZV9jb25maWcgKmNvbmZpZyk7Ci12b2lkIGRjbjIwX3Zt
aWRfc2V0X3B0YihzdHJ1Y3QgZGNuMjBfdm1pZCAqdm1pZCwgdWludDY0X3QgYmFzZSk7CiAKICNl
bmRpZiAvKiBEQUxfRENfRENOMjBfRENOMjBfVk1JRF9IXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9ody9kY2h1YmJ1Yi5oIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9ody9kY2h1YmJ1Yi5oCmluZGV4IGQ1NmZkN2Q4N2JiYy4u
OTU5ZjViNjU0NjExIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMv
aW5jL2h3L2RjaHViYnViLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2lu
Yy9ody9kY2h1YmJ1Yi5oCkBAIC04Nyw2ICs4Nyw3IEBAIHN0cnVjdCBkY25faHViYnViX3ZpcnRf
YWRkcl9jb25maWcgewogCXVpbnQ2NF90CQkJCXBhZ2VfdGFibGVfZW5kX2FkZHI7CiAJZW51bSBk
Y25faHViYnViX3BhZ2VfdGFibGVfYmxvY2tfc2l6ZQlwYWdlX3RhYmxlX2Jsb2NrX3NpemU7CiAJ
ZW51bSBkY25faHViYnViX3BhZ2VfdGFibGVfZGVwdGgJcGFnZV90YWJsZV9kZXB0aDsKKwl1aW50
NjRfdAkJCQlwYWdlX3RhYmxlX2Jhc2VfYWRkcjsKIH07CiAKIHN0cnVjdCBodWJidWJfYWRkcl9j
b25maWcgewpAQCAtMTA1LDE4ICsxMDYsMTMgQEAgc3RydWN0IGh1YmJ1Yl9mdW5jcyB7CiAJCQlz
dHJ1Y3QgZGNodWJfaW5pdF9kYXRhICpkaF9kYXRhKTsKIAogI2lmZGVmIENPTkZJR19EUk1fQU1E
X0RDX0RDTjJfMAotCXZvaWQgKCppbml0X2RjaHViKSgKKwlpbnQgKCppbml0X2RjaHViX3N5c19j
dHgpKAogCQkJc3RydWN0IGh1YmJ1YiAqaHViYnViLAotCQkJc3RydWN0IGh1YmJ1Yl9hZGRyX2Nv
bmZpZyAqY29uZmlnKTsKLQl2b2lkICgqc2V0dXBfdm1pZF9wdGIpKAorCQkJc3RydWN0IGRjbl9o
dWJidWJfcGh5c19hZGRyX2NvbmZpZyAqcGFfY29uZmlnKTsKKwl2b2lkICgqaW5pdF92bV9jdHgp
KAogCQkJc3RydWN0IGh1YmJ1YiAqaHViYnViLAotCQkJdWludDY0X3QgcHRiLAotCQkJdWludDhf
dCB2bWlkKTsKLQotCXZvaWQgKCpzZXRfcHRiKSgKLQkJCXN0cnVjdCBodWJidWIgKmh1YmJ1YiwK
LQkJCXVpbnQ4X3Qgdm1pZCwKLQkJCXVpbnQ2NF90IGJhc2VfYWRkcik7CisJCQlzdHJ1Y3QgZGNu
X2h1YmJ1Yl92aXJ0X2FkZHJfY29uZmlnICp2YV9jb25maWcsCisJCQlpbnQgdm1pZCk7CiAKICNl
bmRpZgogCWJvb2wgKCpnZXRfZGNjX2NvbXByZXNzaW9uX2NhcCkoc3RydWN0IGh1YmJ1YiAqaHVi
YnViLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9ody9o
dWJwLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3L2h1YnAuaAppbmRl
eCAzNDI0Nzc4MjJkYzAuLjUxYmZmODcxN2NjOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2luYy9ody9odWJwLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2luYy9ody9odWJwLmgKQEAgLTgzLDggKzgzLDcgQEAgc3RydWN0IGh1YnBfZnVu
Y3MgewogCWJvb2wgKCpodWJwX3Byb2dyYW1fc3VyZmFjZV9mbGlwX2FuZF9hZGRyKSgKIAkJc3Ry
dWN0IGh1YnAgKmh1YnAsCiAJCWNvbnN0IHN0cnVjdCBkY19wbGFuZV9hZGRyZXNzICphZGRyZXNz
LAotCQlib29sIGZsaXBfaW1tZWRpYXRlLAotCQl1aW50OF90IHZtaWQpOworCQlib29sIGZsaXBf
aW1tZWRpYXRlKTsKIAogCXZvaWQgKCpodWJwX3Byb2dyYW1fcHRlX3ZtKSgKIAkJc3RydWN0IGh1
YnAgKmh1YnAsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5j
L2h3L3ZtaWQuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHcvdm1pZC5o
CmluZGV4IDAzN2JlYjBhMmEyNy4uNzZkZTBlNDI4NGUwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3L3ZtaWQuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvaW5jL2h3L3ZtaWQuaApAQCAtNDQsNiArNDQsNyBAQCBzdHJ1Y3QgZGNu
X3ZtaWRfcGFnZV90YWJsZV9jb25maWcgewogCXVpbnQ2NF90CXBhZ2VfdGFibGVfZW5kX2FkZHI7
CiAJZW51bSBkY25faHViYnViX3BhZ2VfdGFibGVfZGVwdGgJZGVwdGg7CiAJZW51bSBkY25faHVi
YnViX3BhZ2VfdGFibGVfYmxvY2tfc2l6ZQlibG9ja19zaXplOworCXVpbnQ2NF90CXBhZ2VfdGFi
bGVfYmFzZV9hZGRyOwogfTsKIAogI2VuZGlmIC8qIERBTF9EQ19JTkNfSFdfVk1JRF9IXyAqLwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9od19zZXF1ZW5j
ZXIuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHdfc2VxdWVuY2VyLmgK
aW5kZXggMTNiMTEzZDBmZTE5Li40ZmZlNDJjMjdjM2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHdfc2VxdWVuY2VyLmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9od19zZXF1ZW5jZXIuaApAQCAtNzUsNyArNzUsOCBAQCBz
dHJ1Y3QgcmVzb3VyY2VfcG9vbDsKIHN0cnVjdCByZXNvdXJjZV9jb250ZXh0Owogc3RydWN0IHN0
cmVhbV9yZXNvdXJjZTsKICNpZmRlZiBDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzAKLXN0cnVjdCBk
Y19hZGRyX3NwYWNlX2NvbmZpZzsKK3N0cnVjdCBkY19waHlfYWRkcl9zcGFjZV9jb25maWc7Citz
dHJ1Y3QgZGNfdmlydHVhbF9hZGRyX3NwYWNlX2NvbmZpZzsKICNlbmRpZgogCiBzdHJ1Y3QgaHdf
c2VxdWVuY2VyX2Z1bmNzIHsKQEAgLTEzMiwxMSArMTMzLDE1IEBAIHN0cnVjdCBod19zZXF1ZW5j
ZXJfZnVuY3MgewogCQlzdHJ1Y3QgZGNodWJfaW5pdF9kYXRhICpkaF9kYXRhKTsKIAogI2lmZGVm
IENPTkZJR19EUk1fQU1EX0RDX0RDTjJfMAotCXZvaWQgKCppbml0X2RjaHViKSgKLQkJc3RydWN0
IGRjZV9od3NlcSAqaHdzLAotCQlzdHJ1Y3QgZGMgKmRjLAotCQlzdHJ1Y3QgZGNfYWRkcl9zcGFj
ZV9jb25maWcgKmRoX2RhdGEpOwotCisJaW50ICgqaW5pdF9zeXNfY3R4KSgKKwkJCXN0cnVjdCBk
Y2VfaHdzZXEgKmh3cywKKwkJCXN0cnVjdCBkYyAqZGMsCisJCQlzdHJ1Y3QgZGNfcGh5X2FkZHJf
c3BhY2VfY29uZmlnICpwYV9jb25maWcpOworCXZvaWQgKCppbml0X3ZtX2N0eCkoCisJCQlzdHJ1
Y3QgZGNlX2h3c2VxICpod3MsCisJCQlzdHJ1Y3QgZGMgKmRjLAorCQkJc3RydWN0IGRjX3ZpcnR1
YWxfYWRkcl9zcGFjZV9jb25maWcgKnZhX2NvbmZpZywKKwkJCWludCB2bWlkKTsKICNlbmRpZgog
CXZvaWQgKCp1cGRhdGVfbXBjYykoCiAJCXN0cnVjdCBkYyAqZGMsCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL3ZtX2hlbHBlci5oIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2luYy92bV9oZWxwZXIuaAppbmRleCAxOTM0MDdmNzZhODAuLjhi
ZmNlZjBhMzY3NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2lu
Yy92bV9oZWxwZXIuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL3Zt
X2hlbHBlci5oCkBAIC0yOCwyOSArMjgsMjEgQEAKIAogI2luY2x1ZGUgImRjX3R5cGVzLmgiCiAK
LSNkZWZpbmUgTUFYX1ZNSUQgMTYKICNkZWZpbmUgTUFYX0hVQlAgNgogCiBzdHJ1Y3Qgdm1pZF91
c2FnZSB7Ci0JdWludDE2X3Qgdm1pZF91c2FnZVsyXTsKKwlpbnQgdm1pZF91c2FnZVsyXTsKIH07
CiAKIHN0cnVjdCB2bV9oZWxwZXIgewogCXVuc2lnbmVkIGludCBudW1fdm1pZDsKLQl1bnNpZ25l
ZCBpbnQgbnVtX2h1YnA7Ci0JdW5zaWduZWQgaW50IG51bV92bWlkc19hdmFpbGFibGU7Ci0JdWlu
dDY0X3QgcHRiX2Fzc2lnbmVkX3RvX3ZtaWRbTUFYX1ZNSURdOwogCXN0cnVjdCB2bWlkX3VzYWdl
IGh1YnBfdm1pZF91c2FnZVtNQVhfSFVCUF07CiB9OwogCi11aW50OF90IGdldF92bWlkX2Zvcl9w
dGIoCi0JCXN0cnVjdCB2bV9oZWxwZXIgKnZtX2hlbHBlciwKLQkJaW50NjRfdCBwdGIsCi0JCXVp
bnQ4X3QgcGlwZV9pZHgpOwordm9pZCB2bV9oZWxwZXJfbWFya192bWlkX3VzZWQoc3RydWN0IHZt
X2hlbHBlciAqdm1faGVscGVyLCB1bnNpZ25lZCBpbnQgcG9zLCB1aW50OF90IGh1YnBfaWR4KTsK
IAotdm9pZCBpbml0X3ZtX2hlbHBlcigKK3ZvaWQgdm1faGVscGVyX2luaXQoCiAJc3RydWN0IHZt
X2hlbHBlciAqdm1faGVscGVyLAotCXVuc2lnbmVkIGludCBudW1fdm1pZCwKLQl1bnNpZ25lZCBp
bnQgbnVtX2h1YnApOworCXVuc2lnbmVkIGludCBudW1fdm1pZCk7CiAKICNlbmRpZiAvKiBEQ19J
TkNfVk1fSEVMUEVSX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvbW9kdWxlcy9pbmMvbW9kX3ZtaWQuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9t
b2R1bGVzL2luYy9tb2Rfdm1pZC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAw
MDAwMC4uYzc2NzJmM2I4MzdmCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9kaXNwbGF5L21vZHVsZXMvaW5jL21vZF92bWlkLmgKQEAgLTAsMCArMSw0NCBAQAorLyoKKyAq
IENvcHlyaWdodCAyMDE5IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KKyAqCisgKiBQZXJt
aXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBv
YnRhaW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3Vt
ZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3
YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAq
IHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmli
dXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwg
YW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNo
ZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAq
IFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNo
YWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25z
IG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElT
IiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwg
SU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFC
SUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklO
R0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9S
IEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgorICogT1RIRVIg
TElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhF
UldJU0UsCisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhF
IFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FS
RS4KKyAqCisgKiBBdXRob3JzOiBBTUQKKyAqCisgKi8KKworI2lmbmRlZiBNT0RfVk1JRF9IXwor
I2RlZmluZSBNT0RfVk1JRF9IXworCisjZGVmaW5lIE1BWF9WTUlEIDE2CisKKyNpbmNsdWRlICJk
Yy5oIgorCitzdHJ1Y3QgbW9kX3ZtaWQgeworCWludCBkdW1teTsKK307CisKK3VpbnQ4X3QgbW9k
X3ZtaWRfZ2V0X2Zvcl9wdGIoc3RydWN0IG1vZF92bWlkICptb2Rfdm1pZCwgdWludDY0X3QgcHRi
KTsKK3ZvaWQgbW9kX3ZtaWRfcmVzZXQoc3RydWN0IG1vZF92bWlkICptb2Rfdm1pZCk7CitzdHJ1
Y3QgbW9kX3ZtaWQgKm1vZF92bWlkX2NyZWF0ZSgKKwkJc3RydWN0IGRjICpkYywKKwkJdW5zaWdu
ZWQgaW50IG51bV92bWlkLAorCQlzdHJ1Y3QgZGNfdmlydHVhbF9hZGRyX3NwYWNlX2NvbmZpZyAq
dmFfY29uZmlnKTsKKworI2VuZGlmIC8qIE1PRF9WTUlEX0hfICovCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvbW9kdWxlcy92bWlkL3ZtaWQuYyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvZGlzcGxheS9tb2R1bGVzL3ZtaWQvdm1pZC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDAwMDAwMDAwMDAwMC4uNDMxMDUyNjI2ZDkzCi0tLSAvZGV2L251bGwKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L21vZHVsZXMvdm1pZC92bWlkLmMKQEAgLTAsMCArMSwx
NTggQEAKKy8qCisgKiBDb3B5cmlnaHQgMjAxOSBBZHZhbmNlZCBNaWNybyBEZXZpY2VzLCBJbmMu
CisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRv
IGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNz
b2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFs
IGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBs
aW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVi
bGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0
aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQorICogU29mdHdh
cmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0
aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNz
aW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgorICogYWxsIGNvcGllcyBvciBzdWJzdGFu
dGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJFIElTIFBS
T1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IK
KyAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMg
T0YgTUVSQ0hBTlRBQklMSVRZLAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0Ug
QU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUgQ09QWVJJR0hU
IEhPTERFUihTKSBPUiBBVVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMg
T1IKKyAqIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1Qs
IFRPUlQgT1IgT1RIRVJXSVNFLAorICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVD
VElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SCisgKiBPVEhFUiBERUFMSU5HUyBJ
TiBUSEUgU09GVFdBUkUuCisgKgorICogQXV0aG9yczogQU1ECisgKgorICovCisKKyNpbmNsdWRl
ICJtb2Rfdm1pZC5oIgorCitzdHJ1Y3QgY29yZV92bWlkIHsKKwlzdHJ1Y3QgbW9kX3ZtaWQgcHVi
bGljOworCXN0cnVjdCBkYyAqZGM7CisKKwl1bnNpZ25lZCBpbnQgbnVtX3ZtaWQ7CisJdW5zaWdu
ZWQgaW50IG51bV92bWlkc19hdmFpbGFibGU7CisJdWludDY0X3QgcHRiX2Fzc2lnbmVkX3RvX3Zt
aWRbTUFYX1ZNSURdOworCXN0cnVjdCBkY192aXJ0dWFsX2FkZHJfc3BhY2VfY29uZmlnIGJhc2Vf
Y29uZmlnOworfTsKKworI2RlZmluZSBNT0RfVk1JRF9UT19DT1JFKG1vZF92bWlkKVwKKwkJY29u
dGFpbmVyX29mKG1vZF92bWlkLCBzdHJ1Y3QgY29yZV92bWlkLCBwdWJsaWMpCisKK3N0YXRpYyB2
b2lkIGFkZF9wdGJfdG9fdGFibGUoc3RydWN0IGNvcmVfdm1pZCAqY29yZV92bWlkLCB1bnNpZ25l
ZCBpbnQgdm1pZCwgdWludDY0X3QgcHRiKQoreworCWNvcmVfdm1pZC0+cHRiX2Fzc2lnbmVkX3Rv
X3ZtaWRbdm1pZF0gPSBwdGI7CisJY29yZV92bWlkLT5udW1fdm1pZHNfYXZhaWxhYmxlLS07Cit9
CisKK3N0YXRpYyB2b2lkIGNsZWFyX2VudHJ5X2Zyb21fdm1pZF90YWJsZShzdHJ1Y3QgY29yZV92
bWlkICpjb3JlX3ZtaWQsIHVuc2lnbmVkIGludCB2bWlkKQoreworCWNvcmVfdm1pZC0+cHRiX2Fz
c2lnbmVkX3RvX3ZtaWRbdm1pZF0gPSAwOworCWNvcmVfdm1pZC0+bnVtX3ZtaWRzX2F2YWlsYWJs
ZSsrOworfQorCitzdGF0aWMgdm9pZCBldmljdF92bWlkcyhzdHJ1Y3QgY29yZV92bWlkICpjb3Jl
X3ZtaWQpCit7CisJaW50IGk7CisJdWludDE2X3Qgb3JkID0gZGNfZ2V0X3ZtaWRfdXNlX3ZlY3Rv
cihjb3JlX3ZtaWQtPmRjKTsKKworCS8vIEF0IHRoaXMgcG9pbnQgYW55IHBvc2l0aW9ucyB3aXRo
IHZhbHVlIDAgYXJlIHVudXNlZCB2bWlkcywgZXZpY3QgdGhlbQorCWZvciAoaSA9IDE7IGkgPCBj
b3JlX3ZtaWQtPm51bV92bWlkOyBpKyspIHsKKwkJaWYgKG9yZCAmICgxdSA8PCBpKSkKKwkJCWNs
ZWFyX2VudHJ5X2Zyb21fdm1pZF90YWJsZShjb3JlX3ZtaWQsIGkpOworCX0KK30KKworLy8gUmV0
dXJuIHZhbHVlIG9mIC0xIGluZGljYXRlcyB2bWlkIHRhYmxlIHVuaXRpYWxpemVkIG9yIHB0YiBk
bmUgaW4gdGhlIHRhYmxlCitzdGF0aWMgaW50IGdldF9leGlzdGluZ192bWlkX2Zvcl9wdGIoc3Ry
dWN0IGNvcmVfdm1pZCAqY29yZV92bWlkLCB1aW50NjRfdCBwdGIpCit7CisJaW50IGk7CisKKwlm
b3IgKGkgPSAwOyBpIDwgY29yZV92bWlkLT5udW1fdm1pZDsgaSsrKSB7CisJCWlmIChjb3JlX3Zt
aWQtPnB0Yl9hc3NpZ25lZF90b192bWlkW2ldID09IHB0YikKKwkJCXJldHVybiBpOworCX0KKwor
CXJldHVybiAtMTsKK30KKworLy8gRXhwZWN0ZWQgdG8gYmUgY2FsbGVkIG9ubHkgd2hlbiB0aGVy
ZSdzIGFuIGF2YWlsYWJsZSB2bWlkCitzdGF0aWMgaW50IGdldF9uZXh0X2F2YWlsYWJsZV92bWlk
KHN0cnVjdCBjb3JlX3ZtaWQgKmNvcmVfdm1pZCkKK3sKKwlpbnQgaTsKKworCWZvciAoaSA9IDE7
IGkgPCBjb3JlX3ZtaWQtPm51bV92bWlkOyBpKyspIHsKKwkJaWYgKGNvcmVfdm1pZC0+cHRiX2Fz
c2lnbmVkX3RvX3ZtaWRbaV0gPT0gMCkKKwkJCXJldHVybiBpOworCX0KKworCXJldHVybiAtMTsK
K30KKwordWludDhfdCBtb2Rfdm1pZF9nZXRfZm9yX3B0YihzdHJ1Y3QgbW9kX3ZtaWQgKm1vZF92
bWlkLCB1aW50NjRfdCBwdGIpCit7CisJc3RydWN0IGNvcmVfdm1pZCAqY29yZV92bWlkID0gTU9E
X1ZNSURfVE9fQ09SRShtb2Rfdm1pZCk7CisJdW5zaWduZWQgaW50IHZtaWQgPSAwOworCisJLy8g
UGh5c2ljYWwgYWRkcmVzcyBnZXRzIHZtaWQgMAorCWlmIChwdGIgPT0gMCkKKwkJcmV0dXJuIDA7
CisKKwl2bWlkID0gZ2V0X2V4aXN0aW5nX3ZtaWRfZm9yX3B0Yihjb3JlX3ZtaWQsIHB0Yik7CisK
KwlpZiAodm1pZCA9PSAtMSkgeworCQlzdHJ1Y3QgZGNfdmlydHVhbF9hZGRyX3NwYWNlX2NvbmZp
ZyB2YV9jb25maWcgPSBjb3JlX3ZtaWQtPmJhc2VfY29uZmlnOworCisJCXZhX2NvbmZpZy5wYWdl
X3RhYmxlX2Jhc2VfYWRkciA9IHB0YjsKKworCQlpZiAoY29yZV92bWlkLT5udW1fdm1pZHNfYXZh
aWxhYmxlID09IDApCisJCQlldmljdF92bWlkcyhjb3JlX3ZtaWQpOworCisJCXZtaWQgPSBnZXRf
bmV4dF9hdmFpbGFibGVfdm1pZChjb3JlX3ZtaWQpOworCQlhZGRfcHRiX3RvX3RhYmxlKGNvcmVf
dm1pZCwgdm1pZCwgcHRiKTsKKworCQlkY19zZXR1cF92bV9jb250ZXh0KGNvcmVfdm1pZC0+ZGMs
ICZ2YV9jb25maWcsIHZtaWQpOworCX0KKworCXJldHVybiB2bWlkOworfQorCit2b2lkIG1vZF92
bWlkX3Jlc2V0KHN0cnVjdCBtb2Rfdm1pZCAqbW9kX3ZtaWQpCit7CisJc3RydWN0IGNvcmVfdm1p
ZCAqY29yZV92bWlkID0gTU9EX1ZNSURfVE9fQ09SRShtb2Rfdm1pZCk7CisKKwljb3JlX3ZtaWQt
Pm51bV92bWlkc19hdmFpbGFibGUgPSBjb3JlX3ZtaWQtPm51bV92bWlkIC0gMTsKKwltZW1zZXQo
Y29yZV92bWlkLT5wdGJfYXNzaWduZWRfdG9fdm1pZCwgMCwgc2l6ZW9mKGNvcmVfdm1pZC0+cHRi
X2Fzc2lnbmVkX3RvX3ZtaWRbMF0pICogTUFYX1ZNSUQpOworfQorCitzdHJ1Y3QgbW9kX3ZtaWQg
Km1vZF92bWlkX2NyZWF0ZSgKKwkJc3RydWN0IGRjICpkYywKKwkJdW5zaWduZWQgaW50IG51bV92
bWlkLAorCQlzdHJ1Y3QgZGNfdmlydHVhbF9hZGRyX3NwYWNlX2NvbmZpZyAqdmFfY29uZmlnKQor
eworCXN0cnVjdCBjb3JlX3ZtaWQgKmNvcmVfdm1pZDsKKworCWlmIChudW1fdm1pZCA8PSAxKQor
CQlnb3RvIGZhaWxfbm9fdm1fY3R4OworCisJaWYgKGRjID09IE5VTEwpCisJCWdvdG8gZmFpbF9k
Y19udWxsOworCisJY29yZV92bWlkID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IGNvcmVfdm1pZCks
IEdGUF9LRVJORUwpOworCisJaWYgKGNvcmVfdm1pZCA9PSBOVUxMKQorCQlnb3RvIGZhaWxfYWxs
b2NfY29udGV4dDsKKworCWNvcmVfdm1pZC0+ZGMgPSBkYzsKKwljb3JlX3ZtaWQtPm51bV92bWlk
ID0gbnVtX3ZtaWQ7CisJY29yZV92bWlkLT5udW1fdm1pZHNfYXZhaWxhYmxlID0gbnVtX3ZtaWQg
LSAxOworCWNvcmVfdm1pZC0+YmFzZV9jb25maWcgPSAqdmFfY29uZmlnOworCisJbWVtc2V0KGNv
cmVfdm1pZC0+cHRiX2Fzc2lnbmVkX3RvX3ZtaWQsIDAsIHNpemVvZihjb3JlX3ZtaWQtPnB0Yl9h
c3NpZ25lZF90b192bWlkWzBdKSAqIE1BWF9WTUlEKTsKKworCXJldHVybiAmY29yZV92bWlkLT5w
dWJsaWM7CisKK2ZhaWxfbm9fdm1fY3R4OgorZmFpbF9hbGxvY19jb250ZXh0OgorZmFpbF9kY19u
dWxsOgorCXJldHVybiBOVUxMOworfQotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2FtZC1nZng=
