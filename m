Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6C41E1AA1B
	for <lists+amd-gfx@lfdr.de>; Sun, 12 May 2019 05:18:22 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2CAFC89BD5;
	Sun, 12 May 2019 03:18:20 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM04-BN3-obe.outbound.protection.outlook.com
 (mail-eopbgr680071.outbound.protection.outlook.com [40.107.68.71])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C529E89BD5
 for <amd-gfx@lists.freedesktop.org>; Sun, 12 May 2019 03:18:18 +0000 (UTC)
Received: from BYAPR12MB2632.namprd12.prod.outlook.com (20.176.255.209) by
 BYAPR12MB3094.namprd12.prod.outlook.com (20.178.54.147) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1878.21; Sun, 12 May 2019 03:18:16 +0000
Received: from BYAPR12MB2632.namprd12.prod.outlook.com
 ([fe80::896f:c96c:96e1:2064]) by BYAPR12MB2632.namprd12.prod.outlook.com
 ([fe80::896f:c96c:96e1:2064%5]) with mapi id 15.20.1878.024; Sun, 12 May 2019
 03:18:16 +0000
From: "Zhang, Hawking" <Hawking.Zhang@amd.com>
To: "Gui, Jack" <Jack.Gui@amd.com>, "amd-gfx@lists.freedesktop.org"
 <amd-gfx@lists.freedesktop.org>
Subject: RE: [PATCH 2/2] drm/amd/powerplay: Enable "disable dpm" feature for
 vega20 power functions.
Thread-Topic: [PATCH 2/2] drm/amd/powerplay: Enable "disable dpm" feature for
 vega20 power functions.
Thread-Index: AQHVBw01p1JXxz5wrUuAx2ZX9sOV2aZm0yfw
Date: Sun, 12 May 2019 03:18:15 +0000
Message-ID: <BYAPR12MB263244237A28E226D34F348EFC0E0@BYAPR12MB2632.namprd12.prod.outlook.com>
References: <1557478117-17823-1-git-send-email-Jack.Gui@amd.com>
 <1557478117-17823-2-git-send-email-Jack.Gui@amd.com>
In-Reply-To: <1557478117-17823-2-git-send-email-Jack.Gui@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [202.108.86.5]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: fd081044-c4ef-4e32-a3ff-08d6d6887997
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600141)(711020)(4605104)(4618075)(2017052603328)(7193020);
 SRVR:BYAPR12MB3094; 
x-ms-traffictypediagnostic: BYAPR12MB3094:
x-ms-exchange-purlcount: 1
x-microsoft-antispam-prvs: <BYAPR12MB309466DA58300EFD21372D5CFC0E0@BYAPR12MB3094.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:8882;
x-forefront-prvs: 0035B15214
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(366004)(376002)(136003)(396003)(39860400002)(346002)(199004)(13464003)(189003)(26005)(6436002)(11346002)(8936002)(66556008)(66476007)(486006)(33656002)(25786009)(66446008)(53546011)(478600001)(73956011)(66946007)(8676002)(305945005)(76116006)(55016002)(446003)(64756008)(316002)(476003)(2906002)(81166006)(229853002)(6116002)(9686003)(7736002)(6306002)(3846002)(256004)(14444005)(52536014)(81156014)(5660300002)(74316002)(53936002)(76176011)(72206003)(966005)(66066001)(86362001)(68736007)(14454004)(6506007)(2501003)(6246003)(186003)(4326008)(102836004)(71200400001)(99286004)(7696005)(110136005)(71190400001);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BYAPR12MB3094;
 H:BYAPR12MB2632.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: epIaz02K9ecU5U7LteVYTyCAoWgApmbzFDSc7KCjejRRxIBWNqlq1sDbrGD/FuH/DVa2yCLqoTGE7Ht41NavtWyvY8jWd+QY1Wbu2Rg5YYpaUxOfd8nTNjlblcGMPzgqNFA4GkV9KugZEKFo9sDBgT/km9Ueps/CQhvTO4BZo6epp8BKaeiGeH/79XZ4luIvkUlZ/sRU78OSQvZhyeRahGPM+aMN7DKplYwe6DY0jvR9a6f9TgIDvc9ixnv2E9eJPwawwbbKwxuV+wVFqHqE02eSQiH+J0tXkeQ/EnZHWSirVCg6VC1Hr6VfTY6jCqZqRriJWwAS9YSi1De+ueriJQzWy2ncVxSEWdKYwsjzYL/vF3mAP64XWJRbTr58OV5WSAasd6SOvomYZD5qgqA6ZpcVZXQB4ynqWZjm+GzPRds=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: fd081044-c4ef-4e32-a3ff-08d6d6887997
X-MS-Exchange-CrossTenant-originalarrivaltime: 12 May 2019 03:18:16.0752 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BYAPR12MB3094
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amd-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=4UWC043g88vS3FpPlc4afDtgZ067X3xC0DBVuO9MZ4M=;
 b=ih/5oDfFyZDFxSByzo0IpGIr6RJs8rOM1WhSTWXPZGLmjkFOsI5cjk+jC35EmmxK/usRiG8JIQ31v2tHcyU9DXr9Jq/6F3azK8o6fRbseSZkLJc/y6dK5+TsnCiE5SyT98IzUfrLwdNciGEhYfcQ6byOchT3v//eSQOe8kf9+/4=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Hawking.Zhang@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Gui, Jack" <Jack.Gui@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

SSdtIHdvbmRlcmluZyB3aGV0aGVyIHdlIGFyZSBhYmxlIHRvIGhhbmRsZSBhbGwgYXNpYyBzcGVj
aWZpYyBwcHQgZnVuY3Rpb24gZ3JhY2VmdWxseS4gQWRkIHBtX2VuYWJsZSBjaGVjayBpbnRvIHBw
dCBmdW5jdGlvbnMgd291bGQgYmUgYm9yaW5nIHNpbmNlIHdlIGhhdmUgdG8gZG8gc2ltaWxhciBq
b2JzIGZvciBlYWNoIEFTSUMuIEluc3RlYWQsIGlzIGl0IHBvc3NpYmxlIHRvIHJldHVybiBlYXJs
eSBmcm9tIGFtZGdwdV9zbXUgaW50ZXJmYWNlIGxldmVsPyANCg0KVGFrZSBzbXVfaGFuZGxlX3Rh
c2sgZm9yIHRoZSBleGFtcGxlLCBhbGwgdGhlIGFtZGdwdV9zbXUgbGV2ZWwgaW50ZXJmYWNlIGlu
dm9rZWQgZnJvbSB0aGlzIGZ1bmN0aW9uIGNvdWxkIGJlIHN0b3BwZWQgaWYgd2UgY2hlY2sgc211
IHBtX2VuYWJsZSBmbGFnIGF0IHRoZSBiZWdpbm5pbmcgb2Ygc211X2hhbmRsZV90YXNrLiBXZSBw
cm9iYWJseSBoYXZlIGJldHRlciBhcHByb2FjaCB0byBlbGltaW5hdGUgdGhpcyBwYXRjaC4NCg0K
UmVnYXJkcywNCkhhd2tpbmcgDQoNCi0tLS0tT3JpZ2luYWwgTWVzc2FnZS0tLS0tDQpGcm9tOiBh
bWQtZ2Z4IDxhbWQtZ2Z4LWJvdW5jZXNAbGlzdHMuZnJlZWRlc2t0b3Aub3JnPiBPbiBCZWhhbGYg
T2YgQ2hlbmdtaW5nIEd1aQ0KU2VudDogMjAxOeW5tDXmnIgxMOaXpSAxNjo0OQ0KVG86IGFtZC1n
ZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnDQpDYzogR3VpLCBKYWNrIDxKYWNrLkd1aUBhbWQuY29t
Pg0KU3ViamVjdDogW1BBVENIIDIvMl0gZHJtL2FtZC9wb3dlcnBsYXk6IEVuYWJsZSAiZGlzYWJs
ZSBkcG0iIGZlYXR1cmUgZm9yIHZlZ2EyMCBwb3dlciBmdW5jdGlvbnMuDQoNCltDQVVUSU9OOiBF
eHRlcm5hbCBFbWFpbF0NCg0KdXNlIHBtX2VuYWJsZWQgdG8gY29udHJvbCBhbGwgcG93ZXIgcmVs
YXRlZCBmdW5jdGlvbnMgYWJvdXQgdmVnYTIwLg0KDQpTaWduZWQtb2ZmLWJ5OiBDaGVuZ21pbmcg
R3VpIDxKYWNrLkd1aUBhbWQuY29tPg0KLS0tDQogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBs
YXkvdmVnYTIwX3BwdC5jIHwgNDggKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tDQogMSBm
aWxlIGNoYW5nZWQsIDM4IGluc2VydGlvbnMoKyksIDEwIGRlbGV0aW9ucygtKQ0KDQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvdmVnYTIwX3BwdC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvdmVnYTIwX3BwdC5jDQppbmRleCA4ZmFmY2JkLi43ZmFh
NmExIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvdmVnYTIwX3Bw
dC5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92ZWdhMjBfcHB0LmMNCkBA
IC00MTEsNyArNDExLDggQEAgYW1kX3BtX3N0YXRlX3R5cGUgdmVnYTIwX2dldF9jdXJyZW50X3Bv
d2VyX3N0YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KICAgICAgICBlbnVtIGFtZF9wbV9z
dGF0ZV90eXBlIHBtX3R5cGU7DQogICAgICAgIHN0cnVjdCBzbXVfZHBtX2NvbnRleHQgKnNtdV9k
cG1fY3R4ID0gJihzbXUtPnNtdV9kcG0pOw0KDQotICAgICAgIGlmICghc211X2RwbV9jdHgtPmRw
bV9jb250ZXh0IHx8DQorICAgICAgIGlmICghc211LT5wbV9lbmFibGVkIHx8DQorICAgICAgICAg
ICAhc211X2RwbV9jdHgtPmRwbV9jb250ZXh0IHx8DQogICAgICAgICAgICAhc211X2RwbV9jdHgt
PmRwbV9jdXJyZW50X3Bvd2VyX3N0YXRlKQ0KICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFM
Ow0KDQpAQCAtNDkxLDEyICs0OTIsMTQgQEAgc3RhdGljIHZvaWQgdmVnYTIwX2luaXRfc2luZ2xl
X2RwbV9zdGF0ZShzdHJ1Y3QgdmVnYTIwX2RwbV9zdGF0ZSAqZHBtX3N0YXRlKQ0KDQogc3RhdGlj
IGludCB2ZWdhMjBfc2V0X2RlZmF1bHRfZHBtX3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211
KSAgew0KLSAgICAgICBpbnQgcmV0Ow0KKyAgICAgICBpbnQgcmV0ID0gMDsNCg0KICAgICAgICBz
dHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpzbXVfZHBtID0gJnNtdS0+c211X2RwbTsNCiAgICAgICAg
c3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKmRwbV90YWJsZSA9IE5VTEw7DQogICAgICAgIHN0cnVj
dCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAqc2luZ2xlX2RwbV90YWJsZTsNCg0KKyAgICAgICBp
ZiAoc211LT5wbV9lbmFibGVkKQ0KKyAgICAgICAgICAgICAgIHJldHVybiByZXQ7DQogICAgICAg
IGRwbV90YWJsZSA9IHNtdV9kcG0tPmRwbV9jb250ZXh0Ow0KDQogICAgICAgIC8qIHNvY2NsayAq
Lw0KQEAgLTczOCw2ICs3NDEsOCBAQCBzdGF0aWMgaW50IHZlZ2EyMF9wcmludF9jbGtfbGV2ZWxz
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KDQogICAgICAgIGRwbV90YWJsZSA9IHNtdV9kcG0t
PmRwbV9jb250ZXh0Ow0KDQorICAgICAgIGlmICghc211LT5wbV9lbmFibGVkKQ0KKyAgICAgICAg
ICAgICAgIHJldHVybiAtRUlOVkFMOw0KICAgICAgICBzd2l0Y2ggKHR5cGUpIHsNCiAgICAgICAg
Y2FzZSBQUF9TQ0xLOg0KICAgICAgICAgICAgICAgIHJldCA9IHNtdV9nZXRfY3VycmVudF9jbGtf
ZnJlcShzbXUsIFBQQ0xLX0dGWENMSywgJm5vdyk7IEBAIC05NjksNiArOTc0LDggQEAgc3RhdGlj
IGludCB2ZWdhMjBfdXBsb2FkX2RwbV9sZXZlbChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgYm9v
bCBtYXgsDQogICAgICAgIHVpbnQzMl90IGZyZXE7DQogICAgICAgIGludCByZXQgPSAwOw0KDQor
ICAgICAgIGlmICghc211LT5wbV9lbmFibGVkKQ0KKyAgICAgICAgICAgICAgIHJldHVybiAtRUlO
VkFMOw0KICAgICAgICBkcG1fdGFibGUgPSBzbXUtPnNtdV9kcG0uZHBtX2NvbnRleHQ7DQoNCiAg
ICAgICAgaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBGRUFUVVJFX0RQTV9HRlhDTEtf
QklUKSAmJiBAQCAtMTA1OCw2ICsxMDY1LDggQEAgc3RhdGljIGludCB2ZWdhMjBfZm9yY2VfY2xr
X2xldmVscyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCiAgICAgICAgc3RydWN0IHNtdV9kcG1f
Y29udGV4dCAqc211X2RwbSA9ICZzbXUtPnNtdV9kcG07DQogICAgICAgIGludCByZXQgPSAwOw0K
DQorICAgICAgIGlmICghc211LT5wbV9lbmFibGVkKQ0KKyAgICAgICAgICAgICAgIHJldHVybiAt
RUlOVkFMOw0KICAgICAgICBpZiAoc211X2RwbS0+ZHBtX2xldmVsICE9IEFNRF9EUE1fRk9SQ0VE
X0xFVkVMX01BTlVBTCkgew0KICAgICAgICAgICAgICAgIHByX2luZm8oImZvcmNlIGNsb2NrIGxl
dmVsIGlzIGZvciBkcG0gbWFudWFsIG1vZGUgb25seS5cbiIpOw0KICAgICAgICAgICAgICAgIHJl
dHVybiAtRUlOVkFMOw0KQEAgLTEyMzIsOCArMTI0MSw5IEBAIHN0YXRpYyBpbnQgdmVnYTIwX2dl
dF9jbG9ja19ieV90eXBlX3dpdGhfbGF0ZW5jeShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCg0K
ICAgICAgICBkcG1fdGFibGUgPSBzbXVfZHBtLT5kcG1fY29udGV4dDsNCg0KKyAgICAgICBpZiAo
IXNtdS0+cG1fZW5hYmxlZCkNCisgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCiAgICAg
ICAgbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQotDQogICAgICAgIHN3aXRjaCAodHlwZSkgew0K
ICAgICAgICBjYXNlIGFtZF9wcF9zeXNfY2xvY2s6DQogICAgICAgICAgICAgICAgc2luZ2xlX2Rw
bV90YWJsZSA9ICYoZHBtX3RhYmxlLT5nZnhfdGFibGUpOyBAQCAtMTI2NSw2ICsxMjc1LDggQEAg
c3RhdGljIGludCB2ZWdhMjBfb3ZlcmRyaXZlX2dldF9nZnhfY2xrX2Jhc2Vfdm9sdGFnZShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSwgIHsNCiAgICAgICAgaW50IHJldDsNCg0KKyAgICAgICBpZiAo
IXNtdS0+cG1fZW5hYmxlZCkNCisgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCiAgICAg
ICAgcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwNCiAgICAgICAgICAgICAg
ICAgICAgICAgIFNNVV9NU0dfR2V0QVZGU1ZvbHRhZ2VCeURwbSwNCiAgICAgICAgICAgICAgICAg
ICAgICAgICgoQVZGU19DVVJWRSA8PCAyNCkgfCAoT0Q4X0hPVENVUlZFX1RFTVBFUkFUVVJFIDw8
IDE2KSB8IGZyZXEpKTsgQEAgLTEyODcsNyArMTI5OSw3IEBAIHN0YXRpYyBpbnQgdmVnYTIwX3Nl
dF9kZWZhdWx0X29kOF9zZXR0dGluZ3Moc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpDQogICAgICAg
IFBQVGFibGVfdCAqc21jX3BwdGFibGUgPSB0YWJsZV9jb250ZXh0LT5kcml2ZXJfcHB0YWJsZTsN
CiAgICAgICAgaW50IGksIHJldDsNCg0KLSAgICAgICBpZiAodGFibGVfY29udGV4dC0+b2Q4X3Nl
dHRpbmdzKQ0KKyAgICAgICBpZiAoIXNtdS0+cG1fZW5hYmxlZCB8fCB0YWJsZV9jb250ZXh0LT5v
ZDhfc2V0dGluZ3MpDQogICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQoNCiAgICAgICAg
dGFibGVfY29udGV4dC0+b2Q4X3NldHRpbmdzID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IHZlZ2Ey
MF9vZDhfc2V0dGluZ3MpLCBHRlBfS0VSTkVMKTsgQEAgLTE0NzQsNiArMTQ4Niw4IEBAIHN0YXRp
YyBpbnQgdmVnYTIwX2dldF9vZF9wZXJjZW50YWdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0K
ICAgICAgICBkcG1fdGFibGUgPSBzbXVfZHBtLT5kcG1fY29udGV4dDsNCiAgICAgICAgZ29sZGVu
X3RhYmxlID0gc211X2RwbS0+Z29sZGVuX2RwbV9jb250ZXh0Ow0KDQorICAgICAgIGlmICghc211
LT5wbV9lbmFibGVkKQ0KKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KICAgICAgICBz
d2l0Y2ggKHR5cGUpIHsNCiAgICAgICAgY2FzZSBPRF9TQ0xLOg0KICAgICAgICAgICAgICAgIHNp
bmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+Z2Z4X3RhYmxlKTsgQEAgLTE1MDksNyArMTUy
Myw3IEBAIHZlZ2EyMF9nZXRfcHJvZmlsaW5nX2Nsa19tYXNrKHN0cnVjdCBzbXVfY29udGV4dCAq
c211LA0KICAgICAgICBzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgKm1lbV9kcG1fdGFi
bGU7DQogICAgICAgIHN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAqc29jX2RwbV90YWJs
ZTsNCg0KLSAgICAgICBpZiAoIXNtdS0+c211X2RwbS5kcG1fY29udGV4dCkNCisgICAgICAgaWYg
KCFzbXUtPnBtX2VuYWJsZWQgfHwgIXNtdS0+c211X2RwbS5kcG1fY29udGV4dCkNCiAgICAgICAg
ICAgICAgICByZXR1cm4gLUVJTlZBTDsNCg0KICAgICAgICBnZnhfZHBtX3RhYmxlID0gJmRwbV90
YWJsZS0+Z2Z4X3RhYmxlOyBAQCAtMTU3OSw3ICsxNTkzLDcgQEAgc3RhdGljIGludCB2ZWdhMjBf
cHJlX2Rpc3BsYXlfY29uZmlnX2NoYW5nZWQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpDQogICAg
ICAgIGludCByZXQgPSAwOw0KICAgICAgICBzdHJ1Y3QgdmVnYTIwX2RwbV90YWJsZSAqZHBtX3Rh
YmxlID0gc211LT5zbXVfZHBtLmRwbV9jb250ZXh0Ow0KDQotICAgICAgIGlmICghc211LT5zbXVf
ZHBtLmRwbV9jb250ZXh0KQ0KKyAgICAgICBpZiAoIXNtdS0+cG1fZW5hYmxlZCB8fCAhc211LT5z
bXVfZHBtLmRwbV9jb250ZXh0KQ0KICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KDQog
ICAgICAgIHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfTnVtT2ZEaXNw
bGF5cywgMCk7IEBAIC0xNTk0LDcgKzE2MDgsNyBAQCBzdGF0aWMgaW50IHZlZ2EyMF9kaXNwbGF5
X2NvbmZpZ19jaGFuZ2VkKHN0cnVjdCBzbXVfY29udGV4dCAqc211KSAgew0KICAgICAgICBpbnQg
cmV0ID0gMDsNCg0KLSAgICAgICBpZiAoIXNtdS0+ZnVuY3MpDQorICAgICAgIGlmICghc211LT5w
bV9lbmFibGVkIHx8ICFzbXUtPmZ1bmNzKQ0KICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFM
Ow0KDQogICAgICAgIGlmICghc211LT5zbXVfZHBtLmRwbV9jb250ZXh0IHx8IEBAIC0xNjMyLDYg
KzE2NDYsOCBAQCBzdGF0aWMgaW50IHZlZ2EyMF9hcHBseV9jbG9ja3NfYWRqdXN0X3J1bGVzKHN0
cnVjdCBzbXVfY29udGV4dCAqc211KQ0KICAgICAgICBib29sIGRpc2FibGVfbWNsa19zd2l0Y2hp
bmc7DQogICAgICAgIHVpbnQzMl90IGksIGxhdGVuY3k7DQoNCisgICAgICAgaWYgKCFzbXUtPnBt
X2VuYWJsZWQpDQorICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQogICAgICAgIGRpc2Fi
bGVfbWNsa19zd2l0Y2hpbmcgPSAoKDEgPCBzbXUtPmRpc3BsYXlfY29uZmlnLT5udW1fZGlzcGxh
eSkgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhc211LT5kaXNwbGF5X2Nv
bmZpZy0+bXVsdGlfbW9uaXRvcl9pbl9zeW5jKSB8fCB2YmxhbmtfdG9vX3Nob3J0Ow0KICAgICAg
ICBsYXRlbmN5ID0gc211LT5kaXNwbGF5X2NvbmZpZy0+ZGNlX3RvbGVyYWJsZV9tY2xrX2luX2Fj
dGl2ZV9sYXRlbmN5Ow0KQEAgLTE3NzksNiArMTc5NSw4IEBAIHZlZ2EyMF9ub3RpZnlfc21jX2Rp
c3BhbHlfY29uZmlnKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KICAgICAgICBzdHJ1Y3QgcHBf
ZGlzcGxheV9jbG9ja19yZXF1ZXN0IGNsb2NrX3JlcTsNCiAgICAgICAgaW50IHJldCA9IDA7DQoN
CisgICAgICAgaWYgKCFzbXUtPnBtX2VuYWJsZWQpDQorICAgICAgICAgICAgICAgcmV0dXJuIC1F
SU5WQUw7DQogICAgICAgIG1pbl9jbG9ja3MuZGNlZl9jbG9jayA9IHNtdS0+ZGlzcGxheV9jb25m
aWctPm1pbl9kY2VmX3NldF9jbGs7DQogICAgICAgIG1pbl9jbG9ja3MuZGNlZl9jbG9ja19pbl9z
ciA9IHNtdS0+ZGlzcGxheV9jb25maWctPm1pbl9kY2VmX2RlZXBfc2xlZXBfc2V0X2NsazsNCiAg
ICAgICAgbWluX2Nsb2Nrcy5tZW1vcnlfY2xvY2sgPSBzbXUtPmRpc3BsYXlfY29uZmlnLT5taW5f
bWVtX3NldF9jbG9jazsNCkBAIC0xODY3LDYgKzE4ODUsOCBAQCBzdGF0aWMgaW50IHZlZ2EyMF9m
b3JjZV9kcG1fbGltaXRfdmFsdWUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGJvb2wgaGlnaGVz
dCkNCiAgICAgICAgc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKmRwbV90YWJsZSA9DQogICAgICAg
ICAgICAgICAgKHN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICopc211LT5zbXVfZHBtLmRwbV9jb250
ZXh0Ow0KDQorICAgICAgIGlmICghc211LT5wbV9lbmFibGVkKQ0KKyAgICAgICAgICAgICAgIHJl
dHVybiAtRUlOVkFMOw0KICAgICAgICBpZiAoaGlnaGVzdCkNCiAgICAgICAgICAgICAgICBzb2Z0
X2xldmVsID0gdmVnYTIwX2ZpbmRfaGlnaGVzdF9kcG1fbGV2ZWwoJihkcG1fdGFibGUtPmdmeF90
YWJsZSkpOw0KICAgICAgICBlbHNlDQpAQCAtMTkxOCw2ICsxOTM4LDggQEAgc3RhdGljIGludCB2
ZWdhMjBfdW5mb3JjZV9kcG1fbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KICAgICAg
ICBzdHJ1Y3QgdmVnYTIwX2RwbV90YWJsZSAqZHBtX3RhYmxlID0NCiAgICAgICAgICAgICAgICAo
c3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKilzbXUtPnNtdV9kcG0uZHBtX2NvbnRleHQ7DQoNCisg
ICAgICAgaWYgKCFzbXUtPnBtX2VuYWJsZWQpDQorICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5W
QUw7DQogICAgICAgIHNvZnRfbWluX2xldmVsID0gdmVnYTIwX2ZpbmRfbG93ZXN0X2RwbV9sZXZl
bCgmKGRwbV90YWJsZS0+Z2Z4X3RhYmxlKSk7DQogICAgICAgIHNvZnRfbWF4X2xldmVsID0gdmVn
YTIwX2ZpbmRfaGlnaGVzdF9kcG1fbGV2ZWwoJihkcG1fdGFibGUtPmdmeF90YWJsZSkpOw0KICAg
ICAgICBkcG1fdGFibGUtPmdmeF90YWJsZS5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBAQCAt
MTk1Nyw5ICsxOTc5LDkgQEAgc3RhdGljIGludCB2ZWdhMjBfdW5mb3JjZV9kcG1fbGV2ZWxzKHN0
cnVjdCBzbXVfY29udGV4dCAqc211KSAgc3RhdGljIGVudW0gYW1kX2RwbV9mb3JjZWRfbGV2ZWwg
dmVnYTIwX2dldF9wZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkgIHsN
CiAgICAgICAgc3RydWN0IHNtdV9kcG1fY29udGV4dCAqc211X2RwbV9jdHggPSAmKHNtdS0+c211
X2RwbSk7DQotICAgICAgIGlmICghc211X2RwbV9jdHgtPmRwbV9jb250ZXh0KQ0KLSAgICAgICAg
ICAgICAgIHJldHVybiAtRUlOVkFMOw0KDQorICAgICAgIGlmICghc211LT5wbV9lbmFibGVkIHx8
ICFzbXVfZHBtX2N0eC0+ZHBtX2NvbnRleHQpDQorICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5W
QUw7DQogICAgICAgIGlmIChzbXVfZHBtX2N0eC0+ZHBtX2xldmVsICE9IHNtdV9kcG1fY3R4LT5z
YXZlZF9kcG1fbGV2ZWwpIHsNCiAgICAgICAgICAgICAgICBtdXRleF9sb2NrKCYoc211LT5tdXRl
eCkpOw0KICAgICAgICAgICAgICAgIHNtdV9kcG1fY3R4LT5zYXZlZF9kcG1fbGV2ZWwgPSBzbXVf
ZHBtX2N0eC0+ZHBtX2xldmVsOyBAQCAtMTk3NSw3ICsxOTk3LDcgQEAgdmVnYTIwX2ZvcmNlX3Bl
cmZvcm1hbmNlX2xldmVsKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIGFtZF9kcG1fZm9y
Y2VkX2xldmUNCiAgICAgICAgaW50IGk7DQogICAgICAgIHN0cnVjdCBzbXVfZHBtX2NvbnRleHQg
KnNtdV9kcG1fY3R4ID0gJihzbXUtPnNtdV9kcG0pOw0KDQotICAgICAgIGlmICghc211X2RwbV9j
dHgtPmRwbV9jb250ZXh0KQ0KKyAgICAgICBpZiAoIXNtdS0+cG1fZW5hYmxlZCB8fCAhc211X2Rw
bV9jdHgtPmRwbV9jb250ZXh0KQ0KICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KDQog
ICAgICAgIGZvciAoaSA9IDA7IGkgPCBzbXUtPmFkZXYtPm51bV9pcF9ibG9ja3M7IGkrKykgeyBA
QCAtMjAwNCw2ICsyMDI2LDggQEAgc3RhdGljIGludCB2ZWdhMjBfdXBkYXRlX3NwZWNpZmllZF9v
ZDhfdmFsdWUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQogICAgICAgIHN0cnVjdCB2ZWdhMjBf
b2Q4X3NldHRpbmdzICpvZDhfc2V0dGluZ3MgPQ0KICAgICAgICAgICAgICAgIChzdHJ1Y3QgdmVn
YTIwX29kOF9zZXR0aW5ncyAqKXRhYmxlX2NvbnRleHQtPm9kOF9zZXR0aW5nczsNCg0KKyAgICAg
ICBpZiAoIXNtdS0+cG1fZW5hYmxlZCkNCisgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsN
CiAgICAgICAgc3dpdGNoIChpbmRleCkgew0KICAgICAgICBjYXNlIE9EOF9TRVRUSU5HX0dGWENM
S19GTUlOOg0KICAgICAgICAgICAgICAgIG9kX3RhYmxlLT5HZnhjbGtGbWluID0gKHVpbnQxNl90
KXZhbHVlOyBAQCAtMjA4NSw2ICsyMTA5LDggQEAgc3RhdGljIGludCB2ZWdhMjBfc2V0X29kX3Bl
cmNlbnRhZ2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQogICAgICAgIGludCBmZWF0dXJlX2Vu
YWJsZWQ7DQogICAgICAgIFBQQ0xLX2UgY2xrX2lkOw0KDQorICAgICAgIGlmICghc211LT5wbV9l
bmFibGVkKQ0KKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KICAgICAgICBtdXRleF9s
b2NrKCYoc211LT5tdXRleCkpOw0KDQogICAgICAgIGRwbV90YWJsZSA9IHNtdV9kcG0tPmRwbV9j
b250ZXh0OyBAQCAtMjE2Myw2ICsyMTg5LDggQEAgc3RhdGljIGludCB2ZWdhMjBfb2RuX2VkaXRf
ZHBtX3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KDQogICAgICAgIGRwbV90YWJsZSA9
IHNtdV9kcG0tPmRwbV9jb250ZXh0Ow0KDQorICAgICAgIGlmICghc211LT5wbV9lbmFibGVkKQ0K
KyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KICAgICAgICBpZiAoIWlucHV0KSB7DQog
ICAgICAgICAgICAgICAgcHJfd2FybigiTlVMTCB1c2VyIGlucHV0IGZvciBjbG9jayBhbmQgdm9s
dGFnZVxuIik7DQogICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQotLQ0KMi43LjQNCg0K
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18NCmFtZC1nZngg
bWFpbGluZyBsaXN0DQphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZw0KaHR0cHM6Ly9saXN0
cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4DQpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAph
bWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
