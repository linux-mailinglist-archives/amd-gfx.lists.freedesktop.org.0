Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7F1A0105CAF
	for <lists+amd-gfx@lfdr.de>; Thu, 21 Nov 2019 23:30:23 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CE0F96EE20;
	Thu, 21 Nov 2019 22:30:21 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wm1-x343.google.com (mail-wm1-x343.google.com
 [IPv6:2a00:1450:4864:20::343])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7303E6EE20
 for <amd-gfx@lists.freedesktop.org>; Thu, 21 Nov 2019 22:30:20 +0000 (UTC)
Received: by mail-wm1-x343.google.com with SMTP id b11so5455340wmb.5
 for <amd-gfx@lists.freedesktop.org>; Thu, 21 Nov 2019 14:30:20 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=r9WYEIFUFqhpKgXdC6BIS4+4OUl4K4GfZUHdLOV8epA=;
 b=Q7PV5J399v/yFKDjWC2GPa0//1HvajtXFdyBdHvCyB6bI+BjOqj6kwOd7ZeqI7+AV4
 Q3HmOjfFulJiIWsmw+FVr3rNJCczMCEnX/KLf16fhFG07pODcKuncJqP9R7PBqHIKWXB
 72kw6Pfq5FLE/rEzaAWpcbdHhI/RexzrMP8BrzNguYGVLo7PPw9jczUhQtikcKDE43rC
 vMviJpB3uPFX8IkRJIVNx23P7OCHOVr7xghLjw+5N89KP8uYJYkvObPWOt/1Mb/Mbj2u
 ARj6u0SKyu0P3F4pVysvb5sc6MwUg1fDjtZf+emq0+m600MKGDLEaPHmL69IUpxAL7eU
 Scmw==
X-Gm-Message-State: APjAAAXfrq6PCEikJipKYhKKjHVw9l3jucWaQsZWWUdCGRcEn2adSwEa
 wwKT76iLArfFQrfJ3cltHPupGE/YBnii9jkB8ac=
X-Google-Smtp-Source: APXvYqxeoGi12/e2npFGqxMntencBFAwhu/H988TBENrcCGgHxaZW3i/F+lkE/15VRtoEz3JNTux5X85Krv8xUup4Qs=
X-Received: by 2002:a1c:1b86:: with SMTP id
 b128mr13441875wmb.127.1574375418868; 
 Thu, 21 Nov 2019 14:30:18 -0800 (PST)
MIME-Version: 1.0
References: <20191121165529.3941-1-alexander.deucher@amd.com>
 <CAPM=9twAwCJaXHS=cWNCihsyfydAKqQ1igjLt1g_vbFBL0bdMg@mail.gmail.com>
 <CADnq5_N5GFf2kHANxBHn_Pn3=XZ=XcfgociQaDxp7zd0Hewjkw@mail.gmail.com>
 <CAPM=9txC5CZdQ8WY5RqOJNr7n+jqZ-ge1YeZxvME-Qdn_rREow@mail.gmail.com>
In-Reply-To: <CAPM=9txC5CZdQ8WY5RqOJNr7n+jqZ-ge1YeZxvME-Qdn_rREow@mail.gmail.com>
From: Alex Deucher <alexdeucher@gmail.com>
Date: Thu, 21 Nov 2019 17:30:07 -0500
Message-ID: <CADnq5_Mo1Rpy3A61zT-+3rUA4vNVf4O4Xy_3BwN=Jj0ZV-emQA@mail.gmail.com>
Subject: Re: [PATCH] drm/amdgpu: move pci handling out of pm ops
To: Dave Airlie <airlied@gmail.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=r9WYEIFUFqhpKgXdC6BIS4+4OUl4K4GfZUHdLOV8epA=;
 b=q1BuAmmDIT/YeUXc00Qy4oeG4lTbvZyHOzLVEZWwcvKsGdEsPIAwXW1RRRqC12koZr
 7yCrir4WdZXb7MEYi5pHQm+l8OwkNXk/7BdWAz0zt7k2ZdUGRPUo7MiLpgCLqYuxijIO
 bXkgXhe+QIu+5ZCvhhpwWLcvGdi6BGjRVJr1eLRtpRg5Pz5Z358aWRif+bgJLDEwdq/e
 Osz0wzmdSeDfFlNE8FmnkYrclFSp5/QZ9PMqVYafuEbyAy4Ki68MtYZ9TV1z7DSWPMev
 OFj00ABYMYuwO99cQEEfvREJNwud0to6SzhyYX1vI81z3P+MWvVznNID/MelvFJAIpOJ
 UYKw==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>,
 amd-gfx mailing list <amd-gfx@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

T24gVGh1LCBOb3YgMjEsIDIwMTkgYXQgNToxMyBQTSBEYXZlIEFpcmxpZSA8YWlybGllZEBnbWFp
bC5jb20+IHdyb3RlOgo+Cj4gT24gRnJpLCAyMiBOb3YgMjAxOSBhdCAwNjowNSwgQWxleCBEZXVj
aGVyIDxhbGV4ZGV1Y2hlckBnbWFpbC5jb20+IHdyb3RlOgo+ID4KPiA+IE9uIFRodSwgTm92IDIx
LCAyMDE5IGF0IDI6NTMgUE0gRGF2ZSBBaXJsaWUgPGFpcmxpZWRAZ21haWwuY29tPiB3cm90ZToK
PiA+ID4KPiA+ID4gT24gRnJpLCAyMiBOb3YgMjAxOSBhdCAwMjo1NSwgQWxleCBEZXVjaGVyIDxh
bGV4ZGV1Y2hlckBnbWFpbC5jb20+IHdyb3RlOgo+ID4gPiA+Cj4gPiA+ID4gVGhlIGRvY3VtZW50
YXRpb24gc2F5cyB0aGUgdGhhdCBQQ0kgY29yZSBoYW5kbGVzIHRoaXMKPiA+ID4gPiBmb3IgeW91
IHVubGVzcyB5b3UgY2hvb3NlIHRvIGltcGxlbWVudCBpdC4gIEp1c3QgcmVseQo+ID4gPiA+IG9u
IHRoZSBQQ0kgY29yZSB0byBoYW5kbGUgdGhlIHBjaSBzcGVjaWZpYyBiaXRzLgo+ID4gPiA+Cj4g
PiA+ID4gU2lnbmVkLW9mZi1ieTogQWxleCBEZXVjaGVyIDxhbGV4YW5kZXIuZGV1Y2hlckBhbWQu
Y29tPgo+ID4gPiA+IC0tLQo+ID4gPiA+ICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHUuaCAgICAgICAgfCAgNCArLS0KPiA+ID4gPiAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2RldmljZS5jIHwgMzMgKysrKysrKysrLS0tLS0tLS0tLS0tLQo+ID4gPiA+ICBkcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHJ2LmMgICAgfCAxNiArKysrKy0tLS0tLQo+
ID4gPiA+ICAzIGZpbGVzIGNoYW5nZWQsIDI0IGluc2VydGlvbnMoKyksIDI5IGRlbGV0aW9ucygt
KQo+ID4gPiA+Cj4gPiA+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1LmgKPiA+ID4gPiBp
bmRleCA5Nzg0MzQ2MmMyZmIuLjJlOWQwYmUwNWYyZiAxMDA2NDQKPiA+ID4gPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaAo+ID4gPiA+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5oCj4gPiA+ID4gQEAgLTExOTEsOCArMTE5MSw4IEBAIGlu
dCBhbWRncHVfZHJpdmVyX29wZW5fa21zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBk
cm1fZmlsZSAqZmlsZV9wcml2KTsKPiA+ID4gPiAgdm9pZCBhbWRncHVfZHJpdmVyX3Bvc3RjbG9z
ZV9rbXMoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiA+ID4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdik7Cj4gPiA+ID4gIGludCBh
bWRncHVfZGV2aWNlX2lwX3N1c3BlbmQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpOwo+ID4g
PiA+IC1pbnQgYW1kZ3B1X2RldmljZV9zdXNwZW5kKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGJv
b2wgc3VzcGVuZCwgYm9vbCBmYmNvbik7Cj4gPiA+ID4gLWludCBhbWRncHVfZGV2aWNlX3Jlc3Vt
ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBib29sIHJlc3VtZSwgYm9vbCBmYmNvbik7Cj4gPiA+
ID4gK2ludCBhbWRncHVfZGV2aWNlX3N1c3BlbmQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgYm9v
bCBmYmNvbik7Cj4gPiA+ID4gK2ludCBhbWRncHVfZGV2aWNlX3Jlc3VtZShzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCBib29sIGZiY29uKTsKPiA+ID4gPiAgdTMyIGFtZGdwdV9nZXRfdmJsYW5rX2Nv
dW50ZXJfa21zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKTsKPiA+
ID4gPiAgaW50IGFtZGdwdV9lbmFibGVfdmJsYW5rX2ttcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB1bnNpZ25lZCBpbnQgcGlwZSk7Cj4gPiA+ID4gIHZvaWQgYW1kZ3B1X2Rpc2FibGVfdmJsYW5r
X2ttcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSk7Cj4gPiA+ID4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYwo+ID4gPiA+IGluZGV4
IGIxNDA4YzVlNDY0MC4uZDgzMmJkMjJiYTlkIDEwMDY0NAo+ID4gPiA+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYwo+ID4gPiA+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYwo+ID4gPiA+IEBAIC0xMDkwLDYgKzEw
OTAsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV9kZXZpY2VfY2hlY2tfYXJndW1lbnRzKHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2KQo+ID4gPiA+ICBzdGF0aWMgdm9pZCBhbWRncHVfc3dpdGNoZXJv
b19zZXRfc3RhdGUoc3RydWN0IHBjaV9kZXYgKnBkZXYsIGVudW0gdmdhX3N3aXRjaGVyb29fc3Rh
dGUgc3RhdGUpCj4gPiA+ID4gIHsKPiA+ID4gPiAgICAgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSBwY2lfZ2V0X2RydmRhdGEocGRldik7Cj4gPiA+ID4gKyAgICAgICBpbnQgcjsKPiA+ID4g
Pgo+ID4gPiA+ICAgICAgICAgaWYgKGFtZGdwdV9kZXZpY2Vfc3VwcG9ydHNfYm9jbyhkZXYpICYm
IHN0YXRlID09IFZHQV9TV0lUQ0hFUk9PX09GRikKPiA+ID4gPiAgICAgICAgICAgICAgICAgcmV0
dXJuOwo+ID4gPiA+IEBAIC0xMDk5LDcgKzExMDAsMTIgQEAgc3RhdGljIHZvaWQgYW1kZ3B1X3N3
aXRjaGVyb29fc2V0X3N0YXRlKHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBlbnVtIHZnYV9zd2l0Y2hl
cm8KPiA+ID4gPiAgICAgICAgICAgICAgICAgLyogZG9uJ3Qgc3VzcGVuZCBvciByZXN1bWUgY2Fy
ZCBub3JtYWxseSAqLwo+ID4gPiA+ICAgICAgICAgICAgICAgICBkZXYtPnN3aXRjaF9wb3dlcl9z
dGF0ZSA9IERSTV9TV0lUQ0hfUE9XRVJfQ0hBTkdJTkc7Cj4gPiA+ID4KPiA+ID4gPiAtICAgICAg
ICAgICAgICAgYW1kZ3B1X2RldmljZV9yZXN1bWUoZGV2LCB0cnVlLCB0cnVlKTsKPiA+ID4gPiAr
ICAgICAgICAgICAgICAgcGNpX3NldF9wb3dlcl9zdGF0ZShkZXYtPnBkZXYsIFBDSV9EMCk7Cj4g
PiA+ID4gKyAgICAgICAgICAgICAgIHBjaV9yZXN0b3JlX3N0YXRlKGRldi0+cGRldik7Cj4gPiA+
ID4gKyAgICAgICAgICAgICAgIHIgPSBwY2lfZW5hYmxlX2RldmljZShkZXYtPnBkZXYpOwo+ID4g
PiA+ICsgICAgICAgICAgICAgICBpZiAocikKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICBEUk1fV0FSTigicGNpX2VuYWJsZV9kZXZpY2UgZmFpbGVkICglZClcbiIsIHIpOwo+ID4gPiA+
ICsgICAgICAgICAgICAgICBhbWRncHVfZGV2aWNlX3Jlc3VtZShkZXYsIHRydWUpOwo+ID4gPiA+
Cj4gPiA+ID4gICAgICAgICAgICAgICAgIGRldi0+c3dpdGNoX3Bvd2VyX3N0YXRlID0gRFJNX1NX
SVRDSF9QT1dFUl9PTjsKPiA+ID4gPiAgICAgICAgICAgICAgICAgZHJtX2ttc19oZWxwZXJfcG9s
bF9lbmFibGUoZGV2KTsKPiA+ID4gPiBAQCAtMTEwNyw3ICsxMTEzLDExIEBAIHN0YXRpYyB2b2lk
IGFtZGdwdV9zd2l0Y2hlcm9vX3NldF9zdGF0ZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgZW51bSB2
Z2Ffc3dpdGNoZXJvCj4gPiA+ID4gICAgICAgICAgICAgICAgIHByX2luZm8oImFtZGdwdTogc3dp
dGNoZWQgb2ZmXG4iKTsKPiA+ID4gPiAgICAgICAgICAgICAgICAgZHJtX2ttc19oZWxwZXJfcG9s
bF9kaXNhYmxlKGRldik7Cj4gPiA+ID4gICAgICAgICAgICAgICAgIGRldi0+c3dpdGNoX3Bvd2Vy
X3N0YXRlID0gRFJNX1NXSVRDSF9QT1dFUl9DSEFOR0lORzsKPiA+ID4gPiAtICAgICAgICAgICAg
ICAgYW1kZ3B1X2RldmljZV9zdXNwZW5kKGRldiwgdHJ1ZSwgdHJ1ZSk7Cj4gPiA+ID4gKyAgICAg
ICAgICAgICAgIGFtZGdwdV9kZXZpY2Vfc3VzcGVuZChkZXYsIHRydWUpOwo+ID4gPiA+ICsgICAg
ICAgICAgICAgICBwY2lfc2F2ZV9zdGF0ZShkZXYtPnBkZXYpOwo+ID4gPiA+ICsgICAgICAgICAg
ICAgICAvKiBTaHV0IGRvd24gdGhlIGRldmljZSAqLwo+ID4gPiA+ICsgICAgICAgICAgICAgICBw
Y2lfZGlzYWJsZV9kZXZpY2UoZGV2LT5wZGV2KTsKPiA+ID4gPiArICAgICAgICAgICAgICAgcGNp
X3NldF9wb3dlcl9zdGF0ZShkZXYtPnBkZXYsIFBDSV9EM2NvbGQpOwo+ID4gPgo+ID4gPgo+ID4g
PiBJIHRoaW5rIHRoaXMgd2lsbCBicmVhayBEMyBjb2xkIG9uIEFUUFggc3lzdGVtcyAoaS5lLiBi
ZWZvcmUgUENJRSBkMwo+ID4gPiBjb2xkIHN1cHBvcnQpLgo+ID4gPgo+ID4gPiBJJ20gbm90IDEw
MCUgc3VyZSBidXQgSSdkIHJlYWxseSBsaWtlIHRvIHRlc3QgaXQsIGFzIEkgZG9uJ3QgdGhpbmsg
dGhlCj4gPiA+IGNvcmUgd2lsbCBwdXQgdGhlIGRldmljZSBpbnRvIEQzY29sZCBmb3IgdXMgaGVy
ZS4KPiA+Cj4gPiBTaG91bGQgYmUgdGhlIHNhbWUgYXMgYmVmb3JlLCBJIGp1c3QgbW92ZWQgdGhl
IHBjaSBmdW5jcyB1cCBmcm9tIHRoZQo+ID4gY2FsbGVlIGludG8gdGhlIGNhbGxlciwgb3IgYXJl
IHlvdSB0YWxraW5nIGFib3V0IHRoZSBzd2l0Y2ggZnJvbSBkM2hvdAo+ID4gdG8gZDNjb2xkPyAg
SSBjYW4gbWFrZSB0aGUgaG90L2NvbGQgY2hhbmdlIGEgc2VwYXJhdGUgY29tbWl0IGhvd2V2ZXIu
Cj4gPiBUaGF0IHNhaWQsIGl0IGRvZXNuJ3QgcmVhbGx5IG1hdHRlciB3aGF0IGQzIHN0YXRlIHdl
IGNob29zZSBoZXJlLiAgVGhlCj4gPiBBUFRYIGNhbGwgY3V0cyB0aGUgcG93ZXIgcmFpbCBhbnl3
YXkgKGVmZmVjdGl2ZWx5IGQzY29sZCkuCj4KPiBJdCBtYXR0ZXJzIHRvIHRoZSBPUywgYXMgaXQg
aGFzIHRvIGJyaW5nIHRoZSBkZXZpY2Ugb3V0IG9mIGNvbGQgZm9yCj4gY2VydGFpbiBvcGVyYXRp
b25zIHRoYXQgd29yayBpbiBob3QgKGxpa2UgY29uaWZnIHNwYWNlIGFjY2VzcykuCgpXZWxsLCBp
biB0aGF0IGNhc2UsIGQzY29sZCBiZXR0ZXIgbWF0Y2hlcyB3aGF0IGFjdHVhbGx5IGhhcHBlbnMu
Ck5vdGhpbmcgY2FuIGFjY2VzcyB0aGUgZGV2aWNlIHVudGlsIGl0J3MgcG93ZXJlZCBiYWNrIHVw
IHZpYSBBVFBYLgoKPgo+IEJ1dCBzb3JyeSBJIG1pc3JlYWQgdGhlIHBhdGNoIEkgdGhvdWdodCB5
b3Ugd2VyZSBkcm9wcGluZyB0aGUgY2FsbHMgaW4KPiBmYXZvdXIgb2YgdGhlIHBjaSBjb3JlIGRv
aW5nIHRoZW0uCgpObyBwcm9ibGVtLgoKQWxleAoKPgo+IERhdmUuCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1n
ZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
