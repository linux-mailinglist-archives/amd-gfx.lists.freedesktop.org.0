Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BBCB9A0ADA
	for <lists+amd-gfx@lfdr.de>; Wed, 28 Aug 2019 21:56:53 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3F57389ECB;
	Wed, 28 Aug 2019 19:56:52 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qk1-x734.google.com (mail-qk1-x734.google.com
 [IPv6:2607:f8b0:4864:20::734])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B75EB89EB8
 for <amd-gfx@lists.freedesktop.org>; Wed, 28 Aug 2019 19:56:48 +0000 (UTC)
Received: by mail-qk1-x734.google.com with SMTP id u190so888912qkh.5
 for <amd-gfx@lists.freedesktop.org>; Wed, 28 Aug 2019 12:56:48 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=5HJn1oGAijcTSz6rJRouNbF+W5qA2gTIyuRHFUD3WRo=;
 b=FDEnoBdp8+mi2cpjrAOXBKCmYXJed4wQDHgbjbwQB4k5Lxdhdi5VP/+a43qxJoDT/R
 rKxnNJBQ+IMj7F37d/K3KDxta1SCcYmxV3CZq33fmlZs0wrnRR8oPfG23xDUKcynA++l
 A2i7+qmN646xkJ7h+u1w4DFjjhRi56H99nJ+hblGNng3V1P4/1PcafLB7siBdL45zHvN
 pgjoI+h9So7GtzfYAglelGELwQW2J2Utmbcg05hb6o6zE2xGUVDoNmbS4ZK6tr6uAyOP
 95z4wQnuKRzbEkBrT9WdSkfAqNsW5EV7dUilLGAS7obSMkcFDYyN7l8fn4QBiEDY01OW
 672w==
X-Gm-Message-State: APjAAAVsCYzAAJ93wMfBg+HNstdAf8Cx+yEtOFY58CiPTl1Qme8WSIdl
 qknmjyamMzsc7O4PVEulh+m5ehdp
X-Google-Smtp-Source: APXvYqwOjYwae00q0GOZglvVsJvAgjVliRnPWPC7WS6FUU7IFyG64PsnbnHwLE1V+OTKp75Z+O79CQ==
X-Received: by 2002:a37:a702:: with SMTP id q2mr5954260qke.213.1567022205918; 
 Wed, 28 Aug 2019 12:56:45 -0700 (PDT)
Received: from localhost.localdomain ([71.219.73.178])
 by smtp.gmail.com with ESMTPSA id s58sm136578qth.59.2019.08.28.12.56.42
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 28 Aug 2019 12:56:44 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 12/23] drm/amd/display: Add Renoir DML
Date: Wed, 28 Aug 2019 14:56:11 -0500
Message-Id: <20190828195622.28941-12-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190828195622.28941-1-alexander.deucher@amd.com>
References: <20190828195622.28941-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=5HJn1oGAijcTSz6rJRouNbF+W5qA2gTIyuRHFUD3WRo=;
 b=ZH3SJJSwiC1SHKwmc2XlDerTcoO10mlReIgEtowDz4KNK+ESa9WpMeYxoxMp7qkfNH
 jutSJWxEaNGJnYSiym2zwEc7JbkJEXy7hZAVjOXGLmKjB8G8uK4T6N8qU8+tVJAEjeUr
 kOwIlYl8gt6MigrZW4Qp0l/+4rs61h5vO2Dfn/Cxkkq32i/Nxhgg66njxWvudznGLcqO
 kjx94GqmeJRSmt0f7C7cSqlkt8qys7UmU+3dUwXXHRZAowzNlV7AJiLrl0P4TGOAA6r5
 cQcAKbL4L6ctcv/f/oORWG5uTyw7OKt+3MCxAWCLdl+8lMA5TA6aJwsHrSQkAQvQFomu
 NpVQ==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>,
 Bhawanpreet Lakha <Bhawanpreet.Lakha@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogQmhhd2FucHJlZXQgTGFraGEgPEJoYXdhbnByZWV0Lkxha2hhQGFtZC5jb20+CgpETUwg
cHJvdmlkZXMgdGhlIGRpc3BsYXkgY29uZmlndXJhdGlvbiB2YWxpZGF0aW9uIGFzIHByb3ZpZGVk
CmJ5IHRoZSBodyB0ZWFtcy4KClNpZ25lZC1vZmYtYnk6IEJoYXdhbnByZWV0IExha2hhIDxCaGF3
YW5wcmVldC5MYWtoYUBhbWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBBbGV4IERldWNoZXIgPGFsZXhh
bmRlci5kZXVjaGVyQGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2Rj
L2RtbC9NYWtlZmlsZSAgIHwgICAgNCArCiAuLi4vZGMvZG1sL2RjbjIxL2Rpc3BsYXlfbW9kZV92
YmFfMjEuYyAgICAgICAgfCA2MTIzICsrKysrKysrKysrKysrKysrCiAuLi4vZGMvZG1sL2RjbjIx
L2Rpc3BsYXlfbW9kZV92YmFfMjEuaCAgICAgICAgfCAgIDMyICsKIC4uLi9kYy9kbWwvZGNuMjEv
ZGlzcGxheV9ycV9kbGdfY2FsY18yMS5jICAgICB8IDE4MjMgKysrKysKIC4uLi9kYy9kbWwvZGNu
MjEvZGlzcGxheV9ycV9kbGdfY2FsY18yMS5oICAgICB8ICAgNzMgKwogLi4uL2RybS9hbWQvZGlz
cGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5oIHwgICAgMyArCiA2IGZpbGVzIGNoYW5nZWQs
IDgwNTggaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9kbWwvZGNuMjEvZGlzcGxheV9tb2RlX3ZiYV8yMS5jCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24yMS9kaXNwbGF5
X21vZGVfdmJhXzIxLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvZG1sL2RjbjIxL2Rpc3BsYXlfcnFfZGxnX2NhbGNfMjEuYwogY3JlYXRlIG1vZGUg
MTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGNuMjEvZGlzcGxheV9y
cV9kbGdfY2FsY18yMS5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2RtbC9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvTWFr
ZWZpbGUKaW5kZXggOTVmZDJiZWNhODBjLi5iMjY3YzBmYzY0ZTcgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9NYWtlZmlsZQpAQCAtNDUsNiArNDUsMTAgQEAgQ0ZMQUdT
X2Rpc3BsYXlfcnFfZGxnX2NhbGNfMjAubyA6PSAkKGRtbF9jY2ZsYWdzKQogQ0ZMQUdTX2Rpc3Bs
YXlfbW9kZV92YmFfMjB2Mi5vIDo9ICQoZG1sX2NjZmxhZ3MpCiBDRkxBR1NfZGlzcGxheV9ycV9k
bGdfY2FsY18yMHYyLm8gOj0gJChkbWxfY2NmbGFncykKIGVuZGlmCitpZmRlZiBDT05GSUdfRFJN
X0FNRF9EQ19EQ04yXzEKK0NGTEFHU19kaXNwbGF5X21vZGVfdmJhXzIxLm8gOj0gJChkbWxfY2Nm
bGFncykKK0NGTEFHU19kaXNwbGF5X3JxX2RsZ19jYWxjXzIxLm8gOj0gJChkbWxfY2NmbGFncykK
K2VuZGlmCiBpZmRlZiBDT05GSUdfRFJNX0FNRF9EQ04zQUcKIENGTEFHU19kaXNwbGF5X21vZGVf
dmJhXzNhZy5vIDo9ICQoZG1sX2NjZmxhZ3MpCiBlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24yMS9kaXNwbGF5X21vZGVfdmJhXzIxLmMgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2RjbjIxL2Rpc3BsYXlfbW9kZV92YmFf
MjEuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjQ1NmNkMGUzMjg5
YwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwv
ZGNuMjEvZGlzcGxheV9tb2RlX3ZiYV8yMS5jCkBAIC0wLDAgKzEsNjEyMyBAQAorLyoKKyAqIENv
cHlyaWdodCAyMDE3IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KKyAqCisgKiBQZXJtaXNz
aW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRh
aW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50
YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJl
IHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAqIHRo
ZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRl
LCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5k
IHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQg
dG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAqIFRo
ZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxs
IGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9m
IHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwg
V0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwgSU5D
TFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJ
VFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VN
RU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9SIEFV
VEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgorICogT1RIRVIgTElB
QklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJ
U0UsCisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNP
RlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4K
KyAqCisgKiBBdXRob3JzOiBBTUQKKyAqCisgKi8KKworI2lmZGVmIENPTkZJR19EUk1fQU1EX0RD
X0RDTjJfMAorCisjaW5jbHVkZSAiLi4vZGlzcGxheV9tb2RlX2xpYi5oIgorI2luY2x1ZGUgIi4u
L2RtbF9pbmxpbmVfZGVmcy5oIgorI2luY2x1ZGUgIi4uL2Rpc3BsYXlfbW9kZV92YmEuaCIKKyNp
bmNsdWRlICJkaXNwbGF5X21vZGVfdmJhXzIxLmgiCisKKworLyoKKyAqIE5PVEU6CisgKiAgIFRo
aXMgZmlsZSBpcyBnY2MtcGFyc2FibGUgSFcgZ29zcGVsLCBjb21pbmcgc3RyYWlnaHQgZnJvbSBI
VyBlbmdpbmVlcnMuCisgKgorICogSXQgZG9lc24ndCBhZGhlcmUgdG8gTGludXgga2VybmVsIHN0
eWxlIGFuZCBzb21ldGltZXMgd2lsbCBkbyB0aGluZ3MgaW4gb2RkCisgKiB3YXlzLiBVbmxlc3Mg
dGhlcmUgaXMgc29tZXRoaW5nIGNsZWFybHkgd3Jvbmcgd2l0aCBpdCB0aGUgY29kZSBzaG91bGQK
KyAqIHJlbWFpbiBhcy1pcyBhcyBpdCBwcm92aWRlcyB1cyB3aXRoIGEgZ3VhcmFudGVlIGZyb20g
SFcgdGhhdCBpdCBpcyBjb3JyZWN0LgorICovCisKK3R5cGVkZWYgdW5zaWduZWQgaW50IHVpbnQ7
CisKK3R5cGVkZWYgc3RydWN0IHsKKwlkb3VibGUgRFBQQ0xLOworCWRvdWJsZSBESVNQQ0xLOwor
CWRvdWJsZSBQaXhlbENsb2NrOworCWRvdWJsZSBEQ0ZDTEtEZWVwU2xlZXA7CisJdW5zaWduZWQg
aW50IERQUFBlclBsYW5lOworCWJvb2wgU2NhbGVyRW5hYmxlZDsKKwllbnVtIHNjYW5fZGlyZWN0
aW9uX2NsYXNzIFNvdXJjZVNjYW47CisJdW5zaWduZWQgaW50IEJsb2NrV2lkdGgyNTZCeXRlc1k7
CisJdW5zaWduZWQgaW50IEJsb2NrSGVpZ2h0MjU2Qnl0ZXNZOworCXVuc2lnbmVkIGludCBCbG9j
a1dpZHRoMjU2Qnl0ZXNDOworCXVuc2lnbmVkIGludCBCbG9ja0hlaWdodDI1NkJ5dGVzQzsKKwl1
bnNpZ25lZCBpbnQgSW50ZXJsYWNlRW5hYmxlOworCXVuc2lnbmVkIGludCBOdW1iZXJPZkN1cnNv
cnM7CisJdW5zaWduZWQgaW50IFZCbGFuazsKKwl1bnNpZ25lZCBpbnQgSFRvdGFsOworfSBQaXBl
OworCit0eXBlZGVmIHN0cnVjdCB7CisJYm9vbCBFbmFibGU7CisJdW5zaWduZWQgaW50IE1heFBh
Z2VUYWJsZUxldmVsczsKKwl1bnNpZ25lZCBpbnQgQ2FjaGVkUGFnZVRhYmxlTGV2ZWxzOworfSBI
b3N0Vk07CisKKyNkZWZpbmUgQlBQX0lOVkFMSUQgMAorI2RlZmluZSBCUFBfQkxFTkRFRF9QSVBF
IDB4ZmZmZmZmZmYKKworc3RhdGljIHZvaWQgRGlzcGxheVBpcGVDb25maWd1cmF0aW9uKHN0cnVj
dCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYik7CitzdGF0aWMgdm9pZCBESVNQQ0xLRFBQQ0xL
RENGQ0xLRGVlcFNsZWVwUHJlZmV0Y2hQYXJhbWV0ZXJzV2F0ZXJtYXJrc0FuZFBlcmZvcm1hbmNl
Q2FsY3VsYXRpb24oCisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYik7CitzdGF0
aWMgdW5zaWduZWQgaW50IGRzY2NlQ29tcHV0ZURlbGF5KAorCQl1bnNpZ25lZCBpbnQgYnBjLAor
CQlkb3VibGUgYnBwLAorCQl1bnNpZ25lZCBpbnQgc2xpY2VXaWR0aCwKKwkJdW5zaWduZWQgaW50
IG51bVNsaWNlcywKKwkJZW51bSBvdXRwdXRfZm9ybWF0X2NsYXNzIHBpeGVsRm9ybWF0KTsKK3N0
YXRpYyB1bnNpZ25lZCBpbnQgZHNjQ29tcHV0ZURlbGF5KGVudW0gb3V0cHV0X2Zvcm1hdF9jbGFz
cyBwaXhlbEZvcm1hdCk7CisvLyBTdXBlciBtb25zdGVyIGZ1bmN0aW9uIHdpdGggc29tZSA0NSBh
cmd1bWVudAorc3RhdGljIGJvb2wgQ2FsY3VsYXRlUHJlZmV0Y2hTY2hlZHVsZSgKKwkJc3RydWN0
IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgUGVyY2VudE9mSWRlYWxEUkFN
RmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRlclVyZ0xhdGVuY3lQaXhlbE1peGVkV2l0aFZN
RGF0YSwKKwkJZG91YmxlIFBlcmNlbnRPZklkZWFsRFJBTUZhYnJpY0FuZFNEUFBvcnRCV1JlY2Vp
dmVkQWZ0ZXJVcmdMYXRlbmN5Vk1EYXRhT25seSwKKwkJUGlwZSAqbXlQaXBlLAorCQl1bnNpZ25l
ZCBpbnQgRFNDRGVsYXksCisJCWRvdWJsZSBEUFBDTEtEZWxheVN1YnRvdGFsLAorCQlkb3VibGUg
RFBQQ0xLRGVsYXlTQ0wsCisJCWRvdWJsZSBEUFBDTEtEZWxheVNDTExCT25seSwKKwkJZG91Ymxl
IERQUENMS0RlbGF5Q05WQ0Zvcm1hdGVyLAorCQlkb3VibGUgRFBQQ0xLRGVsYXlDTlZDQ3Vyc29y
LAorCQlkb3VibGUgRElTUENMS0RlbGF5U3VidG90YWwsCisJCXVuc2lnbmVkIGludCBTY2FsZXJS
ZWNvdXRXaWR0aCwKKwkJZW51bSBvdXRwdXRfZm9ybWF0X2NsYXNzIE91dHB1dEZvcm1hdCwKKwkJ
dW5zaWduZWQgaW50IE1heEludGVyRENOVGlsZVJlcGVhdGVycywKKwkJdW5zaWduZWQgaW50IFZT
dGFydHVwLAorCQl1bnNpZ25lZCBpbnQgTWF4VlN0YXJ0dXAsCisJCXVuc2lnbmVkIGludCBHUFVW
TVBhZ2VUYWJsZUxldmVscywKKwkJYm9vbCBHUFVWTUVuYWJsZSwKKwkJSG9zdFZNICpteUhvc3RW
TSwKKwkJYm9vbCBEeW5hbWljTWV0YWRhdGFFbmFibGUsCisJCWludCBEeW5hbWljTWV0YWRhdGFM
aW5lc0JlZm9yZUFjdGl2ZVJlcXVpcmVkLAorCQl1bnNpZ25lZCBpbnQgRHluYW1pY01ldGFkYXRh
VHJhbnNtaXR0ZWRCeXRlcywKKwkJYm9vbCBEQ0NFbmFibGUsCisJCWRvdWJsZSBVcmdlbnRMYXRl
bmN5LAorCQlkb3VibGUgVXJnZW50RXh0cmFMYXRlbmN5LAorCQlkb3VibGUgVENhbGMsCisJCXVu
c2lnbmVkIGludCBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZSwKKwkJdW5zaWduZWQgaW50IE1ldGFS
b3dCeXRlLAorCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVCeXRlc1BlclJvdywKKwkJZG91YmxlIFBy
ZWZldGNoU291cmNlTGluZXNZLAorCQl1bnNpZ25lZCBpbnQgU3dhdGhXaWR0aFksCisJCWRvdWJs
ZSBCeXRlUGVyUGl4ZWxERVRZLAorCQlkb3VibGUgVkluaXRQcmVGaWxsWSwKKwkJdW5zaWduZWQg
aW50IE1heE51bVN3YXRoWSwKKwkJZG91YmxlIFByZWZldGNoU291cmNlTGluZXNDLAorCQlkb3Vi
bGUgQnl0ZVBlclBpeGVsREVUQywKKwkJZG91YmxlIFZJbml0UHJlRmlsbEMsCisJCXVuc2lnbmVk
IGludCBNYXhOdW1Td2F0aEMsCisJCXVuc2lnbmVkIGludCBTd2F0aEhlaWdodFksCisJCXVuc2ln
bmVkIGludCBTd2F0aEhlaWdodEMsCisJCWRvdWJsZSBUV2FpdCwKKwkJYm9vbCBYRkNFbmFibGVk
LAorCQlkb3VibGUgWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSwKKwkJYm9vbCBQcm9ncmVzc2l2
ZVRvSW50ZXJsYWNlVW5pdEluT1BQLAorCQlkb3VibGUgKkRTVFhBZnRlclNjYWxlciwKKwkJZG91
YmxlICpEU1RZQWZ0ZXJTY2FsZXIsCisJCWRvdWJsZSAqRGVzdGluYXRpb25MaW5lc0ZvclByZWZl
dGNoLAorCQlkb3VibGUgKlByZWZldGNoQmFuZHdpZHRoLAorCQlkb3VibGUgKkRlc3RpbmF0aW9u
TGluZXNUb1JlcXVlc3RWTUluVkJsYW5rLAorCQlkb3VibGUgKkRlc3RpbmF0aW9uTGluZXNUb1Jl
cXVlc3RSb3dJblZCbGFuaywKKwkJZG91YmxlICpWUmF0aW9QcmVmZXRjaFksCisJCWRvdWJsZSAq
VlJhdGlvUHJlZmV0Y2hDLAorCQlkb3VibGUgKlJlcXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldMdW1h
LAorCQlkb3VibGUgKlJlcXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldDaHJvbWEsCisJCXVuc2lnbmVk
IGludCAqVlN0YXJ0dXBSZXF1aXJlZFdoZW5Ob3RFbm91Z2hUaW1lRm9yRHluYW1pY01ldGFkYXRh
LAorCQlkb3VibGUgKlRub19idywKKwkJZG91YmxlICpwcmVmZXRjaF92bXJvd19idywKKwkJdW5z
aWduZWQgaW50ICpzd2F0aF93aWR0aF9sdW1hX3ViLAorCQl1bnNpZ25lZCBpbnQgKnN3YXRoX3dp
ZHRoX2Nocm9tYV91YiwKKwkJdW5zaWduZWQgaW50ICpWVXBkYXRlT2Zmc2V0UGl4LAorCQlkb3Vi
bGUgKlZVcGRhdGVXaWR0aFBpeCwKKwkJZG91YmxlICpWUmVhZHlPZmZzZXRQaXgpOworc3RhdGlj
IGRvdWJsZSBSb3VuZFRvREZTR3JhbnVsYXJpdHlVcChkb3VibGUgQ2xvY2ssIGRvdWJsZSBWQ09T
cGVlZCk7CitzdGF0aWMgZG91YmxlIFJvdW5kVG9ERlNHcmFudWxhcml0eURvd24oZG91YmxlIENs
b2NrLCBkb3VibGUgVkNPU3BlZWQpOworc3RhdGljIGRvdWJsZSBDYWxjdWxhdGVEQ0NDb25maWd1
cmF0aW9uKAorCQlib29sICAgICAgICAgICAgICAgICBEQ0NFbmFibGVkLAorCQlib29sICAgICAg
ICAgICAgICAgICBEQ0NQcm9ncmFtbWluZ0Fzc3VtZXNTY2FuRGlyZWN0aW9uVW5rbm93biwKKwkJ
dW5zaWduZWQgaW50ICAgICAgICAgVmlld3BvcnRXaWR0aCwKKwkJdW5zaWduZWQgaW50ICAgICAg
ICAgVmlld3BvcnRIZWlnaHQsCisJCWRvdWJsZSAgICAgICAgICAgICAgIERFVEJ1ZmZlclNpemUs
CisJCXVuc2lnbmVkIGludCAgICAgICAgIFJlcXVlc3RIZWlnaHQyNTZCeXRlLAorCQl1bnNpZ25l
ZCBpbnQgICAgICAgICBTd2F0aEhlaWdodCwKKwkJZW51bSBkbV9zd2l6emxlX21vZGUgVGlsaW5n
Rm9ybWF0LAorCQl1bnNpZ25lZCBpbnQgICAgICAgICBCeXRlUGVyUGl4ZWwsCisJCWVudW0gc2Nh
bl9kaXJlY3Rpb25fY2xhc3MgU2Nhbk9yaWVudGF0aW9uLAorCQl1bnNpZ25lZCBpbnQgICAgICAg
ICpNYXhVbmNvbXByZXNzZWRCbG9jaywKKwkJdW5zaWduZWQgaW50ICAgICAgICAqTWF4Q29tcHJl
c3NlZEJsb2NrLAorCQl1bnNpZ25lZCBpbnQgICAgICAgICpJbmRlcGVuZGVudDY0Qnl0ZUJsb2Nr
KTsKK3N0YXRpYyBkb3VibGUgQ2FsY3VsYXRlUHJlZmV0Y2hTb3VyY2VMaW5lcygKKwkJc3RydWN0
IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgVlJhdGlvLAorCQlkb3VibGUg
dnRhcHMsCisJCWJvb2wgSW50ZXJsYWNlLAorCQlib29sIFByb2dyZXNzaXZlVG9JbnRlcmxhY2VV
bml0SW5PUFAsCisJCXVuc2lnbmVkIGludCBTd2F0aEhlaWdodCwKKwkJdW5zaWduZWQgaW50IFZp
ZXdwb3J0WVN0YXJ0LAorCQlkb3VibGUgKlZJbml0UHJlRmlsbCwKKwkJdW5zaWduZWQgaW50ICpN
YXhOdW1Td2F0aCk7CitzdGF0aWMgdW5zaWduZWQgaW50IENhbGN1bGF0ZVZNQW5kUm93Qnl0ZXMo
CisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJYm9vbCBEQ0NFbmFibGUs
CisJCXVuc2lnbmVkIGludCBCbG9ja0hlaWdodDI1NkJ5dGVzLAorCQl1bnNpZ25lZCBpbnQgQmxv
Y2tXaWR0aDI1NkJ5dGVzLAorCQllbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MgU291cmNlUGl4ZWxG
b3JtYXQsCisJCXVuc2lnbmVkIGludCBTdXJmYWNlVGlsaW5nLAorCQl1bnNpZ25lZCBpbnQgQnl0
ZVBlclBpeGVsLAorCQllbnVtIHNjYW5fZGlyZWN0aW9uX2NsYXNzIFNjYW5EaXJlY3Rpb24sCisJ
CXVuc2lnbmVkIGludCBWaWV3cG9ydFdpZHRoLAorCQl1bnNpZ25lZCBpbnQgVmlld3BvcnRIZWln
aHQsCisJCXVuc2lnbmVkIGludCBTd2F0aFdpZHRoWSwKKwkJYm9vbCBHUFVWTUVuYWJsZSwKKwkJ
Ym9vbCBIb3N0Vk1FbmFibGUsCisJCXVuc2lnbmVkIGludCBIb3N0Vk1NYXhQYWdlVGFibGVMZXZl
bHMsCisJCXVuc2lnbmVkIGludCBIb3N0Vk1DYWNoZWRQYWdlVGFibGVMZXZlbHMsCisJCXVuc2ln
bmVkIGludCBWTU1QYWdlU2l6ZSwKKwkJdW5zaWduZWQgaW50IFBURUJ1ZmZlclNpemVJblJlcXVl
c3RzLAorCQl1bnNpZ25lZCBpbnQgUGl0Y2gsCisJCXVuc2lnbmVkIGludCBEQ0NNZXRhUGl0Y2gs
CisJCXVuc2lnbmVkIGludCAqTWFjcm9UaWxlV2lkdGgsCisJCXVuc2lnbmVkIGludCAqTWV0YVJv
d0J5dGUsCisJCXVuc2lnbmVkIGludCAqUGl4ZWxQVEVCeXRlc1BlclJvdywKKwkJYm9vbCAqUFRF
QnVmZmVyU2l6ZU5vdEV4Y2VlZGVkLAorCQl1bnNpZ25lZCBpbnQgKmRwdGVfcm93X3dpZHRoX3Vi
LAorCQl1bnNpZ25lZCBpbnQgKmRwdGVfcm93X2hlaWdodCwKKwkJdW5zaWduZWQgaW50ICpNZXRh
UmVxdWVzdFdpZHRoLAorCQl1bnNpZ25lZCBpbnQgKk1ldGFSZXF1ZXN0SGVpZ2h0LAorCQl1bnNp
Z25lZCBpbnQgKm1ldGFfcm93X3dpZHRoLAorCQl1bnNpZ25lZCBpbnQgKm1ldGFfcm93X2hlaWdo
dCwKKwkJdW5zaWduZWQgaW50ICp2bV9ncm91cF9ieXRlcywKKwkJbG9uZyAgICAgICAgICpkcHRl
X2dyb3VwX2J5dGVzLAorCQl1bnNpZ25lZCBpbnQgKlBpeGVsUFRFUmVxV2lkdGgsCisJCXVuc2ln
bmVkIGludCAqUGl4ZWxQVEVSZXFIZWlnaHQsCisJCXVuc2lnbmVkIGludCAqUFRFUmVxdWVzdFNp
emUsCisJCXVuc2lnbmVkIGludCAqRFBERTBCeXRlc0ZyYW1lLAorCQl1bnNpZ25lZCBpbnQgKk1l
dGFQVEVCeXRlc0ZyYW1lKTsKKworc3RhdGljIGRvdWJsZSBDYWxjdWxhdGVUV2FpdCgKKwkJdW5z
aWduZWQgaW50IFByZWZldGNoTW9kZSwKKwkJZG91YmxlIERSQU1DbG9ja0NoYW5nZUxhdGVuY3ks
CisJCWRvdWJsZSBVcmdlbnRMYXRlbmN5LAorCQlkb3VibGUgU1JFbnRlclBsdXNFeGl0VGltZSk7
CitzdGF0aWMgZG91YmxlIENhbGN1bGF0ZVJlbW90ZVN1cmZhY2VGbGlwRGVsYXkoCisJCXN0cnVj
dCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJZG91YmxlIFZSYXRpbywKKwkJZG91Ymxl
IFN3YXRoV2lkdGgsCisJCWRvdWJsZSBCcHAsCisJCWRvdWJsZSBMaW5lVGltZSwKKwkJZG91Ymxl
IFhGQ1RTbHZWdXBkYXRlT2Zmc2V0LAorCQlkb3VibGUgWEZDVFNsdlZ1cGRhdGVXaWR0aCwKKwkJ
ZG91YmxlIFhGQ1RTbHZWcmVhZHlPZmZzZXQsCisJCWRvdWJsZSBYRkNYQlVGTGF0ZW5jeVRvbGVy
YW5jZSwKKwkJZG91YmxlIFhGQ0ZpbGxCV092ZXJoZWFkLAorCQlkb3VibGUgWEZDU2x2Q2h1bmtT
aXplLAorCQlkb3VibGUgWEZDQnVzVHJhbnNwb3J0VGltZSwKKwkJZG91YmxlIFRDYWxjLAorCQlk
b3VibGUgVFdhaXQsCisJCWRvdWJsZSAqU3JjQWN0aXZlRHJhaW5SYXRlLAorCQlkb3VibGUgKlRJ
bml0WEZpbGwsCisJCWRvdWJsZSAqVHNsdkNoayk7CitzdGF0aWMgdm9pZCBDYWxjdWxhdGVBY3Rp
dmVSb3dCYW5kd2lkdGgoCisJCWJvb2wgR1BVVk1FbmFibGUsCisJCWVudW0gc291cmNlX2Zvcm1h
dF9jbGFzcyBTb3VyY2VQaXhlbEZvcm1hdCwKKwkJZG91YmxlIFZSYXRpbywKKwkJYm9vbCBEQ0NF
bmFibGUsCisJCWRvdWJsZSBMaW5lVGltZSwKKwkJdW5zaWduZWQgaW50IE1ldGFSb3dCeXRlTHVt
YSwKKwkJdW5zaWduZWQgaW50IE1ldGFSb3dCeXRlQ2hyb21hLAorCQl1bnNpZ25lZCBpbnQgbWV0
YV9yb3dfaGVpZ2h0X2x1bWEsCisJCXVuc2lnbmVkIGludCBtZXRhX3Jvd19oZWlnaHRfY2hyb21h
LAorCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVCeXRlc1BlclJvd0x1bWEsCisJCXVuc2lnbmVkIGlu
dCBQaXhlbFBURUJ5dGVzUGVyUm93Q2hyb21hLAorCQl1bnNpZ25lZCBpbnQgZHB0ZV9yb3dfaGVp
Z2h0X2x1bWEsCisJCXVuc2lnbmVkIGludCBkcHRlX3Jvd19oZWlnaHRfY2hyb21hLAorCQlkb3Vi
bGUgKm1ldGFfcm93X2J3LAorCQlkb3VibGUgKmRwdGVfcm93X2J3KTsKK3N0YXRpYyB2b2lkIENh
bGN1bGF0ZUZsaXBTY2hlZHVsZSgKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGli
LAorCQlkb3VibGUgUGVyY2VudE9mSWRlYWxEUkFNRmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRB
ZnRlclVyZ0xhdGVuY3lQaXhlbE1peGVkV2l0aFZNRGF0YSwKKwkJZG91YmxlIFBlcmNlbnRPZklk
ZWFsRFJBTUZhYnJpY0FuZFNEUFBvcnRCV1JlY2VpdmVkQWZ0ZXJVcmdMYXRlbmN5Vk1EYXRhT25s
eSwKKwkJZG91YmxlIFVyZ2VudEV4dHJhTGF0ZW5jeSwKKwkJZG91YmxlIFVyZ2VudExhdGVuY3ks
CisJCXVuc2lnbmVkIGludCBHUFVWTU1heFBhZ2VUYWJsZUxldmVscywKKwkJYm9vbCBIb3N0Vk1F
bmFibGUsCisJCXVuc2lnbmVkIGludCBIb3N0Vk1NYXhQYWdlVGFibGVMZXZlbHMsCisJCXVuc2ln
bmVkIGludCBIb3N0Vk1DYWNoZWRQYWdlVGFibGVMZXZlbHMsCisJCWJvb2wgR1BVVk1FbmFibGUs
CisJCWRvdWJsZSBQREVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFtZSwKKwkJZG91YmxlIE1ldGFSb3dC
eXRlcywKKwkJZG91YmxlIERQVEVCeXRlc1BlclJvdywKKwkJZG91YmxlIEJhbmR3aWR0aEF2YWls
YWJsZUZvckltbWVkaWF0ZUZsaXAsCisJCXVuc2lnbmVkIGludCBUb3RJbW1lZGlhdGVGbGlwQnl0
ZXMsCisJCWVudW0gc291cmNlX2Zvcm1hdF9jbGFzcyBTb3VyY2VQaXhlbEZvcm1hdCwKKwkJZG91
YmxlIExpbmVUaW1lLAorCQlkb3VibGUgVlJhdGlvLAorCQlkb3VibGUgVG5vX2J3LAorCQlib29s
IERDQ0VuYWJsZSwKKwkJdW5zaWduZWQgaW50IGRwdGVfcm93X2hlaWdodCwKKwkJdW5zaWduZWQg
aW50IG1ldGFfcm93X2hlaWdodCwKKwkJdW5zaWduZWQgaW50IGRwdGVfcm93X2hlaWdodF9jaHJv
bWEsCisJCXVuc2lnbmVkIGludCBtZXRhX3Jvd19oZWlnaHRfY2hyb21hLAorCQlkb3VibGUgKkRl
c3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluSW1tZWRpYXRlRmxpcCwKKwkJZG91YmxlICpEZXN0
aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5JbW1lZGlhdGVGbGlwLAorCQlkb3VibGUgKmZpbmFs
X2ZsaXBfYncsCisJCWJvb2wgKkltbWVkaWF0ZUZsaXBTdXBwb3J0ZWRGb3JQaXBlKTsKK3N0YXRp
YyBkb3VibGUgQ2FsY3VsYXRlV3JpdGVCYWNrRGVsYXkoCisJCWVudW0gc291cmNlX2Zvcm1hdF9j
bGFzcyBXcml0ZWJhY2tQaXhlbEZvcm1hdCwKKwkJZG91YmxlIFdyaXRlYmFja0hSYXRpbywKKwkJ
ZG91YmxlIFdyaXRlYmFja1ZSYXRpbywKKwkJdW5zaWduZWQgaW50IFdyaXRlYmFja0x1bWFIVGFw
cywKKwkJdW5zaWduZWQgaW50IFdyaXRlYmFja0x1bWFWVGFwcywKKwkJdW5zaWduZWQgaW50IFdy
aXRlYmFja0Nocm9tYUhUYXBzLAorCQl1bnNpZ25lZCBpbnQgV3JpdGViYWNrQ2hyb21hVlRhcHMs
CisJCXVuc2lnbmVkIGludCBXcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoKTsKK3N0YXRpYyB2b2lk
IENhbGN1bGF0ZVdhdGVybWFya3NBbmREUkFNU3BlZWRDaGFuZ2VTdXBwb3J0KAorCQlzdHJ1Y3Qg
ZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCXVuc2lnbmVkIGludCBQcmVmZXRjaE1vZGUs
CisJCXVuc2lnbmVkIGludCBOdW1iZXJPZkFjdGl2ZVBsYW5lcywKKwkJdW5zaWduZWQgaW50IE1h
eExpbmVCdWZmZXJMaW5lcywKKwkJdW5zaWduZWQgaW50IExpbmVCdWZmZXJTaXplLAorCQl1bnNp
Z25lZCBpbnQgRFBQT3V0cHV0QnVmZmVyUGl4ZWxzLAorCQlkb3VibGUgREVUQnVmZmVyU2l6ZUlu
S0J5dGUsCisJCXVuc2lnbmVkIGludCBXcml0ZWJhY2tJbnRlcmZhY2VMdW1hQnVmZmVyU2l6ZSwK
KwkJdW5zaWduZWQgaW50IFdyaXRlYmFja0ludGVyZmFjZUNocm9tYUJ1ZmZlclNpemUsCisJCWRv
dWJsZSBEQ0ZDTEssCisJCWRvdWJsZSBVcmdlbnRPdXRPZk9yZGVyUmV0dXJuLAorCQlkb3VibGUg
UmV0dXJuQlcsCisJCWJvb2wgR1BVVk1FbmFibGUsCisJCWxvbmcgZHB0ZV9ncm91cF9ieXRlc1td
LAorCQl1bnNpZ25lZCBpbnQgTWV0YUNodW5rU2l6ZSwKKwkJZG91YmxlIFVyZ2VudExhdGVuY3ks
CisJCWRvdWJsZSBFeHRyYUxhdGVuY3ksCisJCWRvdWJsZSBXcml0ZWJhY2tMYXRlbmN5LAorCQlk
b3VibGUgV3JpdGViYWNrQ2h1bmtTaXplLAorCQlkb3VibGUgU09DQ0xLLAorCQlkb3VibGUgRFJB
TUNsb2NrQ2hhbmdlTGF0ZW5jeSwKKwkJZG91YmxlIFNSRXhpdFRpbWUsCisJCWRvdWJsZSBTUkVu
dGVyUGx1c0V4aXRUaW1lLAorCQlkb3VibGUgRENGQ0xLRGVlcFNsZWVwLAorCQlpbnQgRFBQUGVy
UGxhbmVbXSwKKwkJYm9vbCBEQ0NFbmFibGVbXSwKKwkJZG91YmxlIERQUENMS1tdLAorCQl1bnNp
Z25lZCBpbnQgU3dhdGhXaWR0aFNpbmdsZURQUFlbXSwKKwkJdW5zaWduZWQgaW50IFN3YXRoSGVp
Z2h0WVtdLAorCQlkb3VibGUgUmVhZEJhbmR3aWR0aFBsYW5lTHVtYVtdLAorCQl1bnNpZ25lZCBp
bnQgU3dhdGhIZWlnaHRDW10sCisJCWRvdWJsZSBSZWFkQmFuZHdpZHRoUGxhbmVDaHJvbWFbXSwK
KwkJdW5zaWduZWQgaW50IExCQml0UGVyUGl4ZWxbXSwKKwkJdW5zaWduZWQgaW50IFN3YXRoV2lk
dGhZW10sCisJCWRvdWJsZSBIUmF0aW9bXSwKKwkJdW5zaWduZWQgaW50IHZ0YXBzW10sCisJCXVu
c2lnbmVkIGludCBWVEFQc0Nocm9tYVtdLAorCQlkb3VibGUgVlJhdGlvW10sCisJCXVuc2lnbmVk
IGludCBIVG90YWxbXSwKKwkJZG91YmxlIFBpeGVsQ2xvY2tbXSwKKwkJdW5zaWduZWQgaW50IEJs
ZW5kaW5nQW5kVGltaW5nW10sCisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxERVRZW10sCisJCWRvdWJs
ZSBCeXRlUGVyUGl4ZWxERVRDW10sCisJCWJvb2wgV3JpdGViYWNrRW5hYmxlW10sCisJCWVudW0g
c291cmNlX2Zvcm1hdF9jbGFzcyBXcml0ZWJhY2tQaXhlbEZvcm1hdFtdLAorCQlkb3VibGUgV3Jp
dGViYWNrRGVzdGluYXRpb25XaWR0aFtdLAorCQlkb3VibGUgV3JpdGViYWNrRGVzdGluYXRpb25I
ZWlnaHRbXSwKKwkJZG91YmxlIFdyaXRlYmFja1NvdXJjZUhlaWdodFtdLAorCQllbnVtIGNsb2Nr
X2NoYW5nZV9zdXBwb3J0ICpEUkFNQ2xvY2tDaGFuZ2VTdXBwb3J0LAorCQlkb3VibGUgKlVyZ2Vu
dFdhdGVybWFyaywKKwkJZG91YmxlICpXcml0ZWJhY2tVcmdlbnRXYXRlcm1hcmssCisJCWRvdWJs
ZSAqRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrLAorCQlkb3VibGUgKldyaXRlYmFja0RSQU1DbG9j
a0NoYW5nZVdhdGVybWFyaywKKwkJZG91YmxlICpTdHV0dGVyRXhpdFdhdGVybWFyaywKKwkJZG91
YmxlICpTdHV0dGVyRW50ZXJQbHVzRXhpdFdhdGVybWFyaywKKwkJZG91YmxlICpNaW5BY3RpdmVE
UkFNQ2xvY2tDaGFuZ2VMYXRlbmN5U3VwcG9ydGVkKTsKK3N0YXRpYyB2b2lkIENhbGN1bGF0ZURD
RkNMS0RlZXBTbGVlcCgKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQl1
bnNpZ25lZCBpbnQgTnVtYmVyT2ZBY3RpdmVQbGFuZXMsCisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxE
RVRZW10sCisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxERVRDW10sCisJCWRvdWJsZSBWUmF0aW9bXSwK
KwkJdW5zaWduZWQgaW50IFN3YXRoV2lkdGhZW10sCisJCWludCBEUFBQZXJQbGFuZVtdLAorCQlk
b3VibGUgSFJhdGlvW10sCisJCWRvdWJsZSBQaXhlbENsb2NrW10sCisJCWRvdWJsZSBQU0NMX1RI
Uk9VR0hQVVRbXSwKKwkJZG91YmxlIFBTQ0xfVEhST1VHSFBVVF9DSFJPTUFbXSwKKwkJZG91Ymxl
IERQUENMS1tdLAorCQlkb3VibGUgKkRDRkNMS0RlZXBTbGVlcCk7CitzdGF0aWMgdm9pZCBDYWxj
dWxhdGVERVRCdWZmZXJTaXplKAorCQlkb3VibGUgREVUQnVmZmVyU2l6ZUluS0J5dGUsCisJCXVu
c2lnbmVkIGludCBTd2F0aEhlaWdodFksCisJCXVuc2lnbmVkIGludCBTd2F0aEhlaWdodEMsCisJ
CWRvdWJsZSAqREVUQnVmZmVyU2l6ZVksCisJCWRvdWJsZSAqREVUQnVmZmVyU2l6ZUMpOworc3Rh
dGljIHZvaWQgQ2FsY3VsYXRlVXJnZW50QnVyc3RGYWN0b3IoCisJCXVuc2lnbmVkIGludCBERVRC
dWZmZXJTaXplSW5LQnl0ZSwKKwkJdW5zaWduZWQgaW50IFN3YXRoSGVpZ2h0WSwKKwkJdW5zaWdu
ZWQgaW50IFN3YXRoSGVpZ2h0QywKKwkJdW5zaWduZWQgaW50IFN3YXRoV2lkdGhZLAorCQlkb3Vi
bGUgTGluZVRpbWUsCisJCWRvdWJsZSBVcmdlbnRMYXRlbmN5LAorCQlkb3VibGUgQ3Vyc29yQnVm
ZmVyU2l6ZSwKKwkJdW5zaWduZWQgaW50IEN1cnNvcldpZHRoLAorCQl1bnNpZ25lZCBpbnQgQ3Vy
c29yQlBQLAorCQlkb3VibGUgVlJhdGlvLAorCQlkb3VibGUgVlJhdGlvUHJlWSwKKwkJZG91Ymxl
IFZSYXRpb1ByZUMsCisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxJbkRFVFksCisJCWRvdWJsZSBCeXRl
UGVyUGl4ZWxJbkRFVEMsCisJCWRvdWJsZSAqVXJnZW50QnVyc3RGYWN0b3JDdXJzb3IsCisJCWRv
dWJsZSAqVXJnZW50QnVyc3RGYWN0b3JDdXJzb3JQcmUsCisJCWRvdWJsZSAqVXJnZW50QnVyc3RG
YWN0b3JMdW1hLAorCQlkb3VibGUgKlVyZ2VudEJ1cnN0RmFjdG9yTHVtYVByZSwKKwkJZG91Ymxl
ICpVcmdlbnRCdXJzdEZhY3RvckNocm9tYSwKKwkJZG91YmxlICpVcmdlbnRCdXJzdEZhY3RvckNo
cm9tYVByZSwKKwkJdW5zaWduZWQgaW50ICpOb3RFbm91Z2hVcmdlbnRMYXRlbmN5SGlkaW5nLAor
CQl1bnNpZ25lZCBpbnQgKk5vdEVub3VnaFVyZ2VudExhdGVuY3lIaWRpbmdQcmUpOworCitzdGF0
aWMgdm9pZCBDYWxjdWxhdGVQaXhlbERlbGl2ZXJ5VGltZXMoCisJCXVuc2lnbmVkIGludCAgICAg
ICAgICAgTnVtYmVyT2ZBY3RpdmVQbGFuZXMsCisJCWRvdWJsZSAgICAgICAgICAgICAgICAgVlJh
dGlvW10sCisJCWRvdWJsZSAgICAgICAgICAgICAgICAgVlJhdGlvUHJlZmV0Y2hZW10sCisJCWRv
dWJsZSAgICAgICAgICAgICAgICAgVlJhdGlvUHJlZmV0Y2hDW10sCisJCXVuc2lnbmVkIGludCAg
ICAgICAgICAgc3dhdGhfd2lkdGhfbHVtYV91YltdLAorCQl1bnNpZ25lZCBpbnQgICAgICAgICAg
IHN3YXRoX3dpZHRoX2Nocm9tYV91YltdLAorCQlpbnQgICAgICAgICAgICAgICAgICAgIERQUFBl
clBsYW5lW10sCisJCWRvdWJsZSAgICAgICAgICAgICAgICAgSFJhdGlvW10sCisJCWRvdWJsZSAg
ICAgICAgICAgICAgICAgUGl4ZWxDbG9ja1tdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIFBT
Q0xfVEhST1VHSFBVVFtdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIFBTQ0xfVEhST1VHSFBV
VF9DSFJPTUFbXSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICBEUFBDTEtbXSwKKwkJZG91Ymxl
ICAgICAgICAgICAgICAgICBCeXRlUGVyUGl4ZWxERVRDW10sCisJCWVudW0gc2Nhbl9kaXJlY3Rp
b25fY2xhc3MgU291cmNlU2NhbltdLAorCQl1bnNpZ25lZCBpbnQgICAgICAgICAgIEJsb2NrV2lk
dGgyNTZCeXRlc1lbXSwKKwkJdW5zaWduZWQgaW50ICAgICAgICAgICBCbG9ja0hlaWdodDI1NkJ5
dGVzWVtdLAorCQl1bnNpZ25lZCBpbnQgICAgICAgICAgIEJsb2NrV2lkdGgyNTZCeXRlc0NbXSwK
KwkJdW5zaWduZWQgaW50ICAgICAgICAgICBCbG9ja0hlaWdodDI1NkJ5dGVzQ1tdLAorCQlkb3Vi
bGUgICAgICAgICAgICAgICAgIERpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWFbXSwKKwkJ
ZG91YmxlICAgICAgICAgICAgICAgICBEaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVDaHJvbWFb
XSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICBEaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVM
dW1hUHJlZmV0Y2hbXSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICBEaXNwbGF5UGlwZUxpbmVE
ZWxpdmVyeVRpbWVDaHJvbWFQcmVmZXRjaFtdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIERp
c3BsYXlQaXBlUmVxdWVzdERlbGl2ZXJ5VGltZUx1bWFbXSwKKwkJZG91YmxlICAgICAgICAgICAg
ICAgICBEaXNwbGF5UGlwZVJlcXVlc3REZWxpdmVyeVRpbWVDaHJvbWFbXSwKKwkJZG91YmxlICAg
ICAgICAgICAgICAgICBEaXNwbGF5UGlwZVJlcXVlc3REZWxpdmVyeVRpbWVMdW1hUHJlZmV0Y2hb
XSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICBEaXNwbGF5UGlwZVJlcXVlc3REZWxpdmVyeVRp
bWVDaHJvbWFQcmVmZXRjaFtdKTsKKworc3RhdGljIHZvaWQgQ2FsY3VsYXRlTWV0YUFuZFBURVRp
bWVzKAorCQl1bnNpZ25lZCBpbnQgICAgICAgICAgIE51bWJlck9mQWN0aXZlUGxhbmVzLAorCQli
b29sICAgICAgICAgICAgICAgICAgIEdQVVZNRW5hYmxlLAorCQl1bnNpZ25lZCBpbnQgICAgICAg
ICAgIE1ldGFDaHVua1NpemUsCisJCXVuc2lnbmVkIGludCAgICAgICAgICAgTWluTWV0YUNodW5r
U2l6ZUJ5dGVzLAorCQl1bnNpZ25lZCBpbnQgICAgICAgICAgIEdQVVZNTWF4UGFnZVRhYmxlTGV2
ZWxzLAorCQl1bnNpZ25lZCBpbnQgICAgICAgICAgIEhUb3RhbFtdLAorCQlkb3VibGUgICAgICAg
ICAgICAgICAgIFZSYXRpb1tdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIFZSYXRpb1ByZWZl
dGNoWVtdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIFZSYXRpb1ByZWZldGNoQ1tdLAorCQlk
b3VibGUgICAgICAgICAgICAgICAgIERlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJblZCbGFu
a1tdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIERlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RS
b3dJbkltbWVkaWF0ZUZsaXBbXSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICBEZXN0aW5hdGlv
bkxpbmVzVG9SZXF1ZXN0Vk1JblZCbGFua1tdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIERl
c3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluSW1tZWRpYXRlRmxpcFtdLAorCQlib29sICAgICAg
ICAgICAgICAgICAgIERDQ0VuYWJsZVtdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIFBpeGVs
Q2xvY2tbXSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICBCeXRlUGVyUGl4ZWxERVRZW10sCisJ
CWRvdWJsZSAgICAgICAgICAgICAgICAgQnl0ZVBlclBpeGVsREVUQ1tdLAorCQllbnVtIHNjYW5f
ZGlyZWN0aW9uX2NsYXNzIFNvdXJjZVNjYW5bXSwKKwkJdW5zaWduZWQgaW50ICAgICAgICAgICBk
cHRlX3Jvd19oZWlnaHRbXSwKKwkJdW5zaWduZWQgaW50ICAgICAgICAgICBkcHRlX3Jvd19oZWln
aHRfY2hyb21hW10sCisJCXVuc2lnbmVkIGludCAgICAgICAgICAgbWV0YV9yb3dfd2lkdGhbXSwK
KwkJdW5zaWduZWQgaW50ICAgICAgICAgICBtZXRhX3Jvd19oZWlnaHRbXSwKKwkJdW5zaWduZWQg
aW50ICAgICAgICAgICBtZXRhX3JlcV93aWR0aFtdLAorCQl1bnNpZ25lZCBpbnQgICAgICAgICAg
IG1ldGFfcmVxX2hlaWdodFtdLAorCQlsb25nICAgICAgICAgICAgICAgICAgIGRwdGVfZ3JvdXBf
Ynl0ZXNbXSwKKwkJdW5zaWduZWQgaW50ICAgICAgICAgICBQVEVSZXF1ZXN0U2l6ZVlbXSwKKwkJ
dW5zaWduZWQgaW50ICAgICAgICAgICBQVEVSZXF1ZXN0U2l6ZUNbXSwKKwkJdW5zaWduZWQgaW50
ICAgICAgICAgICBQaXhlbFBURVJlcVdpZHRoWVtdLAorCQl1bnNpZ25lZCBpbnQgICAgICAgICAg
IFBpeGVsUFRFUmVxSGVpZ2h0WVtdLAorCQl1bnNpZ25lZCBpbnQgICAgICAgICAgIFBpeGVsUFRF
UmVxV2lkdGhDW10sCisJCXVuc2lnbmVkIGludCAgICAgICAgICAgUGl4ZWxQVEVSZXFIZWlnaHRD
W10sCisJCXVuc2lnbmVkIGludCAgICAgICAgICAgZHB0ZV9yb3dfd2lkdGhfbHVtYV91YltdLAor
CQl1bnNpZ25lZCBpbnQgICAgICAgICAgIGRwdGVfcm93X3dpZHRoX2Nocm9tYV91YltdLAorCQl1
bnNpZ25lZCBpbnQgICAgICAgICAgIHZtX2dyb3VwX2J5dGVzW10sCisJCXVuc2lnbmVkIGludCAg
ICAgICAgICAgZHBkZTBfYnl0ZXNfcGVyX2ZyYW1lX3ViX2xbXSwKKwkJdW5zaWduZWQgaW50ICAg
ICAgICAgICBkcGRlMF9ieXRlc19wZXJfZnJhbWVfdWJfY1tdLAorCQl1bnNpZ25lZCBpbnQgICAg
ICAgICAgIG1ldGFfcHRlX2J5dGVzX3Blcl9mcmFtZV91Yl9sW10sCisJCXVuc2lnbmVkIGludCAg
ICAgICAgICAgbWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1lX3ViX2NbXSwKKwkJZG91YmxlICAgICAg
ICAgICAgICAgICBEU1RfWV9QRVJfUFRFX1JPV19OT01fTFtdLAorCQlkb3VibGUgICAgICAgICAg
ICAgICAgIERTVF9ZX1BFUl9QVEVfUk9XX05PTV9DW10sCisJCWRvdWJsZSAgICAgICAgICAgICAg
ICAgRFNUX1lfUEVSX01FVEFfUk9XX05PTV9MW10sCisJCWRvdWJsZSAgICAgICAgICAgICAgICAg
VGltZVBlck1ldGFDaHVua05vbWluYWxbXSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICBUaW1l
UGVyTWV0YUNodW5rVkJsYW5rW10sCisJCWRvdWJsZSAgICAgICAgICAgICAgICAgVGltZVBlck1l
dGFDaHVua0ZsaXBbXSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICB0aW1lX3Blcl9wdGVfZ3Jv
dXBfbm9tX2x1bWFbXSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICB0aW1lX3Blcl9wdGVfZ3Jv
dXBfdmJsYW5rX2x1bWFbXSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICB0aW1lX3Blcl9wdGVf
Z3JvdXBfZmxpcF9sdW1hW10sCisJCWRvdWJsZSAgICAgICAgICAgICAgICAgdGltZV9wZXJfcHRl
X2dyb3VwX25vbV9jaHJvbWFbXSwKKwkJZG91YmxlICAgICAgICAgICAgICAgICB0aW1lX3Blcl9w
dGVfZ3JvdXBfdmJsYW5rX2Nocm9tYVtdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIHRpbWVf
cGVyX3B0ZV9ncm91cF9mbGlwX2Nocm9tYVtdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIFRp
bWVQZXJWTUdyb3VwVkJsYW5rW10sCisJCWRvdWJsZSAgICAgICAgICAgICAgICAgVGltZVBlclZN
R3JvdXBGbGlwW10sCisJCWRvdWJsZSAgICAgICAgICAgICAgICAgVGltZVBlclZNUmVxdWVzdFZC
bGFua1tdLAorCQlkb3VibGUgICAgICAgICAgICAgICAgIFRpbWVQZXJWTVJlcXVlc3RGbGlwW10p
OworCitzdGF0aWMgZG91YmxlIENhbGN1bGF0ZUV4dHJhTGF0ZW5jeSgKKwkJZG91YmxlIFVyZ2Vu
dFJvdW5kVHJpcEFuZE91dE9mT3JkZXJMYXRlbmN5LAorCQlpbnQgVG90YWxOdW1iZXJPZkFjdGl2
ZURQUCwKKwkJaW50IFBpeGVsQ2h1bmtTaXplSW5LQnl0ZSwKKwkJaW50IFRvdGFsTnVtYmVyT2ZE
Q0NBY3RpdmVEUFAsCisJCWludCBNZXRhQ2h1bmtTaXplLAorCQlkb3VibGUgUmV0dXJuQlcsCisJ
CWJvb2wgR1BVVk1FbmFibGUsCisJCWJvb2wgSG9zdFZNRW5hYmxlLAorCQlpbnQgTnVtYmVyT2ZB
Y3RpdmVQbGFuZXMsCisJCWludCBOdW1iZXJPZkRQUFtdLAorCQlsb25nIGRwdGVfZ3JvdXBfYnl0
ZXNbXSwKKwkJZG91YmxlIFBlcmNlbnRPZklkZWFsRFJBTUZhYnJpY0FuZFNEUFBvcnRCV1JlY2Vp
dmVkQWZ0ZXJVcmdMYXRlbmN5UGl4ZWxNaXhlZFdpdGhWTURhdGEsCisJCWRvdWJsZSBQZXJjZW50
T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQb3J0QldSZWNlaXZlZEFmdGVyVXJnTGF0ZW5jeVZNRGF0
YU9ubHksCisJCWludCBIb3N0Vk1NYXhQYWdlVGFibGVMZXZlbHMsCisJCWludCBIb3N0Vk1DYWNo
ZWRQYWdlVGFibGVMZXZlbHMpOworCit2b2lkIGRtbDIxX3JlY2FsY3VsYXRlKHN0cnVjdCBkaXNw
bGF5X21vZGVfbGliICptb2RlX2xpYikKK3sKKwlNb2RlU3VwcG9ydEFuZFN5c3RlbUNvbmZpZ3Vy
YXRpb24obW9kZV9saWIpOworCVBpeGVsQ2xvY2tBZGp1c3RtZW50Rm9yUHJvZ3Jlc3NpdmVUb0lu
dGVybGFjZVVuaXQobW9kZV9saWIpOworCURpc3BsYXlQaXBlQ29uZmlndXJhdGlvbihtb2RlX2xp
Yik7CisJRElTUENMS0RQUENMS0RDRkNMS0RlZXBTbGVlcFByZWZldGNoUGFyYW1ldGVyc1dhdGVy
bWFya3NBbmRQZXJmb3JtYW5jZUNhbGN1bGF0aW9uKG1vZGVfbGliKTsKK30KKworc3RhdGljIHVu
c2lnbmVkIGludCBkc2NjZUNvbXB1dGVEZWxheSgKKwkJdW5zaWduZWQgaW50IGJwYywKKwkJZG91
YmxlIGJwcCwKKwkJdW5zaWduZWQgaW50IHNsaWNlV2lkdGgsCisJCXVuc2lnbmVkIGludCBudW1T
bGljZXMsCisJCWVudW0gb3V0cHV0X2Zvcm1hdF9jbGFzcyBwaXhlbEZvcm1hdCkKK3sKKwkvLyB2
YWxpZCBicGMgICAgICAgICA9IHNvdXJjZSBiaXRzIHBlciBjb21wb25lbnQgaW4gdGhlIHNldCBv
ZiB7OCwgMTAsIDEyfQorCS8vIHZhbGlkIGJwcCAgICAgICAgID0gaW5jcmVtZW50cyBvZiAxLzE2
IG9mIGEgYml0CisJLy8gICAgICAgICAgICAgICAgICAgIG1pbiA9IDYvNy84IGluIE40MjAvTjQy
Mi80NDQsIHJlc3BlY3RpdmVseQorCS8vICAgICAgICAgICAgICAgICAgICBtYXggPSBzdWNoIHRo
YXQgY29tcHJlc3Npb24gaXMgMToxCisJLy92YWxpZCBzbGljZVdpZHRoICA9IG51bWJlciBvZiBw
aXhlbHMgcGVyIHNsaWNlIGxpbmUsIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIDUxODQv
bnVtU2xpY2VzIChvciA0MDk2L251bVNsaWNlcyBpbiA0MjAgbW9kZSkKKwkvL3ZhbGlkIG51bVNs
aWNlcyAgID0gbnVtYmVyIG9mIHNsaWNlcyBpbiB0aGUgaG9yaXppb250YWwgZGlyZWN0aW9uIHBl
ciBEU0MgZW5naW5lIGluIHRoZSBzZXQgb2YgezEsIDIsIDMsIDR9CisJLy92YWxpZCBwaXhlbEZv
cm1hdCA9IHBpeGVsL2NvbG9yIGZvcm1hdCBpbiB0aGUgc2V0IG9mIHs6TjQ0NF9SR0IsIDpTNDIy
LCA6TjQyMiwgOk40MjB9CisKKwkvLyBmaXhlZCB2YWx1ZQorCXVuc2lnbmVkIGludCByY01vZGVs
U2l6ZSA9IDgxOTI7CisKKwkvLyBONDIyL040MjAgb3BlcmF0ZSBhdCAyIHBpeGVscyBwZXIgY2xv
Y2sKKwl1bnNpZ25lZCBpbnQgcGl4ZWxzUGVyQ2xvY2ssIGxzdGFsbCwgRCwgaW5pdGFsWG1pdERl
bGF5LCB3LCBTLCBpeCwgd3gsIHAsIGwwLCBhLCBheCwgbCwKKwkJCURlbGF5LCBwaXhlbHM7CisK
KwlpZiAocGl4ZWxGb3JtYXQgPT0gZG1fbjQyMiB8fCBwaXhlbEZvcm1hdCA9PSBkbV80MjApCisJ
CXBpeGVsc1BlckNsb2NrID0gMjsKKwkvLyAjYWxsIG90aGVyIG1vZGVzIG9wZXJhdGUgYXQgMSBw
aXhlbCBwZXIgY2xvY2sKKwllbHNlCisJCXBpeGVsc1BlckNsb2NrID0gMTsKKworCS8vaW5pdGlh
bCB0cmFuc21pdCBkZWxheSBhcyBwZXIgUFBTCisJaW5pdGFsWG1pdERlbGF5ID0gZG1sX3JvdW5k
KHJjTW9kZWxTaXplIC8gMi4wIC8gYnBwIC8gcGl4ZWxzUGVyQ2xvY2spOworCisJLy9jb21wdXRl
IHNzbSBkZWxheQorCWlmIChicGMgPT0gOCkKKwkJRCA9IDgxOworCWVsc2UgaWYgKGJwYyA9PSAx
MCkKKwkJRCA9IDg5OworCWVsc2UKKwkJRCA9IDExMzsKKworCS8vZGl2aWRlIGJ5IHBpeGVsIHBl
ciBjeWNsZSB0byBjb21wdXRlIHNsaWNlIHdpZHRoIGFzIHNlZW4gYnkgRFNDCisJdyA9IHNsaWNl
V2lkdGggLyBwaXhlbHNQZXJDbG9jazsKKworCS8vNDIyIG1vZGUgaGFzIGFuIGFkZGl0aW9uYWwg
Y3ljbGUgb2YgZGVsYXkKKwlpZiAocGl4ZWxGb3JtYXQgPT0gZG1fczQyMikKKwkJUyA9IDE7CisJ
ZWxzZQorCQlTID0gMDsKKworCS8vbWFpbiBjYWxjdWxhdGlvbiBmb3IgdGhlIGRzY2NlCisJaXgg
PSBpbml0YWxYbWl0RGVsYXkgKyA0NTsKKwl3eCA9ICh3ICsgMikgLyAzOworCXAgPSAzICogd3gg
LSB3OworCWwwID0gaXggLyB3OworCWEgPSBpeCArIHAgKiBsMDsKKwlheCA9IChhICsgMikgLyAz
ICsgRCArIDYgKyAxOworCWwgPSAoYXggKyB3eCAtIDEpIC8gd3g7CisJaWYgKChpeCAlIHcpID09
IDAgJiYgcCAhPSAwKQorCQlsc3RhbGwgPSAxOworCWVsc2UKKwkJbHN0YWxsID0gMDsKKwlEZWxh
eSA9IGwgKiB3eCAqIChudW1TbGljZXMgLSAxKSArIGF4ICsgUyArIGxzdGFsbCArIDIyOworCisJ
Ly9kc2MgcHJvY2Vzc2VzIDMgcGl4ZWwgY29udGFpbmVycyBwZXIgY3ljbGUgYW5kIGEgY29udGFp
bmVyIGNhbiBjb250YWluIDEgb3IgMiBwaXhlbHMKKwlwaXhlbHMgPSBEZWxheSAqIDMgKiBwaXhl
bHNQZXJDbG9jazsKKwlyZXR1cm4gcGl4ZWxzOworfQorCitzdGF0aWMgdW5zaWduZWQgaW50IGRz
Y0NvbXB1dGVEZWxheShlbnVtIG91dHB1dF9mb3JtYXRfY2xhc3MgcGl4ZWxGb3JtYXQpCit7CisJ
dW5zaWduZWQgaW50IERlbGF5ID0gMDsKKworCWlmIChwaXhlbEZvcm1hdCA9PSBkbV80MjApIHsK
KwkJLy8gICBzZnIKKwkJRGVsYXkgPSBEZWxheSArIDI7CisJCS8vICAgZHNjY2lmCisJCURlbGF5
ID0gRGVsYXkgKyAwOworCQkvLyAgIGRzY2MgLSBpbnB1dCBkZXNlcmlhbGl6ZXIKKwkJRGVsYXkg
PSBEZWxheSArIDM7CisJCS8vICAgZHNjYyBnZXRzIHBpeGVscyBldmVyeSBvdGhlciBjeWNsZQor
CQlEZWxheSA9IERlbGF5ICsgMjsKKwkJLy8gICBkc2NjIC0gaW5wdXQgY2RjIGZpZm8KKwkJRGVs
YXkgPSBEZWxheSArIDEyOworCQkvLyAgIGRzY2MgZ2V0cyBwaXhlbHMgZXZlcnkgb3RoZXIgY3lj
bGUKKwkJRGVsYXkgPSBEZWxheSArIDEzOworCQkvLyAgIGRzY2MgLSBjZGMgdW5jZXJ0YWludHkK
KwkJRGVsYXkgPSBEZWxheSArIDI7CisJCS8vICAgZHNjYyAtIG91dHB1dCBjZGMgZmlmbworCQlE
ZWxheSA9IERlbGF5ICsgNzsKKwkJLy8gICBkc2NjIGdldHMgcGl4ZWxzIGV2ZXJ5IG90aGVyIGN5
Y2xlCisJCURlbGF5ID0gRGVsYXkgKyAzOworCQkvLyAgIGRzY2MgLSBjZGMgdW5jZXJ0YWludHkK
KwkJRGVsYXkgPSBEZWxheSArIDI7CisJCS8vICAgZHNjYyAtIG91dHB1dCBzZXJpYWxpemVyCisJ
CURlbGF5ID0gRGVsYXkgKyAxOworCQkvLyAgIHNmdAorCQlEZWxheSA9IERlbGF5ICsgMTsKKwl9
IGVsc2UgaWYgKHBpeGVsRm9ybWF0ID09IGRtX240MjIpIHsKKwkJLy8gICBzZnIKKwkJRGVsYXkg
PSBEZWxheSArIDI7CisJCS8vICAgZHNjY2lmCisJCURlbGF5ID0gRGVsYXkgKyAxOworCQkvLyAg
IGRzY2MgLSBpbnB1dCBkZXNlcmlhbGl6ZXIKKwkJRGVsYXkgPSBEZWxheSArIDU7CisJCS8vICBk
c2NjIC0gaW5wdXQgY2RjIGZpZm8KKwkJRGVsYXkgPSBEZWxheSArIDI1OworCQkvLyAgIGRzY2Mg
LSBjZGMgdW5jZXJ0YWludHkKKwkJRGVsYXkgPSBEZWxheSArIDI7CisJCS8vICAgZHNjYyAtIG91
dHB1dCBjZGMgZmlmbworCQlEZWxheSA9IERlbGF5ICsgMTA7CisJCS8vICAgZHNjYyAtIGNkYyB1
bmNlcnRhaW50eQorCQlEZWxheSA9IERlbGF5ICsgMjsKKwkJLy8gICBkc2NjIC0gb3V0cHV0IHNl
cmlhbGl6ZXIKKwkJRGVsYXkgPSBEZWxheSArIDE7CisJCS8vICAgc2Z0CisJCURlbGF5ID0gRGVs
YXkgKyAxOworCX0gZWxzZSB7CisJCS8vICAgc2ZyCisJCURlbGF5ID0gRGVsYXkgKyAyOworCQkv
LyAgIGRzY2NpZgorCQlEZWxheSA9IERlbGF5ICsgMDsKKwkJLy8gICBkc2NjIC0gaW5wdXQgZGVz
ZXJpYWxpemVyCisJCURlbGF5ID0gRGVsYXkgKyAzOworCQkvLyAgIGRzY2MgLSBpbnB1dCBjZGMg
ZmlmbworCQlEZWxheSA9IERlbGF5ICsgMTI7CisJCS8vICAgZHNjYyAtIGNkYyB1bmNlcnRhaW50
eQorCQlEZWxheSA9IERlbGF5ICsgMjsKKwkJLy8gICBkc2NjIC0gb3V0cHV0IGNkYyBmaWZvCisJ
CURlbGF5ID0gRGVsYXkgKyA3OworCQkvLyAgIGRzY2MgLSBvdXRwdXQgc2VyaWFsaXplcgorCQlE
ZWxheSA9IERlbGF5ICsgMTsKKwkJLy8gICBkc2NjIC0gY2RjIHVuY2VydGFpbnR5CisJCURlbGF5
ID0gRGVsYXkgKyAyOworCQkvLyAgIHNmdAorCQlEZWxheSA9IERlbGF5ICsgMTsKKwl9CisKKwly
ZXR1cm4gRGVsYXk7Cit9CisKK3N0YXRpYyBib29sIENhbGN1bGF0ZVByZWZldGNoU2NoZWR1bGUo
CisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJZG91YmxlIFBlcmNlbnRP
ZklkZWFsRFJBTUZhYnJpY0FuZFNEUFBvcnRCV1JlY2VpdmVkQWZ0ZXJVcmdMYXRlbmN5UGl4ZWxN
aXhlZFdpdGhWTURhdGEsCisJCWRvdWJsZSBQZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQ
b3J0QldSZWNlaXZlZEFmdGVyVXJnTGF0ZW5jeVZNRGF0YU9ubHksCisJCVBpcGUgKm15UGlwZSwK
KwkJdW5zaWduZWQgaW50IERTQ0RlbGF5LAorCQlkb3VibGUgRFBQQ0xLRGVsYXlTdWJ0b3RhbCwK
KwkJZG91YmxlIERQUENMS0RlbGF5U0NMLAorCQlkb3VibGUgRFBQQ0xLRGVsYXlTQ0xMQk9ubHks
CisJCWRvdWJsZSBEUFBDTEtEZWxheUNOVkNGb3JtYXRlciwKKwkJZG91YmxlIERQUENMS0RlbGF5
Q05WQ0N1cnNvciwKKwkJZG91YmxlIERJU1BDTEtEZWxheVN1YnRvdGFsLAorCQl1bnNpZ25lZCBp
bnQgU2NhbGVyUmVjb3V0V2lkdGgsCisJCWVudW0gb3V0cHV0X2Zvcm1hdF9jbGFzcyBPdXRwdXRG
b3JtYXQsCisJCXVuc2lnbmVkIGludCBNYXhJbnRlckRDTlRpbGVSZXBlYXRlcnMsCisJCXVuc2ln
bmVkIGludCBWU3RhcnR1cCwKKwkJdW5zaWduZWQgaW50IE1heFZTdGFydHVwLAorCQl1bnNpZ25l
ZCBpbnQgR1BVVk1QYWdlVGFibGVMZXZlbHMsCisJCWJvb2wgR1BVVk1FbmFibGUsCisJCUhvc3RW
TSAqbXlIb3N0Vk0sCisJCWJvb2wgRHluYW1pY01ldGFkYXRhRW5hYmxlLAorCQlpbnQgRHluYW1p
Y01ldGFkYXRhTGluZXNCZWZvcmVBY3RpdmVSZXF1aXJlZCwKKwkJdW5zaWduZWQgaW50IER5bmFt
aWNNZXRhZGF0YVRyYW5zbWl0dGVkQnl0ZXMsCisJCWJvb2wgRENDRW5hYmxlLAorCQlkb3VibGUg
VXJnZW50TGF0ZW5jeSwKKwkJZG91YmxlIFVyZ2VudEV4dHJhTGF0ZW5jeSwKKwkJZG91YmxlIFRD
YWxjLAorCQl1bnNpZ25lZCBpbnQgUERFQW5kTWV0YVBURUJ5dGVzRnJhbWUsCisJCXVuc2lnbmVk
IGludCBNZXRhUm93Qnl0ZSwKKwkJdW5zaWduZWQgaW50IFBpeGVsUFRFQnl0ZXNQZXJSb3csCisJ
CWRvdWJsZSBQcmVmZXRjaFNvdXJjZUxpbmVzWSwKKwkJdW5zaWduZWQgaW50IFN3YXRoV2lkdGhZ
LAorCQlkb3VibGUgQnl0ZVBlclBpeGVsREVUWSwKKwkJZG91YmxlIFZJbml0UHJlRmlsbFksCisJ
CXVuc2lnbmVkIGludCBNYXhOdW1Td2F0aFksCisJCWRvdWJsZSBQcmVmZXRjaFNvdXJjZUxpbmVz
QywKKwkJZG91YmxlIEJ5dGVQZXJQaXhlbERFVEMsCisJCWRvdWJsZSBWSW5pdFByZUZpbGxDLAor
CQl1bnNpZ25lZCBpbnQgTWF4TnVtU3dhdGhDLAorCQl1bnNpZ25lZCBpbnQgU3dhdGhIZWlnaHRZ
LAorCQl1bnNpZ25lZCBpbnQgU3dhdGhIZWlnaHRDLAorCQlkb3VibGUgVFdhaXQsCisJCWJvb2wg
WEZDRW5hYmxlZCwKKwkJZG91YmxlIFhGQ1JlbW90ZVN1cmZhY2VGbGlwRGVsYXksCisJCWJvb2wg
UHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCwKKwkJZG91YmxlICpEU1RYQWZ0ZXJTY2Fs
ZXIsCisJCWRvdWJsZSAqRFNUWUFmdGVyU2NhbGVyLAorCQlkb3VibGUgKkRlc3RpbmF0aW9uTGlu
ZXNGb3JQcmVmZXRjaCwKKwkJZG91YmxlICpQcmVmZXRjaEJhbmR3aWR0aCwKKwkJZG91YmxlICpE
ZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JblZCbGFuaywKKwkJZG91YmxlICpEZXN0aW5hdGlv
bkxpbmVzVG9SZXF1ZXN0Um93SW5WQmxhbmssCisJCWRvdWJsZSAqVlJhdGlvUHJlZmV0Y2hZLAor
CQlkb3VibGUgKlZSYXRpb1ByZWZldGNoQywKKwkJZG91YmxlICpSZXF1aXJlZFByZWZldGNoUGl4
RGF0YUJXTHVtYSwKKwkJZG91YmxlICpSZXF1aXJlZFByZWZldGNoUGl4RGF0YUJXQ2hyb21hLAor
CQl1bnNpZ25lZCBpbnQgKlZTdGFydHVwUmVxdWlyZWRXaGVuTm90RW5vdWdoVGltZUZvckR5bmFt
aWNNZXRhZGF0YSwKKwkJZG91YmxlICpUbm9fYncsCisJCWRvdWJsZSAqcHJlZmV0Y2hfdm1yb3df
YncsCisJCXVuc2lnbmVkIGludCAqc3dhdGhfd2lkdGhfbHVtYV91YiwKKwkJdW5zaWduZWQgaW50
ICpzd2F0aF93aWR0aF9jaHJvbWFfdWIsCisJCXVuc2lnbmVkIGludCAqVlVwZGF0ZU9mZnNldFBp
eCwKKwkJZG91YmxlICpWVXBkYXRlV2lkdGhQaXgsCisJCWRvdWJsZSAqVlJlYWR5T2Zmc2V0UGl4
KQoreworCWJvb2wgTXlFcnJvciA9IGZhbHNlOworCXVuc2lnbmVkIGludCBEUFBDeWNsZXMsIERJ
U1BDTEtDeWNsZXM7CisJZG91YmxlIERTVFRvdGFsUGl4ZWxzQWZ0ZXJTY2FsZXIsIFRvdGFsUmVw
ZWF0ZXJEZWxheVRpbWU7CisJZG91YmxlIFRkbSwgTGluZVRpbWUsIFRzZXR1cDsKKwlkb3VibGUg
ZHN0X3lfcHJlZmV0Y2hfZXF1OworCWRvdWJsZSBUc3dfb3RvOworCWRvdWJsZSBwcmVmZXRjaF9i
d19vdG87CisJZG91YmxlIFR2bV9vdG87CisJZG91YmxlIFRyMF9vdG87CisJZG91YmxlIFR2bV9v
dG9fbGluZXM7CisJZG91YmxlIFRyMF9vdG9fbGluZXM7CisJZG91YmxlIFRzd19vdG9fbGluZXM7
CisJZG91YmxlIGRzdF95X3ByZWZldGNoX290bzsKKwlkb3VibGUgVGltZUZvckZldGNoaW5nTWV0
YVBURSA9IDA7CisJZG91YmxlIFRpbWVGb3JGZXRjaGluZ1Jvd0luVkJsYW5rID0gMDsKKwlkb3Vi
bGUgTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0YSA9IDA7CisJZG91YmxlIEhvc3RWTUlu
ZWZmaWNpZW5jeUZhY3RvcjsKKwl1bnNpZ25lZCBpbnQgSG9zdFZNRHluYW1pY0xldmVsczsKKwor
CWlmIChHUFVWTUVuYWJsZSA9PSB0cnVlICYmIG15SG9zdFZNLT5FbmFibGUgPT0gdHJ1ZSkgewor
CQlIb3N0Vk1JbmVmZmljaWVuY3lGYWN0b3IgPQorCQkJCVBlcmNlbnRPZklkZWFsRFJBTUZhYnJp
Y0FuZFNEUFBvcnRCV1JlY2VpdmVkQWZ0ZXJVcmdMYXRlbmN5UGl4ZWxNaXhlZFdpdGhWTURhdGEK
KwkJCQkJCS8gUGVyY2VudE9mSWRlYWxEUkFNRmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRl
clVyZ0xhdGVuY3lWTURhdGFPbmx5OworCQlIb3N0Vk1EeW5hbWljTGV2ZWxzID0gbXlIb3N0Vk0t
Pk1heFBhZ2VUYWJsZUxldmVscworCQkJCS0gbXlIb3N0Vk0tPkNhY2hlZFBhZ2VUYWJsZUxldmVs
czsKKwl9IGVsc2UgeworCQlIb3N0Vk1JbmVmZmljaWVuY3lGYWN0b3IgPSAxOworCQlIb3N0Vk1E
eW5hbWljTGV2ZWxzID0gMDsKKwl9CisKKwlpZiAobXlQaXBlLT5TY2FsZXJFbmFibGVkKQorCQlE
UFBDeWNsZXMgPSBEUFBDTEtEZWxheVN1YnRvdGFsICsgRFBQQ0xLRGVsYXlTQ0w7CisJZWxzZQor
CQlEUFBDeWNsZXMgPSBEUFBDTEtEZWxheVN1YnRvdGFsICsgRFBQQ0xLRGVsYXlTQ0xMQk9ubHk7
CisKKwlEUFBDeWNsZXMgPSBEUFBDeWNsZXMgKyBEUFBDTEtEZWxheUNOVkNGb3JtYXRlciArIG15
UGlwZS0+TnVtYmVyT2ZDdXJzb3JzICogRFBQQ0xLRGVsYXlDTlZDQ3Vyc29yOworCisJRElTUENM
S0N5Y2xlcyA9IERJU1BDTEtEZWxheVN1YnRvdGFsOworCisJaWYgKG15UGlwZS0+RFBQQ0xLID09
IDAuMCB8fCBteVBpcGUtPkRJU1BDTEsgPT0gMC4wKQorCQlyZXR1cm4gdHJ1ZTsKKworCSpEU1RY
QWZ0ZXJTY2FsZXIgPSBEUFBDeWNsZXMgKiBteVBpcGUtPlBpeGVsQ2xvY2sgLyBteVBpcGUtPkRQ
UENMSworCQkJKyBESVNQQ0xLQ3ljbGVzICogbXlQaXBlLT5QaXhlbENsb2NrIC8gbXlQaXBlLT5E
SVNQQ0xLICsgRFNDRGVsYXk7CisKKwlpZiAobXlQaXBlLT5EUFBQZXJQbGFuZSA+IDEpCisJCSpE
U1RYQWZ0ZXJTY2FsZXIgPSAqRFNUWEFmdGVyU2NhbGVyICsgU2NhbGVyUmVjb3V0V2lkdGg7CisK
KwlpZiAoT3V0cHV0Rm9ybWF0ID09IGRtXzQyMCB8fCAobXlQaXBlLT5JbnRlcmxhY2VFbmFibGUg
JiYgUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCkpCisJCSpEU1RZQWZ0ZXJTY2FsZXIg
PSAxOworCWVsc2UKKwkJKkRTVFlBZnRlclNjYWxlciA9IDA7CisKKwlEU1RUb3RhbFBpeGVsc0Fm
dGVyU2NhbGVyID0gKChkb3VibGUpICgqRFNUWUFmdGVyU2NhbGVyICogbXlQaXBlLT5IVG90YWwp
KSArICpEU1RYQWZ0ZXJTY2FsZXI7CisJKkRTVFlBZnRlclNjYWxlciA9IGRtbF9mbG9vcihEU1RU
b3RhbFBpeGVsc0FmdGVyU2NhbGVyIC8gbXlQaXBlLT5IVG90YWwsIDEpOworCSpEU1RYQWZ0ZXJT
Y2FsZXIgPSBEU1RUb3RhbFBpeGVsc0FmdGVyU2NhbGVyIC0gKChkb3VibGUpICgqRFNUWUFmdGVy
U2NhbGVyICogbXlQaXBlLT5IVG90YWwpKTsKKworCSpWVXBkYXRlT2Zmc2V0UGl4ID0gZG1sX2Nl
aWwobXlQaXBlLT5IVG90YWwgLyA0LjAsIDEpOworCVRvdGFsUmVwZWF0ZXJEZWxheVRpbWUgPSBN
YXhJbnRlckRDTlRpbGVSZXBlYXRlcnMgKiAoMi4wIC8gbXlQaXBlLT5EUFBDTEsgKyAzLjAgLyBt
eVBpcGUtPkRJU1BDTEspOworCSpWVXBkYXRlV2lkdGhQaXggPSAoMTQuMCAvIG15UGlwZS0+RENG
Q0xLRGVlcFNsZWVwICsgMTIuMCAvIG15UGlwZS0+RFBQQ0xLICsgVG90YWxSZXBlYXRlckRlbGF5
VGltZSkKKwkJCSogbXlQaXBlLT5QaXhlbENsb2NrOworCisJKlZSZWFkeU9mZnNldFBpeCA9IGRt
bF9tYXgoCisJCQkxNTAuMCAvIG15UGlwZS0+RFBQQ0xLLAorCQkJVG90YWxSZXBlYXRlckRlbGF5
VGltZSArIDIwLjAgLyBteVBpcGUtPkRDRkNMS0RlZXBTbGVlcCArIDEwLjAgLyBteVBpcGUtPkRQ
UENMSykKKwkJCSogbXlQaXBlLT5QaXhlbENsb2NrOworCisJVHNldHVwID0gKGRvdWJsZSkgKCpW
VXBkYXRlT2Zmc2V0UGl4ICsgKlZVcGRhdGVXaWR0aFBpeCArICpWUmVhZHlPZmZzZXRQaXgpIC8g
bXlQaXBlLT5QaXhlbENsb2NrOworCisJTGluZVRpbWUgPSAoZG91YmxlKSBteVBpcGUtPkhUb3Rh
bCAvIG15UGlwZS0+UGl4ZWxDbG9jazsKKworCWlmIChEeW5hbWljTWV0YWRhdGFFbmFibGUpIHsK
KwkJZG91YmxlIFRkbWJmLCBUZG1lYywgVGRtc2tzOworCisJCVRkbSA9IGRtbF9tYXgoMC4wLCBV
cmdlbnRFeHRyYUxhdGVuY3kgLSBUQ2FsYyk7CisJCVRkbWJmID0gRHluYW1pY01ldGFkYXRhVHJh
bnNtaXR0ZWRCeXRlcyAvIDQuMCAvIG15UGlwZS0+RElTUENMSzsKKwkJVGRtZWMgPSBMaW5lVGlt
ZTsKKwkJaWYgKER5bmFtaWNNZXRhZGF0YUxpbmVzQmVmb3JlQWN0aXZlUmVxdWlyZWQgPT0gLTEp
CisJCQlUZG1za3MgPSBteVBpcGUtPlZCbGFuayAqIExpbmVUaW1lIC8gMi4wOworCQllbHNlCisJ
CQlUZG1za3MgPSBEeW5hbWljTWV0YWRhdGFMaW5lc0JlZm9yZUFjdGl2ZVJlcXVpcmVkICogTGlu
ZVRpbWU7CisJCWlmIChteVBpcGUtPkludGVybGFjZUVuYWJsZSAmJiAhUHJvZ3Jlc3NpdmVUb0lu
dGVybGFjZVVuaXRJbk9QUCkKKwkJCVRkbXNrcyA9IFRkbXNrcyAvIDI7CisJCWlmIChWU3RhcnR1
cCAqIExpbmVUaW1lCisJCQkJPCBUc2V0dXAgKyBUV2FpdCArIFVyZ2VudEV4dHJhTGF0ZW5jeSAr
IFRkbWJmICsgVGRtZWMgKyBUZG1za3MpIHsKKwkJCU15RXJyb3IgPSB0cnVlOworCQkJKlZTdGFy
dHVwUmVxdWlyZWRXaGVuTm90RW5vdWdoVGltZUZvckR5bmFtaWNNZXRhZGF0YSA9IChUc2V0dXAg
KyBUV2FpdAorCQkJCQkrIFVyZ2VudEV4dHJhTGF0ZW5jeSArIFRkbWJmICsgVGRtZWMgKyBUZG1z
a3MpIC8gTGluZVRpbWU7CisJCX0gZWxzZQorCQkJKlZTdGFydHVwUmVxdWlyZWRXaGVuTm90RW5v
dWdoVGltZUZvckR5bmFtaWNNZXRhZGF0YSA9IDAuMDsKKwl9IGVsc2UKKwkJVGRtID0gMDsKKwor
CWlmIChHUFVWTUVuYWJsZSkgeworCQlpZiAoR1BVVk1QYWdlVGFibGVMZXZlbHMgPj0gMykKKwkJ
CSpUbm9fYncgPSBVcmdlbnRFeHRyYUxhdGVuY3kgKyBVcmdlbnRMYXRlbmN5ICogKChHUFVWTVBh
Z2VUYWJsZUxldmVscyAtIDIpICogKG15SG9zdFZNLT5NYXhQYWdlVGFibGVMZXZlbHMgKyAxKSAt
IDEpOworCQllbHNlCisJCQkqVG5vX2J3ID0gMDsKKwl9IGVsc2UgaWYgKCFEQ0NFbmFibGUpCisJ
CSpUbm9fYncgPSBMaW5lVGltZTsKKwllbHNlCisJCSpUbm9fYncgPSBMaW5lVGltZSAvIDQ7CisK
Kwlkc3RfeV9wcmVmZXRjaF9lcXUgPSBWU3RhcnR1cCAtIGRtbF9tYXgoVENhbGMgKyBUV2FpdCwg
WEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSkgLyBMaW5lVGltZQorCQkJLSAoVHNldHVwICsgVGRt
KSAvIExpbmVUaW1lCisJCQktICgqRFNUWUFmdGVyU2NhbGVyICsgKkRTVFhBZnRlclNjYWxlciAv
IG15UGlwZS0+SFRvdGFsKTsKKworCVRzd19vdG8gPSBkbWxfbWF4KFByZWZldGNoU291cmNlTGlu
ZXNZLCBQcmVmZXRjaFNvdXJjZUxpbmVzQykgKiBMaW5lVGltZTsKKworCWlmIChteVBpcGUtPlNv
dXJjZVNjYW4gPT0gZG1faG9yeikgeworCQkqc3dhdGhfd2lkdGhfbHVtYV91YiA9IGRtbF9jZWls
KFN3YXRoV2lkdGhZIC0gMSwgbXlQaXBlLT5CbG9ja1dpZHRoMjU2Qnl0ZXNZKSArIG15UGlwZS0+
QmxvY2tXaWR0aDI1NkJ5dGVzWTsKKwkJKnN3YXRoX3dpZHRoX2Nocm9tYV91YiA9IGRtbF9jZWls
KFN3YXRoV2lkdGhZIC8gMiAtIDEsIG15UGlwZS0+QmxvY2tXaWR0aDI1NkJ5dGVzQykgKyBteVBp
cGUtPkJsb2NrV2lkdGgyNTZCeXRlc0M7CisJfSBlbHNlIHsKKwkJKnN3YXRoX3dpZHRoX2x1bWFf
dWIgPSBkbWxfY2VpbChTd2F0aFdpZHRoWSAtIDEsIG15UGlwZS0+QmxvY2tIZWlnaHQyNTZCeXRl
c1kpICsgbXlQaXBlLT5CbG9ja0hlaWdodDI1NkJ5dGVzWTsKKwkJKnN3YXRoX3dpZHRoX2Nocm9t
YV91YiA9IGRtbF9jZWlsKFN3YXRoV2lkdGhZIC8gMiAtIDEsIG15UGlwZS0+QmxvY2tIZWlnaHQy
NTZCeXRlc0MpICsgbXlQaXBlLT5CbG9ja0hlaWdodDI1NkJ5dGVzQzsKKwl9CisKKwlwcmVmZXRj
aF9id19vdG8gPSAoUHJlZmV0Y2hTb3VyY2VMaW5lc1kgKiAqc3dhdGhfd2lkdGhfbHVtYV91YiAq
IGRtbF9jZWlsKEJ5dGVQZXJQaXhlbERFVFksIDEpICsgUHJlZmV0Y2hTb3VyY2VMaW5lc0MgKiAq
c3dhdGhfd2lkdGhfY2hyb21hX3ViICogZG1sX2NlaWwoQnl0ZVBlclBpeGVsREVUQywgMikpIC8g
VHN3X290bzsKKworCisJaWYgKEdQVVZNRW5hYmxlID09IHRydWUpIHsKKwkJVHZtX290byA9IGRt
bF9tYXgoKlRub19idyArIFBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lICogSG9zdFZNSW5lZmZpY2ll
bmN5RmFjdG9yIC8gcHJlZmV0Y2hfYndfb3RvLAorCQkJCWRtbF9tYXgoVXJnZW50RXh0cmFMYXRl
bmN5ICsgVXJnZW50TGF0ZW5jeSAqIChHUFVWTVBhZ2VUYWJsZUxldmVscyAqIChIb3N0Vk1EeW5h
bWljTGV2ZWxzICsgMSkgLSAxKSwKKwkJCQkJTGluZVRpbWUgLyA0LjApKTsKKwl9IGVsc2UKKwkJ
VHZtX290byA9IExpbmVUaW1lIC8gNC4wOworCisJaWYgKChHUFVWTUVuYWJsZSA9PSB0cnVlIHx8
IERDQ0VuYWJsZSA9PSB0cnVlKSkgeworCQlUcjBfb3RvID0gZG1sX21heCgKKwkJCQkoTWV0YVJv
d0J5dGUgKyBQaXhlbFBURUJ5dGVzUGVyUm93ICogSG9zdFZNSW5lZmZpY2llbmN5RmFjdG9yKSAv
IHByZWZldGNoX2J3X290bywKKwkJCQlkbWxfbWF4KFVyZ2VudExhdGVuY3kgKiAoSG9zdFZNRHlu
YW1pY0xldmVscyArIDEpLCBkbWxfbWF4KExpbmVUaW1lIC0gVHZtX290bywgTGluZVRpbWUgLyA0
KSkpOworCX0gZWxzZQorCQlUcjBfb3RvID0gKExpbmVUaW1lIC0gVHZtX290bykgLyAyLjA7CisK
KwlUdm1fb3RvX2xpbmVzID0gZG1sX2NlaWwoNCAqIFR2bV9vdG8gLyBMaW5lVGltZSwgMSkgLyA0
LjA7CisJVHIwX290b19saW5lcyA9IGRtbF9jZWlsKDQgKiBUcjBfb3RvIC8gTGluZVRpbWUsIDEp
IC8gNC4wOworCVRzd19vdG9fbGluZXMgPSBkbWxfY2VpbCg0ICogVHN3X290byAvIExpbmVUaW1l
LCAxKSAvIDQuMDsKKwlkc3RfeV9wcmVmZXRjaF9vdG8gPSBUdm1fb3RvX2xpbmVzICsgMiAqIFRy
MF9vdG9fbGluZXMgKyBUc3dfb3RvX2xpbmVzICsgMC43NTsKKworCWRzdF95X3ByZWZldGNoX2Vx
dSA9IGRtbF9mbG9vcig0LjAgKiAoZHN0X3lfcHJlZmV0Y2hfZXF1ICsgMC4xMjUpLCAxKSAvIDQu
MDsKKworCWlmIChkc3RfeV9wcmVmZXRjaF9vdG8gPCBkc3RfeV9wcmVmZXRjaF9lcXUpCisJCSpE
ZXN0aW5hdGlvbkxpbmVzRm9yUHJlZmV0Y2ggPSBkc3RfeV9wcmVmZXRjaF9vdG87CisJZWxzZQor
CQkqRGVzdGluYXRpb25MaW5lc0ZvclByZWZldGNoID0gZHN0X3lfcHJlZmV0Y2hfZXF1OworCisJ
ZG1sX3ByaW50KCJETUw6IFZTdGFydHVwOiAlZFxuIiwgVlN0YXJ0dXApOworCWRtbF9wcmludCgi
RE1MOiBUQ2FsYzogJWZcbiIsIFRDYWxjKTsKKwlkbWxfcHJpbnQoIkRNTDogVFdhaXQ6ICVmXG4i
LCBUV2FpdCk7CisJZG1sX3ByaW50KCJETUw6IFhGQ1JlbW90ZVN1cmZhY2VGbGlwRGVsYXk6ICVm
XG4iLCBYRkNSZW1vdGVTdXJmYWNlRmxpcERlbGF5KTsKKwlkbWxfcHJpbnQoIkRNTDogTGluZVRp
bWU6ICVmXG4iLCBMaW5lVGltZSk7CisJZG1sX3ByaW50KCJETUw6IFRzZXR1cDogJWZcbiIsIFRz
ZXR1cCk7CisJZG1sX3ByaW50KCJETUw6IFRkbTogJWZcbiIsIFRkbSk7CisJZG1sX3ByaW50KCJE
TUw6IERTVFlBZnRlclNjYWxlcjogJWZcbiIsICpEU1RZQWZ0ZXJTY2FsZXIpOworCWRtbF9wcmlu
dCgiRE1MOiBEU1RYQWZ0ZXJTY2FsZXI6ICVmXG4iLCAqRFNUWEFmdGVyU2NhbGVyKTsKKwlkbWxf
cHJpbnQoIkRNTDogSFRvdGFsOiAlZFxuIiwgbXlQaXBlLT5IVG90YWwpOworCisJKlByZWZldGNo
QmFuZHdpZHRoID0gMDsKKwkqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxhbmsgPSAw
OworCSpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5WQmxhbmsgPSAwOworCSpWUmF0aW9Q
cmVmZXRjaFkgPSAwOworCSpWUmF0aW9QcmVmZXRjaEMgPSAwOworCSpSZXF1aXJlZFByZWZldGNo
UGl4RGF0YUJXTHVtYSA9IDA7CisJaWYgKCpEZXN0aW5hdGlvbkxpbmVzRm9yUHJlZmV0Y2ggPiAx
KSB7CisJCWRvdWJsZSBQcmVmZXRjaEJhbmR3aWR0aDEgPSAoUERFQW5kTWV0YVBURUJ5dGVzRnJh
bWUgKiBIb3N0Vk1JbmVmZmljaWVuY3lGYWN0b3IgKyAyICogTWV0YVJvd0J5dGUKKwkJCQkrIDIg
KiBQaXhlbFBURUJ5dGVzUGVyUm93ICogSG9zdFZNSW5lZmZpY2llbmN5RmFjdG9yCisJCQkJKyBQ
cmVmZXRjaFNvdXJjZUxpbmVzWSAqICpzd2F0aF93aWR0aF9sdW1hX3ViICogZG1sX2NlaWwoQnl0
ZVBlclBpeGVsREVUWSwgMSkKKwkJCQkrIFByZWZldGNoU291cmNlTGluZXNDICogKnN3YXRoX3dp
ZHRoX2Nocm9tYV91YiAqIGRtbF9jZWlsKEJ5dGVQZXJQaXhlbERFVEMsIDIpKQorCQkJCS8gKCpE
ZXN0aW5hdGlvbkxpbmVzRm9yUHJlZmV0Y2ggKiBMaW5lVGltZSAtICpUbm9fYncpOworCisJCWRv
dWJsZSBQcmVmZXRjaEJhbmR3aWR0aDIgPSAoUERFQW5kTWV0YVBURUJ5dGVzRnJhbWUgKgorCQkJ
CUhvc3RWTUluZWZmaWNpZW5jeUZhY3RvciArIFByZWZldGNoU291cmNlTGluZXNZICoKKwkJCQkq
c3dhdGhfd2lkdGhfbHVtYV91YiAqIGRtbF9jZWlsKEJ5dGVQZXJQaXhlbERFVFksIDEpICsKKwkJ
CQlQcmVmZXRjaFNvdXJjZUxpbmVzQyAqICpzd2F0aF93aWR0aF9jaHJvbWFfdWIgKgorCQkJCWRt
bF9jZWlsKEJ5dGVQZXJQaXhlbERFVEMsIDIpKSAvCisJCQkJKCpEZXN0aW5hdGlvbkxpbmVzRm9y
UHJlZmV0Y2ggKiBMaW5lVGltZSAtICpUbm9fYncgLSAyICoKKwkJCQlVcmdlbnRMYXRlbmN5ICog
KDEgKyBIb3N0Vk1EeW5hbWljTGV2ZWxzKSk7CisKKwkJZG91YmxlIFByZWZldGNoQmFuZHdpZHRo
MyA9ICgyICogTWV0YVJvd0J5dGUgKyAyICogUGl4ZWxQVEVCeXRlc1BlclJvdworCQkJCSogSG9z
dFZNSW5lZmZpY2llbmN5RmFjdG9yICsgUHJlZmV0Y2hTb3VyY2VMaW5lc1kgKgorCQkJCSpzd2F0
aF93aWR0aF9sdW1hX3ViICogZG1sX2NlaWwoQnl0ZVBlclBpeGVsREVUWSwgMSkgKworCQkJCVBy
ZWZldGNoU291cmNlTGluZXNDICogKnN3YXRoX3dpZHRoX2Nocm9tYV91YiAqCisJCQkJZG1sX2Nl
aWwoQnl0ZVBlclBpeGVsREVUQywgMikpIC8KKwkJCQkoKkRlc3RpbmF0aW9uTGluZXNGb3JQcmVm
ZXRjaCAqIExpbmVUaW1lIC0KKwkJCQlVcmdlbnRFeHRyYUxhdGVuY3kgLSBVcmdlbnRMYXRlbmN5
ICogKEdQVVZNUGFnZVRhYmxlTGV2ZWxzCisJCQkJKiAoSG9zdFZNRHluYW1pY0xldmVscyArIDEp
IC0gMSkpOworCisJCWRvdWJsZSBQcmVmZXRjaEJhbmR3aWR0aDQgPSAoUHJlZmV0Y2hTb3VyY2VM
aW5lc1kgKiAqc3dhdGhfd2lkdGhfbHVtYV91YiAqCisJCQkJZG1sX2NlaWwoQnl0ZVBlclBpeGVs
REVUWSwgMSkgKyBQcmVmZXRjaFNvdXJjZUxpbmVzQyAqCisJCQkJKnN3YXRoX3dpZHRoX2Nocm9t
YV91YiAqIGRtbF9jZWlsKEJ5dGVQZXJQaXhlbERFVEMsIDIpKSAvCisJCQkJKCpEZXN0aW5hdGlv
bkxpbmVzRm9yUHJlZmV0Y2ggKiBMaW5lVGltZSAtCisJCQkJVXJnZW50RXh0cmFMYXRlbmN5IC0g
VXJnZW50TGF0ZW5jeSAqIChHUFVWTVBhZ2VUYWJsZUxldmVscworCQkJCSogKEhvc3RWTUR5bmFt
aWNMZXZlbHMgKyAxKSAtIDEpIC0gMiAqIFVyZ2VudExhdGVuY3kgKgorCQkJCSgxICsgSG9zdFZN
RHluYW1pY0xldmVscykpOworCisJCWlmIChWU3RhcnR1cCA9PSBNYXhWU3RhcnR1cCAmJiAoUHJl
ZmV0Y2hCYW5kd2lkdGgxID4gNCAqIHByZWZldGNoX2J3X290bykgJiYgKCpEZXN0aW5hdGlvbkxp
bmVzRm9yUHJlZmV0Y2ggLSBkbWxfY2VpbChUc3dfb3RvX2xpbmVzLCAxKSAvIDQuMCAtIDAuNzUp
ICogTGluZVRpbWUgLSAqVG5vX2J3ID4gMCkgeworCQkJUHJlZmV0Y2hCYW5kd2lkdGgxID0gKFBE
RUFuZE1ldGFQVEVCeXRlc0ZyYW1lICogSG9zdFZNSW5lZmZpY2llbmN5RmFjdG9yICsgMiAqIE1l
dGFSb3dCeXRlICsgMiAqIFBpeGVsUFRFQnl0ZXNQZXJSb3cgKiBIb3N0Vk1JbmVmZmljaWVuY3lG
YWN0b3IpIC8gKCgqRGVzdGluYXRpb25MaW5lc0ZvclByZWZldGNoIC0gZG1sX2NlaWwoVHN3X290
b19saW5lcywgMSkgLyA0LjAgLSAwLjc1KSAqIExpbmVUaW1lIC0gKlRub19idyk7CisJCX0KKwkJ
aWYgKCpUbm9fYncgKyBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZSAqIEhvc3RWTUluZWZmaWNpZW5j
eUZhY3RvciAvIFByZWZldGNoQmFuZHdpZHRoMSA+PSBVcmdlbnRFeHRyYUxhdGVuY3kgKyBVcmdl
bnRMYXRlbmN5ICogKEdQVVZNUGFnZVRhYmxlTGV2ZWxzICogKEhvc3RWTUR5bmFtaWNMZXZlbHMg
KyAxKSAtIDEpICYmIChNZXRhUm93Qnl0ZSArIFBpeGVsUFRFQnl0ZXNQZXJSb3cgKiBIb3N0Vk1J
bmVmZmljaWVuY3lGYWN0b3IpIC8gUHJlZmV0Y2hCYW5kd2lkdGgxID49IFVyZ2VudExhdGVuY3kg
KiAoMSArIEhvc3RWTUR5bmFtaWNMZXZlbHMpKSB7CisJCQkqUHJlZmV0Y2hCYW5kd2lkdGggPSBQ
cmVmZXRjaEJhbmR3aWR0aDE7CisJCX0gZWxzZSBpZiAoKlRub19idyArIFBERUFuZE1ldGFQVEVC
eXRlc0ZyYW1lICogSG9zdFZNSW5lZmZpY2llbmN5RmFjdG9yIC8gUHJlZmV0Y2hCYW5kd2lkdGgy
ID49IFVyZ2VudEV4dHJhTGF0ZW5jeSArIFVyZ2VudExhdGVuY3kgKiAoR1BVVk1QYWdlVGFibGVM
ZXZlbHMgKiAoSG9zdFZNRHluYW1pY0xldmVscyArIDEpIC0gMSkgJiYgKE1ldGFSb3dCeXRlICsg
UGl4ZWxQVEVCeXRlc1BlclJvdyAqIEhvc3RWTUluZWZmaWNpZW5jeUZhY3RvcikgLyBQcmVmZXRj
aEJhbmR3aWR0aDIgPCBVcmdlbnRMYXRlbmN5ICogKDEgKyBIb3N0Vk1EeW5hbWljTGV2ZWxzKSkg
eworCQkJKlByZWZldGNoQmFuZHdpZHRoID0gUHJlZmV0Y2hCYW5kd2lkdGgyOworCQl9IGVsc2Ug
aWYgKCpUbm9fYncgKyBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZSAqIEhvc3RWTUluZWZmaWNpZW5j
eUZhY3RvciAvIFByZWZldGNoQmFuZHdpZHRoMyA8IFVyZ2VudEV4dHJhTGF0ZW5jeSArIFVyZ2Vu
dExhdGVuY3kgKiAoR1BVVk1QYWdlVGFibGVMZXZlbHMgKiAoSG9zdFZNRHluYW1pY0xldmVscyAr
IDEpIC0gMSkgJiYgKE1ldGFSb3dCeXRlICsgUGl4ZWxQVEVCeXRlc1BlclJvdyAqIEhvc3RWTUlu
ZWZmaWNpZW5jeUZhY3RvcikgLyBQcmVmZXRjaEJhbmR3aWR0aDMgPj0gVXJnZW50TGF0ZW5jeSAq
ICgxICsgSG9zdFZNRHluYW1pY0xldmVscykpIHsKKwkJCSpQcmVmZXRjaEJhbmR3aWR0aCA9IFBy
ZWZldGNoQmFuZHdpZHRoMzsKKwkJfSBlbHNlIHsKKwkJCSpQcmVmZXRjaEJhbmR3aWR0aCA9IFBy
ZWZldGNoQmFuZHdpZHRoNDsKKwkJfQorCisJCWlmIChHUFVWTUVuYWJsZSkgeworCQkJVGltZUZv
ckZldGNoaW5nTWV0YVBURSA9IGRtbF9tYXgoKlRub19idyArIChkb3VibGUpIFBERUFuZE1ldGFQ
VEVCeXRlc0ZyYW1lICogSG9zdFZNSW5lZmZpY2llbmN5RmFjdG9yIC8gKlByZWZldGNoQmFuZHdp
ZHRoLAorCQkJCQlkbWxfbWF4KFVyZ2VudEV4dHJhTGF0ZW5jeSArIFVyZ2VudExhdGVuY3kgKiAo
R1BVVk1QYWdlVGFibGVMZXZlbHMgKiAoSG9zdFZNRHluYW1pY0xldmVscyArIDEpIC0gMSksIExp
bmVUaW1lIC8gNCkpOworCQl9IGVsc2UgeworLy8gNS8zMC8yMDE4IC0gVGhpcyB3YXMgYW4gb3B0
aW1pemF0aW9uIHJlcXVlc3RlZCBmcm9tIFN5IGJ1dCBub3cgTnVtYmVyT2ZDdXJzb3JzIGlzIG5v
IGxvbmdlciBhIGZhY3RvcgorLy8gICAgICAgICAgICAgc28gaWYgdGhpcyBuZWVkcyB0byBiZSBy
ZWluc3RhdGVkLCB0aGVuIGl0IHNob3VsZCBiZSBvZmZpY2lhbGx5IGRvbmUgaW4gdGhlIFZCQSBj
b2RlIGFzIHdlbGwuCisvLwkJCWlmIChtb2RlX2xpYi0+TnVtYmVyT2ZDdXJzb3JzID4gMCB8fCBY
RkNFbmFibGVkKQorCQkJCVRpbWVGb3JGZXRjaGluZ01ldGFQVEUgPSBMaW5lVGltZSAvIDQ7Cisv
LwkJCWVsc2UKKy8vCQkJCVRpbWVGb3JGZXRjaGluZ01ldGFQVEUgPSAwLjA7CisJCX0KKworCQlp
ZiAoKEdQVVZNRW5hYmxlID09IHRydWUgfHwgRENDRW5hYmxlID09IHRydWUpKSB7CisJCQlUaW1l
Rm9yRmV0Y2hpbmdSb3dJblZCbGFuayA9CisJCQkJCWRtbF9tYXgoCisJCQkJCQkJKE1ldGFSb3dC
eXRlICsgUGl4ZWxQVEVCeXRlc1BlclJvdyAqIEhvc3RWTUluZWZmaWNpZW5jeUZhY3RvcikKKwkJ
CQkJCQkJCS8gKlByZWZldGNoQmFuZHdpZHRoLAorCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCQlV
cmdlbnRMYXRlbmN5ICogKDEgKyBIb3N0Vk1EeW5hbWljTGV2ZWxzKSwKKwkJCQkJCQkJCWRtbF9t
YXgoCisJCQkJCQkJCQkJCShMaW5lVGltZQorCQkJCQkJCQkJCQkJCS0gVGltZUZvckZldGNoaW5n
TWV0YVBURSkgLyAyLjAsCisJCQkJCQkJCQkJCUxpbmVUaW1lCisJCQkJCQkJCQkJCQkJLyA0LjAp
KSk7CisJCX0gZWxzZSB7CisvLyBTZWUgbm90ZSBhYm92ZSBkYXRlZCA1LzMwLzIwMTgKKy8vCQkJ
aWYgKE51bWJlck9mQ3Vyc29ycyA+IDAgfHwgWEZDRW5hYmxlZCkKKwkJCQlUaW1lRm9yRmV0Y2hp
bmdSb3dJblZCbGFuayA9IChMaW5lVGltZSAtIFRpbWVGb3JGZXRjaGluZ01ldGFQVEUpIC8gMi4w
OworLy8JCQllbHNlIC8vIFRPRE86IERpZCBzb21lb25lIGVsc2UgYWRkIHRoaXM/PworLy8JCQkJ
VGltZUZvckZldGNoaW5nUm93SW5WQmxhbmsgPSAwLjA7CisJCX0KKworCQkqRGVzdGluYXRpb25M
aW5lc1RvUmVxdWVzdFZNSW5WQmxhbmsgPSBkbWxfY2VpbCg0LjAgKiBUaW1lRm9yRmV0Y2hpbmdN
ZXRhUFRFIC8gTGluZVRpbWUsIDEuMCkgLyA0LjA7CisKKwkJKkRlc3RpbmF0aW9uTGluZXNUb1Jl
cXVlc3RSb3dJblZCbGFuayA9IGRtbF9jZWlsKDQuMCAqIFRpbWVGb3JGZXRjaGluZ1Jvd0luVkJs
YW5rIC8gTGluZVRpbWUsIDEuMCkgLyA0LjA7CisKKwkJTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBp
eGVsRGF0YSA9ICpEZXN0aW5hdGlvbkxpbmVzRm9yUHJlZmV0Y2gKKy8vIFNlZSBub3RlIGFib3Zl
IGRhdGVkIDUvMzAvMjAxOAorLy8JCQkJCQktICgoTnVtYmVyT2ZDdXJzb3JzID4gMCB8fCBHUFVW
TUVuYWJsZSB8fCBEQ0NFbmFibGUpID8KKwkJCQkJCS0gKChHUFVWTUVuYWJsZSB8fCBEQ0NFbmFi
bGUpID8KKwkJCQkJCQkJKCpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JblZCbGFuayArIDIg
KiAqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rKSA6CisJCQkJCQkJCTAuMCk7
IC8vIFRPRE86IERpZCBzb21lb25lIGVsc2UgYWRkIHRoaXM/PworCisJCWlmIChMaW5lc1RvUmVx
dWVzdFByZWZldGNoUGl4ZWxEYXRhID4gMCkgeworCisJCQkqVlJhdGlvUHJlZmV0Y2hZID0gKGRv
dWJsZSkgUHJlZmV0Y2hTb3VyY2VMaW5lc1kKKwkJCQkJLyBMaW5lc1RvUmVxdWVzdFByZWZldGNo
UGl4ZWxEYXRhOworCQkJKlZSYXRpb1ByZWZldGNoWSA9IGRtbF9tYXgoKlZSYXRpb1ByZWZldGNo
WSwgMS4wKTsKKwkJCWlmICgoU3dhdGhIZWlnaHRZID4gNCkgJiYgKFZJbml0UHJlRmlsbFkgPiAz
KSkgeworCQkJCWlmIChMaW5lc1RvUmVxdWVzdFByZWZldGNoUGl4ZWxEYXRhID4gKFZJbml0UHJl
RmlsbFkgLSAzLjApIC8gMi4wKSB7CisJCQkJCSpWUmF0aW9QcmVmZXRjaFkgPQorCQkJCQkJCWRt
bF9tYXgoCisJCQkJCQkJCQkoZG91YmxlKSBQcmVmZXRjaFNvdXJjZUxpbmVzWQorCQkJCQkJCQkJ
CQkvIExpbmVzVG9SZXF1ZXN0UHJlZmV0Y2hQaXhlbERhdGEsCisJCQkJCQkJCQkoZG91YmxlKSBN
YXhOdW1Td2F0aFkKKwkJCQkJCQkJCQkJKiBTd2F0aEhlaWdodFkKKwkJCQkJCQkJCQkJLyAoTGlu
ZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0YQorCQkJCQkJCQkJCQkJCS0gKFZJbml0UHJlRmls
bFkKKwkJCQkJCQkJCQkJCQkJCS0gMy4wKQorCQkJCQkJCQkJCQkJCQkJLyAyLjApKTsKKwkJCQkJ
KlZSYXRpb1ByZWZldGNoWSA9IGRtbF9tYXgoKlZSYXRpb1ByZWZldGNoWSwgMS4wKTsKKwkJCQl9
IGVsc2UgeworCQkJCQlNeUVycm9yID0gdHJ1ZTsKKwkJCQkJKlZSYXRpb1ByZWZldGNoWSA9IDA7
CisJCQkJfQorCQkJfQorCisJCQkqVlJhdGlvUHJlZmV0Y2hDID0gKGRvdWJsZSkgUHJlZmV0Y2hT
b3VyY2VMaW5lc0MKKwkJCQkJLyBMaW5lc1RvUmVxdWVzdFByZWZldGNoUGl4ZWxEYXRhOworCQkJ
KlZSYXRpb1ByZWZldGNoQyA9IGRtbF9tYXgoKlZSYXRpb1ByZWZldGNoQywgMS4wKTsKKworCQkJ
aWYgKChTd2F0aEhlaWdodEMgPiA0KSkgeworCQkJCWlmIChMaW5lc1RvUmVxdWVzdFByZWZldGNo
UGl4ZWxEYXRhID4gKFZJbml0UHJlRmlsbEMgLSAzLjApIC8gMi4wKSB7CisJCQkJCSpWUmF0aW9Q
cmVmZXRjaEMgPQorCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCQkqVlJhdGlvUHJlZmV0Y2hDLAor
CQkJCQkJCQkJKGRvdWJsZSkgTWF4TnVtU3dhdGhDCisJCQkJCQkJCQkJCSogU3dhdGhIZWlnaHRD
CisJCQkJCQkJCQkJCS8gKExpbmVzVG9SZXF1ZXN0UHJlZmV0Y2hQaXhlbERhdGEKKwkJCQkJCQkJ
CQkJCQktIChWSW5pdFByZUZpbGxDCisJCQkJCQkJCQkJCQkJCQktIDMuMCkKKwkJCQkJCQkJCQkJ
CQkJCS8gMi4wKSk7CisJCQkJCSpWUmF0aW9QcmVmZXRjaEMgPSBkbWxfbWF4KCpWUmF0aW9QcmVm
ZXRjaEMsIDEuMCk7CisJCQkJfSBlbHNlIHsKKwkJCQkJTXlFcnJvciA9IHRydWU7CisJCQkJCSpW
UmF0aW9QcmVmZXRjaEMgPSAwOworCQkJCX0KKwkJCX0KKworCQkJKlJlcXVpcmVkUHJlZmV0Y2hQ
aXhEYXRhQldMdW1hID0gbXlQaXBlLT5EUFBQZXJQbGFuZQorCQkJCQkqIChkb3VibGUpIFByZWZl
dGNoU291cmNlTGluZXNZIC8gTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0YQorCQkJCQkq
IGRtbF9jZWlsKEJ5dGVQZXJQaXhlbERFVFksIDEpCisJCQkJCSogKnN3YXRoX3dpZHRoX2x1bWFf
dWIgLyBMaW5lVGltZTsKKwkJCSpSZXF1aXJlZFByZWZldGNoUGl4RGF0YUJXQ2hyb21hID0gbXlQ
aXBlLT5EUFBQZXJQbGFuZQorCQkJCQkqIChkb3VibGUpIFByZWZldGNoU291cmNlTGluZXNDIC8g
TGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0YQorCQkJCQkqIGRtbF9jZWlsKEJ5dGVQZXJQ
aXhlbERFVEMsIDIpCisJCQkJCSogKnN3YXRoX3dpZHRoX2Nocm9tYV91YiAvIExpbmVUaW1lOwor
CQl9IGVsc2UgeworCQkJTXlFcnJvciA9IHRydWU7CisJCQkqVlJhdGlvUHJlZmV0Y2hZID0gMDsK
KwkJCSpWUmF0aW9QcmVmZXRjaEMgPSAwOworCQkJKlJlcXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldM
dW1hID0gMDsKKwkJCSpSZXF1aXJlZFByZWZldGNoUGl4RGF0YUJXQ2hyb21hID0gMDsKKwkJfQor
CisJCWRtbF9wcmludCgiRE1MOiBUdm06ICVmdXNcbiIsIFRpbWVGb3JGZXRjaGluZ01ldGFQVEUp
OworCQlkbWxfcHJpbnQoIkRNTDogVHIwOiAlZnVzXG4iLCBUaW1lRm9yRmV0Y2hpbmdSb3dJblZC
bGFuayk7CisJCWRtbF9wcmludCgiRE1MOiBUc3c6ICVmdXNcbiIsIChkb3VibGUpKCpEZXN0aW5h
dGlvbkxpbmVzRm9yUHJlZmV0Y2gpICogTGluZVRpbWUgLSBUaW1lRm9yRmV0Y2hpbmdNZXRhUFRF
IC0gVGltZUZvckZldGNoaW5nUm93SW5WQmxhbmspOworCQlkbWxfcHJpbnQoIkRNTDogVHByZTog
JWZ1c1xuIiwgKGRvdWJsZSkoKkRlc3RpbmF0aW9uTGluZXNGb3JQcmVmZXRjaCkgKiBMaW5lVGlt
ZSk7CisJCWRtbF9wcmludCgiRE1MOiByb3dfYnl0ZXMgPSBkcHRlX3Jvd19ieXRlcyAocGVyX3Bp
cGUpID0gUGl4ZWxQVEVCeXRlc1BlclJvdyA9IDogJWRcbiIsIFBpeGVsUFRFQnl0ZXNQZXJSb3cp
OworCisJfSBlbHNlIHsKKwkJTXlFcnJvciA9IHRydWU7CisJfQorCisJeworCQlkb3VibGUgcHJl
ZmV0Y2hfdm1fYnc7CisJCWRvdWJsZSBwcmVmZXRjaF9yb3dfYnc7CisKKwkJaWYgKFBERUFuZE1l
dGFQVEVCeXRlc0ZyYW1lID09IDApIHsKKwkJCXByZWZldGNoX3ZtX2J3ID0gMDsKKwkJfSBlbHNl
IGlmICgqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxhbmsgPiAwKSB7CisJCQlwcmVm
ZXRjaF92bV9idyA9IFBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lICogSG9zdFZNSW5lZmZpY2llbmN5
RmFjdG9yIC8gKCpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JblZCbGFuayAqIExpbmVUaW1l
KTsKKwkJfSBlbHNlIHsKKwkJCXByZWZldGNoX3ZtX2J3ID0gMDsKKwkJCU15RXJyb3IgPSB0cnVl
OworCQl9CisJCWlmIChNZXRhUm93Qnl0ZSArIFBpeGVsUFRFQnl0ZXNQZXJSb3cgPT0gMCkgewor
CQkJcHJlZmV0Y2hfcm93X2J3ID0gMDsKKwkJfSBlbHNlIGlmICgqRGVzdGluYXRpb25MaW5lc1Rv
UmVxdWVzdFJvd0luVkJsYW5rID4gMCkgeworCQkJcHJlZmV0Y2hfcm93X2J3ID0gKE1ldGFSb3dC
eXRlICsgUGl4ZWxQVEVCeXRlc1BlclJvdyAqIEhvc3RWTUluZWZmaWNpZW5jeUZhY3RvcikgLyAo
KkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJblZCbGFuayAqIExpbmVUaW1lKTsKKwkJfSBl
bHNlIHsKKwkJCXByZWZldGNoX3Jvd19idyA9IDA7CisJCQlNeUVycm9yID0gdHJ1ZTsKKwkJfQor
CisJCSpwcmVmZXRjaF92bXJvd19idyA9IGRtbF9tYXgocHJlZmV0Y2hfdm1fYncsIHByZWZldGNo
X3Jvd19idyk7CisJfQorCisJaWYgKE15RXJyb3IpIHsKKwkJKlByZWZldGNoQmFuZHdpZHRoID0g
MDsKKwkJVGltZUZvckZldGNoaW5nTWV0YVBURSA9IDA7CisJCVRpbWVGb3JGZXRjaGluZ1Jvd0lu
VkJsYW5rID0gMDsKKwkJKkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluVkJsYW5rID0gMDsK
KwkJKkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJblZCbGFuayA9IDA7CisJCSpEZXN0aW5h
dGlvbkxpbmVzRm9yUHJlZmV0Y2ggPSAwOworCQlMaW5lc1RvUmVxdWVzdFByZWZldGNoUGl4ZWxE
YXRhID0gMDsKKwkJKlZSYXRpb1ByZWZldGNoWSA9IDA7CisJCSpWUmF0aW9QcmVmZXRjaEMgPSAw
OworCQkqUmVxdWlyZWRQcmVmZXRjaFBpeERhdGFCV0x1bWEgPSAwOworCQkqUmVxdWlyZWRQcmVm
ZXRjaFBpeERhdGFCV0Nocm9tYSA9IDA7CisJfQorCisJcmV0dXJuIE15RXJyb3I7Cit9CisKK3N0
YXRpYyBkb3VibGUgUm91bmRUb0RGU0dyYW51bGFyaXR5VXAoZG91YmxlIENsb2NrLCBkb3VibGUg
VkNPU3BlZWQpCit7CisJcmV0dXJuIFZDT1NwZWVkICogNCAvIGRtbF9mbG9vcihWQ09TcGVlZCAq
IDQgLyBDbG9jaywgMSk7Cit9CisKK3N0YXRpYyBkb3VibGUgUm91bmRUb0RGU0dyYW51bGFyaXR5
RG93bihkb3VibGUgQ2xvY2ssIGRvdWJsZSBWQ09TcGVlZCkKK3sKKwlyZXR1cm4gVkNPU3BlZWQg
KiA0IC8gZG1sX2NlaWwoVkNPU3BlZWQgKiA0IC8gQ2xvY2ssIDEpOworfQorCitzdGF0aWMgZG91
YmxlIENhbGN1bGF0ZURDQ0NvbmZpZ3VyYXRpb24oCisJCWJvb2wgRENDRW5hYmxlZCwKKwkJYm9v
bCBEQ0NQcm9ncmFtbWluZ0Fzc3VtZXNTY2FuRGlyZWN0aW9uVW5rbm93biwKKwkJdW5zaWduZWQg
aW50IFZpZXdwb3J0V2lkdGgsCisJCXVuc2lnbmVkIGludCBWaWV3cG9ydEhlaWdodCwKKwkJZG91
YmxlIERFVEJ1ZmZlclNpemUsCisJCXVuc2lnbmVkIGludCBSZXF1ZXN0SGVpZ2h0MjU2Qnl0ZSwK
KwkJdW5zaWduZWQgaW50IFN3YXRoSGVpZ2h0LAorCQllbnVtIGRtX3N3aXp6bGVfbW9kZSBUaWxp
bmdGb3JtYXQsCisJCXVuc2lnbmVkIGludCBCeXRlUGVyUGl4ZWwsCisJCWVudW0gc2Nhbl9kaXJl
Y3Rpb25fY2xhc3MgU2Nhbk9yaWVudGF0aW9uLAorCQl1bnNpZ25lZCBpbnQgKk1heFVuY29tcHJl
c3NlZEJsb2NrLAorCQl1bnNpZ25lZCBpbnQgKk1heENvbXByZXNzZWRCbG9jaywKKwkJdW5zaWdu
ZWQgaW50ICpJbmRlcGVuZGVudDY0Qnl0ZUJsb2NrKQoreworCWRvdWJsZSBNYXhpbXVtRENDQ29t
cHJlc3Npb25TdXJmYWNlID0gMC4wOworCWVudW0geworCQlSRVFfMjU2Qnl0ZXMsCisJCVJFUV8x
MjhCeXRlc05vbkNvbnRpZ3VvdXMsCisJCVJFUV8xMjhCeXRlc0NvbnRpZ3VvdXMsCisJCVJFUV9O
QQorCX0gUmVxdWVzdCA9IFJFUV9OQTsKKworCWlmIChEQ0NFbmFibGVkID09IHRydWUpIHsKKwkJ
aWYgKERDQ1Byb2dyYW1taW5nQXNzdW1lc1NjYW5EaXJlY3Rpb25Vbmtub3duID09IHRydWUpIHsK
KwkJCWlmIChERVRCdWZmZXJTaXplID49IFJlcXVlc3RIZWlnaHQyNTZCeXRlICogVmlld3BvcnRX
aWR0aCAqIEJ5dGVQZXJQaXhlbAorCQkJCQkmJiBERVRCdWZmZXJTaXplCisJCQkJCQkJPj0gMjU2
IC8gUmVxdWVzdEhlaWdodDI1NkJ5dGUKKwkJCQkJCQkJCSogVmlld3BvcnRIZWlnaHQpIHsKKwkJ
CQlSZXF1ZXN0ID0gUkVRXzI1NkJ5dGVzOworCQkJfSBlbHNlIGlmICgoREVUQnVmZmVyU2l6ZQor
CQkJCQk8IFJlcXVlc3RIZWlnaHQyNTZCeXRlICogVmlld3BvcnRXaWR0aCAqIEJ5dGVQZXJQaXhl
bAorCQkJCQkmJiAoQnl0ZVBlclBpeGVsID09IDIgfHwgQnl0ZVBlclBpeGVsID09IDQpKQorCQkJ
CQl8fCAoREVUQnVmZmVyU2l6ZQorCQkJCQkJCTwgMjU2IC8gUmVxdWVzdEhlaWdodDI1NkJ5dGUK
KwkJCQkJCQkJCSogVmlld3BvcnRIZWlnaHQKKwkJCQkJCQkmJiBCeXRlUGVyUGl4ZWwgPT0gOAor
CQkJCQkJCSYmIChUaWxpbmdGb3JtYXQgPT0gZG1fc3dfNGtiX2QKKwkJCQkJCQkJCXx8IFRpbGlu
Z0Zvcm1hdAorCQkJCQkJCQkJCQk9PSBkbV9zd180a2JfZF94CisJCQkJCQkJCQl8fCBUaWxpbmdG
b3JtYXQKKwkJCQkJCQkJCQkJPT0gZG1fc3dfdmFyX2QKKwkJCQkJCQkJCXx8IFRpbGluZ0Zvcm1h
dAorCQkJCQkJCQkJCQk9PSBkbV9zd192YXJfZF94CisJCQkJCQkJCQl8fCBUaWxpbmdGb3JtYXQK
KwkJCQkJCQkJCQkJPT0gZG1fc3dfNjRrYl9kCisJCQkJCQkJCQl8fCBUaWxpbmdGb3JtYXQKKwkJ
CQkJCQkJCQkJPT0gZG1fc3dfNjRrYl9kX3gKKwkJCQkJCQkJCXx8IFRpbGluZ0Zvcm1hdAorCQkJ
CQkJCQkJCQk9PSBkbV9zd182NGtiX2RfdAorCQkJCQkJCQkJfHwgVGlsaW5nRm9ybWF0CisJCQkJ
CQkJCQkJCT09IGRtX3N3XzY0a2Jfcl94KSkpIHsKKwkJCQlSZXF1ZXN0ID0gUkVRXzEyOEJ5dGVz
Tm9uQ29udGlndW91czsKKwkJCX0gZWxzZSB7CisJCQkJUmVxdWVzdCA9IFJFUV8xMjhCeXRlc0Nv
bnRpZ3VvdXM7CisJCQl9CisJCX0gZWxzZSB7CisJCQlpZiAoQnl0ZVBlclBpeGVsID09IDEpIHsK
KwkJCQlpZiAoU2Nhbk9yaWVudGF0aW9uID09IGRtX3ZlcnQgfHwgU3dhdGhIZWlnaHQgPT0gMTYp
IHsKKwkJCQkJUmVxdWVzdCA9IFJFUV8yNTZCeXRlczsKKwkJCQl9IGVsc2UgeworCQkJCQlSZXF1
ZXN0ID0gUkVRXzEyOEJ5dGVzQ29udGlndW91czsKKwkJCQl9CisJCQl9IGVsc2UgaWYgKEJ5dGVQ
ZXJQaXhlbCA9PSAyKSB7CisJCQkJaWYgKChTY2FuT3JpZW50YXRpb24gPT0gZG1fdmVydCAmJiBT
d2F0aEhlaWdodCA9PSAxNikgfHwgKFNjYW5PcmllbnRhdGlvbiAhPSBkbV92ZXJ0ICYmIFN3YXRo
SGVpZ2h0ID09IDgpKSB7CisJCQkJCVJlcXVlc3QgPSBSRVFfMjU2Qnl0ZXM7CisJCQkJfSBlbHNl
IGlmIChTY2FuT3JpZW50YXRpb24gPT0gZG1fdmVydCkgeworCQkJCQlSZXF1ZXN0ID0gUkVRXzEy
OEJ5dGVzQ29udGlndW91czsKKwkJCQl9IGVsc2UgeworCQkJCQlSZXF1ZXN0ID0gUkVRXzEyOEJ5
dGVzTm9uQ29udGlndW91czsKKwkJCQl9CisJCQl9IGVsc2UgaWYgKEJ5dGVQZXJQaXhlbCA9PSA0
KSB7CisJCQkJaWYgKFN3YXRoSGVpZ2h0ID09IDgpIHsKKwkJCQkJUmVxdWVzdCA9IFJFUV8yNTZC
eXRlczsKKwkJCQl9IGVsc2UgaWYgKFNjYW5PcmllbnRhdGlvbiA9PSBkbV92ZXJ0KSB7CisJCQkJ
CVJlcXVlc3QgPSBSRVFfMTI4Qnl0ZXNDb250aWd1b3VzOworCQkJCX0gZWxzZSB7CisJCQkJCVJl
cXVlc3QgPSBSRVFfMTI4Qnl0ZXNOb25Db250aWd1b3VzOworCQkJCX0KKwkJCX0gZWxzZSBpZiAo
Qnl0ZVBlclBpeGVsID09IDgpIHsKKwkJCQlpZiAoVGlsaW5nRm9ybWF0ID09IGRtX3N3XzRrYl9k
IHx8IFRpbGluZ0Zvcm1hdCA9PSBkbV9zd180a2JfZF94CisJCQkJCQl8fCBUaWxpbmdGb3JtYXQg
PT0gZG1fc3dfdmFyX2QKKwkJCQkJCXx8IFRpbGluZ0Zvcm1hdCA9PSBkbV9zd192YXJfZF94CisJ
CQkJCQl8fCBUaWxpbmdGb3JtYXQgPT0gZG1fc3dfNjRrYl9kCisJCQkJCQl8fCBUaWxpbmdGb3Jt
YXQgPT0gZG1fc3dfNjRrYl9kX3gKKwkJCQkJCXx8IFRpbGluZ0Zvcm1hdCA9PSBkbV9zd182NGti
X2RfdAorCQkJCQkJfHwgVGlsaW5nRm9ybWF0ID09IGRtX3N3XzY0a2Jfcl94KSB7CisJCQkJCWlm
ICgoU2Nhbk9yaWVudGF0aW9uID09IGRtX3ZlcnQgJiYgU3dhdGhIZWlnaHQgPT0gOCkKKwkJCQkJ
CQl8fCAoU2Nhbk9yaWVudGF0aW9uICE9IGRtX3ZlcnQKKwkJCQkJCQkJCSYmIFN3YXRoSGVpZ2h0
ID09IDQpKSB7CisJCQkJCQlSZXF1ZXN0ID0gUkVRXzI1NkJ5dGVzOworCQkJCQl9IGVsc2UgaWYg
KFNjYW5PcmllbnRhdGlvbiAhPSBkbV92ZXJ0KSB7CisJCQkJCQlSZXF1ZXN0ID0gUkVRXzEyOEJ5
dGVzQ29udGlndW91czsKKwkJCQkJfSBlbHNlIHsKKwkJCQkJCVJlcXVlc3QgPSBSRVFfMTI4Qnl0
ZXNOb25Db250aWd1b3VzOworCQkJCQl9CisJCQkJfSBlbHNlIHsKKwkJCQkJaWYgKFNjYW5Pcmll
bnRhdGlvbiAhPSBkbV92ZXJ0IHx8IFN3YXRoSGVpZ2h0ID09IDgpIHsKKwkJCQkJCVJlcXVlc3Qg
PSBSRVFfMjU2Qnl0ZXM7CisJCQkJCX0gZWxzZSB7CisJCQkJCQlSZXF1ZXN0ID0gUkVRXzEyOEJ5
dGVzQ29udGlndW91czsKKwkJCQkJfQorCQkJCX0KKwkJCX0KKwkJfQorCX0gZWxzZSB7CisJCVJl
cXVlc3QgPSBSRVFfTkE7CisJfQorCisJaWYgKFJlcXVlc3QgPT0gUkVRXzI1NkJ5dGVzKSB7CisJ
CSpNYXhVbmNvbXByZXNzZWRCbG9jayA9IDI1NjsKKwkJKk1heENvbXByZXNzZWRCbG9jayA9IDI1
NjsKKwkJKkluZGVwZW5kZW50NjRCeXRlQmxvY2sgPSBmYWxzZTsKKwkJTWF4aW11bURDQ0NvbXBy
ZXNzaW9uU3VyZmFjZSA9IDQuMDsKKwl9IGVsc2UgaWYgKFJlcXVlc3QgPT0gUkVRXzEyOEJ5dGVz
Q29udGlndW91cykgeworCQkqTWF4VW5jb21wcmVzc2VkQmxvY2sgPSAxMjg7CisJCSpNYXhDb21w
cmVzc2VkQmxvY2sgPSAxMjg7CisJCSpJbmRlcGVuZGVudDY0Qnl0ZUJsb2NrID0gZmFsc2U7CisJ
CU1heGltdW1EQ0NDb21wcmVzc2lvblN1cmZhY2UgPSAyLjA7CisJfSBlbHNlIGlmIChSZXF1ZXN0
ID09IFJFUV8xMjhCeXRlc05vbkNvbnRpZ3VvdXMpIHsKKwkJKk1heFVuY29tcHJlc3NlZEJsb2Nr
ID0gMjU2OworCQkqTWF4Q29tcHJlc3NlZEJsb2NrID0gNjQ7CisJCSpJbmRlcGVuZGVudDY0Qnl0
ZUJsb2NrID0gdHJ1ZTsKKwkJTWF4aW11bURDQ0NvbXByZXNzaW9uU3VyZmFjZSA9IDQuMDsKKwl9
IGVsc2UgeworCQkqTWF4VW5jb21wcmVzc2VkQmxvY2sgPSAwOworCQkqTWF4Q29tcHJlc3NlZEJs
b2NrID0gMDsKKwkJKkluZGVwZW5kZW50NjRCeXRlQmxvY2sgPSAwOworCQlNYXhpbXVtRENDQ29t
cHJlc3Npb25TdXJmYWNlID0gMC4wOworCX0KKworCXJldHVybiBNYXhpbXVtRENDQ29tcHJlc3Np
b25TdXJmYWNlOworfQorCitzdGF0aWMgZG91YmxlIENhbGN1bGF0ZVByZWZldGNoU291cmNlTGlu
ZXMoCisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJZG91YmxlIFZSYXRp
bywKKwkJZG91YmxlIHZ0YXBzLAorCQlib29sIEludGVybGFjZSwKKwkJYm9vbCBQcm9ncmVzc2l2
ZVRvSW50ZXJsYWNlVW5pdEluT1BQLAorCQl1bnNpZ25lZCBpbnQgU3dhdGhIZWlnaHQsCisJCXVu
c2lnbmVkIGludCBWaWV3cG9ydFlTdGFydCwKKwkJZG91YmxlICpWSW5pdFByZUZpbGwsCisJCXVu
c2lnbmVkIGludCAqTWF4TnVtU3dhdGgpCit7CisJdW5zaWduZWQgaW50IE1heFBhcnRpYWxTd2F0
aDsKKworCWlmIChQcm9ncmVzc2l2ZVRvSW50ZXJsYWNlVW5pdEluT1BQKQorCQkqVkluaXRQcmVG
aWxsID0gZG1sX2Zsb29yKChWUmF0aW8gKyB2dGFwcyArIDEpIC8gMi4wLCAxKTsKKwllbHNlCisJ
CSpWSW5pdFByZUZpbGwgPSBkbWxfZmxvb3IoKFZSYXRpbyArIHZ0YXBzICsgMSArIEludGVybGFj
ZSAqIDAuNSAqIFZSYXRpbykgLyAyLjAsIDEpOworCisJaWYgKCFtb2RlX2xpYi0+dmJhLklnbm9y
ZVZpZXdwb3J0UG9zaXRpb25pbmcpIHsKKworCQkqTWF4TnVtU3dhdGggPSBkbWxfY2VpbCgoKlZJ
bml0UHJlRmlsbCAtIDEuMCkgLyBTd2F0aEhlaWdodCwgMSkgKyAxLjA7CisKKwkJaWYgKCpWSW5p
dFByZUZpbGwgPiAxLjApCisJCQlNYXhQYXJ0aWFsU3dhdGggPSAodW5zaWduZWQgaW50KSAoKlZJ
bml0UHJlRmlsbCAtIDIpICUgU3dhdGhIZWlnaHQ7CisJCWVsc2UKKwkJCU1heFBhcnRpYWxTd2F0
aCA9ICh1bnNpZ25lZCBpbnQpICgqVkluaXRQcmVGaWxsICsgU3dhdGhIZWlnaHQgLSAyKQorCQkJ
CQklIFN3YXRoSGVpZ2h0OworCQlNYXhQYXJ0aWFsU3dhdGggPSBkbWxfbWF4KDFVLCBNYXhQYXJ0
aWFsU3dhdGgpOworCisJfSBlbHNlIHsKKworCQlpZiAoVmlld3BvcnRZU3RhcnQgIT0gMCkKKwkJ
CWRtbF9wcmludCgKKwkJCQkJIldBUk5JTkcgRE1MOiB1c2luZyB2aWV3cG9ydCB5IHBvc2l0aW9u
IG9mIDAgZXZlbiB0aG91Z2ggYWN0dWFsIHZpZXdwb3J0IHkgcG9zaXRpb24gaXMgbm9uLXplcm8g
aW4gcHJlZmV0Y2ggc291cmNlIGxpbmVzIGNhbGN1bGF0aW9uXG4iKTsKKworCQkqTWF4TnVtU3dh
dGggPSBkbWxfY2VpbCgqVkluaXRQcmVGaWxsIC8gU3dhdGhIZWlnaHQsIDEpOworCisJCWlmICgq
VkluaXRQcmVGaWxsID4gMS4wKQorCQkJTWF4UGFydGlhbFN3YXRoID0gKHVuc2lnbmVkIGludCkg
KCpWSW5pdFByZUZpbGwgLSAxKSAlIFN3YXRoSGVpZ2h0OworCQllbHNlCisJCQlNYXhQYXJ0aWFs
U3dhdGggPSAodW5zaWduZWQgaW50KSAoKlZJbml0UHJlRmlsbCArIFN3YXRoSGVpZ2h0IC0gMSkK
KwkJCQkJJSBTd2F0aEhlaWdodDsKKwl9CisKKwlyZXR1cm4gKk1heE51bVN3YXRoICogU3dhdGhI
ZWlnaHQgKyBNYXhQYXJ0aWFsU3dhdGg7Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgQ2FsY3Vs
YXRlVk1BbmRSb3dCeXRlcygKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAor
CQlib29sIERDQ0VuYWJsZSwKKwkJdW5zaWduZWQgaW50IEJsb2NrSGVpZ2h0MjU2Qnl0ZXMsCisJ
CXVuc2lnbmVkIGludCBCbG9ja1dpZHRoMjU2Qnl0ZXMsCisJCWVudW0gc291cmNlX2Zvcm1hdF9j
bGFzcyBTb3VyY2VQaXhlbEZvcm1hdCwKKwkJdW5zaWduZWQgaW50IFN1cmZhY2VUaWxpbmcsCisJ
CXVuc2lnbmVkIGludCBCeXRlUGVyUGl4ZWwsCisJCWVudW0gc2Nhbl9kaXJlY3Rpb25fY2xhc3Mg
U2NhbkRpcmVjdGlvbiwKKwkJdW5zaWduZWQgaW50IFZpZXdwb3J0V2lkdGgsCisJCXVuc2lnbmVk
IGludCBWaWV3cG9ydEhlaWdodCwKKwkJdW5zaWduZWQgaW50IFN3YXRoV2lkdGgsCisJCWJvb2wg
R1BVVk1FbmFibGUsCisJCWJvb2wgSG9zdFZNRW5hYmxlLAorCQl1bnNpZ25lZCBpbnQgSG9zdFZN
TWF4UGFnZVRhYmxlTGV2ZWxzLAorCQl1bnNpZ25lZCBpbnQgSG9zdFZNQ2FjaGVkUGFnZVRhYmxl
TGV2ZWxzLAorCQl1bnNpZ25lZCBpbnQgVk1NUGFnZVNpemUsCisJCXVuc2lnbmVkIGludCBQVEVC
dWZmZXJTaXplSW5SZXF1ZXN0cywKKwkJdW5zaWduZWQgaW50IFBpdGNoLAorCQl1bnNpZ25lZCBp
bnQgRENDTWV0YVBpdGNoLAorCQl1bnNpZ25lZCBpbnQgKk1hY3JvVGlsZVdpZHRoLAorCQl1bnNp
Z25lZCBpbnQgKk1ldGFSb3dCeXRlLAorCQl1bnNpZ25lZCBpbnQgKlBpeGVsUFRFQnl0ZXNQZXJS
b3csCisJCWJvb2wgKlBURUJ1ZmZlclNpemVOb3RFeGNlZWRlZCwKKwkJdW5zaWduZWQgaW50ICpk
cHRlX3Jvd193aWR0aF91YiwKKwkJdW5zaWduZWQgaW50ICpkcHRlX3Jvd19oZWlnaHQsCisJCXVu
c2lnbmVkIGludCAqTWV0YVJlcXVlc3RXaWR0aCwKKwkJdW5zaWduZWQgaW50ICpNZXRhUmVxdWVz
dEhlaWdodCwKKwkJdW5zaWduZWQgaW50ICptZXRhX3Jvd193aWR0aCwKKwkJdW5zaWduZWQgaW50
ICptZXRhX3Jvd19oZWlnaHQsCisJCXVuc2lnbmVkIGludCAqdm1fZ3JvdXBfYnl0ZXMsCisJCWxv
bmcgICAgICAgICAqZHB0ZV9ncm91cF9ieXRlcywKKwkJdW5zaWduZWQgaW50ICpQaXhlbFBURVJl
cVdpZHRoLAorCQl1bnNpZ25lZCBpbnQgKlBpeGVsUFRFUmVxSGVpZ2h0LAorCQl1bnNpZ25lZCBp
bnQgKlBURVJlcXVlc3RTaXplLAorCQl1bnNpZ25lZCBpbnQgKkRQREUwQnl0ZXNGcmFtZSwKKwkJ
dW5zaWduZWQgaW50ICpNZXRhUFRFQnl0ZXNGcmFtZSkKK3sKKwl1bnNpZ25lZCBpbnQgTVBERUJ5
dGVzRnJhbWU7CisJdW5zaWduZWQgaW50IERDQ01ldGFTdXJmYWNlQnl0ZXM7CisJdW5zaWduZWQg
aW50IE1hY3JvVGlsZVNpemVCeXRlczsKKwl1bnNpZ25lZCBpbnQgTWFjcm9UaWxlSGVpZ2h0Owor
CXVuc2lnbmVkIGludCBFeHRyYURQREVCeXRlc0ZyYW1lOworCXVuc2lnbmVkIGludCBQREVBbmRN
ZXRhUFRFQnl0ZXNGcmFtZTsKKwl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVSZXFIZWlnaHRQVEVzOwor
CisJaWYgKERDQ0VuYWJsZSA9PSB0cnVlKSB7CisJCSpNZXRhUmVxdWVzdEhlaWdodCA9IDggKiBC
bG9ja0hlaWdodDI1NkJ5dGVzOworCQkqTWV0YVJlcXVlc3RXaWR0aCA9IDggKiBCbG9ja1dpZHRo
MjU2Qnl0ZXM7CisJCWlmIChTY2FuRGlyZWN0aW9uID09IGRtX2hvcnopIHsKKwkJCSptZXRhX3Jv
d19oZWlnaHQgPSAqTWV0YVJlcXVlc3RIZWlnaHQ7CisJCQkqbWV0YV9yb3dfd2lkdGggPSBkbWxf
Y2VpbCgoZG91YmxlKSBTd2F0aFdpZHRoIC0gMSwgKk1ldGFSZXF1ZXN0V2lkdGgpCisJCQkJCSsg
Kk1ldGFSZXF1ZXN0V2lkdGg7CisJCQkqTWV0YVJvd0J5dGUgPSAqbWV0YV9yb3dfd2lkdGggKiAq
TWV0YVJlcXVlc3RIZWlnaHQgKiBCeXRlUGVyUGl4ZWwgLyAyNTYuMDsKKwkJfSBlbHNlIHsKKwkJ
CSptZXRhX3Jvd19oZWlnaHQgPSAqTWV0YVJlcXVlc3RXaWR0aDsKKwkJCSptZXRhX3Jvd193aWR0
aCA9IGRtbF9jZWlsKChkb3VibGUpIFN3YXRoV2lkdGggLSAxLCAqTWV0YVJlcXVlc3RIZWlnaHQp
CisJCQkJCSsgKk1ldGFSZXF1ZXN0SGVpZ2h0OworCQkJKk1ldGFSb3dCeXRlID0gKm1ldGFfcm93
X3dpZHRoICogKk1ldGFSZXF1ZXN0V2lkdGggKiBCeXRlUGVyUGl4ZWwgLyAyNTYuMDsKKwkJfQor
CQlpZiAoU2NhbkRpcmVjdGlvbiA9PSBkbV9ob3J6KSB7CisJCQlEQ0NNZXRhU3VyZmFjZUJ5dGVz
ID0gRENDTWV0YVBpdGNoCisJCQkJCSogKGRtbF9jZWlsKFZpZXdwb3J0SGVpZ2h0IC0gMSwgNjQg
KiBCbG9ja0hlaWdodDI1NkJ5dGVzKQorCQkJCQkJCSsgNjQgKiBCbG9ja0hlaWdodDI1NkJ5dGVz
KSAqIEJ5dGVQZXJQaXhlbAorCQkJCQkvIDI1NjsKKwkJfSBlbHNlIHsKKwkJCURDQ01ldGFTdXJm
YWNlQnl0ZXMgPSBEQ0NNZXRhUGl0Y2gKKwkJCQkJKiAoZG1sX2NlaWwoCisJCQkJCQkJKGRvdWJs
ZSkgVmlld3BvcnRIZWlnaHQgLSAxLAorCQkJCQkJCTY0ICogQmxvY2tIZWlnaHQyNTZCeXRlcykK
KwkJCQkJCQkrIDY0ICogQmxvY2tIZWlnaHQyNTZCeXRlcykgKiBCeXRlUGVyUGl4ZWwKKwkJCQkJ
LyAyNTY7CisJCX0KKwkJaWYgKEdQVVZNRW5hYmxlID09IHRydWUpIHsKKwkJCSpNZXRhUFRFQnl0
ZXNGcmFtZSA9IChkbWxfY2VpbCgKKwkJCQkJKGRvdWJsZSkgKERDQ01ldGFTdXJmYWNlQnl0ZXMg
LSBWTU1QYWdlU2l6ZSkKKwkJCQkJCQkvICg4ICogVk1NUGFnZVNpemUpLAorCQkJCQkxKSArIDEp
ICogNjQ7CisJCQlNUERFQnl0ZXNGcmFtZSA9IDEyOCAqICgobW9kZV9saWItPnZiYS5HUFVWTU1h
eFBhZ2VUYWJsZUxldmVscyArIDEpICogKG1vZGVfbGliLT52YmEuSG9zdFZNTWF4UGFnZVRhYmxl
TGV2ZWxzICsgMSkgLSAyKTsKKwkJfSBlbHNlIHsKKwkJCSpNZXRhUFRFQnl0ZXNGcmFtZSA9IDA7
CisJCQlNUERFQnl0ZXNGcmFtZSA9IDA7CisJCX0KKwl9IGVsc2UgeworCQkqTWV0YVBURUJ5dGVz
RnJhbWUgPSAwOworCQlNUERFQnl0ZXNGcmFtZSA9IDA7CisJCSpNZXRhUm93Qnl0ZSA9IDA7CisJ
fQorCisJaWYgKFN1cmZhY2VUaWxpbmcgPT0gZG1fc3dfbGluZWFyIHx8IFN1cmZhY2VUaWxpbmcg
PT0gZG1fc3dfZ2Z4N18yZF90aGluX2dsIHx8IFN1cmZhY2VUaWxpbmcgPT0gZG1fc3dfZ2Z4N18y
ZF90aGluX2x2cCkgeworCQlNYWNyb1RpbGVTaXplQnl0ZXMgPSAyNTY7CisJCU1hY3JvVGlsZUhl
aWdodCA9IEJsb2NrSGVpZ2h0MjU2Qnl0ZXM7CisJfSBlbHNlIGlmIChTdXJmYWNlVGlsaW5nID09
IGRtX3N3XzRrYl9zIHx8IFN1cmZhY2VUaWxpbmcgPT0gZG1fc3dfNGtiX3NfeAorCQkJfHwgU3Vy
ZmFjZVRpbGluZyA9PSBkbV9zd180a2JfZCB8fCBTdXJmYWNlVGlsaW5nID09IGRtX3N3XzRrYl9k
X3gpIHsKKwkJTWFjcm9UaWxlU2l6ZUJ5dGVzID0gNDA5NjsKKwkJTWFjcm9UaWxlSGVpZ2h0ID0g
NCAqIEJsb2NrSGVpZ2h0MjU2Qnl0ZXM7CisJfSBlbHNlIGlmIChTdXJmYWNlVGlsaW5nID09IGRt
X3N3XzY0a2JfcyB8fCBTdXJmYWNlVGlsaW5nID09IGRtX3N3XzY0a2Jfc190CisJCQl8fCBTdXJm
YWNlVGlsaW5nID09IGRtX3N3XzY0a2Jfc194IHx8IFN1cmZhY2VUaWxpbmcgPT0gZG1fc3dfNjRr
Yl9kCisJCQl8fCBTdXJmYWNlVGlsaW5nID09IGRtX3N3XzY0a2JfZF90IHx8IFN1cmZhY2VUaWxp
bmcgPT0gZG1fc3dfNjRrYl9kX3gKKwkJCXx8IFN1cmZhY2VUaWxpbmcgPT0gZG1fc3dfNjRrYl9y
X3gpIHsKKwkJTWFjcm9UaWxlU2l6ZUJ5dGVzID0gNjU1MzY7CisJCU1hY3JvVGlsZUhlaWdodCA9
IDE2ICogQmxvY2tIZWlnaHQyNTZCeXRlczsKKwl9IGVsc2UgeworCQlNYWNyb1RpbGVTaXplQnl0
ZXMgPSAyNjIxNDQ7CisJCU1hY3JvVGlsZUhlaWdodCA9IDMyICogQmxvY2tIZWlnaHQyNTZCeXRl
czsKKwl9CisJKk1hY3JvVGlsZVdpZHRoID0gTWFjcm9UaWxlU2l6ZUJ5dGVzIC8gQnl0ZVBlclBp
eGVsIC8gTWFjcm9UaWxlSGVpZ2h0OworCisJaWYgKEdQVVZNRW5hYmxlID09IHRydWUgJiYgKG1v
ZGVfbGliLT52YmEuR1BVVk1NYXhQYWdlVGFibGVMZXZlbHMgKyAxKSAqIChtb2RlX2xpYi0+dmJh
Lkhvc3RWTU1heFBhZ2VUYWJsZUxldmVscyArIDEpID4gMikgeworCQlpZiAoU2NhbkRpcmVjdGlv
biA9PSBkbV9ob3J6KSB7CisJCQkqRFBERTBCeXRlc0ZyYW1lID0gNjQgKiAoZG1sX2NlaWwoKChQ
aXRjaCAqIChkbWxfY2VpbChWaWV3cG9ydEhlaWdodCAtIDEsIE1hY3JvVGlsZUhlaWdodCkgKyBN
YWNyb1RpbGVIZWlnaHQpICogQnl0ZVBlclBpeGVsKSAtIE1hY3JvVGlsZVNpemVCeXRlcykgLyAo
OCAqIDIwOTcxNTIpLCAxKSArIDEpOworCQl9IGVsc2UgeworCQkJKkRQREUwQnl0ZXNGcmFtZSA9
IDY0ICogKGRtbF9jZWlsKCgoUGl0Y2ggKiAoZG1sX2NlaWwoKGRvdWJsZSkgU3dhdGhXaWR0aCAt
IDEsIE1hY3JvVGlsZUhlaWdodCkgKyBNYWNyb1RpbGVIZWlnaHQpICogQnl0ZVBlclBpeGVsKSAt
IE1hY3JvVGlsZVNpemVCeXRlcykgLyAoOCAqIDIwOTcxNTIpLCAxKSArIDEpOworCQl9CisJCUV4
dHJhRFBERUJ5dGVzRnJhbWUgPSAxMjggKiAoKG1vZGVfbGliLT52YmEuR1BVVk1NYXhQYWdlVGFi
bGVMZXZlbHMgKyAxKSAqIChtb2RlX2xpYi0+dmJhLkhvc3RWTU1heFBhZ2VUYWJsZUxldmVscyAr
IDEpIC0gMyk7CisJfSBlbHNlIHsKKwkJKkRQREUwQnl0ZXNGcmFtZSA9IDA7CisJCUV4dHJhRFBE
RUJ5dGVzRnJhbWUgPSAwOworCX0KKworCVBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lID0gKk1ldGFQ
VEVCeXRlc0ZyYW1lICsgTVBERUJ5dGVzRnJhbWUgKyAqRFBERTBCeXRlc0ZyYW1lCisJCQkrIEV4
dHJhRFBERUJ5dGVzRnJhbWU7CisKKwlpZiAoSG9zdFZNRW5hYmxlID09IHRydWUpIHsKKwkJUERF
QW5kTWV0YVBURUJ5dGVzRnJhbWUgPSBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZSAqICgxICsgOCAq
IChIb3N0Vk1NYXhQYWdlVGFibGVMZXZlbHMgLSBIb3N0Vk1DYWNoZWRQYWdlVGFibGVMZXZlbHMp
KTsKKwl9CisKKwlpZiAoR1BVVk1FbmFibGUgPT0gdHJ1ZSkgeworCQlkb3VibGUgRnJhY3Rpb25P
ZlBURVJldHVybkRyb3A7CisKKwkJaWYgKFN1cmZhY2VUaWxpbmcgPT0gZG1fc3dfbGluZWFyKSB7
CisJCQlQaXhlbFBURVJlcUhlaWdodFBURXMgPSAxOworCQkJKlBpeGVsUFRFUmVxSGVpZ2h0ID0g
MTsKKwkJCSpQaXhlbFBURVJlcVdpZHRoID0gOC4wICogVk1NUGFnZVNpemUgLyBCeXRlUGVyUGl4
ZWw7CisJCQkqUFRFUmVxdWVzdFNpemUgPSA2NDsKKwkJCUZyYWN0aW9uT2ZQVEVSZXR1cm5Ecm9w
ID0gMDsKKwkJfSBlbHNlIGlmIChNYWNyb1RpbGVTaXplQnl0ZXMgPT0gNDA5NikgeworCQkJUGl4
ZWxQVEVSZXFIZWlnaHRQVEVzID0gMTsKKwkJCSpQaXhlbFBURVJlcUhlaWdodCA9IE1hY3JvVGls
ZUhlaWdodDsKKwkJCSpQaXhlbFBURVJlcVdpZHRoID0gOCAqICpNYWNyb1RpbGVXaWR0aDsKKwkJ
CSpQVEVSZXF1ZXN0U2l6ZSA9IDY0OworCQkJaWYgKFNjYW5EaXJlY3Rpb24gPT0gZG1faG9yeikK
KwkJCQlGcmFjdGlvbk9mUFRFUmV0dXJuRHJvcCA9IDA7CisJCQllbHNlCisJCQkJRnJhY3Rpb25P
ZlBURVJldHVybkRyb3AgPSA3IC8gODsKKwkJfSBlbHNlIGlmIChWTU1QYWdlU2l6ZSA9PSA0MDk2
ICYmIE1hY3JvVGlsZVNpemVCeXRlcyA+IDQwOTYpIHsKKwkJCVBpeGVsUFRFUmVxSGVpZ2h0UFRF
cyA9IDE2OworCQkJKlBpeGVsUFRFUmVxSGVpZ2h0ID0gMTYgKiBCbG9ja0hlaWdodDI1NkJ5dGVz
OworCQkJKlBpeGVsUFRFUmVxV2lkdGggPSAxNiAqIEJsb2NrV2lkdGgyNTZCeXRlczsKKwkJCSpQ
VEVSZXF1ZXN0U2l6ZSA9IDEyODsKKwkJCUZyYWN0aW9uT2ZQVEVSZXR1cm5Ecm9wID0gMDsKKwkJ
fSBlbHNlIHsKKwkJCVBpeGVsUFRFUmVxSGVpZ2h0UFRFcyA9IDE7CisJCQkqUGl4ZWxQVEVSZXFI
ZWlnaHQgPSBNYWNyb1RpbGVIZWlnaHQ7CisJCQkqUGl4ZWxQVEVSZXFXaWR0aCA9IDggKiAqTWFj
cm9UaWxlV2lkdGg7CisJCQkqUFRFUmVxdWVzdFNpemUgPSA2NDsKKwkJCUZyYWN0aW9uT2ZQVEVS
ZXR1cm5Ecm9wID0gMDsKKwkJfQorCisJCWlmIChTdXJmYWNlVGlsaW5nID09IGRtX3N3X2xpbmVh
cikgeworCQkJKmRwdGVfcm93X2hlaWdodCA9IGRtbF9taW4oMTI4LAorCQkJCQkxIDw8ICh1bnNp
Z25lZCBpbnQpIGRtbF9mbG9vcigKKwkJCQkJCWRtbF9sb2cyKAorCQkJCQkJCShkb3VibGUpIFBU
RUJ1ZmZlclNpemVJblJlcXVlc3RzICogKlBpeGVsUFRFUmVxV2lkdGggLyBQaXRjaCksCisJCQkJ
CQkxKSk7CisJCQkqZHB0ZV9yb3dfd2lkdGhfdWIgPSAoZG1sX2NlaWwoKGRvdWJsZSkgKFBpdGNo
ICogKmRwdGVfcm93X2hlaWdodCAtIDEpIC8gKlBpeGVsUFRFUmVxV2lkdGgsIDEpICsgMSkgKiAq
UGl4ZWxQVEVSZXFXaWR0aDsKKwkJCSpQaXhlbFBURUJ5dGVzUGVyUm93ID0gKmRwdGVfcm93X3dp
ZHRoX3ViIC8gKlBpeGVsUFRFUmVxV2lkdGggKiAqUFRFUmVxdWVzdFNpemU7CisJCX0gZWxzZSBp
ZiAoU2NhbkRpcmVjdGlvbiA9PSBkbV9ob3J6KSB7CisJCQkqZHB0ZV9yb3dfaGVpZ2h0ID0gKlBp
eGVsUFRFUmVxSGVpZ2h0OworCQkJKmRwdGVfcm93X3dpZHRoX3ViID0gKGRtbF9jZWlsKChkb3Vi
bGUpIChTd2F0aFdpZHRoIC0gMSkgLyAqUGl4ZWxQVEVSZXFXaWR0aCwgMSkgKyAxKSAqICpQaXhl
bFBURVJlcVdpZHRoOworCQkJKlBpeGVsUFRFQnl0ZXNQZXJSb3cgPSAqZHB0ZV9yb3dfd2lkdGhf
dWIgLyAqUGl4ZWxQVEVSZXFXaWR0aCAqICpQVEVSZXF1ZXN0U2l6ZTsKKwkJfSBlbHNlIHsKKwkJ
CSpkcHRlX3Jvd19oZWlnaHQgPSBkbWxfbWluKCpQaXhlbFBURVJlcVdpZHRoLCAqTWFjcm9UaWxl
V2lkdGgpOworCQkJKmRwdGVfcm93X3dpZHRoX3ViID0gKGRtbF9jZWlsKChkb3VibGUpIChTd2F0
aFdpZHRoIC0gMSkgLyAqUGl4ZWxQVEVSZXFIZWlnaHQsIDEpICsgMSkgKiAqUGl4ZWxQVEVSZXFI
ZWlnaHQ7CisJCQkqUGl4ZWxQVEVCeXRlc1BlclJvdyA9ICpkcHRlX3Jvd193aWR0aF91YiAvICpQ
aXhlbFBURVJlcUhlaWdodCAqICpQVEVSZXF1ZXN0U2l6ZTsKKwkJfQorCQlpZiAoKlBpeGVsUFRF
Qnl0ZXNQZXJSb3cgKiAoMSAtIEZyYWN0aW9uT2ZQVEVSZXR1cm5Ecm9wKQorCQkJCTw9IDY0ICog
UFRFQnVmZmVyU2l6ZUluUmVxdWVzdHMpIHsKKwkJCSpQVEVCdWZmZXJTaXplTm90RXhjZWVkZWQg
PSB0cnVlOworCQl9IGVsc2UgeworCQkJKlBURUJ1ZmZlclNpemVOb3RFeGNlZWRlZCA9IGZhbHNl
OworCQl9CisJfSBlbHNlIHsKKwkJKlBpeGVsUFRFQnl0ZXNQZXJSb3cgPSAwOworCQkqUFRFQnVm
ZmVyU2l6ZU5vdEV4Y2VlZGVkID0gdHJ1ZTsKKwl9CisJZG1sX3ByaW50KCJETUw6IHZtX2J5dGVz
ID0gbWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1lIChwZXJfcGlwZSkgPSBNZXRhUFRFQnl0ZXNGcmFt
ZSA9IDogJWRcbiIsICpNZXRhUFRFQnl0ZXNGcmFtZSk7CisKKwlpZiAoSG9zdFZNRW5hYmxlID09
IHRydWUpIHsKKwkJKlBpeGVsUFRFQnl0ZXNQZXJSb3cgPSAqUGl4ZWxQVEVCeXRlc1BlclJvdyAq
ICgxICsgOCAqIChIb3N0Vk1NYXhQYWdlVGFibGVMZXZlbHMgLSBIb3N0Vk1DYWNoZWRQYWdlVGFi
bGVMZXZlbHMpKTsKKwl9CisKKwlpZiAoSG9zdFZNRW5hYmxlID09IHRydWUpIHsKKwkJKnZtX2dy
b3VwX2J5dGVzID0gNTEyOworCQkqZHB0ZV9ncm91cF9ieXRlcyA9IDUxMjsKKwl9IGVsc2UgaWYg
KEdQVVZNRW5hYmxlID09IHRydWUpIHsKKwkJKnZtX2dyb3VwX2J5dGVzID0gMjA0ODsKKwkJaWYg
KFN1cmZhY2VUaWxpbmcgIT0gZG1fc3dfbGluZWFyICYmIFBpeGVsUFRFUmVxSGVpZ2h0UFRFcyA9
PSAxICYmIFNjYW5EaXJlY3Rpb24gIT0gZG1faG9yeikgeworCQkJKmRwdGVfZ3JvdXBfYnl0ZXMg
PSA1MTI7CisJCX0gZWxzZSB7CisJCQkqZHB0ZV9ncm91cF9ieXRlcyA9IDIwNDg7CisJCX0KKwl9
IGVsc2UgeworCQkqdm1fZ3JvdXBfYnl0ZXMgPSAwOworCQkqZHB0ZV9ncm91cF9ieXRlcyA9IDA7
CisJfQorCisJcmV0dXJuIFBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lOworfQorCitzdGF0aWMgdm9p
ZCBESVNQQ0xLRFBQQ0xLRENGQ0xLRGVlcFNsZWVwUHJlZmV0Y2hQYXJhbWV0ZXJzV2F0ZXJtYXJr
c0FuZFBlcmZvcm1hbmNlQ2FsY3VsYXRpb24oCisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICpt
b2RlX2xpYikKK3sKKwlzdHJ1Y3QgdmJhX3ZhcnNfc3QgKmxvY2FscyA9ICZtb2RlX2xpYi0+dmJh
OworCXVuc2lnbmVkIGludCBqLCBrOworCisJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tESVNQQ0xL
ID0gMC4wOworCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhSYW1waW5nID0gMDsKKwltb2RlX2xp
Yi0+dmJhLkRJU1BDTEtXaXRob3V0UmFtcGluZyA9IDA7CisJbW9kZV9saWItPnZiYS5HbG9iYWxE
UFBDTEsgPSAwLjA7CisKKwkvLyBESVNQQ0xLIGFuZCBEUFBDTEsgQ2FsY3VsYXRpb24KKwkvLwor
CWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2sp
IHsKKwkJaWYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrRW5hYmxlW2tdKSB7CisJCQltb2RlX2xp
Yi0+dmJhLldyaXRlYmFja0RJU1BDTEsgPQorCQkJCQlkbWxfbWF4KAorCQkJCQkJCW1vZGVfbGli
LT52YmEuV3JpdGViYWNrRElTUENMSywKKwkJCQkJCQlDYWxjdWxhdGVXcml0ZUJhY2tESVNQQ0xL
KAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSwKKwkJCQkJ
CQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEu
V3JpdGViYWNrSFJhdGlvW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWUmF0
aW9ba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFIVGFwc1trXSwKKwkJ
CQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYVZUYXBzW2tdLAorCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFIVGFwc1trXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52
YmEuV3JpdGViYWNrQ2hyb21hVlRhcHNba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRl
YmFja0Rlc3RpbmF0aW9uV2lkdGhba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhUb3RhbFtr
XSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hTGluZUJ1ZmZlcldpZHRo
KSk7CisJCX0KKwl9CisKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFj
dGl2ZVBsYW5lczsgKytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLkhSYXRpb1trXSA+IDEpIHsK
KwkJCWxvY2Fscy0+UFNDTF9USFJPVUdIUFVUX0xVTUFba10gPSBkbWxfbWluKAorCQkJCQltb2Rl
X2xpYi0+dmJhLk1heERDSFVCVG9QU0NMVGhyb3VnaHB1dCwKKwkJCQkJbW9kZV9saWItPnZiYS5N
YXhQU0NMVG9MQlRocm91Z2hwdXQKKwkJCQkJCQkqIG1vZGVfbGliLT52YmEuSFJhdGlvW2tdCisJ
CQkJCQkJLyBkbWxfY2VpbCgKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuaHRhcHNba10KKwkJCQkJ
CQkJCQkJLyA2LjAsCisJCQkJCQkJCQkxKSk7CisJCX0gZWxzZSB7CisJCQlsb2NhbHMtPlBTQ0xf
VEhST1VHSFBVVF9MVU1BW2tdID0gZG1sX21pbigKKwkJCQkJbW9kZV9saWItPnZiYS5NYXhEQ0hV
QlRvUFNDTFRocm91Z2hwdXQsCisJCQkJCW1vZGVfbGliLT52YmEuTWF4UFNDTFRvTEJUaHJvdWdo
cHV0KTsKKwkJfQorCisJCW1vZGVfbGliLT52YmEuRFBQQ0xLVXNpbmdTaW5nbGVEUFBMdW1hID0K
KwkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10KKwkJCQkJCSogZG1sX21heCgKKwkJCQkJ
CQkJbW9kZV9saWItPnZiYS52dGFwc1trXSAvIDYuMAorCQkJCQkJCQkJCSogZG1sX21pbigKKwkJ
CQkJCQkJCQkJCTEuMCwKKwkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuSFJhdGlvW2tdKSwKKwkJ
CQkJCQkJZG1sX21heCgKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhSYXRpb1trXQorCQkJCQkJ
CQkJCQkJKiBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXQorCQkJCQkJCQkJCQkJLyBsb2NhbHMtPlBT
Q0xfVEhST1VHSFBVVF9MVU1BW2tdLAorCQkJCQkJCQkJCTEuMCkpOworCisJCWlmICgobW9kZV9s
aWItPnZiYS5odGFwc1trXSA+IDYgfHwgbW9kZV9saWItPnZiYS52dGFwc1trXSA+IDYpCisJCQkJ
JiYgbW9kZV9saWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQUEx1bWEKKwkJCQkJCTwgMiAqIG1v
ZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkgeworCQkJbW9kZV9saWItPnZiYS5EUFBDTEtVc2lu
Z1NpbmdsZURQUEx1bWEgPSAyICogbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdOworCQl9CisK
KwkJaWYgKChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQyMF84CisJ
CQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80MjBfMTApKSB7
CisJCQlsb2NhbHMtPlBTQ0xfVEhST1VHSFBVVF9DSFJPTUFba10gPSAwLjA7CisJCQlsb2NhbHMt
PkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdID0KKwkJCQkJbW9kZV9saWItPnZiYS5EUFBDTEtVc2lu
Z1NpbmdsZURQUEx1bWE7CisJCX0gZWxzZSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5IUmF0aW9b
a10gPiAxKSB7CisJCQkJbG9jYWxzLT5QU0NMX1RIUk9VR0hQVVRfQ0hST01BW2tdID0KKwkJCQkJ
CWRtbF9taW4oCisJCQkJCQkJCW1vZGVfbGliLT52YmEuTWF4RENIVUJUb1BTQ0xUaHJvdWdocHV0
LAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLk1heFBTQ0xUb0xCVGhyb3VnaHB1dAorCQkJCQkJCQkJ
CSogbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJCQkvIDIKKwkJCQkJCQkJCQkvIGRt
bF9jZWlsKAorCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IVEFQc0Nocm9tYVtrXQorCQkJCQkJ
CQkJCQkJCQkvIDYuMCwKKwkJCQkJCQkJCQkJCTEuMCkpOworCQkJfSBlbHNlIHsKKwkJCQlsb2Nh
bHMtPlBTQ0xfVEhST1VHSFBVVF9DSFJPTUFba10gPSBkbWxfbWluKAorCQkJCQkJbW9kZV9saWIt
PnZiYS5NYXhEQ0hVQlRvUFNDTFRocm91Z2hwdXQsCisJCQkJCQltb2RlX2xpYi0+dmJhLk1heFBT
Q0xUb0xCVGhyb3VnaHB1dCk7CisJCQl9CisJCQltb2RlX2xpYi0+dmJhLkRQUENMS1VzaW5nU2lu
Z2xlRFBQQ2hyb21hID0KKwkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCQkJ
KiBkbWxfbWF4KAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5WVEFQc0Nocm9tYVtrXQorCQkJCQkJ
CQkJCQkvIDYuMAorCQkJCQkJCQkJCQkqIGRtbF9taW4oCisJCQkJCQkJCQkJCQkJMS4wLAorCQkJ
CQkJCQkJCQkJCW1vZGVfbGliLT52YmEuSFJhdGlvW2tdCisJCQkJCQkJCQkJCQkJCQkvIDIpLAor
CQkJCQkJCQkJZG1sX21heCgKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJ
CQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuVlJhdGlvW2tdCisJCQkJCQkJCQkJCQkJLyA0CisJ
CQkJCQkJCQkJCQkJLyBsb2NhbHMtPlBTQ0xfVEhST1VHSFBVVF9DSFJPTUFba10sCisJCQkJCQkJ
CQkJCTEuMCkpOworCisJCQlpZiAoKG1vZGVfbGliLT52YmEuSFRBUHNDaHJvbWFba10gPiA2IHx8
IG1vZGVfbGliLT52YmEuVlRBUHNDaHJvbWFba10gPiA2KQorCQkJCQkmJiBtb2RlX2xpYi0+dmJh
LkRQUENMS1VzaW5nU2luZ2xlRFBQQ2hyb21hCisJCQkJCQkJPCAyICogbW9kZV9saWItPnZiYS5Q
aXhlbENsb2NrW2tdKSB7CisJCQkJbW9kZV9saWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQUENo
cm9tYSA9IDIKKwkJCQkJCSogbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdOworCQkJfQorCisJ
CQlsb2NhbHMtPkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdID0gZG1sX21heCgKKwkJCQkJbW9kZV9s
aWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQUEx1bWEsCisJCQkJCW1vZGVfbGliLT52YmEuRFBQ
Q0xLVXNpbmdTaW5nbGVEUFBDaHJvbWEpOworCQl9CisJfQorCisJZm9yIChrID0gMDsgayA8IG1v
ZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlpZiAobW9kZV9saWIt
PnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSAhPSBrKQorCQkJY29udGludWU7CisJCWlmIChtb2Rl
X2xpYi0+dmJhLk9ETUNvbWJpbmVFbmFibGVkW2tdKSB7CisJCQltb2RlX2xpYi0+dmJhLkRJU1BD
TEtXaXRoUmFtcGluZyA9CisJCQkJCWRtbF9tYXgoCisJCQkJCQkJbW9kZV9saWItPnZiYS5ESVNQ
Q0xLV2l0aFJhbXBpbmcsCisJCQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdIC8gMgor
CQkJCQkJCQkJKiAoMQorCQkJCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RT
Q0NMS0Rvd25TcHJlYWRpbmcKKwkJCQkJCQkJCQkJCQkvIDEwMCkKKwkJCQkJCQkJCSogKDEKKwkJ
CQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtSYW1waW5nTWFyZ2luCisJCQkJCQkJCQkJ
CQkJLyAxMDApKTsKKwkJCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRSYW1waW5nID0KKwkJ
CQkJZG1sX21heCgKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRob3V0UmFtcGluZywK
KwkJCQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10gLyAyCisJCQkJCQkJCQkqICgxCisJ
CQkJCQkJCQkJCSsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGlu
ZworCQkJCQkJCQkJCQkJCS8gMTAwKSk7CisJCX0gZWxzZSBpZiAoIW1vZGVfbGliLT52YmEuT0RN
Q29tYmluZUVuYWJsZWRba10pIHsKKwkJCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhSYW1waW5n
ID0KKwkJCQkJZG1sX21heCgKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRoUmFtcGlu
ZywKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10KKwkJCQkJCQkJCSogKDEKKwkJ
CQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0NDTEtEb3duU3ByZWFkaW5n
CisJCQkJCQkJCQkJCQkJLyAxMDApCisJCQkJCQkJCQkqICgxCisJCQkJCQkJCQkJCSsgbW9kZV9s
aWItPnZiYS5ESVNQQ0xLUmFtcGluZ01hcmdpbgorCQkJCQkJCQkJCQkJCS8gMTAwKSk7CisJCQlt
b2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRob3V0UmFtcGluZyA9CisJCQkJCWRtbF9tYXgoCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aG91dFJhbXBpbmcsCisJCQkJCQkJbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCQkJCQkqICgxCisJCQkJCQkJCQkJCSsgbW9kZV9saWIt
PnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGluZworCQkJCQkJCQkJCQkJCS8gMTAw
KSk7CisJCX0KKwl9CisKKwltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRoUmFtcGluZyA9IGRtbF9t
YXgoCisJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRoUmFtcGluZywKKwkJCW1vZGVfbGliLT52
YmEuV3JpdGViYWNrRElTUENMSyk7CisJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aG91dFJhbXBp
bmcgPSBkbWxfbWF4KAorCQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aG91dFJhbXBpbmcsCisJ
CQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0RJU1BDTEspOworCisJQVNTRVJUKG1vZGVfbGliLT52
YmEuRElTUENMS0RQUENMS1ZDT1NwZWVkICE9IDApOworCW1vZGVfbGliLT52YmEuRElTUENMS1dp
dGhSYW1waW5nUm91bmRlZFRvREZTR3JhbnVsYXJpdHkgPSBSb3VuZFRvREZTR3JhbnVsYXJpdHlV
cCgKKwkJCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhSYW1waW5nLAorCQkJbW9kZV9saWItPnZi
YS5ESVNQQ0xLRFBQQ0xLVkNPU3BlZWQpOworCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRS
YW1waW5nUm91bmRlZFRvREZTR3JhbnVsYXJpdHkgPSBSb3VuZFRvREZTR3JhbnVsYXJpdHlVcCgK
KwkJCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRSYW1waW5nLAorCQkJbW9kZV9saWItPnZi
YS5ESVNQQ0xLRFBQQ0xLVkNPU3BlZWQpOworCW1vZGVfbGliLT52YmEuTWF4RGlzcGNsa1JvdW5k
ZWRUb0RGU0dyYW51bGFyaXR5ID0gUm91bmRUb0RGU0dyYW51bGFyaXR5RG93bigKKwkJCW1vZGVf
bGliLT52YmEuc29jLmNsb2NrX2xpbWl0c1ttb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzIC0g
MV0uZGlzcGNsa19taHosCisJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtWQ09TcGVlZCk7
CisJaWYgKG1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRSYW1waW5nUm91bmRlZFRvREZTR3Jh
bnVsYXJpdHkKKwkJCT4gbW9kZV9saWItPnZiYS5NYXhEaXNwY2xrUm91bmRlZFRvREZTR3JhbnVs
YXJpdHkpIHsKKwkJbW9kZV9saWItPnZiYS5ESVNQQ0xLX2NhbGN1bGF0ZWQgPQorCQkJCW1vZGVf
bGliLT52YmEuRElTUENMS1dpdGhvdXRSYW1waW5nUm91bmRlZFRvREZTR3JhbnVsYXJpdHk7CisJ
fSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRoUmFtcGluZ1JvdW5kZWRUb0RGU0dy
YW51bGFyaXR5CisJCQk+IG1vZGVfbGliLT52YmEuTWF4RGlzcGNsa1JvdW5kZWRUb0RGU0dyYW51
bGFyaXR5KSB7CisJCW1vZGVfbGliLT52YmEuRElTUENMS19jYWxjdWxhdGVkID0gbW9kZV9saWIt
PnZiYS5NYXhEaXNwY2xrUm91bmRlZFRvREZTR3JhbnVsYXJpdHk7CisJfSBlbHNlIHsKKwkJbW9k
ZV9saWItPnZiYS5ESVNQQ0xLX2NhbGN1bGF0ZWQgPQorCQkJCW1vZGVfbGliLT52YmEuRElTUENM
S1dpdGhSYW1waW5nUm91bmRlZFRvREZTR3JhbnVsYXJpdHk7CisJfQorCURUUkFDRSgiICAgZGlz
cGNsa19taHogKGNhbGN1bGF0ZWQpID0gJWYiLCBtb2RlX2xpYi0+dmJhLkRJU1BDTEtfY2FsY3Vs
YXRlZCk7CisKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBs
YW5lczsgKytrKSB7CisJCW1vZGVfbGliLT52YmEuRFBQQ0xLX2NhbGN1bGF0ZWRba10gPSBsb2Nh
bHMtPkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdCisJCQkJLyBtb2RlX2xpYi0+dmJhLkRQUFBlclBs
YW5lW2tdCisJCQkJKiAoMSArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25T
cHJlYWRpbmcgLyAxMDApOworCQltb2RlX2xpYi0+dmJhLkdsb2JhbERQUENMSyA9IGRtbF9tYXgo
CisJCQkJbW9kZV9saWItPnZiYS5HbG9iYWxEUFBDTEssCisJCQkJbW9kZV9saWItPnZiYS5EUFBD
TEtfY2FsY3VsYXRlZFtrXSk7CisJfQorCW1vZGVfbGliLT52YmEuR2xvYmFsRFBQQ0xLID0gUm91
bmRUb0RGU0dyYW51bGFyaXR5VXAoCisJCQltb2RlX2xpYi0+dmJhLkdsb2JhbERQUENMSywKKwkJ
CW1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS1ZDT1NwZWVkKTsKKwlmb3IgKGsgPSAwOyBrIDwg
bW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCW1vZGVfbGliLT52
YmEuRFBQQ0xLX2NhbGN1bGF0ZWRba10gPSBtb2RlX2xpYi0+dmJhLkdsb2JhbERQUENMSyAvIDI1
NQorCQkJCSogZG1sX2NlaWwoCisJCQkJCQltb2RlX2xpYi0+dmJhLkRQUENMS19jYWxjdWxhdGVk
W2tdICogMjU1CisJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5HbG9iYWxEUFBDTEssCisJCQkJCQkx
KTsKKwkJRFRSQUNFKCIgICBkcHBjbGtfbWh6WyVpXSAoY2FsY3VsYXRlZCkgPSAlZiIsIGssIG1v
ZGVfbGliLT52YmEuRFBQQ0xLX2NhbGN1bGF0ZWRba10pOworCX0KKworCS8vIFVyZ2VudCBhbmQg
QiBQLVN0YXRlL0RSQU0gQ2xvY2sgQ2hhbmdlIFdhdGVybWFyaworCURUUkFDRSgiICAgZGNmY2xr
X21oeiAgICAgICAgID0gJWYiLCBtb2RlX2xpYi0+dmJhLkRDRkNMSyk7CisJRFRSQUNFKCIgICBy
ZXR1cm5fYndfdG9fZGNuICAgPSAlZiIsIG1vZGVfbGliLT52YmEuUmV0dXJuQmFuZHdpZHRoVG9E
Q04pOworCURUUkFDRSgiICAgcmV0dXJuX2J1c19idyAgICAgID0gJWYiLCBtb2RlX2xpYi0+dmJh
LlJldHVybkJXKTsKKworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0
aXZlUGxhbmVzOyArK2spIHsKKwkJYm9vbCBNYWluUGxhbmVEb2VzT0RNQ29tYmluZSA9IGZhbHNl
OworCisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikKKwkJCWxv
Y2Fscy0+U3dhdGhXaWR0aFNpbmdsZURQUFlba10gPSBtb2RlX2xpYi0+dmJhLlZpZXdwb3J0V2lk
dGhba107CisJCWVsc2UKKwkJCWxvY2Fscy0+U3dhdGhXaWR0aFNpbmdsZURQUFlba10gPSBtb2Rl
X2xpYi0+dmJhLlZpZXdwb3J0SGVpZ2h0W2tdOworCisJCWlmIChtb2RlX2xpYi0+dmJhLk9ETUNv
bWJpbmVFbmFibGVkW2tdID09IHRydWUpCisJCQlNYWluUGxhbmVEb2VzT0RNQ29tYmluZSA9IHRy
dWU7CisJCWZvciAoaiA9IDA7IGogPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVz
OyArK2opCisJCQlpZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBqCisJ
CQkJCSYmIG1vZGVfbGliLT52YmEuT0RNQ29tYmluZUVuYWJsZWRbal0gPT0gdHJ1ZSkKKwkJCQlN
YWluUGxhbmVEb2VzT0RNQ29tYmluZSA9IHRydWU7CisKKwkJaWYgKE1haW5QbGFuZURvZXNPRE1D
b21iaW5lID09IHRydWUpCisJCQlsb2NhbHMtPlN3YXRoV2lkdGhZW2tdID0gZG1sX21pbigKKwkJ
CQkJKGRvdWJsZSkgbG9jYWxzLT5Td2F0aFdpZHRoU2luZ2xlRFBQWVtrXSwKKwkJCQkJZG1sX3Jv
dW5kKAorCQkJCQkJCW1vZGVfbGliLT52YmEuSEFjdGl2ZVtrXSAvIDIuMAorCQkJCQkJCQkJKiBt
b2RlX2xpYi0+dmJhLkhSYXRpb1trXSkpOworCQllbHNlCisJCQlsb2NhbHMtPlN3YXRoV2lkdGhZ
W2tdID0gbG9jYWxzLT5Td2F0aFdpZHRoU2luZ2xlRFBQWVtrXQorCQkJCQkvIG1vZGVfbGliLT52
YmEuRFBQUGVyUGxhbmVba107CisJfQorCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEu
TnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQ
aXhlbEZvcm1hdFtrXSA9PSBkbV80NDRfNjQpIHsKKwkJCWxvY2Fscy0+Qnl0ZVBlclBpeGVsREVU
WVtrXSA9IDg7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbERFVENba10gPSAwOworCQl9IGVsc2Ug
aWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzMyKSB7CisJ
CQlsb2NhbHMtPkJ5dGVQZXJQaXhlbERFVFlba10gPSA0OworCQkJbG9jYWxzLT5CeXRlUGVyUGl4
ZWxERVRDW2tdID0gMDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9y
bWF0W2tdID09IGRtXzQ0NF8xNiB8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2td
ID09IGRtX21vbm9fMTYpIHsKKwkJCWxvY2Fscy0+Qnl0ZVBlclBpeGVsREVUWVtrXSA9IDI7CisJ
CQlsb2NhbHMtPkJ5dGVQZXJQaXhlbERFVENba10gPSAwOworCQl9IGVsc2UgaWYgKG1vZGVfbGli
LT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzggfHwgbW9kZV9saWItPnZiYS5T
b3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV9tb25vXzgpIHsKKwkJCWxvY2Fscy0+Qnl0ZVBlclBp
eGVsREVUWVtrXSA9IDE7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbERFVENba10gPSAwOworCQl9
IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDIwXzgp
IHsKKwkJCWxvY2Fscy0+Qnl0ZVBlclBpeGVsREVUWVtrXSA9IDE7CisJCQlsb2NhbHMtPkJ5dGVQ
ZXJQaXhlbERFVENba10gPSAyOworCQl9IGVsc2UgeyAvLyBkbV80MjBfMTAKKwkJCWxvY2Fscy0+
Qnl0ZVBlclBpeGVsREVUWVtrXSA9IDQuMCAvIDMuMDsKKwkJCWxvY2Fscy0+Qnl0ZVBlclBpeGVs
REVUQ1trXSA9IDguMCAvIDMuMDsKKwkJfQorCX0KKworCW1vZGVfbGliLT52YmEuVG90YWxEYXRh
UmVhZEJhbmR3aWR0aCA9IDAuMDsKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1i
ZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWxvY2Fscy0+UmVhZEJhbmR3aWR0aFBsYW5lTHVt
YVtrXSA9IGxvY2Fscy0+U3dhdGhXaWR0aFNpbmdsZURQUFlba10KKwkJCQkqIGRtbF9jZWlsKGxv
Y2Fscy0+Qnl0ZVBlclBpeGVsREVUWVtrXSwgMSkKKwkJCQkvIChtb2RlX2xpYi0+dmJhLkhUb3Rh
bFtrXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkKKwkJCQkqIG1vZGVfbGliLT52YmEu
VlJhdGlvW2tdOworCQlsb2NhbHMtPlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXSA9IGxvY2Fs
cy0+U3dhdGhXaWR0aFNpbmdsZURQUFlba10KKwkJCQkvIDIgKiBkbWxfY2VpbChsb2NhbHMtPkJ5
dGVQZXJQaXhlbERFVENba10sIDIpCisJCQkJLyAobW9kZV9saWItPnZiYS5IVG90YWxba10gLyBt
b2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pCisJCQkJKiBtb2RlX2xpYi0+dmJhLlZSYXRpb1tr
XSAvIDI7CisJCURUUkFDRSgKKwkJCQkiICAgcmVhZF9id1slaV0gPSAlZkJwcyIsCisJCQkJaywK
KwkJCQlsb2NhbHMtPlJlYWRCYW5kd2lkdGhQbGFuZUx1bWFba10KKwkJCQkJCSsgbG9jYWxzLT5S
ZWFkQmFuZHdpZHRoUGxhbmVDaHJvbWFba10pOworCQltb2RlX2xpYi0+dmJhLlRvdGFsRGF0YVJl
YWRCYW5kd2lkdGggKz0gbG9jYWxzLT5SZWFkQmFuZHdpZHRoUGxhbmVMdW1hW2tdCisJCQkJKyBs
b2NhbHMtPlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXTsKKwl9CisKKwkvLyBEQ0ZDTEsgRGVl
cCBTbGVlcAorCUNhbGN1bGF0ZURDRkNMS0RlZXBTbGVlcCgKKwkJbW9kZV9saWIsCisJCW1vZGVf
bGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMsCisJCWxvY2Fscy0+Qnl0ZVBlclBpeGVsREVU
WSwKKwkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxERVRDLAorCQltb2RlX2xpYi0+dmJhLlZSYXRpbywK
KwkJbG9jYWxzLT5Td2F0aFdpZHRoWSwKKwkJbW9kZV9saWItPnZiYS5EUFBQZXJQbGFuZSwKKwkJ
bW9kZV9saWItPnZiYS5IUmF0aW8sCisJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9jaywKKwkJbG9j
YWxzLT5QU0NMX1RIUk9VR0hQVVRfTFVNQSwKKwkJbG9jYWxzLT5QU0NMX1RIUk9VR0hQVVRfQ0hS
T01BLAorCQlsb2NhbHMtPkRQUENMSywKKwkJJm1vZGVfbGliLT52YmEuRENGQ0xLRGVlcFNsZWVw
KTsKKworCS8vIERTQ0NMSworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9m
QWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKChtb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGlt
aW5nW2tdICE9IGspIHx8ICFtb2RlX2xpYi0+dmJhLkRTQ0VuYWJsZWRba10pIHsKKwkJCWxvY2Fs
cy0+RFNDQ0xLX2NhbGN1bGF0ZWRba10gPSAwLjA7CisJCX0gZWxzZSB7CisJCQlpZiAobW9kZV9s
aWItPnZiYS5PdXRwdXRGb3JtYXRba10gPT0gZG1fNDIwCisJCQkJCXx8IG1vZGVfbGliLT52YmEu
T3V0cHV0Rm9ybWF0W2tdID09IGRtX240MjIpCisJCQkJbW9kZV9saWItPnZiYS5EU0NGb3JtYXRG
YWN0b3IgPSAyOworCQkJZWxzZQorCQkJCW1vZGVfbGliLT52YmEuRFNDRm9ybWF0RmFjdG9yID0g
MTsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLk9ETUNvbWJpbmVFbmFibGVkW2tdKQorCQkJCWxvY2Fs
cy0+RFNDQ0xLX2NhbGN1bGF0ZWRba10gPQorCQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2Nr
QmFja0VuZFtrXSAvIDYKKwkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkRTQ0Zvcm1hdEZhY3Rvcgor
CQkJCQkJCQkvICgxCisJCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0ND
TEtEb3duU3ByZWFkaW5nCisJCQkJCQkJCQkJCQkvIDEwMCk7CisJCQllbHNlCisJCQkJbG9jYWxz
LT5EU0NDTEtfY2FsY3VsYXRlZFtrXSA9CisJCQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tC
YWNrRW5kW2tdIC8gMworCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuRFNDRm9ybWF0RmFjdG9yCisJ
CQkJCQkJCS8gKDEKKwkJCQkJCQkJCQktIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NM
S0Rvd25TcHJlYWRpbmcKKwkJCQkJCQkJCQkJCS8gMTAwKTsKKwkJfQorCX0KKworCS8vIERTQyBE
ZWxheQorCS8vIFRPRE8KKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFj
dGl2ZVBsYW5lczsgKytrKSB7CisJCWRvdWJsZSBicHAgPSBtb2RlX2xpYi0+dmJhLk91dHB1dEJw
cFtrXTsKKwkJdW5zaWduZWQgaW50IHNsaWNlcyA9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZEU0NT
bGljZXNba107CisKKwkJaWYgKG1vZGVfbGliLT52YmEuRFNDRW5hYmxlZFtrXSAmJiBicHAgIT0g
MCkgeworCQkJaWYgKCFtb2RlX2xpYi0+dmJhLk9ETUNvbWJpbmVFbmFibGVkW2tdKSB7CisJCQkJ
bG9jYWxzLT5EU0NEZWxheVtrXSA9CisJCQkJCQlkc2NjZUNvbXB1dGVEZWxheSgKKwkJCQkJCQkJ
bW9kZV9saWItPnZiYS5EU0NJbnB1dEJpdFBlckNvbXBvbmVudFtrXSwKKwkJCQkJCQkJYnBwLAor
CQkJCQkJCQlkbWxfY2VpbCgKKwkJCQkJCQkJCQkoZG91YmxlKSBtb2RlX2xpYi0+dmJhLkhBY3Rp
dmVba10KKwkJCQkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5OdW1iZXJPZkRTQ1NsaWNlc1trXSwK
KwkJCQkJCQkJCQkxKSwKKwkJCQkJCQkJc2xpY2VzLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLk91
dHB1dEZvcm1hdFtrXSkKKwkJCQkJCQkJKyBkc2NDb21wdXRlRGVsYXkoCisJCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10pOworCQkJfSBlbHNlIHsKKwkJCQlsb2NhbHMtPkRT
Q0RlbGF5W2tdID0KKwkJCQkJCTIKKwkJCQkJCQkJKiAoZHNjY2VDb21wdXRlRGVsYXkoCisJCQkJ
CQkJCQkJbW9kZV9saWItPnZiYS5EU0NJbnB1dEJpdFBlckNvbXBvbmVudFtrXSwKKwkJCQkJCQkJ
CQlicHAsCisJCQkJCQkJCQkJZG1sX2NlaWwoCisJCQkJCQkJCQkJCQkoZG91YmxlKSBtb2RlX2xp
Yi0+dmJhLkhBY3RpdmVba10KKwkJCQkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLk51bWJlck9m
RFNDU2xpY2VzW2tdLAorCQkJCQkJCQkJCQkJMSksCisJCQkJCQkJCQkJc2xpY2VzIC8gMi4wLAor
CQkJCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0W2tdKQorCQkJCQkJCQkJCSsgZHNj
Q29tcHV0ZURlbGF5KAorCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10p
KTsKKwkJCX0KKwkJCWxvY2Fscy0+RFNDRGVsYXlba10gPSBsb2NhbHMtPkRTQ0RlbGF5W2tdCisJ
CQkJCSogbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCS8gbW9kZV9saWItPnZiYS5Q
aXhlbENsb2NrQmFja0VuZFtrXTsKKwkJfSBlbHNlIHsKKwkJCWxvY2Fscy0+RFNDRGVsYXlba10g
PSAwOworCQl9CisJfQorCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZB
Y3RpdmVQbGFuZXM7ICsraykKKwkJZm9yIChqID0gMDsgaiA8IG1vZGVfbGliLT52YmEuTnVtYmVy
T2ZBY3RpdmVQbGFuZXM7ICsraikgLy8gTnVtYmVyT2ZQbGFuZXMKKwkJCWlmIChqICE9IGsgJiYg
bW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBqCisJCQkJCSYmIG1vZGVfbGli
LT52YmEuRFNDRW5hYmxlZFtqXSkKKwkJCQlsb2NhbHMtPkRTQ0RlbGF5W2tdID0gbG9jYWxzLT5E
U0NEZWxheVtqXTsKKworCS8vIFByZWZldGNoCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52
YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQl1bnNpZ25lZCBpbnQgUERFQW5kTWV0
YVBURUJ5dGVzRnJhbWVZOworCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVCeXRlc1BlclJvd1k7CisJ
CXVuc2lnbmVkIGludCBNZXRhUm93Qnl0ZVk7CisJCXVuc2lnbmVkIGludCBNZXRhUm93Qnl0ZUM7
CisJCXVuc2lnbmVkIGludCBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZUM7CisJCXVuc2lnbmVkIGlu
dCBQaXhlbFBURUJ5dGVzUGVyUm93QzsKKwkJYm9vbCAgICAgICAgIFBURUJ1ZmZlclNpemVOb3RF
eGNlZWRlZFk7CisJCWJvb2wgICAgICAgICBQVEVCdWZmZXJTaXplTm90RXhjZWVkZWRDOworCisJ
CUNhbGN1bGF0ZTI1NkJCbG9ja1NpemVzKAorCQkJCW1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxG
b3JtYXRba10sCisJCQkJbW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdLAorCQkJCWRtbF9j
ZWlsKGxvY2Fscy0+Qnl0ZVBlclBpeGVsREVUWVtrXSwgMSksCisJCQkJZG1sX2NlaWwobG9jYWxz
LT5CeXRlUGVyUGl4ZWxERVRDW2tdLCAyKSwKKwkJCQkmbG9jYWxzLT5CbG9ja0hlaWdodDI1NkJ5
dGVzWVtrXSwKKwkJCQkmbG9jYWxzLT5CbG9ja0hlaWdodDI1NkJ5dGVzQ1trXSwKKwkJCQkmbG9j
YWxzLT5CbG9ja1dpZHRoMjU2Qnl0ZXNZW2tdLAorCQkJCSZsb2NhbHMtPkJsb2NrV2lkdGgyNTZC
eXRlc0Nba10pOworCisJCWxvY2Fscy0+UHJlZmV0Y2hTb3VyY2VMaW5lc1lba10gPSBDYWxjdWxh
dGVQcmVmZXRjaFNvdXJjZUxpbmVzKAorCQkJCW1vZGVfbGliLAorCQkJCW1vZGVfbGliLT52YmEu
VlJhdGlvW2tdLAorCQkJCW1vZGVfbGliLT52YmEudnRhcHNba10sCisJCQkJbW9kZV9saWItPnZi
YS5JbnRlcmxhY2Vba10sCisJCQkJbW9kZV9saWItPnZiYS5Qcm9ncmVzc2l2ZVRvSW50ZXJsYWNl
VW5pdEluT1BQLAorCQkJCW1vZGVfbGliLT52YmEuU3dhdGhIZWlnaHRZW2tdLAorCQkJCW1vZGVf
bGliLT52YmEuVmlld3BvcnRZU3RhcnRZW2tdLAorCQkJCSZsb2NhbHMtPlZJbml0UHJlRmlsbFlb
a10sCisJCQkJJmxvY2Fscy0+TWF4TnVtU3dhdGhZW2tdKTsKKworCQlpZiAoKG1vZGVfbGliLT52
YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzY0CisJCQkJJiYgbW9kZV9saWItPnZi
YS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80NDRfMzIKKwkJCQkmJiBtb2RlX2xpYi0+dmJh
LlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQ0NF8xNgorCQkJCSYmIG1vZGVfbGliLT52YmEu
U291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzgpKSB7CisJCQlQREVBbmRNZXRhUFRFQnl0
ZXNGcmFtZUMgPQorCQkJCQlDYWxjdWxhdGVWTUFuZFJvd0J5dGVzKAorCQkJCQkJCW1vZGVfbGli
LAorCQkJCQkJCW1vZGVfbGliLT52YmEuRENDRW5hYmxlW2tdLAorCQkJCQkJCWxvY2Fscy0+Qmxv
Y2tIZWlnaHQyNTZCeXRlc0Nba10sCisJCQkJCQkJbG9jYWxzLT5CbG9ja1dpZHRoMjU2Qnl0ZXND
W2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10sCisJCQkJCQkJ
bW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdLAorCQkJCQkJCWRtbF9jZWlsKAorCQkJCQkJ
CQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxERVRDW2tdLAorCQkJCQkJCQkJMiksCisJCQkJCQkJbW9k
ZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuVmlld3BvcnRX
aWR0aFtrXSAvIDIsCisJCQkJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydEhlaWdodFtrXSAvIDIs
CisJCQkJCQkJbG9jYWxzLT5Td2F0aFdpZHRoWVtrXSAvIDIsCisJCQkJCQkJbW9kZV9saWItPnZi
YS5HUFVWTUVuYWJsZSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkhvc3RWTUVuYWJsZSwKKwkJCQkJ
CQltb2RlX2xpYi0+dmJhLkhvc3RWTU1heFBhZ2VUYWJsZUxldmVscywKKwkJCQkJCQltb2RlX2xp
Yi0+dmJhLkhvc3RWTUNhY2hlZFBhZ2VUYWJsZUxldmVscywKKwkJCQkJCQltb2RlX2xpYi0+dmJh
LlZNTVBhZ2VTaXplLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUFRFQnVmZmVyU2l6ZUluUmVxdWVz
dHNDaHJvbWEsCisJCQkJCQkJbW9kZV9saWItPnZiYS5QaXRjaENba10sCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5EQ0NNZXRhUGl0Y2hDW2tdLAorCQkJCQkJCSZsb2NhbHMtPk1hY3JvVGlsZVdpZHRo
Q1trXSwKKwkJCQkJCQkmTWV0YVJvd0J5dGVDLAorCQkJCQkJCSZQaXhlbFBURUJ5dGVzUGVyUm93
QywKKwkJCQkJCQkmUFRFQnVmZmVyU2l6ZU5vdEV4Y2VlZGVkQywKKwkJCQkJCQkmbG9jYWxzLT5k
cHRlX3Jvd193aWR0aF9jaHJvbWFfdWJba10sCisJCQkJCQkJJmxvY2Fscy0+ZHB0ZV9yb3dfaGVp
Z2h0X2Nocm9tYVtrXSwKKwkJCQkJCQkmbG9jYWxzLT5tZXRhX3JlcV93aWR0aF9jaHJvbWFba10s
CisJCQkJCQkJJmxvY2Fscy0+bWV0YV9yZXFfaGVpZ2h0X2Nocm9tYVtrXSwKKwkJCQkJCQkmbG9j
YWxzLT5tZXRhX3Jvd193aWR0aF9jaHJvbWFba10sCisJCQkJCQkJJmxvY2Fscy0+bWV0YV9yb3df
aGVpZ2h0X2Nocm9tYVtrXSwKKwkJCQkJCQkmbG9jYWxzLT52bV9ncm91cF9ieXRlc19jaHJvbWEs
CisJCQkJCQkJJmxvY2Fscy0+ZHB0ZV9ncm91cF9ieXRlc19jaHJvbWEsCisJCQkJCQkJJmxvY2Fs
cy0+UGl4ZWxQVEVSZXFXaWR0aENba10sCisJCQkJCQkJJmxvY2Fscy0+UGl4ZWxQVEVSZXFIZWln
aHRDW2tdLAorCQkJCQkJCSZsb2NhbHMtPlBURVJlcXVlc3RTaXplQ1trXSwKKwkJCQkJCQkmbG9j
YWxzLT5kcGRlMF9ieXRlc19wZXJfZnJhbWVfdWJfY1trXSwKKwkJCQkJCQkmbG9jYWxzLT5tZXRh
X3B0ZV9ieXRlc19wZXJfZnJhbWVfdWJfY1trXSk7CisKKwkJCWxvY2Fscy0+UHJlZmV0Y2hTb3Vy
Y2VMaW5lc0Nba10gPSBDYWxjdWxhdGVQcmVmZXRjaFNvdXJjZUxpbmVzKAorCQkJCQltb2RlX2xp
YiwKKwkJCQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10gLyAyLAorCQkJCQltb2RlX2xpYi0+dmJh
LlZUQVBzQ2hyb21hW2tdLAorCQkJCQltb2RlX2xpYi0+dmJhLkludGVybGFjZVtrXSwKKwkJCQkJ
bW9kZV9saWItPnZiYS5Qcm9ncmVzc2l2ZVRvSW50ZXJsYWNlVW5pdEluT1BQLAorCQkJCQltb2Rl
X2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSwKKwkJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydFlT
dGFydENba10sCisJCQkJCSZsb2NhbHMtPlZJbml0UHJlRmlsbENba10sCisJCQkJCSZsb2NhbHMt
Pk1heE51bVN3YXRoQ1trXSk7CisJCX0gZWxzZSB7CisJCQlQaXhlbFBURUJ5dGVzUGVyUm93QyA9
IDA7CisJCQlQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZUMgPSAwOworCQkJTWV0YVJvd0J5dGVDID0g
MDsKKwkJCWxvY2Fscy0+TWF4TnVtU3dhdGhDW2tdID0gMDsKKwkJCWxvY2Fscy0+UHJlZmV0Y2hT
b3VyY2VMaW5lc0Nba10gPSAwOworCQkJbG9jYWxzLT5QVEVCdWZmZXJTaXplSW5SZXF1ZXN0c0Zv
ckx1bWEgPSBtb2RlX2xpYi0+dmJhLlBURUJ1ZmZlclNpemVJblJlcXVlc3RzTHVtYSArIG1vZGVf
bGliLT52YmEuUFRFQnVmZmVyU2l6ZUluUmVxdWVzdHNDaHJvbWE7CisJCX0KKworCQlQREVBbmRN
ZXRhUFRFQnl0ZXNGcmFtZVkgPSBDYWxjdWxhdGVWTUFuZFJvd0J5dGVzKAorCQkJCW1vZGVfbGli
LAorCQkJCW1vZGVfbGliLT52YmEuRENDRW5hYmxlW2tdLAorCQkJCWxvY2Fscy0+QmxvY2tIZWln
aHQyNTZCeXRlc1lba10sCisJCQkJbG9jYWxzLT5CbG9ja1dpZHRoMjU2Qnl0ZXNZW2tdLAorCQkJ
CW1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10sCisJCQkJbW9kZV9saWItPnZiYS5T
dXJmYWNlVGlsaW5nW2tdLAorCQkJCWRtbF9jZWlsKGxvY2Fscy0+Qnl0ZVBlclBpeGVsREVUWVtr
XSwgMSksCisJCQkJbW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdLAorCQkJCW1vZGVfbGliLT52
YmEuVmlld3BvcnRXaWR0aFtrXSwKKwkJCQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0SGVpZ2h0W2td
LAorCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFlba10sCisJCQkJbW9kZV9saWItPnZiYS5HUFVWTUVu
YWJsZSwKKwkJCQltb2RlX2xpYi0+dmJhLkhvc3RWTUVuYWJsZSwKKwkJCQltb2RlX2xpYi0+dmJh
Lkhvc3RWTU1heFBhZ2VUYWJsZUxldmVscywKKwkJCQltb2RlX2xpYi0+dmJhLkhvc3RWTUNhY2hl
ZFBhZ2VUYWJsZUxldmVscywKKwkJCQltb2RlX2xpYi0+dmJhLlZNTVBhZ2VTaXplLAorCQkJCWxv
Y2Fscy0+UFRFQnVmZmVyU2l6ZUluUmVxdWVzdHNGb3JMdW1hLAorCQkJCW1vZGVfbGliLT52YmEu
UGl0Y2hZW2tdLAorCQkJCW1vZGVfbGliLT52YmEuRENDTWV0YVBpdGNoWVtrXSwKKwkJCQkmbG9j
YWxzLT5NYWNyb1RpbGVXaWR0aFlba10sCisJCQkJJk1ldGFSb3dCeXRlWSwKKwkJCQkmUGl4ZWxQ
VEVCeXRlc1BlclJvd1ksCisJCQkJJlBURUJ1ZmZlclNpemVOb3RFeGNlZWRlZFksCisJCQkJJmxv
Y2Fscy0+ZHB0ZV9yb3dfd2lkdGhfbHVtYV91YltrXSwKKwkJCQkmbG9jYWxzLT5kcHRlX3Jvd19o
ZWlnaHRba10sCisJCQkJJmxvY2Fscy0+bWV0YV9yZXFfd2lkdGhba10sCisJCQkJJmxvY2Fscy0+
bWV0YV9yZXFfaGVpZ2h0W2tdLAorCQkJCSZsb2NhbHMtPm1ldGFfcm93X3dpZHRoW2tdLAorCQkJ
CSZsb2NhbHMtPm1ldGFfcm93X2hlaWdodFtrXSwKKwkJCQkmbG9jYWxzLT52bV9ncm91cF9ieXRl
c1trXSwKKwkJCQkmbG9jYWxzLT5kcHRlX2dyb3VwX2J5dGVzW2tdLAorCQkJCSZsb2NhbHMtPlBp
eGVsUFRFUmVxV2lkdGhZW2tdLAorCQkJCSZsb2NhbHMtPlBpeGVsUFRFUmVxSGVpZ2h0WVtrXSwK
KwkJCQkmbG9jYWxzLT5QVEVSZXF1ZXN0U2l6ZVlba10sCisJCQkJJmxvY2Fscy0+ZHBkZTBfYnl0
ZXNfcGVyX2ZyYW1lX3ViX2xba10sCisJCQkJJmxvY2Fscy0+bWV0YV9wdGVfYnl0ZXNfcGVyX2Zy
YW1lX3ViX2xba10pOworCisJCWxvY2Fscy0+UGl4ZWxQVEVCeXRlc1BlclJvd1trXSA9IFBpeGVs
UFRFQnl0ZXNQZXJSb3dZICsgUGl4ZWxQVEVCeXRlc1BlclJvd0M7CisJCWxvY2Fscy0+UERFQW5k
TWV0YVBURUJ5dGVzRnJhbWVba10gPSBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZVkKKwkJCQkrIFBE
RUFuZE1ldGFQVEVCeXRlc0ZyYW1lQzsKKwkJbG9jYWxzLT5NZXRhUm93Qnl0ZVtrXSA9IE1ldGFS
b3dCeXRlWSArIE1ldGFSb3dCeXRlQzsKKworCQlDYWxjdWxhdGVBY3RpdmVSb3dCYW5kd2lkdGgo
CisJCQkJbW9kZV9saWItPnZiYS5HUFVWTUVuYWJsZSwKKwkJCQltb2RlX2xpYi0+dmJhLlNvdXJj
ZVBpeGVsRm9ybWF0W2tdLAorCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCW1vZGVf
bGliLT52YmEuRENDRW5hYmxlW2tdLAorCQkJCW1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9k
ZV9saWItPnZiYS5QaXhlbENsb2NrW2tdLAorCQkJCU1ldGFSb3dCeXRlWSwKKwkJCQlNZXRhUm93
Qnl0ZUMsCisJCQkJbG9jYWxzLT5tZXRhX3Jvd19oZWlnaHRba10sCisJCQkJbG9jYWxzLT5tZXRh
X3Jvd19oZWlnaHRfY2hyb21hW2tdLAorCQkJCVBpeGVsUFRFQnl0ZXNQZXJSb3dZLAorCQkJCVBp
eGVsUFRFQnl0ZXNQZXJSb3dDLAorCQkJCWxvY2Fscy0+ZHB0ZV9yb3dfaGVpZ2h0W2tdLAorCQkJ
CWxvY2Fscy0+ZHB0ZV9yb3dfaGVpZ2h0X2Nocm9tYVtrXSwKKwkJCQkmbG9jYWxzLT5tZXRhX3Jv
d19id1trXSwKKwkJCQkmbG9jYWxzLT5kcHRlX3Jvd19id1trXSk7CisJfQorCisJbW9kZV9saWIt
PnZiYS5Ub3RhbERDQ0FjdGl2ZURQUCA9IDA7CisJbW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZURQ
UCA9IDA7CisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFu
ZXM7ICsraykgeworCQltb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlRFBQID0gbW9kZV9saWItPnZi
YS5Ub3RhbEFjdGl2ZURQUAorCQkJCSsgbW9kZV9saWItPnZiYS5EUFBQZXJQbGFuZVtrXTsKKwkJ
aWYgKG1vZGVfbGliLT52YmEuRENDRW5hYmxlW2tdKQorCQkJbW9kZV9saWItPnZiYS5Ub3RhbERD
Q0FjdGl2ZURQUCA9IG1vZGVfbGliLT52YmEuVG90YWxEQ0NBY3RpdmVEUFAKKwkJCQkJKyBtb2Rl
X2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdOworCX0KKworCW1vZGVfbGliLT52YmEuVXJnZW50T3V0
T2ZPcmRlclJldHVyblBlckNoYW5uZWwgPSBkbWxfbWF4MygKKwkJCW1vZGVfbGliLT52YmEuVXJn
ZW50T3V0T2ZPcmRlclJldHVyblBlckNoYW5uZWxQaXhlbERhdGFPbmx5LAorCQkJbW9kZV9saWIt
PnZiYS5VcmdlbnRPdXRPZk9yZGVyUmV0dXJuUGVyQ2hhbm5lbFBpeGVsTWl4ZWRXaXRoVk1EYXRh
LAorCQkJbW9kZV9saWItPnZiYS5VcmdlbnRPdXRPZk9yZGVyUmV0dXJuUGVyQ2hhbm5lbFZNRGF0
YU9ubHkpOworCisJbW9kZV9saWItPnZiYS5VcmdlbnRSb3VuZFRyaXBBbmRPdXRPZk9yZGVyTGF0
ZW5jeSA9CisJCQkobW9kZV9saWItPnZiYS5Sb3VuZFRyaXBQaW5nTGF0ZW5jeUN5Y2xlcyArIDMy
KSAvIG1vZGVfbGliLT52YmEuRENGQ0xLCisJCQkJCSsgbW9kZV9saWItPnZiYS5VcmdlbnRPdXRP
Zk9yZGVyUmV0dXJuUGVyQ2hhbm5lbAorCQkJCQkJCSogbW9kZV9saWItPnZiYS5OdW1iZXJPZkNo
YW5uZWxzCisJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlJldHVybkJXOworCisJbW9kZV9saWItPnZi
YS5VcmdlbnRFeHRyYUxhdGVuY3kgPSBDYWxjdWxhdGVFeHRyYUxhdGVuY3koCisJCQltb2RlX2xp
Yi0+dmJhLlVyZ2VudFJvdW5kVHJpcEFuZE91dE9mT3JkZXJMYXRlbmN5LAorCQkJbW9kZV9saWIt
PnZiYS5Ub3RhbEFjdGl2ZURQUCwKKwkJCW1vZGVfbGliLT52YmEuUGl4ZWxDaHVua1NpemVJbktC
eXRlLAorCQkJbW9kZV9saWItPnZiYS5Ub3RhbERDQ0FjdGl2ZURQUCwKKwkJCW1vZGVfbGliLT52
YmEuTWV0YUNodW5rU2l6ZSwKKwkJCW1vZGVfbGliLT52YmEuUmV0dXJuQlcsCisJCQltb2RlX2xp
Yi0+dmJhLkdQVVZNRW5hYmxlLAorCQkJbW9kZV9saWItPnZiYS5Ib3N0Vk1FbmFibGUsCisJCQlt
b2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzLAorCQkJbW9kZV9saWItPnZiYS5EUFBQ
ZXJQbGFuZSwKKwkJCWxvY2Fscy0+ZHB0ZV9ncm91cF9ieXRlcywKKwkJCW1vZGVfbGliLT52YmEu
UGVyY2VudE9mSWRlYWxEUkFNRmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRlclVyZ0xhdGVu
Y3lQaXhlbE1peGVkV2l0aFZNRGF0YSwKKwkJCW1vZGVfbGliLT52YmEuUGVyY2VudE9mSWRlYWxE
UkFNRmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRlclVyZ0xhdGVuY3lWTURhdGFPbmx5LAor
CQkJbW9kZV9saWItPnZiYS5Ib3N0Vk1NYXhQYWdlVGFibGVMZXZlbHMsCisJCQltb2RlX2xpYi0+
dmJhLkhvc3RWTUNhY2hlZFBhZ2VUYWJsZUxldmVscyk7CisKKworCW1vZGVfbGliLT52YmEuVENh
bGMgPSAyNC4wIC8gbW9kZV9saWItPnZiYS5EQ0ZDTEtEZWVwU2xlZXA7CisKKwlmb3IgKGsgPSAw
OyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmICht
b2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdID09IGspIHsKKwkJCWlmIChtb2RlX2xp
Yi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9PSB0cnVlKSB7CisJCQkJbG9jYWxzLT5Xcml0ZWJh
Y2tEZWxheVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1ba10gPQorCQkJCQkJbW9kZV9saWIt
PnZiYS5Xcml0ZWJhY2tMYXRlbmN5CisJCQkJCQkJCSsgQ2FsY3VsYXRlV3JpdGVCYWNrRGVsYXko
CisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSwKKwkJCQkJ
CQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0hSYXRpb1trXSwKKwkJCQkJCQkJCQltb2RlX2xp
Yi0+dmJhLldyaXRlYmFja1ZSYXRpb1trXSwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRl
YmFja0x1bWFIVGFwc1trXSwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFW
VGFwc1trXSwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYUhUYXBzW2td
LAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hVlRhcHNba10sCisJCQkJ
CQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoW2tdKQorCQkJCQkJ
CQkJCS8gbW9kZV9saWItPnZiYS5ESVNQQ0xLOworCQkJfSBlbHNlCisJCQkJbG9jYWxzLT5Xcml0
ZWJhY2tEZWxheVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1ba10gPSAwOworCQkJZm9yIChq
ID0gMDsgaiA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraikgeworCQkJ
CWlmIChtb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2pdID09IGsKKwkJCQkJCSYmIG1v
ZGVfbGliLT52YmEuV3JpdGViYWNrRW5hYmxlW2pdID09IHRydWUpIHsKKwkJCQkJbG9jYWxzLT5X
cml0ZWJhY2tEZWxheVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1ba10gPQorCQkJCQkJCWRt
bF9tYXgoCisJCQkJCQkJCQlsb2NhbHMtPldyaXRlYmFja0RlbGF5W21vZGVfbGliLT52YmEuVm9s
dGFnZUxldmVsXVtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTGF0ZW5jeQor
CQkJCQkJCQkJCQkrIENhbGN1bGF0ZVdyaXRlQmFja0RlbGF5KAorCQkJCQkJCQkJCQkJCW1vZGVf
bGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRbal0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWIt
PnZiYS5Xcml0ZWJhY2tIUmF0aW9bal0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0
ZWJhY2tWUmF0aW9bal0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1h
SFRhcHNbal0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVlRhcHNb
al0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFIVGFwc1tqXSwK
KwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYVZUYXBzW2pdLAorCQkJ
CQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFtqXSkKKwkJ
CQkJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuRElTUENMSyk7CisJCQkJfQorCQkJfQorCQl9CisJ
fQorCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7
ICsraykKKwkJZm9yIChqID0gMDsgaiA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFu
ZXM7ICsraikKKwkJCWlmIChtb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdID09IGop
CisJCQkJbG9jYWxzLT5Xcml0ZWJhY2tEZWxheVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1b
a10gPQorCQkJCQkJbG9jYWxzLT5Xcml0ZWJhY2tEZWxheVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VM
ZXZlbF1bal07CisKKwltb2RlX2xpYi0+dmJhLlZTdGFydHVwTGluZXMgPSAxMzsKKwlmb3IgKGsg
PSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWxv
Y2Fscy0+TWF4VlN0YXJ0dXBMaW5lc1trXSA9IG1vZGVfbGliLT52YmEuVlRvdGFsW2tdIC0gbW9k
ZV9saWItPnZiYS5WQWN0aXZlW2tdIC0gZG1sX21heCgxLjAsIGRtbF9jZWlsKGxvY2Fscy0+V3Jp
dGViYWNrRGVsYXlbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdW2tdIC8gKG1vZGVfbGliLT52
YmEuSFRvdGFsW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKSwgMSkpOworCX0KKwor
CWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2sp
CisJCWxvY2Fscy0+TWF4aW11bU1heFZTdGFydHVwTGluZXMgPSBkbWxfbWF4KGxvY2Fscy0+TWF4
aW11bU1heFZTdGFydHVwTGluZXMsIGxvY2Fscy0+TWF4VlN0YXJ0dXBMaW5lc1trXSk7CisKKwkv
LyBXZSBkb24ndCByZWFsbHkgY2FyZSB0byBpdGVyYXRlIGJldHdlZW4gdGhlIHZhcmlvdXMgcHJl
ZmV0Y2ggbW9kZXMKKwkvL21vZGVfbGliLT52YmEuUHJlZmV0Y2hFUlJPUiA9IENhbGN1bGF0ZU1p
bkFuZE1heFByZWZldGNoTW9kZShtb2RlX2xpYi0+dmJhLkFsbG93RFJBTVNlbGZSZWZyZXNoT3JE
UkFNQ2xvY2tDaGFuZ2VJblZibGFuaywgJm1vZGVfbGliLT52YmEuTWluUHJlZmV0Y2hNb2RlLCAm
bW9kZV9saWItPnZiYS5NYXhQcmVmZXRjaE1vZGUpOworCW1vZGVfbGliLT52YmEuVXJnZW50TGF0
ZW5jeSA9IGRtbF9tYXgzKG1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeVBpeGVsRGF0YU9ubHks
IG1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeVBpeGVsTWl4ZWRXaXRoVk1EYXRhLCBtb2RlX2xp
Yi0+dmJhLlVyZ2VudExhdGVuY3lWTURhdGFPbmx5KTsKKworCWRvIHsKKwkJZG91YmxlIE1heFRv
dGFsUkRCYW5kd2lkdGggPSAwOworCQlkb3VibGUgTWF4VG90YWxSREJhbmR3aWR0aE5vVXJnZW50
QnVyc3QgPSAwOworCQlib29sIERlc3RpbmF0aW9uTGluZVRpbWVzRm9yUHJlZmV0Y2hMZXNzVGhh
bjIgPSBmYWxzZTsKKwkJYm9vbCBWUmF0aW9QcmVmZXRjaE1vcmVUaGFuNCA9IGZhbHNlOworCQlk
b3VibGUgVFdhaXQgPSBDYWxjdWxhdGVUV2FpdCgKKwkJCQltb2RlX2xpYi0+dmJhLlByZWZldGNo
TW9kZVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1bbW9kZV9saWItPnZiYS5tYXhNcGNDb21i
XSwKKwkJCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZUxhdGVuY3ksCisJCQkJbW9kZV9s
aWItPnZiYS5VcmdlbnRMYXRlbmN5LAorCQkJCW1vZGVfbGliLT52YmEuU1JFbnRlclBsdXNFeGl0
VGltZSk7CisKKwkJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXM7ICsraykgeworCQkJUGlwZSAgIG15UGlwZTsKKwkJCUhvc3RWTSBteUhvc3RWTTsKKwor
CQkJaWYgKG1vZGVfbGliLT52YmEuWEZDRW5hYmxlZFtrXSA9PSB0cnVlKSB7CisJCQkJbW9kZV9s
aWItPnZiYS5YRkNSZW1vdGVTdXJmYWNlRmxpcERlbGF5ID0KKwkJCQkJCUNhbGN1bGF0ZVJlbW90
ZVN1cmZhY2VGbGlwRGVsYXkoCisJCQkJCQkJCW1vZGVfbGliLAorCQkJCQkJCQltb2RlX2xpYi0+
dmJhLlZSYXRpb1trXSwKKwkJCQkJCQkJbG9jYWxzLT5Td2F0aFdpZHRoWVtrXSwKKwkJCQkJCQkJ
ZG1sX2NlaWwoCisJCQkJCQkJCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxERVRZW2tdLAorCQkJCQkJ
CQkJCTEpLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkJCS8gbW9k
ZV9saWItPnZiYS5QaXhlbENsb2NrW2tdLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1RTbHZW
dXBkYXRlT2Zmc2V0LAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1RTbHZWdXBkYXRlV2lkdGgs
CisJCQkJCQkJCW1vZGVfbGliLT52YmEuWEZDVFNsdlZyZWFkeU9mZnNldCwKKwkJCQkJCQkJbW9k
ZV9saWItPnZiYS5YRkNYQlVGTGF0ZW5jeVRvbGVyYW5jZSwKKwkJCQkJCQkJbW9kZV9saWItPnZi
YS5YRkNGaWxsQldPdmVyaGVhZCwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5YRkNTbHZDaHVua1Np
emUsCisJCQkJCQkJCW1vZGVfbGliLT52YmEuWEZDQnVzVHJhbnNwb3J0VGltZSwKKwkJCQkJCQkJ
bW9kZV9saWItPnZiYS5UQ2FsYywKKwkJCQkJCQkJVFdhaXQsCisJCQkJCQkJCSZtb2RlX2xpYi0+
dmJhLlNyY0FjdGl2ZURyYWluUmF0ZSwKKwkJCQkJCQkJJm1vZGVfbGliLT52YmEuVEluaXRYRmls
bCwKKwkJCQkJCQkJJm1vZGVfbGliLT52YmEuVHNsdkNoayk7CisJCQl9IGVsc2UgeworCQkJCW1v
ZGVfbGliLT52YmEuWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSA9IDA7CisJCQl9CisKKwkJCW15
UGlwZS5EUFBDTEsgPSBsb2NhbHMtPkRQUENMS1trXTsKKwkJCW15UGlwZS5ESVNQQ0xLID0gbW9k
ZV9saWItPnZiYS5ESVNQQ0xLOworCQkJbXlQaXBlLlBpeGVsQ2xvY2sgPSBtb2RlX2xpYi0+dmJh
LlBpeGVsQ2xvY2tba107CisJCQlteVBpcGUuRENGQ0xLRGVlcFNsZWVwID0gbW9kZV9saWItPnZi
YS5EQ0ZDTEtEZWVwU2xlZXA7CisJCQlteVBpcGUuRFBQUGVyUGxhbmUgPSBtb2RlX2xpYi0+dmJh
LkRQUFBlclBsYW5lW2tdOworCQkJbXlQaXBlLlNjYWxlckVuYWJsZWQgPSBtb2RlX2xpYi0+dmJh
LlNjYWxlckVuYWJsZWRba107CisJCQlteVBpcGUuU291cmNlU2NhbiA9IG1vZGVfbGliLT52YmEu
U291cmNlU2NhbltrXTsKKwkJCW15UGlwZS5CbG9ja1dpZHRoMjU2Qnl0ZXNZID0gbG9jYWxzLT5C
bG9ja1dpZHRoMjU2Qnl0ZXNZW2tdOworCQkJbXlQaXBlLkJsb2NrSGVpZ2h0MjU2Qnl0ZXNZID0g
bG9jYWxzLT5CbG9ja0hlaWdodDI1NkJ5dGVzWVtrXTsKKwkJCW15UGlwZS5CbG9ja1dpZHRoMjU2
Qnl0ZXNDID0gbG9jYWxzLT5CbG9ja1dpZHRoMjU2Qnl0ZXNDW2tdOworCQkJbXlQaXBlLkJsb2Nr
SGVpZ2h0MjU2Qnl0ZXNDID0gbG9jYWxzLT5CbG9ja0hlaWdodDI1NkJ5dGVzQ1trXTsKKwkJCW15
UGlwZS5JbnRlcmxhY2VFbmFibGUgPSBtb2RlX2xpYi0+dmJhLkludGVybGFjZVtrXTsKKwkJCW15
UGlwZS5OdW1iZXJPZkN1cnNvcnMgPSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQ3Vyc29yc1trXTsK
KwkJCW15UGlwZS5WQmxhbmsgPSBtb2RlX2xpYi0+dmJhLlZUb3RhbFtrXSAtIG1vZGVfbGliLT52
YmEuVkFjdGl2ZVtrXTsKKwkJCW15UGlwZS5IVG90YWwgPSBtb2RlX2xpYi0+dmJhLkhUb3RhbFtr
XTsKKworCisJCQlteUhvc3RWTS5FbmFibGUgPSBtb2RlX2xpYi0+dmJhLkhvc3RWTUVuYWJsZTsK
KwkJCW15SG9zdFZNLk1heFBhZ2VUYWJsZUxldmVscyA9IG1vZGVfbGliLT52YmEuSG9zdFZNTWF4
UGFnZVRhYmxlTGV2ZWxzOworCQkJbXlIb3N0Vk0uQ2FjaGVkUGFnZVRhYmxlTGV2ZWxzID0gbW9k
ZV9saWItPnZiYS5Ib3N0Vk1DYWNoZWRQYWdlVGFibGVMZXZlbHM7CisKKwkJCW1vZGVfbGliLT52
YmEuRXJyb3JSZXN1bHRba10gPQorCQkJCQlDYWxjdWxhdGVQcmVmZXRjaFNjaGVkdWxlKAorCQkJ
CQkJCW1vZGVfbGliLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUGVyY2VudE9mSWRlYWxEUkFNRmFi
cmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRlclVyZ0xhdGVuY3lQaXhlbE1peGVkV2l0aFZNRGF0
YSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlBlcmNlbnRPZklkZWFsRFJBTUZhYnJpY0FuZFNEUFBv
cnRCV1JlY2VpdmVkQWZ0ZXJVcmdMYXRlbmN5Vk1EYXRhT25seSwKKwkJCQkJCQkmbXlQaXBlLAor
CQkJCQkJCWxvY2Fscy0+RFNDRGVsYXlba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5EUFBDTEtE
ZWxheVN1YnRvdGFsLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRFBQQ0xLRGVsYXlTQ0wsCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5EUFBDTEtEZWxheVNDTExCT25seSwKKwkJCQkJCQltb2RlX2xpYi0+
dmJhLkRQUENMS0RlbGF5Q05WQ0Zvcm1hdGVyLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRFBQQ0xL
RGVsYXlDTlZDQ3Vyc29yLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRElTUENMS0RlbGF5U3VidG90
YWwsCisJCQkJCQkJKHVuc2lnbmVkIGludCkgKGxvY2Fscy0+U3dhdGhXaWR0aFlba10KKwkJCQkJ
CQkJCS8gbW9kZV9saWItPnZiYS5IUmF0aW9ba10pLAorCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0
cHV0Rm9ybWF0W2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuTWF4SW50ZXJEQ05UaWxlUmVwZWF0
ZXJzLAorCQkJCQkJCWRtbF9taW4obW9kZV9saWItPnZiYS5WU3RhcnR1cExpbmVzLCBsb2NhbHMt
Pk1heFZTdGFydHVwTGluZXNba10pLAorCQkJCQkJCWxvY2Fscy0+TWF4VlN0YXJ0dXBMaW5lc1tr
XSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkdQVVZNTWF4UGFnZVRhYmxlTGV2ZWxzLAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuR1BVVk1FbmFibGUsCisJCQkJCQkJJm15SG9zdFZNLAorCQkJCQkJCW1v
ZGVfbGliLT52YmEuRHluYW1pY01ldGFkYXRhRW5hYmxlW2tdLAorCQkJCQkJCW1vZGVfbGliLT52
YmEuRHluYW1pY01ldGFkYXRhTGluZXNCZWZvcmVBY3RpdmVSZXF1aXJlZFtrXSwKKwkJCQkJCQlt
b2RlX2xpYi0+dmJhLkR5bmFtaWNNZXRhZGF0YVRyYW5zbWl0dGVkQnl0ZXNba10sCisJCQkJCQkJ
bW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRM
YXRlbmN5LAorCQkJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50RXh0cmFMYXRlbmN5LAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuVENhbGMsCisJCQkJCQkJbG9jYWxzLT5QREVBbmRNZXRhUFRFQnl0ZXNG
cmFtZVtrXSwKKwkJCQkJCQlsb2NhbHMtPk1ldGFSb3dCeXRlW2tdLAorCQkJCQkJCWxvY2Fscy0+
UGl4ZWxQVEVCeXRlc1BlclJvd1trXSwKKwkJCQkJCQlsb2NhbHMtPlByZWZldGNoU291cmNlTGlu
ZXNZW2tdLAorCQkJCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFlba10sCisJCQkJCQkJbG9jYWxzLT5C
eXRlUGVyUGl4ZWxERVRZW2tdLAorCQkJCQkJCWxvY2Fscy0+VkluaXRQcmVGaWxsWVtrXSwKKwkJ
CQkJCQlsb2NhbHMtPk1heE51bVN3YXRoWVtrXSwKKwkJCQkJCQlsb2NhbHMtPlByZWZldGNoU291
cmNlTGluZXNDW2tdLAorCQkJCQkJCWxvY2Fscy0+Qnl0ZVBlclBpeGVsREVUQ1trXSwKKwkJCQkJ
CQlsb2NhbHMtPlZJbml0UHJlRmlsbENba10sCisJCQkJCQkJbG9jYWxzLT5NYXhOdW1Td2F0aENb
a10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5Td2F0aEhlaWdodFlba10sCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5Td2F0aEhlaWdodENba10sCisJCQkJCQkJVFdhaXQsCisJCQkJCQkJbW9kZV9saWIt
PnZiYS5YRkNFbmFibGVkW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuWEZDUmVtb3RlU3VyZmFj
ZUZsaXBEZWxheSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlByb2dyZXNzaXZlVG9JbnRlcmxhY2VV
bml0SW5PUFAsCisJCQkJCQkJJmxvY2Fscy0+RFNUWEFmdGVyU2NhbGVyW2tdLAorCQkJCQkJCSZs
b2NhbHMtPkRTVFlBZnRlclNjYWxlcltrXSwKKwkJCQkJCQkmbG9jYWxzLT5EZXN0aW5hdGlvbkxp
bmVzRm9yUHJlZmV0Y2hba10sCisJCQkJCQkJJmxvY2Fscy0+UHJlZmV0Y2hCYW5kd2lkdGhba10s
CisJCQkJCQkJJmxvY2Fscy0+RGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxhbmtba10s
CisJCQkJCQkJJmxvY2Fscy0+RGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rW2td
LAorCQkJCQkJCSZsb2NhbHMtPlZSYXRpb1ByZWZldGNoWVtrXSwKKwkJCQkJCQkmbG9jYWxzLT5W
UmF0aW9QcmVmZXRjaENba10sCisJCQkJCQkJJmxvY2Fscy0+UmVxdWlyZWRQcmVmZXRjaFBpeERh
dGFCV0x1bWFba10sCisJCQkJCQkJJmxvY2Fscy0+UmVxdWlyZWRQcmVmZXRjaFBpeERhdGFCV0No
cm9tYVtrXSwKKwkJCQkJCQkmbG9jYWxzLT5WU3RhcnR1cFJlcXVpcmVkV2hlbk5vdEVub3VnaFRp
bWVGb3JEeW5hbWljTWV0YWRhdGEsCisJCQkJCQkJJmxvY2Fscy0+VG5vX2J3W2tdLAorCQkJCQkJ
CSZsb2NhbHMtPnByZWZldGNoX3Ztcm93X2J3W2tdLAorCQkJCQkJCSZsb2NhbHMtPnN3YXRoX3dp
ZHRoX2x1bWFfdWJba10sCisJCQkJCQkJJmxvY2Fscy0+c3dhdGhfd2lkdGhfY2hyb21hX3ViW2td
LAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlZVcGRhdGVPZmZzZXRQaXhba10sCisJCQkJCQkJJm1v
ZGVfbGliLT52YmEuVlVwZGF0ZVdpZHRoUGl4W2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlZS
ZWFkeU9mZnNldFBpeFtrXSk7CisJCQlpZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWlu
Z1trXSA9PSBrKSB7CisJCQkJbG9jYWxzLT5WU3RhcnR1cFtrXSA9IGRtbF9taW4oCisJCQkJCQlt
b2RlX2xpYi0+dmJhLlZTdGFydHVwTGluZXMsCisJCQkJCQlsb2NhbHMtPk1heFZTdGFydHVwTGlu
ZXNba10pOworCQkJCWlmIChsb2NhbHMtPlZTdGFydHVwUmVxdWlyZWRXaGVuTm90RW5vdWdoVGlt
ZUZvckR5bmFtaWNNZXRhZGF0YQorCQkJCQkJIT0gMCkgeworCQkJCQlsb2NhbHMtPlZTdGFydHVw
W2tdID0KKwkJCQkJCQlsb2NhbHMtPlZTdGFydHVwUmVxdWlyZWRXaGVuTm90RW5vdWdoVGltZUZv
ckR5bmFtaWNNZXRhZGF0YTsKKwkJCQl9CisJCQl9IGVsc2UgeworCQkJCWxvY2Fscy0+VlN0YXJ0
dXBba10gPQorCQkJCQkJZG1sX21pbigKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5WU3RhcnR1cExp
bmVzLAorCQkJCQkJCQlsb2NhbHMtPk1heFZTdGFydHVwTGluZXNbbW9kZV9saWItPnZiYS5CbGVu
ZGluZ0FuZFRpbWluZ1trXV0pOworCQkJfQorCQl9CisKKwkJZm9yIChrID0gMDsgayA8IG1vZGVf
bGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQkJdW5zaWduZWQgaW50IG07
CisKKwkJCWxvY2Fscy0+Y3Vyc29yX2J3W2tdID0gMDsKKwkJCWxvY2Fscy0+Y3Vyc29yX2J3X3By
ZVtrXSA9IDA7CisJCQlmb3IgKG0gPSAwOyBtIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkN1cnNv
cnNba107IG0rKykgeworCQkJCWxvY2Fscy0+Y3Vyc29yX2J3W2tdICs9IG1vZGVfbGliLT52YmEu
Q3Vyc29yV2lkdGhba11bbV0gKiBtb2RlX2xpYi0+dmJhLkN1cnNvckJQUFtrXVttXSAvIDguMCAv
IChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkg
KiBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXTsKKwkJCQlsb2NhbHMtPmN1cnNvcl9id19wcmVba10g
Kz0gbW9kZV9saWItPnZiYS5DdXJzb3JXaWR0aFtrXVttXSAqIG1vZGVfbGliLT52YmEuQ3Vyc29y
QlBQW2tdW21dIC8gOC4wIC8gKG1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9kZV9saWItPnZi
YS5QaXhlbENsb2NrW2tdKSAqIGxvY2Fscy0+VlJhdGlvUHJlZmV0Y2hZW2tdOworCQkJfQorCisJ
CQlDYWxjdWxhdGVVcmdlbnRCdXJzdEZhY3RvcigKKwkJCQkJbW9kZV9saWItPnZiYS5ERVRCdWZm
ZXJTaXplSW5LQnl0ZSwKKwkJCQkJbW9kZV9saWItPnZiYS5Td2F0aEhlaWdodFlba10sCisJCQkJ
CW1vZGVfbGliLT52YmEuU3dhdGhIZWlnaHRDW2tdLAorCQkJCQlsb2NhbHMtPlN3YXRoV2lkdGhZ
W2tdLAorCQkJCQltb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvCisJCQkJCW1vZGVfbGliLT52YmEu
UGl4ZWxDbG9ja1trXSwKKwkJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5LAorCQkJCQlt
b2RlX2xpYi0+dmJhLkN1cnNvckJ1ZmZlclNpemUsCisJCQkJCW1vZGVfbGliLT52YmEuQ3Vyc29y
V2lkdGhba11bMF0gKyBtb2RlX2xpYi0+dmJhLkN1cnNvcldpZHRoW2tdWzFdLAorCQkJCQlkbWxf
bWF4KG1vZGVfbGliLT52YmEuQ3Vyc29yQlBQW2tdWzBdLCBtb2RlX2xpYi0+dmJhLkN1cnNvckJQ
UFtrXVsxXSksCisJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCQlsb2NhbHMtPlZS
YXRpb1ByZWZldGNoWVtrXSwKKwkJCQkJbG9jYWxzLT5WUmF0aW9QcmVmZXRjaENba10sCisJCQkJ
CWxvY2Fscy0+Qnl0ZVBlclBpeGVsREVUWVtrXSwKKwkJCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxE
RVRDW2tdLAorCQkJCQkmbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckN1cnNvcltrXSwKKwkJCQkJ
JmxvY2Fscy0+VXJnZW50QnVyc3RGYWN0b3JDdXJzb3JQcmVba10sCisJCQkJCSZsb2NhbHMtPlVy
Z2VudEJ1cnN0RmFjdG9yTHVtYVtrXSwKKwkJCQkJJmxvY2Fscy0+VXJnZW50QnVyc3RGYWN0b3JM
dW1hUHJlW2tdLAorCQkJCQkmbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckNocm9tYVtrXSwKKwkJ
CQkJJmxvY2Fscy0+VXJnZW50QnVyc3RGYWN0b3JDaHJvbWFQcmVba10sCisJCQkJCSZsb2NhbHMt
Pk5vdEVub3VnaFVyZ2VudExhdGVuY3lIaWRpbmcsCisJCQkJCSZsb2NhbHMtPk5vdEVub3VnaFVy
Z2VudExhdGVuY3lIaWRpbmdQcmUpOworCisJCQlpZiAobW9kZV9saWItPnZiYS5Vc2VVcmdlbnRC
dXJzdEJhbmR3aWR0aCA9PSBmYWxzZSkgeworCQkJCWxvY2Fscy0+VXJnZW50QnVyc3RGYWN0b3JM
dW1hW2tdID0gMTsKKwkJCQlsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9yQ2hyb21hW2tdID0gMTsK
KwkJCQlsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9yQ3Vyc29yW2tdID0gMTsKKwkJCQlsb2NhbHMt
PlVyZ2VudEJ1cnN0RmFjdG9yTHVtYVByZVtrXSA9IDE7CisJCQkJbG9jYWxzLT5VcmdlbnRCdXJz
dEZhY3RvckNocm9tYVByZVtrXSA9IDE7CisJCQkJbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckN1
cnNvclByZVtrXSA9IDE7CisJCQl9CisKKwkJCU1heFRvdGFsUkRCYW5kd2lkdGggPSBNYXhUb3Rh
bFJEQmFuZHdpZHRoICsKKwkJCQlkbWxfbWF4Myhsb2NhbHMtPnByZWZldGNoX3Ztcm93X2J3W2td
LAorCQkJCQlsb2NhbHMtPlJlYWRCYW5kd2lkdGhQbGFuZUx1bWFba10gKiBsb2NhbHMtPlVyZ2Vu
dEJ1cnN0RmFjdG9yTHVtYVtrXQorCQkJCQkrIGxvY2Fscy0+UmVhZEJhbmR3aWR0aFBsYW5lQ2hy
b21hW2tdICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckNocm9tYVtrXSArIGxvY2Fscy0+Y3Vy
c29yX2J3W2tdCisJCQkJCSogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckN1cnNvcltrXSArIGxv
Y2Fscy0+bWV0YV9yb3dfYndba10gKyBsb2NhbHMtPmRwdGVfcm93X2J3W2tdLAorCQkJCQlsb2Nh
bHMtPlJlcXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldMdW1hW2tdICogbG9jYWxzLT5VcmdlbnRCdXJz
dEZhY3Rvckx1bWFQcmVba10gKyBsb2NhbHMtPlJlcXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldDaHJv
bWFba10KKwkJCQkJKiBsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9yQ2hyb21hUHJlW2tdICsgbG9j
YWxzLT5jdXJzb3JfYndfcHJlW2tdICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckN1cnNvclBy
ZVtrXSk7CisKKwkJCU1heFRvdGFsUkRCYW5kd2lkdGhOb1VyZ2VudEJ1cnN0ID0gTWF4VG90YWxS
REJhbmR3aWR0aE5vVXJnZW50QnVyc3QgKworCQkJCWRtbF9tYXgzKGxvY2Fscy0+cHJlZmV0Y2hf
dm1yb3dfYndba10sCisJCQkJCWxvY2Fscy0+UmVhZEJhbmR3aWR0aFBsYW5lTHVtYVtrXSArIGxv
Y2Fscy0+UmVhZEJhbmR3aWR0aFBsYW5lQ2hyb21hW2tdICsgbG9jYWxzLT5jdXJzb3JfYndba10K
KwkJCQkJKyBsb2NhbHMtPm1ldGFfcm93X2J3W2tdICsgbG9jYWxzLT5kcHRlX3Jvd19id1trXSwK
KwkJCQkJbG9jYWxzLT5SZXF1aXJlZFByZWZldGNoUGl4RGF0YUJXTHVtYVtrXSArIGxvY2Fscy0+
UmVxdWlyZWRQcmVmZXRjaFBpeERhdGFCV0Nocm9tYVtrXSArIGxvY2Fscy0+Y3Vyc29yX2J3X3By
ZVtrXSk7CisKKwkJCWlmIChsb2NhbHMtPkRlc3RpbmF0aW9uTGluZXNGb3JQcmVmZXRjaFtrXSA8
IDIpCisJCQkJRGVzdGluYXRpb25MaW5lVGltZXNGb3JQcmVmZXRjaExlc3NUaGFuMiA9IHRydWU7
CisJCQlpZiAobG9jYWxzLT5WUmF0aW9QcmVmZXRjaFlba10gPiA0IHx8IGxvY2Fscy0+VlJhdGlv
UHJlZmV0Y2hDW2tdID4gNCkKKwkJCQlWUmF0aW9QcmVmZXRjaE1vcmVUaGFuNCA9IHRydWU7CisJ
CX0KKwkJbW9kZV9saWItPnZiYS5GcmFjdGlvbk9mVXJnZW50QmFuZHdpZHRoID0gTWF4VG90YWxS
REJhbmR3aWR0aE5vVXJnZW50QnVyc3QgLyBtb2RlX2xpYi0+dmJhLlJldHVybkJXOworCisJCWlm
IChNYXhUb3RhbFJEQmFuZHdpZHRoIDw9IG1vZGVfbGliLT52YmEuUmV0dXJuQlcgJiYgbG9jYWxz
LT5Ob3RFbm91Z2hVcmdlbnRMYXRlbmN5SGlkaW5nID09IDAgJiYgbG9jYWxzLT5Ob3RFbm91Z2hV
cmdlbnRMYXRlbmN5SGlkaW5nUHJlID09IDAgJiYgIVZSYXRpb1ByZWZldGNoTW9yZVRoYW40CisJ
CQkJJiYgIURlc3RpbmF0aW9uTGluZVRpbWVzRm9yUHJlZmV0Y2hMZXNzVGhhbjIpCisJCQltb2Rl
X2xpYi0+dmJhLlByZWZldGNoTW9kZVN1cHBvcnRlZCA9IHRydWU7CisJCWVsc2UgeworCQkJbW9k
ZV9saWItPnZiYS5QcmVmZXRjaE1vZGVTdXBwb3J0ZWQgPSBmYWxzZTsKKwkJCWRtbF9wcmludCgK
KwkJCQkJIkRNTDogQ2FsY3VsYXRlUHJlZmV0Y2hTY2hlZHVsZSAqKipmYWlsZWQqKiouIEJhbmR3
aWR0aCB2aW9sYXRpb24uIFJlc3VsdHMgYXJlIE5PVCB2YWxpZFxuIik7CisJCX0KKworCQlpZiAo
bW9kZV9saWItPnZiYS5QcmVmZXRjaE1vZGVTdXBwb3J0ZWQgPT0gdHJ1ZSkgeworCQkJbW9kZV9s
aWItPnZiYS5CYW5kd2lkdGhBdmFpbGFibGVGb3JJbW1lZGlhdGVGbGlwID0gbW9kZV9saWItPnZi
YS5SZXR1cm5CVzsKKwkJCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0
aXZlUGxhbmVzOyArK2spIHsKKwkJCQltb2RlX2xpYi0+dmJhLkJhbmR3aWR0aEF2YWlsYWJsZUZv
ckltbWVkaWF0ZUZsaXAgPQorCQkJCQkJbW9kZV9saWItPnZiYS5CYW5kd2lkdGhBdmFpbGFibGVG
b3JJbW1lZGlhdGVGbGlwCisJCQkJCQkJLSBkbWxfbWF4KAorCQkJCQkJCQlsb2NhbHMtPlJlYWRC
YW5kd2lkdGhQbGFuZUx1bWFba10gKiBsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9yTHVtYVtrXQor
CQkJCQkJCQkrIGxvY2Fscy0+UmVhZEJhbmR3aWR0aFBsYW5lQ2hyb21hW2tdICogbG9jYWxzLT5V
cmdlbnRCdXJzdEZhY3RvckNocm9tYVtrXQorCQkJCQkJCQkrIGxvY2Fscy0+Y3Vyc29yX2J3W2td
ICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckN1cnNvcltrXSwKKwkJCQkJCQkJbG9jYWxzLT5S
ZXF1aXJlZFByZWZldGNoUGl4RGF0YUJXTHVtYVtrXSAqIGxvY2Fscy0+VXJnZW50QnVyc3RGYWN0
b3JMdW1hUHJlW2tdICsKKwkJCQkJCQkJbG9jYWxzLT5SZXF1aXJlZFByZWZldGNoUGl4RGF0YUJX
Q2hyb21hW2tdICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckNocm9tYVByZVtrXSArCisJCQkJ
CQkJCWxvY2Fscy0+Y3Vyc29yX2J3X3ByZVtrXSAqIGxvY2Fscy0+VXJnZW50QnVyc3RGYWN0b3JD
dXJzb3JQcmVba10pOworCQkJfQorCisJCQltb2RlX2xpYi0+dmJhLlRvdEltbWVkaWF0ZUZsaXBC
eXRlcyA9IDA7CisJCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2
ZVBsYW5lczsgKytrKSB7CisJCQkJbW9kZV9saWItPnZiYS5Ub3RJbW1lZGlhdGVGbGlwQnl0ZXMg
PSBtb2RlX2xpYi0+dmJhLlRvdEltbWVkaWF0ZUZsaXBCeXRlcyArIGxvY2Fscy0+UERFQW5kTWV0
YVBURUJ5dGVzRnJhbWVba10gKyBsb2NhbHMtPk1ldGFSb3dCeXRlW2tdICsgbG9jYWxzLT5QaXhl
bFBURUJ5dGVzUGVyUm93W2tdOworCQkJfQorCQkJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52
YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQkJCUNhbGN1bGF0ZUZsaXBTY2hlZHVs
ZSgKKwkJCQkJCW1vZGVfbGliLAorCQkJCQkJbW9kZV9saWItPnZiYS5QZXJjZW50T2ZJZGVhbERS
QU1GYWJyaWNBbmRTRFBQb3J0QldSZWNlaXZlZEFmdGVyVXJnTGF0ZW5jeVBpeGVsTWl4ZWRXaXRo
Vk1EYXRhLAorCQkJCQkJbW9kZV9saWItPnZiYS5QZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNBbmRT
RFBQb3J0QldSZWNlaXZlZEFmdGVyVXJnTGF0ZW5jeVZNRGF0YU9ubHksCisJCQkJCQltb2RlX2xp
Yi0+dmJhLlVyZ2VudEV4dHJhTGF0ZW5jeSwKKwkJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50TGF0
ZW5jeSwKKwkJCQkJCW1vZGVfbGliLT52YmEuR1BVVk1NYXhQYWdlVGFibGVMZXZlbHMsCisJCQkJ
CQltb2RlX2xpYi0+dmJhLkhvc3RWTUVuYWJsZSwKKwkJCQkJCW1vZGVfbGliLT52YmEuSG9zdFZN
TWF4UGFnZVRhYmxlTGV2ZWxzLAorCQkJCQkJbW9kZV9saWItPnZiYS5Ib3N0Vk1DYWNoZWRQYWdl
VGFibGVMZXZlbHMsCisJCQkJCQltb2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlLAorCQkJCQkJbG9j
YWxzLT5QREVBbmRNZXRhUFRFQnl0ZXNGcmFtZVtrXSwKKwkJCQkJCWxvY2Fscy0+TWV0YVJvd0J5
dGVba10sCisJCQkJCQlsb2NhbHMtPlBpeGVsUFRFQnl0ZXNQZXJSb3dba10sCisJCQkJCQltb2Rl
X2xpYi0+dmJhLkJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAsCisJCQkJCQltb2Rl
X2xpYi0+dmJhLlRvdEltbWVkaWF0ZUZsaXBCeXRlcywKKwkJCQkJCW1vZGVfbGliLT52YmEuU291
cmNlUGl4ZWxGb3JtYXRba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvIG1vZGVf
bGliLT52YmEuUGl4ZWxDbG9ja1trXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAor
CQkJCQkJbG9jYWxzLT5Ubm9fYndba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLkRDQ0VuYWJsZVtr
XSwKKwkJCQkJCWxvY2Fscy0+ZHB0ZV9yb3dfaGVpZ2h0W2tdLAorCQkJCQkJbG9jYWxzLT5tZXRh
X3Jvd19oZWlnaHRba10sCisJCQkJCQlsb2NhbHMtPmRwdGVfcm93X2hlaWdodF9jaHJvbWFba10s
CisJCQkJCQlsb2NhbHMtPm1ldGFfcm93X2hlaWdodF9jaHJvbWFba10sCisJCQkJCQkmbG9jYWxz
LT5EZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JbkltbWVkaWF0ZUZsaXBba10sCisJCQkJCQkm
bG9jYWxzLT5EZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5JbW1lZGlhdGVGbGlwW2tdLAor
CQkJCQkJJmxvY2Fscy0+ZmluYWxfZmxpcF9id1trXSwKKwkJCQkJCSZsb2NhbHMtPkltbWVkaWF0
ZUZsaXBTdXBwb3J0ZWRGb3JQaXBlW2tdKTsKKwkJCX0KKwkJCW1vZGVfbGliLT52YmEudG90YWxf
ZGNuX3JlYWRfYndfd2l0aF9mbGlwID0gMC4wOworCQkJbW9kZV9saWItPnZiYS50b3RhbF9kY25f
cmVhZF9id193aXRoX2ZsaXBfbm9fdXJnZW50X2J1cnN0ID0gMC4wOworCQkJZm9yIChrID0gMDsg
ayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQkJCW1vZGVf
bGliLT52YmEudG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwID0KKwkJCQkJCW1vZGVfbGliLT52
YmEudG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwICsgZG1sX21heDMoCisJCQkJCQkJbG9jYWxz
LT5wcmVmZXRjaF92bXJvd19id1trXSwKKwkJCQkJCQlsb2NhbHMtPmZpbmFsX2ZsaXBfYndba10g
KyBsb2NhbHMtPlJlYWRCYW5kd2lkdGhMdW1hW2tdICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3Rv
ckx1bWFba10KKwkJCQkJCQkrIGxvY2Fscy0+UmVhZEJhbmR3aWR0aENocm9tYVtrXSAqIGxvY2Fs
cy0+VXJnZW50QnVyc3RGYWN0b3JDaHJvbWFba10gKyBsb2NhbHMtPmN1cnNvcl9id1trXSAqIGxv
Y2Fscy0+VXJnZW50QnVyc3RGYWN0b3JDdXJzb3Jba10sCisJCQkJCQkJbG9jYWxzLT5maW5hbF9m
bGlwX2J3W2tdICsgbG9jYWxzLT5SZXF1aXJlZFByZWZldGNoUGl4RGF0YUJXTHVtYVtrXSAqIGxv
Y2Fscy0+VXJnZW50QnVyc3RGYWN0b3JMdW1hUHJlW2tdCisJCQkJCQkJKyBsb2NhbHMtPlJlcXVp
cmVkUHJlZmV0Y2hQaXhEYXRhQldDaHJvbWFba10gKiBsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9y
Q2hyb21hUHJlW2tdCisJCQkJCQkJKyBsb2NhbHMtPmN1cnNvcl9id19wcmVba10gKiBsb2NhbHMt
PlVyZ2VudEJ1cnN0RmFjdG9yQ3Vyc29yUHJlW2tdKTsKKwkJCQltb2RlX2xpYi0+dmJhLnRvdGFs
X2Rjbl9yZWFkX2J3X3dpdGhfZmxpcF9ub191cmdlbnRfYnVyc3QgPQorCQkJCW1vZGVfbGliLT52
YmEudG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwX25vX3VyZ2VudF9idXJzdCArCisJCQkJCWRt
bF9tYXgzKGxvY2Fscy0+cHJlZmV0Y2hfdm1yb3dfYndba10sCisJCQkJCQlsb2NhbHMtPmZpbmFs
X2ZsaXBfYndba10gKyBsb2NhbHMtPlJlYWRCYW5kd2lkdGhQbGFuZUx1bWFba10gKyBsb2NhbHMt
PlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXSArIGxvY2Fscy0+Y3Vyc29yX2J3W2tdLAorCQkJ
CQkJbG9jYWxzLT5maW5hbF9mbGlwX2J3W2tdICsgbG9jYWxzLT5SZXF1aXJlZFByZWZldGNoUGl4
RGF0YUJXTHVtYVtrXSArIGxvY2Fscy0+UmVxdWlyZWRQcmVmZXRjaFBpeERhdGFCV0Nocm9tYVtr
XSArIGxvY2Fscy0+Y3Vyc29yX2J3X3ByZVtrXSk7CisKKwkJCX0KKwkJCW1vZGVfbGliLT52YmEu
RnJhY3Rpb25PZlVyZ2VudEJhbmR3aWR0aEltbWVkaWF0ZUZsaXAgPSBtb2RlX2xpYi0+dmJhLnRv
dGFsX2Rjbl9yZWFkX2J3X3dpdGhfZmxpcF9ub191cmdlbnRfYnVyc3QgLyBtb2RlX2xpYi0+dmJh
LlJldHVybkJXOworCisJCQltb2RlX2xpYi0+dmJhLkltbWVkaWF0ZUZsaXBTdXBwb3J0ZWQgPSB0
cnVlOworCQkJaWYgKG1vZGVfbGliLT52YmEudG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwID4g
bW9kZV9saWItPnZiYS5SZXR1cm5CVykgeworCQkJCW1vZGVfbGliLT52YmEuSW1tZWRpYXRlRmxp
cFN1cHBvcnRlZCA9IGZhbHNlOworCQkJfQorCQkJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52
YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQkJCWlmIChsb2NhbHMtPkltbWVkaWF0
ZUZsaXBTdXBwb3J0ZWRGb3JQaXBlW2tdID09IGZhbHNlKSB7CisJCQkJCW1vZGVfbGliLT52YmEu
SW1tZWRpYXRlRmxpcFN1cHBvcnRlZCA9IGZhbHNlOworCQkJCX0KKwkJCX0KKwkJfSBlbHNlIHsK
KwkJCW1vZGVfbGliLT52YmEuSW1tZWRpYXRlRmxpcFN1cHBvcnRlZCA9IGZhbHNlOworCQl9CisK
KwkJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsr
aykgeworCQkJaWYgKG1vZGVfbGliLT52YmEuRXJyb3JSZXN1bHRba10pIHsKKwkJCQltb2RlX2xp
Yi0+dmJhLlByZWZldGNoTW9kZVN1cHBvcnRlZCA9IGZhbHNlOworCQkJCWRtbF9wcmludCgKKwkJ
CQkJCSJETUw6IENhbGN1bGF0ZVByZWZldGNoU2NoZWR1bGUgKioqZmFpbGVkKioqLiBQcmVmZXRj
aCBzY2hlZHVsZSB2aW9sYXRpb24uIFJlc3VsdHMgYXJlIE5PVCB2YWxpZFxuIik7CisJCQl9CisJ
CX0KKworCQltb2RlX2xpYi0+dmJhLlZTdGFydHVwTGluZXMgPSBtb2RlX2xpYi0+dmJhLlZTdGFy
dHVwTGluZXMgKyAxOworCX0gd2hpbGUgKCEoKG1vZGVfbGliLT52YmEuUHJlZmV0Y2hNb2RlU3Vw
cG9ydGVkCisJCQkmJiAoKCFtb2RlX2xpYi0+dmJhLkltbWVkaWF0ZUZsaXBTdXBwb3J0ICYmICFt
b2RlX2xpYi0+dmJhLkhvc3RWTUVuYWJsZSkKKwkJCQkJfHwgbW9kZV9saWItPnZiYS5JbW1lZGlh
dGVGbGlwU3VwcG9ydGVkKSkKKwkJCXx8IGxvY2Fscy0+TWF4aW11bU1heFZTdGFydHVwTGluZXMg
PCBtb2RlX2xpYi0+dmJhLlZTdGFydHVwTGluZXMpKTsKKworCS8vV2F0ZXJtYXJrcyBhbmQgTkIg
UC1TdGF0ZS9EUkFNIENsb2NrIENoYW5nZSBTdXBwb3J0CisJeworCQllbnVtIGNsb2NrX2NoYW5n
ZV9zdXBwb3J0IERSQU1DbG9ja0NoYW5nZVN1cHBvcnQ7IC8vIGR1bW15CisJCUNhbGN1bGF0ZVdh
dGVybWFya3NBbmREUkFNU3BlZWRDaGFuZ2VTdXBwb3J0KAorCQkJCW1vZGVfbGliLAorCQkJCW1v
ZGVfbGliLT52YmEuUHJlZmV0Y2hNb2RlW21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXVttb2Rl
X2xpYi0+dmJhLm1heE1wY0NvbWJdLAorCQkJCW1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXMsCisJCQkJbW9kZV9saWItPnZiYS5NYXhMaW5lQnVmZmVyTGluZXMsCisJCQkJbW9kZV9s
aWItPnZiYS5MaW5lQnVmZmVyU2l6ZSwKKwkJCQltb2RlX2xpYi0+dmJhLkRQUE91dHB1dEJ1ZmZl
clBpeGVscywKKwkJCQltb2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVJbktCeXRlLAorCQkJCW1v
ZGVfbGliLT52YmEuV3JpdGViYWNrSW50ZXJmYWNlTHVtYUJ1ZmZlclNpemUsCisJCQkJbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tJbnRlcmZhY2VDaHJvbWFCdWZmZXJTaXplLAorCQkJCW1vZGVfbGli
LT52YmEuRENGQ0xLLAorCQkJCW1vZGVfbGliLT52YmEuVXJnZW50T3V0T2ZPcmRlclJldHVyblBl
ckNoYW5uZWwgKiBtb2RlX2xpYi0+dmJhLk51bWJlck9mQ2hhbm5lbHMsCisJCQkJbW9kZV9saWIt
PnZiYS5SZXR1cm5CVywKKwkJCQltb2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlLAorCQkJCWxvY2Fs
cy0+ZHB0ZV9ncm91cF9ieXRlcywKKwkJCQltb2RlX2xpYi0+dmJhLk1ldGFDaHVua1NpemUsCisJ
CQkJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5LAorCQkJCW1vZGVfbGliLT52YmEuVXJnZW50
RXh0cmFMYXRlbmN5LAorCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTGF0ZW5jeSwKKwkJCQlt
b2RlX2xpYi0+dmJhLldyaXRlYmFja0NodW5rU2l6ZSwKKwkJCQltb2RlX2xpYi0+dmJhLlNPQ0NM
SywKKwkJCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZUxhdGVuY3ksCisJCQkJbW9kZV9s
aWItPnZiYS5TUkV4aXRUaW1lLAorCQkJCW1vZGVfbGliLT52YmEuU1JFbnRlclBsdXNFeGl0VGlt
ZSwKKwkJCQltb2RlX2xpYi0+dmJhLkRDRkNMS0RlZXBTbGVlcCwKKwkJCQltb2RlX2xpYi0+dmJh
LkRQUFBlclBsYW5lLAorCQkJCW1vZGVfbGliLT52YmEuRENDRW5hYmxlLAorCQkJCWxvY2Fscy0+
RFBQQ0xLLAorCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFNpbmdsZURQUFksCisJCQkJbW9kZV9saWIt
PnZiYS5Td2F0aEhlaWdodFksCisJCQkJbG9jYWxzLT5SZWFkQmFuZHdpZHRoUGxhbmVMdW1hLAor
CQkJCW1vZGVfbGliLT52YmEuU3dhdGhIZWlnaHRDLAorCQkJCWxvY2Fscy0+UmVhZEJhbmR3aWR0
aFBsYW5lQ2hyb21hLAorCQkJCW1vZGVfbGliLT52YmEuTEJCaXRQZXJQaXhlbCwKKwkJCQlsb2Nh
bHMtPlN3YXRoV2lkdGhZLAorCQkJCW1vZGVfbGliLT52YmEuSFJhdGlvLAorCQkJCW1vZGVfbGli
LT52YmEudnRhcHMsCisJCQkJbW9kZV9saWItPnZiYS5WVEFQc0Nocm9tYSwKKwkJCQltb2RlX2xp
Yi0+dmJhLlZSYXRpbywKKwkJCQltb2RlX2xpYi0+dmJhLkhUb3RhbCwKKwkJCQltb2RlX2xpYi0+
dmJhLlBpeGVsQ2xvY2ssCisJCQkJbW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZywKKwkJ
CQlsb2NhbHMtPkJ5dGVQZXJQaXhlbERFVFksCisJCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxERVRD
LAorCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRW5hYmxlLAorCQkJCW1vZGVfbGliLT52YmEu
V3JpdGViYWNrUGl4ZWxGb3JtYXQsCisJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEZXN0aW5h
dGlvbldpZHRoLAorCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25IZWlnaHQs
CisJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tTb3VyY2VIZWlnaHQsCisJCQkJJkRSQU1DbG9j
a0NoYW5nZVN1cHBvcnQsCisJCQkJJm1vZGVfbGliLT52YmEuVXJnZW50V2F0ZXJtYXJrLAorCQkJ
CSZtb2RlX2xpYi0+dmJhLldyaXRlYmFja1VyZ2VudFdhdGVybWFyaywKKwkJCQkmbW9kZV9saWIt
PnZiYS5EUkFNQ2xvY2tDaGFuZ2VXYXRlcm1hcmssCisJCQkJJm1vZGVfbGliLT52YmEuV3JpdGVi
YWNrRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrLAorCQkJCSZtb2RlX2xpYi0+dmJhLlN0dXR0ZXJF
eGl0V2F0ZXJtYXJrLAorCQkJCSZtb2RlX2xpYi0+dmJhLlN0dXR0ZXJFbnRlclBsdXNFeGl0V2F0
ZXJtYXJrLAorCQkJCSZtb2RlX2xpYi0+dmJhLk1pbkFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVu
Y3lTdXBwb3J0ZWQpOworCX0KKworCisJLy9EaXNwbGF5IFBpcGVsaW5lIERlbGl2ZXJ5IFRpbWUg
aW4gUHJlZmV0Y2gsIEdyb3VwcworCUNhbGN1bGF0ZVBpeGVsRGVsaXZlcnlUaW1lcygKKwkJbW9k
ZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcywKKwkJbW9kZV9saWItPnZiYS5WUmF0aW8s
CisJCWxvY2Fscy0+VlJhdGlvUHJlZmV0Y2hZLAorCQlsb2NhbHMtPlZSYXRpb1ByZWZldGNoQywK
KwkJbG9jYWxzLT5zd2F0aF93aWR0aF9sdW1hX3ViLAorCQlsb2NhbHMtPnN3YXRoX3dpZHRoX2No
cm9tYV91YiwKKwkJbW9kZV9saWItPnZiYS5EUFBQZXJQbGFuZSwKKwkJbW9kZV9saWItPnZiYS5I
UmF0aW8sCisJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9jaywKKwkJbG9jYWxzLT5QU0NMX1RIUk9V
R0hQVVRfTFVNQSwKKwkJbG9jYWxzLT5QU0NMX1RIUk9VR0hQVVRfQ0hST01BLAorCQlsb2NhbHMt
PkRQUENMSywKKwkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxERVRDLAorCQltb2RlX2xpYi0+dmJhLlNv
dXJjZVNjYW4sCisJCWxvY2Fscy0+QmxvY2tXaWR0aDI1NkJ5dGVzWSwKKwkJbG9jYWxzLT5CbG9j
a0hlaWdodDI1NkJ5dGVzWSwKKwkJbG9jYWxzLT5CbG9ja1dpZHRoMjU2Qnl0ZXNDLAorCQlsb2Nh
bHMtPkJsb2NrSGVpZ2h0MjU2Qnl0ZXNDLAorCQlsb2NhbHMtPkRpc3BsYXlQaXBlTGluZURlbGl2
ZXJ5VGltZUx1bWEsCisJCWxvY2Fscy0+RGlzcGxheVBpcGVMaW5lRGVsaXZlcnlUaW1lQ2hyb21h
LAorCQlsb2NhbHMtPkRpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWFQcmVmZXRjaCwKKwkJ
bG9jYWxzLT5EaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVDaHJvbWFQcmVmZXRjaCwKKwkJbG9j
YWxzLT5EaXNwbGF5UGlwZVJlcXVlc3REZWxpdmVyeVRpbWVMdW1hLAorCQlsb2NhbHMtPkRpc3Bs
YXlQaXBlUmVxdWVzdERlbGl2ZXJ5VGltZUNocm9tYSwKKwkJbG9jYWxzLT5EaXNwbGF5UGlwZVJl
cXVlc3REZWxpdmVyeVRpbWVMdW1hUHJlZmV0Y2gsCisJCWxvY2Fscy0+RGlzcGxheVBpcGVSZXF1
ZXN0RGVsaXZlcnlUaW1lQ2hyb21hUHJlZmV0Y2gpOworCisJQ2FsY3VsYXRlTWV0YUFuZFBURVRp
bWVzKAorCQltb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzLAorCQltb2RlX2xpYi0+
dmJhLkdQVVZNRW5hYmxlLAorCQltb2RlX2xpYi0+dmJhLk1ldGFDaHVua1NpemUsCisJCW1vZGVf
bGliLT52YmEuTWluTWV0YUNodW5rU2l6ZUJ5dGVzLAorCQltb2RlX2xpYi0+dmJhLkdQVVZNTWF4
UGFnZVRhYmxlTGV2ZWxzLAorCQltb2RlX2xpYi0+dmJhLkhUb3RhbCwKKwkJbW9kZV9saWItPnZi
YS5WUmF0aW8sCisJCWxvY2Fscy0+VlJhdGlvUHJlZmV0Y2hZLAorCQlsb2NhbHMtPlZSYXRpb1By
ZWZldGNoQywKKwkJbG9jYWxzLT5EZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5WQmxhbmss
CisJCWxvY2Fscy0+RGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luSW1tZWRpYXRlRmxpcCwK
KwkJbG9jYWxzLT5EZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JblZCbGFuaywKKwkJbG9jYWxz
LT5EZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JbkltbWVkaWF0ZUZsaXAsCisJCW1vZGVfbGli
LT52YmEuRENDRW5hYmxlLAorCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2ssCisJCWxvY2Fscy0+
Qnl0ZVBlclBpeGVsREVUWSwKKwkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxERVRDLAorCQltb2RlX2xp
Yi0+dmJhLlNvdXJjZVNjYW4sCisJCWxvY2Fscy0+ZHB0ZV9yb3dfaGVpZ2h0LAorCQlsb2NhbHMt
PmRwdGVfcm93X2hlaWdodF9jaHJvbWEsCisJCWxvY2Fscy0+bWV0YV9yb3dfd2lkdGgsCisJCWxv
Y2Fscy0+bWV0YV9yb3dfaGVpZ2h0LAorCQlsb2NhbHMtPm1ldGFfcmVxX3dpZHRoLAorCQlsb2Nh
bHMtPm1ldGFfcmVxX2hlaWdodCwKKwkJbG9jYWxzLT5kcHRlX2dyb3VwX2J5dGVzLAorCQlsb2Nh
bHMtPlBURVJlcXVlc3RTaXplWSwKKwkJbG9jYWxzLT5QVEVSZXF1ZXN0U2l6ZUMsCisJCWxvY2Fs
cy0+UGl4ZWxQVEVSZXFXaWR0aFksCisJCWxvY2Fscy0+UGl4ZWxQVEVSZXFIZWlnaHRZLAorCQls
b2NhbHMtPlBpeGVsUFRFUmVxV2lkdGhDLAorCQlsb2NhbHMtPlBpeGVsUFRFUmVxSGVpZ2h0QywK
KwkJbG9jYWxzLT5kcHRlX3Jvd193aWR0aF9sdW1hX3ViLAorCQlsb2NhbHMtPmRwdGVfcm93X3dp
ZHRoX2Nocm9tYV91YiwKKwkJbG9jYWxzLT52bV9ncm91cF9ieXRlcywKKwkJbG9jYWxzLT5kcGRl
MF9ieXRlc19wZXJfZnJhbWVfdWJfbCwKKwkJbG9jYWxzLT5kcGRlMF9ieXRlc19wZXJfZnJhbWVf
dWJfYywKKwkJbG9jYWxzLT5tZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWJfbCwKKwkJbG9jYWxz
LT5tZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWJfYywKKwkJbG9jYWxzLT5EU1RfWV9QRVJfUFRF
X1JPV19OT01fTCwKKwkJbG9jYWxzLT5EU1RfWV9QRVJfUFRFX1JPV19OT01fQywKKwkJbG9jYWxz
LT5EU1RfWV9QRVJfTUVUQV9ST1dfTk9NX0wsCisJCWxvY2Fscy0+VGltZVBlck1ldGFDaHVua05v
bWluYWwsCisJCWxvY2Fscy0+VGltZVBlck1ldGFDaHVua1ZCbGFuaywKKwkJbG9jYWxzLT5UaW1l
UGVyTWV0YUNodW5rRmxpcCwKKwkJbG9jYWxzLT50aW1lX3Blcl9wdGVfZ3JvdXBfbm9tX2x1bWEs
CisJCWxvY2Fscy0+dGltZV9wZXJfcHRlX2dyb3VwX3ZibGFua19sdW1hLAorCQlsb2NhbHMtPnRp
bWVfcGVyX3B0ZV9ncm91cF9mbGlwX2x1bWEsCisJCWxvY2Fscy0+dGltZV9wZXJfcHRlX2dyb3Vw
X25vbV9jaHJvbWEsCisJCWxvY2Fscy0+dGltZV9wZXJfcHRlX2dyb3VwX3ZibGFua19jaHJvbWEs
CisJCWxvY2Fscy0+dGltZV9wZXJfcHRlX2dyb3VwX2ZsaXBfY2hyb21hLAorCQlsb2NhbHMtPlRp
bWVQZXJWTUdyb3VwVkJsYW5rLAorCQlsb2NhbHMtPlRpbWVQZXJWTUdyb3VwRmxpcCwKKwkJbG9j
YWxzLT5UaW1lUGVyVk1SZXF1ZXN0VkJsYW5rLAorCQlsb2NhbHMtPlRpbWVQZXJWTVJlcXVlc3RG
bGlwKTsKKworCisJLy8gTWluIFRUVVZCbGFuaworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+
dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuUHJl
ZmV0Y2hNb2RlW21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXVttb2RlX2xpYi0+dmJhLm1heE1w
Y0NvbWJdID09IDApIHsKKwkJCWxvY2Fscy0+QWxsb3dEUkFNQ2xvY2tDaGFuZ2VEdXJpbmdWQmxh
bmtba10gPSB0cnVlOworCQkJbG9jYWxzLT5BbGxvd0RSQU1TZWxmUmVmcmVzaER1cmluZ1ZCbGFu
a1trXSA9IHRydWU7CisJCQlsb2NhbHMtPk1pblRUVVZCbGFua1trXSA9IGRtbF9tYXgoCisJCQkJ
CW1vZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrLAorCQkJCQlkbWxfbWF4KAor
CQkJCQkJCW1vZGVfbGliLT52YmEuU3R1dHRlckVudGVyUGx1c0V4aXRXYXRlcm1hcmssCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5VcmdlbnRXYXRlcm1hcmspKTsKKwkJfSBlbHNlIGlmIChtb2RlX2xp
Yi0+dmJhLlByZWZldGNoTW9kZVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1bbW9kZV9saWIt
PnZiYS5tYXhNcGNDb21iXSA9PSAxKSB7CisJCQlsb2NhbHMtPkFsbG93RFJBTUNsb2NrQ2hhbmdl
RHVyaW5nVkJsYW5rW2tdID0gZmFsc2U7CisJCQlsb2NhbHMtPkFsbG93RFJBTVNlbGZSZWZyZXNo
RHVyaW5nVkJsYW5rW2tdID0gdHJ1ZTsKKwkJCWxvY2Fscy0+TWluVFRVVkJsYW5rW2tdID0gZG1s
X21heCgKKwkJCQkJbW9kZV9saWItPnZiYS5TdHV0dGVyRW50ZXJQbHVzRXhpdFdhdGVybWFyaywK
KwkJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRXYXRlcm1hcmspOworCQl9IGVsc2UgeworCQkJbG9j
YWxzLT5BbGxvd0RSQU1DbG9ja0NoYW5nZUR1cmluZ1ZCbGFua1trXSA9IGZhbHNlOworCQkJbG9j
YWxzLT5BbGxvd0RSQU1TZWxmUmVmcmVzaER1cmluZ1ZCbGFua1trXSA9IGZhbHNlOworCQkJbG9j
YWxzLT5NaW5UVFVWQmxhbmtba10gPSBtb2RlX2xpYi0+dmJhLlVyZ2VudFdhdGVybWFyazsKKwkJ
fQorCQlpZiAoIW1vZGVfbGliLT52YmEuRHluYW1pY01ldGFkYXRhRW5hYmxlW2tdKQorCQkJbG9j
YWxzLT5NaW5UVFVWQmxhbmtba10gPSBtb2RlX2xpYi0+dmJhLlRDYWxjCisJCQkJCSsgbG9jYWxz
LT5NaW5UVFVWQmxhbmtba107CisJfQorCisJLy8gRENDIENvbmZpZ3VyYXRpb24KKwltb2RlX2xp
Yi0+dmJhLkFjdGl2ZURQUHMgPSAwOworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJbG9jYWxzLT5NYXhpbXVtRENDQ29tcHJlc3Np
b25ZU3VyZmFjZVtrXSA9IENhbGN1bGF0ZURDQ0NvbmZpZ3VyYXRpb24oCisJCQltb2RlX2xpYi0+
dmJhLkRDQ0VuYWJsZVtrXSwKKwkJCWZhbHNlLCAvLyBXZSBzaG91bGQgYWx3YXlzIGtub3cgdGhl
IGRpcmVjdGlvbiBEQ0NQcm9ncmFtbWluZ0Fzc3VtZXNTY2FuRGlyZWN0aW9uVW5rbm93biwKKwkJ
CW1vZGVfbGliLT52YmEuVmlld3BvcnRXaWR0aFtrXSwKKwkJCW1vZGVfbGliLT52YmEuVmlld3Bv
cnRIZWlnaHRba10sCisJCQltb2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVJbktCeXRlICogMTAy
NCwKKwkJCWxvY2Fscy0+QmxvY2tIZWlnaHQyNTZCeXRlc1lba10sCisJCQltb2RlX2xpYi0+dmJh
LlN3YXRoSGVpZ2h0WVtrXSwKKwkJCW1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSwKKwkJ
CWxvY2Fscy0+Qnl0ZVBlclBpeGVsREVUWVtrXSwKKwkJCW1vZGVfbGliLT52YmEuU291cmNlU2Nh
bltrXSwKKwkJCSZsb2NhbHMtPkRDQ1lNYXhVbmNvbXByZXNzZWRCbG9ja1trXSwKKwkJCSZsb2Nh
bHMtPkRDQ1lNYXhDb21wcmVzc2VkQmxvY2tba10sCisJCQkmbG9jYWxzLT5EQ0NZSW5kZXBlbmRl
bnQ2NEJ5dGVCbG9ja1trXSk7CisJfQorCisJLy9YRkMgUGFyYW1ldGVyczoKKwlmb3IgKGsgPSAw
OyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmICht
b2RlX2xpYi0+dmJhLlhGQ0VuYWJsZWRba10gPT0gdHJ1ZSkgeworCQkJZG91YmxlIFRXYWl0Owor
CisJCQlsb2NhbHMtPlhGQ1NsYXZlVlVwZGF0ZU9mZnNldFtrXSA9IG1vZGVfbGliLT52YmEuWEZD
VFNsdlZ1cGRhdGVPZmZzZXQ7CisJCQlsb2NhbHMtPlhGQ1NsYXZlVnVwZGF0ZVdpZHRoW2tdID0g
bW9kZV9saWItPnZiYS5YRkNUU2x2VnVwZGF0ZVdpZHRoOworCQkJbG9jYWxzLT5YRkNTbGF2ZVZS
ZWFkeU9mZnNldFtrXSA9IG1vZGVfbGliLT52YmEuWEZDVFNsdlZyZWFkeU9mZnNldDsKKwkJCVRX
YWl0ID0gQ2FsY3VsYXRlVFdhaXQoCisJCQkJCW1vZGVfbGliLT52YmEuUHJlZmV0Y2hNb2RlW21v
ZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXVttb2RlX2xpYi0+dmJhLm1heE1wY0NvbWJdLAorCQkJ
CQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZUxhdGVuY3ksCisJCQkJCW1vZGVfbGliLT52
YmEuVXJnZW50TGF0ZW5jeSwKKwkJCQkJbW9kZV9saWItPnZiYS5TUkVudGVyUGx1c0V4aXRUaW1l
KTsKKwkJCW1vZGVfbGliLT52YmEuWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSA9IENhbGN1bGF0
ZVJlbW90ZVN1cmZhY2VGbGlwRGVsYXkoCisJCQkJCW1vZGVfbGliLAorCQkJCQltb2RlX2xpYi0+
dmJhLlZSYXRpb1trXSwKKwkJCQkJbG9jYWxzLT5Td2F0aFdpZHRoWVtrXSwKKwkJCQkJZG1sX2Nl
aWwobG9jYWxzLT5CeXRlUGVyUGl4ZWxERVRZW2tdLCAxKSwKKwkJCQkJbW9kZV9saWItPnZiYS5I
VG90YWxba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10sCisJCQkJCW1vZGVfbGliLT52
YmEuWEZDVFNsdlZ1cGRhdGVPZmZzZXQsCisJCQkJCW1vZGVfbGliLT52YmEuWEZDVFNsdlZ1cGRh
dGVXaWR0aCwKKwkJCQkJbW9kZV9saWItPnZiYS5YRkNUU2x2VnJlYWR5T2Zmc2V0LAorCQkJCQlt
b2RlX2xpYi0+dmJhLlhGQ1hCVUZMYXRlbmN5VG9sZXJhbmNlLAorCQkJCQltb2RlX2xpYi0+dmJh
LlhGQ0ZpbGxCV092ZXJoZWFkLAorCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1NsdkNodW5rU2l6ZSwK
KwkJCQkJbW9kZV9saWItPnZiYS5YRkNCdXNUcmFuc3BvcnRUaW1lLAorCQkJCQltb2RlX2xpYi0+
dmJhLlRDYWxjLAorCQkJCQlUV2FpdCwKKwkJCQkJJm1vZGVfbGliLT52YmEuU3JjQWN0aXZlRHJh
aW5SYXRlLAorCQkJCQkmbW9kZV9saWItPnZiYS5USW5pdFhGaWxsLAorCQkJCQkmbW9kZV9saWIt
PnZiYS5Uc2x2Q2hrKTsKKwkJCQkJbG9jYWxzLT5YRkNSZW1vdGVTdXJmYWNlRmxpcExhdGVuY3lb
a10gPQorCQkJCQlkbWxfZmxvb3IoCisJCQkJCQkJbW9kZV9saWItPnZiYS5YRkNSZW1vdGVTdXJm
YWNlRmxpcERlbGF5CisJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJ
CQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSksCisJCQkJCQkJMSk7CisJCQlsb2Nh
bHMtPlhGQ1RyYW5zZmVyRGVsYXlba10gPQorCQkJCQlkbWxfY2VpbCgKKwkJCQkJCQltb2RlX2xp
Yi0+dmJhLlhGQ0J1c1RyYW5zcG9ydFRpbWUKKwkJCQkJCQkJCS8gKG1vZGVfbGliLT52YmEuSFRv
dGFsW2tdCisJCQkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKSwKKwkJCQkJ
CQkxKTsKKwkJCWxvY2Fscy0+WEZDUHJlY2hhcmdlRGVsYXlba10gPQorCQkJCQlkbWxfY2VpbCgK
KwkJCQkJCQkobW9kZV9saWItPnZiYS5YRkNCdXNUcmFuc3BvcnRUaW1lCisJCQkJCQkJCQkrIG1v
ZGVfbGliLT52YmEuVEluaXRYRmlsbAorCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLlRzbHZDaGsp
CisJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkJCQkvIG1vZGVf
bGliLT52YmEuUGl4ZWxDbG9ja1trXSksCisJCQkJCQkJMSk7CisJCQltb2RlX2xpYi0+dmJhLklu
aXRGaWxsTGV2ZWwgPSBtb2RlX2xpYi0+dmJhLlhGQ1hCVUZMYXRlbmN5VG9sZXJhbmNlCisJCQkJ
CSogbW9kZV9saWItPnZiYS5TcmNBY3RpdmVEcmFpblJhdGU7CisJCQltb2RlX2xpYi0+dmJhLkZp
bmFsRmlsbE1hcmdpbiA9CisJCQkJCShsb2NhbHMtPkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RW
TUluVkJsYW5rW2tdCisJCQkJCQkJKyBsb2NhbHMtPkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RS
b3dJblZCbGFua1trXSkKKwkJCQkJCQkqIG1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJ
LyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10KKwkJCQkJCQkqIG1vZGVfbGliLT52YmEuU3Jj
QWN0aXZlRHJhaW5SYXRlCisJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLlhGQ0ZpbGxDb25zdGFudDsK
KwkJCW1vZGVfbGliLT52YmEuRmluYWxGaWxsTGV2ZWwgPSBtb2RlX2xpYi0+dmJhLlhGQ1JlbW90
ZVN1cmZhY2VGbGlwRGVsYXkKKwkJCQkJKiBtb2RlX2xpYi0+dmJhLlNyY0FjdGl2ZURyYWluUmF0
ZQorCQkJCQkrIG1vZGVfbGliLT52YmEuRmluYWxGaWxsTWFyZ2luOworCQkJbW9kZV9saWItPnZi
YS5SZW1haW5pbmdGaWxsTGV2ZWwgPSBkbWxfbWF4KAorCQkJCQkwLjAsCisJCQkJCW1vZGVfbGli
LT52YmEuRmluYWxGaWxsTGV2ZWwgLSBtb2RlX2xpYi0+dmJhLkluaXRGaWxsTGV2ZWwpOworCQkJ
bW9kZV9saWItPnZiYS5URmluYWx4RmlsbCA9IG1vZGVfbGliLT52YmEuUmVtYWluaW5nRmlsbExl
dmVsCisJCQkJCS8gKG1vZGVfbGliLT52YmEuU3JjQWN0aXZlRHJhaW5SYXRlCisJCQkJCQkJKiBt
b2RlX2xpYi0+dmJhLlhGQ0ZpbGxCV092ZXJoZWFkIC8gMTAwKTsKKwkJCWxvY2Fscy0+WEZDUHJl
ZmV0Y2hNYXJnaW5ba10gPQorCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1JlbW90ZVN1cmZhY2VGbGlw
RGVsYXkKKwkJCQkJCQkrIG1vZGVfbGliLT52YmEuVEZpbmFseEZpbGwKKwkJCQkJCQkrIChsb2Nh
bHMtPkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluVkJsYW5rW2tdCisJCQkJCQkJCQkrIGxv
Y2Fscy0+RGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rW2tdKQorCQkJCQkJCQkJ
KiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVs
Q2xvY2tba107CisJCX0gZWxzZSB7CisJCQlsb2NhbHMtPlhGQ1NsYXZlVlVwZGF0ZU9mZnNldFtr
XSA9IDA7CisJCQlsb2NhbHMtPlhGQ1NsYXZlVnVwZGF0ZVdpZHRoW2tdID0gMDsKKwkJCWxvY2Fs
cy0+WEZDU2xhdmVWUmVhZHlPZmZzZXRba10gPSAwOworCQkJbG9jYWxzLT5YRkNSZW1vdGVTdXJm
YWNlRmxpcExhdGVuY3lba10gPSAwOworCQkJbG9jYWxzLT5YRkNQcmVjaGFyZ2VEZWxheVtrXSA9
IDA7CisJCQlsb2NhbHMtPlhGQ1RyYW5zZmVyRGVsYXlba10gPSAwOworCQkJbG9jYWxzLT5YRkNQ
cmVmZXRjaE1hcmdpbltrXSA9IDA7CisJCX0KKwl9CisKKwkvLyBTdHV0dGVyIEVmZmljaWVuY3kK
Kwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytr
KSB7CisJCUNhbGN1bGF0ZURFVEJ1ZmZlclNpemUoCisJCQltb2RlX2xpYi0+dmJhLkRFVEJ1ZmZl
clNpemVJbktCeXRlLAorCQkJbW9kZV9saWItPnZiYS5Td2F0aEhlaWdodFlba10sCisJCQltb2Rl
X2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSwKKwkJCSZsb2NhbHMtPkRFVEJ1ZmZlclNpemVZW2td
LAorCQkJJmxvY2Fscy0+REVUQnVmZmVyU2l6ZUNba10pOworCisJCWxvY2Fscy0+TGluZXNJbkRF
VFlba10gPSBsb2NhbHMtPkRFVEJ1ZmZlclNpemVZW2tdCisJCQkJLyBsb2NhbHMtPkJ5dGVQZXJQ
aXhlbERFVFlba10gLyBsb2NhbHMtPlN3YXRoV2lkdGhZW2tdOworCQlsb2NhbHMtPkxpbmVzSW5E
RVRZUm91bmRlZERvd25Ub1N3YXRoW2tdID0gZG1sX2Zsb29yKAorCQkJCWxvY2Fscy0+TGluZXNJ
bkRFVFlba10sCisJCQkJbW9kZV9saWItPnZiYS5Td2F0aEhlaWdodFlba10pOworCQlsb2NhbHMt
PkZ1bGxERVRCdWZmZXJpbmdUaW1lWVtrXSA9CisJCQkJbG9jYWxzLT5MaW5lc0luREVUWVJvdW5k
ZWREb3duVG9Td2F0aFtrXQorCQkJCQkJKiAobW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJ
CQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pCisJCQkJCQkvIG1vZGVfbGliLT52YmEu
VlJhdGlvW2tdOworCX0KKworCW1vZGVfbGliLT52YmEuU3R1dHRlclBlcmlvZCA9IDk5OTk5OS4w
OworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyAr
K2spIHsKKwkJaWYgKGxvY2Fscy0+RnVsbERFVEJ1ZmZlcmluZ1RpbWVZW2tdIDwgbW9kZV9saWIt
PnZiYS5TdHV0dGVyUGVyaW9kKSB7CisJCQltb2RlX2xpYi0+dmJhLlN0dXR0ZXJQZXJpb2QgPSBs
b2NhbHMtPkZ1bGxERVRCdWZmZXJpbmdUaW1lWVtrXTsKKwkJCW1vZGVfbGliLT52YmEuRnJhbWVU
aW1lRm9yTWluRnVsbERFVEJ1ZmZlcmluZ1RpbWUgPQorCQkJCShkb3VibGUpIG1vZGVfbGliLT52
YmEuVlRvdGFsW2tdICogbW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkvIG1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja1trXTsKKwkJCWxvY2Fscy0+Qnl0ZVBlclBpeGVsWUNyaXRpY2FsUGxhbmUg
PSBkbWxfY2VpbChsb2NhbHMtPkJ5dGVQZXJQaXhlbERFVFlba10sIDEpOworCQkJbG9jYWxzLT5T
d2F0aFdpZHRoWUNyaXRpY2FsUGxhbmUgPSBsb2NhbHMtPlN3YXRoV2lkdGhZW2tdOworCQkJbG9j
YWxzLT5MaW5lc1RvRmluaXNoU3dhdGhUcmFuc2ZlclN0dXR0ZXJDcml0aWNhbFBsYW5lID0KKwkJ
CQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0WVtrXSAtIChsb2NhbHMtPkxpbmVzSW5ERVRZW2td
IC0gbG9jYWxzLT5MaW5lc0luREVUWVJvdW5kZWREb3duVG9Td2F0aFtrXSk7CisJCX0KKwl9CisK
Kwltb2RlX2xpYi0+dmJhLkF2ZXJhZ2VSZWFkQmFuZHdpZHRoID0gMC4wOworCW1vZGVfbGliLT52
YmEuVG90YWxSb3dSZWFkQmFuZHdpZHRoID0gMC4wOworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xp
Yi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJdW5zaWduZWQgaW50IERDQ1Jh
dGVMaW1pdDsKKworCQlpZiAobW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10pIHsKKwkJCWlmIChs
b2NhbHMtPkRDQ1lNYXhDb21wcmVzc2VkQmxvY2tba10gPT0gMjU2KQorCQkJCURDQ1JhdGVMaW1p
dCA9IDQ7CisJCQllbHNlCisJCQkJRENDUmF0ZUxpbWl0ID0gMjsKKworCQkJbW9kZV9saWItPnZi
YS5BdmVyYWdlUmVhZEJhbmR3aWR0aCA9CisJCQkJCW1vZGVfbGliLT52YmEuQXZlcmFnZVJlYWRC
YW5kd2lkdGgKKwkJCQkJCQkrIChsb2NhbHMtPlJlYWRCYW5kd2lkdGhQbGFuZUx1bWFba10gKyBs
b2NhbHMtPlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXSkgLworCQkJCQkJCQlkbWxfbWluKG1v
ZGVfbGliLT52YmEuRENDUmF0ZVtrXSwgRENDUmF0ZUxpbWl0KTsKKwkJfSBlbHNlIHsKKwkJCW1v
ZGVfbGliLT52YmEuQXZlcmFnZVJlYWRCYW5kd2lkdGggPQorCQkJCQltb2RlX2xpYi0+dmJhLkF2
ZXJhZ2VSZWFkQmFuZHdpZHRoCisJCQkJCQkJKyBsb2NhbHMtPlJlYWRCYW5kd2lkdGhQbGFuZUx1
bWFba10KKwkJCQkJCQkrIGxvY2Fscy0+UmVhZEJhbmR3aWR0aFBsYW5lQ2hyb21hW2tdOworCQl9
CisJCW1vZGVfbGliLT52YmEuVG90YWxSb3dSZWFkQmFuZHdpZHRoID0gbW9kZV9saWItPnZiYS5U
b3RhbFJvd1JlYWRCYW5kd2lkdGggKworCQlsb2NhbHMtPm1ldGFfcm93X2J3W2tdICsgbG9jYWxz
LT5kcHRlX3Jvd19id1trXTsKKwl9CisKKwltb2RlX2xpYi0+dmJhLkF2ZXJhZ2VEQ0NDb21wcmVz
c2lvblJhdGUgPSBtb2RlX2xpYi0+dmJhLlRvdGFsRGF0YVJlYWRCYW5kd2lkdGggLyBtb2RlX2xp
Yi0+dmJhLkF2ZXJhZ2VSZWFkQmFuZHdpZHRoOworCisJbW9kZV9saWItPnZiYS5QYXJ0T2ZCdXJz
dFRoYXRGaXRzSW5ST0IgPQorCQkJZG1sX21pbigKKwkJCQkJbW9kZV9saWItPnZiYS5TdHV0dGVy
UGVyaW9kCisJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlRvdGFsRGF0YVJlYWRCYW5kd2lkdGgsCisJ
CQkJCW1vZGVfbGliLT52YmEuUk9CQnVmZmVyU2l6ZUluS0J5dGUgKiAxMDI0CisJCQkJCQkJKiBt
b2RlX2xpYi0+dmJhLkF2ZXJhZ2VEQ0NDb21wcmVzc2lvblJhdGUpOworCW1vZGVfbGliLT52YmEu
U3R1dHRlckJ1cnN0VGltZSA9IG1vZGVfbGliLT52YmEuUGFydE9mQnVyc3RUaGF0Rml0c0luUk9C
CisJCQkvIG1vZGVfbGliLT52YmEuQXZlcmFnZURDQ0NvbXByZXNzaW9uUmF0ZSAvIG1vZGVfbGli
LT52YmEuUmV0dXJuQlcKKwkJCSsgKG1vZGVfbGliLT52YmEuU3R1dHRlclBlcmlvZCAqIG1vZGVf
bGliLT52YmEuVG90YWxEYXRhUmVhZEJhbmR3aWR0aAorCQkJCQktIG1vZGVfbGliLT52YmEuUGFy
dE9mQnVyc3RUaGF0Rml0c0luUk9CKQorCQkJCQkvIChtb2RlX2xpYi0+dmJhLkRDRkNMSyAqIDY0
KQorCQkJCQkrIG1vZGVfbGliLT52YmEuU3R1dHRlclBlcmlvZCAqIG1vZGVfbGliLT52YmEuVG90
YWxSb3dSZWFkQmFuZHdpZHRoIC8gbW9kZV9saWItPnZiYS5SZXR1cm5CVzsKKwltb2RlX2xpYi0+
dmJhLlN0dXR0ZXJCdXJzdFRpbWUgPSBkbWxfbWF4KAorCQltb2RlX2xpYi0+dmJhLlN0dXR0ZXJC
dXJzdFRpbWUsCisJCShsb2NhbHMtPkxpbmVzVG9GaW5pc2hTd2F0aFRyYW5zZmVyU3R1dHRlckNy
aXRpY2FsUGxhbmUgKiBsb2NhbHMtPkJ5dGVQZXJQaXhlbFlDcml0aWNhbFBsYW5lICoKKwkJbG9j
YWxzLT5Td2F0aFdpZHRoWUNyaXRpY2FsUGxhbmUgLyBtb2RlX2xpYi0+dmJhLlJldHVybkJXKQor
CSk7CisKKwltb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlV3JpdGViYWNrID0gMDsKKwlmb3IgKGsg
PSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlm
IChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9PSB0cnVlKSB7CisJCQltb2RlX2xp
Yi0+dmJhLlRvdGFsQWN0aXZlV3JpdGViYWNrID0gbW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZVdy
aXRlYmFjayArIDE7CisJCX0KKwl9CisKKwlpZiAobW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZVdy
aXRlYmFjayA9PSAwKSB7CisJCW1vZGVfbGliLT52YmEuU3R1dHRlckVmZmljaWVuY3lOb3RJbmNs
dWRpbmdWQmxhbmsgPSAoMQorCQkJCS0gKG1vZGVfbGliLT52YmEuU1JFeGl0VGltZSArIG1vZGVf
bGliLT52YmEuU3R1dHRlckJ1cnN0VGltZSkKKwkJCQkJCS8gbW9kZV9saWItPnZiYS5TdHV0dGVy
UGVyaW9kKSAqIDEwMDsKKwl9IGVsc2UgeworCQltb2RlX2xpYi0+dmJhLlN0dXR0ZXJFZmZpY2ll
bmN5Tm90SW5jbHVkaW5nVkJsYW5rID0gMDsKKwl9CisKKwltb2RlX2xpYi0+dmJhLlNtYWxsZXN0
VkJsYW5rID0gOTk5OTk5OworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9m
QWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuU3luY2hyb25pemVkVkJs
YW5rIHx8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgPT0gMSkgeworCQkJbW9k
ZV9saWItPnZiYS5WQmxhbmtUaW1lID0gKGRvdWJsZSkgKG1vZGVfbGliLT52YmEuVlRvdGFsW2td
CisJCQkJCS0gbW9kZV9saWItPnZiYS5WQWN0aXZlW2tdKSAqIG1vZGVfbGliLT52YmEuSFRvdGFs
W2tdCisJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdOworCQl9IGVsc2UgeworCQkJ
bW9kZV9saWItPnZiYS5WQmxhbmtUaW1lID0gMDsKKwkJfQorCQltb2RlX2xpYi0+dmJhLlNtYWxs
ZXN0VkJsYW5rID0gZG1sX21pbigKKwkJCQltb2RlX2xpYi0+dmJhLlNtYWxsZXN0VkJsYW5rLAor
CQkJCW1vZGVfbGliLT52YmEuVkJsYW5rVGltZSk7CisJfQorCisJbW9kZV9saWItPnZiYS5TdHV0
dGVyRWZmaWNpZW5jeSA9IChtb2RlX2xpYi0+dmJhLlN0dXR0ZXJFZmZpY2llbmN5Tm90SW5jbHVk
aW5nVkJsYW5rIC8gMTAwCisJCQkqIChtb2RlX2xpYi0+dmJhLkZyYW1lVGltZUZvck1pbkZ1bGxE
RVRCdWZmZXJpbmdUaW1lCisJCQkJCS0gbW9kZV9saWItPnZiYS5TbWFsbGVzdFZCbGFuaykKKwkJ
CSsgbW9kZV9saWItPnZiYS5TbWFsbGVzdFZCbGFuaykKKwkJCS8gbW9kZV9saWItPnZiYS5GcmFt
ZVRpbWVGb3JNaW5GdWxsREVUQnVmZmVyaW5nVGltZSAqIDEwMDsKK30KKworc3RhdGljIHZvaWQg
RGlzcGxheVBpcGVDb25maWd1cmF0aW9uKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xp
YikKK3sKKwkvLyBEaXNwbGF5IFBpcGUgQ29uZmlndXJhdGlvbgorCWRvdWJsZSBCeXRlUGVyUGl4
REVUWTsKKwlkb3VibGUgQnl0ZVBlclBpeERFVEM7CisJZG91YmxlIFJlYWQyNTZCeXRlc0Jsb2Nr
SGVpZ2h0WTsKKwlkb3VibGUgUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRDOworCWRvdWJsZSBSZWFk
MjU2Qnl0ZXNCbG9ja1dpZHRoWTsKKwlkb3VibGUgUmVhZDI1NkJ5dGVzQmxvY2tXaWR0aEM7CisJ
ZG91YmxlIE1heGltdW1Td2F0aEhlaWdodFk7CisJZG91YmxlIE1heGltdW1Td2F0aEhlaWdodEM7
CisJZG91YmxlIE1pbmltdW1Td2F0aEhlaWdodFk7CisJZG91YmxlIE1pbmltdW1Td2F0aEhlaWdo
dEM7CisJZG91YmxlIFN3YXRoV2lkdGg7CisJZG91YmxlIFN3YXRoV2lkdGhHcmFudWxhcml0eVk7
CisJZG91YmxlIFN3YXRoV2lkdGhHcmFudWxhcml0eUM7CisJZG91YmxlIFJvdW5kZWRVcE1heFN3
YXRoU2l6ZUJ5dGVzWTsKKwlkb3VibGUgUm91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNDOworCXVu
c2lnbmVkIGludCBqLCBrOworCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVy
T2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlib29sIE1haW5QbGFuZURvZXNPRE1Db21iaW5lID0g
ZmFsc2U7CisKKwkJaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1f
NDQ0XzY0KSB7CisJCQlCeXRlUGVyUGl4REVUWSA9IDg7CisJCQlCeXRlUGVyUGl4REVUQyA9IDA7
CisJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80
NDRfMzIpIHsKKwkJCUJ5dGVQZXJQaXhERVRZID0gNDsKKwkJCUJ5dGVQZXJQaXhERVRDID0gMDsK
KwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0
NF8xNikgeworCQkJQnl0ZVBlclBpeERFVFkgPSAyOworCQkJQnl0ZVBlclBpeERFVEMgPSAwOwor
CQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0
XzgpIHsKKwkJCUJ5dGVQZXJQaXhERVRZID0gMTsKKwkJCUJ5dGVQZXJQaXhERVRDID0gMDsKKwkJ
fSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQyMF84
KSB7CisJCQlCeXRlUGVyUGl4REVUWSA9IDE7CisJCQlCeXRlUGVyUGl4REVUQyA9IDI7CisJCX0g
ZWxzZSB7CisJCQlCeXRlUGVyUGl4REVUWSA9IDQuMCAvIDMuMDsKKwkJCUJ5dGVQZXJQaXhERVRD
ID0gOC4wIC8gMy4wOworCQl9CisKKwkJaWYgKChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9y
bWF0W2tdID09IGRtXzQ0NF82NAorCQkJCXx8IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3Jt
YXRba10gPT0gZG1fNDQ0XzMyCisJCQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1h
dFtrXSA9PSBkbV80NDRfMTYKKwkJCQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0
W2tdID09IGRtXzQ0NF84KSkgeworCQkJaWYgKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1tr
XSA9PSBkbV9zd19saW5lYXIpIHsKKwkJCQlSZWFkMjU2Qnl0ZXNCbG9ja0hlaWdodFkgPSAxOwor
CQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0
NF82NCkgeworCQkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0WSA9IDQ7CisJCQl9IGVsc2UgaWYg
KG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzMyCisJCQkJCXx8
IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzE2KSB7CisJCQkJ
UmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRZID0gODsKKwkJCX0gZWxzZSB7CisJCQkJUmVhZDI1NkJ5
dGVzQmxvY2tIZWlnaHRZID0gMTY7CisJCQl9CisJCQlSZWFkMjU2Qnl0ZXNCbG9ja1dpZHRoWSA9
IDI1NiAvIGRtbF9jZWlsKEJ5dGVQZXJQaXhERVRZLCAxKQorCQkJCQkvIFJlYWQyNTZCeXRlc0Js
b2NrSGVpZ2h0WTsKKwkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0QyA9IDA7CisJCQlSZWFkMjU2
Qnl0ZXNCbG9ja1dpZHRoQyA9IDA7CisJCX0gZWxzZSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5T
dXJmYWNlVGlsaW5nW2tdID09IGRtX3N3X2xpbmVhcikgeworCQkJCVJlYWQyNTZCeXRlc0Jsb2Nr
SGVpZ2h0WSA9IDE7CisJCQkJUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRDID0gMTsKKwkJCX0gZWxz
ZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfOCkgewor
CQkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0WSA9IDE2OworCQkJCVJlYWQyNTZCeXRlc0Jsb2Nr
SGVpZ2h0QyA9IDg7CisJCQl9IGVsc2UgeworCQkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0WSA9
IDg7CisJCQkJUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRDID0gODsKKwkJCX0KKwkJCVJlYWQyNTZC
eXRlc0Jsb2NrV2lkdGhZID0gMjU2IC8gZG1sX2NlaWwoQnl0ZVBlclBpeERFVFksIDEpCisJCQkJ
CS8gUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRZOworCQkJUmVhZDI1NkJ5dGVzQmxvY2tXaWR0aEMg
PSAyNTYgLyBkbWxfY2VpbChCeXRlUGVyUGl4REVUQywgMikKKwkJCQkJLyBSZWFkMjU2Qnl0ZXNC
bG9ja0hlaWdodEM7CisJCX0KKworCQlpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdID09
IGRtX2hvcnopIHsKKwkJCU1heGltdW1Td2F0aEhlaWdodFkgPSBSZWFkMjU2Qnl0ZXNCbG9ja0hl
aWdodFk7CisJCQlNYXhpbXVtU3dhdGhIZWlnaHRDID0gUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRD
OworCQl9IGVsc2UgeworCQkJTWF4aW11bVN3YXRoSGVpZ2h0WSA9IFJlYWQyNTZCeXRlc0Jsb2Nr
V2lkdGhZOworCQkJTWF4aW11bVN3YXRoSGVpZ2h0QyA9IFJlYWQyNTZCeXRlc0Jsb2NrV2lkdGhD
OworCQl9CisKKwkJaWYgKChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRt
XzQ0NF82NAorCQkJCXx8IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1f
NDQ0XzMyCisJCQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80
NDRfMTYKKwkJCQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0
NF84KSkgeworCQkJaWYgKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSA9PSBkbV9zd19s
aW5lYXIKKwkJCQkJfHwgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1f
NDQ0XzY0CisJCQkJCQkJJiYgKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXQorCQkJCQkJ
CQkJPT0gZG1fc3dfNGtiX3MKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGlu
Z1trXQorCQkJCQkJCQkJCQk9PSBkbV9zd180a2Jfc194CisJCQkJCQkJCQl8fCBtb2RlX2xpYi0+
dmJhLlN1cmZhY2VUaWxpbmdba10KKwkJCQkJCQkJCQkJPT0gZG1fc3dfNjRrYl9zCisJCQkJCQkJ
CQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10KKwkJCQkJCQkJCQkJPT0gZG1fc3df
NjRrYl9zX3QKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXQorCQkJ
CQkJCQkJCQk9PSBkbV9zd182NGtiX3NfeAorCQkJCQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJm
YWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJCT09IGRtX3N3X3Zhcl9zCisJCQkJCQkJCQl8fCBtb2Rl
X2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10KKwkJCQkJCQkJCQkJPT0gZG1fc3dfdmFyX3NfeCkK
KwkJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikpIHsKKwkJ
CQlNaW5pbXVtU3dhdGhIZWlnaHRZID0gTWF4aW11bVN3YXRoSGVpZ2h0WTsKKwkJCX0gZWxzZSBp
ZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80NDRfOAorCQkJCQkm
JiBtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gIT0gZG1faG9yeikgeworCQkJCU1pbmltdW1T
d2F0aEhlaWdodFkgPSBNYXhpbXVtU3dhdGhIZWlnaHRZOworCQkJfSBlbHNlIHsKKwkJCQlNaW5p
bXVtU3dhdGhIZWlnaHRZID0gTWF4aW11bVN3YXRoSGVpZ2h0WSAvIDIuMDsKKwkJCX0KKwkJCU1p
bmltdW1Td2F0aEhlaWdodEMgPSBNYXhpbXVtU3dhdGhIZWlnaHRDOworCQl9IGVsc2UgeworCQkJ
aWYgKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSA9PSBkbV9zd19saW5lYXIpIHsKKwkJ
CQlNaW5pbXVtU3dhdGhIZWlnaHRZID0gTWF4aW11bVN3YXRoSGVpZ2h0WTsKKwkJCQlNaW5pbXVt
U3dhdGhIZWlnaHRDID0gTWF4aW11bVN3YXRoSGVpZ2h0QzsKKwkJCX0gZWxzZSBpZiAobW9kZV9s
aWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfOAorCQkJCQkmJiBtb2RlX2xp
Yi0+dmJhLlNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikgeworCQkJCU1pbmltdW1Td2F0aEhlaWdo
dFkgPSBNYXhpbXVtU3dhdGhIZWlnaHRZIC8gMi4wOworCQkJCU1pbmltdW1Td2F0aEhlaWdodEMg
PSBNYXhpbXVtU3dhdGhIZWlnaHRDOworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJj
ZVBpeGVsRm9ybWF0W2tdID09IGRtXzQyMF8xMAorCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJj
ZVNjYW5ba10gPT0gZG1faG9yeikgeworCQkJCU1pbmltdW1Td2F0aEhlaWdodEMgPSBNYXhpbXVt
U3dhdGhIZWlnaHRDIC8gMi4wOworCQkJCU1pbmltdW1Td2F0aEhlaWdodFkgPSBNYXhpbXVtU3dh
dGhIZWlnaHRZOworCQkJfSBlbHNlIHsKKwkJCQlNaW5pbXVtU3dhdGhIZWlnaHRZID0gTWF4aW11
bVN3YXRoSGVpZ2h0WTsKKwkJCQlNaW5pbXVtU3dhdGhIZWlnaHRDID0gTWF4aW11bVN3YXRoSGVp
Z2h0QzsKKwkJCX0KKwkJfQorCisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gPT0g
ZG1faG9yeikgeworCQkJU3dhdGhXaWR0aCA9IG1vZGVfbGliLT52YmEuVmlld3BvcnRXaWR0aFtr
XTsKKwkJfSBlbHNlIHsKKwkJCVN3YXRoV2lkdGggPSBtb2RlX2xpYi0+dmJhLlZpZXdwb3J0SGVp
Z2h0W2tdOworCQl9CisKKwkJaWYgKG1vZGVfbGliLT52YmEuT0RNQ29tYmluZUVuYWJsZWRba10g
PT0gdHJ1ZSkgeworCQkJTWFpblBsYW5lRG9lc09ETUNvbWJpbmUgPSB0cnVlOworCQl9CisJCWZv
ciAoaiA9IDA7IGogPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2opIHsK
KwkJCWlmIChtb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdID09IGoKKwkJCQkJJiYg
bW9kZV9saWItPnZiYS5PRE1Db21iaW5lRW5hYmxlZFtqXSA9PSB0cnVlKSB7CisJCQkJTWFpblBs
YW5lRG9lc09ETUNvbWJpbmUgPSB0cnVlOworCQkJfQorCQl9CisKKwkJaWYgKE1haW5QbGFuZURv
ZXNPRE1Db21iaW5lID09IHRydWUpIHsKKwkJCVN3YXRoV2lkdGggPSBkbWxfbWluKAorCQkJCQlT
d2F0aFdpZHRoLAorCQkJCQltb2RlX2xpYi0+dmJhLkhBY3RpdmVba10gLyAyLjAgKiBtb2RlX2xp
Yi0+dmJhLkhSYXRpb1trXSk7CisJCX0gZWxzZSB7CisJCQlTd2F0aFdpZHRoID0gU3dhdGhXaWR0
aCAvIG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba107CisJCX0KKworCQlTd2F0aFdpZHRoR3Jh
bnVsYXJpdHlZID0gMjU2IC8gZG1sX2NlaWwoQnl0ZVBlclBpeERFVFksIDEpIC8gTWF4aW11bVN3
YXRoSGVpZ2h0WTsKKwkJUm91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNZID0gKGRtbF9jZWlsKAor
CQkJCShkb3VibGUpIChTd2F0aFdpZHRoIC0gMSksCisJCQkJU3dhdGhXaWR0aEdyYW51bGFyaXR5
WSkgKyBTd2F0aFdpZHRoR3JhbnVsYXJpdHlZKSAqIEJ5dGVQZXJQaXhERVRZCisJCQkJKiBNYXhp
bXVtU3dhdGhIZWlnaHRZOworCQlpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtr
XSA9PSBkbV80MjBfMTApIHsKKwkJCVJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5dGVzWSA9IGRtbF9j
ZWlsKFJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5dGVzWSwgMjU2KQorCQkJCQkrIDI1NjsKKwkJfQor
CQlpZiAoTWF4aW11bVN3YXRoSGVpZ2h0QyA+IDApIHsKKwkJCVN3YXRoV2lkdGhHcmFudWxhcml0
eUMgPSAyNTYuMCAvIGRtbF9jZWlsKEJ5dGVQZXJQaXhERVRDLCAyKQorCQkJCQkvIE1heGltdW1T
d2F0aEhlaWdodEM7CisJCQlSb3VuZGVkVXBNYXhTd2F0aFNpemVCeXRlc0MgPSAoZG1sX2NlaWwo
CisJCQkJCShkb3VibGUpIChTd2F0aFdpZHRoIC8gMi4wIC0gMSksCisJCQkJCVN3YXRoV2lkdGhH
cmFudWxhcml0eUMpICsgU3dhdGhXaWR0aEdyYW51bGFyaXR5QykKKwkJCQkJKiBCeXRlUGVyUGl4
REVUQyAqIE1heGltdW1Td2F0aEhlaWdodEM7CisJCQlpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQ
aXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfMTApIHsKKwkJCQlSb3VuZGVkVXBNYXhTd2F0aFNpemVC
eXRlc0MgPSBkbWxfY2VpbCgKKwkJCQkJCVJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5dGVzQywKKwkJ
CQkJCTI1NikgKyAyNTY7CisJCQl9CisJCX0gZWxzZQorCQkJUm91bmRlZFVwTWF4U3dhdGhTaXpl
Qnl0ZXNDID0gMC4wOworCisJCWlmIChSb3VuZGVkVXBNYXhTd2F0aFNpemVCeXRlc1kgKyBSb3Vu
ZGVkVXBNYXhTd2F0aFNpemVCeXRlc0MKKwkJCQk8PSBtb2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNp
emVJbktCeXRlICogMTAyNC4wIC8gMi4wKSB7CisJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0
WVtrXSA9IE1heGltdW1Td2F0aEhlaWdodFk7CisJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0
Q1trXSA9IE1heGltdW1Td2F0aEhlaWdodEM7CisJCX0gZWxzZSB7CisJCQltb2RlX2xpYi0+dmJh
LlN3YXRoSGVpZ2h0WVtrXSA9IE1pbmltdW1Td2F0aEhlaWdodFk7CisJCQltb2RlX2xpYi0+dmJh
LlN3YXRoSGVpZ2h0Q1trXSA9IE1pbmltdW1Td2F0aEhlaWdodEM7CisJCX0KKworCQlDYWxjdWxh
dGVERVRCdWZmZXJTaXplKAorCQkJCW1vZGVfbGliLT52YmEuREVUQnVmZmVyU2l6ZUluS0J5dGUs
CisJCQkJbW9kZV9saWItPnZiYS5Td2F0aEhlaWdodFlba10sCisJCQkJbW9kZV9saWItPnZiYS5T
d2F0aEhlaWdodENba10sCisJCQkJJm1vZGVfbGliLT52YmEuREVUQnVmZmVyU2l6ZVlba10sCisJ
CQkJJm1vZGVfbGliLT52YmEuREVUQnVmZmVyU2l6ZUNba10pOworCX0KK30KKworc3RhdGljIGRv
dWJsZSBDYWxjdWxhdGVUV2FpdCgKKwkJdW5zaWduZWQgaW50IFByZWZldGNoTW9kZSwKKwkJZG91
YmxlIERSQU1DbG9ja0NoYW5nZUxhdGVuY3ksCisJCWRvdWJsZSBVcmdlbnRMYXRlbmN5LAorCQlk
b3VibGUgU1JFbnRlclBsdXNFeGl0VGltZSkKK3sKKwlpZiAoUHJlZmV0Y2hNb2RlID09IDApIHsK
KwkJcmV0dXJuIGRtbF9tYXgoCisJCQkJRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeSArIFVyZ2VudExh
dGVuY3ksCisJCQkJZG1sX21heChTUkVudGVyUGx1c0V4aXRUaW1lLCBVcmdlbnRMYXRlbmN5KSk7
CisJfSBlbHNlIGlmIChQcmVmZXRjaE1vZGUgPT0gMSkgeworCQlyZXR1cm4gZG1sX21heChTUkVu
dGVyUGx1c0V4aXRUaW1lLCBVcmdlbnRMYXRlbmN5KTsKKwl9IGVsc2UgeworCQlyZXR1cm4gVXJn
ZW50TGF0ZW5jeTsKKwl9Cit9CisKK3N0YXRpYyBkb3VibGUgQ2FsY3VsYXRlUmVtb3RlU3VyZmFj
ZUZsaXBEZWxheSgKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3Vi
bGUgVlJhdGlvLAorCQlkb3VibGUgU3dhdGhXaWR0aCwKKwkJZG91YmxlIEJwcCwKKwkJZG91Ymxl
IExpbmVUaW1lLAorCQlkb3VibGUgWEZDVFNsdlZ1cGRhdGVPZmZzZXQsCisJCWRvdWJsZSBYRkNU
U2x2VnVwZGF0ZVdpZHRoLAorCQlkb3VibGUgWEZDVFNsdlZyZWFkeU9mZnNldCwKKwkJZG91Ymxl
IFhGQ1hCVUZMYXRlbmN5VG9sZXJhbmNlLAorCQlkb3VibGUgWEZDRmlsbEJXT3ZlcmhlYWQsCisJ
CWRvdWJsZSBYRkNTbHZDaHVua1NpemUsCisJCWRvdWJsZSBYRkNCdXNUcmFuc3BvcnRUaW1lLAor
CQlkb3VibGUgVENhbGMsCisJCWRvdWJsZSBUV2FpdCwKKwkJZG91YmxlICpTcmNBY3RpdmVEcmFp
blJhdGUsCisJCWRvdWJsZSAqVEluaXRYRmlsbCwKKwkJZG91YmxlICpUc2x2Q2hrKQoreworCWRv
dWJsZSBUU2x2U2V0dXAsIEF2Z2ZpbGxSYXRlLCByZXN1bHQ7CisKKwkqU3JjQWN0aXZlRHJhaW5S
YXRlID0gVlJhdGlvICogU3dhdGhXaWR0aCAqIEJwcCAvIExpbmVUaW1lOworCVRTbHZTZXR1cCA9
IFhGQ1RTbHZWdXBkYXRlT2Zmc2V0ICsgWEZDVFNsdlZ1cGRhdGVXaWR0aCArIFhGQ1RTbHZWcmVh
ZHlPZmZzZXQ7CisJKlRJbml0WEZpbGwgPSBYRkNYQlVGTGF0ZW5jeVRvbGVyYW5jZSAvICgxICsg
WEZDRmlsbEJXT3ZlcmhlYWQgLyAxMDApOworCUF2Z2ZpbGxSYXRlID0gKlNyY0FjdGl2ZURyYWlu
UmF0ZSAqICgxICsgWEZDRmlsbEJXT3ZlcmhlYWQgLyAxMDApOworCSpUc2x2Q2hrID0gWEZDU2x2
Q2h1bmtTaXplIC8gQXZnZmlsbFJhdGU7CisJZG1sX3ByaW50KAorCQkJIkRNTDo6Q2FsY3VsYXRl
UmVtb3RlU3VyZmFjZUZsaXBEZWxheTogU3JjQWN0aXZlRHJhaW5SYXRlOiAlZlxuIiwKKwkJCSpT
cmNBY3RpdmVEcmFpblJhdGUpOworCWRtbF9wcmludCgiRE1MOjpDYWxjdWxhdGVSZW1vdGVTdXJm
YWNlRmxpcERlbGF5OiBUU2x2U2V0dXA6ICVmXG4iLCBUU2x2U2V0dXApOworCWRtbF9wcmludCgi
RE1MOjpDYWxjdWxhdGVSZW1vdGVTdXJmYWNlRmxpcERlbGF5OiBUSW5pdFhGaWxsOiAlZlxuIiwg
KlRJbml0WEZpbGwpOworCWRtbF9wcmludCgiRE1MOjpDYWxjdWxhdGVSZW1vdGVTdXJmYWNlRmxp
cERlbGF5OiBBdmdmaWxsUmF0ZTogJWZcbiIsIEF2Z2ZpbGxSYXRlKTsKKwlkbWxfcHJpbnQoIkRN
TDo6Q2FsY3VsYXRlUmVtb3RlU3VyZmFjZUZsaXBEZWxheTogVHNsdkNoazogJWZcbiIsICpUc2x2
Q2hrKTsKKwlyZXN1bHQgPSAyICogWEZDQnVzVHJhbnNwb3J0VGltZSArIFRTbHZTZXR1cCArIFRD
YWxjICsgVFdhaXQgKyAqVHNsdkNoayArICpUSW5pdFhGaWxsOyAvLyBUT0RPOiBUaGlzIGRvZXNu
J3Qgc2VlbSB0byBtYXRjaCBwcm9ncmFtbWluZyBndWlkZQorCWRtbF9wcmludCgiRE1MOjpDYWxj
dWxhdGVSZW1vdGVTdXJmYWNlRmxpcERlbGF5OiBSZW1vdGVTdXJmYWNlRmxpcERlbGF5OiAlZlxu
IiwgcmVzdWx0KTsKKwlyZXR1cm4gcmVzdWx0OworfQorCitzdGF0aWMgZG91YmxlIENhbGN1bGF0
ZVdyaXRlQmFja0RlbGF5KAorCQllbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MgV3JpdGViYWNrUGl4
ZWxGb3JtYXQsCisJCWRvdWJsZSBXcml0ZWJhY2tIUmF0aW8sCisJCWRvdWJsZSBXcml0ZWJhY2tW
UmF0aW8sCisJCXVuc2lnbmVkIGludCBXcml0ZWJhY2tMdW1hSFRhcHMsCisJCXVuc2lnbmVkIGlu
dCBXcml0ZWJhY2tMdW1hVlRhcHMsCisJCXVuc2lnbmVkIGludCBXcml0ZWJhY2tDaHJvbWFIVGFw
cywKKwkJdW5zaWduZWQgaW50IFdyaXRlYmFja0Nocm9tYVZUYXBzLAorCQl1bnNpZ25lZCBpbnQg
V3JpdGViYWNrRGVzdGluYXRpb25XaWR0aCkKK3sKKwlkb3VibGUgQ2FsY3VsYXRlV3JpdGVCYWNr
RGVsYXkgPQorCQkJZG1sX21heCgKKwkJCQkJZG1sX2NlaWwoV3JpdGViYWNrTHVtYUhUYXBzIC8g
NC4wLCAxKSAvIFdyaXRlYmFja0hSYXRpbywKKwkJCQkJV3JpdGViYWNrTHVtYVZUYXBzICogZG1s
X2NlaWwoMS4wIC8gV3JpdGViYWNrVlJhdGlvLCAxKQorCQkJCQkJCSogZG1sX2NlaWwoCisJCQkJ
CQkJCQlXcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoCisJCQkJCQkJCQkJCS8gNC4wLAorCQkJCQkJ
CQkJMSkKKwkJCQkJCQkrIGRtbF9jZWlsKDEuMCAvIFdyaXRlYmFja1ZSYXRpbywgMSkKKwkJCQkJ
CQkJCSogKGRtbF9jZWlsKAorCQkJCQkJCQkJCQlXcml0ZWJhY2tMdW1hVlRhcHMKKwkJCQkJCQkJ
CQkJCQkvIDQuMCwKKwkJCQkJCQkJCQkJMSkgKyA0KSk7CisKKwlpZiAoV3JpdGViYWNrUGl4ZWxG
b3JtYXQgIT0gZG1fNDQ0XzMyKSB7CisJCUNhbGN1bGF0ZVdyaXRlQmFja0RlbGF5ID0KKwkJCQlk
bWxfbWF4KAorCQkJCQkJQ2FsY3VsYXRlV3JpdGVCYWNrRGVsYXksCisJCQkJCQlkbWxfbWF4KAor
CQkJCQkJCQlkbWxfY2VpbCgKKwkJCQkJCQkJCQlXcml0ZWJhY2tDaHJvbWFIVGFwcworCQkJCQkJ
CQkJCQkJLyAyLjAsCisJCQkJCQkJCQkJMSkKKwkJCQkJCQkJCQkvICgyCisJCQkJCQkJCQkJCQkq
IFdyaXRlYmFja0hSYXRpbyksCisJCQkJCQkJCVdyaXRlYmFja0Nocm9tYVZUYXBzCisJCQkJCQkJ
CQkJKiBkbWxfY2VpbCgKKwkJCQkJCQkJCQkJCTEKKwkJCQkJCQkJCQkJCQkJLyAoMgorCQkJCQkJ
CQkJCQkJCQkJCSogV3JpdGViYWNrVlJhdGlvKSwKKwkJCQkJCQkJCQkJCTEpCisJCQkJCQkJCQkJ
KiBkbWxfY2VpbCgKKwkJCQkJCQkJCQkJCVdyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGgKKwkJCQkJ
CQkJCQkJCQkJLyAyLjAKKwkJCQkJCQkJCQkJCQkJLyAyLjAsCisJCQkJCQkJCQkJCQkxKQorCQkJ
CQkJCQkJCSsgZG1sX2NlaWwoCisJCQkJCQkJCQkJCQkxCisJCQkJCQkJCQkJCQkJCS8gKDIKKwkJ
CQkJCQkJCQkJCQkJCQkqIFdyaXRlYmFja1ZSYXRpbyksCisJCQkJCQkJCQkJCQkxKQorCQkJCQkJ
CQkJCQkJKiAoZG1sX2NlaWwoCisJCQkJCQkJCQkJCQkJCVdyaXRlYmFja0Nocm9tYVZUYXBzCisJ
CQkJCQkJCQkJCQkJCQkJLyA0LjAsCisJCQkJCQkJCQkJCQkJCTEpCisJCQkJCQkJCQkJCQkJCSsg
NCkpKTsKKwl9CisJcmV0dXJuIENhbGN1bGF0ZVdyaXRlQmFja0RlbGF5OworfQorCitzdGF0aWMg
dm9pZCBDYWxjdWxhdGVBY3RpdmVSb3dCYW5kd2lkdGgoCisJCWJvb2wgR1BVVk1FbmFibGUsCisJ
CWVudW0gc291cmNlX2Zvcm1hdF9jbGFzcyBTb3VyY2VQaXhlbEZvcm1hdCwKKwkJZG91YmxlIFZS
YXRpbywKKwkJYm9vbCBEQ0NFbmFibGUsCisJCWRvdWJsZSBMaW5lVGltZSwKKwkJdW5zaWduZWQg
aW50IE1ldGFSb3dCeXRlTHVtYSwKKwkJdW5zaWduZWQgaW50IE1ldGFSb3dCeXRlQ2hyb21hLAor
CQl1bnNpZ25lZCBpbnQgbWV0YV9yb3dfaGVpZ2h0X2x1bWEsCisJCXVuc2lnbmVkIGludCBtZXRh
X3Jvd19oZWlnaHRfY2hyb21hLAorCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVCeXRlc1BlclJvd0x1
bWEsCisJCXVuc2lnbmVkIGludCBQaXhlbFBURUJ5dGVzUGVyUm93Q2hyb21hLAorCQl1bnNpZ25l
ZCBpbnQgZHB0ZV9yb3dfaGVpZ2h0X2x1bWEsCisJCXVuc2lnbmVkIGludCBkcHRlX3Jvd19oZWln
aHRfY2hyb21hLAorCQlkb3VibGUgKm1ldGFfcm93X2J3LAorCQlkb3VibGUgKmRwdGVfcm93X2J3
KQoreworCWlmIChEQ0NFbmFibGUgIT0gdHJ1ZSkgeworCQkqbWV0YV9yb3dfYncgPSAwOworCX0g
ZWxzZSBpZiAoU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDIwXzggfHwgU291cmNlUGl4ZWxGb3Jt
YXQgPT0gZG1fNDIwXzEwKSB7CisJCSptZXRhX3Jvd19idyA9IFZSYXRpbyAqIE1ldGFSb3dCeXRl
THVtYSAvIChtZXRhX3Jvd19oZWlnaHRfbHVtYSAqIExpbmVUaW1lKQorCQkJCSsgVlJhdGlvIC8g
MiAqIE1ldGFSb3dCeXRlQ2hyb21hCisJCQkJCQkvIChtZXRhX3Jvd19oZWlnaHRfY2hyb21hICog
TGluZVRpbWUpOworCX0gZWxzZSB7CisJCSptZXRhX3Jvd19idyA9IFZSYXRpbyAqIE1ldGFSb3dC
eXRlTHVtYSAvIChtZXRhX3Jvd19oZWlnaHRfbHVtYSAqIExpbmVUaW1lKTsKKwl9CisKKwlpZiAo
R1BVVk1FbmFibGUgIT0gdHJ1ZSkgeworCQkqZHB0ZV9yb3dfYncgPSAwOworCX0gZWxzZSBpZiAo
U291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDIwXzggfHwgU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1f
NDIwXzEwKSB7CisJCSpkcHRlX3Jvd19idyA9IFZSYXRpbyAqIFBpeGVsUFRFQnl0ZXNQZXJSb3dM
dW1hIC8gKGRwdGVfcm93X2hlaWdodF9sdW1hICogTGluZVRpbWUpCisJCQkJKyBWUmF0aW8gLyAy
ICogUGl4ZWxQVEVCeXRlc1BlclJvd0Nocm9tYQorCQkJCQkJLyAoZHB0ZV9yb3dfaGVpZ2h0X2No
cm9tYSAqIExpbmVUaW1lKTsKKwl9IGVsc2UgeworCQkqZHB0ZV9yb3dfYncgPSBWUmF0aW8gKiBQ
aXhlbFBURUJ5dGVzUGVyUm93THVtYSAvIChkcHRlX3Jvd19oZWlnaHRfbHVtYSAqIExpbmVUaW1l
KTsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIENhbGN1bGF0ZUZsaXBTY2hlZHVsZSgKKwkJc3RydWN0
IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgUGVyY2VudE9mSWRlYWxEUkFN
RmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRlclVyZ0xhdGVuY3lQaXhlbE1peGVkV2l0aFZN
RGF0YSwKKwkJZG91YmxlIFBlcmNlbnRPZklkZWFsRFJBTUZhYnJpY0FuZFNEUFBvcnRCV1JlY2Vp
dmVkQWZ0ZXJVcmdMYXRlbmN5Vk1EYXRhT25seSwKKwkJZG91YmxlIFVyZ2VudEV4dHJhTGF0ZW5j
eSwKKwkJZG91YmxlIFVyZ2VudExhdGVuY3ksCisJCXVuc2lnbmVkIGludCBHUFVWTU1heFBhZ2VU
YWJsZUxldmVscywKKwkJYm9vbCBIb3N0Vk1FbmFibGUsCisJCXVuc2lnbmVkIGludCBIb3N0Vk1N
YXhQYWdlVGFibGVMZXZlbHMsCisJCXVuc2lnbmVkIGludCBIb3N0Vk1DYWNoZWRQYWdlVGFibGVM
ZXZlbHMsCisJCWJvb2wgR1BVVk1FbmFibGUsCisJCWRvdWJsZSBQREVBbmRNZXRhUFRFQnl0ZXNQ
ZXJGcmFtZSwKKwkJZG91YmxlIE1ldGFSb3dCeXRlcywKKwkJZG91YmxlIERQVEVCeXRlc1BlclJv
dywKKwkJZG91YmxlIEJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAsCisJCXVuc2ln
bmVkIGludCBUb3RJbW1lZGlhdGVGbGlwQnl0ZXMsCisJCWVudW0gc291cmNlX2Zvcm1hdF9jbGFz
cyBTb3VyY2VQaXhlbEZvcm1hdCwKKwkJZG91YmxlIExpbmVUaW1lLAorCQlkb3VibGUgVlJhdGlv
LAorCQlkb3VibGUgVG5vX2J3LAorCQlib29sIERDQ0VuYWJsZSwKKwkJdW5zaWduZWQgaW50IGRw
dGVfcm93X2hlaWdodCwKKwkJdW5zaWduZWQgaW50IG1ldGFfcm93X2hlaWdodCwKKwkJdW5zaWdu
ZWQgaW50IGRwdGVfcm93X2hlaWdodF9jaHJvbWEsCisJCXVuc2lnbmVkIGludCBtZXRhX3Jvd19o
ZWlnaHRfY2hyb21hLAorCQlkb3VibGUgKkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluSW1t
ZWRpYXRlRmxpcCwKKwkJZG91YmxlICpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5JbW1l
ZGlhdGVGbGlwLAorCQlkb3VibGUgKmZpbmFsX2ZsaXBfYncsCisJCWJvb2wgKkltbWVkaWF0ZUZs
aXBTdXBwb3J0ZWRGb3JQaXBlKQoreworCWRvdWJsZSBtaW5fcm93X3RpbWUgPSAwLjA7CisJdW5z
aWduZWQgaW50IEhvc3RWTUR5bmFtaWNMZXZlbHM7CisJZG91YmxlIFRpbWVGb3JGZXRjaGluZ01l
dGFQVEVJbW1lZGlhdGVGbGlwOworCWRvdWJsZSBUaW1lRm9yRmV0Y2hpbmdSb3dJblZCbGFua0lt
bWVkaWF0ZUZsaXA7CisJZG91YmxlIEltbWVkaWF0ZUZsaXBCVzsKKwlkb3VibGUgSG9zdFZNSW5l
ZmZpY2llbmN5RmFjdG9yOworCisJaWYgKEdQVVZNRW5hYmxlID09IHRydWUgJiYgSG9zdFZNRW5h
YmxlID09IHRydWUpIHsKKwkJSG9zdFZNSW5lZmZpY2llbmN5RmFjdG9yID0KKwkJCQlQZXJjZW50
T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQb3J0QldSZWNlaXZlZEFmdGVyVXJnTGF0ZW5jeVBpeGVs
TWl4ZWRXaXRoVk1EYXRhCisJCQkJCQkvIFBlcmNlbnRPZklkZWFsRFJBTUZhYnJpY0FuZFNEUFBv
cnRCV1JlY2VpdmVkQWZ0ZXJVcmdMYXRlbmN5Vk1EYXRhT25seTsKKwkJSG9zdFZNRHluYW1pY0xl
dmVscyA9IEhvc3RWTU1heFBhZ2VUYWJsZUxldmVscyAtIEhvc3RWTUNhY2hlZFBhZ2VUYWJsZUxl
dmVsczsKKwl9IGVsc2UgeworCQlIb3N0Vk1JbmVmZmljaWVuY3lGYWN0b3IgPSAxOworCQlIb3N0
Vk1EeW5hbWljTGV2ZWxzID0gMDsKKwl9CisKKwlJbW1lZGlhdGVGbGlwQlcgPSAoUERFQW5kTWV0
YVBURUJ5dGVzUGVyRnJhbWUgKyBNZXRhUm93Qnl0ZXMgKyBEUFRFQnl0ZXNQZXJSb3cpCisJCQkq
IEJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAgLyBUb3RJbW1lZGlhdGVGbGlwQnl0
ZXM7CisKKwlpZiAoR1BVVk1FbmFibGUgPT0gdHJ1ZSkgeworCQlUaW1lRm9yRmV0Y2hpbmdNZXRh
UFRFSW1tZWRpYXRlRmxpcCA9IGRtbF9tYXgzKAorCQkJVG5vX2J3ICsgUERFQW5kTWV0YVBURUJ5
dGVzUGVyRnJhbWUgKiBIb3N0Vk1JbmVmZmljaWVuY3lGYWN0b3IgLyBJbW1lZGlhdGVGbGlwQlcs
CisJCQlVcmdlbnRFeHRyYUxhdGVuY3kgKyBVcmdlbnRMYXRlbmN5ICogKEdQVVZNTWF4UGFnZVRh
YmxlTGV2ZWxzICogKEhvc3RWTUR5bmFtaWNMZXZlbHMgKyAxKSAtIDEpLAorCQkJTGluZVRpbWUg
LyA0LjApOworCX0gZWxzZSB7CisJCVRpbWVGb3JGZXRjaGluZ01ldGFQVEVJbW1lZGlhdGVGbGlw
ID0gMDsKKwl9CisKKwkqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5JbW1lZGlhdGVGbGlw
ID0gZG1sX2NlaWwoNC4wICogKFRpbWVGb3JGZXRjaGluZ01ldGFQVEVJbW1lZGlhdGVGbGlwIC8g
TGluZVRpbWUpLCAxKSAvIDQuMDsKKwlpZiAoKEdQVVZNRW5hYmxlID09IHRydWUgfHwgRENDRW5h
YmxlID09IHRydWUpKSB7CisJCVRpbWVGb3JGZXRjaGluZ1Jvd0luVkJsYW5rSW1tZWRpYXRlRmxp
cCA9IGRtbF9tYXgzKChNZXRhUm93Qnl0ZXMgKyBEUFRFQnl0ZXNQZXJSb3cpICogSG9zdFZNSW5l
ZmZpY2llbmN5RmFjdG9yIC8gSW1tZWRpYXRlRmxpcEJXLCBVcmdlbnRMYXRlbmN5ICogKEhvc3RW
TUR5bmFtaWNMZXZlbHMgKyAxKSwgTGluZVRpbWUgLyA0KTsKKwl9IGVsc2UgeworCQlUaW1lRm9y
RmV0Y2hpbmdSb3dJblZCbGFua0ltbWVkaWF0ZUZsaXAgPSAwOworCX0KKworCSpEZXN0aW5hdGlv
bkxpbmVzVG9SZXF1ZXN0Um93SW5JbW1lZGlhdGVGbGlwID0gZG1sX2NlaWwoNC4wICogKFRpbWVG
b3JGZXRjaGluZ1Jvd0luVkJsYW5rSW1tZWRpYXRlRmxpcCAvIExpbmVUaW1lKSwgMSkgLyA0LjA7
CisJKmZpbmFsX2ZsaXBfYncgPSBkbWxfbWF4KFBERUFuZE1ldGFQVEVCeXRlc1BlckZyYW1lICog
SG9zdFZNSW5lZmZpY2llbmN5RmFjdG9yIC8gKCpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1J
bkltbWVkaWF0ZUZsaXAgKiBMaW5lVGltZSksIChNZXRhUm93Qnl0ZXMgKyBEUFRFQnl0ZXNQZXJS
b3cpICogSG9zdFZNSW5lZmZpY2llbmN5RmFjdG9yIC8gKCpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1
ZXN0Um93SW5JbW1lZGlhdGVGbGlwICogTGluZVRpbWUpKTsKKwlpZiAoU291cmNlUGl4ZWxGb3Jt
YXQgPT0gZG1fNDIwXzggfHwgU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDIwXzEwKSB7CisJCWlm
IChHUFVWTUVuYWJsZSA9PSB0cnVlICYmIERDQ0VuYWJsZSAhPSB0cnVlKSB7CisJCQltaW5fcm93
X3RpbWUgPSBkbWxfbWluKAorCQkJCQlkcHRlX3Jvd19oZWlnaHQgKiBMaW5lVGltZSAvIFZSYXRp
bywKKwkJCQkJZHB0ZV9yb3dfaGVpZ2h0X2Nocm9tYSAqIExpbmVUaW1lIC8gKFZSYXRpbyAvIDIp
KTsKKwkJfSBlbHNlIGlmIChHUFVWTUVuYWJsZSAhPSB0cnVlICYmIERDQ0VuYWJsZSA9PSB0cnVl
KSB7CisJCQltaW5fcm93X3RpbWUgPSBkbWxfbWluKAorCQkJCQltZXRhX3Jvd19oZWlnaHQgKiBM
aW5lVGltZSAvIFZSYXRpbywKKwkJCQkJbWV0YV9yb3dfaGVpZ2h0X2Nocm9tYSAqIExpbmVUaW1l
IC8gKFZSYXRpbyAvIDIpKTsKKwkJfSBlbHNlIHsKKwkJCW1pbl9yb3dfdGltZSA9IGRtbF9taW40
KAorCQkJCQlkcHRlX3Jvd19oZWlnaHQgKiBMaW5lVGltZSAvIFZSYXRpbywKKwkJCQkJbWV0YV9y
b3dfaGVpZ2h0ICogTGluZVRpbWUgLyBWUmF0aW8sCisJCQkJCWRwdGVfcm93X2hlaWdodF9jaHJv
bWEgKiBMaW5lVGltZSAvIChWUmF0aW8gLyAyKSwKKwkJCQkJbWV0YV9yb3dfaGVpZ2h0X2Nocm9t
YSAqIExpbmVUaW1lIC8gKFZSYXRpbyAvIDIpKTsKKwkJfQorCX0gZWxzZSB7CisJCWlmIChHUFVW
TUVuYWJsZSA9PSB0cnVlICYmIERDQ0VuYWJsZSAhPSB0cnVlKSB7CisJCQltaW5fcm93X3RpbWUg
PSBkcHRlX3Jvd19oZWlnaHQgKiBMaW5lVGltZSAvIFZSYXRpbzsKKwkJfSBlbHNlIGlmIChHUFVW
TUVuYWJsZSAhPSB0cnVlICYmIERDQ0VuYWJsZSA9PSB0cnVlKSB7CisJCQltaW5fcm93X3RpbWUg
PSBtZXRhX3Jvd19oZWlnaHQgKiBMaW5lVGltZSAvIFZSYXRpbzsKKwkJfSBlbHNlIHsKKwkJCW1p
bl9yb3dfdGltZSA9IGRtbF9taW4oCisJCQkJCWRwdGVfcm93X2hlaWdodCAqIExpbmVUaW1lIC8g
VlJhdGlvLAorCQkJCQltZXRhX3Jvd19oZWlnaHQgKiBMaW5lVGltZSAvIFZSYXRpbyk7CisJCX0K
Kwl9CisKKwlpZiAoKkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluSW1tZWRpYXRlRmxpcCA+
PSAzMgorCQkJfHwgKkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJbkltbWVkaWF0ZUZsaXAg
Pj0gMTYKKwkJCXx8IFRpbWVGb3JGZXRjaGluZ01ldGFQVEVJbW1lZGlhdGVGbGlwICsgMiAqIFRp
bWVGb3JGZXRjaGluZ1Jvd0luVkJsYW5rSW1tZWRpYXRlRmxpcCA+IG1pbl9yb3dfdGltZSkgewor
CQkqSW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclBpcGUgPSBmYWxzZTsKKwl9IGVsc2UgeworCQkq
SW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclBpcGUgPSB0cnVlOworCX0KK30KKworc3RhdGljIHVu
c2lnbmVkIGludCBUcnVuY1RvVmFsaWRCUFAoCisJCWRvdWJsZSBEZWNpbWFsQlBQLAorCQlkb3Vi
bGUgRGVzaXJlZEJQUCwKKwkJYm9vbCBEU0NFbmFibGVkLAorCQllbnVtIG91dHB1dF9lbmNvZGVy
X2NsYXNzIE91dHB1dCwKKwkJZW51bSBvdXRwdXRfZm9ybWF0X2NsYXNzIEZvcm1hdCwKKwkJdW5z
aWduZWQgaW50IERTQ0lucHV0Qml0UGVyQ29tcG9uZW50KQoreworCWlmIChPdXRwdXQgPT0gZG1f
aGRtaSkgeworCQlpZiAoRm9ybWF0ID09IGRtXzQyMCkgeworCQkJaWYgKERlY2ltYWxCUFAgPj0g
MTggJiYgKERlc2lyZWRCUFAgPT0gMCB8fCBEZXNpcmVkQlBQID09IDE4KSkKKwkJCQlyZXR1cm4g
MTg7CisJCQllbHNlIGlmIChEZWNpbWFsQlBQID49IDE1ICYmIChEZXNpcmVkQlBQID09IDAgfHwg
RGVzaXJlZEJQUCA9PSAxNSkpCisJCQkJcmV0dXJuIDE1OworCQkJZWxzZSBpZiAoRGVjaW1hbEJQ
UCA+PSAxMiAmJiAoRGVzaXJlZEJQUCA9PSAwIHx8IERlc2lyZWRCUFAgPT0gMTIpKQorCQkJCXJl
dHVybiAxMjsKKwkJCWVsc2UKKwkJCQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCX0gZWxzZSBpZiAo
Rm9ybWF0ID09IGRtXzQ0NCkgeworCQkJaWYgKERlY2ltYWxCUFAgPj0gMzYgJiYgKERlc2lyZWRC
UFAgPT0gMCB8fCBEZXNpcmVkQlBQID09IDM2KSkKKwkJCQlyZXR1cm4gMzY7CisJCQllbHNlIGlm
IChEZWNpbWFsQlBQID49IDMwICYmIChEZXNpcmVkQlBQID09IDAgfHwgRGVzaXJlZEJQUCA9PSAz
MCkpCisJCQkJcmV0dXJuIDMwOworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAyNCAmJiAoRGVz
aXJlZEJQUCA9PSAwIHx8IERlc2lyZWRCUFAgPT0gMjQpKQorCQkJCXJldHVybiAyNDsKKwkJCWVs
c2UgaWYgKERlY2ltYWxCUFAgPj0gMTggJiYgKERlc2lyZWRCUFAgPT0gMCB8fCBEZXNpcmVkQlBQ
ID09IDE4KSkKKwkJCQlyZXR1cm4gMTg7CisJCQllbHNlCisJCQkJcmV0dXJuIEJQUF9JTlZBTElE
OworCQl9IGVsc2UgeworCQkJaWYgKERlY2ltYWxCUFAgLyAxLjUgPj0gMjQgJiYgKERlc2lyZWRC
UFAgPT0gMCB8fCBEZXNpcmVkQlBQID09IDI0KSkKKwkJCQlyZXR1cm4gMjQ7CisJCQllbHNlIGlm
IChEZWNpbWFsQlBQIC8gMS41ID49IDIwICYmIChEZXNpcmVkQlBQID09IDAgfHwgRGVzaXJlZEJQ
UCA9PSAyMCkpCisJCQkJcmV0dXJuIDIwOworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCAvIDEuNSA+
PSAxNiAmJiAoRGVzaXJlZEJQUCA9PSAwIHx8IERlc2lyZWRCUFAgPT0gMTYpKQorCQkJCXJldHVy
biAxNjsKKwkJCWVsc2UKKwkJCQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCX0KKwl9IGVsc2Ugewor
CQlpZiAoRFNDRW5hYmxlZCkgeworCQkJaWYgKEZvcm1hdCA9PSBkbV80MjApIHsKKwkJCQlpZiAo
RGVzaXJlZEJQUCA9PSAwKSB7CisJCQkJCWlmIChEZWNpbWFsQlBQIDwgNikKKwkJCQkJCXJldHVy
biBCUFBfSU5WQUxJRDsKKwkJCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAxLjUgKiBEU0NJbnB1
dEJpdFBlckNvbXBvbmVudCAtIDEuMCAvIDE2LjApCisJCQkJCQlyZXR1cm4gMS41ICogRFNDSW5w
dXRCaXRQZXJDb21wb25lbnQgLSAxLjAgLyAxNi4wOworCQkJCQllbHNlCisJCQkJCQlyZXR1cm4g
ZG1sX2Zsb29yKDE2ICogRGVjaW1hbEJQUCwgMSkgLyAxNi4wOworCQkJCX0gZWxzZSB7CisJCQkJ
CWlmIChEZWNpbWFsQlBQIDwgNgorCQkJCQkJCXx8IERlc2lyZWRCUFAgPCA2CisJCQkJCQkJfHwg
RGVzaXJlZEJQUCA+IDEuNSAqIERTQ0lucHV0Qml0UGVyQ29tcG9uZW50IC0gMS4wIC8gMTYuMAor
CQkJCQkJCXx8IERlY2ltYWxCUFAgPCBEZXNpcmVkQlBQKSB7CisJCQkJCQlyZXR1cm4gQlBQX0lO
VkFMSUQ7CisJCQkJCX0gZWxzZSB7CisJCQkJCQlyZXR1cm4gRGVzaXJlZEJQUDsKKwkJCQkJfQor
CQkJCX0KKwkJCX0gZWxzZSBpZiAoRm9ybWF0ID09IGRtX240MjIpIHsKKwkJCQlpZiAoRGVzaXJl
ZEJQUCA9PSAwKSB7CisJCQkJCWlmIChEZWNpbWFsQlBQIDwgNykKKwkJCQkJCXJldHVybiBCUFBf
SU5WQUxJRDsKKwkJCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAyICogRFNDSW5wdXRCaXRQZXJD
b21wb25lbnQgLSAxLjAgLyAxNi4wKQorCQkJCQkJcmV0dXJuIDIgKiBEU0NJbnB1dEJpdFBlckNv
bXBvbmVudCAtIDEuMCAvIDE2LjA7CisJCQkJCWVsc2UKKwkJCQkJCXJldHVybiBkbWxfZmxvb3Io
MTYgKiBEZWNpbWFsQlBQLCAxKSAvIDE2LjA7CisJCQkJfSBlbHNlIHsKKwkJCQkJaWYgKERlY2lt
YWxCUFAgPCA3CisJCQkJCQkJfHwgRGVzaXJlZEJQUCA8IDcKKwkJCQkJCQl8fCBEZXNpcmVkQlBQ
ID4gMiAqIERTQ0lucHV0Qml0UGVyQ29tcG9uZW50IC0gMS4wIC8gMTYuMAorCQkJCQkJCXx8IERl
Y2ltYWxCUFAgPCBEZXNpcmVkQlBQKSB7CisJCQkJCQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCQkJ
CX0gZWxzZSB7CisJCQkJCQlyZXR1cm4gRGVzaXJlZEJQUDsKKwkJCQkJfQorCQkJCX0KKwkJCX0g
ZWxzZSB7CisJCQkJaWYgKERlc2lyZWRCUFAgPT0gMCkgeworCQkJCQlpZiAoRGVjaW1hbEJQUCA8
IDgpCisJCQkJCQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCQkJCWVsc2UgaWYgKERlY2ltYWxCUFAg
Pj0gMyAqIERTQ0lucHV0Qml0UGVyQ29tcG9uZW50IC0gMS4wIC8gMTYuMCkKKwkJCQkJCXJldHVy
biAzICogRFNDSW5wdXRCaXRQZXJDb21wb25lbnQgLSAxLjAgLyAxNi4wOworCQkJCQllbHNlCisJ
CQkJCQlyZXR1cm4gZG1sX2Zsb29yKDE2ICogRGVjaW1hbEJQUCwgMSkgLyAxNi4wOworCQkJCX0g
ZWxzZSB7CisJCQkJCWlmIChEZWNpbWFsQlBQIDwgOAorCQkJCQkJCXx8IERlc2lyZWRCUFAgPCA4
CisJCQkJCQkJfHwgRGVzaXJlZEJQUCA+IDMgKiBEU0NJbnB1dEJpdFBlckNvbXBvbmVudCAtIDEu
MCAvIDE2LjAKKwkJCQkJCQl8fCBEZWNpbWFsQlBQIDwgRGVzaXJlZEJQUCkgeworCQkJCQkJcmV0
dXJuIEJQUF9JTlZBTElEOworCQkJCQl9IGVsc2UgeworCQkJCQkJcmV0dXJuIERlc2lyZWRCUFA7
CisJCQkJCX0KKwkJCQl9CisJCQl9CisJCX0gZWxzZSBpZiAoRm9ybWF0ID09IGRtXzQyMCkgewor
CQkJaWYgKERlY2ltYWxCUFAgPj0gMTggJiYgKERlc2lyZWRCUFAgPT0gMCB8fCBEZXNpcmVkQlBQ
ID09IDE4KSkKKwkJCQlyZXR1cm4gMTg7CisJCQllbHNlIGlmIChEZWNpbWFsQlBQID49IDE1ICYm
IChEZXNpcmVkQlBQID09IDAgfHwgRGVzaXJlZEJQUCA9PSAxNSkpCisJCQkJcmV0dXJuIDE1Owor
CQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAxMiAmJiAoRGVzaXJlZEJQUCA9PSAwIHx8IERlc2ly
ZWRCUFAgPT0gMTIpKQorCQkJCXJldHVybiAxMjsKKwkJCWVsc2UKKwkJCQlyZXR1cm4gQlBQX0lO
VkFMSUQ7CisJCX0gZWxzZSBpZiAoRm9ybWF0ID09IGRtX3M0MjIgfHwgRm9ybWF0ID09IGRtX240
MjIpIHsKKwkJCWlmIChEZWNpbWFsQlBQID49IDI0ICYmIChEZXNpcmVkQlBQID09IDAgfHwgRGVz
aXJlZEJQUCA9PSAyNCkpCisJCQkJcmV0dXJuIDI0OworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+
PSAyMCAmJiAoRGVzaXJlZEJQUCA9PSAwIHx8IERlc2lyZWRCUFAgPT0gMjApKQorCQkJCXJldHVy
biAyMDsKKwkJCWVsc2UgaWYgKERlY2ltYWxCUFAgPj0gMTYgJiYgKERlc2lyZWRCUFAgPT0gMCB8
fCBEZXNpcmVkQlBQID09IDE2KSkKKwkJCQlyZXR1cm4gMTY7CisJCQllbHNlCisJCQkJcmV0dXJu
IEJQUF9JTlZBTElEOworCQl9IGVsc2UgeworCQkJaWYgKERlY2ltYWxCUFAgPj0gMzYgJiYgKERl
c2lyZWRCUFAgPT0gMCB8fCBEZXNpcmVkQlBQID09IDM2KSkKKwkJCQlyZXR1cm4gMzY7CisJCQll
bHNlIGlmIChEZWNpbWFsQlBQID49IDMwICYmIChEZXNpcmVkQlBQID09IDAgfHwgRGVzaXJlZEJQ
UCA9PSAzMCkpCisJCQkJcmV0dXJuIDMwOworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAyNCAm
JiAoRGVzaXJlZEJQUCA9PSAwIHx8IERlc2lyZWRCUFAgPT0gMjQpKQorCQkJCXJldHVybiAyNDsK
KwkJCWVsc2UKKwkJCQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCX0KKwl9Cit9CisKK3ZvaWQgZG1s
MjFfTW9kZVN1cHBvcnRBbmRTeXN0ZW1Db25maWd1cmF0aW9uRnVsbChzdHJ1Y3QgZGlzcGxheV9t
b2RlX2xpYiAqbW9kZV9saWIpCit7CisJc3RydWN0IHZiYV92YXJzX3N0ICpsb2NhbHMgPSAmbW9k
ZV9saWItPnZiYTsKKworCWludCBpOworCXVuc2lnbmVkIGludCBqLCBrLCBtOworCisJLypNT0RF
IFNVUFBPUlQsIFZPTFRBR0UgU1RBVEUgQU5EIFNPQyBDT05GSUdVUkFUSU9OKi8KKworCS8qU2Nh
bGUgUmF0aW8sIHRhcHMgU3VwcG9ydCBDaGVjayovCisKKwltb2RlX2xpYi0+dmJhLlNjYWxlUmF0
aW9BbmRUYXBzU3VwcG9ydCA9IHRydWU7CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLlNj
YWxlckVuYWJsZWRba10gPT0gZmFsc2UKKwkJCQkmJiAoKG1vZGVfbGliLT52YmEuU291cmNlUGl4
ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzY0CisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBp
eGVsRm9ybWF0W2tdICE9IGRtXzQ0NF8zMgorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQ
aXhlbEZvcm1hdFtrXSAhPSBkbV80NDRfMTYKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNl
UGl4ZWxGb3JtYXRba10gIT0gZG1fbW9ub18xNgorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3Vy
Y2VQaXhlbEZvcm1hdFtrXSAhPSBkbV9tb25vXzgpCisJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLkhS
YXRpb1trXSAhPSAxLjAKKwkJCQkJCXx8IG1vZGVfbGliLT52YmEuaHRhcHNba10gIT0gMS4wCisJ
CQkJCQl8fCBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSAhPSAxLjAKKwkJCQkJCXx8IG1vZGVfbGli
LT52YmEudnRhcHNba10gIT0gMS4wKSkgeworCQkJbW9kZV9saWItPnZiYS5TY2FsZVJhdGlvQW5k
VGFwc1N1cHBvcnQgPSBmYWxzZTsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLnZ0YXBzW2td
IDwgMS4wIHx8IG1vZGVfbGliLT52YmEudnRhcHNba10gPiA4LjAKKwkJCQl8fCBtb2RlX2xpYi0+
dmJhLmh0YXBzW2tdIDwgMS4wIHx8IG1vZGVfbGliLT52YmEuaHRhcHNba10gPiA4LjAKKwkJCQl8
fCAobW9kZV9saWItPnZiYS5odGFwc1trXSA+IDEuMAorCQkJCQkJJiYgKG1vZGVfbGliLT52YmEu
aHRhcHNba10gJSAyKSA9PSAxKQorCQkJCXx8IG1vZGVfbGliLT52YmEuSFJhdGlvW2tdID4gbW9k
ZV9saWItPnZiYS5NYXhIU0NMUmF0aW8KKwkJCQl8fCBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSA+
IG1vZGVfbGliLT52YmEuTWF4VlNDTFJhdGlvCisJCQkJfHwgbW9kZV9saWItPnZiYS5IUmF0aW9b
a10gPiBtb2RlX2xpYi0+dmJhLmh0YXBzW2tdCisJCQkJfHwgbW9kZV9saWItPnZiYS5WUmF0aW9b
a10gPiBtb2RlX2xpYi0+dmJhLnZ0YXBzW2tdCisJCQkJfHwgKG1vZGVfbGliLT52YmEuU291cmNl
UGl4ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzY0CisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJj
ZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQ0NF8zMgorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3Vy
Y2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80NDRfMTYKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291
cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fbW9ub18xNgorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5T
b3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV9tb25vXzgKKwkJCQkJCSYmIChtb2RlX2xpYi0+dmJh
LkhSYXRpb1trXSAvIDIuMAorCQkJCQkJCQk+IG1vZGVfbGliLT52YmEuSFRBUHNDaHJvbWFba10K
KwkJCQkJCQkJfHwgbW9kZV9saWItPnZiYS5WUmF0aW9ba10gLyAyLjAKKwkJCQkJCQkJCQk+IG1v
ZGVfbGliLT52YmEuVlRBUHNDaHJvbWFba10pKSkgeworCQkJbW9kZV9saWItPnZiYS5TY2FsZVJh
dGlvQW5kVGFwc1N1cHBvcnQgPSBmYWxzZTsKKwkJfQorCX0KKwkvKlNvdXJjZSBGb3JtYXQsIFBp
eGVsIEZvcm1hdCBhbmQgU2NhbiBTdXBwb3J0IENoZWNrKi8KKworCW1vZGVfbGliLT52YmEuU291
cmNlRm9ybWF0UGl4ZWxBbmRTY2FuU3VwcG9ydCA9IHRydWU7CisJZm9yIChrID0gMDsgayA8PSBt
b2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmICgobW9k
ZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdID09IGRtX3N3X2xpbmVhcgorCQkJCSYmIG1vZGVf
bGliLT52YmEuU291cmNlU2NhbltrXSAhPSBkbV9ob3J6KQorCQkJCXx8ICgobW9kZV9saWItPnZi
YS5TdXJmYWNlVGlsaW5nW2tdID09IGRtX3N3XzRrYl9kCisJCQkJCQl8fCBtb2RlX2xpYi0+dmJh
LlN1cmZhY2VUaWxpbmdba10gPT0gZG1fc3dfNGtiX2RfeAorCQkJCQkJfHwgbW9kZV9saWItPnZi
YS5TdXJmYWNlVGlsaW5nW2tdID09IGRtX3N3XzY0a2JfZAorCQkJCQkJfHwgbW9kZV9saWItPnZi
YS5TdXJmYWNlVGlsaW5nW2tdID09IGRtX3N3XzY0a2JfZF90CisJCQkJCQl8fCBtb2RlX2xpYi0+
dmJhLlN1cmZhY2VUaWxpbmdba10gPT0gZG1fc3dfNjRrYl9kX3gKKwkJCQkJCXx8IG1vZGVfbGli
LT52YmEuU3VyZmFjZVRpbGluZ1trXSA9PSBkbV9zd192YXJfZAorCQkJCQkJfHwgbW9kZV9saWIt
PnZiYS5TdXJmYWNlVGlsaW5nW2tdID09IGRtX3N3X3Zhcl9kX3gpCisJCQkJCQkmJiBtb2RlX2xp
Yi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQ0NF82NCkKKwkJCQl8fCAobW9kZV9s
aWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdID09IGRtX3N3XzY0a2Jfcl94CisJCQkJCQkmJiAobW9k
ZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV9tb25vXzgKKwkJCQkJCQkJfHwg
bW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXQorCQkJCQkJCQkJCT09IGRtXzQyMF84
CisJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10KKwkJCQkJCQkJ
CQk9PSBkbV80MjBfMTApKQorCQkJCXx8ICgoKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1tr
XSA9PSBkbV9zd19nZng3XzJkX3RoaW5fZ2wKKwkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFj
ZVRpbGluZ1trXQorCQkJCQkJCQk9PSBkbV9zd19nZng3XzJkX3RoaW5fbHZwKQorCQkJCQkJJiYg
ISgobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXQorCQkJCQkJCQk9PSBkbV80NDRf
NjQKKwkJCQkJCQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXQorCQkJCQkJ
CQkJCT09IGRtXzQ0NF8zMikKKwkJCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2td
CisJCQkJCQkJCQkJPT0gZG1faG9yegorCQkJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlN1cHBvcnRH
Rlg3Q29tcGF0aWJsZVRpbGluZ0luMzJicHBBbmQ2NGJwcAorCQkJCQkJCQkJCT09IHRydWUKKwkJ
CQkJCQkJJiYgbW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10KKwkJCQkJCQkJCQk9PSBmYWxzZSkp
CisJCQkJCQl8fCAobW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10gPT0gdHJ1ZQorCQkJCQkJCQkm
JiAobW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJPT0gZG1fc3dfbGlu
ZWFyCisJCQkJCQkJCQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXQorCQkJ
CQkJCQkJCQkJPT0gZG1fNDIwXzgKKwkJCQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBp
eGVsRm9ybWF0W2tdCisJCQkJCQkJCQkJCQk9PSBkbV80MjBfMTApKSkpIHsKKwkJCW1vZGVfbGli
LT52YmEuU291cmNlRm9ybWF0UGl4ZWxBbmRTY2FuU3VwcG9ydCA9IGZhbHNlOworCQl9CisJfQor
CS8qQmFuZHdpZHRoIFN1cHBvcnQgQ2hlY2sqLworCisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xp
Yi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmIChtb2RlX2xpYi0+
dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF82NCkgeworCQkJbG9jYWxzLT5CeXRl
UGVyUGl4ZWxJbkRFVFlba10gPSA4LjA7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1tr
XSA9IDAuMDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2td
ID09IGRtXzQ0NF8zMikgeworCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10gPSA0LjA7
CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSA9IDAuMDsKKwkJfSBlbHNlIGlmICht
b2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF8xNgorCQkJCXx8IG1v
ZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fbW9ub18xNikgeworCQkJbG9j
YWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10gPSAyLjA7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhl
bEluREVUQ1trXSA9IDAuMDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVs
Rm9ybWF0W2tdID09IGRtX21vbm9fOCkgeworCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlb
a10gPSAxLjA7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSA9IDAuMDsKKwkJfSBl
bHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQyMF84KSB7
CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSA9IDEuMDsKKwkJCWxvY2Fscy0+Qnl0
ZVBlclBpeGVsSW5ERVRDW2tdID0gMi4wOworCQl9IGVsc2UgeworCQkJbG9jYWxzLT5CeXRlUGVy
UGl4ZWxJbkRFVFlba10gPSA0LjAgLyAzOworCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVENb
a10gPSA4LjAgLyAzOworCQl9CisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gPT0g
ZG1faG9yeikgeworCQkJbG9jYWxzLT5Td2F0aFdpZHRoWVNpbmdsZURQUFtrXSA9IG1vZGVfbGli
LT52YmEuVmlld3BvcnRXaWR0aFtrXTsKKwkJfSBlbHNlIHsKKwkJCWxvY2Fscy0+U3dhdGhXaWR0
aFlTaW5nbGVEUFBba10gPSBtb2RlX2xpYi0+dmJhLlZpZXdwb3J0SGVpZ2h0W2tdOworCQl9CisJ
fQorCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAt
IDE7IGsrKykgeworCQlsb2NhbHMtPlJlYWRCYW5kd2lkdGhMdW1hW2tdID0gbG9jYWxzLT5Td2F0
aFdpZHRoWVNpbmdsZURQUFtrXSAqIGRtbF9jZWlsKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZ
W2tdLCAxLjApCisJCQkJLyAobW9kZV9saWItPnZiYS5IVG90YWxba10gLyBtb2RlX2xpYi0+dmJh
LlBpeGVsQ2xvY2tba10pICogbW9kZV9saWItPnZiYS5WUmF0aW9ba107CisJCWxvY2Fscy0+UmVh
ZEJhbmR3aWR0aENocm9tYVtrXSA9IGxvY2Fscy0+U3dhdGhXaWR0aFlTaW5nbGVEUFBba10gLyAy
ICogZG1sX2NlaWwobG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVENba10sIDIuMCkKKwkJCQkvICht
b2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkgKiBt
b2RlX2xpYi0+dmJhLlZSYXRpb1trXSAvIDIuMDsKKwkJbG9jYWxzLT5SZWFkQmFuZHdpZHRoW2td
ID0gbG9jYWxzLT5SZWFkQmFuZHdpZHRoTHVtYVtrXSArIGxvY2Fscy0+UmVhZEJhbmR3aWR0aENo
cm9tYVtrXTsKKwl9CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0
aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJs
ZVtrXSA9PSB0cnVlCisJCQkJJiYgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtr
XSA9PSBkbV80NDRfMzIpIHsKKwkJCWxvY2Fscy0+V3JpdGVCYW5kd2lkdGhba10gPSBtb2RlX2xp
Yi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJKiBtb2RlX2xpYi0+dmJh
LldyaXRlYmFja0Rlc3RpbmF0aW9uSGVpZ2h0W2tdCisJCQkJCS8gKG1vZGVfbGliLT52YmEuV3Jp
dGViYWNrU291cmNlSGVpZ2h0W2tdCisJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQor
CQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKSAqIDQuMDsKKwkJfSBlbHNlIGlm
IChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9PSB0cnVlCisJCQkJJiYgbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfMTApIHsKKwkJCWxvY2Fs
cy0+V3JpdGVCYW5kd2lkdGhba10gPSBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9u
V2lkdGhba10KKwkJCQkJKiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uSGVpZ2h0
W2tdCisJCQkJCS8gKG1vZGVfbGliLT52YmEuV3JpdGViYWNrU291cmNlSGVpZ2h0W2tdCisJCQkJ
CQkJKiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhl
bENsb2NrW2tdKSAqIDMuMDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Vu
YWJsZVtrXSA9PSB0cnVlKSB7CisJCQlsb2NhbHMtPldyaXRlQmFuZHdpZHRoW2tdID0gbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoW2tdCisJCQkJCSogbW9kZV9saWItPnZi
YS5Xcml0ZWJhY2tEZXN0aW5hdGlvbkhlaWdodFtrXQorCQkJCQkvIChtb2RlX2xpYi0+dmJhLldy
aXRlYmFja1NvdXJjZUhlaWdodFtrXQorCQkJCQkJCSogbW9kZV9saWItPnZiYS5IVG90YWxba10K
KwkJCQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkgKiAxLjU7CisJCX0gZWxzZSB7
CisJCQlsb2NhbHMtPldyaXRlQmFuZHdpZHRoW2tdID0gMC4wOworCQl9CisJfQorCW1vZGVfbGli
LT52YmEuRENDRW5hYmxlZEluQW55UGxhbmUgPSBmYWxzZTsKKwlmb3IgKGsgPSAwOyBrIDw9IG1v
ZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVf
bGliLT52YmEuRENDRW5hYmxlW2tdID09IHRydWUpIHsKKwkJCW1vZGVfbGliLT52YmEuRENDRW5h
YmxlZEluQW55UGxhbmUgPSB0cnVlOworCQl9CisJfQorCWZvciAoaSA9IDA7IGkgPD0gbW9kZV9s
aWItPnZiYS5zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJCWxvY2Fscy0+SWRlYWxTRFBQb3J0QmFu
ZHdpZHRoUGVyU3RhdGVbaV0gPSBkbWxfbWluMygKKwkJCQltb2RlX2xpYi0+dmJhLlJldHVybkJ1
c1dpZHRoICogbW9kZV9saWItPnZiYS5EQ0ZDTEtQZXJTdGF0ZVtpXSwKKwkJCQltb2RlX2xpYi0+
dmJhLkRSQU1TcGVlZFBlclN0YXRlW2ldICogbW9kZV9saWItPnZiYS5OdW1iZXJPZkNoYW5uZWxz
CisJCQkJCQkqIG1vZGVfbGliLT52YmEuRFJBTUNoYW5uZWxXaWR0aCwKKwkJCQltb2RlX2xpYi0+
dmJhLkZhYnJpY0Nsb2NrUGVyU3RhdGVbaV0KKwkJCQkJCSogbW9kZV9saWItPnZiYS5GYWJyaWNE
YXRhcGF0aFRvRENORGF0YVJldHVybik7CisJCWlmIChtb2RlX2xpYi0+dmJhLkhvc3RWTUVuYWJs
ZSA9PSBmYWxzZSkgeworCQkJbG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldID0gbG9jYWxzLT5J
ZGVhbFNEUFBvcnRCYW5kd2lkdGhQZXJTdGF0ZVtpXQorCQkJCQkqIG1vZGVfbGliLT52YmEuUGVy
Y2VudE9mSWRlYWxEUkFNRmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRlclVyZ0xhdGVuY3lQ
aXhlbERhdGFPbmx5IC8gMTAwLjA7CisJCX0gZWxzZSB7CisJCQlsb2NhbHMtPlJldHVybkJXUGVy
U3RhdGVbaV0gPSBsb2NhbHMtPklkZWFsU0RQUG9ydEJhbmR3aWR0aFBlclN0YXRlW2ldCisJCQkJ
CSogbW9kZV9saWItPnZiYS5QZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQb3J0QldSZWNl
aXZlZEFmdGVyVXJnTGF0ZW5jeVBpeGVsTWl4ZWRXaXRoVk1EYXRhIC8gMTAwLjA7CisJCX0KKwl9
CisJLypXcml0ZWJhY2sgTGF0ZW5jeSBzdXBwb3J0IGNoZWNrKi8KKworCW1vZGVfbGliLT52YmEu
V3JpdGViYWNrTGF0ZW5jeVN1cHBvcnQgPSB0cnVlOworCWZvciAoayA9IDA7IGsgPD0gbW9kZV9s
aWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlpZiAobW9kZV9saWIt
PnZiYS5Xcml0ZWJhY2tFbmFibGVba10gPT0gdHJ1ZSkgeworCQkJaWYgKG1vZGVfbGliLT52YmEu
V3JpdGViYWNrUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzMyKSB7CisJCQkJaWYgKGxvY2Fscy0+
V3JpdGVCYW5kd2lkdGhba10KKwkJCQkJCT4gKG1vZGVfbGliLT52YmEuV3JpdGViYWNrSW50ZXJm
YWNlTHVtYUJ1ZmZlclNpemUKKwkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0ludGVy
ZmFjZUNocm9tYUJ1ZmZlclNpemUpCisJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tM
YXRlbmN5KSB7CisJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTGF0ZW5jeVN1cHBvcnQgPSBm
YWxzZTsKKwkJCQl9CisJCQl9IGVsc2UgeworCQkJCWlmIChsb2NhbHMtPldyaXRlQmFuZHdpZHRo
W2tdCisJCQkJCQk+IDEuNQorCQkJCQkJCQkqIGRtbF9taW4oCisJCQkJCQkJCQkJbW9kZV9saWIt
PnZiYS5Xcml0ZWJhY2tJbnRlcmZhY2VMdW1hQnVmZmVyU2l6ZSwKKwkJCQkJCQkJCQkyLjAKKwkJ
CQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tJbnRlcmZhY2VDaHJvbWFCdWZmZXJT
aXplKQorCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuV3JpdGViYWNrTGF0ZW5jeSkgeworCQkJCQlt
b2RlX2xpYi0+dmJhLldyaXRlYmFja0xhdGVuY3lTdXBwb3J0ID0gZmFsc2U7CisJCQkJfQorCQkJ
fQorCQl9CisJfQorCS8qUmUtb3JkZXJpbmcgQnVmZmVyIFN1cHBvcnQgQ2hlY2sqLworCisJZm9y
IChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJbG9j
YWxzLT5VcmdlbnRSb3VuZFRyaXBBbmRPdXRPZk9yZGVyTGF0ZW5jeVBlclN0YXRlW2ldID0KKwkJ
CQkobW9kZV9saWItPnZiYS5Sb3VuZFRyaXBQaW5nTGF0ZW5jeUN5Y2xlcyArIDMyLjApIC8gbW9k
ZV9saWItPnZiYS5EQ0ZDTEtQZXJTdGF0ZVtpXQorCQkJCSsgZG1sX21heDMobW9kZV9saWItPnZi
YS5VcmdlbnRPdXRPZk9yZGVyUmV0dXJuUGVyQ2hhbm5lbFBpeGVsRGF0YU9ubHksCisJCQkJCQlt
b2RlX2xpYi0+dmJhLlVyZ2VudE91dE9mT3JkZXJSZXR1cm5QZXJDaGFubmVsUGl4ZWxNaXhlZFdp
dGhWTURhdGEsCisJCQkJCQltb2RlX2xpYi0+dmJhLlVyZ2VudE91dE9mT3JkZXJSZXR1cm5QZXJD
aGFubmVsVk1EYXRhT25seSkKKwkJCQkJKiBtb2RlX2xpYi0+dmJhLk51bWJlck9mQ2hhbm5lbHMg
LyBsb2NhbHMtPlJldHVybkJXUGVyU3RhdGVbaV07CisJCWlmICgobW9kZV9saWItPnZiYS5ST0JC
dWZmZXJTaXplSW5LQnl0ZSAtIG1vZGVfbGliLT52YmEuUGl4ZWxDaHVua1NpemVJbktCeXRlKSAq
IDEwMjQuMCAvIGxvY2Fscy0+UmV0dXJuQldQZXJTdGF0ZVtpXQorCQkJCT4gbG9jYWxzLT5Vcmdl
bnRSb3VuZFRyaXBBbmRPdXRPZk9yZGVyTGF0ZW5jeVBlclN0YXRlW2ldKSB7CisJCQlsb2NhbHMt
PlJPQlN1cHBvcnRbaV0gPSB0cnVlOworCQl9IGVsc2UgeworCQkJbG9jYWxzLT5ST0JTdXBwb3J0
W2ldID0gZmFsc2U7CisJCX0KKwl9CisJLypXcml0ZWJhY2sgTW9kZSBTdXBwb3J0IENoZWNrKi8K
KworCW1vZGVfbGliLT52YmEuVG90YWxOdW1iZXJPZkFjdGl2ZVdyaXRlYmFjayA9IDA7CisJZm9y
IChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysr
KSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9PSB0cnVlKSB7CisJ
CQlpZiAobW9kZV9saWItPnZiYS5BY3RpdmVXcml0ZWJhY2tzUGVyUGxhbmVba10gPT0gMCkKKwkJ
CQltb2RlX2xpYi0+dmJhLkFjdGl2ZVdyaXRlYmFja3NQZXJQbGFuZVtrXSA9IDE7CisJCQltb2Rl
X2xpYi0+dmJhLlRvdGFsTnVtYmVyT2ZBY3RpdmVXcml0ZWJhY2sgPQorCQkJCQltb2RlX2xpYi0+
dmJhLlRvdGFsTnVtYmVyT2ZBY3RpdmVXcml0ZWJhY2sKKwkJCQkJCQkrIG1vZGVfbGliLT52YmEu
QWN0aXZlV3JpdGViYWNrc1BlclBsYW5lW2tdOworCQl9CisJfQorCW1vZGVfbGliLT52YmEuV3Jp
dGViYWNrTW9kZVN1cHBvcnQgPSB0cnVlOworCWlmIChtb2RlX2xpYi0+dmJhLlRvdGFsTnVtYmVy
T2ZBY3RpdmVXcml0ZWJhY2sgPiBtb2RlX2xpYi0+dmJhLk1heE51bVdyaXRlYmFjaykgeworCQlt
b2RlX2xpYi0+dmJhLldyaXRlYmFja01vZGVTdXBwb3J0ID0gZmFsc2U7CisJfQorCWZvciAoayA9
IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgewor
CQlpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tFbmFibGVba10gPT0gdHJ1ZQorCQkJCSYmIG1v
ZGVfbGliLT52YmEuV3JpdGViYWNrMTBicGM0MjBTdXBwb3J0ZWQgIT0gdHJ1ZQorCQkJCSYmIG1v
ZGVfbGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRba10gPT0gZG1fNDIwXzEwKSB7CisJCQlt
b2RlX2xpYi0+dmJhLldyaXRlYmFja01vZGVTdXBwb3J0ID0gZmFsc2U7CisJCX0KKwl9CisJLypX
cml0ZWJhY2sgU2NhbGUgUmF0aW8gYW5kIFRhcHMgU3VwcG9ydCBDaGVjayovCisKKwltb2RlX2xp
Yi0+dmJhLldyaXRlYmFja1NjYWxlUmF0aW9BbmRUYXBzU3VwcG9ydCA9IHRydWU7CisJZm9yIChr
ID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7
CisJCWlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9PSB0cnVlKSB7CisJCQlp
ZiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hQW5kQ2hyb21hU2NhbGluZ1N1cHBvcnRlZCA9
PSBmYWxzZQorCQkJCQkmJiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10gIT0gMS4w
CisJCQkJCQkJfHwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWUmF0aW9ba10gIT0gMS4wKSkgewor
CQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrU2NhbGVSYXRpb0FuZFRhcHNTdXBwb3J0ID0gZmFs
c2U7CisJCQl9CisJCQlpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10gPiBtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja01heEhTQ0xSYXRpbworCQkJCQl8fCBtb2RlX2xpYi0+dmJhLldy
aXRlYmFja1ZSYXRpb1trXQorCQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tNYXhWU0NM
UmF0aW8KKwkJCQkJfHwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10KKwkJCQkJCQk8
IG1vZGVfbGliLT52YmEuV3JpdGViYWNrTWluSFNDTFJhdGlvCisJCQkJCXx8IG1vZGVfbGliLT52
YmEuV3JpdGViYWNrVlJhdGlvW2tdCisJCQkJCQkJPCBtb2RlX2xpYi0+dmJhLldyaXRlYmFja01p
blZTQ0xSYXRpbworCQkJCQl8fCBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFIVGFwc1trXQor
CQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tNYXhIU0NMVGFwcworCQkJCQl8fCBtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0x1bWFWVGFwc1trXQorCQkJCQkJCT4gbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tNYXhWU0NMVGFwcworCQkJCQl8fCBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0hSYXRp
b1trXQorCQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRhcHNba10KKwkJCQkJ
fHwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWUmF0aW9ba10KKwkJCQkJCQk+IG1vZGVfbGliLT52
YmEuV3JpdGViYWNrTHVtYVZUYXBzW2tdCisJCQkJCXx8IChtb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0x1bWFIVGFwc1trXSA+IDIuMAorCQkJCQkJCSYmICgobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tM
dW1hSFRhcHNba10gJSAyKQorCQkJCQkJCQkJPT0gMSkpCisJCQkJCXx8IChtb2RlX2xpYi0+dmJh
LldyaXRlYmFja1BpeGVsRm9ybWF0W2tdICE9IGRtXzQ0NF8zMgorCQkJCQkJCSYmIChtb2RlX2xp
Yi0+dmJhLldyaXRlYmFja0Nocm9tYUhUYXBzW2tdCisJCQkJCQkJCQk+IG1vZGVfbGliLT52YmEu
V3JpdGViYWNrTWF4SFNDTFRhcHMKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuV3JpdGViYWNr
Q2hyb21hVlRhcHNba10KKwkJCQkJCQkJCQkJPiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja01heFZT
Q0xUYXBzCisJCQkJCQkJCQl8fCAyLjAKKwkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLldyaXRl
YmFja0hSYXRpb1trXQorCQkJCQkJCQkJCQk+IG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21h
SFRhcHNba10KKwkJCQkJCQkJCXx8IDIuMAorCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuV3Jp
dGViYWNrVlJhdGlvW2tdCisJCQkJCQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJv
bWFWVGFwc1trXQorCQkJCQkJCQkJfHwgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hSFRh
cHNba10gPiAyLjAKKwkJCQkJCQkJCQkmJiAoKG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21h
SFRhcHNba10gJSAyKSA9PSAxKSkpKSkgeworCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrU2Nh
bGVSYXRpb0FuZFRhcHNTdXBwb3J0ID0gZmFsc2U7CisJCQl9CisJCQlpZiAobW9kZV9saWItPnZi
YS5Xcml0ZWJhY2tWUmF0aW9ba10gPCAxLjApIHsKKwkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0x1bWFWRXh0cmEgPQorCQkJCQkJZG1sX21heCgxLjAgLSAyLjAgLyBkbWxfY2VpbCgxLjAgLyBt
b2RlX2xpYi0+dmJhLldyaXRlYmFja1ZSYXRpb1trXSwgMS4wKSwgMC4wKTsKKwkJCX0gZWxzZSB7
CisJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVkV4dHJhID0gLTE7CisJCQl9CisJCQlp
ZiAoKG1vZGVfbGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzMyCisJ
CQkJCSYmIG1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYVZUYXBzW2tdCisJCQkJCQkJPiAobW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tMaW5lQnVmZmVyTHVtYUJ1ZmZlclNpemUKKwkJCQkJCQkJCSsg
bW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMaW5lQnVmZmVyQ2hyb21hQnVmZmVyU2l6ZSkKKwkJCQkJ
CQkJCS8gMy4wCisJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25X
aWR0aFtrXQorCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFWRXh0cmEpCisJ
CQkJCXx8IChtb2RlX2xpYi0+dmJhLldyaXRlYmFja1BpeGVsRm9ybWF0W2tdID09IGRtXzQyMF84
CisJCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVlRhcHNba10KKwkJCQkJCQkJ
CT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMaW5lQnVmZmVyTHVtYUJ1ZmZlclNpemUKKwkJCQkJ
CQkJCQkJKiA4LjAgLyAxMC4wIC8gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEZXN0aW5hdGlvbldp
ZHRoW2tdCisJCQkJCQkJCQkJCS0gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVkV4dHJhKQor
CQkJCQl8fCAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBf
MTAKKwkJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFWVGFwc1trXQorCQkJCQkJ
CQkJPiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0xpbmVCdWZmZXJMdW1hQnVmZmVyU2l6ZQorCQkJ
CQkJCQkJCQkqIDguMCAvIDEwLjAKKwkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0x1bWFWRXh0cmEpKSB7CisJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tTY2FsZVJhdGlvQW5k
VGFwc1N1cHBvcnQgPSBmYWxzZTsKKwkJCX0KKwkJCWlmICgyLjAgKiBtb2RlX2xpYi0+dmJhLldy
aXRlYmFja1ZSYXRpb1trXSA8IDEpIHsKKwkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9t
YVZFeHRyYSA9IDAuMDsKKwkJCX0gZWxzZSB7CisJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tD
aHJvbWFWRXh0cmEgPSAtMTsKKwkJCX0KKwkJCWlmICgobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQ
aXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfOAorCQkJCQkmJiBtb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0Nocm9tYVZUYXBzW2tdCisJCQkJCQkJPiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0xpbmVCdWZm
ZXJDaHJvbWFCdWZmZXJTaXplCisJCQkJCQkJCQkqIDguMCAvIDEwLjAgLyBtb2RlX2xpYi0+dmJh
LldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJCQkJCS0gbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tDaHJvbWFWRXh0cmEpCisJCQkJCXx8IChtb2RlX2xpYi0+dmJhLldyaXRlYmFja1Bp
eGVsRm9ybWF0W2tdID09IGRtXzQyMF8xMAorCQkJCQkJCSYmIG1vZGVfbGliLT52YmEuV3JpdGVi
YWNrQ2hyb21hVlRhcHNba10KKwkJCQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMaW5l
QnVmZmVyQ2hyb21hQnVmZmVyU2l6ZQorCQkJCQkJCQkJCQkqIDguMCAvIDEwLjAKKwkJCQkJCQkJ
CQkJLyBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJCQkJ
CQkJLSBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYVZFeHRyYSkpIHsKKwkJCQltb2RlX2xp
Yi0+dmJhLldyaXRlYmFja1NjYWxlUmF0aW9BbmRUYXBzU3VwcG9ydCA9IGZhbHNlOworCQkJfQor
CQl9CisJfQorCS8qTWF4aW11bSBESVNQQ0xLL0RQUENMSyBTdXBwb3J0IGNoZWNrKi8KKworCW1v
ZGVfbGliLT52YmEuV3JpdGViYWNrUmVxdWlyZWRESVNQQ0xLID0gMC4wOworCWZvciAoayA9IDA7
IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlp
ZiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tFbmFibGVba10gPT0gdHJ1ZSkgeworCQkJbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tSZXF1aXJlZERJU1BDTEsgPQorCQkJCQlkbWxfbWF4KAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuV3JpdGViYWNrUmVxdWlyZWRESVNQQ0xLLAorCQkJCQkJCUNhbGN1bGF0
ZVdyaXRlQmFja0RJU1BDTEsoCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja1BpeGVs
Rm9ybWF0W2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdLAorCQkJCQkJ
CQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10sCisJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLldyaXRlYmFja1ZSYXRpb1trXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNr
THVtYUhUYXBzW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVlRhcHNb
a10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYUhUYXBzW2tdLAorCQkJ
CQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFWVGFwc1trXSwKKwkJCQkJCQkJCW1v
ZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFtrXSwKKwkJCQkJCQkJCW1vZGVf
bGliLT52YmEuSFRvdGFsW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJv
bWFMaW5lQnVmZmVyV2lkdGgpKTsKKwkJfQorCX0KKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGli
LT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVfbGliLT52
YmEuSFJhdGlvW2tdID4gMS4wKSB7CisJCQlsb2NhbHMtPlBTQ0xfRkFDVE9SW2tdID0gZG1sX21p
bigKKwkJCQkJbW9kZV9saWItPnZiYS5NYXhEQ0hVQlRvUFNDTFRocm91Z2hwdXQsCisJCQkJCW1v
ZGVfbGliLT52YmEuTWF4UFNDTFRvTEJUaHJvdWdocHV0CisJCQkJCQkJKiBtb2RlX2xpYi0+dmJh
LkhSYXRpb1trXQorCQkJCQkJCS8gZG1sX2NlaWwoCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLmh0
YXBzW2tdCisJCQkJCQkJCQkJCS8gNi4wLAorCQkJCQkJCQkJMS4wKSk7CisJCX0gZWxzZSB7CisJ
CQlsb2NhbHMtPlBTQ0xfRkFDVE9SW2tdID0gZG1sX21pbigKKwkJCQkJbW9kZV9saWItPnZiYS5N
YXhEQ0hVQlRvUFNDTFRocm91Z2hwdXQsCisJCQkJCW1vZGVfbGliLT52YmEuTWF4UFNDTFRvTEJU
aHJvdWdocHV0KTsKKwkJfQorCQlpZiAobG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVENba10gPT0g
MC4wKSB7CisJCQlsb2NhbHMtPlBTQ0xfRkFDVE9SX0NIUk9NQVtrXSA9IDAuMDsKKwkJCWxvY2Fs
cy0+TWluRFBQQ0xLVXNpbmdTaW5nbGVEUFBba10gPQorCQkJCQltb2RlX2xpYi0+dmJhLlBpeGVs
Q2xvY2tba10KKwkJCQkJCQkqIGRtbF9tYXgzKAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS52dGFw
c1trXSAvIDYuMAorCQkJCQkJCQkJCQkqIGRtbF9taW4oCisJCQkJCQkJCQkJCQkJMS4wLAorCQkJ
CQkJCQkJCQkJCW1vZGVfbGliLT52YmEuSFJhdGlvW2tdKSwKKwkJCQkJCQkJCW1vZGVfbGliLT52
YmEuSFJhdGlvW2tdCisJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5WUmF0aW9ba10KKwkJCQkJ
CQkJCQkJLyBsb2NhbHMtPlBTQ0xfRkFDVE9SW2tdLAorCQkJCQkJCQkJMS4wKTsKKwkJCWlmICgo
bW9kZV9saWItPnZiYS5odGFwc1trXSA+IDYuMCB8fCBtb2RlX2xpYi0+dmJhLnZ0YXBzW2tdID4g
Ni4wKQorCQkJCQkmJiBsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdCisJCQkJCQkJ
PCAyLjAgKiBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pIHsKKwkJCQlsb2NhbHMtPk1pbkRQ
UENMS1VzaW5nU2luZ2xlRFBQW2tdID0gMi4wCisJCQkJCQkqIG1vZGVfbGliLT52YmEuUGl4ZWxD
bG9ja1trXTsKKwkJCX0KKwkJfSBlbHNlIHsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLkhSYXRpb1tr
XSAvIDIuMCA+IDEuMCkgeworCQkJCWxvY2Fscy0+UFNDTF9GQUNUT1JfQ0hST01BW2tdID0KKwkJ
CQkJCWRtbF9taW4oCisJCQkJCQkJCW1vZGVfbGliLT52YmEuTWF4RENIVUJUb1BTQ0xUaHJvdWdo
cHV0LAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLk1heFBTQ0xUb0xCVGhyb3VnaHB1dAorCQkJCQkJ
CQkJCSogbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJCQkvIDIuMAorCQkJCQkJCQkJ
CS8gZG1sX2NlaWwoCisJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhUQVBzQ2hyb21hW2tdCisJ
CQkJCQkJCQkJCQkJCS8gNi4wLAorCQkJCQkJCQkJCQkJMS4wKSk7CisJCQl9IGVsc2UgeworCQkJ
CWxvY2Fscy0+UFNDTF9GQUNUT1JfQ0hST01BW2tdID0gZG1sX21pbigKKwkJCQkJCW1vZGVfbGli
LT52YmEuTWF4RENIVUJUb1BTQ0xUaHJvdWdocHV0LAorCQkJCQkJbW9kZV9saWItPnZiYS5NYXhQ
U0NMVG9MQlRocm91Z2hwdXQpOworCQkJfQorCQkJbG9jYWxzLT5NaW5EUFBDTEtVc2luZ1Npbmds
ZURQUFtrXSA9CisJCQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXQorCQkJCQkJCSogZG1s
X21heDUoCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLnZ0YXBzW2tdIC8gNi4wCisJCQkJCQkJCQkJ
CSogZG1sX21pbigKKwkJCQkJCQkJCQkJCQkxLjAsCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5IUmF0aW9ba10pLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJ
CQkJKiBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXQorCQkJCQkJCQkJCQkvIGxvY2Fscy0+UFNDTF9G
QUNUT1Jba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlZUQVBzQ2hyb21hW2tdCisJCQkJCQkJ
CQkJCS8gNi4wCisJCQkJCQkJCQkJCSogZG1sX21pbigKKwkJCQkJCQkJCQkJCQkxLjAsCisJCQkJ
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJCQkJCQkJCS8gMi4wKSwK
KwkJCQkJCQkJCW1vZGVfbGliLT52YmEuSFJhdGlvW2tdCisJCQkJCQkJCQkJCSogbW9kZV9saWIt
PnZiYS5WUmF0aW9ba10KKwkJCQkJCQkJCQkJLyA0LjAKKwkJCQkJCQkJCQkJLyBsb2NhbHMtPlBT
Q0xfRkFDVE9SX0NIUk9NQVtrXSwKKwkJCQkJCQkJCTEuMCk7CisJCQlpZiAoKG1vZGVfbGliLT52
YmEuaHRhcHNba10gPiA2LjAgfHwgbW9kZV9saWItPnZiYS52dGFwc1trXSA+IDYuMAorCQkJCQl8
fCBtb2RlX2xpYi0+dmJhLkhUQVBzQ2hyb21hW2tdID4gNi4wCisJCQkJCXx8IG1vZGVfbGliLT52
YmEuVlRBUHNDaHJvbWFba10gPiA2LjApCisJCQkJCSYmIGxvY2Fscy0+TWluRFBQQ0xLVXNpbmdT
aW5nbGVEUFBba10KKwkJCQkJCQk8IDIuMCAqIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkg
eworCQkJCWxvY2Fscy0+TWluRFBQQ0xLVXNpbmdTaW5nbGVEUFBba10gPSAyLjAKKwkJCQkJCSog
bW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdOworCQkJfQorCQl9CisJfQorCWZvciAoayA9IDA7
IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlD
YWxjdWxhdGUyNTZCQmxvY2tTaXplcygKKwkJCQltb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9y
bWF0W2tdLAorCQkJCW1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSwKKwkJCQlkbWxfY2Vp
bChsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSwgMS4wKSwKKwkJCQlkbWxfY2VpbChsb2Nh
bHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSwgMi4wKSwKKwkJCQkmbG9jYWxzLT5SZWFkMjU2Qmxv
Y2tIZWlnaHRZW2tdLAorCQkJCSZsb2NhbHMtPlJlYWQyNTZCbG9ja0hlaWdodENba10sCisJCQkJ
JmxvY2Fscy0+UmVhZDI1NkJsb2NrV2lkdGhZW2tdLAorCQkJCSZsb2NhbHMtPlJlYWQyNTZCbG9j
a1dpZHRoQ1trXSk7CisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gPT0gZG1faG9y
eikgeworCQkJbG9jYWxzLT5NYXhTd2F0aEhlaWdodFlba10gPSBsb2NhbHMtPlJlYWQyNTZCbG9j
a0hlaWdodFlba107CisJCQlsb2NhbHMtPk1heFN3YXRoSGVpZ2h0Q1trXSA9IGxvY2Fscy0+UmVh
ZDI1NkJsb2NrSGVpZ2h0Q1trXTsKKwkJfSBlbHNlIHsKKwkJCWxvY2Fscy0+TWF4U3dhdGhIZWln
aHRZW2tdID0gbG9jYWxzLT5SZWFkMjU2QmxvY2tXaWR0aFlba107CisJCQlsb2NhbHMtPk1heFN3
YXRoSGVpZ2h0Q1trXSA9IGxvY2Fscy0+UmVhZDI1NkJsb2NrV2lkdGhDW2tdOworCQl9CisJCWlm
ICgobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80NDRfNjQKKwkJCQl8
fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF8zMgorCQkJCXx8
IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzE2CisJCQkJfHwg
bW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV9tb25vXzE2CisJCQkJfHwg
bW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV9tb25vXzgpKSB7CisJCQlp
ZiAobW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdID09IGRtX3N3X2xpbmVhcgorCQkJCQl8
fCAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80NDRfNjQKKwkJCQkJ
CQkmJiAobW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQk9PSBkbV9zd180
a2JfcworCQkJCQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJ
CQkJCT09IGRtX3N3XzRrYl9zX3gKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFjZVRp
bGluZ1trXQorCQkJCQkJCQkJCQk9PSBkbV9zd182NGtiX3MKKwkJCQkJCQkJCXx8IG1vZGVfbGli
LT52YmEuU3VyZmFjZVRpbGluZ1trXQorCQkJCQkJCQkJCQk9PSBkbV9zd182NGtiX3NfdAorCQkJ
CQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJCT09IGRt
X3N3XzY0a2Jfc194CisJCQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10K
KwkJCQkJCQkJCQkJPT0gZG1fc3dfdmFyX3MKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3Vy
ZmFjZVRpbGluZ1trXQorCQkJCQkJCQkJCQk9PSBkbV9zd192YXJfc194KQorCQkJCQkJCSYmIG1v
ZGVfbGliLT52YmEuU291cmNlU2NhbltrXSA9PSBkbV9ob3J6KSkgeworCQkJCWxvY2Fscy0+TWlu
U3dhdGhIZWlnaHRZW2tdID0gbG9jYWxzLT5NYXhTd2F0aEhlaWdodFlba107CisJCQl9IGVsc2Ug
eworCQkJCWxvY2Fscy0+TWluU3dhdGhIZWlnaHRZW2tdID0gbG9jYWxzLT5NYXhTd2F0aEhlaWdo
dFlba10KKwkJCQkJCS8gMi4wOworCQkJfQorCQkJbG9jYWxzLT5NaW5Td2F0aEhlaWdodENba10g
PSBsb2NhbHMtPk1heFN3YXRoSGVpZ2h0Q1trXTsKKwkJfSBlbHNlIHsKKwkJCWlmIChtb2RlX2xp
Yi0+dmJhLlN1cmZhY2VUaWxpbmdba10gPT0gZG1fc3dfbGluZWFyKSB7CisJCQkJbG9jYWxzLT5N
aW5Td2F0aEhlaWdodFlba10gPSBsb2NhbHMtPk1heFN3YXRoSGVpZ2h0WVtrXTsKKwkJCQlsb2Nh
bHMtPk1pblN3YXRoSGVpZ2h0Q1trXSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRDW2tdOworCQkJ
fSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQyMF84
CisJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlU2NhbltrXSA9PSBkbV9ob3J6KSB7CisJCQkJ
bG9jYWxzLT5NaW5Td2F0aEhlaWdodFlba10gPSBsb2NhbHMtPk1heFN3YXRoSGVpZ2h0WVtrXQor
CQkJCQkJLyAyLjA7CisJCQkJbG9jYWxzLT5NaW5Td2F0aEhlaWdodENba10gPSBsb2NhbHMtPk1h
eFN3YXRoSGVpZ2h0Q1trXTsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhl
bEZvcm1hdFtrXSA9PSBkbV80MjBfMTAKKwkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VTY2Fu
W2tdID09IGRtX2hvcnopIHsKKwkJCQlsb2NhbHMtPk1pblN3YXRoSGVpZ2h0Q1trXSA9IGxvY2Fs
cy0+TWF4U3dhdGhIZWlnaHRDW2tdCisJCQkJCQkvIDIuMDsKKwkJCQlsb2NhbHMtPk1pblN3YXRo
SGVpZ2h0WVtrXSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRZW2tdOworCQkJfSBlbHNlIHsKKwkJ
CQlsb2NhbHMtPk1pblN3YXRoSGVpZ2h0WVtrXSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRZW2td
OworCQkJCWxvY2Fscy0+TWluU3dhdGhIZWlnaHRDW2tdID0gbG9jYWxzLT5NYXhTd2F0aEhlaWdo
dENba107CisJCQl9CisJCX0KKwkJaWYgKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSA9
PSBkbV9zd19saW5lYXIpIHsKKwkJCW1vZGVfbGliLT52YmEuTWF4aW11bVN3YXRoV2lkdGhTdXBw
b3J0ID0gODE5Mi4wOworCQl9IGVsc2UgeworCQkJbW9kZV9saWItPnZiYS5NYXhpbXVtU3dhdGhX
aWR0aFN1cHBvcnQgPSA1MTIwLjA7CisJCX0KKwkJbW9kZV9saWItPnZiYS5NYXhpbXVtU3dhdGhX
aWR0aEluREVUQnVmZmVyID0KKwkJCQlkbWxfbWluKAorCQkJCQkJbW9kZV9saWItPnZiYS5NYXhp
bXVtU3dhdGhXaWR0aFN1cHBvcnQsCisJCQkJCQltb2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVJ
bktCeXRlICogMTAyNC4wIC8gMi4wCisJCQkJCQkJCS8gKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5E
RVRZW2tdCisJCQkJCQkJCQkJKiBsb2NhbHMtPk1pblN3YXRoSGVpZ2h0WVtrXQorCQkJCQkJCQkJ
CSsgbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVENba10KKwkJCQkJCQkJCQkJCS8gMi4wCisJCQkJ
CQkJCQkJCQkqIGxvY2Fscy0+TWluU3dhdGhIZWlnaHRDW2tdKSk7CisJCWlmIChsb2NhbHMtPkJ5
dGVQZXJQaXhlbEluREVUQ1trXSA9PSAwLjApIHsKKwkJCW1vZGVfbGliLT52YmEuTWF4aW11bVN3
YXRoV2lkdGhJbkxpbmVCdWZmZXIgPQorCQkJCQltb2RlX2xpYi0+dmJhLkxpbmVCdWZmZXJTaXpl
CisJCQkJCQkJKiBkbWxfbWF4KG1vZGVfbGliLT52YmEuSFJhdGlvW2tdLCAxLjApCisJCQkJCQkJ
LyBtb2RlX2xpYi0+dmJhLkxCQml0UGVyUGl4ZWxba10KKwkJCQkJCQkvIChtb2RlX2xpYi0+dmJh
LnZ0YXBzW2tdCisJCQkJCQkJCQkrIGRtbF9tYXgoCisJCQkJCQkJCQkJCWRtbF9jZWlsKAorCQkJ
CQkJCQkJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCQkJCQkJCQkJCTEuMCkKKwkJ
CQkJCQkJCQkJCQktIDIsCisJCQkJCQkJCQkJCTAuMCkpOworCQl9IGVsc2UgeworCQkJbW9kZV9s
aWItPnZiYS5NYXhpbXVtU3dhdGhXaWR0aEluTGluZUJ1ZmZlciA9CisJCQkJCWRtbF9taW4oCisJ
CQkJCQkJbW9kZV9saWItPnZiYS5MaW5lQnVmZmVyU2l6ZQorCQkJCQkJCQkJKiBkbWxfbWF4KAor
CQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhSYXRpb1trXSwKKwkJCQkJCQkJCQkJMS4wKQorCQkJ
CQkJCQkJLyBtb2RlX2xpYi0+dmJhLkxCQml0UGVyUGl4ZWxba10KKwkJCQkJCQkJCS8gKG1vZGVf
bGliLT52YmEudnRhcHNba10KKwkJCQkJCQkJCQkJKyBkbWxfbWF4KAorCQkJCQkJCQkJCQkJCWRt
bF9jZWlsKAorCQkJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10sCisJCQkJCQkJ
CQkJCQkJCQkxLjApCisJCQkJCQkJCQkJCQkJCQktIDIsCisJCQkJCQkJCQkJCQkJMC4wKSksCisJ
CQkJCQkJMi4wICogbW9kZV9saWItPnZiYS5MaW5lQnVmZmVyU2l6ZQorCQkJCQkJCQkJKiBkbWxf
bWF4KAorCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhSYXRpb1trXQorCQkJCQkJCQkJCQkJCS8g
Mi4wLAorCQkJCQkJCQkJCQkxLjApCisJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuTEJCaXRQZXJQ
aXhlbFtrXQorCQkJCQkJCQkJLyAobW9kZV9saWItPnZiYS5WVEFQc0Nocm9tYVtrXQorCQkJCQkJ
CQkJCQkrIGRtbF9tYXgoCisJCQkJCQkJCQkJCQkJZG1sX2NlaWwoCisJCQkJCQkJCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLlZSYXRpb1trXQorCQkJCQkJCQkJCQkJCQkJCQkvIDIuMCwKKwkJCQkJCQkJ
CQkJCQkJCTEuMCkKKwkJCQkJCQkJCQkJCQkJCS0gMiwKKwkJCQkJCQkJCQkJCQkwLjApKSk7CisJ
CX0KKwkJbG9jYWxzLT5NYXhpbXVtU3dhdGhXaWR0aFtrXSA9IGRtbF9taW4oCisJCQkJbW9kZV9s
aWItPnZiYS5NYXhpbXVtU3dhdGhXaWR0aEluREVUQnVmZmVyLAorCQkJCW1vZGVfbGliLT52YmEu
TWF4aW11bVN3YXRoV2lkdGhJbkxpbmVCdWZmZXIpOworCX0KKwlmb3IgKGkgPSAwOyBpIDw9IG1v
ZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7IGkrKykgeworCQlmb3IgKGogPSAwOyBqIDwgMjsg
aisrKSB7CisJCQltb2RlX2xpYi0+dmJhLk1heERpc3BjbGtSb3VuZGVkRG93blRvREZTR3JhbnVs
YXJpdHkgPSBSb3VuZFRvREZTR3JhbnVsYXJpdHlEb3duKAorCQkJCW1vZGVfbGliLT52YmEuTWF4
RGlzcGNsa1tpXSwKKwkJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtWQ09TcGVlZCk7CisJ
CQltb2RlX2xpYi0+dmJhLk1heERwcGNsa1JvdW5kZWREb3duVG9ERlNHcmFudWxhcml0eSA9IFJv
dW5kVG9ERlNHcmFudWxhcml0eURvd24oCisJCQkJbW9kZV9saWItPnZiYS5NYXhEcHBjbGtbaV0s
CisJCQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLVkNPU3BlZWQpOworCQkJbG9jYWxzLT5S
ZXF1aXJlZERJU1BDTEtbaV1bal0gPSAwLjA7CisJCQlsb2NhbHMtPkRJU1BDTEtfRFBQQ0xLX1N1
cHBvcnRbaV1bal0gPSB0cnVlOworCQkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJbW9kZV9saWItPnZiYS5QbGFuZVJl
cXVpcmVkRElTUENMS1dpdGhvdXRPRE1Db21iaW5lID0KKwkJCQkJCW1vZGVfbGliLT52YmEuUGl4
ZWxDbG9ja1trXQorCQkJCQkJCQkqICgxLjAKKwkJCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuRElT
UENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcKKwkJCQkJCQkJCQkJCS8gMTAwLjApCisJCQkJ
CQkJCSogKDEuMAorCQkJCQkJCQkJCSsgbW9kZV9saWItPnZiYS5ESVNQQ0xLUmFtcGluZ01hcmdp
bgorCQkJCQkJCQkJCQkJLyAxMDAuMCk7CisJCQkJaWYgKG1vZGVfbGliLT52YmEuUGxhbmVSZXF1
aXJlZERJU1BDTEtXaXRob3V0T0RNQ29tYmluZSA+PSBtb2RlX2xpYi0+dmJhLk1heERpc3BjbGtb
aV0KKwkJCQkJCSYmIGkgPT0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlcykKKwkJCQkJbW9k
ZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElTUENMS1dpdGhvdXRPRE1Db21iaW5lID0gbW9kZV9s
aWItPnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCQkJKiAoMSArIG1vZGVfbGliLT52YmEuRElTUENM
S0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcgLyAxMDAuMCk7CisKKwkJCQltb2RlX2xpYi0+dmJh
LlBsYW5lUmVxdWlyZWRESVNQQ0xLV2l0aE9ETUNvbWJpbmUgPSBtb2RlX2xpYi0+dmJhLlBpeGVs
Q2xvY2tba10gLyAyCisJCQkJCSogKDEgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0ND
TEtEb3duU3ByZWFkaW5nIC8gMTAwLjApICogKDEgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtSYW1w
aW5nTWFyZ2luIC8gMTAwLjApOworCQkJCWlmIChtb2RlX2xpYi0+dmJhLlBsYW5lUmVxdWlyZWRE
SVNQQ0xLV2l0aE9ETUNvbWJpbmUgPj0gbW9kZV9saWItPnZiYS5NYXhEaXNwY2xrW2ldCisJCQkJ
CQkmJiBpID09IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXMpCisJCQkJCW1vZGVfbGliLT52
YmEuUGxhbmVSZXF1aXJlZERJU1BDTEtXaXRoT0RNQ29tYmluZSA9IG1vZGVfbGliLT52YmEuUGl4
ZWxDbG9ja1trXSAvIDIKKwkJCQkJCQkqICgxICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xL
RFNDQ0xLRG93blNwcmVhZGluZyAvIDEwMC4wKTsKKwkJCQlpZiAobW9kZV9saWItPnZiYS5PRE1D
YXBhYmlsaXR5ID09IGZhbHNlIHx8IG1vZGVfbGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BDTEtX
aXRob3V0T0RNQ29tYmluZSA8PSBtb2RlX2xpYi0+dmJhLk1heERpc3BjbGtSb3VuZGVkRG93blRv
REZTR3JhbnVsYXJpdHkpIHsKKwkJCQkJbG9jYWxzLT5PRE1Db21iaW5lRW5hYmxlUGVyU3RhdGVb
aV1ba10gPSBmYWxzZTsKKwkJCQkJbW9kZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElTUENMSyA9
IG1vZGVfbGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BDTEtXaXRob3V0T0RNQ29tYmluZTsKKwkJ
CQl9IGVsc2UgeworCQkJCQlsb2NhbHMtPk9ETUNvbWJpbmVFbmFibGVQZXJTdGF0ZVtpXVtrXSA9
IHRydWU7CisJCQkJCW1vZGVfbGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BDTEsgPSBtb2RlX2xp
Yi0+dmJhLlBsYW5lUmVxdWlyZWRESVNQQ0xLV2l0aE9ETUNvbWJpbmU7CisJCQkJfQorCQkJCWlm
IChsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdICogKDEuMCArIG1vZGVfbGliLT52
YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcgLyAxMDAuMCkgPD0gbW9kZV9saWIt
PnZiYS5NYXhEcHBjbGtSb3VuZGVkRG93blRvREZTR3JhbnVsYXJpdHkKKwkJCQkJCSYmIGxvY2Fs
cy0+U3dhdGhXaWR0aFlTaW5nbGVEUFBba10gPD0gbG9jYWxzLT5NYXhpbXVtU3dhdGhXaWR0aFtr
XQorCQkJCQkJJiYgbG9jYWxzLT5PRE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbaV1ba10gPT0gZmFs
c2UpIHsKKwkJCQkJbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdID0gMTsKKwkJCQkJbG9jYWxzLT5S
ZXF1aXJlZERQUENMS1tpXVtqXVtrXSA9CisJCQkJCQlsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2lu
Z2xlRFBQW2tdICogKDEuMCArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25T
cHJlYWRpbmcgLyAxMDAuMCk7CisJCQkJfSBlbHNlIHsKKwkJCQkJbG9jYWxzLT5Ob09mRFBQW2ld
W2pdW2tdID0gMjsKKwkJCQkJbG9jYWxzLT5SZXF1aXJlZERQUENMS1tpXVtqXVtrXSA9CisJCQkJ
CQlsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdICogKDEuMCArIG1vZGVfbGliLT52
YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcgLyAxMDAuMCkgLyAyLjA7CisJCQkJ
fQorCQkJCWxvY2Fscy0+UmVxdWlyZWRESVNQQ0xLW2ldW2pdID0gZG1sX21heCgKKwkJCQkJCWxv
Y2Fscy0+UmVxdWlyZWRESVNQQ0xLW2ldW2pdLAorCQkJCQkJbW9kZV9saWItPnZiYS5QbGFuZVJl
cXVpcmVkRElTUENMSyk7CisJCQkJaWYgKChsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQ
W2tdIC8gbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdICogKDEuMCArIG1vZGVfbGliLT52YmEuRElT
UENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcgLyAxMDAuMCkKKwkJCQkJCT4gbW9kZV9saWIt
PnZiYS5NYXhEcHBjbGtSb3VuZGVkRG93blRvREZTR3JhbnVsYXJpdHkpCisJCQkJCQl8fCAobW9k
ZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElTUENMSyA+IG1vZGVfbGliLT52YmEuTWF4RGlzcGNs
a1JvdW5kZWREb3duVG9ERlNHcmFudWxhcml0eSkpIHsKKwkJCQkJbG9jYWxzLT5ESVNQQ0xLX0RQ
UENMS19TdXBwb3J0W2ldW2pdID0gZmFsc2U7CisJCQkJfQorCQkJfQorCQkJbG9jYWxzLT5Ub3Rh
bE51bWJlck9mQWN0aXZlRFBQW2ldW2pdID0gMC4wOworCQkJZm9yIChrID0gMDsgayA8PSBtb2Rl
X2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKQorCQkJCWxvY2Fscy0+VG90
YWxOdW1iZXJPZkFjdGl2ZURQUFtpXVtqXSA9IGxvY2Fscy0+VG90YWxOdW1iZXJPZkFjdGl2ZURQ
UFtpXVtqXSArIGxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXTsKKwkJCWlmIChqID09IDEpIHsKKwkJ
CQl3aGlsZSAobG9jYWxzLT5Ub3RhbE51bWJlck9mQWN0aXZlRFBQW2ldW2pdIDwgbW9kZV9saWIt
PnZiYS5NYXhOdW1EUFAKKwkJCQkJCSYmIGxvY2Fscy0+VG90YWxOdW1iZXJPZkFjdGl2ZURQUFtp
XVtqXSA8IDIgKiBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzKSB7CisJCQkJCWRv
dWJsZSBCV09mTm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aDsKKwkJCQkJdW5zaWduZWQg
aW50IE51bWJlck9mTm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aDsKKworCQkJCQlCV09m
Tm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aCA9IDA7CisJCQkJCU51bWJlck9mTm9uU3Bs
aXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aCA9IDA7CisJCQkJCWZvciAoayA9IDA7IGsgPCBtb2Rl
X2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJCQkJCWlmIChsb2NhbHMt
PlJlYWRCYW5kd2lkdGhba10gPiBCV09mTm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aCAm
JiBsb2NhbHMtPk5vT2ZEUFBbaV1bal1ba10gPT0gMSkgeworCQkJCQkJCUJXT2ZOb25TcGxpdFBs
YW5lT2ZNYXhpbXVtQmFuZHdpZHRoID0gbG9jYWxzLT5SZWFkQmFuZHdpZHRoW2tdOworCQkJCQkJ
CU51bWJlck9mTm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aCA9IGs7CisJCQkJCQl9CisJ
CQkJCX0KKwkJCQkJbG9jYWxzLT5Ob09mRFBQW2ldW2pdW051bWJlck9mTm9uU3BsaXRQbGFuZU9m
TWF4aW11bUJhbmR3aWR0aF0gPSAyOworCQkJCQlsb2NhbHMtPlJlcXVpcmVkRFBQQ0xLW2ldW2pd
W051bWJlck9mTm9uU3BsaXRQbGFuZU9mTWF4aW11bUJhbmR3aWR0aF0gPQorCQkJCQkJbG9jYWxz
LT5NaW5EUFBDTEtVc2luZ1NpbmdsZURQUFtOdW1iZXJPZk5vblNwbGl0UGxhbmVPZk1heGltdW1C
YW5kd2lkdGhdCisJCQkJCQkJKiAoMSArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NM
S0Rvd25TcHJlYWRpbmcgLyAxMDApIC8gMjsKKwkJCQkJbG9jYWxzLT5Ub3RhbE51bWJlck9mQWN0
aXZlRFBQW2ldW2pdID0gbG9jYWxzLT5Ub3RhbE51bWJlck9mQWN0aXZlRFBQW2ldW2pdICsgMTsK
KwkJCQl9CisJCQl9CisJCQlpZiAobG9jYWxzLT5Ub3RhbE51bWJlck9mQWN0aXZlRFBQW2ldW2pd
ID4gbW9kZV9saWItPnZiYS5NYXhOdW1EUFApIHsKKwkJCQlsb2NhbHMtPlJlcXVpcmVkRElTUENM
S1tpXVtqXSA9IDAuMDsKKwkJCQlsb2NhbHMtPkRJU1BDTEtfRFBQQ0xLX1N1cHBvcnRbaV1bal0g
PSB0cnVlOworCQkJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2
ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJCQlsb2NhbHMtPk9ETUNvbWJpbmVFbmFibGVQZXJTdGF0
ZVtpXVtrXSA9IGZhbHNlOworCQkJCQlpZiAobG9jYWxzLT5Td2F0aFdpZHRoWVNpbmdsZURQUFtr
XSA8PSBsb2NhbHMtPk1heGltdW1Td2F0aFdpZHRoW2tdKSB7CisJCQkJCQlsb2NhbHMtPk5vT2ZE
UFBbaV1bal1ba10gPSAxOworCQkJCQkJbG9jYWxzLT5SZXF1aXJlZERQUENMS1tpXVtqXVtrXSA9
IGxvY2Fscy0+TWluRFBQQ0xLVXNpbmdTaW5nbGVEUFBba10KKwkJCQkJCQkqICgxLjAgKyBtb2Rl
X2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0NDTEtEb3duU3ByZWFkaW5nIC8gMTAwLjApOworCQkJ
CQl9IGVsc2UgeworCQkJCQkJbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdID0gMjsKKwkJCQkJCWxv
Y2Fscy0+UmVxdWlyZWREUFBDTEtbaV1bal1ba10gPSBsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2lu
Z2xlRFBQW2tdCisJCQkJCQkJCQkJKiAoMS4wICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xL
RFNDQ0xLRG93blNwcmVhZGluZyAvIDEwMC4wKSAvIDIuMDsKKwkJCQkJfQorCQkJCQlpZiAoaSAh
PSBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzKSB7CisJCQkJCQltb2RlX2xpYi0+dmJhLlBs
YW5lUmVxdWlyZWRESVNQQ0xLID0KKwkJCQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2td
CisJCQkJCQkJCQkJKiAoMS4wICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93
blNwcmVhZGluZyAvIDEwMC4wKQorCQkJCQkJCQkJCSogKDEuMCArIG1vZGVfbGliLT52YmEuRElT
UENMS1JhbXBpbmdNYXJnaW4gLyAxMDAuMCk7CisJCQkJCX0gZWxzZSB7CisJCQkJCQltb2RlX2xp
Yi0+dmJhLlBsYW5lUmVxdWlyZWRESVNQQ0xLID0gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2td
CisJCQkJCQkJKiAoMS4wICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNw
cmVhZGluZyAvIDEwMC4wKTsKKwkJCQkJfQorCQkJCQlsb2NhbHMtPlJlcXVpcmVkRElTUENMS1tp
XVtqXSA9IGRtbF9tYXgoCisJCQkJCQkJbG9jYWxzLT5SZXF1aXJlZERJU1BDTEtbaV1bal0sCisJ
CQkJCQkJbW9kZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElTUENMSyk7CisJCQkJCWlmIChsb2Nh
bHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdIC8gbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2td
ICogKDEuMCArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcg
LyAxMDAuMCkKKwkJCQkJCQk+IG1vZGVfbGliLT52YmEuTWF4RHBwY2xrUm91bmRlZERvd25Ub0RG
U0dyYW51bGFyaXR5CisJCQkJCQkJfHwgbW9kZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElTUENM
SyA+IG1vZGVfbGliLT52YmEuTWF4RGlzcGNsa1JvdW5kZWREb3duVG9ERlNHcmFudWxhcml0eSkK
KwkJCQkJCWxvY2Fscy0+RElTUENMS19EUFBDTEtfU3VwcG9ydFtpXVtqXSA9IGZhbHNlOworCQkJ
CX0KKwkJCQlsb2NhbHMtPlRvdGFsTnVtYmVyT2ZBY3RpdmVEUFBbaV1bal0gPSAwLjA7CisJCQkJ
Zm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsg
aysrKQorCQkJCQlsb2NhbHMtPlRvdGFsTnVtYmVyT2ZBY3RpdmVEUFBbaV1bal0gPSBsb2NhbHMt
PlRvdGFsTnVtYmVyT2ZBY3RpdmVEUFBbaV1bal0gKyBsb2NhbHMtPk5vT2ZEUFBbaV1bal1ba107
CisJCQl9CisJCQlsb2NhbHMtPlJlcXVpcmVkRElTUENMS1tpXVtqXSA9IGRtbF9tYXgoCisJCQkJ
CWxvY2Fscy0+UmVxdWlyZWRESVNQQ0xLW2ldW2pdLAorCQkJCQltb2RlX2xpYi0+dmJhLldyaXRl
YmFja1JlcXVpcmVkRElTUENMSyk7CisJCQlpZiAobW9kZV9saWItPnZiYS5NYXhEaXNwY2xrUm91
bmRlZERvd25Ub0RGU0dyYW51bGFyaXR5CisJCQkJCTwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tS
ZXF1aXJlZERJU1BDTEspIHsKKwkJCQlsb2NhbHMtPkRJU1BDTEtfRFBQQ0xLX1N1cHBvcnRbaV1b
al0gPSBmYWxzZTsKKwkJCX0KKwkJfQorCX0KKwkvKlZpZXdwb3J0IFNpemUgQ2hlY2sqLworCisJ
Zm9yIChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJ
bG9jYWxzLT5WaWV3cG9ydFNpemVTdXBwb3J0W2ldID0gdHJ1ZTsKKwkJZm9yIChrID0gMDsgayA8
PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQlpZiAo
bG9jYWxzLT5PRE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbaV1ba10gPT0gdHJ1ZSkgeworCQkJCWlm
IChkbWxfbWluKGxvY2Fscy0+U3dhdGhXaWR0aFlTaW5nbGVEUFBba10sIGRtbF9yb3VuZChtb2Rl
X2xpYi0+dmJhLkhBY3RpdmVba10gLyAyLjAgKiBtb2RlX2xpYi0+dmJhLkhSYXRpb1trXSkpCisJ
CQkJCQk+IGxvY2Fscy0+TWF4aW11bVN3YXRoV2lkdGhba10pIHsKKwkJCQkJbG9jYWxzLT5WaWV3
cG9ydFNpemVTdXBwb3J0W2ldID0gZmFsc2U7CisJCQkJfQorCQkJfSBlbHNlIHsKKwkJCQlpZiAo
bG9jYWxzLT5Td2F0aFdpZHRoWVNpbmdsZURQUFtrXSAvIDIuMCA+IGxvY2Fscy0+TWF4aW11bVN3
YXRoV2lkdGhba10pIHsKKwkJCQkJbG9jYWxzLT5WaWV3cG9ydFNpemVTdXBwb3J0W2ldID0gZmFs
c2U7CisJCQkJfQorCQkJfQorCQl9CisJfQorCS8qVG90YWwgQXZhaWxhYmxlIFBpcGVzIFN1cHBv
cnQgQ2hlY2sqLworCisJZm9yIChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJhLnNvYy5udW1fc3Rh
dGVzOyBpKyspIHsKKwkJZm9yIChqID0gMDsgaiA8IDI7IGorKykgeworCQkJaWYgKGxvY2Fscy0+
VG90YWxOdW1iZXJPZkFjdGl2ZURQUFtpXVtqXSA8PSBtb2RlX2xpYi0+dmJhLk1heE51bURQUCkK
KwkJCQlsb2NhbHMtPlRvdGFsQXZhaWxhYmxlUGlwZXNTdXBwb3J0W2ldW2pdID0gdHJ1ZTsKKwkJ
CWVsc2UKKwkJCQlsb2NhbHMtPlRvdGFsQXZhaWxhYmxlUGlwZXNTdXBwb3J0W2ldW2pdID0gZmFs
c2U7CisJCX0KKwl9CisJLypUb3RhbCBBdmFpbGFibGUgT1RHIFN1cHBvcnQgQ2hlY2sqLworCisJ
bW9kZV9saWItPnZiYS5Ub3RhbE51bWJlck9mQWN0aXZlT1RHID0gMC4wOworCWZvciAoayA9IDA7
IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlp
ZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBrKSB7CisJCQltb2RlX2xp
Yi0+dmJhLlRvdGFsTnVtYmVyT2ZBY3RpdmVPVEcgPSBtb2RlX2xpYi0+dmJhLlRvdGFsTnVtYmVy
T2ZBY3RpdmVPVEcKKwkJCQkJKyAxLjA7CisJCX0KKwl9CisJaWYgKG1vZGVfbGliLT52YmEuVG90
YWxOdW1iZXJPZkFjdGl2ZU9URyA8PSBtb2RlX2xpYi0+dmJhLk1heE51bU9URykgeworCQltb2Rl
X2xpYi0+dmJhLk51bWJlck9mT1RHU3VwcG9ydCA9IHRydWU7CisJfSBlbHNlIHsKKwkJbW9kZV9s
aWItPnZiYS5OdW1iZXJPZk9UR1N1cHBvcnQgPSBmYWxzZTsKKwl9CisJLypEaXNwbGF5IElPIGFu
ZCBEU0MgU3VwcG9ydCBDaGVjayovCisKKwltb2RlX2xpYi0+dmJhLk5vbnN1cHBvcnRlZERTQ0lu
cHV0QlBDID0gZmFsc2U7CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9m
QWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmICghKG1vZGVfbGliLT52YmEuRFNDSW5wdXRC
aXRQZXJDb21wb25lbnRba10gPT0gMTIuMAorCQkJCXx8IG1vZGVfbGliLT52YmEuRFNDSW5wdXRC
aXRQZXJDb21wb25lbnRba10gPT0gMTAuMAorCQkJCXx8IG1vZGVfbGliLT52YmEuRFNDSW5wdXRC
aXRQZXJDb21wb25lbnRba10gPT0gOC4wKSkgeworCQkJbW9kZV9saWItPnZiYS5Ob25zdXBwb3J0
ZWREU0NJbnB1dEJQQyA9IHRydWU7CisJCX0KKwl9CisJZm9yIChpID0gMDsgaSA8PSBtb2RlX2xp
Yi0+dmJhLnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xp
Yi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQlsb2NhbHMtPlJlcXVp
cmVzRFNDW2ldW2tdID0gMDsKKwkJCWxvY2Fscy0+UmVxdWlyZXNGRUNbaV1ba10gPSAwOworCQkJ
aWYgKG1vZGVfbGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdba10gPT0gaykgeworCQkJCWlmICht
b2RlX2xpYi0+dmJhLk91dHB1dFtrXSA9PSBkbV9oZG1pKSB7CisJCQkJCWxvY2Fscy0+UmVxdWly
ZXNEU0NbaV1ba10gPSAwOworCQkJCQlsb2NhbHMtPlJlcXVpcmVzRkVDW2ldW2tdID0gMDsKKwkJ
CQkJbG9jYWxzLT5PdXRwdXRCcHBQZXJTdGF0ZVtpXVtrXSA9IFRydW5jVG9WYWxpZEJQUCgKKwkJ
CQkJCQlkbWxfbWluKDYwMC4wLCBtb2RlX2xpYi0+dmJhLlBIWUNMS1BlclN0YXRlW2ldKSAvIG1v
ZGVfbGliLT52YmEuUGl4ZWxDbG9ja0JhY2tFbmRba10gKiAyNCwKKwkJCQkJCQltb2RlX2xpYi0+
dmJhLkZvcmNlZE91dHB1dExpbmtCUFBba10sCisJCQkJCQkJZmFsc2UsCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5PdXRwdXRba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10s
CisJCQkJCQkJbW9kZV9saWItPnZiYS5EU0NJbnB1dEJpdFBlckNvbXBvbmVudFtrXSk7CisJCQkJ
fSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLk91dHB1dFtrXSA9PSBkbV9kcAorCQkJCQkJfHwgbW9k
ZV9saWItPnZiYS5PdXRwdXRba10gPT0gZG1fZWRwKSB7CisJCQkJCWlmIChtb2RlX2xpYi0+dmJh
Lk91dHB1dFtrXSA9PSBkbV9lZHApIHsKKwkJCQkJCW1vZGVfbGliLT52YmEuRWZmZWN0aXZlRkVD
T3ZlcmhlYWQgPSAwLjA7CisJCQkJCX0gZWxzZSB7CisJCQkJCQltb2RlX2xpYi0+dmJhLkVmZmVj
dGl2ZUZFQ092ZXJoZWFkID0KKwkJCQkJCQkJbW9kZV9saWItPnZiYS5GRUNPdmVyaGVhZDsKKwkJ
CQkJfQorCQkJCQlpZiAobW9kZV9saWItPnZiYS5QSFlDTEtQZXJTdGF0ZVtpXSA+PSAyNzAuMCkg
eworCQkJCQkJbW9kZV9saWItPnZiYS5PdXRicHAgPSBUcnVuY1RvVmFsaWRCUFAoCisJCQkJCQkJ
CSgxLjAgLSBtb2RlX2xpYi0+dmJhLkRvd25zcHJlYWRpbmcgLyAxMDAuMCkgKiAyNzAuMAorCQkJ
CQkJCQkqIG1vZGVfbGliLT52YmEuT3V0cHV0TGlua0RQTGFuZXNba10gLyBtb2RlX2xpYi0+dmJh
LlBpeGVsQ2xvY2tCYWNrRW5kW2tdICogOC4wLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLkZvcmNl
ZE91dHB1dExpbmtCUFBba10sCisJCQkJCQkJCWZhbHNlLAorCQkJCQkJCQltb2RlX2xpYi0+dmJh
Lk91dHB1dFtrXSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10sCisJCQkJ
CQkJCW1vZGVfbGliLT52YmEuRFNDSW5wdXRCaXRQZXJDb21wb25lbnRba10pOworCQkJCQkJbW9k
ZV9saWItPnZiYS5PdXRicHBEU0MgPSBUcnVuY1RvVmFsaWRCUFAoCisJCQkJCQkJCSgxLjAgLSBt
b2RlX2xpYi0+dmJhLkRvd25zcHJlYWRpbmcgLyAxMDAuMCkgKiAoMS4wIC0gbW9kZV9saWItPnZi
YS5FZmZlY3RpdmVGRUNPdmVyaGVhZCAvIDEwMC4wKSAqIDI3MC4wCisJCQkJCQkJCSogbW9kZV9s
aWItPnZiYS5PdXRwdXRMaW5rRFBMYW5lc1trXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja0Jh
Y2tFbmRba10gKiA4LjAsCisJCQkJCQkJCW1vZGVfbGliLT52YmEuRm9yY2VkT3V0cHV0TGlua0JQ
UFtrXSwKKwkJCQkJCQkJdHJ1ZSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRba10sCisJ
CQkJCQkJCW1vZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0W2tdLAorCQkJCQkJCQltb2RlX2xpYi0+
dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9uZW50W2tdKTsKKwkJCQkJCWlmIChtb2RlX2xpYi0+dmJh
LkRTQ0VuYWJsZWRba10gPT0gdHJ1ZSkgeworCQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNEU0NbaV1b
a10gPSB0cnVlOworCQkJCQkJCWlmIChtb2RlX2xpYi0+dmJhLk91dHB1dFtrXSA9PSBkbV9kcCkg
eworCQkJCQkJCQlsb2NhbHMtPlJlcXVpcmVzRkVDW2ldW2tdID0gdHJ1ZTsKKwkJCQkJCQl9IGVs
c2UgeworCQkJCQkJCQlsb2NhbHMtPlJlcXVpcmVzRkVDW2ldW2tdID0gZmFsc2U7CisJCQkJCQkJ
fQorCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0YnBwID0gbW9kZV9saWItPnZiYS5PdXRicHBEU0M7
CisJCQkJCQl9IGVsc2UgeworCQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNEU0NbaV1ba10gPSBmYWxz
ZTsKKwkJCQkJCQlsb2NhbHMtPlJlcXVpcmVzRkVDW2ldW2tdID0gZmFsc2U7CisJCQkJCQl9CisJ
CQkJCQlsb2NhbHMtPk91dHB1dEJwcFBlclN0YXRlW2ldW2tdID0gbW9kZV9saWItPnZiYS5PdXRi
cHA7CisJCQkJCX0KKwkJCQkJaWYgKG1vZGVfbGliLT52YmEuT3V0YnBwID09IEJQUF9JTlZBTElE
ICYmIG1vZGVfbGliLT52YmEuUEhZQ0xLUGVyU3RhdGVbaV0gPj0gNTQwLjApIHsKKwkJCQkJCW1v
ZGVfbGliLT52YmEuT3V0YnBwID0gVHJ1bmNUb1ZhbGlkQlBQKAorCQkJCQkJCQkoMS4wIC0gbW9k
ZV9saWItPnZiYS5Eb3duc3ByZWFkaW5nIC8gMTAwLjApICogNTQwLjAKKwkJCQkJCQkJKiBtb2Rl
X2xpYi0+dmJhLk91dHB1dExpbmtEUExhbmVzW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2Nr
QmFja0VuZFtrXSAqIDguMCwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5Gb3JjZWRPdXRwdXRMaW5r
QlBQW2tdLAorCQkJCQkJCQkJZmFsc2UsCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dFtr
XSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0W2tdLAorCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5EU0NJbnB1dEJpdFBlckNvbXBvbmVudFtrXSk7CisJCQkJCQltb2RlX2xpYi0+
dmJhLk91dGJwcERTQyA9IFRydW5jVG9WYWxpZEJQUCgKKwkJCQkJCQkJKDEuMCAtIG1vZGVfbGli
LT52YmEuRG93bnNwcmVhZGluZyAvIDEwMC4wKSAqICgxLjAgLSBtb2RlX2xpYi0+dmJhLkVmZmVj
dGl2ZUZFQ092ZXJoZWFkIC8gMTAwLjApICogNTQwLjAKKwkJCQkJCQkJKiBtb2RlX2xpYi0+dmJh
Lk91dHB1dExpbmtEUExhbmVzW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtr
XSAqIDguMCwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5Gb3JjZWRPdXRwdXRMaW5rQlBQW2tdLAor
CQkJCQkJCQl0cnVlLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dFtrXSwKKwkJCQkJCQkJ
bW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10sCisJCQkJCQkJCW1vZGVfbGliLT52YmEuRFND
SW5wdXRCaXRQZXJDb21wb25lbnRba10pOworCQkJCQkJaWYgKG1vZGVfbGliLT52YmEuRFNDRW5h
YmxlZFtrXSA9PSB0cnVlKSB7CisJCQkJCQkJbG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9IHRy
dWU7CisJCQkJCQkJaWYgKG1vZGVfbGliLT52YmEuT3V0cHV0W2tdID09IGRtX2RwKSB7CisJCQkJ
CQkJCWxvY2Fscy0+UmVxdWlyZXNGRUNbaV1ba10gPSB0cnVlOworCQkJCQkJCX0gZWxzZSB7CisJ
CQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNGRUNbaV1ba10gPSBmYWxzZTsKKwkJCQkJCQl9CisJCQkJ
CQkJbW9kZV9saWItPnZiYS5PdXRicHAgPSBtb2RlX2xpYi0+dmJhLk91dGJwcERTQzsKKwkJCQkJ
CX0gZWxzZSB7CisJCQkJCQkJbG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9IGZhbHNlOworCQkJ
CQkJCWxvY2Fscy0+UmVxdWlyZXNGRUNbaV1ba10gPSBmYWxzZTsKKwkJCQkJCX0KKwkJCQkJCWxv
Y2Fscy0+T3V0cHV0QnBwUGVyU3RhdGVbaV1ba10gPSBtb2RlX2xpYi0+dmJhLk91dGJwcDsKKwkJ
CQkJfQorCQkJCQlpZiAobW9kZV9saWItPnZiYS5PdXRicHAgPT0gQlBQX0lOVkFMSUQKKwkJCQkJ
CQkmJiBtb2RlX2xpYi0+dmJhLlBIWUNMS1BlclN0YXRlW2ldCisJCQkJCQkJCQk+PSA4MTAuMCkg
eworCQkJCQkJbW9kZV9saWItPnZiYS5PdXRicHAgPSBUcnVuY1RvVmFsaWRCUFAoCisJCQkJCQkJ
CSgxLjAgLSBtb2RlX2xpYi0+dmJhLkRvd25zcHJlYWRpbmcgLyAxMDAuMCkgKiA4MTAuMAorCQkJ
CQkJCQkqIG1vZGVfbGliLT52YmEuT3V0cHV0TGlua0RQTGFuZXNba10gLyBtb2RlX2xpYi0+dmJh
LlBpeGVsQ2xvY2tCYWNrRW5kW2tdICogOC4wLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLkZvcmNl
ZE91dHB1dExpbmtCUFBba10sCisJCQkJCQkJCWZhbHNlLAorCQkJCQkJCQltb2RlX2xpYi0+dmJh
Lk91dHB1dFtrXSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10sCisJCQkJ
CQkJCW1vZGVfbGliLT52YmEuRFNDSW5wdXRCaXRQZXJDb21wb25lbnRba10pOworCQkJCQkJbW9k
ZV9saWItPnZiYS5PdXRicHBEU0MgPSBUcnVuY1RvVmFsaWRCUFAoCisJCQkJCQkJCSgxLjAgLSBt
b2RlX2xpYi0+dmJhLkRvd25zcHJlYWRpbmcgLyAxMDAuMCkgKiAoMS4wIC0gbW9kZV9saWItPnZi
YS5FZmZlY3RpdmVGRUNPdmVyaGVhZCAvIDEwMC4wKSAqIDgxMC4wCisJCQkJCQkJCSogbW9kZV9s
aWItPnZiYS5PdXRwdXRMaW5rRFBMYW5lc1trXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja0Jh
Y2tFbmRba10gKiA4LjAsCisJCQkJCQkJCW1vZGVfbGliLT52YmEuRm9yY2VkT3V0cHV0TGlua0JQ
UFtrXSwKKwkJCQkJCQkJdHJ1ZSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRba10sCisJ
CQkJCQkJCW1vZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0W2tdLAorCQkJCQkJCQltb2RlX2xpYi0+
dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9uZW50W2tdKTsKKwkJCQkJCWlmIChtb2RlX2xpYi0+dmJh
LkRTQ0VuYWJsZWRba10gPT0gdHJ1ZSB8fCBtb2RlX2xpYi0+dmJhLk91dGJwcCA9PSBCUFBfSU5W
QUxJRCkgeworCQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNEU0NbaV1ba10gPSB0cnVlOworCQkJCQkJ
CWlmIChtb2RlX2xpYi0+dmJhLk91dHB1dFtrXSA9PSBkbV9kcCkgeworCQkJCQkJCQlsb2NhbHMt
PlJlcXVpcmVzRkVDW2ldW2tdID0gdHJ1ZTsKKwkJCQkJCQl9IGVsc2UgeworCQkJCQkJCQlsb2Nh
bHMtPlJlcXVpcmVzRkVDW2ldW2tdID0gZmFsc2U7CisJCQkJCQkJfQorCQkJCQkJCW1vZGVfbGli
LT52YmEuT3V0YnBwID0gbW9kZV9saWItPnZiYS5PdXRicHBEU0M7CisJCQkJCQl9IGVsc2Ugewor
CQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNEU0NbaV1ba10gPSBmYWxzZTsKKwkJCQkJCQlsb2NhbHMt
PlJlcXVpcmVzRkVDW2ldW2tdID0gZmFsc2U7CisJCQkJCQl9CisJCQkJCQlsb2NhbHMtPk91dHB1
dEJwcFBlclN0YXRlW2ldW2tdID0KKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRicHA7CisJCQkJ
CX0KKwkJCQl9CisJCQl9IGVsc2UgeworCQkJCWxvY2Fscy0+T3V0cHV0QnBwUGVyU3RhdGVbaV1b
a10gPSBCUFBfQkxFTkRFRF9QSVBFOworCQkJfQorCQl9CisJfQorCWZvciAoaSA9IDA7IGkgPD0g
bW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJCWxvY2Fscy0+RElPU3VwcG9y
dFtpXSA9IHRydWU7CisJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFj
dGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJaWYgKGxvY2Fscy0+T3V0cHV0QnBwUGVyU3RhdGVb
aV1ba10gPT0gQlBQX0lOVkFMSUQKKwkJCQkJfHwgKG1vZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0
W2tdID09IGRtXzQyMAorCQkJCQkJCSYmIG1vZGVfbGliLT52YmEuSW50ZXJsYWNlW2tdID09IHRy
dWUKKwkJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlByb2dyZXNzaXZlVG9JbnRlcmxhY2VVbml0SW5P
UFAgPT0gdHJ1ZSkpIHsKKwkJCQlsb2NhbHMtPkRJT1N1cHBvcnRbaV0gPSBmYWxzZTsKKwkJCX0K
KwkJfQorCX0KKwlmb3IgKGkgPSAwOyBpIDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7
IGkrKykgeworCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXMgLSAxOyBrKyspIHsKKwkJCWxvY2Fscy0+RFNDQ0xLUmVxdWlyZWRNb3JlVGhhblN1cHBv
cnRlZFtpXSA9IGZhbHNlOworCQkJaWYgKG1vZGVfbGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdb
a10gPT0gaykgeworCQkJCWlmICgobW9kZV9saWItPnZiYS5PdXRwdXRba10gPT0gZG1fZHAKKwkJ
CQkJCXx8IG1vZGVfbGliLT52YmEuT3V0cHV0W2tdID09IGRtX2VkcCkpIHsKKwkJCQkJaWYgKG1v
ZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0W2tdID09IGRtXzQyMAorCQkJCQkJCXx8IG1vZGVfbGli
LT52YmEuT3V0cHV0Rm9ybWF0W2tdCisJCQkJCQkJCQk9PSBkbV9uNDIyKSB7CisJCQkJCQltb2Rl
X2xpYi0+dmJhLkRTQ0Zvcm1hdEZhY3RvciA9IDI7CisJCQkJCX0gZWxzZSB7CisJCQkJCQltb2Rl
X2xpYi0+dmJhLkRTQ0Zvcm1hdEZhY3RvciA9IDE7CisJCQkJCX0KKwkJCQkJaWYgKGxvY2Fscy0+
UmVxdWlyZXNEU0NbaV1ba10gPT0gdHJ1ZSkgeworCQkJCQkJaWYgKGxvY2Fscy0+T0RNQ29tYmlu
ZUVuYWJsZVBlclN0YXRlW2ldW2tdCisJCQkJCQkJCT09IHRydWUpIHsKKwkJCQkJCQlpZiAobW9k
ZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtrXSAvIDYuMCAvIG1vZGVfbGliLT52YmEuRFND
Rm9ybWF0RmFjdG9yCisJCQkJCQkJCQk+ICgxLjAgLSBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBD
TEtEU0NDTEtEb3duU3ByZWFkaW5nIC8gMTAwLjApICogbW9kZV9saWItPnZiYS5NYXhEU0NDTEtb
aV0pIHsKKwkJCQkJCQkJbG9jYWxzLT5EU0NDTEtSZXF1aXJlZE1vcmVUaGFuU3VwcG9ydGVkW2ld
ID0KKwkJCQkJCQkJCQl0cnVlOworCQkJCQkJCX0KKwkJCQkJCX0gZWxzZSB7CisJCQkJCQkJaWYg
KG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja0JhY2tFbmRba10gLyAzLjAgLyBtb2RlX2xpYi0+dmJh
LkRTQ0Zvcm1hdEZhY3RvcgorCQkJCQkJCQkJPiAoMS4wIC0gbW9kZV9saWItPnZiYS5ESVNQQ0xL
RFBQQ0xLRFNDQ0xLRG93blNwcmVhZGluZyAvIDEwMC4wKSAqIG1vZGVfbGliLT52YmEuTWF4RFND
Q0xLW2ldKSB7CisJCQkJCQkJCWxvY2Fscy0+RFNDQ0xLUmVxdWlyZWRNb3JlVGhhblN1cHBvcnRl
ZFtpXSA9CisJCQkJCQkJCQkJdHJ1ZTsKKwkJCQkJCQl9CisJCQkJCQl9CisJCQkJCX0KKwkJCQl9
CisJCQl9CisJCX0KKwl9CisJZm9yIChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJhLnNvYy5udW1f
c3RhdGVzOyBpKyspIHsKKwkJbG9jYWxzLT5Ob3RFbm91Z2hEU0NVbml0c1tpXSA9IGZhbHNlOwor
CQltb2RlX2xpYi0+dmJhLlRvdGFsRFNDVW5pdHNSZXF1aXJlZCA9IDAuMDsKKwkJZm9yIChrID0g
MDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJ
CQlpZiAobG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9PSB0cnVlKSB7CisJCQkJaWYgKGxvY2Fs
cy0+T0RNQ29tYmluZUVuYWJsZVBlclN0YXRlW2ldW2tdID09IHRydWUpIHsKKwkJCQkJbW9kZV9s
aWItPnZiYS5Ub3RhbERTQ1VuaXRzUmVxdWlyZWQgPQorCQkJCQkJCW1vZGVfbGliLT52YmEuVG90
YWxEU0NVbml0c1JlcXVpcmVkICsgMi4wOworCQkJCX0gZWxzZSB7CisJCQkJCW1vZGVfbGliLT52
YmEuVG90YWxEU0NVbml0c1JlcXVpcmVkID0KKwkJCQkJCQltb2RlX2xpYi0+dmJhLlRvdGFsRFND
VW5pdHNSZXF1aXJlZCArIDEuMDsKKwkJCQl9CisJCQl9CisJCX0KKwkJaWYgKG1vZGVfbGliLT52
YmEuVG90YWxEU0NVbml0c1JlcXVpcmVkID4gbW9kZV9saWItPnZiYS5OdW1iZXJPZkRTQykgewor
CQkJbG9jYWxzLT5Ob3RFbm91Z2hEU0NVbml0c1tpXSA9IHRydWU7CisJCX0KKwl9CisJLypEU0Mg
RGVsYXkgcGVyIHN0YXRlKi8KKworCWZvciAoaSA9IDA7IGkgPD0gbW9kZV9saWItPnZiYS5zb2Mu
bnVtX3N0YXRlczsgaSsrKSB7CisJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1i
ZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJaWYgKG1vZGVfbGliLT52YmEuQmxlbmRp
bmdBbmRUaW1pbmdba10gIT0gaykgeworCQkJCW1vZGVfbGliLT52YmEuc2xpY2VzID0gMDsKKwkJ
CX0gZWxzZSBpZiAobG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9PSAwCisJCQkJCXx8IGxvY2Fs
cy0+UmVxdWlyZXNEU0NbaV1ba10gPT0gZmFsc2UpIHsKKwkJCQltb2RlX2xpYi0+dmJhLnNsaWNl
cyA9IDA7CisJCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja0JhY2tFbmRba10g
PiAzMjAwLjApIHsKKwkJCQltb2RlX2xpYi0+dmJhLnNsaWNlcyA9IGRtbF9jZWlsKAorCQkJCQkJ
bW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtrXSAvIDQwMC4wLAorCQkJCQkJNC4wKTsK
KwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtrXSA+IDEzNjAu
MCkgeworCQkJCW1vZGVfbGliLT52YmEuc2xpY2VzID0gOC4wOworCQkJfSBlbHNlIGlmIChtb2Rl
X2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNrRW5kW2tdID4gNjgwLjApIHsKKwkJCQltb2RlX2xpYi0+
dmJhLnNsaWNlcyA9IDQuMDsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5QaXhlbENsb2Nr
QmFja0VuZFtrXSA+IDM0MC4wKSB7CisJCQkJbW9kZV9saWItPnZiYS5zbGljZXMgPSAyLjA7CisJ
CQl9IGVsc2UgeworCQkJCW1vZGVfbGliLT52YmEuc2xpY2VzID0gMS4wOworCQkJfQorCQkJaWYg
KGxvY2Fscy0+T3V0cHV0QnBwUGVyU3RhdGVbaV1ba10gPT0gQlBQX0JMRU5ERURfUElQRQorCQkJ
CQl8fCBsb2NhbHMtPk91dHB1dEJwcFBlclN0YXRlW2ldW2tdID09IEJQUF9JTlZBTElEKSB7CisJ
CQkJbW9kZV9saWItPnZiYS5icHAgPSAwLjA7CisJCQl9IGVsc2UgeworCQkJCW1vZGVfbGliLT52
YmEuYnBwID0gbG9jYWxzLT5PdXRwdXRCcHBQZXJTdGF0ZVtpXVtrXTsKKwkJCX0KKwkJCWlmIChs
b2NhbHMtPlJlcXVpcmVzRFNDW2ldW2tdID09IHRydWUgJiYgbW9kZV9saWItPnZiYS5icHAgIT0g
MC4wKSB7CisJCQkJaWYgKGxvY2Fscy0+T0RNQ29tYmluZUVuYWJsZVBlclN0YXRlW2ldW2tdID09
IGZhbHNlKSB7CisJCQkJCWxvY2Fscy0+RFNDRGVsYXlQZXJTdGF0ZVtpXVtrXSA9CisJCQkJCQkJ
ZHNjY2VDb21wdXRlRGVsYXkoCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVy
Q29tcG9uZW50W2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5icHAsCisJCQkJCQkJCQlkbWxf
Y2VpbCgKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IQWN0aXZlW2tdCisJCQkJCQkJCQkJCQkJ
LyBtb2RlX2xpYi0+dmJhLnNsaWNlcywKKwkJCQkJCQkJCQkJMS4wKSwKKwkJCQkJCQkJCW1vZGVf
bGliLT52YmEuc2xpY2VzLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10p
CisJCQkJCQkJCQkrIGRzY0NvbXB1dGVEZWxheSgKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5P
dXRwdXRGb3JtYXRba10pOworCQkJCX0gZWxzZSB7CisJCQkJCWxvY2Fscy0+RFNDRGVsYXlQZXJT
dGF0ZVtpXVtrXSA9CisJCQkJCQkJMi4wICogKGRzY2NlQ29tcHV0ZURlbGF5KAorCQkJCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9uZW50W2tdLAorCQkJCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLmJwcCwKKwkJCQkJCQkJCQkJZG1sX2NlaWwobW9kZV9saWItPnZiYS5IQWN0
aXZlW2tdIC8gbW9kZV9saWItPnZiYS5zbGljZXMsIDEuMCksCisJCQkJCQkJCQkJCW1vZGVfbGli
LT52YmEuc2xpY2VzIC8gMiwKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRb
a10pCisJCQkJCQkJCQkrIGRzY0NvbXB1dGVEZWxheShtb2RlX2xpYi0+dmJhLk91dHB1dEZvcm1h
dFtrXSkpOworCQkJCX0KKwkJCQlsb2NhbHMtPkRTQ0RlbGF5UGVyU3RhdGVbaV1ba10gPQorCQkJ
CQkJbG9jYWxzLT5EU0NEZWxheVBlclN0YXRlW2ldW2tdICogbW9kZV9saWItPnZiYS5QaXhlbENs
b2NrW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtrXTsKKwkJCX0gZWxzZSB7
CisJCQkJbG9jYWxzLT5EU0NEZWxheVBlclN0YXRlW2ldW2tdID0gMC4wOworCQkJfQorCQl9CisJ
CWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7
IGsrKykgeworCQkJZm9yIChtID0gMDsgbSA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZl
UGxhbmVzIC0gMTsgbSsrKSB7CisJCQkJZm9yIChqID0gMDsgaiA8PSBtb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaisrKSB7CisJCQkJCWlmIChtb2RlX2xpYi0+dmJhLkJs
ZW5kaW5nQW5kVGltaW5nW2tdID09IG0gJiYgbG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVttXSA9PSB0
cnVlKQorCQkJCQkJbG9jYWxzLT5EU0NEZWxheVBlclN0YXRlW2ldW2tdID0gbG9jYWxzLT5EU0NE
ZWxheVBlclN0YXRlW2ldW21dOworCQkJCX0KKwkJCX0KKwkJfQorCX0KKworCS8vUHJlZmV0Y2gg
Q2hlY2sKKwlmb3IgKGkgPSAwOyBpIDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7ICsr
aSkgeworCQlmb3IgKGogPSAwOyBqIDw9IDE7ICsraikgeworCQkJbG9jYWxzLT5Ub3RhbE51bWJl
ck9mRENDQWN0aXZlRFBQW2ldW2pdID0gMDsKKwkJCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+
dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJCQlpZiAobW9kZV9saWItPnZiYS5E
Q0NFbmFibGVba10gPT0gdHJ1ZSkKKwkJCQkJbG9jYWxzLT5Ub3RhbE51bWJlck9mRENDQWN0aXZl
RFBQW2ldW2pdID0gbG9jYWxzLT5Ub3RhbE51bWJlck9mRENDQWN0aXZlRFBQW2ldW2pdICsgbG9j
YWxzLT5Ob09mRFBQW2ldW2pdW2tdOworCQkJfQorCQl9CisJfQorCisJbW9kZV9saWItPnZiYS5V
cmdlbnRMYXRlbmN5ID0gZG1sX21heDMoCisJCQltb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3lQ
aXhlbERhdGFPbmx5LAorCQkJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5UGl4ZWxNaXhlZFdp
dGhWTURhdGEsCisJCQltb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3lWTURhdGFPbmx5KTsKKwlt
b2RlX2xpYi0+dmJhLlByZWZldGNoRVJST1IgPSBDYWxjdWxhdGVNaW5BbmRNYXhQcmVmZXRjaE1v
ZGUoCisJCQltb2RlX2xpYi0+dmJhLkFsbG93RFJBTVNlbGZSZWZyZXNoT3JEUkFNQ2xvY2tDaGFu
Z2VJblZibGFuaywKKwkJCSZtb2RlX2xpYi0+dmJhLk1pblByZWZldGNoTW9kZSwKKwkJCSZtb2Rl
X2xpYi0+dmJhLk1heFByZWZldGNoTW9kZSk7CisKKwlmb3IgKGkgPSAwOyBpIDw9IG1vZGVfbGli
LT52YmEuc29jLm51bV9zdGF0ZXM7IGkrKykgeworCQlmb3IgKGogPSAwOyBqIDwgMjsgaisrKSB7
CisJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMg
LSAxOyBrKyspIHsKKwkJCQlsb2NhbHMtPlJlcXVpcmVkRFBQQ0xLVGhpc1N0YXRlW2tdID0gbG9j
YWxzLT5SZXF1aXJlZERQUENMS1tpXVtqXVtrXTsKKwkJCQlsb2NhbHMtPk5vT2ZEUFBUaGlzU3Rh
dGVba10gICAgICAgID0gbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdOworCQkJCWlmIChsb2NhbHMt
Pk9ETUNvbWJpbmVFbmFibGVQZXJTdGF0ZVtpXVtrXSA9PSB0cnVlKSB7CisJCQkJCWxvY2Fscy0+
U3dhdGhXaWR0aFlUaGlzU3RhdGVba10gPQorCQkJCQkJZG1sX21pbihsb2NhbHMtPlN3YXRoV2lk
dGhZU2luZ2xlRFBQW2tdLCBkbWxfcm91bmQobW9kZV9saWItPnZiYS5IQWN0aXZlW2tdIC8gMi4w
ICogbW9kZV9saWItPnZiYS5IUmF0aW9ba10pKTsKKwkJCQl9IGVsc2UgeworCQkJCQlsb2NhbHMt
PlN3YXRoV2lkdGhZVGhpc1N0YXRlW2tdID0gbG9jYWxzLT5Td2F0aFdpZHRoWVNpbmdsZURQUFtr
XSAvIGxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXTsKKwkJCQl9CisJCQkJbW9kZV9saWItPnZiYS5T
d2F0aFdpZHRoR3JhbnVsYXJpdHlZID0gMjU2LjAKKwkJCQkJLyBkbWxfY2VpbChsb2NhbHMtPkJ5
dGVQZXJQaXhlbEluREVUWVtrXSwgMS4wKQorCQkJCQkvIGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRZ
W2tdOworCQkJCW1vZGVfbGliLT52YmEuUm91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNZID0KKwkJ
CQkJKGRtbF9jZWlsKGxvY2Fscy0+U3dhdGhXaWR0aFlUaGlzU3RhdGVba10gLSAxLjAsIG1vZGVf
bGliLT52YmEuU3dhdGhXaWR0aEdyYW51bGFyaXR5WSkKKwkJCQkJKyBtb2RlX2xpYi0+dmJhLlN3
YXRoV2lkdGhHcmFudWxhcml0eVkpICogbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10gKiBs
b2NhbHMtPk1heFN3YXRoSGVpZ2h0WVtrXTsKKwkJCQlpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQ
aXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfMTApIHsKKwkJCQkJbW9kZV9saWItPnZiYS5Sb3VuZGVk
VXBNYXhTd2F0aFNpemVCeXRlc1kgPSBkbWxfY2VpbCgKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlJv
dW5kZWRVcE1heFN3YXRoU2l6ZUJ5dGVzWSwKKwkJCQkJCQkyNTYuMCkgKyAyNTY7CisJCQkJfQor
CQkJCWlmIChsb2NhbHMtPk1heFN3YXRoSGVpZ2h0Q1trXSA+IDAuMCkgeworCQkJCQltb2RlX2xp
Yi0+dmJhLlN3YXRoV2lkdGhHcmFudWxhcml0eUMgPSAyNTYuMCAvIGRtbF9jZWlsKGxvY2Fscy0+
Qnl0ZVBlclBpeGVsSW5ERVRDW2tdLCAyLjApIC8gbG9jYWxzLT5NYXhTd2F0aEhlaWdodENba107
CisJCQkJCW1vZGVfbGliLT52YmEuUm91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNDID0gKGRtbF9j
ZWlsKGxvY2Fscy0+U3dhdGhXaWR0aFlUaGlzU3RhdGVba10gLyAyLjAgLSAxLjAsIG1vZGVfbGli
LT52YmEuU3dhdGhXaWR0aEdyYW51bGFyaXR5QykKKwkJCQkJCQkrIG1vZGVfbGliLT52YmEuU3dh
dGhXaWR0aEdyYW51bGFyaXR5QykgKiBsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSAqIGxv
Y2Fscy0+TWF4U3dhdGhIZWlnaHRDW2tdOworCQkJCQlpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQ
aXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfMTApIHsKKwkJCQkJCW1vZGVfbGliLT52YmEuUm91bmRl
ZFVwTWF4U3dhdGhTaXplQnl0ZXNDID0gZG1sX2NlaWwobW9kZV9saWItPnZiYS5Sb3VuZGVkVXBN
YXhTd2F0aFNpemVCeXRlc0MsIDI1Ni4wKSArIDI1NjsKKwkJCQkJfQorCQkJCX0gZWxzZSB7CisJ
CQkJCW1vZGVfbGliLT52YmEuUm91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNDID0gMC4wOworCQkJ
CX0KKwkJCQlpZiAobW9kZV9saWItPnZiYS5Sb3VuZGVkVXBNYXhTd2F0aFNpemVCeXRlc1kgKyBt
b2RlX2xpYi0+dmJhLlJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5dGVzQworCQkJCQkJPD0gbW9kZV9s
aWItPnZiYS5ERVRCdWZmZXJTaXplSW5LQnl0ZSAqIDEwMjQuMCAvIDIuMCkgeworCQkJCQlsb2Nh
bHMtPlN3YXRoSGVpZ2h0WVRoaXNTdGF0ZVtrXSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRZW2td
OworCQkJCQlsb2NhbHMtPlN3YXRoSGVpZ2h0Q1RoaXNTdGF0ZVtrXSA9IGxvY2Fscy0+TWF4U3dh
dGhIZWlnaHRDW2tdOworCQkJCX0gZWxzZSB7CisJCQkJCWxvY2Fscy0+U3dhdGhIZWlnaHRZVGhp
c1N0YXRlW2tdID0KKwkJCQkJCQlsb2NhbHMtPk1pblN3YXRoSGVpZ2h0WVtrXTsKKwkJCQkJbG9j
YWxzLT5Td2F0aEhlaWdodENUaGlzU3RhdGVba10gPQorCQkJCQkJCWxvY2Fscy0+TWluU3dhdGhI
ZWlnaHRDW2tdOworCQkJCX0KKwkJCX0KKworCQkJQ2FsY3VsYXRlRENGQ0xLRGVlcFNsZWVwKAor
CQkJCQltb2RlX2xpYiwKKwkJCQkJbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcywK
KwkJCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFksCisJCQkJCWxvY2Fscy0+Qnl0ZVBlclBp
eGVsSW5ERVRDLAorCQkJCQltb2RlX2xpYi0+dmJhLlZSYXRpbywKKwkJCQkJbG9jYWxzLT5Td2F0
aFdpZHRoWVRoaXNTdGF0ZSwKKwkJCQkJbG9jYWxzLT5Ob09mRFBQVGhpc1N0YXRlLAorCQkJCQlt
b2RlX2xpYi0+dmJhLkhSYXRpbywKKwkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrLAorCQkJ
CQlsb2NhbHMtPlBTQ0xfRkFDVE9SLAorCQkJCQlsb2NhbHMtPlBTQ0xfRkFDVE9SX0NIUk9NQSwK
KwkJCQkJbG9jYWxzLT5SZXF1aXJlZERQUENMS1RoaXNTdGF0ZSwKKwkJCQkJJm1vZGVfbGliLT52
YmEuUHJvamVjdGVkRENGQ0xLRGVlcFNsZWVwKTsKKworCQkJZm9yIChrID0gMDsgayA8PSBtb2Rl
X2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJaWYgKChtb2Rl
X2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQ0NF82NAorCQkJCQkJJiYgbW9k
ZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80NDRfMzIKKwkJCQkJCSYmIG1v
ZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzE2CisJCQkJCQkmJiBt
b2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtX21vbm9fMTYKKwkJCQkJCSYm
IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fbW9ub184KSkgeworCQkJ
CQltb2RlX2xpYi0+dmJhLlBERUFuZE1ldGFQVEVCeXRlc1BlckZyYW1lQyA9IENhbGN1bGF0ZVZN
QW5kUm93Qnl0ZXMoCisJCQkJCQkJbW9kZV9saWIsCisJCQkJCQkJbW9kZV9saWItPnZiYS5EQ0NF
bmFibGVba10sCisJCQkJCQkJbG9jYWxzLT5SZWFkMjU2QmxvY2tIZWlnaHRDW2tdLAorCQkJCQkJ
CWxvY2Fscy0+UmVhZDI1NkJsb2NrV2lkdGhDW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuU291
cmNlUGl4ZWxGb3JtYXRba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2td
LAorCQkJCQkJCWRtbF9jZWlsKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRDW2tdLCAyLjApLAor
CQkJCQkJCW1vZGVfbGliLT52YmEuU291cmNlU2NhbltrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJh
LlZpZXdwb3J0V2lkdGhba10gLyAyLjAsCisJCQkJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydEhl
aWdodFtrXSAvIDIuMCwKKwkJCQkJCQlsb2NhbHMtPlN3YXRoV2lkdGhZVGhpc1N0YXRlW2tdIC8g
Mi4wLAorCQkJCQkJCW1vZGVfbGliLT52YmEuR1BVVk1FbmFibGUsCisJCQkJCQkJbW9kZV9saWIt
PnZiYS5Ib3N0Vk1FbmFibGUsCisJCQkJCQkJbW9kZV9saWItPnZiYS5Ib3N0Vk1NYXhQYWdlVGFi
bGVMZXZlbHMsCisJCQkJCQkJbW9kZV9saWItPnZiYS5Ib3N0Vk1DYWNoZWRQYWdlVGFibGVMZXZl
bHMsCisJCQkJCQkJbW9kZV9saWItPnZiYS5WTU1QYWdlU2l6ZSwKKwkJCQkJCQltb2RlX2xpYi0+
dmJhLlBURUJ1ZmZlclNpemVJblJlcXVlc3RzQ2hyb21hLAorCQkJCQkJCW1vZGVfbGliLT52YmEu
UGl0Y2hDW2tdLAorCQkJCQkJCTAuMCwKKwkJCQkJCQkmbG9jYWxzLT5NYWNyb1RpbGVXaWR0aENb
a10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEuTWV0YVJvd0J5dGVzQywKKwkJCQkJCQkmbW9kZV9s
aWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dDLAorCQkJCQkJCSZsb2NhbHMtPlBURUJ1ZmZlclNpemVO
b3RFeGNlZWRlZENbaV1bal1ba10sCisJCQkJCQkJbG9jYWxzLT5kcHRlX3Jvd193aWR0aF9jaHJv
bWFfdWIsCisJCQkJCQkJJmxvY2Fscy0+ZHB0ZV9yb3dfaGVpZ2h0X2Nocm9tYVtrXSwKKwkJCQkJ
CQkmbG9jYWxzLT5tZXRhX3JlcV93aWR0aF9jaHJvbWFba10sCisJCQkJCQkJJmxvY2Fscy0+bWV0
YV9yZXFfaGVpZ2h0X2Nocm9tYVtrXSwKKwkJCQkJCQkmbG9jYWxzLT5tZXRhX3Jvd193aWR0aF9j
aHJvbWFba10sCisJCQkJCQkJJmxvY2Fscy0+bWV0YV9yb3dfaGVpZ2h0X2Nocm9tYVtrXSwKKwkJ
CQkJCQkmbG9jYWxzLT52bV9ncm91cF9ieXRlc19jaHJvbWEsCisJCQkJCQkJJmxvY2Fscy0+ZHB0
ZV9ncm91cF9ieXRlc19jaHJvbWEsCisJCQkJCQkJbG9jYWxzLT5QaXhlbFBURVJlcVdpZHRoQywK
KwkJCQkJCQlsb2NhbHMtPlBpeGVsUFRFUmVxSGVpZ2h0QywKKwkJCQkJCQlsb2NhbHMtPlBURVJl
cXVlc3RTaXplQywKKwkJCQkJCQlsb2NhbHMtPmRwZGUwX2J5dGVzX3Blcl9mcmFtZV91Yl9jLAor
CQkJCQkJCWxvY2Fscy0+bWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1lX3ViX2MpOworCQkJCQlsb2Nh
bHMtPlByZWZldGNoTGluZXNDW2tdID0gQ2FsY3VsYXRlUHJlZmV0Y2hTb3VyY2VMaW5lcygKKwkJ
CQkJCQltb2RlX2xpYiwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZSYXRpb1trXS8yLAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuVlRBUHNDaHJvbWFba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5JbnRl
cmxhY2Vba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5Qcm9ncmVzc2l2ZVRvSW50ZXJsYWNlVW5p
dEluT1BQLAorCQkJCQkJCWxvY2Fscy0+U3dhdGhIZWlnaHRDVGhpc1N0YXRlW2tdLAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuVmlld3BvcnRZU3RhcnRDW2tdLAorCQkJCQkJCSZsb2NhbHMtPlByZWZp
bGxDW2tdLAorCQkJCQkJCSZsb2NhbHMtPk1heE51bVN3Q1trXSk7CisJCQkJCWxvY2Fscy0+UFRF
QnVmZmVyU2l6ZUluUmVxdWVzdHNGb3JMdW1hID0gbW9kZV9saWItPnZiYS5QVEVCdWZmZXJTaXpl
SW5SZXF1ZXN0c0x1bWE7CisJCQkJfSBlbHNlIHsKKwkJCQkJbW9kZV9saWItPnZiYS5QREVBbmRN
ZXRhUFRFQnl0ZXNQZXJGcmFtZUMgPSAwLjA7CisJCQkJCW1vZGVfbGliLT52YmEuTWV0YVJvd0J5
dGVzQyA9IDAuMDsKKwkJCQkJbW9kZV9saWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dDID0gMC4wOwor
CQkJCQlsb2NhbHMtPlByZWZldGNoTGluZXNDW2tdID0gMC4wOworCQkJCQlsb2NhbHMtPlBURUJ1
ZmZlclNpemVOb3RFeGNlZWRlZENbaV1bal1ba10gPSB0cnVlOworCQkJCQlsb2NhbHMtPlBURUJ1
ZmZlclNpemVJblJlcXVlc3RzRm9yTHVtYSA9IG1vZGVfbGliLT52YmEuUFRFQnVmZmVyU2l6ZUlu
UmVxdWVzdHNMdW1hICsgbW9kZV9saWItPnZiYS5QVEVCdWZmZXJTaXplSW5SZXF1ZXN0c0Nocm9t
YTsKKwkJCQl9CisJCQkJbW9kZV9saWItPnZiYS5QREVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFtZVkg
PSBDYWxjdWxhdGVWTUFuZFJvd0J5dGVzKAorCQkJCQkJbW9kZV9saWIsCisJCQkJCQltb2RlX2xp
Yi0+dmJhLkRDQ0VuYWJsZVtrXSwKKwkJCQkJCWxvY2Fscy0+UmVhZDI1NkJsb2NrSGVpZ2h0WVtr
XSwKKwkJCQkJCWxvY2Fscy0+UmVhZDI1NkJsb2NrV2lkdGhZW2tdLAorCQkJCQkJbW9kZV9saWIt
PnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuU3VyZmFjZVRp
bGluZ1trXSwKKwkJCQkJCWRtbF9jZWlsKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdLCAx
LjApLAorCQkJCQkJbW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdLAorCQkJCQkJbW9kZV9saWIt
PnZiYS5WaWV3cG9ydFdpZHRoW2tdLAorCQkJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydEhlaWdo
dFtrXSwKKwkJCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFlUaGlzU3RhdGVba10sCisJCQkJCQltb2Rl
X2xpYi0+dmJhLkdQVVZNRW5hYmxlLAorCQkJCQkJbW9kZV9saWItPnZiYS5Ib3N0Vk1FbmFibGUs
CisJCQkJCQltb2RlX2xpYi0+dmJhLkhvc3RWTU1heFBhZ2VUYWJsZUxldmVscywKKwkJCQkJCW1v
ZGVfbGliLT52YmEuSG9zdFZNQ2FjaGVkUGFnZVRhYmxlTGV2ZWxzLAorCQkJCQkJbW9kZV9saWIt
PnZiYS5WTU1QYWdlU2l6ZSwKKwkJCQkJCWxvY2Fscy0+UFRFQnVmZmVyU2l6ZUluUmVxdWVzdHNG
b3JMdW1hLAorCQkJCQkJbW9kZV9saWItPnZiYS5QaXRjaFlba10sCisJCQkJCQltb2RlX2xpYi0+
dmJhLkRDQ01ldGFQaXRjaFlba10sCisJCQkJCQkmbG9jYWxzLT5NYWNyb1RpbGVXaWR0aFlba10s
CisJCQkJCQkmbW9kZV9saWItPnZiYS5NZXRhUm93Qnl0ZXNZLAorCQkJCQkJJm1vZGVfbGliLT52
YmEuRFBURUJ5dGVzUGVyUm93WSwKKwkJCQkJCSZsb2NhbHMtPlBURUJ1ZmZlclNpemVOb3RFeGNl
ZWRlZFlbaV1bal1ba10sCisJCQkJCQlsb2NhbHMtPmRwdGVfcm93X3dpZHRoX2x1bWFfdWIsCisJ
CQkJCQkmbG9jYWxzLT5kcHRlX3Jvd19oZWlnaHRba10sCisJCQkJCQkmbG9jYWxzLT5tZXRhX3Jl
cV93aWR0aFtrXSwKKwkJCQkJCSZsb2NhbHMtPm1ldGFfcmVxX2hlaWdodFtrXSwKKwkJCQkJCSZs
b2NhbHMtPm1ldGFfcm93X3dpZHRoW2tdLAorCQkJCQkJJmxvY2Fscy0+bWV0YV9yb3dfaGVpZ2h0
W2tdLAorCQkJCQkJJmxvY2Fscy0+dm1fZ3JvdXBfYnl0ZXNba10sCisJCQkJCQkmbG9jYWxzLT5k
cHRlX2dyb3VwX2J5dGVzW2tdLAorCQkJCQkJbG9jYWxzLT5QaXhlbFBURVJlcVdpZHRoWSwKKwkJ
CQkJCWxvY2Fscy0+UGl4ZWxQVEVSZXFIZWlnaHRZLAorCQkJCQkJbG9jYWxzLT5QVEVSZXF1ZXN0
U2l6ZVksCisJCQkJCQlsb2NhbHMtPmRwZGUwX2J5dGVzX3Blcl9mcmFtZV91Yl9sLAorCQkJCQkJ
bG9jYWxzLT5tZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWJfbCk7CisJCQkJbG9jYWxzLT5QcmVm
ZXRjaExpbmVzWVtrXSA9IENhbGN1bGF0ZVByZWZldGNoU291cmNlTGluZXMoCisJCQkJCQltb2Rl
X2xpYiwKKwkJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCQkJbW9kZV9saWItPnZi
YS52dGFwc1trXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuSW50ZXJsYWNlW2tdLAorCQkJCQkJbW9k
ZV9saWItPnZiYS5Qcm9ncmVzc2l2ZVRvSW50ZXJsYWNlVW5pdEluT1BQLAorCQkJCQkJbG9jYWxz
LT5Td2F0aEhlaWdodFlUaGlzU3RhdGVba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0
WVN0YXJ0WVtrXSwKKwkJCQkJCSZsb2NhbHMtPlByZWZpbGxZW2tdLAorCQkJCQkJJmxvY2Fscy0+
TWF4TnVtU3dZW2tdKTsKKwkJCQlsb2NhbHMtPlBERUFuZE1ldGFQVEVCeXRlc1BlckZyYW1lW2td
ID0KKwkJCQkJCW1vZGVfbGliLT52YmEuUERFQW5kTWV0YVBURUJ5dGVzUGVyRnJhbWVZICsgbW9k
ZV9saWItPnZiYS5QREVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFtZUM7CisJCQkJbG9jYWxzLT5NZXRh
Um93Qnl0ZXNba10gPSBtb2RlX2xpYi0+dmJhLk1ldGFSb3dCeXRlc1kgKyBtb2RlX2xpYi0+dmJh
Lk1ldGFSb3dCeXRlc0M7CisJCQkJbG9jYWxzLT5EUFRFQnl0ZXNQZXJSb3dba10gPSBtb2RlX2xp
Yi0+dmJhLkRQVEVCeXRlc1BlclJvd1kgKyBtb2RlX2xpYi0+dmJhLkRQVEVCeXRlc1BlclJvd0M7
CisKKwkJCQlDYWxjdWxhdGVBY3RpdmVSb3dCYW5kd2lkdGgoCisJCQkJCQltb2RlX2xpYi0+dmJh
LkdQVVZNRW5hYmxlLAorCQkJCQkJbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSwK
KwkJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCQkJbW9kZV9saWItPnZiYS5EQ0NF
bmFibGVba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvCisJCQkJCQltb2RlX2xp
Yi0+dmJhLlBpeGVsQ2xvY2tba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLk1ldGFSb3dCeXRlc1ks
CisJCQkJCQltb2RlX2xpYi0+dmJhLk1ldGFSb3dCeXRlc0MsCisJCQkJCQlsb2NhbHMtPm1ldGFf
cm93X2hlaWdodFtrXSwKKwkJCQkJCWxvY2Fscy0+bWV0YV9yb3dfaGVpZ2h0X2Nocm9tYVtrXSwK
KwkJCQkJCW1vZGVfbGliLT52YmEuRFBURUJ5dGVzUGVyUm93WSwKKwkJCQkJCW1vZGVfbGliLT52
YmEuRFBURUJ5dGVzUGVyUm93QywKKwkJCQkJCWxvY2Fscy0+ZHB0ZV9yb3dfaGVpZ2h0W2tdLAor
CQkJCQkJbG9jYWxzLT5kcHRlX3Jvd19oZWlnaHRfY2hyb21hW2tdLAorCQkJCQkJJmxvY2Fscy0+
bWV0YV9yb3dfYndba10sCisJCQkJCQkmbG9jYWxzLT5kcHRlX3Jvd19id1trXSk7CisJCQl9CisJ
CQltb2RlX2xpYi0+dmJhLkV4dHJhTGF0ZW5jeSA9IENhbGN1bGF0ZUV4dHJhTGF0ZW5jeSgKKwkJ
CQkJbG9jYWxzLT5VcmdlbnRSb3VuZFRyaXBBbmRPdXRPZk9yZGVyTGF0ZW5jeVBlclN0YXRlW2ld
LAorCQkJCQlsb2NhbHMtPlRvdGFsTnVtYmVyT2ZBY3RpdmVEUFBbaV1bal0sCisJCQkJCW1vZGVf
bGliLT52YmEuUGl4ZWxDaHVua1NpemVJbktCeXRlLAorCQkJCQlsb2NhbHMtPlRvdGFsTnVtYmVy
T2ZEQ0NBY3RpdmVEUFBbaV1bal0sCisJCQkJCW1vZGVfbGliLT52YmEuTWV0YUNodW5rU2l6ZSwK
KwkJCQkJbG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldLAorCQkJCQltb2RlX2xpYi0+dmJhLkdQ
VVZNRW5hYmxlLAorCQkJCQltb2RlX2xpYi0+dmJhLkhvc3RWTUVuYWJsZSwKKwkJCQkJbW9kZV9s
aWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcywKKwkJCQkJbG9jYWxzLT5Ob09mRFBQVGhpc1N0
YXRlLAorCQkJCQlsb2NhbHMtPmRwdGVfZ3JvdXBfYnl0ZXMsCisJCQkJCW1vZGVfbGliLT52YmEu
UGVyY2VudE9mSWRlYWxEUkFNRmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRlclVyZ0xhdGVu
Y3lQaXhlbE1peGVkV2l0aFZNRGF0YSwKKwkJCQkJbW9kZV9saWItPnZiYS5QZXJjZW50T2ZJZGVh
bERSQU1GYWJyaWNBbmRTRFBQb3J0QldSZWNlaXZlZEFmdGVyVXJnTGF0ZW5jeVZNRGF0YU9ubHks
CisJCQkJCW1vZGVfbGliLT52YmEuSG9zdFZNTWF4UGFnZVRhYmxlTGV2ZWxzLAorCQkJCQltb2Rl
X2xpYi0+dmJhLkhvc3RWTUNhY2hlZFBhZ2VUYWJsZUxldmVscyk7CisKKwkJCW1vZGVfbGliLT52
YmEuVGltZUNhbGMgPSAyNC4wIC8gbW9kZV9saWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtEZWVwU2xl
ZXA7CisJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFu
ZXMgLSAxOyBrKyspIHsKKwkJCQlpZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1tr
XSA9PSBrKSB7CisJCQkJCWlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9PSB0
cnVlKSB7CisJCQkJCQlsb2NhbHMtPldyaXRlYmFja0RlbGF5W2ldW2tdID0gbW9kZV9saWItPnZi
YS5Xcml0ZWJhY2tMYXRlbmN5CisJCQkJCQkJCSsgQ2FsY3VsYXRlV3JpdGVCYWNrRGVsYXkoCisJ
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSwKKwkJCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0hSYXRpb1trXSwKKwkJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLldyaXRlYmFja1ZSYXRpb1trXSwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0x1bWFIVGFwc1trXSwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFWVGFw
c1trXSwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYUhUYXBzW2tdLAor
CQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hVlRhcHNba10sCisJCQkJCQkJ
CQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoW2tdKSAvIGxvY2Fscy0+
UmVxdWlyZWRESVNQQ0xLW2ldW2pdOworCQkJCQl9IGVsc2UgeworCQkJCQkJbG9jYWxzLT5Xcml0
ZWJhY2tEZWxheVtpXVtrXSA9IDAuMDsKKwkJCQkJfQorCQkJCQlmb3IgKG0gPSAwOyBtIDw9IG1v
ZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBtKyspIHsKKwkJCQkJCWlmICht
b2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW21dID09IGsKKwkJCQkJCQkJJiYgbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tFbmFibGVbbV0KKwkJCQkJCQkJCQk9PSB0cnVlKSB7CisJCQkJCQkJ
bG9jYWxzLT5Xcml0ZWJhY2tEZWxheVtpXVtrXSA9IGRtbF9tYXgobG9jYWxzLT5Xcml0ZWJhY2tE
ZWxheVtpXVtrXSwKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMYXRlbmN5ICsg
Q2FsY3VsYXRlV3JpdGVCYWNrRGVsYXkoCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0
ZWJhY2tQaXhlbEZvcm1hdFttXSwKKwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0hSYXRpb1ttXSwKKwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja1ZSYXRpb1tt
XSwKKwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFIVGFwc1ttXSwKKwkJ
CQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFWVGFwc1ttXSwKKwkJCQkJCQkJ
CQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYUhUYXBzW21dLAorCQkJCQkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hVlRhcHNbbV0sCisJCQkJCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoW21dKSAvIGxvY2Fscy0+UmVxdWly
ZWRESVNQQ0xLW2ldW2pdKTsKKwkJCQkJCX0KKwkJCQkJfQorCQkJCX0KKwkJCX0KKwkJCWZvciAo
ayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykg
eworCQkJCWZvciAobSA9IDA7IG0gPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5l
cyAtIDE7IG0rKykgeworCQkJCQlpZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1tr
XSA9PSBtKSB7CisJCQkJCQlsb2NhbHMtPldyaXRlYmFja0RlbGF5W2ldW2tdID0gbG9jYWxzLT5X
cml0ZWJhY2tEZWxheVtpXVttXTsKKwkJCQkJfQorCQkJCX0KKwkJCX0KKwkJCW1vZGVfbGliLT52
YmEuTWF4TWF4VlN0YXJ0dXAgPSAwOworCQkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJbG9jYWxzLT5NYXhpbXVtVlN0
YXJ0dXBba10gPSBtb2RlX2xpYi0+dmJhLlZUb3RhbFtrXSAtIG1vZGVfbGliLT52YmEuVkFjdGl2
ZVtrXQorCQkJCQktIGRtbF9tYXgoMS4wLCBkbWxfY2VpbChsb2NhbHMtPldyaXRlYmFja0RlbGF5
W2ldW2tdIC8gKG1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENs
b2NrW2tdKSwgMS4wKSk7CisJCQkJbW9kZV9saWItPnZiYS5NYXhNYXhWU3RhcnR1cCA9IGRtbF9t
YXgobW9kZV9saWItPnZiYS5NYXhNYXhWU3RhcnR1cCwgbG9jYWxzLT5NYXhpbXVtVlN0YXJ0dXBb
a10pOworCQkJfQorCisJCQltb2RlX2xpYi0+dmJhLk5leHRQcmVmZXRjaE1vZGUgPSBtb2RlX2xp
Yi0+dmJhLk1pblByZWZldGNoTW9kZTsKKwkJCW1vZGVfbGliLT52YmEuTmV4dE1heFZTdGFydHVw
ID0gbW9kZV9saWItPnZiYS5NYXhNYXhWU3RhcnR1cDsKKwkJCWRvIHsKKwkJCQltb2RlX2xpYi0+
dmJhLlByZWZldGNoTW9kZVtpXVtqXSA9IG1vZGVfbGliLT52YmEuTmV4dFByZWZldGNoTW9kZTsK
KwkJCQltb2RlX2xpYi0+dmJhLk1heFZTdGFydHVwID0gbW9kZV9saWItPnZiYS5OZXh0TWF4VlN0
YXJ0dXA7CisKKwkJCQltb2RlX2xpYi0+dmJhLlRXYWl0ID0gQ2FsY3VsYXRlVFdhaXQoCisJCQkJ
CQltb2RlX2xpYi0+dmJhLlByZWZldGNoTW9kZVtpXVtqXSwKKwkJCQkJCW1vZGVfbGliLT52YmEu
RFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeSwKKwkJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5j
eSwKKwkJCQkJCW1vZGVfbGliLT52YmEuU1JFbnRlclBsdXNFeGl0VGltZSk7CisJCQkJZm9yIChr
ID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7
CisJCQkJCVBpcGUgbXlQaXBlOworCQkJCQlIb3N0Vk0gbXlIb3N0Vk07CisKKwkJCQkJaWYgKG1v
ZGVfbGliLT52YmEuWEZDRW5hYmxlZFtrXSA9PSB0cnVlKSB7CisJCQkJCQltb2RlX2xpYi0+dmJh
LlhGQ1JlbW90ZVN1cmZhY2VGbGlwRGVsYXkgPQorCQkJCQkJCQlDYWxjdWxhdGVSZW1vdGVTdXJm
YWNlRmxpcERlbGF5KAorCQkJCQkJCQkJCW1vZGVfbGliLAorCQkJCQkJCQkJCW1vZGVfbGliLT52
YmEuVlJhdGlvW2tdLAorCQkJCQkJCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFlUaGlzU3RhdGVba10s
CisJCQkJCQkJCQkJZG1sX2NlaWwobG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10sIDEuMCks
CisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IVG90YWxba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVs
Q2xvY2tba10sCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5YRkNUU2x2VnVwZGF0ZU9mZnNldCwK
KwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1RTbHZWdXBkYXRlV2lkdGgsCisJCQkJCQkJCQkJ
bW9kZV9saWItPnZiYS5YRkNUU2x2VnJlYWR5T2Zmc2V0LAorCQkJCQkJCQkJCW1vZGVfbGliLT52
YmEuWEZDWEJVRkxhdGVuY3lUb2xlcmFuY2UsCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5YRkNG
aWxsQldPdmVyaGVhZCwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1NsdkNodW5rU2l6ZSwK
KwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ0J1c1RyYW5zcG9ydFRpbWUsCisJCQkJCQkJCQkJ
bW9kZV9saWItPnZiYS5UaW1lQ2FsYywKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlRXYWl0LAor
CQkJCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlNyY0FjdGl2ZURyYWluUmF0ZSwKKwkJCQkJCQkJCQkm
bW9kZV9saWItPnZiYS5USW5pdFhGaWxsLAorCQkJCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlRzbHZD
aGspOworCQkJCQl9IGVsc2UgeworCQkJCQkJbW9kZV9saWItPnZiYS5YRkNSZW1vdGVTdXJmYWNl
RmxpcERlbGF5ID0gMC4wOworCQkJCQl9CisKKwkJCQkJbXlQaXBlLkRQUENMSyA9IGxvY2Fscy0+
UmVxdWlyZWREUFBDTEtbaV1bal1ba107CisJCQkJCW15UGlwZS5ESVNQQ0xLID0gbG9jYWxzLT5S
ZXF1aXJlZERJU1BDTEtbaV1bal07CisJCQkJCW15UGlwZS5QaXhlbENsb2NrID0gbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdOworCQkJCQlteVBpcGUuRENGQ0xLRGVlcFNsZWVwID0gbW9kZV9s
aWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtEZWVwU2xlZXA7CisJCQkJCW15UGlwZS5EUFBQZXJQbGFu
ZSA9IGxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXTsKKwkJCQkJbXlQaXBlLlNjYWxlckVuYWJsZWQg
PSBtb2RlX2xpYi0+dmJhLlNjYWxlckVuYWJsZWRba107CisJCQkJCW15UGlwZS5Tb3VyY2VTY2Fu
ID0gbW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdOworCQkJCQlteVBpcGUuQmxvY2tXaWR0aDI1
NkJ5dGVzWSA9IGxvY2Fscy0+UmVhZDI1NkJsb2NrV2lkdGhZW2tdOworCQkJCQlteVBpcGUuQmxv
Y2tIZWlnaHQyNTZCeXRlc1kgPSBsb2NhbHMtPlJlYWQyNTZCbG9ja0hlaWdodFlba107CisJCQkJ
CW15UGlwZS5CbG9ja1dpZHRoMjU2Qnl0ZXNDID0gbG9jYWxzLT5SZWFkMjU2QmxvY2tXaWR0aENb
a107CisJCQkJCW15UGlwZS5CbG9ja0hlaWdodDI1NkJ5dGVzQyA9IGxvY2Fscy0+UmVhZDI1NkJs
b2NrSGVpZ2h0Q1trXTsKKwkJCQkJbXlQaXBlLkludGVybGFjZUVuYWJsZSA9IG1vZGVfbGliLT52
YmEuSW50ZXJsYWNlW2tdOworCQkJCQlteVBpcGUuTnVtYmVyT2ZDdXJzb3JzID0gbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkN1cnNvcnNba107CisJCQkJCW15UGlwZS5WQmxhbmsgPSBtb2RlX2xpYi0+
dmJhLlZUb3RhbFtrXSAtIG1vZGVfbGliLT52YmEuVkFjdGl2ZVtrXTsKKwkJCQkJbXlQaXBlLkhU
b3RhbCA9IG1vZGVfbGliLT52YmEuSFRvdGFsW2tdOworCisKKwkJCQkJbXlIb3N0Vk0uRW5hYmxl
ID0gbW9kZV9saWItPnZiYS5Ib3N0Vk1FbmFibGU7CisJCQkJCW15SG9zdFZNLk1heFBhZ2VUYWJs
ZUxldmVscyA9IG1vZGVfbGliLT52YmEuSG9zdFZNTWF4UGFnZVRhYmxlTGV2ZWxzOworCQkJCQlt
eUhvc3RWTS5DYWNoZWRQYWdlVGFibGVMZXZlbHMgPSBtb2RlX2xpYi0+dmJhLkhvc3RWTUNhY2hl
ZFBhZ2VUYWJsZUxldmVsczsKKworCisJCQkJCW1vZGVfbGliLT52YmEuSXNFcnJvclJlc3VsdFtp
XVtqXVtrXSA9IENhbGN1bGF0ZVByZWZldGNoU2NoZWR1bGUoCisJCQkJCQkJbW9kZV9saWIsCisJ
CQkJCQkJbW9kZV9saWItPnZiYS5QZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQb3J0QldS
ZWNlaXZlZEFmdGVyVXJnTGF0ZW5jeVBpeGVsTWl4ZWRXaXRoVk1EYXRhLAorCQkJCQkJCW1vZGVf
bGliLT52YmEuUGVyY2VudE9mSWRlYWxEUkFNRmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRl
clVyZ0xhdGVuY3lWTURhdGFPbmx5LAorCQkJCQkJCSZteVBpcGUsCisJCQkJCQkJbG9jYWxzLT5E
U0NEZWxheVBlclN0YXRlW2ldW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRFBQQ0xLRGVsYXlT
dWJ0b3RhbCwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRQUENMS0RlbGF5U0NMLAorCQkJCQkJCW1v
ZGVfbGliLT52YmEuRFBQQ0xLRGVsYXlTQ0xMQk9ubHksCisJCQkJCQkJbW9kZV9saWItPnZiYS5E
UFBDTEtEZWxheUNOVkNGb3JtYXRlciwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRQUENMS0RlbGF5
Q05WQ0N1cnNvciwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtEZWxheVN1YnRvdGFsLAor
CQkJCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFlUaGlzU3RhdGVba10gLyBtb2RlX2xpYi0+dmJhLkhS
YXRpb1trXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dEZvcm1hdFtrXSwKKwkJCQkJCQlt
b2RlX2xpYi0+dmJhLk1heEludGVyRENOVGlsZVJlcGVhdGVycywKKwkJCQkJCQlkbWxfbWluKG1v
ZGVfbGliLT52YmEuTWF4VlN0YXJ0dXAsIGxvY2Fscy0+TWF4aW11bVZTdGFydHVwW2tdKSwKKwkJ
CQkJCQlsb2NhbHMtPk1heGltdW1WU3RhcnR1cFtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkdQ
VVZNTWF4UGFnZVRhYmxlTGV2ZWxzLAorCQkJCQkJCW1vZGVfbGliLT52YmEuR1BVVk1FbmFibGUs
CisJCQkJCQkJJm15SG9zdFZNLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRHluYW1pY01ldGFkYXRh
RW5hYmxlW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRHluYW1pY01ldGFkYXRhTGluZXNCZWZv
cmVBY3RpdmVSZXF1aXJlZFtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkR5bmFtaWNNZXRhZGF0
YVRyYW5zbWl0dGVkQnl0ZXNba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10s
CisJCQkJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5LAorCQkJCQkJCW1vZGVfbGliLT52
YmEuRXh0cmFMYXRlbmN5LAorCQkJCQkJCW1vZGVfbGliLT52YmEuVGltZUNhbGMsCisJCQkJCQkJ
bG9jYWxzLT5QREVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFtZVtrXSwKKwkJCQkJCQlsb2NhbHMtPk1l
dGFSb3dCeXRlc1trXSwKKwkJCQkJCQlsb2NhbHMtPkRQVEVCeXRlc1BlclJvd1trXSwKKwkJCQkJ
CQlsb2NhbHMtPlByZWZldGNoTGluZXNZW2tdLAorCQkJCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFlU
aGlzU3RhdGVba10sCisJCQkJCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10sCisJCQkJ
CQkJbG9jYWxzLT5QcmVmaWxsWVtrXSwKKwkJCQkJCQlsb2NhbHMtPk1heE51bVN3WVtrXSwKKwkJ
CQkJCQlsb2NhbHMtPlByZWZldGNoTGluZXNDW2tdLAorCQkJCQkJCWxvY2Fscy0+Qnl0ZVBlclBp
eGVsSW5ERVRDW2tdLAorCQkJCQkJCWxvY2Fscy0+UHJlZmlsbENba10sCisJCQkJCQkJbG9jYWxz
LT5NYXhOdW1Td0Nba10sCisJCQkJCQkJbG9jYWxzLT5Td2F0aEhlaWdodFlUaGlzU3RhdGVba10s
CisJCQkJCQkJbG9jYWxzLT5Td2F0aEhlaWdodENUaGlzU3RhdGVba10sCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5UV2FpdCwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ0VuYWJsZWRba10sCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5YRkNSZW1vdGVTdXJmYWNlRmxpcERlbGF5LAorCQkJCQkJCW1vZGVf
bGliLT52YmEuUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCwKKwkJCQkJCQkmbG9jYWxz
LT5kc3RfeF9hZnRlcl9zY2FsZXIsCisJCQkJCQkJJmxvY2Fscy0+ZHN0X3lfYWZ0ZXJfc2NhbGVy
LAorCQkJCQkJCSZsb2NhbHMtPkxpbmVUaW1lc0ZvclByZWZldGNoW2tdLAorCQkJCQkJCSZsb2Nh
bHMtPlByZWZldGNoQldba10sCisJCQkJCQkJJmxvY2Fscy0+TGluZXNGb3JNZXRhUFRFW2tdLAor
CQkJCQkJCSZsb2NhbHMtPkxpbmVzRm9yTWV0YUFuZERQVEVSb3dba10sCisJCQkJCQkJJmxvY2Fs
cy0+VlJhdGlvUHJlWVtpXVtqXVtrXSwKKwkJCQkJCQkmbG9jYWxzLT5WUmF0aW9QcmVDW2ldW2pd
W2tdLAorCQkJCQkJCSZsb2NhbHMtPlJlcXVpcmVkUHJlZmV0Y2hQaXhlbERhdGFCV0x1bWFbaV1b
al1ba10sCisJCQkJCQkJJmxvY2Fscy0+UmVxdWlyZWRQcmVmZXRjaFBpeGVsRGF0YUJXQ2hyb21h
W2ldW2pdW2tdLAorCQkJCQkJCSZsb2NhbHMtPlZTdGFydHVwUmVxdWlyZWRXaGVuTm90RW5vdWdo
VGltZUZvckR5bmFtaWNNZXRhZGF0YSwKKwkJCQkJCQkmbG9jYWxzLT5Ubm9fYndba10sCisJCQkJ
CQkJJmxvY2Fscy0+cHJlZmV0Y2hfdm1yb3dfYndba10sCisJCQkJCQkJbG9jYWxzLT5zd2F0aF93
aWR0aF9sdW1hX3ViLAorCQkJCQkJCWxvY2Fscy0+c3dhdGhfd2lkdGhfY2hyb21hX3ViLAorCQkJ
CQkJCSZtb2RlX2xpYi0+dmJhLlZVcGRhdGVPZmZzZXRQaXhba10sCisJCQkJCQkJJm1vZGVfbGli
LT52YmEuVlVwZGF0ZVdpZHRoUGl4W2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlZSZWFkeU9m
ZnNldFBpeFtrXSk7CisJCQkJfQorCQkJCW1vZGVfbGliLT52YmEuTWF4aW11bVJlYWRCYW5kd2lk
dGhXaXRob3V0UHJlZmV0Y2ggPSAwLjA7CisJCQkJbW9kZV9saWItPnZiYS5NYXhpbXVtUmVhZEJh
bmR3aWR0aFdpdGhQcmVmZXRjaCA9IDAuMDsKKwkJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGli
LT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQkJdWludCBtOworCisJ
CQkJCWxvY2Fscy0+Y3Vyc29yX2J3W2tdID0gMDsKKwkJCQkJbG9jYWxzLT5jdXJzb3JfYndfcHJl
W2tdID0gMDsKKwkJCQkJZm9yIChtID0gMDsgbSA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZDdXJz
b3JzW2tdOyBtKyspIHsKKwkJCQkJCWxvY2Fscy0+Y3Vyc29yX2J3W2tdID0gbW9kZV9saWItPnZi
YS5DdXJzb3JXaWR0aFtrXVttXSAqIG1vZGVfbGliLT52YmEuQ3Vyc29yQlBQW2tdW21dCisJCQkJ
CQkJLyA4LjAgLyAobW9kZV9saWItPnZiYS5IVG90YWxba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVs
Q2xvY2tba10pICogbW9kZV9saWItPnZiYS5WUmF0aW9ba107CisJCQkJCQlsb2NhbHMtPmN1cnNv
cl9id19wcmVba10gPSBtb2RlX2xpYi0+dmJhLkN1cnNvcldpZHRoW2tdW21dICogbW9kZV9saWIt
PnZiYS5DdXJzb3JCUFBba11bbV0KKwkJCQkJCQkvIDguMCAvIChtb2RlX2xpYi0+dmJhLkhUb3Rh
bFtrXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkgKiBsb2NhbHMtPlZSYXRpb1ByZVlb
aV1bal1ba107CisJCQkJCX0KKworCQkJCQlDYWxjdWxhdGVVcmdlbnRCdXJzdEZhY3RvcigKKwkJ
CQkJCQltb2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVJbktCeXRlLAorCQkJCQkJCWxvY2Fscy0+
U3dhdGhIZWlnaHRZVGhpc1N0YXRlW2tdLAorCQkJCQkJCWxvY2Fscy0+U3dhdGhIZWlnaHRDVGhp
c1N0YXRlW2tdLAorCQkJCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFlUaGlzU3RhdGVba10sCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5IVG90YWxba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10s
CisJCQkJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5LAorCQkJCQkJCW1vZGVfbGliLT52
YmEuQ3Vyc29yQnVmZmVyU2l6ZSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkN1cnNvcldpZHRoW2td
WzBdICsgbW9kZV9saWItPnZiYS5DdXJzb3JXaWR0aFtrXVsxXSwKKwkJCQkJCQlkbWxfbWF4KG1v
ZGVfbGliLT52YmEuQ3Vyc29yQlBQW2tdWzBdLCBtb2RlX2xpYi0+dmJhLkN1cnNvckJQUFtrXVsx
XSksCisJCQkJCQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10sCisJCQkJCQkJbG9jYWxzLT5WUmF0
aW9QcmVZW2ldW2pdW2tdLAorCQkJCQkJCWxvY2Fscy0+VlJhdGlvUHJlQ1tpXVtqXVtrXSwKKwkJ
CQkJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSwKKwkJCQkJCQlsb2NhbHMtPkJ5dGVQ
ZXJQaXhlbEluREVUQ1trXSwKKwkJCQkJCQkmbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckN1cnNv
cltrXSwKKwkJCQkJCQkmbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckN1cnNvclByZVtrXSwKKwkJ
CQkJCQkmbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3Rvckx1bWFba10sCisJCQkJCQkJJmxvY2Fscy0+
VXJnZW50QnVyc3RGYWN0b3JMdW1hUHJlW2tdLAorCQkJCQkJCSZsb2NhbHMtPlVyZ2VudEJ1cnN0
RmFjdG9yQ2hyb21hW2tdLAorCQkJCQkJCSZsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9yQ2hyb21h
UHJlW2tdLAorCQkJCQkJCSZsb2NhbHMtPk5vdEVub3VnaFVyZ2VudExhdGVuY3lIaWRpbmcsCisJ
CQkJCQkJJmxvY2Fscy0+Tm90RW5vdWdoVXJnZW50TGF0ZW5jeUhpZGluZ1ByZSk7CisKKwkJCQkJ
aWYgKG1vZGVfbGliLT52YmEuVXNlVXJnZW50QnVyc3RCYW5kd2lkdGggPT0gZmFsc2UpIHsKKwkJ
CQkJCWxvY2Fscy0+VXJnZW50QnVyc3RGYWN0b3JDdXJzb3Jba10gPSAxOworCQkJCQkJbG9jYWxz
LT5VcmdlbnRCdXJzdEZhY3RvckN1cnNvclByZVtrXSA9IDE7CisJCQkJCQlsb2NhbHMtPlVyZ2Vu
dEJ1cnN0RmFjdG9yTHVtYVtrXSA9IDE7CisJCQkJCQlsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9y
THVtYVByZVtrXSA9IDE7CisJCQkJCQlsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9yQ2hyb21hW2td
ID0gMTsKKwkJCQkJCWxvY2Fscy0+VXJnZW50QnVyc3RGYWN0b3JDaHJvbWFQcmVba10gPSAxOwor
CQkJCQl9CisKKwkJCQkJbW9kZV9saWItPnZiYS5NYXhpbXVtUmVhZEJhbmR3aWR0aFdpdGhvdXRQ
cmVmZXRjaCA9IG1vZGVfbGliLT52YmEuTWF4aW11bVJlYWRCYW5kd2lkdGhXaXRob3V0UHJlZmV0
Y2gKKwkJCQkJCSsgbG9jYWxzLT5jdXJzb3JfYndba10gKiBsb2NhbHMtPlVyZ2VudEJ1cnN0RmFj
dG9yQ3Vyc29yW2tdICsgbG9jYWxzLT5SZWFkQmFuZHdpZHRoTHVtYVtrXQorCQkJCQkJKiBsb2Nh
bHMtPlVyZ2VudEJ1cnN0RmFjdG9yTHVtYVtrXSArIGxvY2Fscy0+UmVhZEJhbmR3aWR0aENocm9t
YVtrXQorCQkJCQkJKiBsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9yQ2hyb21hW2tdICsgbG9jYWxz
LT5tZXRhX3Jvd19id1trXSArIGxvY2Fscy0+ZHB0ZV9yb3dfYndba107CisJCQkJCW1vZGVfbGli
LT52YmEuTWF4aW11bVJlYWRCYW5kd2lkdGhXaXRoUHJlZmV0Y2ggPSBtb2RlX2xpYi0+dmJhLk1h
eGltdW1SZWFkQmFuZHdpZHRoV2l0aFByZWZldGNoCisJCQkJCQkrIGRtbF9tYXgzKGxvY2Fscy0+
cHJlZmV0Y2hfdm1yb3dfYndba10sCisJCQkJCQlsb2NhbHMtPlJlYWRCYW5kd2lkdGhMdW1hW2td
ICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3Rvckx1bWFba10gKyBsb2NhbHMtPlJlYWRCYW5kd2lk
dGhDaHJvbWFba10KKwkJCQkJCSogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckNocm9tYVtrXSAr
IGxvY2Fscy0+Y3Vyc29yX2J3W2tdICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckN1cnNvcltr
XQorCQkJCQkJKyBsb2NhbHMtPm1ldGFfcm93X2J3W2tdICsgbG9jYWxzLT5kcHRlX3Jvd19id1tr
XSwKKwkJCQkJCWxvY2Fscy0+UmVxdWlyZWRQcmVmZXRjaFBpeGVsRGF0YUJXTHVtYVtpXVtqXVtr
XSAqIGxvY2Fscy0+VXJnZW50QnVyc3RGYWN0b3JMdW1hUHJlW2tdCisJCQkJCQkrIGxvY2Fscy0+
UmVxdWlyZWRQcmVmZXRjaFBpeGVsRGF0YUJXQ2hyb21hW2ldW2pdW2tdICogbG9jYWxzLT5Vcmdl
bnRCdXJzdEZhY3RvckNocm9tYVByZVtrXQorCQkJCQkJKyBsb2NhbHMtPmN1cnNvcl9id19wcmVb
a10gKiBsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9yQ3Vyc29yUHJlW2tdKTsKKwkJCQl9CisJCQkJ
bG9jYWxzLT5CYW5kd2lkdGhXaXRob3V0UHJlZmV0Y2hTdXBwb3J0ZWRbaV0gPSB0cnVlOworCQkJ
CWlmIChtb2RlX2xpYi0+dmJhLk1heGltdW1SZWFkQmFuZHdpZHRoV2l0aG91dFByZWZldGNoID4g
bG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldCisJCQkJCQl8fCBsb2NhbHMtPk5vdEVub3VnaFVy
Z2VudExhdGVuY3lIaWRpbmcgPT0gMSkgeworCQkJCQlsb2NhbHMtPkJhbmR3aWR0aFdpdGhvdXRQ
cmVmZXRjaFN1cHBvcnRlZFtpXSA9IGZhbHNlOworCQkJCX0KKworCQkJCWxvY2Fscy0+UHJlZmV0
Y2hTdXBwb3J0ZWRbaV1bal0gPSB0cnVlOworCQkJCWlmIChtb2RlX2xpYi0+dmJhLk1heGltdW1S
ZWFkQmFuZHdpZHRoV2l0aFByZWZldGNoID4gbG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldCisJ
CQkJCQl8fCBsb2NhbHMtPk5vdEVub3VnaFVyZ2VudExhdGVuY3lIaWRpbmcgPT0gMQorCQkJCQkJ
fHwgbG9jYWxzLT5Ob3RFbm91Z2hVcmdlbnRMYXRlbmN5SGlkaW5nUHJlID09IDEpIHsKKwkJCQkJ
bG9jYWxzLT5QcmVmZXRjaFN1cHBvcnRlZFtpXVtqXSA9IGZhbHNlOworCQkJCX0KKwkJCQlmb3Ig
KGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKysp
IHsKKwkJCQkJaWYgKGxvY2Fscy0+TGluZVRpbWVzRm9yUHJlZmV0Y2hba10gPCAyLjAKKwkJCQkJ
CQl8fCBsb2NhbHMtPkxpbmVzRm9yTWV0YVBURVtrXSA+PSAzMi4wCisJCQkJCQkJfHwgbG9jYWxz
LT5MaW5lc0Zvck1ldGFBbmREUFRFUm93W2tdID49IDE2LjAKKwkJCQkJCQl8fCBtb2RlX2xpYi0+
dmJhLklzRXJyb3JSZXN1bHRbaV1bal1ba10gPT0gdHJ1ZSkgeworCQkJCQkJbG9jYWxzLT5QcmVm
ZXRjaFN1cHBvcnRlZFtpXVtqXSA9IGZhbHNlOworCQkJCQl9CisJCQkJfQorCQkJCWxvY2Fscy0+
VlJhdGlvSW5QcmVmZXRjaFN1cHBvcnRlZFtpXVtqXSA9IHRydWU7CisJCQkJZm9yIChrID0gMDsg
ayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJ
CWlmIChsb2NhbHMtPlZSYXRpb1ByZVlbaV1bal1ba10gPiA0LjAKKwkJCQkJCQl8fCBsb2NhbHMt
PlZSYXRpb1ByZUNbaV1bal1ba10gPiA0LjAKKwkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLklzRXJy
b3JSZXN1bHRbaV1bal1ba10gPT0gdHJ1ZSkgeworCQkJCQkJbG9jYWxzLT5WUmF0aW9JblByZWZl
dGNoU3VwcG9ydGVkW2ldW2pdID0gZmFsc2U7CisJCQkJCX0KKwkJCQl9CisJCQkJbW9kZV9saWIt
PnZiYS5BbnlMaW5lc0ZvclZNT3JSb3dUb29MYXJnZSA9IGZhbHNlOworCQkJCWZvciAoayA9IDA7
IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJCQkJaWYg
KGxvY2Fscy0+TGluZXNGb3JNZXRhQW5kRFBURVJvd1trXSA+PSAxNiB8fCBsb2NhbHMtPkxpbmVz
Rm9yTWV0YVBURVtrXSA+PSAzMikgeworCQkJCQkJbW9kZV9saWItPnZiYS5BbnlMaW5lc0ZvclZN
T3JSb3dUb29MYXJnZSA9IHRydWU7CisJCQkJCX0KKwkJCQl9CisKKwkJCQlpZiAobW9kZV9saWIt
PnZiYS5NYXhWU3RhcnR1cCA8PSAxMyB8fCBtb2RlX2xpYi0+dmJhLkFueUxpbmVzRm9yVk1PclJv
d1Rvb0xhcmdlID09IGZhbHNlKSB7CisJCQkJCW1vZGVfbGliLT52YmEuTmV4dE1heFZTdGFydHVw
ID0gbW9kZV9saWItPnZiYS5NYXhNYXhWU3RhcnR1cDsKKwkJCQkJbW9kZV9saWItPnZiYS5OZXh0
UHJlZmV0Y2hNb2RlID0gbW9kZV9saWItPnZiYS5OZXh0UHJlZmV0Y2hNb2RlICsgMTsKKwkJCQl9
IGVsc2UgeworCQkJCQltb2RlX2xpYi0+dmJhLk5leHRNYXhWU3RhcnR1cCA9IG1vZGVfbGliLT52
YmEuTmV4dE1heFZTdGFydHVwIC0gMTsKKwkJCQl9CisJCQl9IHdoaWxlICgobG9jYWxzLT5QcmVm
ZXRjaFN1cHBvcnRlZFtpXVtqXSAhPSB0cnVlIHx8IGxvY2Fscy0+VlJhdGlvSW5QcmVmZXRjaFN1
cHBvcnRlZFtpXVtqXSAhPSB0cnVlKQorCQkJCQkmJiAobW9kZV9saWItPnZiYS5OZXh0TWF4VlN0
YXJ0dXAgIT0gbW9kZV9saWItPnZiYS5NYXhNYXhWU3RhcnR1cAorCQkJCQkJfHwgbW9kZV9saWIt
PnZiYS5OZXh0UHJlZmV0Y2hNb2RlIDwgbW9kZV9saWItPnZiYS5NYXhQcmVmZXRjaE1vZGUpKTsK
KworCQkJaWYgKGxvY2Fscy0+UHJlZmV0Y2hTdXBwb3J0ZWRbaV1bal0gPT0gdHJ1ZSAmJiBsb2Nh
bHMtPlZSYXRpb0luUHJlZmV0Y2hTdXBwb3J0ZWRbaV1bal0gPT0gdHJ1ZSkgeworCQkJCW1vZGVf
bGliLT52YmEuQmFuZHdpZHRoQXZhaWxhYmxlRm9ySW1tZWRpYXRlRmxpcCA9IGxvY2Fscy0+UmV0
dXJuQldQZXJTdGF0ZVtpXTsKKwkJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVt
YmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQkJbW9kZV9saWItPnZiYS5CYW5kd2lk
dGhBdmFpbGFibGVGb3JJbW1lZGlhdGVGbGlwID0gbW9kZV9saWItPnZiYS5CYW5kd2lkdGhBdmFp
bGFibGVGb3JJbW1lZGlhdGVGbGlwCisJCQkJCQktIGRtbF9tYXgobG9jYWxzLT5SZWFkQmFuZHdp
ZHRoTHVtYVtrXSAqIGxvY2Fscy0+VXJnZW50QnVyc3RGYWN0b3JMdW1hW2tdCisJCQkJCQkJKyBs
b2NhbHMtPlJlYWRCYW5kd2lkdGhDaHJvbWFba10gKiBsb2NhbHMtPlVyZ2VudEJ1cnN0RmFjdG9y
Q2hyb21hW2tdCisJCQkJCQkJKyBsb2NhbHMtPmN1cnNvcl9id1trXSAqIGxvY2Fscy0+VXJnZW50
QnVyc3RGYWN0b3JDdXJzb3Jba10sCisJCQkJCQkJbG9jYWxzLT5SZXF1aXJlZFByZWZldGNoUGl4
ZWxEYXRhQldMdW1hW2ldW2pdW2tdICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3Rvckx1bWFQcmVb
a10KKwkJCQkJCQkrIGxvY2Fscy0+UmVxdWlyZWRQcmVmZXRjaFBpeGVsRGF0YUJXQ2hyb21hW2ld
W2pdW2tdICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckNocm9tYVByZVtrXQorCQkJCQkJCSsg
bG9jYWxzLT5jdXJzb3JfYndfcHJlW2tdICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckN1cnNv
clByZVtrXSk7CisJCQkJfQorCQkJCW1vZGVfbGliLT52YmEuVG90SW1tZWRpYXRlRmxpcEJ5dGVz
ID0gMC4wOworCQkJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2
ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJCQltb2RlX2xpYi0+dmJhLlRvdEltbWVkaWF0ZUZsaXBC
eXRlcyA9IG1vZGVfbGliLT52YmEuVG90SW1tZWRpYXRlRmxpcEJ5dGVzCisJCQkJCQkrIGxvY2Fs
cy0+UERFQW5kTWV0YVBURUJ5dGVzUGVyRnJhbWVba10gKyBsb2NhbHMtPk1ldGFSb3dCeXRlc1tr
XSArIGxvY2Fscy0+RFBURUJ5dGVzUGVyUm93W2tdOworCQkJCX0KKworCQkJCWZvciAoayA9IDA7
IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJ
CQlDYWxjdWxhdGVGbGlwU2NoZWR1bGUoCisJCQkJCQkJbW9kZV9saWIsCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5QZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQb3J0QldSZWNlaXZlZEFmdGVy
VXJnTGF0ZW5jeVBpeGVsTWl4ZWRXaXRoVk1EYXRhLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUGVy
Y2VudE9mSWRlYWxEUkFNRmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRlclVyZ0xhdGVuY3lW
TURhdGFPbmx5LAorCQkJCQkJCW1vZGVfbGliLT52YmEuRXh0cmFMYXRlbmN5LAorCQkJCQkJCW1v
ZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkdQVVZNTWF4
UGFnZVRhYmxlTGV2ZWxzLAorCQkJCQkJCW1vZGVfbGliLT52YmEuSG9zdFZNRW5hYmxlLAorCQkJ
CQkJCW1vZGVfbGliLT52YmEuSG9zdFZNTWF4UGFnZVRhYmxlTGV2ZWxzLAorCQkJCQkJCW1vZGVf
bGliLT52YmEuSG9zdFZNQ2FjaGVkUGFnZVRhYmxlTGV2ZWxzLAorCQkJCQkJCW1vZGVfbGliLT52
YmEuR1BVVk1FbmFibGUsCisJCQkJCQkJbG9jYWxzLT5QREVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFt
ZVtrXSwKKwkJCQkJCQlsb2NhbHMtPk1ldGFSb3dCeXRlc1trXSwKKwkJCQkJCQlsb2NhbHMtPkRQ
VEVCeXRlc1BlclJvd1trXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkJhbmR3aWR0aEF2YWlsYWJs
ZUZvckltbWVkaWF0ZUZsaXAsCisJCQkJCQkJbW9kZV9saWItPnZiYS5Ub3RJbW1lZGlhdGVGbGlw
Qnl0ZXMsCisJCQkJCQkJbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSwKKwkJCQkJ
CQltb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSwK
KwkJCQkJCQltb2RlX2xpYi0+dmJhLlZSYXRpb1trXSwKKwkJCQkJCQlsb2NhbHMtPlRub19id1tr
XSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRDQ0VuYWJsZVtrXSwKKwkJCQkJCQlsb2NhbHMtPmRw
dGVfcm93X2hlaWdodFtrXSwKKwkJCQkJCQlsb2NhbHMtPm1ldGFfcm93X2hlaWdodFtrXSwKKwkJ
CQkJCQlsb2NhbHMtPmRwdGVfcm93X2hlaWdodF9jaHJvbWFba10sCisJCQkJCQkJbG9jYWxzLT5t
ZXRhX3Jvd19oZWlnaHRfY2hyb21hW2tdLAorCQkJCQkJCSZsb2NhbHMtPkRlc3RpbmF0aW9uTGlu
ZXNUb1JlcXVlc3RWTUluSW1tZWRpYXRlRmxpcFtrXSwKKwkJCQkJCQkmbG9jYWxzLT5EZXN0aW5h
dGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5JbW1lZGlhdGVGbGlwW2tdLAorCQkJCQkJCSZsb2NhbHMt
PmZpbmFsX2ZsaXBfYndba10sCisJCQkJCQkJJmxvY2Fscy0+SW1tZWRpYXRlRmxpcFN1cHBvcnRl
ZEZvclBpcGVba10pOworCQkJCX0KKwkJCQltb2RlX2xpYi0+dmJhLnRvdGFsX2Rjbl9yZWFkX2J3
X3dpdGhfZmxpcCA9IDAuMDsKKwkJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVt
YmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQkJbW9kZV9saWItPnZiYS50b3RhbF9k
Y25fcmVhZF9id193aXRoX2ZsaXAgPSBtb2RlX2xpYi0+dmJhLnRvdGFsX2Rjbl9yZWFkX2J3X3dp
dGhfZmxpcCArIGRtbF9tYXgzKAorCQkJCQkJbG9jYWxzLT5wcmVmZXRjaF92bXJvd19id1trXSwK
KwkJCQkJCWxvY2Fscy0+ZmluYWxfZmxpcF9id1trXSArICBsb2NhbHMtPlJlYWRCYW5kd2lkdGhM
dW1hW2tdICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3Rvckx1bWFba10KKwkJCQkJCSsgbG9jYWxz
LT5SZWFkQmFuZHdpZHRoQ2hyb21hW2tdICogbG9jYWxzLT5VcmdlbnRCdXJzdEZhY3RvckNocm9t
YVtrXQorCQkJCQkJKyBsb2NhbHMtPmN1cnNvcl9id1trXSAqIGxvY2Fscy0+VXJnZW50QnVyc3RG
YWN0b3JDdXJzb3Jba10sCisJCQkJCQlsb2NhbHMtPmZpbmFsX2ZsaXBfYndba10gKyBsb2NhbHMt
PlJlcXVpcmVkUHJlZmV0Y2hQaXhlbERhdGFCV0x1bWFbaV1bal1ba10KKwkJCQkJCSogbG9jYWxz
LT5VcmdlbnRCdXJzdEZhY3Rvckx1bWFQcmVba10gKyBsb2NhbHMtPlJlcXVpcmVkUHJlZmV0Y2hQ
aXhlbERhdGFCV0Nocm9tYVtpXVtqXVtrXQorCQkJCQkJKiBsb2NhbHMtPlVyZ2VudEJ1cnN0RmFj
dG9yQ2hyb21hUHJlW2tdICsgbG9jYWxzLT5jdXJzb3JfYndfcHJlW2tdCisJCQkJCQkqIGxvY2Fs
cy0+VXJnZW50QnVyc3RGYWN0b3JDdXJzb3JQcmVba10pOworCQkJCX0KKwkJCQlsb2NhbHMtPklt
bWVkaWF0ZUZsaXBTdXBwb3J0ZWRGb3JTdGF0ZVtpXVtqXSA9IHRydWU7CisJCQkJaWYgKG1vZGVf
bGliLT52YmEudG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwCisJCQkJCQk+IGxvY2Fscy0+UmV0
dXJuQldQZXJTdGF0ZVtpXSkgeworCQkJCQlsb2NhbHMtPkltbWVkaWF0ZUZsaXBTdXBwb3J0ZWRG
b3JTdGF0ZVtpXVtqXSA9IGZhbHNlOworCQkJCX0KKwkJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVf
bGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQkJaWYgKGxvY2Fs
cy0+SW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclBpcGVba10gPT0gZmFsc2UpIHsKKwkJCQkJCWxv
Y2Fscy0+SW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclN0YXRlW2ldW2pdID0gZmFsc2U7CisJCQkJ
CX0KKwkJCQl9CisJCQl9IGVsc2UgeworCQkJCWxvY2Fscy0+SW1tZWRpYXRlRmxpcFN1cHBvcnRl
ZEZvclN0YXRlW2ldW2pdID0gZmFsc2U7CisJCQl9CisJCQltb2RlX2xpYi0+dmJhLlVyZ2VudE91
dE9mT3JkZXJSZXR1cm5QZXJDaGFubmVsID0gZG1sX21heDMoCisJCQkJCW1vZGVfbGliLT52YmEu
VXJnZW50T3V0T2ZPcmRlclJldHVyblBlckNoYW5uZWxQaXhlbERhdGFPbmx5LAorCQkJCQltb2Rl
X2xpYi0+dmJhLlVyZ2VudE91dE9mT3JkZXJSZXR1cm5QZXJDaGFubmVsUGl4ZWxNaXhlZFdpdGhW
TURhdGEsCisJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50T3V0T2ZPcmRlclJldHVyblBlckNoYW5u
ZWxWTURhdGFPbmx5KTsKKwkJCUNhbGN1bGF0ZVdhdGVybWFya3NBbmREUkFNU3BlZWRDaGFuZ2VT
dXBwb3J0KAorCQkJCQltb2RlX2xpYiwKKwkJCQkJbW9kZV9saWItPnZiYS5QcmVmZXRjaE1vZGVb
aV1bal0sCisJCQkJCW1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMsCisJCQkJCW1v
ZGVfbGliLT52YmEuTWF4TGluZUJ1ZmZlckxpbmVzLAorCQkJCQltb2RlX2xpYi0+dmJhLkxpbmVC
dWZmZXJTaXplLAorCQkJCQltb2RlX2xpYi0+dmJhLkRQUE91dHB1dEJ1ZmZlclBpeGVscywKKwkJ
CQkJbW9kZV9saWItPnZiYS5ERVRCdWZmZXJTaXplSW5LQnl0ZSwKKwkJCQkJbW9kZV9saWItPnZi
YS5Xcml0ZWJhY2tJbnRlcmZhY2VMdW1hQnVmZmVyU2l6ZSwKKwkJCQkJbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tJbnRlcmZhY2VDaHJvbWFCdWZmZXJTaXplLAorCQkJCQltb2RlX2xpYi0+dmJhLkRD
RkNMS1BlclN0YXRlW2ldLAorCQkJCQltb2RlX2xpYi0+dmJhLlVyZ2VudE91dE9mT3JkZXJSZXR1
cm5QZXJDaGFubmVsICogbW9kZV9saWItPnZiYS5OdW1iZXJPZkNoYW5uZWxzLAorCQkJCQlsb2Nh
bHMtPlJldHVybkJXUGVyU3RhdGVbaV0sCisJCQkJCW1vZGVfbGliLT52YmEuR1BVVk1FbmFibGUs
CisJCQkJCWxvY2Fscy0+ZHB0ZV9ncm91cF9ieXRlcywKKwkJCQkJbW9kZV9saWItPnZiYS5NZXRh
Q2h1bmtTaXplLAorCQkJCQltb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3ksCisJCQkJCW1vZGVf
bGliLT52YmEuRXh0cmFMYXRlbmN5LAorCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0xhdGVu
Y3ksCisJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2h1bmtTaXplLAorCQkJCQltb2RlX2xp
Yi0+dmJhLlNPQ0NMS1BlclN0YXRlW2ldLAorCQkJCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0No
YW5nZUxhdGVuY3ksCisJCQkJCW1vZGVfbGliLT52YmEuU1JFeGl0VGltZSwKKwkJCQkJbW9kZV9s
aWItPnZiYS5TUkVudGVyUGx1c0V4aXRUaW1lLAorCQkJCQltb2RlX2xpYi0+dmJhLlByb2plY3Rl
ZERDRkNMS0RlZXBTbGVlcCwKKwkJCQkJbG9jYWxzLT5Ob09mRFBQVGhpc1N0YXRlLAorCQkJCQlt
b2RlX2xpYi0+dmJhLkRDQ0VuYWJsZSwKKwkJCQkJbG9jYWxzLT5SZXF1aXJlZERQUENMS1RoaXNT
dGF0ZSwKKwkJCQkJbG9jYWxzLT5Td2F0aFdpZHRoWVNpbmdsZURQUCwKKwkJCQkJbG9jYWxzLT5T
d2F0aEhlaWdodFlUaGlzU3RhdGUsCisJCQkJCWxvY2Fscy0+UmVhZEJhbmR3aWR0aEx1bWEsCisJ
CQkJCWxvY2Fscy0+U3dhdGhIZWlnaHRDVGhpc1N0YXRlLAorCQkJCQlsb2NhbHMtPlJlYWRCYW5k
d2lkdGhDaHJvbWEsCisJCQkJCW1vZGVfbGliLT52YmEuTEJCaXRQZXJQaXhlbCwKKwkJCQkJbG9j
YWxzLT5Td2F0aFdpZHRoWVRoaXNTdGF0ZSwKKwkJCQkJbW9kZV9saWItPnZiYS5IUmF0aW8sCisJ
CQkJCW1vZGVfbGliLT52YmEudnRhcHMsCisJCQkJCW1vZGVfbGliLT52YmEuVlRBUHNDaHJvbWEs
CisJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvLAorCQkJCQltb2RlX2xpYi0+dmJhLkhUb3RhbCwK
KwkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrLAorCQkJCQltb2RlX2xpYi0+dmJhLkJsZW5k
aW5nQW5kVGltaW5nLAorCQkJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWSwKKwkJCQkJbG9j
YWxzLT5CeXRlUGVyUGl4ZWxJbkRFVEMsCisJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRW5h
YmxlLAorCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja1BpeGVsRm9ybWF0LAorCQkJCQltb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGgsCisJCQkJCW1vZGVfbGliLT52YmEu
V3JpdGViYWNrRGVzdGluYXRpb25IZWlnaHQsCisJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNr
U291cmNlSGVpZ2h0LAorCQkJCQkmbG9jYWxzLT5EUkFNQ2xvY2tDaGFuZ2VTdXBwb3J0W2ldW2pd
LAorCQkJCQkmbW9kZV9saWItPnZiYS5VcmdlbnRXYXRlcm1hcmssCisJCQkJCSZtb2RlX2xpYi0+
dmJhLldyaXRlYmFja1VyZ2VudFdhdGVybWFyaywKKwkJCQkJJm1vZGVfbGliLT52YmEuRFJBTUNs
b2NrQ2hhbmdlV2F0ZXJtYXJrLAorCQkJCQkmbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEUkFNQ2xv
Y2tDaGFuZ2VXYXRlcm1hcmssCisJCQkJCSZtb2RlX2xpYi0+dmJhLlN0dXR0ZXJFeGl0V2F0ZXJt
YXJrLAorCQkJCQkmbW9kZV9saWItPnZiYS5TdHV0dGVyRW50ZXJQbHVzRXhpdFdhdGVybWFyaywK
KwkJCQkJJm1vZGVfbGliLT52YmEuTWluQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeVN1cHBv
cnRlZCk7CisJCQl9CisJCX0KKworCQkvKlZlcnRpY2FsIEFjdGl2ZSBCVyBzdXBwb3J0Ki8KKwkJ
eworCQkJZG91YmxlIE1heFRvdGFsVkFjdGl2ZVJEQmFuZHdpZHRoID0gMC4wOworCQkJZm9yIChr
ID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQkJ
CU1heFRvdGFsVkFjdGl2ZVJEQmFuZHdpZHRoID0gTWF4VG90YWxWQWN0aXZlUkRCYW5kd2lkdGgg
KyBsb2NhbHMtPlJlYWRCYW5kd2lkdGhba107CisJCX0KKwkJZm9yIChpID0gMDsgaSA8PSBtb2Rl
X2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzOyArK2kpIHsKKwkJCWxvY2Fscy0+TWF4VG90YWxWZXJ0
aWNhbEFjdGl2ZUF2YWlsYWJsZUJhbmR3aWR0aFtpXSA9IGRtbF9taW4oCisJCQkJbG9jYWxzLT5J
ZGVhbFNEUFBvcnRCYW5kd2lkdGhQZXJTdGF0ZVtpXSAqCisJCQkJbW9kZV9saWItPnZiYS5NYXhB
dmVyYWdlUGVyY2VudE9mSWRlYWxTRFBQb3J0QldEaXNwbGF5Q2FuVXNlSW5Ob3JtYWxTeXN0ZW1P
cGVyYXRpb24KKwkJCQkvIDEwMC4wLCBtb2RlX2xpYi0+dmJhLkRSQU1TcGVlZFBlclN0YXRlW2ld
ICoKKwkJCQltb2RlX2xpYi0+dmJhLk51bWJlck9mQ2hhbm5lbHMgKgorCQkJCW1vZGVfbGliLT52
YmEuRFJBTUNoYW5uZWxXaWR0aCAqCisJCQkJbW9kZV9saWItPnZiYS5NYXhBdmVyYWdlUGVyY2Vu
dE9mSWRlYWxEUkFNQldEaXNwbGF5Q2FuVXNlSW5Ob3JtYWxTeXN0ZW1PcGVyYXRpb24KKwkJCQkv
IDEwMC4wKTsKKworCQkJaWYgKE1heFRvdGFsVkFjdGl2ZVJEQmFuZHdpZHRoIDw9IGxvY2Fscy0+
TWF4VG90YWxWZXJ0aWNhbEFjdGl2ZUF2YWlsYWJsZUJhbmR3aWR0aFtpXSkgeworCQkJCWxvY2Fs
cy0+VG90YWxWZXJ0aWNhbEFjdGl2ZUJhbmR3aWR0aFN1cHBvcnRbaV0gPSB0cnVlOworCQkJfSBl
bHNlIHsKKwkJCQlsb2NhbHMtPlRvdGFsVmVydGljYWxBY3RpdmVCYW5kd2lkdGhTdXBwb3J0W2ld
ID0gZmFsc2U7CisJCQl9CisJCX0KKwl9CisKKwkvKlBURSBCdWZmZXIgU2l6ZSBDaGVjayovCisK
Kwlmb3IgKGkgPSAwOyBpIDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7IGkrKykgewor
CQlmb3IgKGogPSAwOyBqIDwgMjsgaisrKSB7CisJCQlsb2NhbHMtPlBURUJ1ZmZlclNpemVOb3RF
eGNlZWRlZFtpXVtqXSA9IHRydWU7CisJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEu
TnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQlpZiAobG9jYWxzLT5QVEVCdWZm
ZXJTaXplTm90RXhjZWVkZWRZW2ldW2pdW2tdID09IGZhbHNlCisJCQkJCQl8fCBsb2NhbHMtPlBU
RUJ1ZmZlclNpemVOb3RFeGNlZWRlZENbaV1bal1ba10gPT0gZmFsc2UpIHsKKwkJCQkJbG9jYWxz
LT5QVEVCdWZmZXJTaXplTm90RXhjZWVkZWRbaV1bal0gPSBmYWxzZTsKKwkJCQl9CisJCQl9CisJ
CX0KKwl9CisJLypDdXJzb3IgU3VwcG9ydCBDaGVjayovCisKKwltb2RlX2xpYi0+dmJhLkN1cnNv
clN1cHBvcnQgPSB0cnVlOworCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJP
ZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlpZiAobW9kZV9saWItPnZiYS5DdXJzb3JXaWR0
aFtrXVswXSA+IDAuMCkgeworCQkJZm9yIChtID0gMDsgbSA8IG1vZGVfbGliLT52YmEuTnVtYmVy
T2ZDdXJzb3JzW2tdOyBtKyspIHsKKwkJCQlpZiAobW9kZV9saWItPnZiYS5DdXJzb3JCUFBba11b
bV0gPT0gNjQgJiYgbW9kZV9saWItPnZiYS5DdXJzb3I2NEJwcFN1cHBvcnQgPT0gZmFsc2UpIHsK
KwkJCQkJbW9kZV9saWItPnZiYS5DdXJzb3JTdXBwb3J0ID0gZmFsc2U7CisJCQkJfQorCQkJfQor
CQl9CisJfQorCS8qVmFsaWQgUGl0Y2ggQ2hlY2sqLworCisJbW9kZV9saWItPnZiYS5QaXRjaFN1
cHBvcnQgPSB0cnVlOworCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFj
dGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlsb2NhbHMtPkFsaWduZWRZUGl0Y2hba10gPSBkbWxf
Y2VpbCgKKwkJCQlkbWxfbWF4KG1vZGVfbGliLT52YmEuUGl0Y2hZW2tdLCBtb2RlX2xpYi0+dmJh
LlZpZXdwb3J0V2lkdGhba10pLAorCQkJCWxvY2Fscy0+TWFjcm9UaWxlV2lkdGhZW2tdKTsKKwkJ
aWYgKGxvY2Fscy0+QWxpZ25lZFlQaXRjaFtrXSA+IG1vZGVfbGliLT52YmEuUGl0Y2hZW2tdKSB7
CisJCQltb2RlX2xpYi0+dmJhLlBpdGNoU3VwcG9ydCA9IGZhbHNlOworCQl9CisJCWlmIChtb2Rl
X2xpYi0+dmJhLkRDQ0VuYWJsZVtrXSA9PSB0cnVlKSB7CisJCQlsb2NhbHMtPkFsaWduZWREQ0NN
ZXRhUGl0Y2hba10gPSBkbWxfY2VpbCgKKwkJCQkJZG1sX21heCgKKwkJCQkJCQltb2RlX2xpYi0+
dmJhLkRDQ01ldGFQaXRjaFlba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydFdpZHRo
W2tdKSwKKwkJCQkJNjQuMCAqIGxvY2Fscy0+UmVhZDI1NkJsb2NrV2lkdGhZW2tdKTsKKwkJfSBl
bHNlIHsKKwkJCWxvY2Fscy0+QWxpZ25lZERDQ01ldGFQaXRjaFtrXSA9IG1vZGVfbGliLT52YmEu
RENDTWV0YVBpdGNoWVtrXTsKKwkJfQorCQlpZiAobG9jYWxzLT5BbGlnbmVkRENDTWV0YVBpdGNo
W2tdID4gbW9kZV9saWItPnZiYS5EQ0NNZXRhUGl0Y2hZW2tdKSB7CisJCQltb2RlX2xpYi0+dmJh
LlBpdGNoU3VwcG9ydCA9IGZhbHNlOworCQl9CisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBp
eGVsRm9ybWF0W2tdICE9IGRtXzQ0NF82NAorCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4
ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzMyCisJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhl
bEZvcm1hdFtrXSAhPSBkbV80NDRfMTYKKwkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVs
Rm9ybWF0W2tdICE9IGRtX21vbm9fMTYKKwkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVs
Rm9ybWF0W2tdICE9IGRtX21vbm9fOCkgeworCQkJbG9jYWxzLT5BbGlnbmVkQ1BpdGNoW2tdID0g
ZG1sX2NlaWwoCisJCQkJCWRtbF9tYXgoCisJCQkJCQkJbW9kZV9saWItPnZiYS5QaXRjaENba10s
CisJCQkJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydFdpZHRoW2tdIC8gMi4wKSwKKwkJCQkJbG9j
YWxzLT5NYWNyb1RpbGVXaWR0aENba10pOworCQl9IGVsc2UgeworCQkJbG9jYWxzLT5BbGlnbmVk
Q1BpdGNoW2tdID0gbW9kZV9saWItPnZiYS5QaXRjaENba107CisJCX0KKwkJaWYgKGxvY2Fscy0+
QWxpZ25lZENQaXRjaFtrXSA+IG1vZGVfbGliLT52YmEuUGl0Y2hDW2tdKSB7CisJCQltb2RlX2xp
Yi0+dmJhLlBpdGNoU3VwcG9ydCA9IGZhbHNlOworCQl9CisJfQorCS8qTW9kZSBTdXBwb3J0LCBW
b2x0YWdlIFN0YXRlIGFuZCBTT0MgQ29uZmlndXJhdGlvbiovCisKKwlmb3IgKGkgPSBtb2RlX2xp
Yi0+dmJhLnNvYy5udW1fc3RhdGVzOyBpID49IDA7IGktLSkgeworCQlmb3IgKGogPSAwOyBqIDwg
MjsgaisrKSB7CisJCQllbnVtIGRtX3ZhbGlkYXRpb25fc3RhdHVzIHN0YXR1cyA9IERNTF9WQUxJ
REFUSU9OX09LOworCisJCQlpZiAobW9kZV9saWItPnZiYS5TY2FsZVJhdGlvQW5kVGFwc1N1cHBv
cnQgIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERNTF9GQUlMX1NDQUxFX1JBVElPX1RBUDsKKwkJ
CX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VGb3JtYXRQaXhlbEFuZFNjYW5TdXBwb3J0
ICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9TT1VSQ0VfUElYRUxfRk9STUFUOwor
CQkJfSBlbHNlIGlmIChsb2NhbHMtPlZpZXdwb3J0U2l6ZVN1cHBvcnRbaV0gIT0gdHJ1ZSkgewor
CQkJCXN0YXR1cyA9IERNTF9GQUlMX1ZJRVdQT1JUX1NJWkU7CisJCQl9IGVsc2UgaWYgKGxvY2Fs
cy0+RElPU3VwcG9ydFtpXSAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfRElPX1NV
UFBPUlQ7CisJCQl9IGVsc2UgaWYgKGxvY2Fscy0+Tm90RW5vdWdoRFNDVW5pdHNbaV0gIT0gZmFs
c2UpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9OT1RfRU5PVUdIX0RTQzsKKwkJCX0gZWxzZSBp
ZiAobG9jYWxzLT5EU0NDTEtSZXF1aXJlZE1vcmVUaGFuU3VwcG9ydGVkW2ldICE9IGZhbHNlKSB7
CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfRFNDX0NMS19SRVFVSVJFRDsKKwkJCX0gZWxzZSBpZiAo
bG9jYWxzLT5ST0JTdXBwb3J0W2ldICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9S
RU9SREVSSU5HX0JVRkZFUjsKKwkJCX0gZWxzZSBpZiAobG9jYWxzLT5ESVNQQ0xLX0RQUENMS19T
dXBwb3J0W2ldW2pdICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9ESVNQQ0xLX0RQ
UENMSzsKKwkJCX0gZWxzZSBpZiAobG9jYWxzLT5Ub3RhbEF2YWlsYWJsZVBpcGVzU3VwcG9ydFtp
XVtqXSAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfVE9UQUxfQVZBSUxBQkxFX1BJ
UEVTOworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLk51bWJlck9mT1RHU3VwcG9ydCAhPSB0
cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfTlVNX09URzsKKwkJCX0gZWxzZSBpZiAobW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tNb2RlU3VwcG9ydCAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0g
RE1MX0ZBSUxfV1JJVEVCQUNLX01PREU7CisJCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuV3Jp
dGViYWNrTGF0ZW5jeVN1cHBvcnQgIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERNTF9GQUlMX1dS
SVRFQkFDS19MQVRFTkNZOworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja1Nj
YWxlUmF0aW9BbmRUYXBzU3VwcG9ydCAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxf
V1JJVEVCQUNLX1NDQUxFX1JBVElPX1RBUDsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5D
dXJzb3JTdXBwb3J0ICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9DVVJTT1JfU1VQ
UE9SVDsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5QaXRjaFN1cHBvcnQgIT0gdHJ1ZSkg
eworCQkJCXN0YXR1cyA9IERNTF9GQUlMX1BJVENIX1NVUFBPUlQ7CisJCQl9IGVsc2UgaWYgKGxv
Y2Fscy0+VG90YWxWZXJ0aWNhbEFjdGl2ZUJhbmR3aWR0aFN1cHBvcnRbaV0gIT0gdHJ1ZSkgewor
CQkJCXN0YXR1cyA9IERNTF9GQUlMX1RPVEFMX1ZfQUNUSVZFX0JXOworCQkJfSBlbHNlIGlmIChs
b2NhbHMtPlBURUJ1ZmZlclNpemVOb3RFeGNlZWRlZFtpXVtqXSAhPSB0cnVlKSB7CisJCQkJc3Rh
dHVzID0gRE1MX0ZBSUxfUFRFX0JVRkZFUl9TSVpFOworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+
dmJhLk5vbnN1cHBvcnRlZERTQ0lucHV0QlBDICE9IGZhbHNlKSB7CisJCQkJc3RhdHVzID0gRE1M
X0ZBSUxfRFNDX0lOUFVUX0JQQzsKKwkJCX0gZWxzZSBpZiAoKG1vZGVfbGliLT52YmEuSG9zdFZN
RW5hYmxlICE9IGZhbHNlCisJCQkJCSYmIGxvY2Fscy0+SW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZv
clN0YXRlW2ldW2pdICE9IHRydWUpKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfSE9TVF9WTV9J
TU1FRElBVEVfRkxJUDsKKwkJCX0gZWxzZSBpZiAobG9jYWxzLT5QcmVmZXRjaFN1cHBvcnRlZFtp
XVtqXSAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfUFJFRkVUQ0hfU1VQUE9SVDsK
KwkJCX0gZWxzZSBpZiAobG9jYWxzLT5WUmF0aW9JblByZWZldGNoU3VwcG9ydGVkW2ldW2pdICE9
IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9WX1JBVElPX1BSRUZFVENIOworCQkJfQor
CisJCQlpZiAoc3RhdHVzID09IERNTF9WQUxJREFUSU9OX09LKSB7CisJCQkJbG9jYWxzLT5Nb2Rl
U3VwcG9ydFtpXVtqXSA9IHRydWU7CisJCQl9IGVsc2UgeworCQkJCWxvY2Fscy0+TW9kZVN1cHBv
cnRbaV1bal0gPSBmYWxzZTsKKwkJCX0KKwkJCWxvY2Fscy0+VmFsaWRhdGlvblN0YXR1c1tpXSA9
IHN0YXR1czsKKwkJfQorCX0KKwl7CisJCXVuc2lnbmVkIGludCBNYXhpbXVtTVBDQ29tYmluZSA9
IDA7CisJCW1vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsID0gbW9kZV9saWItPnZiYS5zb2MubnVt
X3N0YXRlcyArIDE7CisJCWZvciAoaSA9IG1vZGVfbGliLT52YmEuVm9sdGFnZU92ZXJyaWRlTGV2
ZWw7IGkgPD0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJCQlpZiAobG9j
YWxzLT5Nb2RlU3VwcG9ydFtpXVswXSA9PSB0cnVlIHx8IGxvY2Fscy0+TW9kZVN1cHBvcnRbaV1b
MV0gPT0gdHJ1ZSkgeworCQkJCW1vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsID0gaTsKKwkJCQlp
ZiAobG9jYWxzLT5Nb2RlU3VwcG9ydFtpXVsxXSA9PSB0cnVlICYmIChsb2NhbHMtPk1vZGVTdXBw
b3J0W2ldWzBdID09IGZhbHNlCisJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLldoZW5Ub0RvTVBDQ29t
YmluZSA9PSBkbV9tcGNfYWx3YXlzX3doZW5fcG9zc2libGUKKwkJCQkJCXx8IChtb2RlX2xpYi0+
dmJhLldoZW5Ub0RvTVBDQ29tYmluZSA9PSBkbV9tcGNfcmVkdWNlX3ZvbHRhZ2VfYW5kX2Nsb2Nr
cworCQkJCQkJCSYmICgobG9jYWxzLT5EUkFNQ2xvY2tDaGFuZ2VTdXBwb3J0W2ldWzFdID09IGRt
X2RyYW1fY2xvY2tfY2hhbmdlX3ZhY3RpdmUKKwkJCQkJCQkJJiYgbG9jYWxzLT5EUkFNQ2xvY2tD
aGFuZ2VTdXBwb3J0W2ldWzBdICE9IGRtX2RyYW1fY2xvY2tfY2hhbmdlX3ZhY3RpdmUpCisJCQkJ
CQkJfHwgKGxvY2Fscy0+RFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFtpXVsxXSA9PSBkbV9kcmFtX2Ns
b2NrX2NoYW5nZV92YmxhbmsKKwkJCQkJCQkJJiYgbG9jYWxzLT5EUkFNQ2xvY2tDaGFuZ2VTdXBw
b3J0W2ldWzBdID09IGRtX2RyYW1fY2xvY2tfY2hhbmdlX3Vuc3VwcG9ydGVkKSkpKSkgeworCQkJ
CQlNYXhpbXVtTVBDQ29tYmluZSA9IDE7CisJCQkJfSBlbHNlIHsKKwkJCQkJTWF4aW11bU1QQ0Nv
bWJpbmUgPSAwOworCQkJCX0KKwkJCQlicmVhazsKKwkJCX0KKwkJfQorCQltb2RlX2xpYi0+dmJh
LkltbWVkaWF0ZUZsaXBTdXBwb3J0ID0KKwkJCWxvY2Fscy0+SW1tZWRpYXRlRmxpcFN1cHBvcnRl
ZEZvclN0YXRlW21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXVtNYXhpbXVtTVBDQ29tYmluZV07
CisJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAt
IDE7IGsrKykgeworCQkJbW9kZV9saWItPnZiYS5EUFBQZXJQbGFuZVtrXSA9IGxvY2Fscy0+Tm9P
ZkRQUFttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1bTWF4aW11bU1QQ0NvbWJpbmVdW2tdOwor
CQkJbG9jYWxzLT5EUFBDTEtba10gPSBsb2NhbHMtPlJlcXVpcmVkRFBQQ0xLW21vZGVfbGliLT52
YmEuVm9sdGFnZUxldmVsXVtNYXhpbXVtTVBDQ29tYmluZV1ba107CisJCX0KKwkJbW9kZV9saWIt
PnZiYS5ESVNQQ0xLID0gbG9jYWxzLT5SZXF1aXJlZERJU1BDTEtbbW9kZV9saWItPnZiYS5Wb2x0
YWdlTGV2ZWxdW01heGltdW1NUENDb21iaW5lXTsKKwkJbW9kZV9saWItPnZiYS5tYXhNcGNDb21i
ID0gTWF4aW11bU1QQ0NvbWJpbmU7CisJfQorCW1vZGVfbGliLT52YmEuRENGQ0xLID0gbW9kZV9s
aWItPnZiYS5EQ0ZDTEtQZXJTdGF0ZVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF07CisJbW9k
ZV9saWItPnZiYS5EUkFNU3BlZWQgPSBtb2RlX2xpYi0+dmJhLkRSQU1TcGVlZFBlclN0YXRlW21v
ZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXTsKKwltb2RlX2xpYi0+dmJhLkZhYnJpY0Nsb2NrID0g
bW9kZV9saWItPnZiYS5GYWJyaWNDbG9ja1BlclN0YXRlW21vZGVfbGliLT52YmEuVm9sdGFnZUxl
dmVsXTsKKwltb2RlX2xpYi0+dmJhLlNPQ0NMSyA9IG1vZGVfbGliLT52YmEuU09DQ0xLUGVyU3Rh
dGVbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdOworCW1vZGVfbGliLT52YmEuUmV0dXJuQlcg
PSBsb2NhbHMtPlJldHVybkJXUGVyU3RhdGVbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdOwor
CWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7
IGsrKykgeworCQlpZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBrKSB7
CisJCQltb2RlX2xpYi0+dmJhLk9ETUNvbWJpbmVFbmFibGVkW2tdID0KKwkJCQkJbG9jYWxzLT5P
RE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdW2tdOwor
CQl9IGVsc2UgeworCQkJbW9kZV9saWItPnZiYS5PRE1Db21iaW5lRW5hYmxlZFtrXSA9IDA7CisJ
CX0KKwkJbW9kZV9saWItPnZiYS5EU0NFbmFibGVkW2tdID0KKwkJCQlsb2NhbHMtPlJlcXVpcmVz
RFNDW21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXVtrXTsKKwkJbW9kZV9saWItPnZiYS5PdXRw
dXRCcHBba10gPQorCQkJCWxvY2Fscy0+T3V0cHV0QnBwUGVyU3RhdGVbbW9kZV9saWItPnZiYS5W
b2x0YWdlTGV2ZWxdW2tdOworCX0KK30KKworc3RhdGljIHZvaWQgQ2FsY3VsYXRlV2F0ZXJtYXJr
c0FuZERSQU1TcGVlZENoYW5nZVN1cHBvcnQoCisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICpt
b2RlX2xpYiwKKwkJdW5zaWduZWQgaW50IFByZWZldGNoTW9kZSwKKwkJdW5zaWduZWQgaW50IE51
bWJlck9mQWN0aXZlUGxhbmVzLAorCQl1bnNpZ25lZCBpbnQgTWF4TGluZUJ1ZmZlckxpbmVzLAor
CQl1bnNpZ25lZCBpbnQgTGluZUJ1ZmZlclNpemUsCisJCXVuc2lnbmVkIGludCBEUFBPdXRwdXRC
dWZmZXJQaXhlbHMsCisJCWRvdWJsZSBERVRCdWZmZXJTaXplSW5LQnl0ZSwKKwkJdW5zaWduZWQg
aW50IFdyaXRlYmFja0ludGVyZmFjZUx1bWFCdWZmZXJTaXplLAorCQl1bnNpZ25lZCBpbnQgV3Jp
dGViYWNrSW50ZXJmYWNlQ2hyb21hQnVmZmVyU2l6ZSwKKwkJZG91YmxlIERDRkNMSywKKwkJZG91
YmxlIFVyZ2VudE91dE9mT3JkZXJSZXR1cm4sCisJCWRvdWJsZSBSZXR1cm5CVywKKwkJYm9vbCBH
UFVWTUVuYWJsZSwKKwkJbG9uZyBkcHRlX2dyb3VwX2J5dGVzW10sCisJCXVuc2lnbmVkIGludCBN
ZXRhQ2h1bmtTaXplLAorCQlkb3VibGUgVXJnZW50TGF0ZW5jeSwKKwkJZG91YmxlIEV4dHJhTGF0
ZW5jeSwKKwkJZG91YmxlIFdyaXRlYmFja0xhdGVuY3ksCisJCWRvdWJsZSBXcml0ZWJhY2tDaHVu
a1NpemUsCisJCWRvdWJsZSBTT0NDTEssCisJCWRvdWJsZSBEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5
LAorCQlkb3VibGUgU1JFeGl0VGltZSwKKwkJZG91YmxlIFNSRW50ZXJQbHVzRXhpdFRpbWUsCisJ
CWRvdWJsZSBEQ0ZDTEtEZWVwU2xlZXAsCisJCWludCBEUFBQZXJQbGFuZVtdLAorCQlib29sIERD
Q0VuYWJsZVtdLAorCQlkb3VibGUgRFBQQ0xLW10sCisJCXVuc2lnbmVkIGludCBTd2F0aFdpZHRo
U2luZ2xlRFBQWVtdLAorCQl1bnNpZ25lZCBpbnQgU3dhdGhIZWlnaHRZW10sCisJCWRvdWJsZSBS
ZWFkQmFuZHdpZHRoUGxhbmVMdW1hW10sCisJCXVuc2lnbmVkIGludCBTd2F0aEhlaWdodENbXSwK
KwkJZG91YmxlIFJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtdLAorCQl1bnNpZ25lZCBpbnQgTEJC
aXRQZXJQaXhlbFtdLAorCQl1bnNpZ25lZCBpbnQgU3dhdGhXaWR0aFlbXSwKKwkJZG91YmxlIEhS
YXRpb1tdLAorCQl1bnNpZ25lZCBpbnQgdnRhcHNbXSwKKwkJdW5zaWduZWQgaW50IFZUQVBzQ2hy
b21hW10sCisJCWRvdWJsZSBWUmF0aW9bXSwKKwkJdW5zaWduZWQgaW50IEhUb3RhbFtdLAorCQlk
b3VibGUgUGl4ZWxDbG9ja1tdLAorCQl1bnNpZ25lZCBpbnQgQmxlbmRpbmdBbmRUaW1pbmdbXSwK
KwkJZG91YmxlIEJ5dGVQZXJQaXhlbERFVFlbXSwKKwkJZG91YmxlIEJ5dGVQZXJQaXhlbERFVENb
XSwKKwkJYm9vbCBXcml0ZWJhY2tFbmFibGVbXSwKKwkJZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNz
IFdyaXRlYmFja1BpeGVsRm9ybWF0W10sCisJCWRvdWJsZSBXcml0ZWJhY2tEZXN0aW5hdGlvbldp
ZHRoW10sCisJCWRvdWJsZSBXcml0ZWJhY2tEZXN0aW5hdGlvbkhlaWdodFtdLAorCQlkb3VibGUg
V3JpdGViYWNrU291cmNlSGVpZ2h0W10sCisJCWVudW0gY2xvY2tfY2hhbmdlX3N1cHBvcnQgKkRS
QU1DbG9ja0NoYW5nZVN1cHBvcnQsCisJCWRvdWJsZSAqVXJnZW50V2F0ZXJtYXJrLAorCQlkb3Vi
bGUgKldyaXRlYmFja1VyZ2VudFdhdGVybWFyaywKKwkJZG91YmxlICpEUkFNQ2xvY2tDaGFuZ2VX
YXRlcm1hcmssCisJCWRvdWJsZSAqV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrLAor
CQlkb3VibGUgKlN0dXR0ZXJFeGl0V2F0ZXJtYXJrLAorCQlkb3VibGUgKlN0dXR0ZXJFbnRlclBs
dXNFeGl0V2F0ZXJtYXJrLAorCQlkb3VibGUgKk1pbkFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVu
Y3lTdXBwb3J0ZWQpCit7CisJZG91YmxlIEVmZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ1k7CisJZG91
YmxlIEVmZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ0M7CisJZG91YmxlIERQUE91dHB1dEJ1ZmZlckxp
bmVzWTsKKwlkb3VibGUgRFBQT3V0cHV0QnVmZmVyTGluZXNDOworCWRvdWJsZSBERVRCdWZmZXJT
aXplWTsKKwlkb3VibGUgREVUQnVmZmVyU2l6ZUM7CisJZG91YmxlIExpbmVzSW5ERVRZW0RDX19O
VU1fRFBQX19NQVhdOworCWRvdWJsZSBMaW5lc0luREVUQzsKKwl1bnNpZ25lZCBpbnQgTGluZXNJ
bkRFVFlSb3VuZGVkRG93blRvU3dhdGhbRENfX05VTV9EUFBfX01BWF07CisJdW5zaWduZWQgaW50
IExpbmVzSW5ERVRDUm91bmRlZERvd25Ub1N3YXRoOworCWRvdWJsZSBGdWxsREVUQnVmZmVyaW5n
VGltZVlbRENfX05VTV9EUFBfX01BWF07CisJZG91YmxlIEZ1bGxERVRCdWZmZXJpbmdUaW1lQzsK
Kwlkb3VibGUgQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1hcmdpblk7CisJZG91YmxlIEFj
dGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5DOworCWRvdWJsZSBXcml0ZWJhY2tEUkFN
Q2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luOworCWRvdWJsZSBQbGFuZVdpdGhNaW5BY3RpdmVEUkFN
Q2xvY2tDaGFuZ2VNYXJnaW47CisJZG91YmxlIFNlY29uZE1pbkFjdGl2ZURSQU1DbG9ja0NoYW5n
ZU1hcmdpbk9uZURpc3BsYXlJblZCTGFuazsKKwlkb3VibGUgRnVsbERFVEJ1ZmZlcmluZ1RpbWVZ
U3R1dHRlckNyaXRpY2FsUGxhbmUgPSAwOworCWRvdWJsZSBUaW1lVG9GaW5pc2hTd2F0aFRyYW5z
ZmVyU3R1dHRlckNyaXRpY2FsUGxhbmUgPSAwOworCXVpbnQgaywgajsKKworCW1vZGVfbGliLT52
YmEuVG90YWxBY3RpdmVEUFAgPSAwOworCW1vZGVfbGliLT52YmEuVG90YWxEQ0NBY3RpdmVEUFAg
PSAwOworCWZvciAoayA9IDA7IGsgPCBOdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCW1v
ZGVfbGliLT52YmEuVG90YWxBY3RpdmVEUFAgPSBtb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlRFBQ
ICsgRFBQUGVyUGxhbmVba107CisJCWlmIChEQ0NFbmFibGVba10gPT0gdHJ1ZSkgeworCQkJbW9k
ZV9saWItPnZiYS5Ub3RhbERDQ0FjdGl2ZURQUCA9IG1vZGVfbGliLT52YmEuVG90YWxEQ0NBY3Rp
dmVEUFAgKyBEUFBQZXJQbGFuZVtrXTsKKwkJfQorCX0KKworCW1vZGVfbGliLT52YmEuVG90YWxE
YXRhUmVhZEJhbmR3aWR0aCA9IDA7CisJZm9yIChrID0gMDsgayA8IE51bWJlck9mQWN0aXZlUGxh
bmVzOyArK2spIHsKKwkJbW9kZV9saWItPnZiYS5Ub3RhbERhdGFSZWFkQmFuZHdpZHRoID0gbW9k
ZV9saWItPnZiYS5Ub3RhbERhdGFSZWFkQmFuZHdpZHRoCisJCQkJKyBSZWFkQmFuZHdpZHRoUGxh
bmVMdW1hW2tdICsgUmVhZEJhbmR3aWR0aFBsYW5lQ2hyb21hW2tdOworCX0KKworCSpVcmdlbnRX
YXRlcm1hcmsgPSBVcmdlbnRMYXRlbmN5ICsgRXh0cmFMYXRlbmN5OworCisJKkRSQU1DbG9ja0No
YW5nZVdhdGVybWFyayA9IERSQU1DbG9ja0NoYW5nZUxhdGVuY3kgKyAqVXJnZW50V2F0ZXJtYXJr
OworCisJbW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZVdyaXRlYmFjayA9IDA7CisJZm9yIChrID0g
MDsgayA8IE51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKFdyaXRlYmFja0VuYWJs
ZVtrXSA9PSB0cnVlKSB7CisJCQltb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlV3JpdGViYWNrID0g
bW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZVdyaXRlYmFjayArIDE7CisJCX0KKwl9CisKKwlpZiAo
bW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZVdyaXRlYmFjayA8PSAxKSB7CisJCSpXcml0ZWJhY2tV
cmdlbnRXYXRlcm1hcmsgPSBXcml0ZWJhY2tMYXRlbmN5OworCX0gZWxzZSB7CisJCSpXcml0ZWJh
Y2tVcmdlbnRXYXRlcm1hcmsgPSBXcml0ZWJhY2tMYXRlbmN5CisJCQkJKyBXcml0ZWJhY2tDaHVu
a1NpemUgKiAxMDI0LjAgLyAzMi4wIC8gU09DQ0xLOworCX0KKworCWlmIChtb2RlX2xpYi0+dmJh
LlRvdGFsQWN0aXZlV3JpdGViYWNrIDw9IDEpIHsKKwkJKldyaXRlYmFja0RSQU1DbG9ja0NoYW5n
ZVdhdGVybWFyayA9IERSQU1DbG9ja0NoYW5nZUxhdGVuY3kgKyBXcml0ZWJhY2tMYXRlbmN5Owor
CX0gZWxzZSB7CisJCSpXcml0ZWJhY2tEUkFNQ2xvY2tDaGFuZ2VXYXRlcm1hcmsgPSBEUkFNQ2xv
Y2tDaGFuZ2VMYXRlbmN5ICsgV3JpdGViYWNrTGF0ZW5jeQorCQkJCSsgV3JpdGViYWNrQ2h1bmtT
aXplICogMTAyNC4wIC8gMzIuMCAvIFNPQ0NMSzsKKwl9CisKKwlmb3IgKGsgPSAwOyBrIDwgTnVt
YmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCisJCW1vZGVfbGliLT52YmEuTEJMYXRlbmN5SGlk
aW5nU291cmNlTGluZXNZID0gZG1sX21pbigoZG91YmxlKSBNYXhMaW5lQnVmZmVyTGluZXMsCisJ
CQlkbWxfZmxvb3IoTGluZUJ1ZmZlclNpemUgLyBMQkJpdFBlclBpeGVsW2tdIC8gKFN3YXRoV2lk
dGhZW2tdIC8gZG1sX21heChIUmF0aW9ba10sIDEuMCkpLCAxKSkKKwkJCQktICh2dGFwc1trXSAt
IDEpOworCisJCW1vZGVfbGliLT52YmEuTEJMYXRlbmN5SGlkaW5nU291cmNlTGluZXNDID0gZG1s
X21pbigoZG91YmxlKSBNYXhMaW5lQnVmZmVyTGluZXMsCisJCQlkbWxfZmxvb3IoTGluZUJ1ZmZl
clNpemUgLyBMQkJpdFBlclBpeGVsW2tdIC8gKFN3YXRoV2lkdGhZW2tdIC8gMiAvIGRtbF9tYXgo
SFJhdGlvW2tdIC8gMiwgMS4wKSksIDEpKQorCQkJCS0gKFZUQVBzQ2hyb21hW2tdIC0gMSk7CisK
KwkJRWZmZWN0aXZlTEJMYXRlbmN5SGlkaW5nWSA9IG1vZGVfbGliLT52YmEuTEJMYXRlbmN5SGlk
aW5nU291cmNlTGluZXNZIC8gVlJhdGlvW2tdCisJCQkJKiAoSFRvdGFsW2tdIC8gUGl4ZWxDbG9j
a1trXSk7CisKKwkJRWZmZWN0aXZlTEJMYXRlbmN5SGlkaW5nQyA9IG1vZGVfbGliLT52YmEuTEJM
YXRlbmN5SGlkaW5nU291cmNlTGluZXNDCisJCQkJLyAoVlJhdGlvW2tdIC8gMikgKiAoSFRvdGFs
W2tdIC8gUGl4ZWxDbG9ja1trXSk7CisKKwkJaWYgKFN3YXRoV2lkdGhZW2tdID4gMiAqIERQUE91
dHB1dEJ1ZmZlclBpeGVscykgeworCQkJRFBQT3V0cHV0QnVmZmVyTGluZXNZID0gKGRvdWJsZSkg
RFBQT3V0cHV0QnVmZmVyUGl4ZWxzIC8gU3dhdGhXaWR0aFlba107CisJCX0gZWxzZSBpZiAoU3dh
dGhXaWR0aFlba10gPiBEUFBPdXRwdXRCdWZmZXJQaXhlbHMpIHsKKwkJCURQUE91dHB1dEJ1ZmZl
ckxpbmVzWSA9IDAuNTsKKwkJfSBlbHNlIHsKKwkJCURQUE91dHB1dEJ1ZmZlckxpbmVzWSA9IDE7
CisJCX0KKworCQlpZiAoU3dhdGhXaWR0aFlba10gLyAyLjAgPiAyICogRFBQT3V0cHV0QnVmZmVy
UGl4ZWxzKSB7CisJCQlEUFBPdXRwdXRCdWZmZXJMaW5lc0MgPSAoZG91YmxlKSBEUFBPdXRwdXRC
dWZmZXJQaXhlbHMKKwkJCQkJLyAoU3dhdGhXaWR0aFlba10gLyAyLjApOworCQl9IGVsc2UgaWYg
KFN3YXRoV2lkdGhZW2tdIC8gMi4wID4gRFBQT3V0cHV0QnVmZmVyUGl4ZWxzKSB7CisJCQlEUFBP
dXRwdXRCdWZmZXJMaW5lc0MgPSAwLjU7CisJCX0gZWxzZSB7CisJCQlEUFBPdXRwdXRCdWZmZXJM
aW5lc0MgPSAxOworCQl9CisKKwkJQ2FsY3VsYXRlREVUQnVmZmVyU2l6ZSgKKwkJCQlERVRCdWZm
ZXJTaXplSW5LQnl0ZSwKKwkJCQlTd2F0aEhlaWdodFlba10sCisJCQkJU3dhdGhIZWlnaHRDW2td
LAorCQkJCSZERVRCdWZmZXJTaXplWSwKKwkJCQkmREVUQnVmZmVyU2l6ZUMpOworCisJCUxpbmVz
SW5ERVRZW2tdID0gREVUQnVmZmVyU2l6ZVkgLyBCeXRlUGVyUGl4ZWxERVRZW2tdIC8gU3dhdGhX
aWR0aFlba107CisJCUxpbmVzSW5ERVRZUm91bmRlZERvd25Ub1N3YXRoW2tdID0gZG1sX2Zsb29y
KExpbmVzSW5ERVRZW2tdLCBTd2F0aEhlaWdodFlba10pOworCQlGdWxsREVUQnVmZmVyaW5nVGlt
ZVlba10gPSBMaW5lc0luREVUWVJvdW5kZWREb3duVG9Td2F0aFtrXQorCQkJCSogKEhUb3RhbFtr
XSAvIFBpeGVsQ2xvY2tba10pIC8gVlJhdGlvW2tdOworCQlpZiAoQnl0ZVBlclBpeGVsREVUQ1tr
XSA+IDApIHsKKwkJCUxpbmVzSW5ERVRDID0gREVUQnVmZmVyU2l6ZUMgLyBCeXRlUGVyUGl4ZWxE
RVRDW2tdIC8gKFN3YXRoV2lkdGhZW2tdIC8gMi4wKTsKKwkJCUxpbmVzSW5ERVRDUm91bmRlZERv
d25Ub1N3YXRoID0gZG1sX2Zsb29yKExpbmVzSW5ERVRDLCBTd2F0aEhlaWdodENba10pOworCQkJ
RnVsbERFVEJ1ZmZlcmluZ1RpbWVDID0gTGluZXNJbkRFVENSb3VuZGVkRG93blRvU3dhdGgKKwkJ
CQkJKiAoSFRvdGFsW2tdIC8gUGl4ZWxDbG9ja1trXSkgLyAoVlJhdGlvW2tdIC8gMik7CisJCX0g
ZWxzZSB7CisJCQlMaW5lc0luREVUQyA9IDA7CisJCQlGdWxsREVUQnVmZmVyaW5nVGltZUMgPSA5
OTk5OTk7CisJCX0KKworCQlBY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luWSA9IEhU
b3RhbFtrXSAvIFBpeGVsQ2xvY2tba10KKwkJCQkqIERQUE91dHB1dEJ1ZmZlckxpbmVzWSArIEVm
ZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ1kKKwkJCQkrIEZ1bGxERVRCdWZmZXJpbmdUaW1lWVtrXSAt
ICpEUkFNQ2xvY2tDaGFuZ2VXYXRlcm1hcms7CisKKwkJaWYgKE51bWJlck9mQWN0aXZlUGxhbmVz
ID4gMSkgeworCQkJQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1hcmdpblkgPSBBY3RpdmVE
UkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luWQorCQkJCS0gKDEgLSAxLjAgLyBOdW1iZXJPZkFj
dGl2ZVBsYW5lcykgKiBTd2F0aEhlaWdodFlba10gKiBIVG90YWxba10gLyBQaXhlbENsb2NrW2td
IC8gVlJhdGlvW2tdOworCQl9CisKKwkJaWYgKEJ5dGVQZXJQaXhlbERFVENba10gPiAwKSB7CisJ
CQlBY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luQyA9IEhUb3RhbFtrXSAvIFBpeGVs
Q2xvY2tba10KKwkJCQkJKiBEUFBPdXRwdXRCdWZmZXJMaW5lc0MgKyBFZmZlY3RpdmVMQkxhdGVu
Y3lIaWRpbmdDCisJCQkJCSsgRnVsbERFVEJ1ZmZlcmluZ1RpbWVDIC0gKkRSQU1DbG9ja0NoYW5n
ZVdhdGVybWFyazsKKwkJCWlmIChOdW1iZXJPZkFjdGl2ZVBsYW5lcyA+IDEpIHsKKwkJCQlBY3Rp
dmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luQyA9IEFjdGl2ZURSQU1DbG9ja0NoYW5nZUxh
dGVuY3lNYXJnaW5DCisJCQkJCS0gKDEgLSAxLjAgLyBOdW1iZXJPZkFjdGl2ZVBsYW5lcykgKiBT
d2F0aEhlaWdodENba10gKiBIVG90YWxba10gLyBQaXhlbENsb2NrW2tdIC8gKFZSYXRpb1trXSAv
IDIpOworCQkJfQorCQkJbW9kZV9saWItPnZiYS5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5
TWFyZ2luW2tdID0gZG1sX21pbigKKwkJCQkJQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1h
cmdpblksCisJCQkJCUFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5DKTsKKwkJfSBl
bHNlIHsKKwkJCW1vZGVfbGliLT52YmEuQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1hcmdp
bltrXSA9IEFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5ZOworCQl9CisKKwkJaWYg
KFdyaXRlYmFja0VuYWJsZVtrXSA9PSB0cnVlKSB7CisJCQlpZiAoV3JpdGViYWNrUGl4ZWxGb3Jt
YXRba10gPT0gZG1fNDQ0XzMyKSB7CisJCQkJV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlTGF0ZW5j
eU1hcmdpbiA9IChXcml0ZWJhY2tJbnRlcmZhY2VMdW1hQnVmZmVyU2l6ZQorCQkJCQkrIFdyaXRl
YmFja0ludGVyZmFjZUNocm9tYUJ1ZmZlclNpemUpIC8gKFdyaXRlYmFja0Rlc3RpbmF0aW9uV2lk
dGhba10KKwkJCQkJKiBXcml0ZWJhY2tEZXN0aW5hdGlvbkhlaWdodFtrXSAvIChXcml0ZWJhY2tT
b3VyY2VIZWlnaHRba10gKiBIVG90YWxba10KKwkJCQkJLyBQaXhlbENsb2NrW2tdKSAqIDQpIC0g
KldyaXRlYmFja0RSQU1DbG9ja0NoYW5nZVdhdGVybWFyazsKKwkJCX0gZWxzZSB7CisJCQkJV3Jp
dGViYWNrRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1hcmdpbiA9IGRtbF9taW4oCisJCQkJCQlXcml0
ZWJhY2tJbnRlcmZhY2VMdW1hQnVmZmVyU2l6ZSAqIDguMCAvIDEwLAorCQkJCQkJMiAqIFdyaXRl
YmFja0ludGVyZmFjZUNocm9tYUJ1ZmZlclNpemUgKiA4LjAgLyAxMCkgLyAoV3JpdGViYWNrRGVz
dGluYXRpb25XaWR0aFtrXQorCQkJCQkJCSogV3JpdGViYWNrRGVzdGluYXRpb25IZWlnaHRba10g
LyAoV3JpdGViYWNrU291cmNlSGVpZ2h0W2tdICogSFRvdGFsW2tdIC8gUGl4ZWxDbG9ja1trXSkp
CisJCQkJCQktICpXcml0ZWJhY2tEUkFNQ2xvY2tDaGFuZ2VXYXRlcm1hcms7CisJCQl9CisJCQlt
b2RlX2xpYi0+dmJhLkFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5ba10gPSBkbWxf
bWluKAorCQkJCQltb2RlX2xpYi0+dmJhLkFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJn
aW5ba10sCisJCQkJCVdyaXRlYmFja0RSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJnaW4pOworCQl9
CisJfQorCisJbW9kZV9saWItPnZiYS5NaW5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VNYXJnaW4gPSA5
OTk5OTk7CisJUGxhbmVXaXRoTWluQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTWFyZ2luID0gMDsKKwlm
b3IgKGsgPSAwOyBrIDwgTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlpZiAobW9kZV9s
aWItPnZiYS5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luW2tdCisJCQkJPCBtb2Rl
X2xpYi0+dmJhLk1pbkFjdGl2ZURSQU1DbG9ja0NoYW5nZU1hcmdpbikgeworCQkJbW9kZV9saWIt
PnZiYS5NaW5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VNYXJnaW4gPQorCQkJCQltb2RlX2xpYi0+dmJh
LkFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5ba107CisJCQlpZiAoQmxlbmRpbmdB
bmRUaW1pbmdba10gPT0gaykgeworCQkJCVBsYW5lV2l0aE1pbkFjdGl2ZURSQU1DbG9ja0NoYW5n
ZU1hcmdpbiA9IGs7CisJCQl9IGVsc2UgeworCQkJCWZvciAoaiA9IDA7IGogPCBOdW1iZXJPZkFj
dGl2ZVBsYW5lczsgKytqKSB7CisJCQkJCWlmIChCbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBqKSB7
CisJCQkJCQlQbGFuZVdpdGhNaW5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VNYXJnaW4gPSBqOworCQkJ
CQl9CisJCQkJfQorCQkJfQorCQl9CisJfQorCisJKk1pbkFjdGl2ZURSQU1DbG9ja0NoYW5nZUxh
dGVuY3lTdXBwb3J0ZWQgPSBtb2RlX2xpYi0+dmJhLk1pbkFjdGl2ZURSQU1DbG9ja0NoYW5nZU1h
cmdpbiArIERSQU1DbG9ja0NoYW5nZUxhdGVuY3k7CisKKwlTZWNvbmRNaW5BY3RpdmVEUkFNQ2xv
Y2tDaGFuZ2VNYXJnaW5PbmVEaXNwbGF5SW5WQkxhbmsgPSA5OTk5OTk7CisJZm9yIChrID0gMDsg
ayA8IE51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKCEoKGsgPT0gUGxhbmVXaXRo
TWluQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTWFyZ2luKSAmJiAoQmxlbmRpbmdBbmRUaW1pbmdba10g
PT0gaykpCisJCQkJJiYgIShCbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBQbGFuZVdpdGhNaW5BY3Rp
dmVEUkFNQ2xvY2tDaGFuZ2VNYXJnaW4pCisJCQkJJiYgbW9kZV9saWItPnZiYS5BY3RpdmVEUkFN
Q2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luW2tdCisJCQkJCQk8IFNlY29uZE1pbkFjdGl2ZURSQU1D
bG9ja0NoYW5nZU1hcmdpbk9uZURpc3BsYXlJblZCTGFuaykgeworCQkJU2Vjb25kTWluQWN0aXZl
RFJBTUNsb2NrQ2hhbmdlTWFyZ2luT25lRGlzcGxheUluVkJMYW5rID0KKwkJCQkJbW9kZV9saWIt
PnZiYS5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luW2tdOworCQl9CisJfQorCisJ
bW9kZV9saWItPnZiYS5Ub3RhbE51bWJlck9mQWN0aXZlT1RHID0gMDsKKwlmb3IgKGsgPSAwOyBr
IDwgTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlpZiAoQmxlbmRpbmdBbmRUaW1pbmdb
a10gPT0gaykgeworCQkJbW9kZV9saWItPnZiYS5Ub3RhbE51bWJlck9mQWN0aXZlT1RHID0gbW9k
ZV9saWItPnZiYS5Ub3RhbE51bWJlck9mQWN0aXZlT1RHICsgMTsKKwkJfQorCX0KKworCWlmICht
b2RlX2xpYi0+dmJhLk1pbkFjdGl2ZURSQU1DbG9ja0NoYW5nZU1hcmdpbiA+IDApIHsKKwkJKkRS
QU1DbG9ja0NoYW5nZVN1cHBvcnQgPSBkbV9kcmFtX2Nsb2NrX2NoYW5nZV92YWN0aXZlOworCX0g
ZWxzZSBpZiAoKChtb2RlX2xpYi0+dmJhLlN5bmNocm9uaXplZFZCbGFuayA9PSB0cnVlCisJCQl8
fCBtb2RlX2xpYi0+dmJhLlRvdGFsTnVtYmVyT2ZBY3RpdmVPVEcgPT0gMQorCQkJfHwgU2Vjb25k
TWluQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTWFyZ2luT25lRGlzcGxheUluVkJMYW5rID4gMCkKKwkJ
CSYmIFByZWZldGNoTW9kZSA9PSAwKSkgeworCQkqRFJBTUNsb2NrQ2hhbmdlU3VwcG9ydCA9IGRt
X2RyYW1fY2xvY2tfY2hhbmdlX3ZibGFuazsKKwl9IGVsc2UgeworCQkqRFJBTUNsb2NrQ2hhbmdl
U3VwcG9ydCA9IGRtX2RyYW1fY2xvY2tfY2hhbmdlX3Vuc3VwcG9ydGVkOworCX0KKworCUZ1bGxE
RVRCdWZmZXJpbmdUaW1lWVN0dXR0ZXJDcml0aWNhbFBsYW5lID0gRnVsbERFVEJ1ZmZlcmluZ1Rp
bWVZWzBdOworCWZvciAoayA9IDA7IGsgPCBOdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJ
CWlmIChGdWxsREVUQnVmZmVyaW5nVGltZVlba10gPD0gRnVsbERFVEJ1ZmZlcmluZ1RpbWVZU3R1
dHRlckNyaXRpY2FsUGxhbmUpIHsKKwkJCVRpbWVUb0ZpbmlzaFN3YXRoVHJhbnNmZXJTdHV0dGVy
Q3JpdGljYWxQbGFuZSA9IChTd2F0aEhlaWdodFlba10KKwkJCQkJLSAoTGluZXNJbkRFVFlba10g
LSBMaW5lc0luREVUWVJvdW5kZWREb3duVG9Td2F0aFtrXSkpCisJCQkJCSogKEhUb3RhbFtrXSAv
IFBpeGVsQ2xvY2tba10pIC8gVlJhdGlvW2tdOworCQl9CisJfQorCisJKlN0dXR0ZXJFeGl0V2F0
ZXJtYXJrID0gU1JFeGl0VGltZSArIG1vZGVfbGliLT52YmEuTGFzdFBpeGVsT2ZMaW5lRXh0cmFX
YXRlcm1hcmsKKwkJCSsgRXh0cmFMYXRlbmN5ICsgMTAgLyBEQ0ZDTEtEZWVwU2xlZXA7CisJKlN0
dXR0ZXJFbnRlclBsdXNFeGl0V2F0ZXJtYXJrID0gZG1sX21heCgKKwkJCVNSRW50ZXJQbHVzRXhp
dFRpbWUgKyBtb2RlX2xpYi0+dmJhLkxhc3RQaXhlbE9mTGluZUV4dHJhV2F0ZXJtYXJrCisJCQkJ
CSsgRXh0cmFMYXRlbmN5ICsgMTAgLyBEQ0ZDTEtEZWVwU2xlZXAsCisJCQlUaW1lVG9GaW5pc2hT
d2F0aFRyYW5zZmVyU3R1dHRlckNyaXRpY2FsUGxhbmUpOworCit9CisKK3N0YXRpYyB2b2lkIENh
bGN1bGF0ZURDRkNMS0RlZXBTbGVlcCgKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVf
bGliLAorCQl1bnNpZ25lZCBpbnQgTnVtYmVyT2ZBY3RpdmVQbGFuZXMsCisJCWRvdWJsZSBCeXRl
UGVyUGl4ZWxERVRZW10sCisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxERVRDW10sCisJCWRvdWJsZSBW
UmF0aW9bXSwKKwkJdW5zaWduZWQgaW50IFN3YXRoV2lkdGhZW10sCisJCWludCBEUFBQZXJQbGFu
ZVtdLAorCQlkb3VibGUgSFJhdGlvW10sCisJCWRvdWJsZSBQaXhlbENsb2NrW10sCisJCWRvdWJs
ZSBQU0NMX1RIUk9VR0hQVVRbXSwKKwkJZG91YmxlIFBTQ0xfVEhST1VHSFBVVF9DSFJPTUFbXSwK
KwkJZG91YmxlIERQUENMS1tdLAorCQlkb3VibGUgKkRDRkNMS0RlZXBTbGVlcCkKK3sKKwl1aW50
IGs7CisJZG91YmxlIERpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWE7CisJZG91YmxlIERp
c3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUNocm9tYTsKKwkvL2RvdWJsZSAgIERDRkNMS0RlZXBT
bGVlcFBlclBsYW5lW0RDX19OVU1fRFBQX19NQVhdOworCisJZm9yIChrID0gMDsgayA8IE51bWJl
ck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKFZSYXRpb1trXSA8PSAxKSB7CisJCQlEaXNw
bGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVMdW1hID0gU3dhdGhXaWR0aFlba10gKiBEUFBQZXJQbGFu
ZVtrXQorCQkJCQkvIEhSYXRpb1trXSAvIFBpeGVsQ2xvY2tba107CisJCX0gZWxzZSB7CisJCQlE
aXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVMdW1hID0gU3dhdGhXaWR0aFlba10gLyBQU0NMX1RI
Uk9VR0hQVVRba10KKwkJCQkJLyBEUFBDTEtba107CisJCX0KKwkJaWYgKEJ5dGVQZXJQaXhlbERF
VENba10gPT0gMCkgeworCQkJRGlzcGxheVBpcGVMaW5lRGVsaXZlcnlUaW1lQ2hyb21hID0gMDsK
KwkJfSBlbHNlIHsKKwkJCWlmIChWUmF0aW9ba10gLyAyIDw9IDEpIHsKKwkJCQlEaXNwbGF5UGlw
ZUxpbmVEZWxpdmVyeVRpbWVDaHJvbWEgPSBTd2F0aFdpZHRoWVtrXSAvIDIuMAorCQkJCQkJKiBE
UFBQZXJQbGFuZVtrXSAvIChIUmF0aW9ba10gLyAyKSAvIFBpeGVsQ2xvY2tba107CisJCQl9IGVs
c2UgeworCQkJCURpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUNocm9tYSA9IFN3YXRoV2lkdGhZ
W2tdIC8gMi4wCisJCQkJCQkvIFBTQ0xfVEhST1VHSFBVVF9DSFJPTUFba10gLyBEUFBDTEtba107
CisJCQl9CisJCX0KKworCQlpZiAoQnl0ZVBlclBpeGVsREVUQ1trXSA+IDApIHsKKwkJCW1vZGVf
bGliLT52YmEuRENGQ0xLRGVlcFNsZWVwUGVyUGxhbmVba10gPSBkbWxfbWF4KAorCQkJCQkxLjEg
KiBTd2F0aFdpZHRoWVtrXSAqIGRtbF9jZWlsKEJ5dGVQZXJQaXhlbERFVFlba10sIDEpCisJCQkJ
CQkJLyAzMi4wIC8gRGlzcGxheVBpcGVMaW5lRGVsaXZlcnlUaW1lTHVtYSwKKwkJCQkJMS4xICog
U3dhdGhXaWR0aFlba10gLyAyLjAKKwkJCQkJCQkqIGRtbF9jZWlsKEJ5dGVQZXJQaXhlbERFVENb
a10sIDIpIC8gMzIuMAorCQkJCQkJCS8gRGlzcGxheVBpcGVMaW5lRGVsaXZlcnlUaW1lQ2hyb21h
KTsKKwkJfSBlbHNlIHsKKwkJCW1vZGVfbGliLT52YmEuRENGQ0xLRGVlcFNsZWVwUGVyUGxhbmVb
a10gPSAxLjEgKiBTd2F0aFdpZHRoWVtrXQorCQkJCQkqIGRtbF9jZWlsKEJ5dGVQZXJQaXhlbERF
VFlba10sIDEpIC8gNjQuMAorCQkJCQkvIERpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWE7
CisJCX0KKwkJbW9kZV9saWItPnZiYS5EQ0ZDTEtEZWVwU2xlZXBQZXJQbGFuZVtrXSA9IGRtbF9t
YXgoCisJCQkJbW9kZV9saWItPnZiYS5EQ0ZDTEtEZWVwU2xlZXBQZXJQbGFuZVtrXSwKKwkJCQlQ
aXhlbENsb2NrW2tdIC8gMTYpOworCisJfQorCisJKkRDRkNMS0RlZXBTbGVlcCA9IDg7CisJZm9y
IChrID0gMDsgayA8IE51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJKkRDRkNMS0RlZXBT
bGVlcCA9IGRtbF9tYXgoCisJCQkJKkRDRkNMS0RlZXBTbGVlcCwKKwkJCQltb2RlX2xpYi0+dmJh
LkRDRkNMS0RlZXBTbGVlcFBlclBsYW5lW2tdKTsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIENhbGN1
bGF0ZURFVEJ1ZmZlclNpemUoCisJCWRvdWJsZSBERVRCdWZmZXJTaXplSW5LQnl0ZSwKKwkJdW5z
aWduZWQgaW50IFN3YXRoSGVpZ2h0WSwKKwkJdW5zaWduZWQgaW50IFN3YXRoSGVpZ2h0QywKKwkJ
ZG91YmxlICpERVRCdWZmZXJTaXplWSwKKwkJZG91YmxlICpERVRCdWZmZXJTaXplQykKK3sKKwlp
ZiAoU3dhdGhIZWlnaHRDID09IDApIHsKKwkJKkRFVEJ1ZmZlclNpemVZID0gREVUQnVmZmVyU2l6
ZUluS0J5dGUgKiAxMDI0OworCQkqREVUQnVmZmVyU2l6ZUMgPSAwOworCX0gZWxzZSBpZiAoU3dh
dGhIZWlnaHRZIDw9IFN3YXRoSGVpZ2h0QykgeworCQkqREVUQnVmZmVyU2l6ZVkgPSBERVRCdWZm
ZXJTaXplSW5LQnl0ZSAqIDEwMjQgLyAyOworCQkqREVUQnVmZmVyU2l6ZUMgPSBERVRCdWZmZXJT
aXplSW5LQnl0ZSAqIDEwMjQgLyAyOworCX0gZWxzZSB7CisJCSpERVRCdWZmZXJTaXplWSA9IERF
VEJ1ZmZlclNpemVJbktCeXRlICogMTAyNCAqIDIgLyAzOworCQkqREVUQnVmZmVyU2l6ZUMgPSBE
RVRCdWZmZXJTaXplSW5LQnl0ZSAqIDEwMjQgLyAzOworCX0KK30KKworc3RhdGljIHZvaWQgQ2Fs
Y3VsYXRlVXJnZW50QnVyc3RGYWN0b3IoCisJCXVuc2lnbmVkIGludCBERVRCdWZmZXJTaXplSW5L
Qnl0ZSwKKwkJdW5zaWduZWQgaW50IFN3YXRoSGVpZ2h0WSwKKwkJdW5zaWduZWQgaW50IFN3YXRo
SGVpZ2h0QywKKwkJdW5zaWduZWQgaW50IFN3YXRoV2lkdGhZLAorCQlkb3VibGUgTGluZVRpbWUs
CisJCWRvdWJsZSBVcmdlbnRMYXRlbmN5LAorCQlkb3VibGUgQ3Vyc29yQnVmZmVyU2l6ZSwKKwkJ
dW5zaWduZWQgaW50IEN1cnNvcldpZHRoLAorCQl1bnNpZ25lZCBpbnQgQ3Vyc29yQlBQLAorCQlk
b3VibGUgVlJhdGlvLAorCQlkb3VibGUgVlJhdGlvUHJlWSwKKwkJZG91YmxlIFZSYXRpb1ByZUMs
CisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxJbkRFVFksCisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxJbkRF
VEMsCisJCWRvdWJsZSAqVXJnZW50QnVyc3RGYWN0b3JDdXJzb3IsCisJCWRvdWJsZSAqVXJnZW50
QnVyc3RGYWN0b3JDdXJzb3JQcmUsCisJCWRvdWJsZSAqVXJnZW50QnVyc3RGYWN0b3JMdW1hLAor
CQlkb3VibGUgKlVyZ2VudEJ1cnN0RmFjdG9yTHVtYVByZSwKKwkJZG91YmxlICpVcmdlbnRCdXJz
dEZhY3RvckNocm9tYSwKKwkJZG91YmxlICpVcmdlbnRCdXJzdEZhY3RvckNocm9tYVByZSwKKwkJ
dW5zaWduZWQgaW50ICpOb3RFbm91Z2hVcmdlbnRMYXRlbmN5SGlkaW5nLAorCQl1bnNpZ25lZCBp
bnQgKk5vdEVub3VnaFVyZ2VudExhdGVuY3lIaWRpbmdQcmUpCit7CisJZG91YmxlIExpbmVzSW5E
RVRMdW1hOworCWRvdWJsZSBMaW5lc0luREVUQ2hyb21hOworCXVuc2lnbmVkIGludCBMaW5lc0lu
Q3Vyc29yQnVmZmVyOworCWRvdWJsZSBDdXJzb3JCdWZmZXJTaXplSW5UaW1lOworCWRvdWJsZSBD
dXJzb3JCdWZmZXJTaXplSW5UaW1lUHJlOworCWRvdWJsZSBERVRCdWZmZXJTaXplSW5UaW1lTHVt
YTsKKwlkb3VibGUgREVUQnVmZmVyU2l6ZUluVGltZUx1bWFQcmU7CisJZG91YmxlIERFVEJ1ZmZl
clNpemVJblRpbWVDaHJvbWE7CisJZG91YmxlIERFVEJ1ZmZlclNpemVJblRpbWVDaHJvbWFQcmU7
CisJZG91YmxlIERFVEJ1ZmZlclNpemVZOworCWRvdWJsZSBERVRCdWZmZXJTaXplQzsKKworCSpO
b3RFbm91Z2hVcmdlbnRMYXRlbmN5SGlkaW5nID0gMDsKKwkqTm90RW5vdWdoVXJnZW50TGF0ZW5j
eUhpZGluZ1ByZSA9IDA7CisKKwlpZiAoQ3Vyc29yV2lkdGggPiAwKSB7CisJCUxpbmVzSW5DdXJz
b3JCdWZmZXIgPSAxIDw8ICh1bnNpZ25lZCBpbnQpIGRtbF9mbG9vcigKKwkJCWRtbF9sb2cyKEN1
cnNvckJ1ZmZlclNpemUgKiAxMDI0LjAgLyAoQ3Vyc29yV2lkdGggKiBDdXJzb3JCUFAgLyA4LjAp
KSwgMS4wKTsKKwkJQ3Vyc29yQnVmZmVyU2l6ZUluVGltZSA9IExpbmVzSW5DdXJzb3JCdWZmZXIg
KiBMaW5lVGltZSAvIFZSYXRpbzsKKwkJaWYgKEN1cnNvckJ1ZmZlclNpemVJblRpbWUgLSBVcmdl
bnRMYXRlbmN5IDw9IDApIHsKKwkJCSpOb3RFbm91Z2hVcmdlbnRMYXRlbmN5SGlkaW5nID0gMTsK
KwkJCSpVcmdlbnRCdXJzdEZhY3RvckN1cnNvciA9IDA7CisJCX0gZWxzZSB7CisJCQkqVXJnZW50
QnVyc3RGYWN0b3JDdXJzb3IgPSBDdXJzb3JCdWZmZXJTaXplSW5UaW1lCisJCQkJCS8gKEN1cnNv
ckJ1ZmZlclNpemVJblRpbWUgLSBVcmdlbnRMYXRlbmN5KTsKKwkJfQorCQlpZiAoVlJhdGlvUHJl
WSA+IDApIHsKKwkJCUN1cnNvckJ1ZmZlclNpemVJblRpbWVQcmUgPSBMaW5lc0luQ3Vyc29yQnVm
ZmVyICogTGluZVRpbWUgLyBWUmF0aW9QcmVZOworCQkJaWYgKEN1cnNvckJ1ZmZlclNpemVJblRp
bWVQcmUgLSBVcmdlbnRMYXRlbmN5IDw9IDApIHsKKwkJCQkqTm90RW5vdWdoVXJnZW50TGF0ZW5j
eUhpZGluZ1ByZSA9IDE7CisJCQkJKlVyZ2VudEJ1cnN0RmFjdG9yQ3Vyc29yUHJlID0gMDsKKwkJ
CX0gZWxzZSB7CisJCQkJKlVyZ2VudEJ1cnN0RmFjdG9yQ3Vyc29yUHJlID0gQ3Vyc29yQnVmZmVy
U2l6ZUluVGltZVByZQorCQkJCQkJLyAoQ3Vyc29yQnVmZmVyU2l6ZUluVGltZVByZSAtIFVyZ2Vu
dExhdGVuY3kpOworCQkJfQorCQl9IGVsc2UgeworCQkJKlVyZ2VudEJ1cnN0RmFjdG9yQ3Vyc29y
UHJlID0gMTsKKwkJfQorCX0KKworCUNhbGN1bGF0ZURFVEJ1ZmZlclNpemUoCisJCQlERVRCdWZm
ZXJTaXplSW5LQnl0ZSwKKwkJCVN3YXRoSGVpZ2h0WSwKKwkJCVN3YXRoSGVpZ2h0QywKKwkJCSZE
RVRCdWZmZXJTaXplWSwKKwkJCSZERVRCdWZmZXJTaXplQyk7CisKKwlMaW5lc0luREVUTHVtYSA9
IERFVEJ1ZmZlclNpemVZIC8gQnl0ZVBlclBpeGVsSW5ERVRZIC8gU3dhdGhXaWR0aFk7CisJREVU
QnVmZmVyU2l6ZUluVGltZUx1bWEgPSBkbWxfZmxvb3IoTGluZXNJbkRFVEx1bWEsIFN3YXRoSGVp
Z2h0WSkgKiBMaW5lVGltZSAvIFZSYXRpbzsKKwlpZiAoREVUQnVmZmVyU2l6ZUluVGltZUx1bWEg
LSBVcmdlbnRMYXRlbmN5IDw9IDApIHsKKwkJKk5vdEVub3VnaFVyZ2VudExhdGVuY3lIaWRpbmcg
PSAxOworCQkqVXJnZW50QnVyc3RGYWN0b3JMdW1hID0gMDsKKwl9IGVsc2UgeworCQkqVXJnZW50
QnVyc3RGYWN0b3JMdW1hID0gREVUQnVmZmVyU2l6ZUluVGltZUx1bWEKKwkJCQkvIChERVRCdWZm
ZXJTaXplSW5UaW1lTHVtYSAtIFVyZ2VudExhdGVuY3kpOworCX0KKwlpZiAoVlJhdGlvUHJlWSA+
IDApIHsKKwkJREVUQnVmZmVyU2l6ZUluVGltZUx1bWFQcmUgPSBkbWxfZmxvb3IoTGluZXNJbkRF
VEx1bWEsIFN3YXRoSGVpZ2h0WSkgKiBMaW5lVGltZQorCQkJCS8gVlJhdGlvUHJlWTsKKwkJaWYg
KERFVEJ1ZmZlclNpemVJblRpbWVMdW1hUHJlIC0gVXJnZW50TGF0ZW5jeSA8PSAwKSB7CisJCQkq
Tm90RW5vdWdoVXJnZW50TGF0ZW5jeUhpZGluZ1ByZSA9IDE7CisJCQkqVXJnZW50QnVyc3RGYWN0
b3JMdW1hUHJlID0gMDsKKwkJfSBlbHNlIHsKKwkJCSpVcmdlbnRCdXJzdEZhY3Rvckx1bWFQcmUg
PSBERVRCdWZmZXJTaXplSW5UaW1lTHVtYVByZQorCQkJCQkvIChERVRCdWZmZXJTaXplSW5UaW1l
THVtYVByZSAtIFVyZ2VudExhdGVuY3kpOworCQl9CisJfSBlbHNlIHsKKwkJKlVyZ2VudEJ1cnN0
RmFjdG9yTHVtYVByZSA9IDE7CisJfQorCisJaWYgKEJ5dGVQZXJQaXhlbEluREVUQyA+IDApIHsK
KwkJTGluZXNJbkRFVENocm9tYSA9IERFVEJ1ZmZlclNpemVDIC8gQnl0ZVBlclBpeGVsSW5ERVRD
IC8gKFN3YXRoV2lkdGhZIC8gMik7CisJCURFVEJ1ZmZlclNpemVJblRpbWVDaHJvbWEgPSBkbWxf
Zmxvb3IoTGluZXNJbkRFVENocm9tYSwgU3dhdGhIZWlnaHRDKSAqIExpbmVUaW1lCisJCQkJLyAo
VlJhdGlvIC8gMik7CisJCWlmIChERVRCdWZmZXJTaXplSW5UaW1lQ2hyb21hIC0gVXJnZW50TGF0
ZW5jeSA8PSAwKSB7CisJCQkqTm90RW5vdWdoVXJnZW50TGF0ZW5jeUhpZGluZyA9IDE7CisJCQkq
VXJnZW50QnVyc3RGYWN0b3JDaHJvbWEgPSAwOworCQl9IGVsc2UgeworCQkJKlVyZ2VudEJ1cnN0
RmFjdG9yQ2hyb21hID0gREVUQnVmZmVyU2l6ZUluVGltZUNocm9tYQorCQkJCQkvIChERVRCdWZm
ZXJTaXplSW5UaW1lQ2hyb21hIC0gVXJnZW50TGF0ZW5jeSk7CisJCX0KKwkJaWYgKFZSYXRpb1By
ZUMgPiAwKSB7CisJCQlERVRCdWZmZXJTaXplSW5UaW1lQ2hyb21hUHJlID0gZG1sX2Zsb29yKExp
bmVzSW5ERVRDaHJvbWEsIFN3YXRoSGVpZ2h0QykKKwkJCQkJKiBMaW5lVGltZSAvIFZSYXRpb1By
ZUM7CisJCQlpZiAoREVUQnVmZmVyU2l6ZUluVGltZUNocm9tYVByZSAtIFVyZ2VudExhdGVuY3kg
PD0gMCkgeworCQkJCSpOb3RFbm91Z2hVcmdlbnRMYXRlbmN5SGlkaW5nUHJlID0gMTsKKwkJCQkq
VXJnZW50QnVyc3RGYWN0b3JDaHJvbWFQcmUgPSAwOworCQkJfSBlbHNlIHsKKwkJCQkqVXJnZW50
QnVyc3RGYWN0b3JDaHJvbWFQcmUgPSBERVRCdWZmZXJTaXplSW5UaW1lQ2hyb21hUHJlCisJCQkJ
CQkvIChERVRCdWZmZXJTaXplSW5UaW1lQ2hyb21hUHJlIC0gVXJnZW50TGF0ZW5jeSk7CisJCQl9
CisJCX0gZWxzZSB7CisJCQkqVXJnZW50QnVyc3RGYWN0b3JDaHJvbWFQcmUgPSAxOworCQl9CisJ
fQorfQorCitzdGF0aWMgdm9pZCBDYWxjdWxhdGVQaXhlbERlbGl2ZXJ5VGltZXMoCisJCXVuc2ln
bmVkIGludCBOdW1iZXJPZkFjdGl2ZVBsYW5lcywKKwkJZG91YmxlIFZSYXRpb1tdLAorCQlkb3Vi
bGUgVlJhdGlvUHJlZmV0Y2hZW10sCisJCWRvdWJsZSBWUmF0aW9QcmVmZXRjaENbXSwKKwkJdW5z
aWduZWQgaW50IHN3YXRoX3dpZHRoX2x1bWFfdWJbXSwKKwkJdW5zaWduZWQgaW50IHN3YXRoX3dp
ZHRoX2Nocm9tYV91YltdLAorCQlpbnQgRFBQUGVyUGxhbmVbXSwKKwkJZG91YmxlIEhSYXRpb1td
LAorCQlkb3VibGUgUGl4ZWxDbG9ja1tdLAorCQlkb3VibGUgUFNDTF9USFJPVUdIUFVUW10sCisJ
CWRvdWJsZSBQU0NMX1RIUk9VR0hQVVRfQ0hST01BW10sCisJCWRvdWJsZSBEUFBDTEtbXSwKKwkJ
ZG91YmxlIEJ5dGVQZXJQaXhlbERFVENbXSwKKwkJZW51bSBzY2FuX2RpcmVjdGlvbl9jbGFzcyBT
b3VyY2VTY2FuW10sCisJCXVuc2lnbmVkIGludCBCbG9ja1dpZHRoMjU2Qnl0ZXNZW10sCisJCXVu
c2lnbmVkIGludCBCbG9ja0hlaWdodDI1NkJ5dGVzWVtdLAorCQl1bnNpZ25lZCBpbnQgQmxvY2tX
aWR0aDI1NkJ5dGVzQ1tdLAorCQl1bnNpZ25lZCBpbnQgQmxvY2tIZWlnaHQyNTZCeXRlc0NbXSwK
KwkJZG91YmxlIERpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWFbXSwKKwkJZG91YmxlIERp
c3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUNocm9tYVtdLAorCQlkb3VibGUgRGlzcGxheVBpcGVM
aW5lRGVsaXZlcnlUaW1lTHVtYVByZWZldGNoW10sCisJCWRvdWJsZSBEaXNwbGF5UGlwZUxpbmVE
ZWxpdmVyeVRpbWVDaHJvbWFQcmVmZXRjaFtdLAorCQlkb3VibGUgRGlzcGxheVBpcGVSZXF1ZXN0
RGVsaXZlcnlUaW1lTHVtYVtdLAorCQlkb3VibGUgRGlzcGxheVBpcGVSZXF1ZXN0RGVsaXZlcnlU
aW1lQ2hyb21hW10sCisJCWRvdWJsZSBEaXNwbGF5UGlwZVJlcXVlc3REZWxpdmVyeVRpbWVMdW1h
UHJlZmV0Y2hbXSwKKwkJZG91YmxlIERpc3BsYXlQaXBlUmVxdWVzdERlbGl2ZXJ5VGltZUNocm9t
YVByZWZldGNoW10pCit7CisJZG91YmxlIHJlcV9wZXJfc3dhdGhfdWI7CisJdWludCBrOworCisJ
Zm9yIChrID0gMDsgayA8IE51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKFZSYXRp
b1trXSA8PSAxKSB7CisJCQlEaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVMdW1hW2tdID0gc3dh
dGhfd2lkdGhfbHVtYV91YltrXSAqIERQUFBlclBsYW5lW2tdCisJCQkJCS8gSFJhdGlvW2tdIC8g
UGl4ZWxDbG9ja1trXTsKKwkJfSBlbHNlIHsKKwkJCURpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGlt
ZUx1bWFba10gPSBzd2F0aF93aWR0aF9sdW1hX3ViW2tdCisJCQkJCS8gUFNDTF9USFJPVUdIUFVU
W2tdIC8gRFBQQ0xLW2tdOworCQl9CisKKwkJaWYgKEJ5dGVQZXJQaXhlbERFVENba10gPT0gMCkg
eworCQkJRGlzcGxheVBpcGVMaW5lRGVsaXZlcnlUaW1lQ2hyb21hW2tdID0gMDsKKwkJfSBlbHNl
IHsKKwkJCWlmIChWUmF0aW9ba10gLyAyIDw9IDEpIHsKKwkJCQlEaXNwbGF5UGlwZUxpbmVEZWxp
dmVyeVRpbWVDaHJvbWFba10gPSBzd2F0aF93aWR0aF9jaHJvbWFfdWJba10KKwkJCQkJCSogRFBQ
UGVyUGxhbmVba10gLyAoSFJhdGlvW2tdIC8gMikgLyBQaXhlbENsb2NrW2tdOworCQkJfSBlbHNl
IHsKKwkJCQlEaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVDaHJvbWFba10gPSBzd2F0aF93aWR0
aF9jaHJvbWFfdWJba10KKwkJCQkJCS8gUFNDTF9USFJPVUdIUFVUX0NIUk9NQVtrXSAvIERQUENM
S1trXTsKKwkJCX0KKwkJfQorCisJCWlmIChWUmF0aW9QcmVmZXRjaFlba10gPD0gMSkgeworCQkJ
RGlzcGxheVBpcGVMaW5lRGVsaXZlcnlUaW1lTHVtYVByZWZldGNoW2tdID0gc3dhdGhfd2lkdGhf
bHVtYV91YltrXQorCQkJCQkqIERQUFBlclBsYW5lW2tdIC8gSFJhdGlvW2tdIC8gUGl4ZWxDbG9j
a1trXTsKKwkJfSBlbHNlIHsKKwkJCURpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWFQcmVm
ZXRjaFtrXSA9IHN3YXRoX3dpZHRoX2x1bWFfdWJba10KKwkJCQkJLyBQU0NMX1RIUk9VR0hQVVRb
a10gLyBEUFBDTEtba107CisJCX0KKworCQlpZiAoQnl0ZVBlclBpeGVsREVUQ1trXSA9PSAwKSB7
CisJCQlEaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVDaHJvbWFQcmVmZXRjaFtrXSA9IDA7CisJ
CX0gZWxzZSB7CisJCQlpZiAoVlJhdGlvUHJlZmV0Y2hDW2tdIDw9IDEpIHsKKwkJCQlEaXNwbGF5
UGlwZUxpbmVEZWxpdmVyeVRpbWVDaHJvbWFQcmVmZXRjaFtrXSA9CisJCQkJCQlzd2F0aF93aWR0
aF9jaHJvbWFfdWJba10gKiBEUFBQZXJQbGFuZVtrXQorCQkJCQkJCQkvIChIUmF0aW9ba10gLyAy
KSAvIFBpeGVsQ2xvY2tba107CisJCQl9IGVsc2UgeworCQkJCURpc3BsYXlQaXBlTGluZURlbGl2
ZXJ5VGltZUNocm9tYVByZWZldGNoW2tdID0KKwkJCQkJCXN3YXRoX3dpZHRoX2Nocm9tYV91Yltr
XSAvIFBTQ0xfVEhST1VHSFBVVF9DSFJPTUFba10gLyBEUFBDTEtba107CisJCQl9CisJCX0KKwl9
CisKKwlmb3IgKGsgPSAwOyBrIDwgTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlpZiAo
U291cmNlU2NhbltrXSA9PSBkbV9ob3J6KSB7CisJCQlyZXFfcGVyX3N3YXRoX3ViID0gc3dhdGhf
d2lkdGhfbHVtYV91YltrXSAvIEJsb2NrV2lkdGgyNTZCeXRlc1lba107CisJCX0gZWxzZSB7CisJ
CQlyZXFfcGVyX3N3YXRoX3ViID0gc3dhdGhfd2lkdGhfbHVtYV91YltrXSAvIEJsb2NrSGVpZ2h0
MjU2Qnl0ZXNZW2tdOworCQl9CisJCURpc3BsYXlQaXBlUmVxdWVzdERlbGl2ZXJ5VGltZUx1bWFb
a10gPSBEaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVMdW1hW2tdCisJCQkJLyByZXFfcGVyX3N3
YXRoX3ViOworCQlEaXNwbGF5UGlwZVJlcXVlc3REZWxpdmVyeVRpbWVMdW1hUHJlZmV0Y2hba10g
PQorCQkJCURpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWFQcmVmZXRjaFtrXSAvIHJlcV9w
ZXJfc3dhdGhfdWI7CisJCWlmIChCeXRlUGVyUGl4ZWxERVRDW2tdID09IDApIHsKKwkJCURpc3Bs
YXlQaXBlUmVxdWVzdERlbGl2ZXJ5VGltZUNocm9tYVtrXSA9IDA7CisJCQlEaXNwbGF5UGlwZVJl
cXVlc3REZWxpdmVyeVRpbWVDaHJvbWFQcmVmZXRjaFtrXSA9IDA7CisJCX0gZWxzZSB7CisJCQlp
ZiAoU291cmNlU2NhbltrXSA9PSBkbV9ob3J6KSB7CisJCQkJcmVxX3Blcl9zd2F0aF91YiA9IHN3
YXRoX3dpZHRoX2Nocm9tYV91YltrXQorCQkJCQkJLyBCbG9ja1dpZHRoMjU2Qnl0ZXNDW2tdOwor
CQkJfSBlbHNlIHsKKwkJCQlyZXFfcGVyX3N3YXRoX3ViID0gc3dhdGhfd2lkdGhfY2hyb21hX3Vi
W2tdCisJCQkJCQkvIEJsb2NrSGVpZ2h0MjU2Qnl0ZXNDW2tdOworCQkJfQorCQkJRGlzcGxheVBp
cGVSZXF1ZXN0RGVsaXZlcnlUaW1lQ2hyb21hW2tdID0KKwkJCQkJRGlzcGxheVBpcGVMaW5lRGVs
aXZlcnlUaW1lQ2hyb21hW2tdIC8gcmVxX3Blcl9zd2F0aF91YjsKKwkJCURpc3BsYXlQaXBlUmVx
dWVzdERlbGl2ZXJ5VGltZUNocm9tYVByZWZldGNoW2tdID0KKwkJCQkJRGlzcGxheVBpcGVMaW5l
RGVsaXZlcnlUaW1lQ2hyb21hUHJlZmV0Y2hba10gLyByZXFfcGVyX3N3YXRoX3ViOworCQl9CisJ
fQorfQorCitzdGF0aWMgdm9pZCBDYWxjdWxhdGVNZXRhQW5kUFRFVGltZXMoCisJCXVuc2lnbmVk
IGludCBOdW1iZXJPZkFjdGl2ZVBsYW5lcywKKwkJYm9vbCBHUFVWTUVuYWJsZSwKKwkJdW5zaWdu
ZWQgaW50IE1ldGFDaHVua1NpemUsCisJCXVuc2lnbmVkIGludCBNaW5NZXRhQ2h1bmtTaXplQnl0
ZXMsCisJCXVuc2lnbmVkIGludCBHUFVWTU1heFBhZ2VUYWJsZUxldmVscywKKwkJdW5zaWduZWQg
aW50IEhUb3RhbFtdLAorCQlkb3VibGUgVlJhdGlvW10sCisJCWRvdWJsZSBWUmF0aW9QcmVmZXRj
aFlbXSwKKwkJZG91YmxlIFZSYXRpb1ByZWZldGNoQ1tdLAorCQlkb3VibGUgRGVzdGluYXRpb25M
aW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rW10sCisJCWRvdWJsZSBEZXN0aW5hdGlvbkxpbmVzVG9S
ZXF1ZXN0Um93SW5JbW1lZGlhdGVGbGlwW10sCisJCWRvdWJsZSBEZXN0aW5hdGlvbkxpbmVzVG9S
ZXF1ZXN0Vk1JblZCbGFua1tdLAorCQlkb3VibGUgRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZN
SW5JbW1lZGlhdGVGbGlwW10sCisJCWJvb2wgRENDRW5hYmxlW10sCisJCWRvdWJsZSBQaXhlbENs
b2NrW10sCisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxERVRZW10sCisJCWRvdWJsZSBCeXRlUGVyUGl4
ZWxERVRDW10sCisJCWVudW0gc2Nhbl9kaXJlY3Rpb25fY2xhc3MgU291cmNlU2NhbltdLAorCQl1
bnNpZ25lZCBpbnQgZHB0ZV9yb3dfaGVpZ2h0W10sCisJCXVuc2lnbmVkIGludCBkcHRlX3Jvd19o
ZWlnaHRfY2hyb21hW10sCisJCXVuc2lnbmVkIGludCBtZXRhX3Jvd193aWR0aFtdLAorCQl1bnNp
Z25lZCBpbnQgbWV0YV9yb3dfaGVpZ2h0W10sCisJCXVuc2lnbmVkIGludCBtZXRhX3JlcV93aWR0
aFtdLAorCQl1bnNpZ25lZCBpbnQgbWV0YV9yZXFfaGVpZ2h0W10sCisJCWxvbmcgZHB0ZV9ncm91
cF9ieXRlc1tdLAorCQl1bnNpZ25lZCBpbnQgUFRFUmVxdWVzdFNpemVZW10sCisJCXVuc2lnbmVk
IGludCBQVEVSZXF1ZXN0U2l6ZUNbXSwKKwkJdW5zaWduZWQgaW50IFBpeGVsUFRFUmVxV2lkdGhZ
W10sCisJCXVuc2lnbmVkIGludCBQaXhlbFBURVJlcUhlaWdodFlbXSwKKwkJdW5zaWduZWQgaW50
IFBpeGVsUFRFUmVxV2lkdGhDW10sCisJCXVuc2lnbmVkIGludCBQaXhlbFBURVJlcUhlaWdodENb
XSwKKwkJdW5zaWduZWQgaW50IGRwdGVfcm93X3dpZHRoX2x1bWFfdWJbXSwKKwkJdW5zaWduZWQg
aW50IGRwdGVfcm93X3dpZHRoX2Nocm9tYV91YltdLAorCQl1bnNpZ25lZCBpbnQgdm1fZ3JvdXBf
Ynl0ZXNbXSwKKwkJdW5zaWduZWQgaW50IGRwZGUwX2J5dGVzX3Blcl9mcmFtZV91Yl9sW10sCisJ
CXVuc2lnbmVkIGludCBkcGRlMF9ieXRlc19wZXJfZnJhbWVfdWJfY1tdLAorCQl1bnNpZ25lZCBp
bnQgbWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1lX3ViX2xbXSwKKwkJdW5zaWduZWQgaW50IG1ldGFf
cHRlX2J5dGVzX3Blcl9mcmFtZV91Yl9jW10sCisJCWRvdWJsZSBEU1RfWV9QRVJfUFRFX1JPV19O
T01fTFtdLAorCQlkb3VibGUgRFNUX1lfUEVSX1BURV9ST1dfTk9NX0NbXSwKKwkJZG91YmxlIERT
VF9ZX1BFUl9NRVRBX1JPV19OT01fTFtdLAorCQlkb3VibGUgVGltZVBlck1ldGFDaHVua05vbWlu
YWxbXSwKKwkJZG91YmxlIFRpbWVQZXJNZXRhQ2h1bmtWQmxhbmtbXSwKKwkJZG91YmxlIFRpbWVQ
ZXJNZXRhQ2h1bmtGbGlwW10sCisJCWRvdWJsZSB0aW1lX3Blcl9wdGVfZ3JvdXBfbm9tX2x1bWFb
XSwKKwkJZG91YmxlIHRpbWVfcGVyX3B0ZV9ncm91cF92YmxhbmtfbHVtYVtdLAorCQlkb3VibGUg
dGltZV9wZXJfcHRlX2dyb3VwX2ZsaXBfbHVtYVtdLAorCQlkb3VibGUgdGltZV9wZXJfcHRlX2dy
b3VwX25vbV9jaHJvbWFbXSwKKwkJZG91YmxlIHRpbWVfcGVyX3B0ZV9ncm91cF92YmxhbmtfY2hy
b21hW10sCisJCWRvdWJsZSB0aW1lX3Blcl9wdGVfZ3JvdXBfZmxpcF9jaHJvbWFbXSwKKwkJZG91
YmxlIFRpbWVQZXJWTUdyb3VwVkJsYW5rW10sCisJCWRvdWJsZSBUaW1lUGVyVk1Hcm91cEZsaXBb
XSwKKwkJZG91YmxlIFRpbWVQZXJWTVJlcXVlc3RWQmxhbmtbXSwKKwkJZG91YmxlIFRpbWVQZXJW
TVJlcXVlc3RGbGlwW10pCit7CisJdW5zaWduZWQgaW50IG1ldGFfY2h1bmtfd2lkdGg7CisJdW5z
aWduZWQgaW50IG1pbl9tZXRhX2NodW5rX3dpZHRoOworCXVuc2lnbmVkIGludCBtZXRhX2NodW5r
X3Blcl9yb3dfaW50OworCXVuc2lnbmVkIGludCBtZXRhX3Jvd19yZW1haW5kZXI7CisJdW5zaWdu
ZWQgaW50IG1ldGFfY2h1bmtfdGhyZXNob2xkOworCXVuc2lnbmVkIGludCBtZXRhX2NodW5rc19w
ZXJfcm93X3ViOworCXVuc2lnbmVkIGludCBkcHRlX2dyb3VwX3dpZHRoX2x1bWE7CisJdW5zaWdu
ZWQgaW50IGRwdGVfZ3JvdXBfd2lkdGhfY2hyb21hOworCXVuc2lnbmVkIGludCBkcHRlX2dyb3Vw
c19wZXJfcm93X2x1bWFfdWI7CisJdW5zaWduZWQgaW50IGRwdGVfZ3JvdXBzX3Blcl9yb3dfY2hy
b21hX3ViOworCXVuc2lnbmVkIGludCBudW1fZ3JvdXBfcGVyX2xvd2VyX3ZtX3N0YWdlOworCXVu
c2lnbmVkIGludCBudW1fcmVxX3Blcl9sb3dlcl92bV9zdGFnZTsKKwl1aW50IGs7CisKKwlmb3Ig
KGsgPSAwOyBrIDwgTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlpZiAoR1BVVk1FbmFi
bGUgPT0gdHJ1ZSkgeworCQkJRFNUX1lfUEVSX1BURV9ST1dfTk9NX0xba10gPSBkcHRlX3Jvd19o
ZWlnaHRba10gLyBWUmF0aW9ba107CisJCQlpZiAoQnl0ZVBlclBpeGVsREVUQ1trXSA9PSAwKSB7
CisJCQkJRFNUX1lfUEVSX1BURV9ST1dfTk9NX0Nba10gPSAwOworCQkJfSBlbHNlIHsKKwkJCQlE
U1RfWV9QRVJfUFRFX1JPV19OT01fQ1trXSA9IGRwdGVfcm93X2hlaWdodF9jaHJvbWFba10gLyAo
VlJhdGlvW2tdIC8gMik7CisJCQl9CisJCX0gZWxzZSB7CisJCQlEU1RfWV9QRVJfUFRFX1JPV19O
T01fTFtrXSA9IDA7CisJCQlEU1RfWV9QRVJfUFRFX1JPV19OT01fQ1trXSA9IDA7CisJCX0KKwkJ
aWYgKERDQ0VuYWJsZVtrXSA9PSB0cnVlKSB7CisJCQlEU1RfWV9QRVJfTUVUQV9ST1dfTk9NX0xb
a10gPSBtZXRhX3Jvd19oZWlnaHRba10gLyBWUmF0aW9ba107CisJCX0gZWxzZSB7CisJCQlEU1Rf
WV9QRVJfTUVUQV9ST1dfTk9NX0xba10gPSAwOworCQl9CisJfQorCisJZm9yIChrID0gMDsgayA8
IE51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKERDQ0VuYWJsZVtrXSA9PSB0cnVl
KSB7CisJCQltZXRhX2NodW5rX3dpZHRoID0gTWV0YUNodW5rU2l6ZSAqIDEwMjQgKiAyNTYKKwkJ
CQkJLyBkbWxfY2VpbChCeXRlUGVyUGl4ZWxERVRZW2tdLCAxKSAvIG1ldGFfcm93X2hlaWdodFtr
XTsKKwkJCW1pbl9tZXRhX2NodW5rX3dpZHRoID0gTWluTWV0YUNodW5rU2l6ZUJ5dGVzICogMjU2
CisJCQkJCS8gZG1sX2NlaWwoQnl0ZVBlclBpeGVsREVUWVtrXSwgMSkgLyBtZXRhX3Jvd19oZWln
aHRba107CisJCQltZXRhX2NodW5rX3Blcl9yb3dfaW50ID0gbWV0YV9yb3dfd2lkdGhba10gLyBt
ZXRhX2NodW5rX3dpZHRoOworCQkJbWV0YV9yb3dfcmVtYWluZGVyID0gbWV0YV9yb3dfd2lkdGhb
a10gJSBtZXRhX2NodW5rX3dpZHRoOworCQkJaWYgKFNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikg
eworCQkJCW1ldGFfY2h1bmtfdGhyZXNob2xkID0gMiAqIG1pbl9tZXRhX2NodW5rX3dpZHRoIC0g
bWV0YV9yZXFfd2lkdGhba107CisJCQl9IGVsc2UgeworCQkJCW1ldGFfY2h1bmtfdGhyZXNob2xk
ID0gMiAqIG1pbl9tZXRhX2NodW5rX3dpZHRoCisJCQkJCQktIG1ldGFfcmVxX2hlaWdodFtrXTsK
KwkJCX0KKwkJCWlmIChtZXRhX3Jvd19yZW1haW5kZXIgPD0gbWV0YV9jaHVua190aHJlc2hvbGQp
IHsKKwkJCQltZXRhX2NodW5rc19wZXJfcm93X3ViID0gbWV0YV9jaHVua19wZXJfcm93X2ludCAr
IDE7CisJCQl9IGVsc2UgeworCQkJCW1ldGFfY2h1bmtzX3Blcl9yb3dfdWIgPSBtZXRhX2NodW5r
X3Blcl9yb3dfaW50ICsgMjsKKwkJCX0KKwkJCVRpbWVQZXJNZXRhQ2h1bmtOb21pbmFsW2tdID0g
bWV0YV9yb3dfaGVpZ2h0W2tdIC8gVlJhdGlvW2tdICogSFRvdGFsW2tdCisJCQkJCS8gUGl4ZWxD
bG9ja1trXSAvIG1ldGFfY2h1bmtzX3Blcl9yb3dfdWI7CisJCQlUaW1lUGVyTWV0YUNodW5rVkJs
YW5rW2tdID0gRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rW2tdCisJCQkJCSog
SFRvdGFsW2tdIC8gUGl4ZWxDbG9ja1trXSAvIG1ldGFfY2h1bmtzX3Blcl9yb3dfdWI7CisJCQlU
aW1lUGVyTWV0YUNodW5rRmxpcFtrXSA9IERlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJbklt
bWVkaWF0ZUZsaXBba10KKwkJCQkJKiBIVG90YWxba10gLyBQaXhlbENsb2NrW2tdIC8gbWV0YV9j
aHVua3NfcGVyX3Jvd191YjsKKwkJfSBlbHNlIHsKKwkJCVRpbWVQZXJNZXRhQ2h1bmtOb21pbmFs
W2tdID0gMDsKKwkJCVRpbWVQZXJNZXRhQ2h1bmtWQmxhbmtba10gPSAwOworCQkJVGltZVBlck1l
dGFDaHVua0ZsaXBba10gPSAwOworCQl9CisJfQorCisJZm9yIChrID0gMDsgayA8IE51bWJlck9m
QWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKEdQVVZNRW5hYmxlID09IHRydWUpIHsKKwkJCWlm
IChTb3VyY2VTY2FuW2tdID09IGRtX2hvcnopIHsKKwkJCQlkcHRlX2dyb3VwX3dpZHRoX2x1bWEg
PSBkcHRlX2dyb3VwX2J5dGVzW2tdIC8gUFRFUmVxdWVzdFNpemVZW2tdCisJCQkJCQkqIFBpeGVs
UFRFUmVxV2lkdGhZW2tdOworCQkJfSBlbHNlIHsKKwkJCQlkcHRlX2dyb3VwX3dpZHRoX2x1bWEg
PSBkcHRlX2dyb3VwX2J5dGVzW2tdIC8gUFRFUmVxdWVzdFNpemVZW2tdCisJCQkJCQkqIFBpeGVs
UFRFUmVxSGVpZ2h0WVtrXTsKKwkJCX0KKwkJCWRwdGVfZ3JvdXBzX3Blcl9yb3dfbHVtYV91YiA9
IGRtbF9jZWlsKAorCQkJCQlkcHRlX3Jvd193aWR0aF9sdW1hX3ViW2tdIC8gZHB0ZV9ncm91cF93
aWR0aF9sdW1hLAorCQkJCQkxKTsKKwkJCXRpbWVfcGVyX3B0ZV9ncm91cF9ub21fbHVtYVtrXSA9
IERTVF9ZX1BFUl9QVEVfUk9XX05PTV9MW2tdICogSFRvdGFsW2tdCisJCQkJCS8gUGl4ZWxDbG9j
a1trXSAvIGRwdGVfZ3JvdXBzX3Blcl9yb3dfbHVtYV91YjsKKwkJCXRpbWVfcGVyX3B0ZV9ncm91
cF92YmxhbmtfbHVtYVtrXSA9IERlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJblZCbGFua1tr
XQorCQkJCQkqIEhUb3RhbFtrXSAvIFBpeGVsQ2xvY2tba10gLyBkcHRlX2dyb3Vwc19wZXJfcm93
X2x1bWFfdWI7CisJCQl0aW1lX3Blcl9wdGVfZ3JvdXBfZmxpcF9sdW1hW2tdID0KKwkJCQkJRGVz
dGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luSW1tZWRpYXRlRmxpcFtrXSAqIEhUb3RhbFtrXQor
CQkJCQkJCS8gUGl4ZWxDbG9ja1trXQorCQkJCQkJCS8gZHB0ZV9ncm91cHNfcGVyX3Jvd19sdW1h
X3ViOworCQkJaWYgKEJ5dGVQZXJQaXhlbERFVENba10gPT0gMCkgeworCQkJCXRpbWVfcGVyX3B0
ZV9ncm91cF9ub21fY2hyb21hW2tdID0gMDsKKwkJCQl0aW1lX3Blcl9wdGVfZ3JvdXBfdmJsYW5r
X2Nocm9tYVtrXSA9IDA7CisJCQkJdGltZV9wZXJfcHRlX2dyb3VwX2ZsaXBfY2hyb21hW2tdID0g
MDsKKwkJCX0gZWxzZSB7CisJCQkJaWYgKFNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikgeworCQkJ
CQlkcHRlX2dyb3VwX3dpZHRoX2Nocm9tYSA9IGRwdGVfZ3JvdXBfYnl0ZXNba10KKwkJCQkJCQkv
IFBURVJlcXVlc3RTaXplQ1trXSAqIFBpeGVsUFRFUmVxV2lkdGhDW2tdOworCQkJCX0gZWxzZSB7
CisJCQkJCWRwdGVfZ3JvdXBfd2lkdGhfY2hyb21hID0gZHB0ZV9ncm91cF9ieXRlc1trXQorCQkJ
CQkJCS8gUFRFUmVxdWVzdFNpemVDW2tdCisJCQkJCQkJKiBQaXhlbFBURVJlcUhlaWdodENba107
CisJCQkJfQorCQkJCWRwdGVfZ3JvdXBzX3Blcl9yb3dfY2hyb21hX3ViID0gZG1sX2NlaWwoCisJ
CQkJCQlkcHRlX3Jvd193aWR0aF9jaHJvbWFfdWJba10KKwkJCQkJCQkJLyBkcHRlX2dyb3VwX3dp
ZHRoX2Nocm9tYSwKKwkJCQkJCTEpOworCQkJCXRpbWVfcGVyX3B0ZV9ncm91cF9ub21fY2hyb21h
W2tdID0gRFNUX1lfUEVSX1BURV9ST1dfTk9NX0Nba10KKwkJCQkJCSogSFRvdGFsW2tdIC8gUGl4
ZWxDbG9ja1trXQorCQkJCQkJLyBkcHRlX2dyb3Vwc19wZXJfcm93X2Nocm9tYV91YjsKKwkJCQl0
aW1lX3Blcl9wdGVfZ3JvdXBfdmJsYW5rX2Nocm9tYVtrXSA9CisJCQkJCQlEZXN0aW5hdGlvbkxp
bmVzVG9SZXF1ZXN0Um93SW5WQmxhbmtba10gKiBIVG90YWxba10KKwkJCQkJCQkJLyBQaXhlbENs
b2NrW2tdCisJCQkJCQkJCS8gZHB0ZV9ncm91cHNfcGVyX3Jvd19jaHJvbWFfdWI7CisJCQkJdGlt
ZV9wZXJfcHRlX2dyb3VwX2ZsaXBfY2hyb21hW2tdID0KKwkJCQkJCURlc3RpbmF0aW9uTGluZXNU
b1JlcXVlc3RSb3dJbkltbWVkaWF0ZUZsaXBba10KKwkJCQkJCQkJKiBIVG90YWxba10gLyBQaXhl
bENsb2NrW2tdCisJCQkJCQkJCS8gZHB0ZV9ncm91cHNfcGVyX3Jvd19jaHJvbWFfdWI7CisJCQl9
CisJCX0gZWxzZSB7CisJCQl0aW1lX3Blcl9wdGVfZ3JvdXBfbm9tX2x1bWFba10gPSAwOworCQkJ
dGltZV9wZXJfcHRlX2dyb3VwX3ZibGFua19sdW1hW2tdID0gMDsKKwkJCXRpbWVfcGVyX3B0ZV9n
cm91cF9mbGlwX2x1bWFba10gPSAwOworCQkJdGltZV9wZXJfcHRlX2dyb3VwX25vbV9jaHJvbWFb
a10gPSAwOworCQkJdGltZV9wZXJfcHRlX2dyb3VwX3ZibGFua19jaHJvbWFba10gPSAwOworCQkJ
dGltZV9wZXJfcHRlX2dyb3VwX2ZsaXBfY2hyb21hW2tdID0gMDsKKwkJfQorCX0KKworCWZvciAo
ayA9IDA7IGsgPCBOdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmIChHUFVWTUVuYWJs
ZSA9PSB0cnVlICYmIChEQ0NFbmFibGVba10gPT0gdHJ1ZSB8fCBHUFVWTU1heFBhZ2VUYWJsZUxl
dmVscyA+IDEpKSB7CisJCQlpZiAoRENDRW5hYmxlW2tdID09IGZhbHNlKSB7CisJCQkJaWYgKEJ5
dGVQZXJQaXhlbERFVENba10gPiAwKSB7CisJCQkJCW51bV9ncm91cF9wZXJfbG93ZXJfdm1fc3Rh
Z2UgPQorCQkJCQkJZG1sX2NlaWwoKGRvdWJsZSkgKGRwZGUwX2J5dGVzX3Blcl9mcmFtZV91Yl9s
W2tdKSAvIChkb3VibGUpICh2bV9ncm91cF9ieXRlc1trXSksIDEpCisJCQkJCQkrIGRtbF9jZWls
KChkb3VibGUpIChkcGRlMF9ieXRlc19wZXJfZnJhbWVfdWJfY1trXSkgLyAoZG91YmxlKSAodm1f
Z3JvdXBfYnl0ZXNba10pLCAxKTsKKwkJCQl9IGVsc2UgeworCQkJCQludW1fZ3JvdXBfcGVyX2xv
d2VyX3ZtX3N0YWdlID0KKwkJCQkJCQlkbWxfY2VpbCgoZG91YmxlKSAoZHBkZTBfYnl0ZXNfcGVy
X2ZyYW1lX3ViX2xba10pIC8gKGRvdWJsZSkgKHZtX2dyb3VwX2J5dGVzW2tdKSwgMSk7CisJCQkJ
fQorCQkJfSBlbHNlIHsKKwkJCQlpZiAoR1BVVk1NYXhQYWdlVGFibGVMZXZlbHMgPT0gMSkgewor
CQkJCQlpZiAoQnl0ZVBlclBpeGVsREVUQ1trXSA+IDApIHsKKwkJCQkJCW51bV9ncm91cF9wZXJf
bG93ZXJfdm1fc3RhZ2UgPQorCQkJCQkJCWRtbF9jZWlsKChkb3VibGUpIChtZXRhX3B0ZV9ieXRl
c19wZXJfZnJhbWVfdWJfbFtrXSkgLyAoZG91YmxlKSAodm1fZ3JvdXBfYnl0ZXNba10pLCAxKQor
CQkJCQkJCSsgZG1sX2NlaWwoKGRvdWJsZSkgKG1ldGFfcHRlX2J5dGVzX3Blcl9mcmFtZV91Yl9j
W2tdKSAvIChkb3VibGUpICh2bV9ncm91cF9ieXRlc1trXSksIDEpOworCQkJCQl9IGVsc2Ugewor
CQkJCQkJbnVtX2dyb3VwX3Blcl9sb3dlcl92bV9zdGFnZSA9CisJCQkJCQkJZG1sX2NlaWwoKGRv
dWJsZSkgKG1ldGFfcHRlX2J5dGVzX3Blcl9mcmFtZV91Yl9sW2tdKSAvIChkb3VibGUpICh2bV9n
cm91cF9ieXRlc1trXSksIDEpOworCQkJCQl9CisJCQkJfSBlbHNlIHsKKwkJCQkJaWYgKEJ5dGVQ
ZXJQaXhlbERFVENba10gPiAwKSB7CisJCQkJCQludW1fZ3JvdXBfcGVyX2xvd2VyX3ZtX3N0YWdl
ID0KKwkJCQkJCQlkbWxfY2VpbCgoZG91YmxlKSAoZHBkZTBfYnl0ZXNfcGVyX2ZyYW1lX3ViX2xb
a10pIC8gKGRvdWJsZSkgKHZtX2dyb3VwX2J5dGVzW2tdKSwgMSkKKwkJCQkJCQkrIGRtbF9jZWls
KChkb3VibGUpIChkcGRlMF9ieXRlc19wZXJfZnJhbWVfdWJfY1trXSkgLyAoZG91YmxlKSAodm1f
Z3JvdXBfYnl0ZXNba10pLCAxKQorCQkJCQkJCSsgZG1sX2NlaWwoKGRvdWJsZSkgKG1ldGFfcHRl
X2J5dGVzX3Blcl9mcmFtZV91Yl9sW2tdKSAvIChkb3VibGUpICh2bV9ncm91cF9ieXRlc1trXSks
IDEpCisJCQkJCQkJKyBkbWxfY2VpbCgoZG91YmxlKSAobWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1l
X3ViX2Nba10pIC8gKGRvdWJsZSkgKHZtX2dyb3VwX2J5dGVzW2tdKSwgMSk7CisJCQkJCX0gZWxz
ZSB7CisJCQkJCQludW1fZ3JvdXBfcGVyX2xvd2VyX3ZtX3N0YWdlID0KKwkJCQkJCQlkbWxfY2Vp
bCgoZG91YmxlKSAoZHBkZTBfYnl0ZXNfcGVyX2ZyYW1lX3ViX2xba10pIC8gKGRvdWJsZSkgKHZt
X2dyb3VwX2J5dGVzW2tdKSwgMSkKKwkJCQkJCQkrIGRtbF9jZWlsKChkb3VibGUpIChtZXRhX3B0
ZV9ieXRlc19wZXJfZnJhbWVfdWJfbFtrXSkgLyAoZG91YmxlKSAodm1fZ3JvdXBfYnl0ZXNba10p
LCAxKTsKKwkJCQkJfQorCQkJCX0KKwkJCX0KKworCQkJaWYgKERDQ0VuYWJsZVtrXSA9PSBmYWxz
ZSkgeworCQkJCWlmIChCeXRlUGVyUGl4ZWxERVRDW2tdID4gMCkgeworCQkJCQludW1fcmVxX3Bl
cl9sb3dlcl92bV9zdGFnZSA9IGRwZGUwX2J5dGVzX3Blcl9mcmFtZV91Yl9sW2tdCisJCQkJCQkJ
LyA2NCArIGRwZGUwX2J5dGVzX3Blcl9mcmFtZV91Yl9jW2tdIC8gNjQ7CisJCQkJfSBlbHNlIHsK
KwkJCQkJbnVtX3JlcV9wZXJfbG93ZXJfdm1fc3RhZ2UgPSBkcGRlMF9ieXRlc19wZXJfZnJhbWVf
dWJfbFtrXQorCQkJCQkJCS8gNjQ7CisJCQkJfQorCQkJfSBlbHNlIHsKKwkJCQlpZiAoR1BVVk1N
YXhQYWdlVGFibGVMZXZlbHMgPT0gMSkgeworCQkJCQlpZiAoQnl0ZVBlclBpeGVsREVUQ1trXSA+
IDApIHsKKwkJCQkJCW51bV9yZXFfcGVyX2xvd2VyX3ZtX3N0YWdlID0gbWV0YV9wdGVfYnl0ZXNf
cGVyX2ZyYW1lX3ViX2xba10gLyA2NAorCQkJCQkJCSsgbWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1l
X3ViX2Nba10gLyA2NDsKKwkJCQkJfSBlbHNlIHsKKwkJCQkJCW51bV9yZXFfcGVyX2xvd2VyX3Zt
X3N0YWdlID0gbWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1lX3ViX2xba10gLyA2NDsKKwkJCQkJfQor
CQkJCX0gZWxzZSB7CisJCQkJCWlmIChCeXRlUGVyUGl4ZWxERVRDW2tdID4gMCkgeworCQkJCQkJ
bnVtX3JlcV9wZXJfbG93ZXJfdm1fc3RhZ2UgPSBkcGRlMF9ieXRlc19wZXJfZnJhbWVfdWJfbFtr
XSAvIDY0CisJCQkJCQkJKyBkcGRlMF9ieXRlc19wZXJfZnJhbWVfdWJfY1trXSAvIDY0CisJCQkJ
CQkJKyBtZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWJfbFtrXSAvIDY0CisJCQkJCQkJKyBtZXRh
X3B0ZV9ieXRlc19wZXJfZnJhbWVfdWJfY1trXSAvIDY0OworCQkJCQl9IGVsc2UgeworCQkJCQkJ
bnVtX3JlcV9wZXJfbG93ZXJfdm1fc3RhZ2UgPSBkcGRlMF9ieXRlc19wZXJfZnJhbWVfdWJfbFtr
XSAvIDY0CisJCQkJCQkJKyBtZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWJfbFtrXSAvIDY0Owor
CQkJCQl9CisJCQkJfQorCQkJfQorCisJCQlUaW1lUGVyVk1Hcm91cFZCbGFua1trXSA9IERlc3Rp
bmF0aW9uTGluZXNUb1JlcXVlc3RWTUluVkJsYW5rW2tdICogSFRvdGFsW2tdCisJCQkJCS8gUGl4
ZWxDbG9ja1trXSAvIG51bV9ncm91cF9wZXJfbG93ZXJfdm1fc3RhZ2U7CisJCQlUaW1lUGVyVk1H
cm91cEZsaXBba10gPSBEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JbkltbWVkaWF0ZUZsaXBb
a10KKwkJCQkJKiBIVG90YWxba10gLyBQaXhlbENsb2NrW2tdIC8gbnVtX2dyb3VwX3Blcl9sb3dl
cl92bV9zdGFnZTsKKwkJCVRpbWVQZXJWTVJlcXVlc3RWQmxhbmtba10gPSBEZXN0aW5hdGlvbkxp
bmVzVG9SZXF1ZXN0Vk1JblZCbGFua1trXQorCQkJCQkqIEhUb3RhbFtrXSAvIFBpeGVsQ2xvY2tb
a10gLyBudW1fcmVxX3Blcl9sb3dlcl92bV9zdGFnZTsKKwkJCVRpbWVQZXJWTVJlcXVlc3RGbGlw
W2tdID0gRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5JbW1lZGlhdGVGbGlwW2tdCisJCQkJ
CSogSFRvdGFsW2tdIC8gUGl4ZWxDbG9ja1trXSAvIG51bV9yZXFfcGVyX2xvd2VyX3ZtX3N0YWdl
OworCisJCQlpZiAoR1BVVk1NYXhQYWdlVGFibGVMZXZlbHMgPiAyKSB7CisJCQkJVGltZVBlclZN
R3JvdXBWQmxhbmtba10gPSBUaW1lUGVyVk1Hcm91cFZCbGFua1trXSAvIDI7CisJCQkJVGltZVBl
clZNR3JvdXBGbGlwW2tdID0gVGltZVBlclZNR3JvdXBGbGlwW2tdIC8gMjsKKwkJCQlUaW1lUGVy
Vk1SZXF1ZXN0VkJsYW5rW2tdID0gVGltZVBlclZNUmVxdWVzdFZCbGFua1trXSAvIDI7CisJCQkJ
VGltZVBlclZNUmVxdWVzdEZsaXBba10gPSBUaW1lUGVyVk1SZXF1ZXN0RmxpcFtrXSAvIDI7CisJ
CQl9CisKKwkJfSBlbHNlIHsKKwkJCVRpbWVQZXJWTUdyb3VwVkJsYW5rW2tdID0gMDsKKwkJCVRp
bWVQZXJWTUdyb3VwRmxpcFtrXSA9IDA7CisJCQlUaW1lUGVyVk1SZXF1ZXN0VkJsYW5rW2tdID0g
MDsKKwkJCVRpbWVQZXJWTVJlcXVlc3RGbGlwW2tdID0gMDsKKwkJfQorCX0KK30KKworc3RhdGlj
IGRvdWJsZSBDYWxjdWxhdGVFeHRyYUxhdGVuY3koCisJCWRvdWJsZSBVcmdlbnRSb3VuZFRyaXBB
bmRPdXRPZk9yZGVyTGF0ZW5jeSwKKwkJaW50IFRvdGFsTnVtYmVyT2ZBY3RpdmVEUFAsCisJCWlu
dCBQaXhlbENodW5rU2l6ZUluS0J5dGUsCisJCWludCBUb3RhbE51bWJlck9mRENDQWN0aXZlRFBQ
LAorCQlpbnQgTWV0YUNodW5rU2l6ZSwKKwkJZG91YmxlIFJldHVybkJXLAorCQlib29sIEdQVVZN
RW5hYmxlLAorCQlib29sIEhvc3RWTUVuYWJsZSwKKwkJaW50IE51bWJlck9mQWN0aXZlUGxhbmVz
LAorCQlpbnQgTnVtYmVyT2ZEUFBbXSwKKwkJbG9uZyBkcHRlX2dyb3VwX2J5dGVzW10sCisJCWRv
dWJsZSBQZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQb3J0QldSZWNlaXZlZEFmdGVyVXJn
TGF0ZW5jeVBpeGVsTWl4ZWRXaXRoVk1EYXRhLAorCQlkb3VibGUgUGVyY2VudE9mSWRlYWxEUkFN
RmFicmljQW5kU0RQUG9ydEJXUmVjZWl2ZWRBZnRlclVyZ0xhdGVuY3lWTURhdGFPbmx5LAorCQlp
bnQgSG9zdFZNTWF4UGFnZVRhYmxlTGV2ZWxzLAorCQlpbnQgSG9zdFZNQ2FjaGVkUGFnZVRhYmxl
TGV2ZWxzKQoreworCWRvdWJsZSBDYWxjdWxhdGVFeHRyYUxhdGVuY3k7CisJZG91YmxlIEhvc3RW
TUluZWZmaWNpZW5jeUZhY3RvcjsKKwlpbnQgSG9zdFZNRHluYW1pY0xldmVsczsKKworCWlmIChH
UFVWTUVuYWJsZSAmJiBIb3N0Vk1FbmFibGUpIHsKKwkJSG9zdFZNSW5lZmZpY2llbmN5RmFjdG9y
ID0KKwkJCQlQZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQb3J0QldSZWNlaXZlZEFmdGVy
VXJnTGF0ZW5jeVBpeGVsTWl4ZWRXaXRoVk1EYXRhCisJCQkJCQkvIFBlcmNlbnRPZklkZWFsRFJB
TUZhYnJpY0FuZFNEUFBvcnRCV1JlY2VpdmVkQWZ0ZXJVcmdMYXRlbmN5Vk1EYXRhT25seTsKKwkJ
SG9zdFZNRHluYW1pY0xldmVscyA9IEhvc3RWTU1heFBhZ2VUYWJsZUxldmVscyAtIEhvc3RWTUNh
Y2hlZFBhZ2VUYWJsZUxldmVsczsKKwl9IGVsc2UgeworCQlIb3N0Vk1JbmVmZmljaWVuY3lGYWN0
b3IgPSAxOworCQlIb3N0Vk1EeW5hbWljTGV2ZWxzID0gMDsKKwl9CisKKwlDYWxjdWxhdGVFeHRy
YUxhdGVuY3kgPSBVcmdlbnRSb3VuZFRyaXBBbmRPdXRPZk9yZGVyTGF0ZW5jeQorCQkJKyAoVG90
YWxOdW1iZXJPZkFjdGl2ZURQUCAqIFBpeGVsQ2h1bmtTaXplSW5LQnl0ZQorCQkJCQkrIFRvdGFs
TnVtYmVyT2ZEQ0NBY3RpdmVEUFAgKiBNZXRhQ2h1bmtTaXplKSAqIDEwMjQuMAorCQkJCQkvIFJl
dHVybkJXOworCisJaWYgKEdQVVZNRW5hYmxlKSB7CisJCWludCBrOworCisJCWZvciAoayA9IDA7
IGsgPCBOdW1iZXJPZkFjdGl2ZVBsYW5lczsgaysrKSB7CisJCQlDYWxjdWxhdGVFeHRyYUxhdGVu
Y3kgPSBDYWxjdWxhdGVFeHRyYUxhdGVuY3kKKwkJCQkJKyBOdW1iZXJPZkRQUFtrXSAqIGRwdGVf
Z3JvdXBfYnl0ZXNba10KKwkJCQkJCQkqICgxICsgOCAqIEhvc3RWTUR5bmFtaWNMZXZlbHMpCisJ
CQkJCQkJKiBIb3N0Vk1JbmVmZmljaWVuY3lGYWN0b3IgLyBSZXR1cm5CVzsKKwkJfQorCX0KKwly
ZXR1cm4gQ2FsY3VsYXRlRXh0cmFMYXRlbmN5OworfQorCisjZW5kaWYKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGNuMjEvZGlzcGxheV9tb2RlX3ZiYV8y
MS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24yMS9kaXNwbGF5X21v
ZGVfdmJhXzIxLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5mYjk1
NDhhMmY4OTQKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvZG1sL2RjbjIxL2Rpc3BsYXlfbW9kZV92YmFfMjEuaApAQCAtMCwwICsxLDMyIEBACisvKgor
ICogQ29weXJpZ2h0IDIwMTcgQWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5jLgorICoKKyAqIFBl
cm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29u
IG9idGFpbmluZyBhCisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9j
dW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVhbCBpbiB0aGUgU29m
dHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgor
ICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3Ry
aWJ1dGUsIHN1YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJl
LCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlzIGZ1cm5p
c2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CisgKgor
ICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ug
c2hhbGwgYmUgaW5jbHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlv
bnMgb2YgdGhlIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMg
SVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVE
LCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5U
QUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZS
SU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIENPUFlSSUdIVCBIT0xERVIoUykg
T1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SCisgKiBPVEhF
UiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9U
SEVSV0lTRSwKKyAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBU
SEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgorICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRX
QVJFLgorICoKKyAqIEF1dGhvcnM6IEFNRAorICoKKyAqLworCisjaWZuZGVmIF9fRE1MMjFfRElT
UExBWV9NT0RFX1ZCQV9IX18KKyNkZWZpbmUgX19ETUwyMV9ESVNQTEFZX01PREVfVkJBX0hfXwor
Cit2b2lkIGRtbDIxX3JlY2FsY3VsYXRlKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xp
Yik7Cit2b2lkIGRtbDIxX01vZGVTdXBwb3J0QW5kU3lzdGVtQ29uZmlndXJhdGlvbkZ1bGwoc3Ry
dWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliKTsKKworI2VuZGlmIC8qIF9ETUwyMV9ESVNQ
TEFZX01PREVfVkJBX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvZG1sL2RjbjIxL2Rpc3BsYXlfcnFfZGxnX2NhbGNfMjEuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvZGlzcGxheS9kYy9kbWwvZGNuMjEvZGlzcGxheV9ycV9kbGdfY2FsY18yMS5jCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYTFmMjA3Y2JiOTY2Ci0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24yMS9kaXNw
bGF5X3JxX2RsZ19jYWxjXzIxLmMKQEAgLTAsMCArMSwxODIzIEBACisvKgorICogQ29weXJpZ2h0
IDIwMTcgQWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5jLgorICoKKyAqIFBlcm1pc3Npb24gaXMg
aGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBh
CisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBm
aWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91
dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgorICogdGhlIHJpZ2h0
cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1Ymxp
Y2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVy
bWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBz
bywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CisgKgorICogVGhlIGFib3Zl
IGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5j
bHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNv
ZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VU
IFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVELCBJTkNMVURJTkcg
QlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKKyAq
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJ
TiBOTyBFVkVOVCBTSEFMTAorICogVEhFIENPUFlSSUdIVCBIT0xERVIoUykgT1IgQVVUSE9SKFMp
IEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SCisgKiBPVEhFUiBMSUFCSUxJVFks
IFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwKKyAq
IEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUg
T1IgVEhFIFVTRSBPUgorICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgorICoKKyAq
IEF1dGhvcnM6IEFNRAorICoKKyAqLworCisjaWZkZWYgQ09ORklHX0RSTV9BTURfRENfRENOMl8w
CisKKyNpbmNsdWRlICIuLi9kaXNwbGF5X21vZGVfbGliLmgiCisjaW5jbHVkZSAiLi4vZGlzcGxh
eV9tb2RlX3ZiYS5oIgorI2luY2x1ZGUgIi4uL2RtbF9pbmxpbmVfZGVmcy5oIgorI2luY2x1ZGUg
ImRpc3BsYXlfcnFfZGxnX2NhbGNfMjEuaCIKKworLyoKKyAqIE5PVEU6CisgKiAgIFRoaXMgZmls
ZSBpcyBnY2MtcGFyc2VhYmxlIEhXIGdvc3BlbCwgY29taW5nIHN0cmFpZ2h0IGZyb20gSFcgZW5n
aW5lZXJzLgorICoKKyAqIEl0IGRvZXNuJ3QgYWRoZXJlIHRvIExpbnV4IGtlcm5lbCBzdHlsZSBh
bmQgc29tZXRpbWVzIHdpbGwgZG8gdGhpbmdzIGluIG9kZAorICogd2F5cy4gVW5sZXNzIHRoZXJl
IGlzIHNvbWV0aGluZyBjbGVhcmx5IHdyb25nIHdpdGggaXQgdGhlIGNvZGUgc2hvdWxkCisgKiBy
ZW1haW4gYXMtaXMgYXMgaXQgcHJvdmlkZXMgdXMgd2l0aCBhIGd1YXJhbnRlZSBmcm9tIEhXIHRo
YXQgaXQgaXMgY29ycmVjdC4KKyAqLworCitzdGF0aWMgdm9pZCBjYWxjdWxhdGVfdHR1X2N1cnNv
cigKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgKnJlZmN5
Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIsCisJCWRvdWJsZSAqcmVmY3ljX3Blcl9yZXFfZGVs
aXZlcnlfY3VyLAorCQlkb3VibGUgcmVmY2xrX2ZyZXFfaW5fbWh6LAorCQlkb3VibGUgcmVmX2Zy
ZXFfdG9fcGl4X2ZyZXEsCisJCWRvdWJsZSBoc2NhbGVfcGl4ZWxfcmF0ZV9sLAorCQlkb3VibGUg
aHNjbF9yYXRpbywKKwkJZG91YmxlIHZyYXRpb19wcmVfbCwKKwkJZG91YmxlIHZyYXRpb19sLAor
CQl1bnNpZ25lZCBpbnQgY3VyX3dpZHRoLAorCQllbnVtIGN1cnNvcl9icHAgY3VyX2JwcCk7CisK
K3N0YXRpYyB1bnNpZ25lZCBpbnQgZ2V0X2J5dGVzX3Blcl9lbGVtZW50KGVudW0gc291cmNlX2Zv
cm1hdF9jbGFzcyBzb3VyY2VfZm9ybWF0LCBib29sIGlzX2Nocm9tYSkKK3sKKwl1bnNpZ25lZCBp
bnQgcmV0X3ZhbCA9IDA7CisKKwlpZiAoc291cmNlX2Zvcm1hdCA9PSBkbV80NDRfMTYpIHsKKwkJ
aWYgKCFpc19jaHJvbWEpCisJCQlyZXRfdmFsID0gMjsKKwl9IGVsc2UgaWYgKHNvdXJjZV9mb3Jt
YXQgPT0gZG1fNDQ0XzMyKSB7CisJCWlmICghaXNfY2hyb21hKQorCQkJcmV0X3ZhbCA9IDQ7CisJ
fSBlbHNlIGlmIChzb3VyY2VfZm9ybWF0ID09IGRtXzQ0NF82NCkgeworCQlpZiAoIWlzX2Nocm9t
YSkKKwkJCXJldF92YWwgPSA4OworCX0gZWxzZSBpZiAoc291cmNlX2Zvcm1hdCA9PSBkbV80MjBf
OCkgeworCQlpZiAoaXNfY2hyb21hKQorCQkJcmV0X3ZhbCA9IDI7CisJCWVsc2UKKwkJCXJldF92
YWwgPSAxOworCX0gZWxzZSBpZiAoc291cmNlX2Zvcm1hdCA9PSBkbV80MjBfMTApIHsKKwkJaWYg
KGlzX2Nocm9tYSkKKwkJCXJldF92YWwgPSA0OworCQllbHNlCisJCQlyZXRfdmFsID0gMjsKKwl9
IGVsc2UgaWYgKHNvdXJjZV9mb3JtYXQgPT0gZG1fNDQ0XzgpIHsKKwkJcmV0X3ZhbCA9IDE7CisJ
fQorCXJldHVybiByZXRfdmFsOworfQorCitzdGF0aWMgYm9vbCBpc19kdWFsX3BsYW5lKGVudW0g
c291cmNlX2Zvcm1hdF9jbGFzcyBzb3VyY2VfZm9ybWF0KQoreworCWJvb2wgcmV0X3ZhbCA9IDA7
CisKKwlpZiAoKHNvdXJjZV9mb3JtYXQgPT0gZG1fNDIwXzgpIHx8IChzb3VyY2VfZm9ybWF0ID09
IGRtXzQyMF8xMCkpCisJCXJldF92YWwgPSAxOworCisJcmV0dXJuIHJldF92YWw7Cit9CisKK3N0
YXRpYyBkb3VibGUgZ2V0X3JlZmN5Y19wZXJfZGVsaXZlcnkoCisJCXN0cnVjdCBkaXNwbGF5X21v
ZGVfbGliICptb2RlX2xpYiwKKwkJZG91YmxlIHJlZmNsa19mcmVxX2luX21oeiwKKwkJZG91Ymxl
IHBjbGtfZnJlcV9pbl9taHosCisJCWJvb2wgb2RtX2NvbWJpbmUsCisJCXVuc2lnbmVkIGludCBy
ZWNvdXRfd2lkdGgsCisJCXVuc2lnbmVkIGludCBoYWN0aXZlLAorCQlkb3VibGUgdnJhdGlvLAor
CQlkb3VibGUgaHNjYWxlX3BpeGVsX3JhdGUsCisJCXVuc2lnbmVkIGludCBkZWxpdmVyeV93aWR0
aCwKKwkJdW5zaWduZWQgaW50IHJlcV9wZXJfc3dhdGhfdWIpCit7CisJZG91YmxlIHJlZmN5Y19w
ZXJfZGVsaXZlcnkgPSAwLjA7CisKKwlpZiAodnJhdGlvIDw9IDEuMCkgeworCQlpZiAob2RtX2Nv
bWJpbmUpCisJCQlyZWZjeWNfcGVyX2RlbGl2ZXJ5ID0gKGRvdWJsZSkgcmVmY2xrX2ZyZXFfaW5f
bWh6CisJCQkJCSogZG1sX21pbigoZG91YmxlKSByZWNvdXRfd2lkdGgsIChkb3VibGUpIGhhY3Rp
dmUgLyAyLjApCisJCQkJCS8gcGNsa19mcmVxX2luX21oeiAvIChkb3VibGUpIHJlcV9wZXJfc3dh
dGhfdWI7CisJCWVsc2UKKwkJCXJlZmN5Y19wZXJfZGVsaXZlcnkgPSAoZG91YmxlKSByZWZjbGtf
ZnJlcV9pbl9taHogKiAoZG91YmxlKSByZWNvdXRfd2lkdGgKKwkJCQkJLyBwY2xrX2ZyZXFfaW5f
bWh6IC8gKGRvdWJsZSkgcmVxX3Blcl9zd2F0aF91YjsKKwl9IGVsc2UgeworCQlyZWZjeWNfcGVy
X2RlbGl2ZXJ5ID0gKGRvdWJsZSkgcmVmY2xrX2ZyZXFfaW5fbWh6ICogKGRvdWJsZSkgZGVsaXZl
cnlfd2lkdGgKKwkJCQkvIChkb3VibGUpIGhzY2FsZV9waXhlbF9yYXRlIC8gKGRvdWJsZSkgcmVx
X3Blcl9zd2F0aF91YjsKKwl9CisKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZWZjbGtfZnJl
cV9pbl9taHogPSAlMy4yZlxuIiwgX19mdW5jX18sIHJlZmNsa19mcmVxX2luX21oeik7CisJZG1s
X3ByaW50KCJETUxfRExHOiAlczogcGNsa19mcmVxX2luX21oeiAgID0gJTMuMmZcbiIsIF9fZnVu
Y19fLCBwY2xrX2ZyZXFfaW5fbWh6KTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZWNvdXRf
d2lkdGggICAgICAgPSAlZFxuIiwgX19mdW5jX18sIHJlY291dF93aWR0aCk7CisJZG1sX3ByaW50
KCJETUxfRExHOiAlczogdnJhdGlvICAgICAgICAgICAgID0gJTMuMmZcbiIsIF9fZnVuY19fLCB2
cmF0aW8pOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJlcV9wZXJfc3dhdGhfdWIgICA9ICVk
XG4iLCBfX2Z1bmNfXywgcmVxX3Blcl9zd2F0aF91Yik7CisJZG1sX3ByaW50KCJETUxfRExHOiAl
czogcmVmY3ljX3Blcl9kZWxpdmVyeT0gJTMuMmZcbiIsIF9fZnVuY19fLCByZWZjeWNfcGVyX2Rl
bGl2ZXJ5KTsKKworCXJldHVybiByZWZjeWNfcGVyX2RlbGl2ZXJ5OworCit9CisKK3N0YXRpYyB1
bnNpZ25lZCBpbnQgZ2V0X2Jsa19zaXplX2J5dGVzKGNvbnN0IGVudW0gc291cmNlX21hY3JvX3Rp
bGVfc2l6ZSB0aWxlX3NpemUpCit7CisJaWYgKHRpbGVfc2l6ZSA9PSBkbV8yNTZrX3RpbGUpCisJ
CXJldHVybiAoMjU2ICogMTAyNCk7CisJZWxzZSBpZiAodGlsZV9zaXplID09IGRtXzY0a190aWxl
KQorCQlyZXR1cm4gKDY0ICogMTAyNCk7CisJZWxzZQorCQlyZXR1cm4gKDQgKiAxMDI0KTsKK30K
Kworc3RhdGljIHZvaWQgZXh0cmFjdF9ycV9zaXppbmdfcmVncygKKwkJc3RydWN0IGRpc3BsYXlf
bW9kZV9saWIgKm1vZGVfbGliLAorCQlkaXNwbGF5X2RhdGFfcnFfcmVnc19zdCAqcnFfcmVncywK
KwkJY29uc3QgZGlzcGxheV9kYXRhX3JxX3NpemluZ19wYXJhbXNfc3QgcnFfc2l6aW5nKQorewor
CWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJxX3NpemluZyBwYXJhbVxuIiwgX19mdW5jX18pOwor
CXByaW50X19kYXRhX3JxX3NpemluZ19wYXJhbXNfc3QobW9kZV9saWIsIHJxX3NpemluZyk7CisK
KwlycV9yZWdzLT5jaHVua19zaXplID0gZG1sX2xvZzIocnFfc2l6aW5nLmNodW5rX2J5dGVzKSAt
IDEwOworCisJaWYgKHJxX3NpemluZy5taW5fY2h1bmtfYnl0ZXMgPT0gMCkKKwkJcnFfcmVncy0+
bWluX2NodW5rX3NpemUgPSAwOworCWVsc2UKKwkJcnFfcmVncy0+bWluX2NodW5rX3NpemUgPSBk
bWxfbG9nMihycV9zaXppbmcubWluX2NodW5rX2J5dGVzKSAtIDggKyAxOworCisJcnFfcmVncy0+
bWV0YV9jaHVua19zaXplID0gZG1sX2xvZzIocnFfc2l6aW5nLm1ldGFfY2h1bmtfYnl0ZXMpIC0g
MTA7CisJaWYgKHJxX3NpemluZy5taW5fbWV0YV9jaHVua19ieXRlcyA9PSAwKQorCQlycV9yZWdz
LT5taW5fbWV0YV9jaHVua19zaXplID0gMDsKKwllbHNlCisJCXJxX3JlZ3MtPm1pbl9tZXRhX2No
dW5rX3NpemUgPSBkbWxfbG9nMihycV9zaXppbmcubWluX21ldGFfY2h1bmtfYnl0ZXMpIC0gNiAr
IDE7CisKKwlycV9yZWdzLT5kcHRlX2dyb3VwX3NpemUgPSBkbWxfbG9nMihycV9zaXppbmcuZHB0
ZV9ncm91cF9ieXRlcykgLSA2OworCXJxX3JlZ3MtPm1wdGVfZ3JvdXBfc2l6ZSA9IGRtbF9sb2cy
KHJxX3NpemluZy5tcHRlX2dyb3VwX2J5dGVzKSAtIDY7Cit9CisKK3N0YXRpYyB2b2lkIGV4dHJh
Y3RfcnFfcmVncygKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkaXNw
bGF5X3JxX3JlZ3Nfc3QgKnJxX3JlZ3MsCisJCWNvbnN0IGRpc3BsYXlfcnFfcGFyYW1zX3N0IHJx
X3BhcmFtKQoreworCXVuc2lnbmVkIGludCBkZXRpbGVfYnVmX3NpemVfaW5fYnl0ZXMgPSBtb2Rl
X2xpYi0+aXAuZGV0X2J1ZmZlcl9zaXplX2tieXRlcyAqIDEwMjQ7CisJdW5zaWduZWQgaW50IGRl
dGlsZV9idWZfcGxhbmUxX2FkZHIgPSAwOworCisJZXh0cmFjdF9ycV9zaXppbmdfcmVncyhtb2Rl
X2xpYiwgJihycV9yZWdzLT5ycV9yZWdzX2wpLCBycV9wYXJhbS5zaXppbmcucnFfbCk7CisKKwly
cV9yZWdzLT5ycV9yZWdzX2wucHRlX3Jvd19oZWlnaHRfbGluZWFyID0gZG1sX2Zsb29yKAorCQkJ
ZG1sX2xvZzIocnFfcGFyYW0uZGxnLnJxX2wuZHB0ZV9yb3dfaGVpZ2h0KSwKKwkJCTEpIC0gMzsK
KworCWlmIChycV9wYXJhbS55dXY0MjApIHsKKwkJZXh0cmFjdF9ycV9zaXppbmdfcmVncyhtb2Rl
X2xpYiwgJihycV9yZWdzLT5ycV9yZWdzX2MpLCBycV9wYXJhbS5zaXppbmcucnFfYyk7CisJCXJx
X3JlZ3MtPnJxX3JlZ3NfYy5wdGVfcm93X2hlaWdodF9saW5lYXIgPSBkbWxfZmxvb3IoCisJCQkJ
ZG1sX2xvZzIocnFfcGFyYW0uZGxnLnJxX2MuZHB0ZV9yb3dfaGVpZ2h0KSwKKwkJCQkxKSAtIDM7
CisJfQorCisJcnFfcmVncy0+cnFfcmVnc19sLnN3YXRoX2hlaWdodCA9IGRtbF9sb2cyKHJxX3Bh
cmFtLmRsZy5ycV9sLnN3YXRoX2hlaWdodCk7CisJcnFfcmVncy0+cnFfcmVnc19jLnN3YXRoX2hl
aWdodCA9IGRtbF9sb2cyKHJxX3BhcmFtLmRsZy5ycV9jLnN3YXRoX2hlaWdodCk7CisKKwkvLyBG
SVhNRTogdGFrZSB0aGUgbWF4IGJldHdlZW4gbHVtYSwgY2hyb21hIGNodW5rIHNpemU/CisJLy8g
b2theSBmb3Igbm93LCBhcyB3ZSBhcmUgc2V0dGluZyBjaHVua19ieXRlcyB0byA4a2IgYW55d2F5
cworCWlmIChycV9wYXJhbS5zaXppbmcucnFfbC5jaHVua19ieXRlcyA+PSAzMiAqIDEwMjQpIHsg
Ly8zMmtiCisJCXJxX3JlZ3MtPmRycV9leHBhbnNpb25fbW9kZSA9IDA7CisJfSBlbHNlIHsKKwkJ
cnFfcmVncy0+ZHJxX2V4cGFuc2lvbl9tb2RlID0gMjsKKwl9CisJcnFfcmVncy0+cHJxX2V4cGFu
c2lvbl9tb2RlID0gMTsKKwlycV9yZWdzLT5tcnFfZXhwYW5zaW9uX21vZGUgPSAxOworCXJxX3Jl
Z3MtPmNycV9leHBhbnNpb25fbW9kZSA9IDE7CisKKwlpZiAocnFfcGFyYW0ueXV2NDIwKSB7CisJ
CWlmICgoZG91YmxlKSBycV9wYXJhbS5taXNjLnJxX2wuc3RvcmVkX3N3YXRoX2J5dGVzCisJCQkJ
LyAoZG91YmxlKSBycV9wYXJhbS5taXNjLnJxX2Muc3RvcmVkX3N3YXRoX2J5dGVzIDw9IDEuNSkg
eworCQkJZGV0aWxlX2J1Zl9wbGFuZTFfYWRkciA9IChkZXRpbGVfYnVmX3NpemVfaW5fYnl0ZXMg
LyAyLjAgLyA2NC4wKTsgLy8gaGFsZiB0byBjaHJvbWEKKwkJfSBlbHNlIHsKKwkJCWRldGlsZV9i
dWZfcGxhbmUxX2FkZHIgPSBkbWxfcm91bmRfdG9fbXVsdGlwbGUoCisJCQkJCSh1bnNpZ25lZCBp
bnQpICgoMi4wICogZGV0aWxlX2J1Zl9zaXplX2luX2J5dGVzKSAvIDMuMCksCisJCQkJCTI1NiwK
KwkJCQkJMCkgLyA2NC4wOyAvLyAyLzMgdG8gY2hyb21hCisJCX0KKwl9CisJcnFfcmVncy0+cGxh
bmUxX2Jhc2VfYWRkcmVzcyA9IGRldGlsZV9idWZfcGxhbmUxX2FkZHI7Cit9CisKK3N0YXRpYyB2
b2lkIGhhbmRsZV9kZXRfYnVmX3NwbGl0KAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9k
ZV9saWIsCisJCWRpc3BsYXlfcnFfcGFyYW1zX3N0ICpycV9wYXJhbSwKKwkJY29uc3QgZGlzcGxh
eV9waXBlX3NvdXJjZV9wYXJhbXNfc3QgcGlwZV9zcmNfcGFyYW0pCit7CisJdW5zaWduZWQgaW50
IHRvdGFsX3N3YXRoX2J5dGVzID0gMDsKKwl1bnNpZ25lZCBpbnQgc3dhdGhfYnl0ZXNfbCA9IDA7
CisJdW5zaWduZWQgaW50IHN3YXRoX2J5dGVzX2MgPSAwOworCXVuc2lnbmVkIGludCBmdWxsX3N3
YXRoX2J5dGVzX3BhY2tlZF9sID0gMDsKKwl1bnNpZ25lZCBpbnQgZnVsbF9zd2F0aF9ieXRlc19w
YWNrZWRfYyA9IDA7CisJYm9vbCByZXExMjhfbCA9IDA7CisJYm9vbCByZXExMjhfYyA9IDA7CisJ
Ym9vbCBzdXJmX2xpbmVhciA9IChwaXBlX3NyY19wYXJhbS5zd19tb2RlID09IGRtX3N3X2xpbmVh
cik7CisJYm9vbCBzdXJmX3ZlcnQgPSAocGlwZV9zcmNfcGFyYW0uc291cmNlX3NjYW4gPT0gZG1f
dmVydCk7CisJdW5zaWduZWQgaW50IGxvZzJfc3dhdGhfaGVpZ2h0X2wgPSAwOworCXVuc2lnbmVk
IGludCBsb2cyX3N3YXRoX2hlaWdodF9jID0gMDsKKwl1bnNpZ25lZCBpbnQgZGV0aWxlX2J1Zl9z
aXplX2luX2J5dGVzID0gbW9kZV9saWItPmlwLmRldF9idWZmZXJfc2l6ZV9rYnl0ZXMgKiAxMDI0
OworCisJZnVsbF9zd2F0aF9ieXRlc19wYWNrZWRfbCA9IHJxX3BhcmFtLT5taXNjLnJxX2wuZnVs
bF9zd2F0aF9ieXRlczsKKwlmdWxsX3N3YXRoX2J5dGVzX3BhY2tlZF9jID0gcnFfcGFyYW0tPm1p
c2MucnFfYy5mdWxsX3N3YXRoX2J5dGVzOworCisJaWYgKHJxX3BhcmFtLT55dXY0MjBfMTBicGMp
IHsKKwkJZnVsbF9zd2F0aF9ieXRlc19wYWNrZWRfbCA9IGRtbF9yb3VuZF90b19tdWx0aXBsZSgK
KwkJCQlycV9wYXJhbS0+bWlzYy5ycV9sLmZ1bGxfc3dhdGhfYnl0ZXMgKiAyIC8gMywKKwkJCQky
NTYsCisJCQkJMSkgKyAyNTY7CisJCWZ1bGxfc3dhdGhfYnl0ZXNfcGFja2VkX2MgPSBkbWxfcm91
bmRfdG9fbXVsdGlwbGUoCisJCQkJcnFfcGFyYW0tPm1pc2MucnFfYy5mdWxsX3N3YXRoX2J5dGVz
ICogMiAvIDMsCisJCQkJMjU2LAorCQkJCTEpICsgMjU2OworCX0KKworCWlmIChycV9wYXJhbS0+
eXV2NDIwKSB7CisJCXRvdGFsX3N3YXRoX2J5dGVzID0gMiAqIGZ1bGxfc3dhdGhfYnl0ZXNfcGFj
a2VkX2wgKyAyICogZnVsbF9zd2F0aF9ieXRlc19wYWNrZWRfYzsKKworCQlpZiAodG90YWxfc3dh
dGhfYnl0ZXMgPD0gZGV0aWxlX2J1Zl9zaXplX2luX2J5dGVzKSB7IC8vZnVsbCAyNTZiIHJlcXVl
c3QKKwkJCXJlcTEyOF9sID0gMDsKKwkJCXJlcTEyOF9jID0gMDsKKwkJCXN3YXRoX2J5dGVzX2wg
PSBmdWxsX3N3YXRoX2J5dGVzX3BhY2tlZF9sOworCQkJc3dhdGhfYnl0ZXNfYyA9IGZ1bGxfc3dh
dGhfYnl0ZXNfcGFja2VkX2M7CisJCX0gZWxzZSB7IC8vMTI4YiByZXF1ZXN0IChmb3IgbHVtYSBv
bmx5IGZvciB5dXY0MjAgOGJwYykKKwkJCXJlcTEyOF9sID0gMTsKKwkJCXJlcTEyOF9jID0gMDsK
KwkJCXN3YXRoX2J5dGVzX2wgPSBmdWxsX3N3YXRoX2J5dGVzX3BhY2tlZF9sIC8gMjsKKwkJCXN3
YXRoX2J5dGVzX2MgPSBmdWxsX3N3YXRoX2J5dGVzX3BhY2tlZF9jOworCQl9CisJCS8vIE5vdGU6
IGFzc3VtcHRpb24sIHRoZSBjb25maWcgdGhhdCBwYXNzIGluIHdpbGwgZml0IGludG8KKwkJLy8g
ICAgICAgdGhlIGRldGlsZWQgYnVmZmVyLgorCX0gZWxzZSB7CisJCXRvdGFsX3N3YXRoX2J5dGVz
ID0gMiAqIGZ1bGxfc3dhdGhfYnl0ZXNfcGFja2VkX2w7CisKKwkJaWYgKHRvdGFsX3N3YXRoX2J5
dGVzIDw9IGRldGlsZV9idWZfc2l6ZV9pbl9ieXRlcykKKwkJCXJlcTEyOF9sID0gMDsKKwkJZWxz
ZQorCQkJcmVxMTI4X2wgPSAxOworCisJCXN3YXRoX2J5dGVzX2wgPSB0b3RhbF9zd2F0aF9ieXRl
czsKKwkJc3dhdGhfYnl0ZXNfYyA9IDA7CisJfQorCXJxX3BhcmFtLT5taXNjLnJxX2wuc3RvcmVk
X3N3YXRoX2J5dGVzID0gc3dhdGhfYnl0ZXNfbDsKKwlycV9wYXJhbS0+bWlzYy5ycV9jLnN0b3Jl
ZF9zd2F0aF9ieXRlcyA9IHN3YXRoX2J5dGVzX2M7CisKKwlpZiAoc3VyZl9saW5lYXIpIHsKKwkJ
bG9nMl9zd2F0aF9oZWlnaHRfbCA9IDA7CisJCWxvZzJfc3dhdGhfaGVpZ2h0X2MgPSAwOworCX0g
ZWxzZSBpZiAoIXN1cmZfdmVydCkgeworCQlsb2cyX3N3YXRoX2hlaWdodF9sID0gZG1sX2xvZzIo
cnFfcGFyYW0tPm1pc2MucnFfbC5ibGsyNTZfaGVpZ2h0KSAtIHJlcTEyOF9sOworCQlsb2cyX3N3
YXRoX2hlaWdodF9jID0gZG1sX2xvZzIocnFfcGFyYW0tPm1pc2MucnFfYy5ibGsyNTZfaGVpZ2h0
KSAtIHJlcTEyOF9jOworCX0gZWxzZSB7CisJCWxvZzJfc3dhdGhfaGVpZ2h0X2wgPSBkbWxfbG9n
MihycV9wYXJhbS0+bWlzYy5ycV9sLmJsazI1Nl93aWR0aCkgLSByZXExMjhfbDsKKwkJbG9nMl9z
d2F0aF9oZWlnaHRfYyA9IGRtbF9sb2cyKHJxX3BhcmFtLT5taXNjLnJxX2MuYmxrMjU2X3dpZHRo
KSAtIHJlcTEyOF9jOworCX0KKwlycV9wYXJhbS0+ZGxnLnJxX2wuc3dhdGhfaGVpZ2h0ID0gMSA8
PCBsb2cyX3N3YXRoX2hlaWdodF9sOworCXJxX3BhcmFtLT5kbGcucnFfYy5zd2F0aF9oZWlnaHQg
PSAxIDw8IGxvZzJfc3dhdGhfaGVpZ2h0X2M7CisKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBy
ZXExMjhfbCA9ICUwZFxuIiwgX19mdW5jX18sIHJlcTEyOF9sKTsKKwlkbWxfcHJpbnQoIkRNTF9E
TEc6ICVzOiByZXExMjhfYyA9ICUwZFxuIiwgX19mdW5jX18sIHJlcTEyOF9jKTsKKwlkbWxfcHJp
bnQoCisJCQkiRE1MX0RMRzogJXM6IGZ1bGxfc3dhdGhfYnl0ZXNfcGFja2VkX2wgPSAlMGRcbiIs
CisJCQlfX2Z1bmNfXywKKwkJCWZ1bGxfc3dhdGhfYnl0ZXNfcGFja2VkX2wpOworCWRtbF9wcmlu
dCgKKwkJCSJETUxfRExHOiAlczogZnVsbF9zd2F0aF9ieXRlc19wYWNrZWRfYyA9ICUwZFxuIiwK
KwkJCV9fZnVuY19fLAorCQkJZnVsbF9zd2F0aF9ieXRlc19wYWNrZWRfYyk7Cit9CisKK3N0YXRp
YyB2b2lkIGdldF9tZXRhX2FuZF9wdGVfYXR0cigKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIg
Km1vZGVfbGliLAorCQlkaXNwbGF5X2RhdGFfcnFfZGxnX3BhcmFtc19zdCAqcnFfZGxnX3BhcmFt
LAorCQlkaXNwbGF5X2RhdGFfcnFfbWlzY19wYXJhbXNfc3QgKnJxX21pc2NfcGFyYW0sCisJCWRp
c3BsYXlfZGF0YV9ycV9zaXppbmdfcGFyYW1zX3N0ICpycV9zaXppbmdfcGFyYW0sCisJCXVuc2ln
bmVkIGludCB2cF93aWR0aCwKKwkJdW5zaWduZWQgaW50IHZwX2hlaWdodCwKKwkJdW5zaWduZWQg
aW50IGRhdGFfcGl0Y2gsCisJCXVuc2lnbmVkIGludCBtZXRhX3BpdGNoLAorCQl1bnNpZ25lZCBp
bnQgc291cmNlX2Zvcm1hdCwKKwkJdW5zaWduZWQgaW50IHRpbGluZywKKwkJdW5zaWduZWQgaW50
IG1hY3JvX3RpbGVfc2l6ZSwKKwkJdW5zaWduZWQgaW50IHNvdXJjZV9zY2FuLAorCQl1bnNpZ25l
ZCBpbnQgaG9zdHZtX2VuYWJsZSwKKwkJdW5zaWduZWQgaW50IGlzX2Nocm9tYSkKK3sKKwlib29s
IHN1cmZfbGluZWFyID0gKHRpbGluZyA9PSBkbV9zd19saW5lYXIpOworCWJvb2wgc3VyZl92ZXJ0
ID0gKHNvdXJjZV9zY2FuID09IGRtX3ZlcnQpOworCisJdW5zaWduZWQgaW50IGJ5dGVzX3Blcl9l
bGVtZW50OworCXVuc2lnbmVkIGludCBieXRlc19wZXJfZWxlbWVudF95ID0gZ2V0X2J5dGVzX3Bl
cl9lbGVtZW50KAorCQkJKGVudW0gc291cmNlX2Zvcm1hdF9jbGFzcykgKHNvdXJjZV9mb3JtYXQp
LAorCQkJZmFsc2UpOworCXVuc2lnbmVkIGludCBieXRlc19wZXJfZWxlbWVudF9jID0gZ2V0X2J5
dGVzX3Blcl9lbGVtZW50KAorCQkJKGVudW0gc291cmNlX2Zvcm1hdF9jbGFzcykgKHNvdXJjZV9m
b3JtYXQpLAorCQkJdHJ1ZSk7CisKKwl1bnNpZ25lZCBpbnQgYmxrMjU2X3dpZHRoID0gMDsKKwl1
bnNpZ25lZCBpbnQgYmxrMjU2X2hlaWdodCA9IDA7CisKKwl1bnNpZ25lZCBpbnQgYmxrMjU2X3dp
ZHRoX3kgPSAwOworCXVuc2lnbmVkIGludCBibGsyNTZfaGVpZ2h0X3kgPSAwOworCXVuc2lnbmVk
IGludCBibGsyNTZfd2lkdGhfYyA9IDA7CisJdW5zaWduZWQgaW50IGJsazI1Nl9oZWlnaHRfYyA9
IDA7CisJdW5zaWduZWQgaW50IGxvZzJfYnl0ZXNfcGVyX2VsZW1lbnQ7CisJdW5zaWduZWQgaW50
IGxvZzJfYmxrMjU2X3dpZHRoOworCXVuc2lnbmVkIGludCBsb2cyX2JsazI1Nl9oZWlnaHQ7CisJ
dW5zaWduZWQgaW50IGJsa19ieXRlczsKKwl1bnNpZ25lZCBpbnQgbG9nMl9ibGtfYnl0ZXM7CisJ
dW5zaWduZWQgaW50IGxvZzJfYmxrX2hlaWdodDsKKwl1bnNpZ25lZCBpbnQgbG9nMl9ibGtfd2lk
dGg7CisJdW5zaWduZWQgaW50IGxvZzJfbWV0YV9yZXFfYnl0ZXM7CisJdW5zaWduZWQgaW50IGxv
ZzJfbWV0YV9yZXFfaGVpZ2h0OworCXVuc2lnbmVkIGludCBsb2cyX21ldGFfcmVxX3dpZHRoOwor
CXVuc2lnbmVkIGludCBtZXRhX3JlcV93aWR0aDsKKwl1bnNpZ25lZCBpbnQgbWV0YV9yZXFfaGVp
Z2h0OworCXVuc2lnbmVkIGludCBsb2cyX21ldGFfcm93X2hlaWdodDsKKwl1bnNpZ25lZCBpbnQg
bWV0YV9yb3dfd2lkdGhfdWI7CisJdW5zaWduZWQgaW50IGxvZzJfbWV0YV9jaHVua19ieXRlczsK
Kwl1bnNpZ25lZCBpbnQgbG9nMl9tZXRhX2NodW5rX2hlaWdodDsKKworCS8vZnVsbCBzaXplZCBt
ZXRhIGNodW5rIHdpZHRoIGluIHVuaXQgb2YgZGF0YSBlbGVtZW50cworCXVuc2lnbmVkIGludCBs
b2cyX21ldGFfY2h1bmtfd2lkdGg7CisJdW5zaWduZWQgaW50IGxvZzJfbWluX21ldGFfY2h1bmtf
Ynl0ZXM7CisJdW5zaWduZWQgaW50IG1pbl9tZXRhX2NodW5rX3dpZHRoOworCXVuc2lnbmVkIGlu
dCBtZXRhX2NodW5rX3dpZHRoOworCXVuc2lnbmVkIGludCBtZXRhX2NodW5rX3Blcl9yb3dfaW50
OworCXVuc2lnbmVkIGludCBtZXRhX3Jvd19yZW1haW5kZXI7CisJdW5zaWduZWQgaW50IG1ldGFf
Y2h1bmtfdGhyZXNob2xkOworCXVuc2lnbmVkIGludCBtZXRhX2Jsa19ieXRlczsKKwl1bnNpZ25l
ZCBpbnQgbWV0YV9ibGtfaGVpZ2h0OworCXVuc2lnbmVkIGludCBtZXRhX2Jsa193aWR0aDsKKwl1
bnNpZ25lZCBpbnQgbWV0YV9zdXJmYWNlX2J5dGVzOworCXVuc2lnbmVkIGludCB2bXBnX2J5dGVz
OworCXVuc2lnbmVkIGludCBtZXRhX3B0ZV9yZXFfcGVyX2ZyYW1lX3ViOworCXVuc2lnbmVkIGlu
dCBtZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWI7CisJY29uc3QgdW5zaWduZWQgaW50IGxvZzJf
dm1wZ19ieXRlcyA9IGRtbF9sb2cyKG1vZGVfbGliLT5zb2Mudm1tX3BhZ2Vfc2l6ZV9ieXRlcyk7
CisJY29uc3QgdW5zaWduZWQgaW50IGRwdGVfYnVmX2luX3B0ZV9yZXFzID0KKwkJbW9kZV9saWIt
PmlwLmRwdGVfYnVmZmVyX3NpemVfaW5fcHRlX3JlcXNfbHVtYSArIG1vZGVfbGliLT5pcC5kcHRl
X2J1ZmZlcl9zaXplX2luX3B0ZV9yZXFzX2Nocm9tYTsKKwljb25zdCB1bnNpZ25lZCBpbnQgcGRl
X3Byb2NfYnVmZmVyX3NpemVfNjRrX3JlcXMgPQorCQkJbW9kZV9saWItPmlwLnBkZV9wcm9jX2J1
ZmZlcl9zaXplXzY0a19yZXFzOworCisJdW5zaWduZWQgaW50IGxvZzJfdm1wZ19oZWlnaHQgPSAw
OworCXVuc2lnbmVkIGludCBsb2cyX3ZtcGdfd2lkdGggPSAwOworCXVuc2lnbmVkIGludCBsb2cy
X2RwdGVfcmVxX2hlaWdodF9wdGVzID0gMDsKKwl1bnNpZ25lZCBpbnQgbG9nMl9kcHRlX3JlcV9o
ZWlnaHQgPSAwOworCXVuc2lnbmVkIGludCBsb2cyX2RwdGVfcmVxX3dpZHRoID0gMDsKKwl1bnNp
Z25lZCBpbnQgbG9nMl9kcHRlX3Jvd19oZWlnaHRfbGluZWFyID0gMDsKKwl1bnNpZ25lZCBpbnQg
bG9nMl9kcHRlX3Jvd19oZWlnaHQgPSAwOworCXVuc2lnbmVkIGludCBsb2cyX2RwdGVfZ3JvdXBf
d2lkdGggPSAwOworCXVuc2lnbmVkIGludCBkcHRlX3Jvd193aWR0aF91YiA9IDA7CisJdW5zaWdu
ZWQgaW50IGRwdGVfcmVxX2hlaWdodCA9IDA7CisJdW5zaWduZWQgaW50IGRwdGVfcmVxX3dpZHRo
ID0gMDsKKwl1bnNpZ25lZCBpbnQgZHB0ZV9ncm91cF93aWR0aCA9IDA7CisJdW5zaWduZWQgaW50
IGxvZzJfZHB0ZV9ncm91cF9ieXRlcyA9IDA7CisJdW5zaWduZWQgaW50IGxvZzJfZHB0ZV9ncm91
cF9sZW5ndGggPSAwOworCXVuc2lnbmVkIGludCBwZGVfYnVmX2VudHJpZXM7CisJYm9vbCB5dXY0
MjAgPSAoc291cmNlX2Zvcm1hdCA9PSBkbV80MjBfOCB8fCBzb3VyY2VfZm9ybWF0ID09IGRtXzQy
MF8xMCk7CisKKwlDYWxjdWxhdGUyNTZCQmxvY2tTaXplcygKKwkJCShlbnVtIHNvdXJjZV9mb3Jt
YXRfY2xhc3MpIChzb3VyY2VfZm9ybWF0KSwKKwkJCShlbnVtIGRtX3N3aXp6bGVfbW9kZSkgKHRp
bGluZyksCisJCQlieXRlc19wZXJfZWxlbWVudF95LAorCQkJYnl0ZXNfcGVyX2VsZW1lbnRfYywK
KwkJCSZibGsyNTZfaGVpZ2h0X3ksCisJCQkmYmxrMjU2X2hlaWdodF9jLAorCQkJJmJsazI1Nl93
aWR0aF95LAorCQkJJmJsazI1Nl93aWR0aF9jKTsKKworCWlmICghaXNfY2hyb21hKSB7CisJCWJs
azI1Nl93aWR0aCA9IGJsazI1Nl93aWR0aF95OworCQlibGsyNTZfaGVpZ2h0ID0gYmxrMjU2X2hl
aWdodF95OworCQlieXRlc19wZXJfZWxlbWVudCA9IGJ5dGVzX3Blcl9lbGVtZW50X3k7CisJfSBl
bHNlIHsKKwkJYmxrMjU2X3dpZHRoID0gYmxrMjU2X3dpZHRoX2M7CisJCWJsazI1Nl9oZWlnaHQg
PSBibGsyNTZfaGVpZ2h0X2M7CisJCWJ5dGVzX3Blcl9lbGVtZW50ID0gYnl0ZXNfcGVyX2VsZW1l
bnRfYzsKKwl9CisKKwlsb2cyX2J5dGVzX3Blcl9lbGVtZW50ID0gZG1sX2xvZzIoYnl0ZXNfcGVy
X2VsZW1lbnQpOworCisJZG1sX3ByaW50KCJETUxfRExHOiAlczogc3VyZl9saW5lYXIgICAgICAg
ID0gJWRcbiIsIF9fZnVuY19fLCBzdXJmX2xpbmVhcik7CisJZG1sX3ByaW50KCJETUxfRExHOiAl
czogc3VyZl92ZXJ0ICAgICAgICAgID0gJWRcbiIsIF9fZnVuY19fLCBzdXJmX3ZlcnQpOworCWRt
bF9wcmludCgiRE1MX0RMRzogJXM6IGJsazI1Nl93aWR0aCAgICAgICA9ICVkXG4iLCBfX2Z1bmNf
XywgYmxrMjU2X3dpZHRoKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBibGsyNTZfaGVpZ2h0
ICAgICAgPSAlZFxuIiwgX19mdW5jX18sIGJsazI1Nl9oZWlnaHQpOworCisJbG9nMl9ibGsyNTZf
d2lkdGggPSBkbWxfbG9nMigoZG91YmxlKSBibGsyNTZfd2lkdGgpOworCWxvZzJfYmxrMjU2X2hl
aWdodCA9IGRtbF9sb2cyKChkb3VibGUpIGJsazI1Nl9oZWlnaHQpOworCWJsa19ieXRlcyA9IHN1
cmZfbGluZWFyID8KKwkJCTI1NiA6IGdldF9ibGtfc2l6ZV9ieXRlcygoZW51bSBzb3VyY2VfbWFj
cm9fdGlsZV9zaXplKSBtYWNyb190aWxlX3NpemUpOworCWxvZzJfYmxrX2J5dGVzID0gZG1sX2xv
ZzIoKGRvdWJsZSkgYmxrX2J5dGVzKTsKKwlsb2cyX2Jsa19oZWlnaHQgPSAwOworCWxvZzJfYmxr
X3dpZHRoID0gMDsKKworCS8vIHJlbWVtYmVyIGxvZyBydWxlCisJLy8gIisiIGluIGxvZyBpcyBt
dWx0aXBseQorCS8vICItIiBpbiBsb2cgaXMgZGl2aWRlCisJLy8gIi8yIiBpcyBsaWtlIHNxdWFy
ZSByb290CisJLy8gYmxrIGlzIHZlcnRpY2FsIGJpYXNlZAorCWlmICh0aWxpbmcgIT0gZG1fc3df
bGluZWFyKQorCQlsb2cyX2Jsa19oZWlnaHQgPSBsb2cyX2JsazI1Nl9oZWlnaHQKKwkJCQkrIGRt
bF9jZWlsKChkb3VibGUpIChsb2cyX2Jsa19ieXRlcyAtIDgpIC8gMi4wLCAxKTsKKwllbHNlCisJ
CWxvZzJfYmxrX2hlaWdodCA9IDA7ICAvLyBibGsgaGVpZ2h0IG9mIDEKKworCWxvZzJfYmxrX3dp
ZHRoID0gbG9nMl9ibGtfYnl0ZXMgLSBsb2cyX2J5dGVzX3Blcl9lbGVtZW50IC0gbG9nMl9ibGtf
aGVpZ2h0OworCisJaWYgKCFzdXJmX3ZlcnQpIHsKKwkJcnFfZGxnX3BhcmFtLT5zd2F0aF93aWR0
aF91YiA9IGRtbF9yb3VuZF90b19tdWx0aXBsZSh2cF93aWR0aCAtIDEsIGJsazI1Nl93aWR0aCwg
MSkKKwkJCQkrIGJsazI1Nl93aWR0aDsKKwkJcnFfZGxnX3BhcmFtLT5yZXFfcGVyX3N3YXRoX3Vi
ID0gcnFfZGxnX3BhcmFtLT5zd2F0aF93aWR0aF91YiA+PiBsb2cyX2JsazI1Nl93aWR0aDsKKwl9
IGVsc2UgeworCQlycV9kbGdfcGFyYW0tPnN3YXRoX3dpZHRoX3ViID0gZG1sX3JvdW5kX3RvX211
bHRpcGxlKAorCQkJCXZwX2hlaWdodCAtIDEsCisJCQkJYmxrMjU2X2hlaWdodCwKKwkJCQkxKSAr
IGJsazI1Nl9oZWlnaHQ7CisJCXJxX2RsZ19wYXJhbS0+cmVxX3Blcl9zd2F0aF91YiA9IHJxX2Rs
Z19wYXJhbS0+c3dhdGhfd2lkdGhfdWIgPj4gbG9nMl9ibGsyNTZfaGVpZ2h0OworCX0KKworCWlm
ICghc3VyZl92ZXJ0KQorCQlycV9taXNjX3BhcmFtLT5mdWxsX3N3YXRoX2J5dGVzID0gcnFfZGxn
X3BhcmFtLT5zd2F0aF93aWR0aF91YiAqIGJsazI1Nl9oZWlnaHQKKwkJCQkqIGJ5dGVzX3Blcl9l
bGVtZW50OworCWVsc2UKKwkJcnFfbWlzY19wYXJhbS0+ZnVsbF9zd2F0aF9ieXRlcyA9IHJxX2Rs
Z19wYXJhbS0+c3dhdGhfd2lkdGhfdWIgKiBibGsyNTZfd2lkdGgKKwkJCQkqIGJ5dGVzX3Blcl9l
bGVtZW50OworCisJcnFfbWlzY19wYXJhbS0+YmxrMjU2X2hlaWdodCA9IGJsazI1Nl9oZWlnaHQ7
CisJcnFfbWlzY19wYXJhbS0+YmxrMjU2X3dpZHRoID0gYmxrMjU2X3dpZHRoOworCisJLy8gLS0t
LS0tLQorCS8vIG1ldGEKKwkvLyAtLS0tLS0tCisJbG9nMl9tZXRhX3JlcV9ieXRlcyA9IDY7IC8v
IG1ldGEgcmVxdWVzdCBpcyA2NGIgYW5kIGlzIDh4OGJ5dGUgbWV0YSBlbGVtZW50CisKKwkvLyBl
YWNoIDY0YiBtZXRhIHJlcXVlc3QgZm9yIGRjbiBpcyA4eDggbWV0YSBlbGVtZW50cyBhbmQKKwkv
LyBhIG1ldGEgZWxlbWVudCBjb3ZlcnMgb25lIDI1NmIgYmxvY2sgb2YgdGhlIHRoZSBkYXRhIHN1
cmZhY2UuCisJbG9nMl9tZXRhX3JlcV9oZWlnaHQgPSBsb2cyX2JsazI1Nl9oZWlnaHQgKyAzOyAv
LyBtZXRhIHJlcSBpcyA4eDggYnl0ZSwgZWFjaCBieXRlIHJlcHJlc2VudCAxIGJsazI1NgorCWxv
ZzJfbWV0YV9yZXFfd2lkdGggPSBsb2cyX21ldGFfcmVxX2J5dGVzICsgOCAtIGxvZzJfYnl0ZXNf
cGVyX2VsZW1lbnQKKwkJCS0gbG9nMl9tZXRhX3JlcV9oZWlnaHQ7CisJbWV0YV9yZXFfd2lkdGgg
PSAxIDw8IGxvZzJfbWV0YV9yZXFfd2lkdGg7CisJbWV0YV9yZXFfaGVpZ2h0ID0gMSA8PCBsb2cy
X21ldGFfcmVxX2hlaWdodDsKKwlsb2cyX21ldGFfcm93X2hlaWdodCA9IDA7CisJbWV0YV9yb3df
d2lkdGhfdWIgPSAwOworCisJLy8gdGhlIGRpbWVuc2lvbnMgb2YgYSBtZXRhIHJvdyBhcmUgbWV0
YV9yb3dfd2lkdGggeCBtZXRhX3Jvd19oZWlnaHQgaW4gZWxlbWVudHMuCisJLy8gY2FsY3VsYXRl
IHVwcGVyIGJvdW5kIG9mIHRoZSBtZXRhX3Jvd193aWR0aAorCWlmICghc3VyZl92ZXJ0KSB7CisJ
CWxvZzJfbWV0YV9yb3dfaGVpZ2h0ID0gbG9nMl9tZXRhX3JlcV9oZWlnaHQ7CisJCW1ldGFfcm93
X3dpZHRoX3ViID0gZG1sX3JvdW5kX3RvX211bHRpcGxlKHZwX3dpZHRoIC0gMSwgbWV0YV9yZXFf
d2lkdGgsIDEpCisJCQkJKyBtZXRhX3JlcV93aWR0aDsKKwkJcnFfZGxnX3BhcmFtLT5tZXRhX3Jl
cV9wZXJfcm93X3ViID0gbWV0YV9yb3dfd2lkdGhfdWIgLyBtZXRhX3JlcV93aWR0aDsKKwl9IGVs
c2UgeworCQlsb2cyX21ldGFfcm93X2hlaWdodCA9IGxvZzJfbWV0YV9yZXFfd2lkdGg7CisJCW1l
dGFfcm93X3dpZHRoX3ViID0gZG1sX3JvdW5kX3RvX211bHRpcGxlKHZwX2hlaWdodCAtIDEsIG1l
dGFfcmVxX2hlaWdodCwgMSkKKwkJCQkrIG1ldGFfcmVxX2hlaWdodDsKKwkJcnFfZGxnX3BhcmFt
LT5tZXRhX3JlcV9wZXJfcm93X3ViID0gbWV0YV9yb3dfd2lkdGhfdWIgLyBtZXRhX3JlcV9oZWln
aHQ7CisJfQorCXJxX2RsZ19wYXJhbS0+bWV0YV9ieXRlc19wZXJfcm93X3ViID0gcnFfZGxnX3Bh
cmFtLT5tZXRhX3JlcV9wZXJfcm93X3ViICogNjQ7CisKKwlycV9kbGdfcGFyYW0tPm1ldGFfcm93
X2hlaWdodCA9IDEgPDwgbG9nMl9tZXRhX3Jvd19oZWlnaHQ7CisKKwlsb2cyX21ldGFfY2h1bmtf
Ynl0ZXMgPSBkbWxfbG9nMihycV9zaXppbmdfcGFyYW0tPm1ldGFfY2h1bmtfYnl0ZXMpOworCWxv
ZzJfbWV0YV9jaHVua19oZWlnaHQgPSBsb2cyX21ldGFfcm93X2hlaWdodDsKKworCS8vZnVsbCBz
aXplZCBtZXRhIGNodW5rIHdpZHRoIGluIHVuaXQgb2YgZGF0YSBlbGVtZW50cworCWxvZzJfbWV0
YV9jaHVua193aWR0aCA9IGxvZzJfbWV0YV9jaHVua19ieXRlcyArIDggLSBsb2cyX2J5dGVzX3Bl
cl9lbGVtZW50CisJCQktIGxvZzJfbWV0YV9jaHVua19oZWlnaHQ7CisJbG9nMl9taW5fbWV0YV9j
aHVua19ieXRlcyA9IGRtbF9sb2cyKHJxX3NpemluZ19wYXJhbS0+bWluX21ldGFfY2h1bmtfYnl0
ZXMpOworCW1pbl9tZXRhX2NodW5rX3dpZHRoID0gMQorCQkJPDwgKGxvZzJfbWluX21ldGFfY2h1
bmtfYnl0ZXMgKyA4IC0gbG9nMl9ieXRlc19wZXJfZWxlbWVudAorCQkJCQktIGxvZzJfbWV0YV9j
aHVua19oZWlnaHQpOworCW1ldGFfY2h1bmtfd2lkdGggPSAxIDw8IGxvZzJfbWV0YV9jaHVua193
aWR0aDsKKwltZXRhX2NodW5rX3Blcl9yb3dfaW50ID0gKHVuc2lnbmVkIGludCkgKG1ldGFfcm93
X3dpZHRoX3ViIC8gbWV0YV9jaHVua193aWR0aCk7CisJbWV0YV9yb3dfcmVtYWluZGVyID0gbWV0
YV9yb3dfd2lkdGhfdWIgJSBtZXRhX2NodW5rX3dpZHRoOworCW1ldGFfY2h1bmtfdGhyZXNob2xk
ID0gMDsKKwltZXRhX2Jsa19ieXRlcyA9IDQwOTY7CisJbWV0YV9ibGtfaGVpZ2h0ID0gYmxrMjU2
X2hlaWdodCAqIDY0OworCW1ldGFfYmxrX3dpZHRoID0gbWV0YV9ibGtfYnl0ZXMgKiAyNTYgLyBi
eXRlc19wZXJfZWxlbWVudCAvIG1ldGFfYmxrX2hlaWdodDsKKwltZXRhX3N1cmZhY2VfYnl0ZXMg
PSBtZXRhX3BpdGNoCisJCQkqIChkbWxfcm91bmRfdG9fbXVsdGlwbGUodnBfaGVpZ2h0IC0gMSwg
bWV0YV9ibGtfaGVpZ2h0LCAxKQorCQkJCQkrIG1ldGFfYmxrX2hlaWdodCkgKiBieXRlc19wZXJf
ZWxlbWVudCAvIDI1NjsKKwl2bXBnX2J5dGVzID0gbW9kZV9saWItPnNvYy52bW1fcGFnZV9zaXpl
X2J5dGVzOworCW1ldGFfcHRlX3JlcV9wZXJfZnJhbWVfdWIgPSAoZG1sX3JvdW5kX3RvX211bHRp
cGxlKAorCQkJbWV0YV9zdXJmYWNlX2J5dGVzIC0gdm1wZ19ieXRlcywKKwkJCTggKiB2bXBnX2J5
dGVzLAorCQkJMSkgKyA4ICogdm1wZ19ieXRlcykgLyAoOCAqIHZtcGdfYnl0ZXMpOworCW1ldGFf
cHRlX2J5dGVzX3Blcl9mcmFtZV91YiA9IG1ldGFfcHRlX3JlcV9wZXJfZnJhbWVfdWIgKiA2NDsg
Ly82NEIgbXB0ZSByZXF1ZXN0CisJcnFfZGxnX3BhcmFtLT5tZXRhX3B0ZV9ieXRlc19wZXJfZnJh
bWVfdWIgPSBtZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWI7CisKKwlkbWxfcHJpbnQoIkRNTF9E
TEc6ICVzOiBtZXRhX2Jsa19oZWlnaHQgICAgICAgICAgICAgPSAlZFxuIiwgX19mdW5jX18sIG1l
dGFfYmxrX2hlaWdodCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogbWV0YV9ibGtfd2lkdGgg
ICAgICAgICAgICAgID0gJWRcbiIsIF9fZnVuY19fLCBtZXRhX2Jsa193aWR0aCk7CisJZG1sX3By
aW50KCJETUxfRExHOiAlczogbWV0YV9zdXJmYWNlX2J5dGVzICAgICAgICAgID0gJWRcbiIsIF9f
ZnVuY19fLCBtZXRhX3N1cmZhY2VfYnl0ZXMpOworCWRtbF9wcmludCgKKwkJCSJETUxfRExHOiAl
czogbWV0YV9wdGVfcmVxX3Blcl9mcmFtZV91YiAgID0gJWRcbiIsCisJCQlfX2Z1bmNfXywKKwkJ
CW1ldGFfcHRlX3JlcV9wZXJfZnJhbWVfdWIpOworCWRtbF9wcmludCgKKwkJCSJETUxfRExHOiAl
czogbWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1lX3ViID0gJWRcbiIsCisJCQlfX2Z1bmNfXywKKwkJ
CW1ldGFfcHRlX2J5dGVzX3Blcl9mcmFtZV91Yik7CisKKwlpZiAoIXN1cmZfdmVydCkKKwkJbWV0
YV9jaHVua190aHJlc2hvbGQgPSAyICogbWluX21ldGFfY2h1bmtfd2lkdGggLSBtZXRhX3JlcV93
aWR0aDsKKwllbHNlCisJCW1ldGFfY2h1bmtfdGhyZXNob2xkID0gMiAqIG1pbl9tZXRhX2NodW5r
X3dpZHRoIC0gbWV0YV9yZXFfaGVpZ2h0OworCisJaWYgKG1ldGFfcm93X3JlbWFpbmRlciA8PSBt
ZXRhX2NodW5rX3RocmVzaG9sZCkKKwkJcnFfZGxnX3BhcmFtLT5tZXRhX2NodW5rc19wZXJfcm93
X3ViID0gbWV0YV9jaHVua19wZXJfcm93X2ludCArIDE7CisJZWxzZQorCQlycV9kbGdfcGFyYW0t
Pm1ldGFfY2h1bmtzX3Blcl9yb3dfdWIgPSBtZXRhX2NodW5rX3Blcl9yb3dfaW50ICsgMjsKKwor
CS8vIC0tLS0tLQorCS8vIGRwdGUKKwkvLyAtLS0tLS0KKwlpZiAoc3VyZl9saW5lYXIpIHsKKwkJ
bG9nMl92bXBnX2hlaWdodCA9IDA7ICAgLy8gb25lIGxpbmUgaGlnaAorCX0gZWxzZSB7CisJCWxv
ZzJfdm1wZ19oZWlnaHQgPSAobG9nMl92bXBnX2J5dGVzIC0gOCkgLyAyICsgbG9nMl9ibGsyNTZf
aGVpZ2h0OworCX0KKwlsb2cyX3ZtcGdfd2lkdGggPSBsb2cyX3ZtcGdfYnl0ZXMgLSBsb2cyX2J5
dGVzX3Blcl9lbGVtZW50IC0gbG9nMl92bXBnX2hlaWdodDsKKworCS8vIG9ubHkgMyBwb3NzaWJs
ZSBzaGFwZXMgZm9yIGRwdGUgcmVxdWVzdCBpbiBkaW1lbnNpb25zIG9mIHB0ZXM6IDh4MSwgNHgy
LCAyeDQuCisJaWYgKHN1cmZfbGluZWFyKSB7IC8vb25lIDY0QiBQVEUgcmVxdWVzdCByZXR1cm5z
IDggUFRFcworCQlsb2cyX2RwdGVfcmVxX2hlaWdodF9wdGVzID0gMDsKKwkJbG9nMl9kcHRlX3Jl
cV93aWR0aCA9IGxvZzJfdm1wZ193aWR0aCArIDM7CisJCWxvZzJfZHB0ZV9yZXFfaGVpZ2h0ID0g
MDsKKwl9IGVsc2UgaWYgKGxvZzJfYmxrX2J5dGVzID09IDEyKSB7IC8vNEtCIHRpbGUgbWVhbnMg
NGtCIHBhZ2Ugc2l6ZQorCQkJCQkgICAvL29uZSA2NEIgcmVxIGdpdmVzIDh4MSBQVEVzIGZvciA0
S0IgdGlsZQorCQlsb2cyX2RwdGVfcmVxX2hlaWdodF9wdGVzID0gMDsKKwkJbG9nMl9kcHRlX3Jl
cV93aWR0aCA9IGxvZzJfYmxrX3dpZHRoICsgMzsKKwkJbG9nMl9kcHRlX3JlcV9oZWlnaHQgPSBs
b2cyX2Jsa19oZWlnaHQgKyAwOworCX0gZWxzZSBpZiAoKGxvZzJfYmxrX2J5dGVzID49IDE2KSAm
JiAobG9nMl92bXBnX2J5dGVzID09IDEyKSkgeyAvLyB0aWxlIGJsb2NrID49IDY0S0IKKwkJCQkJ
CQkJCS8vdHdvIDY0QiByZXFzIG9mIDJ4NCBQVEVzIGdpdmUgMTYgUFRFcyB0byBjb3ZlciA2NEtC
CisJCWxvZzJfZHB0ZV9yZXFfaGVpZ2h0X3B0ZXMgPSA0OworCQlsb2cyX2RwdGVfcmVxX3dpZHRo
ID0gbG9nMl9ibGsyNTZfd2lkdGggKyA0OyAvLyBsb2cyXzY0S0Jfd2lkdGgKKwkJbG9nMl9kcHRl
X3JlcV9oZWlnaHQgPSBsb2cyX2JsazI1Nl9oZWlnaHQgKyA0OyAvLyBsb2cyXzY0S0JfaGVpZ2h0
CisJfSBlbHNlIHsgLy82NEtCIHBhZ2Ugc2l6ZSBhbmQgbXVzdCA2NEtCIHRpbGUgYmxvY2sKKwkJ
IC8vb25lIDY0QiByZXEgZ2l2ZXMgOHgxIFBURXMgZm9yIDY0S0IgdGlsZQorCQlsb2cyX2RwdGVf
cmVxX2hlaWdodF9wdGVzID0gMDsKKwkJbG9nMl9kcHRlX3JlcV93aWR0aCA9IGxvZzJfYmxrX3dp
ZHRoICsgMzsKKwkJbG9nMl9kcHRlX3JlcV9oZWlnaHQgPSBsb2cyX2Jsa19oZWlnaHQgKyAwOwor
CX0KKworCS8vIFRoZSBkcHRlIHJlcXVlc3QgZGltZW5zaW9ucyBpbiBkYXRhIGVsZW1lbnRzIGlz
IGRwdGVfcmVxX3dpZHRoIHggZHB0ZV9yZXFfaGVpZ2h0CisJLy8gbG9nMl92bXBnX3dpZHRoIGlz
IGhvdyBtdWNoIDEgcHRlIHJlcHJlc2VudCwgbm93IGNhbGN1bGF0aW5nIGhvdyBtdWNoIGEgNjRi
IHB0ZSByZXEgcmVwcmVzZW50CisJLy8gVGhhdCBkZXBlbmRzIG9uIHRoZSBwdGUgc2hhcGUgKGku
ZS4gOHgxLCA0eDIsIDJ4NCkKKwkvL2xvZzJfZHB0ZV9yZXFfaGVpZ2h0ICAgID0gbG9nMl92bXBn
X2hlaWdodCArIGxvZzJfZHB0ZV9yZXFfaGVpZ2h0X3B0ZXM7CisJLy9sb2cyX2RwdGVfcmVxX3dp
ZHRoICAgICA9IGxvZzJfdm1wZ193aWR0aCArIGxvZzJfZHB0ZV9yZXFfd2lkdGhfcHRlczsKKwlk
cHRlX3JlcV9oZWlnaHQgPSAxIDw8IGxvZzJfZHB0ZV9yZXFfaGVpZ2h0OworCWRwdGVfcmVxX3dp
ZHRoID0gMSA8PCBsb2cyX2RwdGVfcmVxX3dpZHRoOworCisJLy8gY2FsY3VsYXRlIHBpdGNoIGRw
dGUgcm93IGJ1ZmZlciBjYW4gaG9sZAorCS8vIHJvdW5kIHRoZSByZXN1bHQgZG93biB0byBhIHBv
d2VyIG9mIHR3by4KKwlwZGVfYnVmX2VudHJpZXMgPQorCQkJeXV2NDIwID8gKHBkZV9wcm9jX2J1
ZmZlcl9zaXplXzY0a19yZXFzID4+IDEpIDogcGRlX3Byb2NfYnVmZmVyX3NpemVfNjRrX3JlcXM7
CisJaWYgKHN1cmZfbGluZWFyKSB7CisJCXVuc2lnbmVkIGludCBkcHRlX3Jvd19oZWlnaHQ7CisK
KwkJbG9nMl9kcHRlX3Jvd19oZWlnaHRfbGluZWFyID0gZG1sX2Zsb29yKAorCQkJCWRtbF9sb2cy
KAorCQkJCQkJZG1sX21pbigKKwkJCQkJCQkJNjQgKiAxMDI0ICogcGRlX2J1Zl9lbnRyaWVzCisJ
CQkJCQkJCQkJLyBieXRlc19wZXJfZWxlbWVudCwKKwkJCQkJCQkJZHB0ZV9idWZfaW5fcHRlX3Jl
cXMKKwkJCQkJCQkJCQkqIGRwdGVfcmVxX3dpZHRoKQorCQkJCQkJCQkvIGRhdGFfcGl0Y2gpLAor
CQkJCTEpOworCisJCUFTU0VSVChsb2cyX2RwdGVfcm93X2hlaWdodF9saW5lYXIgPj0gMyk7CisK
KwkJaWYgKGxvZzJfZHB0ZV9yb3dfaGVpZ2h0X2xpbmVhciA+IDcpCisJCQlsb2cyX2RwdGVfcm93
X2hlaWdodF9saW5lYXIgPSA3OworCisJCWxvZzJfZHB0ZV9yb3dfaGVpZ2h0ID0gbG9nMl9kcHRl
X3Jvd19oZWlnaHRfbGluZWFyOworCQkvLyBGb3IgbGluZWFyLCB0aGUgZHB0ZSByb3cgaXMgcGl0
Y2ggZGVwZW5kZW50IGFuZCB0aGUgcHRlIHJlcXVlc3RzIHdyYXAgYXQgdGhlIHBpdGNoIGJvdW5k
YXJ5LgorCQkvLyB0aGUgZHB0ZV9yb3dfd2lkdGhfdWIgaXMgdGhlIHVwcGVyIGJvdW5kIG9mIGRh
dGFfcGl0Y2gqZHB0ZV9yb3dfaGVpZ2h0IGluIGVsZW1lbnRzIHdpdGggdGhpcyB1bmlxdWUgYnVm
ZmVyaW5nLgorCQlkcHRlX3Jvd19oZWlnaHQgPSAxIDw8IGxvZzJfZHB0ZV9yb3dfaGVpZ2h0Owor
CQlkcHRlX3Jvd193aWR0aF91YiA9IGRtbF9yb3VuZF90b19tdWx0aXBsZSgKKwkJCQlkYXRhX3Bp
dGNoICogZHB0ZV9yb3dfaGVpZ2h0IC0gMSwKKwkJCQlkcHRlX3JlcV93aWR0aCwKKwkJCQkxKSAr
IGRwdGVfcmVxX3dpZHRoOworCQlycV9kbGdfcGFyYW0tPmRwdGVfcmVxX3Blcl9yb3dfdWIgPSBk
cHRlX3Jvd193aWR0aF91YiAvIGRwdGVfcmVxX3dpZHRoOworCX0gZWxzZSB7CisJCS8vIHRoZSB1
cHBlciBib3VuZCBvZiB0aGUgZHB0ZV9yb3dfd2lkdGggd2l0aG91dCBkZXBlbmRlbmN5IG9uIHZp
ZXdwb3J0IHBvc2l0aW9uIGZvbGxvd3MuCisJCS8vIGZvciB0aWxlZCBtb2RlLCByb3cgaGVpZ2h0
IGlzIHRoZSBzYW1lIGFzIHJlcSBoZWlnaHQgYW5kIHJvdyBzdG9yZSB1cCB0byB2cCBzaXplIHVw
cGVyIGJvdW5kCisJCWlmICghc3VyZl92ZXJ0KSB7CisJCQlsb2cyX2RwdGVfcm93X2hlaWdodCA9
IGxvZzJfZHB0ZV9yZXFfaGVpZ2h0OworCQkJZHB0ZV9yb3dfd2lkdGhfdWIgPSBkbWxfcm91bmRf
dG9fbXVsdGlwbGUodnBfd2lkdGggLSAxLCBkcHRlX3JlcV93aWR0aCwgMSkKKwkJCQkJKyBkcHRl
X3JlcV93aWR0aDsKKwkJCXJxX2RsZ19wYXJhbS0+ZHB0ZV9yZXFfcGVyX3Jvd191YiA9IGRwdGVf
cm93X3dpZHRoX3ViIC8gZHB0ZV9yZXFfd2lkdGg7CisJCX0gZWxzZSB7CisJCQlsb2cyX2RwdGVf
cm93X2hlaWdodCA9CisJCQkJCShsb2cyX2Jsa193aWR0aCA8IGxvZzJfZHB0ZV9yZXFfd2lkdGgp
ID8KKwkJCQkJCQlsb2cyX2Jsa193aWR0aCA6IGxvZzJfZHB0ZV9yZXFfd2lkdGg7CisJCQlkcHRl
X3Jvd193aWR0aF91YiA9IGRtbF9yb3VuZF90b19tdWx0aXBsZSh2cF9oZWlnaHQgLSAxLCBkcHRl
X3JlcV9oZWlnaHQsIDEpCisJCQkJCSsgZHB0ZV9yZXFfaGVpZ2h0OworCQkJcnFfZGxnX3BhcmFt
LT5kcHRlX3JlcV9wZXJfcm93X3ViID0gZHB0ZV9yb3dfd2lkdGhfdWIgLyBkcHRlX3JlcV9oZWln
aHQ7CisJCX0KKwl9CisJaWYgKGxvZzJfYmxrX2J5dGVzID49IDE2ICYmIGxvZzJfdm1wZ19ieXRl
cyA9PSAxMikgLy8gdGlsZSBibG9jayA+PSA2NEtCCisJCXJxX2RsZ19wYXJhbS0+ZHB0ZV9ieXRl
c19wZXJfcm93X3ViID0gcnFfZGxnX3BhcmFtLT5kcHRlX3JlcV9wZXJfcm93X3ViICogMTI4OyAv
LzIqNjRCIGRwdGUgcmVxdWVzdAorCWVsc2UKKwkJcnFfZGxnX3BhcmFtLT5kcHRlX2J5dGVzX3Bl
cl9yb3dfdWIgPSBycV9kbGdfcGFyYW0tPmRwdGVfcmVxX3Blcl9yb3dfdWIgKiA2NDsgLy82NEIg
ZHB0ZSByZXF1ZXN0CisKKwlycV9kbGdfcGFyYW0tPmRwdGVfcm93X2hlaWdodCA9IDEgPDwgbG9n
Ml9kcHRlX3Jvd19oZWlnaHQ7CisKKwkvLyB0aGUgZHB0ZV9ncm91cF9ieXRlcyBpcyByZWR1Y2Vk
IGZvciB0aGUgc3BlY2lmaWMgY2FzZSBvZiB2ZXJ0aWNhbAorCS8vIGFjY2VzcyBvZiBhIHRpbGUg
c3VyZmFjZSB0aGF0IGhhcyBkcHRlIHJlcXVlc3Qgb2YgOHgxIHB0ZXMuCisKKwlpZiAoaG9zdHZt
X2VuYWJsZSkKKwkJcnFfc2l6aW5nX3BhcmFtLT5kcHRlX2dyb3VwX2J5dGVzID0gNTEyOworCWVs
c2UgeworCQlpZiAoIXN1cmZfbGluZWFyICYgKGxvZzJfZHB0ZV9yZXFfaGVpZ2h0X3B0ZXMgPT0g
MCkgJiBzdXJmX3ZlcnQpIC8vcmVkdWNlZCwgaW4gdGhpcyBjYXNlLCB3aWxsIGhhdmUgcGFnZSBm
YXVsdCB3aXRoaW4gYSBncm91cAorCQkJcnFfc2l6aW5nX3BhcmFtLT5kcHRlX2dyb3VwX2J5dGVz
ID0gNTEyOworCQllbHNlCisJCQkvL2Z1bGwgc2l6ZQorCQkJcnFfc2l6aW5nX3BhcmFtLT5kcHRl
X2dyb3VwX2J5dGVzID0gMjA0ODsKKwl9CisKKwkvL3NpbmNlIHB0ZSByZXF1ZXN0IHNpemUgaXMg
NjRieXRlLCB0aGUgbnVtYmVyIG9mIGRhdGEgcHRlIHJlcXVlc3RzIHBlciBmdWxsIHNpemVkIGdy
b3VwIGlzIGFzIGZvbGxvd3MuCisJbG9nMl9kcHRlX2dyb3VwX2J5dGVzID0gZG1sX2xvZzIocnFf
c2l6aW5nX3BhcmFtLT5kcHRlX2dyb3VwX2J5dGVzKTsKKwlsb2cyX2RwdGVfZ3JvdXBfbGVuZ3Ro
ID0gbG9nMl9kcHRlX2dyb3VwX2J5dGVzIC0gNjsgLy9sZW5ndGggaW4gNjRiIHJlcXVlc3RzCisK
KwkvLyBmdWxsIHNpemVkIGRhdGEgcHRlIGdyb3VwIHdpZHRoIGluIGVsZW1lbnRzCisJaWYgKCFz
dXJmX3ZlcnQpCisJCWxvZzJfZHB0ZV9ncm91cF93aWR0aCA9IGxvZzJfZHB0ZV9ncm91cF9sZW5n
dGggKyBsb2cyX2RwdGVfcmVxX3dpZHRoOworCWVsc2UKKwkJbG9nMl9kcHRlX2dyb3VwX3dpZHRo
ID0gbG9nMl9kcHRlX2dyb3VwX2xlbmd0aCArIGxvZzJfZHB0ZV9yZXFfaGVpZ2h0OworCisJLy9C
dXQgaWYgdGhlIHRpbGUgYmxvY2sgPj02NEtCIGFuZCB0aGUgcGFnZSBzaXplIGlzIDRLQiwgdGhl
biBlYWNoIGRQVEUgcmVxdWVzdCBpcyAyKjY0QgorCWlmICgobG9nMl9ibGtfYnl0ZXMgPj0gMTYp
ICYmIChsb2cyX3ZtcGdfYnl0ZXMgPT0gMTIpKSAvLyB0aWxlIGJsb2NrID49IDY0S0IKKwkJbG9n
Ml9kcHRlX2dyb3VwX3dpZHRoID0gbG9nMl9kcHRlX2dyb3VwX3dpZHRoIC0gMTsKKworCWRwdGVf
Z3JvdXBfd2lkdGggPSAxIDw8IGxvZzJfZHB0ZV9ncm91cF93aWR0aDsKKworCS8vIHNpbmNlIGRw
dGUgZ3JvdXBzIGFyZSBvbmx5IGFsaWduZWQgdG8gZHB0ZV9yZXFfd2lkdGggYW5kIG5vdCBkcHRl
X2dyb3VwX3dpZHRoLAorCS8vIHRoZSB1cHBlciBib3VuZCBmb3IgdGhlIGRwdGUgZ3JvdXBzIHBl
ciByb3cgaXMgYXMgZm9sbG93cy4KKwlycV9kbGdfcGFyYW0tPmRwdGVfZ3JvdXBzX3Blcl9yb3df
dWIgPSBkbWxfY2VpbCgKKwkJCShkb3VibGUpIGRwdGVfcm93X3dpZHRoX3ViIC8gZHB0ZV9ncm91
cF93aWR0aCwKKwkJCTEpOworfQorCitzdGF0aWMgdm9pZCBnZXRfc3VyZl9ycV9wYXJhbSgKKwkJ
c3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkaXNwbGF5X2RhdGFfcnFfc2l6
aW5nX3BhcmFtc19zdCAqcnFfc2l6aW5nX3BhcmFtLAorCQlkaXNwbGF5X2RhdGFfcnFfZGxnX3Bh
cmFtc19zdCAqcnFfZGxnX3BhcmFtLAorCQlkaXNwbGF5X2RhdGFfcnFfbWlzY19wYXJhbXNfc3Qg
KnJxX21pc2NfcGFyYW0sCisJCWNvbnN0IGRpc3BsYXlfcGlwZV9wYXJhbXNfc3QgcGlwZV9wYXJh
bSwKKwkJYm9vbCBpc19jaHJvbWEpCit7CisJYm9vbCBtb2RlXzQyMiA9IDA7CisJdW5zaWduZWQg
aW50IHZwX3dpZHRoID0gMDsKKwl1bnNpZ25lZCBpbnQgdnBfaGVpZ2h0ID0gMDsKKwl1bnNpZ25l
ZCBpbnQgZGF0YV9waXRjaCA9IDA7CisJdW5zaWduZWQgaW50IG1ldGFfcGl0Y2ggPSAwOworCXVu
c2lnbmVkIGludCBwcGUgPSBtb2RlXzQyMiA/IDIgOiAxOworCisJLy8gRklYTUUgY2hlY2sgaWYg
cHBlIGFwcGx5IGZvciBib3RoIGx1bWEgYW5kIGNocm9tYSBpbiA0MjIgY2FzZQorCWlmIChpc19j
aHJvbWEpIHsKKwkJdnBfd2lkdGggPSBwaXBlX3BhcmFtLnNyYy52aWV3cG9ydF93aWR0aF9jIC8g
cHBlOworCQl2cF9oZWlnaHQgPSBwaXBlX3BhcmFtLnNyYy52aWV3cG9ydF9oZWlnaHRfYzsKKwkJ
ZGF0YV9waXRjaCA9IHBpcGVfcGFyYW0uc3JjLmRhdGFfcGl0Y2hfYzsKKwkJbWV0YV9waXRjaCA9
IHBpcGVfcGFyYW0uc3JjLm1ldGFfcGl0Y2hfYzsKKwl9IGVsc2UgeworCQl2cF93aWR0aCA9IHBp
cGVfcGFyYW0uc3JjLnZpZXdwb3J0X3dpZHRoIC8gcHBlOworCQl2cF9oZWlnaHQgPSBwaXBlX3Bh
cmFtLnNyYy52aWV3cG9ydF9oZWlnaHQ7CisJCWRhdGFfcGl0Y2ggPSBwaXBlX3BhcmFtLnNyYy5k
YXRhX3BpdGNoOworCQltZXRhX3BpdGNoID0gcGlwZV9wYXJhbS5zcmMubWV0YV9waXRjaDsKKwl9
CisKKwlpZiAocGlwZV9wYXJhbS5kZXN0Lm9kbV9jb21iaW5lKSB7CisJCXVuc2lnbmVkIGludCBh
Y2Nlc3NfZGlyOworCQl1bnNpZ25lZCBpbnQgZnVsbF9zcmNfdnBfd2lkdGg7CisJCXVuc2lnbmVk
IGludCBoYWN0aXZlX2hhbGY7CisJCXVuc2lnbmVkIGludCBzcmNfaGFjdGl2ZV9oYWxmOworCQlh
Y2Nlc3NfZGlyID0gKHBpcGVfcGFyYW0uc3JjLnNvdXJjZV9zY2FuID09IGRtX3ZlcnQpOyAvLyB2
cCBhY2Nlc3MgZGlyZWN0aW9uOiBob3Jpem9udGFsIG9yIHZlcnRpY2FsIGFjY2Vzc2VkCisJCWhh
Y3RpdmVfaGFsZiAgPSBwaXBlX3BhcmFtLmRlc3QuaGFjdGl2ZSAvIDI7CisJCWlmIChpc19jaHJv
bWEpIHsKKwkJCWZ1bGxfc3JjX3ZwX3dpZHRoID0gcGlwZV9wYXJhbS5zY2FsZV9yYXRpb19kZXB0
aC5oc2NsX3JhdGlvX2MgKiBwaXBlX3BhcmFtLmRlc3QuZnVsbF9yZWNvdXRfd2lkdGg7CisJCQlz
cmNfaGFjdGl2ZV9oYWxmICA9IHBpcGVfcGFyYW0uc2NhbGVfcmF0aW9fZGVwdGguaHNjbF9yYXRp
b19jICogaGFjdGl2ZV9oYWxmOworCQl9IGVsc2UgeworCQkJZnVsbF9zcmNfdnBfd2lkdGggPSBw
aXBlX3BhcmFtLnNjYWxlX3JhdGlvX2RlcHRoLmhzY2xfcmF0aW8gKiBwaXBlX3BhcmFtLmRlc3Qu
ZnVsbF9yZWNvdXRfd2lkdGg7CisJCQlzcmNfaGFjdGl2ZV9oYWxmICA9IHBpcGVfcGFyYW0uc2Nh
bGVfcmF0aW9fZGVwdGguaHNjbF9yYXRpbyAqIGhhY3RpdmVfaGFsZjsKKwkJfQorCisJCWlmIChh
Y2Nlc3NfZGlyID09IDApIHsKKwkJCXZwX3dpZHRoID0gZG1sX21pbihmdWxsX3NyY192cF93aWR0
aCwgc3JjX2hhY3RpdmVfaGFsZik7CisJCQlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiB2cF93aWR0
aCA9ICVkXG4iLCBfX2Z1bmNfXywgdnBfd2lkdGgpOworCQl9IGVsc2UgeworCQkJdnBfaGVpZ2h0
ID0gZG1sX21pbihmdWxsX3NyY192cF93aWR0aCwgc3JjX2hhY3RpdmVfaGFsZik7CisJCQlkbWxf
cHJpbnQoIkRNTF9ETEc6ICVzOiB2cF9oZWlnaHQgPSAlZFxuIiwgX19mdW5jX18sIHZwX2hlaWdo
dCk7CisKKwkJfQorCQlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBmdWxsX3NyY192cF93aWR0aCA9
ICVkXG4iLCBfX2Z1bmNfXywgZnVsbF9zcmNfdnBfd2lkdGgpOworCQlkbWxfcHJpbnQoIkRNTF9E
TEc6ICVzOiBoYWN0aXZlX2hhbGYgPSAlZFxuIiwgX19mdW5jX18sIGhhY3RpdmVfaGFsZik7CisJ
CWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHNyY19oYWN0aXZlX2hhbGYgPSAlZFxuIiwgX19mdW5j
X18sIHNyY19oYWN0aXZlX2hhbGYpOworCX0KKwlycV9zaXppbmdfcGFyYW0tPmNodW5rX2J5dGVz
ID0gODE5MjsKKworCWlmIChycV9zaXppbmdfcGFyYW0tPmNodW5rX2J5dGVzID09IDY0ICogMTAy
NCkKKwkJcnFfc2l6aW5nX3BhcmFtLT5taW5fY2h1bmtfYnl0ZXMgPSAwOworCWVsc2UKKwkJcnFf
c2l6aW5nX3BhcmFtLT5taW5fY2h1bmtfYnl0ZXMgPSAxMDI0OworCisJcnFfc2l6aW5nX3BhcmFt
LT5tZXRhX2NodW5rX2J5dGVzID0gMjA0ODsKKwlycV9zaXppbmdfcGFyYW0tPm1pbl9tZXRhX2No
dW5rX2J5dGVzID0gMjU2OworCisJaWYgKHBpcGVfcGFyYW0uc3JjLmhvc3R2bSkKKwkJcnFfc2l6
aW5nX3BhcmFtLT5tcHRlX2dyb3VwX2J5dGVzID0gNTEyOworCWVsc2UKKwkJcnFfc2l6aW5nX3Bh
cmFtLT5tcHRlX2dyb3VwX2J5dGVzID0gMjA0ODsKKworCWdldF9tZXRhX2FuZF9wdGVfYXR0cigK
KwkJCW1vZGVfbGliLAorCQkJcnFfZGxnX3BhcmFtLAorCQkJcnFfbWlzY19wYXJhbSwKKwkJCXJx
X3NpemluZ19wYXJhbSwKKwkJCXZwX3dpZHRoLAorCQkJdnBfaGVpZ2h0LAorCQkJZGF0YV9waXRj
aCwKKwkJCW1ldGFfcGl0Y2gsCisJCQlwaXBlX3BhcmFtLnNyYy5zb3VyY2VfZm9ybWF0LAorCQkJ
cGlwZV9wYXJhbS5zcmMuc3dfbW9kZSwKKwkJCXBpcGVfcGFyYW0uc3JjLm1hY3JvX3RpbGVfc2l6
ZSwKKwkJCXBpcGVfcGFyYW0uc3JjLnNvdXJjZV9zY2FuLAorCQkJcGlwZV9wYXJhbS5zcmMuaG9z
dHZtLAorCQkJaXNfY2hyb21hKTsKK30KKworc3RhdGljIHZvaWQgZG1sX3JxX2RsZ19nZXRfcnFf
cGFyYW1zKAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRpc3BsYXlf
cnFfcGFyYW1zX3N0ICpycV9wYXJhbSwKKwkJY29uc3QgZGlzcGxheV9waXBlX3BhcmFtc19zdCBw
aXBlX3BhcmFtKQoreworCS8vIGdldCBwYXJhbSBmb3IgbHVtYSBzdXJmYWNlCisJcnFfcGFyYW0t
Pnl1djQyMCA9IHBpcGVfcGFyYW0uc3JjLnNvdXJjZV9mb3JtYXQgPT0gZG1fNDIwXzgKKwkJCXx8
IHBpcGVfcGFyYW0uc3JjLnNvdXJjZV9mb3JtYXQgPT0gZG1fNDIwXzEwOworCXJxX3BhcmFtLT55
dXY0MjBfMTBicGMgPSBwaXBlX3BhcmFtLnNyYy5zb3VyY2VfZm9ybWF0ID09IGRtXzQyMF8xMDsK
KworCWdldF9zdXJmX3JxX3BhcmFtKAorCQkJbW9kZV9saWIsCisJCQkmKHJxX3BhcmFtLT5zaXpp
bmcucnFfbCksCisJCQkmKHJxX3BhcmFtLT5kbGcucnFfbCksCisJCQkmKHJxX3BhcmFtLT5taXNj
LnJxX2wpLAorCQkJcGlwZV9wYXJhbSwKKwkJCTApOworCisJaWYgKGlzX2R1YWxfcGxhbmUoKGVu
dW0gc291cmNlX2Zvcm1hdF9jbGFzcykgKHBpcGVfcGFyYW0uc3JjLnNvdXJjZV9mb3JtYXQpKSkg
eworCQkvLyBnZXQgcGFyYW0gZm9yIGNocm9tYSBzdXJmYWNlCisJCWdldF9zdXJmX3JxX3BhcmFt
KAorCQkJCW1vZGVfbGliLAorCQkJCSYocnFfcGFyYW0tPnNpemluZy5ycV9jKSwKKwkJCQkmKHJx
X3BhcmFtLT5kbGcucnFfYyksCisJCQkJJihycV9wYXJhbS0+bWlzYy5ycV9jKSwKKwkJCQlwaXBl
X3BhcmFtLAorCQkJCTEpOworCX0KKworCS8vIGNhbGN1bGF0ZSBob3cgdG8gc3BsaXQgdGhlIGRl
dCBidWZmZXIgc3BhY2UgYmV0d2VlbiBsdW1hIGFuZCBjaHJvbWEKKwloYW5kbGVfZGV0X2J1Zl9z
cGxpdChtb2RlX2xpYiwgcnFfcGFyYW0sIHBpcGVfcGFyYW0uc3JjKTsKKwlwcmludF9fcnFfcGFy
YW1zX3N0KG1vZGVfbGliLCAqcnFfcGFyYW0pOworfQorCit2b2lkIGRtbDIxX3JxX2RsZ19nZXRf
cnFfcmVnKAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRpc3BsYXlf
cnFfcmVnc19zdCAqcnFfcmVncywKKwkJY29uc3QgZGlzcGxheV9waXBlX3BhcmFtc19zdCBwaXBl
X3BhcmFtKQoreworCWRpc3BsYXlfcnFfcGFyYW1zX3N0IHJxX3BhcmFtID0gezB9OworCisJbWVt
c2V0KHJxX3JlZ3MsIDAsIHNpemVvZigqcnFfcmVncykpOworCWRtbF9ycV9kbGdfZ2V0X3JxX3Bh
cmFtcyhtb2RlX2xpYiwgJnJxX3BhcmFtLCBwaXBlX3BhcmFtKTsKKwlleHRyYWN0X3JxX3JlZ3Mo
bW9kZV9saWIsIHJxX3JlZ3MsIHJxX3BhcmFtKTsKKworCXByaW50X19ycV9yZWdzX3N0KG1vZGVf
bGliLCAqcnFfcmVncyk7Cit9CisKKy8vIE5vdGU6IGN1cnJlbnRseSB0YWtlbiBpbiBhcyBpcy4K
Ky8vIE5pY2UgdG8gZGVjb3VwbGUgY29kZSBmcm9tIGh3IHJlZ2lzdGVyIGltcGxlbWVudCBhbmQg
ZXh0cmFjdCBjb2RlIHRoYXQgYXJlIHJlcGVhdGVkIGZvciBsdW1hIGFuZCBjaHJvbWEuCitzdGF0
aWMgdm9pZCBkbWxfcnFfZGxnX2dldF9kbGdfcGFyYW1zKAorCQlzdHJ1Y3QgZGlzcGxheV9tb2Rl
X2xpYiAqbW9kZV9saWIsCisJCWNvbnN0IGRpc3BsYXlfZTJlX3BpcGVfcGFyYW1zX3N0ICplMmVf
cGlwZV9wYXJhbSwKKwkJY29uc3QgdW5zaWduZWQgaW50IG51bV9waXBlcywKKwkJY29uc3QgdW5z
aWduZWQgaW50IHBpcGVfaWR4LAorCQlkaXNwbGF5X2RsZ19yZWdzX3N0ICpkaXNwX2RsZ19yZWdz
LAorCQlkaXNwbGF5X3R0dV9yZWdzX3N0ICpkaXNwX3R0dV9yZWdzLAorCQljb25zdCBkaXNwbGF5
X3JxX2RsZ19wYXJhbXNfc3QgcnFfZGxnX3BhcmFtLAorCQljb25zdCBkaXNwbGF5X2RsZ19zeXNf
cGFyYW1zX3N0IGRsZ19zeXNfcGFyYW0sCisJCWNvbnN0IGJvb2wgY3N0YXRlX2VuLAorCQljb25z
dCBib29sIHBzdGF0ZV9lbikKK3sKKwljb25zdCBkaXNwbGF5X3BpcGVfc291cmNlX3BhcmFtc19z
dCAqc3JjID0gJmUyZV9waXBlX3BhcmFtW3BpcGVfaWR4XS5waXBlLnNyYzsKKwljb25zdCBkaXNw
bGF5X3BpcGVfZGVzdF9wYXJhbXNfc3QgKmRzdCA9ICZlMmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0u
cGlwZS5kZXN0OworCWNvbnN0IGRpc3BsYXlfb3V0cHV0X3BhcmFtc19zdCAqZG91dCA9ICZlMmVf
cGlwZV9wYXJhbVtwaXBlX2lkeF0uZG91dDsKKwljb25zdCBkaXNwbGF5X2Nsb2Nrc19hbmRfY2Zn
X3N0ICpjbGtzID0gJmUyZV9waXBlX3BhcmFtW3BpcGVfaWR4XS5jbGtzX2NmZzsKKwljb25zdCBz
Y2FsZXJfcmF0aW9fZGVwdGhfc3QgKnNjbCA9ICZlMmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0ucGlw
ZS5zY2FsZV9yYXRpb19kZXB0aDsKKwljb25zdCBzY2FsZXJfdGFwc19zdCAqdGFwcyA9ICZlMmVf
cGlwZV9wYXJhbVtwaXBlX2lkeF0ucGlwZS5zY2FsZV90YXBzOworCisJLy8gLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQorCS8vIFNlY3Rpb24gMS4xNS4yLjE6IE9URyBkZXBlbmRlbnQgUGFyYW1z
CisJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCS8vIFRpbWluZworCXVuc2lnbmVkIGlu
dCBodG90YWwgPSBkc3QtPmh0b3RhbDsKKwkvLyAgICB1bnNpZ25lZCBpbnQgaGJsYW5rX3N0YXJ0
ID0gZHN0LmhibGFua19zdGFydDsgLy8gVE9ETzogUmVtb3ZlCisJdW5zaWduZWQgaW50IGhibGFu
a19lbmQgPSBkc3QtPmhibGFua19lbmQ7CisJdW5zaWduZWQgaW50IHZibGFua19zdGFydCA9IGRz
dC0+dmJsYW5rX3N0YXJ0OworCXVuc2lnbmVkIGludCB2YmxhbmtfZW5kID0gZHN0LT52Ymxhbmtf
ZW5kOworCXVuc2lnbmVkIGludCBtaW5fdmJsYW5rID0gbW9kZV9saWItPmlwLm1pbl92Ymxhbmtf
bGluZXM7CisKKwlkb3VibGUgZHBwY2xrX2ZyZXFfaW5fbWh6ID0gY2xrcy0+ZHBwY2xrX21oejsK
Kwlkb3VibGUgZGlzcGNsa19mcmVxX2luX21oeiA9IGNsa3MtPmRpc3BjbGtfbWh6OworCWRvdWJs
ZSByZWZjbGtfZnJlcV9pbl9taHogPSBjbGtzLT5yZWZjbGtfbWh6OworCWRvdWJsZSBwY2xrX2Zy
ZXFfaW5fbWh6ID0gZHN0LT5waXhlbF9yYXRlX21oejsKKwlib29sIGludGVybGFjZWQgPSBkc3Qt
PmludGVybGFjZWQ7CisKKwlkb3VibGUgcmVmX2ZyZXFfdG9fcGl4X2ZyZXEgPSByZWZjbGtfZnJl
cV9pbl9taHogLyBwY2xrX2ZyZXFfaW5fbWh6OworCisJZG91YmxlIG1pbl9kY2ZjbGtfbWh6Owor
CWRvdWJsZSB0X2NhbGNfdXM7CisJZG91YmxlIG1pbl90dHVfdmJsYW5rOworCisJZG91YmxlIG1p
bl9kc3RfeV90dHVfdmJsYW5rOworCXVuc2lnbmVkIGludCBkbGdfdmJsYW5rX3N0YXJ0OworCWJv
b2wgZHVhbF9wbGFuZTsKKwlib29sIG1vZGVfNDIyOworCXVuc2lnbmVkIGludCBhY2Nlc3NfZGly
OworCXVuc2lnbmVkIGludCB2cF9oZWlnaHRfbDsKKwl1bnNpZ25lZCBpbnQgdnBfd2lkdGhfbDsK
Kwl1bnNpZ25lZCBpbnQgdnBfaGVpZ2h0X2M7CisJdW5zaWduZWQgaW50IHZwX3dpZHRoX2M7CisK
KwkvLyBTY2FsaW5nCisJdW5zaWduZWQgaW50IGh0YXBzX2w7CisJdW5zaWduZWQgaW50IGh0YXBz
X2M7CisJZG91YmxlIGhyYXRpb19sOworCWRvdWJsZSBocmF0aW9fYzsKKwlkb3VibGUgdnJhdGlv
X2w7CisJZG91YmxlIHZyYXRpb19jOworCWJvb2wgc2NsX2VuYWJsZTsKKworCWRvdWJsZSBsaW5l
X3RpbWVfaW5fdXM7CisJLy8gICAgZG91YmxlIHZpbml0X2w7CisJLy8gICAgZG91YmxlIHZpbml0
X2M7CisJLy8gICAgZG91YmxlIHZpbml0X2JvdF9sOworCS8vICAgIGRvdWJsZSB2aW5pdF9ib3Rf
YzsKKworCS8vICAgIHVuc2lnbmVkIGludCBzd2F0aF9oZWlnaHRfbDsKKwl1bnNpZ25lZCBpbnQg
c3dhdGhfd2lkdGhfdWJfbDsKKwkvLyAgICB1bnNpZ25lZCBpbnQgZHB0ZV9ieXRlc19wZXJfcm93
X3ViX2w7CisJdW5zaWduZWQgaW50IGRwdGVfZ3JvdXBzX3Blcl9yb3dfdWJfbDsKKwkvLyAgICB1
bnNpZ25lZCBpbnQgbWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1lX3ViX2w7CisJLy8gICAgdW5zaWdu
ZWQgaW50IG1ldGFfYnl0ZXNfcGVyX3Jvd191Yl9sOworCisJLy8gICAgdW5zaWduZWQgaW50IHN3
YXRoX2hlaWdodF9jOworCXVuc2lnbmVkIGludCBzd2F0aF93aWR0aF91Yl9jOworCS8vICAgdW5z
aWduZWQgaW50IGRwdGVfYnl0ZXNfcGVyX3Jvd191Yl9jOworCXVuc2lnbmVkIGludCBkcHRlX2dy
b3Vwc19wZXJfcm93X3ViX2M7CisKKwl1bnNpZ25lZCBpbnQgbWV0YV9jaHVua3NfcGVyX3Jvd191
Yl9sOworCXVuc2lnbmVkIGludCBtZXRhX2NodW5rc19wZXJfcm93X3ViX2M7CisJdW5zaWduZWQg
aW50IHZ1cGRhdGVfb2Zmc2V0OworCXVuc2lnbmVkIGludCB2dXBkYXRlX3dpZHRoOworCXVuc2ln
bmVkIGludCB2cmVhZHlfb2Zmc2V0OworCisJdW5zaWduZWQgaW50IGRwcGNsa19kZWxheV9zdWJ0
b3RhbDsKKwl1bnNpZ25lZCBpbnQgZGlzcGNsa19kZWxheV9zdWJ0b3RhbDsKKwl1bnNpZ25lZCBp
bnQgcGl4ZWxfcmF0ZV9kZWxheV9zdWJ0b3RhbDsKKworCXVuc2lnbmVkIGludCB2c3RhcnR1cF9z
dGFydDsKKwl1bnNpZ25lZCBpbnQgZHN0X3hfYWZ0ZXJfc2NhbGVyOworCXVuc2lnbmVkIGludCBk
c3RfeV9hZnRlcl9zY2FsZXI7CisJZG91YmxlIGxpbmVfd2FpdDsKKwlkb3VibGUgZHN0X3lfcHJl
ZmV0Y2g7CisJZG91YmxlIGRzdF95X3Blcl92bV92Ymxhbms7CisJZG91YmxlIGRzdF95X3Blcl9y
b3dfdmJsYW5rOworCWRvdWJsZSBkc3RfeV9wZXJfdm1fZmxpcDsKKwlkb3VibGUgZHN0X3lfcGVy
X3Jvd19mbGlwOworCWRvdWJsZSBtYXhfZHN0X3lfcGVyX3ZtX3ZibGFuazsKKwlkb3VibGUgbWF4
X2RzdF95X3Blcl9yb3dfdmJsYW5rOworCWRvdWJsZSBsc3c7CisJZG91YmxlIHZyYXRpb19wcmVf
bDsKKwlkb3VibGUgdnJhdGlvX3ByZV9jOworCXVuc2lnbmVkIGludCByZXFfcGVyX3N3YXRoX3Vi
X2w7CisJdW5zaWduZWQgaW50IHJlcV9wZXJfc3dhdGhfdWJfYzsKKwl1bnNpZ25lZCBpbnQgbWV0
YV9yb3dfaGVpZ2h0X2w7CisJdW5zaWduZWQgaW50IG1ldGFfcm93X2hlaWdodF9jOworCXVuc2ln
bmVkIGludCBzd2F0aF93aWR0aF9waXhlbHNfdWJfbDsKKwl1bnNpZ25lZCBpbnQgc3dhdGhfd2lk
dGhfcGl4ZWxzX3ViX2M7CisJdW5zaWduZWQgaW50IHNjYWxlcl9yZWNfaW5fd2lkdGhfbDsKKwl1
bnNpZ25lZCBpbnQgc2NhbGVyX3JlY19pbl93aWR0aF9jOworCXVuc2lnbmVkIGludCBkcHRlX3Jv
d19oZWlnaHRfbDsKKwl1bnNpZ25lZCBpbnQgZHB0ZV9yb3dfaGVpZ2h0X2M7CisJZG91YmxlIGhz
Y2FsZV9waXhlbF9yYXRlX2w7CisJZG91YmxlIGhzY2FsZV9waXhlbF9yYXRlX2M7CisJZG91Ymxl
IG1pbl9ocmF0aW9fZmFjdF9sOworCWRvdWJsZSBtaW5faHJhdGlvX2ZhY3RfYzsKKwlkb3VibGUg
cmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9sOworCWRvdWJsZSByZWZjeWNfcGVyX2xpbmVf
ZGVsaXZlcnlfcHJlX2M7CisJZG91YmxlIHJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9sOworCWRv
dWJsZSByZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfYzsKKworCWRvdWJsZSByZWZjeWNfcGVyX3Jl
cV9kZWxpdmVyeV9wcmVfbDsKKwlkb3VibGUgcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2M7
CisJZG91YmxlIHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2w7CisJZG91YmxlIHJlZmN5Y19wZXJf
cmVxX2RlbGl2ZXJ5X2M7CisKKwl1bnNpZ25lZCBpbnQgZnVsbF9yZWNvdXRfd2lkdGg7CisJZG91
YmxlIHhmY190cmFuc2Zlcl9kZWxheTsKKwlkb3VibGUgeGZjX3ByZWNoYXJnZV9kZWxheTsKKwlk
b3VibGUgeGZjX3JlbW90ZV9zdXJmYWNlX2ZsaXBfbGF0ZW5jeTsKKwlkb3VibGUgeGZjX2RzdF95
X2RlbHRhX2RycV9saW1pdDsKKwlkb3VibGUgeGZjX3ByZWZldGNoX21hcmdpbjsKKwlkb3VibGUg
cmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1cjA7CisJZG91YmxlIHJlZmN5Y19wZXJfcmVx
X2RlbGl2ZXJ5X2N1cjA7CisJZG91YmxlIHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIx
OworCWRvdWJsZSByZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIxOworCisJbWVtc2V0KGRpc3Bf
ZGxnX3JlZ3MsIDAsIHNpemVvZigqZGlzcF9kbGdfcmVncykpOworCW1lbXNldChkaXNwX3R0dV9y
ZWdzLCAwLCBzaXplb2YoKmRpc3BfdHR1X3JlZ3MpKTsKKworCWRtbF9wcmludCgiRE1MX0RMRzog
JXM6ICBjc3RhdGVfZW4gPSAlZFxuIiwgX19mdW5jX18sIGNzdGF0ZV9lbik7CisJZG1sX3ByaW50
KCJETUxfRExHOiAlczogIHBzdGF0ZV9lbiA9ICVkXG4iLCBfX2Z1bmNfXywgcHN0YXRlX2VuKTsK
KworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IGRwcGNsa19mcmVxX2luX21oeiAgICAgPSAlMy4y
ZlxuIiwgX19mdW5jX18sIGRwcGNsa19mcmVxX2luX21oeik7CisJZG1sX3ByaW50KCJETUxfRExH
OiAlczogZGlzcGNsa19mcmVxX2luX21oeiAgICA9ICUzLjJmXG4iLCBfX2Z1bmNfXywgZGlzcGNs
a19mcmVxX2luX21oeik7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogcmVmY2xrX2ZyZXFfaW5f
bWh6ICAgICA9ICUzLjJmXG4iLCBfX2Z1bmNfXywgcmVmY2xrX2ZyZXFfaW5fbWh6KTsKKwlkbWxf
cHJpbnQoIkRNTF9ETEc6ICVzOiBwY2xrX2ZyZXFfaW5fbWh6ICAgICAgID0gJTMuMmZcbiIsIF9f
ZnVuY19fLCBwY2xrX2ZyZXFfaW5fbWh6KTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBpbnRl
cmxhY2VkICAgICAgICAgICAgID0gJWRcbiIsIF9fZnVuY19fLCBpbnRlcmxhY2VkKTsKKwlBU1NF
UlQocmVmX2ZyZXFfdG9fcGl4X2ZyZXEgPCA0LjApOworCisJZGlzcF9kbGdfcmVncy0+cmVmX2Zy
ZXFfdG9fcGl4X2ZyZXEgPQorCQkJKHVuc2lnbmVkIGludCkgKHJlZl9mcmVxX3RvX3BpeF9mcmVx
ICogZG1sX3BvdygyLCAxOSkpOworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfaHRvdGFsID0g
KHVuc2lnbmVkIGludCkgKHJlZl9mcmVxX3RvX3BpeF9mcmVxICogKGRvdWJsZSkgaHRvdGFsCisJ
CQkqIGRtbF9wb3coMiwgOCkpOworCWRpc3BfZGxnX3JlZ3MtPmRsZ192YmxhbmtfZW5kID0gaW50
ZXJsYWNlZCA/ICh2YmxhbmtfZW5kIC8gMikgOiB2YmxhbmtfZW5kOyAvLyAxNSBiaXRzCisJZGlz
cF9kbGdfcmVncy0+cmVmY3ljX2hfYmxhbmtfZW5kID0gKHVuc2lnbmVkIGludCkgKChkb3VibGUp
IGhibGFua19lbmQKKwkJCSogKGRvdWJsZSkgcmVmX2ZyZXFfdG9fcGl4X2ZyZXEpOworCUFTU0VS
VChkaXNwX2RsZ19yZWdzLT5yZWZjeWNfaF9ibGFua19lbmQgPCAodW5zaWduZWQgaW50KWRtbF9w
b3coMiwgMTMpKTsKKworCW1pbl9kY2ZjbGtfbWh6ID0gZGxnX3N5c19wYXJhbS5kZWVwc2xlZXBf
ZGNmY2xrX21oejsKKwl0X2NhbGNfdXMgPSBnZXRfdGNhbGMobW9kZV9saWIsIGUyZV9waXBlX3Bh
cmFtLCBudW1fcGlwZXMpOworCW1pbl90dHVfdmJsYW5rID0gZ2V0X21pbl90dHVfdmJsYW5rKG1v
ZGVfbGliLCBlMmVfcGlwZV9wYXJhbSwgbnVtX3BpcGVzLCBwaXBlX2lkeCk7CisKKwltaW5fZHN0
X3lfdHR1X3ZibGFuayA9IG1pbl90dHVfdmJsYW5rICogcGNsa19mcmVxX2luX21oeiAvIChkb3Vi
bGUpIGh0b3RhbDsKKwlkbGdfdmJsYW5rX3N0YXJ0ID0gaW50ZXJsYWNlZCA/ICh2Ymxhbmtfc3Rh
cnQgLyAyKSA6IHZibGFua19zdGFydDsKKworCWRpc3BfZGxnX3JlZ3MtPm1pbl9kc3RfeV9uZXh0
X3N0YXJ0ID0gKHVuc2lnbmVkIGludCkgKCgoZG91YmxlKSBkbGdfdmJsYW5rX3N0YXJ0KSAqIGRt
bF9wb3coMiwgMikpOworCUFTU0VSVChkaXNwX2RsZ19yZWdzLT5taW5fZHN0X3lfbmV4dF9zdGFy
dCA8ICh1bnNpZ25lZCBpbnQpZG1sX3BvdygyLCAxOCkpOworCisJZG1sX3ByaW50KAorCQkJIkRN
TF9ETEc6ICVzOiBtaW5fZGNmY2xrX21oeiAgICAgICAgICAgICAgICAgICAgICAgICA9ICUzLjJm
XG4iLAorCQkJX19mdW5jX18sCisJCQltaW5fZGNmY2xrX21oeik7CisJZG1sX3ByaW50KAorCQkJ
IkRNTF9ETEc6ICVzOiBtaW5fdHR1X3ZibGFuayAgICAgICAgICAgICAgICAgICAgICAgICA9ICUz
LjJmXG4iLAorCQkJX19mdW5jX18sCisJCQltaW5fdHR1X3ZibGFuayk7CisJZG1sX3ByaW50KAor
CQkJIkRNTF9ETEc6ICVzOiBtaW5fZHN0X3lfdHR1X3ZibGFuayAgICAgICAgICAgICAgICAgICA9
ICUzLjJmXG4iLAorCQkJX19mdW5jX18sCisJCQltaW5fZHN0X3lfdHR1X3ZibGFuayk7CisJZG1s
X3ByaW50KAorCQkJIkRNTF9ETEc6ICVzOiB0X2NhbGNfdXMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICA9ICUzLjJmXG4iLAorCQkJX19mdW5jX18sCisJCQl0X2NhbGNfdXMpOworCWRtbF9w
cmludCgKKwkJCSJETUxfRExHOiAlczogZGlzcF9kbGdfcmVncy0+bWluX2RzdF95X25leHRfc3Rh
cnQgICAgPSAweCUweFxuIiwKKwkJCV9fZnVuY19fLAorCQkJZGlzcF9kbGdfcmVncy0+bWluX2Rz
dF95X25leHRfc3RhcnQpOworCWRtbF9wcmludCgKKwkJCSJETUxfRExHOiAlczogcmVmX2ZyZXFf
dG9fcGl4X2ZyZXEgICAgICAgICAgICAgICAgICAgPSAlMy4yZlxuIiwKKwkJCV9fZnVuY19fLAor
CQkJcmVmX2ZyZXFfdG9fcGl4X2ZyZXEpOworCisJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQorCS8vIFNlY3Rpb24gMS4xNS4yLjI6IFByZWZldGNoLCBBY3RpdmUgYW5kIFRUVQorCS8vIC0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKwkvLyBQcmVmZXRjaCBDYWxjCisJLy8gU291cmNlCisJ
Ly8gICAgICAgICAgICAgZGNjX2VuICAgICAgICAgICAgICA9IHNyYy5kY2M7CisJZHVhbF9wbGFu
ZSA9IGlzX2R1YWxfcGxhbmUoKGVudW0gc291cmNlX2Zvcm1hdF9jbGFzcykgKHNyYy0+c291cmNl
X2Zvcm1hdCkpOworCW1vZGVfNDIyID0gMDsgLy8gRklYTUUKKwlhY2Nlc3NfZGlyID0gKHNyYy0+
c291cmNlX3NjYW4gPT0gZG1fdmVydCk7IC8vIHZwIGFjY2VzcyBkaXJlY3Rpb246IGhvcml6b250
YWwgb3IgdmVydGljYWwgYWNjZXNzZWQKKwkJCQkJCSAgICAvLyAgICAgIGJ5dGVzX3Blcl9lbGVt
ZW50X2wgPSBnZXRfYnl0ZXNfcGVyX2VsZW1lbnQoc291cmNlX2Zvcm1hdF9jbGFzcyhzcmMuc291
cmNlX2Zvcm1hdCksIDApOworCQkJCQkJICAgIC8vICAgICAgYnl0ZXNfcGVyX2VsZW1lbnRfYyA9
IGdldF9ieXRlc19wZXJfZWxlbWVudChzb3VyY2VfZm9ybWF0X2NsYXNzKHNyYy5zb3VyY2VfZm9y
bWF0KSwgMSk7CisJdnBfaGVpZ2h0X2wgPSBzcmMtPnZpZXdwb3J0X2hlaWdodDsKKwl2cF93aWR0
aF9sID0gc3JjLT52aWV3cG9ydF93aWR0aDsKKwl2cF9oZWlnaHRfYyA9IHNyYy0+dmlld3BvcnRf
aGVpZ2h0X2M7CisJdnBfd2lkdGhfYyA9IHNyYy0+dmlld3BvcnRfd2lkdGhfYzsKKworCS8vIFNj
YWxpbmcKKwlodGFwc19sID0gdGFwcy0+aHRhcHM7CisJaHRhcHNfYyA9IHRhcHMtPmh0YXBzX2M7
CisJaHJhdGlvX2wgPSBzY2wtPmhzY2xfcmF0aW87CisJaHJhdGlvX2MgPSBzY2wtPmhzY2xfcmF0
aW9fYzsKKwl2cmF0aW9fbCA9IHNjbC0+dnNjbF9yYXRpbzsKKwl2cmF0aW9fYyA9IHNjbC0+dnNj
bF9yYXRpb19jOworCXNjbF9lbmFibGUgPSBzY2wtPnNjbF9lbmFibGU7CisKKwlsaW5lX3RpbWVf
aW5fdXMgPSAoaHRvdGFsIC8gcGNsa19mcmVxX2luX21oeik7CisJc3dhdGhfd2lkdGhfdWJfbCA9
IHJxX2RsZ19wYXJhbS5ycV9sLnN3YXRoX3dpZHRoX3ViOworCWRwdGVfZ3JvdXBzX3Blcl9yb3df
dWJfbCA9IHJxX2RsZ19wYXJhbS5ycV9sLmRwdGVfZ3JvdXBzX3Blcl9yb3dfdWI7CisJc3dhdGhf
d2lkdGhfdWJfYyA9IHJxX2RsZ19wYXJhbS5ycV9jLnN3YXRoX3dpZHRoX3ViOworCWRwdGVfZ3Jv
dXBzX3Blcl9yb3dfdWJfYyA9IHJxX2RsZ19wYXJhbS5ycV9jLmRwdGVfZ3JvdXBzX3Blcl9yb3df
dWI7CisKKwltZXRhX2NodW5rc19wZXJfcm93X3ViX2wgPSBycV9kbGdfcGFyYW0ucnFfbC5tZXRh
X2NodW5rc19wZXJfcm93X3ViOworCW1ldGFfY2h1bmtzX3Blcl9yb3dfdWJfYyA9IHJxX2RsZ19w
YXJhbS5ycV9jLm1ldGFfY2h1bmtzX3Blcl9yb3dfdWI7CisJdnVwZGF0ZV9vZmZzZXQgPSBkc3Qt
PnZ1cGRhdGVfb2Zmc2V0OworCXZ1cGRhdGVfd2lkdGggPSBkc3QtPnZ1cGRhdGVfd2lkdGg7CisJ
dnJlYWR5X29mZnNldCA9IGRzdC0+dnJlYWR5X29mZnNldDsKKworCWRwcGNsa19kZWxheV9zdWJ0
b3RhbCA9IG1vZGVfbGliLT5pcC5kcHBjbGtfZGVsYXlfc3VidG90YWw7CisJZGlzcGNsa19kZWxh
eV9zdWJ0b3RhbCA9IG1vZGVfbGliLT5pcC5kaXNwY2xrX2RlbGF5X3N1YnRvdGFsOworCisJaWYg
KHNjbF9lbmFibGUpCisJCWRwcGNsa19kZWxheV9zdWJ0b3RhbCArPSBtb2RlX2xpYi0+aXAuZHBw
Y2xrX2RlbGF5X3NjbDsKKwllbHNlCisJCWRwcGNsa19kZWxheV9zdWJ0b3RhbCArPSBtb2RlX2xp
Yi0+aXAuZHBwY2xrX2RlbGF5X3NjbF9sYl9vbmx5OworCisJZHBwY2xrX2RlbGF5X3N1YnRvdGFs
ICs9IG1vZGVfbGliLT5pcC5kcHBjbGtfZGVsYXlfY252Y19mb3JtYXR0ZXIKKwkJCSsgc3JjLT5u
dW1fY3Vyc29ycyAqIG1vZGVfbGliLT5pcC5kcHBjbGtfZGVsYXlfY252Y19jdXJzb3I7CisKKwlp
ZiAoZG91dC0+ZHNjX2VuYWJsZSkgeworCQlkb3VibGUgZHNjX2RlbGF5ID0gZ2V0X2RzY19kZWxh
eShtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcywgcGlwZV9pZHgpOworCisJCWRp
c3BjbGtfZGVsYXlfc3VidG90YWwgKz0gZHNjX2RlbGF5OworCX0KKworCXBpeGVsX3JhdGVfZGVs
YXlfc3VidG90YWwgPSBkcHBjbGtfZGVsYXlfc3VidG90YWwgKiBwY2xrX2ZyZXFfaW5fbWh6IC8g
ZHBwY2xrX2ZyZXFfaW5fbWh6CisJCQkrIGRpc3BjbGtfZGVsYXlfc3VidG90YWwgKiBwY2xrX2Zy
ZXFfaW5fbWh6IC8gZGlzcGNsa19mcmVxX2luX21oejsKKworCXZzdGFydHVwX3N0YXJ0ID0gZHN0
LT52c3RhcnR1cF9zdGFydDsKKwlpZiAoaW50ZXJsYWNlZCkgeworCQlpZiAodnN0YXJ0dXBfc3Rh
cnQgLyAyLjAKKwkJCQktIChkb3VibGUpICh2cmVhZHlfb2Zmc2V0ICsgdnVwZGF0ZV93aWR0aCAr
IHZ1cGRhdGVfb2Zmc2V0KSAvIGh0b3RhbAorCQkJCTw9IHZibGFua19lbmQgLyAyLjApCisJCQlk
aXNwX2RsZ19yZWdzLT52cmVhZHlfYWZ0ZXJfdmNvdW50MCA9IDE7CisJCWVsc2UKKwkJCWRpc3Bf
ZGxnX3JlZ3MtPnZyZWFkeV9hZnRlcl92Y291bnQwID0gMDsKKwl9IGVsc2UgeworCQlpZiAodnN0
YXJ0dXBfc3RhcnQKKwkJCQktIChkb3VibGUpICh2cmVhZHlfb2Zmc2V0ICsgdnVwZGF0ZV93aWR0
aCArIHZ1cGRhdGVfb2Zmc2V0KSAvIGh0b3RhbAorCQkJCTw9IHZibGFua19lbmQpCisJCQlkaXNw
X2RsZ19yZWdzLT52cmVhZHlfYWZ0ZXJfdmNvdW50MCA9IDE7CisJCWVsc2UKKwkJCWRpc3BfZGxn
X3JlZ3MtPnZyZWFkeV9hZnRlcl92Y291bnQwID0gMDsKKwl9CisKKwkvLyBUT0RPOiBXaGVyZSBp
cyB0aGlzIGNvbWluZyBmcm9tPworCWlmIChpbnRlcmxhY2VkKQorCQl2c3RhcnR1cF9zdGFydCA9
IHZzdGFydHVwX3N0YXJ0IC8gMjsKKworCS8vIFRPRE86IFdoYXQgaWYgdGhpcyBtaW5fdmJsYW5r
IGRvZXNuJ3QgbWF0Y2ggdGhlIHZhbHVlIGluIHRoZSBkbWxfY29uZmlnX3NldHRpbmdzLmNwcD8K
KwlpZiAodnN0YXJ0dXBfc3RhcnQgPj0gbWluX3ZibGFuaykgeworCQlkbWxfcHJpbnQoCisJCQkJ
IldBUk5JTkc6IERNTF9ETEc6ICVzOiB2Ymxhbmtfc3RhcnQ9JWQgdmJsYW5rX2VuZD0lZFxuIiwK
KwkJCQlfX2Z1bmNfXywKKwkJCQl2Ymxhbmtfc3RhcnQsCisJCQkJdmJsYW5rX2VuZCk7CisJCWRt
bF9wcmludCgKKwkJCQkiV0FSTklORzogRE1MX0RMRzogJXM6IHZzdGFydHVwX3N0YXJ0PSVkIHNo
b3VsZCBiZSBsZXNzIHRoYW4gbWluX3ZibGFuaz0lZFxuIiwKKwkJCQlfX2Z1bmNfXywKKwkJCQl2
c3RhcnR1cF9zdGFydCwKKwkJCQltaW5fdmJsYW5rKTsKKwkJbWluX3ZibGFuayA9IHZzdGFydHVw
X3N0YXJ0ICsgMTsKKwkJZG1sX3ByaW50KAorCQkJCSJXQVJOSU5HOiBETUxfRExHOiAlczogdnN0
YXJ0dXBfc3RhcnQ9JWQgc2hvdWxkIGJlIGxlc3MgdGhhbiBtaW5fdmJsYW5rPSVkXG4iLAorCQkJ
CV9fZnVuY19fLAorCQkJCXZzdGFydHVwX3N0YXJ0LAorCQkJCW1pbl92YmxhbmspOworCX0KKwor
CWRzdF94X2FmdGVyX3NjYWxlciA9IGdldF9kc3RfeF9hZnRlcl9zY2FsZXIobW9kZV9saWIsIGUy
ZV9waXBlX3BhcmFtLCBudW1fcGlwZXMsIHBpcGVfaWR4KTsKKwlkc3RfeV9hZnRlcl9zY2FsZXIg
PSBnZXRfZHN0X3lfYWZ0ZXJfc2NhbGVyKG1vZGVfbGliLCBlMmVfcGlwZV9wYXJhbSwgbnVtX3Bp
cGVzLCBwaXBlX2lkeCk7CisKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBodG90YWwgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICA9ICVkXG4iLCBfX2Z1bmNfXywgaHRvdGFsKTsKKwlk
bWxfcHJpbnQoCisJCQkiRE1MX0RMRzogJXM6IHBpeGVsX3JhdGVfZGVsYXlfc3VidG90YWwgICAg
ICAgICAgICAgID0gJWRcbiIsCisJCQlfX2Z1bmNfXywKKwkJCXBpeGVsX3JhdGVfZGVsYXlfc3Vi
dG90YWwpOworCWRtbF9wcmludCgKKwkJCSJETUxfRExHOiAlczogZHN0X3hfYWZ0ZXJfc2NhbGVy
ICAgICAgICAgICAgICAgICAgICAgPSAlZFxuIiwKKwkJCV9fZnVuY19fLAorCQkJZHN0X3hfYWZ0
ZXJfc2NhbGVyKTsKKwlkbWxfcHJpbnQoCisJCQkiRE1MX0RMRzogJXM6IGRzdF95X2FmdGVyX3Nj
YWxlciAgICAgICAgICAgICAgICAgICAgID0gJWRcbiIsCisJCQlfX2Z1bmNfXywKKwkJCWRzdF95
X2FmdGVyX3NjYWxlcik7CisKKwkvLyBMd2FpdAorCS8vIFRPRE86IFNob3VsZCB0aGlzIGJlIHVy
Z2VudF9sYXRlbmN5X3BpeGVsX21peGVkX3dpdGhfdm1fZGF0YV91cz8KKwlsaW5lX3dhaXQgPSBt
b2RlX2xpYi0+c29jLnVyZ2VudF9sYXRlbmN5X3BpeGVsX2RhdGFfb25seV91czsKKwlpZiAoY3N0
YXRlX2VuKQorCQlsaW5lX3dhaXQgPSBkbWxfbWF4KG1vZGVfbGliLT5zb2Muc3JfZW50ZXJfcGx1
c19leGl0X3RpbWVfdXMsIGxpbmVfd2FpdCk7CisJaWYgKHBzdGF0ZV9lbikKKwkJbGluZV93YWl0
ID0gZG1sX21heCgKKwkJCQltb2RlX2xpYi0+c29jLmRyYW1fY2xvY2tfY2hhbmdlX2xhdGVuY3lf
dXMKKwkJCQkJCSsgbW9kZV9saWItPnNvYy51cmdlbnRfbGF0ZW5jeV9waXhlbF9kYXRhX29ubHlf
dXMsIC8vIFRPRE86IFNob3VsZCB0aGlzIGJlIHVyZ2VudF9sYXRlbmN5X3BpeGVsX21peGVkX3dp
dGhfdm1fZGF0YV91cz8KKwkJCQlsaW5lX3dhaXQpOworCWxpbmVfd2FpdCA9IGxpbmVfd2FpdCAv
IGxpbmVfdGltZV9pbl91czsKKworCWRzdF95X3ByZWZldGNoID0gZ2V0X2RzdF95X3ByZWZldGNo
KG1vZGVfbGliLCBlMmVfcGlwZV9wYXJhbSwgbnVtX3BpcGVzLCBwaXBlX2lkeCk7CisJZG1sX3By
aW50KCJETUxfRExHOiAlczogZHN0X3lfcHJlZmV0Y2ggKGFmdGVyIHJuZCkgPSAlMy4yZlxuIiwg
X19mdW5jX18sIGRzdF95X3ByZWZldGNoKTsKKworCWRzdF95X3Blcl92bV92YmxhbmsgPSBnZXRf
ZHN0X3lfcGVyX3ZtX3ZibGFuaygKKwkJCW1vZGVfbGliLAorCQkJZTJlX3BpcGVfcGFyYW0sCisJ
CQludW1fcGlwZXMsCisJCQlwaXBlX2lkeCk7CisJZHN0X3lfcGVyX3Jvd192YmxhbmsgPSBnZXRf
ZHN0X3lfcGVyX3Jvd192YmxhbmsoCisJCQltb2RlX2xpYiwKKwkJCWUyZV9waXBlX3BhcmFtLAor
CQkJbnVtX3BpcGVzLAorCQkJcGlwZV9pZHgpOworCWRzdF95X3Blcl92bV9mbGlwID0gZ2V0X2Rz
dF95X3Blcl92bV9mbGlwKG1vZGVfbGliLCBlMmVfcGlwZV9wYXJhbSwgbnVtX3BpcGVzLCBwaXBl
X2lkeCk7CisJZHN0X3lfcGVyX3Jvd19mbGlwID0gZ2V0X2RzdF95X3Blcl9yb3dfZmxpcChtb2Rl
X2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcywgcGlwZV9pZHgpOworCisJbWF4X2RzdF95
X3Blcl92bV92YmxhbmsgPSAzMi4wOworCW1heF9kc3RfeV9wZXJfcm93X3ZibGFuayA9IDE2LjA7
CisKKwkvLyBtYWdpYyEKKwlpZiAoaHRvdGFsIDw9IDc1KSB7CisJCW1pbl92YmxhbmsgPSAzMDA7
CisJCW1heF9kc3RfeV9wZXJfdm1fdmJsYW5rID0gMTAwLjA7CisJCW1heF9kc3RfeV9wZXJfcm93
X3ZibGFuayA9IDEwMC4wOworCX0KKworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IGRzdF95X3Bl
cl92bV9mbGlwICAgID0gJTMuMmZcbiIsIF9fZnVuY19fLCBkc3RfeV9wZXJfdm1fZmxpcCk7CisJ
ZG1sX3ByaW50KCJETUxfRExHOiAlczogZHN0X3lfcGVyX3Jvd19mbGlwICAgPSAlMy4yZlxuIiwg
X19mdW5jX18sIGRzdF95X3Blcl9yb3dfZmxpcCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczog
ZHN0X3lfcGVyX3ZtX3ZibGFuayAgPSAlMy4yZlxuIiwgX19mdW5jX18sIGRzdF95X3Blcl92bV92
YmxhbmspOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IGRzdF95X3Blcl9yb3dfdmJsYW5rID0g
JTMuMmZcbiIsIF9fZnVuY19fLCBkc3RfeV9wZXJfcm93X3ZibGFuayk7CisKKwlBU1NFUlQoZHN0
X3lfcGVyX3ZtX3ZibGFuayA8IG1heF9kc3RfeV9wZXJfdm1fdmJsYW5rKTsKKwlBU1NFUlQoZHN0
X3lfcGVyX3Jvd192YmxhbmsgPCBtYXhfZHN0X3lfcGVyX3Jvd192YmxhbmspOworCisJQVNTRVJU
KGRzdF95X3ByZWZldGNoID4gKGRzdF95X3Blcl92bV92YmxhbmsgKyBkc3RfeV9wZXJfcm93X3Zi
bGFuaykpOworCWxzdyA9IGRzdF95X3ByZWZldGNoIC0gKGRzdF95X3Blcl92bV92YmxhbmsgKyBk
c3RfeV9wZXJfcm93X3ZibGFuayk7CisKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBsc3cgPSAl
My4yZlxuIiwgX19mdW5jX18sIGxzdyk7CisKKwl2cmF0aW9fcHJlX2wgPSBnZXRfdnJhdGlvX3By
ZWZldGNoX2wobW9kZV9saWIsIGUyZV9waXBlX3BhcmFtLCBudW1fcGlwZXMsIHBpcGVfaWR4KTsK
Kwl2cmF0aW9fcHJlX2MgPSBnZXRfdnJhdGlvX3ByZWZldGNoX2MobW9kZV9saWIsIGUyZV9waXBl
X3BhcmFtLCBudW1fcGlwZXMsIHBpcGVfaWR4KTsKKworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6
IHZyYXRpb19wcmVfbD0lMy4yZlxuIiwgX19mdW5jX18sIHZyYXRpb19wcmVfbCk7CisJZG1sX3By
aW50KCJETUxfRExHOiAlczogdnJhdGlvX3ByZV9jPSUzLjJmXG4iLCBfX2Z1bmNfXywgdnJhdGlv
X3ByZV9jKTsKKworCS8vIEFjdGl2ZQorCXJlcV9wZXJfc3dhdGhfdWJfbCA9IHJxX2RsZ19wYXJh
bS5ycV9sLnJlcV9wZXJfc3dhdGhfdWI7CisJcmVxX3Blcl9zd2F0aF91Yl9jID0gcnFfZGxnX3Bh
cmFtLnJxX2MucmVxX3Blcl9zd2F0aF91YjsKKwltZXRhX3Jvd19oZWlnaHRfbCA9IHJxX2RsZ19w
YXJhbS5ycV9sLm1ldGFfcm93X2hlaWdodDsKKwltZXRhX3Jvd19oZWlnaHRfYyA9IHJxX2RsZ19w
YXJhbS5ycV9jLm1ldGFfcm93X2hlaWdodDsKKwlzd2F0aF93aWR0aF9waXhlbHNfdWJfbCA9IDA7
CisJc3dhdGhfd2lkdGhfcGl4ZWxzX3ViX2MgPSAwOworCXNjYWxlcl9yZWNfaW5fd2lkdGhfbCA9
IDA7CisJc2NhbGVyX3JlY19pbl93aWR0aF9jID0gMDsKKwlkcHRlX3Jvd19oZWlnaHRfbCA9IHJx
X2RsZ19wYXJhbS5ycV9sLmRwdGVfcm93X2hlaWdodDsKKwlkcHRlX3Jvd19oZWlnaHRfYyA9IHJx
X2RsZ19wYXJhbS5ycV9jLmRwdGVfcm93X2hlaWdodDsKKworCWlmIChtb2RlXzQyMikgeworCQlz
d2F0aF93aWR0aF9waXhlbHNfdWJfbCA9IHN3YXRoX3dpZHRoX3ViX2wgKiAyOyAgLy8gKjIgZm9y
IDIgcGl4ZWwgcGVyIGVsZW1lbnQKKwkJc3dhdGhfd2lkdGhfcGl4ZWxzX3ViX2MgPSBzd2F0aF93
aWR0aF91Yl9jICogMjsKKwl9IGVsc2UgeworCQlzd2F0aF93aWR0aF9waXhlbHNfdWJfbCA9IHN3
YXRoX3dpZHRoX3ViX2wgKiAxOworCQlzd2F0aF93aWR0aF9waXhlbHNfdWJfYyA9IHN3YXRoX3dp
ZHRoX3ViX2MgKiAxOworCX0KKworCWhzY2FsZV9waXhlbF9yYXRlX2wgPSAwLjsKKwloc2NhbGVf
cGl4ZWxfcmF0ZV9jID0gMC47CisJbWluX2hyYXRpb19mYWN0X2wgPSAxLjA7CisJbWluX2hyYXRp
b19mYWN0X2MgPSAxLjA7CisKKwlpZiAoaHRhcHNfbCA8PSAxKQorCQltaW5faHJhdGlvX2ZhY3Rf
bCA9IDIuMDsKKwllbHNlIGlmIChodGFwc19sIDw9IDYpIHsKKwkJaWYgKChocmF0aW9fbCAqIDIu
MCkgPiA0LjApCisJCQltaW5faHJhdGlvX2ZhY3RfbCA9IDQuMDsKKwkJZWxzZQorCQkJbWluX2hy
YXRpb19mYWN0X2wgPSBocmF0aW9fbCAqIDIuMDsKKwl9IGVsc2UgeworCQlpZiAoaHJhdGlvX2wg
PiA0LjApCisJCQltaW5faHJhdGlvX2ZhY3RfbCA9IDQuMDsKKwkJZWxzZQorCQkJbWluX2hyYXRp
b19mYWN0X2wgPSBocmF0aW9fbDsKKwl9CisKKwloc2NhbGVfcGl4ZWxfcmF0ZV9sID0gbWluX2hy
YXRpb19mYWN0X2wgKiBkcHBjbGtfZnJlcV9pbl9taHo7CisKKwlpZiAoaHRhcHNfYyA8PSAxKQor
CQltaW5faHJhdGlvX2ZhY3RfYyA9IDIuMDsKKwllbHNlIGlmIChodGFwc19jIDw9IDYpIHsKKwkJ
aWYgKChocmF0aW9fYyAqIDIuMCkgPiA0LjApCisJCQltaW5faHJhdGlvX2ZhY3RfYyA9IDQuMDsK
KwkJZWxzZQorCQkJbWluX2hyYXRpb19mYWN0X2MgPSBocmF0aW9fYyAqIDIuMDsKKwl9IGVsc2Ug
eworCQlpZiAoaHJhdGlvX2MgPiA0LjApCisJCQltaW5faHJhdGlvX2ZhY3RfYyA9IDQuMDsKKwkJ
ZWxzZQorCQkJbWluX2hyYXRpb19mYWN0X2MgPSBocmF0aW9fYzsKKwl9CisKKwloc2NhbGVfcGl4
ZWxfcmF0ZV9jID0gbWluX2hyYXRpb19mYWN0X2MgKiBkcHBjbGtfZnJlcV9pbl9taHo7CisKKwly
ZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2wgPSAwLjsKKwlyZWZjeWNfcGVyX2xpbmVfZGVs
aXZlcnlfcHJlX2MgPSAwLjsKKwlyZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfbCA9IDAuOworCXJl
ZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9jID0gMC47CisKKwlyZWZjeWNfcGVyX3JlcV9kZWxpdmVy
eV9wcmVfbCA9IDAuOworCXJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jID0gMC47CisJcmVm
Y3ljX3Blcl9yZXFfZGVsaXZlcnlfbCA9IDAuOworCXJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2Mg
PSAwLjsKKworCWZ1bGxfcmVjb3V0X3dpZHRoID0gMDsKKwkvLyBJbiBPRE0KKwlpZiAoc3JjLT5p
c19oc3BsaXQpIHsKKwkJLy8gVGhpcyAiaGFjayIgIGlzIG9ubHkgYWxsb3dlZCAoYW5kIHZhbGlk
KSBmb3IgTVBDIGNvbWJpbmUuIEluIE9ETQorCQkvLyBjb21iaW5lLCB5b3UgTVVTVCBzcGVjaWZ5
IHRoZSBmdWxsX3JlY291dF93aWR0aC4uLmFjY29yZGluZyB0byBPc3dpbgorCQlpZiAoZHN0LT5m
dWxsX3JlY291dF93aWR0aCA9PSAwICYmICFkc3QtPm9kbV9jb21iaW5lKSB7CisJCQlkbWxfcHJp
bnQoCisJCQkJCSJETUxfRExHOiAlczogV2FybmluZzogZnVsbF9yZWNvdXRfd2lkdGggbm90IHNl
dCBpbiBoc3BsaXQgbW9kZVxuIiwKKwkJCQkJX19mdW5jX18pOworCQkJZnVsbF9yZWNvdXRfd2lk
dGggPSBkc3QtPnJlY291dF93aWR0aCAqIDI7IC8vIGFzc3VtZSBoYWxmIHNwbGl0IGZvciBkY24x
CisJCX0gZWxzZQorCQkJZnVsbF9yZWNvdXRfd2lkdGggPSBkc3QtPmZ1bGxfcmVjb3V0X3dpZHRo
OworCX0gZWxzZQorCQlmdWxsX3JlY291dF93aWR0aCA9IGRzdC0+cmVjb3V0X3dpZHRoOworCisJ
Ly8gQXMgb2YgRENOMiwgbXBjX2NvbWJpbmUgYW5kIG9kbV9jb21iaW5lIGFyZSBtdXR1YWxseSBl
eGNsdXNpdmUKKwlyZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2wgPSBnZXRfcmVmY3ljX3Bl
cl9kZWxpdmVyeSgKKwkJCW1vZGVfbGliLAorCQkJcmVmY2xrX2ZyZXFfaW5fbWh6LAorCQkJcGNs
a19mcmVxX2luX21oeiwKKwkJCWRzdC0+b2RtX2NvbWJpbmUsCisJCQlmdWxsX3JlY291dF93aWR0
aCwKKwkJCWRzdC0+aGFjdGl2ZSwKKwkJCXZyYXRpb19wcmVfbCwKKwkJCWhzY2FsZV9waXhlbF9y
YXRlX2wsCisJCQlzd2F0aF93aWR0aF9waXhlbHNfdWJfbCwKKwkJCTEpOyAvLyBwZXIgbGluZQor
CisJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2wgPSBnZXRfcmVmY3ljX3Blcl9kZWxpdmVyeSgK
KwkJCW1vZGVfbGliLAorCQkJcmVmY2xrX2ZyZXFfaW5fbWh6LAorCQkJcGNsa19mcmVxX2luX21o
eiwKKwkJCWRzdC0+b2RtX2NvbWJpbmUsCisJCQlmdWxsX3JlY291dF93aWR0aCwKKwkJCWRzdC0+
aGFjdGl2ZSwKKwkJCXZyYXRpb19sLAorCQkJaHNjYWxlX3BpeGVsX3JhdGVfbCwKKwkJCXN3YXRo
X3dpZHRoX3BpeGVsc191Yl9sLAorCQkJMSk7IC8vIHBlciBsaW5lCisKKwlkbWxfcHJpbnQoIkRN
TF9ETEc6ICVzOiBmdWxsX3JlY291dF93aWR0aCAgICAgICAgICAgICAgPSAlZFxuIiwgX19mdW5j
X18sIGZ1bGxfcmVjb3V0X3dpZHRoKTsKKwlkbWxfcHJpbnQoCisJCQkiRE1MX0RMRzogJXM6IGhz
Y2FsZV9waXhlbF9yYXRlX2wgICAgICAgICAgICA9ICUzLjJmXG4iLAorCQkJX19mdW5jX18sCisJ
CQloc2NhbGVfcGl4ZWxfcmF0ZV9sKTsKKwlkbWxfcHJpbnQoCisJCQkiRE1MX0RMRzogJXM6IHJl
ZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfbCA9ICUzLjJmXG4iLAorCQkJX19mdW5jX18sCisJ
CQlyZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2wpOworCWRtbF9wcmludCgKKwkJCSJETUxf
RExHOiAlczogcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2wgICAgID0gJTMuMmZcbiIsCisJCQlf
X2Z1bmNfXywKKwkJCXJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9sKTsKKworCWlmIChkdWFsX3Bs
YW5lKSB7CisJCXJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfYyA9IGdldF9yZWZjeWNfcGVy
X2RlbGl2ZXJ5KAorCQkJCW1vZGVfbGliLAorCQkJCXJlZmNsa19mcmVxX2luX21oeiwKKwkJCQlw
Y2xrX2ZyZXFfaW5fbWh6LAorCQkJCWRzdC0+b2RtX2NvbWJpbmUsCisJCQkJZnVsbF9yZWNvdXRf
d2lkdGgsCisJCQkJZHN0LT5oYWN0aXZlLAorCQkJCXZyYXRpb19wcmVfYywKKwkJCQloc2NhbGVf
cGl4ZWxfcmF0ZV9jLAorCQkJCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9jLAorCQkJCTEpOyAvLyBw
ZXIgbGluZQorCisJCXJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9jID0gZ2V0X3JlZmN5Y19wZXJf
ZGVsaXZlcnkoCisJCQkJbW9kZV9saWIsCisJCQkJcmVmY2xrX2ZyZXFfaW5fbWh6LAorCQkJCXBj
bGtfZnJlcV9pbl9taHosCisJCQkJZHN0LT5vZG1fY29tYmluZSwKKwkJCQlmdWxsX3JlY291dF93
aWR0aCwKKwkJCQlkc3QtPmhhY3RpdmUsCisJCQkJdnJhdGlvX2MsCisJCQkJaHNjYWxlX3BpeGVs
X3JhdGVfYywKKwkJCQlzd2F0aF93aWR0aF9waXhlbHNfdWJfYywKKwkJCQkxKTsgIC8vIHBlciBs
aW5lCisKKwkJZG1sX3ByaW50KAorCQkJCSJETUxfRExHOiAlczogcmVmY3ljX3Blcl9saW5lX2Rl
bGl2ZXJ5X3ByZV9jID0gJTMuMmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJcmVmY3ljX3Blcl9s
aW5lX2RlbGl2ZXJ5X3ByZV9jKTsKKwkJZG1sX3ByaW50KAorCQkJCSJETUxfRExHOiAlczogcmVm
Y3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2MgICAgID0gJTMuMmZcbiIsCisJCQkJX19mdW5jX18sCisJ
CQkJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2MpOworCX0KKworCS8vIFRUVSAtIEx1bWEgLyBD
aHJvbWEKKwlpZiAoYWNjZXNzX2RpcikgeyAgLy8gdmVydGljYWwgYWNjZXNzCisJCXNjYWxlcl9y
ZWNfaW5fd2lkdGhfbCA9IHZwX2hlaWdodF9sOworCQlzY2FsZXJfcmVjX2luX3dpZHRoX2MgPSB2
cF9oZWlnaHRfYzsKKwl9IGVsc2UgeworCQlzY2FsZXJfcmVjX2luX3dpZHRoX2wgPSB2cF93aWR0
aF9sOworCQlzY2FsZXJfcmVjX2luX3dpZHRoX2MgPSB2cF93aWR0aF9jOworCX0KKworCXJlZmN5
Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9sID0gZ2V0X3JlZmN5Y19wZXJfZGVsaXZlcnkoCisJCQlt
b2RlX2xpYiwKKwkJCXJlZmNsa19mcmVxX2luX21oeiwKKwkJCXBjbGtfZnJlcV9pbl9taHosCisJ
CQlkc3QtPm9kbV9jb21iaW5lLAorCQkJZnVsbF9yZWNvdXRfd2lkdGgsCisJCQlkc3QtPmhhY3Rp
dmUsCisJCQl2cmF0aW9fcHJlX2wsCisJCQloc2NhbGVfcGl4ZWxfcmF0ZV9sLAorCQkJc2NhbGVy
X3JlY19pbl93aWR0aF9sLAorCQkJcmVxX3Blcl9zd2F0aF91Yl9sKTsgIC8vIHBlciByZXEKKwly
ZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9sID0gZ2V0X3JlZmN5Y19wZXJfZGVsaXZlcnkoCisJCQlt
b2RlX2xpYiwKKwkJCXJlZmNsa19mcmVxX2luX21oeiwKKwkJCXBjbGtfZnJlcV9pbl9taHosCisJ
CQlkc3QtPm9kbV9jb21iaW5lLAorCQkJZnVsbF9yZWNvdXRfd2lkdGgsCisJCQlkc3QtPmhhY3Rp
dmUsCisJCQl2cmF0aW9fbCwKKwkJCWhzY2FsZV9waXhlbF9yYXRlX2wsCisJCQlzY2FsZXJfcmVj
X2luX3dpZHRoX2wsCisJCQlyZXFfcGVyX3N3YXRoX3ViX2wpOyAgLy8gcGVyIHJlcQorCisJZG1s
X3ByaW50KAorCQkJIkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfbCA9
ICUzLjJmXG4iLAorCQkJX19mdW5jX18sCisJCQlyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVf
bCk7CisJZG1sX3ByaW50KAorCQkJIkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX3JlcV9kZWxpdmVy
eV9sICAgICA9ICUzLjJmXG4iLAorCQkJX19mdW5jX18sCisJCQlyZWZjeWNfcGVyX3JlcV9kZWxp
dmVyeV9sKTsKKworCUFTU0VSVChyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfbCA8IGRtbF9w
b3coMiwgMTMpKTsKKwlBU1NFUlQocmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfbCA8IGRtbF9wb3co
MiwgMTMpKTsKKworCWlmIChkdWFsX3BsYW5lKSB7CisJCXJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5
X3ByZV9jID0gZ2V0X3JlZmN5Y19wZXJfZGVsaXZlcnkoCisJCQkJbW9kZV9saWIsCisJCQkJcmVm
Y2xrX2ZyZXFfaW5fbWh6LAorCQkJCXBjbGtfZnJlcV9pbl9taHosCisJCQkJZHN0LT5vZG1fY29t
YmluZSwKKwkJCQlmdWxsX3JlY291dF93aWR0aCwKKwkJCQlkc3QtPmhhY3RpdmUsCisJCQkJdnJh
dGlvX3ByZV9jLAorCQkJCWhzY2FsZV9waXhlbF9yYXRlX2MsCisJCQkJc2NhbGVyX3JlY19pbl93
aWR0aF9jLAorCQkJCXJlcV9wZXJfc3dhdGhfdWJfYyk7ICAvLyBwZXIgcmVxCisJCXJlZmN5Y19w
ZXJfcmVxX2RlbGl2ZXJ5X2MgPSBnZXRfcmVmY3ljX3Blcl9kZWxpdmVyeSgKKwkJCQltb2RlX2xp
YiwKKwkJCQlyZWZjbGtfZnJlcV9pbl9taHosCisJCQkJcGNsa19mcmVxX2luX21oeiwKKwkJCQlk
c3QtPm9kbV9jb21iaW5lLAorCQkJCWZ1bGxfcmVjb3V0X3dpZHRoLAorCQkJCWRzdC0+aGFjdGl2
ZSwKKwkJCQl2cmF0aW9fYywKKwkJCQloc2NhbGVfcGl4ZWxfcmF0ZV9jLAorCQkJCXNjYWxlcl9y
ZWNfaW5fd2lkdGhfYywKKwkJCQlyZXFfcGVyX3N3YXRoX3ViX2MpOyAgLy8gcGVyIHJlcQorCisJ
CWRtbF9wcmludCgKKwkJCQkiRE1MX0RMRzogJXM6IHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3By
ZV9jID0gJTMuMmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJcmVmY3ljX3Blcl9yZXFfZGVsaXZl
cnlfcHJlX2MpOworCQlkbWxfcHJpbnQoCisJCQkJIkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX3Jl
cV9kZWxpdmVyeV9jICAgICA9ICUzLjJmXG4iLAorCQkJCV9fZnVuY19fLAorCQkJCXJlZmN5Y19w
ZXJfcmVxX2RlbGl2ZXJ5X2MpOworCisJCUFTU0VSVChyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9w
cmVfYyA8IGRtbF9wb3coMiwgMTMpKTsKKwkJQVNTRVJUKHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5
X2MgPCBkbWxfcG93KDIsIDEzKSk7CisJfQorCisJLy8gWEZDCisJeGZjX3RyYW5zZmVyX2RlbGF5
ID0gZ2V0X3hmY190cmFuc2Zlcl9kZWxheShtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9w
aXBlcywgcGlwZV9pZHgpOworCXhmY19wcmVjaGFyZ2VfZGVsYXkgPSBnZXRfeGZjX3ByZWNoYXJn
ZV9kZWxheSgKKwkJCW1vZGVfbGliLAorCQkJZTJlX3BpcGVfcGFyYW0sCisJCQludW1fcGlwZXMs
CisJCQlwaXBlX2lkeCk7CisJeGZjX3JlbW90ZV9zdXJmYWNlX2ZsaXBfbGF0ZW5jeSA9IGdldF94
ZmNfcmVtb3RlX3N1cmZhY2VfZmxpcF9sYXRlbmN5KAorCQkJbW9kZV9saWIsCisJCQllMmVfcGlw
ZV9wYXJhbSwKKwkJCW51bV9waXBlcywKKwkJCXBpcGVfaWR4KTsKKwl4ZmNfZHN0X3lfZGVsdGFf
ZHJxX2xpbWl0ID0geGZjX3JlbW90ZV9zdXJmYWNlX2ZsaXBfbGF0ZW5jeTsKKwl4ZmNfcHJlZmV0
Y2hfbWFyZ2luID0gZ2V0X3hmY19wcmVmZXRjaF9tYXJnaW4oCisJCQltb2RlX2xpYiwKKwkJCWUy
ZV9waXBlX3BhcmFtLAorCQkJbnVtX3BpcGVzLAorCQkJcGlwZV9pZHgpOworCisJLy8gVFRVIC0g
Q3Vyc29yCisJcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1cjAgPSAwLjA7CisJcmVmY3lj
X3Blcl9yZXFfZGVsaXZlcnlfY3VyMCA9IDAuMDsKKwlpZiAoc3JjLT5udW1fY3Vyc29ycyA+IDAp
IHsKKwkJY2FsY3VsYXRlX3R0dV9jdXJzb3IoCisJCQkJbW9kZV9saWIsCisJCQkJJnJlZmN5Y19w
ZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIwLAorCQkJCSZyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9j
dXIwLAorCQkJCXJlZmNsa19mcmVxX2luX21oeiwKKwkJCQlyZWZfZnJlcV90b19waXhfZnJlcSwK
KwkJCQloc2NhbGVfcGl4ZWxfcmF0ZV9sLAorCQkJCXNjbC0+aHNjbF9yYXRpbywKKwkJCQl2cmF0
aW9fcHJlX2wsCisJCQkJdnJhdGlvX2wsCisJCQkJc3JjLT5jdXIwX3NyY193aWR0aCwKKwkJCQko
ZW51bSBjdXJzb3JfYnBwKSAoc3JjLT5jdXIwX2JwcCkpOworCX0KKworCXJlZmN5Y19wZXJfcmVx
X2RlbGl2ZXJ5X3ByZV9jdXIxID0gMC4wOworCXJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2N1cjEg
PSAwLjA7CisJaWYgKHNyYy0+bnVtX2N1cnNvcnMgPiAxKSB7CisJCWNhbGN1bGF0ZV90dHVfY3Vy
c29yKAorCQkJCW1vZGVfbGliLAorCQkJCSZyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfY3Vy
MSwKKwkJCQkmcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfY3VyMSwKKwkJCQlyZWZjbGtfZnJlcV9p
bl9taHosCisJCQkJcmVmX2ZyZXFfdG9fcGl4X2ZyZXEsCisJCQkJaHNjYWxlX3BpeGVsX3JhdGVf
bCwKKwkJCQlzY2wtPmhzY2xfcmF0aW8sCisJCQkJdnJhdGlvX3ByZV9sLAorCQkJCXZyYXRpb19s
LAorCQkJCXNyYy0+Y3VyMV9zcmNfd2lkdGgsCisJCQkJKGVudW0gY3Vyc29yX2JwcCkgKHNyYy0+
Y3VyMV9icHApKTsKKwl9CisKKwkvLyBUVFUgLSBNaXNjCisJLy8gYWxsIGhhcmQtY29kZWQKKwor
CS8vIEFzc2lnbm1lbnQgdG8gcmVnaXN0ZXIgc3RydWN0dXJlcworCWRpc3BfZGxnX3JlZ3MtPmRz
dF95X2FmdGVyX3NjYWxlciA9IGRzdF95X2FmdGVyX3NjYWxlcjsgLy8gaW4gdGVybXMgb2YgbGlu
ZQorCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y194X2FmdGVyX3NjYWxlciA9IGRzdF94X2FmdGVyX3Nj
YWxlciAqIHJlZl9mcmVxX3RvX3BpeF9mcmVxOyAvLyBpbiB0ZXJtcyBvZiByZWZjbGsKKwlBU1NF
UlQoZGlzcF9kbGdfcmVncy0+cmVmY3ljX3hfYWZ0ZXJfc2NhbGVyIDwgKHVuc2lnbmVkIGludClk
bWxfcG93KDIsIDEzKSk7CisJZGlzcF9kbGdfcmVncy0+ZHN0X3lfcHJlZmV0Y2ggPSAodW5zaWdu
ZWQgaW50KSAoZHN0X3lfcHJlZmV0Y2ggKiBkbWxfcG93KDIsIDIpKTsKKwlkaXNwX2RsZ19yZWdz
LT5kc3RfeV9wZXJfdm1fdmJsYW5rID0gKHVuc2lnbmVkIGludCkgKGRzdF95X3Blcl92bV92Ymxh
bmsgKiBkbWxfcG93KDIsIDIpKTsKKwlkaXNwX2RsZ19yZWdzLT5kc3RfeV9wZXJfcm93X3ZibGFu
ayA9ICh1bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJfcm93X3ZibGFuayAqIGRtbF9wb3coMiwgMikp
OworCWRpc3BfZGxnX3JlZ3MtPmRzdF95X3Blcl92bV9mbGlwID0gKHVuc2lnbmVkIGludCkgKGRz
dF95X3Blcl92bV9mbGlwICogZG1sX3BvdygyLCAyKSk7CisJZGlzcF9kbGdfcmVncy0+ZHN0X3lf
cGVyX3Jvd19mbGlwID0gKHVuc2lnbmVkIGludCkgKGRzdF95X3Blcl9yb3dfZmxpcCAqIGRtbF9w
b3coMiwgMikpOworCisJZGlzcF9kbGdfcmVncy0+dnJhdGlvX3ByZWZldGNoID0gKHVuc2lnbmVk
IGludCkgKHZyYXRpb19wcmVfbCAqIGRtbF9wb3coMiwgMTkpKTsKKwlkaXNwX2RsZ19yZWdzLT52
cmF0aW9fcHJlZmV0Y2hfYyA9ICh1bnNpZ25lZCBpbnQpICh2cmF0aW9fcHJlX2MgKiBkbWxfcG93
KDIsIDE5KSk7CisKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBkaXNwX2RsZ19yZWdzLT5kc3Rf
eV9wZXJfdm1fdmJsYW5rICA9IDB4JXhcbiIsIF9fZnVuY19fLCBkaXNwX2RsZ19yZWdzLT5kc3Rf
eV9wZXJfdm1fdmJsYW5rKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBkaXNwX2RsZ19yZWdz
LT5kc3RfeV9wZXJfcm93X3ZibGFuayA9IDB4JXhcbiIsIF9fZnVuY19fLCBkaXNwX2RsZ19yZWdz
LT5kc3RfeV9wZXJfcm93X3ZibGFuayk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogZGlzcF9k
bGdfcmVncy0+ZHN0X3lfcGVyX3ZtX2ZsaXAgICAgPSAweCV4XG4iLCBfX2Z1bmNfXywgZGlzcF9k
bGdfcmVncy0+ZHN0X3lfcGVyX3ZtX2ZsaXApOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IGRp
c3BfZGxnX3JlZ3MtPmRzdF95X3Blcl9yb3dfZmxpcCAgID0gMHgleFxuIiwgX19mdW5jX18sIGRp
c3BfZGxnX3JlZ3MtPmRzdF95X3Blcl9yb3dfZmxpcCk7CisKKwlkaXNwX2RsZ19yZWdzLT5yZWZj
eWNfcGVyX3B0ZV9ncm91cF92YmxhbmtfbCA9CisJCQkodW5zaWduZWQgaW50KSAoZHN0X3lfcGVy
X3Jvd192YmxhbmsgKiAoZG91YmxlKSBodG90YWwKKwkJCQkJKiByZWZfZnJlcV90b19waXhfZnJl
cSAvIChkb3VibGUpIGRwdGVfZ3JvdXBzX3Blcl9yb3dfdWJfbCk7CisJQVNTRVJUKGRpc3BfZGxn
X3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dyb3VwX3ZibGFua19sIDwgKHVuc2lnbmVkIGludClkbWxf
cG93KDIsIDEzKSk7CisKKwlpZiAoZHVhbF9wbGFuZSkgeworCQlkaXNwX2RsZ19yZWdzLT5yZWZj
eWNfcGVyX3B0ZV9ncm91cF92YmxhbmtfYyA9ICh1bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJfcm93
X3ZibGFuaworCQkJCSogKGRvdWJsZSkgaHRvdGFsICogcmVmX2ZyZXFfdG9fcGl4X2ZyZXEKKwkJ
CQkvIChkb3VibGUpIGRwdGVfZ3JvdXBzX3Blcl9yb3dfdWJfYyk7CisJCUFTU0VSVChkaXNwX2Rs
Z19yZWdzLT5yZWZjeWNfcGVyX3B0ZV9ncm91cF92YmxhbmtfYworCQkJCTwgKHVuc2lnbmVkIGlu
dClkbWxfcG93KDIsIDEzKSk7CisJfQorCisJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRh
X2NodW5rX3ZibGFua19sID0KKwkJCSh1bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJfcm93X3ZibGFu
ayAqIChkb3VibGUpIGh0b3RhbAorCQkJCQkqIHJlZl9mcmVxX3RvX3BpeF9mcmVxIC8gKGRvdWJs
ZSkgbWV0YV9jaHVua3NfcGVyX3Jvd191Yl9sKTsKKwlBU1NFUlQoZGlzcF9kbGdfcmVncy0+cmVm
Y3ljX3Blcl9tZXRhX2NodW5rX3ZibGFua19sIDwgKHVuc2lnbmVkIGludClkbWxfcG93KDIsIDEz
KSk7CisKKwlkaXNwX2RsZ19yZWdzLT5yZWZjeWNfcGVyX21ldGFfY2h1bmtfdmJsYW5rX2MgPQor
CQkJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX3ZibGFua19sOyAvLyBkY2Mg
Zm9yIDQ6MjowIGlzIG5vdCBzdXBwb3J0ZWQgaW4gZGNuMS4wLiAgYXNzaWduZWQgdG8gYmUgdGhl
IHNhbWUgYXMgX2wgZm9yIG5vdworCisJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9wdGVfZ3Jv
dXBfZmxpcF9sID0gKHVuc2lnbmVkIGludCkgKGRzdF95X3Blcl9yb3dfZmxpcCAqIGh0b3RhbAor
CQkJKiByZWZfZnJlcV90b19waXhfZnJlcSkgLyBkcHRlX2dyb3Vwc19wZXJfcm93X3ViX2w7CisJ
ZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX2ZsaXBfbCA9ICh1bnNpZ25lZCBp
bnQpIChkc3RfeV9wZXJfcm93X2ZsaXAgKiBodG90YWwKKwkJCSogcmVmX2ZyZXFfdG9fcGl4X2Zy
ZXEpIC8gbWV0YV9jaHVua3NfcGVyX3Jvd191Yl9sOworCisJaWYgKGR1YWxfcGxhbmUpIHsKKwkJ
ZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9wdGVfZ3JvdXBfZmxpcF9jID0gKHVuc2lnbmVkIGlu
dCkgKGRzdF95X3Blcl9yb3dfZmxpcAorCQkJCSogaHRvdGFsICogcmVmX2ZyZXFfdG9fcGl4X2Zy
ZXEpIC8gZHB0ZV9ncm91cHNfcGVyX3Jvd191Yl9jOworCQlkaXNwX2RsZ19yZWdzLT5yZWZjeWNf
cGVyX21ldGFfY2h1bmtfZmxpcF9jID0gKHVuc2lnbmVkIGludCkgKGRzdF95X3Blcl9yb3dfZmxp
cAorCQkJCSogaHRvdGFsICogcmVmX2ZyZXFfdG9fcGl4X2ZyZXEpIC8gbWV0YV9jaHVua3NfcGVy
X3Jvd191Yl9jOworCX0KKworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfdm1fZ3JvdXBfdmJs
YW5rICAgPSBnZXRfcmVmY3ljX3Blcl92bV9ncm91cF92YmxhbmsobW9kZV9saWIsIGUyZV9waXBl
X3BhcmFtLCBudW1fcGlwZXMsIHBpcGVfaWR4KSAqIHJlZmNsa19mcmVxX2luX21oejsKKwlkaXNw
X2RsZ19yZWdzLT5yZWZjeWNfcGVyX3ZtX2dyb3VwX2ZsaXAgICAgID0gZ2V0X3JlZmN5Y19wZXJf
dm1fZ3JvdXBfZmxpcChtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcywgcGlwZV9p
ZHgpICogcmVmY2xrX2ZyZXFfaW5fbWh6OworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfdm1f
cmVxX3ZibGFuayAgICAgPSBnZXRfcmVmY3ljX3Blcl92bV9yZXFfdmJsYW5rKG1vZGVfbGliLCBl
MmVfcGlwZV9wYXJhbSwgbnVtX3BpcGVzLCBwaXBlX2lkeCkgKiByZWZjbGtfZnJlcV9pbl9taHo7
OworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfdm1fcmVxX2ZsaXAgICAgICAgPSBnZXRfcmVm
Y3ljX3Blcl92bV9yZXFfZmxpcChtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcywg
cGlwZV9pZHgpICogcmVmY2xrX2ZyZXFfaW5fbWh6OzsKKworCS8vIENsYW1wIHRvIG1heCBmb3Ig
bm93CisJaWYgKGRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfdm1fZ3JvdXBfdmJsYW5rID49ICh1
bnNpZ25lZCBpbnQpZG1sX3BvdygyLCAyMykpCisJCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJf
dm1fZ3JvdXBfdmJsYW5rID0gZG1sX3BvdygyLCAyMykgLSAxOworCisJaWYgKGRpc3BfZGxnX3Jl
Z3MtPnJlZmN5Y19wZXJfdm1fZ3JvdXBfZmxpcCA+PSAodW5zaWduZWQgaW50KWRtbF9wb3coMiwg
MjMpKQorCQlkaXNwX2RsZ19yZWdzLT5yZWZjeWNfcGVyX3ZtX2dyb3VwX2ZsaXAgPSBkbWxfcG93
KDIsIDIzKSAtIDE7CisKKwlpZiAoZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl92bV9yZXFfdmJs
YW5rID49ICh1bnNpZ25lZCBpbnQpZG1sX3BvdygyLCAyMykpCisJCWRpc3BfZGxnX3JlZ3MtPnJl
ZmN5Y19wZXJfdm1fcmVxX3ZibGFuayA9IGRtbF9wb3coMiwgMjMpIC0gMTsKKworCWlmIChkaXNw
X2RsZ19yZWdzLT5yZWZjeWNfcGVyX3ZtX3JlcV9mbGlwID49ICh1bnNpZ25lZCBpbnQpZG1sX3Bv
dygyLCAyMykpCisJCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfdm1fcmVxX2ZsaXAgPSBkbWxf
cG93KDIsIDIzKSAtIDE7CisJZGlzcF9kbGdfcmVncy0+ZHN0X3lfcGVyX3B0ZV9yb3dfbm9tX2wg
PSAodW5zaWduZWQgaW50KSAoKGRvdWJsZSkgZHB0ZV9yb3dfaGVpZ2h0X2wKKwkJCS8gKGRvdWJs
ZSkgdnJhdGlvX2wgKiBkbWxfcG93KDIsIDIpKTsKKwlBU1NFUlQoZGlzcF9kbGdfcmVncy0+ZHN0
X3lfcGVyX3B0ZV9yb3dfbm9tX2wgPCAodW5zaWduZWQgaW50KWRtbF9wb3coMiwgMTcpKTsKKwor
CWlmIChkdWFsX3BsYW5lKSB7CisJCWRpc3BfZGxnX3JlZ3MtPmRzdF95X3Blcl9wdGVfcm93X25v
bV9jID0gKHVuc2lnbmVkIGludCkgKChkb3VibGUpIGRwdGVfcm93X2hlaWdodF9jCisJCQkJLyAo
ZG91YmxlKSB2cmF0aW9fYyAqIGRtbF9wb3coMiwgMikpOworCQlpZiAoZGlzcF9kbGdfcmVncy0+
ZHN0X3lfcGVyX3B0ZV9yb3dfbm9tX2MgPj0gKHVuc2lnbmVkIGludCkgZG1sX3BvdygyLCAxNykp
IHsKKwkJCWRtbF9wcmludCgKKwkJCQkJIkRNTF9ETEc6ICVzOiBXYXJuaW5nIGRzdF95X3Blcl9w
dGVfcm93X25vbV9jICV1IGxhcmdlciB0aGFuIHN1cHBvcnRlZCBieSByZWdpc3RlciBmb3JtYXQg
VTE1LjIgJXVcbiIsCisJCQkJCV9fZnVuY19fLAorCQkJCQlkaXNwX2RsZ19yZWdzLT5kc3RfeV9w
ZXJfcHRlX3Jvd19ub21fYywKKwkJCQkJKHVuc2lnbmVkIGludClkbWxfcG93KDIsIDE3KSAtIDEp
OworCQl9CisJfQorCisJZGlzcF9kbGdfcmVncy0+ZHN0X3lfcGVyX21ldGFfcm93X25vbV9sID0g
KHVuc2lnbmVkIGludCkgKChkb3VibGUpIG1ldGFfcm93X2hlaWdodF9sCisJCQkvIChkb3VibGUp
IHZyYXRpb19sICogZG1sX3BvdygyLCAyKSk7CisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPmRzdF95
X3Blcl9tZXRhX3Jvd19ub21fbCA8ICh1bnNpZ25lZCBpbnQpZG1sX3BvdygyLCAxNykpOworCisJ
ZGlzcF9kbGdfcmVncy0+ZHN0X3lfcGVyX21ldGFfcm93X25vbV9jID0gZGlzcF9kbGdfcmVncy0+
ZHN0X3lfcGVyX21ldGFfcm93X25vbV9sOyAvLyBUT0RPOiBkY2MgZm9yIDQ6MjowIGlzIG5vdCBz
dXBwb3J0ZWQgaW4gZGNuMS4wLiAgYXNzaWduZWQgdG8gYmUgdGhlIHNhbWUgYXMgX2wgZm9yIG5v
dworCisJZG1sX3ByaW50KAorCQkJIkRNTDogVHJvdzogJWZ1c1xuIiwKKwkJCWxpbmVfdGltZV9p
bl91cyAqIChkb3VibGUpZHB0ZV9yb3dfaGVpZ2h0X2wgLyAoZG91YmxlKXZyYXRpb19sKTsKKwor
CWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dyb3VwX25vbV9sID0gKHVuc2lnbmVkIGlu
dCkgKChkb3VibGUpIGRwdGVfcm93X2hlaWdodF9sCisJCQkvIChkb3VibGUpIHZyYXRpb19sICog
KGRvdWJsZSkgaHRvdGFsICogcmVmX2ZyZXFfdG9fcGl4X2ZyZXEKKwkJCS8gKGRvdWJsZSkgZHB0
ZV9ncm91cHNfcGVyX3Jvd191Yl9sKTsKKwlpZiAoZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9w
dGVfZ3JvdXBfbm9tX2wgPj0gKHVuc2lnbmVkIGludCkgZG1sX3BvdygyLCAyMykpCisJCWRpc3Bf
ZGxnX3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dyb3VwX25vbV9sID0gZG1sX3BvdygyLCAyMykgLSAx
OworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfbWV0YV9jaHVua19ub21fbCA9ICh1bnNpZ25l
ZCBpbnQpICgoZG91YmxlKSBtZXRhX3Jvd19oZWlnaHRfbAorCQkJLyAoZG91YmxlKSB2cmF0aW9f
bCAqIChkb3VibGUpIGh0b3RhbCAqIHJlZl9mcmVxX3RvX3BpeF9mcmVxCisJCQkvIChkb3VibGUp
IG1ldGFfY2h1bmtzX3Blcl9yb3dfdWJfbCk7CisJaWYgKGRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19w
ZXJfbWV0YV9jaHVua19ub21fbCA+PSAodW5zaWduZWQgaW50KSBkbWxfcG93KDIsIDIzKSkKKwkJ
ZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX25vbV9sID0gZG1sX3BvdygyLCAy
MykgLSAxOworCisJaWYgKGR1YWxfcGxhbmUpIHsKKwkJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Bl
cl9wdGVfZ3JvdXBfbm9tX2MgPQorCQkJCSh1bnNpZ25lZCBpbnQpICgoZG91YmxlKSBkcHRlX3Jv
d19oZWlnaHRfYyAvIChkb3VibGUpIHZyYXRpb19jCisJCQkJCQkqIChkb3VibGUpIGh0b3RhbCAq
IHJlZl9mcmVxX3RvX3BpeF9mcmVxCisJCQkJCQkvIChkb3VibGUpIGRwdGVfZ3JvdXBzX3Blcl9y
b3dfdWJfYyk7CisJCWlmIChkaXNwX2RsZ19yZWdzLT5yZWZjeWNfcGVyX3B0ZV9ncm91cF9ub21f
YyA+PSAodW5zaWduZWQgaW50KSBkbWxfcG93KDIsIDIzKSkKKwkJCWRpc3BfZGxnX3JlZ3MtPnJl
ZmN5Y19wZXJfcHRlX2dyb3VwX25vbV9jID0gZG1sX3BvdygyLCAyMykgLSAxOworCisJCS8vIFRP
RE86IElzIHRoaXMgdGhlIHJpZ2h0IGNhbGN1bGF0aW9uPyBEb2VzIGh0b3RhbCBuZWVkIHRvIGJl
IGhhbHZlZD8KKwkJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX25vbV9jID0K
KwkJCQkodW5zaWduZWQgaW50KSAoKGRvdWJsZSkgbWV0YV9yb3dfaGVpZ2h0X2MgLyAoZG91Ymxl
KSB2cmF0aW9fYworCQkJCQkJKiAoZG91YmxlKSBodG90YWwgKiByZWZfZnJlcV90b19waXhfZnJl
cQorCQkJCQkJLyAoZG91YmxlKSBtZXRhX2NodW5rc19wZXJfcm93X3ViX2MpOworCQlpZiAoZGlz
cF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX25vbV9jID49ICh1bnNpZ25lZCBpbnQp
IGRtbF9wb3coMiwgMjMpKQorCQkJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5r
X25vbV9jID0gZG1sX3BvdygyLCAyMykgLSAxOworCX0KKworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5
Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfbCA9ICh1bnNpZ25lZCBpbnQpIGRtbF9mbG9vcigKKwkJ
CXJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfbCwgMSk7CisJZGlzcF9kbGdfcmVncy0+cmVm
Y3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2wgPSAodW5zaWduZWQgaW50KSBkbWxfZmxvb3IoCisJCQly
ZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfbCwgMSk7CisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPnJl
ZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfbCA8ICh1bnNpZ25lZCBpbnQpZG1sX3BvdygyLCAx
MykpOworCUFTU0VSVChkaXNwX2RsZ19yZWdzLT5yZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfbCA8
ICh1bnNpZ25lZCBpbnQpZG1sX3BvdygyLCAxMykpOworCisJZGlzcF9kbGdfcmVncy0+cmVmY3lj
X3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9jID0gKHVuc2lnbmVkIGludCkgZG1sX2Zsb29yKAorCQkJ
cmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9jLCAxKTsKKwlkaXNwX2RsZ19yZWdzLT5yZWZj
eWNfcGVyX2xpbmVfZGVsaXZlcnlfYyA9ICh1bnNpZ25lZCBpbnQpIGRtbF9mbG9vcigKKwkJCXJl
ZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9jLCAxKTsKKwlBU1NFUlQoZGlzcF9kbGdfcmVncy0+cmVm
Y3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9jIDwgKHVuc2lnbmVkIGludClkbWxfcG93KDIsIDEz
KSk7CisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9jIDwg
KHVuc2lnbmVkIGludClkbWxfcG93KDIsIDEzKSk7CisKKwlkaXNwX2RsZ19yZWdzLT5jaHVua19o
ZGxfYWRqdXN0X2N1cjAgPSAzOworCWRpc3BfZGxnX3JlZ3MtPmRzdF95X29mZnNldF9jdXIwID0g
MDsKKwlkaXNwX2RsZ19yZWdzLT5jaHVua19oZGxfYWRqdXN0X2N1cjEgPSAzOworCWRpc3BfZGxn
X3JlZ3MtPmRzdF95X29mZnNldF9jdXIxID0gMDsKKworCWRpc3BfZGxnX3JlZ3MtPnhmY19yZWdf
dHJhbnNmZXJfZGVsYXkgPSB4ZmNfdHJhbnNmZXJfZGVsYXk7CisJZGlzcF9kbGdfcmVncy0+eGZj
X3JlZ19wcmVjaGFyZ2VfZGVsYXkgPSB4ZmNfcHJlY2hhcmdlX2RlbGF5OworCWRpc3BfZGxnX3Jl
Z3MtPnhmY19yZWdfcmVtb3RlX3N1cmZhY2VfZmxpcF9sYXRlbmN5ID0geGZjX3JlbW90ZV9zdXJm
YWNlX2ZsaXBfbGF0ZW5jeTsKKwlkaXNwX2RsZ19yZWdzLT54ZmNfcmVnX3ByZWZldGNoX21hcmdp
biA9IGRtbF9jZWlsKAorCQkJeGZjX3ByZWZldGNoX21hcmdpbiAqIHJlZmNsa19mcmVxX2luX21o
eiwgMSk7CisKKwkvLyBzbGF2ZSBoYXMgdG8gaGF2ZSB0aGlzIHZhbHVlIGFsc28gc2V0IHRvIG9m
ZgorCWlmIChzcmMtPnhmY19lbmFibGUgJiYgIXNyYy0+eGZjX3NsYXZlKQorCQlkaXNwX2RsZ19y
ZWdzLT5kc3RfeV9kZWx0YV9kcnFfbGltaXQgPSBkbWxfY2VpbCh4ZmNfZHN0X3lfZGVsdGFfZHJx
X2xpbWl0LCAxKTsKKwllbHNlCisJCWRpc3BfZGxnX3JlZ3MtPmRzdF95X2RlbHRhX2RycV9saW1p
dCA9IDB4N2ZmZjsgLy8gb2ZmCisKKwlkaXNwX3R0dV9yZWdzLT5yZWZjeWNfcGVyX3JlcV9kZWxp
dmVyeV9wcmVfbCA9ICh1bnNpZ25lZCBpbnQpIChyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVf
bAorCQkJKiBkbWxfcG93KDIsIDEwKSk7CisJZGlzcF90dHVfcmVncy0+cmVmY3ljX3Blcl9yZXFf
ZGVsaXZlcnlfbCA9ICh1bnNpZ25lZCBpbnQpIChyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9sCisJ
CQkqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9yZWdzLT5yZWZjeWNfcGVyX3JlcV9kZWxp
dmVyeV9wcmVfYyA9ICh1bnNpZ25lZCBpbnQpIChyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVf
YworCQkJKiBkbWxfcG93KDIsIDEwKSk7CisJZGlzcF90dHVfcmVncy0+cmVmY3ljX3Blcl9yZXFf
ZGVsaXZlcnlfYyA9ICh1bnNpZ25lZCBpbnQpIChyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jCisJ
CQkqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9yZWdzLT5yZWZjeWNfcGVyX3JlcV9kZWxp
dmVyeV9wcmVfY3VyMCA9CisJCQkodW5zaWduZWQgaW50KSAocmVmY3ljX3Blcl9yZXFfZGVsaXZl
cnlfcHJlX2N1cjAgKiBkbWxfcG93KDIsIDEwKSk7CisJZGlzcF90dHVfcmVncy0+cmVmY3ljX3Bl
cl9yZXFfZGVsaXZlcnlfY3VyMCA9ICh1bnNpZ25lZCBpbnQpIChyZWZjeWNfcGVyX3JlcV9kZWxp
dmVyeV9jdXIwCisJCQkqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9yZWdzLT5yZWZjeWNf
cGVyX3JlcV9kZWxpdmVyeV9wcmVfY3VyMSA9CisJCQkodW5zaWduZWQgaW50KSAocmVmY3ljX3Bl
cl9yZXFfZGVsaXZlcnlfcHJlX2N1cjEgKiBkbWxfcG93KDIsIDEwKSk7CisJZGlzcF90dHVfcmVn
cy0+cmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfY3VyMSA9ICh1bnNpZ25lZCBpbnQpIChyZWZjeWNf
cGVyX3JlcV9kZWxpdmVyeV9jdXIxCisJCQkqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9y
ZWdzLT5xb3NfbGV2ZWxfbG93X3dtID0gMDsKKwlBU1NFUlQoZGlzcF90dHVfcmVncy0+cW9zX2xl
dmVsX2xvd193bSA8IGRtbF9wb3coMiwgMTQpKTsKKwlkaXNwX3R0dV9yZWdzLT5xb3NfbGV2ZWxf
aGlnaF93bSA9ICh1bnNpZ25lZCBpbnQpICg0LjAgKiAoZG91YmxlKSBodG90YWwKKwkJCSogcmVm
X2ZyZXFfdG9fcGl4X2ZyZXEpOworCUFTU0VSVChkaXNwX3R0dV9yZWdzLT5xb3NfbGV2ZWxfaGln
aF93bSA8IGRtbF9wb3coMiwgMTQpKTsKKworCWRpc3BfdHR1X3JlZ3MtPnFvc19sZXZlbF9mbGlw
ID0gMTQ7CisJZGlzcF90dHVfcmVncy0+cW9zX2xldmVsX2ZpeGVkX2wgPSA4OworCWRpc3BfdHR1
X3JlZ3MtPnFvc19sZXZlbF9maXhlZF9jID0gODsKKwlkaXNwX3R0dV9yZWdzLT5xb3NfbGV2ZWxf
Zml4ZWRfY3VyMCA9IDg7CisJZGlzcF90dHVfcmVncy0+cW9zX3JhbXBfZGlzYWJsZV9sID0gMDsK
KwlkaXNwX3R0dV9yZWdzLT5xb3NfcmFtcF9kaXNhYmxlX2MgPSAwOworCWRpc3BfdHR1X3JlZ3Mt
PnFvc19yYW1wX2Rpc2FibGVfY3VyMCA9IDA7CisKKwlkaXNwX3R0dV9yZWdzLT5taW5fdHR1X3Zi
bGFuayA9IG1pbl90dHVfdmJsYW5rICogcmVmY2xrX2ZyZXFfaW5fbWh6OworCUFTU0VSVChkaXNw
X3R0dV9yZWdzLT5taW5fdHR1X3ZibGFuayA8IGRtbF9wb3coMiwgMjQpKTsKKworCXByaW50X190
dHVfcmVnc19zdChtb2RlX2xpYiwgKmRpc3BfdHR1X3JlZ3MpOworCXByaW50X19kbGdfcmVnc19z
dChtb2RlX2xpYiwgKmRpc3BfZGxnX3JlZ3MpOworfQorCit2b2lkIGRtbDIxX3JxX2RsZ19nZXRf
ZGxnX3JlZygKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkaXNwbGF5
X2RsZ19yZWdzX3N0ICpkbGdfcmVncywKKwkJZGlzcGxheV90dHVfcmVnc19zdCAqdHR1X3JlZ3Ms
CisJCWRpc3BsYXlfZTJlX3BpcGVfcGFyYW1zX3N0ICplMmVfcGlwZV9wYXJhbSwKKwkJY29uc3Qg
dW5zaWduZWQgaW50IG51bV9waXBlcywKKwkJY29uc3QgdW5zaWduZWQgaW50IHBpcGVfaWR4LAor
CQljb25zdCBib29sIGNzdGF0ZV9lbiwKKwkJY29uc3QgYm9vbCBwc3RhdGVfZW4sCisJCWNvbnN0
IGJvb2wgdm1fZW4sCisJCWNvbnN0IGJvb2wgaWdub3JlX3ZpZXdwb3J0X3BvcywKKwkJY29uc3Qg
Ym9vbCBpbW1lZGlhdGVfZmxpcF9zdXBwb3J0KQoreworCWRpc3BsYXlfcnFfcGFyYW1zX3N0IHJx
X3BhcmFtID0gezB9OworCWRpc3BsYXlfZGxnX3N5c19wYXJhbXNfc3QgZGxnX3N5c19wYXJhbSA9
IHswfTsKKworCS8vIEdldCB3YXRlcm1hcmsgYW5kIFRleC4KKwlkbGdfc3lzX3BhcmFtLnRfdXJn
X3dtX3VzID0gZ2V0X3dtX3VyZ2VudChtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBl
cyk7CisJZGxnX3N5c19wYXJhbS5kZWVwc2xlZXBfZGNmY2xrX21oeiA9IGdldF9jbGtfZGNmX2Rl
ZXBzbGVlcCgKKwkJCW1vZGVfbGliLAorCQkJZTJlX3BpcGVfcGFyYW0sCisJCQludW1fcGlwZXMp
OworCWRsZ19zeXNfcGFyYW0udF9leHRyYV91cyA9IGdldF91cmdlbnRfZXh0cmFfbGF0ZW5jeSht
b2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcyk7CisJZGxnX3N5c19wYXJhbS5tZW1f
dHJpcF91cyA9IGdldF93bV9tZW1vcnlfdHJpcChtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51
bV9waXBlcyk7CisJZGxnX3N5c19wYXJhbS50X21jbGtfd21fdXMgPSBnZXRfd21fZHJhbV9jbG9j
a19jaGFuZ2UobW9kZV9saWIsIGUyZV9waXBlX3BhcmFtLCBudW1fcGlwZXMpOworCWRsZ19zeXNf
cGFyYW0udF9zcl93bV91cyA9IGdldF93bV9zdHV0dGVyX2VudGVyX2V4aXQobW9kZV9saWIsIGUy
ZV9waXBlX3BhcmFtLCBudW1fcGlwZXMpOworCWRsZ19zeXNfcGFyYW0udG90YWxfZmxpcF9idyA9
IGdldF90b3RhbF9pbW1lZGlhdGVfZmxpcF9idygKKwkJCW1vZGVfbGliLAorCQkJZTJlX3BpcGVf
cGFyYW0sCisJCQludW1fcGlwZXMpOworCWRsZ19zeXNfcGFyYW0udG90YWxfZmxpcF9ieXRlcyA9
IGdldF90b3RhbF9pbW1lZGlhdGVfZmxpcF9ieXRlcygKKwkJCW1vZGVfbGliLAorCQkJZTJlX3Bp
cGVfcGFyYW0sCisJCQludW1fcGlwZXMpOworCWRsZ19zeXNfcGFyYW0udF9zcnhfZGVsYXlfdXMg
PSBtb2RlX2xpYi0+aXAuZGNmY2xrX2NzdGF0ZV9sYXRlbmN5CisJCQkvIGRsZ19zeXNfcGFyYW0u
ZGVlcHNsZWVwX2RjZmNsa19taHo7IC8vIFRPRE86IERlcHJlY2F0ZWQKKworCXByaW50X19kbGdf
c3lzX3BhcmFtc19zdChtb2RlX2xpYiwgZGxnX3N5c19wYXJhbSk7CisKKwkvLyBzeXN0ZW0gcGFy
YW1ldGVyIGNhbGN1bGF0aW9uIGRvbmUKKworCWRtbF9wcmludCgiRE1MX0RMRzogQ2FsY3VsYXRp
b24gZm9yIHBpcGVbJWRdIHN0YXJ0XG5cbiIsIHBpcGVfaWR4KTsKKwlkbWxfcnFfZGxnX2dldF9y
cV9wYXJhbXMobW9kZV9saWIsICZycV9wYXJhbSwgZTJlX3BpcGVfcGFyYW1bcGlwZV9pZHhdLnBp
cGUpOworCWRtbF9ycV9kbGdfZ2V0X2RsZ19wYXJhbXMoCisJCQltb2RlX2xpYiwKKwkJCWUyZV9w
aXBlX3BhcmFtLAorCQkJbnVtX3BpcGVzLAorCQkJcGlwZV9pZHgsCisJCQlkbGdfcmVncywKKwkJ
CXR0dV9yZWdzLAorCQkJcnFfcGFyYW0uZGxnLAorCQkJZGxnX3N5c19wYXJhbSwKKwkJCWNzdGF0
ZV9lbiwKKwkJCXBzdGF0ZV9lbik7CisJZG1sX3ByaW50KCJETUxfRExHOiBDYWxjdWxhdGlvbiBm
b3IgcGlwZVslZF0gZW5kXG4iLCBwaXBlX2lkeCk7Cit9CisKK3ZvaWQgZG1sX3JxX2RsZ19nZXRf
YXJiX3BhcmFtcyhzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsIGRpc3BsYXlfYXJi
X3BhcmFtc19zdCAqYXJiX3BhcmFtKQoreworCW1lbXNldChhcmJfcGFyYW0sIDAsIHNpemVvZigq
YXJiX3BhcmFtKSk7CisJYXJiX3BhcmFtLT5tYXhfcmVxX291dHN0YW5kaW5nID0gMjU2OworCWFy
Yl9wYXJhbS0+bWluX3JlcV9vdXRzdGFuZGluZyA9IDY4OworCWFyYl9wYXJhbS0+c2F0X2xldmVs
X3VzID0gNjA7Cit9CisKK3N0YXRpYyB2b2lkIGNhbGN1bGF0ZV90dHVfY3Vyc29yKAorCQlzdHJ1
Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRvdWJsZSAqcmVmY3ljX3Blcl9yZXFf
ZGVsaXZlcnlfcHJlX2N1ciwKKwkJZG91YmxlICpyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIs
CisJCWRvdWJsZSByZWZjbGtfZnJlcV9pbl9taHosCisJCWRvdWJsZSByZWZfZnJlcV90b19waXhf
ZnJlcSwKKwkJZG91YmxlIGhzY2FsZV9waXhlbF9yYXRlX2wsCisJCWRvdWJsZSBoc2NsX3JhdGlv
LAorCQlkb3VibGUgdnJhdGlvX3ByZV9sLAorCQlkb3VibGUgdnJhdGlvX2wsCisJCXVuc2lnbmVk
IGludCBjdXJfd2lkdGgsCisJCWVudW0gY3Vyc29yX2JwcCBjdXJfYnBwKQoreworCXVuc2lnbmVk
IGludCBjdXJfc3JjX3dpZHRoID0gY3VyX3dpZHRoOworCXVuc2lnbmVkIGludCBjdXJfcmVxX3Np
emUgPSAwOworCXVuc2lnbmVkIGludCBjdXJfcmVxX3dpZHRoID0gMDsKKwlkb3VibGUgY3VyX3dp
ZHRoX3ViID0gMC4wOworCWRvdWJsZSBjdXJfcmVxX3Blcl93aWR0aCA9IDAuMDsKKwlkb3VibGUg
aGFjdGl2ZV9jdXIgPSAwLjA7CisKKwlBU1NFUlQoY3VyX3NyY193aWR0aCA8PSAyNTYpOworCisJ
KnJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIgPSAwLjA7CisJKnJlZmN5Y19wZXJfcmVx
X2RlbGl2ZXJ5X2N1ciA9IDAuMDsKKwlpZiAoY3VyX3NyY193aWR0aCA+IDApIHsKKwkJdW5zaWdu
ZWQgaW50IGN1cl9iaXRfcGVyX3BpeGVsID0gMDsKKworCQlpZiAoY3VyX2JwcCA9PSBkbV9jdXJf
MmJpdCkgeworCQkJY3VyX3JlcV9zaXplID0gNjQ7IC8vIGJ5dGUKKwkJCWN1cl9iaXRfcGVyX3Bp
eGVsID0gMjsKKwkJfSBlbHNlIHsgLy8gMzJiaXQKKwkJCWN1cl9iaXRfcGVyX3BpeGVsID0gMzI7
CisJCQlpZiAoY3VyX3NyY193aWR0aCA+PSAxICYmIGN1cl9zcmNfd2lkdGggPD0gMTYpCisJCQkJ
Y3VyX3JlcV9zaXplID0gNjQ7CisJCQllbHNlIGlmIChjdXJfc3JjX3dpZHRoID49IDE3ICYmIGN1
cl9zcmNfd2lkdGggPD0gMzEpCisJCQkJY3VyX3JlcV9zaXplID0gMTI4OworCQkJZWxzZQorCQkJ
CWN1cl9yZXFfc2l6ZSA9IDI1NjsKKwkJfQorCisJCWN1cl9yZXFfd2lkdGggPSAoZG91YmxlKSBj
dXJfcmVxX3NpemUgLyAoKGRvdWJsZSkgY3VyX2JpdF9wZXJfcGl4ZWwgLyA4LjApOworCQljdXJf
d2lkdGhfdWIgPSBkbWxfY2VpbCgoZG91YmxlKSBjdXJfc3JjX3dpZHRoIC8gKGRvdWJsZSkgY3Vy
X3JlcV93aWR0aCwgMSkKKwkJCQkqIChkb3VibGUpIGN1cl9yZXFfd2lkdGg7CisJCWN1cl9yZXFf
cGVyX3dpZHRoID0gY3VyX3dpZHRoX3ViIC8gKGRvdWJsZSkgY3VyX3JlcV93aWR0aDsKKwkJaGFj
dGl2ZV9jdXIgPSAoZG91YmxlKSBjdXJfc3JjX3dpZHRoIC8gaHNjbF9yYXRpbzsgLy8gRklYTUU6
IG9zd2luIHRvIHRoaW5rIGFib3V0IHdoYXQgdG8gZG8gZm9yIGN1cnNvcgorCisJCWlmICh2cmF0
aW9fcHJlX2wgPD0gMS4wKSB7CisJCQkqcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1ciA9
IGhhY3RpdmVfY3VyICogcmVmX2ZyZXFfdG9fcGl4X2ZyZXEKKwkJCQkJLyAoZG91YmxlKSBjdXJf
cmVxX3Blcl93aWR0aDsKKwkJfSBlbHNlIHsKKwkJCSpyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9w
cmVfY3VyID0gKGRvdWJsZSkgcmVmY2xrX2ZyZXFfaW5fbWh6CisJCQkJCSogKGRvdWJsZSkgY3Vy
X3NyY193aWR0aCAvIGhzY2FsZV9waXhlbF9yYXRlX2wKKwkJCQkJLyAoZG91YmxlKSBjdXJfcmVx
X3Blcl93aWR0aDsKKwkJfQorCisJCUFTU0VSVCgqcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJl
X2N1ciA8IGRtbF9wb3coMiwgMTMpKTsKKworCQlpZiAodnJhdGlvX2wgPD0gMS4wKSB7CisJCQkq
cmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfY3VyID0gaGFjdGl2ZV9jdXIgKiByZWZfZnJlcV90b19w
aXhfZnJlcQorCQkJCQkvIChkb3VibGUpIGN1cl9yZXFfcGVyX3dpZHRoOworCQl9IGVsc2Ugewor
CQkJKnJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2N1ciA9IChkb3VibGUpIHJlZmNsa19mcmVxX2lu
X21oegorCQkJCQkqIChkb3VibGUpIGN1cl9zcmNfd2lkdGggLyBoc2NhbGVfcGl4ZWxfcmF0ZV9s
CisJCQkJCS8gKGRvdWJsZSkgY3VyX3JlcV9wZXJfd2lkdGg7CisJCX0KKworCQlkbWxfcHJpbnQo
CisJCQkJIkRNTF9ETEc6ICVzOiBjdXJfcmVxX3dpZHRoICAgICAgICAgICAgICAgICAgICAgPSAl
ZFxuIiwKKwkJCQlfX2Z1bmNfXywKKwkJCQljdXJfcmVxX3dpZHRoKTsKKwkJZG1sX3ByaW50KAor
CQkJCSJETUxfRExHOiAlczogY3VyX3dpZHRoX3ViICAgICAgICAgICAgICAgICAgICAgID0gJTMu
MmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJY3VyX3dpZHRoX3ViKTsKKwkJZG1sX3ByaW50KAor
CQkJCSJETUxfRExHOiAlczogY3VyX3JlcV9wZXJfd2lkdGggICAgICAgICAgICAgICAgID0gJTMu
MmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJY3VyX3JlcV9wZXJfd2lkdGgpOworCQlkbWxfcHJp
bnQoCisJCQkJIkRNTF9ETEc6ICVzOiBoYWN0aXZlX2N1ciAgICAgICAgICAgICAgICAgICAgICAg
PSAlMy4yZlxuIiwKKwkJCQlfX2Z1bmNfXywKKwkJCQloYWN0aXZlX2N1cik7CisJCWRtbF9wcmlu
dCgKKwkJCQkiRE1MX0RMRzogJXM6IHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIgICA9
ICUzLjJmXG4iLAorCQkJCV9fZnVuY19fLAorCQkJCSpyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9w
cmVfY3VyKTsKKwkJZG1sX3ByaW50KAorCQkJCSJETUxfRExHOiAlczogcmVmY3ljX3Blcl9yZXFf
ZGVsaXZlcnlfY3VyICAgICAgID0gJTMuMmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJKnJlZmN5
Y19wZXJfcmVxX2RlbGl2ZXJ5X2N1cik7CisKKwkJQVNTRVJUKCpyZWZjeWNfcGVyX3JlcV9kZWxp
dmVyeV9jdXIgPCBkbWxfcG93KDIsIDEzKSk7CisJfQorfQorCisjZW5kaWYKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGNuMjEvZGlzcGxheV9ycV9kbGdf
Y2FsY18yMS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24yMS9kaXNw
bGF5X3JxX2RsZ19jYWxjXzIxLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAw
MDAwLi44M2U5NWY4Y2JmZjIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvZG1sL2RjbjIxL2Rpc3BsYXlfcnFfZGxnX2NhbGNfMjEuaApAQCAtMCwwICsx
LDczIEBACisvKgorICogQ29weXJpZ2h0IDIwMTcgQWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5j
LgorICoKKyAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0
byBhbnkgcGVyc29uIG9idGFpbmluZyBhCisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFz
c29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVh
bCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQg
bGltaXRhdGlvbgorICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1
Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2Yg
dGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3
YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRp
dGlvbnM6CisgKgorICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlz
c2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Igc3Vic3Rh
bnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQ
Uk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9S
CisgKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVT
IE9GIE1FUkNIQU5UQUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NF
IEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIENPUFlSSUdI
VCBIT0xERVIoUykgT1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VT
IE9SCisgKiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNU
LCBUT1JUIE9SIE9USEVSV0lTRSwKKyAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5F
Q1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgorICogT1RIRVIgREVBTElOR1Mg
SU4gVEhFIFNPRlRXQVJFLgorICoKKyAqIEF1dGhvcnM6IEFNRAorICoKKyAqLworCisjaWZuZGVm
IF9fRE1MMjFfRElTUExBWV9SUV9ETEdfQ0FMQ19IX18KKyNkZWZpbmUgX19ETUwyMV9ESVNQTEFZ
X1JRX0RMR19DQUxDX0hfXworCisjaW5jbHVkZSAiLi4vZG1sX2NvbW1vbl9kZWZzLmgiCisjaW5j
bHVkZSAiLi4vZGlzcGxheV9ycV9kbGdfaGVscGVycy5oIgorCitzdHJ1Y3QgZGlzcGxheV9tb2Rl
X2xpYjsKKworCisvLyBGdW5jdGlvbjogZG1sX3JxX2RsZ19nZXRfcnFfcmVnCisvLyAgTWFpbiBl
bnRyeSBwb2ludCBmb3IgdGVzdCB0byBnZXQgdGhlIHJlZ2lzdGVyIHZhbHVlcyBvdXQgb2YgdGhp
cyBETUwgY2xhc3MuCisvLyAgVGhpcyBmdW5jdGlvbiBjYWxscyA8Z2V0X3JxX3BhcmFtPiBhbmQg
PGV4dHJhY3RfcnFfcmVncz4gZnVuY3Rpb25zIHRvIGNhbGN1bGF0ZQorLy8gIGFuZCB0aGVuIHBv
cHVsYXRlIHRoZSBycV9yZWdzIHN0cnVjdAorLy8gSW5wdXQ6CisvLyAgcGlwZV9zcmNfcGFyYW0g
LSBwaXBlIHNvdXJjZSBjb25maWd1cmF0aW9uIChlLmcuIHZwLCBwaXRjaCwgZXRjLikKKy8vIE91
dHB1dDoKKy8vICBycV9yZWdzIC0gc3RydWN0IHRoYXQgaG9sZHMgYWxsIHRoZSBSUSByZWdpc3Rl
cnMgZmllbGQgdmFsdWUuCisvLyAgICAgICAgICAgIFNlZSBhbHNvOiA8ZGlzcGxheV9ycV9yZWdz
X3N0Pgordm9pZCBkbWwyMV9ycV9kbGdfZ2V0X3JxX3JlZygKKwkJc3RydWN0IGRpc3BsYXlfbW9k
ZV9saWIgKm1vZGVfbGliLAorCQlkaXNwbGF5X3JxX3JlZ3Nfc3QgKnJxX3JlZ3MsCisJCWNvbnN0
IGRpc3BsYXlfcGlwZV9wYXJhbXNfc3QgcGlwZV9wYXJhbSk7CisKKy8vIEZ1bmN0aW9uOiBkbWxf
cnFfZGxnX2dldF9kbGdfcmVnCisvLyAgIENhbGN1bGF0ZSBhbmQgcmV0dXJuIERMRyBhbmQgVFRV
IHJlZ2lzdGVyIHN0cnVjdCBnaXZlbiB0aGUgc3lzdGVtIHNldHRpbmcKKy8vIE91dHB1dDoKKy8v
ICBkbGdfcmVncyAtIG91dHB1dCBETEcgcmVnaXN0ZXIgc3RydWN0CisvLyAgdHR1X3JlZ3MgLSBv
dXRwdXQgRExHIFRUVSByZWdpc3RlciBzdHJ1Y3QKKy8vIElucHV0OgorLy8gIGUyZV9waXBlX3Bh
cmFtIC0gImNvbXBhY3RlZCIgYXJyYXkgb2YgZTJlIHBpcGUgcGFyYW0gc3RydWN0CisvLyAgbnVt
X3BpcGVzIC0gbnVtIG9mIGFjdGl2ZSAicGlwZSIgb3IgInJvdXRlIgorLy8gIHBpcGVfaWR4IC0g
aW5kZXggdGhhdCBpZGVudGlmaWVzIHRoZSBlMmVfcGlwZV9wYXJhbSB0aGF0IGNvcnJlc3BvbmRp
bmcgdG8gdGhpcyBkbGcKKy8vICBjc3RhdGUgLSAwOiB3aGVuIGNhbGN1bGF0ZSBtaW5fdHR1X3Zi
bGFuayBpdCBpcyBhc3N1bWVkIGNzdGF0ZSBpcyBub3QgcmVxdWlyZWQuIDE6IE5vcm1hbCBtb2Rl
LCBjc3RhdGUgaXMgY29uc2lkZXJlZC4KKy8vICAgICAgICAgICBBZGRlZCBmb3IgbGVnYWN5IG9y
IHVucmVhbGlzdGljIHRpbWluZyB0ZXN0cy4KK3ZvaWQgZG1sMjFfcnFfZGxnX2dldF9kbGdfcmVn
KAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRpc3BsYXlfZGxnX3Jl
Z3Nfc3QgKmRsZ19yZWdzLAorCQlkaXNwbGF5X3R0dV9yZWdzX3N0ICp0dHVfcmVncywKKwkJZGlz
cGxheV9lMmVfcGlwZV9wYXJhbXNfc3QgKmUyZV9waXBlX3BhcmFtLAorCQljb25zdCB1bnNpZ25l
ZCBpbnQgbnVtX3BpcGVzLAorCQljb25zdCB1bnNpZ25lZCBpbnQgcGlwZV9pZHgsCisJCWNvbnN0
IGJvb2wgY3N0YXRlX2VuLAorCQljb25zdCBib29sIHBzdGF0ZV9lbiwKKwkJY29uc3QgYm9vbCB2
bV9lbiwKKwkJY29uc3QgYm9vbCBpZ25vcmVfdmlld3BvcnRfcG9zLAorCQljb25zdCBib29sIGlt
bWVkaWF0ZV9mbGlwX3N1cHBvcnQpOworCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5oIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kaXNwbGF5X21vZGVfbGliLmgKaW5kZXggODcwNzE2ZTNj
MTMyLi5kOGM1OWFhMzU2YjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5oCkBAIC0zOCw2ICszOCw5IEBAIGVudW0gZG1s
X3Byb2plY3QgewogCURNTF9QUk9KRUNUX05BVkkxMCwKIAlETUxfUFJPSkVDVF9OQVZJMTB2MiwK
ICNlbmRpZgorI2lmZGVmIENPTkZJR19EUk1fQU1EX0RDX0RDTjJfMQorCURNTF9QUk9KRUNUX0RD
TjIxLAorI2VuZGlmCiB9OwogCiBzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYjsKLS0gCjIuMjAuMQoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBt
YWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
