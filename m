Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5E0E733AB8
	for <lists+amd-gfx@lfdr.de>; Tue,  4 Jun 2019 00:05:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9FC2D892F8;
	Mon,  3 Jun 2019 22:05:13 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM01-BN3-obe.outbound.protection.outlook.com
 (mail-eopbgr740049.outbound.protection.outlook.com [40.107.74.49])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2388F892F8
 for <amd-gfx@lists.freedesktop.org>; Mon,  3 Jun 2019 22:05:12 +0000 (UTC)
Received: from DM6PR12MB3947.namprd12.prod.outlook.com (10.255.174.156) by
 DM6PR12MB2602.namprd12.prod.outlook.com (20.176.116.11) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1943.22; Mon, 3 Jun 2019 22:04:58 +0000
Received: from DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::5964:8c3c:1b5b:c480]) by DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::5964:8c3c:1b5b:c480%2]) with mapi id 15.20.1922.021; Mon, 3 Jun 2019
 22:04:58 +0000
From: "Kuehling, Felix" <Felix.Kuehling@amd.com>
To: "Zeng, Oak" <Oak.Zeng@amd.com>, "amd-gfx@lists.freedesktop.org"
 <amd-gfx@lists.freedesktop.org>
Subject: Re: [PATCH 3/5] drm/amdkfd: Refactor create_queue_nocpsch
Thread-Topic: [PATCH 3/5] drm/amdkfd: Refactor create_queue_nocpsch
Thread-Index: AQHVGjTq+QyhccARI0mxS2qjU2231qaKfFiA
Date: Mon, 3 Jun 2019 22:04:58 +0000
Message-ID: <10b7f416-df5e-6fa2-930f-71af79e67974@amd.com>
References: <1559584248-12115-1-git-send-email-Oak.Zeng@amd.com>
 <1559584248-12115-3-git-send-email-Oak.Zeng@amd.com>
In-Reply-To: <1559584248-12115-3-git-send-email-Oak.Zeng@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [165.204.55.251]
user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.0
x-clientproxiedby: YTOPR0101CA0017.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:15::30) To DM6PR12MB3947.namprd12.prod.outlook.com
 (2603:10b6:5:1cb::28)
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: ff0d3596-e309-4102-9581-08d6e86f848d
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);
 SRVR:DM6PR12MB2602; 
x-ms-traffictypediagnostic: DM6PR12MB2602:
x-microsoft-antispam-prvs: <DM6PR12MB2602F9C0D77FB913897CFF3392140@DM6PR12MB2602.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:8882;
x-forefront-prvs: 0057EE387C
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(136003)(39860400002)(366004)(376002)(346002)(396003)(51234002)(199004)(189003)(53936002)(6246003)(71200400001)(14454004)(71190400001)(81166006)(478600001)(81156014)(66066001)(65806001)(65956001)(8936002)(68736007)(14444005)(476003)(7736002)(25786009)(8676002)(256004)(305945005)(446003)(76176011)(6506007)(386003)(11346002)(229853002)(2906002)(2616005)(64126003)(72206003)(53546011)(52116002)(31696002)(186003)(102836004)(486006)(5660300002)(26005)(64756008)(66556008)(66476007)(66446008)(6116002)(3846002)(6436002)(66946007)(6512007)(31686004)(36756003)(58126008)(316002)(110136005)(99286004)(65826007)(86362001)(73956011)(2501003)(6486002);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM6PR12MB2602;
 H:DM6PR12MB3947.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: QnUOl6kexE1IG93j2HUb875kbJythaWkVRkp1b2k7Qto6OECR2oV+TCZBN0OXcrac0wvEuJ9qEWwCvD74rJD2PeVcP1WCidP0EHIK1eTt3y5Wv97lYtn6JPFRpsNg84tdKzO9MDABgVpc2rwu69jaLQkFwqaMjMbBQHJU4L4yuxtHyGR7YaBBbWlwbGGcNSSp8/wBdr8hLzi3yfwX7I3wSU3OyVPkcVqAiJW50wLwsz+s1NU2YLPPOB5eN4gU82rPx9dt4ijg/TRltLIQjS/gFe9SPH9K8Gv/F+DR6gUtnNqQ3hO2EhAohLdqbCxd7lFCOhS3E04Ocs7Y3UqN7UaViJYuQrSFVU7FvkehYq04VJFbm2KiOxL40qon0xnD9VY72r9FJE83t5HFKnsnHf2Wzb9Jy3U7dLS44cxSKgV3Mo=
Content-ID: <38C1ADE442E57A46ACC41F8E5D45C18D@namprd12.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: ff0d3596-e309-4102-9581-08d6e86f848d
X-MS-Exchange-CrossTenant-originalarrivaltime: 03 Jun 2019 22:04:58.5757 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: fkuehlin@amd.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB2602
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=E8UzynTYEHgYd6byUsFDJ6IBInwhaPBlm665xTDL7G0=;
 b=mPRt7Ha6Uxhn4f70s5wGAc3ndsqv5T7mKEDe32g5iqN4rTeOKOlTpp7JM35T+Dd+kJhrXFF3S4JCBanZahX93mAJ0g+us0onnPg/efga7a92pikPpC+se8V/81bxJFf14k/UAonVrdIUMtOUo7MMVM5IX7OJmhsA2hb32waxrRk=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Felix.Kuehling@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

T24gMjAxOS0wNi0wMyAxOjUxIHAubS4sIFplbmcsIE9hayB3cm90ZToNCj4gVGhpcyBpcyBwcmVw
YXJlIHdvcmsgdG8gZml4IGEgY2lyY3VsYXIgbG9jayBkZXBlbmRlbmN5Lg0KPiBObyBsb2dpYyBj
aGFuZ2UNCj4NCj4gQ2hhbmdlLUlkOiBJNGUwZWU5MTgyNjBlNzc4MGRlOTcyZGQ3MWY0Y2U3ODdi
NGY2ZGRlOQ0KPiBTaWduZWQtb2ZmLWJ5OiBPYWsgWmVuZyA8T2FrLlplbmdAYW1kLmNvbT4NCj4g
LS0tDQo+ICAgLi4uL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfZGV2aWNlX3F1ZXVlX21hbmFnZXIu
YyAgfCAxNzEgKysrKysrKy0tLS0tLS0tLS0tLS0tDQo+ICAgMSBmaWxlIGNoYW5nZWQsIDU4IGlu
c2VydGlvbnMoKyksIDExMyBkZWxldGlvbnMoLSkNCj4NCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5jIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmMNCj4gaW5kZXggZGMx
YTcwYi4uMDY2NTRkZSAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQv
a2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmMNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRrZmQva2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmMNCj4gQEAgLTQyLDEwICs0Miw2IEBADQo+
ICAgc3RhdGljIGludCBzZXRfcGFzaWRfdm1pZF9tYXBwaW5nKHN0cnVjdCBkZXZpY2VfcXVldWVf
bWFuYWdlciAqZHFtLA0KPiAgIAkJCQkJdW5zaWduZWQgaW50IHBhc2lkLCB1bnNpZ25lZCBpbnQg
dm1pZCk7DQo+ICAgDQo+IC1zdGF0aWMgaW50IGNyZWF0ZV9jb21wdXRlX3F1ZXVlX25vY3BzY2go
c3RydWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0sDQo+IC0JCQkJCXN0cnVjdCBxdWV1ZSAq
cSwNCj4gLQkJCQkJc3RydWN0IHFjbV9wcm9jZXNzX2RldmljZSAqcXBkKTsNCj4gLQ0KPiAgIHN0
YXRpYyBpbnQgZXhlY3V0ZV9xdWV1ZXNfY3BzY2goc3RydWN0IGRldmljZV9xdWV1ZV9tYW5hZ2Vy
ICpkcW0sDQo+ICAgCQkJCWVudW0ga2ZkX3VubWFwX3F1ZXVlc19maWx0ZXIgZmlsdGVyLA0KPiAg
IAkJCQl1aW50MzJfdCBmaWx0ZXJfcGFyYW0pOw0KPiBAQCAtNTUsMTMgKzUxLDE0IEBAIHN0YXRp
YyBpbnQgdW5tYXBfcXVldWVzX2Nwc2NoKHN0cnVjdCBkZXZpY2VfcXVldWVfbWFuYWdlciAqZHFt
LA0KPiAgIA0KPiAgIHN0YXRpYyBpbnQgbWFwX3F1ZXVlc19jcHNjaChzdHJ1Y3QgZGV2aWNlX3F1
ZXVlX21hbmFnZXIgKmRxbSk7DQo+ICAgDQo+IC1zdGF0aWMgaW50IGNyZWF0ZV9zZG1hX3F1ZXVl
X25vY3BzY2goc3RydWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0sDQo+IC0JCQkJCXN0cnVj
dCBxdWV1ZSAqcSwNCj4gLQkJCQkJc3RydWN0IHFjbV9wcm9jZXNzX2RldmljZSAqcXBkKTsNCj4g
LQ0KPiAgIHN0YXRpYyB2b2lkIGRlYWxsb2NhdGVfc2RtYV9xdWV1ZShzdHJ1Y3QgZGV2aWNlX3F1
ZXVlX21hbmFnZXIgKmRxbSwNCj4gICAJCQkJc3RydWN0IHF1ZXVlICpxKTsNCj4gICANCj4gK3N0
YXRpYyBpbmxpbmUgdm9pZCBkZWFsbG9jYXRlX2hxZChzdHJ1Y3QgZGV2aWNlX3F1ZXVlX21hbmFn
ZXIgKmRxbSwNCj4gKwkJCQlzdHJ1Y3QgcXVldWUgKnEpOw0KPiArc3RhdGljIGludCBhbGxvY2F0
ZV9ocWQoc3RydWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0sIHN0cnVjdCBxdWV1ZSAqcSk7
DQo+ICtzdGF0aWMgaW50IGFsbG9jYXRlX3NkbWFfcXVldWUoc3RydWN0IGRldmljZV9xdWV1ZV9t
YW5hZ2VyICpkcW0sDQo+ICsJCQkJc3RydWN0IHF1ZXVlICpxKTsNCj4gICBzdGF0aWMgdm9pZCBr
ZmRfcHJvY2Vzc19od19leGNlcHRpb24oc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKTsNCj4gICAN
Cj4gICBzdGF0aWMgaW5saW5lDQo+IEBAIC0yNjksNiArMjY2LDcgQEAgc3RhdGljIGludCBjcmVh
dGVfcXVldWVfbm9jcHNjaChzdHJ1Y3QgZGV2aWNlX3F1ZXVlX21hbmFnZXIgKmRxbSwNCj4gICAJ
CQkJc3RydWN0IHF1ZXVlICpxLA0KPiAgIAkJCQlzdHJ1Y3QgcWNtX3Byb2Nlc3NfZGV2aWNlICpx
cGQpDQo+ICAgew0KPiArCXN0cnVjdCBtcWRfbWFuYWdlciAqbXFkX21ncjsNCj4gICAJaW50IHJl
dHZhbDsNCj4gICANCj4gICAJcHJpbnRfcXVldWUocSk7DQo+IEBAIC0zMDAsMTggKzI5OCw0NiBA
QCBzdGF0aWMgaW50IGNyZWF0ZV9xdWV1ZV9ub2Nwc2NoKHN0cnVjdCBkZXZpY2VfcXVldWVfbWFu
YWdlciAqZHFtLA0KPiAgIAlxLT5wcm9wZXJ0aWVzLnRiYV9hZGRyID0gcXBkLT50YmFfYWRkcjsN
Cj4gICAJcS0+cHJvcGVydGllcy50bWFfYWRkciA9IHFwZC0+dG1hX2FkZHI7DQo+ICAgDQo+ICsJ
bXFkX21nciA9IGRxbS0+bXFkX21ncnNbZ2V0X21xZF90eXBlX2Zyb21fcXVldWVfdHlwZSgNCj4g
KwkJCXEtPnByb3BlcnRpZXMudHlwZSldOw0KPiArCWlmIChxLT5wcm9wZXJ0aWVzLnR5cGUgPT0g
S0ZEX1FVRVVFX1RZUEVfQ09NUFVURSkgew0KPiArCQlyZXR2YWwgPSBhbGxvY2F0ZV9ocWQoZHFt
LCBxKTsNCj4gKwkJaWYgKHJldHZhbCkNCj4gKwkJCWdvdG8gZGVhbGxvY2F0ZV92bWlkOw0KPiAr
CX0gZWxzZSBpZiAocS0+cHJvcGVydGllcy50eXBlID09IEtGRF9RVUVVRV9UWVBFX1NETUEgfHwN
Cj4gKwkJcS0+cHJvcGVydGllcy50eXBlID09IEtGRF9RVUVVRV9UWVBFX1NETUFfWEdNSSkgew0K
PiArCQlyZXR2YWwgPSBhbGxvY2F0ZV9zZG1hX3F1ZXVlKGRxbSwgcSk7DQo+ICsJCWlmIChyZXR2
YWwpDQo+ICsJCQlnb3RvIGRlYWxsb2NhdGVfdm1pZDsNCj4gKwkJZHFtLT5hc2ljX29wcy5pbml0
X3NkbWFfdm0oZHFtLCBxLCBxcGQpOw0KPiArCX0NCj4gKw0KPiArCXJldHZhbCA9IGFsbG9jYXRl
X2Rvb3JiZWxsKHFwZCwgcSk7DQo+ICsJaWYgKHJldHZhbCkNCj4gKwkJZ290byBvdXRfZGVhbGxv
Y2F0ZV9ocWQ7DQo+ICsNCj4gKwlyZXR2YWwgPSBtcWRfbWdyLT5pbml0X21xZChtcWRfbWdyLCAm
cS0+bXFkLCAmcS0+bXFkX21lbV9vYmosDQo+ICsJCQkJJnEtPmdhcnRfbXFkX2FkZHIsICZxLT5w
cm9wZXJ0aWVzKTsNCj4gKwlpZiAocmV0dmFsKQ0KPiArCQlnb3RvIG91dF9kZWFsbG9jYXRlX2Rv
b3JiZWxsOw0KPiArDQo+ICsJcHJfZGVidWcoIkxvYWRpbmcgbXFkIHRvIGhxZCBvbiBwaXBlICVk
LCBxdWV1ZSAlZFxuIiwNCj4gKwkJCXEtPnBpcGUsIHEtPnF1ZXVlKTsNCg0KVGhpcyBtZXNzYWdl
IG9ubHkgbWFrZXMgc2Vuc2UgZm9yIGNvbXB1dGUgcXVldWVzLiBNYXliZSBtb3ZlIHRoaXMgdXAg
dG8gDQpqdXN0IGFmdGVyIGFsbG9jYXRlX2hxZCwgYmVjYXVzZSB0aGF0J3Mgd2hhdCBhc3NpZ25l
cyBxLT5waXBlIGFuZCBxLT5xdWV1ZS4NCg0KDQo+ICsNCj4gICAJaWYgKHEtPnByb3BlcnRpZXMu
dHlwZSA9PSBLRkRfUVVFVUVfVFlQRV9DT01QVVRFKQ0KPiAtCQlyZXR2YWwgPSBjcmVhdGVfY29t
cHV0ZV9xdWV1ZV9ub2Nwc2NoKGRxbSwgcSwgcXBkKTsNCj4gLQllbHNlIGlmIChxLT5wcm9wZXJ0
aWVzLnR5cGUgPT0gS0ZEX1FVRVVFX1RZUEVfU0RNQSB8fA0KPiAtCQkJcS0+cHJvcGVydGllcy50
eXBlID09IEtGRF9RVUVVRV9UWVBFX1NETUFfWEdNSSkNCj4gLQkJcmV0dmFsID0gY3JlYXRlX3Nk
bWFfcXVldWVfbm9jcHNjaChkcW0sIHEsIHFwZCk7DQo+IC0JZWxzZQ0KPiAtCQlyZXR2YWwgPSAt
RUlOVkFMOw0KPiArCQlkcW0tPmRldi0+a2ZkMmtnZC0+c2V0X3NjcmF0Y2hfYmFja2luZ192YSgN
Cj4gKwkJCWRxbS0+ZGV2LT5rZ2QsIHFwZC0+c2hfaGlkZGVuX3ByaXZhdGVfYmFzZSwgcXBkLT52
bWlkKTsNCg0KTm90IHN1cmUgd2h5IHRoaXMgaXMgaGVyZS4gSSB0aGluayBpdCB3b3VsZCBtYWtl
IG1vcmUgc2Vuc2UgaW4gDQphbGxvY2F0ZV92bWlkLiBOb3JtYWxseSB0aGlzIGlzIGNhbGxlZCB3
aGVuIHRoZSBzY3JhdGNoLWJhY2tpbmcgVkEgaXMgDQpzZXQgaW4gdGhlIGlvY3RsIGZ1bmN0aW9u
LiBVbmxlc3Mgbm8gVk1JRCBoYXMgYmVlbiBhc3NpZ25lZCB0byB0aGUgDQpwcm9jZXNzIHlldC4g
U28gc2V0dGluZyB0aGlzIHdoZW4gdGhlIFZNSUQgaXMgYXNzaWduZWQgaW4gYWxsb2NhdGVfdm1p
ZCANCnNlZW1zIHRvIG1ha2UgdGhlIG1vc3Qgc2Vuc2UuDQoNCg0KPiAgIA0KPiAtCWlmIChyZXR2
YWwpIHsNCj4gLQkJaWYgKGxpc3RfZW1wdHkoJnFwZC0+cXVldWVzX2xpc3QpKQ0KPiAtCQkJZGVh
bGxvY2F0ZV92bWlkKGRxbSwgcXBkLCBxKTsNCj4gLQkJZ290byBvdXRfdW5sb2NrOw0KPiArCWlm
IChxLT5wcm9wZXJ0aWVzLmlzX2FjdGl2ZSkgew0KPiArDQo+ICsJCWlmIChXQVJOKHEtPnByb2Nl
c3MtPm1tICE9IGN1cnJlbnQtPm1tLA0KPiArCQkJCQkic2hvdWxkIG9ubHkgcnVuIGluIHVzZXIg
dGhyZWFkIikpDQo+ICsJCQlyZXR2YWwgPSAtRUZBVUxUOw0KPiArCQllbHNlDQo+ICsJCQlyZXR2
YWwgPSBtcWRfbWdyLT5sb2FkX21xZChtcWRfbWdyLCBxLT5tcWQsIHEtPnBpcGUsDQo+ICsJCQkJ
CXEtPnF1ZXVlLCAmcS0+cHJvcGVydGllcywgY3VycmVudC0+bW0pOw0KPiArCQlpZiAocmV0dmFs
KQ0KPiArCQkJZ290byBvdXRfdW5pbml0X21xZDsNCj4gICAJfQ0KPiAgIA0KPiAgIAlsaXN0X2Fk
ZCgmcS0+bGlzdCwgJnFwZC0+cXVldWVzX2xpc3QpOw0KPiBAQCAtMzMxLDcgKzM1NywyMSBAQCBz
dGF0aWMgaW50IGNyZWF0ZV9xdWV1ZV9ub2Nwc2NoKHN0cnVjdCBkZXZpY2VfcXVldWVfbWFuYWdl
ciAqZHFtLA0KPiAgIAlkcW0tPnRvdGFsX3F1ZXVlX2NvdW50Kys7DQo+ICAgCXByX2RlYnVnKCJU
b3RhbCBvZiAlZCBxdWV1ZXMgYXJlIGFjY291bnRhYmxlIHNvIGZhclxuIiwNCj4gICAJCQlkcW0t
PnRvdGFsX3F1ZXVlX2NvdW50KTsNCj4gKwlnb3RvIG91dF91bmxvY2s7DQo+ICAgDQo+ICtvdXRf
dW5pbml0X21xZDoNCj4gKwltcWRfbWdyLT51bmluaXRfbXFkKG1xZF9tZ3IsIHEtPm1xZCwgcS0+
bXFkX21lbV9vYmopOw0KPiArb3V0X2RlYWxsb2NhdGVfZG9vcmJlbGw6DQo+ICsJZGVhbGxvY2F0
ZV9kb29yYmVsbChxcGQsIHEpOw0KPiArb3V0X2RlYWxsb2NhdGVfaHFkOg0KPiArCWlmIChxLT5w
cm9wZXJ0aWVzLnR5cGUgPT0gS0ZEX1FVRVVFX1RZUEVfQ09NUFVURSkNCj4gKwkJZGVhbGxvY2F0
ZV9ocWQoZHFtLCBxKTsNCj4gKwllbHNlIGlmIChxLT5wcm9wZXJ0aWVzLnR5cGUgPT0gS0ZEX1FV
RVVFX1RZUEVfU0RNQSB8fA0KPiArCQlxLT5wcm9wZXJ0aWVzLnR5cGUgPT0gS0ZEX1FVRVVFX1RZ
UEVfU0RNQV9YR01JKQ0KPiArCQlkZWFsbG9jYXRlX3NkbWFfcXVldWUoZHFtLCBxKTsNCj4gK2Rl
YWxsb2NhdGVfdm1pZDoNCj4gKwlpZiAobGlzdF9lbXB0eSgmcXBkLT5xdWV1ZXNfbGlzdCkpDQo+
ICsJCWRlYWxsb2NhdGVfdm1pZChkcW0sIHFwZCwgcSk7DQo+ICAgb3V0X3VubG9jazoNCj4gICAJ
ZHFtX3VubG9jayhkcW0pOw0KPiAgIAlyZXR1cm4gcmV0dmFsOw0KPiBAQCAtMzc3LDU4ICs0MTcs
NiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgZGVhbGxvY2F0ZV9ocWQoc3RydWN0IGRldmljZV9xdWV1
ZV9tYW5hZ2VyICpkcW0sDQo+ICAgCWRxbS0+YWxsb2NhdGVkX3F1ZXVlc1txLT5waXBlXSB8PSAo
MSA8PCBxLT5xdWV1ZSk7DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCBjcmVhdGVfY29tcHV0
ZV9xdWV1ZV9ub2Nwc2NoKHN0cnVjdCBkZXZpY2VfcXVldWVfbWFuYWdlciAqZHFtLA0KPiAtCQkJ
CQlzdHJ1Y3QgcXVldWUgKnEsDQo+IC0JCQkJCXN0cnVjdCBxY21fcHJvY2Vzc19kZXZpY2UgKnFw
ZCkNCj4gLXsNCj4gLQlzdHJ1Y3QgbXFkX21hbmFnZXIgKm1xZF9tZ3I7DQo+IC0JaW50IHJldHZh
bDsNCj4gLQ0KPiAtCW1xZF9tZ3IgPSBkcW0tPm1xZF9tZ3JzW0tGRF9NUURfVFlQRV9DT01QVVRF
XTsNCj4gLQ0KPiAtCXJldHZhbCA9IGFsbG9jYXRlX2hxZChkcW0sIHEpOw0KPiAtCWlmIChyZXR2
YWwpDQo+IC0JCXJldHVybiByZXR2YWw7DQo+IC0NCj4gLQlyZXR2YWwgPSBhbGxvY2F0ZV9kb29y
YmVsbChxcGQsIHEpOw0KPiAtCWlmIChyZXR2YWwpDQo+IC0JCWdvdG8gb3V0X2RlYWxsb2NhdGVf
aHFkOw0KPiAtDQo+IC0JcmV0dmFsID0gbXFkX21nci0+aW5pdF9tcWQobXFkX21nciwgJnEtPm1x
ZCwgJnEtPm1xZF9tZW1fb2JqLA0KPiAtCQkJCSZxLT5nYXJ0X21xZF9hZGRyLCAmcS0+cHJvcGVy
dGllcyk7DQo+IC0JaWYgKHJldHZhbCkNCj4gLQkJZ290byBvdXRfZGVhbGxvY2F0ZV9kb29yYmVs
bDsNCj4gLQ0KPiAtCXByX2RlYnVnKCJMb2FkaW5nIG1xZCB0byBocWQgb24gcGlwZSAlZCwgcXVl
dWUgJWRcbiIsDQo+IC0JCQlxLT5waXBlLCBxLT5xdWV1ZSk7DQo+IC0NCj4gLQlkcW0tPmRldi0+
a2ZkMmtnZC0+c2V0X3NjcmF0Y2hfYmFja2luZ192YSgNCj4gLQkJCWRxbS0+ZGV2LT5rZ2QsIHFw
ZC0+c2hfaGlkZGVuX3ByaXZhdGVfYmFzZSwgcXBkLT52bWlkKTsNCj4gLQ0KPiAtCWlmICghcS0+
cHJvcGVydGllcy5pc19hY3RpdmUpDQo+IC0JCXJldHVybiAwOw0KPiAtDQo+IC0JaWYgKFdBUk4o
cS0+cHJvY2Vzcy0+bW0gIT0gY3VycmVudC0+bW0sDQo+IC0JCSAic2hvdWxkIG9ubHkgcnVuIGlu
IHVzZXIgdGhyZWFkIikpDQo+IC0JCXJldHZhbCA9IC1FRkFVTFQ7DQo+IC0JZWxzZQ0KPiAtCQly
ZXR2YWwgPSBtcWRfbWdyLT5sb2FkX21xZChtcWRfbWdyLCBxLT5tcWQsIHEtPnBpcGUsIHEtPnF1
ZXVlLA0KPiAtCQkJCQkgICAmcS0+cHJvcGVydGllcywgY3VycmVudC0+bW0pOw0KPiAtCWlmIChy
ZXR2YWwpDQo+IC0JCWdvdG8gb3V0X3VuaW5pdF9tcWQ7DQo+IC0NCj4gLQlyZXR1cm4gMDsNCj4g
LQ0KPiAtb3V0X3VuaW5pdF9tcWQ6DQo+IC0JbXFkX21nci0+dW5pbml0X21xZChtcWRfbWdyLCBx
LT5tcWQsIHEtPm1xZF9tZW1fb2JqKTsNCj4gLW91dF9kZWFsbG9jYXRlX2Rvb3JiZWxsOg0KPiAt
CWRlYWxsb2NhdGVfZG9vcmJlbGwocXBkLCBxKTsNCj4gLW91dF9kZWFsbG9jYXRlX2hxZDoNCj4g
LQlkZWFsbG9jYXRlX2hxZChkcW0sIHEpOw0KPiAtDQo+IC0JcmV0dXJuIHJldHZhbDsNCj4gLX0N
Cj4gLQ0KPiAgIC8qIEFjY2VzcyB0byBEUU0gaGFzIHRvIGJlIGxvY2tlZCBiZWZvcmUgY2FsbGlu
ZyBkZXN0cm95X3F1ZXVlX25vY3BzY2hfbG9ja2VkDQo+ICAgICogdG8gYXZvaWQgYXN5bmNocm9u
aXplZCBhY2Nlc3MNCj4gICAgKi8NCj4gQEAgLTk2Nyw0OSArOTU1LDYgQEAgc3RhdGljIHZvaWQg
ZGVhbGxvY2F0ZV9zZG1hX3F1ZXVlKHN0cnVjdCBkZXZpY2VfcXVldWVfbWFuYWdlciAqZHFtLA0K
PiAgIAl9DQo+ICAgfQ0KPiAgIA0KPiAtc3RhdGljIGludCBjcmVhdGVfc2RtYV9xdWV1ZV9ub2Nw
c2NoKHN0cnVjdCBkZXZpY2VfcXVldWVfbWFuYWdlciAqZHFtLA0KPiAtCQkJCQlzdHJ1Y3QgcXVl
dWUgKnEsDQo+IC0JCQkJCXN0cnVjdCBxY21fcHJvY2Vzc19kZXZpY2UgKnFwZCkNCj4gLXsNCj4g
LQlzdHJ1Y3QgbXFkX21hbmFnZXIgKm1xZF9tZ3I7DQo+IC0JaW50IHJldHZhbDsNCj4gLQ0KPiAt
CW1xZF9tZ3IgPSBkcW0tPm1xZF9tZ3JzW0tGRF9NUURfVFlQRV9TRE1BXTsNCj4gLQ0KPiAtCXJl
dHZhbCA9IGFsbG9jYXRlX3NkbWFfcXVldWUoZHFtLCBxKTsNCj4gLQlpZiAocmV0dmFsKQ0KPiAt
CQlyZXR1cm4gcmV0dmFsOw0KPiAtDQo+IC0JcmV0dmFsID0gYWxsb2NhdGVfZG9vcmJlbGwocXBk
LCBxKTsNCj4gLQlpZiAocmV0dmFsKQ0KPiAtCQlnb3RvIG91dF9kZWFsbG9jYXRlX3NkbWFfcXVl
dWU7DQo+IC0NCj4gLQlkcW0tPmFzaWNfb3BzLmluaXRfc2RtYV92bShkcW0sIHEsIHFwZCk7DQo+
IC0JcmV0dmFsID0gbXFkX21nci0+aW5pdF9tcWQobXFkX21nciwgJnEtPm1xZCwgJnEtPm1xZF9t
ZW1fb2JqLA0KPiAtCQkJCSZxLT5nYXJ0X21xZF9hZGRyLCAmcS0+cHJvcGVydGllcyk7DQo+IC0J
aWYgKHJldHZhbCkNCj4gLQkJZ290byBvdXRfZGVhbGxvY2F0ZV9kb29yYmVsbDsNCj4gLQ0KPiAt
CWlmICghcS0+cHJvcGVydGllcy5pc19hY3RpdmUpDQo+IC0JCXJldHVybiAwOw0KPiAtDQo+IC0J
cmV0dmFsID0gbXFkX21nci0+bG9hZF9tcWQobXFkX21nciwgcS0+bXFkLCAwLCAwLCAmcS0+cHJv
cGVydGllcywNCj4gLQkJCQljdXJyZW50LT5tbSk7DQo+IC0JaWYgKHJldHZhbCkNCj4gLQkJZ290
byBvdXRfdW5pbml0X21xZDsNCj4gLQ0KPiAtCXJldHVybiAwOw0KPiAtDQo+IC1vdXRfdW5pbml0
X21xZDoNCj4gLQltcWRfbWdyLT51bmluaXRfbXFkKG1xZF9tZ3IsIHEtPm1xZCwgcS0+bXFkX21l
bV9vYmopOw0KPiAtb3V0X2RlYWxsb2NhdGVfZG9vcmJlbGw6DQo+IC0JZGVhbGxvY2F0ZV9kb29y
YmVsbChxcGQsIHEpOw0KPiAtb3V0X2RlYWxsb2NhdGVfc2RtYV9xdWV1ZToNCj4gLQlkZWFsbG9j
YXRlX3NkbWFfcXVldWUoZHFtLCBxKTsNCj4gLQ0KPiAtCXJldHVybiByZXR2YWw7DQo+IC19DQo+
IC0NCj4gICAvKg0KPiAgICAqIERldmljZSBRdWV1ZSBNYW5hZ2VyIGltcGxlbWVudGF0aW9uIGZv
ciBjcCBzY2hlZHVsZXINCj4gICAgKi8NCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
YW1kLWdmeA==
