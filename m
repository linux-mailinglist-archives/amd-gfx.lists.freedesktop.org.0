Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BEC42A3EB4
	for <lists+amd-gfx@lfdr.de>; Fri, 30 Aug 2019 21:58:18 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F3B396E3C1;
	Fri, 30 Aug 2019 19:58:16 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wr1-x442.google.com (mail-wr1-x442.google.com
 [IPv6:2a00:1450:4864:20::442])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E78AD6E3C1
 for <amd-gfx@lists.freedesktop.org>; Fri, 30 Aug 2019 19:58:13 +0000 (UTC)
Received: by mail-wr1-x442.google.com with SMTP id q12so8061052wrj.12
 for <amd-gfx@lists.freedesktop.org>; Fri, 30 Aug 2019 12:58:13 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=3vyQeOIpcGLtPn8JaygjFFRzUbzQ+h9se05lPJAVCG4=;
 b=Nhz37qJABHOeL7rJAJXmP4zttQ+Tnstdt6cjShmNfMfaZVtab5UvM/8sZT06T3ATWz
 WqfhnmpoIyEYcw+P+VNeZCUo3c7FK2/Kby02mW5Wyu3yafj4OA9VYgtlyT5FYUuo/tyx
 rkNqDBgQN+qVJTmy9Q/UNdPglbjtDBB0m49QTZPvfDsyKrsTuWdNrS/uF/hinRO3iw0N
 wct6BXTaYQYaGCVahwtVA3M8Nd8owyJy786Etn70ZruFyLC/JGhvuAgtEgREYrupe7Dy
 zIVFxvTqou3TWV/Hjssxz/CbUpOM02nwPTaJY/m5J7wl/X5DzzuhG1S1jCyNQ5gl8SHE
 PIbg==
X-Gm-Message-State: APjAAAU7xiHj8IcZovkQQOrpqPmPnas1p+8C5LahoY8EAuxYuwOWS2Xc
 ImILH02bc9ej2NRjpRuxCsdgpLBrxI0Awnk6Fd8=
X-Google-Smtp-Source: APXvYqw2BwQS4dKdJ7dstmqtiRBtE8O91TzT60tOYx+f5UcGs1JpGFk9bTlV9VxbvaqVG4Y/0hh/Yw96wA4IWlek078=
X-Received: by 2002:adf:dfc5:: with SMTP id q5mr21697932wrn.142.1567195092351; 
 Fri, 30 Aug 2019 12:58:12 -0700 (PDT)
MIME-Version: 1.0
References: <1567183153-11014-1-git-send-email-andrey.grodzovsky@amd.com>
 <1567183153-11014-2-git-send-email-andrey.grodzovsky@amd.com>
In-Reply-To: <1567183153-11014-2-git-send-email-andrey.grodzovsky@amd.com>
From: Alex Deucher <alexdeucher@gmail.com>
Date: Fri, 30 Aug 2019 15:58:00 -0400
Message-ID: <CADnq5_O0-KzX2QjmCfwpM8qESods27ACSybpBAED2vy4mg9reA@mail.gmail.com>
Subject: Re: [PATCH v3 2/3] dmr/amdgpu: Avoid HW GPU reset for RAS.
To: Andrey Grodzovsky <andrey.grodzovsky@amd.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=3vyQeOIpcGLtPn8JaygjFFRzUbzQ+h9se05lPJAVCG4=;
 b=jRLXFTnyLE2WDHuq2Kan8iNlObn+mmxrPJYJ6w6N84cYYRAg3eyu7oK1TeBv/Uetv2
 ecbsODzTGYiWpF8XN8zkGkaVPrK4x/uTSvtMReb9aqeeacUHGU/dhNUfQeRXPj8iyd+O
 FkUNeUXFS4GrJsI8LhKP4LyO7XFRsps0G2/HNlCrXdiaDnaYVhsUB+9+ClQxGMbvndp+
 c01Oow/imkbISAsE542Z8zkp6mngwjUW1R/ATMQvjD7zsP5wOKP5Nb6+zG3tiQzY/Ff5
 I9rAvPpdDPx+s0Tr9pOizqSbZV6+Pu+IXXAelVLzN9OJKgJyq5Xwe9f3t5cXkxzDP++0
 ldRQ==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: =?UTF-8?Q?Christian_K=C3=B6nig?= <ckoenig.leichtzumerken@gmail.com>,
 "Kuehling, Felix" <Felix.Kuehling@amd.com>, Tao Zhou <Tao.Zhou1@amd.com>,
 amd-gfx list <amd-gfx@lists.freedesktop.org>,
 Hawking Zhang <Hawking.Zhang@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

T24gRnJpLCBBdWcgMzAsIDIwMTkgYXQgMTI6MzkgUE0gQW5kcmV5IEdyb2R6b3Zza3kKPGFuZHJl
eS5ncm9kem92c2t5QGFtZC5jb20+IHdyb3RlOgo+Cj4gUHJvYmxlbToKPiBVbmRlciBjZXJ0YWlu
IGNvbmRpdGlvbnMsIHdoZW4gc29tZSBJUCBib2NrcyB0YWtlIGEgUkFTIGVycm9yLAo+IHdlIGNh
biBnZXQgaW50byBhIHNpdHVhdGlvbiB3aGVyZSBhIEdQVSByZXNldCBpcyBub3QgcG9zc2libGUK
PiBkdWUgdG8gaXNzdWVzIGluIFJBUyBpbiBTTVUvUFNQLgo+Cj4gVGVtcG9yYXJ5IGZpeCB1bnRp
bCBwcm9wZXIgc29sdXRpb24gaW4gUFNQL1NNVSBpcyByZWFkeToKPiBXaGVuIHVuY29ycmVjdGFi
bGUgZXJyb3IgaGFwcGVucyB0aGUgREYgd2lsbCB1bmNvbmRpdGlvbmFsbHkKPiBicm9hZGNhc3Qg
ZXJyb3IgZXZlbnQgcGFja2V0cyB0byBhbGwgaXRzIGNsaWVudHMvc2xhdmUgdXBvbgo+IHJlY2Vp
dmluZyBmYXRhbCBlcnJvciBldmVudCBhbmQgZnJlZXplIGFsbCBpdHMgb3V0Ym91bmQgcXVldWVz
LAo+IGVycl9ldmVudF9hdGh1YiBpbnRlcnJ1cHQgIHdpbGwgYmUgdHJpZ2dlcmVkLgo+IEluIHN1
Y2ggY2FzZSBhbmQgd2UgdXNlIHRoaXMgaW50ZXJydXB0Cj4gdG8gaXNzdWUgR1BVIHJlc2V0LiBU
SGUgR1BVIHJlc2V0IGNvZGUgaXMgbW9kaWZpZWQgZm9yIHN1Y2ggY2FzZSB0byBhdm9pZCBIVwo+
IHJlc2V0LCBvbmx5IHN0b3BzIHNjaGVkdWxlcnMsIGRlYXRjaGVzIGFsbCBpbiBwcm9ncmVzcyBh
bmQgbm90IHlldCBzY2hlZHVsZWQKPiBqb2IncyBmZW5jZXMsIHNldCBlcnJvciBjb2RlIG9uIHRo
ZW0gYW5kIHNpZ25hbHMuCj4gQWxzbyByZWplY3QgYW55IG5ldyBpbmNvbWluZyBqb2Igc3VibWlz
c2lvbnMgZnJvbSB1c2VyIHNwYWNlLgo+IEFsbCB0aGlzIGlzIGRvbmUgdG8gbm90aWZ5IHRoZSBh
cHBsaWNhdGlvbnMgb2YgdGhlIHByb2JsZW0uCj4KPiB2MjoKPiBFeHRyYWN0IGFtZGdwdV9hbWRr
ZmRfcHJlL3Bvc3RfcmVzZXQgZnJvbSBhbWRncHVfZGV2aWNlX2xvY2svdW5sb2NrX2FkZXYKPiBN
b3ZlIGFtZGdwdV9qb2Jfc3RvcF9hbGxfam9ic19vbl9zY2hlZCB0byBhbWRncHVfam9iLmMKPiBS
ZW1vdmUgcHJpbnQgcGFyYW0gZnJvbSBhbWRncHVfcmFzX3F1ZXJ5X2Vycm9yX2NvdW50Cj4KPiB2
MzoKPiBVcGRhdGUgYmFzZWQgb24gcHJldmlvdXMgYnVnIGZpeGluZyBwYXRjaCB0byBwcm9wZXJs
eSBjYWxsIGFtZGdwdV9hbWRrZmRfcHJlX3Jlc2V0Cj4gZm9yIG90aGVyIFhHTUkgaGl2ZSBtZW1l
YmVycy4KPgo+IFNpZ25lZC1vZmYtYnk6IEFuZHJleSBHcm9kem92c2t5IDxhbmRyZXkuZ3JvZHpv
dnNreUBhbWQuY29tPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
Y3MuYyAgICAgfCAgNCArKysrCj4gIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9k
ZXZpY2UuYyB8IDM4ICsrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLQo+ICBkcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHJ2LmMgICAgfCAgNSArKysrCj4gIGRyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9qb2IuYyAgICB8IDM4ICsrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKwo+ICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfam9iLmggICAg
fCAgMyArKysKPiAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ttcy5jICAgIHwg
IDYgKysrKysKPiAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jhcy5jICAgIHwg
MjIgKysrKysrKysrKysrKysrLS0KPiAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3Jhcy5oICAgIHwgMTAgKysrKysrKysKPiAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4
X3Y5XzAuYyAgICAgIHwgMTAgKysrKy0tLS0KPiAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
Z21jX3Y5XzAuYyAgICAgIHwgMjQgKysrKysrKysrKy0tLS0tLS0tLQo+ICBkcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9uYmlvX3Y3XzQuYyAgICAgfCAgNSArKysrCj4gIGRyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L3NkbWFfdjRfMC5jICAgICB8IDMyICsrKysrKysrKysrKystLS0tLS0tLS0t
LS0KPiAgMTIgZmlsZXMgY2hhbmdlZCwgMTU1IGluc2VydGlvbnMoKyksIDQyIGRlbGV0aW9ucygt
KQo+Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMKPiBpbmRleCBkODYwMTcw
Li40OTRjMzg0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9jcy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMKPiBA
QCAtMzgsNiArMzgsNyBAQAo+ICAjaW5jbHVkZSAiYW1kZ3B1X2dtYy5oIgo+ICAjaW5jbHVkZSAi
YW1kZ3B1X2dlbS5oIgo+ICAjaW5jbHVkZSAiYW1kZ3B1X2Rpc3BsYXkuaCIKPiArI2luY2x1ZGUg
ImFtZGdwdV9yYXMuaCIKPgo+ICBzdGF0aWMgaW50IGFtZGdwdV9jc191c2VyX2ZlbmNlX2NodW5r
KHN0cnVjdCBhbWRncHVfY3NfcGFyc2VyICpwLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IGRybV9hbWRncHVfY3NfY2h1bmtfZmVuY2UgKmRhdGEsCj4gQEAg
LTE0MzgsNiArMTQzOSw5IEBAIGludCBhbWRncHVfY3NfaW9jdGwoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwgc3RydWN0IGRybV9maWxlICpmaWxwKQo+ICAgICAgICAgYm9vbCBy
ZXNlcnZlZF9idWZmZXJzID0gZmFsc2U7Cj4gICAgICAgICBpbnQgaSwgcjsKPgo+ICsgICAgICAg
aWYgKGFtZGdwdV9yYXNfaW50cl90cmlnZ2VyZWQoKSkKPiArICAgICAgICAgICAgICAgcmV0dXJu
IC1FSFdQT0lTT047Cj4gKwo+ICAgICAgICAgaWYgKCFhZGV2LT5hY2NlbF93b3JraW5nKQo+ICAg
ICAgICAgICAgICAgICByZXR1cm4gLUVCVVNZOwo+Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9kZXZpY2UuYwo+IGluZGV4IDE5ZjY2MjQuLmM5ODI1YWUgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jCj4gQEAgLTM3MjcsMjUgKzM3
MjcsMTggQEAgc3RhdGljIGJvb2wgYW1kZ3B1X2RldmljZV9sb2NrX2FkZXYoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsIGJvb2wgdHJ5bG9jaykKPiAgICAgICAgICAgICAgICAgYWRldi0+bXAx
X3N0YXRlID0gUFBfTVAxX1NUQVRFX05PTkU7Cj4gICAgICAgICAgICAgICAgIGJyZWFrOwo+ICAg
ICAgICAgfQo+IC0gICAgICAgLyogQmxvY2sga2ZkOiBTUklPViB3b3VsZCBkbyBpdCBzZXBhcmF0
ZWx5ICovCj4gLSAgICAgICBpZiAoIWFtZGdwdV9zcmlvdl92ZihhZGV2KSkKPiAtICAgICAgICAg
ICAgICAgIGFtZGdwdV9hbWRrZmRfcHJlX3Jlc2V0KGFkZXYpOwo+Cj4gICAgICAgICByZXR1cm4g
dHJ1ZTsKPiAgfQo+Cj4gIHN0YXRpYyB2b2lkIGFtZGdwdV9kZXZpY2VfdW5sb2NrX2FkZXYoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4gIHsKPiAtICAgICAgIC8qdW5sb2NrIGtmZDogU1JJ
T1Ygd291bGQgZG8gaXQgc2VwYXJhdGVseSAqLwo+IC0gICAgICAgaWYgKCFhbWRncHVfc3Jpb3Zf
dmYoYWRldikpCj4gLSAgICAgICAgICAgICAgICBhbWRncHVfYW1ka2ZkX3Bvc3RfcmVzZXQoYWRl
dik7Cj4gICAgICAgICBhbWRncHVfdmZfZXJyb3JfdHJhbnNfYWxsKGFkZXYpOwo+ICAgICAgICAg
YWRldi0+bXAxX3N0YXRlID0gUFBfTVAxX1NUQVRFX05PTkU7Cj4gICAgICAgICBhZGV2LT5pbl9n
cHVfcmVzZXQgPSAwOwo+ICAgICAgICAgbXV0ZXhfdW5sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsK
PiAgfQo+Cj4gLQo+ICAvKioKPiAgICogYW1kZ3B1X2RldmljZV9ncHVfcmVjb3ZlciAtIHJlc2V0
IHRoZSBhc2ljIGFuZCByZWNvdmVyIHNjaGVkdWxlcgo+ICAgKgo+IEBAIC0zNzY1LDExICszNzU4
LDEyIEBAIGludCBhbWRncHVfZGV2aWNlX2dwdV9yZWNvdmVyKHN0cnVjdCBhbWRncHVfZGV2aWNl
ICphZGV2LAo+ICAgICAgICAgc3RydWN0IGFtZGdwdV9oaXZlX2luZm8gKmhpdmUgPSBOVUxMOwo+
ICAgICAgICAgc3RydWN0IGFtZGdwdV9kZXZpY2UgKnRtcF9hZGV2ID0gTlVMTDsKPiAgICAgICAg
IGludCBpLCByID0gMDsKPiArICAgICAgIGJvb2wgaW5fcmFzX2ludHIgPSBhbWRncHVfcmFzX2lu
dHJfdHJpZ2dlcmVkKCk7Cj4KPiAgICAgICAgIG5lZWRfZnVsbF9yZXNldCA9IGpvYl9zaWduYWxl
ZCA9IGZhbHNlOwo+ICAgICAgICAgSU5JVF9MSVNUX0hFQUQoJmRldmljZV9saXN0KTsKPgo+IC0g
ICAgICAgZGV2X2luZm8oYWRldi0+ZGV2LCAiR1BVIHJlc2V0IGJlZ2luIVxuIik7Cj4gKyAgICAg
ICBkZXZfaW5mbyhhZGV2LT5kZXYsICJHUFUgJXMgYmVnaW4hXG4iLCBpbl9yYXNfaW50ciA/ICJq
b2JzIHN0b3AiOiJyZXNldCIpOwo+Cj4gICAgICAgICBjYW5jZWxfZGVsYXllZF93b3JrX3N5bmMo
JmFkZXYtPmRlbGF5ZWRfaW5pdF93b3JrKTsKPgo+IEBAIC0zNzk2LDkgKzM3OTAsMTYgQEAgaW50
IGFtZGdwdV9kZXZpY2VfZ3B1X3JlY292ZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4g
ICAgICAgICAgICAgICAgIHJldHVybiAwOwo+ICAgICAgICAgfQo+Cj4gKyAgICAgICAvKiBCbG9j
ayBrZmQ6IFNSSU9WIHdvdWxkIGRvIGl0IHNlcGFyYXRlbHkgKi8KPiArICAgICAgIGlmICghYW1k
Z3B1X3NyaW92X3ZmKGFkZXYpKQo+ICsgICAgICAgICAgICAgICAgYW1kZ3B1X2FtZGtmZF9wcmVf
cmVzZXQoYWRldik7Cj4gKwo+ICAgICAgICAgLyogQnVpbGQgbGlzdCBvZiBkZXZpY2VzIHRvIHJl
c2V0ICovCj4gICAgICAgICBpZiAgKGFkZXYtPmdtYy54Z21pLm51bV9waHlzaWNhbF9ub2RlcyA+
IDEpIHsKPiAgICAgICAgICAgICAgICAgaWYgKCFoaXZlKSB7Cj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgLyp1bmxvY2sga2ZkOiBTUklPViB3b3VsZCBkbyBpdCBzZXBhcmF0ZWx5ICovCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbWRncHVfc3Jpb3ZfdmYoYWRldikpCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBhbWRncHVfYW1ka2ZkX3Bvc3RfcmVzZXQoYWRldik7
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgYW1kZ3B1X2RldmljZV91bmxvY2tfYWRldihhZGV2
KTsKPiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVOT0RFVjsKPiAgICAgICAgICAg
ICAgICAgfQo+IEBAIC0zODE2LDggKzM4MTcsMTIgQEAgaW50IGFtZGdwdV9kZXZpY2VfZ3B1X3Jl
Y292ZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4KPiAgICAgICAgIC8qIGJsb2NrIGFs
bCBzY2hlZHVsZXJzIGFuZCByZXNldCBnaXZlbiBqb2IncyByaW5nICovCj4gICAgICAgICBsaXN0
X2Zvcl9lYWNoX2VudHJ5KHRtcF9hZGV2LCBkZXZpY2VfbGlzdF9oYW5kbGUsIGdtYy54Z21pLmhl
YWQpIHsKPiAtICAgICAgICAgICAgICAgaWYgKHRtcF9hZGV2ICE9IGFkZXYpCj4gKyAgICAgICAg
ICAgICAgIGlmICh0bXBfYWRldiAhPSBhZGV2KSB7Cj4gICAgICAgICAgICAgICAgICAgICAgICAg
YW1kZ3B1X2RldmljZV9sb2NrX2FkZXYodG1wX2FkZXYsIGZhbHNlKTsKPiArICAgICAgICAgICAg
ICAgICAgICAgICBpZiAoIWFtZGdwdV9zcmlvdl92Zih0bXBfYWRldikpCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtZGdwdV9hbWRrZmRfcHJlX3Jlc2V0KHRtcF9h
ZGV2KTsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiAgICAgICAgICAgICAgICAgLyoKPiAgICAg
ICAgICAgICAgICAgICogTWFyayB0aGVzZSBBU0lDcyB0byBiZSByZXNldGVkIGFzIHVudHJhY2tl
ZCBmaXJzdAo+ICAgICAgICAgICAgICAgICAgKiBBbmQgYWRkIHRoZW0gYmFjayBhZnRlciByZXNl
dCBjb21wbGV0ZWQKPiBAQCAtMzgyNSw3ICszODMwLDcgQEAgaW50IGFtZGdwdV9kZXZpY2VfZ3B1
X3JlY292ZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4gICAgICAgICAgICAgICAgIGFt
ZGdwdV91bnJlZ2lzdGVyX2dwdV9pbnN0YW5jZSh0bXBfYWRldik7Cj4KPiAgICAgICAgICAgICAg
ICAgLyogZGlzYWJsZSByYXMgb24gQUxMIElQcyAqLwo+IC0gICAgICAgICAgICAgICBpZiAoYW1k
Z3B1X2RldmljZV9pcF9uZWVkX2Z1bGxfcmVzZXQodG1wX2FkZXYpKQo+ICsgICAgICAgICAgICAg
ICBpZiAoIWluX3Jhc19pbnRyICYmIGFtZGdwdV9kZXZpY2VfaXBfbmVlZF9mdWxsX3Jlc2V0KHRt
cF9hZGV2KSkKPiAgICAgICAgICAgICAgICAgICAgICAgICBhbWRncHVfcmFzX3N1c3BlbmQodG1w
X2FkZXYpOwo+Cj4gICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBBTURHUFVfTUFYX1JJ
TkdTOyArK2kpIHsKPiBAQCAtMzgzNSwxMCArMzg0MCwxNiBAQCBpbnQgYW1kZ3B1X2RldmljZV9n
cHVfcmVjb3ZlcihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+Cj4gICAgICAgICAgICAgICAgICAgICAgICAgZHJt
X3NjaGVkX3N0b3AoJnJpbmctPnNjaGVkLCBqb2IgPyAmam9iLT5iYXNlIDogTlVMTCk7Cj4gKwo+
ICsgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbl9yYXNfaW50cikKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGFtZGdwdV9qb2Jfc3RvcF9hbGxfam9ic19vbl9zY2hlZCgmcmlu
Zy0+c2NoZWQpOwo+ICAgICAgICAgICAgICAgICB9Cj4gICAgICAgICB9Cj4KPgo+ICsgICAgICAg
aWYgKGluX3Jhc19pbnRyKQo+ICsgICAgICAgICAgICAgICBnb3RvIHNraXBfc2NoZWRfcmVzdW1l
Owo+ICsKPiAgICAgICAgIC8qCj4gICAgICAgICAgKiBNdXN0IGNoZWNrIGd1aWx0eSBzaWduYWwg
aGVyZSBzaW5jZSBhZnRlciB0aGlzIHBvaW50IGFsbCBvbGQKPiAgICAgICAgICAqIEhXIGZlbmNl
cyBhcmUgZm9yY2Ugc2lnbmFsZWQuCj4gQEAgLTM4OTcsNiArMzkwOCw3IEBAIGludCBhbWRncHVf
ZGV2aWNlX2dwdV9yZWNvdmVyKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+Cj4gICAgICAg
ICAvKiBQb3N0IEFTSUMgcmVzZXQgZm9yIGFsbCBkZXZzIC4qLwo+ICAgICAgICAgbGlzdF9mb3Jf
ZWFjaF9lbnRyeSh0bXBfYWRldiwgZGV2aWNlX2xpc3RfaGFuZGxlLCBnbWMueGdtaS5oZWFkKSB7
Cj4gKwo+ICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgQU1ER1BVX01BWF9SSU5HUzsg
KytpKSB7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGFtZGdwdV9yaW5nICpyaW5n
ID0gdG1wX2FkZXYtPnJpbmdzW2ldOwo+Cj4gQEAgLTM5MjMsNyArMzkzNSwxMyBAQCBpbnQgYW1k
Z3B1X2RldmljZV9ncHVfcmVjb3ZlcihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgICAg
ICAgICAgICAgICAgfSBlbHNlIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICBkZXZfaW5mbyh0
bXBfYWRldi0+ZGV2LCAiR1BVIHJlc2V0KCVkKSBzdWNjZWVkZWQhXG4iLCBhdG9taWNfcmVhZCgm
dG1wX2FkZXYtPmdwdV9yZXNldF9jb3VudGVyKSk7Cj4gICAgICAgICAgICAgICAgIH0KPiArICAg
ICAgIH0KPgo+ICtza2lwX3NjaGVkX3Jlc3VtZToKPiArICAgICAgIGxpc3RfZm9yX2VhY2hfZW50
cnkodG1wX2FkZXYsIGRldmljZV9saXN0X2hhbmRsZSwgZ21jLnhnbWkuaGVhZCkgewo+ICsgICAg
ICAgICAgICAgICAvKnVubG9jayBrZmQ6IFNSSU9WIHdvdWxkIGRvIGl0IHNlcGFyYXRlbHkgKi8K
PiArICAgICAgICAgICAgICAgaWYgKCFpbl9yYXNfaW50ciAmJiAhYW1kZ3B1X3NyaW92X3ZmKHRt
cF9hZGV2KSkKPiArICAgICAgICAgICAgICAgICAgICAgICBhbWRncHVfYW1ka2ZkX3Bvc3RfcmVz
ZXQodG1wX2FkZXYpOwo+ICAgICAgICAgICAgICAgICBhbWRncHVfZGV2aWNlX3VubG9ja19hZGV2
KHRtcF9hZGV2KTsKPiAgICAgICAgIH0KPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfZHJ2LmMKPiBpbmRleCA3Njc5ZmU4Li5jNzNkMjZhIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcnYuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9kcnYuYwo+IEBAIC00MCw2ICs0MCw4IEBACj4KPiAgI2luY2x1ZGUg
ImFtZGdwdV9hbWRrZmQuaCIKPgo+ICsjaW5jbHVkZSAiYW1kZ3B1X3Jhcy5oIgo+ICsKPiAgLyoK
PiAgICogS01TIHdyYXBwZXIuCj4gICAqIC0gMy4wLjAgLSBpbml0aWFsIGRyaXZlcgo+IEBAIC0x
MTgwLDYgKzExODIsOSBAQCBhbWRncHVfcGNpX3NodXRkb3duKHN0cnVjdCBwY2lfZGV2ICpwZGV2
KQo+ICAgICAgICAgc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IHBjaV9nZXRfZHJ2ZGF0YShwZGV2
KTsKPiAgICAgICAgIHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gZGV2LT5kZXZfcHJpdmF0
ZTsKPgo+ICsgICAgICAgaWYgKGFtZGdwdV9yYXNfaW50cl90cmlnZ2VyZWQoKSkKPiArICAgICAg
ICAgICAgICAgcmV0dXJuOwo+ICsKPiAgICAgICAgIC8qIGlmIHdlIGFyZSBydW5uaW5nIGluIGEg
Vk0sIG1ha2Ugc3VyZSB0aGUgZGV2aWNlCj4gICAgICAgICAgKiB0b3JuIGRvd24gcHJvcGVybHkg
b24gcmVib290L3NodXRkb3duLgo+ICAgICAgICAgICogdW5mb3J0dW5hdGVseSB3ZSBjYW4ndCBk
ZXRlY3QgY2VydGFpbgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfam9iLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfam9iLmMKPiBp
bmRleCA0ZDY3Yjc3Li5iMTI5ODFlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9qb2IuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9qb2IuYwo+IEBAIC0yNTAsNiArMjUwLDQ0IEBAIHN0YXRpYyBzdHJ1Y3QgZG1hX2ZlbmNl
ICphbWRncHVfam9iX3J1bihzdHJ1Y3QgZHJtX3NjaGVkX2pvYiAqc2NoZWRfam9iKQo+ICAgICAg
ICAgcmV0dXJuIGZlbmNlOwo+ICB9Cj4KPiArI2RlZmluZSB0b19kcm1fc2NoZWRfam9iKHNjaGVk
X2pvYikgICAgICAgICAgICBcCj4gKyAgICAgICAgICAgICAgIGNvbnRhaW5lcl9vZigoc2NoZWRf
am9iKSwgc3RydWN0IGRybV9zY2hlZF9qb2IsIHF1ZXVlX25vZGUpCj4gKwo+ICt2b2lkIGFtZGdw
dV9qb2Jfc3RvcF9hbGxfam9ic19vbl9zY2hlZChzdHJ1Y3QgZHJtX2dwdV9zY2hlZHVsZXIgKnNj
aGVkKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX3NjaGVkX2pvYiAqc19qb2I7Cj4gKyAgICAg
ICBzdHJ1Y3QgZHJtX3NjaGVkX2VudGl0eSAqc19lbnRpdHkgPSBOVUxMOwo+ICsgICAgICAgaW50
IGk7Cj4gKwo+ICsgICAgICAgLyogU2lnbmFsIGFsbCBqb2JzIG5vdCB5ZXQgc2NoZWR1bGVkICov
Cj4gKyAgICAgICBmb3IgKGkgPSBEUk1fU0NIRURfUFJJT1JJVFlfTUFYIC0gMTsgaSA+PSBEUk1f
U0NIRURfUFJJT1JJVFlfTUlOOyBpLS0pIHsKPiArICAgICAgICAgICAgICAgc3RydWN0IGRybV9z
Y2hlZF9ycSAqcnEgPSAmc2NoZWQtPnNjaGVkX3JxW2ldOwo+ICsKPiArICAgICAgICAgICAgICAg
aWYgKCFycSkKPiArICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiArCj4gKyAgICAg
ICAgICAgICAgIHNwaW5fbG9jaygmcnEtPmxvY2spOwo+ICsgICAgICAgICAgICAgICBsaXN0X2Zv
cl9lYWNoX2VudHJ5KHNfZW50aXR5LCAmcnEtPmVudGl0aWVzLCBsaXN0KSB7Cj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgd2hpbGUgKChzX2pvYiA9IHRvX2RybV9zY2hlZF9qb2Ioc3BzY19xdWV1
ZV9wb3AoJnNfZW50aXR5LT5qb2JfcXVldWUpKSkpIHsKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBkcm1fc2NoZWRfZmVuY2UgKnNfZmVuY2UgPSBzX2pvYi0+c19mZW5j
ZTsKPiArCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbWFfZmVuY2Vfc2lnbmFs
KCZzX2ZlbmNlLT5zY2hlZHVsZWQpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZG1hX2ZlbmNlX3NldF9lcnJvcigmc19mZW5jZS0+ZmluaXNoZWQsIC1FSFdQT0lTT04pOwo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG1hX2ZlbmNlX3NpZ25hbCgmc19mZW5jZS0+
ZmluaXNoZWQpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIH0KPiArICAgICAgICAgICAgICAg
fQo+ICsgICAgICAgICAgICAgICBzcGluX3VubG9jaygmcnEtPmxvY2spOwo+ICsgICAgICAgfQo+
ICsKPiArICAgICAgIC8qIFNpZ25hbCBhbGwgam9icyBhbHJlYWR5IHNjaGVkdWxlZCB0byBIVyAq
Lwo+ICsgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeShzX2pvYiwgJnNjaGVkLT5yaW5nX21pcnJv
cl9saXN0LCBub2RlKSB7Cj4gKyAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fc2NoZWRfZmVuY2Ug
KnNfZmVuY2UgPSBzX2pvYi0+c19mZW5jZTsKPiArCj4gKyAgICAgICAgICAgICAgIGRtYV9mZW5j
ZV9zZXRfZXJyb3IoJnNfZmVuY2UtPmZpbmlzaGVkLCAtRUhXUE9JU09OKTsKPiArICAgICAgICAg
ICAgICAgZG1hX2ZlbmNlX3NpZ25hbCgmc19mZW5jZS0+ZmluaXNoZWQpOwo+ICsgICAgICAgfQo+
ICt9Cj4gKwo+ICBjb25zdCBzdHJ1Y3QgZHJtX3NjaGVkX2JhY2tlbmRfb3BzIGFtZGdwdV9zY2hl
ZF9vcHMgPSB7Cj4gICAgICAgICAuZGVwZW5kZW5jeSA9IGFtZGdwdV9qb2JfZGVwZW5kZW5jeSwK
PiAgICAgICAgIC5ydW5fam9iID0gYW1kZ3B1X2pvYl9ydW4sCj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9qb2IuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9qb2IuaAo+IGluZGV4IDUxZTYyNTAuLmRjN2VlOTMgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5oCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5oCj4gQEAgLTc2LDQgKzc2LDcgQEAgaW50
IGFtZGdwdV9qb2Jfc3VibWl0KHN0cnVjdCBhbWRncHVfam9iICpqb2IsIHN0cnVjdCBkcm1fc2No
ZWRfZW50aXR5ICplbnRpdHksCj4gICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKm93bmVyLCBz
dHJ1Y3QgZG1hX2ZlbmNlICoqZik7Cj4gIGludCBhbWRncHVfam9iX3N1Ym1pdF9kaXJlY3Qoc3Ry
dWN0IGFtZGdwdV9qb2IgKmpvYiwgc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nLAo+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRtYV9mZW5jZSAqKmZlbmNlKTsKPiArCj4gK3Zv
aWQgYW1kZ3B1X2pvYl9zdG9wX2FsbF9qb2JzX29uX3NjaGVkKHN0cnVjdCBkcm1fZ3B1X3NjaGVk
dWxlciAqc2NoZWQpOwo+ICsKPiAgI2VuZGlmCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9rbXMuYwo+IGluZGV4IDM1YTA4NjYuLjUzNWY2OTAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ttcy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2ttcy5jCj4gQEAgLTEwNDYsNiArMTA0NiwxMiBAQCBpbnQgYW1k
Z3B1X2RyaXZlcl9vcGVuX2ttcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2Zp
bGUgKmZpbGVfcHJpdikKPiAgICAgICAgIC8qIEVuc3VyZSBJQiB0ZXN0cyBhcmUgcnVuIG9uIHJp
bmcgKi8KPiAgICAgICAgIGZsdXNoX2RlbGF5ZWRfd29yaygmYWRldi0+ZGVsYXllZF9pbml0X3dv
cmspOwo+Cj4gKwo+ICsgICAgICAgaWYgKGFtZGdwdV9yYXNfaW50cl90cmlnZ2VyZWQoKSkgewo+
ICsgICAgICAgICAgICAgICBEUk1fRVJST1IoIlJBUyBJbnRyIHRyaWdnZXJlZCwgZGV2aWNlIGRp
c2FibGVkISEiKTsKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSFdQT0lTT047Cj4gKyAgICAg
ICB9Cj4gKwo+ICAgICAgICAgZmlsZV9wcml2LT5kcml2ZXJfcHJpdiA9IE5VTEw7Cj4KPiAgICAg
ICAgIHIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRldi0+ZGV2KTsKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jhcy5jIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3Jhcy5jCj4gaW5kZXggYWE1MWMwMC4uMWNjMzRkZSAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmFzLmMKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmFzLmMKPiBAQCAtMjQsNiArMjQsOCBAQAo+
ICAjaW5jbHVkZSA8bGludXgvZGVidWdmcy5oPgo+ICAjaW5jbHVkZSA8bGludXgvbGlzdC5oPgo+
ICAjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9yZWJvb3QuaD4K
PiArI2luY2x1ZGUgPGxpbnV4L3N5c2NhbGxzLmg+Cj4gICNpbmNsdWRlICJhbWRncHUuaCIKPiAg
I2luY2x1ZGUgImFtZGdwdV9yYXMuaCIKPiAgI2luY2x1ZGUgImFtZGdwdV9hdG9tZmlybXdhcmUu
aCIKPiBAQCAtNjQsNiArNjYsOSBAQCBjb25zdCBjaGFyICpyYXNfYmxvY2tfc3RyaW5nW10gPSB7
Cj4gIC8qIGluamVjdCBhZGRyZXNzIGlzIDUyIGJpdHMgKi8KPiAgI2RlZmluZSAgICAgICAgUkFT
X1VNQ19JTkpFQ1RfQUREUl9MSU1JVCAgICAgICAoMHgxVUxMIDw8IDUyKQo+Cj4gKwo+ICthdG9t
aWNfdCBhbWRncHVfcmFzX2luX2ludHIgPSBBVE9NSUNfSU5JVCgwKTsKPiArCj4gIHN0YXRpYyBp
bnQgYW1kZ3B1X3Jhc19yZXNlcnZlX3ZyYW0oc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4g
ICAgICAgICAgICAgICAgIHVpbnQ2NF90IG9mZnNldCwgdWludDY0X3Qgc2l6ZSwKPiAgICAgICAg
ICAgICAgICAgc3RydWN0IGFtZGdwdV9ibyAqKmJvX3B0cik7Cj4gQEAgLTE4OCw2ICsxOTMsMTAg
QEAgc3RhdGljIGludCBhbWRncHVfcmFzX2RlYnVnZnNfY3RybF9wYXJzZV9kYXRhKHN0cnVjdCBm
aWxlICpmLAo+Cj4gICAgICAgICByZXR1cm4gMDsKPiAgfQo+ICsKPiArc3RhdGljIHN0cnVjdCBy
YXNfbWFuYWdlciAqYW1kZ3B1X3Jhc19maW5kX29iaihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwKPiArICAgICAgICAgICAgICAgc3RydWN0IHJhc19jb21tb25faWYgKmhlYWQpOwo+ICsKPiAg
LyoqCj4gICAqIERPQzogQU1ER1BVIFJBUyBkZWJ1Z2ZzIGNvbnRyb2wgaW50ZXJmYWNlCj4gICAq
Cj4gQEAgLTYyNywxMiArNjM2LDE0IEBAIGludCBhbWRncHVfcmFzX2Vycm9yX3F1ZXJ5KHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICAgICAgICAgaW5mby0+dWVfY291bnQgPSBvYmotPmVy
cl9kYXRhLnVlX2NvdW50Owo+ICAgICAgICAgaW5mby0+Y2VfY291bnQgPSBvYmotPmVycl9kYXRh
LmNlX2NvdW50Owo+Cj4gLSAgICAgICBpZiAoZXJyX2RhdGEuY2VfY291bnQpCj4gKyAgICAgICBp
ZiAoZXJyX2RhdGEuY2VfY291bnQpIHsKPiAgICAgICAgICAgICAgICAgZGV2X2luZm8oYWRldi0+
ZGV2LCAiJWxkIGNvcnJlY3RhYmxlIGVycm9ycyBkZXRlY3RlZCBpbiAlcyBibG9ja1xuIiwKPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgb2JqLT5lcnJfZGF0YS5jZV9jb3VudCwgcmFzX2Jsb2Nr
X3N0cihpbmZvLT5oZWFkLmJsb2NrKSk7Cj4gLSAgICAgICBpZiAoZXJyX2RhdGEudWVfY291bnQp
Cj4gKyAgICAgICB9Cj4gKyAgICAgICBpZiAoZXJyX2RhdGEudWVfY291bnQpIHsKPiAgICAgICAg
ICAgICAgICAgZGV2X2luZm8oYWRldi0+ZGV2LCAiJWxkIHVuY29ycmVjdGFibGUgZXJyb3JzIGRl
dGVjdGVkIGluICVzIGJsb2NrXG4iLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICBvYmotPmVy
cl9kYXRhLnVlX2NvdW50LCByYXNfYmxvY2tfc3RyKGluZm8tPmhlYWQuYmxvY2spKTsKPiArICAg
ICAgIH0KPgo+ICAgICAgICAgcmV0dXJuIDA7Cj4gIH0KPiBAQCAtMTcxOCwzICsxNzI5LDEwIEBA
IGludCBhbWRncHVfcmFzX2Zpbmkoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4KPiAgICAg
ICAgIHJldHVybiAwOwo+ICB9Cj4gKwo+ICt2b2lkIGFtZGdwdV9yYXNfZ2xvYmFsX3Jhc19pc3Io
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4gK3sKPiArICAgICAgIGlmIChhdG9taWNfY21w
eGNoZygmYW1kZ3B1X3Jhc19pbl9pbnRyLCAwLCAxKSA9PSAwKSB7Cj4gKyAgICAgICAgICAgICAg
IERSTV9XQVJOKCJSQVMgZXZlbnQgb2YgdHlwZSBFUlJFVkVOVF9BVEhVQl9JTlRFUlJVUFQgZGV0
ZWN0ZWQhIFN0b3BwaW5nIGFsbCBHUFUgam9icy5cbiIpOwo+ICsgICAgICAgfQo+ICt9Cj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuaCBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuaAo+IGluZGV4IGZjNGZiMGYuLjNlYzJh
ODcgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jhcy5o
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jhcy5oCj4gQEAgLTYw
MCw0ICs2MDAsMTQgQEAgaW50IGFtZGdwdV9yYXNfaW50ZXJydXB0X3JlbW92ZV9oYW5kbGVyKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+Cj4gIGludCBhbWRncHVfcmFzX2ludGVycnVwdF9k
aXNwYXRjaChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgICAgICAgICAgICAgICAgc3Ry
dWN0IHJhc19kaXNwYXRjaF9pZiAqaW5mbyk7Cj4gKwo+ICtleHRlcm4gYXRvbWljX3QgYW1kZ3B1
X3Jhc19pbl9pbnRyOwo+ICsKPiArc3RhdGljIGlubGluZSBib29sIGFtZGdwdV9yYXNfaW50cl90
cmlnZ2VyZWQodm9pZCkKPiArewo+ICsgICAgICAgcmV0dXJuICEhYXRvbWljX3JlYWQoJmFtZGdw
dV9yYXNfaW5faW50cik7Cj4gK30KPiArCj4gK3ZvaWQgYW1kZ3B1X3Jhc19nbG9iYWxfcmFzX2lz
cihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldik7Cj4gKwo+ICAjZW5kaWYKPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2dmeF92OV8wLmMKPiBpbmRleCA5M2UzZTg5Li44MTc5OTdiIDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OV8wLmMKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jCj4gQEAgLTU2NzYsMTAgKzU2NzYsMTIg
QEAgc3RhdGljIGludCBnZnhfdjlfMF9wcm9jZXNzX3Jhc19kYXRhX2NiKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2LAo+ICAgICAgICAgICAgICAgICBzdHJ1Y3QgYW1kZ3B1X2l2X2VudHJ5ICpl
bnRyeSkKPiAgewo+ICAgICAgICAgLyogVE9ETyB1ZSB3aWxsIHRyaWdnZXIgYW4gaW50ZXJydXB0
LiAqLwo+IC0gICAgICAga2dkMmtmZF9zZXRfc3JhbV9lY2NfZmxhZyhhZGV2LT5rZmQuZGV2KTsK
PiAtICAgICAgIGlmIChhZGV2LT5nZnguZnVuY3MtPnF1ZXJ5X3Jhc19lcnJvcl9jb3VudCkKPiAt
ICAgICAgICAgICAgICAgYWRldi0+Z2Z4LmZ1bmNzLT5xdWVyeV9yYXNfZXJyb3JfY291bnQoYWRl
diwgZXJyX2RhdGEpOwo+IC0gICAgICAgYW1kZ3B1X3Jhc19yZXNldF9ncHUoYWRldiwgMCk7Cj4g
KyAgICAgICBpZiAoIWFtZGdwdV9yYXNfaXNfc3VwcG9ydGVkKGFkZXYsIEFNREdQVV9SQVNfQkxP
Q0tfX0dGWCkpIHsKCkkgdGhpbmsgd2UgaGF2ZSB0byBjaGVjayBmb3IgQU1ER1BVX1JBU19CTE9D
S19fTU1IVUIgYXMgd2VsbCBzaW5jZSBpdAp3aWxsIGFsc28gY2F1c2UgYSBzeW5jIGZsb29kLgoK
PiArICAgICAgICAgICAgICAga2dkMmtmZF9zZXRfc3JhbV9lY2NfZmxhZyhhZGV2LT5rZmQuZGV2
KTsKPiArICAgICAgICAgICAgICAgaWYgKGFkZXYtPmdmeC5mdW5jcy0+cXVlcnlfcmFzX2Vycm9y
X2NvdW50KQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGFkZXYtPmdmeC5mdW5jcy0+cXVlcnlf
cmFzX2Vycm9yX2NvdW50KGFkZXYsIGVycl9kYXRhKTsKPiArICAgICAgICAgICAgICAgYW1kZ3B1
X3Jhc19yZXNldF9ncHUoYWRldiwgMCk7Cj4gKyAgICAgICB9Cj4gICAgICAgICByZXR1cm4gQU1E
R1BVX1JBU19TVUNDRVNTOwo+ICB9Cj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvZ21jX3Y5XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8w
LmMKPiBpbmRleCA1ZWIxN2M3Li4yYTZhYzYwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2dtY192OV8wLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9nbWNfdjlfMC5jCj4gQEAgLTI0MywxOCArMjQzLDIwIEBAIHN0YXRpYyBpbnQgZ21jX3Y5XzBf
cHJvY2Vzc19yYXNfZGF0YV9jYihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgICAgICAg
ICAgICAgICAgc3RydWN0IHJhc19lcnJfZGF0YSAqZXJyX2RhdGEsCj4gICAgICAgICAgICAgICAg
IHN0cnVjdCBhbWRncHVfaXZfZW50cnkgKmVudHJ5KQo+ICB7Cj4gLSAgICAgICBrZ2Qya2ZkX3Nl
dF9zcmFtX2VjY19mbGFnKGFkZXYtPmtmZC5kZXYpOwo+IC0gICAgICAgaWYgKGFkZXYtPnVtYy5m
dW5jcy0+cXVlcnlfcmFzX2Vycm9yX2NvdW50KQo+IC0gICAgICAgICAgICAgICBhZGV2LT51bWMu
ZnVuY3MtPnF1ZXJ5X3Jhc19lcnJvcl9jb3VudChhZGV2LCBlcnJfZGF0YSk7Cj4gLSAgICAgICAv
KiB1bWMgcXVlcnlfcmFzX2Vycm9yX2FkZHJlc3MgaXMgYWxzbyByZXNwb25zaWJsZSBmb3IgY2xl
YXJpbmcKPiAtICAgICAgICAqIGVycm9yIHN0YXR1cwo+IC0gICAgICAgICovCj4gLSAgICAgICBp
ZiAoYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9yYXNfZXJyb3JfYWRkcmVzcykKPiAtICAgICAgICAg
ICAgICAgYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9yYXNfZXJyb3JfYWRkcmVzcyhhZGV2LCBlcnJf
ZGF0YSk7Cj4gKyAgICAgICBpZiAoIWFtZGdwdV9yYXNfaXNfc3VwcG9ydGVkKGFkZXYsIEFNREdQ
VV9SQVNfQkxPQ0tfX0dGWCkpIHsKCkNoZWNrIGZvciBNTUhVQiBhcyB3ZWxsLgoKPiArICAgICAg
ICAgICAgICAga2dkMmtmZF9zZXRfc3JhbV9lY2NfZmxhZyhhZGV2LT5rZmQuZGV2KTsKPiArICAg
ICAgICAgICAgICAgaWYgKGFkZXYtPnVtYy5mdW5jcy0+cXVlcnlfcmFzX2Vycm9yX2NvdW50KQo+
ICsgICAgICAgICAgICAgICAgICAgICAgIGFkZXYtPnVtYy5mdW5jcy0+cXVlcnlfcmFzX2Vycm9y
X2NvdW50KGFkZXYsIGVycl9kYXRhKTsKPiArICAgICAgICAgICAgICAgLyogdW1jIHF1ZXJ5X3Jh
c19lcnJvcl9hZGRyZXNzIGlzIGFsc28gcmVzcG9uc2libGUgZm9yIGNsZWFyaW5nCj4gKyAgICAg
ICAgICAgICAgICAqIGVycm9yIHN0YXR1cwo+ICsgICAgICAgICAgICAgICAgKi8KPiArICAgICAg
ICAgICAgICAgaWYgKGFkZXYtPnVtYy5mdW5jcy0+cXVlcnlfcmFzX2Vycm9yX2FkZHJlc3MpCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9yYXNfZXJyb3Jf
YWRkcmVzcyhhZGV2LCBlcnJfZGF0YSk7Cj4KPiAtICAgICAgIC8qIG9ubHkgdW5jb3JyZWN0YWJs
ZSBlcnJvciBuZWVkcyBncHUgcmVzZXQgKi8KPiAtICAgICAgIGlmIChlcnJfZGF0YS0+dWVfY291
bnQpCj4gLSAgICAgICAgICAgICAgIGFtZGdwdV9yYXNfcmVzZXRfZ3B1KGFkZXYsIDApOwo+ICsg
ICAgICAgICAgICAgICAvKiBvbmx5IHVuY29ycmVjdGFibGUgZXJyb3IgbmVlZHMgZ3B1IHJlc2V0
ICovCj4gKyAgICAgICAgICAgICAgIGlmIChlcnJfZGF0YS0+dWVfY291bnQpCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgYW1kZ3B1X3Jhc19yZXNldF9ncHUoYWRldiwgMCk7Cj4gKyAgICAgICB9
Cj4KPiAgICAgICAgIHJldHVybiBBTURHUFVfUkFTX1NVQ0NFU1M7Cj4gIH0KPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbmJpb192N180LmMgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9uYmlvX3Y3XzQuYwo+IGluZGV4IDM2N2Y5ZDYuLjU0NTk5MGMgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbmJpb192N180LmMKPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9uYmlvX3Y3XzQuYwo+IEBAIC0zMCw2ICszMCw3IEBA
Cj4gICNpbmNsdWRlICJuYmlvL25iaW9fN180XzBfc21uLmgiCj4gICNpbmNsdWRlICJpdnNyY2lk
L25iaW8vaXJxc3Jjc19uYmlmXzdfNC5oIgo+ICAjaW5jbHVkZSA8dWFwaS9saW51eC9rZmRfaW9j
dGwuaD4KPiArI2luY2x1ZGUgImFtZGdwdV9yYXMuaCIKPgo+ICAjZGVmaW5lIHNtbk5CSUZfTUdD
R19DVFJMX0xDTEsgMHgxMDEzYTIxYwo+Cj4gQEAgLTMyOSw2ICszMzAsOCBAQCBzdGF0aWMgdm9p
ZCBuYmlvX3Y3XzRfaGFuZGxlX3Jhc19jb250cm9sbGVyX2ludHJfbm9fYmlmcmluZyhzdHJ1Y3Qg
YW1kZ3B1X2RldmljZQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEJJRl9ET09SQkVMTF9JTlRfQ05UTCwKPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBSQVNfQ05UTFJfSU5URVJSVVBUX0NMRUFSLCAxKTsKPiAg
ICAgICAgICAgICAgICAgV1JFRzMyX1NPQzE1KE5CSU8sIDAsIG1tQklGX0RPT1JCRUxMX0lOVF9D
TlRMLCBiaWZfZG9vcmJlbGxfaW50cl9jbnRsKTsKPiArCj4gKyAgICAgICAgICAgICAgIGFtZGdw
dV9yYXNfZ2xvYmFsX3Jhc19pc3IoYWRldik7Cj4gICAgICAgICB9Cj4gIH0KPgo+IEBAIC0zNDQs
NiArMzQ3LDggQEAgc3RhdGljIHZvaWQgbmJpb192N180X2hhbmRsZV9yYXNfZXJyX2V2ZW50X2F0
aHViX2ludHJfbm9fYmlmcmluZyhzdHJ1Y3QgYW1kZ3B1X2QKPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCSUZfRE9PUkJFTExfSU5UX0NOVEwsCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkFTX0FUSFVCX0VS
Ul9FVkVOVF9JTlRFUlJVUFRfQ0xFQVIsIDEpOwo+ICAgICAgICAgICAgICAgICBXUkVHMzJfU09D
MTUoTkJJTywgMCwgbW1CSUZfRE9PUkJFTExfSU5UX0NOVEwsIGJpZl9kb29yYmVsbF9pbnRyX2Nu
dGwpOwo+ICsKPiArICAgICAgICAgICAgICAgYW1kZ3B1X3Jhc19nbG9iYWxfcmFzX2lzcihhZGV2
KTsKPiAgICAgICAgIH0KPiAgfQo+Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L3NkbWFfdjRfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc2RtYV92NF8w
LmMKPiBpbmRleCBiM2VkNTMzLi5iMDU0MjhmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L3NkbWFfdjRfMC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvc2RtYV92NF8wLmMKPiBAQCAtMTk3MiwyNCArMTk3MiwyNiBAQCBzdGF0aWMgaW50IHNkbWFf
djRfMF9wcm9jZXNzX3Jhc19kYXRhX2NiKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICAg
ICAgICAgdWludDMyX3QgZXJyX3NvdXJjZTsKPiAgICAgICAgIGludCBpbnN0YW5jZTsKPgo+IC0g
ICAgICAgaW5zdGFuY2UgPSBzZG1hX3Y0XzBfaXJxX2lkX3RvX3NlcShlbnRyeS0+Y2xpZW50X2lk
KTsKPiAtICAgICAgIGlmIChpbnN0YW5jZSA8IDApCj4gLSAgICAgICAgICAgICAgIHJldHVybiAw
Owo+ICsgICAgICAgaWYgKCFhbWRncHVfcmFzX2lzX3N1cHBvcnRlZChhZGV2LCBBTURHUFVfUkFT
X0JMT0NLX19HRlgpKSB7CgpDaGVjayBmb3IgTU1IVUIgYXMgd2VsbC4KCj4gKyAgICAgICAgICAg
ICAgIGluc3RhbmNlID0gc2RtYV92NF8wX2lycV9pZF90b19zZXEoZW50cnktPmNsaWVudF9pZCk7
Cj4gKyAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZSA8IDApCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuIDA7Cj4KPiAtICAgICAgIHN3aXRjaCAoZW50cnktPnNyY19pZCkgewo+IC0g
ICAgICAgY2FzZSBTRE1BMF80XzBfX1NSQ0lEX19TRE1BX1NSQU1fRUNDOgo+IC0gICAgICAgICAg
ICAgICBlcnJfc291cmNlID0gMDsKPiAtICAgICAgICAgICAgICAgYnJlYWs7Cj4gLSAgICAgICBj
YXNlIFNETUEwXzRfMF9fU1JDSURfX1NETUFfRUNDOgo+IC0gICAgICAgICAgICAgICBlcnJfc291
cmNlID0gMTsKPiAtICAgICAgICAgICAgICAgYnJlYWs7Cj4gLSAgICAgICBkZWZhdWx0Ogo+IC0g
ICAgICAgICAgICAgICByZXR1cm4gMDsKPiAtICAgICAgIH0KPiArICAgICAgICAgICAgICAgc3dp
dGNoIChlbnRyeS0+c3JjX2lkKSB7Cj4gKyAgICAgICAgICAgICAgIGNhc2UgU0RNQTBfNF8wX19T
UkNJRF9fU0RNQV9TUkFNX0VDQzoKPiArICAgICAgICAgICAgICAgICAgICAgICBlcnJfc291cmNl
ID0gMDsKPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgICAgICAgICAg
Y2FzZSBTRE1BMF80XzBfX1NSQ0lEX19TRE1BX0VDQzoKPiArICAgICAgICAgICAgICAgICAgICAg
ICBlcnJfc291cmNlID0gMTsKPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiArICAg
ICAgICAgICAgICAgZGVmYXVsdDoKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsK
PiArICAgICAgICAgICAgICAgfQo+Cj4gLSAgICAgICBrZ2Qya2ZkX3NldF9zcmFtX2VjY19mbGFn
KGFkZXYtPmtmZC5kZXYpOwo+ICsgICAgICAgICAgICAgICBrZ2Qya2ZkX3NldF9zcmFtX2VjY19m
bGFnKGFkZXYtPmtmZC5kZXYpOwo+Cj4gLSAgICAgICBhbWRncHVfcmFzX3Jlc2V0X2dwdShhZGV2
LCAwKTsKPiArICAgICAgICAgICAgICAgYW1kZ3B1X3Jhc19yZXNldF9ncHUoYWRldiwgMCk7Cj4g
KyAgICAgICB9Cj4KPiAgICAgICAgIHJldHVybiBBTURHUFVfUkFTX1NVQ0NFU1M7Cj4gIH0KPiAt
LQo+IDIuNy40Cj4KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KYW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
