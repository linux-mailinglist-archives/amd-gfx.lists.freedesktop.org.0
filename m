Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 609F3E0B89
	for <lists+amd-gfx@lfdr.de>; Tue, 22 Oct 2019 20:38:46 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CFB9F6E8C8;
	Tue, 22 Oct 2019 18:38:44 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM04-CO1-obe.outbound.protection.outlook.com
 (mail-eopbgr690068.outbound.protection.outlook.com [40.107.69.68])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 134996E8C8
 for <amd-gfx@lists.freedesktop.org>; Tue, 22 Oct 2019 18:38:44 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=XFmJCHQ+G04+WbscmOYq8Gzt3oWIHeNjCDQGiiQigkU41Hsy34vmdEZej6o4gzwxMOAakwsu8J5lqboY66gUZzeOWGKiKTFlTurO4tSoIDT7Vbu40WC55x9LLiZYbOrn6jMIsKksuniskAvkusQnGMV0csZG3abcYrJ0uwTKx594BKdjzVimWCiIPAaUbIGXkpiKUIopv5v3vEM4LNf7ODaD5zqW1wzjUHUAoCII62ICJuwVgc/xuJyDLb9jwxSYdX/vwJKNE1B/kB7pTw5de+oonsoQ+CbSlsr3kYlaIWnkgA6/yWdtldkuD3hiVOZWJPiocWXxg+zoDHQV1XBLDQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=PL7H25BK8W9ZoOp0h1ZJqJoVIfEtOY8vIKnxvRyuGOk=;
 b=ZcpSOLNPpUC90cUrPinHUVgjaVUGL7Ntn4hwOfC4AcU3SNERupTxVa+I5oMUTRlTrfjJKui0iq9PjnTFTrHCZIdpLVbySjU9cIHpBO/rPocdI47HCDjNs40qdQid7zasEJhMoK1gnRjv90rFqr0pSjAROgbP/8izAfWrSTOpgqC44hrBLYXdqYRhfH6XGV/2zrmez2zsZxpWvM+yeGSIKmE7TyuOuTSo79UejQ0u1dNm416W0dyts9RgsSpEtYVTkZ7KRaYUNM8EWw25BsQZ3+ZCW4Azhku4vO4GVYTiAMhNKA9975iEX/v84d9fglMHlVbu6CZJD65vt+QYFyCUNA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from MWHPR12MB1453.namprd12.prod.outlook.com (10.172.55.22) by
 MWHPR12MB1198.namprd12.prod.outlook.com (10.169.203.142) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2367.24; Tue, 22 Oct 2019 18:38:42 +0000
Received: from MWHPR12MB1453.namprd12.prod.outlook.com
 ([fe80::3963:88a3:88f1:4a1d]) by MWHPR12MB1453.namprd12.prod.outlook.com
 ([fe80::3963:88a3:88f1:4a1d%4]) with mapi id 15.20.2367.022; Tue, 22 Oct 2019
 18:38:42 +0000
From: "Grodzovsky, Andrey" <Andrey.Grodzovsky@amd.com>
To: "Yang, Philip" <Philip.Yang@amd.com>, "amd-gfx@lists.freedesktop.org"
 <amd-gfx@lists.freedesktop.org>
Subject: Re: [PATCH v2] drm/amdkfd: don't use dqm lock during device
 reset/suspend/resume
Thread-Topic: [PATCH v2] drm/amdkfd: don't use dqm lock during device
 reset/suspend/resume
Thread-Index: AQHViQZ4XzhiW2lzAk+tGGEmnkv7NKdm/cqA
Date: Tue, 22 Oct 2019 18:38:42 +0000
Message-ID: <83bfc853-cb0e-4285-d310-232683130751@amd.com>
References: <20191022182804.23845-1-Philip.Yang@amd.com>
In-Reply-To: <20191022182804.23845-1-Philip.Yang@amd.com>
Accept-Language: en-GB, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: YTXPR0101CA0064.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:1::41) To MWHPR12MB1453.namprd12.prod.outlook.com
 (2603:10b6:301:e::22)
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [165.204.55.251]
x-ms-publictraffictype: Email
x-ms-office365-filtering-ht: Tenant
x-ms-office365-filtering-correlation-id: 729d05b9-dacc-46ee-708c-08d7571f0ff8
x-ms-traffictypediagnostic: MWHPR12MB1198:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <MWHPR12MB11984C55308DDE97371B7F82EA680@MWHPR12MB1198.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:10000;
x-forefront-prvs: 01986AE76B
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(376002)(366004)(39860400002)(136003)(346002)(396003)(199004)(189003)(305945005)(7736002)(2906002)(6116002)(6486002)(3846002)(52116002)(6246003)(76176011)(71190400001)(71200400001)(110136005)(316002)(6436002)(36756003)(229853002)(99286004)(6512007)(64756008)(25786009)(478600001)(81156014)(31696002)(15650500001)(8676002)(81166006)(8936002)(11346002)(14454004)(476003)(446003)(86362001)(5660300002)(31686004)(386003)(6506007)(53546011)(102836004)(26005)(256004)(14444005)(2616005)(66066001)(2501003)(486006)(66476007)(66446008)(66556008)(66946007)(186003);
 DIR:OUT; SFP:1101; SCL:1; SRVR:MWHPR12MB1198;
 H:MWHPR12MB1453.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: exAj6ASW6v+38JdW66rYjSxGPT+G3Cfkca4A/QLvIDIxEF/N3STSCQlZn6aFoqdQ78XVS8/W5kh71QqnkEtjoaT8+/OI6sT4I2qx92JbSD/2XusVZg6u+3CrAtBke1IQd3jgZGTXyjg4aKKnmbSqwrxr57ibYdzNC0a01o/GowzJfS0Z4cdhnZ9pKCRlg83E0ofTieSces1eLuggYX5ub0azCH0RSKAhofllprNJF5o6Z0zbkvM4HlBHMKXji/Z8tTVZtFasGMgwLgCwBAeBfkpBe2OEQmbf7cPIlAnVpkfmxxN/AgeBuf1UX8C4cgvn9KG66LUWtRIqUpMg7fYjvl+481VBgeI0Hx/fmlpvTqNtiNhx2NJRXdSHjNKPmC1F+nglCh6tTWcEcHUHMX5BVo0+LT/9SJu4wsc54BBcxsjNzJmNVaQh3TzMm82JaXEK
Content-ID: <63BB43F9FA78E449BC64F74145DDEAEF@namprd12.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 729d05b9-dacc-46ee-708c-08d7571f0ff8
X-MS-Exchange-CrossTenant-originalarrivaltime: 22 Oct 2019 18:38:42.1706 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: +Of8qU1+yvxjfNtpTebYLqXNQl2x2albRIGEXxz8cZT/oWIxRwVHNSiDFImS+AxXG3MUx6ZpXnL812seweKVmQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MWHPR12MB1198
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=PL7H25BK8W9ZoOp0h1ZJqJoVIfEtOY8vIKnxvRyuGOk=;
 b=PrtCb2B766oX9Q7tJisuwzHektZLFP3dzat3niQnULjLCSjdyTGWEQlgsNK5nDvfTW7+WxQCHAbo+ERUqocBC/gCI3iVIqM5dZJQYnvhNmEcxIhhpX/Qr+nLeKWFVA5N9HdmlO7RCo82LLEaDOZCLziS8wIg39xCBciApASXA7Y=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Andrey.Grodzovsky@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

T24gMTAvMjIvMTkgMjoyOCBQTSwgWWFuZywgUGhpbGlwIHdyb3RlOg0KPiBJZiBkZXZpY2UgcmVz
ZXQvc3VzcGVuZC9yZXN1bWUgZmFpbGVkIGZvciBzb21lIHJlYXNvbiwgZHFtIGxvY2sgaXMNCj4g
aG9sZCBmb3JldmVyIGFuZCB0aGlzIGNhdXNlcyBkZWFkbG9jay4gQmVsb3cgaXMgYSBrZXJuZWwg
YmFja3RyYWNlIHdoZW4NCj4gYXBwbGljYXRpb24gb3BlbiBrZmQgYWZ0ZXIgc3VzcGVuZC9yZXN1
bWUgZmFpbGVkLg0KPg0KPiBJbnN0ZWFkIG9mIGhvbGRpbmcgZHFtIGxvY2sgaW4gcHJlX3Jlc2V0
IGFuZCByZWxlYXNpbmcgZHFtIGxvY2sgaW4NCj4gcG9zdF9yZXNldCwgYWRkIGRxbS0+ZGV2aWNl
X3N0b3BwZWQgZmxhZyB3aGljaCBpcyBtb2RpZmllZCBpbg0KPiBkcW0tPm9wcy5zdGFydCBhbmQg
ZHFtLT5vcHMuc3RvcC4gVGhlIGZsYWcgZG9lc24ndCBuZWVkIGxvY2sgcHJvdGVjdGlvbg0KPiBi
ZWNhdXNlIHdyaXRlL3JlYWQgYXJlIGFsbCBpbnNpZGUgZHFtIGxvY2suDQo+DQo+IEZvciBIV1Mg
Y2FzZSwgbWFwX3F1ZXVlc19jcHNjaCBhbmQgdW5tYXBfcXVldWVzX2Nwc2NoIGNoZWNrcw0KPiBk
ZXZpY2Vfc3RvcHBlZCBmbGFnIGJlZm9yZSBzZW5kaW5nIHRoZSB1cGRhdGVkIHJ1bmxpc3QuDQoN
Cg0KSXMgdGhlcmUgYSBjaGFuY2Ugb2YgcmFjZSBjb25kaXRpb24gaGVyZSB3aGVyZSBkcW0tPmRl
dmljZV9zdG9wcGVkIA0KcmV0dXJucyB0cnVlIGZvciBzb21lIG9wZXJhdGlvbiAoZS5nLm1hcF9x
dWV1ZXNfY3BzY2gpIGJ1dCBqdXN0IGFzIGl0IA0KcHJvY2VlZHMgR1BVIHJlc2V0IHN0YXJ0c8Kg
ID8NCg0KQW5kcmV5DQoNCg0KPg0KPiB2MjogRm9yIG5vLUhXUyBjYXNlLCB3aGVuIGRldmljZSBp
cyBzdG9wcGVkLCBkb24ndCBjYWxsDQo+IGxvYWQvZGVzdHJveV9tcWQgZm9yIGV2aWN0aW9uLCBy
ZXN0b3JlIGFuZCBjcmVhdGUgcXVldWUsIGFuZCBhdm9pZA0KPiBkZWJ1Z2ZzIGR1bXAgaGRxcy4N
Cj4NCj4gQmFja3RyYWNlIG9mIGRxbSBsb2NrIGRlYWRsb2NrOg0KPg0KPiBbVGh1IE9jdCAxNyAx
Njo0MzozNyAyMDE5XSBJTkZPOiB0YXNrIHJvY21pbmZvOjMwMjQgYmxvY2tlZCBmb3IgbW9yZQ0K
PiB0aGFuIDEyMCBzZWNvbmRzLg0KPiBbVGh1IE9jdCAxNyAxNjo0MzozNyAyMDE5XSAgICAgICBO
b3QgdGFpbnRlZA0KPiA1LjAuMC1yYzEta2ZkLWNvbXB1dGUtcm9jbS1ka21zLW5vLW5waS0xMTMx
ICMxDQo+IFtUaHUgT2N0IDE3IDE2OjQzOjM3IDIwMTldICJlY2hvIDAgPg0KPiAvcHJvYy9zeXMv
a2VybmVsL2h1bmdfdGFza190aW1lb3V0X3NlY3MiIGRpc2FibGVzIHRoaXMgbWVzc2FnZS4NCj4g
W1RodSBPY3QgMTcgMTY6NDM6MzcgMjAxOV0gcm9jbWluZm8gICAgICAgIEQgICAgMCAgMzAyNCAg
IDI5NDcNCj4gMHg4MDAwMDAwMA0KPiBbVGh1IE9jdCAxNyAxNjo0MzozNyAyMDE5XSBDYWxsIFRy
YWNlOg0KPiBbVGh1IE9jdCAxNyAxNjo0MzozNyAyMDE5XSAgPyBfX3NjaGVkdWxlKzB4M2Q5LzB4
OGEwDQo+IFtUaHUgT2N0IDE3IDE2OjQzOjM3IDIwMTldICBzY2hlZHVsZSsweDMyLzB4NzANCj4g
W1RodSBPY3QgMTcgMTY6NDM6MzcgMjAxOV0gIHNjaGVkdWxlX3ByZWVtcHRfZGlzYWJsZWQrMHhh
LzB4MTANCj4gW1RodSBPY3QgMTcgMTY6NDM6MzcgMjAxOV0gIF9fbXV0ZXhfbG9jay5pc3JhLjkr
MHgxZTMvMHg0ZTANCj4gW1RodSBPY3QgMTcgMTY6NDM6MzcgMjAxOV0gID8gX19jYWxsX3NyY3Ur
MHgyNjQvMHgzYjANCj4gW1RodSBPY3QgMTcgMTY6NDM6MzcgMjAxOV0gID8gcHJvY2Vzc190ZXJt
aW5hdGlvbl9jcHNjaCsweDI0LzB4MmYwDQo+IFthbWRncHVdDQo+IFtUaHUgT2N0IDE3IDE2OjQz
OjM3IDIwMTldICBwcm9jZXNzX3Rlcm1pbmF0aW9uX2Nwc2NoKzB4MjQvMHgyZjANCj4gW2FtZGdw
dV0NCj4gW1RodSBPY3QgMTcgMTY6NDM6MzcgMjAxOV0NCj4ga2ZkX3Byb2Nlc3NfZGVxdWV1ZV9m
cm9tX2FsbF9kZXZpY2VzKzB4NDIvMHg2MCBbYW1kZ3B1XQ0KPiBbVGh1IE9jdCAxNyAxNjo0Mzoz
NyAyMDE5XSAga2ZkX3Byb2Nlc3Nfbm90aWZpZXJfcmVsZWFzZSsweDFiZS8weDIyMA0KPiBbYW1k
Z3B1XQ0KPiBbVGh1IE9jdCAxNyAxNjo0MzozNyAyMDE5XSAgX19tbXVfbm90aWZpZXJfcmVsZWFz
ZSsweDNlLzB4YzANCj4gW1RodSBPY3QgMTcgMTY6NDM6MzcgMjAxOV0gIGV4aXRfbW1hcCsweDE2
MC8weDFhMA0KPiBbVGh1IE9jdCAxNyAxNjo0MzozNyAyMDE5XSAgPyBfX2hhbmRsZV9tbV9mYXVs
dCsweGJhMy8weDEyMDANCj4gW1RodSBPY3QgMTcgMTY6NDM6MzcgMjAxOV0gID8gZXhpdF9yb2J1
c3RfbGlzdCsweDVhLzB4MTEwDQo+IFtUaHUgT2N0IDE3IDE2OjQzOjM3IDIwMTldICBtbXB1dCsw
eDRhLzB4MTIwDQo+IFtUaHUgT2N0IDE3IDE2OjQzOjM3IDIwMTldICBkb19leGl0KzB4Mjg0LzB4
YjIwDQo+IFtUaHUgT2N0IDE3IDE2OjQzOjM3IDIwMTldICA/IGhhbmRsZV9tbV9mYXVsdCsweGZh
LzB4MjAwDQo+IFtUaHUgT2N0IDE3IDE2OjQzOjM3IDIwMTldICBkb19ncm91cF9leGl0KzB4M2Ev
MHhhMA0KPiBbVGh1IE9jdCAxNyAxNjo0MzozNyAyMDE5XSAgX194NjRfc3lzX2V4aXRfZ3JvdXAr
MHgxNC8weDIwDQo+IFtUaHUgT2N0IDE3IDE2OjQzOjM3IDIwMTldICBkb19zeXNjYWxsXzY0KzB4
NGYvMHgxMDANCj4gW1RodSBPY3QgMTcgMTY6NDM6MzcgMjAxOV0gIGVudHJ5X1NZU0NBTExfNjRf
YWZ0ZXJfaHdmcmFtZSsweDQ0LzB4YTkNCj4NCj4gU3VnZ2VzdGVkLWJ5OiBGZWxpeCBLdWVobGlu
ZyA8RmVsaXguS3VlaGxpbmdAYW1kLmNvbT4NCj4gU2lnbmVkLW9mZi1ieTogUGhpbGlwIFlhbmcg
PFBoaWxpcC5ZYW5nQGFtZC5jb20+DQo+IC0tLQ0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
a2ZkL2tmZF9jaGFyZGV2LmMgICAgICB8ICA2ICstLQ0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQv
YW1ka2ZkL2tmZF9kZXZpY2UuYyAgICAgICB8ICA1IC0tDQo+ICAgLi4uL2RybS9hbWQvYW1ka2Zk
L2tmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5jIHwgNDcgKysrKysrKysrKysrKysrKystLQ0KPiAg
IC4uLi9kcm0vYW1kL2FtZGtmZC9rZmRfZGV2aWNlX3F1ZXVlX21hbmFnZXIuaCB8ICAxICsNCj4g
ICA0IGZpbGVzIGNoYW5nZWQsIDQ2IGluc2VydGlvbnMoKyksIDEzIGRlbGV0aW9ucygtKQ0KPg0K
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2NoYXJkZXYuYyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9jaGFyZGV2LmMNCj4gaW5kZXggZDllMzZk
YmYxM2Q1Li40MGQ3NWMzOWYwOGUgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1ka2ZkL2tmZF9jaGFyZGV2LmMNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQv
a2ZkX2NoYXJkZXYuYw0KPiBAQCAtMTIwLDEzICsxMjAsMTMgQEAgc3RhdGljIGludCBrZmRfb3Bl
bihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZXApDQo+ICAgCQlyZXR1cm4g
LUVQRVJNOw0KPiAgIAl9DQo+ICAgDQo+ICsJaWYgKGtmZF9pc19sb2NrZWQoKSkNCj4gKwkJcmV0
dXJuIC1FQUdBSU47DQo+ICsNCj4gICAJcHJvY2VzcyA9IGtmZF9jcmVhdGVfcHJvY2VzcyhmaWxl
cCk7DQo+ICAgCWlmIChJU19FUlIocHJvY2VzcykpDQo+ICAgCQlyZXR1cm4gUFRSX0VSUihwcm9j
ZXNzKTsNCj4gICANCj4gLQlpZiAoa2ZkX2lzX2xvY2tlZCgpKQ0KPiAtCQlyZXR1cm4gLUVBR0FJ
TjsNCj4gLQ0KPiAgIAlkZXZfZGJnKGtmZF9kZXZpY2UsICJwcm9jZXNzICVkIG9wZW5lZCwgY29t
cGF0IG1vZGUgKDMyIGJpdCkgLSAlZFxuIiwNCj4gICAJCXByb2Nlc3MtPnBhc2lkLCBwcm9jZXNz
LT5pc18zMmJpdF91c2VyX21vZGUpOw0KPiAgIA0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQv
a2ZkX2RldmljZS5jDQo+IGluZGV4IDhmNGIyNGU4NDk2NC4uNGZhODgzNGNlN2NiIDEwMDY0NA0K
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfZGV2aWNlLmMNCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZS5jDQo+IEBAIC03MzAsOSArNzMw
LDYgQEAgaW50IGtnZDJrZmRfcHJlX3Jlc2V0KHN0cnVjdCBrZmRfZGV2ICprZmQpDQo+ICAgCQly
ZXR1cm4gMDsNCj4gICAJa2dkMmtmZF9zdXNwZW5kKGtmZCk7DQo+ICAgDQo+IC0JLyogaG9sZCBk
cW0tPmxvY2sgdG8gcHJldmVudCBmdXJ0aGVyIGV4ZWN1dGlvbiovDQo+IC0JZHFtX2xvY2soa2Zk
LT5kcW0pOw0KPiAtDQo+ICAgCWtmZF9zaWduYWxfcmVzZXRfZXZlbnQoa2ZkKTsNCj4gICAJcmV0
dXJuIDA7DQo+ICAgfQ0KPiBAQCAtNzUwLDggKzc0Nyw2IEBAIGludCBrZ2Qya2ZkX3Bvc3RfcmVz
ZXQoc3RydWN0IGtmZF9kZXYgKmtmZCkNCj4gICAJaWYgKCFrZmQtPmluaXRfY29tcGxldGUpDQo+
ICAgCQlyZXR1cm4gMDsNCj4gICANCj4gLQlkcW1fdW5sb2NrKGtmZC0+ZHFtKTsNCj4gLQ0KPiAg
IAlyZXQgPSBrZmRfcmVzdW1lKGtmZCk7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0
Ow0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZV9x
dWV1ZV9tYW5hZ2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfZGV2aWNlX3F1
ZXVlX21hbmFnZXIuYw0KPiBpbmRleCA4MWZiNTQ1Y2Y0MmMuLjgyZTFjNjI4MGQxMyAxMDA2NDQN
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZV9xdWV1ZV9tYW5h
Z2VyLmMNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZV9xdWV1
ZV9tYW5hZ2VyLmMNCj4gQEAgLTM0MCw2ICszNDAsMTAgQEAgc3RhdGljIGludCBjcmVhdGVfcXVl
dWVfbm9jcHNjaChzdHJ1Y3QgZGV2aWNlX3F1ZXVlX21hbmFnZXIgKmRxbSwNCj4gICAJbXFkX21n
ci0+aW5pdF9tcWQobXFkX21nciwgJnEtPm1xZCwgcS0+bXFkX21lbV9vYmosDQo+ICAgCQkJCSZx
LT5nYXJ0X21xZF9hZGRyLCAmcS0+cHJvcGVydGllcyk7DQo+ICAgCWlmIChxLT5wcm9wZXJ0aWVz
LmlzX2FjdGl2ZSkgew0KPiArCQlpZiAoIWRxbS0+c2NoZWRfcnVubmluZykgew0KPiArCQkJV0FS
Tl9PTkNFKDEsICJMb2FkIG5vbi1IV1MgbXFkIHdoaWxlIHN0b3BwZWRcbiIpOw0KPiArCQkJZ290
byBhZGRfcXVldWVfdG9fbGlzdDsNCj4gKwkJfQ0KPiAgIA0KPiAgIAkJaWYgKFdBUk4ocS0+cHJv
Y2Vzcy0+bW0gIT0gY3VycmVudC0+bW0sDQo+ICAgCQkJCQkic2hvdWxkIG9ubHkgcnVuIGluIHVz
ZXIgdGhyZWFkIikpDQo+IEBAIC0zNTEsNiArMzU1LDcgQEAgc3RhdGljIGludCBjcmVhdGVfcXVl
dWVfbm9jcHNjaChzdHJ1Y3QgZGV2aWNlX3F1ZXVlX21hbmFnZXIgKmRxbSwNCj4gICAJCQlnb3Rv
IG91dF9mcmVlX21xZDsNCj4gICAJfQ0KPiAgIA0KPiArYWRkX3F1ZXVlX3RvX2xpc3Q6DQo+ICAg
CWxpc3RfYWRkKCZxLT5saXN0LCAmcXBkLT5xdWV1ZXNfbGlzdCk7DQo+ICAgCXFwZC0+cXVldWVf
Y291bnQrKzsNCj4gICAJaWYgKHEtPnByb3BlcnRpZXMuaXNfYWN0aXZlKQ0KPiBAQCAtNDU4LDYg
KzQ2MywxMSBAQCBzdGF0aWMgaW50IGRlc3Ryb3lfcXVldWVfbm9jcHNjaF9sb2NrZWQoc3RydWN0
IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0sDQo+ICAgDQo+ICAgCWRlYWxsb2NhdGVfZG9vcmJl
bGwocXBkLCBxKTsNCj4gICANCj4gKwlpZiAoIWRxbS0+c2NoZWRfcnVubmluZykgew0KPiArCQlX
QVJOX09OQ0UoMSwgIkRlc3Ryb3kgbm9uLUhXUyBxdWV1ZSB3aGlsZSBzdG9wcGVkXG4iKTsNCj4g
KwkJcmV0dXJuIDA7DQo+ICsJfQ0KPiArDQo+ICAgCXJldHZhbCA9IG1xZF9tZ3ItPmRlc3Ryb3lf
bXFkKG1xZF9tZ3IsIHEtPm1xZCwNCj4gICAJCQkJS0ZEX1BSRUVNUFRfVFlQRV9XQVZFRlJPTlRf
UkVTRVQsDQo+ICAgCQkJCUtGRF9VTk1BUF9MQVRFTkNZX01TLA0KPiBAQCAtNTMzLDYgKzU0Mywx
MiBAQCBzdGF0aWMgaW50IHVwZGF0ZV9xdWV1ZShzdHJ1Y3QgZGV2aWNlX3F1ZXVlX21hbmFnZXIg
KmRxbSwgc3RydWN0IHF1ZXVlICpxKQ0KPiAgIAkJICAgKHEtPnByb3BlcnRpZXMudHlwZSA9PSBL
RkRfUVVFVUVfVFlQRV9DT01QVVRFIHx8DQo+ICAgCQkgICAgcS0+cHJvcGVydGllcy50eXBlID09
IEtGRF9RVUVVRV9UWVBFX1NETUEgfHwNCj4gICAJCSAgICBxLT5wcm9wZXJ0aWVzLnR5cGUgPT0g
S0ZEX1FVRVVFX1RZUEVfU0RNQV9YR01JKSkgew0KPiArDQo+ICsJCWlmICghZHFtLT5zY2hlZF9y
dW5uaW5nKSB7DQo+ICsJCQlXQVJOX09OQ0UoMSwgIlVwZGF0ZSBub24tSFdTIHF1ZXVlIHdoaWxl
IHN0b3BwZWRcbiIpOw0KPiArCQkJZ290byBvdXRfdW5sb2NrOw0KPiArCQl9DQo+ICsNCj4gICAJ
CXJldHZhbCA9IG1xZF9tZ3ItPmRlc3Ryb3lfbXFkKG1xZF9tZ3IsIHEtPm1xZCwNCj4gICAJCQkJ
S0ZEX1BSRUVNUFRfVFlQRV9XQVZFRlJPTlRfRFJBSU4sDQo+ICAgCQkJCUtGRF9VTk1BUF9MQVRF
TkNZX01TLCBxLT5waXBlLCBxLT5xdWV1ZSk7DQo+IEBAIC02MDIsNiArNjE4LDExIEBAIHN0YXRp
YyBpbnQgZXZpY3RfcHJvY2Vzc19xdWV1ZXNfbm9jcHNjaChzdHJ1Y3QgZGV2aWNlX3F1ZXVlX21h
bmFnZXIgKmRxbSwNCj4gICAJCW1xZF9tZ3IgPSBkcW0tPm1xZF9tZ3JzW2dldF9tcWRfdHlwZV9m
cm9tX3F1ZXVlX3R5cGUoDQo+ICAgCQkJCXEtPnByb3BlcnRpZXMudHlwZSldOw0KPiAgIAkJcS0+
cHJvcGVydGllcy5pc19hY3RpdmUgPSBmYWxzZTsNCj4gKwkJZHFtLT5xdWV1ZV9jb3VudC0tOw0K
PiArDQo+ICsJCWlmICghZHFtLT5zY2hlZF9ydW5uaW5nKQ0KPiArCQkJY29udGludWU7DQo+ICsN
Cj4gICAJCXJldHZhbCA9IG1xZF9tZ3ItPmRlc3Ryb3lfbXFkKG1xZF9tZ3IsIHEtPm1xZCwNCj4g
ICAJCQkJS0ZEX1BSRUVNUFRfVFlQRV9XQVZFRlJPTlRfRFJBSU4sDQo+ICAgCQkJCUtGRF9VTk1B
UF9MQVRFTkNZX01TLCBxLT5waXBlLCBxLT5xdWV1ZSk7DQo+IEBAIC02MTAsNyArNjMxLDYgQEAg
c3RhdGljIGludCBldmljdF9wcm9jZXNzX3F1ZXVlc19ub2Nwc2NoKHN0cnVjdCBkZXZpY2VfcXVl
dWVfbWFuYWdlciAqZHFtLA0KPiAgIAkJCSAqIG1haW50YWluIGEgY29uc2lzdGVudCBldmljdGlv
biBzdGF0ZQ0KPiAgIAkJCSAqLw0KPiAgIAkJCXJldCA9IHJldHZhbDsNCj4gLQkJZHFtLT5xdWV1
ZV9jb3VudC0tOw0KPiAgIAl9DQo+ICAgDQo+ICAgb3V0Og0KPiBAQCAtNzExLDYgKzczMSwxMSBA
QCBzdGF0aWMgaW50IHJlc3RvcmVfcHJvY2Vzc19xdWV1ZXNfbm9jcHNjaChzdHJ1Y3QgZGV2aWNl
X3F1ZXVlX21hbmFnZXIgKmRxbSwNCj4gICAJCW1xZF9tZ3IgPSBkcW0tPm1xZF9tZ3JzW2dldF9t
cWRfdHlwZV9mcm9tX3F1ZXVlX3R5cGUoDQo+ICAgCQkJCXEtPnByb3BlcnRpZXMudHlwZSldOw0K
PiAgIAkJcS0+cHJvcGVydGllcy5pc19hY3RpdmUgPSB0cnVlOw0KPiArCQlkcW0tPnF1ZXVlX2Nv
dW50Kys7DQo+ICsNCj4gKwkJaWYgKCFkcW0tPnNjaGVkX3J1bm5pbmcpDQo+ICsJCQljb250aW51
ZTsNCj4gKw0KPiAgIAkJcmV0dmFsID0gbXFkX21nci0+bG9hZF9tcWQobXFkX21nciwgcS0+bXFk
LCBxLT5waXBlLA0KPiAgIAkJCQkgICAgICAgcS0+cXVldWUsICZxLT5wcm9wZXJ0aWVzLCBtbSk7
DQo+ICAgCQlpZiAocmV0dmFsICYmICFyZXQpDQo+IEBAIC03MTgsNyArNzQzLDYgQEAgc3RhdGlj
IGludCByZXN0b3JlX3Byb2Nlc3NfcXVldWVzX25vY3BzY2goc3RydWN0IGRldmljZV9xdWV1ZV9t
YW5hZ2VyICpkcW0sDQo+ICAgCQkJICogbWFpbnRhaW4gYSBjb25zaXN0ZW50IGV2aWN0aW9uIHN0
YXRlDQo+ICAgCQkJICovDQo+ICAgCQkJcmV0ID0gcmV0dmFsOw0KPiAtCQlkcW0tPnF1ZXVlX2Nv
dW50Kys7DQo+ICAgCX0NCj4gICAJcXBkLT5ldmljdGVkID0gMDsNCj4gICBvdXQ6DQo+IEBAIC05
MTUsNyArOTM5LDggQEAgc3RhdGljIGludCBzdGFydF9ub2Nwc2NoKHN0cnVjdCBkZXZpY2VfcXVl
dWVfbWFuYWdlciAqZHFtKQ0KPiAgIAkNCj4gICAJaWYgKGRxbS0+ZGV2LT5kZXZpY2VfaW5mby0+
YXNpY19mYW1pbHkgPT0gQ0hJUF9IQVdBSUkpDQo+ICAgCQlyZXR1cm4gcG1faW5pdCgmZHFtLT5w
YWNrZXRzLCBkcW0pOw0KPiAtCQ0KPiArCWRxbS0+c2NoZWRfcnVubmluZyA9IHRydWU7DQo+ICsN
Cj4gICAJcmV0dXJuIDA7DQo+ICAgfQ0KPiAgIA0KPiBAQCAtOTIzLDcgKzk0OCw4IEBAIHN0YXRp
YyBpbnQgc3RvcF9ub2Nwc2NoKHN0cnVjdCBkZXZpY2VfcXVldWVfbWFuYWdlciAqZHFtKQ0KPiAg
IHsNCj4gICAJaWYgKGRxbS0+ZGV2LT5kZXZpY2VfaW5mby0+YXNpY19mYW1pbHkgPT0gQ0hJUF9I
QVdBSUkpDQo+ICAgCQlwbV91bmluaXQoJmRxbS0+cGFja2V0cyk7DQo+IC0JDQo+ICsJZHFtLT5z
Y2hlZF9ydW5uaW5nID0gZmFsc2U7DQo+ICsNCj4gICAJcmV0dXJuIDA7DQo+ICAgfQ0KPiAgIA0K
PiBAQCAtMTA3NCw2ICsxMTAwLDcgQEAgc3RhdGljIGludCBzdGFydF9jcHNjaChzdHJ1Y3QgZGV2
aWNlX3F1ZXVlX21hbmFnZXIgKmRxbSkNCj4gICAJZHFtX2xvY2soZHFtKTsNCj4gICAJLyogY2xl
YXIgaGFuZyBzdGF0dXMgd2hlbiBkcml2ZXIgdHJ5IHRvIHN0YXJ0IHRoZSBodyBzY2hlZHVsZXIg
Ki8NCj4gICAJZHFtLT5pc19od3NfaGFuZyA9IGZhbHNlOw0KPiArCWRxbS0+c2NoZWRfcnVubmlu
ZyA9IHRydWU7DQo+ICAgCWV4ZWN1dGVfcXVldWVzX2Nwc2NoKGRxbSwgS0ZEX1VOTUFQX1FVRVVF
U19GSUxURVJfRFlOQU1JQ19RVUVVRVMsIDApOw0KPiAgIAlkcW1fdW5sb2NrKGRxbSk7DQo+ICAg
DQo+IEBAIC0xMDg5LDYgKzExMTYsNyBAQCBzdGF0aWMgaW50IHN0b3BfY3BzY2goc3RydWN0IGRl
dmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0pDQo+ICAgew0KPiAgIAlkcW1fbG9jayhkcW0pOw0KPiAg
IAl1bm1hcF9xdWV1ZXNfY3BzY2goZHFtLCBLRkRfVU5NQVBfUVVFVUVTX0ZJTFRFUl9BTExfUVVF
VUVTLCAwKTsNCj4gKwlkcW0tPnNjaGVkX3J1bm5pbmcgPSBmYWxzZTsNCj4gICAJZHFtX3VubG9j
ayhkcW0pOw0KPiAgIA0KPiAgIAlrZmRfZ3R0X3NhX2ZyZWUoZHFtLT5kZXYsIGRxbS0+ZmVuY2Vf
bWVtKTsNCj4gQEAgLTEyNzUsOSArMTMwMywxMCBAQCBzdGF0aWMgaW50IG1hcF9xdWV1ZXNfY3Bz
Y2goc3RydWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0pDQo+ICAgew0KPiAgIAlpbnQgcmV0
dmFsOw0KPiAgIA0KPiArCWlmICghZHFtLT5zY2hlZF9ydW5uaW5nKQ0KPiArCQlyZXR1cm4gMDsN
Cj4gICAJaWYgKGRxbS0+cXVldWVfY291bnQgPD0gMCB8fCBkcW0tPnByb2Nlc3Nlc19jb3VudCA8
PSAwKQ0KPiAgIAkJcmV0dXJuIDA7DQo+IC0NCj4gICAJaWYgKGRxbS0+YWN0aXZlX3J1bmxpc3Qp
DQo+ICAgCQlyZXR1cm4gMDsNCj4gICANCj4gQEAgLTEyOTksNiArMTMyOCw4IEBAIHN0YXRpYyBp
bnQgdW5tYXBfcXVldWVzX2Nwc2NoKHN0cnVjdCBkZXZpY2VfcXVldWVfbWFuYWdlciAqZHFtLA0K
PiAgIHsNCj4gICAJaW50IHJldHZhbCA9IDA7DQo+ICAgDQo+ICsJaWYgKCFkcW0tPnNjaGVkX3J1
bm5pbmcpDQo+ICsJCXJldHVybiAwOw0KPiAgIAlpZiAoZHFtLT5pc19od3NfaGFuZykNCj4gICAJ
CXJldHVybiAtRUlPOw0KPiAgIAlpZiAoIWRxbS0+YWN0aXZlX3J1bmxpc3QpDQo+IEBAIC0xOTAz
LDYgKzE5MzQsMTIgQEAgaW50IGRxbV9kZWJ1Z2ZzX2hxZHMoc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICpkYXRhKQ0KPiAgIAlpbnQgcGlwZSwgcXVldWU7DQo+ICAgCWludCByID0gMDsNCj4gICAN
Cj4gKwlpZiAoIWRxbS0+c2NoZWRfcnVubmluZykgew0KPiArCQlzZXFfcHJpbnRmKG0sICIgRGV2
aWNlIGlzIHN0b3BwZWRcbiIpOw0KPiArDQo+ICsJCXJldHVybiAwOw0KPiArCX0NCj4gKw0KPiAg
IAlyID0gZHFtLT5kZXYtPmtmZDJrZ2QtPmhxZF9kdW1wKGRxbS0+ZGV2LT5rZ2QsDQo+ICAgCQkJ
CQlLRkRfQ0lLX0hJUV9QSVBFLCBLRkRfQ0lLX0hJUV9RVUVVRSwNCj4gICAJCQkJCSZkdW1wLCAm
bl9yZWdzKTsNCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9k
ZXZpY2VfcXVldWVfbWFuYWdlci5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2Rl
dmljZV9xdWV1ZV9tYW5hZ2VyLmgNCj4gaW5kZXggMmVhZWE2YjA0Y2JlLi5hOGMzN2U2ZGEwMjcg
MTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZpY2VfcXVl
dWVfbWFuYWdlci5oDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZp
Y2VfcXVldWVfbWFuYWdlci5oDQo+IEBAIC0yMDEsNiArMjAxLDcgQEAgc3RydWN0IGRldmljZV9x
dWV1ZV9tYW5hZ2VyIHsNCj4gICAJYm9vbAkJCWlzX2h3c19oYW5nOw0KPiAgIAlzdHJ1Y3Qgd29y
a19zdHJ1Y3QJaHdfZXhjZXB0aW9uX3dvcms7DQo+ICAgCXN0cnVjdCBrZmRfbWVtX29iagloaXFf
c2RtYV9tcWQ7DQo+ICsJYm9vbAkJCXNjaGVkX3J1bm5pbmc7DQo+ICAgfTsNCj4gICANCj4gICB2
b2lkIGRldmljZV9xdWV1ZV9tYW5hZ2VyX2luaXRfY2lrKA0KX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9hbWQtZ2Z4
