Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 738B0DBC41
	for <lists+amd-gfx@lfdr.de>; Fri, 18 Oct 2019 07:00:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F3DCD6EAA5;
	Fri, 18 Oct 2019 05:00:54 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM02-SN1-obe.outbound.protection.outlook.com
 (mail-eopbgr770087.outbound.protection.outlook.com [40.107.77.87])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D7FCC6EAA5
 for <amd-gfx@lists.freedesktop.org>; Fri, 18 Oct 2019 05:00:53 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=kvI0E5inNj+WrUM9/7ze1t0vbSiR1HXfQA8EJfDidPzHRba74XwZD9p5ll8jWcXhGsBjNpXeki67TMIYVXxm8wbb6ZiD7gc6KCjkLqt9DLOU3wK0ZhB855iWKKmK9QMdkOnYFnPSVNYvz0J0Kvrjm+eITFLQ5gki+DLaBriLJ+KcwbrrImPEmLPCh1doTIGo7CGYSINsx2ueCZsWnMLO3eaHJJw+RzwR+Botp5O1hSxOCl/DiwYZxg2h5mL/VPM4ycQgnp3q9Bklo3OxiIXagrzHnku2mCmUzReTlTd9GIo6WBDGCuKoz3r4cZ5ywXXw2s54uKVdi2hFjUr8aogtUA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=grkuq0kv7JxIeg8f7/k2sSTF9CitUrRvSdodVdNzaFM=;
 b=ETyUF2tS3Q7keFGOBp9RWugrl8tLHKX1ojKmHuv4O8Jrpg9+Nv0HehaZ6fjpI3H+G11BcF7iPl78IzMohYkwBxrZdUsK+b/QC5Uw1nmrOHOzOgCEsyr2NU2MU9rWKV1JH1qYeoJIKJgV25dEqtUlHUj/g3Lf1JFNw/veqXQtOnlOXD6msfExpT07nOSFaZzzR2UmvkIorr1N2+43NvvEcfrhsBal1mV677zt8mk9QnxsIARfEEizLIdioWs2yM2TW9/XEBCKOq03IE5R2jAw8UPX9biMSoqAuKaqg2nlpAhV8PPKWi//ODdoOGae5xx3JZvg5K+ZmddiF9LEWS4Kaw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from BN8PR12MB3329.namprd12.prod.outlook.com (20.178.208.93) by
 BN8PR12MB3393.namprd12.prod.outlook.com (20.178.211.156) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2347.18; Fri, 18 Oct 2019 05:00:50 +0000
Received: from BN8PR12MB3329.namprd12.prod.outlook.com
 ([fe80::28c4:55fd:ee27:8560]) by BN8PR12MB3329.namprd12.prod.outlook.com
 ([fe80::28c4:55fd:ee27:8560%7]) with mapi id 15.20.2347.023; Fri, 18 Oct 2019
 05:00:50 +0000
From: "Quan, Evan" <Evan.Quan@amd.com>
To: "Grodzovsky, Andrey" <Andrey.Grodzovsky@amd.com>,
 "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: RE: [PATCH] drm/amd/powerplay: add lock protection for swSMU APIs
Thread-Topic: [PATCH] drm/amd/powerplay: add lock protection for swSMU APIs
Thread-Index: AQHVhJ7FlmM4UII0ZkOOWAgJrddWNade40KAgADxZFA=
Date: Fri, 18 Oct 2019 05:00:50 +0000
Message-ID: <BN8PR12MB3329D226D87BBCC255E1EE42E46C0@BN8PR12MB3329.namprd12.prod.outlook.com>
References: <20191017035532.24894-1-evan.quan@amd.com>
 <5f926214-e197-3f79-e969-81ab9dfbe4e1@amd.com>
In-Reply-To: <5f926214-e197-3f79-e969-81ab9dfbe4e1@amd.com>
Accept-Language: en-US, zh-CN
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [180.167.199.189]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 40ee53cc-efa3-4093-9b55-08d753882598
x-ms-office365-filtering-ht: Tenant
x-ms-traffictypediagnostic: BN8PR12MB3393:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <BN8PR12MB3393C1FFFC5B69B6490C2532E46C0@BN8PR12MB3393.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:7219;
x-forefront-prvs: 01949FE337
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(396003)(136003)(376002)(39860400002)(346002)(366004)(199004)(189003)(13464003)(30864003)(6246003)(6116002)(66556008)(3846002)(6436002)(66446008)(102836004)(66946007)(66476007)(64756008)(26005)(53546011)(76176011)(66574012)(6506007)(2906002)(81166006)(81156014)(71190400001)(76116006)(186003)(8676002)(8936002)(71200400001)(11346002)(316002)(5660300002)(25786009)(14444005)(9686003)(86362001)(110136005)(33656002)(256004)(486006)(7696005)(14454004)(7736002)(305945005)(74316002)(99286004)(55016002)(478600001)(66066001)(476003)(229853002)(446003)(52536014)(2501003)(559001)(569006);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BN8PR12MB3393;
 H:BN8PR12MB3329.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: 3hsULOREfARJKZrwn+HhIm20Q6mw+HimxRWYMhNiJ3sN3EKyZbLZ/EETURl4Xq9uebYrBnk3WkaPGQw5LS1+OtDjXQCAaSAvC61o6vHd4La4P0g90wGt5aluQaXrQF1JTskpXOO78+Ymo34h/iXbJGzr5dsxPzu5sWe8ICBhFcdY7HvFGHV1+7fJuR1TzrpxkXDMj37ejSAS5z1B9NYjI6+Sov9n9ABvVIWXePywVvLqZCUZHdDrG9zFUn33WNMNuJaNuFF+rIQA2geuY4CXdYMpsIP1X1c/uBGnKdqIDBJ5OxntuQOPyAozn6kTMuahr6uOKG8GBEW6kBj55zCbgCphIgjYY5nTwX5me/qpqH03m4DdK33U4gHP8bVXnOxClVZ3zcwuh3AbS0GDZqC/QcLTh2fWyURXDLxcKcHOXo8=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 40ee53cc-efa3-4093-9b55-08d753882598
X-MS-Exchange-CrossTenant-originalarrivaltime: 18 Oct 2019 05:00:50.5711 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: zN4gz6Pm2IaV8C6B0AXqLtwTJ+jglUM9+Chg4Kl1oLL4Sty3EX+UHT6X8uRI4o5X
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN8PR12MB3393
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=grkuq0kv7JxIeg8f7/k2sSTF9CitUrRvSdodVdNzaFM=;
 b=1BHtIpBUeX3kfz/Z05y+uDkKgekGL//MHA811Ac0bH386p3+IompPQSPTLg0MPeXpoKBUHgyL5S8W+pKc6NbyISFczBZDxDXw2mlCpLkd9IADp9nBGidzQMyHhm10O7Hz2d6So3H6jhb7uwTNMv/1bM78DeXYzm7GTw6zjlSd3g=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Evan.Quan@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

DQoNCi0tLS0tT3JpZ2luYWwgTWVzc2FnZS0tLS0tDQpGcm9tOiBHcm9kem92c2t5LCBBbmRyZXkg
PEFuZHJleS5Hcm9kem92c2t5QGFtZC5jb20+IA0KU2VudDogVGh1cnNkYXksIE9jdG9iZXIgMTcs
IDIwMTkgMTA6MjIgUE0NClRvOiBRdWFuLCBFdmFuIDxFdmFuLlF1YW5AYW1kLmNvbT47IGFtZC1n
ZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnDQpTdWJqZWN0OiBSZTogW1BBVENIXSBkcm0vYW1kL3Bv
d2VycGxheTogYWRkIGxvY2sgcHJvdGVjdGlvbiBmb3Igc3dTTVUgQVBJcw0KDQoNCk9uIDEwLzE2
LzE5IDExOjU1IFBNLCBRdWFuLCBFdmFuIHdyb3RlOg0KPiBUaGlzIGlzIGEgcXVpY2sgYW5kIGxv
dyByaXNrIGZpeC4gVGhvc2UgQVBJcyB3aGljaA0KPiBhcmUgZXhwb3NlZCB0byBvdGhlciBJUHMg
b3IgdG8gc3VwcG9ydCBzeXNmcy9od21vbg0KPiBpbnRlcmZhY2VzIG9yIERBTCB3aWxsIGhhdmUg
bG9jayBwcm90ZWN0aW9uLiBNZWFud2hpbGUNCj4gbm8gbG9jayBwcm90ZWN0aW9uIGlzIGVuZm9y
Y2VkIGZvciBzd1NNVSBpbnRlcm5hbCB1c2VkDQo+IEFQSXMuIEZ1dHVyZSBvcHRpbWl6YXRpb24g
aXMgbmVlZGVkLg0KDQoNCkRvZXMgaXQgbWVhbiB0aGF0IHRoZXJlIGlzIHN0aWxsIHJpc2sgb2Yg
Y29sbGlzaW9uIG9uIFNNVSBhY2Nlc3MgYmV0d2VlbiANCmV4dGVybmFsIEFQSSBmdW5jdGlvbiB0
byBpbnRlcm5hbCBvbmUgPw0KDQpbUXVhbiwgRXZhbl0gc2hvdWxkIG5vdC4gTmVpdGhlciBTTVUg
b3Igb3RoZXIgSVBzIHNob3VsZCBhY2Nlc3MgdGhvc2UgaW50ZXJuYWwgQVBJcyBkaXJlY3RseSBh
ZnRlciBTTVUgaXAgc2V0dXAgY29tcGxldGVseShhZnRlciBsYXRlX2ludCkuDQpUaGUgYWNjZXNz
IHNob3VsZCBhbHdheXMgYmUgdGhyb3VnaCB0aG9zZSBleHRlcm5hbCBBUElzLiBJbiBmYWN0IEkg
cnVuIGEgY29tcHV0ZSBzdHJlc3MgdGVzdCBvdmVyIG5pZ2h0IHdpdGggMTAgdGVybWluYWxzIGFj
Y2Vzc2luZyB0aGUgYW1kZ3B1X3BtX2luZm8gc3lzZnMgYXQgdGhlIHNhbWUgdGltZSBhbmQgZGlk
IG5vdCBzZWUgYW55IHByb2JsZW0uIFNvLCB0aGUgaW1wbGVtZW50YXRpb24gc2hvdWxkIGJlIHNh
ZmUuDQpUaGUgIm9wdGltaXphdGlvbiIgbWVudGlvbmVkIGhlcmUgaXMgYWJvdXQgY29kZSBzdHls
ZSBhbmQgcmVhZGFiaWxpdHkuDQoNCkFuZHJleQ0KDQoNCj4NCj4gQ2hhbmdlLUlkOiBJODM5MjY1
MmM5ZGExNTc0YTg1YWNkOWIxNzFmMDQzODBmMzYzMDg1Mg0KPiBTaWduZWQtb2ZmLWJ5OiBFdmFu
IFF1YW4gPGV2YW4ucXVhbkBhbWQuY29tPg0KPiAtLS0NCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfZHBtLmMgICAgICAgfCAgIDYgKy0NCj4gICBkcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfZHBtLmggICAgICAgfCAgIDYgLQ0KPiAgIGRyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jICAgICAgICB8ICAyMyArLQ0KPiAgIC4uLi9hbWQvZGlz
cGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX3BwX3NtdS5jICB8ICAgNCArLQ0KPiAgIGRyaXZlcnMv
Z3B1L2RybS9hbWQvcG93ZXJwbGF5L2FtZGdwdV9zbXUuYyAgICB8IDY4NCArKysrKysrKysrKysr
KysrLS0NCj4gICAuLi4vZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2luYy9hbWRncHVfc211LmggICAg
fCAxNjMgKysrLS0NCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0
LmMgICAgfCAgMTUgKy0NCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9yZW5vaXJf
cHB0LmMgICAgfCAgMTIgKy0NCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9zbXVf
djExXzAuYyAgICAgfCAgIDcgKy0NCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92
ZWdhMjBfcHB0LmMgICAgfCAgIDYgKy0NCj4gICAxMCBmaWxlcyBjaGFuZ2VkLCA3NzMgaW5zZXJ0
aW9ucygrKSwgMTUzIGRlbGV0aW9ucygtKQ0KPg0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2RwbS5jDQo+IGluZGV4IDI2MzI2NTI0NWUxOS4uMjhkMzI3MjUyODViIDEwMDY0NA0K
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHBtLmMNCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5jDQo+IEBAIC05MTIsNyArOTEy
LDggQEAgaW50IGFtZGdwdV9kcG1fZ2V0X3NjbGsoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
IGJvb2wgbG93KQ0KPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsNCj4gICAJCXJl
dCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2UoJmFkZXYtPnNtdSwgU01VX0dGWENMSywNCj4gICAJ
CQkJCSAgICAgbG93ID8gJmNsa19mcmVxIDogTlVMTCwNCj4gLQkJCQkJICAgICAhbG93ID8gJmNs
a19mcmVxIDogTlVMTCk7DQo+ICsJCQkJCSAgICAgIWxvdyA/ICZjbGtfZnJlcSA6IE5VTEwsDQo+
ICsJCQkJCSAgICAgdHJ1ZSk7DQo+ICAgCQlpZiAocmV0KQ0KPiAgIAkJCXJldHVybiAwOw0KPiAg
IAkJcmV0dXJuIGNsa19mcmVxICogMTAwOw0KPiBAQCAtOTMwLDcgKzkzMSw4IEBAIGludCBhbWRn
cHVfZHBtX2dldF9tY2xrKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBib29sIGxvdykNCj4g
ICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7DQo+ICAgCQlyZXQgPSBzbXVfZ2V0X2Rw
bV9mcmVxX3JhbmdlKCZhZGV2LT5zbXUsIFNNVV9VQ0xLLA0KPiAgIAkJCQkJICAgICBsb3cgPyAm
Y2xrX2ZyZXEgOiBOVUxMLA0KPiAtCQkJCQkgICAgICFsb3cgPyAmY2xrX2ZyZXEgOiBOVUxMKTsN
Cj4gKwkJCQkJICAgICAhbG93ID8gJmNsa19mcmVxIDogTlVMTCwNCj4gKwkJCQkJICAgICB0cnVl
KTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJcmV0dXJuIDA7DQo+ICAgCQlyZXR1cm4gY2xrX2Zy
ZXEgKiAxMDA7DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfZHBtLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHBtLmgNCj4gaW5k
ZXggMWM1YzBmZDc2ZGJmLi4yY2ZiNjc3MjcyYWYgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0uaA0KPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfZHBtLmgNCj4gQEAgLTI5OCwxMiArMjk4LDYgQEAgZW51bSBhbWRncHVf
cGNpZV9nZW4gew0KPiAgICNkZWZpbmUgYW1kZ3B1X2RwbV9nZXRfY3VycmVudF9wb3dlcl9zdGF0
ZShhZGV2KSBcDQo+ICAgCQkoKGFkZXYpLT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9jdXJyZW50
X3Bvd2VyX3N0YXRlKChhZGV2KS0+cG93ZXJwbGF5LnBwX2hhbmRsZSkpDQo+ICAgDQo+IC0jZGVm
aW5lIGFtZGdwdV9zbXVfZ2V0X2N1cnJlbnRfcG93ZXJfc3RhdGUoYWRldikgXA0KPiAtCQkoKGFk
ZXYpLT5zbXUucHB0X2Z1bmNzLT5nZXRfY3VycmVudF9wb3dlcl9zdGF0ZSgmKChhZGV2KS0+c211
KSkpDQo+IC0NCj4gLSNkZWZpbmUgYW1kZ3B1X3NtdV9zZXRfcG93ZXJfc3RhdGUoYWRldikgXA0K
PiAtCQkoKGFkZXYpLT5zbXUucHB0X2Z1bmNzLT5zZXRfcG93ZXJfc3RhdGUoJigoYWRldiktPnNt
dSkpKQ0KPiAtDQo+ICAgI2RlZmluZSBhbWRncHVfZHBtX2dldF9wcF9udW1fc3RhdGVzKGFkZXYs
IGRhdGEpIFwNCj4gICAJCSgoYWRldiktPnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0X3BwX251bV9z
dGF0ZXMoKGFkZXYpLT5wb3dlcnBsYXkucHBfaGFuZGxlLCBkYXRhKSkNCj4gICANCj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BtLmMNCj4gaW5kZXggYzUwZDVmMWU3NWU1Li4zNmYz
NmIzNTAwMGQgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9wbS5jDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jDQo+
IEBAIC0yMTEsNyArMjExLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9kcG1fc3RhdGUo
c3RydWN0IGRldmljZSAqZGV2LA0KPiAgIA0KPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRl
dikpIHsNCj4gICAJCWlmIChhZGV2LT5zbXUucHB0X2Z1bmNzLT5nZXRfY3VycmVudF9wb3dlcl9z
dGF0ZSkNCj4gLQkJCXBtID0gYW1kZ3B1X3NtdV9nZXRfY3VycmVudF9wb3dlcl9zdGF0ZShhZGV2
KTsNCj4gKwkJCXBtID0gc211X2dldF9jdXJyZW50X3Bvd2VyX3N0YXRlKCZhZGV2LT5zbXUpOw0K
PiAgIAkJZWxzZQ0KPiAgIAkJCXBtID0gYWRldi0+cG0uZHBtLnVzZXJfc3RhdGU7DQo+ICAgCX0g
ZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfY3VycmVudF9wb3dlcl9zdGF0
ZSkgew0KPiBAQCAtOTU3LDcgKzk1Nyw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBf
ZHBtX3NjbGsoc3RydWN0IGRldmljZSAqZGV2LA0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4g
ICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPiAtCQlyZXQgPSBzbXVfZm9yY2VfY2xr
X2xldmVscygmYWRldi0+c211LCBTTVVfU0NMSywgbWFzayk7DQo+ICsJCXJldCA9IHNtdV9mb3Jj
ZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9TQ0xLLCBtYXNrLCB0cnVlKTsNCj4gICAJZWxz
ZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5mb3JjZV9jbG9ja19sZXZlbCkNCj4gICAJ
CXJldCA9IGFtZGdwdV9kcG1fZm9yY2VfY2xvY2tfbGV2ZWwoYWRldiwgUFBfU0NMSywgbWFzayk7
DQo+ICAgDQo+IEBAIC0xMDA0LDcgKzEwMDQsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0
X3BwX2RwbV9tY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4gICAJCXJldHVybiByZXQ7DQo+ICAg
DQo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkNCj4gLQkJcmV0ID0gc211X2ZvcmNl
X2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX01DTEssIG1hc2spOw0KPiArCQlyZXQgPSBzbXVf
Zm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfTUNMSywgbWFzaywgdHJ1ZSk7DQo+ICAg
CWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpDQo+
ICAgCQlyZXQgPSBhbWRncHVfZHBtX2ZvcmNlX2Nsb2NrX2xldmVsKGFkZXYsIFBQX01DTEssIG1h
c2spOw0KPiAgIA0KPiBAQCAtMTA0NCw3ICsxMDQ0LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X3NldF9wcF9kcG1fc29jY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4gICAJCXJldHVybiByZXQ7
DQo+ICAgDQo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkNCj4gLQkJcmV0ID0gc211
X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX1NPQ0NMSywgbWFzayk7DQo+ICsJCXJl
dCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9TT0NDTEssIG1hc2ssIHRy
dWUpOw0KPiAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNlX2Nsb2Nr
X2xldmVsKQ0KPiAgIAkJcmV0ID0gYW1kZ3B1X2RwbV9mb3JjZV9jbG9ja19sZXZlbChhZGV2LCBQ
UF9TT0NDTEssIG1hc2spOw0KPiAgIA0KPiBAQCAtMTA4NCw3ICsxMDg0LDcgQEAgc3RhdGljIHNz
aXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fZmNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+ICAgCQly
ZXR1cm4gcmV0Ow0KPiAgIA0KPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpDQo+IC0J
CXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9GQ0xLLCBtYXNrKTsN
Cj4gKwkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX0ZDTEssIG1h
c2ssIHRydWUpOw0KPiAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNl
X2Nsb2NrX2xldmVsKQ0KPiAgIAkJcmV0ID0gYW1kZ3B1X2RwbV9mb3JjZV9jbG9ja19sZXZlbChh
ZGV2LCBQUF9GQ0xLLCBtYXNrKTsNCj4gICANCj4gQEAgLTExMjQsNyArMTEyNCw3IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX2RjZWZjbGsoc3RydWN0IGRldmljZSAqZGV2LA0K
PiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYp
KQ0KPiAtCQlyZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfRENFRkNM
SywgbWFzayk7DQo+ICsJCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNN
VV9EQ0VGQ0xLLCBtYXNrLCB0cnVlKTsNCj4gICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBw
X2Z1bmNzLT5mb3JjZV9jbG9ja19sZXZlbCkNCj4gICAJCXJldCA9IGFtZGdwdV9kcG1fZm9yY2Vf
Y2xvY2tfbGV2ZWwoYWRldiwgUFBfRENFRkNMSywgbWFzayk7DQo+ICAgDQo+IEBAIC0xMTY0LDcg
KzExNjQsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9wY2llKHN0cnVjdCBk
ZXZpY2UgKmRldiwNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+ICAgCWlmIChpc19zdXBwb3J0
X3N3X3NtdShhZGV2KSkNCj4gLQkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNt
dSwgU01VX1BDSUUsIG1hc2spOw0KPiArCQlyZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRl
di0+c211LCBTTVVfUENJRSwgbWFzaywgdHJ1ZSk7DQo+ICAgCWVsc2UgaWYgKGFkZXYtPnBvd2Vy
cGxheS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpDQo+ICAgCQlyZXQgPSBhbWRncHVfZHBt
X2ZvcmNlX2Nsb2NrX2xldmVsKGFkZXYsIFBQX1BDSUUsIG1hc2spOw0KPiAgIA0KPiBAQCAtMTM1
Niw3ICsxMzU2LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9wb3dlcl9wcm9maWxl
X21vZGUoc3RydWN0IGRldmljZSAqZGV2LA0KPiAgIAl9DQo+ICAgCXBhcmFtZXRlcltwYXJhbWV0
ZXJfc2l6ZV0gPSBwcm9maWxlX21vZGU7DQo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2
KSkNCj4gLQkJcmV0ID0gc211X3NldF9wb3dlcl9wcm9maWxlX21vZGUoJmFkZXYtPnNtdSwgcGFy
YW1ldGVyLCBwYXJhbWV0ZXJfc2l6ZSk7DQo+ICsJCXJldCA9IHNtdV9zZXRfcG93ZXJfcHJvZmls
ZV9tb2RlKCZhZGV2LT5zbXUsIHBhcmFtZXRlciwgcGFyYW1ldGVyX3NpemUsIHRydWUpOw0KPiAg
IAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPnNldF9wb3dlcl9wcm9maWxlX21v
ZGUpDQo+ICAgCQlyZXQgPSBhbWRncHVfZHBtX3NldF9wb3dlcl9wcm9maWxlX21vZGUoYWRldiwg
cGFyYW1ldGVyLCBwYXJhbWV0ZXJfc2l6ZSk7DQo+ICAgCWlmICghcmV0KQ0KPiBAQCAtMjA2NSw3
ICsyMDY1LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfcG93ZXJfY2FwX21h
eChzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+ICAgCXVpbnQzMl90IGxpbWl0ID0gMDsNCj4gICANCj4g
ICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7DQo+IC0JCXNtdV9nZXRfcG93ZXJfbGlt
aXQoJmFkZXYtPnNtdSwgJmxpbWl0LCB0cnVlKTsNCj4gKwkJc211X2dldF9wb3dlcl9saW1pdCgm
YWRldi0+c211LCAmbGltaXQsIHRydWUsIHRydWUpOw0KPiAgIAkJcmV0dXJuIHNucHJpbnRmKGJ1
ZiwgUEFHRV9TSVpFLCAiJXVcbiIsIGxpbWl0ICogMTAwMDAwMCk7DQo+ICAgCX0gZWxzZSBpZiAo
YWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzICYmIGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0
X3Bvd2VyX2xpbWl0KSB7DQo+ICAgCQlhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9wb3dl
cl9saW1pdChhZGV2LT5wb3dlcnBsYXkucHBfaGFuZGxlLCAmbGltaXQsIHRydWUpOw0KPiBAQCAt
MjA4Myw3ICsyMDgzLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfcG93ZXJf
Y2FwKHN0cnVjdCBkZXZpY2UgKmRldiwNCj4gICAJdWludDMyX3QgbGltaXQgPSAwOw0KPiAgIA0K
PiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsNCj4gLQkJc211X2dldF9wb3dlcl9s
aW1pdCgmYWRldi0+c211LCAmbGltaXQsIGZhbHNlKTsNCj4gKwkJc211X2dldF9wb3dlcl9saW1p
dCgmYWRldi0+c211LCAmbGltaXQsIGZhbHNlLCAgdHJ1ZSk7DQo+ICAgCQlyZXR1cm4gc25wcmlu
dGYoYnVmLCBQQUdFX1NJWkUsICIldVxuIiwgbGltaXQgKiAxMDAwMDAwKTsNCj4gICAJfSBlbHNl
IGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MgJiYgYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNz
LT5nZXRfcG93ZXJfbGltaXQpIHsNCj4gICAJCWFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0
X3Bvd2VyX2xpbWl0KGFkZXYtPnBvd2VycGxheS5wcF9oYW5kbGUsICZsaW1pdCwgZmFsc2UpOw0K
PiBAQCAtMzA2NCw3ICszMDY0LDggQEAgdm9pZCBhbWRncHVfcG1fY29tcHV0ZV9jbG9ja3Moc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpDQo+ICAgCQlzdHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpz
bXVfZHBtID0gJmFkZXYtPnNtdS5zbXVfZHBtOw0KPiAgIAkJc211X2hhbmRsZV90YXNrKCZhZGV2
LT5zbXUsDQo+ICAgCQkJCXNtdV9kcG0tPmRwbV9sZXZlbCwNCj4gLQkJCQlBTURfUFBfVEFTS19E
SVNQTEFZX0NPTkZJR19DSEFOR0UpOw0KPiArCQkJCUFNRF9QUF9UQVNLX0RJU1BMQVlfQ09ORklH
X0NIQU5HRSwNCj4gKwkJCQl0cnVlKTsNCj4gICAJfSBlbHNlIHsNCj4gICAJCWlmIChhZGV2LT5w
b3dlcnBsYXkucHBfZnVuY3MtPmRpc3BhdGNoX3Rhc2tzKSB7DQo+ICAgCQkJaWYgKCFhbWRncHVf
ZGV2aWNlX2hhc19kY19zdXBwb3J0KGFkZXYpKSB7DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9wcF9zbXUuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX3BwX3NtdS5jDQo+IGluZGV4
IDEzNTIwMTk2NDhjMC4uZWU5OTE1ZDYxY2YxIDEwMDY0NA0KPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9wcF9zbXUuYw0KPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9wcF9zbXUuYw0KPiBA
QCAtODc2LDcgKzg3Niw3IEBAIGVudW0gcHBfc211X3N0YXR1cyBwcF9udl9nZXRfbWF4aW11bV9z
dXN0YWluYWJsZV9jbG9ja3MoDQo+ICAgCWlmICghc211LT5mdW5jcy0+Z2V0X21heF9zdXN0YWlu
YWJsZV9jbG9ja3NfYnlfZGMpDQo+ICAgCQlyZXR1cm4gUFBfU01VX1JFU1VMVF9VTlNVUFBPUlRF
RDsNCj4gICANCj4gLQlpZiAoIXNtdS0+ZnVuY3MtPmdldF9tYXhfc3VzdGFpbmFibGVfY2xvY2tz
X2J5X2RjKHNtdSwgbWF4X2Nsb2NrcykpDQo+ICsJaWYgKCFzbXVfZ2V0X21heF9zdXN0YWluYWJs
ZV9jbG9ja3NfYnlfZGMoc211LCBtYXhfY2xvY2tzKSkNCj4gICAJCXJldHVybiBQUF9TTVVfUkVT
VUxUX09LOw0KPiAgIA0KPiAgIAlyZXR1cm4gUFBfU01VX1JFU1VMVF9GQUlMOw0KPiBAQCAtODk1
LDcgKzg5NSw3IEBAIGVudW0gcHBfc211X3N0YXR1cyBwcF9udl9nZXRfdWNsa19kcG1fc3RhdGVz
KHN0cnVjdCBwcF9zbXUgKnBwLA0KPiAgIAlpZiAoIXNtdS0+cHB0X2Z1bmNzLT5nZXRfdWNsa19k
cG1fc3RhdGVzKQ0KPiAgIAkJcmV0dXJuIFBQX1NNVV9SRVNVTFRfVU5TVVBQT1JURUQ7DQo+ICAg
DQo+IC0JaWYgKCFzbXUtPnBwdF9mdW5jcy0+Z2V0X3VjbGtfZHBtX3N0YXRlcyhzbXUsDQo+ICsJ
aWYgKCFzbXVfZ2V0X3VjbGtfZHBtX3N0YXRlcyhzbXUsDQo+ICAgCQkJY2xvY2tfdmFsdWVzX2lu
X2toeiwgbnVtX3N0YXRlcykpDQo+ICAgCQlyZXR1cm4gUFBfU01VX1JFU1VMVF9PSzsNCj4gICAN
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2FtZGdwdV9zbXUu
YyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2FtZGdwdV9zbXUuYw0KPiBpbmRleCAy
NmNhY2M4OTlkZmUuLmRhM2ViOGU0NzEyYiAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
cG93ZXJwbGF5L2FtZGdwdV9zbXUuYw0KPiBAQCAtNjcsNiArNjcsOCBAQCBzaXplX3Qgc211X3N5
c19nZXRfcHBfZmVhdHVyZV9tYXNrKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBjaGFyICpidWYp
DQo+ICAgCXVpbnQzMl90IHNvcnRfZmVhdHVyZVtTTVVfRkVBVFVSRV9DT1VOVF07DQo+ICAgCXVp
bnQ2NF90IGh3X2ZlYXR1cmVfY291bnQgPSAwOw0KPiAgIA0KPiArCW11dGV4X2xvY2soJnNtdS0+
bXV0ZXgpOw0KPiArDQo+ICAgCXJldCA9IHNtdV9mZWF0dXJlX2dldF9lbmFibGVkX21hc2soc211
LCBmZWF0dXJlX21hc2ssIDIpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJZ290byBmYWlsZWQ7DQo+
IEBAIC05Miw2ICs5NCw4IEBAIHNpemVfdCBzbXVfc3lzX2dldF9wcF9mZWF0dXJlX21hc2soc3Ry
dWN0IHNtdV9jb250ZXh0ICpzbXUsIGNoYXIgKmJ1ZikNCj4gICAJfQ0KPiAgIA0KPiAgIGZhaWxl
ZDoNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICAgCXJldHVybiBzaXpl
Ow0KPiAgIH0NCj4gICANCj4gQEAgLTE0OSw5ICsxNTMsMTEgQEAgaW50IHNtdV9zeXNfc2V0X3Bw
X2ZlYXR1cmVfbWFzayhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDY0X3QgbmV3X21hc2sp
DQo+ICAgCXVpbnQ2NF90IGZlYXR1cmVfMl9kaXNhYmxlZCA9IDA7DQo+ICAgCXVpbnQ2NF90IGZl
YXR1cmVfZW5hYmxlcyA9IDA7DQo+ICAgDQo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+
ICsNCj4gICAJcmV0ID0gc211X2ZlYXR1cmVfZ2V0X2VuYWJsZWRfbWFzayhzbXUsIGZlYXR1cmVf
bWFzaywgMik7DQo+ICAgCWlmIChyZXQpDQo+IC0JCXJldHVybiByZXQ7DQo+ICsJCWdvdG8gb3V0
Ow0KPiAgIA0KPiAgIAlmZWF0dXJlX2VuYWJsZXMgPSAoKHVpbnQ2NF90KWZlYXR1cmVfbWFza1sx
XSA8PCAzMiB8ICh1aW50NjRfdClmZWF0dXJlX21hc2tbMF0pOw0KPiAgIA0KPiBAQCAtMTYxLDE0
ICsxNjcsMTcgQEAgaW50IHNtdV9zeXNfc2V0X3BwX2ZlYXR1cmVfbWFzayhzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSwgdWludDY0X3QgbmV3X21hc2spDQo+ICAgCWlmIChmZWF0dXJlXzJfZW5hYmxl
ZCkgew0KPiAgIAkJcmV0ID0gc211X2ZlYXR1cmVfdXBkYXRlX2VuYWJsZV9zdGF0ZShzbXUsIGZl
YXR1cmVfMl9lbmFibGVkLCB0cnVlKTsNCj4gICAJCWlmIChyZXQpDQo+IC0JCQlyZXR1cm4gcmV0
Ow0KPiArCQkJZ290byBvdXQ7DQo+ICAgCX0NCj4gICAJaWYgKGZlYXR1cmVfMl9kaXNhYmxlZCkg
ew0KPiAgIAkJcmV0ID0gc211X2ZlYXR1cmVfdXBkYXRlX2VuYWJsZV9zdGF0ZShzbXUsIGZlYXR1
cmVfMl9kaXNhYmxlZCwgZmFsc2UpOw0KPiAgIAkJaWYgKHJldCkNCj4gLQkJCXJldHVybiByZXQ7
DQo+ICsJCQlnb3RvIG91dDsNCj4gICAJfQ0KPiAgIA0KPiArb3V0Og0KPiArCW11dGV4X3VubG9j
aygmc211LT5tdXRleCk7DQo+ICsNCj4gICAJcmV0dXJuIHJldDsNCj4gICB9DQo+ICAgDQo+IEBA
IC0yNTQsNyArMjYzLDcgQEAgaW50IHNtdV9zZXRfaGFyZF9mcmVxX3JhbmdlKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwNCj4gICB9DQo+ICAgDQo+
ICAgaW50IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVu
dW0gc211X2Nsa190eXBlIGNsa190eXBlLA0KPiAtCQkJICAgdWludDMyX3QgKm1pbiwgdWludDMy
X3QgKm1heCkNCj4gKwkJCSAgIHVpbnQzMl90ICptaW4sIHVpbnQzMl90ICptYXgsIGJvb2wgbG9j
a19uZWVkZWQpDQo+ICAgew0KPiAgIAl1aW50MzJfdCBjbG9ja19saW1pdDsNCj4gICAJaW50IHJl
dCA9IDA7DQo+IEBAIC0yODgsMTEgKzI5NywxOSBAQCBpbnQgc211X2dldF9kcG1fZnJlcV9yYW5n
ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsDQo+
ICAgDQo+ICAgCQlyZXR1cm4gMDsNCj4gICAJfQ0KPiArDQo+ICsJaWYgKGxvY2tfbmVlZGVkKQ0K
PiArCQltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAgIAkvKg0KPiAgIAkgKiBUb2Rv
OiBVc2UgZWFjaCBhc2ljKEFTSUNfcHB0IGZ1bmNzKSBjb250cm9sIHRoZSBjYWxsYmFja3MgZXhw
b3NlZCB0byB0aGUNCj4gICAJICogY29yZSBkcml2ZXIgYW5kIHRoZW4gaGF2ZSBoZWxwZXJzIGZv
ciBzdHVmZiB0aGF0IGlzIGNvbW1vbihTTVVfdjExX3ggfCBTTVVfdjEyX3ggZnVuY3MpLg0KPiAg
IAkgKi8NCj4gICAJcmV0ID0gc211X2dldF9kcG1fdWx0aW1hdGVfZnJlcShzbXUsIGNsa190eXBl
LCBtaW4sIG1heCk7DQo+ICsNCj4gKwlpZiAobG9ja19uZWVkZWQpDQo+ICsJCW11dGV4X3VubG9j
aygmc211LT5tdXRleCk7DQo+ICsNCj4gICAJcmV0dXJuIHJldDsNCj4gICB9DQo+ICAgDQo+IEBA
IC0zNjksNiArMzg2LDggQEAgaW50IHNtdV9kcG1fc2V0X3Bvd2VyX2dhdGUoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUsIHVpbnQzMl90IGJsb2NrX3R5cGUsDQo+ICAgew0KPiAgIAlpbnQgcmV0ID0g
MDsNCj4gICANCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAgIAlzd2l0Y2gg
KGJsb2NrX3R5cGUpIHsNCj4gICAJY2FzZSBBTURfSVBfQkxPQ0tfVFlQRV9VVkQ6DQo+ICAgCQly
ZXQgPSBzbXVfZHBtX3NldF91dmRfZW5hYmxlKHNtdSwgZ2F0ZSk7DQo+IEBAIC0zODYsMTMgKzQw
NSw5IEBAIGludCBzbXVfZHBtX3NldF9wb3dlcl9nYXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211
LCB1aW50MzJfdCBibG9ja190eXBlLA0KPiAgIAkJYnJlYWs7DQo+ICAgCX0NCj4gICANCj4gLQly
ZXR1cm4gcmV0Ow0KPiAtfQ0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICAgDQo+
IC1lbnVtIGFtZF9wbV9zdGF0ZV90eXBlIHNtdV9nZXRfY3VycmVudF9wb3dlcl9zdGF0ZShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4gLXsNCj4gLQkvKiBub3Qgc3VwcG9ydCBwb3dlciBzdGF0
ZSAqLw0KPiAtCXJldHVybiBQT1dFUl9TVEFURV9UWVBFX0RFRkFVTFQ7DQo+ICsJcmV0dXJuIHJl
dDsNCj4gICB9DQo+ICAgDQo+ICAgaW50IHNtdV9nZXRfcG93ZXJfbnVtX3N0YXRlcyhzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSwNCj4gQEAgLTUyMCwxNiArNTM1LDIzIEBAIGJvb2wgaXNfc3VwcG9y
dF9zd19zbXVfeGdtaShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikNCj4gICBpbnQgc211X3N5
c19nZXRfcHBfdGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHZvaWQgKip0YWJsZSkNCj4g
ICB7DQo+ICAgCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqc211X3RhYmxlID0gJnNtdS0+c211
X3RhYmxlOw0KPiArCXVpbnQzMl90IHBvd2VycGxheV90YWJsZV9zaXplOw0KPiAgIA0KPiAgIAlp
ZiAoIXNtdV90YWJsZS0+cG93ZXJfcGxheV90YWJsZSAmJiAhc211X3RhYmxlLT5oYXJkY29kZV9w
cHRhYmxlKQ0KPiAgIAkJcmV0dXJuIC1FSU5WQUw7DQo+ICAgDQo+ICsJbXV0ZXhfbG9jaygmc211
LT5tdXRleCk7DQo+ICsNCj4gICAJaWYgKHNtdV90YWJsZS0+aGFyZGNvZGVfcHB0YWJsZSkNCj4g
ICAJCSp0YWJsZSA9IHNtdV90YWJsZS0+aGFyZGNvZGVfcHB0YWJsZTsNCj4gICAJZWxzZQ0KPiAg
IAkJKnRhYmxlID0gc211X3RhYmxlLT5wb3dlcl9wbGF5X3RhYmxlOw0KPiAgIA0KPiAtCXJldHVy
biBzbXVfdGFibGUtPnBvd2VyX3BsYXlfdGFibGVfc2l6ZTsNCj4gKwlwb3dlcnBsYXlfdGFibGVf
c2l6ZSA9IHNtdV90YWJsZS0+cG93ZXJfcGxheV90YWJsZV9zaXplOw0KPiArDQo+ICsJbXV0ZXhf
dW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiBwb3dlcnBsYXlfdGFibGVfc2l6
ZTsNCj4gICB9DQo+ICAgDQo+ICAgaW50IHNtdV9zeXNfc2V0X3BwX3RhYmxlKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211LCAgdm9pZCAqYnVmLCBzaXplX3Qgc2l6ZSkNCj4gQEAgLTU1NiwxMiArNTc4
LDEzIEBAIGludCBzbXVfc3lzX3NldF9wcF90YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwg
IHZvaWQgKmJ1Ziwgc2l6ZV90IHNpemUpDQo+ICAgCW1lbWNweShzbXVfdGFibGUtPmhhcmRjb2Rl
X3BwdGFibGUsIGJ1Ziwgc2l6ZSk7DQo+ICAgCXNtdV90YWJsZS0+cG93ZXJfcGxheV90YWJsZSA9
IHNtdV90YWJsZS0+aGFyZGNvZGVfcHB0YWJsZTsNCj4gICAJc211X3RhYmxlLT5wb3dlcl9wbGF5
X3RhYmxlX3NpemUgPSBzaXplOw0KPiAtCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICAg
DQo+ICAgCXJldCA9IHNtdV9yZXNldChzbXUpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcHJfaW5m
bygic211IHJlc2V0IGZhaWxlZCwgcmV0ID0gJWRcbiIsIHJldCk7DQo+ICAgDQo+ICsJbXV0ZXhf
dW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAgIAlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAgIGZh
aWxlZDoNCj4gQEAgLTcyNiwxMSArNzQ5LDEwIEBAIHN0YXRpYyBpbnQgc211X2xhdGVfaW5pdCh2
b2lkICpoYW5kbGUpDQo+ICAgCWlmICghc211LT5wbV9lbmFibGVkKQ0KPiAgIAkJcmV0dXJuIDA7
DQo+ICAgDQo+IC0JbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICAgCXNtdV9oYW5kbGVfdGFz
aygmYWRldi0+c211LA0KPiAgIAkJCXNtdS0+c211X2RwbS5kcG1fbGV2ZWwsDQo+IC0JCQlBTURf
UFBfVEFTS19DT01QTEVURV9JTklUKTsNCj4gLQltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0K
PiArCQkJQU1EX1BQX1RBU0tfQ09NUExFVEVfSU5JVCwNCj4gKwkJCWZhbHNlKTsNCj4gICANCj4g
ICAJcmV0dXJuIDA7DQo+ICAgfQ0KPiBAQCAtMTA3NCw3ICsxMDk2LDcgQEAgc3RhdGljIGludCBz
bXVfc21jX3RhYmxlX2h3X2luaXQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCQlpZiAo
cmV0KQ0KPiAgIAkJCXJldHVybiByZXQ7DQo+ICAgDQo+IC0JCXJldCA9IHNtdV9nZXRfcG93ZXJf
bGltaXQoc211LCAmc211LT5kZWZhdWx0X3Bvd2VyX2xpbWl0LCB0cnVlKTsNCj4gKwkJcmV0ID0g
c211X2dldF9wb3dlcl9saW1pdChzbXUsICZzbXUtPmRlZmF1bHRfcG93ZXJfbGltaXQsIHRydWUs
IGZhbHNlKTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJcmV0dXJuIHJldDsNCj4gICAJfQ0KPiBA
QCAtMTE2MCwxNSArMTE4MiwxOSBAQCBzdGF0aWMgaW50IHNtdV9zdGFydF9zbWNfZW5naW5lKHN0
cnVjdCBzbXVfY29udGV4dCAqc211KQ0KPiAgIA0KPiAgIAlpZiAoYWRldi0+ZmlybXdhcmUubG9h
ZF90eXBlICE9IEFNREdQVV9GV19MT0FEX1BTUCkgew0KPiAgIAkJaWYgKGFkZXYtPmFzaWNfdHlw
ZSA8IENISVBfTkFWSTEwKSB7DQo+IC0JCQlyZXQgPSBzbXVfbG9hZF9taWNyb2NvZGUoc211KTsN
Cj4gLQkJCWlmIChyZXQpDQo+IC0JCQkJcmV0dXJuIHJldDsNCj4gKwkJCWlmIChzbXUtPmZ1bmNz
LT5sb2FkX21pY3JvY29kZSkgew0KPiArCQkJCXJldCA9IHNtdS0+ZnVuY3MtPmxvYWRfbWljcm9j
b2RlKHNtdSk7DQo+ICsJCQkJaWYgKHJldCkNCj4gKwkJCQkJcmV0dXJuIHJldDsNCj4gKwkJCX0N
Cj4gICAJCX0NCj4gICAJfQ0KPiAgIA0KPiAtCXJldCA9IHNtdV9jaGVja19md19zdGF0dXMoc211
KTsNCj4gLQlpZiAocmV0KQ0KPiAtCQlwcl9lcnIoIlNNQyBpcyBub3QgcmVhZHlcbiIpOw0KPiAr
CWlmIChzbXUtPmZ1bmNzLT5jaGVja19md19zdGF0dXMpIHsNCj4gKwkJcmV0ID0gc211LT5mdW5j
cy0+Y2hlY2tfZndfc3RhdHVzKHNtdSk7DQo+ICsJCWlmIChyZXQpDQo+ICsJCQlwcl9lcnIoIlNN
QyBpcyBub3QgcmVhZHlcbiIpOw0KPiArCX0NCj4gICANCj4gICAJcmV0dXJuIHJldDsNCj4gICB9
DQo+IEBAIC0xMzM0LDggKzEzNjAsNiBAQCBzdGF0aWMgaW50IHNtdV9yZXN1bWUodm9pZCAqaGFu
ZGxlKQ0KPiAgIA0KPiAgIAlwcl9pbmZvKCJTTVUgaXMgcmVzdW1pbmcuLi5cbiIpOw0KPiAgIA0K
PiAtCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiAtDQo+ICAgCXJldCA9IHNtdV9zdGFydF9z
bWNfZW5naW5lKHNtdSk7DQo+ICAgCWlmIChyZXQpIHsNCj4gICAJCXByX2VycigiU01VIGlzIG5v
dCByZWFkeSB5ZXQhXG4iKTsNCj4gQEAgLTEzNTAsMTMgKzEzNzQsMTEgQEAgc3RhdGljIGludCBz
bXVfcmVzdW1lKHZvaWQgKmhhbmRsZSkNCj4gICAJaWYgKHJldCkNCj4gICAJCWdvdG8gZmFpbGVk
Ow0KPiAgIA0KPiAtCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+IC0NCj4gICAJcHJfaW5m
bygiU01VIGlzIHJlc3VtZWQgc3VjY2Vzc2Z1bGx5IVxuIik7DQo+ICAgDQo+ICAgCXJldHVybiAw
Ow0KPiArDQo+ICAgZmFpbGVkOg0KPiAtCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICAg
CXJldHVybiByZXQ7DQo+ICAgfQ0KPiAgIA0KPiBAQCAtMTM3NCw4ICsxMzk2LDkgQEAgaW50IHNt
dV9kaXNwbGF5X2NvbmZpZ3VyYXRpb25fY2hhbmdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0K
PiAgIA0KPiAgIAltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gICANCj4gLQlzbXVfc2V0X2Rl
ZXBfc2xlZXBfZGNlZmNsayhzbXUsDQo+IC0JCQkJICAgZGlzcGxheV9jb25maWctPm1pbl9kY2Vm
X2RlZXBfc2xlZXBfc2V0X2NsayAvIDEwMCk7DQo+ICsJaWYgKHNtdS0+ZnVuY3MtPnNldF9kZWVw
X3NsZWVwX2RjZWZjbGspDQo+ICsJCXNtdS0+ZnVuY3MtPnNldF9kZWVwX3NsZWVwX2RjZWZjbGso
c211LA0KPiArCQkJCWRpc3BsYXlfY29uZmlnLT5taW5fZGNlZl9kZWVwX3NsZWVwX3NldF9jbGsg
LyAxMDApOw0KPiAgIA0KPiAgIAlmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBkaXNwbGF5X2NvbmZp
Zy0+bnVtX3BhdGhfaW5jbHVkaW5nX25vbl9kaXNwbGF5OyBpbmRleCsrKSB7DQo+ICAgCQlpZiAo
ZGlzcGxheV9jb25maWctPmRpc3BsYXlzW2luZGV4XS5jb250cm9sbGVyX2lkICE9IDApDQo+IEBA
IC0xNTUzLDkgKzE1NzYsOSBAQCBzdGF0aWMgaW50IHNtdV9kZWZhdWx0X3NldF9wZXJmb3JtYW5j
ZV9sZXZlbChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBhbWRfZA0KPiAgIAkJCQkJCSAm
c29jX21hc2spOw0KPiAgIAkJaWYgKHJldCkNCj4gICAJCQlyZXR1cm4gcmV0Ow0KPiAtCQlzbXVf
Zm9yY2VfY2xrX2xldmVscyhzbXUsIFNNVV9TQ0xLLCAxIDw8IHNjbGtfbWFzayk7DQo+IC0JCXNt
dV9mb3JjZV9jbGtfbGV2ZWxzKHNtdSwgU01VX01DTEssIDEgPDwgbWNsa19tYXNrKTsNCj4gLQkJ
c211X2ZvcmNlX2Nsa19sZXZlbHMoc211LCBTTVVfU09DQ0xLLCAxIDw8IHNvY19tYXNrKTsNCj4g
KwkJc211X2ZvcmNlX2Nsa19sZXZlbHMoc211LCBTTVVfU0NMSywgMSA8PCBzY2xrX21hc2ssIGZh
bHNlKTsNCj4gKwkJc211X2ZvcmNlX2Nsa19sZXZlbHMoc211LCBTTVVfTUNMSywgMSA8PCBtY2xr
X21hc2ssIGZhbHNlKTsNCj4gKwkJc211X2ZvcmNlX2Nsa19sZXZlbHMoc211LCBTTVVfU09DQ0xL
LCAxIDw8IHNvY19tYXNrLCBmYWxzZSk7DQo+ICAgCQlicmVhazsNCj4gICAJY2FzZSBBTURfRFBN
X0ZPUkNFRF9MRVZFTF9NQU5VQUw6DQo+ICAgCWNhc2UgQU1EX0RQTV9GT1JDRURfTEVWRUxfUFJP
RklMRV9FWElUOg0KPiBAQCAtMTYxOSw3ICsxNjQyLDcgQEAgaW50IHNtdV9hZGp1c3RfcG93ZXJf
c3RhdGVfZHluYW1pYyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJCXdvcmtsb2FkID0g
c211LT53b3JrbG9hZF9zZXR0aW5nW2luZGV4XTsNCj4gICANCj4gICAJCWlmIChzbXUtPnBvd2Vy
X3Byb2ZpbGVfbW9kZSAhPSB3b3JrbG9hZCkNCj4gLQkJCXNtdV9zZXRfcG93ZXJfcHJvZmlsZV9t
b2RlKHNtdSwgJndvcmtsb2FkLCAwKTsNCj4gKwkJCXNtdV9zZXRfcG93ZXJfcHJvZmlsZV9tb2Rl
KHNtdSwgJndvcmtsb2FkLCAwLCBmYWxzZSk7DQo+ICAgCX0NCj4gICANCj4gICAJcmV0dXJuIHJl
dDsNCj4gQEAgLTE2MjcsMTggKzE2NTAsMjIgQEAgaW50IHNtdV9hZGp1c3RfcG93ZXJfc3RhdGVf
ZHluYW1pYyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICANCj4gICBpbnQgc211X2hhbmRs
ZV90YXNrKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiAgIAkJICAgIGVudW0gYW1kX2RwbV9m
b3JjZWRfbGV2ZWwgbGV2ZWwsDQo+IC0JCSAgICBlbnVtIGFtZF9wcF90YXNrIHRhc2tfaWQpDQo+
ICsJCSAgICBlbnVtIGFtZF9wcF90YXNrIHRhc2tfaWQsDQo+ICsJCSAgICBib29sIGxvY2tfbmVl
ZGVkKQ0KPiAgIHsNCj4gICAJaW50IHJldCA9IDA7DQo+ICAgDQo+ICsJaWYgKGxvY2tfbmVlZGVk
KQ0KPiArCQltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAgIAlzd2l0Y2ggKHRhc2tf
aWQpIHsNCj4gICAJY2FzZSBBTURfUFBfVEFTS19ESVNQTEFZX0NPTkZJR19DSEFOR0U6DQo+ICAg
CQlyZXQgPSBzbXVfcHJlX2Rpc3BsYXlfY29uZmlnX2NoYW5nZWQoc211KTsNCj4gICAJCWlmIChy
ZXQpDQo+IC0JCQlyZXR1cm4gcmV0Ow0KPiArCQkJZ290byBvdXQ7DQo+ICAgCQlyZXQgPSBzbXVf
c2V0X2NwdV9wb3dlcl9zdGF0ZShzbXUpOw0KPiAgIAkJaWYgKHJldCkNCj4gLQkJCXJldHVybiBy
ZXQ7DQo+ICsJCQlnb3RvIG91dDsNCj4gICAJCXJldCA9IHNtdV9hZGp1c3RfcG93ZXJfc3RhdGVf
ZHluYW1pYyhzbXUsIGxldmVsLCBmYWxzZSk7DQo+ICAgCQlicmVhazsNCj4gICAJY2FzZSBBTURf
UFBfVEFTS19DT01QTEVURV9JTklUOg0KPiBAQCAtMTY0OSw2ICsxNjc2LDEwIEBAIGludCBzbXVf
aGFuZGxlX3Rhc2soc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCQlicmVhazsNCj4gICAJ
fQ0KPiAgIA0KPiArb3V0Og0KPiArCWlmIChsb2NrX25lZWRlZCkNCj4gKwkJbXV0ZXhfdW5sb2Nr
KCZzbXUtPm11dGV4KTsNCj4gKw0KPiAgIAlyZXR1cm4gcmV0Ow0KPiAgIH0NCj4gICANCj4gQEAg
LTE2ODEsNyArMTcxMiw3IEBAIGludCBzbXVfc3dpdGNoX3Bvd2VyX3Byb2ZpbGUoc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUsDQo+ICAgCX0NCj4gICANCj4gICAJaWYgKHNtdV9kcG1fY3R4LT5kcG1f
bGV2ZWwgIT0gQU1EX0RQTV9GT1JDRURfTEVWRUxfTUFOVUFMKQ0KPiAtCQlzbXVfc2V0X3Bvd2Vy
X3Byb2ZpbGVfbW9kZShzbXUsICZ3b3JrbG9hZCwgMCk7DQo+ICsJCXNtdV9zZXRfcG93ZXJfcHJv
ZmlsZV9tb2RlKHNtdSwgJndvcmtsb2FkLCAwLCBmYWxzZSk7DQo+ICAgDQo+ICAgCW11dGV4X3Vu
bG9jaygmc211LT5tdXRleCk7DQo+ICAgDQo+IEBAIC0xNzExLDEyICsxNzQyLDE5IEBAIGludCBz
bXVfZm9yY2VfcGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0g
YW1kX2RwbV9mb3JjZWRfbGV2DQo+ICAgCWlmICghc211LT5pc19hcHUgJiYgIXNtdV9kcG1fY3R4
LT5kcG1fY29udGV4dCkNCj4gICAJCXJldHVybiAtRUlOVkFMOw0KPiAgIA0KPiArCW11dGV4X2xv
Y2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICAgCXJldCA9IHNtdV9lbmFibGVfdW1kX3BzdGF0ZShz
bXUsICZsZXZlbCk7DQo+IC0JaWYgKHJldCkNCj4gKwlpZiAocmV0KSB7DQo+ICsJCW11dGV4X3Vu
bG9jaygmc211LT5tdXRleCk7DQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiArCX0NCj4gICANCj4gICAJ
cmV0ID0gc211X2hhbmRsZV90YXNrKHNtdSwgbGV2ZWwsDQo+IC0JCQkgICAgICBBTURfUFBfVEFT
S19SRUFESlVTVF9QT1dFUl9TVEFURSk7DQo+ICsJCQkgICAgICBBTURfUFBfVEFTS19SRUFESlVT
VF9QT1dFUl9TVEFURSwNCj4gKwkJCSAgICAgIGZhbHNlKTsNCj4gKw0KPiArCW11dGV4X3VubG9j
aygmc211LT5tdXRleCk7DQo+ICAgDQo+ICAgCXJldHVybiByZXQ7DQo+ICAgfQ0KPiBAQCAtMTcz
NCw3ICsxNzcyLDggQEAgaW50IHNtdV9zZXRfZGlzcGxheV9jb3VudChzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSwgdWludDMyX3QgY291bnQpDQo+ICAgDQo+ICAgaW50IHNtdV9mb3JjZV9jbGtfbGV2
ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiAgIAkJCSBlbnVtIHNtdV9jbGtfdHlwZSBj
bGtfdHlwZSwNCj4gLQkJCSB1aW50MzJfdCBtYXNrKQ0KPiArCQkJIHVpbnQzMl90IG1hc2ssDQo+
ICsJCQkgYm9vbCBsb2NrX25lZWRlZCkNCj4gICB7DQo+ICAgCXN0cnVjdCBzbXVfZHBtX2NvbnRl
eHQgKnNtdV9kcG1fY3R4ID0gJihzbXUtPnNtdV9kcG0pOw0KPiAgIAlpbnQgcmV0ID0gMDsNCj4g
QEAgLTE3NDQsOSArMTc4MywxNSBAQCBpbnQgc211X2ZvcmNlX2Nsa19sZXZlbHMoc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUsDQo+ICAgCQlyZXR1cm4gLUVJTlZBTDsNCj4gICAJfQ0KPiAgIA0KPiAr
CWlmIChsb2NrX25lZWRlZCkNCj4gKwkJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4g
ICAJaWYgKHNtdS0+cHB0X2Z1bmNzICYmIHNtdS0+cHB0X2Z1bmNzLT5mb3JjZV9jbGtfbGV2ZWxz
KQ0KPiAgIAkJcmV0ID0gc211LT5wcHRfZnVuY3MtPmZvcmNlX2Nsa19sZXZlbHMoc211LCBjbGtf
dHlwZSwgbWFzayk7DQo+ICAgDQo+ICsJaWYgKGxvY2tfbmVlZGVkKQ0KPiArCQltdXRleF91bmxv
Y2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICAgCXJldHVybiByZXQ7DQo+ICAgfQ0KPiAgIA0KPiBA
QCAtMTc2NCw2ICsxODA5LDggQEAgaW50IHNtdV9zZXRfbXAxX3N0YXRlKHN0cnVjdCBzbXVfY29u
dGV4dCAqc211LA0KPiAgIAlpZiAoIXNtdS0+cG1fZW5hYmxlZCkNCj4gICAJCXJldHVybiAwOw0K
PiAgIA0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICAgCXN3aXRjaCAobXAx
X3N0YXRlKSB7DQo+ICAgCWNhc2UgUFBfTVAxX1NUQVRFX1NIVVRET1dOOg0KPiAgIAkJbXNnID0g
U01VX01TR19QcmVwYXJlTXAxRm9yU2h1dGRvd247DQo+IEBAIC0xNzc2LDE3ICsxODIzLDIyIEBA
IGludCBzbXVfc2V0X21wMV9zdGF0ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJCWJy
ZWFrOw0KPiAgIAljYXNlIFBQX01QMV9TVEFURV9OT05FOg0KPiAgIAlkZWZhdWx0Og0KPiArCQlt
dXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiAgIAkJcmV0dXJuIDA7DQo+ICAgCX0NCj4gICAN
Cj4gICAJLyogc29tZSBhc2ljcyBtYXkgbm90IHN1cHBvcnQgdGhvc2UgbWVzc2FnZXMgKi8NCj4g
LQlpZiAoc211X21zZ19nZXRfaW5kZXgoc211LCBtc2cpIDwgMCkNCj4gKwlpZiAoc211X21zZ19n
ZXRfaW5kZXgoc211LCBtc2cpIDwgMCkgew0KPiArCQltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgp
Ow0KPiAgIAkJcmV0dXJuIDA7DQo+ICsJfQ0KPiAgIA0KPiAgIAlyZXQgPSBzbXVfc2VuZF9zbWNf
bXNnKHNtdSwgbXNnKTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXByX2VycigiW1ByZXBhcmVNcDFd
IEZhaWxlZCFcbiIpOw0KPiAgIA0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsN
Cj4gICAJcmV0dXJuIHJldDsNCj4gICB9DQo+ICAgDQo+IEBAIC0xODA2LDEwICsxODU4LDE0IEBA
IGludCBzbXVfc2V0X2RmX2NzdGF0ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJaWYg
KCFzbXUtPnBwdF9mdW5jcyB8fCAhc211LT5wcHRfZnVuY3MtPnNldF9kZl9jc3RhdGUpDQo+ICAg
CQlyZXR1cm4gMDsNCj4gICANCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAg
IAlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+c2V0X2RmX2NzdGF0ZShzbXUsIHN0YXRlKTsNCj4gICAJ
aWYgKHJldCkNCj4gICAJCXByX2VycigiW1NldERmQ3N0YXRlXSBmYWlsZWQhXG4iKTsNCj4gICAN
Cj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICAgCXJldHVybiByZXQ7DQo+
ICAgfQ0KPiAgIA0KPiBAQCAtMTg0OSwzICsxOTA1LDU0OSBAQCBjb25zdCBzdHJ1Y3QgYW1kZ3B1
X2lwX2Jsb2NrX3ZlcnNpb24gc211X3YxMl8wX2lwX2Jsb2NrID0NCj4gICAJLnJldiA9IDAsDQo+
ICAgCS5mdW5jcyA9ICZzbXVfaXBfZnVuY3MsDQo+ICAgfTsNCj4gKw0KPiAraW50IHNtdV9sb2Fk
X21pY3JvY29kZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4gK3sNCj4gKwlpbnQgcmV0ID0g
MDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+
ZnVuY3MtPmxvYWRfbWljcm9jb2RlKQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5sb2FkX21pY3Jv
Y29kZShzbXUpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAr
CXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBzbXVfY2hlY2tfZndfc3RhdHVzKHN0cnVj
dCBzbXVfY29udGV4dCAqc211KQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJbXV0
ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5mdW5jcy0+Y2hlY2tfZndf
c3RhdHVzKQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5jaGVja19md19zdGF0dXMoc211KTsNCj4g
Kw0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0K
PiArfQ0KPiArDQo+ICtpbnQgc211X3NldF9nZnhfY2dwZyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNt
dSwgYm9vbCBlbmFibGVkKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJbXV0ZXhf
bG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5mdW5jcy0+c2V0X2dmeF9jZ3Bn
KQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5zZXRfZ2Z4X2NncGcoc211LCBlbmFibGVkKTsNCj4g
Kw0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0K
PiArfQ0KPiArDQo+ICtpbnQgc211X3NldF9mYW5fc3BlZWRfcnBtKHN0cnVjdCBzbXVfY29udGV4
dCAqc211LCB1aW50MzJfdCBzcGVlZCkNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiAr
CW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPnNldF9m
YW5fc3BlZWRfcnBtKQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5zZXRfZmFuX3NwZWVkX3JwbShz
bXUsIHNwZWVkKTsNCj4gKw0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4g
KwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211X2dldF9wb3dlcl9saW1pdChzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gKwkJCXVpbnQzMl90ICpsaW1pdCwNCj4gKwkJCWJvb2wg
ZGVmLA0KPiArCQkJYm9vbCBsb2NrX25lZWRlZCkNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4g
Kw0KPiArCWlmIChsb2NrX25lZWRlZCkNCj4gKwkJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+
ICsNCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPmdldF9wb3dlcl9saW1pdCkNCj4gKwkJcmV0ID0g
c211LT5wcHRfZnVuY3MtPmdldF9wb3dlcl9saW1pdChzbXUsIGxpbWl0LCBkZWYpOw0KPiArDQo+
ICsJaWYgKGxvY2tfbmVlZGVkKQ0KPiArCQltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiAr
DQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNtdV9zZXRfcG93ZXJfbGltaXQo
c3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQzMl90IGxpbWl0KQ0KPiArew0KPiArCWludCBy
ZXQgPSAwOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAo
c211LT5mdW5jcy0+c2V0X3Bvd2VyX2xpbWl0KQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5zZXRf
cG93ZXJfbGltaXQoc211LCBsaW1pdCk7DQo+ICsNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0
ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNtdV9wcmludF9j
bGtfbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSBjbGtf
dHlwZSwgY2hhciAqYnVmKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJbXV0ZXhf
bG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPnByaW50X2Ns
a19sZXZlbHMpDQo+ICsJCXJldCA9IHNtdS0+cHB0X2Z1bmNzLT5wcmludF9jbGtfbGV2ZWxzKHNt
dSwgY2xrX3R5cGUsIGJ1Zik7DQo+ICsNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0K
PiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNtdV9nZXRfb2RfcGVyY2Vu
dGFnZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVfY2xrX3R5cGUgdHlwZSkNCj4g
K3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0K
PiArDQo+ICsJaWYgKHNtdS0+cHB0X2Z1bmNzLT5nZXRfb2RfcGVyY2VudGFnZSkNCj4gKwkJcmV0
ID0gc211LT5wcHRfZnVuY3MtPmdldF9vZF9wZXJjZW50YWdlKHNtdSwgdHlwZSk7DQo+ICsNCj4g
KwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30N
Cj4gKw0KPiAraW50IHNtdV9zZXRfb2RfcGVyY2VudGFnZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNt
dSwgZW51bSBzbXVfY2xrX3R5cGUgdHlwZSwgdWludDMyX3QgdmFsdWUpDQo+ICt7DQo+ICsJaW50
IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlm
IChzbXUtPnBwdF9mdW5jcy0+c2V0X29kX3BlcmNlbnRhZ2UpDQo+ICsJCXJldCA9IHNtdS0+cHB0
X2Z1bmNzLT5zZXRfb2RfcGVyY2VudGFnZShzbXUsIHR5cGUsIHZhbHVlKTsNCj4gKw0KPiArCW11
dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiAr
DQo+ICtpbnQgc211X29kX2VkaXRfZHBtX3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0K
PiArCQkJICBlbnVtIFBQX09EX0RQTV9UQUJMRV9DT01NQU5EIHR5cGUsDQo+ICsJCQkgIGxvbmcg
KmlucHV0LCB1aW50MzJfdCBzaXplKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJ
bXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPm9k
X2VkaXRfZHBtX3RhYmxlKQ0KPiArCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+b2RfZWRpdF9kcG1f
dGFibGUoc211LCB0eXBlLCBpbnB1dCwgc2l6ZSk7DQo+ICsNCj4gKwltdXRleF91bmxvY2soJnNt
dS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNtdV9y
ZWFkX3NlbnNvcihzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gKwkJICAgIGVudW0gYW1kX3Bw
X3NlbnNvcnMgc2Vuc29yLA0KPiArCQkgICAgdm9pZCAqZGF0YSwgdWludDMyX3QgKnNpemUpDQo+
ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsN
Cj4gKw0KPiArCWlmIChzbXUtPnBwdF9mdW5jcy0+cmVhZF9zZW5zb3IpDQo+ICsJCXJldCA9IHNt
dS0+cHB0X2Z1bmNzLT5yZWFkX3NlbnNvcihzbXUsIHNlbnNvciwgZGF0YSwgc2l6ZSk7DQo+ICsN
Cj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4g
K30NCj4gKw0KPiAraW50IHNtdV9nZXRfcG93ZXJfcHJvZmlsZV9tb2RlKHN0cnVjdCBzbXVfY29u
dGV4dCAqc211LCBjaGFyICpidWYpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwlt
dXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPnBwdF9mdW5jcy0+Z2V0
X3Bvd2VyX3Byb2ZpbGVfbW9kZSkNCj4gKwkJcmV0ID0gc211LT5wcHRfZnVuY3MtPmdldF9wb3dl
cl9wcm9maWxlX21vZGUoc211LCBidWYpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11
dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBzbXVfc2V0X3Bv
d2VyX3Byb2ZpbGVfbW9kZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gKwkJCSAgICAgICBs
b25nICpwYXJhbSwNCj4gKwkJCSAgICAgICB1aW50MzJfdCBwYXJhbV9zaXplLA0KPiArCQkJICAg
ICAgIGJvb2wgbG9ja19uZWVkZWQpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwlp
ZiAobG9ja19uZWVkZWQpDQo+ICsJCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJ
aWYgKHNtdS0+cHB0X2Z1bmNzLT5zZXRfcG93ZXJfcHJvZmlsZV9tb2RlKQ0KPiArCQlyZXQgPSBz
bXUtPnBwdF9mdW5jcy0+c2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZShzbXUsIHBhcmFtLCBwYXJhbV9z
aXplKTsNCj4gKw0KPiArCWlmIChsb2NrX25lZWRlZCkNCj4gKwkJbXV0ZXhfdW5sb2NrKCZzbXUt
Pm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gKw0KPiAraW50IHNt
dV9nZXRfZmFuX2NvbnRyb2xfbW9kZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4gK3sNCj4g
KwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+
ICsJaWYgKHNtdS0+ZnVuY3MtPmdldF9mYW5fY29udHJvbF9tb2RlKQ0KPiArCQlyZXQgPSBzbXUt
PmZ1bmNzLT5nZXRfZmFuX2NvbnRyb2xfbW9kZShzbXUpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2Nr
KCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBz
bXVfc2V0X2Zhbl9jb250cm9sX21vZGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGludCB2YWx1
ZSkNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0
ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPnNldF9mYW5fY29udHJvbF9tb2RlKQ0KPiAr
CQlyZXQgPSBzbXUtPmZ1bmNzLT5zZXRfZmFuX2NvbnRyb2xfbW9kZShzbXUsIHZhbHVlKTsNCj4g
Kw0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0K
PiArfQ0KPiArDQo+ICtpbnQgc211X2dldF9mYW5fc3BlZWRfcGVyY2VudChzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSwgdWludDMyX3QgKnNwZWVkKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiAr
DQo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5wcHRfZnVu
Y3MtPmdldF9mYW5fc3BlZWRfcGVyY2VudCkNCj4gKwkJcmV0ID0gc211LT5wcHRfZnVuY3MtPmdl
dF9mYW5fc3BlZWRfcGVyY2VudChzbXUsIHNwZWVkKTsNCj4gKw0KPiArCW11dGV4X3VubG9jaygm
c211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211
X3NldF9mYW5fc3BlZWRfcGVyY2VudChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDMyX3Qg
c3BlZWQpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUt
Pm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRfZmFuX3NwZWVkX3BlcmNlbnQp
DQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPnNldF9mYW5fc3BlZWRfcGVyY2VudChzbXUsIHNwZWVk
KTsNCj4gKw0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4g
cmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211X2dldF9mYW5fc3BlZWRfcnBtKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211LCB1aW50MzJfdCAqc3BlZWQpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+
ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPnBwdF9m
dW5jcy0+Z2V0X2Zhbl9zcGVlZF9ycG0pDQo+ICsJCXJldCA9IHNtdS0+cHB0X2Z1bmNzLT5nZXRf
ZmFuX3NwZWVkX3JwbShzbXUsIHNwZWVkKTsNCj4gKw0KPiArCW11dGV4X3VubG9jaygmc211LT5t
dXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211X3NldF9k
ZWVwX3NsZWVwX2RjZWZjbGsoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGludCBjbGspDQo+ICt7
DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4g
Kw0KPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRfZGVlcF9zbGVlcF9kY2VmY2xrKQ0KPiArCQlyZXQg
PSBzbXUtPmZ1bmNzLT5zZXRfZGVlcF9zbGVlcF9kY2VmY2xrKHNtdSwgY2xrKTsNCj4gKw0KPiAr
CW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0K
PiArDQo+ICtpbnQgc211X3NldF9hY3RpdmVfZGlzcGxheV9jb3VudChzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSwgdWludDMyX3QgY291bnQpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4g
KwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRf
YWN0aXZlX2Rpc3BsYXlfY291bnQpDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPnNldF9hY3RpdmVf
ZGlzcGxheV9jb3VudChzbXUsIGNvdW50KTsNCj4gKw0KPiArCW11dGV4X3VubG9jaygmc211LT5t
dXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211X2dldF9j
bG9ja19ieV90eXBlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiArCQkJICBlbnVtIGFtZF9w
cF9jbG9ja190eXBlIHR5cGUsDQo+ICsJCQkgIHN0cnVjdCBhbWRfcHBfY2xvY2tzICpjbG9ja3Mp
DQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4
KTsNCj4gKw0KPiArCWlmIChzbXUtPmZ1bmNzLT5nZXRfY2xvY2tfYnlfdHlwZSkNCj4gKwkJcmV0
ID0gc211LT5mdW5jcy0+Z2V0X2Nsb2NrX2J5X3R5cGUoc211LCB0eXBlLCBjbG9ja3MpOw0KPiAr
DQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+
ICt9DQo+ICsNCj4gK2ludCBzbXVfZ2V0X21heF9oaWdoX2Nsb2NrcyhzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSwNCj4gKwkJCSAgICBzdHJ1Y3QgYW1kX3BwX3NpbXBsZV9jbG9ja19pbmZvICpjbG9j
a3MpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11
dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPmZ1bmNzLT5nZXRfbWF4X2hpZ2hfY2xvY2tzKQ0KPiAr
CQlyZXQgPSBzbXUtPmZ1bmNzLT5nZXRfbWF4X2hpZ2hfY2xvY2tzKHNtdSwgY2xvY2tzKTsNCj4g
Kw0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0K
PiArfQ0KPiArDQo+ICtpbnQgc211X2dldF9jbG9ja19ieV90eXBlX3dpdGhfbGF0ZW5jeShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gKwkJCQkgICAgICAgZW51bSBzbXVfY2xrX3R5cGUgY2xr
X3R5cGUsDQo+ICsJCQkJICAgICAgIHN0cnVjdCBwcF9jbG9ja19sZXZlbHNfd2l0aF9sYXRlbmN5
ICpjbG9ja3MpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZz
bXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPnBwdF9mdW5jcy0+Z2V0X2Nsb2NrX2J5X3R5
cGVfd2l0aF9sYXRlbmN5KQ0KPiArCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+Z2V0X2Nsb2NrX2J5
X3R5cGVfd2l0aF9sYXRlbmN5KHNtdSwgY2xrX3R5cGUsIGNsb2Nrcyk7DQo+ICsNCj4gKwltdXRl
eF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0K
PiAraW50IHNtdV9nZXRfY2xvY2tfYnlfdHlwZV93aXRoX3ZvbHRhZ2Uoc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUsDQo+ICsJCQkJICAgICAgIGVudW0gYW1kX3BwX2Nsb2NrX3R5cGUgdHlwZSwNCj4g
KwkJCQkgICAgICAgc3RydWN0IHBwX2Nsb2NrX2xldmVsc193aXRoX3ZvbHRhZ2UgKmNsb2NrcykN
Cj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgp
Ow0KPiArDQo+ICsJaWYgKHNtdS0+cHB0X2Z1bmNzLT5nZXRfY2xvY2tfYnlfdHlwZV93aXRoX3Zv
bHRhZ2UpDQo+ICsJCXJldCA9IHNtdS0+cHB0X2Z1bmNzLT5nZXRfY2xvY2tfYnlfdHlwZV93aXRo
X3ZvbHRhZ2Uoc211LCB0eXBlLCBjbG9ja3MpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUt
Pm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gKw0KPiAraW50IHNt
dV9kaXNwbGF5X2Nsb2NrX3ZvbHRhZ2VfcmVxdWVzdChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwN
Cj4gKwkJCQkgICAgICBzdHJ1Y3QgcHBfZGlzcGxheV9jbG9ja19yZXF1ZXN0ICpjbG9ja19yZXEp
DQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4
KTsNCj4gKw0KPiArCWlmIChzbXUtPmZ1bmNzLT5kaXNwbGF5X2Nsb2NrX3ZvbHRhZ2VfcmVxdWVz
dCkNCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+ZGlzcGxheV9jbG9ja192b2x0YWdlX3JlcXVlc3Qo
c211LCBjbG9ja19yZXEpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4g
Kw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gKw0KPiAraW50IHNtdV9kaXNwbGF5X2Rp
c2FibGVfbWVtb3J5X2Nsb2NrX3N3aXRjaChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgYm9vbCBk
aXNhYmxlX21lbW9yeV9jbG9ja19zd2l0Y2gpDQo+ICt7DQo+ICsJaW50IHJldCA9IC1FSU5WQUw7
DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPnBw
dF9mdW5jcy0+ZGlzcGxheV9kaXNhYmxlX21lbW9yeV9jbG9ja19zd2l0Y2gpDQo+ICsJCXJldCA9
IHNtdS0+cHB0X2Z1bmNzLT5kaXNwbGF5X2Rpc2FibGVfbWVtb3J5X2Nsb2NrX3N3aXRjaChzbXUs
IGRpc2FibGVfbWVtb3J5X2Nsb2NrX3N3aXRjaCk7DQo+ICsNCj4gKwltdXRleF91bmxvY2soJnNt
dS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNtdV9u
b3RpZnlfc211X2VuYWJsZV9wd2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpDQo+ICt7DQo+ICsJ
aW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAr
CWlmIChzbXUtPmZ1bmNzLT5ub3RpZnlfc211X2VuYWJsZV9wd2UpDQo+ICsJCXJldCA9IHNtdS0+
ZnVuY3MtPm5vdGlmeV9zbXVfZW5hYmxlX3B3ZShzbXUpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2Nr
KCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBz
bXVfc2V0X3dhdGVybWFya3NfZm9yX2Nsb2NrX3JhbmdlcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNt
dSwNCj4gKwkJCQkJc3RydWN0IGRtX3BwX3dtX3NldHNfd2l0aF9jbG9ja19yYW5nZXNfc29jMTUg
KmNsb2NrX3JhbmdlcykNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xv
Y2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPnNldF93YXRlcm1hcmtz
X2Zvcl9jbG9ja19yYW5nZXMpDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPnNldF93YXRlcm1hcmtz
X2Zvcl9jbG9ja19yYW5nZXMoc211LCBjbG9ja19yYW5nZXMpOw0KPiArDQo+ICsJbXV0ZXhfdW5s
b2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2lu
dCBzbXVfc2V0X3hnbWlfcHN0YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiArCQkJdWlu
dDMyX3QgcHN0YXRlKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJbXV0ZXhfbG9j
aygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5mdW5jcy0+c2V0X3hnbWlfcHN0YXRl
KQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5zZXRfeGdtaV9wc3RhdGUoc211LCBwc3RhdGUpOw0K
PiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7
DQo+ICt9DQo+ICsNCj4gK2ludCBzbXVfc2V0X2F6YWxpYV9kM19wbWUoc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZz
bXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRfYXphbGlhX2QzX3BtZSkN
Cj4gKwkJcmV0ID0gc211LT5mdW5jcy0+c2V0X2F6YWxpYV9kM19wbWUoc211KTsNCj4gKw0KPiAr
CW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0K
PiArDQo+ICtib29sIHNtdV9iYWNvX2lzX3N1cHBvcnQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUp
DQo+ICt7DQo+ICsJYm9vbCByZXQgPSBmYWxzZTsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+
bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPmJhY29faXNfc3VwcG9ydCkNCj4gKwkJ
cmV0ID0gc211LT5mdW5jcy0+YmFjb19pc19zdXBwb3J0KHNtdSk7DQo+ICsNCj4gKwltdXRleF91
bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAr
aW50IHNtdV9iYWNvX2dldF9zdGF0ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVf
YmFjb19zdGF0ZSAqc3RhdGUpDQo+ICt7DQo+ICsJaWYgKHNtdS0+ZnVuY3MtPmJhY29fZ2V0X3N0
YXRlKQ0KPiArCQlyZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0
ZXgpOw0KPiArCSpzdGF0ZSA9IHNtdS0+ZnVuY3MtPmJhY29fZ2V0X3N0YXRlKHNtdSk7DQo+ICsJ
bXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiAr
DQo+ICtpbnQgc211X2JhY29fcmVzZXQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpDQo+ICt7DQo+
ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0K
PiArCWlmIChzbXUtPmZ1bmNzLT5iYWNvX3Jlc2V0KQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5i
YWNvX3Jlc2V0KHNtdSk7DQo+ICsNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiAr
DQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNtdV9tb2RlMl9yZXNldChzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11
dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPm1vZGUyX3Jl
c2V0KQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5tb2RlMl9yZXNldChzbXUpOw0KPiArDQo+ICsJ
bXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+
ICsNCj4gK2ludCBzbXVfZ2V0X21heF9zdXN0YWluYWJsZV9jbG9ja3NfYnlfZGMoc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUsDQo+ICsJCQkJCSBzdHJ1Y3QgcHBfc211X252X2Nsb2NrX3RhYmxlICpt
YXhfY2xvY2tzKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygm
c211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5mdW5jcy0+Z2V0X21heF9zdXN0YWluYWJs
ZV9jbG9ja3NfYnlfZGMpDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPmdldF9tYXhfc3VzdGFpbmFi
bGVfY2xvY2tzX2J5X2RjKHNtdSwgbWF4X2Nsb2Nrcyk7DQo+ICsNCj4gKwltdXRleF91bmxvY2so
JnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNt
dV9nZXRfdWNsa19kcG1fc3RhdGVzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiArCQkJICAg
IHVuc2lnbmVkIGludCAqY2xvY2tfdmFsdWVzX2luX2toeiwNCj4gKwkJCSAgICB1bnNpZ25lZCBp
bnQgKm51bV9zdGF0ZXMpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9s
b2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPnBwdF9mdW5jcy0+Z2V0X3VjbGtf
ZHBtX3N0YXRlcykNCj4gKwkJcmV0ID0gc211LT5wcHRfZnVuY3MtPmdldF91Y2xrX2RwbV9zdGF0
ZXMoc211LCBjbG9ja192YWx1ZXNfaW5fa2h6LCBudW1fc3RhdGVzKTsNCj4gKw0KPiArCW11dGV4
X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+
ICtlbnVtIGFtZF9wbV9zdGF0ZV90eXBlIHNtdV9nZXRfY3VycmVudF9wb3dlcl9zdGF0ZShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4gK3sNCj4gKwllbnVtIGFtZF9wbV9zdGF0ZV90eXBlIHBt
X3N0YXRlID0gUE9XRVJfU1RBVEVfVFlQRV9ERUZBVUxUOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygm
c211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPmdldF9jdXJyZW50X3Bv
d2VyX3N0YXRlKQ0KPiArCQlwbV9zdGF0ZSA9IHNtdS0+cHB0X2Z1bmNzLT5nZXRfY3VycmVudF9w
b3dlcl9zdGF0ZShzbXUpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4g
Kw0KPiArCXJldHVybiBwbV9zdGF0ZTsNCj4gK30NCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvcG93ZXJwbGF5L2luYy9hbWRncHVfc211LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L3Bvd2VycGxheS9pbmMvYW1kZ3B1X3NtdS5oDQo+IGluZGV4IGNkYjg0NWY1ZjIzZS4uM2UzNDY0
ZmEyZmY1IDEwMDY0NA0KPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMv
YW1kZ3B1X3NtdS5oDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2luYy9h
bWRncHVfc211LmgNCj4gQEAgLTU2NSwxOCArNTY1LDE3IEBAIHN0cnVjdCBzbXVfZnVuY3MNCj4g
ICAJKChzbXUpLT5mdW5jcy0+aW5pdF9wb3dlciA/IChzbXUpLT5mdW5jcy0+aW5pdF9wb3dlcigo
c211KSkgOiAwKQ0KPiAgICNkZWZpbmUgc211X2ZpbmlfcG93ZXIoc211KSBcDQo+ICAgCSgoc211
KS0+ZnVuY3MtPmZpbmlfcG93ZXIgPyAoc211KS0+ZnVuY3MtPmZpbmlfcG93ZXIoKHNtdSkpIDog
MCkNCj4gLSNkZWZpbmUgc211X2xvYWRfbWljcm9jb2RlKHNtdSkgXA0KPiAtCSgoc211KS0+ZnVu
Y3MtPmxvYWRfbWljcm9jb2RlID8gKHNtdSktPmZ1bmNzLT5sb2FkX21pY3JvY29kZSgoc211KSkg
OiAwKQ0KPiAtI2RlZmluZSBzbXVfY2hlY2tfZndfc3RhdHVzKHNtdSkgXA0KPiAtCSgoc211KS0+
ZnVuY3MtPmNoZWNrX2Z3X3N0YXR1cyA/IChzbXUpLT5mdW5jcy0+Y2hlY2tfZndfc3RhdHVzKChz
bXUpKSA6IDApDQo+ICtpbnQgc211X2xvYWRfbWljcm9jb2RlKHN0cnVjdCBzbXVfY29udGV4dCAq
c211KTsNCj4gKw0KPiAraW50IHNtdV9jaGVja19md19zdGF0dXMoc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUpOw0KPiArDQo+ICAgI2RlZmluZSBzbXVfc2V0dXBfcHB0YWJsZShzbXUpIFwNCj4gICAJ
KChzbXUpLT5mdW5jcy0+c2V0dXBfcHB0YWJsZSA/IChzbXUpLT5mdW5jcy0+c2V0dXBfcHB0YWJs
ZSgoc211KSkgOiAwKQ0KPiAgICNkZWZpbmUgc211X3Bvd2VyZ2F0ZV9zZG1hKHNtdSwgZ2F0ZSkg
XA0KPiAgIAkoKHNtdSktPmZ1bmNzLT5wb3dlcmdhdGVfc2RtYSA/IChzbXUpLT5mdW5jcy0+cG93
ZXJnYXRlX3NkbWEoKHNtdSksIChnYXRlKSkgOiAwKQ0KPiAgICNkZWZpbmUgc211X3Bvd2VyZ2F0
ZV92Y24oc211LCBnYXRlKSBcDQo+ICAgCSgoc211KS0+ZnVuY3MtPnBvd2VyZ2F0ZV92Y24gPyAo
c211KS0+ZnVuY3MtPnBvd2VyZ2F0ZV92Y24oKHNtdSksIChnYXRlKSkgOiAwKQ0KPiAtI2RlZmlu
ZSBzbXVfc2V0X2dmeF9jZ3BnKHNtdSwgZW5hYmxlZCkgXA0KPiAtCSgoc211KS0+ZnVuY3MtPnNl
dF9nZnhfY2dwZyA/IChzbXUpLT5mdW5jcy0+c2V0X2dmeF9jZ3BnKChzbXUpLCAoZW5hYmxlZCkp
IDogMCkNCj4gK2ludCBzbXVfc2V0X2dmeF9jZ3BnKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBi
b29sIGVuYWJsZWQpOw0KPiAgICNkZWZpbmUgc211X2dldF92Ymlvc19ib290dXBfdmFsdWVzKHNt
dSkgXA0KPiAgIAkoKHNtdSktPmZ1bmNzLT5nZXRfdmJpb3NfYm9vdHVwX3ZhbHVlcyA/IChzbXUp
LT5mdW5jcy0+Z2V0X3ZiaW9zX2Jvb3R1cF92YWx1ZXMoKHNtdSkpIDogMCkNCj4gICAjZGVmaW5l
IHNtdV9nZXRfY2xrX2luZm9fZnJvbV92YmlvcyhzbXUpIFwNCj4gQEAgLTYxMCw4ICs2MDksOCBA
QCBzdHJ1Y3Qgc211X2Z1bmNzDQo+ICAgCSgoc211KS0+ZnVuY3MtPmluaXRfbWF4X3N1c3RhaW5h
YmxlX2Nsb2NrcyA/IChzbXUpLT5mdW5jcy0+aW5pdF9tYXhfc3VzdGFpbmFibGVfY2xvY2tzKChz
bXUpKSA6IDApDQo+ICAgI2RlZmluZSBzbXVfc2V0X2RlZmF1bHRfb2Rfc2V0dGluZ3Moc211LCBp
bml0aWFsaXplKSBcDQo+ICAgCSgoc211KS0+cHB0X2Z1bmNzLT5zZXRfZGVmYXVsdF9vZF9zZXR0
aW5ncyA/IChzbXUpLT5wcHRfZnVuY3MtPnNldF9kZWZhdWx0X29kX3NldHRpbmdzKChzbXUpLCAo
aW5pdGlhbGl6ZSkpIDogMCkNCj4gLSNkZWZpbmUgc211X3NldF9mYW5fc3BlZWRfcnBtKHNtdSwg
c3BlZWQpIFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5zZXRfZmFuX3NwZWVkX3JwbSA/IChzbXUpLT5m
dW5jcy0+c2V0X2Zhbl9zcGVlZF9ycG0oKHNtdSksIChzcGVlZCkpIDogMCkNCj4gK2ludCBzbXVf
c2V0X2Zhbl9zcGVlZF9ycG0oc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQzMl90IHNwZWVk
KTsNCj4gKw0KPiAgICNkZWZpbmUgc211X3NlbmRfc21jX21zZyhzbXUsIG1zZykgXA0KPiAgIAko
KHNtdSktPmZ1bmNzLT5zZW5kX3NtY19tc2c/IChzbXUpLT5mdW5jcy0+c2VuZF9zbWNfbXNnKChz
bXUpLCAobXNnKSkgOiAwKQ0KPiAgICNkZWZpbmUgc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFt
KHNtdSwgbXNnLCBwYXJhbSkgXA0KPiBAQCAtNjQyLDIwICs2NDEsMjIgQEAgc3RydWN0IHNtdV9m
dW5jcw0KPiAgIAkoKHNtdSktPnBwdF9mdW5jcy0+cG9wdWxhdGVfdW1kX3N0YXRlX2NsayA/IChz
bXUpLT5wcHRfZnVuY3MtPnBvcHVsYXRlX3VtZF9zdGF0ZV9jbGsoKHNtdSkpIDogMCkNCj4gICAj
ZGVmaW5lIHNtdV9zZXRfZGVmYXVsdF9vZDhfc2V0dGluZ3Moc211KSBcDQo+ICAgCSgoc211KS0+
cHB0X2Z1bmNzLT5zZXRfZGVmYXVsdF9vZDhfc2V0dGluZ3MgPyAoc211KS0+cHB0X2Z1bmNzLT5z
ZXRfZGVmYXVsdF9vZDhfc2V0dGluZ3MoKHNtdSkpIDogMCkNCj4gLSNkZWZpbmUgc211X2dldF9w
b3dlcl9saW1pdChzbXUsIGxpbWl0LCBkZWYpIFwNCj4gLQkoKHNtdSktPnBwdF9mdW5jcy0+Z2V0
X3Bvd2VyX2xpbWl0ID8gKHNtdSktPnBwdF9mdW5jcy0+Z2V0X3Bvd2VyX2xpbWl0KChzbXUpLCAo
bGltaXQpLCAoZGVmKSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfc2V0X3Bvd2VyX2xpbWl0KHNtdSwg
bGltaXQpIFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5zZXRfcG93ZXJfbGltaXQgPyAoc211KS0+ZnVu
Y3MtPnNldF9wb3dlcl9saW1pdCgoc211KSwgKGxpbWl0KSkgOiAwKQ0KPiArDQo+ICtpbnQgc211
X2dldF9wb3dlcl9saW1pdChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gKwkJCXVpbnQzMl90
ICpsaW1pdCwNCj4gKwkJCWJvb2wgZGVmLA0KPiArCQkJYm9vbCBsb2NrX25lZWRlZCk7DQo+ICsN
Cj4gK2ludCBzbXVfc2V0X3Bvd2VyX2xpbWl0KHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1aW50
MzJfdCBsaW1pdCk7DQo+ICAgI2RlZmluZSBzbXVfZ2V0X2N1cnJlbnRfY2xrX2ZyZXEoc211LCBj
bGtfaWQsIHZhbHVlKSBcDQo+ICAgCSgoc211KS0+ZnVuY3MtPmdldF9jdXJyZW50X2Nsa19mcmVx
PyAoc211KS0+ZnVuY3MtPmdldF9jdXJyZW50X2Nsa19mcmVxKChzbXUpLCAoY2xrX2lkKSwgKHZh
bHVlKSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfcHJpbnRfY2xrX2xldmVscyhzbXUsIGNsa190eXBl
LCBidWYpIFwNCj4gLQkoKHNtdSktPnBwdF9mdW5jcy0+cHJpbnRfY2xrX2xldmVscyA/IChzbXUp
LT5wcHRfZnVuY3MtPnByaW50X2Nsa19sZXZlbHMoKHNtdSksIChjbGtfdHlwZSksIChidWYpKSA6
IDApDQo+IC0jZGVmaW5lIHNtdV9nZXRfb2RfcGVyY2VudGFnZShzbXUsIHR5cGUpIFwNCj4gLQko
KHNtdSktPnBwdF9mdW5jcy0+Z2V0X29kX3BlcmNlbnRhZ2UgPyAoc211KS0+cHB0X2Z1bmNzLT5n
ZXRfb2RfcGVyY2VudGFnZSgoc211KSwgKHR5cGUpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9zZXRf
b2RfcGVyY2VudGFnZShzbXUsIHR5cGUsIHZhbHVlKSBcDQo+IC0JKChzbXUpLT5wcHRfZnVuY3Mt
PnNldF9vZF9wZXJjZW50YWdlID8gKHNtdSktPnBwdF9mdW5jcy0+c2V0X29kX3BlcmNlbnRhZ2Uo
KHNtdSksICh0eXBlKSwgKHZhbHVlKSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfb2RfZWRpdF9kcG1f
dGFibGUoc211LCB0eXBlLCBpbnB1dCwgc2l6ZSkgXA0KPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5v
ZF9lZGl0X2RwbV90YWJsZSA/IChzbXUpLT5wcHRfZnVuY3MtPm9kX2VkaXRfZHBtX3RhYmxlKChz
bXUpLCAodHlwZSksIChpbnB1dCksIChzaXplKSkgOiAwKQ0KPiAraW50IHNtdV9wcmludF9jbGtf
bGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlw
ZSwgY2hhciAqYnVmKTsNCj4gK2ludCBzbXVfZ2V0X29kX3BlcmNlbnRhZ2Uoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUsIGVudW0gc211X2Nsa190eXBlIHR5cGUpOw0KPiAraW50IHNtdV9zZXRfb2Rf
cGVyY2VudGFnZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVfY2xrX3R5cGUgdHlw
ZSwgdWludDMyX3QgdmFsdWUpOw0KPiArDQo+ICtpbnQgc211X29kX2VkaXRfZHBtX3RhYmxlKHN0
cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiArCQkJICBlbnVtIFBQX09EX0RQTV9UQUJMRV9DT01N
QU5EIHR5cGUsDQo+ICsJCQkgIGxvbmcgKmlucHV0LCB1aW50MzJfdCBzaXplKTsNCj4gICAjZGVm
aW5lIHNtdV90YWJsZXNfaW5pdChzbXUsIHRhYikgXA0KPiAgIAkoKHNtdSktPnBwdF9mdW5jcy0+
dGFibGVzX2luaXQgPyAoc211KS0+cHB0X2Z1bmNzLT50YWJsZXNfaW5pdCgoc211KSwgKHRhYikp
IDogMCkNCj4gICAjZGVmaW5lIHNtdV9zZXRfdGhlcm1hbF9mYW5fdGFibGUoc211KSBcDQo+IEBA
IC02NjQsMTQgKzY2NSwxOCBAQCBzdHJ1Y3Qgc211X2Z1bmNzDQo+ICAgCSgoc211KS0+ZnVuY3Mt
PnN0YXJ0X3RoZXJtYWxfY29udHJvbD8gKHNtdSktPmZ1bmNzLT5zdGFydF90aGVybWFsX2NvbnRy
b2woKHNtdSkpIDogMCkNCj4gICAjZGVmaW5lIHNtdV9zdG9wX3RoZXJtYWxfY29udHJvbChzbXUp
IFwNCj4gICAJKChzbXUpLT5mdW5jcy0+c3RvcF90aGVybWFsX2NvbnRyb2w/IChzbXUpLT5mdW5j
cy0+c3RvcF90aGVybWFsX2NvbnRyb2woKHNtdSkpIDogMCkNCj4gLSNkZWZpbmUgc211X3JlYWRf
c2Vuc29yKHNtdSwgc2Vuc29yLCBkYXRhLCBzaXplKSBcDQo+IC0JKChzbXUpLT5wcHRfZnVuY3Mt
PnJlYWRfc2Vuc29yPyAoc211KS0+cHB0X2Z1bmNzLT5yZWFkX3NlbnNvcigoc211KSwgKHNlbnNv
ciksIChkYXRhKSwgKHNpemUpKSA6IDApDQo+ICsNCj4gK2ludCBzbXVfcmVhZF9zZW5zb3Ioc3Ry
dWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICsJCSAgICBlbnVtIGFtZF9wcF9zZW5zb3JzIHNlbnNv
ciwNCj4gKwkJICAgIHZvaWQgKmRhdGEsIHVpbnQzMl90ICpzaXplKTsNCj4gICAjZGVmaW5lIHNt
dV9zbWNfcmVhZF9zZW5zb3Ioc211LCBzZW5zb3IsIGRhdGEsIHNpemUpIFwNCj4gICAJKChzbXUp
LT5mdW5jcy0+cmVhZF9zZW5zb3I/IChzbXUpLT5mdW5jcy0+cmVhZF9zZW5zb3IoKHNtdSksIChz
ZW5zb3IpLCAoZGF0YSksIChzaXplKSkgOiAtRUlOVkFMKQ0KPiAtI2RlZmluZSBzbXVfZ2V0X3Bv
d2VyX3Byb2ZpbGVfbW9kZShzbXUsIGJ1ZikgXA0KPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5nZXRf
cG93ZXJfcHJvZmlsZV9tb2RlID8gKHNtdSktPnBwdF9mdW5jcy0+Z2V0X3Bvd2VyX3Byb2ZpbGVf
bW9kZSgoc211KSwgYnVmKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9zZXRfcG93ZXJfcHJvZmlsZV9t
b2RlKHNtdSwgcGFyYW0sIHBhcmFtX3NpemUpIFwNCj4gLQkoKHNtdSktPnBwdF9mdW5jcy0+c2V0
X3Bvd2VyX3Byb2ZpbGVfbW9kZSA/IChzbXUpLT5wcHRfZnVuY3MtPnNldF9wb3dlcl9wcm9maWxl
X21vZGUoKHNtdSksIChwYXJhbSksIChwYXJhbV9zaXplKSkgOiAwKQ0KPiAraW50IHNtdV9nZXRf
cG93ZXJfcHJvZmlsZV9tb2RlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBjaGFyICpidWYpOw0K
PiArDQo+ICtpbnQgc211X3NldF9wb3dlcl9wcm9maWxlX21vZGUoc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUsDQo+ICsJCQkgICAgICAgbG9uZyAqcGFyYW0sDQo+ICsJCQkgICAgICAgdWludDMyX3Qg
cGFyYW1fc2l6ZSwNCj4gKwkJCSAgICAgICBib29sIGxvY2tfbmVlZGVkKTsNCj4gICAjZGVmaW5l
IHNtdV9wcmVfZGlzcGxheV9jb25maWdfY2hhbmdlZChzbXUpIFwNCj4gICAJKChzbXUpLT5wcHRf
ZnVuY3MtPnByZV9kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkID8gKHNtdSktPnBwdF9mdW5jcy0+cHJl
X2Rpc3BsYXlfY29uZmlnX2NoYW5nZWQoKHNtdSkpIDogMCkNCj4gICAjZGVmaW5lIHNtdV9kaXNw
bGF5X2NvbmZpZ19jaGFuZ2VkKHNtdSkgXA0KPiBAQCAtNjg4LDE2ICs2OTMsMTEgQEAgc3RydWN0
IHNtdV9mdW5jcw0KPiAgIAkoKHNtdSktPnBwdF9mdW5jcy0+Z2V0X3Byb2ZpbGluZ19jbGtfbWFz
ayA/IChzbXUpLT5wcHRfZnVuY3MtPmdldF9wcm9maWxpbmdfY2xrX21hc2soKHNtdSksIChsZXZl
bCksIChzY2xrX21hc2spLCAobWNsa19tYXNrKSwgKHNvY19tYXNrKSkgOiAwKQ0KPiAgICNkZWZp
bmUgc211X3NldF9jcHVfcG93ZXJfc3RhdGUoc211KSBcDQo+ICAgCSgoc211KS0+cHB0X2Z1bmNz
LT5zZXRfY3B1X3Bvd2VyX3N0YXRlID8gKHNtdSktPnBwdF9mdW5jcy0+c2V0X2NwdV9wb3dlcl9z
dGF0ZSgoc211KSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfZ2V0X2Zhbl9jb250cm9sX21vZGUoc211
KSBcDQo+IC0JKChzbXUpLT5mdW5jcy0+Z2V0X2Zhbl9jb250cm9sX21vZGUgPyAoc211KS0+ZnVu
Y3MtPmdldF9mYW5fY29udHJvbF9tb2RlKChzbXUpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9zZXRf
ZmFuX2NvbnRyb2xfbW9kZShzbXUsIHZhbHVlKSBcDQo+IC0JKChzbXUpLT5mdW5jcy0+c2V0X2Zh
bl9jb250cm9sX21vZGUgPyAoc211KS0+ZnVuY3MtPnNldF9mYW5fY29udHJvbF9tb2RlKChzbXUp
LCAodmFsdWUpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9nZXRfZmFuX3NwZWVkX3BlcmNlbnQoc211
LCBzcGVlZCkgXA0KPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5nZXRfZmFuX3NwZWVkX3BlcmNlbnQg
PyAoc211KS0+cHB0X2Z1bmNzLT5nZXRfZmFuX3NwZWVkX3BlcmNlbnQoKHNtdSksIChzcGVlZCkp
IDogMCkNCj4gLSNkZWZpbmUgc211X3NldF9mYW5fc3BlZWRfcGVyY2VudChzbXUsIHNwZWVkKSBc
DQo+IC0JKChzbXUpLT5mdW5jcy0+c2V0X2Zhbl9zcGVlZF9wZXJjZW50ID8gKHNtdSktPmZ1bmNz
LT5zZXRfZmFuX3NwZWVkX3BlcmNlbnQoKHNtdSksIChzcGVlZCkpIDogMCkNCj4gLSNkZWZpbmUg
c211X2dldF9mYW5fc3BlZWRfcnBtKHNtdSwgc3BlZWQpIFwNCj4gLQkoKHNtdSktPnBwdF9mdW5j
cy0+Z2V0X2Zhbl9zcGVlZF9ycG0gPyAoc211KS0+cHB0X2Z1bmNzLT5nZXRfZmFuX3NwZWVkX3Jw
bSgoc211KSwgKHNwZWVkKSkgOiAwKQ0KPiAraW50IHNtdV9nZXRfZmFuX2NvbnRyb2xfbW9kZShz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSk7DQo+ICtpbnQgc211X3NldF9mYW5fY29udHJvbF9tb2Rl
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBpbnQgdmFsdWUpOw0KPiAraW50IHNtdV9nZXRfZmFu
X3NwZWVkX3BlcmNlbnQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQzMl90ICpzcGVlZCk7
DQo+ICtpbnQgc211X3NldF9mYW5fc3BlZWRfcGVyY2VudChzdHJ1Y3Qgc211X2NvbnRleHQgKnNt
dSwgdWludDMyX3Qgc3BlZWQpOw0KPiAraW50IHNtdV9nZXRfZmFuX3NwZWVkX3JwbShzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSwgdWludDMyX3QgKnNwZWVkKTsNCj4gICANCj4gICAjZGVmaW5lIHNt
dV9tc2dfZ2V0X2luZGV4KHNtdSwgbXNnKSBcDQo+ICAgCSgoc211KS0+cHB0X2Z1bmNzPyAoKHNt
dSktPnBwdF9mdW5jcy0+Z2V0X3NtdV9tc2dfaW5kZXg/IChzbXUpLT5wcHRfZnVuY3MtPmdldF9z
bXVfbXNnX2luZGV4KChzbXUpLCAobXNnKSkgOiAtRUlOVkFMKSA6IC1FSU5WQUwpDQo+IEBAIC03
MTUsNDAgKzcxNSw0NiBAQCBzdHJ1Y3Qgc211X2Z1bmNzDQo+ICAgCSgoc211KS0+cHB0X2Z1bmNz
PyAoKHNtdSktPnBwdF9mdW5jcy0+cnVuX2J0Yz8gKHNtdSktPnBwdF9mdW5jcy0+cnVuX2J0Yygo
c211KSkgOiAwKSA6IDApDQo+ICAgI2RlZmluZSBzbXVfZ2V0X2FsbG93ZWRfZmVhdHVyZV9tYXNr
KHNtdSwgZmVhdHVyZV9tYXNrLCBudW0pIFwNCj4gICAJKChzbXUpLT5wcHRfZnVuY3M/ICgoc211
KS0+cHB0X2Z1bmNzLT5nZXRfYWxsb3dlZF9mZWF0dXJlX21hc2s/IChzbXUpLT5wcHRfZnVuY3Mt
PmdldF9hbGxvd2VkX2ZlYXR1cmVfbWFzaygoc211KSwgKGZlYXR1cmVfbWFzayksIChudW0pKSA6
IDApIDogMCkNCj4gLSNkZWZpbmUgc211X3NldF9kZWVwX3NsZWVwX2RjZWZjbGsoc211LCBjbGsp
IFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5zZXRfZGVlcF9zbGVlcF9kY2VmY2xrID8gKHNtdSktPmZ1
bmNzLT5zZXRfZGVlcF9zbGVlcF9kY2VmY2xrKChzbXUpLCAoY2xrKSkgOiAwKQ0KPiAtI2RlZmlu
ZSBzbXVfc2V0X2FjdGl2ZV9kaXNwbGF5X2NvdW50KHNtdSwgY291bnQpIFwNCj4gLQkoKHNtdSkt
PmZ1bmNzLT5zZXRfYWN0aXZlX2Rpc3BsYXlfY291bnQgPyAoc211KS0+ZnVuY3MtPnNldF9hY3Rp
dmVfZGlzcGxheV9jb3VudCgoc211KSwgKGNvdW50KSkgOiAwKQ0KPiAraW50IHNtdV9zZXRfZGVl
cF9zbGVlcF9kY2VmY2xrKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBpbnQgY2xrKTsNCj4gK2lu
dCBzbXVfc2V0X2FjdGl2ZV9kaXNwbGF5X2NvdW50KHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1
aW50MzJfdCBjb3VudCk7DQo+ICAgI2RlZmluZSBzbXVfc3RvcmVfY2M2X2RhdGEoc211LCBzdCwg
Y2M2X2RpcywgcHN0X2RpcywgcHN0X3N3X2RpcykgXA0KPiAgIAkoKHNtdSktPmZ1bmNzLT5zdG9y
ZV9jYzZfZGF0YSA/IChzbXUpLT5mdW5jcy0+c3RvcmVfY2M2X2RhdGEoKHNtdSksIChzdCksIChj
YzZfZGlzKSwgKHBzdF9kaXMpLCAocHN0X3N3X2RpcykpIDogMCkNCj4gLSNkZWZpbmUgc211X2dl
dF9jbG9ja19ieV90eXBlKHNtdSwgdHlwZSwgY2xvY2tzKSBcDQo+IC0JKChzbXUpLT5mdW5jcy0+
Z2V0X2Nsb2NrX2J5X3R5cGUgPyAoc211KS0+ZnVuY3MtPmdldF9jbG9ja19ieV90eXBlKChzbXUp
LCAodHlwZSksIChjbG9ja3MpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9nZXRfbWF4X2hpZ2hfY2xv
Y2tzKHNtdSwgY2xvY2tzKSBcDQo+IC0JKChzbXUpLT5mdW5jcy0+Z2V0X21heF9oaWdoX2Nsb2Nr
cyA/IChzbXUpLT5mdW5jcy0+Z2V0X21heF9oaWdoX2Nsb2Nrcygoc211KSwgKGNsb2NrcykpIDog
MCkNCj4gLSNkZWZpbmUgc211X2dldF9jbG9ja19ieV90eXBlX3dpdGhfbGF0ZW5jeShzbXUsIGNs
a190eXBlLCBjbG9ja3MpIFwNCj4gLQkoKHNtdSktPnBwdF9mdW5jcy0+Z2V0X2Nsb2NrX2J5X3R5
cGVfd2l0aF9sYXRlbmN5ID8gKHNtdSktPnBwdF9mdW5jcy0+Z2V0X2Nsb2NrX2J5X3R5cGVfd2l0
aF9sYXRlbmN5KChzbXUpLCAoY2xrX3R5cGUpLCAoY2xvY2tzKSkgOiAwKQ0KPiAtI2RlZmluZSBz
bXVfZ2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF92b2x0YWdlKHNtdSwgdHlwZSwgY2xvY2tzKSBcDQo+
IC0JKChzbXUpLT5wcHRfZnVuY3MtPmdldF9jbG9ja19ieV90eXBlX3dpdGhfdm9sdGFnZSA/IChz
bXUpLT5wcHRfZnVuY3MtPmdldF9jbG9ja19ieV90eXBlX3dpdGhfdm9sdGFnZSgoc211KSwgKHR5
cGUpLCAoY2xvY2tzKSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfZGlzcGxheV9jbG9ja192b2x0YWdl
X3JlcXVlc3Qoc211LCBjbG9ja19yZXEpIFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5kaXNwbGF5X2Ns
b2NrX3ZvbHRhZ2VfcmVxdWVzdCA/IChzbXUpLT5mdW5jcy0+ZGlzcGxheV9jbG9ja192b2x0YWdl
X3JlcXVlc3QoKHNtdSksIChjbG9ja19yZXEpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9kaXNwbGF5
X2Rpc2FibGVfbWVtb3J5X2Nsb2NrX3N3aXRjaChzbXUsIGRpc2FibGVfbWVtb3J5X2Nsb2NrX3N3
aXRjaCkgXA0KPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5kaXNwbGF5X2Rpc2FibGVfbWVtb3J5X2Ns
b2NrX3N3aXRjaCA/IChzbXUpLT5wcHRfZnVuY3MtPmRpc3BsYXlfZGlzYWJsZV9tZW1vcnlfY2xv
Y2tfc3dpdGNoKChzbXUpLCAoZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dpdGNoKSkgOiAtRUlOVkFM
KQ0KPiArDQo+ICtpbnQgc211X2dldF9jbG9ja19ieV90eXBlKHN0cnVjdCBzbXVfY29udGV4dCAq
c211LA0KPiArCQkJICBlbnVtIGFtZF9wcF9jbG9ja190eXBlIHR5cGUsDQo+ICsJCQkgIHN0cnVj
dCBhbWRfcHBfY2xvY2tzICpjbG9ja3MpOw0KPiArDQo+ICtpbnQgc211X2dldF9tYXhfaGlnaF9j
bG9ja3Moc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICsJCQkgICAgc3RydWN0IGFtZF9wcF9z
aW1wbGVfY2xvY2tfaW5mbyAqY2xvY2tzKTsNCj4gKw0KPiAraW50IHNtdV9nZXRfY2xvY2tfYnlf
dHlwZV93aXRoX2xhdGVuY3koc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICsJCQkJICAgICAg
IGVudW0gc211X2Nsa190eXBlIGNsa190eXBlLA0KPiArCQkJCSAgICAgICBzdHJ1Y3QgcHBfY2xv
Y2tfbGV2ZWxzX3dpdGhfbGF0ZW5jeSAqY2xvY2tzKTsNCj4gKw0KPiAraW50IHNtdV9nZXRfY2xv
Y2tfYnlfdHlwZV93aXRoX3ZvbHRhZ2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICsJCQkJ
ICAgICAgIGVudW0gYW1kX3BwX2Nsb2NrX3R5cGUgdHlwZSwNCj4gKwkJCQkgICAgICAgc3RydWN0
IHBwX2Nsb2NrX2xldmVsc193aXRoX3ZvbHRhZ2UgKmNsb2Nrcyk7DQo+ICsNCj4gK2ludCBzbXVf
ZGlzcGxheV9jbG9ja192b2x0YWdlX3JlcXVlc3Qoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+
ICsJCQkJICAgICAgc3RydWN0IHBwX2Rpc3BsYXlfY2xvY2tfcmVxdWVzdCAqY2xvY2tfcmVxKTsN
Cj4gK2ludCBzbXVfZGlzcGxheV9kaXNhYmxlX21lbW9yeV9jbG9ja19zd2l0Y2goc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUsIGJvb2wgZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dpdGNoKTsNCj4gICAj
ZGVmaW5lIHNtdV9nZXRfZGFsX3Bvd2VyX2xldmVsKHNtdSwgY2xvY2tzKSBcDQo+ICAgCSgoc211
KS0+ZnVuY3MtPmdldF9kYWxfcG93ZXJfbGV2ZWwgPyAoc211KS0+ZnVuY3MtPmdldF9kYWxfcG93
ZXJfbGV2ZWwoKHNtdSksIChjbG9ja3MpKSA6IDApDQo+ICAgI2RlZmluZSBzbXVfZ2V0X3BlcmZf
bGV2ZWwoc211LCBkZXNpZ25hdGlvbiwgbGV2ZWwpIFwNCj4gICAJKChzbXUpLT5mdW5jcy0+Z2V0
X3BlcmZfbGV2ZWwgPyAoc211KS0+ZnVuY3MtPmdldF9wZXJmX2xldmVsKChzbXUpLCAoZGVzaWdu
YXRpb24pLCAobGV2ZWwpKSA6IDApDQo+ICAgI2RlZmluZSBzbXVfZ2V0X2N1cnJlbnRfc2hhbGxv
d19zbGVlcF9jbG9ja3Moc211LCBjbG9ja3MpIFwNCj4gICAJKChzbXUpLT5mdW5jcy0+Z2V0X2N1
cnJlbnRfc2hhbGxvd19zbGVlcF9jbG9ja3MgPyAoc211KS0+ZnVuY3MtPmdldF9jdXJyZW50X3No
YWxsb3dfc2xlZXBfY2xvY2tzKChzbXUpLCAoY2xvY2tzKSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVf
bm90aWZ5X3NtdV9lbmFibGVfcHdlKHNtdSkgXA0KPiAtCSgoc211KS0+ZnVuY3MtPm5vdGlmeV9z
bXVfZW5hYmxlX3B3ZSA/IChzbXUpLT5mdW5jcy0+bm90aWZ5X3NtdV9lbmFibGVfcHdlKChzbXUp
KSA6IDApDQo+IC0jZGVmaW5lIHNtdV9zZXRfd2F0ZXJtYXJrc19mb3JfY2xvY2tfcmFuZ2VzKHNt
dSwgY2xvY2tfcmFuZ2VzKSBcDQo+IC0JKChzbXUpLT5mdW5jcy0+c2V0X3dhdGVybWFya3NfZm9y
X2Nsb2NrX3JhbmdlcyA/IChzbXUpLT5mdW5jcy0+c2V0X3dhdGVybWFya3NfZm9yX2Nsb2NrX3Jh
bmdlcygoc211KSwgKGNsb2NrX3JhbmdlcykpIDogMCkNCj4gK2ludCBzbXVfbm90aWZ5X3NtdV9l
bmFibGVfcHdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KTsNCj4gKw0KPiAraW50IHNtdV9zZXRf
d2F0ZXJtYXJrc19mb3JfY2xvY2tfcmFuZ2VzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiAr
CQkJCQlzdHJ1Y3QgZG1fcHBfd21fc2V0c193aXRoX2Nsb2NrX3Jhbmdlc19zb2MxNSAqY2xvY2tf
cmFuZ2VzKTsNCj4gICAjZGVmaW5lIHNtdV9kcG1fc2V0X3V2ZF9lbmFibGUoc211LCBlbmFibGUp
IFwNCj4gICAJKChzbXUpLT5wcHRfZnVuY3MtPmRwbV9zZXRfdXZkX2VuYWJsZSA/IChzbXUpLT5w
cHRfZnVuY3MtPmRwbV9zZXRfdXZkX2VuYWJsZSgoc211KSwgKGVuYWJsZSkpIDogMCkNCj4gICAj
ZGVmaW5lIHNtdV9kcG1fc2V0X3ZjZV9lbmFibGUoc211LCBlbmFibGUpIFwNCj4gICAJKChzbXUp
LT5wcHRfZnVuY3MtPmRwbV9zZXRfdmNlX2VuYWJsZSA/IChzbXUpLT5wcHRfZnVuY3MtPmRwbV9z
ZXRfdmNlX2VuYWJsZSgoc211KSwgKGVuYWJsZSkpIDogMCkNCj4gLSNkZWZpbmUgc211X3NldF94
Z21pX3BzdGF0ZShzbXUsIHBzdGF0ZSkgXA0KPiAtCQkoKHNtdSktPmZ1bmNzLT5zZXRfeGdtaV9w
c3RhdGUgPyAoc211KS0+ZnVuY3MtPnNldF94Z21pX3BzdGF0ZSgoc211KSwgKHBzdGF0ZSkpIDog
MCkNCj4gKw0KPiAraW50IHNtdV9zZXRfeGdtaV9wc3RhdGUoc3RydWN0IHNtdV9jb250ZXh0ICpz
bXUsDQo+ICsJCQl1aW50MzJfdCBwc3RhdGUpOw0KPiAgICNkZWZpbmUgc211X3NldF93YXRlcm1h
cmtzX3RhYmxlKHNtdSwgdGFiLCBjbG9ja19yYW5nZXMpIFwNCj4gICAJKChzbXUpLT5wcHRfZnVu
Y3MtPnNldF93YXRlcm1hcmtzX3RhYmxlID8gKHNtdSktPnBwdF9mdW5jcy0+c2V0X3dhdGVybWFy
a3NfdGFibGUoKHNtdSksICh0YWIpLCAoY2xvY2tfcmFuZ2VzKSkgOiAwKQ0KPiAgICNkZWZpbmUg
c211X2dldF9jdXJyZW50X2Nsa19mcmVxX2J5X3RhYmxlKHNtdSwgY2xrX3R5cGUsIHZhbHVlKSBc
DQo+IEBAIC03NTksMjIgKzc2NSwxOCBAQCBzdHJ1Y3Qgc211X2Z1bmNzDQo+ICAgCSgoc211KS0+
cHB0X2Z1bmNzLT5nZXRfdGhlcm1hbF90ZW1wZXJhdHVyZV9yYW5nZT8gKHNtdSktPnBwdF9mdW5j
cy0+Z2V0X3RoZXJtYWxfdGVtcGVyYXR1cmVfcmFuZ2UoKHNtdSksIChyYW5nZSkpIDogMCkNCj4g
ICAjZGVmaW5lIHNtdV9yZWdpc3Rlcl9pcnFfaGFuZGxlcihzbXUpIFwNCj4gICAJKChzbXUpLT5m
dW5jcy0+cmVnaXN0ZXJfaXJxX2hhbmRsZXIgPyAoc211KS0+ZnVuY3MtPnJlZ2lzdGVyX2lycV9o
YW5kbGVyKHNtdSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfc2V0X2F6YWxpYV9kM19wbWUoc211KSBc
DQo+IC0JKChzbXUpLT5mdW5jcy0+c2V0X2F6YWxpYV9kM19wbWUgPyAoc211KS0+ZnVuY3MtPnNl
dF9hemFsaWFfZDNfcG1lKChzbXUpKSA6IDApDQo+ICsNCj4gK2ludCBzbXVfc2V0X2F6YWxpYV9k
M19wbWUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpOw0KPiAgICNkZWZpbmUgc211X2dldF9kcG1f
dWx0aW1hdGVfZnJlcShzbXUsIHBhcmFtLCBtaW4sIG1heCkgXA0KPiAgIAkJKChzbXUpLT5mdW5j
cy0+Z2V0X2RwbV91bHRpbWF0ZV9mcmVxID8gKHNtdSktPmZ1bmNzLT5nZXRfZHBtX3VsdGltYXRl
X2ZyZXEoKHNtdSksIChwYXJhbSksIChtaW4pLCAobWF4KSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVf
Z2V0X3VjbGtfZHBtX3N0YXRlcyhzbXUsIGNsb2Nrc19pbl9raHosIG51bV9zdGF0ZXMpIFwNCj4g
LQkoKHNtdSktPnBwdF9mdW5jcy0+Z2V0X3VjbGtfZHBtX3N0YXRlcyA/IChzbXUpLT5wcHRfZnVu
Y3MtPmdldF91Y2xrX2RwbV9zdGF0ZXMoKHNtdSksIChjbG9ja3NfaW5fa2h6KSwgKG51bV9zdGF0
ZXMpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9nZXRfbWF4X3N1c3RhaW5hYmxlX2Nsb2Nrc19ieV9k
YyhzbXUsIG1heF9jbG9ja3MpIFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5nZXRfbWF4X3N1c3RhaW5h
YmxlX2Nsb2Nrc19ieV9kYyA/IChzbXUpLT5mdW5jcy0+Z2V0X21heF9zdXN0YWluYWJsZV9jbG9j
a3NfYnlfZGMoKHNtdSksIChtYXhfY2xvY2tzKSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfYmFjb19p
c19zdXBwb3J0KHNtdSkgXA0KPiAtCSgoc211KS0+ZnVuY3MtPmJhY29faXNfc3VwcG9ydD8gKHNt
dSktPmZ1bmNzLT5iYWNvX2lzX3N1cHBvcnQoKHNtdSkpIDogZmFsc2UpDQo+IC0jZGVmaW5lIHNt
dV9iYWNvX2dldF9zdGF0ZShzbXUsIHN0YXRlKSBcDQo+IC0JKChzbXUpLT5mdW5jcy0+YmFjb19n
ZXRfc3RhdGU/IChzbXUpLT5mdW5jcy0+YmFjb19nZXRfc3RhdGUoKHNtdSksIChzdGF0ZSkpIDog
MCkNCj4gLSNkZWZpbmUgc211X2JhY29fcmVzZXQoc211KSBcDQo+IC0JKChzbXUpLT5mdW5jcy0+
YmFjb19yZXNldD8gKHNtdSktPmZ1bmNzLT5iYWNvX3Jlc2V0KChzbXUpKSA6IDApDQo+IC0jZGVm
aW5lIHNtdV9tb2RlMl9yZXNldChzbXUpIFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5tb2RlMl9yZXNl
dD8gKHNtdSktPmZ1bmNzLT5tb2RlMl9yZXNldCgoc211KSkgOiAwKQ0KPiArDQo+ICtib29sIHNt
dV9iYWNvX2lzX3N1cHBvcnQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpOw0KPiArDQo+ICtpbnQg
c211X2JhY29fZ2V0X3N0YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9iYWNv
X3N0YXRlICpzdGF0ZSk7DQo+ICsNCj4gK2ludCBzbXVfYmFjb19yZXNldChzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSk7DQo+ICsNCj4gK2ludCBzbXVfbW9kZTJfcmVzZXQoc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUpOw0KPiAgICNkZWZpbmUgc211X2FzaWNfc2V0X3BlcmZvcm1hbmNlX2xldmVsKHNt
dSwgbGV2ZWwpIFwNCj4gICAJKChzbXUpLT5wcHRfZnVuY3MtPnNldF9wZXJmb3JtYW5jZV9sZXZl
bD8gKHNtdSktPnBwdF9mdW5jcy0+c2V0X3BlcmZvcm1hbmNlX2xldmVsKChzbXUpLCAobGV2ZWwp
KSA6IC1FSU5WQUwpOw0KPiAgICNkZWZpbmUgc211X2R1bXBfcHB0YWJsZShzbXUpIFwNCj4gQEAg
LTgzMyw3ICs4MzUsOCBAQCBleHRlcm4gaW50IHNtdV9nZXRfY3VycmVudF9jbG9ja3Moc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgZXh0ZXJuIGludCBzbXVfZHBtX3NldF9wb3dlcl9nYXRl
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LHVpbnQzMl90IGJsb2NrX3R5cGUsIGJvb2wgZ2F0ZSk7
DQo+ICAgZXh0ZXJuIGludCBzbXVfaGFuZGxlX3Rhc2soc3RydWN0IHNtdV9jb250ZXh0ICpzbXUs
DQo+ICAgCQkJICAgZW51bSBhbWRfZHBtX2ZvcmNlZF9sZXZlbCBsZXZlbCwNCj4gLQkJCSAgIGVu
dW0gYW1kX3BwX3Rhc2sgdGFza19pZCk7DQo+ICsJCQkgICBlbnVtIGFtZF9wcF90YXNrIHRhc2tf
aWQsDQo+ICsJCQkgICBib29sIGxvY2tfbmVlZGVkKTsNCj4gICBpbnQgc211X3N3aXRjaF9wb3dl
cl9wcm9maWxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiAgIAkJCSAgICAgZW51bSBQUF9T
TUNfUE9XRVJfUFJPRklMRSB0eXBlLA0KPiAgIAkJCSAgICAgYm9vbCBlbik7DQo+IEBAIC04NDMs
NyArODQ2LDcgQEAgaW50IHNtdV9nZXRfZHBtX2ZyZXFfYnlfaW5kZXgoc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUsIGVudW0gc211X2Nsa190eXBlIGNsa190eXANCj4gICBpbnQgc211X2dldF9kcG1f
bGV2ZWxfY291bnQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0gc211X2Nsa190eXBlIGNs
a190eXBlLA0KPiAgIAkJCSAgICB1aW50MzJfdCAqdmFsdWUpOw0KPiAgIGludCBzbXVfZ2V0X2Rw
bV9mcmVxX3JhbmdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSBj
bGtfdHlwZSwNCj4gLQkJCSAgIHVpbnQzMl90ICptaW4sIHVpbnQzMl90ICptYXgpOw0KPiArCQkJ
ICAgdWludDMyX3QgKm1pbiwgdWludDMyX3QgKm1heCwgYm9vbCBsb2NrX25lZWRlZCk7DQo+ICAg
aW50IHNtdV9zZXRfc29mdF9mcmVxX3JhbmdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVt
IHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwNCj4gICAJCQkgICAgdWludDMyX3QgbWluLCB1aW50MzJf
dCBtYXgpOw0KPiAgIGludCBzbXVfc2V0X2hhcmRfZnJlcV9yYW5nZShzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSwgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsDQo+IEBAIC04NTgsMTAgKzg2MSwy
MCBAQCBzaXplX3Qgc211X3N5c19nZXRfcHBfZmVhdHVyZV9tYXNrKHN0cnVjdCBzbXVfY29udGV4
dCAqc211LCBjaGFyICpidWYpOw0KPiAgIGludCBzbXVfc3lzX3NldF9wcF9mZWF0dXJlX21hc2so
c3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQ2NF90IG5ld19tYXNrKTsNCj4gICBpbnQgc211
X2ZvcmNlX2Nsa19sZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCQkJIGVudW0g
c211X2Nsa190eXBlIGNsa190eXBlLA0KPiAtCQkJIHVpbnQzMl90IG1hc2spOw0KPiArCQkJIHVp
bnQzMl90IG1hc2ssDQo+ICsJCQkgYm9vbCBsb2NrX25lZWRlZCk7DQo+ICAgaW50IHNtdV9zZXRf
bXAxX3N0YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiAgIAkJICAgICAgZW51bSBwcF9t
cDFfc3RhdGUgbXAxX3N0YXRlKTsNCj4gICBpbnQgc211X3NldF9kZl9jc3RhdGUoc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUsDQo+ICAgCQkgICAgICBlbnVtIHBwX2RmX2NzdGF0ZSBzdGF0ZSk7DQo+
ICAgDQo+ICtpbnQgc211X2dldF9tYXhfc3VzdGFpbmFibGVfY2xvY2tzX2J5X2RjKHN0cnVjdCBz
bXVfY29udGV4dCAqc211LA0KPiArCQkJCQkgc3RydWN0IHBwX3NtdV9udl9jbG9ja190YWJsZSAq
bWF4X2Nsb2Nrcyk7DQo+ICsNCj4gK2ludCBzbXVfZ2V0X3VjbGtfZHBtX3N0YXRlcyhzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSwNCj4gKwkJCSAgICB1bnNpZ25lZCBpbnQgKmNsb2NrX3ZhbHVlc19p
bl9raHosDQo+ICsJCQkgICAgdW5zaWduZWQgaW50ICpudW1fc3RhdGVzKTsNCj4gKw0KPiArZW51
bSBhbWRfcG1fc3RhdGVfdHlwZSBzbXVfZ2V0X2N1cnJlbnRfcG93ZXJfc3RhdGUoc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUpOw0KPiArDQo+ICAgI2VuZGlmDQo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L3Bvd2VycGxheS9uYXZpMTBfcHB0LmMNCj4gaW5kZXggYjg4YWFlOWJiMjQyLi5lYWQ0MGIyODQw
ZjkgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25hdmkxMF9w
cHQuYw0KPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0LmMN
Cj4gQEAgLTc5NSwxMyArNzk1LDEzIEBAIHN0YXRpYyBpbnQgbmF2aTEwX3BvcHVsYXRlX3VtZF9z
dGF0ZV9jbGsoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpDQo+ICAgCWludCByZXQgPSAwOw0KPiAg
IAl1aW50MzJfdCBtaW5fc2Nsa19mcmVxID0gMCwgbWluX21jbGtfZnJlcSA9IDA7DQo+ICAgDQo+
IC0JcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9TQ0xLLCAmbWluX3NjbGtf
ZnJlcSwgTlVMTCk7DQo+ICsJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9T
Q0xLLCAmbWluX3NjbGtfZnJlcSwgTlVMTCwgZmFsc2UpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJ
cmV0dXJuIHJldDsNCj4gICANCj4gICAJc211LT5wc3RhdGVfc2NsayA9IG1pbl9zY2xrX2ZyZXEg
KiAxMDA7DQo+ICAgDQo+IC0JcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9N
Q0xLLCAmbWluX21jbGtfZnJlcSwgTlVMTCk7DQo+ICsJcmV0ID0gc211X2dldF9kcG1fZnJlcV9y
YW5nZShzbXUsIFNNVV9NQ0xLLCAmbWluX21jbGtfZnJlcSwgTlVMTCwgZmFsc2UpOw0KPiAgIAlp
ZiAocmV0KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gQEAgLTg1NCw3ICs4NTQsNyBAQCBz
dGF0aWMgaW50IG5hdmkxMF9wcmVfZGlzcGxheV9jb25maWdfY2hhbmdlZChzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSkNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+ICAgCWlmIChzbXVfZmVhdHVy
ZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX1VDTEtfQklUKSkgew0KPiAtCQlyZXQg
PSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgU01VX1VDTEssIE5VTEwsICZtYXhfZnJlcSk7
DQo+ICsJCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBTTVVfVUNMSywgTlVMTCwg
Jm1heF9mcmVxLCBmYWxzZSk7DQo+ICAgCQlpZiAocmV0KQ0KPiAgIAkJCXJldHVybiByZXQ7DQo+
ICAgCQlyZXQgPSBzbXVfc2V0X2hhcmRfZnJlcV9yYW5nZShzbXUsIFNNVV9VQ0xLLCAwLCBtYXhf
ZnJlcSk7DQo+IEBAIC05MDQsNyArOTA0LDcgQEAgc3RhdGljIGludCBuYXZpMTBfZm9yY2VfZHBt
X2xpbWl0X3ZhbHVlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBib29sIGhpZ2hlc3QpDQo+ICAg
DQo+ICAgCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNsa3MpOyBpKyspIHsNCj4gICAJCWNs
a190eXBlID0gY2xrc1tpXTsNCj4gLQkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUs
IGNsa190eXBlLCAmbWluX2ZyZXEsICZtYXhfZnJlcSk7DQo+ICsJCXJldCA9IHNtdV9nZXRfZHBt
X2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlwZSwgJm1pbl9mcmVxLCAmbWF4X2ZyZXEsIGZhbHNlKTsN
Cj4gICAJCWlmIChyZXQpDQo+ICAgCQkJcmV0dXJuIHJldDsNCj4gICANCj4gQEAgLTkzMSw3ICs5
MzEsNyBAQCBzdGF0aWMgaW50IG5hdmkxMF91bmZvcmNlX2RwbV9sZXZlbHMoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUpDQo+ICAgDQo+ICAgCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNsa3Mp
OyBpKyspIHsNCj4gICAJCWNsa190eXBlID0gY2xrc1tpXTsNCj4gLQkJcmV0ID0gc211X2dldF9k
cG1fZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCAmbWluX2ZyZXEsICZtYXhfZnJlcSk7DQo+ICsJ
CXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlwZSwgJm1pbl9mcmVxLCAm
bWF4X2ZyZXEsIGZhbHNlKTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJcmV0dXJuIHJldDsNCj4g
ICANCj4gQEAgLTEyNjYsNyArMTI2NiwxMCBAQCBzdGF0aWMgaW50IG5hdmkxMF9ub3RpZnlfc21j
X2Rpc3BhbHlfY29uZmlnKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KPiAgIAlpZiAoc211X2Zl
YXR1cmVfaXNfc3VwcG9ydGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX0RDRUZDTEtfQklUKSkgew0K
PiAgIAkJY2xvY2tfcmVxLmNsb2NrX3R5cGUgPSBhbWRfcHBfZGNlZl9jbG9jazsNCj4gICAJCWNs
b2NrX3JlcS5jbG9ja19mcmVxX2luX2toeiA9IG1pbl9jbG9ja3MuZGNlZl9jbG9jayAqIDEwOw0K
PiAtCQlpZiAoIXNtdV9kaXNwbGF5X2Nsb2NrX3ZvbHRhZ2VfcmVxdWVzdChzbXUsICZjbG9ja19y
ZXEpKSB7DQo+ICsNCj4gKwkJaWYgKHNtdS0+ZnVuY3MtPmRpc3BsYXlfY2xvY2tfdm9sdGFnZV9y
ZXF1ZXN0KQ0KPiArCQkJcmV0ID0gc211LT5mdW5jcy0+ZGlzcGxheV9jbG9ja192b2x0YWdlX3Jl
cXVlc3Qoc211LCAmY2xvY2tfcmVxKTsNCj4gKwkJaWYgKCFyZXQpIHsNCj4gICAJCQlpZiAoc211
X2ZlYXR1cmVfaXNfc3VwcG9ydGVkKHNtdSwgU01VX0ZFQVRVUkVfRFNfRENFRkNMS19CSVQpKSB7
DQo+ICAgCQkJCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsDQo+ICAgCQkJ
CQkJCQkgIFNNVV9NU0dfU2V0TWluRGVlcFNsZWVwRGNlZmNsaywNCj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3Jlbm9pcl9wcHQuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvcG93ZXJwbGF5L3Jlbm9pcl9wcHQuYw0KPiBpbmRleCA2YWVkZmZkNzM5ZGIuLjAyNmY2
MTFkN2QzMiAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcmVu
b2lyX3BwdC5jDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3Jlbm9pcl9w
cHQuYw0KPiBAQCAtMTk0LDcgKzE5NCw3IEBAIHN0YXRpYyBpbnQgcmVub2lyX3ByaW50X2Nsa19s
ZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCWNhc2UgU01VX1NDTEs6DQo+ICAg
CQkvKiByZXRpcnZlIHRhYmxlIHJldHVybmVkIHBhcmFtdGVycyB1bml0IGlzIE1IeiAqLw0KPiAg
IAkJY3VyX3ZhbHVlID0gbWV0cmljcy5DbG9ja0ZyZXF1ZW5jeVtDTE9DS19HRlhDTEtdOw0KPiAt
CQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgU01VX0dGWENMSywgJm1pbiwgJm1h
eCk7DQo+ICsJCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBTTVVfR0ZYQ0xLLCAm
bWluLCAmbWF4LCBmYWxzZSk7DQo+ICAgCQlpZiAoIXJldCkgew0KPiAgIAkJCS8qIGRyaXZlciBv
bmx5IGtub3cgbWluL21heCBnZnhfY2xrLCBBZGQgbGV2ZWwgMSBmb3IgYWxsIG90aGVyIGdmeCBj
bGtzICovDQo+ICAgCQkJaWYgKGN1cl92YWx1ZSAgPT0gbWF4KQ0KPiBAQCAtMzE0LDcgKzMxNCw3
IEBAIHN0YXRpYyBpbnQgcmVub2lyX2ZvcmNlX2RwbV9saW1pdF92YWx1ZShzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSwgYm9vbCBoaWdoZXN0KQ0KPiAgIA0KPiAgIAlmb3IgKGkgPSAwOyBpIDwgQVJS
QVlfU0laRShjbGtzKTsgaSsrKSB7DQo+ICAgCQljbGtfdHlwZSA9IGNsa3NbaV07DQo+IC0JCXJl
dCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlwZSwgJm1pbl9mcmVxLCAmbWF4
X2ZyZXEpOw0KPiArCQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgY2xrX3R5cGUs
ICZtaW5fZnJlcSwgJm1heF9mcmVxLCBmYWxzZSk7DQo+ICAgCQlpZiAocmV0KQ0KPiAgIAkJCXJl
dHVybiByZXQ7DQo+ICAgDQo+IEBAIC0zNDgsNyArMzQ4LDcgQEAgc3RhdGljIGludCByZW5vaXJf
dW5mb3JjZV9kcG1fbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KSB7DQo+ICAgDQo+ICAg
CQljbGtfdHlwZSA9IGNsa19mZWF0dXJlX21hcFtpXS5jbGtfdHlwZTsNCj4gICANCj4gLQkJcmV0
ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCAmbWluX2ZyZXEsICZtYXhf
ZnJlcSk7DQo+ICsJCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlwZSwg
Jm1pbl9mcmVxLCAmbWF4X2ZyZXEsIGZhbHNlKTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJcmV0
dXJuIHJldDsNCj4gICANCj4gQEAgLTQzNSw3ICs0MzUsNyBAQCBzdGF0aWMgaW50IHJlbm9pcl9m
b3JjZV9jbGtfbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiAgIAkJCXJldHVybiAt
RUlOVkFMOw0KPiAgIAkJfQ0KPiAgIA0KPiAtCQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3Jhbmdl
KHNtdSwgU01VX0dGWENMSywgJm1pbl9mcmVxLCAmbWF4X2ZyZXEpOw0KPiArCQlyZXQgPSBzbXVf
Z2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgU01VX0dGWENMSywgJm1pbl9mcmVxLCAmbWF4X2ZyZXEs
IGZhbHNlKTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJcmV0dXJuIHJldDsNCj4gICAJCXJldCA9
IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfU2V0U29mdE1heEdmeENs
aywNCj4gQEAgLTUxMSw3ICs1MTEsNyBAQCBzdGF0aWMgaW50IHJlbm9pcl9zZXRfcGVha19jbG9j
a19ieV9kZXZpY2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpDQo+ICAgCWludCByZXQgPSAwOw0K
PiAgIAl1aW50MzJfdCBzY2xrX2ZyZXEgPSAwLCB1Y2xrX2ZyZXEgPSAwOw0KPiAgIA0KPiAtCXJl
dCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBTTVVfU0NMSywgTlVMTCwgJnNjbGtfZnJl
cSk7DQo+ICsJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9TQ0xLLCBOVUxM
LCAmc2Nsa19mcmVxLCBmYWxzZSk7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0K
PiAgIA0KPiBAQCAtNTE5LDcgKzUxOSw3IEBAIHN0YXRpYyBpbnQgcmVub2lyX3NldF9wZWFrX2Ns
b2NrX2J5X2RldmljZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4gICAJaWYgKHJldCkNCj4g
ICAJCXJldHVybiByZXQ7DQo+ICAgDQo+IC0JcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShz
bXUsIFNNVV9VQ0xLLCBOVUxMLCAmdWNsa19mcmVxKTsNCj4gKwlyZXQgPSBzbXVfZ2V0X2RwbV9m
cmVxX3JhbmdlKHNtdSwgU01VX1VDTEssIE5VTEwsICZ1Y2xrX2ZyZXEsIGZhbHNlKTsNCj4gICAJ
aWYgKHJldCkNCj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL3Bvd2VycGxheS9zbXVfdjExXzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
cG93ZXJwbGF5L3NtdV92MTFfMC5jDQo+IGluZGV4IGI2OGNiOGJhZGM3NS4uYTE1NzZhNDgyOGQx
IDEwMDY0NA0KPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9zbXVfdjExXzAu
Yw0KPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9zbXVfdjExXzAuYw0KPiBA
QCAtODA5LDggKzgwOSwxMSBAQCBzdGF0aWMgaW50IHNtdV92MTFfMF9zZXRfbWluX2RjZWZfZGVl
cF9zbGVlcChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4gICAJaWYgKCF0YWJsZV9jb250ZXh0
KQ0KPiAgIAkJcmV0dXJuIC1FSU5WQUw7DQo+ICAgDQo+IC0JcmV0dXJuIHNtdV9zZXRfZGVlcF9z
bGVlcF9kY2VmY2xrKHNtdSwNCj4gLQkJCQkJICB0YWJsZV9jb250ZXh0LT5ib290X3ZhbHVlcy5k
Y2VmY2xrIC8gMTAwKTsNCj4gKwlpZiAoc211LT5mdW5jcy0+c2V0X2RlZXBfc2xlZXBfZGNlZmNs
aykNCj4gKwkJcmV0dXJuIHNtdS0+ZnVuY3MtPnNldF9kZWVwX3NsZWVwX2RjZWZjbGsoc211LA0K
PiArCQkJCXRhYmxlX2NvbnRleHQtPmJvb3RfdmFsdWVzLmRjZWZjbGsgLyAxMDApOw0KPiArDQo+
ICsJcmV0dXJuIDA7DQo+ICAgfQ0KPiAgIA0KPiAgIHN0YXRpYyBpbnQgc211X3YxMV8wX3NldF90
b29sX3RhYmxlX2xvY2F0aW9uKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvdmVnYTIwX3BwdC5jIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9wb3dlcnBsYXkvdmVnYTIwX3BwdC5jDQo+IGluZGV4IGE3NmZmZDU4NDA0ZS4u
M2VmOTk2MzcxOGM4IDEwMDY0NA0KPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxh
eS92ZWdhMjBfcHB0LmMNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvdmVn
YTIwX3BwdC5jDQo+IEBAIC0yNTkzLDcgKzI1OTMsOCBAQCBzdGF0aWMgaW50IHZlZ2EyMF9zZXRf
b2RfcGVyY2VudGFnZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJfQ0KPiAgIA0KPiAg
IAlyZXQgPSBzbXVfaGFuZGxlX3Rhc2soc211LCBzbXVfZHBtLT5kcG1fbGV2ZWwsDQo+IC0JCQkg
ICAgICBBTURfUFBfVEFTS19SRUFESlVTVF9QT1dFUl9TVEFURSk7DQo+ICsJCQkgICAgICBBTURf
UFBfVEFTS19SRUFESlVTVF9QT1dFUl9TVEFURSwNCj4gKwkJCSAgICAgIGZhbHNlKTsNCj4gICAN
Cj4gICBzZXRfb2RfZmFpbGVkOg0KPiAgIAltdXRleF91bmxvY2soJihzbXUtPm11dGV4KSk7DQo+
IEBAIC0yODI0LDcgKzI4MjUsOCBAQCBzdGF0aWMgaW50IHZlZ2EyMF9vZG5fZWRpdF9kcG1fdGFi
bGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCWlmICh0eXBlID09IFBQX09EX0NPTU1J
VF9EUE1fVEFCTEUpIHsNCj4gICAJCW11dGV4X2xvY2soJihzbXUtPm11dGV4KSk7DQo+ICAgCQly
ZXQgPSBzbXVfaGFuZGxlX3Rhc2soc211LCBzbXVfZHBtLT5kcG1fbGV2ZWwsDQo+IC0JCQkJICAg
ICAgQU1EX1BQX1RBU0tfUkVBREpVU1RfUE9XRVJfU1RBVEUpOw0KPiArCQkJCSAgICAgIEFNRF9Q
UF9UQVNLX1JFQURKVVNUX1BPV0VSX1NUQVRFLA0KPiArCQkJCSAgICAgIGZhbHNlKTsNCj4gICAJ
CW11dGV4X3VubG9jaygmKHNtdS0+bXV0ZXgpKTsNCj4gICAJfQ0KPiAgIA0KX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5nIGxpc3QK
YW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
