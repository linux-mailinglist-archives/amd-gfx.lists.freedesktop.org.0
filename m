Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 0FA9E676B3
	for <lists+amd-gfx@lfdr.de>; Sat, 13 Jul 2019 01:08:24 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E85886E392;
	Fri, 12 Jul 2019 23:08:21 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM02-BL2-obe.outbound.protection.outlook.com
 (mail-eopbgr750041.outbound.protection.outlook.com [40.107.75.41])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C6D3D6E392
 for <amd-gfx@lists.freedesktop.org>; Fri, 12 Jul 2019 23:08:19 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=jEzunIZoa7tvrzAPhQ8Rha8ZMJAgKVQ8E3MtPMT2f+MjG9jrXvEidnnDKcDj7UQK2IMFYAzjISBAOu/QCwldfm6+wUhrJsB1pOlAsI7rd4cAFptHgyAWDexQr9XN7ZKe8NKCYKzARtWPGlDVh8CMbYQpCNhNP/nxks1ND9g5BJ1grdPu8skR660CZHCMJNp5OZtQKd4WjOOpBYK5IfcQXwinDF3yxSIHGQO9HnUdUElcew4sYgSV2jpK7z9iRTupyieJyVraRJUQnIpHBwKxV3qOcOSBoHaD52CdDgoGTvf+jbuPvCFE+Kh+BgiFvD41Rtp1W6CE/aHfUBO0Vb4URw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=FY9SigdCVMdwfyl5tvKzeyt5ShKy3VwZd6h2IIrDAn4=;
 b=TYcR0wwNiDG767j4MwjW3xYPBcdnnhNvu2DUPgnXVH+oeIIaJtciZpXKS754Pb18VZqStrfRh+jhTDVzYzJmMteXijt7RFk6ha7PJkqIDGQmLaZhrFcMe+hDNmrmLC3lhyswYBQqRVZBGCph2JISSrHqStErL0Nbye4UoGRbEdS2fF/caowjUTdIcw6z2isMTXU97615mLbUqmsIzkn1P33QwCo0XJJaijmoxsVoTOYG2LMpy+Ed9JwZ+WcDqqQKk8S1mEAFyNqPzB4thRnswVO2VEr4NnRkLF0G/N6RGkq2SMijm4Y/4VJ+D1X53zjMphXVsN9KYoHBHdAwRvy2zA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1;spf=pass
 smtp.mailfrom=amd.com;dmarc=pass action=none header.from=amd.com;dkim=pass
 header.d=amd.com;arc=none
Received: from DM6PR12MB3947.namprd12.prod.outlook.com (10.255.174.156) by
 DM6PR12MB3052.namprd12.prod.outlook.com (20.178.30.94) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2073.10; Fri, 12 Jul 2019 23:08:17 +0000
Received: from DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::91a2:f9e7:8c86:f927]) by DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::91a2:f9e7:8c86:f927%7]) with mapi id 15.20.2073.012; Fri, 12 Jul 2019
 23:08:17 +0000
From: "Kuehling, Felix" <Felix.Kuehling@amd.com>
To: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 1/1] drm/amdgpu: Dump PDEs and PTEs on VM faults (v2)
Thread-Topic: [PATCH 1/1] drm/amdgpu: Dump PDEs and PTEs on VM faults (v2)
Thread-Index: AQHVOQaw+H3Q11mw6k+5gejvAVw0pA==
Date: Fri, 12 Jul 2019 23:08:17 +0000
Message-ID: <20190712230756.5518-1-Felix.Kuehling@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [165.204.55.251]
x-mailer: git-send-email 2.17.1
x-clientproxiedby: YT1PR01CA0019.CANPRD01.PROD.OUTLOOK.COM (2603:10b6:b01::32)
 To DM6PR12MB3947.namprd12.prod.outlook.com
 (2603:10b6:5:1cb::28)
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 0b4dec45-2959-4058-0efe-08d7071dd2ff
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);
 SRVR:DM6PR12MB3052; 
x-ms-traffictypediagnostic: DM6PR12MB3052:
x-microsoft-antispam-prvs: <DM6PR12MB305210DF67DFBEA322FBB5C692F20@DM6PR12MB3052.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:284;
x-forefront-prvs: 00963989E5
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(396003)(39860400002)(136003)(346002)(376002)(366004)(189003)(199004)(8676002)(26005)(53936002)(102836004)(6486002)(6436002)(3846002)(66556008)(6512007)(6116002)(1076003)(6506007)(386003)(64756008)(66446008)(66946007)(476003)(2616005)(71190400001)(71200400001)(36756003)(256004)(14444005)(66476007)(99286004)(52116002)(2501003)(66066001)(14454004)(5640700003)(2906002)(68736007)(86362001)(81166006)(5660300002)(186003)(8936002)(81156014)(478600001)(316002)(486006)(6916009)(7736002)(305945005)(50226002)(2351001)(25786009);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM6PR12MB3052;
 H:DM6PR12MB3947.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: m+jTM5tTlbsX2t7N2ZBSoQXRxv22WCK4bcMyrBDoxLme69c4A2C58g6YcU39936LfnRz1xOVrthulwxt4NFmfF+HL5hvJxe92qDpyrWuiWUnmk5l5JjxHdPiz4xm8ZBH0ce0NStBHYf86+yh3qODAMejpEODQxXXujW3/1FmM0CwWGW2mUjbzoWK3+bVxEil226lQpnl+I2ctiHDkG6MuOeTjU7xjD7WdJxnOdgHjJXz0bmva6Psg2uRd47wzax4EZD/UgAlYU7ahnmVHs8O0XPbJ3tTHIy1k28kzYolu8P6VwkUeOm4pMoeth6rif51645GzBpg+/IXMCajOZ85FEBUNK+hDmxi6MELT+hWxwiSv2EhNSqFnZuE62rBx67bLChNrhkAJPSKnnVDTTB8pqsMy4THV7KW3KtFdsGGRUI=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 0b4dec45-2959-4058-0efe-08d7071dd2ff
X-MS-Exchange-CrossTenant-originalarrivaltime: 12 Jul 2019 23:08:17.3200 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: fkuehlin@amd.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB3052
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=FY9SigdCVMdwfyl5tvKzeyt5ShKy3VwZd6h2IIrDAn4=;
 b=v6vEn+T6TsOzn0BJrm6AyWQ8k1PlW2LBfR9FXcXHZhcooTy5Zkh8q6BH3ll/bjPw1GyzJvuYM4Sb++GxeNtBNc7Z6QmXqr+JADWUJ79fps7bzmF5r2LuZoItKsRdL0HTyRRJOgGL7FvxyET9k3tSPOH9dr904iJZy7Mfm+haLhk=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Felix.Kuehling@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

V2FsayBwYWdlIHRhYmxlIGZvciB0aGUgZmF1bHRpbmcgYWRkcmVzcyBhbmQgZHVtcCBQREVzIGFu
ZCBQVEVzIGF0CmFsbCBsZXZlbHMuIEFsc28gZmxhZyBkaXNjcmVwYW5jaWVzIHdoZXJlIGEgUERF
IHBvaW50cyB0byBhIGRpZmZlcmVudAphZGRyZXNzIHRoYW4gdGhlIG5leHQgbGV2ZWwgUERCIG9y
IFBUQiBCTy4KCnYyOgoqIEZpeCBhZGRyZXNzIHNoaWZ0IGZvciBHRlh2OAoqIFJlZG8gUERCL1BU
QiBhZGRyZXNzIGNoZWNraW5nIHRvIHdvcmsgb24gYWxsIGdlbmVyYXRpb25zCgpTaWduZWQtb2Zm
LWJ5OiBGZWxpeCBLdWVobGluZyA8RmVsaXguS3VlaGxpbmdAYW1kLmNvbT4KLS0tCiBkcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMgfCAgNSArLQogZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5oIHwgIDIgKwogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3ZtLmMgIHwgODcgKysrKysrKysrKysrKysrKysrKysrKysrLQogZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmggIHwgIDcgKy0KIGRyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2dtY192OF8wLmMgICB8ICA2ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9nbWNfdjlfMC5jICAgfCAgNSArLQogNiBmaWxlcyBjaGFuZ2VkLCAxMDMgaW5zZXJ0aW9ucygr
KSwgOSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfdHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMK
aW5kZXggYmJiZjA2OWVmYjc3Li43ODQ0MDc0OGM4N2YgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfdHRtLmMKQEAgLTE1MDUsOSArMTUwNSw4IEBAIHN0YXRpYyBib29sIGFtZGdw
dV90dG1fYm9fZXZpY3Rpb25fdmFsdWFibGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywK
ICAqIFRoaXMgaXMgdXNlZCB0byBhY2Nlc3MgVlJBTSB0aGF0IGJhY2tzIGEgYnVmZmVyIG9iamVj
dCB2aWEgTU1JTwogICogYWNjZXNzIGZvciBkZWJ1Z2dpbmcgcHVycG9zZXMuCiAgKi8KLXN0YXRp
YyBpbnQgYW1kZ3B1X3R0bV9hY2Nlc3NfbWVtb3J5KHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sCi0JCQkJICAgIHVuc2lnbmVkIGxvbmcgb2Zmc2V0LAotCQkJCSAgICB2b2lkICpidWYsIGlu
dCBsZW4sIGludCB3cml0ZSkKK2ludCBhbWRncHVfdHRtX2FjY2Vzc19tZW1vcnkoc3RydWN0IHR0
bV9idWZmZXJfb2JqZWN0ICpibywgdW5zaWduZWQgbG9uZyBvZmZzZXQsCisJCQkgICAgIHZvaWQg
KmJ1ZiwgaW50IGxlbiwgaW50IHdyaXRlKQogewogCXN0cnVjdCBhbWRncHVfYm8gKmFibyA9IHR0
bV90b19hbWRncHVfYm8oYm8pOwogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gYW1kZ3B1
X3R0bV9hZGV2KGFiby0+dGJvLmJkZXYpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3R0bS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3R0bS5oCmluZGV4IGJjY2I4YzQ5ZTU5Ny4uY2ZmYmFmZmZhOWQ3IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5oCkBAIC04Myw2ICs4Myw4IEBAIHZvaWQgYW1kZ3B1X3R0
bV9maW5pKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KTsKIHZvaWQgYW1kZ3B1X3R0bV9zZXRf
YnVmZmVyX2Z1bmNzX3N0YXR1cyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCQkJYm9v
bCBlbmFibGUpOwogCitpbnQgYW1kZ3B1X3R0bV9hY2Nlc3NfbWVtb3J5KHN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqYm8sIHVuc2lnbmVkIGxvbmcgb2Zmc2V0LAorCQkJICAgICB2b2lkICpidWYs
IGludCBsZW4sIGludCB3cml0ZSk7CiBpbnQgYW1kZ3B1X2NvcHlfYnVmZmVyKHN0cnVjdCBhbWRn
cHVfcmluZyAqcmluZywgdWludDY0X3Qgc3JjX29mZnNldCwKIAkJICAgICAgIHVpbnQ2NF90IGRz
dF9vZmZzZXQsIHVpbnQzMl90IGJ5dGVfY291bnQsCiAJCSAgICAgICBzdHJ1Y3QgcmVzZXJ2YXRp
b25fb2JqZWN0ICpyZXN2LApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3ZtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYwppbmRl
eCAxOTUxZjJhYmJkYmMuLjM4YTJmNjZjZjA5NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3ZtLmMKQEAgLTU0NCw2ICs1NDQsODYgQEAgc3RhdGljIHZvaWQgYW1kZ3B1X3ZtX3B0
X25leHRfZGZzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCSAgICAgYW1kZ3B1X3ZtX3B0
X2NvbnRpbnVlX2Rmcygoc3RhcnQpLCAoZW50cnkpKTsJCQlcCiAJICAgICAoZW50cnkpID0gKGN1
cnNvcikuZW50cnksIGFtZGdwdV92bV9wdF9uZXh0X2RmcygoYWRldiksICYoY3Vyc29yKSkpCiAK
Ky8qKgorICogYW1kZ3B1X3ZtX2R1bXBfcHRlIC0gZHVtcCBQVEVzIGFsb25nIGEgcGFnZSB0YWJs
ZSB3YWxrCisgKgorICogQGFkZXY6IGFtZGdwdSBkZXZpY2UgcG9pbnRlcgorICogQHZtOiBWTSBh
ZGRyZXNzIHNwYWNlCisgKiBAYWRkcjogdmlydHVhbCBhZGRyZXNzCisgKgorICogV2Fsa3MgdGhl
IHBhZ2UgdGFibGUgb2YgQHZtIGF0IHRoZSBnaXZlbiBAYWRkciBhbmQgcHJpbnRzIHRoZSBQREVz
CisgKiBhbmQgUFRFcyBhbG9uZyB0aGUgd2F5IG9uIGEgc2luZ2xlIGxpbmUuCisgKi8KK3ZvaWQg
YW1kZ3B1X3ZtX2R1bXBfcHRlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgYW1k
Z3B1X3ZtICp2bSwKKwkJCXVpbnQ2NF90IGFkZHIpCit7CisJc3RhdGljIGNvbnN0IGNoYXIgKmxl
dmVsX2VudHJ5WzRdID0geyJQREUyIiwgIlBERTEiLCAiUERFMCIsICJQVEUifTsKKwlzdGF0aWMg
Y29uc3QgY2hhciAqbGV2ZWxfYmxvY2tbNF0gPSB7IlBEQjIiLCAiUERCMSIsICJQREIwIiwgIlBU
QiJ9OworCXN0cnVjdCBhbWRncHVfdm1fcHRfY3Vyc29yIGN1cnNvcjsKKwl1aW50NjRfdCBsYXN0
X3BkZTsKKwljaGFyIGJ1ZlsxMjhdOworCWludCBpID0gMDsKKworCXsKKwkJdWludDY0X3QgbGFz
dF9mbGFncyA9IEFNREdQVV9QVEVfVkFMSUQ7CisJCXVpbnQ2NF90IGxhc3RfYWRkciA9IHZtLT5y
b290LmJhc2UuYm8tPnRiby5vZmZzZXQ7CisKKwkJYW1kZ3B1X2dtY19nZXRfdm1fcGRlKGFkZXYs
IGFkZXYtPnZtX21hbmFnZXIucm9vdF9sZXZlbCwKKwkJCQkgICAgICAmbGFzdF9hZGRyLCAmbGFz
dF9mbGFncyk7CisJCWxhc3RfcGRlID0gbGFzdF9hZGRyIHwgbGFzdF9mbGFnczsKKwl9CisKKwlh
bWRncHVfdm1fcHRfc3RhcnQoYWRldiwgdm0sIGFkZHIgPj4gUEFHRV9TSElGVCwgJmN1cnNvcik7
CisKKwlkbyB7CisJCXVuc2lnbmVkIGludCBtYXNrLCBzaGlmdCwgaWR4OworCQlzdHJ1Y3QgYW1k
Z3B1X2JvICpibzsKKwkJdWludDY0X3QgcHRlOworCisJCW1hc2sgPSBhbWRncHVfdm1fZW50cmll
c19tYXNrKGFkZXYsIGN1cnNvci5sZXZlbCk7CisJCXNoaWZ0ID0gYW1kZ3B1X3ZtX2xldmVsX3No
aWZ0KGFkZXYsIGN1cnNvci5sZXZlbCk7CisJCWlkeCA9IChjdXJzb3IucGZuID4+IHNoaWZ0KSAm
IG1hc2s7CisKKwkJYm8gPSBjdXJzb3IuZW50cnktPmJhc2UuYm87CisJCWlmIChibykgeworCQkJ
dWludDY0X3QgdGhpc19mbGFncyA9IEFNREdQVV9QVEVfVkFMSUQ7CisJCQl1aW50NjRfdCB0aGlz
X2FkZHIgPSBiby0+dGJvLm9mZnNldDsKKworCQkJLyogRmxhZyBkaXNjcmVwYW5jeSBiZXR3ZWVu
IHByZXZpb3VzIGxldmVsIFBERQorCQkJICogYW5kIHRoZSBhY3R1YWwgYWRkcmVzcyBvZiB0aGlz
IFBUQiBvciBQREIuCisJCQkgKi8KKwkJCWFtZGdwdV9nbWNfZ2V0X3ZtX3BkZShhZGV2LCBjdXJz
b3IubGV2ZWwsCisJCQkJCSAgICAgICZ0aGlzX2FkZHIsICZ0aGlzX2ZsYWdzKTsKKwkJCWlmICgo
dGhpc19hZGRyIHwgdGhpc19mbGFncykgIT0gbGFzdF9wZGUpCisJCQkJaSArPSBzbnByaW50Zihi
dWYgKyBpLCBzaXplb2YoYnVmKSAtIGksICIhIik7CisKKwkJCWFtZGdwdV90dG1fYWNjZXNzX21l
bW9yeSgmYm8tPnRibywgaWR4ICogc2l6ZW9mKHB0ZSksCisJCQkJCQkgJnB0ZSwgc2l6ZW9mKHB0
ZSksIGZhbHNlKTsKKwkJCWkgKz0gc25wcmludGYoYnVmICsgaSwgc2l6ZW9mKGJ1ZikgLSBpLAor
CQkJCSAgICAgICIlc1slZF09MHglbGx4ICIsCisJCQkJICAgICAgbGV2ZWxfZW50cnlbY3Vyc29y
LmxldmVsXSwgaWR4LCBwdGUpOworCQkJbGFzdF9wZGUgPSBwdGU7CisJCX0gZWxzZSB7CisJCQkv
KiBGbGFnIGRpc2NyZXBhbmN5IGlmIHByZXZpb3VzIGxldmVsIFBERSBoYWQKKwkJCSAqIGEgdmFs
aWQgZW50cnkgYnV0IHRoZXJlIGlzIG5vIFBUQiBvciBQREIgQk8uCisJCQkgKi8KKwkJCWlmICgo
bGFzdF9wZGUgJiBBTURHUFVfUFRFX1ZBTElEKSAmJgorCQkJICAgICEobGFzdF9wZGUgJiBBTURH
UFVfUERFX1BURSkpCisJCQkJaSArPSBzbnByaW50ZihidWYgKyBpLCBzaXplb2YoYnVmKSAtIGks
ICIhIik7CisJCQlpICs9IHNucHJpbnRmKGJ1ZiArIGksIHNpemVvZihidWYpIC0gaSwKKwkJCQkg
ICAgICAibm8gJXMgIiwgbGV2ZWxfYmxvY2tbY3Vyc29yLmxldmVsXSk7CisJCQlsYXN0X3BkZSA9
IDA7CisJCX0KKworCQkrK2N1cnNvci5sZXZlbDsKKwkJY3Vyc29yLnBhcmVudCA9IGN1cnNvci5l
bnRyeTsKKwkJaWYgKCFjdXJzb3IuZW50cnktPmVudHJpZXMpCisJCQlicmVhazsKKwkJY3Vyc29y
LmVudHJ5ID0gJmN1cnNvci5lbnRyeS0+ZW50cmllc1tpZHhdOworCX0gd2hpbGUgKGN1cnNvci5l
bnRyeSk7CisJZGV2X2VycihhZGV2LT5kZXYsICIlcyIsIGJ1Zik7Cit9CisKIC8qKgogICogYW1k
Z3B1X3ZtX2dldF9wZF9ibyAtIGFkZCB0aGUgVk0gUEQgdG8gYSB2YWxpZGF0aW9uIGxpc3QKICAq
CkBAIC0zMDgxLDggKzMxNjEsOSBAQCBpbnQgYW1kZ3B1X3ZtX2lvY3RsKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIHZvaWQgKmRhdGEsIHN0cnVjdCBkcm1fZmlsZSAqZmlscCkKICAqIEBwYXNpZDog
UEFTSUQgaWRlbnRpZmllciBmb3IgVk0KICAqIEB0YXNrX2luZm86IHRhc2tfaW5mbyB0byBmaWxs
LgogICovCi12b2lkIGFtZGdwdV92bV9nZXRfdGFza19pbmZvKHN0cnVjdCBhbWRncHVfZGV2aWNl
ICphZGV2LCB1bnNpZ25lZCBpbnQgcGFzaWQsCi0JCQkgc3RydWN0IGFtZGdwdV90YXNrX2luZm8g
KnRhc2tfaW5mbykKK3N0cnVjdCBhbWRncHVfdm0gKmFtZGdwdV92bV9nZXRfdGFza19pbmZvKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAorCQkJCQkgIHVuc2lnbmVkIGludCBwYXNpZCwKKwkJ
CQkJICBzdHJ1Y3QgYW1kZ3B1X3Rhc2tfaW5mbyAqdGFza19pbmZvKQogewogCXN0cnVjdCBhbWRn
cHVfdm0gKnZtOwogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CkBAIC0zMDk0LDYgKzMxNzUsOCBAQCB2
b2lkIGFtZGdwdV92bV9nZXRfdGFza19pbmZvKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1
bnNpZ25lZCBpbnQgcGFzaWQsCiAJCSp0YXNrX2luZm8gPSB2bS0+dGFza19pbmZvOwogCiAJc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmYWRldi0+dm1fbWFuYWdlci5wYXNpZF9sb2NrLCBmbGFncyk7
CisKKwlyZXR1cm4gdm07CiB9CiAKIC8qKgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3ZtLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
dm0uaAppbmRleCA0ODlhMTYyY2E2MjAuLjZhOGI4MzNkMTgwZSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3ZtLmgKQEAgLTM0OCw2ICszNDgsOCBAQCBpbnQgYW1kZ3B1X3ZtX2lu
aXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtLAogaW50
IGFtZGdwdV92bV9tYWtlX2NvbXB1dGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHN0cnVj
dCBhbWRncHVfdm0gKnZtLCB1bnNpZ25lZCBpbnQgcGFzaWQpOwogdm9pZCBhbWRncHVfdm1fcmVs
ZWFzZV9jb21wdXRlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgYW1kZ3B1X3Zt
ICp2bSk7CiB2b2lkIGFtZGdwdV92bV9maW5pKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBz
dHJ1Y3QgYW1kZ3B1X3ZtICp2bSk7Cit2b2lkIGFtZGdwdV92bV9kdW1wX3B0ZShzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiwgc3RydWN0IGFtZGdwdV92bSAqdm0sCisJCQl1aW50NjRfdCBhZGRy
KTsKIHZvaWQgYW1kZ3B1X3ZtX2dldF9wZF9ibyhzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwKIAkJCSBz
dHJ1Y3QgbGlzdF9oZWFkICp2YWxpZGF0ZWQsCiAJCQkgc3RydWN0IGFtZGdwdV9ib19saXN0X2Vu
dHJ5ICplbnRyeSk7CkBAIC00MDEsOCArNDAzLDkgQEAgYm9vbCBhbWRncHVfdm1fbmVlZF9waXBl
bGluZV9zeW5jKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZywKIAkJCQkgIHN0cnVjdCBhbWRncHVf
am9iICpqb2IpOwogdm9pZCBhbWRncHVfdm1fY2hlY2tfY29tcHV0ZV9idWcoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYpOwogCi12b2lkIGFtZGdwdV92bV9nZXRfdGFza19pbmZvKHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2LCB1bnNpZ25lZCBpbnQgcGFzaWQsCi0JCQkgICAgIHN0cnVjdCBh
bWRncHVfdGFza19pbmZvICp0YXNrX2luZm8pOworc3RydWN0IGFtZGdwdV92bSAqYW1kZ3B1X3Zt
X2dldF90YXNrX2luZm8oc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCisJCQkJCSAgdW5zaWdu
ZWQgaW50IHBhc2lkLAorCQkJCQkgIHN0cnVjdCBhbWRncHVfdGFza19pbmZvICp0YXNrX2luZm8p
OwogCiB2b2lkIGFtZGdwdV92bV9zZXRfdGFza19pbmZvKHN0cnVjdCBhbWRncHVfdm0gKnZtKTsK
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y4XzAuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OF8wLmMKaW5kZXggOGJmMmJhMzEwZmQ5Li4x
ODIwN2VjZmQ4NWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192
OF8wLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y4XzAuYwpAQCAtMTQ0
OCw5ICsxNDQ4LDEwIEBAIHN0YXRpYyBpbnQgZ21jX3Y4XzBfcHJvY2Vzc19pbnRlcnJ1cHQoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAKIAlpZiAocHJpbnRrX3JhdGVsaW1pdCgpKSB7CiAJ
CXN0cnVjdCBhbWRncHVfdGFza19pbmZvIHRhc2tfaW5mbzsKKwkJc3RydWN0IGFtZGdwdV92bSAq
dm07CiAKIAkJbWVtc2V0KCZ0YXNrX2luZm8sIDAsIHNpemVvZihzdHJ1Y3QgYW1kZ3B1X3Rhc2tf
aW5mbykpOwotCQlhbWRncHVfdm1fZ2V0X3Rhc2tfaW5mbyhhZGV2LCBlbnRyeS0+cGFzaWQsICZ0
YXNrX2luZm8pOworCQl2bSA9IGFtZGdwdV92bV9nZXRfdGFza19pbmZvKGFkZXYsIGVudHJ5LT5w
YXNpZCwgJnRhc2tfaW5mbyk7CiAKIAkJZGV2X2VycihhZGV2LT5kZXYsICJHUFUgZmF1bHQgZGV0
ZWN0ZWQ6ICVkIDB4JTA4eCBmb3IgcHJvY2VzcyAlcyBwaWQgJWQgdGhyZWFkICVzIHBpZCAlZFxu
IiwKIAkJCWVudHJ5LT5zcmNfaWQsIGVudHJ5LT5zcmNfZGF0YVswXSwgdGFza19pbmZvLnByb2Nl
c3NfbmFtZSwKQEAgLTE0NjEsNiArMTQ2Miw5IEBAIHN0YXRpYyBpbnQgZ21jX3Y4XzBfcHJvY2Vz
c19pbnRlcnJ1cHQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJCQlzdGF0dXMpOwogCQln
bWNfdjhfMF92bV9kZWNvZGVfZmF1bHQoYWRldiwgc3RhdHVzLCBhZGRyLCBtY19jbGllbnQsCiAJ
CQkJCSBlbnRyeS0+cGFzaWQpOworCQlpZiAodm0pCisJCQlhbWRncHVfdm1fZHVtcF9wdGUoYWRl
diwgdm0sICh1aW50NjRfdClhZGRyCisJCQkJCSAgIDw8IEFNREdQVV9HUFVfUEFHRV9TSElGVCk7
CiAJfQogCiAJdm1pZCA9IFJFR19HRVRfRklFTEQoc3RhdHVzLCBWTV9DT05URVhUMV9QUk9URUNU
SU9OX0ZBVUxUX1NUQVRVUywKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2dtY192OV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjlfMC5jCmluZGV4
IGJkNWQzNjk0NDQ4MS4uZjI3ZTg4YWY0MDE2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9nbWNfdjlfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dt
Y192OV8wLmMKQEAgLTMzMSw5ICszMzEsMTAgQEAgc3RhdGljIGludCBnbWNfdjlfMF9wcm9jZXNz
X2ludGVycnVwdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAogCWlmIChwcmludGtfcmF0
ZWxpbWl0KCkpIHsKIAkJc3RydWN0IGFtZGdwdV90YXNrX2luZm8gdGFza19pbmZvOworCQlzdHJ1
Y3QgYW1kZ3B1X3ZtICp2bTsKIAogCQltZW1zZXQoJnRhc2tfaW5mbywgMCwgc2l6ZW9mKHN0cnVj
dCBhbWRncHVfdGFza19pbmZvKSk7Ci0JCWFtZGdwdV92bV9nZXRfdGFza19pbmZvKGFkZXYsIGVu
dHJ5LT5wYXNpZCwgJnRhc2tfaW5mbyk7CisJCXZtID0gYW1kZ3B1X3ZtX2dldF90YXNrX2luZm8o
YWRldiwgZW50cnktPnBhc2lkLCAmdGFza19pbmZvKTsKIAogCQlkZXZfZXJyKGFkZXYtPmRldiwK
IAkJCSJbJXNdICVzIHBhZ2UgZmF1bHQgKHNyY19pZDoldSByaW5nOiV1IHZtaWQ6JXUgIgpAQCAt
MzQ5LDYgKzM1MCw4IEBAIHN0YXRpYyBpbnQgZ21jX3Y5XzBfcHJvY2Vzc19pbnRlcnJ1cHQoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJCQlkZXZfZXJyKGFkZXYtPmRldiwKIAkJCQkiVk1f
TDJfUFJPVEVDVElPTl9GQVVMVF9TVEFUVVM6MHglMDhYXG4iLAogCQkJCXN0YXR1cyk7CisJCWlm
ICh2bSkKKwkJCWFtZGdwdV92bV9kdW1wX3B0ZShhZGV2LCB2bSwgYWRkcik7CiAJfQogCiAJcmV0
dXJuIDA7Ci0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdm
eA==
