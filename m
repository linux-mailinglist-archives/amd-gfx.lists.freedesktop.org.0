Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B720C2BADD
	for <lists+amd-gfx@lfdr.de>; Mon, 27 May 2019 21:52:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 53B0C89A1E;
	Mon, 27 May 2019 19:52:04 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM02-CY1-obe.outbound.protection.outlook.com
 (mail-eopbgr760045.outbound.protection.outlook.com [40.107.76.45])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0542789A1E
 for <amd-gfx@lists.freedesktop.org>; Mon, 27 May 2019 19:52:02 +0000 (UTC)
Received: from DM3PR12CA0110.namprd12.prod.outlook.com (2603:10b6:0:55::30) by
 CY4PR1201MB0056.namprd12.prod.outlook.com (2603:10b6:910:1c::16) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.1922.18; Mon, 27 May
 2019 19:52:00 +0000
Received: from CO1NAM03FT006.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e48::203) by DM3PR12CA0110.outlook.office365.com
 (2603:10b6:0:55::30) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.1922.15 via Frontend
 Transport; Mon, 27 May 2019 19:52:00 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV02.amd.com (165.204.84.17) by
 CO1NAM03FT006.mail.protection.outlook.com (10.152.80.75) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.1922.16 via Frontend Transport; Mon, 27 May 2019 19:51:59 +0000
Received: from leodev.amd.com (10.180.168.240) by SATLEXCHOV02.amd.com
 (10.181.40.72) with Microsoft SMTP Server id 14.3.389.1; Mon, 27 May 2019
 14:51:54 -0500
From: <sunpeng.li@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 08/26] drm/amd/display: Ensure DRR triggers in BP
Date: Mon, 27 May 2019 15:50:47 -0400
Message-ID: <1558986665-12964-9-git-send-email-sunpeng.li@amd.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1558986665-12964-1-git-send-email-sunpeng.li@amd.com>
References: <1558986665-12964-1-git-send-email-sunpeng.li@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(376002)(346002)(39860400002)(396003)(136003)(2980300002)(428003)(189003)(199004)(186003)(36756003)(77096007)(2616005)(426003)(476003)(446003)(11346002)(26005)(16586007)(126002)(336012)(486006)(68736007)(50226002)(305945005)(47776003)(8936002)(316002)(81166006)(8676002)(81156014)(76176011)(86362001)(2876002)(2906002)(86152003)(53416004)(5660300002)(2351001)(53936002)(50466002)(48376002)(6916009)(72206003)(51416003)(7696005)(4326008)(70586007)(30864003)(70206006)(6666004)(478600001)(356004)(14444005);
 DIR:OUT; SFP:1101; SCL:1; SRVR:CY4PR1201MB0056; H:SATLEXCHOV02.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; MX:1; A:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 2e6674ae-216a-4628-891e-08d6e2dcc83b
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328);
 SRVR:CY4PR1201MB0056; 
X-MS-TrafficTypeDiagnostic: CY4PR1201MB0056:
X-Microsoft-Antispam-PRVS: <CY4PR1201MB0056D3B6A6C901501E0D6357821D0@CY4PR1201MB0056.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:8882;
X-Forefront-PRVS: 0050CEFE70
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: +3jFiXuOtJv6C8AP8ZPPLJflY7JS9IRkx9NehNZsPHgifseI2KHbjONDhFlvPlZ2TrXpN9pjQPXW09tF9W/A1iJ5jZf6JGafXK48YKj68yv0kve0bb/B/b9xTvo9VamxohgVsWRTsUJXIT4mHmGHPuZYs5ewmYmo9P8rX5x7VR66tPrT5/pXQs4IjAboSbJoyvN9yLW1SlIT5+4qyddWY9utMx6C9agXpllJZP6SVg7wXRywa6R9VyZNiNMqjUl9zla1QNqZ831QGTsYw9iJju/eNgWlGUTv71fNlKKhboxyABzgxQOXQx8wr0pCB3TQujm3f6bgxETgYY5K7LOkJgFkahL54DolEy7JlQbzKgWeh9satPeJ9t1L7RhEmxgBvmaZLreZFKxC6XZjas6+xGbHUpir2BA2scvOQ9rnL6A=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 27 May 2019 19:51:59.7429 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 2e6674ae-216a-4628-891e-08d6e2dcc83b
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV02.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: CY4PR1201MB0056
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=TyYQyNlNwr39rMnm9YHCu2NdtINBHaowIYHXYWi89Mg=;
 b=KBZoaHW/MHHzB9MLDzF6ef458rlTYHUCJFzlbD10KD2aKwr6S4o4ZrJCQcCjv6Ix+zeJlE9mkd5LvbR2QR7bOhaPg/TDyT1YaUd2ZIZwajnc8F0NJhhX8wYSQAyEmqkldesfAVto/Y1nDj7xaBd44NM81mhz9qNc+NiktY7I3bw=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Eryk Brol <eryk.brol@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogRXJ5ayBCcm9sIDxlcnlrLmJyb2xAYW1kLmNvbT4KCltXaHldCkluIHRoZSBwcmV2aW91
cyBpbXBsZW1lbnRhdGlvbiBEUlIgZXZlbnQgc29tZXRpbWVzIGNhbWUKaW4gZHVyaW5nIEZQMiBy
ZWdpb24gd2hpY2ggaXMgYSBrZWVwLW91dCB6b25lLiBUaGlzCndvdWxkIGNhdXNlIHRoZSBmcmFt
ZSBub3QgdG8gbGF0Y2ggdW50aWwgdGhlIG5leHQgZnJhbWUKd2hpY2ggcmVzdWx0ZWQgaW4gaGVh
dnkgZmxpY2tlci4gVG8gZml4IHRoaXMgd2UgbmVlZAp0byBtYWtlIHN1cmUgdGhhdCBpdCB0cmln
Z2VycyBpbiB0aGUgQlAuCgpbSG93XQoxLiBSZW1vdmUgRFJSIHByb2dyYW1taW5nIGR1cmluZyBm
bGlwCjIuIFNldHVwIG1hbnVhbCB0cmlnZ2VyIGZvciBEUlIgZXZlbnQgYW5kIHRyaWdnZXIgaXQK
YWZ0ZXIgc3VyZmFjZSBwcm9ncmFtbWluZyBpcyBjb21wbGV0ZQoKU2lnbmVkLW9mZi1ieTogRXJ5
ayBCcm9sIDxlcnlrLmJyb2xAYW1kLmNvbT4KUmV2aWV3ZWQtYnk6IEFyaWMgQ3lyIDxBcmljLkN5
ckBhbWQuY29tPgpBY2tlZC1ieTogTGVvIExpIDxzdW5wZW5nLmxpQGFtZC5jb20+Ci0tLQogZHJp
dmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYyAgfCAyNCArKysr
KysrKysrKystLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kYy5jICAg
ICAgICAgICB8IDIzICsrKysrKysrKystLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9kY19zdHJlYW0uaCAgICAgICAgIHwgIDEgLQogLi4uL2RybS9hbWQvZGlzcGxheS9kYy9k
Y24xMC9kY24xMF9od19zZXF1ZW5jZXIuYyAgfCAgNCArLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kY24xMC9kY24xMF9vcHRjLmMgIHwgMzIgKysrKysrKysrKysrKysrKysrKysr
KwogZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX29wdGMuaCAgfCAz
MSArKysrKysrKysrKysrKysrKy0tLS0KIC4uLi9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3L3Rp
bWluZ19nZW5lcmF0b3IuaCAgIHwgIDMgKysKIDcgZmlsZXMgY2hhbmdlZCwgOTYgaW5zZXJ0aW9u
cygrKSwgMjIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9hbWRncHVfZG0vYW1kZ3B1X2RtLmMKaW5kZXggNzJlYTY4OS4uYzEwYTM5OCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbS5jCkBAIC01
MjE2LDYgKzUyMTYsMTEgQEAgc3RhdGljIHZvaWQgdXBkYXRlX2ZyZWVzeW5jX3N0YXRlX29uX3N0
cmVhbSgKIAkJICAgIGFtZGdwdV9kbV92cnJfYWN0aXZlKG5ld19jcnRjX3N0YXRlKSkgewogCQkJ
bW9kX2ZyZWVzeW5jX2hhbmRsZV92X3VwZGF0ZShkbS0+ZnJlZXN5bmNfbW9kdWxlLAogCQkJCQkJ
ICAgICBuZXdfc3RyZWFtLCAmdnJyX3BhcmFtcyk7CisKKwkJCS8qIE5lZWQgdG8gY2FsbCB0aGlz
IGJlZm9yZSB0aGUgZnJhbWUgZW5kcy4gKi8KKwkJCWRjX3N0cmVhbV9hZGp1c3Rfdm1pbl92bWF4
KGRtLT5kYywKKwkJCQkJCSAgIG5ld19jcnRjX3N0YXRlLT5zdHJlYW0sCisJCQkJCQkgICAmdnJy
X3BhcmFtcy5hZGp1c3QpOwogCQl9CiAJfQogCkBAIC01NTU0LDExICs1NTU5LDYgQEAgc3RhdGlj
IHZvaWQgYW1kZ3B1X2RtX2NvbW1pdF9wbGFuZXMoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0
YXRlLAogCQl9CiAKIAkJaWYgKGFjcnRjX3N0YXRlLT5zdHJlYW0pIHsKLQotCQkJaWYgKGFjcnRj
X3N0YXRlLT5mcmVlc3luY190aW1pbmdfY2hhbmdlZCkKLQkJCQlidW5kbGUtPnN0cmVhbV91cGRh
dGUuYWRqdXN0ID0KLQkJCQkJJmFjcnRjX3N0YXRlLT5zdHJlYW0tPmFkanVzdDsKLQogCQkJaWYg
KGFjcnRjX3N0YXRlLT5mcmVlc3luY192cnJfaW5mb19jaGFuZ2VkKQogCQkJCWJ1bmRsZS0+c3Ry
ZWFtX3VwZGF0ZS52cnJfaW5mb3BhY2tldCA9CiAJCQkJCSZhY3J0Y19zdGF0ZS0+c3RyZWFtLT52
cnJfaW5mb3BhY2tldDsKQEAgLTU1NzksNiArNTU3OSwyMCBAQCBzdGF0aWMgdm9pZCBhbWRncHVf
ZG1fY29tbWl0X3BsYW5lcyhzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJCWlmIChh
Y3J0Y19zdGF0ZS0+YWJtX2xldmVsICE9IGRtX29sZF9jcnRjX3N0YXRlLT5hYm1fbGV2ZWwpCiAJ
CQlidW5kbGUtPnN0cmVhbV91cGRhdGUuYWJtX2xldmVsID0gJmFjcnRjX3N0YXRlLT5hYm1fbGV2
ZWw7CiAKKwkJLyoKKwkJICogSWYgRnJlZVN5bmMgc3RhdGUgb24gdGhlIHN0cmVhbSBoYXMgY2hh
bmdlZCB0aGVuIHdlIG5lZWQgdG8KKwkJICogcmUtYWRqdXN0IHRoZSBtaW4vbWF4IGJvdW5kcyBu
b3cgdGhhdCBEQyBkb2Vzbid0IGhhbmRsZSB0aGlzCisJCSAqIGFzIHBhcnQgb2YgY29tbWl0Lgor
CQkgKi8KKwkJaWYgKGFtZGdwdV9kbV92cnJfYWN0aXZlKGRtX29sZF9jcnRjX3N0YXRlKSAhPQor
CQkgICAgYW1kZ3B1X2RtX3Zycl9hY3RpdmUoYWNydGNfc3RhdGUpKSB7CisJCQlzcGluX2xvY2tf
aXJxc2F2ZSgmcGNydGMtPmRldi0+ZXZlbnRfbG9jaywgZmxhZ3MpOworCQkJZGNfc3RyZWFtX2Fk
anVzdF92bWluX3ZtYXgoCisJCQkJZG0tPmRjLCBhY3J0Y19zdGF0ZS0+c3RyZWFtLAorCQkJCSZh
Y3J0Y19zdGF0ZS0+dnJyX3BhcmFtcy5hZGp1c3QpOworCQkJc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmcGNydGMtPmRldi0+ZXZlbnRfbG9jaywgZmxhZ3MpOworCQl9CisKIAkJbXV0ZXhfbG9jaygm
ZG0tPmRjX2xvY2spOwogCQlkY19jb21taXRfdXBkYXRlc19mb3Jfc3RyZWFtKGRtLT5kYywKIAkJ
CQkJCSAgICAgYnVuZGxlLT5zdXJmYWNlX3VwZGF0ZXMsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kYy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNw
bGF5L2RjL2NvcmUvZGMuYwppbmRleCA3OWMzYTM3Li41MDEyYjY3NSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2NvcmUvZGMuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kYy5jCkBAIC0yNjMsNyArMjYzLDcgQEAgYm9vbCBkY19z
dHJlYW1fYWRqdXN0X3ZtaW5fdm1heChzdHJ1Y3QgZGMgKmRjLAogCWZvciAoaSA9IDA7IGkgPCBN
QVhfUElQRVM7IGkrKykgewogCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGUgPSAmZGMtPmN1cnJlbnRf
c3RhdGUtPnJlc19jdHgucGlwZV9jdHhbaV07CiAKLQkJaWYgKHBpcGUtPnN0cmVhbSA9PSBzdHJl
YW0gJiYgcGlwZS0+c3RyZWFtX3Jlcy5zdHJlYW1fZW5jKSB7CisJCWlmIChwaXBlLT5zdHJlYW0g
PT0gc3RyZWFtICYmIHBpcGUtPnN0cmVhbV9yZXMudGcpIHsKIAkJCXBpcGUtPnN0cmVhbS0+YWRq
dXN0ID0gKmFkanVzdDsKIAkJCWRjLT5od3NzLnNldF9kcnIoJnBpcGUsCiAJCQkJCTEsCkBAIC0x
NzQ1LDEzICsxNzQ1LDYgQEAgc3RhdGljIHZvaWQgY29tbWl0X3BsYW5lc19kb19zdHJlYW1fdXBk
YXRlKHN0cnVjdCBkYyAqZGMsCiAJCQlwaXBlX2N0eC0+c3RyZWFtICYmCiAJCQlwaXBlX2N0eC0+
c3RyZWFtID09IHN0cmVhbSkgewogCi0JCQkvKiBGYXN0IHVwZGF0ZSovCi0JCQkvLyBWUlIgcHJv
Z3JhbSBjYW4gYmUgZG9uZSBhcyBwYXJ0IG9mIEZBU1QgVVBEQVRFCi0JCQlpZiAoc3RyZWFtX3Vw
ZGF0ZS0+YWRqdXN0KQotCQkJCWRjLT5od3NzLnNldF9kcnIoJnBpcGVfY3R4LCAxLAotCQkJCQlz
dHJlYW1fdXBkYXRlLT5hZGp1c3QtPnZfdG90YWxfbWluLAotCQkJCQlzdHJlYW1fdXBkYXRlLT5h
ZGp1c3QtPnZfdG90YWxfbWF4KTsKLQogCQkJaWYgKHN0cmVhbV91cGRhdGUtPnBlcmlvZGljX2lu
dGVycnVwdDAgJiYKIAkJCQkJZGMtPmh3c3Muc2V0dXBfcGVyaW9kaWNfaW50ZXJydXB0KQogCQkJ
CWRjLT5od3NzLnNldHVwX3BlcmlvZGljX2ludGVycnVwdChwaXBlX2N0eCwgVkxJTkUwKTsKQEAg
LTE5MDksNiArMTkwMiwyMCBAQCBzdGF0aWMgdm9pZCBjb21taXRfcGxhbmVzX2Zvcl9zdHJlYW0o
c3RydWN0IGRjICpkYywKIAogCQlkYy0+aHdzcy5waXBlX2NvbnRyb2xfbG9jayhkYywgdG9wX3Bp
cGVfdG9fcHJvZ3JhbSwgZmFsc2UpOwogCX0KKworCS8vIEZpcmUgbWFudWFsIHRyaWdnZXIKKwlm
b3IgKGkgPSAwOyBpIDwgZGMtPnJlc19wb29sLT5waXBlX2NvdW50OyBpKyspIHsKKwkJc3RydWN0
IHBpcGVfY3R4ICpwaXBlX2N0eCA9ICZjb250ZXh0LT5yZXNfY3R4LnBpcGVfY3R4W2ldOworCisJ
CWlmIChwaXBlX2N0eC0+dG9wX3BpcGUgfHwKKwkJCSFwaXBlX2N0eC0+c3RyZWFtIHx8CisJCQlw
aXBlX2N0eC0+c3RyZWFtICE9IHN0cmVhbSB8fAorCQkJIXNyZl91cGRhdGVzW2ldLmZsaXBfYWRk
cikKKwkJCWNvbnRpbnVlOworCisJCWlmIChwaXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+ZnVuY3Mt
PnByb2dyYW1fbWFudWFsX3RyaWdnZXIpCisJCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+ZnVu
Y3MtPnByb2dyYW1fbWFudWFsX3RyaWdnZXIocGlwZV9jdHgtPnN0cmVhbV9yZXMudGcpOworCX0K
IH0KIAogdm9pZCBkY19jb21taXRfdXBkYXRlc19mb3Jfc3RyZWFtKHN0cnVjdCBkYyAqZGMsCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNfc3RyZWFtLmggYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNfc3RyZWFtLmgKaW5kZXggMTg5YmRhYi4u
NGRhMTM4ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjX3N0
cmVhbS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY19zdHJlYW0uaApA
QCAtMTcyLDcgKzE3Miw2IEBAIHN0cnVjdCBkY19zdHJlYW1fdXBkYXRlIHsKIAlzdHJ1Y3QgcGVy
aW9kaWNfaW50ZXJydXB0X2NvbmZpZyAqcGVyaW9kaWNfaW50ZXJydXB0MDsKIAlzdHJ1Y3QgcGVy
aW9kaWNfaW50ZXJydXB0X2NvbmZpZyAqcGVyaW9kaWNfaW50ZXJydXB0MTsKIAotCXN0cnVjdCBk
Y19jcnRjX3RpbWluZ19hZGp1c3QgKmFkanVzdDsKIAlzdHJ1Y3QgZGNfaW5mb19wYWNrZXQgKnZy
cl9pbmZvcGFja2V0OwogCXN0cnVjdCBkY19pbmZvX3BhY2tldCAqdnNjX2luZm9wYWNrZXQ7CiAJ
c3RydWN0IGRjX2luZm9fcGFja2V0ICp2c3BfaW5mb3BhY2tldDsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9od19zZXF1ZW5jZXIuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9od19zZXF1ZW5jZXIuYwpp
bmRleCA3ZWUzYzYwLi5iNWNhMTc2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvZGNuMTAvZGNuMTBfaHdfc2VxdWVuY2VyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX2h3X3NlcXVlbmNlci5jCkBAIC0yNTA2LDggKzI1
MDYsOCBAQCBzdGF0aWMgdm9pZCBzZXRfZHJyKHN0cnVjdCBwaXBlX2N0eCAqKnBpcGVfY3R4LAog
ewogCWludCBpID0gMDsKIAlzdHJ1Y3QgZHJyX3BhcmFtcyBwYXJhbXMgPSB7MH07Ci0JLy8gRFJS
IHNob3VsZCBzZXQgdHJpZ2dlciBldmVudCB0byBtb25pdG9yIHN1cmZhY2UgdXBkYXRlIGV2ZW50
Ci0JdW5zaWduZWQgaW50IGV2ZW50X3RyaWdnZXJzID0gMHg4MDsKKwkvLyBEUlIgc2V0IHRyaWdn
ZXIgZXZlbnQgbWFwcGVkIHRvIE9UR19UUklHX0EgKGJpdCAxMSkgZm9yIG1hbnVhbCBjb250cm9s
IGZsb3cKKwl1bnNpZ25lZCBpbnQgZXZlbnRfdHJpZ2dlcnMgPSAweDgwMDsKIAogCXBhcmFtcy52
ZXJ0aWNhbF90b3RhbF9tYXggPSB2bWF4OwogCXBhcmFtcy52ZXJ0aWNhbF90b3RhbF9taW4gPSB2
bWluOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2Rj
bjEwX29wdGMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9v
cHRjLmMKaW5kZXggNTMzYjBmMy4uZTRiODUwYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX29wdGMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfb3B0Yy5jCkBAIC03OTEsNiArNzkxLDMyIEBAIHZv
aWQgb3B0YzFfc2V0X3N0YXRpY19zY3JlZW5fY29udHJvbCgKIAkJCU9UR19TVEFUSUNfU0NSRUVO
X0ZSQU1FX0NPVU5ULCAyKTsKIH0KIAordm9pZCBvcHRjMV9zZXR1cF9tYW51YWxfdHJpZ2dlcihz
dHJ1Y3QgdGltaW5nX2dlbmVyYXRvciAqb3B0YykKK3sKKwlzdHJ1Y3Qgb3B0YyAqb3B0YzEgPSBE
Q04xMFRHX0ZST01fVEcob3B0Yyk7CisKKwlSRUdfU0VUKE9UR19HTE9CQUxfQ09OVFJPTDIsIDAs
CisJCQlNQU5VQUxfRkxPV19DT05UUk9MX1NFTCwgb3B0Yy0+aW5zdCk7CisKKwlSRUdfU0VUXzgo
T1RHX1RSSUdBX0NOVEwsIDAsCisJCQlPVEdfVFJJR0FfU09VUkNFX1NFTEVDVCwgMjIsCisJCQlP
VEdfVFJJR0FfU09VUkNFX1BJUEVfU0VMRUNULCBvcHRjLT5pbnN0LAorCQkJT1RHX1RSSUdBX1JJ
U0lOR19FREdFX0RFVEVDVF9DTlRMLCAxLAorCQkJT1RHX1RSSUdBX0ZBTExJTkdfRURHRV9ERVRF
Q1RfQ05UTCwgMCwKKwkJCU9UR19UUklHQV9QT0xBUklUWV9TRUxFQ1QsIDAsCisJCQlPVEdfVFJJ
R0FfRlJFUVVFTkNZX1NFTEVDVCwgMCwKKwkJCU9UR19UUklHQV9ERUxBWSwgMCwKKwkJCU9UR19U
UklHQV9DTEVBUiwgMSk7Cit9CisKK3ZvaWQgb3B0YzFfcHJvZ3JhbV9tYW51YWxfdHJpZ2dlcihz
dHJ1Y3QgdGltaW5nX2dlbmVyYXRvciAqb3B0YykKK3sKKwlzdHJ1Y3Qgb3B0YyAqb3B0YzEgPSBE
Q04xMFRHX0ZST01fVEcob3B0Yyk7CisKKwlSRUdfU0VUKE9UR19NQU5VQUxfRkxPV19DT05UUk9M
LCAwLAorCQkJTUFOVUFMX0ZMT1dfQ09OVFJPTCwgMSk7Cit9CisKIAogLyoqCiAgKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioKQEAgLTgyMyw2ICs4NDksMTAgQEAgdm9pZCBvcHRjMV9zZXRfZHJyKAogCQkJ
CU9UR19GT1JDRV9MT0NLX09OX0VWRU5ULCAwLAogCQkJCU9UR19TRVRfVl9UT1RBTF9NSU5fTUFT
S19FTiwgMCwKIAkJCQlPVEdfU0VUX1ZfVE9UQUxfTUlOX01BU0ssIDApOworCisJCS8vIFNldHVw
IG1hbnVhbCBmbG93IGNvbnRyb2wgZm9yIEVPRiB2aWEgVFJJR19BCisJCW9wdGMtPmZ1bmNzLT5z
ZXR1cF9tYW51YWxfdHJpZ2dlcihvcHRjKTsKKwogCX0gZWxzZSB7CiAJCVJFR19VUERBVEVfNChP
VEdfVl9UT1RBTF9DT05UUk9MLAogCQkJCU9UR19TRVRfVl9UT1RBTF9NSU5fTUFTSywgMCwKQEAg
LTE0NTgsNiArMTQ4OCw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdGltaW5nX2dlbmVyYXRvcl9m
dW5jcyBkY24xMF90Z19mdW5jcyA9IHsKIAkJLmdldF9jcmMgPSBvcHRjMV9nZXRfY3JjLAogCQku
Y29uZmlndXJlX2NyYyA9IG9wdGMxX2NvbmZpZ3VyZV9jcmMsCiAJCS5zZXRfdnRnX3BhcmFtcyA9
IG9wdGMxX3NldF92dGdfcGFyYW1zLAorCQkucHJvZ3JhbV9tYW51YWxfdHJpZ2dlciA9IG9wdGMx
X3Byb2dyYW1fbWFudWFsX3RyaWdnZXIsCisJCS5zZXR1cF9tYW51YWxfdHJpZ2dlciA9IG9wdGMx
X3NldHVwX21hbnVhbF90cmlnZ2VyCiB9OwogCiB2b2lkIGRjbjEwX3RpbWluZ19nZW5lcmF0b3Jf
aW5pdChzdHJ1Y3Qgb3B0YyAqb3B0YzEpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfb3B0Yy5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNw
bGF5L2RjL2RjbjEwL2RjbjEwX29wdGMuaAppbmRleCA3MGZkNTZmLi40NDRjNTZjIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfb3B0Yy5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9vcHRjLmgKQEAg
LTg1LDEzICs4NSwxNyBAQAogCVNSSShPVEdfQ1JDMF9XSU5ET1dBX1lfQ09OVFJPTCwgT1RHLCBp
bnN0KSxcCiAJU1JJKE9UR19DUkMwX1dJTkRPV0JfWF9DT05UUk9MLCBPVEcsIGluc3QpLFwKIAlT
UkkoT1RHX0NSQzBfV0lORE9XQl9ZX0NPTlRST0wsIE9URywgaW5zdCksXAotCVNSKEdTTF9TT1VS
Q0VfU0VMRUNUKQorCVNSKEdTTF9TT1VSQ0VfU0VMRUNUKSxcCisJU1JJKE9UR19HTE9CQUxfQ09O
VFJPTDIsIE9URywgaW5zdCksXAorCVNSSShPVEdfVFJJR0FfTUFOVUFMX1RSSUcsIE9URywgaW5z
dCkKKwogCiAjZGVmaW5lIFRHX0NPTU1PTl9SRUdfTElTVF9EQ04xXzAoaW5zdCkgXAogCVRHX0NP
TU1PTl9SRUdfTElTVF9EQ04oaW5zdCksXAogCVNSSShPVEdfVEVTVF9QQVRURVJOX1BBUkFNRVRF
UlMsIE9URywgaW5zdCksXAogCVNSSShPVEdfVEVTVF9QQVRURVJOX0NPTlRST0wsIE9URywgaW5z
dCksXAotCVNSSShPVEdfVEVTVF9QQVRURVJOX0NPTE9SLCBPVEcsIGluc3QpCisJU1JJKE9UR19U
RVNUX1BBVFRFUk5fQ09MT1IsIE9URywgaW5zdCksXAorCVNSSShPVEdfTUFOVUFMX0ZMT1dfQ09O
VFJPTCwgT1RHLCBpbnN0KQogCiAKIHN0cnVjdCBkY25fb3B0Y19yZWdpc3RlcnMgewpAQCAtMTI1
LDYgKzEyOSw4IEBAIHN0cnVjdCBkY25fb3B0Y19yZWdpc3RlcnMgewogCXVpbnQzMl90IE9UR19W
X1RPVEFMX01JTjsKIAl1aW50MzJfdCBPVEdfVl9UT1RBTF9DT05UUk9MOwogCXVpbnQzMl90IE9U
R19UUklHQV9DTlRMOworCXVpbnQzMl90IE9UR19UUklHQV9NQU5VQUxfVFJJRzsKKwl1aW50MzJf
dCBPVEdfTUFOVUFMX0ZMT1dfQ09OVFJPTDsKIAl1aW50MzJfdCBPVEdfRk9SQ0VfQ09VTlRfTk9X
X0NOVEw7CiAJdWludDMyX3QgT1RHX1NUQVRJQ19TQ1JFRU5fQ09OVFJPTDsKIAl1aW50MzJfdCBP
VEdfU1RBVFVTX0ZSQU1FX0NPVU5UOwpAQCAtMjE1LDYgKzIyMSwxMSBAQCBzdHJ1Y3QgZGNuX29w
dGNfcmVnaXN0ZXJzIHsKIAlTRihPVEcwX09UR19UUklHQV9DTlRMLCBPVEdfVFJJR0FfU09VUkNF
X1BJUEVfU0VMRUNULCBtYXNrX3NoKSxcCiAJU0YoT1RHMF9PVEdfVFJJR0FfQ05UTCwgT1RHX1RS
SUdBX1JJU0lOR19FREdFX0RFVEVDVF9DTlRMLCBtYXNrX3NoKSxcCiAJU0YoT1RHMF9PVEdfVFJJ
R0FfQ05UTCwgT1RHX1RSSUdBX0ZBTExJTkdfRURHRV9ERVRFQ1RfQ05UTCwgbWFza19zaCksXAor
CVNGKE9URzBfT1RHX1RSSUdBX0NOVEwsIE9UR19UUklHQV9QT0xBUklUWV9TRUxFQ1QsIG1hc2tf
c2gpLFwKKwlTRihPVEcwX09UR19UUklHQV9DTlRMLCBPVEdfVFJJR0FfRlJFUVVFTkNZX1NFTEVD
VCwgbWFza19zaCksXAorCVNGKE9URzBfT1RHX1RSSUdBX0NOVEwsIE9UR19UUklHQV9ERUxBWSwg
bWFza19zaCksXAorCVNGKE9URzBfT1RHX1RSSUdBX0NOVEwsIE9UR19UUklHQV9DTEVBUiwgbWFz
a19zaCksXAorCVNGKE9URzBfT1RHX1RSSUdBX01BTlVBTF9UUklHLCBPVEdfVFJJR0FfTUFOVUFM
X1RSSUcsIG1hc2tfc2gpLFwKIAlTRihPVEcwX09UR19TVEFUSUNfU0NSRUVOX0NPTlRST0wsIE9U
R19TVEFUSUNfU0NSRUVOX0VWRU5UX01BU0ssIG1hc2tfc2gpLFwKIAlTRihPVEcwX09UR19TVEFU
SUNfU0NSRUVOX0NPTlRST0wsIE9UR19TVEFUSUNfU0NSRUVOX0ZSQU1FX0NPVU5ULCBtYXNrX3No
KSxcCiAJU0YoT1RHMF9PVEdfU1RBVFVTX0ZSQU1FX0NPVU5ULCBPVEdfRlJBTUVfQ09VTlQsIG1h
c2tfc2gpLFwKQEAgLTI3MSw4ICsyODIsOCBAQCBzdHJ1Y3QgZGNuX29wdGNfcmVnaXN0ZXJzIHsK
IAlTRihPVEcwX09UR19DUkMwX1dJTkRPV0JfWV9DT05UUk9MLCBPVEdfQ1JDMF9XSU5ET1dCX1lf
RU5ELCBtYXNrX3NoKSxcCiAJU0YoR1NMX1NPVVJDRV9TRUxFQ1QsIEdTTDBfUkVBRFlfU09VUkNF
X1NFTCwgbWFza19zaCksXAogCVNGKEdTTF9TT1VSQ0VfU0VMRUNULCBHU0wxX1JFQURZX1NPVVJD
RV9TRUwsIG1hc2tfc2gpLFwKLQlTRihHU0xfU09VUkNFX1NFTEVDVCwgR1NMMl9SRUFEWV9TT1VS
Q0VfU0VMLCBtYXNrX3NoKQotCisJU0YoR1NMX1NPVVJDRV9TRUxFQ1QsIEdTTDJfUkVBRFlfU09V
UkNFX1NFTCwgbWFza19zaCksXAorCVNGKE9URzBfT1RHX0dMT0JBTF9DT05UUk9MMiwgTUFOVUFM
X0ZMT1dfQ09OVFJPTF9TRUwsIG1hc2tfc2gpCiAKICNkZWZpbmUgVEdfQ09NTU9OX01BU0tfU0hf
TElTVF9EQ04xXzAobWFza19zaClcCiAJVEdfQ09NTU9OX01BU0tfU0hfTElTVF9EQ04obWFza19z
aCksXApAQCAtMjg3LDcgKzI5OCw4IEBAIHN0cnVjdCBkY25fb3B0Y19yZWdpc3RlcnMgewogCVNG
KE9URzBfT1RHX1RFU1RfUEFUVEVSTl9DT05UUk9MLCBPVEdfVEVTVF9QQVRURVJOX0NPTE9SX0ZP
Uk1BVCwgbWFza19zaCksXAogCVNGKE9URzBfT1RHX1RFU1RfUEFUVEVSTl9DT0xPUiwgT1RHX1RF
U1RfUEFUVEVSTl9NQVNLLCBtYXNrX3NoKSxcCiAJU0YoT1RHMF9PVEdfVEVTVF9QQVRURVJOX0NP
TE9SLCBPVEdfVEVTVF9QQVRURVJOX0RBVEEsIG1hc2tfc2gpLFwKLQlTRihPRE0wX09QVENfREFU
QV9TT1VSQ0VfU0VMRUNULCBPUFRDX1NSQ19TRUwsIG1hc2tfc2gpCisJU0YoT0RNMF9PUFRDX0RB
VEFfU09VUkNFX1NFTEVDVCwgT1BUQ19TUkNfU0VMLCBtYXNrX3NoKSxcCisJU0YoT1RHMF9PVEdf
TUFOVUFMX0ZMT1dfQ09OVFJPTCwgTUFOVUFMX0ZMT1dfQ09OVFJPTCwgbWFza19zaCksXAogCiAj
ZGVmaW5lIFRHX1JFR19GSUVMRF9MSVNUX0RDTjFfMCh0eXBlKSBcCiAJdHlwZSBWU1RBUlRVUF9T
VEFSVDtcCkBAIC0zNDMsNiArMzU1LDExIEBAIHN0cnVjdCBkY25fb3B0Y19yZWdpc3RlcnMgewog
CXR5cGUgT1RHX1RSSUdBX1NPVVJDRV9QSVBFX1NFTEVDVDtcCiAJdHlwZSBPVEdfVFJJR0FfUklT
SU5HX0VER0VfREVURUNUX0NOVEw7XAogCXR5cGUgT1RHX1RSSUdBX0ZBTExJTkdfRURHRV9ERVRF
Q1RfQ05UTDtcCisJdHlwZSBPVEdfVFJJR0FfUE9MQVJJVFlfU0VMRUNUO1wKKwl0eXBlIE9UR19U
UklHQV9GUkVRVUVOQ1lfU0VMRUNUO1wKKwl0eXBlIE9UR19UUklHQV9ERUxBWTtcCisJdHlwZSBP
VEdfVFJJR0FfQ0xFQVI7XAorCXR5cGUgT1RHX1RSSUdBX01BTlVBTF9UUklHO1wKIAl0eXBlIE9U
R19TVEFUSUNfU0NSRUVOX0VWRU5UX01BU0s7XAogCXR5cGUgT1RHX1NUQVRJQ19TQ1JFRU5fRlJB
TUVfQ09VTlQ7XAogCXR5cGUgT1RHX0ZSQU1FX0NPVU5UO1wKQEAgLTQyMSw3ICs0MzgsOSBAQCBz
dHJ1Y3QgZGNuX29wdGNfcmVnaXN0ZXJzIHsKIAl0eXBlIE9UR19DUkMwX1dJTkRPV0JfWV9FTkQ7
XAogCXR5cGUgR1NMMF9SRUFEWV9TT1VSQ0VfU0VMO1wKIAl0eXBlIEdTTDFfUkVBRFlfU09VUkNF
X1NFTDtcCi0JdHlwZSBHU0wyX1JFQURZX1NPVVJDRV9TRUw7CisJdHlwZSBHU0wyX1JFQURZX1NP
VVJDRV9TRUw7XAorCXR5cGUgTUFOVUFMX0ZMT1dfQ09OVFJPTDtcCisJdHlwZSBNQU5VQUxfRkxP
V19DT05UUk9MX1NFTDsKIAogCiAjZGVmaW5lIFRHX1JFR19GSUVMRF9MSVNUKHR5cGUpIFwKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHcvdGltaW5nX2dl
bmVyYXRvci5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9ody90aW1pbmdf
Z2VuZXJhdG9yLmgKaW5kZXggMGI4YzY4OTYuLmE4OWQwY2YgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHcvdGltaW5nX2dlbmVyYXRvci5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHcvdGltaW5nX2dlbmVyYXRvci5oCkBA
IC0yMzgsNiArMjM4LDkgQEAgc3RydWN0IHRpbWluZ19nZW5lcmF0b3JfZnVuY3MgewogCWJvb2wg
KCpnZXRfY3JjKShzdHJ1Y3QgdGltaW5nX2dlbmVyYXRvciAqdGcsCiAJCQl1aW50MzJfdCAqcl9j
ciwgdWludDMyX3QgKmdfeSwgdWludDMyX3QgKmJfY2IpOwogCisJdm9pZCAoKnByb2dyYW1fbWFu
dWFsX3RyaWdnZXIpKHN0cnVjdCB0aW1pbmdfZ2VuZXJhdG9yICpvcHRjKTsKKwl2b2lkICgqc2V0
dXBfbWFudWFsX3RyaWdnZXIpKHN0cnVjdCB0aW1pbmdfZ2VuZXJhdG9yICpvcHRjKTsKKwogCXZv
aWQgKCpzZXRfdnRnX3BhcmFtcykoc3RydWN0IHRpbWluZ19nZW5lcmF0b3IgKm9wdGMsCiAJCQlj
b25zdCBzdHJ1Y3QgZGNfY3J0Y190aW1pbmcgKmRjX2NydGNfdGltaW5nKTsKIH07Ci0tIAoyLjcu
NAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdm
eCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0
cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
