Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D5B1FDEE18
	for <lists+amd-gfx@lfdr.de>; Mon, 21 Oct 2019 15:42:16 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 53E1E6E0DC;
	Mon, 21 Oct 2019 13:42:15 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM03-BY2-obe.outbound.protection.outlook.com
 (mail-eopbgr780053.outbound.protection.outlook.com [40.107.78.53])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 11F896E0DC
 for <amd-gfx@lists.freedesktop.org>; Mon, 21 Oct 2019 13:42:14 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Bv3ht0CQBPwgXUTrpzmxFtC6kqwBEl0JBogGIGZvqeAPtZsylLeRnsEcWsyJJd3v+CPXBCFvmp0auOar3hqmguzgd9SmYcza3FZeDcA8YVo2mRHnxOMdBhdXjHXb8D5R6qPDAoAc0cLoafYs+0MUXX8VnQ+GQc7lJcACOsn2aRGZOcl0c+yC/q/AcjDf6kTPR6KtD97yEcIxH9zO3dA6oHJu713Q6VOgoJSN9ZuJ7I2zx5AeTnuWXoU8AtuipJt6mCsvDTWbPRzrsyn7hK+J5ZxZsLQJHP0bAo5ece7lKZ0LNggRA//dzKxxEEw+jCSNjBIK8YJjzzEOFqi5tDcTiw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=WZqLMOh89C42KZMjXkmq78nCbFe2ndOsStlA/e+NBlU=;
 b=gXchKA99NnBjL74IcLNsn+oDrZCNLVISEmTSjmgZHGHLQZZ1pZb6b/o9Jw4AbHmb6h7jzhikN/xX1JoD+lcaI7zbsWC4fUnLaD+nkK4ZV1EXVf/pDrM10HR0sioWNmJuiqOHGIQb0lYcFL1dVxVbjqGq1uTzAbAq3NoOqxvK01afye0lRDSLqYjhrRCToVRHukDtlKi14obZbz2rDK/09CPoVayJTnnLoA9ZlhT5HQHCdfqaCJb0v5ryggtN4wDDP8QojA6gJ+HlwadNXkVnt2vbv4EhiJIDJWmqbx6M08vg++sXkLItnLDB3NMAM6Bv9CNvP6iBpyNoLTyh9g0+UA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from BN6PR12MB1809.namprd12.prod.outlook.com (10.175.101.17) by
 BN6PR12MB1492.namprd12.prod.outlook.com (10.172.24.145) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2367.20; Mon, 21 Oct 2019 13:42:11 +0000
Received: from BN6PR12MB1809.namprd12.prod.outlook.com
 ([fe80::f16d:2fda:9e18:a554]) by BN6PR12MB1809.namprd12.prod.outlook.com
 ([fe80::f16d:2fda:9e18:a554%12]) with mapi id 15.20.2347.029; Mon, 21 Oct
 2019 13:42:11 +0000
From: "Deucher, Alexander" <Alexander.Deucher@amd.com>
To: "Quan, Evan" <Evan.Quan@amd.com>, "amd-gfx@lists.freedesktop.org"
 <amd-gfx@lists.freedesktop.org>
Subject: RE: [PATCH 1/3] drm/amd/powerplay: add lock protection for swSMU APIs
 V2
Thread-Topic: [PATCH 1/3] drm/amd/powerplay: add lock protection for swSMU
 APIs V2
Thread-Index: AQHVh7nvdVvHs/++skuD1dFOknI+LadlGxPQ
Date: Mon, 21 Oct 2019 13:42:11 +0000
Message-ID: <BN6PR12MB180925D807448A08071A0530F7690@BN6PR12MB1809.namprd12.prod.outlook.com>
References: <20191021024610.16569-1-evan.quan@amd.com>
In-Reply-To: <20191021024610.16569-1-evan.quan@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [165.204.55.251]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 58977958-1642-464d-fd66-08d7562c7976
x-ms-office365-filtering-ht: Tenant
x-ms-traffictypediagnostic: BN6PR12MB1492:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <BN6PR12MB14926B853423A04E5F161550F7690@BN6PR12MB1492.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:3826;
x-forefront-prvs: 0197AFBD92
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(366004)(39860400002)(396003)(136003)(346002)(376002)(13464003)(189003)(199004)(26005)(186003)(229853002)(2501003)(14444005)(446003)(76176011)(7696005)(99286004)(6246003)(11346002)(256004)(476003)(486006)(6436002)(478600001)(25786009)(4326008)(6506007)(66066001)(53546011)(102836004)(9686003)(55016002)(76116006)(30864003)(8936002)(66574012)(8676002)(71200400001)(74316002)(81156014)(81166006)(71190400001)(316002)(14454004)(54906003)(2906002)(86362001)(33656002)(52536014)(6116002)(5660300002)(7736002)(66476007)(66946007)(66556008)(66446008)(64756008)(110136005)(305945005)(3846002)(579004)(559001)(569006);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BN6PR12MB1492;
 H:BN6PR12MB1809.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: aFYAHCbr5UKWIKw2+Qem34uI8/QiW3TWLoNMyMheqpQFNPoBC7N5xUYUWZlKHSbx+qBUgSjKW/QtGGQTpiy8uXHyTAUrjKC6Ia7SrNy3vnPXq7GH+cUw75Zqepwn6mSEf52laj0Xb99wnrwzQV3CRDI/vPUQtj+NFS0+Tdj/RydXKXU8vimZCM59LRSGXo3SgKimW1r++mOOpm6GYLhewzwAhenuEqX2Aq1vw95hM8ur5Zg82aYuLRPU3vvGW8PIXDIKrBJxUwzPLgZTpBaiRdORIpZrZZyDdGocwVGEPVYSPRG2Hswcnf84TzCeEYTbD37w0EE3X0xdEAJ4uPDXA3NIOVRx9dozs22zi3RochRMn/Y6j2ReYF9nXhnZHGmYefYiErk9u/23uk3ulXiEA5z69ZwR295d5x0I9JgIv/nhG5xtR/rvdhWIppxXxzQa
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 58977958-1642-464d-fd66-08d7562c7976
X-MS-Exchange-CrossTenant-originalarrivaltime: 21 Oct 2019 13:42:11.0816 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: hvhZTqLc+No9agfGBJ+3Dll+qf1k4rawS0829MzDcDZJUhM5HlZzasfUh0V9bCKhZwwEO2YBWWzWqH9wAVFlNg==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN6PR12MB1492
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=WZqLMOh89C42KZMjXkmq78nCbFe2ndOsStlA/e+NBlU=;
 b=1B2xisbAKxv0mmFSO3qzkf7c0YZ894ysNTzoudtq0z+nBxBi3uOLiqSGNUsg94w7mz9a+7tPYUoQS73/af2HyMuAGTYrHqdJg3uoU0DopGp9FKwoFMOQURoCkNXQvQpJcAm4c6USakL1qn4f4p8CbVbFN8a92uHZJjHz4ZCloIw=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Alexander.Deucher@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Grodzovsky, Andrey" <Andrey.Grodzovsky@amd.com>, "Xu,
 Feifei" <Feifei.Xu@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

PiAtLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0tLQo+IEZyb206IFF1YW4sIEV2YW4gPEV2YW4uUXVh
bkBhbWQuY29tPgo+IFNlbnQ6IFN1bmRheSwgT2N0b2JlciAyMCwgMjAxOSAxMDo0OCBQTQo+IFRv
OiBhbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+IENjOiBEZXVjaGVyLCBBbGV4YW5kZXIg
PEFsZXhhbmRlci5EZXVjaGVyQGFtZC5jb20+OyBHcm9kem92c2t5LAo+IEFuZHJleSA8QW5kcmV5
Lkdyb2R6b3Zza3lAYW1kLmNvbT47IFh1LCBGZWlmZWkgPEZlaWZlaS5YdUBhbWQuY29tPjsKPiBR
dWFuLCBFdmFuIDxFdmFuLlF1YW5AYW1kLmNvbT47IEdyb2R6b3Zza3ksIEFuZHJleQo+IDxBbmRy
ZXkuR3JvZHpvdnNreUBhbWQuY29tPjsgWHUsIEZlaWZlaSA8RmVpZmVpLlh1QGFtZC5jb20+Cj4g
U3ViamVjdDogW1BBVENIIDEvM10gZHJtL2FtZC9wb3dlcnBsYXk6IGFkZCBsb2NrIHByb3RlY3Rp
b24gZm9yIHN3U01VCj4gQVBJcyBWMgo+IAo+IFRoaXMgaXMgYSBxdWljayBhbmQgbG93IHJpc2sg
Zml4LiBUaG9zZSBBUElzIHdoaWNoCj4gYXJlIGV4cG9zZWQgdG8gb3RoZXIgSVBzIG9yIHRvIHN1
cHBvcnQgc3lzZnMvaHdtb24KPiBpbnRlcmZhY2VzIG9yIERBTCB3aWxsIGhhdmUgbG9jayBwcm90
ZWN0aW9uLiBNZWFud2hpbGUKPiBubyBsb2NrIHByb3RlY3Rpb24gaXMgZW5mb3JjZWQgZm9yIHN3
U01VIGludGVybmFsIHVzZWQKPiBBUElzLiBGdXR1cmUgb3B0aW1pemF0aW9uIGlzIG5lZWRlZC4K
PiAKPiBWMjogc3RyaXAgdGhlIGxvY2sgcHJvdGVjdGlvbiBmb3IgYWxsIHN3U01VIGludGVybmFs
IEFQSXMKPiAKPiBDaGFuZ2UtSWQ6IEk4MzkyNjUyYzlkYTE1NzRhODVhY2Q5YjE3MWYwNDM4MGYz
NjMwODUyCj4gU2lnbmVkLW9mZi1ieTogRXZhbiBRdWFuIDxldmFuLnF1YW5AYW1kLmNvbT4KPiBB
Y2tlZC1ieTogQW5kcmV5IEdyb2R6b3Zza3kgPGFuZHJleS5ncm9kem92c2t5QGFtZC5jb20+Cj4g
QWNrZWQtYnk6IEZlaWZlaSBYdSA8RmVpZmVpLlh1QGFtZC5jb20+CgpBY2tlZC1ieTogQWxleCBE
ZXVjaGVyIDxhbGV4YW5kZXIuZGV1Y2hlckBhbWQuY29tPgoKPiAtLS0KPiAgZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5jICAgICAgIHwgICA2ICstCj4gIGRyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0uaCAgICAgICB8ICAgNiAtCj4gIGRyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jICAgICAgICB8ICAyMyArLQo+ICAuLi4vYW1kL2Rp
c3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9wcF9zbXUuYyAgfCAgIDQgKy0KPiAgZHJpdmVycy9n
cHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jICAgIHwgNjk2Cj4gKysrKysrKysrKysr
KysrKy0tCj4gIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2FyY3R1cnVzX3BwdC5jICB8
ICAgMyAtCj4gIC4uLi9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5jL2FtZGdwdV9zbXUuaCAgICB8
IDE2MyArKy0tCj4gIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25hdmkxMF9wcHQuYyAg
ICB8ICAxNSArLQo+ICBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9yZW5vaXJfcHB0LmMg
ICAgfCAgMTQgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211X3YxMV8wLmMg
ICAgIHwgIDIyICstCj4gIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3NtdV92MTJfMC5j
ICAgICB8ICAgMyAtCj4gIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3ZlZ2EyMF9wcHQu
YyAgICB8ICAyMCArLQo+ICAxMiBmaWxlcyBjaGFuZ2VkLCA3NzcgaW5zZXJ0aW9ucygrKSwgMTk4
IGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfZHBtLmMKPiBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0u
Ywo+IGluZGV4IDI2MzI2NTI0NWUxOS4uMjhkMzI3MjUyODViIDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0uYwo+IEBAIC05MTIsNyArOTEyLDggQEAgaW50IGFtZGdw
dV9kcG1fZ2V0X3NjbGsoc3RydWN0IGFtZGdwdV9kZXZpY2UKPiAqYWRldiwgYm9vbCBsb3cpCj4g
IAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsKPiAgCQlyZXQgPSBzbXVfZ2V0X2RwbV9m
cmVxX3JhbmdlKCZhZGV2LT5zbXUsCj4gU01VX0dGWENMSywKPiAgCQkJCQkgICAgIGxvdyA/ICZj
bGtfZnJlcSA6IE5VTEwsCj4gLQkJCQkJICAgICAhbG93ID8gJmNsa19mcmVxIDogTlVMTCk7Cj4g
KwkJCQkJICAgICAhbG93ID8gJmNsa19mcmVxIDogTlVMTCwKPiArCQkJCQkgICAgIHRydWUpOwo+
ICAJCWlmIChyZXQpCj4gIAkJCXJldHVybiAwOwo+ICAJCXJldHVybiBjbGtfZnJlcSAqIDEwMDsK
PiBAQCAtOTMwLDcgKzkzMSw4IEBAIGludCBhbWRncHVfZHBtX2dldF9tY2xrKHN0cnVjdCBhbWRn
cHVfZGV2aWNlCj4gKmFkZXYsIGJvb2wgbG93KQo+ICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFk
ZXYpKSB7Cj4gIAkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZSgmYWRldi0+c211LCBTTVVf
VUNMSywKPiAgCQkJCQkgICAgIGxvdyA/ICZjbGtfZnJlcSA6IE5VTEwsCj4gLQkJCQkJICAgICAh
bG93ID8gJmNsa19mcmVxIDogTlVMTCk7Cj4gKwkJCQkJICAgICAhbG93ID8gJmNsa19mcmVxIDog
TlVMTCwKPiArCQkJCQkgICAgIHRydWUpOwo+ICAJCWlmIChyZXQpCj4gIAkJCXJldHVybiAwOwo+
ICAJCXJldHVybiBjbGtfZnJlcSAqIDEwMDsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5oCj4gYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfZHBtLmgKPiBpbmRleCAxYzVjMGZkNzZkYmYuLjJjZmI2NzcyNzJhZiAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHBtLmgKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHBtLmgKPiBAQCAtMjk4LDEyICsyOTgsNiBA
QCBlbnVtIGFtZGdwdV9wY2llX2dlbiB7Cj4gICNkZWZpbmUgYW1kZ3B1X2RwbV9nZXRfY3VycmVu
dF9wb3dlcl9zdGF0ZShhZGV2KSBcCj4gIAkJKChhZGV2KS0+cG93ZXJwbGF5LnBwX2Z1bmNzLQo+
ID5nZXRfY3VycmVudF9wb3dlcl9zdGF0ZSgoYWRldiktPnBvd2VycGxheS5wcF9oYW5kbGUpKQo+
IAo+IC0jZGVmaW5lIGFtZGdwdV9zbXVfZ2V0X2N1cnJlbnRfcG93ZXJfc3RhdGUoYWRldikgXAo+
IC0JCSgoYWRldiktPnNtdS5wcHRfZnVuY3MtCj4gPmdldF9jdXJyZW50X3Bvd2VyX3N0YXRlKCYo
KGFkZXYpLT5zbXUpKSkKPiAtCj4gLSNkZWZpbmUgYW1kZ3B1X3NtdV9zZXRfcG93ZXJfc3RhdGUo
YWRldikgXAo+IC0JCSgoYWRldiktPnNtdS5wcHRfZnVuY3MtPnNldF9wb3dlcl9zdGF0ZSgmKChh
ZGV2KS0KPiA+c211KSkpCj4gLQo+ICAjZGVmaW5lIGFtZGdwdV9kcG1fZ2V0X3BwX251bV9zdGF0
ZXMoYWRldiwgZGF0YSkgXAo+ICAJCSgoYWRldiktPnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0X3Bw
X251bV9zdGF0ZXMoKGFkZXYpLQo+ID5wb3dlcnBsYXkucHBfaGFuZGxlLCBkYXRhKSkKPiAKPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BtLmMKPiBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jCj4gaW5kZXggYzUwZDVmMWU3NWU1
Li4zNmYzNmIzNTAwMGQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3BtLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0u
Ywo+IEBAIC0yMTEsNyArMjExLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9kcG1fc3Rh
dGUoc3RydWN0IGRldmljZQo+ICpkZXYsCj4gCj4gIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRl
dikpIHsKPiAgCQlpZiAoYWRldi0+c211LnBwdF9mdW5jcy0+Z2V0X2N1cnJlbnRfcG93ZXJfc3Rh
dGUpCj4gLQkJCXBtID0KPiBhbWRncHVfc211X2dldF9jdXJyZW50X3Bvd2VyX3N0YXRlKGFkZXYp
Owo+ICsJCQlwbSA9IHNtdV9nZXRfY3VycmVudF9wb3dlcl9zdGF0ZSgmYWRldi0+c211KTsKPiAg
CQllbHNlCj4gIAkJCXBtID0gYWRldi0+cG0uZHBtLnVzZXJfc3RhdGU7Cj4gIAl9IGVsc2UgaWYg
KGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0X2N1cnJlbnRfcG93ZXJfc3RhdGUpIHsKPiBA
QCAtOTU3LDcgKzk1Nyw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3NjbGso
c3RydWN0Cj4gZGV2aWNlICpkZXYsCj4gIAkJcmV0dXJuIHJldDsKPiAKPiAgCWlmIChpc19zdXBw
b3J0X3N3X3NtdShhZGV2KSkKPiAtCQlyZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+
c211LCBTTVVfU0NMSywgbWFzayk7Cj4gKwkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFk
ZXYtPnNtdSwgU01VX1NDTEssIG1hc2ssCj4gdHJ1ZSk7Cj4gIAllbHNlIGlmIChhZGV2LT5wb3dl
cnBsYXkucHBfZnVuY3MtPmZvcmNlX2Nsb2NrX2xldmVsKQo+ICAJCXJldCA9IGFtZGdwdV9kcG1f
Zm9yY2VfY2xvY2tfbGV2ZWwoYWRldiwgUFBfU0NMSywKPiBtYXNrKTsKPiAKPiBAQCAtMTAwNCw3
ICsxMDA0LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fbWNsayhzdHJ1Y3QK
PiBkZXZpY2UgKmRldiwKPiAgCQlyZXR1cm4gcmV0Owo+IAo+ICAJaWYgKGlzX3N1cHBvcnRfc3df
c211KGFkZXYpKQo+IC0JCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNN
VV9NQ0xLLAo+IG1hc2spOwo+ICsJCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5z
bXUsIFNNVV9NQ0xLLCBtYXNrLAo+IHRydWUpOwo+ICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5
LnBwX2Z1bmNzLT5mb3JjZV9jbG9ja19sZXZlbCkKPiAgCQlyZXQgPSBhbWRncHVfZHBtX2ZvcmNl
X2Nsb2NrX2xldmVsKGFkZXYsIFBQX01DTEssCj4gbWFzayk7Cj4gCj4gQEAgLTEwNDQsNyArMTA0
NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3NvY2NsayhzdHJ1Y3QKPiBk
ZXZpY2UgKmRldiwKPiAgCQlyZXR1cm4gcmV0Owo+IAo+ICAJaWYgKGlzX3N1cHBvcnRfc3dfc211
KGFkZXYpKQo+IC0JCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9T
T0NDTEssCj4gbWFzayk7Cj4gKwkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNt
dSwgU01VX1NPQ0NMSywKPiBtYXNrLCB0cnVlKTsKPiAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxh
eS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpCj4gIAkJcmV0ID0gYW1kZ3B1X2RwbV9mb3Jj
ZV9jbG9ja19sZXZlbChhZGV2LCBQUF9TT0NDTEssCj4gbWFzayk7Cj4gCj4gQEAgLTEwODQsNyAr
MTA4NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX2ZjbGsoc3RydWN0Cj4g
ZGV2aWNlICpkZXYsCj4gIAkJcmV0dXJuIHJldDsKPiAKPiAgCWlmIChpc19zdXBwb3J0X3N3X3Nt
dShhZGV2KSkKPiAtCQlyZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVf
RkNMSywgbWFzayk7Cj4gKwkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwg
U01VX0ZDTEssIG1hc2ssCj4gdHJ1ZSk7Cj4gIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBf
ZnVuY3MtPmZvcmNlX2Nsb2NrX2xldmVsKQo+ICAJCXJldCA9IGFtZGdwdV9kcG1fZm9yY2VfY2xv
Y2tfbGV2ZWwoYWRldiwgUFBfRkNMSywKPiBtYXNrKTsKPiAKPiBAQCAtMTEyNCw3ICsxMTI0LDcg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fZGNlZmNsayhzdHJ1Y3QKPiBkZXZp
Y2UgKmRldiwKPiAgCQlyZXR1cm4gcmV0Owo+IAo+ICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFk
ZXYpKQo+IC0JCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9EQ0VG
Q0xLLAo+IG1hc2spOwo+ICsJCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUs
IFNNVV9EQ0VGQ0xLLAo+IG1hc2ssIHRydWUpOwo+ICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5
LnBwX2Z1bmNzLT5mb3JjZV9jbG9ja19sZXZlbCkKPiAgCQlyZXQgPSBhbWRncHVfZHBtX2ZvcmNl
X2Nsb2NrX2xldmVsKGFkZXYsIFBQX0RDRUZDTEssCj4gbWFzayk7Cj4gCj4gQEAgLTExNjQsNyAr
MTE2NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3BjaWUoc3RydWN0Cj4g
ZGV2aWNlICpkZXYsCj4gIAkJcmV0dXJuIHJldDsKPiAKPiAgCWlmIChpc19zdXBwb3J0X3N3X3Nt
dShhZGV2KSkKPiAtCQlyZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVf
UENJRSwgbWFzayk7Cj4gKwkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwg
U01VX1BDSUUsIG1hc2ssCj4gdHJ1ZSk7Cj4gIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBf
ZnVuY3MtPmZvcmNlX2Nsb2NrX2xldmVsKQo+ICAJCXJldCA9IGFtZGdwdV9kcG1fZm9yY2VfY2xv
Y2tfbGV2ZWwoYWRldiwgUFBfUENJRSwgbWFzayk7Cj4gCj4gQEAgLTEzNTYsNyArMTM1Niw3IEBA
IHN0YXRpYyBzc2l6ZV90Cj4gYW1kZ3B1X3NldF9wcF9wb3dlcl9wcm9maWxlX21vZGUoc3RydWN0
IGRldmljZSAqZGV2LAo+ICAJfQo+ICAJcGFyYW1ldGVyW3BhcmFtZXRlcl9zaXplXSA9IHByb2Zp
bGVfbW9kZTsKPiAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPiAtCQlyZXQgPSBzbXVf
c2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZSgmYWRldi0+c211LAo+IHBhcmFtZXRlciwgcGFyYW1ldGVy
X3NpemUpOwo+ICsJCXJldCA9IHNtdV9zZXRfcG93ZXJfcHJvZmlsZV9tb2RlKCZhZGV2LT5zbXUs
Cj4gcGFyYW1ldGVyLCBwYXJhbWV0ZXJfc2l6ZSwgdHJ1ZSk7Cj4gIAllbHNlIGlmIChhZGV2LT5w
b3dlcnBsYXkucHBfZnVuY3MtPnNldF9wb3dlcl9wcm9maWxlX21vZGUpCj4gIAkJcmV0ID0gYW1k
Z3B1X2RwbV9zZXRfcG93ZXJfcHJvZmlsZV9tb2RlKGFkZXYsCj4gcGFyYW1ldGVyLCBwYXJhbWV0
ZXJfc2l6ZSk7Cj4gIAlpZiAoIXJldCkKPiBAQCAtMjA2NSw3ICsyMDY1LDcgQEAgc3RhdGljIHNz
aXplX3QKPiBhbWRncHVfaHdtb25fc2hvd19wb3dlcl9jYXBfbWF4KHN0cnVjdCBkZXZpY2UgKmRl
diwKPiAgCXVpbnQzMl90IGxpbWl0ID0gMDsKPiAKPiAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShh
ZGV2KSkgewo+IC0JCXNtdV9nZXRfcG93ZXJfbGltaXQoJmFkZXYtPnNtdSwgJmxpbWl0LCB0cnVl
KTsKPiArCQlzbXVfZ2V0X3Bvd2VyX2xpbWl0KCZhZGV2LT5zbXUsICZsaW1pdCwgdHJ1ZSwgdHJ1
ZSk7Cj4gIAkJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJXVcbiIsIGxpbWl0ICog
MTAwMDAwMCk7Cj4gIAl9IGVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcyAmJiBhZGV2
LT5wb3dlcnBsYXkucHBfZnVuY3MtCj4gPmdldF9wb3dlcl9saW1pdCkgewo+ICAJCWFkZXYtPnBv
d2VycGxheS5wcF9mdW5jcy0+Z2V0X3Bvd2VyX2xpbWl0KGFkZXYtCj4gPnBvd2VycGxheS5wcF9o
YW5kbGUsICZsaW1pdCwgdHJ1ZSk7Cj4gQEAgLTIwODMsNyArMjA4Myw3IEBAIHN0YXRpYyBzc2l6
ZV90Cj4gYW1kZ3B1X2h3bW9uX3Nob3dfcG93ZXJfY2FwKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAg
CXVpbnQzMl90IGxpbWl0ID0gMDsKPiAKPiAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkg
ewo+IC0JCXNtdV9nZXRfcG93ZXJfbGltaXQoJmFkZXYtPnNtdSwgJmxpbWl0LCBmYWxzZSk7Cj4g
KwkJc211X2dldF9wb3dlcl9saW1pdCgmYWRldi0+c211LCAmbGltaXQsIGZhbHNlLCAgdHJ1ZSk7
Cj4gIAkJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJXVcbiIsIGxpbWl0ICogMTAw
MDAwMCk7Cj4gIAl9IGVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcyAmJiBhZGV2LT5w
b3dlcnBsYXkucHBfZnVuY3MtCj4gPmdldF9wb3dlcl9saW1pdCkgewo+ICAJCWFkZXYtPnBvd2Vy
cGxheS5wcF9mdW5jcy0+Z2V0X3Bvd2VyX2xpbWl0KGFkZXYtCj4gPnBvd2VycGxheS5wcF9oYW5k
bGUsICZsaW1pdCwgZmFsc2UpOwo+IEBAIC0zMDY0LDcgKzMwNjQsOCBAQCB2b2lkIGFtZGdwdV9w
bV9jb21wdXRlX2Nsb2NrcyhzdHJ1Y3QKPiBhbWRncHVfZGV2aWNlICphZGV2KQo+ICAJCXN0cnVj
dCBzbXVfZHBtX2NvbnRleHQgKnNtdV9kcG0gPSAmYWRldi0KPiA+c211LnNtdV9kcG07Cj4gIAkJ
c211X2hhbmRsZV90YXNrKCZhZGV2LT5zbXUsCj4gIAkJCQlzbXVfZHBtLT5kcG1fbGV2ZWwsCj4g
LQo+IAlBTURfUFBfVEFTS19ESVNQTEFZX0NPTkZJR19DSEFOR0UpOwo+ICsJCQkJQU1EX1BQX1RB
U0tfRElTUExBWV9DT05GSUdfQ0hBTkdFLAo+ICsJCQkJdHJ1ZSk7Cj4gIAl9IGVsc2Ugewo+ICAJ
CWlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmRpc3BhdGNoX3Rhc2tzKSB7Cj4gIAkJCWlm
ICghYW1kZ3B1X2RldmljZV9oYXNfZGNfc3VwcG9ydChhZGV2KSkgewo+IGRpZmYgLS1naXQKPiBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX3BwX3NtdS5j
Cj4gYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbV9wcF9z
bXUuYwo+IGluZGV4IDEzNTIwMTk2NDhjMC4uZWU5OTE1ZDYxY2YxIDEwMDY0NAo+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX3BwX3NtdS5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG1fcHBf
c211LmMKPiBAQCAtODc2LDcgKzg3Niw3IEBAIGVudW0gcHBfc211X3N0YXR1cwo+IHBwX252X2dl
dF9tYXhpbXVtX3N1c3RhaW5hYmxlX2Nsb2NrcygKPiAgCWlmICghc211LT5mdW5jcy0+Z2V0X21h
eF9zdXN0YWluYWJsZV9jbG9ja3NfYnlfZGMpCj4gIAkJcmV0dXJuIFBQX1NNVV9SRVNVTFRfVU5T
VVBQT1JURUQ7Cj4gCj4gLQlpZiAoIXNtdS0+ZnVuY3MtPmdldF9tYXhfc3VzdGFpbmFibGVfY2xv
Y2tzX2J5X2RjKHNtdSwKPiBtYXhfY2xvY2tzKSkKPiArCWlmICghc211X2dldF9tYXhfc3VzdGFp
bmFibGVfY2xvY2tzX2J5X2RjKHNtdSwgbWF4X2Nsb2NrcykpCj4gIAkJcmV0dXJuIFBQX1NNVV9S
RVNVTFRfT0s7Cj4gCj4gIAlyZXR1cm4gUFBfU01VX1JFU1VMVF9GQUlMOwo+IEBAIC04OTUsNyAr
ODk1LDcgQEAgZW51bSBwcF9zbXVfc3RhdHVzCj4gcHBfbnZfZ2V0X3VjbGtfZHBtX3N0YXRlcyhz
dHJ1Y3QgcHBfc211ICpwcCwKPiAgCWlmICghc211LT5wcHRfZnVuY3MtPmdldF91Y2xrX2RwbV9z
dGF0ZXMpCj4gIAkJcmV0dXJuIFBQX1NNVV9SRVNVTFRfVU5TVVBQT1JURUQ7Cj4gCj4gLQlpZiAo
IXNtdS0+cHB0X2Z1bmNzLT5nZXRfdWNsa19kcG1fc3RhdGVzKHNtdSwKPiArCWlmICghc211X2dl
dF91Y2xrX2RwbV9zdGF0ZXMoc211LAo+ICAJCQljbG9ja192YWx1ZXNfaW5fa2h6LCBudW1fc3Rh
dGVzKSkKPiAgCQlyZXR1cm4gUFBfU01VX1JFU1VMVF9PSzsKPiAKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jCj4gYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL3Bvd2VycGxheS9hbWRncHVfc211LmMKPiBpbmRleCAyNmNhY2M4OTlkZmUuLjA4NDFk
OGM3OWU1YiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9hbWRn
cHVfc211LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9hbWRncHVfc211
LmMKPiBAQCAtNjcsNiArNjcsOCBAQCBzaXplX3Qgc211X3N5c19nZXRfcHBfZmVhdHVyZV9tYXNr
KHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUsIGNoYXIgKmJ1ZikKPiAgCXVpbnQzMl90IHNvcnRf
ZmVhdHVyZVtTTVVfRkVBVFVSRV9DT1VOVF07Cj4gIAl1aW50NjRfdCBod19mZWF0dXJlX2NvdW50
ID0gMDsKPiAKPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiAgCXJldCA9IHNtdV9m
ZWF0dXJlX2dldF9lbmFibGVkX21hc2soc211LCBmZWF0dXJlX21hc2ssIDIpOwo+ICAJaWYgKHJl
dCkKPiAgCQlnb3RvIGZhaWxlZDsKPiBAQCAtOTIsNiArOTQsOCBAQCBzaXplX3Qgc211X3N5c19n
ZXRfcHBfZmVhdHVyZV9tYXNrKHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUsIGNoYXIgKmJ1ZikK
PiAgCX0KPiAKPiAgZmFpbGVkOgo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4g
IAlyZXR1cm4gc2l6ZTsKPiAgfQo+IAo+IEBAIC0xNDksOSArMTUzLDExIEBAIGludCBzbXVfc3lz
X3NldF9wcF9mZWF0dXJlX21hc2soc3RydWN0Cj4gc211X2NvbnRleHQgKnNtdSwgdWludDY0X3Qg
bmV3X21hc2spCj4gIAl1aW50NjRfdCBmZWF0dXJlXzJfZGlzYWJsZWQgPSAwOwo+ICAJdWludDY0
X3QgZmVhdHVyZV9lbmFibGVzID0gMDsKPiAKPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+
ICsKPiAgCXJldCA9IHNtdV9mZWF0dXJlX2dldF9lbmFibGVkX21hc2soc211LCBmZWF0dXJlX21h
c2ssIDIpOwo+ICAJaWYgKHJldCkKPiAtCQlyZXR1cm4gcmV0Owo+ICsJCWdvdG8gb3V0Owo+IAo+
ICAJZmVhdHVyZV9lbmFibGVzID0gKCh1aW50NjRfdClmZWF0dXJlX21hc2tbMV0gPDwgMzIgfAo+
ICh1aW50NjRfdClmZWF0dXJlX21hc2tbMF0pOwo+IAo+IEBAIC0xNjEsMTQgKzE2NywxNyBAQCBp
bnQgc211X3N5c19zZXRfcHBfZmVhdHVyZV9tYXNrKHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUs
IHVpbnQ2NF90IG5ld19tYXNrKQo+ICAJaWYgKGZlYXR1cmVfMl9lbmFibGVkKSB7Cj4gIAkJcmV0
ID0gc211X2ZlYXR1cmVfdXBkYXRlX2VuYWJsZV9zdGF0ZShzbXUsCj4gZmVhdHVyZV8yX2VuYWJs
ZWQsIHRydWUpOwo+ICAJCWlmIChyZXQpCj4gLQkJCXJldHVybiByZXQ7Cj4gKwkJCWdvdG8gb3V0
Owo+ICAJfQo+ICAJaWYgKGZlYXR1cmVfMl9kaXNhYmxlZCkgewo+ICAJCXJldCA9IHNtdV9mZWF0
dXJlX3VwZGF0ZV9lbmFibGVfc3RhdGUoc211LAo+IGZlYXR1cmVfMl9kaXNhYmxlZCwgZmFsc2Up
Owo+ICAJCWlmIChyZXQpCj4gLQkJCXJldHVybiByZXQ7Cj4gKwkJCWdvdG8gb3V0Owo+ICAJfQo+
IAo+ICtvdXQ6Cj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiAgCXJldHVybiBy
ZXQ7Cj4gIH0KPiAKPiBAQCAtMjU0LDcgKzI2Myw3IEBAIGludCBzbXVfc2V0X2hhcmRfZnJlcV9y
YW5nZShzdHJ1Y3Qgc211X2NvbnRleHQKPiAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlw
ZSwKPiAgfQo+IAo+ICBpbnQgc211X2dldF9kcG1fZnJlcV9yYW5nZShzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSwgZW51bQo+IHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwKPiAtCQkJICAgdWludDMyX3Qg
Km1pbiwgdWludDMyX3QgKm1heCkKPiArCQkJICAgdWludDMyX3QgKm1pbiwgdWludDMyX3QgKm1h
eCwgYm9vbCBsb2NrX25lZWRlZCkKPiAgewo+ICAJdWludDMyX3QgY2xvY2tfbGltaXQ7Cj4gIAlp
bnQgcmV0ID0gMDsKPiBAQCAtMjYyLDYgKzI3MSw5IEBAIGludCBzbXVfZ2V0X2RwbV9mcmVxX3Jh
bmdlKHN0cnVjdCBzbXVfY29udGV4dAo+ICpzbXUsIGVudW0gc211X2Nsa190eXBlIGNsa190eXBl
LAo+ICAJaWYgKCFtaW4gJiYgIW1heCkKPiAgCQlyZXR1cm4gLUVJTlZBTDsKPiAKPiArCWlmIChs
b2NrX25lZWRlZCkKPiArCQltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gIAlpZiAoIXNt
dV9jbGtfZHBtX2lzX2VuYWJsZWQoc211LCBjbGtfdHlwZSkpIHsKPiAgCQlzd2l0Y2ggKGNsa190
eXBlKSB7Cj4gIAkJY2FzZSBTTVVfTUNMSzoKPiBAQCAtMjg1LDE0ICsyOTcsMTcgQEAgaW50IHNt
dV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc3RydWN0IHNtdV9jb250ZXh0Cj4gKnNtdSwgZW51bSBzbXVf
Y2xrX3R5cGUgY2xrX3R5cGUsCj4gIAkJCSptaW4gPSBjbG9ja19saW1pdCAvIDEwMDsKPiAgCQlp
ZiAobWF4KQo+ICAJCQkqbWF4ID0gY2xvY2tfbGltaXQgLyAxMDA7Cj4gLQo+IC0JCXJldHVybiAw
Owo+ICsJfSBlbHNlIHsKPiArCQkvKgo+ICsJCSAqIFRvZG86IFVzZSBlYWNoIGFzaWMoQVNJQ19w
cHQgZnVuY3MpIGNvbnRyb2wgdGhlIGNhbGxiYWNrcwo+IGV4cG9zZWQgdG8gdGhlCj4gKwkJICog
Y29yZSBkcml2ZXIgYW5kIHRoZW4gaGF2ZSBoZWxwZXJzIGZvciBzdHVmZiB0aGF0IGlzCj4gY29t
bW9uKFNNVV92MTFfeCB8IFNNVV92MTJfeCBmdW5jcykuCj4gKwkJICovCj4gKwkJcmV0ID0gc211
X2dldF9kcG1fdWx0aW1hdGVfZnJlcShzbXUsIGNsa190eXBlLCBtaW4sCj4gbWF4KTsKPiAgCX0K
PiAtCS8qCj4gLQkgKiBUb2RvOiBVc2UgZWFjaCBhc2ljKEFTSUNfcHB0IGZ1bmNzKSBjb250cm9s
IHRoZSBjYWxsYmFja3MgZXhwb3NlZAo+IHRvIHRoZQo+IC0JICogY29yZSBkcml2ZXIgYW5kIHRo
ZW4gaGF2ZSBoZWxwZXJzIGZvciBzdHVmZiB0aGF0IGlzCj4gY29tbW9uKFNNVV92MTFfeCB8IFNN
VV92MTJfeCBmdW5jcykuCj4gLQkgKi8KPiAtCXJldCA9IHNtdV9nZXRfZHBtX3VsdGltYXRlX2Zy
ZXEoc211LCBjbGtfdHlwZSwgbWluLCBtYXgpOwo+ICsKPiArCWlmIChsb2NrX25lZWRlZCkKPiAr
CQltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiAgCXJldHVybiByZXQ7Cj4gIH0KPiAK
PiBAQCAtMzY5LDYgKzM4NCw4IEBAIGludCBzbXVfZHBtX3NldF9wb3dlcl9nYXRlKHN0cnVjdCBz
bXVfY29udGV4dAo+ICpzbXUsIHVpbnQzMl90IGJsb2NrX3R5cGUsCj4gIHsKPiAgCWludCByZXQg
PSAwOwo+IAo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICAJc3dpdGNoIChibG9j
a190eXBlKSB7Cj4gIAljYXNlIEFNRF9JUF9CTE9DS19UWVBFX1VWRDoKPiAgCQlyZXQgPSBzbXVf
ZHBtX3NldF91dmRfZW5hYmxlKHNtdSwgZ2F0ZSk7Cj4gQEAgLTM4NiwxMyArNDAzLDkgQEAgaW50
IHNtdV9kcG1fc2V0X3Bvd2VyX2dhdGUoc3RydWN0IHNtdV9jb250ZXh0Cj4gKnNtdSwgdWludDMy
X3QgYmxvY2tfdHlwZSwKPiAgCQlicmVhazsKPiAgCX0KPiAKPiAtCXJldHVybiByZXQ7Cj4gLX0K
PiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gCj4gLWVudW0gYW1kX3BtX3N0YXRlX3R5
cGUgc211X2dldF9jdXJyZW50X3Bvd2VyX3N0YXRlKHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUp
Cj4gLXsKPiAtCS8qIG5vdCBzdXBwb3J0IHBvd2VyIHN0YXRlICovCj4gLQlyZXR1cm4gUE9XRVJf
U1RBVEVfVFlQRV9ERUZBVUxUOwo+ICsJcmV0dXJuIHJldDsKPiAgfQo+IAo+ICBpbnQgc211X2dl
dF9wb3dlcl9udW1fc3RhdGVzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAo+IEBAIC01MjAsMTYg
KzUzMywyMyBAQCBib29sIGlzX3N1cHBvcnRfc3dfc211X3hnbWkoc3RydWN0Cj4gYW1kZ3B1X2Rl
dmljZSAqYWRldikKPiAgaW50IHNtdV9zeXNfZ2V0X3BwX3RhYmxlKHN0cnVjdCBzbXVfY29udGV4
dCAqc211LCB2b2lkICoqdGFibGUpCj4gIHsKPiAgCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAq
c211X3RhYmxlID0gJnNtdS0+c211X3RhYmxlOwo+ICsJdWludDMyX3QgcG93ZXJwbGF5X3RhYmxl
X3NpemU7Cj4gCj4gIAlpZiAoIXNtdV90YWJsZS0+cG93ZXJfcGxheV90YWJsZSAmJiAhc211X3Rh
YmxlLQo+ID5oYXJkY29kZV9wcHRhYmxlKQo+ICAJCXJldHVybiAtRUlOVkFMOwo+IAo+ICsJbXV0
ZXhfbG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICAJaWYgKHNtdV90YWJsZS0+aGFyZGNvZGVfcHB0
YWJsZSkKPiAgCQkqdGFibGUgPSBzbXVfdGFibGUtPmhhcmRjb2RlX3BwdGFibGU7Cj4gIAllbHNl
Cj4gIAkJKnRhYmxlID0gc211X3RhYmxlLT5wb3dlcl9wbGF5X3RhYmxlOwo+IAo+IC0JcmV0dXJu
IHNtdV90YWJsZS0+cG93ZXJfcGxheV90YWJsZV9zaXplOwo+ICsJcG93ZXJwbGF5X3RhYmxlX3Np
emUgPSBzbXVfdGFibGUtPnBvd2VyX3BsYXlfdGFibGVfc2l6ZTsKPiArCj4gKwltdXRleF91bmxv
Y2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJldHVybiBwb3dlcnBsYXlfdGFibGVfc2l6ZTsKPiAg
fQo+IAo+ICBpbnQgc211X3N5c19zZXRfcHBfdGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUs
ICB2b2lkICpidWYsIHNpemVfdCBzaXplKQo+IEBAIC01NTYsMTQgKzU3NiwxMSBAQCBpbnQgc211
X3N5c19zZXRfcHBfdGFibGUoc3RydWN0IHNtdV9jb250ZXh0Cj4gKnNtdSwgIHZvaWQgKmJ1Ziwg
c2l6ZV90IHNpemUpCj4gIAltZW1jcHkoc211X3RhYmxlLT5oYXJkY29kZV9wcHRhYmxlLCBidWYs
IHNpemUpOwo+ICAJc211X3RhYmxlLT5wb3dlcl9wbGF5X3RhYmxlID0gc211X3RhYmxlLT5oYXJk
Y29kZV9wcHRhYmxlOwo+ICAJc211X3RhYmxlLT5wb3dlcl9wbGF5X3RhYmxlX3NpemUgPSBzaXpl
Owo+IC0JbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiAKPiAgCXJldCA9IHNtdV9yZXNldChz
bXUpOwo+ICAJaWYgKHJldCkKPiAgCQlwcl9pbmZvKCJzbXUgcmVzZXQgZmFpbGVkLCByZXQgPSAl
ZFxuIiwgcmV0KTsKPiAKPiAtCXJldHVybiByZXQ7Cj4gLQo+ICBmYWlsZWQ6Cj4gIAltdXRleF91
bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICAJcmV0dXJuIHJldDsKPiBAQCAtNzI2LDExICs3NDMsMTAg
QEAgc3RhdGljIGludCBzbXVfbGF0ZV9pbml0KHZvaWQgKmhhbmRsZSkKPiAgCWlmICghc211LT5w
bV9lbmFibGVkKQo+ICAJCXJldHVybiAwOwo+IAo+IC0JbXV0ZXhfbG9jaygmc211LT5tdXRleCk7
Cj4gIAlzbXVfaGFuZGxlX3Rhc2soJmFkZXYtPnNtdSwKPiAgCQkJc211LT5zbXVfZHBtLmRwbV9s
ZXZlbCwKPiAtCQkJQU1EX1BQX1RBU0tfQ09NUExFVEVfSU5JVCk7Cj4gLQltdXRleF91bmxvY2so
JnNtdS0+bXV0ZXgpOwo+ICsJCQlBTURfUFBfVEFTS19DT01QTEVURV9JTklULAo+ICsJCQlmYWxz
ZSk7Cj4gCj4gIAlyZXR1cm4gMDsKPiAgfQo+IEBAIC0xMDc0LDcgKzEwOTAsNyBAQCBzdGF0aWMg
aW50IHNtdV9zbWNfdGFibGVfaHdfaW5pdChzdHJ1Y3QKPiBzbXVfY29udGV4dCAqc211LAo+ICAJ
CWlmIChyZXQpCj4gIAkJCXJldHVybiByZXQ7Cj4gCj4gLQkJcmV0ID0gc211X2dldF9wb3dlcl9s
aW1pdChzbXUsICZzbXUtCj4gPmRlZmF1bHRfcG93ZXJfbGltaXQsIHRydWUpOwo+ICsJCXJldCA9
IHNtdV9nZXRfcG93ZXJfbGltaXQoc211LCAmc211LQo+ID5kZWZhdWx0X3Bvd2VyX2xpbWl0LCB0
cnVlLCBmYWxzZSk7Cj4gIAkJaWYgKHJldCkKPiAgCQkJcmV0dXJuIHJldDsKPiAgCX0KPiBAQCAt
MTE2MCwxNSArMTE3NiwxOSBAQCBzdGF0aWMgaW50IHNtdV9zdGFydF9zbWNfZW5naW5lKHN0cnVj
dAo+IHNtdV9jb250ZXh0ICpzbXUpCj4gCj4gIAlpZiAoYWRldi0+ZmlybXdhcmUubG9hZF90eXBl
ICE9IEFNREdQVV9GV19MT0FEX1BTUCkgewo+ICAJCWlmIChhZGV2LT5hc2ljX3R5cGUgPCBDSElQ
X05BVkkxMCkgewo+IC0JCQlyZXQgPSBzbXVfbG9hZF9taWNyb2NvZGUoc211KTsKPiAtCQkJaWYg
KHJldCkKPiAtCQkJCXJldHVybiByZXQ7Cj4gKwkJCWlmIChzbXUtPmZ1bmNzLT5sb2FkX21pY3Jv
Y29kZSkgewo+ICsJCQkJcmV0ID0gc211LT5mdW5jcy0+bG9hZF9taWNyb2NvZGUoc211KTsKPiAr
CQkJCWlmIChyZXQpCj4gKwkJCQkJcmV0dXJuIHJldDsKPiArCQkJfQo+ICAJCX0KPiAgCX0KPiAK
PiAtCXJldCA9IHNtdV9jaGVja19md19zdGF0dXMoc211KTsKPiAtCWlmIChyZXQpCj4gLQkJcHJf
ZXJyKCJTTUMgaXMgbm90IHJlYWR5XG4iKTsKPiArCWlmIChzbXUtPmZ1bmNzLT5jaGVja19md19z
dGF0dXMpIHsKPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5jaGVja19md19zdGF0dXMoc211KTsKPiAr
CQlpZiAocmV0KQo+ICsJCQlwcl9lcnIoIlNNQyBpcyBub3QgcmVhZHlcbiIpOwo+ICsJfQo+IAo+
ICAJcmV0dXJuIHJldDsKPiAgfQo+IEBAIC0xMzM0LDggKzEzNTQsNiBAQCBzdGF0aWMgaW50IHNt
dV9yZXN1bWUodm9pZCAqaGFuZGxlKQo+IAo+ICAJcHJfaW5mbygiU01VIGlzIHJlc3VtaW5nLi4u
XG4iKTsKPiAKPiAtCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+IC0KPiAgCXJldCA9IHNtdV9z
dGFydF9zbWNfZW5naW5lKHNtdSk7Cj4gIAlpZiAocmV0KSB7Cj4gIAkJcHJfZXJyKCJTTVUgaXMg
bm90IHJlYWR5IHlldCFcbiIpOwo+IEBAIC0xMzUwLDEzICsxMzY4LDExIEBAIHN0YXRpYyBpbnQg
c211X3Jlc3VtZSh2b2lkICpoYW5kbGUpCj4gIAlpZiAocmV0KQo+ICAJCWdvdG8gZmFpbGVkOwo+
IAo+IC0JbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiAtCj4gIAlwcl9pbmZvKCJTTVUgaXMg
cmVzdW1lZCBzdWNjZXNzZnVsbHkhXG4iKTsKPiAKPiAgCXJldHVybiAwOwo+ICsKPiAgZmFpbGVk
Ogo+IC0JbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiAgCXJldHVybiByZXQ7Cj4gIH0KPiAK
PiBAQCAtMTM3NCw4ICsxMzkwLDkgQEAgaW50IHNtdV9kaXNwbGF5X2NvbmZpZ3VyYXRpb25fY2hh
bmdlKHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUsCj4gCj4gIAltdXRleF9sb2NrKCZzbXUtPm11
dGV4KTsKPiAKPiAtCXNtdV9zZXRfZGVlcF9zbGVlcF9kY2VmY2xrKHNtdSwKPiAtCQkJCSAgIGRp
c3BsYXlfY29uZmlnLQo+ID5taW5fZGNlZl9kZWVwX3NsZWVwX3NldF9jbGsgLyAxMDApOwo+ICsJ
aWYgKHNtdS0+ZnVuY3MtPnNldF9kZWVwX3NsZWVwX2RjZWZjbGspCj4gKwkJc211LT5mdW5jcy0+
c2V0X2RlZXBfc2xlZXBfZGNlZmNsayhzbXUsCj4gKwkJCQlkaXNwbGF5X2NvbmZpZy0KPiA+bWlu
X2RjZWZfZGVlcF9zbGVlcF9zZXRfY2xrIC8gMTAwKTsKPiAKPiAgCWZvciAoaW5kZXggPSAwOyBp
bmRleCA8IGRpc3BsYXlfY29uZmlnLQo+ID5udW1fcGF0aF9pbmNsdWRpbmdfbm9uX2Rpc3BsYXk7
IGluZGV4KyspIHsKPiAgCQlpZiAoZGlzcGxheV9jb25maWctPmRpc3BsYXlzW2luZGV4XS5jb250
cm9sbGVyX2lkICE9IDApCj4gQEAgLTE1NTMsOSArMTU3MCw5IEBAIHN0YXRpYyBpbnQKPiBzbXVf
ZGVmYXVsdF9zZXRfcGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVu
dW0KPiBhbWRfZAo+ICAJCQkJCQkgJnNvY19tYXNrKTsKPiAgCQlpZiAocmV0KQo+ICAJCQlyZXR1
cm4gcmV0Owo+IC0JCXNtdV9mb3JjZV9jbGtfbGV2ZWxzKHNtdSwgU01VX1NDTEssIDEgPDwgc2Ns
a19tYXNrKTsKPiAtCQlzbXVfZm9yY2VfY2xrX2xldmVscyhzbXUsIFNNVV9NQ0xLLCAxIDw8IG1j
bGtfbWFzayk7Cj4gLQkJc211X2ZvcmNlX2Nsa19sZXZlbHMoc211LCBTTVVfU09DQ0xLLCAxIDw8
IHNvY19tYXNrKTsKPiArCQlzbXVfZm9yY2VfY2xrX2xldmVscyhzbXUsIFNNVV9TQ0xLLCAxIDw8
IHNjbGtfbWFzaywKPiBmYWxzZSk7Cj4gKwkJc211X2ZvcmNlX2Nsa19sZXZlbHMoc211LCBTTVVf
TUNMSywgMSA8PCBtY2xrX21hc2ssCj4gZmFsc2UpOwo+ICsJCXNtdV9mb3JjZV9jbGtfbGV2ZWxz
KHNtdSwgU01VX1NPQ0NMSywgMSA8PCBzb2NfbWFzaywKPiBmYWxzZSk7Cj4gIAkJYnJlYWs7Cj4g
IAljYXNlIEFNRF9EUE1fRk9SQ0VEX0xFVkVMX01BTlVBTDoKPiAgCWNhc2UgQU1EX0RQTV9GT1JD
RURfTEVWRUxfUFJPRklMRV9FWElUOgo+IEBAIC0xNjE5LDcgKzE2MzYsNyBAQCBpbnQgc211X2Fk
anVzdF9wb3dlcl9zdGF0ZV9keW5hbWljKHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUsCj4gIAkJ
d29ya2xvYWQgPSBzbXUtPndvcmtsb2FkX3NldHRpbmdbaW5kZXhdOwo+IAo+ICAJCWlmIChzbXUt
PnBvd2VyX3Byb2ZpbGVfbW9kZSAhPSB3b3JrbG9hZCkKPiAtCQkJc211X3NldF9wb3dlcl9wcm9m
aWxlX21vZGUoc211LCAmd29ya2xvYWQsIDApOwo+ICsJCQlzbXVfc2V0X3Bvd2VyX3Byb2ZpbGVf
bW9kZShzbXUsICZ3b3JrbG9hZCwgMCwKPiBmYWxzZSk7Cj4gIAl9Cj4gCj4gIAlyZXR1cm4gcmV0
Owo+IEBAIC0xNjI3LDE4ICsxNjQ0LDIyIEBAIGludCBzbXVfYWRqdXN0X3Bvd2VyX3N0YXRlX2R5
bmFtaWMoc3RydWN0Cj4gc211X2NvbnRleHQgKnNtdSwKPiAKPiAgaW50IHNtdV9oYW5kbGVfdGFz
ayhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKPiAgCQkgICAgZW51bSBhbWRfZHBtX2ZvcmNlZF9s
ZXZlbCBsZXZlbCwKPiAtCQkgICAgZW51bSBhbWRfcHBfdGFzayB0YXNrX2lkKQo+ICsJCSAgICBl
bnVtIGFtZF9wcF90YXNrIHRhc2tfaWQsCj4gKwkJICAgIGJvb2wgbG9ja19uZWVkZWQpCj4gIHsK
PiAgCWludCByZXQgPSAwOwo+IAo+ICsJaWYgKGxvY2tfbmVlZGVkKQo+ICsJCW11dGV4X2xvY2so
JnNtdS0+bXV0ZXgpOwo+ICsKPiAgCXN3aXRjaCAodGFza19pZCkgewo+ICAJY2FzZSBBTURfUFBf
VEFTS19ESVNQTEFZX0NPTkZJR19DSEFOR0U6Cj4gIAkJcmV0ID0gc211X3ByZV9kaXNwbGF5X2Nv
bmZpZ19jaGFuZ2VkKHNtdSk7Cj4gIAkJaWYgKHJldCkKPiAtCQkJcmV0dXJuIHJldDsKPiArCQkJ
Z290byBvdXQ7Cj4gIAkJcmV0ID0gc211X3NldF9jcHVfcG93ZXJfc3RhdGUoc211KTsKPiAgCQlp
ZiAocmV0KQo+IC0JCQlyZXR1cm4gcmV0Owo+ICsJCQlnb3RvIG91dDsKPiAgCQlyZXQgPSBzbXVf
YWRqdXN0X3Bvd2VyX3N0YXRlX2R5bmFtaWMoc211LCBsZXZlbCwgZmFsc2UpOwo+ICAJCWJyZWFr
Owo+ICAJY2FzZSBBTURfUFBfVEFTS19DT01QTEVURV9JTklUOgo+IEBAIC0xNjQ5LDYgKzE2NzAs
MTAgQEAgaW50IHNtdV9oYW5kbGVfdGFzayhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKPiAgCQli
cmVhazsKPiAgCX0KPiAKPiArb3V0Ogo+ICsJaWYgKGxvY2tfbmVlZGVkKQo+ICsJCW11dGV4X3Vu
bG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICAJcmV0dXJuIHJldDsKPiAgfQo+IAo+IEBAIC0xNjgx
LDcgKzE3MDYsNyBAQCBpbnQgc211X3N3aXRjaF9wb3dlcl9wcm9maWxlKHN0cnVjdCBzbXVfY29u
dGV4dAo+ICpzbXUsCj4gIAl9Cj4gCj4gIAlpZiAoc211X2RwbV9jdHgtPmRwbV9sZXZlbCAhPQo+
IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX01BTlVBTCkKPiAtCQlzbXVfc2V0X3Bvd2VyX3Byb2ZpbGVf
bW9kZShzbXUsICZ3b3JrbG9hZCwgMCk7Cj4gKwkJc211X3NldF9wb3dlcl9wcm9maWxlX21vZGUo
c211LCAmd29ya2xvYWQsIDAsIGZhbHNlKTsKPiAKPiAgCW11dGV4X3VubG9jaygmc211LT5tdXRl
eCk7Cj4gCj4gQEAgLTE3MTEsMTIgKzE3MzYsMTkgQEAgaW50IHNtdV9mb3JjZV9wZXJmb3JtYW5j
ZV9sZXZlbChzdHJ1Y3QKPiBzbXVfY29udGV4dCAqc211LCBlbnVtIGFtZF9kcG1fZm9yY2VkX2xl
dgo+ICAJaWYgKCFzbXUtPmlzX2FwdSAmJiAhc211X2RwbV9jdHgtPmRwbV9jb250ZXh0KQo+ICAJ
CXJldHVybiAtRUlOVkFMOwo+IAo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICAJ
cmV0ID0gc211X2VuYWJsZV91bWRfcHN0YXRlKHNtdSwgJmxldmVsKTsKPiAtCWlmIChyZXQpCj4g
KwlpZiAocmV0KSB7Cj4gKwkJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiAgCQlyZXR1cm4g
cmV0Owo+ICsJfQo+IAo+ICAJcmV0ID0gc211X2hhbmRsZV90YXNrKHNtdSwgbGV2ZWwsCj4gLQkJ
CSAgICAgIEFNRF9QUF9UQVNLX1JFQURKVVNUX1BPV0VSX1NUQVRFKTsKPiArCQkJICAgICAgQU1E
X1BQX1RBU0tfUkVBREpVU1RfUE9XRVJfU1RBVEUsCj4gKwkJCSAgICAgIGZhbHNlKTsKPiArCj4g
KwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+IAo+ICAJcmV0dXJuIHJldDsKPiAgfQo+IEBA
IC0xNzM0LDcgKzE3NjYsOCBAQCBpbnQgc211X3NldF9kaXNwbGF5X2NvdW50KHN0cnVjdCBzbXVf
Y29udGV4dAo+ICpzbXUsIHVpbnQzMl90IGNvdW50KQo+IAo+ICBpbnQgc211X2ZvcmNlX2Nsa19s
ZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCj4gIAkJCSBlbnVtIHNtdV9jbGtfdHlwZSBj
bGtfdHlwZSwKPiAtCQkJIHVpbnQzMl90IG1hc2spCj4gKwkJCSB1aW50MzJfdCBtYXNrLAo+ICsJ
CQkgYm9vbCBsb2NrX25lZWRlZCkKPiAgewo+ICAJc3RydWN0IHNtdV9kcG1fY29udGV4dCAqc211
X2RwbV9jdHggPSAmKHNtdS0+c211X2RwbSk7Cj4gIAlpbnQgcmV0ID0gMDsKPiBAQCAtMTc0NCw5
ICsxNzc3LDE1IEBAIGludCBzbXVfZm9yY2VfY2xrX2xldmVscyhzdHJ1Y3Qgc211X2NvbnRleHQK
PiAqc211LAo+ICAJCXJldHVybiAtRUlOVkFMOwo+ICAJfQo+IAo+ICsJaWYgKGxvY2tfbmVlZGVk
KQo+ICsJCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiAgCWlmIChzbXUtPnBwdF9mdW5j
cyAmJiBzbXUtPnBwdF9mdW5jcy0+Zm9yY2VfY2xrX2xldmVscykKPiAgCQlyZXQgPSBzbXUtPnBw
dF9mdW5jcy0+Zm9yY2VfY2xrX2xldmVscyhzbXUsIGNsa190eXBlLAo+IG1hc2spOwo+IAo+ICsJ
aWYgKGxvY2tfbmVlZGVkKQo+ICsJCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICAJ
cmV0dXJuIHJldDsKPiAgfQo+IAo+IEBAIC0xNzY0LDYgKzE4MDMsOCBAQCBpbnQgc211X3NldF9t
cDFfc3RhdGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCj4gIAlpZiAoIXNtdS0+cG1fZW5hYmxl
ZCkKPiAgCQlyZXR1cm4gMDsKPiAKPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiAg
CXN3aXRjaCAobXAxX3N0YXRlKSB7Cj4gIAljYXNlIFBQX01QMV9TVEFURV9TSFVURE9XTjoKPiAg
CQltc2cgPSBTTVVfTVNHX1ByZXBhcmVNcDFGb3JTaHV0ZG93bjsKPiBAQCAtMTc3NiwxNyArMTgx
NywyMiBAQCBpbnQgc211X3NldF9tcDFfc3RhdGUoc3RydWN0IHNtdV9jb250ZXh0Cj4gKnNtdSwK
PiAgCQlicmVhazsKPiAgCWNhc2UgUFBfTVAxX1NUQVRFX05PTkU6Cj4gIAlkZWZhdWx0Ogo+ICsJ
CW11dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gIAkJcmV0dXJuIDA7Cj4gIAl9Cj4gCj4gIAkv
KiBzb21lIGFzaWNzIG1heSBub3Qgc3VwcG9ydCB0aG9zZSBtZXNzYWdlcyAqLwo+IC0JaWYgKHNt
dV9tc2dfZ2V0X2luZGV4KHNtdSwgbXNnKSA8IDApCj4gKwlpZiAoc211X21zZ19nZXRfaW5kZXgo
c211LCBtc2cpIDwgMCkgewo+ICsJCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gIAkJcmV0
dXJuIDA7Cj4gKwl9Cj4gCj4gIAlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnKHNtdSwgbXNnKTsKPiAg
CWlmIChyZXQpCj4gIAkJcHJfZXJyKCJbUHJlcGFyZU1wMV0gRmFpbGVkIVxuIik7Cj4gCj4gKwlt
dXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiAgCXJldHVybiByZXQ7Cj4gIH0KPiAKPiBA
QCAtMTgwNiwxMCArMTg1MiwxNCBAQCBpbnQgc211X3NldF9kZl9jc3RhdGUoc3RydWN0IHNtdV9j
b250ZXh0Cj4gKnNtdSwKPiAgCWlmICghc211LT5wcHRfZnVuY3MgfHwgIXNtdS0+cHB0X2Z1bmNz
LT5zZXRfZGZfY3N0YXRlKQo+ICAJCXJldHVybiAwOwo+IAo+ICsJbXV0ZXhfbG9jaygmc211LT5t
dXRleCk7Cj4gKwo+ICAJcmV0ID0gc211LT5wcHRfZnVuY3MtPnNldF9kZl9jc3RhdGUoc211LCBz
dGF0ZSk7Cj4gIAlpZiAocmV0KQo+ICAJCXByX2VycigiW1NldERmQ3N0YXRlXSBmYWlsZWQhXG4i
KTsKPiAKPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICAJcmV0dXJuIHJldDsK
PiAgfQo+IAo+IEBAIC0xODQ5LDMgKzE4OTksNTQ5IEBAIGNvbnN0IHN0cnVjdCBhbWRncHVfaXBf
YmxvY2tfdmVyc2lvbgo+IHNtdV92MTJfMF9pcF9ibG9jayA9Cj4gIAkucmV2ID0gMCwKPiAgCS5m
dW5jcyA9ICZzbXVfaXBfZnVuY3MsCj4gIH07Cj4gKwo+ICtpbnQgc211X2xvYWRfbWljcm9jb2Rl
KHN0cnVjdCBzbXVfY29udGV4dCAqc211KQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwlt
dXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5mdW5jcy0+bG9hZF9taWNy
b2NvZGUpCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+bG9hZF9taWNyb2NvZGUoc211KTsKPiArCj4g
KwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiAr
Cj4gK2ludCBzbXVfY2hlY2tfZndfc3RhdHVzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQo+ICt7
Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4g
KwlpZiAoc211LT5mdW5jcy0+Y2hlY2tfZndfc3RhdHVzKQo+ICsJCXJldCA9IHNtdS0+ZnVuY3Mt
PmNoZWNrX2Z3X3N0YXR1cyhzbXUpOwo+ICsKPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7
Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiAraW50IHNtdV9zZXRfZ2Z4X2NncGcoc3Ry
dWN0IHNtdV9jb250ZXh0ICpzbXUsIGJvb2wgZW5hYmxlZCkKPiArewo+ICsJaW50IHJldCA9IDA7
Cj4gKwo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJaWYgKHNtdS0+ZnVuY3Mt
PnNldF9nZnhfY2dwZykKPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5zZXRfZ2Z4X2NncGcoc211LCBl
bmFibGVkKTsKPiArCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJldHVy
biByZXQ7Cj4gK30KPiArCj4gK2ludCBzbXVfc2V0X2Zhbl9zcGVlZF9ycG0oc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUsIHVpbnQzMl90IHNwZWVkKQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4g
KwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5mdW5jcy0+c2V0X2Zh
bl9zcGVlZF9ycG0pCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+c2V0X2Zhbl9zcGVlZF9ycG0oc211
LCBzcGVlZCk7Cj4gKwo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlyZXR1
cm4gcmV0Owo+ICt9Cj4gKwo+ICtpbnQgc211X2dldF9wb3dlcl9saW1pdChzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSwKPiArCQkJdWludDMyX3QgKmxpbWl0LAo+ICsJCQlib29sIGRlZiwKPiArCQkJ
Ym9vbCBsb2NrX25lZWRlZCkKPiArewo+ICsJaW50IHJldCA9IDA7Cj4gKwo+ICsJaWYgKGxvY2tf
bmVlZGVkKQo+ICsJCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCWlmIChzbXUtPnBw
dF9mdW5jcy0+Z2V0X3Bvd2VyX2xpbWl0KQo+ICsJCXJldCA9IHNtdS0+cHB0X2Z1bmNzLT5nZXRf
cG93ZXJfbGltaXQoc211LCBsaW1pdCwgZGVmKTsKPiArCj4gKwlpZiAobG9ja19uZWVkZWQpCj4g
KwkJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4g
Kwo+ICtpbnQgc211X3NldF9wb3dlcl9saW1pdChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWlu
dDMyX3QgbGltaXQpCj4gK3sKPiArCWludCByZXQgPSAwOwo+ICsKPiArCW11dGV4X2xvY2soJnNt
dS0+bXV0ZXgpOwo+ICsKPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRfcG93ZXJfbGltaXQpCj4gKwkJ
cmV0ID0gc211LT5mdW5jcy0+c2V0X3Bvd2VyX2xpbWl0KHNtdSwgbGltaXQpOwo+ICsKPiArCW11
dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiAr
aW50IHNtdV9wcmludF9jbGtfbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNt
dV9jbGtfdHlwZQo+IGNsa190eXBlLCBjaGFyICpidWYpCj4gK3sKPiArCWludCByZXQgPSAwOwo+
ICsKPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCWlmIChzbXUtPnBwdF9mdW5j
cy0+cHJpbnRfY2xrX2xldmVscykKPiArCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+cHJpbnRfY2xr
X2xldmVscyhzbXUsIGNsa190eXBlLCBidWYpOwo+ICsKPiArCW11dGV4X3VubG9jaygmc211LT5t
dXRleCk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiAraW50IHNtdV9nZXRfb2RfcGVy
Y2VudGFnZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bQo+IHNtdV9jbGtfdHlwZSB0eXBl
KQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsK
PiArCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPmdldF9vZF9wZXJjZW50YWdlKQo+ICsJCXJldCA9
IHNtdS0+cHB0X2Z1bmNzLT5nZXRfb2RfcGVyY2VudGFnZShzbXUsIHR5cGUpOwo+ICsKPiArCW11
dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiAr
aW50IHNtdV9zZXRfb2RfcGVyY2VudGFnZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bQo+
IHNtdV9jbGtfdHlwZSB0eXBlLCB1aW50MzJfdCB2YWx1ZSkKPiArewo+ICsJaW50IHJldCA9IDA7
Cj4gKwo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJaWYgKHNtdS0+cHB0X2Z1
bmNzLT5zZXRfb2RfcGVyY2VudGFnZSkKPiArCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+c2V0X29k
X3BlcmNlbnRhZ2Uoc211LCB0eXBlLAo+IHZhbHVlKTsKPiArCj4gKwltdXRleF91bmxvY2soJnNt
dS0+bXV0ZXgpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK2ludCBzbXVfb2RfZWRp
dF9kcG1fdGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCj4gKwkJCSAgZW51bSBQUF9PRF9E
UE1fVEFCTEVfQ09NTUFORCB0eXBlLAo+ICsJCQkgIGxvbmcgKmlucHV0LCB1aW50MzJfdCBzaXpl
KQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsK
PiArCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPm9kX2VkaXRfZHBtX3RhYmxlKQo+ICsJCXJldCA9
IHNtdS0+cHB0X2Z1bmNzLT5vZF9lZGl0X2RwbV90YWJsZShzbXUsIHR5cGUsCj4gaW5wdXQsIHNp
emUpOwo+ICsKPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJcmV0dXJuIHJl
dDsKPiArfQo+ICsKPiAraW50IHNtdV9yZWFkX3NlbnNvcihzdHJ1Y3Qgc211X2NvbnRleHQgKnNt
dSwKPiArCQkgICAgZW51bSBhbWRfcHBfc2Vuc29ycyBzZW5zb3IsCj4gKwkJICAgIHZvaWQgKmRh
dGEsIHVpbnQzMl90ICpzaXplKQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwltdXRleF9s
b2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPnJlYWRfc2Vuc29y
KQo+ICsJCXJldCA9IHNtdS0+cHB0X2Z1bmNzLT5yZWFkX3NlbnNvcihzbXUsIHNlbnNvciwgZGF0
YSwKPiBzaXplKTsKPiArCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJl
dHVybiByZXQ7Cj4gK30KPiArCj4gK2ludCBzbXVfZ2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSwgY2hhciAqYnVmKQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiAr
Cj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5wcHRfZnVuY3Mt
PmdldF9wb3dlcl9wcm9maWxlX21vZGUpCj4gKwkJcmV0ID0gc211LT5wcHRfZnVuY3MtPmdldF9w
b3dlcl9wcm9maWxlX21vZGUoc211LCBidWYpOwo+ICsKPiArCW11dGV4X3VubG9jaygmc211LT5t
dXRleCk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiAraW50IHNtdV9zZXRfcG93ZXJf
cHJvZmlsZV9tb2RlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAo+ICsJCQkgICAgICAgbG9uZyAq
cGFyYW0sCj4gKwkJCSAgICAgICB1aW50MzJfdCBwYXJhbV9zaXplLAo+ICsJCQkgICAgICAgYm9v
bCBsb2NrX25lZWRlZCkKPiArewo+ICsJaW50IHJldCA9IDA7Cj4gKwo+ICsJaWYgKGxvY2tfbmVl
ZGVkKQo+ICsJCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCWlmIChzbXUtPnBwdF9m
dW5jcy0+c2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZSkKPiArCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+
c2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZShzbXUsCj4gcGFyYW0sIHBhcmFtX3NpemUpOwo+ICsKPiAr
CWlmIChsb2NrX25lZWRlZCkKPiArCQltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiAr
CXJldHVybiByZXQ7Cj4gK30KPiArCj4gKwo+ICtpbnQgc211X2dldF9mYW5fY29udHJvbF9tb2Rl
KHN0cnVjdCBzbXVfY29udGV4dCAqc211KQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwlt
dXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5mdW5jcy0+Z2V0X2Zhbl9j
b250cm9sX21vZGUpCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+Z2V0X2Zhbl9jb250cm9sX21vZGUo
c211KTsKPiArCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJldHVybiBy
ZXQ7Cj4gK30KPiArCj4gK2ludCBzbXVfc2V0X2Zhbl9jb250cm9sX21vZGUoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUsIGludCB2YWx1ZSkKPiArewo+ICsJaW50IHJldCA9IDA7Cj4gKwo+ICsJbXV0
ZXhfbG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJaWYgKHNtdS0+ZnVuY3MtPnNldF9mYW5fY29u
dHJvbF9tb2RlKQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPnNldF9mYW5fY29udHJvbF9tb2RlKHNt
dSwgdmFsdWUpOwo+ICsKPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJcmV0
dXJuIHJldDsKPiArfQo+ICsKPiAraW50IHNtdV9nZXRfZmFuX3NwZWVkX3BlcmNlbnQoc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQzMl90Cj4gKnNwZWVkKQo+ICt7Cj4gKwlpbnQgcmV0ID0g
MDsKPiArCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5wcHRf
ZnVuY3MtPmdldF9mYW5fc3BlZWRfcGVyY2VudCkKPiArCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+
Z2V0X2Zhbl9zcGVlZF9wZXJjZW50KHNtdSwKPiBzcGVlZCk7Cj4gKwo+ICsJbXV0ZXhfdW5sb2Nr
KCZzbXUtPm11dGV4KTsKPiArCj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtpbnQgc211X3Nl
dF9mYW5fc3BlZWRfcGVyY2VudChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDMyX3QKPiBz
cGVlZCkKPiArewo+ICsJaW50IHJldCA9IDA7Cj4gKwo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRl
eCk7Cj4gKwo+ICsJaWYgKHNtdS0+ZnVuY3MtPnNldF9mYW5fc3BlZWRfcGVyY2VudCkKPiArCQly
ZXQgPSBzbXUtPmZ1bmNzLT5zZXRfZmFuX3NwZWVkX3BlcmNlbnQoc211LCBzcGVlZCk7Cj4gKwo+
ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4g
Kwo+ICtpbnQgc211X2dldF9mYW5fc3BlZWRfcnBtKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1
aW50MzJfdCAqc3BlZWQpCj4gK3sKPiArCWludCByZXQgPSAwOwo+ICsKPiArCW11dGV4X2xvY2so
JnNtdS0+bXV0ZXgpOwo+ICsKPiArCWlmIChzbXUtPnBwdF9mdW5jcy0+Z2V0X2Zhbl9zcGVlZF9y
cG0pCj4gKwkJcmV0ID0gc211LT5wcHRfZnVuY3MtPmdldF9mYW5fc3BlZWRfcnBtKHNtdSwgc3Bl
ZWQpOwo+ICsKPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJcmV0dXJuIHJl
dDsKPiArfQo+ICsKPiAraW50IHNtdV9zZXRfZGVlcF9zbGVlcF9kY2VmY2xrKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211LCBpbnQgY2xrKQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwltdXRl
eF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5mdW5jcy0+c2V0X2RlZXBfc2xl
ZXBfZGNlZmNsaykKPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5zZXRfZGVlcF9zbGVlcF9kY2VmY2xr
KHNtdSwgY2xrKTsKPiArCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJl
dHVybiByZXQ7Cj4gK30KPiArCj4gK2ludCBzbXVfc2V0X2FjdGl2ZV9kaXNwbGF5X2NvdW50KHN0
cnVjdCBzbXVfY29udGV4dCAqc211LCB1aW50MzJfdAo+IGNvdW50KQo+ICt7Cj4gKwlpbnQgcmV0
ID0gMDsKPiArCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5m
dW5jcy0+c2V0X2FjdGl2ZV9kaXNwbGF5X2NvdW50KQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPnNl
dF9hY3RpdmVfZGlzcGxheV9jb3VudChzbXUsIGNvdW50KTsKPiArCj4gKwltdXRleF91bmxvY2so
JnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK2ludCBzbXVfZ2V0
X2Nsb2NrX2J5X3R5cGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCj4gKwkJCSAgZW51bSBhbWRf
cHBfY2xvY2tfdHlwZSB0eXBlLAo+ICsJCQkgIHN0cnVjdCBhbWRfcHBfY2xvY2tzICpjbG9ja3Mp
Cj4gK3sKPiArCWludCByZXQgPSAwOwo+ICsKPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+
ICsKPiArCWlmIChzbXUtPmZ1bmNzLT5nZXRfY2xvY2tfYnlfdHlwZSkKPiArCQlyZXQgPSBzbXUt
PmZ1bmNzLT5nZXRfY2xvY2tfYnlfdHlwZShzbXUsIHR5cGUsIGNsb2Nrcyk7Cj4gKwo+ICsJbXV0
ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtp
bnQgc211X2dldF9tYXhfaGlnaF9jbG9ja3Moc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCj4gKwkJ
CSAgICBzdHJ1Y3QgYW1kX3BwX3NpbXBsZV9jbG9ja19pbmZvICpjbG9ja3MpCj4gK3sKPiArCWlu
dCByZXQgPSAwOwo+ICsKPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCWlmIChz
bXUtPmZ1bmNzLT5nZXRfbWF4X2hpZ2hfY2xvY2tzKQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPmdl
dF9tYXhfaGlnaF9jbG9ja3Moc211LCBjbG9ja3MpOwo+ICsKPiArCW11dGV4X3VubG9jaygmc211
LT5tdXRleCk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiAraW50IHNtdV9nZXRfY2xv
Y2tfYnlfdHlwZV93aXRoX2xhdGVuY3koc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCj4gKwkJCQkg
ICAgICAgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsCj4gKwkJCQkgICAgICAgc3RydWN0IHBw
X2Nsb2NrX2xldmVsc193aXRoX2xhdGVuY3kKPiAqY2xvY2tzKQo+ICt7Cj4gKwlpbnQgcmV0ID0g
MDsKPiArCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5wcHRf
ZnVuY3MtPmdldF9jbG9ja19ieV90eXBlX3dpdGhfbGF0ZW5jeSkKPiArCQlyZXQgPSBzbXUtPnBw
dF9mdW5jcy0KPiA+Z2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF9sYXRlbmN5KHNtdSwgY2xrX3R5cGUs
IGNsb2Nrcyk7Cj4gKwo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlyZXR1
cm4gcmV0Owo+ICt9Cj4gKwo+ICtpbnQgc211X2dldF9jbG9ja19ieV90eXBlX3dpdGhfdm9sdGFn
ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKPiArCQkJCSAgICAgICBlbnVtIGFtZF9wcF9jbG9j
a190eXBlIHR5cGUsCj4gKwkJCQkgICAgICAgc3RydWN0IHBwX2Nsb2NrX2xldmVsc193aXRoX3Zv
bHRhZ2UKPiAqY2xvY2tzKQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwltdXRleF9sb2Nr
KCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPmdldF9jbG9ja19ieV90
eXBlX3dpdGhfdm9sdGFnZSkKPiArCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0KPiA+Z2V0X2Nsb2Nr
X2J5X3R5cGVfd2l0aF92b2x0YWdlKHNtdSwgdHlwZSwgY2xvY2tzKTsKPiArCj4gKwltdXRleF91
bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gKwo+ICtp
bnQgc211X2Rpc3BsYXlfY2xvY2tfdm9sdGFnZV9yZXF1ZXN0KHN0cnVjdCBzbXVfY29udGV4dCAq
c211LAo+ICsJCQkJICAgICAgc3RydWN0IHBwX2Rpc3BsYXlfY2xvY2tfcmVxdWVzdAo+ICpjbG9j
a19yZXEpCj4gK3sKPiArCWludCByZXQgPSAwOwo+ICsKPiArCW11dGV4X2xvY2soJnNtdS0+bXV0
ZXgpOwo+ICsKPiArCWlmIChzbXUtPmZ1bmNzLT5kaXNwbGF5X2Nsb2NrX3ZvbHRhZ2VfcmVxdWVz
dCkKPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5kaXNwbGF5X2Nsb2NrX3ZvbHRhZ2VfcmVxdWVzdChz
bXUsCj4gY2xvY2tfcmVxKTsKPiArCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsK
PiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gKwo+ICtpbnQgc211X2Rpc3BsYXlfZGlzYWJsZV9t
ZW1vcnlfY2xvY2tfc3dpdGNoKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAo+IGJvb2wgZGlzYWJs
ZV9tZW1vcnlfY2xvY2tfc3dpdGNoKQo+ICt7Cj4gKwlpbnQgcmV0ID0gLUVJTlZBTDsKPiArCj4g
KwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPmRp
c3BsYXlfZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dpdGNoKQo+ICsJCXJldCA9IHNtdS0+cHB0X2Z1
bmNzLQo+ID5kaXNwbGF5X2Rpc2FibGVfbWVtb3J5X2Nsb2NrX3N3aXRjaChzbXUsCj4gZGlzYWJs
ZV9tZW1vcnlfY2xvY2tfc3dpdGNoKTsKPiArCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgp
Owo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK2ludCBzbXVfbm90aWZ5X3NtdV9lbmFi
bGVfcHdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiAr
Cj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5mdW5jcy0+bm90
aWZ5X3NtdV9lbmFibGVfcHdlKQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPm5vdGlmeV9zbXVfZW5h
YmxlX3B3ZShzbXUpOwo+ICsKPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJ
cmV0dXJuIHJldDsKPiArfQo+ICsKPiAraW50IHNtdV9zZXRfd2F0ZXJtYXJrc19mb3JfY2xvY2tf
cmFuZ2VzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAo+ICsJCQkJCXN0cnVjdAo+IGRtX3BwX3dt
X3NldHNfd2l0aF9jbG9ja19yYW5nZXNfc29jMTUgKmNsb2NrX3JhbmdlcykKPiArewo+ICsJaW50
IHJldCA9IDA7Cj4gKwo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJaWYgKHNt
dS0+ZnVuY3MtPnNldF93YXRlcm1hcmtzX2Zvcl9jbG9ja19yYW5nZXMpCj4gKwkJcmV0ID0gc211
LT5mdW5jcy0+c2V0X3dhdGVybWFya3NfZm9yX2Nsb2NrX3JhbmdlcyhzbXUsCj4gY2xvY2tfcmFu
Z2VzKTsKPiArCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJldHVybiBy
ZXQ7Cj4gK30KPiArCj4gK2ludCBzbXVfc2V0X3hnbWlfcHN0YXRlKHN0cnVjdCBzbXVfY29udGV4
dCAqc211LAo+ICsJCQl1aW50MzJfdCBwc3RhdGUpCj4gK3sKPiArCWludCByZXQgPSAwOwo+ICsK
PiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRf
eGdtaV9wc3RhdGUpCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+c2V0X3hnbWlfcHN0YXRlKHNtdSwg
cHN0YXRlKTsKPiArCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJldHVy
biByZXQ7Cj4gK30KPiArCj4gK2ludCBzbXVfc2V0X2F6YWxpYV9kM19wbWUoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUpCj4gK3sKPiArCWludCByZXQgPSAwOwo+ICsKPiArCW11dGV4X2xvY2soJnNt
dS0+bXV0ZXgpOwo+ICsKPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRfYXphbGlhX2QzX3BtZSkKPiAr
CQlyZXQgPSBzbXUtPmZ1bmNzLT5zZXRfYXphbGlhX2QzX3BtZShzbXUpOwo+ICsKPiArCW11dGV4
X3VubG9jaygmc211LT5tdXRleCk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArYm9v
bCBzbXVfYmFjb19pc19zdXBwb3J0KHN0cnVjdCBzbXVfY29udGV4dCAqc211KQo+ICt7Cj4gKwli
b29sIHJldCA9IGZhbHNlOwo+ICsKPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiAr
CWlmIChzbXUtPmZ1bmNzLT5iYWNvX2lzX3N1cHBvcnQpCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+
YmFjb19pc19zdXBwb3J0KHNtdSk7Cj4gKwo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsK
PiArCj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtpbnQgc211X2JhY29fZ2V0X3N0YXRlKHN0
cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9iYWNvX3N0YXRlCj4gKnN0YXRlKQo+ICt7
Cj4gKwlpZiAoc211LT5mdW5jcy0+YmFjb19nZXRfc3RhdGUpCj4gKwkJcmV0dXJuIC1FSU5WQUw7
Cj4gKwo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7Cj4gKwkqc3RhdGUgPSBzbXUtPmZ1bmNz
LT5iYWNvX2dldF9zdGF0ZShzbXUpOwo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiAr
Cj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiAraW50IHNtdV9iYWNvX3Jlc2V0KHN0cnVjdCBzbXVf
Y29udGV4dCAqc211KQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwltdXRleF9sb2NrKCZz
bXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5mdW5jcy0+YmFjb19yZXNldCkKPiArCQlyZXQg
PSBzbXUtPmZ1bmNzLT5iYWNvX3Jlc2V0KHNtdSk7Cj4gKwo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUt
Pm11dGV4KTsKPiArCj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtpbnQgc211X21vZGUyX3Jl
c2V0KHN0cnVjdCBzbXVfY29udGV4dCAqc211KQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4g
KwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5mdW5jcy0+bW9kZTJf
cmVzZXQpCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+bW9kZTJfcmVzZXQoc211KTsKPiArCj4gKwlt
dXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4g
K2ludCBzbXVfZ2V0X21heF9zdXN0YWluYWJsZV9jbG9ja3NfYnlfZGMoc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUsCj4gKwkJCQkJIHN0cnVjdCBwcF9zbXVfbnZfY2xvY2tfdGFibGUKPiAqbWF4X2Ns
b2NrcykKPiArewo+ICsJaW50IHJldCA9IDA7Cj4gKwo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRl
eCk7Cj4gKwo+ICsJaWYgKHNtdS0+ZnVuY3MtPmdldF9tYXhfc3VzdGFpbmFibGVfY2xvY2tzX2J5
X2RjKQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPmdldF9tYXhfc3VzdGFpbmFibGVfY2xvY2tzX2J5
X2RjKHNtdSwKPiBtYXhfY2xvY2tzKTsKPiArCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgp
Owo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK2ludCBzbXVfZ2V0X3VjbGtfZHBtX3N0
YXRlcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKPiArCQkJICAgIHVuc2lnbmVkIGludCAqY2xv
Y2tfdmFsdWVzX2luX2toeiwKPiArCQkJICAgIHVuc2lnbmVkIGludCAqbnVtX3N0YXRlcykKPiAr
ewo+ICsJaW50IHJldCA9IDA7Cj4gKwo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7Cj4gKwo+
ICsJaWYgKHNtdS0+cHB0X2Z1bmNzLT5nZXRfdWNsa19kcG1fc3RhdGVzKQo+ICsJCXJldCA9IHNt
dS0+cHB0X2Z1bmNzLT5nZXRfdWNsa19kcG1fc3RhdGVzKHNtdSwKPiBjbG9ja192YWx1ZXNfaW5f
a2h6LCBudW1fc3RhdGVzKTsKPiArCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICsK
PiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK2VudW0gYW1kX3BtX3N0YXRlX3R5cGUgc211X2dl
dF9jdXJyZW50X3Bvd2VyX3N0YXRlKHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUpCj4gK3sKPiAr
CWVudW0gYW1kX3BtX3N0YXRlX3R5cGUgcG1fc3RhdGUgPQo+IFBPV0VSX1NUQVRFX1RZUEVfREVG
QVVMVDsKPiArCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlpZiAoc211LT5w
cHRfZnVuY3MtPmdldF9jdXJyZW50X3Bvd2VyX3N0YXRlKQo+ICsJCXBtX3N0YXRlID0gc211LT5w
cHRfZnVuY3MtCj4gPmdldF9jdXJyZW50X3Bvd2VyX3N0YXRlKHNtdSk7Cj4gKwo+ICsJbXV0ZXhf
dW5sb2NrKCZzbXUtPm11dGV4KTsKPiArCj4gKwlyZXR1cm4gcG1fc3RhdGU7Cj4gK30KPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYXJjdHVydXNfcHB0LmMKPiBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2FyY3R1cnVzX3BwdC5jCj4gaW5kZXggNjcz
MWZlZDU0NThlLi4xNDFlNDhjZDFjNWQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9wb3dlcnBsYXkvYXJjdHVydXNfcHB0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bv
d2VycGxheS9hcmN0dXJ1c19wcHQuYwo+IEBAIC03NzIsOCArNzcyLDYgQEAgc3RhdGljIGludCBh
cmN0dXJ1c19mb3JjZV9jbGtfbGV2ZWxzKHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUsCj4gIAl1
aW50MzJfdCBzb2Z0X21pbl9sZXZlbCwgc29mdF9tYXhfbGV2ZWw7Cj4gIAlpbnQgcmV0ID0gMDsK
PiAKPiAtCW11dGV4X2xvY2soJihzbXUtPm11dGV4KSk7Cj4gLQo+ICAJc29mdF9taW5fbGV2ZWwg
PSBtYXNrID8gKGZmcyhtYXNrKSAtIDEpIDogMDsKPiAgCXNvZnRfbWF4X2xldmVsID0gbWFzayA/
IChmbHMobWFzaykgLSAxKSA6IDA7Cj4gCj4gQEAgLTg5Miw3ICs4OTAsNiBAQCBzdGF0aWMgaW50
IGFyY3R1cnVzX2ZvcmNlX2Nsa19sZXZlbHMoc3RydWN0Cj4gc211X2NvbnRleHQgKnNtdSwKPiAg
CQlicmVhazsKPiAgCX0KPiAKPiAtCW11dGV4X3VubG9jaygmKHNtdS0+bXV0ZXgpKTsKPiAgCXJl
dHVybiByZXQ7Cj4gIH0KPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dl
cnBsYXkvaW5jL2FtZGdwdV9zbXUuaAo+IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkv
aW5jL2FtZGdwdV9zbXUuaAo+IGluZGV4IGNkYjg0NWY1ZjIzZS4uM2UzNDY0ZmEyZmY1IDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2luYy9hbWRncHVfc211LmgK
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMvYW1kZ3B1X3NtdS5oCj4g
QEAgLTU2NSwxOCArNTY1LDE3IEBAIHN0cnVjdCBzbXVfZnVuY3MKPiAgCSgoc211KS0+ZnVuY3Mt
PmluaXRfcG93ZXIgPyAoc211KS0+ZnVuY3MtPmluaXRfcG93ZXIoKHNtdSkpIDogMCkKPiAgI2Rl
ZmluZSBzbXVfZmluaV9wb3dlcihzbXUpIFwKPiAgCSgoc211KS0+ZnVuY3MtPmZpbmlfcG93ZXIg
PyAoc211KS0+ZnVuY3MtPmZpbmlfcG93ZXIoKHNtdSkpIDogMCkKPiAtI2RlZmluZSBzbXVfbG9h
ZF9taWNyb2NvZGUoc211KSBcCj4gLQkoKHNtdSktPmZ1bmNzLT5sb2FkX21pY3JvY29kZSA/IChz
bXUpLT5mdW5jcy0KPiA+bG9hZF9taWNyb2NvZGUoKHNtdSkpIDogMCkKPiAtI2RlZmluZSBzbXVf
Y2hlY2tfZndfc3RhdHVzKHNtdSkgXAo+IC0JKChzbXUpLT5mdW5jcy0+Y2hlY2tfZndfc3RhdHVz
ID8gKHNtdSktPmZ1bmNzLQo+ID5jaGVja19md19zdGF0dXMoKHNtdSkpIDogMCkKPiAraW50IHNt
dV9sb2FkX21pY3JvY29kZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSk7Cj4gKwo+ICtpbnQgc211
X2NoZWNrX2Z3X3N0YXR1cyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSk7Cj4gKwo+ICAjZGVmaW5l
IHNtdV9zZXR1cF9wcHRhYmxlKHNtdSkgXAo+ICAJKChzbXUpLT5mdW5jcy0+c2V0dXBfcHB0YWJs
ZSA/IChzbXUpLT5mdW5jcy0KPiA+c2V0dXBfcHB0YWJsZSgoc211KSkgOiAwKQo+ICAjZGVmaW5l
IHNtdV9wb3dlcmdhdGVfc2RtYShzbXUsIGdhdGUpIFwKPiAgCSgoc211KS0+ZnVuY3MtPnBvd2Vy
Z2F0ZV9zZG1hID8gKHNtdSktPmZ1bmNzLQo+ID5wb3dlcmdhdGVfc2RtYSgoc211KSwgKGdhdGUp
KSA6IDApCj4gICNkZWZpbmUgc211X3Bvd2VyZ2F0ZV92Y24oc211LCBnYXRlKSBcCj4gIAkoKHNt
dSktPmZ1bmNzLT5wb3dlcmdhdGVfdmNuID8gKHNtdSktPmZ1bmNzLQo+ID5wb3dlcmdhdGVfdmNu
KChzbXUpLCAoZ2F0ZSkpIDogMCkKPiAtI2RlZmluZSBzbXVfc2V0X2dmeF9jZ3BnKHNtdSwgZW5h
YmxlZCkgXAo+IC0JKChzbXUpLT5mdW5jcy0+c2V0X2dmeF9jZ3BnID8gKHNtdSktPmZ1bmNzLT5z
ZXRfZ2Z4X2NncGcoKHNtdSksCj4gKGVuYWJsZWQpKSA6IDApCj4gK2ludCBzbXVfc2V0X2dmeF9j
Z3BnKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBib29sIGVuYWJsZWQpOwo+ICAjZGVmaW5lIHNt
dV9nZXRfdmJpb3NfYm9vdHVwX3ZhbHVlcyhzbXUpIFwKPiAgCSgoc211KS0+ZnVuY3MtPmdldF92
Ymlvc19ib290dXBfdmFsdWVzID8gKHNtdSktPmZ1bmNzLQo+ID5nZXRfdmJpb3NfYm9vdHVwX3Zh
bHVlcygoc211KSkgOiAwKQo+ICAjZGVmaW5lIHNtdV9nZXRfY2xrX2luZm9fZnJvbV92Ymlvcyhz
bXUpIFwKPiBAQCAtNjEwLDggKzYwOSw4IEBAIHN0cnVjdCBzbXVfZnVuY3MKPiAgCSgoc211KS0+
ZnVuY3MtPmluaXRfbWF4X3N1c3RhaW5hYmxlX2Nsb2NrcyA/IChzbXUpLT5mdW5jcy0KPiA+aW5p
dF9tYXhfc3VzdGFpbmFibGVfY2xvY2tzKChzbXUpKSA6IDApCj4gICNkZWZpbmUgc211X3NldF9k
ZWZhdWx0X29kX3NldHRpbmdzKHNtdSwgaW5pdGlhbGl6ZSkgXAo+ICAJKChzbXUpLT5wcHRfZnVu
Y3MtPnNldF9kZWZhdWx0X29kX3NldHRpbmdzID8gKHNtdSktPnBwdF9mdW5jcy0KPiA+c2V0X2Rl
ZmF1bHRfb2Rfc2V0dGluZ3MoKHNtdSksIChpbml0aWFsaXplKSkgOiAwKQo+IC0jZGVmaW5lIHNt
dV9zZXRfZmFuX3NwZWVkX3JwbShzbXUsIHNwZWVkKSBcCj4gLQkoKHNtdSktPmZ1bmNzLT5zZXRf
ZmFuX3NwZWVkX3JwbSA/IChzbXUpLT5mdW5jcy0KPiA+c2V0X2Zhbl9zcGVlZF9ycG0oKHNtdSks
IChzcGVlZCkpIDogMCkKPiAraW50IHNtdV9zZXRfZmFuX3NwZWVkX3JwbShzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSwgdWludDMyX3Qgc3BlZWQpOwo+ICsKPiAgI2RlZmluZSBzbXVfc2VuZF9zbWNf
bXNnKHNtdSwgbXNnKSBcCj4gIAkoKHNtdSktPmZ1bmNzLT5zZW5kX3NtY19tc2c/IChzbXUpLT5m
dW5jcy0KPiA+c2VuZF9zbWNfbXNnKChzbXUpLCAobXNnKSkgOiAwKQo+ICAjZGVmaW5lIHNtdV9z
ZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIG1zZywgcGFyYW0pIFwKPiBAQCAtNjQyLDIwICs2
NDEsMjIgQEAgc3RydWN0IHNtdV9mdW5jcwo+ICAJKChzbXUpLT5wcHRfZnVuY3MtPnBvcHVsYXRl
X3VtZF9zdGF0ZV9jbGsgPyAoc211KS0+cHB0X2Z1bmNzLQo+ID5wb3B1bGF0ZV91bWRfc3RhdGVf
Y2xrKChzbXUpKSA6IDApCj4gICNkZWZpbmUgc211X3NldF9kZWZhdWx0X29kOF9zZXR0aW5ncyhz
bXUpIFwKPiAgCSgoc211KS0+cHB0X2Z1bmNzLT5zZXRfZGVmYXVsdF9vZDhfc2V0dGluZ3MgPyAo
c211KS0+cHB0X2Z1bmNzLQo+ID5zZXRfZGVmYXVsdF9vZDhfc2V0dGluZ3MoKHNtdSkpIDogMCkK
PiAtI2RlZmluZSBzbXVfZ2V0X3Bvd2VyX2xpbWl0KHNtdSwgbGltaXQsIGRlZikgXAo+IC0JKChz
bXUpLT5wcHRfZnVuY3MtPmdldF9wb3dlcl9saW1pdCA/IChzbXUpLT5wcHRfZnVuY3MtCj4gPmdl
dF9wb3dlcl9saW1pdCgoc211KSwgKGxpbWl0KSwgKGRlZikpIDogMCkKPiAtI2RlZmluZSBzbXVf
c2V0X3Bvd2VyX2xpbWl0KHNtdSwgbGltaXQpIFwKPiAtCSgoc211KS0+ZnVuY3MtPnNldF9wb3dl
cl9saW1pdCA/IChzbXUpLT5mdW5jcy0KPiA+c2V0X3Bvd2VyX2xpbWl0KChzbXUpLCAobGltaXQp
KSA6IDApCj4gKwo+ICtpbnQgc211X2dldF9wb3dlcl9saW1pdChzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSwKPiArCQkJdWludDMyX3QgKmxpbWl0LAo+ICsJCQlib29sIGRlZiwKPiArCQkJYm9vbCBs
b2NrX25lZWRlZCk7Cj4gKwo+ICtpbnQgc211X3NldF9wb3dlcl9saW1pdChzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSwgdWludDMyX3QgbGltaXQpOwo+ICAjZGVmaW5lIHNtdV9nZXRfY3VycmVudF9j
bGtfZnJlcShzbXUsIGNsa19pZCwgdmFsdWUpIFwKPiAgCSgoc211KS0+ZnVuY3MtPmdldF9jdXJy
ZW50X2Nsa19mcmVxPyAoc211KS0+ZnVuY3MtCj4gPmdldF9jdXJyZW50X2Nsa19mcmVxKChzbXUp
LCAoY2xrX2lkKSwgKHZhbHVlKSkgOiAwKQo+IC0jZGVmaW5lIHNtdV9wcmludF9jbGtfbGV2ZWxz
KHNtdSwgY2xrX3R5cGUsIGJ1ZikgXAo+IC0JKChzbXUpLT5wcHRfZnVuY3MtPnByaW50X2Nsa19s
ZXZlbHMgPyAoc211KS0+cHB0X2Z1bmNzLQo+ID5wcmludF9jbGtfbGV2ZWxzKChzbXUpLCAoY2xr
X3R5cGUpLCAoYnVmKSkgOiAwKQo+IC0jZGVmaW5lIHNtdV9nZXRfb2RfcGVyY2VudGFnZShzbXUs
IHR5cGUpIFwKPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5nZXRfb2RfcGVyY2VudGFnZSA/IChzbXUp
LT5wcHRfZnVuY3MtCj4gPmdldF9vZF9wZXJjZW50YWdlKChzbXUpLCAodHlwZSkpIDogMCkKPiAt
I2RlZmluZSBzbXVfc2V0X29kX3BlcmNlbnRhZ2Uoc211LCB0eXBlLCB2YWx1ZSkgXAo+IC0JKChz
bXUpLT5wcHRfZnVuY3MtPnNldF9vZF9wZXJjZW50YWdlID8gKHNtdSktPnBwdF9mdW5jcy0KPiA+
c2V0X29kX3BlcmNlbnRhZ2UoKHNtdSksICh0eXBlKSwgKHZhbHVlKSkgOiAwKQo+IC0jZGVmaW5l
IHNtdV9vZF9lZGl0X2RwbV90YWJsZShzbXUsIHR5cGUsIGlucHV0LCBzaXplKSBcCj4gLQkoKHNt
dSktPnBwdF9mdW5jcy0+b2RfZWRpdF9kcG1fdGFibGUgPyAoc211KS0+cHB0X2Z1bmNzLQo+ID5v
ZF9lZGl0X2RwbV90YWJsZSgoc211KSwgKHR5cGUpLCAoaW5wdXQpLCAoc2l6ZSkpIDogMCkKPiAr
aW50IHNtdV9wcmludF9jbGtfbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNt
dV9jbGtfdHlwZQo+IGNsa190eXBlLCBjaGFyICpidWYpOwo+ICtpbnQgc211X2dldF9vZF9wZXJj
ZW50YWdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtCj4gc211X2Nsa190eXBlIHR5cGUp
Owo+ICtpbnQgc211X3NldF9vZF9wZXJjZW50YWdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBl
bnVtCj4gc211X2Nsa190eXBlIHR5cGUsIHVpbnQzMl90IHZhbHVlKTsKPiArCj4gK2ludCBzbXVf
b2RfZWRpdF9kcG1fdGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCj4gKwkJCSAgZW51bSBQ
UF9PRF9EUE1fVEFCTEVfQ09NTUFORCB0eXBlLAo+ICsJCQkgIGxvbmcgKmlucHV0LCB1aW50MzJf
dCBzaXplKTsKPiAgI2RlZmluZSBzbXVfdGFibGVzX2luaXQoc211LCB0YWIpIFwKPiAgCSgoc211
KS0+cHB0X2Z1bmNzLT50YWJsZXNfaW5pdCA/IChzbXUpLT5wcHRfZnVuY3MtCj4gPnRhYmxlc19p
bml0KChzbXUpLCAodGFiKSkgOiAwKQo+ICAjZGVmaW5lIHNtdV9zZXRfdGhlcm1hbF9mYW5fdGFi
bGUoc211KSBcCj4gQEAgLTY2NCwxNCArNjY1LDE4IEBAIHN0cnVjdCBzbXVfZnVuY3MKPiAgCSgo
c211KS0+ZnVuY3MtPnN0YXJ0X3RoZXJtYWxfY29udHJvbD8gKHNtdSktPmZ1bmNzLQo+ID5zdGFy
dF90aGVybWFsX2NvbnRyb2woKHNtdSkpIDogMCkKPiAgI2RlZmluZSBzbXVfc3RvcF90aGVybWFs
X2NvbnRyb2woc211KSBcCj4gIAkoKHNtdSktPmZ1bmNzLT5zdG9wX3RoZXJtYWxfY29udHJvbD8g
KHNtdSktPmZ1bmNzLQo+ID5zdG9wX3RoZXJtYWxfY29udHJvbCgoc211KSkgOiAwKQo+IC0jZGVm
aW5lIHNtdV9yZWFkX3NlbnNvcihzbXUsIHNlbnNvciwgZGF0YSwgc2l6ZSkgXAo+IC0JKChzbXUp
LT5wcHRfZnVuY3MtPnJlYWRfc2Vuc29yPyAoc211KS0+cHB0X2Z1bmNzLQo+ID5yZWFkX3NlbnNv
cigoc211KSwgKHNlbnNvciksIChkYXRhKSwgKHNpemUpKSA6IDApCj4gKwo+ICtpbnQgc211X3Jl
YWRfc2Vuc29yKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAo+ICsJCSAgICBlbnVtIGFtZF9wcF9z
ZW5zb3JzIHNlbnNvciwKPiArCQkgICAgdm9pZCAqZGF0YSwgdWludDMyX3QgKnNpemUpOwo+ICAj
ZGVmaW5lIHNtdV9zbWNfcmVhZF9zZW5zb3Ioc211LCBzZW5zb3IsIGRhdGEsIHNpemUpIFwKPiAg
CSgoc211KS0+ZnVuY3MtPnJlYWRfc2Vuc29yPyAoc211KS0+ZnVuY3MtPnJlYWRfc2Vuc29yKChz
bXUpLAo+IChzZW5zb3IpLCAoZGF0YSksIChzaXplKSkgOiAtRUlOVkFMKQo+IC0jZGVmaW5lIHNt
dV9nZXRfcG93ZXJfcHJvZmlsZV9tb2RlKHNtdSwgYnVmKSBcCj4gLQkoKHNtdSktPnBwdF9mdW5j
cy0+Z2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZSA/IChzbXUpLT5wcHRfZnVuY3MtCj4gPmdldF9wb3dl
cl9wcm9maWxlX21vZGUoKHNtdSksIGJ1ZikgOiAwKQo+IC0jZGVmaW5lIHNtdV9zZXRfcG93ZXJf
cHJvZmlsZV9tb2RlKHNtdSwgcGFyYW0sIHBhcmFtX3NpemUpIFwKPiAtCSgoc211KS0+cHB0X2Z1
bmNzLT5zZXRfcG93ZXJfcHJvZmlsZV9tb2RlID8gKHNtdSktPnBwdF9mdW5jcy0KPiA+c2V0X3Bv
d2VyX3Byb2ZpbGVfbW9kZSgoc211KSwgKHBhcmFtKSwgKHBhcmFtX3NpemUpKSA6IDApCj4gK2lu
dCBzbXVfZ2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgY2hh
ciAqYnVmKTsKPiArCj4gK2ludCBzbXVfc2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZShzdHJ1Y3Qgc211
X2NvbnRleHQgKnNtdSwKPiArCQkJICAgICAgIGxvbmcgKnBhcmFtLAo+ICsJCQkgICAgICAgdWlu
dDMyX3QgcGFyYW1fc2l6ZSwKPiArCQkJICAgICAgIGJvb2wgbG9ja19uZWVkZWQpOwo+ICAjZGVm
aW5lIHNtdV9wcmVfZGlzcGxheV9jb25maWdfY2hhbmdlZChzbXUpIFwKPiAgCSgoc211KS0+cHB0
X2Z1bmNzLT5wcmVfZGlzcGxheV9jb25maWdfY2hhbmdlZCA/IChzbXUpLQo+ID5wcHRfZnVuY3Mt
PnByZV9kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkKChzbXUpKSA6IDApCj4gICNkZWZpbmUgc211X2Rp
c3BsYXlfY29uZmlnX2NoYW5nZWQoc211KSBcCj4gQEAgLTY4OCwxNiArNjkzLDExIEBAIHN0cnVj
dCBzbXVfZnVuY3MKPiAgCSgoc211KS0+cHB0X2Z1bmNzLT5nZXRfcHJvZmlsaW5nX2Nsa19tYXNr
ID8gKHNtdSktPnBwdF9mdW5jcy0KPiA+Z2V0X3Byb2ZpbGluZ19jbGtfbWFzaygoc211KSwgKGxl
dmVsKSwgKHNjbGtfbWFzayksIChtY2xrX21hc2spLAo+IChzb2NfbWFzaykpIDogMCkKPiAgI2Rl
ZmluZSBzbXVfc2V0X2NwdV9wb3dlcl9zdGF0ZShzbXUpIFwKPiAgCSgoc211KS0+cHB0X2Z1bmNz
LT5zZXRfY3B1X3Bvd2VyX3N0YXRlID8gKHNtdSktPnBwdF9mdW5jcy0KPiA+c2V0X2NwdV9wb3dl
cl9zdGF0ZSgoc211KSkgOiAwKQo+IC0jZGVmaW5lIHNtdV9nZXRfZmFuX2NvbnRyb2xfbW9kZShz
bXUpIFwKPiAtCSgoc211KS0+ZnVuY3MtPmdldF9mYW5fY29udHJvbF9tb2RlID8gKHNtdSktPmZ1
bmNzLQo+ID5nZXRfZmFuX2NvbnRyb2xfbW9kZSgoc211KSkgOiAwKQo+IC0jZGVmaW5lIHNtdV9z
ZXRfZmFuX2NvbnRyb2xfbW9kZShzbXUsIHZhbHVlKSBcCj4gLQkoKHNtdSktPmZ1bmNzLT5zZXRf
ZmFuX2NvbnRyb2xfbW9kZSA/IChzbXUpLT5mdW5jcy0KPiA+c2V0X2Zhbl9jb250cm9sX21vZGUo
KHNtdSksICh2YWx1ZSkpIDogMCkKPiAtI2RlZmluZSBzbXVfZ2V0X2Zhbl9zcGVlZF9wZXJjZW50
KHNtdSwgc3BlZWQpIFwKPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5nZXRfZmFuX3NwZWVkX3BlcmNl
bnQgPyAoc211KS0+cHB0X2Z1bmNzLQo+ID5nZXRfZmFuX3NwZWVkX3BlcmNlbnQoKHNtdSksIChz
cGVlZCkpIDogMCkKPiAtI2RlZmluZSBzbXVfc2V0X2Zhbl9zcGVlZF9wZXJjZW50KHNtdSwgc3Bl
ZWQpIFwKPiAtCSgoc211KS0+ZnVuY3MtPnNldF9mYW5fc3BlZWRfcGVyY2VudCA/IChzbXUpLT5m
dW5jcy0KPiA+c2V0X2Zhbl9zcGVlZF9wZXJjZW50KChzbXUpLCAoc3BlZWQpKSA6IDApCj4gLSNk
ZWZpbmUgc211X2dldF9mYW5fc3BlZWRfcnBtKHNtdSwgc3BlZWQpIFwKPiAtCSgoc211KS0+cHB0
X2Z1bmNzLT5nZXRfZmFuX3NwZWVkX3JwbSA/IChzbXUpLT5wcHRfZnVuY3MtCj4gPmdldF9mYW5f
c3BlZWRfcnBtKChzbXUpLCAoc3BlZWQpKSA6IDApCj4gK2ludCBzbXVfZ2V0X2Zhbl9jb250cm9s
X21vZGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpOwo+ICtpbnQgc211X3NldF9mYW5fY29udHJv
bF9tb2RlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBpbnQgdmFsdWUpOwo+ICtpbnQgc211X2dl
dF9mYW5fc3BlZWRfcGVyY2VudChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDMyX3QKPiAq
c3BlZWQpOwo+ICtpbnQgc211X3NldF9mYW5fc3BlZWRfcGVyY2VudChzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSwgdWludDMyX3QKPiBzcGVlZCk7Cj4gK2ludCBzbXVfZ2V0X2Zhbl9zcGVlZF9ycG0o
c3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQzMl90ICpzcGVlZCk7Cj4gCj4gICNkZWZpbmUg
c211X21zZ19nZXRfaW5kZXgoc211LCBtc2cpIFwKPiAgCSgoc211KS0+cHB0X2Z1bmNzPyAoKHNt
dSktPnBwdF9mdW5jcy0+Z2V0X3NtdV9tc2dfaW5kZXg/Cj4gKHNtdSktPnBwdF9mdW5jcy0+Z2V0
X3NtdV9tc2dfaW5kZXgoKHNtdSksIChtc2cpKSA6IC1FSU5WQUwpIDogLQo+IEVJTlZBTCkKPiBA
QCAtNzE1LDQwICs3MTUsNDYgQEAgc3RydWN0IHNtdV9mdW5jcwo+ICAJKChzbXUpLT5wcHRfZnVu
Y3M/ICgoc211KS0+cHB0X2Z1bmNzLT5ydW5fYnRjPyAoc211KS0KPiA+cHB0X2Z1bmNzLT5ydW5f
YnRjKChzbXUpKSA6IDApIDogMCkKPiAgI2RlZmluZSBzbXVfZ2V0X2FsbG93ZWRfZmVhdHVyZV9t
YXNrKHNtdSwgZmVhdHVyZV9tYXNrLCBudW0pIFwKPiAgCSgoc211KS0+cHB0X2Z1bmNzPyAoKHNt
dSktPnBwdF9mdW5jcy0KPiA+Z2V0X2FsbG93ZWRfZmVhdHVyZV9tYXNrPyAoc211KS0+cHB0X2Z1
bmNzLQo+ID5nZXRfYWxsb3dlZF9mZWF0dXJlX21hc2soKHNtdSksIChmZWF0dXJlX21hc2spLCAo
bnVtKSkgOiAwKSA6IDApCj4gLSNkZWZpbmUgc211X3NldF9kZWVwX3NsZWVwX2RjZWZjbGsoc211
LCBjbGspIFwKPiAtCSgoc211KS0+ZnVuY3MtPnNldF9kZWVwX3NsZWVwX2RjZWZjbGsgPyAoc211
KS0+ZnVuY3MtCj4gPnNldF9kZWVwX3NsZWVwX2RjZWZjbGsoKHNtdSksIChjbGspKSA6IDApCj4g
LSNkZWZpbmUgc211X3NldF9hY3RpdmVfZGlzcGxheV9jb3VudChzbXUsIGNvdW50KSBcCj4gLQko
KHNtdSktPmZ1bmNzLT5zZXRfYWN0aXZlX2Rpc3BsYXlfY291bnQgPyAoc211KS0+ZnVuY3MtCj4g
PnNldF9hY3RpdmVfZGlzcGxheV9jb3VudCgoc211KSwgKGNvdW50KSkgOiAwKQo+ICtpbnQgc211
X3NldF9kZWVwX3NsZWVwX2RjZWZjbGsoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGludCBjbGsp
Owo+ICtpbnQgc211X3NldF9hY3RpdmVfZGlzcGxheV9jb3VudChzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSwgdWludDMyX3QKPiBjb3VudCk7Cj4gICNkZWZpbmUgc211X3N0b3JlX2NjNl9kYXRhKHNt
dSwgc3QsIGNjNl9kaXMsIHBzdF9kaXMsIHBzdF9zd19kaXMpIFwKPiAgCSgoc211KS0+ZnVuY3Mt
PnN0b3JlX2NjNl9kYXRhID8gKHNtdSktPmZ1bmNzLQo+ID5zdG9yZV9jYzZfZGF0YSgoc211KSwg
KHN0KSwgKGNjNl9kaXMpLCAocHN0X2RpcyksIChwc3Rfc3dfZGlzKSkgOiAwKQo+IC0jZGVmaW5l
IHNtdV9nZXRfY2xvY2tfYnlfdHlwZShzbXUsIHR5cGUsIGNsb2NrcykgXAo+IC0JKChzbXUpLT5m
dW5jcy0+Z2V0X2Nsb2NrX2J5X3R5cGUgPyAoc211KS0+ZnVuY3MtCj4gPmdldF9jbG9ja19ieV90
eXBlKChzbXUpLCAodHlwZSksIChjbG9ja3MpKSA6IDApCj4gLSNkZWZpbmUgc211X2dldF9tYXhf
aGlnaF9jbG9ja3Moc211LCBjbG9ja3MpIFwKPiAtCSgoc211KS0+ZnVuY3MtPmdldF9tYXhfaGln
aF9jbG9ja3MgPyAoc211KS0+ZnVuY3MtCj4gPmdldF9tYXhfaGlnaF9jbG9ja3MoKHNtdSksIChj
bG9ja3MpKSA6IDApCj4gLSNkZWZpbmUgc211X2dldF9jbG9ja19ieV90eXBlX3dpdGhfbGF0ZW5j
eShzbXUsIGNsa190eXBlLCBjbG9ja3MpIFwKPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5nZXRfY2xv
Y2tfYnlfdHlwZV93aXRoX2xhdGVuY3kgPyAoc211KS0KPiA+cHB0X2Z1bmNzLT5nZXRfY2xvY2tf
YnlfdHlwZV93aXRoX2xhdGVuY3koKHNtdSksIChjbGtfdHlwZSksIChjbG9ja3MpKSA6Cj4gMCkK
PiAtI2RlZmluZSBzbXVfZ2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF92b2x0YWdlKHNtdSwgdHlwZSwg
Y2xvY2tzKSBcCj4gLQkoKHNtdSktPnBwdF9mdW5jcy0+Z2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF92
b2x0YWdlID8gKHNtdSktCj4gPnBwdF9mdW5jcy0+Z2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF92b2x0
YWdlKChzbXUpLCAodHlwZSksIChjbG9ja3MpKSA6IDApCj4gLSNkZWZpbmUgc211X2Rpc3BsYXlf
Y2xvY2tfdm9sdGFnZV9yZXF1ZXN0KHNtdSwgY2xvY2tfcmVxKSBcCj4gLQkoKHNtdSktPmZ1bmNz
LT5kaXNwbGF5X2Nsb2NrX3ZvbHRhZ2VfcmVxdWVzdCA/IChzbXUpLT5mdW5jcy0KPiA+ZGlzcGxh
eV9jbG9ja192b2x0YWdlX3JlcXVlc3QoKHNtdSksIChjbG9ja19yZXEpKSA6IDApCj4gLSNkZWZp
bmUgc211X2Rpc3BsYXlfZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dpdGNoKHNtdSwKPiBkaXNhYmxl
X21lbW9yeV9jbG9ja19zd2l0Y2gpIFwKPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5kaXNwbGF5X2Rp
c2FibGVfbWVtb3J5X2Nsb2NrX3N3aXRjaCA/IChzbXUpLQo+ID5wcHRfZnVuY3MtPmRpc3BsYXlf
ZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dpdGNoKChzbXUpLAo+IChkaXNhYmxlX21lbW9yeV9jbG9j
a19zd2l0Y2gpKSA6IC1FSU5WQUwpCj4gKwo+ICtpbnQgc211X2dldF9jbG9ja19ieV90eXBlKHN0
cnVjdCBzbXVfY29udGV4dCAqc211LAo+ICsJCQkgIGVudW0gYW1kX3BwX2Nsb2NrX3R5cGUgdHlw
ZSwKPiArCQkJICBzdHJ1Y3QgYW1kX3BwX2Nsb2NrcyAqY2xvY2tzKTsKPiArCj4gK2ludCBzbXVf
Z2V0X21heF9oaWdoX2Nsb2NrcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKPiArCQkJICAgIHN0
cnVjdCBhbWRfcHBfc2ltcGxlX2Nsb2NrX2luZm8gKmNsb2Nrcyk7Cj4gKwo+ICtpbnQgc211X2dl
dF9jbG9ja19ieV90eXBlX3dpdGhfbGF0ZW5jeShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKPiAr
CQkJCSAgICAgICBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwKPiArCQkJCSAgICAgICBzdHJ1
Y3QgcHBfY2xvY2tfbGV2ZWxzX3dpdGhfbGF0ZW5jeQo+ICpjbG9ja3MpOwo+ICsKPiAraW50IHNt
dV9nZXRfY2xvY2tfYnlfdHlwZV93aXRoX3ZvbHRhZ2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUs
Cj4gKwkJCQkgICAgICAgZW51bSBhbWRfcHBfY2xvY2tfdHlwZSB0eXBlLAo+ICsJCQkJICAgICAg
IHN0cnVjdCBwcF9jbG9ja19sZXZlbHNfd2l0aF92b2x0YWdlCj4gKmNsb2Nrcyk7Cj4gKwo+ICtp
bnQgc211X2Rpc3BsYXlfY2xvY2tfdm9sdGFnZV9yZXF1ZXN0KHN0cnVjdCBzbXVfY29udGV4dCAq
c211LAo+ICsJCQkJICAgICAgc3RydWN0IHBwX2Rpc3BsYXlfY2xvY2tfcmVxdWVzdAo+ICpjbG9j
a19yZXEpOwo+ICtpbnQgc211X2Rpc3BsYXlfZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dpdGNoKHN0
cnVjdCBzbXVfY29udGV4dCAqc211LAo+IGJvb2wgZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dpdGNo
KTsKPiAgI2RlZmluZSBzbXVfZ2V0X2RhbF9wb3dlcl9sZXZlbChzbXUsIGNsb2NrcykgXAo+ICAJ
KChzbXUpLT5mdW5jcy0+Z2V0X2RhbF9wb3dlcl9sZXZlbCA/IChzbXUpLT5mdW5jcy0KPiA+Z2V0
X2RhbF9wb3dlcl9sZXZlbCgoc211KSwgKGNsb2NrcykpIDogMCkKPiAgI2RlZmluZSBzbXVfZ2V0
X3BlcmZfbGV2ZWwoc211LCBkZXNpZ25hdGlvbiwgbGV2ZWwpIFwKPiAgCSgoc211KS0+ZnVuY3Mt
PmdldF9wZXJmX2xldmVsID8gKHNtdSktPmZ1bmNzLQo+ID5nZXRfcGVyZl9sZXZlbCgoc211KSwg
KGRlc2lnbmF0aW9uKSwgKGxldmVsKSkgOiAwKQo+ICAjZGVmaW5lIHNtdV9nZXRfY3VycmVudF9z
aGFsbG93X3NsZWVwX2Nsb2NrcyhzbXUsIGNsb2NrcykgXAo+ICAJKChzbXUpLT5mdW5jcy0+Z2V0
X2N1cnJlbnRfc2hhbGxvd19zbGVlcF9jbG9ja3MgPyAoc211KS0+ZnVuY3MtCj4gPmdldF9jdXJy
ZW50X3NoYWxsb3dfc2xlZXBfY2xvY2tzKChzbXUpLCAoY2xvY2tzKSkgOiAwKQo+IC0jZGVmaW5l
IHNtdV9ub3RpZnlfc211X2VuYWJsZV9wd2Uoc211KSBcCj4gLQkoKHNtdSktPmZ1bmNzLT5ub3Rp
Znlfc211X2VuYWJsZV9wd2UgPyAoc211KS0+ZnVuY3MtCj4gPm5vdGlmeV9zbXVfZW5hYmxlX3B3
ZSgoc211KSkgOiAwKQo+IC0jZGVmaW5lIHNtdV9zZXRfd2F0ZXJtYXJrc19mb3JfY2xvY2tfcmFu
Z2VzKHNtdSwgY2xvY2tfcmFuZ2VzKSBcCj4gLQkoKHNtdSktPmZ1bmNzLT5zZXRfd2F0ZXJtYXJr
c19mb3JfY2xvY2tfcmFuZ2VzID8gKHNtdSktPmZ1bmNzLQo+ID5zZXRfd2F0ZXJtYXJrc19mb3Jf
Y2xvY2tfcmFuZ2VzKChzbXUpLCAoY2xvY2tfcmFuZ2VzKSkgOiAwKQo+ICtpbnQgc211X25vdGlm
eV9zbXVfZW5hYmxlX3B3ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSk7Cj4gKwo+ICtpbnQgc211
X3NldF93YXRlcm1hcmtzX2Zvcl9jbG9ja19yYW5nZXMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUs
Cj4gKwkJCQkJc3RydWN0Cj4gZG1fcHBfd21fc2V0c193aXRoX2Nsb2NrX3Jhbmdlc19zb2MxNSAq
Y2xvY2tfcmFuZ2VzKTsKPiAgI2RlZmluZSBzbXVfZHBtX3NldF91dmRfZW5hYmxlKHNtdSwgZW5h
YmxlKSBcCj4gIAkoKHNtdSktPnBwdF9mdW5jcy0+ZHBtX3NldF91dmRfZW5hYmxlID8gKHNtdSkt
PnBwdF9mdW5jcy0KPiA+ZHBtX3NldF91dmRfZW5hYmxlKChzbXUpLCAoZW5hYmxlKSkgOiAwKQo+
ICAjZGVmaW5lIHNtdV9kcG1fc2V0X3ZjZV9lbmFibGUoc211LCBlbmFibGUpIFwKPiAgCSgoc211
KS0+cHB0X2Z1bmNzLT5kcG1fc2V0X3ZjZV9lbmFibGUgPyAoc211KS0+cHB0X2Z1bmNzLQo+ID5k
cG1fc2V0X3ZjZV9lbmFibGUoKHNtdSksIChlbmFibGUpKSA6IDApCj4gLSNkZWZpbmUgc211X3Nl
dF94Z21pX3BzdGF0ZShzbXUsIHBzdGF0ZSkgXAo+IC0JCSgoc211KS0+ZnVuY3MtPnNldF94Z21p
X3BzdGF0ZSA/IChzbXUpLT5mdW5jcy0KPiA+c2V0X3hnbWlfcHN0YXRlKChzbXUpLCAocHN0YXRl
KSkgOiAwKQo+ICsKPiAraW50IHNtdV9zZXRfeGdtaV9wc3RhdGUoc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUsCj4gKwkJCXVpbnQzMl90IHBzdGF0ZSk7Cj4gICNkZWZpbmUgc211X3NldF93YXRlcm1h
cmtzX3RhYmxlKHNtdSwgdGFiLCBjbG9ja19yYW5nZXMpIFwKPiAgCSgoc211KS0+cHB0X2Z1bmNz
LT5zZXRfd2F0ZXJtYXJrc190YWJsZSA/IChzbXUpLT5wcHRfZnVuY3MtCj4gPnNldF93YXRlcm1h
cmtzX3RhYmxlKChzbXUpLCAodGFiKSwgKGNsb2NrX3JhbmdlcykpIDogMCkKPiAgI2RlZmluZSBz
bXVfZ2V0X2N1cnJlbnRfY2xrX2ZyZXFfYnlfdGFibGUoc211LCBjbGtfdHlwZSwgdmFsdWUpIFwK
PiBAQCAtNzU5LDIyICs3NjUsMTggQEAgc3RydWN0IHNtdV9mdW5jcwo+ICAJKChzbXUpLT5wcHRf
ZnVuY3MtPmdldF90aGVybWFsX3RlbXBlcmF0dXJlX3JhbmdlPyAoc211KS0KPiA+cHB0X2Z1bmNz
LT5nZXRfdGhlcm1hbF90ZW1wZXJhdHVyZV9yYW5nZSgoc211KSwgKHJhbmdlKSkgOiAwKQo+ICAj
ZGVmaW5lIHNtdV9yZWdpc3Rlcl9pcnFfaGFuZGxlcihzbXUpIFwKPiAgCSgoc211KS0+ZnVuY3Mt
PnJlZ2lzdGVyX2lycV9oYW5kbGVyID8gKHNtdSktPmZ1bmNzLQo+ID5yZWdpc3Rlcl9pcnFfaGFu
ZGxlcihzbXUpIDogMCkKPiAtI2RlZmluZSBzbXVfc2V0X2F6YWxpYV9kM19wbWUoc211KSBcCj4g
LQkoKHNtdSktPmZ1bmNzLT5zZXRfYXphbGlhX2QzX3BtZSA/IChzbXUpLT5mdW5jcy0KPiA+c2V0
X2F6YWxpYV9kM19wbWUoKHNtdSkpIDogMCkKPiArCj4gK2ludCBzbXVfc2V0X2F6YWxpYV9kM19w
bWUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpOwo+ICAjZGVmaW5lIHNtdV9nZXRfZHBtX3VsdGlt
YXRlX2ZyZXEoc211LCBwYXJhbSwgbWluLCBtYXgpIFwKPiAgCQkoKHNtdSktPmZ1bmNzLT5nZXRf
ZHBtX3VsdGltYXRlX2ZyZXEgPyAoc211KS0+ZnVuY3MtCj4gPmdldF9kcG1fdWx0aW1hdGVfZnJl
cSgoc211KSwgKHBhcmFtKSwgKG1pbiksIChtYXgpKSA6IDApCj4gLSNkZWZpbmUgc211X2dldF91
Y2xrX2RwbV9zdGF0ZXMoc211LCBjbG9ja3NfaW5fa2h6LCBudW1fc3RhdGVzKSBcCj4gLQkoKHNt
dSktPnBwdF9mdW5jcy0+Z2V0X3VjbGtfZHBtX3N0YXRlcyA/IChzbXUpLT5wcHRfZnVuY3MtCj4g
PmdldF91Y2xrX2RwbV9zdGF0ZXMoKHNtdSksIChjbG9ja3NfaW5fa2h6KSwgKG51bV9zdGF0ZXMp
KSA6IDApCj4gLSNkZWZpbmUgc211X2dldF9tYXhfc3VzdGFpbmFibGVfY2xvY2tzX2J5X2RjKHNt
dSwgbWF4X2Nsb2NrcykgXAo+IC0JKChzbXUpLT5mdW5jcy0+Z2V0X21heF9zdXN0YWluYWJsZV9j
bG9ja3NfYnlfZGMgPyAoc211KS0+ZnVuY3MtCj4gPmdldF9tYXhfc3VzdGFpbmFibGVfY2xvY2tz
X2J5X2RjKChzbXUpLCAobWF4X2Nsb2NrcykpIDogMCkKPiAtI2RlZmluZSBzbXVfYmFjb19pc19z
dXBwb3J0KHNtdSkgXAo+IC0JKChzbXUpLT5mdW5jcy0+YmFjb19pc19zdXBwb3J0PyAoc211KS0+
ZnVuY3MtCj4gPmJhY29faXNfc3VwcG9ydCgoc211KSkgOiBmYWxzZSkKPiAtI2RlZmluZSBzbXVf
YmFjb19nZXRfc3RhdGUoc211LCBzdGF0ZSkgXAo+IC0JKChzbXUpLT5mdW5jcy0+YmFjb19nZXRf
c3RhdGU/IChzbXUpLT5mdW5jcy0KPiA+YmFjb19nZXRfc3RhdGUoKHNtdSksIChzdGF0ZSkpIDog
MCkKPiAtI2RlZmluZSBzbXVfYmFjb19yZXNldChzbXUpIFwKPiAtCSgoc211KS0+ZnVuY3MtPmJh
Y29fcmVzZXQ/IChzbXUpLT5mdW5jcy0+YmFjb19yZXNldCgoc211KSkgOiAwKQo+IC0jZGVmaW5l
IHNtdV9tb2RlMl9yZXNldChzbXUpIFwKPiAtCSgoc211KS0+ZnVuY3MtPm1vZGUyX3Jlc2V0PyAo
c211KS0+ZnVuY3MtPm1vZGUyX3Jlc2V0KChzbXUpKQo+IDogMCkKPiArCj4gK2Jvb2wgc211X2Jh
Y29faXNfc3VwcG9ydChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSk7Cj4gKwo+ICtpbnQgc211X2Jh
Y29fZ2V0X3N0YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9iYWNvX3N0YXRl
Cj4gKnN0YXRlKTsKPiArCj4gK2ludCBzbXVfYmFjb19yZXNldChzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSk7Cj4gKwo+ICtpbnQgc211X21vZGUyX3Jlc2V0KHN0cnVjdCBzbXVfY29udGV4dCAqc211
KTsKPiAgI2RlZmluZSBzbXVfYXNpY19zZXRfcGVyZm9ybWFuY2VfbGV2ZWwoc211LCBsZXZlbCkg
XAo+ICAJKChzbXUpLT5wcHRfZnVuY3MtPnNldF9wZXJmb3JtYW5jZV9sZXZlbD8gKHNtdSktPnBw
dF9mdW5jcy0KPiA+c2V0X3BlcmZvcm1hbmNlX2xldmVsKChzbXUpLCAobGV2ZWwpKSA6IC1FSU5W
QUwpOwo+ICAjZGVmaW5lIHNtdV9kdW1wX3BwdGFibGUoc211KSBcCj4gQEAgLTgzMyw3ICs4MzUs
OCBAQCBleHRlcm4gaW50IHNtdV9nZXRfY3VycmVudF9jbG9ja3Moc3RydWN0Cj4gc211X2NvbnRl
eHQgKnNtdSwKPiAgZXh0ZXJuIGludCBzbXVfZHBtX3NldF9wb3dlcl9nYXRlKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211LHVpbnQzMl90Cj4gYmxvY2tfdHlwZSwgYm9vbCBnYXRlKTsKPiAgZXh0ZXJu
IGludCBzbXVfaGFuZGxlX3Rhc2soc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCj4gIAkJCSAgIGVu
dW0gYW1kX2RwbV9mb3JjZWRfbGV2ZWwgbGV2ZWwsCj4gLQkJCSAgIGVudW0gYW1kX3BwX3Rhc2sg
dGFza19pZCk7Cj4gKwkJCSAgIGVudW0gYW1kX3BwX3Rhc2sgdGFza19pZCwKPiArCQkJICAgYm9v
bCBsb2NrX25lZWRlZCk7Cj4gIGludCBzbXVfc3dpdGNoX3Bvd2VyX3Byb2ZpbGUoc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUsCj4gIAkJCSAgICAgZW51bSBQUF9TTUNfUE9XRVJfUFJPRklMRSB0eXBl
LAo+ICAJCQkgICAgIGJvb2wgZW4pOwo+IEBAIC04NDMsNyArODQ2LDcgQEAgaW50IHNtdV9nZXRf
ZHBtX2ZyZXFfYnlfaW5kZXgoc3RydWN0Cj4gc211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVfY2xr
X3R5cGUgY2xrX3R5cAo+ICBpbnQgc211X2dldF9kcG1fbGV2ZWxfY291bnQoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUsIGVudW0KPiBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsCj4gIAkJCSAgICB1aW50
MzJfdCAqdmFsdWUpOwo+ICBpbnQgc211X2dldF9kcG1fZnJlcV9yYW5nZShzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSwgZW51bQo+IHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwKPiAtCQkJICAgdWludDMy
X3QgKm1pbiwgdWludDMyX3QgKm1heCk7Cj4gKwkJCSAgIHVpbnQzMl90ICptaW4sIHVpbnQzMl90
ICptYXgsIGJvb2wgbG9ja19uZWVkZWQpOwo+ICBpbnQgc211X3NldF9zb2Z0X2ZyZXFfcmFuZ2Uo
c3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0KPiBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsCj4g
IAkJCSAgICB1aW50MzJfdCBtaW4sIHVpbnQzMl90IG1heCk7Cj4gIGludCBzbXVfc2V0X2hhcmRf
ZnJlcV9yYW5nZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bQo+IHNtdV9jbGtfdHlwZSBj
bGtfdHlwZSwKPiBAQCAtODU4LDEwICs4NjEsMjAgQEAgc2l6ZV90IHNtdV9zeXNfZ2V0X3BwX2Zl
YXR1cmVfbWFzayhzdHJ1Y3QKPiBzbXVfY29udGV4dCAqc211LCBjaGFyICpidWYpOwo+ICBpbnQg
c211X3N5c19zZXRfcHBfZmVhdHVyZV9tYXNrKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1aW50
NjRfdAo+IG5ld19tYXNrKTsKPiAgaW50IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211LAo+ICAJCQkgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsCj4gLQkJCSB1
aW50MzJfdCBtYXNrKTsKPiArCQkJIHVpbnQzMl90IG1hc2ssCj4gKwkJCSBib29sIGxvY2tfbmVl
ZGVkKTsKPiAgaW50IHNtdV9zZXRfbXAxX3N0YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAo+
ICAJCSAgICAgIGVudW0gcHBfbXAxX3N0YXRlIG1wMV9zdGF0ZSk7Cj4gIGludCBzbXVfc2V0X2Rm
X2NzdGF0ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKPiAgCQkgICAgICBlbnVtIHBwX2RmX2Nz
dGF0ZSBzdGF0ZSk7Cj4gCj4gK2ludCBzbXVfZ2V0X21heF9zdXN0YWluYWJsZV9jbG9ja3NfYnlf
ZGMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCj4gKwkJCQkJIHN0cnVjdCBwcF9zbXVfbnZfY2xv
Y2tfdGFibGUKPiAqbWF4X2Nsb2Nrcyk7Cj4gKwo+ICtpbnQgc211X2dldF91Y2xrX2RwbV9zdGF0
ZXMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCj4gKwkJCSAgICB1bnNpZ25lZCBpbnQgKmNsb2Nr
X3ZhbHVlc19pbl9raHosCj4gKwkJCSAgICB1bnNpZ25lZCBpbnQgKm51bV9zdGF0ZXMpOwo+ICsK
PiArZW51bSBhbWRfcG1fc3RhdGVfdHlwZSBzbXVfZ2V0X2N1cnJlbnRfcG93ZXJfc3RhdGUoc3Ry
dWN0Cj4gc211X2NvbnRleHQgKnNtdSk7Cj4gKwo+ICAjZW5kaWYKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvbmF2aTEwX3BwdC5jCj4gYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0LmMKPiBpbmRleCBiODhhYWU5YmIyNDIuLmVhZDQw
YjI4NDBmOSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9uYXZp
MTBfcHB0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0
LmMKPiBAQCAtNzk1LDEzICs3OTUsMTMgQEAgc3RhdGljIGludCBuYXZpMTBfcG9wdWxhdGVfdW1k
X3N0YXRlX2NsayhzdHJ1Y3QKPiBzbXVfY29udGV4dCAqc211KQo+ICAJaW50IHJldCA9IDA7Cj4g
IAl1aW50MzJfdCBtaW5fc2Nsa19mcmVxID0gMCwgbWluX21jbGtfZnJlcSA9IDA7Cj4gCj4gLQly
ZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgU01VX1NDTEssICZtaW5fc2Nsa19mcmVx
LAo+IE5VTEwpOwo+ICsJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9TQ0xL
LCAmbWluX3NjbGtfZnJlcSwKPiBOVUxMLCBmYWxzZSk7Cj4gIAlpZiAocmV0KQo+ICAJCXJldHVy
biByZXQ7Cj4gCj4gIAlzbXUtPnBzdGF0ZV9zY2xrID0gbWluX3NjbGtfZnJlcSAqIDEwMDsKPiAK
PiAtCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBTTVVfTUNMSywKPiAmbWluX21j
bGtfZnJlcSwgTlVMTCk7Cj4gKwlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgU01V
X01DTEssCj4gJm1pbl9tY2xrX2ZyZXEsIE5VTEwsIGZhbHNlKTsKPiAgCWlmIChyZXQpCj4gIAkJ
cmV0dXJuIHJldDsKPiAKPiBAQCAtODU0LDcgKzg1NCw3IEBAIHN0YXRpYyBpbnQgbmF2aTEwX3By
ZV9kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkKHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUpCj4gIAkJ
cmV0dXJuIHJldDsKPiAKPiAgCWlmIChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZF
QVRVUkVfRFBNX1VDTEtfQklUKSkKPiB7Cj4gLQkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5n
ZShzbXUsIFNNVV9VQ0xLLCBOVUxMLAo+ICZtYXhfZnJlcSk7Cj4gKwkJcmV0ID0gc211X2dldF9k
cG1fZnJlcV9yYW5nZShzbXUsIFNNVV9VQ0xLLCBOVUxMLAo+ICZtYXhfZnJlcSwgZmFsc2UpOwo+
ICAJCWlmIChyZXQpCj4gIAkJCXJldHVybiByZXQ7Cj4gIAkJcmV0ID0gc211X3NldF9oYXJkX2Zy
ZXFfcmFuZ2Uoc211LCBTTVVfVUNMSywgMCwKPiBtYXhfZnJlcSk7Cj4gQEAgLTkwNCw3ICs5MDQs
NyBAQCBzdGF0aWMgaW50IG5hdmkxMF9mb3JjZV9kcG1fbGltaXRfdmFsdWUoc3RydWN0Cj4gc211
X2NvbnRleHQgKnNtdSwgYm9vbCBoaWdoZXN0KQo+IAo+ICAJZm9yIChpID0gMDsgaSA8IEFSUkFZ
X1NJWkUoY2xrcyk7IGkrKykgewo+ICAJCWNsa190eXBlID0gY2xrc1tpXTsKPiAtCQlyZXQgPSBz
bXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgY2xrX3R5cGUsICZtaW5fZnJlcSwKPiAmbWF4X2Zy
ZXEpOwo+ICsJCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlwZSwgJm1p
bl9mcmVxLAo+ICZtYXhfZnJlcSwgZmFsc2UpOwo+ICAJCWlmIChyZXQpCj4gIAkJCXJldHVybiBy
ZXQ7Cj4gCj4gQEAgLTkzMSw3ICs5MzEsNyBAQCBzdGF0aWMgaW50IG5hdmkxMF91bmZvcmNlX2Rw
bV9sZXZlbHMoc3RydWN0Cj4gc211X2NvbnRleHQgKnNtdSkKPiAKPiAgCWZvciAoaSA9IDA7IGkg
PCBBUlJBWV9TSVpFKGNsa3MpOyBpKyspIHsKPiAgCQljbGtfdHlwZSA9IGNsa3NbaV07Cj4gLQkJ
cmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCAmbWluX2ZyZXEsCj4g
Jm1heF9mcmVxKTsKPiArCQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgY2xrX3R5
cGUsICZtaW5fZnJlcSwKPiAmbWF4X2ZyZXEsIGZhbHNlKTsKPiAgCQlpZiAocmV0KQo+ICAJCQly
ZXR1cm4gcmV0Owo+IAo+IEBAIC0xMjY2LDcgKzEyNjYsMTAgQEAgc3RhdGljIGludCBuYXZpMTBf
bm90aWZ5X3NtY19kaXNwYWx5X2NvbmZpZyhzdHJ1Y3QKPiBzbXVfY29udGV4dCAqc211KQo+ICAJ
aWYgKHNtdV9mZWF0dXJlX2lzX3N1cHBvcnRlZChzbXUsCj4gU01VX0ZFQVRVUkVfRFBNX0RDRUZD
TEtfQklUKSkgewo+ICAJCWNsb2NrX3JlcS5jbG9ja190eXBlID0gYW1kX3BwX2RjZWZfY2xvY2s7
Cj4gIAkJY2xvY2tfcmVxLmNsb2NrX2ZyZXFfaW5fa2h6ID0gbWluX2Nsb2Nrcy5kY2VmX2Nsb2Nr
ICogMTA7Cj4gLQkJaWYgKCFzbXVfZGlzcGxheV9jbG9ja192b2x0YWdlX3JlcXVlc3Qoc211LCAm
Y2xvY2tfcmVxKSkgewo+ICsKPiArCQlpZiAoc211LT5mdW5jcy0+ZGlzcGxheV9jbG9ja192b2x0
YWdlX3JlcXVlc3QpCj4gKwkJCXJldCA9IHNtdS0+ZnVuY3MtCj4gPmRpc3BsYXlfY2xvY2tfdm9s
dGFnZV9yZXF1ZXN0KHNtdSwgJmNsb2NrX3JlcSk7Cj4gKwkJaWYgKCFyZXQpIHsKPiAgCQkJaWYg
KHNtdV9mZWF0dXJlX2lzX3N1cHBvcnRlZChzbXUsCj4gU01VX0ZFQVRVUkVfRFNfRENFRkNMS19C
SVQpKSB7Cj4gIAkJCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LAo+IAo+
IFNNVV9NU0dfU2V0TWluRGVlcFNsZWVwRGNlZmNsaywKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9wb3dlcnBsYXkvcmVub2lyX3BwdC5jCj4gYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L3Bvd2VycGxheS9yZW5vaXJfcHB0LmMKPiBpbmRleCA2YWVkZmZkNzM5ZGIuLjYwMzZmNjgyZTZm
OSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9yZW5vaXJfcHB0
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9yZW5vaXJfcHB0LmMKPiBA
QCAtMTk0LDcgKzE5NCw3IEBAIHN0YXRpYyBpbnQgcmVub2lyX3ByaW50X2Nsa19sZXZlbHMoc3Ry
dWN0IHNtdV9jb250ZXh0Cj4gKnNtdSwKPiAgCWNhc2UgU01VX1NDTEs6Cj4gIAkJLyogcmV0aXJ2
ZSB0YWJsZSByZXR1cm5lZCBwYXJhbXRlcnMgdW5pdCBpcyBNSHogKi8KPiAgCQljdXJfdmFsdWUg
PSBtZXRyaWNzLkNsb2NrRnJlcXVlbmN5W0NMT0NLX0dGWENMS107Cj4gLQkJcmV0ID0gc211X2dl
dF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9HRlhDTEssICZtaW4sCj4gJm1heCk7Cj4gKwkJcmV0
ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9HRlhDTEssICZtaW4sCj4gJm1heCwg
ZmFsc2UpOwo+ICAJCWlmICghcmV0KSB7Cj4gIAkJCS8qIGRyaXZlciBvbmx5IGtub3cgbWluL21h
eCBnZnhfY2xrLCBBZGQgbGV2ZWwgMSBmb3IKPiBhbGwgb3RoZXIgZ2Z4IGNsa3MgKi8KPiAgCQkJ
aWYgKGN1cl92YWx1ZSAgPT0gbWF4KQo+IEBAIC0yNTEsNyArMjUxLDYgQEAgc3RhdGljIGVudW0g
YW1kX3BtX3N0YXRlX3R5cGUKPiByZW5vaXJfZ2V0X2N1cnJlbnRfcG93ZXJfc3RhdGUoc3RydWN0
IHNtdV9jb250ZXh0Cj4gIAkgICAgIXNtdV9kcG1fY3R4LT5kcG1fY3VycmVudF9wb3dlcl9zdGF0
ZSkKPiAgCQlyZXR1cm4gLUVJTlZBTDsKPiAKPiAtCW11dGV4X2xvY2soJihzbXUtPm11dGV4KSk7
Cj4gIAlzd2l0Y2ggKHNtdV9kcG1fY3R4LT5kcG1fY3VycmVudF9wb3dlcl9zdGF0ZS0KPiA+Y2xh
c3NpZmljYXRpb24udWlfbGFiZWwpIHsKPiAgCWNhc2UgU01VX1NUQVRFX1VJX0xBQkVMX0JBVFRF
Ulk6Cj4gIAkJcG1fdHlwZSA9IFBPV0VSX1NUQVRFX1RZUEVfQkFUVEVSWTsKPiBAQCAtMjY5LDcg
KzI2OCw2IEBAIHN0YXRpYyBlbnVtIGFtZF9wbV9zdGF0ZV90eXBlCj4gcmVub2lyX2dldF9jdXJy
ZW50X3Bvd2VyX3N0YXRlKHN0cnVjdCBzbXVfY29udGV4dAo+ICAJCQlwbV90eXBlID0gUE9XRVJf
U1RBVEVfVFlQRV9ERUZBVUxUOwo+ICAJCWJyZWFrOwo+ICAJfQo+IC0JbXV0ZXhfdW5sb2NrKCYo
c211LT5tdXRleCkpOwo+IAo+ICAJcmV0dXJuIHBtX3R5cGU7Cj4gIH0KPiBAQCAtMzE0LDcgKzMx
Miw3IEBAIHN0YXRpYyBpbnQgcmVub2lyX2ZvcmNlX2RwbV9saW1pdF92YWx1ZShzdHJ1Y3QKPiBz
bXVfY29udGV4dCAqc211LCBib29sIGhpZ2hlc3QpCj4gCj4gIAlmb3IgKGkgPSAwOyBpIDwgQVJS
QVlfU0laRShjbGtzKTsgaSsrKSB7Cj4gIAkJY2xrX3R5cGUgPSBjbGtzW2ldOwo+IC0JCXJldCA9
IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlwZSwgJm1pbl9mcmVxLAo+ICZtYXhf
ZnJlcSk7Cj4gKwkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCAm
bWluX2ZyZXEsCj4gJm1heF9mcmVxLCBmYWxzZSk7Cj4gIAkJaWYgKHJldCkKPiAgCQkJcmV0dXJu
IHJldDsKPiAKPiBAQCAtMzQ4LDcgKzM0Niw3IEBAIHN0YXRpYyBpbnQgcmVub2lyX3VuZm9yY2Vf
ZHBtX2xldmVscyhzdHJ1Y3QKPiBzbXVfY29udGV4dCAqc211KSB7Cj4gCj4gIAkJY2xrX3R5cGUg
PSBjbGtfZmVhdHVyZV9tYXBbaV0uY2xrX3R5cGU7Cj4gCj4gLQkJcmV0ID0gc211X2dldF9kcG1f
ZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCAmbWluX2ZyZXEsCj4gJm1heF9mcmVxKTsKPiArCQly
ZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgY2xrX3R5cGUsICZtaW5fZnJlcSwKPiAm
bWF4X2ZyZXEsIGZhbHNlKTsKPiAgCQlpZiAocmV0KQo+ICAJCQlyZXR1cm4gcmV0Owo+IAo+IEBA
IC00MzUsNyArNDMzLDcgQEAgc3RhdGljIGludCByZW5vaXJfZm9yY2VfY2xrX2xldmVscyhzdHJ1
Y3Qgc211X2NvbnRleHQKPiAqc211LAo+ICAJCQlyZXR1cm4gLUVJTlZBTDsKPiAgCQl9Cj4gCj4g
LQkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9HRlhDTEssCj4gJm1pbl9m
cmVxLCAmbWF4X2ZyZXEpOwo+ICsJCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBT
TVVfR0ZYQ0xLLAo+ICZtaW5fZnJlcSwgJm1heF9mcmVxLCBmYWxzZSk7Cj4gIAkJaWYgKHJldCkK
PiAgCQkJcmV0dXJuIHJldDsKPiAgCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0o
c211LAo+IFNNVV9NU0dfU2V0U29mdE1heEdmeENsaywKPiBAQCAtNTExLDcgKzUwOSw3IEBAIHN0
YXRpYyBpbnQgcmVub2lyX3NldF9wZWFrX2Nsb2NrX2J5X2RldmljZShzdHJ1Y3QKPiBzbXVfY29u
dGV4dCAqc211KQo+ICAJaW50IHJldCA9IDA7Cj4gIAl1aW50MzJfdCBzY2xrX2ZyZXEgPSAwLCB1
Y2xrX2ZyZXEgPSAwOwo+IAo+IC0JcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNN
VV9TQ0xLLCBOVUxMLAo+ICZzY2xrX2ZyZXEpOwo+ICsJcmV0ID0gc211X2dldF9kcG1fZnJlcV9y
YW5nZShzbXUsIFNNVV9TQ0xLLCBOVUxMLCAmc2Nsa19mcmVxLAo+IGZhbHNlKTsKPiAgCWlmIChy
ZXQpCj4gIAkJcmV0dXJuIHJldDsKPiAKPiBAQCAtNTE5LDcgKzUxNyw3IEBAIHN0YXRpYyBpbnQg
cmVub2lyX3NldF9wZWFrX2Nsb2NrX2J5X2RldmljZShzdHJ1Y3QKPiBzbXVfY29udGV4dCAqc211
KQo+ICAJaWYgKHJldCkKPiAgCQlyZXR1cm4gcmV0Owo+IAo+IC0JcmV0ID0gc211X2dldF9kcG1f
ZnJlcV9yYW5nZShzbXUsIFNNVV9VQ0xLLCBOVUxMLAo+ICZ1Y2xrX2ZyZXEpOwo+ICsJcmV0ID0g
c211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9VQ0xLLCBOVUxMLAo+ICZ1Y2xrX2ZyZXEs
IGZhbHNlKTsKPiAgCWlmIChyZXQpCj4gIAkJcmV0dXJuIHJldDsKPiAKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211X3YxMV8wLmMKPiBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvcG93ZXJwbGF5L3NtdV92MTFfMC5jCj4gaW5kZXggYjY4Y2I4YmFkYzc1Li5jYWY4
YTM3Mjg1NDEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211
X3YxMV8wLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9zbXVfdjExXzAu
Ywo+IEBAIC04MDksOCArODA5LDExIEBAIHN0YXRpYyBpbnQKPiBzbXVfdjExXzBfc2V0X21pbl9k
Y2VmX2RlZXBfc2xlZXAoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCj4gIAlpZiAoIXRhYmxlX2Nv
bnRleHQpCj4gIAkJcmV0dXJuIC1FSU5WQUw7Cj4gCj4gLQlyZXR1cm4gc211X3NldF9kZWVwX3Ns
ZWVwX2RjZWZjbGsoc211LAo+IC0JCQkJCSAgdGFibGVfY29udGV4dC0+Ym9vdF92YWx1ZXMuZGNl
ZmNsawo+IC8gMTAwKTsKPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRfZGVlcF9zbGVlcF9kY2VmY2xr
KQo+ICsJCXJldHVybiBzbXUtPmZ1bmNzLT5zZXRfZGVlcF9zbGVlcF9kY2VmY2xrKHNtdSwKPiAr
CQkJCXRhYmxlX2NvbnRleHQtPmJvb3RfdmFsdWVzLmRjZWZjbGsgLyAxMDApOwo+ICsKPiArCXJl
dHVybiAwOwo+ICB9Cj4gCj4gIHN0YXRpYyBpbnQgc211X3YxMV8wX3NldF90b29sX3RhYmxlX2xv
Y2F0aW9uKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQo+IEBAIC0xMzI1LDkgKzEzMjgsNyBAQCBz
bXVfdjExXzBfZGlzcGxheV9jbG9ja192b2x0YWdlX3JlcXVlc3Qoc3RydWN0Cj4gc211X2NvbnRl
eHQgKnNtdSwKPiAgCQlpZiAoY2xrX3NlbGVjdCA9PSBTTVVfVUNMSyAmJiBzbXUtPmRpc2FibGVf
dWNsa19zd2l0Y2gpCj4gIAkJCXJldHVybiAwOwo+IAo+IC0JCW11dGV4X2xvY2soJnNtdS0+bXV0
ZXgpOwo+ICAJCXJldCA9IHNtdV9zZXRfaGFyZF9mcmVxX3JhbmdlKHNtdSwgY2xrX3NlbGVjdCwg
Y2xrX2ZyZXEsCj4gMCk7Cj4gLQkJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiAKPiAgCQlp
ZihjbGtfc2VsZWN0ID09IFNNVV9VQ0xLKQo+ICAJCQlzbXUtPmhhcmRfbWluX3VjbGtfcmVxX2Zy
b21fZGFsID0gY2xrX2ZyZXE7Cj4gQEAgLTEzNzAsMTIgKzEzNzEsMTAgQEAgc3RhdGljIGludCBz
bXVfdjExXzBfZ2Z4X29mZl9jb250cm9sKHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUsIGJvb2wg
ZW5hYmxlKQo+ICAJY2FzZSBDSElQX05BVkkxMjoKPiAgCQlpZiAoIShhZGV2LT5wbS5wcF9mZWF0
dXJlICYgUFBfR0ZYT0ZGX01BU0spKQo+ICAJCQlyZXR1cm4gMDsKPiAtCQltdXRleF9sb2NrKCZz
bXUtPm11dGV4KTsKPiAgCQlpZiAoZW5hYmxlKQo+ICAJCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNn
KHNtdSwKPiBTTVVfTVNHX0FsbG93R2Z4T2ZmKTsKPiAgCQllbHNlCj4gIAkJCXJldCA9IHNtdV9z
ZW5kX3NtY19tc2coc211LAo+IFNNVV9NU0dfRGlzYWxsb3dHZnhPZmYpOwo+IC0JCW11dGV4X3Vu
bG9jaygmc211LT5tdXRleCk7Cj4gIAkJYnJlYWs7Cj4gIAlkZWZhdWx0Ogo+ICAJCWJyZWFrOwo+
IEBAIC0xNDkxLDEwICsxNDkwLDkgQEAgc3RhdGljIGludCBzbXVfdjExXzBfc2V0X2Zhbl9zcGVl
ZF9ycG0oc3RydWN0Cj4gc211X2NvbnRleHQgKnNtdSwKPiAgCWlmICghc3BlZWQpCj4gIAkJcmV0
dXJuIC1FSU5WQUw7Cj4gCj4gLQltdXRleF9sb2NrKCYoc211LT5tdXRleCkpOwo+ICAJcmV0ID0g
c211X3YxMV8wX2F1dG9fZmFuX2NvbnRyb2woc211LCAwKTsKPiAgCWlmIChyZXQpCj4gLQkJZ290
byBzZXRfZmFuX3NwZWVkX3JwbV9mYWlsZWQ7Cj4gKwkJcmV0dXJuIHJldDsKPiAKPiAgCWNyeXN0
YWxfY2xvY2tfZnJlcSA9IGFtZGdwdV9hc2ljX2dldF94Y2xrKGFkZXYpOwo+ICAJdGFjaF9wZXJp
b2QgPSA2MCAqIGNyeXN0YWxfY2xvY2tfZnJlcSAqIDEwMDAwIC8gKDggKiBzcGVlZCk7Cj4gQEAg
LTE1MDUsOCArMTUwMyw2IEBAIHN0YXRpYyBpbnQgc211X3YxMV8wX3NldF9mYW5fc3BlZWRfcnBt
KHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUsCj4gCj4gIAlyZXQgPSBzbXVfdjExXzBfc2V0X2Zh
bl9zdGF0aWNfbW9kZShzbXUsCj4gRkRPX1BXTV9NT0RFX1NUQVRJQ19SUE0pOwo+IAo+IC1zZXRf
ZmFuX3NwZWVkX3JwbV9mYWlsZWQ6Cj4gLQltdXRleF91bmxvY2soJihzbXUtPm11dGV4KSk7Cj4g
IAlyZXR1cm4gcmV0Owo+ICB9Cj4gCj4gQEAgLTE1MTcsMTEgKzE1MTMsOSBAQCBzdGF0aWMgaW50
IHNtdV92MTFfMF9zZXRfeGdtaV9wc3RhdGUoc3RydWN0Cj4gc211X2NvbnRleHQgKnNtdSwKPiAg
CQkJCSAgICAgdWludDMyX3QgcHN0YXRlKQo+ICB7Cj4gIAlpbnQgcmV0ID0gMDsKPiAtCW11dGV4
X2xvY2soJihzbXUtPm11dGV4KSk7Cj4gIAlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFy
YW0oc211LAo+ICAJCQkJCSAgU01VX01TR19TZXRYZ21pTW9kZSwKPiAgCQkJCQkgIHBzdGF0ZSA/
IFhHTUlfU1RBVEVfRDAgOgo+IFhHTUlfU1RBVEVfRDMpOwo+IC0JbXV0ZXhfdW5sb2NrKCYoc211
LT5tdXRleCkpOwo+ICAJcmV0dXJuIHJldDsKPiAgfQo+IAo+IEBAIC0xNjMzLDkgKzE2MjcsNyBA
QCBzdGF0aWMgaW50IHNtdV92MTFfMF9zZXRfYXphbGlhX2QzX3BtZShzdHJ1Y3QKPiBzbXVfY29u
dGV4dCAqc211KQo+ICB7Cj4gIAlpbnQgcmV0ID0gMDsKPiAKPiAtCW11dGV4X2xvY2soJnNtdS0+
bXV0ZXgpOwo+ICAJcmV0ID0gc211X3NlbmRfc21jX21zZyhzbXUsIFNNVV9NU0dfQmFjb0F1ZGlv
RDNQTUUpOwo+IC0JbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKPiAKPiAgCXJldHVybiByZXQ7
Cj4gIH0KPiBAQCAtMTc2Nyw3ICsxNzU5LDYgQEAgc3RhdGljIGludAo+IHNtdV92MTFfMF9nZXRf
ZHBtX3VsdGltYXRlX2ZyZXEoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0KPiBzbXVfY2xr
Cj4gIAlpbnQgcmV0ID0gMCwgY2xrX2lkID0gMDsKPiAgCXVpbnQzMl90IHBhcmFtID0gMDsKPiAK
PiAtCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwo+ICAJY2xrX2lkID0gc211X2Nsa19nZXRfaW5k
ZXgoc211LCBjbGtfdHlwZSk7Cj4gIAlpZiAoY2xrX2lkIDwgMCkgewo+ICAJCXJldCA9IC1FSU5W
QUw7Cj4gQEAgLTE3OTQsNyArMTc4NSw2IEBAIHN0YXRpYyBpbnQKPiBzbXVfdjExXzBfZ2V0X2Rw
bV91bHRpbWF0ZV9mcmVxKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtCj4gc211X2Nsawo+
ICAJfQo+IAo+ICBmYWlsZWQ6Cj4gLQltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICAJcmV0
dXJuIHJldDsKPiAgfQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2Vy
cGxheS9zbXVfdjEyXzAuYwo+IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211X3Yx
Ml8wLmMKPiBpbmRleCBjOTY5MWQwZmI1MjMuLjZiZjk0MmQzY2VjYSAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9zbXVfdjEyXzAuYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvcG93ZXJwbGF5L3NtdV92MTJfMC5jCj4gQEAgLTMyNSw4ICszMjUsNiBAQCBz
dGF0aWMgaW50IHNtdV92MTJfMF9nZXRfZHBtX3VsdGltYXRlX2ZyZXEoc3RydWN0Cj4gc211X2Nv
bnRleHQgKnNtdSwgZW51bSBzbXVfY2xrCj4gIAlpbnQgcmV0ID0gMDsKPiAgCXVpbnQzMl90IG1j
bGtfbWFzaywgc29jX21hc2s7Cj4gCj4gLQltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsKPiAtCj4g
IAlpZiAobWF4KSB7Cj4gIAkJcmV0ID0gc211X2dldF9wcm9maWxpbmdfY2xrX21hc2soc211LAo+
IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVfUEVBSywKPiAgCQkJCQkJIE5VTEwsCj4gQEAg
LTM5Niw3ICszOTQsNiBAQCBzdGF0aWMgaW50IHNtdV92MTJfMF9nZXRfZHBtX3VsdGltYXRlX2Zy
ZXEoc3RydWN0Cj4gc211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVfY2xrCj4gIAkJfQo+ICAJfQo+
ICBmYWlsZWQ6Cj4gLQltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOwo+ICAJcmV0dXJuIHJldDsK
PiAgfQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92ZWdh
MjBfcHB0LmMKPiBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3ZlZ2EyMF9wcHQuYwo+
IGluZGV4IGE3NmZmZDU4NDA0ZS4uYzI0OWRmOTI1NmM3IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvcG93ZXJwbGF5L3ZlZ2EyMF9wcHQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvcG93ZXJwbGF5L3ZlZ2EyMF9wcHQuYwo+IEBAIC02MzUsNyArNjM1LDYgQEAgYW1kX3Bt
X3N0YXRlX3R5cGUKPiB2ZWdhMjBfZ2V0X2N1cnJlbnRfcG93ZXJfc3RhdGUoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUpCj4gIAkgICAgIXNtdV9kcG1fY3R4LT5kcG1fY3VycmVudF9wb3dlcl9zdGF0
ZSkKPiAgCQlyZXR1cm4gLUVJTlZBTDsKPiAKPiAtCW11dGV4X2xvY2soJihzbXUtPm11dGV4KSk7
Cj4gIAlzd2l0Y2ggKHNtdV9kcG1fY3R4LT5kcG1fY3VycmVudF9wb3dlcl9zdGF0ZS0KPiA+Y2xh
c3NpZmljYXRpb24udWlfbGFiZWwpIHsKPiAgCWNhc2UgU01VX1NUQVRFX1VJX0xBQkVMX0JBVFRF
Ulk6Cj4gIAkJcG1fdHlwZSA9IFBPV0VSX1NUQVRFX1RZUEVfQkFUVEVSWTsKPiBAQCAtNjUzLDcg
KzY1Miw2IEBAIGFtZF9wbV9zdGF0ZV90eXBlCj4gdmVnYTIwX2dldF9jdXJyZW50X3Bvd2VyX3N0
YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQo+ICAJCQlwbV90eXBlID0gUE9XRVJfU1RBVEVf
VFlQRV9ERUZBVUxUOwo+ICAJCWJyZWFrOwo+ICAJfQo+IC0JbXV0ZXhfdW5sb2NrKCYoc211LT5t
dXRleCkpOwo+IAo+ICAJcmV0dXJuIHBtX3R5cGU7Cj4gIH0KPiBAQCAtMTI3Nyw4ICsxMjc1LDYg
QEAgc3RhdGljIGludCB2ZWdhMjBfZm9yY2VfY2xrX2xldmVscyhzdHJ1Y3QKPiBzbXVfY29udGV4
dCAqc211LAo+ICAJdWludDMyX3Qgc29mdF9taW5fbGV2ZWwsIHNvZnRfbWF4X2xldmVsLCBoYXJk
X21pbl9sZXZlbDsKPiAgCWludCByZXQgPSAwOwo+IAo+IC0JbXV0ZXhfbG9jaygmKHNtdS0+bXV0
ZXgpKTsKPiAtCj4gIAlzb2Z0X21pbl9sZXZlbCA9IG1hc2sgPyAoZmZzKG1hc2spIC0gMSkgOiAw
Owo+ICAJc29mdF9tYXhfbGV2ZWwgPSBtYXNrID8gKGZscyhtYXNrKSAtIDEpIDogMDsKPiAKPiBA
QCAtMTQzMSw3ICsxNDI3LDYgQEAgc3RhdGljIGludCB2ZWdhMjBfZm9yY2VfY2xrX2xldmVscyhz
dHJ1Y3QKPiBzbXVfY29udGV4dCAqc211LAo+ICAJCWJyZWFrOwo+ICAJfQo+IAo+IC0JbXV0ZXhf
dW5sb2NrKCYoc211LT5tdXRleCkpOwo+ICAJcmV0dXJuIHJldDsKPiAgfQo+IAo+IEBAIC0xNDQ2
LDggKzE0NDEsNiBAQCBzdGF0aWMgaW50Cj4gdmVnYTIwX2dldF9jbG9ja19ieV90eXBlX3dpdGhf
bGF0ZW5jeShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKPiAKPiAgCWRwbV90YWJsZSA9IHNtdV9k
cG0tPmRwbV9jb250ZXh0Owo+IAo+IC0JbXV0ZXhfbG9jaygmc211LT5tdXRleCk7Cj4gLQo+ICAJ
c3dpdGNoIChjbGtfdHlwZSkgewo+ICAJY2FzZSBTTVVfR0ZYQ0xLOgo+ICAJCXNpbmdsZV9kcG1f
dGFibGUgPSAmKGRwbV90YWJsZS0+Z2Z4X3RhYmxlKTsKPiBAQCAtMTQ2OSw3ICsxNDYyLDYgQEAg
c3RhdGljIGludAo+IHZlZ2EyMF9nZXRfY2xvY2tfYnlfdHlwZV93aXRoX2xhdGVuY3koc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUsCj4gIAkJcmV0ID0gLUVJTlZBTDsKPiAgCX0KPiAKPiAtCW11dGV4
X3VubG9jaygmc211LT5tdXRleCk7Cj4gIAlyZXR1cm4gcmV0Owo+ICB9Cj4gCj4gQEAgLTI1NDIs
OCArMjUzNCw2IEBAIHN0YXRpYyBpbnQgdmVnYTIwX3NldF9vZF9wZXJjZW50YWdlKHN0cnVjdAo+
IHNtdV9jb250ZXh0ICpzbXUsCj4gIAlpbnQgZmVhdHVyZV9lbmFibGVkOwo+ICAJUFBDTEtfZSBj
bGtfaWQ7Cj4gCj4gLQltdXRleF9sb2NrKCYoc211LT5tdXRleCkpOwo+IC0KPiAgCWRwbV90YWJs
ZSA9IHNtdV9kcG0tPmRwbV9jb250ZXh0Owo+ICAJZ29sZGVuX3RhYmxlID0gc211X2RwbS0+Z29s
ZGVuX2RwbV9jb250ZXh0Owo+IAo+IEBAIC0yNTkzLDExICsyNTgzLDEwIEBAIHN0YXRpYyBpbnQg
dmVnYTIwX3NldF9vZF9wZXJjZW50YWdlKHN0cnVjdAo+IHNtdV9jb250ZXh0ICpzbXUsCj4gIAl9
Cj4gCj4gIAlyZXQgPSBzbXVfaGFuZGxlX3Rhc2soc211LCBzbXVfZHBtLT5kcG1fbGV2ZWwsCj4g
LQkJCSAgICAgIEFNRF9QUF9UQVNLX1JFQURKVVNUX1BPV0VSX1NUQVRFKTsKPiArCQkJICAgICAg
QU1EX1BQX1RBU0tfUkVBREpVU1RfUE9XRVJfU1RBVEUsCj4gKwkJCSAgICAgIGZhbHNlKTsKPiAK
PiAgc2V0X29kX2ZhaWxlZDoKPiAtCW11dGV4X3VubG9jaygmKHNtdS0+bXV0ZXgpKTsKPiAtCj4g
IAlyZXR1cm4gcmV0Owo+ICB9Cj4gCj4gQEAgLTI4MjIsMTAgKzI4MTEsOSBAQCBzdGF0aWMgaW50
IHZlZ2EyMF9vZG5fZWRpdF9kcG1fdGFibGUoc3RydWN0Cj4gc211X2NvbnRleHQgKnNtdSwKPiAg
CX0KPiAKPiAgCWlmICh0eXBlID09IFBQX09EX0NPTU1JVF9EUE1fVEFCTEUpIHsKPiAtCQltdXRl
eF9sb2NrKCYoc211LT5tdXRleCkpOwo+ICAJCXJldCA9IHNtdV9oYW5kbGVfdGFzayhzbXUsIHNt
dV9kcG0tPmRwbV9sZXZlbCwKPiAtCj4gQU1EX1BQX1RBU0tfUkVBREpVU1RfUE9XRVJfU1RBVEUp
Owo+IC0JCW11dGV4X3VubG9jaygmKHNtdS0+bXV0ZXgpKTsKPiArCj4gQU1EX1BQX1RBU0tfUkVB
REpVU1RfUE9XRVJfU1RBVEUsCj4gKwkJCQkgICAgICBmYWxzZSk7Cj4gIAl9Cj4gCj4gIAlyZXR1
cm4gcmV0Owo+IC0tCj4gMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2Ft
ZC1nZng=
