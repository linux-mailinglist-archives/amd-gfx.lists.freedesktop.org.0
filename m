Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1EB4A112EA5
	for <lists+amd-gfx@lfdr.de>; Wed,  4 Dec 2019 16:38:31 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 895A36E0CC;
	Wed,  4 Dec 2019 15:38:29 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wm1-x341.google.com (mail-wm1-x341.google.com
 [IPv6:2a00:1450:4864:20::341])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 93FB56E0CC
 for <amd-gfx@lists.freedesktop.org>; Wed,  4 Dec 2019 15:38:27 +0000 (UTC)
Received: by mail-wm1-x341.google.com with SMTP id p17so193894wmi.3
 for <amd-gfx@lists.freedesktop.org>; Wed, 04 Dec 2019 07:38:27 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=erC7HWDpX6YJ6/bq74S+D6WQ8iAyHhhN2YTunu45dAY=;
 b=sfh8pX4hxa/rIa7GR/VEd9Lg6vCnDUa63o8VRTPnzJBKOfXaPUGlX8Yr7/lzrVIiOe
 InUBPO+h8ZpUUdbFgGLnj0YooFFxgdqR+RIV9Nd3VBCYTsu/gW63CwGJOVrCt3NZMXMZ
 5yBLNnTk8x8nweTi0T0EJ8r2DrXexrIMfHeCuu7JDeV3HrQfyhA47T6n2lSFsrrrrk8j
 kZf21r92JD8piIHElLENXfitG+j1eRHeD0Bisa0iXdu6hBw4es11MVxDdqu2YgpoR6om
 6ox9V0KmWqiC5OL2xQtf10/TDlRjUuuE0MbyrWS688ozJ2nqeeiwl9GmGIXt9SBvwWGM
 7hhg==
X-Gm-Message-State: APjAAAWh1Pa4E1FlR+MXSAHmGKvG9L3vjL6mQqDm4/c5uMAmWgoMw+uZ
 6CNVNLpNikZ00g/yEeDtriKaxMWE
X-Google-Smtp-Source: APXvYqxUqhEUKPIi3h/7FEBWw8pCZPhCu5PZ/10wMPPxDns+4Nh3wHsQVBBEQkWf2rFB/LN6Up/pfg==
X-Received: by 2002:a1c:3d8a:: with SMTP id k132mr94126wma.144.1575473905848; 
 Wed, 04 Dec 2019 07:38:25 -0800 (PST)
Received: from abel.fritz.box ([2a02:908:1252:fb60:b1cc:d5dc:38e4:49b0])
 by smtp.gmail.com with ESMTPSA id k13sm7103710wrx.59.2019.12.04.07.38.25
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 04 Dec 2019 07:38:25 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: amd-gfx@lists.freedesktop.org, felix.kuehling@amd.com, philip.yang@amd.com
Subject: [PATCH 3/3] drm/amdgpu: stop adding VM updates fences to the resv obj
Date: Wed,  4 Dec 2019 16:38:22 +0100
Message-Id: <20191204153822.2199-3-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191204153822.2199-1-christian.koenig@amd.com>
References: <20191204153822.2199-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=erC7HWDpX6YJ6/bq74S+D6WQ8iAyHhhN2YTunu45dAY=;
 b=Z/9Lcuz7UCpNnBT2sWtCBahuJl7dpZyGcm/5i8bZ8Ps47gy13vM/95M/GHCH/bzXPw
 dfeAU0yVk+fYXX/UD+GibJfiEJ/ajFZUlLdAYU8DMqVUEV+uXl9gBUyE+8dBoADVkeqf
 w7t7+7vVl6TDx9oEdgTATz2jF8/M0rxsa1/ZY8w91Gee3JF1N2cbd9Phs55jnl+b98M9
 IbWhAxsCprczEDABp957C9RxFU2rGKHjs4jqAZe4oNDymQpL6/6G4yGAFLfnyH2iWmLC
 kMPyOT98dQj3sgQIZH7E1sAnqIBCbR4AnlbBcrYVwOGZmty3thiZIoZyA9FzqU+L3FiU
 MA1w==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

VGhpcyB3YXkgd2UgY2FuIGRvIHVwZGF0ZXMgZXZlbiB3aXRob3V0IHRoZSByZXN2IG9iaiBsb2Nr
ZWQuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFt
ZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3N5bmMuYyAgICB8
ICA2ICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYyAgICAgIHwg
MzAgKysrKysrKysrKysrKysrKysrLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfdm0uaCAgICAgIHwgIDQgKysrCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
dm1fc2RtYS5jIHwgMTEgKysrKystLS0KIDQgZmlsZXMgY2hhbmdlZCwgNDAgaW5zZXJ0aW9ucygr
KSwgMTEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3N5bmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9zeW5j
LmMKaW5kZXggOWIyOGMxZWI1ZjQ5Li43ZjE3YzA2YjhhM2YgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9zeW5jLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3N5bmMuYwpAQCAtMjQxLDEwICsyNDEsOCBAQCBpbnQgYW1kZ3B1X3N5
bmNfcmVzdihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCS8qIFZNIHVwZGF0ZXMgYXJl
IG9ubHkgaW50ZXJlc3RpbmcKIAkJCSAqIGZvciBvdGhlciBWTSB1cGRhdGVzIGFuZCBtb3Zlcy4K
IAkJCSAqLwotCQkJaWYgKChvd25lciAhPSBBTURHUFVfRkVOQ0VfT1dORVJfVU5ERUZJTkVEKSAm
JgotCQkJICAgIChmZW5jZV9vd25lciAhPSBBTURHUFVfRkVOQ0VfT1dORVJfVU5ERUZJTkVEKSAm
JgotCQkJICAgICgob3duZXIgPT0gQU1ER1BVX0ZFTkNFX09XTkVSX1ZNKSAhPQotCQkJICAgICAo
ZmVuY2Vfb3duZXIgPT0gQU1ER1BVX0ZFTkNFX09XTkVSX1ZNKSkpCisJCQlpZiAob3duZXIgPT0g
QU1ER1BVX0ZFTkNFX09XTkVSX1ZNICYmCisJCQkgICAgZmVuY2Vfb3duZXIgIT0gQU1ER1BVX0ZF
TkNFX09XTkVSX1VOREVGSU5FRCkKIAkJCQljb250aW51ZTsKIAogCQkJLyogSWdub3JlIGZlbmNl
IGZyb20gdGhlIHNhbWUgb3duZXIgYW5kIGV4cGxpY2l0IG9uZSBhcwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfdm0uYwppbmRleCBhMjJiZDU3MTI5ZDEuLjBkNzAwZTgxNTRjNCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMKQEAgLTU2Miw4ICs1NjIsOCBAQCB2
b2lkIGFtZGdwdV92bV9nZXRfcGRfYm8oc3RydWN0IGFtZGdwdV92bSAqdm0sCiB7CiAJZW50cnkt
PnByaW9yaXR5ID0gMDsKIAllbnRyeS0+dHYuYm8gPSAmdm0tPnJvb3QuYmFzZS5iby0+dGJvOwot
CS8qIE9uZSBmb3IgdGhlIFZNIHVwZGF0ZXMsIG9uZSBmb3IgVFRNIGFuZCBvbmUgZm9yIHRoZSBD
UyBqb2IgKi8KLQllbnRyeS0+dHYubnVtX3NoYXJlZCA9IDM7CisJLyogT25lIGZvciBUVE0gYW5k
IG9uZSBmb3IgdGhlIENTIGpvYiAqLworCWVudHJ5LT50di5udW1fc2hhcmVkID0gMjsKIAllbnRy
eS0+dXNlcl9wYWdlcyA9IE5VTEw7CiAJbGlzdF9hZGQoJmVudHJ5LT50di5oZWFkLCB2YWxpZGF0
ZWQpOwogfQpAQCAtMjUyMiw2ICsyNTIyLDExIEBAIGJvb2wgYW1kZ3B1X3ZtX2V2aWN0YWJsZShz
dHJ1Y3QgYW1kZ3B1X2JvICpibykKIAlpZiAoIWRtYV9yZXN2X3Rlc3Rfc2lnbmFsZWRfcmN1KGJv
LT50Ym8uYmFzZS5yZXN2LCB0cnVlKSkKIAkJcmV0dXJuIGZhbHNlOwogCisJLyogRG9uJ3QgZXZp
Y3QgVk0gcGFnZSB0YWJsZXMgd2hpbGUgdGhleSBhcmUgdXBkYXRlZCAqLworCWlmICghZG1hX2Zl
bmNlX2lzX3NpZ25hbGVkKGJvX2Jhc2UtPnZtLT5sYXN0X2RpcmVjdCkgfHwKKwkgICAgIWRtYV9m
ZW5jZV9pc19zaWduYWxlZChib19iYXNlLT52bS0+bGFzdF9kZWxheWVkKSkKKwkJcmV0dXJuIGZh
bHNlOworCiAJcmV0dXJuIHRydWU7CiB9CiAKQEAgLTI2ODcsOCArMjY5MiwxNiBAQCB2b2lkIGFt
ZGdwdV92bV9hZGp1c3Rfc2l6ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgdWludDMyX3Qg
bWluX3ZtX3NpemUsCiAgKi8KIGxvbmcgYW1kZ3B1X3ZtX3dhaXRfaWRsZShzdHJ1Y3QgYW1kZ3B1
X3ZtICp2bSwgbG9uZyB0aW1lb3V0KQogewotCXJldHVybiBkbWFfcmVzdl93YWl0X3RpbWVvdXRf
cmN1KHZtLT5yb290LmJhc2UuYm8tPnRiby5iYXNlLnJlc3YsCi0JCQkJCQkgICB0cnVlLCB0cnVl
LCB0aW1lb3V0KTsKKwl0aW1lb3V0ID0gZG1hX3Jlc3Zfd2FpdF90aW1lb3V0X3JjdSh2bS0+cm9v
dC5iYXNlLmJvLT50Ym8uYmFzZS5yZXN2LAorCQkJCQkgICAgdHJ1ZSwgdHJ1ZSwgdGltZW91dCk7
CisJaWYgKHRpbWVvdXQgPD0gMCkKKwkJcmV0dXJuIHRpbWVvdXQ7CisKKwl0aW1lb3V0ID0gZG1h
X2ZlbmNlX3dhaXRfdGltZW91dCh2bS0+bGFzdF9kaXJlY3QsIHRydWUsIHRpbWVvdXQpOworCWlm
ICh0aW1lb3V0IDw9IDApCisJCXJldHVybiB0aW1lb3V0OworCisJcmV0dXJuIGRtYV9mZW5jZV93
YWl0X3RpbWVvdXQodm0tPmxhc3RfZGVsYXllZCwgdHJ1ZSwgdGltZW91dCk7CiB9CiAKIC8qKgpA
QCAtMjc1Nyw2ICsyNzcwLDggQEAgaW50IGFtZGdwdV92bV9pbml0KHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LCBzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwKIAllbHNlCiAJCXZtLT51cGRhdGVfZnVu
Y3MgPSAmYW1kZ3B1X3ZtX3NkbWFfZnVuY3M7CiAJdm0tPmxhc3RfdXBkYXRlID0gTlVMTDsKKwl2
bS0+bGFzdF9kaXJlY3QgPSBkbWFfZmVuY2VfZ2V0X3N0dWIoKTsKKwl2bS0+bGFzdF9kZWxheWVk
ID0gZG1hX2ZlbmNlX2dldF9zdHViKCk7CiAKIAlhbWRncHVfdm1fYm9fcGFyYW0oYWRldiwgdm0s
IGFkZXYtPnZtX21hbmFnZXIucm9vdF9sZXZlbCwgZmFsc2UsICZicCk7CiAJaWYgKHZtX2NvbnRl
eHQgPT0gQU1ER1BVX1ZNX0NPTlRFWFRfQ09NUFVURSkKQEAgLTI4MDcsNiArMjgyMiw4IEBAIGlu
dCBhbWRncHVfdm1faW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgc3RydWN0IGFtZGdw
dV92bSAqdm0sCiAJdm0tPnJvb3QuYmFzZS5ibyA9IE5VTEw7CiAKIGVycm9yX2ZyZWVfZGVsYXll
ZDoKKwlkbWFfZmVuY2VfcHV0KHZtLT5sYXN0X2RpcmVjdCk7CisJZG1hX2ZlbmNlX3B1dCh2bS0+
bGFzdF9kZWxheWVkKTsKIAlkcm1fc2NoZWRfZW50aXR5X2Rlc3Ryb3koJnZtLT5kZWxheWVkKTsK
IAogZXJyb3JfZnJlZV9kaXJlY3Q6CkBAIC0zMDA3LDYgKzMwMjQsMTEgQEAgdm9pZCBhbWRncHVf
dm1fZmluaShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgc3RydWN0IGFtZGdwdV92bSAqdm0p
CiAJCXZtLT5wYXNpZCA9IDA7CiAJfQogCisJZG1hX2ZlbmNlX3dhaXQodm0tPmxhc3RfZGlyZWN0
LCBmYWxzZSk7CisJZG1hX2ZlbmNlX3B1dCh2bS0+bGFzdF9kaXJlY3QpOworCWRtYV9mZW5jZV93
YWl0KHZtLT5sYXN0X2RlbGF5ZWQsIGZhbHNlKTsKKwlkbWFfZmVuY2VfcHV0KHZtLT5sYXN0X2Rl
bGF5ZWQpOworCiAJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG1hcHBpbmcsIHRtcCwgJnZtLT5m
cmVlZCwgbGlzdCkgewogCQlpZiAobWFwcGluZy0+ZmxhZ3MgJiBBTURHUFVfUFRFX1BSVCAmJiBw
cnRfZmluaV9uZWVkZWQpIHsKIAkJCWFtZGdwdV92bV9wcnRfZmluaShhZGV2LCB2bSk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uaCBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5oCmluZGV4IGRiNTYxNzY1NDUzYi4uZDkzZWE5
YWQ4NzllIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0u
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uaApAQCAtMjY5LDYg
KzI2OSwxMCBAQCBzdHJ1Y3QgYW1kZ3B1X3ZtIHsKIAlzdHJ1Y3QgZHJtX3NjaGVkX2VudGl0eQlk
aXJlY3Q7CiAJc3RydWN0IGRybV9zY2hlZF9lbnRpdHkJZGVsYXllZDsKIAorCS8qIExhc3Qgc3Vi
bWlzc2lvbiB0byB0aGUgc2NoZWR1bGVyIGVudGl0aWVzICovCisJc3RydWN0IGRtYV9mZW5jZQkq
bGFzdF9kaXJlY3Q7CisJc3RydWN0IGRtYV9mZW5jZQkqbGFzdF9kZWxheWVkOworCiAJdW5zaWdu
ZWQgaW50CQlwYXNpZDsKIAkvKiBkZWRpY2F0ZWQgdG8gdm0gKi8KIAlzdHJ1Y3QgYW1kZ3B1X3Zt
aWQJKnJlc2VydmVkX3ZtaWRbQU1ER1BVX01BWF9WTUhVQlNdOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtX3NkbWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV92bV9zZG1hLmMKaW5kZXggODMyZGI1OWY0NDFlLi4wNGU3OWM3NWM4
N2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bV9zZG1h
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtX3NkbWEuYwpAQCAt
OTUsMTEgKzk1LDEwIEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3ZtX3NkbWFfcHJlcGFyZShzdHJ1Y3Qg
YW1kZ3B1X3ZtX3VwZGF0ZV9wYXJhbXMgKnAsCiBzdGF0aWMgaW50IGFtZGdwdV92bV9zZG1hX2Nv
bW1pdChzdHJ1Y3QgYW1kZ3B1X3ZtX3VwZGF0ZV9wYXJhbXMgKnAsCiAJCQkJIHN0cnVjdCBkbWFf
ZmVuY2UgKipmZW5jZSkKIHsKLQlzdHJ1Y3QgYW1kZ3B1X2JvICpyb290ID0gcC0+dm0tPnJvb3Qu
YmFzZS5ibzsKIAlzdHJ1Y3QgYW1kZ3B1X2liICppYiA9IHAtPmpvYi0+aWJzOwogCXN0cnVjdCBk
cm1fc2NoZWRfZW50aXR5ICplbnRpdHk7CisJc3RydWN0IGRtYV9mZW5jZSAqZiwgKnRtcDsKIAlz
dHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmc7Ci0Jc3RydWN0IGRtYV9mZW5jZSAqZjsKIAlpbnQgcjsK
IAogCWVudGl0eSA9IHAtPmRpcmVjdCA/ICZwLT52bS0+ZGlyZWN0IDogJnAtPnZtLT5kZWxheWVk
OwpAQCAtMTEyLDcgKzExMSwxMyBAQCBzdGF0aWMgaW50IGFtZGdwdV92bV9zZG1hX2NvbW1pdChz
dHJ1Y3QgYW1kZ3B1X3ZtX3VwZGF0ZV9wYXJhbXMgKnAsCiAJaWYgKHIpCiAJCWdvdG8gZXJyb3I7
CiAKLQlhbWRncHVfYm9fZmVuY2Uocm9vdCwgZiwgdHJ1ZSk7CisJdG1wID0gZG1hX2ZlbmNlX2dl
dChmKTsKKwlpZiAocC0+ZGlyZWN0KQorCQlzd2FwKHAtPnZtLT5sYXN0X2RpcmVjdCwgdG1wKTsK
KwllbHNlCisJCXN3YXAocC0+dm0tPmxhc3RfZGVsYXllZCwgdG1wKTsKKwlkbWFfZmVuY2VfcHV0
KHRtcCk7CisKIAlpZiAoZmVuY2UgJiYgIXAtPmRpcmVjdCkKIAkJc3dhcCgqZmVuY2UsIGYpOwog
CWRtYV9mZW5jZV9wdXQoZik7Ci0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vYW1kLWdmeA==
