Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 143E1F7AAE
	for <lists+amd-gfx@lfdr.de>; Mon, 11 Nov 2019 19:23:16 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 884C06E260;
	Mon, 11 Nov 2019 18:23:14 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-il1-x142.google.com (mail-il1-x142.google.com
 [IPv6:2607:f8b0:4864:20::142])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 60A9F6E260
 for <amd-gfx@lists.freedesktop.org>; Mon, 11 Nov 2019 18:23:13 +0000 (UTC)
Received: by mail-il1-x142.google.com with SMTP id a7so12525416ild.6
 for <amd-gfx@lists.freedesktop.org>; Mon, 11 Nov 2019 10:23:13 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=zNSgeyuwKDQiyxQGxChyPLAIUQ1Ydi9orcNCD8R1Sts=;
 b=TCiF+Q7WXNWu9jn08gJwXKmIl8Rey9bT6TyeDZeoLXHiDXxEPFHJMoJu75x9brr+BU
 Eoh46Wpky9L7cFFlRdjIW+CDpNNkpYK98ByBm/0Z1V8dOl8wHa8jHgCuAuOY91HrdesL
 oAKwqx6xFt5863aXA/Wn+lwd1JCCd81L4POJFs3idWakFgSMbJz5hPJ5PKa1EVGDF0gf
 /GJxfHnPx63CqDMU2qnLAzrmzUfov6ArBzKkvU33zwyAJ3iuBMjwuwIVmm07HeC52Slh
 +Czx/gWIeeVJe5gdPk71l+ZPnUu9X6Xw6kSj5Gw9/sR3xRV5XeXr61flySWCoK8ouG8W
 I0ag==
X-Gm-Message-State: APjAAAV7aDvFR5+oSs4kVGhOtgEZql6CGzm9oEj6/GVNtVKm14T0oE1L
 Qr+F0KDHdH1XciP8jKVqhxg=
X-Google-Smtp-Source: APXvYqxzsZzumUo0dp65v4GT4TUZ66++DA0JJ8SgUBlLVE++J8CDioG/NdXEKffeIKAGFus3GKVX6A==
X-Received: by 2002:a05:6e02:100b:: with SMTP id
 n11mr31141939ilj.212.1573496592501; 
 Mon, 11 Nov 2019 10:23:12 -0800 (PST)
Received: from localhost.localdomain ([2602:47:da84:5600:6d4:c4ff:fe4a:ea6b])
 by smtp.gmail.com with ESMTPSA id
 m7sm124980iop.56.2019.11.11.10.23.11
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 11 Nov 2019 10:23:11 -0800 (PST)
From: Matt Coffin <mcoffin13@gmail.com>
To: Alexander.Deucher@amd.com
Subject: [PATCH v2 1/3] drm/amdgpu/navi10: implement sclk/mclk OD via
 pp_od_clk_voltage
Date: Mon, 11 Nov 2019 11:22:35 -0700
Message-Id: <25bbc1b19042f74f1429da25e552ce71a68de92e.1573496261.git.mcoffin13@gmail.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <CADnq5_MXWLkDoAwc8w=jB4uRuyd=JSuW=f0BbFXs1Dx8LwKh6g@mail.gmail.com>
References: <CADnq5_MXWLkDoAwc8w=jB4uRuyd=JSuW=f0BbFXs1Dx8LwKh6g@mail.gmail.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=zNSgeyuwKDQiyxQGxChyPLAIUQ1Ydi9orcNCD8R1Sts=;
 b=d4FOc4N7s1KaDyvv8ZKTFqva5mpOXvIWYegdyusR4KlcekNth0rlEG5vNM81duluXY
 QXrTFU+EMOJr/vRnujuWm6Xa24Pkpyg8d+uNiUc5ywc4CoyFdyS42u++7toxX7RRpoAG
 uiKE6SS71+9Uwy0fgBl3I7FDtTWMcGGtxyqEFXBSqJpRA4QT0Q7swNB9FjVDO/3LQOlX
 yUNw63QBde2WRK+fYLWLH8egaxLwz5XeAVuJwUvrOfGTDgZz7TiAuhG+5CitYda8qPYi
 aglbPUAQV8vYu0gakCUEGYtYv4UHCxLPuhNeQEO9M//8p4JeUxoACS2pDr/oRONr2Ev8
 qVKA==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Matt Coffin <mcoffin13@gmail.com>, Evan.Quan@amd.com,
 amd-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

W1doeV0KQmVmb3JlIHRoaXMgcGF0Y2gsIHRoZXJlIHdhcyBubyB3YXkgdG8gdXNlIHBwX29kX2Ns
a192b2x0YWdlIG9uIG5hdmkKCltIb3ddClNpbWlsYXIgdG8gdGhlIHZlZ2EyMCBpbXBsZW1lbnRh
dGlvbiwgYnV0IHVzaW5nIHRoZSBjb21tb24gc21jX3YxMV8wCmhlYWRlcnMsIGltcGxlbWVudGVk
IHRoZSBwcF9vZF9jbGtfdm9sdGFnZSBBUEkgZm9yIG5hdmkxMCdzIHBwdGFibGUKaW1wbGVtZW50
YXRpb24KClNpZ25lZC1vZmYtYnk6IE1hdHQgQ29mZmluIDxtY29mZmluMTNAZ21haWwuY29tPgot
LS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2luYy9zbXVfdjExXzAuaCB8ICAgMiAr
CiBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0LmMgICAgfCAxODAgKysr
KysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9zbXVfdjExXzAu
YyAgICAgfCAgMjcgKysrCiAzIGZpbGVzIGNoYW5nZWQsIDIwOSBpbnNlcnRpb25zKCspCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5jL3NtdV92MTFfMC5oIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5jL3NtdV92MTFfMC5oCmluZGV4IGZkNmVj
OTAzM2QwNi4uMTU0YjU3YTRkYmJiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bv
d2VycGxheS9pbmMvc211X3YxMV8wLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBs
YXkvaW5jL3NtdV92MTFfMC5oCkBAIC0yNTAsNCArMjUwLDYgQEAgaW50IHNtdV92MTFfMF9zZXRf
c29mdF9mcmVxX2xpbWl0ZWRfcmFuZ2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0gc211
X2Nsa18KIAogaW50IHNtdV92MTFfMF9vdmVycmlkZV9wY2llX3BhcmFtZXRlcnMoc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUpOwogCitpbnQgc211X3YxMV8wX3NldF9kZWZhdWx0X29kX3NldHRpbmdz
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBib29sIGluaXRpYWxpemUsIHNpemVfdCBvdmVyZHJp
dmVfdGFibGVfc2l6ZSk7CisKICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9wb3dlcnBsYXkvbmF2aTEwX3BwdC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkv
bmF2aTEwX3BwdC5jCmluZGV4IDM1NGY3MDk3OGY4Mi4uMzU0ZjYzMTAzMzA4IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0LmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvbmF2aTEwX3BwdC5jCkBAIC0xNjQ5LDEwICsxNjQ5LDE4
OCBAQCBzdGF0aWMgaW50IG5hdmkxMF91cGRhdGVfcGNpZV9wYXJhbWV0ZXJzKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211LAogCQkJCQkgIFNNVV9NU0dfT3ZlcnJpZGVQY2llUGFyYW1ldGVycywKIAkJ
CQkJICBzbXVfcGNpZV9hcmcpOwogCX0KKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW5saW5l
IHZvaWQgbmF2aTEwX2R1bXBfb2RfdGFibGUoT3ZlckRyaXZlVGFibGVfdCAqb2RfdGFibGUpIHsK
Kwlwcl9kZWJ1ZygiT0Q6IEdmeGNsazogKCVkLCAlZClcbiIsIG9kX3RhYmxlLT5HZnhjbGtGbWlu
LCBvZF90YWJsZS0+R2Z4Y2xrRm1heCk7CisJcHJfZGVidWcoIk9EOiBHZngxOiAoJWQsICVkKVxu
Iiwgb2RfdGFibGUtPkdmeGNsa0ZyZXExLCBvZF90YWJsZS0+R2Z4Y2xrVm9sdDEpOworCXByX2Rl
YnVnKCJPRDogR2Z4MjogKCVkLCAlZClcbiIsIG9kX3RhYmxlLT5HZnhjbGtGcmVxMiwgb2RfdGFi
bGUtPkdmeGNsa1ZvbHQyKTsKKwlwcl9kZWJ1ZygiT0Q6IEdmeDM6ICglZCwgJWQpXG4iLCBvZF90
YWJsZS0+R2Z4Y2xrRnJlcTMsIG9kX3RhYmxlLT5HZnhjbGtWb2x0Myk7CisJcHJfZGVidWcoIk9E
OiBVY2xrRm1heDogJWRcbiIsIG9kX3RhYmxlLT5VY2xrRm1heCk7CisJcHJfZGVidWcoIk9EOiBP
dmVyRHJpdmVQY3Q6ICVkXG4iLCBvZF90YWJsZS0+T3ZlckRyaXZlUGN0KTsKK30KKworc3RhdGlj
IGlubGluZSBib29sIG5hdmkxMF9vZF9mZWF0dXJlX2lzX3N1cHBvcnRlZChzdHJ1Y3Qgc211XzEx
XzBfb3ZlcmRyaXZlX3RhYmxlICpvZF90YWJsZSwgZW51bSBTTVVfMTFfMF9PREZFQVRVUkVfSUQg
ZmVhdHVyZSkKK3sKKwlyZXR1cm4gb2RfdGFibGUtPmNhcFtmZWF0dXJlXTsKK30KKworc3RhdGlj
IGludCBuYXZpMTBfb2Rfc2V0dGluZ19jaGVja19yYW5nZShzdHJ1Y3Qgc211XzExXzBfb3ZlcmRy
aXZlX3RhYmxlICpvZF90YWJsZSwgZW51bSBTTVVfMTFfMF9PRFNFVFRJTkdfSUQgc2V0dGluZywg
dWludDMyX3QgdmFsdWUpCit7CisJaWYgKHZhbHVlIDwgb2RfdGFibGUtPm1pbltzZXR0aW5nXSkg
eworCQlwcl93YXJuKCJPRCBzZXR0aW5nICglZCwgJWQpIGlzIGxlc3MgdGhhbiB0aGUgbWluaW11
bSBhbGxvd2VkICglZClcbiIsIHNldHRpbmcsIHZhbHVlLCBvZF90YWJsZS0+bWluW3NldHRpbmdd
KTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCWlmICh2YWx1ZSA+IG9kX3RhYmxlLT5tYXhbc2V0
dGluZ10pIHsKKwkJcHJfd2FybigiT0Qgc2V0dGluZyAoJWQsICVkKSBpcyBncmVhdGVyIHRoYW4g
dGhlIG1heGltdW0gYWxsb3dlZCAoJWQpXG4iLCBzZXR0aW5nLCB2YWx1ZSwgb2RfdGFibGUtPm1h
eFtzZXR0aW5nXSk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKwlyZXR1cm4gMDsKK30KKworc3Rh
dGljIGludCBuYXZpMTBfc2V0dXBfb2RfbGltaXRzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KSB7
CisJc3RydWN0IHNtdV8xMV8wX292ZXJkcml2ZV90YWJsZSAqb3ZlcmRyaXZlX3RhYmxlID0gTlVM
TDsKKwlzdHJ1Y3Qgc211XzExXzBfcG93ZXJwbGF5X3RhYmxlICpwb3dlcnBsYXlfdGFibGUgPSBO
VUxMOworCisJaWYgKCFzbXUtPnNtdV90YWJsZS5wb3dlcl9wbGF5X3RhYmxlKSB7CisJCXByX2Vy
cigicG93ZXJwbGF5IHRhYmxlIHVuaW5pdGlhbGl6ZWQhXG4iKTsKKwkJcmV0dXJuIC1FTk9FTlQ7
CisJfQorCXBvd2VycGxheV90YWJsZSA9IChzdHJ1Y3Qgc211XzExXzBfcG93ZXJwbGF5X3RhYmxl
ICopc211LT5zbXVfdGFibGUucG93ZXJfcGxheV90YWJsZTsKKwlvdmVyZHJpdmVfdGFibGUgPSAm
cG93ZXJwbGF5X3RhYmxlLT5vdmVyZHJpdmVfdGFibGU7CisJaWYgKCFzbXUtPm9kX3NldHRpbmdz
KSB7CisJCXNtdS0+b2Rfc2V0dGluZ3MgPSBrbWVtZHVwKG92ZXJkcml2ZV90YWJsZSwgc2l6ZW9m
KHN0cnVjdCBzbXVfMTFfMF9vdmVyZHJpdmVfdGFibGUpLCBHRlBfS0VSTkVMKTsKKwl9IGVsc2Ug
eworCQltZW1jcHkoc211LT5vZF9zZXR0aW5ncywgb3ZlcmRyaXZlX3RhYmxlLCBzaXplb2Yoc3Ry
dWN0IHNtdV8xMV8wX292ZXJkcml2ZV90YWJsZSkpOworCX0KKwlyZXR1cm4gMDsKK30KKworc3Rh
dGljIGludCBuYXZpMTBfc2V0X2RlZmF1bHRfb2Rfc2V0dGluZ3Moc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUsIGJvb2wgaW5pdGlhbGl6ZSkgeworCU92ZXJEcml2ZVRhYmxlX3QgKm9kX3RhYmxlOwor
CWludCByZXQgPSAwOworCisJcmV0ID0gc211X3YxMV8wX3NldF9kZWZhdWx0X29kX3NldHRpbmdz
KHNtdSwgaW5pdGlhbGl6ZSwgc2l6ZW9mKE92ZXJEcml2ZVRhYmxlX3QpKTsKKwlpZiAocmV0KQor
CQlyZXR1cm4gcmV0OworCisJaWYgKGluaXRpYWxpemUpIHsKKwkJcmV0ID0gbmF2aTEwX3NldHVw
X29kX2xpbWl0cyhzbXUpOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIkZhaWxlZCB0byByZXRy
aWV2ZSBib2FyZCBPRCBsaW1pdHNcbiIpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCisJfQorCisJ
b2RfdGFibGUgPSAoT3ZlckRyaXZlVGFibGVfdCAqKXNtdS0+c211X3RhYmxlLm92ZXJkcml2ZV90
YWJsZTsKKwlpZiAob2RfdGFibGUpIHsKKwkJbmF2aTEwX2R1bXBfb2RfdGFibGUob2RfdGFibGUp
OworCX0KIAogCXJldHVybiByZXQ7CiB9CiAKK3N0YXRpYyBpbnQgbmF2aTEwX29kX2VkaXRfZHBt
X3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIFBQX09EX0RQTV9UQUJMRV9DT01N
QU5EIHR5cGUsIGxvbmcgaW5wdXRbXSwgdWludDMyX3Qgc2l6ZSkgeworCWludCBpOworCWludCBy
ZXQgPSAwOworCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFibGVfY29udGV4dCA9ICZzbXUt
PnNtdV90YWJsZTsKKwlPdmVyRHJpdmVUYWJsZV90ICpvZF90YWJsZTsKKwlzdHJ1Y3Qgc211XzEx
XzBfb3ZlcmRyaXZlX3RhYmxlICpvZF9zZXR0aW5nczsKKwlvZF90YWJsZSA9IChPdmVyRHJpdmVU
YWJsZV90ICopdGFibGVfY29udGV4dC0+b3ZlcmRyaXZlX3RhYmxlOworCisJaWYgKCFzbXUtPm9k
X2VuYWJsZWQpIHsKKwkJcHJfd2FybigiT3ZlckRyaXZlIGlzIG5vdCBlbmFibGVkIVxuIik7CisJ
CXJldHVybiAtRUlOVkFMOworCX0KKworCWlmICghc211LT5vZF9zZXR0aW5ncykgeworCQlwcl9l
cnIoIk9EIGJvYXJkIGxpbWl0cyBhcmUgbm90IHNldCFcbiIpOworCQlyZXR1cm4gLUVOT0VOVDsK
Kwl9CisKKwlvZF9zZXR0aW5ncyA9IHNtdS0+b2Rfc2V0dGluZ3M7CisKKwlzd2l0Y2ggKHR5cGUp
IHsKKwljYXNlIFBQX09EX0VESVRfU0NMS19WRERDX1RBQkxFOgorCQlpZiAoIW5hdmkxMF9vZF9m
ZWF0dXJlX2lzX3N1cHBvcnRlZChvZF9zZXR0aW5ncywgU01VXzExXzBfT0RGRUFUVVJFX0dGWENM
S19MSU1JVFMpKSB7CisJCQlwcl93YXJuKCJHRlhDTEtfTElNSVRTIG5vdCBzdXBwb3J0ZWQhXG4i
KTsKKwkJCXJldHVybiAtRU5PVFNVUFA7CisJCX0KKwkJaWYgKCF0YWJsZV9jb250ZXh0LT5vdmVy
ZHJpdmVfdGFibGUpIHsKKwkJCXByX2VycigiT3ZlcmRyaXZlIGlzIG5vdCBpbml0aWFsaXplZFxu
Iik7CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfQorCQlmb3IgKGkgPSAwOyBpIDwgc2l6ZTsgaSAr
PSAyKSB7CisJCQlpZiAoaSArIDIgPiBzaXplKSB7CisJCQkJcHJfaW5mbygiaW52YWxpZCBudW1i
ZXIgb2YgaW5wdXQgcGFyYW1ldGVycyAlZFxuIiwgc2l6ZSk7CisJCQkJcmV0dXJuIC1FSU5WQUw7
CisJCQl9CisJCQlzd2l0Y2ggKGlucHV0W2ldKSB7CisJCQljYXNlIDA6CisJCQkJZnJlcV9zZXR0
aW5nID0gU01VXzExXzBfT0RTRVRUSU5HX0dGWENMS0ZNSU47CisJCQkJZnJlcV9wdHIgPSAmb2Rf
dGFibGUtPkdmeGNsa0ZtaW47CisJCQkJaWYgKGlucHV0W2kgKyAxXSA+IG9kX3RhYmxlLT5HZnhj
bGtGbWF4KSB7CisJCQkJCXByX2luZm8oIkdmeGNsa0ZtaW4gKCVsZCkgbXVzdCBiZSA8PSBHZnhj
bGtGbWF4ICgldSkhXG4iLAorCQkJCQkJaW5wdXRbaSArIDFdLAorCQkJCQkJb2RfdGFibGUtPkdm
eGNsa0ZtaW4pOworCQkJCQlyZXR1cm4gLUVJTlZBTDsKKwkJCQl9CisJCQkJYnJlYWs7CisJCQlj
YXNlIDE6CisJCQkJZnJlcV9zZXR0aW5nID0gU01VXzExXzBfT0RTRVRUSU5HX0dGWENMS0ZNQVg7
CisJCQkJZnJlcV9wdHIgPSAmb2RfdGFibGUtPkdmeGNsa0ZtYXg7CisJCQkJaWYgKGlucHV0W2kg
KyAxXSA8IG9kX3RhYmxlLT5HZnhjbGtGbWluKSB7CisJCQkJCXByX2luZm8oIkdmeGNsa0ZtYXgg
KCVsZCkgbXVzdCBiZSA+PSBHZnhjbGtGbWluICgldSkhXG4iLAorCQkJCQkJaW5wdXRbaSArIDFd
LAorCQkJCQkJb2RfdGFibGUtPkdmeGNsa0ZtYXgpOworCQkJCQlyZXR1cm4gLUVJTlZBTDsKKwkJ
CQl9CisJCQkJYnJlYWs7CisJCQlkZWZhdWx0OgorCQkJCXByX2luZm8oIkludmFsaWQgU0NMS19W
RERDX1RBQkxFIGluZGV4OiAlbGRcbiIsIGlucHV0W2ldKTsKKwkJCQlwcl9pbmZvKCJTdXBwb3J0
ZWQgaW5kaWNlczogWzA6bWluLDE6bWF4XVxuIik7CisJCQkJcmV0dXJuIC1FSU5WQUw7CisJCQl9
CisJCQlyZXQgPSBuYXZpMTBfb2Rfc2V0dGluZ19jaGVja19yYW5nZShvZF9zZXR0aW5ncywgZnJl
cV9zZXR0aW5nLCBpbnB1dFtpICsgMV0pOworCQkJaWYgKHJldCkKKwkJCQlyZXR1cm4gcmV0Owor
CQkJKmZyZXFfcHRyID0gaW5wdXRbaSArIDFdOworCQl9CisJCWJyZWFrOworCWNhc2UgUFBfT0Rf
RURJVF9NQ0xLX1ZERENfVEFCTEU6CisJCWlmICghbmF2aTEwX29kX2ZlYXR1cmVfaXNfc3VwcG9y
dGVkKG9kX3NldHRpbmdzLCBTTVVfMTFfMF9PREZFQVRVUkVfVUNMS19NQVgpKSB7CisJCQlwcl93
YXJuKCJVQ0xLX01BWCBub3Qgc3VwcG9ydGVkIVxuIik7CisJCQlyZXR1cm4gLUVOT1RTVVBQOwor
CQl9CisJCWlmIChzaXplIDwgMikgeworCQkJcHJfaW5mbygiaW52YWxpZCBudW1iZXIgb2YgcGFy
YW1ldGVyczogJWRcbiIsIHNpemUpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKwkJaWYgKGlu
cHV0WzBdICE9IDEpIHsKKwkJCXByX2luZm8oIkludmFsaWQgTUNMS19WRERDX1RBQkxFIGluZGV4
OiAlbGRcbiIsIGlucHV0WzBdKTsKKwkJCXByX2luZm8oIlN1cHBvcnRlZCBpbmRpY2VzOiBbMTpt
YXhdXG4iKTsKKwkJCXJldHVybiAtRUlOVkFMOworCQl9CisJCXJldCA9IG5hdmkxMF9vZF9zZXR0
aW5nX2NoZWNrX3JhbmdlKG9kX3NldHRpbmdzLCBTTVVfMTFfMF9PRFNFVFRJTkdfVUNMS0ZNQVgs
IGlucHV0WzFdKTsKKwkJaWYgKHJldCkKKwkJCXJldHVybiByZXQ7CisJCW9kX3RhYmxlLT5VY2xr
Rm1heCA9IGlucHV0WzFdOworCQlicmVhazsKKwljYXNlIFBQX09EX0NPTU1JVF9EUE1fVEFCTEU6
CisJCW5hdmkxMF9kdW1wX29kX3RhYmxlKG9kX3RhYmxlKTsKKwkJcmV0ID0gc211X3VwZGF0ZV90
YWJsZShzbXUsIFNNVV9UQUJMRV9PVkVSRFJJVkUsIDAsICh2b2lkICopb2RfdGFibGUsIHRydWUp
OworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIkZhaWxlZCB0byBpbXBvcnQgb3ZlcmRyaXZlIHRh
YmxlIVxuIik7CisJCQlyZXR1cm4gcmV0OworCQl9CisJCS8vIG5vIGxvY2sgbmVlZGVkIGJlY2F1
c2Ugc211X29kX2VkaXRfZHBtX3RhYmxlIGhhcyBpdAorCQlyZXQgPSBzbXVfaGFuZGxlX3Rhc2so
c211LCBzbXUtPnNtdV9kcG0uZHBtX2xldmVsLAorCQkJQU1EX1BQX1RBU0tfUkVBREpVU1RfUE9X
RVJfU1RBVEUsCisJCQlmYWxzZSk7CisJCWlmIChyZXQpIHsKKwkJCXJldHVybiByZXQ7CisJCX0K
KwkJYnJlYWs7CisJY2FzZSBQUF9PRF9FRElUX1ZERENfQ1VSVkU6CisJCS8vIFRPRE86IGltcGxl
bWVudAorCQlyZXR1cm4gLUVOT1NZUzsKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVOT1NZUzsKKwl9
CisJcmV0dXJuIHJldDsKK30KIAogc3RhdGljIGNvbnN0IHN0cnVjdCBwcHRhYmxlX2Z1bmNzIG5h
dmkxMF9wcHRfZnVuY3MgPSB7CiAJLnRhYmxlc19pbml0ID0gbmF2aTEwX3RhYmxlc19pbml0LApA
QCAtMTc0Miw2ICsxOTIwLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBwcHRhYmxlX2Z1bmNzIG5h
dmkxMF9wcHRfZnVuY3MgPSB7CiAJLmdldF9kcG1fdWx0aW1hdGVfZnJlcSA9IHNtdV92MTFfMF9n
ZXRfZHBtX3VsdGltYXRlX2ZyZXEsCiAJLnNldF9zb2Z0X2ZyZXFfbGltaXRlZF9yYW5nZSA9IHNt
dV92MTFfMF9zZXRfc29mdF9mcmVxX2xpbWl0ZWRfcmFuZ2UsCiAJLm92ZXJyaWRlX3BjaWVfcGFy
YW1ldGVycyA9IHNtdV92MTFfMF9vdmVycmlkZV9wY2llX3BhcmFtZXRlcnMsCisJLnNldF9kZWZh
dWx0X29kX3NldHRpbmdzID0gbmF2aTEwX3NldF9kZWZhdWx0X29kX3NldHRpbmdzLAorCS5vZF9l
ZGl0X2RwbV90YWJsZSA9IG5hdmkxMF9vZF9lZGl0X2RwbV90YWJsZSwKIH07CiAKIHZvaWQgbmF2
aTEwX3NldF9wcHRfZnVuY3Moc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9zbXVfdjExXzAuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvcG93ZXJwbGF5L3NtdV92MTFfMC5jCmluZGV4IGU4NTliYjExMzJhYy4uYzRmNjdlZTg4
NDBlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9zbXVfdjExXzAu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9zbXVfdjExXzAuYwpAQCAtMTc3
OSwzICsxNzc5LDMwIEBAIGludCBzbXVfdjExXzBfb3ZlcnJpZGVfcGNpZV9wYXJhbWV0ZXJzKHN0
cnVjdCBzbXVfY29udGV4dCAqc211KQogCXJldHVybiByZXQ7CiAKIH0KKworaW50IHNtdV92MTFf
MF9zZXRfZGVmYXVsdF9vZF9zZXR0aW5ncyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgYm9vbCBp
bml0aWFsaXplLCBzaXplX3Qgb3ZlcmRyaXZlX3RhYmxlX3NpemUpCit7CisJc3RydWN0IHNtdV90
YWJsZV9jb250ZXh0ICp0YWJsZV9jb250ZXh0ID0gJnNtdS0+c211X3RhYmxlOworCWludCByZXQg
PSAwOworCisJaWYgKGluaXRpYWxpemUpIHsKKwkJaWYgKHRhYmxlX2NvbnRleHQtPm92ZXJkcml2
ZV90YWJsZSkgeworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKwkJdGFibGVfY29udGV4dC0+b3Zl
cmRyaXZlX3RhYmxlID0ga3phbGxvYyhvdmVyZHJpdmVfdGFibGVfc2l6ZSwgR0ZQX0tFUk5FTCk7
CisJCWlmICghdGFibGVfY29udGV4dC0+b3ZlcmRyaXZlX3RhYmxlKSB7CisJCQlyZXR1cm4gLUVO
T01FTTsKKwkJfQorCQlyZXQgPSBzbXVfdXBkYXRlX3RhYmxlKHNtdSwgU01VX1RBQkxFX09WRVJE
UklWRSwgMCwgdGFibGVfY29udGV4dC0+b3ZlcmRyaXZlX3RhYmxlLCBmYWxzZSk7CisJCWlmIChy
ZXQpIHsKKwkJCXByX2VycigiRmFpbGVkIHRvIGV4cG9ydCBvdmVyZHJpdmUgdGFibGUhXG4iKTsK
KwkJCXJldHVybiByZXQ7CisJCX0KKwl9CisJcmV0ID0gc211X3VwZGF0ZV90YWJsZShzbXUsIFNN
VV9UQUJMRV9PVkVSRFJJVkUsIDAsIHRhYmxlX2NvbnRleHQtPm92ZXJkcml2ZV90YWJsZSwgdHJ1
ZSk7CisJaWYgKHJldCkgeworCQlwcl9lcnIoIkZhaWxlZCB0byBpbXBvcnQgb3ZlcmRyaXZlIHRh
YmxlIVxuIik7CisJCXJldHVybiByZXQ7CisJfQorCXJldHVybiByZXQ7Cit9Ci0tIAoyLjIzLjAK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZngg
bWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
