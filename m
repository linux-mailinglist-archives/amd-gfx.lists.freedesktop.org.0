Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E78591B5B46
	for <lists+amd-gfx@lfdr.de>; Thu, 23 Apr 2020 14:21:46 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5A21489306;
	Thu, 23 Apr 2020 12:21:45 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wm1-x341.google.com (mail-wm1-x341.google.com
 [IPv6:2a00:1450:4864:20::341])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B4DCB89306
 for <amd-gfx@lists.freedesktop.org>; Thu, 23 Apr 2020 12:21:44 +0000 (UTC)
Received: by mail-wm1-x341.google.com with SMTP id z6so6330058wml.2
 for <amd-gfx@lists.freedesktop.org>; Thu, 23 Apr 2020 05:21:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=reply-to:subject:to:cc:references:from:message-id:date:user-agent
 :mime-version:in-reply-to:content-transfer-encoding:content-language;
 bh=94Ijupa/ARuwg2LrPI/nG2dx4zxmfMjGO0BYQWRs4Mw=;
 b=lUdhSWS18R8MYOS+0EyB+6sYZd1L+Y6ke9VJHK+6g24W7VVnp1xUz64eytBo6QfTJb
 8Am8rDlPl20gQQ14khtpC50eH57f595nD0nvh6vMsyCt3Yo7kbgDosKAmqbqGZlmDAVI
 yY0fne7kueo5w4ZVCDLzuGamzLcBZLZjzjCVPHGq4lxkhQr+SlXcRJcvt4jfxarMeFB2
 qLRn+8wDRPPs9JyFZzJy25kPkzQI/ZyRXRf906qSWTReXp6gdK5icIXs3Fbi46ZttuQK
 /2K6TqYoHD3rQtP+ECtt5IuppDVQVNUwtPdBdjNQvXiZsDQFTKaQTLXHt2RfKo1UJaiW
 69Ig==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:reply-to:subject:to:cc:references:from
 :message-id:date:user-agent:mime-version:in-reply-to
 :content-transfer-encoding:content-language;
 bh=94Ijupa/ARuwg2LrPI/nG2dx4zxmfMjGO0BYQWRs4Mw=;
 b=h0D8JWIx1Rm2vzncgkHNJGRD6nMxZkGciFHl8yq3tdizoQnWFi2d/3vTFkMA4EEPpP
 G5MPzJG7sZ/rbwDklfOAa5FsxKoJoyuHhOXk7bczwxr5IyPvY0vYoA7ML6r+w/nwM9Kx
 orJQZnO4+CirNs41PQ/btCwqz04N/I86d5Cwe28viN8iiu1byOPbbv8Vh45th9VnaLM4
 cAqdEw+SzE5VonnU4eeocWY/4MbBrTvcF2C2Ff3cPq9SlAmIWKpLuqe44F2efmk6wOhy
 rahidG7JcffyAXA3R0fwuX3rz7z+QPW9NM87NsG1p2BUZsZmo4+ZW2k+fXY/IdW8e1un
 co3A==
X-Gm-Message-State: AGi0Pua7QJam3qSTwcxQU0mdKfslwpoqNyEgJZqgXuJ+9H2/CWe5LWbJ
 2te1VTFixPO8o6yn2spZ9w4NoPlP
X-Google-Smtp-Source: APiQypLTEvi8n8591uT0/CZZ9VjNyHayAykjnFlIuXbEVw6vGJ7CksTdnLEKf+rUHC0NnVK8E1zFIw==
X-Received: by 2002:a1c:3c54:: with SMTP id j81mr3805000wma.140.1587644503014; 
 Thu, 23 Apr 2020 05:21:43 -0700 (PDT)
Received: from ?IPv6:2a02:908:1252:fb60:be8a:bd56:1f94:86e7?
 ([2a02:908:1252:fb60:be8a:bd56:1f94:86e7])
 by smtp.gmail.com with ESMTPSA id p16sm3529116wro.21.2020.04.23.05.21.42
 (version=TLS1_2 cipher=ECDHE-ECDSA-AES128-GCM-SHA256 bits=128/128);
 Thu, 23 Apr 2020 05:21:42 -0700 (PDT)
Subject: Re: [PATCH] drm/amdgpu: protect ring overrun
To: Yintian Tao <yttao@amd.com>, christian.koenig@amd.com, monk.liu@amd.com,
 shaoyun.liu@amd.com
References: <20200423090628.21199-1-yttao@amd.com>
From: =?UTF-8?Q?Christian_K=c3=b6nig?= <ckoenig.leichtzumerken@gmail.com>
Message-ID: <7d5fd258-8471-7d47-a226-ff667623dda4@gmail.com>
Date: Thu, 23 Apr 2020 14:21:41 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <20200423090628.21199-1-yttao@amd.com>
Content-Language: en-US
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Reply-To: christian.koenig@amd.com
Cc: amd-gfx@lists.freedesktop.org
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QW0gMjMuMDQuMjAgdW0gMTE6MDYgc2NocmllYiBZaW50aWFuIFRhbzoKPiBXYWl0IGZvciB0aGUg
b2xkZXN0IHNlcXVlbmNlIG9uIHRoZSByaW5nCj4gdG8gYmUgc2lnbmFsZWQgaW4gb3JkZXIgdG8g
bWFrZSBzdXJlIHRoZXJlCj4gd2lsbCBiZSBubyBjb21tYW5kIG92ZXJydW4uCj4KPiB2MjogZml4
IGNvZGluZyBzdHlwZSBhbmQgcmVtb3ZlIGFicyBvcGVyYXRpb24KCk9uZSBuaXQgcGljayBiZWxv
dywgd2l0aCB0aGF0IGZpeGVkIHRoZSBwYXRjaCBpcyBSZXZpZXdlZC1ieTogQ2hyaXN0aWFuIApL
w7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KCj4KPiBTaWduZWQtb2ZmLWJ5OiBZaW50
aWFuIFRhbyA8eXR0YW9AYW1kLmNvbT4KPiAtLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9mZW5jZS5jIHwgMTAgKysrKysrKysrLQo+ICAgZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X2dmeC5jICAgfCAyMiArKysrKysrKysrKysrKysrKystLS0tCj4gICBk
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmluZy5oICB8ICAzICsrLQo+ICAgZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZpcnQuYyAgfCAgOCArKysrKysrLQo+ICAg
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3YxMF8wLmMgICAgfCAgMSAtCj4gICBkcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjhfMC5jICAgICB8ICAxIC0KPiAgIGRyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OV8wLmMgICAgIHwgMTQgKysrKysrKysrKystLS0KPiAg
IGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBfMC5jICAgIHwgIDggKysrKysrKy0K
PiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMgICAgIHwgIDggKysrKysr
Ky0KPiAgIDkgZmlsZXMgY2hhbmdlZCwgNjEgaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25zKC0p
Cj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ZlbmNl
LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZmVuY2UuYwo+IGluZGV4IDc1
MzE1MjcwNjdkZi4uMzk3YmQ1ZmE3N2NiIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9mZW5jZS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2ZlbmNlLmMKPiBAQCAtMTkyLDE0ICsxOTIsMjIgQEAgaW50IGFtZGdwdV9mZW5j
ZV9lbWl0KHN0cnVjdCBhbWRncHVfcmluZyAqcmluZywgc3RydWN0IGRtYV9mZW5jZSAqKmYsCj4g
ICAgKiBVc2VkIEZvciBwb2xsaW5nIGZlbmNlLgo+ICAgICogUmV0dXJucyAwIG9uIHN1Y2Nlc3Ms
IC1FTk9NRU0gb24gZmFpbHVyZS4KPiAgICAqLwo+IC1pbnQgYW1kZ3B1X2ZlbmNlX2VtaXRfcG9s
bGluZyhzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsIHVpbnQzMl90ICpzKQo+ICtpbnQgYW1kZ3B1
X2ZlbmNlX2VtaXRfcG9sbGluZyhzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsIHVpbnQzMl90ICpz
LAo+ICsJCQkgICAgICB1aW50MzJfdCB0aW1lb3V0KQo+ICAgewo+ICAgCXVpbnQzMl90IHNlcTsK
PiArCXNpZ25lZCBsb25nIHIgPSAwOwoKUGxlYXNlIGRyb3AgdGhlIGluaXRpYWxpemF0aW9uIG9m
IHIgaGVyZS4gVGhhdCBpcyB1c3VhbGx5IHNlZW4gYXMgcmF0aGVyIApiYWQgc3R5bGUgYmVjYXVz
ZSBpdCBwcmV2ZW50cyB0aGUgY29tcGlsZXIgZnJvbSByYWlzaW5nIGFuIHdhcm5pbmcgd2hlbiAK
dGhpcyByZWFsbHkgaXNuJ3QgaW5pdGlhbGl6ZWQuCgpSZWdhcmRzLApDaHJpc3RpYW4uCgo+ICAg
Cj4gICAJaWYgKCFzKQo+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgIAo+ICAgCXNlcSA9ICsrcmlu
Zy0+ZmVuY2VfZHJ2LnN5bmNfc2VxOwo+ICsJciA9IGFtZGdwdV9mZW5jZV93YWl0X3BvbGxpbmco
cmluZywKPiArCQkJCSAgICAgIHNlcSAtIHJpbmctPmZlbmNlX2Rydi5udW1fZmVuY2VzX21hc2ss
Cj4gKwkJCQkgICAgICB0aW1lb3V0KTsKPiArCWlmIChyIDwgMSkKPiArCQlyZXR1cm4gLUVUSU1F
RE9VVDsKPiArCj4gICAJYW1kZ3B1X3JpbmdfZW1pdF9mZW5jZShyaW5nLCByaW5nLT5mZW5jZV9k
cnYuZ3B1X2FkZHIsCj4gICAJCQkgICAgICAgc2VxLCAwKTsKPiAgIAo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ2Z4LmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfZ2Z4LmMKPiBpbmRleCBhNzIxYjBlMGZmNjkuLjAxMDNhY2M1NzQ3
NCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ2Z4LmMK
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ2Z4LmMKPiBAQCAtNjc1
LDEzICs2NzUsMTUgQEAgdWludDMyX3QgYW1kZ3B1X2tpcV9ycmVnKHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LCB1aW50MzJfdCByZWcpCj4gICAKPiAgIAlzcGluX2xvY2tfaXJxc2F2ZSgma2lx
LT5yaW5nX2xvY2ssIGZsYWdzKTsKPiAgIAlpZiAoYW1kZ3B1X2RldmljZV93Yl9nZXQoYWRldiwg
JnJlZ192YWxfb2ZmcykpIHsKPiAtCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZraXEtPnJpbmdf
bG9jaywgZmxhZ3MpOwo+ICAgCQlwcl9lcnIoImNyaXRpY2FsIGJ1ZyEgdG9vIG1hbnkga2lxIHJl
YWRlcnNcbiIpOwo+IC0JCWdvdG8gZmFpbGVkX2tpcV9yZWFkOwo+ICsJCWdvdG8gZmFpbGVkX3Vu
bG9jazsKPiAgIAl9Cj4gICAJYW1kZ3B1X3JpbmdfYWxsb2MocmluZywgMzIpOwo+ICAgCWFtZGdw
dV9yaW5nX2VtaXRfcnJlZyhyaW5nLCByZWcsIHJlZ192YWxfb2Zmcyk7Cj4gLQlhbWRncHVfZmVu
Y2VfZW1pdF9wb2xsaW5nKHJpbmcsICZzZXEpOwo+ICsJciA9IGFtZGdwdV9mZW5jZV9lbWl0X3Bv
bGxpbmcocmluZywgJnNlcSwgTUFYX0tJUV9SRUdfV0FJVCk7Cj4gKwlpZiAocikKPiArCQlnb3Rv
IGZhaWxlZF91bmRvOwo+ICsKPiAgIAlhbWRncHVfcmluZ19jb21taXQocmluZyk7Cj4gICAJc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgma2lxLT5yaW5nX2xvY2ssIGZsYWdzKTsKPiAgIAo+IEBAIC03
MTIsNyArNzE0LDEzIEBAIHVpbnQzMl90IGFtZGdwdV9raXFfcnJlZyhzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldiwgdWludDMyX3QgcmVnKQo+ICAgCWFtZGdwdV9kZXZpY2Vfd2JfZnJlZShhZGV2
LCByZWdfdmFsX29mZnMpOwo+ICAgCXJldHVybiB2YWx1ZTsKPiAgIAo+ICtmYWlsZWRfdW5kbzoK
PiArCWFtZGdwdV9yaW5nX3VuZG8ocmluZyk7Cj4gK2ZhaWxlZF91bmxvY2s6Cj4gKwlzcGluX3Vu
bG9ja19pcnFyZXN0b3JlKCZraXEtPnJpbmdfbG9jaywgZmxhZ3MpOwo+ICAgZmFpbGVkX2tpcV9y
ZWFkOgo+ICsJaWYgKHJlZ192YWxfb2ZmcykKPiArCQlhbWRncHVfZGV2aWNlX3diX2ZyZWUoYWRl
diwgcmVnX3ZhbF9vZmZzKTsKPiAgIAlwcl9lcnIoImZhaWxlZCB0byByZWFkIHJlZzoleFxuIiwg
cmVnKTsKPiAgIAlyZXR1cm4gfjA7Cj4gICB9Cj4gQEAgLTczMCw3ICs3MzgsMTAgQEAgdm9pZCBh
bWRncHVfa2lxX3dyZWcoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHVpbnQzMl90IHJlZywg
dWludDMyX3QgdikKPiAgIAlzcGluX2xvY2tfaXJxc2F2ZSgma2lxLT5yaW5nX2xvY2ssIGZsYWdz
KTsKPiAgIAlhbWRncHVfcmluZ19hbGxvYyhyaW5nLCAzMik7Cj4gICAJYW1kZ3B1X3JpbmdfZW1p
dF93cmVnKHJpbmcsIHJlZywgdik7Cj4gLQlhbWRncHVfZmVuY2VfZW1pdF9wb2xsaW5nKHJpbmcs
ICZzZXEpOwo+ICsJciA9IGFtZGdwdV9mZW5jZV9lbWl0X3BvbGxpbmcocmluZywgJnNlcSwgTUFY
X0tJUV9SRUdfV0FJVCk7Cj4gKwlpZiAocikKPiArCQlnb3RvIGZhaWxlZF91bmRvOwo+ICsKPiAg
IAlhbWRncHVfcmluZ19jb21taXQocmluZyk7Cj4gICAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgm
a2lxLT5yaW5nX2xvY2ssIGZsYWdzKTsKPiAgIAo+IEBAIC03NTksNiArNzcwLDkgQEAgdm9pZCBh
bWRncHVfa2lxX3dyZWcoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHVpbnQzMl90IHJlZywg
dWludDMyX3QgdikKPiAgIAo+ICAgCXJldHVybjsKPiAgIAo+ICtmYWlsZWRfdW5kbzoKPiArCWFt
ZGdwdV9yaW5nX3VuZG8ocmluZyk7Cj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZraXEtPnJp
bmdfbG9jaywgZmxhZ3MpOwo+ICAgZmFpbGVkX2tpcV93cml0ZToKPiAgIAlwcl9lcnIoImZhaWxl
ZCB0byB3cml0ZSByZWc6JXhcbiIsIHJlZyk7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yaW5nLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfcmluZy5oCj4gaW5kZXggMTM3ZDNkMmI0NmU4Li5iZTIxODc1NDYyOWEgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3JpbmcuaAo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yaW5nLmgKPiBAQCAtMTE4LDcg
KzExOCw4IEBAIHZvaWQgYW1kZ3B1X2ZlbmNlX2RyaXZlcl9zdXNwZW5kKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2KTsKPiAgIHZvaWQgYW1kZ3B1X2ZlbmNlX2RyaXZlcl9yZXN1bWUoc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYpOwo+ICAgaW50IGFtZGdwdV9mZW5jZV9lbWl0KHN0cnVjdCBh
bWRncHVfcmluZyAqcmluZywgc3RydWN0IGRtYV9mZW5jZSAqKmZlbmNlLAo+ICAgCQkgICAgICB1
bnNpZ25lZCBmbGFncyk7Cj4gLWludCBhbWRncHVfZmVuY2VfZW1pdF9wb2xsaW5nKHN0cnVjdCBh
bWRncHVfcmluZyAqcmluZywgdWludDMyX3QgKnMpOwo+ICtpbnQgYW1kZ3B1X2ZlbmNlX2VtaXRf
cG9sbGluZyhzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsIHVpbnQzMl90ICpzLAo+ICsJCQkgICAg
ICB1aW50MzJfdCB0aW1lb3V0KTsKPiAgIGJvb2wgYW1kZ3B1X2ZlbmNlX3Byb2Nlc3Moc3RydWN0
IGFtZGdwdV9yaW5nICpyaW5nKTsKPiAgIGludCBhbWRncHVfZmVuY2Vfd2FpdF9lbXB0eShzdHJ1
Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpOwo+ICAgc2lnbmVkIGxvbmcgYW1kZ3B1X2ZlbmNlX3dhaXRf
cG9sbGluZyhzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92aXJ0LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfdmlydC5jCj4gaW5kZXggOGMxMDA4NGY0NGVmLi5jYmJiOGQwMjUzNWEgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZpcnQuYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92aXJ0LmMKPiBAQCAtNjAsNyAr
NjAsMTAgQEAgdm9pZCBhbWRncHVfdmlydF9raXFfcmVnX3dyaXRlX3JlZ193YWl0KHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2LAo+ICAgCWFtZGdwdV9yaW5nX2FsbG9jKHJpbmcsIDMyKTsKPiAg
IAlhbWRncHVfcmluZ19lbWl0X3JlZ193cml0ZV9yZWdfd2FpdChyaW5nLCByZWcwLCByZWcxLAo+
ICAgCQkJCQkgICAgcmVmLCBtYXNrKTsKPiAtCWFtZGdwdV9mZW5jZV9lbWl0X3BvbGxpbmcocmlu
ZywgJnNlcSk7Cj4gKwlyID0gYW1kZ3B1X2ZlbmNlX2VtaXRfcG9sbGluZyhyaW5nLCAmc2VxLCBN
QVhfS0lRX1JFR19XQUlUKTsKPiArCWlmIChyKQo+ICsJCWdvdG8gZmFpbGVkX3VuZG87Cj4gKwo+
ICAgCWFtZGdwdV9yaW5nX2NvbW1pdChyaW5nKTsKPiAgIAlzcGluX3VubG9ja19pcnFyZXN0b3Jl
KCZraXEtPnJpbmdfbG9jaywgZmxhZ3MpOwo+ICAgCj4gQEAgLTgyLDYgKzg1LDkgQEAgdm9pZCBh
bWRncHVfdmlydF9raXFfcmVnX3dyaXRlX3JlZ193YWl0KHN0cnVjdCBhbWRncHVfZGV2aWNlICph
ZGV2LAo+ICAgCj4gICAJcmV0dXJuOwo+ICAgCj4gK2ZhaWxlZF91bmRvOgo+ICsJYW1kZ3B1X3Jp
bmdfdW5kbyhyaW5nKTsKPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmtpcS0+cmluZ19sb2Nr
LCBmbGFncyk7Cj4gICBmYWlsZWRfa2lxOgo+ICAgCXByX2VycigiZmFpbGVkIHRvIHdyaXRlIHJl
ZyAleCB3YWl0IHJlZyAleFxuIiwgcmVnMCwgcmVnMSk7Cj4gICB9Cj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92MTBfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvZ2Z4X3YxMF8wLmMKPiBpbmRleCA4YTU3OWNlODc1N2QuLjJiNmQ3Njg3ZjRjYiAx
MDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92MTBfMC5jCj4gQEAgLTc2MDUsNyAr
NzYwNSw2IEBAIHN0YXRpYyB2b2lkIGdmeF92MTBfMF9yaW5nX2VtaXRfcnJlZyhzdHJ1Y3QgYW1k
Z3B1X3JpbmcgKnJpbmcsIHVpbnQzMl90IHJlZywKPiAgIAkJCQkgICAgIHVpbnQzMl90IHJlZ192
YWxfb2ZmcykKPiAgIHsKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IHJpbmctPmFk
ZXY7Cj4gLQlzdHJ1Y3QgYW1kZ3B1X2tpcSAqa2lxID0gJmFkZXYtPmdmeC5raXE7Cj4gICAKPiAg
IAlhbWRncHVfcmluZ193cml0ZShyaW5nLCBQQUNLRVQzKFBBQ0tFVDNfQ09QWV9EQVRBLCA0KSk7
Cj4gICAJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgMCB8CS8qIHNyYzogcmVnaXN0ZXIqLwo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjhfMC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y4XzAuYwo+IGluZGV4IDZjNTZjZWRjZTRjMy4uNmFl
NzhiOWU5NTUxIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92
OF8wLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjhfMC5jCj4gQEAg
LTYzOTMsNyArNjM5Myw2IEBAIHN0YXRpYyB2b2lkIGdmeF92OF8wX3JpbmdfZW1pdF9ycmVnKHN0
cnVjdCBhbWRncHVfcmluZyAqcmluZywgdWludDMyX3QgcmVnLAo+ICAgCQkJCSAgICB1aW50MzJf
dCByZWdfdmFsX29mZnMpCj4gICB7Cj4gICAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBy
aW5nLT5hZGV2Owo+IC0Jc3RydWN0IGFtZGdwdV9raXEgKmtpcSA9ICZhZGV2LT5nZngua2lxOwo+
ICAgCj4gICAJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgUEFDS0VUMyhQQUNLRVQzX0NPUFlfREFU
QSwgNCkpOwo+ICAgCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIDAgfAkvKiBzcmM6IHJlZ2lzdGVy
Ki8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OV8wLmMKPiBpbmRleCAwOWFhNWY1MDli
ZDIuLmJlMDVhYjIyMWIxNiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9nZnhfdjlfMC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAu
Ywo+IEBAIC00MDU0LDkgKzQwNTQsOCBAQCBzdGF0aWMgdWludDY0X3QgZ2Z4X3Y5XzBfa2lxX3Jl
YWRfY2xvY2soc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4gICAKPiAgIAlzcGluX2xvY2tf
aXJxc2F2ZSgma2lxLT5yaW5nX2xvY2ssIGZsYWdzKTsKPiAgIAlpZiAoYW1kZ3B1X2RldmljZV93
Yl9nZXQoYWRldiwgJnJlZ192YWxfb2ZmcykpIHsKPiAtCQlzcGluX3VubG9ja19pcnFyZXN0b3Jl
KCZraXEtPnJpbmdfbG9jaywgZmxhZ3MpOwo+ICAgCQlwcl9lcnIoImNyaXRpY2FsIGJ1ZyEgdG9v
IG1hbnkga2lxIHJlYWRlcnNcbiIpOwo+IC0JCWdvdG8gZmFpbGVkX2tpcV9yZWFkOwo+ICsJCWdv
dG8gZmFpbGVkX3VubG9jazsKPiAgIAl9Cj4gICAJYW1kZ3B1X3JpbmdfYWxsb2MocmluZywgMzIp
Owo+ICAgCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIFBBQ0tFVDMoUEFDS0VUM19DT1BZX0RBVEEs
IDQpKTsKPiBAQCAtNDA3MCw3ICs0MDY5LDEwIEBAIHN0YXRpYyB1aW50NjRfdCBnZnhfdjlfMF9r
aXFfcmVhZF9jbG9jayhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiAgIAkJCQlyZWdfdmFs
X29mZnMgKiA0KSk7Cj4gICAJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgdXBwZXJfMzJfYml0cyhh
ZGV2LT53Yi5ncHVfYWRkciArCj4gICAJCQkJcmVnX3ZhbF9vZmZzICogNCkpOwo+IC0JYW1kZ3B1
X2ZlbmNlX2VtaXRfcG9sbGluZyhyaW5nLCAmc2VxKTsKPiArCXIgPSBhbWRncHVfZmVuY2VfZW1p
dF9wb2xsaW5nKHJpbmcsICZzZXEsIE1BWF9LSVFfUkVHX1dBSVQpOwo+ICsJaWYgKHIpCj4gKwkJ
Z290byBmYWlsZWRfdW5kbzsKPiArCj4gICAJYW1kZ3B1X3JpbmdfY29tbWl0KHJpbmcpOwo+ICAg
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmtpcS0+cmluZ19sb2NrLCBmbGFncyk7Cj4gICAKPiBA
QCAtNDEwMiw3ICs0MTA0LDEzIEBAIHN0YXRpYyB1aW50NjRfdCBnZnhfdjlfMF9raXFfcmVhZF9j
bG9jayhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiAgIAlhbWRncHVfZGV2aWNlX3diX2Zy
ZWUoYWRldiwgcmVnX3ZhbF9vZmZzKTsKPiAgIAlyZXR1cm4gdmFsdWU7Cj4gICAKPiArZmFpbGVk
X3VuZG86Cj4gKwlhbWRncHVfcmluZ191bmRvKHJpbmcpOwo+ICtmYWlsZWRfdW5sb2NrOgo+ICsJ
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgma2lxLT5yaW5nX2xvY2ssIGZsYWdzKTsKPiAgIGZhaWxl
ZF9raXFfcmVhZDoKPiArCWlmIChyZWdfdmFsX29mZnMpCj4gKwkJYW1kZ3B1X2RldmljZV93Yl9m
cmVlKGFkZXYsIHJlZ192YWxfb2Zmcyk7Cj4gICAJcHJfZXJyKCJmYWlsZWQgdG8gcmVhZCBncHUg
Y2xvY2tcbiIpOwo+ICAgCXJldHVybiB+MDsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvZ21jX3YxMF8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9nbWNfdjEwXzAuYwo+IGluZGV4IDMwYjc1ZDc5ZWZkYi4uYjEyMGY5MTYwZjEzIDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBfMC5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3YxMF8wLmMKPiBAQCAtNDI3LDcgKzQyNywxMyBA
QCBzdGF0aWMgaW50IGdtY192MTBfMF9mbHVzaF9ncHVfdGxiX3Bhc2lkKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2LAo+ICAgCQlhbWRncHVfcmluZ19hbGxvYyhyaW5nLCBraXEtPnBtZi0+aW52
YWxpZGF0ZV90bGJzX3NpemUgKyA4KTsKPiAgIAkJa2lxLT5wbWYtPmtpcV9pbnZhbGlkYXRlX3Rs
YnMocmluZywKPiAgIAkJCQkJcGFzaWQsIGZsdXNoX3R5cGUsIGFsbF9odWIpOwo+IC0JCWFtZGdw
dV9mZW5jZV9lbWl0X3BvbGxpbmcocmluZywgJnNlcSk7Cj4gKwkJciA9IGFtZGdwdV9mZW5jZV9l
bWl0X3BvbGxpbmcocmluZywgJnNlcSwgTUFYX0tJUV9SRUdfV0FJVCk7Cj4gKwkJaWYgKHIpIHsK
PiArCQkJYW1kZ3B1X3JpbmdfdW5kbyhyaW5nKTsKPiArCQkJc3Bpbl91bmxvY2soJmtpcS0+cmlu
Z19sb2NrKTsKPiArCQkJcmV0dXJuIC1FVElNRTsKPiArCQl9Cj4gKwo+ICAgCQlhbWRncHVfcmlu
Z19jb21taXQocmluZyk7Cj4gICAJCXNwaW5fdW5sb2NrKCZhZGV2LT5nZngua2lxLnJpbmdfbG9j
ayk7Cj4gICAJCXIgPSBhbWRncHVfZmVuY2Vfd2FpdF9wb2xsaW5nKHJpbmcsIHNlcSwgYWRldi0+
dXNlY190aW1lb3V0KTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
Z21jX3Y5XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMKPiBpbmRl
eCBmZWNkYmM0NzE5ODMuLjBhNjAyNjMwODM0MyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9nbWNfdjlfMC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvZ21jX3Y5XzAuYwo+IEBAIC02MjEsNyArNjIxLDEzIEBAIHN0YXRpYyBpbnQgZ21jX3Y5XzBf
Zmx1c2hfZ3B1X3RsYl9wYXNpZChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgIAkJCQkJ
CSAgICAgIHBhc2lkLCAyLCBhbGxfaHViKTsKPiAgIAkJa2lxLT5wbWYtPmtpcV9pbnZhbGlkYXRl
X3RsYnMocmluZywKPiAgIAkJCQkJcGFzaWQsIGZsdXNoX3R5cGUsIGFsbF9odWIpOwo+IC0JCWFt
ZGdwdV9mZW5jZV9lbWl0X3BvbGxpbmcocmluZywgJnNlcSk7Cj4gKwkJciA9IGFtZGdwdV9mZW5j
ZV9lbWl0X3BvbGxpbmcocmluZywgJnNlcSwgTUFYX0tJUV9SRUdfV0FJVCk7Cj4gKwkJaWYgKHIp
IHsKPiArCQkJYW1kZ3B1X3JpbmdfdW5kbyhyaW5nKTsKPiArCQkJc3Bpbl91bmxvY2soJmtpcS0+
cmluZ19sb2NrKTsKPiArCQkJcmV0dXJuIC1FVElNRTsKPiArCQl9Cj4gKwo+ICAgCQlhbWRncHVf
cmluZ19jb21taXQocmluZyk7Cj4gICAJCXNwaW5fdW5sb2NrKCZhZGV2LT5nZngua2lxLnJpbmdf
bG9jayk7Cj4gICAJCXIgPSBhbWRncHVfZmVuY2Vfd2FpdF9wb2xsaW5nKHJpbmcsIHNlcSwgYWRl
di0+dXNlY190aW1lb3V0KTsKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdm
eAo=
