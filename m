Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id EE6E136B686
	for <lists+amd-gfx@lfdr.de>; Mon, 26 Apr 2021 18:12:30 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 645F989F41;
	Mon, 26 Apr 2021 16:12:29 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-ed1-x531.google.com (mail-ed1-x531.google.com
 [IPv6:2a00:1450:4864:20::531])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3389289F41
 for <amd-gfx@lists.freedesktop.org>; Mon, 26 Apr 2021 16:12:28 +0000 (UTC)
Received: by mail-ed1-x531.google.com with SMTP id c22so2744578edn.7
 for <amd-gfx@lists.freedesktop.org>; Mon, 26 Apr 2021 09:12:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=subject:to:references:from:message-id:date:user-agent:mime-version
 :in-reply-to:content-transfer-encoding:content-language;
 bh=Febqw2+ekF2xYCMFlBCj6PaS4p9Jg4IV51WylUBtPDs=;
 b=lciAX8/jBUpfTTEDPSICz9+a0jFf5qpi2zENBZfWjOLG1Izaj7kQDR9ShQ6frYyFni
 lfkHz0kk0smv/4W+JanJvnzmrCmOplA3db0aJUvtMZnQNTO0Fu196/BTTFxJrpwro/c/
 w3nTqSIr54LVvyqz24Y6X29QgFQx0CDDA3b00kFWt6pFPnleBaY5ujtAffCurt13rK4j
 gQWVl3k1pIX4gg0Op538mIzkawmRu4zgPqKUDrc1qceYcrATCUvdBFhtpZyZ8njac8W7
 7GoFbw+vyHcQOk1nXcheElCogFPeOvs9WseHUfJb2hgKuq50Dtvnb12hNQnWBzujBk9O
 47dw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:subject:to:references:from:message-id:date
 :user-agent:mime-version:in-reply-to:content-transfer-encoding
 :content-language;
 bh=Febqw2+ekF2xYCMFlBCj6PaS4p9Jg4IV51WylUBtPDs=;
 b=uVm5p4OdM96bR5UWCT4f0wf3pUgiCnksQwbJln7zEqb2SqV8nDIwcWtE/Bi1i0yq0r
 Rr8RHDO8RNAj7ZyoQ0GZwupvAiCAEYdAhwGuTacnzdXO0LDlZMtVNHuHmjt/3KQ9DjhQ
 0n7IML3/+Sf5lfaAr6dcTo3X8eG/eXrJDZ8qkB7l9RJ6chNi6f6x3CBnxiIvO0aNGhld
 Z2ctGEG5VmKlJJZoA4wO+5c4U7UvUOIkCZ7z5Y+unyzRkXjt/46ytmb0Pmu08EH7KfvM
 cRE8m7RzT46paDry0dWi5Vd6o70hWzspE7f2kEaGAwfKYcil16Q7Ihcph9SiK3qORE0S
 zrGg==
X-Gm-Message-State: AOAM531wI7zCjvCWW8ki5wwOTWjpDHW+eNLX4xbSV8q954F6hR8XTMf3
 yRwcUI9mSGBwWFRPbLJzYAa3sVC+VUs=
X-Google-Smtp-Source: ABdhPJzkMQFYSUHf433yOJCuMtzZEYOZepytspSLcu31uA30NVmwEW18sBPTRU9I1PuHj1lrckweDA==
X-Received: by 2002:a05:6402:309c:: with SMTP id
 de28mr11861335edb.191.1619453546927; 
 Mon, 26 Apr 2021 09:12:26 -0700 (PDT)
Received: from ?IPv6:2a02:908:1252:fb60:5ea3:9669:f6c0:78b?
 ([2a02:908:1252:fb60:5ea3:9669:f6c0:78b])
 by smtp.gmail.com with ESMTPSA id e11sm11690848ejl.115.2021.04.26.09.12.26
 (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
 Mon, 26 Apr 2021 09:12:26 -0700 (PDT)
Subject: Re: [PATCH] drm/amdgpu: restructure amdgpu_vram_mgr_new
To: Felix Kuehling <felix.kuehling@amd.com>, amd-gfx@lists.freedesktop.org
References: <20210426085434.2974-1-christian.koenig@amd.com>
 <3bcff580-1c9c-c9ab-b5f1-263ea2388cb1@amd.com>
From: =?UTF-8?Q?Christian_K=c3=b6nig?= <ckoenig.leichtzumerken@gmail.com>
Message-ID: <888ba759-d316-5aaf-f3c4-d5380d63b795@gmail.com>
Date: Mon, 26 Apr 2021 18:12:25 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101
 Thunderbird/78.7.1
MIME-Version: 1.0
In-Reply-To: <3bcff580-1c9c-c9ab-b5f1-263ea2388cb1@amd.com>
Content-Language: en-US
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

CgpBbSAyNi4wNC4yMSB1bSAxODowMiBzY2hyaWViIEZlbGl4IEt1ZWhsaW5nOgo+IEFtIDIwMjEt
MDQtMjYgdW0gNDo1NCBhLm0uIHNjaHJpZWIgQ2hyaXN0aWFuIEvDtm5pZzoKPj4gTWVyZ2UgdGhl
IHR3byBsb29wcywgbG9vc2VuIHRoZSByZXN0cmljdGlvbiBmb3IgYmlnIGFsbG9jYXRpb25zLgo+
PiBUaGlzIHJlZHVjZXMgdGhlIENQVSBvdmVyaGVhZCBpbiB0aGUgZ29vZCBjYXNlLCBidXQgaW5j
cmVhc2VzCj4+IGl0IGEgYml0IHVuZGVyIG1lbW9yeSBwcmVzc3VyZS4KPj4KPj4gU2lnbmVkLW9m
Zi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPgo+PiAtLS0K
Pj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdnJhbV9tZ3IuYyB8IDU4ICsr
KysrKysrKy0tLS0tLS0tLS0tCj4+ICAgMSBmaWxlIGNoYW5nZWQsIDI3IGluc2VydGlvbnMoKyks
IDMxIGRlbGV0aW9ucygtKQo+Pgo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3ZyYW1fbWdyLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfdnJhbV9tZ3IuYwo+PiBpbmRleCA1MjljNWMzMmEyMDUuLmUyY2JlMTk0MDRjMCAxMDA2NDQK
Pj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZyYW1fbWdyLmMKPj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZyYW1fbWdyLmMKPj4gQEAg
LTM1OCwxMyArMzU4LDEzIEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3ZyYW1fbWdyX25ldyhzdHJ1Y3Qg
dHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKPj4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0IHR0
bV9wbGFjZSAqcGxhY2UsCj4+ICAgCQkJICAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSkK
Pj4gICB7Cj4+ICsJdW5zaWduZWQgbG9uZyBscGZuLCBudW1fbm9kZXMsIHBhZ2VzX3Blcl9ub2Rl
LCBwYWdlc19sZWZ0LCBwYWdlczsKPj4gICAJc3RydWN0IGFtZGdwdV92cmFtX21nciAqbWdyID0g
dG9fdnJhbV9tZ3IobWFuKTsKPj4gICAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSB0b19h
bWRncHVfZGV2aWNlKG1ncik7Cj4+ICsJdWludDY0X3QgdmlzX3VzYWdlID0gMCwgbWVtX2J5dGVz
LCBtYXhfYnl0ZXM7Cj4+ICAgCXN0cnVjdCBkcm1fbW0gKm1tID0gJm1nci0+bW07Cj4+IC0Jc3Ry
dWN0IGRybV9tbV9ub2RlICpub2RlczsKPj4gICAJZW51bSBkcm1fbW1faW5zZXJ0X21vZGUgbW9k
ZTsKPj4gLQl1bnNpZ25lZCBsb25nIGxwZm4sIG51bV9ub2RlcywgcGFnZXNfcGVyX25vZGUsIHBh
Z2VzX2xlZnQ7Cj4+IC0JdWludDY0X3QgdmlzX3VzYWdlID0gMCwgbWVtX2J5dGVzLCBtYXhfYnl0
ZXM7Cj4+ICsJc3RydWN0IGRybV9tbV9ub2RlICpub2RlczsKPj4gICAJdW5zaWduZWQgaTsKPj4g
ICAJaW50IHI7Cj4+ICAgCj4+IEBAIC0zOTEsOSArMzkxLDEwIEBAIHN0YXRpYyBpbnQgYW1kZ3B1
X3ZyYW1fbWdyX25ldyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKPj4gICAJCXBh
Z2VzX3Blcl9ub2RlID0gSFBBR0VfUE1EX05SOwo+PiAgICNlbHNlCj4+ICAgCQkvKiBkZWZhdWx0
IHRvIDJNQiAqLwo+PiAtCQlwYWdlc19wZXJfbm9kZSA9ICgyVUwgPDwgKDIwVUwgLSBQQUdFX1NI
SUZUKSk7Cj4+ICsJCXBhZ2VzX3Blcl9ub2RlID0gMlVMIDw8ICgyMFVMIC0gUEFHRV9TSElGVCk7
Cj4+ICAgI2VuZGlmCj4+IC0JCXBhZ2VzX3Blcl9ub2RlID0gbWF4KCh1aW50MzJfdClwYWdlc19w
ZXJfbm9kZSwgbWVtLT5wYWdlX2FsaWdubWVudCk7Cj4+ICsJCXBhZ2VzX3Blcl9ub2RlID0gbWF4
X3QodWludDMyX3QsIHBhZ2VzX3Blcl9ub2RlLAo+PiArCQkJCSAgICAgICBtZW0tPnBhZ2VfYWxp
Z25tZW50KTsKPj4gICAJCW51bV9ub2RlcyA9IERJVl9ST1VORF9VUChtZW0tPm51bV9wYWdlcywg
cGFnZXNfcGVyX25vZGUpOwo+PiAgIAl9Cj4+ICAgCj4+IEBAIC00MTEsNDIgKzQxMiwzNyBAQCBz
dGF0aWMgaW50IGFtZGdwdV92cmFtX21ncl9uZXcoc3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2Vy
ICptYW4sCj4+ICAgCW1lbS0+c3RhcnQgPSAwOwo+PiAgIAlwYWdlc19sZWZ0ID0gbWVtLT5udW1f
cGFnZXM7Cj4+ICAgCj4+IC0Jc3Bpbl9sb2NrKCZtZ3ItPmxvY2spOwo+PiAtCWZvciAoaSA9IDA7
IHBhZ2VzX2xlZnQgPj0gcGFnZXNfcGVyX25vZGU7ICsraSkgewo+PiAtCQl1bnNpZ25lZCBsb25n
IHBhZ2VzID0gcm91bmRkb3duX3Bvd19vZl90d28ocGFnZXNfbGVmdCk7Cj4+IC0KPj4gLQkJLyog
TGltaXQgbWF4aW11bSBzaXplIHRvIDJHQiBkdWUgdG8gU0cgdGFibGUgbGltaXRhdGlvbnMgKi8K
Pj4gLQkJcGFnZXMgPSBtaW4ocGFnZXMsICgyVUwgPDwgKDMwIC0gUEFHRV9TSElGVCkpKTsKPj4g
KwkvKiBMaW1pdCBtYXhpbXVtIHNpemUgdG8gMkdCIGR1ZSB0byBTRyB0YWJsZSBsaW1pdGF0aW9u
cyAqLwo+PiArCXBhZ2VzID0gbWluKHBhZ2VzX2xlZnQsIDJVTCA8PCAoMzAgLSBQQUdFX1NISUZU
KSk7Cj4+ICAgCj4+IC0JCXIgPSBkcm1fbW1faW5zZXJ0X25vZGVfaW5fcmFuZ2UobW0sICZub2Rl
c1tpXSwgcGFnZXMsCj4+IC0JCQkJCQlwYWdlc19wZXJfbm9kZSwgMCwKPj4gLQkJCQkJCXBsYWNl
LT5mcGZuLCBscGZuLAo+PiAtCQkJCQkJbW9kZSk7Cj4+IC0JCWlmICh1bmxpa2VseShyKSkKPj4g
LQkJCWJyZWFrOwo+PiAtCj4+IC0JCXZpc191c2FnZSArPSBhbWRncHVfdnJhbV9tZ3JfdmlzX3Np
emUoYWRldiwgJm5vZGVzW2ldKTsKPj4gLQkJYW1kZ3B1X3ZyYW1fbWdyX3ZpcnRfc3RhcnQobWVt
LCAmbm9kZXNbaV0pOwo+PiAtCQlwYWdlc19sZWZ0IC09IHBhZ2VzOwo+PiAtCX0KPj4gLQo+PiAt
CWZvciAoOyBwYWdlc19sZWZ0OyArK2kpIHsKPj4gLQkJdW5zaWduZWQgbG9uZyBwYWdlcyA9IG1p
bihwYWdlc19sZWZ0LCBwYWdlc19wZXJfbm9kZSk7Cj4+ICsJaSA9IDA7Cj4+ICsJc3Bpbl9sb2Nr
KCZtZ3ItPmxvY2spOwo+PiArCXdoaWxlIChwYWdlc19sZWZ0KSB7Cj4+ICAgCQl1aW50MzJfdCBh
bGlnbm1lbnQgPSBtZW0tPnBhZ2VfYWxpZ25tZW50Owo+PiAgIAo+PiAtCQlpZiAocGFnZXMgPT0g
cGFnZXNfcGVyX25vZGUpCj4+ICsJCWlmIChwYWdlcyA+PSBwYWdlc19wZXJfbm9kZSkKPj4gICAJ
CQlhbGlnbm1lbnQgPSBwYWdlc19wZXJfbm9kZTsKPj4gICAKPj4gLQkJciA9IGRybV9tbV9pbnNl
cnRfbm9kZV9pbl9yYW5nZShtbSwgJm5vZGVzW2ldLAo+PiAtCQkJCQkJcGFnZXMsIGFsaWdubWVu
dCwgMCwKPj4gLQkJCQkJCXBsYWNlLT5mcGZuLCBscGZuLAo+PiAtCQkJCQkJbW9kZSk7Cj4+IC0J
CWlmICh1bmxpa2VseShyKSkKPj4gKwkJciA9IGRybV9tbV9pbnNlcnRfbm9kZV9pbl9yYW5nZSht
bSwgJm5vZGVzW2ldLCBwYWdlcywgYWxpZ25tZW50LAo+PiArCQkJCQkJMCwgcGxhY2UtPmZwZm4s
IGxwZm4sIG1vZGUpOwo+PiArCQlpZiAodW5saWtlbHkocikpIHsKPj4gKwkJCWlmIChwYWdlcyA+
IHBhZ2VzX3Blcl9ub2RlKSB7Cj4gVGhpcyBtZWFucyB3ZSBjYW4gbmV2ZXIgYWxsb2NhdGUgY2h1
bmtzIHNtYWxsZXIgdGhhbiAyTUIsIGV4Y2VwdCBmb3IgdGhlCj4gdGFpbC4gQW5kIHRoZSB0YWls
IHN0aWxsIG5lZWRzIHRvIGJlIGFsbG9jYXRlZCBpbiBvbmUgcGllY2UgaWYgaXQncyA8IDJNQi4K
CkNvcnJlY3QsIGJ1dCB0aGF0IHdhcyB0aGUgYmVoYXZpb3IgYmVmb3JlIGFzIHdlbGwuCgo+IE9u
IHRoZSBvdGhlciBoYW5kLCB3ZSBzaG91bGQgbm90IGFsbG93IGFsbG9jYXRpb25zIHNtYWxsZXIg
dGhhbgo+IG1lbS0+cGFnZV9hbGlnbm1lbnQsIGV4Y2VwdCBmb3IgdGhlIHRhaWwuIFNvIHNob3Vs
ZCB0aGlzIGNvbmRpdGlvbiBiZQo+ICJpZiAocGFnZXMgPiBtZW0tPnBhZ2VfYWxpZ25tZW50KSIg
dG8gYWxsb3cgbWF4aW11bSBmbGV4aWJpbGl0eSBmb3IKPiBhbGxvY2F0aW9ucyB3aXRob3V0IHBo
eXNpY2FsIGFsaWdubWVudCBjb25zdHJhaW50cyB3aGVuIG1lbW9yeSBpcyB2ZXJ5Cj4gZnJhZ21l
bnRlZD8KClNlZSBhIGZldyBsaW5lcyBhYm92ZToKCnBhZ2VzX3Blcl9ub2RlID0gbWF4X3QodWlu
dDMyX3QsIHBhZ2VzX3Blcl9ub2RlLCBwYWdlX2FsaWdubWVudCk7CgpTbyBwYWdlc19wZXJfbm9k
ZSBpcyBhbHdheXMgbGFyZ2VyIHRoYW4gcGFnZV9hbGlnbm1lbnQgYW5kIHdlIGFjdHVhbGx5IApj
YW4ndCBhbGxvY2F0ZSBsZXNzIHRoYW4gcGFnZXNfcGVyX25vZGUgaW4gb25lIGFsbG9jYXRpb24g
b3Igd2Ugd291bGQgCm92ZXJmbG93IHRoZSBub2RlcyBhcnJheS4KClJlZ2FyZHMsCkNocmlzdGlh
bi4KCj4KPiBSZWdhcmRzLAo+ICDCoCBGZWxpeAo+Cj4KPj4gKwkJCQlpZiAoaXNfcG93ZXJfb2Zf
MihwYWdlcykpCj4+ICsJCQkJCXBhZ2VzID0gcGFnZXMgLyAyOwo+PiArCQkJCWVsc2UKPj4gKwkJ
CQkJcGFnZXMgPSByb3VuZGRvd25fcG93X29mX3R3byhwYWdlcyk7Cj4+ICsJCQkJY29udGludWU7
Cj4+ICsJCQl9Cj4+ICAgCQkJZ290byBlcnJvcjsKPj4gKwkJfQo+PiAgIAo+PiAgIAkJdmlzX3Vz
YWdlICs9IGFtZGdwdV92cmFtX21ncl92aXNfc2l6ZShhZGV2LCAmbm9kZXNbaV0pOwo+PiAgIAkJ
YW1kZ3B1X3ZyYW1fbWdyX3ZpcnRfc3RhcnQobWVtLCAmbm9kZXNbaV0pOwo+PiAgIAkJcGFnZXNf
bGVmdCAtPSBwYWdlczsKPj4gKwkJKytpOwo+PiArCj4+ICsJCWlmIChwYWdlcyA+IHBhZ2VzX2xl
ZnQpCj4+ICsJCQlwYWdlcyA9IHBhZ2VzX2xlZnQ7Cj4+ICAgCX0KPj4gICAJc3Bpbl91bmxvY2so
Jm1nci0+bG9jayk7Cj4+ICAgCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1n
ZngK
