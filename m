Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id EC8EF10EE48
	for <lists+amd-gfx@lfdr.de>; Mon,  2 Dec 2019 18:35:01 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C832C6E2A0;
	Mon,  2 Dec 2019 17:34:59 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM03-DM3-obe.outbound.protection.outlook.com
 (mail-dm3nam03on0615.outbound.protection.outlook.com
 [IPv6:2a01:111:f400:fe49::615])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9858F6E29B
 for <amd-gfx@lists.freedesktop.org>; Mon,  2 Dec 2019 17:34:56 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=WY+xCPw4JXAQ+clZtPKyjyn89tlCUUEaMD3VNMEt/qxKH9NSF4/fxSM1E+VQQAcgB8x1g3EIzneIwzqzj/oVerNp4RWAl+opNhe0q2j/82aTxYEG9Z+QyYl4t7wtO14jsnwI/HxVNtT6tNakDPTPBCCqs7k5E32/zZAhUGOTLCpuerlY9UZZ/9unGUfdie2oVzek/cMT6RB1QADqYGUc1PhakEX7yWv5dy66pzT1HfEe5j+UVsfTsljTjtoH+LDfDf/WLChKv9m13qWta45r5nluCjruyMVobIMTgRim94iVECxcWolLDHeXrmf0QM+j3O1wJslfY7CgEDybVUhtwA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=CzP+5rplkmKUtRVUW6zuMFh43Ldo73Wi5CxilvHkuR8=;
 b=DJpmIH2zVVCUtA+95Klg9xd8dMScq1Tkjp+paRUx8WDaervPCkZJ86p6jVco/n6FwAOB23oQw815HYfso512iB22sT51lQ+8XoufGcozi5FG6n7+7Lg4LNGNjdzEybP1gQusbM1Y0wkTmnxCECjhkT6Kltugk9RiXN1ed0vnqt82TvvIKPQFHqirAE+r60XI4JSUxy8KD4hRvogspU2kSrpr/sTAFW8V8FJt11ZHdTikSur7kNJXKFXAr8uMRsWeQzaKaBeU+RkBZf+f1rkr6/hKj0cgKGzvSwyhddFFMXIwJLEVG567qcD/GIk5WVS3owufCU5V3Oimiqeg91Gu0g==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from BN7PR12MB2593.namprd12.prod.outlook.com (20.176.27.87) by
 BN7PR12MB2610.namprd12.prod.outlook.com (20.176.26.140) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2495.22; Mon, 2 Dec 2019 17:34:50 +0000
Received: from BN7PR12MB2593.namprd12.prod.outlook.com
 ([fe80::2070:7583:3718:d019]) by BN7PR12MB2593.namprd12.prod.outlook.com
 ([fe80::2070:7583:3718:d019%3]) with mapi id 15.20.2495.014; Mon, 2 Dec 2019
 17:34:50 +0000
From: sunpeng.li@amd.com
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 03/51] drm/amd/display: add separate of private hwss functions
Date: Mon,  2 Dec 2019 12:33:17 -0500
Message-Id: <20191202173405.31582-4-sunpeng.li@amd.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191202173405.31582-1-sunpeng.li@amd.com>
References: <20191202173405.31582-1-sunpeng.li@amd.com>
X-ClientProxiedBy: YTBPR01CA0029.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b01:14::42) To BN7PR12MB2593.namprd12.prod.outlook.com
 (2603:10b6:408:25::23)
MIME-Version: 1.0
X-Mailer: git-send-email 2.24.0
X-Originating-IP: [165.204.55.250]
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-HT: Tenant
X-MS-Office365-Filtering-Correlation-Id: 925df229-a6bf-4b60-26ca-08d7774deeae
X-MS-TrafficTypeDiagnostic: BN7PR12MB2610:|BN7PR12MB2610:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <BN7PR12MB2610924C14C08AC3C20F031182430@BN7PR12MB2610.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:2803;
X-Forefront-PRVS: 0239D46DB6
X-Forefront-Antispam-Report: SFV:NSPM;
 SFS:(10009020)(4636009)(376002)(366004)(396003)(39860400002)(346002)(136003)(189003)(199004)(76176011)(6666004)(51416003)(52116002)(30864003)(6512007)(66476007)(66556008)(316002)(50226002)(5660300002)(6916009)(81166006)(26005)(2616005)(99286004)(386003)(6506007)(1076003)(8936002)(11346002)(305945005)(446003)(81156014)(186003)(9686003)(6436002)(4326008)(8676002)(6486002)(7736002)(66946007)(54906003)(14444005)(48376002)(50466002)(86362001)(6116002)(2351001)(3846002)(2906002)(25786009)(36756003)(66066001)(2870700001)(2361001)(14454004)(478600001)(47776003)(569006);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BN7PR12MB2610;
 H:BN7PR12MB2593.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: wFkry2cSsG+zc1EfyxMrZiGlWBHcltL1TSWNhTiCkl4D/bHPp33Xoat5Sfuk+s8VroNWevv7CXxWger1mAQpi0/YtwiaZw7LFBJfNxOEmBOqDRXhNxFS9+WBwUqWSYDVpNgwgwSkmoOnmbiTIYxhJ+G58PSWnA6wPjm8XKdEl5LO6N8BBp0oXpLsx5bbJLcfJunjSUkkJmdk+XFGvYBHEJvrHYoLMK5Z8JrDcpSTsY5Q3/We0/ir2tYazYOKw2l1AIw5q4qP1S7Lzy0md/KN+PR0OTwmhMvoI9Nw7rkbXN+JxiRLizQ0KZAC5vZTx+stvZtvNXgVD+R82AasgLZdZGBwSbzZP5Vezn6n4oj/Jx7/gldiM1Yn02PI40fMtGDkFywOPhO3PsReqRrh3gdn/dtPxsepfCLHJ6lzejatTG9yPZ8GQQftXs7Kd25Y9CLJ
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 925df229-a6bf-4b60-26ca-08d7774deeae
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 02 Dec 2019 17:34:50.1379 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: bFW5cDLoOgTIt/gcU1H46G/reYKazjM+hWDxXQv9RPMZmmoUKMZROmyQfv8fxqiL
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN7PR12MB2610
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=CzP+5rplkmKUtRVUW6zuMFh43Ldo73Wi5CxilvHkuR8=;
 b=P01sUKxFYQ75AO1pxkK+EjxLKg/kWJuLKuohP69fjKh165H967yZuoVGb7prbUQ9clO8nDFEoGXwJ7ZhTnakNESQmr1wtAgQwlAzzXjCGdRLnDSQN35FZSWH55lM4IHiTiVun4QKfDxjOQMv70Z2ZExwJNl2V25DjBOTQxLVhDE=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Sunpeng.Li@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Leo Li <sunpeng.li@amd.com>, Tony Cheng <Tony.Cheng@amd.com>,
 rodrigo.siqueira@amd.com, harry.wentland@amd.com, bhawanpreet.lakha@amd.com,
 Anthony Koo <Anthony.Koo@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW50aG9ueSBLb28gPEFudGhvbnkuS29vQGFtZC5jb20+CgpbV2h5XQpTb21lIGZ1bmN0
aW9uIHBvaW50ZXJzIGluIHRoZSBod3NzIGZ1bmN0aW9uIHBvaW50ZXIgdGFibGUgYXJlCm1lYW50
IHRvIGJlIGh3IHNlcXVlbmNlciBlbnRyeSBwb2ludHMgdG8gYmUgY2FsbGVkIGZyb20gZGMuCgpI
b3dldmVyIHNvbWUgb2YgdGhvc2UgZnVuY3Rpb24gcG9pbnRlcnMgYXJlIG5vdCBtZWFudCB0bwpi
ZSBlbnRyeSBwb2ludHMsIGJ1dCBpbnN0ZWFkIHVzZWQgYXMgYSBjb2RlIHJldXNlL2luaGVyaXRh
bmNlCnRvb2wgY2FsbGVkIGRpcmVjdGx5IGJ5IG90aGVyIGh3c3MgZnVuY3Rpb25zLCBub3QgYnkg
ZGMuCgpUaGVyZWZvcmUsIHdlIHdhbnQgYSBtb3JlIGNsZWFyIHNlcGFyYXRpb24gb2Ygd2hpY2gg
ZnVuY3Rpb25zCndlIGRldGVybWluZSB0byBiZSBpbnRlcmZhY2UgZnVuY3Rpb25zIHZzIHRoZSBm
dW5jdGlvbnMgd2UKdXNlIHdpdGhpbiBod3NzLgoKW0hvd10KREMgaW50ZXJmYWNlIGZ1bmN0aW9u
cyB3aWxsIGJlIHN0b3JlZCBpbjoKICAgIHN0cnVjdCBod19zZXF1ZW5jZXJfZnVuY3MKRnVuY3Rp
b25zIHVzZWQgd2l0aGluIEhXU1Mgd2lsbCBiZSBzdG9yZWQgaW46CiAgICBzdHJ1Y3QgaHdzZXFf
cHJpdmF0ZV9mdW5jcwoKU2lnbmVkLW9mZi1ieTogQW50aG9ueSBLb28gPEFudGhvbnkuS29vQGFt
ZC5jb20+ClJldmlld2VkLWJ5OiBUb255IENoZW5nIDxUb255LkNoZW5nQGFtZC5jb20+CkFja2Vk
LWJ5OiBMZW8gTGkgPHN1bnBlbmcubGlAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvY29yZS9kYy5jICAgICAgfCAgIDYgKwogLi4uL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvY29yZS9kY19kZWJ1Zy5jICAgIHwgICAxIC0KIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2NvcmUvZGNfc3RyZWFtLmMgICB8ICAgMyAtCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9k
Yy9kY2UvZGNlX2h3c2VxLmMgICAgfCAgIDIgKy0KIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L2Rj
L2RjZS9kY2VfaHdzZXEuaCAgICB8ICAgNiArLQogLi4uL2Rpc3BsYXkvZGMvZGNlMTAwL2RjZTEw
MF9od19zZXF1ZW5jZXIuYyAgIHwgICAzICstCiAuLi4vZGlzcGxheS9kYy9kY2UxMDAvZGNlMTAw
X2h3X3NlcXVlbmNlci5oICAgfCAgIDEgKwogLi4uL2Rpc3BsYXkvZGMvZGNlMTEwL2RjZTExMF9o
d19zZXF1ZW5jZXIuYyAgIHwgIDc3ICsrLS0KIC4uLi9kaXNwbGF5L2RjL2RjZTExMC9kY2UxMTBf
aHdfc2VxdWVuY2VyLmggICB8ICAgMSArCiAuLi4vYW1kL2Rpc3BsYXkvZGMvZGNlMTEwL2RjZTEx
MF9yZXNvdXJjZS5jICAgfCAgIDMgKy0KIC4uLi9kaXNwbGF5L2RjL2RjZTExMi9kY2UxMTJfaHdf
c2VxdWVuY2VyLmMgICB8ICAgMiArLQogLi4uL2Rpc3BsYXkvZGMvZGNlMTEyL2RjZTExMl9od19z
ZXF1ZW5jZXIuaCAgIHwgICAxICsKIC4uLi9kaXNwbGF5L2RjL2RjZTEyMC9kY2UxMjBfaHdfc2Vx
dWVuY2VyLmMgICB8ICAgMiArLQogLi4uL2Rpc3BsYXkvZGMvZGNlMTIwL2RjZTEyMF9od19zZXF1
ZW5jZXIuaCAgIHwgICAxICsKIC4uLi9hbWQvZGlzcGxheS9kYy9kY2U4MC9kY2U4MF9od19zZXF1
ZW5jZXIuYyB8ICAgMiArLQogLi4uL2FtZC9kaXNwbGF5L2RjL2RjZTgwL2RjZTgwX2h3X3NlcXVl
bmNlci5oIHwgICAxICsKIC4uLi9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9od19zZXF1ZW5j
ZXIuYyB8IDEyNCArKystLS0KIC4uLi9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9od19zZXF1
ZW5jZXIuaCB8ICAgMSArCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9p
bml0LmMgfCAgMzggKy0KIC4uLi9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHdzZXEu
YyAgICB8ICA3MSArKy0tCiAuLi4vZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h3c2Vx
LmggICAgfCAgIDMgKwogLi4uL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaW5p
dC5jIHwgIDU0ICstLQogLi4uL2RybS9hbWQvZGlzcGxheS9kYy9kY24yMS9kY24yMV9od3NlcS5j
ICAgIHwgICAxICsKIC4uLi9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjEvZGNuMjFfaHdzZXEuaCAg
ICB8ICAgMiArCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMS9kY24yMV9pbml0LmMg
fCAgNjMgKy0tCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHdfc2VxdWVuY2VyLmgg
fCAzNzAgKysrKystLS0tLS0tLS0tLS0tCiAuLi4vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3X3NlcXVl
bmNlcl9wcml2YXRlLmggfCAxNTYgKysrKysrKysKIDI3IGZpbGVzIGNoYW5nZWQsIDUyNSBpbnNl
cnRpb25zKCspLCA0NzAgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9od19zZXF1ZW5jZXJfcHJpdmF0ZS5oCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2NvcmUvZGMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvZGlzcGxheS9kYy9jb3JlL2RjLmMKaW5kZXggMjY0NWQyMGU4YzRjLi5lMzg0
YzE0M2JiNTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9jb3Jl
L2RjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2NvcmUvZGMuYwpAQCAt
MjAwNCw2ICsyMDA0LDEyIEBAIHN0YXRpYyB2b2lkIGNvbW1pdF9wbGFuZXNfZG9fc3RyZWFtX3Vw
ZGF0ZShzdHJ1Y3QgZGMgKmRjLAogCQkJCWRjLT5od3NzLnVwZGF0ZV9pbmZvX2ZyYW1lKHBpcGVf
Y3R4KTsKIAkJCX0KIAorCQkJaWYgKHN0cmVhbV91cGRhdGUtPmhkcl9zdGF0aWNfbWV0YWRhdGEg
JiYKKwkJCQkJc3RyZWFtLT51c2VfZHluYW1pY19tZXRhICYmCisJCQkJCWRjLT5od3NzLnNldF9k
bWRhdGFfYXR0cmlidXRlcyAmJgorCQkJCQlwaXBlX2N0eC0+c3RyZWFtLT5kbWRhdGFfYWRkcmVz
cy5xdWFkX3BhcnQgIT0gMCkKKwkJCQlkYy0+aHdzcy5zZXRfZG1kYXRhX2F0dHJpYnV0ZXMocGlw
ZV9jdHgpOworCiAJCQlpZiAoc3RyZWFtX3VwZGF0ZS0+Z2FtdXRfcmVtYXApCiAJCQkJZGNfc3Ry
ZWFtX3NldF9nYW11dF9yZW1hcChkYywgc3RyZWFtKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2NvcmUvZGNfZGVidWcuYyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9jb3JlL2RjX2RlYnVnLmMKaW5kZXggYmYxM2NmZmVkNzAzLi41MDJlZDNj
Nzk1OWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9jb3JlL2Rj
X2RlYnVnLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2NvcmUvZGNfZGVi
dWcuYwpAQCAtMzMsNyArMzMsNiBAQAogCiAjaW5jbHVkZSAiY29yZV9zdGF0dXMuaCIKICNpbmNs
dWRlICJjb3JlX3R5cGVzLmgiCi0jaW5jbHVkZSAiaHdfc2VxdWVuY2VyLmgiCiAKICNpbmNsdWRl
ICJyZXNvdXJjZS5oIgogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvY29yZS9kY19zdHJlYW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9jb3Jl
L2RjX3N0cmVhbS5jCmluZGV4IDcwYjdjMWViOGE4Zi4uYjQzYTRiMTE1ZmQ4IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kY19zdHJlYW0uYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kY19zdHJlYW0uYwpAQCAtMzMsOSAr
MzMsNiBAQAogI2luY2x1ZGUgInJlc291cmNlLmgiCiAjaW5jbHVkZSAiaXBwLmgiCiAjaW5jbHVk
ZSAidGltaW5nX2dlbmVyYXRvci5oIgotI2lmIGRlZmluZWQoQ09ORklHX0RSTV9BTURfRENfRENO
KQotI2luY2x1ZGUgImRjbjEwL2RjbjEwX2h3X3NlcXVlbmNlci5oIgotI2VuZGlmCiAKICNkZWZp
bmUgRENfTE9HR0VSIGRjLT5jdHgtPmxvZ2dlcgogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNlL2RjZV9od3NlcS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2RjZS9kY2VfaHdzZXEuYwppbmRleCAwMjc1ZDZkNjBkYTQuLmUxYzU4MzlhODBk
YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjZS9kY2VfaHdz
ZXEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNlL2RjZV9od3NlcS5j
CkBAIC0yNSw3ICsyNSw3IEBACiAKICNpbmNsdWRlICJkY2VfaHdzZXEuaCIKICNpbmNsdWRlICJy
ZWdfaGVscGVyLmgiCi0jaW5jbHVkZSAiaHdfc2VxdWVuY2VyLmgiCisjaW5jbHVkZSAiaHdfc2Vx
dWVuY2VyX3ByaXZhdGUuaCIKICNpbmNsdWRlICJjb3JlX3R5cGVzLmgiCiAKICNkZWZpbmUgQ1RY
IFwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY2UvZGNlX2h3
c2VxLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNlL2RjZV9od3NlcS5oCmlu
ZGV4IGJmZjAzYTY4YWEwMS4uYzVhYTFmNDg1OTNhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNlL2RjZV9od3NlcS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9kY2UvZGNlX2h3c2VxLmgKQEAgLTI1LDcgKzI1LDcgQEAKICNpZm5kZWYg
X19EQ0VfSFdTRVFfSF9fCiAjZGVmaW5lIF9fRENFX0hXU0VRX0hfXwogCi0jaW5jbHVkZSAiaHdf
c2VxdWVuY2VyLmgiCisjaW5jbHVkZSAiZGNfdHlwZXMuaCIKIAogI2RlZmluZSBCTF9SRUdfTElT
VCgpXAogCVNSKExWVE1BX1BXUlNFUV9DTlRMKSwgXApAQCAtODExLDYgKzgxMSwxMCBAQCBlbnVt
IGJsbmRfbW9kZSB7CiAJQkxORF9NT0RFX0JMRU5ESU5HLC8qIEFscGhhIGJsZW5kaW5nIC0gYmxl
bmQgJ2N1cnJlbnQnIGFuZCAnb3RoZXInICovCiB9OwogCitzdHJ1Y3QgZGNlX2h3c2VxOworc3Ry
dWN0IHBpcGVfY3R4Oworc3RydWN0IGNsb2NrX3NvdXJjZTsKKwogdm9pZCBkY2VfZW5hYmxlX2Zl
X2Nsb2NrKHN0cnVjdCBkY2VfaHdzZXEgKmh3c3MsCiAJCXVuc2lnbmVkIGludCBpbnN0LCBib29s
IGVuYWJsZSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
Y2UxMDAvZGNlMTAwX2h3X3NlcXVlbmNlci5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2RjZTEwMC9kY2UxMDBfaHdfc2VxdWVuY2VyLmMKaW5kZXggNzk5ZDM2Mjk5YzliLi43NTNj
YjhlZGQ5OTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY2Ux
MDAvZGNlMTAwX2h3X3NlcXVlbmNlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9kY2UxMDAvZGNlMTAwX2h3X3NlcXVlbmNlci5jCkBAIC0yNiw3ICsyNiw2IEBACiAjaW5j
bHVkZSAiZGMuaCIKICNpbmNsdWRlICJjb3JlX3R5cGVzLmgiCiAjaW5jbHVkZSAiY2xrX21nci5o
IgotI2luY2x1ZGUgImh3X3NlcXVlbmNlci5oIgogI2luY2x1ZGUgImRjZTEwMF9od19zZXF1ZW5j
ZXIuaCIKICNpbmNsdWRlICJyZXNvdXJjZS5oIgogCkBAIC0xMzYsNyArMTM1LDcgQEAgdm9pZCBk
Y2UxMDBfaHdfc2VxdWVuY2VyX2NvbnN0cnVjdChzdHJ1Y3QgZGMgKmRjKQogewogCWRjZTExMF9o
d19zZXF1ZW5jZXJfY29uc3RydWN0KGRjKTsKIAotCWRjLT5od3NzLmVuYWJsZV9kaXNwbGF5X3Bv
d2VyX2dhdGluZyA9IGRjZTEwMF9lbmFibGVfZGlzcGxheV9wb3dlcl9nYXRpbmc7CisJZGMtPmh3
c2VxLT5mdW5jcy5lbmFibGVfZGlzcGxheV9wb3dlcl9nYXRpbmcgPSBkY2UxMDBfZW5hYmxlX2Rp
c3BsYXlfcG93ZXJfZ2F0aW5nOwogCWRjLT5od3NzLnByZXBhcmVfYmFuZHdpZHRoID0gZGNlMTAw
X3ByZXBhcmVfYmFuZHdpZHRoOwogCWRjLT5od3NzLm9wdGltaXplX2JhbmR3aWR0aCA9IGRjZTEw
MF9vcHRpbWl6ZV9iYW5kd2lkdGg7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvZGNlMTAwL2RjZTEwMF9od19zZXF1ZW5jZXIuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvZGlzcGxheS9kYy9kY2UxMDAvZGNlMTAwX2h3X3NlcXVlbmNlci5oCmluZGV4IGE2Yjgw
ZmRhYTY2Ni4uMzQ1MThkYTIwMDA5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvZGNlMTAwL2RjZTEwMF9od19zZXF1ZW5jZXIuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNlMTAwL2RjZTEwMF9od19zZXF1ZW5jZXIuaApAQCAtMjcsNiAr
MjcsNyBAQAogI2RlZmluZSBfX0RDX0hXU1NfRENFMTAwX0hfXwogCiAjaW5jbHVkZSAiY29yZV90
eXBlcy5oIgorI2luY2x1ZGUgImh3X3NlcXVlbmNlcl9wcml2YXRlLmgiCiAKIHN0cnVjdCBkYzsK
IHN0cnVjdCBkY19zdGF0ZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9kY2UxMTAvZGNlMTEwX2h3X3NlcXVlbmNlci5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2RjZTExMC9kY2UxMTBfaHdfc2VxdWVuY2VyLmMKaW5kZXggMmIyZWU2ODkzZTI1
Li40OTM5Y2YzYjMxNmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9k
Yy9kY2UxMTAvZGNlMTEwX2h3X3NlcXVlbmNlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kY2UxMTAvZGNlMTEwX2h3X3NlcXVlbmNlci5jCkBAIC02NTMsMTAgKzY1Myw5
IEBAIHZvaWQgZGNlMTEwX2VuYWJsZV9zdHJlYW0oc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCkK
IHsKIAllbnVtIGRjX2xhbmVfY291bnQgbGFuZV9jb3VudCA9CiAJCXBpcGVfY3R4LT5zdHJlYW0t
PmxpbmstPmN1cl9saW5rX3NldHRpbmdzLmxhbmVfY291bnQ7Ci0KIAlzdHJ1Y3QgZGNfY3J0Y190
aW1pbmcgKnRpbWluZyA9ICZwaXBlX2N0eC0+c3RyZWFtLT50aW1pbmc7CiAJc3RydWN0IGRjX2xp
bmsgKmxpbmsgPSBwaXBlX2N0eC0+c3RyZWFtLT5saW5rOwotCisJY29uc3Qgc3RydWN0IGRjICpk
YyA9IGxpbmstPmRjOwogCiAJdWludDMyX3QgYWN0aXZlX3RvdGFsX3dpdGhfYm9yZGVyczsKIAl1
aW50MzJfdCBlYXJseV9jb250cm9sID0gMDsKQEAgLTY2OSw3ICs2NjgsNyBAQCB2b2lkIGRjZTEx
MF9lbmFibGVfc3RyZWFtKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpCiAJbGluay0+bGlua19l
bmMtPmZ1bmNzLT5jb25uZWN0X2RpZ19iZV90b19mZShsaW5rLT5saW5rX2VuYywKIAkJCQkJCSAg
ICBwaXBlX2N0eC0+c3RyZWFtX3Jlcy5zdHJlYW1fZW5jLT5pZCwgdHJ1ZSk7CiAKLQlsaW5rLT5k
Yy0+aHdzcy51cGRhdGVfaW5mb19mcmFtZShwaXBlX2N0eCk7CisJZGMtPmh3c3MudXBkYXRlX2lu
Zm9fZnJhbWUocGlwZV9jdHgpOwogCiAJLyogZW5hYmxlIGVhcmx5IGNvbnRyb2wgdG8gYXZvaWQg
Y29ycnVwdGlvbiBvbiBEUCBtb25pdG9yKi8KIAlhY3RpdmVfdG90YWxfd2l0aF9ib3JkZXJzID0K
QEAgLTEwNDksNiArMTA0OCw3IEBAIHZvaWQgZGNlMTEwX3VuYmxhbmtfc3RyZWFtKHN0cnVjdCBw
aXBlX2N0eCAqcGlwZV9jdHgsCiAJc3RydWN0IGVuY29kZXJfdW5ibGFua19wYXJhbSBwYXJhbXMg
PSB7IHsgMCB9IH07CiAJc3RydWN0IGRjX3N0cmVhbV9zdGF0ZSAqc3RyZWFtID0gcGlwZV9jdHgt
PnN0cmVhbTsKIAlzdHJ1Y3QgZGNfbGluayAqbGluayA9IHN0cmVhbS0+bGluazsKKwlzdHJ1Y3Qg
ZGNlX2h3c2VxICpod3MgPSBsaW5rLT5kYy0+aHdzZXE7CiAKIAkvKiBvbmx5IDMgaXRlbXMgYmVs
b3cgYXJlIHVzZWQgYnkgdW5ibGFuayAqLwogCXBhcmFtcy50aW1pbmcgPSBwaXBlX2N0eC0+c3Ry
ZWFtLT50aW1pbmc7CkBAIC0xMDU4LDcgKzEwNTgsNyBAQCB2b2lkIGRjZTExMF91bmJsYW5rX3N0
cmVhbShzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAogCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy5z
dHJlYW1fZW5jLT5mdW5jcy0+ZHBfdW5ibGFuayhwaXBlX2N0eC0+c3RyZWFtX3Jlcy5zdHJlYW1f
ZW5jLCAmcGFyYW1zKTsKIAogCWlmIChsaW5rLT5sb2NhbF9zaW5rICYmIGxpbmstPmxvY2FsX3Np
bmstPnNpbmtfc2lnbmFsID09IFNJR05BTF9UWVBFX0VEUCkgewotCQlsaW5rLT5kYy0+aHdzcy5l
ZHBfYmFja2xpZ2h0X2NvbnRyb2wobGluaywgdHJ1ZSk7CisJCWh3cy0+ZnVuY3MuZWRwX2JhY2ts
aWdodF9jb250cm9sKGxpbmssIHRydWUpOwogCX0KIH0KIApAQCAtMTA2Niw5ICsxMDY2LDEwIEBA
IHZvaWQgZGNlMTEwX2JsYW5rX3N0cmVhbShzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KQogewog
CXN0cnVjdCBkY19zdHJlYW1fc3RhdGUgKnN0cmVhbSA9IHBpcGVfY3R4LT5zdHJlYW07CiAJc3Ry
dWN0IGRjX2xpbmsgKmxpbmsgPSBzdHJlYW0tPmxpbms7CisJc3RydWN0IGRjZV9od3NlcSAqaHdz
ID0gbGluay0+ZGMtPmh3c2VxOwogCiAJaWYgKGxpbmstPmxvY2FsX3NpbmsgJiYgbGluay0+bG9j
YWxfc2luay0+c2lua19zaWduYWwgPT0gU0lHTkFMX1RZUEVfRURQKSB7Ci0JCWxpbmstPmRjLT5o
d3NzLmVkcF9iYWNrbGlnaHRfY29udHJvbChsaW5rLCBmYWxzZSk7CisJCWh3cy0+ZnVuY3MuZWRw
X2JhY2tsaWdodF9jb250cm9sKGxpbmssIGZhbHNlKTsKIAkJZGNfbGlua19zZXRfYWJtX2Rpc2Fi
bGUobGluayk7CiAJfQogCkBAIC0xMzI1LDkgKzEzMjYsMTAgQEAgc3RhdGljIGVudW0gZGNfc3Rh
dHVzIGFwcGx5X3NpbmdsZV9jb250cm9sbGVyX2N0eF90b19odygKIAlzdHJ1Y3QgZHJyX3BhcmFt
cyBwYXJhbXMgPSB7MH07CiAJdW5zaWduZWQgaW50IGV2ZW50X3RyaWdnZXJzID0gMDsKIAlzdHJ1
Y3QgcGlwZV9jdHggKm9kbV9waXBlID0gcGlwZV9jdHgtPm5leHRfb2RtX3BpcGU7CisJc3RydWN0
IGRjZV9od3NlcSAqaHdzID0gZGMtPmh3c2VxOwogCi0JaWYgKGRjLT5od3NzLmRpc2FibGVfc3Ry
ZWFtX2dhdGluZykgewotCQlkYy0+aHdzcy5kaXNhYmxlX3N0cmVhbV9nYXRpbmcoZGMsIHBpcGVf
Y3R4KTsKKwlpZiAoaHdzLT5mdW5jcy5kaXNhYmxlX3N0cmVhbV9nYXRpbmcpIHsKKwkJaHdzLT5m
dW5jcy5kaXNhYmxlX3N0cmVhbV9nYXRpbmcoZGMsIHBpcGVfY3R4KTsKIAl9CiAKIAlpZiAocGlw
ZV9jdHgtPnN0cmVhbV9yZXMuYXVkaW8gIT0gTlVMTCkgewpAQCAtMTM1NywxMCArMTM1OSwxMCBA
QCBzdGF0aWMgZW51bSBkY19zdGF0dXMgYXBwbHlfc2luZ2xlX2NvbnRyb2xsZXJfY3R4X3RvX2h3
KAogCS8qICAqLwogCS8qIERvIG5vdCB0b3VjaCBzdHJlYW0gdGltaW5nIG9uIHNlYW1sZXNzIGJv
b3Qgb3B0aW1pemF0aW9uLiAqLwogCWlmICghcGlwZV9jdHgtPnN0cmVhbS0+YXBwbHlfc2VhbWxl
c3NfYm9vdF9vcHRpbWl6YXRpb24pCi0JCWRjLT5od3NzLmVuYWJsZV9zdHJlYW1fdGltaW5nKHBp
cGVfY3R4LCBjb250ZXh0LCBkYyk7CisJCWh3cy0+ZnVuY3MuZW5hYmxlX3N0cmVhbV90aW1pbmco
cGlwZV9jdHgsIGNvbnRleHQsIGRjKTsKIAotCWlmIChkYy0+aHdzcy5zZXR1cF92dXBkYXRlX2lu
dGVycnVwdCkKLQkJZGMtPmh3c3Muc2V0dXBfdnVwZGF0ZV9pbnRlcnJ1cHQoZGMsIHBpcGVfY3R4
KTsKKwlpZiAoaHdzLT5mdW5jcy5zZXR1cF92dXBkYXRlX2ludGVycnVwdCkKKwkJaHdzLT5mdW5j
cy5zZXR1cF92dXBkYXRlX2ludGVycnVwdChkYywgcGlwZV9jdHgpOwogCiAJcGFyYW1zLnZlcnRp
Y2FsX3RvdGFsX21pbiA9IHN0cmVhbS0+YWRqdXN0LnZfdG90YWxfbWluOwogCXBhcmFtcy52ZXJ0
aWNhbF90b3RhbF9tYXggPSBzdHJlYW0tPmFkanVzdC52X3RvdGFsX21heDsKQEAgLTE1NTMsOSAr
MTU1NSwxMCBAQCB2b2lkIGRjZTExMF9lbmFibGVfYWNjZWxlcmF0ZWRfbW9kZShzdHJ1Y3QgZGMg
KmRjLCBzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpCiAJYm9vbCBjYW5fYXBwbHlfZWRwX2Zhc3Rf
Ym9vdCA9IGZhbHNlOwogCWJvb2wgY2FuX2FwcGx5X3NlYW1sZXNzX2Jvb3QgPSBmYWxzZTsKIAli
b29sIGtlZXBfZWRwX3ZkZF9vbiA9IGZhbHNlOworCXN0cnVjdCBkY2VfaHdzZXEgKmh3cyA9IGRj
LT5od3NlcTsKIAotCWlmIChkYy0+aHdzcy5pbml0X3BpcGVzKQotCQlkYy0+aHdzcy5pbml0X3Bp
cGVzKGRjLCBjb250ZXh0KTsKKwlpZiAoaHdzLT5mdW5jcy5pbml0X3BpcGVzKQorCQlod3MtPmZ1
bmNzLmluaXRfcGlwZXMoZGMsIGNvbnRleHQpOwogCiAJZWRwX3N0cmVhbSA9IGdldF9lZHBfc3Ry
ZWFtKGNvbnRleHQpOwogCkBAIC0xNTkyLDcgKzE1OTUsNyBAQCB2b2lkIGRjZTExMF9lbmFibGVf
YWNjZWxlcmF0ZWRfbW9kZShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQp
CiAJaWYgKCFjYW5fYXBwbHlfZWRwX2Zhc3RfYm9vdCAmJiAhY2FuX2FwcGx5X3NlYW1sZXNzX2Jv
b3QpIHsKIAkJaWYgKGVkcF9saW5rX3dpdGhfc2luayAmJiAha2VlcF9lZHBfdmRkX29uKSB7CiAJ
CQkvKnR1cm4gb2ZmIGJhY2tsaWdodCBiZWZvcmUgRFBfYmxhbmsgYW5kIGVuY29kZXIgcG93ZXJl
ZCBkb3duKi8KLQkJCWRjLT5od3NzLmVkcF9iYWNrbGlnaHRfY29udHJvbChlZHBfbGlua193aXRo
X3NpbmssIGZhbHNlKTsKKwkJCWh3cy0+ZnVuY3MuZWRwX2JhY2tsaWdodF9jb250cm9sKGVkcF9s
aW5rX3dpdGhfc2luaywgZmFsc2UpOwogCQl9CiAJCS8qcmVzdW1lIGZyb20gUzMsIG5vIHZiaW9z
IHBvc3RpbmcsIG5vIG5lZWQgdG8gcG93ZXIgZG93biBhZ2FpbiovCiAJCXBvd2VyX2Rvd25fYWxs
X2h3X2Jsb2NrcyhkYyk7CkBAIC0yMDA3LDEzICsyMDEwLDE0IEBAIGVudW0gZGNfc3RhdHVzIGRj
ZTExMF9hcHBseV9jdHhfdG9faHcoCiAJCXN0cnVjdCBkYyAqZGMsCiAJCXN0cnVjdCBkY19zdGF0
ZSAqY29udGV4dCkKIHsKKwlzdHJ1Y3QgZGNlX2h3c2VxICpod3MgPSBkYy0+aHdzZXE7CiAJc3Ry
dWN0IGRjX2Jpb3MgKmRjYiA9IGRjLT5jdHgtPmRjX2Jpb3M7CiAJZW51bSBkY19zdGF0dXMgc3Rh
dHVzOwogCWludCBpOwogCiAJLyogUmVzZXQgb2xkIGNvbnRleHQgKi8KIAkvKiBsb29rIHVwIHRo
ZSB0YXJnZXRzIHRoYXQgaGF2ZSBiZWVuIHJlbW92ZWQgc2luY2UgbGFzdCBjb21taXQgKi8KLQlk
Yy0+aHdzcy5yZXNldF9od19jdHhfd3JhcChkYywgY29udGV4dCk7CisJaHdzLT5mdW5jcy5yZXNl
dF9od19jdHhfd3JhcChkYywgY29udGV4dCk7CiAKIAkvKiBTa2lwIGFwcGx5aW5nIGlmIG5vIHRh
cmdldHMgKi8KIAlpZiAoY29udGV4dC0+c3RyZWFtX2NvdW50IDw9IDApCkBAIC0yMDM4LDcgKzIw
NDIsNyBAQCBlbnVtIGRjX3N0YXR1cyBkY2UxMTBfYXBwbHlfY3R4X3RvX2h3KAogCQkJY29udGlu
dWU7CiAJCX0KIAotCQlkYy0+aHdzcy5lbmFibGVfZGlzcGxheV9wb3dlcl9nYXRpbmcoCisJCWh3
cy0+ZnVuY3MuZW5hYmxlX2Rpc3BsYXlfcG93ZXJfZ2F0aW5nKAogCQkJCWRjLCBpLCBkYy0+Y3R4
LT5kY19iaW9zLAogCQkJCVBJUEVfR0FUSU5HX0NPTlRST0xfRElTQUJMRSk7CiAJfQpAQCAtMjM0
NywxOSArMjM1MSwyMCBAQCBzdGF0aWMgdm9pZCBpbml0X2h3KHN0cnVjdCBkYyAqZGMpCiAJc3Ry
dWN0IHRyYW5zZm9ybSAqeGZtOwogCXN0cnVjdCBhYm0gKmFibTsKIAlzdHJ1Y3QgZG1jdSAqZG1j
dTsKKwlzdHJ1Y3QgZGNlX2h3c2VxICpod3MgPSBkYy0+aHdzZXE7CiAKIAlicCA9IGRjLT5jdHgt
PmRjX2Jpb3M7CiAJZm9yIChpID0gMDsgaSA8IGRjLT5yZXNfcG9vbC0+cGlwZV9jb3VudDsgaSsr
KSB7CiAJCXhmbSA9IGRjLT5yZXNfcG9vbC0+dHJhbnNmb3Jtc1tpXTsKIAkJeGZtLT5mdW5jcy0+
dHJhbnNmb3JtX3Jlc2V0KHhmbSk7CiAKLQkJZGMtPmh3c3MuZW5hYmxlX2Rpc3BsYXlfcG93ZXJf
Z2F0aW5nKAorCQlod3MtPmZ1bmNzLmVuYWJsZV9kaXNwbGF5X3Bvd2VyX2dhdGluZygKIAkJCQlk
YywgaSwgYnAsCiAJCQkJUElQRV9HQVRJTkdfQ09OVFJPTF9JTklUKTsKLQkJZGMtPmh3c3MuZW5h
YmxlX2Rpc3BsYXlfcG93ZXJfZ2F0aW5nKAorCQlod3MtPmZ1bmNzLmVuYWJsZV9kaXNwbGF5X3Bv
d2VyX2dhdGluZygKIAkJCQlkYywgaSwgYnAsCiAJCQkJUElQRV9HQVRJTkdfQ09OVFJPTF9ESVNB
QkxFKTsKLQkJZGMtPmh3c3MuZW5hYmxlX2Rpc3BsYXlfcGlwZV9jbG9ja19nYXRpbmcoCisJCWh3
cy0+ZnVuY3MuZW5hYmxlX2Rpc3BsYXlfcGlwZV9jbG9ja19nYXRpbmcoCiAJCQlkYy0+Y3R4LAog
CQkJdHJ1ZSk7CiAJfQpAQCAtMjQ0NSw2ICsyNDUwLDggQEAgc3RhdGljIHZvaWQgZGNlMTEwX3By
b2dyYW1fZnJvbnRfZW5kX2Zvcl9waXBlKAogCXN0cnVjdCB4Zm1fZ3JwaF9jc2NfYWRqdXN0bWVu
dCBhZGp1c3Q7CiAJc3RydWN0IG91dF9jc2NfY29sb3JfbWF0cml4IHRibF9lbnRyeTsKIAl1bnNp
Z25lZCBpbnQgaTsKKwlzdHJ1Y3QgZGNlX2h3c2VxICpod3MgPSBkYy0+aHdzZXE7CisKIAlEQ19M
T0dHRVJfSU5JVCgpOwogCW1lbXNldCgmdGJsX2VudHJ5LCAwLCBzaXplb2YodGJsX2VudHJ5KSk7
CiAKQEAgLTI1MDMsMTAgKzI1MTAsMTAgQEAgc3RhdGljIHZvaWQgZGNlMTEwX3Byb2dyYW1fZnJv
bnRfZW5kX2Zvcl9waXBlKAogCWlmIChwaXBlX2N0eC0+cGxhbmVfc3RhdGUtPnVwZGF0ZV9mbGFn
cy5iaXRzLmZ1bGxfdXBkYXRlIHx8CiAJCQlwaXBlX2N0eC0+cGxhbmVfc3RhdGUtPnVwZGF0ZV9m
bGFncy5iaXRzLmluX3RyYW5zZmVyX2Z1bmNfY2hhbmdlIHx8CiAJCQlwaXBlX2N0eC0+cGxhbmVf
c3RhdGUtPnVwZGF0ZV9mbGFncy5iaXRzLmdhbW1hX2NoYW5nZSkKLQkJZGMtPmh3c3Muc2V0X2lu
cHV0X3RyYW5zZmVyX2Z1bmMoZGMsIHBpcGVfY3R4LCBwaXBlX2N0eC0+cGxhbmVfc3RhdGUpOwor
CQlod3MtPmZ1bmNzLnNldF9pbnB1dF90cmFuc2Zlcl9mdW5jKGRjLCBwaXBlX2N0eCwgcGlwZV9j
dHgtPnBsYW5lX3N0YXRlKTsKIAogCWlmIChwaXBlX2N0eC0+cGxhbmVfc3RhdGUtPnVwZGF0ZV9m
bGFncy5iaXRzLmZ1bGxfdXBkYXRlKQotCQlkYy0+aHdzcy5zZXRfb3V0cHV0X3RyYW5zZmVyX2Z1
bmMoZGMsIHBpcGVfY3R4LCBwaXBlX2N0eC0+c3RyZWFtKTsKKwkJaHdzLT5mdW5jcy5zZXRfb3V0
cHV0X3RyYW5zZmVyX2Z1bmMoZGMsIHBpcGVfY3R4LCBwaXBlX2N0eC0+c3RyZWFtKTsKIAogCURD
X0xPR19TVVJGQUNFKAogCQkJIlBpcGU6JWQgJXA6IGFkZHIgaGk6MHgleCwgIgpAQCAtMjYwOSw2
ICsyNjE2LDcgQEAgc3RhdGljIHZvaWQgZGNlMTEwX2FwcGx5X2N0eF9mb3Jfc3VyZmFjZSgKIAog
c3RhdGljIHZvaWQgZGNlMTEwX3Bvd2VyX2Rvd25fZmUoc3RydWN0IGRjICpkYywgc3RydWN0IHBp
cGVfY3R4ICpwaXBlX2N0eCkKIHsKKwlzdHJ1Y3QgZGNlX2h3c2VxICpod3MgPSBkYy0+aHdzZXE7
CiAJaW50IGZlX2lkeCA9IHBpcGVfY3R4LT5wbGFuZV9yZXMubWkgPwogCQlwaXBlX2N0eC0+cGxh
bmVfcmVzLm1pLT5pbnN0IDogcGlwZV9jdHgtPnBpcGVfaWR4OwogCkBAIC0yNjE2LDcgKzI2MjQs
NyBAQCBzdGF0aWMgdm9pZCBkY2UxMTBfcG93ZXJfZG93bl9mZShzdHJ1Y3QgZGMgKmRjLCBzdHJ1
Y3QgcGlwZV9jdHggKnBpcGVfY3R4KQogCWlmIChkYy0+Y3VycmVudF9zdGF0ZS0+cmVzX2N0eC5w
aXBlX2N0eFtmZV9pZHhdLnN0cmVhbSkKIAkJcmV0dXJuOwogCi0JZGMtPmh3c3MuZW5hYmxlX2Rp
c3BsYXlfcG93ZXJfZ2F0aW5nKAorCWh3cy0+ZnVuY3MuZW5hYmxlX2Rpc3BsYXlfcG93ZXJfZ2F0
aW5nKAogCQlkYywgZmVfaWR4LCBkYy0+Y3R4LT5kY19iaW9zLCBQSVBFX0dBVElOR19DT05UUk9M
X0VOQUJMRSk7CiAKIAlkYy0+cmVzX3Bvb2wtPnRyYW5zZm9ybXNbZmVfaWR4XS0+ZnVuY3MtPnRy
YW5zZm9ybV9yZXNldCgKQEAgLTI3MDUsMTQgKzI3MTMsMTAgQEAgc3RhdGljIGNvbnN0IHN0cnVj
dCBod19zZXF1ZW5jZXJfZnVuY3MgZGNlMTEwX2Z1bmNzID0gewogCS5wcm9ncmFtX2dhbXV0X3Jl
bWFwID0gcHJvZ3JhbV9nYW11dF9yZW1hcCwKIAkucHJvZ3JhbV9vdXRwdXRfY3NjID0gcHJvZ3Jh
bV9vdXRwdXRfY3NjLAogCS5pbml0X2h3ID0gaW5pdF9odywKLQkuaW5pdF9waXBlcyA9IGluaXRf
cGlwZXMsCiAJLmFwcGx5X2N0eF90b19odyA9IGRjZTExMF9hcHBseV9jdHhfdG9faHcsCiAJLmFw
cGx5X2N0eF9mb3Jfc3VyZmFjZSA9IGRjZTExMF9hcHBseV9jdHhfZm9yX3N1cmZhY2UsCiAJLnVw
ZGF0ZV9wbGFuZV9hZGRyID0gdXBkYXRlX3BsYW5lX2FkZHIsCiAJLnVwZGF0ZV9wZW5kaW5nX3N0
YXR1cyA9IGRjZTExMF91cGRhdGVfcGVuZGluZ19zdGF0dXMsCi0JLnNldF9pbnB1dF90cmFuc2Zl
cl9mdW5jID0gZGNlMTEwX3NldF9pbnB1dF90cmFuc2Zlcl9mdW5jLAotCS5zZXRfb3V0cHV0X3Ry
YW5zZmVyX2Z1bmMgPSBkY2UxMTBfc2V0X291dHB1dF90cmFuc2Zlcl9mdW5jLAotCS5wb3dlcl9k
b3duID0gZGNlMTEwX3Bvd2VyX2Rvd24sCiAJLmVuYWJsZV9hY2NlbGVyYXRlZF9tb2RlID0gZGNl
MTEwX2VuYWJsZV9hY2NlbGVyYXRlZF9tb2RlLAogCS5lbmFibGVfdGltaW5nX3N5bmNocm9uaXph
dGlvbiA9IGRjZTExMF9lbmFibGVfdGltaW5nX3N5bmNocm9uaXphdGlvbiwKIAkuZW5hYmxlX3Bl
cl9mcmFtZV9jcnRjX3Bvc2l0aW9uX3Jlc2V0ID0gZGNlMTEwX2VuYWJsZV9wZXJfZnJhbWVfY3J0
Y19wb3NpdGlvbl9yZXNldCwKQEAgLTI3MjMsOCArMjcyNyw2IEBAIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgaHdfc2VxdWVuY2VyX2Z1bmNzIGRjZTExMF9mdW5jcyA9IHsKIAkuYmxhbmtfc3RyZWFtID0g
ZGNlMTEwX2JsYW5rX3N0cmVhbSwKIAkuZW5hYmxlX2F1ZGlvX3N0cmVhbSA9IGRjZTExMF9lbmFi
bGVfYXVkaW9fc3RyZWFtLAogCS5kaXNhYmxlX2F1ZGlvX3N0cmVhbSA9IGRjZTExMF9kaXNhYmxl
X2F1ZGlvX3N0cmVhbSwKLQkuZW5hYmxlX2Rpc3BsYXlfcGlwZV9jbG9ja19nYXRpbmcgPSBlbmFi
bGVfZGlzcGxheV9waXBlX2Nsb2NrX2dhdGluZywKLQkuZW5hYmxlX2Rpc3BsYXlfcG93ZXJfZ2F0
aW5nID0gZGNlMTEwX2VuYWJsZV9kaXNwbGF5X3Bvd2VyX2dhdGluZywKIAkuZGlzYWJsZV9wbGFu
ZSA9IGRjZTExMF9wb3dlcl9kb3duX2ZlLAogCS5waXBlX2NvbnRyb2xfbG9jayA9IGRjZV9waXBl
X2NvbnRyb2xfbG9jaywKIAkucHJlcGFyZV9iYW5kd2lkdGggPSBkY2UxMTBfcHJlcGFyZV9iYW5k
d2lkdGgsCkBAIC0yNzMyLDIyICsyNzM0LDMzIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaHdfc2Vx
dWVuY2VyX2Z1bmNzIGRjZTExMF9mdW5jcyA9IHsKIAkuc2V0X2RyciA9IHNldF9kcnIsCiAJLmdl
dF9wb3NpdGlvbiA9IGdldF9wb3NpdGlvbiwKIAkuc2V0X3N0YXRpY19zY3JlZW5fY29udHJvbCA9
IHNldF9zdGF0aWNfc2NyZWVuX2NvbnRyb2wsCi0JLnJlc2V0X2h3X2N0eF93cmFwID0gZGNlMTEw
X3Jlc2V0X2h3X2N0eF93cmFwLAotCS5lbmFibGVfc3RyZWFtX3RpbWluZyA9IGRjZTExMF9lbmFi
bGVfc3RyZWFtX3RpbWluZywKLQkuZGlzYWJsZV9zdHJlYW1fZ2F0aW5nID0gTlVMTCwKLQkuZW5h
YmxlX3N0cmVhbV9nYXRpbmcgPSBOVUxMLAogCS5zZXR1cF9zdGVyZW8gPSBOVUxMLAogCS5zZXRf
YXZtdXRlID0gZGNlMTEwX3NldF9hdm11dGUsCiAJLndhaXRfZm9yX21wY2NfZGlzY29ubmVjdCA9
IGRjZTExMF93YWl0X2Zvcl9tcGNjX2Rpc2Nvbm5lY3QsCi0JLmVkcF9iYWNrbGlnaHRfY29udHJv
bCA9IGRjZTExMF9lZHBfYmFja2xpZ2h0X2NvbnRyb2wsCiAJLmVkcF9wb3dlcl9jb250cm9sID0g
ZGNlMTEwX2VkcF9wb3dlcl9jb250cm9sLAogCS5lZHBfd2FpdF9mb3JfaHBkX3JlYWR5ID0gZGNl
MTEwX2VkcF93YWl0X2Zvcl9ocGRfcmVhZHksCiAJLnNldF9jdXJzb3JfcG9zaXRpb24gPSBkY2Ux
MTBfc2V0X2N1cnNvcl9wb3NpdGlvbiwKIAkuc2V0X2N1cnNvcl9hdHRyaWJ1dGUgPSBkY2UxMTBf
c2V0X2N1cnNvcl9hdHRyaWJ1dGUKIH07CiAKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaHdzZXFfcHJp
dmF0ZV9mdW5jcyBkY2UxMTBfcHJpdmF0ZV9mdW5jcyA9IHsKKwkuaW5pdF9waXBlcyA9IGluaXRf
cGlwZXMsCisJLnVwZGF0ZV9wbGFuZV9hZGRyID0gdXBkYXRlX3BsYW5lX2FkZHIsCisJLnNldF9p
bnB1dF90cmFuc2Zlcl9mdW5jID0gZGNlMTEwX3NldF9pbnB1dF90cmFuc2Zlcl9mdW5jLAorCS5z
ZXRfb3V0cHV0X3RyYW5zZmVyX2Z1bmMgPSBkY2UxMTBfc2V0X291dHB1dF90cmFuc2Zlcl9mdW5j
LAorCS5wb3dlcl9kb3duID0gZGNlMTEwX3Bvd2VyX2Rvd24sCisJLmVuYWJsZV9kaXNwbGF5X3Bp
cGVfY2xvY2tfZ2F0aW5nID0gZW5hYmxlX2Rpc3BsYXlfcGlwZV9jbG9ja19nYXRpbmcsCisJLmVu
YWJsZV9kaXNwbGF5X3Bvd2VyX2dhdGluZyA9IGRjZTExMF9lbmFibGVfZGlzcGxheV9wb3dlcl9n
YXRpbmcsCisJLnJlc2V0X2h3X2N0eF93cmFwID0gZGNlMTEwX3Jlc2V0X2h3X2N0eF93cmFwLAor
CS5lbmFibGVfc3RyZWFtX3RpbWluZyA9IGRjZTExMF9lbmFibGVfc3RyZWFtX3RpbWluZywKKwku
ZGlzYWJsZV9zdHJlYW1fZ2F0aW5nID0gTlVMTCwKKwkuZW5hYmxlX3N0cmVhbV9nYXRpbmcgPSBO
VUxMLAorCS5lZHBfYmFja2xpZ2h0X2NvbnRyb2wgPSBkY2UxMTBfZWRwX2JhY2tsaWdodF9jb250
cm9sLAorfTsKKwogdm9pZCBkY2UxMTBfaHdfc2VxdWVuY2VyX2NvbnN0cnVjdChzdHJ1Y3QgZGMg
KmRjKQogewogCWRjLT5od3NzID0gZGNlMTEwX2Z1bmNzOworCWRjLT5od3NlcS0+ZnVuY3MgPSBk
Y2UxMTBfcHJpdmF0ZV9mdW5jczsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9kaXNwbGF5L2RjL2RjZTExMC9kY2UxMTBfaHdfc2VxdWVuY2VyLmggYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNlMTEwL2RjZTExMF9od19zZXF1ZW5jZXIuaAppbmRleCBjNjM5
ZTE2ODBiN2IuLjI2YTljMTRhNThiMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2RjZTExMC9kY2UxMTBfaHdfc2VxdWVuY2VyLmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2RjZTExMC9kY2UxMTBfaHdfc2VxdWVuY2VyLmgKQEAgLTI3LDYg
KzI3LDcgQEAKICNkZWZpbmUgX19EQ19IV1NTX0RDRTExMF9IX18KIAogI2luY2x1ZGUgImNvcmVf
dHlwZXMuaCIKKyNpbmNsdWRlICJod19zZXF1ZW5jZXJfcHJpdmF0ZS5oIgogCiBzdHJ1Y3QgZGM7
CiBzdHJ1Y3QgZGNfc3RhdGU7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvZGNlMTEwL2RjZTExMF9yZXNvdXJjZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNw
bGF5L2RjL2RjZTExMC9kY2UxMTBfcmVzb3VyY2UuYwppbmRleCBhNTM1ZTJjZGE2OTQuLmJmMTRl
OWFiMDQwYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjZTEx
MC9kY2UxMTBfcmVzb3VyY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMv
ZGNlMTEwL2RjZTExMF9yZXNvdXJjZS5jCkBAIC0xMDk3LDYgKzEwOTcsNyBAQCBzdGF0aWMgc3Ry
dWN0IHBpcGVfY3R4ICpkY2UxMTBfYWNxdWlyZV91bmRlcmxheSgKIAkJc3RydWN0IGRjX3N0cmVh
bV9zdGF0ZSAqc3RyZWFtKQogewogCXN0cnVjdCBkYyAqZGMgPSBzdHJlYW0tPmN0eC0+ZGM7CisJ
c3RydWN0IGRjZV9od3NlcSAqaHdzID0gZGMtPmh3c2VxOwogCXN0cnVjdCByZXNvdXJjZV9jb250
ZXh0ICpyZXNfY3R4ID0gJmNvbnRleHQtPnJlc19jdHg7CiAJdW5zaWduZWQgaW50IHVuZGVybGF5
X2lkeCA9IHBvb2wtPnVuZGVybGF5X3BpcGVfaW5kZXg7CiAJc3RydWN0IHBpcGVfY3R4ICpwaXBl
X2N0eCA9ICZyZXNfY3R4LT5waXBlX2N0eFt1bmRlcmxheV9pZHhdOwpAQCAtMTExNyw3ICsxMTE4
LDcgQEAgc3RhdGljIHN0cnVjdCBwaXBlX2N0eCAqZGNlMTEwX2FjcXVpcmVfdW5kZXJsYXkoCiAJ
CXN0cnVjdCB0Z19jb2xvciBibGFja19jb2xvciA9IHswfTsKIAkJc3RydWN0IGRjX2Jpb3MgKmRj
YiA9IGRjLT5jdHgtPmRjX2Jpb3M7CiAKLQkJZGMtPmh3c3MuZW5hYmxlX2Rpc3BsYXlfcG93ZXJf
Z2F0aW5nKAorCQlod3MtPmZ1bmNzLmVuYWJsZV9kaXNwbGF5X3Bvd2VyX2dhdGluZygKIAkJCQlk
YywKIAkJCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+aW5zdCwKIAkJCQlkY2IsIFBJUEVfR0FU
SU5HX0NPTlRST0xfRElTQUJMRSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvZGNlMTEyL2RjZTExMl9od19zZXF1ZW5jZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9kY2UxMTIvZGNlMTEyX2h3X3NlcXVlbmNlci5jCmluZGV4IDFlNGE3YzEz
ZjBlZC4uMTk4NzNlZTFmNzhkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvZGNlMTEyL2RjZTExMl9od19zZXF1ZW5jZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZGNlMTEyL2RjZTExMl9od19zZXF1ZW5jZXIuYwpAQCAtMTU4LDYgKzE1
OCw2IEBAIHZvaWQgZGNlMTEyX2h3X3NlcXVlbmNlcl9jb25zdHJ1Y3Qoc3RydWN0IGRjICpkYykK
IAkgKiBzdHJ1Y3R1cmUKIAkgKi8KIAlkY2UxMTBfaHdfc2VxdWVuY2VyX2NvbnN0cnVjdChkYyk7
Ci0JZGMtPmh3c3MuZW5hYmxlX2Rpc3BsYXlfcG93ZXJfZ2F0aW5nID0gZGNlMTEyX2VuYWJsZV9k
aXNwbGF5X3Bvd2VyX2dhdGluZzsKKwlkYy0+aHdzZXEtPmZ1bmNzLmVuYWJsZV9kaXNwbGF5X3Bv
d2VyX2dhdGluZyA9IGRjZTExMl9lbmFibGVfZGlzcGxheV9wb3dlcl9nYXRpbmc7CiB9CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY2UxMTIvZGNlMTEyX2h3
X3NlcXVlbmNlci5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjZTExMi9kY2Ux
MTJfaHdfc2VxdWVuY2VyLmgKaW5kZXggZTY0NmY0YTM3ZmEyLi45NDNmMWIyYzViMmYgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY2UxMTIvZGNlMTEyX2h3X3Nl
cXVlbmNlci5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY2UxMTIvZGNl
MTEyX2h3X3NlcXVlbmNlci5oCkBAIC0yNyw2ICsyNyw3IEBACiAjZGVmaW5lIF9fRENfSFdTU19E
Q0UxMTJfSF9fCiAKICNpbmNsdWRlICJjb3JlX3R5cGVzLmgiCisjaW5jbHVkZSAiaHdfc2VxdWVu
Y2VyX3ByaXZhdGUuaCIKIAogc3RydWN0IGRjOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNlMTIwL2RjZTEyMF9od19zZXF1ZW5jZXIuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY2UxMjAvZGNlMTIwX2h3X3NlcXVlbmNlci5jCmluZGV4
IDFjYTMwOTI4MDI1ZS4uNjZhMTNhYTM5Yzk1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZGNlMTIwL2RjZTEyMF9od19zZXF1ZW5jZXIuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNlMTIwL2RjZTEyMF9od19zZXF1ZW5jZXIuYwpAQCAt
MjY1LDcgKzI2NSw3IEBAIHZvaWQgZGNlMTIwX2h3X3NlcXVlbmNlcl9jb25zdHJ1Y3Qoc3RydWN0
IGRjICpkYykKIAkgKiBzdHJ1Y3R1cmUKIAkgKi8KIAlkY2UxMTBfaHdfc2VxdWVuY2VyX2NvbnN0
cnVjdChkYyk7Ci0JZGMtPmh3c3MuZW5hYmxlX2Rpc3BsYXlfcG93ZXJfZ2F0aW5nID0gZGNlMTIw
X2VuYWJsZV9kaXNwbGF5X3Bvd2VyX2dhdGluZzsKKwlkYy0+aHdzZXEtPmZ1bmNzLmVuYWJsZV9k
aXNwbGF5X3Bvd2VyX2dhdGluZyA9IGRjZTEyMF9lbmFibGVfZGlzcGxheV9wb3dlcl9nYXRpbmc7
CiAJZGMtPmh3c3MudXBkYXRlX2RjaHViID0gZGNlMTIwX3VwZGF0ZV9kY2h1YjsKIH0KIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjZTEyMC9kY2UxMjBfaHdf
c2VxdWVuY2VyLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNlMTIwL2RjZTEy
MF9od19zZXF1ZW5jZXIuaAppbmRleCBjNTFhZmJkMGIwMTIuLmJjMDI0NTM0NzMyZiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjZTEyMC9kY2UxMjBfaHdfc2Vx
dWVuY2VyLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjZTEyMC9kY2Ux
MjBfaHdfc2VxdWVuY2VyLmgKQEAgLTI3LDYgKzI3LDcgQEAKICNkZWZpbmUgX19EQ19IV1NTX0RD
RTEyMF9IX18KIAogI2luY2x1ZGUgImNvcmVfdHlwZXMuaCIKKyNpbmNsdWRlICJod19zZXF1ZW5j
ZXJfcHJpdmF0ZS5oIgogCiBzdHJ1Y3QgZGM7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvZGlzcGxheS9kYy9kY2U4MC9kY2U4MF9od19zZXF1ZW5jZXIuYyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvZGlzcGxheS9kYy9kY2U4MC9kY2U4MF9od19zZXF1ZW5jZXIuYwppbmRleCBjNDU0
MzE3OGJhMjAuLjg5MzI2MWM4MTg1NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2RjZTgwL2RjZTgwX2h3X3NlcXVlbmNlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvZGlzcGxheS9kYy9kY2U4MC9kY2U4MF9od19zZXF1ZW5jZXIuYwpAQCAtNzQsNyArNzQs
NyBAQCB2b2lkIGRjZTgwX2h3X3NlcXVlbmNlcl9jb25zdHJ1Y3Qoc3RydWN0IGRjICpkYykKIHsK
IAlkY2UxMTBfaHdfc2VxdWVuY2VyX2NvbnN0cnVjdChkYyk7CiAKLQlkYy0+aHdzcy5lbmFibGVf
ZGlzcGxheV9wb3dlcl9nYXRpbmcgPSBkY2UxMDBfZW5hYmxlX2Rpc3BsYXlfcG93ZXJfZ2F0aW5n
OworCWRjLT5od3NlcS0+ZnVuY3MuZW5hYmxlX2Rpc3BsYXlfcG93ZXJfZ2F0aW5nID0gZGNlMTAw
X2VuYWJsZV9kaXNwbGF5X3Bvd2VyX2dhdGluZzsKIAlkYy0+aHdzcy5waXBlX2NvbnRyb2xfbG9j
ayA9IGRjZV9waXBlX2NvbnRyb2xfbG9jazsKIAlkYy0+aHdzcy5wcmVwYXJlX2JhbmR3aWR0aCA9
IGRjZTEwMF9wcmVwYXJlX2JhbmR3aWR0aDsKIAlkYy0+aHdzcy5vcHRpbWl6ZV9iYW5kd2lkdGgg
PSBkY2UxMDBfb3B0aW1pemVfYmFuZHdpZHRoOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2RjZTgwL2RjZTgwX2h3X3NlcXVlbmNlci5oIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2RjZTgwL2RjZTgwX2h3X3NlcXVlbmNlci5oCmluZGV4IDdhMWIz
MWRlZjY2Zi4uZTQzYWY4MzJkMDBjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvZGNlODAvZGNlODBfaHdfc2VxdWVuY2VyLmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2RjZTgwL2RjZTgwX2h3X3NlcXVlbmNlci5oCkBAIC0yNyw2ICsyNyw3
IEBACiAjZGVmaW5lIF9fRENfSFdTU19EQ0U4MF9IX18KIAogI2luY2x1ZGUgImNvcmVfdHlwZXMu
aCIKKyNpbmNsdWRlICJod19zZXF1ZW5jZXJfcHJpdmF0ZS5oIgogCiBzdHJ1Y3QgZGM7CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9od19z
ZXF1ZW5jZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9o
d19zZXF1ZW5jZXIuYwppbmRleCBiZDZjZGI2YjM4ZjYuLjJiMzA4MWVlMGUwNyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX2h3X3NlcXVlbmNl
ci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9od19z
ZXF1ZW5jZXIuYwpAQCAtNjQyLDggKzY0Miw4IEBAIHN0YXRpYyB2b2lkIHBvd2VyX29uX3BsYW5l
KAogCWlmIChSRUcoRENfSVBfUkVRVUVTVF9DTlRMKSkgewogCQlSRUdfU0VUKERDX0lQX1JFUVVF
U1RfQ05UTCwgMCwKIAkJCQlJUF9SRVFVRVNUX0VOLCAxKTsKLQkJaHdzLT5jdHgtPmRjLT5od3Nz
LmRwcF9wZ19jb250cm9sKGh3cywgcGxhbmVfaWQsIHRydWUpOwotCQlod3MtPmN0eC0+ZGMtPmh3
c3MuaHVicF9wZ19jb250cm9sKGh3cywgcGxhbmVfaWQsIHRydWUpOworCQlod3MtPmZ1bmNzLmRw
cF9wZ19jb250cm9sKGh3cywgcGxhbmVfaWQsIHRydWUpOworCQlod3MtPmZ1bmNzLmh1YnBfcGdf
Y29udHJvbChod3MsIHBsYW5lX2lkLCB0cnVlKTsKIAkJUkVHX1NFVChEQ19JUF9SRVFVRVNUX0NO
VEwsIDAsCiAJCQkJSVBfUkVRVUVTVF9FTiwgMCk7CiAJCURDX0xPR19ERUJVRygKQEAgLTY2NCw3
ICs2NjQsNyBAQCBzdGF0aWMgdm9pZCB1bmRvX0RFR1ZJRENOMTBfMjUzX3dhKHN0cnVjdCBkYyAq
ZGMpCiAJUkVHX1NFVChEQ19JUF9SRVFVRVNUX0NOVEwsIDAsCiAJCQlJUF9SRVFVRVNUX0VOLCAx
KTsKIAotCWRjLT5od3NzLmh1YnBfcGdfY29udHJvbChod3MsIDAsIGZhbHNlKTsKKwlod3MtPmZ1
bmNzLmh1YnBfcGdfY29udHJvbChod3MsIDAsIGZhbHNlKTsKIAlSRUdfU0VUKERDX0lQX1JFUVVF
U1RfQ05UTCwgMCwKIAkJCUlQX1JFUVVFU1RfRU4sIDApOwogCkBAIC02OTMsNyArNjkzLDcgQEAg
c3RhdGljIHZvaWQgYXBwbHlfREVHVklEQ04xMF8yNTNfd2Eoc3RydWN0IGRjICpkYykKIAlSRUdf
U0VUKERDX0lQX1JFUVVFU1RfQ05UTCwgMCwKIAkJCUlQX1JFUVVFU1RfRU4sIDEpOwogCi0JZGMt
Pmh3c3MuaHVicF9wZ19jb250cm9sKGh3cywgMCwgdHJ1ZSk7CisJaHdzLT5mdW5jcy5odWJwX3Bn
X2NvbnRyb2woaHdzLCAwLCB0cnVlKTsKIAlSRUdfU0VUKERDX0lQX1JFUVVFU1RfQ05UTCwgMCwK
IAkJCUlQX1JFUVVFU1RfRU4sIDApOwogCkBAIC03MDMsMTIgKzcwMywxNCBAQCBzdGF0aWMgdm9p
ZCBhcHBseV9ERUdWSURDTjEwXzI1M193YShzdHJ1Y3QgZGMgKmRjKQogCiB2b2lkIGRjbjEwX2Jp
b3NfZ29sZGVuX2luaXQoc3RydWN0IGRjICpkYykKIHsKKwlzdHJ1Y3QgZGNlX2h3c2VxICpod3Mg
PSBkYy0+aHdzZXE7CiAJc3RydWN0IGRjX2Jpb3MgKmJwID0gZGMtPmN0eC0+ZGNfYmlvczsKIAlp
bnQgaTsKIAlib29sIGFsbG93X3NlbGZfZnJlc2hfZm9yY2VfZW5hYmxlID0gdHJ1ZTsKIAotCWlm
IChkYy0+aHdzcy5zMGkzX2dvbGRlbl9pbml0X3dhICYmIGRjLT5od3NzLnMwaTNfZ29sZGVuX2lu
aXRfd2EoZGMpKQorCWlmIChod3MtPmZ1bmNzLnMwaTNfZ29sZGVuX2luaXRfd2EgJiYgaHdzLT5m
dW5jcy5zMGkzX2dvbGRlbl9pbml0X3dhKGRjKSkKIAkJcmV0dXJuOworCiAJaWYgKGRjLT5yZXNf
cG9vbC0+aHViYnViLT5mdW5jcy0+aXNfYWxsb3dfc2VsZl9yZWZyZXNoX2VuYWJsZWQpCiAJCWFs
bG93X3NlbGZfZnJlc2hfZm9yY2VfZW5hYmxlID0KIAkJCQlkYy0+cmVzX3Bvb2wtPmh1YmJ1Yi0+
ZnVuY3MtPmlzX2FsbG93X3NlbGZfcmVmcmVzaF9lbmFibGVkKGRjLT5yZXNfcG9vbC0+aHViYnVi
KTsKQEAgLTEwMTUsNiArMTAxNyw3IEBAIHZvaWQgZGNuMTBfdmVyaWZ5X2FsbG93X3BzdGF0ZV9j
aGFuZ2VfaGlnaChzdHJ1Y3QgZGMgKmRjKQogLyogdHJpZ2dlciBIVyB0byBzdGFydCBkaXNjb25u
ZWN0IHBsYW5lIGZyb20gc3RyZWFtIG9uIHRoZSBuZXh0IHZzeW5jICovCiB2b2lkIGRjbjEwX3Bs
YW5lX2F0b21pY19kaXNjb25uZWN0KHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBwaXBlX2N0eCAqcGlw
ZV9jdHgpCiB7CisJc3RydWN0IGRjZV9od3NlcSAqaHdzID0gZGMtPmh3c2VxOwogCXN0cnVjdCBo
dWJwICpodWJwID0gcGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwOwogCWludCBkcHBfaWQgPSBwaXBl
X2N0eC0+cGxhbmVfcmVzLmRwcC0+aW5zdDsKIAlzdHJ1Y3QgbXBjICptcGMgPSBkYy0+cmVzX3Bv
b2wtPm1wYzsKQEAgLTEwMzksNyArMTA0Miw3IEBAIHZvaWQgZGNuMTBfcGxhbmVfYXRvbWljX2Rp
c2Nvbm5lY3Qoc3RydWN0IGRjICpkYywgc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCkKIAkJaHVi
cC0+ZnVuY3MtPmh1YnBfZGlzY29ubmVjdChodWJwKTsKIAogCWlmIChkYy0+ZGVidWcuc2FuaXR5
X2NoZWNrcykKLQkJZGMtPmh3c3MudmVyaWZ5X2FsbG93X3BzdGF0ZV9jaGFuZ2VfaGlnaChkYyk7
CisJCWh3cy0+ZnVuY3MudmVyaWZ5X2FsbG93X3BzdGF0ZV9jaGFuZ2VfaGlnaChkYyk7CiB9CiAK
IHZvaWQgZGNuMTBfcGxhbmVfYXRvbWljX3Bvd2VyX2Rvd24oc3RydWN0IGRjICpkYywKQEAgLTEw
NTIsOCArMTA1NSw4IEBAIHZvaWQgZGNuMTBfcGxhbmVfYXRvbWljX3Bvd2VyX2Rvd24oc3RydWN0
IGRjICpkYywKIAlpZiAoUkVHKERDX0lQX1JFUVVFU1RfQ05UTCkpIHsKIAkJUkVHX1NFVChEQ19J
UF9SRVFVRVNUX0NOVEwsIDAsCiAJCQkJSVBfUkVRVUVTVF9FTiwgMSk7Ci0JCWRjLT5od3NzLmRw
cF9wZ19jb250cm9sKGh3cywgZHBwLT5pbnN0LCBmYWxzZSk7Ci0JCWRjLT5od3NzLmh1YnBfcGdf
Y29udHJvbChod3MsIGh1YnAtPmluc3QsIGZhbHNlKTsKKwkJaHdzLT5mdW5jcy5kcHBfcGdfY29u
dHJvbChod3MsIGRwcC0+aW5zdCwgZmFsc2UpOworCQlod3MtPmZ1bmNzLmh1YnBfcGdfY29udHJv
bChod3MsIGh1YnAtPmluc3QsIGZhbHNlKTsKIAkJZHBwLT5mdW5jcy0+ZHBwX3Jlc2V0KGRwcCk7
CiAJCVJFR19TRVQoRENfSVBfUkVRVUVTVF9DTlRMLCAwLAogCQkJCUlQX1JFUVVFU1RfRU4sIDAp
OwpAQCAtMTA2Nyw2ICsxMDcwLDcgQEAgdm9pZCBkY24xMF9wbGFuZV9hdG9taWNfcG93ZXJfZG93
bihzdHJ1Y3QgZGMgKmRjLAogICovCiB2b2lkIGRjbjEwX3BsYW5lX2F0b21pY19kaXNhYmxlKHN0
cnVjdCBkYyAqZGMsIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpCiB7CisJc3RydWN0IGRjZV9o
d3NlcSAqaHdzID0gZGMtPmh3c2VxOwogCXN0cnVjdCBodWJwICpodWJwID0gcGlwZV9jdHgtPnBs
YW5lX3Jlcy5odWJwOwogCXN0cnVjdCBkcHAgKmRwcCA9IHBpcGVfY3R4LT5wbGFuZV9yZXMuZHBw
OwogCWludCBvcHBfaWQgPSBodWJwLT5vcHBfaWQ7CkBAIC0xMDg1LDcgKzEwODksNyBAQCB2b2lk
IGRjbjEwX3BsYW5lX2F0b21pY19kaXNhYmxlKHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBwaXBlX2N0
eCAqcGlwZV9jdHgpCiAJaHVicC0+cG93ZXJfZ2F0ZWQgPSB0cnVlOwogCWRjLT5vcHRpbWl6ZWRf
cmVxdWlyZWQgPSBmYWxzZTsgLyogV2UncmUgcG93ZXJpbmcgb2ZmLCBubyBuZWVkIHRvIG9wdGlt
aXplICovCiAKLQlkYy0+aHdzcy5wbGFuZV9hdG9taWNfcG93ZXJfZG93bihkYywKKwlod3MtPmZ1
bmNzLnBsYW5lX2F0b21pY19wb3dlcl9kb3duKGRjLAogCQkJcGlwZV9jdHgtPnBsYW5lX3Jlcy5k
cHAsCiAJCQlwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnApOwogCkBAIC0xMDk5LDEyICsxMTAzLDEz
IEBAIHZvaWQgZGNuMTBfcGxhbmVfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRjICpkYywgc3RydWN0
IHBpcGVfY3R4ICpwaXBlX2N0eCkKIAogdm9pZCBkY24xMF9kaXNhYmxlX3BsYW5lKHN0cnVjdCBk
YyAqZGMsIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpCiB7CisJc3RydWN0IGRjZV9od3NlcSAq
aHdzID0gZGMtPmh3c2VxOwogCURDX0xPR0dFUl9JTklUKGRjLT5jdHgtPmxvZ2dlcik7CiAKIAlp
ZiAoIXBpcGVfY3R4LT5wbGFuZV9yZXMuaHVicCB8fCBwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnAt
PnBvd2VyX2dhdGVkKQogCQlyZXR1cm47CiAKLQlkYy0+aHdzcy5wbGFuZV9hdG9taWNfZGlzYWJs
ZShkYywgcGlwZV9jdHgpOworCWh3cy0+ZnVuY3MucGxhbmVfYXRvbWljX2Rpc2FibGUoZGMsIHBp
cGVfY3R4KTsKIAogCWFwcGx5X0RFR1ZJRENOMTBfMjUzX3dhKGRjKTsKIApAQCAtMTExNSw2ICsx
MTIwLDcgQEAgdm9pZCBkY24xMF9kaXNhYmxlX3BsYW5lKHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBw
aXBlX2N0eCAqcGlwZV9jdHgpCiB2b2lkIGRjbjEwX2luaXRfcGlwZXMoc3RydWN0IGRjICpkYywg
c3RydWN0IGRjX3N0YXRlICpjb250ZXh0KQogewogCWludCBpOworCXN0cnVjdCBkY2VfaHdzZXEg
Kmh3cyA9IGRjLT5od3NlcTsKIAlib29sIGNhbl9hcHBseV9zZWFtbGVzc19ib290ID0gZmFsc2U7
CiAKIAlmb3IgKGkgPSAwOyBpIDwgY29udGV4dC0+c3RyZWFtX2NvdW50OyBpKyspIHsKQEAgLTEx
MzksOCArMTE0NSw4IEBAIHZvaWQgZGNuMTBfaW5pdF9waXBlcyhzdHJ1Y3QgZGMgKmRjLCBzdHJ1
Y3QgZGNfc3RhdGUgKmNvbnRleHQpCiAJCSAqIGNvbW1hbmQgdGFibGUuCiAJCSAqLwogCQlpZiAo
dGctPmZ1bmNzLT5pc190Z19lbmFibGVkKHRnKSkgewotCQkJaWYgKGRjLT5od3NzLmluaXRfYmxh
bmsgIT0gTlVMTCkgewotCQkJCWRjLT5od3NzLmluaXRfYmxhbmsoZGMsIHRnKTsKKwkJCWlmICho
d3MtPmZ1bmNzLmluaXRfYmxhbmsgIT0gTlVMTCkgeworCQkJCWh3cy0+ZnVuY3MuaW5pdF9ibGFu
ayhkYywgdGcpOwogCQkJCXRnLT5mdW5jcy0+bG9jayh0Zyk7CiAJCQl9IGVsc2UgewogCQkJCXRn
LT5mdW5jcy0+bG9jayh0Zyk7CkBAIC0xMTk3LDcgKzEyMDMsNyBAQCB2b2lkIGRjbjEwX2luaXRf
cGlwZXMoc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KQogCQlkYy0+cmVz
X3Bvb2wtPm9wcHNbaV0tPm1wY2NfZGlzY29ubmVjdF9wZW5kaW5nW3BpcGVfY3R4LT5wbGFuZV9y
ZXMubXBjY19pbnN0XSA9IHRydWU7CiAJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLm9wcCA9IGRjLT5y
ZXNfcG9vbC0+b3Bwc1tpXTsKIAotCQlkYy0+aHdzcy5wbGFuZV9hdG9taWNfZGlzY29ubmVjdChk
YywgcGlwZV9jdHgpOworCQlod3MtPmZ1bmNzLnBsYW5lX2F0b21pY19kaXNjb25uZWN0KGRjLCBw
aXBlX2N0eCk7CiAKIAkJaWYgKHRnLT5mdW5jcy0+aXNfdGdfZW5hYmxlZCh0ZykpCiAJCQl0Zy0+
ZnVuY3MtPnVubG9jayh0Zyk7CkBAIC0xMjQzLDE1ICsxMjQ5LDE1IEBAIHZvaWQgZGNuMTBfaW5p
dF9odyhzdHJ1Y3QgZGMgKmRjKQogCQl9CiAKIAkJLy9FbmFibGUgYWJpbGl0eSB0byBwb3dlciBn
YXRlIC8gZG9uJ3QgZm9yY2UgcG93ZXIgb24gcGVybWFuZW50bHkKLQkJZGMtPmh3c3MuZW5hYmxl
X3Bvd2VyX2dhdGluZ19wbGFuZShod3MsIHRydWUpOworCQlod3MtPmZ1bmNzLmVuYWJsZV9wb3dl
cl9nYXRpbmdfcGxhbmUoaHdzLCB0cnVlKTsKIAogCQlyZXR1cm47CiAJfQogCiAJaWYgKCFkY2It
PmZ1bmNzLT5pc19hY2NlbGVyYXRlZF9tb2RlKGRjYikpCi0JCWRjLT5od3NzLmRpc2FibGVfdmdh
KGRjLT5od3NlcSk7CisJCWh3cy0+ZnVuY3MuZGlzYWJsZV92Z2EoZGMtPmh3c2VxKTsKIAotCWRj
LT5od3NzLmJpb3NfZ29sZGVuX2luaXQoZGMpOworCWh3cy0+ZnVuY3MuYmlvc19nb2xkZW5faW5p
dChkYyk7CiAJaWYgKGRjLT5jdHgtPmRjX2Jpb3MtPmZ3X2luZm9fdmFsaWQpIHsKIAkJcmVzX3Bv
b2wtPnJlZl9jbG9ja3MueHRhbGluX2Nsb2NrX2luS2h6ID0KIAkJCQlkYy0+Y3R4LT5kY19iaW9z
LT5md19pbmZvLnBsbF9pbmZvLmNyeXN0YWxfZnJlcXVlbmN5OwpAQCAtMTI5NCw4ICsxMzAwLDgg
QEAgdm9pZCBkY24xMF9pbml0X2h3KHN0cnVjdCBkYyAqZGMpCiAKIAkvKiBQb3dlciBnYXRlIERT
Q3MgKi8KIAlmb3IgKGkgPSAwOyBpIDwgcmVzX3Bvb2wtPnJlc19jYXAtPm51bV9kc2M7IGkrKykK
LQkJaWYgKGRjLT5od3NzLmRzY19wZ19jb250cm9sICE9IE5VTEwpCi0JCQlkYy0+aHdzcy5kc2Nf
cGdfY29udHJvbChod3MsIHJlc19wb29sLT5kc2NzW2ldLT5pbnN0LCBmYWxzZSk7CisJCWlmICho
d3MtPmZ1bmNzLmRzY19wZ19jb250cm9sICE9IE5VTEwpCisJCQlod3MtPmZ1bmNzLmRzY19wZ19j
b250cm9sKGh3cywgcmVzX3Bvb2wtPmRzY3NbaV0tPmluc3QsIGZhbHNlKTsKIAogCS8qIElmIHRh
a2luZyBjb250cm9sIG92ZXIgZnJvbSBWQklPUywgd2UgbWF5IHdhbnQgdG8gb3B0aW1pemUgb3Vy
IGZpcnN0CiAJICogbW9kZSBzZXQsIHNvIHdlIG5lZWQgdG8gc2tpcCBwb3dlcmluZyBkb3duIHBp
cGVzIHVudGlsIHdlIGtub3cgd2hpY2gKQEAgLTEzMDQsNyArMTMxMCw3IEBAIHZvaWQgZGNuMTBf
aW5pdF9odyhzdHJ1Y3QgZGMgKmRjKQogCSAqIGV2ZXJ5dGhpbmcgZG93bi4KIAkgKi8KIAlpZiAo
ZGNiLT5mdW5jcy0+aXNfYWNjZWxlcmF0ZWRfbW9kZShkY2IpIHx8IGRjLT5jb25maWcucG93ZXJf
ZG93bl9kaXNwbGF5X29uX2Jvb3QpIHsKLQkJZGMtPmh3c3MuaW5pdF9waXBlcyhkYywgZGMtPmN1
cnJlbnRfc3RhdGUpOworCQlod3MtPmZ1bmNzLmluaXRfcGlwZXMoZGMsIGRjLT5jdXJyZW50X3N0
YXRlKTsKIAl9CiAKIAlmb3IgKGkgPSAwOyBpIDwgcmVzX3Bvb2wtPmF1ZGlvX2NvdW50OyBpKysp
IHsKQEAgLTEzMzYsNyArMTM0Miw3IEBAIHZvaWQgZGNuMTBfaW5pdF9odyhzdHJ1Y3QgZGMgKmRj
KQogCQlSRUdfVVBEQVRFKERDRkNMS19DTlRMLCBEQ0ZDTEtfR0FURV9ESVMsIDApOwogCX0KIAot
CWRjLT5od3NzLmVuYWJsZV9wb3dlcl9nYXRpbmdfcGxhbmUoZGMtPmh3c2VxLCB0cnVlKTsKKwlo
d3MtPmZ1bmNzLmVuYWJsZV9wb3dlcl9nYXRpbmdfcGxhbmUoZGMtPmh3c2VxLCB0cnVlKTsKIAog
CWlmIChkYy0+Y2xrX21nci0+ZnVuY3MtPm5vdGlmeV93bV9yYW5nZXMpCiAJCWRjLT5jbGtfbWdy
LT5mdW5jcy0+bm90aWZ5X3dtX3JhbmdlcyhkYy0+Y2xrX21ncik7CkBAIC0xMzQ4LDYgKzEzNTQs
NyBAQCB2b2lkIGRjbjEwX3Jlc2V0X2h3X2N0eF93cmFwKAogCQlzdHJ1Y3QgZGNfc3RhdGUgKmNv
bnRleHQpCiB7CiAJaW50IGk7CisJc3RydWN0IGRjZV9od3NlcSAqaHdzID0gZGMtPmh3c2VxOwog
CiAJLyogUmVzZXQgQmFjayBFbmQqLwogCWZvciAoaSA9IGRjLT5yZXNfcG9vbC0+cGlwZV9jb3Vu
dCAtIDE7IGkgPj0gMCA7IGktLSkgewpAQCAtMTM2Niw4ICsxMzczLDggQEAgdm9pZCBkY24xMF9y
ZXNldF9od19jdHhfd3JhcCgKIAkJCXN0cnVjdCBjbG9ja19zb3VyY2UgKm9sZF9jbGsgPSBwaXBl
X2N0eF9vbGQtPmNsb2NrX3NvdXJjZTsKIAogCQkJZGNuMTBfcmVzZXRfYmFja19lbmRfZm9yX3Bp
cGUoZGMsIHBpcGVfY3R4X29sZCwgZGMtPmN1cnJlbnRfc3RhdGUpOwotCQkJaWYgKGRjLT5od3Nz
LmVuYWJsZV9zdHJlYW1fZ2F0aW5nKQotCQkJCWRjLT5od3NzLmVuYWJsZV9zdHJlYW1fZ2F0aW5n
KGRjLCBwaXBlX2N0eCk7CisJCQlpZiAoaHdzLT5mdW5jcy5lbmFibGVfc3RyZWFtX2dhdGluZykK
KwkJCQlod3MtPmZ1bmNzLmVuYWJsZV9zdHJlYW1fZ2F0aW5nKGRjLCBwaXBlX2N0eCk7CiAJCQlp
ZiAob2xkX2NsaykKIAkJCQlvbGRfY2xrLT5mdW5jcy0+Y3NfcG93ZXJfZG93bihvbGRfY2xrKTsK
IAkJfQpAQCAtMTU0NSw2ICsxNTUyLDggQEAgdm9pZCBkY24xMF9waXBlX2NvbnRyb2xfbG9jaygK
IAlzdHJ1Y3QgcGlwZV9jdHggKnBpcGUsCiAJYm9vbCBsb2NrKQogeworCXN0cnVjdCBkY2VfaHdz
ZXEgKmh3cyA9IGRjLT5od3NlcTsKKwogCS8qIHVzZSBURyBtYXN0ZXIgdXBkYXRlIGxvY2sgdG8g
bG9jayBldmVyeXRoaW5nIG9uIHRoZSBURwogCSAqIHRoZXJlZm9yZSBvbmx5IHRvcCBwaXBlIG5l
ZWQgdG8gbG9jawogCSAqLwpAQCAtMTU1Miw3ICsxNTYxLDcgQEAgdm9pZCBkY24xMF9waXBlX2Nv
bnRyb2xfbG9jaygKIAkJcmV0dXJuOwogCiAJaWYgKGRjLT5kZWJ1Zy5zYW5pdHlfY2hlY2tzKQot
CQlkYy0+aHdzcy52ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5nZV9oaWdoKGRjKTsKKwkJaHdzLT5m
dW5jcy52ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5nZV9oaWdoKGRjKTsKIAogCWlmIChsb2NrKQog
CQlwaXBlLT5zdHJlYW1fcmVzLnRnLT5mdW5jcy0+bG9jayhwaXBlLT5zdHJlYW1fcmVzLnRnKTsK
QEAgLTE1NjAsNyArMTU2OSw3IEBAIHZvaWQgZGNuMTBfcGlwZV9jb250cm9sX2xvY2soCiAJCXBp
cGUtPnN0cmVhbV9yZXMudGctPmZ1bmNzLT51bmxvY2socGlwZS0+c3RyZWFtX3Jlcy50Zyk7CiAK
IAlpZiAoZGMtPmRlYnVnLnNhbml0eV9jaGVja3MpCi0JCWRjLT5od3NzLnZlcmlmeV9hbGxvd19w
c3RhdGVfY2hhbmdlX2hpZ2goZGMpOworCQlod3MtPmZ1bmNzLnZlcmlmeV9hbGxvd19wc3RhdGVf
Y2hhbmdlX2hpZ2goZGMpOwogfQogCiBzdGF0aWMgYm9vbCB3YWl0X2Zvcl9yZXNldF90cmlnZ2Vy
X3RvX29jY3VyKApAQCAtMTg2OCw3ICsxODc3LDcgQEAgc3RhdGljIHZvaWQgZGNuMTBfZW5hYmxl
X3BsYW5lKAogCXN0cnVjdCBkY2VfaHdzZXEgKmh3cyA9IGRjLT5od3NlcTsKIAogCWlmIChkYy0+
ZGVidWcuc2FuaXR5X2NoZWNrcykgewotCQlkYy0+aHdzcy52ZXJpZnlfYWxsb3dfcHN0YXRlX2No
YW5nZV9oaWdoKGRjKTsKKwkJaHdzLT5mdW5jcy52ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5nZV9o
aWdoKGRjKTsKIAl9CiAKIAl1bmRvX0RFR1ZJRENOMTBfMjUzX3dhKGRjKTsKQEAgLTE5MjUsNyAr
MTkzNCw3IEBAIHN0YXRpYyB2b2lkIGRjbjEwX2VuYWJsZV9wbGFuZSgKIAkJZGNuMTBfcHJvZ3Jh
bV9wdGVfdm0oaHdzLCBwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnApOwogCiAJaWYgKGRjLT5kZWJ1
Zy5zYW5pdHlfY2hlY2tzKSB7Ci0JCWRjLT5od3NzLnZlcmlmeV9hbGxvd19wc3RhdGVfY2hhbmdl
X2hpZ2goZGMpOworCQlod3MtPmZ1bmNzLnZlcmlmeV9hbGxvd19wc3RhdGVfY2hhbmdlX2hpZ2go
ZGMpOwogCX0KIH0KIApAQCAtMjEwMiw2ICsyMTExLDcgQEAgc3RhdGljIHZvaWQgZGNuMTBfdXBk
YXRlX2RwcChzdHJ1Y3QgZHBwICpkcHAsIHN0cnVjdCBkY19wbGFuZV9zdGF0ZSAqcGxhbmVfc3Rh
dGUKIAogdm9pZCBkY24xMF91cGRhdGVfbXBjYyhzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlwZV9j
dHggKnBpcGVfY3R4KQogeworCXN0cnVjdCBkY2VfaHdzZXEgKmh3cyA9IGRjLT5od3NlcTsKIAlz
dHJ1Y3QgaHVicCAqaHVicCA9IHBpcGVfY3R4LT5wbGFuZV9yZXMuaHVicDsKIAlzdHJ1Y3QgbXBj
Y19ibG5kX2NmZyBibG5kX2NmZyA9IHt7MH19OwogCWJvb2wgcGVyX3BpeGVsX2FscGhhID0gcGlw
ZV9jdHgtPnBsYW5lX3N0YXRlLT5wZXJfcGl4ZWxfYWxwaGEgJiYgcGlwZV9jdHgtPmJvdHRvbV9w
aXBlOwpAQCAtMjExMSwxMCArMjEyMSwxMCBAQCB2b2lkIGRjbjEwX3VwZGF0ZV9tcGNjKHN0cnVj
dCBkYyAqZGMsIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpCiAJc3RydWN0IG1wY190cmVlICpt
cGNfdHJlZV9wYXJhbXMgPSAmKHBpcGVfY3R4LT5zdHJlYW1fcmVzLm9wcC0+bXBjX3RyZWVfcGFy
YW1zKTsKIAogCWlmIChkYy0+ZGVidWcudmlzdWFsX2NvbmZpcm0gPT0gVklTVUFMX0NPTkZJUk1f
SERSKSB7Ci0JCWRjLT5od3NzLmdldF9oZHJfdmlzdWFsX2NvbmZpcm1fY29sb3IoCisJCWh3cy0+
ZnVuY3MuZ2V0X2hkcl92aXN1YWxfY29uZmlybV9jb2xvcigKIAkJCQlwaXBlX2N0eCwgJmJsbmRf
Y2ZnLmJsYWNrX2NvbG9yKTsKIAl9IGVsc2UgaWYgKGRjLT5kZWJ1Zy52aXN1YWxfY29uZmlybSA9
PSBWSVNVQUxfQ09ORklSTV9TVVJGQUNFKSB7Ci0JCWRjLT5od3NzLmdldF9zdXJmYWNlX3Zpc3Vh
bF9jb25maXJtX2NvbG9yKAorCQlod3MtPmZ1bmNzLmdldF9zdXJmYWNlX3Zpc3VhbF9jb25maXJt
X2NvbG9yKAogCQkJCXBpcGVfY3R4LCAmYmxuZF9jZmcuYmxhY2tfY29sb3IpOwogCX0gZWxzZSB7
CiAJCWNvbG9yX3NwYWNlX3RvX2JsYWNrX2NvbG9yKApAQCAtMjIwMSw2ICsyMjExLDcgQEAgc3Rh
dGljIHZvaWQgZGNuMTBfdXBkYXRlX2RjaHVicF9kcHAoCiAJc3RydWN0IHBpcGVfY3R4ICpwaXBl
X2N0eCwKIAlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpCiB7CisJc3RydWN0IGRjZV9od3NlcSAq
aHdzID0gZGMtPmh3c2VxOwogCXN0cnVjdCBodWJwICpodWJwID0gcGlwZV9jdHgtPnBsYW5lX3Jl
cy5odWJwOwogCXN0cnVjdCBkcHAgKmRwcCA9IHBpcGVfY3R4LT5wbGFuZV9yZXMuZHBwOwogCXN0
cnVjdCBkY19wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUgPSBwaXBlX2N0eC0+cGxhbmVfc3RhdGU7
CkBAIC0yMjU5LDcgKzIyNzAsNyBAQCBzdGF0aWMgdm9pZCBkY24xMF91cGRhdGVfZGNodWJwX2Rw
cCgKIAlpZiAocGxhbmVfc3RhdGUtPnVwZGF0ZV9mbGFncy5iaXRzLmZ1bGxfdXBkYXRlIHx8CiAJ
CXBsYW5lX3N0YXRlLT51cGRhdGVfZmxhZ3MuYml0cy5wZXJfcGl4ZWxfYWxwaGFfY2hhbmdlIHx8
CiAJCXBsYW5lX3N0YXRlLT51cGRhdGVfZmxhZ3MuYml0cy5nbG9iYWxfYWxwaGFfY2hhbmdlKQot
CQlkYy0+aHdzcy51cGRhdGVfbXBjYyhkYywgcGlwZV9jdHgpOworCQlod3MtPmZ1bmNzLnVwZGF0
ZV9tcGNjKGRjLCBwaXBlX2N0eCk7CiAKIAlpZiAocGxhbmVfc3RhdGUtPnVwZGF0ZV9mbGFncy5i
aXRzLmZ1bGxfdXBkYXRlIHx8CiAJCXBsYW5lX3N0YXRlLT51cGRhdGVfZmxhZ3MuYml0cy5wZXJf
cGl4ZWxfYWxwaGFfY2hhbmdlIHx8CkBAIC0yMzE5LDcgKzIzMzAsNyBAQCBzdGF0aWMgdm9pZCBk
Y24xMF91cGRhdGVfZGNodWJwX2RwcCgKIAogCWh1YnAtPnBvd2VyX2dhdGVkID0gZmFsc2U7CiAK
LQlkYy0+aHdzcy51cGRhdGVfcGxhbmVfYWRkcihkYywgcGlwZV9jdHgpOworCWh3cy0+ZnVuY3Mu
dXBkYXRlX3BsYW5lX2FkZHIoZGMsIHBpcGVfY3R4KTsKIAogCWlmIChpc19waXBlX3RyZWVfdmlz
aWJsZShwaXBlX2N0eCkpCiAJCWh1YnAtPmZ1bmNzLT5zZXRfYmxhbmsoaHVicCwgZmFsc2UpOwpA
QCAtMjM5NSwxNyArMjQwNiwxOSBAQCB2b2lkIGRjbjEwX3Byb2dyYW1fcGlwZSgKIAkJc3RydWN0
IHBpcGVfY3R4ICpwaXBlX2N0eCwKIAkJc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KQogeworCXN0
cnVjdCBkY2VfaHdzZXEgKmh3cyA9IGRjLT5od3NlcTsKKwogCWlmIChwaXBlX2N0eC0+cGxhbmVf
c3RhdGUtPnVwZGF0ZV9mbGFncy5iaXRzLmZ1bGxfdXBkYXRlKQogCQlkY24xMF9lbmFibGVfcGxh
bmUoZGMsIHBpcGVfY3R4LCBjb250ZXh0KTsKIAogCWRjbjEwX3VwZGF0ZV9kY2h1YnBfZHBwKGRj
LCBwaXBlX2N0eCwgY29udGV4dCk7CiAKLQlkYy0+aHdzcy5zZXRfaGRyX211bHRpcGxpZXIocGlw
ZV9jdHgpOworCWh3cy0+ZnVuY3Muc2V0X2hkcl9tdWx0aXBsaWVyKHBpcGVfY3R4KTsKIAogCWlm
IChwaXBlX2N0eC0+cGxhbmVfc3RhdGUtPnVwZGF0ZV9mbGFncy5iaXRzLmZ1bGxfdXBkYXRlIHx8
CiAJCQlwaXBlX2N0eC0+cGxhbmVfc3RhdGUtPnVwZGF0ZV9mbGFncy5iaXRzLmluX3RyYW5zZmVy
X2Z1bmNfY2hhbmdlIHx8CiAJCQlwaXBlX2N0eC0+cGxhbmVfc3RhdGUtPnVwZGF0ZV9mbGFncy5i
aXRzLmdhbW1hX2NoYW5nZSkKLQkJZGMtPmh3c3Muc2V0X2lucHV0X3RyYW5zZmVyX2Z1bmMoZGMs
IHBpcGVfY3R4LCBwaXBlX2N0eC0+cGxhbmVfc3RhdGUpOworCQlod3MtPmZ1bmNzLnNldF9pbnB1
dF90cmFuc2Zlcl9mdW5jKGRjLCBwaXBlX2N0eCwgcGlwZV9jdHgtPnBsYW5lX3N0YXRlKTsKIAog
CS8qIGRjbjEwX3RyYW5zbGF0ZV9yZWdhbW1hX3RvX2h3X2Zvcm1hdCB0YWtlcyA3NTB1cyB0byBm
aW5pc2gKIAkgKiBvbmx5IGRvIGdhbW1hIHByb2dyYW1taW5nIGZvciBmdWxsIHVwZGF0ZS4KQEAg
LTI0MTQsNyArMjQyNyw3IEBAIHZvaWQgZGNuMTBfcHJvZ3JhbV9waXBlKAogCSAqIGRvaW5nIGhl
YXZ5IGNhbGN1bGF0aW9uIGFuZCBwcm9ncmFtbWluZwogCSAqLwogCWlmIChwaXBlX2N0eC0+cGxh
bmVfc3RhdGUtPnVwZGF0ZV9mbGFncy5iaXRzLmZ1bGxfdXBkYXRlKQotCQlkYy0+aHdzcy5zZXRf
b3V0cHV0X3RyYW5zZmVyX2Z1bmMoZGMsIHBpcGVfY3R4LCBwaXBlX2N0eC0+c3RyZWFtKTsKKwkJ
aHdzLT5mdW5jcy5zZXRfb3V0cHV0X3RyYW5zZmVyX2Z1bmMoZGMsIHBpcGVfY3R4LCBwaXBlX2N0
eC0+c3RyZWFtKTsKIH0KIAogc3RhdGljIHZvaWQgZGNuMTBfcHJvZ3JhbV9hbGxfcGlwZV9pbl90
cmVlKApAQCAtMjQyMiw2ICsyNDM1LDggQEAgc3RhdGljIHZvaWQgZGNuMTBfcHJvZ3JhbV9hbGxf
cGlwZV9pbl90cmVlKAogCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAogCQlzdHJ1Y3QgZGNf
c3RhdGUgKmNvbnRleHQpCiB7CisJc3RydWN0IGRjZV9od3NlcSAqaHdzID0gZGMtPmh3c2VxOwor
CiAJaWYgKHBpcGVfY3R4LT50b3BfcGlwZSA9PSBOVUxMKSB7CiAJCWJvb2wgYmxhbmsgPSAhaXNf
cGlwZV90cmVlX3Zpc2libGUocGlwZV9jdHgpOwogCkBAIC0yNDM1LDE0ICsyNDUwLDE0IEBAIHN0
YXRpYyB2b2lkIGRjbjEwX3Byb2dyYW1fYWxsX3BpcGVfaW5fdHJlZSgKIAkJcGlwZV9jdHgtPnN0
cmVhbV9yZXMudGctPmZ1bmNzLT5zZXRfdnRnX3BhcmFtcygKIAkJCQlwaXBlX2N0eC0+c3RyZWFt
X3Jlcy50ZywgJnBpcGVfY3R4LT5zdHJlYW0tPnRpbWluZyk7CiAKLQkJaWYgKGRjLT5od3NzLnNl
dHVwX3Z1cGRhdGVfaW50ZXJydXB0KQotCQkJZGMtPmh3c3Muc2V0dXBfdnVwZGF0ZV9pbnRlcnJ1
cHQoZGMsIHBpcGVfY3R4KTsKKwkJaWYgKGh3cy0+ZnVuY3Muc2V0dXBfdnVwZGF0ZV9pbnRlcnJ1
cHQpCisJCQlod3MtPmZ1bmNzLnNldHVwX3Z1cGRhdGVfaW50ZXJydXB0KGRjLCBwaXBlX2N0eCk7
CiAKLQkJZGMtPmh3c3MuYmxhbmtfcGl4ZWxfZGF0YShkYywgcGlwZV9jdHgsIGJsYW5rKTsKKwkJ
aHdzLT5mdW5jcy5ibGFua19waXhlbF9kYXRhKGRjLCBwaXBlX2N0eCwgYmxhbmspOwogCX0KIAog
CWlmIChwaXBlX2N0eC0+cGxhbmVfc3RhdGUgIT0gTlVMTCkKLQkJZGMtPmh3c3MucHJvZ3JhbV9w
aXBlKGRjLCBwaXBlX2N0eCwgY29udGV4dCk7CisJCWh3cy0+ZnVuY3MucHJvZ3JhbV9waXBlKGRj
LCBwaXBlX2N0eCwgY29udGV4dCk7CiAKIAlpZiAocGlwZV9jdHgtPmJvdHRvbV9waXBlICE9IE5V
TEwgJiYgcGlwZV9jdHgtPmJvdHRvbV9waXBlICE9IHBpcGVfY3R4KQogCQlkY24xMF9wcm9ncmFt
X2FsbF9waXBlX2luX3RyZWUoZGMsIHBpcGVfY3R4LT5ib3R0b21fcGlwZSwgY29udGV4dCk7CkBA
IC0yNDc4LDYgKzI0OTMsNyBAQCB2b2lkIGRjbjEwX2FwcGx5X2N0eF9mb3Jfc3VyZmFjZSgKIAkJ
aW50IG51bV9wbGFuZXMsCiAJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCkKIHsKKwlzdHJ1Y3Qg
ZGNlX2h3c2VxICpod3MgPSBkYy0+aHdzZXE7CiAJaW50IGk7CiAJc3RydWN0IHRpbWluZ19nZW5l
cmF0b3IgKnRnOwogCXVpbnQzMl90IHVuZGVyZmxvd19jaGVja19kZWxheV91czsKQEAgLTI0OTcs
OCArMjUxMyw4IEBAIHZvaWQgZGNuMTBfYXBwbHlfY3R4X2Zvcl9zdXJmYWNlKAogCiAJdW5kZXJm
bG93X2NoZWNrX2RlbGF5X3VzID0gZGMtPmRlYnVnLnVuZGVyZmxvd19hc3NlcnRfZGVsYXlfdXM7
CiAKLQlpZiAodW5kZXJmbG93X2NoZWNrX2RlbGF5X3VzICE9IDB4RkZGRkZGRkYgJiYgZGMtPmh3
c3MuZGlkX3VuZGVyZmxvd19vY2N1cikKLQkJQVNTRVJUKGRjLT5od3NzLmRpZF91bmRlcmZsb3df
b2NjdXIoZGMsIHRvcF9waXBlX3RvX3Byb2dyYW0pKTsKKwlpZiAodW5kZXJmbG93X2NoZWNrX2Rl
bGF5X3VzICE9IDB4RkZGRkZGRkYgJiYgaHdzLT5mdW5jcy5kaWRfdW5kZXJmbG93X29jY3VyKQor
CQlBU1NFUlQoaHdzLT5mdW5jcy5kaWRfdW5kZXJmbG93X29jY3VyKGRjLCB0b3BfcGlwZV90b19w
cm9ncmFtKSk7CiAKIAlpZiAoaW50ZXJkZXBlbmRlbnRfdXBkYXRlKQogCQlkY24xMF9sb2NrX2Fs
bF9waXBlcyhkYywgY29udGV4dCwgdHJ1ZSk7CkBAIC0yNTA4LDEyICsyNTI0LDEyIEBAIHZvaWQg
ZGNuMTBfYXBwbHlfY3R4X2Zvcl9zdXJmYWNlKAogCWlmICh1bmRlcmZsb3dfY2hlY2tfZGVsYXlf
dXMgIT0gMHhGRkZGRkZGRikKIAkJdWRlbGF5KHVuZGVyZmxvd19jaGVja19kZWxheV91cyk7CiAK
LQlpZiAodW5kZXJmbG93X2NoZWNrX2RlbGF5X3VzICE9IDB4RkZGRkZGRkYgJiYgZGMtPmh3c3Mu
ZGlkX3VuZGVyZmxvd19vY2N1cikKLQkJQVNTRVJUKGRjLT5od3NzLmRpZF91bmRlcmZsb3dfb2Nj
dXIoZGMsIHRvcF9waXBlX3RvX3Byb2dyYW0pKTsKKwlpZiAodW5kZXJmbG93X2NoZWNrX2RlbGF5
X3VzICE9IDB4RkZGRkZGRkYgJiYgaHdzLT5mdW5jcy5kaWRfdW5kZXJmbG93X29jY3VyKQorCQlB
U1NFUlQoaHdzLT5mdW5jcy5kaWRfdW5kZXJmbG93X29jY3VyKGRjLCB0b3BfcGlwZV90b19wcm9n
cmFtKSk7CiAKIAlpZiAobnVtX3BsYW5lcyA9PSAwKSB7CiAJCS8qIE9URyBibGFuayBiZWZvcmUg
cmVtb3ZlIGFsbCBmcm9udCBlbmQgKi8KLQkJZGMtPmh3c3MuYmxhbmtfcGl4ZWxfZGF0YShkYywg
dG9wX3BpcGVfdG9fcHJvZ3JhbSwgdHJ1ZSk7CisJCWh3cy0+ZnVuY3MuYmxhbmtfcGl4ZWxfZGF0
YShkYywgdG9wX3BpcGVfdG9fcHJvZ3JhbSwgdHJ1ZSk7CiAJfQogCiAJLyogRGlzY29ubmVjdCB1
bnVzZWQgbXBjYyAqLwpAQCAtMjUzOSw3ICsyNTU1LDcgQEAgdm9pZCBkY24xMF9hcHBseV9jdHhf
Zm9yX3N1cmZhY2UoCiAJCSAgICBvbGRfcGlwZV9jdHgtPnBsYW5lX3N0YXRlICYmCiAJCSAgICBv
bGRfcGlwZV9jdHgtPnN0cmVhbV9yZXMudGcgPT0gdGcpIHsKIAotCQkJZGMtPmh3c3MucGxhbmVf
YXRvbWljX2Rpc2Nvbm5lY3QoZGMsIG9sZF9waXBlX2N0eCk7CisJCQlod3MtPmZ1bmNzLnBsYW5l
X2F0b21pY19kaXNjb25uZWN0KGRjLCBvbGRfcGlwZV9jdHgpOwogCQkJcmVtb3ZlZF9waXBlW2ld
ID0gdHJ1ZTsKIAogCQkJRENfTE9HX0RDKCJSZXNldCBtcGNjIGZvciBwaXBlICVkXG4iLApAQCAt
MjU1MSw4ICsyNTY3LDggQEAgdm9pZCBkY24xMF9hcHBseV9jdHhfZm9yX3N1cmZhY2UoCiAJCWRj
bjEwX3Byb2dyYW1fYWxsX3BpcGVfaW5fdHJlZShkYywgdG9wX3BpcGVfdG9fcHJvZ3JhbSwgY29u
dGV4dCk7CiAKIAkvKiBQcm9ncmFtIHNlY29uZGFyeSBibGVuZGluZyB0cmVlIGFuZCB3cml0ZWJh
Y2sgcGlwZXMgKi8KLQlpZiAoKHN0cmVhbS0+bnVtX3diX2luZm8gPiAwKSAmJiAoZGMtPmh3c3Mu
cHJvZ3JhbV9hbGxfd3JpdGViYWNrX3BpcGVzX2luX3RyZWUpKQotCQlkYy0+aHdzcy5wcm9ncmFt
X2FsbF93cml0ZWJhY2tfcGlwZXNfaW5fdHJlZShkYywgc3RyZWFtLCBjb250ZXh0KTsKKwlpZiAo
KHN0cmVhbS0+bnVtX3diX2luZm8gPiAwKSAmJiAoaHdzLT5mdW5jcy5wcm9ncmFtX2FsbF93cml0
ZWJhY2tfcGlwZXNfaW5fdHJlZSkpCisJCWh3cy0+ZnVuY3MucHJvZ3JhbV9hbGxfd3JpdGViYWNr
X3BpcGVzX2luX3RyZWUoZGMsIHN0cmVhbSwgY29udGV4dCk7CiAJaWYgKGludGVyZGVwZW5kZW50
X3VwZGF0ZSkKIAkJZm9yIChpID0gMDsgaSA8IGRjLT5yZXNfcG9vbC0+cGlwZV9jb3VudDsgaSsr
KSB7CiAJCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4ID0gJmNvbnRleHQtPnJlc19jdHgucGlw
ZV9jdHhbaV07CkBAIC0yNjA5LDEwICsyNjI1LDExIEBAIHZvaWQgZGNuMTBfcHJlcGFyZV9iYW5k
d2lkdGgoCiAJCXN0cnVjdCBkYyAqZGMsCiAJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCkKIHsK
KwlzdHJ1Y3QgZGNlX2h3c2VxICpod3MgPSBkYy0+aHdzZXE7CiAJc3RydWN0IGh1YmJ1YiAqaHVi
YnViID0gZGMtPnJlc19wb29sLT5odWJidWI7CiAKIAlpZiAoZGMtPmRlYnVnLnNhbml0eV9jaGVj
a3MpCi0JCWRjLT5od3NzLnZlcmlmeV9hbGxvd19wc3RhdGVfY2hhbmdlX2hpZ2goZGMpOworCQlo
d3MtPmZ1bmNzLnZlcmlmeV9hbGxvd19wc3RhdGVfY2hhbmdlX2hpZ2goZGMpOwogCiAJaWYgKCFJ
U19GUEdBX01BWElNVVNfREMoZGMtPmN0eC0+ZGNlX2Vudmlyb25tZW50KSkgewogCQlpZiAoY29u
dGV4dC0+c3RyZWFtX2NvdW50ID09IDApCkBAIC0yNjM0LDE3ICsyNjUxLDE4IEBAIHZvaWQgZGNu
MTBfcHJlcGFyZV9iYW5kd2lkdGgoCiAJCWRjbl9id19ub3RpZnlfcHBsaWJfb2Zfd21fcmFuZ2Vz
KGRjKTsKIAogCWlmIChkYy0+ZGVidWcuc2FuaXR5X2NoZWNrcykKLQkJZGMtPmh3c3MudmVyaWZ5
X2FsbG93X3BzdGF0ZV9jaGFuZ2VfaGlnaChkYyk7CisJCWh3cy0+ZnVuY3MudmVyaWZ5X2FsbG93
X3BzdGF0ZV9jaGFuZ2VfaGlnaChkYyk7CiB9CiAKIHZvaWQgZGNuMTBfb3B0aW1pemVfYmFuZHdp
ZHRoKAogCQlzdHJ1Y3QgZGMgKmRjLAogCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpCiB7CisJ
c3RydWN0IGRjZV9od3NlcSAqaHdzID0gZGMtPmh3c2VxOwogCXN0cnVjdCBodWJidWIgKmh1YmJ1
YiA9IGRjLT5yZXNfcG9vbC0+aHViYnViOwogCiAJaWYgKGRjLT5kZWJ1Zy5zYW5pdHlfY2hlY2tz
KQotCQlkYy0+aHdzcy52ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5nZV9oaWdoKGRjKTsKKwkJaHdz
LT5mdW5jcy52ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5nZV9oaWdoKGRjKTsKIAogCWlmICghSVNf
RlBHQV9NQVhJTVVTX0RDKGRjLT5jdHgtPmRjZV9lbnZpcm9ubWVudCkpIHsKIAkJaWYgKGNvbnRl
eHQtPnN0cmVhbV9jb3VudCA9PSAwKQpAQCAtMjY2Niw3ICsyNjg0LDcgQEAgdm9pZCBkY24xMF9v
cHRpbWl6ZV9iYW5kd2lkdGgoCiAJCWRjbl9id19ub3RpZnlfcHBsaWJfb2Zfd21fcmFuZ2VzKGRj
KTsKIAogCWlmIChkYy0+ZGVidWcuc2FuaXR5X2NoZWNrcykKLQkJZGMtPmh3c3MudmVyaWZ5X2Fs
bG93X3BzdGF0ZV9jaGFuZ2VfaGlnaChkYyk7CisJCWh3cy0+ZnVuY3MudmVyaWZ5X2FsbG93X3Bz
dGF0ZV9jaGFuZ2VfaGlnaChkYyk7CiB9CiAKIHZvaWQgZGNuMTBfc2V0X2RycihzdHJ1Y3QgcGlw
ZV9jdHggKipwaXBlX2N0eCwKQEAgLTI4MDgsMTAgKzI4MjYsMTEgQEAgdm9pZCBkY24xMF93YWl0
X2Zvcl9tcGNjX2Rpc2Nvbm5lY3QoCiAJCXN0cnVjdCByZXNvdXJjZV9wb29sICpyZXNfcG9vbCwK
IAkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCkKIHsKKwlzdHJ1Y3QgZGNlX2h3c2VxICpod3Mg
PSBkYy0+aHdzZXE7CiAJaW50IG1wY2NfaW5zdDsKIAogCWlmIChkYy0+ZGVidWcuc2FuaXR5X2No
ZWNrcykgewotCQlkYy0+aHdzcy52ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5nZV9oaWdoKGRjKTsK
KwkJaHdzLT5mdW5jcy52ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5nZV9oaWdoKGRjKTsKIAl9CiAK
IAlpZiAoIXBpcGVfY3R4LT5zdHJlYW1fcmVzLm9wcCkKQEAgLTI4MjgsNyArMjg0Nyw3IEBAIHZv
aWQgZGNuMTBfd2FpdF9mb3JfbXBjY19kaXNjb25uZWN0KAogCX0KIAogCWlmIChkYy0+ZGVidWcu
c2FuaXR5X2NoZWNrcykgewotCQlkYy0+aHdzcy52ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5nZV9o
aWdoKGRjKTsKKwkJaHdzLT5mdW5jcy52ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5nZV9oaWdoKGRj
KTsKIAl9CiAKIH0KQEAgLTMxMjcsNiArMzE0Niw3IEBAIHZvaWQgZGNuMTBfdW5ibGFua19zdHJl
YW0oc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKIAlzdHJ1Y3QgZW5jb2Rlcl91bmJsYW5rX3Bh
cmFtIHBhcmFtcyA9IHsgeyAwIH0gfTsKIAlzdHJ1Y3QgZGNfc3RyZWFtX3N0YXRlICpzdHJlYW0g
PSBwaXBlX2N0eC0+c3RyZWFtOwogCXN0cnVjdCBkY19saW5rICpsaW5rID0gc3RyZWFtLT5saW5r
OworCXN0cnVjdCBkY2VfaHdzZXEgKmh3cyA9IGxpbmstPmRjLT5od3NlcTsKIAogCS8qIG9ubHkg
MyBpdGVtcyBiZWxvdyBhcmUgdXNlZCBieSB1bmJsYW5rICovCiAJcGFyYW1zLnRpbWluZyA9IHBp
cGVfY3R4LT5zdHJlYW0tPnRpbWluZzsKQEAgLTMxNDAsNyArMzE2MCw3IEBAIHZvaWQgZGNuMTBf
dW5ibGFua19zdHJlYW0oc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKIAl9CiAKIAlpZiAobGlu
ay0+bG9jYWxfc2luayAmJiBsaW5rLT5sb2NhbF9zaW5rLT5zaW5rX3NpZ25hbCA9PSBTSUdOQUxf
VFlQRV9FRFApIHsKLQkJbGluay0+ZGMtPmh3c3MuZWRwX2JhY2tsaWdodF9jb250cm9sKGxpbmss
IHRydWUpOworCQlod3MtPmZ1bmNzLmVkcF9iYWNrbGlnaHRfY29udHJvbChsaW5rLCB0cnVlKTsK
IAl9CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24x
MC9kY24xMF9od19zZXF1ZW5jZXIuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
Y24xMC9kY24xMF9od19zZXF1ZW5jZXIuaAppbmRleCA1YWFkMzkyMmJlNmMuLjU1YjhmM2IyZmM0
ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEw
X2h3X3NlcXVlbmNlci5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24x
MC9kY24xMF9od19zZXF1ZW5jZXIuaApAQCAtMjcsNiArMjcsNyBAQAogI2RlZmluZSBfX0RDX0hX
U1NfRENOMTBfSF9fCiAKICNpbmNsdWRlICJjb3JlX3R5cGVzLmgiCisjaW5jbHVkZSAiaHdfc2Vx
dWVuY2VyX3ByaXZhdGUuaCIKIAogc3RydWN0IGRjOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfaW5pdC5jIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX2luaXQuYwppbmRleCAzODkyM2YzMTIwZWUuLmU3
ZTUzNTJlYzQyNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2Rj
bjEwL2RjbjEwX2luaXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNu
MTAvZGNuMTBfaW5pdC5jCkBAIC0yMywyNSArMjMsMTkgQEAKICAqCiAgKi8KIAorI2luY2x1ZGUg
Imh3X3NlcXVlbmNlcl9wcml2YXRlLmgiCiAjaW5jbHVkZSAiZGNlMTEwL2RjZTExMF9od19zZXF1
ZW5jZXIuaCIKICNpbmNsdWRlICJkY24xMF9od19zZXF1ZW5jZXIuaCIKIAogc3RhdGljIGNvbnN0
IHN0cnVjdCBod19zZXF1ZW5jZXJfZnVuY3MgZGNuMTBfZnVuY3MgPSB7CiAJLnByb2dyYW1fZ2Ft
dXRfcmVtYXAgPSBkY24xMF9wcm9ncmFtX2dhbXV0X3JlbWFwLAogCS5pbml0X2h3ID0gZGNuMTBf
aW5pdF9odywKLQkuaW5pdF9waXBlcyA9IGRjbjEwX2luaXRfcGlwZXMsCiAJLmFwcGx5X2N0eF90
b19odyA9IGRjZTExMF9hcHBseV9jdHhfdG9faHcsCiAJLmFwcGx5X2N0eF9mb3Jfc3VyZmFjZSA9
IGRjbjEwX2FwcGx5X2N0eF9mb3Jfc3VyZmFjZSwKIAkudXBkYXRlX3BsYW5lX2FkZHIgPSBkY24x
MF91cGRhdGVfcGxhbmVfYWRkciwKLQkucGxhbmVfYXRvbWljX2Rpc2Nvbm5lY3QgPSBkY24xMF9w
bGFuZV9hdG9taWNfZGlzY29ubmVjdCwKLQkucHJvZ3JhbV9waXBlID0gZGNuMTBfcHJvZ3JhbV9w
aXBlLAogCS51cGRhdGVfZGNodWIgPSBkY24xMF91cGRhdGVfZGNodWIsCi0JLnVwZGF0ZV9tcGNj
ID0gZGNuMTBfdXBkYXRlX21wY2MsCiAJLnVwZGF0ZV9wZW5kaW5nX3N0YXR1cyA9IGRjbjEwX3Vw
ZGF0ZV9wZW5kaW5nX3N0YXR1cywKLQkuc2V0X2lucHV0X3RyYW5zZmVyX2Z1bmMgPSBkY24xMF9z
ZXRfaW5wdXRfdHJhbnNmZXJfZnVuYywKLQkuc2V0X291dHB1dF90cmFuc2Zlcl9mdW5jID0gZGNu
MTBfc2V0X291dHB1dF90cmFuc2Zlcl9mdW5jLAogCS5wcm9ncmFtX291dHB1dF9jc2MgPSBkY24x
MF9wcm9ncmFtX291dHB1dF9jc2MsCi0JLnBvd2VyX2Rvd24gPSBkY2UxMTBfcG93ZXJfZG93biwK
IAkuZW5hYmxlX2FjY2VsZXJhdGVkX21vZGUgPSBkY2UxMTBfZW5hYmxlX2FjY2VsZXJhdGVkX21v
ZGUsCiAJLmVuYWJsZV90aW1pbmdfc3luY2hyb25pemF0aW9uID0gZGNuMTBfZW5hYmxlX3RpbWlu
Z19zeW5jaHJvbml6YXRpb24sCiAJLmVuYWJsZV9wZXJfZnJhbWVfY3J0Y19wb3NpdGlvbl9yZXNl
dCA9IGRjbjEwX2VuYWJsZV9wZXJfZnJhbWVfY3J0Y19wb3NpdGlvbl9yZXNldCwKQEAgLTUzLDE0
ICs0NywxMCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGh3X3NlcXVlbmNlcl9mdW5jcyBkY24xMF9m
dW5jcyA9IHsKIAkuYmxhbmtfc3RyZWFtID0gZGNlMTEwX2JsYW5rX3N0cmVhbSwKIAkuZW5hYmxl
X2F1ZGlvX3N0cmVhbSA9IGRjZTExMF9lbmFibGVfYXVkaW9fc3RyZWFtLAogCS5kaXNhYmxlX2F1
ZGlvX3N0cmVhbSA9IGRjZTExMF9kaXNhYmxlX2F1ZGlvX3N0cmVhbSwKLQkuZW5hYmxlX2Rpc3Bs
YXlfcG93ZXJfZ2F0aW5nID0gZGNuMTBfZHVtbXlfZGlzcGxheV9wb3dlcl9nYXRpbmcsCiAJLmRp
c2FibGVfcGxhbmUgPSBkY24xMF9kaXNhYmxlX3BsYW5lLAotCS5ibGFua19waXhlbF9kYXRhID0g
ZGNuMTBfYmxhbmtfcGl4ZWxfZGF0YSwKIAkucGlwZV9jb250cm9sX2xvY2sgPSBkY24xMF9waXBl
X2NvbnRyb2xfbG9jaywKIAkucHJlcGFyZV9iYW5kd2lkdGggPSBkY24xMF9wcmVwYXJlX2JhbmR3
aWR0aCwKIAkub3B0aW1pemVfYmFuZHdpZHRoID0gZGNuMTBfb3B0aW1pemVfYmFuZHdpZHRoLAot
CS5yZXNldF9od19jdHhfd3JhcCA9IGRjbjEwX3Jlc2V0X2h3X2N0eF93cmFwLAotCS5lbmFibGVf
c3RyZWFtX3RpbWluZyA9IGRjbjEwX2VuYWJsZV9zdHJlYW1fdGltaW5nLAogCS5zZXRfZHJyID0g
ZGNuMTBfc2V0X2RyciwKIAkuZ2V0X3Bvc2l0aW9uID0gZGNuMTBfZ2V0X3Bvc2l0aW9uLAogCS5z
ZXRfc3RhdGljX3NjcmVlbl9jb250cm9sID0gZGNuMTBfc2V0X3N0YXRpY19zY3JlZW5fY29udHJv
bCwKQEAgLTcwLDE4ICs2MCwzNCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGh3X3NlcXVlbmNlcl9m
dW5jcyBkY24xMF9mdW5jcyA9IHsKIAkuZ2V0X2h3X3N0YXRlID0gZGNuMTBfZ2V0X2h3X3N0YXRl
LAogCS5jbGVhcl9zdGF0dXNfYml0cyA9IGRjbjEwX2NsZWFyX3N0YXR1c19iaXRzLAogCS53YWl0
X2Zvcl9tcGNjX2Rpc2Nvbm5lY3QgPSBkY24xMF93YWl0X2Zvcl9tcGNjX2Rpc2Nvbm5lY3QsCi0J
LmVkcF9iYWNrbGlnaHRfY29udHJvbCA9IGRjZTExMF9lZHBfYmFja2xpZ2h0X2NvbnRyb2wsCiAJ
LmVkcF9wb3dlcl9jb250cm9sID0gZGNlMTEwX2VkcF9wb3dlcl9jb250cm9sLAogCS5lZHBfd2Fp
dF9mb3JfaHBkX3JlYWR5ID0gZGNlMTEwX2VkcF93YWl0X2Zvcl9ocGRfcmVhZHksCiAJLnNldF9j
dXJzb3JfcG9zaXRpb24gPSBkY24xMF9zZXRfY3Vyc29yX3Bvc2l0aW9uLAogCS5zZXRfY3Vyc29y
X2F0dHJpYnV0ZSA9IGRjbjEwX3NldF9jdXJzb3JfYXR0cmlidXRlLAogCS5zZXRfY3Vyc29yX3Nk
cl93aGl0ZV9sZXZlbCA9IGRjbjEwX3NldF9jdXJzb3Jfc2RyX3doaXRlX2xldmVsLAotCS5kaXNh
YmxlX3N0cmVhbV9nYXRpbmcgPSBOVUxMLAotCS5lbmFibGVfc3RyZWFtX2dhdGluZyA9IE5VTEws
CiAJLnNldHVwX3BlcmlvZGljX2ludGVycnVwdCA9IGRjbjEwX3NldHVwX3BlcmlvZGljX2ludGVy
cnVwdCwKLQkuc2V0dXBfdnVwZGF0ZV9pbnRlcnJ1cHQgPSBkY24xMF9zZXR1cF92dXBkYXRlX2lu
dGVycnVwdCwKIAkuc2V0X2Nsb2NrID0gZGNuMTBfc2V0X2Nsb2NrLAogCS5nZXRfY2xvY2sgPSBk
Y24xMF9nZXRfY2xvY2ssCisJLmdldF92dXBkYXRlX29mZnNldF9mcm9tX3ZzeW5jID0gZGNuMTBf
Z2V0X3Z1cGRhdGVfb2Zmc2V0X2Zyb21fdnN5bmMsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0
IGh3c2VxX3ByaXZhdGVfZnVuY3MgZGNuMTBfcHJpdmF0ZV9mdW5jcyA9IHsKKwkuaW5pdF9waXBl
cyA9IGRjbjEwX2luaXRfcGlwZXMsCisJLnVwZGF0ZV9wbGFuZV9hZGRyID0gZGNuMTBfdXBkYXRl
X3BsYW5lX2FkZHIsCisJLnBsYW5lX2F0b21pY19kaXNjb25uZWN0ID0gZGNuMTBfcGxhbmVfYXRv
bWljX2Rpc2Nvbm5lY3QsCisJLnByb2dyYW1fcGlwZSA9IGRjbjEwX3Byb2dyYW1fcGlwZSwKKwku
dXBkYXRlX21wY2MgPSBkY24xMF91cGRhdGVfbXBjYywKKwkuc2V0X2lucHV0X3RyYW5zZmVyX2Z1
bmMgPSBkY24xMF9zZXRfaW5wdXRfdHJhbnNmZXJfZnVuYywKKwkuc2V0X291dHB1dF90cmFuc2Zl
cl9mdW5jID0gZGNuMTBfc2V0X291dHB1dF90cmFuc2Zlcl9mdW5jLAorCS5wb3dlcl9kb3duID0g
ZGNlMTEwX3Bvd2VyX2Rvd24sCisJLmVuYWJsZV9kaXNwbGF5X3Bvd2VyX2dhdGluZyA9IGRjbjEw
X2R1bW15X2Rpc3BsYXlfcG93ZXJfZ2F0aW5nLAorCS5ibGFua19waXhlbF9kYXRhID0gZGNuMTBf
YmxhbmtfcGl4ZWxfZGF0YSwKKwkucmVzZXRfaHdfY3R4X3dyYXAgPSBkY24xMF9yZXNldF9od19j
dHhfd3JhcCwKKwkuZW5hYmxlX3N0cmVhbV90aW1pbmcgPSBkY24xMF9lbmFibGVfc3RyZWFtX3Rp
bWluZywKKwkuZWRwX2JhY2tsaWdodF9jb250cm9sID0gZGNlMTEwX2VkcF9iYWNrbGlnaHRfY29u
dHJvbCwKKwkuZGlzYWJsZV9zdHJlYW1fZ2F0aW5nID0gTlVMTCwKKwkuZW5hYmxlX3N0cmVhbV9n
YXRpbmcgPSBOVUxMLAorCS5zZXR1cF92dXBkYXRlX2ludGVycnVwdCA9IGRjbjEwX3NldHVwX3Z1
cGRhdGVfaW50ZXJydXB0LAogCS5kaWRfdW5kZXJmbG93X29jY3VyID0gZGNuMTBfZGlkX3VuZGVy
Zmxvd19vY2N1ciwKIAkuaW5pdF9ibGFuayA9IE5VTEwsCiAJLmRpc2FibGVfdmdhID0gZGNuMTBf
ZGlzYWJsZV92Z2EsCkBAIC05NiwxMCArMTAyLDEwIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaHdf
c2VxdWVuY2VyX2Z1bmNzIGRjbjEwX2Z1bmNzID0gewogCS5nZXRfaGRyX3Zpc3VhbF9jb25maXJt
X2NvbG9yID0gZGNuMTBfZ2V0X2hkcl92aXN1YWxfY29uZmlybV9jb2xvciwKIAkuc2V0X2hkcl9t
dWx0aXBsaWVyID0gZGNuMTBfc2V0X2hkcl9tdWx0aXBsaWVyLAogCS52ZXJpZnlfYWxsb3dfcHN0
YXRlX2NoYW5nZV9oaWdoID0gZGNuMTBfdmVyaWZ5X2FsbG93X3BzdGF0ZV9jaGFuZ2VfaGlnaCwK
LQkuZ2V0X3Z1cGRhdGVfb2Zmc2V0X2Zyb21fdnN5bmMgPSBkY24xMF9nZXRfdnVwZGF0ZV9vZmZz
ZXRfZnJvbV92c3luYywKIH07CiAKIHZvaWQgZGNuMTBfaHdfc2VxdWVuY2VyX2NvbnN0cnVjdChz
dHJ1Y3QgZGMgKmRjKQogewogCWRjLT5od3NzID0gZGNuMTBfZnVuY3M7CisJZGMtPmh3c2VxLT5m
dW5jcyA9IGRjbjEwX3ByaXZhdGVfZnVuY3M7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHdzZXEuYyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9od3NlcS5jCmluZGV4IDAzZTRhYWZiMjM3Yi4uODA5
MWM3YzFlMGQwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNu
MjAvZGNuMjBfaHdzZXEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNu
MjAvZGNuMjBfaHdzZXEuYwpAQCAtMjcyLDYgKzI3Miw3IEBAIHZvaWQgZGNuMjBfaW5pdF9ibGFu
aygKIAkJc3RydWN0IGRjICpkYywKIAkJc3RydWN0IHRpbWluZ19nZW5lcmF0b3IgKnRnKQogewor
CXN0cnVjdCBkY2VfaHdzZXEgKmh3cyA9IGRjLT5od3NlcTsKIAllbnVtIGRjX2NvbG9yX3NwYWNl
IGNvbG9yX3NwYWNlOwogCXN0cnVjdCB0Z19jb2xvciBibGFja19jb2xvciA9IHswfTsKIAlzdHJ1
Y3Qgb3V0cHV0X3BpeGVsX3Byb2Nlc3NvciAqb3BwID0gTlVMTDsKQEAgLTMxOSw3ICszMjAsNyBA
QCB2b2lkIGRjbjIwX2luaXRfYmxhbmsoCiAJCQkJb3RnX2FjdGl2ZV9oZWlnaHQpOwogCX0KIAot
CWRjLT5od3NzLndhaXRfZm9yX2JsYW5rX2NvbXBsZXRlKG9wcCk7CisJaHdzLT5mdW5jcy53YWl0
X2Zvcl9ibGFua19jb21wbGV0ZShvcHApOwogfQogCiB2b2lkIGRjbjIwX2RzY19wZ19jb250cm9s
KApAQCAtNTUyLDYgKzU1Myw3IEBAIHZvaWQgZGNuMjBfaHVicF9wZ19jb250cm9sKAogICovCiB2
b2lkIGRjbjIwX3BsYW5lX2F0b21pY19kaXNhYmxlKHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBwaXBl
X2N0eCAqcGlwZV9jdHgpCiB7CisJc3RydWN0IGRjZV9od3NlcSAqaHdzID0gZGMtPmh3c2VxOwog
CXN0cnVjdCBodWJwICpodWJwID0gcGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwOwogCXN0cnVjdCBk
cHAgKmRwcCA9IHBpcGVfY3R4LT5wbGFuZV9yZXMuZHBwOwogCkBAIC01NzIsNyArNTc0LDcgQEAg
dm9pZCBkY24yMF9wbGFuZV9hdG9taWNfZGlzYWJsZShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlw
ZV9jdHggKnBpcGVfY3R4KQogCWh1YnAtPnBvd2VyX2dhdGVkID0gdHJ1ZTsKIAlkYy0+b3B0aW1p
emVkX3JlcXVpcmVkID0gZmFsc2U7IC8qIFdlJ3JlIHBvd2VyaW5nIG9mZiwgbm8gbmVlZCB0byBv
cHRpbWl6ZSAqLwogCi0JZGMtPmh3c3MucGxhbmVfYXRvbWljX3Bvd2VyX2Rvd24oZGMsCisJaHdz
LT5mdW5jcy5wbGFuZV9hdG9taWNfcG93ZXJfZG93bihkYywKIAkJCXBpcGVfY3R4LT5wbGFuZV9y
ZXMuZHBwLAogCQkJcGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwKTsKIApAQCAtNjAzLDYgKzYwNSw3
IEBAIGVudW0gZGNfc3RhdHVzIGRjbjIwX2VuYWJsZV9zdHJlYW1fdGltaW5nKAogCQlzdHJ1Y3Qg
ZGNfc3RhdGUgKmNvbnRleHQsCiAJCXN0cnVjdCBkYyAqZGMpCiB7CisJc3RydWN0IGRjZV9od3Nl
cSAqaHdzID0gZGMtPmh3c2VxOwogCXN0cnVjdCBkY19zdHJlYW1fc3RhdGUgKnN0cmVhbSA9IHBp
cGVfY3R4LT5zdHJlYW07CiAJc3RydWN0IGRycl9wYXJhbXMgcGFyYW1zID0gezB9OwogCXVuc2ln
bmVkIGludCBldmVudF90cmlnZ2VycyA9IDA7CkBAIC02NjIsNyArNjY1LDcgQEAgZW51bSBkY19z
dGF0dXMgZGNuMjBfZW5hYmxlX3N0cmVhbV90aW1pbmcoCiAJCQlwaXBlX2N0eC0+c3RyZWFtX3Jl
cy5vcHAsCiAJCQl0cnVlKTsKIAotCWRjLT5od3NzLmJsYW5rX3BpeGVsX2RhdGEoZGMsIHBpcGVf
Y3R4LCB0cnVlKTsKKwlod3MtPmZ1bmNzLmJsYW5rX3BpeGVsX2RhdGEoZGMsIHBpcGVfY3R4LCB0
cnVlKTsKIAogCS8qIFZURyBpcyAgd2l0aGluIERDSFVCIGNvbW1hbmQgYmxvY2suIERDRkNMSyBp
cyBhbHdheXMgb24gKi8KIAlpZiAoZmFsc2UgPT0gcGlwZV9jdHgtPnN0cmVhbV9yZXMudGctPmZ1
bmNzLT5lbmFibGVfY3J0YyhwaXBlX2N0eC0+c3RyZWFtX3Jlcy50ZykpIHsKQEAgLTY3MCw3ICs2
NzMsNyBAQCBlbnVtIGRjX3N0YXR1cyBkY24yMF9lbmFibGVfc3RyZWFtX3RpbWluZygKIAkJcmV0
dXJuIERDX0VSUk9SX1VORVhQRUNURUQ7CiAJfQogCi0JZGMtPmh3c3Mud2FpdF9mb3JfYmxhbmtf
Y29tcGxldGUocGlwZV9jdHgtPnN0cmVhbV9yZXMub3BwKTsKKwlod3MtPmZ1bmNzLndhaXRfZm9y
X2JsYW5rX2NvbXBsZXRlKHBpcGVfY3R4LT5zdHJlYW1fcmVzLm9wcCk7CiAKIAlwYXJhbXMudmVy
dGljYWxfdG90YWxfbWluID0gc3RyZWFtLT5hZGp1c3Qudl90b3RhbF9taW47CiAJcGFyYW1zLnZl
cnRpY2FsX3RvdGFsX21heCA9IHN0cmVhbS0+YWRqdXN0LnZfdG90YWxfbWF4OwpAQCAtODIwLDYg
KzgyMyw3IEBAIGJvb2wgZGNuMjBfc2V0X2lucHV0X3RyYW5zZmVyX2Z1bmMoc3RydWN0IGRjICpk
YywKIAkJCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAogCQkJCWNvbnN0IHN0cnVjdCBkY19w
bGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCiB7CisJc3RydWN0IGRjZV9od3NlcSAqaHdzID0gZGMt
Pmh3c2VxOwogCXN0cnVjdCBkcHAgKmRwcF9iYXNlID0gcGlwZV9jdHgtPnBsYW5lX3Jlcy5kcHA7
CiAJY29uc3Qgc3RydWN0IGRjX3RyYW5zZmVyX2Z1bmMgKnRmID0gTlVMTDsKIAlib29sIHJlc3Vs
dCA9IHRydWU7CkBAIC04MjgsOCArODMyLDggQEAgYm9vbCBkY24yMF9zZXRfaW5wdXRfdHJhbnNm
ZXJfZnVuYyhzdHJ1Y3QgZGMgKmRjLAogCWlmIChkcHBfYmFzZSA9PSBOVUxMIHx8IHBsYW5lX3N0
YXRlID09IE5VTEwpCiAJCXJldHVybiBmYWxzZTsKIAotCWRjLT5od3NzLnNldF9zaGFwZXJfM2Rs
dXQocGlwZV9jdHgsIHBsYW5lX3N0YXRlKTsKLQlkYy0+aHdzcy5zZXRfYmxlbmRfbHV0KHBpcGVf
Y3R4LCBwbGFuZV9zdGF0ZSk7CisJaHdzLT5mdW5jcy5zZXRfc2hhcGVyXzNkbHV0KHBpcGVfY3R4
LCBwbGFuZV9zdGF0ZSk7CisJaHdzLT5mdW5jcy5zZXRfYmxlbmRfbHV0KHBpcGVfY3R4LCBwbGFu
ZV9zdGF0ZSk7CiAKIAlpZiAocGxhbmVfc3RhdGUtPmluX3RyYW5zZmVyX2Z1bmMpCiAJCXRmID0g
cGxhbmVfc3RhdGUtPmluX3RyYW5zZmVyX2Z1bmM7CkBAIC0xMjczLDYgKzEyNzcsNyBAQCBzdGF0
aWMgdm9pZCBkY24yMF91cGRhdGVfZGNodWJwX2RwcCgKIAlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVf
Y3R4LAogCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCkKIHsKKwlzdHJ1Y3QgZGNlX2h3c2VxICpo
d3MgPSBkYy0+aHdzZXE7CiAJc3RydWN0IGh1YnAgKmh1YnAgPSBwaXBlX2N0eC0+cGxhbmVfcmVz
Lmh1YnA7CiAJc3RydWN0IGRwcCAqZHBwID0gcGlwZV9jdHgtPnBsYW5lX3Jlcy5kcHA7CiAJc3Ry
dWN0IGRjX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSA9IHBpcGVfY3R4LT5wbGFuZV9zdGF0ZTsK
QEAgLTEzMzcsNyArMTM0Miw3IEBAIHN0YXRpYyB2b2lkIGRjbjIwX3VwZGF0ZV9kY2h1YnBfZHBw
KAogCQkJCW9sZF9waXBlX2N0eC0+c3RyZWFtX3Jlcy5vcHAtPm1wY2NfZGlzY29ubmVjdF9wZW5k
aW5nW21wY2NfaW5zdF0gPSBmYWxzZTsKIAkJCX0KIAkJfQotCQlkYy0+aHdzcy51cGRhdGVfbXBj
YyhkYywgcGlwZV9jdHgpOworCQlod3MtPmZ1bmNzLnVwZGF0ZV9tcGNjKGRjLCBwaXBlX2N0eCk7
CiAJfQogCiAJaWYgKHBpcGVfY3R4LT51cGRhdGVfZmxhZ3MuYml0cy5zY2FsZXIgfHwKQEAgLTE0
MTIsNyArMTQxNyw3IEBAIHN0YXRpYyB2b2lkIGRjbjIwX3VwZGF0ZV9kY2h1YnBfZHBwKAogCX0K
IAogCWlmIChwaXBlX2N0eC0+dXBkYXRlX2ZsYWdzLmJpdHMuZW5hYmxlIHx8IHBsYW5lX3N0YXRl
LT51cGRhdGVfZmxhZ3MuYml0cy5hZGRyX3VwZGF0ZSkKLQkJZGMtPmh3c3MudXBkYXRlX3BsYW5l
X2FkZHIoZGMsIHBpcGVfY3R4KTsKKwkJaHdzLT5mdW5jcy51cGRhdGVfcGxhbmVfYWRkcihkYywg
cGlwZV9jdHgpOwogCiAJaWYgKHBpcGVfY3R4LT51cGRhdGVfZmxhZ3MuYml0cy5lbmFibGUpCiAJ
CWh1YnAtPmZ1bmNzLT5zZXRfYmxhbmsoaHVicCwgZmFsc2UpOwpAQCAtMTQyNCwxMCArMTQyOSwx
MSBAQCBzdGF0aWMgdm9pZCBkY24yMF9wcm9ncmFtX3BpcGUoCiAJCXN0cnVjdCBwaXBlX2N0eCAq
cGlwZV9jdHgsCiAJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCkKIHsKKwlzdHJ1Y3QgZGNlX2h3
c2VxICpod3MgPSBkYy0+aHdzZXE7CiAJLyogT25seSBuZWVkIHRvIHVuYmxhbmsgb24gdG9wIHBp
cGUgKi8KIAlpZiAoKHBpcGVfY3R4LT51cGRhdGVfZmxhZ3MuYml0cy5lbmFibGUgfHwgcGlwZV9j
dHgtPnN0cmVhbS0+dXBkYXRlX2ZsYWdzLmJpdHMuYWJtX2xldmVsKQogCQkJJiYgIXBpcGVfY3R4
LT50b3BfcGlwZSAmJiAhcGlwZV9jdHgtPnByZXZfb2RtX3BpcGUpCi0JCWRjLT5od3NzLmJsYW5r
X3BpeGVsX2RhdGEoZGMsIHBpcGVfY3R4LCAhcGlwZV9jdHgtPnBsYW5lX3N0YXRlLT52aXNpYmxl
KTsKKwkJaHdzLT5mdW5jcy5ibGFua19waXhlbF9kYXRhKGRjLCBwaXBlX2N0eCwgIXBpcGVfY3R4
LT5wbGFuZV9zdGF0ZS0+dmlzaWJsZSk7CiAKIAlpZiAocGlwZV9jdHgtPnVwZGF0ZV9mbGFncy5i
aXRzLmdsb2JhbF9zeW5jKSB7CiAJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLT5mdW5jcy0+cHJv
Z3JhbV9nbG9iYWxfc3luYygKQEAgLTE0NDAsMTIgKzE0NDYsMTIgQEAgc3RhdGljIHZvaWQgZGNu
MjBfcHJvZ3JhbV9waXBlKAogCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+ZnVuY3MtPnNldF92
dGdfcGFyYW1zKAogCQkJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLCAmcGlwZV9jdHgtPnN0cmVh
bS0+dGltaW5nKTsKIAotCQlpZiAoZGMtPmh3c3Muc2V0dXBfdnVwZGF0ZV9pbnRlcnJ1cHQpCi0J
CQlkYy0+aHdzcy5zZXR1cF92dXBkYXRlX2ludGVycnVwdChkYywgcGlwZV9jdHgpOworCQlpZiAo
aHdzLT5mdW5jcy5zZXR1cF92dXBkYXRlX2ludGVycnVwdCkKKwkJCWh3cy0+ZnVuY3Muc2V0dXBf
dnVwZGF0ZV9pbnRlcnJ1cHQoZGMsIHBpcGVfY3R4KTsKIAl9CiAKIAlpZiAocGlwZV9jdHgtPnVw
ZGF0ZV9mbGFncy5iaXRzLm9kbSkKLQkJZGMtPmh3c3MudXBkYXRlX29kbShkYywgY29udGV4dCwg
cGlwZV9jdHgpOworCQlod3MtPmZ1bmNzLnVwZGF0ZV9vZG0oZGMsIGNvbnRleHQsIHBpcGVfY3R4
KTsKIAogCWlmIChwaXBlX2N0eC0+dXBkYXRlX2ZsYWdzLmJpdHMuZW5hYmxlKQogCQlkY24yMF9l
bmFibGVfcGxhbmUoZGMsIHBpcGVfY3R4LCBjb250ZXh0KTsKQEAgLTE0NTUsMTkgKzE0NjEsMTkg
QEAgc3RhdGljIHZvaWQgZGNuMjBfcHJvZ3JhbV9waXBlKAogCiAJaWYgKHBpcGVfY3R4LT51cGRh
dGVfZmxhZ3MuYml0cy5lbmFibGUKIAkJCXx8IHBpcGVfY3R4LT5wbGFuZV9zdGF0ZS0+dXBkYXRl
X2ZsYWdzLmJpdHMuaGRyX211bHQpCi0JCWRjLT5od3NzLnNldF9oZHJfbXVsdGlwbGllcihwaXBl
X2N0eCk7CisJCWh3cy0+ZnVuY3Muc2V0X2hkcl9tdWx0aXBsaWVyKHBpcGVfY3R4KTsKIAogCWlm
IChwaXBlX2N0eC0+dXBkYXRlX2ZsYWdzLmJpdHMuZW5hYmxlIHx8CiAJCQlwaXBlX2N0eC0+cGxh
bmVfc3RhdGUtPnVwZGF0ZV9mbGFncy5iaXRzLmluX3RyYW5zZmVyX2Z1bmNfY2hhbmdlIHx8CiAJ
CQlwaXBlX2N0eC0+cGxhbmVfc3RhdGUtPnVwZGF0ZV9mbGFncy5iaXRzLmdhbW1hX2NoYW5nZSkK
LQkJZGMtPmh3c3Muc2V0X2lucHV0X3RyYW5zZmVyX2Z1bmMoZGMsIHBpcGVfY3R4LCBwaXBlX2N0
eC0+cGxhbmVfc3RhdGUpOworCQlod3MtPmZ1bmNzLnNldF9pbnB1dF90cmFuc2Zlcl9mdW5jKGRj
LCBwaXBlX2N0eCwgcGlwZV9jdHgtPnBsYW5lX3N0YXRlKTsKIAogCS8qIGRjbjEwX3RyYW5zbGF0
ZV9yZWdhbW1hX3RvX2h3X2Zvcm1hdCB0YWtlcyA3NTB1cyB0byBmaW5pc2gKIAkgKiBvbmx5IGRv
IGdhbW1hIHByb2dyYW1taW5nIGZvciBwb3dlcmluZyBvbiwgaW50ZXJuYWwgbWVtY21wIHRvIGF2
b2lkCiAJICogdXBkYXRpbmcgb24gc2xhdmUgcGxhbmVzCiAJICovCiAJaWYgKHBpcGVfY3R4LT51
cGRhdGVfZmxhZ3MuYml0cy5lbmFibGUgfHwgcGlwZV9jdHgtPnN0cmVhbS0+dXBkYXRlX2ZsYWdz
LmJpdHMub3V0X3RmKQotCQlkYy0+aHdzcy5zZXRfb3V0cHV0X3RyYW5zZmVyX2Z1bmMoZGMsIHBp
cGVfY3R4LCBwaXBlX2N0eC0+c3RyZWFtKTsKKwkJaHdzLT5mdW5jcy5zZXRfb3V0cHV0X3RyYW5z
ZmVyX2Z1bmMoZGMsIHBpcGVfY3R4LCBwaXBlX2N0eC0+c3RyZWFtKTsKIAogCS8qIElmIHRoZSBw
aXBlIGhhcyBiZWVuIGVuYWJsZWQgb3IgaGFzIGEgZGlmZmVyZW50IG9wcCwgd2UKIAkgKiBzaG91
bGQgcmVwcm9ncmFtIHRoZSBmbXQuIFRoaXMgZGVhbHMgd2l0aCBjYXNlcyB3aGVyZQpAQCAtMTUw
Nyw2ICsxNTEzLDcgQEAgdm9pZCBkY24yMF9wcm9ncmFtX2Zyb250X2VuZF9mb3JfY3R4KAogewog
CWNvbnN0IHVuc2lnbmVkIGludCBUSU1FT1VUX0ZPUl9QSVBFX0VOQUJMRV9NUyA9IDEwMDsKIAlp
bnQgaTsKKwlzdHJ1Y3QgZGNlX2h3c2VxICpod3MgPSBkYy0+aHdzZXE7CiAJYm9vbCBwaXBlX2xv
Y2tlZFtNQVhfUElQRVNdID0ge2ZhbHNlfTsKIAlEQ19MT0dHRVJfSU5JVChkYy0+Y3R4LT5sb2dn
ZXIpOwogCkBAIC0xNTM4LDEzICsxNTQ1LDEzIEBAIHZvaWQgZGNuMjBfcHJvZ3JhbV9mcm9udF9l
bmRfZm9yX2N0eCgKIAkJCQkmJiAhY29udGV4dC0+cmVzX2N0eC5waXBlX2N0eFtpXS50b3BfcGlw
ZQogCQkJCSYmICFjb250ZXh0LT5yZXNfY3R4LnBpcGVfY3R4W2ldLnByZXZfb2RtX3BpcGUKIAkJ
CQkmJiBjb250ZXh0LT5yZXNfY3R4LnBpcGVfY3R4W2ldLnN0cmVhbSkKLQkJCWRjLT5od3NzLmJs
YW5rX3BpeGVsX2RhdGEoZGMsICZjb250ZXh0LT5yZXNfY3R4LnBpcGVfY3R4W2ldLCB0cnVlKTsK
KwkJCWh3cy0+ZnVuY3MuYmxhbmtfcGl4ZWxfZGF0YShkYywgJmNvbnRleHQtPnJlc19jdHgucGlw
ZV9jdHhbaV0sIHRydWUpOwogCiAJLyogRGlzY29ubmVjdCBtcGNjICovCiAJZm9yIChpID0gMDsg
aSA8IGRjLT5yZXNfcG9vbC0+cGlwZV9jb3VudDsgaSsrKQogCQlpZiAoY29udGV4dC0+cmVzX2N0
eC5waXBlX2N0eFtpXS51cGRhdGVfZmxhZ3MuYml0cy5kaXNhYmxlCiAJCQkJfHwgY29udGV4dC0+
cmVzX2N0eC5waXBlX2N0eFtpXS51cGRhdGVfZmxhZ3MuYml0cy5vcHBfY2hhbmdlZCkgewotCQkJ
ZGMtPmh3c3MucGxhbmVfYXRvbWljX2Rpc2Nvbm5lY3QoZGMsICZkYy0+Y3VycmVudF9zdGF0ZS0+
cmVzX2N0eC5waXBlX2N0eFtpXSk7CisJCQlod3MtPmZ1bmNzLnBsYW5lX2F0b21pY19kaXNjb25u
ZWN0KGRjLCAmZGMtPmN1cnJlbnRfc3RhdGUtPnJlc19jdHgucGlwZV9jdHhbaV0pOwogCQkJRENf
TE9HX0RDKCJSZXNldCBtcGNjIGZvciBwaXBlICVkXG4iLCBkYy0+Y3VycmVudF9zdGF0ZS0+cmVz
X2N0eC5waXBlX2N0eFtpXS5waXBlX2lkeCk7CiAJCX0KIApAQCAtMTU2NCw4ICsxNTcxLDggQEAg
dm9pZCBkY24yMF9wcm9ncmFtX2Zyb250X2VuZF9mb3JfY3R4KAogCQkJcGlwZSA9ICZjb250ZXh0
LT5yZXNfY3R4LnBpcGVfY3R4W2ldOwogCQkJaWYgKCFwaXBlLT5wcmV2X29kbV9waXBlICYmIHBp
cGUtPnN0cmVhbS0+bnVtX3diX2luZm8gPiAwCiAJCQkJCSYmIChwaXBlLT51cGRhdGVfZmxhZ3Mu
cmF3IHx8IHBpcGUtPnBsYW5lX3N0YXRlLT51cGRhdGVfZmxhZ3MucmF3IHx8IHBpcGUtPnN0cmVh
bS0+dXBkYXRlX2ZsYWdzLnJhdykKLQkJCQkJJiYgZGMtPmh3c3MucHJvZ3JhbV9hbGxfd3JpdGVi
YWNrX3BpcGVzX2luX3RyZWUpCi0JCQkJZGMtPmh3c3MucHJvZ3JhbV9hbGxfd3JpdGViYWNrX3Bp
cGVzX2luX3RyZWUoZGMsIHBpcGUtPnN0cmVhbSwgY29udGV4dCk7CisJCQkJCSYmIGh3cy0+ZnVu
Y3MucHJvZ3JhbV9hbGxfd3JpdGViYWNrX3BpcGVzX2luX3RyZWUpCisJCQkJaHdzLT5mdW5jcy5w
cm9ncmFtX2FsbF93cml0ZWJhY2tfcGlwZXNfaW5fdHJlZShkYywgcGlwZS0+c3RyZWFtLCBjb250
ZXh0KTsKIAkJfQogCX0KIApAQCAtMTY1MCw2ICsxNjU3LDcgQEAgYm9vbCBkY24yMF91cGRhdGVf
YmFuZHdpZHRoKAogCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpCiB7CiAJaW50IGk7CisJc3Ry
dWN0IGRjZV9od3NlcSAqaHdzID0gZGMtPmh3c2VxOwogCiAJLyogcmVjYWxjdWxhdGUgRE1MIHBh
cmFtZXRlcnMgKi8KIAlpZiAoIWRjLT5yZXNfcG9vbC0+ZnVuY3MtPnZhbGlkYXRlX2JhbmR3aWR0
aChkYywgY29udGV4dCwgZmFsc2UpKQpAQCAtMTY3OSwxMCArMTY4NywxMCBAQCBib29sIGRjbjIw
X3VwZGF0ZV9iYW5kd2lkdGgoCiAJCQkJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLCAmcGlwZV9j
dHgtPnN0cmVhbS0+dGltaW5nKTsKIAogCQkJaWYgKHBpcGVfY3R4LT5wcmV2X29kbV9waXBlID09
IE5VTEwpCi0JCQkJZGMtPmh3c3MuYmxhbmtfcGl4ZWxfZGF0YShkYywgcGlwZV9jdHgsIGJsYW5r
KTsKKwkJCQlod3MtPmZ1bmNzLmJsYW5rX3BpeGVsX2RhdGEoZGMsIHBpcGVfY3R4LCBibGFuayk7
CiAKLQkJCWlmIChkYy0+aHdzcy5zZXR1cF92dXBkYXRlX2ludGVycnVwdCkKLQkJCQlkYy0+aHdz
cy5zZXR1cF92dXBkYXRlX2ludGVycnVwdChkYywgcGlwZV9jdHgpOworCQkJaWYgKGh3cy0+ZnVu
Y3Muc2V0dXBfdnVwZGF0ZV9pbnRlcnJ1cHQpCisJCQkJaHdzLT5mdW5jcy5zZXR1cF92dXBkYXRl
X2ludGVycnVwdChkYywgcGlwZV9jdHgpOwogCQl9CiAKIAkJcGlwZV9jdHgtPnBsYW5lX3Jlcy5o
dWJwLT5mdW5jcy0+aHVicF9zZXR1cCgKQEAgLTE5MTksNiArMTkyNyw3IEBAIHZvaWQgZGNuMjBf
dW5ibGFua19zdHJlYW0oc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKIAlzdHJ1Y3QgZW5jb2Rl
cl91bmJsYW5rX3BhcmFtIHBhcmFtcyA9IHsgeyAwIH0gfTsKIAlzdHJ1Y3QgZGNfc3RyZWFtX3N0
YXRlICpzdHJlYW0gPSBwaXBlX2N0eC0+c3RyZWFtOwogCXN0cnVjdCBkY19saW5rICpsaW5rID0g
c3RyZWFtLT5saW5rOworCXN0cnVjdCBkY2VfaHdzZXEgKmh3cyA9IGxpbmstPmRjLT5od3NlcTsK
IAlzdHJ1Y3QgcGlwZV9jdHggKm9kbV9waXBlOwogCiAJcGFyYW1zLm9wcF9jbnQgPSAxOwpAQCAt
MTkzOSw3ICsxOTQ4LDcgQEAgdm9pZCBkY24yMF91bmJsYW5rX3N0cmVhbShzdHJ1Y3QgcGlwZV9j
dHggKnBpcGVfY3R4LAogCX0KIAogCWlmIChsaW5rLT5sb2NhbF9zaW5rICYmIGxpbmstPmxvY2Fs
X3NpbmstPnNpbmtfc2lnbmFsID09IFNJR05BTF9UWVBFX0VEUCkgewotCQlsaW5rLT5kYy0+aHdz
cy5lZHBfYmFja2xpZ2h0X2NvbnRyb2wobGluaywgdHJ1ZSk7CisJCWh3cy0+ZnVuY3MuZWRwX2Jh
Y2tsaWdodF9jb250cm9sKGxpbmssIHRydWUpOwogCX0KIH0KIApAQCAtMjAyNyw2ICsyMDM2LDcg
QEAgdm9pZCBkY24yMF9yZXNldF9od19jdHhfd3JhcCgKIAkJc3RydWN0IGRjX3N0YXRlICpjb250
ZXh0KQogewogCWludCBpOworCXN0cnVjdCBkY2VfaHdzZXEgKmh3cyA9IGRjLT5od3NlcTsKIAog
CS8qIFJlc2V0IEJhY2sgRW5kKi8KIAlmb3IgKGkgPSBkYy0+cmVzX3Bvb2wtPnBpcGVfY291bnQg
LSAxOyBpID49IDAgOyBpLS0pIHsKQEAgLTIwNDUsOCArMjA1NSw4IEBAIHZvaWQgZGNuMjBfcmVz
ZXRfaHdfY3R4X3dyYXAoCiAJCQlzdHJ1Y3QgY2xvY2tfc291cmNlICpvbGRfY2xrID0gcGlwZV9j
dHhfb2xkLT5jbG9ja19zb3VyY2U7CiAKIAkJCWRjbjIwX3Jlc2V0X2JhY2tfZW5kX2Zvcl9waXBl
KGRjLCBwaXBlX2N0eF9vbGQsIGRjLT5jdXJyZW50X3N0YXRlKTsKLQkJCWlmIChkYy0+aHdzcy5l
bmFibGVfc3RyZWFtX2dhdGluZykKLQkJCQlkYy0+aHdzcy5lbmFibGVfc3RyZWFtX2dhdGluZyhk
YywgcGlwZV9jdHgpOworCQkJaWYgKGh3cy0+ZnVuY3MuZW5hYmxlX3N0cmVhbV9nYXRpbmcpCisJ
CQkJaHdzLT5mdW5jcy5lbmFibGVfc3RyZWFtX2dhdGluZyhkYywgcGlwZV9jdHgpOwogCQkJaWYg
KG9sZF9jbGspCiAJCQkJb2xkX2Nsay0+ZnVuY3MtPmNzX3Bvd2VyX2Rvd24ob2xkX2Nsayk7CiAJ
CX0KQEAgLTIwNzcsNiArMjA4Nyw3IEBAIHZvaWQgZGNuMjBfZ2V0X21wY3RyZWVfdmlzdWFsX2Nv
bmZpcm1fY29sb3IoCiAKIHZvaWQgZGNuMjBfdXBkYXRlX21wY2Moc3RydWN0IGRjICpkYywgc3Ry
dWN0IHBpcGVfY3R4ICpwaXBlX2N0eCkKIHsKKwlzdHJ1Y3QgZGNlX2h3c2VxICpod3MgPSBkYy0+
aHdzZXE7CiAJc3RydWN0IGh1YnAgKmh1YnAgPSBwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnA7CiAJ
c3RydWN0IG1wY2NfYmxuZF9jZmcgYmxuZF9jZmcgPSB7IHswfSB9OwogCWJvb2wgcGVyX3BpeGVs
X2FscGhhID0gcGlwZV9jdHgtPnBsYW5lX3N0YXRlLT5wZXJfcGl4ZWxfYWxwaGE7CkBAIC0yMDg3
LDEwICsyMDk4LDEwIEBAIHZvaWQgZGNuMjBfdXBkYXRlX21wY2Moc3RydWN0IGRjICpkYywgc3Ry
dWN0IHBpcGVfY3R4ICpwaXBlX2N0eCkKIAogCS8vIGlucHV0IHRvIE1QQ0MgaXMgYWx3YXlzIFJH
QiwgYnkgZGVmYXVsdCBsZWF2ZSBibGFja19jb2xvciBhdCAwCiAJaWYgKGRjLT5kZWJ1Zy52aXN1
YWxfY29uZmlybSA9PSBWSVNVQUxfQ09ORklSTV9IRFIpIHsKLQkJZGMtPmh3c3MuZ2V0X2hkcl92
aXN1YWxfY29uZmlybV9jb2xvcigKKwkJaHdzLT5mdW5jcy5nZXRfaGRyX3Zpc3VhbF9jb25maXJt
X2NvbG9yKAogCQkJCXBpcGVfY3R4LCAmYmxuZF9jZmcuYmxhY2tfY29sb3IpOwogCX0gZWxzZSBp
ZiAoZGMtPmRlYnVnLnZpc3VhbF9jb25maXJtID09IFZJU1VBTF9DT05GSVJNX1NVUkZBQ0UpIHsK
LQkJZGMtPmh3c3MuZ2V0X3N1cmZhY2VfdmlzdWFsX2NvbmZpcm1fY29sb3IoCisJCWh3cy0+ZnVu
Y3MuZ2V0X3N1cmZhY2VfdmlzdWFsX2NvbmZpcm1fY29sb3IoCiAJCQkJcGlwZV9jdHgsICZibG5k
X2NmZy5ibGFja19jb2xvcik7CiAJfSBlbHNlIGlmIChkYy0+ZGVidWcudmlzdWFsX2NvbmZpcm0g
PT0gVklTVUFMX0NPTkZJUk1fTVBDVFJFRSkgewogCQlkY24yMF9nZXRfbXBjdHJlZV92aXN1YWxf
Y29uZmlybV9jb2xvcigKQEAgLTIyNDYsMTMgKzIyNTcsMTMgQEAgdm9pZCBkY24yMF9mcGdhX2lu
aXRfaHcoc3RydWN0IGRjICpkYykKIAkJcmVzX3Bvb2wtPmRjY2ctPmZ1bmNzLT5kY2NnX2luaXQo
cmVzX3Bvb2wtPmRjY2cpOwogCiAJLy9FbmFibGUgYWJpbGl0eSB0byBwb3dlciBnYXRlIC8gZG9u
J3QgZm9yY2UgcG93ZXIgb24gcGVybWFuZW50bHkKLQlkYy0+aHdzcy5lbmFibGVfcG93ZXJfZ2F0
aW5nX3BsYW5lKGh3cywgdHJ1ZSk7CisJaHdzLT5mdW5jcy5lbmFibGVfcG93ZXJfZ2F0aW5nX3Bs
YW5lKGh3cywgdHJ1ZSk7CiAKIAkvLyBTcGVjaWZpYyB0byBGUEdBIGRjY2cgYW5kIHJlZ2lzdGVy
cwogCVJFR19XUklURShSQkJNSUZfVElNRU9VVF9ESVMsIDB4RkZGRkZGRkYpOwogCVJFR19XUklU
RShSQkJNSUZfVElNRU9VVF9ESVNfMiwgMHhGRkZGRkZGRik7CiAKLQlkYy0+aHdzcy5kY2NnX2lu
aXQoaHdzKTsKKwlod3MtPmZ1bmNzLmRjY2dfaW5pdChod3MpOwogCiAJUkVHX1VQREFURShEQ0hV
QkJVQl9HTE9CQUxfVElNRVJfQ05UTCwgRENIVUJCVUJfR0xPQkFMX1RJTUVSX1JFRkRJViwgMik7
CiAJUkVHX1VQREFURShEQ0hVQkJVQl9HTE9CQUxfVElNRVJfQ05UTCwgRENIVUJCVUJfR0xPQkFM
X1RJTUVSX0VOQUJMRSwgMSk7CkBAIC0yMzE2LDcgKzIzMjcsNyBAQCB2b2lkIGRjbjIwX2ZwZ2Ff
aW5pdF9odyhzdHJ1Y3QgZGMgKmRjKQogCQlkYy0+cmVzX3Bvb2wtPm9wcHNbaV0tPm1wY2NfZGlz
Y29ubmVjdF9wZW5kaW5nW3BpcGVfY3R4LT5wbGFuZV9yZXMubXBjY19pbnN0XSA9IHRydWU7CiAJ
CXBpcGVfY3R4LT5zdHJlYW1fcmVzLm9wcCA9IGRjLT5yZXNfcG9vbC0+b3Bwc1tpXTsKIAkJLyp0
byBkbyovCi0JCWRjLT5od3NzLnBsYW5lX2F0b21pY19kaXNjb25uZWN0KGRjLCBwaXBlX2N0eCk7
CisJCWh3cy0+ZnVuY3MucGxhbmVfYXRvbWljX2Rpc2Nvbm5lY3QoZGMsIHBpcGVfY3R4KTsKIAl9
CiAKIAkvKiBpbml0aWFsaXplIERXQiBwb2ludGVyIHRvIE1DSUZfV0IgKi8KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9od3NlcS5oIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h3c2VxLmgKaW5kZXggMjhh
YWNlZWQ2ZDhiLi5lZWNkN2EyNmVjNGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kY24yMC9kY24yMF9od3NlcS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kY24yMC9kY24yMF9od3NlcS5oCkBAIC0yNiw2ICsyNiw4IEBACiAjaWZuZGVm
IF9fRENfSFdTU19EQ04yMF9IX18KICNkZWZpbmUgX19EQ19IV1NTX0RDTjIwX0hfXwogCisjaW5j
bHVkZSAiaHdfc2VxdWVuY2VyX3ByaXZhdGUuaCIKKwogYm9vbCBkY24yMF9zZXRfYmxlbmRfbHV0
KAogCXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsIGNvbnN0IHN0cnVjdCBkY19wbGFuZV9zdGF0
ZSAqcGxhbmVfc3RhdGUpOwogYm9vbCBkY24yMF9zZXRfc2hhcGVyXzNkbHV0KApAQCAtMTExLDYg
KzExMyw3IEBAIHZvaWQgZGNuMjBfZGlzYWJsZV93cml0ZWJhY2soCiB2b2lkIGRjbjIwX3VwZGF0
ZV9vZG0oc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3N0YXRlICpjb250ZXh0LCBzdHJ1Y3QgcGlw
ZV9jdHggKnBpcGVfY3R4KTsKIGJvb2wgZGNuMjBfZG1kYXRhX3N0YXR1c19kb25lKHN0cnVjdCBw
aXBlX2N0eCAqcGlwZV9jdHgpOwogdm9pZCBkY24yMF9wcm9ncmFtX2RtZGF0YV9lbmdpbmUoc3Ry
dWN0IHBpcGVfY3R4ICpwaXBlX2N0eCk7Cit2b2lkIGRjbjIwX3NldF9kbWRhdGFfYXR0cmlidXRl
cyhzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKIHZvaWQgZGNuMjBfaW5pdF92bV9jdHgoCiAJ
CXN0cnVjdCBkY2VfaHdzZXEgKmh3cywKIAkJc3RydWN0IGRjICpkYywKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9pbml0LmMgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaW5pdC5jCmluZGV4IDUxYjZjMjVh
YTNjNS4uZDUxZTAyZmRhYjRkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvZGNuMjAvZGNuMjBfaW5pdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9kY24yMC9kY24yMF9pbml0LmMKQEAgLTMwLDE5ICszMCwxMyBAQAogc3RhdGljIGNvbnN0
IHN0cnVjdCBod19zZXF1ZW5jZXJfZnVuY3MgZGNuMjBfZnVuY3MgPSB7CiAJLnByb2dyYW1fZ2Ft
dXRfcmVtYXAgPSBkY24xMF9wcm9ncmFtX2dhbXV0X3JlbWFwLAogCS5pbml0X2h3ID0gZGNuMTBf
aW5pdF9odywKLQkuaW5pdF9waXBlcyA9IGRjbjEwX2luaXRfcGlwZXMsCiAJLmFwcGx5X2N0eF90
b19odyA9IGRjZTExMF9hcHBseV9jdHhfdG9faHcsCiAJLmFwcGx5X2N0eF9mb3Jfc3VyZmFjZSA9
IE5VTEwsCiAJLnByb2dyYW1fZnJvbnRfZW5kX2Zvcl9jdHggPSBkY24yMF9wcm9ncmFtX2Zyb250
X2VuZF9mb3JfY3R4LAogCS51cGRhdGVfcGxhbmVfYWRkciA9IGRjbjIwX3VwZGF0ZV9wbGFuZV9h
ZGRyLAotCS5wbGFuZV9hdG9taWNfZGlzY29ubmVjdCA9IGRjbjEwX3BsYW5lX2F0b21pY19kaXNj
b25uZWN0LAogCS51cGRhdGVfZGNodWIgPSBkY24xMF91cGRhdGVfZGNodWIsCi0JLnVwZGF0ZV9t
cGNjID0gZGNuMjBfdXBkYXRlX21wY2MsCiAJLnVwZGF0ZV9wZW5kaW5nX3N0YXR1cyA9IGRjbjEw
X3VwZGF0ZV9wZW5kaW5nX3N0YXR1cywKLQkuc2V0X2lucHV0X3RyYW5zZmVyX2Z1bmMgPSBkY24y
MF9zZXRfaW5wdXRfdHJhbnNmZXJfZnVuYywKLQkuc2V0X291dHB1dF90cmFuc2Zlcl9mdW5jID0g
ZGNuMjBfc2V0X291dHB1dF90cmFuc2Zlcl9mdW5jLAogCS5wcm9ncmFtX291dHB1dF9jc2MgPSBk
Y24yMF9wcm9ncmFtX291dHB1dF9jc2MsCi0JLnBvd2VyX2Rvd24gPSBkY2UxMTBfcG93ZXJfZG93
biwKIAkuZW5hYmxlX2FjY2VsZXJhdGVkX21vZGUgPSBkY2UxMTBfZW5hYmxlX2FjY2VsZXJhdGVk
X21vZGUsCiAJLmVuYWJsZV90aW1pbmdfc3luY2hyb25pemF0aW9uID0gZGNuMTBfZW5hYmxlX3Rp
bWluZ19zeW5jaHJvbml6YXRpb24sCiAJLmVuYWJsZV9wZXJfZnJhbWVfY3J0Y19wb3NpdGlvbl9y
ZXNldCA9IGRjbjEwX2VuYWJsZV9wZXJfZnJhbWVfY3J0Y19wb3NpdGlvbl9yZXNldCwKQEAgLTU0
LDE2ICs0OCwxMiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGh3X3NlcXVlbmNlcl9mdW5jcyBkY24y
MF9mdW5jcyA9IHsKIAkuYmxhbmtfc3RyZWFtID0gZGNlMTEwX2JsYW5rX3N0cmVhbSwKIAkuZW5h
YmxlX2F1ZGlvX3N0cmVhbSA9IGRjZTExMF9lbmFibGVfYXVkaW9fc3RyZWFtLAogCS5kaXNhYmxl
X2F1ZGlvX3N0cmVhbSA9IGRjZTExMF9kaXNhYmxlX2F1ZGlvX3N0cmVhbSwKLQkuZW5hYmxlX2Rp
c3BsYXlfcG93ZXJfZ2F0aW5nID0gZGNuMTBfZHVtbXlfZGlzcGxheV9wb3dlcl9nYXRpbmcsCiAJ
LmRpc2FibGVfcGxhbmUgPSBkY24yMF9kaXNhYmxlX3BsYW5lLAotCS5ibGFua19waXhlbF9kYXRh
ID0gZGNuMjBfYmxhbmtfcGl4ZWxfZGF0YSwKIAkucGlwZV9jb250cm9sX2xvY2sgPSBkY24yMF9w
aXBlX2NvbnRyb2xfbG9jaywKIAkucGlwZV9jb250cm9sX2xvY2tfZ2xvYmFsID0gZGNuMjBfcGlw
ZV9jb250cm9sX2xvY2tfZ2xvYmFsLAogCS5wcmVwYXJlX2JhbmR3aWR0aCA9IGRjbjIwX3ByZXBh
cmVfYmFuZHdpZHRoLAogCS5vcHRpbWl6ZV9iYW5kd2lkdGggPSBkY24yMF9vcHRpbWl6ZV9iYW5k
d2lkdGgsCiAJLnVwZGF0ZV9iYW5kd2lkdGggPSBkY24yMF91cGRhdGVfYmFuZHdpZHRoLAotCS5y
ZXNldF9od19jdHhfd3JhcCA9IGRjbjIwX3Jlc2V0X2h3X2N0eF93cmFwLAotCS5lbmFibGVfc3Ry
ZWFtX3RpbWluZyA9IGRjbjIwX2VuYWJsZV9zdHJlYW1fdGltaW5nLAogCS5zZXRfZHJyID0gZGNu
MTBfc2V0X2RyciwKIAkuZ2V0X3Bvc2l0aW9uID0gZGNuMTBfZ2V0X3Bvc2l0aW9uLAogCS5zZXRf
c3RhdGljX3NjcmVlbl9jb250cm9sID0gZGNuMTBfc2V0X3N0YXRpY19zY3JlZW5fY29udHJvbCwK
QEAgLTczLDE4ICs2Myw0MiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGh3X3NlcXVlbmNlcl9mdW5j
cyBkY24yMF9mdW5jcyA9IHsKIAkuZ2V0X2h3X3N0YXRlID0gZGNuMTBfZ2V0X2h3X3N0YXRlLAog
CS5jbGVhcl9zdGF0dXNfYml0cyA9IGRjbjEwX2NsZWFyX3N0YXR1c19iaXRzLAogCS53YWl0X2Zv
cl9tcGNjX2Rpc2Nvbm5lY3QgPSBkY24xMF93YWl0X2Zvcl9tcGNjX2Rpc2Nvbm5lY3QsCi0JLmVk
cF9iYWNrbGlnaHRfY29udHJvbCA9IGRjZTExMF9lZHBfYmFja2xpZ2h0X2NvbnRyb2wsCiAJLmVk
cF9wb3dlcl9jb250cm9sID0gZGNlMTEwX2VkcF9wb3dlcl9jb250cm9sLAogCS5lZHBfd2FpdF9m
b3JfaHBkX3JlYWR5ID0gZGNlMTEwX2VkcF93YWl0X2Zvcl9ocGRfcmVhZHksCiAJLnNldF9jdXJz
b3JfcG9zaXRpb24gPSBkY24xMF9zZXRfY3Vyc29yX3Bvc2l0aW9uLAogCS5zZXRfY3Vyc29yX2F0
dHJpYnV0ZSA9IGRjbjEwX3NldF9jdXJzb3JfYXR0cmlidXRlLAogCS5zZXRfY3Vyc29yX3Nkcl93
aGl0ZV9sZXZlbCA9IGRjbjEwX3NldF9jdXJzb3Jfc2RyX3doaXRlX2xldmVsLAotCS5kaXNhYmxl
X3N0cmVhbV9nYXRpbmcgPSBkY24yMF9kaXNhYmxlX3N0cmVhbV9nYXRpbmcsCi0JLmVuYWJsZV9z
dHJlYW1fZ2F0aW5nID0gZGNuMjBfZW5hYmxlX3N0cmVhbV9nYXRpbmcsCiAJLnNldHVwX3Blcmlv
ZGljX2ludGVycnVwdCA9IGRjbjEwX3NldHVwX3BlcmlvZGljX2ludGVycnVwdCwKLQkuc2V0dXBf
dnVwZGF0ZV9pbnRlcnJ1cHQgPSBkY24yMF9zZXR1cF92dXBkYXRlX2ludGVycnVwdCwKIAkuc2V0
X2Nsb2NrID0gZGNuMTBfc2V0X2Nsb2NrLAogCS5nZXRfY2xvY2sgPSBkY24xMF9nZXRfY2xvY2ss
CisJLnByb2dyYW1fdHJpcGxlYnVmZmVyID0gZGNuMjBfcHJvZ3JhbV90cmlwbGVfYnVmZmVyLAor
CS5lbmFibGVfd3JpdGViYWNrID0gZGNuMjBfZW5hYmxlX3dyaXRlYmFjaywKKwkuZGlzYWJsZV93
cml0ZWJhY2sgPSBkY24yMF9kaXNhYmxlX3dyaXRlYmFjaywKKwkuZG1kYXRhX3N0YXR1c19kb25l
ID0gZGNuMjBfZG1kYXRhX3N0YXR1c19kb25lLAorCS5wcm9ncmFtX2RtZGF0YV9lbmdpbmUgPSBk
Y24yMF9wcm9ncmFtX2RtZGF0YV9lbmdpbmUsCisJLnNldF9kbWRhdGFfYXR0cmlidXRlcyA9IGRj
bjIwX3NldF9kbWRhdGFfYXR0cmlidXRlcywKKwkuaW5pdF9zeXNfY3R4ID0gZGNuMjBfaW5pdF9z
eXNfY3R4LAorCS5pbml0X3ZtX2N0eCA9IGRjbjIwX2luaXRfdm1fY3R4LAorCS5zZXRfZmxpcF9j
b250cm9sX2dzbCA9IGRjbjIwX3NldF9mbGlwX2NvbnRyb2xfZ3NsLAorCS5nZXRfdnVwZGF0ZV9v
ZmZzZXRfZnJvbV92c3luYyA9IGRjbjEwX2dldF92dXBkYXRlX29mZnNldF9mcm9tX3ZzeW5jLAor
fTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBod3NlcV9wcml2YXRlX2Z1bmNzIGRjbjIwX3ByaXZh
dGVfZnVuY3MgPSB7CisJLmluaXRfcGlwZXMgPSBkY24xMF9pbml0X3BpcGVzLAorCS51cGRhdGVf
cGxhbmVfYWRkciA9IGRjbjIwX3VwZGF0ZV9wbGFuZV9hZGRyLAorCS5wbGFuZV9hdG9taWNfZGlz
Y29ubmVjdCA9IGRjbjEwX3BsYW5lX2F0b21pY19kaXNjb25uZWN0LAorCS51cGRhdGVfbXBjYyA9
IGRjbjIwX3VwZGF0ZV9tcGNjLAorCS5zZXRfaW5wdXRfdHJhbnNmZXJfZnVuYyA9IGRjbjIwX3Nl
dF9pbnB1dF90cmFuc2Zlcl9mdW5jLAorCS5zZXRfb3V0cHV0X3RyYW5zZmVyX2Z1bmMgPSBkY24y
MF9zZXRfb3V0cHV0X3RyYW5zZmVyX2Z1bmMsCisJLnBvd2VyX2Rvd24gPSBkY2UxMTBfcG93ZXJf
ZG93biwKKwkuZW5hYmxlX2Rpc3BsYXlfcG93ZXJfZ2F0aW5nID0gZGNuMTBfZHVtbXlfZGlzcGxh
eV9wb3dlcl9nYXRpbmcsCisJLmJsYW5rX3BpeGVsX2RhdGEgPSBkY24yMF9ibGFua19waXhlbF9k
YXRhLAorCS5yZXNldF9od19jdHhfd3JhcCA9IGRjbjIwX3Jlc2V0X2h3X2N0eF93cmFwLAorCS5l
bmFibGVfc3RyZWFtX3RpbWluZyA9IGRjbjIwX2VuYWJsZV9zdHJlYW1fdGltaW5nLAorCS5lZHBf
YmFja2xpZ2h0X2NvbnRyb2wgPSBkY2UxMTBfZWRwX2JhY2tsaWdodF9jb250cm9sLAorCS5kaXNh
YmxlX3N0cmVhbV9nYXRpbmcgPSBkY24yMF9kaXNhYmxlX3N0cmVhbV9nYXRpbmcsCisJLmVuYWJs
ZV9zdHJlYW1fZ2F0aW5nID0gZGNuMjBfZW5hYmxlX3N0cmVhbV9nYXRpbmcsCisJLnNldHVwX3Z1
cGRhdGVfaW50ZXJydXB0ID0gZGNuMjBfc2V0dXBfdnVwZGF0ZV9pbnRlcnJ1cHQsCiAJLmRpZF91
bmRlcmZsb3dfb2NjdXIgPSBkY24xMF9kaWRfdW5kZXJmbG93X29jY3VyLAogCS5pbml0X2JsYW5r
ID0gZGNuMjBfaW5pdF9ibGFuaywKIAkuZGlzYWJsZV92Z2EgPSBkY24yMF9kaXNhYmxlX3ZnYSwK
QEAgLTk1LDE1ICsxMDksNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGh3X3NlcXVlbmNlcl9mdW5j
cyBkY24yMF9mdW5jcyA9IHsKIAkuZHBwX3BnX2NvbnRyb2wgPSBkY24yMF9kcHBfcGdfY29udHJv
bCwKIAkuaHVicF9wZ19jb250cm9sID0gZGNuMjBfaHVicF9wZ19jb250cm9sLAogCS5kc2NfcGdf
Y29udHJvbCA9IE5VTEwsCi0JLnByb2dyYW1fdHJpcGxlYnVmZmVyID0gZGNuMjBfcHJvZ3JhbV90
cmlwbGVfYnVmZmVyLAotCS5lbmFibGVfd3JpdGViYWNrID0gZGNuMjBfZW5hYmxlX3dyaXRlYmFj
aywKLQkuZGlzYWJsZV93cml0ZWJhY2sgPSBkY24yMF9kaXNhYmxlX3dyaXRlYmFjaywKIAkudXBk
YXRlX29kbSA9IGRjbjIwX3VwZGF0ZV9vZG0sCi0JLmRtZGF0YV9zdGF0dXNfZG9uZSA9IGRjbjIw
X2RtZGF0YV9zdGF0dXNfZG9uZSwKLQkucHJvZ3JhbV9kbWRhdGFfZW5naW5lID0gZGNuMjBfcHJv
Z3JhbV9kbWRhdGFfZW5naW5lLAotCS5pbml0X3N5c19jdHggPSBkY24yMF9pbml0X3N5c19jdHgs
Ci0JLmluaXRfdm1fY3R4ID0gZGNuMjBfaW5pdF92bV9jdHgsCi0JLnNldF9mbGlwX2NvbnRyb2xf
Z3NsID0gZGNuMjBfc2V0X2ZsaXBfY29udHJvbF9nc2wsCiAJLmRzY19wZ19jb250cm9sID0gZGNu
MjBfZHNjX3BnX2NvbnRyb2wsCiAJLmdldF9zdXJmYWNlX3Zpc3VhbF9jb25maXJtX2NvbG9yID0g
ZGNuMTBfZ2V0X3N1cmZhY2VfdmlzdWFsX2NvbmZpcm1fY29sb3IsCiAJLmdldF9oZHJfdmlzdWFs
X2NvbmZpcm1fY29sb3IgPSBkY24xMF9nZXRfaGRyX3Zpc3VhbF9jb25maXJtX2NvbG9yLApAQCAt
MTEzLDE1ICsxMTksMTUgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBod19zZXF1ZW5jZXJfZnVuY3Mg
ZGNuMjBfZnVuY3MgPSB7CiAJLmRjY2dfaW5pdCA9IGRjbjIwX2RjY2dfaW5pdCwKIAkuc2V0X2Js
ZW5kX2x1dCA9IGRjbjIwX3NldF9ibGVuZF9sdXQsCiAJLnNldF9zaGFwZXJfM2RsdXQgPSBkY24y
MF9zZXRfc2hhcGVyXzNkbHV0LAotCS5nZXRfdnVwZGF0ZV9vZmZzZXRfZnJvbV92c3luYyA9IGRj
bjEwX2dldF92dXBkYXRlX29mZnNldF9mcm9tX3ZzeW5jLAogfTsKIAogdm9pZCBkY24yMF9od19z
ZXF1ZW5jZXJfY29uc3RydWN0KHN0cnVjdCBkYyAqZGMpCiB7CiAJZGMtPmh3c3MgPSBkY24yMF9m
dW5jczsKKwlkYy0+aHdzZXEtPmZ1bmNzID0gZGNuMjBfcHJpdmF0ZV9mdW5jczsKIAogCWlmIChJ
U19GUEdBX01BWElNVVNfREMoZGMtPmN0eC0+ZGNlX2Vudmlyb25tZW50KSkgewogCQlkYy0+aHdz
cy5pbml0X2h3ID0gZGNuMjBfZnBnYV9pbml0X2h3OwotCQlkYy0+aHdzcy5pbml0X3BpcGVzID0g
TlVMTDsKKwkJZGMtPmh3c2VxLT5mdW5jcy5pbml0X3BpcGVzID0gTlVMTDsKIAl9CiB9CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjEvZGNuMjFfaHdzZXEu
YyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMS9kY24yMV9od3NlcS5jCmlu
ZGV4IDAwNTg5NGRjYWJjOS4uMDgxYWQ4ZTQzZDU4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjEvZGNuMjFfaHdzZXEuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjEvZGNuMjFfaHdzZXEuYwpAQCAtMjgsNiArMjgsNyBAQAog
I2luY2x1ZGUgImNvcmVfdHlwZXMuaCIKICNpbmNsdWRlICJyZXNvdXJjZS5oIgogI2luY2x1ZGUg
ImRjZS9kY2VfaHdzZXEuaCIKKyNpbmNsdWRlICJkY24yMV9od3NlcS5oIgogI2luY2x1ZGUgInZt
aWQuaCIKICNpbmNsdWRlICJyZWdfaGVscGVyLmgiCiAjaW5jbHVkZSAiaHcvY2xrX21nci5oIgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIxL2RjbjIxX2h3
c2VxLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjEvZGNuMjFfaHdzZXEu
aAppbmRleCAyZjdiOGEyMjBlYjkuLjE4MjczNjA5NjEyMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIxL2RjbjIxX2h3c2VxLmgKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIxL2RjbjIxX2h3c2VxLmgKQEAgLTI2LDYgKzI2LDgg
QEAKICNpZm5kZWYgX19EQ19IV1NTX0RDTjIxX0hfXwogI2RlZmluZSBfX0RDX0hXU1NfRENOMjFf
SF9fCiAKKyNpbmNsdWRlICJod19zZXF1ZW5jZXJfcHJpdmF0ZS5oIgorCiBzdHJ1Y3QgZGM7CiAK
IGludCBkY24yMV9pbml0X3N5c19jdHgoc3RydWN0IGRjZV9od3NlcSAqaHdzLApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIxL2RjbjIxX2luaXQuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMS9kY24yMV9pbml0LmMKaW5kZXggMWQ4
YjY3YjRlMjUyLi40ODYxYWE1YzU5YWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kY24yMS9kY24yMV9pbml0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2RjbjIxL2RjbjIxX2luaXQuYwpAQCAtMzEsMTkgKzMxLDEzIEBACiBzdGF0aWMg
Y29uc3Qgc3RydWN0IGh3X3NlcXVlbmNlcl9mdW5jcyBkY24yMV9mdW5jcyA9IHsKIAkucHJvZ3Jh
bV9nYW11dF9yZW1hcCA9IGRjbjEwX3Byb2dyYW1fZ2FtdXRfcmVtYXAsCiAJLmluaXRfaHcgPSBk
Y24xMF9pbml0X2h3LAotCS5pbml0X3BpcGVzID0gZGNuMTBfaW5pdF9waXBlcywKIAkuYXBwbHlf
Y3R4X3RvX2h3ID0gZGNlMTEwX2FwcGx5X2N0eF90b19odywKIAkuYXBwbHlfY3R4X2Zvcl9zdXJm
YWNlID0gTlVMTCwKIAkucHJvZ3JhbV9mcm9udF9lbmRfZm9yX2N0eCA9IGRjbjIwX3Byb2dyYW1f
ZnJvbnRfZW5kX2Zvcl9jdHgsCiAJLnVwZGF0ZV9wbGFuZV9hZGRyID0gZGNuMjBfdXBkYXRlX3Bs
YW5lX2FkZHIsCi0JLnBsYW5lX2F0b21pY19kaXNjb25uZWN0ID0gZGNuMTBfcGxhbmVfYXRvbWlj
X2Rpc2Nvbm5lY3QsCiAJLnVwZGF0ZV9kY2h1YiA9IGRjbjEwX3VwZGF0ZV9kY2h1YiwKLQkudXBk
YXRlX21wY2MgPSBkY24yMF91cGRhdGVfbXBjYywKIAkudXBkYXRlX3BlbmRpbmdfc3RhdHVzID0g
ZGNuMTBfdXBkYXRlX3BlbmRpbmdfc3RhdHVzLAotCS5zZXRfaW5wdXRfdHJhbnNmZXJfZnVuYyA9
IGRjbjIwX3NldF9pbnB1dF90cmFuc2Zlcl9mdW5jLAotCS5zZXRfb3V0cHV0X3RyYW5zZmVyX2Z1
bmMgPSBkY24yMF9zZXRfb3V0cHV0X3RyYW5zZmVyX2Z1bmMsCiAJLnByb2dyYW1fb3V0cHV0X2Nz
YyA9IGRjbjIwX3Byb2dyYW1fb3V0cHV0X2NzYywKLQkucG93ZXJfZG93biA9IGRjZTExMF9wb3dl
cl9kb3duLAogCS5lbmFibGVfYWNjZWxlcmF0ZWRfbW9kZSA9IGRjZTExMF9lbmFibGVfYWNjZWxl
cmF0ZWRfbW9kZSwKIAkuZW5hYmxlX3RpbWluZ19zeW5jaHJvbml6YXRpb24gPSBkY24xMF9lbmFi
bGVfdGltaW5nX3N5bmNocm9uaXphdGlvbiwKIAkuZW5hYmxlX3Blcl9mcmFtZV9jcnRjX3Bvc2l0
aW9uX3Jlc2V0ID0gZGNuMTBfZW5hYmxlX3Blcl9mcmFtZV9jcnRjX3Bvc2l0aW9uX3Jlc2V0LApA
QCAtNTUsMTYgKzQ5LDEyIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaHdfc2VxdWVuY2VyX2Z1bmNz
IGRjbjIxX2Z1bmNzID0gewogCS5ibGFua19zdHJlYW0gPSBkY2UxMTBfYmxhbmtfc3RyZWFtLAog
CS5lbmFibGVfYXVkaW9fc3RyZWFtID0gZGNlMTEwX2VuYWJsZV9hdWRpb19zdHJlYW0sCiAJLmRp
c2FibGVfYXVkaW9fc3RyZWFtID0gZGNlMTEwX2Rpc2FibGVfYXVkaW9fc3RyZWFtLAotCS5lbmFi
bGVfZGlzcGxheV9wb3dlcl9nYXRpbmcgPSBkY24xMF9kdW1teV9kaXNwbGF5X3Bvd2VyX2dhdGlu
ZywKIAkuZGlzYWJsZV9wbGFuZSA9IGRjbjIwX2Rpc2FibGVfcGxhbmUsCi0JLmJsYW5rX3BpeGVs
X2RhdGEgPSBkY24yMF9ibGFua19waXhlbF9kYXRhLAogCS5waXBlX2NvbnRyb2xfbG9jayA9IGRj
bjIwX3BpcGVfY29udHJvbF9sb2NrLAogCS5waXBlX2NvbnRyb2xfbG9ja19nbG9iYWwgPSBkY24y
MF9waXBlX2NvbnRyb2xfbG9ja19nbG9iYWwsCiAJLnByZXBhcmVfYmFuZHdpZHRoID0gZGNuMjBf
cHJlcGFyZV9iYW5kd2lkdGgsCiAJLm9wdGltaXplX2JhbmR3aWR0aCA9IGRjbjIwX29wdGltaXpl
X2JhbmR3aWR0aCwKIAkudXBkYXRlX2JhbmR3aWR0aCA9IGRjbjIwX3VwZGF0ZV9iYW5kd2lkdGgs
Ci0JLnJlc2V0X2h3X2N0eF93cmFwID0gZGNuMjBfcmVzZXRfaHdfY3R4X3dyYXAsCi0JLmVuYWJs
ZV9zdHJlYW1fdGltaW5nID0gZGNuMjBfZW5hYmxlX3N0cmVhbV90aW1pbmcsCiAJLnNldF9kcnIg
PSBkY24xMF9zZXRfZHJyLAogCS5nZXRfcG9zaXRpb24gPSBkY24xMF9nZXRfcG9zaXRpb24sCiAJ
LnNldF9zdGF0aWNfc2NyZWVuX2NvbnRyb2wgPSBkY24xMF9zZXRfc3RhdGljX3NjcmVlbl9jb250
cm9sLApAQCAtNzQsMTggKzY0LDQ5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaHdfc2VxdWVuY2Vy
X2Z1bmNzIGRjbjIxX2Z1bmNzID0gewogCS5nZXRfaHdfc3RhdGUgPSBkY24xMF9nZXRfaHdfc3Rh
dGUsCiAJLmNsZWFyX3N0YXR1c19iaXRzID0gZGNuMTBfY2xlYXJfc3RhdHVzX2JpdHMsCiAJLndh
aXRfZm9yX21wY2NfZGlzY29ubmVjdCA9IGRjbjEwX3dhaXRfZm9yX21wY2NfZGlzY29ubmVjdCwK
LQkuZWRwX2JhY2tsaWdodF9jb250cm9sID0gZGNlMTEwX2VkcF9iYWNrbGlnaHRfY29udHJvbCwK
IAkuZWRwX3Bvd2VyX2NvbnRyb2wgPSBkY2UxMTBfZWRwX3Bvd2VyX2NvbnRyb2wsCiAJLmVkcF93
YWl0X2Zvcl9ocGRfcmVhZHkgPSBkY2UxMTBfZWRwX3dhaXRfZm9yX2hwZF9yZWFkeSwKIAkuc2V0
X2N1cnNvcl9wb3NpdGlvbiA9IGRjbjEwX3NldF9jdXJzb3JfcG9zaXRpb24sCiAJLnNldF9jdXJz
b3JfYXR0cmlidXRlID0gZGNuMTBfc2V0X2N1cnNvcl9hdHRyaWJ1dGUsCiAJLnNldF9jdXJzb3Jf
c2RyX3doaXRlX2xldmVsID0gZGNuMTBfc2V0X2N1cnNvcl9zZHJfd2hpdGVfbGV2ZWwsCi0JLmRp
c2FibGVfc3RyZWFtX2dhdGluZyA9IGRjbjIwX2Rpc2FibGVfc3RyZWFtX2dhdGluZywKLQkuZW5h
YmxlX3N0cmVhbV9nYXRpbmcgPSBkY24yMF9lbmFibGVfc3RyZWFtX2dhdGluZywKIAkuc2V0dXBf
cGVyaW9kaWNfaW50ZXJydXB0ID0gZGNuMTBfc2V0dXBfcGVyaW9kaWNfaW50ZXJydXB0LAotCS5z
ZXR1cF92dXBkYXRlX2ludGVycnVwdCA9IGRjbjIwX3NldHVwX3Z1cGRhdGVfaW50ZXJydXB0LAog
CS5zZXRfY2xvY2sgPSBkY24xMF9zZXRfY2xvY2ssCiAJLmdldF9jbG9jayA9IGRjbjEwX2dldF9j
bG9jaywKKwkucHJvZ3JhbV90cmlwbGVidWZmZXIgPSBkY24yMF9wcm9ncmFtX3RyaXBsZV9idWZm
ZXIsCisJLmVuYWJsZV93cml0ZWJhY2sgPSBkY24yMF9lbmFibGVfd3JpdGViYWNrLAorCS5kaXNh
YmxlX3dyaXRlYmFjayA9IGRjbjIwX2Rpc2FibGVfd3JpdGViYWNrLAorCS5kbWRhdGFfc3RhdHVz
X2RvbmUgPSBkY24yMF9kbWRhdGFfc3RhdHVzX2RvbmUsCisJLnByb2dyYW1fZG1kYXRhX2VuZ2lu
ZSA9IGRjbjIwX3Byb2dyYW1fZG1kYXRhX2VuZ2luZSwKKwkuc2V0X2RtZGF0YV9hdHRyaWJ1dGVz
ID0gZGNuMjBfc2V0X2RtZGF0YV9hdHRyaWJ1dGVzLAorCS5pbml0X3N5c19jdHggPSBkY24yMV9p
bml0X3N5c19jdHgsCisJLmluaXRfdm1fY3R4ID0gZGNuMjBfaW5pdF92bV9jdHgsCisJLnNldF9m
bGlwX2NvbnRyb2xfZ3NsID0gZGNuMjBfc2V0X2ZsaXBfY29udHJvbF9nc2wsCisJLm9wdGltaXpl
X3B3cl9zdGF0ZSA9IGRjbjIxX29wdGltaXplX3B3cl9zdGF0ZSwKKwkuZXhpdF9vcHRpbWl6ZWRf
cHdyX3N0YXRlID0gZGNuMjFfZXhpdF9vcHRpbWl6ZWRfcHdyX3N0YXRlLAorCS5nZXRfdnVwZGF0
ZV9vZmZzZXRfZnJvbV92c3luYyA9IGRjbjEwX2dldF92dXBkYXRlX29mZnNldF9mcm9tX3ZzeW5j
LAorCS5zZXRfY3Vyc29yX3Bvc2l0aW9uID0gZGNuMTBfc2V0X2N1cnNvcl9wb3NpdGlvbiwKKwku
c2V0X2N1cnNvcl9hdHRyaWJ1dGUgPSBkY24xMF9zZXRfY3Vyc29yX2F0dHJpYnV0ZSwKKwkuc2V0
X2N1cnNvcl9zZHJfd2hpdGVfbGV2ZWwgPSBkY24xMF9zZXRfY3Vyc29yX3Nkcl93aGl0ZV9sZXZl
bCwKKwkub3B0aW1pemVfcHdyX3N0YXRlID0gZGNuMjFfb3B0aW1pemVfcHdyX3N0YXRlLAorCS5l
eGl0X29wdGltaXplZF9wd3Jfc3RhdGUgPSBkY24yMV9leGl0X29wdGltaXplZF9wd3Jfc3RhdGUs
Cit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGh3c2VxX3ByaXZhdGVfZnVuY3MgZGNuMjFfcHJp
dmF0ZV9mdW5jcyA9IHsKKwkuaW5pdF9waXBlcyA9IGRjbjEwX2luaXRfcGlwZXMsCisJLnVwZGF0
ZV9wbGFuZV9hZGRyID0gZGNuMjBfdXBkYXRlX3BsYW5lX2FkZHIsCisJLnBsYW5lX2F0b21pY19k
aXNjb25uZWN0ID0gZGNuMTBfcGxhbmVfYXRvbWljX2Rpc2Nvbm5lY3QsCisJLnVwZGF0ZV9tcGNj
ID0gZGNuMjBfdXBkYXRlX21wY2MsCisJLnNldF9pbnB1dF90cmFuc2Zlcl9mdW5jID0gZGNuMjBf
c2V0X2lucHV0X3RyYW5zZmVyX2Z1bmMsCisJLnNldF9vdXRwdXRfdHJhbnNmZXJfZnVuYyA9IGRj
bjIwX3NldF9vdXRwdXRfdHJhbnNmZXJfZnVuYywKKwkucG93ZXJfZG93biA9IGRjZTExMF9wb3dl
cl9kb3duLAorCS5lbmFibGVfZGlzcGxheV9wb3dlcl9nYXRpbmcgPSBkY24xMF9kdW1teV9kaXNw
bGF5X3Bvd2VyX2dhdGluZywKKwkuYmxhbmtfcGl4ZWxfZGF0YSA9IGRjbjIwX2JsYW5rX3BpeGVs
X2RhdGEsCisJLnJlc2V0X2h3X2N0eF93cmFwID0gZGNuMjBfcmVzZXRfaHdfY3R4X3dyYXAsCisJ
LmVuYWJsZV9zdHJlYW1fdGltaW5nID0gZGNuMjBfZW5hYmxlX3N0cmVhbV90aW1pbmcsCisJLmVk
cF9iYWNrbGlnaHRfY29udHJvbCA9IGRjZTExMF9lZHBfYmFja2xpZ2h0X2NvbnRyb2wsCisJLmRp
c2FibGVfc3RyZWFtX2dhdGluZyA9IGRjbjIwX2Rpc2FibGVfc3RyZWFtX2dhdGluZywKKwkuZW5h
YmxlX3N0cmVhbV9nYXRpbmcgPSBkY24yMF9lbmFibGVfc3RyZWFtX2dhdGluZywKKwkuc2V0dXBf
dnVwZGF0ZV9pbnRlcnJ1cHQgPSBkY24yMF9zZXR1cF92dXBkYXRlX2ludGVycnVwdCwKIAkuZGlk
X3VuZGVyZmxvd19vY2N1ciA9IGRjbjEwX2RpZF91bmRlcmZsb3dfb2NjdXIsCiAJLmluaXRfYmxh
bmsgPSBkY24yMF9pbml0X2JsYW5rLAogCS5kaXNhYmxlX3ZnYSA9IGRjbjIwX2Rpc2FibGVfdmdh
LApAQCAtOTYsMzYgKzExNywyNiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGh3X3NlcXVlbmNlcl9m
dW5jcyBkY24yMV9mdW5jcyA9IHsKIAkuZHBwX3BnX2NvbnRyb2wgPSBkY24yMF9kcHBfcGdfY29u
dHJvbCwKIAkuaHVicF9wZ19jb250cm9sID0gZGNuMjBfaHVicF9wZ19jb250cm9sLAogCS5kc2Nf
cGdfY29udHJvbCA9IE5VTEwsCi0JLnByb2dyYW1fdHJpcGxlYnVmZmVyID0gZGNuMjBfcHJvZ3Jh
bV90cmlwbGVfYnVmZmVyLAotCS5lbmFibGVfd3JpdGViYWNrID0gZGNuMjBfZW5hYmxlX3dyaXRl
YmFjaywKLQkuZGlzYWJsZV93cml0ZWJhY2sgPSBkY24yMF9kaXNhYmxlX3dyaXRlYmFjaywKIAku
dXBkYXRlX29kbSA9IGRjbjIwX3VwZGF0ZV9vZG0sCi0JLmRtZGF0YV9zdGF0dXNfZG9uZSA9IGRj
bjIwX2RtZGF0YV9zdGF0dXNfZG9uZSwKLQkucHJvZ3JhbV9kbWRhdGFfZW5naW5lID0gZGNuMjBf
cHJvZ3JhbV9kbWRhdGFfZW5naW5lLAotCS5pbml0X3N5c19jdHggPSBkY24yMV9pbml0X3N5c19j
dHgsCi0JLmluaXRfdm1fY3R4ID0gZGNuMjBfaW5pdF92bV9jdHgsCi0JLnNldF9mbGlwX2NvbnRy
b2xfZ3NsID0gZGNuMjBfc2V0X2ZsaXBfY29udHJvbF9nc2wsCiAJLmRzY19wZ19jb250cm9sID0g
ZGNuMjBfZHNjX3BnX2NvbnRyb2wsCiAJLmdldF9zdXJmYWNlX3Zpc3VhbF9jb25maXJtX2NvbG9y
ID0gZGNuMTBfZ2V0X3N1cmZhY2VfdmlzdWFsX2NvbmZpcm1fY29sb3IsCiAJLmdldF9oZHJfdmlz
dWFsX2NvbmZpcm1fY29sb3IgPSBkY24xMF9nZXRfaGRyX3Zpc3VhbF9jb25maXJtX2NvbG9yLAog
CS5zZXRfaGRyX211bHRpcGxpZXIgPSBkY24xMF9zZXRfaGRyX211bHRpcGxpZXIsCiAJLnZlcmlm
eV9hbGxvd19wc3RhdGVfY2hhbmdlX2hpZ2ggPSBkY24xMF92ZXJpZnlfYWxsb3dfcHN0YXRlX2No
YW5nZV9oaWdoLAogCS5zMGkzX2dvbGRlbl9pbml0X3dhID0gZGNuMjFfczBpM19nb2xkZW5faW5p
dF93YSwKLQkub3B0aW1pemVfcHdyX3N0YXRlID0gZGNuMjFfb3B0aW1pemVfcHdyX3N0YXRlLAot
CS5leGl0X29wdGltaXplZF9wd3Jfc3RhdGUgPSBkY24yMV9leGl0X29wdGltaXplZF9wd3Jfc3Rh
dGUsCiAJLndhaXRfZm9yX2JsYW5rX2NvbXBsZXRlID0gZGNuMjBfd2FpdF9mb3JfYmxhbmtfY29t
cGxldGUsCiAJLmRjY2dfaW5pdCA9IGRjbjIwX2RjY2dfaW5pdCwKIAkuc2V0X2JsZW5kX2x1dCA9
IGRjbjIwX3NldF9ibGVuZF9sdXQsCiAJLnNldF9zaGFwZXJfM2RsdXQgPSBkY24yMF9zZXRfc2hh
cGVyXzNkbHV0LAotCS5nZXRfdnVwZGF0ZV9vZmZzZXRfZnJvbV92c3luYyA9IGRjbjEwX2dldF92
dXBkYXRlX29mZnNldF9mcm9tX3ZzeW5jLAogfTsKIAogdm9pZCBkY24yMV9od19zZXF1ZW5jZXJf
Y29uc3RydWN0KHN0cnVjdCBkYyAqZGMpCiB7CiAJZGMtPmh3c3MgPSBkY24yMV9mdW5jczsKKwlk
Yy0+aHdzZXEtPmZ1bmNzID0gZGNuMjFfcHJpdmF0ZV9mdW5jczsKIAogCWlmIChJU19GUEdBX01B
WElNVVNfREMoZGMtPmN0eC0+ZGNlX2Vudmlyb25tZW50KSkgewogCQlkYy0+aHdzcy5pbml0X2h3
ID0gZGNuMjBfZnBnYV9pbml0X2h3OwotCQlkYy0+aHdzcy5pbml0X3BpcGVzID0gTlVMTDsKKwkJ
ZGMtPmh3c2VxLT5mdW5jcy5pbml0X3BpcGVzID0gTlVMTDsKIAl9CiB9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3X3NlcXVlbmNlci5oIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9od19zZXF1ZW5jZXIuaAppbmRleCA1OTQxNTc3
ZDc4YTUuLmU5YzYwMjFhNTM3MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNw
bGF5L2RjL2luYy9od19zZXF1ZW5jZXIuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvaW5jL2h3X3NlcXVlbmNlci5oCkBAIC0zMiwzOCArMzIsMTEgQEAKICNpbmNsdWRlICJp
bmMvaHcvbGlua19lbmNvZGVyLmgiCiAjaW5jbHVkZSAiY29yZV9zdGF0dXMuaCIKIAotZW51bSBw
aXBlX2dhdGluZ19jb250cm9sIHsKLQlQSVBFX0dBVElOR19DT05UUk9MX0RJU0FCTEUgPSAwLAot
CVBJUEVfR0FUSU5HX0NPTlRST0xfRU5BQkxFLAotCVBJUEVfR0FUSU5HX0NPTlRST0xfSU5JVAot
fTsKLQogZW51bSB2bGluZV9zZWxlY3QgewogCVZMSU5FMCwKIAlWTElORTEKIH07CiAKLXN0cnVj
dCBkY2VfaHdzZXFfd2EgewotCWJvb2wgYmxuZF9jcnRjX3RyaWdnZXI7Ci0JYm9vbCBERUdWSURD
TjEwXzI1MzsKLQlib29sIGZhbHNlX29wdGNfdW5kZXJmbG93OwotCWJvb2wgREVHVklEQ04xMF8y
NTQ7Ci0JYm9vbCBERUdWSURDTjIxOwotfTsKLQotc3RydWN0IGh3c2VxX3dhX3N0YXRlIHsKLQli
b29sIERFR1ZJRENOMTBfMjUzX2FwcGxpZWQ7Ci19OwotCi1zdHJ1Y3QgZGNlX2h3c2VxIHsKLQlz
dHJ1Y3QgZGNfY29udGV4dCAqY3R4OwotCWNvbnN0IHN0cnVjdCBkY2VfaHdzZXFfcmVnaXN0ZXJz
ICpyZWdzOwotCWNvbnN0IHN0cnVjdCBkY2VfaHdzZXFfc2hpZnQgKnNoaWZ0czsKLQljb25zdCBz
dHJ1Y3QgZGNlX2h3c2VxX21hc2sgKm1hc2tzOwotCXN0cnVjdCBkY2VfaHdzZXFfd2Egd2E7Ci0J
c3RydWN0IGh3c2VxX3dhX3N0YXRlIHdhX3N0YXRlOwotfTsKLQogc3RydWN0IHBpcGVfY3R4Owog
c3RydWN0IGRjX3N0YXRlOwogc3RydWN0IGRjX3N0cmVhbV9zdGF0dXM7CkBAIC03MSwyNTUgKzQ0
LDExMCBAQCBzdHJ1Y3QgZGNfd3JpdGViYWNrX2luZm87CiBzdHJ1Y3QgZGNodWJfaW5pdF9kYXRh
Owogc3RydWN0IGRjX3N0YXRpY19zY3JlZW5fZXZlbnRzOwogc3RydWN0IHJlc291cmNlX3Bvb2w7
Ci1zdHJ1Y3QgcmVzb3VyY2VfY29udGV4dDsKLXN0cnVjdCBzdHJlYW1fcmVzb3VyY2U7CiBzdHJ1
Y3QgZGNfcGh5X2FkZHJfc3BhY2VfY29uZmlnOwogc3RydWN0IGRjX3ZpcnR1YWxfYWRkcl9zcGFj
ZV9jb25maWc7Ci1zdHJ1Y3QgaHVicDsKIHN0cnVjdCBkcHA7CitzdHJ1Y3QgZGNlX2h3c2VxOwog
CiBzdHJ1Y3QgaHdfc2VxdWVuY2VyX2Z1bmNzIHsKKwkvKiBFbWJlZGRlZCBEaXNwbGF5IFJlbGF0
ZWQgKi8KKwl2b2lkICgqZWRwX3Bvd2VyX2NvbnRyb2wpKHN0cnVjdCBkY19saW5rICpsaW5rLCBi
b29sIGVuYWJsZSk7CisJdm9pZCAoKmVkcF93YWl0X2Zvcl9ocGRfcmVhZHkpKHN0cnVjdCBkY19s
aW5rICpsaW5rLCBib29sIHBvd2VyX3VwKTsKIAotCXZvaWQgKCpkaXNhYmxlX3N0cmVhbV9nYXRp
bmcpKHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOwotCi0Jdm9pZCAo
KmVuYWJsZV9zdHJlYW1fZ2F0aW5nKShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlwZV9jdHggKnBp
cGVfY3R4KTsKLQorCS8qIFBpcGUgUHJvZ3JhbW1pbmcgUmVsYXRlZCAqLwogCXZvaWQgKCppbml0
X2h3KShzdHJ1Y3QgZGMgKmRjKTsKLQotCXZvaWQgKCppbml0X3BpcGVzKShzdHJ1Y3QgZGMgKmRj
LCBzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpOwotCi0JZW51bSBkY19zdGF0dXMgKCphcHBseV9j
dHhfdG9faHcpKAotCQkJc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KTsK
LQotCXZvaWQgKCpyZXNldF9od19jdHhfd3JhcCkoCi0JCQlzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3Qg
ZGNfc3RhdGUgKmNvbnRleHQpOwotCi0Jdm9pZCAoKmFwcGx5X2N0eF9mb3Jfc3VyZmFjZSkoCi0J
CQlzdHJ1Y3QgZGMgKmRjLAorCXZvaWQgKCplbmFibGVfYWNjZWxlcmF0ZWRfbW9kZSkoc3RydWN0
IGRjICpkYywKKwkJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCk7CisJZW51bSBkY19zdGF0dXMg
KCphcHBseV9jdHhfdG9faHcpKHN0cnVjdCBkYyAqZGMsCisJCQlzdHJ1Y3QgZGNfc3RhdGUgKmNv
bnRleHQpOworCXZvaWQgKCpkaXNhYmxlX3BsYW5lKShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlw
ZV9jdHggKnBpcGVfY3R4KTsKKwl2b2lkICgqYXBwbHlfY3R4X2Zvcl9zdXJmYWNlKShzdHJ1Y3Qg
ZGMgKmRjLAogCQkJY29uc3Qgc3RydWN0IGRjX3N0cmVhbV9zdGF0ZSAqc3RyZWFtLAotCQkJaW50
IG51bV9wbGFuZXMsCisJCQlpbnQgbnVtX3BsYW5lcywgc3RydWN0IGRjX3N0YXRlICpjb250ZXh0
KTsKKwl2b2lkICgqcHJvZ3JhbV9mcm9udF9lbmRfZm9yX2N0eCkoc3RydWN0IGRjICpkYywKIAkJ
CXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCk7Ci0KLQl2b2lkICgqcHJvZ3JhbV9nYW11dF9yZW1h
cCkoCisJdm9pZCAoKnVwZGF0ZV9wbGFuZV9hZGRyKShjb25zdCBzdHJ1Y3QgZGMgKmRjLAogCQkJ
c3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCk7Ci0KLQl2b2lkICgqcHJvZ3JhbV9vdXRwdXRfY3Nj
KShzdHJ1Y3QgZGMgKmRjLAotCQkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKLQkJCWVudW0g
ZGNfY29sb3Jfc3BhY2UgY29sb3JzcGFjZSwKLQkJCXVpbnQxNl90ICptYXRyaXgsCi0JCQlpbnQg
b3BwX2lkKTsKLQotCXZvaWQgKCpwcm9ncmFtX2Zyb250X2VuZF9mb3JfY3R4KSgKLQkJCXN0cnVj
dCBkYyAqZGMsCi0JCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpOwotCXZvaWQgKCpwcm9ncmFt
X3RyaXBsZWJ1ZmZlcikoCi0JCWNvbnN0IHN0cnVjdCBkYyAqZGMsCi0JCXN0cnVjdCBwaXBlX2N0
eCAqcGlwZV9jdHgsCi0JCWJvb2wgZW5hYmxlVHJpcGxlQnVmZmVyKTsKLQl2b2lkICgqc2V0X2Zs
aXBfY29udHJvbF9nc2wpKAotCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAotCQlib29sIGZs
aXBfaW1tZWRpYXRlKTsKLQotCXZvaWQgKCp1cGRhdGVfcGxhbmVfYWRkcikoCi0JCWNvbnN0IHN0
cnVjdCBkYyAqZGMsCi0JCXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOwotCi0Jdm9pZCAoKnBs
YW5lX2F0b21pY19kaXNjb25uZWN0KSgKLQkJc3RydWN0IGRjICpkYywKLQkJc3RydWN0IHBpcGVf
Y3R4ICpwaXBlX2N0eCk7Ci0KLQl2b2lkICgqdXBkYXRlX2RjaHViKSgKLQkJc3RydWN0IGRjZV9o
d3NlcSAqaHdzLAotCQlzdHJ1Y3QgZGNodWJfaW5pdF9kYXRhICpkaF9kYXRhKTsKLQotCWludCAo
KmluaXRfc3lzX2N0eCkoCi0JCQlzdHJ1Y3QgZGNlX2h3c2VxICpod3MsCi0JCQlzdHJ1Y3QgZGMg
KmRjLAotCQkJc3RydWN0IGRjX3BoeV9hZGRyX3NwYWNlX2NvbmZpZyAqcGFfY29uZmlnKTsKLQl2
b2lkICgqaW5pdF92bV9jdHgpKAotCQkJc3RydWN0IGRjZV9od3NlcSAqaHdzLAotCQkJc3RydWN0
IGRjICpkYywKLQkJCXN0cnVjdCBkY192aXJ0dWFsX2FkZHJfc3BhY2VfY29uZmlnICp2YV9jb25m
aWcsCi0JCQlpbnQgdm1pZCk7Ci0Jdm9pZCAoKnVwZGF0ZV9tcGNjKSgKLQkJc3RydWN0IGRjICpk
YywKLQkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCk7Ci0KLQl2b2lkICgqdXBkYXRlX3BlbmRp
bmdfc3RhdHVzKSgKKwl2b2lkICgqdXBkYXRlX2RjaHViKShzdHJ1Y3QgZGNlX2h3c2VxICpod3Ms
CisJCQlzdHJ1Y3QgZGNodWJfaW5pdF9kYXRhICpkaF9kYXRhKTsKKwl2b2lkICgqd2FpdF9mb3Jf
bXBjY19kaXNjb25uZWN0KShzdHJ1Y3QgZGMgKmRjLAorCQkJc3RydWN0IHJlc291cmNlX3Bvb2wg
KnJlc19wb29sLAogCQkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCk7Ci0KLQlib29sICgqc2V0
X2lucHV0X3RyYW5zZmVyX2Z1bmMpKHN0cnVjdCBkYyAqZGMsCi0JCQkJc3RydWN0IHBpcGVfY3R4
ICpwaXBlX2N0eCwKLQkJCQljb25zdCBzdHJ1Y3QgZGNfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRl
KTsKLQotCWJvb2wgKCpzZXRfb3V0cHV0X3RyYW5zZmVyX2Z1bmMpKHN0cnVjdCBkYyAqZGMsCi0J
CQkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKLQkJCQljb25zdCBzdHJ1Y3QgZGNfc3RyZWFt
X3N0YXRlICpzdHJlYW0pOwotCi0Jdm9pZCAoKnBvd2VyX2Rvd24pKHN0cnVjdCBkYyAqZGMpOwot
Ci0Jdm9pZCAoKmVuYWJsZV9hY2NlbGVyYXRlZF9tb2RlKShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3Qg
ZGNfc3RhdGUgKmNvbnRleHQpOwotCi0Jdm9pZCAoKmVuYWJsZV90aW1pbmdfc3luY2hyb25pemF0
aW9uKSgKLQkJCXN0cnVjdCBkYyAqZGMsCi0JCQlpbnQgZ3JvdXBfaW5kZXgsCi0JCQlpbnQgZ3Jv
dXBfc2l6ZSwKLQkJCXN0cnVjdCBwaXBlX2N0eCAqZ3JvdXBlZF9waXBlc1tdKTsKLQotCXZvaWQg
KCplbmFibGVfcGVyX2ZyYW1lX2NydGNfcG9zaXRpb25fcmVzZXQpKAotCQkJc3RydWN0IGRjICpk
YywKLQkJCWludCBncm91cF9zaXplLAorCXZvaWQgKCpwcm9ncmFtX3RyaXBsZWJ1ZmZlcikoY29u
c3Qgc3RydWN0IGRjICpkYywKKwkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwgYm9vbCBlbmFi
bGVUcmlwbGVCdWZmZXIpOworCXZvaWQgKCp1cGRhdGVfcGVuZGluZ19zdGF0dXMpKHN0cnVjdCBw
aXBlX2N0eCAqcGlwZV9jdHgpOworCisJLyogUGlwZSBMb2NrIFJlbGF0ZWQgKi8KKwl2b2lkICgq
cGlwZV9jb250cm9sX2xvY2tfZ2xvYmFsKShzdHJ1Y3QgZGMgKmRjLAorCQkJc3RydWN0IHBpcGVf
Y3R4ICpwaXBlLCBib29sIGxvY2spOworCXZvaWQgKCpwaXBlX2NvbnRyb2xfbG9jaykoc3RydWN0
IGRjICpkYywKKwkJCXN0cnVjdCBwaXBlX2N0eCAqcGlwZSwgYm9vbCBsb2NrKTsKKwl2b2lkICgq
c2V0X2ZsaXBfY29udHJvbF9nc2wpKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsCisJCQlib29s
IGZsaXBfaW1tZWRpYXRlKTsKKworCS8qIFRpbWluZyBSZWxhdGVkICovCisJdm9pZCAoKmdldF9w
b3NpdGlvbikoc3RydWN0IHBpcGVfY3R4ICoqcGlwZV9jdHgsIGludCBudW1fcGlwZXMsCisJCQlz
dHJ1Y3QgY3J0Y19wb3NpdGlvbiAqcG9zaXRpb24pOworCWludCAoKmdldF92dXBkYXRlX29mZnNl
dF9mcm9tX3ZzeW5jKShzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKKwl2b2lkICgqZW5hYmxl
X3Blcl9mcmFtZV9jcnRjX3Bvc2l0aW9uX3Jlc2V0KShzdHJ1Y3QgZGMgKmRjLAorCQkJaW50IGdy
b3VwX3NpemUsIHN0cnVjdCBwaXBlX2N0eCAqZ3JvdXBlZF9waXBlc1tdKTsKKwl2b2lkICgqZW5h
YmxlX3RpbWluZ19zeW5jaHJvbml6YXRpb24pKHN0cnVjdCBkYyAqZGMsCisJCQlpbnQgZ3JvdXBf
aW5kZXgsIGludCBncm91cF9zaXplLAogCQkJc3RydWN0IHBpcGVfY3R4ICpncm91cGVkX3BpcGVz
W10pOworCXZvaWQgKCpzZXR1cF9wZXJpb2RpY19pbnRlcnJ1cHQpKHN0cnVjdCBkYyAqZGMsCisJ
CQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAorCQkJZW51bSB2bGluZV9zZWxlY3QgdmxpbmUp
OworCXZvaWQgKCpzZXRfZHJyKShzdHJ1Y3QgcGlwZV9jdHggKipwaXBlX2N0eCwgaW50IG51bV9w
aXBlcywKKwkJCXVuc2lnbmVkIGludCB2bWluLCB1bnNpZ25lZCBpbnQgdm1heCwKKwkJCXVuc2ln
bmVkIGludCB2bWlkLCB1bnNpZ25lZCBpbnQgdm1pZF9mcmFtZV9udW1iZXIpOworCXZvaWQgKCpz
ZXRfc3RhdGljX3NjcmVlbl9jb250cm9sKShzdHJ1Y3QgcGlwZV9jdHggKipwaXBlX2N0eCwKKwkJ
CWludCBudW1fcGlwZXMsCisJCQljb25zdCBzdHJ1Y3QgZGNfc3RhdGljX3NjcmVlbl9ldmVudHMg
KmV2ZW50cyk7CiAKLQl2b2lkICgqZW5hYmxlX2Rpc3BsYXlfcGlwZV9jbG9ja19nYXRpbmcpKAot
CQkJCQlzdHJ1Y3QgZGNfY29udGV4dCAqY3R4LAotCQkJCQlib29sIGNsb2NrX2dhdGluZyk7Ci0K
LQlib29sICgqZW5hYmxlX2Rpc3BsYXlfcG93ZXJfZ2F0aW5nKSgKLQkJCQkJc3RydWN0IGRjICpk
YywKLQkJCQkJdWludDhfdCBjb250cm9sbGVyX2lkLAotCQkJCQlzdHJ1Y3QgZGNfYmlvcyAqZGNi
LAotCQkJCQllbnVtIHBpcGVfZ2F0aW5nX2NvbnRyb2wgcG93ZXJfZ2F0aW5nKTsKLQotCXZvaWQg
KCpkaXNhYmxlX3BsYW5lKShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4
KTsKLQotCXZvaWQgKCp1cGRhdGVfaW5mb19mcmFtZSkoc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0
eCk7Ci0KLQl2b2lkICgqc2VuZF9pbW1lZGlhdGVfc2RwX21lc3NhZ2UpKAotCQkJCXN0cnVjdCBw
aXBlX2N0eCAqcGlwZV9jdHgsCi0JCQkJY29uc3QgdWludDhfdCAqY3VzdG9tX3NkcF9tZXNzYWdl
LAotCQkJCXVuc2lnbmVkIGludCBzZHBfbWVzc2FnZV9zaXplKTsKLQorCS8qIFN0cmVhbSBSZWxh
dGVkICovCiAJdm9pZCAoKmVuYWJsZV9zdHJlYW0pKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgp
OwotCiAJdm9pZCAoKmRpc2FibGVfc3RyZWFtKShzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsK
LQorCXZvaWQgKCpibGFua19zdHJlYW0pKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOwogCXZv
aWQgKCp1bmJsYW5rX3N0cmVhbSkoc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKIAkJCXN0cnVj
dCBkY19saW5rX3NldHRpbmdzICpsaW5rX3NldHRpbmdzKTsKIAotCXZvaWQgKCpibGFua19zdHJl
YW0pKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOwotCi0Jdm9pZCAoKmVuYWJsZV9hdWRpb19z
dHJlYW0pKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOwotCi0Jdm9pZCAoKmRpc2FibGVfYXVk
aW9fc3RyZWFtKShzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKLQotCXZvaWQgKCpwaXBlX2Nv
bnRyb2xfbG9jaykoCi0JCQkJc3RydWN0IGRjICpkYywKLQkJCQlzdHJ1Y3QgcGlwZV9jdHggKnBp
cGUsCi0JCQkJYm9vbCBsb2NrKTsKKwkvKiBCYW5kd2lkdGggUmVsYXRlZCAqLworCXZvaWQgKCpw
cmVwYXJlX2JhbmR3aWR0aCkoc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3N0YXRlICpjb250ZXh0
KTsKKwlib29sICgqdXBkYXRlX2JhbmR3aWR0aCkoc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3N0
YXRlICpjb250ZXh0KTsKKwl2b2lkICgqb3B0aW1pemVfYmFuZHdpZHRoKShzdHJ1Y3QgZGMgKmRj
LCBzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpOwogCi0Jdm9pZCAoKnBpcGVfY29udHJvbF9sb2Nr
X2dsb2JhbCkoCi0JCQkJc3RydWN0IGRjICpkYywKLQkJCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGUs
Ci0JCQkJYm9vbCBsb2NrKTsKLQl2b2lkICgqYmxhbmtfcGl4ZWxfZGF0YSkoCi0JCQlzdHJ1Y3Qg
ZGMgKmRjLAorCS8qIEluZm9wYWNrZXQgUmVsYXRlZCAqLworCXZvaWQgKCpzZXRfYXZtdXRlKShz
dHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LCBib29sIGVuYWJsZSk7CisJdm9pZCAoKnNlbmRfaW1t
ZWRpYXRlX3NkcF9tZXNzYWdlKSgKIAkJCXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsCi0JCQli
b29sIGJsYW5rKTsKLQotCXZvaWQgKCpwcmVwYXJlX2JhbmR3aWR0aCkoCi0JCQlzdHJ1Y3QgZGMg
KmRjLAotCQkJc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KTsKLQl2b2lkICgqb3B0aW1pemVfYmFu
ZHdpZHRoKSgKLQkJCXN0cnVjdCBkYyAqZGMsCi0JCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQp
OwotCi0Jdm9pZCAoKmV4aXRfb3B0aW1pemVkX3B3cl9zdGF0ZSkoCi0JCQljb25zdCBzdHJ1Y3Qg
ZGMgKmRjLAotCQkJc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KTsKLQl2b2lkICgqb3B0aW1pemVf
cHdyX3N0YXRlKSgKLQkJCWNvbnN0IHN0cnVjdCBkYyAqZGMsCi0JCQlzdHJ1Y3QgZGNfc3RhdGUg
KmNvbnRleHQpOwotCi0JYm9vbCAoKnVwZGF0ZV9iYW5kd2lkdGgpKAotCQkJc3RydWN0IGRjICpk
YywKLQkJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCk7CisJCQljb25zdCB1aW50OF90ICpjdXN0
b21fc2RwX21lc3NhZ2UsCisJCQl1bnNpZ25lZCBpbnQgc2RwX21lc3NhZ2Vfc2l6ZSk7CisJdm9p
ZCAoKnVwZGF0ZV9pbmZvX2ZyYW1lKShzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKKwl2b2lk
ICgqc2V0X2RtZGF0YV9hdHRyaWJ1dGVzKShzdHJ1Y3QgcGlwZV9jdHggKnBpcGUpOwogCXZvaWQg
KCpwcm9ncmFtX2RtZGF0YV9lbmdpbmUpKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOwogCWJv
b2wgKCpkbWRhdGFfc3RhdHVzX2RvbmUpKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOwogCi0J
dm9pZCAoKnNldF9kcnIpKHN0cnVjdCBwaXBlX2N0eCAqKnBpcGVfY3R4LCBpbnQgbnVtX3BpcGVz
LAotCQkJdW5zaWduZWQgaW50IHZtaW4sIHVuc2lnbmVkIGludCB2bWF4LAotCQkJdW5zaWduZWQg
aW50IHZtaWQsIHVuc2lnbmVkIGludCB2bWlkX2ZyYW1lX251bWJlcik7Ci0KLQl2b2lkICgqZ2V0
X3Bvc2l0aW9uKShzdHJ1Y3QgcGlwZV9jdHggKipwaXBlX2N0eCwgaW50IG51bV9waXBlcywKLQkJ
CXN0cnVjdCBjcnRjX3Bvc2l0aW9uICpwb3NpdGlvbik7Ci0KLQl2b2lkICgqc2V0X3N0YXRpY19z
Y3JlZW5fY29udHJvbCkoc3RydWN0IHBpcGVfY3R4ICoqcGlwZV9jdHgsCi0JCQlpbnQgbnVtX3Bp
cGVzLCBjb25zdCBzdHJ1Y3QgZGNfc3RhdGljX3NjcmVlbl9ldmVudHMgKmV2ZW50cyk7Ci0KLQll
bnVtIGRjX3N0YXR1cyAoKmVuYWJsZV9zdHJlYW1fdGltaW5nKSgKLQkJCXN0cnVjdCBwaXBlX2N0
eCAqcGlwZV9jdHgsCi0JCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQsCi0JCQlzdHJ1Y3QgZGMg
KmRjKTsKLQotCXZvaWQgKCpzZXR1cF9zdGVyZW8pKAotCQkJc3RydWN0IHBpcGVfY3R4ICpwaXBl
X2N0eCwKLQkJCXN0cnVjdCBkYyAqZGMpOwotCi0Jdm9pZCAoKnNldF9hdm11dGUpKHN0cnVjdCBw
aXBlX2N0eCAqcGlwZV9jdHgsIGJvb2wgZW5hYmxlKTsKLQotCXZvaWQgKCpsb2dfaHdfc3RhdGUp
KHN0cnVjdCBkYyAqZGMsCi0JCXN0cnVjdCBkY19sb2dfYnVmZmVyX2N0eCAqbG9nX2N0eCk7Ci0J
dm9pZCAoKmdldF9od19zdGF0ZSkoc3RydWN0IGRjICpkYywgY2hhciAqcEJ1ZiwgdW5zaWduZWQg
aW50IGJ1ZlNpemUsIHVuc2lnbmVkIGludCBtYXNrKTsKLQl2b2lkICgqY2xlYXJfc3RhdHVzX2Jp
dHMpKHN0cnVjdCBkYyAqZGMsIHVuc2lnbmVkIGludCBtYXNrKTsKLQotCXZvaWQgKCp3YWl0X2Zv
cl9tcGNjX2Rpc2Nvbm5lY3QpKHN0cnVjdCBkYyAqZGMsCi0JCQlzdHJ1Y3QgcmVzb3VyY2VfcG9v
bCAqcmVzX3Bvb2wsCi0JCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKLQotCXZvaWQgKCpl
ZHBfcG93ZXJfY29udHJvbCkoCi0JCQlzdHJ1Y3QgZGNfbGluayAqbGluaywKLQkJCWJvb2wgZW5h
YmxlKTsKLQl2b2lkICgqZWRwX2JhY2tsaWdodF9jb250cm9sKSgKLQkJCXN0cnVjdCBkY19saW5r
ICpsaW5rLAotCQkJYm9vbCBlbmFibGUpOwotCXZvaWQgKCplZHBfd2FpdF9mb3JfaHBkX3JlYWR5
KShzdHJ1Y3QgZGNfbGluayAqbGluaywgYm9vbCBwb3dlcl91cCk7Ci0KKwkvKiBDdXJzb3IgUmVs
YXRlZCAqLwogCXZvaWQgKCpzZXRfY3Vyc29yX3Bvc2l0aW9uKShzdHJ1Y3QgcGlwZV9jdHggKnBp
cGUpOwogCXZvaWQgKCpzZXRfY3Vyc29yX2F0dHJpYnV0ZSkoc3RydWN0IHBpcGVfY3R4ICpwaXBl
KTsKIAl2b2lkICgqc2V0X2N1cnNvcl9zZHJfd2hpdGVfbGV2ZWwpKHN0cnVjdCBwaXBlX2N0eCAq
cGlwZSk7CiAKLQl2b2lkICgqc2V0dXBfcGVyaW9kaWNfaW50ZXJydXB0KShzdHJ1Y3QgZGMgKmRj
LAotCQkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKLQkJCWVudW0gdmxpbmVfc2VsZWN0IHZs
aW5lKTsKLQl2b2lkICgqc2V0dXBfdnVwZGF0ZV9pbnRlcnJ1cHQpKHN0cnVjdCBkYyAqZGMsIHN0
cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOwotCWJvb2wgKCpkaWRfdW5kZXJmbG93X29jY3VyKShz
dHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKLQotCXZvaWQgKCppbml0
X2JsYW5rKShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgdGltaW5nX2dlbmVyYXRvciAqdGcpOwotCXZv
aWQgKCpkaXNhYmxlX3ZnYSkoc3RydWN0IGRjZV9od3NlcSAqaHdzKTsKLQl2b2lkICgqYmlvc19n
b2xkZW5faW5pdCkoc3RydWN0IGRjICpkYyk7Ci0Jdm9pZCAoKnBsYW5lX2F0b21pY19wb3dlcl9k
b3duKShzdHJ1Y3QgZGMgKmRjLAotCQkJc3RydWN0IGRwcCAqZHBwLAotCQkJc3RydWN0IGh1YnAg
Kmh1YnApOwotCi0Jdm9pZCAoKnBsYW5lX2F0b21pY19kaXNhYmxlKSgKLQkJCXN0cnVjdCBkYyAq
ZGMsIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOwotCi0Jdm9pZCAoKmVuYWJsZV9wb3dlcl9n
YXRpbmdfcGxhbmUpKAotCQlzdHJ1Y3QgZGNlX2h3c2VxICpod3MsCi0JCWJvb2wgZW5hYmxlKTsK
LQotCXZvaWQgKCpkcHBfcGdfY29udHJvbCkoCi0JCQlzdHJ1Y3QgZGNlX2h3c2VxICpod3MsCi0J
CQl1bnNpZ25lZCBpbnQgZHBwX2luc3QsCi0JCQlib29sIHBvd2VyX29uKTsKLQotCXZvaWQgKCpo
dWJwX3BnX2NvbnRyb2wpKAotCQkJc3RydWN0IGRjZV9od3NlcSAqaHdzLAotCQkJdW5zaWduZWQg
aW50IGh1YnBfaW5zdCwKLQkJCWJvb2wgcG93ZXJfb24pOwotCi0Jdm9pZCAoKmRzY19wZ19jb250
cm9sKSgKLQkJCXN0cnVjdCBkY2VfaHdzZXEgKmh3cywKLQkJCXVuc2lnbmVkIGludCBkc2NfaW5z
dCwKLQkJCWJvb2wgcG93ZXJfb24pOwotCisJLyogQ29sb3VyIFJlbGF0ZWQgKi8KKwl2b2lkICgq
cHJvZ3JhbV9nYW11dF9yZW1hcCkoc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCk7CisJdm9pZCAo
KnByb2dyYW1fb3V0cHV0X2NzYykoc3RydWN0IGRjICpkYywgc3RydWN0IHBpcGVfY3R4ICpwaXBl
X2N0eCwKKwkJCWVudW0gZGNfY29sb3Jfc3BhY2UgY29sb3JzcGFjZSwKKwkJCXVpbnQxNl90ICpt
YXRyaXgsIGludCBvcHBfaWQpOwogCi0Jdm9pZCAoKnVwZGF0ZV9vZG0pKHN0cnVjdCBkYyAqZGMs
IHN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCwgc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCk7Ci0J
dm9pZCAoKnByb2dyYW1fYWxsX3dyaXRlYmFja19waXBlc19pbl90cmVlKSgKKwkvKiBWTSBSZWxh
dGVkICovCisJaW50ICgqaW5pdF9zeXNfY3R4KShzdHJ1Y3QgZGNlX2h3c2VxICpod3MsCiAJCQlz
dHJ1Y3QgZGMgKmRjLAotCQkJY29uc3Qgc3RydWN0IGRjX3N0cmVhbV9zdGF0ZSAqc3RyZWFtLAot
CQkJc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KTsKKwkJCXN0cnVjdCBkY19waHlfYWRkcl9zcGFj
ZV9jb25maWcgKnBhX2NvbmZpZyk7CisJdm9pZCAoKmluaXRfdm1fY3R4KShzdHJ1Y3QgZGNlX2h3
c2VxICpod3MsCisJCQlzdHJ1Y3QgZGMgKmRjLAorCQkJc3RydWN0IGRjX3ZpcnR1YWxfYWRkcl9z
cGFjZV9jb25maWcgKnZhX2NvbmZpZywKKwkJCWludCB2bWlkKTsKKworCS8qIFdyaXRlYmFjayBS
ZWxhdGVkICovCiAJdm9pZCAoKnVwZGF0ZV93cml0ZWJhY2spKHN0cnVjdCBkYyAqZGMsCiAJCQlj
b25zdCBzdHJ1Y3QgZGNfc3RyZWFtX3N0YXR1cyAqc3RyZWFtX3N0YXR1cywKIAkJCXN0cnVjdCBk
Y193cml0ZWJhY2tfaW5mbyAqd2JfaW5mbywKQEAgLTMzMCw0NiArMTU4LDMyIEBAIHN0cnVjdCBo
d19zZXF1ZW5jZXJfZnVuY3MgewogCQkJc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KTsKIAl2b2lk
ICgqZGlzYWJsZV93cml0ZWJhY2spKHN0cnVjdCBkYyAqZGMsCiAJCQl1bnNpZ25lZCBpbnQgZHdi
X3BpcGVfaW5zdCk7Ci0JZW51bSBkY19zdGF0dXMgKCpzZXRfY2xvY2spKHN0cnVjdCBkYyAqZGMs
Ci0JCQllbnVtIGRjX2Nsb2NrX3R5cGUgY2xvY2tfdHlwZSwKLQkJCXVpbnQzMl90IGNsa19raHos
Ci0JCQl1aW50MzJfdCBzdGVwcGluZyk7CiAKLQl2b2lkICgqZ2V0X2Nsb2NrKShzdHJ1Y3QgZGMg
KmRjLAorCS8qIENsb2NrIFJlbGF0ZWQgKi8KKwllbnVtIGRjX3N0YXR1cyAoKnNldF9jbG9jayko
c3RydWN0IGRjICpkYywKIAkJCWVudW0gZGNfY2xvY2tfdHlwZSBjbG9ja190eXBlLAorCQkJdWlu
dDMyX3QgY2xrX2toeiwgdWludDMyX3Qgc3RlcHBpbmcpOworCXZvaWQgKCpnZXRfY2xvY2spKHN0
cnVjdCBkYyAqZGMsIGVudW0gZGNfY2xvY2tfdHlwZSBjbG9ja190eXBlLAogCQkJc3RydWN0IGRj
X2Nsb2NrX2NvbmZpZyAqY2xvY2tfY2ZnKTsKLQotCWJvb2wgKCpzMGkzX2dvbGRlbl9pbml0X3dh
KShzdHJ1Y3QgZGMgKmRjKTsKLQotCXZvaWQgKCpnZXRfc3VyZmFjZV92aXN1YWxfY29uZmlybV9j
b2xvcikoCi0JCQljb25zdCBzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAotCQkJc3RydWN0IHRn
X2NvbG9yICpjb2xvcik7Ci0KLQl2b2lkICgqZ2V0X2hkcl92aXN1YWxfY29uZmlybV9jb2xvciko
Ci0JCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAotCQkJc3RydWN0IHRnX2NvbG9yICpjb2xv
cik7Ci0KLQl2b2lkICgqc2V0X2hkcl9tdWx0aXBsaWVyKShzdHJ1Y3QgcGlwZV9jdHggKnBpcGVf
Y3R4KTsKLQotCXZvaWQgKCp2ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5nZV9oaWdoKShzdHJ1Y3Qg
ZGMgKmRjKTsKLQotCXZvaWQgKCpwcm9ncmFtX3BpcGUpKAotCQkJc3RydWN0IGRjICpkYywKLQkJ
CXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsCisJdm9pZCAoKm9wdGltaXplX3B3cl9zdGF0ZSko
Y29uc3Qgc3RydWN0IGRjICpkYywKKwkJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCk7CisJdm9p
ZCAoKmV4aXRfb3B0aW1pemVkX3B3cl9zdGF0ZSkoY29uc3Qgc3RydWN0IGRjICpkYywKIAkJCXN0
cnVjdCBkY19zdGF0ZSAqY29udGV4dCk7CiAKLQlib29sICgqd2FpdF9mb3JfYmxhbmtfY29tcGxl
dGUpKAotCQkJc3RydWN0IG91dHB1dF9waXhlbF9wcm9jZXNzb3IgKm9wcCk7CisJLyogQXVkaW8g
UmVsYXRlZCAqLworCXZvaWQgKCplbmFibGVfYXVkaW9fc3RyZWFtKShzdHJ1Y3QgcGlwZV9jdHgg
KnBpcGVfY3R4KTsKKwl2b2lkICgqZGlzYWJsZV9hdWRpb19zdHJlYW0pKHN0cnVjdCBwaXBlX2N0
eCAqcGlwZV9jdHgpOwogCi0Jdm9pZCAoKmRjY2dfaW5pdCkoc3RydWN0IGRjZV9od3NlcSAqaHdz
KTsKKwkvKiBTdGVyZW8gM0QgUmVsYXRlZCAqLworCXZvaWQgKCpzZXR1cF9zdGVyZW8pKHN0cnVj
dCBwaXBlX2N0eCAqcGlwZV9jdHgsIHN0cnVjdCBkYyAqZGMpOwogCi0JYm9vbCAoKnNldF9ibGVu
ZF9sdXQpKAotCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LCBjb25zdCBzdHJ1Y3QgZGNfcGxh
bmVfc3RhdGUgKnBsYW5lX3N0YXRlKTsKKwkvKiBIVyBTdGF0ZSBMb2dnaW5nIFJlbGF0ZWQgKi8K
Kwl2b2lkICgqbG9nX2h3X3N0YXRlKShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgZGNfbG9nX2J1ZmZl
cl9jdHggKmxvZ19jdHgpOworCXZvaWQgKCpnZXRfaHdfc3RhdGUpKHN0cnVjdCBkYyAqZGMsIGNo
YXIgKnBCdWYsCisJCQl1bnNpZ25lZCBpbnQgYnVmU2l6ZSwgdW5zaWduZWQgaW50IG1hc2spOwor
CXZvaWQgKCpjbGVhcl9zdGF0dXNfYml0cykoc3RydWN0IGRjICpkYywgdW5zaWduZWQgaW50IG1h
c2spOwogCi0JYm9vbCAoKnNldF9zaGFwZXJfM2RsdXQpKAotCQlzdHJ1Y3QgcGlwZV9jdHggKnBp
cGVfY3R4LCBjb25zdCBzdHJ1Y3QgZGNfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKTsKIAotCWlu
dCAoKmdldF92dXBkYXRlX29mZnNldF9mcm9tX3ZzeW5jKShzdHJ1Y3QgcGlwZV9jdHggKnBpcGVf
Y3R4KTsKIH07CiAKIHZvaWQgY29sb3Jfc3BhY2VfdG9fYmxhY2tfY29sb3IoCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3X3NlcXVlbmNlcl9wcml2YXRl
LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3X3NlcXVlbmNlcl9wcml2
YXRlLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi44YmEwNmYwMTU5
NzUKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5j
L2h3X3NlcXVlbmNlcl9wcml2YXRlLmgKQEAgLTAsMCArMSwxNTYgQEAKKy8qCisgKiBDb3B5cmln
aHQgMjAxNSBBZHZhbmNlZCBNaWNybyBEZXZpY2VzLCBJbmMuCisgKgorICogUGVybWlzc2lvbiBp
cyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5n
IGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9u
IGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRo
b3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmln
aHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3Vi
bGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBw
ZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRv
IHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJv
dmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBp
bmNsdWRlZCBpbgorICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUg
U29mdHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhP
VVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElO
RyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAor
ICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4g
IElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUgQ09QWVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1Io
UykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IKKyAqIE9USEVSIExJQUJJTElU
WSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAor
ICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FS
RSBPUiBUSEUgVVNFIE9SCisgKiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCisgKgor
ICogQXV0aG9yczogQU1ECisgKgorICovCisKKyNpZm5kZWYgX19EQ19IV19TRVFVRU5DRVJfUFJJ
VkFURV9IX18KKyNkZWZpbmUgX19EQ19IV19TRVFVRU5DRVJfUFJJVkFURV9IX18KKworI2luY2x1
ZGUgImRjX3R5cGVzLmgiCisKK2VudW0gcGlwZV9nYXRpbmdfY29udHJvbCB7CisJUElQRV9HQVRJ
TkdfQ09OVFJPTF9ESVNBQkxFID0gMCwKKwlQSVBFX0dBVElOR19DT05UUk9MX0VOQUJMRSwKKwlQ
SVBFX0dBVElOR19DT05UUk9MX0lOSVQKK307CisKK3N0cnVjdCBkY2VfaHdzZXFfd2EgeworCWJv
b2wgYmxuZF9jcnRjX3RyaWdnZXI7CisJYm9vbCBERUdWSURDTjEwXzI1MzsKKwlib29sIGZhbHNl
X29wdGNfdW5kZXJmbG93OworCWJvb2wgREVHVklEQ04xMF8yNTQ7CisJYm9vbCBERUdWSURDTjIx
OworfTsKKworc3RydWN0IGh3c2VxX3dhX3N0YXRlIHsKKwlib29sIERFR1ZJRENOMTBfMjUzX2Fw
cGxpZWQ7Cit9OworCitzdHJ1Y3QgcGlwZV9jdHg7CitzdHJ1Y3QgZGNfc3RhdGU7CitzdHJ1Y3Qg
ZGNfc3RyZWFtX3N0YXR1czsKK3N0cnVjdCBkY193cml0ZWJhY2tfaW5mbzsKK3N0cnVjdCBkY2h1
Yl9pbml0X2RhdGE7CitzdHJ1Y3QgZGNfc3RhdGljX3NjcmVlbl9ldmVudHM7CitzdHJ1Y3QgcmVz
b3VyY2VfcG9vbDsKK3N0cnVjdCByZXNvdXJjZV9jb250ZXh0Oworc3RydWN0IHN0cmVhbV9yZXNv
dXJjZTsKK3N0cnVjdCBkY19waHlfYWRkcl9zcGFjZV9jb25maWc7CitzdHJ1Y3QgZGNfdmlydHVh
bF9hZGRyX3NwYWNlX2NvbmZpZzsKK3N0cnVjdCBodWJwOworc3RydWN0IGRwcDsKK3N0cnVjdCBk
Y2VfaHdzZXE7CitzdHJ1Y3QgdGltaW5nX2dlbmVyYXRvcjsKK3N0cnVjdCB0Z19jb2xvcjsKK3N0
cnVjdCBvdXRwdXRfcGl4ZWxfcHJvY2Vzc29yOworCitzdHJ1Y3QgaHdzZXFfcHJpdmF0ZV9mdW5j
cyB7CisKKwl2b2lkICgqZGlzYWJsZV9zdHJlYW1fZ2F0aW5nKShzdHJ1Y3QgZGMgKmRjLCBzdHJ1
Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKKwl2b2lkICgqZW5hYmxlX3N0cmVhbV9nYXRpbmcpKHN0
cnVjdCBkYyAqZGMsIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOworCXZvaWQgKCppbml0X3Bp
cGVzKShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpOworCXZvaWQgKCpy
ZXNldF9od19jdHhfd3JhcCkoc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3N0YXRlICpjb250ZXh0
KTsKKwl2b2lkICgqdXBkYXRlX3BsYW5lX2FkZHIpKGNvbnN0IHN0cnVjdCBkYyAqZGMsCisJCQlz
dHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKKwl2b2lkICgqcGxhbmVfYXRvbWljX2Rpc2Nvbm5l
Y3QpKHN0cnVjdCBkYyAqZGMsCisJCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKKwl2b2lk
ICgqdXBkYXRlX21wY2MpKHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgp
OworCWJvb2wgKCpzZXRfaW5wdXRfdHJhbnNmZXJfZnVuYykoc3RydWN0IGRjICpkYywKKwkJCQlz
dHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAorCQkJCWNvbnN0IHN0cnVjdCBkY19wbGFuZV9zdGF0
ZSAqcGxhbmVfc3RhdGUpOworCWJvb2wgKCpzZXRfb3V0cHV0X3RyYW5zZmVyX2Z1bmMpKHN0cnVj
dCBkYyAqZGMsCisJCQkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKKwkJCQljb25zdCBzdHJ1
Y3QgZGNfc3RyZWFtX3N0YXRlICpzdHJlYW0pOworCXZvaWQgKCpwb3dlcl9kb3duKShzdHJ1Y3Qg
ZGMgKmRjKTsKKwl2b2lkICgqZW5hYmxlX2Rpc3BsYXlfcGlwZV9jbG9ja19nYXRpbmcpKHN0cnVj
dCBkY19jb250ZXh0ICpjdHgsCisJCQkJCWJvb2wgY2xvY2tfZ2F0aW5nKTsKKwlib29sICgqZW5h
YmxlX2Rpc3BsYXlfcG93ZXJfZ2F0aW5nKShzdHJ1Y3QgZGMgKmRjLAorCQkJCQl1aW50OF90IGNv
bnRyb2xsZXJfaWQsCisJCQkJCXN0cnVjdCBkY19iaW9zICpkY2IsCisJCQkJCWVudW0gcGlwZV9n
YXRpbmdfY29udHJvbCBwb3dlcl9nYXRpbmcpOworCXZvaWQgKCpibGFua19waXhlbF9kYXRhKShz
dHJ1Y3QgZGMgKmRjLAorCQkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKKwkJCWJvb2wgYmxh
bmspOworCWVudW0gZGNfc3RhdHVzICgqZW5hYmxlX3N0cmVhbV90aW1pbmcpKAorCQkJc3RydWN0
IHBpcGVfY3R4ICpwaXBlX2N0eCwKKwkJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCwKKwkJCXN0
cnVjdCBkYyAqZGMpOworCXZvaWQgKCplZHBfYmFja2xpZ2h0X2NvbnRyb2wpKHN0cnVjdCBkY19s
aW5rICpsaW5rLAorCQkJYm9vbCBlbmFibGUpOworCXZvaWQgKCpzZXR1cF92dXBkYXRlX2ludGVy
cnVwdCkoc3RydWN0IGRjICpkYywKKwkJCXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOworCWJv
b2wgKCpkaWRfdW5kZXJmbG93X29jY3VyKShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlwZV9jdHgg
KnBpcGVfY3R4KTsKKwl2b2lkICgqaW5pdF9ibGFuaykoc3RydWN0IGRjICpkYywgc3RydWN0IHRp
bWluZ19nZW5lcmF0b3IgKnRnKTsKKwl2b2lkICgqZGlzYWJsZV92Z2EpKHN0cnVjdCBkY2VfaHdz
ZXEgKmh3cyk7CisJdm9pZCAoKmJpb3NfZ29sZGVuX2luaXQpKHN0cnVjdCBkYyAqZGMpOworCXZv
aWQgKCpwbGFuZV9hdG9taWNfcG93ZXJfZG93bikoc3RydWN0IGRjICpkYywKKwkJCXN0cnVjdCBk
cHAgKmRwcCwKKwkJCXN0cnVjdCBodWJwICpodWJwKTsKKwl2b2lkICgqcGxhbmVfYXRvbWljX2Rp
c2FibGUpKHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOworCXZvaWQg
KCplbmFibGVfcG93ZXJfZ2F0aW5nX3BsYW5lKShzdHJ1Y3QgZGNlX2h3c2VxICpod3MsCisJCWJv
b2wgZW5hYmxlKTsKKwl2b2lkICgqZHBwX3BnX2NvbnRyb2wpKHN0cnVjdCBkY2VfaHdzZXEgKmh3
cywKKwkJCXVuc2lnbmVkIGludCBkcHBfaW5zdCwKKwkJCWJvb2wgcG93ZXJfb24pOworCXZvaWQg
KCpodWJwX3BnX2NvbnRyb2wpKHN0cnVjdCBkY2VfaHdzZXEgKmh3cywKKwkJCXVuc2lnbmVkIGlu
dCBodWJwX2luc3QsCisJCQlib29sIHBvd2VyX29uKTsKKwl2b2lkICgqZHNjX3BnX2NvbnRyb2wp
KHN0cnVjdCBkY2VfaHdzZXEgKmh3cywKKwkJCXVuc2lnbmVkIGludCBkc2NfaW5zdCwKKwkJCWJv
b2wgcG93ZXJfb24pOworCXZvaWQgKCp1cGRhdGVfb2RtKShzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3Qg
ZGNfc3RhdGUgKmNvbnRleHQsCisJCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKKwl2b2lk
ICgqcHJvZ3JhbV9hbGxfd3JpdGViYWNrX3BpcGVzX2luX3RyZWUpKHN0cnVjdCBkYyAqZGMsCisJ
CQljb25zdCBzdHJ1Y3QgZGNfc3RyZWFtX3N0YXRlICpzdHJlYW0sCisJCQlzdHJ1Y3QgZGNfc3Rh
dGUgKmNvbnRleHQpOworCWJvb2wgKCpzMGkzX2dvbGRlbl9pbml0X3dhKShzdHJ1Y3QgZGMgKmRj
KTsKKwl2b2lkICgqZ2V0X3N1cmZhY2VfdmlzdWFsX2NvbmZpcm1fY29sb3IpKAorCQkJY29uc3Qg
c3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKKwkJCXN0cnVjdCB0Z19jb2xvciAqY29sb3IpOwor
CXZvaWQgKCpnZXRfaGRyX3Zpc3VhbF9jb25maXJtX2NvbG9yKShzdHJ1Y3QgcGlwZV9jdHggKnBp
cGVfY3R4LAorCQkJc3RydWN0IHRnX2NvbG9yICpjb2xvcik7CisJdm9pZCAoKnNldF9oZHJfbXVs
dGlwbGllcikoc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCk7CisJdm9pZCAoKnZlcmlmeV9hbGxv
d19wc3RhdGVfY2hhbmdlX2hpZ2gpKHN0cnVjdCBkYyAqZGMpOworCXZvaWQgKCpwcm9ncmFtX3Bp
cGUpKHN0cnVjdCBkYyAqZGMsCisJCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAorCQkJc3Ry
dWN0IGRjX3N0YXRlICpjb250ZXh0KTsKKwlib29sICgqd2FpdF9mb3JfYmxhbmtfY29tcGxldGUp
KHN0cnVjdCBvdXRwdXRfcGl4ZWxfcHJvY2Vzc29yICpvcHApOworCXZvaWQgKCpkY2NnX2luaXQp
KHN0cnVjdCBkY2VfaHdzZXEgKmh3cyk7CisJYm9vbCAoKnNldF9ibGVuZF9sdXQpKHN0cnVjdCBw
aXBlX2N0eCAqcGlwZV9jdHgsCisJCQljb25zdCBzdHJ1Y3QgZGNfcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlKTsKKwlib29sICgqc2V0X3NoYXBlcl8zZGx1dCkoc3RydWN0IHBpcGVfY3R4ICpwaXBl
X2N0eCwKKwkJCWNvbnN0IHN0cnVjdCBkY19wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpOworfTsK
Kworc3RydWN0IGRjZV9od3NlcSB7CisJc3RydWN0IGRjX2NvbnRleHQgKmN0eDsKKwljb25zdCBz
dHJ1Y3QgZGNlX2h3c2VxX3JlZ2lzdGVycyAqcmVnczsKKwljb25zdCBzdHJ1Y3QgZGNlX2h3c2Vx
X3NoaWZ0ICpzaGlmdHM7CisJY29uc3Qgc3RydWN0IGRjZV9od3NlcV9tYXNrICptYXNrczsKKwlz
dHJ1Y3QgZGNlX2h3c2VxX3dhIHdhOworCXN0cnVjdCBod3NlcV93YV9zdGF0ZSB3YV9zdGF0ZTsK
KwlzdHJ1Y3QgaHdzZXFfcHJpdmF0ZV9mdW5jcyBmdW5jczsKKworfTsKKworI2VuZGlmIC8qIF9f
RENfSFdfU0VRVUVOQ0VSX1BSSVZBVEVfSF9fICovCi0tIAoyLjI0LjAKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFt
ZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
