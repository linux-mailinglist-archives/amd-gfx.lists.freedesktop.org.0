Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 137B5330FAF
	for <lists+amd-gfx@lfdr.de>; Mon,  8 Mar 2021 14:40:53 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9C7E389F85;
	Mon,  8 Mar 2021 13:40:49 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-ed1-x52e.google.com (mail-ed1-x52e.google.com
 [IPv6:2a00:1450:4864:20::52e])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 576CA89EA3
 for <amd-gfx@lists.freedesktop.org>; Mon,  8 Mar 2021 13:40:48 +0000 (UTC)
Received: by mail-ed1-x52e.google.com with SMTP id dm26so14735477edb.12
 for <amd-gfx@lists.freedesktop.org>; Mon, 08 Mar 2021 05:40:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=2NpVZWh16Kf3eTyKRtL7aoFSP24oygQAyPaHRC7nmgs=;
 b=DCgsw51C4JrelDUHt/QCqTF0FsiHzn/4n3FKOYfnwFKKYpuweceFsYaktoNcl61Nhz
 hoiyiifncWEMF7BFqksRR7S57RqVVrz7GgSV9qj+VIc7K/LnIN2ui3vZqi1Xe+5MiMTv
 M+o1hslB+5JTdrP/pHSQMy2AwY5Ry/4sBgLJTeZuurkiwO1BZ3Ex//6kZO9/2ENKfY/g
 WlTFCzb0B3nvWNTofZdNNg4bgnHDFicKTeQQ/XJqxTCLhcndolp4DiHrh87yt+TWEwPv
 6GtTywxha8yv85WJR7n+O3gM9Mr1LOO94Ei9e+zU5FQbDrUjHMMhfzHBFLc6740xxMD/
 De5A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=2NpVZWh16Kf3eTyKRtL7aoFSP24oygQAyPaHRC7nmgs=;
 b=ZihUw7X8PLBdGouamn3OhEVnA0gSGRTXI1RooHi3kuS1oBwDHNx7NotpNRgXe4WpE6
 2SzTPvT1Pc5j0SWBtwmTdmFvIxUZaGw/Ry7a1o/AHZFoYMir2y1CTYKNYQiWkOQtb4TB
 E8vmPcaMmHkvRgB1l1+Jtf7lPKUcs8NC2BHL0/8484/PhK5NDcrNe1L4r0aLysNpeunc
 nQlQh307FLnJvtzUGvF1EngsKsQI24twgv42VjXt274BTAaeBMioUEptmXT2ceVvXDHX
 HRx0lGH6OBayVk/rPkab65XojgHdWPhkF62eHoays+ofOOPfdJ2SVgRltkn9vChJ2psO
 RaMQ==
X-Gm-Message-State: AOAM533aBTAYW54JdOZ5TtcfLeOJIDufl+joZfnNCFDMfUcCV2bovmnF
 c6oT3dl7c/36iWiI0MkT5jS8fmtzCJODgg==
X-Google-Smtp-Source: ABdhPJyhfkDgHZQNhbhGC7RC1p3Gkth2D7kviq99HGBhXnOR2almYygZVH3inaAXy+U7xZVMGYGgIg==
X-Received: by 2002:a05:6402:1d92:: with SMTP id
 dk18mr21869373edb.161.1615210847006; 
 Mon, 08 Mar 2021 05:40:47 -0800 (PST)
Received: from abel.fritz.box ([2a02:908:1252:fb60:f480:31ac:e949:bf58])
 by smtp.gmail.com with ESMTPSA id s18sm6655701ejc.79.2021.03.08.05.40.46
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 08 Mar 2021 05:40:46 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: Arunpravin.PaneerSelvam@amd.com,
	amd-gfx@lists.freedesktop.org
Subject: [PATCH 2/8] drm/amdgpu: use the new cursor in
 amdgpu_ttm_copy_mem_to_mem
Date: Mon,  8 Mar 2021 14:40:38 +0100
Message-Id: <20210308134044.133658-2-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210308134044.133658-1-christian.koenig@amd.com>
References: <20210308134044.133658-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

U2VwYXJhdGUgdGhlIGRybV9tbV9ub2RlIHdhbGtpbmcgZnJvbSB0aGUgYWN0dWFsIGhhbmRsaW5n
LgoKU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQu
Y29tPgpBY2tlZC1ieTogT2FrIFplbmcgPE9hay5aZW5nQGFtZC5jb20+ClRlc3RlZC1ieTogTmly
bW95IERhcyA8bmlybW95LmRhc0BhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV90dG0uYyB8IDg3ICsrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBj
aGFuZ2VkLCAyNiBpbnNlcnRpb25zKCspLCA2MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfdHRtLmMKaW5kZXggMzc3NTFlN2U0ZWRjLi5mNzFhOWZmMDY3NDgg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMKQEAgLTU2LDYgKzU2LDcg
QEAKICNpbmNsdWRlICJhbWRncHVfc2RtYS5oIgogI2luY2x1ZGUgImFtZGdwdV9yYXMuaCIKICNp
bmNsdWRlICJhbWRncHVfYXRvbWZpcm13YXJlLmgiCisjaW5jbHVkZSAiYW1kZ3B1X3Jlc19jdXJz
b3IuaCIKICNpbmNsdWRlICJiaWYvYmlmXzRfMV9kLmgiCiAKICNkZWZpbmUgQU1ER1BVX1RUTV9W
UkFNX01BWF9EV19SRUFECShzaXplX3QpMTI4CkBAIC0yMjMsOSArMjI0LDggQEAgc3RhdGljIHN0
cnVjdCBkcm1fbW1fbm9kZSAqYW1kZ3B1X2ZpbmRfbW1fbm9kZShzdHJ1Y3QgdHRtX3Jlc291cmNl
ICptZW0sCiAgKiBhbWRncHVfdHRtX21hcF9idWZmZXIgLSBNYXAgbWVtb3J5IGludG8gdGhlIEdB
UlQgd2luZG93cwogICogQGJvOiBidWZmZXIgb2JqZWN0IHRvIG1hcAogICogQG1lbTogbWVtb3J5
IG9iamVjdCB0byBtYXAKLSAqIEBtbV9ub2RlOiBkcm1fbW0gbm9kZSBvYmplY3QgdG8gbWFwCisg
KiBAbW1fY3VyOiByYW5nZSB0byBtYXAKICAqIEBudW1fcGFnZXM6IG51bWJlciBvZiBwYWdlcyB0
byBtYXAKLSAqIEBvZmZzZXQ6IG9mZnNldCBpbnRvIEBtbV9ub2RlIHdoZXJlIHRvIHN0YXJ0CiAg
KiBAd2luZG93OiB3aGljaCBHQVJUIHdpbmRvdyB0byB1c2UKICAqIEByaW5nOiBETUEgcmluZyB0
byB1c2UgZm9yIHRoZSBjb3B5CiAgKiBAdG16OiBpZiB3ZSBzaG91bGQgc2V0dXAgYSBUTVogZW5h
YmxlZCBtYXBwaW5nCkBAIC0yMzYsMTAgKzIzNiwxMCBAQCBzdGF0aWMgc3RydWN0IGRybV9tbV9u
b2RlICphbWRncHVfZmluZF9tbV9ub2RlKHN0cnVjdCB0dG1fcmVzb3VyY2UgKm1lbSwKICAqLwog
c3RhdGljIGludCBhbWRncHVfdHRtX21hcF9idWZmZXIoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0
ICpibywKIAkJCQkgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtLAotCQkJCSBzdHJ1Y3QgZHJtX21t
X25vZGUgKm1tX25vZGUsCi0JCQkJIHVuc2lnbmVkIG51bV9wYWdlcywgdWludDY0X3Qgb2Zmc2V0
LAotCQkJCSB1bnNpZ25lZCB3aW5kb3csIHN0cnVjdCBhbWRncHVfcmluZyAqcmluZywKLQkJCQkg
Ym9vbCB0bXosIHVpbnQ2NF90ICphZGRyKQorCQkJCSBzdHJ1Y3QgYW1kZ3B1X3Jlc19jdXJzb3Ig
Km1tX2N1ciwKKwkJCQkgdW5zaWduZWQgbnVtX3BhZ2VzLCB1bnNpZ25lZCB3aW5kb3csCisJCQkJ
IHN0cnVjdCBhbWRncHVfcmluZyAqcmluZywgYm9vbCB0bXosCisJCQkJIHVpbnQ2NF90ICphZGRy
KQogewogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gcmluZy0+YWRldjsKIAlzdHJ1Y3Qg
YW1kZ3B1X2pvYiAqam9iOwpAQCAtMjU2LDE0ICsyNTYsMTUgQEAgc3RhdGljIGludCBhbWRncHVf
dHRtX21hcF9idWZmZXIoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAogCS8qIE1hcCBv
bmx5IHdoYXQgY2FuJ3QgYmUgYWNjZXNzZWQgZGlyZWN0bHkgKi8KIAlpZiAoIXRteiAmJiBtZW0t
PnN0YXJ0ICE9IEFNREdQVV9CT19JTlZBTElEX09GRlNFVCkgewotCQkqYWRkciA9IGFtZGdwdV9t
bV9ub2RlX2FkZHIoYm8sIG1tX25vZGUsIG1lbSkgKyBvZmZzZXQ7CisJCSphZGRyID0gYW1kZ3B1
X3R0bV9kb21haW5fc3RhcnQoYWRldiwgbWVtLT5tZW1fdHlwZSkgKworCQkJbW1fY3VyLT5zdGFy
dDsKIAkJcmV0dXJuIDA7CiAJfQogCiAJKmFkZHIgPSBhZGV2LT5nbWMuZ2FydF9zdGFydDsKIAkq
YWRkciArPSAodTY0KXdpbmRvdyAqIEFNREdQVV9HVFRfTUFYX1RSQU5TRkVSX1NJWkUgKgogCQlB
TURHUFVfR1BVX1BBR0VfU0laRTsKLQkqYWRkciArPSBvZmZzZXQgJiB+UEFHRV9NQVNLOworCSph
ZGRyICs9IG1tX2N1ci0+c3RhcnQgJiB+UEFHRV9NQVNLOwogCiAJbnVtX2R3ID0gQUxJR04oYWRl
di0+bW1hbi5idWZmZXJfZnVuY3MtPmNvcHlfbnVtX2R3LCA4KTsKIAludW1fYnl0ZXMgPSBudW1f
cGFnZXMgKiA4OwpAQCAtMjkxLDE3ICsyOTIsMTcgQEAgc3RhdGljIGludCBhbWRncHVfdHRtX21h
cF9idWZmZXIoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywKIAljcHVfYWRkciA9ICZqb2It
Pmlic1swXS5wdHJbbnVtX2R3XTsKIAogCWlmIChtZW0tPm1lbV90eXBlID09IFRUTV9QTF9UVCkg
ewotCQlkbWFfYWRkcl90ICpkbWFfYWRkcmVzczsKKwkJZG1hX2FkZHJfdCAqZG1hX2FkZHI7CiAK
LQkJZG1hX2FkZHJlc3MgPSAmYm8tPnR0bS0+ZG1hX2FkZHJlc3Nbb2Zmc2V0ID4+IFBBR0VfU0hJ
RlRdOwotCQlyID0gYW1kZ3B1X2dhcnRfbWFwKGFkZXYsIDAsIG51bV9wYWdlcywgZG1hX2FkZHJl
c3MsIGZsYWdzLAorCQlkbWFfYWRkciA9ICZiby0+dHRtLT5kbWFfYWRkcmVzc1ttbV9jdXItPnN0
YXJ0ID4+IFBBR0VfU0hJRlRdOworCQlyID0gYW1kZ3B1X2dhcnRfbWFwKGFkZXYsIDAsIG51bV9w
YWdlcywgZG1hX2FkZHIsIGZsYWdzLAogCQkJCSAgICBjcHVfYWRkcik7CiAJCWlmIChyKQogCQkJ
Z290byBlcnJvcl9mcmVlOwogCX0gZWxzZSB7CiAJCWRtYV9hZGRyX3QgZG1hX2FkZHJlc3M7CiAK
LQkJZG1hX2FkZHJlc3MgPSAobW1fbm9kZS0+c3RhcnQgPDwgUEFHRV9TSElGVCkgKyBvZmZzZXQ7
CisJCWRtYV9hZGRyZXNzID0gbW1fY3VyLT5zdGFydDsKIAkJZG1hX2FkZHJlc3MgKz0gYWRldi0+
dm1fbWFuYWdlci52cmFtX2Jhc2Vfb2Zmc2V0OwogCiAJCWZvciAoaSA9IDA7IGkgPCBudW1fcGFn
ZXM7ICsraSkgewpAQCAtMzUzLDkgKzM1NCw4IEBAIGludCBhbWRncHVfdHRtX2NvcHlfbWVtX3Rv
X21lbShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAljb25zdCB1aW50MzJfdCBHVFRfTUFY
X0JZVEVTID0gKEFNREdQVV9HVFRfTUFYX1RSQU5TRkVSX1NJWkUgKgogCQkJCQlBTURHUFVfR1BV
X1BBR0VfU0laRSk7CiAKLQl1aW50NjRfdCBzcmNfbm9kZV9zaXplLCBkc3Rfbm9kZV9zaXplLCBz
cmNfb2Zmc2V0LCBkc3Rfb2Zmc2V0OwogCXN0cnVjdCBhbWRncHVfcmluZyAqcmluZyA9IGFkZXYt
Pm1tYW4uYnVmZmVyX2Z1bmNzX3Jpbmc7Ci0Jc3RydWN0IGRybV9tbV9ub2RlICpzcmNfbW0sICpk
c3RfbW07CisJc3RydWN0IGFtZGdwdV9yZXNfY3Vyc29yIHNyY19tbSwgZHN0X21tOwogCXN0cnVj
dCBkbWFfZmVuY2UgKmZlbmNlID0gTlVMTDsKIAlpbnQgciA9IDA7CiAKQEAgLTM2NCwyOSArMzY0
LDEzIEBAIGludCBhbWRncHVfdHRtX2NvcHlfbWVtX3RvX21lbShzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwKIAkJcmV0dXJuIC1FSU5WQUw7CiAJfQogCi0Jc3JjX29mZnNldCA9IHNyYy0+b2Zm
c2V0OwotCWlmIChzcmMtPm1lbS0+bW1fbm9kZSkgewotCQlzcmNfbW0gPSBhbWRncHVfZmluZF9t
bV9ub2RlKHNyYy0+bWVtLCAmc3JjX29mZnNldCk7Ci0JCXNyY19ub2RlX3NpemUgPSAoc3JjX21t
LT5zaXplIDw8IFBBR0VfU0hJRlQpIC0gc3JjX29mZnNldDsKLQl9IGVsc2UgewotCQlzcmNfbW0g
PSBOVUxMOwotCQlzcmNfbm9kZV9zaXplID0gVUxMT05HX01BWDsKLQl9Ci0KLQlkc3Rfb2Zmc2V0
ID0gZHN0LT5vZmZzZXQ7Ci0JaWYgKGRzdC0+bWVtLT5tbV9ub2RlKSB7Ci0JCWRzdF9tbSA9IGFt
ZGdwdV9maW5kX21tX25vZGUoZHN0LT5tZW0sICZkc3Rfb2Zmc2V0KTsKLQkJZHN0X25vZGVfc2l6
ZSA9IChkc3RfbW0tPnNpemUgPDwgUEFHRV9TSElGVCkgLSBkc3Rfb2Zmc2V0OwotCX0gZWxzZSB7
Ci0JCWRzdF9tbSA9IE5VTEw7Ci0JCWRzdF9ub2RlX3NpemUgPSBVTExPTkdfTUFYOwotCX0KKwlh
bWRncHVfcmVzX2ZpcnN0KHNyYy0+bWVtLCBzcmMtPm9mZnNldCwgc2l6ZSwgJnNyY19tbSk7CisJ
YW1kZ3B1X3Jlc19maXJzdChkc3QtPm1lbSwgZHN0LT5vZmZzZXQsIHNpemUsICZkc3RfbW0pOwog
CiAJbXV0ZXhfbG9jaygmYWRldi0+bW1hbi5ndHRfd2luZG93X2xvY2spOwotCi0Jd2hpbGUgKHNp
emUpIHsKLQkJdWludDMyX3Qgc3JjX3BhZ2Vfb2Zmc2V0ID0gc3JjX29mZnNldCAmIH5QQUdFX01B
U0s7Ci0JCXVpbnQzMl90IGRzdF9wYWdlX29mZnNldCA9IGRzdF9vZmZzZXQgJiB+UEFHRV9NQVNL
OworCXdoaWxlIChzcmNfbW0ucmVtYWluaW5nKSB7CisJCXVpbnQzMl90IHNyY19wYWdlX29mZnNl
dCA9IHNyY19tbS5zdGFydCAmIH5QQUdFX01BU0s7CisJCXVpbnQzMl90IGRzdF9wYWdlX29mZnNl
dCA9IGRzdF9tbS5zdGFydCAmIH5QQUdFX01BU0s7CiAJCXN0cnVjdCBkbWFfZmVuY2UgKm5leHQ7
CiAJCXVpbnQzMl90IGN1cl9zaXplOwogCQl1aW50NjRfdCBmcm9tLCB0bzsKQEAgLTM5NSwxOSAr
Mzc5LDE5IEBAIGludCBhbWRncHVfdHRtX2NvcHlfbWVtX3RvX21lbShzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldiwKIAkJICogYmVnaW5zIGF0IGFuIG9mZnNldCwgdGhlbiBhZGp1c3QgdGhlIHNp
emUgYWNjb3JkaW5nbHkKIAkJICovCiAJCWN1cl9zaXplID0gbWF4KHNyY19wYWdlX29mZnNldCwg
ZHN0X3BhZ2Vfb2Zmc2V0KTsKLQkJY3VyX3NpemUgPSBtaW4obWluMyhzcmNfbm9kZV9zaXplLCBk
c3Rfbm9kZV9zaXplLCBzaXplKSwKKwkJY3VyX3NpemUgPSBtaW4obWluMyhzcmNfbW0uc2l6ZSwg
ZHN0X21tLnNpemUsIHNpemUpLAogCQkJICAgICAgICh1aW50NjRfdCkoR1RUX01BWF9CWVRFUyAt
IGN1cl9zaXplKSk7CiAKIAkJLyogTWFwIHNyYyB0byB3aW5kb3cgMCBhbmQgZHN0IHRvIHdpbmRv
dyAxLiAqLwotCQlyID0gYW1kZ3B1X3R0bV9tYXBfYnVmZmVyKHNyYy0+Ym8sIHNyYy0+bWVtLCBz
cmNfbW0sCisJCXIgPSBhbWRncHVfdHRtX21hcF9idWZmZXIoc3JjLT5ibywgc3JjLT5tZW0sICZz
cmNfbW0sCiAJCQkJCSAgUEZOX1VQKGN1cl9zaXplICsgc3JjX3BhZ2Vfb2Zmc2V0KSwKLQkJCQkJ
ICBzcmNfb2Zmc2V0LCAwLCByaW5nLCB0bXosICZmcm9tKTsKKwkJCQkJICAwLCByaW5nLCB0bXos
ICZmcm9tKTsKIAkJaWYgKHIpCiAJCQlnb3RvIGVycm9yOwogCi0JCXIgPSBhbWRncHVfdHRtX21h
cF9idWZmZXIoZHN0LT5ibywgZHN0LT5tZW0sIGRzdF9tbSwKKwkJciA9IGFtZGdwdV90dG1fbWFw
X2J1ZmZlcihkc3QtPmJvLCBkc3QtPm1lbSwgJmRzdF9tbSwKIAkJCQkJICBQRk5fVVAoY3VyX3Np
emUgKyBkc3RfcGFnZV9vZmZzZXQpLAotCQkJCQkgIGRzdF9vZmZzZXQsIDEsIHJpbmcsIHRteiwg
JnRvKTsKKwkJCQkJICAxLCByaW5nLCB0bXosICZ0byk7CiAJCWlmIChyKQogCQkJZ290byBlcnJv
cjsKIApAQCAtNDE5LDI3ICs0MDMsOCBAQCBpbnQgYW1kZ3B1X3R0bV9jb3B5X21lbV90b19tZW0o
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJCWRtYV9mZW5jZV9wdXQoZmVuY2UpOwogCQlm
ZW5jZSA9IG5leHQ7CiAKLQkJc2l6ZSAtPSBjdXJfc2l6ZTsKLQkJaWYgKCFzaXplKQotCQkJYnJl
YWs7Ci0KLQkJc3JjX25vZGVfc2l6ZSAtPSBjdXJfc2l6ZTsKLQkJaWYgKCFzcmNfbm9kZV9zaXpl
KSB7Ci0JCQkrK3NyY19tbTsKLQkJCXNyY19ub2RlX3NpemUgPSBzcmNfbW0tPnNpemUgPDwgUEFH
RV9TSElGVDsKLQkJCXNyY19vZmZzZXQgPSAwOwotCQl9IGVsc2UgewotCQkJc3JjX29mZnNldCAr
PSBjdXJfc2l6ZTsKLQkJfQotCi0JCWRzdF9ub2RlX3NpemUgLT0gY3VyX3NpemU7Ci0JCWlmICgh
ZHN0X25vZGVfc2l6ZSkgewotCQkJKytkc3RfbW07Ci0JCQlkc3Rfbm9kZV9zaXplID0gZHN0X21t
LT5zaXplIDw8IFBBR0VfU0hJRlQ7Ci0JCQlkc3Rfb2Zmc2V0ID0gMDsKLQkJfSBlbHNlIHsKLQkJ
CWRzdF9vZmZzZXQgKz0gY3VyX3NpemU7Ci0JCX0KKwkJYW1kZ3B1X3Jlc19uZXh0KCZzcmNfbW0s
IGN1cl9zaXplKTsKKwkJYW1kZ3B1X3Jlc19uZXh0KCZkc3RfbW0sIGN1cl9zaXplKTsKIAl9CiBl
cnJvcjoKIAltdXRleF91bmxvY2soJmFkZXYtPm1tYW4uZ3R0X3dpbmRvd19sb2NrKTsKLS0gCjIu
MjUuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1k
LWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4Cg==
