Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 16405A0610
	for <lists+amd-gfx@lfdr.de>; Wed, 28 Aug 2019 17:20:02 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A3A0C89203;
	Wed, 28 Aug 2019 15:20:00 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qk1-x731.google.com (mail-qk1-x731.google.com
 [IPv6:2607:f8b0:4864:20::731])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4D9DF891C5
 for <amd-gfx@lists.freedesktop.org>; Wed, 28 Aug 2019 15:19:56 +0000 (UTC)
Received: by mail-qk1-x731.google.com with SMTP id s14so89623qkm.4
 for <amd-gfx@lists.freedesktop.org>; Wed, 28 Aug 2019 08:19:56 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=UwQjo+lNOhUbO4pjzo3rldNRwR2MolR6jzxxUCmls9Q=;
 b=O/3ROz72RdWqBsyZX36rtnOGJFOe9MZmUvwbpBOr5IR9Vaf0aoWJOmbUlgFsFA0yxg
 c1ZMODdnGu3MEhNBdzim3+CZ0+Bao5tbjanxZN0czrunukgfhLv5T9qzMd14rhzfeWa3
 i9yWTW+hMG1gWZdSeb9mXDUTroFjAPcwvYkSj8QCfkJyp0EA75kSZswjDnXXqubCMJIV
 yOv1BFW2UmJjFsZ9ZFr4GPTlp6VEj9+F56M8M2OjxXeJLYVYDsgG0ETnfE+Ky0XyiMQo
 G6SmJt5qebjz100lPH3iFyppuAMMs4PEJ8Ty6yzKW6GizmZlVGN/aqE/+rEm5Y9Wix9S
 HFRw==
X-Gm-Message-State: APjAAAX7zxyUNfnuRMAmGsDAeO0rmDlzo1hc/Q5FyrQCeeC8GvXMyEya
 f6ms02tbH8/va+Zlpm5V1qdRskrH
X-Google-Smtp-Source: APXvYqxZoPgdOKm/NV/vvs1eb+j7ye6hmSi3MsFpHkfNXJwSYGBpOjsBmtkhfEIlYZI6hyC+ZS1yXg==
X-Received: by 2002:a37:4f8a:: with SMTP id d132mr4520409qkb.292.1567005595152; 
 Wed, 28 Aug 2019 08:19:55 -0700 (PDT)
Received: from localhost.localdomain ([71.219.73.178])
 by smtp.gmail.com with ESMTPSA id n20sm1259429qtp.69.2019.08.28.08.19.54
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 28 Aug 2019 08:19:54 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 4/4] drm/amd/powerplay: add the interface for getting ultimate
 frequency v3
Date: Wed, 28 Aug 2019 10:19:43 -0500
Message-Id: <20190828151943.3619-4-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190828151943.3619-1-alexander.deucher@amd.com>
References: <20190828151943.3619-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=UwQjo+lNOhUbO4pjzo3rldNRwR2MolR6jzxxUCmls9Q=;
 b=fkDZjrvyp39YlJIlzzH7YWKUmXrq95Y9hHhECAeuRmZqtml+zJ4wIx9Dh/j2ggvJa0
 Sy5mo4bCvUFgf//JRB72RKmP/weEkpmY7kqYrtCmzntrEoqIkdfkK+v0QDsuG1/EDhF0
 r6euOISI6fKnnkgCSrDNAG67YQ2xf/v32cBqLDynikCzQ3OX9ZAjB9jCCITkwH6fRMVo
 V7Ld6R+u9gF9ndNdT77tXrryMKAD9jtcoaAYvfvYUhj85qt7Eqz+Z5IJHbWoxK9Do2/2
 /jH6awFNFeV9gz2A1pADyb6RjXjeqSs2js+/PYb7fj8pRF3GO20vBmWV5YmafTCfxBF3
 ytJQ==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>, Prike Liang <Prike.Liang@amd.com>,
 Evan Quan <evan.quan@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogUHJpa2UgTGlhbmcgPFByaWtlLkxpYW5nQGFtZC5jb20+CgphZGQgdGhlIGdldF9kcG1f
dWx0aW1hdGVfZnJlcSBmb3Igc3VwcG9ydGluZyBkaWZmZXJlbnQgc3dTTVUuCi12MjoKICAgICAg
ICBIYW5kbGUgdGhlIHVuc3VwcG9ydGVkIGNsb2NrIHR5cGUgYW5kIHJlYWQgc21jIG1lc3NhZ2Ug
ZmFpbGVkIGNhc2UgYW5kIHJldHVybiBlcnJvciBjb2RlLgogICAgICAgIE1vdmUgdGhlIHNtdTEy
IHVjbGsgZnJlcXVlbmN5IHJldHJpZXZlZCBsb2dpYyB0byByZW5vaXIgcHB0LgotdjM6CiAgICAg
ICAgVXNlIGdvdG8gY2xhdXNlIHRvIGhhbmRsZSBpbnZhbGlkYXRlIGNsayBpbmRleC4KICAgICAg
ICBBZGQgdGhlIGxpbWl0ZWQgdGFnIGZvciBzbXVfZ2V0X2RwbV91Y2xrIHRvIGF2b2lkIG90aGVy
IGxpa2V3aXNlIGludGVyZmFjZSBpbnRyb2R1Y2VkLgoKU2lnbmVkLW9mZi1ieTogUHJpa2UgTGlh
bmcgPFByaWtlLkxpYW5nQGFtZC5jb20+ClJldmlld2VkLWJ5OiBFdmFuIFF1YW4gPGV2YW4ucXVh
bkBhbWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBBbGV4IERldWNoZXIgPGFsZXhhbmRlci5kZXVjaGVy
QGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5j
ICAgIHwgMzggKystLS0tLS0tLS0tCiAuLi4vZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2luYy9hbWRn
cHVfc211LmggICAgfCAxMCArKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3Jlbm9p
cl9wcHQuYyAgICB8IDIyICsrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3Nt
dV92MTFfMC5jICAgICB8IDM4ICsrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dl
cnBsYXkvc211X3YxMl8wLmMgICAgIHwgNjIgKysrKysrKysrKysrKysrKysrKwogNSBmaWxlcyBj
aGFuZ2VkLCAxMzcgaW5zZXJ0aW9ucygrKSwgMzMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jCmluZGV4IDhjNjE3NzhmOGY3NC4uYTY1Yzky
OTdlN2JkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9hbWRncHVf
c211LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jCkBA
IC0yMzEsOSArMjMxLDggQEAgaW50IHNtdV9zZXRfaGFyZF9mcmVxX3JhbmdlKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwKIGludCBzbXVfZ2V0X2Rw
bV9mcmVxX3JhbmdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSBj
bGtfdHlwZSwKIAkJCSAgIHVpbnQzMl90ICptaW4sIHVpbnQzMl90ICptYXgpCiB7Ci0JaW50IHJl
dCA9IDAsIGNsa19pZCA9IDA7Ci0JdWludDMyX3QgcGFyYW0gPSAwOwogCXVpbnQzMl90IGNsb2Nr
X2xpbWl0OworCWludCByZXQgPSAwOwogCiAJaWYgKCFtaW4gJiYgIW1heCkKIAkJcmV0dXJuIC1F
SU5WQUw7CkBAIC0yNjQsMzYgKzI2MywxMSBAQCBpbnQgc211X2dldF9kcG1fZnJlcV9yYW5nZShz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsCiAKIAkJ
cmV0dXJuIDA7CiAJfQotCi0JbXV0ZXhfbG9jaygmc211LT5tdXRleCk7Ci0JY2xrX2lkID0gc211
X2Nsa19nZXRfaW5kZXgoc211LCBjbGtfdHlwZSk7Ci0JaWYgKGNsa19pZCA8IDApIHsKLQkJcmV0
ID0gLUVJTlZBTDsKLQkJZ290byBmYWlsZWQ7Ci0JfQotCi0JcGFyYW0gPSAoY2xrX2lkICYgMHhm
ZmZmKSA8PCAxNjsKLQotCWlmIChtYXgpIHsKLQkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRo
X3BhcmFtKHNtdSwgU01VX01TR19HZXRNYXhEcG1GcmVxLCBwYXJhbSk7Ci0JCWlmIChyZXQpCi0J
CQlnb3RvIGZhaWxlZDsKLQkJcmV0ID0gc211X3JlYWRfc21jX2FyZyhzbXUsIG1heCk7Ci0JCWlm
IChyZXQpCi0JCQlnb3RvIGZhaWxlZDsKLQl9Ci0KLQlpZiAobWluKSB7Ci0JCXJldCA9IHNtdV9z
ZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfR2V0TWluRHBtRnJlcSwgcGFyYW0p
OwotCQlpZiAocmV0KQotCQkJZ290byBmYWlsZWQ7Ci0JCXJldCA9IHNtdV9yZWFkX3NtY19hcmco
c211LCBtaW4pOwotCQlpZiAocmV0KQotCQkJZ290byBmYWlsZWQ7Ci0JfQotCi1mYWlsZWQ6Ci0J
bXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsKKwkvKgorCSAqIFRvZG86IFVzZSBlYWNoIGFzaWMo
QVNJQ19wcHQgZnVuY3MpIGNvbnRyb2wgdGhlIGNhbGxiYWNrcyBleHBvc2VkIHRvIHRoZQorCSAq
IGNvcmUgZHJpdmVyIGFuZCB0aGVuIGhhdmUgaGVscGVycyBmb3Igc3R1ZmYgdGhhdCBpcyBjb21t
b24oU01VX3YxMV94IHwgU01VX3YxMl94IGZ1bmNzKS4KKwkgKi8KKwlyZXQgPSBzbXVfZ2V0X2Rw
bV91bHRpbWF0ZV9mcmVxKHNtdSwgY2xrX3R5cGUsIG1pbiwgbWF4KTsKIAlyZXR1cm4gcmV0Owog
fQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMvYW1kZ3B1
X3NtdS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5jL2FtZGdwdV9zbXUuaApp
bmRleCBjNDI2OTFhOWFmZDMuLjMyMGFjMjAxNDZmZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9wb3dlcnBsYXkvaW5jL2FtZGdwdV9zbXUuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL3Bvd2VycGxheS9pbmMvYW1kZ3B1X3NtdS5oCkBAIC00NTgsNiArNDU4LDcgQEAgc3RydWN0
IHBwdGFibGVfZnVuY3MgewogCWludCAoKmRpc3BsYXlfZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dp
dGNoKShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgYm9vbCBkaXNhYmxlX21lbW9yeV9jbG9ja19z
d2l0Y2gpOwogCXZvaWQgKCpkdW1wX3BwdGFibGUpKHN0cnVjdCBzbXVfY29udGV4dCAqc211KTsK
IAlpbnQgKCpnZXRfcG93ZXJfbGltaXQpKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1aW50MzJf
dCAqbGltaXQsIGJvb2wgYXNpY19kZWZhdWx0KTsKKwlpbnQgKCpnZXRfZHBtX3VjbGtfbGltaXRl
ZCkoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQzMl90ICpjbG9jaywgYm9vbCBtYXgpOwog
fTsKIAogc3RydWN0IHNtdV9mdW5jcwpAQCAtNTM2LDcgKzUzNyw3IEBAIHN0cnVjdCBzbXVfZnVu
Y3MKIAllbnVtIHNtdV9iYWNvX3N0YXRlICgqYmFjb19nZXRfc3RhdGUpKHN0cnVjdCBzbXVfY29u
dGV4dCAqc211KTsKIAlpbnQgKCpiYWNvX3NldF9zdGF0ZSkoc3RydWN0IHNtdV9jb250ZXh0ICpz
bXUsIGVudW0gc211X2JhY29fc3RhdGUgc3RhdGUpOwogCWludCAoKmJhY29fcmVzZXQpKHN0cnVj
dCBzbXVfY29udGV4dCAqc211KTsKLQorCWludCAoKmdldF9kcG1fdWx0aW1hdGVfZnJlcSkoc3Ry
dWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0gc211X2Nsa190eXBlIGNsa190eXBlLCB1aW50MzJf
dCAqbWluLCB1aW50MzJfdCAqbWF4KTsKIH07CiAKICNkZWZpbmUgc211X2luaXRfbWljcm9jb2Rl
KHNtdSkgXApAQCAtNzQ1LDYgKzc0NiwxMCBAQCBzdHJ1Y3Qgc211X2Z1bmNzCiAJKChzbXUpLT5m
dW5jcy0+cmVnaXN0ZXJfaXJxX2hhbmRsZXIgPyAoc211KS0+ZnVuY3MtPnJlZ2lzdGVyX2lycV9o
YW5kbGVyKHNtdSkgOiAwKQogI2RlZmluZSBzbXVfc2V0X2F6YWxpYV9kM19wbWUoc211KSBcCiAJ
KChzbXUpLT5mdW5jcy0+c2V0X2F6YWxpYV9kM19wbWUgPyAoc211KS0+ZnVuY3MtPnNldF9hemFs
aWFfZDNfcG1lKChzbXUpKSA6IDApCisjZGVmaW5lIHNtdV9nZXRfZHBtX3VsdGltYXRlX2ZyZXEo
c211LCBwYXJhbSwgbWluLCBtYXgpIFwKKwkJKChzbXUpLT5mdW5jcy0+Z2V0X2RwbV91bHRpbWF0
ZV9mcmVxID8gKHNtdSktPmZ1bmNzLT5nZXRfZHBtX3VsdGltYXRlX2ZyZXEoKHNtdSksIChwYXJh
bSksIChtaW4pLCAobWF4KSkgOiAwKQorI2RlZmluZSBzbXVfZ2V0X3VjbGtfZHBtX3N0YXRlcyhz
bXUsIGNsb2Nrc19pbl9raHosIG51bV9zdGF0ZXMpIFwKKwkoKHNtdSktPnBwdF9mdW5jcy0+Z2V0
X3VjbGtfZHBtX3N0YXRlcyA/IChzbXUpLT5wcHRfZnVuY3MtPmdldF91Y2xrX2RwbV9zdGF0ZXMo
KHNtdSksIChjbG9ja3NfaW5fa2h6KSwgKG51bV9zdGF0ZXMpKSA6IDApCiAjZGVmaW5lIHNtdV9n
ZXRfbWF4X3N1c3RhaW5hYmxlX2Nsb2Nrc19ieV9kYyhzbXUsIG1heF9jbG9ja3MpIFwKIAkoKHNt
dSktPmZ1bmNzLT5nZXRfbWF4X3N1c3RhaW5hYmxlX2Nsb2Nrc19ieV9kYyA/IChzbXUpLT5mdW5j
cy0+Z2V0X21heF9zdXN0YWluYWJsZV9jbG9ja3NfYnlfZGMoKHNtdSksIChtYXhfY2xvY2tzKSkg
OiAwKQogI2RlZmluZSBzbXVfZ2V0X3VjbGtfZHBtX3N0YXRlcyhzbXUsIGNsb2Nrc19pbl9raHos
IG51bV9zdGF0ZXMpIFwKQEAgLTc1OSw2ICs3NjQsOSBAQCBzdHJ1Y3Qgc211X2Z1bmNzCiAJKChz
bXUpLT5wcHRfZnVuY3MtPnNldF9wZXJmb3JtYW5jZV9sZXZlbD8gKHNtdSktPnBwdF9mdW5jcy0+
c2V0X3BlcmZvcm1hbmNlX2xldmVsKChzbXUpLCAobGV2ZWwpKSA6IC1FSU5WQUwpOwogI2RlZmlu
ZSBzbXVfZHVtcF9wcHRhYmxlKHNtdSkgXAogCSgoc211KS0+cHB0X2Z1bmNzLT5kdW1wX3BwdGFi
bGUgPyAoc211KS0+cHB0X2Z1bmNzLT5kdW1wX3BwdGFibGUoKHNtdSkpIDogMCkKKyNkZWZpbmUg
c211X2dldF9kcG1fdWNsa19saW1pdGVkKHNtdSwgY2xvY2ssIG1heCkgXAorCQkoKHNtdSktPnBw
dF9mdW5jcy0+Z2V0X2RwbV91Y2xrX2xpbWl0ZWQgPyAoc211KS0+cHB0X2Z1bmNzLT5nZXRfZHBt
X3VjbGtfbGltaXRlZCgoc211KSwgKGNsb2NrKSwgKG1heCkpIDogLUVJTlZBTCkKKwogCiBleHRl
cm4gaW50IHNtdV9nZXRfYXRvbV9kYXRhX3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1
aW50MzJfdCB0YWJsZSwKIAkJCQkgICB1aW50MTZfdCAqc2l6ZSwgdWludDhfdCAqZnJldiwgdWlu
dDhfdCAqY3JldiwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3Jl
bm9pcl9wcHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3Jlbm9pcl9wcHQuYwpp
bmRleCBkZTQzMTU5NTY0YTUuLjJhNmRhNTQ2ZmI1NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9wb3dlcnBsYXkvcmVub2lyX3BwdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
cG93ZXJwbGF5L3Jlbm9pcl9wcHQuYwpAQCAtMTU2LDExICsxNTYsMzMgQEAgc3RhdGljIGludCBy
ZW5vaXJfdGFibGVzX2luaXQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHN0cnVjdCBzbXVfdGFi
bGUgKnRhYmxlcykKIAlyZXR1cm4gMDsKIH0KIAorLyoqCisgKiBUaGlzIGludGVyZmFjZSBqdXN0
IGZvciBnZXR0aW5nIHVjbGsgdWx0aW1hdGUgZnJlcSBhbmQgc2hvdWxkJ3QgaW50cm9kdWNlCisg
KiBvdGhlciBsaWtld2lzZSBmdW5jdGlvbiByZXN1bHQgaW4gb3Zlcm11Y2ggY2FsbGJhY2suCisg
Ki8KK3N0YXRpYyBpbnQgcmVub2lyX2dldF9kcG1fdWNsa19saW1pdGVkKHN0cnVjdCBzbXVfY29u
dGV4dCAqc211LCB1aW50MzJfdCAqY2xvY2ssIGJvb2wgbWF4KQoreworCisJRHBtQ2xvY2tzX3Qg
KnRhYmxlID0gc211LT5zbXVfdGFibGUuY2xvY2tzX3RhYmxlOworCisJaWYgKCFjbG9jayB8fCAh
dGFibGUpCisJCXJldHVybiAtRUlOVkFMOworCisJaWYgKG1heCkKKwkJKmNsb2NrID0gdGFibGUt
PkZDbG9ja3NbTlVNX0ZDTEtfRFBNX0xFVkVMUy0xXS5GcmVxOworCWVsc2UKKwkJKmNsb2NrID0g
dGFibGUtPkZDbG9ja3NbMF0uRnJlcTsKKworCXJldHVybiAwOworCit9CisKIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgcHB0YWJsZV9mdW5jcyByZW5vaXJfcHB0X2Z1bmNzID0gewogCS5nZXRfc211X21z
Z19pbmRleCA9IHJlbm9pcl9nZXRfc211X21zZ19pbmRleCwKIAkuZ2V0X3NtdV90YWJsZV9pbmRl
eCA9IHJlbm9pcl9nZXRfc211X3RhYmxlX2luZGV4LAogCS50YWJsZXNfaW5pdCA9IHJlbm9pcl90
YWJsZXNfaW5pdCwKIAkuc2V0X3Bvd2VyX3N0YXRlID0gTlVMTCwKKwkuZ2V0X2RwbV91Y2xrX2xp
bWl0ZWQgPSByZW5vaXJfZ2V0X2RwbV91Y2xrX2xpbWl0ZWQsCiB9OwogCiB2b2lkIHJlbm9pcl9z
ZXRfcHB0X2Z1bmNzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211X3YxMV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L3Bvd2VycGxheS9zbXVfdjExXzAuYwppbmRleCAxNjk3MmJkODQyNzAuLmRiNWU5NGNlNTRhZiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211X3YxMV8wLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211X3YxMV8wLmMKQEAgLTE3MTQsNiAr
MTcxNCw0MyBAQCBzdGF0aWMgaW50IHNtdV92MTFfMF9iYWNvX3Jlc2V0KHN0cnVjdCBzbXVfY29u
dGV4dCAqc211KQogCXJldHVybiByZXQ7CiB9CiAKK3N0YXRpYyBpbnQgc211X3YxMV8wX2dldF9k
cG1fdWx0aW1hdGVfZnJlcShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVfY2xrX3R5
cGUgY2xrX3R5cGUsCisJCQkJCQkgdWludDMyX3QgKm1pbiwgdWludDMyX3QgKm1heCkKK3sKKwlp
bnQgcmV0ID0gMCwgY2xrX2lkID0gMDsKKwl1aW50MzJfdCBwYXJhbSA9IDA7CisKKwltdXRleF9s
b2NrKCZzbXUtPm11dGV4KTsKKwljbGtfaWQgPSBzbXVfY2xrX2dldF9pbmRleChzbXUsIGNsa190
eXBlKTsKKwlpZiAoY2xrX2lkIDwgMCkgeworCQlyZXQgPSAtRUlOVkFMOworCQlnb3RvIGZhaWxl
ZDsKKwl9CisJcGFyYW0gPSAoY2xrX2lkICYgMHhmZmZmKSA8PCAxNjsKKworCWlmIChtYXgpIHsK
KwkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwgU01VX01TR19HZXRNYXhE
cG1GcmVxLCBwYXJhbSk7CisJCWlmIChyZXQpCisJCQlnb3RvIGZhaWxlZDsKKwkJcmV0ID0gc211
X3JlYWRfc21jX2FyZyhzbXUsIG1heCk7CisJCWlmIChyZXQpCisJCQlnb3RvIGZhaWxlZDsKKwl9
CisKKwlpZiAobWluKSB7CisJCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUs
IFNNVV9NU0dfR2V0TWluRHBtRnJlcSwgcGFyYW0pOworCQlpZiAocmV0KQorCQkJZ290byBmYWls
ZWQ7CisJCXJldCA9IHNtdV9yZWFkX3NtY19hcmcoc211LCBtaW4pOworCQlpZiAocmV0KQorCQkJ
Z290byBmYWlsZWQ7CisJfQorCitmYWlsZWQ6CisJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsK
KwlyZXR1cm4gcmV0OworfQorCiBzdGF0aWMgY29uc3Qgc3RydWN0IHNtdV9mdW5jcyBzbXVfdjEx
XzBfZnVuY3MgPSB7CiAJLmluaXRfbWljcm9jb2RlID0gc211X3YxMV8wX2luaXRfbWljcm9jb2Rl
LAogCS5sb2FkX21pY3JvY29kZSA9IHNtdV92MTFfMF9sb2FkX21pY3JvY29kZSwKQEAgLTE3NjMs
NiArMTgwMCw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc211X2Z1bmNzIHNtdV92MTFfMF9mdW5j
cyA9IHsKIAkuYmFjb19nZXRfc3RhdGUgPSBzbXVfdjExXzBfYmFjb19nZXRfc3RhdGUsCiAJLmJh
Y29fc2V0X3N0YXRlID0gc211X3YxMV8wX2JhY29fc2V0X3N0YXRlLAogCS5iYWNvX3Jlc2V0ID0g
c211X3YxMV8wX2JhY29fcmVzZXQsCisJLmdldF9kcG1fdWx0aW1hdGVfZnJlcSA9IHNtdV92MTFf
MF9nZXRfZHBtX3VsdGltYXRlX2ZyZXEsCiB9OwogCiB2b2lkIHNtdV92MTFfMF9zZXRfc211X2Z1
bmNzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9wb3dlcnBsYXkvc211X3YxMl8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxh
eS9zbXVfdjEyXzAuYwppbmRleCAwZjVkMDhhZTcxYWUuLjlkMjI4MGNhMWY0YiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211X3YxMl8wLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211X3YxMl8wLmMKQEAgLTMxOSw2ICszMTksNjcgQEAg
c3RhdGljIGludCBzbXVfdjEyXzBfcG9wdWxhdGVfc21jX3RhYmxlcyhzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSkKIAlyZXR1cm4gc211X3VwZGF0ZV90YWJsZShzbXUsIFNNVV9UQUJMRV9EUE1DTE9D
S1MsIDAsIHNtdV90YWJsZS0+Y2xvY2tzX3RhYmxlLCBmYWxzZSk7CiB9CiAKK3N0YXRpYyBpbnQg
c211X3YxMl8wX2dldF9kcG1fdWx0aW1hdGVfZnJlcShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwg
ZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsCisJCQkJCQkgdWludDMyX3QgKm1pbiwgdWludDMy
X3QgKm1heCkKK3sKKwlpbnQgcmV0ID0gMDsKKworCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOwor
CisJaWYgKG1heCkgeworCQlzd2l0Y2ggKGNsa190eXBlKSB7CisJCWNhc2UgU01VX0dGWENMSzoK
KwkJY2FzZSBTTVVfU0NMSzoKKwkJCXJldCA9IHNtdV9zZW5kX3NtY19tc2coc211LCBTTVVfTVNH
X0dldE1heEdmeGNsa0ZyZXF1ZW5jeSk7CisJCQlpZiAocmV0KSB7CisJCQkJcHJfZXJyKCJBdHRl
bXB0IHRvIGdldCBtYXggR1ggZnJlcXVlbmN5IGZyb20gU01DIEZhaWxlZCAhXG4iKTsKKwkJCQln
b3RvIGZhaWxlZDsKKwkJCX0KKwkJCXJldCA9IHNtdV9yZWFkX3NtY19hcmcoc211LCBtYXgpOwor
CQkJaWYgKHJldCkKKwkJCQlnb3RvIGZhaWxlZDsKKwkJCWJyZWFrOworCQljYXNlIFNNVV9VQ0xL
OgorCQkJcmV0ID0gc211X2dldF9kcG1fdWNsa19saW1pdGVkKHNtdSwgbWF4LCB0cnVlKTsKKwkJ
CWlmIChyZXQpCisJCQkJZ290byBmYWlsZWQ7CisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCXJl
dCA9IC1FSU5WQUw7CisJCQlnb3RvIGZhaWxlZDsKKworCQl9CisJfQorCisJaWYgKG1pbikgewor
CQlzd2l0Y2ggKGNsa190eXBlKSB7CisJCWNhc2UgU01VX0dGWENMSzoKKwkJY2FzZSBTTVVfU0NM
SzoKKwkJCXJldCA9IHNtdV9zZW5kX3NtY19tc2coc211LCBTTVVfTVNHX0dldE1pbkdmeGNsa0Zy
ZXF1ZW5jeSk7CisJCQlpZiAocmV0KSB7CisJCQkJcHJfZXJyKCJBdHRlbXB0IHRvIGdldCBtaW4g
R1ggZnJlcXVlbmN5IGZyb20gU01DIEZhaWxlZCAhXG4iKTsKKwkJCQlnb3RvIGZhaWxlZDsKKwkJ
CX0KKwkJCXJldCA9IHNtdV9yZWFkX3NtY19hcmcoc211LCBtaW4pOworCQkJaWYgKHJldCkKKwkJ
CQlnb3RvIGZhaWxlZDsKKwkJCWJyZWFrOworCQljYXNlIFNNVV9VQ0xLOgorCQkJcmV0ID0gc211
X2dldF9kcG1fdWNsa19saW1pdGVkKHNtdSwgbWluLCBmYWxzZSk7CisJCQlpZiAocmV0KQorCQkJ
CWdvdG8gZmFpbGVkOworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlyZXQgPSAtRUlOVkFMOwor
CQkJZ290byBmYWlsZWQ7CisJCX0KKworCX0KK2ZhaWxlZDoKKwltdXRleF91bmxvY2soJnNtdS0+
bXV0ZXgpOworCXJldHVybiByZXQ7Cit9CisKIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc211X2Z1bmNz
IHNtdV92MTJfMF9mdW5jcyA9IHsKIAkuY2hlY2tfZndfc3RhdHVzID0gc211X3YxMl8wX2NoZWNr
X2Z3X3N0YXR1cywKIAkuY2hlY2tfZndfdmVyc2lvbiA9IHNtdV92MTJfMF9jaGVja19md192ZXJz
aW9uLApAQCAtMzMyLDYgKzM5Myw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc211X2Z1bmNzIHNt
dV92MTJfMF9mdW5jcyA9IHsKIAkuaW5pdF9zbWNfdGFibGVzID0gc211X3YxMl8wX2luaXRfc21j
X3RhYmxlcywKIAkuZmluaV9zbWNfdGFibGVzID0gc211X3YxMl8wX2Zpbmlfc21jX3RhYmxlcywK
IAkucG9wdWxhdGVfc21jX3RhYmxlcyA9IHNtdV92MTJfMF9wb3B1bGF0ZV9zbWNfdGFibGVzLAor
CS5nZXRfZHBtX3VsdGltYXRlX2ZyZXEgPSBzbXVfdjEyXzBfZ2V0X2RwbV91bHRpbWF0ZV9mcmVx
LAogfTsKIAogdm9pZCBzbXVfdjEyXzBfc2V0X3NtdV9mdW5jcyhzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSkKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KYW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5v
cmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
