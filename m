Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id C57E669E31
	for <lists+amd-gfx@lfdr.de>; Mon, 15 Jul 2019 23:25:46 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 699ED89F6F;
	Mon, 15 Jul 2019 21:25:44 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qt1-x843.google.com (mail-qt1-x843.google.com
 [IPv6:2607:f8b0:4864:20::843])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 20BED89F41
 for <amd-gfx@lists.freedesktop.org>; Mon, 15 Jul 2019 21:25:39 +0000 (UTC)
Received: by mail-qt1-x843.google.com with SMTP id h18so17248891qtm.9
 for <amd-gfx@lists.freedesktop.org>; Mon, 15 Jul 2019 14:25:39 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=tlGj2SK5mU2ZrNzAUNTOjaYWVgr5fHPbPMktdPCvgfw=;
 b=kUqvw3Wj7mAWZOLPH2TQKHiF3FqH4trnhytp5MVVXpqj14vuBDHjmgOxAolrRaDV1U
 DQ6yygPqSxutyN3IHJvlQ5bx1pxVOurTfZqYIPIAFG5jUD6t4oyP4Ho+4G4Kd+QaZ979
 Qc7oASqsSYovcw2MyowU9/xX7gxURflbT/kw8/C1rjVfTjWF6daJG/IfHdXy+SxU5pFq
 fw3JOkGK1jj/sd8YeP+w1Hkr1/FMQu3ioBIEpYmQpcRvnDLCS+SQqRwzM15i/tiVLX10
 LjBwBRcUms1fnqq3HlRnnckZ70lTVVexn2LgxQYZVC3GcpP3BIty37GhWbW2ImrEqzuM
 f1mQ==
X-Gm-Message-State: APjAAAVF8AXGTuwqA5LnStyF0f1+cIjiEg84lPaURNbwLPq9a59KvLT4
 AzxXUserKVBVhFYrBWVlMpNO+S/s
X-Google-Smtp-Source: APXvYqz6TNoWFsxO8WaUxdUEQ6g/snovvNGCpMUr0vo+XfA1HUbE3YQuvX/GubsysrmyVvu4ZZfQvw==
X-Received: by 2002:ac8:6717:: with SMTP id e23mr18902316qtp.27.1563225937356; 
 Mon, 15 Jul 2019 14:25:37 -0700 (PDT)
Received: from localhost.localdomain ([71.219.21.119])
 by smtp.gmail.com with ESMTPSA id q56sm10274133qtq.64.2019.07.15.14.25.36
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 15 Jul 2019 14:25:36 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 059/102] drm/amdgpu: add VCN2.5 VCPU start and stop
Date: Mon, 15 Jul 2019 16:23:54 -0500
Message-Id: <20190715212437.31793-57-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190715212437.31793-1-alexander.deucher@amd.com>
References: <20190715212437.31793-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=tlGj2SK5mU2ZrNzAUNTOjaYWVgr5fHPbPMktdPCvgfw=;
 b=n/juZLjRZT1GZop7qWFFb70t4yas47fQQM4LPqNEUrLZi5D9Ugu1c1iamkKfPhD5N8
 CwvvfU4ibpiGHXzrM17cvH+SFdXG0gTI5xHIWM+h44LeLyUG2+Fw3OlaKSkfGuMUce1X
 lB/3z8b8phgOAKPVJujxt38aFOF+CCwzmFsUtlCCc8e8JSsNjFOnC4d9pbs+OrbpjofG
 qitt2ffOn8jZE/hJxHqGFE6BV6zpFdaMHFxvM0iFVHIsYo1k3C4Pc2npd7eR+V8SQzKr
 nsnKKN+HWPz7JI/d6uS7Aw76bHhBd2a7MFO0Pi/O1cW7EV6TFTLu53HzfnTagaoXWERH
 29GA==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>, Leo Liu <leo.liu@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogTGVvIExpdSA8bGVvLmxpdUBhbWQuY29tPgoKSFcgZW5naW5lIGluaXRpYWxpemF0aW9u
IGFuZCBzdXNwZW5kIHNlcXVlbmNlcy4KClNpZ25lZC1vZmYtYnk6IExlbyBMaXUgPGxlby5saXVA
YW1kLmNvbT4KUmV2aWV3ZWQtYnk6IEFsZXggRGV1Y2hlciA8YWxleGFuZGVyLmRldWNoZXJAYW1k
LmNvbT4KU2lnbmVkLW9mZi1ieTogQWxleCBEZXVjaGVyIDxhbGV4YW5kZXIuZGV1Y2hlckBhbWQu
Y29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3Zjbl92Ml81LmMgfCA0NjcgKysr
KysrKysrKysrKysrKysrKysrKysrKy0KIDEgZmlsZSBjaGFuZ2VkLCA0NjYgaW5zZXJ0aW9ucygr
KSwgMSBkZWxldGlvbigtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L3Zjbl92Ml81LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS92Y25fdjJfNS5jCmluZGV4
IDBmNTUzNTYzY2ViOS4uYjZlNzJmZmY5NGY1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS92Y25fdjJfNS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3Zj
bl92Ml81LmMKQEAgLTMwNyw2ICszMDcsNDQ2IEBAIHN0YXRpYyBpbnQgdmNuX3YyXzVfcmVzdW1l
KHZvaWQgKmhhbmRsZSkKIAlyZXR1cm4gcjsKIH0KIAorLyoqCisgKiB2Y25fdjJfNV9tY19yZXN1
bWUgLSBtZW1vcnkgY29udHJvbGxlciBwcm9ncmFtbWluZworICoKKyAqIEBhZGV2OiBhbWRncHVf
ZGV2aWNlIHBvaW50ZXIKKyAqCisgKiBMZXQgdGhlIFZDTiBtZW1vcnkgY29udHJvbGxlciBrbm93
IGl0J3Mgb2Zmc2V0cworICovCitzdGF0aWMgdm9pZCB2Y25fdjJfNV9tY19yZXN1bWUoc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYpCit7CisJdWludDMyX3Qgc2l6ZSA9IEFNREdQVV9HUFVfUEFH
RV9BTElHTihhZGV2LT52Y24uZnctPnNpemUgKyA0KTsKKwl1aW50MzJfdCBvZmZzZXQ7CisKKwkv
KiBjYWNoZSB3aW5kb3cgMDogZncgKi8KKwlpZiAoYWRldi0+ZmlybXdhcmUubG9hZF90eXBlID09
IEFNREdQVV9GV19MT0FEX1BTUCkgeworCQlXUkVHMzJfU09DMTUoVVZELCAwLCBtbVVWRF9MTUlf
VkNQVV9DQUNIRV82NEJJVF9CQVJfTE9XLAorCQkJKGFkZXYtPmZpcm13YXJlLnVjb2RlW0FNREdQ
VV9VQ09ERV9JRF9WQ05dLnRtcl9tY19hZGRyX2xvKSk7CisJCVdSRUczMl9TT0MxNShVVkQsIDAs
IG1tVVZEX0xNSV9WQ1BVX0NBQ0hFXzY0QklUX0JBUl9ISUdILAorCQkJKGFkZXYtPmZpcm13YXJl
LnVjb2RlW0FNREdQVV9VQ09ERV9JRF9WQ05dLnRtcl9tY19hZGRyX2hpKSk7CisJCVdSRUczMl9T
T0MxNShVVkQsIDAsIG1tVVZEX1ZDUFVfQ0FDSEVfT0ZGU0VUMCwgMCk7CisJCW9mZnNldCA9IDA7
CisJfSBlbHNlIHsKKwkJV1JFRzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRfTE1JX1ZDUFVfQ0FDSEVf
NjRCSVRfQkFSX0xPVywKKwkJCWxvd2VyXzMyX2JpdHMoYWRldi0+dmNuLmdwdV9hZGRyKSk7CisJ
CVdSRUczMl9TT0MxNShVVkQsIDAsIG1tVVZEX0xNSV9WQ1BVX0NBQ0hFXzY0QklUX0JBUl9ISUdI
LAorCQkJdXBwZXJfMzJfYml0cyhhZGV2LT52Y24uZ3B1X2FkZHIpKTsKKwkJb2Zmc2V0ID0gc2l6
ZTsKKwkJLyogTm8gc2lnbmVkIGhlYWRlciBmb3Igbm93IGZyb20gZmlybXdhcmUKKwkJV1JFRzMy
X1NPQzE1KFVWRCwgMCwgbW1VVkRfVkNQVV9DQUNIRV9PRkZTRVQwLAorCQkJQU1ER1BVX1VWRF9G
SVJNV0FSRV9PRkZTRVQgPj4gMyk7CisJCSovCisJCVdSRUczMl9TT0MxNShVVkQsIDAsIG1tVVZE
X1ZDUFVfQ0FDSEVfT0ZGU0VUMCwgMCk7CisJfQorCVdSRUczMl9TT0MxNShVVkQsIDAsIG1tVVZE
X1ZDUFVfQ0FDSEVfU0laRTAsIHNpemUpOworCisJLyogY2FjaGUgd2luZG93IDE6IHN0YWNrICov
CisJV1JFRzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRfTE1JX1ZDUFVfQ0FDSEUxXzY0QklUX0JBUl9M
T1csCisJCWxvd2VyXzMyX2JpdHMoYWRldi0+dmNuLmdwdV9hZGRyICsgb2Zmc2V0KSk7CisJV1JF
RzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRfTE1JX1ZDUFVfQ0FDSEUxXzY0QklUX0JBUl9ISUdILAor
CQl1cHBlcl8zMl9iaXRzKGFkZXYtPnZjbi5ncHVfYWRkciArIG9mZnNldCkpOworCVdSRUczMl9T
T0MxNShVVkQsIDAsIG1tVVZEX1ZDUFVfQ0FDSEVfT0ZGU0VUMSwgMCk7CisJV1JFRzMyX1NPQzE1
KFVWRCwgMCwgbW1VVkRfVkNQVV9DQUNIRV9TSVpFMSwgQU1ER1BVX1ZDTl9TVEFDS19TSVpFKTsK
KworCS8qIGNhY2hlIHdpbmRvdyAyOiBjb250ZXh0ICovCisJV1JFRzMyX1NPQzE1KFVWRCwgMCwg
bW1VVkRfTE1JX1ZDUFVfQ0FDSEUyXzY0QklUX0JBUl9MT1csCisJCWxvd2VyXzMyX2JpdHMoYWRl
di0+dmNuLmdwdV9hZGRyICsgb2Zmc2V0ICsgQU1ER1BVX1ZDTl9TVEFDS19TSVpFKSk7CisJV1JF
RzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRfTE1JX1ZDUFVfQ0FDSEUyXzY0QklUX0JBUl9ISUdILAor
CQl1cHBlcl8zMl9iaXRzKGFkZXYtPnZjbi5ncHVfYWRkciArIG9mZnNldCArIEFNREdQVV9WQ05f
U1RBQ0tfU0laRSkpOworCVdSRUczMl9TT0MxNShVVkQsIDAsIG1tVVZEX1ZDUFVfQ0FDSEVfT0ZG
U0VUMiwgMCk7CisJV1JFRzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRfVkNQVV9DQUNIRV9TSVpFMiwg
QU1ER1BVX1ZDTl9DT05URVhUX1NJWkUpOworfQorCisvKioKKyAqIHZjbl92Ml81X2Rpc2FibGVf
Y2xvY2tfZ2F0aW5nIC0gZGlzYWJsZSBWQ04gY2xvY2sgZ2F0aW5nCisgKgorICogQGFkZXY6IGFt
ZGdwdV9kZXZpY2UgcG9pbnRlcgorICogQHN3OiBlbmFibGUgU1cgY2xvY2sgZ2F0aW5nCisgKgor
ICogRGlzYWJsZSBjbG9jayBnYXRpbmcgZm9yIFZDTiBibG9jaworICovCitzdGF0aWMgdm9pZCB2
Y25fdjJfNV9kaXNhYmxlX2Nsb2NrX2dhdGluZyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikK
K3sKKwl1aW50MzJfdCBkYXRhOworCWludCByZXQgPSAwOworCisJLyogVVZEIGRpc2FibGUgQ0dD
ICovCisJZGF0YSA9IFJSRUczMl9TT0MxNShWQ04sIDAsIG1tVVZEX0NHQ19DVFJMKTsKKwlpZiAo
YWRldi0+Y2dfZmxhZ3MgJiBBTURfQ0dfU1VQUE9SVF9WQ05fTUdDRykKKwkJZGF0YSB8PSAxIDw8
IFVWRF9DR0NfQ1RSTF9fRFlOX0NMT0NLX01PREVfX1NISUZUOworCWVsc2UKKwkJZGF0YSAmPSB+
IFVWRF9DR0NfQ1RSTF9fRFlOX0NMT0NLX01PREVfTUFTSzsKKwlkYXRhIHw9IDEgPDwgVVZEX0NH
Q19DVFJMX19DTEtfR0FURV9ETFlfVElNRVJfX1NISUZUOworCWRhdGEgfD0gNCA8PCBVVkRfQ0dD
X0NUUkxfX0NMS19PRkZfREVMQVlfX1NISUZUOworCVdSRUczMl9TT0MxNShWQ04sIDAsIG1tVVZE
X0NHQ19DVFJMLCBkYXRhKTsKKworCWRhdGEgPSBSUkVHMzJfU09DMTUoVkNOLCAwLCBtbVVWRF9D
R0NfR0FURSk7CisJZGF0YSAmPSB+KFVWRF9DR0NfR0FURV9fU1lTX01BU0sKKwkJfCBVVkRfQ0dD
X0dBVEVfX1VERUNfTUFTSworCQl8IFVWRF9DR0NfR0FURV9fTVBFRzJfTUFTSworCQl8IFVWRF9D
R0NfR0FURV9fUkVHU19NQVNLCisJCXwgVVZEX0NHQ19HQVRFX19SQkNfTUFTSworCQl8IFVWRF9D
R0NfR0FURV9fTE1JX01DX01BU0sKKwkJfCBVVkRfQ0dDX0dBVEVfX0xNSV9VTUNfTUFTSworCQl8
IFVWRF9DR0NfR0FURV9fSURDVF9NQVNLCisJCXwgVVZEX0NHQ19HQVRFX19NUFJEX01BU0sKKwkJ
fCBVVkRfQ0dDX0dBVEVfX01QQ19NQVNLCisJCXwgVVZEX0NHQ19HQVRFX19MQlNJX01BU0sKKwkJ
fCBVVkRfQ0dDX0dBVEVfX0xSQkJNX01BU0sKKwkJfCBVVkRfQ0dDX0dBVEVfX1VERUNfUkVfTUFT
SworCQl8IFVWRF9DR0NfR0FURV9fVURFQ19DTV9NQVNLCisJCXwgVVZEX0NHQ19HQVRFX19VREVD
X0lUX01BU0sKKwkJfCBVVkRfQ0dDX0dBVEVfX1VERUNfREJfTUFTSworCQl8IFVWRF9DR0NfR0FU
RV9fVURFQ19NUF9NQVNLCisJCXwgVVZEX0NHQ19HQVRFX19XQ0JfTUFTSworCQl8IFVWRF9DR0Nf
R0FURV9fVkNQVV9NQVNLCisJCXwgVVZEX0NHQ19HQVRFX19NTVNDSF9NQVNLKTsKKworCVdSRUcz
Ml9TT0MxNShWQ04sIDAsIG1tVVZEX0NHQ19HQVRFLCBkYXRhKTsKKworCVNPQzE1X1dBSVRfT05f
UlJFRyhWQ04sIDAsIG1tVVZEX0NHQ19HQVRFLCAwLCAgMHhGRkZGRkZGRiwgcmV0KTsKKworCWRh
dGEgPSBSUkVHMzJfU09DMTUoVkNOLCAwLCBtbVVWRF9DR0NfQ1RSTCk7CisJZGF0YSAmPSB+KFVW
RF9DR0NfQ1RSTF9fVURFQ19SRV9NT0RFX01BU0sKKwkJfCBVVkRfQ0dDX0NUUkxfX1VERUNfQ01f
TU9ERV9NQVNLCisJCXwgVVZEX0NHQ19DVFJMX19VREVDX0lUX01PREVfTUFTSworCQl8IFVWRF9D
R0NfQ1RSTF9fVURFQ19EQl9NT0RFX01BU0sKKwkJfCBVVkRfQ0dDX0NUUkxfX1VERUNfTVBfTU9E
RV9NQVNLCisJCXwgVVZEX0NHQ19DVFJMX19TWVNfTU9ERV9NQVNLCisJCXwgVVZEX0NHQ19DVFJM
X19VREVDX01PREVfTUFTSworCQl8IFVWRF9DR0NfQ1RSTF9fTVBFRzJfTU9ERV9NQVNLCisJCXwg
VVZEX0NHQ19DVFJMX19SRUdTX01PREVfTUFTSworCQl8IFVWRF9DR0NfQ1RSTF9fUkJDX01PREVf
TUFTSworCQl8IFVWRF9DR0NfQ1RSTF9fTE1JX01DX01PREVfTUFTSworCQl8IFVWRF9DR0NfQ1RS
TF9fTE1JX1VNQ19NT0RFX01BU0sKKwkJfCBVVkRfQ0dDX0NUUkxfX0lEQ1RfTU9ERV9NQVNLCisJ
CXwgVVZEX0NHQ19DVFJMX19NUFJEX01PREVfTUFTSworCQl8IFVWRF9DR0NfQ1RSTF9fTVBDX01P
REVfTUFTSworCQl8IFVWRF9DR0NfQ1RSTF9fTEJTSV9NT0RFX01BU0sKKwkJfCBVVkRfQ0dDX0NU
UkxfX0xSQkJNX01PREVfTUFTSworCQl8IFVWRF9DR0NfQ1RSTF9fV0NCX01PREVfTUFTSworCQl8
IFVWRF9DR0NfQ1RSTF9fVkNQVV9NT0RFX01BU0sKKwkJfCBVVkRfQ0dDX0NUUkxfX01NU0NIX01P
REVfTUFTSyk7CisJV1JFRzMyX1NPQzE1KFZDTiwgMCwgbW1VVkRfQ0dDX0NUUkwsIGRhdGEpOwor
CisJLyogdHVybiBvbiAqLworCWRhdGEgPSBSUkVHMzJfU09DMTUoVkNOLCAwLCBtbVVWRF9TVVZE
X0NHQ19HQVRFKTsKKwlkYXRhIHw9IChVVkRfU1VWRF9DR0NfR0FURV9fU1JFX01BU0sKKwkJfCBV
VkRfU1VWRF9DR0NfR0FURV9fU0lUX01BU0sKKwkJfCBVVkRfU1VWRF9DR0NfR0FURV9fU01QX01B
U0sKKwkJfCBVVkRfU1VWRF9DR0NfR0FURV9fU0NNX01BU0sKKwkJfCBVVkRfU1VWRF9DR0NfR0FU
RV9fU0RCX01BU0sKKwkJfCBVVkRfU1VWRF9DR0NfR0FURV9fU1JFX0gyNjRfTUFTSworCQl8IFVW
RF9TVVZEX0NHQ19HQVRFX19TUkVfSEVWQ19NQVNLCisJCXwgVVZEX1NVVkRfQ0dDX0dBVEVfX1NJ
VF9IMjY0X01BU0sKKwkJfCBVVkRfU1VWRF9DR0NfR0FURV9fU0lUX0hFVkNfTUFTSworCQl8IFVW
RF9TVVZEX0NHQ19HQVRFX19TQ01fSDI2NF9NQVNLCisJCXwgVVZEX1NVVkRfQ0dDX0dBVEVfX1ND
TV9IRVZDX01BU0sKKwkJfCBVVkRfU1VWRF9DR0NfR0FURV9fU0RCX0gyNjRfTUFTSworCQl8IFVW
RF9TVVZEX0NHQ19HQVRFX19TREJfSEVWQ19NQVNLCisJCXwgVVZEX1NVVkRfQ0dDX0dBVEVfX1ND
TFJfTUFTSworCQl8IFVWRF9TVVZEX0NHQ19HQVRFX19VVkRfU0NfTUFTSworCQl8IFVWRF9TVVZE
X0NHQ19HQVRFX19FTlRfTUFTSworCQl8IFVWRF9TVVZEX0NHQ19HQVRFX19TSVRfSEVWQ19ERUNf
TUFTSworCQl8IFVWRF9TVVZEX0NHQ19HQVRFX19TSVRfSEVWQ19FTkNfTUFTSworCQl8IFVWRF9T
VVZEX0NHQ19HQVRFX19TSVRFX01BU0sKKwkJfCBVVkRfU1VWRF9DR0NfR0FURV9fU1JFX1ZQOV9N
QVNLCisJCXwgVVZEX1NVVkRfQ0dDX0dBVEVfX1NDTV9WUDlfTUFTSworCQl8IFVWRF9TVVZEX0NH
Q19HQVRFX19TSVRfVlA5X0RFQ19NQVNLCisJCXwgVVZEX1NVVkRfQ0dDX0dBVEVfX1NEQl9WUDlf
TUFTSworCQl8IFVWRF9TVVZEX0NHQ19HQVRFX19JTUVfSEVWQ19NQVNLKTsKKwlXUkVHMzJfU09D
MTUoVkNOLCAwLCBtbVVWRF9TVVZEX0NHQ19HQVRFLCBkYXRhKTsKKworCWRhdGEgPSBSUkVHMzJf
U09DMTUoVkNOLCAwLCBtbVVWRF9TVVZEX0NHQ19DVFJMKTsKKwlkYXRhICY9IH4oVVZEX1NVVkRf
Q0dDX0NUUkxfX1NSRV9NT0RFX01BU0sKKwkJfCBVVkRfU1VWRF9DR0NfQ1RSTF9fU0lUX01PREVf
TUFTSworCQl8IFVWRF9TVVZEX0NHQ19DVFJMX19TTVBfTU9ERV9NQVNLCisJCXwgVVZEX1NVVkRf
Q0dDX0NUUkxfX1NDTV9NT0RFX01BU0sKKwkJfCBVVkRfU1VWRF9DR0NfQ1RSTF9fU0RCX01PREVf
TUFTSworCQl8IFVWRF9TVVZEX0NHQ19DVFJMX19TQ0xSX01PREVfTUFTSworCQl8IFVWRF9TVVZE
X0NHQ19DVFJMX19VVkRfU0NfTU9ERV9NQVNLCisJCXwgVVZEX1NVVkRfQ0dDX0NUUkxfX0VOVF9N
T0RFX01BU0sKKwkJfCBVVkRfU1VWRF9DR0NfQ1RSTF9fSU1FX01PREVfTUFTSworCQl8IFVWRF9T
VVZEX0NHQ19DVFJMX19TSVRFX01PREVfTUFTSyk7CisJV1JFRzMyX1NPQzE1KFZDTiwgMCwgbW1V
VkRfU1VWRF9DR0NfQ1RSTCwgZGF0YSk7Cit9CisKKy8qKgorICogdmNuX3YyXzVfZW5hYmxlX2Ns
b2NrX2dhdGluZyAtIGVuYWJsZSBWQ04gY2xvY2sgZ2F0aW5nCisgKgorICogQGFkZXY6IGFtZGdw
dV9kZXZpY2UgcG9pbnRlcgorICogQHN3OiBlbmFibGUgU1cgY2xvY2sgZ2F0aW5nCisgKgorICog
RW5hYmxlIGNsb2NrIGdhdGluZyBmb3IgVkNOIGJsb2NrCisgKi8KK3N0YXRpYyB2b2lkIHZjbl92
Ml81X2VuYWJsZV9jbG9ja19nYXRpbmcoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCit7CisJ
dWludDMyX3QgZGF0YSA9IDA7CisKKwkvKiBlbmFibGUgVVZEIENHQyAqLworCWRhdGEgPSBSUkVH
MzJfU09DMTUoVkNOLCAwLCBtbVVWRF9DR0NfQ1RSTCk7CisJaWYgKGFkZXYtPmNnX2ZsYWdzICYg
QU1EX0NHX1NVUFBPUlRfVkNOX01HQ0cpCisJCWRhdGEgfD0gMSA8PCBVVkRfQ0dDX0NUUkxfX0RZ
Tl9DTE9DS19NT0RFX19TSElGVDsKKwllbHNlCisJCWRhdGEgfD0gMCA8PCBVVkRfQ0dDX0NUUkxf
X0RZTl9DTE9DS19NT0RFX19TSElGVDsKKwlkYXRhIHw9IDEgPDwgVVZEX0NHQ19DVFJMX19DTEtf
R0FURV9ETFlfVElNRVJfX1NISUZUOworCWRhdGEgfD0gNCA8PCBVVkRfQ0dDX0NUUkxfX0NMS19P
RkZfREVMQVlfX1NISUZUOworCVdSRUczMl9TT0MxNShWQ04sIDAsIG1tVVZEX0NHQ19DVFJMLCBk
YXRhKTsKKworCWRhdGEgPSBSUkVHMzJfU09DMTUoVkNOLCAwLCBtbVVWRF9DR0NfQ1RSTCk7CisJ
ZGF0YSB8PSAoVVZEX0NHQ19DVFJMX19VREVDX1JFX01PREVfTUFTSworCQl8IFVWRF9DR0NfQ1RS
TF9fVURFQ19DTV9NT0RFX01BU0sKKwkJfCBVVkRfQ0dDX0NUUkxfX1VERUNfSVRfTU9ERV9NQVNL
CisJCXwgVVZEX0NHQ19DVFJMX19VREVDX0RCX01PREVfTUFTSworCQl8IFVWRF9DR0NfQ1RSTF9f
VURFQ19NUF9NT0RFX01BU0sKKwkJfCBVVkRfQ0dDX0NUUkxfX1NZU19NT0RFX01BU0sKKwkJfCBV
VkRfQ0dDX0NUUkxfX1VERUNfTU9ERV9NQVNLCisJCXwgVVZEX0NHQ19DVFJMX19NUEVHMl9NT0RF
X01BU0sKKwkJfCBVVkRfQ0dDX0NUUkxfX1JFR1NfTU9ERV9NQVNLCisJCXwgVVZEX0NHQ19DVFJM
X19SQkNfTU9ERV9NQVNLCisJCXwgVVZEX0NHQ19DVFJMX19MTUlfTUNfTU9ERV9NQVNLCisJCXwg
VVZEX0NHQ19DVFJMX19MTUlfVU1DX01PREVfTUFTSworCQl8IFVWRF9DR0NfQ1RSTF9fSURDVF9N
T0RFX01BU0sKKwkJfCBVVkRfQ0dDX0NUUkxfX01QUkRfTU9ERV9NQVNLCisJCXwgVVZEX0NHQ19D
VFJMX19NUENfTU9ERV9NQVNLCisJCXwgVVZEX0NHQ19DVFJMX19MQlNJX01PREVfTUFTSworCQl8
IFVWRF9DR0NfQ1RSTF9fTFJCQk1fTU9ERV9NQVNLCisJCXwgVVZEX0NHQ19DVFJMX19XQ0JfTU9E
RV9NQVNLCisJCXwgVVZEX0NHQ19DVFJMX19WQ1BVX01PREVfTUFTSyk7CisJV1JFRzMyX1NPQzE1
KFZDTiwgMCwgbW1VVkRfQ0dDX0NUUkwsIGRhdGEpOworCisJZGF0YSA9IFJSRUczMl9TT0MxNShW
Q04sIDAsIG1tVVZEX1NVVkRfQ0dDX0NUUkwpOworCWRhdGEgfD0gKFVWRF9TVVZEX0NHQ19DVFJM
X19TUkVfTU9ERV9NQVNLCisJCXwgVVZEX1NVVkRfQ0dDX0NUUkxfX1NJVF9NT0RFX01BU0sKKwkJ
fCBVVkRfU1VWRF9DR0NfQ1RSTF9fU01QX01PREVfTUFTSworCQl8IFVWRF9TVVZEX0NHQ19DVFJM
X19TQ01fTU9ERV9NQVNLCisJCXwgVVZEX1NVVkRfQ0dDX0NUUkxfX1NEQl9NT0RFX01BU0sKKwkJ
fCBVVkRfU1VWRF9DR0NfQ1RSTF9fU0NMUl9NT0RFX01BU0sKKwkJfCBVVkRfU1VWRF9DR0NfQ1RS
TF9fVVZEX1NDX01PREVfTUFTSworCQl8IFVWRF9TVVZEX0NHQ19DVFJMX19FTlRfTU9ERV9NQVNL
CisJCXwgVVZEX1NVVkRfQ0dDX0NUUkxfX0lNRV9NT0RFX01BU0sKKwkJfCBVVkRfU1VWRF9DR0Nf
Q1RSTF9fU0lURV9NT0RFX01BU0spOworCVdSRUczMl9TT0MxNShWQ04sIDAsIG1tVVZEX1NVVkRf
Q0dDX0NUUkwsIGRhdGEpOworfQorCitzdGF0aWMgaW50IHZjbl92Ml81X3N0YXJ0KHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2KQoreworCXN0cnVjdCBhbWRncHVfcmluZyAqcmluZyA9ICZhZGV2
LT52Y24ucmluZ19kZWM7CisJdWludDMyX3QgcmJfYnVmc3osIHRtcDsKKwlpbnQgaSwgaiwgcjsK
KworCS8qIGRpc2FibGUgcmVnaXN0ZXIgYW50aS1oYW5nIG1lY2hhbmlzbSAqLworCVdSRUczMl9Q
KFNPQzE1X1JFR19PRkZTRVQoVVZELCAwLCBtbVVWRF9QT1dFUl9TVEFUVVMpLCAwLAorCQl+VVZE
X1BPV0VSX1NUQVRVU19fVVZEX1BPV0VSX1NUQVRVU19NQVNLKTsKKworCS8qIHNldCB1dmQgc3Rh
dHVzIGJ1c3kgKi8KKwl0bXAgPSBSUkVHMzJfU09DMTUoVVZELCAwLCBtbVVWRF9TVEFUVVMpIHwg
VVZEX1NUQVRVU19fVVZEX0JVU1k7CisJV1JFRzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRfU1RBVFVT
LCB0bXApOworCisJLypTVyBjbG9jayBnYXRpbmcgKi8KKwl2Y25fdjJfNV9kaXNhYmxlX2Nsb2Nr
X2dhdGluZyhhZGV2KTsKKworCS8qIGVuYWJsZSBWQ1BVIGNsb2NrICovCisJV1JFRzMyX1AoU09D
MTVfUkVHX09GRlNFVChVVkQsIDAsIG1tVVZEX1ZDUFVfQ05UTCksCisJCVVWRF9WQ1BVX0NOVExf
X0NMS19FTl9NQVNLLCB+VVZEX1ZDUFVfQ05UTF9fQ0xLX0VOX01BU0spOworCisJLyogZGlzYWJs
ZSBtYXN0ZXIgaW50ZXJydXB0ICovCisJV1JFRzMyX1AoU09DMTVfUkVHX09GRlNFVChVVkQsIDAs
IG1tVVZEX01BU1RJTlRfRU4pLCAwLAorCQl+VVZEX01BU1RJTlRfRU5fX1ZDUFVfRU5fTUFTSyk7
CisKKwkvKiBzZXR1cCBtbVVWRF9MTUlfQ1RSTCAqLworCXRtcCA9IFJSRUczMl9TT0MxNShVVkQs
IDAsIG1tVVZEX0xNSV9DVFJMKTsKKwl0bXAgJj0gfjB4ZmY7CisJV1JFRzMyX1NPQzE1KFVWRCwg
MCwgbW1VVkRfTE1JX0NUUkwsIHRtcCB8IDB4OHwKKwkJVVZEX0xNSV9DVFJMX19XUklURV9DTEVB
Tl9USU1FUl9FTl9NQVNLCXwKKwkJVVZEX0xNSV9DVFJMX19NQVNLX01DX1VSR0VOVF9NQVNLIHwK
KwkJVVZEX0xNSV9DVFJMX19EQVRBX0NPSEVSRU5DWV9FTl9NQVNLIHwKKwkJVVZEX0xNSV9DVFJM
X19WQ1BVX0RBVEFfQ09IRVJFTkNZX0VOX01BU0spOworCisJLyogc2V0dXAgbW1VVkRfTVBDX0NO
VEwgKi8KKwl0bXAgPSBSUkVHMzJfU09DMTUoVVZELCAwLCBtbVVWRF9NUENfQ05UTCk7CisJdG1w
ICY9IH5VVkRfTVBDX0NOVExfX1JFUExBQ0VNRU5UX01PREVfTUFTSzsKKwl0bXAgfD0gMHgyIDw8
IFVWRF9NUENfQ05UTF9fUkVQTEFDRU1FTlRfTU9ERV9fU0hJRlQ7CisJV1JFRzMyX1NPQzE1KFZD
TiwgMCwgbW1VVkRfTVBDX0NOVEwsIHRtcCk7CisKKwkvKiBzZXR1cCBVVkRfTVBDX1NFVF9NVVhB
MCAqLworCVdSRUczMl9TT0MxNShVVkQsIDAsIG1tVVZEX01QQ19TRVRfTVVYQTAsCisJCSgoMHgx
IDw8IFVWRF9NUENfU0VUX01VWEEwX19WQVJBXzFfX1NISUZUKSB8CisJCSgweDIgPDwgVVZEX01Q
Q19TRVRfTVVYQTBfX1ZBUkFfMl9fU0hJRlQpIHwKKwkJKDB4MyA8PCBVVkRfTVBDX1NFVF9NVVhB
MF9fVkFSQV8zX19TSElGVCkgfAorCQkoMHg0IDw8IFVWRF9NUENfU0VUX01VWEEwX19WQVJBXzRf
X1NISUZUKSkpOworCisJLyogc2V0dXAgVVZEX01QQ19TRVRfTVVYQjAgKi8KKwlXUkVHMzJfU09D
MTUoVVZELCAwLCBtbVVWRF9NUENfU0VUX01VWEIwLAorCQkoKDB4MSA8PCBVVkRfTVBDX1NFVF9N
VVhCMF9fVkFSQl8xX19TSElGVCkgfAorCQkoMHgyIDw8IFVWRF9NUENfU0VUX01VWEIwX19WQVJC
XzJfX1NISUZUKSB8CisJCSgweDMgPDwgVVZEX01QQ19TRVRfTVVYQjBfX1ZBUkJfM19fU0hJRlQp
IHwKKwkJKDB4NCA8PCBVVkRfTVBDX1NFVF9NVVhCMF9fVkFSQl80X19TSElGVCkpKTsKKworCS8q
IHNldHVwIG1tVVZEX01QQ19TRVRfTVVYICovCisJV1JFRzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRf
TVBDX1NFVF9NVVgsCisJCSgoMHgwIDw8IFVWRF9NUENfU0VUX01VWF9fU0VUXzBfX1NISUZUKSB8
CisJCSgweDEgPDwgVVZEX01QQ19TRVRfTVVYX19TRVRfMV9fU0hJRlQpIHwKKwkJKDB4MiA8PCBV
VkRfTVBDX1NFVF9NVVhfX1NFVF8yX19TSElGVCkpKTsKKworCXZjbl92Ml81X21jX3Jlc3VtZShh
ZGV2KTsKKworCS8qIFZDTiBnbG9iYWwgdGlsaW5nIHJlZ2lzdGVycyAqLworCVdSRUczMl9TT0Mx
NShVVkQsIDAsIG1tVVZEX0dGWDhfQUREUl9DT05GSUcsCisJCWFkZXYtPmdmeC5jb25maWcuZ2Jf
YWRkcl9jb25maWcpOworCVdSRUczMl9TT0MxNShVVkQsIDAsIG1tVVZEX0dGWDhfQUREUl9DT05G
SUcsCisJCWFkZXYtPmdmeC5jb25maWcuZ2JfYWRkcl9jb25maWcpOworCisJLyogZW5hYmxlIExN
SSBNQyBhbmQgVU1DIGNoYW5uZWxzICovCisJV1JFRzMyX1AoU09DMTVfUkVHX09GRlNFVChVVkQs
IDAsIG1tVVZEX0xNSV9DVFJMMiksIDAsCisJCX5VVkRfTE1JX0NUUkwyX19TVEFMTF9BUkJfVU1D
X01BU0spOworCisJLyogdW5ibG9jayBWQ1BVIHJlZ2lzdGVyIGFjY2VzcyAqLworCVdSRUczMl9Q
KFNPQzE1X1JFR19PRkZTRVQoVVZELCAwLCBtbVVWRF9SQl9BUkJfQ1RSTCksIDAsCisJCX5VVkRf
UkJfQVJCX0NUUkxfX1ZDUFVfRElTX01BU0spOworCisJV1JFRzMyX1AoU09DMTVfUkVHX09GRlNF
VChVVkQsIDAsIG1tVVZEX1ZDUFVfQ05UTCksIDAsCisJCX5VVkRfVkNQVV9DTlRMX19CTEtfUlNU
X01BU0spOworCisJZm9yIChpID0gMDsgaSA8IDEwOyArK2kpIHsKKwkJdWludDMyX3Qgc3RhdHVz
OworCisJCWZvciAoaiA9IDA7IGogPCAxMDA7ICsraikgeworCQkJc3RhdHVzID0gUlJFRzMyX1NP
QzE1KFVWRCwgMCwgbW1VVkRfU1RBVFVTKTsKKwkJCWlmIChzdGF0dXMgJiAyKQorCQkJCWJyZWFr
OworCQkJaWYgKGFtZGdwdV9lbXVfbW9kZSA9PSAxKQorCQkJCW1zbGVlcCg1MDApOworCQkJZWxz
ZQorCQkJCW1kZWxheSgxMCk7CisJCX0KKwkJciA9IDA7CisJCWlmIChzdGF0dXMgJiAyKQorCQkJ
YnJlYWs7CisKKwkJRFJNX0VSUk9SKCJWQ04gZGVjb2RlIG5vdCByZXNwb25kaW5nLCB0cnlpbmcg
dG8gcmVzZXQgdGhlIFZDUFUhISFcbiIpOworCQlXUkVHMzJfUChTT0MxNV9SRUdfT0ZGU0VUKFVW
RCwgMCwgbW1VVkRfVkNQVV9DTlRMKSwKKwkJCVVWRF9WQ1BVX0NOVExfX0JMS19SU1RfTUFTSywK
KwkJCX5VVkRfVkNQVV9DTlRMX19CTEtfUlNUX01BU0spOworCQltZGVsYXkoMTApOworCQlXUkVH
MzJfUChTT0MxNV9SRUdfT0ZGU0VUKFVWRCwgMCwgbW1VVkRfVkNQVV9DTlRMKSwgMCwKKwkJCX5V
VkRfVkNQVV9DTlRMX19CTEtfUlNUX01BU0spOworCisJCW1kZWxheSgxMCk7CisJCXIgPSAtMTsK
Kwl9CisKKwlpZiAocikgeworCQlEUk1fRVJST1IoIlZDTiBkZWNvZGUgbm90IHJlc3BvbmRpbmcs
IGdpdmluZyB1cCEhIVxuIik7CisJCXJldHVybiByOworCX0KKworCS8qIGVuYWJsZSBtYXN0ZXIg
aW50ZXJydXB0ICovCisJV1JFRzMyX1AoU09DMTVfUkVHX09GRlNFVChVVkQsIDAsIG1tVVZEX01B
U1RJTlRfRU4pLAorCQlVVkRfTUFTVElOVF9FTl9fVkNQVV9FTl9NQVNLLAorCQl+VVZEX01BU1RJ
TlRfRU5fX1ZDUFVfRU5fTUFTSyk7CisKKwkvKiBjbGVhciB0aGUgYnVzeSBiaXQgb2YgVkNOX1NU
QVRVUyAqLworCVdSRUczMl9QKFNPQzE1X1JFR19PRkZTRVQoVVZELCAwLCBtbVVWRF9TVEFUVVMp
LCAwLAorCQl+KDIgPDwgVVZEX1NUQVRVU19fVkNQVV9SRVBPUlRfX1NISUZUKSk7CisKKwlXUkVH
MzJfU09DMTUoVVZELCAwLCBtbVVWRF9MTUlfUkJDX1JCX1ZNSUQsIDApOworCisJLyogZm9yY2Ug
UkJDIGludG8gaWRsZSBzdGF0ZSAqLworCXJiX2J1ZnN6ID0gb3JkZXJfYmFzZV8yKHJpbmctPnJp
bmdfc2l6ZSk7CisJdG1wID0gUkVHX1NFVF9GSUVMRCgwLCBVVkRfUkJDX1JCX0NOVEwsIFJCX0JV
RlNaLCByYl9idWZzeik7CisJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIFVWRF9SQkNfUkJfQ05U
TCwgUkJfQkxLU1osIDEpOworCXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBVVkRfUkJDX1JCX0NO
VEwsIFJCX05PX0ZFVENILCAxKTsKKwl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgVVZEX1JCQ19S
Ql9DTlRMLCBSQl9OT19VUERBVEUsIDEpOworCXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBVVkRf
UkJDX1JCX0NOVEwsIFJCX1JQVFJfV1JfRU4sIDEpOworCVdSRUczMl9TT0MxNShVVkQsIDAsIG1t
VVZEX1JCQ19SQl9DTlRMLCB0bXApOworCisJLyogcHJvZ3JhbW0gdGhlIFJCX0JBU0UgZm9yIHJp
bmcgYnVmZmVyICovCisJV1JFRzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRfTE1JX1JCQ19SQl82NEJJ
VF9CQVJfTE9XLAorCQlsb3dlcl8zMl9iaXRzKHJpbmctPmdwdV9hZGRyKSk7CisJV1JFRzMyX1NP
QzE1KFVWRCwgMCwgbW1VVkRfTE1JX1JCQ19SQl82NEJJVF9CQVJfSElHSCwKKwkJdXBwZXJfMzJf
Yml0cyhyaW5nLT5ncHVfYWRkcikpOworCisJLyogSW5pdGlhbGl6ZSB0aGUgcmluZyBidWZmZXIn
cyByZWFkIGFuZCB3cml0ZSBwb2ludGVycyAqLworCVdSRUczMl9TT0MxNShVVkQsIDAsIG1tVVZE
X1JCQ19SQl9SUFRSLCAwKTsKKworCXJpbmctPndwdHIgPSBSUkVHMzJfU09DMTUoVVZELCAwLCBt
bVVWRF9SQkNfUkJfUlBUUik7CisJV1JFRzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRfUkJDX1JCX1dQ
VFIsCisJCQlsb3dlcl8zMl9iaXRzKHJpbmctPndwdHIpKTsKKwlyaW5nID0gJmFkZXYtPnZjbi5y
aW5nX2VuY1swXTsKKwlXUkVHMzJfU09DMTUoVVZELCAwLCBtbVVWRF9SQl9SUFRSLCBsb3dlcl8z
Ml9iaXRzKHJpbmctPndwdHIpKTsKKwlXUkVHMzJfU09DMTUoVVZELCAwLCBtbVVWRF9SQl9XUFRS
LCBsb3dlcl8zMl9iaXRzKHJpbmctPndwdHIpKTsKKwlXUkVHMzJfU09DMTUoVVZELCAwLCBtbVVW
RF9SQl9CQVNFX0xPLCByaW5nLT5ncHVfYWRkcik7CisJV1JFRzMyX1NPQzE1KFVWRCwgMCwgbW1V
VkRfUkJfQkFTRV9ISSwgdXBwZXJfMzJfYml0cyhyaW5nLT5ncHVfYWRkcikpOworCVdSRUczMl9T
T0MxNShVVkQsIDAsIG1tVVZEX1JCX1NJWkUsIHJpbmctPnJpbmdfc2l6ZSAvIDQpOworCisJcmlu
ZyA9ICZhZGV2LT52Y24ucmluZ19lbmNbMV07CisJV1JFRzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRf
UkJfUlBUUjIsIGxvd2VyXzMyX2JpdHMocmluZy0+d3B0cikpOworCVdSRUczMl9TT0MxNShVVkQs
IDAsIG1tVVZEX1JCX1dQVFIyLCBsb3dlcl8zMl9iaXRzKHJpbmctPndwdHIpKTsKKwlXUkVHMzJf
U09DMTUoVVZELCAwLCBtbVVWRF9SQl9CQVNFX0xPMiwgcmluZy0+Z3B1X2FkZHIpOworCVdSRUcz
Ml9TT0MxNShVVkQsIDAsIG1tVVZEX1JCX0JBU0VfSEkyLCB1cHBlcl8zMl9iaXRzKHJpbmctPmdw
dV9hZGRyKSk7CisJV1JFRzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRfUkJfU0laRTIsIHJpbmctPnJp
bmdfc2l6ZSAvIDQpOworCisJcmV0dXJuIHI7Cit9CisKK3N0YXRpYyBpbnQgdmNuX3YyXzVfc3Rv
cChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKK3sKKwl1aW50MzJfdCB0bXA7CisJaW50IHI7
CisKKwkvKiB3YWl0IGZvciB2Y24gaWRsZSAqLworCVNPQzE1X1dBSVRfT05fUlJFRyhWQ04sIDAs
IG1tVVZEX1NUQVRVUywgVVZEX1NUQVRVU19fSURMRSwgMHg3LCByKTsKKwlpZiAocikKKwkJcmV0
dXJuIHI7CisKKwl0bXAgPSBVVkRfTE1JX1NUQVRVU19fVkNQVV9MTUlfV1JJVEVfQ0xFQU5fTUFT
SyB8CisJCVVWRF9MTUlfU1RBVFVTX19SRUFEX0NMRUFOX01BU0sgfAorCQlVVkRfTE1JX1NUQVRV
U19fV1JJVEVfQ0xFQU5fTUFTSyB8CisJCVVWRF9MTUlfU1RBVFVTX19XUklURV9DTEVBTl9SQVdf
TUFTSzsKKwlTT0MxNV9XQUlUX09OX1JSRUcoVkNOLCAwLCBtbVVWRF9MTUlfU1RBVFVTLCB0bXAs
IHRtcCwgcik7CisJaWYgKHIpCisJCXJldHVybiByOworCisJLyogYmxvY2sgTE1JIFVNQyBjaGFu
bmVsICovCisJdG1wID0gUlJFRzMyX1NPQzE1KFZDTiwgMCwgbW1VVkRfTE1JX0NUUkwyKTsKKwl0
bXAgfD0gVVZEX0xNSV9DVFJMMl9fU1RBTExfQVJCX1VNQ19NQVNLOworCVdSRUczMl9TT0MxNShW
Q04sIDAsIG1tVVZEX0xNSV9DVFJMMiwgdG1wKTsKKworCXRtcCA9IFVWRF9MTUlfU1RBVFVTX19V
TUNfUkVBRF9DTEVBTl9SQVdfTUFTS3wKKwkJVVZEX0xNSV9TVEFUVVNfX1VNQ19XUklURV9DTEVB
Tl9SQVdfTUFTSzsKKwlTT0MxNV9XQUlUX09OX1JSRUcoVkNOLCAwLCBtbVVWRF9MTUlfU1RBVFVT
LCB0bXAsIHRtcCwgcik7CisJaWYgKHIpCisJCXJldHVybiByOworCisJLyogYmxvY2sgVkNQVSBy
ZWdpc3RlciBhY2Nlc3MgKi8KKwlXUkVHMzJfUChTT0MxNV9SRUdfT0ZGU0VUKFVWRCwgMCwgbW1V
VkRfUkJfQVJCX0NUUkwpLAorCQlVVkRfUkJfQVJCX0NUUkxfX1ZDUFVfRElTX01BU0ssCisJCX5V
VkRfUkJfQVJCX0NUUkxfX1ZDUFVfRElTX01BU0spOworCisJLyogcmVzZXQgVkNQVSAqLworCVdS
RUczMl9QKFNPQzE1X1JFR19PRkZTRVQoVVZELCAwLCBtbVVWRF9WQ1BVX0NOVEwpLAorCQlVVkRf
VkNQVV9DTlRMX19CTEtfUlNUX01BU0ssCisJCX5VVkRfVkNQVV9DTlRMX19CTEtfUlNUX01BU0sp
OworCisJLyogZGlzYWJsZSBWQ1BVIGNsb2NrICovCisJV1JFRzMyX1AoU09DMTVfUkVHX09GRlNF
VChVVkQsIDAsIG1tVVZEX1ZDUFVfQ05UTCksIDAsCisJCX4oVVZEX1ZDUFVfQ05UTF9fQ0xLX0VO
X01BU0spKTsKKworCS8qIGNsZWFyIHN0YXR1cyAqLworCVdSRUczMl9TT0MxNShWQ04sIDAsIG1t
VVZEX1NUQVRVUywgMCk7CisKKwl2Y25fdjJfNV9lbmFibGVfY2xvY2tfZ2F0aW5nKGFkZXYpOwor
CisJLyogZW5hYmxlIHJlZ2lzdGVyIGFudGktaGFuZyBtZWNoYW5pc20gKi8KKwlXUkVHMzJfUChT
T0MxNV9SRUdfT0ZGU0VUKFVWRCwgMCwgbW1VVkRfUE9XRVJfU1RBVFVTKSwKKwkJVVZEX1BPV0VS
X1NUQVRVU19fVVZEX1BPV0VSX1NUQVRVU19NQVNLLAorCQl+VVZEX1BPV0VSX1NUQVRVU19fVVZE
X1BPV0VSX1NUQVRVU19NQVNLKTsKKworCXJldHVybiAwOworfQorCiBzdGF0aWMgYm9vbCB2Y25f
djJfNV9pc19pZGxlKHZvaWQgKmhhbmRsZSkKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diA9IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhhbmRsZTsKQEAgLTMyOCwxMyArNzY4LDM4IEBA
IHN0YXRpYyBpbnQgdmNuX3YyXzVfd2FpdF9mb3JfaWRsZSh2b2lkICpoYW5kbGUpCiBzdGF0aWMg
aW50IHZjbl92Ml81X3NldF9jbG9ja2dhdGluZ19zdGF0ZSh2b2lkICpoYW5kbGUsCiAJCQkJCSAg
ZW51bSBhbWRfY2xvY2tnYXRpbmdfc3RhdGUgc3RhdGUpCiB7CisJc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7CisJYm9vbCBlbmFibGUg
PSAoc3RhdGUgPT0gQU1EX0NHX1NUQVRFX0dBVEUpID8gdHJ1ZSA6IGZhbHNlOworCisJaWYgKGVu
YWJsZSkgeworCQlpZiAodmNuX3YyXzVfaXNfaWRsZShoYW5kbGUpKQorCQkJcmV0dXJuIC1FQlVT
WTsKKwkJdmNuX3YyXzVfZW5hYmxlX2Nsb2NrX2dhdGluZyhhZGV2KTsKKwl9IGVsc2UgeworCQl2
Y25fdjJfNV9kaXNhYmxlX2Nsb2NrX2dhdGluZyhhZGV2KTsKKwl9CisKIAlyZXR1cm4gMDsKIH0K
IAogc3RhdGljIGludCB2Y25fdjJfNV9zZXRfcG93ZXJnYXRpbmdfc3RhdGUodm9pZCAqaGFuZGxl
LAogCQkJCQkgIGVudW0gYW1kX3Bvd2VyZ2F0aW5nX3N0YXRlIHN0YXRlKQogewotCXJldHVybiAw
OworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gKHN0cnVjdCBhbWRncHVfZGV2aWNlICop
aGFuZGxlOworCWludCByZXQ7CisKKwlpZihzdGF0ZSA9PSBhZGV2LT52Y24uY3VyX3N0YXRlKQor
CQlyZXR1cm4gMDsKKworCWlmIChzdGF0ZSA9PSBBTURfUEdfU1RBVEVfR0FURSkKKwkJcmV0ID0g
dmNuX3YyXzVfc3RvcChhZGV2KTsKKwllbHNlCisJCXJldCA9IHZjbl92Ml81X3N0YXJ0KGFkZXYp
OworCisJaWYoIXJldCkKKwkJYWRldi0+dmNuLmN1cl9zdGF0ZSA9IHN0YXRlOworCisJcmV0dXJu
IHJldDsKIH0KIAogc3RhdGljIGludCB2Y25fdjJfNV9zZXRfaW50ZXJydXB0X3N0YXRlKHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2LAotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2FtZC1nZng=
