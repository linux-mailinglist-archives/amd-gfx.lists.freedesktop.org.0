Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 54F19F33E8
	for <lists+amd-gfx@lfdr.de>; Thu,  7 Nov 2019 16:56:49 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 67B2C6F730;
	Thu,  7 Nov 2019 15:56:47 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM03-CO1-obe.outbound.protection.outlook.com
 (mail-eopbgr790070.outbound.protection.outlook.com [40.107.79.70])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7101E6F730
 for <amd-gfx@lists.freedesktop.org>; Thu,  7 Nov 2019 15:56:45 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=VM3HV1hoUGB4jiBx8rTVaHj00btRWWSR94nEv6w0+qoQkqj58whqSzO6+JcLD7U2mAz8QZR+zEIyF78LeZg1cE1LUlGpfsrSavjrMvuA4BA/yxq+b3SVkZF12yjno5kSXa6+FmI5gwSU7GW/w/bIUt8NPXdLUQeV6aY4KQjG4Lr3cKYQa8vtFKGTVHFWB1TP1roLyB9YZKOc+r2ygF3Ea1EkTjbiqUjKIv6dRk8oPk5ouwrf1uUFK7CoNVQYFCaZFZP/DN0YpfKryi6/EMqHD1idjxGaigA5eoDzm0CFQWfncmcYtceYrovL2gDmBUeDRUghhBRmeSJgfYh0FerH7Q==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=XZAn5beMM8V8U2IA63G7FZqPeg6yAIvnO05L4YQFFTE=;
 b=CEtSwDpxFHaD8soJeaEQ32fnelrtTKmcpcFzVsqkzCJ6zX5PTvkYVzkHOJvwkg7i+P3pQmgnbDn8EhaKfj++VcmhdqjuQTuEicDIs7YyNSSQy2qo7ym8VHMkpiso5XmWComUpNwg+pQeqNZtQB/ArLIUtRLslUWeiWkkLY4M8t4+p8Tt/BYpF2QXAhPkXJqs/A3i1M/0bTRzOFYB8mNQX1iwSBiYt34aouv/GLoIFryoViB4J/YJlyV9bBXEzlTdabRkeDCxXL9FIajW7G1iVm4kowkJUVuYiI5oxZKJ5CCstz2wD3WkzjtASD/fgz6lf9rZEtzrCXZoIIQivtetGQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=none (sender ip is
 165.204.84.17) smtp.rcpttodomain=lists.freedesktop.org smtp.mailfrom=amd.com; 
 dmarc=permerror action=none header.from=amd.com; dkim=none (message not
 signed); arc=none
Received: from BN8PR12CA0016.namprd12.prod.outlook.com (2603:10b6:408:60::29)
 by BY5PR12MB4065.namprd12.prod.outlook.com (2603:10b6:a03:202::16)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2430.23; Thu, 7 Nov
 2019 15:56:43 +0000
Received: from DM3NAM03FT025.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e49::201) by BN8PR12CA0016.outlook.office365.com
 (2603:10b6:408:60::29) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.2408.24 via Frontend
 Transport; Thu, 7 Nov 2019 15:56:43 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXMB01.amd.com (165.204.84.17) by
 DM3NAM03FT025.mail.protection.outlook.com (10.152.82.181) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256) id
 15.20.2430.20 via Frontend Transport; Thu, 7 Nov 2019 15:56:42 +0000
Received: from SATLEXMB01.amd.com (10.181.40.142) by SATLEXMB01.amd.com
 (10.181.40.142) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.1713.5; Thu, 7 Nov 2019
 09:56:41 -0600
Received: from blakha.amd.com (10.180.168.240) by SATLEXMB01.amd.com
 (10.181.40.142) with Microsoft SMTP Server id 15.1.1713.5 via Frontend
 Transport; Thu, 7 Nov 2019 09:56:41 -0600
From: Bhawanpreet Lakha <Bhawanpreet.Lakha@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 01/14] drm/amd/display: Add PSP block to verify HDCP2.2 steps
Date: Thu, 7 Nov 2019 10:56:15 -0500
Message-ID: <20191107155628.19446-2-Bhawanpreet.Lakha@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191107155628.19446-1-Bhawanpreet.Lakha@amd.com>
References: <20191107155628.19446-1-Bhawanpreet.Lakha@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(346002)(136003)(396003)(39860400002)(376002)(428003)(189003)(199004)(2906002)(70586007)(305945005)(81166006)(81156014)(8676002)(446003)(76176011)(11346002)(478600001)(51416003)(7696005)(126002)(476003)(6916009)(50226002)(15650500001)(2616005)(8936002)(70206006)(47776003)(486006)(316002)(4326008)(53416004)(426003)(26005)(14444005)(1076003)(86362001)(36756003)(54906003)(336012)(50466002)(186003)(6666004)(2351001)(48376002)(356004)(5660300002)(16586007)(30864003);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BY5PR12MB4065; H:SATLEXMB01.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; MX:1; A:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 7332649e-4a3c-465f-6052-08d7639b158a
X-MS-TrafficTypeDiagnostic: BY5PR12MB4065:
X-Microsoft-Antispam-PRVS: <BY5PR12MB4065F07D6F78CDC4529D70F6F9780@BY5PR12MB4065.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:741;
X-Forefront-PRVS: 0214EB3F68
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: XUUOXfQAesidXT3+sLB6cXdDe9aXwtFgNXjnL6pFtWvhDn7TxKudFKDqTuqfuJ9niDG1phKkqg7deQaMls9UbGS1owQMrIqay8QVHB0k764A/aptqlvxUSzgX6BKt2w+jPRc+88v/OdZ6/VLtQK9s+zfGgDzRMyZe6gofFBeOamKZHm9wJ5qkcwKEmif3rxukuTNaMwMwAK/iDz5FxfS0P7DSMK79Q7h2X0SX0/lUMXpB8DH84Ik7ETZOkccoYn2KHy1457muDZelKXdcluVIkXQUCeABAhXT1kJIMb39FS1Dpn+zTngykqD63jdXAyJg+BZRYzHlBxS5Cs2GjKgGN9wVEdSuKUJ5xFMhAultVT0EgLpTXFw/zG1jK3w7uN6+MwaoBo5y762a3g+29+F5YFuUAOoCFDkGtwB/kgH2/YLIcffo+1zaQpTnQrRgGTz
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 07 Nov 2019 15:56:42.7834 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 7332649e-4a3c-465f-6052-08d7639b158a
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXMB01.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BY5PR12MB4065
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=XZAn5beMM8V8U2IA63G7FZqPeg6yAIvnO05L4YQFFTE=;
 b=ltt/HGQF9I8xrwQz3qORQioKQUl9kJi28PMzgKY5sK9uCYIps0vKrA1ZEndimZi/6paMAKRdIj6gzbIJnJcBt6pLpyRdUPR/IZd48LzyppfOT1eoocAcd9Sgwaout1La/m8Q8IRXeZrnpjGajTTdHjvcd5TXTxvnBe0abEuPfOM=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Bhawanpreet Lakha <Bhawanpreet.Lakha@amd.com>, Wenjing.Liu@amd.com,
 harry.wentland@amd.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

W1doeV0KQWxsIHRoZSBIRENQIHRyYW5zYWN0aW9ucyBzaG91bGQgYmUgdmVyaWZpZWQgdXNpbmcg
UFNQCgpbSG93XQpUaGlzIHBhdGNoIGFkZHMgdGhlIHBzcCBjYWxscyB3ZSBuZWVkIHRvIHZlcmlm
eSB0aGUgc3RlcHMKClNpZ25lZC1vZmYtYnk6IEJoYXdhbnByZWV0IExha2hhIDxCaGF3YW5wcmVl
dC5MYWtoYUBhbWQuY29tPgotLS0KIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L21vZHVsZXMvaGRj
cC9oZGNwLmggICB8ICA0NCArKwogLi4uL2RybS9hbWQvZGlzcGxheS9tb2R1bGVzL2hkY3AvaGRj
cF9wc3AuYyAgIHwgNTAyICsrKysrKysrKysrKysrKysrLQogLi4uL2RybS9hbWQvZGlzcGxheS9t
b2R1bGVzL2hkY3AvaGRjcF9wc3AuaCAgIHwgMTk0ICsrKysrKysKIDMgZmlsZXMgY2hhbmdlZCwg
NzM5IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvbW9kdWxlcy9oZGNwL2hkY3AuaCBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9tb2R1bGVzL2hkY3AvaGRjcC5oCmluZGV4IDU2NjRiYzBiNWJkMC4uZDgzZjBh
YjFjYWRiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvbW9kdWxlcy9o
ZGNwL2hkY3AuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvbW9kdWxlcy9oZGNw
L2hkY3AuaApAQCAtMTExLDggKzExMSwzMyBAQCBzdHJ1Y3QgbW9kX2hkY3BfbWVzc2FnZV9oZGNw
MSB7CiAJdWludDE2X3QJYmluZm9fZHA7CiB9OwogCitzdHJ1Y3QgbW9kX2hkY3BfbWVzc2FnZV9o
ZGNwMiB7CisJdWludDhfdAkJaGRjcDJ2ZXJzaW9uX2hkbWk7CisJdWludDhfdAkJcnhjYXBzX2Rw
WzNdOworCXVpbnQxNl90CXJ4c3RhdHVzOworCisJdWludDhfdAkJYWtlX2luaXRbMTJdOworCXVp
bnQ4X3QJCWFrZV9jZXJ0WzUzNF07CisJdWludDhfdAkJYWtlX25vX3N0b3JlZF9rbVsxMjldOwor
CXVpbnQ4X3QJCWFrZV9zdG9yZWRfa21bMzNdOworCXVpbnQ4X3QJCWFrZV9oX3ByaW1lWzMzXTsK
Kwl1aW50OF90CQlha2VfcGFpcmluZ19pbmZvWzE3XTsKKwl1aW50OF90CQlsY19pbml0WzldOwor
CXVpbnQ4X3QJCWxjX2xfcHJpbWVbMzNdOworCXVpbnQ4X3QJCXNrZV9la3NbMjVdOworCXVpbnQ4
X3QJCXJ4X2lkX2xpc3RbMTc3XTsgLy8gMjIgKyA1ICogMzEKKwl1aW50MTZfdAlyeF9pZF9saXN0
X3NpemU7CisJdWludDhfdAkJcmVwZWF0ZXJfYXV0aF9hY2tbMTddOworCXVpbnQ4X3QJCXJlcGVh
dGVyX2F1dGhfc3RyZWFtX21hbmFnZVs2OF07IC8vIDYgKyAyICogMzEKKwl1aW50MTZfdAlzdHJl
YW1fbWFuYWdlX3NpemU7CisJdWludDhfdAkJcmVwZWF0ZXJfYXV0aF9zdHJlYW1fcmVhZHlbMzNd
OworCisJdWludDhfdAkJY29udGVudF9zdHJlYW1fdHlwZV9kcFsyXTsKK307CisKIHVuaW9uIG1v
ZF9oZGNwX21lc3NhZ2UgewogCXN0cnVjdCBtb2RfaGRjcF9tZXNzYWdlX2hkY3AxIGhkY3AxOwor
CXN0cnVjdCBtb2RfaGRjcF9tZXNzYWdlX2hkY3AyIGhkY3AyOwogfTsKIAogc3RydWN0IG1vZF9o
ZGNwX2F1dGhfY291bnRlcnMgewpAQCAtMjM0LDYgKzI1OSwyNSBAQCBlbnVtIG1vZF9oZGNwX3N0
YXR1cyBtb2RfaGRjcF9oZGNwMV9lbmFibGVfZHBfc3RyZWFtX2VuY3J5cHRpb24oCiBlbnVtIG1v
ZF9oZGNwX3N0YXR1cyBtb2RfaGRjcF9oZGNwMV9saW5rX21haW50ZW5hbmNlKHN0cnVjdCBtb2Rf
aGRjcCAqaGRjcCk7CiBlbnVtIG1vZF9oZGNwX3N0YXR1cyBtb2RfaGRjcF9oZGNwMV9nZXRfbGlu
a19lbmNyeXB0aW9uX3N0YXR1cyhzdHJ1Y3QgbW9kX2hkY3AgKmhkY3AsCiAJCQkJCQkJICAgICAg
IGVudW0gbW9kX2hkY3BfZW5jcnlwdGlvbl9zdGF0dXMgKmVuY3J5cHRpb25fc3RhdHVzKTsKK2Vu
dW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9oZGNwX2hkY3AyX2NyZWF0ZV9zZXNzaW9uKHN0cnVjdCBt
b2RfaGRjcCAqaGRjcCk7CitlbnVtIG1vZF9oZGNwX3N0YXR1cyBtb2RfaGRjcF9oZGNwMl9kZXN0
cm95X3Nlc3Npb24oc3RydWN0IG1vZF9oZGNwICpoZGNwKTsKK2VudW0gbW9kX2hkY3Bfc3RhdHVz
IG1vZF9oZGNwX2hkY3AyX3ByZXBhcmVfYWtlX2luaXQoc3RydWN0IG1vZF9oZGNwICpoZGNwKTsK
K2VudW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9oZGNwX2hkY3AyX3ZhbGlkYXRlX2FrZV9jZXJ0KHN0
cnVjdCBtb2RfaGRjcCAqaGRjcCk7CitlbnVtIG1vZF9oZGNwX3N0YXR1cyBtb2RfaGRjcF9oZGNw
Ml92YWxpZGF0ZV9oX3ByaW1lKHN0cnVjdCBtb2RfaGRjcCAqaGRjcCk7CitlbnVtIG1vZF9oZGNw
X3N0YXR1cyBtb2RfaGRjcF9oZGNwMl9wcmVwYXJlX2xjX2luaXQoc3RydWN0IG1vZF9oZGNwICpo
ZGNwKTsKK2VudW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9oZGNwX2hkY3AyX3ZhbGlkYXRlX2xfcHJp
bWUoc3RydWN0IG1vZF9oZGNwICpoZGNwKTsKK2VudW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9oZGNw
X2hkY3AyX3ByZXBhcmVfZWtzKHN0cnVjdCBtb2RfaGRjcCAqaGRjcCk7CitlbnVtIG1vZF9oZGNw
X3N0YXR1cyBtb2RfaGRjcF9oZGNwMl9lbmFibGVfZW5jcnlwdGlvbihzdHJ1Y3QgbW9kX2hkY3Ag
KmhkY3ApOworZW51bSBtb2RfaGRjcF9zdGF0dXMgbW9kX2hkY3BfaGRjcDJfdmFsaWRhdGVfcnhf
aWRfbGlzdChzdHJ1Y3QgbW9kX2hkY3AgKmhkY3ApOworZW51bSBtb2RfaGRjcF9zdGF0dXMgbW9k
X2hkY3BfaGRjcDJfZW5hYmxlX2RwX3N0cmVhbV9lbmNyeXB0aW9uKAorCQlzdHJ1Y3QgbW9kX2hk
Y3AgKmhkY3ApOworZW51bSBtb2RfaGRjcF9zdGF0dXMgbW9kX2hkY3BfaGRjcDJfcHJlcGFyZV9z
dHJlYW1fbWFuYWdlbWVudCgKKwkJc3RydWN0IG1vZF9oZGNwICpoZGNwKTsKK2VudW0gbW9kX2hk
Y3Bfc3RhdHVzIG1vZF9oZGNwX2hkY3AyX3ZhbGlkYXRlX3N0cmVhbV9yZWFkeSgKKwkJc3RydWN0
IG1vZF9oZGNwICpoZGNwKTsKK2VudW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9oZGNwX2hkY3AyX2dl
dF9saW5rX2VuY3J5cHRpb25fc3RhdHVzKHN0cnVjdCBtb2RfaGRjcCAqaGRjcCwKKwkJCQkJCQkg
ICAgICAgZW51bSBtb2RfaGRjcF9lbmNyeXB0aW9uX3N0YXR1cyAqZW5jcnlwdGlvbl9zdGF0dXMp
OworCiAvKiBkZGMgZnVuY3Rpb25zICovCiBlbnVtIG1vZF9oZGNwX3N0YXR1cyBtb2RfaGRjcF9y
ZWFkX2Jrc3Yoc3RydWN0IG1vZF9oZGNwICpoZGNwKTsKIGVudW0gbW9kX2hkY3Bfc3RhdHVzIG1v
ZF9oZGNwX3JlYWRfYmNhcHMoc3RydWN0IG1vZF9oZGNwICpoZGNwKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9tb2R1bGVzL2hkY3AvaGRjcF9wc3AuYyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvZGlzcGxheS9tb2R1bGVzL2hkY3AvaGRjcF9wc3AuYwppbmRleCA2NDZk
OTA5YmJjMzcuLmRkYmEwY2ZhNTcyMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L21vZHVsZXMvaGRjcC9oZGNwX3BzcC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9tb2R1bGVzL2hkY3AvaGRjcF9wc3AuYwpAQCAtMzEsNiArMzEsMTkgQEAKICNpbmNs
dWRlICJhbWRncHUuaCIKICNpbmNsdWRlICJoZGNwX3BzcC5oIgogCitzdGF0aWMgdm9pZCBoZGNw
Ml9tZXNzYWdlX2luaXQoc3RydWN0IG1vZF9oZGNwICpoZGNwLAorCQkJICAgICAgIHN0cnVjdCB0
YV9oZGNwX2NtZF9oZGNwMl9wcm9jZXNzX3ByZXBhcmVfYXV0aGVudGljYXRpb25fbWVzc2FnZV9p
bnB1dF92MiAqaW4pCit7CisJaW4tPnNlc3Npb25faGFuZGxlID0gaGRjcC0+YXV0aC5pZDsKKwlp
bi0+cHJlcGFyZS5tc2cxX2lkID0gVEFfSERDUF9IRENQMl9NU0dfSURfX05VTExfTUVTU0FHRTsK
Kwlpbi0+cHJlcGFyZS5tc2cyX2lkID0gVEFfSERDUF9IRENQMl9NU0dfSURfX05VTExfTUVTU0FH
RTsKKwlpbi0+cHJvY2Vzcy5tc2cxX2Rlc2MubXNnX2lkID0gVEFfSERDUF9IRENQMl9NU0dfSURf
X05VTExfTUVTU0FHRTsKKwlpbi0+cHJvY2Vzcy5tc2cxX2Rlc2MubXNnX3NpemUgPSAwOworCWlu
LT5wcm9jZXNzLm1zZzJfZGVzYy5tc2dfaWQgPSBUQV9IRENQX0hEQ1AyX01TR19JRF9fTlVMTF9N
RVNTQUdFOworCWluLT5wcm9jZXNzLm1zZzJfZGVzYy5tc2dfc2l6ZSA9IDA7CisJaW4tPnByb2Nl
c3MubXNnM19kZXNjLm1zZ19pZCA9IFRBX0hEQ1BfSERDUDJfTVNHX0lEX19OVUxMX01FU1NBR0U7
CisJaW4tPnByb2Nlc3MubXNnM19kZXNjLm1zZ19pZCA9IDA7Cit9CiBlbnVtIG1vZF9oZGNwX3N0
YXR1cyBtb2RfaGRjcF9yZW1vdmVfZGlzcGxheV90b3BvbG9neShzdHJ1Y3QgbW9kX2hkY3AgKmhk
Y3ApCiB7CiAKQEAgLTQyLDcgKzU1LDcgQEAgZW51bSBtb2RfaGRjcF9zdGF0dXMgbW9kX2hkY3Bf
cmVtb3ZlX2Rpc3BsYXlfdG9wb2xvZ3koc3RydWN0IG1vZF9oZGNwICpoZGNwKQogCWR0bV9jbWQg
PSAoc3RydWN0IHRhX2R0bV9zaGFyZWRfbWVtb3J5ICopcHNwLT5kdG1fY29udGV4dC5kdG1fc2hh
cmVkX2J1ZjsKIAogCWZvciAoaSA9IDA7IGkgPCBNQVhfTlVNX09GX0RJU1BMQVlTOyBpKyspIHsK
LQkJaWYgKGhkY3AtPmNvbm5lY3Rpb24uZGlzcGxheXNbaV0uc3RhdGUgPT0gTU9EX0hEQ1BfRElT
UExBWV9BQ1RJVkVfQU5EX0FEREVEKSB7CisJCWlmIChpc19kaXNwbGF5X2FkZGVkKCYoaGRjcC0+
Y29ubmVjdGlvbi5kaXNwbGF5c1tpXSkpKSB7CiAKIAkJCW1lbXNldChkdG1fY21kLCAwLCBzaXpl
b2Yoc3RydWN0IHRhX2R0bV9zaGFyZWRfbWVtb3J5KSk7CiAKQEAgLTMyNiwzICszMzksNDkwIEBA
IGVudW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9oZGNwX2hkY3AxX2dldF9saW5rX2VuY3J5cHRpb25f
c3RhdHVzKHN0cnVjdCBtb2RfaGRjcCAqCiAJcmV0dXJuIE1PRF9IRENQX1NUQVRVU19TVUNDRVNT
OwogfQogCitlbnVtIG1vZF9oZGNwX3N0YXR1cyBtb2RfaGRjcF9oZGNwMl9jcmVhdGVfc2Vzc2lv
bihzdHJ1Y3QgbW9kX2hkY3AgKmhkY3ApCit7CisJc3RydWN0IHBzcF9jb250ZXh0ICpwc3AgPSBo
ZGNwLT5jb25maWcucHNwLmhhbmRsZTsKKwlzdHJ1Y3QgdGFfaGRjcF9zaGFyZWRfbWVtb3J5ICpo
ZGNwX2NtZDsKKwlzdHJ1Y3QgbW9kX2hkY3BfZGlzcGxheSAqZGlzcGxheSA9IGdldF9maXJzdF9h
ZGRlZF9kaXNwbGF5KGhkY3ApOworCisJaWYgKCFwc3AtPmhkY3BfY29udGV4dC5oZGNwX2luaXRp
YWxpemVkKSB7CisJCURSTV9FUlJPUigiRmFpbGVkIHRvIGNyZWF0ZSBoZGNwIHNlc3Npb24sIEhE
Q1AgVEEgaXMgbm90IGluaXRpYWxpemVkIik7CisJCXJldHVybiBNT0RfSERDUF9TVEFUVVNfRkFJ
TFVSRTsKKwl9CisKKwloZGNwX2NtZCA9IChzdHJ1Y3QgdGFfaGRjcF9zaGFyZWRfbWVtb3J5ICop
cHNwLT5oZGNwX2NvbnRleHQuaGRjcF9zaGFyZWRfYnVmOworCW1lbXNldChoZGNwX2NtZCwgMCwg
c2l6ZW9mKHN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1vcnkpKTsKKworCWlmICghZGlzcGxheSkK
KwkJcmV0dXJuIE1PRF9IRENQX1NUQVRVU19ESVNQTEFZX05PVF9GT1VORDsKKworCWhkY3BfY21k
LT5pbl9tc2cuaGRjcDJfY3JlYXRlX3Nlc3Npb25fdjIuZGlzcGxheV9oYW5kbGUgPSBkaXNwbGF5
LT5pbmRleDsKKworCWlmIChoZGNwLT5jb25uZWN0aW9uLmxpbmsuYWRqdXN0LmhkY3AyLmRpc2Fi
bGVfdHlwZTEpCisJCWhkY3BfY21kLT5pbl9tc2cuaGRjcDJfY3JlYXRlX3Nlc3Npb25fdjIubmVn
b3RpYXRlX2NvbnRlbnRfdHlwZSA9CisJCQlUQV9IRENQMl9DT05URU5UX1RZUEVfTkVHT1RJQVRJ
T05fVFlQRV9fRk9SQ0VfVFlQRTA7CisJZWxzZQorCQloZGNwX2NtZC0+aW5fbXNnLmhkY3AyX2Ny
ZWF0ZV9zZXNzaW9uX3YyLm5lZ290aWF0ZV9jb250ZW50X3R5cGUgPQorCQkJVEFfSERDUDJfQ09O
VEVOVF9UWVBFX05FR09USUFUSU9OX1RZUEVfX01BWF9TVVBQT1JURUQ7CisKKwloZGNwX2NtZC0+
Y21kX2lkID0gVEFfSERDUF9DT01NQU5EX19IRENQMl9DUkVBVEVfU0VTU0lPTl9WMjsKKworCXBz
cF9oZGNwX2ludm9rZShwc3AsIGhkY3BfY21kLT5jbWRfaWQpOworCisJaWYgKGhkY3BfY21kLT5o
ZGNwX3N0YXR1cyAhPSBUQV9IRENQX1NUQVRVU19fU1VDQ0VTUykKKwkJcmV0dXJuIE1PRF9IRENQ
X1NUQVRVU19IRENQMl9DUkVBVEVfU0VTU0lPTl9GQUlMVVJFOworCisJaGRjcC0+YXV0aC5pZCA9
IGhkY3BfY21kLT5vdXRfbXNnLmhkY3AyX2NyZWF0ZV9zZXNzaW9uX3YyLnNlc3Npb25faGFuZGxl
OworCisJcmV0dXJuIE1PRF9IRENQX1NUQVRVU19TVUNDRVNTOworfQorCitlbnVtIG1vZF9oZGNw
X3N0YXR1cyBtb2RfaGRjcF9oZGNwMl9kZXN0cm95X3Nlc3Npb24oc3RydWN0IG1vZF9oZGNwICpo
ZGNwKQoreworCXN0cnVjdCBwc3BfY29udGV4dCAqcHNwID0gaGRjcC0+Y29uZmlnLnBzcC5oYW5k
bGU7CisJc3RydWN0IHRhX2hkY3Bfc2hhcmVkX21lbW9yeSAqaGRjcF9jbWQ7CisKKwloZGNwX2Nt
ZCA9IChzdHJ1Y3QgdGFfaGRjcF9zaGFyZWRfbWVtb3J5ICopcHNwLT5oZGNwX2NvbnRleHQuaGRj
cF9zaGFyZWRfYnVmOworCW1lbXNldChoZGNwX2NtZCwgMCwgc2l6ZW9mKHN0cnVjdCB0YV9oZGNw
X3NoYXJlZF9tZW1vcnkpKTsKKworCWhkY3BfY21kLT5pbl9tc2cuaGRjcDJfZGVzdHJveV9zZXNz
aW9uLnNlc3Npb25faGFuZGxlID0gaGRjcC0+YXV0aC5pZDsKKwloZGNwX2NtZC0+Y21kX2lkID0g
VEFfSERDUF9DT01NQU5EX19IRENQMl9ERVNUUk9ZX1NFU1NJT047CisKKwlwc3BfaGRjcF9pbnZv
a2UocHNwLCBoZGNwX2NtZC0+Y21kX2lkKTsKKworCWlmIChoZGNwX2NtZC0+aGRjcF9zdGF0dXMg
IT0gVEFfSERDUF9TVEFUVVNfX1NVQ0NFU1MpCisJCXJldHVybiBNT0RfSERDUF9TVEFUVVNfSERD
UDJfREVTVFJPWV9TRVNTSU9OX0ZBSUxVUkU7CisKKwlyZXR1cm4gTU9EX0hEQ1BfU1RBVFVTX1NV
Q0NFU1M7Cit9CisKK2VudW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9oZGNwX2hkY3AyX3ByZXBhcmVf
YWtlX2luaXQoc3RydWN0IG1vZF9oZGNwICpoZGNwKQoreworCXN0cnVjdCBwc3BfY29udGV4dCAq
cHNwID0gaGRjcC0+Y29uZmlnLnBzcC5oYW5kbGU7CisJc3RydWN0IHRhX2hkY3Bfc2hhcmVkX21l
bW9yeSAqaGRjcF9jbWQ7CisJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFy
ZV9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX2lucHV0X3YyICptc2dfaW47CisJc3RydWN0IHRhX2hk
Y3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFyZV9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX291dHB1
dF92MiAqbXNnX291dDsKKworCWhkY3BfY21kID0gKHN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1v
cnkgKilwc3AtPmhkY3BfY29udGV4dC5oZGNwX3NoYXJlZF9idWY7CisJbWVtc2V0KGhkY3BfY21k
LCAwLCBzaXplb2Yoc3RydWN0IHRhX2hkY3Bfc2hhcmVkX21lbW9yeSkpOworCisJbXNnX2luID0g
JmhkY3BfY21kLT5pbl9tc2cuaGRjcDJfcHJlcGFyZV9wcm9jZXNzX2F1dGhlbnRpY2F0aW9uX21l
c3NhZ2VfdjI7CisJbXNnX291dCA9ICZoZGNwX2NtZC0+b3V0X21zZy5oZGNwMl9wcmVwYXJlX3By
b2Nlc3NfYXV0aGVudGljYXRpb25fbWVzc2FnZV92MjsKKworCWhkY3AyX21lc3NhZ2VfaW5pdCho
ZGNwLCBtc2dfaW4pOworCisJaGRjcF9jbWQtPmNtZF9pZCA9IFRBX0hEQ1BfQ09NTUFORF9fSERD
UDJfUFJFUEFSRV9QUk9DRVNTX0FVVEhFTlRJQ0FUSU9OX01TR19WMjsKKwltc2dfaW4tPnByZXBh
cmUubXNnMV9pZCA9IFRBX0hEQ1BfSERDUDJfTVNHX0lEX19BS0VfSU5JVDsKKworCXBzcF9oZGNw
X2ludm9rZShwc3AsIGhkY3BfY21kLT5jbWRfaWQpOworCisJaWYgKGhkY3BfY21kLT5oZGNwX3N0
YXR1cyAhPSBUQV9IRENQX1NUQVRVU19fU1VDQ0VTUykKKwkJcmV0dXJuIE1PRF9IRENQX1NUQVRV
U19IRENQMl9QUkVQX0FLRV9JTklUX0ZBSUxVUkU7CisKKwltZW1jcHkoJmhkY3AtPmF1dGgubXNn
LmhkY3AyLmFrZV9pbml0WzBdLCAmbXNnX291dC0+cHJlcGFyZS50cmFuc21pdHRlcl9tZXNzYWdl
WzBdLAorCSAgICAgICBzaXplb2YoaGRjcC0+YXV0aC5tc2cuaGRjcDIuYWtlX2luaXQpKTsKKwor
CXJldHVybiBNT0RfSERDUF9TVEFUVVNfU1VDQ0VTUzsKK30KKworZW51bSBtb2RfaGRjcF9zdGF0
dXMgbW9kX2hkY3BfaGRjcDJfdmFsaWRhdGVfYWtlX2NlcnQoc3RydWN0IG1vZF9oZGNwICpoZGNw
KQoreworCXN0cnVjdCBwc3BfY29udGV4dCAqcHNwID0gaGRjcC0+Y29uZmlnLnBzcC5oYW5kbGU7
CisJc3RydWN0IHRhX2hkY3Bfc2hhcmVkX21lbW9yeSAqaGRjcF9jbWQ7CisJc3RydWN0IHRhX2hk
Y3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFyZV9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX2lucHV0
X3YyICptc2dfaW47CisJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFyZV9h
dXRoZW50aWNhdGlvbl9tZXNzYWdlX291dHB1dF92MiAqbXNnX291dDsKKworCWhkY3BfY21kID0g
KHN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1vcnkgKilwc3AtPmhkY3BfY29udGV4dC5oZGNwX3No
YXJlZF9idWY7CisJbWVtc2V0KGhkY3BfY21kLCAwLCBzaXplb2Yoc3RydWN0IHRhX2hkY3Bfc2hh
cmVkX21lbW9yeSkpOworCisJbXNnX2luID0gJmhkY3BfY21kLT5pbl9tc2cuaGRjcDJfcHJlcGFy
ZV9wcm9jZXNzX2F1dGhlbnRpY2F0aW9uX21lc3NhZ2VfdjI7CisJbXNnX291dCA9ICZoZGNwX2Nt
ZC0+b3V0X21zZy5oZGNwMl9wcmVwYXJlX3Byb2Nlc3NfYXV0aGVudGljYXRpb25fbWVzc2FnZV92
MjsKKworCWhkY3AyX21lc3NhZ2VfaW5pdChoZGNwLCBtc2dfaW4pOworCisJbXNnX2luLT5wcm9j
ZXNzLm1zZzFfZGVzYy5tc2dfaWQgPSBUQV9IRENQX0hEQ1AyX01TR19JRF9fQUtFX1NFTkRfQ0VS
VDsKKwltc2dfaW4tPnByb2Nlc3MubXNnMV9kZXNjLm1zZ19zaXplID0gVEFfSERDUF9IRENQMl9N
U0dfSURfTUFYX1NJWkVfX0FLRV9TRU5EX0NFUlQ7CisKKwltZW1jcHkoJm1zZ19pbi0+cHJvY2Vz
cy5yZWNlaXZlcl9tZXNzYWdlWzBdLCBoZGNwLT5hdXRoLm1zZy5oZGNwMi5ha2VfY2VydCwKKwkg
ICAgICAgc2l6ZW9mKGhkY3AtPmF1dGgubXNnLmhkY3AyLmFrZV9jZXJ0KSk7CisKKwltc2dfaW4t
PnByZXBhcmUubXNnMV9pZCA9IFRBX0hEQ1BfSERDUDJfTVNHX0lEX19BS0VfTk9fU1RPUkVEX0tN
OworCW1zZ19pbi0+cHJlcGFyZS5tc2cyX2lkID0gVEFfSERDUF9IRENQMl9NU0dfSURfX0FLRV9T
VE9SRURfS007CisKKwloZGNwX2NtZC0+Y21kX2lkID0gVEFfSERDUF9DT01NQU5EX19IRENQMl9Q
UkVQQVJFX1BST0NFU1NfQVVUSEVOVElDQVRJT05fTVNHX1YyOworCisJcHNwX2hkY3BfaW52b2tl
KHBzcCwgaGRjcF9jbWQtPmNtZF9pZCk7CisKKwlpZiAoaGRjcF9jbWQtPmhkY3Bfc3RhdHVzICE9
IFRBX0hEQ1BfU1RBVFVTX19TVUNDRVNTKQorCQlyZXR1cm4gTU9EX0hEQ1BfU1RBVFVTX0hEQ1Ay
X1ZBTElEQVRFX0FLRV9DRVJUX0ZBSUxVUkU7CisKKwltZW1jcHkoaGRjcC0+YXV0aC5tc2cuaGRj
cDIuYWtlX25vX3N0b3JlZF9rbSwgJm1zZ19vdXQtPnByZXBhcmUudHJhbnNtaXR0ZXJfbWVzc2Fn
ZVswXSwKKwkgICAgICAgc2l6ZW9mKGhkY3AtPmF1dGgubXNnLmhkY3AyLmFrZV9ub19zdG9yZWRf
a20pKTsKKworCW1lbWNweShoZGNwLT5hdXRoLm1zZy5oZGNwMi5ha2Vfc3RvcmVkX2ttLAorCSAg
ICAgICAmbXNnX291dC0+cHJlcGFyZS50cmFuc21pdHRlcl9tZXNzYWdlW3NpemVvZihoZGNwLT5h
dXRoLm1zZy5oZGNwMi5ha2Vfbm9fc3RvcmVkX2ttKV0sCisJICAgICAgIHNpemVvZihoZGNwLT5h
dXRoLm1zZy5oZGNwMi5ha2Vfc3RvcmVkX2ttKSk7CisKKwlpZiAobXNnX291dC0+cHJvY2Vzcy5t
c2cxX3N0YXR1cyA9PSBUQV9IRENQMl9NU0dfQVVUSEVOVElDQVRJT05fU1RBVFVTX19TVUNDRVNT
KSB7CisJCWhkY3AtPmNvbm5lY3Rpb24uaXNfa21fc3RvcmVkID0gbXNnX291dC0+cHJvY2Vzcy5p
c19rbV9zdG9yZWQgPyAxIDogMDsKKwkJaGRjcC0+Y29ubmVjdGlvbi5pc19yZXBlYXRlciA9IG1z
Z19vdXQtPnByb2Nlc3MuaXNfcmVwZWF0ZXIgPyAxIDogMDsKKwkJcmV0dXJuIE1PRF9IRENQX1NU
QVRVU19TVUNDRVNTOworCX0KKworCXJldHVybiBNT0RfSERDUF9TVEFUVVNfRkFJTFVSRTsKK30K
KworZW51bSBtb2RfaGRjcF9zdGF0dXMgbW9kX2hkY3BfaGRjcDJfdmFsaWRhdGVfaF9wcmltZShz
dHJ1Y3QgbW9kX2hkY3AgKmhkY3ApCit7CisJc3RydWN0IHBzcF9jb250ZXh0ICpwc3AgPSBoZGNw
LT5jb25maWcucHNwLmhhbmRsZTsKKwlzdHJ1Y3QgdGFfaGRjcF9zaGFyZWRfbWVtb3J5ICpoZGNw
X2NtZDsKKwlzdHJ1Y3QgdGFfaGRjcF9jbWRfaGRjcDJfcHJvY2Vzc19wcmVwYXJlX2F1dGhlbnRp
Y2F0aW9uX21lc3NhZ2VfaW5wdXRfdjIgKm1zZ19pbjsKKwlzdHJ1Y3QgdGFfaGRjcF9jbWRfaGRj
cDJfcHJvY2Vzc19wcmVwYXJlX2F1dGhlbnRpY2F0aW9uX21lc3NhZ2Vfb3V0cHV0X3YyICptc2df
b3V0OworCisJaGRjcF9jbWQgPSAoc3RydWN0IHRhX2hkY3Bfc2hhcmVkX21lbW9yeSAqKXBzcC0+
aGRjcF9jb250ZXh0LmhkY3Bfc2hhcmVkX2J1ZjsKKwltZW1zZXQoaGRjcF9jbWQsIDAsIHNpemVv
ZihzdHJ1Y3QgdGFfaGRjcF9zaGFyZWRfbWVtb3J5KSk7CisKKwltc2dfaW4gPSAmaGRjcF9jbWQt
PmluX21zZy5oZGNwMl9wcmVwYXJlX3Byb2Nlc3NfYXV0aGVudGljYXRpb25fbWVzc2FnZV92MjsK
Kwltc2dfb3V0ID0gJmhkY3BfY21kLT5vdXRfbXNnLmhkY3AyX3ByZXBhcmVfcHJvY2Vzc19hdXRo
ZW50aWNhdGlvbl9tZXNzYWdlX3YyOworCisJaGRjcDJfbWVzc2FnZV9pbml0KGhkY3AsIG1zZ19p
bik7CisKKwltc2dfaW4tPnByb2Nlc3MubXNnMV9kZXNjLm1zZ19pZCA9IFRBX0hEQ1BfSERDUDJf
TVNHX0lEX19BS0VfU0VORF9IX1BSSU1FOworCW1zZ19pbi0+cHJvY2Vzcy5tc2cxX2Rlc2MubXNn
X3NpemUgPSBUQV9IRENQX0hEQ1AyX01TR19JRF9NQVhfU0laRV9fQUtFX1NFTkRfSF9QUklNRTsK
KworCW1lbWNweSgmbXNnX2luLT5wcm9jZXNzLnJlY2VpdmVyX21lc3NhZ2VbMF0sIGhkY3AtPmF1
dGgubXNnLmhkY3AyLmFrZV9oX3ByaW1lLAorCSAgICAgICBzaXplb2YoaGRjcC0+YXV0aC5tc2cu
aGRjcDIuYWtlX2hfcHJpbWUpKTsKKworCWlmICghaGRjcC0+Y29ubmVjdGlvbi5pc19rbV9zdG9y
ZWQpIHsKKwkJbXNnX2luLT5wcm9jZXNzLm1zZzJfZGVzYy5tc2dfaWQgPSBUQV9IRENQX0hEQ1Ay
X01TR19JRF9fQUtFX1NFTkRfUEFJUklOR19JTkZPOworCQltc2dfaW4tPnByb2Nlc3MubXNnMl9k
ZXNjLm1zZ19zaXplID0gVEFfSERDUF9IRENQMl9NU0dfSURfTUFYX1NJWkVfX0FLRV9TRU5EX1BB
SVJJTkdfSU5GTzsKKwkJbWVtY3B5KCZtc2dfaW4tPnByb2Nlc3MucmVjZWl2ZXJfbWVzc2FnZVtz
aXplb2YoaGRjcC0+YXV0aC5tc2cuaGRjcDIuYWtlX2hfcHJpbWUpXSwKKwkJICAgICAgIGhkY3At
PmF1dGgubXNnLmhkY3AyLmFrZV9wYWlyaW5nX2luZm8sIHNpemVvZihoZGNwLT5hdXRoLm1zZy5o
ZGNwMi5ha2VfcGFpcmluZ19pbmZvKSk7CisJfQorCisJaGRjcF9jbWQtPmNtZF9pZCA9IFRBX0hE
Q1BfQ09NTUFORF9fSERDUDJfUFJFUEFSRV9QUk9DRVNTX0FVVEhFTlRJQ0FUSU9OX01TR19WMjsK
KworCXBzcF9oZGNwX2ludm9rZShwc3AsIGhkY3BfY21kLT5jbWRfaWQpOworCisJaWYgKGhkY3Bf
Y21kLT5oZGNwX3N0YXR1cyAhPSBUQV9IRENQX1NUQVRVU19fU1VDQ0VTUykKKwkJcmV0dXJuIE1P
RF9IRENQX1NUQVRVU19IRENQMl9WQUxJREFURV9BS0VfQ0VSVF9GQUlMVVJFOworCisJaWYgKG1z
Z19vdXQtPnByb2Nlc3MubXNnMV9zdGF0dXMgIT0gVEFfSERDUDJfTVNHX0FVVEhFTlRJQ0FUSU9O
X1NUQVRVU19fU1VDQ0VTUykKKwkJcmV0dXJuIE1PRF9IRENQX1NUQVRVU19IRENQMl9WQUxJREFU
RV9IX1BSSU1FX0ZBSUxVUkU7CisJZWxzZSBpZiAoIWhkY3AtPmNvbm5lY3Rpb24uaXNfa21fc3Rv
cmVkICYmCisJCSBtc2dfb3V0LT5wcm9jZXNzLm1zZzJfc3RhdHVzICE9IFRBX0hEQ1AyX01TR19B
VVRIRU5USUNBVElPTl9TVEFUVVNfX1NVQ0NFU1MpCisJCXJldHVybiBNT0RfSERDUF9TVEFUVVNf
SERDUDJfVkFMSURBVEVfUEFJUklOR19JTkZPX0ZBSUxVUkU7CisKKworCXJldHVybiBNT0RfSERD
UF9TVEFUVVNfU1VDQ0VTUzsKK30KKworZW51bSBtb2RfaGRjcF9zdGF0dXMgbW9kX2hkY3BfaGRj
cDJfcHJlcGFyZV9sY19pbml0KHN0cnVjdCBtb2RfaGRjcCAqaGRjcCkKK3sKKwlzdHJ1Y3QgcHNw
X2NvbnRleHQgKnBzcCA9IGhkY3AtPmNvbmZpZy5wc3AuaGFuZGxlOworCXN0cnVjdCB0YV9oZGNw
X3NoYXJlZF9tZW1vcnkgKmhkY3BfY21kOworCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9wcm9j
ZXNzX3ByZXBhcmVfYXV0aGVudGljYXRpb25fbWVzc2FnZV9pbnB1dF92MiAqbXNnX2luOworCXN0
cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9wcm9jZXNzX3ByZXBhcmVfYXV0aGVudGljYXRpb25fbWVz
c2FnZV9vdXRwdXRfdjIgKm1zZ19vdXQ7CisKKwloZGNwX2NtZCA9IChzdHJ1Y3QgdGFfaGRjcF9z
aGFyZWRfbWVtb3J5ICopcHNwLT5oZGNwX2NvbnRleHQuaGRjcF9zaGFyZWRfYnVmOworCW1lbXNl
dChoZGNwX2NtZCwgMCwgc2l6ZW9mKHN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1vcnkpKTsKKwor
CW1zZ19pbiA9ICZoZGNwX2NtZC0+aW5fbXNnLmhkY3AyX3ByZXBhcmVfcHJvY2Vzc19hdXRoZW50
aWNhdGlvbl9tZXNzYWdlX3YyOworCW1zZ19vdXQgPSAmaGRjcF9jbWQtPm91dF9tc2cuaGRjcDJf
cHJlcGFyZV9wcm9jZXNzX2F1dGhlbnRpY2F0aW9uX21lc3NhZ2VfdjI7CisKKwloZGNwMl9tZXNz
YWdlX2luaXQoaGRjcCwgbXNnX2luKTsKKworCW1zZ19pbi0+cHJlcGFyZS5tc2cxX2lkID0gVEFf
SERDUF9IRENQMl9NU0dfSURfX0xDX0lOSVQ7CisKKwloZGNwX2NtZC0+Y21kX2lkID0gVEFfSERD
UF9DT01NQU5EX19IRENQMl9QUkVQQVJFX1BST0NFU1NfQVVUSEVOVElDQVRJT05fTVNHX1YyOwor
CisJcHNwX2hkY3BfaW52b2tlKHBzcCwgaGRjcF9jbWQtPmNtZF9pZCk7CisKKwlpZiAoaGRjcF9j
bWQtPmhkY3Bfc3RhdHVzICE9IFRBX0hEQ1BfU1RBVFVTX19TVUNDRVNTKQorCQlyZXR1cm4gTU9E
X0hEQ1BfU1RBVFVTX0hEQ1AyX1BSRVBfTENfSU5JVF9GQUlMVVJFOworCisJbWVtY3B5KGhkY3At
PmF1dGgubXNnLmhkY3AyLmxjX2luaXQsICZtc2dfb3V0LT5wcmVwYXJlLnRyYW5zbWl0dGVyX21l
c3NhZ2VbMF0sCisJICAgICAgIHNpemVvZihoZGNwLT5hdXRoLm1zZy5oZGNwMi5sY19pbml0KSk7
CisKKwlyZXR1cm4gTU9EX0hEQ1BfU1RBVFVTX1NVQ0NFU1M7Cit9CisKK2VudW0gbW9kX2hkY3Bf
c3RhdHVzIG1vZF9oZGNwX2hkY3AyX3ZhbGlkYXRlX2xfcHJpbWUoc3RydWN0IG1vZF9oZGNwICpo
ZGNwKQoreworCXN0cnVjdCBwc3BfY29udGV4dCAqcHNwID0gaGRjcC0+Y29uZmlnLnBzcC5oYW5k
bGU7CisJc3RydWN0IHRhX2hkY3Bfc2hhcmVkX21lbW9yeSAqaGRjcF9jbWQ7CisJc3RydWN0IHRh
X2hkY3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFyZV9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX2lu
cHV0X3YyICptc2dfaW47CisJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFy
ZV9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX291dHB1dF92MiAqbXNnX291dDsKKworCWhkY3BfY21k
ID0gKHN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1vcnkgKilwc3AtPmhkY3BfY29udGV4dC5oZGNw
X3NoYXJlZF9idWY7CisJbWVtc2V0KGhkY3BfY21kLCAwLCBzaXplb2Yoc3RydWN0IHRhX2hkY3Bf
c2hhcmVkX21lbW9yeSkpOworCisJbXNnX2luID0gJmhkY3BfY21kLT5pbl9tc2cuaGRjcDJfcHJl
cGFyZV9wcm9jZXNzX2F1dGhlbnRpY2F0aW9uX21lc3NhZ2VfdjI7CisJbXNnX291dCA9ICZoZGNw
X2NtZC0+b3V0X21zZy5oZGNwMl9wcmVwYXJlX3Byb2Nlc3NfYXV0aGVudGljYXRpb25fbWVzc2Fn
ZV92MjsKKworCWhkY3AyX21lc3NhZ2VfaW5pdChoZGNwLCBtc2dfaW4pOworCisJbXNnX2luLT5w
cm9jZXNzLm1zZzFfZGVzYy5tc2dfaWQgPSBUQV9IRENQX0hEQ1AyX01TR19JRF9fTENfU0VORF9M
X1BSSU1FOworCW1zZ19pbi0+cHJvY2Vzcy5tc2cxX2Rlc2MubXNnX3NpemUgPSBUQV9IRENQX0hE
Q1AyX01TR19JRF9NQVhfU0laRV9fTENfU0VORF9MX1BSSU1FOworCisJbWVtY3B5KCZtc2dfaW4t
PnByb2Nlc3MucmVjZWl2ZXJfbWVzc2FnZVswXSwgaGRjcC0+YXV0aC5tc2cuaGRjcDIubGNfbF9w
cmltZSwKKwkgICAgICAgc2l6ZW9mKGhkY3AtPmF1dGgubXNnLmhkY3AyLmxjX2xfcHJpbWUpKTsK
KworCWhkY3BfY21kLT5jbWRfaWQgPSBUQV9IRENQX0NPTU1BTkRfX0hEQ1AyX1BSRVBBUkVfUFJP
Q0VTU19BVVRIRU5USUNBVElPTl9NU0dfVjI7CisKKwlwc3BfaGRjcF9pbnZva2UocHNwLCBoZGNw
X2NtZC0+Y21kX2lkKTsKKworCWlmIChoZGNwX2NtZC0+aGRjcF9zdGF0dXMgIT0gVEFfSERDUF9T
VEFUVVNfX1NVQ0NFU1MpCisJCXJldHVybiBNT0RfSERDUF9TVEFUVVNfSERDUDJfVkFMSURBVEVf
TF9QUklNRV9GQUlMVVJFOworCisJaWYgKG1zZ19vdXQtPnByb2Nlc3MubXNnMV9zdGF0dXMgIT0g
VEFfSERDUDJfTVNHX0FVVEhFTlRJQ0FUSU9OX1NUQVRVU19fU1VDQ0VTUykKKwkJcmV0dXJuIE1P
RF9IRENQX1NUQVRVU19IRENQMl9WQUxJREFURV9MX1BSSU1FX0ZBSUxVUkU7CisKKwlyZXR1cm4g
TU9EX0hEQ1BfU1RBVFVTX1NVQ0NFU1M7Cit9CisKK2VudW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9o
ZGNwX2hkY3AyX3ByZXBhcmVfZWtzKHN0cnVjdCBtb2RfaGRjcCAqaGRjcCkKK3sKKwlzdHJ1Y3Qg
cHNwX2NvbnRleHQgKnBzcCA9IGhkY3AtPmNvbmZpZy5wc3AuaGFuZGxlOworCXN0cnVjdCB0YV9o
ZGNwX3NoYXJlZF9tZW1vcnkgKmhkY3BfY21kOworCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9w
cm9jZXNzX3ByZXBhcmVfYXV0aGVudGljYXRpb25fbWVzc2FnZV9pbnB1dF92MiAqbXNnX2luOwor
CXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9wcm9jZXNzX3ByZXBhcmVfYXV0aGVudGljYXRpb25f
bWVzc2FnZV9vdXRwdXRfdjIgKm1zZ19vdXQ7CisKKwloZGNwX2NtZCA9IChzdHJ1Y3QgdGFfaGRj
cF9zaGFyZWRfbWVtb3J5ICopcHNwLT5oZGNwX2NvbnRleHQuaGRjcF9zaGFyZWRfYnVmOworCW1l
bXNldChoZGNwX2NtZCwgMCwgc2l6ZW9mKHN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1vcnkpKTsK
KworCW1zZ19pbiA9ICZoZGNwX2NtZC0+aW5fbXNnLmhkY3AyX3ByZXBhcmVfcHJvY2Vzc19hdXRo
ZW50aWNhdGlvbl9tZXNzYWdlX3YyOworCW1zZ19vdXQgPSAmaGRjcF9jbWQtPm91dF9tc2cuaGRj
cDJfcHJlcGFyZV9wcm9jZXNzX2F1dGhlbnRpY2F0aW9uX21lc3NhZ2VfdjI7CisKKwloZGNwMl9t
ZXNzYWdlX2luaXQoaGRjcCwgbXNnX2luKTsKKworCW1zZ19pbi0+cHJlcGFyZS5tc2cxX2lkID0g
VEFfSERDUF9IRENQMl9NU0dfSURfX1NLRV9TRU5EX0VLUzsKKworCWlmIChpc19kcF9oZGNwKGhk
Y3ApKQorCQltc2dfaW4tPnByZXBhcmUubXNnMl9pZCA9IFRBX0hEQ1BfSERDUDJfTVNHX0lEX19T
SUdOQUxfQ09OVEVOVF9TVFJFQU1fVFlQRV9EUDsKKworCWhkY3BfY21kLT5jbWRfaWQgPSBUQV9I
RENQX0NPTU1BTkRfX0hEQ1AyX1BSRVBBUkVfUFJPQ0VTU19BVVRIRU5USUNBVElPTl9NU0dfVjI7
CisJcHNwX2hkY3BfaW52b2tlKHBzcCwgaGRjcF9jbWQtPmNtZF9pZCk7CisKKwlpZiAoaGRjcF9j
bWQtPmhkY3Bfc3RhdHVzICE9IFRBX0hEQ1BfU1RBVFVTX19TVUNDRVNTKQorCQlyZXR1cm4gTU9E
X0hEQ1BfU1RBVFVTX0hEQ1AyX1BSRVBfRUtTX0ZBSUxVUkU7CisKKwltZW1jcHkoaGRjcC0+YXV0
aC5tc2cuaGRjcDIuc2tlX2VrcywgJm1zZ19vdXQtPnByZXBhcmUudHJhbnNtaXR0ZXJfbWVzc2Fn
ZVswXSwKKwkgICAgICAgc2l6ZW9mKGhkY3AtPmF1dGgubXNnLmhkY3AyLnNrZV9la3MpKTsKKwlt
c2dfb3V0LT5wcmVwYXJlLm1zZzFfZGVzYy5tc2dfc2l6ZSA9IHNpemVvZihoZGNwLT5hdXRoLm1z
Zy5oZGNwMi5za2VfZWtzKTsKKworCWlmIChpc19kcF9oZGNwKGhkY3ApKSB7CisJCW1lbWNweSho
ZGNwLT5hdXRoLm1zZy5oZGNwMi5jb250ZW50X3N0cmVhbV90eXBlX2RwLAorCQkgICAgICAgJm1z
Z19vdXQtPnByZXBhcmUudHJhbnNtaXR0ZXJfbWVzc2FnZVtzaXplb2YoaGRjcC0+YXV0aC5tc2cu
aGRjcDIuc2tlX2VrcyldLAorCQkgICAgICAgc2l6ZW9mKGhkY3AtPmF1dGgubXNnLmhkY3AyLmNv
bnRlbnRfc3RyZWFtX3R5cGVfZHApKTsKKwl9CisKKwlyZXR1cm4gTU9EX0hEQ1BfU1RBVFVTX1NV
Q0NFU1M7Cit9CisKK2VudW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9oZGNwX2hkY3AyX2VuYWJsZV9l
bmNyeXB0aW9uKHN0cnVjdCBtb2RfaGRjcCAqaGRjcCkKK3sKKwlzdHJ1Y3QgcHNwX2NvbnRleHQg
KnBzcCA9IGhkY3AtPmNvbmZpZy5wc3AuaGFuZGxlOworCXN0cnVjdCB0YV9oZGNwX3NoYXJlZF9t
ZW1vcnkgKmhkY3BfY21kOworCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9wcm9jZXNzX3ByZXBh
cmVfYXV0aGVudGljYXRpb25fbWVzc2FnZV9pbnB1dF92MiAqbXNnX2luOworCXN0cnVjdCB0YV9o
ZGNwX2NtZF9oZGNwMl9wcm9jZXNzX3ByZXBhcmVfYXV0aGVudGljYXRpb25fbWVzc2FnZV9vdXRw
dXRfdjIgKm1zZ19vdXQ7CisJc3RydWN0IG1vZF9oZGNwX2Rpc3BsYXkgKmRpc3BsYXkgPSBnZXRf
Zmlyc3RfYWRkZWRfZGlzcGxheShoZGNwKTsKKworCWhkY3BfY21kID0gKHN0cnVjdCB0YV9oZGNw
X3NoYXJlZF9tZW1vcnkgKilwc3AtPmhkY3BfY29udGV4dC5oZGNwX3NoYXJlZF9idWY7CisJbWVt
c2V0KGhkY3BfY21kLCAwLCBzaXplb2Yoc3RydWN0IHRhX2hkY3Bfc2hhcmVkX21lbW9yeSkpOwor
CisJbXNnX2luID0gJmhkY3BfY21kLT5pbl9tc2cuaGRjcDJfcHJlcGFyZV9wcm9jZXNzX2F1dGhl
bnRpY2F0aW9uX21lc3NhZ2VfdjI7CisJbXNnX291dCA9ICZoZGNwX2NtZC0+b3V0X21zZy5oZGNw
Ml9wcmVwYXJlX3Byb2Nlc3NfYXV0aGVudGljYXRpb25fbWVzc2FnZV92MjsKKworCWhkY3AyX21l
c3NhZ2VfaW5pdChoZGNwLCBtc2dfaW4pOworCisJaWYgKCFkaXNwbGF5KQorCQlyZXR1cm4gTU9E
X0hEQ1BfU1RBVFVTX0RJU1BMQVlfTk9UX0ZPVU5EOworCisJaGRjcF9jbWQtPmluX21zZy5oZGNw
MV9lbmFibGVfZW5jcnlwdGlvbi5zZXNzaW9uX2hhbmRsZSA9IGhkY3AtPmF1dGguaWQ7CisKKwlo
ZGNwX2NtZC0+Y21kX2lkID0gVEFfSERDUF9DT01NQU5EX19IRENQMl9TRVRfRU5DUllQVElPTjsK
Kwlwc3BfaGRjcF9pbnZva2UocHNwLCBoZGNwX2NtZC0+Y21kX2lkKTsKKworCWlmIChoZGNwX2Nt
ZC0+aGRjcF9zdGF0dXMgIT0gVEFfSERDUF9TVEFUVVNfX1NVQ0NFU1MpCisJCXJldHVybiBNT0Rf
SERDUF9TVEFUVVNfSERDUDJfRU5BQkxFX0VOQ1JZUFRJT05fRkFJTFVSRTsKKworCWlmICghaXNf
ZHBfbXN0X2hkY3AoaGRjcCkpIHsKKwkJZGlzcGxheS0+c3RhdGUgPSBNT0RfSERDUF9ESVNQTEFZ
X0VOQ1JZUFRJT05fRU5BQkxFRDsKKwl9CisKKwlyZXR1cm4gTU9EX0hEQ1BfU1RBVFVTX1NVQ0NF
U1M7Cit9CisKK2VudW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9oZGNwX2hkY3AyX3ZhbGlkYXRlX3J4
X2lkX2xpc3Qoc3RydWN0IG1vZF9oZGNwICpoZGNwKQoreworCXN0cnVjdCBwc3BfY29udGV4dCAq
cHNwID0gaGRjcC0+Y29uZmlnLnBzcC5oYW5kbGU7CisJc3RydWN0IHRhX2hkY3Bfc2hhcmVkX21l
bW9yeSAqaGRjcF9jbWQ7CisJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFy
ZV9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX2lucHV0X3YyICptc2dfaW47CisJc3RydWN0IHRhX2hk
Y3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFyZV9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX291dHB1
dF92MiAqbXNnX291dDsKKworCWhkY3BfY21kID0gKHN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1v
cnkgKilwc3AtPmhkY3BfY29udGV4dC5oZGNwX3NoYXJlZF9idWY7CisJbWVtc2V0KGhkY3BfY21k
LCAwLCBzaXplb2Yoc3RydWN0IHRhX2hkY3Bfc2hhcmVkX21lbW9yeSkpOworCisJbXNnX2luID0g
JmhkY3BfY21kLT5pbl9tc2cuaGRjcDJfcHJlcGFyZV9wcm9jZXNzX2F1dGhlbnRpY2F0aW9uX21l
c3NhZ2VfdjI7CisJbXNnX291dCA9ICZoZGNwX2NtZC0+b3V0X21zZy5oZGNwMl9wcmVwYXJlX3By
b2Nlc3NfYXV0aGVudGljYXRpb25fbWVzc2FnZV92MjsKKworCWhkY3AyX21lc3NhZ2VfaW5pdCho
ZGNwLCBtc2dfaW4pOworCisJbXNnX2luLT5wcm9jZXNzLm1zZzFfZGVzYy5tc2dfaWQgPSBUQV9I
RENQX0hEQ1AyX01TR19JRF9fUkVQRUFURVJBVVRIX1NFTkRfUkVDRUlWRVJJRF9MSVNUOworCW1z
Z19pbi0+cHJvY2Vzcy5tc2cxX2Rlc2MubXNnX3NpemUgPSBzaXplb2YoaGRjcC0+YXV0aC5tc2cu
aGRjcDIucnhfaWRfbGlzdCk7CisJbWVtY3B5KCZtc2dfaW4tPnByb2Nlc3MucmVjZWl2ZXJfbWVz
c2FnZVswXSwgaGRjcC0+YXV0aC5tc2cuaGRjcDIucnhfaWRfbGlzdCwKKwkgICAgICAgc2l6ZW9m
KGhkY3AtPmF1dGgubXNnLmhkY3AyLnJ4X2lkX2xpc3QpKTsKKworCW1zZ19pbi0+cHJlcGFyZS5t
c2cxX2lkID0gVEFfSERDUF9IRENQMl9NU0dfSURfX1JFUEVBVEVSQVVUSF9TRU5EX0FDSzsKKwor
CWhkY3BfY21kLT5jbWRfaWQgPSBUQV9IRENQX0NPTU1BTkRfX0hEQ1AyX1BSRVBBUkVfUFJPQ0VT
U19BVVRIRU5USUNBVElPTl9NU0dfVjI7CisKKwlwc3BfaGRjcF9pbnZva2UocHNwLCBoZGNwX2Nt
ZC0+Y21kX2lkKTsKKworCWlmIChoZGNwX2NtZC0+aGRjcF9zdGF0dXMgIT0gVEFfSERDUF9TVEFU
VVNfX1NVQ0NFU1MpCisJCXJldHVybiBNT0RfSERDUF9TVEFUVVNfSERDUDJfVkFMSURBVEVfUlhf
SURfTElTVF9GQUlMVVJFOworCisJbWVtY3B5KGhkY3AtPmF1dGgubXNnLmhkY3AyLnJlcGVhdGVy
X2F1dGhfYWNrLCAmbXNnX291dC0+cHJlcGFyZS50cmFuc21pdHRlcl9tZXNzYWdlWzBdLAorCSAg
ICAgICBzaXplb2YoaGRjcC0+YXV0aC5tc2cuaGRjcDIucmVwZWF0ZXJfYXV0aF9hY2spKTsKKwor
CWlmIChtc2dfb3V0LT5wcm9jZXNzLm1zZzFfc3RhdHVzID09IFRBX0hEQ1AyX01TR19BVVRIRU5U
SUNBVElPTl9TVEFUVVNfX1NVQ0NFU1MpIHsKKwkJaGRjcC0+Y29ubmVjdGlvbi5pc19rbV9zdG9y
ZWQgPSBtc2dfb3V0LT5wcm9jZXNzLmlzX2ttX3N0b3JlZCA/IDEgOiAwOworCQloZGNwLT5jb25u
ZWN0aW9uLmlzX3JlcGVhdGVyID0gbXNnX291dC0+cHJvY2Vzcy5pc19yZXBlYXRlciA/IDEgOiAw
OworCQlyZXR1cm4gTU9EX0hEQ1BfU1RBVFVTX1NVQ0NFU1M7CisJfQorCisKKwlyZXR1cm4gTU9E
X0hEQ1BfU1RBVFVTX0hEQ1AyX1ZBTElEQVRFX1JYX0lEX0xJU1RfRkFJTFVSRTsKK30KKworZW51
bSBtb2RfaGRjcF9zdGF0dXMgbW9kX2hkY3BfaGRjcDJfZW5hYmxlX2RwX3N0cmVhbV9lbmNyeXB0
aW9uKHN0cnVjdCBtb2RfaGRjcCAqaGRjcCkKK3sKKwlzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCA9
IGhkY3AtPmNvbmZpZy5wc3AuaGFuZGxlOworCXN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1vcnkg
KmhkY3BfY21kOworCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9wcm9jZXNzX3ByZXBhcmVfYXV0
aGVudGljYXRpb25fbWVzc2FnZV9pbnB1dF92MiAqbXNnX2luOworCXN0cnVjdCB0YV9oZGNwX2Nt
ZF9oZGNwMl9wcm9jZXNzX3ByZXBhcmVfYXV0aGVudGljYXRpb25fbWVzc2FnZV9vdXRwdXRfdjIg
Km1zZ19vdXQ7CisJdWludDhfdCBpOworCisJaGRjcF9jbWQgPSAoc3RydWN0IHRhX2hkY3Bfc2hh
cmVkX21lbW9yeSAqKXBzcC0+aGRjcF9jb250ZXh0LmhkY3Bfc2hhcmVkX2J1ZjsKKwltZW1zZXQo
aGRjcF9jbWQsIDAsIHNpemVvZihzdHJ1Y3QgdGFfaGRjcF9zaGFyZWRfbWVtb3J5KSk7CisKKwlt
c2dfaW4gPSAmaGRjcF9jbWQtPmluX21zZy5oZGNwMl9wcmVwYXJlX3Byb2Nlc3NfYXV0aGVudGlj
YXRpb25fbWVzc2FnZV92MjsKKwltc2dfb3V0ID0gJmhkY3BfY21kLT5vdXRfbXNnLmhkY3AyX3By
ZXBhcmVfcHJvY2Vzc19hdXRoZW50aWNhdGlvbl9tZXNzYWdlX3YyOworCisJaGRjcDJfbWVzc2Fn
ZV9pbml0KGhkY3AsIG1zZ19pbik7CisKKworCWZvciAoaSA9IDA7IGkgPCBNQVhfTlVNX09GX0RJ
U1BMQVlTOyBpKyspIHsKKwkJaWYgKGhkY3AtPmNvbm5lY3Rpb24uZGlzcGxheXNbaV0uc3RhdGUg
IT0gTU9EX0hEQ1BfRElTUExBWV9BQ1RJVkVfQU5EX0FEREVEIHx8CisJCSAgICBoZGNwLT5jb25u
ZWN0aW9uLmRpc3BsYXlzW2ldLmFkanVzdC5kaXNhYmxlKQorCQkJY29udGludWU7CisJCWhkY3Bf
Y21kLT5pbl9tc2cuaGRjcDJfZW5hYmxlX2RwX3N0cmVhbV9lbmNyeXB0aW9uLmRpc3BsYXlfaGFu
ZGxlID0gaGRjcC0+Y29ubmVjdGlvbi5kaXNwbGF5c1tpXS5pbmRleDsKKwkJaGRjcF9jbWQtPmlu
X21zZy5oZGNwMl9lbmFibGVfZHBfc3RyZWFtX2VuY3J5cHRpb24uc2Vzc2lvbl9oYW5kbGUgPSBo
ZGNwLT5hdXRoLmlkOworCisJCWhkY3BfY21kLT5jbWRfaWQgPSBUQV9IRENQX0NPTU1BTkRfX0hE
Q1AyX0VOQUJMRV9EUF9TVFJFQU1fRU5DUllQVElPTjsKKwkJcHNwX2hkY3BfaW52b2tlKHBzcCwg
aGRjcF9jbWQtPmNtZF9pZCk7CisKKwkJaWYgKGhkY3BfY21kLT5oZGNwX3N0YXR1cyAhPSBUQV9I
RENQX1NUQVRVU19fU1VDQ0VTUykKKwkJCWJyZWFrOworCisJCWhkY3AtPmNvbm5lY3Rpb24uZGlz
cGxheXNbaV0uc3RhdGUgPSBNT0RfSERDUF9ESVNQTEFZX0VOQ1JZUFRJT05fRU5BQkxFRDsKKwl9
CisKKwlyZXR1cm4gKGhkY3BfY21kLT5oZGNwX3N0YXR1cyA9PSBUQV9IRENQX1NUQVRVU19fU1VD
Q0VTUykgPyBNT0RfSERDUF9TVEFUVVNfU1VDQ0VTUworCQkJCQkJCQkgIDogTU9EX0hEQ1BfU1RB
VFVTX0hEQ1AyX0VOQUJMRV9TVFJFQU1fRU5DUllQVElPTjsKK30KKworZW51bSBtb2RfaGRjcF9z
dGF0dXMgbW9kX2hkY3BfaGRjcDJfcHJlcGFyZV9zdHJlYW1fbWFuYWdlbWVudChzdHJ1Y3QgbW9k
X2hkY3AgKmhkY3ApCit7CisKKwlzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCA9IGhkY3AtPmNvbmZp
Zy5wc3AuaGFuZGxlOworCXN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1vcnkgKmhkY3BfY21kOwor
CXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9wcm9jZXNzX3ByZXBhcmVfYXV0aGVudGljYXRpb25f
bWVzc2FnZV9pbnB1dF92MiAqbXNnX2luOworCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9wcm9j
ZXNzX3ByZXBhcmVfYXV0aGVudGljYXRpb25fbWVzc2FnZV9vdXRwdXRfdjIgKm1zZ19vdXQ7CisK
KwloZGNwX2NtZCA9IChzdHJ1Y3QgdGFfaGRjcF9zaGFyZWRfbWVtb3J5ICopcHNwLT5oZGNwX2Nv
bnRleHQuaGRjcF9zaGFyZWRfYnVmOworCW1lbXNldChoZGNwX2NtZCwgMCwgc2l6ZW9mKHN0cnVj
dCB0YV9oZGNwX3NoYXJlZF9tZW1vcnkpKTsKKworCW1zZ19pbiA9ICZoZGNwX2NtZC0+aW5fbXNn
LmhkY3AyX3ByZXBhcmVfcHJvY2Vzc19hdXRoZW50aWNhdGlvbl9tZXNzYWdlX3YyOworCW1zZ19v
dXQgPSAmaGRjcF9jbWQtPm91dF9tc2cuaGRjcDJfcHJlcGFyZV9wcm9jZXNzX2F1dGhlbnRpY2F0
aW9uX21lc3NhZ2VfdjI7CisKKwloZGNwMl9tZXNzYWdlX2luaXQoaGRjcCwgbXNnX2luKTsKKwor
CW1zZ19pbi0+cHJlcGFyZS5tc2cxX2lkID0gVEFfSERDUF9IRENQMl9NU0dfSURfX1JFUEVBVEVS
QVVUSF9TVFJFQU1fTUFOQUdFOworCisKKwloZGNwX2NtZC0+Y21kX2lkID0gVEFfSERDUF9DT01N
QU5EX19IRENQMl9QUkVQQVJFX1BST0NFU1NfQVVUSEVOVElDQVRJT05fTVNHX1YyOworCXBzcF9o
ZGNwX2ludm9rZShwc3AsIGhkY3BfY21kLT5jbWRfaWQpOworCisJaWYgKGhkY3BfY21kLT5oZGNw
X3N0YXR1cyAhPSBUQV9IRENQX1NUQVRVU19fU1VDQ0VTUykKKwkJcmV0dXJuIE1PRF9IRENQX1NU
QVRVU19IRENQMl9QUkVQQVJFX1NUUkVBTV9NQU5BR0VNRU5UX0ZBSUxVUkU7CisKKwloZGNwLT5h
dXRoLm1zZy5oZGNwMi5zdHJlYW1fbWFuYWdlX3NpemUgPSBtc2dfb3V0LT5wcmVwYXJlLm1zZzFf
ZGVzYy5tc2dfc2l6ZTsKKworCW1lbWNweShoZGNwLT5hdXRoLm1zZy5oZGNwMi5yZXBlYXRlcl9h
dXRoX3N0cmVhbV9tYW5hZ2UsICZtc2dfb3V0LT5wcmVwYXJlLnRyYW5zbWl0dGVyX21lc3NhZ2Vb
MF0sCisJICAgICAgIHNpemVvZihoZGNwLT5hdXRoLm1zZy5oZGNwMi5yZXBlYXRlcl9hdXRoX3N0
cmVhbV9tYW5hZ2UpKTsKKworCXJldHVybiBNT0RfSERDUF9TVEFUVVNfU1VDQ0VTUzsKK30KKwor
ZW51bSBtb2RfaGRjcF9zdGF0dXMgbW9kX2hkY3BfaGRjcDJfdmFsaWRhdGVfc3RyZWFtX3JlYWR5
KHN0cnVjdCBtb2RfaGRjcCAqaGRjcCkKK3sKKwlzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCA9IGhk
Y3AtPmNvbmZpZy5wc3AuaGFuZGxlOworCXN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1vcnkgKmhk
Y3BfY21kOworCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9wcm9jZXNzX3ByZXBhcmVfYXV0aGVu
dGljYXRpb25fbWVzc2FnZV9pbnB1dF92MiAqbXNnX2luOworCXN0cnVjdCB0YV9oZGNwX2NtZF9o
ZGNwMl9wcm9jZXNzX3ByZXBhcmVfYXV0aGVudGljYXRpb25fbWVzc2FnZV9vdXRwdXRfdjIgKm1z
Z19vdXQ7CisKKwloZGNwX2NtZCA9IChzdHJ1Y3QgdGFfaGRjcF9zaGFyZWRfbWVtb3J5ICopcHNw
LT5oZGNwX2NvbnRleHQuaGRjcF9zaGFyZWRfYnVmOworCW1lbXNldChoZGNwX2NtZCwgMCwgc2l6
ZW9mKHN0cnVjdCB0YV9oZGNwX3NoYXJlZF9tZW1vcnkpKTsKKworCW1zZ19pbiA9ICZoZGNwX2Nt
ZC0+aW5fbXNnLmhkY3AyX3ByZXBhcmVfcHJvY2Vzc19hdXRoZW50aWNhdGlvbl9tZXNzYWdlX3Yy
OworCW1zZ19vdXQgPSAmaGRjcF9jbWQtPm91dF9tc2cuaGRjcDJfcHJlcGFyZV9wcm9jZXNzX2F1
dGhlbnRpY2F0aW9uX21lc3NhZ2VfdjI7CisKKwloZGNwMl9tZXNzYWdlX2luaXQoaGRjcCwgbXNn
X2luKTsKKworCW1zZ19pbi0+cHJvY2Vzcy5tc2cxX2Rlc2MubXNnX2lkID0gVEFfSERDUF9IRENQ
Ml9NU0dfSURfX1JFUEVBVEVSQVVUSF9TVFJFQU1fUkVBRFk7CisKKwltc2dfaW4tPnByb2Nlc3Mu
bXNnMV9kZXNjLm1zZ19zaXplID0gc2l6ZW9mKGhkY3AtPmF1dGgubXNnLmhkY3AyLnJlcGVhdGVy
X2F1dGhfc3RyZWFtX3JlYWR5KTsKKworCW1lbWNweSgmbXNnX2luLT5wcm9jZXNzLnJlY2VpdmVy
X21lc3NhZ2VbMF0sIGhkY3AtPmF1dGgubXNnLmhkY3AyLnJlcGVhdGVyX2F1dGhfc3RyZWFtX3Jl
YWR5LAorCSAgICAgICBzaXplb2YoaGRjcC0+YXV0aC5tc2cuaGRjcDIucmVwZWF0ZXJfYXV0aF9z
dHJlYW1fcmVhZHkpKTsKKworCWhkY3BfY21kLT5jbWRfaWQgPSBUQV9IRENQX0NPTU1BTkRfX0hE
Q1AyX1BSRVBBUkVfUFJPQ0VTU19BVVRIRU5USUNBVElPTl9NU0dfVjI7CisJcHNwX2hkY3BfaW52
b2tlKHBzcCwgaGRjcF9jbWQtPmNtZF9pZCk7CisKKwlyZXR1cm4gKGhkY3BfY21kLT5oZGNwX3N0
YXR1cyAhPSBUQV9IRENQX1NUQVRVU19fU1VDQ0VTUykgJiYKKwkJCSAgICAgICAobXNnX291dC0+
cHJvY2Vzcy5tc2cxX3N0YXR1cyA9PSBUQV9IRENQMl9NU0dfQVVUSEVOVElDQVRJT05fU1RBVFVT
X19TVUNDRVNTKQorCQkgICAgICAgPyBNT0RfSERDUF9TVEFUVVNfU1VDQ0VTUworCQkgICAgICAg
OiBNT0RfSERDUF9TVEFUVVNfSERDUDJfVkFMSURBVEVfU1RSRUFNX1JFQURZX0ZBSUxVUkU7Cit9
CisKK2VudW0gbW9kX2hkY3Bfc3RhdHVzIG1vZF9oZGNwX2hkY3AyX2dldF9saW5rX2VuY3J5cHRp
b25fc3RhdHVzKHN0cnVjdCBtb2RfaGRjcCAqaGRjcCwKKwkJCQkJCQkgICAgICAgZW51bSBtb2Rf
aGRjcF9lbmNyeXB0aW9uX3N0YXR1cyAqZW5jcnlwdGlvbl9zdGF0dXMpCit7CisJc3RydWN0IHBz
cF9jb250ZXh0ICpwc3AgPSBoZGNwLT5jb25maWcucHNwLmhhbmRsZTsKKwlzdHJ1Y3QgdGFfaGRj
cF9zaGFyZWRfbWVtb3J5ICpoZGNwX2NtZDsKKworCWhkY3BfY21kID0gKHN0cnVjdCB0YV9oZGNw
X3NoYXJlZF9tZW1vcnkgKilwc3AtPmhkY3BfY29udGV4dC5oZGNwX3NoYXJlZF9idWY7CisKKwlt
ZW1zZXQoaGRjcF9jbWQsIDAsIHNpemVvZihzdHJ1Y3QgdGFfaGRjcF9zaGFyZWRfbWVtb3J5KSk7
CisKKwloZGNwX2NtZC0+aW5fbXNnLmhkY3AyX2dldF9lbmNyeXB0aW9uX3N0YXR1cy5zZXNzaW9u
X2hhbmRsZSA9IGhkY3AtPmF1dGguaWQ7CisJaGRjcF9jbWQtPm91dF9tc2cuaGRjcDJfZ2V0X2Vu
Y3J5cHRpb25fc3RhdHVzLnByb3RlY3Rpb25fbGV2ZWwgPSAwOworCWhkY3BfY21kLT5jbWRfaWQg
PSBUQV9IRENQX0NPTU1BTkRfX0hEQ1AyX0dFVF9FTkNSWVBUSU9OX1NUQVRVUzsKKwkqZW5jcnlw
dGlvbl9zdGF0dXMgPSBNT0RfSERDUF9FTkNSWVBUSU9OX1NUQVRVU19IRENQX09GRjsKKworCXBz
cF9oZGNwX2ludm9rZShwc3AsIGhkY3BfY21kLT5jbWRfaWQpOworCisJaWYgKGhkY3BfY21kLT5o
ZGNwX3N0YXR1cyAhPSBUQV9IRENQX1NUQVRVU19fU1VDQ0VTUykKKwkJcmV0dXJuIE1PRF9IRENQ
X1NUQVRVU19GQUlMVVJFOworCisJaWYgKGhkY3BfY21kLT5vdXRfbXNnLmhkY3AyX2dldF9lbmNy
eXB0aW9uX3N0YXR1cy5wcm90ZWN0aW9uX2xldmVsID09IDEpIHsKKwkJaWYgKGhkY3BfY21kLT5v
dXRfbXNnLmhkY3AyX2dldF9lbmNyeXB0aW9uX3N0YXR1cy5oZGNwMl90eXBlID09IFRBX0hEQ1Ay
X0NPTlRFTlRfVFlQRV9fVFlQRTEpCisJCQkqZW5jcnlwdGlvbl9zdGF0dXMgPSBNT0RfSERDUF9F
TkNSWVBUSU9OX1NUQVRVU19IRENQMl9UWVBFMV9PTjsKKwkJZWxzZQorCQkJKmVuY3J5cHRpb25f
c3RhdHVzID0gTU9EX0hEQ1BfRU5DUllQVElPTl9TVEFUVVNfSERDUDJfVFlQRTBfT047CisJfQor
CisJcmV0dXJuIE1PRF9IRENQX1NUQVRVU19TVUNDRVNTOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9kaXNwbGF5L21vZHVsZXMvaGRjcC9oZGNwX3BzcC5oIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L21vZHVsZXMvaGRjcC9oZGNwX3BzcC5oCmluZGV4IDk4NmZjMDdl
YTllYS4uODJhNWU5OTdkNTczIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvbW9kdWxlcy9oZGNwL2hkY3BfcHNwLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNw
bGF5L21vZHVsZXMvaGRjcC9oZGNwX3BzcC5oCkBAIC0zNiw2ICszNiwxMSBAQCBlbnVtIGJnZF9z
ZWN1cml0eV9oZGNwX2VuY3J5cHRpb25fbGV2ZWwgewogCUhEQ1BfRU5DUllQVElPTl9MRVZFTF9f
T04KIH07CiAKK2VudW0gYmdkX3NlY3VyaXR5X2hkY3AyX2NvbnRlbnRfdHlwZSB7CisJSERDUDJf
Q09OVEVOVF9UWVBFX19JTlZBTElEID0gMCwKKwlIRENQMl9DT05URU5UX1RZUEVfX1RZUEUwLAor
CUhEQ1AyX0NPTlRFTlRfVFlQRV9fVFlQRTEKK307CiBlbnVtIHRhX2R0bV9jb21tYW5kIHsKIAlU
QV9EVE1fQ09NTUFORF9fVU5VU0VEXzEgPSAxLAogCVRBX0RUTV9DT01NQU5EX19UT1BPTE9HWV9V
UERBVEVfVjIsCkBAIC0xMjEsOCArMTI2LDY0IEBAIGVudW0gdGFfaGRjcF9jb21tYW5kIHsKIAlU
QV9IRENQX0NPTU1BTkRfX0hEQ1AxX0VOQUJMRV9FTkNSWVBUSU9OLAogCVRBX0hEQ1BfQ09NTUFO
RF9fSERDUDFfRU5BQkxFX0RQX1NUUkVBTV9FTkNSWVBUSU9OLAogCVRBX0hEQ1BfQ09NTUFORF9f
SERDUDFfR0VUX0VOQ1JZUFRJT05fU1RBVFVTLAorCVRBX0hEQ1BfQ09NTUFORF9fVU5VU0VEXzEs
CisJVEFfSERDUF9DT01NQU5EX19IRENQMl9ERVNUUk9ZX1NFU1NJT04sCisJVEFfSERDUF9DT01N
QU5EX19VTlVTRURfMiwKKwlUQV9IRENQX0NPTU1BTkRfX0hEQ1AyX1NFVF9FTkNSWVBUSU9OLAor
CVRBX0hEQ1BfQ09NTUFORF9fSERDUDJfR0VUX0VOQ1JZUFRJT05fU1RBVFVTLAorCVRBX0hEQ1Bf
Q09NTUFORF9fVU5VU0VEXzMsCisJVEFfSERDUF9DT01NQU5EX19IRENQMl9DUkVBVEVfU0VTU0lP
Tl9WMiwKKwlUQV9IRENQX0NPTU1BTkRfX0hEQ1AyX1BSRVBBUkVfUFJPQ0VTU19BVVRIRU5USUNB
VElPTl9NU0dfVjIsCisJVEFfSERDUF9DT01NQU5EX19IRENQMl9FTkFCTEVfRFBfU1RSRUFNX0VO
Q1JZUFRJT04KK307CisKK2VudW0gdGFfaGRjcDJfbXNnX2lkIHsKKwlUQV9IRENQX0hEQ1AyX01T
R19JRF9fTlVMTF9NRVNTQUdFID0gMSwKKwlUQV9IRENQX0hEQ1AyX01TR19JRF9fQUtFX0lOSVQg
PSAyLAorCVRBX0hEQ1BfSERDUDJfTVNHX0lEX19BS0VfU0VORF9DRVJUID0gMywKKwlUQV9IRENQ
X0hEQ1AyX01TR19JRF9fQUtFX05PX1NUT1JFRF9LTSA9IDQsCisJVEFfSERDUF9IRENQMl9NU0df
SURfX0FLRV9TVE9SRURfS00gPSA1LAorCVRBX0hEQ1BfSERDUDJfTVNHX0lEX19BS0VfU0VORF9S
UlggPSA2LAorCVRBX0hEQ1BfSERDUDJfTVNHX0lEX19BS0VfU0VORF9IX1BSSU1FID0gNywKKwlU
QV9IRENQX0hEQ1AyX01TR19JRF9fQUtFX1NFTkRfUEFJUklOR19JTkZPID0gOCwKKwlUQV9IRENQ
X0hEQ1AyX01TR19JRF9fTENfSU5JVCA9IDksCisJVEFfSERDUF9IRENQMl9NU0dfSURfX0xDX1NF
TkRfTF9QUklNRSA9IDEwLAorCVRBX0hEQ1BfSERDUDJfTVNHX0lEX19TS0VfU0VORF9FS1MgPSAx
MSwKKwlUQV9IRENQX0hEQ1AyX01TR19JRF9fUkVQRUFURVJBVVRIX1NFTkRfUkVDRUlWRVJJRF9M
SVNUID0gMTIsCisJVEFfSERDUF9IRENQMl9NU0dfSURfX1JUVF9SRUFEWSA9IDEzLAorCVRBX0hE
Q1BfSERDUDJfTVNHX0lEX19SVFRfQ0hBTExFTkdFID0gMTQsCisJVEFfSERDUF9IRENQMl9NU0df
SURfX1JFUEVBVEVSQVVUSF9TRU5EX0FDSyA9IDE1LAorCVRBX0hEQ1BfSERDUDJfTVNHX0lEX19S
RVBFQVRFUkFVVEhfU1RSRUFNX01BTkFHRSA9IDE2LAorCVRBX0hEQ1BfSERDUDJfTVNHX0lEX19S
RVBFQVRFUkFVVEhfU1RSRUFNX1JFQURZID0gMTcsCisJVEFfSERDUF9IRENQMl9NU0dfSURfX1JF
Q0VJVkVSX0FVVEhfU1RBVFVTID0gMTgsCisJVEFfSERDUF9IRENQMl9NU0dfSURfX0FLRV9UUkFO
U01JVFRFUl9JTkZPID0gMTksCisJVEFfSERDUF9IRENQMl9NU0dfSURfX0FLRV9SRUNFSVZFUl9J
TkZPID0gMjAsCisJVEFfSERDUF9IRENQMl9NU0dfSURfX1NJR05BTF9DT05URU5UX1NUUkVBTV9U
WVBFX0RQID0gMTI5CiB9OwogCitlbnVtIHRhX2hkY3AyX2hkY3AyX21zZ19pZF9tYXhfc2l6ZSB7
CisJVEFfSERDUF9IRENQMl9NU0dfSURfTUFYX1NJWkVfX05VTExfTUVTU0FHRSA9IDAsCisJVEFf
SERDUF9IRENQMl9NU0dfSURfTUFYX1NJWkVfX0FLRV9JTklUID0gMTIsCisJVEFfSERDUF9IRENQ
Ml9NU0dfSURfTUFYX1NJWkVfX0FLRV9TRU5EX0NFUlQgPSA1MzQsCisJVEFfSERDUF9IRENQMl9N
U0dfSURfTUFYX1NJWkVfX0FLRV9OT19TVE9SRURfS00gPSAxMjksCisJVEFfSERDUF9IRENQMl9N
U0dfSURfTUFYX1NJWkVfX0FLRV9TVE9SRURfS00gPSAzMywKKwlUQV9IRENQX0hEQ1AyX01TR19J
RF9NQVhfU0laRV9fQUtFX1NFTkRfUlJYID0gOSwKKwlUQV9IRENQX0hEQ1AyX01TR19JRF9NQVhf
U0laRV9fQUtFX1NFTkRfSF9QUklNRSA9IDMzLAorCVRBX0hEQ1BfSERDUDJfTVNHX0lEX01BWF9T
SVpFX19BS0VfU0VORF9QQUlSSU5HX0lORk8gPSAxNywKKwlUQV9IRENQX0hEQ1AyX01TR19JRF9N
QVhfU0laRV9fTENfSU5JVCA9IDksCisJVEFfSERDUF9IRENQMl9NU0dfSURfTUFYX1NJWkVfX0xD
X1NFTkRfTF9QUklNRSA9IDMzLAorCVRBX0hEQ1BfSERDUDJfTVNHX0lEX01BWF9TSVpFX19TS0Vf
U0VORF9FS1MgPSAyNSwKKwlUQV9IRENQX0hEQ1AyX01TR19JRF9NQVhfU0laRV9fUkVQRUFURVJB
VVRIX1NFTkRfUkVDRUlWRVJJRF9MSVNUID0gMTgxLAorCVRBX0hEQ1BfSERDUDJfTVNHX0lEX01B
WF9TSVpFX19SVFRfUkVBRFkgPSAxLAorCVRBX0hEQ1BfSERDUDJfTVNHX0lEX01BWF9TSVpFX19S
VFRfQ0hBTExFTkdFID0gMTcsCisJVEFfSERDUF9IRENQMl9NU0dfSURfTUFYX1NJWkVfX1JFUEVB
VEVSQVVUSF9TRU5EX1JBQ0sgPSAxNywKKwlUQV9IRENQX0hEQ1AyX01TR19JRF9NQVhfU0laRV9f
UkVQRUFURVJBVVRIX1NUUkVBTV9NQU5BR0UgPSAxMywKKwlUQV9IRENQX0hEQ1AyX01TR19JRF9N
QVhfU0laRV9fUkVQRUFURVJBVVRIX1NUUkVBTV9SRUFEWSA9IDMzLAorCVRBX0hEQ1BfSERDUDJf
TVNHX0lEX01BWF9TSVpFX19SRUNFSVZFUl9BVVRIX1NUQVRVUyA9IDQsCisJVEFfSERDUF9IRENQ
Ml9NU0dfSURfTUFYX1NJWkVfX0FLRV9UUkFOU01JVFRFUl9JTkZPID0gNiwKKwlUQV9IRENQX0hE
Q1AyX01TR19JRF9NQVhfU0laRV9fQUtFX1JFQ0VJVkVSX0lORk8gPSA2LAorCVRBX0hEQ1BfSERD
UDJfTVNHX0lEX01BWF9TSVpFX19TSUdOQUxfQ09OVEVOVF9TVFJFQU1fVFlQRV9EUCA9IDEKK307
CiAKIC8qIEhEQ1AgcmVsYXRlZCBlbnVtZXJhdGlvbnMgKi8KIC8qKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwpAQCAtMTMxLDYgKzE5Miwx
MiBAQCBlbnVtIHRhX2hkY3BfY29tbWFuZCB7CiAjZGVmaW5lIFRBX0hEQ1BfX0hEQ1AxX0tTVl9T
SVpFIDUKICNkZWZpbmUgVEFfSERDUF9fSERDUDFfS1NWX0xJU1RfTUFYX0VOVFJJRVMgMTI3CiAj
ZGVmaW5lIFRBX0hEQ1BfX0hEQ1AxX1ZfUFJJTUVfU0laRSAyMAorI2RlZmluZSBUQV9IRENQX19I
RENQMl9UWF9CVUZfTUFYX1NJWkUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisJVEFfSERDUF9I
RENQMl9NU0dfSURfTUFYX1NJWkVfX0FLRV9OT19TVE9SRURfS00gKyBUQV9IRENQX0hEQ1AyX01T
R19JRF9NQVhfU0laRV9fQUtFX1NUT1JFRF9LTSArIDYKKworLy8gNjQgYml0cyBib3VuZGFyaWVz
CisjZGVmaW5lIFRBX0hEQ1BfX0hEQ1AyX1JYX0JVRl9NQVhfU0laRSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKKwlUQV9IRENQX0hEQ1AyX01TR19JRF9NQVhfU0laRV9fQUtFX1NFTkRfQ0VSVCAr
IFRBX0hEQ1BfSERDUDJfTVNHX0lEX01BWF9TSVpFX19BS0VfUkVDRUlWRVJfSU5GTyArIDQKIAog
ZW51bSB0YV9oZGNwX3N0YXR1cyB7CiAJVEFfSERDUF9TVEFUVVNfX1NVQ0NFU1MgPSAweDAwLApA
QCAtMTY1LDkgKzIzMiw0NyBAQCBlbnVtIHRhX2hkY3BfYXV0aGVudGljYXRpb25fc3RhdHVzIHsK
IAlUQV9IRENQX0FVVEhFTlRJQ0FUSU9OX1NUQVRVU19fSERDUDFfRklSU1RfUEFSVF9DT01QTEVU
RSA9IDB4MDIsCiAJVEFfSERDUF9BVVRIRU5USUNBVElPTl9TVEFUVVNfX0hEQ1AxX1NFQ09ORF9Q
QVJUX0ZBSUxFRCA9IDB4MDMsCiAJVEFfSERDUF9BVVRIRU5USUNBVElPTl9TVEFUVVNfX0hEQ1Ax
X0FVVEhFTlRJQ0FURUQgPSAweDA0LAorCVRBX0hEQ1BfQVVUSEVOVElDQVRJT05fU1RBVFVTX19I
RENQMjJfQVVUSEVOVElDQVRJT05fUEVORElORyA9IDB4MDYsCisJVEFfSERDUF9BVVRIRU5USUNB
VElPTl9TVEFUVVNfX0hEQ1AyMl9BVVRIRU5USUNBVElPTl9GQUlMRUQgPSAweDA3LAorCVRBX0hE
Q1BfQVVUSEVOVElDQVRJT05fU1RBVFVTX19IRENQMjJfQVVUSEVOVElDQVRFRCA9IDB4MDgsCiAJ
VEFfSERDUF9BVVRIRU5USUNBVElPTl9TVEFUVVNfX0hEQ1AxX0tTVl9WQUxJREFUSU9OX0ZBSUxF
RCA9IDB4MDkKIH07CiAKK2VudW0gdGFfaGRjcDJfbXNnX2F1dGhlbnRpY2F0aW9uX3N0YXR1cyB7
CisJVEFfSERDUDJfTVNHX0FVVEhFTlRJQ0FUSU9OX1NUQVRVU19fU1VDQ0VTUyA9IDAsCisJVEFf
SERDUDJfTVNHX0FVVEhFTlRJQ0FUSU9OX1NUQVRVU19fS01fTk9UX0FWQUlMQUJMRSwKKwlUQV9I
RENQMl9NU0dfQVVUSEVOVElDQVRJT05fU1RBVFVTX19VTlVTRUQsCisJVEFfSERDUDJfTVNHX0FV
VEhFTlRJQ0FUSU9OX1NUQVRVU19fSU5WQUxJRCA9IDEwMCwgLy8gZXZlcnl0aGluZyBhYm92ZSBk
b2VzIG5vdCBmYWlsIHRoZSByZXF1ZXN0CisJVEFfSERDUDJfTVNHX0FVVEhFTlRJQ0FUSU9OX1NU
QVRVU19fTk9UX0VOT1VHSF9NRU1PUlksCisJVEFfSERDUDJfTVNHX0FVVEhFTlRJQ0FUSU9OX1NU
QVRVU19fTk9UX0VYUEVDVEVEX01TRywKKwlUQV9IRENQMl9NU0dfQVVUSEVOVElDQVRJT05fU1RB
VFVTX19TSUdOQVRVUkVfQ0VSVElGSUNBVF9FUlJPUiwKKwlUQV9IRENQMl9NU0dfQVVUSEVOVElD
QVRJT05fU1RBVFVTX19JTkNPUlJFQ1RfSERDUF9WRVJTSU9OLAorCVRBX0hEQ1AyX01TR19BVVRI
RU5USUNBVElPTl9TVEFUVVNfX1VOS05PV05fTUVTU0FHRSwKKwlUQV9IRENQMl9NU0dfQVVUSEVO
VElDQVRJT05fU1RBVFVTX19JTlZBTElEX0hNQUMsCisJVEFfSERDUDJfTVNHX0FVVEhFTlRJQ0FU
SU9OX1NUQVRVU19fSU5WQUxJRF9UT1BPTE9HWSwKKwlUQV9IRENQMl9NU0dfQVVUSEVOVElDQVRJ
T05fU1RBVFVTX19JTlZBTElEX1NFUV9OVU0sCisJVEFfSERDUDJfTVNHX0FVVEhFTlRJQ0FUSU9O
X1NUQVRVU19fSU5WQUxJRF9TSVpFLAorCVRBX0hEQ1AyX01TR19BVVRIRU5USUNBVElPTl9TVEFU
VVNfX0lOVkFMSURfTEVOR1RILAorCVRBX0hEQ1AyX01TR19BVVRIRU5USUNBVElPTl9TVEFUVVNf
X1JFQVVUSF9SRVFVRVNUCit9OworCitlbnVtIHRhX2hkY3BfY29udGVudF90eXBlIHsKKwlUQV9I
RENQMl9DT05URU5UX1RZUEVfX1RZUEUwID0gMSwKKwlUQV9IRENQMl9DT05URU5UX1RZUEVfX1RZ
UEUxLAorfTsKKworZW51bSB0YV9oZGNwX2NvbnRlbnRfdHlwZV9uZWdvdGlhdGlvbl90eXBlIHsK
KwlUQV9IRENQMl9DT05URU5UX1RZUEVfTkVHT1RJQVRJT05fVFlQRV9fRk9SQ0VfVFlQRTAgPSAx
LAorCVRBX0hEQ1AyX0NPTlRFTlRfVFlQRV9ORUdPVElBVElPTl9UWVBFX19GT1JDRV9UWVBFMSwK
KwlUQV9IRENQMl9DT05URU5UX1RZUEVfTkVHT1RJQVRJT05fVFlQRV9fTUFYX1NVUFBPUlRFRAor
fTsKKworZW51bSB0YV9oZGNwMl92ZXJzaW9uIHsKKwlUQV9IRENQMl9WRVJTSU9OX1VOS05PV04g
PSAwLAorCVRBX0hEQ1AyX1ZFUlNJT05fMl8wID0gMjAsCisJVEFfSERDUDJfVkVSU0lPTl8yXzEg
PSAyMSwKKwlUQV9IRENQMl9WRVJTSU9OXzJfMiA9IDIyCit9OwogCiAvKiBpbnB1dC9vdXRwdXQg
c3RydWN0dXJlcyBmb3IgSERDUCBjb21tYW5kcyAqLwogLyoqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCkBAIC0yMzIsNiArMzM3LDg0IEBA
IHN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMV9nZXRfZW5jcnlwdGlvbl9zdGF0dXNfb3V0cHV0IHsK
IAl1aW50MzJfdCBwcm90ZWN0aW9uX2xldmVsOwogfTsKIAorc3RydWN0IHRhX2hkY3BfY21kX2hk
Y3AyX2NyZWF0ZV9zZXNzaW9uX2lucHV0X3YyIHsKKwl1aW50MzJfdCBkaXNwbGF5X2hhbmRsZTsK
KwllbnVtIHRhX2hkY3BfY29udGVudF90eXBlX25lZ290aWF0aW9uX3R5cGUgbmVnb3RpYXRlX2Nv
bnRlbnRfdHlwZTsKK307CisKK3N0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9jcmVhdGVfc2Vzc2lv
bl9vdXRwdXRfdjIgeworCXVpbnQzMl90IHNlc3Npb25faGFuZGxlOworfTsKKworc3RydWN0IHRh
X2hkY3BfY21kX2hkY3AyX2Rlc3Ryb3lfc2Vzc2lvbl9pbnB1dCB7CisJdWludDMyX3Qgc2Vzc2lv
bl9oYW5kbGU7Cit9OworCitzdHJ1Y3QgdGFfaGRjcF9jbWRfaGRjcDJfYXV0aGVudGljYXRpb25f
bWVzc2FnZV92MiB7CisJZW51bSB0YV9oZGNwMl9tc2dfaWQgbXNnX2lkOworCXVpbnQzMl90IG1z
Z19zaXplOworfTsKKworc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX3Byb2Nlc3NfYXV0aGVudGlj
YXRpb25fbWVzc2FnZV9pbnB1dF92MiB7CisJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX2F1dGhl
bnRpY2F0aW9uX21lc3NhZ2VfdjIgbXNnMV9kZXNjOworCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNw
Ml9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX3YyIG1zZzJfZGVzYzsKKwlzdHJ1Y3QgdGFfaGRjcF9j
bWRfaGRjcDJfYXV0aGVudGljYXRpb25fbWVzc2FnZV92MiBtc2czX2Rlc2M7CisJdWludDhfdCBy
ZWNlaXZlcl9tZXNzYWdlW1RBX0hEQ1BfX0hEQ1AyX1JYX0JVRl9NQVhfU0laRV07Cit9OworCitz
dHJ1Y3QgdGFfaGRjcF9jbWRfaGRjcDJfcHJvY2Vzc19hdXRoZW50aWNhdGlvbl9tZXNzYWdlX291
dHB1dF92MiB7CisJdWludDMyX3QgaGRjcF92ZXJzaW9uOworCXVpbnQzMl90IGlzX2ttX3N0b3Jl
ZDsKKwl1aW50MzJfdCBpc19sb2NhbGl0eV9wcmVjb21wdXRlX3N1cHBvcnQ7CisJdWludDMyX3Qg
aXNfcmVwZWF0ZXI7CisJZW51bSB0YV9oZGNwMl9tc2dfYXV0aGVudGljYXRpb25fc3RhdHVzIG1z
ZzFfc3RhdHVzOworCWVudW0gdGFfaGRjcDJfbXNnX2F1dGhlbnRpY2F0aW9uX3N0YXR1cyBtc2cy
X3N0YXR1czsKKwllbnVtIHRhX2hkY3AyX21zZ19hdXRoZW50aWNhdGlvbl9zdGF0dXMgbXNnM19z
dGF0dXM7Cit9OworCitzdHJ1Y3QgdGFfaGRjcF9jbWRfaGRjcDJfcHJlcGFyZV9hdXRoZW50aWNh
dGlvbl9tZXNzYWdlX2lucHV0X3YyIHsKKwllbnVtIHRhX2hkY3AyX21zZ19pZCBtc2cxX2lkOwor
CWVudW0gdGFfaGRjcDJfbXNnX2lkIG1zZzJfaWQ7Cit9OworCitzdHJ1Y3QgdGFfaGRjcF9jbWRf
aGRjcDJfcHJlcGFyZV9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX291dHB1dF92MiB7CisJZW51bSB0
YV9oZGNwMl9tc2dfYXV0aGVudGljYXRpb25fc3RhdHVzIG1zZzFfc3RhdHVzOworCWVudW0gdGFf
aGRjcDJfbXNnX2F1dGhlbnRpY2F0aW9uX3N0YXR1cyBtc2cyX3N0YXR1czsKKwlzdHJ1Y3QgdGFf
aGRjcF9jbWRfaGRjcDJfYXV0aGVudGljYXRpb25fbWVzc2FnZV92MiBtc2cxX2Rlc2M7CisJc3Ry
dWN0IHRhX2hkY3BfY21kX2hkY3AyX2F1dGhlbnRpY2F0aW9uX21lc3NhZ2VfdjIgbXNnMl9kZXNj
OworCXVpbnQ4X3QgdHJhbnNtaXR0ZXJfbWVzc2FnZVtUQV9IRENQX19IRENQMl9UWF9CVUZfTUFY
X1NJWkVdOworfTsKKworc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFyZV9h
dXRoZW50aWNhdGlvbl9tZXNzYWdlX2lucHV0X3YyIHsKKwl1aW50MzJfdCBzZXNzaW9uX2hhbmRs
ZTsKKwlzdHJ1Y3QgdGFfaGRjcF9jbWRfaGRjcDJfcHJvY2Vzc19hdXRoZW50aWNhdGlvbl9tZXNz
YWdlX2lucHV0X3YyIHByb2Nlc3M7CisJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX3ByZXBhcmVf
YXV0aGVudGljYXRpb25fbWVzc2FnZV9pbnB1dF92MiBwcmVwYXJlOworfTsKKworc3RydWN0IHRh
X2hkY3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFyZV9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX291
dHB1dF92MiB7CisJdWludDMyX3QgYXV0aGVudGljYXRpb25fc3RhdHVzOworCXN0cnVjdCB0YV9o
ZGNwX2NtZF9oZGNwMl9wcm9jZXNzX2F1dGhlbnRpY2F0aW9uX21lc3NhZ2Vfb3V0cHV0X3YyIHBy
b2Nlc3M7CisJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX3ByZXBhcmVfYXV0aGVudGljYXRpb25f
bWVzc2FnZV9vdXRwdXRfdjIgcHJlcGFyZTsKK307CisKK3N0cnVjdCB0YV9oZGNwX2NtZF9oZGNw
Ml9zZXRfZW5jcnlwdGlvbl9pbnB1dCB7CisJdWludDMyX3Qgc2Vzc2lvbl9oYW5kbGU7Cit9Owor
CitzdHJ1Y3QgdGFfaGRjcF9jbWRfaGRjcDJfZ2V0X2VuY3J5cHRpb25fc3RhdHVzX2lucHV0IHsK
Kwl1aW50MzJfdCBzZXNzaW9uX2hhbmRsZTsKK307CisKK3N0cnVjdCB0YV9oZGNwX2NtZF9oZGNw
Ml9nZXRfZW5jcnlwdGlvbl9zdGF0dXNfb3V0cHV0IHsKKwllbnVtIHRhX2hkY3BfY29udGVudF90
eXBlIGhkY3AyX3R5cGU7CisJdWludDMyX3QgcHJvdGVjdGlvbl9sZXZlbDsKK307CisKK3N0cnVj
dCB0YV9oZGNwX2NtZF9oZGNwMl9lbmFibGVfZHBfc3RyZWFtX2VuY3J5cHRpb25faW5wdXQgewor
CXVpbnQzMl90IHNlc3Npb25faGFuZGxlOworCXVpbnQzMl90IGRpc3BsYXlfaGFuZGxlOworfTsK
KwogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKiovCiAvKiBDb21tb24gaW5wdXQgc3RydWN0dXJlIGZvciBIRENQIGNhbGxiYWNrcyAqLwog
dW5pb24gdGFfaGRjcF9jbWRfaW5wdXQgewpAQCAtMjQyLDYgKzQyNSwxMyBAQCB1bmlvbiB0YV9o
ZGNwX2NtZF9pbnB1dCB7CiAJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AxX2VuYWJsZV9lbmNyeXB0
aW9uX2lucHV0IGhkY3AxX2VuYWJsZV9lbmNyeXB0aW9uOwogCXN0cnVjdCB0YV9oZGNwX2NtZF9o
ZGNwMV9lbmFibGVfZHBfc3RyZWFtX2VuY3J5cHRpb25faW5wdXQgaGRjcDFfZW5hYmxlX2RwX3N0
cmVhbV9lbmNyeXB0aW9uOwogCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMV9nZXRfZW5jcnlwdGlv
bl9zdGF0dXNfaW5wdXQgaGRjcDFfZ2V0X2VuY3J5cHRpb25fc3RhdHVzOworCXN0cnVjdCB0YV9o
ZGNwX2NtZF9oZGNwMl9kZXN0cm95X3Nlc3Npb25faW5wdXQgaGRjcDJfZGVzdHJveV9zZXNzaW9u
OworCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9zZXRfZW5jcnlwdGlvbl9pbnB1dCBoZGNwMl9z
ZXRfZW5jcnlwdGlvbjsKKwlzdHJ1Y3QgdGFfaGRjcF9jbWRfaGRjcDJfZ2V0X2VuY3J5cHRpb25f
c3RhdHVzX2lucHV0IGhkY3AyX2dldF9lbmNyeXB0aW9uX3N0YXR1czsKKwlzdHJ1Y3QgdGFfaGRj
cF9jbWRfaGRjcDJfY3JlYXRlX3Nlc3Npb25faW5wdXRfdjIgaGRjcDJfY3JlYXRlX3Nlc3Npb25f
djI7CisJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX3Byb2Nlc3NfcHJlcGFyZV9hdXRoZW50aWNh
dGlvbl9tZXNzYWdlX2lucHV0X3YyCisJCWhkY3AyX3ByZXBhcmVfcHJvY2Vzc19hdXRoZW50aWNh
dGlvbl9tZXNzYWdlX3YyOworCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9lbmFibGVfZHBfc3Ry
ZWFtX2VuY3J5cHRpb25faW5wdXQgaGRjcDJfZW5hYmxlX2RwX3N0cmVhbV9lbmNyeXB0aW9uOwog
fTsKIAogLyogQ29tbW9uIG91dHB1dCBzdHJ1Y3R1cmUgZm9yIEhEQ1AgY2FsbGJhY2tzICovCkBA
IC0yNTAsNiArNDQwLDEwIEBAIHVuaW9uIHRhX2hkY3BfY21kX291dHB1dCB7CiAJc3RydWN0IHRh
X2hkY3BfY21kX2hkY3AxX2ZpcnN0X3BhcnRfYXV0aGVudGljYXRpb25fb3V0cHV0IGhkY3AxX2Zp
cnN0X3BhcnRfYXV0aGVudGljYXRpb247CiAJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AxX3NlY29u
ZF9wYXJ0X2F1dGhlbnRpY2F0aW9uX291dHB1dCBoZGNwMV9zZWNvbmRfcGFydF9hdXRoZW50aWNh
dGlvbjsKIAlzdHJ1Y3QgdGFfaGRjcF9jbWRfaGRjcDFfZ2V0X2VuY3J5cHRpb25fc3RhdHVzX291
dHB1dCBoZGNwMV9nZXRfZW5jcnlwdGlvbl9zdGF0dXM7CisJc3RydWN0IHRhX2hkY3BfY21kX2hk
Y3AyX2dldF9lbmNyeXB0aW9uX3N0YXR1c19vdXRwdXQgaGRjcDJfZ2V0X2VuY3J5cHRpb25fc3Rh
dHVzOworCXN0cnVjdCB0YV9oZGNwX2NtZF9oZGNwMl9jcmVhdGVfc2Vzc2lvbl9vdXRwdXRfdjIg
aGRjcDJfY3JlYXRlX3Nlc3Npb25fdjI7CisJc3RydWN0IHRhX2hkY3BfY21kX2hkY3AyX3Byb2Nl
c3NfcHJlcGFyZV9hdXRoZW50aWNhdGlvbl9tZXNzYWdlX291dHB1dF92MgorCQloZGNwMl9wcmVw
YXJlX3Byb2Nlc3NfYXV0aGVudGljYXRpb25fbWVzc2FnZV92MjsKIH07CiAvKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KIAotLSAKMi4x
Ny4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQt
Z2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
