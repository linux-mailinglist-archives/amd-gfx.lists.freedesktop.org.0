Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 25C54B23DB
	for <lists+amd-gfx@lfdr.de>; Fri, 13 Sep 2019 18:09:31 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AF0486F412;
	Fri, 13 Sep 2019 16:09:29 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM05-CO1-obe.outbound.protection.outlook.com
 (mail-eopbgr720057.outbound.protection.outlook.com [40.107.72.57])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 73B216F412
 for <amd-gfx@lists.freedesktop.org>; Fri, 13 Sep 2019 16:09:28 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Mv1cj3H5s/Kw8M/7DFi4aE0VA5ePYRSXnUi6F4gZ0Lmk1652jmBDDSy8GyFt6hfowaqHmS5wLkcwHbLLGO+p0b69epK7hzOUz5uI2TcOVHnV/9InmVxuwa2/T/V22Oi241B4r6JY0ZM2y5N2gl5g1FNFnoJR+t6jbLNy1QaVPDv7OQ4odATfxMS7cVcpnylofVUfTM0QCEly5NySeSeAzT/OiqxIxHqtGPnRSo8qyJzOGSOgEY+mNSwmsTFhA7jt+FAhzh30rbsTDSmTgHfAwRPMWnJ8seM2OrcPuAzl0xdBv9KL47VL8dPDVAYqhG7CsRWtLQdDdF6I20aDbXEHYw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=FEiOduIk2bPlBzAvGsx5qUoLIRXhI5T2D9bMpTSxBV4=;
 b=g2aUcTlesO2MEFhnrmPUWrEgT8Vba+MxljY4rWiKIxgXP9eP1hniZEUfXli3wiSOsonXlaW/YRgkSxSMSg9KkIIGLM5OF6r1NdX1kHTpDOJycT0RvVohFtTGJ4A6EKep2LF1QFL89fUvIFuvFv9sAeyhwGTnTdPVD2rgF725L2Lpv8mBXou8YFH2eHawO2FVynsHmsN+bJWrlb6tl3x+Vv+ZX5I9H3kpqNIlVK+MUnMePC2Zn02r5at97jXkcj8PGQmGl3PPZpDsSMmv/whmDhpv+O/+bSe5U9w4ZbZNELRYXp3mGjdGH1yslKTgwfaQ16HqTPg2E5CM/ze7z+jAKA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=none (sender ip is
 165.204.84.17) smtp.rcpttodomain=lists.freedesktop.org smtp.mailfrom=amd.com; 
 dmarc=permerror action=none header.from=amd.com; dkim=none (message not
 signed); arc=none
Received: from CY4PR12CA0041.namprd12.prod.outlook.com (2603:10b6:903:129::27)
 by DM5PR12MB1178.namprd12.prod.outlook.com (2603:10b6:3:6c::20) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2241.20; Fri, 13 Sep
 2019 16:09:26 +0000
Received: from CO1NAM03FT021.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e48::201) by CY4PR12CA0041.outlook.office365.com
 (2603:10b6:903:129::27) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2263.17 via Frontend
 Transport; Fri, 13 Sep 2019 16:09:25 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV02.amd.com (165.204.84.17) by
 CO1NAM03FT021.mail.protection.outlook.com (10.152.80.180) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.2263.14 via Frontend Transport; Fri, 13 Sep 2019 16:09:25 +0000
Received: from agrodzovsky-All-Series.amd.com (10.180.168.240) by
 SATLEXCHOV02.amd.com (10.181.40.72) with Microsoft SMTP Server id 14.3.389.1; 
 Fri, 13 Sep 2019 11:09:22 -0500
From: Andrey Grodzovsky <andrey.grodzovsky@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH] drm/amdgpu: Fix EEPROM checksum calculation.
Date: Fri, 13 Sep 2019 12:09:16 -0400
Message-ID: <1568390956-3601-1-git-send-email-andrey.grodzovsky@amd.com>
X-Mailer: git-send-email 2.7.4
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(346002)(136003)(376002)(39860400002)(396003)(428003)(199004)(189003)(186003)(44832011)(4326008)(2906002)(53936002)(8936002)(5660300002)(2870700001)(81156014)(305945005)(70206006)(5820100001)(50226002)(8676002)(50466002)(126002)(336012)(6666004)(47776003)(356004)(36756003)(6916009)(14444005)(70586007)(86362001)(81166006)(476003)(316002)(478600001)(426003)(2616005)(23676004)(7696005)(486006)(2351001)(53416004)(54906003)(26005);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM5PR12MB1178; H:SATLEXCHOV02.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; A:1; MX:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 63418ff6-63d4-432d-8592-08d73864bf9d
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600166)(711020)(4605104)(1401327)(4618075)(2017052603328);
 SRVR:DM5PR12MB1178; 
X-MS-TrafficTypeDiagnostic: DM5PR12MB1178:
X-Microsoft-Antispam-PRVS: <DM5PR12MB1178C0F039614904B1DA8B8BEAB30@DM5PR12MB1178.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:3513;
X-Forefront-PRVS: 0159AC2B97
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: sA6pokZmj2n1Brpf+2g+eEvIJCzvuGjsgt7gFnUUKhglIgtrr8WOAhWX6QZOu350jxgjUBPsCIK+wCBZDkRUXU9PiGxtuHmGkF4KXl/gKWLCn736Gimj2Dn/hLSK7S0hJHgi9nXTk3f0zJ+SyIq2W1M5dFD2oWAAXxwjJOK6XtgBTqQn1egmC523q5Z1s8HaAhrGpnZ8fWNMxGcYkZAISl+7X/uYKjUkgP5q7DzjVsZ1n1DbNyAezOmXEUjxwexziyGGbV+PeuRQutxzAHQ6fU4jYB9VggpHVhOYN9rIJYsOZeqb8ERm/9RHa/iFKyKgkVjRVlcfN1/ODq1T3zh+EteCrOB2m9mmj9z0IxtbGriQoc3SUWEr7DSOnX8zt+KZE7YZZDmm3nulFO9Iw55be8dP/WNve6GljOJipcoAJAs=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 13 Sep 2019 16:09:25.6959 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 63418ff6-63d4-432d-8592-08d73864bf9d
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV02.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM5PR12MB1178
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=FEiOduIk2bPlBzAvGsx5qUoLIRXhI5T2D9bMpTSxBV4=;
 b=nBpJrk80ARov5oJwRspdAlBwig1jpxCrr+qSQ6pEJx5Gpd1TQwvX4RBPXiR3gZvKYBHd7dJGMYcBP6QCwDnlUu7c2TofZ9E7j2MTNLiNxLcw3Ja1qT+0KH7jfxCT7RuNRZHji6EFEtPlHuAAkPv2T1QXtK1N+zDzJ6Iws8vTS+0=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Andrey Grodzovsky <andrey.grodzovsky@amd.com>, Tao.Zhou1@amd.com,
 Guchun.Chen@amd.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

Rml4IGNoZWNrc3VtIGNhbGN1bGF0aW9uIGFmdGVyIG1hbnVhbGx5IHJlc2V0dGluZyB0aGUgdGFi
bGUuClVuaWZ5IHJlc2V0IGFuZCBlbXB0eSBFRVBST00gaW5pdCBmbG93LgpQcm90ZWN0IHRoZSB0
YWJsZSByZXNldCB3aXRoIGxvY2suCgpTaWduZWQtb2ZmLWJ5OiBBbmRyZXkgR3JvZHpvdnNreSA8
YW5kcmV5Lmdyb2R6b3Zza3lAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfcmFzX2VlcHJvbS5jIHwgMTY0ICsrKysrKysrKysrKystLS0tLS0tLS0tLS0KIDEg
ZmlsZSBjaGFuZ2VkLCA4NiBpbnNlcnRpb25zKCspLCA3OCBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmFzX2VlcHJvbS5jIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jhc19lZXByb20uYwppbmRleCAxMWE4NDQ1
Li5kMGUwMjBlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
cmFzX2VlcHJvbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXNf
ZWVwcm9tLmMKQEAgLTEwMCwyMiArMTAwLDEwMCBAQCBzdGF0aWMgaW50IF9fdXBkYXRlX3RhYmxl
X2hlYWRlcihzdHJ1Y3QgYW1kZ3B1X3Jhc19lZXByb21fY29udHJvbCAqY29udHJvbCwKIAlyZXR1
cm4gcmV0OwogfQogCi1zdGF0aWMgdWludDMyX3QgIF9fY2FsY19oZHJfYnl0ZV9zdW0oc3RydWN0
IGFtZGdwdV9yYXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2wpOworCisKK3N0YXRpYyB1aW50MzJf
dCAgX19jYWxjX2hkcl9ieXRlX3N1bShzdHJ1Y3QgYW1kZ3B1X3Jhc19lZXByb21fY29udHJvbCAq
Y29udHJvbCkKK3sKKwlpbnQgaTsKKwl1aW50MzJfdCB0Ymxfc3VtID0gMDsKKworCS8qIEhlYWRl
ciBjaGVja3N1bSwgc2tpcCBjaGVja3N1bSBmaWVsZCBpbiB0aGUgY2FsY3VsYXRpb24gKi8KKwlm
b3IgKGkgPSAwOyBpIDwgc2l6ZW9mKGNvbnRyb2wtPnRibF9oZHIpIC0gc2l6ZW9mKGNvbnRyb2wt
PnRibF9oZHIuY2hlY2tzdW0pOyBpKyspCisJCXRibF9zdW0gKz0gKigoKHVuc2lnbmVkIGNoYXIg
KikmY29udHJvbC0+dGJsX2hkcikgKyBpKTsKKworCXJldHVybiB0Ymxfc3VtOworfQorCitzdGF0
aWMgdWludDMyX3QgIF9fY2FsY19yZWNzX2J5dGVfc3VtKHN0cnVjdCBlZXByb21fdGFibGVfcmVj
b3JkICpyZWNvcmRzLAorCQkJCSAgICAgIGludCBudW0pCit7CisJaW50IGksIGo7CisJdWludDMy
X3QgdGJsX3N1bSA9IDA7CisKKwkvKiBSZWNvcmRzIGNoZWNrc3VtICovCisJZm9yIChpID0gMDsg
aSA8IG51bTsgaSsrKSB7CisJCXN0cnVjdCBlZXByb21fdGFibGVfcmVjb3JkICpyZWNvcmQgPSAm
cmVjb3Jkc1tpXTsKKworCQlmb3IgKGogPSAwOyBqIDwgc2l6ZW9mKCpyZWNvcmQpOyBqKyspIHsK
KwkJCXRibF9zdW0gKz0gKigoKHVuc2lnbmVkIGNoYXIgKilyZWNvcmQpICsgaik7CisJCX0KKwl9
CisKKwlyZXR1cm4gdGJsX3N1bTsKK30KKworc3RhdGljIGlubGluZSB1aW50MzJfdCAgX19jYWxj
X3RibF9ieXRlX3N1bShzdHJ1Y3QgYW1kZ3B1X3Jhc19lZXByb21fY29udHJvbCAqY29udHJvbCwK
KwkJCQkgIHN0cnVjdCBlZXByb21fdGFibGVfcmVjb3JkICpyZWNvcmRzLCBpbnQgbnVtKQorewor
CXJldHVybiBfX2NhbGNfaGRyX2J5dGVfc3VtKGNvbnRyb2wpICsgX19jYWxjX3JlY3NfYnl0ZV9z
dW0ocmVjb3JkcywgbnVtKTsKK30KKworLyogQ2hlY2tzdW0gPSAyNTYgLSgoc3VtIG9mIGFsbCB0
YWJsZSBlbnRyaWVzKSBtb2QgMjU2KcKgKi8KK3N0YXRpYyB2b2lkIF9fdXBkYXRlX3RibF9jaGVj
a3N1bShzdHJ1Y3QgYW1kZ3B1X3Jhc19lZXByb21fY29udHJvbCAqY29udHJvbCwKKwkJCQkgIHN0
cnVjdCBlZXByb21fdGFibGVfcmVjb3JkICpyZWNvcmRzLCBpbnQgbnVtLAorCQkJCSAgdWludDMy
X3Qgb2xkX2hkcl9ieXRlX3N1bSkKK3sKKwkvKgorCSAqIFRoaXMgd2lsbCB1cGRhdGUgdGhlIHRh
YmxlIHN1bSB3aXRoIG5ldyByZWNvcmRzLgorCSAqCisJICogVE9ETzogV2hhdCBoYXBwZW5zIHdo
ZW4gdGhlIEVFUFJPTSB0YWJsZSBpcyB0byBiZSB3cmFwcGVkIGFyb3VuZAorCSAqIGFuZCBvbGQg
cmVjb3JkcyBmcm9tIHN0YXJ0IHdpbGwgZ2V0IG92ZXJyaWRkZW4uCisJICovCisKKwkvKiBuZWVk
IHRvIHJlY2FsY3VsYXRlIHVwZGF0ZWQgaGVhZGVyIGJ5dGUgc3VtICovCisJY29udHJvbC0+dGJs
X2J5dGVfc3VtIC09IG9sZF9oZHJfYnl0ZV9zdW07CisJY29udHJvbC0+dGJsX2J5dGVfc3VtICs9
IF9fY2FsY190YmxfYnl0ZV9zdW0oY29udHJvbCwgcmVjb3JkcywgbnVtKTsKKworCWNvbnRyb2wt
PnRibF9oZHIuY2hlY2tzdW0gPSAyNTYgLSAoY29udHJvbC0+dGJsX2J5dGVfc3VtICUgMjU2KTsK
K30KKworLyogdGFibGUgc3VtIG1vZCAyNTYgKyBjaGVja3N1bSBtdXN0IGVxdWFscyAyNTYgKi8K
K3N0YXRpYyBib29sIF9fdmFsaWRhdGVfdGJsX2NoZWNrc3VtKHN0cnVjdCBhbWRncHVfcmFzX2Vl
cHJvbV9jb250cm9sICpjb250cm9sLAorCQkJICAgIHN0cnVjdCBlZXByb21fdGFibGVfcmVjb3Jk
ICpyZWNvcmRzLCBpbnQgbnVtKQoreworCWNvbnRyb2wtPnRibF9ieXRlX3N1bSA9IF9fY2FsY190
YmxfYnl0ZV9zdW0oY29udHJvbCwgcmVjb3JkcywgbnVtKTsKKworCWlmIChjb250cm9sLT50Ymxf
aGRyLmNoZWNrc3VtICsgKGNvbnRyb2wtPnRibF9ieXRlX3N1bSAlIDI1NikgIT0gMjU2KSB7CisJ
CURSTV9XQVJOKCJDaGVja3N1bSBtaXNtYXRjaCwgY2hlY2tzdW06ICV1ICIsIGNvbnRyb2wtPnRi
bF9oZHIuY2hlY2tzdW0pOworCQlyZXR1cm4gZmFsc2U7CisJfQorCisJcmV0dXJuIHRydWU7Cit9
CiAKIGludCBhbWRncHVfcmFzX2VlcHJvbV9yZXNldF90YWJsZShzdHJ1Y3QgYW1kZ3B1X3Jhc19l
ZXByb21fY29udHJvbCAqY29udHJvbCkKIHsKIAl1bnNpZ25lZCBjaGFyIGJ1ZmZbRUVQUk9NX0FE
RFJFU1NfU0laRSArIEVFUFJPTV9UQUJMRV9IRUFERVJfU0laRV0gPSB7IDAgfTsKLQlzdHJ1Y3Qg
YW1kZ3B1X2RldmljZSAqYWRldiA9IHRvX2FtZGdwdV9kZXZpY2UoY29udHJvbCk7CiAJc3RydWN0
IGFtZGdwdV9yYXNfZWVwcm9tX3RhYmxlX2hlYWRlciAqaGRyID0gJmNvbnRyb2wtPnRibF9oZHI7
CisJaW50IHJldCA9IDA7CisKKwltdXRleF9sb2NrKCZjb250cm9sLT50YmxfbXV0ZXgpOwogCiAJ
aGRyLT5oZWFkZXIgPSBFRVBST01fVEFCTEVfSERSX1ZBTDsKIAloZHItPnZlcnNpb24gPSBFRVBS
T01fVEFCTEVfVkVSOwogCWhkci0+Zmlyc3RfcmVjX29mZnNldCA9IEVFUFJPTV9SRUNPUkRfU1RB
UlQ7CiAJaGRyLT50Ymxfc2l6ZSA9IEVFUFJPTV9UQUJMRV9IRUFERVJfU0laRTsKIAotCWFkZXYt
PnBzcC5yYXMucmFzLT5lZXByb21fY29udHJvbC50YmxfYnl0ZV9zdW0gPQotCQkJX19jYWxjX2hk
cl9ieXRlX3N1bSgmYWRldi0+cHNwLnJhcy5yYXMtPmVlcHJvbV9jb250cm9sKTsKLQlyZXR1cm4g
X191cGRhdGVfdGFibGVfaGVhZGVyKGNvbnRyb2wsIGJ1ZmYpOworCWNvbnRyb2wtPnRibF9ieXRl
X3N1bSA9IDA7CisJX191cGRhdGVfdGJsX2NoZWNrc3VtKGNvbnRyb2wsIE5VTEwsIDAsIDApOwor
CWNvbnRyb2wtPm5leHRfYWRkciA9IEVFUFJPTV9SRUNPUkRfU1RBUlQ7CisKKwlyZXQgPSBfX3Vw
ZGF0ZV90YWJsZV9oZWFkZXIoY29udHJvbCwgYnVmZik7CisKKwltdXRleF91bmxvY2soJmNvbnRy
b2wtPnRibF9tdXRleCk7CisKKwlyZXR1cm4gcmV0OworCiB9CiAKIGludCBhbWRncHVfcmFzX2Vl
cHJvbV9pbml0KHN0cnVjdCBhbWRncHVfcmFzX2VlcHJvbV9jb250cm9sICpjb250cm9sKQpAQCAt
MTU5LDYgKzIzNyw5IEBAIGludCBhbWRncHVfcmFzX2VlcHJvbV9pbml0KHN0cnVjdCBhbWRncHVf
cmFzX2VlcHJvbV9jb250cm9sICpjb250cm9sKQogCWlmIChoZHItPmhlYWRlciA9PSBFRVBST01f
VEFCTEVfSERSX1ZBTCkgewogCQljb250cm9sLT5udW1fcmVjcyA9IChoZHItPnRibF9zaXplIC0g
RUVQUk9NX1RBQkxFX0hFQURFUl9TSVpFKSAvCiAJCQkJICAgIEVFUFJPTV9UQUJMRV9SRUNPUkRf
U0laRTsKKwkJY29udHJvbC0+dGJsX2J5dGVfc3VtID0gX19jYWxjX2hkcl9ieXRlX3N1bShjb250
cm9sKTsKKwkJY29udHJvbC0+bmV4dF9hZGRyID0gRUVQUk9NX1JFQ09SRF9TVEFSVDsKKwogCQlE
Uk1fREVCVUdfRFJJVkVSKCJGb3VuZCBleGlzdGluZyBFRVBST00gdGFibGUgd2l0aCAlZCByZWNv
cmRzIiwKIAkJCQkgY29udHJvbC0+bnVtX3JlY3MpOwogCkBAIC0xNjgsOSArMjQ5LDYgQEAgaW50
IGFtZGdwdV9yYXNfZWVwcm9tX2luaXQoc3RydWN0IGFtZGdwdV9yYXNfZWVwcm9tX2NvbnRyb2wg
KmNvbnRyb2wpCiAJCXJldCA9IGFtZGdwdV9yYXNfZWVwcm9tX3Jlc2V0X3RhYmxlKGNvbnRyb2wp
OwogCX0KIAotCS8qIFN0YXJ0IGluc2VydGluZyByZWNvcmRzIGZyb20gaGVyZSAqLwotCWFkZXYt
PnBzcC5yYXMucmFzLT5lZXByb21fY29udHJvbC5uZXh0X2FkZHIgPSBFRVBST01fUkVDT1JEX1NU
QVJUOwotCiAJcmV0dXJuIHJldCA9PSAxID8gMCA6IC1FSU87CiB9CiAKQEAgLTI3NSw3NiArMzUz
LDYgQEAgc3RhdGljIHVpbnQzMl90IF9fY29ycmVjdF9lZXByb21fZGVzdF9hZGRyZXNzKHVpbnQz
Ml90IGN1cnJfYWRkcmVzcykKIAlyZXR1cm4gY3Vycl9hZGRyZXNzOwogfQogCi0KLXN0YXRpYyB1
aW50MzJfdCAgX19jYWxjX2hkcl9ieXRlX3N1bShzdHJ1Y3QgYW1kZ3B1X3Jhc19lZXByb21fY29u
dHJvbCAqY29udHJvbCkKLXsKLQlpbnQgaTsKLQl1aW50MzJfdCB0Ymxfc3VtID0gMDsKLQotCS8q
IEhlYWRlciBjaGVja3N1bSwgc2tpcCBjaGVja3N1bSBmaWVsZCBpbiB0aGUgY2FsY3VsYXRpb24g
Ki8KLQlmb3IgKGkgPSAwOyBpIDwgc2l6ZW9mKGNvbnRyb2wtPnRibF9oZHIpIC0gc2l6ZW9mKGNv
bnRyb2wtPnRibF9oZHIuY2hlY2tzdW0pOyBpKyspCi0JCXRibF9zdW0gKz0gKigoKHVuc2lnbmVk
IGNoYXIgKikmY29udHJvbC0+dGJsX2hkcikgKyBpKTsKLQotCXJldHVybiB0Ymxfc3VtOwotfQot
Ci1zdGF0aWMgdWludDMyX3QgIF9fY2FsY19yZWNzX2J5dGVfc3VtKHN0cnVjdCBlZXByb21fdGFi
bGVfcmVjb3JkICpyZWNvcmRzLAotCQkJCSAgICAgIGludCBudW0pCi17Ci0JaW50IGksIGo7Ci0J
dWludDMyX3QgdGJsX3N1bSA9IDA7Ci0KLQkvKiBSZWNvcmRzIGNoZWNrc3VtICovCi0JZm9yIChp
ID0gMDsgaSA8IG51bTsgaSsrKSB7Ci0JCXN0cnVjdCBlZXByb21fdGFibGVfcmVjb3JkICpyZWNv
cmQgPSAmcmVjb3Jkc1tpXTsKLQotCQlmb3IgKGogPSAwOyBqIDwgc2l6ZW9mKCpyZWNvcmQpOyBq
KyspIHsKLQkJCXRibF9zdW0gKz0gKigoKHVuc2lnbmVkIGNoYXIgKilyZWNvcmQpICsgaik7Ci0J
CX0KLQl9Ci0KLQlyZXR1cm4gdGJsX3N1bTsKLX0KLQotc3RhdGljIGlubGluZSB1aW50MzJfdCAg
X19jYWxjX3RibF9ieXRlX3N1bShzdHJ1Y3QgYW1kZ3B1X3Jhc19lZXByb21fY29udHJvbCAqY29u
dHJvbCwKLQkJCQkgIHN0cnVjdCBlZXByb21fdGFibGVfcmVjb3JkICpyZWNvcmRzLCBpbnQgbnVt
KQotewotCXJldHVybiBfX2NhbGNfaGRyX2J5dGVfc3VtKGNvbnRyb2wpICsgX19jYWxjX3JlY3Nf
Ynl0ZV9zdW0ocmVjb3JkcywgbnVtKTsKLX0KLQotLyogQ2hlY2tzdW0gPSAyNTYgLSgoc3VtIG9m
IGFsbCB0YWJsZSBlbnRyaWVzKSBtb2QgMjU2KcKgKi8KLXN0YXRpYyB2b2lkIF9fdXBkYXRlX3Ri
bF9jaGVja3N1bShzdHJ1Y3QgYW1kZ3B1X3Jhc19lZXByb21fY29udHJvbCAqY29udHJvbCwKLQkJ
CQkgIHN0cnVjdCBlZXByb21fdGFibGVfcmVjb3JkICpyZWNvcmRzLCBpbnQgbnVtLAotCQkJCSAg
dWludDMyX3Qgb2xkX2hkcl9ieXRlX3N1bSkKLXsKLQkvKgotCSAqIFRoaXMgd2lsbCB1cGRhdGUg
dGhlIHRhYmxlIHN1bSB3aXRoIG5ldyByZWNvcmRzLgotCSAqCi0JICogVE9ETzogV2hhdCBoYXBw
ZW5zIHdoZW4gdGhlIEVFUFJPTSB0YWJsZSBpcyB0byBiZSB3cmFwcGVkIGFyb3VuZAotCSAqIGFu
ZCBvbGQgcmVjb3JkcyBmcm9tIHN0YXJ0IHdpbGwgZ2V0IG92ZXJyaWRkZW4uCi0JICovCi0KLQkv
KiBuZWVkIHRvIHJlY2FsY3VsYXRlIHVwZGF0ZWQgaGVhZGVyIGJ5dGUgc3VtICovCi0JY29udHJv
bC0+dGJsX2J5dGVfc3VtIC09IG9sZF9oZHJfYnl0ZV9zdW07Ci0JY29udHJvbC0+dGJsX2J5dGVf
c3VtICs9IF9fY2FsY190YmxfYnl0ZV9zdW0oY29udHJvbCwgcmVjb3JkcywgbnVtKTsKLQotCWNv
bnRyb2wtPnRibF9oZHIuY2hlY2tzdW0gPSAyNTYgLSAoY29udHJvbC0+dGJsX2J5dGVfc3VtICUg
MjU2KTsKLX0KLQotLyogdGFibGUgc3VtIG1vZCAyNTYgKyBjaGVja3N1bSBtdXN0IGVxdWFscyAy
NTYgKi8KLXN0YXRpYyBib29sIF9fdmFsaWRhdGVfdGJsX2NoZWNrc3VtKHN0cnVjdCBhbWRncHVf
cmFzX2VlcHJvbV9jb250cm9sICpjb250cm9sLAotCQkJICAgIHN0cnVjdCBlZXByb21fdGFibGVf
cmVjb3JkICpyZWNvcmRzLCBpbnQgbnVtKQotewotCWNvbnRyb2wtPnRibF9ieXRlX3N1bSA9IF9f
Y2FsY190YmxfYnl0ZV9zdW0oY29udHJvbCwgcmVjb3JkcywgbnVtKTsKLQotCWlmIChjb250cm9s
LT50YmxfaGRyLmNoZWNrc3VtICsgKGNvbnRyb2wtPnRibF9ieXRlX3N1bSAlIDI1NikgIT0gMjU2
KSB7Ci0JCURSTV9XQVJOKCJDaGVja3N1bSBtaXNtYXRjaCwgY2hlY2tzdW06ICV1ICIsIGNvbnRy
b2wtPnRibF9oZHIuY2hlY2tzdW0pOwotCQlyZXR1cm4gZmFsc2U7Ci0JfQotCi0JcmV0dXJuIHRy
dWU7Ci19Ci0KIGludCBhbWRncHVfcmFzX2VlcHJvbV9wcm9jZXNzX3JlY29kcyhzdHJ1Y3QgYW1k
Z3B1X3Jhc19lZXByb21fY29udHJvbCAqY29udHJvbCwKIAkJCQkJICAgIHN0cnVjdCBlZXByb21f
dGFibGVfcmVjb3JkICpyZWNvcmRzLAogCQkJCQkgICAgYm9vbCB3cml0ZSwKLS0gCjIuNy40Cgpf
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1h
aWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
