Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DBA5CA12A3
	for <lists+amd-gfx@lfdr.de>; Thu, 29 Aug 2019 09:30:43 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 68B4F89FC3;
	Thu, 29 Aug 2019 07:30:42 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wr1-x441.google.com (mail-wr1-x441.google.com
 [IPv6:2a00:1450:4864:20::441])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7434689FC3
 for <amd-gfx@lists.freedesktop.org>; Thu, 29 Aug 2019 07:30:41 +0000 (UTC)
Received: by mail-wr1-x441.google.com with SMTP id h7so968755wrt.13
 for <amd-gfx@lists.freedesktop.org>; Thu, 29 Aug 2019 00:30:41 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:reply-to:subject:to:cc:references:from
 :message-id:date:user-agent:mime-version:in-reply-to
 :content-transfer-encoding:content-language;
 bh=tbV9DGRgdRkePZWZmOTudgQe6LkvJ7lzanx3zyenrgE=;
 b=MUwy//Oy2MMplbQKl51BRgQQmPei2JwR1UUwr4xkLR6rGHoIS74DS/+xRZ6JQ5VoUF
 BP/9MEHw4FKHc7lzRZqH8sU7XDjAlrBvnQGDfykfE77iNfHb/4TQgp2aNj8Y1Cvl/daV
 +4u4B9lkEIyVeojirmQgxbYS9zRXdGAhVAJ88P5DfTiHPIGCrXVVbvZFHJL+vtJVmGNT
 BfI73rlpofCeLwXSfDL0/M3UKjp/S1PvTBJWWv7w9WRsBagbwQh3/UTN2BN/iKGUwtIm
 9pY6STst2JBW6ih/p0ezakDlN0cFP5AcZjtcvYkOjedkfGvu1CiOH2ogcrOgL6S4JuvT
 oSPA==
X-Gm-Message-State: APjAAAVrqsqb9KNJfPm1AXWXZmty+h0LMWiKmCYvQW0mvhwwaaHma0SF
 LA0w8/r8WxwEuumKidOpB6bb8Kly
X-Google-Smtp-Source: APXvYqwNFn/PTdpltZTIMIDfAKotTv+o2WbGX1dVwEy5MdGUyNJJf/KkfzG6ROKt6GAh4nJjCi12Eg==
X-Received: by 2002:a5d:6444:: with SMTP id d4mr3457546wrw.322.1567063839981; 
 Thu, 29 Aug 2019 00:30:39 -0700 (PDT)
Received: from ?IPv6:2a02:908:1252:fb60:be8a:bd56:1f94:86e7?
 ([2a02:908:1252:fb60:be8a:bd56:1f94:86e7])
 by smtp.gmail.com with ESMTPSA id w14sm1841356wrl.21.2019.08.29.00.30.39
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Thu, 29 Aug 2019 00:30:39 -0700 (PDT)
Subject: Re: [PATCH 1/2] dmr/amdgpu: Avoid HW GPU reset for RAS.
To: Andrey Grodzovsky <andrey.grodzovsky@amd.com>,
 amd-gfx@lists.freedesktop.org
References: <1567022426-6612-1-git-send-email-andrey.grodzovsky@amd.com>
From: =?UTF-8?Q?Christian_K=c3=b6nig?= <ckoenig.leichtzumerken@gmail.com>
Message-ID: <85798da5-a4f1-28d3-c80f-9f262743cac9@gmail.com>
Date: Thu, 29 Aug 2019 09:30:38 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <1567022426-6612-1-git-send-email-andrey.grodzovsky@amd.com>
Content-Language: en-US
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=reply-to:subject:to:cc:references:from:message-id:date:user-agent
 :mime-version:in-reply-to:content-transfer-encoding:content-language;
 bh=tbV9DGRgdRkePZWZmOTudgQe6LkvJ7lzanx3zyenrgE=;
 b=W48+dJjHysBQULKf1SEVy8VD9nqP8ZrIQ+82bKypKcUQNf9TBPXmg/geta7MoRGm7y
 DZkb3ZElv5e2vijrUxrTpMdaWv4nSe8RBB/JKclR20AUcEb2edNGE2Cev8A+YSPEdSzz
 lAkq9Zs/L77mzDGa/gsVx5JPOdMuwh6/dFxtxgpkNT90Fy+0s6AUwYT9FtjwfxYGdqzW
 gU+PWTbzH7ByCPV6MKBdwSqfpqTplr9l7vo7EoHx+0FlxcIFd4NDNeuCrM7vaTdZA685
 BWrR11ej+pBNEDkfWzFUaEkxXRLlwNhihb9Au0luMtFYhiKxkSK/EgfWwOmLy/s1JFGj
 hrOw==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Reply-To: christian.koenig@amd.com
Cc: alexdeucher@gmail.com, Hawking.Zhang@amd.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QW0gMjguMDguMTkgdW0gMjI6MDAgc2NocmllYiBBbmRyZXkgR3JvZHpvdnNreToKPiBQcm9ibGVt
Ogo+IFVuZGVyIGNlcnRhaW4gY29uZGl0aW9ucywgd2hlbiBzb21lIElQIGJvY2tzIHRha2UgYSBS
QVMgZXJyb3IsCj4gd2UgY2FuIGdldCBpbnRvIGEgc2l0dWF0aW9uIHdoZXJlIGEgR1BVIHJlc2V0
IGlzIG5vdCBwb3NzaWJsZQo+IGR1ZSB0byBpc3N1ZXMgaW4gUkFTIGluIFNNVS9QU1AuCj4KPiBU
ZW1wb3JhcnkgZml4IHVudGlsIHByb3BlciBzb2x1dGlvbiBpbiBQU1AvU01VIGlzIHJlYWR5Ogo+
IFdoZW4gdW5jb3JyZWN0YWJsZSBlcnJvciBoYXBwZW5zIHRoZSBERiB3aWxsIHVuY29uZGl0aW9u
YWxseQo+IGJyb2FkY2FzdCBlcnJvciBldmVudCBwYWNrZXRzIHRvIGFsbCBpdHMgY2xpZW50cy9z
bGF2ZSB1cG9uCj4gcmVjZWl2aW5nIGZhdGFsIGVycm9yIGV2ZW50IGFuZCBmcmVlemUgYWxsIGl0
cyBvdXRib3VuZCBxdWV1ZXMsCj4gZXJyX2V2ZW50X2F0aHViIGludGVycnVwdCAgd2lsbCBiZSB0
cmlnZ2VyZWQuCj4gSW4gc3VjaCBjYXNlIGFuZCB3ZSB1c2UgdGhpcyBpbnRlcnJ1cHQKPiB0byBp
c3N1ZSBHUFUgcmVzZXQuIFRIZSBHUFUgcmVzZXQgY29kZSBpcyBtb2RpZmllZCBmb3Igc3VjaCBj
YXNlIHRvIGF2b2lkIEhXCj4gcmVzZXQsIG9ubHkgc3RvcHMgc2NoZWR1bGVycywgZGVhdGNoZXMg
YWxsIGluIHByb2dyZXNzIGFuZCBub3QgeWV0IHNjaGVkdWxlZAo+IGpvYidzIGZlbmNlcywgc2V0
IGVycm9yIGNvZGUgb24gdGhlbSBhbmQgc2lnbmFscy4KPiBBbHNvIHJlamVjdCBhbnkgbmV3IGlu
Y29taW5nIGpvYiBzdWJtaXNzaW9ucyBmcm9tIHVzZXIgc3BhY2UuCj4gQWxsIHRoaXMgaXMgZG9u
ZSB0byBub3RpZnkgdGhlIGFwcGxpY2F0aW9ucyBvZiB0aGUgcHJvYmxlbS4KPgo+IFNpZ25lZC1v
ZmYtYnk6IEFuZHJleSBHcm9kem92c2t5IDxhbmRyZXkuZ3JvZHpvdnNreUBhbWQuY29tPgo+IC0t
LQo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMgICAgIHwgIDQgKysK
PiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYyB8IDk4ICsrKysr
KysrKysrKysrKysrKysrKystLS0tLS0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2Rydi5jICAgIHwgIDUgKysKPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9rbXMuYyAgICB8ICA2ICsrCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfcmFzLmMgICAgfCAzMCArKysrKysrLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9yYXMuaCAgICB8IDEyICsrKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2dmeF92OV8wLmMgICAgICB8IDEwICstLQo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
Z21jX3Y5XzAuYyAgICAgIHwgMjQgKysrKy0tLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L25iaW9fdjdfNC5jICAgICB8ICA1ICsrCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9zZG1hX3Y0XzAuYyAgICAgfCAzMiArKysrKy0tLS0tCj4gICAxMCBmaWxlcyBjaGFuZ2VkLCAx
NjQgaW5zZXJ0aW9ucygrKSwgNjIgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfY3MuYwo+IGluZGV4IDlkYTY4MWUuLjMwMGFkYjggMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3MuYwo+IEBAIC0zOCw2ICszOCw3IEBACj4gICAjaW5j
bHVkZSAiYW1kZ3B1X2dtYy5oIgo+ICAgI2luY2x1ZGUgImFtZGdwdV9nZW0uaCIKPiAgICNpbmNs
dWRlICJhbWRncHVfZGlzcGxheS5oIgo+ICsjaW5jbHVkZSAiYW1kZ3B1X3Jhcy5oIgo+ICAgCj4g
ICAjaWYgZGVmaW5lZChIQVZFX0RSTV9GUkVFX0xBUkdFKQo+ICAgI2RlZmluZSBrdmZyZWUgZHJt
X2ZyZWVfbGFyZ2UKPiBAQCAtMTQ2MSw2ICsxNDYyLDkgQEAgaW50IGFtZGdwdV9jc19pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbHAp
Cj4gICAJYm9vbCByZXNlcnZlZF9idWZmZXJzID0gZmFsc2U7Cj4gICAJaW50IGksIHI7Cj4gICAK
PiArCWlmIChhbWRncHVfcmFzX2ludHJfdHJpZ2dlcmVkKCkpCj4gKwkJcmV0dXJuIC1FSFdQT0lT
T047Cj4gKwo+ICAgCWlmICghYWRldi0+YWNjZWxfd29ya2luZykKPiAgIAkJcmV0dXJuIC1FQlVT
WTsKPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
ZGV2aWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMKPiBp
bmRleCAwN2E0YmEwLi4zZWNlZTEwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9kZXZpY2UuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9kZXZpY2UuYwo+IEBAIC0zNzM0LDEwICszNzM0LDEwIEBAIHN0YXRpYyBib29sIGFt
ZGdwdV9kZXZpY2VfbG9ja19hZGV2KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBib29sIHRy
eWxvY2spCj4gICAJcmV0dXJuIHRydWU7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgYW1kZ3B1
X2RldmljZV91bmxvY2tfYWRldihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiArc3RhdGlj
IHZvaWQgYW1kZ3B1X2RldmljZV91bmxvY2tfYWRldihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwgYm9vbCBza2lwX2tmZCkKPiAgIHsKPiAgIAkvKnVubG9jayBrZmQ6IFNSSU9WIHdvdWxkIGRv
IGl0IHNlcGFyYXRlbHkgKi8KPiAtCWlmICghYW1kZ3B1X3NyaW92X3ZmKGFkZXYpKQo+ICsJaWYg
KCFhbWRncHVfc3Jpb3ZfdmYoYWRldikgJiYgIXNraXBfa2ZkKQo+ICAgICAgICAgICAgICAgICAg
IGFtZGdwdV9hbWRrZmRfcG9zdF9yZXNldChhZGV2KTsKCkl0J3MgbW9zdCBsaWtlbHkgYmV0dGVy
IHRvIGNvbXBsZXRlbHkgcmVtb3ZlIHRoZSBjYWxsIHRvIAphbWRncHVfYW1ka2ZkX3Bvc3RfcmVz
ZXQoKSBoZXJlLgoKPiAgIAlhbWRncHVfdmZfZXJyb3JfdHJhbnNfYWxsKGFkZXYpOwo+ICAgCWFk
ZXYtPm1wMV9zdGF0ZSA9IFBQX01QMV9TVEFURV9OT05FOwo+IEBAIC0zNzQ2LDYgKzM3NDYsNDQg
QEAgc3RhdGljIHZvaWQgYW1kZ3B1X2RldmljZV91bmxvY2tfYWRldihzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldikKPiAgIH0KPiAgIAo+ICAgCj4gKyNkZWZpbmUgdG9fZHJtX3NjaGVkX2pvYihz
Y2hlZF9qb2IpCQlcCj4gKwkJY29udGFpbmVyX29mKChzY2hlZF9qb2IpLCBzdHJ1Y3QgZHJtX3Nj
aGVkX2pvYiwgcXVldWVfbm9kZSkKPiArCj4gK3N0YXRpYyB2b2lkIGFtZGdwdV9zdG9wX2FsbF9q
b2JzX29uX3NjaGVkKHN0cnVjdCBkcm1fZ3B1X3NjaGVkdWxlciAqc2NoZWQpCj4gK3sKPiArCXN0
cnVjdCBkcm1fc2NoZWRfam9iICpzX2pvYjsKPiArCXN0cnVjdCBkcm1fc2NoZWRfZW50aXR5ICpz
X2VudGl0eSA9IE5VTEw7Cj4gKwlpbnQgaTsKPiArCj4gKwkvKiBTaWduYWwgYWxsIGpvYnMgbm90
IHlldCBzY2hlZHVsZWQgKi8KPiArCWZvciAoaSA9IERSTV9TQ0hFRF9QUklPUklUWV9NQVggLSAx
OyBpID49IERSTV9TQ0hFRF9QUklPUklUWV9NSU47IGktLSkgewo+ICsJCXN0cnVjdCBkcm1fc2No
ZWRfcnEgKnJxID0gJnNjaGVkLT5zY2hlZF9ycVtpXTsKPiArCj4gKwkJaWYgKCFycSkKPiArCQkJ
Y29udGludWU7Cj4gKwo+ICsJCXNwaW5fbG9jaygmcnEtPmxvY2spOwo+ICsJCWxpc3RfZm9yX2Vh
Y2hfZW50cnkoc19lbnRpdHksICZycS0+ZW50aXRpZXMsIGxpc3QpIHsKPiArCQkJd2hpbGUgKChz
X2pvYiA9IHRvX2RybV9zY2hlZF9qb2Ioc3BzY19xdWV1ZV9wb3AoJnNfZW50aXR5LT5qb2JfcXVl
dWUpKSkpIHsKPiArCQkJCXN0cnVjdCBkcm1fc2NoZWRfZmVuY2UgKnNfZmVuY2UgPSBzX2pvYi0+
c19mZW5jZTsKPiArCj4gKwkJCQlkbWFfZmVuY2Vfc2lnbmFsKCZzX2ZlbmNlLT5zY2hlZHVsZWQp
Owo+ICsJCQkJZG1hX2ZlbmNlX3NldF9lcnJvcigmc19mZW5jZS0+ZmluaXNoZWQsIC1FSFdQT0lT
T04pOwo+ICsJCQkJZG1hX2ZlbmNlX3NpZ25hbCgmc19mZW5jZS0+ZmluaXNoZWQpOwo+ICsJCQl9
Cj4gKwkJfQo+ICsJCXNwaW5fdW5sb2NrKCZycS0+bG9jayk7Cj4gKwl9Cj4gKwo+ICsJLyogU2ln
bmFsIGFsbCBqb2JzIGFscmVhZHkgc2NoZWR1bGVkIHRvIEhXICovCj4gKwlsaXN0X2Zvcl9lYWNo
X2VudHJ5KHNfam9iLCAmc2NoZWQtPnJpbmdfbWlycm9yX2xpc3QsIG5vZGUpIHsKPiArCQlzdHJ1
Y3QgZHJtX3NjaGVkX2ZlbmNlICpzX2ZlbmNlID0gc19qb2ItPnNfZmVuY2U7Cj4gKwo+ICsJCWRt
YV9mZW5jZV9zZXRfZXJyb3IoJnNfZmVuY2UtPmZpbmlzaGVkLCAtRUhXUE9JU09OKTsKPiArCQlk
bWFfZmVuY2Vfc2lnbmFsKCZzX2ZlbmNlLT5maW5pc2hlZCk7Cj4gKwl9Cj4gK30KClRoYXQgbWln
aHQgYmUgYmV0dGVyIHB1dCBpbnRvIGFtZGdwdV9qb2IuYy4KCkFuZCBJIGFzc3VtZSB0aGlzIGlz
IGNhbGxlZCBvbmx5IGR1cmluZyBHUFUgcmVzZXQgd2lsbCB0aGUgc2NoZWR1bGVyIApmdWxseSBz
dG9wcGVkPwoKPiArCj4gICAvKioKPiAgICAqIGFtZGdwdV9kZXZpY2VfZ3B1X3JlY292ZXIgLSBy
ZXNldCB0aGUgYXNpYyBhbmQgcmVjb3ZlciBzY2hlZHVsZXIKPiAgICAqCj4gQEAgLTM3NjUsMTEg
KzM4MDMsMTIgQEAgaW50IGFtZGdwdV9kZXZpY2VfZ3B1X3JlY292ZXIoc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYsCj4gICAJc3RydWN0IGFtZGdwdV9oaXZlX2luZm8gKmhpdmUgPSBOVUxMOwo+
ICAgCXN0cnVjdCBhbWRncHVfZGV2aWNlICp0bXBfYWRldiA9IE5VTEw7Cj4gICAJaW50IGksIHIg
PSAwOwo+ICsJYm9vbCBpbl9yYXNfaW50ciA9IGFtZGdwdV9yYXNfaW50cl90cmlnZ2VyZWQoKTsK
PiAgIAo+ICAgCW5lZWRfZnVsbF9yZXNldCA9IGpvYl9zaWduYWxlZCA9IGZhbHNlOwo+ICAgCUlO
SVRfTElTVF9IRUFEKCZkZXZpY2VfbGlzdCk7Cj4gICAKPiAtCWRldl9pbmZvKGFkZXYtPmRldiwg
IkdQVSByZXNldCBiZWdpbiFcbiIpOwo+ICsJZGV2X2luZm8oYWRldi0+ZGV2LCAiR1BVICVzIGJl
Z2luIVxuIiwgaW5fcmFzX2ludHIgPyAiam9icyBzdG9wIjoicmVzZXQiKTsKPiAgIAo+ICAgCWNh
bmNlbF9kZWxheWVkX3dvcmtfc3luYygmYWRldi0+ZGVsYXllZF9pbml0X3dvcmspOwo+ICAgCj4g
QEAgLTM3OTksNyArMzgzOCw3IEBAIGludCBhbWRncHVfZGV2aWNlX2dwdV9yZWNvdmVyKHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICAgCS8qIEJ1aWxkIGxpc3Qgb2YgZGV2aWNlcyB0byBy
ZXNldCAqLwo+ICAgCWlmICAoYWRldi0+Z21jLnhnbWkubnVtX3BoeXNpY2FsX25vZGVzID4gMSkg
ewo+ICAgCQlpZiAoIWhpdmUpIHsKPiAtCQkJYW1kZ3B1X2RldmljZV91bmxvY2tfYWRldihhZGV2
KTsKPiArCQkJYW1kZ3B1X2RldmljZV91bmxvY2tfYWRldihhZGV2LCBmYWxzZSk7Cj4gICAJCQly
ZXR1cm4gLUVOT0RFVjsKPiAgIAkJfQo+ICAgCj4gQEAgLTM4MjQsNyArMzg2Myw3IEBAIGludCBh
bWRncHVfZGV2aWNlX2dwdV9yZWNvdmVyKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICAg
CS8qIGJsb2NrIGFsbCBzY2hlZHVsZXJzIGFuZCByZXNldCBnaXZlbiBqb2IncyByaW5nICovCj4g
ICAJbGlzdF9mb3JfZWFjaF9lbnRyeSh0bXBfYWRldiwgZGV2aWNlX2xpc3RfaGFuZGxlLCBnbWMu
eGdtaS5oZWFkKSB7Cj4gICAJCS8qIGRpc2FibGUgcmFzIG9uIEFMTCBJUHMgKi8KPiAtCQlpZiAo
YW1kZ3B1X2RldmljZV9pcF9uZWVkX2Z1bGxfcmVzZXQodG1wX2FkZXYpKQo+ICsJCWlmICghaW5f
cmFzX2ludHIgJiYgYW1kZ3B1X2RldmljZV9pcF9uZWVkX2Z1bGxfcmVzZXQodG1wX2FkZXYpKQo+
ICAgCQkJYW1kZ3B1X3Jhc19zdXNwZW5kKHRtcF9hZGV2KTsKPiAgIAo+ICAgCQlmb3IgKGkgPSAw
OyBpIDwgQU1ER1BVX01BWF9SSU5HUzsgKytpKSB7Cj4gQEAgLTM4MzQsMTAgKzM4NzMsMTYgQEAg
aW50IGFtZGdwdV9kZXZpY2VfZ3B1X3JlY292ZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
Cj4gICAJCQkJY29udGludWU7Cj4gICAKPiAgIAkJCWRybV9zY2hlZF9zdG9wKCZyaW5nLT5zY2hl
ZCwgam9iID8gJmpvYi0+YmFzZSA6IE5VTEwpOwo+ICsKPiArCQkJaWYgKGluX3Jhc19pbnRyKQo+
ICsJCQkJYW1kZ3B1X3N0b3BfYWxsX2pvYnNfb25fc2NoZWQoJnJpbmctPnNjaGVkKTsKPiAgIAkJ
fQo+ICAgCX0KPiAgIAo+ICAgCj4gKwlpZiAoaW5fcmFzX2ludHIpCj4gKwkJZ290byBza2lwX2h3
X3Jlc2V0Owo+ICsKPiAgIAkvKgo+ICAgCSAqIE11c3QgY2hlY2sgZ3VpbHR5IHNpZ25hbCBoZXJl
IHNpbmNlIGFmdGVyIHRoaXMgcG9pbnQgYWxsIG9sZAo+ICAgCSAqIEhXIGZlbmNlcyBhcmUgZm9y
Y2Ugc2lnbmFsZWQuCj4gQEAgLTM5MDIsMzQgKzM5NDcsMzcgQEAgaW50IGFtZGdwdV9kZXZpY2Vf
Z3B1X3JlY292ZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4gICAKPiAgIAkvKiBQb3N0
IEFTSUMgcmVzZXQgZm9yIGFsbCBkZXZzIC4qLwo+ICAgCWxpc3RfZm9yX2VhY2hfZW50cnkodG1w
X2FkZXYsIGRldmljZV9saXN0X2hhbmRsZSwgZ21jLnhnbWkuaGVhZCkgewo+IC0JCWZvciAoaSA9
IDA7IGkgPCBBTURHUFVfTUFYX1JJTkdTOyArK2kpIHsKPiAtCQkJc3RydWN0IGFtZGdwdV9yaW5n
ICpyaW5nID0gdG1wX2FkZXYtPnJpbmdzW2ldOwo+ICAgCj4gLQkJCWlmICghcmluZyB8fCAhcmlu
Zy0+c2NoZWQudGhyZWFkKQo+IC0JCQkJY29udGludWU7Cj4gKwkJaWYgKCFpbl9yYXNfaW50cikg
ewoKTWF5YmUgd3JpdGUgaXQgbGlrZSB0aGlzOgoKaWYgKGluX3Jhc19pbnRyKSB7CiDCoMKgwqAg
YW1kZ3B1X2RldmljZV91bmxvY2tfYWRldiguLikKIMKgwqDCoCBjb250aW51ZTsKfQoKT3IgZXZl
biBiZXR0ZXIgdXNlIGEgY29tcGxldGVseSBzZXBhcmF0ZSB1bmxvY2sgbG9vcC4KCkNocmlzdGlh
bi4KCj4gKwkJCWZvciAoaSA9IDA7IGkgPCBBTURHUFVfTUFYX1JJTkdTOyArK2kpIHsKPiArCQkJ
CXN0cnVjdCBhbWRncHVfcmluZyAqcmluZyA9IHRtcF9hZGV2LT5yaW5nc1tpXTsKPiAgIAo+IC0J
CQkvKiBObyBwb2ludCB0byByZXN1Ym1pdCBqb2JzIGlmIHdlIGRpZG4ndCBIVyByZXNldCovCj4g
LQkJCWlmICghdG1wX2FkZXYtPmFzaWNfcmVzZXRfcmVzICYmICFqb2Jfc2lnbmFsZWQpCj4gLQkJ
CQlkcm1fc2NoZWRfcmVzdWJtaXRfam9icygmcmluZy0+c2NoZWQpOwo+ICsJCQkJaWYgKCFyaW5n
IHx8ICFyaW5nLT5zY2hlZC50aHJlYWQpCj4gKwkJCQkJY29udGludWU7Cj4gICAKPiAtCQkJZHJt
X3NjaGVkX3N0YXJ0KCZyaW5nLT5zY2hlZCwgIXRtcF9hZGV2LT5hc2ljX3Jlc2V0X3Jlcyk7Cj4g
LQkJfQo+ICsJCQkJLyogTm8gcG9pbnQgdG8gcmVzdWJtaXQgam9icyBpZiB3ZSBkaWRuJ3QgSFcg
cmVzZXQqLwo+ICsJCQkJaWYgKCF0bXBfYWRldi0+YXNpY19yZXNldF9yZXMgJiYgIWpvYl9zaWdu
YWxlZCkKPiArCQkJCQlkcm1fc2NoZWRfcmVzdWJtaXRfam9icygmcmluZy0+c2NoZWQpOwo+ICAg
Cj4gLQkJaWYgKCFhbWRncHVfZGV2aWNlX2hhc19kY19zdXBwb3J0KHRtcF9hZGV2KSAmJiAham9i
X3NpZ25hbGVkKSB7Cj4gLQkJCWRybV9oZWxwZXJfcmVzdW1lX2ZvcmNlX21vZGUodG1wX2FkZXYt
PmRkZXYpOwo+IC0JCX0KPiArCQkJCWRybV9zY2hlZF9zdGFydCgmcmluZy0+c2NoZWQsICF0bXBf
YWRldi0+YXNpY19yZXNldF9yZXMpOwo+ICsJCQl9Cj4gICAKPiAtCQl0bXBfYWRldi0+YXNpY19y
ZXNldF9yZXMgPSAwOwo+ICsJCQlpZiAoIWFtZGdwdV9kZXZpY2VfaGFzX2RjX3N1cHBvcnQodG1w
X2FkZXYpICYmICFqb2Jfc2lnbmFsZWQpIHsKPiArCQkJCWRybV9oZWxwZXJfcmVzdW1lX2ZvcmNl
X21vZGUodG1wX2FkZXYtPmRkZXYpOwo+ICsJCQl9Cj4gICAKPiAtCQlpZiAocikgewo+IC0JCQkv
KiBiYWQgbmV3cywgaG93IHRvIHRlbGwgaXQgdG8gdXNlcnNwYWNlID8gKi8KPiAtCQkJZGV2X2lu
Zm8odG1wX2FkZXYtPmRldiwgIkdQVSByZXNldCglZCkgZmFpbGVkXG4iLCBhdG9taWNfcmVhZCgm
YWRldi0+Z3B1X3Jlc2V0X2NvdW50ZXIpKTsKPiAtCQkJYW1kZ3B1X3ZmX2Vycm9yX3B1dCh0bXBf
YWRldiwgQU1ER0lNX0VSUk9SX1ZGX0dQVV9SRVNFVF9GQUlMLCAwLCByKTsKPiAtCQl9IGVsc2Ug
ewo+IC0JCQlkZXZfaW5mbyh0bXBfYWRldi0+ZGV2LCAiR1BVIHJlc2V0KCVkKSBzdWNjZWVkZWQh
XG4iLCBhdG9taWNfcmVhZCgmYWRldi0+Z3B1X3Jlc2V0X2NvdW50ZXIpKTsKPiArCQkJdG1wX2Fk
ZXYtPmFzaWNfcmVzZXRfcmVzID0gMDsKPiArCj4gKwkJCWlmIChyKSB7Cj4gKwkJCQkvKiBiYWQg
bmV3cywgaG93IHRvIHRlbGwgaXQgdG8gdXNlcnNwYWNlID8gKi8KPiArCQkJCWRldl9pbmZvKHRt
cF9hZGV2LT5kZXYsICJHUFUgcmVzZXQoJWQpIGZhaWxlZFxuIiwgYXRvbWljX3JlYWQoJmFkZXYt
PmdwdV9yZXNldF9jb3VudGVyKSk7Cj4gKwkJCQlhbWRncHVfdmZfZXJyb3JfcHV0KHRtcF9hZGV2
LCBBTURHSU1fRVJST1JfVkZfR1BVX1JFU0VUX0ZBSUwsIDAsIHIpOwo+ICsJCQl9IGVsc2Ugewo+
ICsJCQkJZGV2X2luZm8odG1wX2FkZXYtPmRldiwgIkdQVSByZXNldCglZCkgc3VjY2VlZGVkIVxu
IiwgYXRvbWljX3JlYWQoJmFkZXYtPmdwdV9yZXNldF9jb3VudGVyKSk7Cj4gKwkJCX0KPiAgIAkJ
fQo+ICAgCj4gLQkJYW1kZ3B1X2RldmljZV91bmxvY2tfYWRldih0bXBfYWRldik7Cj4gKwkJYW1k
Z3B1X2RldmljZV91bmxvY2tfYWRldih0bXBfYWRldiwgaW5fcmFzX2ludHIpOwo+ICAgCX0KPiAg
IAo+ICAgCWlmIChoaXZlKQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHJ2LmMK
PiBpbmRleCAxNTFkN2YyLi43NTdmZDZkIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9kcnYuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9kcnYuYwo+IEBAIC00MCw2ICs0MCw4IEBACj4gICAKPiAgICNpbmNsdWRlICJhbWRn
cHVfYW1ka2ZkLmgiCj4gICAKPiArI2luY2x1ZGUgImFtZGdwdV9yYXMuaCIKPiArCj4gICAvKgo+
ICAgICogS01TIHdyYXBwZXIuCj4gICAgKiAtIDMuMC4wIC0gaW5pdGlhbCBkcml2ZXIKPiBAQCAt
MTE3OSw2ICsxMTgxLDkgQEAgYW1kZ3B1X3BjaV9zaHV0ZG93bihzdHJ1Y3QgcGNpX2RldiAqcGRl
dikKPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBkZXYpOwo+
ICAgCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gZGV2LT5kZXZfcHJpdmF0ZTsKPiAgIAo+
ICsJaWYgKGFtZGdwdV9yYXNfaW50cl90cmlnZ2VyZWQoKSkKPiArCQlyZXR1cm47Cj4gKwo+ICAg
CS8qIGlmIHdlIGFyZSBydW5uaW5nIGluIGEgVk0sIG1ha2Ugc3VyZSB0aGUgZGV2aWNlCj4gICAJ
ICogdG9ybiBkb3duIHByb3Blcmx5IG9uIHJlYm9vdC9zaHV0ZG93bi4KPiAgIAkgKiB1bmZvcnR1
bmF0ZWx5IHdlIGNhbid0IGRldGVjdCBjZXJ0YWluCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9rbXMuYwo+IGluZGV4IGRhMjE0M2QuLmNlZDc2NmMgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ttcy5jCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ttcy5jCj4gQEAgLTEwNDYsNiArMTA0NiwxMiBAQCBpbnQg
YW1kZ3B1X2RyaXZlcl9vcGVuX2ttcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGVfcHJpdikKPiAgIAkvKiBFbnN1cmUgSUIgdGVzdHMgYXJlIHJ1biBvbiByaW5n
ICovCj4gICAJZmx1c2hfZGVsYXllZF93b3JrKCZhZGV2LT5kZWxheWVkX2luaXRfd29yayk7Cj4g
ICAKPiArCj4gKwlpZiAoYW1kZ3B1X3Jhc19pbnRyX3RyaWdnZXJlZCgpKSB7Cj4gKwkJRFJNX0VS
Uk9SKCJSQVMgSW50ciB0cmlnZ2VyZWQsIGRldmljZSBkaXNhYmxlZCEhIik7Cj4gKwkJcmV0dXJu
IC1FSFdQT0lTT047Cj4gKwl9Cj4gKwo+ICAgCWZpbGVfcHJpdi0+ZHJpdmVyX3ByaXYgPSBOVUxM
Owo+ICAgCj4gICAJciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGV2LT5kZXYpOwo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmFzLmMgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmFzLmMKPiBpbmRleCAyZDU4OTdhLi4wODZlNmRmIDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuYwo+IEBAIC0yNCw2ICsy
NCw4IEBACj4gICAjaW5jbHVkZSA8bGludXgvZGVidWdmcy5oPgo+ICAgI2luY2x1ZGUgPGxpbnV4
L2xpc3QuaD4KPiAgICNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KPiArI2luY2x1ZGUgPGxpbnV4
L3JlYm9vdC5oPgo+ICsjaW5jbHVkZSA8bGludXgvc3lzY2FsbHMuaD4KPiAgICNpbmNsdWRlICJh
bWRncHUuaCIKPiAgICNpbmNsdWRlICJhbWRncHVfcmFzLmgiCj4gICAjaW5jbHVkZSAiYW1kZ3B1
X2F0b21maXJtd2FyZS5oIgo+IEBAIC02NCw2ICs2Niw5IEBAIGNvbnN0IGNoYXIgKnJhc19ibG9j
a19zdHJpbmdbXSA9IHsKPiAgIC8qIGluamVjdCBhZGRyZXNzIGlzIDUyIGJpdHMgKi8KPiAgICNk
ZWZpbmUJUkFTX1VNQ19JTkpFQ1RfQUREUl9MSU1JVAkoMHgxVUxMIDw8IDUyKQo+ICAgCj4gKwo+
ICthdG9taWNfdCBhbWRncHVfcmFzX2luX2ludHIgPSBBVE9NSUNfSU5JVCgwKTsKPiArCj4gICBz
dGF0aWMgaW50IGFtZGdwdV9yYXNfcmVzZXJ2ZV92cmFtKHN0cnVjdCBhbWRncHVfZGV2aWNlICph
ZGV2LAo+ICAgCQl1aW50NjRfdCBvZmZzZXQsIHVpbnQ2NF90IHNpemUsCj4gICAJCXN0cnVjdCBh
bWRncHVfYm8gKipib19wdHIpOwo+IEBAIC04MCw3ICs4NSw3IEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9yYXNfZGVidWdmc19yZWFkKHN0cnVjdCBmaWxlICpmLCBjaGFyIF9fdXNlciAqYnVmLAo+
ICAgCXNzaXplX3QgczsKPiAgIAljaGFyIHZhbFsxMjhdOwo+ICAgCj4gLQlpZiAoYW1kZ3B1X3Jh
c19lcnJvcl9xdWVyeShvYmotPmFkZXYsICZpbmZvKSkKPiArCWlmIChhbWRncHVfcmFzX2Vycm9y
X3F1ZXJ5KG9iai0+YWRldiwgJmluZm8sIGZhbHNlKSkKPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4g
ICAKPiAgIAlzID0gc25wcmludGYodmFsLCBzaXplb2YodmFsKSwgIiVzOiAlbHVcbiVzOiAlbHVc
biIsCj4gQEAgLTE4OCw2ICsxOTMsMTAgQEAgc3RhdGljIGludCBhbWRncHVfcmFzX2RlYnVnZnNf
Y3RybF9wYXJzZV9kYXRhKHN0cnVjdCBmaWxlICpmLAo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICB9
Cj4gKwo+ICtzdGF0aWMgc3RydWN0IHJhc19tYW5hZ2VyICphbWRncHVfcmFzX2ZpbmRfb2JqKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICsJCXN0cnVjdCByYXNfY29tbW9uX2lmICpoZWFk
KTsKPiArCj4gICAvKioKPiAgICAqIERPQzogQU1ER1BVIFJBUyBkZWJ1Z2ZzIGNvbnRyb2wgaW50
ZXJmYWNlCj4gICAgKgo+IEBAIC0zMDQsNyArMzEzLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X3Jhc19zeXNmc19yZWFkKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJLmhlYWQgPSBvYmotPmhl
YWQsCj4gICAJfTsKPiAgIAo+IC0JaWYgKGFtZGdwdV9yYXNfZXJyb3JfcXVlcnkob2JqLT5hZGV2
LCAmaW5mbykpCj4gKwlpZiAoYW1kZ3B1X3Jhc19lcnJvcl9xdWVyeShvYmotPmFkZXYsICZpbmZv
LCBmYWxzZSkpCj4gICAJCXJldHVybiAtRUlOVkFMOwo+ICAgCj4gICAJcmV0dXJuIHNucHJpbnRm
KGJ1ZiwgUEFHRV9TSVpFLCAiJXM6ICVsdVxuJXM6ICVsdVxuIiwKPiBAQCAtNTkxLDcgKzYwMCw3
IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3Jhc19lbmFibGVfYWxsX2ZlYXR1cmVzKHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2LAo+ICAgCj4gICAvKiBxdWVyeS9pbmplY3QvY3VyZSBiZWdpbiAqLwo+
ICAgaW50IGFtZGdwdV9yYXNfZXJyb3JfcXVlcnkoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
Cj4gLQkJc3RydWN0IHJhc19xdWVyeV9pZiAqaW5mbykKPiArCQlzdHJ1Y3QgcmFzX3F1ZXJ5X2lm
ICppbmZvLCBib29sIHByaW50KQo+ICAgewo+ICAgCXN0cnVjdCByYXNfbWFuYWdlciAqb2JqID0g
YW1kZ3B1X3Jhc19maW5kX29iaihhZGV2LCAmaW5mby0+aGVhZCk7Cj4gICAJc3RydWN0IHJhc19l
cnJfZGF0YSBlcnJfZGF0YSA9IHswLCAwLCAwLCBOVUxMfTsKPiBAQCAtNjI3LDEyICs2MzYsMTQg
QEAgaW50IGFtZGdwdV9yYXNfZXJyb3JfcXVlcnkoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
Cj4gICAJaW5mby0+dWVfY291bnQgPSBvYmotPmVycl9kYXRhLnVlX2NvdW50Owo+ICAgCWluZm8t
PmNlX2NvdW50ID0gb2JqLT5lcnJfZGF0YS5jZV9jb3VudDsKPiAgIAo+IC0JaWYgKGVycl9kYXRh
LmNlX2NvdW50KQo+ICsJaWYgKGVycl9kYXRhLmNlX2NvdW50IHx8IHByaW50KSB7Cj4gICAJCWRl
dl9pbmZvKGFkZXYtPmRldiwgIiVsZCBjb3JyZWN0YWJsZSBlcnJvcnMgZGV0ZWN0ZWQgaW4gJXMg
YmxvY2tcbiIsCj4gICAJCQkgb2JqLT5lcnJfZGF0YS5jZV9jb3VudCwgcmFzX2Jsb2NrX3N0cihp
bmZvLT5oZWFkLmJsb2NrKSk7Cj4gLQlpZiAoZXJyX2RhdGEudWVfY291bnQpCj4gKwl9Cj4gKwlp
ZiAoZXJyX2RhdGEudWVfY291bnQgfHwgcHJpbnQpIHsKPiAgIAkJZGV2X2luZm8oYWRldi0+ZGV2
LCAiJWxkIHVuY29ycmVjdGFibGUgZXJyb3JzIGRldGVjdGVkIGluICVzIGJsb2NrXG4iLAo+ICAg
CQkJIG9iai0+ZXJyX2RhdGEudWVfY291bnQsIHJhc19ibG9ja19zdHIoaW5mby0+aGVhZC5ibG9j
aykpOwo+ICsJfQo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICB9Cj4gQEAgLTcwMiw3ICs3MTMsNyBA
QCBpbnQgYW1kZ3B1X3Jhc19xdWVyeV9lcnJvcl9jb3VudChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiwKPiAgIAkJCS5oZWFkID0gb2JqLT5oZWFkLAo+ICAgCQl9Owo+ICAgCj4gLQkJaWYgKGFt
ZGdwdV9yYXNfZXJyb3JfcXVlcnkoYWRldiwgJmluZm8pKQo+ICsJCWlmIChhbWRncHVfcmFzX2Vy
cm9yX3F1ZXJ5KGFkZXYsICZpbmZvLCB0cnVlKSkKPiAgIAkJCXJldHVybiAtRUlOVkFMOwo+ICAg
Cj4gICAJCWRhdGEuY2VfY291bnQgKz0gaW5mby5jZV9jb3VudDsKPiBAQCAtMTcxOCwzICsxNzI5
LDEwIEBAIGludCBhbWRncHVfcmFzX2Zpbmkoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4g
ICAKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiArCj4gK3ZvaWQgYW1kZ3B1X3Jhc19nbG9iYWxfcmFz
X2lzcihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiArewo+ICsJaWYgKGF0b21pY19jbXB4
Y2hnKCZhbWRncHVfcmFzX2luX2ludHIsIDAsIDEpID09IDApIHsKPiArCQlEUk1fV0FSTigiUkFT
IGV2ZW50IG9mIHR5cGUgRVJSRVZFTlRfQVRIVUJfSU5URVJSVVBUIGRldGVjdGVkISBTdG9wcGlu
ZyBhbGwgR1BVIGpvYnMuXG4iKTsKPiArCX0KPiArfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmFzLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfcmFzLmgKPiBpbmRleCA1YTBkZjczLi5jMGUyMmFmIDEwMDY0NAo+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuaAo+IEBAIC01ODcsNyArNTg3LDcgQEAgdm9pZCBh
bWRncHVfcmFzX2RlYnVnZnNfcmVtb3ZlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICAg
CQlzdHJ1Y3QgcmFzX2NvbW1vbl9pZiAqaGVhZCk7Cj4gICAKPiAgIGludCBhbWRncHVfcmFzX2Vy
cm9yX3F1ZXJ5KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+IC0JCXN0cnVjdCByYXNfcXVl
cnlfaWYgKmluZm8pOwo+ICsJCXN0cnVjdCByYXNfcXVlcnlfaWYgKmluZm8sIGJvb2wgcHJpbnQp
Owo+ICAgCj4gICBpbnQgYW1kZ3B1X3Jhc19lcnJvcl9pbmplY3Qoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsCj4gICAJCXN0cnVjdCByYXNfaW5qZWN0X2lmICppbmZvKTsKPiBAQCAtNjAwLDQg
KzYwMCwxNCBAQCBpbnQgYW1kZ3B1X3Jhc19pbnRlcnJ1cHRfcmVtb3ZlX2hhbmRsZXIoc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4gICAKPiAgIGludCBhbWRncHVfcmFzX2ludGVycnVwdF9k
aXNwYXRjaChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgIAkJc3RydWN0IHJhc19kaXNw
YXRjaF9pZiAqaW5mbyk7Cj4gKwo+ICtleHRlcm4gYXRvbWljX3QgYW1kZ3B1X3Jhc19pbl9pbnRy
Owo+ICsKPiArc3RhdGljIGlubGluZSBib29sIGFtZGdwdV9yYXNfaW50cl90cmlnZ2VyZWQodm9p
ZCkKPiArewo+ICsJcmV0dXJuICEhYXRvbWljX3JlYWQoJmFtZGdwdV9yYXNfaW5faW50cik7Cj4g
K30KPiArCj4gK3ZvaWQgYW1kZ3B1X3Jhc19nbG9iYWxfcmFzX2lzcihzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldik7Cj4gKwo+ICAgI2VuZGlmCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2dmeF92OV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhf
djlfMC5jCj4gaW5kZXggYjJjODZhMC4uZTdhODNmNiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvZ2Z4X3Y5XzAuYwo+IEBAIC01NjY5LDEwICs1NjY5LDEyIEBAIHN0YXRpYyBpbnQgZ2Z4
X3Y5XzBfcHJvY2Vzc19yYXNfZGF0YV9jYihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAg
IAkJc3RydWN0IGFtZGdwdV9pdl9lbnRyeSAqZW50cnkpCj4gICB7Cj4gICAJLyogVE9ETyB1ZSB3
aWxsIHRyaWdnZXIgYW4gaW50ZXJydXB0LiAqLwo+IC0Ja2dkMmtmZF9zZXRfc3JhbV9lY2NfZmxh
ZyhhZGV2LT5rZmQuZGV2KTsKPiAtCWlmIChhZGV2LT5nZnguZnVuY3MtPnF1ZXJ5X3Jhc19lcnJv
cl9jb3VudCkKPiAtCQlhZGV2LT5nZnguZnVuY3MtPnF1ZXJ5X3Jhc19lcnJvcl9jb3VudChhZGV2
LCBlcnJfZGF0YSk7Cj4gLQlhbWRncHVfcmFzX3Jlc2V0X2dwdShhZGV2LCAwKTsKPiArCWlmICgh
YW1kZ3B1X3Jhc19pc19zdXBwb3J0ZWQoYWRldiwgQU1ER1BVX1JBU19CTE9DS19fR0ZYKSkgewo+
ICsJCWtnZDJrZmRfc2V0X3NyYW1fZWNjX2ZsYWcoYWRldi0+a2ZkLmRldik7Cj4gKwkJaWYgKGFk
ZXYtPmdmeC5mdW5jcy0+cXVlcnlfcmFzX2Vycm9yX2NvdW50KQo+ICsJCQlhZGV2LT5nZnguZnVu
Y3MtPnF1ZXJ5X3Jhc19lcnJvcl9jb3VudChhZGV2LCBlcnJfZGF0YSk7Cj4gKwkJYW1kZ3B1X3Jh
c19yZXNldF9ncHUoYWRldiwgMCk7Cj4gKwl9Cj4gICAJcmV0dXJuIEFNREdQVV9SQVNfU1VDQ0VT
UzsKPiAgIH0KPiAgIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9n
bWNfdjlfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAuYwo+IGluZGV4
IDQzYjRmYmMuLjg3YTY2YzIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvZ21jX3Y5XzAuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8w
LmMKPiBAQCAtMjQzLDE4ICsyNDMsMjAgQEAgc3RhdGljIGludCBnbWNfdjlfMF9wcm9jZXNzX3Jh
c19kYXRhX2NiKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICAgCQlzdHJ1Y3QgcmFzX2Vy
cl9kYXRhICplcnJfZGF0YSwKPiAgIAkJc3RydWN0IGFtZGdwdV9pdl9lbnRyeSAqZW50cnkpCj4g
ICB7Cj4gLQlrZ2Qya2ZkX3NldF9zcmFtX2VjY19mbGFnKGFkZXYtPmtmZC5kZXYpOwo+IC0JaWYg
KGFkZXYtPnVtYy5mdW5jcy0+cXVlcnlfcmFzX2Vycm9yX2NvdW50KQo+IC0JCWFkZXYtPnVtYy5m
dW5jcy0+cXVlcnlfcmFzX2Vycm9yX2NvdW50KGFkZXYsIGVycl9kYXRhKTsKPiAtCS8qIHVtYyBx
dWVyeV9yYXNfZXJyb3JfYWRkcmVzcyBpcyBhbHNvIHJlc3BvbnNpYmxlIGZvciBjbGVhcmluZwo+
IC0JICogZXJyb3Igc3RhdHVzCj4gLQkgKi8KPiAtCWlmIChhZGV2LT51bWMuZnVuY3MtPnF1ZXJ5
X3Jhc19lcnJvcl9hZGRyZXNzKQo+IC0JCWFkZXYtPnVtYy5mdW5jcy0+cXVlcnlfcmFzX2Vycm9y
X2FkZHJlc3MoYWRldiwgZXJyX2RhdGEpOwo+ICsJaWYgKCFhbWRncHVfcmFzX2lzX3N1cHBvcnRl
ZChhZGV2LCBBTURHUFVfUkFTX0JMT0NLX19HRlgpKSB7Cj4gKwkJa2dkMmtmZF9zZXRfc3JhbV9l
Y2NfZmxhZyhhZGV2LT5rZmQuZGV2KTsKPiArCQlpZiAoYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9y
YXNfZXJyb3JfY291bnQpCj4gKwkJCWFkZXYtPnVtYy5mdW5jcy0+cXVlcnlfcmFzX2Vycm9yX2Nv
dW50KGFkZXYsIGVycl9kYXRhKTsKPiArCQkvKiB1bWMgcXVlcnlfcmFzX2Vycm9yX2FkZHJlc3Mg
aXMgYWxzbyByZXNwb25zaWJsZSBmb3IgY2xlYXJpbmcKPiArCQkgKiBlcnJvciBzdGF0dXMKPiAr
CQkgKi8KPiArCQlpZiAoYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9yYXNfZXJyb3JfYWRkcmVzcykK
PiArCQkJYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9yYXNfZXJyb3JfYWRkcmVzcyhhZGV2LCBlcnJf
ZGF0YSk7Cj4gICAKPiAtCS8qIG9ubHkgdW5jb3JyZWN0YWJsZSBlcnJvciBuZWVkcyBncHUgcmVz
ZXQgKi8KPiAtCWlmIChlcnJfZGF0YS0+dWVfY291bnQpCj4gLQkJYW1kZ3B1X3Jhc19yZXNldF9n
cHUoYWRldiwgMCk7Cj4gKwkJLyogb25seSB1bmNvcnJlY3RhYmxlIGVycm9yIG5lZWRzIGdwdSBy
ZXNldCAqLwo+ICsJCWlmIChlcnJfZGF0YS0+dWVfY291bnQpCj4gKwkJCWFtZGdwdV9yYXNfcmVz
ZXRfZ3B1KGFkZXYsIDApOwo+ICsJfQo+ICAgCj4gICAJcmV0dXJuIEFNREdQVV9SQVNfU1VDQ0VT
UzsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbmJpb192
N180LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9uYmlvX3Y3XzQuYwo+IGluZGV4IDM2
N2Y5ZDYuLjU0NTk5MGMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
bmJpb192N180LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9uYmlvX3Y3XzQu
Ywo+IEBAIC0zMCw2ICszMCw3IEBACj4gICAjaW5jbHVkZSAibmJpby9uYmlvXzdfNF8wX3Ntbi5o
Igo+ICAgI2luY2x1ZGUgIml2c3JjaWQvbmJpby9pcnFzcmNzX25iaWZfN180LmgiCj4gICAjaW5j
bHVkZSA8dWFwaS9saW51eC9rZmRfaW9jdGwuaD4KPiArI2luY2x1ZGUgImFtZGdwdV9yYXMuaCIK
PiAgIAo+ICAgI2RlZmluZSBzbW5OQklGX01HQ0dfQ1RSTF9MQ0xLCTB4MTAxM2EyMWMKPiAgIAo+
IEBAIC0zMjksNiArMzMwLDggQEAgc3RhdGljIHZvaWQgbmJpb192N180X2hhbmRsZV9yYXNfY29u
dHJvbGxlcl9pbnRyX25vX2JpZnJpbmcoc3RydWN0IGFtZGdwdV9kZXZpY2UKPiAgIAkJCQkJCUJJ
Rl9ET09SQkVMTF9JTlRfQ05UTCwKPiAgIAkJCQkJCVJBU19DTlRMUl9JTlRFUlJVUFRfQ0xFQVIs
IDEpOwo+ICAgCQlXUkVHMzJfU09DMTUoTkJJTywgMCwgbW1CSUZfRE9PUkJFTExfSU5UX0NOVEws
IGJpZl9kb29yYmVsbF9pbnRyX2NudGwpOwo+ICsKPiArCQlhbWRncHVfcmFzX2dsb2JhbF9yYXNf
aXNyKGFkZXYpOwo+ICAgCX0KPiAgIH0KPiAgIAo+IEBAIC0zNDQsNiArMzQ3LDggQEAgc3RhdGlj
IHZvaWQgbmJpb192N180X2hhbmRsZV9yYXNfZXJyX2V2ZW50X2F0aHViX2ludHJfbm9fYmlmcmlu
ZyhzdHJ1Y3QgYW1kZ3B1X2QKPiAgIAkJCQkJCUJJRl9ET09SQkVMTF9JTlRfQ05UTCwKPiAgIAkJ
CQkJCVJBU19BVEhVQl9FUlJfRVZFTlRfSU5URVJSVVBUX0NMRUFSLCAxKTsKPiAgIAkJV1JFRzMy
X1NPQzE1KE5CSU8sIDAsIG1tQklGX0RPT1JCRUxMX0lOVF9DTlRMLCBiaWZfZG9vcmJlbGxfaW50
cl9jbnRsKTsKPiArCj4gKwkJYW1kZ3B1X3Jhc19nbG9iYWxfcmFzX2lzcihhZGV2KTsKPiAgIAl9
Cj4gICB9Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc2Rt
YV92NF8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zZG1hX3Y0XzAuYwo+IGluZGV4
IDk1NjQzMmYuLjQzOGU1MDQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvc2RtYV92NF8wLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zZG1hX3Y0
XzAuYwo+IEBAIC0xOTcyLDI0ICsxOTcyLDI2IEBAIHN0YXRpYyBpbnQgc2RtYV92NF8wX3Byb2Nl
c3NfcmFzX2RhdGFfY2Ioc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4gICAJdWludDMyX3Qg
ZXJyX3NvdXJjZTsKPiAgIAlpbnQgaW5zdGFuY2U7Cj4gICAKPiAtCWluc3RhbmNlID0gc2RtYV92
NF8wX2lycV9pZF90b19zZXEoZW50cnktPmNsaWVudF9pZCk7Cj4gLQlpZiAoaW5zdGFuY2UgPCAw
KQo+IC0JCXJldHVybiAwOwo+ICsJaWYgKCFhbWRncHVfcmFzX2lzX3N1cHBvcnRlZChhZGV2LCBB
TURHUFVfUkFTX0JMT0NLX19HRlgpKSB7Cj4gKwkJaW5zdGFuY2UgPSBzZG1hX3Y0XzBfaXJxX2lk
X3RvX3NlcShlbnRyeS0+Y2xpZW50X2lkKTsKPiArCQlpZiAoaW5zdGFuY2UgPCAwKQo+ICsJCQly
ZXR1cm4gMDsKPiAgIAo+IC0Jc3dpdGNoIChlbnRyeS0+c3JjX2lkKSB7Cj4gLQljYXNlIFNETUEw
XzRfMF9fU1JDSURfX1NETUFfU1JBTV9FQ0M6Cj4gLQkJZXJyX3NvdXJjZSA9IDA7Cj4gLQkJYnJl
YWs7Cj4gLQljYXNlIFNETUEwXzRfMF9fU1JDSURfX1NETUFfRUNDOgo+IC0JCWVycl9zb3VyY2Ug
PSAxOwo+IC0JCWJyZWFrOwo+IC0JZGVmYXVsdDoKPiAtCQlyZXR1cm4gMDsKPiAtCX0KPiArCQlz
d2l0Y2ggKGVudHJ5LT5zcmNfaWQpIHsKPiArCQljYXNlIFNETUEwXzRfMF9fU1JDSURfX1NETUFf
U1JBTV9FQ0M6Cj4gKwkJCWVycl9zb3VyY2UgPSAwOwo+ICsJCQlicmVhazsKPiArCQljYXNlIFNE
TUEwXzRfMF9fU1JDSURfX1NETUFfRUNDOgo+ICsJCQllcnJfc291cmNlID0gMTsKPiArCQkJYnJl
YWs7Cj4gKwkJZGVmYXVsdDoKPiArCQkJcmV0dXJuIDA7Cj4gKwkJfQo+ICAgCj4gLQlrZ2Qya2Zk
X3NldF9zcmFtX2VjY19mbGFnKGFkZXYtPmtmZC5kZXYpOwo+ICsJCWtnZDJrZmRfc2V0X3NyYW1f
ZWNjX2ZsYWcoYWRldi0+a2ZkLmRldik7Cj4gICAKPiAtCWFtZGdwdV9yYXNfcmVzZXRfZ3B1KGFk
ZXYsIDApOwo+ICsJCWFtZGdwdV9yYXNfcmVzZXRfZ3B1KGFkZXYsIDApOwo+ICsJfQo+ICAgCj4g
ICAJcmV0dXJuIEFNREdQVV9SQVNfU1VDQ0VTUzsKPiAgIH0KCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vYW1kLWdmeA==
