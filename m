Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8D32569E2B
	for <lists+amd-gfx@lfdr.de>; Mon, 15 Jul 2019 23:25:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 182EE89F41;
	Mon, 15 Jul 2019 21:25:40 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qk1-x743.google.com (mail-qk1-x743.google.com
 [IPv6:2607:f8b0:4864:20::743])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 83B3589F41
 for <amd-gfx@lists.freedesktop.org>; Mon, 15 Jul 2019 21:25:37 +0000 (UTC)
Received: by mail-qk1-x743.google.com with SMTP id m14so12828139qka.10
 for <amd-gfx@lists.freedesktop.org>; Mon, 15 Jul 2019 14:25:37 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=dc5n+jhDd8c2qPKUFEo6enCPor3j7HCfHhImynPB/kI=;
 b=POCuNsOMzt1k3XFwcreoERTyS4KvkBvXDz0MJmkrXBNxF/JzKmMs+adxUMWXyIxrBg
 9Y/IWB7TBM9fRqVvL+1n4NCdNCDlQYI2h2r72RKFf2PgkvYvH6afAQOVIem6ZP4l3zOC
 iGTqTyAh1NLD8WBfO3IV1dIUNRk8gJo7drsRsqC7flWDcVdU67ZPuN/5a9OE/ON7+tBG
 u5AcHhIO/+xxlRBvDWfz4D5oG7YTLq7wYL1QsRu297FlPOOoCX3Q47d7mOoVS5sfW0gP
 RmPsanZQ/XQAZee2Wz1VuODd9nVCZpt82893u1dqzRl2pnOfj7KEQZ4jcNpU5cAnpmQz
 mguw==
X-Gm-Message-State: APjAAAXp7HS/DaThCOcdw/6/ZzRxxruhqr0KpVWhHnW1aa53lLt3dIQL
 +Q2AvxLxPTk8Oia0JMWvQBJkD4FB
X-Google-Smtp-Source: APXvYqzjd80kB8FmXV+EWyWePQaNkAdU6Os5MhnG8fqTQ4XSV/KHECEUvZZbdzOoIf9YCR38v/4PMg==
X-Received: by 2002:a37:b843:: with SMTP id i64mr17721631qkf.77.1563225936365; 
 Mon, 15 Jul 2019 14:25:36 -0700 (PDT)
Received: from localhost.localdomain ([71.219.21.119])
 by smtp.gmail.com with ESMTPSA id q56sm10274133qtq.64.2019.07.15.14.25.35
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 15 Jul 2019 14:25:35 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 058/102] drm/amdgpu: add VCN2.5 basic supports
Date: Mon, 15 Jul 2019 16:23:53 -0500
Message-Id: <20190715212437.31793-56-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190715212437.31793-1-alexander.deucher@amd.com>
References: <20190715212437.31793-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=dc5n+jhDd8c2qPKUFEo6enCPor3j7HCfHhImynPB/kI=;
 b=b1zGLeaOWO9FGzuXHMbbQFrgIuV3GBUvUgAvSSRnnN5crZZlvcSrM6LEja59dYeCoY
 YlFFbpexdKPbd3i//UHUxgtKAUNif7mqqFmMBfACStJzIm6HUgp/u6JxC7/s0GMg1gUx
 9ea3Eaj8Zo1oKFnKqrTH4wZs/b0xt0GtRYYrNptkhWsrY7tGEEl4eTZhDEro+Bt048qu
 1i+IjrFIh+P6SjGlnwMfjmBsSTe/sxul6XfMFbngnLQf4GmO6xgOXa7U/DkIBEtM6yDO
 ZntJRzMLlel5UNegoXzsl2RxQ520vmRAjlpgnIS40fbMS41zRzQIwZoW+NfuwAX/eKlL
 vhYg==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>, Leo Liu <leo.liu@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogTGVvIExpdSA8bGVvLmxpdUBhbWQuY29tPgoKaS5lLiBiYXNpYyBWQ04gSVAgU1cgc3Ry
dWN0dXJlcwoKU2lnbmVkLW9mZi1ieTogTGVvIExpdSA8bGVvLmxpdUBhbWQuY29tPgpSZXZpZXdl
ZC1ieTogQWxleCBEZXVjaGVyIDxhbGV4YW5kZXIuZGV1Y2hlckBhbWQuY29tPgpTaWduZWQtb2Zm
LWJ5OiBBbGV4IERldWNoZXIgPGFsZXhhbmRlci5kZXVjaGVyQGFtZC5jb20+Ci0tLQogZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvTWFrZWZpbGUgICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvdmNuX3YyXzUuYyB8IDQxNCArKysrKysrKysrKysrKysrKysrKysrKysrKwog
MiBmaWxlcyBjaGFuZ2VkLCA0MTYgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3Zjbl92Ml81LmMKCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L01ha2VmaWxlCmluZGV4IGRjMjI1NjllOTczMi4uN2ExYTc4YzdiMzI5
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9NYWtlZmlsZQorKysgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9NYWtlZmlsZQpAQCAtMTQ1LDcgKzE0NSw4IEBAIGFt
ZGdwdS15ICs9IFwKIGFtZGdwdS15ICs9IFwKIAlhbWRncHVfdmNuLm8gXAogCXZjbl92MV8wLm8g
XAotCXZjbl92Ml8wLm8KKwl2Y25fdjJfMC5vIFwKKwl2Y25fdjJfNS5vCiAKICMgYWRkIEFUSFVC
IGJsb2NrCiBhbWRncHUteSArPSBcCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS92Y25fdjJfNS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvdmNuX3YyXzUuYwpu
ZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjBmNTUzNTYzY2ViOQotLS0g
L2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3Zjbl92Ml81LmMKQEAg
LTAsMCArMSw0MTQgQEAKKy8qCisgKiBDb3B5cmlnaHQgMjAxOSBBZHZhbmNlZCBNaWNybyBEZXZp
Y2VzLCBJbmMuCisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBj
aGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2Fy
ZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisg
KiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcg
d2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBt
ZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNv
cGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQor
ICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dp
bmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhp
cyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgorICogYWxsIGNvcGllcyBv
ciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCisgKgorICogVEhFIFNPRlRX
QVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVY
UFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdB
UlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFS
IFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUg
Q09QWVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0s
IERBTUFHRVMgT1IKKyAqIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0Yg
Q09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAorICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1Ig
SU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SCisgKiBPVEhFUiBE
RUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCisgKgorICovCisKKyNpbmNsdWRlIDxsaW51eC9maXJt
d2FyZS5oPgorI2luY2x1ZGUgPGRybS9kcm1QLmg+CisjaW5jbHVkZSAiYW1kZ3B1LmgiCisjaW5j
bHVkZSAiYW1kZ3B1X3Zjbi5oIgorI2luY2x1ZGUgInNvYzE1LmgiCisjaW5jbHVkZSAic29jMTVk
LmgiCisjaW5jbHVkZSAidmNuX3YyXzAuaCIKKworI2luY2x1ZGUgInZjbi92Y25fMl81X29mZnNl
dC5oIgorI2luY2x1ZGUgInZjbi92Y25fMl81X3NoX21hc2suaCIKKyNpbmNsdWRlICJpdnNyY2lk
L3Zjbi9pcnFzcmNzX3Zjbl8yXzAuaCIKKworI2RlZmluZSBtbVVWRF9DT05URVhUX0lEX0lOVEVS
TkFMX09GRlNFVAkJCTB4MjcKKyNkZWZpbmUgbW1VVkRfR1BDT01fVkNQVV9DTURfSU5URVJOQUxf
T0ZGU0VUCQkJMHgwZgorI2RlZmluZSBtbVVWRF9HUENPTV9WQ1BVX0RBVEEwX0lOVEVSTkFMX09G
RlNFVAkJCTB4MTAKKyNkZWZpbmUgbW1VVkRfR1BDT01fVkNQVV9EQVRBMV9JTlRFUk5BTF9PRkZT
RVQJCQkweDExCisjZGVmaW5lIG1tVVZEX05PX09QX0lOVEVSTkFMX09GRlNFVAkJCQkweDI5Cisj
ZGVmaW5lIG1tVVZEX0dQX1NDUkFUQ0g4X0lOVEVSTkFMX09GRlNFVAkJCTB4NjYKKyNkZWZpbmUg
bW1VVkRfU0NSQVRDSDlfSU5URVJOQUxfT0ZGU0VUCQkJCTB4YzAxZAorCisjZGVmaW5lIG1tVVZE
X0xNSV9SQkNfSUJfVk1JRF9JTlRFUk5BTF9PRkZTRVQJCQkweDQzMQorI2RlZmluZSBtbVVWRF9M
TUlfUkJDX0lCXzY0QklUX0JBUl9MT1dfSU5URVJOQUxfT0ZGU0VUCQkweDNiNAorI2RlZmluZSBt
bVVWRF9MTUlfUkJDX0lCXzY0QklUX0JBUl9ISUdIX0lOVEVSTkFMX09GRlNFVCAJMHgzYjUKKyNk
ZWZpbmUgbW1VVkRfUkJDX0lCX1NJWkVfSU5URVJOQUxfT0ZGU0VUCQkJMHgyNWMKKworI2RlZmlu
ZSBtbVVWRF9KUEVHX1BJVENIX0lOVEVSTkFMX09GRlNFVAkJCTB4NDAxZgorCitzdGF0aWMgdm9p
ZCB2Y25fdjJfNV9zZXRfZGVjX3JpbmdfZnVuY3Moc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYp
Oworc3RhdGljIHZvaWQgdmNuX3YyXzVfc2V0X2VuY19yaW5nX2Z1bmNzKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2KTsKK3N0YXRpYyB2b2lkIHZjbl92Ml81X3NldF9qcGVnX3JpbmdfZnVuY3Mo
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpOworc3RhdGljIHZvaWQgdmNuX3YyXzVfc2V0X2ly
cV9mdW5jcyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldik7CitzdGF0aWMgaW50IHZjbl92Ml81
X3NldF9wb3dlcmdhdGluZ19zdGF0ZSh2b2lkICpoYW5kbGUsCisJCQkJZW51bSBhbWRfcG93ZXJn
YXRpbmdfc3RhdGUgc3RhdGUpOworCisvKioKKyAqIHZjbl92Ml81X2Vhcmx5X2luaXQgLSBzZXQg
ZnVuY3Rpb24gcG9pbnRlcnMKKyAqCisgKiBAaGFuZGxlOiBhbWRncHVfZGV2aWNlIHBvaW50ZXIK
KyAqCisgKiBTZXQgcmluZyBhbmQgaXJxIGZ1bmN0aW9uIHBvaW50ZXJzCisgKi8KK3N0YXRpYyBp
bnQgdmNuX3YyXzVfZWFybHlfaW5pdCh2b2lkICpoYW5kbGUpCit7CisJc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7CisKKwlhZGV2LT52
Y24ubnVtX2VuY19yaW5ncyA9IDI7CisKKwl2Y25fdjJfNV9zZXRfZGVjX3JpbmdfZnVuY3MoYWRl
dik7CisJdmNuX3YyXzVfc2V0X2VuY19yaW5nX2Z1bmNzKGFkZXYpOworCXZjbl92Ml81X3NldF9q
cGVnX3JpbmdfZnVuY3MoYWRldik7CisJdmNuX3YyXzVfc2V0X2lycV9mdW5jcyhhZGV2KTsKKwor
CXJldHVybiAwOworfQorCisvKioKKyAqIHZjbl92Ml81X3N3X2luaXQgLSBzdyBpbml0IGZvciBW
Q04gYmxvY2sKKyAqCisgKiBAaGFuZGxlOiBhbWRncHVfZGV2aWNlIHBvaW50ZXIKKyAqCisgKiBM
b2FkIGZpcm13YXJlIGFuZCBzdyBpbml0aWFsaXphdGlvbgorICovCitzdGF0aWMgaW50IHZjbl92
Ml81X3N3X2luaXQodm9pZCAqaGFuZGxlKQoreworCXN0cnVjdCBhbWRncHVfcmluZyAqcmluZzsK
KwlpbnQgaSwgcjsKKwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqKWhhbmRsZTsKKworCS8qIFZDTiBERUMgVFJBUCAqLworCXIgPSBhbWRncHVfaXJx
X2FkZF9pZChhZGV2LCBTT0MxNV9JSF9DTElFTlRJRF9WQ04sCisJCQlWQ05fMl8wX19TUkNJRF9f
VVZEX1NZU1RFTV9NRVNTQUdFX0lOVEVSUlVQVCwgJmFkZXYtPnZjbi5pcnEpOworCWlmIChyKQor
CQlyZXR1cm4gcjsKKworCS8qIFZDTiBFTkMgVFJBUCAqLworCWZvciAoaSA9IDA7IGkgPCBhZGV2
LT52Y24ubnVtX2VuY19yaW5nczsgKytpKSB7CisJCXIgPSBhbWRncHVfaXJxX2FkZF9pZChhZGV2
LCBTT0MxNV9JSF9DTElFTlRJRF9WQ04sCisJCQlpICsgVkNOXzJfMF9fU1JDSURfX1VWRF9FTkNf
R0VORVJBTF9QVVJQT1NFLCAmYWRldi0+dmNuLmlycSk7CisJCWlmIChyKQorCQkJcmV0dXJuIHI7
CisJfQorCisJLyogVkNOIEpQRUcgVFJBUCAqLworCXIgPSBhbWRncHVfaXJxX2FkZF9pZChhZGV2
LCBTT0MxNV9JSF9DTElFTlRJRF9WQ04sCisJCQlWQ05fMl8wX19TUkNJRF9fSlBFR19ERUNPREUs
ICZhZGV2LT52Y24uaXJxKTsKKwlpZiAocikKKwkJcmV0dXJuIHI7CisKKwlyID0gYW1kZ3B1X3Zj
bl9zd19pbml0KGFkZXYpOworCWlmIChyKQorCQlyZXR1cm4gcjsKKworCWlmIChhZGV2LT5maXJt
d2FyZS5sb2FkX3R5cGUgPT0gQU1ER1BVX0ZXX0xPQURfUFNQKSB7CisJCWNvbnN0IHN0cnVjdCBj
b21tb25fZmlybXdhcmVfaGVhZGVyICpoZHI7CisJCWhkciA9IChjb25zdCBzdHJ1Y3QgY29tbW9u
X2Zpcm13YXJlX2hlYWRlciAqKWFkZXYtPnZjbi5mdy0+ZGF0YTsKKwkJYWRldi0+ZmlybXdhcmUu
dWNvZGVbQU1ER1BVX1VDT0RFX0lEX1ZDTl0udWNvZGVfaWQgPSBBTURHUFVfVUNPREVfSURfVkNO
OworCQlhZGV2LT5maXJtd2FyZS51Y29kZVtBTURHUFVfVUNPREVfSURfVkNOXS5mdyA9IGFkZXYt
PnZjbi5mdzsKKwkJYWRldi0+ZmlybXdhcmUuZndfc2l6ZSArPQorCQkJQUxJR04obGUzMl90b19j
cHUoaGRyLT51Y29kZV9zaXplX2J5dGVzKSwgUEFHRV9TSVpFKTsKKwkJRFJNX0lORk8oIlBTUCBs
b2FkaW5nIFZDTiBmaXJtd2FyZVxuIik7CisJfQorCisJciA9IGFtZGdwdV92Y25fcmVzdW1lKGFk
ZXYpOworCWlmIChyKQorCQlyZXR1cm4gcjsKKworCXJpbmcgPSAmYWRldi0+dmNuLnJpbmdfZGVj
OworCXNwcmludGYocmluZy0+bmFtZSwgInZjbl9kZWMiKTsKKwlyID0gYW1kZ3B1X3JpbmdfaW5p
dChhZGV2LCByaW5nLCA1MTIsICZhZGV2LT52Y24uaXJxLCAwKTsKKwlpZiAocikKKwkJcmV0dXJu
IHI7CisKKwlhZGV2LT52Y24uaW50ZXJuYWwuY29udGV4dF9pZCA9IG1tVVZEX0NPTlRFWFRfSURf
SU5URVJOQUxfT0ZGU0VUOworCWFkZXYtPnZjbi5pbnRlcm5hbC5pYl92bWlkID0gbW1VVkRfTE1J
X1JCQ19JQl9WTUlEX0lOVEVSTkFMX09GRlNFVDsKKwlhZGV2LT52Y24uaW50ZXJuYWwuaWJfYmFy
X2xvdyA9IG1tVVZEX0xNSV9SQkNfSUJfNjRCSVRfQkFSX0xPV19JTlRFUk5BTF9PRkZTRVQ7CisJ
YWRldi0+dmNuLmludGVybmFsLmliX2Jhcl9oaWdoID0gbW1VVkRfTE1JX1JCQ19JQl82NEJJVF9C
QVJfSElHSF9JTlRFUk5BTF9PRkZTRVQ7CisJYWRldi0+dmNuLmludGVybmFsLmliX3NpemUgPSBt
bVVWRF9SQkNfSUJfU0laRV9JTlRFUk5BTF9PRkZTRVQ7CisJYWRldi0+dmNuLmludGVybmFsLmdw
X3NjcmF0Y2g4ID0gbW1VVkRfR1BfU0NSQVRDSDhfSU5URVJOQUxfT0ZGU0VUOworCisJYWRldi0+
dmNuLmludGVybmFsLnNjcmF0Y2g5ID0gbW1VVkRfU0NSQVRDSDlfSU5URVJOQUxfT0ZGU0VUOwor
CWFkZXYtPnZjbi5leHRlcm5hbC5zY3JhdGNoOSA9IFNPQzE1X1JFR19PRkZTRVQoVVZELCAwLCBt
bVVWRF9TQ1JBVENIOSk7CisJYWRldi0+dmNuLmludGVybmFsLmRhdGEwID0gbW1VVkRfR1BDT01f
VkNQVV9EQVRBMF9JTlRFUk5BTF9PRkZTRVQ7CisJYWRldi0+dmNuLmV4dGVybmFsLmRhdGEwID0g
U09DMTVfUkVHX09GRlNFVChVVkQsIDAsIG1tVVZEX0dQQ09NX1ZDUFVfREFUQTApOworCWFkZXYt
PnZjbi5pbnRlcm5hbC5kYXRhMSA9IG1tVVZEX0dQQ09NX1ZDUFVfREFUQTFfSU5URVJOQUxfT0ZG
U0VUOworCWFkZXYtPnZjbi5leHRlcm5hbC5kYXRhMSA9IFNPQzE1X1JFR19PRkZTRVQoVVZELCAw
LCBtbVVWRF9HUENPTV9WQ1BVX0RBVEExKTsKKwlhZGV2LT52Y24uaW50ZXJuYWwuY21kID0gbW1V
VkRfR1BDT01fVkNQVV9DTURfSU5URVJOQUxfT0ZGU0VUOworCWFkZXYtPnZjbi5leHRlcm5hbC5j
bWQgPSBTT0MxNV9SRUdfT0ZGU0VUKFVWRCwgMCwgbW1VVkRfR1BDT01fVkNQVV9DTUQpOworCWFk
ZXYtPnZjbi5pbnRlcm5hbC5ub3AgPSBtbVVWRF9OT19PUF9JTlRFUk5BTF9PRkZTRVQ7CisJYWRl
di0+dmNuLmV4dGVybmFsLm5vcCA9IFNPQzE1X1JFR19PRkZTRVQoVVZELCAwLCBtbVVWRF9OT19P
UCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgYWRldi0+dmNuLm51bV9lbmNfcmluZ3M7ICsraSkgewor
CQlyaW5nID0gJmFkZXYtPnZjbi5yaW5nX2VuY1tpXTsKKwkJc3ByaW50ZihyaW5nLT5uYW1lLCAi
dmNuX2VuYyVkIiwgaSk7CisJCXIgPSBhbWRncHVfcmluZ19pbml0KGFkZXYsIHJpbmcsIDUxMiwg
JmFkZXYtPnZjbi5pcnEsIDApOworCQlpZiAocikKKwkJCXJldHVybiByOworCX0KKworCXJpbmcg
PSAmYWRldi0+dmNuLnJpbmdfanBlZzsKKwlzcHJpbnRmKHJpbmctPm5hbWUsICJ2Y25fanBlZyIp
OworCXIgPSBhbWRncHVfcmluZ19pbml0KGFkZXYsIHJpbmcsIDUxMiwgJmFkZXYtPnZjbi5pcnEs
IDApOworCWlmIChyKQorCQlyZXR1cm4gcjsKKworCWFkZXYtPnZjbi5pbnRlcm5hbC5qcGVnX3Bp
dGNoID0gbW1VVkRfSlBFR19QSVRDSF9JTlRFUk5BTF9PRkZTRVQ7CisJYWRldi0+dmNuLmV4dGVy
bmFsLmpwZWdfcGl0Y2ggPSBTT0MxNV9SRUdfT0ZGU0VUKFVWRCwgMCwgbW1VVkRfSlBFR19QSVRD
SCk7CisKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiB2Y25fdjJfNV9zd19maW5pIC0gc3cgZmlu
aSBmb3IgVkNOIGJsb2NrCisgKgorICogQGhhbmRsZTogYW1kZ3B1X2RldmljZSBwb2ludGVyCisg
KgorICogVkNOIHN1c3BlbmQgYW5kIGZyZWUgdXAgc3cgYWxsb2NhdGlvbgorICovCitzdGF0aWMg
aW50IHZjbl92Ml81X3N3X2Zpbmkodm9pZCAqaGFuZGxlKQoreworCWludCByOworCXN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2ID0gKHN0cnVjdCBhbWRncHVfZGV2aWNlICopaGFuZGxlOworCisJ
ciA9IGFtZGdwdV92Y25fc3VzcGVuZChhZGV2KTsKKwlpZiAocikKKwkJcmV0dXJuIHI7CisKKwly
ID0gYW1kZ3B1X3Zjbl9zd19maW5pKGFkZXYpOworCisJcmV0dXJuIHI7Cit9CisKKy8qKgorICog
dmNuX3YyXzVfaHdfaW5pdCAtIHN0YXJ0IGFuZCB0ZXN0IFZDTiBibG9jaworICoKKyAqIEBoYW5k
bGU6IGFtZGdwdV9kZXZpY2UgcG9pbnRlcgorICoKKyAqIEluaXRpYWxpemUgdGhlIGhhcmR3YXJl
LCBib290IHVwIHRoZSBWQ1BVIGFuZCBkbyBzb21lIHRlc3RpbmcKKyAqLworc3RhdGljIGludCB2
Y25fdjJfNV9od19pbml0KHZvaWQgKmhhbmRsZSkKK3sKKwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhhbmRsZTsKKwlzdHJ1Y3QgYW1kZ3B1X3Jp
bmcgKnJpbmcgPSAmYWRldi0+dmNuLnJpbmdfZGVjOworCWludCBpLCByOworCisJciA9IGFtZGdw
dV9yaW5nX3Rlc3RfcmluZyhyaW5nKTsKKwlpZiAocikgeworCQlyaW5nLT5zY2hlZC5yZWFkeSA9
IGZhbHNlOworCQlnb3RvIGRvbmU7CisJfQorCisJZm9yIChpID0gMDsgaSA8IGFkZXYtPnZjbi5u
dW1fZW5jX3JpbmdzOyArK2kpIHsKKwkJcmluZyA9ICZhZGV2LT52Y24ucmluZ19lbmNbaV07CisJ
CXJpbmctPnNjaGVkLnJlYWR5ID0gZmFsc2U7CisJCWNvbnRpbnVlOworCQlyID0gYW1kZ3B1X3Jp
bmdfdGVzdF9yaW5nKHJpbmcpOworCQlpZiAocikgeworCQkJcmluZy0+c2NoZWQucmVhZHkgPSBm
YWxzZTsKKwkJCWdvdG8gZG9uZTsKKwkJfQorCX0KKworCXJpbmcgPSAmYWRldi0+dmNuLnJpbmdf
anBlZzsKKwlyID0gYW1kZ3B1X3JpbmdfdGVzdF9yaW5nKHJpbmcpOworCWlmIChyKSB7CisJCXJp
bmctPnNjaGVkLnJlYWR5ID0gZmFsc2U7CisJCWdvdG8gZG9uZTsKKwl9CisKK2RvbmU6CisJaWYg
KCFyKQorCQlEUk1fSU5GTygiVkNOIGRlY29kZSBhbmQgZW5jb2RlIGluaXRpYWxpemVkIHN1Y2Nl
c3NmdWxseS5cbiIpOworCisJcmV0dXJuIHI7Cit9CisKKy8qKgorICogdmNuX3YyXzVfaHdfZmlu
aSAtIHN0b3AgdGhlIGhhcmR3YXJlIGJsb2NrCisgKgorICogQGhhbmRsZTogYW1kZ3B1X2Rldmlj
ZSBwb2ludGVyCisgKgorICogU3RvcCB0aGUgVkNOIGJsb2NrLCBtYXJrIHJpbmcgYXMgbm90IHJl
YWR5IGFueSBtb3JlCisgKi8KK3N0YXRpYyBpbnQgdmNuX3YyXzVfaHdfZmluaSh2b2lkICpoYW5k
bGUpCit7CisJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKiloYW5kbGU7CisJc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nID0gJmFkZXYtPnZjbi5yaW5n
X2RlYzsKKwlpbnQgaTsKKworCWlmIChSUkVHMzJfU09DMTUoVkNOLCAwLCBtbVVWRF9TVEFUVVMp
KQorCQl2Y25fdjJfNV9zZXRfcG93ZXJnYXRpbmdfc3RhdGUoYWRldiwgQU1EX1BHX1NUQVRFX0dB
VEUpOworCisJcmluZy0+c2NoZWQucmVhZHkgPSBmYWxzZTsKKworCWZvciAoaSA9IDA7IGkgPCBh
ZGV2LT52Y24ubnVtX2VuY19yaW5nczsgKytpKSB7CisJCXJpbmcgPSAmYWRldi0+dmNuLnJpbmdf
ZW5jW2ldOworCQlyaW5nLT5zY2hlZC5yZWFkeSA9IGZhbHNlOworCX0KKworCXJpbmcgPSAmYWRl
di0+dmNuLnJpbmdfanBlZzsKKwlyaW5nLT5zY2hlZC5yZWFkeSA9IGZhbHNlOworCisJcmV0dXJu
IDA7Cit9CisKKy8qKgorICogdmNuX3YyXzVfc3VzcGVuZCAtIHN1c3BlbmQgVkNOIGJsb2NrCisg
KgorICogQGhhbmRsZTogYW1kZ3B1X2RldmljZSBwb2ludGVyCisgKgorICogSFcgZmluaSBhbmQg
c3VzcGVuZCBWQ04gYmxvY2sKKyAqLworc3RhdGljIGludCB2Y25fdjJfNV9zdXNwZW5kKHZvaWQg
KmhhbmRsZSkKK3sKKwlpbnQgcjsKKwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqKWhhbmRsZTsKKworCXIgPSB2Y25fdjJfNV9od19maW5pKGFkZXYp
OworCWlmIChyKQorCQlyZXR1cm4gcjsKKworCXIgPSBhbWRncHVfdmNuX3N1c3BlbmQoYWRldik7
CisKKwlyZXR1cm4gcjsKK30KKworLyoqCisgKiB2Y25fdjJfNV9yZXN1bWUgLSByZXN1bWUgVkNO
IGJsb2NrCisgKgorICogQGhhbmRsZTogYW1kZ3B1X2RldmljZSBwb2ludGVyCisgKgorICogUmVz
dW1lIGZpcm13YXJlIGFuZCBodyBpbml0IFZDTiBibG9jaworICovCitzdGF0aWMgaW50IHZjbl92
Ml81X3Jlc3VtZSh2b2lkICpoYW5kbGUpCit7CisJaW50IHI7CisJc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7CisKKwlyID0gYW1kZ3B1
X3Zjbl9yZXN1bWUoYWRldik7CisJaWYgKHIpCisJCXJldHVybiByOworCisJciA9IHZjbl92Ml81
X2h3X2luaXQoYWRldik7CisKKwlyZXR1cm4gcjsKK30KKworc3RhdGljIGJvb2wgdmNuX3YyXzVf
aXNfaWRsZSh2b2lkICpoYW5kbGUpCit7CisJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSAo
c3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7CisKKwlyZXR1cm4gKFJSRUczMl9TT0MxNShW
Q04sIDAsIG1tVVZEX1NUQVRVUykgPT0gVVZEX1NUQVRVU19fSURMRSk7Cit9CisKK3N0YXRpYyBp
bnQgdmNuX3YyXzVfd2FpdF9mb3JfaWRsZSh2b2lkICpoYW5kbGUpCit7CisJc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7CisJaW50IHJl
dCA9IDA7CisKKwlTT0MxNV9XQUlUX09OX1JSRUcoVkNOLCAwLCBtbVVWRF9TVEFUVVMsIFVWRF9T
VEFUVVNfX0lETEUsCisJCVVWRF9TVEFUVVNfX0lETEUsIHJldCk7CisKKwlyZXR1cm4gcmV0Owor
fQorCitzdGF0aWMgaW50IHZjbl92Ml81X3NldF9jbG9ja2dhdGluZ19zdGF0ZSh2b2lkICpoYW5k
bGUsCisJCQkJCSAgZW51bSBhbWRfY2xvY2tnYXRpbmdfc3RhdGUgc3RhdGUpCit7CisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgdmNuX3YyXzVfc2V0X3Bvd2VyZ2F0aW5nX3N0YXRlKHZvaWQg
KmhhbmRsZSwKKwkJCQkJICBlbnVtIGFtZF9wb3dlcmdhdGluZ19zdGF0ZSBzdGF0ZSkKK3sKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIGludCB2Y25fdjJfNV9zZXRfaW50ZXJydXB0X3N0YXRlKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAorCQkJCQlzdHJ1Y3QgYW1kZ3B1X2lycV9zcmMgKnNv
dXJjZSwKKwkJCQkJdW5zaWduZWQgdHlwZSwKKwkJCQkJZW51bSBhbWRncHVfaW50ZXJydXB0X3N0
YXRlIHN0YXRlKQoreworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHZjbl92Ml81X3Byb2Nl
c3NfaW50ZXJydXB0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAorCQkJCSAgICAgIHN0cnVj
dCBhbWRncHVfaXJxX3NyYyAqc291cmNlLAorCQkJCSAgICAgIHN0cnVjdCBhbWRncHVfaXZfZW50
cnkgKmVudHJ5KQoreworCURSTV9ERUJVRygiSUg6IFZDTiBUUkFQXG4iKTsKKworCXN3aXRjaCAo
ZW50cnktPnNyY19pZCkgeworCWNhc2UgVkNOXzJfMF9fU1JDSURfX1VWRF9TWVNURU1fTUVTU0FH
RV9JTlRFUlJVUFQ6CisJCWFtZGdwdV9mZW5jZV9wcm9jZXNzKCZhZGV2LT52Y24ucmluZ19kZWMp
OworCQlicmVhazsKKwljYXNlIFZDTl8yXzBfX1NSQ0lEX19VVkRfRU5DX0dFTkVSQUxfUFVSUE9T
RToKKwkJYW1kZ3B1X2ZlbmNlX3Byb2Nlc3MoJmFkZXYtPnZjbi5yaW5nX2VuY1swXSk7CisJCWJy
ZWFrOworCWNhc2UgVkNOXzJfMF9fU1JDSURfX1VWRF9FTkNfTE9XX0xBVEVOQ1k6CisJCWFtZGdw
dV9mZW5jZV9wcm9jZXNzKCZhZGV2LT52Y24ucmluZ19lbmNbMV0pOworCQlicmVhazsKKwljYXNl
IFZDTl8yXzBfX1NSQ0lEX19KUEVHX0RFQ09ERToKKwkJYW1kZ3B1X2ZlbmNlX3Byb2Nlc3MoJmFk
ZXYtPnZjbi5yaW5nX2pwZWcpOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlEUk1fRVJST1IoIlVu
aGFuZGxlZCBpbnRlcnJ1cHQ6ICVkICVkXG4iLAorCQkJICBlbnRyeS0+c3JjX2lkLCBlbnRyeS0+
c3JjX2RhdGFbMF0pOworCQlicmVhazsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNv
bnN0IHN0cnVjdCBhbWRncHVfaXJxX3NyY19mdW5jcyB2Y25fdjJfNV9pcnFfZnVuY3MgPSB7CisJ
LnNldCA9IHZjbl92Ml81X3NldF9pbnRlcnJ1cHRfc3RhdGUsCisJLnByb2Nlc3MgPSB2Y25fdjJf
NV9wcm9jZXNzX2ludGVycnVwdCwKK307CisKK3N0YXRpYyB2b2lkIHZjbl92Ml81X3NldF9pcnFf
ZnVuY3Moc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCit7CisJYWRldi0+dmNuLmlycS5udW1f
dHlwZXMgPSBhZGV2LT52Y24ubnVtX2VuY19yaW5ncyArIDI7CisJYWRldi0+dmNuLmlycS5mdW5j
cyA9ICZ2Y25fdjJfNV9pcnFfZnVuY3M7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgYW1kX2lw
X2Z1bmNzIHZjbl92Ml81X2lwX2Z1bmNzID0geworCS5uYW1lID0gInZjbl92Ml81IiwKKwkuZWFy
bHlfaW5pdCA9IHZjbl92Ml81X2Vhcmx5X2luaXQsCisJLmxhdGVfaW5pdCA9IE5VTEwsCisJLnN3
X2luaXQgPSB2Y25fdjJfNV9zd19pbml0LAorCS5zd19maW5pID0gdmNuX3YyXzVfc3dfZmluaSwK
KwkuaHdfaW5pdCA9IHZjbl92Ml81X2h3X2luaXQsCisJLmh3X2ZpbmkgPSB2Y25fdjJfNV9od19m
aW5pLAorCS5zdXNwZW5kID0gdmNuX3YyXzVfc3VzcGVuZCwKKwkucmVzdW1lID0gdmNuX3YyXzVf
cmVzdW1lLAorCS5pc19pZGxlID0gdmNuX3YyXzVfaXNfaWRsZSwKKwkud2FpdF9mb3JfaWRsZSA9
IHZjbl92Ml81X3dhaXRfZm9yX2lkbGUsCisJLmNoZWNrX3NvZnRfcmVzZXQgPSBOVUxMLAorCS5w
cmVfc29mdF9yZXNldCA9IE5VTEwsCisJLnNvZnRfcmVzZXQgPSBOVUxMLAorCS5wb3N0X3NvZnRf
cmVzZXQgPSBOVUxMLAorCS5zZXRfY2xvY2tnYXRpbmdfc3RhdGUgPSB2Y25fdjJfNV9zZXRfY2xv
Y2tnYXRpbmdfc3RhdGUsCisJLnNldF9wb3dlcmdhdGluZ19zdGF0ZSA9IHZjbl92Ml81X3NldF9w
b3dlcmdhdGluZ19zdGF0ZSwKK307CisKK2NvbnN0IHN0cnVjdCBhbWRncHVfaXBfYmxvY2tfdmVy
c2lvbiB2Y25fdjJfNV9pcF9ibG9jayA9Cit7CisJCS50eXBlID0gQU1EX0lQX0JMT0NLX1RZUEVf
VkNOLAorCQkubWFqb3IgPSAyLAorCQkubWlub3IgPSA1LAorCQkucmV2ID0gMCwKKwkJLmZ1bmNz
ID0gJnZjbl92Ml81X2lwX2Z1bmNzLAorfTsKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdm
eEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9hbWQtZ2Z4
