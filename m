Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0455249015
	for <lists+amd-gfx@lfdr.de>; Mon, 17 Jun 2019 21:47:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6A49789F27;
	Mon, 17 Jun 2019 19:47:02 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qt1-x844.google.com (mail-qt1-x844.google.com
 [IPv6:2607:f8b0:4864:20::844])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0A26C89EAC
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:46:51 +0000 (UTC)
Received: by mail-qt1-x844.google.com with SMTP id d23so12320501qto.2
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 12:46:50 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=3/nCyxY09gQ6iTug6Bs/5tUXV9774TfBvmnM6A4N1iI=;
 b=EHntCqnbqegY9YFEOtSVlR8lWAmZ332qbSoJzbaqwoqqG6L8XxWOx1minL3QTCJUnV
 PBKfDWGZb48kdWvEb0mTSOlwt3OBItGb4dFZ7uLij8mIrCXB0dCzk8FTRs97UNLkhMAV
 Dn7yfZY6qZGTmSKxCKByDrFlW3+uP2jdgvZtz0Xnc4eL/4XeReNB9BD6mRnM1xCaV/Os
 p60S1pRmwHOR1r0x+Ur7qoZb0Vdb93cfyLeNqC+Hk1w1rPXkmAu3nb3bDTVwu6d5zYnE
 kI23glDC4NydtXvw6Zn2iXc4dmOThZLSKY/jPYh0HbZo9KrpfEdfqLj33J2bjyg98vPQ
 XelA==
X-Gm-Message-State: APjAAAUnhGTPolZ2fAdmvTzc3hlAXinTngQWrbEoZ+vfYIh0YgWshPfD
 HkDXf0z/lGxvqFvKZJiAkXskHksNHONm9g==
X-Google-Smtp-Source: APXvYqz/jZQtdXBD9Hy4jSD6D4Mp4o+DI0O6nh0pFisONZ9mkNy6P3BNfDk8XNo4Y4xOWJRw5MvQmQ==
X-Received: by 2002:ad4:43e3:: with SMTP id f3mr23448418qvu.108.1560800809906; 
 Mon, 17 Jun 2019 12:46:49 -0700 (PDT)
Received: from localhost.localdomain ([71.219.5.136])
 by smtp.gmail.com with ESMTPSA id u4sm6559420qkb.16.2019.06.17.12.46.48
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 12:46:49 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 352/459] drm/amd/display: Refactor clk_mgr functions
Date: Mon, 17 Jun 2019 14:44:53 -0500
Message-Id: <20190617194540.18497-53-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617194540.18497-1-alexander.deucher@amd.com>
References: <20190617194540.18497-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=3/nCyxY09gQ6iTug6Bs/5tUXV9774TfBvmnM6A4N1iI=;
 b=U+1pr40KF+LKXjsujkpFmXrUlt7E0Fq8VqMTcVgug27lsODWVWTeAn0zH1AAspjMTK
 ZA88L0C3wHugUiQzxyl0SAaMOhFGN6hBHEyy19H7865zwHMy0teN3VEArDYJZndC8mIU
 E4NDLXHyq3qWxRMBpaDrHDqUQTSzOwozlyMThp5F422NNrXAlRtDV0zUT6qYrU+3AJu5
 XnJnzGwLKPUUZ2uSn1/6NthmhIdgDKkAXdk9waYvkcQeN/sONh9NuAD/AqFeH2CZ5BI/
 uiT4gojgiz/Dluy9XxG/tFDEVg+nQZz8chhOmjTep+YYgaM36eQ8azfEOFvGaiXCET0B
 kZzw==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Leo Li <sunpeng.li@amd.com>, Alex Deucher <alexander.deucher@amd.com>,
 Tony Cheng <Tony.Cheng@amd.com>, Eric Yang <Eric.Yang2@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogRXJpYyBZYW5nIDxFcmljLllhbmcyQGFtZC5jb20+CgpbV2h5XQpTb21lIEhXIHNwZWNp
ZmljIGltcGxlbWVudGF0aW9ucyBjYW4gYmUgcHVsbGVkIG91dCBpbnRvIGNsa19tZ3IuYy4KCltI
b3ddCi0gUHVsbCBnZXRfYWN0aXZlX2Rpc3BsYXlfY250IG91dCB0byBjbGtfbWdyLgotIFB1bGwg
b3V0IHNoYXJlZCBsb2dpYyBpbiBzZXRfZGlzcGNsayBhbmQgc2V0X2RwcmVmY2xrCgpTaWduZWQt
b2ZmLWJ5OiBFcmljIFlhbmcgPEVyaWMuWWFuZzJAYW1kLmNvbT4KUmV2aWV3ZWQtYnk6IFRvbnkg
Q2hlbmcgPFRvbnkuQ2hlbmdAYW1kLmNvbT4KQWNrZWQtYnk6IExlbyBMaSA8c3VucGVuZy5saUBh
bWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBBbGV4IERldWNoZXIgPGFsZXhhbmRlci5kZXVjaGVyQGFt
ZC5jb20+Ci0tLQogLi4uL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xrX21nci9jbGtfbWdyLmMg
IHwgMjUgKysrKysrKysKIC4uLi9kaXNwbGF5L2RjL2Nsa19tZ3IvZGNuMTAvcnYxX2Nsa19tZ3Iu
YyAgICB8IDI1ICstLS0tLS0tCiAuLi4vZGMvY2xrX21nci9kY24xMC9ydjFfY2xrX21ncl92Ymlv
c19zbXUuYyAgfCA1OCArKysrKysrKysrLS0tLS0tLS0tCiAuLi4vZGlzcGxheS9kYy9jbGtfbWdy
L2RjbjIwL2RjbjIwX2Nsa19tZ3IuYyAgfCA0MyArKysrKy0tLS0tLS0tLQogLi4uL2Rpc3BsYXkv
ZGMvY2xrX21nci9kY24yMC9kY24yMF9jbGtfbWdyLmggIHwgIDIgKwogNSBmaWxlcyBjaGFuZ2Vk
LCA3MSBpbnNlcnRpb25zKCspLCA4MiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xrX21nci9jbGtfbWdyLmMgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvY2xrX21nci9jbGtfbWdyLmMKaW5kZXggMjdkNDA3YTliNDUyLi4w
NmU3M2NlNDVlZDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9j
bGtfbWdyL2Nsa19tZ3IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xr
X21nci9jbGtfbWdyLmMKQEAgLTM2LDYgKzM2LDMxIEBACiAjaW5jbHVkZSAiZGNuMTAvcnYyX2Ns
a19tZ3IuaCIKICNpbmNsdWRlICJkY24yMC9kY24yMF9jbGtfbWdyLmgiCiAKKworaW50IGNsa19t
Z3JfaGVscGVyX2dldF9hY3RpdmVfZGlzcGxheV9jbnQoCisJCXN0cnVjdCBkYyAqZGMsCisJCXN0
cnVjdCBkY19zdGF0ZSAqY29udGV4dCkKK3sKKwlpbnQgaSwgZGlzcGxheV9jb3VudDsKKworCWRp
c3BsYXlfY291bnQgPSAwOworCWZvciAoaSA9IDA7IGkgPCBjb250ZXh0LT5zdHJlYW1fY291bnQ7
IGkrKykgeworCQljb25zdCBzdHJ1Y3QgZGNfc3RyZWFtX3N0YXRlICpzdHJlYW0gPSBjb250ZXh0
LT5zdHJlYW1zW2ldOworCisJCS8qCisJCSAqIE9ubHkgbm90aWZ5IGFjdGl2ZSBzdHJlYW0gb3Ig
dmlydHVhbCBzdHJlYW0uCisJCSAqIE5lZWQgdG8gbm90aWZ5IHZpcnR1YWwgc3RyZWFtIHRvIHdv
cmsgYXJvdW5kCisJCSAqIGhlYWRsZXNzIGNhc2UuIEhQRCBkb2VzIG5vdCBmaXJlIHdoZW4gc3lz
dGVtIGlzIGluCisJCSAqIFMwaTIuCisJCSAqLworCQlpZiAoIXN0cmVhbS0+ZHBtc19vZmYgfHwg
c3RyZWFtLT5zaWduYWwgPT0gU0lHTkFMX1RZUEVfVklSVFVBTCkKKwkJCWRpc3BsYXlfY291bnQr
KzsKKwl9CisKKwlyZXR1cm4gZGlzcGxheV9jb3VudDsKK30KKworCiBzdHJ1Y3QgY2xrX21nciAq
ZGNfY2xrX21ncl9jcmVhdGUoc3RydWN0IGRjX2NvbnRleHQgKmN0eCwgc3RydWN0IHBwX3NtdV9m
dW5jcyAqcHBfc211LCBzdHJ1Y3QgZGNjZyAqZGNjZykKIHsKIAlzdHJ1Y3QgaHdfYXNpY19pZCBh
c2ljX2lkID0gY3R4LT5hc2ljX2lkOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2Nsa19tZ3IvZGNuMTAvcnYxX2Nsa19tZ3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9jbGtfbWdyL2RjbjEwL3J2MV9jbGtfbWdyLmMKaW5kZXggYTNmOTUzYzg4
MzlkLi4zMWRiOWI1NWUxMWEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9jbGtfbWdyL2RjbjEwL3J2MV9jbGtfbWdyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9kaXNwbGF5L2RjL2Nsa19tZ3IvZGNuMTAvcnYxX2Nsa19tZ3IuYwpAQCAtMTE0LDI5ICsxMTQs
NiBAQCBzdGF0aWMgdm9pZCByYW1wX3VwX2Rpc3BjbGtfd2l0aF9kcHAoc3RydWN0IGNsa19tZ3Jf
aW50ZXJuYWwgKmNsa19tZ3IsIHN0cnVjdCBkYwogCWNsa19tZ3ItPmJhc2UuY2xrcy5tYXhfc3Vw
cG9ydGVkX2RwcGNsa19raHogPSBuZXdfY2xvY2tzLT5tYXhfc3VwcG9ydGVkX2RwcGNsa19raHo7
CiB9CiAKLXN0YXRpYyBpbnQgZ2V0X2FjdGl2ZV9kaXNwbGF5X2NudCgKLQkJc3RydWN0IGRjICpk
YywKLQkJc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KQotewotCWludCBpLCBkaXNwbGF5X2NvdW50
OwotCi0JZGlzcGxheV9jb3VudCA9IDA7Ci0JZm9yIChpID0gMDsgaSA8IGNvbnRleHQtPnN0cmVh
bV9jb3VudDsgaSsrKSB7Ci0JCWNvbnN0IHN0cnVjdCBkY19zdHJlYW1fc3RhdGUgKnN0cmVhbSA9
IGNvbnRleHQtPnN0cmVhbXNbaV07Ci0KLQkJLyoKLQkJICogT25seSBub3RpZnkgYWN0aXZlIHN0
cmVhbSBvciB2aXJ0dWFsIHN0cmVhbS4KLQkJICogTmVlZCB0byBub3RpZnkgdmlydHVhbCBzdHJl
YW0gdG8gd29yayBhcm91bmQKLQkJICogaGVhZGxlc3MgY2FzZS4gSFBEIGRvZXMgbm90IGZpcmUg
d2hlbiBzeXN0ZW0gaXMgaW4KLQkJICogUzBpMi4KLQkJICovCi0JCWlmICghc3RyZWFtLT5kcG1z
X29mZiB8fCBzdHJlYW0tPnNpZ25hbCA9PSBTSUdOQUxfVFlQRV9WSVJUVUFMKQotCQkJZGlzcGxh
eV9jb3VudCsrOwotCX0KLQotCXJldHVybiBkaXNwbGF5X2NvdW50OwotfQotCiBzdGF0aWMgdm9p
ZCBydjFfdXBkYXRlX2Nsb2NrcyhzdHJ1Y3QgY2xrX21nciAqY2xrX21ncl9iYXNlLAogCQkJc3Ry
dWN0IGRjX3N0YXRlICpjb250ZXh0LAogCQkJYm9vbCBzYWZlX3RvX2xvd2VyKQpAQCAtMTU2LDcg
KzEzMyw3IEBAIHN0YXRpYyB2b2lkIHJ2MV91cGRhdGVfY2xvY2tzKHN0cnVjdCBjbGtfbWdyICpj
bGtfbWdyX2Jhc2UsCiAKIAlwcF9zbXUgPSAmY2xrX21nci0+cHBfc211LT5ydl9mdW5jczsKIAot
CWRpc3BsYXlfY291bnQgPSBnZXRfYWN0aXZlX2Rpc3BsYXlfY250KGRjLCBjb250ZXh0KTsKKwlk
aXNwbGF5X2NvdW50ID0gY2xrX21ncl9oZWxwZXJfZ2V0X2FjdGl2ZV9kaXNwbGF5X2NudChkYywg
Y29udGV4dCk7CiAKIAlpZiAoZGlzcGxheV9jb3VudCA9PSAwKQogCQllbnRlcl9kaXNwbGF5X29m
ZiA9IHRydWU7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xr
X21nci9kY24xMC9ydjFfY2xrX21ncl92Ymlvc19zbXUuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9jbGtfbWdyL2RjbjEwL3J2MV9jbGtfbWdyX3ZiaW9zX3NtdS5jCmluZGV4IDE5
NjA4NzA3MjA2My4uMTg5N2U5MWM4Y2NiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvY2xrX21nci9kY24xMC9ydjFfY2xrX21ncl92Ymlvc19zbXUuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xrX21nci9kY24xMC9ydjFfY2xrX21ncl92
Ymlvc19zbXUuYwpAQCAtNjgsNTcgKzY4LDU5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgSVBfQkFT
RSBNUDFfQkFTRSAgPSB7IHsgeyB7IDB4MDAwMTYwMDAsIDAsIDAsIDAsIDAgfSB9LAogI2RlZmlu
ZSBWQklPU1NNQ19NU0dfU2V0RGlzcGNsa0ZyZXEgICAgICAgICAgIDB4NAogI2RlZmluZSBWQklP
U1NNQ19NU0dfU2V0RHByZWZjbGtGcmVxICAgICAgICAgIDB4NQogCi1pbnQgcnYxX3ZiaW9zX3Nt
dV9zZXRfZGlzcGNsayhzdHJ1Y3QgY2xrX21ncl9pbnRlcm5hbCAqY2xrX21nciwgaW50IHJlcXVl
c3RlZF9kaXNwY2xrX2toeikKK2ludCBydjFfdmJpb3Nfc211X3NlbmRfbXNnX3dpdGhfcGFyYW0o
c3RydWN0IGNsa19tZ3JfaW50ZXJuYWwgKmNsa19tZ3IsIHVuc2lnbmVkIGludCBtc2dfaWQsIHVu
c2lnbmVkIGludCBwYXJhbSkKIHsKLQotCWludCBhY3R1YWxfZGlzcGNsa19zZXRfa2h6ID0gLTE7
Ci0Jc3RydWN0IGRjICpjb3JlX2RjID0gY2xrX21nci0+YmFzZS5jdHgtPmRjOwotCXN0cnVjdCBk
bWN1ICpkbWN1ID0gY29yZV9kYy0+cmVzX3Bvb2wtPmRtY3U7Ci0KIAkvKiBGaXJzdCBjbGVhciBy
ZXNwb25zZSByZWdpc3RlciAqLwotCS8vZG1fd3JpdGVfcmVnKGN0eCwgbW1NUDFfU01OX0MyUE1T
R185MSwgMCk7CiAJUkVHX1dSSVRFKE1QMV9TTU5fQzJQTVNHXzkxLCAwKTsKIAogCS8qIFNldCB0
aGUgcGFyYW1ldGVyIHJlZ2lzdGVyIGZvciB0aGUgU01VIG1lc3NhZ2UsIHVuaXQgaXMgTWh6ICov
Ci0JLy9kbV93cml0ZV9yZWcoY3R4LCBtbU1QMV9TTU5fQzJQTVNHXzgzLCByZXF1ZXN0ZWRfZGlz
cGNsa19raHogLyAxMDAwKTsKLQlSRUdfV1JJVEUoTVAxX1NNTl9DMlBNU0dfODMsIHJlcXVlc3Rl
ZF9kaXNwY2xrX2toeiAvIDEwMDApOworCVJFR19XUklURShNUDFfU01OX0MyUE1TR184MywgcGFy
YW0pOwogCiAJLyogVHJpZ2dlciB0aGUgbWVzc2FnZSB0cmFuc2FjdGlvbiBieSB3cml0aW5nIHRo
ZSBtZXNzYWdlIElEICovCi0JLy9kbV93cml0ZV9yZWcoY3R4LCBtbU1QMV9TTU5fQzJQTVNHXzY3
LCBWQklPU1NNQ19NU0dfU2V0RGlzcGNsa0ZyZXEpOwotCVJFR19XUklURShNUDFfU01OX0MyUE1T
R182NywgVkJJT1NTTUNfTVNHX1NldERpc3BjbGtGcmVxKTsKKwlSRUdfV1JJVEUoTVAxX1NNTl9D
MlBNU0dfNjcsIG1zZ19pZCk7CiAKIAlSRUdfV0FJVChNUDFfU01OX0MyUE1TR185MSwgQ09OVEVO
VCwgMSwgMTAsIDIwMDAwMCk7CiAKIAkvKiBBY3R1YWwgZGlzcGNsayBzZXQgaXMgcmV0dXJuZWQg
aW4gdGhlIHBhcmFtZXRlciByZWdpc3RlciAqLwotCWFjdHVhbF9kaXNwY2xrX3NldF9raHogPSBS
RUdfUkVBRChNUDFfU01OX0MyUE1TR184MykgKiAxMDAwOworCXJldHVybiBSRUdfUkVBRChNUDFf
U01OX0MyUE1TR184Myk7Cit9CisKK2ludCBydjFfdmJpb3Nfc211X3NldF9kaXNwY2xrKHN0cnVj
dCBjbGtfbWdyX2ludGVybmFsICpjbGtfbWdyLCBpbnQgcmVxdWVzdGVkX2Rpc3BjbGtfa2h6KQor
eworCWludCBhY3R1YWxfZGlzcGNsa19zZXRfbWh6ID0gLTE7CisJc3RydWN0IGRjICpjb3JlX2Rj
ID0gY2xrX21nci0+YmFzZS5jdHgtPmRjOworCXN0cnVjdCBkbWN1ICpkbWN1ID0gY29yZV9kYy0+
cmVzX3Bvb2wtPmRtY3U7CisKKwkvKiAgVW5pdCBvZiBTTVUgbXNnIHBhcmFtZXRlciBpcyBNaHog
Ki8KKwlhY3R1YWxfZGlzcGNsa19zZXRfbWh6ID0gcnYxX3ZiaW9zX3NtdV9zZW5kX21zZ193aXRo
X3BhcmFtKAorCQkJY2xrX21nciwKKwkJCVZCSU9TU01DX01TR19TZXREaXNwY2xrRnJlcSwKKwkJ
CXJlcXVlc3RlZF9kaXNwY2xrX2toeiAvIDEwMDApOworCisJLyogQWN0dWFsIGRpc3BjbGsgc2V0
IGlzIHJldHVybmVkIGluIHRoZSBwYXJhbWV0ZXIgcmVnaXN0ZXIgKi8KKwlhY3R1YWxfZGlzcGNs
a19zZXRfbWh6ID0gUkVHX1JFQUQoTVAxX1NNTl9DMlBNU0dfODMpICogMTAwMDsKIAogCWlmICgh
SVNfRlBHQV9NQVhJTVVTX0RDKGNvcmVfZGMtPmN0eC0+ZGNlX2Vudmlyb25tZW50KSkgewogCQlp
ZiAoZG1jdSAmJiBkbWN1LT5mdW5jcy0+aXNfZG1jdV9pbml0aWFsaXplZChkbWN1KSkgewotCQkJ
aWYgKGNsa19tZ3ItPmRmc19ieXBhc3NfZGlzcF9jbGsgIT0gYWN0dWFsX2Rpc3BjbGtfc2V0X2to
eikKKwkJCWlmIChjbGtfbWdyLT5kZnNfYnlwYXNzX2Rpc3BfY2xrICE9IGFjdHVhbF9kaXNwY2xr
X3NldF9taHopCiAJCQkJZG1jdS0+ZnVuY3MtPnNldF9wc3Jfd2FpdF9sb29wKGRtY3UsCi0JCQkJ
CQlhY3R1YWxfZGlzcGNsa19zZXRfa2h6IC8gMTAwMCAvIDcpOworCQkJCQkJYWN0dWFsX2Rpc3Bj
bGtfc2V0X21oeiAvIDcpOwogCQl9CiAJfQogCi0JcmV0dXJuIGFjdHVhbF9kaXNwY2xrX3NldF9r
aHo7CisJcmV0dXJuIGFjdHVhbF9kaXNwY2xrX3NldF9taHogKiAxMDAwOwogfQogCiBpbnQgcnYx
X3ZiaW9zX3NtdV9zZXRfZHByZWZjbGsoc3RydWN0IGNsa19tZ3JfaW50ZXJuYWwgKmNsa19tZ3Ip
CiB7Ci0JaW50IGFjdHVhbF9kcHJlZmNsa19zZXRfa2h6ID0gLTE7Ci0KLQlSRUdfV1JJVEUoTVAx
X1NNTl9DMlBNU0dfOTEsIDApOwotCi0JLyogU2V0IHRoZSBwYXJhbWV0ZXIgcmVnaXN0ZXIgZm9y
IHRoZSBTTVUgbWVzc2FnZSAqLwotCVJFR19XUklURShNUDFfU01OX0MyUE1TR184MywgY2xrX21n
ci0+YmFzZS5kcHJlZmNsa19raHogLyAxMDAwKTsKKwlpbnQgYWN0dWFsX2RwcmVmY2xrX3NldF9t
aHogPSAtMTsKIAotCS8qIFRyaWdnZXIgdGhlIG1lc3NhZ2UgdHJhbnNhY3Rpb24gYnkgd3JpdGlu
ZyB0aGUgbWVzc2FnZSBJRCAqLwotCVJFR19XUklURShNUDFfU01OX0MyUE1TR182NywgVkJJT1NT
TUNfTVNHX1NldERwcmVmY2xrRnJlcSk7Ci0KLQkvKiBXYWl0IGZvciBTTVUgcmVzcG9uc2UgKi8K
LQlSRUdfV0FJVChNUDFfU01OX0MyUE1TR185MSwgQ09OVEVOVCwgMSwgMTAsIDIwMDAwMCk7CisJ
YWN0dWFsX2RwcmVmY2xrX3NldF9taHogPSBydjFfdmJpb3Nfc211X3NlbmRfbXNnX3dpdGhfcGFy
YW0oCisJCQljbGtfbWdyLAorCQkJVkJJT1NTTUNfTVNHX1NldERwcmVmY2xrRnJlcSwKKwkJCWNs
a19tZ3ItPmJhc2UuZHByZWZjbGtfa2h6IC8gMTAwMCk7CiAKLQlhY3R1YWxfZHByZWZjbGtfc2V0
X2toeiA9IFJFR19SRUFEKE1QMV9TTU5fQzJQTVNHXzgzKSAqIDEwMDA7CisJLyogVE9ETzogYWRk
IGNvZGUgZm9yIHByb2dyYW1pbmcgRFAgRFRPLCBjdXJyZW50bHkgdGhpcyBpcyBkb3duIGJ5IGNv
bW1hbmQgdGFibGUgKi8KIAotCXJldHVybiBhY3R1YWxfZHByZWZjbGtfc2V0X2toejsKKwlyZXR1
cm4gYWN0dWFsX2RwcmVmY2xrX3NldF9taHogKiAxMDAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2Nsa19tZ3IvZGNuMjAvZGNuMjBfY2xrX21nci5jIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2Nsa19tZ3IvZGNuMjAvZGNuMjBfY2xrX21n
ci5jCmluZGV4IGNhM2U0MDA1Mzk3OC4uNTgxNGNhY2JlMWJlIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xrX21nci9kY24yMC9kY24yMF9jbGtfbWdyLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2Nsa19tZ3IvZGNuMjAvZGNuMjBfY2xr
X21nci5jCkBAIC0xMDEsMzAgKzEwMSw3IEBAIHN0YXRpYyB1aW50MzJfdCBkZW50aXN0X2dldF9k
aWRfZnJvbV9kaXZpZGVyKGludCBkaXZpZGVyKQogCXJldHVybiBkaXZpZGVyX2lkOwogfQogCi1z
dGF0aWMgaW50IGdldF9hY3RpdmVfZGlzcGxheV9jbnQoCi0JCXN0cnVjdCBkYyAqZGMsCi0JCXN0
cnVjdCBkY19zdGF0ZSAqY29udGV4dCkKLXsKLQlpbnQgaSwgZGlzcGxheV9jb3VudDsKLQotCWRp
c3BsYXlfY291bnQgPSAwOwotCWZvciAoaSA9IDA7IGkgPCBjb250ZXh0LT5zdHJlYW1fY291bnQ7
IGkrKykgewotCQljb25zdCBzdHJ1Y3QgZGNfc3RyZWFtX3N0YXRlICpzdHJlYW0gPSBjb250ZXh0
LT5zdHJlYW1zW2ldOwotCi0JCS8qCi0JCSAqIE9ubHkgbm90aWZ5IGFjdGl2ZSBzdHJlYW0gb3Ig
dmlydHVhbCBzdHJlYW0uCi0JCSAqIE5lZWQgdG8gbm90aWZ5IHZpcnR1YWwgc3RyZWFtIHRvIHdv
cmsgYXJvdW5kCi0JCSAqIGhlYWRsZXNzIGNhc2UuIEhQRCBkb2VzIG5vdCBmaXJlIHdoZW4gc3lz
dGVtIGlzIGluCi0JCSAqIFMwaTIuCi0JCSAqLwotCQlpZiAoIXN0cmVhbS0+ZHBtc19vZmYgfHwg
c3RyZWFtLT5zaWduYWwgPT0gU0lHTkFMX1RZUEVfVklSVFVBTCkKLQkJCWRpc3BsYXlfY291bnQr
KzsKLQl9Ci0KLQlyZXR1cm4gZGlzcGxheV9jb3VudDsKLX0KLQotc3RhdGljIHZvaWQgdXBkYXRl
X2Nsb2Nrc191cGRhdGVfZHBwX2R0byhzdHJ1Y3QgY2xrX21ncl9pbnRlcm5hbCAqY2xrX21nciwK
K3ZvaWQgZGNuMjBfdXBkYXRlX2Nsb2Nrc191cGRhdGVfZHBwX2R0byhzdHJ1Y3QgY2xrX21ncl9p
bnRlcm5hbCAqY2xrX21nciwKIAkJc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KQogewogCWludCBp
OwpAQCAtMTQzLDcgKzEyMCw3IEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV9jbG9ja3NfdXBkYXRlX2Rw
cF9kdG8oc3RydWN0IGNsa19tZ3JfaW50ZXJuYWwgKmNsa19tZ3IsCiAJfQogfQogCi1zdGF0aWMg
dm9pZCB1cGRhdGVfY2xvY2tzX3VwZGF0ZV9kZW50aXN0KHN0cnVjdCBjbGtfbWdyX2ludGVybmFs
ICpjbGtfbWdyKQordm9pZCBkY24yMF91cGRhdGVfY2xvY2tzX3VwZGF0ZV9kZW50aXN0KHN0cnVj
dCBjbGtfbWdyX2ludGVybmFsICpjbGtfbWdyKQogewogCWludCBkcHBfZGl2aWRlciA9IERFTlRJ
U1RfRElWSURFUl9SQU5HRV9TQ0FMRV9GQUNUT1IKIAkJCSogY2xrX21nci0+ZGVudGlzdF92Y29f
ZnJlcV9raHogLyBjbGtfbWdyLT5iYXNlLmNsa3MuZHBwY2xrX2toejsKQEAgLTE3Nyw3ICsxNTQs
NyBAQCB2b2lkIGRjbjJfdXBkYXRlX2Nsb2NrcyhzdHJ1Y3QgY2xrX21nciAqY2xrX21ncl9iYXNl
LAogCWJvb2wgZHBwX2Nsb2NrX2xvd2VyZWQgPSBmYWxzZTsKIAlzdHJ1Y3QgZG1jdSAqZG1jdSA9
IGNsa19tZ3JfYmFzZS0+Y3R4LT5kYy0+cmVzX3Bvb2wtPmRtY3U7CiAKLQlkaXNwbGF5X2NvdW50
ID0gZ2V0X2FjdGl2ZV9kaXNwbGF5X2NudChkYywgY29udGV4dCk7CisJZGlzcGxheV9jb3VudCA9
IGNsa19tZ3JfaGVscGVyX2dldF9hY3RpdmVfZGlzcGxheV9jbnQoZGMsIGNvbnRleHQpOwogCWlm
IChkYy0+cmVzX3Bvb2wtPnBwX3NtdSkKIAkJcHBfc211ID0gJmRjLT5yZXNfcG9vbC0+cHBfc211
LT5udl9mdW5jczsKIApAQCAtMjQ2LDE1ICsyMjMsMjEgQEAgdm9pZCBkY24yX3VwZGF0ZV9jbG9j
a3Moc3RydWN0IGNsa19tZ3IgKmNsa19tZ3JfYmFzZSwKIAogCWlmIChkcHBfY2xvY2tfbG93ZXJl
ZCkgewogCQkvLyBpZiBjbG9jayBpcyBiZWluZyBsb3dlcmVkLCBpbmNyZWFzZSBEVE8gYmVmb3Jl
IGxvd2VyaW5nIHJlZmNsawotCQl1cGRhdGVfY2xvY2tzX3VwZGF0ZV9kcHBfZHRvKGNsa19tZ3Is
IGNvbnRleHQpOwotCQl1cGRhdGVfY2xvY2tzX3VwZGF0ZV9kZW50aXN0KGNsa19tZ3IpOworCQlk
Y24yMF91cGRhdGVfY2xvY2tzX3VwZGF0ZV9kcHBfZHRvKGNsa19tZ3IsIGNvbnRleHQpOworCQlk
Y24yMF91cGRhdGVfY2xvY2tzX3VwZGF0ZV9kZW50aXN0KGNsa19tZ3IpOwogCX0gZWxzZSB7CiAJ
CS8vIGlmIGNsb2NrIGlzIGJlaW5nIHJhaXNlZCwgaW5jcmVhc2UgcmVmY2xrIGJlZm9yZSBsb3dl
cmluZyBEVE8KIAkJaWYgKHVwZGF0ZV9kcHBjbGsgfHwgdXBkYXRlX2Rpc3BjbGspCi0JCQl1cGRh
dGVfY2xvY2tzX3VwZGF0ZV9kZW50aXN0KGNsa19tZ3IpOworCQkJZGNuMjBfdXBkYXRlX2Nsb2Nr
c191cGRhdGVfZGVudGlzdChjbGtfbWdyKTsKIAkJaWYgKHVwZGF0ZV9kcHBjbGspCi0JCQl1cGRh
dGVfY2xvY2tzX3VwZGF0ZV9kcHBfZHRvKGNsa19tZ3IsIGNvbnRleHQpOworCQkJZGNuMjBfdXBk
YXRlX2Nsb2Nrc191cGRhdGVfZHBwX2R0byhjbGtfbWdyLCBjb250ZXh0KTsKKwl9CiAKKwlpZiAo
dXBkYXRlX2Rpc3BjbGsgJiYKKwkJCWRtY3UgJiYgZG1jdS0+ZnVuY3MtPmlzX2RtY3VfaW5pdGlh
bGl6ZWQoZG1jdSkpIHsKKwkJLyp1cGRhdGUgZG1jdSBmb3Igd2FpdF9sb29wIGNvdW50Ki8KKwkJ
ZG1jdS0+ZnVuY3MtPnNldF9wc3Jfd2FpdF9sb29wKGRtY3UsCisJCQljbGtfbWdyX2Jhc2UtPmNs
a3MuZGlzcGNsa19raHogLyAxMDAwIC8gNyk7CiAJfQogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xrX21nci9kY24yMC9kY24yMF9jbGtfbWdyLmggYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xrX21nci9kY24yMC9kY24yMF9jbGtfbWdy
LmgKaW5kZXggYTM0NzlmOTZlYjliLi5hNDRhZmMwNjI1YzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvZGlzcGxheS9kYy9jbGtfbWdyL2RjbjIwL2RjbjIwX2Nsa19tZ3IuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xrX21nci9kY24yMC9kY24yMF9jbGtf
bWdyLmgKQEAgLTMzLDYgKzMzLDggQEAgdm9pZCBkY24yX3VwZGF0ZV9jbG9ja3Moc3RydWN0IGNs
a19tZ3IgKmRjY2csCiB2b2lkIGRjbjJfdXBkYXRlX2Nsb2Nrc19mcGdhKHN0cnVjdCBjbGtfbWdy
ICpjbGtfbWdyLAogCQkJc3RydWN0IGRjX3N0YXRlICpjb250ZXh0LAogCQkJYm9vbCBzYWZlX3Rv
X2xvd2VyKTsKK3ZvaWQgZGNuMjBfdXBkYXRlX2Nsb2Nrc191cGRhdGVfZHBwX2R0byhzdHJ1Y3Qg
Y2xrX21ncl9pbnRlcm5hbCAqY2xrX21nciwKKwkJc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KTsK
IAogdm9pZCBkY24yX2luaXRfY2xvY2tzKHN0cnVjdCBjbGtfbWdyICpjbGtfbWdyKTsKIAotLSAK
Mi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwph
bWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
