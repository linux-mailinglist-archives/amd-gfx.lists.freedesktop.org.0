Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1124E5DCC5
	for <lists+amd-gfx@lfdr.de>; Wed,  3 Jul 2019 05:09:53 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A611E6E0C5;
	Wed,  3 Jul 2019 03:09:51 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM02-SN1-obe.outbound.protection.outlook.com
 (mail-eopbgr770087.outbound.protection.outlook.com [40.107.77.87])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5E4226E0C5
 for <amd-gfx@lists.freedesktop.org>; Wed,  3 Jul 2019 03:09:50 +0000 (UTC)
Received: from MN2PR12MB3296.namprd12.prod.outlook.com (20.179.80.139) by
 MN2PR12MB3552.namprd12.prod.outlook.com (20.179.80.209) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2052.16; Wed, 3 Jul 2019 03:09:45 +0000
Received: from MN2PR12MB3296.namprd12.prod.outlook.com
 ([fe80::154f:3d2f:d2ca:3a6e]) by MN2PR12MB3296.namprd12.prod.outlook.com
 ([fe80::154f:3d2f:d2ca:3a6e%3]) with mapi id 15.20.2032.019; Wed, 3 Jul 2019
 03:09:45 +0000
From: "Wang, Kevin(Yang)" <Kevin1.Wang@amd.com>
To: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: [PATCH] drm/amd/powerplay: add baco smu reset function for smu11
Thread-Topic: [PATCH] drm/amd/powerplay: add baco smu reset function for smu11
Thread-Index: AQHVMUzDt58TzgW1mEeWW1/RzCqXaw==
Date: Wed, 3 Jul 2019 03:09:45 +0000
Message-ID: <20190703030931.27890-1-kevin1.wang@amd.com>
Accept-Language: en-US, zh-CN
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: HK2PR04CA0059.apcprd04.prod.outlook.com
 (2603:1096:202:14::27) To MN2PR12MB3296.namprd12.prod.outlook.com
 (2603:10b6:208:aa::11)
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.22.0
x-originating-ip: [180.167.199.189]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 9469a05a-2e14-4444-40a9-08d6ff63e649
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);
 SRVR:MN2PR12MB3552; 
x-ms-traffictypediagnostic: MN2PR12MB3552:
x-microsoft-antispam-prvs: <MN2PR12MB3552D4069EB96136AA458836A2FB0@MN2PR12MB3552.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:255;
x-forefront-prvs: 00872B689F
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(366004)(136003)(396003)(39860400002)(376002)(346002)(199004)(189003)(73956011)(66946007)(50226002)(36756003)(8936002)(66446008)(64756008)(186003)(66556008)(66476007)(476003)(5660300002)(14454004)(3846002)(6116002)(316002)(54906003)(2616005)(7736002)(26005)(1076003)(305945005)(102836004)(6506007)(386003)(30864003)(52116002)(478600001)(72206003)(6916009)(2351001)(66066001)(2501003)(53936002)(86362001)(2906002)(68736007)(8676002)(81156014)(81166006)(71190400001)(5640700003)(486006)(71200400001)(25786009)(4326008)(14444005)(256004)(99286004)(6436002)(6512007)(6486002);
 DIR:OUT; SFP:1101; SCL:1; SRVR:MN2PR12MB3552;
 H:MN2PR12MB3296.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: Jo3lh4/Psi3iBN7ypEhC+/tRvZrvl/MyScuDpSJe9ufaoRwL0P/KWbe/z9//VmDcRYiKUoE6WicMSbdIJUekx8r3Xg8Z7sYP/uZXnqEeBLAVrrViBbq4qnyQkzj/3cc014JlL8UzM39h5JiMLk7p22BXkwhvQhe/vvSj1lmKsk81wrXOGzHPEAVzWmyIYIA6hsv1Fwd6nRsi7baBUK7KFvzRaSfQScVdCgOQOjRdlAxpFGHgMpjjGvkKMuaVpQQyGOgprHV3hGj7wh1MrWrbN9XfdhRdsftDxDcS9If4iDWJrJW6VHPBfsxXPH1tYBLTNvDJj8QxGysYvlbSsZV6Ckdg2GyVMPgbh/q/4Vp6j6Qtv2H05w6wMsTWkvq1BTB5vVFC7BbvTlZN+WZGNdjG6j+8KNz0+Gw5qARHAGZOXdw=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 9469a05a-2e14-4444-40a9-08d6ff63e649
X-MS-Exchange-CrossTenant-originalarrivaltime: 03 Jul 2019 03:09:45.3757 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: kevwa@amd.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR12MB3552
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=vrj9IhrxDI6Yhckl/xBUjPlEt+WU2TgaqtcJLmWLggI=;
 b=FvX4EYrFruwh6a0/zMHPTRmoYUJaxF3ICttJBRurAhlt9RFV4tf85WnVxmsIJRZ0v/6F7X5k9W9gw37ELGnyr3+jdpUFcYRAaO5nqL1xVQuY8VOQ0CzeugF2ja7y07aSEavr8opcwo97eh5xGwcgymU66myqvS6OfrZEDyCidr8=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Kevin1.Wang@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Xiao, Jack" <Jack.Xiao@amd.com>, "Huang, Ray" <Ray.Huang@amd.com>, "Wang,
 Kevin\(Yang\)" <Kevin1.Wang@amd.com>, "Zhang, Hawking" <Hawking.Zhang@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

YWRkIGJhY28gcmVzZXQgc3VwcG9ydCBmb3Igc211MTEuCml0IGNhbiBoZWxwIGdwdSBkbyBhc2lj
IHJlc2V0IHdoZW4gZ3B1IHJlY292ZXJ5LgoKQ2hhbmdlLUlkOiBJNzcxNGVkMDNhZDg3YzEzZTkz
Y2ExYTdlNmFlZjgxZWJhMTQ2NjdjOApTaWduZWQtb2ZmLWJ5OiBLZXZpbiBXYW5nIDxrZXZpbjEu
d2FuZ0BhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBfMC5j
ICAgICAgICB8ICA2ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9udi5jICAgICAgICAg
ICAgICAgfCAgOSArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5j
ICAgIHwgMTQgKysrCiAuLi4vZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2luYy9hbWRncHVfc211Lmgg
ICAgfCAyNiArKysrKysKIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2luYy9zbXVfdjEx
XzAuaCB8ICA4ICsrCiBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0LmMg
ICAgfCAgOCArKwogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211X3YxMV8wLmMgICAg
IHwgOTEgKysrKysrKysrKysrKysrKysrKwogNyBmaWxlcyBjaGFuZ2VkLCAxNTkgaW5zZXJ0aW9u
cygrKSwgMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nbWNfdjEwXzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBfMC5j
CmluZGV4IGI0MTE2OTI2MWY3ZC4uNDVkZDIyYTFlZjc3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9nbWNfdjEwXzAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nbWNfdjEwXzAuYwpAQCAtMjQ0LDggKzI0NCwxMCBAQCBzdGF0aWMgdm9pZCBnbWNfdjEw
XzBfZmx1c2hfZ3B1X3RsYihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAltdXRleF9sb2Nr
KCZhZGV2LT5tbWFuLmd0dF93aW5kb3dfbG9jayk7CiAKIAlnbWNfdjEwXzBfZmx1c2hfdm1faHVi
KGFkZXYsIHZtaWQsIEFNREdQVV9NTUhVQiwgMCk7Ci0JaWYgKCFhZGV2LT5tbWFuLmJ1ZmZlcl9m
dW5jc19lbmFibGVkIHx8ICFhZGV2LT5pYl9wb29sX3JlYWR5IHx8Ci0JICAgIGFkZXYtPmFzaWNf
dHlwZSAhPSBDSElQX05BVkkxMCkgeworCWlmICghYWRldi0+bW1hbi5idWZmZXJfZnVuY3NfZW5h
YmxlZCB8fAorCSAgICAhYWRldi0+aWJfcG9vbF9yZWFkeSB8fAorCSAgICBhZGV2LT5hc2ljX3R5
cGUgIT0gQ0hJUF9OQVZJMTAgfHwKKwkgICAgYWRldi0+aW5fZ3B1X3Jlc2V0KSB7CiAJCWdtY192
MTBfMF9mbHVzaF92bV9odWIoYWRldiwgdm1pZCwgQU1ER1BVX0dGWEhVQiwgMCk7CiAJCW11dGV4
X3VubG9jaygmYWRldi0+bW1hbi5ndHRfd2luZG93X2xvY2spOwogCQlyZXR1cm47CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9udi5jIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvbnYuYwppbmRleCA4ZjYwNTQxN2I0MGEuLmNjNWQwNjcxOGU0YyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9udi5jCkBAIC0zMSw2ICszMSw3IEBACiAjaW5jbHVkZSAiYW1kZ3B1X3ZjZS5o
IgogI2luY2x1ZGUgImFtZGdwdV91Y29kZS5oIgogI2luY2x1ZGUgImFtZGdwdV9wc3AuaCIKKyNp
bmNsdWRlICJhbWRncHVfc211LmgiCiAjaW5jbHVkZSAiYXRvbS5oIgogI2luY2x1ZGUgImFtZF9w
Y2llLmgiCiAKQEAgLTI2Niw4ICsyNjcsMTQgQEAgc3RhdGljIGludCBudl9hc2ljX3Jlc2V0KHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogCiAJYW1kZ3B1X2F0b21iaW9zX3NjcmF0Y2hfcmVn
c19lbmdpbmVfaHVuZyhhZGV2LCBmYWxzZSk7CiAjZW5kaWYKKwlpbnQgcmV0ID0gMDsKKwlzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSA9ICZhZGV2LT5zbXU7CiAKLQlyZXR1cm4gMDsKKwlpZiAoc211
X2JhY29faXNfc3VwcG9ydChzbXUpKSB7CisJCXJldCA9IHNtdV9iYWNvX3Jlc2V0KHNtdSk7CisJ
fQorCisJcmV0dXJuIHJldDsKIH0KIAogc3RhdGljIGludCBudl9zZXRfdXZkX2Nsb2NrcyhzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgdTMyIHZjbGssIHUzMiBkY2xrKQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jCmluZGV4IGIyOGE5MjNmOTk4ZC4uZmM0MTZj
Njg2MTUxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9hbWRncHVf
c211LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jCkBA
IC02MzMsNiArNjMzLDExIEBAIHN0YXRpYyBpbnQgc211X3N3X2luaXQodm9pZCAqaGFuZGxlKQog
CWJpdG1hcF96ZXJvKHNtdS0+c211X2ZlYXR1cmUuc3VwcG9ydGVkLCBTTVVfRkVBVFVSRV9NQVgp
OwogCWJpdG1hcF96ZXJvKHNtdS0+c211X2ZlYXR1cmUuZW5hYmxlZCwgU01VX0ZFQVRVUkVfTUFY
KTsKIAliaXRtYXBfemVybyhzbXUtPnNtdV9mZWF0dXJlLmFsbG93ZWQsIFNNVV9GRUFUVVJFX01B
WCk7CisKKwltdXRleF9pbml0KCZzbXUtPnNtdV9iYWNvLm11dGV4KTsKKwlzbXUtPnNtdV9iYWNv
LnN0YXRlID0gU01VX0JBQ09fU1RBVEVfRVhJVDsKKwlzbXUtPnNtdV9iYWNvLnBsYXRmb3JtX3N1
cHBvcnQgPSBmYWxzZTsKKwogCXNtdS0+d2F0ZXJtYXJrc19iaXRtYXAgPSAwOwogCXNtdS0+cG93
ZXJfcHJvZmlsZV9tb2RlID0gUFBfU01DX1BPV0VSX1BST0ZJTEVfQk9PVFVQX0RFRkFVTFQ7CiAJ
c211LT5kZWZhdWx0X3Bvd2VyX3Byb2ZpbGVfbW9kZSA9IFBQX1NNQ19QT1dFUl9QUk9GSUxFX0JP
T1RVUF9ERUZBVUxUOwpAQCAtMTA1NywxMSArMTA2MiwyMCBAQCBzdGF0aWMgaW50IHNtdV9zdXNw
ZW5kKHZvaWQgKmhhbmRsZSkKIAlpbnQgcmV0OwogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
ID0gKHN0cnVjdCBhbWRncHVfZGV2aWNlICopaGFuZGxlOwogCXN0cnVjdCBzbXVfY29udGV4dCAq
c211ID0gJmFkZXYtPnNtdTsKKwlib29sIGJhY29fZmVhdHVyZV9pc19lbmFibGVkID0gc211X2Zl
YXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0JBQ09fQklUKTsKIAogCXJldCA9IHNt
dV9zeXN0ZW1fZmVhdHVyZXNfY29udHJvbChzbXUsIGZhbHNlKTsKIAlpZiAocmV0KQogCQlyZXR1
cm4gcmV0OwogCisJaWYgKGFkZXYtPmluX2dwdV9yZXNldCAmJiBiYWNvX2ZlYXR1cmVfaXNfZW5h
YmxlZCkgeworCQlyZXQgPSBzbXVfZmVhdHVyZV9zZXRfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJF
X0JBQ09fQklULCB0cnVlKTsKKwkJaWYgKHJldCkgeworCQkJcHJfd2Fybigic2V0IEJBQ08gZmVh
dHVyZSBlbmFibGVkIGZhaWxlZCwgcmV0dXJuICVkXG4iLCByZXQpOworCQkJcmV0dXJuIHJldDsK
KwkJfQorCX0KKwogCXNtdS0+d2F0ZXJtYXJrc19iaXRtYXAgJj0gfihXQVRFUk1BUktTX0xPQURF
RCk7CiAKIAlpZiAoYWRldi0+YXNpY190eXBlID49IENISVBfTkFWSTEwICYmCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMvYW1kZ3B1X3NtdS5oIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5jL2FtZGdwdV9zbXUuaAppbmRleCAyODE4ZGY0NjQ4
MWMuLmM5NzMyNGVmN2RiMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBs
YXkvaW5jL2FtZGdwdV9zbXUuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9p
bmMvYW1kZ3B1X3NtdS5oCkBAIC0yNDEsNiArMjQxLDcgQEAgZW51bSBzbXVfbWVzc2FnZV90eXBl
CiAJU01VX01TR19Qb3dlclVwSnBlZywKIAlTTVVfTVNHX1Bvd2VyRG93bkpwZWcsCiAJU01VX01T
R19CYWNvQXVkaW9EM1BNRSwKKwlTTVVfTVNHX0FybUQzLAogCVNNVV9NU0dfTUFYX0NPVU5ULAog
fTsKIApAQCAtNDg5LDYgKzQ5MCwxOSBAQCBzdHJ1Y3QgbWNsb2NrX2xhdGVuY3lfdGFibGUgewog
CXN0cnVjdCBtY2xrX2xhdGVuY3lfZW50cmllcyAgZW50cmllc1tNQVhfUkVHVUxBUl9EUE1fTlVN
XTsKIH07CiAKK2VudW0gc211X2JhY29fc3RhdGUKK3sKKwlTTVVfQkFDT19TVEFURV9FTlRFUiA9
IDAsCisJU01VX0JBQ09fU1RBVEVfRVhJVCwKK307CisKK3N0cnVjdCBzbXVfYmFjb19jb250ZXh0
Cit7CisJc3RydWN0IG11dGV4IG11dGV4OworCXVpbnQzMl90IHN0YXRlOworCWJvb2wgcGxhdGZv
cm1fc3VwcG9ydDsKK307CisKICNkZWZpbmUgV09SS0xPQURfUE9MSUNZX01BWCA3CiBzdHJ1Y3Qg
c211X2NvbnRleHQKIHsKQEAgLTUwNSw2ICs1MTksNyBAQCBzdHJ1Y3Qgc211X2NvbnRleHQKIAlz
dHJ1Y3Qgc211X3Bvd2VyX2NvbnRleHQJc211X3Bvd2VyOwogCXN0cnVjdCBzbXVfZmVhdHVyZQkJ
c211X2ZlYXR1cmU7CiAJc3RydWN0IGFtZF9wcF9kaXNwbGF5X2NvbmZpZ3VyYXRpb24gICpkaXNw
bGF5X2NvbmZpZzsKKwlzdHJ1Y3Qgc211X2JhY29fY29udGV4dAkJc211X2JhY287CiAJdm9pZCAq
b2Rfc2V0dGluZ3M7CiAKIAl1aW50MzJfdCBwc3RhdGVfc2NsazsKQEAgLTY4MCw2ICs2OTUsMTEg
QEAgc3RydWN0IHNtdV9mdW5jcwogCWludCAoKnJlZ2lzdGVyX2lycV9oYW5kbGVyKShzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSk7CiAJaW50ICgqc2V0X2F6YWxpYV9kM19wbWUpKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211KTsKIAlpbnQgKCpnZXRfbWF4X3N1c3RhaW5hYmxlX2Nsb2Nrc19ieV9kYyko
c3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHN0cnVjdCBwcF9zbXVfbnZfY2xvY2tfdGFibGUgKm1h
eF9jbG9ja3MpOworCWJvb2wgKCpiYWNvX2lzX3N1cHBvcnQpKHN0cnVjdCBzbXVfY29udGV4dCAq
c211KTsKKwllbnVtIHNtdV9iYWNvX3N0YXRlICgqYmFjb19nZXRfc3RhdGUpKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211KTsKKwlpbnQgKCpiYWNvX3NldF9zdGF0ZSkoc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUsIGVudW0gc211X2JhY29fc3RhdGUgc3RhdGUpOworCWludCAoKmJhY29fcmVzZXQpKHN0
cnVjdCBzbXVfY29udGV4dCAqc211KTsKKwogfTsKIAogI2RlZmluZSBzbXVfaW5pdF9taWNyb2Nv
ZGUoc211KSBcCkBAIC04OTIsNiArOTEyLDEyIEBAIHN0cnVjdCBzbXVfZnVuY3MKIAkoKHNtdSkt
PmZ1bmNzLT5nZXRfbWF4X3N1c3RhaW5hYmxlX2Nsb2Nrc19ieV9kYyA/IChzbXUpLT5mdW5jcy0+
Z2V0X21heF9zdXN0YWluYWJsZV9jbG9ja3NfYnlfZGMoKHNtdSksIChtYXhfY2xvY2tzKSkgOiAw
KQogI2RlZmluZSBzbXVfZ2V0X3VjbGtfZHBtX3N0YXRlcyhzbXUsIGNsb2Nrc19pbl9raHosIG51
bV9zdGF0ZXMpIFwKIAkoKHNtdSktPnBwdF9mdW5jcy0+Z2V0X3VjbGtfZHBtX3N0YXRlcyA/IChz
bXUpLT5wcHRfZnVuY3MtPmdldF91Y2xrX2RwbV9zdGF0ZXMoKHNtdSksIChjbG9ja3NfaW5fa2h6
KSwgKG51bV9zdGF0ZXMpKSA6IDApCisjZGVmaW5lIHNtdV9iYWNvX2lzX3N1cHBvcnQoc211KSBc
CisJKChzbXUpLT5mdW5jcy0+YmFjb19pc19zdXBwb3J0PyAoc211KS0+ZnVuY3MtPmJhY29faXNf
c3VwcG9ydCgoc211KSkgOiBmYWxzZSkKKyNkZWZpbmUgc211X2JhY29fZ2V0X3N0YXRlKHNtdSwg
c3RhdGUpIFwKKwkoKHNtdSktPmZ1bmNzLT5iYWNvX2dldF9zdGF0ZT8gKHNtdSktPmZ1bmNzLT5i
YWNvX2dldF9zdGF0ZSgoc211KSwgKHN0YXRlKSkgOiAwKQorI2RlZmluZSBzbXVfYmFjb19yZXNl
dChzbXUpIFwKKwkoKHNtdSktPmZ1bmNzLT5iYWNvX3Jlc2V0PyAoc211KS0+ZnVuY3MtPmJhY29f
cmVzZXQoKHNtdSkpIDogMCkKIAogZXh0ZXJuIGludCBzbXVfZ2V0X2F0b21fZGF0YV90YWJsZShz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDMyX3QgdGFibGUsCiAJCQkJICAgdWludDE2X3Qg
KnNpemUsIHVpbnQ4X3QgKmZyZXYsIHVpbnQ4X3QgKmNyZXYsCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMvc211X3YxMV8wLmggYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL3Bvd2VycGxheS9pbmMvc211X3YxMV8wLmgKaW5kZXggZDkzY2Q3NjI2OWI0Li4yZmZmNGIx
NmNiNGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2luYy9zbXVf
djExXzAuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMvc211X3YxMV8w
LmgKQEAgLTEwNSw2ICsxMDUsMTQgQEAgc3RydWN0IHNtdV8xMV8wX3Bvd2VyX2NvbnRleHQgewog
CWVudW0gc211XzExXzBfcG93ZXJfc3RhdGUgcG93ZXJfc3RhdGU7CiB9OwogCitlbnVtIHNtdV92
MTFfMF9iYWNvX3NlcSB7CisJQkFDT19TRVFfQkFDTyA9IDAsCisJQkFDT19TRVFfTVNSLAorCUJB
Q09fU0VRX0JBTUFDTywKKwlCQUNPX1NFUV9VTFBTLAorCUJBQ09fU0VRX0NPVU5ULAorfTsKKwog
dm9pZCBzbXVfdjExXzBfc2V0X3NtdV9mdW5jcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSk7CiAK
ICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvbmF2aTEw
X3BwdC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvbmF2aTEwX3BwdC5jCmluZGV4
IDM3M2FlYmE0NGYxNi4uNzU3NGEwMjM1MGM2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dl
cnBsYXkvbmF2aTEwX3BwdC5jCkBAIC0xMTUsNiArMTE1LDcgQEAgc3RhdGljIGludCBuYXZpMTBf
bWVzc2FnZV9tYXBbU01VX01TR19NQVhfQ09VTlRdID0gewogCU1TR19NQVAoUG93ZXJVcEpwZWcs
CQlQUFNNQ19NU0dfUG93ZXJVcEpwZWcpLAogCU1TR19NQVAoUG93ZXJEb3duSnBlZywJCVBQU01D
X01TR19Qb3dlckRvd25KcGVnKSwKIAlNU0dfTUFQKEJhY29BdWRpb0QzUE1FLAkJUFBTTUNfTVNH
X0JhY29BdWRpb0QzUE1FKSwKKwlNU0dfTUFQKEFybUQzLAkJCVBQU01DX01TR19Bcm1EMyksCiB9
OwogCiBzdGF0aWMgaW50IG5hdmkxMF9jbGtfbWFwW1NNVV9DTEtfQ09VTlRdID0gewpAQCAtNDc4
LDYgKzQ3OSw3IEBAIHN0YXRpYyBpbnQgbmF2aTEwX3N0b3JlX3Bvd2VycGxheV90YWJsZShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSkKIHsKIAlzdHJ1Y3Qgc211XzExXzBfcG93ZXJwbGF5X3RhYmxl
ICpwb3dlcnBsYXlfdGFibGUgPSBOVUxMOwogCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFi
bGVfY29udGV4dCA9ICZzbXUtPnNtdV90YWJsZTsKKwlzdHJ1Y3Qgc211X2JhY29fY29udGV4dCAq
c211X2JhY28gPSAmc211LT5zbXVfYmFjbzsKIAogCWlmICghdGFibGVfY29udGV4dC0+cG93ZXJf
cGxheV90YWJsZSkKIAkJcmV0dXJuIC1FSU5WQUw7CkBAIC00ODksNiArNDkxLDEyIEBAIHN0YXRp
YyBpbnQgbmF2aTEwX3N0b3JlX3Bvd2VycGxheV90YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNt
dSkKIAogCXRhYmxlX2NvbnRleHQtPnRoZXJtYWxfY29udHJvbGxlcl90eXBlID0gcG93ZXJwbGF5
X3RhYmxlLT50aGVybWFsX2NvbnRyb2xsZXJfdHlwZTsKIAorCW11dGV4X2xvY2soJnNtdV9iYWNv
LT5tdXRleCk7CisJaWYgKHBvd2VycGxheV90YWJsZS0+cGxhdGZvcm1fY2FwcyAmIFNNVV8xMV8w
X1BQX1BMQVRGT1JNX0NBUF9CQUNPIHx8CisJICAgIHBvd2VycGxheV90YWJsZS0+cGxhdGZvcm1f
Y2FwcyAmIFNNVV8xMV8wX1BQX1BMQVRGT1JNX0NBUF9NQUNPKQorCQlzbXVfYmFjby0+cGxhdGZv
cm1fc3VwcG9ydCA9IHRydWU7CisJbXV0ZXhfdW5sb2NrKCZzbXVfYmFjby0+bXV0ZXgpOworCiAJ
cmV0dXJuIDA7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5
L3NtdV92MTFfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvc211X3YxMV8wLmMK
aW5kZXggZmYwNDdhYmQ4ZDkyLi5jNjc5NWRlNzE3N2YgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvcG93ZXJwbGF5L3NtdV92MTFfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
cG93ZXJwbGF5L3NtdV92MTFfMC5jCkBAIC0zNyw2ICszNyw3IEBACiAjaW5jbHVkZSAiYXNpY19y
ZWcvbXAvbXBfMTFfMF9vZmZzZXQuaCIKICNpbmNsdWRlICJhc2ljX3JlZy9tcC9tcF8xMV8wX3No
X21hc2suaCIKICNpbmNsdWRlICJhc2ljX3JlZy9uYmlvL25iaW9fN180X29mZnNldC5oIgorI2lu
Y2x1ZGUgImFzaWNfcmVnL25iaW8vbmJpb183XzRfc2hfbWFzay5oIgogI2luY2x1ZGUgImFzaWNf
cmVnL3NtdWlvL3NtdWlvXzExXzBfMF9vZmZzZXQuaCIKICNpbmNsdWRlICJhc2ljX3JlZy9zbXVp
by9zbXVpb18xMV8wXzBfc2hfbWFzay5oIgogCkBAIC0xNjM3LDYgKzE2MzgsOTIgQEAgc3RhdGlj
IGludCBzbXVfdjExXzBfc2V0X2F6YWxpYV9kM19wbWUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUp
CiAJcmV0dXJuIHJldDsKIH0KIAorc3RhdGljIGludCBzbXVfdjExXzBfYmFjb19zZXRfYXJtZDNf
c2VxdWVuY2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0gc211X3YxMV8wX2JhY29fc2Vx
IGJhY29fc2VxKQoreworCXJldHVybiBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LCBT
TVVfTVNHX0FybUQzLCBiYWNvX3NlcSk7Cit9CisKK3N0YXRpYyBib29sIHNtdV92MTFfMF9iYWNv
X2lzX3N1cHBvcnQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCit7CisJc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYgPSBzbXUtPmFkZXY7CisJc3RydWN0IHNtdV9iYWNvX2NvbnRleHQgKnNtdV9i
YWNvID0gJnNtdS0+c211X2JhY287CisJdWludDMyX3QgdmFsOworCWJvb2wgYmFjb19zdXBwb3J0
OworCisJbXV0ZXhfbG9jaygmc211X2JhY28tPm11dGV4KTsKKwliYWNvX3N1cHBvcnQgPSBzbXVf
YmFjby0+cGxhdGZvcm1fc3VwcG9ydDsKKwltdXRleF91bmxvY2soJnNtdV9iYWNvLT5tdXRleCk7
CisKKwlpZiAoIWJhY29fc3VwcG9ydCkKKwkJcmV0dXJuIGZhbHNlOworCisJaWYgKCFzbXVfZmVh
dHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfQkFDT19CSVQpKQorCQlyZXR1cm4gZmFs
c2U7CisKKwl2YWwgPSBSUkVHMzJfU09DMTUoTkJJTywgMCwgbW1SQ0NfQklGX1NUUkFQMCk7CisJ
aWYgKHZhbCAmIFJDQ19CSUZfU1RSQVAwX19TVFJBUF9QWF9DQVBBQkxFX01BU0spCisJCXJldHVy
biB0cnVlOworCisJcmV0dXJuIGZhbHNlOworfQorCitzdGF0aWMgZW51bSBzbXVfYmFjb19zdGF0
ZSBzbXVfdjExXzBfYmFjb19nZXRfc3RhdGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCit7CisJ
c3RydWN0IHNtdV9iYWNvX2NvbnRleHQgKnNtdV9iYWNvID0gJnNtdS0+c211X2JhY287CisJZW51
bSBzbXVfYmFjb19zdGF0ZSBiYWNvX3N0YXRlID0gU01VX0JBQ09fU1RBVEVfRVhJVDsKKworCW11
dGV4X2xvY2soJnNtdV9iYWNvLT5tdXRleCk7CisJYmFjb19zdGF0ZSA9IHNtdV9iYWNvLT5zdGF0
ZTsKKwltdXRleF91bmxvY2soJnNtdV9iYWNvLT5tdXRleCk7CisKKwlyZXR1cm4gYmFjb19zdGF0
ZTsKK30KKworc3RhdGljIGludCBzbXVfdjExXzBfYmFjb19zZXRfc3RhdGUoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUsIGVudW0gc211X2JhY29fc3RhdGUgc3RhdGUpCit7CisKKwlzdHJ1Y3Qgc211
X2JhY29fY29udGV4dCAqc211X2JhY28gPSAmc211LT5zbXVfYmFjbzsKKwlpbnQgcmV0ID0gMDsK
KworCWlmIChzbXVfdjExXzBfYmFjb19nZXRfc3RhdGUoc211KSA9PSBzdGF0ZSkKKwkJcmV0dXJu
IDA7CisKKwltdXRleF9sb2NrKCZzbXVfYmFjby0+bXV0ZXgpOworCisJaWYgKHN0YXRlID09IFNN
VV9CQUNPX1NUQVRFX0VOVEVSKQorCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0o
c211LCBTTVVfTVNHX0VudGVyQmFjbywgQkFDT19TRVFfQkFDTyk7CisJZWxzZQorCQlyZXQgPSBz
bXVfc2VuZF9zbWNfbXNnKHNtdSwgU01VX01TR19FeGl0QmFjbyk7CisJaWYgKHJldCkKKwkJZ290
byBvdXQ7CisKKwlzbXVfYmFjby0+c3RhdGUgPSBzdGF0ZTsKK291dDoKKwltdXRleF91bmxvY2so
JnNtdV9iYWNvLT5tdXRleCk7CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBzbXVfdjEx
XzBfYmFjb19yZXNldChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKK3sKKwlpbnQgcmV0ID0gMDsK
KworCXJldCA9IHNtdV92MTFfMF9iYWNvX3NldF9hcm1kM19zZXF1ZW5jZShzbXUsIEJBQ09fU0VR
X0JBQ08pOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlyZXQgPSBzbXVfdjExXzBfYmFj
b19zZXRfc3RhdGUoc211LCBTTVVfQkFDT19TVEFURV9FTlRFUik7CisJaWYgKHJldCkKKwkJcmV0
dXJuIHJldDsKKworCW1zbGVlcCgxMCk7CisKKwlyZXQgPSBzbXVfdjExXzBfYmFjb19zZXRfc3Rh
dGUoc211LCBTTVVfQkFDT19TVEFURV9FWElUKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0Owor
CisJcmV0dXJuIHJldDsKK30KKwogc3RhdGljIGNvbnN0IHN0cnVjdCBzbXVfZnVuY3Mgc211X3Yx
MV8wX2Z1bmNzID0gewogCS5pbml0X21pY3JvY29kZSA9IHNtdV92MTFfMF9pbml0X21pY3JvY29k
ZSwKIAkubG9hZF9taWNyb2NvZGUgPSBzbXVfdjExXzBfbG9hZF9taWNyb2NvZGUsCkBAIC0xNjg1
LDYgKzE3NzIsMTAgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBzbXVfZnVuY3Mgc211X3YxMV8wX2Z1
bmNzID0gewogCS5yZWdpc3Rlcl9pcnFfaGFuZGxlciA9IHNtdV92MTFfMF9yZWdpc3Rlcl9pcnFf
aGFuZGxlciwKIAkuc2V0X2F6YWxpYV9kM19wbWUgPSBzbXVfdjExXzBfc2V0X2F6YWxpYV9kM19w
bWUsCiAJLmdldF9tYXhfc3VzdGFpbmFibGVfY2xvY2tzX2J5X2RjID0gc211X3YxMV8wX2dldF9t
YXhfc3VzdGFpbmFibGVfY2xvY2tzX2J5X2RjLAorCS5iYWNvX2lzX3N1cHBvcnQ9IHNtdV92MTFf
MF9iYWNvX2lzX3N1cHBvcnQsCisJLmJhY29fZ2V0X3N0YXRlID0gc211X3YxMV8wX2JhY29fZ2V0
X3N0YXRlLAorCS5iYWNvX3NldF9zdGF0ZSA9IHNtdV92MTFfMF9iYWNvX3NldF9zdGF0ZSwKKwku
YmFjb19yZXNldCA9IHNtdV92MTFfMF9iYWNvX3Jlc2V0LAogfTsKIAogdm9pZCBzbXVfdjExXzBf
c2V0X3NtdV9mdW5jcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKLS0gCjIuMjIuMAoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5n
IGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
