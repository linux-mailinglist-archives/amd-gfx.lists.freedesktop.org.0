Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 88CD629D024
	for <lists+amd-gfx@lfdr.de>; Wed, 28 Oct 2020 14:49:22 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6908A6E51B;
	Wed, 28 Oct 2020 13:49:20 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-ej1-x642.google.com (mail-ej1-x642.google.com
 [IPv6:2a00:1450:4864:20::642])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 41C4F6E51B
 for <amd-gfx@lists.freedesktop.org>; Wed, 28 Oct 2020 13:49:19 +0000 (UTC)
Received: by mail-ej1-x642.google.com with SMTP id bn26so7301095ejb.6
 for <amd-gfx@lists.freedesktop.org>; Wed, 28 Oct 2020 06:49:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=CFIfU0NHubPs1+rfAs3LAvW5eEDbAotC/1Uo3cFMfYQ=;
 b=JvKrNZbDhFdKRUXYYAnXHYhNiySpKsnU0j3NvsAFRrJ1eIhZbp8eYjNZ37u2aDJqOj
 Q8WUWHdPECpmdEGxFPe9DXKBSluaGy7IOHhCXK2795+XjAE69a/q+DQ93HvDZt9+znAd
 mYp1eVNmi5JORP/JTMesO8uzDB1eD1XERGfw4BImJFYs0lNIMgloLQ7PSdAykdRSRi/1
 EjhdLzBlHKx5D3YlmURc5rIkppFA0YTbbySZVlC1R/wNOwDuo07KItSpOCaj5Er599cG
 tAiRgj9eK1ViNiCWuvMLY8OYW8B4Hcn1jh27NsY8VyOC59BaTxOG/Ia1+ShATkbogdF4
 Y0Bg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=CFIfU0NHubPs1+rfAs3LAvW5eEDbAotC/1Uo3cFMfYQ=;
 b=ihI89R7/O6gUBS00ZU1rB6chVtqpQWC/Lo5N91o1OpTGyJKfTVeY7+ljN0SJ4XxPAD
 F5TNOgd8KNzapsjXEIs3RS+WBU4VBiiC3EMzEqz6MiVsClOALwZTKQuglAhxQQKcKO1Z
 IwxtZq6wHjfb1hRkJ2d9kC60O/TYavmGiEr9yw8ZuH/ot6LZirbgg+hewQzoXW1HS+18
 lddkI8+dcM5n5mpHgj722re5Vw2m1tCAkkd9nBCe3aPVnkfV56c4dDNs28G5+swf2Edr
 6CYxeH00MpRRPtxcPt8c6o0BYLxvF0TpoNONtWCVDryUBg+HkkJ2i/2CZmpe2m9Y27mx
 1H8Q==
X-Gm-Message-State: AOAM533/2sNFrthze+8hrpSTipJKXWsoxy5hkyL/fVP8sgQ7Am3n5IX9
 rMSw6S3YW8EA+t0j0AlPt/ZweKK3YJY=
X-Google-Smtp-Source: ABdhPJx2+7n/zT/+qtUw1MvaTDkv31znWXQhMYuhcwfTadlNnbS8LFJ5AWH30w1rEfOiia7YPK87BQ==
X-Received: by 2002:a17:906:eb57:: with SMTP id
 mc23mr7516892ejb.373.1603892957345; 
 Wed, 28 Oct 2020 06:49:17 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:255f:19fe:a797:998b])
 by smtp.gmail.com with ESMTPSA id q19sm3049280ejx.118.2020.10.28.06.49.16
 for <amd-gfx@lists.freedesktop.org>
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 28 Oct 2020 06:49:16 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH] drm/amdgpu: cleanup gmc_v9_0_process_interrupt
Date: Wed, 28 Oct 2020 14:49:15 +0100
Message-Id: <20201028134915.36083-1-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
MIME-Version: 1.0
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

Rmlyc3Qgb2YgYWxsIGRvbid0IHNucHJpbnRmIGludG8gYSBjaGFyIGJ1ZmZlciBhbGxvY2F0ZWQg
b24gdGhlIHN0YWNrIHdpdGgKYSBjb25zdGFudCBodWJuYW1lLgoKVGhlbiBjbGVhbnVwIHRvIGV4
aXQgdGhlIGZ1bmN0aW9uIGVhcmx5IGluIGNhc2Ugb2YgYSByYXRlbGltaXQgb3IgU1JJT1YuCgpT
aWduZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+
Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAuYyB8IDE4MyArKysrKysr
KysrKysrLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDkxIGluc2VydGlvbnMoKyksIDky
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dt
Y192OV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjlfMC5jCmluZGV4IGE5
OTI5ZDFiNmIzZC4uMGMzNDIxZDU4N2U4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9nbWNfdjlfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192
OV8wLmMKQEAgLTUxMCwxNSArNTEwLDE2IEBAIHN0YXRpYyBpbnQgZ21jX3Y5XzBfdm1fZmF1bHRf
aW50ZXJydXB0X3N0YXRlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogfQogCiBzdGF0aWMg
aW50IGdtY192OV8wX3Byb2Nlc3NfaW50ZXJydXB0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
LAotCQkJCXN0cnVjdCBhbWRncHVfaXJxX3NyYyAqc291cmNlLAotCQkJCXN0cnVjdCBhbWRncHVf
aXZfZW50cnkgKmVudHJ5KQorCQkJCSAgICAgIHN0cnVjdCBhbWRncHVfaXJxX3NyYyAqc291cmNl
LAorCQkJCSAgICAgIHN0cnVjdCBhbWRncHVfaXZfZW50cnkgKmVudHJ5KQogewotCXN0cnVjdCBh
bWRncHVfdm1odWIgKmh1YjsKIAlib29sIHJldHJ5X2ZhdWx0ID0gISEoZW50cnktPnNyY19kYXRh
WzFdICYgMHg4MCk7CiAJdWludDMyX3Qgc3RhdHVzID0gMCwgY2lkID0gMCwgcncgPSAwOwotCXU2
NCBhZGRyOwotCWNoYXIgaHViX25hbWVbMTBdOworCXN0cnVjdCBhbWRncHVfdGFza19pbmZvIHRh
c2tfaW5mbzsKKwlzdHJ1Y3QgYW1kZ3B1X3ZtaHViICpodWI7CiAJY29uc3QgY2hhciAqbW1odWJf
Y2lkOworCWNvbnN0IGNoYXIgKmh1Yl9uYW1lOworCXU2NCBhZGRyOwogCiAJYWRkciA9ICh1NjQp
ZW50cnktPnNyY19kYXRhWzBdIDw8IDEyOwogCWFkZHIgfD0gKCh1NjQpZW50cnktPnNyY19kYXRh
WzFdICYgMHhmKSA8PCA0NDsKQEAgLTUyNywxMDUgKzUyOCwxMDMgQEAgc3RhdGljIGludCBnbWNf
djlfMF9wcm9jZXNzX2ludGVycnVwdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCQkJ
CSAgICBlbnRyeS0+dGltZXN0YW1wKSkKIAkJcmV0dXJuIDE7IC8qIFRoaXMgYWxzbyBwcmV2ZW50
cyBzZW5kaW5nIGl0IHRvIEtGRCAqLwogCisJLyogSWYgaXQncyB0aGUgZmlyc3QgZmF1bHQgZm9y
IHRoaXMgYWRkcmVzcywgcHJvY2VzcyBpdCBub3JtYWxseSAqLworCWlmIChyZXRyeV9mYXVsdCAm
JiAhaW5faW50ZXJydXB0KCkgJiYKKwkgICAgYW1kZ3B1X3ZtX2hhbmRsZV9mYXVsdChhZGV2LCBl
bnRyeS0+cGFzaWQsIGFkZHIpKQorCQlyZXR1cm4gMTsgLyogVGhpcyBhbHNvIHByZXZlbnRzIHNl
bmRpbmcgaXQgdG8gS0ZEICovCisKKwlpZiAoIXByaW50a19yYXRlbGltaXQoKSkKKwkJcmV0dXJu
IDA7CisKIAlpZiAoZW50cnktPmNsaWVudF9pZCA9PSBTT0MxNV9JSF9DTElFTlRJRF9WTUMpIHsK
LQkJc25wcmludGYoaHViX25hbWUsIHNpemVvZihodWJfbmFtZSksICJtbWh1YjAiKTsKKwkJaHVi
X25hbWUgPSAibW1odWIwIjsKIAkJaHViID0gJmFkZXYtPnZtaHViW0FNREdQVV9NTUhVQl8wXTsK
IAl9IGVsc2UgaWYgKGVudHJ5LT5jbGllbnRfaWQgPT0gU09DMTVfSUhfQ0xJRU5USURfVk1DMSkg
ewotCQlzbnByaW50ZihodWJfbmFtZSwgc2l6ZW9mKGh1Yl9uYW1lKSwgIm1taHViMSIpOworCQlo
dWJfbmFtZSA9ICJtbWh1YjEiOwogCQlodWIgPSAmYWRldi0+dm1odWJbQU1ER1BVX01NSFVCXzFd
OwogCX0gZWxzZSB7Ci0JCXNucHJpbnRmKGh1Yl9uYW1lLCBzaXplb2YoaHViX25hbWUpLCAiZ2Z4
aHViMCIpOworCQlodWJfbmFtZSA9ICJnZnhodWIwIjsKIAkJaHViID0gJmFkZXYtPnZtaHViW0FN
REdQVV9HRlhIVUJfMF07CiAJfQogCi0JLyogSWYgaXQncyB0aGUgZmlyc3QgZmF1bHQgZm9yIHRo
aXMgYWRkcmVzcywgcHJvY2VzcyBpdCBub3JtYWxseSAqLwotCWlmIChyZXRyeV9mYXVsdCAmJiAh
aW5faW50ZXJydXB0KCkgJiYKLQkgICAgYW1kZ3B1X3ZtX2hhbmRsZV9mYXVsdChhZGV2LCBlbnRy
eS0+cGFzaWQsIGFkZHIpKQotCQlyZXR1cm4gMTsgLyogVGhpcyBhbHNvIHByZXZlbnRzIHNlbmRp
bmcgaXQgdG8gS0ZEICovCisJbWVtc2V0KCZ0YXNrX2luZm8sIDAsIHNpemVvZihzdHJ1Y3QgYW1k
Z3B1X3Rhc2tfaW5mbykpOworCWFtZGdwdV92bV9nZXRfdGFza19pbmZvKGFkZXYsIGVudHJ5LT5w
YXNpZCwgJnRhc2tfaW5mbyk7CiAKLQlpZiAoIWFtZGdwdV9zcmlvdl92ZihhZGV2KSkgewotCQkv
KgotCQkgKiBJc3N1ZSBhIGR1bW15IHJlYWQgdG8gd2FpdCBmb3IgdGhlIHN0YXR1cyByZWdpc3Rl
ciB0bwotCQkgKiBiZSB1cGRhdGVkIHRvIGF2b2lkIHJlYWRpbmcgYW4gaW5jb3JyZWN0IHZhbHVl
IGR1ZSB0bwotCQkgKiB0aGUgbmV3IGZhc3QgR1JCTSBpbnRlcmZhY2UuCi0JCSAqLwotCQlpZiAo
ZW50cnktPnZtaWRfc3JjID09IEFNREdQVV9HRlhIVUJfMCkKLQkJCVJSRUczMihodWItPnZtX2wy
X3Byb19mYXVsdF9zdGF0dXMpOwotCi0JCXN0YXR1cyA9IFJSRUczMihodWItPnZtX2wyX3Byb19m
YXVsdF9zdGF0dXMpOwotCQljaWQgPSBSRUdfR0VUX0ZJRUxEKHN0YXR1cywKLQkJCQkgICAgVk1f
TDJfUFJPVEVDVElPTl9GQVVMVF9TVEFUVVMsIENJRCk7Ci0JCXJ3ID0gUkVHX0dFVF9GSUVMRChz
dGF0dXMsCi0JCQkJICAgVk1fTDJfUFJPVEVDVElPTl9GQVVMVF9TVEFUVVMsIFJXKTsKLQkJV1JF
RzMyX1AoaHViLT52bV9sMl9wcm9fZmF1bHRfY250bCwgMSwgfjEpOwotCX0KKwlkZXZfZXJyKGFk
ZXYtPmRldiwKKwkJIlslc10gJXMgcGFnZSBmYXVsdCAoc3JjX2lkOiV1IHJpbmc6JXUgdm1pZDol
dSAiCisJCSJwYXNpZDoldSwgZm9yIHByb2Nlc3MgJXMgcGlkICVkIHRocmVhZCAlcyBwaWQgJWQp
XG4iLAorCQlodWJfbmFtZSwgcmV0cnlfZmF1bHQgPyAicmV0cnkiIDogIm5vLXJldHJ5IiwKKwkJ
ZW50cnktPnNyY19pZCwgZW50cnktPnJpbmdfaWQsIGVudHJ5LT52bWlkLAorCQllbnRyeS0+cGFz
aWQsIHRhc2tfaW5mby5wcm9jZXNzX25hbWUsIHRhc2tfaW5mby50Z2lkLAorCQl0YXNrX2luZm8u
dGFza19uYW1lLCB0YXNrX2luZm8ucGlkKTsKKwlkZXZfZXJyKGFkZXYtPmRldiwgIiAgaW4gcGFn
ZSBzdGFydGluZyBhdCBhZGRyZXNzIDB4JTAxNmxseCBmcm9tIGNsaWVudCAlZFxuIiwKKwkJYWRk
ciwgZW50cnktPmNsaWVudF9pZCk7CiAKLQlpZiAocHJpbnRrX3JhdGVsaW1pdCgpKSB7Ci0JCXN0
cnVjdCBhbWRncHVfdGFza19pbmZvIHRhc2tfaW5mbzsKLQotCQltZW1zZXQoJnRhc2tfaW5mbywg
MCwgc2l6ZW9mKHN0cnVjdCBhbWRncHVfdGFza19pbmZvKSk7Ci0JCWFtZGdwdV92bV9nZXRfdGFz
a19pbmZvKGFkZXYsIGVudHJ5LT5wYXNpZCwgJnRhc2tfaW5mbyk7Ci0KLQkJZGV2X2VycihhZGV2
LT5kZXYsCi0JCQkiWyVzXSAlcyBwYWdlIGZhdWx0IChzcmNfaWQ6JXUgcmluZzoldSB2bWlkOiV1
ICIKLQkJCSJwYXNpZDoldSwgZm9yIHByb2Nlc3MgJXMgcGlkICVkIHRocmVhZCAlcyBwaWQgJWQp
XG4iLAotCQkJaHViX25hbWUsIHJldHJ5X2ZhdWx0ID8gInJldHJ5IiA6ICJuby1yZXRyeSIsCi0J
CQllbnRyeS0+c3JjX2lkLCBlbnRyeS0+cmluZ19pZCwgZW50cnktPnZtaWQsCi0JCQllbnRyeS0+
cGFzaWQsIHRhc2tfaW5mby5wcm9jZXNzX25hbWUsIHRhc2tfaW5mby50Z2lkLAotCQkJdGFza19p
bmZvLnRhc2tfbmFtZSwgdGFza19pbmZvLnBpZCk7Ci0JCWRldl9lcnIoYWRldi0+ZGV2LCAiICBp
biBwYWdlIHN0YXJ0aW5nIGF0IGFkZHJlc3MgMHglMDE2bGx4IGZyb20gY2xpZW50ICVkXG4iLAot
CQkJYWRkciwgZW50cnktPmNsaWVudF9pZCk7Ci0JCWlmICghYW1kZ3B1X3NyaW92X3ZmKGFkZXYp
KSB7Ci0JCQlkZXZfZXJyKGFkZXYtPmRldiwKLQkJCQkiVk1fTDJfUFJPVEVDVElPTl9GQVVMVF9T
VEFUVVM6MHglMDhYXG4iLAotCQkJCXN0YXR1cyk7Ci0JCQlpZiAoaHViID09ICZhZGV2LT52bWh1
YltBTURHUFVfR0ZYSFVCXzBdKSB7Ci0JCQkJZGV2X2VycihhZGV2LT5kZXYsICJcdCBGYXVsdHkg
VVRDTDIgY2xpZW50IElEOiAlcyAoMHgleClcbiIsCi0JCQkJCWNpZCA+PSBBUlJBWV9TSVpFKGdm
eGh1Yl9jbGllbnRfaWRzKSA/ICJ1bmtub3duIiA6IGdmeGh1Yl9jbGllbnRfaWRzW2NpZF0sCi0J
CQkJCWNpZCk7Ci0JCQl9IGVsc2UgewotCQkJCXN3aXRjaCAoYWRldi0+YXNpY190eXBlKSB7Ci0J
CQkJY2FzZSBDSElQX1ZFR0ExMDoKLQkJCQkJbW1odWJfY2lkID0gbW1odWJfY2xpZW50X2lkc192
ZWdhMTBbY2lkXVtyd107Ci0JCQkJCWJyZWFrOwotCQkJCWNhc2UgQ0hJUF9WRUdBMTI6Ci0JCQkJ
CW1taHViX2NpZCA9IG1taHViX2NsaWVudF9pZHNfdmVnYTEyW2NpZF1bcnddOwotCQkJCQlicmVh
azsKLQkJCQljYXNlIENISVBfVkVHQTIwOgotCQkJCQltbWh1Yl9jaWQgPSBtbWh1Yl9jbGllbnRf
aWRzX3ZlZ2EyMFtjaWRdW3J3XTsKLQkJCQkJYnJlYWs7Ci0JCQkJY2FzZSBDSElQX0FSQ1RVUlVT
OgotCQkJCQltbWh1Yl9jaWQgPSBtbWh1Yl9jbGllbnRfaWRzX2FyY3R1cnVzW2NpZF1bcnddOwot
CQkJCQlicmVhazsKLQkJCQljYXNlIENISVBfUkFWRU46Ci0JCQkJCW1taHViX2NpZCA9IG1taHVi
X2NsaWVudF9pZHNfcmF2ZW5bY2lkXVtyd107Ci0JCQkJCWJyZWFrOwotCQkJCWNhc2UgQ0hJUF9S
RU5PSVI6Ci0JCQkJCW1taHViX2NpZCA9IG1taHViX2NsaWVudF9pZHNfcmVub2lyW2NpZF1bcndd
OwotCQkJCQlicmVhazsKLQkJCQlkZWZhdWx0OgotCQkJCQltbWh1Yl9jaWQgPSBOVUxMOwotCQkJ
CQlicmVhazsKLQkJCQl9Ci0JCQkJZGV2X2VycihhZGV2LT5kZXYsICJcdCBGYXVsdHkgVVRDTDIg
Y2xpZW50IElEOiAlcyAoMHgleClcbiIsCi0JCQkJCW1taHViX2NpZCA/IG1taHViX2NpZCA6ICJ1
bmtub3duIiwgY2lkKTsKLQkJCX0KLQkJCWRldl9lcnIoYWRldi0+ZGV2LCAiXHQgTU9SRV9GQVVM
VFM6IDB4JWx4XG4iLAotCQkJCVJFR19HRVRfRklFTEQoc3RhdHVzLAotCQkJCVZNX0wyX1BST1RF
Q1RJT05fRkFVTFRfU1RBVFVTLCBNT1JFX0ZBVUxUUykpOwotCQkJZGV2X2VycihhZGV2LT5kZXYs
ICJcdCBXQUxLRVJfRVJST1I6IDB4JWx4XG4iLAotCQkJCVJFR19HRVRfRklFTEQoc3RhdHVzLAot
CQkJCVZNX0wyX1BST1RFQ1RJT05fRkFVTFRfU1RBVFVTLCBXQUxLRVJfRVJST1IpKTsKLQkJCWRl
dl9lcnIoYWRldi0+ZGV2LCAiXHQgUEVSTUlTU0lPTl9GQVVMVFM6IDB4JWx4XG4iLAotCQkJCVJF
R19HRVRfRklFTEQoc3RhdHVzLAotCQkJCVZNX0wyX1BST1RFQ1RJT05fRkFVTFRfU1RBVFVTLCBQ
RVJNSVNTSU9OX0ZBVUxUUykpOwotCQkJZGV2X2VycihhZGV2LT5kZXYsICJcdCBNQVBQSU5HX0VS
Uk9SOiAweCVseFxuIiwKLQkJCQlSRUdfR0VUX0ZJRUxEKHN0YXR1cywKLQkJCQlWTV9MMl9QUk9U
RUNUSU9OX0ZBVUxUX1NUQVRVUywgTUFQUElOR19FUlJPUikpOwotCQkJZGV2X2VycihhZGV2LT5k
ZXYsICJcdCBSVzogMHgleFxuIiwgcncpOworCWlmIChhbWRncHVfc3Jpb3ZfdmYoYWRldikpCisJ
CXJldHVybiAwOworCisJLyoKKwkgKiBJc3N1ZSBhIGR1bW15IHJlYWQgdG8gd2FpdCBmb3IgdGhl
IHN0YXR1cyByZWdpc3RlciB0bworCSAqIGJlIHVwZGF0ZWQgdG8gYXZvaWQgcmVhZGluZyBhbiBp
bmNvcnJlY3QgdmFsdWUgZHVlIHRvCisJICogdGhlIG5ldyBmYXN0IEdSQk0gaW50ZXJmYWNlLgor
CSAqLworCWlmIChlbnRyeS0+dm1pZF9zcmMgPT0gQU1ER1BVX0dGWEhVQl8wKQorCQlSUkVHMzIo
aHViLT52bV9sMl9wcm9fZmF1bHRfc3RhdHVzKTsKKworCXN0YXR1cyA9IFJSRUczMihodWItPnZt
X2wyX3Byb19mYXVsdF9zdGF0dXMpOworCWNpZCA9IFJFR19HRVRfRklFTEQoc3RhdHVzLCBWTV9M
Ml9QUk9URUNUSU9OX0ZBVUxUX1NUQVRVUywgQ0lEKTsKKwlydyA9IFJFR19HRVRfRklFTEQoc3Rh
dHVzLCBWTV9MMl9QUk9URUNUSU9OX0ZBVUxUX1NUQVRVUywgUlcpOworCVdSRUczMl9QKGh1Yi0+
dm1fbDJfcHJvX2ZhdWx0X2NudGwsIDEsIH4xKTsKKworCisJZGV2X2VycihhZGV2LT5kZXYsCisJ
CSJWTV9MMl9QUk9URUNUSU9OX0ZBVUxUX1NUQVRVUzoweCUwOFhcbiIsCisJCXN0YXR1cyk7CisJ
aWYgKGh1YiA9PSAmYWRldi0+dm1odWJbQU1ER1BVX0dGWEhVQl8wXSkgeworCQlkZXZfZXJyKGFk
ZXYtPmRldiwgIlx0IEZhdWx0eSBVVENMMiBjbGllbnQgSUQ6ICVzICgweCV4KVxuIiwKKwkJCWNp
ZCA+PSBBUlJBWV9TSVpFKGdmeGh1Yl9jbGllbnRfaWRzKSA/ICJ1bmtub3duIiA6CisJCQlnZnho
dWJfY2xpZW50X2lkc1tjaWRdLAorCQkJY2lkKTsKKwl9IGVsc2UgeworCQlzd2l0Y2ggKGFkZXYt
PmFzaWNfdHlwZSkgeworCQljYXNlIENISVBfVkVHQTEwOgorCQkJbW1odWJfY2lkID0gbW1odWJf
Y2xpZW50X2lkc192ZWdhMTBbY2lkXVtyd107CisJCQlicmVhazsKKwkJY2FzZSBDSElQX1ZFR0Ex
MjoKKwkJCW1taHViX2NpZCA9IG1taHViX2NsaWVudF9pZHNfdmVnYTEyW2NpZF1bcnddOworCQkJ
YnJlYWs7CisJCWNhc2UgQ0hJUF9WRUdBMjA6CisJCQltbWh1Yl9jaWQgPSBtbWh1Yl9jbGllbnRf
aWRzX3ZlZ2EyMFtjaWRdW3J3XTsKKwkJCWJyZWFrOworCQljYXNlIENISVBfQVJDVFVSVVM6CisJ
CQltbWh1Yl9jaWQgPSBtbWh1Yl9jbGllbnRfaWRzX2FyY3R1cnVzW2NpZF1bcnddOworCQkJYnJl
YWs7CisJCWNhc2UgQ0hJUF9SQVZFTjoKKwkJCW1taHViX2NpZCA9IG1taHViX2NsaWVudF9pZHNf
cmF2ZW5bY2lkXVtyd107CisJCQlicmVhazsKKwkJY2FzZSBDSElQX1JFTk9JUjoKKwkJCW1taHVi
X2NpZCA9IG1taHViX2NsaWVudF9pZHNfcmVub2lyW2NpZF1bcnddOworCQkJYnJlYWs7CisJCWRl
ZmF1bHQ6CisJCQltbWh1Yl9jaWQgPSBOVUxMOworCQkJYnJlYWs7CiAJCX0KKwkJZGV2X2Vycihh
ZGV2LT5kZXYsICJcdCBGYXVsdHkgVVRDTDIgY2xpZW50IElEOiAlcyAoMHgleClcbiIsCisJCQlt
bWh1Yl9jaWQgPyBtbWh1Yl9jaWQgOiAidW5rbm93biIsIGNpZCk7CiAJfQotCisJZGV2X2Vycihh
ZGV2LT5kZXYsICJcdCBNT1JFX0ZBVUxUUzogMHglbHhcbiIsCisJCVJFR19HRVRfRklFTEQoc3Rh
dHVzLAorCQlWTV9MMl9QUk9URUNUSU9OX0ZBVUxUX1NUQVRVUywgTU9SRV9GQVVMVFMpKTsKKwlk
ZXZfZXJyKGFkZXYtPmRldiwgIlx0IFdBTEtFUl9FUlJPUjogMHglbHhcbiIsCisJCVJFR19HRVRf
RklFTEQoc3RhdHVzLAorCQlWTV9MMl9QUk9URUNUSU9OX0ZBVUxUX1NUQVRVUywgV0FMS0VSX0VS
Uk9SKSk7CisJZGV2X2VycihhZGV2LT5kZXYsICJcdCBQRVJNSVNTSU9OX0ZBVUxUUzogMHglbHhc
biIsCisJCVJFR19HRVRfRklFTEQoc3RhdHVzLAorCQlWTV9MMl9QUk9URUNUSU9OX0ZBVUxUX1NU
QVRVUywgUEVSTUlTU0lPTl9GQVVMVFMpKTsKKwlkZXZfZXJyKGFkZXYtPmRldiwgIlx0IE1BUFBJ
TkdfRVJST1I6IDB4JWx4XG4iLAorCQlSRUdfR0VUX0ZJRUxEKHN0YXR1cywKKwkJVk1fTDJfUFJP
VEVDVElPTl9GQVVMVF9TVEFUVVMsIE1BUFBJTkdfRVJST1IpKTsKKwlkZXZfZXJyKGFkZXYtPmRl
diwgIlx0IFJXOiAweCV4XG4iLCBydyk7CiAJcmV0dXJuIDA7CiB9CiAKLS0gCjIuMTcuMQoKX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWls
aW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4Cg==
