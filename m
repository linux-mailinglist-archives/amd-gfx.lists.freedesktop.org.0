Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0A94D1A22E
	for <lists+amd-gfx@lfdr.de>; Fri, 10 May 2019 19:20:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 805FA89F3C;
	Fri, 10 May 2019 17:20:19 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM05-BY2-obe.outbound.protection.outlook.com
 (mail-eopbgr710072.outbound.protection.outlook.com [40.107.71.72])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7C92F89F4A
 for <amd-gfx@lists.freedesktop.org>; Fri, 10 May 2019 17:20:18 +0000 (UTC)
Received: from DM3PR12CA0061.namprd12.prod.outlook.com (2603:10b6:0:56::29) by
 BN7PR12MB2659.namprd12.prod.outlook.com (2603:10b6:408:29::25) with
 Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1856.12; Fri, 10 May 2019 17:20:17 +0000
Received: from CO1NAM03FT005.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e48::208) by DM3PR12CA0061.outlook.office365.com
 (2603:10b6:0:56::29) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.1878.21 via Frontend
 Transport; Fri, 10 May 2019 17:20:16 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV01.amd.com (165.204.84.17) by
 CO1NAM03FT005.mail.protection.outlook.com (10.152.80.156) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.1856.11 via Frontend Transport; Fri, 10 May 2019 17:20:16 +0000
Received: from blakha.amd.com (10.180.168.240) by SATLEXCHOV01.amd.com
 (10.181.40.71) with Microsoft SMTP Server id 14.3.389.1; Fri, 10 May 2019
 12:20:11 -0500
From: Bhawanpreet Lakha <Bhawanpreet.Lakha@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 03/16] drm/amd/display: Remove DPMS state dependency for fast
 boot
Date: Fri, 10 May 2019 13:19:22 -0400
Message-ID: <20190510171935.19792-4-Bhawanpreet.Lakha@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190510171935.19792-1-Bhawanpreet.Lakha@amd.com>
References: <20190510171935.19792-1-Bhawanpreet.Lakha@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(376002)(396003)(346002)(39860400002)(136003)(2980300002)(428003)(199004)(189003)(50466002)(5660300002)(36756003)(356004)(6666004)(1076003)(47776003)(48376002)(6916009)(305945005)(8676002)(70206006)(72206003)(478600001)(70586007)(476003)(426003)(2616005)(4326008)(16586007)(316002)(53936002)(2906002)(8936002)(81156014)(186003)(86362001)(77096007)(81166006)(336012)(486006)(446003)(50226002)(26005)(11346002)(126002)(2351001)(53416004)(76176011)(68736007)(7696005)(51416003);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BN7PR12MB2659; H:SATLEXCHOV01.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; A:1; MX:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 5a1aa3ef-47b5-412f-998c-08d6d56bc556
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600141)(711020)(4605104)(2017052603328);
 SRVR:BN7PR12MB2659; 
X-MS-TrafficTypeDiagnostic: BN7PR12MB2659:
X-Microsoft-Antispam-PRVS: <BN7PR12MB265946F83E4B2F3C31A67F2AF90C0@BN7PR12MB2659.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:8273;
X-Forefront-PRVS: 0033AAD26D
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: Hijg1+gkhLlYmheN8daDX+NF+HBVUxqvIFs+A3vWjG9yo/7Di3BuYurGm36G7G1kRWNFTIB1LrQ/FgSY14e22piiRQmkJlCjF5dUTmHpR5VVT7hAlgFyFuPbn1ISL6MDyLMnZ7nYGyjI8cuH0h9kEHbbq+zqFsAeoEYox9TCmxa9veYykgbG8IRwXmEEeAYv9q+Zol/6xsFx7+Mu4LwSGbRKbLhI5zESDHOcGXd1Be3Ej4+CVTZATHz3+RqWwVJN5+7fM8EVYBKUWTBUPyLbcuTI8H6216A31Q/+3+cgAe1vAmZIulpLz9wNtPxqj8Oau62Kp1hJ9dOt5k0juQpfk8FuoyPKBeibYxWtq9yL2L3xOvjcOSRxc2XcSreB7EB4XdmWrBcWMkjsQaL9FIA3dUbSJTsbPwY63n+dQe1h5uw=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 10 May 2019 17:20:16.5820 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 5a1aa3ef-47b5-412f-998c-08d6d56bc556
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV01.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN7PR12MB2659
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amd-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=les+gQGEc0BNIXiiHfDEoqsHPpk98fhI6z9Vob0DlPc=;
 b=dqEhdnPBljj9aaywDc2+2fMlyisoa8xZqPQAuqfefUv1W9WfuZTYLSEnz0f6Tljx60rQff5uaiSBKq417daWNpYowu8NUSjc3MU2j5G4nr5pNWKaYFcLW5s9FXQNc18EqEnPJZHroksSZZqd+GwWFtzcnIpMClgHPER8axko4EA=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: SivapiriyanKumarasamy <sivapiriyan.kumarasamy@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogU2l2YXBpcml5YW5LdW1hcmFzYW15IDxzaXZhcGlyaXlhbi5rdW1hcmFzYW15QGFtZC5j
b20+CgpbV2h5XQpUaGUgRFBNUyBzdGF0ZSBvZiBhIGRpc3BsYXkgc2hvdWxkIG5vdCBpbXBhY3Qg
d2hldGhlciB3ZSB3YW50IHRvIGVuYWJsZSBmYXN0IGJvb3QuCkN1cnJlbnRseSBmYXN0IGJvb3Qg
aXMgbm90IGVuYWJsZWQgd2hlbiByZXN1bWluZyBmcm9tIFM0IGJlY2F1c2Ugb2YgdGhpcy4KCltI
b3ddClJlbW92ZSBjaGVjayBmb3IgRFBNUyBzdGF0ZSB3aGVuIGRldGVybWluaW5nIGlmIGZhc3Qg
Ym9vdApjYW4gYmUgYXBwbGllZC4KClNpZ25lZC1vZmYtYnk6IFNpdmFwaXJpeWFuS3VtYXJhc2Ft
eSA8c2l2YXBpcml5YW4ua3VtYXJhc2FteUBhbWQuY29tPgpSZXZpZXdlZC1ieTogQW50aG9ueSBL
b28gPEFudGhvbnkuS29vQGFtZC5jb20+CkFja2VkLWJ5OiBCaGF3YW5wcmVldCBMYWtoYSA8Qmhh
d2FucHJlZXQuTGFraGFAYW1kLmNvbT4KLS0tCiAuLi4vZGlzcGxheS9kYy9kY2UxMTAvZGNlMTEw
X2h3X3NlcXVlbmNlci5jICAgfCA4NSArKysrKysrKy0tLS0tLS0tLS0tCiAxIGZpbGUgY2hhbmdl
ZCwgMzUgaW5zZXJ0aW9ucygrKSwgNTAgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjZTExMC9kY2UxMTBfaHdfc2VxdWVuY2VyLmMgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNlMTEwL2RjZTExMF9od19zZXF1ZW5jZXIu
YwppbmRleCA1OTE5NzE2ODMyYTUuLmQzYzgyMWYzODk5YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjZTExMC9kY2UxMTBfaHdfc2VxdWVuY2VyLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjZTExMC9kY2UxMTBfaHdfc2VxdWVuY2Vy
LmMKQEAgLTE0OTYsMTAgKzE0OTYsMTEgQEAgc3RhdGljIHZvaWQgZGlzYWJsZV92Z2FfYW5kX3Bv
d2VyX2dhdGVfYWxsX2NvbnRyb2xsZXJzKAogCX0KIH0KIAotc3RhdGljIHN0cnVjdCBkY19saW5r
ICpnZXRfbGlua19mb3JfZWRwKHN0cnVjdCBkYyAqZGMpCitzdGF0aWMgc3RydWN0IGRjX2xpbmsg
KmdldF9lZHBfbGluayhzdHJ1Y3QgZGMgKmRjKQogewogCWludCBpOwogCisJLy8gcmVwb3J0IGFu
eSBlRFAgbGlua3MsIGV2ZW4gdW5jb25uZWN0ZWQgRERJJ3MKIAlmb3IgKGkgPSAwOyBpIDwgZGMt
PmxpbmtfY291bnQ7IGkrKykgewogCQlpZiAoZGMtPmxpbmtzW2ldLT5jb25uZWN0b3Jfc2lnbmFs
ID09IFNJR05BTF9UWVBFX0VEUCkKIAkJCXJldHVybiBkYy0+bGlua3NbaV07CkBAIC0xNTA3LDIz
ICsxNTA4LDEzIEBAIHN0YXRpYyBzdHJ1Y3QgZGNfbGluayAqZ2V0X2xpbmtfZm9yX2VkcChzdHJ1
Y3QgZGMgKmRjKQogCXJldHVybiBOVUxMOwogfQogCi1zdGF0aWMgc3RydWN0IGRjX2xpbmsgKmdl
dF9saW5rX2Zvcl9lZHBfdG9fdHVybl9vZmYoCitzdGF0aWMgc3RydWN0IGRjX2xpbmsgKmdldF9l
ZHBfbGlua193aXRoX3NpbmsoCiAJCXN0cnVjdCBkYyAqZGMsCiAJCXN0cnVjdCBkY19zdGF0ZSAq
Y29udGV4dCkKIHsKIAlpbnQgaTsKIAlzdHJ1Y3QgZGNfbGluayAqbGluayA9IE5VTEw7CiAKLQkv
KiBjaGVjayBpZiBlRFAgcGFuZWwgaXMgc3VwcG9zZSB0byBiZSBzZXQgbW9kZSwgaWYgeWVzLCBu
byBuZWVkIHRvIGRpc2FibGUgKi8KLQlmb3IgKGkgPSAwOyBpIDwgY29udGV4dC0+c3RyZWFtX2Nv
dW50OyBpKyspIHsKLQkJaWYgKGNvbnRleHQtPnN0cmVhbXNbaV0tPnNpZ25hbCA9PSBTSUdOQUxf
VFlQRV9FRFApIHsKLQkJCWlmIChjb250ZXh0LT5zdHJlYW1zW2ldLT5kcG1zX29mZiA9PSB0cnVl
KQotCQkJCXJldHVybiBjb250ZXh0LT5zdHJlYW1zW2ldLT5zaW5rLT5saW5rOwotCQkJZWxzZQot
CQkJCXJldHVybiBOVUxMOwotCQl9Ci0JfQotCiAJLyogY2hlY2sgaWYgdGhlcmUgaXMgYW4gZURQ
IHBhbmVsIG5vdCBpbiB1c2UgKi8KIAlmb3IgKGkgPSAwOyBpIDwgZGMtPmxpbmtfY291bnQ7IGkr
KykgewogCQlpZiAoZGMtPmxpbmtzW2ldLT5sb2NhbF9zaW5rICYmCkBAIC0xNTQ2LDU5ICsxNTM3
LDUzIEBAIHN0YXRpYyBzdHJ1Y3QgZGNfbGluayAqZ2V0X2xpbmtfZm9yX2VkcF90b190dXJuX29m
ZigKIHZvaWQgZGNlMTEwX2VuYWJsZV9hY2NlbGVyYXRlZF9tb2RlKHN0cnVjdCBkYyAqZGMsIHN0
cnVjdCBkY19zdGF0ZSAqY29udGV4dCkKIHsKIAlpbnQgaTsKLQlzdHJ1Y3QgZGNfbGluayAqZWRw
X2xpbmtfdG9fdHVybm9mZiA9IE5VTEw7Ci0Jc3RydWN0IGRjX2xpbmsgKmVkcF9saW5rID0gZ2V0
X2xpbmtfZm9yX2VkcChkYyk7Ci0JYm9vbCBjYW5fZWRwX2Zhc3RfYm9vdF9vcHRpbWl6ZSA9IGZh
bHNlOwotCWJvb2wgYXBwbHlfZWRwX2Zhc3RfYm9vdF9vcHRpbWl6YXRpb24gPSBmYWxzZTsKKwlz
dHJ1Y3QgZGNfbGluayAqZWRwX2xpbmtfd2l0aF9zaW5rID0gZ2V0X2VkcF9saW5rX3dpdGhfc2lu
ayhkYywgY29udGV4dCk7CisJc3RydWN0IGRjX2xpbmsgKmVkcF9saW5rID0gZ2V0X2VkcF9saW5r
KGRjKTsKKwlib29sIGNhbl9hcHBseV9lZHBfZmFzdF9ib290ID0gZmFsc2U7CiAJYm9vbCBjYW5f
YXBwbHlfc2VhbWxlc3NfYm9vdCA9IGZhbHNlOwogCi0JZm9yIChpID0gMDsgaSA8IGNvbnRleHQt
PnN0cmVhbV9jb3VudDsgaSsrKSB7Ci0JCWlmIChjb250ZXh0LT5zdHJlYW1zW2ldLT5hcHBseV9z
ZWFtbGVzc19ib290X29wdGltaXphdGlvbikgewotCQkJY2FuX2FwcGx5X3NlYW1sZXNzX2Jvb3Qg
PSB0cnVlOwotCQkJYnJlYWs7Ci0JCX0KLQl9Ci0KIAlpZiAoZGMtPmh3c3MuaW5pdF9waXBlcykK
IAkJZGMtPmh3c3MuaW5pdF9waXBlcyhkYywgY29udGV4dCk7CiAKLQlpZiAoZWRwX2xpbmspIHsK
LQkJLyogdGhpcyBzZWVtcyB0byBjYXVzZSBibGFuayBzY3JlZW5zIG9uIERDRTggKi8KLQkJaWYg
KChkYy0+Y3R4LT5kY2VfdmVyc2lvbiA9PSBEQ0VfVkVSU0lPTl84XzApIHx8Ci0JCSAgICAoZGMt
PmN0eC0+ZGNlX3ZlcnNpb24gPT0gRENFX1ZFUlNJT05fOF8xKSB8fAotCQkgICAgKGRjLT5jdHgt
PmRjZV92ZXJzaW9uID09IERDRV9WRVJTSU9OXzhfMykpCi0JCQljYW5fZWRwX2Zhc3RfYm9vdF9v
cHRpbWl6ZSA9IGZhbHNlOwotCQllbHNlCi0JCQljYW5fZWRwX2Zhc3RfYm9vdF9vcHRpbWl6ZSA9
Ci0JCQkJZWRwX2xpbmstPmxpbmtfZW5jLT5mdW5jcy0+aXNfZGlnX2VuYWJsZWQoZWRwX2xpbmst
PmxpbmtfZW5jKTsKKwkvLyBDaGVjayBmYXN0Ym9vdCBzdXBwb3J0LCBkaXNhYmxlIG9uIERDRTgg
YmVjYXVzZSBvZiBibGFuayBzY3JlZW5zCisJaWYgKGVkcF9saW5rICYmIGRjLT5jdHgtPmRjZV92
ZXJzaW9uICE9IERDRV9WRVJTSU9OXzhfMCAmJgorCQkgICAgZGMtPmN0eC0+ZGNlX3ZlcnNpb24g
IT0gRENFX1ZFUlNJT05fOF8xICYmCisJCSAgICBkYy0+Y3R4LT5kY2VfdmVyc2lvbiAhPSBEQ0Vf
VkVSU0lPTl84XzMpIHsKKworCQkvLyBlbmFibGUgZmFzdGJvb3QgaWYgYmFja2VuZCBpcyBlbmFi
bGVkIG9uIGVEUAorCQlpZiAoZWRwX2xpbmstPmxpbmtfZW5jLT5mdW5jcy0+aXNfZGlnX2VuYWJs
ZWQoZWRwX2xpbmstPmxpbmtfZW5jKSkgeworCQkJLyogRmluZCBlRFAgc3RyZWFtIGFuZCBzZXQg
b3B0aW1pemF0aW9uIGZsYWcgKi8KKwkJCWZvciAoaSA9IDA7IGkgPCBjb250ZXh0LT5zdHJlYW1f
Y291bnQ7IGkrKykgeworCQkJCWlmIChjb250ZXh0LT5zdHJlYW1zW2ldLT5zaWduYWwgPT0gU0lH
TkFMX1RZUEVfRURQKSB7CisJCQkJCWNvbnRleHQtPnN0cmVhbXNbaV0tPmFwcGx5X2VkcF9mYXN0
X2Jvb3Rfb3B0aW1pemF0aW9uID0gdHJ1ZTsKKwkJCQkJY2FuX2FwcGx5X2VkcF9mYXN0X2Jvb3Qg
PSB0cnVlOworCQkJCQlicmVhazsKKwkJCQl9CisJCQl9CisJCX0KIAl9CiAKLQlpZiAoY2FuX2Vk
cF9mYXN0X2Jvb3Rfb3B0aW1pemUpCi0JCWVkcF9saW5rX3RvX3R1cm5vZmYgPSBnZXRfbGlua19m
b3JfZWRwX3RvX3R1cm5fb2ZmKGRjLCBjb250ZXh0KTsKLQotCS8qIGlmIE9TIGRvZXNuJ3QgbGln
aHQgdXAgZURQIGFuZCBlRFAgbGluayBpcyBhdmFpbGFibGUsIHdlIHdhbnQgdG8gZGlzYWJsZQot
CSAqIElmIHJlc3VtZSBmcm9tIFM0L1M1LCBzaG91bGQgb3B0aW1pemF0aW9uLgotCSAqLwotCWlm
IChjYW5fZWRwX2Zhc3RfYm9vdF9vcHRpbWl6ZSAmJiAhZWRwX2xpbmtfdG9fdHVybm9mZikgewot
CQkvKiBGaW5kIGVEUCBzdHJlYW0gYW5kIHNldCBvcHRpbWl6YXRpb24gZmxhZyAqLwotCQlmb3Ig
KGkgPSAwOyBpIDwgY29udGV4dC0+c3RyZWFtX2NvdW50OyBpKyspIHsKLQkJCWlmIChjb250ZXh0
LT5zdHJlYW1zW2ldLT5zaWduYWwgPT0gU0lHTkFMX1RZUEVfRURQKSB7Ci0JCQkJY29udGV4dC0+
c3RyZWFtc1tpXS0+YXBwbHlfZWRwX2Zhc3RfYm9vdF9vcHRpbWl6YXRpb24gPSB0cnVlOwotCQkJ
CWFwcGx5X2VkcF9mYXN0X2Jvb3Rfb3B0aW1pemF0aW9uID0gdHJ1ZTsKLQkJCX0KKwkvLyBDaGVj
ayBzZWFtbGVzcyBib290IHN1cHBvcnQKKwlmb3IgKGkgPSAwOyBpIDwgY29udGV4dC0+c3RyZWFt
X2NvdW50OyBpKyspIHsKKwkJaWYgKGNvbnRleHQtPnN0cmVhbXNbaV0tPmFwcGx5X3NlYW1sZXNz
X2Jvb3Rfb3B0aW1pemF0aW9uKSB7CisJCQljYW5fYXBwbHlfc2VhbWxlc3NfYm9vdCA9IHRydWU7
CisJCQlicmVhazsKIAkJfQogCX0KIAotCWlmICghYXBwbHlfZWRwX2Zhc3RfYm9vdF9vcHRpbWl6
YXRpb24gJiYgIWNhbl9hcHBseV9zZWFtbGVzc19ib290KSB7Ci0JCWlmIChlZHBfbGlua190b190
dXJub2ZmKSB7CisJLyogZURQIHNob3VsZCBub3QgaGF2ZSBzdHJlYW0gaW4gcmVzdW1lIGZyb20g
UzQgYW5kIHNvIGV2ZW4gd2l0aCBWQmlvcyBwb3N0CisJICogaXQgc2hvdWxkIGdldCB0dXJuZWQg
b2ZmCisJICovCisJaWYgKCFjYW5fYXBwbHlfZWRwX2Zhc3RfYm9vdCAmJiAhY2FuX2FwcGx5X3Nl
YW1sZXNzX2Jvb3QpIHsKKwkJaWYgKGVkcF9saW5rX3dpdGhfc2luaykgewogCQkJLyp0dXJuIG9m
ZiBiYWNrbGlnaHQgYmVmb3JlIERQX2JsYW5rIGFuZCBlbmNvZGVyIHBvd2VyZWQgZG93biovCi0J
CQlkYy0+aHdzcy5lZHBfYmFja2xpZ2h0X2NvbnRyb2woZWRwX2xpbmtfdG9fdHVybm9mZiwgZmFs
c2UpOworCQkJZGMtPmh3c3MuZWRwX2JhY2tsaWdodF9jb250cm9sKGVkcF9saW5rX3dpdGhfc2lu
aywgZmFsc2UpOwogCQl9CiAJCS8qcmVzdW1lIGZyb20gUzMsIG5vIHZiaW9zIHBvc3RpbmcsIG5v
IG5lZWQgdG8gcG93ZXIgZG93biBhZ2FpbiovCiAJCXBvd2VyX2Rvd25fYWxsX2h3X2Jsb2Nrcyhk
Yyk7CiAJCWRpc2FibGVfdmdhX2FuZF9wb3dlcl9nYXRlX2FsbF9jb250cm9sbGVycyhkYyk7Ci0J
CWlmIChlZHBfbGlua190b190dXJub2ZmKQotCQkJZGMtPmh3c3MuZWRwX3Bvd2VyX2NvbnRyb2wo
ZWRwX2xpbmtfdG9fdHVybm9mZiwgZmFsc2UpOworCQlpZiAoZWRwX2xpbmtfd2l0aF9zaW5rKQor
CQkJZGMtPmh3c3MuZWRwX3Bvd2VyX2NvbnRyb2woZWRwX2xpbmtfd2l0aF9zaW5rLCBmYWxzZSk7
CiAJfQogCWJpb3Nfc2V0X3NjcmF0Y2hfYWNjX21vZGVfY2hhbmdlKGRjLT5jdHgtPmRjX2Jpb3Mp
OwogfQotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
