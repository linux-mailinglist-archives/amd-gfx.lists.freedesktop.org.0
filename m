Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 388782F42A0
	for <lists+amd-gfx@lfdr.de>; Wed, 13 Jan 2021 04:44:30 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 26F5889CA1;
	Wed, 13 Jan 2021 03:44:28 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM12-BN8-obe.outbound.protection.outlook.com
 (mail-bn8nam12on2089.outbound.protection.outlook.com [40.107.237.89])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E999A89C85
 for <amd-gfx@lists.freedesktop.org>; Wed, 13 Jan 2021 03:44:26 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=aEatlzWUuaSkFyk3pkcud6RVfWJtzg95esWPB4kwW4fTkqFwfcwO3IwtObsMmuGT0iZbWx/cPhTJonDRz3/czAZZox8ecZ058jDxv4PDdWOKVmi4zV7a4fKZ2PHcUvTh6o7ONu0fc7a8zDj/avq/v3RhhE6V8CftXIGzGbuhU7c9BF0QlU+kH0VNNtBR6sb+ncZ7Ul0qyKr4hWbFTReaT4ovEVLCARt3Y3sfbDC7dHAUmre1PG59IoPI3aHohn7+rHD1HOCCPxjSHawWgdW2x9XI14UGOKf+2qp2nz7AamHzOXZLnVL+ofRW+KNfzaRISKjwTdBZOaO8a8iil4x3Ag==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=29tjfcBjN1E0k1bpFxNevR7nzjVZM7q1t4LXfzD7FH4=;
 b=DZ+6a0rjyuASrAH52D45egbtn50Tp4FBz/Iam5R4MU3BSUTKc3P9YzA0x68ajW2ycmn7l1FuSl8PvTcSyh1gEqXxjYZeKnChWOgGOfblNlGiM/Az1WW0y3ickhrMLnKIc9kJeM2hBWGchc9OvrbcbH8EeAkawjv1KUI1Tz1QeOqjYi32KkqK2bFevqYhZ7aIxssCmzGRQ7RFj3oM65gHp7PGzufWEj/QGlIYBr//9YGsQUJl9uQ1ePRgaY03lTEtD8Jqa4d0cyYqBdAqJNEV3bbzemjC1l9BNGukYk0XdhUaVNQIN22jJ2Sy+GJTwWyvflpspDOyp078mTDEyY727w==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=amd.com; s=selector1; 
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=29tjfcBjN1E0k1bpFxNevR7nzjVZM7q1t4LXfzD7FH4=;
 b=fiaY35ejvNw7D+ecWvNuKEqIiCX6Xupw6TWZjw0GqFoc6BtvmdKN6eq+PqE+m620pS1C2/SkI4rLmZgkWxVoQFW98dkEHIgf2HBT7O7a3t7sElsDmKuRJdhZhygURqga/NBqXbsXFU0ZJGAMA+qRRLCb0xAJZuuZh2GiHxX65VA=
Authentication-Results: lists.freedesktop.org; dkim=none (message not signed)
 header.d=none; lists.freedesktop.org;
 dmarc=none action=none header.from=amd.com;
Received: from DM6PR12MB2812.namprd12.prod.outlook.com (2603:10b6:5:44::27) by
 DM6PR12MB3593.namprd12.prod.outlook.com (2603:10b6:5:11c::28) with
 Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.3742.6; Wed, 13 Jan 2021 03:44:25 +0000
Received: from DM6PR12MB2812.namprd12.prod.outlook.com
 ([fe80::79e9:b52b:c230:6118]) by DM6PR12MB2812.namprd12.prod.outlook.com
 ([fe80::79e9:b52b:c230:6118%3]) with mapi id 15.20.3763.009; Wed, 13 Jan 2021
 03:44:25 +0000
From: Jinzhou Su <Jinzhou.Su@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 2/2] drm/amdgpu: Add secure display TA interface
Date: Wed, 13 Jan 2021 11:43:54 +0800
Message-Id: <20210113034354.14557-2-Jinzhou.Su@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20210113034354.14557-1-Jinzhou.Su@amd.com>
References: <20210113034354.14557-1-Jinzhou.Su@amd.com>
X-Originating-IP: [180.167.199.189]
X-ClientProxiedBy: HK2PR0302CA0018.apcprd03.prod.outlook.com
 (2603:1096:202::28) To DM6PR12MB2812.namprd12.prod.outlook.com
 (2603:10b6:5:44::27)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from jinzhosu-System-Product-Name.amd.com (180.167.199.189) by
 HK2PR0302CA0018.apcprd03.prod.outlook.com (2603:1096:202::28) with Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.3763.2 via Frontend Transport; Wed, 13 Jan 2021 03:44:22 +0000
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-HT: Tenant
X-MS-Office365-Filtering-Correlation-Id: 78d09fd0-aed4-4223-dbb4-08d8b7758576
X-MS-TrafficTypeDiagnostic: DM6PR12MB3593:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <DM6PR12MB359340E1BAD8C2AEF725568690A90@DM6PR12MB3593.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:2449;
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: 31rkrd5nrrNZfRnhociWjOfRYtqnJnd9IAI2SBDIxEsA+ZfwCtpr6jO42kDXhQgIGZBY3NeNknReith28aYE+qLaEjiagYFA5rZAmlsM+pYHNFYvIWR6dYIMetqnbcn9dPiD2W1XRAHp22OJ8yfkdeJLZmXOTqIpki3x5sVI0L1Sj6+TXDzlXJENxth9ktYPWCShKwrlbfbHouI5ydMKr2U+v8UpSvw9Lct1UEdskt4itzudeiufb0dGvugM/8VwsRFqaCCFlaqUDHDjLHFjHDZUdsI/U+K6LxfYpxh18rKMXDqeRe+/9zfzlU+t2Um41vJff4vddrmHH5J93csgoGKL8930Xbpalis0Q6FtqJVkFdf0RnucIDSCfK+8fAWjQx4hVV7QpVme217iTH09MAxkGmuoamTFxKrmJfNNoXqjYcuIIgLhOBVDu9BUd6DX
X-Forefront-Antispam-Report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:DM6PR12MB2812.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(4636009)(39860400002)(376002)(136003)(346002)(396003)(366004)(7696005)(83380400001)(30864003)(86362001)(8676002)(1076003)(6486002)(186003)(2616005)(316002)(956004)(5660300002)(478600001)(52116002)(16526019)(6916009)(66556008)(4326008)(2906002)(66476007)(66946007)(26005)(8936002)(6666004)(36756003)(21314003);
 DIR:OUT; SFP:1101; 
X-MS-Exchange-AntiSpam-MessageData: =?utf-8?B?eDZDdUJBUmpJVWNYYmNVMjlJdFFGY0daVzVtbU93aE5kaDFxMDBWMUx2UFEw?=
 =?utf-8?B?ZE1IL1J2N1lKcmplQWl1b2grY0xyR3lqTXcyNUhOR2hJN3l0em1RVGtIU0M0?=
 =?utf-8?B?ZUZqRUF0dFhneHdPU25rSExQNEtyNllrRFh2bEVOVTR0SHlGL041NVJIeWFF?=
 =?utf-8?B?UlM0S2Z4ZmZlaVhqb2F4bWcyZmlGZUZKbjRpd0g0WlkvU3BaRWxmZUk2dlVv?=
 =?utf-8?B?K1pZbUtGV0g2OUJJcytDWVBqRXBDTFd1S3NDREMyLyt0aytsTGI5L3o1NkNl?=
 =?utf-8?B?NXEzTmJoR3ROT0p2VHdaVW1BYVA0MG1zdFZrZkplUFVuWjZSV0FQYVpMcFZV?=
 =?utf-8?B?MkdyVzFEbHdyejBvRHVBT0tqOWNiTFRScUxsS1NpSGh3UGkrVWNFcXpIZXlw?=
 =?utf-8?B?c0F3cmV6YXBlS3o0eVNjWlBFWlYwY0hCeTB4ZGN2NW10ZEpYVGcxTkZnMGtT?=
 =?utf-8?B?UVlRWjlISWo4Z2FyZ0FselZsd3JQamZMTjNIb1oyL2dsQ0tnRVdzUm8rajVu?=
 =?utf-8?B?OGpuY1lPUTVKUVhuOTFuL2FGU2ZEUEQ0TldrNElsME4wWFhOSDdrN0tSWUp5?=
 =?utf-8?B?RUp0eWxYZ2NZaUJzaGQxVmVJUUJsbDZ3d21oYi9xditBSHpsdGJuMytTYWJu?=
 =?utf-8?B?dTFpcmZ6LytBcCtLRlEyVFk3K1VLSlQzaEFoZmdRZlM2eDN4QlpOQ2hQVlpm?=
 =?utf-8?B?RDZlNFNvL1B5ZEkzQ1NlSHFBU3MzRWk3R2RidkZ2emlZSFJVeHJnNzJrUTN5?=
 =?utf-8?B?NGo5cm9DWGxzT1Y5UURsMis3a01nQWZxcGRvQ24zQzJ3amxkN3o5YlFGckZS?=
 =?utf-8?B?OG9ReHlrd083ZCt6b0s2OHJDQjJ6cVgzN2llNkI5Vjd6TzlYTjZvdllGcHVL?=
 =?utf-8?B?bGVoV3hCUFd0b0JZci9LV2lHT0daUFBUZ2R0K2tMQWVKemZMWkl6NzNPMFFu?=
 =?utf-8?B?ckdMS1ZaaWJjdjZhVmplZ2ptSHkvbTVTY0l4SUxvTExBR1RLUENIaFJ3N29V?=
 =?utf-8?B?Rmh5UXY0VzkwZkhzQi82Sk95b1M1S1E0VkxkQ0dsWncvZ09VNEVScWgvSk05?=
 =?utf-8?B?U1RIYkt4U1hiTG02SHlhY3RUL0hlRHZ6bisyR0FackllZGVYVTF3ZmdFNys5?=
 =?utf-8?B?OUYrNHVlbVM1OUU2YWhXZjQwdmgrVm8xUG9lalNwZ0Q4N0Z6cmJGQU9IWWRL?=
 =?utf-8?B?bEUwNnB3QUJXbU05bHA1aS95Vll1NDlxV3JpQkJkS3hMamp6SEluZmtFakJs?=
 =?utf-8?B?OWE1T1lFb3BaZFVJREZEOGRjQXZJeCttV3dXQll4QmJ5cURWOE5lTUxZa0FI?=
 =?utf-8?Q?jZBWh4S5MQSF7PhHqC0PHM8sMkQ35dZNjf?=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-AuthSource: DM6PR12MB2812.namprd12.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 13 Jan 2021 03:44:25.0337 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-Network-Message-Id: 78d09fd0-aed4-4223-dbb4-08d8b7758576
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: qBTX0Z6vSNXaJ74Ox3Ky81cOW+sJhU7lAHGFFHow1m+Oi/4x2IxUAT9gZ6/Cbi6ubIBwU7WVwQ1HoAV0YdXCQA==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB3593
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Jinzhou Su <Jinzhou.Su@amd.com>, ray.huang@amd.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QWRkIGludGVyZmFjZSB0byBsb2FkLCB1bmxvYWQsIGludm9rZSBjb21tYW5kIGZvcgpzZWN1cmUg
ZGlzcGxheSBUQS4KCnYyOiBBZGQgZGVidWdmcyBpbnRlcmZhY2UgZm9yIHNlY3VyZSBkaXNwbGF5
IFRBCgpTaWduZWQtb2ZmLWJ5OiBKaW56aG91LlN1IDxKaW56aG91LlN1QGFtZC5jb20+ClJldmll
d2VkLWJ5OiBIdWFuZyBSdWkgPHJheS5odWFuZ0BhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L01ha2VmaWxlICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2RlYnVnZnMuYyAgIHwgICAzICsKIGRyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9wc3AuYyAgICAgICB8IDE5NSArKysrKysrKysrKysrKysrKysKIGRy
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wc3AuaCAgICAgICB8ICAxNyArKwogLi4u
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfc2VjdXJlZGlzcGxheS5jIHwgMTc0ICsrKysrKysr
KysrKysrKysKIC4uLi9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3NlY3VyZWRpc3BsYXkuaCB8
ICAzNiArKysrCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdWNvZGUuaCAgICAg
fCAgIDQgKwogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvcHNwX3YxMF8wLmMgICAgICAgIHwg
IDEyICstCiA4IGZpbGVzIGNoYW5nZWQsIDQ0MCBpbnNlcnRpb25zKCspLCAzIGRlbGV0aW9ucygt
KQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9z
ZWN1cmVkaXNwbGF5LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfc2VjdXJlZGlzcGxheS5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9NYWtlZmls
ZQppbmRleCBjNjI2MjY4OWUxNGUuLmU0YmViYmZhODhhZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvTWFrZWZpbGUKQEAgLTU2LDcgKzU2LDcgQEAgYW1kZ3B1LXkgKz0gYW1kZ3B1X2RldmljZS5v
IGFtZGdwdV9rbXMubyBcCiAJYW1kZ3B1X2dtYy5vIGFtZGdwdV9tbWh1Yi5vIGFtZGdwdV94Z21p
Lm8gYW1kZ3B1X2NzYS5vIGFtZGdwdV9yYXMubyBhbWRncHVfdm1fY3B1Lm8gXAogCWFtZGdwdV92
bV9zZG1hLm8gYW1kZ3B1X2Rpc2NvdmVyeS5vIGFtZGdwdV9yYXNfZWVwcm9tLm8gYW1kZ3B1X25i
aW8ubyBcCiAJYW1kZ3B1X3VtYy5vIHNtdV92MTFfMF9pMmMubyBhbWRncHVfZnJ1X2VlcHJvbS5v
IGFtZGdwdV9yYXAubyBcCi0JYW1kZ3B1X2Z3X2F0dGVzdGF0aW9uLm8KKwlhbWRncHVfZndfYXR0
ZXN0YXRpb24ubyBhbWRncHVfc2VjdXJlZGlzcGxheS5vCiAKIGFtZGdwdS0kKENPTkZJR19QRVJG
X0VWRU5UUykgKz0gYW1kZ3B1X3BtdS5vCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfZGVidWdmcy5jCmluZGV4IDQ3N2JlYWQ0ZmFiMS4uNGMzOGM1NzcxY2JjIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGVidWdmcy5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZWJ1Z2ZzLmMKQEAgLTM1LDYgKzM1LDcg
QEAKICNpbmNsdWRlICJhbWRncHVfZG1fZGVidWdmcy5oIgogI2luY2x1ZGUgImFtZGdwdV9yYXMu
aCIKICNpbmNsdWRlICJhbWRncHVfcmFwLmgiCisjaW5jbHVkZSAiYW1kZ3B1X3NlY3VyZWRpc3Bs
YXkuaCIKICNpbmNsdWRlICJhbWRncHVfZndfYXR0ZXN0YXRpb24uaCIKIAogLyoqCkBAIC0xNjY2
LDYgKzE2NjcsOCBAQCBpbnQgYW1kZ3B1X2RlYnVnZnNfaW5pdChzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldikKIAogCWFtZGdwdV9yYXBfZGVidWdmc19pbml0KGFkZXYpOwogCisJYW1kZ3B1X3Nl
Y3VyZWRpc3BsYXlfZGVidWdmc19pbml0KGFkZXYpOworCiAJYW1kZ3B1X2Z3X2F0dGVzdGF0aW9u
X2RlYnVnZnNfaW5pdChhZGV2KTsKIAogCXJldHVybiBhbWRncHVfZGVidWdmc19hZGRfZmlsZXMo
YWRldiwgYW1kZ3B1X2RlYnVnZnNfbGlzdCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9wc3AuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9wc3AuYwppbmRleCA1MjNkMjJkYjA5NGIuLmViMTlhZTczNDM5NiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BzcC5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9wc3AuYwpAQCAtMzYsNiArMzYsNyBAQAogI2luY2x1ZGUgInBz
cF92MTJfMC5oIgogCiAjaW5jbHVkZSAiYW1kZ3B1X3Jhcy5oIgorI2luY2x1ZGUgImFtZGdwdV9z
ZWN1cmVkaXNwbGF5LmgiCiAKIHN0YXRpYyBpbnQgcHNwX3N5c2ZzX2luaXQoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYpOwogc3RhdGljIHZvaWQgcHNwX3N5c2ZzX2Zpbmkoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYpOwpAQCAtMTY0Miw2ICsxNjQzLDE3OSBAQCBpbnQgcHNwX3JhcF9pbnZv
a2Uoc3RydWN0IHBzcF9jb250ZXh0ICpwc3AsIHVpbnQzMl90IHRhX2NtZF9pZCkKIH0KIC8vIFJB
UCBlbmQKIAorLyogc2VjdXJlZGlzcGxheSBzdGFydCAqLworc3RhdGljIGludCBwc3Bfc2VjdXJl
ZGlzcGxheV9pbml0X3NoYXJlZF9idWYoc3RydWN0IHBzcF9jb250ZXh0ICpwc3ApCit7CisJaW50
IHJldDsKKworCS8qCisJICogQWxsb2NhdGUgMTZrIG1lbW9yeSBhbGlnbmVkIHRvIDRrIGZyb20g
RnJhbWUgQnVmZmVyIChsb2NhbAorCSAqIHBoeXNpY2FsKSBmb3Igc2EgdGEgPC0+IERyaXZlcgor
CSAqLworCXJldCA9IGFtZGdwdV9ib19jcmVhdGVfa2VybmVsKHBzcC0+YWRldiwgUFNQX1NFQ1VS
RURJU1BMQVlfU0hBUkVEX01FTV9TSVpFLAorCQkJCSAgICAgIFBBR0VfU0laRSwgQU1ER1BVX0dF
TV9ET01BSU5fVlJBTSwKKwkJCQkgICAgICAmcHNwLT5zZWN1cmVkaXNwbGF5X2NvbnRleHQuc2Vj
dXJlZGlzcGxheV9zaGFyZWRfYm8sCisJCQkJICAgICAgJnBzcC0+c2VjdXJlZGlzcGxheV9jb250
ZXh0LnNlY3VyZWRpc3BsYXlfc2hhcmVkX21jX2FkZHIsCisJCQkJICAgICAgJnBzcC0+c2VjdXJl
ZGlzcGxheV9jb250ZXh0LnNlY3VyZWRpc3BsYXlfc2hhcmVkX2J1Zik7CisKKwlyZXR1cm4gcmV0
OworfQorCitzdGF0aWMgaW50IHBzcF9zZWN1cmVkaXNwbGF5X2xvYWQoc3RydWN0IHBzcF9jb250
ZXh0ICpwc3ApCit7CisJaW50IHJldDsKKwlzdHJ1Y3QgcHNwX2dmeF9jbWRfcmVzcCAqY21kOwor
CisJLyoKKwkgKiBUT0RPOiBieXBhc3MgdGhlIGxvYWRpbmcgaW4gc3Jpb3YgZm9yIG5vdworCSAq
LworCisJY21kID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IHBzcF9nZnhfY21kX3Jlc3ApLCBHRlBf
S0VSTkVMKTsKKwlpZiAoIWNtZCkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwltZW1zZXQocHNwLT5m
d19wcmlfYnVmLCAwLCBQU1BfMV9NRUcpOworCW1lbWNweShwc3AtPmZ3X3ByaV9idWYsIHBzcC0+
dGFfc2VjdXJlZGlzcGxheV9zdGFydF9hZGRyLCBwc3AtPnRhX3NlY3VyZWRpc3BsYXlfdWNvZGVf
c2l6ZSk7CisKKwlwc3BfcHJlcF90YV9sb2FkX2NtZF9idWYoY21kLAorCQkJCSBwc3AtPmZ3X3By
aV9tY19hZGRyLAorCQkJCSBwc3AtPnRhX3NlY3VyZWRpc3BsYXlfdWNvZGVfc2l6ZSwKKwkJCQkg
cHNwLT5zZWN1cmVkaXNwbGF5X2NvbnRleHQuc2VjdXJlZGlzcGxheV9zaGFyZWRfbWNfYWRkciwK
KwkJCQkgUFNQX1NFQ1VSRURJU1BMQVlfU0hBUkVEX01FTV9TSVpFKTsKKworCXJldCA9IHBzcF9j
bWRfc3VibWl0X2J1Zihwc3AsIE5VTEwsIGNtZCwgcHNwLT5mZW5jZV9idWZfbWNfYWRkcik7CisK
KwlpZiAocmV0KQorCQlnb3RvIGZhaWxlZDsKKworCXBzcC0+c2VjdXJlZGlzcGxheV9jb250ZXh0
LnNlY3VyZWRpc3BsYXlfaW5pdGlhbGl6ZWQgPSB0cnVlOworCXBzcC0+c2VjdXJlZGlzcGxheV9j
b250ZXh0LnNlc3Npb25faWQgPSBjbWQtPnJlc3Auc2Vzc2lvbl9pZDsKKwltdXRleF9pbml0KCZw
c3AtPnNlY3VyZWRpc3BsYXlfY29udGV4dC5tdXRleCk7CisKK2ZhaWxlZDoKKwlrZnJlZShjbWQp
OworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgcHNwX3NlY3VyZWRpc3BsYXlfdW5sb2Fk
KHN0cnVjdCBwc3BfY29udGV4dCAqcHNwKQoreworCWludCByZXQ7CisJc3RydWN0IHBzcF9nZnhf
Y21kX3Jlc3AgKmNtZDsKKworCWNtZCA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBwc3BfZ2Z4X2Nt
ZF9yZXNwKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFjbWQpCisJCXJldHVybiAtRU5PTUVNOworCisJ
cHNwX3ByZXBfdGFfdW5sb2FkX2NtZF9idWYoY21kLCBwc3AtPnNlY3VyZWRpc3BsYXlfY29udGV4
dC5zZXNzaW9uX2lkKTsKKworCXJldCA9IHBzcF9jbWRfc3VibWl0X2J1Zihwc3AsIE5VTEwsIGNt
ZCwgcHNwLT5mZW5jZV9idWZfbWNfYWRkcik7CisKKwlrZnJlZShjbWQpOworCisJcmV0dXJuIHJl
dDsKK30KKworc3RhdGljIGludCBwc3Bfc2VjdXJlZGlzcGxheV9pbml0aWFsaXplKHN0cnVjdCBw
c3BfY29udGV4dCAqcHNwKQoreworCWludCByZXQ7CisJc3RydWN0IHNlY3VyZWRpc3BsYXlfY21k
ICpzZWN1cmVkaXNwbGF5X2NtZDsKKworCS8qCisJICogVE9ETzogYnlwYXNzIHRoZSBpbml0aWFs
aXplIGluIHNyaW92IGZvciBub3cKKwkgKi8KKwlpZiAoYW1kZ3B1X3NyaW92X3ZmKHBzcC0+YWRl
dikpCisJCXJldHVybiAwOworCisJaWYgKCFwc3AtPmFkZXYtPnBzcC50YV9zZWN1cmVkaXNwbGF5
X3Vjb2RlX3NpemUgfHwKKwkgICAgIXBzcC0+YWRldi0+cHNwLnRhX3NlY3VyZWRpc3BsYXlfc3Rh
cnRfYWRkcikgeworCQlkZXZfaW5mbyhwc3AtPmFkZXYtPmRldiwgIlNFQ1VSRURJU1BMQVk6IHNl
Y3VyZWRpc3BsYXkgdGEgdWNvZGUgaXMgbm90IGF2YWlsYWJsZVxuIik7CisJCXJldHVybiAwOwor
CX0KKworCWlmICghcHNwLT5zZWN1cmVkaXNwbGF5X2NvbnRleHQuc2VjdXJlZGlzcGxheV9pbml0
aWFsaXplZCkgeworCQlyZXQgPSBwc3Bfc2VjdXJlZGlzcGxheV9pbml0X3NoYXJlZF9idWYocHNw
KTsKKwkJaWYgKHJldCkKKwkJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gcHNwX3NlY3VyZWRp
c3BsYXlfbG9hZChwc3ApOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlwc3BfcHJlcF9z
ZWN1cmVkaXNwbGF5X2NtZF9idWYocHNwLCAmc2VjdXJlZGlzcGxheV9jbWQsCisJCQlUQV9TRUNV
UkVESVNQTEFZX0NPTU1BTkRfX1FVRVJZX1RBKTsKKworCXJldCA9IHBzcF9zZWN1cmVkaXNwbGF5
X2ludm9rZShwc3AsIFRBX1NFQ1VSRURJU1BMQVlfQ09NTUFORF9fUVVFUllfVEEpOworCWlmIChy
ZXQpIHsKKwkJcHNwX3NlY3VyZWRpc3BsYXlfdW5sb2FkKHBzcCk7CisKKwkJYW1kZ3B1X2JvX2Zy
ZWVfa2VybmVsKCZwc3AtPnNlY3VyZWRpc3BsYXlfY29udGV4dC5zZWN1cmVkaXNwbGF5X3NoYXJl
ZF9ibywKKwkJCSAgICAgICZwc3AtPnNlY3VyZWRpc3BsYXlfY29udGV4dC5zZWN1cmVkaXNwbGF5
X3NoYXJlZF9tY19hZGRyLAorCQkJICAgICAgJnBzcC0+c2VjdXJlZGlzcGxheV9jb250ZXh0LnNl
Y3VyZWRpc3BsYXlfc2hhcmVkX2J1Zik7CisKKwkJcHNwLT5zZWN1cmVkaXNwbGF5X2NvbnRleHQu
c2VjdXJlZGlzcGxheV9pbml0aWFsaXplZCA9IGZhbHNlOworCisJCWRldl9lcnIocHNwLT5hZGV2
LT5kZXYsICJTRUNVUkVESVNQTEFZIFRBIGluaXRpYWxpemUgZmFpbC5cbiIpOworCQlyZXR1cm4g
LUVJTlZBTDsKKwl9CisKKwlpZiAoc2VjdXJlZGlzcGxheV9jbWQtPnN0YXR1cyAhPSBUQV9TRUNV
UkVESVNQTEFZX1NUQVRVU19fU1VDQ0VTUykgeworCQlwc3Bfc2VjdXJlZGlzcGxheV9wYXJzZV9y
ZXNwX3N0YXR1cyhwc3AsIHNlY3VyZWRpc3BsYXlfY21kLT5zdGF0dXMpOworCQlkZXZfZXJyKHBz
cC0+YWRldi0+ZGV2LCAiU0VDVVJFRElTUExBWTogcXVlcnkgc2VjdXJlZGlzcGxheSBUQSBmYWls
ZWQuIHJldCAweCV4XG4iLAorCQkJc2VjdXJlZGlzcGxheV9jbWQtPnNlY3VyZWRpc3BsYXlfb3V0
X21lc3NhZ2UucXVlcnlfdGEucXVlcnlfY21kX3JldCk7CisJfQorCisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyBpbnQgcHNwX3NlY3VyZWRpc3BsYXlfdGVybWluYXRlKHN0cnVjdCBwc3BfY29udGV4
dCAqcHNwKQoreworCWludCByZXQ7CisKKwkvKgorCSAqIFRPRE86YnlwYXNzIHRoZSB0ZXJtaW5h
dGUgaW4gc3Jpb3YgZm9yIG5vdworCSAqLworCWlmIChhbWRncHVfc3Jpb3ZfdmYocHNwLT5hZGV2
KSkKKwkJcmV0dXJuIDA7CisKKwlpZiAoIXBzcC0+c2VjdXJlZGlzcGxheV9jb250ZXh0LnNlY3Vy
ZWRpc3BsYXlfaW5pdGlhbGl6ZWQpCisJCXJldHVybiAwOworCisJcmV0ID0gcHNwX3NlY3VyZWRp
c3BsYXlfdW5sb2FkKHBzcCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXBzcC0+c2Vj
dXJlZGlzcGxheV9jb250ZXh0LnNlY3VyZWRpc3BsYXlfaW5pdGlhbGl6ZWQgPSBmYWxzZTsKKwor
CS8qIGZyZWUgc2VjdXJlZGlzcGxheSBzaGFyZWQgbWVtb3J5ICovCisJYW1kZ3B1X2JvX2ZyZWVf
a2VybmVsKCZwc3AtPnNlY3VyZWRpc3BsYXlfY29udGV4dC5zZWN1cmVkaXNwbGF5X3NoYXJlZF9i
bywKKwkJCSAgICAgICZwc3AtPnNlY3VyZWRpc3BsYXlfY29udGV4dC5zZWN1cmVkaXNwbGF5X3No
YXJlZF9tY19hZGRyLAorCQkJICAgICAgJnBzcC0+c2VjdXJlZGlzcGxheV9jb250ZXh0LnNlY3Vy
ZWRpc3BsYXlfc2hhcmVkX2J1Zik7CisKKwlyZXR1cm4gcmV0OworfQorCitpbnQgcHNwX3NlY3Vy
ZWRpc3BsYXlfaW52b2tlKHN0cnVjdCBwc3BfY29udGV4dCAqcHNwLCB1aW50MzJfdCB0YV9jbWRf
aWQpCit7CisJaW50IHJldDsKKworCWlmICghcHNwLT5zZWN1cmVkaXNwbGF5X2NvbnRleHQuc2Vj
dXJlZGlzcGxheV9pbml0aWFsaXplZCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlpZiAodGFfY21k
X2lkICE9IFRBX1NFQ1VSRURJU1BMQVlfQ09NTUFORF9fUVVFUllfVEEgJiYKKwkgICAgdGFfY21k
X2lkICE9IFRBX1NFQ1VSRURJU1BMQVlfQ09NTUFORF9fU0VORF9ST0lfQ1JDKQorCQlyZXR1cm4g
LUVJTlZBTDsKKworCW11dGV4X2xvY2soJnBzcC0+c2VjdXJlZGlzcGxheV9jb250ZXh0Lm11dGV4
KTsKKworCXJldCA9IHBzcF90YV9pbnZva2UocHNwLCB0YV9jbWRfaWQsIHBzcC0+c2VjdXJlZGlz
cGxheV9jb250ZXh0LnNlc3Npb25faWQpOworCisJbXV0ZXhfdW5sb2NrKCZwc3AtPnNlY3VyZWRp
c3BsYXlfY29udGV4dC5tdXRleCk7CisKKwlyZXR1cm4gcmV0OworfQorLyogU0VDVVJFRElTUExB
WSBlbmQgKi8KKwogc3RhdGljIGludCBwc3BfaHdfc3RhcnQoc3RydWN0IHBzcF9jb250ZXh0ICpw
c3ApCiB7CiAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBwc3AtPmFkZXY7CkBAIC0yMTE2
LDYgKzIyOTAsMTEgQEAgc3RhdGljIGludCBwc3BfbG9hZF9mdyhzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldikKIAkJaWYgKHJldCkKIAkJCWRldl9lcnIocHNwLT5hZGV2LT5kZXYsCiAJCQkJIlJB
UDogRmFpbGVkIHRvIGluaXRpYWxpemUgUkFQXG4iKTsKKworCQlyZXQgPSBwc3Bfc2VjdXJlZGlz
cGxheV9pbml0aWFsaXplKHBzcCk7CisJCWlmIChyZXQpCisJCQlkZXZfZXJyKHBzcC0+YWRldi0+
ZGV2LAorCQkJCSJTRUNVUkVESVNQTEFZOiBGYWlsZWQgdG8gaW5pdGlhbGl6ZSBTRUNVUkVESVNQ
TEFZXG4iKTsKIAl9CiAKIAlyZXR1cm4gMDsKQEAgLTIxNjYsNiArMjM0NSw3IEBAIHN0YXRpYyBp
bnQgcHNwX2h3X2Zpbmkodm9pZCAqaGFuZGxlKQogCiAJaWYgKHBzcC0+YWRldi0+cHNwLnRhX2Z3
KSB7CiAJCXBzcF9yYXNfdGVybWluYXRlKHBzcCk7CisJCXBzcF9zZWN1cmVkaXNwbGF5X3Rlcm1p
bmF0ZShwc3ApOwogCQlwc3BfcmFwX3Rlcm1pbmF0ZShwc3ApOwogCQlwc3BfZHRtX3Rlcm1pbmF0
ZShwc3ApOwogCQlwc3BfaGRjcF90ZXJtaW5hdGUocHNwKTsKQEAgLTIyMzAsNiArMjQxMCwxMSBA
QCBzdGF0aWMgaW50IHBzcF9zdXNwZW5kKHZvaWQgKmhhbmRsZSkKIAkJCURSTV9FUlJPUigiRmFp
bGVkIHRvIHRlcm1pbmF0ZSByYXAgdGFcbiIpOwogCQkJcmV0dXJuIHJldDsKIAkJfQorCQlyZXQg
PSBwc3Bfc2VjdXJlZGlzcGxheV90ZXJtaW5hdGUocHNwKTsKKwkJaWYgKHJldCkgeworCQkJRFJN
X0VSUk9SKCJGYWlsZWQgdG8gdGVybWluYXRlIHNlY3VyZWRpc3BsYXkgdGFcbiIpOworCQkJcmV0
dXJuIHJldDsKKwkJfQogCX0KIAogCXJldCA9IHBzcF9hc2RfdW5sb2FkKHBzcCk7CkBAIC0yMzEz
LDYgKzI0OTgsMTEgQEAgc3RhdGljIGludCBwc3BfcmVzdW1lKHZvaWQgKmhhbmRsZSkKIAkJaWYg
KHJldCkKIAkJCWRldl9lcnIocHNwLT5hZGV2LT5kZXYsCiAJCQkJIlJBUDogRmFpbGVkIHRvIGlu
aXRpYWxpemUgUkFQXG4iKTsKKworCQlyZXQgPSBwc3Bfc2VjdXJlZGlzcGxheV9pbml0aWFsaXpl
KHBzcCk7CisJCWlmIChyZXQpCisJCQlkZXZfZXJyKHBzcC0+YWRldi0+ZGV2LAorCQkJCSJTRUNV
UkVESVNQTEFZOiBGYWlsZWQgdG8gaW5pdGlhbGl6ZSBTRUNVUkVESVNQTEFZXG4iKTsKIAl9CiAK
IAltdXRleF91bmxvY2soJmFkZXYtPmZpcm13YXJlLm11dGV4KTsKQEAgLTI2MjAsNiArMjgxMCwx
MSBAQCBzdGF0aWMgaW50IHBhcnNlX3RhX2Jpbl9kZXNjcmlwdG9yKHN0cnVjdCBwc3BfY29udGV4
dCAqcHNwLAogCQlwc3AtPnRhX3JhcF91Y29kZV9zaXplICAgICA9IGxlMzJfdG9fY3B1KGRlc2Mt
PnNpemVfYnl0ZXMpOwogCQlwc3AtPnRhX3JhcF9zdGFydF9hZGRyICAgICA9IHVjb2RlX3N0YXJ0
X2FkZHI7CiAJCWJyZWFrOworCWNhc2UgVEFfRldfVFlQRV9QU1BfU0VDVVJFRElTUExBWToKKwkJ
cHNwLT50YV9zZWN1cmVkaXNwbGF5X3Vjb2RlX3ZlcnNpb24gID0gbGUzMl90b19jcHUoZGVzYy0+
ZndfdmVyc2lvbik7CisJCXBzcC0+dGFfc2VjdXJlZGlzcGxheV91Y29kZV9zaXplICAgICA9IGxl
MzJfdG9fY3B1KGRlc2MtPnNpemVfYnl0ZXMpOworCQlwc3AtPnRhX3NlY3VyZWRpc3BsYXlfc3Rh
cnRfYWRkciAgICAgPSB1Y29kZV9zdGFydF9hZGRyOworCQlicmVhazsKIAlkZWZhdWx0OgogCQlk
ZXZfd2Fybihwc3AtPmFkZXYtPmRldiwgIlVuc3VwcG9ydGVkIFRBIHR5cGU6ICVkXG4iLCBkZXNj
LT5md190eXBlKTsKIAkJYnJlYWs7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfcHNwLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcHNw
LmgKaW5kZXggZGEyNTBiYzFhYzU3Li5jYjUwYmE0NDVmOGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wc3AuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfcHNwLmgKQEAgLTMwLDYgKzMwLDcgQEAKICNpbmNsdWRlICJ0YV94Z21p
X2lmLmgiCiAjaW5jbHVkZSAidGFfcmFzX2lmLmgiCiAjaW5jbHVkZSAidGFfcmFwX2lmLmgiCisj
aW5jbHVkZSAidGFfc2VjdXJlRGlzcGxheV9pZi5oIgogCiAjZGVmaW5lIFBTUF9GRU5DRV9CVUZG
RVJfU0laRQkweDEwMDAKICNkZWZpbmUgUFNQX0NNRF9CVUZGRVJfU0laRQkweDEwMDAKQEAgLTQw
LDYgKzQxLDcgQEAKICNkZWZpbmUgUFNQX0hEQ1BfU0hBUkVEX01FTV9TSVpFCTB4NDAwMAogI2Rl
ZmluZSBQU1BfRFRNX1NIQVJFRF9NRU1fU0laRQkweDQwMDAKICNkZWZpbmUgUFNQX1JBUF9TSEFS
RURfTUVNX1NJWkUJMHg0MDAwCisjZGVmaW5lIFBTUF9TRUNVUkVESVNQTEFZX1NIQVJFRF9NRU1f
U0laRQkweDQwMDAKICNkZWZpbmUgUFNQX1NIQVJFRF9NRU1fU0laRQkJMHg0MDAwCiAjZGVmaW5l
IFBTUF9GV19OQU1FX0xFTgkJMHgyNAogCkBAIC0xNzEsNiArMTczLDE1IEBAIHN0cnVjdCBwc3Bf
cmFwX2NvbnRleHQgewogCXN0cnVjdCBtdXRleAkJbXV0ZXg7CiB9OwogCitzdHJ1Y3QgcHNwX3Nl
Y3VyZWRpc3BsYXlfY29udGV4dCB7CisJYm9vbAkJCXNlY3VyZWRpc3BsYXlfaW5pdGlhbGl6ZWQ7
CisJdWludDMyX3QJCXNlc3Npb25faWQ7CisJc3RydWN0IGFtZGdwdV9ibwkqc2VjdXJlZGlzcGxh
eV9zaGFyZWRfYm87CisJdWludDY0X3QJCXNlY3VyZWRpc3BsYXlfc2hhcmVkX21jX2FkZHI7CisJ
dm9pZAkJCSpzZWN1cmVkaXNwbGF5X3NoYXJlZF9idWY7CisJc3RydWN0IG11dGV4CQltdXRleDsK
K307CisKICNkZWZpbmUgTUVNX1RSQUlOX1NZU1RFTV9TSUdOQVRVUkUJCTB4NTQ1MzQ5NDIKICNk
ZWZpbmUgR0REUjZfTUVNX1RSQUlOSU5HX0RBVEFfU0laRV9JTl9CWVRFUwkweDEwMDAKICNkZWZp
bmUgR0REUjZfTUVNX1RSQUlOSU5HX09GRlNFVAkJMHg4MDAwCkBAIC0yOTgsMTIgKzMwOSwxNyBA
QCBzdHJ1Y3QgcHNwX2NvbnRleHQKIAl1aW50MzJfdAkJCXRhX3JhcF91Y29kZV9zaXplOwogCXVp
bnQ4X3QJCQkJKnRhX3JhcF9zdGFydF9hZGRyOwogCisJdWludDMyX3QJCQl0YV9zZWN1cmVkaXNw
bGF5X3Vjb2RlX3ZlcnNpb247CisJdWludDMyX3QJCQl0YV9zZWN1cmVkaXNwbGF5X3Vjb2RlX3Np
emU7CisJdWludDhfdAkJCQkqdGFfc2VjdXJlZGlzcGxheV9zdGFydF9hZGRyOworCiAJc3RydWN0
IHBzcF9hc2RfY29udGV4dAkJYXNkX2NvbnRleHQ7CiAJc3RydWN0IHBzcF94Z21pX2NvbnRleHQJ
CXhnbWlfY29udGV4dDsKIAlzdHJ1Y3QgcHNwX3Jhc19jb250ZXh0CQlyYXM7CiAJc3RydWN0IHBz
cF9oZGNwX2NvbnRleHQgCWhkY3BfY29udGV4dDsKIAlzdHJ1Y3QgcHNwX2R0bV9jb250ZXh0CQlk
dG1fY29udGV4dDsKIAlzdHJ1Y3QgcHNwX3JhcF9jb250ZXh0CQlyYXBfY29udGV4dDsKKwlzdHJ1
Y3QgcHNwX3NlY3VyZWRpc3BsYXlfY29udGV4dAlzZWN1cmVkaXNwbGF5X2NvbnRleHQ7CiAJc3Ry
dWN0IG11dGV4CQkJbXV0ZXg7CiAJc3RydWN0IHBzcF9tZW1vcnlfdHJhaW5pbmdfY29udGV4dCBt
ZW1fdHJhaW5fY3R4OwogfTsKQEAgLTM4MCw2ICszOTYsNyBAQCBpbnQgcHNwX3Jhc190cmlnZ2Vy
X2Vycm9yKHN0cnVjdCBwc3BfY29udGV4dCAqcHNwLAogaW50IHBzcF9oZGNwX2ludm9rZShzdHJ1
Y3QgcHNwX2NvbnRleHQgKnBzcCwgdWludDMyX3QgdGFfY21kX2lkKTsKIGludCBwc3BfZHRtX2lu
dm9rZShzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCwgdWludDMyX3QgdGFfY21kX2lkKTsKIGludCBw
c3BfcmFwX2ludm9rZShzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCwgdWludDMyX3QgdGFfY21kX2lk
KTsKK2ludCBwc3Bfc2VjdXJlZGlzcGxheV9pbnZva2Uoc3RydWN0IHBzcF9jb250ZXh0ICpwc3As
IHVpbnQzMl90IHRhX2NtZF9pZCk7CiAKIGludCBwc3BfcmxjX2F1dG9sb2FkX3N0YXJ0KHN0cnVj
dCBwc3BfY29udGV4dCAqcHNwKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3NlY3VyZWRpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9zZWN1cmVkaXNwbGF5LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi40NTU5Nzg3ODEzODAKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfc2VjdXJlZGlzcGxheS5jCkBAIC0wLDAgKzEsMTc0IEBACisvKgor
ICogQ29weXJpZ2h0IDIwMjAgQWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5jLgorICoKKyAqIFBl
cm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29u
IG9idGFpbmluZyBhCisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9j
dW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVhbCBpbiB0aGUgU29m
dHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgor
ICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3Ry
aWJ1dGUsIHN1YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJl
LCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlzIGZ1cm5p
c2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CisgKgor
ICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ug
c2hhbGwgYmUgaW5jbHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlv
bnMgb2YgdGhlIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMg
SVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVE
LCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5U
QUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZS
SU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIENPUFlSSUdIVCBIT0xERVIoUykg
T1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SCisgKiBPVEhF
UiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9U
SEVSV0lTRSwKKyAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBU
SEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgorICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRX
QVJFLgorICoKKyAqCisgKi8KKyNpbmNsdWRlIDxsaW51eC9kZWJ1Z2ZzLmg+CisjaW5jbHVkZSA8
bGludXgvcG1fcnVudGltZS5oPgorCisjaW5jbHVkZSAiYW1kZ3B1LmgiCisjaW5jbHVkZSAiYW1k
Z3B1X3NlY3VyZWRpc3BsYXkuaCIKKworLyoqCisgKiBET0M6IEFNREdQVSBTRUNVUkVESVNQTEFZ
IGRlYnVnZnMgdGVzdCBpbnRlcmZhY2UKKyAqCisgKiBob3cgdG8gdXNlPworICogZWNobyBvcGNv
ZGUgPHZhbHVlPiA+IDxkZWJ1Z2ZzX2Rpcj4vZHJpL3h4eC9zZWN1cmVkaXNwbGF5X3Rlc3QKKyAq
IGVnLiBlY2hvIDEgPiA8ZGVidWdmc19kaXI+L2RyaS94eHgvc2VjdXJlZGlzcGxheV90ZXN0Cisg
KiBlZy4gZWNobyAyIHBoeV9pZCA+IDxkZWJ1Z2ZzX2Rpcj4vZHJpL3h4eC9zZWN1cmVkaXNwbGF5
X3Rlc3QKKyAqCisgKiBvcGNvZGU6CisgKiAx77yaUXVlcnkgd2hldGhlciBUQSBpcyByZXNwb25k
aW5nIHVzZWQgb25seSBmb3IgdmFsaWRhdGlvbiBwdXBvc2UKKyAqIDI6IFNlbmQgcmVnaW9uIG9m
IEludGVyZXN0IGFuZCBDUkMgdmFsdWUgdG8gSTJDLiAodWludDMyKXBoeV9pZCBpcworICogc2Vu
ZCB0byBkZXRlcm1pbmUgd2hpY2ggRElPIHNjcmF0Y2ggcmVnaXN0ZXIgc2hvdWxkIGJlIHVzZWQg
dG8gZ2V0CisgKiBST0kgYW5kIHJlY2VpdmUgaTJjX2J1ZiBhcyB0aGUgb3V0cHV0LgorICoKKyAq
IFlvdSBjYW4gcmVmZXIgbW9yZSBkZXRhaWwgZnJvbSBoZWFkZXIgZmlsZSB0YV9zZWN1cmVkaXNw
bGF5X2lmLmgKKyAqCisgKi8KKwordm9pZCBwc3Bfc2VjdXJlZGlzcGxheV9wYXJzZV9yZXNwX3N0
YXR1cyhzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCwKKwllbnVtIHRhX3NlY3VyZWRpc3BsYXlfc3Rh
dHVzIHN0YXR1cykKK3sKKwlzd2l0Y2ggKHN0YXR1cykgeworCWNhc2UgVEFfU0VDVVJFRElTUExB
WV9TVEFUVVNfX1NVQ0NFU1M6CisJCWJyZWFrOworCWNhc2UgVEFfU0VDVVJFRElTUExBWV9TVEFU
VVNfX0dFTkVSSUNfRkFJTFVSRToKKwkJZGV2X2Vycihwc3AtPmFkZXYtPmRldiwgIlNlY3VyZSBk
aXNwbGF5OiBHZW5lcmljIEZhaWx1cmUuIik7CisJCWJyZWFrOworCWNhc2UgVEFfU0VDVVJFRElT
UExBWV9TVEFUVVNfX0lOVkFMSURfUEFSQU1FVEVSOgorCQlkZXZfZXJyKHBzcC0+YWRldi0+ZGV2
LCAiU2VjdXJlIGRpc3BsYXk6IEludmFsaWQgUGFyYW1ldGVyLiIpOworCQlicmVhazsKKwljYXNl
IFRBX1NFQ1VSRURJU1BMQVlfU1RBVFVTX19OVUxMX1BPSU5URVI6CisJCWRldl9lcnIocHNwLT5h
ZGV2LT5kZXYsICJTZWN1cmUgZGlzcGxheTogTnVsbCBQb2ludGVyLiIpOworCQlicmVhazsKKwlj
YXNlIFRBX1NFQ1VSRURJU1BMQVlfU1RBVFVTX19JMkNfV1JJVEVfRVJST1I6CisJCWRldl9lcnIo
cHNwLT5hZGV2LT5kZXYsICJTZWN1cmUgZGlzcGxheTogRmFpbGVkIHRvIHdyaXRlIHRvIEkyQy4i
KTsKKwkJYnJlYWs7CisJY2FzZSBUQV9TRUNVUkVESVNQTEFZX1NUQVRVU19fUkVBRF9ESU9fU0NS
QVRDSF9FUlJPUjoKKwkJZGV2X2Vycihwc3AtPmFkZXYtPmRldiwgIlNlY3VyZSBkaXNwbGF5OiBG
YWlsZWQgdG8gUmVhZCBESU8gU2NyYXRjaCBSZWdpc3Rlci4iKTsKKwkJYnJlYWs7CisJY2FzZSBU
QV9TRUNVUkVESVNQTEFZX1NUQVRVU19fUkVBRF9DUkNfRVJST1I6CisJCWRldl9lcnIocHNwLT5h
ZGV2LT5kZXYsICJTZWN1cmUgZGlzcGxheTogRmFpbGVkIHRvIFJlYWQgQ1JDIik7CisJCWJyZWFr
OworCWRlZmF1bHQ6CisJCWRldl9lcnIocHNwLT5hZGV2LT5kZXYsICJTZWN1cmUgZGlzcGxheTog
RmFpbGVkIHRvIHBhcnNlIHN0YXR1czogJWRcbiIsIHN0YXR1cyk7CisJfQorfQorCit2b2lkIHBz
cF9wcmVwX3NlY3VyZWRpc3BsYXlfY21kX2J1ZihzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCwgc3Ry
dWN0IHNlY3VyZWRpc3BsYXlfY21kICoqY21kLAorCWVudW0gdGFfc2VjdXJlZGlzcGxheV9jb21t
YW5kIGNvbW1hbmRfaWQpCit7CisJKmNtZCA9IChzdHJ1Y3Qgc2VjdXJlZGlzcGxheV9jbWQgKilw
c3AtPnNlY3VyZWRpc3BsYXlfY29udGV4dC5zZWN1cmVkaXNwbGF5X3NoYXJlZF9idWY7CisJbWVt
c2V0KCpjbWQsIDAsIHNpemVvZihzdHJ1Y3Qgc2VjdXJlZGlzcGxheV9jbWQpKTsKKwkoKmNtZCkt
PnN0YXR1cyA9IFRBX1NFQ1VSRURJU1BMQVlfU1RBVFVTX19HRU5FUklDX0ZBSUxVUkU7CisJKCpj
bWQpLT5jbWRfaWQgPSBjb21tYW5kX2lkOworfQorCitzdGF0aWMgc3NpemVfdCBhbWRncHVfc2Vj
dXJlZGlzcGxheV9kZWJ1Z2ZzX3dyaXRlKHN0cnVjdCBmaWxlICpmLCBjb25zdCBjaGFyIF9fdXNl
ciAqYnVmLAorCQlzaXplX3Qgc2l6ZSwgbG9mZl90ICpwb3MpCit7CisJc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKilmaWxlX2lub2RlKGYpLT5pX3By
aXZhdGU7CisJc3RydWN0IHBzcF9jb250ZXh0ICpwc3AgPSAmYWRldi0+cHNwOworCXN0cnVjdCBz
ZWN1cmVkaXNwbGF5X2NtZCAqc2VjdXJlZGlzcGxheV9jbWQ7CisJc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9IGFkZXZfdG9fZHJtKGFkZXYpOworCXVpbnQzMl90IHBoeV9pZDsKKwl1aW50MzJfdCBv
cDsKKwlpbnQgaTsKKwljaGFyIHN0cls2NF07CisJY2hhciBpMmNfb3V0cHV0WzI1Nl07CisJaW50
IHJldDsKKworCWlmICgqcG9zIHx8IHNpemUgPiBzaXplb2Yoc3RyKSAtIDEpCisJCXJldHVybiAt
RUlOVkFMOworCisJbWVtc2V0KHN0ciwgIDAsIHNpemVvZihzdHIpKTsKKwljb3B5X2Zyb21fdXNl
cihzdHIsIGJ1Ziwgc2l6ZSk7CisKKwlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRldi0+ZGV2
KTsKKwlpZiAocmV0IDwgMCkgeworCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZXYtPmRl
dik7CisJCXJldHVybiByZXQ7CisJfQorCisJaWYgKHNpemUgPCAzKQorCQlzc2NhbmYoc3RyLCAi
JXUgIiwgJm9wKTsKKwllbHNlCisJCXNzY2FuZihzdHIsICIldSAldSIsICZvcCwgJnBoeV9pZCk7
CisKKwlzd2l0Y2ggKG9wKSB7CisJY2FzZSAxOgorCQlwc3BfcHJlcF9zZWN1cmVkaXNwbGF5X2Nt
ZF9idWYocHNwLCAmc2VjdXJlZGlzcGxheV9jbWQsCisJCQlUQV9TRUNVUkVESVNQTEFZX0NPTU1B
TkRfX1FVRVJZX1RBKTsKKwkJcmV0ID0gcHNwX3NlY3VyZWRpc3BsYXlfaW52b2tlKHBzcCwgVEFf
U0VDVVJFRElTUExBWV9DT01NQU5EX19RVUVSWV9UQSk7CisJCWlmICghcmV0KSB7CisJCQlpZiAo
c2VjdXJlZGlzcGxheV9jbWQtPnN0YXR1cyA9PSBUQV9TRUNVUkVESVNQTEFZX1NUQVRVU19fU1VD
Q0VTUykKKwkJCQlkZXZfaW5mbyhhZGV2LT5kZXYsICJTRUNVUkVESVNQTEFZOiBxdWVyeSBzZWN1
cmVkaXNwbGF5IFRBIHJldCBpcyAweCVYXG4iLAorCQkJCQlzZWN1cmVkaXNwbGF5X2NtZC0+c2Vj
dXJlZGlzcGxheV9vdXRfbWVzc2FnZS5xdWVyeV90YS5xdWVyeV9jbWRfcmV0KTsKKwkJCWVsc2UK
KwkJCQlwc3Bfc2VjdXJlZGlzcGxheV9wYXJzZV9yZXNwX3N0YXR1cyhwc3AsIHNlY3VyZWRpc3Bs
YXlfY21kLT5zdGF0dXMpOworCQl9CisJCWJyZWFrOworCWNhc2UgMjoKKwkJcHNwX3ByZXBfc2Vj
dXJlZGlzcGxheV9jbWRfYnVmKHBzcCwgJnNlY3VyZWRpc3BsYXlfY21kLAorCQkJVEFfU0VDVVJF
RElTUExBWV9DT01NQU5EX19TRU5EX1JPSV9DUkMpOworCQlzZWN1cmVkaXNwbGF5X2NtZC0+c2Vj
dXJlZGlzcGxheV9pbl9tZXNzYWdlLnNlbmRfcm9pX2NyYy5waHlfaWQgPSBwaHlfaWQ7CisJCXJl
dCA9IHBzcF9zZWN1cmVkaXNwbGF5X2ludm9rZShwc3AsIFRBX1NFQ1VSRURJU1BMQVlfQ09NTUFO
RF9fU0VORF9ST0lfQ1JDKTsKKwkJaWYgKCFyZXQpIHsKKwkJCWlmIChzZWN1cmVkaXNwbGF5X2Nt
ZC0+c3RhdHVzID09IFRBX1NFQ1VSRURJU1BMQVlfU1RBVFVTX19TVUNDRVNTKSB7CisJCQkJbWVt
c2V0KGkyY19vdXRwdXQsICAwLCBzaXplb2YoaTJjX291dHB1dCkpOworCQkJCWZvciAoaSA9IDA7
IGkgPCBUQV9TRUNVUkVESVNQTEFZX0kyQ19CVUZGRVJfU0laRTsgaSsrKQorCQkJCQlzcHJpbnRm
KGkyY19vdXRwdXQsICIlcyAweCVYIiwgaTJjX291dHB1dCwKKwkJCQkJCXNlY3VyZWRpc3BsYXlf
Y21kLT5zZWN1cmVkaXNwbGF5X291dF9tZXNzYWdlLnNlbmRfcm9pX2NyYy5pMmNfYnVmW2ldKTsK
KwkJCQlkZXZfaW5mbyhhZGV2LT5kZXYsICJTRUNVUkVESVNQTEFZOiBJMkMgYnVmZmVyIG91dCBw
dXQgaXMgOiVzXG4iLCBpMmNfb3V0cHV0KTsKKwkJCX0gZWxzZSB7CisJCQkJcHNwX3NlY3VyZWRp
c3BsYXlfcGFyc2VfcmVzcF9zdGF0dXMocHNwLCBzZWN1cmVkaXNwbGF5X2NtZC0+c3RhdHVzKTsK
KwkJCX0KKwkJfQorCQlicmVhazsKKwlkZWZhdWx0OgorCQlkZXZfZXJyKGFkZXYtPmRldiwgIklu
dmFsaWQgaW5wdXQ6ICVzXG4iLCBzdHIpOworCX0KKworCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1
c3koZGV2LT5kZXYpOworCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRldi0+ZGV2KTsKKwor
CXJldHVybiBzaXplOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyBh
bWRncHVfc2VjdXJlZGlzcGxheV9kZWJ1Z2ZzX29wcyA9IHsKKwkub3duZXIgPSBUSElTX01PRFVM
RSwKKwkucmVhZCA9IE5VTEwsCisJLndyaXRlID0gYW1kZ3B1X3NlY3VyZWRpc3BsYXlfZGVidWdm
c193cml0ZSwKKwkubGxzZWVrID0gZGVmYXVsdF9sbHNlZWsKK307CisKK3ZvaWQgYW1kZ3B1X3Nl
Y3VyZWRpc3BsYXlfZGVidWdmc19pbml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQorewor
I2lmIGRlZmluZWQoQ09ORklHX0RFQlVHX0ZTKQorCisJaWYgKCFhZGV2LT5wc3Auc2VjdXJlZGlz
cGxheV9jb250ZXh0LnNlY3VyZWRpc3BsYXlfaW5pdGlhbGl6ZWQpCisJCXJldHVybjsKKworCWRl
YnVnZnNfY3JlYXRlX2ZpbGUoInNlY3VyZWRpc3BsYXlfdGVzdCIsIFNfSVdVU1IsIGFkZXZfdG9f
ZHJtKGFkZXYpLT5wcmltYXJ5LT5kZWJ1Z2ZzX3Jvb3QsCisJCQkJYWRldiwgJmFtZGdwdV9zZWN1
cmVkaXNwbGF5X2RlYnVnZnNfb3BzKTsKKyNlbmRpZgorfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3NlY3VyZWRpc3BsYXkuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9zZWN1cmVkaXNwbGF5LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMDAwMDAwLi45ODM0NDZjNzI1MjAKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfc2VjdXJlZGlzcGxheS5oCkBAIC0wLDAgKzEs
MzYgQEAKKy8qCisgKiBDb3B5cmlnaHQgMjAyMCBBZHZhbmNlZCBNaWNybyBEZXZpY2VzLCBJbmMu
CisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRv
IGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNz
b2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFs
IGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBs
aW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVi
bGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0
aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQorICogU29mdHdh
cmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0
aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNz
aW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgorICogYWxsIGNvcGllcyBvciBzdWJzdGFu
dGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJFIElTIFBS
T1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IK
KyAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMg
T0YgTUVSQ0hBTlRBQklMSVRZLAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0Ug
QU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUgQ09QWVJJR0hU
IEhPTERFUihTKSBPUiBBVVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMg
T1IKKyAqIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1Qs
IFRPUlQgT1IgT1RIRVJXSVNFLAorICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVD
VElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SCisgKiBPVEhFUiBERUFMSU5HUyBJ
TiBUSEUgU09GVFdBUkUuCisgKgorICoKKyAqLworI2lmbmRlZiBfQU1ER1BVX1NFQ1VSRURJU1BM
QVlfSAorI2RlZmluZSBfQU1ER1BVX1NFQ1VSRURJU1BMQVlfSAorCisjaW5jbHVkZSAiYW1kZ3B1
LmgiCisjaW5jbHVkZSAidGFfc2VjdXJlRGlzcGxheV9pZi5oIgorCit2b2lkIGFtZGdwdV9zZWN1
cmVkaXNwbGF5X2RlYnVnZnNfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldik7Cit2b2lk
IHBzcF9zZWN1cmVkaXNwbGF5X3BhcnNlX3Jlc3Bfc3RhdHVzKHN0cnVjdCBwc3BfY29udGV4dCAq
cHNwLAorCQllbnVtIHRhX3NlY3VyZWRpc3BsYXlfc3RhdHVzIHN0YXR1cyk7Cit2b2lkIHBzcF9w
cmVwX3NlY3VyZWRpc3BsYXlfY21kX2J1ZihzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCwgc3RydWN0
IHNlY3VyZWRpc3BsYXlfY21kICoqY21kLAorCQllbnVtIHRhX3NlY3VyZWRpc3BsYXlfY29tbWFu
ZCBjb21tYW5kX2lkKTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfdWNvZGUuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV91Y29kZS5oCmluZGV4IDBlNDNiNDZkM2FiNS4uNDY0NDllNzAzNDhiIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdWNvZGUuaAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdWNvZGUuaApAQCAtMTIyLDYgKzEyMiw5IEBAIHN0cnVj
dCB0YV9maXJtd2FyZV9oZWFkZXJfdjFfMCB7CiAJdWludDMyX3QgdGFfZHRtX3Vjb2RlX3ZlcnNp
b247CiAJdWludDMyX3QgdGFfZHRtX29mZnNldF9ieXRlczsKIAl1aW50MzJfdCB0YV9kdG1fc2l6
ZV9ieXRlczsKKwl1aW50MzJfdCB0YV9zZWN1cmVkaXNwbGF5X3Vjb2RlX3ZlcnNpb247CisJdWlu
dDMyX3QgdGFfc2VjdXJlZGlzcGxheV9vZmZzZXRfYnl0ZXM7CisJdWludDMyX3QgdGFfc2VjdXJl
ZGlzcGxheV9zaXplX2J5dGVzOwogfTsKIAogZW51bSB0YV9md190eXBlIHsKQEAgLTEzMiw2ICsx
MzUsNyBAQCBlbnVtIHRhX2Z3X3R5cGUgewogCVRBX0ZXX1RZUEVfUFNQX0hEQ1AsCiAJVEFfRldf
VFlQRV9QU1BfRFRNLAogCVRBX0ZXX1RZUEVfUFNQX1JBUCwKKwlUQV9GV19UWVBFX1BTUF9TRUNV
UkVESVNQTEFZLAogfTsKIAogc3RydWN0IHRhX2Z3X2Jpbl9kZXNjIHsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3BzcF92MTBfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvcHNwX3YxMF8wLmMKaW5kZXggZDdmOTI2MzRlYmEyLi40YjFjYzVlOWVlOTIgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3BzcF92MTBfMC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3BzcF92MTBfMC5jCkBAIC05Miw4ICs5Miw2IEBAIHN0
YXRpYyBpbnQgcHNwX3YxMF8wX2luaXRfbWljcm9jb2RlKHN0cnVjdCBwc3BfY29udGV4dCAqcHNw
KQogCQkJKHVpbnQ4X3QgKil0YV9oZHIgKwogCQkJbGUzMl90b19jcHUodGFfaGRyLT5oZWFkZXIu
dWNvZGVfYXJyYXlfb2Zmc2V0X2J5dGVzKTsKIAotCQlhZGV2LT5wc3AudGFfZndfdmVyc2lvbiA9
IGxlMzJfdG9fY3B1KHRhX2hkci0+aGVhZGVyLnVjb2RlX3ZlcnNpb24pOwotCiAJCWFkZXYtPnBz
cC50YV9kdG1fdWNvZGVfdmVyc2lvbiA9CiAJCQlsZTMyX3RvX2NwdSh0YV9oZHItPnRhX2R0bV91
Y29kZV92ZXJzaW9uKTsKIAkJYWRldi0+cHNwLnRhX2R0bV91Y29kZV9zaXplID0KQEAgLTEwMSw2
ICs5OSwxNiBAQCBzdGF0aWMgaW50IHBzcF92MTBfMF9pbml0X21pY3JvY29kZShzdHJ1Y3QgcHNw
X2NvbnRleHQgKnBzcCkKIAkJYWRldi0+cHNwLnRhX2R0bV9zdGFydF9hZGRyID0KIAkJCSh1aW50
OF90ICopYWRldi0+cHNwLnRhX2hkY3Bfc3RhcnRfYWRkciArCiAJCQlsZTMyX3RvX2NwdSh0YV9o
ZHItPnRhX2R0bV9vZmZzZXRfYnl0ZXMpOworCisJCWFkZXYtPnBzcC50YV9zZWN1cmVkaXNwbGF5
X3Vjb2RlX3ZlcnNpb24gPQorCQkJbGUzMl90b19jcHUodGFfaGRyLT50YV9zZWN1cmVkaXNwbGF5
X3Vjb2RlX3ZlcnNpb24pOworCQlhZGV2LT5wc3AudGFfc2VjdXJlZGlzcGxheV91Y29kZV9zaXpl
ID0KKwkJCWxlMzJfdG9fY3B1KHRhX2hkci0+dGFfc2VjdXJlZGlzcGxheV9zaXplX2J5dGVzKTsK
KwkJYWRldi0+cHNwLnRhX3NlY3VyZWRpc3BsYXlfc3RhcnRfYWRkciA9CisJCQkodWludDhfdCAq
KWFkZXYtPnBzcC50YV9oZGNwX3N0YXJ0X2FkZHIgKworCQkJbGUzMl90b19jcHUodGFfaGRyLT50
YV9zZWN1cmVkaXNwbGF5X29mZnNldF9ieXRlcyk7CisKKwkJYWRldi0+cHNwLnRhX2Z3X3ZlcnNp
b24gPSBsZTMyX3RvX2NwdSh0YV9oZHItPmhlYWRlci51Y29kZV92ZXJzaW9uKTsKIAl9CiAKIAly
ZXR1cm4gMDsKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQt
Z2Z4Cg==
