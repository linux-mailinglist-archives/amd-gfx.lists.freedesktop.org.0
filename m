Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BF17548FFB
	for <lists+amd-gfx@lfdr.de>; Mon, 17 Jun 2019 21:46:36 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1DCE589DFB;
	Mon, 17 Jun 2019 19:46:35 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qk1-x741.google.com (mail-qk1-x741.google.com
 [IPv6:2607:f8b0:4864:20::741])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1CFA989E1B
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:46:32 +0000 (UTC)
Received: by mail-qk1-x741.google.com with SMTP id p144so6958775qke.11
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 12:46:32 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Bjev0mZ4agZBzzXnCrn0nTbD7zLPcLkg5TorpIJsSP4=;
 b=OKuGY8coWAZdnuO2HLge2WAJ5NJTeKDJqtTHzvJEOQxoR2mXj8PyXy87uo3FQfX3i+
 TY3fTpPuMVX+VKETIFC/UCS2ZZTZJRTCfn/s+MNNLKp4nvXEi9RXggRdUvfHdQtgbqDu
 2FSytz4oRGYtXCccZjN/pLKabx+aJgX8ZuruQYI4rtYMP98Q3yrVsNIylpR7HtdmuOBb
 lqcuZsNFIFYc7p0eG8RNmmTA+PYtMyqQD45Ue9tWb2yoxDM50s83DpIiXBt2nCWVI/wX
 UEcL2qFDS38m2IFN3cJvj83Lqq+b5d8IqBoyWqsp6jEvJ/bhkE0sbwvUmtmhonxVF7w9
 G45Q==
X-Gm-Message-State: APjAAAUUS3r1CbkUZUFFe2JgE2XUfAIY+M22qfkjRGjEkTOrV+8oIEih
 8Wx2d+CwiDPgKbrHxyWLo6RypT1zGg0=
X-Google-Smtp-Source: APXvYqzVUxDu0DzD/+EBYmOsSFX4+nq4slRn5y/HyaTUEGmIYgdsbOvQvoviuCK5WLAza3s6SLBQ4A==
X-Received: by 2002:a37:a247:: with SMTP id l68mr29758691qke.89.1560800789176; 
 Mon, 17 Jun 2019 12:46:29 -0700 (PDT)
Received: from localhost.localdomain ([71.219.5.136])
 by smtp.gmail.com with ESMTPSA id u4sm6559420qkb.16.2019.06.17.12.46.26
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 12:46:28 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 333/459] drm/amd/display: Add DCN2 HW Sequencer and Resource
Date: Mon, 17 Jun 2019 14:44:34 -0500
Message-Id: <20190617194540.18497-34-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617194540.18497-1-alexander.deucher@amd.com>
References: <20190617194540.18497-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Bjev0mZ4agZBzzXnCrn0nTbD7zLPcLkg5TorpIJsSP4=;
 b=V6oEBsYGR6cbJGEN9Sfx366ZDGpSwPesJ91uc8ZZh4AG28qR2ORJ890X0Ef7dAxBSb
 cOF0OrVzqR9PTD5mXUaJSpwoeFnzmznvFPSvZeU/XCKu8XjrWwANE2QoaCQxEdoS+X2V
 OkPXqGzhOs7ZuQkg24vdwGWVknBDmuLMSBH/eYinRPUd11VtCgeVvrOn0U/cWgMM7ntE
 LBEVpKzmgl6AnmEzy5Y1eThIUAfnVyD8yBoq0kgV4qM5LI5m8ijKE4CpJfnooctyBlG7
 aQtqMClzehnuPKr9gAc4jm2InMRYW5a9m1ooqZB4qPNA34jmAoY8mgZPOzxjNrDn4DRA
 Obyg==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>,
 Harry Wentland <harry.wentland@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogSGFycnkgV2VudGxhbmQgPGhhcnJ5LndlbnRsYW5kQGFtZC5jb20+CgpBZGQgRENOMiBy
ZXNvdXJjZSBkZWZpbml0aW9uIGFuZCBIVyBTZXF1ZW5jZXIgY2hhbmdlcy4KClNpZ25lZC1vZmYt
Ynk6IEhhcnJ5IFdlbnRsYW5kIDxoYXJyeS53ZW50bGFuZEBhbWQuY29tPgpTaWduZWQtb2ZmLWJ5
OiBBbGV4IERldWNoZXIgPGFsZXhhbmRlci5kZXVjaGVyQGFtZC5jb20+Ci0tLQogLi4uL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kY19yZXNvdXJjZS5jIHwgICAxNSArCiBkcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNlL2RjZV9kbWN1LmMgfCAgIDg4ICsKIGRyaXZlcnMvZ3B1
L2RybS9hbWQvZGlzcGxheS9kYy9kY2UvZGNlX2RtY3UuaCB8ICAgIDggKwogLi4uL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZGNlL2RjZV9od3NlcS5oICAgIHwgIDEyNyArCiAuLi4vZGlzcGxheS9k
Yy9kY2UxMTAvZGNlMTEwX2h3X3NlcXVlbmNlci5jICAgfCAgIDQyICstCiAuLi4vYW1kL2Rpc3Bs
YXkvZGMvZGNuMTAvZGNuMTBfaHdfc2VxdWVuY2VyLmMgfCAgIDEzICsKIGRyaXZlcnMvZ3B1L2Ry
bS9hbWQvZGlzcGxheS9kYy9kY24yMC9NYWtlZmlsZSB8ICAgMTQgKwogLi4uL2RybS9hbWQvZGlz
cGxheS9kYy9kY24yMC9kY24yMF9od3NlcS5jICAgIHwgMTkyNiArKysrKysrKysrKysKIC4uLi9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHdzZXEuaCAgICB8ICAgOTAgKwogLi4uL2Ry
bS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9yZXNvdXJjZS5jIHwgMjc0MSArKysrKysrKysr
KysrKysrKwogLi4uL2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9yZXNvdXJjZS5oIHwg
IDEzNCArCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHdfc2VxdWVuY2VyLmggfCAg
IDQ2ICsKIGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvcmVzb3VyY2UuaCB8ICAg
IDMgKwogMTMgZmlsZXMgY2hhbmdlZCwgNTI0NiBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0p
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIw
L01ha2VmaWxlCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2RjbjIwL2RjbjIwX2h3c2VxLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHdzZXEuaAogY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9yZXNvdXJjZS5jCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2Rj
bjIwX3Jlc291cmNlLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvY29yZS9kY19yZXNvdXJjZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2Nv
cmUvZGNfcmVzb3VyY2UuYwppbmRleCAwYTJlMGZlNzU0MDUuLmQxMGViZmQzM2E2MCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2NvcmUvZGNfcmVzb3VyY2UuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kY19yZXNvdXJjZS5jCkBA
IC00Niw2ICs0Niw5IEBACiAjaWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04xXzApCiAj
aW5jbHVkZSAiZGNuMTAvZGNuMTBfcmVzb3VyY2UuaCIKICNlbmRpZgorI2lmIGRlZmluZWQoQ09O
RklHX0RSTV9BTURfRENfRENOMl8wKQorI2luY2x1ZGUgImRjbjIwL2RjbjIwX3Jlc291cmNlLmgi
CisjZW5kaWYKICNpbmNsdWRlICJkY2UxMjAvZGNlMTIwX3Jlc291cmNlLmgiCiAKICNkZWZpbmUg
RENfTE9HR0VSX0lOSVQobG9nZ2VyKQpAQCAtOTcsNiArMTAwLDEyIEBAIGVudW0gZGNlX3ZlcnNp
b24gcmVzb3VyY2VfcGFyc2VfYXNpY19pZChzdHJ1Y3QgaHdfYXNpY19pZCBhc2ljX2lkKQogCQkJ
ZGNfdmVyc2lvbiA9IERDTl9WRVJTSU9OXzFfMDE7CiAJCWJyZWFrOwogI2VuZGlmCisKKyNpZiBk
ZWZpbmVkKENPTkZJR19EUk1fQU1EX0RDX0RDTjJfMCkKKwljYXNlIEZBTUlMWV9OVjoKKwkJZGNf
dmVyc2lvbiA9IERDTl9WRVJTSU9OXzJfMDsKKwkJYnJlYWs7CisjZW5kaWYKIAlkZWZhdWx0Ogog
CQlkY192ZXJzaW9uID0gRENFX1ZFUlNJT05fVU5LTk9XTjsKIAkJYnJlYWs7CkBAIC0xNTEsNiAr
MTYwLDEyIEBAIHN0cnVjdCByZXNvdXJjZV9wb29sICpkY19jcmVhdGVfcmVzb3VyY2VfcG9vbChz
dHJ1Y3QgZGMgICpkYywKICNlbmRpZgogCiAKKyNpZiBkZWZpbmVkKENPTkZJR19EUk1fQU1EX0RD
X0RDTjJfMCkKKwljYXNlIERDTl9WRVJTSU9OXzJfMDoKKwkJcmVzX3Bvb2wgPSBkY24yMF9jcmVh
dGVfcmVzb3VyY2VfcG9vbChpbml0X2RhdGEsIGRjKTsKKwkJYnJlYWs7CisjZW5kaWYKKwogCWRl
ZmF1bHQ6CiAJCWJyZWFrOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9kYy9kY2UvZGNlX2RtY3UuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
Y2UvZGNlX2RtY3UuYwppbmRleCBjMmJjMzZmOWY2YzcuLmYzYjAxZjBiOGNlNyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjZS9kY2VfZG1jdS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY2UvZGNlX2RtY3UuYwpAQCAtNzI2LDYgKzcy
Niw1NiBAQCBzdGF0aWMgYm9vbCBkY24xMF9pc19kbWN1X2luaXRpYWxpemVkKHN0cnVjdCBkbWN1
ICpkbWN1KQogCiAjZW5kaWYgLy8oQ09ORklHX0RSTV9BTURfRENfRENOMV8wKQogCisjaWYgZGVm
aW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzApCisKK3N0YXRpYyBib29sIGRjbjIwX2xvY2tf
cGh5KHN0cnVjdCBkbWN1ICpkbWN1KQoreworCXN0cnVjdCBkY2VfZG1jdSAqZG1jdV9kY2UgPSBU
T19EQ0VfRE1DVShkbWN1KTsKKworCS8qIElmIG1pY3JvY29udHJvbGxlciBpcyBub3QgcnVubmlu
ZywgZG8gbm90aGluZyAqLworCWlmIChkbWN1LT5kbWN1X3N0YXRlICE9IERNQ1VfUlVOTklORykK
KwkJcmV0dXJuIGZhbHNlOworCisJLyogd2FpdERNQ1VSZWFkeUZvckNtZCAqLworCVJFR19XQUlU
KE1BU1RFUl9DT01NX0NOVExfUkVHLCBNQVNURVJfQ09NTV9JTlRFUlJVUFQsIDAsIDEsIDEwMDAw
KTsKKworCS8qIHNldERNQ1VQYXJhbV9DbWQgKi8KKwlSRUdfVVBEQVRFKE1BU1RFUl9DT01NX0NN
RF9SRUcsIE1BU1RFUl9DT01NX0NNRF9SRUdfQllURTAsIE1DUF9TWU5DX1BIWV9MT0NLKTsKKwor
CS8qIG5vdGlmeURNQ1VNc2cgKi8KKwlSRUdfVVBEQVRFKE1BU1RFUl9DT01NX0NOVExfUkVHLCBN
QVNURVJfQ09NTV9JTlRFUlJVUFQsIDEpOworCisJLyogd2FpdERNQ1VSZWFkeUZvckNtZCAqLwor
CVJFR19XQUlUKE1BU1RFUl9DT01NX0NOVExfUkVHLCBNQVNURVJfQ09NTV9JTlRFUlJVUFQsIDAs
IDEsIDEwMDAwKTsKKworCXJldHVybiB0cnVlOworfQorCitzdGF0aWMgYm9vbCBkY24yMF91bmxv
Y2tfcGh5KHN0cnVjdCBkbWN1ICpkbWN1KQoreworCXN0cnVjdCBkY2VfZG1jdSAqZG1jdV9kY2Ug
PSBUT19EQ0VfRE1DVShkbWN1KTsKKworCS8qIElmIG1pY3JvY29udHJvbGxlciBpcyBub3QgcnVu
bmluZywgZG8gbm90aGluZyAqLworCWlmIChkbWN1LT5kbWN1X3N0YXRlICE9IERNQ1VfUlVOTklO
RykKKwkJcmV0dXJuIGZhbHNlOworCisJLyogd2FpdERNQ1VSZWFkeUZvckNtZCAqLworCVJFR19X
QUlUKE1BU1RFUl9DT01NX0NOVExfUkVHLCBNQVNURVJfQ09NTV9JTlRFUlJVUFQsIDAsIDEsIDEw
MDAwKTsKKworCS8qIHNldERNQ1VQYXJhbV9DbWQgKi8KKwlSRUdfVVBEQVRFKE1BU1RFUl9DT01N
X0NNRF9SRUcsIE1BU1RFUl9DT01NX0NNRF9SRUdfQllURTAsIE1DUF9TWU5DX1BIWV9VTkxPQ0sp
OworCisJLyogbm90aWZ5RE1DVU1zZyAqLworCVJFR19VUERBVEUoTUFTVEVSX0NPTU1fQ05UTF9S
RUcsIE1BU1RFUl9DT01NX0lOVEVSUlVQVCwgMSk7CisKKwkvKiB3YWl0RE1DVVJlYWR5Rm9yQ21k
ICovCisJUkVHX1dBSVQoTUFTVEVSX0NPTU1fQ05UTF9SRUcsIE1BU1RFUl9DT01NX0lOVEVSUlVQ
VCwgMCwgMSwgMTAwMDApOworCisJcmV0dXJuIHRydWU7Cit9CisKKyNlbmRpZiAvLyhDT05GSUdf
RFJNX0FNRF9EQ19EQ04yXzApCisKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZG1jdV9mdW5jcyBkY2Vf
ZnVuY3MgPSB7CiAJLmRtY3VfaW5pdCA9IGRjZV9kbWN1X2luaXQsCiAJLmxvYWRfaXJhbSA9IGRj
ZV9kbWN1X2xvYWRfaXJhbSwKQEAgLTc1MCw2ICs4MDAsMjEgQEAgc3RhdGljIGNvbnN0IHN0cnVj
dCBkbWN1X2Z1bmNzIGRjbjEwX2Z1bmNzID0gewogfTsKICNlbmRpZgogCisjaWYgZGVmaW5lZChD
T05GSUdfRFJNX0FNRF9EQ19EQ04yXzApCitzdGF0aWMgY29uc3Qgc3RydWN0IGRtY3VfZnVuY3Mg
ZGNuMjBfZnVuY3MgPSB7CisJLmRtY3VfaW5pdCA9IGRjbjEwX2RtY3VfaW5pdCwKKwkubG9hZF9p
cmFtID0gZGNuMTBfZG1jdV9sb2FkX2lyYW0sCisJLnNldF9wc3JfZW5hYmxlID0gZGNuMTBfZG1j
dV9zZXRfcHNyX2VuYWJsZSwKKwkuc2V0dXBfcHNyID0gZGNuMTBfZG1jdV9zZXR1cF9wc3IsCisJ
LmdldF9wc3Jfc3RhdGUgPSBkY24xMF9nZXRfZG1jdV9wc3Jfc3RhdGUsCisJLnNldF9wc3Jfd2Fp
dF9sb29wID0gZGNuMTBfcHNyX3dhaXRfbG9vcCwKKwkuZ2V0X3Bzcl93YWl0X2xvb3AgPSBkY24x
MF9nZXRfcHNyX3dhaXRfbG9vcCwKKwkuaXNfZG1jdV9pbml0aWFsaXplZCA9IGRjbjEwX2lzX2Rt
Y3VfaW5pdGlhbGl6ZWQsCisJLmxvY2tfcGh5ID0gZGNuMjBfbG9ja19waHksCisJLnVubG9ja19w
aHkgPSBkY24yMF91bmxvY2tfcGh5Cit9OworI2VuZGlmCisKIHN0YXRpYyB2b2lkIGRjZV9kbWN1
X2NvbnN0cnVjdCgKIAlzdHJ1Y3QgZGNlX2RtY3UgKmRtY3VfZGNlLAogCXN0cnVjdCBkY19jb250
ZXh0ICpjdHgsCkBAIC04MTIsNiArODc3LDI5IEBAIHN0cnVjdCBkbWN1ICpkY24xMF9kbWN1X2Ny
ZWF0ZSgKIH0KICNlbmRpZgogCisjaWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzAp
CitzdHJ1Y3QgZG1jdSAqZGNuMjBfZG1jdV9jcmVhdGUoCisJc3RydWN0IGRjX2NvbnRleHQgKmN0
eCwKKwljb25zdCBzdHJ1Y3QgZGNlX2RtY3VfcmVnaXN0ZXJzICpyZWdzLAorCWNvbnN0IHN0cnVj
dCBkY2VfZG1jdV9zaGlmdCAqZG1jdV9zaGlmdCwKKwljb25zdCBzdHJ1Y3QgZGNlX2RtY3VfbWFz
ayAqZG1jdV9tYXNrKQoreworCXN0cnVjdCBkY2VfZG1jdSAqZG1jdV9kY2UgPSBremFsbG9jKHNp
emVvZigqZG1jdV9kY2UpLCBHRlBfS0VSTkVMKTsKKworCWlmIChkbWN1X2RjZSA9PSBOVUxMKSB7
CisJCUJSRUFLX1RPX0RFQlVHR0VSKCk7CisJCXJldHVybiBOVUxMOworCX0KKworCWRjZV9kbWN1
X2NvbnN0cnVjdCgKKwkJZG1jdV9kY2UsIGN0eCwgcmVncywgZG1jdV9zaGlmdCwgZG1jdV9tYXNr
KTsKKworCWRtY3VfZGNlLT5iYXNlLmZ1bmNzID0gJmRjbjIwX2Z1bmNzOworCisJcmV0dXJuICZk
bWN1X2RjZS0+YmFzZTsKK30KKyNlbmRpZgorCiB2b2lkIGRjZV9kbWN1X2Rlc3Ryb3koc3RydWN0
IGRtY3UgKipkbWN1KQogewogCXN0cnVjdCBkY2VfZG1jdSAqZG1jdV9kY2UgPSBUT19EQ0VfRE1D
VSgqZG1jdSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNl
L2RjZV9kbWN1LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNlL2RjZV9kbWN1
LmgKaW5kZXggNWJkMGRmNTVhYTVkLi5jYzg1ODc2ODNiNGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY2UvZGNlX2RtY3UuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2Rpc3BsYXkvZGMvZGNlL2RjZV9kbWN1LmgKQEAgLTI2MSw2ICsyNjEsMTQgQEAgc3Ry
dWN0IGRtY3UgKmRjbjEwX2RtY3VfY3JlYXRlKAogCWNvbnN0IHN0cnVjdCBkY2VfZG1jdV9zaGlm
dCAqZG1jdV9zaGlmdCwKIAljb25zdCBzdHJ1Y3QgZGNlX2RtY3VfbWFzayAqZG1jdV9tYXNrKTsK
IAorI2lmIGRlZmluZWQoQ09ORklHX0RSTV9BTURfRENfRENOMl8wKQorc3RydWN0IGRtY3UgKmRj
bjIwX2RtY3VfY3JlYXRlKAorCXN0cnVjdCBkY19jb250ZXh0ICpjdHgsCisJY29uc3Qgc3RydWN0
IGRjZV9kbWN1X3JlZ2lzdGVycyAqcmVncywKKwljb25zdCBzdHJ1Y3QgZGNlX2RtY3Vfc2hpZnQg
KmRtY3Vfc2hpZnQsCisJY29uc3Qgc3RydWN0IGRjZV9kbWN1X21hc2sgKmRtY3VfbWFzayk7Cisj
ZW5kaWYKKwogdm9pZCBkY2VfZG1jdV9kZXN0cm95KHN0cnVjdCBkbWN1ICoqZG1jdSk7CiAKIHN0
YXRpYyBjb25zdCB1aW50MzJfdCBhYm1fZ2Fpbl9zdGVwc2l6ZSA9IDB4MDA2MDsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY2UvZGNlX2h3c2VxLmggYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNlL2RjZV9od3NlcS5oCmluZGV4IDk1NmJkZjE0
NTAzZi4uY2IwYTAzN2IxYzRhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvZGNlL2RjZV9od3NlcS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9k
Yy9kY2UvZGNlX2h3c2VxLmgKQEAgLTE5OSw2ICsxOTksNzAgQEAKIAlTUihEQ19JUF9SRVFVRVNU
X0NOVEwpLCBcCiAJQkxfUkVHX0xJU1QoKQogCisjaWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9E
Q19EQ04yXzApCisjZGVmaW5lIEhXU0VRX0RDTjJfUkVHX0xJU1QoKVwKKwlIV1NFUV9EQ05fUkVH
X0xJU1QoKSwgXAorCUhXU0VRX1BJWEVMX1JBVEVfUkVHX0xJU1QoT1RHKSwgXAorCUhXU0VRX1BI
WVBMTF9SRUdfTElTVChPVEcpLCBcCisJU1IoTUlDUk9TRUNPTkRfVElNRV9CQVNFX0RJViksIFwK
KwlTUihNSUxMSVNFQ09ORF9USU1FX0JBU0VfRElWKSwgXAorCVNSKERJU1BDTEtfRlJFUV9DSEFO
R0VfQ05UTCksIFwKKwlTUihSQkJNSUZfVElNRU9VVF9ESVMpLCBcCisJU1IoUkJCTUlGX1RJTUVP
VVRfRElTXzIpLCBcCisJU1IoRENIVUJCVUJfQ1JDX0NUUkwpLCBcCisJU1IoRFBQX1RPUDBfRFBQ
X0NSQ19DVFJMKSwgXAorCVNSKERQUF9UT1AwX0RQUF9DUkNfVkFMX0JfQSksIFwKKwlTUihEUFBf
VE9QMF9EUFBfQ1JDX1ZBTF9SX0cpLCBcCisJU1IoTVBDX0NSQ19DVFJMKSwgXAorCVNSKE1QQ19D
UkNfUkVTVUxUX0dCKSwgXAorCVNSKE1QQ19DUkNfUkVTVUxUX0MpLCBcCisJU1IoTVBDX0NSQ19S
RVNVTFRfQVIpLCBcCisJU1IoRE9NQUlOMF9QR19DT05GSUcpLCBcCisJU1IoRE9NQUlOMV9QR19D
T05GSUcpLCBcCisJU1IoRE9NQUlOMl9QR19DT05GSUcpLCBcCisJU1IoRE9NQUlOM19QR19DT05G
SUcpLCBcCisJU1IoRE9NQUlONF9QR19DT05GSUcpLCBcCisJU1IoRE9NQUlONV9QR19DT05GSUcp
LCBcCisJU1IoRE9NQUlONl9QR19DT05GSUcpLCBcCisJU1IoRE9NQUlON19QR19DT05GSUcpLCBc
CisJU1IoRE9NQUlOOF9QR19DT05GSUcpLCBcCisJU1IoRE9NQUlOOV9QR19DT05GSUcpLCBcCisJ
U1IoRE9NQUlOMTBfUEdfQ09ORklHKSwgXAorCVNSKERPTUFJTjExX1BHX0NPTkZJRyksIFwKKwlT
UihET01BSU4xNl9QR19DT05GSUcpLCBcCisJU1IoRE9NQUlOMTdfUEdfQ09ORklHKSwgXAorCVNS
KERPTUFJTjE4X1BHX0NPTkZJRyksIFwKKwlTUihET01BSU4xOV9QR19DT05GSUcpLCBcCisJU1Io
RE9NQUlOMjBfUEdfQ09ORklHKSwgXAorCVNSKERPTUFJTjIxX1BHX0NPTkZJRyksIFwKKwlTUihE
T01BSU4wX1BHX1NUQVRVUyksIFwKKwlTUihET01BSU4xX1BHX1NUQVRVUyksIFwKKwlTUihET01B
SU4yX1BHX1NUQVRVUyksIFwKKwlTUihET01BSU4zX1BHX1NUQVRVUyksIFwKKwlTUihET01BSU40
X1BHX1NUQVRVUyksIFwKKwlTUihET01BSU41X1BHX1NUQVRVUyksIFwKKwlTUihET01BSU42X1BH
X1NUQVRVUyksIFwKKwlTUihET01BSU43X1BHX1NUQVRVUyksIFwKKwlTUihET01BSU44X1BHX1NU
QVRVUyksIFwKKwlTUihET01BSU45X1BHX1NUQVRVUyksIFwKKwlTUihET01BSU4xMF9QR19TVEFU
VVMpLCBcCisJU1IoRE9NQUlOMTFfUEdfU1RBVFVTKSwgXAorCVNSKERPTUFJTjE2X1BHX1NUQVRV
UyksIFwKKwlTUihET01BSU4xN19QR19TVEFUVVMpLCBcCisJU1IoRE9NQUlOMThfUEdfU1RBVFVT
KSwgXAorCVNSKERPTUFJTjE5X1BHX1NUQVRVUyksIFwKKwlTUihET01BSU4yMF9QR19TVEFUVVMp
LCBcCisJU1IoRE9NQUlOMjFfUEdfU1RBVFVTKSwgXAorCVNSKEQxVkdBX0NPTlRST0wpLCBcCisJ
U1IoRDJWR0FfQ09OVFJPTCksIFwKKwlTUihEM1ZHQV9DT05UUk9MKSwgXAorCVNSKEQ0VkdBX0NP
TlRST0wpLCBcCisJU1IoRDVWR0FfQ09OVFJPTCksIFwKKwlTUihENlZHQV9DT05UUk9MKSwgXAor
CVNSKERDX0lQX1JFUVVFU1RfQ05UTCksIFwKKwlCTF9SRUdfTElTVCgpCisjZW5kaWYKKwogc3Ry
dWN0IGRjZV9od3NlcV9yZWdpc3RlcnMgewogCiAJCS8qIEJhY2tsaWdodCByZWdpc3RlcnMgKi8K
QEAgLTQ1Myw2ICs1MTcsNjkgQEAgc3RydWN0IGRjZV9od3NlcV9yZWdpc3RlcnMgewogCUhXU19T
RigsIExWVE1BX1BXUlNFUV9DTlRMLCBMVlRNQV9ESUdPTl9PVlJELCBtYXNrX3NoKSwgXAogCUhX
U19TRigsIExWVE1BX1BXUlNFUV9TVEFURSwgTFZUTUFfUFdSU0VRX1RBUkdFVF9TVEFURV9SLCBt
YXNrX3NoKQogCisjaWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzApCisjZGVmaW5l
IEhXU0VRX0RDTjJfTUFTS19TSF9MSVNUKG1hc2tfc2gpXAorCUhXU0VRX0RDTl9NQVNLX1NIX0xJ
U1QobWFza19zaCksIFwKKwlIV1NfU0YoLCBEQ0hVQkJVQl9HTE9CQUxfVElNRVJfQ05UTCwgRENI
VUJCVUJfR0xPQkFMX1RJTUVSX1JFRkRJViwgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01BSU4w
X1BHX0NPTkZJRywgRE9NQUlOMF9QT1dFUl9GT1JDRU9OLCBtYXNrX3NoKSwgXAorCUhXU19TRigs
IERPTUFJTjBfUEdfQ09ORklHLCBET01BSU4wX1BPV0VSX0dBVEUsIG1hc2tfc2gpLCBcCisJSFdT
X1NGKCwgRE9NQUlOMV9QR19DT05GSUcsIERPTUFJTjFfUE9XRVJfRk9SQ0VPTiwgbWFza19zaCks
IFwKKwlIV1NfU0YoLCBET01BSU4xX1BHX0NPTkZJRywgRE9NQUlOMV9QT1dFUl9HQVRFLCBtYXNr
X3NoKSwgXAorCUhXU19TRigsIERPTUFJTjJfUEdfQ09ORklHLCBET01BSU4yX1BPV0VSX0ZPUkNF
T04sIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlOMl9QR19DT05GSUcsIERPTUFJTjJfUE9X
RVJfR0FURSwgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01BSU4zX1BHX0NPTkZJRywgRE9NQUlO
M19QT1dFUl9GT1JDRU9OLCBtYXNrX3NoKSwgXAorCUhXU19TRigsIERPTUFJTjNfUEdfQ09ORklH
LCBET01BSU4zX1BPV0VSX0dBVEUsIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlONF9QR19D
T05GSUcsIERPTUFJTjRfUE9XRVJfRk9SQ0VPTiwgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01B
SU40X1BHX0NPTkZJRywgRE9NQUlONF9QT1dFUl9HQVRFLCBtYXNrX3NoKSwgXAorCUhXU19TRigs
IERPTUFJTjVfUEdfQ09ORklHLCBET01BSU41X1BPV0VSX0ZPUkNFT04sIG1hc2tfc2gpLCBcCisJ
SFdTX1NGKCwgRE9NQUlONV9QR19DT05GSUcsIERPTUFJTjVfUE9XRVJfR0FURSwgbWFza19zaCks
IFwKKwlIV1NfU0YoLCBET01BSU42X1BHX0NPTkZJRywgRE9NQUlONl9QT1dFUl9GT1JDRU9OLCBt
YXNrX3NoKSwgXAorCUhXU19TRigsIERPTUFJTjZfUEdfQ09ORklHLCBET01BSU42X1BPV0VSX0dB
VEUsIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlON19QR19DT05GSUcsIERPTUFJTjdfUE9X
RVJfRk9SQ0VPTiwgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01BSU43X1BHX0NPTkZJRywgRE9N
QUlON19QT1dFUl9HQVRFLCBtYXNrX3NoKSwgXAorCUhXU19TRigsIERPTUFJTjhfUEdfQ09ORklH
LCBET01BSU44X1BPV0VSX0ZPUkNFT04sIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlOOF9Q
R19DT05GSUcsIERPTUFJTjhfUE9XRVJfR0FURSwgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01B
SU45X1BHX0NPTkZJRywgRE9NQUlOOV9QT1dFUl9GT1JDRU9OLCBtYXNrX3NoKSwgXAorCUhXU19T
RigsIERPTUFJTjlfUEdfQ09ORklHLCBET01BSU45X1BPV0VSX0dBVEUsIG1hc2tfc2gpLCBcCisJ
SFdTX1NGKCwgRE9NQUlOMTBfUEdfQ09ORklHLCBET01BSU4xMF9QT1dFUl9GT1JDRU9OLCBtYXNr
X3NoKSwgXAorCUhXU19TRigsIERPTUFJTjEwX1BHX0NPTkZJRywgRE9NQUlOMTBfUE9XRVJfR0FU
RSwgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01BSU4xMV9QR19DT05GSUcsIERPTUFJTjExX1BP
V0VSX0ZPUkNFT04sIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlOMTFfUEdfQ09ORklHLCBE
T01BSU4xMV9QT1dFUl9HQVRFLCBtYXNrX3NoKSwgXAorCUhXU19TRigsIERPTUFJTjE2X1BHX0NP
TkZJRywgRE9NQUlOMTZfUE9XRVJfRk9SQ0VPTiwgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01B
SU4xNl9QR19DT05GSUcsIERPTUFJTjE2X1BPV0VSX0dBVEUsIG1hc2tfc2gpLCBcCisJSFdTX1NG
KCwgRE9NQUlOMTdfUEdfQ09ORklHLCBET01BSU4xN19QT1dFUl9GT1JDRU9OLCBtYXNrX3NoKSwg
XAorCUhXU19TRigsIERPTUFJTjE3X1BHX0NPTkZJRywgRE9NQUlOMTdfUE9XRVJfR0FURSwgbWFz
a19zaCksIFwKKwlIV1NfU0YoLCBET01BSU4xOF9QR19DT05GSUcsIERPTUFJTjE4X1BPV0VSX0ZP
UkNFT04sIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlOMThfUEdfQ09ORklHLCBET01BSU4x
OF9QT1dFUl9HQVRFLCBtYXNrX3NoKSwgXAorCUhXU19TRigsIERPTUFJTjE5X1BHX0NPTkZJRywg
RE9NQUlOMTlfUE9XRVJfRk9SQ0VPTiwgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01BSU4xOV9Q
R19DT05GSUcsIERPTUFJTjE5X1BPV0VSX0dBVEUsIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9N
QUlOMjBfUEdfQ09ORklHLCBET01BSU4yMF9QT1dFUl9GT1JDRU9OLCBtYXNrX3NoKSwgXAorCUhX
U19TRigsIERPTUFJTjIwX1BHX0NPTkZJRywgRE9NQUlOMjBfUE9XRVJfR0FURSwgbWFza19zaCks
IFwKKwlIV1NfU0YoLCBET01BSU4yMV9QR19DT05GSUcsIERPTUFJTjIxX1BPV0VSX0ZPUkNFT04s
IG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlOMjFfUEdfQ09ORklHLCBET01BSU4yMV9QT1dF
Ul9HQVRFLCBtYXNrX3NoKSwgXAorCUhXU19TRigsIERPTUFJTjBfUEdfU1RBVFVTLCBET01BSU4w
X1BHRlNNX1BXUl9TVEFUVVMsIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlOMV9QR19TVEFU
VVMsIERPTUFJTjFfUEdGU01fUFdSX1NUQVRVUywgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01B
SU4yX1BHX1NUQVRVUywgRE9NQUlOMl9QR0ZTTV9QV1JfU1RBVFVTLCBtYXNrX3NoKSwgXAorCUhX
U19TRigsIERPTUFJTjNfUEdfU1RBVFVTLCBET01BSU4zX1BHRlNNX1BXUl9TVEFUVVMsIG1hc2tf
c2gpLCBcCisJSFdTX1NGKCwgRE9NQUlONF9QR19TVEFUVVMsIERPTUFJTjRfUEdGU01fUFdSX1NU
QVRVUywgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01BSU41X1BHX1NUQVRVUywgRE9NQUlONV9Q
R0ZTTV9QV1JfU1RBVFVTLCBtYXNrX3NoKSwgXAorCUhXU19TRigsIERPTUFJTjZfUEdfU1RBVFVT
LCBET01BSU42X1BHRlNNX1BXUl9TVEFUVVMsIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlO
N19QR19TVEFUVVMsIERPTUFJTjdfUEdGU01fUFdSX1NUQVRVUywgbWFza19zaCksIFwKKwlIV1Nf
U0YoLCBET01BSU44X1BHX1NUQVRVUywgRE9NQUlOOF9QR0ZTTV9QV1JfU1RBVFVTLCBtYXNrX3No
KSwgXAorCUhXU19TRigsIERPTUFJTjlfUEdfU1RBVFVTLCBET01BSU45X1BHRlNNX1BXUl9TVEFU
VVMsIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlOMTBfUEdfU1RBVFVTLCBET01BSU4xMF9Q
R0ZTTV9QV1JfU1RBVFVTLCBtYXNrX3NoKSwgXAorCUhXU19TRigsIERPTUFJTjExX1BHX1NUQVRV
UywgRE9NQUlOMTFfUEdGU01fUFdSX1NUQVRVUywgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01B
SU4xNl9QR19TVEFUVVMsIERPTUFJTjE2X1BHRlNNX1BXUl9TVEFUVVMsIG1hc2tfc2gpLCBcCisJ
SFdTX1NGKCwgRE9NQUlOMTdfUEdfU1RBVFVTLCBET01BSU4xN19QR0ZTTV9QV1JfU1RBVFVTLCBt
YXNrX3NoKSwgXAorCUhXU19TRigsIERPTUFJTjE4X1BHX1NUQVRVUywgRE9NQUlOMThfUEdGU01f
UFdSX1NUQVRVUywgbWFza19zaCksIFwKKwlIV1NfU0YoLCBET01BSU4xOV9QR19TVEFUVVMsIERP
TUFJTjE5X1BHRlNNX1BXUl9TVEFUVVMsIG1hc2tfc2gpLCBcCisJSFdTX1NGKCwgRE9NQUlOMjBf
UEdfU1RBVFVTLCBET01BSU4yMF9QR0ZTTV9QV1JfU1RBVFVTLCBtYXNrX3NoKSwgXAorCUhXU19T
RigsIERPTUFJTjIxX1BHX1NUQVRVUywgRE9NQUlOMjFfUEdGU01fUFdSX1NUQVRVUywgbWFza19z
aCksIFwKKwlIV1NfU0YoLCBEQ19JUF9SRVFVRVNUX0NOVEwsIElQX1JFUVVFU1RfRU4sIG1hc2tf
c2gpLCBcCisJSFdTX1NGKCwgTFZUTUFfUFdSU0VRX0NOVEwsIExWVE1BX0JMT04sIG1hc2tfc2gp
LCBcCisJSFdTX1NGKCwgTFZUTUFfUFdSU0VRX1NUQVRFLCBMVlRNQV9QV1JTRVFfVEFSR0VUX1NU
QVRFX1IsIG1hc2tfc2gpCisjZW5kaWYKKwogI2RlZmluZSBIV1NFUV9SRUdfRklFTERfTElTVCh0
eXBlKSBcCiAJdHlwZSBEQ0ZFX0NMT0NLX0VOQUJMRTsgXAogCXR5cGUgRENGRVZfQ0xPQ0tfRU5B
QkxFOyBcCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNlMTEw
L2RjZTExMF9od19zZXF1ZW5jZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
Y2UxMTAvZGNlMTEwX2h3X3NlcXVlbmNlci5jCmluZGV4IDJhN2FjNDUyZDQ1OC4uZTdjYzU4ZWY2
YTVlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNlMTEwL2Rj
ZTExMF9od19zZXF1ZW5jZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMv
ZGNlMTEwL2RjZTExMF9od19zZXF1ZW5jZXIuYwpAQCAtNjY2LDcgKzY2NiwyNiBAQCB2b2lkIGRj
ZTExMF9lbmFibGVfc3RyZWFtKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpCiAKIAkvKiB1cGRh
dGUgQVZJIGluZm8gZnJhbWUgKEhETUksIERQKSovCiAJLyogVE9ETzogRlBHQSBtYXkgY2hhbmdl
IHRvIGh3c3MudXBkYXRlX2luZm9fZnJhbWUgKi8KLQlkY2UxMTBfdXBkYXRlX2luZm9fZnJhbWUo
cGlwZV9jdHgpOworCisjaWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzApCisJaWYg
KHBpcGVfY3R4LT5zdHJlYW1fcmVzLnN0cmVhbV9lbmMtPmZ1bmNzLT5zZXRfZHluYW1pY19tZXRh
ZGF0YSAhPSBOVUxMICYmCisJCQlwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnAgIT0gTlVMTCkgewor
CQlpZiAocGlwZV9jdHgtPnN0cmVhbS0+ZG1kYXRhX2FkZHJlc3MucXVhZF9wYXJ0ICE9IDApIHsK
KwkJCS8qIGlmIHVzaW5nIGR5bmFtaWMgbWV0YSwgZG9uJ3Qgc2V0IHVwIGdlbmVyaWMgaW5mb3Bh
Y2tldHMgKi8KKwkJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLmVuY29kZXJfaW5mb19mcmFtZS5oZHJz
bWQudmFsaWQgPSBmYWxzZTsKKwkJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnN0cmVhbV9lbmMtPmZ1
bmNzLT5zZXRfZHluYW1pY19tZXRhZGF0YSgKKwkJCQkJcGlwZV9jdHgtPnN0cmVhbV9yZXMuc3Ry
ZWFtX2VuYywKKwkJCQkJdHJ1ZSwgcGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwLT5pbnN0LAorCQkJ
CQlkY19pc19kcF9zaWduYWwocGlwZV9jdHgtPnN0cmVhbS0+c2lnbmFsKSA/CisJCQkJCQkJZG1k
YXRhX2RwIDogZG1kYXRhX2hkbWkpOworCQl9IGVsc2UKKwkJCXBpcGVfY3R4LT5zdHJlYW1fcmVz
LnN0cmVhbV9lbmMtPmZ1bmNzLT5zZXRfZHluYW1pY19tZXRhZGF0YSgKKwkJCQkJcGlwZV9jdHgt
PnN0cmVhbV9yZXMuc3RyZWFtX2VuYywKKwkJCQkJZmFsc2UsIHBpcGVfY3R4LT5wbGFuZV9yZXMu
aHVicC0+aW5zdCwKKwkJCQkJZGNfaXNfZHBfc2lnbmFsKHBpcGVfY3R4LT5zdHJlYW0tPnNpZ25h
bCkgPworCQkJCQkJCWRtZGF0YV9kcCA6IGRtZGF0YV9oZG1pKTsKKwl9CisjZW5kaWYKIAogCS8q
IGVuYWJsZSBlYXJseSBjb250cm9sIHRvIGF2b2lkIGNvcnJ1cHRpb24gb24gRFAgbW9uaXRvciov
CiAJYWN0aXZlX3RvdGFsX3dpdGhfYm9yZGVycyA9CkBAIC05NTEsNiArOTcwLDEwIEBAIHN0YXRp
YyB2b2lkIHNldF9wbWVfd2FfZW5hYmxlX2J5X3ZlcnNpb24oc3RydWN0IGRjICpkYykKIAlpZiAo
cHBfc211KSB7CiAJCWlmIChwcF9zbXUtPmN0eC52ZXIgPT0gUFBfU01VX1ZFUl9SViAmJiBwcF9z
bXUtPnJ2X2Z1bmNzLnNldF9wbWVfd2FfZW5hYmxlKQogCQkJcHBfc211LT5ydl9mdW5jcy5zZXRf
cG1lX3dhX2VuYWJsZSgmKHBwX3NtdS0+Y3R4KSk7CisjaWZkZWYgQ09ORklHX0RSTV9BTURfRENf
RENOMl8wCisJCWVsc2UgaWYgKHBwX3NtdS0+Y3R4LnZlciA9PSBQUF9TTVVfVkVSX05WICYmIHBw
X3NtdS0+bnZfZnVuY3Muc2V0X3BtZV93YV9lbmFibGUpCisJCQlwcF9zbXUtPm52X2Z1bmNzLnNl
dF9wbWVfd2FfZW5hYmxlKCYocHBfc211LT5jdHgpKTsKKyNlbmRpZgogCX0KIH0KIApAQCAtMTMz
Nyw2ICsxMzYwLDkgQEAgc3RhdGljIGVudW0gZGNfc3RhdHVzIGFwcGx5X3NpbmdsZV9jb250cm9s
bGVyX2N0eF90b19odygKIAlzdHJ1Y3QgZGNfc3RyZWFtX3N0YXRlICpzdHJlYW0gPSBwaXBlX2N0
eC0+c3RyZWFtOwogCXN0cnVjdCBkcnJfcGFyYW1zIHBhcmFtcyA9IHswfTsKIAl1bnNpZ25lZCBp
bnQgZXZlbnRfdHJpZ2dlcnMgPSAwOworI2lmIGRlZmluZWQoQ09ORklHX0RSTV9BTURfRENfRENO
Ml8wKQorCXN0cnVjdCBwaXBlX2N0eCAqb2RtX3BpcGUgPSBkY19yZXNfZ2V0X29kbV9ib3R0b21f
cGlwZShwaXBlX2N0eCk7CisjZW5kaWYKIAogCWlmIChkYy0+aHdzcy5kaXNhYmxlX3N0cmVhbV9n
YXRpbmcpIHsKIAkJZGMtPmh3c3MuZGlzYWJsZV9zdHJlYW1fZ2F0aW5nKGRjLCBwaXBlX2N0eCk7
CkBAIC0xNDAyLDYgKzE0MjgsMjAgQEAgc3RhdGljIGVudW0gZGNfc3RhdHVzIGFwcGx5X3Npbmds
ZV9jb250cm9sbGVyX2N0eF90b19odygKIAkJcGlwZV9jdHgtPnN0cmVhbV9yZXMub3BwLAogCQkm
c3RyZWFtLT5iaXRfZGVwdGhfcGFyYW1zLAogCQkmc3RyZWFtLT5jbGFtcGluZyk7CisjaWYgZGVm
aW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzApCisJaWYgKG9kbV9waXBlKSB7CisJCW9kbV9w
aXBlLT5zdHJlYW1fcmVzLm9wcC0+ZnVuY3MtPm9wcF9zZXRfZHluX2V4cGFuc2lvbigKKwkJCQlv
ZG1fcGlwZS0+c3RyZWFtX3Jlcy5vcHAsCisJCQkJQ09MT1JfU1BBQ0VfWUNCQ1I2MDEsCisJCQkJ
c3RyZWFtLT50aW1pbmcuZGlzcGxheV9jb2xvcl9kZXB0aCwKKwkJCQlzdHJlYW0tPnNpZ25hbCk7
CisKKwkJb2RtX3BpcGUtPnN0cmVhbV9yZXMub3BwLT5mdW5jcy0+b3BwX3Byb2dyYW1fZm10KAor
CQkJCW9kbV9waXBlLT5zdHJlYW1fcmVzLm9wcCwKKwkJCQkmc3RyZWFtLT5iaXRfZGVwdGhfcGFy
YW1zLAorCQkJCSZzdHJlYW0tPmNsYW1waW5nKTsKKwl9CisjZW5kaWYKIAogCWlmICghc3RyZWFt
LT5kcG1zX29mZikKIAkJY29yZV9saW5rX2VuYWJsZV9zdHJlYW0oY29udGV4dCwgcGlwZV9jdHgp
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEw
X2h3X3NlcXVlbmNlci5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2Rj
bjEwX2h3X3NlcXVlbmNlci5jCmluZGV4IDRlZGI0N2RlZDYyOS4uMmZmNzcwZmY3ZDIyIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfaHdfc2Vx
dWVuY2VyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEw
X2h3X3NlcXVlbmNlci5jCkBAIC00OCw2ICs0OCw3IEBACiAjaW5jbHVkZSAiY2xrX21nci5oIgog
CiAKKwogI2RlZmluZSBEQ19MT0dHRVJfSU5JVChsb2dnZXIpCiAKICNkZWZpbmUgQ1RYIFwKQEAg
LTM0NSw2ICszNDYsNyBAQCB2b2lkIGRjbjEwX2xvZ19od19zdGF0ZShzdHJ1Y3QgZGMgKmRjLAog
CX0KIAlEVE5fSU5GTygiXG4iKTsKIAorCiAJRFROX0lORk8oIlxuQ0FMQ1VMQVRFRCBDbG9ja3M6
IGRjZmNsa19raHo6JWQgIGRjZmNsa19kZWVwX3NsZWVwX2toejolZCAgZGlzcGNsa19raHo6JWRc
biIKIAkJImRwcGNsa19raHo6JWQgIG1heF9zdXBwb3J0ZWRfZHBwY2xrX2toejolZCAgZmNsa19r
aHo6JWQgIHNvY2Nsa19raHo6JWRcblxuIiwKIAkJCWRjLT5jdXJyZW50X3N0YXRlLT5id19jdHgu
YncuZGNuLmNsay5kY2ZjbGtfa2h6LApAQCAtMTk1MSw3ICsxOTUzLDEyIEBAIHN0YXRpYyB2b2lk
IHVwZGF0ZV9kcHAoc3RydWN0IGRwcCAqZHBwLCBzdHJ1Y3QgZGNfcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlKQogCQkJcGxhbmVfc3RhdGUtPmZvcm1hdCwKIAkJCUVYUEFOU0lPTl9NT0RFX1pFUk8s
CiAJCQlwbGFuZV9zdGF0ZS0+aW5wdXRfY3NjX2NvbG9yX21hdHJpeCwKKyNpZmRlZiBDT05GSUdf
RFJNX0FNRF9EQ19EQ04yXzAKKwkJCXBsYW5lX3N0YXRlLT5jb2xvcl9zcGFjZSwKKwkJCU5VTEwp
OworI2Vsc2UKIAkJCXBsYW5lX3N0YXRlLT5jb2xvcl9zcGFjZSk7CisjZW5kaWYKIAogCS8vc2V0
IHNjYWxlIGFuZCBiaWFzIHJlZ2lzdGVycwogCWRjbjEwX2J1aWxkX3ByZXNjYWxlX3BhcmFtcygm
Ym5zX3BhcmFtcywgcGxhbmVfc3RhdGUpOwpAQCAtMjQwNSw2ICsyNDEyLDEyIEBAIHN0YXRpYyB2
b2lkIGRjbjEwX2FwcGx5X2N0eF9mb3Jfc3VyZmFjZSgKIAkJCQkmcGlwZV9jdHgtPnR0dV9yZWdz
KTsKIAkJfQogCisjaWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzApCisJLyogUHJv
Z3JhbSBzZWNvbmRhcnkgYmxlbmRpbmcgdHJlZSBhbmQgd3JpdGViYWNrIHBpcGVzICovCisJaWYg
KChzdHJlYW0tPm51bV93Yl9pbmZvID4gMCkgJiYgKGRjLT5od3NzLnByb2dyYW1fYWxsX3dyaXRl
YmFja19waXBlc19pbl90cmVlKSkKKwkJZGMtPmh3c3MucHJvZ3JhbV9hbGxfd3JpdGViYWNrX3Bp
cGVzX2luX3RyZWUoZGMsIHN0cmVhbSwgY29udGV4dCk7CisjZW5kaWYKKwogCWlmIChpbnRlcmRl
cGVuZGVudF91cGRhdGUpCiAJCWxvY2tfYWxsX3BpcGVzKGRjLCBjb250ZXh0LCBmYWxzZSk7CiAJ
ZWxzZQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL01h
a2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL01ha2VmaWxlCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMjNiZWMzOTEyYzNjCi0tLSAv
ZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL01ha2Vm
aWxlCkBAIC0wLDAgKzEsMTQgQEAKKyMKKyMgTWFrZWZpbGUgZm9yIERDTi4KKworRENOMjAgPSBk
Y24yMF9yZXNvdXJjZS5vIGRjbjIwX2h3c2VxLm8gZGNuMjBfZHBwLm8gZGNuMjBfZHBwX2NtLm8g
ZGNuMjBfaHVicC5vIFwKKwkJZGNuMjBfbXBjLm8gZGNuMjBfb3BwLm8gZGNuMjBfaHViYnViLm8g
ZGNuMjBfb3B0Yy5vIGRjbjIwX21taHViYnViLm8gXAorCQlkY24yMF9zdHJlYW1fZW5jb2Rlci5v
IGRjbjIwX2xpbmtfZW5jb2Rlci5vIGRjbjIwX2RjY2cubyBcCisJCWRjbjIwX3ZtaWQubyBkY24y
MF9kd2IubyBkY24yMF9kd2Jfc2NsLm8KKworCitDRkxBR1NfZGNuMjBfcmVzb3VyY2UubyA6PSAt
bWhhcmQtZmxvYXQgLW1zc2UgLW1wcmVmZXJyZWQtc3RhY2stYm91bmRhcnk9NAorCitBTURfREFM
X0RDTjIwID0gJChhZGRwcmVmaXggJChBTUREQUxQQVRIKS9kYy9kY24yMC8sJChEQ04yMCkpCisK
K0FNRF9ESVNQTEFZX0ZJTEVTICs9ICQoQU1EX0RBTF9EQ04yMCkKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9od3NlcS5jIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h3c2VxLmMKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi40ODdhMDdjYmViOTMKLS0tIC9kZXYvbnVsbAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHdzZXEuYwpAQCAt
MCwwICsxLDE5MjYgQEAKKy8qCisgKiBDb3B5cmlnaHQgMjAxNiBBZHZhbmNlZCBNaWNybyBEZXZp
Y2VzLCBJbmMuCisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBj
aGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2Fy
ZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisg
KiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcg
d2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBt
ZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNv
cGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQor
ICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dp
bmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhp
cyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgorICogYWxsIGNvcGllcyBv
ciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCisgKgorICogVEhFIFNPRlRX
QVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVY
UFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdB
UlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFS
IFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUg
Q09QWVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0s
IERBTUFHRVMgT1IKKyAqIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0Yg
Q09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAorICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1Ig
SU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SCisgKiBPVEhFUiBE
RUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCisgKgorICogQXV0aG9yczogQU1ECisgKgorICovCisK
KyNpbmNsdWRlICJkbV9zZXJ2aWNlcy5oIgorI2luY2x1ZGUgImRtX2hlbHBlcnMuaCIKKyNpbmNs
dWRlICJjb3JlX3R5cGVzLmgiCisjaW5jbHVkZSAicmVzb3VyY2UuaCIKKyNpbmNsdWRlICJkY24y
MC9kY24yMF9yZXNvdXJjZS5oIgorI2luY2x1ZGUgImRjZTExMC9kY2UxMTBfaHdfc2VxdWVuY2Vy
LmgiCisjaW5jbHVkZSAiZGNuMTAvZGNuMTBfaHdfc2VxdWVuY2VyLmgiCisjaW5jbHVkZSAiZGNu
MjBfaHdzZXEuaCIKKyNpbmNsdWRlICJkY2UvZGNlX2h3c2VxLmgiCisjaW5jbHVkZSAiYWJtLmgi
CisjaW5jbHVkZSAiY2xrX21nci5oIgorI2luY2x1ZGUgImRtY3UuaCIKKyNpbmNsdWRlICJodWJw
LmgiCisjaW5jbHVkZSAidGltaW5nX2dlbmVyYXRvci5oIgorI2luY2x1ZGUgIm9wcC5oIgorI2lu
Y2x1ZGUgImlwcC5oIgorI2luY2x1ZGUgIm1wYy5oIgorI2luY2x1ZGUgIm1jaWZfd2IuaCIKKyNp
bmNsdWRlICJyZWdfaGVscGVyLmgiCisjaW5jbHVkZSAiZGNuMTAvZGNuMTBfY21fY29tbW9uLmgi
CisjaW5jbHVkZSAiZGNuMTAvZGNuMTBfaHViYnViLmgiCisjaW5jbHVkZSAiZGNuMTAvZGNuMTBf
b3B0Yy5oIgorI2luY2x1ZGUgImRjX2xpbmtfZHAuaCIKKyNpbmNsdWRlICJ2bV9oZWxwZXIuaCIK
KyNpbmNsdWRlICJkY2NnLmgiCisKKyNkZWZpbmUgRENfTE9HR0VSX0lOSVQobG9nZ2VyKQorCisj
ZGVmaW5lIENUWCBcCisJaHdzLT5jdHgKKyNkZWZpbmUgUkVHKHJlZylcCisJaHdzLT5yZWdzLT5y
ZWcKKworI3VuZGVmIEZOCisjZGVmaW5lIEZOKHJlZ19uYW1lLCBmaWVsZF9uYW1lKSBcCisJaHdz
LT5zaGlmdHMtPmZpZWxkX25hbWUsIGh3cy0+bWFza3MtPmZpZWxkX25hbWUKKworc3RhdGljIHZv
aWQgYmlvc19nb2xkZW5faW5pdChzdHJ1Y3QgZGMgKmRjKQoreworCXN0cnVjdCBkY19iaW9zICpi
cCA9IGRjLT5jdHgtPmRjX2Jpb3M7CisJaW50IGk7CisKKwkvKiBpbml0aWFsaXplIGRjbiBnbG9i
YWwgKi8KKwlicC0+ZnVuY3MtPmVuYWJsZV9kaXNwX3Bvd2VyX2dhdGluZyhicCwKKwkJCUNPTlRS
T0xMRVJfSURfRDAsIEFTSUNfUElQRV9JTklUKTsKKworCWZvciAoaSA9IDA7IGkgPCBkYy0+cmVz
X3Bvb2wtPnBpcGVfY291bnQ7IGkrKykgeworCQkvKiBpbml0aWFsaXplIGRjbiBwZXIgcGlwZSAq
LworCQlicC0+ZnVuY3MtPmVuYWJsZV9kaXNwX3Bvd2VyX2dhdGluZyhicCwKKwkJCQlDT05UUk9M
TEVSX0lEX0QwICsgaSwgQVNJQ19QSVBFX0RJU0FCTEUpOworCX0KK30KKworc3RhdGljIHZvaWQg
ZW5hYmxlX3Bvd2VyX2dhdGluZ19wbGFuZSgKKwlzdHJ1Y3QgZGNlX2h3c2VxICpod3MsCisJYm9v
bCBlbmFibGUpCit7CisJYm9vbCBmb3JjZV9vbiA9IDE7IC8qIGRpc2FibGUgcG93ZXIgZ2F0aW5n
ICovCisKKwlpZiAoZW5hYmxlKQorCQlmb3JjZV9vbiA9IDA7CisKKwkvKiBEQ0hVQlAwLzEvMi8z
LzQvNSAqLworCVJFR19VUERBVEUoRE9NQUlOMF9QR19DT05GSUcsIERPTUFJTjBfUE9XRVJfRk9S
Q0VPTiwgZm9yY2Vfb24pOworCVJFR19VUERBVEUoRE9NQUlOMl9QR19DT05GSUcsIERPTUFJTjJf
UE9XRVJfRk9SQ0VPTiwgZm9yY2Vfb24pOworCVJFR19VUERBVEUoRE9NQUlONF9QR19DT05GSUcs
IERPTUFJTjRfUE9XRVJfRk9SQ0VPTiwgZm9yY2Vfb24pOworCVJFR19VUERBVEUoRE9NQUlONl9Q
R19DT05GSUcsIERPTUFJTjZfUE9XRVJfRk9SQ0VPTiwgZm9yY2Vfb24pOworCVJFR19VUERBVEUo
RE9NQUlOOF9QR19DT05GSUcsIERPTUFJTjhfUE9XRVJfRk9SQ0VPTiwgZm9yY2Vfb24pOworCS8q
RG8gbm90IHBvd2VyIGdhdGUgRENIVUI1LCBzaG91bGQgYmUgbGVmdCBhdCBIVyBkZWZhdWx0LCBw
b3dlciBvbiBwZXJtYW5lbnRseSovCisJLypSRUdfVVBEQVRFKERPTUFJTjEwX1BHX0NPTkZJRywg
RE9NQUlOMTBfUE9XRVJfRk9SQ0VPTiwgZm9yY2Vfb24pOyovCisKKwkvKiBEUFAwLzEvMi8zLzQv
NSAqLworCVJFR19VUERBVEUoRE9NQUlOMV9QR19DT05GSUcsIERPTUFJTjFfUE9XRVJfRk9SQ0VP
TiwgZm9yY2Vfb24pOworCVJFR19VUERBVEUoRE9NQUlOM19QR19DT05GSUcsIERPTUFJTjNfUE9X
RVJfRk9SQ0VPTiwgZm9yY2Vfb24pOworCVJFR19VUERBVEUoRE9NQUlONV9QR19DT05GSUcsIERP
TUFJTjVfUE9XRVJfRk9SQ0VPTiwgZm9yY2Vfb24pOworCVJFR19VUERBVEUoRE9NQUlON19QR19D
T05GSUcsIERPTUFJTjdfUE9XRVJfRk9SQ0VPTiwgZm9yY2Vfb24pOworCVJFR19VUERBVEUoRE9N
QUlOOV9QR19DT05GSUcsIERPTUFJTjlfUE9XRVJfRk9SQ0VPTiwgZm9yY2Vfb24pOworCS8qRG8g
bm90IHBvd2VyIGdhdGUgRFBQNSwgc2hvdWxkIGJlIGxlZnQgYXQgSFcgZGVmYXVsdCwgcG93ZXIg
b24gcGVybWFuZW50bHkqLworCS8qUkVHX1VQREFURShET01BSU4xMV9QR19DT05GSUcsIERPTUFJ
TjExX1BPV0VSX0ZPUkNFT04sIGZvcmNlX29uKTsqLworCisJUkVHX1VQREFURShET01BSU4xNl9Q
R19DT05GSUcsIERPTUFJTjE2X1BPV0VSX0ZPUkNFT04sIGZvcmNlX29uKTsKKwlSRUdfVVBEQVRF
KERPTUFJTjE3X1BHX0NPTkZJRywgRE9NQUlOMTdfUE9XRVJfRk9SQ0VPTiwgZm9yY2Vfb24pOwor
CVJFR19VUERBVEUoRE9NQUlOMThfUEdfQ09ORklHLCBET01BSU4xOF9QT1dFUl9GT1JDRU9OLCBm
b3JjZV9vbik7CisJUkVHX1VQREFURShET01BSU4xOV9QR19DT05GSUcsIERPTUFJTjE5X1BPV0VS
X0ZPUkNFT04sIGZvcmNlX29uKTsKKwlSRUdfVVBEQVRFKERPTUFJTjIwX1BHX0NPTkZJRywgRE9N
QUlOMjBfUE9XRVJfRk9SQ0VPTiwgZm9yY2Vfb24pOworCVJFR19VUERBVEUoRE9NQUlOMjFfUEdf
Q09ORklHLCBET01BSU4yMV9QT1dFUl9GT1JDRU9OLCBmb3JjZV9vbik7Cit9CisKK3N0YXRpYyB2
b2lkIGRjbjIwX2RjY2dfaW5pdChzdHJ1Y3QgZGNlX2h3c2VxICpod3MpCit7CisJLyoKKwkgKiBz
ZXQgTUlDUk9TRUNPTkRfVElNRV9CQVNFX0RJVgorCSAqIDEwME1oeiByZWZjbGsgLT4gMHgxMjAy
NjQKKwkgKiAyN01oeiByZWZjbGsgLT4gMHgxMjAyMWIKKwkgKiA0OE1oeiByZWZjbGsgLT4gMHgx
MjAyMzAKKwkgKgorCSAqLworCVJFR19XUklURShNSUNST1NFQ09ORF9USU1FX0JBU0VfRElWLCAw
eDEyMDI2NCk7CisKKwkvKgorCSAqIHNldCBNSUxMSVNFQ09ORF9USU1FX0JBU0VfRElWCisJICog
MTAwTWh6IHJlZmNsayAtPiAweDExODZhMAorCSAqIDI3TWh6IHJlZmNsayAtPiAweDEwNjk3OAor
CSAqIDQ4TWh6IHJlZmNsayAtPiAweDEwYmI4MAorCSAqCisJICovCisJUkVHX1dSSVRFKE1JTExJ
U0VDT05EX1RJTUVfQkFTRV9ESVYsIDB4MTE4NmEwKTsKKworCS8qIFRoaXMgdmFsdWUgaXMgZGVw
ZW5kZW50IG9uIHRoZSBoYXJkd2FyZSBwaXBlbGluZSBkZWxheSBzbyBzZXQgb25jZSBwZXIgU09D
ICovCisJUkVHX1dSSVRFKERJU1BDTEtfRlJFUV9DSEFOR0VfQ05UTCwgMHg4MDEwMDNjKTsKK30K
Kworc3RhdGljIHZvaWQgZGlzYWJsZV92Z2EoCisJc3RydWN0IGRjZV9od3NlcSAqaHdzKQorewor
CVJFR19XUklURShEMVZHQV9DT05UUk9MLCAwKTsKKwlSRUdfV1JJVEUoRDJWR0FfQ09OVFJPTCwg
MCk7CisJUkVHX1dSSVRFKEQzVkdBX0NPTlRST0wsIDApOworCVJFR19XUklURShENFZHQV9DT05U
Uk9MLCAwKTsKKwlSRUdfV1JJVEUoRDVWR0FfQ09OVFJPTCwgMCk7CisJUkVHX1dSSVRFKEQ2VkdB
X0NPTlRST0wsIDApOworfQorCit2b2lkIGRjbjIwX3Byb2dyYW1fdHJpcGxlQnVmZmVyKAorCWNv
bnN0IHN0cnVjdCBkYyAqZGMsCisJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKKwlib29sIGVu
YWJsZVRyaXBsZUJ1ZmZlcikKK3sKKwlpZiAocGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwICYmIHBp
cGVfY3R4LT5wbGFuZV9yZXMuaHVicC0+ZnVuY3MpIHsKKwkJcGlwZV9jdHgtPnBsYW5lX3Jlcy5o
dWJwLT5mdW5jcy0+aHVicF9lbmFibGVfdHJpcGxlQnVmZmVyKAorCQkJcGlwZV9jdHgtPnBsYW5l
X3Jlcy5odWJwLAorCQkJZW5hYmxlVHJpcGxlQnVmZmVyKTsKKwl9Cit9CisKKy8qIEJsYW5rIHBp
eGVsIGRhdGEgZHVyaW5nIGluaXRpYWxpemF0aW9uICovCitzdGF0aWMgdm9pZCBkY24yMF9pbml0
X2JsYW5rKAorCQlzdHJ1Y3QgZGMgKmRjLAorCQlzdHJ1Y3QgdGltaW5nX2dlbmVyYXRvciAqdGcp
Cit7CisJZW51bSBkY19jb2xvcl9zcGFjZSBjb2xvcl9zcGFjZTsKKwlzdHJ1Y3QgdGdfY29sb3Ig
YmxhY2tfY29sb3IgPSB7MH07CisJc3RydWN0IG91dHB1dF9waXhlbF9wcm9jZXNzb3IgKm9wcCA9
IE5VTEw7CisJc3RydWN0IG91dHB1dF9waXhlbF9wcm9jZXNzb3IgKmJvdHRvbV9vcHAgPSBOVUxM
OworCXVpbnQzMl90IG51bV9vcHBzLCBvcHBfaWRfc3JjMCwgb3BwX2lkX3NyYzE7CisJdWludDMy
X3Qgb3RnX2FjdGl2ZV93aWR0aCwgb3RnX2FjdGl2ZV9oZWlnaHQ7CisKKwkvKiBwcm9ncmFtIG9w
cCBkcGcgYmxhbmsgY29sb3IgKi8KKwljb2xvcl9zcGFjZSA9IENPTE9SX1NQQUNFX1NSR0I7CisJ
Y29sb3Jfc3BhY2VfdG9fYmxhY2tfY29sb3IoZGMsIGNvbG9yX3NwYWNlLCAmYmxhY2tfY29sb3Ip
OworCisJLyogZ2V0IHRoZSBPVEcgYWN0aXZlIHNpemUgKi8KKwl0Zy0+ZnVuY3MtPmdldF9vdGdf
YWN0aXZlX3NpemUodGcsCisJCQkmb3RnX2FjdGl2ZV93aWR0aCwKKwkJCSZvdGdfYWN0aXZlX2hl
aWdodCk7CisKKwkvKiBnZXQgdGhlIE9QVEMgc291cmNlICovCisJdGctPmZ1bmNzLT5nZXRfb3B0
Y19zb3VyY2UodGcsICZudW1fb3BwcywgJm9wcF9pZF9zcmMwLCAmb3BwX2lkX3NyYzEpOworCUFT
U0VSVChvcHBfaWRfc3JjMCA8IGRjLT5yZXNfcG9vbC0+cmVzX2NhcC0+bnVtX29wcCk7CisJb3Bw
ID0gZGMtPnJlc19wb29sLT5vcHBzW29wcF9pZF9zcmMwXTsKKworCWlmIChudW1fb3BwcyA9PSAy
KSB7CisJCW90Z19hY3RpdmVfd2lkdGggPSBvdGdfYWN0aXZlX3dpZHRoIC8gMjsKKwkJQVNTRVJU
KG9wcF9pZF9zcmMxIDwgZGMtPnJlc19wb29sLT5yZXNfY2FwLT5udW1fb3BwKTsKKwkJYm90dG9t
X29wcCA9IGRjLT5yZXNfcG9vbC0+b3Bwc1tvcHBfaWRfc3JjMV07CisJfQorCisJb3BwLT5mdW5j
cy0+b3BwX3NldF9kaXNwX3BhdHRlcm5fZ2VuZXJhdG9yKAorCQkJb3BwLAorCQkJQ09OVFJPTExF
Ul9EUF9URVNUX1BBVFRFUk5fU09MSURfQ09MT1IsCisJCQlDT0xPUl9ERVBUSF9VTkRFRklORUQs
CisJCQkmYmxhY2tfY29sb3IsCisJCQlvdGdfYWN0aXZlX3dpZHRoLAorCQkJb3RnX2FjdGl2ZV9o
ZWlnaHQpOworCisJaWYgKG51bV9vcHBzID09IDIpIHsKKwkJYm90dG9tX29wcC0+ZnVuY3MtPm9w
cF9zZXRfZGlzcF9wYXR0ZXJuX2dlbmVyYXRvcigKKwkJCQlib3R0b21fb3BwLAorCQkJCUNPTlRS
T0xMRVJfRFBfVEVTVF9QQVRURVJOX1NPTElEX0NPTE9SLAorCQkJCUNPTE9SX0RFUFRIX1VOREVG
SU5FRCwKKwkJCQkmYmxhY2tfY29sb3IsCisJCQkJb3RnX2FjdGl2ZV93aWR0aCwKKwkJCQlvdGdf
YWN0aXZlX2hlaWdodCk7CisJfQorCisJZGNuMjBfaHdzc193YWl0X2Zvcl9ibGFua19jb21wbGV0
ZShvcHApOworfQorCisKK3N0YXRpYyB2b2lkIGRjbjIwX2RwcF9wZ19jb250cm9sKAorCQlzdHJ1
Y3QgZGNlX2h3c2VxICpod3MsCisJCXVuc2lnbmVkIGludCBkcHBfaW5zdCwKKwkJYm9vbCBwb3dl
cl9vbikKK3sKKwl1aW50MzJfdCBwb3dlcl9nYXRlID0gcG93ZXJfb24gPyAwIDogMTsKKwl1aW50
MzJfdCBwd3Jfc3RhdHVzID0gcG93ZXJfb24gPyAwIDogMjsKKworCWlmIChod3MtPmN0eC0+ZGMt
PmRlYnVnLmRpc2FibGVfZHBwX3Bvd2VyX2dhdGUpCisJCXJldHVybjsKKwlpZiAoUkVHKERPTUFJ
TjFfUEdfQ09ORklHKSA9PSAwKQorCQlyZXR1cm47CisKKwlzd2l0Y2ggKGRwcF9pbnN0KSB7CisJ
Y2FzZSAwOiAvKiBEUFAwICovCisJCVJFR19VUERBVEUoRE9NQUlOMV9QR19DT05GSUcsCisJCQkJ
RE9NQUlOMV9QT1dFUl9HQVRFLCBwb3dlcl9nYXRlKTsKKworCQlSRUdfV0FJVChET01BSU4xX1BH
X1NUQVRVUywKKwkJCQlET01BSU4xX1BHRlNNX1BXUl9TVEFUVVMsIHB3cl9zdGF0dXMsCisJCQkJ
MSwgMTAwMCk7CisJCWJyZWFrOworCWNhc2UgMTogLyogRFBQMSAqLworCQlSRUdfVVBEQVRFKERP
TUFJTjNfUEdfQ09ORklHLAorCQkJCURPTUFJTjNfUE9XRVJfR0FURSwgcG93ZXJfZ2F0ZSk7CisK
KwkJUkVHX1dBSVQoRE9NQUlOM19QR19TVEFUVVMsCisJCQkJRE9NQUlOM19QR0ZTTV9QV1JfU1RB
VFVTLCBwd3Jfc3RhdHVzLAorCQkJCTEsIDEwMDApOworCQlicmVhazsKKwljYXNlIDI6IC8qIERQ
UDIgKi8KKwkJUkVHX1VQREFURShET01BSU41X1BHX0NPTkZJRywKKwkJCQlET01BSU41X1BPV0VS
X0dBVEUsIHBvd2VyX2dhdGUpOworCisJCVJFR19XQUlUKERPTUFJTjVfUEdfU1RBVFVTLAorCQkJ
CURPTUFJTjVfUEdGU01fUFdSX1NUQVRVUywgcHdyX3N0YXR1cywKKwkJCQkxLCAxMDAwKTsKKwkJ
YnJlYWs7CisJY2FzZSAzOiAvKiBEUFAzICovCisJCVJFR19VUERBVEUoRE9NQUlON19QR19DT05G
SUcsCisJCQkJRE9NQUlON19QT1dFUl9HQVRFLCBwb3dlcl9nYXRlKTsKKworCQlSRUdfV0FJVChE
T01BSU43X1BHX1NUQVRVUywKKwkJCQlET01BSU43X1BHRlNNX1BXUl9TVEFUVVMsIHB3cl9zdGF0
dXMsCisJCQkJMSwgMTAwMCk7CisJCWJyZWFrOworCWNhc2UgNDogLyogRFBQNCAqLworCQlSRUdf
VVBEQVRFKERPTUFJTjlfUEdfQ09ORklHLAorCQkJCURPTUFJTjlfUE9XRVJfR0FURSwgcG93ZXJf
Z2F0ZSk7CisKKwkJUkVHX1dBSVQoRE9NQUlOOV9QR19TVEFUVVMsCisJCQkJRE9NQUlOOV9QR0ZT
TV9QV1JfU1RBVFVTLCBwd3Jfc3RhdHVzLAorCQkJCTEsIDEwMDApOworCQlicmVhazsKKwljYXNl
IDU6IC8qIERQUDUgKi8KKwkJLyoKKwkJICogRG8gbm90IHBvd2VyIGdhdGUgRFBQNSwgc2hvdWxk
IGJlIGxlZnQgYXQgSFcgZGVmYXVsdCwgcG93ZXIgb24gcGVybWFuZW50bHkuCisJCSAqIFBHIG9u
IFBpcGU1IGlzIERlLWZlYXR1cmVkLCBhdHRlbXB0aW5nIHRvIHB1dCBpdCB0byBQRyBzdGF0ZSBt
YXkgcmVzdWx0IGluIGhhcmQKKwkJICogcmVzZXQuCisJCSAqIFJFR19VUERBVEUoRE9NQUlOMTFf
UEdfQ09ORklHLAorCQkgKgkJRE9NQUlOMTFfUE9XRVJfR0FURSwgcG93ZXJfZ2F0ZSk7CisJCSAq
CisJCSAqIFJFR19XQUlUKERPTUFJTjExX1BHX1NUQVRVUywKKwkJICoJCURPTUFJTjExX1BHRlNN
X1BXUl9TVEFUVVMsIHB3cl9zdGF0dXMsCisJCSAqIAkJMSwgMTAwMCk7CisJCSAqLworCQlicmVh
azsKKwlkZWZhdWx0OgorCQlCUkVBS19UT19ERUJVR0dFUigpOworCQlicmVhazsKKwl9Cit9CisK
Kworc3RhdGljIHZvaWQgZGNuMjBfaHVicF9wZ19jb250cm9sKAorCQlzdHJ1Y3QgZGNlX2h3c2Vx
ICpod3MsCisJCXVuc2lnbmVkIGludCBodWJwX2luc3QsCisJCWJvb2wgcG93ZXJfb24pCit7CisJ
dWludDMyX3QgcG93ZXJfZ2F0ZSA9IHBvd2VyX29uID8gMCA6IDE7CisJdWludDMyX3QgcHdyX3N0
YXR1cyA9IHBvd2VyX29uID8gMCA6IDI7CisKKwlpZiAoaHdzLT5jdHgtPmRjLT5kZWJ1Zy5kaXNh
YmxlX2h1YnBfcG93ZXJfZ2F0ZSkKKwkJcmV0dXJuOworCWlmIChSRUcoRE9NQUlOMF9QR19DT05G
SUcpID09IDApCisJCXJldHVybjsKKworCXN3aXRjaCAoaHVicF9pbnN0KSB7CisJY2FzZSAwOiAv
KiBEQ0hVQlAwICovCisJCVJFR19VUERBVEUoRE9NQUlOMF9QR19DT05GSUcsCisJCQkJRE9NQUlO
MF9QT1dFUl9HQVRFLCBwb3dlcl9nYXRlKTsKKworCQlSRUdfV0FJVChET01BSU4wX1BHX1NUQVRV
UywKKwkJCQlET01BSU4wX1BHRlNNX1BXUl9TVEFUVVMsIHB3cl9zdGF0dXMsCisJCQkJMSwgMTAw
MCk7CisJCWJyZWFrOworCWNhc2UgMTogLyogRENIVUJQMSAqLworCQlSRUdfVVBEQVRFKERPTUFJ
TjJfUEdfQ09ORklHLAorCQkJCURPTUFJTjJfUE9XRVJfR0FURSwgcG93ZXJfZ2F0ZSk7CisKKwkJ
UkVHX1dBSVQoRE9NQUlOMl9QR19TVEFUVVMsCisJCQkJRE9NQUlOMl9QR0ZTTV9QV1JfU1RBVFVT
LCBwd3Jfc3RhdHVzLAorCQkJCTEsIDEwMDApOworCQlicmVhazsKKwljYXNlIDI6IC8qIERDSFVC
UDIgKi8KKwkJUkVHX1VQREFURShET01BSU40X1BHX0NPTkZJRywKKwkJCQlET01BSU40X1BPV0VS
X0dBVEUsIHBvd2VyX2dhdGUpOworCisJCVJFR19XQUlUKERPTUFJTjRfUEdfU1RBVFVTLAorCQkJ
CURPTUFJTjRfUEdGU01fUFdSX1NUQVRVUywgcHdyX3N0YXR1cywKKwkJCQkxLCAxMDAwKTsKKwkJ
YnJlYWs7CisJY2FzZSAzOiAvKiBEQ0hVQlAzICovCisJCVJFR19VUERBVEUoRE9NQUlONl9QR19D
T05GSUcsCisJCQkJRE9NQUlONl9QT1dFUl9HQVRFLCBwb3dlcl9nYXRlKTsKKworCQlSRUdfV0FJ
VChET01BSU42X1BHX1NUQVRVUywKKwkJCQlET01BSU42X1BHRlNNX1BXUl9TVEFUVVMsIHB3cl9z
dGF0dXMsCisJCQkJMSwgMTAwMCk7CisJCWJyZWFrOworCWNhc2UgNDogLyogRENIVUJQNCAqLwor
CQlSRUdfVVBEQVRFKERPTUFJTjhfUEdfQ09ORklHLAorCQkJCURPTUFJTjhfUE9XRVJfR0FURSwg
cG93ZXJfZ2F0ZSk7CisKKwkJUkVHX1dBSVQoRE9NQUlOOF9QR19TVEFUVVMsCisJCQkJRE9NQUlO
OF9QR0ZTTV9QV1JfU1RBVFVTLCBwd3Jfc3RhdHVzLAorCQkJCTEsIDEwMDApOworCQlicmVhazsK
KwljYXNlIDU6IC8qIERDSFVCUDUgKi8KKwkJLyoKKwkJICogRG8gbm90IHBvd2VyIGdhdGUgRENI
VUI1LCBzaG91bGQgYmUgbGVmdCBhdCBIVyBkZWZhdWx0LCBwb3dlciBvbiBwZXJtYW5lbnRseS4K
KwkJICogUEcgb24gUGlwZTUgaXMgRGUtZmVhdHVyZWQsIGF0dGVtcHRpbmcgdG8gcHV0IGl0IHRv
IFBHIHN0YXRlIG1heSByZXN1bHQgaW4gaGFyZAorCQkgKiByZXNldC4KKwkJICogUkVHX1VQREFU
RShET01BSU4xMF9QR19DT05GSUcsCisJCSAqCQlET01BSU4xMF9QT1dFUl9HQVRFLCBwb3dlcl9n
YXRlKTsKKwkJICoKKwkJICogUkVHX1dBSVQoRE9NQUlOMTBfUEdfU1RBVFVTLAorCQkgKgkJRE9N
QUlOMTBfUEdGU01fUFdSX1NUQVRVUywgcHdyX3N0YXR1cywKKwkJICoJCTEsIDEwMDApOworCQkg
Ki8KKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJQlJFQUtfVE9fREVCVUdHRVIoKTsKKwkJYnJlYWs7
CisJfQorfQorCisKKworc3RhdGljIHZvaWQgZGNuMjBfcGxhbmVfYXRvbWljX3Bvd2VyX2Rvd24o
c3RydWN0IGRjICpkYywgc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCkKK3sKKwlzdHJ1Y3QgZGNl
X2h3c2VxICpod3MgPSBkYy0+aHdzZXE7CisJc3RydWN0IGRwcCAqZHBwID0gcGlwZV9jdHgtPnBs
YW5lX3Jlcy5kcHA7CisKKwlEQ19MT0dHRVJfSU5JVChkYy0+Y3R4LT5sb2dnZXIpOworCisJaWYg
KFJFRyhEQ19JUF9SRVFVRVNUX0NOVEwpKSB7CisJCVJFR19TRVQoRENfSVBfUkVRVUVTVF9DTlRM
LCAwLAorCQkJCUlQX1JFUVVFU1RfRU4sIDEpOworCQlkY24yMF9kcHBfcGdfY29udHJvbChod3Ms
IGRwcC0+aW5zdCwgZmFsc2UpOworCQlkY24yMF9odWJwX3BnX2NvbnRyb2woaHdzLCBwaXBlX2N0
eC0+cGxhbmVfcmVzLmh1YnAtPmluc3QsIGZhbHNlKTsKKwkJZHBwLT5mdW5jcy0+ZHBwX3Jlc2V0
KGRwcCk7CisJCVJFR19TRVQoRENfSVBfUkVRVUVTVF9DTlRMLCAwLAorCQkJCUlQX1JFUVVFU1Rf
RU4sIDApOworCQlEQ19MT0dfREVCVUcoCisJCQkJIlBvd2VyIGdhdGVkIGZyb250IGVuZCAlZFxu
IiwgcGlwZV9jdHgtPnBpcGVfaWR4KTsKKwl9Cit9CisKKworCisvKiBkaXNhYmxlIEhXIHVzZWQg
YnkgcGxhbmUuCisgKiBub3RlOiAgY2Fubm90IGRpc2FibGUgdW50aWwgZGlzY29ubmVjdCBpcyBj
b21wbGV0ZQorICovCitzdGF0aWMgdm9pZCBkY24yMF9wbGFuZV9hdG9taWNfZGlzYWJsZShzdHJ1
Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KQoreworCXN0cnVjdCBodWJwICpo
dWJwID0gcGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwOworCXN0cnVjdCBkcHAgKmRwcCA9IHBpcGVf
Y3R4LT5wbGFuZV9yZXMuZHBwOworCWludCBvcHBfaWQgPSBodWJwLT5vcHBfaWQ7CisKKwlkYy0+
aHdzcy53YWl0X2Zvcl9tcGNjX2Rpc2Nvbm5lY3QoZGMsIGRjLT5yZXNfcG9vbCwgcGlwZV9jdHgp
OworCisJaHVicC0+ZnVuY3MtPmh1YnBfY2xrX2NudGwoaHVicCwgZmFsc2UpOworCisJZHBwLT5m
dW5jcy0+ZHBwX2RwcGNsa19jb250cm9sKGRwcCwgZmFsc2UsIGZhbHNlKTsKKworCWlmIChvcHBf
aWQgIT0gMHhmICYmIHBpcGVfY3R4LT5zdHJlYW1fcmVzLm9wcC0+bXBjX3RyZWVfcGFyYW1zLm9w
cF9saXN0ID09IE5VTEwpCisJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLm9wcC0+ZnVuY3MtPm9wcF9w
aXBlX2Nsb2NrX2NvbnRyb2woCisJCQkJcGlwZV9jdHgtPnN0cmVhbV9yZXMub3BwLAorCQkJCWZh
bHNlKTsKKworCWh1YnAtPnBvd2VyX2dhdGVkID0gdHJ1ZTsKKwlkYy0+b3B0aW1pemVkX3JlcXVp
cmVkID0gZmFsc2U7IC8qIFdlJ3JlIHBvd2VyaW5nIG9mZiwgbm8gbmVlZCB0byBvcHRpbWl6ZSAq
LworCisJZGNuMjBfcGxhbmVfYXRvbWljX3Bvd2VyX2Rvd24oZGMsIHBpcGVfY3R4KTsKKworCXBp
cGVfY3R4LT5zdHJlYW0gPSBOVUxMOworCW1lbXNldCgmcGlwZV9jdHgtPnN0cmVhbV9yZXMsIDAs
IHNpemVvZihwaXBlX2N0eC0+c3RyZWFtX3JlcykpOworCW1lbXNldCgmcGlwZV9jdHgtPnBsYW5l
X3JlcywgMCwgc2l6ZW9mKHBpcGVfY3R4LT5wbGFuZV9yZXMpKTsKKwlwaXBlX2N0eC0+dG9wX3Bp
cGUgPSBOVUxMOworCXBpcGVfY3R4LT5ib3R0b21fcGlwZSA9IE5VTEw7CisJcGlwZV9jdHgtPnBs
YW5lX3N0YXRlID0gTlVMTDsKK30KKworCitzdGF0aWMgdm9pZCBkY24yMF9kaXNhYmxlX3BsYW5l
KHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpCit7CisJRENfTE9HR0VS
X0lOSVQoZGMtPmN0eC0+bG9nZ2VyKTsKKworCWlmICghcGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJw
IHx8IHBpcGVfY3R4LT5wbGFuZV9yZXMuaHVicC0+cG93ZXJfZ2F0ZWQpCisJCXJldHVybjsKKwor
CWRjbjIwX3BsYW5lX2F0b21pY19kaXNhYmxlKGRjLCBwaXBlX2N0eCk7CisKKwkvL2FwcGx5X0RF
R1ZJRENOMTBfMjUzX3dhKGRjKTsKKworCURDX0xPR19EQygiUG93ZXIgZG93biBmcm9udCBlbmQg
JWRcbiIsCisJCQkJCXBpcGVfY3R4LT5waXBlX2lkeCk7Cit9CisKK3N0YXRpYyB2b2lkIGRjbjIw
X2luaXRfaHcoc3RydWN0IGRjICpkYykKK3sKKwlpbnQgaSwgajsKKwlzdHJ1Y3QgYWJtICphYm0g
PSBkYy0+cmVzX3Bvb2wtPmFibTsKKwlzdHJ1Y3QgZG1jdSAqZG1jdSA9IGRjLT5yZXNfcG9vbC0+
ZG1jdTsKKwlzdHJ1Y3QgZGNlX2h3c2VxICpod3MgPSBkYy0+aHdzZXE7CisJc3RydWN0IGRjX2Jp
b3MgKmRjYiA9IGRjLT5jdHgtPmRjX2Jpb3M7CisJc3RydWN0IHJlc291cmNlX3Bvb2wgKnJlc19w
b29sID0gZGMtPnJlc19wb29sOworCXN0cnVjdCBkY19zdGF0ZSAgKmNvbnRleHQgPSBkYy0+Y3Vy
cmVudF9zdGF0ZTsKKworCWlmIChkYy0+Y2xrX21nciAmJiBkYy0+Y2xrX21nci0+ZnVuY3MtPmlu
aXRfY2xvY2tzKQorCQlkYy0+Y2xrX21nci0+ZnVuY3MtPmluaXRfY2xvY2tzKGRjLT5jbGtfbWdy
KTsKKworCS8vIEluaXRpYWxpemUgdGhlIGRjY2cKKwlpZiAocmVzX3Bvb2wtPmRjY2ctPmZ1bmNz
LT5kY2NnX2luaXQpCisJCXJlc19wb29sLT5kY2NnLT5mdW5jcy0+ZGNjZ19pbml0KHJlc19wb29s
LT5kY2NnKTsKKworCS8vRW5hYmxlIGFiaWxpdHkgdG8gcG93ZXIgZ2F0ZSAvIGRvbid0IGZvcmNl
IHBvd2VyIG9uIHBlcm1hbmVudGx5CisJZW5hYmxlX3Bvd2VyX2dhdGluZ19wbGFuZShkYy0+aHdz
ZXEsIHRydWUpOworCisJaWYgKElTX0ZQR0FfTUFYSU1VU19EQyhkYy0+Y3R4LT5kY2VfZW52aXJv
bm1lbnQpKSB7CisJCVJFR19XUklURShSQkJNSUZfVElNRU9VVF9ESVMsIDB4RkZGRkZGRkYpOwor
CQlSRUdfV1JJVEUoUkJCTUlGX1RJTUVPVVRfRElTXzIsIDB4RkZGRkZGRkYpOworCisJCWRjbjIw
X2RjY2dfaW5pdChod3MpOworCisJCVJFR19VUERBVEUoRENIVUJCVUJfR0xPQkFMX1RJTUVSX0NO
VEwsIERDSFVCQlVCX0dMT0JBTF9USU1FUl9SRUZESVYsIDIpOworCQlSRUdfVVBEQVRFKERDSFVC
QlVCX0dMT0JBTF9USU1FUl9DTlRMLCBEQ0hVQkJVQl9HTE9CQUxfVElNRVJfRU5BQkxFLCAxKTsK
KwkJUkVHX1dSSVRFKFJFRkNMS19DTlRMLCAwKTsKKwl9IGVsc2UgeworCQlpZiAoIWRjYi0+ZnVu
Y3MtPmlzX2FjY2VsZXJhdGVkX21vZGUoZGNiKSkgeworCQkJYmlvc19nb2xkZW5faW5pdChkYyk7
CisJCQlkaXNhYmxlX3ZnYShkYy0+aHdzZXEpOworCQl9CisKKwkJZm9yIChpID0gMDsgaSA8IGRj
LT5saW5rX2NvdW50OyBpKyspIHsKKwkJCS8qIFBvd2VyIHVwIEFORCB1cGRhdGUgaW1wbGVtZW50
YXRpb24gYWNjb3JkaW5nIHRvIHRoZQorCQkJICogcmVxdWlyZWQgc2lnbmFsICh3aGljaCBtYXkg
YmUgZGlmZmVyZW50IGZyb20gdGhlCisJCQkgKiBkZWZhdWx0IHNpZ25hbCBvbiBjb25uZWN0b3Ip
LgorCQkJICovCisJCQlzdHJ1Y3QgZGNfbGluayAqbGluayA9IGRjLT5saW5rc1tpXTsKKworCQkJ
aWYgKGxpbmstPmxpbmtfZW5jLT5jb25uZWN0b3IuaWQgPT0gQ09OTkVDVE9SX0lEX0VEUCkKKwkJ
CQlkYy0+aHdzcy5lZHBfcG93ZXJfY29udHJvbChsaW5rLCB0cnVlKTsKKworCQkJbGluay0+bGlu
a19lbmMtPmZ1bmNzLT5od19pbml0KGxpbmstPmxpbmtfZW5jKTsKKwkJfQorCX0KKworCS8qIEJs
YW5rIHBpeGVsIGRhdGEgd2l0aCBPUFAgRFBHICovCisJZm9yIChpID0gMDsgaSA8IGRjLT5yZXNf
cG9vbC0+dGltaW5nX2dlbmVyYXRvcl9jb3VudDsgaSsrKSB7CisJCXN0cnVjdCB0aW1pbmdfZ2Vu
ZXJhdG9yICp0ZyA9IGRjLT5yZXNfcG9vbC0+dGltaW5nX2dlbmVyYXRvcnNbaV07CisKKwkJaWYg
KHRnLT5mdW5jcy0+aXNfdGdfZW5hYmxlZCh0ZykpIHsKKwkJCWRjbjIwX2luaXRfYmxhbmsoZGMs
IHRnKTsKKwkJfQorCX0KKworCWZvciAoaSA9IDA7IGkgPCByZXNfcG9vbC0+dGltaW5nX2dlbmVy
YXRvcl9jb3VudDsgaSsrKSB7CisJCXN0cnVjdCB0aW1pbmdfZ2VuZXJhdG9yICp0ZyA9IGRjLT5y
ZXNfcG9vbC0+dGltaW5nX2dlbmVyYXRvcnNbaV07CisKKwkJaWYgKHRnLT5mdW5jcy0+aXNfdGdf
ZW5hYmxlZCh0ZykpCisJCQl0Zy0+ZnVuY3MtPmxvY2sodGcpOworCX0KKworCWZvciAoaSA9IDA7
IGkgPCBkYy0+cmVzX3Bvb2wtPnBpcGVfY291bnQ7IGkrKykgeworCQlzdHJ1Y3QgZHBwICpkcHAg
PSByZXNfcG9vbC0+ZHBwc1tpXTsKKworCQlkcHAtPmZ1bmNzLT5kcHBfcmVzZXQoZHBwKTsKKwl9
CisKKwkvKiBSZXNldCBhbGwgTVBDQyBtdXhlcyAqLworCXJlc19wb29sLT5tcGMtPmZ1bmNzLT5t
cGNfaW5pdChyZXNfcG9vbC0+bXBjKTsKKworCS8qIGluaXRpYWxpemUgT1BQIG1wY190cmVlIHBh
cmFtZXRlciAqLworCWZvciAoaSA9IDA7IGkgPCBkYy0+cmVzX3Bvb2wtPnJlc19jYXAtPm51bV9v
cHA7IGkrKykgeworCQlyZXNfcG9vbC0+b3Bwc1tpXS0+bXBjX3RyZWVfcGFyYW1zLm9wcF9pZCA9
IHJlc19wb29sLT5vcHBzW2ldLT5pbnN0OworCQlyZXNfcG9vbC0+b3Bwc1tpXS0+bXBjX3RyZWVf
cGFyYW1zLm9wcF9saXN0ID0gTlVMTDsKKwkJZm9yIChqID0gMDsgaiA8IE1BWF9QSVBFUzsgaisr
KQorCQkJcmVzX3Bvb2wtPm9wcHNbaV0tPm1wY2NfZGlzY29ubmVjdF9wZW5kaW5nW2pdID0gZmFs
c2U7CisJfQorCisJZm9yIChpID0gMDsgaSA8IGRjLT5yZXNfcG9vbC0+cGlwZV9jb3VudDsgaSsr
KSB7CisJCXN0cnVjdCB0aW1pbmdfZ2VuZXJhdG9yICp0ZyA9IGRjLT5yZXNfcG9vbC0+dGltaW5n
X2dlbmVyYXRvcnNbaV07CisJCXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHggPSAmY29udGV4dC0+
cmVzX2N0eC5waXBlX2N0eFtpXTsKKwkJc3RydWN0IGh1YnAgKmh1YnAgPSBkYy0+cmVzX3Bvb2wt
Pmh1YnBzW2ldOworCQlzdHJ1Y3QgZHBwICpkcHAgPSBkYy0+cmVzX3Bvb2wtPmRwcHNbaV07CisK
KwkJcGlwZV9jdHgtPnN0cmVhbV9yZXMudGcgPSB0ZzsKKwkJcGlwZV9jdHgtPnBpcGVfaWR4ID0g
aTsKKworCQlwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnAgPSBodWJwOworCQlwaXBlX2N0eC0+cGxh
bmVfcmVzLmRwcCA9IGRwcDsKKwkJcGlwZV9jdHgtPnBsYW5lX3Jlcy5tcGNjX2luc3QgPSBkcHAt
Pmluc3Q7CisJCWh1YnAtPm1wY2NfaWQgPSBkcHAtPmluc3Q7CisJCWh1YnAtPm9wcF9pZCA9IDB4
ZjsKKwkJaHVicC0+cG93ZXJfZ2F0ZWQgPSBmYWxzZTsKKwkJcGlwZV9jdHgtPnN0cmVhbV9yZXMu
b3BwID0gTlVMTDsKKworCQkvL2RjLT5yZXNfcG9vbC0+b3Bwc1tpXS0+bXBjX3RyZWVfcGFyYW1z
Lm9wcF9pZCA9IGRjLT5yZXNfcG9vbC0+b3Bwc1tpXS0+aW5zdDsKKwkJLy9kYy0+cmVzX3Bvb2wt
Pm9wcHNbaV0tPm1wY190cmVlX3BhcmFtcy5vcHBfbGlzdCA9IE5VTEw7CisJCWRjLT5yZXNfcG9v
bC0+b3Bwc1tpXS0+bXBjY19kaXNjb25uZWN0X3BlbmRpbmdbcGlwZV9jdHgtPnBsYW5lX3Jlcy5t
cGNjX2luc3RdID0gdHJ1ZTsKKwkJcGlwZV9jdHgtPnN0cmVhbV9yZXMub3BwID0gZGMtPnJlc19w
b29sLT5vcHBzW2ldOworCQkvKnRvIGRvKi8KKwkJaHdzczFfcGxhbmVfYXRvbWljX2Rpc2Nvbm5l
Y3QoZGMsIHBpcGVfY3R4KTsKKwl9CisKKwkvKiBpbml0aWFsaXplIERXQiBwb2ludGVyIHRvIE1D
SUZfV0IgKi8KKwlmb3IgKGkgPSAwOyBpIDwgcmVzX3Bvb2wtPnJlc19jYXAtPm51bV9kd2I7IGkr
KykKKwkJcmVzX3Bvb2wtPmR3YmNbaV0tPm1jaWYgPSByZXNfcG9vbC0+bWNpZl93YltpXTsKKwor
CWZvciAoaSA9IDA7IGkgPCBkYy0+cmVzX3Bvb2wtPnRpbWluZ19nZW5lcmF0b3JfY291bnQ7IGkr
KykgeworCQlzdHJ1Y3QgdGltaW5nX2dlbmVyYXRvciAqdGcgPSBkYy0+cmVzX3Bvb2wtPnRpbWlu
Z19nZW5lcmF0b3JzW2ldOworCisJCWlmICh0Zy0+ZnVuY3MtPmlzX3RnX2VuYWJsZWQodGcpKQor
CQkJdGctPmZ1bmNzLT51bmxvY2sodGcpOworCX0KKworCWZvciAoaSA9IDA7IGkgPCBkYy0+cmVz
X3Bvb2wtPnBpcGVfY291bnQ7IGkrKykgeworCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4ID0g
JmNvbnRleHQtPnJlc19jdHgucGlwZV9jdHhbaV07CisKKwkJZGMtPmh3c3MuZGlzYWJsZV9wbGFu
ZShkYywgcGlwZV9jdHgpOworCisJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnID0gTlVMTDsKKwkJ
cGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwID0gTlVMTDsKKwl9CisKKwlmb3IgKGkgPSAwOyBpIDwg
ZGMtPnJlc19wb29sLT50aW1pbmdfZ2VuZXJhdG9yX2NvdW50OyBpKyspIHsKKwkJc3RydWN0IHRp
bWluZ19nZW5lcmF0b3IgKnRnID0gZGMtPnJlc19wb29sLT50aW1pbmdfZ2VuZXJhdG9yc1tpXTsK
KworCQl0Zy0+ZnVuY3MtPnRnX2luaXQodGcpOworCX0KKworCS8qIGVuZCBvZiBGUEdBLiBCZWxv
dyBpZiByZWFsIEFTSUMgKi8KKwlpZiAoSVNfRlBHQV9NQVhJTVVTX0RDKGRjLT5jdHgtPmRjZV9l
bnZpcm9ubWVudCkpCisJCXJldHVybjsKKworCisJZm9yIChpID0gMDsgaSA8IHJlc19wb29sLT5h
dWRpb19jb3VudDsgaSsrKSB7CisJCXN0cnVjdCBhdWRpbyAqYXVkaW8gPSByZXNfcG9vbC0+YXVk
aW9zW2ldOworCisJCWF1ZGlvLT5mdW5jcy0+aHdfaW5pdChhdWRpbyk7CisJfQorCisJaWYgKGFi
bSAhPSBOVUxMKSB7CisJCWFibS0+ZnVuY3MtPmluaXRfYmFja2xpZ2h0KGFibSk7CisJCWFibS0+
ZnVuY3MtPmFibV9pbml0KGFibSk7CisJfQorCisJaWYgKGRtY3UgIT0gTlVMTCkKKwkJZG1jdS0+
ZnVuY3MtPmRtY3VfaW5pdChkbWN1KTsKKworCS8qIHBvd2VyIEFGTVQgSERNSSBtZW1vcnkgVE9E
TzogbWF5IG1vdmUgdG8gZGlzL2VuIG91dHB1dCBzYXZlIHBvd2VyKi8KKwlSRUdfV1JJVEUoRElP
X01FTV9QV1JfQ1RSTCwgMCk7CisKKwlpZiAoIWRjLT5kZWJ1Zy5kaXNhYmxlX2Nsb2NrX2dhdGUp
IHsKKwkJLyogZW5hYmxlIGFsbCBEQ04gY2xvY2sgZ2F0aW5nICovCisJCVJFR19XUklURShEQ0NH
X0dBVEVfRElTQUJMRV9DTlRMLCAwKTsKKworCQlSRUdfV1JJVEUoRENDR19HQVRFX0RJU0FCTEVf
Q05UTDIsIDApOworCisJCVJFR19VUERBVEUoRENGQ0xLX0NOVEwsIERDRkNMS19HQVRFX0RJUywg
MCk7CisJfQorCit9CisKK2VudW0gZGNfc3RhdHVzIGRjbjIwX2VuYWJsZV9zdHJlYW1fdGltaW5n
KAorCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAorCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRl
eHQsCisJCXN0cnVjdCBkYyAqZGMpCit7CisJc3RydWN0IGRjX3N0cmVhbV9zdGF0ZSAqc3RyZWFt
ID0gcGlwZV9jdHgtPnN0cmVhbTsKKwllbnVtIGRjX2NvbG9yX3NwYWNlIGNvbG9yX3NwYWNlOwor
CXN0cnVjdCB0Z19jb2xvciBibGFja19jb2xvciA9IHswfTsKKwlzdHJ1Y3QgZHJyX3BhcmFtcyBw
YXJhbXMgPSB7MH07CisJdW5zaWduZWQgaW50IGV2ZW50X3RyaWdnZXJzID0gMDsKKwlpbnQgd2lk
dGggPSBzdHJlYW0tPnRpbWluZy5oX2FkZHJlc3NhYmxlICsgc3RyZWFtLT50aW1pbmcuaF9ib3Jk
ZXJfbGVmdCArIHN0cmVhbS0+dGltaW5nLmhfYm9yZGVyX3JpZ2h0OworCWludCBoZWlnaHQgPSBz
dHJlYW0tPnRpbWluZy52X2FkZHJlc3NhYmxlICsgc3RyZWFtLT50aW1pbmcudl9ib3JkZXJfYm90
dG9tICsgc3RyZWFtLT50aW1pbmcudl9ib3JkZXJfdG9wOworCWVudW0gY29udHJvbGxlcl9kcF90
ZXN0X3BhdHRlcm4gZHBnX3BhdHRlcm4gPSBDT05UUk9MTEVSX0RQX1RFU1RfUEFUVEVSTl9TT0xJ
RF9DT0xPUjsKKworCisjaWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzApCisJc3Ry
dWN0IHBpcGVfY3R4ICpvZG1fcGlwZSA9IGRjX3Jlc19nZXRfb2RtX2JvdHRvbV9waXBlKHBpcGVf
Y3R4KTsKKyNlbmRpZgorCisJLyogYnkgdXBwZXIgY2FsbGVyIGxvb3AsIHBpcGUwIGlzIHBhcmVu
dCBwaXBlIGFuZCBiZSBjYWxsZWQgZmlyc3QuCisJICogYmFjayBlbmQgaXMgc2V0IHVwIGJ5IGZv
ciBwaXBlMC4gT3RoZXIgY2hpbGRyZW4gcGlwZSBzaGFyZSBiYWNrIGVuZAorCSAqIHdpdGggcGlw
ZSAwLiBObyBwcm9ncmFtIGlzIG5lZWRlZC4KKwkgKi8KKwlpZiAocGlwZV9jdHgtPnRvcF9waXBl
ICE9IE5VTEwpCisJCXJldHVybiBEQ19PSzsKKworCS8qIFRPRE8gY2hlY2sgaWYgdGltaW5nX2No
YW5nZWQsIGRpc2FibGUgc3RyZWFtIGlmIHRpbWluZyBjaGFuZ2VkICovCisKKwlpZiAob2RtX3Bp
cGUpCisJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLT5mdW5jcy0+c2V0X29kbV9jb21iaW5lKAor
CQkJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLAorCQkJCW9kbV9waXBlLT5zdHJlYW1fcmVzLm9w
cC0+aW5zdCwKKwkJCQlwaXBlX2N0eC0+c3RyZWFtLT50aW1pbmcuaF9hZGRyZXNzYWJsZS8yKTsK
KwkvKiBIVyBwcm9ncmFtIGd1aWRlIGFzc3VtZSBkaXNwbGF5IGFscmVhZHkgZGlzYWJsZQorCSAq
IGJ5IHVucGx1ZyBzZXF1ZW5jZS4gT1RHIGFzc3VtZSBzdG9wLgorCSAqLworCXBpcGVfY3R4LT5z
dHJlYW1fcmVzLnRnLT5mdW5jcy0+ZW5hYmxlX29wdGNfY2xvY2socGlwZV9jdHgtPnN0cmVhbV9y
ZXMudGcsIHRydWUpOworCisJaWYgKGZhbHNlID09IHBpcGVfY3R4LT5jbG9ja19zb3VyY2UtPmZ1
bmNzLT5wcm9ncmFtX3BpeF9jbGsoCisJCQlwaXBlX2N0eC0+Y2xvY2tfc291cmNlLAorCQkJJnBp
cGVfY3R4LT5zdHJlYW1fcmVzLnBpeF9jbGtfcGFyYW1zLAorCQkJJnBpcGVfY3R4LT5wbGxfc2V0
dGluZ3MpKSB7CisJCUJSRUFLX1RPX0RFQlVHR0VSKCk7CisJCXJldHVybiBEQ19FUlJPUl9VTkVY
UEVDVEVEOworCX0KKworCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLT5mdW5jcy0+cHJvZ3JhbV90
aW1pbmcoCisJCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy50ZywKKwkJCSZzdHJlYW0tPnRpbWluZywK
KwkJCXBpcGVfY3R4LT5waXBlX2RsZ19wYXJhbS52cmVhZHlfb2Zmc2V0LAorCQkJcGlwZV9jdHgt
PnBpcGVfZGxnX3BhcmFtLnZzdGFydHVwX3N0YXJ0LAorCQkJcGlwZV9jdHgtPnBpcGVfZGxnX3Bh
cmFtLnZ1cGRhdGVfb2Zmc2V0LAorCQkJcGlwZV9jdHgtPnBpcGVfZGxnX3BhcmFtLnZ1cGRhdGVf
d2lkdGgsCisJCQlwaXBlX2N0eC0+c3RyZWFtLT5zaWduYWwsCisJCQl0cnVlKTsKKworCWlmIChw
aXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+ZnVuY3MtPnNldHVwX2dsb2JhbF9sb2NrKQorCQlwaXBl
X2N0eC0+c3RyZWFtX3Jlcy50Zy0+ZnVuY3MtPnNldHVwX2dsb2JhbF9sb2NrKAorCQkJCXBpcGVf
Y3R4LT5zdHJlYW1fcmVzLnRnKTsKKworCS8qIHByb2dyYW0gb3RnIGJsYW5rIGNvbG9yICovCisJ
Y29sb3Jfc3BhY2UgPSBzdHJlYW0tPm91dHB1dF9jb2xvcl9zcGFjZTsKKwljb2xvcl9zcGFjZV90
b19ibGFja19jb2xvcihkYywgY29sb3Jfc3BhY2UsICZibGFja19jb2xvcik7CisKKwlpZiAob2Rt
X3BpcGUpIHsKKworCQlpZiAoZGMtPmRlYnVnLnZpc3VhbF9jb25maXJtICE9IFZJU1VBTF9DT05G
SVJNX0RJU0FCTEUpCisJCQlkcGdfcGF0dGVybiA9IENPTlRST0xMRVJfRFBfVEVTVF9QQVRURVJO
X0NPTE9SUkFNUDsKKworCQl3aWR0aCAvPSAyOworCisJCW9kbV9waXBlLT5zdHJlYW1fcmVzLm9w
cC0+ZnVuY3MtPm9wcF9waXBlX2Nsb2NrX2NvbnRyb2woCisJCQkJb2RtX3BpcGUtPnN0cmVhbV9y
ZXMub3BwLAorCQkJCXRydWUpOworCisJCW9kbV9waXBlLT5zdHJlYW1fcmVzLm9wcC0+ZnVuY3Mt
Pm9wcF9zZXRfZGlzcF9wYXR0ZXJuX2dlbmVyYXRvcigKKwkJCQlvZG1fcGlwZS0+c3RyZWFtX3Jl
cy5vcHAsCisJCQkJZHBnX3BhdHRlcm4sCisJCQkJc3RyZWFtLT50aW1pbmcuZGlzcGxheV9jb2xv
cl9kZXB0aCwKKwkJCQkmYmxhY2tfY29sb3IsCisJCQkJd2lkdGgsCisJCQkJaGVpZ2h0KTsKKwl9
CisKKwlpZiAoZGMtPmRlYnVnLnZpc3VhbF9jb25maXJtICE9IFZJU1VBTF9DT05GSVJNX0RJU0FC
TEUpCisJCWRwZ19wYXR0ZXJuID0gQ09OVFJPTExFUl9EUF9URVNUX1BBVFRFUk5fQ09MT1JTUVVB
UkVTOworCisJcGlwZV9jdHgtPnN0cmVhbV9yZXMub3BwLT5mdW5jcy0+b3BwX3BpcGVfY2xvY2tf
Y29udHJvbCgKKwkJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLm9wcCwKKwkJCXRydWUpOworCisJcGlw
ZV9jdHgtPnN0cmVhbV9yZXMub3BwLT5mdW5jcy0+b3BwX3NldF9kaXNwX3BhdHRlcm5fZ2VuZXJh
dG9yKAorCQkJcGlwZV9jdHgtPnN0cmVhbV9yZXMub3BwLAorCQkJZHBnX3BhdHRlcm4sCisJCQlz
dHJlYW0tPnRpbWluZy5kaXNwbGF5X2NvbG9yX2RlcHRoLAorCQkJJmJsYWNrX2NvbG9yLAorCQkJ
d2lkdGgsCisJCQloZWlnaHQpOworCisJLyogVlRHIGlzICB3aXRoaW4gRENIVUIgY29tbWFuZCBi
bG9jay4gRENGQ0xLIGlzIGFsd2F5cyBvbiAqLworCWlmIChmYWxzZSA9PSBwaXBlX2N0eC0+c3Ry
ZWFtX3Jlcy50Zy0+ZnVuY3MtPmVuYWJsZV9jcnRjKHBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnKSkg
eworCQlCUkVBS19UT19ERUJVR0dFUigpOworCQlyZXR1cm4gRENfRVJST1JfVU5FWFBFQ1RFRDsK
Kwl9CisKKwlkY24yMF9od3NzX3dhaXRfZm9yX2JsYW5rX2NvbXBsZXRlKHBpcGVfY3R4LT5zdHJl
YW1fcmVzLm9wcCk7CisKKwlwYXJhbXMudmVydGljYWxfdG90YWxfbWluID0gc3RyZWFtLT5hZGp1
c3Qudl90b3RhbF9taW47CisJcGFyYW1zLnZlcnRpY2FsX3RvdGFsX21heCA9IHN0cmVhbS0+YWRq
dXN0LnZfdG90YWxfbWF4OworCWlmIChwaXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+ZnVuY3MtPnNl
dF9kcnIpCisJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLT5mdW5jcy0+c2V0X2RycigKKwkJCXBp
cGVfY3R4LT5zdHJlYW1fcmVzLnRnLCAmcGFyYW1zKTsKKworCS8vIERSUiBzaG91bGQgc2V0IHRy
aWdnZXIgZXZlbnQgdG8gbW9uaXRvciBzdXJmYWNlIHVwZGF0ZSBldmVudAorCWlmIChzdHJlYW0t
PmFkanVzdC52X3RvdGFsX21pbiAhPSAwICYmIHN0cmVhbS0+YWRqdXN0LnZfdG90YWxfbWF4ICE9
IDApCisJCWV2ZW50X3RyaWdnZXJzID0gMHg4MDsKKwlpZiAocGlwZV9jdHgtPnN0cmVhbV9yZXMu
dGctPmZ1bmNzLT5zZXRfc3RhdGljX3NjcmVlbl9jb250cm9sKQorCQlwaXBlX2N0eC0+c3RyZWFt
X3Jlcy50Zy0+ZnVuY3MtPnNldF9zdGF0aWNfc2NyZWVuX2NvbnRyb2woCisJCQkJcGlwZV9jdHgt
PnN0cmVhbV9yZXMudGcsIGV2ZW50X3RyaWdnZXJzKTsKKworCS8qIFRPRE8gcHJvZ3JhbSBjcnRj
IHNvdXJjZSBzZWxlY3QgZm9yIG5vbi12aXJ0dWFsIHNpZ25hbCovCisJLyogVE9ETyBwcm9ncmFt
IEZNVCAqLworCS8qIFRPRE8gc2V0dXAgbGlua19lbmMgKi8KKwkvKiBUT0RPIHNldCBzdHJlYW0g
YXR0cmlidXRlcyAqLworCS8qIFRPRE8gcHJvZ3JhbSBhdWRpbyAqLworCS8qIFRPRE8gZW5hYmxl
IHN0cmVhbSBpZiB0aW1pbmcgY2hhbmdlZCAqLworCS8qIFRPRE8gdW5ibGFuayBzdHJlYW0gaWYg
RFAgKi8KKworCXJldHVybiBEQ19PSzsKK30KKwordm9pZCBkY24yMF9wcm9ncmFtX291dHB1dF9j
c2Moc3RydWN0IGRjICpkYywKKwkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKKwkJZW51bSBk
Y19jb2xvcl9zcGFjZSBjb2xvcnNwYWNlLAorCQl1aW50MTZfdCAqbWF0cml4LAorCQlpbnQgb3Bw
X2lkKQoreworCXN0cnVjdCBtcGMgKm1wYyA9IGRjLT5yZXNfcG9vbC0+bXBjOworCWVudW0gbXBj
X291dHB1dF9jc2NfbW9kZSBvY3NjX21vZGUgPSBNUENfT1VUUFVUX0NTQ19DT0VGX0E7CisKKwlp
ZiAocGlwZV9jdHgtPnN0cmVhbS0+Y3NjX2NvbG9yX21hdHJpeC5lbmFibGVfYWRqdXN0bWVudCA9
PSB0cnVlKSB7CisJCWlmIChtcGMtPmZ1bmNzLT5zZXRfb3V0cHV0X2NzYyAhPSBOVUxMKQorCQkJ
bXBjLT5mdW5jcy0+c2V0X291dHB1dF9jc2MobXBjLAorCQkJCQlvcHBfaWQsCisJCQkJCW1hdHJp
eCwKKwkJCQkJb2NzY19tb2RlKTsKKwl9IGVsc2UgeworCQlpZiAobXBjLT5mdW5jcy0+c2V0X29j
c2NfZGVmYXVsdCAhPSBOVUxMKQorCQkJbXBjLT5mdW5jcy0+c2V0X29jc2NfZGVmYXVsdChtcGMs
CisJCQkJCW9wcF9pZCwKKwkJCQkJY29sb3JzcGFjZSwKKwkJCQkJb2NzY19tb2RlKTsKKwl9Cit9
CisKK2Jvb2wgZGNuMjBfc2V0X291dHB1dF90cmFuc2Zlcl9mdW5jKHN0cnVjdCBwaXBlX2N0eCAq
cGlwZV9jdHgsCisJCQkJY29uc3Qgc3RydWN0IGRjX3N0cmVhbV9zdGF0ZSAqc3RyZWFtKQorewor
CWludCBtcGNjX2lkID0gcGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwLT5pbnN0OworCXN0cnVjdCBt
cGMgKm1wYyA9IHBpcGVfY3R4LT5zdHJlYW1fcmVzLm9wcC0+Y3R4LT5kYy0+cmVzX3Bvb2wtPm1w
YzsKKwlzdHJ1Y3QgcHdsX3BhcmFtcyAqcGFyYW1zID0gTlVMTDsKKwkvKgorCSAqIHByb2dyYW0g
T0dBTSBvbmx5IGZvciB0aGUgdG9wIHBpcGUKKwkgKiBpZiB0aGVyZSBpcyBhIHBpcGUgc3BsaXQg
dGhlbiBmaXggZGlhZ25vc3RpYyBpcyByZXF1aXJlZDoKKwkgKiBob3cgdG8gcGFzcyBPR0FNIHBh
cmFtZXRlciBmb3Igc3RyZWFtLgorCSAqIGlmIHByb2dyYW1taW5nIGZvciBhbGwgcGlwZXMgaXMg
cmVxdWlyZWQgdGhlbiByZW1vdmUgY29uZGl0aW9uCisJICogcGlwZV9jdHgtPnRvcF9waXBlID09
IE5VTEwgLGJ1dCB0aGVuIGZpeCB0aGUgZGlhZ25vc3RpYy4KKwkgKi8KKwlpZiAoKHBpcGVfY3R4
LT50b3BfcGlwZSA9PSBOVUxMIHx8IGRjX3Jlc19pc19vZG1faGVhZF9waXBlKHBpcGVfY3R4KSkK
KwkJCSYmIG1wYy0+ZnVuY3MtPnNldF9vdXRwdXRfZ2FtbWEgJiYgc3RyZWFtLT5vdXRfdHJhbnNm
ZXJfZnVuYykgeworCQlpZiAoc3RyZWFtLT5vdXRfdHJhbnNmZXJfZnVuYy0+dHlwZSA9PSBURl9U
WVBFX0hXUFdMKQorCQkJcGFyYW1zID0gJnN0cmVhbS0+b3V0X3RyYW5zZmVyX2Z1bmMtPnB3bDsK
KwkJZWxzZSBpZiAocGlwZV9jdHgtPnN0cmVhbS0+b3V0X3RyYW5zZmVyX2Z1bmMtPnR5cGUgPT0K
KwkJCVRGX1RZUEVfRElTVFJJQlVURURfUE9JTlRTICYmCisJCQljbV9oZWxwZXJfdHJhbnNsYXRl
X2N1cnZlX3RvX2h3X2Zvcm1hdCgKKwkJCXN0cmVhbS0+b3V0X3RyYW5zZmVyX2Z1bmMsCisJCQkm
bXBjLT5ibGVuZGVyX3BhcmFtcywgZmFsc2UpKQorCQkJcGFyYW1zID0gJm1wYy0+YmxlbmRlcl9w
YXJhbXM7CisJCS8qCisJCSAqIHRoZXJlIGlzIG5vIFJPTQorCQkgKi8KKwkJaWYgKHN0cmVhbS0+
b3V0X3RyYW5zZmVyX2Z1bmMtPnR5cGUgPT0gVEZfVFlQRV9QUkVERUZJTkVEKQorCQkJQlJFQUtf
VE9fREVCVUdHRVIoKTsKKwl9CisJLyoKKwkgKiBpZiBhYm92ZSBpZiBpcyBub3QgZXhlY3V0ZWQg
dGhlbiAncGFyYW1zJyBlcXVhbCB0byAwIGFuZCBzZXQgaW4gYnlwYXNzCisJICovCisJbXBjLT5m
dW5jcy0+c2V0X291dHB1dF9nYW1tYShtcGMsIG1wY2NfaWQsIHBhcmFtcyk7CisKKwlyZXR1cm4g
dHJ1ZTsKK30KKworc3RhdGljIGJvb2wgZGNuMjBfc2V0X2JsZW5kX2x1dCgKKwlzdHJ1Y3QgcGlw
ZV9jdHggKnBpcGVfY3R4LCBjb25zdCBzdHJ1Y3QgZGNfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRl
KQoreworCXN0cnVjdCBkcHAgKmRwcF9iYXNlID0gcGlwZV9jdHgtPnBsYW5lX3Jlcy5kcHA7CisJ
Ym9vbCByZXN1bHQgPSB0cnVlOworCXN0cnVjdCBwd2xfcGFyYW1zICpibGVuZF9sdXQgPSBOVUxM
OworCisJaWYgKHBsYW5lX3N0YXRlLT5ibGVuZF90ZikgeworCQlpZiAocGxhbmVfc3RhdGUtPmJs
ZW5kX3RmLT50eXBlID09IFRGX1RZUEVfSFdQV0wpCisJCQlibGVuZF9sdXQgPSAmcGxhbmVfc3Rh
dGUtPmJsZW5kX3RmLT5wd2w7CisJCWVsc2UgaWYgKHBsYW5lX3N0YXRlLT5ibGVuZF90Zi0+dHlw
ZSA9PSBURl9UWVBFX0RJU1RSSUJVVEVEX1BPSU5UUykgeworCQkJY21faGVscGVyX3RyYW5zbGF0
ZV9jdXJ2ZV90b19od19mb3JtYXQoCisJCQkJCXBsYW5lX3N0YXRlLT5ibGVuZF90ZiwKKwkJCQkJ
JmRwcF9iYXNlLT5yZWdhbW1hX3BhcmFtcywgZmFsc2UpOworCQkJYmxlbmRfbHV0ID0gJmRwcF9i
YXNlLT5yZWdhbW1hX3BhcmFtczsKKwkJfQorCX0KKwlyZXN1bHQgPSBkcHBfYmFzZS0+ZnVuY3Mt
PmRwcF9wcm9ncmFtX2JsbmRfbHV0KGRwcF9iYXNlLCBibGVuZF9sdXQpOworCisJcmV0dXJuIHJl
c3VsdDsKK30KKworc3RhdGljIGJvb2wgZGNuMjBfc2V0X3NoYXBlcl8zZGx1dCgKKwlzdHJ1Y3Qg
cGlwZV9jdHggKnBpcGVfY3R4LCBjb25zdCBzdHJ1Y3QgZGNfcGxhbmVfc3RhdGUgKnBsYW5lX3N0
YXRlKQoreworCXN0cnVjdCBkcHAgKmRwcF9iYXNlID0gcGlwZV9jdHgtPnBsYW5lX3Jlcy5kcHA7
CisJYm9vbCByZXN1bHQgPSB0cnVlOworCXN0cnVjdCBwd2xfcGFyYW1zICpzaGFwZXJfbHV0ID0g
TlVMTDsKKworCWlmIChwbGFuZV9zdGF0ZS0+aW5fc2hhcGVyX2Z1bmMpIHsKKwkJaWYgKHBsYW5l
X3N0YXRlLT5pbl9zaGFwZXJfZnVuYy0+dHlwZSA9PSBURl9UWVBFX0hXUFdMKQorCQkJc2hhcGVy
X2x1dCA9ICZwbGFuZV9zdGF0ZS0+aW5fc2hhcGVyX2Z1bmMtPnB3bDsKKwkJZWxzZSBpZiAocGxh
bmVfc3RhdGUtPmluX3NoYXBlcl9mdW5jLT50eXBlID09IFRGX1RZUEVfRElTVFJJQlVURURfUE9J
TlRTKSB7CisJCQljbV9oZWxwZXJfdHJhbnNsYXRlX2N1cnZlX3RvX2h3X2Zvcm1hdCgKKwkJCQkJ
cGxhbmVfc3RhdGUtPmluX3NoYXBlcl9mdW5jLAorCQkJCQkmZHBwX2Jhc2UtPnNoYXBlcl9wYXJh
bXMsIHRydWUpOworCQkJc2hhcGVyX2x1dCA9ICZkcHBfYmFzZS0+c2hhcGVyX3BhcmFtczsKKwkJ
fQorCX0KKworCXJlc3VsdCA9IGRwcF9iYXNlLT5mdW5jcy0+ZHBwX3Byb2dyYW1fc2hhcGVyX2x1
dChkcHBfYmFzZSwgc2hhcGVyX2x1dCk7CisJaWYgKHBsYW5lX3N0YXRlLT5sdXQzZF9mdW5jICYm
CisJCXBsYW5lX3N0YXRlLT5sdXQzZF9mdW5jLT5pbml0aWFsaXplZCA9PSB0cnVlKQorCQlyZXN1
bHQgPSBkcHBfYmFzZS0+ZnVuY3MtPmRwcF9wcm9ncmFtXzNkbHV0KGRwcF9iYXNlLAorCQkJCQkJ
CQkmcGxhbmVfc3RhdGUtPmx1dDNkX2Z1bmMtPmx1dF8zZCk7CisJZWxzZQorCQlyZXN1bHQgPSBk
cHBfYmFzZS0+ZnVuY3MtPmRwcF9wcm9ncmFtXzNkbHV0KGRwcF9iYXNlLCBOVUxMKTsKKworCWlm
IChwbGFuZV9zdGF0ZS0+bHV0M2RfZnVuYyAmJgorCQlwbGFuZV9zdGF0ZS0+bHV0M2RfZnVuYy0+
aW5pdGlhbGl6ZWQgPT0gdHJ1ZSAmJgorCQlwbGFuZV9zdGF0ZS0+bHV0M2RfZnVuYy0+aGRyX211
bHRpcGxpZXIgIT0gMCkKKwkJZHBwX2Jhc2UtPmZ1bmNzLT5kcHBfc2V0X2hkcl9tdWx0aXBsaWVy
KGRwcF9iYXNlLAorCQkJCXBsYW5lX3N0YXRlLT5sdXQzZF9mdW5jLT5oZHJfbXVsdGlwbGllcik7
CisJZWxzZQorCQlkcHBfYmFzZS0+ZnVuY3MtPmRwcF9zZXRfaGRyX211bHRpcGxpZXIoZHBwX2Jh
c2UsIDB4MWYwMDApOworCisJcmV0dXJuIHJlc3VsdDsKK30KKworYm9vbCBkY24yMF9zZXRfaW5w
dXRfdHJhbnNmZXJfZnVuYyhzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAorCQkJCQkgIGNvbnN0
IHN0cnVjdCBkY19wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCit7CisJc3RydWN0IGRwcCAqZHBw
X2Jhc2UgPSBwaXBlX2N0eC0+cGxhbmVfcmVzLmRwcDsKKwljb25zdCBzdHJ1Y3QgZGNfdHJhbnNm
ZXJfZnVuYyAqdGYgPSBOVUxMOworCWJvb2wgcmVzdWx0ID0gdHJ1ZTsKKwlib29sIHVzZV9kZWdh
bW1hX3JhbSA9IGZhbHNlOworCisJaWYgKGRwcF9iYXNlID09IE5VTEwgfHwgcGxhbmVfc3RhdGUg
PT0gTlVMTCkKKwkJcmV0dXJuIGZhbHNlOworCisJZGNuMjBfc2V0X3NoYXBlcl8zZGx1dChwaXBl
X2N0eCwgcGxhbmVfc3RhdGUpOworCWRjbjIwX3NldF9ibGVuZF9sdXQocGlwZV9jdHgsIHBsYW5l
X3N0YXRlKTsKKworCWlmIChwbGFuZV9zdGF0ZS0+aW5fdHJhbnNmZXJfZnVuYykKKwkJdGYgPSBw
bGFuZV9zdGF0ZS0+aW5fdHJhbnNmZXJfZnVuYzsKKworCisJaWYgKHRmID09IE5VTEwpIHsKKwkJ
ZHBwX2Jhc2UtPmZ1bmNzLT5kcHBfc2V0X2RlZ2FtbWEoZHBwX2Jhc2UsCisJCQkJSVBQX0RFR0FN
TUFfTU9ERV9CWVBBU1MpOworCQlyZXR1cm4gdHJ1ZTsKKwl9CisKKwlpZiAodGYtPnR5cGUgPT0g
VEZfVFlQRV9IV1BXTCB8fCB0Zi0+dHlwZSA9PSBURl9UWVBFX0RJU1RSSUJVVEVEX1BPSU5UUykK
KwkJdXNlX2RlZ2FtbWFfcmFtID0gdHJ1ZTsKKworCWlmICh1c2VfZGVnYW1tYV9yYW0gPT0gdHJ1
ZSkgeworCQlpZiAodGYtPnR5cGUgPT0gVEZfVFlQRV9IV1BXTCkKKwkJCWRwcF9iYXNlLT5mdW5j
cy0+ZHBwX3Byb2dyYW1fZGVnYW1tYV9wd2woZHBwX2Jhc2UsCisJCQkJCSZ0Zi0+cHdsKTsKKwkJ
ZWxzZSBpZiAodGYtPnR5cGUgPT0gVEZfVFlQRV9ESVNUUklCVVRFRF9QT0lOVFMpIHsKKwkJCWNt
X2hlbHBlcl90cmFuc2xhdGVfY3VydmVfdG9fZGVnYW1tYV9od19mb3JtYXQodGYsCisJCQkJCSZk
cHBfYmFzZS0+ZGVnYW1tYV9wYXJhbXMpOworCQkJZHBwX2Jhc2UtPmZ1bmNzLT5kcHBfcHJvZ3Jh
bV9kZWdhbW1hX3B3bChkcHBfYmFzZSwKKwkJCQkmZHBwX2Jhc2UtPmRlZ2FtbWFfcGFyYW1zKTsK
KwkJfQorCQlyZXR1cm4gdHJ1ZTsKKwl9CisJLyogaGFuZGxlIGhlcmUgdGhlIG9wdGltaXplZCBj
YXNlcyB3aGVuIGRlLWdhbW1hIFJPTSBjb3VsZCBiZSB1c2VkLgorCSAqCisJICovCisJaWYgKHRm
LT50eXBlID09IFRGX1RZUEVfUFJFREVGSU5FRCkgeworCQlzd2l0Y2ggKHRmLT50ZikgeworCQlj
YXNlIFRSQU5TRkVSX0ZVTkNUSU9OX1NSR0I6CisJCQlkcHBfYmFzZS0+ZnVuY3MtPmRwcF9zZXRf
ZGVnYW1tYShkcHBfYmFzZSwKKwkJCQkJSVBQX0RFR0FNTUFfTU9ERV9IV19zUkdCKTsKKwkJCWJy
ZWFrOworCQljYXNlIFRSQU5TRkVSX0ZVTkNUSU9OX0JUNzA5OgorCQkJZHBwX2Jhc2UtPmZ1bmNz
LT5kcHBfc2V0X2RlZ2FtbWEoZHBwX2Jhc2UsCisJCQkJCUlQUF9ERUdBTU1BX01PREVfSFdfeHZZ
Q0MpOworCQkJYnJlYWs7CisJCWNhc2UgVFJBTlNGRVJfRlVOQ1RJT05fTElORUFSOgorCQkJZHBw
X2Jhc2UtPmZ1bmNzLT5kcHBfc2V0X2RlZ2FtbWEoZHBwX2Jhc2UsCisJCQkJCUlQUF9ERUdBTU1B
X01PREVfQllQQVNTKTsKKwkJCWJyZWFrOworCQljYXNlIFRSQU5TRkVSX0ZVTkNUSU9OX1BROgor
CQlkZWZhdWx0OgorCQkJcmVzdWx0ID0gZmFsc2U7CisJCQlicmVhazsKKwkJfQorCX0gZWxzZSBp
ZiAodGYtPnR5cGUgPT0gVEZfVFlQRV9CWVBBU1MpCisJCWRwcF9iYXNlLT5mdW5jcy0+ZHBwX3Nl
dF9kZWdhbW1hKGRwcF9iYXNlLAorCQkJCUlQUF9ERUdBTU1BX01PREVfQllQQVNTKTsKKwllbHNl
IHsKKwkJLyoKKwkJICogaWYgd2UgYXJlIGhlcmUsIHdlIGRpZCBub3QgaGFuZGxlIGNvcnJlY3Rs
eS4KKwkJICogZml4IGlzIHJlcXVpcmVkIGZvciB0aGlzIHVzZSBjYXNlCisJCSAqLworCQlCUkVB
S19UT19ERUJVR0dFUigpOworCQlkcHBfYmFzZS0+ZnVuY3MtPmRwcF9zZXRfZGVnYW1tYShkcHBf
YmFzZSwKKwkJCQlJUFBfREVHQU1NQV9NT0RFX0JZUEFTUyk7CisJfQorCisJcmV0dXJuIHJlc3Vs
dDsKK30KKworc3RhdGljIHZvaWQgZGNuMjBfdXBkYXRlX29kbShzdHJ1Y3QgZGMgKmRjLCBzdHJ1
Y3QgZGNfc3RhdGUgKmNvbnRleHQsIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpCit7CisJc3Ry
dWN0IHBpcGVfY3R4ICpjb21iaW5lX3BpcGUgPSBkY19yZXNfZ2V0X29kbV9ib3R0b21fcGlwZShw
aXBlX2N0eCk7CisKKwlpZiAoY29tYmluZV9waXBlKQorCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy50
Zy0+ZnVuY3MtPnNldF9vZG1fY29tYmluZSgKKwkJCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy50ZywK
KwkJCQljb21iaW5lX3BpcGUtPnN0cmVhbV9yZXMub3BwLT5pbnN0LAorCQkJCXBpcGVfY3R4LT5w
bGFuZV9yZXMuc2NsX2RhdGEuaF9hY3RpdmUpOworCWVsc2UKKwkJcGlwZV9jdHgtPnN0cmVhbV9y
ZXMudGctPmZ1bmNzLT5zZXRfb2RtX2J5cGFzcygKKwkJCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy50
ZywgJnBpcGVfY3R4LT5zdHJlYW0tPnRpbWluZyk7Cit9CisKK3ZvaWQgZGNuMjBfYmxhbmtfcGl4
ZWxfZGF0YSgKKwkJc3RydWN0IGRjICpkYywKKwkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwK
KwkJYm9vbCBibGFuaykKK3sKKwllbnVtIGRjX2NvbG9yX3NwYWNlIGNvbG9yX3NwYWNlOworCXN0
cnVjdCB0Z19jb2xvciBibGFja19jb2xvciA9IHswfTsKKwlzdHJ1Y3Qgc3RyZWFtX3Jlc291cmNl
ICpzdHJlYW1fcmVzID0gJnBpcGVfY3R4LT5zdHJlYW1fcmVzOworCXN0cnVjdCBkY19zdHJlYW1f
c3RhdGUgKnN0cmVhbSA9IHBpcGVfY3R4LT5zdHJlYW07CisJZW51bSBjb250cm9sbGVyX2RwX3Rl
c3RfcGF0dGVybiB0ZXN0X3BhdHRlcm4gPSBDT05UUk9MTEVSX0RQX1RFU1RfUEFUVEVSTl9TT0xJ
RF9DT0xPUjsKKwlzdHJ1Y3QgcGlwZV9jdHggKmJvdF9vZG1fcGlwZSA9IGRjX3Jlc19nZXRfb2Rt
X2JvdHRvbV9waXBlKHBpcGVfY3R4KTsKKworCisJaW50IHdpZHRoID0gc3RyZWFtLT50aW1pbmcu
aF9hZGRyZXNzYWJsZSArIHN0cmVhbS0+dGltaW5nLmhfYm9yZGVyX2xlZnQgKyBzdHJlYW0tPnRp
bWluZy5oX2JvcmRlcl9yaWdodDsKKwlpbnQgaGVpZ2h0ID0gc3RyZWFtLT50aW1pbmcudl9hZGRy
ZXNzYWJsZSArIHN0cmVhbS0+dGltaW5nLnZfYm9yZGVyX2JvdHRvbSArIHN0cmVhbS0+dGltaW5n
LnZfYm9yZGVyX3RvcDsKKworCS8qIHByb2dyYW0gb3BwIGRwZyBibGFuayBjb2xvciAqLworCWNv
bG9yX3NwYWNlID0gc3RyZWFtLT5vdXRwdXRfY29sb3Jfc3BhY2U7CisJY29sb3Jfc3BhY2VfdG9f
YmxhY2tfY29sb3IoZGMsIGNvbG9yX3NwYWNlLCAmYmxhY2tfY29sb3IpOworCisJaWYgKGJvdF9v
ZG1fcGlwZSkKKwkJd2lkdGggPSB3aWR0aCAvIDI7CisKKwlpZiAoYmxhbmspIHsKKwkJaWYgKHN0
cmVhbV9yZXMtPmFibSkKKwkJCXN0cmVhbV9yZXMtPmFibS0+ZnVuY3MtPnNldF9hYm1faW1tZWRp
YXRlX2Rpc2FibGUoc3RyZWFtX3Jlcy0+YWJtKTsKKwl9IGVsc2UKKwkJdGVzdF9wYXR0ZXJuID0g
Q09OVFJPTExFUl9EUF9URVNUX1BBVFRFUk5fVklERU9NT0RFOworCisKKwlzdHJlYW1fcmVzLT5v
cHAtPmZ1bmNzLT5vcHBfc2V0X2Rpc3BfcGF0dGVybl9nZW5lcmF0b3IoCisJCQlzdHJlYW1fcmVz
LT5vcHAsCisJCQl0ZXN0X3BhdHRlcm4sCisJCQlzdHJlYW0tPnRpbWluZy5kaXNwbGF5X2NvbG9y
X2RlcHRoLAorCQkJJmJsYWNrX2NvbG9yLAorCQkJd2lkdGgsCisJCQloZWlnaHQpOworCisJaWYg
KGJvdF9vZG1fcGlwZSkgeworCQlib3Rfb2RtX3BpcGUtPnN0cmVhbV9yZXMub3BwLT5mdW5jcy0+
b3BwX3NldF9kaXNwX3BhdHRlcm5fZ2VuZXJhdG9yKAorCQkJCWJvdF9vZG1fcGlwZS0+c3RyZWFt
X3Jlcy5vcHAsCisJCQkJdGVzdF9wYXR0ZXJuLAorCQkJCXN0cmVhbS0+dGltaW5nLmRpc3BsYXlf
Y29sb3JfZGVwdGgsCisJCQkJJmJsYWNrX2NvbG9yLAorCQkJCXdpZHRoLAorCQkJCWhlaWdodCk7
CisJfQorCisJaWYgKCFibGFuaykKKwkJaWYgKHN0cmVhbV9yZXMtPmFibSkgeworCQkJc3RyZWFt
X3Jlcy0+YWJtLT5mdW5jcy0+c2V0X3BpcGUoc3RyZWFtX3Jlcy0+YWJtLCBzdHJlYW1fcmVzLT50
Zy0+aW5zdCArIDEpOworCQkJc3RyZWFtX3Jlcy0+YWJtLT5mdW5jcy0+c2V0X2FibV9sZXZlbChz
dHJlYW1fcmVzLT5hYm0sIHN0cmVhbS0+YWJtX2xldmVsKTsKKwkJfQorfQorCisKK3N0YXRpYyB2
b2lkIGRjbjIwX3Bvd2VyX29uX3BsYW5lKAorCXN0cnVjdCBkY2VfaHdzZXEgKmh3cywKKwlzdHJ1
Y3QgcGlwZV9jdHggKnBpcGVfY3R4KQoreworCURDX0xPR0dFUl9JTklUKGh3cy0+Y3R4LT5sb2dn
ZXIpOworCWlmIChSRUcoRENfSVBfUkVRVUVTVF9DTlRMKSkgeworCQlSRUdfU0VUKERDX0lQX1JF
UVVFU1RfQ05UTCwgMCwKKwkJCQlJUF9SRVFVRVNUX0VOLCAxKTsKKwkJZGNuMjBfZHBwX3BnX2Nv
bnRyb2woaHdzLCBwaXBlX2N0eC0+cGxhbmVfcmVzLmRwcC0+aW5zdCwgdHJ1ZSk7CisJCWRjbjIw
X2h1YnBfcGdfY29udHJvbChod3MsIHBpcGVfY3R4LT5wbGFuZV9yZXMuaHVicC0+aW5zdCwgdHJ1
ZSk7CisJCVJFR19TRVQoRENfSVBfUkVRVUVTVF9DTlRMLCAwLAorCQkJCUlQX1JFUVVFU1RfRU4s
IDApOworCQlEQ19MT0dfREVCVUcoCisJCQkJIlVuLWdhdGVkIGZyb250IGVuZCBmb3IgcGlwZSAl
ZFxuIiwgcGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwLT5pbnN0KTsKKwl9Cit9CisKK3N0YXRpYyB2
b2lkIGRjbjIwX2VuYWJsZV9wbGFuZSgKKwlzdHJ1Y3QgZGMgKmRjLAorCXN0cnVjdCBwaXBlX2N0
eCAqcGlwZV9jdHgsCisJc3RydWN0IGRjX3N0YXRlICpjb250ZXh0KQoreworCS8vaWYgKGRjLT5k
ZWJ1Zy5zYW5pdHlfY2hlY2tzKSB7CisJLy8JZGNuMTBfdmVyaWZ5X2FsbG93X3BzdGF0ZV9jaGFu
Z2VfaGlnaChkYyk7CisJLy99CisJZGNuMjBfcG93ZXJfb25fcGxhbmUoZGMtPmh3c2VxLCBwaXBl
X2N0eCk7CisKKwkvKiBlbmFibGUgRENGQ0xLIGN1cnJlbnQgRENIVUIgKi8KKwlwaXBlX2N0eC0+
cGxhbmVfcmVzLmh1YnAtPmZ1bmNzLT5odWJwX2Nsa19jbnRsKHBpcGVfY3R4LT5wbGFuZV9yZXMu
aHVicCwgdHJ1ZSk7CisKKwkvKiBtYWtlIHN1cmUgT1BQX1BJUEVfQ0xPQ0tfRU4gPSAxICovCisJ
cGlwZV9jdHgtPnN0cmVhbV9yZXMub3BwLT5mdW5jcy0+b3BwX3BpcGVfY2xvY2tfY29udHJvbCgK
KwkJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLm9wcCwKKwkJCXRydWUpOworCisvKiBUT0RPOiBlbmFi
bGUvZGlzYWJsZSBpbiBkbSBhcyBwZXIgdXBkYXRlIHR5cGUuCisJaWYgKHBsYW5lX3N0YXRlKSB7
CisJCURDX0xPR19EQyhkYy0+Y3R4LT5sb2dnZXIsCisJCQkJIlBpcGU6JWQgMHgleDogYWRkciBo
aToweCV4LCAiCisJCQkJImFkZHIgbG93OjB4JXgsICIKKwkJCQkic3JjOiAlZCwgJWQsICVkLCIK
KwkJCQkiICVkOyBkc3Q6ICVkLCAlZCwgJWQsICVkO1xuIiwKKwkJCQlwaXBlX2N0eC0+cGlwZV9p
ZHgsCisJCQkJcGxhbmVfc3RhdGUsCisJCQkJcGxhbmVfc3RhdGUtPmFkZHJlc3MuZ3JwaC5hZGRy
LmhpZ2hfcGFydCwKKwkJCQlwbGFuZV9zdGF0ZS0+YWRkcmVzcy5ncnBoLmFkZHIubG93X3BhcnQs
CisJCQkJcGxhbmVfc3RhdGUtPnNyY19yZWN0LngsCisJCQkJcGxhbmVfc3RhdGUtPnNyY19yZWN0
LnksCisJCQkJcGxhbmVfc3RhdGUtPnNyY19yZWN0LndpZHRoLAorCQkJCXBsYW5lX3N0YXRlLT5z
cmNfcmVjdC5oZWlnaHQsCisJCQkJcGxhbmVfc3RhdGUtPmRzdF9yZWN0LngsCisJCQkJcGxhbmVf
c3RhdGUtPmRzdF9yZWN0LnksCisJCQkJcGxhbmVfc3RhdGUtPmRzdF9yZWN0LndpZHRoLAorCQkJ
CXBsYW5lX3N0YXRlLT5kc3RfcmVjdC5oZWlnaHQpOworCisJCURDX0xPR19EQyhkYy0+Y3R4LT5s
b2dnZXIsCisJCQkJIlBpcGUgJWQ6IHdpZHRoLCBoZWlnaHQsIHgsIHkgICAgICAgICBmb3JtYXQ6
JWRcbiIKKwkJCQkidmlld3BvcnQ6JWQsICVkLCAlZCwgJWRcbiIKKwkJCQkicmVjb3V0OiAgJWQs
ICVkLCAlZCwgJWRcbiIsCisJCQkJcGlwZV9jdHgtPnBpcGVfaWR4LAorCQkJCXBsYW5lX3N0YXRl
LT5mb3JtYXQsCisJCQkJcGlwZV9jdHgtPnBsYW5lX3Jlcy5zY2xfZGF0YS52aWV3cG9ydC53aWR0
aCwKKwkJCQlwaXBlX2N0eC0+cGxhbmVfcmVzLnNjbF9kYXRhLnZpZXdwb3J0LmhlaWdodCwKKwkJ
CQlwaXBlX2N0eC0+cGxhbmVfcmVzLnNjbF9kYXRhLnZpZXdwb3J0LngsCisJCQkJcGlwZV9jdHgt
PnBsYW5lX3Jlcy5zY2xfZGF0YS52aWV3cG9ydC55LAorCQkJCXBpcGVfY3R4LT5wbGFuZV9yZXMu
c2NsX2RhdGEucmVjb3V0LndpZHRoLAorCQkJCXBpcGVfY3R4LT5wbGFuZV9yZXMuc2NsX2RhdGEu
cmVjb3V0LmhlaWdodCwKKwkJCQlwaXBlX2N0eC0+cGxhbmVfcmVzLnNjbF9kYXRhLnJlY291dC54
LAorCQkJCXBpcGVfY3R4LT5wbGFuZV9yZXMuc2NsX2RhdGEucmVjb3V0LnkpOworCQlwcmludF9y
cV9kbGdfdHR1KGRjLCBwaXBlX2N0eCk7CisJfQorKi8KKwlpZiAoZGMtPnZtX2NvbmZpZy52YWxp
ZCkgeworCQlzdHJ1Y3Qgdm1fc3lzdGVtX2FwZXJ0dXJlX3BhcmFtIGFwdDsKKworCQlhcHQuc3lz
X2RlZmF1bHQucXVhZF9wYXJ0ID0gMDsKKwkJYXB0LnN5c19oaWdoLnF1YWRfcGFydCA9IDA7CisJ
CWFwdC5zeXNfbG93LnF1YWRfcGFydCA9IDA7CisKKwkJYXB0LnN5c19oaWdoLnF1YWRfcGFydCA9
IGRjLT52bV9jb25maWcucGFfY29uZmlnLnN5c3RlbV9hcGVydHVyZS5zdGFydF9hZGRyOworCQlh
cHQuc3lzX2xvdy5xdWFkX3BhcnQgPSBkYy0+dm1fY29uZmlnLnBhX2NvbmZpZy5zeXN0ZW1fYXBl
cnR1cmUuZW5kX2FkZHI7CisKKwkJLy8gUHJvZ3JhbSBzeXN0ZW0gYXBlcnR1cmUgc2V0dGluZ3MK
KwkJcGlwZV9jdHgtPnBsYW5lX3Jlcy5odWJwLT5mdW5jcy0+aHVicF9zZXRfdm1fc3lzdGVtX2Fw
ZXJ0dXJlX3NldHRpbmdzKHBpcGVfY3R4LT5wbGFuZV9yZXMuaHVicCwgJmFwdCk7CisJfQorCisv
LwlpZiAoZGMtPmRlYnVnLnNhbml0eV9jaGVja3MpIHsKKy8vCQlkY24xMF92ZXJpZnlfYWxsb3df
cHN0YXRlX2NoYW5nZV9oaWdoKGRjKTsKKy8vCX0KK30KKworCit2b2lkIGRjbjIwX3Byb2dyYW1f
cGlwZSgKKwkJc3RydWN0IGRjICpkYywKKwkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKKwkJ
c3RydWN0IGRjX3N0YXRlICpjb250ZXh0KQoreworCXBpcGVfY3R4LT5wbGFuZV9zdGF0ZS0+dXBk
YXRlX2ZsYWdzLmJpdHMuZnVsbF91cGRhdGUgPQorCQkJY29udGV4dC0+Y29tbWl0X2hpbnRzLmZ1
bGxfdXBkYXRlX25lZWRlZCA/IDEgOiBwaXBlX2N0eC0+cGxhbmVfc3RhdGUtPnVwZGF0ZV9mbGFn
cy5iaXRzLmZ1bGxfdXBkYXRlOworCisJaWYgKHBpcGVfY3R4LT5wbGFuZV9zdGF0ZS0+dXBkYXRl
X2ZsYWdzLmJpdHMuZnVsbF91cGRhdGUpCisJCWRjbjIwX2VuYWJsZV9wbGFuZShkYywgcGlwZV9j
dHgsIGNvbnRleHQpOworCisJdXBkYXRlX2RjaHVicF9kcHAoZGMsIHBpcGVfY3R4LCBjb250ZXh0
KTsKKworCXNldF9oZHJfbXVsdGlwbGllcihwaXBlX2N0eCk7CisKKwlpZiAocGlwZV9jdHgtPnBs
YW5lX3N0YXRlLT51cGRhdGVfZmxhZ3MuYml0cy5mdWxsX3VwZGF0ZSB8fAorCQkJcGlwZV9jdHgt
PnBsYW5lX3N0YXRlLT51cGRhdGVfZmxhZ3MuYml0cy5pbl90cmFuc2Zlcl9mdW5jX2NoYW5nZSB8
fAorCQkJcGlwZV9jdHgtPnBsYW5lX3N0YXRlLT51cGRhdGVfZmxhZ3MuYml0cy5nYW1tYV9jaGFu
Z2UpCisJCWRjLT5od3NzLnNldF9pbnB1dF90cmFuc2Zlcl9mdW5jKHBpcGVfY3R4LCBwaXBlX2N0
eC0+cGxhbmVfc3RhdGUpOworCisJLyogZGNuMTBfdHJhbnNsYXRlX3JlZ2FtbWFfdG9faHdfZm9y
bWF0IHRha2VzIDc1MHVzIHRvIGZpbmlzaAorCSAqIG9ubHkgZG8gZ2FtbWEgcHJvZ3JhbW1pbmcg
Zm9yIGZ1bGwgdXBkYXRlLgorCSAqIFRPRE86IFRoaXMgY2FuIGJlIGZ1cnRoZXIgb3B0aW1pemVk
L2NsZWFuZWQgdXAKKwkgKiBBbHdheXMgY2FsbCB0aGlzIGZvciBub3cgc2luY2UgaXQgZG9lcyBt
ZW1jbXAgaW5zaWRlIGJlZm9yZQorCSAqIGRvaW5nIGhlYXZ5IGNhbGN1bGF0aW9uIGFuZCBwcm9n
cmFtbWluZworCSAqLworCWlmIChwaXBlX2N0eC0+cGxhbmVfc3RhdGUtPnVwZGF0ZV9mbGFncy5i
aXRzLmZ1bGxfdXBkYXRlKQorCQlkYy0+aHdzcy5zZXRfb3V0cHV0X3RyYW5zZmVyX2Z1bmMocGlw
ZV9jdHgsIHBpcGVfY3R4LT5zdHJlYW0pOworfQorCitzdGF0aWMgdm9pZCBkY24yMF9wcm9ncmFt
X2FsbF9waXBlX2luX3RyZWUoCisJCXN0cnVjdCBkYyAqZGMsCisJCXN0cnVjdCBwaXBlX2N0eCAq
cGlwZV9jdHgsCisJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCkKK3sKKwlpZiAocGlwZV9jdHgt
PnRvcF9waXBlID09IE5VTEwpIHsKKwkJYm9vbCBibGFuayA9ICFpc19waXBlX3RyZWVfdmlzaWJs
ZShwaXBlX2N0eCk7CisKKwkJcGlwZV9jdHgtPnN0cmVhbV9yZXMudGctPmZ1bmNzLT5wcm9ncmFt
X2dsb2JhbF9zeW5jKAorCQkJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLAorCQkJCXBpcGVfY3R4
LT5waXBlX2RsZ19wYXJhbS52cmVhZHlfb2Zmc2V0LAorCQkJCXBpcGVfY3R4LT5waXBlX2RsZ19w
YXJhbS52c3RhcnR1cF9zdGFydCwKKwkJCQlwaXBlX2N0eC0+cGlwZV9kbGdfcGFyYW0udnVwZGF0
ZV9vZmZzZXQsCisJCQkJcGlwZV9jdHgtPnBpcGVfZGxnX3BhcmFtLnZ1cGRhdGVfd2lkdGgpOwor
CisJCWRjLT5od3NzLmJsYW5rX3BpeGVsX2RhdGEoZGMsIHBpcGVfY3R4LCBibGFuayk7CisKKwkJ
aWYgKGRjLT5od3NzLnVwZGF0ZV9vZG0pCisJCQlkYy0+aHdzcy51cGRhdGVfb2RtKGRjLCBjb250
ZXh0LCBwaXBlX2N0eCk7CisJfQorCisJaWYgKHBpcGVfY3R4LT5wbGFuZV9zdGF0ZSAhPSBOVUxM
KQorCQlkY24yMF9wcm9ncmFtX3BpcGUoZGMsIHBpcGVfY3R4LCBjb250ZXh0KTsKKworCWlmIChw
aXBlX2N0eC0+Ym90dG9tX3BpcGUgIT0gTlVMTCAmJiBwaXBlX2N0eC0+Ym90dG9tX3BpcGUgIT0g
cGlwZV9jdHgpCisJCWRjbjIwX3Byb2dyYW1fYWxsX3BpcGVfaW5fdHJlZShkYywgcGlwZV9jdHgt
PmJvdHRvbV9waXBlLCBjb250ZXh0KTsKK30KKworc3RhdGljIHZvaWQgZGNuMjBfcGlwZV9jb250
cm9sX2xvY2tfZ2xvYmFsKAorCQlzdHJ1Y3QgZGMgKmRjLAorCQlzdHJ1Y3QgcGlwZV9jdHggKnBp
cGUsCisJCWJvb2wgbG9jaykKK3sKKwlpZiAobG9jaykKKwkJcGlwZS0+c3RyZWFtX3Jlcy50Zy0+
ZnVuY3MtPmxvY2tfZ2xvYmFsKHBpcGUtPnN0cmVhbV9yZXMudGcpOworCWVsc2UKKwkJcGlwZS0+
c3RyZWFtX3Jlcy50Zy0+ZnVuY3MtPnVubG9jayhwaXBlLT5zdHJlYW1fcmVzLnRnKTsKK30KKwor
c3RhdGljIHZvaWQgZGNuMjBfcGlwZV9jb250cm9sX2xvY2soCisJc3RydWN0IGRjICpkYywKKwlz
dHJ1Y3QgcGlwZV9jdHggKnBpcGUsCisJYm9vbCBsb2NrKQoreworCWJvb2wgZmxpcF9pbW1lZGlh
dGUgPSBmYWxzZTsKKworCS8qIHVzZSBURyBtYXN0ZXIgdXBkYXRlIGxvY2sgdG8gbG9jayBldmVy
eXRoaW5nIG9uIHRoZSBURworCSAqIHRoZXJlZm9yZSBvbmx5IHRvcCBwaXBlIG5lZWQgdG8gbG9j
aworCSAqLworCWlmIChwaXBlLT50b3BfcGlwZSkKKwkJcmV0dXJuOworCisJaWYgKHBpcGUtPnBs
YW5lX3N0YXRlICE9IE5VTEwpCisJCWZsaXBfaW1tZWRpYXRlID0gcGlwZS0+cGxhbmVfc3RhdGUt
PmZsaXBfaW1tZWRpYXRlOworCisJLyogSW4gZmxpcCBpbW1lZGlhdGUgYW5kIHBpcGUgc3BsaXR0
aW5nIGNhc2UsIHdlIG5lZWQgdG8gdXNlIEdTTAorCSAqIGZvciBzeW5jaHJvbml6YXRpb24uIE9u
bHkgZG8gc2V0dXAgb24gbG9ja2luZyBhbmQgb24gZmxpcCB0eXBlIGNoYW5nZS4KKwkgKi8KKwlp
ZiAobG9jayAmJiBwaXBlLT5ib3R0b21fcGlwZSAhPSBOVUxMKQorCQlpZiAoKGZsaXBfaW1tZWRp
YXRlICYmIHBpcGUtPnN0cmVhbV9yZXMuZ3NsX2dyb3VwID09IDApIHx8CisJCSAgICAoIWZsaXBf
aW1tZWRpYXRlICYmIHBpcGUtPnN0cmVhbV9yZXMuZ3NsX2dyb3VwID4gMCkpCisJCQlkY24yMF9z
ZXR1cF9nc2xfZ3JvdXBfYXNfbG9jayhkYywgcGlwZSk7CisKKwlpZiAocGlwZS0+cGxhbmVfc3Rh
dGUgIT0gTlVMTCAmJiBwaXBlLT5wbGFuZV9zdGF0ZS0+dHJpcGxlYnVmZmVyX2ZsaXBzKSB7CisJ
CWlmIChsb2NrKQorCQkJcGlwZS0+c3RyZWFtX3Jlcy50Zy0+ZnVuY3MtPnRyaXBsZWJ1ZmZlcl9s
b2NrKHBpcGUtPnN0cmVhbV9yZXMudGcpOworCQllbHNlCisJCQlwaXBlLT5zdHJlYW1fcmVzLnRn
LT5mdW5jcy0+dHJpcGxlYnVmZmVyX3VubG9jayhwaXBlLT5zdHJlYW1fcmVzLnRnKTsKKwl9IGVs
c2UgeworCQlpZiAobG9jaykKKwkJCXBpcGUtPnN0cmVhbV9yZXMudGctPmZ1bmNzLT5sb2NrKHBp
cGUtPnN0cmVhbV9yZXMudGcpOworCQllbHNlCisJCQlwaXBlLT5zdHJlYW1fcmVzLnRnLT5mdW5j
cy0+dW5sb2NrKHBpcGUtPnN0cmVhbV9yZXMudGcpOworCX0KK30KKworCisKK3N0YXRpYyB2b2lk
IGRjbjIwX2FwcGx5X2N0eF9mb3Jfc3VyZmFjZSgKKwkJc3RydWN0IGRjICpkYywKKwkJY29uc3Qg
c3RydWN0IGRjX3N0cmVhbV9zdGF0ZSAqc3RyZWFtLAorCQlpbnQgbnVtX3BsYW5lcywKKwkJc3Ry
dWN0IGRjX3N0YXRlICpjb250ZXh0KQoreworCisJaW50IGk7CisJc3RydWN0IHRpbWluZ19nZW5l
cmF0b3IgKnRnOworCWJvb2wgcmVtb3ZlZF9waXBlWzZdID0geyBmYWxzZSB9OworCXN0cnVjdCBw
aXBlX2N0eCAqdG9wX3BpcGVfdG9fcHJvZ3JhbSA9CisJCQlmaW5kX3RvcF9waXBlX2Zvcl9zdHJl
YW0oZGMsIGNvbnRleHQsIHN0cmVhbSk7CisJRENfTE9HR0VSX0lOSVQoZGMtPmN0eC0+bG9nZ2Vy
KTsKKworCWlmICghdG9wX3BpcGVfdG9fcHJvZ3JhbSkKKwkJcmV0dXJuOworCisJdGcgPSB0b3Bf
cGlwZV90b19wcm9ncmFtLT5zdHJlYW1fcmVzLnRnOworCisJZGNuMjBfcGlwZV9jb250cm9sX2xv
Y2soZGMsIHRvcF9waXBlX3RvX3Byb2dyYW0sIHRydWUpOworCisJaWYgKG51bV9wbGFuZXMgPT0g
MCkgeworCQkvKiBPVEcgYmxhbmsgYmVmb3JlIHJlbW92ZSBhbGwgZnJvbnQgZW5kICovCisJCWRj
LT5od3NzLmJsYW5rX3BpeGVsX2RhdGEoZGMsIHRvcF9waXBlX3RvX3Byb2dyYW0sIHRydWUpOwor
CX0KKworCS8qIERpc2Nvbm5lY3QgdW51c2VkIG1wY2MgKi8KKwlmb3IgKGkgPSAwOyBpIDwgZGMt
PnJlc19wb29sLT5waXBlX2NvdW50OyBpKyspIHsKKwkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0
eCA9ICZjb250ZXh0LT5yZXNfY3R4LnBpcGVfY3R4W2ldOworCQlzdHJ1Y3QgcGlwZV9jdHggKm9s
ZF9waXBlX2N0eCA9CisJCQkJJmRjLT5jdXJyZW50X3N0YXRlLT5yZXNfY3R4LnBpcGVfY3R4W2ld
OworCQkvKgorCQkgKiBQb3dlcmdhdGUgcmV1c2VkIHBpcGVzIHRoYXQgYXJlIG5vdCBwb3dlcmdh
dGVkCisJCSAqIGZhaXJseSBoYWNreSByaWdodCBub3csIHVzaW5nIG9wcF9pZCBhcyBpbmRpY2F0
b3IKKwkJICogVE9ETzogQWZ0ZXIgbW92ZSBkY19wb3N0IHRvIGRjX3VwZGF0ZSwgdGhpcyB3aWxs
CisJCSAqIGJlIHJlbW92ZWQuCisJCSAqLworCQlpZiAocGlwZV9jdHgtPnBsYW5lX3N0YXRlICYm
ICFvbGRfcGlwZV9jdHgtPnBsYW5lX3N0YXRlKSB7CisJCQlpZiAob2xkX3BpcGVfY3R4LT5zdHJl
YW1fcmVzLnRnID09IHRnICYmCisJCQkJb2xkX3BpcGVfY3R4LT5wbGFuZV9yZXMuaHVicCAmJgor
CQkJCW9sZF9waXBlX2N0eC0+cGxhbmVfcmVzLmh1YnAtPm9wcF9pZCAhPSAweGYpIHsKKwkJCQlk
Y24yMF9kaXNhYmxlX3BsYW5lKGRjLCBvbGRfcGlwZV9jdHgpOworCisJCQkJLyoKKwkJCQkgKiBw
b3dlciBkb3duIGZlIHdpbGwgdW5sb2NrIHdoZW4gY2FsbGluZyByZXNldCwgbmVlZAorCQkJCSAq
IHRvIGxvY2sgaXQgYmFjayBoZXJlLiBNZXNzeSwgbmVlZCByZXdvcmsuCisJCQkJICovCisJCQkJ
cGlwZV9jdHgtPnN0cmVhbV9yZXMudGctPmZ1bmNzLT5sb2NrKHBpcGVfY3R4LT5zdHJlYW1fcmVz
LnRnKTsKKwkJCX0KKwkJfQorCisJCWlmICghcGlwZV9jdHgtPnBsYW5lX3N0YXRlICYmCisJCQlv
bGRfcGlwZV9jdHgtPnBsYW5lX3N0YXRlICYmCisJCQlvbGRfcGlwZV9jdHgtPnN0cmVhbV9yZXMu
dGcgPT0gdGcpIHsKKworCQkJZGMtPmh3c3MucGxhbmVfYXRvbWljX2Rpc2Nvbm5lY3QoZGMsIG9s
ZF9waXBlX2N0eCk7CisJCQlyZW1vdmVkX3BpcGVbaV0gPSB0cnVlOworCisJCQlEQ19MT0dfREMo
IlJlc2V0IG1wY2MgZm9yIHBpcGUgJWRcbiIsCisJCQkJCW9sZF9waXBlX2N0eC0+cGlwZV9pZHgp
OworCQl9CisJfQorCisJaWYgKG51bV9wbGFuZXMgPiAwKQorCQlkY24yMF9wcm9ncmFtX2FsbF9w
aXBlX2luX3RyZWUoZGMsIHRvcF9waXBlX3RvX3Byb2dyYW0sIGNvbnRleHQpOworCisJLyogUHJv
Z3JhbSBzZWNvbmRhcnkgYmxlbmRpbmcgdHJlZSBhbmQgd3JpdGViYWNrIHBpcGVzICovCisJaWYg
KChzdHJlYW0tPm51bV93Yl9pbmZvID4gMCkgJiYgKGRjLT5od3NzLnByb2dyYW1fYWxsX3dyaXRl
YmFja19waXBlc19pbl90cmVlKSkKKwkJZGMtPmh3c3MucHJvZ3JhbV9hbGxfd3JpdGViYWNrX3Bp
cGVzX2luX3RyZWUoZGMsIHN0cmVhbSwgY29udGV4dCk7CisKKwlkY24yMF9waXBlX2NvbnRyb2xf
bG9jayhkYywgdG9wX3BpcGVfdG9fcHJvZ3JhbSwgZmFsc2UpOworCisJaWYgKHRvcF9waXBlX3Rv
X3Byb2dyYW0tPnBsYW5lX3N0YXRlICYmCisJCQl0b3BfcGlwZV90b19wcm9ncmFtLT5wbGFuZV9z
dGF0ZS0+dXBkYXRlX2ZsYWdzLmJpdHMuZnVsbF91cGRhdGUpCisJCWZvciAoaSA9IDA7IGkgPCBk
Yy0+cmVzX3Bvb2wtPnBpcGVfY291bnQ7IGkrKykgeworCQkJc3RydWN0IHBpcGVfY3R4ICpwaXBl
X2N0eCA9ICZjb250ZXh0LT5yZXNfY3R4LnBpcGVfY3R4W2ldOworCisJCQkvKiBTa2lwIGluYWN0
aXZlIHBpcGVzIGFuZCBvbmVzIGFscmVhZHkgdXBkYXRlZCAqLworCQkJaWYgKCFwaXBlX2N0eC0+
c3RyZWFtIHx8IHBpcGVfY3R4LT5zdHJlYW0gPT0gc3RyZWFtCisJCQkJCXx8ICFwaXBlX2N0eC0+
cGxhbmVfc3RhdGUpCisJCQkJY29udGludWU7CisKKwkJCXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRn
LT5mdW5jcy0+bG9jayhwaXBlX2N0eC0+c3RyZWFtX3Jlcy50Zyk7CisKKwkJCXBpcGVfY3R4LT5w
bGFuZV9yZXMuaHVicC0+ZnVuY3MtPmh1YnBfc2V0dXBfaW50ZXJkZXBlbmRlbnQoCisJCQkJcGlw
ZV9jdHgtPnBsYW5lX3Jlcy5odWJwLAorCQkJCSZwaXBlX2N0eC0+ZGxnX3JlZ3MsCisJCQkJJnBp
cGVfY3R4LT50dHVfcmVncyk7CisJCX0KKworCWZvciAoaSA9IDA7IGkgPCBkYy0+cmVzX3Bvb2wt
PnBpcGVfY291bnQ7IGkrKykgeworCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4ID0gJmNvbnRl
eHQtPnJlc19jdHgucGlwZV9jdHhbaV07CisKKwkJaWYgKCFwaXBlX2N0eC0+c3RyZWFtIHx8IHBp
cGVfY3R4LT5zdHJlYW0gPT0gc3RyZWFtCisJCQkJfHwgIXBpcGVfY3R4LT5wbGFuZV9zdGF0ZSkK
KwkJCWNvbnRpbnVlOworCisJCWRjbjIwX3BpcGVfY29udHJvbF9sb2NrKGRjLCBwaXBlX2N0eCwg
ZmFsc2UpOworCX0KKworCWZvciAoaSA9IDA7IGkgPCBkYy0+cmVzX3Bvb2wtPnBpcGVfY291bnQ7
IGkrKykKKwkJaWYgKHJlbW92ZWRfcGlwZVtpXSkKKwkJCWRjbjIwX2Rpc2FibGVfcGxhbmUoZGMs
ICZkYy0+Y3VycmVudF9zdGF0ZS0+cmVzX2N0eC5waXBlX2N0eFtpXSk7Cit9CisKKwordm9pZCBk
Y24yMF9wcmVwYXJlX2JhbmR3aWR0aCgKKwkJc3RydWN0IGRjICpkYywKKwkJc3RydWN0IGRjX3N0
YXRlICpjb250ZXh0KQoreworCXN0cnVjdCBodWJidWIgKmh1YmJ1YiA9IGRjLT5yZXNfcG9vbC0+
aHViYnViOworCisJLyogcHJvZ3JhbSBkY2h1YmJ1YiB3YXRlcm1hcmtzICovCisJaHViYnViLT5m
dW5jcy0+cHJvZ3JhbV93YXRlcm1hcmtzKGh1YmJ1YiwKKwkJCQkJJmNvbnRleHQtPmJ3X2N0eC5i
dy5kY24ud2F0ZXJtYXJrcywKKwkJCQkJZGMtPnJlc19wb29sLT5yZWZfY2xvY2tzLmRjaHViX3Jl
Zl9jbG9ja19pbktoeiAvIDEwMDAsCisJCQkJCWZhbHNlKTsKKworCWRjLT5jbGtfbWdyLT5mdW5j
cy0+dXBkYXRlX2Nsb2NrcygKKwkJCWRjLT5jbGtfbWdyLAorCQkJY29udGV4dCwKKwkJCWZhbHNl
KTsKK30KKwordm9pZCBkY24yMF9vcHRpbWl6ZV9iYW5kd2lkdGgoCisJCXN0cnVjdCBkYyAqZGMs
CisJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCkKK3sKKwlzdHJ1Y3QgaHViYnViICpodWJidWIg
PSBkYy0+cmVzX3Bvb2wtPmh1YmJ1YjsKKworCS8qIHByb2dyYW0gZGNodWJidWIgd2F0ZXJtYXJr
cyAqLworCWh1YmJ1Yi0+ZnVuY3MtPnByb2dyYW1fd2F0ZXJtYXJrcyhodWJidWIsCisJCQkJCSZj
b250ZXh0LT5id19jdHguYncuZGNuLndhdGVybWFya3MsCisJCQkJCWRjLT5yZXNfcG9vbC0+cmVm
X2Nsb2Nrcy5kY2h1Yl9yZWZfY2xvY2tfaW5LaHogLyAxMDAwLAorCQkJCQl0cnVlKTsKKworCWRj
LT5jbGtfbWdyLT5mdW5jcy0+dXBkYXRlX2Nsb2NrcygKKwkJCWRjLT5jbGtfbWdyLAorCQkJY29u
dGV4dCwKKwkJCXRydWUpOworfQorCitib29sIGRjbjIwX3VwZGF0ZV9iYW5kd2lkdGgoCisJCXN0
cnVjdCBkYyAqZGMsCisJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCkKK3sKKwlpbnQgaTsKKwor
CS8qIHJlY2FsY3VsYXRlIERNTCBwYXJhbWV0ZXJzICovCisJaWYgKCFkYy0+cmVzX3Bvb2wtPmZ1
bmNzLT52YWxpZGF0ZV9iYW5kd2lkdGgoZGMsIGNvbnRleHQpKSB7CisJCXJldHVybiBmYWxzZTsK
Kwl9CisKKwkvKiBhcHBseSB1cGRhdGVkIGJhbmR3aWR0aCBwYXJhbWV0ZXJzICovCisJZGMtPmh3
c3MucHJlcGFyZV9iYW5kd2lkdGgoZGMsIGNvbnRleHQpOworCisJLyogdXBkYXRlIGh1YnAgY29u
ZmlncyBmb3IgYWxsIHBpcGVzICovCisJZm9yIChpID0gMDsgaSA8IGRjLT5yZXNfcG9vbC0+cGlw
ZV9jb3VudDsgaSsrKSB7CisJCXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHggPSAmY29udGV4dC0+
cmVzX2N0eC5waXBlX2N0eFtpXTsKKworCQlpZiAocGlwZV9jdHgtPnBsYW5lX3N0YXRlID09IE5V
TEwpCisJCQljb250aW51ZTsKKworCQlpZiAocGlwZV9jdHgtPnRvcF9waXBlID09IE5VTEwpIHsK
KwkJCWJvb2wgYmxhbmsgPSAhaXNfcGlwZV90cmVlX3Zpc2libGUocGlwZV9jdHgpOworCisJCQlw
aXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+ZnVuY3MtPnByb2dyYW1fZ2xvYmFsX3N5bmMoCisJCQkJ
CXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLAorCQkJCQlwaXBlX2N0eC0+cGlwZV9kbGdfcGFyYW0u
dnJlYWR5X29mZnNldCwKKwkJCQkJcGlwZV9jdHgtPnBpcGVfZGxnX3BhcmFtLnZzdGFydHVwX3N0
YXJ0LAorCQkJCQlwaXBlX2N0eC0+cGlwZV9kbGdfcGFyYW0udnVwZGF0ZV9vZmZzZXQsCisJCQkJ
CXBpcGVfY3R4LT5waXBlX2RsZ19wYXJhbS52dXBkYXRlX3dpZHRoKTsKKworCQkJZGMtPmh3c3Mu
YmxhbmtfcGl4ZWxfZGF0YShkYywgcGlwZV9jdHgsIGJsYW5rKTsKKwkJfQorCisJCXBpcGVfY3R4
LT5wbGFuZV9yZXMuaHVicC0+ZnVuY3MtPmh1YnBfc2V0dXAoCisJCQkJcGlwZV9jdHgtPnBsYW5l
X3Jlcy5odWJwLAorCQkJCQkmcGlwZV9jdHgtPmRsZ19yZWdzLAorCQkJCQkmcGlwZV9jdHgtPnR0
dV9yZWdzLAorCQkJCQkmcGlwZV9jdHgtPnJxX3JlZ3MsCisJCQkJCSZwaXBlX2N0eC0+cGlwZV9k
bGdfcGFyYW0pOworCX0KKworCXJldHVybiB0cnVlOworfQorCitzdGF0aWMgdm9pZCBkY24yMF9l
bmFibGVfd3JpdGViYWNrKAorCQlzdHJ1Y3QgZGMgKmRjLAorCQljb25zdCBzdHJ1Y3QgZGNfc3Ry
ZWFtX3N0YXR1cyAqc3RyZWFtX3N0YXR1cywKKwkJc3RydWN0IGRjX3dyaXRlYmFja19pbmZvICp3
Yl9pbmZvKQoreworCXN0cnVjdCBkd2JjICpkd2I7CisJc3RydWN0IG1jaWZfd2IgKm1jaWZfd2I7
CisJc3RydWN0IHRpbWluZ19nZW5lcmF0b3IgKm9wdGM7CisKKwlBU1NFUlQod2JfaW5mby0+ZHdi
X3BpcGVfaW5zdCA8IE1BWF9EV0JfUElQRVMpOworCUFTU0VSVCh3Yl9pbmZvLT53Yl9lbmFibGVk
KTsKKwlkd2IgPSBkYy0+cmVzX3Bvb2wtPmR3YmNbd2JfaW5mby0+ZHdiX3BpcGVfaW5zdF07CisJ
bWNpZl93YiA9IGRjLT5yZXNfcG9vbC0+bWNpZl93Ylt3Yl9pbmZvLT5kd2JfcGlwZV9pbnN0XTsK
KworCS8qIHNldCB0aGUgT1BUQyBzb3VyY2UgbXV4ICovCisJQVNTRVJUKHN0cmVhbV9zdGF0dXMt
PnByaW1hcnlfb3RnX2luc3QgPCBNQVhfUElQRVMpOworCW9wdGMgPSBkYy0+cmVzX3Bvb2wtPnRp
bWluZ19nZW5lcmF0b3JzW3N0cmVhbV9zdGF0dXMtPnByaW1hcnlfb3RnX2luc3RdOworCW9wdGMt
PmZ1bmNzLT5zZXRfZHdiX3NvdXJjZShvcHRjLCB3Yl9pbmZvLT5kd2JfcGlwZV9pbnN0KTsKKwkv
KiBzZXQgTUNJRl9XQiBidWZmZXIgYW5kIGFyYml0cmF0aW9uIGNvbmZpZ3VyYXRpb24gKi8KKwlt
Y2lmX3diLT5mdW5jcy0+Y29uZmlnX21jaWZfYnVmKG1jaWZfd2IsICZ3Yl9pbmZvLT5tY2lmX2J1
Zl9wYXJhbXMsIHdiX2luZm8tPmR3Yl9wYXJhbXMuZGVzdF9oZWlnaHQpOworCW1jaWZfd2ItPmZ1
bmNzLT5jb25maWdfbWNpZl9hcmIobWNpZl93YiwgJmRjLT5jdXJyZW50X3N0YXRlLT5id19jdHgu
YncuZGNuLmJ3X3dyaXRlYmFjay5tY2lmX3diX2FyYlt3Yl9pbmZvLT5kd2JfcGlwZV9pbnN0XSk7
CisJLyogRW5hYmxlIE1DSUZfV0IgKi8KKwltY2lmX3diLT5mdW5jcy0+ZW5hYmxlX21jaWYobWNp
Zl93Yik7CisJLyogRW5hYmxlIERXQiAqLworCWR3Yi0+ZnVuY3MtPmVuYWJsZShkd2IsICZ3Yl9p
bmZvLT5kd2JfcGFyYW1zKTsKKwkvKiBUT0RPOiBhZGQgc2VxdWVuY2UgdG8gZW5hYmxlL2Rpc2Fi
bGUgd2FybXVwICovCit9CisKK3ZvaWQgZGNuMjBfZGlzYWJsZV93cml0ZWJhY2soCisJCXN0cnVj
dCBkYyAqZGMsCisJCXVuc2lnbmVkIGludCBkd2JfcGlwZV9pbnN0KQoreworCXN0cnVjdCBkd2Jj
ICpkd2I7CisJc3RydWN0IG1jaWZfd2IgKm1jaWZfd2I7CisKKwlBU1NFUlQoZHdiX3BpcGVfaW5z
dCA8IE1BWF9EV0JfUElQRVMpOworCWR3YiA9IGRjLT5yZXNfcG9vbC0+ZHdiY1tkd2JfcGlwZV9p
bnN0XTsKKwltY2lmX3diID0gZGMtPnJlc19wb29sLT5tY2lmX3diW2R3Yl9waXBlX2luc3RdOwor
CisJZHdiLT5mdW5jcy0+ZGlzYWJsZShkd2IpOworCW1jaWZfd2ItPmZ1bmNzLT5kaXNhYmxlX21j
aWYobWNpZl93Yik7Cit9CisKK2Jvb2wgZGNuMjBfaHdzc193YWl0X2Zvcl9ibGFua19jb21wbGV0
ZSgKKwkJc3RydWN0IG91dHB1dF9waXhlbF9wcm9jZXNzb3IgKm9wcCkKK3sKKwlpbnQgY291bnRl
cjsKKworCWZvciAoY291bnRlciA9IDA7IGNvdW50ZXIgPCAxMDAwOyBjb3VudGVyKyspIHsKKwkJ
aWYgKG9wcC0+ZnVuY3MtPmRwZ19pc19ibGFua2VkKG9wcCkpCisJCQlicmVhazsKKworCQl1ZGVs
YXkoMTAwKTsKKwl9CisKKwlpZiAoY291bnRlciA9PSAxMDAwKSB7CisJCWRtX2Vycm9yKCJEQzog
ZmFpbGVkIHRvIGJsYW5rIGNydGMhXG4iKTsKKwkJcmV0dXJuIGZhbHNlOworCX0KKworCXJldHVy
biB0cnVlOworfQorCitib29sIGRjbjIwX2RtZGF0YV9zdGF0dXNfZG9uZShzdHJ1Y3QgcGlwZV9j
dHggKnBpcGVfY3R4KQoreworCXN0cnVjdCBodWJwICpodWJwID0gcGlwZV9jdHgtPnBsYW5lX3Jl
cy5odWJwOworCisJaWYgKCFodWJwKQorCQlyZXR1cm4gZmFsc2U7CisJcmV0dXJuIGh1YnAtPmZ1
bmNzLT5kbWRhdGFfc3RhdHVzX2RvbmUoaHVicCk7Cit9CisKK3N0YXRpYyB2b2lkIGRjbjIwX2Rp
c2FibGVfc3RyZWFtX2dhdGluZyhzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlwZV9jdHggKnBpcGVf
Y3R4KQoreworfQorCitzdGF0aWMgdm9pZCBkY24yMF9lbmFibGVfc3RyZWFtX2dhdGluZyhzdHJ1
Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KQoreworfQorCit2b2lkIGRjbjIw
X3NldF9kbWRhdGFfYXR0cmlidXRlcyhzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KQoreworCXN0
cnVjdCBkY19kbWRhdGFfYXR0cmlidXRlcyBhdHRyID0geyAwIH07CisJc3RydWN0IGh1YnAgKmh1
YnAgPSBwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnA7CisKKwlhdHRyLmRtZGF0YV9tb2RlID0gRE1E
QVRBX0hXX01PREU7CisJYXR0ci5kbWRhdGFfc2l6ZSA9CisJCWRjX2lzX2hkbWlfc2lnbmFsKHBp
cGVfY3R4LT5zdHJlYW0tPnNpZ25hbCkgPyAzMiA6IDM2OworCWF0dHIuYWRkcmVzcy5xdWFkX3Bh
cnQgPQorCQkJcGlwZV9jdHgtPnN0cmVhbS0+ZG1kYXRhX2FkZHJlc3MucXVhZF9wYXJ0OworCWF0
dHIuZG1kYXRhX2RsX2RlbHRhID0gMDsKKwlhdHRyLmRtZGF0YV9xb3NfbW9kZSA9IDA7CisJYXR0
ci5kbWRhdGFfcW9zX2xldmVsID0gMDsKKwlhdHRyLmRtZGF0YV9yZXBlYXQgPSAxOyAvKiBhbHdh
eXMgcmVwZWF0ICovCisJYXR0ci5kbWRhdGFfdXBkYXRlZCA9IDE7CisJYXR0ci5kbWRhdGFfc3df
ZGF0YSA9IE5VTEw7CisKKwlodWJwLT5mdW5jcy0+ZG1kYXRhX3NldF9hdHRyaWJ1dGVzKGh1YnAs
ICZhdHRyKTsKK30KKwordm9pZCBkY24yMF9kaXNhYmxlX3N0cmVhbShzdHJ1Y3QgcGlwZV9jdHgg
KnBpcGVfY3R4LCBpbnQgb3B0aW9uKQoreworCWRjZTExMF9kaXNhYmxlX3N0cmVhbShwaXBlX2N0
eCwgb3B0aW9uKTsKK30KKworc3RhdGljIHZvaWQgZGNuMjBfaW5pdF9kY2h1YihzdHJ1Y3QgZGNl
X2h3c2VxICpod3MsIHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBkY19hZGRyX3NwYWNlX2NvbmZpZyAq
Y29uZmlnKQoreworCXN0cnVjdCBodWJidWJfYWRkcl9jb25maWcgaHViYnViX2NvbmZpZzsKKwor
CWh1YmJ1Yl9jb25maWcucGFfY29uZmlnLnN5c3RlbV9hcGVydHVyZS5mYl90b3AgPSBjb25maWct
PnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuZmJfdG9wOworCWh1YmJ1Yl9jb25maWcucGFfY29u
ZmlnLnN5c3RlbV9hcGVydHVyZS5mYl9vZmZzZXQgPSBjb25maWctPnBhX2NvbmZpZy5zeXN0ZW1f
YXBlcnR1cmUuZmJfb2Zmc2V0OworCWh1YmJ1Yl9jb25maWcucGFfY29uZmlnLnN5c3RlbV9hcGVy
dHVyZS5mYl9iYXNlID0gY29uZmlnLT5wYV9jb25maWcuc3lzdGVtX2FwZXJ0dXJlLmZiX2Jhc2U7
CisJaHViYnViX2NvbmZpZy5wYV9jb25maWcuc3lzdGVtX2FwZXJ0dXJlLmFncF90b3AgPSBjb25m
aWctPnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuYWdwX3RvcDsKKwlodWJidWJfY29uZmlnLnBh
X2NvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuYWdwX2JvdCA9IGNvbmZpZy0+cGFfY29uZmlnLnN5c3Rl
bV9hcGVydHVyZS5hZ3BfYm90OworCWh1YmJ1Yl9jb25maWcucGFfY29uZmlnLnN5c3RlbV9hcGVy
dHVyZS5hZ3BfYmFzZSA9IGNvbmZpZy0+cGFfY29uZmlnLnN5c3RlbV9hcGVydHVyZS5hZ3BfYmFz
ZTsKKwlodWJidWJfY29uZmlnLnBhX2NvbmZpZy5nYXJ0X2NvbmZpZy5wYWdlX3RhYmxlX3N0YXJ0
X2FkZHIgPSBjb25maWctPnBhX2NvbmZpZy5nYXJ0X2NvbmZpZy5wYWdlX3RhYmxlX3N0YXJ0X2Fk
ZHI7CisJaHViYnViX2NvbmZpZy5wYV9jb25maWcuZ2FydF9jb25maWcucGFnZV90YWJsZV9lbmRf
YWRkciA9IGNvbmZpZy0+cGFfY29uZmlnLmdhcnRfY29uZmlnLnBhZ2VfdGFibGVfZW5kX2FkZHI7
CisJaHViYnViX2NvbmZpZy5wYV9jb25maWcuZ2FydF9jb25maWcucGFnZV90YWJsZV9iYXNlX2Fk
ZHIgPSBjb25maWctPnBhX2NvbmZpZy5nYXJ0X2NvbmZpZy5wYWdlX3RhYmxlX2Jhc2VfYWRkcjsK
KworCWh1YmJ1Yl9jb25maWcudmFfY29uZmlnLnBhZ2VfdGFibGVfc3RhcnRfYWRkciA9IGNvbmZp
Zy0+dmFfY29uZmlnLnBhZ2VfdGFibGVfc3RhcnRfYWRkcjsKKwlodWJidWJfY29uZmlnLnZhX2Nv
bmZpZy5wYWdlX3RhYmxlX2VuZF9hZGRyID0gY29uZmlnLT52YV9jb25maWcucGFnZV90YWJsZV9l
bmRfYWRkcjsKKwlodWJidWJfY29uZmlnLnZhX2NvbmZpZy5wYWdlX3RhYmxlX2Jsb2NrX3NpemUg
PSBjb25maWctPnZhX2NvbmZpZy5wYWdlX3RhYmxlX2Jsb2NrX3NpemVfaW5fYnl0ZXM7CisJaHVi
YnViX2NvbmZpZy52YV9jb25maWcucGFnZV90YWJsZV9kZXB0aCA9IGNvbmZpZy0+dmFfY29uZmln
LnBhZ2VfdGFibGVfZGVwdGg7CisKKwlkYy0+cmVzX3Bvb2wtPmh1YmJ1Yi0+ZnVuY3MtPmluaXRf
ZGNodWIoZGMtPnJlc19wb29sLT5odWJidWIsICZodWJidWJfY29uZmlnKTsKK30KKworc3RhdGlj
IGJvb2wgcGF0Y2hfYWRkcmVzc19mb3Jfc2JzX3RiX3N0ZXJlbygKKwkJc3RydWN0IHBpcGVfY3R4
ICpwaXBlX2N0eCwgUEhZU0lDQUxfQUREUkVTU19MT0MgKmFkZHIpCit7CisJc3RydWN0IGRjX3Bs
YW5lX3N0YXRlICpwbGFuZV9zdGF0ZSA9IHBpcGVfY3R4LT5wbGFuZV9zdGF0ZTsKKwlib29sIHNl
Y19zcGxpdCA9IHBpcGVfY3R4LT50b3BfcGlwZSAmJgorCQkJcGlwZV9jdHgtPnRvcF9waXBlLT5w
bGFuZV9zdGF0ZSA9PSBwaXBlX2N0eC0+cGxhbmVfc3RhdGU7CisJaWYgKHNlY19zcGxpdCAmJiBw
bGFuZV9zdGF0ZS0+YWRkcmVzcy50eXBlID09IFBMTl9BRERSX1RZUEVfR1JQSF9TVEVSRU8gJiYK
KwkJCShwaXBlX2N0eC0+c3RyZWFtLT50aW1pbmcudGltaW5nXzNkX2Zvcm1hdCA9PQorCQkJVElN
SU5HXzNEX0ZPUk1BVF9TSURFX0JZX1NJREUgfHwKKwkJCXBpcGVfY3R4LT5zdHJlYW0tPnRpbWlu
Zy50aW1pbmdfM2RfZm9ybWF0ID09CisJCQlUSU1JTkdfM0RfRk9STUFUX1RPUF9BTkRfQk9UVE9N
KSkgeworCQkqYWRkciA9IHBsYW5lX3N0YXRlLT5hZGRyZXNzLmdycGhfc3RlcmVvLmxlZnRfYWRk
cjsKKwkJcGxhbmVfc3RhdGUtPmFkZHJlc3MuZ3JwaF9zdGVyZW8ubGVmdF9hZGRyID0KKwkJCQlw
bGFuZV9zdGF0ZS0+YWRkcmVzcy5ncnBoX3N0ZXJlby5yaWdodF9hZGRyOworCQlyZXR1cm4gdHJ1
ZTsKKwl9CisKKwlpZiAocGlwZV9jdHgtPnN0cmVhbS0+dmlld19mb3JtYXQgIT0gVklFV18zRF9G
T1JNQVRfTk9ORSAmJgorCQkJcGxhbmVfc3RhdGUtPmFkZHJlc3MudHlwZSAhPSBQTE5fQUREUl9U
WVBFX0dSUEhfU1RFUkVPKSB7CisJCXBsYW5lX3N0YXRlLT5hZGRyZXNzLnR5cGUgPSBQTE5fQURE
Ul9UWVBFX0dSUEhfU1RFUkVPOworCQlwbGFuZV9zdGF0ZS0+YWRkcmVzcy5ncnBoX3N0ZXJlby5y
aWdodF9hZGRyID0KKwkJCQlwbGFuZV9zdGF0ZS0+YWRkcmVzcy5ncnBoX3N0ZXJlby5sZWZ0X2Fk
ZHI7CisJfQorCXJldHVybiBmYWxzZTsKK30KKworCitzdGF0aWMgdm9pZCBkY24yMF91cGRhdGVf
cGxhbmVfYWRkcihjb25zdCBzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4
KQoreworCWJvb2wgYWRkcl9wYXRjaGVkID0gZmFsc2U7CisJUEhZU0lDQUxfQUREUkVTU19MT0Mg
YWRkcjsKKwlzdHJ1Y3QgZGNfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlID0gcGlwZV9jdHgtPnBs
YW5lX3N0YXRlOworCXVpbnQ4X3Qgdm1pZDsKKworCWlmIChwbGFuZV9zdGF0ZSA9PSBOVUxMKQor
CQlyZXR1cm47CisKKwlhZGRyX3BhdGNoZWQgPSBwYXRjaF9hZGRyZXNzX2Zvcl9zYnNfdGJfc3Rl
cmVvKHBpcGVfY3R4LCAmYWRkcik7CisKKwkvLyBDYWxsIEhlbHBlciB0byBhc3NpZ24gY29ycmVj
dCBWTUlEIHRvIHRoaXMgUFRCCisJdm1pZCA9IGdldF92bWlkX2Zvcl9wdGIoZGMtPnZtX2hlbHBl
ciwKKwkJCXBsYW5lX3N0YXRlLT5hZGRyZXNzLnBhZ2VfdGFibGVfYmFzZS5xdWFkX3BhcnQsCisJ
CQlwaXBlX2N0eC0+cGlwZV9pZHgpOworCisJLy8gQ2FsbCBodWJidWIgdG8gcHJvZ3JhbSBQVEIg
b2YgVk1JRAorCWlmIChkYy0+cmVzX3Bvb2wtPmh1YmJ1Yi0+ZnVuY3MtPnNldHVwX3ZtaWRfcHRi
KQorCQlkYy0+cmVzX3Bvb2wtPmh1YmJ1Yi0+ZnVuY3MtPnNldHVwX3ZtaWRfcHRiKGRjLT5yZXNf
cG9vbC0+aHViYnViLAorCQkJCXBsYW5lX3N0YXRlLT5hZGRyZXNzLnBhZ2VfdGFibGVfYmFzZS5x
dWFkX3BhcnQsCisJCQkJdm1pZCk7CisKKwlwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnAtPmZ1bmNz
LT5odWJwX3Byb2dyYW1fc3VyZmFjZV9mbGlwX2FuZF9hZGRyKAorCQkJcGlwZV9jdHgtPnBsYW5l
X3Jlcy5odWJwLAorCQkJJnBsYW5lX3N0YXRlLT5hZGRyZXNzLAorCQkJcGxhbmVfc3RhdGUtPmZs
aXBfaW1tZWRpYXRlLAorCQkJdm1pZCk7CisKKwlwbGFuZV9zdGF0ZS0+c3RhdHVzLnJlcXVlc3Rl
ZF9hZGRyZXNzID0gcGxhbmVfc3RhdGUtPmFkZHJlc3M7CisKKwlpZiAocGxhbmVfc3RhdGUtPmZs
aXBfaW1tZWRpYXRlKQorCQlwbGFuZV9zdGF0ZS0+c3RhdHVzLmN1cnJlbnRfYWRkcmVzcyA9IHBs
YW5lX3N0YXRlLT5hZGRyZXNzOworCisJaWYgKGFkZHJfcGF0Y2hlZCkKKwkJcGlwZV9jdHgtPnBs
YW5lX3N0YXRlLT5hZGRyZXNzLmdycGhfc3RlcmVvLmxlZnRfYWRkciA9IGFkZHI7Cit9CisKK3Zv
aWQgZGNuMjBfdW5ibGFua19zdHJlYW0oc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwKKwkJc3Ry
dWN0IGRjX2xpbmtfc2V0dGluZ3MgKmxpbmtfc2V0dGluZ3MpCit7CisJc3RydWN0IGVuY29kZXJf
dW5ibGFua19wYXJhbSBwYXJhbXMgPSB7IHsgMCB9IH07CisJc3RydWN0IGRjX3N0cmVhbV9zdGF0
ZSAqc3RyZWFtID0gcGlwZV9jdHgtPnN0cmVhbTsKKwlzdHJ1Y3QgZGNfbGluayAqbGluayA9IHN0
cmVhbS0+bGluazsKKwlwYXJhbXMub2RtID0gZGNfcmVzX2dldF9vZG1fYm90dG9tX3BpcGUocGlw
ZV9jdHgpOworCisJLyogb25seSAzIGl0ZW1zIGJlbG93IGFyZSB1c2VkIGJ5IHVuYmxhbmsgKi8K
KwlwYXJhbXMudGltaW5nID0gcGlwZV9jdHgtPnN0cmVhbS0+dGltaW5nOworCisJcGFyYW1zLmxp
bmtfc2V0dGluZ3MubGlua19yYXRlID0gbGlua19zZXR0aW5ncy0+bGlua19yYXRlOworCisJaWYg
KGRjX2lzX2RwX3NpZ25hbChwaXBlX2N0eC0+c3RyZWFtLT5zaWduYWwpKSB7CisJCWlmIChvcHRj
MV9pc190d29fcGl4ZWxzX3Blcl9jb250YWludGVyKCZzdHJlYW0tPnRpbWluZykgfHwgcGFyYW1z
Lm9kbSkKKwkJCXBhcmFtcy50aW1pbmcucGl4X2Nsa18xMDBoeiAvPSAyOworCQlwaXBlX2N0eC0+
c3RyZWFtX3Jlcy5zdHJlYW1fZW5jLT5mdW5jcy0+ZHBfc2V0X29kbV9jb21iaW5lKAorCQkJCXBp
cGVfY3R4LT5zdHJlYW1fcmVzLnN0cmVhbV9lbmMsIHBhcmFtcy5vZG0pOworCQlwaXBlX2N0eC0+
c3RyZWFtX3Jlcy5zdHJlYW1fZW5jLT5mdW5jcy0+ZHBfdW5ibGFuayhwaXBlX2N0eC0+c3RyZWFt
X3Jlcy5zdHJlYW1fZW5jLCAmcGFyYW1zKTsKKwl9CisKKwlpZiAobGluay0+bG9jYWxfc2luayAm
JiBsaW5rLT5sb2NhbF9zaW5rLT5zaW5rX3NpZ25hbCA9PSBTSUdOQUxfVFlQRV9FRFApIHsKKwkJ
bGluay0+ZGMtPmh3c3MuZWRwX2JhY2tsaWdodF9jb250cm9sKGxpbmssIHRydWUpOworCX0KK30K
Kwordm9pZCBkY24yMF9zZXR1cF92dXBkYXRlX2ludGVycnVwdChzdHJ1Y3QgcGlwZV9jdHggKnBp
cGVfY3R4KQoreworCXN0cnVjdCB0aW1pbmdfZ2VuZXJhdG9yICp0ZyA9IHBpcGVfY3R4LT5zdHJl
YW1fcmVzLnRnOworCWludCBzdGFydF9wb3NpdGlvbiA9IGdldF92dXBkYXRlX29mZnNldF9mcm9t
X3ZzeW5jKHBpcGVfY3R4KTsKKwl1aW50MzJfdCBzdGFydF9saW5lOworCisJaWYgKHN0YXJ0X3Bv
c2l0aW9uIDwgMCkKKwkJc3RhcnRfbGluZSA9IHBpcGVfY3R4LT5zdHJlYW0tPnRpbWluZy52X3Rv
dGFsICsgc3RhcnRfcG9zaXRpb24gLSAxOworCWVsc2UKKwkJc3RhcnRfbGluZSA9IHN0YXJ0X3Bv
c2l0aW9uOworCisJaWYgKHRnLT5mdW5jcy0+c2V0dXBfdmVydGljYWxfaW50ZXJydXB0MikKKwkJ
dGctPmZ1bmNzLT5zZXR1cF92ZXJ0aWNhbF9pbnRlcnJ1cHQyKHRnLCBzdGFydF9saW5lKTsKK30K
Kworc3RhdGljIHZvaWQgZGNuMjBfcmVzZXRfYmFja19lbmRfZm9yX3BpcGUoCisJCXN0cnVjdCBk
YyAqZGMsCisJCXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsCisJCXN0cnVjdCBkY19zdGF0ZSAq
Y29udGV4dCkKK3sKKwlpbnQgaTsKKwlEQ19MT0dHRVJfSU5JVChkYy0+Y3R4LT5sb2dnZXIpOwor
CWlmIChwaXBlX2N0eC0+c3RyZWFtX3Jlcy5zdHJlYW1fZW5jID09IE5VTEwpIHsKKwkJcGlwZV9j
dHgtPnN0cmVhbSA9IE5VTEw7CisJCXJldHVybjsKKwl9CisKKwlpZiAoIUlTX0ZQR0FfTUFYSU1V
U19EQyhkYy0+Y3R4LT5kY2VfZW52aXJvbm1lbnQpKSB7CisJCS8qIERQTVMgbWF5IGFscmVhZHkg
ZGlzYWJsZSAqLworCQlpZiAoIXBpcGVfY3R4LT5zdHJlYW0tPmRwbXNfb2ZmKQorCQkJY29yZV9s
aW5rX2Rpc2FibGVfc3RyZWFtKHBpcGVfY3R4LCBGUkVFX0FDUVVJUkVEX1JFU09VUkNFKTsKKwkJ
ZWxzZSBpZiAocGlwZV9jdHgtPnN0cmVhbV9yZXMuYXVkaW8pIHsKKwkJCWRjLT5od3NzLmRpc2Fi
bGVfYXVkaW9fc3RyZWFtKHBpcGVfY3R4LCBGUkVFX0FDUVVJUkVEX1JFU09VUkNFKTsKKwkJfQor
CisJfQorCisJLyogYnkgdXBwZXIgY2FsbGVyIGxvb3AsIHBhcmVudCBwaXBlOiBwaXBlMCwgd2ls
bCBiZSByZXNldCBsYXN0LgorCSAqIGJhY2sgZW5kIHNoYXJlIGJ5IGFsbCBwaXBlcyBhbmQgd2ls
bCBiZSBkaXNhYmxlIG9ubHkgd2hlbiBkaXNhYmxlCisJICogcGFyZW50IHBpcGUuCisJICovCisJ
aWYgKHBpcGVfY3R4LT50b3BfcGlwZSA9PSBOVUxMKSB7CisJCXBpcGVfY3R4LT5zdHJlYW1fcmVz
LnRnLT5mdW5jcy0+ZGlzYWJsZV9jcnRjKHBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnKTsKKworCQlw
aXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+ZnVuY3MtPmVuYWJsZV9vcHRjX2Nsb2NrKHBpcGVfY3R4
LT5zdHJlYW1fcmVzLnRnLCBmYWxzZSk7CisJCWlmIChwaXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+
ZnVuY3MtPnNldF9vZG1fYnlwYXNzKQorCQkJcGlwZV9jdHgtPnN0cmVhbV9yZXMudGctPmZ1bmNz
LT5zZXRfb2RtX2J5cGFzcygKKwkJCQkJcGlwZV9jdHgtPnN0cmVhbV9yZXMudGcsICZwaXBlX2N0
eC0+c3RyZWFtLT50aW1pbmcpOworCX0KKworCWZvciAoaSA9IDA7IGkgPCBkYy0+cmVzX3Bvb2wt
PnBpcGVfY291bnQ7IGkrKykKKwkJaWYgKCZkYy0+Y3VycmVudF9zdGF0ZS0+cmVzX2N0eC5waXBl
X2N0eFtpXSA9PSBwaXBlX2N0eCkKKwkJCWJyZWFrOworCisJaWYgKGkgPT0gZGMtPnJlc19wb29s
LT5waXBlX2NvdW50KQorCQlyZXR1cm47CisKKwlwaXBlX2N0eC0+c3RyZWFtID0gTlVMTDsKKwlE
Q19MT0dfREVCVUcoIlJlc2V0IGJhY2sgZW5kIGZvciBwaXBlICVkLCB0ZzolZFxuIiwKKwkJCQkJ
cGlwZV9jdHgtPnBpcGVfaWR4LCBwaXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+aW5zdCk7Cit9CisK
K3N0YXRpYyB2b2lkIGRjbjIwX3Jlc2V0X2h3X2N0eF93cmFwKAorCQlzdHJ1Y3QgZGMgKmRjLAor
CQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpCit7CisJaW50IGk7CisKKwkvKiBSZXNldCBCYWNr
IEVuZCovCisJZm9yIChpID0gZGMtPnJlc19wb29sLT5waXBlX2NvdW50IC0gMTsgaSA+PSAwIDsg
aS0tKSB7CisJCXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHhfb2xkID0KKwkJCSZkYy0+Y3VycmVu
dF9zdGF0ZS0+cmVzX2N0eC5waXBlX2N0eFtpXTsKKwkJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0
eCA9ICZjb250ZXh0LT5yZXNfY3R4LnBpcGVfY3R4W2ldOworCisJCWlmICghcGlwZV9jdHhfb2xk
LT5zdHJlYW0pCisJCQljb250aW51ZTsKKworCQlpZiAocGlwZV9jdHhfb2xkLT50b3BfcGlwZSkK
KwkJCWNvbnRpbnVlOworCisJCWlmICghcGlwZV9jdHgtPnN0cmVhbSB8fAorCQkJCXBpcGVfbmVl
ZF9yZXByb2dyYW0ocGlwZV9jdHhfb2xkLCBwaXBlX2N0eCkpIHsKKwkJCXN0cnVjdCBjbG9ja19z
b3VyY2UgKm9sZF9jbGsgPSBwaXBlX2N0eF9vbGQtPmNsb2NrX3NvdXJjZTsKKworCQkJZGNuMjBf
cmVzZXRfYmFja19lbmRfZm9yX3BpcGUoZGMsIHBpcGVfY3R4X29sZCwgZGMtPmN1cnJlbnRfc3Rh
dGUpOworCQkJaWYgKGRjLT5od3NzLmVuYWJsZV9zdHJlYW1fZ2F0aW5nKQorCQkJCWRjLT5od3Nz
LmVuYWJsZV9zdHJlYW1fZ2F0aW5nKGRjLCBwaXBlX2N0eCk7CisJCQlpZiAob2xkX2NsaykKKwkJ
CQlvbGRfY2xrLT5mdW5jcy0+Y3NfcG93ZXJfZG93bihvbGRfY2xrKTsKKwkJfQorCX0KK30KKwor
c3RhdGljIHZvaWQgZGNuMjBfdXBkYXRlX21wY2Moc3RydWN0IGRjICpkYywgc3RydWN0IHBpcGVf
Y3R4ICpwaXBlX2N0eCkKK3sKKwlzdHJ1Y3QgaHVicCAqaHVicCA9IHBpcGVfY3R4LT5wbGFuZV9y
ZXMuaHVicDsKKwlzdHJ1Y3QgbXBjY19ibG5kX2NmZyBibG5kX2NmZyA9IHsgezB9IH07CisJYm9v
bCBwZXJfcGl4ZWxfYWxwaGEgPSBwaXBlX2N0eC0+cGxhbmVfc3RhdGUtPnBlcl9waXhlbF9hbHBo
YSAmJiBwaXBlX2N0eC0+Ym90dG9tX3BpcGU7CisJaW50IG1wY2NfaWQ7CisJc3RydWN0IG1wY2Mg
Km5ld19tcGNjOworCXN0cnVjdCBtcGMgKm1wYyA9IGRjLT5yZXNfcG9vbC0+bXBjOworCXN0cnVj
dCBtcGNfdHJlZSAqbXBjX3RyZWVfcGFyYW1zID0gJihwaXBlX2N0eC0+c3RyZWFtX3Jlcy5vcHAt
Pm1wY190cmVlX3BhcmFtcyk7CisKKwkvLyBpbnB1dCB0byBNUENDIGlzIGFsd2F5cyBSR0IsIGJ5
IGRlZmF1bHQgbGVhdmUgYmxhY2tfY29sb3IgYXQgMAorCWlmIChkYy0+ZGVidWcudmlzdWFsX2Nv
bmZpcm0gPT0gVklTVUFMX0NPTkZJUk1fSERSKSB7CisJCWRjbjEwX2dldF9oZHJfdmlzdWFsX2Nv
bmZpcm1fY29sb3IoCisJCQkJcGlwZV9jdHgsICZibG5kX2NmZy5ibGFja19jb2xvcik7CisJfSBl
bHNlIGlmIChkYy0+ZGVidWcudmlzdWFsX2NvbmZpcm0gPT0gVklTVUFMX0NPTkZJUk1fU1VSRkFD
RSkgeworCQlkY24xMF9nZXRfc3VyZmFjZV92aXN1YWxfY29uZmlybV9jb2xvcigKKwkJCQlwaXBl
X2N0eCwgJmJsbmRfY2ZnLmJsYWNrX2NvbG9yKTsKKwl9CisKKwlpZiAocGVyX3BpeGVsX2FscGhh
KQorCQlibG5kX2NmZy5hbHBoYV9tb2RlID0gTVBDQ19BTFBIQV9CTEVORF9NT0RFX1BFUl9QSVhF
TF9BTFBIQTsKKwllbHNlCisJCWJsbmRfY2ZnLmFscGhhX21vZGUgPSBNUENDX0FMUEhBX0JMRU5E
X01PREVfR0xPQkFMX0FMUEhBOworCisJYmxuZF9jZmcub3ZlcmxhcF9vbmx5ID0gZmFsc2U7CisJ
YmxuZF9jZmcuZ2xvYmFsX2dhaW4gPSAweGZmOworCisJaWYgKHBpcGVfY3R4LT5wbGFuZV9zdGF0
ZS0+Z2xvYmFsX2FscGhhKQorCQlibG5kX2NmZy5nbG9iYWxfYWxwaGEgPSBwaXBlX2N0eC0+cGxh
bmVfc3RhdGUtPmdsb2JhbF9hbHBoYV92YWx1ZTsKKwllbHNlCisJCWJsbmRfY2ZnLmdsb2JhbF9h
bHBoYSA9IDB4ZmY7CisKKwlibG5kX2NmZy5iYWNrZ3JvdW5kX2NvbG9yX2JwYyA9IDQ7CisJYmxu
ZF9jZmcuYm90dG9tX2dhaW5fbW9kZSA9IDA7CisJYmxuZF9jZmcudG9wX2dhaW4gPSAweDFmMDAw
OworCWJsbmRfY2ZnLmJvdHRvbV9pbnNpZGVfZ2FpbiA9IDB4MWYwMDA7CisJYmxuZF9jZmcuYm90
dG9tX291dHNpZGVfZ2FpbiA9IDB4MWYwMDA7CisJYmxuZF9jZmcucHJlX211bHRpcGxpZWRfYWxw
aGEgPSBwZXJfcGl4ZWxfYWxwaGE7CisKKwkvKgorCSAqIFRPRE86IHJlbW92ZSBoYWNrCisJICog
Tm90ZTogY3VycmVudGx5IHRoZXJlIGlzIGEgYnVnIGluIGluaXRfaHcgc3VjaCB0aGF0CisJICog
b24gcmVzdW1lIGZyb20gaGliZXJuYXRlLCBCSU9TIHNldHMgdXAgTVBDQzAsIGFuZAorCSAqIHdl
IGRvIG1wY2NfcmVtb3ZlIGJ1dCB0aGUgbXBjYyBjYW5ub3QgZ28gdG8gaWRsZQorCSAqIGFmdGVy
IHJlbW92ZS4gVGhpcyBjYXVzZSB1cyB0byBwaWNrIG1wY2MxIGhlcmUsCisJICogd2hpY2ggY2F1
c2VzIGEgcHN0YXRlIGhhbmcgZm9yIHlldCB1bmtub3duIHJlYXNvbi4KKwkgKi8KKwltcGNjX2lk
ID0gaHVicC0+aW5zdDsKKworCS8qIElmIHRoZXJlIGlzIG5vIGZ1bGwgdXBkYXRlLCBkb24ndCBu
ZWVkIHRvIHRvdWNoIE1QQyB0cmVlKi8KKwlpZiAoIXBpcGVfY3R4LT5wbGFuZV9zdGF0ZS0+dXBk
YXRlX2ZsYWdzLmJpdHMuZnVsbF91cGRhdGUpIHsKKwkJbXBjLT5mdW5jcy0+dXBkYXRlX2JsZW5k
aW5nKG1wYywgJmJsbmRfY2ZnLCBtcGNjX2lkKTsKKwkJcmV0dXJuOworCX0KKworCS8qIGNoZWNr
IGlmIHRoaXMgTVBDQyBpcyBhbHJlYWR5IGJlaW5nIHVzZWQgKi8KKwluZXdfbXBjYyA9IG1wYy0+
ZnVuY3MtPmdldF9tcGNjX2Zvcl9kcHAobXBjX3RyZWVfcGFyYW1zLCBtcGNjX2lkKTsKKwkvKiBy
ZW1vdmUgTVBDQyBpZiBiZWluZyB1c2VkICovCisJaWYgKG5ld19tcGNjICE9IE5VTEwpCisJCW1w
Yy0+ZnVuY3MtPnJlbW92ZV9tcGNjKG1wYywgbXBjX3RyZWVfcGFyYW1zLCBuZXdfbXBjYyk7CisJ
ZWxzZQorCQlpZiAoZGMtPmRlYnVnLnNhbml0eV9jaGVja3MpCisJCQltcGMtPmZ1bmNzLT5hc3Nl
cnRfbXBjY19pZGxlX2JlZm9yZV9jb25uZWN0KAorCQkJCQlkYy0+cmVzX3Bvb2wtPm1wYywgbXBj
Y19pZCk7CisKKwkvKiBDYWxsIE1QQyB0byBpbnNlcnQgbmV3IHBsYW5lICovCisJbmV3X21wY2Mg
PSBtcGMtPmZ1bmNzLT5pbnNlcnRfcGxhbmUoZGMtPnJlc19wb29sLT5tcGMsCisJCQltcGNfdHJl
ZV9wYXJhbXMsCisJCQkmYmxuZF9jZmcsCisJCQlOVUxMLAorCQkJTlVMTCwKKwkJCWh1YnAtPmlu
c3QsCisJCQltcGNjX2lkKTsKKworCUFTU0VSVChuZXdfbXBjYyAhPSBOVUxMKTsKKwlodWJwLT5v
cHBfaWQgPSBwaXBlX2N0eC0+c3RyZWFtX3Jlcy5vcHAtPmluc3Q7CisJaHVicC0+bXBjY19pZCA9
IG1wY2NfaWQ7Cit9CisKK3N0YXRpYyBpbnQgZmluZF9mcmVlX2dzbF9ncm91cChjb25zdCBzdHJ1
Y3QgZGMgKmRjKQoreworCWlmIChkYy0+cmVzX3Bvb2wtPmdzbF9ncm91cHMuZ3NsXzAgPT0gMCkK
KwkJcmV0dXJuIDE7CisJaWYgKGRjLT5yZXNfcG9vbC0+Z3NsX2dyb3Vwcy5nc2xfMSA9PSAwKQor
CQlyZXR1cm4gMjsKKwlpZiAoZGMtPnJlc19wb29sLT5nc2xfZ3JvdXBzLmdzbF8yID09IDApCisJ
CXJldHVybiAzOworCisJcmV0dXJuIDA7Cit9CisKKy8qIE5PVEU6IFRoaXMgaXMgbm90IGEgZ2Vu
ZXJpYyBzZXR1cF9nc2wgZnVuY3Rpb24gKGhlbmNlIHRoZSBzdWZmaXggYXNfbG9jaykKKyAqIFRo
aXMgaXMgb25seSB1c2VkIHRvIGxvY2sgcGlwZXMgaW4gcGlwZSBzcGxpdHRpbmcgY2FzZSB3aXRo
IGltbWVkaWF0ZSBmbGlwCisgKiBPcmRpbmFyeSBNUEMvT1RHIGxvY2tzIHN1cHByZXNzIFZVUERB
VEUgd2hpY2ggZG9lc24ndCBoZWxwIHdpdGggaW1tZWRpYXRlLAorICogc28gd2UgZ2V0IHRlYXJp
bmcgd2l0aCBmcmVlc3luYyBzaW5jZSB3ZSBjYW5ub3QgZmxpcCBtdWx0aXBsZSBwaXBlcworICog
YXRvbWljYWxseS4KKyAqIFdlIHVzZSBHU0wgZm9yIHRoaXM6CisgKiAtIGltbWVkaWF0ZSBmbGlw
OiBmaW5kIGZpcnN0IGF2YWlsYWJsZSBHU0wgZ3JvdXAgaWYgbm90IGFscmVhZHkgYXNzaWduZWQK
KyAqICAgICAgICAgICAgICAgICAgIHByb2dyYW0gZ3NsIHdpdGggdGhhdCBncm91cCwgc2V0IGN1
cnJlbnQgT1RHIGFzIG1hc3RlcgorICogICAgICAgICAgICAgICAgICAgYW5kIGFsd2F5cyB1cyAw
eDQgPSBBTkQgb2YgZmxpcF9yZWFkeSBmcm9tIGFsbCBwaXBlcworICogLSB2c3luYyBmbGlwOiBk
aXNhYmxlIEdTTCBpZiB1c2VkCisgKgorICogR3JvdXBzIGluIHN0cmVhbV9yZXMgYXJlIHN0b3Jl
ZCBhcyArMSBmcm9tIEhXIHJlZ2lzdGVycywgaS5lLgorICogZ3NsXzAgPD0+IHBpcGVfY3R4LT5z
dHJlYW1fcmVzLmdzbF9ncm91cCA9PSAxCisgKiBVc2luZyBhIG1hZ2ljIHZhbHVlIGxpa2UgLTEg
d291bGQgcmVxdWlyZSB0cmFja2luZyBhbGwgaW5pdHMvcmVzZXRzCisgKi8KK3ZvaWQgZGNuMjBf
c2V0dXBfZ3NsX2dyb3VwX2FzX2xvY2soCisJCWNvbnN0IHN0cnVjdCBkYyAqZGMsCisJCXN0cnVj
dCBwaXBlX2N0eCAqcGlwZV9jdHgpCit7CisJc3RydWN0IGdzbF9wYXJhbXMgZ3NsOworCWludCBn
cm91cF9pZHg7CisKKwltZW1zZXQoJmdzbCwgMCwgc2l6ZW9mKHN0cnVjdCBnc2xfcGFyYW1zKSk7
CisKKwlpZiAocGlwZV9jdHgtPnBsYW5lX3N0YXRlLT5mbGlwX2ltbWVkaWF0ZSkgeworCQkvKiBy
ZXR1cm4gaWYgZ3JvdXAgYWxyZWFkeSBhc3NpZ25lZCBzaW5jZSBHU0wgd2FzIHNldCB1cAorCQkg
KiBmb3IgdnN5bmMgZmxpcCwgd2Ugd291bGQgdW5hc3NpZ24gc28gaXQgY2FuJ3QgYmUgImxlZnQg
b3ZlciIKKwkJICovCisJCWlmIChwaXBlX2N0eC0+c3RyZWFtX3Jlcy5nc2xfZ3JvdXAgPiAwKQor
CQkJcmV0dXJuOworCisJCWdyb3VwX2lkeCA9IGZpbmRfZnJlZV9nc2xfZ3JvdXAoZGMpOworCQlB
U1NFUlQoZ3JvdXBfaWR4ICE9IDApOworCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy5nc2xfZ3JvdXAg
PSBncm91cF9pZHg7CisKKwkJLyogc2V0IGdzbCBncm91cCByZWcgZmllbGQgYW5kIG1hcmsgcmVz
b3VyY2UgdXNlZCAqLworCQlzd2l0Y2ggKGdyb3VwX2lkeCkgeworCQljYXNlIDE6CisJCQlnc2wu
Z3NsMF9lbiA9IDE7CisJCQlkYy0+cmVzX3Bvb2wtPmdzbF9ncm91cHMuZ3NsXzAgPSAxOworCQkJ
YnJlYWs7CisJCWNhc2UgMjoKKwkJCWdzbC5nc2wxX2VuID0gMTsKKwkJCWRjLT5yZXNfcG9vbC0+
Z3NsX2dyb3Vwcy5nc2xfMSA9IDE7CisJCQlicmVhazsKKwkJY2FzZSAzOgorCQkJZ3NsLmdzbDJf
ZW4gPSAxOworCQkJZGMtPnJlc19wb29sLT5nc2xfZ3JvdXBzLmdzbF8yID0gMTsKKwkJCWJyZWFr
OworCQlkZWZhdWx0OgorCQkJQlJFQUtfVE9fREVCVUdHRVIoKTsKKwkJCXJldHVybjsgLy8gaW52
YWxpZCBjYXNlCisJCX0KKwkJZ3NsLmdzbF9tYXN0ZXJfZW4gPSAxOworCX0gZWxzZSB7CisJCWdy
b3VwX2lkeCA9IHBpcGVfY3R4LT5zdHJlYW1fcmVzLmdzbF9ncm91cDsKKwkJaWYgKGdyb3VwX2lk
eCA9PSAwKQorCQkJcmV0dXJuOyAvLyBpZiBub3QgaW4gdXNlLCBqdXN0IHJldHVybgorCisJCXBp
cGVfY3R4LT5zdHJlYW1fcmVzLmdzbF9ncm91cCA9IDA7CisKKwkJLyogdW5zZXQgZ3NsIGdyb3Vw
IHJlZyBmaWVsZCBhbmQgbWFyayByZXNvdXJjZSBmcmVlICovCisJCXN3aXRjaCAoZ3JvdXBfaWR4
KSB7CisJCWNhc2UgMToKKwkJCWdzbC5nc2wwX2VuID0gMDsKKwkJCWRjLT5yZXNfcG9vbC0+Z3Ns
X2dyb3Vwcy5nc2xfMCA9IDA7CisJCQlicmVhazsKKwkJY2FzZSAyOgorCQkJZ3NsLmdzbDFfZW4g
PSAwOworCQkJZGMtPnJlc19wb29sLT5nc2xfZ3JvdXBzLmdzbF8xID0gMDsKKwkJCWJyZWFrOwor
CQljYXNlIDM6CisJCQlnc2wuZ3NsMl9lbiA9IDA7CisJCQlkYy0+cmVzX3Bvb2wtPmdzbF9ncm91
cHMuZ3NsXzIgPSAwOworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlCUkVBS19UT19ERUJVR0dF
UigpOworCQkJcmV0dXJuOworCQl9CisJCWdzbC5nc2xfbWFzdGVyX2VuID0gMDsKKwl9CisKKwkv
KiBhdCB0aGlzIHBvaW50IHdlIHdhbnQgdG8gcHJvZ3JhbSB3aGV0aGVyIGl0J3MgdG8gZW5hYmxl
IG9yIGRpc2FibGUgKi8KKwlpZiAocGlwZV9jdHgtPnN0cmVhbV9yZXMudGctPmZ1bmNzLT5zZXRf
Z3NsICE9IE5VTEwgJiYKKwkJcGlwZV9jdHgtPnN0cmVhbV9yZXMudGctPmZ1bmNzLT5zZXRfZ3Ns
X3NvdXJjZV9zZWxlY3QgIT0gTlVMTCkgeworCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy50Zy0+ZnVu
Y3MtPnNldF9nc2woCisJCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy50ZywKKwkJCSZnc2wpOworCisJ
CXBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLT5mdW5jcy0+c2V0X2dzbF9zb3VyY2Vfc2VsZWN0KAor
CQkJcGlwZV9jdHgtPnN0cmVhbV9yZXMudGcsIGdyb3VwX2lkeCwKKwkJCXBpcGVfY3R4LT5wbGFu
ZV9zdGF0ZS0+ZmxpcF9pbW1lZGlhdGUgPyA0IDogMCk7CisJfSBlbHNlCisJCUJSRUFLX1RPX0RF
QlVHR0VSKCk7Cit9CisKK3N0YXRpYyB2b2lkIGRjbjIwX3NldF9mbGlwX2NvbnRyb2xfZ3NsKAor
CQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAorCQlib29sIGZsaXBfaW1tZWRpYXRlKQorewor
CWlmIChwaXBlX2N0eCAmJiBwaXBlX2N0eC0+cGxhbmVfcmVzLmh1YnAtPmZ1bmNzLT5odWJwX3Nl
dF9mbGlwX2NvbnRyb2xfc3VyZmFjZV9nc2wpCisJCXBpcGVfY3R4LT5wbGFuZV9yZXMuaHVicC0+
ZnVuY3MtPmh1YnBfc2V0X2ZsaXBfY29udHJvbF9zdXJmYWNlX2dzbCgKKwkJCQlwaXBlX2N0eC0+
cGxhbmVfcmVzLmh1YnAsIGZsaXBfaW1tZWRpYXRlKTsKKworfQorCit2b2lkIGRjbjIwX2h3X3Nl
cXVlbmNlcl9jb25zdHJ1Y3Qoc3RydWN0IGRjICpkYykKK3sKKwlkY24xMF9od19zZXF1ZW5jZXJf
Y29uc3RydWN0KGRjKTsKKwlkYy0+aHdzcy5pbml0X2h3ID0gZGNuMjBfaW5pdF9odzsKKwlkYy0+
aHdzcy5pbml0X3BpcGVzID0gTlVMTDsKKwlkYy0+aHdzcy51bmJsYW5rX3N0cmVhbSA9IGRjbjIw
X3VuYmxhbmtfc3RyZWFtOworCWRjLT5od3NzLnVwZGF0ZV9wbGFuZV9hZGRyID0gZGNuMjBfdXBk
YXRlX3BsYW5lX2FkZHI7CisJZGMtPmh3c3MuZGlzYWJsZV9wbGFuZSA9IGRjbjIwX2Rpc2FibGVf
cGxhbmUsCisJZGMtPmh3c3MuZW5hYmxlX3N0cmVhbV90aW1pbmcgPSBkY24yMF9lbmFibGVfc3Ry
ZWFtX3RpbWluZzsKKwlkYy0+aHdzcy5wcm9ncmFtX3RyaXBsZWJ1ZmZlciA9IGRjbjIwX3Byb2dy
YW1fdHJpcGxlQnVmZmVyOworCWRjLT5od3NzLnNldF9pbnB1dF90cmFuc2Zlcl9mdW5jID0gZGNu
MjBfc2V0X2lucHV0X3RyYW5zZmVyX2Z1bmM7CisJZGMtPmh3c3Muc2V0X291dHB1dF90cmFuc2Zl
cl9mdW5jID0gZGNuMjBfc2V0X291dHB1dF90cmFuc2Zlcl9mdW5jOworCWRjLT5od3NzLmFwcGx5
X2N0eF9mb3Jfc3VyZmFjZSA9IGRjbjIwX2FwcGx5X2N0eF9mb3Jfc3VyZmFjZTsKKwlkYy0+aHdz
cy5waXBlX2NvbnRyb2xfbG9jayA9IGRjbjIwX3BpcGVfY29udHJvbF9sb2NrOworCWRjLT5od3Nz
LnBpcGVfY29udHJvbF9sb2NrX2dsb2JhbCA9IGRjbjIwX3BpcGVfY29udHJvbF9sb2NrX2dsb2Jh
bDsKKwlkYy0+aHdzcy5vcHRpbWl6ZV9iYW5kd2lkdGggPSBkY24yMF9vcHRpbWl6ZV9iYW5kd2lk
dGg7CisJZGMtPmh3c3MucHJlcGFyZV9iYW5kd2lkdGggPSBkY24yMF9wcmVwYXJlX2JhbmR3aWR0
aDsKKwlkYy0+aHdzcy51cGRhdGVfYmFuZHdpZHRoID0gZGNuMjBfdXBkYXRlX2JhbmR3aWR0aDsK
KwlkYy0+aHdzcy5lbmFibGVfd3JpdGViYWNrID0gZGNuMjBfZW5hYmxlX3dyaXRlYmFjazsKKwlk
Yy0+aHdzcy5kaXNhYmxlX3dyaXRlYmFjayA9IGRjbjIwX2Rpc2FibGVfd3JpdGViYWNrOworCWRj
LT5od3NzLnByb2dyYW1fb3V0cHV0X2NzYyA9IGRjbjIwX3Byb2dyYW1fb3V0cHV0X2NzYzsKKwlk
Yy0+aHdzcy51cGRhdGVfb2RtID0gZGNuMjBfdXBkYXRlX29kbTsKKwlkYy0+aHdzcy5ibGFua19w
aXhlbF9kYXRhID0gZGNuMjBfYmxhbmtfcGl4ZWxfZGF0YTsKKwlkYy0+aHdzcy5kbWRhdGFfc3Rh
dHVzX2RvbmUgPSBkY24yMF9kbWRhdGFfc3RhdHVzX2RvbmU7CisJZGMtPmh3c3MuZGlzYWJsZV9z
dHJlYW0gPSBkY24yMF9kaXNhYmxlX3N0cmVhbTsKKwlkYy0+aHdzcy5pbml0X2RjaHViID0gZGNu
MjBfaW5pdF9kY2h1YjsKKwlkYy0+aHdzcy5kaXNhYmxlX3N0cmVhbV9nYXRpbmcgPSBkY24yMF9k
aXNhYmxlX3N0cmVhbV9nYXRpbmc7CisJZGMtPmh3c3MuZW5hYmxlX3N0cmVhbV9nYXRpbmcgPSBk
Y24yMF9lbmFibGVfc3RyZWFtX2dhdGluZzsKKwlkYy0+aHdzcy5zZXR1cF92dXBkYXRlX2ludGVy
cnVwdCA9IGRjbjIwX3NldHVwX3Z1cGRhdGVfaW50ZXJydXB0OworCWRjLT5od3NzLnJlc2V0X2h3
X2N0eF93cmFwID0gZGNuMjBfcmVzZXRfaHdfY3R4X3dyYXA7CisJZGMtPmh3c3MudXBkYXRlX21w
Y2MgPSBkY24yMF91cGRhdGVfbXBjYzsKKwlkYy0+aHdzcy5zZXRfZmxpcF9jb250cm9sX2dzbCA9
IGRjbjIwX3NldF9mbGlwX2NvbnRyb2xfZ3NsOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h3c2VxLmggYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHdzZXEuaApuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMDAwMDAuLmFiYTZmODdjN2YyYgotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9od3NlcS5oCkBAIC0wLDAgKzEs
OTAgQEAKKy8qCisqIENvcHlyaWdodCAyMDE2IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4K
KyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8g
YW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3Nv
Y2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwg
aW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxp
bWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJs
aXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRo
ZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2Fy
ZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRp
b25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Np
b24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50
aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJP
VklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgor
ICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBP
RiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBB
TkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQg
SE9MREVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBP
UgorICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwg
VE9SVCBPUiBPVEhFUldJU0UsCisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNU
SU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElO
IFRIRSBTT0ZUV0FSRS4KKyAqCisgKiBBdXRob3JzOiBBTUQKKyAqCisgKi8KKworI2lmbmRlZiBf
X0RDX0hXU1NfRENOMjBfSF9fCisjZGVmaW5lIF9fRENfSFdTU19EQ04yMF9IX18KKworc3RydWN0
IGRjOworCit2b2lkIGRjbjIwX2h3X3NlcXVlbmNlcl9jb25zdHJ1Y3Qoc3RydWN0IGRjICpkYyk7
CisKK2VudW0gZGNfc3RhdHVzIGRjbjIwX2VuYWJsZV9zdHJlYW1fdGltaW5nKAorCQlzdHJ1Y3Qg
cGlwZV9jdHggKnBpcGVfY3R4LAorCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQsCisJCXN0cnVj
dCBkYyAqZGMpOworCit2b2lkIGRjbjIwX2JsYW5rX3BpeGVsX2RhdGEoCisJCXN0cnVjdCBkYyAq
ZGMsCisJCXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsCisJCWJvb2wgYmxhbmspOworCit2b2lk
IGRjbjIwX3Byb2dyYW1fb3V0cHV0X2NzYyhzdHJ1Y3QgZGMgKmRjLAorCQlzdHJ1Y3QgcGlwZV9j
dHggKnBpcGVfY3R4LAorCQllbnVtIGRjX2NvbG9yX3NwYWNlIGNvbG9yc3BhY2UsCisJCXVpbnQx
Nl90ICptYXRyaXgsCisJCWludCBvcHBfaWQpOworCit2b2lkIGRjbjIwX3ByZXBhcmVfYmFuZHdp
ZHRoKAorCQlzdHJ1Y3QgZGMgKmRjLAorCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpOworCit2
b2lkIGRjbjIwX29wdGltaXplX2JhbmR3aWR0aCgKKwkJc3RydWN0IGRjICpkYywKKwkJc3RydWN0
IGRjX3N0YXRlICpjb250ZXh0KTsKKworYm9vbCBkY24yMF91cGRhdGVfYmFuZHdpZHRoKAorCQlz
dHJ1Y3QgZGMgKmRjLAorCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQpOworCit2b2lkIGRjbjIw
X2Rpc2FibGVfd3JpdGViYWNrKAorCQlzdHJ1Y3QgZGMgKmRjLAorCQl1bnNpZ25lZCBpbnQgZHdi
X3BpcGVfaW5zdCk7CisKK2Jvb2wgZGNuMjBfaHdzc193YWl0X2Zvcl9ibGFua19jb21wbGV0ZSgK
KwkJc3RydWN0IG91dHB1dF9waXhlbF9wcm9jZXNzb3IgKm9wcCk7CisKK2Jvb2wgZGNuMjBfc2V0
X291dHB1dF90cmFuc2Zlcl9mdW5jKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsCisJCQljb25z
dCBzdHJ1Y3QgZGNfc3RyZWFtX3N0YXRlICpzdHJlYW0pOworCitib29sIGRjbjIwX3NldF9pbnB1
dF90cmFuc2Zlcl9mdW5jKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsCisJCQljb25zdCBzdHJ1
Y3QgZGNfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKTsKKworYm9vbCBkY24yMF9kbWRhdGFfc3Rh
dHVzX2RvbmUoc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCk7CisKK3ZvaWQgZGNuMjBfc2V0X2Rt
ZGF0YV9hdHRyaWJ1dGVzKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOworCit2b2lkIGRjbjIw
X2Rpc2FibGVfc3RyZWFtKHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsIGludCBvcHRpb24pOwor
Cit2b2lkIGRjbjIwX3Byb2dyYW1fdHJpcGxlQnVmZmVyKAorCQljb25zdCBzdHJ1Y3QgZGMgKmRj
LAorCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4LAorCQlib29sIGVuYWJsZVRyaXBsZUJ1ZmZl
cik7CisKK3ZvaWQgZGNuMjBfc2V0dXBfdnVwZGF0ZV9pbnRlcnJ1cHQoc3RydWN0IHBpcGVfY3R4
ICpwaXBlX2N0eCk7CisKK3ZvaWQgZGNuMjBfc2V0dXBfZ3NsX2dyb3VwX2FzX2xvY2soY29uc3Qg
c3RydWN0IGRjICpkYywKKwkJCQkgIHN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgpOworCisjZW5k
aWYgLyogX19EQ19IV1NTX0RDTjIwX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX3Jlc291cmNlLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfcmVzb3VyY2UuYwpuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwMDAwMDAuLjUyMmI4NWE1ZGIzMwotLS0gL2Rldi9udWxsCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9yZXNvdXJjZS5jCkBAIC0w
LDAgKzEsMjc0MSBAQAorLyoKKyogQ29weXJpZ2h0IDIwMTYgQWR2YW5jZWQgTWljcm8gRGV2aWNl
cywgSW5jLgorICoKKyAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hh
cmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUg
YW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICog
dG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdp
dGhvdXQgbGltaXRhdGlvbgorICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVy
Z2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3Bp
ZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAq
IFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5n
IGNvbmRpdGlvbnM6CisgKgorICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMg
cGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Ig
c3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FS
RSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBS
RVNTIE9SCisgKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJS
QU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQ
VVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIENP
UFlSSUdIVCBIT0xERVIoUykgT1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBE
QU1BR0VTIE9SCisgKiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENP
TlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwKKyAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElO
IENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgorICogT1RIRVIgREVB
TElOR1MgSU4gVEhFIFNPRlRXQVJFLgorICoKKyAqIEF1dGhvcnM6IEFNRAorICoKKyAqLworCisj
aW5jbHVkZSAiZG1fc2VydmljZXMuaCIKKyNpbmNsdWRlICJkYy5oIgorCisjaW5jbHVkZSAicmVz
b3VyY2UuaCIKKyNpbmNsdWRlICJpbmNsdWRlL2lycV9zZXJ2aWNlX2ludGVyZmFjZS5oIgorI2lu
Y2x1ZGUgImRjbjIwL2RjbjIwX3Jlc291cmNlLmgiCisKKyNpbmNsdWRlICJkY24xMC9kY24xMF9o
dWJwLmgiCisjaW5jbHVkZSAiZGNuMTAvZGNuMTBfaXBwLmgiCisjaW5jbHVkZSAiZGNuMjBfaHVi
YnViLmgiCisjaW5jbHVkZSAiZGNuMjBfbXBjLmgiCisjaW5jbHVkZSAiZGNuMjBfaHVicC5oIgor
I2luY2x1ZGUgImlycS9kY24yMC9pcnFfc2VydmljZV9kY24yMC5oIgorI2luY2x1ZGUgImRjbjIw
X2RwcC5oIgorI2luY2x1ZGUgImRjbjIwX29wdGMuaCIKKyNpbmNsdWRlICJkY24yMF9od3NlcS5o
IgorI2luY2x1ZGUgImRjZTExMC9kY2UxMTBfaHdfc2VxdWVuY2VyLmgiCisjaW5jbHVkZSAiZGNu
MjBfb3BwLmgiCisKKyNpbmNsdWRlICJkY24yMF9saW5rX2VuY29kZXIuaCIKKyNpbmNsdWRlICJk
Y24yMF9zdHJlYW1fZW5jb2Rlci5oIgorI2luY2x1ZGUgImRjZS9kY2VfY2xvY2tfc291cmNlLmgi
CisjaW5jbHVkZSAiZGNlL2RjZV9hdWRpby5oIgorI2luY2x1ZGUgImRjZS9kY2VfaHdzZXEuaCIK
KyNpbmNsdWRlICJ2aXJ0dWFsL3ZpcnR1YWxfc3RyZWFtX2VuY29kZXIuaCIKKyNpbmNsdWRlICJk
Y2UxMTAvZGNlMTEwX3Jlc291cmNlLmgiCisjaW5jbHVkZSAiZG1sL2Rpc3BsYXlfbW9kZV92YmEu
aCIKKyNpbmNsdWRlICJkY24yMF9kY2NnLmgiCisjaW5jbHVkZSAiZGNuMjBfdm1pZC5oIgorCisj
aW5jbHVkZSAibmF2aTEwX2lwX29mZnNldC5oIgorCisjaW5jbHVkZSAiZGNuL2Rjbl8yXzBfMF9v
ZmZzZXQuaCIKKyNpbmNsdWRlICJkY24vZGNuXzJfMF8wX3NoX21hc2suaCIKKworI2luY2x1ZGUg
Im5iaW8vbmJpb18yXzNfb2Zmc2V0LmgiCisKKyNpbmNsdWRlICJtbWh1Yi9tbWh1Yl8yXzBfMF9v
ZmZzZXQuaCIKKyNpbmNsdWRlICJtbWh1Yi9tbWh1Yl8yXzBfMF9zaF9tYXNrLmgiCisKKyNpbmNs
dWRlICJyZWdfaGVscGVyLmgiCisjaW5jbHVkZSAiZGNlL2RjZV9hYm0uaCIKKyNpbmNsdWRlICJk
Y2UvZGNlX2RtY3UuaCIKKyNpbmNsdWRlICJkY2UvZGNlX2F1eC5oIgorI2luY2x1ZGUgImRjZS9k
Y2VfaTJjLmgiCisjaW5jbHVkZSAidm1faGVscGVyLmgiCisKKyNpbmNsdWRlICJhbWRncHVfc29j
YmIuaCIKKworI2RlZmluZSBTT0NfQk9VTkRJTkdfQk9YX1ZBTElEIGZhbHNlCisjZGVmaW5lIERD
X0xPR0dFUl9JTklUKGxvZ2dlcikKKworc3RydWN0IF92Y3NfZHBpX2lwX3BhcmFtc19zdCBkY24y
XzBfaXAgPSB7CisJLm9kbV9jYXBhYmxlID0gMSwKKwkuZ3B1dm1fZW5hYmxlID0gMCwKKwkuaG9z
dHZtX2VuYWJsZSA9IDAsCisJLmdwdXZtX21heF9wYWdlX3RhYmxlX2xldmVscyA9IDQsCisJLmhv
c3R2bV9tYXhfcGFnZV90YWJsZV9sZXZlbHMgPSA0LAorCS5ob3N0dm1fY2FjaGVkX3BhZ2VfdGFi
bGVfbGV2ZWxzID0gMCwKKwkucHRlX2dyb3VwX3NpemVfYnl0ZXMgPSAyMDQ4LAorCS5udW1fZHNj
ID0gMCwKKwkucm9iX2J1ZmZlcl9zaXplX2tieXRlcyA9IDE2OCwKKwkuZGV0X2J1ZmZlcl9zaXpl
X2tieXRlcyA9IDE2NCwKKwkuZHB0ZV9idWZmZXJfc2l6ZV9pbl9wdGVfcmVxc19sdW1hID0gODQs
CisJLnBkZV9wcm9jX2J1ZmZlcl9zaXplXzY0a19yZXFzID0gNDgsCisJLmRwcF9vdXRwdXRfYnVm
ZmVyX3BpeGVscyA9IDI1NjAsCisJLm9wcF9vdXRwdXRfYnVmZmVyX2xpbmVzID0gMSwKKwkucGl4
ZWxfY2h1bmtfc2l6ZV9rYnl0ZXMgPSA4LAorCS5wdGVfY2h1bmtfc2l6ZV9rYnl0ZXMgPSAyLAor
CS5tZXRhX2NodW5rX3NpemVfa2J5dGVzID0gMiwKKwkud3JpdGViYWNrX2NodW5rX3NpemVfa2J5
dGVzID0gMiwKKwkubGluZV9idWZmZXJfc2l6ZV9iaXRzID0gNzg5NTA0LAorCS5pc19saW5lX2J1
ZmZlcl9icHBfZml4ZWQgPSAwLAorCS5saW5lX2J1ZmZlcl9maXhlZF9icHAgPSAwLAorCS5kY2Nf
c3VwcG9ydGVkID0gdHJ1ZSwKKwkubWF4X2xpbmVfYnVmZmVyX2xpbmVzID0gMTIsCisJLndyaXRl
YmFja19sdW1hX2J1ZmZlcl9zaXplX2tieXRlcyA9IDEyLAorCS53cml0ZWJhY2tfY2hyb21hX2J1
ZmZlcl9zaXplX2tieXRlcyA9IDgsCisJLndyaXRlYmFja19jaHJvbWFfbGluZV9idWZmZXJfd2lk
dGhfcGl4ZWxzID0gNCwKKwkud3JpdGViYWNrX21heF9oc2NsX3JhdGlvID0gMSwKKwkud3JpdGVi
YWNrX21heF92c2NsX3JhdGlvID0gMSwKKwkud3JpdGViYWNrX21pbl9oc2NsX3JhdGlvID0gMSwK
Kwkud3JpdGViYWNrX21pbl92c2NsX3JhdGlvID0gMSwKKwkud3JpdGViYWNrX21heF9oc2NsX3Rh
cHMgPSAxMiwKKwkud3JpdGViYWNrX21heF92c2NsX3RhcHMgPSAxMiwKKwkud3JpdGViYWNrX2xp
bmVfYnVmZmVyX2x1bWFfYnVmZmVyX3NpemUgPSAwLAorCS53cml0ZWJhY2tfbGluZV9idWZmZXJf
Y2hyb21hX2J1ZmZlcl9zaXplID0gMTQ2NDMsCisJLmN1cnNvcl9idWZmZXJfc2l6ZSA9IDgsCisJ
LmN1cnNvcl9jaHVua19zaXplID0gMiwKKwkubWF4X251bV9vdGcgPSA2LAorCS5tYXhfbnVtX2Rw
cCA9IDYsCisJLm1heF9udW1fd2IgPSAxLAorCS5tYXhfZGNodWJfcHNjbF9id19waXhfcGVyX2Ns
ayA9IDQsCisJLm1heF9wc2NsX2xiX2J3X3BpeF9wZXJfY2xrID0gMiwKKwkubWF4X2xiX3ZzY2xf
YndfcGl4X3Blcl9jbGsgPSA0LAorCS5tYXhfdnNjbF9oc2NsX2J3X3BpeF9wZXJfY2xrID0gNCwK
KwkubWF4X2hzY2xfcmF0aW8gPSA4LAorCS5tYXhfdnNjbF9yYXRpbyA9IDgsCisJLmhzY2xfbXVs
dHMgPSA0LAorCS52c2NsX211bHRzID0gNCwKKwkubWF4X2hzY2xfdGFwcyA9IDgsCisJLm1heF92
c2NsX3RhcHMgPSA4LAorCS5kaXNwY2xrX3JhbXBfbWFyZ2luX3BlcmNlbnQgPSAxLAorCS51bmRl
cnNjYW5fZmFjdG9yID0gMS4xMCwKKwkubWluX3ZibGFua19saW5lcyA9IDMyLCAvLworCS5kcHBj
bGtfZGVsYXlfc3VidG90YWwgPSA3NywgLy8KKwkuZHBwY2xrX2RlbGF5X3NjbF9sYl9vbmx5ID0g
MTYsCisJLmRwcGNsa19kZWxheV9zY2wgPSA1MCwKKwkuZHBwY2xrX2RlbGF5X2NudmNfZm9ybWF0
dGVyID0gOCwKKwkuZHBwY2xrX2RlbGF5X2NudmNfY3Vyc29yID0gNiwKKwkuZGlzcGNsa19kZWxh
eV9zdWJ0b3RhbCA9IDg3LCAvLworCS5kY2ZjbGtfY3N0YXRlX2xhdGVuY3kgPSAxMCwgLy8gU1JF
eGl0VGltZQorCS5tYXhfaW50ZXJfZGNuX3RpbGVfcmVwZWF0ZXJzID0gOCwKKworCS54ZmNfc3Vw
cG9ydGVkID0gdHJ1ZSwKKwkueGZjX2ZpbGxfYndfb3ZlcmhlYWRfcGVyY2VudCA9IDEwLjAsCisJ
LnhmY19maWxsX2NvbnN0YW50X2J5dGVzID0gMCwKK307CisKK3N0cnVjdCBfdmNzX2RwaV9zb2Nf
Ym91bmRpbmdfYm94X3N0IGRjbjJfMF9zb2MgPSB7IDAgfTsKKworCisjaWZuZGVmIG1tRFAwX0RQ
X0RQSFlfSU5URVJOQUxfQ1RSTAorCSNkZWZpbmUgbW1EUDBfRFBfRFBIWV9JTlRFUk5BTF9DVFJM
CQkweDIxMGYKKwkjZGVmaW5lIG1tRFAwX0RQX0RQSFlfSU5URVJOQUxfQ1RSTF9CQVNFX0lEWAky
CisJI2RlZmluZSBtbURQMV9EUF9EUEhZX0lOVEVSTkFMX0NUUkwJCTB4MjIwZgorCSNkZWZpbmUg
bW1EUDFfRFBfRFBIWV9JTlRFUk5BTF9DVFJMX0JBU0VfSURYCTIKKwkjZGVmaW5lIG1tRFAyX0RQ
X0RQSFlfSU5URVJOQUxfQ1RSTAkJMHgyMzBmCisJI2RlZmluZSBtbURQMl9EUF9EUEhZX0lOVEVS
TkFMX0NUUkxfQkFTRV9JRFgJMgorCSNkZWZpbmUgbW1EUDNfRFBfRFBIWV9JTlRFUk5BTF9DVFJM
CQkweDI0MGYKKwkjZGVmaW5lIG1tRFAzX0RQX0RQSFlfSU5URVJOQUxfQ1RSTF9CQVNFX0lEWAky
CisJI2RlZmluZSBtbURQNF9EUF9EUEhZX0lOVEVSTkFMX0NUUkwJCTB4MjUwZgorCSNkZWZpbmUg
bW1EUDRfRFBfRFBIWV9JTlRFUk5BTF9DVFJMX0JBU0VfSURYCTIKKwkjZGVmaW5lIG1tRFA1X0RQ
X0RQSFlfSU5URVJOQUxfQ1RSTAkJMHgyNjBmCisJI2RlZmluZSBtbURQNV9EUF9EUEhZX0lOVEVS
TkFMX0NUUkxfQkFTRV9JRFgJMgorCSNkZWZpbmUgbW1EUDZfRFBfRFBIWV9JTlRFUk5BTF9DVFJM
CQkweDI3MGYKKwkjZGVmaW5lIG1tRFA2X0RQX0RQSFlfSU5URVJOQUxfQ1RSTF9CQVNFX0lEWAky
CisjZW5kaWYKKworCitlbnVtIGRjbjIwX2Nsa19zcmNfYXJyYXlfaWQgeworCURDTjIwX0NMS19T
UkNfUExMMCwKKwlEQ04yMF9DTEtfU1JDX1BMTDEsCisJRENOMjBfQ0xLX1NSQ19QTEwyLAorCURD
TjIwX0NMS19TUkNfUExMMywKKwlEQ04yMF9DTEtfU1JDX1BMTDQsCisJRENOMjBfQ0xLX1NSQ19Q
TEw1LAorCURDTjIwX0NMS19TUkNfVE9UQUwKK307CisKKy8qIGJlZ2luICoqKioqKioqKioqKioq
KioqKioqKgorICogbWFjcm9zIHRvIGV4cGVuZCByZWdpc3RlciBsaXN0IG1hY3JvIGRlZmluZWQg
aW4gSFcgb2JqZWN0IGhlYWRlciBmaWxlICovCisKKy8qIERDTiAqLworLyogVE9ETyBhd2Z1bCBo
YWNrLiBmaXh1cCBkY24yMF9kd2IuaCAqLworI3VuZGVmIEJBU0VfSU5ORVIKKyNkZWZpbmUgQkFT
RV9JTk5FUihzZWcpIERDTl9CQVNFX19JTlNUMF9TRUcgIyMgc2VnCisKKyNkZWZpbmUgQkFTRShz
ZWcpIEJBU0VfSU5ORVIoc2VnKQorCisjZGVmaW5lIFNSKHJlZ19uYW1lKVwKKwkJLnJlZ19uYW1l
ID0gQkFTRShtbSAjIyByZWdfbmFtZSAjIyBfQkFTRV9JRFgpICsgIFwKKwkJCQkJbW0gIyMgcmVn
X25hbWUKKworI2RlZmluZSBTUkkocmVnX25hbWUsIGJsb2NrLCBpZClcCisJLnJlZ19uYW1lID0g
QkFTRShtbSAjIyBibG9jayAjIyBpZCAjIyBfICMjIHJlZ19uYW1lICMjIF9CQVNFX0lEWCkgKyBc
CisJCQkJCW1tICMjIGJsb2NrICMjIGlkICMjIF8gIyMgcmVnX25hbWUKKworI2RlZmluZSBTUklS
KHZhcl9uYW1lLCByZWdfbmFtZSwgYmxvY2ssIGlkKVwKKwkudmFyX25hbWUgPSBCQVNFKG1tICMj
IGJsb2NrICMjIGlkICMjIF8gIyMgcmVnX25hbWUgIyMgX0JBU0VfSURYKSArIFwKKwkJCQkJbW0g
IyMgYmxvY2sgIyMgaWQgIyMgXyAjIyByZWdfbmFtZQorCisjZGVmaW5lIFNSSUkocmVnX25hbWUs
IGJsb2NrLCBpZClcCisJLnJlZ19uYW1lW2lkXSA9IEJBU0UobW0gIyMgYmxvY2sgIyMgaWQgIyMg
XyAjIyByZWdfbmFtZSAjIyBfQkFTRV9JRFgpICsgXAorCQkJCQltbSAjIyBibG9jayAjIyBpZCAj
IyBfICMjIHJlZ19uYW1lCisKKyNkZWZpbmUgRENDR19TUklJKHJlZ19uYW1lLCBibG9jaywgaWQp
XAorCS5ibG9jayAjIyBfICMjIHJlZ19uYW1lW2lkXSA9IEJBU0UobW0gIyMgYmxvY2sgIyMgaWQg
IyMgXyAjIyByZWdfbmFtZSAjIyBfQkFTRV9JRFgpICsgXAorCQkJCQltbSAjIyBibG9jayAjIyBp
ZCAjIyBfICMjIHJlZ19uYW1lCisKKy8qIE5CSU8gKi8KKyNkZWZpbmUgTkJJT19CQVNFX0lOTkVS
KHNlZykgXAorCU5CSU9fQkFTRV9fSU5TVDBfU0VHICMjIHNlZworCisjZGVmaW5lIE5CSU9fQkFT
RShzZWcpIFwKKwlOQklPX0JBU0VfSU5ORVIoc2VnKQorCisjZGVmaW5lIE5CSU9fU1IocmVnX25h
bWUpXAorCQkucmVnX25hbWUgPSBOQklPX0JBU0UobW0gIyMgcmVnX25hbWUgIyMgX0JBU0VfSURY
KSArIFwKKwkJCQkJbW0gIyMgcmVnX25hbWUKKworLyogTU1IVUIgKi8KKyNkZWZpbmUgTU1IVUJf
QkFTRV9JTk5FUihzZWcpIFwKKwlNTUhVQl9CQVNFX19JTlNUMF9TRUcgIyMgc2VnCisKKyNkZWZp
bmUgTU1IVUJfQkFTRShzZWcpIFwKKwlNTUhVQl9CQVNFX0lOTkVSKHNlZykKKworI2RlZmluZSBN
TUhVQl9TUihyZWdfbmFtZSlcCisJCS5yZWdfbmFtZSA9IE1NSFVCX0JBU0UobW1NTSAjIyByZWdf
bmFtZSAjIyBfQkFTRV9JRFgpICsgXAorCQkJCQltbU1NICMjIHJlZ19uYW1lCisKK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgYmlvc19yZWdpc3RlcnMgYmlvc19yZWdzID0geworCQlOQklPX1NSKEJJT1Nf
U0NSQVRDSF8zKSwKKwkJTkJJT19TUihCSU9TX1NDUkFUQ0hfNikKK307CisKKyNkZWZpbmUgY2xr
X3NyY19yZWdzKGluZGV4LCBwbGxpZClcCitbaW5kZXhdID0ge1wKKwlDU19DT01NT05fUkVHX0xJ
U1RfRENOMl8wKGluZGV4LCBwbGxpZCksXAorfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRjZTEx
MF9jbGtfc3JjX3JlZ3MgY2xrX3NyY19yZWdzW10gPSB7CisJY2xrX3NyY19yZWdzKDAsIEEpLAor
CWNsa19zcmNfcmVncygxLCBCKSwKKwljbGtfc3JjX3JlZ3MoMiwgQyksCisJY2xrX3NyY19yZWdz
KDMsIEQpLAorCWNsa19zcmNfcmVncyg0LCBFKSwKKwljbGtfc3JjX3JlZ3MoNSwgRikKK307CisK
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNlMTEwX2Nsa19zcmNfc2hpZnQgY3Nfc2hpZnQgPSB7CisJ
CUNTX0NPTU1PTl9NQVNLX1NIX0xJU1RfRENOMl8wKF9fU0hJRlQpCit9OworCitzdGF0aWMgY29u
c3Qgc3RydWN0IGRjZTExMF9jbGtfc3JjX21hc2sgY3NfbWFzayA9IHsKKwkJQ1NfQ09NTU9OX01B
U0tfU0hfTElTVF9EQ04yXzAoX01BU0spCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRjZV9k
bWN1X3JlZ2lzdGVycyBkbWN1X3JlZ3MgPSB7CisJCURNQ1VfRENOMTBfUkVHX0xJU1QoKQorfTsK
Kworc3RhdGljIGNvbnN0IHN0cnVjdCBkY2VfZG1jdV9zaGlmdCBkbWN1X3NoaWZ0ID0geworCQlE
TUNVX01BU0tfU0hfTElTVF9EQ04xMChfX1NISUZUKQorfTsKKworc3RhdGljIGNvbnN0IHN0cnVj
dCBkY2VfZG1jdV9tYXNrIGRtY3VfbWFzayA9IHsKKwkJRE1DVV9NQVNLX1NIX0xJU1RfRENOMTAo
X01BU0spCit9OworLyoKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNlX2FibV9yZWdpc3RlcnMgYWJt
X3JlZ3MgPSB7CisJCUFCTV9EQ04xMF9SRUdfTElTVCgwKQorfTsKKworc3RhdGljIGNvbnN0IHN0
cnVjdCBkY2VfYWJtX3NoaWZ0IGFibV9zaGlmdCA9IHsKKwkJQUJNX01BU0tfU0hfTElTVF9EQ04x
MChfX1NISUZUKQorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkY2VfYWJtX21hc2sgYWJtX21h
c2sgPSB7CisJCUFCTV9NQVNLX1NIX0xJU1RfRENOMTAoX01BU0spCit9OworKi8KKyNkZWZpbmUg
YXVkaW9fcmVncyhpZClcCitbaWRdID0ge1wKKwkJQVVEX0NPTU1PTl9SRUdfTElTVChpZClcCit9
CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNlX2F1ZGlvX3JlZ2lzdGVycyBhdWRpb19yZWdzW10g
PSB7CisJYXVkaW9fcmVncygwKSwKKwlhdWRpb19yZWdzKDEpLAorCWF1ZGlvX3JlZ3MoMiksCisJ
YXVkaW9fcmVncygzKSwKKwlhdWRpb19yZWdzKDQpLAorCWF1ZGlvX3JlZ3MoNSksCisJYXVkaW9f
cmVncyg2KSwKK307CisKKyNkZWZpbmUgRENFMTIwX0FVRF9DT01NT05fTUFTS19TSF9MSVNUKG1h
c2tfc2gpXAorCQlTRihBWkYwRU5EUE9JTlQwX0FaQUxJQV9GMF9DT0RFQ19FTkRQT0lOVF9JTkRF
WCwgQVpBTElBX0VORFBPSU5UX1JFR19JTkRFWCwgbWFza19zaCksXAorCQlTRihBWkYwRU5EUE9J
TlQwX0FaQUxJQV9GMF9DT0RFQ19FTkRQT0lOVF9EQVRBLCBBWkFMSUFfRU5EUE9JTlRfUkVHX0RB
VEEsIG1hc2tfc2gpLFwKKwkJQVVEX0NPTU1PTl9NQVNLX1NIX0xJU1RfQkFTRShtYXNrX3NoKQor
CitzdGF0aWMgY29uc3Qgc3RydWN0IGRjZV9hdWRpb19zaGlmdCBhdWRpb19zaGlmdCA9IHsKKwkJ
RENFMTIwX0FVRF9DT01NT05fTUFTS19TSF9MSVNUKF9fU0hJRlQpCit9OworCitzdGF0aWMgY29u
c3Qgc3RydWN0IGRjZV9hZHVpb19tYXNrIGF1ZGlvX21hc2sgPSB7CisJCURDRTEyMF9BVURfQ09N
TU9OX01BU0tfU0hfTElTVChfTUFTSykKK307CisKKyNkZWZpbmUgc3RyZWFtX2VuY19yZWdzKGlk
KVwKK1tpZF0gPSB7XAorCVNFX0RDTjJfUkVHX0xJU1QoaWQpXAorfQorCitzdGF0aWMgY29uc3Qg
c3RydWN0IGRjbjEwX3N0cmVhbV9lbmNfcmVnaXN0ZXJzIHN0cmVhbV9lbmNfcmVnc1tdID0gewor
CXN0cmVhbV9lbmNfcmVncygwKSwKKwlzdHJlYW1fZW5jX3JlZ3MoMSksCisJc3RyZWFtX2VuY19y
ZWdzKDIpLAorCXN0cmVhbV9lbmNfcmVncygzKSwKKwlzdHJlYW1fZW5jX3JlZ3MoNCksCisJc3Ry
ZWFtX2VuY19yZWdzKDUpLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkY24xMF9zdHJlYW1f
ZW5jb2Rlcl9zaGlmdCBzZV9zaGlmdCA9IHsKKwkJU0VfQ09NTU9OX01BU0tfU0hfTElTVF9EQ04y
MChfX1NISUZUKQorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkY24xMF9zdHJlYW1fZW5jb2Rl
cl9tYXNrIHNlX21hc2sgPSB7CisJCVNFX0NPTU1PTl9NQVNLX1NIX0xJU1RfRENOMjAoX01BU0sp
Cit9OworCisKKyNkZWZpbmUgYXV4X3JlZ3MoaWQpXAorW2lkXSA9IHtcCisJRENOMl9BVVhfUkVH
X0xJU1QoaWQpXAorfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRjbjEwX2xpbmtfZW5jX2F1eF9y
ZWdpc3RlcnMgbGlua19lbmNfYXV4X3JlZ3NbXSA9IHsKKwkJYXV4X3JlZ3MoMCksCisJCWF1eF9y
ZWdzKDEpLAorCQlhdXhfcmVncygyKSwKKwkJYXV4X3JlZ3MoMyksCisJCWF1eF9yZWdzKDQpLAor
CQlhdXhfcmVncyg1KQorfTsKKworI2RlZmluZSBocGRfcmVncyhpZClcCitbaWRdID0ge1wKKwlI
UERfUkVHX0xJU1QoaWQpXAorfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRjbjEwX2xpbmtfZW5j
X2hwZF9yZWdpc3RlcnMgbGlua19lbmNfaHBkX3JlZ3NbXSA9IHsKKwkJaHBkX3JlZ3MoMCksCisJ
CWhwZF9yZWdzKDEpLAorCQlocGRfcmVncygyKSwKKwkJaHBkX3JlZ3MoMyksCisJCWhwZF9yZWdz
KDQpLAorCQlocGRfcmVncyg1KQorfTsKKworI2RlZmluZSBsaW5rX3JlZ3MoaWQsIHBoeWlkKVwK
K1tpZF0gPSB7XAorCUxFX0RDTjEwX1JFR19MSVNUKGlkKSwgXAorCVVOSVBIWV9EQ04yX1JFR19M
SVNUKHBoeWlkKSwgXAorCVNSSShEUF9EUEhZX0lOVEVSTkFMX0NUUkwsIERQLCBpZCkgXAorfQor
CitzdGF0aWMgY29uc3Qgc3RydWN0IGRjbjEwX2xpbmtfZW5jX3JlZ2lzdGVycyBsaW5rX2VuY19y
ZWdzW10gPSB7CisJbGlua19yZWdzKDAsIEEpLAorCWxpbmtfcmVncygxLCBCKSwKKwlsaW5rX3Jl
Z3MoMiwgQyksCisJbGlua19yZWdzKDMsIEQpLAorCWxpbmtfcmVncyg0LCBFKSwKKwlsaW5rX3Jl
Z3MoNSwgRikKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNuMTBfbGlua19lbmNfc2hpZnQg
bGVfc2hpZnQgPSB7CisJTElOS19FTkNPREVSX01BU0tfU0hfTElTVF9EQ04yMChfX1NISUZUKQor
fTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkY24xMF9saW5rX2VuY19tYXNrIGxlX21hc2sgPSB7
CisJTElOS19FTkNPREVSX01BU0tfU0hfTElTVF9EQ04yMChfTUFTSykKK307CisKKyNkZWZpbmUg
aXBwX3JlZ3MoaWQpXAorW2lkXSA9IHtcCisJSVBQX1JFR19MSVNUX0RDTjIwKGlkKSxcCit9CisK
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNuMTBfaXBwX3JlZ2lzdGVycyBpcHBfcmVnc1tdID0gewor
CWlwcF9yZWdzKDApLAorCWlwcF9yZWdzKDEpLAorCWlwcF9yZWdzKDIpLAorCWlwcF9yZWdzKDMp
LAorCWlwcF9yZWdzKDQpLAorCWlwcF9yZWdzKDUpLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVj
dCBkY24xMF9pcHBfc2hpZnQgaXBwX3NoaWZ0ID0geworCQlJUFBfTUFTS19TSF9MSVNUX0RDTjIw
KF9fU0hJRlQpCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRjbjEwX2lwcF9tYXNrIGlwcF9t
YXNrID0geworCQlJUFBfTUFTS19TSF9MSVNUX0RDTjIwKF9NQVNLKSwKK307CisKKyNkZWZpbmUg
b3BwX3JlZ3MoaWQpXAorW2lkXSA9IHtcCisJT1BQX1JFR19MSVNUX0RDTjIwKGlkKSxcCit9CisK
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNuMjBfb3BwX3JlZ2lzdGVycyBvcHBfcmVnc1tdID0gewor
CW9wcF9yZWdzKDApLAorCW9wcF9yZWdzKDEpLAorCW9wcF9yZWdzKDIpLAorCW9wcF9yZWdzKDMp
LAorCW9wcF9yZWdzKDQpLAorCW9wcF9yZWdzKDUpLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVj
dCBkY24yMF9vcHBfc2hpZnQgb3BwX3NoaWZ0ID0geworCQlPUFBfTUFTS19TSF9MSVNUX0RDTjIw
KF9fU0hJRlQpCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRjbjIwX29wcF9tYXNrIG9wcF9t
YXNrID0geworCQlPUFBfTUFTS19TSF9MSVNUX0RDTjIwKF9NQVNLKQorfTsKKworI2RlZmluZSBh
dXhfZW5naW5lX3JlZ3MoaWQpXAorW2lkXSA9IHtcCisJQVVYX0NPTU1PTl9SRUdfTElTVDAoaWQp
LCBcCisJLkFVWE5fSU1QQ0FMID0gMCwgXAorCS5BVVhQX0lNUENBTCA9IDAsIFwKKwkuQVVYX1JF
U0VUX01BU0sgPSBEUF9BVVgwX0FVWF9DT05UUk9MX19BVVhfUkVTRVRfTUFTSywgXAorfQorCitz
dGF0aWMgY29uc3Qgc3RydWN0IGRjZTExMF9hdXhfcmVnaXN0ZXJzIGF1eF9lbmdpbmVfcmVnc1td
ID0geworCQlhdXhfZW5naW5lX3JlZ3MoMCksCisJCWF1eF9lbmdpbmVfcmVncygxKSwKKwkJYXV4
X2VuZ2luZV9yZWdzKDIpLAorCQlhdXhfZW5naW5lX3JlZ3MoMyksCisJCWF1eF9lbmdpbmVfcmVn
cyg0KSwKKwkJYXV4X2VuZ2luZV9yZWdzKDUpCit9OworCisjZGVmaW5lIHRmX3JlZ3MoaWQpXAor
W2lkXSA9IHtcCisJVEZfUkVHX0xJU1RfRENOMjAoaWQpLFwKK30KKworc3RhdGljIGNvbnN0IHN0
cnVjdCBkY24yX2RwcF9yZWdpc3RlcnMgdGZfcmVnc1tdID0geworCXRmX3JlZ3MoMCksCisJdGZf
cmVncygxKSwKKwl0Zl9yZWdzKDIpLAorCXRmX3JlZ3MoMyksCisJdGZfcmVncyg0KSwKKwl0Zl9y
ZWdzKDUpLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkY24yX2RwcF9zaGlmdCB0Zl9zaGlm
dCA9IHsKKwkJVEZfUkVHX0xJU1RfU0hfTUFTS19EQ04yMChfX1NISUZUKQorfTsKKworc3RhdGlj
IGNvbnN0IHN0cnVjdCBkY24yX2RwcF9tYXNrIHRmX21hc2sgPSB7CisJCVRGX1JFR19MSVNUX1NI
X01BU0tfRENOMjAoX01BU0spCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRjbjIwX21wY19y
ZWdpc3RlcnMgbXBjX3JlZ3MgPSB7CisJCU1QQ19SRUdfTElTVF9EQ04yXzAoMCksCisJCU1QQ19S
RUdfTElTVF9EQ04yXzAoMSksCisJCU1QQ19SRUdfTElTVF9EQ04yXzAoMiksCisJCU1QQ19SRUdf
TElTVF9EQ04yXzAoMyksCisJCU1QQ19SRUdfTElTVF9EQ04yXzAoNCksCisJCU1QQ19SRUdfTElT
VF9EQ04yXzAoNSksCisJCU1QQ19PVVRfTVVYX1JFR19MSVNUX0RDTjJfMCgwKSwKKwkJTVBDX09V
VF9NVVhfUkVHX0xJU1RfRENOMl8wKDEpLAorCQlNUENfT1VUX01VWF9SRUdfTElTVF9EQ04yXzAo
MiksCisJCU1QQ19PVVRfTVVYX1JFR19MSVNUX0RDTjJfMCgzKSwKKwkJTVBDX09VVF9NVVhfUkVH
X0xJU1RfRENOMl8wKDQpLAorCQlNUENfT1VUX01VWF9SRUdfTElTVF9EQ04yXzAoNSksCit9Owor
CitzdGF0aWMgY29uc3Qgc3RydWN0IGRjbjIwX21wY19zaGlmdCBtcGNfc2hpZnQgPSB7CisJTVBD
X0NPTU1PTl9NQVNLX1NIX0xJU1RfRENOMl8wKF9fU0hJRlQpCit9OworCitzdGF0aWMgY29uc3Qg
c3RydWN0IGRjbjIwX21wY19tYXNrIG1wY19tYXNrID0geworCU1QQ19DT01NT05fTUFTS19TSF9M
SVNUX0RDTjJfMChfTUFTSykKK307CisKKyNkZWZpbmUgdGdfcmVncyhpZClcCitbaWRdID0ge1RH
X0NPTU1PTl9SRUdfTElTVF9EQ04yXzAoaWQpfQorCisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNu
X29wdGNfcmVnaXN0ZXJzIHRnX3JlZ3NbXSA9IHsKKwl0Z19yZWdzKDApLAorCXRnX3JlZ3MoMSks
CisJdGdfcmVncygyKSwKKwl0Z19yZWdzKDMpLAorCXRnX3JlZ3MoNCksCisJdGdfcmVncyg1KQor
fTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkY25fb3B0Y19zaGlmdCB0Z19zaGlmdCA9IHsKKwlU
R19DT01NT05fTUFTS19TSF9MSVNUX0RDTjJfMChfX1NISUZUKQorfTsKKworc3RhdGljIGNvbnN0
IHN0cnVjdCBkY25fb3B0Y19tYXNrIHRnX21hc2sgPSB7CisJVEdfQ09NTU9OX01BU0tfU0hfTElT
VF9EQ04yXzAoX01BU0spCit9OworCisjZGVmaW5lIGh1YnBfcmVncyhpZClcCitbaWRdID0ge1wK
KwlIVUJQX1JFR19MSVNUX0RDTjIwKGlkKVwKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkY25f
aHVicDJfcmVnaXN0ZXJzIGh1YnBfcmVnc1tdID0geworCQlodWJwX3JlZ3MoMCksCisJCWh1YnBf
cmVncygxKSwKKwkJaHVicF9yZWdzKDIpLAorCQlodWJwX3JlZ3MoMyksCisJCWh1YnBfcmVncyg0
KSwKKwkJaHVicF9yZWdzKDUpCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRjbl9odWJwMl9z
aGlmdCBodWJwX3NoaWZ0ID0geworCQlIVUJQX01BU0tfU0hfTElTVF9EQ04yMChfX1NISUZUKQor
fTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkY25faHVicDJfbWFzayBodWJwX21hc2sgPSB7CisJ
CUhVQlBfTUFTS19TSF9MSVNUX0RDTjIwKF9NQVNLKQorfTsKKworc3RhdGljIGNvbnN0IHN0cnVj
dCBkY25faHViYnViX3JlZ2lzdGVycyBodWJidWJfcmVnID0geworCQlIVUJCVUJfUkVHX0xJU1Rf
RENOMjAoMCkKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNuX2h1YmJ1Yl9zaGlmdCBodWJi
dWJfc2hpZnQgPSB7CisJCUhVQkJVQl9NQVNLX1NIX0xJU1RfRENOMjAoX19TSElGVCkKK307CisK
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNuX2h1YmJ1Yl9tYXNrIGh1YmJ1Yl9tYXNrID0geworCQlI
VUJCVUJfTUFTS19TSF9MSVNUX0RDTjIwKF9NQVNLKQorfTsKKworI2RlZmluZSB2bWlkX3JlZ3Mo
aWQpXAorW2lkXSA9IHtcCisJCURDTjIwX1ZNSURfUkVHX0xJU1QoaWQpXAorfQorCitzdGF0aWMg
Y29uc3Qgc3RydWN0IGRjbl92bWlkX3JlZ2lzdGVycyB2bWlkX3JlZ3NbXSA9IHsKKwl2bWlkX3Jl
Z3MoMCksCisJdm1pZF9yZWdzKDEpLAorCXZtaWRfcmVncygyKSwKKwl2bWlkX3JlZ3MoMyksCisJ
dm1pZF9yZWdzKDQpLAorCXZtaWRfcmVncyg1KSwKKwl2bWlkX3JlZ3MoNiksCisJdm1pZF9yZWdz
KDcpLAorCXZtaWRfcmVncyg4KSwKKwl2bWlkX3JlZ3MoOSksCisJdm1pZF9yZWdzKDEwKSwKKwl2
bWlkX3JlZ3MoMTEpLAorCXZtaWRfcmVncygxMiksCisJdm1pZF9yZWdzKDEzKSwKKwl2bWlkX3Jl
Z3MoMTQpLAorCXZtaWRfcmVncygxNSkKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNuMjBf
dm1pZF9zaGlmdCB2bWlkX3NoaWZ0cyA9IHsKKwkJRENOMjBfVk1JRF9NQVNLX1NIX0xJU1QoX19T
SElGVCkKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNuMjBfdm1pZF9tYXNrIHZtaWRfbWFz
a3MgPSB7CisJCURDTjIwX1ZNSURfTUFTS19TSF9MSVNUKF9NQVNLKQorfTsKKworCitzdGF0aWMg
Y29uc3Qgc3RydWN0IGRjY2dfcmVnaXN0ZXJzIGRjY2dfcmVncyA9IHsKKwkJRENDR19SRUdfTElT
VF9EQ04yKCkKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNjZ19zaGlmdCBkY2NnX3NoaWZ0
ID0geworCQlEQ0NHX01BU0tfU0hfTElTVF9EQ04yKF9fU0hJRlQpCit9OworCitzdGF0aWMgY29u
c3Qgc3RydWN0IGRjY2dfbWFzayBkY2NnX21hc2sgPSB7CisJCURDQ0dfTUFTS19TSF9MSVNUX0RD
TjIoX01BU0spCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IHJlc291cmNlX2NhcHMgcmVzX2Nh
cF9udjEwID0geworCQkubnVtX3RpbWluZ19nZW5lcmF0b3IgPSA2LAorCQkubnVtX29wcCA9IDYs
CisJCS5udW1fdmlkZW9fcGxhbmUgPSA2LAorCQkubnVtX2F1ZGlvID0gNywKKwkJLm51bV9zdHJl
YW1fZW5jb2RlciA9IDYsCisJCS5udW1fcGxsID0gNiwKKwkJLm51bV9kd2IgPSAxLAorCQkubnVt
X2RkYyA9IDYsCisJCS5udW1fdm1pZCA9IDE2LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBk
Y19wbGFuZV9jYXAgcGxhbmVfY2FwID0geworCS50eXBlID0gRENfUExBTkVfVFlQRV9EQ05fVU5J
VkVSU0FMLAorCS5ibGVuZHNfd2l0aF9hYm92ZSA9IHRydWUsCisJLmJsZW5kc193aXRoX2JlbG93
ID0gdHJ1ZSwKKwkuc3VwcG9ydHNfYXJnYjg4ODggPSB0cnVlLAorCS5wZXJfcGl4ZWxfYWxwaGEg
PSB0cnVlLAorCS5zdXBwb3J0c19hcmdiODg4OCA9IHRydWUsCisJLnN1cHBvcnRzX252MTIgPSB0
cnVlCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRjX2RlYnVnX29wdGlvbnMgZGVidWdfZGVm
YXVsdHNfZHJ2ID0geworCQkuZGlzYWJsZV9kbWN1ID0gdHJ1ZSwKKwkJLmZvcmNlX2FibV9lbmFi
bGUgPSBmYWxzZSwKKwkJLnRpbWluZ190cmFjZSA9IGZhbHNlLAorCQkuY2xvY2tfdHJhY2UgPSB0
cnVlLAorCQkuZGlzYWJsZV9wcGxpYl9jbG9ja19yZXF1ZXN0ID0gdHJ1ZSwKKwkJLnBpcGVfc3Bs
aXRfcG9saWN5ID0gTVBDX1NQTElUX0RZTkFNSUMsCisJCS5mb3JjZV9zaW5nbGVfZGlzcF9waXBl
X3NwbGl0ID0gdHJ1ZSwKKwkJLmRpc2FibGVfZGNjID0gRENDX0VOQUJMRSwKKwkJLnZzcl9zdXBw
b3J0ID0gdHJ1ZSwKKwkJLnBlcmZvcm1hbmNlX3RyYWNlID0gZmFsc2UsCisJCS5tYXhfZG93bnNj
YWxlX3NyY193aWR0aCA9IDUxMjAsLyp1cHRvIDVLKi8KKwkJLmRpc2FibGVfcHBsaWJfd21fcmFu
Z2UgPSBmYWxzZSwKKwkJLnNjbF9yZXNldF9sZW5ndGgxMCA9IHRydWUsCisJCS5zYW5pdHlfY2hl
Y2tzID0gdHJ1ZSwKKwkJLmRpc2FibGVfdHJpX2J1ZiA9IHRydWUsCit9OworCitzdGF0aWMgY29u
c3Qgc3RydWN0IGRjX2RlYnVnX29wdGlvbnMgZGVidWdfZGVmYXVsdHNfZGlhZ3MgPSB7CisJCS5k
aXNhYmxlX2RtY3UgPSB0cnVlLAorCQkuZm9yY2VfYWJtX2VuYWJsZSA9IGZhbHNlLAorCQkudGlt
aW5nX3RyYWNlID0gdHJ1ZSwKKwkJLmNsb2NrX3RyYWNlID0gdHJ1ZSwKKwkJLmRpc2FibGVfZHBw
X3Bvd2VyX2dhdGUgPSB0cnVlLAorCQkuZGlzYWJsZV9odWJwX3Bvd2VyX2dhdGUgPSB0cnVlLAor
CQkuZGlzYWJsZV9jbG9ja19nYXRlID0gdHJ1ZSwKKwkJLmRpc2FibGVfcHBsaWJfY2xvY2tfcmVx
dWVzdCA9IHRydWUsCisJCS5kaXNhYmxlX3BwbGliX3dtX3JhbmdlID0gdHJ1ZSwKKwkJLmRpc2Fi
bGVfc3R1dHRlciA9IHRydWUsCisJCS5zY2xfcmVzZXRfbGVuZ3RoMTAgPSB0cnVlLAorfTsKKwor
dm9pZCBkY24yMF9kcHBfZGVzdHJveShzdHJ1Y3QgZHBwICoqZHBwKQoreworCWtmcmVlKFRPX0RD
TjIwX0RQUCgqZHBwKSk7CisJKmRwcCA9IE5VTEw7Cit9CisKK3N0cnVjdCBkcHAgKmRjbjIwX2Rw
cF9jcmVhdGUoCisJc3RydWN0IGRjX2NvbnRleHQgKmN0eCwKKwl1aW50MzJfdCBpbnN0KQorewor
CXN0cnVjdCBkY24yMF9kcHAgKmRwcCA9CisJCWt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBkY24yMF9k
cHApLCBHRlBfS0VSTkVMKTsKKworCWlmICghZHBwKQorCQlyZXR1cm4gTlVMTDsKKworCWlmIChk
cHAyX2NvbnN0cnVjdChkcHAsIGN0eCwgaW5zdCwKKwkJCSZ0Zl9yZWdzW2luc3RdLCAmdGZfc2hp
ZnQsICZ0Zl9tYXNrKSkKKwkJcmV0dXJuICZkcHAtPmJhc2U7CisKKwlCUkVBS19UT19ERUJVR0dF
UigpOworCWtmcmVlKGRwcCk7CisJcmV0dXJuIE5VTEw7Cit9CisKK3N0cnVjdCBpbnB1dF9waXhl
bF9wcm9jZXNzb3IgKmRjbjIwX2lwcF9jcmVhdGUoCisJc3RydWN0IGRjX2NvbnRleHQgKmN0eCwg
dWludDMyX3QgaW5zdCkKK3sKKwlzdHJ1Y3QgZGNuMTBfaXBwICppcHAgPQorCQlremFsbG9jKHNp
emVvZihzdHJ1Y3QgZGNuMTBfaXBwKSwgR0ZQX0tFUk5FTCk7CisKKwlpZiAoIWlwcCkgeworCQlC
UkVBS19UT19ERUJVR0dFUigpOworCQlyZXR1cm4gTlVMTDsKKwl9CisKKwlkY24yMF9pcHBfY29u
c3RydWN0KGlwcCwgY3R4LCBpbnN0LAorCQkJJmlwcF9yZWdzW2luc3RdLCAmaXBwX3NoaWZ0LCAm
aXBwX21hc2spOworCXJldHVybiAmaXBwLT5iYXNlOworfQorCisKK3N0cnVjdCBvdXRwdXRfcGl4
ZWxfcHJvY2Vzc29yICpkY24yMF9vcHBfY3JlYXRlKAorCXN0cnVjdCBkY19jb250ZXh0ICpjdHgs
IHVpbnQzMl90IGluc3QpCit7CisJc3RydWN0IGRjbjIwX29wcCAqb3BwID0KKwkJa3phbGxvYyhz
aXplb2Yoc3RydWN0IGRjbjIwX29wcCksIEdGUF9LRVJORUwpOworCisJaWYgKCFvcHApIHsKKwkJ
QlJFQUtfVE9fREVCVUdHRVIoKTsKKwkJcmV0dXJuIE5VTEw7CisJfQorCisJZGNuMjBfb3BwX2Nv
bnN0cnVjdChvcHAsIGN0eCwgaW5zdCwKKwkJCSZvcHBfcmVnc1tpbnN0XSwgJm9wcF9zaGlmdCwg
Jm9wcF9tYXNrKTsKKwlyZXR1cm4gJm9wcC0+YmFzZTsKK30KKworc3RydWN0IGRjZV9hdXggKmRj
bjIwX2F1eF9lbmdpbmVfY3JlYXRlKAorCXN0cnVjdCBkY19jb250ZXh0ICpjdHgsCisJdWludDMy
X3QgaW5zdCkKK3sKKwlzdHJ1Y3QgYXV4X2VuZ2luZV9kY2UxMTAgKmF1eF9lbmdpbmUgPQorCQlr
emFsbG9jKHNpemVvZihzdHJ1Y3QgYXV4X2VuZ2luZV9kY2UxMTApLCBHRlBfS0VSTkVMKTsKKwor
CWlmICghYXV4X2VuZ2luZSkKKwkJcmV0dXJuIE5VTEw7CisKKwlkY2UxMTBfYXV4X2VuZ2luZV9j
b25zdHJ1Y3QoYXV4X2VuZ2luZSwgY3R4LCBpbnN0LAorCQkJCSAgICBTV19BVVhfVElNRU9VVF9Q
RVJJT0RfTVVMVElQTElFUiAqIEFVWF9USU1FT1VUX1BFUklPRCwKKwkJCQkgICAgJmF1eF9lbmdp
bmVfcmVnc1tpbnN0XSk7CisKKwlyZXR1cm4gJmF1eF9lbmdpbmUtPmJhc2U7Cit9CisjZGVmaW5l
IGkyY19pbnN0X3JlZ3MoaWQpIHsgSTJDX0hXX0VOR0lORV9DT01NT05fUkVHX0xJU1QoaWQpIH0K
Kworc3RhdGljIGNvbnN0IHN0cnVjdCBkY2VfaTJjX3JlZ2lzdGVycyBpMmNfaHdfcmVnc1tdID0g
eworCQlpMmNfaW5zdF9yZWdzKDEpLAorCQlpMmNfaW5zdF9yZWdzKDIpLAorCQlpMmNfaW5zdF9y
ZWdzKDMpLAorCQlpMmNfaW5zdF9yZWdzKDQpLAorCQlpMmNfaW5zdF9yZWdzKDUpLAorCQlpMmNf
aW5zdF9yZWdzKDYpLAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkY2VfaTJjX3NoaWZ0IGky
Y19zaGlmdHMgPSB7CisJCUkyQ19DT01NT05fTUFTS19TSF9MSVNUX0RDTjIoX19TSElGVCkKK307
CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNlX2kyY19tYXNrIGkyY19tYXNrcyA9IHsKKwkJSTJD
X0NPTU1PTl9NQVNLX1NIX0xJU1RfRENOMihfTUFTSykKK307CisKK3N0cnVjdCBkY2VfaTJjX2h3
ICpkY24yMF9pMmNfaHdfY3JlYXRlKAorCXN0cnVjdCBkY19jb250ZXh0ICpjdHgsCisJdWludDMy
X3QgaW5zdCkKK3sKKwlzdHJ1Y3QgZGNlX2kyY19odyAqZGNlX2kyY19odyA9CisJCWt6YWxsb2Mo
c2l6ZW9mKHN0cnVjdCBkY2VfaTJjX2h3KSwgR0ZQX0tFUk5FTCk7CisKKwlpZiAoIWRjZV9pMmNf
aHcpCisJCXJldHVybiBOVUxMOworCisJZGNuMl9pMmNfaHdfY29uc3RydWN0KGRjZV9pMmNfaHcs
IGN0eCwgaW5zdCwKKwkJCQkgICAgJmkyY19od19yZWdzW2luc3RdLCAmaTJjX3NoaWZ0cywgJmky
Y19tYXNrcyk7CisKKwlyZXR1cm4gZGNlX2kyY19odzsKK30KK3N0cnVjdCBtcGMgKmRjbjIwX21w
Y19jcmVhdGUoc3RydWN0IGRjX2NvbnRleHQgKmN0eCkKK3sKKwlzdHJ1Y3QgZGNuMjBfbXBjICpt
cGMyMCA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBkY24yMF9tcGMpLAorCQkJCQkgIEdGUF9LRVJO
RUwpOworCisJaWYgKCFtcGMyMCkKKwkJcmV0dXJuIE5VTEw7CisKKwlkY24yMF9tcGNfY29uc3Ry
dWN0KG1wYzIwLCBjdHgsCisJCQkmbXBjX3JlZ3MsCisJCQkmbXBjX3NoaWZ0LAorCQkJJm1wY19t
YXNrLAorCQkJNik7CisKKwlyZXR1cm4gJm1wYzIwLT5iYXNlOworfQorCitzdHJ1Y3QgaHViYnVi
ICpkY24yMF9odWJidWJfY3JlYXRlKHN0cnVjdCBkY19jb250ZXh0ICpjdHgpCit7CisJaW50IGk7
CisJc3RydWN0IGRjbjIwX2h1YmJ1YiAqaHViYnViID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IGRj
bjIwX2h1YmJ1YiksCisJCQkJCSAgR0ZQX0tFUk5FTCk7CisKKwlpZiAoIWh1YmJ1YikKKwkJcmV0
dXJuIE5VTEw7CisKKwlodWJidWIyX2NvbnN0cnVjdChodWJidWIsIGN0eCwKKwkJCSZodWJidWJf
cmVnLAorCQkJJmh1YmJ1Yl9zaGlmdCwKKwkJCSZodWJidWJfbWFzayk7CisKKwlmb3IgKGkgPSAw
OyBpIDwgcmVzX2NhcF9udjEwLm51bV92bWlkOyBpKyspIHsKKwkJc3RydWN0IGRjbjIwX3ZtaWQg
KnZtaWQgPSAmaHViYnViLT52bWlkW2ldOworCisJCXZtaWQtPmN0eCA9IGN0eDsKKworCQl2bWlk
LT5yZWdzID0gJnZtaWRfcmVnc1tpXTsKKwkJdm1pZC0+c2hpZnRzID0gJnZtaWRfc2hpZnRzOwor
CQl2bWlkLT5tYXNrcyA9ICZ2bWlkX21hc2tzOworCX0KKworCXJldHVybiAmaHViYnViLT5iYXNl
OworfQorCitzdHJ1Y3QgdGltaW5nX2dlbmVyYXRvciAqZGNuMjBfdGltaW5nX2dlbmVyYXRvcl9j
cmVhdGUoCisJCXN0cnVjdCBkY19jb250ZXh0ICpjdHgsCisJCXVpbnQzMl90IGluc3RhbmNlKQor
eworCXN0cnVjdCBvcHRjICp0Z24xMCA9CisJCWt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBvcHRjKSwg
R0ZQX0tFUk5FTCk7CisKKwlpZiAoIXRnbjEwKQorCQlyZXR1cm4gTlVMTDsKKworCXRnbjEwLT5i
YXNlLmluc3QgPSBpbnN0YW5jZTsKKwl0Z24xMC0+YmFzZS5jdHggPSBjdHg7CisKKwl0Z24xMC0+
dGdfcmVncyA9ICZ0Z19yZWdzW2luc3RhbmNlXTsKKwl0Z24xMC0+dGdfc2hpZnQgPSAmdGdfc2hp
ZnQ7CisJdGduMTAtPnRnX21hc2sgPSAmdGdfbWFzazsKKworCWRjbjIwX3RpbWluZ19nZW5lcmF0
b3JfaW5pdCh0Z24xMCk7CisKKwlyZXR1cm4gJnRnbjEwLT5iYXNlOworfQorCitzdGF0aWMgY29u
c3Qgc3RydWN0IGVuY29kZXJfZmVhdHVyZV9zdXBwb3J0IGxpbmtfZW5jX2ZlYXR1cmUgPSB7CisJ
CS5tYXhfaGRtaV9kZWVwX2NvbG9yID0gQ09MT1JfREVQVEhfMTIxMjEyLAorCQkubWF4X2hkbWlf
cGl4ZWxfY2xvY2sgPSA2MDAwMDAsCisJCS5oZG1pX3ljYmNyNDIwX3N1cHBvcnRlZCA9IHRydWUs
CisJCS5kcF95Y2JjcjQyMF9zdXBwb3J0ZWQgPSB0cnVlLAorCQkuZmxhZ3MuYml0cy5JU19IQlIy
X0NBUEFCTEUgPSB0cnVlLAorCQkuZmxhZ3MuYml0cy5JU19IQlIzX0NBUEFCTEUgPSB0cnVlLAor
CQkuZmxhZ3MuYml0cy5JU19UUFMzX0NBUEFCTEUgPSB0cnVlLAorCQkuZmxhZ3MuYml0cy5JU19U
UFM0X0NBUEFCTEUgPSB0cnVlCit9OworCitzdHJ1Y3QgbGlua19lbmNvZGVyICpkY24yMF9saW5r
X2VuY29kZXJfY3JlYXRlKAorCWNvbnN0IHN0cnVjdCBlbmNvZGVyX2luaXRfZGF0YSAqZW5jX2lu
aXRfZGF0YSkKK3sKKwlzdHJ1Y3QgZGNuMjBfbGlua19lbmNvZGVyICplbmMyMCA9CisJCWt6YWxs
b2Moc2l6ZW9mKHN0cnVjdCBkY24yMF9saW5rX2VuY29kZXIpLCBHRlBfS0VSTkVMKTsKKworCWlm
ICghZW5jMjApCisJCXJldHVybiBOVUxMOworCisJZGNuMjBfbGlua19lbmNvZGVyX2NvbnN0cnVj
dChlbmMyMCwKKwkJCQkgICAgICBlbmNfaW5pdF9kYXRhLAorCQkJCSAgICAgICZsaW5rX2VuY19m
ZWF0dXJlLAorCQkJCSAgICAgICZsaW5rX2VuY19yZWdzW2VuY19pbml0X2RhdGEtPnRyYW5zbWl0
dGVyXSwKKwkJCQkgICAgICAmbGlua19lbmNfYXV4X3JlZ3NbZW5jX2luaXRfZGF0YS0+Y2hhbm5l
bCAtIDFdLAorCQkJCSAgICAgICZsaW5rX2VuY19ocGRfcmVnc1tlbmNfaW5pdF9kYXRhLT5ocGRf
c291cmNlXSwKKwkJCQkgICAgICAmbGVfc2hpZnQsCisJCQkJICAgICAgJmxlX21hc2spOworCisJ
cmV0dXJuICZlbmMyMC0+ZW5jMTAuYmFzZTsKK30KKworc3RydWN0IGNsb2NrX3NvdXJjZSAqZGNu
MjBfY2xvY2tfc291cmNlX2NyZWF0ZSgKKwlzdHJ1Y3QgZGNfY29udGV4dCAqY3R4LAorCXN0cnVj
dCBkY19iaW9zICpiaW9zLAorCWVudW0gY2xvY2tfc291cmNlX2lkIGlkLAorCWNvbnN0IHN0cnVj
dCBkY2UxMTBfY2xrX3NyY19yZWdzICpyZWdzLAorCWJvb2wgZHBfY2xrX3NyYykKK3sKKwlzdHJ1
Y3QgZGNlMTEwX2Nsa19zcmMgKmNsa19zcmMgPQorCQlremFsbG9jKHNpemVvZihzdHJ1Y3QgZGNl
MTEwX2Nsa19zcmMpLCBHRlBfS0VSTkVMKTsKKworCWlmICghY2xrX3NyYykKKwkJcmV0dXJuIE5V
TEw7CisKKwlpZiAoZGNuMjBfY2xrX3NyY19jb25zdHJ1Y3QoY2xrX3NyYywgY3R4LCBiaW9zLCBp
ZCwKKwkJCXJlZ3MsICZjc19zaGlmdCwgJmNzX21hc2spKSB7CisJCWNsa19zcmMtPmJhc2UuZHBf
Y2xrX3NyYyA9IGRwX2Nsa19zcmM7CisJCXJldHVybiAmY2xrX3NyYy0+YmFzZTsKKwl9CisKKwlC
UkVBS19UT19ERUJVR0dFUigpOworCXJldHVybiBOVUxMOworfQorCitzdGF0aWMgdm9pZCByZWFk
X2RjZV9zdHJhcHMoCisJc3RydWN0IGRjX2NvbnRleHQgKmN0eCwKKwlzdHJ1Y3QgcmVzb3VyY2Vf
c3RyYXBzICpzdHJhcHMpCit7CisJZ2VuZXJpY19yZWdfZ2V0KGN0eCwgbW1EQ19QSU5TVFJBUFMg
KyBCQVNFKG1tRENfUElOU1RSQVBTX0JBU0VfSURYKSwKKwkJRk4oRENfUElOU1RSQVBTLCBEQ19Q
SU5TVFJBUFNfQVVESU8pLCAmc3RyYXBzLT5kY19waW5zdHJhcHNfYXVkaW8pOworfQorCitzdGF0
aWMgc3RydWN0IGF1ZGlvICpkY24yMF9jcmVhdGVfYXVkaW8oCisJCXN0cnVjdCBkY19jb250ZXh0
ICpjdHgsIHVuc2lnbmVkIGludCBpbnN0KQoreworCXJldHVybiBkY2VfYXVkaW9fY3JlYXRlKGN0
eCwgaW5zdCwKKwkJCSZhdWRpb19yZWdzW2luc3RdLCAmYXVkaW9fc2hpZnQsICZhdWRpb19tYXNr
KTsKK30KKworc3RydWN0IHN0cmVhbV9lbmNvZGVyICpkY24yMF9zdHJlYW1fZW5jb2Rlcl9jcmVh
dGUoCisJZW51bSBlbmdpbmVfaWQgZW5nX2lkLAorCXN0cnVjdCBkY19jb250ZXh0ICpjdHgpCit7
CisJc3RydWN0IGRjbjEwX3N0cmVhbV9lbmNvZGVyICplbmMxID0KKwkJa3phbGxvYyhzaXplb2Yo
c3RydWN0IGRjbjEwX3N0cmVhbV9lbmNvZGVyKSwgR0ZQX0tFUk5FTCk7CisKKwlpZiAoIWVuYzEp
CisJCXJldHVybiBOVUxMOworCisJZGNuMjBfc3RyZWFtX2VuY29kZXJfY29uc3RydWN0KGVuYzEs
IGN0eCwgY3R4LT5kY19iaW9zLCBlbmdfaWQsCisJCQkJCSZzdHJlYW1fZW5jX3JlZ3NbZW5nX2lk
XSwKKwkJCQkJJnNlX3NoaWZ0LCAmc2VfbWFzayk7CisKKwlyZXR1cm4gJmVuYzEtPmJhc2U7Cit9
CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGNlX2h3c2VxX3JlZ2lzdGVycyBod3NlcV9yZWcgPSB7
CisJCUhXU0VRX0RDTjJfUkVHX0xJU1QoKQorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkY2Vf
aHdzZXFfc2hpZnQgaHdzZXFfc2hpZnQgPSB7CisJCUhXU0VRX0RDTjJfTUFTS19TSF9MSVNUKF9f
U0hJRlQpCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGRjZV9od3NlcV9tYXNrIGh3c2VxX21h
c2sgPSB7CisJCUhXU0VRX0RDTjJfTUFTS19TSF9MSVNUKF9NQVNLKQorfTsKKworc3RydWN0IGRj
ZV9od3NlcSAqZGNuMjBfaHdzZXFfY3JlYXRlKAorCXN0cnVjdCBkY19jb250ZXh0ICpjdHgpCit7
CisJc3RydWN0IGRjZV9od3NlcSAqaHdzID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IGRjZV9od3Nl
cSksIEdGUF9LRVJORUwpOworCisJaWYgKGh3cykgeworCQlod3MtPmN0eCA9IGN0eDsKKwkJaHdz
LT5yZWdzID0gJmh3c2VxX3JlZzsKKwkJaHdzLT5zaGlmdHMgPSAmaHdzZXFfc2hpZnQ7CisJCWh3
cy0+bWFza3MgPSAmaHdzZXFfbWFzazsKKwl9CisJcmV0dXJuIGh3czsKK30KKworc3RhdGljIGNv
bnN0IHN0cnVjdCByZXNvdXJjZV9jcmVhdGVfZnVuY3MgcmVzX2NyZWF0ZV9mdW5jcyA9IHsKKwku
cmVhZF9kY2Vfc3RyYXBzID0gcmVhZF9kY2Vfc3RyYXBzLAorCS5jcmVhdGVfYXVkaW8gPSBkY24y
MF9jcmVhdGVfYXVkaW8sCisJLmNyZWF0ZV9zdHJlYW1fZW5jb2RlciA9IGRjbjIwX3N0cmVhbV9l
bmNvZGVyX2NyZWF0ZSwKKwkuY3JlYXRlX2h3c2VxID0gZGNuMjBfaHdzZXFfY3JlYXRlLAorfTsK
Kworc3RhdGljIGNvbnN0IHN0cnVjdCByZXNvdXJjZV9jcmVhdGVfZnVuY3MgcmVzX2NyZWF0ZV9t
YXhpbXVzX2Z1bmNzID0geworCS5yZWFkX2RjZV9zdHJhcHMgPSBOVUxMLAorCS5jcmVhdGVfYXVk
aW8gPSBOVUxMLAorCS5jcmVhdGVfc3RyZWFtX2VuY29kZXIgPSBOVUxMLAorCS5jcmVhdGVfaHdz
ZXEgPSBkY24yMF9od3NlcV9jcmVhdGUsCit9OworCit2b2lkIGRjbjIwX2Nsb2NrX3NvdXJjZV9k
ZXN0cm95KHN0cnVjdCBjbG9ja19zb3VyY2UgKipjbGtfc3JjKQoreworCWtmcmVlKFRPX0RDRTEx
MF9DTEtfU1JDKCpjbGtfc3JjKSk7CisJKmNsa19zcmMgPSBOVUxMOworfQorCisKK3N0YXRpYyB2
b2lkIGRlc3RydWN0KHN0cnVjdCBkY24yMF9yZXNvdXJjZV9wb29sICpwb29sKQoreworCXVuc2ln
bmVkIGludCBpOworCisJZm9yIChpID0gMDsgaSA8IHBvb2wtPmJhc2Uuc3RyZWFtX2VuY19jb3Vu
dDsgaSsrKSB7CisJCWlmIChwb29sLT5iYXNlLnN0cmVhbV9lbmNbaV0gIT0gTlVMTCkgeworCQkJ
a2ZyZWUoRENOMTBTVFJFTkNfRlJPTV9TVFJFTkMocG9vbC0+YmFzZS5zdHJlYW1fZW5jW2ldKSk7
CisJCQlwb29sLT5iYXNlLnN0cmVhbV9lbmNbaV0gPSBOVUxMOworCQl9CisJfQorCisKKwlpZiAo
cG9vbC0+YmFzZS5tcGMgIT0gTlVMTCkgeworCQlrZnJlZShUT19EQ04yMF9NUEMocG9vbC0+YmFz
ZS5tcGMpKTsKKwkJcG9vbC0+YmFzZS5tcGMgPSBOVUxMOworCX0KKwlpZiAocG9vbC0+YmFzZS5o
dWJidWIgIT0gTlVMTCkgeworCQlrZnJlZShwb29sLT5iYXNlLmh1YmJ1Yik7CisJCXBvb2wtPmJh
c2UuaHViYnViID0gTlVMTDsKKwl9CisJZm9yIChpID0gMDsgaSA8IHBvb2wtPmJhc2UucGlwZV9j
b3VudDsgaSsrKSB7CisJCWlmIChwb29sLT5iYXNlLmRwcHNbaV0gIT0gTlVMTCkKKwkJCWRjbjIw
X2RwcF9kZXN0cm95KCZwb29sLT5iYXNlLmRwcHNbaV0pOworCisJCWlmIChwb29sLT5iYXNlLmlw
cHNbaV0gIT0gTlVMTCkKKwkJCXBvb2wtPmJhc2UuaXBwc1tpXS0+ZnVuY3MtPmlwcF9kZXN0cm95
KCZwb29sLT5iYXNlLmlwcHNbaV0pOworCisJCWlmIChwb29sLT5iYXNlLmh1YnBzW2ldICE9IE5V
TEwpIHsKKwkJCWtmcmVlKFRPX0RDTjIwX0hVQlAocG9vbC0+YmFzZS5odWJwc1tpXSkpOworCQkJ
cG9vbC0+YmFzZS5odWJwc1tpXSA9IE5VTEw7CisJCX0KKworCQlpZiAocG9vbC0+YmFzZS5pcnFz
ICE9IE5VTEwpIHsKKwkJCWRhbF9pcnFfc2VydmljZV9kZXN0cm95KCZwb29sLT5iYXNlLmlycXMp
OworCQl9CisJfQorCisJZm9yIChpID0gMDsgaSA8IHBvb2wtPmJhc2UucmVzX2NhcC0+bnVtX2Rk
YzsgaSsrKSB7CisJCWlmIChwb29sLT5iYXNlLmVuZ2luZXNbaV0gIT0gTlVMTCkKKwkJCWRjZTEx
MF9lbmdpbmVfZGVzdHJveSgmcG9vbC0+YmFzZS5lbmdpbmVzW2ldKTsKKwkJaWYgKHBvb2wtPmJh
c2UuaHdfaTJjc1tpXSAhPSBOVUxMKSB7CisJCQlrZnJlZShwb29sLT5iYXNlLmh3X2kyY3NbaV0p
OworCQkJcG9vbC0+YmFzZS5od19pMmNzW2ldID0gTlVMTDsKKwkJfQorCQlpZiAocG9vbC0+YmFz
ZS5zd19pMmNzW2ldICE9IE5VTEwpIHsKKwkJCWtmcmVlKHBvb2wtPmJhc2Uuc3dfaTJjc1tpXSk7
CisJCQlwb29sLT5iYXNlLnN3X2kyY3NbaV0gPSBOVUxMOworCQl9CisJfQorCisJZm9yIChpID0g
MDsgaSA8IHBvb2wtPmJhc2UucmVzX2NhcC0+bnVtX29wcDsgaSsrKSB7CisJCWlmIChwb29sLT5i
YXNlLm9wcHNbaV0gIT0gTlVMTCkKKwkJCXBvb2wtPmJhc2Uub3Bwc1tpXS0+ZnVuY3MtPm9wcF9k
ZXN0cm95KCZwb29sLT5iYXNlLm9wcHNbaV0pOworCX0KKworCWZvciAoaSA9IDA7IGkgPCBwb29s
LT5iYXNlLnJlc19jYXAtPm51bV90aW1pbmdfZ2VuZXJhdG9yOyBpKyspIHsKKwkJaWYgKHBvb2wt
PmJhc2UudGltaW5nX2dlbmVyYXRvcnNbaV0gIT0gTlVMTCkJeworCQkJa2ZyZWUoRENOMTBUR19G
Uk9NX1RHKHBvb2wtPmJhc2UudGltaW5nX2dlbmVyYXRvcnNbaV0pKTsKKwkJCXBvb2wtPmJhc2Uu
dGltaW5nX2dlbmVyYXRvcnNbaV0gPSBOVUxMOworCQl9CisJfQorCisJZm9yIChpID0gMDsgaSA8
IHBvb2wtPmJhc2UuYXVkaW9fY291bnQ7IGkrKykgeworCQlpZiAocG9vbC0+YmFzZS5hdWRpb3Nb
aV0pCisJCQlkY2VfYXVkX2Rlc3Ryb3koJnBvb2wtPmJhc2UuYXVkaW9zW2ldKTsKKwl9CisKKwlm
b3IgKGkgPSAwOyBpIDwgcG9vbC0+YmFzZS5jbGtfc3JjX2NvdW50OyBpKyspIHsKKwkJaWYgKHBv
b2wtPmJhc2UuY2xvY2tfc291cmNlc1tpXSAhPSBOVUxMKSB7CisJCQlkY24yMF9jbG9ja19zb3Vy
Y2VfZGVzdHJveSgmcG9vbC0+YmFzZS5jbG9ja19zb3VyY2VzW2ldKTsKKwkJCXBvb2wtPmJhc2Uu
Y2xvY2tfc291cmNlc1tpXSA9IE5VTEw7CisJCX0KKwl9CisKKwlpZiAocG9vbC0+YmFzZS5kcF9j
bG9ja19zb3VyY2UgIT0gTlVMTCkgeworCQlkY24yMF9jbG9ja19zb3VyY2VfZGVzdHJveSgmcG9v
bC0+YmFzZS5kcF9jbG9ja19zb3VyY2UpOworCQlwb29sLT5iYXNlLmRwX2Nsb2NrX3NvdXJjZSA9
IE5VTEw7CisJfQorCisKKwlpZiAocG9vbC0+YmFzZS5hYm0gIT0gTlVMTCkKKwkJZGNlX2FibV9k
ZXN0cm95KCZwb29sLT5iYXNlLmFibSk7CisKKwlpZiAocG9vbC0+YmFzZS5kbWN1ICE9IE5VTEwp
CisJCWRjZV9kbWN1X2Rlc3Ryb3koJnBvb2wtPmJhc2UuZG1jdSk7CisKKwlpZiAocG9vbC0+YmFz
ZS5kY2NnICE9IE5VTEwpCisJCWRjbl9kY2NnX2Rlc3Ryb3koJnBvb2wtPmJhc2UuZGNjZyk7CisK
KwlpZiAocG9vbC0+YmFzZS5wcF9zbXUgIT0gTlVMTCkKKwkJZGNuMjBfcHBfc211X2Rlc3Ryb3ko
JnBvb2wtPmJhc2UucHBfc211KTsKKworfQorCitzdHJ1Y3QgaHVicCAqZGNuMjBfaHVicF9jcmVh
dGUoCisJc3RydWN0IGRjX2NvbnRleHQgKmN0eCwKKwl1aW50MzJfdCBpbnN0KQoreworCXN0cnVj
dCBkY24yMF9odWJwICpodWJwMiA9CisJCWt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBkY24yMF9odWJw
KSwgR0ZQX0tFUk5FTCk7CisKKwlpZiAoIWh1YnAyKQorCQlyZXR1cm4gTlVMTDsKKworCWlmICho
dWJwMl9jb25zdHJ1Y3QoaHVicDIsIGN0eCwgaW5zdCwKKwkJCSZodWJwX3JlZ3NbaW5zdF0sICZo
dWJwX3NoaWZ0LCAmaHVicF9tYXNrKSkKKwkJcmV0dXJuICZodWJwMi0+YmFzZTsKKworCUJSRUFL
X1RPX0RFQlVHR0VSKCk7CisJa2ZyZWUoaHVicDIpOworCXJldHVybiBOVUxMOworfQorCitzdGF0
aWMgdm9pZCBnZXRfcGl4ZWxfY2xvY2tfcGFyYW1ldGVycygKKwlzdHJ1Y3QgcGlwZV9jdHggKnBp
cGVfY3R4LAorCXN0cnVjdCBwaXhlbF9jbGtfcGFyYW1zICpwaXhlbF9jbGtfcGFyYW1zKQorewor
CWNvbnN0IHN0cnVjdCBkY19zdHJlYW1fc3RhdGUgKnN0cmVhbSA9IHBpcGVfY3R4LT5zdHJlYW07
CisJYm9vbCBvZG1fY29tYmluZSA9IGRjX3Jlc19nZXRfb2RtX2JvdHRvbV9waXBlKHBpcGVfY3R4
KSAhPSBOVUxMOworCisJcGl4ZWxfY2xrX3BhcmFtcy0+cmVxdWVzdGVkX3BpeF9jbGtfMTAwaHog
PSBzdHJlYW0tPnRpbWluZy5waXhfY2xrXzEwMGh6OworCXBpeGVsX2Nsa19wYXJhbXMtPmVuY29k
ZXJfb2JqZWN0X2lkID0gc3RyZWFtLT5saW5rLT5saW5rX2VuYy0+aWQ7CisJcGl4ZWxfY2xrX3Bh
cmFtcy0+c2lnbmFsX3R5cGUgPSBwaXBlX2N0eC0+c3RyZWFtLT5zaWduYWw7CisJcGl4ZWxfY2xr
X3BhcmFtcy0+Y29udHJvbGxlcl9pZCA9IHBpcGVfY3R4LT5zdHJlYW1fcmVzLnRnLT5pbnN0ICsg
MTsKKwkvKiBUT0RPOiB1bi1oYXJkY29kZSovCisJcGl4ZWxfY2xrX3BhcmFtcy0+cmVxdWVzdGVk
X3N5bV9jbGsgPSBMSU5LX1JBVEVfTE9XICoKKwkJTElOS19SQVRFX1JFRl9GUkVRX0lOX0tIWjsK
KwlwaXhlbF9jbGtfcGFyYW1zLT5mbGFncy5FTkFCTEVfU1MgPSAwOworCXBpeGVsX2Nsa19wYXJh
bXMtPmNvbG9yX2RlcHRoID0KKwkJc3RyZWFtLT50aW1pbmcuZGlzcGxheV9jb2xvcl9kZXB0aDsK
KwlwaXhlbF9jbGtfcGFyYW1zLT5mbGFncy5ESVNQTEFZX0JMQU5LRUQgPSAxOworCXBpeGVsX2Ns
a19wYXJhbXMtPnBpeGVsX2VuY29kaW5nID0gc3RyZWFtLT50aW1pbmcucGl4ZWxfZW5jb2Rpbmc7
CisKKwlpZiAoc3RyZWFtLT50aW1pbmcucGl4ZWxfZW5jb2RpbmcgPT0gUElYRUxfRU5DT0RJTkdf
WUNCQ1I0MjIpCisJCXBpeGVsX2Nsa19wYXJhbXMtPmNvbG9yX2RlcHRoID0gQ09MT1JfREVQVEhf
ODg4OworCisJaWYgKG9wdGMxX2lzX3R3b19waXhlbHNfcGVyX2NvbnRhaW50ZXIoJnN0cmVhbS0+
dGltaW5nKSB8fCBvZG1fY29tYmluZSkKKwkJcGl4ZWxfY2xrX3BhcmFtcy0+cmVxdWVzdGVkX3Bp
eF9jbGtfMTAwaHogLz0gMjsKKworCWlmIChzdHJlYW0tPnRpbWluZy50aW1pbmdfM2RfZm9ybWF0
ID09IFRJTUlOR18zRF9GT1JNQVRfSFdfRlJBTUVfUEFDS0lORykKKwkJcGl4ZWxfY2xrX3BhcmFt
cy0+cmVxdWVzdGVkX3BpeF9jbGtfMTAwaHogKj0gMjsKKworfQorCitzdGF0aWMgdm9pZCBidWls
ZF9jbGFtcGluZ19wYXJhbXMoc3RydWN0IGRjX3N0cmVhbV9zdGF0ZSAqc3RyZWFtKQoreworCXN0
cmVhbS0+Y2xhbXBpbmcuY2xhbXBpbmdfbGV2ZWwgPSBDTEFNUElOR19GVUxMX1JBTkdFOworCXN0
cmVhbS0+Y2xhbXBpbmcuY19kZXB0aCA9IHN0cmVhbS0+dGltaW5nLmRpc3BsYXlfY29sb3JfZGVw
dGg7CisJc3RyZWFtLT5jbGFtcGluZy5waXhlbF9lbmNvZGluZyA9IHN0cmVhbS0+dGltaW5nLnBp
eGVsX2VuY29kaW5nOworfQorCitzdGF0aWMgZW51bSBkY19zdGF0dXMgYnVpbGRfcGlwZV9od19w
YXJhbShzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KQoreworCisJZ2V0X3BpeGVsX2Nsb2NrX3Bh
cmFtZXRlcnMocGlwZV9jdHgsICZwaXBlX2N0eC0+c3RyZWFtX3Jlcy5waXhfY2xrX3BhcmFtcyk7
CisKKwlwaXBlX2N0eC0+Y2xvY2tfc291cmNlLT5mdW5jcy0+Z2V0X3BpeF9jbGtfZGl2aWRlcnMo
CisJCXBpcGVfY3R4LT5jbG9ja19zb3VyY2UsCisJCSZwaXBlX2N0eC0+c3RyZWFtX3Jlcy5waXhf
Y2xrX3BhcmFtcywKKwkJJnBpcGVfY3R4LT5wbGxfc2V0dGluZ3MpOworCisJcGlwZV9jdHgtPnN0
cmVhbS0+Y2xhbXBpbmcucGl4ZWxfZW5jb2RpbmcgPSBwaXBlX2N0eC0+c3RyZWFtLT50aW1pbmcu
cGl4ZWxfZW5jb2Rpbmc7CisKKwlyZXNvdXJjZV9idWlsZF9iaXRfZGVwdGhfcmVkdWN0aW9uX3Bh
cmFtcyhwaXBlX2N0eC0+c3RyZWFtLAorCQkJCQkmcGlwZV9jdHgtPnN0cmVhbS0+Yml0X2RlcHRo
X3BhcmFtcyk7CisJYnVpbGRfY2xhbXBpbmdfcGFyYW1zKHBpcGVfY3R4LT5zdHJlYW0pOworCisJ
cmV0dXJuIERDX09LOworfQorCitlbnVtIGRjX3N0YXR1cyBkY24yMF9idWlsZF9tYXBwZWRfcmVz
b3VyY2UoY29uc3Qgc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3N0YXRlICpjb250ZXh0LCBzdHJ1
Y3QgZGNfc3RyZWFtX3N0YXRlICpzdHJlYW0pCit7CisJZW51bSBkY19zdGF0dXMgc3RhdHVzID0g
RENfT0s7CisJc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCA9IHJlc291cmNlX2dldF9oZWFkX3Bp
cGVfZm9yX3N0cmVhbSgmY29udGV4dC0+cmVzX2N0eCwgc3RyZWFtKTsKKworCS8qVE9ETyBTZWVt
cyB1bm5lZWRlZCBhbnltb3JlICovCisJLyoJaWYgKG9sZF9jb250ZXh0ICYmIHJlc291cmNlX2lz
X3N0cmVhbV91bmNoYW5nZWQob2xkX2NvbnRleHQsIHN0cmVhbSkpIHsKKwkJCWlmIChzdHJlYW0g
IT0gTlVMTCAmJiBvbGRfY29udGV4dC0+c3RyZWFtc1tpXSAhPSBOVUxMKSB7CisJCQkJIHRvZG86
IHNob3VsZG4ndCBoYXZlIHRvIGNvcHkgbWlzc2luZyBwYXJhbWV0ZXIgaGVyZQorCQkJCXJlc291
cmNlX2J1aWxkX2JpdF9kZXB0aF9yZWR1Y3Rpb25fcGFyYW1zKHN0cmVhbSwKKwkJCQkJCSZzdHJl
YW0tPmJpdF9kZXB0aF9wYXJhbXMpOworCQkJCXN0cmVhbS0+Y2xhbXBpbmcucGl4ZWxfZW5jb2Rp
bmcgPQorCQkJCQkJc3RyZWFtLT50aW1pbmcucGl4ZWxfZW5jb2Rpbmc7CisKKwkJCQlyZXNvdXJj
ZV9idWlsZF9iaXRfZGVwdGhfcmVkdWN0aW9uX3BhcmFtcyhzdHJlYW0sCisJCQkJCQkJCSZzdHJl
YW0tPmJpdF9kZXB0aF9wYXJhbXMpOworCQkJCWJ1aWxkX2NsYW1waW5nX3BhcmFtcyhzdHJlYW0p
OworCisJCQkJY29udGludWU7CisJCQl9CisJCX0KKwkqLworCisJaWYgKCFwaXBlX2N0eCkKKwkJ
cmV0dXJuIERDX0VSUk9SX1VORVhQRUNURUQ7CisKKworCXN0YXR1cyA9IGJ1aWxkX3BpcGVfaHdf
cGFyYW0ocGlwZV9jdHgpOworCisJcmV0dXJuIHN0YXR1czsKK30KKworCitlbnVtIGRjX3N0YXR1
cyBkY24yMF9hZGRfc3RyZWFtX3RvX2N0eChzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgZGNfc3RhdGUg
Km5ld19jdHgsIHN0cnVjdCBkY19zdHJlYW1fc3RhdGUgKmRjX3N0cmVhbSkKK3sKKwllbnVtIGRj
X3N0YXR1cyByZXN1bHQgPSBEQ19FUlJPUl9VTkVYUEVDVEVEOworCisJcmVzdWx0ID0gcmVzb3Vy
Y2VfbWFwX3Bvb2xfcmVzb3VyY2VzKGRjLCBuZXdfY3R4LCBkY19zdHJlYW0pOworCisJaWYgKHJl
c3VsdCA9PSBEQ19PSykKKwkJcmVzdWx0ID0gcmVzb3VyY2VfbWFwX3BoeV9jbG9ja19yZXNvdXJj
ZXMoZGMsIG5ld19jdHgsIGRjX3N0cmVhbSk7CisKKworCWlmIChyZXN1bHQgPT0gRENfT0spCisJ
CXJlc3VsdCA9IGRjbjIwX2J1aWxkX21hcHBlZF9yZXNvdXJjZShkYywgbmV3X2N0eCwgZGNfc3Ry
ZWFtKTsKKworCXJldHVybiByZXN1bHQ7Cit9CisKKworZW51bSBkY19zdGF0dXMgZGNuMjBfcmVt
b3ZlX3N0cmVhbV9mcm9tX2N0eChzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgZGNfc3RhdGUgKm5ld19j
dHgsIHN0cnVjdCBkY19zdHJlYW1fc3RhdGUgKmRjX3N0cmVhbSkKK3sKKwlzdHJ1Y3QgcGlwZV9j
dHggKnBpcGVfY3R4ID0gTlVMTDsKKwlpbnQgaTsKKworCS8qIFJlbW92ZSBEU0MgKi8KKwlmb3Ig
KGkgPSAwOyBpIDwgTUFYX1BJUEVTOyBpKyspIHsKKwkJaWYgKG5ld19jdHgtPnJlc19jdHgucGlw
ZV9jdHhbaV0uc3RyZWFtID09IGRjX3N0cmVhbSAmJiAhbmV3X2N0eC0+cmVzX2N0eC5waXBlX2N0
eFtpXS50b3BfcGlwZSkgeworCQkJcGlwZV9jdHggPSAmbmV3X2N0eC0+cmVzX2N0eC5waXBlX2N0
eFtpXTsKKwkJCWJyZWFrOworCQl9CisJfQorCisJaWYgKCFwaXBlX2N0eCkKKwkJcmV0dXJuIERD
X0VSUk9SX1VORVhQRUNURUQ7CisKKworCXJldHVybiBEQ19PSzsKK30KKworCitzdGF0aWMgdm9p
ZCBzd2l6emxlX3RvX2RtbF9wYXJhbXMoCisJCWVudW0gc3dpenpsZV9tb2RlX3ZhbHVlcyBzd2l6
emxlLAorCQl1bnNpZ25lZCBpbnQgKnN3X21vZGUpCit7CisJc3dpdGNoIChzd2l6emxlKSB7CisJ
Y2FzZSBEQ19TV19MSU5FQVI6CisJCSpzd19tb2RlID0gZG1fc3dfbGluZWFyOworCQlicmVhazsK
KwljYXNlIERDX1NXXzRLQl9TOgorCQkqc3dfbW9kZSA9IGRtX3N3XzRrYl9zOworCQlicmVhazsK
KwljYXNlIERDX1NXXzRLQl9TX1g6CisJCSpzd19tb2RlID0gZG1fc3dfNGtiX3NfeDsKKwkJYnJl
YWs7CisJY2FzZSBEQ19TV180S0JfRDoKKwkJKnN3X21vZGUgPSBkbV9zd180a2JfZDsKKwkJYnJl
YWs7CisJY2FzZSBEQ19TV180S0JfRF9YOgorCQkqc3dfbW9kZSA9IGRtX3N3XzRrYl9kX3g7CisJ
CWJyZWFrOworCWNhc2UgRENfU1dfNjRLQl9TOgorCQkqc3dfbW9kZSA9IGRtX3N3XzY0a2JfczsK
KwkJYnJlYWs7CisJY2FzZSBEQ19TV182NEtCX1NfWDoKKwkJKnN3X21vZGUgPSBkbV9zd182NGti
X3NfeDsKKwkJYnJlYWs7CisJY2FzZSBEQ19TV182NEtCX1NfVDoKKwkJKnN3X21vZGUgPSBkbV9z
d182NGtiX3NfdDsKKwkJYnJlYWs7CisJY2FzZSBEQ19TV182NEtCX0Q6CisJCSpzd19tb2RlID0g
ZG1fc3dfNjRrYl9kOworCQlicmVhazsKKwljYXNlIERDX1NXXzY0S0JfRF9YOgorCQkqc3dfbW9k
ZSA9IGRtX3N3XzY0a2JfZF94OworCQlicmVhazsKKwljYXNlIERDX1NXXzY0S0JfRF9UOgorCQkq
c3dfbW9kZSA9IGRtX3N3XzY0a2JfZF90OworCQlicmVhazsKKwljYXNlIERDX1NXXzY0S0JfUl9Y
OgorCQkqc3dfbW9kZSA9IGRtX3N3XzY0a2Jfcl94OworCQlicmVhazsKKwljYXNlIERDX1NXX1ZB
Ul9TOgorCQkqc3dfbW9kZSA9IGRtX3N3X3Zhcl9zOworCQlicmVhazsKKwljYXNlIERDX1NXX1ZB
Ul9TX1g6CisJCSpzd19tb2RlID0gZG1fc3dfdmFyX3NfeDsKKwkJYnJlYWs7CisJY2FzZSBEQ19T
V19WQVJfRDoKKwkJKnN3X21vZGUgPSBkbV9zd192YXJfZDsKKwkJYnJlYWs7CisJY2FzZSBEQ19T
V19WQVJfRF9YOgorCQkqc3dfbW9kZSA9IGRtX3N3X3Zhcl9kX3g7CisJCWJyZWFrOworCisJZGVm
YXVsdDoKKwkJQVNTRVJUKDApOyAvKiBOb3Qgc3VwcG9ydGVkICovCisJCWJyZWFrOworCX0KK30K
Kworc3RhdGljIGJvb2wgZGNuMjBfc3BsaXRfc3RyZWFtX2Zvcl9jb21iaW5lKAorCQlzdHJ1Y3Qg
cmVzb3VyY2VfY29udGV4dCAqcmVzX2N0eCwKKwkJY29uc3Qgc3RydWN0IHJlc291cmNlX3Bvb2wg
KnBvb2wsCisJCXN0cnVjdCBwaXBlX2N0eCAqcHJpbWFyeV9waXBlLAorCQlzdHJ1Y3QgcGlwZV9j
dHggKnNlY29uZGFyeV9waXBlLAorCQlib29sIGlzX29kbV9jb21iaW5lKQoreworCWludCBwaXBl
X2lkeCA9IHNlY29uZGFyeV9waXBlLT5waXBlX2lkeDsKKwlzdHJ1Y3Qgc2NhbGVyX2RhdGEgKnNk
ID0gJnByaW1hcnlfcGlwZS0+cGxhbmVfcmVzLnNjbF9kYXRhOworCXN0cnVjdCBwaXBlX2N0eCAq
c2VjX2JvdF9waXBlID0gc2Vjb25kYXJ5X3BpcGUtPmJvdHRvbV9waXBlOworCWludCBuZXdfd2lk
dGg7CisKKwkqc2Vjb25kYXJ5X3BpcGUgPSAqcHJpbWFyeV9waXBlOworCXNlY29uZGFyeV9waXBl
LT5ib3R0b21fcGlwZSA9IHNlY19ib3RfcGlwZTsKKworCXNlY29uZGFyeV9waXBlLT5waXBlX2lk
eCA9IHBpcGVfaWR4OworCXNlY29uZGFyeV9waXBlLT5wbGFuZV9yZXMubWkgPSBwb29sLT5taXNb
c2Vjb25kYXJ5X3BpcGUtPnBpcGVfaWR4XTsKKwlzZWNvbmRhcnlfcGlwZS0+cGxhbmVfcmVzLmh1
YnAgPSBwb29sLT5odWJwc1tzZWNvbmRhcnlfcGlwZS0+cGlwZV9pZHhdOworCXNlY29uZGFyeV9w
aXBlLT5wbGFuZV9yZXMuaXBwID0gcG9vbC0+aXBwc1tzZWNvbmRhcnlfcGlwZS0+cGlwZV9pZHhd
OworCXNlY29uZGFyeV9waXBlLT5wbGFuZV9yZXMueGZtID0gcG9vbC0+dHJhbnNmb3Jtc1tzZWNv
bmRhcnlfcGlwZS0+cGlwZV9pZHhdOworCXNlY29uZGFyeV9waXBlLT5wbGFuZV9yZXMuZHBwID0g
cG9vbC0+ZHBwc1tzZWNvbmRhcnlfcGlwZS0+cGlwZV9pZHhdOworCXNlY29uZGFyeV9waXBlLT5w
bGFuZV9yZXMubXBjY19pbnN0ID0gcG9vbC0+ZHBwc1tzZWNvbmRhcnlfcGlwZS0+cGlwZV9pZHhd
LT5pbnN0OworCWlmIChwcmltYXJ5X3BpcGUtPmJvdHRvbV9waXBlICYmIHByaW1hcnlfcGlwZS0+
Ym90dG9tX3BpcGUgIT0gc2Vjb25kYXJ5X3BpcGUpIHsKKwkJQVNTRVJUKCFzZWNvbmRhcnlfcGlw
ZS0+Ym90dG9tX3BpcGUpOworCQlzZWNvbmRhcnlfcGlwZS0+Ym90dG9tX3BpcGUgPSBwcmltYXJ5
X3BpcGUtPmJvdHRvbV9waXBlOworCQlzZWNvbmRhcnlfcGlwZS0+Ym90dG9tX3BpcGUtPnRvcF9w
aXBlID0gc2Vjb25kYXJ5X3BpcGU7CisJfQorCXByaW1hcnlfcGlwZS0+Ym90dG9tX3BpcGUgPSBz
ZWNvbmRhcnlfcGlwZTsKKwlzZWNvbmRhcnlfcGlwZS0+dG9wX3BpcGUgPSBwcmltYXJ5X3BpcGU7
CisKKwlpZiAoaXNfb2RtX2NvbWJpbmUpIHsKKwkJYm9vbCBpc19hZGRfZHNjID0gdHJ1ZTsKKwor
CQlpZiAocHJpbWFyeV9waXBlLT5wbGFuZV9zdGF0ZSkgeworCQkJLyogSEFDVElWRSBoYWx2ZWQg
Zm9yIG9kbSBjb21iaW5lICovCisJCQlzZC0+aF9hY3RpdmUgLz0gMjsKKwkJCS8qIENvcHkgc2Ns
X2RhdGEgdG8gc2Vjb25kYXJ5IHBpcGUgKi8KKwkJCXNlY29uZGFyeV9waXBlLT5wbGFuZV9yZXMu
c2NsX2RhdGEgPSAqc2Q7CisKKwkJCS8qIENhbGN1bGF0ZSBuZXcgdnAgYW5kIHJlY291dCBmb3Ig
bGVmdCBwaXBlICovCisJCQkvKiBOZWVkIGF0IGxlYXN0IDE2IHBpeGVscyB3aWR0aCBwZXIgc2lk
ZSAqLworCQkJaWYgKHNkLT5yZWNvdXQueCArIDE2ID49IHNkLT5oX2FjdGl2ZSkKKwkJCQlyZXR1
cm4gZmFsc2U7CisJCQluZXdfd2lkdGggPSBzZC0+aF9hY3RpdmUgLSBzZC0+cmVjb3V0Lng7CisJ
CQlzZC0+dmlld3BvcnQud2lkdGggLT0gZGNfZml4cHRfZmxvb3IoZGNfZml4cHRfbXVsX2ludCgK
KwkJCQkJc2QtPnJhdGlvcy5ob3J6LCBzZC0+cmVjb3V0LndpZHRoIC0gbmV3X3dpZHRoKSk7CisJ
CQlzZC0+dmlld3BvcnRfYy53aWR0aCAtPSBkY19maXhwdF9mbG9vcihkY19maXhwdF9tdWxfaW50
KAorCQkJCQlzZC0+cmF0aW9zLmhvcnpfYywgc2QtPnJlY291dC53aWR0aCAtIG5ld193aWR0aCkp
OworCQkJc2QtPnJlY291dC53aWR0aCA9IG5ld193aWR0aDsKKworCQkJLyogQ2FsY3VsYXRlIG5l
dyB2cCBhbmQgcmVjb3V0IGZvciByaWdodCBwaXBlICovCisJCQlzZCA9ICZzZWNvbmRhcnlfcGlw
ZS0+cGxhbmVfcmVzLnNjbF9kYXRhOworCQkJbmV3X3dpZHRoID0gc2QtPnJlY291dC53aWR0aCAr
IHNkLT5yZWNvdXQueCAtIHNkLT5oX2FjdGl2ZTsKKwkJCS8qIE5lZWQgYXQgbGVhc3QgMTYgcGl4
ZWxzIHdpZHRoIHBlciBzaWRlICovCisJCQlpZiAobmV3X3dpZHRoIDw9IDE2KQorCQkJCXJldHVy
biBmYWxzZTsKKwkJCXNkLT52aWV3cG9ydC53aWR0aCAtPSBkY19maXhwdF9mbG9vcihkY19maXhw
dF9tdWxfaW50KAorCQkJCQlzZC0+cmF0aW9zLmhvcnosIHNkLT5yZWNvdXQud2lkdGggLSBuZXdf
d2lkdGgpKTsKKwkJCXNkLT52aWV3cG9ydF9jLndpZHRoIC09IGRjX2ZpeHB0X2Zsb29yKGRjX2Zp
eHB0X211bF9pbnQoCisJCQkJCXNkLT5yYXRpb3MuaG9yel9jLCBzZC0+cmVjb3V0LndpZHRoIC0g
bmV3X3dpZHRoKSk7CisJCQlzZC0+cmVjb3V0LndpZHRoID0gbmV3X3dpZHRoOworCQkJc2QtPnZp
ZXdwb3J0LnggKz0gZGNfZml4cHRfZmxvb3IoZGNfZml4cHRfbXVsX2ludCgKKwkJCQkJc2QtPnJh
dGlvcy5ob3J6LCBzZC0+aF9hY3RpdmUgLSBzZC0+cmVjb3V0LngpKTsKKwkJCXNkLT52aWV3cG9y
dF9jLnggKz0gZGNfZml4cHRfZmxvb3IoZGNfZml4cHRfbXVsX2ludCgKKwkJCQkJc2QtPnJhdGlv
cy5ob3J6X2MsIHNkLT5oX2FjdGl2ZSAtIHNkLT5yZWNvdXQueCkpOworCQkJc2QtPnJlY291dC54
ID0gMDsKKwkJfQorCQlzZWNvbmRhcnlfcGlwZS0+c3RyZWFtX3Jlcy5vcHAgPSBwb29sLT5vcHBz
W3NlY29uZGFyeV9waXBlLT5waXBlX2lkeF07CisJfSBlbHNlIHsKKwkJQVNTRVJUKHByaW1hcnlf
cGlwZS0+cGxhbmVfc3RhdGUpOworCQlyZXNvdXJjZV9idWlsZF9zY2FsaW5nX3BhcmFtcyhwcmlt
YXJ5X3BpcGUpOworCQlyZXNvdXJjZV9idWlsZF9zY2FsaW5nX3BhcmFtcyhzZWNvbmRhcnlfcGlw
ZSk7CisJfQorCisJcmV0dXJuIHRydWU7Cit9CisKK3ZvaWQgZGNuMjBfcG9wdWxhdGVfZG1sX3dy
aXRlYmFja19mcm9tX2NvbnRleHQoCisJCXN0cnVjdCBkYyAqZGMsIHN0cnVjdCByZXNvdXJjZV9j
b250ZXh0ICpyZXNfY3R4LCBkaXNwbGF5X2UyZV9waXBlX3BhcmFtc19zdCAqcGlwZXMpCit7CisJ
aW50IHBpcGVfY250LCBpOworCisJZm9yIChpID0gMCwgcGlwZV9jbnQgPSAwOyBpIDwgZGMtPnJl
c19wb29sLT5waXBlX2NvdW50OyBpKyspIHsKKwkJc3RydWN0IGRjX3dyaXRlYmFja19pbmZvICp3
Yl9pbmZvID0gJnJlc19jdHgtPnBpcGVfY3R4W2ldLnN0cmVhbS0+d3JpdGViYWNrX2luZm9bMF07
CisKKwkJaWYgKCFyZXNfY3R4LT5waXBlX2N0eFtpXS5zdHJlYW0pCisJCQljb250aW51ZTsKKwor
CQkvKiBTZXQgd3JpdGViYWNrIGluZm9ybWF0aW9uICovCisJCXBpcGVzW3BpcGVfY250XS5kb3V0
LndiX2VuYWJsZSA9ICh3Yl9pbmZvLT53Yl9lbmFibGVkID09IHRydWUpID8gMSA6IDA7CisJCXBp
cGVzW3BpcGVfY250XS5kb3V0Lm51bV9hY3RpdmVfd2IrKzsKKwkJcGlwZXNbcGlwZV9jbnRdLmRv
dXQud2Iud2Jfc3JjX2hlaWdodCA9IHdiX2luZm8tPmR3Yl9wYXJhbXMuY252X3BhcmFtcy5jcm9w
X2hlaWdodDsKKwkJcGlwZXNbcGlwZV9jbnRdLmRvdXQud2Iud2Jfc3JjX3dpZHRoID0gd2JfaW5m
by0+ZHdiX3BhcmFtcy5jbnZfcGFyYW1zLmNyb3Bfd2lkdGg7CisJCXBpcGVzW3BpcGVfY250XS5k
b3V0LndiLndiX2RzdF93aWR0aCA9IHdiX2luZm8tPmR3Yl9wYXJhbXMuZGVzdF93aWR0aDsKKwkJ
cGlwZXNbcGlwZV9jbnRdLmRvdXQud2Iud2JfZHN0X2hlaWdodCA9IHdiX2luZm8tPmR3Yl9wYXJh
bXMuZGVzdF9oZWlnaHQ7CisJCXBpcGVzW3BpcGVfY250XS5kb3V0LndiLndiX2h0YXBzX2x1bWEg
PSAxOworCQlwaXBlc1twaXBlX2NudF0uZG91dC53Yi53Yl92dGFwc19sdW1hID0gMTsKKwkJcGlw
ZXNbcGlwZV9jbnRdLmRvdXQud2Iud2JfaHRhcHNfY2hyb21hID0gd2JfaW5mby0+ZHdiX3BhcmFt
cy5zY2FsZXJfdGFwcy5oX3RhcHNfYzsKKwkJcGlwZXNbcGlwZV9jbnRdLmRvdXQud2Iud2JfdnRh
cHNfY2hyb21hID0gd2JfaW5mby0+ZHdiX3BhcmFtcy5zY2FsZXJfdGFwcy52X3RhcHNfYzsKKwkJ
cGlwZXNbcGlwZV9jbnRdLmRvdXQud2Iud2JfaHJhdGlvID0gMS4wOworCQlwaXBlc1twaXBlX2Nu
dF0uZG91dC53Yi53Yl92cmF0aW8gPSAxLjA7CisJCWlmICh3Yl9pbmZvLT5kd2JfcGFyYW1zLm91
dF9mb3JtYXQgPT0gZHdiX3NjYWxlcl9tb2RlX3l1djQyMCkgeworCQkJaWYgKHdiX2luZm8tPmR3
Yl9wYXJhbXMub3V0cHV0X2RlcHRoID09IERXQl9PVVRQVVRfUElYRUxfREVQVEhfOEJQQykKKwkJ
CQlwaXBlc1twaXBlX2NudF0uZG91dC53Yi53Yl9waXhlbF9mb3JtYXQgPSBkbV80MjBfODsKKwkJ
CWVsc2UKKwkJCQlwaXBlc1twaXBlX2NudF0uZG91dC53Yi53Yl9waXhlbF9mb3JtYXQgPSBkbV80
MjBfMTA7CisJCX0gZWxzZQorCQkJcGlwZXNbcGlwZV9jbnRdLmRvdXQud2Iud2JfcGl4ZWxfZm9y
bWF0ID0gZG1fNDQ0XzMyOworCisJCXBpcGVfY250Kys7CisJfQorCit9CisKK2ludCBkY24yMF9w
b3B1bGF0ZV9kbWxfcGlwZXNfZnJvbV9jb250ZXh0KAorCQlzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3Qg
cmVzb3VyY2VfY29udGV4dCAqcmVzX2N0eCwgZGlzcGxheV9lMmVfcGlwZV9wYXJhbXNfc3QgKnBp
cGVzKQoreworCWludCBwaXBlX2NudCwgaTsKKwlib29sIHN5bmNocm9uaXplZF92YmxhbmsgPSB0
cnVlOworCisJZm9yIChpID0gMCwgcGlwZV9jbnQgPSAtMTsgaSA8IGRjLT5yZXNfcG9vbC0+cGlw
ZV9jb3VudDsgaSsrKSB7CisJCWlmICghcmVzX2N0eC0+cGlwZV9jdHhbaV0uc3RyZWFtKQorCQkJ
Y29udGludWU7CisKKwkJaWYgKHBpcGVfY250IDwgMCkgeworCQkJcGlwZV9jbnQgPSBpOworCQkJ
Y29udGludWU7CisJCX0KKwkJaWYgKCFyZXNvdXJjZV9hcmVfc3RyZWFtc190aW1pbmdfc3luY2hy
b25pemFibGUoCisJCQkJcmVzX2N0eC0+cGlwZV9jdHhbcGlwZV9jbnRdLnN0cmVhbSwKKwkJCQly
ZXNfY3R4LT5waXBlX2N0eFtpXS5zdHJlYW0pKSB7CisJCQlzeW5jaHJvbml6ZWRfdmJsYW5rID0g
ZmFsc2U7CisJCQlicmVhazsKKwkJfQorCX0KKworCWZvciAoaSA9IDAsIHBpcGVfY250ID0gMDsg
aSA8IGRjLT5yZXNfcG9vbC0+cGlwZV9jb3VudDsgaSsrKSB7CisJCXN0cnVjdCBkY19jcnRjX3Rp
bWluZyAqdGltaW5nID0gJnJlc19jdHgtPnBpcGVfY3R4W2ldLnN0cmVhbS0+dGltaW5nOworCQlz
dHJ1Y3QgZGNfbGluayAqbGluazsKKworCQlpZiAoIXJlc19jdHgtPnBpcGVfY3R4W2ldLnN0cmVh
bSkKKwkJCWNvbnRpbnVlOworCQkvKiB0b2RvOgorCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMu
ZHluYW1pY19tZXRhZGF0YV9lbmFibGUgPSAwOworCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMu
ZGNjID0gMDsKKwkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuc3JjLnZtID0gMDsqLworCisJCWlmIChy
ZXNfY3R4LT5waXBlX2N0eFtpXS5zdHJlYW0tPnVzZV9keW5hbWljX21ldGEpIHsKKwkJCXBpcGVz
W3BpcGVfY250XS5waXBlLnNyYy5keW5hbWljX21ldGFkYXRhX2VuYWJsZSA9IHRydWU7CisJCQkv
KiAxLzIgdmJsYW5rICovCisJCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMuZHluYW1pY19tZXRh
ZGF0YV9saW5lc19iZWZvcmVfYWN0aXZlID0KKwkJCQkodGltaW5nLT52X3RvdGFsIC0gdGltaW5n
LT52X2FkZHJlc3NhYmxlCisJCQkJCS0gdGltaW5nLT52X2JvcmRlcl90b3AgLSB0aW1pbmctPnZf
Ym9yZGVyX2JvdHRvbSkgLyAyOworCQkJLyogMzYgYnl0ZXMgZHAsIDMyIGhkbWkgKi8KKwkJCXBp
cGVzW3BpcGVfY250XS5waXBlLnNyYy5keW5hbWljX21ldGFkYXRhX3htaXRfYnl0ZXMgPQorCQkJ
CWRjX2lzX2RwX3NpZ25hbChyZXNfY3R4LT5waXBlX2N0eFtpXS5zdHJlYW0tPnNpZ25hbCkgPyAz
NiA6IDMyOworCQl9CisJCXBpcGVzW3BpcGVfY250XS5waXBlLnNyYy5kY2MgPSBmYWxzZTsKKwkJ
cGlwZXNbcGlwZV9jbnRdLnBpcGUuc3JjLmRjY19yYXRlID0gMTsKKwkJcGlwZXNbcGlwZV9jbnRd
LnBpcGUuZGVzdC5zeW5jaHJvbml6ZWRfdmJsYW5rX2FsbF9wbGFuZXMgPSBzeW5jaHJvbml6ZWRf
dmJsYW5rOworCQlwaXBlc1twaXBlX2NudF0ucGlwZS5kZXN0LmhibGFua19zdGFydCA9IHRpbWlu
Zy0+aF90b3RhbCAtIHRpbWluZy0+aF9mcm9udF9wb3JjaDsKKwkJcGlwZXNbcGlwZV9jbnRdLnBp
cGUuZGVzdC5oYmxhbmtfZW5kID0gcGlwZXNbcGlwZV9jbnRdLnBpcGUuZGVzdC5oYmxhbmtfc3Rh
cnQKKwkJCQktIHRpbWluZy0+aF9hZGRyZXNzYWJsZQorCQkJCS0gdGltaW5nLT5oX2JvcmRlcl9s
ZWZ0CisJCQkJLSB0aW1pbmctPmhfYm9yZGVyX3JpZ2h0OworCQlwaXBlc1twaXBlX2NudF0ucGlw
ZS5kZXN0LnZibGFua19zdGFydCA9IHRpbWluZy0+dl90b3RhbCAtIHRpbWluZy0+dl9mcm9udF9w
b3JjaDsKKwkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuZGVzdC52YmxhbmtfZW5kID0gcGlwZXNbcGlw
ZV9jbnRdLnBpcGUuZGVzdC52Ymxhbmtfc3RhcnQKKwkJCQktIHRpbWluZy0+dl9hZGRyZXNzYWJs
ZQorCQkJCS0gdGltaW5nLT52X2JvcmRlcl90b3AKKwkJCQktIHRpbWluZy0+dl9ib3JkZXJfYm90
dG9tOworCQlwaXBlc1twaXBlX2NudF0ucGlwZS5kZXN0Lmh0b3RhbCA9IHRpbWluZy0+aF90b3Rh
bDsKKwkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuZGVzdC52dG90YWwgPSB0aW1pbmctPnZfdG90YWw7
CisJCXBpcGVzW3BpcGVfY250XS5waXBlLmRlc3QuaGFjdGl2ZSA9IHRpbWluZy0+aF9hZGRyZXNz
YWJsZTsKKwkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuZGVzdC52YWN0aXZlID0gdGltaW5nLT52X2Fk
ZHJlc3NhYmxlOworCQlwaXBlc1twaXBlX2NudF0ucGlwZS5kZXN0LmludGVybGFjZWQgPSB0aW1p
bmctPmZsYWdzLklOVEVSTEFDRTsKKwkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuZGVzdC5waXhlbF9y
YXRlX21oeiA9IHRpbWluZy0+cGl4X2Nsa18xMDBoei8xMDAwMC4wOworCQlpZiAodGltaW5nLT50
aW1pbmdfM2RfZm9ybWF0ID09IFRJTUlOR18zRF9GT1JNQVRfSFdfRlJBTUVfUEFDS0lORykKKwkJ
CXBpcGVzW3BpcGVfY250XS5waXBlLmRlc3QucGl4ZWxfcmF0ZV9taHogKj0gMjsKKwkJcGlwZXNb
cGlwZV9jbnRdLnBpcGUuZGVzdC5vdGdfaW5zdCA9IHJlc19jdHgtPnBpcGVfY3R4W2ldLnN0cmVh
bV9yZXMudGctPmluc3Q7CisKKwkJbGluayA9IHJlc19jdHgtPnBpcGVfY3R4W2ldLnN0cmVhbS0+
bGluazsKKwkJaWYgKGxpbmstPmN1cl9saW5rX3NldHRpbmdzLmxhbmVfY291bnQgIT0gTEFORV9D
T1VOVF9VTktOT1dOKSB7CisJCQlwaXBlc1twaXBlX2NudF0uZG91dC5kcF9sYW5lcyA9IGxpbmst
PmN1cl9saW5rX3NldHRpbmdzLmxhbmVfY291bnQ7CisJCX0gZWxzZSBpZiAobGluay0+dmVyaWZp
ZWRfbGlua19jYXAubGFuZV9jb3VudCAhPSBMQU5FX0NPVU5UX1VOS05PV04pIHsKKwkJCXBpcGVz
W3BpcGVfY250XS5kb3V0LmRwX2xhbmVzID0gbGluay0+dmVyaWZpZWRfbGlua19jYXAubGFuZV9j
b3VudDsKKwkJfSBlbHNlIHsKKwkJCS8qIFVua25vd24gbGluayBjYXBhYmlsaXRpZXMsIHNvIGFz
c3VtZSBtYXggKi8KKwkJCXBpcGVzW3BpcGVfY250XS5kb3V0LmRwX2xhbmVzID0gNDsKKwkJfQor
CisJCXBpcGVzW3BpcGVfY250XS5kb3V0Lm91dHB1dF9icHAgPSByZXNfY3R4LT5waXBlX2N0eFtp
XS5zdHJlYW0tPnRpbWluZy5kaXNwbGF5X2NvbG9yX2RlcHRoOworCQlzd2l0Y2ggKHJlc19jdHgt
PnBpcGVfY3R4W2ldLnN0cmVhbS0+c2lnbmFsKSB7CisJCWNhc2UgU0lHTkFMX1RZUEVfRElTUExB
WV9QT1JUX01TVDoKKwkJY2FzZSBTSUdOQUxfVFlQRV9ESVNQTEFZX1BPUlQ6CisJCQlwaXBlc1tw
aXBlX2NudF0uZG91dC5vdXRwdXRfdHlwZSA9IGRtX2RwOworCQkJYnJlYWs7CisJCWNhc2UgU0lH
TkFMX1RZUEVfRURQOgorCQkJcGlwZXNbcGlwZV9jbnRdLmRvdXQub3V0cHV0X3R5cGUgPSBkbV9l
ZHA7CisJCQlicmVhazsKKwkJY2FzZSBTSUdOQUxfVFlQRV9IRE1JX1RZUEVfQToKKwkJY2FzZSBT
SUdOQUxfVFlQRV9EVklfU0lOR0xFX0xJTks6CisJCWNhc2UgU0lHTkFMX1RZUEVfRFZJX0RVQUxf
TElOSzoKKwkJCXBpcGVzW3BpcGVfY250XS5kb3V0Lm91dHB1dF90eXBlID0gZG1faGRtaTsKKwkJ
CWJyZWFrOworCQlkZWZhdWx0OgorCQkJLyogSW4gY2FzZSB0aGVyZSBpcyBubyBzaWduYWwsIHNl
dCBkcCB3aXRoIDQgbGFuZXMgdG8gYWxsb3cgbWF4IGNvbmZpZyAqLworCQkJcGlwZXNbcGlwZV9j
bnRdLmRvdXQub3V0cHV0X3R5cGUgPSBkbV9kcDsKKwkJCXBpcGVzW3BpcGVfY250XS5kb3V0LmRw
X2xhbmVzID0gNDsKKwkJfQorCQlzd2l0Y2ggKHJlc19jdHgtPnBpcGVfY3R4W2ldLnN0cmVhbS0+
dGltaW5nLnBpeGVsX2VuY29kaW5nKSB7CisJCWNhc2UgUElYRUxfRU5DT0RJTkdfUkdCOgorCQlj
YXNlIFBJWEVMX0VOQ09ESU5HX1lDQkNSNDQ0OgorCQkJcGlwZXNbcGlwZV9jbnRdLmRvdXQub3V0
cHV0X2Zvcm1hdCA9IGRtXzQ0NDsKKwkJCWJyZWFrOworCQljYXNlIFBJWEVMX0VOQ09ESU5HX1lD
QkNSNDIwOgorCQkJcGlwZXNbcGlwZV9jbnRdLmRvdXQub3V0cHV0X2Zvcm1hdCA9IGRtXzQyMDsK
KwkJCWJyZWFrOworCQljYXNlIFBJWEVMX0VOQ09ESU5HX1lDQkNSNDIyOgorCQkJaWYgKHRydWUp
IC8qIHRvZG8gKi8KKwkJCQlwaXBlc1twaXBlX2NudF0uZG91dC5vdXRwdXRfZm9ybWF0ID0gZG1f
czQyMjsKKwkJCWVsc2UKKwkJCQlwaXBlc1twaXBlX2NudF0uZG91dC5vdXRwdXRfZm9ybWF0ID0g
ZG1fbjQyMjsKKwkJCWJyZWFrOworCQlkZWZhdWx0OgorCQkJcGlwZXNbcGlwZV9jbnRdLmRvdXQu
b3V0cHV0X2Zvcm1hdCA9IGRtXzQ0NDsKKwkJfQorCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMu
aHNwbGl0X2dycCA9IHJlc19jdHgtPnBpcGVfY3R4W2ldLnBpcGVfaWR4OworCQlpZiAocmVzX2N0
eC0+cGlwZV9jdHhbaV0udG9wX3BpcGUgJiYgcmVzX2N0eC0+cGlwZV9jdHhbaV0udG9wX3BpcGUt
PnBsYW5lX3N0YXRlCisJCQkJPT0gcmVzX2N0eC0+cGlwZV9jdHhbaV0ucGxhbmVfc3RhdGUpCisJ
CQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMuaHNwbGl0X2dycCA9IHJlc19jdHgtPnBpcGVfY3R4
W2ldLnRvcF9waXBlLT5waXBlX2lkeDsKKworCQkvKiB0b2RvOiBkZWZhdWx0IG1heCBmb3Igbm93
LCB1bnRpbCB0aGVyZSBpcyBsb2dpYyByZWZsZWN0aW5nIHRoaXMgaW4gZGMqLworCQlwaXBlc1tw
aXBlX2NudF0uZG91dC5vdXRwdXRfYnBjID0gMTI7CisJCS8qCisJCSAqIFVzZSBtYXggY3Vyc29y
IHNldHRpbmdzIGZvciBjYWxjdWxhdGlvbnMgdG8gbWluaW1pemUKKwkJICogYncgY2FsY3VsYXRp
b25zIGR1ZSB0byBjdXJzb3Igb24vb2ZmCisJCSAqLworCQlwaXBlc1twaXBlX2NudF0ucGlwZS5z
cmMubnVtX2N1cnNvcnMgPSAyOworCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMuY3VyMF9zcmNf
d2lkdGggPSAxMjg7CisJCXBpcGVzW3BpcGVfY250XS5waXBlLnNyYy5jdXIwX2JwcCA9IGRtX2N1
cl82NGJpdDsKKwkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuc3JjLmN1cjFfc3JjX3dpZHRoID0gMTI4
OworCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMuY3VyMV9icHAgPSBkbV9jdXJfNjRiaXQ7CisK
KwkJaWYgKCFyZXNfY3R4LT5waXBlX2N0eFtpXS5wbGFuZV9zdGF0ZSkgeworCQkJcGlwZXNbcGlw
ZV9jbnRdLnBpcGUuc3JjLnNvdXJjZV9zY2FuID0gZG1faG9yejsKKwkJCXBpcGVzW3BpcGVfY250
XS5waXBlLnNyYy5zd19tb2RlID0gZG1fc3dfbGluZWFyOworCQkJcGlwZXNbcGlwZV9jbnRdLnBp
cGUuc3JjLm1hY3JvX3RpbGVfc2l6ZSA9IGRtXzY0a190aWxlOworCQkJcGlwZXNbcGlwZV9jbnRd
LnBpcGUuc3JjLnZpZXdwb3J0X3dpZHRoID0gdGltaW5nLT5oX2FkZHJlc3NhYmxlOworCQkJaWYg
KHBpcGVzW3BpcGVfY250XS5waXBlLnNyYy52aWV3cG9ydF93aWR0aCA+IDE5MjApCisJCQkJcGlw
ZXNbcGlwZV9jbnRdLnBpcGUuc3JjLnZpZXdwb3J0X3dpZHRoID0gMTkyMDsKKwkJCXBpcGVzW3Bp
cGVfY250XS5waXBlLnNyYy52aWV3cG9ydF9oZWlnaHQgPSB0aW1pbmctPnZfYWRkcmVzc2FibGU7
CisJCQlpZiAocGlwZXNbcGlwZV9jbnRdLnBpcGUuc3JjLnZpZXdwb3J0X2hlaWdodCA+IDEwODAp
CisJCQkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuc3JjLnZpZXdwb3J0X2hlaWdodCA9IDEwODA7CisJ
CQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMuZGF0YV9waXRjaCA9ICgocGlwZXNbcGlwZV9jbnRd
LnBpcGUuc3JjLnZpZXdwb3J0X3dpZHRoICsgNjMpIC8gNjQpICogNjQ7IC8qIGxpbmVhciBzdyBv
bmx5ICovCisJCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMuc291cmNlX2Zvcm1hdCA9IGRtXzQ0
NF8zMjsKKwkJCXBpcGVzW3BpcGVfY250XS5waXBlLmRlc3QucmVjb3V0X3dpZHRoID0gcGlwZXNb
cGlwZV9jbnRdLnBpcGUuc3JjLnZpZXdwb3J0X3dpZHRoOyAvKnZwX3dpZHRoL2hyYXRpbyovCisJ
CQlwaXBlc1twaXBlX2NudF0ucGlwZS5kZXN0LnJlY291dF9oZWlnaHQgPSBwaXBlc1twaXBlX2Nu
dF0ucGlwZS5zcmMudmlld3BvcnRfaGVpZ2h0OyAvKnZwX2hlaWdodC92cmF0aW8qLworCQkJcGlw
ZXNbcGlwZV9jbnRdLnBpcGUuZGVzdC5mdWxsX3JlY291dF93aWR0aCA9IHBpcGVzW3BpcGVfY250
XS5waXBlLmRlc3QucmVjb3V0X3dpZHRoOyAgLyp3aGVuIGlzX2hzcGxpdCAhPSAxKi8KKwkJCXBp
cGVzW3BpcGVfY250XS5waXBlLmRlc3QuZnVsbF9yZWNvdXRfaGVpZ2h0ID0gcGlwZXNbcGlwZV9j
bnRdLnBpcGUuZGVzdC5yZWNvdXRfaGVpZ2h0OyAvKndoZW4gaXNfaHNwbGl0ICE9IDEqLworCQkJ
cGlwZXNbcGlwZV9jbnRdLnBpcGUuc2NhbGVfcmF0aW9fZGVwdGgubGJfZGVwdGggPSBkbV9sYl8x
NjsKKwkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNjYWxlX3JhdGlvX2RlcHRoLmhzY2xfcmF0aW8g
PSAxLjA7CisJCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zY2FsZV9yYXRpb19kZXB0aC52c2NsX3Jh
dGlvID0gMS4wOworCQkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuc2NhbGVfcmF0aW9fZGVwdGguc2Ns
X2VuYWJsZSA9IDA7IC8qTGIgb25seSBvciBGdWxsIHNjbCovCisJCQlwaXBlc1twaXBlX2NudF0u
cGlwZS5zY2FsZV90YXBzLmh0YXBzID0gMTsKKwkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNjYWxl
X3RhcHMudnRhcHMgPSAxOworCQkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuc3JjLmlzX2hzcGxpdCA9
IDA7CisJCQlwaXBlc1twaXBlX2NudF0ucGlwZS5kZXN0Lm9kbV9jb21iaW5lID0gMDsKKwkJfSBl
bHNlIHsKKwkJCXN0cnVjdCBkY19wbGFuZV9zdGF0ZSAqcGxuID0gcmVzX2N0eC0+cGlwZV9jdHhb
aV0ucGxhbmVfc3RhdGU7CisJCQlzdHJ1Y3Qgc2NhbGVyX2RhdGEgKnNjbCA9ICZyZXNfY3R4LT5w
aXBlX2N0eFtpXS5wbGFuZV9yZXMuc2NsX2RhdGE7CisKKwkJCXBpcGVzW3BpcGVfY250XS5waXBl
LnNyYy5tYWNyb190aWxlX3NpemUgPQorCQkJCQlzd2l6emxlX21vZGVfdG9fbWFjcm9fdGlsZV9z
aXplKHBsbi0+dGlsaW5nX2luZm8uZ2Z4OS5zd2l6emxlKTsKKwkJCXBpcGVzW3BpcGVfY250XS5w
aXBlLnNyYy5pbW1lZGlhdGVfZmxpcCA9IHBsbi0+ZmxpcF9pbW1lZGlhdGU7CisJCQlwaXBlc1tw
aXBlX2NudF0ucGlwZS5zcmMuaXNfaHNwbGl0ID0gKHJlc19jdHgtPnBpcGVfY3R4W2ldLmJvdHRv
bV9waXBlCisJCQkJCSYmIHJlc19jdHgtPnBpcGVfY3R4W2ldLmJvdHRvbV9waXBlLT5wbGFuZV9z
dGF0ZSA9PSBwbG4pCisJCQkJCXx8IChyZXNfY3R4LT5waXBlX2N0eFtpXS50b3BfcGlwZQorCQkJ
CQkmJiByZXNfY3R4LT5waXBlX2N0eFtpXS50b3BfcGlwZS0+cGxhbmVfc3RhdGUgPT0gcGxuKTsK
KwkJCXBpcGVzW3BpcGVfY250XS5waXBlLmRlc3Qub2RtX2NvbWJpbmUgPSAocmVzX2N0eC0+cGlw
ZV9jdHhbaV0uYm90dG9tX3BpcGUKKwkJCQkJJiYgcmVzX2N0eC0+cGlwZV9jdHhbaV0uYm90dG9t
X3BpcGUtPnBsYW5lX3N0YXRlID09IHBsbgorCQkJCQkmJiByZXNfY3R4LT5waXBlX2N0eFtpXS5i
b3R0b21fcGlwZS0+c3RyZWFtX3Jlcy5vcHAKKwkJCQkJCSE9IHJlc19jdHgtPnBpcGVfY3R4W2ld
LnN0cmVhbV9yZXMub3BwKQorCQkJCXx8IChyZXNfY3R4LT5waXBlX2N0eFtpXS50b3BfcGlwZQor
CQkJCQkmJiByZXNfY3R4LT5waXBlX2N0eFtpXS50b3BfcGlwZS0+cGxhbmVfc3RhdGUgPT0gcGxu
CisJCQkJCSYmIHJlc19jdHgtPnBpcGVfY3R4W2ldLnRvcF9waXBlLT5zdHJlYW1fcmVzLm9wcAor
CQkJCQkJIT0gcmVzX2N0eC0+cGlwZV9jdHhbaV0uc3RyZWFtX3Jlcy5vcHApOworCQkJcGlwZXNb
cGlwZV9jbnRdLnBpcGUuc3JjLnNvdXJjZV9zY2FuID0gcGxuLT5yb3RhdGlvbiA9PSBST1RBVElP
Tl9BTkdMRV85MAorCQkJCQl8fCBwbG4tPnJvdGF0aW9uID09IFJPVEFUSU9OX0FOR0xFXzI3MCA/
IGRtX3ZlcnQgOiBkbV9ob3J6OworCQkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuc3JjLnZpZXdwb3J0
X3lfeSA9IHNjbC0+dmlld3BvcnQueTsKKwkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNyYy52aWV3
cG9ydF95X2MgPSBzY2wtPnZpZXdwb3J0X2MueTsKKwkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNy
Yy52aWV3cG9ydF93aWR0aCA9IHNjbC0+dmlld3BvcnQud2lkdGg7CisJCQlwaXBlc1twaXBlX2Nu
dF0ucGlwZS5zcmMudmlld3BvcnRfd2lkdGhfYyA9IHNjbC0+dmlld3BvcnRfYy53aWR0aDsKKwkJ
CXBpcGVzW3BpcGVfY250XS5waXBlLnNyYy52aWV3cG9ydF9oZWlnaHQgPSBzY2wtPnZpZXdwb3J0
LmhlaWdodDsKKwkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNyYy52aWV3cG9ydF9oZWlnaHRfYyA9
IHNjbC0+dmlld3BvcnRfYy5oZWlnaHQ7CisJCQlpZiAocGxuLT5mb3JtYXQgPj0gU1VSRkFDRV9Q
SVhFTF9GT1JNQVRfVklERU9fQkVHSU4pIHsKKwkJCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMu
ZGF0YV9waXRjaCA9IHBsbi0+cGxhbmVfc2l6ZS52aWRlby5sdW1hX3BpdGNoOworCQkJCXBpcGVz
W3BpcGVfY250XS5waXBlLnNyYy5kYXRhX3BpdGNoX2MgPSBwbG4tPnBsYW5lX3NpemUudmlkZW8u
Y2hyb21hX3BpdGNoOworCQkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNyYy5tZXRhX3BpdGNoID0g
cGxuLT5kY2MudmlkZW8ubWV0YV9waXRjaF9sOworCQkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNy
Yy5tZXRhX3BpdGNoX2MgPSBwbG4tPmRjYy52aWRlby5tZXRhX3BpdGNoX2M7CisJCQl9IGVsc2Ug
eworCQkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNyYy5kYXRhX3BpdGNoID0gcGxuLT5wbGFuZV9z
aXplLmdycGguc3VyZmFjZV9waXRjaDsKKwkJCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zcmMubWV0
YV9waXRjaCA9IHBsbi0+ZGNjLmdycGgubWV0YV9waXRjaDsKKwkJCX0KKwkJCXBpcGVzW3BpcGVf
Y250XS5waXBlLnNyYy5kY2MgPSBwbG4tPmRjYy5lbmFibGU7CisJCQlwaXBlc1twaXBlX2NudF0u
cGlwZS5kZXN0LnJlY291dF93aWR0aCA9IHNjbC0+cmVjb3V0LndpZHRoOworCQkJcGlwZXNbcGlw
ZV9jbnRdLnBpcGUuZGVzdC5yZWNvdXRfaGVpZ2h0ID0gc2NsLT5yZWNvdXQuaGVpZ2h0OworCQkJ
cGlwZXNbcGlwZV9jbnRdLnBpcGUuZGVzdC5mdWxsX3JlY291dF93aWR0aCA9IHNjbC0+cmVjb3V0
LndpZHRoOworCQkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuZGVzdC5mdWxsX3JlY291dF9oZWlnaHQg
PSBzY2wtPnJlY291dC5oZWlnaHQ7CisJCQlpZiAocmVzX2N0eC0+cGlwZV9jdHhbaV0uYm90dG9t
X3BpcGUgJiYgcmVzX2N0eC0+cGlwZV9jdHhbaV0uYm90dG9tX3BpcGUtPnBsYW5lX3N0YXRlID09
IHBsbikgeworCQkJCXBpcGVzW3BpcGVfY250XS5waXBlLmRlc3QuZnVsbF9yZWNvdXRfd2lkdGgg
Kz0KKwkJCQkJCXJlc19jdHgtPnBpcGVfY3R4W2ldLmJvdHRvbV9waXBlLT5wbGFuZV9yZXMuc2Ns
X2RhdGEucmVjb3V0LndpZHRoOworCQkJCXBpcGVzW3BpcGVfY250XS5waXBlLmRlc3QuZnVsbF9y
ZWNvdXRfaGVpZ2h0ICs9CisJCQkJCQlyZXNfY3R4LT5waXBlX2N0eFtpXS5ib3R0b21fcGlwZS0+
cGxhbmVfcmVzLnNjbF9kYXRhLnJlY291dC5oZWlnaHQ7CisJCQl9IGVsc2UgaWYgKHJlc19jdHgt
PnBpcGVfY3R4W2ldLnRvcF9waXBlICYmIHJlc19jdHgtPnBpcGVfY3R4W2ldLnRvcF9waXBlLT5w
bGFuZV9zdGF0ZSA9PSBwbG4pIHsKKwkJCQlwaXBlc1twaXBlX2NudF0ucGlwZS5kZXN0LmZ1bGxf
cmVjb3V0X3dpZHRoICs9CisJCQkJCQlyZXNfY3R4LT5waXBlX2N0eFtpXS50b3BfcGlwZS0+cGxh
bmVfcmVzLnNjbF9kYXRhLnJlY291dC53aWR0aDsKKwkJCQlwaXBlc1twaXBlX2NudF0ucGlwZS5k
ZXN0LmZ1bGxfcmVjb3V0X2hlaWdodCArPQorCQkJCQkJcmVzX2N0eC0+cGlwZV9jdHhbaV0udG9w
X3BpcGUtPnBsYW5lX3Jlcy5zY2xfZGF0YS5yZWNvdXQuaGVpZ2h0OworCQkJfQorCisJCQlwaXBl
c1twaXBlX2NudF0ucGlwZS5zY2FsZV9yYXRpb19kZXB0aC5sYl9kZXB0aCA9IGRtX2xiXzEwOwor
CQkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuc2NhbGVfcmF0aW9fZGVwdGguaHNjbF9yYXRpbyA9IChk
b3VibGUpIHNjbC0+cmF0aW9zLmhvcnoudmFsdWUgLyAoMVVMTDw8MzIpOworCQkJcGlwZXNbcGlw
ZV9jbnRdLnBpcGUuc2NhbGVfcmF0aW9fZGVwdGguaHNjbF9yYXRpb19jID0gKGRvdWJsZSkgc2Ns
LT5yYXRpb3MuaG9yel9jLnZhbHVlIC8gKDFVTEw8PDMyKTsKKwkJCXBpcGVzW3BpcGVfY250XS5w
aXBlLnNjYWxlX3JhdGlvX2RlcHRoLnZzY2xfcmF0aW8gPSAoZG91YmxlKSBzY2wtPnJhdGlvcy52
ZXJ0LnZhbHVlIC8gKDFVTEw8PDMyKTsKKwkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNjYWxlX3Jh
dGlvX2RlcHRoLnZzY2xfcmF0aW9fYyA9IChkb3VibGUpIHNjbC0+cmF0aW9zLnZlcnRfYy52YWx1
ZSAvICgxVUxMPDwzMik7CisJCQlwaXBlc1twaXBlX2NudF0ucGlwZS5zY2FsZV9yYXRpb19kZXB0
aC5zY2xfZW5hYmxlID0KKwkJCQkJc2NsLT5yYXRpb3MudmVydC52YWx1ZSAhPSBkY19maXhwdF9v
bmUudmFsdWUKKwkJCQkJfHwgc2NsLT5yYXRpb3MuaG9yei52YWx1ZSAhPSBkY19maXhwdF9vbmUu
dmFsdWUKKwkJCQkJfHwgc2NsLT5yYXRpb3MudmVydF9jLnZhbHVlICE9IGRjX2ZpeHB0X29uZS52
YWx1ZQorCQkJCQl8fCBzY2wtPnJhdGlvcy5ob3J6X2MudmFsdWUgIT0gZGNfZml4cHRfb25lLnZh
bHVlIC8qTGIgb25seSBvciBGdWxsIHNjbCovCisJCQkJCXx8IGRjLT5kZWJ1Zy5hbHdheXNfc2Nh
bGU7IC8qc3VwcG9ydCBhbHdheXMgc2NhbGUqLworCQkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuc2Nh
bGVfdGFwcy5odGFwcyA9IHNjbC0+dGFwcy5oX3RhcHM7CisJCQlwaXBlc1twaXBlX2NudF0ucGlw
ZS5zY2FsZV90YXBzLmh0YXBzX2MgPSBzY2wtPnRhcHMuaF90YXBzX2M7CisJCQlwaXBlc1twaXBl
X2NudF0ucGlwZS5zY2FsZV90YXBzLnZ0YXBzID0gc2NsLT50YXBzLnZfdGFwczsKKwkJCXBpcGVz
W3BpcGVfY250XS5waXBlLnNjYWxlX3RhcHMudnRhcHNfYyA9IHNjbC0+dGFwcy52X3RhcHNfYzsK
KworCQkJc3dpenpsZV90b19kbWxfcGFyYW1zKHBsbi0+dGlsaW5nX2luZm8uZ2Z4OS5zd2l6emxl
LAorCQkJCQkmcGlwZXNbcGlwZV9jbnRdLnBpcGUuc3JjLnN3X21vZGUpOworCisJCQlzd2l0Y2gg
KHBsbi0+Zm9ybWF0KSB7CisJCQljYXNlIFNVUkZBQ0VfUElYRUxfRk9STUFUX1ZJREVPXzQyMF9Z
Q2JDcjoKKwkJCWNhc2UgU1VSRkFDRV9QSVhFTF9GT1JNQVRfVklERU9fNDIwX1lDckNiOgorCQkJ
CXBpcGVzW3BpcGVfY250XS5waXBlLnNyYy5zb3VyY2VfZm9ybWF0ID0gZG1fNDIwXzg7CisJCQkJ
YnJlYWs7CisJCQljYXNlIFNVUkZBQ0VfUElYRUxfRk9STUFUX1ZJREVPXzQyMF8xMGJwY19ZQ2JD
cjoKKwkJCWNhc2UgU1VSRkFDRV9QSVhFTF9GT1JNQVRfVklERU9fNDIwXzEwYnBjX1lDckNiOgor
CQkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNyYy5zb3VyY2VfZm9ybWF0ID0gZG1fNDIwXzEwOwor
CQkJCWJyZWFrOworCQkJY2FzZSBTVVJGQUNFX1BJWEVMX0ZPUk1BVF9HUlBIX0FSR0IxNjE2MTYx
NjoKKwkJCWNhc2UgU1VSRkFDRV9QSVhFTF9GT1JNQVRfR1JQSF9BUkdCMTYxNjE2MTZGOgorCQkJ
Y2FzZSBTVVJGQUNFX1BJWEVMX0ZPUk1BVF9HUlBIX0FCR1IxNjE2MTYxNkY6CisJCQkJcGlwZXNb
cGlwZV9jbnRdLnBpcGUuc3JjLnNvdXJjZV9mb3JtYXQgPSBkbV80NDRfNjQ7CisJCQkJYnJlYWs7
CisJCQljYXNlIFNVUkZBQ0VfUElYRUxfRk9STUFUX0dSUEhfQVJHQjE1NTU6CisJCQljYXNlIFNV
UkZBQ0VfUElYRUxfRk9STUFUX0dSUEhfUkdCNTY1OgorCQkJCXBpcGVzW3BpcGVfY250XS5waXBl
LnNyYy5zb3VyY2VfZm9ybWF0ID0gZG1fNDQ0XzE2OworCQkJCWJyZWFrOworCQkJY2FzZSBTVVJG
QUNFX1BJWEVMX0ZPUk1BVF9HUlBIX1BBTEVUQV8yNTZfQ09MT1JTOgorCQkJCXBpcGVzW3BpcGVf
Y250XS5waXBlLnNyYy5zb3VyY2VfZm9ybWF0ID0gZG1fNDQ0Xzg7CisJCQkJYnJlYWs7CisJCQlk
ZWZhdWx0OgorCQkJCXBpcGVzW3BpcGVfY250XS5waXBlLnNyYy5zb3VyY2VfZm9ybWF0ID0gZG1f
NDQ0XzMyOworCQkJCWJyZWFrOworCQkJfQorCQl9CisKKwkJcGlwZV9jbnQrKzsKKwl9CisKKwkv
KiBwb3B1bGF0ZSB3cml0ZWJhY2sgaW5mb3JtYXRpb24gKi8KKwlkYy0+cmVzX3Bvb2wtPmZ1bmNz
LT5wb3B1bGF0ZV9kbWxfd3JpdGViYWNrX2Zyb21fY29udGV4dChkYywgcmVzX2N0eCwgcGlwZXMp
OworCisJcmV0dXJuIHBpcGVfY250OworfQorCit1bnNpZ25lZCBpbnQgZGNuMjBfY2FsY19tYXhf
c2NhbGVkX3RpbWUoCisJCXVuc2lnbmVkIGludCB0aW1lX3Blcl9waXhlbCwKKwkJZW51bSBtbWh1
YmJ1Yl93YmlmX21vZGUgbW9kZSwKKwkJdW5zaWduZWQgaW50IHVyZ2VudF93YXRlcm1hcmspCit7
CisJdW5zaWduZWQgaW50IHRpbWVfcGVyX2J5dGUgPSAwOworCXVuc2lnbmVkIGludCB0b3RhbF95
X2ZyZWVfZW50cnkgPSAweDIwMDsgLyogdHdvIG1lbW9yeSBwaWVjZSBmb3IgbHVtYSAqLworCXVu
c2lnbmVkIGludCB0b3RhbF9jX2ZyZWVfZW50cnkgPSAweDE0MDsgLyogdHdvIG1lbW9yeSBwaWVj
ZSBmb3IgY2hyb21hICovCisJdW5zaWduZWQgaW50IHNtYWxsX2ZyZWVfZW50cnksIG1heF9mcmVl
X2VudHJ5OworCXVuc2lnbmVkIGludCBidWZfbGhfY2FwYWJpbGl0eTsKKwl1bnNpZ25lZCBpbnQg
bWF4X3NjYWxlZF90aW1lOworCisJaWYgKG1vZGUgPT0gUEFDS0VEXzQ0NCkgLyogcGFja2VkIG1v
ZGUgKi8KKwkJdGltZV9wZXJfYnl0ZSA9IHRpbWVfcGVyX3BpeGVsLzQ7CisJZWxzZSBpZiAobW9k
ZSA9PSBQTEFOQVJfNDIwXzhCUEMpCisJCXRpbWVfcGVyX2J5dGUgID0gdGltZV9wZXJfcGl4ZWw7
CisJZWxzZSBpZiAobW9kZSA9PSBQTEFOQVJfNDIwXzEwQlBDKSAvKiBwMDEwICovCisJCXRpbWVf
cGVyX2J5dGUgID0gdGltZV9wZXJfcGl4ZWwgKiA4MTkvMTAyNDsKKworCWlmICh0aW1lX3Blcl9i
eXRlID09IDApCisJCXRpbWVfcGVyX2J5dGUgPSAxOworCisJc21hbGxfZnJlZV9lbnRyeSAgPSAo
dG90YWxfeV9mcmVlX2VudHJ5ID4gdG90YWxfY19mcmVlX2VudHJ5KSA/IHRvdGFsX2NfZnJlZV9l
bnRyeSA6IHRvdGFsX3lfZnJlZV9lbnRyeTsKKwltYXhfZnJlZV9lbnRyeSAgICA9IChtb2RlID09
IFBBQ0tFRF80NDQpID8gdG90YWxfeV9mcmVlX2VudHJ5ICsgdG90YWxfY19mcmVlX2VudHJ5IDog
c21hbGxfZnJlZV9lbnRyeTsKKwlidWZfbGhfY2FwYWJpbGl0eSA9IG1heF9mcmVlX2VudHJ5KnRp
bWVfcGVyX2J5dGUqMzIvMTY7IC8qIHRoZXJlIGlzIDRiaXQgZnJhY3Rpb24gKi8KKwltYXhfc2Nh
bGVkX3RpbWUgICA9IGJ1Zl9saF9jYXBhYmlsaXR5IC0gdXJnZW50X3dhdGVybWFyazsKKwlyZXR1
cm4gbWF4X3NjYWxlZF90aW1lOworfQorCit2b2lkIGRjbjIwX3NldF9tY2lmX2FyYl9wYXJhbXMo
CisJCXN0cnVjdCBkYyAqZGMsCisJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCwKKwkJZGlzcGxh
eV9lMmVfcGlwZV9wYXJhbXNfc3QgKnBpcGVzLAorCQlpbnQgcGlwZV9jbnQpCit7CisJZW51bSBt
bWh1YmJ1Yl93YmlmX21vZGUgd2JpZl9tb2RlOworCXN0cnVjdCBtY2lmX2FyYl9wYXJhbXMgKndi
X2FyYl9wYXJhbXM7CisJaW50IGksIGosIGssIGR3Yl9waXBlOworCisJLyogV3JpdGViYWNrIE1D
SUZfV0IgYXJiaXRyYXRpb24gcGFyYW1ldGVycyAqLworCWR3Yl9waXBlID0gMDsKKwlmb3IgKGkg
PSAwOyBpIDwgZGMtPnJlc19wb29sLT5waXBlX2NvdW50OyBpKyspIHsKKworCQlpZiAoIWNvbnRl
eHQtPnJlc19jdHgucGlwZV9jdHhbaV0uc3RyZWFtKQorCQkJY29udGludWU7CisKKwkJZm9yIChq
ID0gMDsgaiA8IE1BWF9EV0JfUElQRVM7IGorKykgeworCQkJaWYgKGNvbnRleHQtPnJlc19jdHgu
cGlwZV9jdHhbaV0uc3RyZWFtLT53cml0ZWJhY2tfaW5mb1tqXS53Yl9lbmFibGVkID09IGZhbHNl
KQorCQkJCWNvbnRpbnVlOworCisJCQkvL3diX2FyYl9wYXJhbXMgPSAmY29udGV4dC0+cmVzX2N0
eC5waXBlX2N0eFtpXS5zdHJlYW0tPndyaXRlYmFja19pbmZvW2pdLm1jaWZfYXJiX3BhcmFtczsK
KwkJCXdiX2FyYl9wYXJhbXMgPSAmY29udGV4dC0+YndfY3R4LmJ3LmRjbi5id193cml0ZWJhY2su
bWNpZl93Yl9hcmJbZHdiX3BpcGVdOworCisJCQlpZiAoY29udGV4dC0+cmVzX2N0eC5waXBlX2N0
eFtpXS5zdHJlYW0tPndyaXRlYmFja19pbmZvW2pdLmR3Yl9wYXJhbXMub3V0X2Zvcm1hdCA9PSBk
d2Jfc2NhbGVyX21vZGVfeXV2NDIwKSB7CisJCQkJaWYgKGNvbnRleHQtPnJlc19jdHgucGlwZV9j
dHhbaV0uc3RyZWFtLT53cml0ZWJhY2tfaW5mb1tqXS5kd2JfcGFyYW1zLm91dHB1dF9kZXB0aCA9
PSBEV0JfT1VUUFVUX1BJWEVMX0RFUFRIXzhCUEMpCisJCQkJCXdiaWZfbW9kZSA9IFBMQU5BUl80
MjBfOEJQQzsKKwkJCQllbHNlCisJCQkJCXdiaWZfbW9kZSA9IFBMQU5BUl80MjBfMTBCUEM7CisJ
CQl9IGVsc2UKKwkJCQl3YmlmX21vZGUgPSBQQUNLRURfNDQ0OworCisJCQlmb3IgKGsgPSAwOyBr
IDwgc2l6ZW9mKHdiX2FyYl9wYXJhbXMtPmNsaV93YXRlcm1hcmspL3NpemVvZih3Yl9hcmJfcGFy
YW1zLT5jbGlfd2F0ZXJtYXJrWzBdKTsgaysrKSB7CisJCQkJd2JfYXJiX3BhcmFtcy0+Y2xpX3dh
dGVybWFya1trXSA9IGdldF93bV93cml0ZWJhY2tfdXJnZW50KCZjb250ZXh0LT5id19jdHguZG1s
LCBwaXBlcywgcGlwZV9jbnQpICogMTAwMDsKKwkJCQl3Yl9hcmJfcGFyYW1zLT5wc3RhdGVfd2F0
ZXJtYXJrW2tdID0gZ2V0X3dtX3dyaXRlYmFja19kcmFtX2Nsb2NrX2NoYW5nZSgmY29udGV4dC0+
YndfY3R4LmRtbCwgcGlwZXMsIHBpcGVfY250KSAqIDEwMDA7CisJCQl9CisJCQl3Yl9hcmJfcGFy
YW1zLT50aW1lX3Blcl9waXhlbCA9IDE2LjAgLyBjb250ZXh0LT5yZXNfY3R4LnBpcGVfY3R4W2ld
LnN0cmVhbS0+cGh5X3BpeF9jbGs7IC8qIDQgYml0IGZyYWN0aW9uLCBtcyAqLworCQkJd2JfYXJi
X3BhcmFtcy0+c2xpY2VfbGluZXMgPSAzMjsKKwkJCXdiX2FyYl9wYXJhbXMtPmFyYml0cmF0aW9u
X3NsaWNlID0gMjsKKwkJCXdiX2FyYl9wYXJhbXMtPm1heF9zY2FsZWRfdGltZSA9IGRjbjIwX2Nh
bGNfbWF4X3NjYWxlZF90aW1lKHdiX2FyYl9wYXJhbXMtPnRpbWVfcGVyX3BpeGVsLAorCQkJCXdi
aWZfbW9kZSwKKwkJCQl3Yl9hcmJfcGFyYW1zLT5jbGlfd2F0ZXJtYXJrWzBdKTsgLyogYXNzdW1l
IDQgd2F0ZXJtYXJrIHNldHMgaGF2ZSB0aGUgc2FtZSB2YWx1ZSAqLworCisJCQlkd2JfcGlwZSsr
OworCisJCQlpZiAoZHdiX3BpcGUgPj0gTUFYX0RXQl9QSVBFUykKKwkJCQlyZXR1cm47CisJCX0K
KwkJaWYgKGR3Yl9waXBlID49IE1BWF9EV0JfUElQRVMpCisJCQlyZXR1cm47CisJfQorfQorCiti
b29sIGRjbjIwX3ZhbGlkYXRlX2JhbmR3aWR0aChzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgZGNfc3Rh
dGUgKmNvbnRleHQpCit7CisJaW50IHBpcGVfY250LCBpLCBwaXBlX2lkeCwgdmxldmVsLCB2bGV2
ZWxfdW5zcGxpdDsKKwlpbnQgcGlwZV9zcGxpdF9mcm9tW01BWF9QSVBFU107CisJYm9vbCBvZG1f
Y2FwYWJsZSA9IGNvbnRleHQtPmJ3X2N0eC5kbWwuaXAub2RtX2NhcGFibGU7CisJYm9vbCBmb3Jj
ZV9zcGxpdCA9IGZhbHNlOworCWludCBzcGxpdF90aHJlc2hvbGQgPSBkYy0+cmVzX3Bvb2wtPnBp
cGVfY291bnQgLyAyOworCWJvb2wgYXZvaWRfc3BsaXQgPSBkYy0+ZGVidWcucGlwZV9zcGxpdF9w
b2xpY3kgIT0gTVBDX1NQTElUX0RZTkFNSUM7CisJZGlzcGxheV9lMmVfcGlwZV9wYXJhbXNfc3Qg
KnBpcGVzID0ga3phbGxvYyhkYy0+cmVzX3Bvb2wtPnBpcGVfY291bnQgKiBzaXplb2YoZGlzcGxh
eV9lMmVfcGlwZV9wYXJhbXNfc3QpLCBHRlBfS0VSTkVMKTsKKworCUFTU0VSVChwaXBlcyk7CisJ
aWYgKCFwaXBlcykKKwkJcmV0dXJuIGZhbHNlOworCisJZm9yIChpID0gMDsgaSA8IGRjLT5yZXNf
cG9vbC0+cGlwZV9jb3VudDsgaSsrKSB7CisJCXN0cnVjdCBwaXBlX2N0eCAqcGlwZSA9ICZjb250
ZXh0LT5yZXNfY3R4LnBpcGVfY3R4W2ldOworCQlzdHJ1Y3QgcGlwZV9jdHggKmhzcGxpdF9waXBl
ID0gcGlwZS0+Ym90dG9tX3BpcGU7CisKKwkJaWYgKCFoc3BsaXRfcGlwZSB8fCBoc3BsaXRfcGlw
ZS0+cGxhbmVfc3RhdGUgIT0gcGlwZS0+cGxhbmVfc3RhdGUpCisJCQljb250aW51ZTsKKworCQkv
KiBtZXJnZSBwcmV2aW91c2x5IHNwbGl0IHBpcGUgc2luY2UgbW9kZSBzdXBwb3J0IG5lZWRzIHRv
IG1ha2UgdGhlIGRlY2lzaW9uICovCisJCXBpcGUtPmJvdHRvbV9waXBlID0gaHNwbGl0X3BpcGUt
PmJvdHRvbV9waXBlOworCQlpZiAoaHNwbGl0X3BpcGUtPmJvdHRvbV9waXBlKQorCQkJaHNwbGl0
X3BpcGUtPmJvdHRvbV9waXBlLT50b3BfcGlwZSA9IHBpcGU7CisJCWhzcGxpdF9waXBlLT5wbGFu
ZV9zdGF0ZSA9IE5VTEw7CisJCWhzcGxpdF9waXBlLT5zdHJlYW0gPSBOVUxMOworCQloc3BsaXRf
cGlwZS0+dG9wX3BpcGUgPSBOVUxMOworCQloc3BsaXRfcGlwZS0+Ym90dG9tX3BpcGUgPSBOVUxM
OworCQkvKiBDbGVhciBwbGFuZV9yZXMgYW5kIHN0cmVhbV9yZXMgKi8KKwkJbWVtc2V0KCZoc3Bs
aXRfcGlwZS0+cGxhbmVfcmVzLCAwLCBzaXplb2YoaHNwbGl0X3BpcGUtPnBsYW5lX3JlcykpOwor
CQltZW1zZXQoJmhzcGxpdF9waXBlLT5zdHJlYW1fcmVzLCAwLCBzaXplb2YoaHNwbGl0X3BpcGUt
PnN0cmVhbV9yZXMpKTsKKwkJaWYgKHBpcGUtPnBsYW5lX3N0YXRlKQorCQkJcmVzb3VyY2VfYnVp
bGRfc2NhbGluZ19wYXJhbXMocGlwZSk7CisJfQorCisJcGlwZV9jbnQgPSBkY24yMF9wb3B1bGF0
ZV9kbWxfcGlwZXNfZnJvbV9jb250ZXh0KGRjLCAmY29udGV4dC0+cmVzX2N0eCwgcGlwZXMpOwor
CWlmICghcGlwZV9jbnQpCisJCWdvdG8gdmFsaWRhdGVfcGFzczsKKworCWNvbnRleHQtPmJ3X2N0
eC5kbWwuaXAub2RtX2NhcGFibGUgPSAwOworCXZsZXZlbCA9IGRtbF9nZXRfdm9sdGFnZV9sZXZl
bCgmY29udGV4dC0+YndfY3R4LmRtbCwgcGlwZXMsIHBpcGVfY250KTsKKwljb250ZXh0LT5id19j
dHguZG1sLmlwLm9kbV9jYXBhYmxlID0gb2RtX2NhcGFibGU7CisKKwlpZiAodmxldmVsID4gY29u
dGV4dC0+YndfY3R4LmRtbC5zb2MubnVtX3N0YXRlcyAmJiBvZG1fY2FwYWJsZSkKKwkJdmxldmVs
ID0gZG1sX2dldF92b2x0YWdlX2xldmVsKCZjb250ZXh0LT5id19jdHguZG1sLCBwaXBlcywgcGlw
ZV9jbnQpOworCisJaWYgKHZsZXZlbCA+IGNvbnRleHQtPmJ3X2N0eC5kbWwuc29jLm51bV9zdGF0
ZXMpCisJCWdvdG8gdmFsaWRhdGVfZmFpbDsKKworCWlmICgoY29udGV4dC0+c3RyZWFtX2NvdW50
ID4gc3BsaXRfdGhyZXNob2xkICYmIGRjLT5jdXJyZW50X3N0YXRlLT5zdHJlYW1fY291bnQgPD0g
c3BsaXRfdGhyZXNob2xkKQorCQl8fCAoY29udGV4dC0+c3RyZWFtX2NvdW50IDw9IHNwbGl0X3Ro
cmVzaG9sZCAmJiBkYy0+Y3VycmVudF9zdGF0ZS0+c3RyZWFtX2NvdW50ID4gc3BsaXRfdGhyZXNo
b2xkKSkKKwkJY29udGV4dC0+Y29tbWl0X2hpbnRzLmZ1bGxfdXBkYXRlX25lZWRlZCA9IHRydWU7
CisKKwkvKmluaXRpYWxpemUgcGlwZV9qdXN0X3NwbGl0X2Zyb20gdG8gaW52YWxpZCBpZHgqLwor
CWZvciAoaSA9IDA7IGkgPCBNQVhfUElQRVM7IGkrKykKKwkJcGlwZV9zcGxpdF9mcm9tW2ldID0g
LTE7CisKKwkvKiBTaW5nbGUgZGlzcGxheSBvbmx5IGNvbmRpdGlvbmFscyBnZXQgc2V0IGhlcmUg
Ki8KKwlmb3IgKGkgPSAwOyBpIDwgZGMtPnJlc19wb29sLT5waXBlX2NvdW50OyBpKyspIHsKKwkJ
c3RydWN0IHBpcGVfY3R4ICpwaXBlID0gJmNvbnRleHQtPnJlc19jdHgucGlwZV9jdHhbaV07CisJ
CWJvb2wgZXhpdF9sb29wID0gZmFsc2U7CisKKwkJaWYgKCFwaXBlLT5zdHJlYW0gfHwgcGlwZS0+
dG9wX3BpcGUpCisJCQljb250aW51ZTsKKworCQlpZiAoZGMtPmRlYnVnLmZvcmNlX3NpbmdsZV9k
aXNwX3BpcGVfc3BsaXQpIHsKKwkJCWlmICghZm9yY2Vfc3BsaXQpCisJCQkJZm9yY2Vfc3BsaXQg
PSB0cnVlOworCQkJZWxzZSB7CisJCQkJZm9yY2Vfc3BsaXQgPSBmYWxzZTsKKwkJCQlleGl0X2xv
b3AgPSB0cnVlOworCQkJfQorCQl9CisJCWlmIChkYy0+ZGVidWcucGlwZV9zcGxpdF9wb2xpY3kg
PT0gTVBDX1NQTElUX0FWT0lEX01VTFRfRElTUCkgeworCQkJaWYgKGF2b2lkX3NwbGl0KQorCQkJ
CWF2b2lkX3NwbGl0ID0gZmFsc2U7CisJCQllbHNlIHsKKwkJCQlhdm9pZF9zcGxpdCA9IHRydWU7
CisJCQkJZXhpdF9sb29wID0gdHJ1ZTsKKwkJCX0KKwkJfQorCQlpZiAoZXhpdF9sb29wKQorCQkJ
YnJlYWs7CisJfQorCisJaWYgKGNvbnRleHQtPnN0cmVhbV9jb3VudCA+IHNwbGl0X3RocmVzaG9s
ZCkKKwkJYXZvaWRfc3BsaXQgPSB0cnVlOworCisJdmxldmVsX3Vuc3BsaXQgPSB2bGV2ZWw7CisJ
Zm9yIChpID0gMCwgcGlwZV9pZHggPSAwOyBpIDwgZGMtPnJlc19wb29sLT5waXBlX2NvdW50OyBp
KyspIHsKKwkJaWYgKCFjb250ZXh0LT5yZXNfY3R4LnBpcGVfY3R4W2ldLnN0cmVhbSkKKwkJCWNv
bnRpbnVlOworCQlmb3IgKDsgdmxldmVsX3Vuc3BsaXQgPD0gY29udGV4dC0+YndfY3R4LmRtbC5z
b2MubnVtX3N0YXRlczsgdmxldmVsX3Vuc3BsaXQrKykKKwkJCWlmIChjb250ZXh0LT5id19jdHgu
ZG1sLnZiYS5Ob09mRFBQW3ZsZXZlbF91bnNwbGl0XVswXVtwaXBlX2lkeF0gPT0gMSkKKwkJCQli
cmVhazsKKwkJcGlwZV9pZHgrKzsKKwl9CisKKwlmb3IgKGkgPSAwLCBwaXBlX2lkeCA9IC0xOyBp
IDwgZGMtPnJlc19wb29sLT5waXBlX2NvdW50OyBpKyspIHsKKwkJc3RydWN0IHBpcGVfY3R4ICpw
aXBlID0gJmNvbnRleHQtPnJlc19jdHgucGlwZV9jdHhbaV07CisJCXN0cnVjdCBwaXBlX2N0eCAq
aHNwbGl0X3BpcGUgPSBwaXBlLT5ib3R0b21fcGlwZTsKKwkJYm9vbCBuZWVkX3NwbGl0ID0gdHJ1
ZTsKKwkJYm9vbCBuZWVkX3NwbGl0M2Q7CisKKwkJaWYgKCFwaXBlLT5zdHJlYW0gfHwgcGlwZV9z
cGxpdF9mcm9tW2ldID49IDApCisJCQljb250aW51ZTsKKworCQlwaXBlX2lkeCsrOworCisJCWlm
IChkYy0+ZGVidWcuZm9yY2Vfb2RtX2NvbWJpbmUgJiAoMSA8PCBwaXBlLT5zdHJlYW1fcmVzLnRn
LT5pbnN0KSkgeworCQkJZm9yY2Vfc3BsaXQgPSB0cnVlOworCQkJY29udGV4dC0+YndfY3R4LmRt
bC52YmEuT0RNQ29tYmluZUVuYWJsZWRbcGlwZV9pZHhdID0gdHJ1ZTsKKwkJCWNvbnRleHQtPmJ3
X2N0eC5kbWwudmJhLk9ETUNvbWJpbmVFbmFibGVQZXJTdGF0ZVt2bGV2ZWxdW3BpcGVfaWR4XSA9
IHRydWU7CisJCX0KKwkJaWYgKGZvcmNlX3NwbGl0ICYmIGNvbnRleHQtPmJ3X2N0eC5kbWwudmJh
Lk5vT2ZEUFBbdmxldmVsXVtjb250ZXh0LT5id19jdHguZG1sLnZiYS5tYXhNcGNDb21iXVtwaXBl
X2lkeF0gPT0gMSkKKwkJCWNvbnRleHQtPmJ3X2N0eC5kbWwudmJhLlJlcXVpcmVkRFBQQ0xLW3Zs
ZXZlbF1bY29udGV4dC0+YndfY3R4LmRtbC52YmEubWF4TXBjQ29tYl1bcGlwZV9pZHhdIC89IDI7
CisKKwkJaWYgKCFwaXBlLT50b3BfcGlwZSAmJiAhcGlwZS0+cGxhbmVfc3RhdGUgJiYgY29udGV4
dC0+YndfY3R4LmRtbC52YmEuT0RNQ29tYmluZUVuYWJsZWRbcGlwZV9pZHhdKSB7CisJCQloc3Bs
aXRfcGlwZSA9IGZpbmRfaWRsZV9zZWNvbmRhcnlfcGlwZSgmY29udGV4dC0+cmVzX2N0eCwgZGMt
PnJlc19wb29sLCBwaXBlKTsKKwkJCUFTU0VSVChoc3BsaXRfcGlwZSk7CisJCQlpZiAoIWRjbjIw
X3NwbGl0X3N0cmVhbV9mb3JfY29tYmluZSgKKwkJCQkJJmNvbnRleHQtPnJlc19jdHgsIGRjLT5y
ZXNfcG9vbCwKKwkJCQkJcGlwZSwgaHNwbGl0X3BpcGUsCisJCQkJCXRydWUpKQorCQkJCWdvdG8g
dmFsaWRhdGVfZmFpbDsKKwkJCXBpcGVfc3BsaXRfZnJvbVtoc3BsaXRfcGlwZS0+cGlwZV9pZHhd
ID0gcGlwZV9pZHg7CisJCQlkY24yMF9idWlsZF9tYXBwZWRfcmVzb3VyY2UoZGMsIGNvbnRleHQs
IHBpcGUtPnN0cmVhbSk7CisJCX0KKworCQlpZiAoIXBpcGUtPnBsYW5lX3N0YXRlKQorCQkJY29u
dGludWU7CisJCS8qIFNraXAgMm5kIGhhbGYgb2YgYWxyZWFkeSBzcGxpdCBwaXBlICovCisJCWlm
IChwaXBlLT50b3BfcGlwZSAmJiBwaXBlLT5wbGFuZV9zdGF0ZSA9PSBwaXBlLT50b3BfcGlwZS0+
cGxhbmVfc3RhdGUpCisJCQljb250aW51ZTsKKworCQluZWVkX3NwbGl0M2QgPSAoKHBpcGUtPnN0
cmVhbS0+dmlld19mb3JtYXQgPT0KKwkJCQlWSUVXXzNEX0ZPUk1BVF9TSURFX0JZX1NJREUgfHwK
KwkJCQlwaXBlLT5zdHJlYW0tPnZpZXdfZm9ybWF0ID09CisJCQkJVklFV18zRF9GT1JNQVRfVE9Q
X0FORF9CT1RUT00pICYmCisJCQkJKHBpcGUtPnN0cmVhbS0+dGltaW5nLnRpbWluZ18zZF9mb3Jt
YXQgPT0KKwkJCQlUSU1JTkdfM0RfRk9STUFUX1RPUF9BTkRfQk9UVE9NIHx8CisJCQkJIHBpcGUt
PnN0cmVhbS0+dGltaW5nLnRpbWluZ18zZF9mb3JtYXQgPT0KKwkJCQlUSU1JTkdfM0RfRk9STUFU
X1NJREVfQllfU0lERSkpOworCisJCWlmIChhdm9pZF9zcGxpdCAmJiB2bGV2ZWxfdW5zcGxpdCA8
PSBjb250ZXh0LT5id19jdHguZG1sLnNvYy5udW1fc3RhdGVzICYmICFmb3JjZV9zcGxpdCAmJiAh
bmVlZF9zcGxpdDNkKSB7CisJCQluZWVkX3NwbGl0ID0gZmFsc2U7CisJCQl2bGV2ZWwgPSB2bGV2
ZWxfdW5zcGxpdDsKKwkJCWNvbnRleHQtPmJ3X2N0eC5kbWwudmJhLm1heE1wY0NvbWIgPSAwOwor
CQl9IGVsc2UKKwkJCW5lZWRfc3BsaXQgPSBjb250ZXh0LT5id19jdHguZG1sLnZiYS5Ob09mRFBQ
W3ZsZXZlbF1bY29udGV4dC0+YndfY3R4LmRtbC52YmEubWF4TXBjQ29tYl1bcGlwZV9pZHhdOwor
CisJCWlmIChuZWVkX3NwbGl0M2QgfHwgbmVlZF9zcGxpdCB8fCBmb3JjZV9zcGxpdCkgeworCQkJ
aWYgKCFoc3BsaXRfcGlwZSB8fCBoc3BsaXRfcGlwZS0+cGxhbmVfc3RhdGUgIT0gcGlwZS0+cGxh
bmVfc3RhdGUpIHsKKwkJCQkvKiBwaXBlIG5vdCBzcGxpdCBwcmV2aW91c2x5IG5lZWRzIHNwbGl0
ICovCisJCQkJaHNwbGl0X3BpcGUgPSBmaW5kX2lkbGVfc2Vjb25kYXJ5X3BpcGUoJmNvbnRleHQt
PnJlc19jdHgsIGRjLT5yZXNfcG9vbCwgcGlwZSk7CisJCQkJQVNTRVJUKGhzcGxpdF9waXBlIHx8
IGZvcmNlX3NwbGl0KTsKKwkJCQlpZiAoIWhzcGxpdF9waXBlKQorCQkJCQljb250aW51ZTsKKwor
CQkJCWlmICghZGNuMjBfc3BsaXRfc3RyZWFtX2Zvcl9jb21iaW5lKAorCQkJCQkJJmNvbnRleHQt
PnJlc19jdHgsIGRjLT5yZXNfcG9vbCwKKwkJCQkJCXBpcGUsIGhzcGxpdF9waXBlLAorCQkJCQkJ
Y29udGV4dC0+YndfY3R4LmRtbC52YmEuT0RNQ29tYmluZUVuYWJsZWRbcGlwZV9pZHhdKSkKKwkJ
CQkJZ290byB2YWxpZGF0ZV9mYWlsOworCQkJCXBpcGVfc3BsaXRfZnJvbVtoc3BsaXRfcGlwZS0+
cGlwZV9pZHhdID0gcGlwZV9pZHg7CisJCQl9CisJCX0gZWxzZSBpZiAoaHNwbGl0X3BpcGUgJiYg
aHNwbGl0X3BpcGUtPnBsYW5lX3N0YXRlICE9IHBpcGUtPnBsYW5lX3N0YXRlKSB7CisJCQkvKiBX
ZSBkbyBub3Qgc3VwcG9ydCBtcG8gKyBvZG0gYXQgdGhlIG1vbWVudCAqLworCQkJaWYgKGNvbnRl
eHQtPmJ3X2N0eC5kbWwudmJhLk9ETUNvbWJpbmVFbmFibGVkW3BpcGVfaWR4XSkKKwkJCQlnb3Rv
IHZhbGlkYXRlX2ZhaWw7CisJCX0gZWxzZSBpZiAoaHNwbGl0X3BpcGUpIHsKKwkJCS8qIG1lcmdl
IHNob3VsZCBhbHJlYWR5IGhhdmUgYmVlbiBkb25lICovCisJCQlBU1NFUlQoMCk7CisJCX0KKwl9
CisKKwlmb3IgKGkgPSAwLCBwaXBlX2lkeCA9IDAsIHBpcGVfY250ID0gMDsgaSA8IGRjLT5yZXNf
cG9vbC0+cGlwZV9jb3VudDsgaSsrKSB7CisJCWlmICghY29udGV4dC0+cmVzX2N0eC5waXBlX2N0
eFtpXS5zdHJlYW0pCisJCQljb250aW51ZTsKKworCQlwaXBlc1twaXBlX2NudF0uY2xrc19jZmcu
cmVmY2xrX21oeiA9IGRjLT5yZXNfcG9vbC0+cmVmX2Nsb2Nrcy5kY2h1Yl9yZWZfY2xvY2tfaW5L
aHogLyAxMDAwLjA7CisJCXBpcGVzW3BpcGVfY250XS5jbGtzX2NmZy5kaXNwY2xrX21oeiA9IGNv
bnRleHQtPmJ3X2N0eC5kbWwudmJhLlJlcXVpcmVkRElTUENMS1t2bGV2ZWxdW2NvbnRleHQtPmJ3
X2N0eC5kbWwudmJhLm1heE1wY0NvbWJdOworCisJCWlmIChwaXBlX3NwbGl0X2Zyb21baV0gPCAw
KSB7CisJCQlwaXBlc1twaXBlX2NudF0uY2xrc19jZmcuZHBwY2xrX21oeiA9CisJCQkJCWNvbnRl
eHQtPmJ3X2N0eC5kbWwudmJhLlJlcXVpcmVkRFBQQ0xLW3ZsZXZlbF1bY29udGV4dC0+YndfY3R4
LmRtbC52YmEubWF4TXBjQ29tYl1bcGlwZV9pZHhdOworCQkJaWYgKGNvbnRleHQtPmJ3X2N0eC5k
bWwudmJhLkJsZW5kaW5nQW5kVGltaW5nW3BpcGVfaWR4XSA9PSBwaXBlX2lkeCkKKwkJCQlwaXBl
c1twaXBlX2NudF0ucGlwZS5kZXN0Lm9kbV9jb21iaW5lID0KKwkJCQkJCWNvbnRleHQtPmJ3X2N0
eC5kbWwudmJhLk9ETUNvbWJpbmVFbmFibGVQZXJTdGF0ZVt2bGV2ZWxdW3BpcGVfaWR4XTsKKwkJ
CWVsc2UKKwkJCQlwaXBlc1twaXBlX2NudF0ucGlwZS5kZXN0Lm9kbV9jb21iaW5lID0gMDsKKwkJ
CXBpcGVfaWR4Kys7CisJCX0gZWxzZSB7CisJCQlwaXBlc1twaXBlX2NudF0uY2xrc19jZmcuZHBw
Y2xrX21oeiA9CisJCQkJCWNvbnRleHQtPmJ3X2N0eC5kbWwudmJhLlJlcXVpcmVkRFBQQ0xLW3Zs
ZXZlbF1bY29udGV4dC0+YndfY3R4LmRtbC52YmEubWF4TXBjQ29tYl1bcGlwZV9zcGxpdF9mcm9t
W2ldXTsKKwkJCWlmIChjb250ZXh0LT5id19jdHguZG1sLnZiYS5CbGVuZGluZ0FuZFRpbWluZ1tw
aXBlX3NwbGl0X2Zyb21baV1dID09IHBpcGVfc3BsaXRfZnJvbVtpXSkKKwkJCQlwaXBlc1twaXBl
X2NudF0ucGlwZS5kZXN0Lm9kbV9jb21iaW5lID0KKwkJCQkJCWNvbnRleHQtPmJ3X2N0eC5kbWwu
dmJhLk9ETUNvbWJpbmVFbmFibGVQZXJTdGF0ZVt2bGV2ZWxdW3BpcGVfc3BsaXRfZnJvbVtpXV07
CisJCQllbHNlCisJCQkJcGlwZXNbcGlwZV9jbnRdLnBpcGUuZGVzdC5vZG1fY29tYmluZSA9IDA7
CisJCX0KKwkJcGlwZV9jbnQrKzsKKwl9CisKKwlpZiAocGlwZV9jbnQgIT0gcGlwZV9pZHgpCisJ
CXBpcGVfY250ID0gZGNuMjBfcG9wdWxhdGVfZG1sX3BpcGVzX2Zyb21fY29udGV4dChkYywgJmNv
bnRleHQtPnJlc19jdHgsIHBpcGVzKTsKKworCS8qIG9ubHkgcGlwZSAwIGlzIHJlYWQgZm9yIHZv
bHRhZ2UgYW5kIGRjZi9zb2MgY2xvY2tzICovCisJaWYgKHZsZXZlbCA8IDEpIHsKKwkJcGlwZXNb
MF0uY2xrc19jZmcudm9sdGFnZSA9IDE7CisJCXBpcGVzWzBdLmNsa3NfY2ZnLmRjZmNsa19taHog
PSBjb250ZXh0LT5id19jdHguZG1sLnNvYy5jbG9ja19saW1pdHNbMV0uZGNmY2xrX21oejsKKwkJ
cGlwZXNbMF0uY2xrc19jZmcuc29jY2xrX21oeiA9IGNvbnRleHQtPmJ3X2N0eC5kbWwuc29jLmNs
b2NrX2xpbWl0c1sxXS5zb2NjbGtfbWh6OworCX0KKwljb250ZXh0LT5id19jdHguYncuZGNuLndh
dGVybWFya3MuYi51cmdlbnRfbnMgPSBnZXRfd21fdXJnZW50KCZjb250ZXh0LT5id19jdHguZG1s
LCBwaXBlcywgcGlwZV9jbnQpICogMTAwMDsKKwljb250ZXh0LT5id19jdHguYncuZGNuLndhdGVy
bWFya3MuYi5jc3RhdGVfcHN0YXRlLmNzdGF0ZV9lbnRlcl9wbHVzX2V4aXRfbnMgPSBnZXRfd21f
c3R1dHRlcl9lbnRlcl9leGl0KCZjb250ZXh0LT5id19jdHguZG1sLCBwaXBlcywgcGlwZV9jbnQp
ICogMTAwMDsKKwljb250ZXh0LT5id19jdHguYncuZGNuLndhdGVybWFya3MuYi5jc3RhdGVfcHN0
YXRlLmNzdGF0ZV9leGl0X25zID0gZ2V0X3dtX3N0dXR0ZXJfZXhpdCgmY29udGV4dC0+YndfY3R4
LmRtbCwgcGlwZXMsIHBpcGVfY250KSAqIDEwMDA7CisJY29udGV4dC0+YndfY3R4LmJ3LmRjbi53
YXRlcm1hcmtzLmIuY3N0YXRlX3BzdGF0ZS5wc3RhdGVfY2hhbmdlX25zID0gZ2V0X3dtX2RyYW1f
Y2xvY2tfY2hhbmdlKCZjb250ZXh0LT5id19jdHguZG1sLCBwaXBlcywgcGlwZV9jbnQpICogMTAw
MDsKKwljb250ZXh0LT5id19jdHguYncuZGNuLndhdGVybWFya3MuYi5wdGVfbWV0YV91cmdlbnRf
bnMgPSBnZXRfd21fbWVtb3J5X3RyaXAoJmNvbnRleHQtPmJ3X2N0eC5kbWwsIHBpcGVzLCBwaXBl
X2NudCkgKiAxMDAwOworCisJaWYgKHZsZXZlbCA8IDIpIHsKKwkJcGlwZXNbMF0uY2xrc19jZmcu
dm9sdGFnZSA9IDI7CisJCXBpcGVzWzBdLmNsa3NfY2ZnLmRjZmNsa19taHogPSBjb250ZXh0LT5i
d19jdHguZG1sLnNvYy5jbG9ja19saW1pdHNbMl0uZGNmY2xrX21oejsKKwkJcGlwZXNbMF0uY2xr
c19jZmcuc29jY2xrX21oeiA9IGNvbnRleHQtPmJ3X2N0eC5kbWwuc29jLmNsb2NrX2xpbWl0c1sy
XS5zb2NjbGtfbWh6OworCX0KKwljb250ZXh0LT5id19jdHguYncuZGNuLndhdGVybWFya3MuYy51
cmdlbnRfbnMgPSBnZXRfd21fdXJnZW50KCZjb250ZXh0LT5id19jdHguZG1sLCBwaXBlcywgcGlw
ZV9jbnQpICogMTAwMDsKKwljb250ZXh0LT5id19jdHguYncuZGNuLndhdGVybWFya3MuYy5jc3Rh
dGVfcHN0YXRlLmNzdGF0ZV9lbnRlcl9wbHVzX2V4aXRfbnMgPSBnZXRfd21fc3R1dHRlcl9lbnRl
cl9leGl0KCZjb250ZXh0LT5id19jdHguZG1sLCBwaXBlcywgcGlwZV9jbnQpICogMTAwMDsKKwlj
b250ZXh0LT5id19jdHguYncuZGNuLndhdGVybWFya3MuYy5jc3RhdGVfcHN0YXRlLmNzdGF0ZV9l
eGl0X25zID0gZ2V0X3dtX3N0dXR0ZXJfZXhpdCgmY29udGV4dC0+YndfY3R4LmRtbCwgcGlwZXMs
IHBpcGVfY250KSAqIDEwMDA7CisJY29udGV4dC0+YndfY3R4LmJ3LmRjbi53YXRlcm1hcmtzLmMu
Y3N0YXRlX3BzdGF0ZS5wc3RhdGVfY2hhbmdlX25zID0gZ2V0X3dtX2RyYW1fY2xvY2tfY2hhbmdl
KCZjb250ZXh0LT5id19jdHguZG1sLCBwaXBlcywgcGlwZV9jbnQpICogMTAwMDsKKwljb250ZXh0
LT5id19jdHguYncuZGNuLndhdGVybWFya3MuYy5wdGVfbWV0YV91cmdlbnRfbnMgPSBnZXRfd21f
bWVtb3J5X3RyaXAoJmNvbnRleHQtPmJ3X2N0eC5kbWwsIHBpcGVzLCBwaXBlX2NudCkgKiAxMDAw
OworCisJaWYgKHZsZXZlbCA8IDMpIHsKKwkJcGlwZXNbMF0uY2xrc19jZmcudm9sdGFnZSA9IDM7
CisJCXBpcGVzWzBdLmNsa3NfY2ZnLmRjZmNsa19taHogPSBjb250ZXh0LT5id19jdHguZG1sLnNv
Yy5jbG9ja19saW1pdHNbMl0uZGNmY2xrX21oejsKKwkJcGlwZXNbMF0uY2xrc19jZmcuc29jY2xr
X21oeiA9IGNvbnRleHQtPmJ3X2N0eC5kbWwuc29jLmNsb2NrX2xpbWl0c1syXS5zb2NjbGtfbWh6
OworCX0KKwljb250ZXh0LT5id19jdHguYncuZGNuLndhdGVybWFya3MuZC51cmdlbnRfbnMgPSBn
ZXRfd21fdXJnZW50KCZjb250ZXh0LT5id19jdHguZG1sLCBwaXBlcywgcGlwZV9jbnQpICogMTAw
MDsKKwljb250ZXh0LT5id19jdHguYncuZGNuLndhdGVybWFya3MuZC5jc3RhdGVfcHN0YXRlLmNz
dGF0ZV9lbnRlcl9wbHVzX2V4aXRfbnMgPSBnZXRfd21fc3R1dHRlcl9lbnRlcl9leGl0KCZjb250
ZXh0LT5id19jdHguZG1sLCBwaXBlcywgcGlwZV9jbnQpICogMTAwMDsKKwljb250ZXh0LT5id19j
dHguYncuZGNuLndhdGVybWFya3MuZC5jc3RhdGVfcHN0YXRlLmNzdGF0ZV9leGl0X25zID0gZ2V0
X3dtX3N0dXR0ZXJfZXhpdCgmY29udGV4dC0+YndfY3R4LmRtbCwgcGlwZXMsIHBpcGVfY250KSAq
IDEwMDA7CisJY29udGV4dC0+YndfY3R4LmJ3LmRjbi53YXRlcm1hcmtzLmQuY3N0YXRlX3BzdGF0
ZS5wc3RhdGVfY2hhbmdlX25zID0gZ2V0X3dtX2RyYW1fY2xvY2tfY2hhbmdlKCZjb250ZXh0LT5i
d19jdHguZG1sLCBwaXBlcywgcGlwZV9jbnQpICogMTAwMDsKKwljb250ZXh0LT5id19jdHguYncu
ZGNuLndhdGVybWFya3MuZC5wdGVfbWV0YV91cmdlbnRfbnMgPSBnZXRfd21fbWVtb3J5X3RyaXAo
JmNvbnRleHQtPmJ3X2N0eC5kbWwsIHBpcGVzLCBwaXBlX2NudCkgKiAxMDAwOworCisJcGlwZXNb
MF0uY2xrc19jZmcudm9sdGFnZSA9IHZsZXZlbDsKKwlwaXBlc1swXS5jbGtzX2NmZy5kY2ZjbGtf
bWh6ID0gY29udGV4dC0+YndfY3R4LmRtbC5zb2MuY2xvY2tfbGltaXRzW3ZsZXZlbF0uZGNmY2xr
X21oejsKKwlwaXBlc1swXS5jbGtzX2NmZy5zb2NjbGtfbWh6ID0gY29udGV4dC0+YndfY3R4LmRt
bC5zb2MuY2xvY2tfbGltaXRzW3ZsZXZlbF0uc29jY2xrX21oejsKKwljb250ZXh0LT5id19jdHgu
YncuZGNuLndhdGVybWFya3MuYS51cmdlbnRfbnMgPSBnZXRfd21fdXJnZW50KCZjb250ZXh0LT5i
d19jdHguZG1sLCBwaXBlcywgcGlwZV9jbnQpICogMTAwMDsKKwljb250ZXh0LT5id19jdHguYncu
ZGNuLndhdGVybWFya3MuYS5jc3RhdGVfcHN0YXRlLmNzdGF0ZV9lbnRlcl9wbHVzX2V4aXRfbnMg
PSBnZXRfd21fc3R1dHRlcl9lbnRlcl9leGl0KCZjb250ZXh0LT5id19jdHguZG1sLCBwaXBlcywg
cGlwZV9jbnQpICogMTAwMDsKKwljb250ZXh0LT5id19jdHguYncuZGNuLndhdGVybWFya3MuYS5j
c3RhdGVfcHN0YXRlLmNzdGF0ZV9leGl0X25zID0gZ2V0X3dtX3N0dXR0ZXJfZXhpdCgmY29udGV4
dC0+YndfY3R4LmRtbCwgcGlwZXMsIHBpcGVfY250KSAqIDEwMDA7CisJY29udGV4dC0+YndfY3R4
LmJ3LmRjbi53YXRlcm1hcmtzLmEuY3N0YXRlX3BzdGF0ZS5wc3RhdGVfY2hhbmdlX25zID0gZ2V0
X3dtX2RyYW1fY2xvY2tfY2hhbmdlKCZjb250ZXh0LT5id19jdHguZG1sLCBwaXBlcywgcGlwZV9j
bnQpICogMTAwMDsKKwljb250ZXh0LT5id19jdHguYncuZGNuLndhdGVybWFya3MuYS5wdGVfbWV0
YV91cmdlbnRfbnMgPSBnZXRfd21fbWVtb3J5X3RyaXAoJmNvbnRleHQtPmJ3X2N0eC5kbWwsIHBp
cGVzLCBwaXBlX2NudCkgKiAxMDAwOworCS8qIFdyaXRlYmFjayBNQ0lGX1dCIGFyYml0cmF0aW9u
IHBhcmFtZXRlcnMgKi8KKwlkYy0+cmVzX3Bvb2wtPmZ1bmNzLT5zZXRfbWNpZl9hcmJfcGFyYW1z
KGRjLCBjb250ZXh0LCBwaXBlcywgcGlwZV9jbnQpOworCisJY29udGV4dC0+YndfY3R4LmJ3LmRj
bi5jbGsuZGlzcGNsa19raHogPSBjb250ZXh0LT5id19jdHguZG1sLnZiYS5ESVNQQ0xLICogMTAw
MDsKKwljb250ZXh0LT5id19jdHguYncuZGNuLmNsay5kY2ZjbGtfa2h6ID0gY29udGV4dC0+Yndf
Y3R4LmRtbC52YmEuRENGQ0xLICogMTAwMDsKKwljb250ZXh0LT5id19jdHguYncuZGNuLmNsay5z
b2NjbGtfa2h6ID0gY29udGV4dC0+YndfY3R4LmRtbC52YmEuU09DQ0xLICogMTAwMDsKKwljb250
ZXh0LT5id19jdHguYncuZGNuLmNsay5kcmFtY2xrX2toeiA9IGNvbnRleHQtPmJ3X2N0eC5kbWwu
dmJhLkRSQU1TcGVlZCAqIDEwMDA7CisJY29udGV4dC0+YndfY3R4LmJ3LmRjbi5jbGsuZGNmY2xr
X2RlZXBfc2xlZXBfa2h6ID0gY29udGV4dC0+YndfY3R4LmRtbC52YmEuRENGQ0xLRGVlcFNsZWVw
ICogMTAwMDsKKwljb250ZXh0LT5id19jdHguYncuZGNuLmNsay5mY2xrX2toeiA9IGNvbnRleHQt
PmJ3X2N0eC5kbWwudmJhLkZhYnJpY0Nsb2NrICogMTAwMDsKKwljb250ZXh0LT5id19jdHguYncu
ZGNuLmNsay5wX3N0YXRlX2NoYW5nZV9zdXBwb3J0ID0KKwkJY29udGV4dC0+YndfY3R4LmRtbC52
YmEuRFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFt2bGV2ZWxdW2NvbnRleHQtPmJ3X2N0eC5kbWwudmJh
Lm1heE1wY0NvbWJdCisJCQkJCQkJIT0gZG1fZHJhbV9jbG9ja19jaGFuZ2VfdW5zdXBwb3J0ZWQ7
CisJY29udGV4dC0+YndfY3R4LmJ3LmRjbi5jbGsuZHBwY2xrX2toeiA9IDA7CisKKwlmb3IgKGkg
PSAwLCBwaXBlX2lkeCA9IDA7IGkgPCBkYy0+cmVzX3Bvb2wtPnBpcGVfY291bnQ7IGkrKykgewor
CQlpZiAoIWNvbnRleHQtPnJlc19jdHgucGlwZV9jdHhbaV0uc3RyZWFtKQorCQkJY29udGludWU7
CisJCXBpcGVzW3BpcGVfaWR4XS5waXBlLmRlc3QudnN0YXJ0dXBfc3RhcnQgPSBjb250ZXh0LT5i
d19jdHguZG1sLnZiYS5WU3RhcnR1cFtwaXBlX2lkeF07CisJCXBpcGVzW3BpcGVfaWR4XS5waXBl
LmRlc3QudnVwZGF0ZV9vZmZzZXQgPSBjb250ZXh0LT5id19jdHguZG1sLnZiYS5WVXBkYXRlT2Zm
c2V0UGl4W3BpcGVfaWR4XTsKKwkJcGlwZXNbcGlwZV9pZHhdLnBpcGUuZGVzdC52dXBkYXRlX3dp
ZHRoID0gY29udGV4dC0+YndfY3R4LmRtbC52YmEuVlVwZGF0ZVdpZHRoUGl4W3BpcGVfaWR4XTsK
KwkJcGlwZXNbcGlwZV9pZHhdLnBpcGUuZGVzdC52cmVhZHlfb2Zmc2V0ID0gY29udGV4dC0+Yndf
Y3R4LmRtbC52YmEuVlJlYWR5T2Zmc2V0UGl4W3BpcGVfaWR4XTsKKwkJaWYgKGNvbnRleHQtPmJ3
X2N0eC5idy5kY24uY2xrLmRwcGNsa19raHogPCBwaXBlc1twaXBlX2lkeF0uY2xrc19jZmcuZHBw
Y2xrX21oeiAqIDEwMDApCisJCQljb250ZXh0LT5id19jdHguYncuZGNuLmNsay5kcHBjbGtfa2h6
ID0gcGlwZXNbcGlwZV9pZHhdLmNsa3NfY2ZnLmRwcGNsa19taHogKiAxMDAwOworCQljb250ZXh0
LT5yZXNfY3R4LnBpcGVfY3R4W2ldLnBsYW5lX3Jlcy5idy5kcHBjbGtfa2h6ID0KKwkJCQkJCXBp
cGVzW3BpcGVfaWR4XS5jbGtzX2NmZy5kcHBjbGtfbWh6ICogMTAwMDsKKwkJY29udGV4dC0+cmVz
X2N0eC5waXBlX2N0eFtpXS5waXBlX2RsZ19wYXJhbSA9IHBpcGVzW3BpcGVfaWR4XS5waXBlLmRl
c3Q7CisJCXBpcGVfaWR4Kys7CisJfQorCisJZm9yIChpID0gMCwgcGlwZV9pZHggPSAwOyBpIDwg
ZGMtPnJlc19wb29sLT5waXBlX2NvdW50OyBpKyspIHsKKwkJYm9vbCBjc3RhdGVfZW4gPSBjb250
ZXh0LT5id19jdHguZG1sLnZiYS5QcmVmZXRjaE1vZGVbdmxldmVsXVtjb250ZXh0LT5id19jdHgu
ZG1sLnZiYS5tYXhNcGNDb21iXSAhPSAyOworCisJCWlmICghY29udGV4dC0+cmVzX2N0eC5waXBl
X2N0eFtpXS5zdHJlYW0pCisJCQljb250aW51ZTsKKworCQljb250ZXh0LT5id19jdHguZG1sLmZ1
bmNzLnJxX2RsZ19nZXRfZGxnX3JlZygmY29udGV4dC0+YndfY3R4LmRtbCwKKwkJCQkmY29udGV4
dC0+cmVzX2N0eC5waXBlX2N0eFtpXS5kbGdfcmVncywKKwkJCQkmY29udGV4dC0+cmVzX2N0eC5w
aXBlX2N0eFtpXS50dHVfcmVncywKKwkJCQlwaXBlcywKKwkJCQlwaXBlX2NudCwKKwkJCQlwaXBl
X2lkeCwKKwkJCQljc3RhdGVfZW4sCisJCQkJY29udGV4dC0+YndfY3R4LmJ3LmRjbi5jbGsucF9z
dGF0ZV9jaGFuZ2Vfc3VwcG9ydCk7CisJCWNvbnRleHQtPmJ3X2N0eC5kbWwuZnVuY3MucnFfZGxn
X2dldF9ycV9yZWcoJmNvbnRleHQtPmJ3X2N0eC5kbWwsCisJCQkJJmNvbnRleHQtPnJlc19jdHgu
cGlwZV9jdHhbaV0ucnFfcmVncywKKwkJCQlwaXBlc1twaXBlX2lkeF0ucGlwZSk7CisJCXBpcGVf
aWR4Kys7CisJfQorCit2YWxpZGF0ZV9wYXNzOgorCWtmcmVlKHBpcGVzKTsKKwlyZXR1cm4gdHJ1
ZTsKKwordmFsaWRhdGVfZmFpbDoKKwlrZnJlZShwaXBlcyk7CisJcmV0dXJuIGZhbHNlOworfQor
CitlbnVtIGRjX3N0YXR1cyBkY24yMF92YWxpZGF0ZV9nbG9iYWwoc3RydWN0IGRjICpkYywJc3Ry
dWN0IGRjX3N0YXRlICpuZXdfY3R4KQoreworCWVudW0gZGNfc3RhdHVzIHJlc3VsdCA9IERDX09L
OworCWludCBpLCBqOworCisJLyogVmFsaWRhdGUgRFNDICovCisJZm9yIChpID0gMDsgaSA8IG5l
d19jdHgtPnN0cmVhbV9jb3VudDsgaSsrKSB7CisJCXN0cnVjdCBkY19zdHJlYW1fc3RhdGUgKnN0
cmVhbSA9IG5ld19jdHgtPnN0cmVhbXNbaV07CisKKwkJZm9yIChqID0gMDsgaiA8IGRjLT5yZXNf
cG9vbC0+cGlwZV9jb3VudDsgaisrKSB7CisJCQlzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4ID0g
Jm5ld19jdHgtPnJlc19jdHgucGlwZV9jdHhbal07CisKKwkJCWlmIChwaXBlX2N0eC0+c3RyZWFt
ICE9IHN0cmVhbSkKKwkJCQljb250aW51ZTsKKworCQl9CisJfQorCisJcmV0dXJuIHJlc3VsdDsK
K30KKworc3RydWN0IHBpcGVfY3R4ICpkY24yMF9hY3F1aXJlX2lkbGVfcGlwZV9mb3JfbGF5ZXIo
CisJCXN0cnVjdCBkY19zdGF0ZSAqc3RhdGUsCisJCWNvbnN0IHN0cnVjdCByZXNvdXJjZV9wb29s
ICpwb29sLAorCQlzdHJ1Y3QgZGNfc3RyZWFtX3N0YXRlICpzdHJlYW0pCit7CisJc3RydWN0IHJl
c291cmNlX2NvbnRleHQgKnJlc19jdHggPSAmc3RhdGUtPnJlc19jdHg7CisJc3RydWN0IHBpcGVf
Y3R4ICpoZWFkX3BpcGUgPSByZXNvdXJjZV9nZXRfaGVhZF9waXBlX2Zvcl9zdHJlYW0ocmVzX2N0
eCwgc3RyZWFtKTsKKwlzdHJ1Y3QgcGlwZV9jdHggKmlkbGVfcGlwZSA9IGZpbmRfaWRsZV9zZWNv
bmRhcnlfcGlwZShyZXNfY3R4LCBwb29sLCBoZWFkX3BpcGUpOworCisJaWYgKCFoZWFkX3BpcGUp
CisJCUFTU0VSVCgwKTsKKworCWlmICghaWRsZV9waXBlKQorCQlyZXR1cm4gZmFsc2U7CisKKwlp
ZGxlX3BpcGUtPnN0cmVhbSA9IGhlYWRfcGlwZS0+c3RyZWFtOworCWlkbGVfcGlwZS0+c3RyZWFt
X3Jlcy50ZyA9IGhlYWRfcGlwZS0+c3RyZWFtX3Jlcy50ZzsKKwlpZGxlX3BpcGUtPnN0cmVhbV9y
ZXMub3BwID0gaGVhZF9waXBlLT5zdHJlYW1fcmVzLm9wcDsKKworCWlkbGVfcGlwZS0+cGxhbmVf
cmVzLmh1YnAgPSBwb29sLT5odWJwc1tpZGxlX3BpcGUtPnBpcGVfaWR4XTsKKwlpZGxlX3BpcGUt
PnBsYW5lX3Jlcy5pcHAgPSBwb29sLT5pcHBzW2lkbGVfcGlwZS0+cGlwZV9pZHhdOworCWlkbGVf
cGlwZS0+cGxhbmVfcmVzLmRwcCA9IHBvb2wtPmRwcHNbaWRsZV9waXBlLT5waXBlX2lkeF07CisJ
aWRsZV9waXBlLT5wbGFuZV9yZXMubXBjY19pbnN0ID0gcG9vbC0+ZHBwc1tpZGxlX3BpcGUtPnBp
cGVfaWR4XS0+aW5zdDsKKworCXJldHVybiBpZGxlX3BpcGU7Cit9CisKK2Jvb2wgZGNuMjBfZ2V0
X2RjY19jb21wcmVzc2lvbl9jYXAoY29uc3Qgc3RydWN0IGRjICpkYywKKwkJY29uc3Qgc3RydWN0
IGRjX2RjY19zdXJmYWNlX3BhcmFtICppbnB1dCwKKwkJc3RydWN0IGRjX3N1cmZhY2VfZGNjX2Nh
cCAqb3V0cHV0KQoreworCXJldHVybiBkYy0+cmVzX3Bvb2wtPmh1YmJ1Yi0+ZnVuY3MtPmdldF9k
Y2NfY29tcHJlc3Npb25fY2FwKAorCQkJZGMtPnJlc19wb29sLT5odWJidWIsCisJCQlpbnB1dCwK
KwkJCW91dHB1dCk7Cit9CisKK3N0YXRpYyB2b2lkIGRjbjIwX2Rlc3Ryb3lfcmVzb3VyY2VfcG9v
bChzdHJ1Y3QgcmVzb3VyY2VfcG9vbCAqKnBvb2wpCit7CisJc3RydWN0IGRjbjIwX3Jlc291cmNl
X3Bvb2wgKmRjbjIwX3Bvb2wgPSBUT19EQ04yMF9SRVNfUE9PTCgqcG9vbCk7CisKKwlkZXN0cnVj
dChkY24yMF9wb29sKTsKKwlrZnJlZShkY24yMF9wb29sKTsKKwkqcG9vbCA9IE5VTEw7Cit9CisK
Kworc3RhdGljIHN0cnVjdCBkY19jYXBfZnVuY3MgY2FwX2Z1bmNzID0geworCS5nZXRfZGNjX2Nv
bXByZXNzaW9uX2NhcCA9IGRjbjIwX2dldF9kY2NfY29tcHJlc3Npb25fY2FwCit9OworCisKK2Vu
dW0gZGNfc3RhdHVzIGRjbjIwX2dldF9kZWZhdWx0X3N3aXp6bGVfbW9kZShzdHJ1Y3QgZGNfcGxh
bmVfc3RhdGUgKnBsYW5lX3N0YXRlKQoreworCWVudW0gZGNfc3RhdHVzIHJlc3VsdCA9IERDX09L
OworCisJZW51bSBzdXJmYWNlX3BpeGVsX2Zvcm1hdCBzdXJmX3BpeF9mb3JtYXQgPSBwbGFuZV9z
dGF0ZS0+Zm9ybWF0OworCXVuc2lnbmVkIGludCBicHAgPSByZXNvdXJjZV9waXhlbF9mb3JtYXRf
dG9fYnBwKHN1cmZfcGl4X2Zvcm1hdCk7CisKKwllbnVtIHN3aXp6bGVfbW9kZV92YWx1ZXMgc3dp
enpsZSA9IERDX1NXX0xJTkVBUjsKKworCWlmIChicHAgPT0gNjQpCisJCXN3aXp6bGUgPSBEQ19T
V182NEtCX0Q7CisJZWxzZQorCQlzd2l6emxlID0gRENfU1dfNjRLQl9TOworCisJcGxhbmVfc3Rh
dGUtPnRpbGluZ19pbmZvLmdmeDkuc3dpenpsZSA9IHN3aXp6bGU7CisJcmV0dXJuIHJlc3VsdDsK
K30KKworc3RhdGljIHN0cnVjdCByZXNvdXJjZV9mdW5jcyBkY24yMF9yZXNfcG9vbF9mdW5jcyA9
IHsKKwkuZGVzdHJveSA9IGRjbjIwX2Rlc3Ryb3lfcmVzb3VyY2VfcG9vbCwKKwkubGlua19lbmNf
Y3JlYXRlID0gZGNuMjBfbGlua19lbmNvZGVyX2NyZWF0ZSwKKwkudmFsaWRhdGVfYmFuZHdpZHRo
ID0gZGNuMjBfdmFsaWRhdGVfYmFuZHdpZHRoLAorCS52YWxpZGF0ZV9nbG9iYWwgPSBkY24yMF92
YWxpZGF0ZV9nbG9iYWwsCisJLmFjcXVpcmVfaWRsZV9waXBlX2Zvcl9sYXllciA9IGRjbjIwX2Fj
cXVpcmVfaWRsZV9waXBlX2Zvcl9sYXllciwKKwkuYWRkX3N0cmVhbV90b19jdHggPSBkY24yMF9h
ZGRfc3RyZWFtX3RvX2N0eCwKKwkucmVtb3ZlX3N0cmVhbV9mcm9tX2N0eCA9IGRjbjIwX3JlbW92
ZV9zdHJlYW1fZnJvbV9jdHgsCisJLnBvcHVsYXRlX2RtbF93cml0ZWJhY2tfZnJvbV9jb250ZXh0
ID0gZGNuMjBfcG9wdWxhdGVfZG1sX3dyaXRlYmFja19mcm9tX2NvbnRleHQsCisJLmdldF9kZWZh
dWx0X3N3aXp6bGVfbW9kZSA9IGRjbjIwX2dldF9kZWZhdWx0X3N3aXp6bGVfbW9kZSwKKwkuc2V0
X21jaWZfYXJiX3BhcmFtcyA9IGRjbjIwX3NldF9tY2lmX2FyYl9wYXJhbXMKK307CisKK3N0cnVj
dCBwcF9zbXVfZnVuY3MgKmRjbjIwX3BwX3NtdV9jcmVhdGUoc3RydWN0IGRjX2NvbnRleHQgKmN0
eCkKK3sKKwlzdHJ1Y3QgcHBfc211X2Z1bmNzICpwcF9zbXUgPSBremFsbG9jKHNpemVvZigqcHBf
c211KSwgR0ZQX0tFUk5FTCk7CisKKwlpZiAoIXBwX3NtdSkKKwkJcmV0dXJuIHBwX3NtdTsKKwor
CWRtX3BwX2dldF9mdW5jcyhjdHgsIHBwX3NtdSk7CisKKwlpZiAocHBfc211LT5jdHgudmVyICE9
IFBQX1NNVV9WRVJfTlYpCisJCXBwX3NtdSA9IG1lbXNldChwcF9zbXUsIDAsIHNpemVvZihzdHJ1
Y3QgcHBfc211X2Z1bmNzKSk7CisKKwlyZXR1cm4gcHBfc211OworfQorCit2b2lkIGRjbjIwX3Bw
X3NtdV9kZXN0cm95KHN0cnVjdCBwcF9zbXVfZnVuY3MgKipwcF9zbXUpCit7CisJaWYgKHBwX3Nt
dSAmJiAqcHBfc211KSB7CisJCWtmcmVlKCpwcF9zbXUpOworCQkqcHBfc211ID0gTlVMTDsKKwl9
Cit9CisKK3N0YXRpYyB2b2lkIGNhcF9zb2NfY2xvY2tzKAorCQlzdHJ1Y3QgX3Zjc19kcGlfc29j
X2JvdW5kaW5nX2JveF9zdCAqYmIsCisJCXN0cnVjdCBwcF9zbXVfbnZfY2xvY2tfdGFibGUgbWF4
X2Nsb2NrcykKK3sKKwlpbnQgaTsKKworCS8vIEZpcnN0IHBhc3MgLSBjYXAgYWxsIGNsb2NrcyBo
aWdoZXIgdGhhbiB0aGUgcmVwb3J0ZWQgbWF4CisJZm9yIChpID0gMDsgaSA8IGJiLT5udW1fc3Rh
dGVzOyBpKyspIHsKKwkJaWYgKChiYi0+Y2xvY2tfbGltaXRzW2ldLmRjZmNsa19taHogPiAobWF4
X2Nsb2Nrcy5kY2ZDbG9ja0luS2h6IC8gMTAwMCkpCisJCQkJJiYgbWF4X2Nsb2Nrcy5kY2ZDbG9j
a0luS2h6ICE9IDApCisJCQliYi0+Y2xvY2tfbGltaXRzW2ldLmRjZmNsa19taHogPSAobWF4X2Ns
b2Nrcy5kY2ZDbG9ja0luS2h6IC8gMTAwMCk7CisKKwkJaWYgKChiYi0+Y2xvY2tfbGltaXRzW2ld
LmRyYW1fc3BlZWRfbXRzID4gKG1heF9jbG9ja3MudUNsb2NrSW5LaHogLyAxMDAwKSAqIDE2KQor
CQkJCQkJJiYgbWF4X2Nsb2Nrcy51Q2xvY2tJbktoeiAhPSAwKQorCQkJYmItPmNsb2NrX2xpbWl0
c1tpXS5kcmFtX3NwZWVkX210cyA9IChtYXhfY2xvY2tzLnVDbG9ja0luS2h6IC8gMTAwMCkgKiAx
NjsKKworCQlpZiAoKGJiLT5jbG9ja19saW1pdHNbaV0uZmFicmljY2xrX21oeiA+IChtYXhfY2xv
Y2tzLmZhYnJpY0Nsb2NrSW5LaHogLyAxMDAwKSkKKwkJCQkJCSYmIG1heF9jbG9ja3MuZmFicmlj
Q2xvY2tJbktoeiAhPSAwKQorCQkJYmItPmNsb2NrX2xpbWl0c1tpXS5mYWJyaWNjbGtfbWh6ID0g
KG1heF9jbG9ja3MuZmFicmljQ2xvY2tJbktoeiAvIDEwMDApOworCisJCWlmICgoYmItPmNsb2Nr
X2xpbWl0c1tpXS5kaXNwY2xrX21oeiA+IChtYXhfY2xvY2tzLmRpc3BsYXlDbG9ja0luS2h6IC8g
MTAwMCkpCisJCQkJCQkmJiBtYXhfY2xvY2tzLmRpc3BsYXlDbG9ja0luS2h6ICE9IDApCisJCQli
Yi0+Y2xvY2tfbGltaXRzW2ldLmRpc3BjbGtfbWh6ID0gKG1heF9jbG9ja3MuZGlzcGxheUNsb2Nr
SW5LaHogLyAxMDAwKTsKKworCQlpZiAoKGJiLT5jbG9ja19saW1pdHNbaV0uZHBwY2xrX21oeiA+
IChtYXhfY2xvY2tzLmRwcENsb2NrSW5LaHogLyAxMDAwKSkKKwkJCQkJCSYmIG1heF9jbG9ja3Mu
ZHBwQ2xvY2tJbktoeiAhPSAwKQorCQkJYmItPmNsb2NrX2xpbWl0c1tpXS5kcHBjbGtfbWh6ID0g
KG1heF9jbG9ja3MuZHBwQ2xvY2tJbktoeiAvIDEwMDApOworCisJCWlmICgoYmItPmNsb2NrX2xp
bWl0c1tpXS5waHljbGtfbWh6ID4gKG1heF9jbG9ja3MucGh5Q2xvY2tJbktoeiAvIDEwMDApKQor
CQkJCQkJJiYgbWF4X2Nsb2Nrcy5waHlDbG9ja0luS2h6ICE9IDApCisJCQliYi0+Y2xvY2tfbGlt
aXRzW2ldLnBoeWNsa19taHogPSAobWF4X2Nsb2Nrcy5waHlDbG9ja0luS2h6IC8gMTAwMCk7CisK
KwkJaWYgKChiYi0+Y2xvY2tfbGltaXRzW2ldLnNvY2Nsa19taHogPiAobWF4X2Nsb2Nrcy5zb2ND
bG9ja0luS2h6IC8gMTAwMCkpCisJCQkJCQkmJiBtYXhfY2xvY2tzLnNvY0Nsb2NrSW5LaHogIT0g
MCkKKwkJCWJiLT5jbG9ja19saW1pdHNbaV0uc29jY2xrX21oeiA9IChtYXhfY2xvY2tzLnNvY0Ns
b2NrSW5LaHogLyAxMDAwKTsKKworCQlpZiAoKGJiLT5jbG9ja19saW1pdHNbaV0uZHNjY2xrX21o
eiA+IChtYXhfY2xvY2tzLmRzY0Nsb2NrSW5LaHogLyAxMDAwKSkKKwkJCQkJCSYmIG1heF9jbG9j
a3MuZHNjQ2xvY2tJbktoeiAhPSAwKQorCQkJYmItPmNsb2NrX2xpbWl0c1tpXS5kc2NjbGtfbWh6
ID0gKG1heF9jbG9ja3MuZHNjQ2xvY2tJbktoeiAvIDEwMDApOworCX0KKworCS8vIFNlY29uZCBw
YXNzIC0gcmVtb3ZlIGFsbCBkdXBsaWNhdGUgY2xvY2sgc3RhdGVzCisJZm9yIChpID0gYmItPm51
bV9zdGF0ZXMgLSAxOyBpID4gMTsgaS0tKSB7CisJCWJvb2wgZHVwbGljYXRlID0gdHJ1ZTsKKwor
CQlpZiAoYmItPmNsb2NrX2xpbWl0c1tpLTFdLmRjZmNsa19taHogIT0gYmItPmNsb2NrX2xpbWl0
c1tpXS5kY2ZjbGtfbWh6KQorCQkJZHVwbGljYXRlID0gZmFsc2U7CisJCWlmIChiYi0+Y2xvY2tf
bGltaXRzW2ktMV0uZGlzcGNsa19taHogIT0gYmItPmNsb2NrX2xpbWl0c1tpXS5kaXNwY2xrX21o
eikKKwkJCWR1cGxpY2F0ZSA9IGZhbHNlOworCQlpZiAoYmItPmNsb2NrX2xpbWl0c1tpLTFdLmRw
cGNsa19taHogIT0gYmItPmNsb2NrX2xpbWl0c1tpXS5kcHBjbGtfbWh6KQorCQkJZHVwbGljYXRl
ID0gZmFsc2U7CisJCWlmIChiYi0+Y2xvY2tfbGltaXRzW2ktMV0uZHJhbV9zcGVlZF9tdHMgIT0g
YmItPmNsb2NrX2xpbWl0c1tpXS5kcmFtX3NwZWVkX210cykKKwkJCWR1cGxpY2F0ZSA9IGZhbHNl
OworCQlpZiAoYmItPmNsb2NrX2xpbWl0c1tpLTFdLmRzY2Nsa19taHogIT0gYmItPmNsb2NrX2xp
bWl0c1tpXS5kc2NjbGtfbWh6KQorCQkJZHVwbGljYXRlID0gZmFsc2U7CisJCWlmIChiYi0+Y2xv
Y2tfbGltaXRzW2ktMV0uZmFicmljY2xrX21oeiAhPSBiYi0+Y2xvY2tfbGltaXRzW2ldLmZhYnJp
Y2Nsa19taHopCisJCQlkdXBsaWNhdGUgPSBmYWxzZTsKKwkJaWYgKGJiLT5jbG9ja19saW1pdHNb
aS0xXS5waHljbGtfbWh6ICE9IGJiLT5jbG9ja19saW1pdHNbaV0ucGh5Y2xrX21oeikKKwkJCWR1
cGxpY2F0ZSA9IGZhbHNlOworCQlpZiAoYmItPmNsb2NrX2xpbWl0c1tpLTFdLnNvY2Nsa19taHog
IT0gYmItPmNsb2NrX2xpbWl0c1tpXS5zb2NjbGtfbWh6KQorCQkJZHVwbGljYXRlID0gZmFsc2U7
CisKKwkJaWYgKGR1cGxpY2F0ZSkKKwkJCWJiLT5udW1fc3RhdGVzLS07CisJfQorfQorCitzdGF0
aWMgdm9pZCB1cGRhdGVfYm91bmRpbmdfYm94KHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBfdmNzX2Rw
aV9zb2NfYm91bmRpbmdfYm94X3N0ICpiYiwKKwkJc3RydWN0IHBwX3NtdV9udl9jbG9ja190YWJs
ZSAqbWF4X2Nsb2NrcywgdW5zaWduZWQgaW50ICp1Y2xrX3N0YXRlcywgdW5zaWduZWQgaW50IG51
bV9zdGF0ZXMpCit7CisJc3RydWN0IF92Y3NfZHBpX3ZvbHRhZ2Vfc2NhbGluZ19zdCBjYWxjdWxh
dGVkX3N0YXRlc1tNQVhfQ0xPQ0tfTElNSVRfU1RBVEVTXSA9IHswfTsKKwlpbnQgaSwgajsKKwlp
bnQgbnVtX2NhbGN1bGF0ZWRfc3RhdGVzID0gMDsKKworCWlmIChudW1fc3RhdGVzID09IDApCisJ
CXJldHVybjsKKworCWZvciAoaSA9IDA7IGkgPCBudW1fc3RhdGVzOyBpKyspIHsKKwkJLy8gRmlu
ZCBsb3dlc3QgcHJlLXNpbGljb24gRFBNIHRoYXQgaGFzIGVxdWFsIG9yIGhpZ2hlciB1Q0xLCisJ
CWZvciAoaiA9IDA7IGogPCBiYi0+bnVtX3N0YXRlczsgaisrKSB7CisJCQlpZiAoYmItPmNsb2Nr
X2xpbWl0c1tqXS5kcmFtX3NwZWVkX210cyAqIDEwMDAgLyAxNiA+PSB1Y2xrX3N0YXRlc1tpXSkK
KwkJCQlicmVhazsKKwkJfQorCisJCS8vIElmIGZvciBzb21lIHJlYXNvbiB0aGUgYXZhaWxhYmxl
IHVDTEsgaXMgaGlnaGVyIHRoYW4gYWxsIHByZS1zaWxpY29uJworCQkvLyBEUE0gdGFyZ2V0cywg
dGhlbiB3ZSBqdXN0IHVzZSB0aGUgaGlnaGVzdCBvbmUKKwkJaWYgKGogPj0gYmItPm51bV9zdGF0
ZXMpCisJCQlqID0gYmItPm51bV9zdGF0ZXM7CisKKwkJLy8gQ29weSB0aGF0IHN0YXRlCisJCW1l
bWNweSgmY2FsY3VsYXRlZF9zdGF0ZXNbbnVtX2NhbGN1bGF0ZWRfc3RhdGVzXSwgJmJiLT5jbG9j
a19saW1pdHNbal0sCisJCQkJc2l6ZW9mKGNhbGN1bGF0ZWRfc3RhdGVzW251bV9jYWxjdWxhdGVk
X3N0YXRlc10pKTsKKworCQkvLyBDYXAgdUNsayB0byBhY3R1YWwKKwkJY2FsY3VsYXRlZF9zdGF0
ZXNbbnVtX2NhbGN1bGF0ZWRfc3RhdGVzXS5kcmFtX3NwZWVkX210cyA9IHVjbGtfc3RhdGVzW2ld
ICogMTYgLyAxMDAwOworCQkvLyBQaHkgY2xvY2sgY2FuIGJlIHNldCB0byBtYXggZm9yIGFsbCBz
dGF0ZXMsIHNpbmNlIHRoZXJlJ3Mgbm90aGluZyB0byBvcHRpbWl6ZQorCQkvLyBmb3Igc3ByZWFk
c2hlZXQgYW5kIHdlIHJlcXVlc3Qgdm9sdGFnZSBmb3IgcGh5IGNsb2NrIGJ5IGZyZXF1ZW5jeSBh
bnl3YXkKKwkJY2FsY3VsYXRlZF9zdGF0ZXNbbnVtX2NhbGN1bGF0ZWRfc3RhdGVzXS5waHljbGtf
bWh6ID0gbWF4X2Nsb2Nrcy0+cGh5Q2xvY2tJbktoeiAvIDEwMDA7CisKKwkJY2FsY3VsYXRlZF9z
dGF0ZXNbbnVtX2NhbGN1bGF0ZWRfc3RhdGVzXS5zdGF0ZSA9IG51bV9jYWxjdWxhdGVkX3N0YXRl
czsKKworCQludW1fY2FsY3VsYXRlZF9zdGF0ZXMrKzsKKwl9CisKKwlpZiAobWF4X2Nsb2Nrcy0+
ZGNmQ2xvY2tJbktoeiA+IDApCisJCWNhbGN1bGF0ZWRfc3RhdGVzW251bV9jYWxjdWxhdGVkX3N0
YXRlcyAtIDFdLmRjZmNsa19taHogPSBtYXhfY2xvY2tzLT5kY2ZDbG9ja0luS2h6IC8gMTAwMDsK
KworCWlmIChtYXhfY2xvY2tzLT5kaXNwbGF5Q2xvY2tJbktoeiA+IDApIHsKKwkJY2FsY3VsYXRl
ZF9zdGF0ZXNbbnVtX2NhbGN1bGF0ZWRfc3RhdGVzIC0gMV0uZGlzcGNsa19taHogPSBtYXhfY2xv
Y2tzLT5kaXNwbGF5Q2xvY2tJbktoeiAvIDEwMDA7CisJCWNhbGN1bGF0ZWRfc3RhdGVzW251bV9j
YWxjdWxhdGVkX3N0YXRlcyAtIDFdLmRwcGNsa19taHogPSBtYXhfY2xvY2tzLT5kaXNwbGF5Q2xv
Y2tJbktoeiAvIDEwMDA7CisJCS8vIERTQyBhbHdheXMgcnVucyBhdCAxLzMgb2YgZGlzcCBjbG9j
aworCQljYWxjdWxhdGVkX3N0YXRlc1tudW1fY2FsY3VsYXRlZF9zdGF0ZXMgLSAxXS5kc2NjbGtf
bWh6ID0gbWF4X2Nsb2Nrcy0+ZGlzcGxheUNsb2NrSW5LaHogLyAoMTAwMCAqIDMpOworCX0KKwor
CWlmIChtYXhfY2xvY2tzLT5zb2NDbG9ja0luS2h6ID4gMCkKKwkJY2FsY3VsYXRlZF9zdGF0ZXNb
bnVtX2NhbGN1bGF0ZWRfc3RhdGVzIC0gMV0uc29jY2xrX21oeiA9IG1heF9jbG9ja3MtPnNvY0Ns
b2NrSW5LaHogLyAxMDAwOworCisJbWVtY3B5KGJiLT5jbG9ja19saW1pdHMsIGNhbGN1bGF0ZWRf
c3RhdGVzLCBzaXplb2YoYmItPmNsb2NrX2xpbWl0cykpOworCWJiLT5udW1fc3RhdGVzID0gbnVt
X2NhbGN1bGF0ZWRfc3RhdGVzOworfQorCitzdGF0aWMgdm9pZCBwYXRjaF9ib3VuZGluZ19ib3go
c3RydWN0IGRjICpkYywgc3RydWN0IF92Y3NfZHBpX3NvY19ib3VuZGluZ19ib3hfc3QgKmJiKQor
eworCWtlcm5lbF9mcHVfYmVnaW4oKTsKKwlpZiAoKGludCkoYmItPnNyX2V4aXRfdGltZV91cyAq
IDEwMDApICE9IGRjLT5iYl9vdmVycmlkZXMuc3JfZXhpdF90aW1lX25zCisJCQkmJiBkYy0+YmJf
b3ZlcnJpZGVzLnNyX2V4aXRfdGltZV9ucykgeworCQliYi0+c3JfZXhpdF90aW1lX3VzID0gZGMt
PmJiX292ZXJyaWRlcy5zcl9leGl0X3RpbWVfbnMgLyAxMDAwLjA7CisJfQorCisJaWYgKChpbnQp
KGJiLT5zcl9lbnRlcl9wbHVzX2V4aXRfdGltZV91cyAqIDEwMDApCisJCQkJIT0gZGMtPmJiX292
ZXJyaWRlcy5zcl9lbnRlcl9wbHVzX2V4aXRfdGltZV9ucworCQkJJiYgZGMtPmJiX292ZXJyaWRl
cy5zcl9lbnRlcl9wbHVzX2V4aXRfdGltZV9ucykgeworCQliYi0+c3JfZW50ZXJfcGx1c19leGl0
X3RpbWVfdXMgPQorCQkJCWRjLT5iYl9vdmVycmlkZXMuc3JfZW50ZXJfcGx1c19leGl0X3RpbWVf
bnMgLyAxMDAwLjA7CisJfQorCisJaWYgKChpbnQpKGJiLT51cmdlbnRfbGF0ZW5jeV91cyAqIDEw
MDApICE9IGRjLT5iYl9vdmVycmlkZXMudXJnZW50X2xhdGVuY3lfbnMKKwkJCSYmIGRjLT5iYl9v
dmVycmlkZXMudXJnZW50X2xhdGVuY3lfbnMpIHsKKwkJYmItPnVyZ2VudF9sYXRlbmN5X3VzID0g
ZGMtPmJiX292ZXJyaWRlcy51cmdlbnRfbGF0ZW5jeV9ucyAvIDEwMDAuMDsKKwl9CisKKwlpZiAo
KGludCkoYmItPmRyYW1fY2xvY2tfY2hhbmdlX2xhdGVuY3lfdXMgKiAxMDAwKQorCQkJCSE9IGRj
LT5iYl9vdmVycmlkZXMuZHJhbV9jbG9ja19jaGFuZ2VfbGF0ZW5jeV9ucworCQkJJiYgZGMtPmJi
X292ZXJyaWRlcy5kcmFtX2Nsb2NrX2NoYW5nZV9sYXRlbmN5X25zKSB7CisJCWJiLT5kcmFtX2Ns
b2NrX2NoYW5nZV9sYXRlbmN5X3VzID0KKwkJCQlkYy0+YmJfb3ZlcnJpZGVzLmRyYW1fY2xvY2tf
Y2hhbmdlX2xhdGVuY3lfbnMgLyAxMDAwLjA7CisJfQorCWtlcm5lbF9mcHVfZW5kKCk7Cit9CisK
KyNkZWZpbmUgZml4ZWQxNl90b19kb3VibGUoeCkgKCgoZG91YmxlKSB4KSAvICgoZG91YmxlKSAo
MSA8PCAxNikpKQorI2RlZmluZSBmaXhlZDE2X3RvX2RvdWJsZV90b19jcHUoeCkgZml4ZWQxNl90
b19kb3VibGUobGUzMl90b19jcHUoeCkpCisKK3N0YXRpYyBib29sIGluaXRfc29jX2JvdW5kaW5n
X2JveChzdHJ1Y3QgZGMgKmRjLAorCQkJCSAgc3RydWN0IGRjbjIwX3Jlc291cmNlX3Bvb2wgKnBv
b2wpCit7CisJY29uc3Qgc3RydWN0IGdwdV9pbmZvX3NvY19ib3VuZGluZ19ib3hfdjFfMCAqYmIg
PSBkYy0+c29jX2JvdW5kaW5nX2JveDsKKwlEQ19MT0dHRVJfSU5JVChkYy0+Y3R4LT5sb2dnZXIp
OworCisJaWYgKCFiYiAmJiAhU09DX0JPVU5ESU5HX0JPWF9WQUxJRCkgeworCQlEQ19MT0dfRVJS
T1IoIiVzOiBub3QgdmFsaWQgc29jIGJvdW5kaW5nIGJveC9uIiwgX19mdW5jX18pOworCQlyZXR1
cm4gZmFsc2U7CisJfQorCisJaWYgKGJiICYmICFTT0NfQk9VTkRJTkdfQk9YX1ZBTElEKSB7CisJ
CWludCBpOworCisJCWRjbjJfMF9zb2Muc3JfZXhpdF90aW1lX3VzID0KKwkJCQlmaXhlZDE2X3Rv
X2RvdWJsZV90b19jcHUoYmItPnNyX2V4aXRfdGltZV91cyk7CisJCWRjbjJfMF9zb2Muc3JfZW50
ZXJfcGx1c19leGl0X3RpbWVfdXMgPQorCQkJCWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+
c3JfZW50ZXJfcGx1c19leGl0X3RpbWVfdXMpOworCQlkY24yXzBfc29jLnVyZ2VudF9sYXRlbmN5
X3VzID0KKwkJCQlmaXhlZDE2X3RvX2RvdWJsZV90b19jcHUoYmItPnVyZ2VudF9sYXRlbmN5X3Vz
KTsKKwkJZGNuMl8wX3NvYy51cmdlbnRfbGF0ZW5jeV9waXhlbF9kYXRhX29ubHlfdXMgPQorCQkJ
CWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+dXJnZW50X2xhdGVuY3lfcGl4ZWxfZGF0YV9v
bmx5X3VzKTsKKwkJZGNuMl8wX3NvYy51cmdlbnRfbGF0ZW5jeV9waXhlbF9taXhlZF93aXRoX3Zt
X2RhdGFfdXMgPQorCQkJCWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+dXJnZW50X2xhdGVu
Y3lfcGl4ZWxfbWl4ZWRfd2l0aF92bV9kYXRhX3VzKTsKKwkJZGNuMl8wX3NvYy51cmdlbnRfbGF0
ZW5jeV92bV9kYXRhX29ubHlfdXMgPQorCQkJCWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+
dXJnZW50X2xhdGVuY3lfdm1fZGF0YV9vbmx5X3VzKTsKKwkJZGNuMl8wX3NvYy51cmdlbnRfb3V0
X29mX29yZGVyX3JldHVybl9wZXJfY2hhbm5lbF9waXhlbF9vbmx5X2J5dGVzID0KKwkJCQlsZTMy
X3RvX2NwdShiYi0+dXJnZW50X291dF9vZl9vcmRlcl9yZXR1cm5fcGVyX2NoYW5uZWxfcGl4ZWxf
b25seV9ieXRlcyk7CisJCWRjbjJfMF9zb2MudXJnZW50X291dF9vZl9vcmRlcl9yZXR1cm5fcGVy
X2NoYW5uZWxfcGl4ZWxfYW5kX3ZtX2J5dGVzID0KKwkJCQlsZTMyX3RvX2NwdShiYi0+dXJnZW50
X291dF9vZl9vcmRlcl9yZXR1cm5fcGVyX2NoYW5uZWxfcGl4ZWxfYW5kX3ZtX2J5dGVzKTsKKwkJ
ZGNuMl8wX3NvYy51cmdlbnRfb3V0X29mX29yZGVyX3JldHVybl9wZXJfY2hhbm5lbF92bV9vbmx5
X2J5dGVzID0KKwkJCQlsZTMyX3RvX2NwdShiYi0+dXJnZW50X291dF9vZl9vcmRlcl9yZXR1cm5f
cGVyX2NoYW5uZWxfdm1fb25seV9ieXRlcyk7CisJCWRjbjJfMF9zb2MucGN0X2lkZWFsX2RyYW1f
c2RwX2J3X2FmdGVyX3VyZ2VudF9waXhlbF9vbmx5ID0KKwkJCQlmaXhlZDE2X3RvX2RvdWJsZV90
b19jcHUoYmItPnBjdF9pZGVhbF9kcmFtX3NkcF9id19hZnRlcl91cmdlbnRfcGl4ZWxfb25seSk7
CisJCWRjbjJfMF9zb2MucGN0X2lkZWFsX2RyYW1fc2RwX2J3X2FmdGVyX3VyZ2VudF9waXhlbF9h
bmRfdm0gPQorCQkJCWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+cGN0X2lkZWFsX2RyYW1f
c2RwX2J3X2FmdGVyX3VyZ2VudF9waXhlbF9hbmRfdm0pOworCQlkY24yXzBfc29jLnBjdF9pZGVh
bF9kcmFtX3NkcF9id19hZnRlcl91cmdlbnRfdm1fb25seSA9CisJCQkJZml4ZWQxNl90b19kb3Vi
bGVfdG9fY3B1KGJiLT5wY3RfaWRlYWxfZHJhbV9zZHBfYndfYWZ0ZXJfdXJnZW50X3ZtX29ubHkp
OworCQlkY24yXzBfc29jLm1heF9hdmdfc2RwX2J3X3VzZV9ub3JtYWxfcGVyY2VudCA9CisJCQkJ
Zml4ZWQxNl90b19kb3VibGVfdG9fY3B1KGJiLT5tYXhfYXZnX3NkcF9id191c2Vfbm9ybWFsX3Bl
cmNlbnQpOworCQlkY24yXzBfc29jLm1heF9hdmdfZHJhbV9id191c2Vfbm9ybWFsX3BlcmNlbnQg
PQorCQkJCWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+bWF4X2F2Z19kcmFtX2J3X3VzZV9u
b3JtYWxfcGVyY2VudCk7CisJCWRjbjJfMF9zb2Mud3JpdGViYWNrX2xhdGVuY3lfdXMgPQorCQkJ
CWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+d3JpdGViYWNrX2xhdGVuY3lfdXMpOworCQlk
Y24yXzBfc29jLmlkZWFsX2RyYW1fYndfYWZ0ZXJfdXJnZW50X3BlcmNlbnQgPQorCQkJCWZpeGVk
MTZfdG9fZG91YmxlX3RvX2NwdShiYi0+aWRlYWxfZHJhbV9id19hZnRlcl91cmdlbnRfcGVyY2Vu
dCk7CisJCWRjbjJfMF9zb2MubWF4X3JlcXVlc3Rfc2l6ZV9ieXRlcyA9CisJCQkJbGUzMl90b19j
cHUoYmItPm1heF9yZXF1ZXN0X3NpemVfYnl0ZXMpOworCQlkY24yXzBfc29jLmRyYW1fY2hhbm5l
bF93aWR0aF9ieXRlcyA9CisJCQkJbGUzMl90b19jcHUoYmItPmRyYW1fY2hhbm5lbF93aWR0aF9i
eXRlcyk7CisJCWRjbjJfMF9zb2MuZmFicmljX2RhdGFwYXRoX3RvX2Rjbl9kYXRhX3JldHVybl9i
eXRlcyA9CisJCQkJbGUzMl90b19jcHUoYmItPmZhYnJpY19kYXRhcGF0aF90b19kY25fZGF0YV9y
ZXR1cm5fYnl0ZXMpOworCQlkY24yXzBfc29jLmRjbl9kb3duc3ByZWFkX3BlcmNlbnQgPQorCQkJ
CWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+ZGNuX2Rvd25zcHJlYWRfcGVyY2VudCk7CisJ
CWRjbjJfMF9zb2MuZG93bnNwcmVhZF9wZXJjZW50ID0KKwkJCQlmaXhlZDE2X3RvX2RvdWJsZV90
b19jcHUoYmItPmRvd25zcHJlYWRfcGVyY2VudCk7CisJCWRjbjJfMF9zb2MuZHJhbV9wYWdlX29w
ZW5fdGltZV9ucyA9CisJCQkJZml4ZWQxNl90b19kb3VibGVfdG9fY3B1KGJiLT5kcmFtX3BhZ2Vf
b3Blbl90aW1lX25zKTsKKwkJZGNuMl8wX3NvYy5kcmFtX3J3X3R1cm5hcm91bmRfdGltZV9ucyA9
CisJCQkJZml4ZWQxNl90b19kb3VibGVfdG9fY3B1KGJiLT5kcmFtX3J3X3R1cm5hcm91bmRfdGlt
ZV9ucyk7CisJCWRjbjJfMF9zb2MuZHJhbV9yZXR1cm5fYnVmZmVyX3Blcl9jaGFubmVsX2J5dGVz
ID0KKwkJCQlsZTMyX3RvX2NwdShiYi0+ZHJhbV9yZXR1cm5fYnVmZmVyX3Blcl9jaGFubmVsX2J5
dGVzKTsKKwkJZGNuMl8wX3NvYy5yb3VuZF90cmlwX3BpbmdfbGF0ZW5jeV9kY2ZjbGtfY3ljbGVz
ID0KKwkJCQlsZTMyX3RvX2NwdShiYi0+cm91bmRfdHJpcF9waW5nX2xhdGVuY3lfZGNmY2xrX2N5
Y2xlcyk7CisJCWRjbjJfMF9zb2MudXJnZW50X291dF9vZl9vcmRlcl9yZXR1cm5fcGVyX2NoYW5u
ZWxfYnl0ZXMgPQorCQkJCWxlMzJfdG9fY3B1KGJiLT51cmdlbnRfb3V0X29mX29yZGVyX3JldHVy
bl9wZXJfY2hhbm5lbF9ieXRlcyk7CisJCWRjbjJfMF9zb2MuY2hhbm5lbF9pbnRlcmxlYXZlX2J5
dGVzID0KKwkJCQlsZTMyX3RvX2NwdShiYi0+Y2hhbm5lbF9pbnRlcmxlYXZlX2J5dGVzKTsKKwkJ
ZGNuMl8wX3NvYy5udW1fYmFua3MgPQorCQkJCWxlMzJfdG9fY3B1KGJiLT5udW1fYmFua3MpOwor
CQlkY24yXzBfc29jLm51bV9jaGFucyA9CisJCQkJbGUzMl90b19jcHUoYmItPm51bV9jaGFucyk7
CisJCWRjbjJfMF9zb2Mudm1tX3BhZ2Vfc2l6ZV9ieXRlcyA9CisJCQkJbGUzMl90b19jcHUoYmIt
PnZtbV9wYWdlX3NpemVfYnl0ZXMpOworCQlkY24yXzBfc29jLmRyYW1fY2xvY2tfY2hhbmdlX2xh
dGVuY3lfdXMgPQorCQkJCWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+ZHJhbV9jbG9ja19j
aGFuZ2VfbGF0ZW5jeV91cyk7CisJCWRjbjJfMF9zb2Mud3JpdGViYWNrX2RyYW1fY2xvY2tfY2hh
bmdlX2xhdGVuY3lfdXMgPQorCQkJCWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+d3JpdGVi
YWNrX2RyYW1fY2xvY2tfY2hhbmdlX2xhdGVuY3lfdXMpOworCQlkY24yXzBfc29jLnJldHVybl9i
dXNfd2lkdGhfYnl0ZXMgPQorCQkJCWxlMzJfdG9fY3B1KGJiLT5yZXR1cm5fYnVzX3dpZHRoX2J5
dGVzKTsKKwkJZGNuMl8wX3NvYy5kaXNwY2xrX2RwcGNsa192Y29fc3BlZWRfbWh6ID0KKwkJCQls
ZTMyX3RvX2NwdShiYi0+ZGlzcGNsa19kcHBjbGtfdmNvX3NwZWVkX21oeik7CisJCWRjbjJfMF9z
b2MueGZjX2J1c190cmFuc3BvcnRfdGltZV91cyA9CisJCQkJbGUzMl90b19jcHUoYmItPnhmY19i
dXNfdHJhbnNwb3J0X3RpbWVfdXMpOworCQlkY24yXzBfc29jLnhmY194YnVmX2xhdGVuY3lfdG9s
ZXJhbmNlX3VzID0KKwkJCQlsZTMyX3RvX2NwdShiYi0+eGZjX3hidWZfbGF0ZW5jeV90b2xlcmFu
Y2VfdXMpOworCQlkY24yXzBfc29jLnVzZV91cmdlbnRfYnVyc3RfYncgPQorCQkJCWxlMzJfdG9f
Y3B1KGJiLT51c2VfdXJnZW50X2J1cnN0X2J3KTsKKwkJZGNuMl8wX3NvYy5udW1fc3RhdGVzID0K
KwkJCQlsZTMyX3RvX2NwdShiYi0+bnVtX3N0YXRlcyk7CisKKwkJZm9yIChpID0gMDsgaSA8IGRj
bjJfMF9zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJCQlkY24yXzBfc29jLmNsb2NrX2xpbWl0c1tp
XS5zdGF0ZSA9CisJCQkJCWxlMzJfdG9fY3B1KGJiLT5jbG9ja19saW1pdHNbaV0uc3RhdGUpOwor
CQkJZGNuMl8wX3NvYy5jbG9ja19saW1pdHNbaV0uZGNmY2xrX21oeiA9CisJCQkJCWZpeGVkMTZf
dG9fZG91YmxlX3RvX2NwdShiYi0+Y2xvY2tfbGltaXRzW2ldLmRjZmNsa19taHopOworCQkJZGNu
Ml8wX3NvYy5jbG9ja19saW1pdHNbaV0uZmFicmljY2xrX21oeiA9CisJCQkJCWZpeGVkMTZfdG9f
ZG91YmxlX3RvX2NwdShiYi0+Y2xvY2tfbGltaXRzW2ldLmZhYnJpY2Nsa19taHopOworCQkJZGNu
Ml8wX3NvYy5jbG9ja19saW1pdHNbaV0uZGlzcGNsa19taHogPQorCQkJCQlmaXhlZDE2X3RvX2Rv
dWJsZV90b19jcHUoYmItPmNsb2NrX2xpbWl0c1tpXS5kaXNwY2xrX21oeik7CisJCQlkY24yXzBf
c29jLmNsb2NrX2xpbWl0c1tpXS5kcHBjbGtfbWh6ID0KKwkJCQkJZml4ZWQxNl90b19kb3VibGVf
dG9fY3B1KGJiLT5jbG9ja19saW1pdHNbaV0uZHBwY2xrX21oeik7CisJCQlkY24yXzBfc29jLmNs
b2NrX2xpbWl0c1tpXS5waHljbGtfbWh6ID0KKwkJCQkJZml4ZWQxNl90b19kb3VibGVfdG9fY3B1
KGJiLT5jbG9ja19saW1pdHNbaV0ucGh5Y2xrX21oeik7CisJCQlkY24yXzBfc29jLmNsb2NrX2xp
bWl0c1tpXS5zb2NjbGtfbWh6ID0KKwkJCQkJZml4ZWQxNl90b19kb3VibGVfdG9fY3B1KGJiLT5j
bG9ja19saW1pdHNbaV0uc29jY2xrX21oeik7CisJCQlkY24yXzBfc29jLmNsb2NrX2xpbWl0c1tp
XS5kc2NjbGtfbWh6ID0KKwkJCQkJZml4ZWQxNl90b19kb3VibGVfdG9fY3B1KGJiLT5jbG9ja19s
aW1pdHNbaV0uZHNjY2xrX21oeik7CisJCQlkY24yXzBfc29jLmNsb2NrX2xpbWl0c1tpXS5kcmFt
X3NwZWVkX210cyA9CisJCQkJCWZpeGVkMTZfdG9fZG91YmxlX3RvX2NwdShiYi0+Y2xvY2tfbGlt
aXRzW2ldLmRyYW1fc3BlZWRfbXRzKTsKKwkJfQorCX0KKworCWlmIChwb29sLT5iYXNlLnBwX3Nt
dSkgeworCQlzdHJ1Y3QgcHBfc211X252X2Nsb2NrX3RhYmxlIG1heF9jbG9ja3MgPSB7MH07CisJ
CXVuc2lnbmVkIGludCB1Y2xrX3N0YXRlc1s4XSA9IHswfTsKKwkJdW5zaWduZWQgaW50IG51bV9z
dGF0ZXMgPSAwOworCQllbnVtIHBwX3NtdV9zdGF0dXMgc3RhdHVzOworCQlib29sIGNsb2NrX2xp
bWl0c19hdmFpbGFibGUgPSBmYWxzZTsKKwkJYm9vbCB1Y2xrX3N0YXRlc19hdmFpbGFibGUgPSBm
YWxzZTsKKworCQlpZiAocG9vbC0+YmFzZS5wcF9zbXUtPm52X2Z1bmNzLmdldF91Y2xrX2RwbV9z
dGF0ZXMpIHsKKwkJCXN0YXR1cyA9IChwb29sLT5iYXNlLnBwX3NtdS0+bnZfZnVuY3MuZ2V0X3Vj
bGtfZHBtX3N0YXRlcykKKwkJCQkoJnBvb2wtPmJhc2UucHBfc211LT5udl9mdW5jcy5wcF9zbXUs
IHVjbGtfc3RhdGVzLCAmbnVtX3N0YXRlcyk7CisKKwkJCXVjbGtfc3RhdGVzX2F2YWlsYWJsZSA9
IChzdGF0dXMgPT0gUFBfU01VX1JFU1VMVF9PSyk7CisJCX0KKworCQlpZiAocG9vbC0+YmFzZS5w
cF9zbXUtPm52X2Z1bmNzLmdldF9tYXhpbXVtX3N1c3RhaW5hYmxlX2Nsb2NrcykgeworCQkJc3Rh
dHVzID0gKCpwb29sLT5iYXNlLnBwX3NtdS0+bnZfZnVuY3MuZ2V0X21heGltdW1fc3VzdGFpbmFi
bGVfY2xvY2tzKQorCQkJCQkoJnBvb2wtPmJhc2UucHBfc211LT5udl9mdW5jcy5wcF9zbXUsICZt
YXhfY2xvY2tzKTsKKworCQkJY2xvY2tfbGltaXRzX2F2YWlsYWJsZSA9IChzdGF0dXMgPT0gUFBf
U01VX1JFU1VMVF9PSyk7CisJCX0KKworCQlpZiAoY2xvY2tfbGltaXRzX2F2YWlsYWJsZSAmJiB1
Y2xrX3N0YXRlc19hdmFpbGFibGUpCisJCQl1cGRhdGVfYm91bmRpbmdfYm94KGRjLCAmZGNuMl8w
X3NvYywgJm1heF9jbG9ja3MsIHVjbGtfc3RhdGVzLCBudW1fc3RhdGVzKTsKKwkJZWxzZSBpZiAo
Y2xvY2tfbGltaXRzX2F2YWlsYWJsZSkKKwkJCWNhcF9zb2NfY2xvY2tzKCZkY24yXzBfc29jLCBt
YXhfY2xvY2tzKTsKKwl9CisKKwlkY24yXzBfaXAubWF4X251bV9vdGcgPSBwb29sLT5iYXNlLnJl
c19jYXAtPm51bV90aW1pbmdfZ2VuZXJhdG9yOworCWRjbjJfMF9pcC5tYXhfbnVtX2RwcCA9IHBv
b2wtPmJhc2UucGlwZV9jb3VudDsKKwlwYXRjaF9ib3VuZGluZ19ib3goZGMsICZkY24yXzBfc29j
KTsKKworCXJldHVybiB0cnVlOworfQorCitzdGF0aWMgYm9vbCBjb25zdHJ1Y3QoCisJdWludDhf
dCBudW1fdmlydHVhbF9saW5rcywKKwlzdHJ1Y3QgZGMgKmRjLAorCXN0cnVjdCBkY24yMF9yZXNv
dXJjZV9wb29sICpwb29sKQoreworCWludCBpOworCXN0cnVjdCBkY19jb250ZXh0ICpjdHggPSBk
Yy0+Y3R4OworCXN0cnVjdCBpcnFfc2VydmljZV9pbml0X2RhdGEgaW5pdF9kYXRhOworCisJY3R4
LT5kY19iaW9zLT5yZWdzID0gJmJpb3NfcmVnczsKKworCXBvb2wtPmJhc2UucmVzX2NhcCA9ICZy
ZXNfY2FwX252MTA7CisJcG9vbC0+YmFzZS5mdW5jcyA9ICZkY24yMF9yZXNfcG9vbF9mdW5jczsK
KworCS8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisJ
ICogIFJlc291cmNlICsgYXNpYyBjYXAgaGFyY29kaW5nICAgICAgICAgICAgICAgICoKKwkgKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KKwlwb29sLT5i
YXNlLnVuZGVybGF5X3BpcGVfaW5kZXggPSBOT19VTkRFUkxBWV9QSVBFOworCisJcG9vbC0+YmFz
ZS5waXBlX2NvdW50ID0gNjsKKwlwb29sLT5iYXNlLm1wY2NfY291bnQgPSA2OworCWRjLT5jYXBz
Lm1heF9kb3duc2NhbGVfcmF0aW8gPSAyMDA7CisJZGMtPmNhcHMuaTJjX3NwZWVkX2luX2toeiA9
IDEwMDsKKwlkYy0+Y2Fwcy5tYXhfY3Vyc29yX3NpemUgPSAyNTY7CisJZGMtPmNhcHMuZG1kYXRh
X2FsbG9jX3NpemUgPSAyMDQ4OworCisJZGMtPmNhcHMubWF4X3NsYXZlX3BsYW5lcyA9IDE7CisJ
ZGMtPmNhcHMucG9zdF9ibGVuZF9jb2xvcl9wcm9jZXNzaW5nID0gdHJ1ZTsKKwlkYy0+Y2Fwcy5m
b3JjZV9kcF90cHM0X2Zvcl9jcDI1MjAgPSB0cnVlOworCWRjLT5jYXBzLmh3XzNkX2x1dCA9IHRy
dWU7CisKKwlpZiAoZGMtPmN0eC0+ZGNlX2Vudmlyb25tZW50ID09IERDRV9FTlZfUFJPRFVDVElP
Tl9EUlYpCisJCWRjLT5kZWJ1ZyA9IGRlYnVnX2RlZmF1bHRzX2RydjsKKwllbHNlIGlmIChkYy0+
Y3R4LT5kY2VfZW52aXJvbm1lbnQgPT0gRENFX0VOVl9GUEdBX01BWElNVVMpIHsKKwkJCXBvb2wt
PmJhc2UucGlwZV9jb3VudCA9IDQ7CisKKwkJcG9vbC0+YmFzZS5tcGNjX2NvdW50ID0gcG9vbC0+
YmFzZS5waXBlX2NvdW50OworCQlkYy0+ZGVidWcgPSBkZWJ1Z19kZWZhdWx0c19kaWFnczsKKwl9
IGVsc2UKKwkJZGMtPmRlYnVnID0gZGVidWdfZGVmYXVsdHNfZGlhZ3M7CisJLy9kY24yLjB4CisJ
ZGMtPndvcmtfYXJvdW5kcy5kZWRjbjIwXzMwNV93YSA9IHRydWU7CisKKwkvLyBJbml0IHRoZSB2
bV9oZWxwZXIKKwlpZiAoZGMtPnZtX2hlbHBlcikKKwkJaW5pdF92bV9oZWxwZXIoZGMtPnZtX2hl
bHBlciwgMTYsIHBvb2wtPmJhc2UucGlwZV9jb3VudCk7CisKKwkvKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgorCSAqICBDcmVhdGUgcmVzb3VyY2VzICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAqCisJICoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKiovCisKKwlwb29sLT5iYXNlLmNsb2NrX3NvdXJjZXNbRENO
MjBfQ0xLX1NSQ19QTEwwXSA9CisJCQlkY24yMF9jbG9ja19zb3VyY2VfY3JlYXRlKGN0eCwgY3R4
LT5kY19iaW9zLAorCQkJCUNMT0NLX1NPVVJDRV9DT01CT19QSFlfUExMMCwKKwkJCQkmY2xrX3Ny
Y19yZWdzWzBdLCBmYWxzZSk7CisJcG9vbC0+YmFzZS5jbG9ja19zb3VyY2VzW0RDTjIwX0NMS19T
UkNfUExMMV0gPQorCQkJZGNuMjBfY2xvY2tfc291cmNlX2NyZWF0ZShjdHgsIGN0eC0+ZGNfYmlv
cywKKwkJCQlDTE9DS19TT1VSQ0VfQ09NQk9fUEhZX1BMTDEsCisJCQkJJmNsa19zcmNfcmVnc1sx
XSwgZmFsc2UpOworCXBvb2wtPmJhc2UuY2xvY2tfc291cmNlc1tEQ04yMF9DTEtfU1JDX1BMTDJd
ID0KKwkJCWRjbjIwX2Nsb2NrX3NvdXJjZV9jcmVhdGUoY3R4LCBjdHgtPmRjX2Jpb3MsCisJCQkJ
Q0xPQ0tfU09VUkNFX0NPTUJPX1BIWV9QTEwyLAorCQkJCSZjbGtfc3JjX3JlZ3NbMl0sIGZhbHNl
KTsKKwlwb29sLT5iYXNlLmNsb2NrX3NvdXJjZXNbRENOMjBfQ0xLX1NSQ19QTEwzXSA9CisJCQlk
Y24yMF9jbG9ja19zb3VyY2VfY3JlYXRlKGN0eCwgY3R4LT5kY19iaW9zLAorCQkJCUNMT0NLX1NP
VVJDRV9DT01CT19QSFlfUExMMywKKwkJCQkmY2xrX3NyY19yZWdzWzNdLCBmYWxzZSk7CisJcG9v
bC0+YmFzZS5jbG9ja19zb3VyY2VzW0RDTjIwX0NMS19TUkNfUExMNF0gPQorCQkJZGNuMjBfY2xv
Y2tfc291cmNlX2NyZWF0ZShjdHgsIGN0eC0+ZGNfYmlvcywKKwkJCQlDTE9DS19TT1VSQ0VfQ09N
Qk9fUEhZX1BMTDQsCisJCQkJJmNsa19zcmNfcmVnc1s0XSwgZmFsc2UpOworCXBvb2wtPmJhc2Uu
Y2xvY2tfc291cmNlc1tEQ04yMF9DTEtfU1JDX1BMTDVdID0KKwkJCWRjbjIwX2Nsb2NrX3NvdXJj
ZV9jcmVhdGUoY3R4LCBjdHgtPmRjX2Jpb3MsCisJCQkJQ0xPQ0tfU09VUkNFX0NPTUJPX1BIWV9Q
TEw1LAorCQkJCSZjbGtfc3JjX3JlZ3NbNV0sIGZhbHNlKTsKKwlwb29sLT5iYXNlLmNsa19zcmNf
Y291bnQgPSBEQ04yMF9DTEtfU1JDX1RPVEFMOworCS8qIHRvZG86IG5vdCByZXVzZSBwaHlfcGxs
IHJlZ2lzdGVycyAqLworCXBvb2wtPmJhc2UuZHBfY2xvY2tfc291cmNlID0KKwkJCWRjbjIwX2Ns
b2NrX3NvdXJjZV9jcmVhdGUoY3R4LCBjdHgtPmRjX2Jpb3MsCisJCQkJQ0xPQ0tfU09VUkNFX0lE
X0RQX0RUTywKKwkJCQkmY2xrX3NyY19yZWdzWzBdLCB0cnVlKTsKKworCWZvciAoaSA9IDA7IGkg
PCBwb29sLT5iYXNlLmNsa19zcmNfY291bnQ7IGkrKykgeworCQlpZiAocG9vbC0+YmFzZS5jbG9j
a19zb3VyY2VzW2ldID09IE5VTEwpIHsKKwkJCWRtX2Vycm9yKCJEQzogZmFpbGVkIHRvIGNyZWF0
ZSBjbG9jayBzb3VyY2VzIVxuIik7CisJCQlCUkVBS19UT19ERUJVR0dFUigpOworCQkJZ290byBj
cmVhdGVfZmFpbDsKKwkJfQorCX0KKworCXBvb2wtPmJhc2UuZGNjZyA9IGRjY2cyX2NyZWF0ZShj
dHgsICZkY2NnX3JlZ3MsICZkY2NnX3NoaWZ0LCAmZGNjZ19tYXNrKTsKKwlpZiAocG9vbC0+YmFz
ZS5kY2NnID09IE5VTEwpIHsKKwkJZG1fZXJyb3IoIkRDOiBmYWlsZWQgdG8gY3JlYXRlIGRjY2ch
XG4iKTsKKwkJQlJFQUtfVE9fREVCVUdHRVIoKTsKKwkJZ290byBjcmVhdGVfZmFpbDsKKwl9CisK
Kwlwb29sLT5iYXNlLmRtY3UgPSBkY24yMF9kbWN1X2NyZWF0ZShjdHgsCisJCQkmZG1jdV9yZWdz
LAorCQkJJmRtY3Vfc2hpZnQsCisJCQkmZG1jdV9tYXNrKTsKKwlpZiAocG9vbC0+YmFzZS5kbWN1
ID09IE5VTEwpIHsKKwkJZG1fZXJyb3IoIkRDOiBmYWlsZWQgdG8gY3JlYXRlIGRtY3UhXG4iKTsK
KwkJQlJFQUtfVE9fREVCVUdHRVIoKTsKKwkJZ290byBjcmVhdGVfZmFpbDsKKwl9CisKKwkvKnBv
b2wtPmJhc2UuYWJtID0gZGNlX2FibV9jcmVhdGUoY3R4LAorCQkJJmFibV9yZWdzLAorCQkJJmFi
bV9zaGlmdCwKKwkJCSZhYm1fbWFzayk7CisJaWYgKHBvb2wtPmJhc2UuYWJtID09IE5VTEwpIHsK
KwkJZG1fZXJyb3IoIkRDOiBmYWlsZWQgdG8gY3JlYXRlIGFibSFcbiIpOworCQlCUkVBS19UT19E
RUJVR0dFUigpOworCQlnb3RvIGNyZWF0ZV9mYWlsOworCX0qLworCisJcG9vbC0+YmFzZS5wcF9z
bXUgPSBkY24yMF9wcF9zbXVfY3JlYXRlKGN0eCk7CisKKworCWlmICghaW5pdF9zb2NfYm91bmRp
bmdfYm94KGRjLCBwb29sKSkgeworCQlkbV9lcnJvcigiREM6IGZhaWxlZCB0byBpbml0aWFsaXpl
IHNvYyBib3VuZGluZyBib3ghXG4iKTsKKwkJQlJFQUtfVE9fREVCVUdHRVIoKTsKKwkJZ290byBj
cmVhdGVfZmFpbDsKKwl9CisKKwlkbWxfaW5pdF9pbnN0YW5jZSgmZGMtPmRtbCwgJmRjbjJfMF9z
b2MsICZkY24yXzBfaXAsIERNTF9QUk9KRUNUX05BVkkxMCk7CisKKwlpZiAoIWRjLT5kZWJ1Zy5k
aXNhYmxlX3BwbGliX3dtX3JhbmdlKSB7CisJCXN0cnVjdCBwcF9zbXVfd21fcmFuZ2Vfc2V0cyBy
YW5nZXMgPSB7MH07CisJCWludCBpID0gMDsKKworCQlyYW5nZXMubnVtX3JlYWRlcl93bV9zZXRz
ID0gMDsKKworCQlpZiAoZGNuMl8wX3NvYy5udW1fc3RhdGVzID09IDEpIHsKKwkJCXJhbmdlcy5y
ZWFkZXJfd21fc2V0c1swXS53bV9pbnN0ID0gaTsKKwkJCXJhbmdlcy5yZWFkZXJfd21fc2V0c1sw
XS5taW5fZHJhaW5fY2xrX21oeiA9IFBQX1NNVV9XTV9TRVRfUkFOR0VfQ0xLX1VOQ09OU1RSQUlO
RURfTUlOOworCQkJcmFuZ2VzLnJlYWRlcl93bV9zZXRzWzBdLm1heF9kcmFpbl9jbGtfbWh6ID0g
UFBfU01VX1dNX1NFVF9SQU5HRV9DTEtfVU5DT05TVFJBSU5FRF9NQVg7CisJCQlyYW5nZXMucmVh
ZGVyX3dtX3NldHNbMF0ubWluX2ZpbGxfY2xrX21oeiA9IFBQX1NNVV9XTV9TRVRfUkFOR0VfQ0xL
X1VOQ09OU1RSQUlORURfTUlOOworCQkJcmFuZ2VzLnJlYWRlcl93bV9zZXRzWzBdLm1heF9maWxs
X2Nsa19taHogPSBQUF9TTVVfV01fU0VUX1JBTkdFX0NMS19VTkNPTlNUUkFJTkVEX01BWDsKKwor
CQkJcmFuZ2VzLm51bV9yZWFkZXJfd21fc2V0cyA9IDE7CisJCX0gZWxzZSBpZiAoZGNuMl8wX3Nv
Yy5udW1fc3RhdGVzID4gMSkgeworCQkJZm9yIChpID0gMDsgaSA8IDQgJiYgaSA8IGRjbjJfMF9z
b2MubnVtX3N0YXRlcyAtIDE7IGkrKykgeworCQkJCXJhbmdlcy5yZWFkZXJfd21fc2V0c1tpXS53
bV9pbnN0ID0gaTsKKwkJCQlyYW5nZXMucmVhZGVyX3dtX3NldHNbaV0ubWluX2RyYWluX2Nsa19t
aHogPSBQUF9TTVVfV01fU0VUX1JBTkdFX0NMS19VTkNPTlNUUkFJTkVEX01JTjsKKwkJCQlyYW5n
ZXMucmVhZGVyX3dtX3NldHNbaV0ubWF4X2RyYWluX2Nsa19taHogPSBQUF9TTVVfV01fU0VUX1JB
TkdFX0NMS19VTkNPTlNUUkFJTkVEX01BWDsKKwkJCQlyYW5nZXMucmVhZGVyX3dtX3NldHNbaV0u
bWluX2ZpbGxfY2xrX21oeiA9IGRjbjJfMF9zb2MuY2xvY2tfbGltaXRzW2ldLmRyYW1fc3BlZWRf
bXRzIC8gMTY7CisJCQkJcmFuZ2VzLnJlYWRlcl93bV9zZXRzW2ldLm1heF9maWxsX2Nsa19taHog
PSBkY24yXzBfc29jLmNsb2NrX2xpbWl0c1tpICsgMV0uZHJhbV9zcGVlZF9tdHMgLyAxNjsKKwor
CQkJCXJhbmdlcy5udW1fcmVhZGVyX3dtX3NldHMgPSBpICsgMTsKKwkJCX0KKwkJfQorCisJCXJh
bmdlcy5yZWFkZXJfd21fc2V0c1swXS5taW5fZHJhaW5fY2xrX21oeiA9IFBQX1NNVV9XTV9TRVRf
UkFOR0VfQ0xLX1VOQ09OU1RSQUlORURfTUlOOworCQlyYW5nZXMucmVhZGVyX3dtX3NldHNbMF0u
bWluX2ZpbGxfY2xrX21oeiA9IFBQX1NNVV9XTV9TRVRfUkFOR0VfQ0xLX1VOQ09OU1RSQUlORURf
TUlOOworCQlyYW5nZXMucmVhZGVyX3dtX3NldHNbcmFuZ2VzLm51bV9yZWFkZXJfd21fc2V0cyAt
IDFdLm1heF9kcmFpbl9jbGtfbWh6ID0gUFBfU01VX1dNX1NFVF9SQU5HRV9DTEtfVU5DT05TVFJB
SU5FRF9NQVg7CisJCXJhbmdlcy5yZWFkZXJfd21fc2V0c1tyYW5nZXMubnVtX3JlYWRlcl93bV9z
ZXRzIC0gMV0ubWF4X2ZpbGxfY2xrX21oeiA9IFBQX1NNVV9XTV9TRVRfUkFOR0VfQ0xLX1VOQ09O
U1RSQUlORURfTUFYOworCisJCXJhbmdlcy5udW1fd3JpdGVyX3dtX3NldHMgPSAxOworCisJCXJh
bmdlcy53cml0ZXJfd21fc2V0c1swXS53bV9pbnN0ID0gMDsKKwkJcmFuZ2VzLndyaXRlcl93bV9z
ZXRzWzBdLm1pbl9maWxsX2Nsa19taHogPSBQUF9TTVVfV01fU0VUX1JBTkdFX0NMS19VTkNPTlNU
UkFJTkVEX01JTjsKKwkJcmFuZ2VzLndyaXRlcl93bV9zZXRzWzBdLm1heF9maWxsX2Nsa19taHog
PSBQUF9TTVVfV01fU0VUX1JBTkdFX0NMS19VTkNPTlNUUkFJTkVEX01BWDsKKwkJcmFuZ2VzLndy
aXRlcl93bV9zZXRzWzBdLm1pbl9kcmFpbl9jbGtfbWh6ID0gUFBfU01VX1dNX1NFVF9SQU5HRV9D
TEtfVU5DT05TVFJBSU5FRF9NSU47CisJCXJhbmdlcy53cml0ZXJfd21fc2V0c1swXS5tYXhfZHJh
aW5fY2xrX21oeiA9IFBQX1NNVV9XTV9TRVRfUkFOR0VfQ0xLX1VOQ09OU1RSQUlORURfTUFYOwor
CisJCS8qIE5vdGlmeSBQUCBMaWIvU01VIHdoaWNoIFdhdGVybWFya3MgdG8gdXNlIGZvciB3aGlj
aCBjbG9jayByYW5nZXMgKi8KKwkJaWYgKHBvb2wtPmJhc2UucHBfc211LT5udl9mdW5jcy5zZXRf
d21fcmFuZ2VzKQorCQkJcG9vbC0+YmFzZS5wcF9zbXUtPm52X2Z1bmNzLnNldF93bV9yYW5nZXMo
JnBvb2wtPmJhc2UucHBfc211LT5udl9mdW5jcy5wcF9zbXUsICZyYW5nZXMpOworCX0KKworCWlu
aXRfZGF0YS5jdHggPSBkYy0+Y3R4OworCXBvb2wtPmJhc2UuaXJxcyA9IGRhbF9pcnFfc2Vydmlj
ZV9kY24yMF9jcmVhdGUoJmluaXRfZGF0YSk7CisJaWYgKCFwb29sLT5iYXNlLmlycXMpCisJCWdv
dG8gY3JlYXRlX2ZhaWw7CisKKwkvKiBtZW0gaW5wdXQgLT4gaXBwIC0+IGRwcCAtPiBvcHAgLT4g
VEcgKi8KKwlmb3IgKGkgPSAwOyBpIDwgcG9vbC0+YmFzZS5waXBlX2NvdW50OyBpKyspIHsKKwkJ
cG9vbC0+YmFzZS5odWJwc1tpXSA9IGRjbjIwX2h1YnBfY3JlYXRlKGN0eCwgaSk7CisJCWlmIChw
b29sLT5iYXNlLmh1YnBzW2ldID09IE5VTEwpIHsKKwkJCUJSRUFLX1RPX0RFQlVHR0VSKCk7CisJ
CQlkbV9lcnJvcigKKwkJCQkiREM6IGZhaWxlZCB0byBjcmVhdGUgbWVtb3J5IGlucHV0IVxuIik7
CisJCQlnb3RvIGNyZWF0ZV9mYWlsOworCQl9CisKKwkJcG9vbC0+YmFzZS5pcHBzW2ldID0gZGNu
MjBfaXBwX2NyZWF0ZShjdHgsIGkpOworCQlpZiAocG9vbC0+YmFzZS5pcHBzW2ldID09IE5VTEwp
IHsKKwkJCUJSRUFLX1RPX0RFQlVHR0VSKCk7CisJCQlkbV9lcnJvcigKKwkJCQkiREM6IGZhaWxl
ZCB0byBjcmVhdGUgaW5wdXQgcGl4ZWwgcHJvY2Vzc29yIVxuIik7CisJCQlnb3RvIGNyZWF0ZV9m
YWlsOworCQl9CisKKwkJcG9vbC0+YmFzZS5kcHBzW2ldID0gZGNuMjBfZHBwX2NyZWF0ZShjdHgs
IGkpOworCQlpZiAocG9vbC0+YmFzZS5kcHBzW2ldID09IE5VTEwpIHsKKwkJCUJSRUFLX1RPX0RF
QlVHR0VSKCk7CisJCQlkbV9lcnJvcigKKwkJCQkiREM6IGZhaWxlZCB0byBjcmVhdGUgZHBwcyFc
biIpOworCQkJZ290byBjcmVhdGVfZmFpbDsKKwkJfQorCX0KKwlmb3IgKGkgPSAwOyBpIDwgcG9v
bC0+YmFzZS5yZXNfY2FwLT5udW1fZGRjOyBpKyspIHsKKwkJcG9vbC0+YmFzZS5lbmdpbmVzW2ld
ID0gZGNuMjBfYXV4X2VuZ2luZV9jcmVhdGUoY3R4LCBpKTsKKwkJaWYgKHBvb2wtPmJhc2UuZW5n
aW5lc1tpXSA9PSBOVUxMKSB7CisJCQlCUkVBS19UT19ERUJVR0dFUigpOworCQkJZG1fZXJyb3Io
CisJCQkJIkRDOmZhaWxlZCB0byBjcmVhdGUgYXV4IGVuZ2luZSEhXG4iKTsKKwkJCWdvdG8gY3Jl
YXRlX2ZhaWw7CisJCX0KKwkJcG9vbC0+YmFzZS5od19pMmNzW2ldID0gZGNuMjBfaTJjX2h3X2Ny
ZWF0ZShjdHgsIGkpOworCQlpZiAocG9vbC0+YmFzZS5od19pMmNzW2ldID09IE5VTEwpIHsKKwkJ
CUJSRUFLX1RPX0RFQlVHR0VSKCk7CisJCQlkbV9lcnJvcigKKwkJCQkiREM6ZmFpbGVkIHRvIGNy
ZWF0ZSBodyBpMmMhIVxuIik7CisJCQlnb3RvIGNyZWF0ZV9mYWlsOworCQl9CisJCXBvb2wtPmJh
c2Uuc3dfaTJjc1tpXSA9IE5VTEw7CisJfQorCisJZm9yIChpID0gMDsgaSA8IHBvb2wtPmJhc2Uu
cmVzX2NhcC0+bnVtX29wcDsgaSsrKSB7CisJCXBvb2wtPmJhc2Uub3Bwc1tpXSA9IGRjbjIwX29w
cF9jcmVhdGUoY3R4LCBpKTsKKwkJaWYgKHBvb2wtPmJhc2Uub3Bwc1tpXSA9PSBOVUxMKSB7CisJ
CQlCUkVBS19UT19ERUJVR0dFUigpOworCQkJZG1fZXJyb3IoCisJCQkJIkRDOiBmYWlsZWQgdG8g
Y3JlYXRlIG91dHB1dCBwaXhlbCBwcm9jZXNzb3IhXG4iKTsKKwkJCWdvdG8gY3JlYXRlX2ZhaWw7
CisJCX0KKwl9CisKKwlmb3IgKGkgPSAwOyBpIDwgcG9vbC0+YmFzZS5yZXNfY2FwLT5udW1fdGlt
aW5nX2dlbmVyYXRvcjsgaSsrKSB7CisJCXBvb2wtPmJhc2UudGltaW5nX2dlbmVyYXRvcnNbaV0g
PSBkY24yMF90aW1pbmdfZ2VuZXJhdG9yX2NyZWF0ZSgKKwkJCQljdHgsIGkpOworCQlpZiAocG9v
bC0+YmFzZS50aW1pbmdfZ2VuZXJhdG9yc1tpXSA9PSBOVUxMKSB7CisJCQlCUkVBS19UT19ERUJV
R0dFUigpOworCQkJZG1fZXJyb3IoIkRDOiBmYWlsZWQgdG8gY3JlYXRlIHRnIVxuIik7CisJCQln
b3RvIGNyZWF0ZV9mYWlsOworCQl9CisJfQorCisJcG9vbC0+YmFzZS50aW1pbmdfZ2VuZXJhdG9y
X2NvdW50ID0gaTsKKworCXBvb2wtPmJhc2UubXBjID0gZGNuMjBfbXBjX2NyZWF0ZShjdHgpOwor
CWlmIChwb29sLT5iYXNlLm1wYyA9PSBOVUxMKSB7CisJCUJSRUFLX1RPX0RFQlVHR0VSKCk7CisJ
CWRtX2Vycm9yKCJEQzogZmFpbGVkIHRvIGNyZWF0ZSBtcGMhXG4iKTsKKwkJZ290byBjcmVhdGVf
ZmFpbDsKKwl9CisKKwlwb29sLT5iYXNlLmh1YmJ1YiA9IGRjbjIwX2h1YmJ1Yl9jcmVhdGUoY3R4
KTsKKwlpZiAocG9vbC0+YmFzZS5odWJidWIgPT0gTlVMTCkgeworCQlCUkVBS19UT19ERUJVR0dF
UigpOworCQlkbV9lcnJvcigiREM6IGZhaWxlZCB0byBjcmVhdGUgaHViYnViIVxuIik7CisJCWdv
dG8gY3JlYXRlX2ZhaWw7CisJfQorCisKKwlpZiAoIXJlc291cmNlX2NvbnN0cnVjdChudW1fdmly
dHVhbF9saW5rcywgZGMsICZwb29sLT5iYXNlLAorCQkJKCFJU19GUEdBX01BWElNVVNfREMoZGMt
PmN0eC0+ZGNlX2Vudmlyb25tZW50KSA/CisJCQkmcmVzX2NyZWF0ZV9mdW5jcyA6ICZyZXNfY3Jl
YXRlX21heGltdXNfZnVuY3MpKSkKKwkJCWdvdG8gY3JlYXRlX2ZhaWw7CisKKwlkY24yMF9od19z
ZXF1ZW5jZXJfY29uc3RydWN0KGRjKTsKKworCWRjLT5jYXBzLm1heF9wbGFuZXMgPSAgcG9vbC0+
YmFzZS5waXBlX2NvdW50OworCisJZm9yIChpID0gMDsgaSA8IGRjLT5jYXBzLm1heF9wbGFuZXM7
ICsraSkKKwkJZGMtPmNhcHMucGxhbmVzW2ldID0gcGxhbmVfY2FwOworCisJZGMtPmNhcF9mdW5j
cyA9IGNhcF9mdW5jczsKKworCXJldHVybiB0cnVlOworCitjcmVhdGVfZmFpbDoKKworCWRlc3Ry
dWN0KHBvb2wpOworCisJcmV0dXJuIGZhbHNlOworfQorCitzdHJ1Y3QgcmVzb3VyY2VfcG9vbCAq
ZGNuMjBfY3JlYXRlX3Jlc291cmNlX3Bvb2woCisJCWNvbnN0IHN0cnVjdCBkY19pbml0X2RhdGEg
KmluaXRfZGF0YSwKKwkJc3RydWN0IGRjICpkYykKK3sKKwlzdHJ1Y3QgZGNuMjBfcmVzb3VyY2Vf
cG9vbCAqcG9vbCA9CisJCWt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBkY24yMF9yZXNvdXJjZV9wb29s
KSwgR0ZQX0tFUk5FTCk7CisKKwlpZiAoIXBvb2wpCisJCXJldHVybiBOVUxMOworCisJaWYgKGNv
bnN0cnVjdChpbml0X2RhdGEtPm51bV92aXJ0dWFsX2xpbmtzLCBkYywgcG9vbCkpCisJCXJldHVy
biAmcG9vbC0+YmFzZTsKKworCUJSRUFLX1RPX0RFQlVHR0VSKCk7CisJa2ZyZWUocG9vbCk7CisJ
cmV0dXJuIE5VTEw7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvZGNuMjAvZGNuMjBfcmVzb3VyY2UuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9k
Yy9kY24yMC9kY24yMF9yZXNvdXJjZS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAw
MDAwMDAwMC4uYWI5ZGIxNmY1MTY1Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX3Jlc291cmNlLmgKQEAgLTAsMCArMSwxMzQgQEAK
Ky8qCisqIENvcHlyaWdodCAyMDE3IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KKyAqCisg
KiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBl
cnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVk
IGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhl
IFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRp
b24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBk
aXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0
d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBpcyBm
dXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgor
ICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90
aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBv
cnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQg
IkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1Q
TElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJD
SEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9O
SU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQgSE9MREVS
KFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgorICog
T1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBP
UiBPVEhFUldJU0UsCisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJ
VEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBT
T0ZUV0FSRS4KKyAqCisgKiBBdXRob3JzOiBBTUQKKyAqCisgKi8KKworI2lmbmRlZiBfX0RDX1JF
U09VUkNFX0RDTjIwX0hfXworI2RlZmluZSBfX0RDX1JFU09VUkNFX0RDTjIwX0hfXworCisjaW5j
bHVkZSAiY29yZV90eXBlcy5oIgorCisjZGVmaW5lIFRPX0RDTjIwX1JFU19QT09MKHBvb2wpXAor
CWNvbnRhaW5lcl9vZihwb29sLCBzdHJ1Y3QgZGNuMjBfcmVzb3VyY2VfcG9vbCwgYmFzZSkKKwor
c3RydWN0IGRjOworc3RydWN0IHJlc291cmNlX3Bvb2w7CitzdHJ1Y3QgX3Zjc19kcGlfZGlzcGxh
eV9waXBlX3BhcmFtc19zdDsKKworc3RydWN0IGRjbjIwX3Jlc291cmNlX3Bvb2wgeworCXN0cnVj
dCByZXNvdXJjZV9wb29sIGJhc2U7Cit9Oworc3RydWN0IHJlc291cmNlX3Bvb2wgKmRjbjIwX2Ny
ZWF0ZV9yZXNvdXJjZV9wb29sKAorCQljb25zdCBzdHJ1Y3QgZGNfaW5pdF9kYXRhICppbml0X2Rh
dGEsCisJCXN0cnVjdCBkYyAqZGMpOworCitzdHJ1Y3QgbGlua19lbmNvZGVyICpkY24yMF9saW5r
X2VuY29kZXJfY3JlYXRlKAorCWNvbnN0IHN0cnVjdCBlbmNvZGVyX2luaXRfZGF0YSAqZW5jX2lu
aXRfZGF0YSk7CisKK3Vuc2lnbmVkIGludCBkY24yMF9jYWxjX21heF9zY2FsZWRfdGltZSgKKwkJ
dW5zaWduZWQgaW50IHRpbWVfcGVyX3BpeGVsLAorCQllbnVtIG1taHViYnViX3diaWZfbW9kZSBt
b2RlLAorCQl1bnNpZ25lZCBpbnQgdXJnZW50X3dhdGVybWFyayk7CitpbnQgZGNuMjBfcG9wdWxh
dGVfZG1sX3BpcGVzX2Zyb21fY29udGV4dCgKKwkJc3RydWN0IGRjICpkYywgc3RydWN0IHJlc291
cmNlX2NvbnRleHQgKnJlc19jdHgsIGRpc3BsYXlfZTJlX3BpcGVfcGFyYW1zX3N0ICpwaXBlcyk7
CitzdHJ1Y3QgcGlwZV9jdHggKmRjbjIwX2FjcXVpcmVfaWRsZV9waXBlX2Zvcl9sYXllcigKKwkJ
c3RydWN0IGRjX3N0YXRlICpzdGF0ZSwKKwkJY29uc3Qgc3RydWN0IHJlc291cmNlX3Bvb2wgKnBv
b2wsCisJCXN0cnVjdCBkY19zdHJlYW1fc3RhdGUgKnN0cmVhbSk7Cit2b2lkIGRjbjIwX3BvcHVs
YXRlX2RtbF93cml0ZWJhY2tfZnJvbV9jb250ZXh0KAorCQlzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3Qg
cmVzb3VyY2VfY29udGV4dCAqcmVzX2N0eCwgZGlzcGxheV9lMmVfcGlwZV9wYXJhbXNfc3QgKnBp
cGVzKTsKKworc3RydWN0IHN0cmVhbV9lbmNvZGVyICpkY24yMF9zdHJlYW1fZW5jb2Rlcl9jcmVh
dGUoCisJZW51bSBlbmdpbmVfaWQgZW5nX2lkLAorCXN0cnVjdCBkY19jb250ZXh0ICpjdHgpOwor
CitzdHJ1Y3QgZGNlX2h3c2VxICpkY24yMF9od3NlcV9jcmVhdGUoCisJc3RydWN0IGRjX2NvbnRl
eHQgKmN0eCk7CisKK2Jvb2wgZGNuMjBfZ2V0X2RjY19jb21wcmVzc2lvbl9jYXAoY29uc3Qgc3Ry
dWN0IGRjICpkYywKKwkJY29uc3Qgc3RydWN0IGRjX2RjY19zdXJmYWNlX3BhcmFtICppbnB1dCwK
KwkJc3RydWN0IGRjX3N1cmZhY2VfZGNjX2NhcCAqb3V0cHV0KTsKKwordm9pZCBkY24yMF9kcHBf
ZGVzdHJveShzdHJ1Y3QgZHBwICoqZHBwKTsKKworc3RydWN0IGRwcCAqZGNuMjBfZHBwX2NyZWF0
ZSgKKwlzdHJ1Y3QgZGNfY29udGV4dCAqY3R4LAorCXVpbnQzMl90IGluc3QpOworCitzdHJ1Y3Qg
aW5wdXRfcGl4ZWxfcHJvY2Vzc29yICpkY24yMF9pcHBfY3JlYXRlKAorCXN0cnVjdCBkY19jb250
ZXh0ICpjdHgsIHVpbnQzMl90IGluc3QpOworCisKK3N0cnVjdCBvdXRwdXRfcGl4ZWxfcHJvY2Vz
c29yICpkY24yMF9vcHBfY3JlYXRlKAorCXN0cnVjdCBkY19jb250ZXh0ICpjdHgsIHVpbnQzMl90
IGluc3QpOworCitzdHJ1Y3QgZGNlX2F1eCAqZGNuMjBfYXV4X2VuZ2luZV9jcmVhdGUoCisJc3Ry
dWN0IGRjX2NvbnRleHQgKmN0eCwgdWludDMyX3QgaW5zdCk7CisKK3N0cnVjdCBkY2VfaTJjX2h3
ICpkY24yMF9pMmNfaHdfY3JlYXRlKAorCXN0cnVjdCBkY19jb250ZXh0ICpjdHgsCisJdWludDMy
X3QgaW5zdCk7CisKK3ZvaWQgZGNuMjBfY2xvY2tfc291cmNlX2Rlc3Ryb3koc3RydWN0IGNsb2Nr
X3NvdXJjZSAqKmNsa19zcmMpOworCitzdHJ1Y3QgZGlzcGxheV9zdHJlYW1fY29tcHJlc3NvciAq
ZGNuMjBfZHNjX2NyZWF0ZSgKKwlzdHJ1Y3QgZGNfY29udGV4dCAqY3R4LCB1aW50MzJfdCBpbnN0
KTsKK3ZvaWQgZGNuMjBfZHNjX2Rlc3Ryb3koc3RydWN0IGRpc3BsYXlfc3RyZWFtX2NvbXByZXNz
b3IgKipkc2MpOworCitzdHJ1Y3QgcHBfc211X2Z1bmNzICpkY24yMF9wcF9zbXVfY3JlYXRlKHN0
cnVjdCBkY19jb250ZXh0ICpjdHgpOwordm9pZCBkY24yMF9wcF9zbXVfZGVzdHJveShzdHJ1Y3Qg
cHBfc211X2Z1bmNzICoqcHBfc211KTsKKworc3RydWN0IGh1YnAgKmRjbjIwX2h1YnBfY3JlYXRl
KAorCXN0cnVjdCBkY19jb250ZXh0ICpjdHgsCisJdWludDMyX3QgaW5zdCk7CitzdHJ1Y3QgdGlt
aW5nX2dlbmVyYXRvciAqZGNuMjBfdGltaW5nX2dlbmVyYXRvcl9jcmVhdGUoCisJCXN0cnVjdCBk
Y19jb250ZXh0ICpjdHgsCisJCXVpbnQzMl90IGluc3RhbmNlKTsKK3N0cnVjdCBtcGMgKmRjbjIw
X21wY19jcmVhdGUoc3RydWN0IGRjX2NvbnRleHQgKmN0eCk7CitzdHJ1Y3QgaHViYnViICpkY24y
MF9odWJidWJfY3JlYXRlKHN0cnVjdCBkY19jb250ZXh0ICpjdHgpOworCitib29sIGRjbjIwX2R3
YmNfY3JlYXRlKHN0cnVjdCBkY19jb250ZXh0ICpjdHgsIHN0cnVjdCByZXNvdXJjZV9wb29sICpw
b29sKTsKK2Jvb2wgZGNuMjBfbW1odWJidWJfY3JlYXRlKHN0cnVjdCBkY19jb250ZXh0ICpjdHgs
IHN0cnVjdCByZXNvdXJjZV9wb29sICpwb29sKTsKKwordm9pZCBkY24yMF9zZXRfbWNpZl9hcmJf
cGFyYW1zKAorCQlzdHJ1Y3QgZGMgKmRjLAorCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQsCisJ
CWRpc3BsYXlfZTJlX3BpcGVfcGFyYW1zX3N0ICpwaXBlcywKKwkJaW50IHBpcGVfY250KTsKK2Jv
b2wgZGNuMjBfdmFsaWRhdGVfYmFuZHdpZHRoKHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBkY19zdGF0
ZSAqY29udGV4dCk7CisKK2VudW0gZGNfc3RhdHVzIGRjbjIwX2J1aWxkX21hcHBlZF9yZXNvdXJj
ZShjb25zdCBzdHJ1Y3QgZGMgKmRjLCBzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQsIHN0cnVjdCBk
Y19zdHJlYW1fc3RhdGUgKnN0cmVhbSk7CitlbnVtIGRjX3N0YXR1cyBkY24yMF92YWxpZGF0ZV9n
bG9iYWwoc3RydWN0IGRjICpkYywJc3RydWN0IGRjX3N0YXRlICpuZXdfY3R4KTsKK2VudW0gZGNf
c3RhdHVzIGRjbjIwX2FkZF9zdHJlYW1fdG9fY3R4KHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBkY19z
dGF0ZSAqbmV3X2N0eCwgc3RydWN0IGRjX3N0cmVhbV9zdGF0ZSAqZGNfc3RyZWFtKTsKK2VudW0g
ZGNfc3RhdHVzIGRjbjIwX3JlbW92ZV9zdHJlYW1fZnJvbV9jdHgoc3RydWN0IGRjICpkYywgc3Ry
dWN0IGRjX3N0YXRlICpuZXdfY3R4LCBzdHJ1Y3QgZGNfc3RyZWFtX3N0YXRlICpkY19zdHJlYW0p
OworZW51bSBkY19zdGF0dXMgZGNuMjBfZ2V0X2RlZmF1bHRfc3dpenpsZV9tb2RlKHN0cnVjdCBk
Y19wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpOworCit2b2lkIGRjbjIwX3BhdGNoX2JvdW5kaW5n
X2JveCgKKwkJc3RydWN0IGRjICpkYywKKwkJc3RydWN0IF92Y3NfZHBpX3NvY19ib3VuZGluZ19i
b3hfc3QgKmJiKTsKK3ZvaWQgZGNuMjBfY2FwX3NvY19jbG9ja3MoCisJCXN0cnVjdCBfdmNzX2Rw
aV9zb2NfYm91bmRpbmdfYm94X3N0ICpiYiwKKwkJc3RydWN0IHBwX3NtdV9udl9jbG9ja190YWJs
ZSBtYXhfY2xvY2tzKTsKKworI2VuZGlmIC8qIF9fRENfUkVTT1VSQ0VfRENOMjBfSF9fICovCisK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHdfc2VxdWVu
Y2VyLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3X3NlcXVlbmNlci5o
CmluZGV4IGViMWMxMmVkMDI2YS4uYTAyMjdkZWRiZGY2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3X3NlcXVlbmNlci5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHdfc2VxdWVuY2VyLmgKQEAgLTY1LDExICs2NSwxOCBA
QCBzdHJ1Y3QgZGNlX2h3c2VxIHsKIAogc3RydWN0IHBpcGVfY3R4Owogc3RydWN0IGRjX3N0YXRl
OworI2lmIGRlZmluZWQoQ09ORklHX0RSTV9BTURfRENfRENOMl8wKQorc3RydWN0IGRjX3N0cmVh
bV9zdGF0dXM7CitzdHJ1Y3QgZGNfd3JpdGViYWNrX2luZm87CisjZW5kaWYKIHN0cnVjdCBkY2h1
Yl9pbml0X2RhdGE7CiBzdHJ1Y3QgZGNfc3RhdGljX3NjcmVlbl9ldmVudHM7CiBzdHJ1Y3QgcmVz
b3VyY2VfcG9vbDsKIHN0cnVjdCByZXNvdXJjZV9jb250ZXh0Owogc3RydWN0IHN0cmVhbV9yZXNv
dXJjZTsKKyNpZmRlZiBDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzAKK3N0cnVjdCBkY19hZGRyX3Nw
YWNlX2NvbmZpZzsKKyNlbmRpZgogCiBzdHJ1Y3QgaHdfc2VxdWVuY2VyX2Z1bmNzIHsKIApAQCAt
MTAyLDYgKzEwOSwxNiBAQCBzdHJ1Y3QgaHdfc2VxdWVuY2VyX2Z1bmNzIHsKIAkJCXVpbnQxNl90
ICptYXRyaXgsCiAJCQlpbnQgb3BwX2lkKTsKIAorI2lmIGRlZmluZWQoQ09ORklHX0RSTV9BTURf
RENfRENOMl8wKQorCXZvaWQgKCpwcm9ncmFtX3RyaXBsZWJ1ZmZlcikoCisJCWNvbnN0IHN0cnVj
dCBkYyAqZGMsCisJCXN0cnVjdCBwaXBlX2N0eCAqcGlwZV9jdHgsCisJCWJvb2wgZW5hYmxlVHJp
cGxlQnVmZmVyKTsKKwl2b2lkICgqc2V0X2ZsaXBfY29udHJvbF9nc2wpKAorCQlzdHJ1Y3QgcGlw
ZV9jdHggKnBpcGVfY3R4LAorCQlib29sIGZsaXBfaW1tZWRpYXRlKTsKKyNlbmRpZgorCiAJdm9p
ZCAoKnVwZGF0ZV9wbGFuZV9hZGRyKSgKIAkJY29uc3Qgc3RydWN0IGRjICpkYywKIAkJc3RydWN0
IHBpcGVfY3R4ICpwaXBlX2N0eCk7CkBAIC0xMTQsNiArMTMxLDEzIEBAIHN0cnVjdCBod19zZXF1
ZW5jZXJfZnVuY3MgewogCQlzdHJ1Y3QgZGNlX2h3c2VxICpod3MsCiAJCXN0cnVjdCBkY2h1Yl9p
bml0X2RhdGEgKmRoX2RhdGEpOwogCisjaWZkZWYgQ09ORklHX0RSTV9BTURfRENfRENOMl8wCisJ
dm9pZCAoKmluaXRfZGNodWIpKAorCQlzdHJ1Y3QgZGNlX2h3c2VxICpod3MsCisJCXN0cnVjdCBk
YyAqZGMsCisJCXN0cnVjdCBkY19hZGRyX3NwYWNlX2NvbmZpZyAqZGhfZGF0YSk7CisKKyNlbmRp
ZgogCXZvaWQgKCp1cGRhdGVfbXBjYykoCiAJCXN0cnVjdCBkYyAqZGMsCiAJCXN0cnVjdCBwaXBl
X2N0eCAqcGlwZV9jdHgpOwpAQCAtMTk3LDYgKzIyMSwxMyBAQCBzdHJ1Y3QgaHdfc2VxdWVuY2Vy
X2Z1bmNzIHsKIAkJCXN0cnVjdCBkYyAqZGMsCiAJCQlzdHJ1Y3QgZGNfc3RhdGUgKmNvbnRleHQp
OwogCisjaWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9EQ19EQ04yXzApCisJYm9vbCAoKnVwZGF0
ZV9iYW5kd2lkdGgpKAorCQkJc3RydWN0IGRjICpkYywKKwkJCXN0cnVjdCBkY19zdGF0ZSAqY29u
dGV4dCk7CisJYm9vbCAoKmRtZGF0YV9zdGF0dXNfZG9uZSkoc3RydWN0IHBpcGVfY3R4ICpwaXBl
X2N0eCk7CisjZW5kaWYKKwogCXZvaWQgKCpzZXRfZHJyKShzdHJ1Y3QgcGlwZV9jdHggKipwaXBl
X2N0eCwgaW50IG51bV9waXBlcywKIAkJCWludCB2bWluLCBpbnQgdm1heCk7CiAKQEAgLTI0MSw2
ICsyNzIsMjEgQEAgc3RydWN0IGh3X3NlcXVlbmNlcl9mdW5jcyB7CiAJdm9pZCAoKnNldHVwX3Bl
cmlvZGljX2ludGVycnVwdCkoc3RydWN0IHBpcGVfY3R4ICpwaXBlX2N0eCwgZW51bSB2bGluZV9z
ZWxlY3QgdmxpbmUpOwogCXZvaWQgKCpzZXR1cF92dXBkYXRlX2ludGVycnVwdCkoc3RydWN0IHBp
cGVfY3R4ICpwaXBlX2N0eCk7CiAKKyNpZiBkZWZpbmVkKENPTkZJR19EUk1fQU1EX0RDX0RDTjJf
MCkKKwl2b2lkICgqdXBkYXRlX29kbSkoc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3N0YXRlICpj
b250ZXh0LCBzdHJ1Y3QgcGlwZV9jdHggKnBpcGVfY3R4KTsKKwl2b2lkICgqcHJvZ3JhbV9hbGxf
d3JpdGViYWNrX3BpcGVzX2luX3RyZWUpKAorCQkJc3RydWN0IGRjICpkYywKKwkJCWNvbnN0IHN0
cnVjdCBkY19zdHJlYW1fc3RhdGUgKnN0cmVhbSwKKwkJCXN0cnVjdCBkY19zdGF0ZSAqY29udGV4
dCk7CisJdm9pZCAoKnVwZGF0ZV93cml0ZWJhY2spKHN0cnVjdCBkYyAqZGMsCisJCQljb25zdCBz
dHJ1Y3QgZGNfc3RyZWFtX3N0YXR1cyAqc3RyZWFtX3N0YXR1cywKKwkJCXN0cnVjdCBkY193cml0
ZWJhY2tfaW5mbyAqd2JfaW5mbyk7CisJdm9pZCAoKmVuYWJsZV93cml0ZWJhY2spKHN0cnVjdCBk
YyAqZGMsCisJCQljb25zdCBzdHJ1Y3QgZGNfc3RyZWFtX3N0YXR1cyAqc3RyZWFtX3N0YXR1cywK
KwkJCXN0cnVjdCBkY193cml0ZWJhY2tfaW5mbyAqd2JfaW5mbyk7CisJdm9pZCAoKmRpc2FibGVf
d3JpdGViYWNrKShzdHJ1Y3QgZGMgKmRjLAorCQkJdW5zaWduZWQgaW50IGR3Yl9waXBlX2luc3Qp
OworI2VuZGlmCiB9OwogCiB2b2lkIGNvbG9yX3NwYWNlX3RvX2JsYWNrX2NvbG9yKApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9yZXNvdXJjZS5oIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9yZXNvdXJjZS5oCmluZGV4IDA4OTE1Yjcz
Nzc5OS4uNjBmYTQ2OTdkYzcwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvaW5jL3Jlc291cmNlLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2Rj
L2luYy9yZXNvdXJjZS5oCkBAIC00NCw2ICs0NCw5IEBAIHN0cnVjdCByZXNvdXJjZV9jYXBzIHsK
IAlpbnQgbnVtX3BsbDsKIAlpbnQgbnVtX2R3YjsKIAlpbnQgbnVtX2RkYzsKKyNpZmRlZiBDT05G
SUdfRFJNX0FNRF9EQ19EQ04yXzAKKwlpbnQgbnVtX3ZtaWQ7CisjZW5kaWYKIH07CiAKIHN0cnVj
dCByZXNvdXJjZV9zdHJhcHMgewotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2FtZC1nZng=
