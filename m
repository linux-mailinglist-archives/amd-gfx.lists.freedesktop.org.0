Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5A0122438FD
	for <lists+amd-gfx@lfdr.de>; Thu, 13 Aug 2020 12:58:59 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 76E376E9AE;
	Thu, 13 Aug 2020 10:58:56 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-ed1-x544.google.com (mail-ed1-x544.google.com
 [IPv6:2a00:1450:4864:20::544])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 663316E203
 for <amd-gfx@lists.freedesktop.org>; Thu, 13 Aug 2020 10:58:54 +0000 (UTC)
Received: by mail-ed1-x544.google.com with SMTP id a14so3839356edx.7
 for <amd-gfx@lists.freedesktop.org>; Thu, 13 Aug 2020 03:58:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=reply-to:subject:to:cc:references:from:message-id:date:user-agent
 :mime-version:in-reply-to:content-transfer-encoding:content-language;
 bh=eKy+4wvPKr9ZquG/VAksp5mojD8NYFAzpPbEHWhcQ+k=;
 b=jiBQKsi4il8z3qlS50QiK/xj11yCXCsuhSe2i4iFLgqm2Uknfvo+7j66cjy6jFyHu4
 33ekfwdyZaWoIchtmI0/HMqysRE4ar8w3P6AAIcR58YV5BUNGE2yScz9sOIpGLaw0dT+
 mPThbhuscGFy+9mzY/npE/h6XIWKnfc3JINcc13Nw36UFPCv255utvWxk2NQe9wlJEth
 pPgR5MW5SRA10vfAhADdCjAcuE+68qP8yy3s6tyqk1IS/OQNQZv2qWc4Ms4jb6fi+6CB
 D8+ZrIecmAsFmv3FmEakQqDA24o3lCB2/hkiru43Tb6C6sygG0u7LBVlqGQxYtXXHyyM
 ISmA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:reply-to:subject:to:cc:references:from
 :message-id:date:user-agent:mime-version:in-reply-to
 :content-transfer-encoding:content-language;
 bh=eKy+4wvPKr9ZquG/VAksp5mojD8NYFAzpPbEHWhcQ+k=;
 b=E/szv2V629odtKkH8ctDaXwwHBN6cXEZ4Gen7TnuL8szKN8QusswAbQ7/sQ9npYSar
 LsGU0FIcRPjqT+d+cTgjzbvOKGJJop4Ey559rJOLZ4K4vnnVaRzZsTQgVgjzKXQPvY8I
 GcAXZGu/k2H0VA7a/q4ZK3QHPTELiU0uZzAlQHIfwrMU4o5x/hMLQreyyC9KWjyQoKUf
 3tuYTsSksQVAZ8TwsY/HQRQLtAsGLcZ5jp8Ei2SMpX3/ZDZsMdHyo5NHKSZ9rBMD4mCO
 l7RfphIbLvBFdFVCjLAcjbnwmFVuW+wqOA3Awe1mWbJHeAN3+jnCNW1C/rohtbr1csyW
 Ilow==
X-Gm-Message-State: AOAM533qtLqHTJ0al/L+VuSFt8pMS4qumxZYVqKpW4x14OhV7JQlg0WQ
 GxumkFqzJhG9TLNXn9yG2OkNS0ow
X-Google-Smtp-Source: ABdhPJzasBGH76kbfSH4lHtvzTqcRUvr+JsY6Kx4qS2DfaJJwNXopxMX882umrkMCYGKGEnxD8YboA==
X-Received: by 2002:a50:8f44:: with SMTP id 62mr4221149edy.3.1597316329902;
 Thu, 13 Aug 2020 03:58:49 -0700 (PDT)
Received: from ?IPv6:2a02:908:1252:fb60:be8a:bd56:1f94:86e7?
 ([2a02:908:1252:fb60:be8a:bd56:1f94:86e7])
 by smtp.gmail.com with ESMTPSA id m13sm3355748edi.89.2020.08.13.03.58.47
 (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
 Thu, 13 Aug 2020 03:58:49 -0700 (PDT)
Subject: Re: [PATCH] drm/amdgpu: revert "fix system hang issue during GPU
 reset"
To: Alex Deucher <alexdeucher@gmail.com>, "Li, Dennis" <Dennis.Li@amd.com>
References: <20200812155353.105959-1-christian.koenig@amd.com>
 <CADnq5_OeVF-YZu=dcFWa-GYexJ744AQGxd6D3owihrZftjc4Ew@mail.gmail.com>
From: =?UTF-8?Q?Christian_K=c3=b6nig?= <ckoenig.leichtzumerken@gmail.com>
Message-ID: <d5256532-2b92-ed44-a41c-4605c2ae0981@gmail.com>
Date: Thu, 13 Aug 2020 12:58:45 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.10.0
MIME-Version: 1.0
In-Reply-To: <CADnq5_OeVF-YZu=dcFWa-GYexJ744AQGxd6D3owihrZftjc4Ew@mail.gmail.com>
Content-Language: en-US
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Reply-To: christian.koenig@amd.com
Cc: amd-gfx list <amd-gfx@lists.freedesktop.org>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QW0gMTIuMDguMjAgdW0gMTc6NTUgc2NocmllYiBBbGV4IERldWNoZXI6Cj4gT24gV2VkLCBBdWcg
MTIsIDIwMjAgYXQgMTE6NTQgQU0gQ2hyaXN0aWFuIEvDtm5pZwo+IDxja29lbmlnLmxlaWNodHp1
bWVya2VuQGdtYWlsLmNvbT4gd3JvdGU6Cj4+IFRoZSB3aG9sZSBhcHByb2FjaCB3YXNuJ3QgdGhv
dWdodCB0aHJvdWdoIHRpbGwgdGhlIGVuZC4KPj4KPj4gV2UgYWxyZWFkeSBoYWQgYSByZXNldCBs
b2NrIGxpa2UgdGhpcyBpbiB0aGUgcGFzdCBhbmQgaXQgY2F1c2VkIHRoZSBzYW1lIHByb2JsZW1z
IGxpa2UgdGhpcyBvbmUuCj4+Cj4+IENvbXBsZXRlbHkgcmV2ZXJ0IHRoZSBwYXRjaCBmb3Igbm93
IGFuZCBhZGQgaW5kaXZpZHVhbCB0cnlsb2NrIHByb3RlY3Rpb24gdG8gdGhlIGhhcmR3YXJlIGFj
Y2VzcyBmdW5jdGlvbnMgYXMgbmVjZXNzYXJ5Lgo+Pgo+PiBUaGlzIHJldmVydHMgY29tbWl0IGVk
YWQ4MzEyY2JiZjlhMzNjODY4NzNmYzQwOTM2NjRmMTUwZGQ1YzEuCj4+Cj4+IFNpZ25lZC1vZmYt
Ynk6IENocmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KPiBUaGlzIGFs
c28gYnJva2UgR1BVIG92ZXJjbG9ja2luZy4KPgo+IEFja2VkLWJ5OiBBbGV4IERldWNoZXIgPGFs
ZXhhbmRlci5kZXVjaGVyQGFtZC5jb20+CgpEZW5uaXMgc2luY2Ugd2Ugc3RpbGwgd2FudCB0byBm
aXggdGhlIGhhcmR3YXJlIGFjY2VzcyBJIHN1Z2dlc3QgdG8gc3BsaXQgCnRoaXMgcGF0Y2ggdXAg
aW50byB0aGUgc3RydWN0dXJhbCBjaGFuZ2VzIGFuZCBpbmRpdmlkdWFsIHBhdGNoZXMgd2hpY2gg
CmFkZCB0aGUgbG9jayB0byB0aGUgZGlmZmVyZW50IHBsYWNlcyB3aGVyZSBhIGhhcmR3YXJlIGFj
Y2VzcyBoYXBwZW5zLgoKVGhpcyB3YXkgd2UgY2FuIGRpc2N1c3MgYW5kIGV2ZW50dWFsbHkgZml4
L3JldmVydCBlYWNoIGhhcmR3YXJlIGFjY2VzcyAKaW5kaXZpZHVhbGx5CgpUaGFua3MsCkNocmlz
dGlhbi4KCj4KPj4gLS0tCj4+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1Lmgg
ICAgICAgICAgIHwgICA5ICstCj4+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2FtZGtmZC5jICAgIHwgIDQwICstCj4+ICAgLi4uL2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRr
ZmRfZ2Z4X3YxMC5jICAgIHwgICAyICstCj4+ICAgLi4uL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfYW1ka2ZkX2dmeF92Ny5jIHwgICAyICstCj4+ICAgLi4uL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfYW1ka2ZkX2dmeF92OC5jIHwgICAyICstCj4+ICAgLi4uL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfYW1ka2ZkX2dmeF92OS5jIHwgICAyICstCj4+ICAgLi4uL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfYW1ka2ZkX2dwdXZtLmMgIHwgICA3IC0KPj4gICBkcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfY3MuYyAgICAgICAgfCAgIDQgLQo+PiAgIGRyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9jdHguYyAgICAgICB8ICAgNCAtCj4+ICAgZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RlYnVnZnMuYyAgIHwgIDE0ICstCj4+ICAgZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jICAgIHwgIDU3ICsrLQo+PiAgIGRyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZW0uYyAgICAgICB8ICAgNCAtCj4+ICAgZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dmeC5jICAgICAgIHwgICA2ICstCj4+ICAg
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5jICAgICAgIHwgIDE0ICstCj4+
ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ttcy5jICAgICAgIHwgICA0IC0K
Pj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uYyAgICAgICAgfCAzNTMg
KysrKy0tLS0tLS0tLS0tLS0tCj4+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3BzcC5jICAgICAgIHwgICA0ICstCj4+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3Jhcy5jICAgICAgIHwgICA0ICstCj4+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3R0bS5jICAgICAgIHwgICAyICstCj4+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3Vjb2RlLmMgICAgIHwgICAzICstCj4+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3ZpcnQuYyAgICAgIHwgICAyICstCj4+ICAgZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3ZpcnQuaCAgICAgIHwgICA0ICstCj4+ICAgZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X3hnbWkuYyAgICAgIHwgIDExICstCj4+ICAgZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3hnbWkuaCAgICAgIHwgICAzICstCj4+ICAgZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYXRvbS5jICAgICAgICAgICAgIHwgICAxIC0KPj4gICBkcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYyAgICAgICAgfCAgMTAgKy0KPj4gICBkcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjhfMC5jICAgICAgICAgfCAgIDYgKy0KPj4gICBk
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jICAgICAgICAgfCAgMTAgKy0KPj4g
ICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjEwXzAuYyAgICAgICAgfCAgIDQgKy0K
Pj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjdfMC5jICAgICAgICAgfCAgIDIg
Ky0KPj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjhfMC5jICAgICAgICAgfCAg
IDIgKy0KPj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjlfMC5jICAgICAgICAg
fCAgIDcgKy0KPj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9teGdwdV9haS5jICAgICAg
ICAgfCAgMTMgKy0KPj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9teGdwdV9udi5jICAg
ICAgICAgfCAgMTMgKy0KPj4gICAuLi4vZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZV9xdWV1ZV9t
YW5hZ2VyLmMgfCAgMTYgKy0KPj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfcHJv
Y2Vzcy5jICAgICAgfCAgIDQgLQo+PiAgIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9k
bS9hbWRncHVfZG0uYyB8ICAgNCArLQo+PiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5
L2FtZGdwdV9zbXUuYyAgICB8ICAgMiArLQo+PiAgIC4uLi9kcm0vYW1kL3Bvd2VycGxheS9od21n
ci92ZWdhMjBfaHdtZ3IuYyAgICB8ICAgMiArLQo+PiAgIDM5IGZpbGVzIGNoYW5nZWQsIDE4NCBp
bnNlcnRpb25zKCspLCA0NjkgZGVsZXRpb25zKC0pCj4+Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdS5oCj4+IGluZGV4IDFmOWQ5N2Y2MWFhNS4uOWM2ZmIzOGNlNTlkIDEwMDY0NAo+PiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaAo+PiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaAo+PiBAQCAtOTUyLDkgKzk1Miw5IEBAIHN0cnVj
dCBhbWRncHVfZGV2aWNlIHsKPj4gICAgICAgICAgYm9vbCAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBpbl9zdXNwZW5kOwo+PiAgICAgICAgICBib29sICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGluX2hpYmVybmF0ZTsKPj4KPj4gLSAgICAgICBhdG9taWNfdCAgICAgICAgICAgICAgICAg
ICAgICAgIGluX2dwdV9yZXNldDsKPj4gKyAgICAgICBib29sICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGluX2dwdV9yZXNldDsKPj4gICAgICAgICAgZW51bSBwcF9tcDFfc3RhdGUgICAgICAg
ICAgICAgICBtcDFfc3RhdGU7Cj4+IC0gICAgICAgc3RydWN0IHJ3X3NlbWFwaG9yZSAgICAgcmVz
ZXRfc2VtOwo+PiArICAgICAgIHN0cnVjdCBtdXRleCAgbG9ja19yZXNldDsKPj4gICAgICAgICAg
c3RydWN0IGFtZGdwdV9kb29yYmVsbF9pbmRleCBkb29yYmVsbF9pbmRleDsKPj4KPj4gICAgICAg
ICAgc3RydWN0IG11dGV4ICAgICAgICAgICAgICAgICAgICBub3RpZmllcl9sb2NrOwo+PiBAQCAt
MTI2OSw5ICsxMjY5LDQgQEAgc3RhdGljIGlubGluZSBib29sIGFtZGdwdV9pc190bXooc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4+ICAgICAgICAgIHJldHVybiBhZGV2LT5nbWMudG16X2Vu
YWJsZWQ7Cj4+ICAgfQo+Pgo+PiAtc3RhdGljIGlubGluZSBib29sIGFtZGdwdV9pbl9yZXNldChz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPj4gLXsKPj4gLSAgICAgICByZXR1cm4gYXRvbWlj
X3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkgPyB0cnVlIDogZmFsc2U7Cj4+IC19Cj4+IC0KPj4g
ICAjZW5kaWYKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9hbWRrZmQuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmQuYwo+
PiBpbmRleCA5NzM4ZGNjYjFjMmMuLjBlZmZjMWQ0NjgyNCAxMDA2NDQKPj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZC5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmQuYwo+PiBAQCAtMjQ0LDE0ICsyNDQsMTEgQEAg
aW50IGFtZGdwdV9hbWRrZmRfYWxsb2NfZ3R0X21lbShzdHJ1Y3Qga2dkX2RldiAqa2dkLCBzaXpl
X3Qgc2l6ZSwKPj4gICAgICAgICAgaWYgKGNwX21xZF9nZng5KQo+PiAgICAgICAgICAgICAgICAg
IGJwLmZsYWdzIHw9IEFNREdQVV9HRU1fQ1JFQVRFX0NQX01RRF9HRlg5Owo+Pgo+PiAtICAgICAg
IGlmICghZG93bl9yZWFkX3RyeWxvY2soJmFkZXYtPnJlc2V0X3NlbSkpCj4+IC0gICAgICAgICAg
ICAgICByZXR1cm4gLUVJTzsKPj4gLQo+PiAgICAgICAgICByID0gYW1kZ3B1X2JvX2NyZWF0ZShh
ZGV2LCAmYnAsICZibyk7Cj4+ICAgICAgICAgIGlmIChyKSB7Cj4+ICAgICAgICAgICAgICAgICAg
ZGV2X2VycihhZGV2LT5kZXYsCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAiZmFpbGVkIHRv
IGFsbG9jYXRlIEJPIGZvciBhbWRrZmQgKCVkKVxuIiwgcik7Cj4+IC0gICAgICAgICAgICAgICBn
b3RvIGVycjsKPj4gKyAgICAgICAgICAgICAgIHJldHVybiByOwo+PiAgICAgICAgICB9Cj4+Cj4+
ICAgICAgICAgIC8qIG1hcCB0aGUgYnVmZmVyICovCj4+IEBAIC0yODYsNyArMjgzLDYgQEAgaW50
IGFtZGdwdV9hbWRrZmRfYWxsb2NfZ3R0X21lbShzdHJ1Y3Qga2dkX2RldiAqa2dkLCBzaXplX3Qg
c2l6ZSwKPj4KPj4gICAgICAgICAgYW1kZ3B1X2JvX3VucmVzZXJ2ZShibyk7Cj4+Cj4+IC0gICAg
ICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAgICAgICAgcmV0dXJuIDA7Cj4+Cj4+
ICAgYWxsb2NhdGVfbWVtX2ttYXBfYm9fZmFpbGVkOgo+PiBAQCAtMjk1LDI1ICsyOTEsMTkgQEAg
aW50IGFtZGdwdV9hbWRrZmRfYWxsb2NfZ3R0X21lbShzdHJ1Y3Qga2dkX2RldiAqa2dkLCBzaXpl
X3Qgc2l6ZSwKPj4gICAgICAgICAgYW1kZ3B1X2JvX3VucmVzZXJ2ZShibyk7Cj4+ICAgYWxsb2Nh
dGVfbWVtX3Jlc2VydmVfYm9fZmFpbGVkOgo+PiAgICAgICAgICBhbWRncHVfYm9fdW5yZWYoJmJv
KTsKPj4gLWVycjoKPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+
ICAgICAgICAgIHJldHVybiByOwo+PiAgIH0KPj4KPj4gICB2b2lkIGFtZGdwdV9hbWRrZmRfZnJl
ZV9ndHRfbWVtKHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQgKm1lbV9vYmopCj4+ICAgewo+PiAt
ICAgICAgIHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gKHN0cnVjdCBhbWRncHVfZGV2aWNl
ICopa2dkOwo+PiAgICAgICAgICBzdHJ1Y3QgYW1kZ3B1X2JvICpibyA9IChzdHJ1Y3QgYW1kZ3B1
X2JvICopIG1lbV9vYmo7Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Owo+PiAtCj4+ICAgICAgICAgIGFtZGdwdV9ib19yZXNlcnZlKGJvLCB0cnVlKTsKPj4gICAgICAg
ICAgYW1kZ3B1X2JvX2t1bm1hcChibyk7Cj4+ICAgICAgICAgIGFtZGdwdV9ib191bnBpbihibyk7
Cj4+ICAgICAgICAgIGFtZGdwdV9ib191bnJlc2VydmUoYm8pOwo+PiAgICAgICAgICBhbWRncHVf
Ym9fdW5yZWYoJihibykpOwo+PiAtCj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2Vt
KTsKPj4gICB9Cj4+Cj4+ICAgaW50IGFtZGdwdV9hbWRrZmRfYWxsb2NfZ3dzKHN0cnVjdCBrZ2Rf
ZGV2ICprZ2QsIHNpemVfdCBzaXplLAo+PiBAQCAtMzQ1LDE0ICszMzUsOSBAQCBpbnQgYW1kZ3B1
X2FtZGtmZF9hbGxvY19nd3Moc3RydWN0IGtnZF9kZXYgKmtnZCwgc2l6ZV90IHNpemUsCj4+Cj4+
ICAgdm9pZCBhbWRncHVfYW1ka2ZkX2ZyZWVfZ3dzKHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQg
Km1lbV9vYmopCj4+ICAgewo+PiAtICAgICAgIHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0g
KHN0cnVjdCBhbWRncHVfZGV2aWNlICopa2dkOwo+PiAgICAgICAgICBzdHJ1Y3QgYW1kZ3B1X2Jv
ICpibyA9IChzdHJ1Y3QgYW1kZ3B1X2JvICopbWVtX29iajsKPj4KPj4gLSAgICAgICBkb3duX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgYW1kZ3B1X2JvX3VucmVmKCZi
byk7Cj4+IC0KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgIH0KPj4K
Pj4gICB1aW50MzJfdCBhbWRncHVfYW1ka2ZkX2dldF9md192ZXJzaW9uKHN0cnVjdCBrZ2RfZGV2
ICprZ2QsCj4+IEBAIC02MjYsMTUgKzYxMSw4IEBAIGludCBhbWRncHVfYW1ka2ZkX3N1Ym1pdF9p
YihzdHJ1Y3Qga2dkX2RldiAqa2dkLCBlbnVtIGtnZF9lbmdpbmVfdHlwZSBlbmdpbmUsCj4+ICAg
ICAgICAgIC8qIFRoaXMgd29ya3MgZm9yIE5PX0hXUy4gVE9ETzogbmVlZCB0byBoYW5kbGUgd2l0
aG91dCBrbm93aW5nIFZNSUQgKi8KPj4gICAgICAgICAgam9iLT52bWlkID0gdm1pZDsKPj4KPj4g
LSAgICAgICBpZiAoIWRvd25fcmVhZF90cnlsb2NrKCZhZGV2LT5yZXNldF9zZW0pKSB7Cj4+IC0g
ICAgICAgICAgICAgICByZXQgPSAtRUlPOwo+PiAtICAgICAgICAgICAgICAgZ290byBlcnJfaWJf
c2NoZWQ7Cj4+IC0gICAgICAgfQo+PiAtCj4+ICAgICAgICAgIHJldCA9IGFtZGdwdV9pYl9zY2hl
ZHVsZShyaW5nLCAxLCBpYiwgam9iLCAmZik7Cj4+Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+
cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAocmV0KSB7Cj4+ICAgICAgICAgICAgICAg
ICAgRFJNX0VSUk9SKCJhbWRncHU6IGZhaWxlZCB0byBzY2hlZHVsZSBJQi5cbiIpOwo+PiAgICAg
ICAgICAgICAgICAgIGdvdG8gZXJyX2liX3NjaGVkOwo+PiBAQCAtNjcwLDkgKzY0OCw2IEBAIGlu
dCBhbWRncHVfYW1ka2ZkX2ZsdXNoX2dwdV90bGJfdm1pZChzdHJ1Y3Qga2dkX2RldiAqa2dkLCB1
aW50MTZfdCB2bWlkKQo+PiAgIHsKPj4gICAgICAgICAgc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKilrZ2Q7Cj4+Cj4+IC0gICAgICAgaWYgKCFkb3du
X3JlYWRfdHJ5bG9jaygmYWRldi0+cmVzZXRfc2VtKSkKPj4gLSAgICAgICAgICAgICAgIHJldHVy
biAtRUlPOwo+PiAtCj4+ICAgICAgICAgIGlmIChhZGV2LT5mYW1pbHkgPT0gQU1ER1BVX0ZBTUlM
WV9BSSkgewo+PiAgICAgICAgICAgICAgICAgIGludCBpOwo+Pgo+PiBAQCAtNjgyLDggKzY1Nyw2
IEBAIGludCBhbWRncHVfYW1ka2ZkX2ZsdXNoX2dwdV90bGJfdm1pZChzdHJ1Y3Qga2dkX2RldiAq
a2dkLCB1aW50MTZfdCB2bWlkKQo+PiAgICAgICAgICAgICAgICAgIGFtZGdwdV9nbWNfZmx1c2hf
Z3B1X3RsYihhZGV2LCB2bWlkLCBBTURHUFVfR0ZYSFVCXzAsIDApOwo+PiAgICAgICAgICB9Cj4+
Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBy
ZXR1cm4gMDsKPj4gICB9Cj4+Cj4+IEBAIC02OTIsMTggKzY2NSwxMSBAQCBpbnQgYW1kZ3B1X2Ft
ZGtmZF9mbHVzaF9ncHVfdGxiX3Bhc2lkKHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHVpbnQxNl90IHBh
c2lkKQo+PiAgICAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqKWtnZDsKPj4gICAgICAgICAgY29uc3QgdWludDMyX3QgZmx1c2hfdHlwZSA9
IDA7Cj4+ICAgICAgICAgIGJvb2wgYWxsX2h1YiA9IGZhbHNlOwo+PiAtICAgICAgIGludCByZXQg
PSAtRUlPOwo+Pgo+PiAgICAgICAgICBpZiAoYWRldi0+ZmFtaWx5ID09IEFNREdQVV9GQU1JTFlf
QUkpCj4+ICAgICAgICAgICAgICAgICAgYWxsX2h1YiA9IHRydWU7Cj4+Cj4+IC0gICAgICAgaWYg
KGRvd25fcmVhZF90cnlsb2NrKCZhZGV2LT5yZXNldF9zZW0pKSB7Cj4+IC0gICAgICAgICAgICAg
ICByZXQgPSBhbWRncHVfZ21jX2ZsdXNoX2dwdV90bGJfcGFzaWQoYWRldiwKPj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc2lkLCBmbHVzaF90eXBlLCBhbGxfaHVi
KTsKPj4gLSAgICAgICAgICAgICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0gICAg
ICAgfQo+PiAtCj4+IC0gICAgICAgcmV0dXJuIHJldDsKPj4gKyAgICAgICByZXR1cm4gYW1kZ3B1
X2dtY19mbHVzaF9ncHVfdGxiX3Bhc2lkKGFkZXYsIHBhc2lkLCBmbHVzaF90eXBlLCBhbGxfaHVi
KTsKPj4gICB9Cj4+Cj4+ICAgYm9vbCBhbWRncHVfYW1ka2ZkX2hhdmVfYXRvbWljc19zdXBwb3J0
KHN0cnVjdCBrZ2RfZGV2ICprZ2QpCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92MTAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3YxMC5jCj4+IGluZGV4IGI4NzJjZGIwYjcwNS4uNjkxYzg5
NzA1YmNkIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
YW1ka2ZkX2dmeF92MTAuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfYW1ka2ZkX2dmeF92MTAuYwo+PiBAQCAtNTQzLDcgKzU0Myw3IEBAIHN0YXRpYyBpbnQga2dk
X2hxZF9kZXN0cm95KHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQgKm1xZCwKPj4gICAgICAgICAg
dWludDMyX3QgdGVtcDsKPj4gICAgICAgICAgc3RydWN0IHYxMF9jb21wdXRlX21xZCAqbSA9IGdl
dF9tcWQobXFkKTsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiAr
ICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJu
IC1FSU87Cj4+Cj4+ICAgI2lmIDAKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y3LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfYW1ka2ZkX2dmeF92Ny5jCj4+IGluZGV4IDgzMmEyMDBiYjYyZi4uMGI3ZTc4NzQ4
NTQwIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1k
a2ZkX2dmeF92Ny5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9h
bWRrZmRfZ2Z4X3Y3LmMKPj4gQEAgLTQyNSw3ICs0MjUsNyBAQCBzdGF0aWMgaW50IGtnZF9ocWRf
ZGVzdHJveShzdHJ1Y3Qga2dkX2RldiAqa2dkLCB2b2lkICptcWQsCj4+ICAgICAgICAgIHVuc2ln
bmVkIGxvbmcgZmxhZ3MsIGVuZF9qaWZmaWVzOwo+PiAgICAgICAgICBpbnQgcmV0cnk7Cj4+Cj4+
IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+
aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRUlPOwo+Pgo+PiAgICAg
ICAgICBhY3F1aXJlX3F1ZXVlKGtnZCwgcGlwZV9pZCwgcXVldWVfaWQpOwo+PiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjguYyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y4LmMKPj4gaW5kZXgg
ZDA5NDAxMjFhNmE5Li5jY2Q2MzViODEyYjUgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y4LmMKPj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjguYwo+PiBAQCAtNDIxLDcgKzQyMSw3
IEBAIHN0YXRpYyBpbnQga2dkX2hxZF9kZXN0cm95KHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQg
Km1xZCwKPj4gICAgICAgICAgaW50IHJldHJ5Owo+PiAgICAgICAgICBzdHJ1Y3QgdmlfbXFkICpt
ID0gZ2V0X21xZChtcWQpOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikp
Cj4+ICsgICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICBy
ZXR1cm4gLUVJTzsKPj4KPj4gICAgICAgICAgYWNxdWlyZV9xdWV1ZShrZ2QsIHBpcGVfaWQsIHF1
ZXVlX2lkKTsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9hbWRrZmRfZ2Z4X3Y5LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1k
a2ZkX2dmeF92OS5jCj4+IGluZGV4IDdlMTE2MjViNDE5ZS4uOTYxNDI0YmM3YTFmIDEwMDY0NAo+
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92OS5j
Cj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y5
LmMKPj4gQEAgLTU0MSw3ICs1NDEsNyBAQCBpbnQga2dkX2dmeF92OV9ocWRfZGVzdHJveShzdHJ1
Y3Qga2dkX2RldiAqa2dkLCB2b2lkICptcWQsCj4+ICAgICAgICAgIHVpbnQzMl90IHRlbXA7Cj4+
ICAgICAgICAgIHN0cnVjdCB2OV9tcWQgKm0gPSBnZXRfbXFkKG1xZCk7Cj4+Cj4+IC0gICAgICAg
aWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jl
c2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRUlPOwo+Pgo+PiAgICAgICAgICBhY3F1
aXJlX3F1ZXVlKGtnZCwgcGlwZV9pZCwgcXVldWVfaWQpOwo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jCj4+IGluZGV4IDBkNzU3MjZiZDIy
OC4uN2UyMzk0YjUwZmJmIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfYW1ka2ZkX2dwdXZtLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jCj4+IEBAIC0xMTk0LDkgKzExOTQsNiBAQCBpbnQgYW1k
Z3B1X2FtZGtmZF9ncHV2bV9hbGxvY19tZW1vcnlfb2ZfZ3B1KAo+PiAgICAgICAgICAgICAgICAg
IHJldHVybiAtRUlOVkFMOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgaWYgKCFkb3duX3Jl
YWRfdHJ5bG9jaygmYWRldi0+cmVzZXRfc2VtKSkKPj4gLSAgICAgICAgICAgICAgIHJldHVybiAt
RUlPOwo+PiAtCj4+ICAgICAgICAgICptZW0gPSBremFsbG9jKHNpemVvZihzdHJ1Y3Qga2dkX21l
bSksIEdGUF9LRVJORUwpOwo+PiAgICAgICAgICBpZiAoISptZW0pIHsKPj4gICAgICAgICAgICAg
ICAgICByZXQgPSAtRU5PTUVNOwo+PiBAQCAtMTI2Myw3ICsxMjYwLDYgQEAgaW50IGFtZGdwdV9h
bWRrZmRfZ3B1dm1fYWxsb2NfbWVtb3J5X29mX2dwdSgKPj4gICAgICAgICAgaWYgKG9mZnNldCkK
Pj4gICAgICAgICAgICAgICAgICAqb2Zmc2V0ID0gYW1kZ3B1X2JvX21tYXBfb2Zmc2V0KGJvKTsK
Pj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAgICAgICByZXR1
cm4gMDsKPj4KPj4gICBhbGxvY2F0ZV9pbml0X3VzZXJfcGFnZXNfZmFpbGVkOgo+PiBAQCAtMTI4
MSw5ICsxMjc3LDYgQEAgaW50IGFtZGdwdV9hbWRrZmRfZ3B1dm1fYWxsb2NfbWVtb3J5X29mX2dw
dSgKPj4gICAgICAgICAgICAgICAgICBzZ19mcmVlX3RhYmxlKHNnKTsKPj4gICAgICAgICAgICAg
ICAgICBrZnJlZShzZyk7Cj4+ICAgICAgICAgIH0KPj4gLQo+PiAtICAgICAgIHVwX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgcmV0dXJuIHJldDsKPj4gICB9Cj4+Cj4+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3MuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jCj4+IGluZGV4IGE5NGIzZjg2MmZj
Mi4uZmZiY2FmNGJmYjhiIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfY3MuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
Y3MuYwo+PiBAQCAtMTI5Miw4ICsxMjkyLDYgQEAgaW50IGFtZGdwdV9jc19pb2N0bChzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbHApCj4+ICAg
ICAgICAgIHBhcnNlci5hZGV2ID0gYWRldjsKPj4gICAgICAgICAgcGFyc2VyLmZpbHAgPSBmaWxw
Owo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAg
ICAgICByID0gYW1kZ3B1X2NzX3BhcnNlcl9pbml0KCZwYXJzZXIsIGRhdGEpOwo+PiAgICAgICAg
ICBpZiAocikgewo+PiAgICAgICAgICAgICAgICAgIERSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRp
YWxpemUgcGFyc2VyICVkIVxuIiwgcik7Cj4+IEBAIC0xMzMzLDggKzEzMzEsNiBAQCBpbnQgYW1k
Z3B1X2NzX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsIHN0cnVjdCBk
cm1fZmlsZSAqZmlscCkKPj4gICBvdXQ6Cj4+ICAgICAgICAgIGFtZGdwdV9jc19wYXJzZXJfZmlu
aSgmcGFyc2VyLCByLCByZXNlcnZlZF9idWZmZXJzKTsKPj4KPj4gLSAgICAgICB1cF9yZWFkKCZh
ZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHJldHVybiByOwo+PiAgIH0KPj4KPj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jdHguYyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jdHguYwo+PiBpbmRleCBkODVkMTNmN2Ew
NDMuLjg4NDJjNTVkNDQ5MCAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2N0eC5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9jdHguYwo+PiBAQCAtMzU4LDggKzM1OCw2IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2N0eF9xdWVy
eTIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4+ICAgICAgICAgIGlmIChhdG9taWNfcmVh
ZCgmY3R4LT5ndWlsdHkpKQo+PiAgICAgICAgICAgICAgICAgIG91dC0+c3RhdGUuZmxhZ3MgfD0g
QU1ER1BVX0NUWF9RVUVSWTJfRkxBR1NfR1VJTFRZOwo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICAvKnF1ZXJ5IHVlIGNvdW50Ki8KPj4g
ICAgICAgICAgcmFzX2NvdW50ZXIgPSBhbWRncHVfcmFzX3F1ZXJ5X2Vycm9yX2NvdW50KGFkZXYs
IGZhbHNlKTsKPj4gICAgICAgICAgLypyYXMgY291bnRlciBpcyBtb25vdG9uaWMgaW5jcmVhc2lu
ZyovCj4+IEBAIC0zNzUsOCArMzczLDYgQEAgc3RhdGljIGludCBhbWRncHVfY3R4X3F1ZXJ5Mihz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPj4gICAgICAgICAgICAgICAgICBjdHgtPnJhc19j
b3VudGVyX2NlID0gcmFzX2NvdW50ZXI7Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICB1cF9y
ZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIG11dGV4X3VubG9jaygmbWdy
LT5sb2NrKTsKPj4gICAgICAgICAgcmV0dXJuIDA7Cj4+ICAgfQo+PiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RlYnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9kZWJ1Z2ZzLmMKPj4gaW5kZXggMGFmMjQ5YTFlMzViLi4zNWZl
ZDc1YTQzOTcgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9kZWJ1Z2ZzLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rl
YnVnZnMuYwo+PiBAQCAtMTAxLDE0ICsxMDEsMTQgQEAgc3RhdGljIGludCBhbWRncHVfZGVidWdm
c19hdXRvZHVtcF9vcGVuKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQo+
Pgo+PiAgICAgICAgICBmaWxlLT5wcml2YXRlX2RhdGEgPSBhZGV2Owo+Pgo+PiAtICAgICAgIGRv
d25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKyAgICAgICBtdXRleF9sb2NrKCZhZGV2LT5s
b2NrX3Jlc2V0KTsKPj4gICAgICAgICAgaWYgKGFkZXYtPmF1dG9kdW1wLmR1bXBpbmcuZG9uZSkg
ewo+PiAgICAgICAgICAgICAgICAgIHJlaW5pdF9jb21wbGV0aW9uKCZhZGV2LT5hdXRvZHVtcC5k
dW1waW5nKTsKPj4gICAgICAgICAgICAgICAgICByZXQgPSAwOwo+PiAgICAgICAgICB9IGVsc2Ug
ewo+PiAgICAgICAgICAgICAgICAgIHJldCA9IC1FQlVTWTsKPj4gICAgICAgICAgfQo+PiAtICAg
ICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsgICAgICAgbXV0ZXhfdW5sb2NrKCZh
ZGV2LT5sb2NrX3Jlc2V0KTsKPj4KPj4gICAgICAgICAgcmV0dXJuIHJldDsKPj4gICB9Cj4+IEBA
IC0xMjcsNyArMTI3LDcgQEAgc3RhdGljIHVuc2lnbmVkIGludCBhbWRncHVfZGVidWdmc19hdXRv
ZHVtcF9wb2xsKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgcG9sbF8KPj4KPj4gICAgICAgICAg
cG9sbF93YWl0KGZpbGUsICZhZGV2LT5hdXRvZHVtcC5ncHVfaGFuZywgcG9sbF90YWJsZSk7Cj4+
Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRl
di0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiBQT0xMSU4gfCBQT0xM
UkROT1JNIHwgUE9MTFdSTk9STTsKPj4KPj4gICAgICAgICAgcmV0dXJuIDA7Cj4+IEBAIC0xMjQy
LDcgKzEyNDIsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV9kZWJ1Z2ZzX3Rlc3RfaWIoc3RydWN0IHNl
cV9maWxlICptLCB2b2lkICpkYXRhKQo+PiAgICAgICAgICB9Cj4+Cj4+ICAgICAgICAgIC8qIEF2
b2lkIGFjY2lkZW50bHkgdW5wYXJraW5nIHRoZSBzY2hlZCB0aHJlYWQgZHVyaW5nIEdQVSByZXNl
dCAqLwo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKyAgICAgICBt
dXRleF9sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPj4KPj4gICAgICAgICAgLyogaG9sZCBvbiB0
aGUgc2NoZWR1bGVyICovCj4+ICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBBTURHUFVfTUFYX1JJ
TkdTOyBpKyspIHsKPj4gQEAgLTEyNjksNyArMTI2OSw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2Rl
YnVnZnNfdGVzdF9pYihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4+ICAgICAgICAg
ICAgICAgICAga3RocmVhZF91bnBhcmsocmluZy0+c2NoZWQudGhyZWFkKTsKPj4gICAgICAgICAg
fQo+Pgo+PiAtICAgICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsgICAgICAgbXV0
ZXhfdW5sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPj4KPj4gICAgICAgICAgcG1fcnVudGltZV9t
YXJrX2xhc3RfYnVzeShkZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9z
dXNwZW5kKGRldi0+ZGV2KTsKPj4gQEAgLTE0NTksNyArMTQ1OSw3IEBAIHN0YXRpYyBpbnQgYW1k
Z3B1X2RlYnVnZnNfaWJfcHJlZW1wdCh2b2lkICpkYXRhLCB1NjQgdmFsKQo+PiAgICAgICAgICAg
ICAgICAgIHJldHVybiAtRU5PTUVNOwo+Pgo+PiAgICAgICAgICAvKiBBdm9pZCBhY2NpZGVudGx5
IHVucGFya2luZyB0aGUgc2NoZWQgdGhyZWFkIGR1cmluZyBHUFUgcmVzZXQgKi8KPj4gLSAgICAg
ICBkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsgICAgICAgbXV0ZXhfbG9jaygmYWRl
di0+bG9ja19yZXNldCk7Cj4+Cj4+ICAgICAgICAgIC8qIHN0b3AgdGhlIHNjaGVkdWxlciAqLwo+
PiAgICAgICAgICBrdGhyZWFkX3BhcmsocmluZy0+c2NoZWQudGhyZWFkKTsKPj4gQEAgLTE1MDAs
NyArMTUwMCw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RlYnVnZnNfaWJfcHJlZW1wdCh2b2lkICpk
YXRhLCB1NjQgdmFsKQo+PiAgICAgICAgICAvKiByZXN0YXJ0IHRoZSBzY2hlZHVsZXIgKi8KPj4g
ICAgICAgICAga3RocmVhZF91bnBhcmsocmluZy0+c2NoZWQudGhyZWFkKTsKPj4KPj4gLSAgICAg
ICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArICAgICAgIG11dGV4X3VubG9jaygmYWRl
di0+bG9ja19yZXNldCk7Cj4+Cj4+ICAgICAgICAgIHR0bV9ib191bmxvY2tfZGVsYXllZF93b3Jr
cXVldWUoJmFkZXYtPm1tYW4uYmRldiwgcmVzY2hlZCk7Cj4+Cj4+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMKPj4gaW5kZXggZmU4ODc4NzYxYzI5Li4xOWFhMGQ3
MzM0YzcgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9k
ZXZpY2UuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNl
LmMKPj4gQEAgLTE5NDAsNyArMTk0MCw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RldmljZV9md19s
b2FkaW5nKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQo+PiAgICAgICAgICAgICAgICAgICAg
ICAgICAgaWYgKGFkZXYtPmlwX2Jsb2Nrc1tpXS5zdGF0dXMuaHcgPT0gdHJ1ZSkKPj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4+Cj4+IC0gICAgICAgICAgICAgICAg
ICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikgfHwgYWRldi0+aW5fc3VzcGVuZCkgewo+
PiArICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0IHx8IGFkZXYt
PmluX3N1c3BlbmQpIHsKPj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9IGFk
ZXYtPmlwX2Jsb2Nrc1tpXS52ZXJzaW9uLT5mdW5jcy0+cmVzdW1lKGFkZXYpOwo+PiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocikgewo+PiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIERSTV9FUlJPUigicmVzdW1lIG9mIElQIGJsb2NrIDwlcz4g
ZmFpbGVkICVkXG4iLAo+PiBAQCAtMjExNyw3ICsyMTE3LDcgQEAgc3RhdGljIGJvb2wgYW1kZ3B1
X2RldmljZV9jaGVja192cmFtX2xvc3Qoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4+ICAg
ICAgICAgICAgICAgICAgICAgICAgICBBTURHUFVfUkVTRVRfTUFHSUNfTlVNKSkKPj4gICAgICAg
ICAgICAgICAgICByZXR1cm4gdHJ1ZTsKPj4KPj4gLSAgICAgICBpZiAoIWFtZGdwdV9pbl9yZXNl
dChhZGV2KSkKPj4gKyAgICAgICBpZiAoIWFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAg
ICAgICAgICByZXR1cm4gZmFsc2U7Cj4+Cj4+ICAgICAgICAgIC8qCj4+IEBAIC0zMDU1LDggKzMw
NTUsNyBAQCBpbnQgYW1kZ3B1X2RldmljZV9pbml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
LAo+PiAgICAgICAgICBtdXRleF9pbml0KCZhZGV2LT5tbl9sb2NrKTsKPj4gICAgICAgICAgbXV0
ZXhfaW5pdCgmYWRldi0+dmlydC52Zl9lcnJvcnMubG9jayk7Cj4+ICAgICAgICAgIGhhc2hfaW5p
dChhZGV2LT5tbl9oYXNoKTsKPj4gLSAgICAgICBpbml0X3J3c2VtKCZhZGV2LT5yZXNldF9zZW0p
Owo+PiAtICAgICAgIGF0b21pY19zZXQoJmFkZXYtPmluX2dwdV9yZXNldCwgMCk7Cj4+ICsgICAg
ICAgbXV0ZXhfaW5pdCgmYWRldi0+bG9ja19yZXNldCk7Cj4+ICAgICAgICAgIG11dGV4X2luaXQo
JmFkZXYtPnBzcC5tdXRleCk7Cj4+ICAgICAgICAgIG11dGV4X2luaXQoJmFkZXYtPm5vdGlmaWVy
X2xvY2spOwo+Pgo+PiBAQCAtNDA4NCwxMSArNDA4Myw4IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2Rv
X2FzaWNfcmVzZXQoc3RydWN0IGFtZGdwdV9oaXZlX2luZm8gKmhpdmUsCj4+ICAgICAgICAgIGxp
c3RfZm9yX2VhY2hfZW50cnkodG1wX2FkZXYsIGRldmljZV9saXN0X2hhbmRsZSwgZ21jLnhnbWku
aGVhZCkgewo+PiAgICAgICAgICAgICAgICAgIGlmIChuZWVkX2Z1bGxfcmVzZXQpIHsKPj4gICAg
ICAgICAgICAgICAgICAgICAgICAgIC8qIHBvc3QgY2FyZCAqLwo+PiAtICAgICAgICAgICAgICAg
ICAgICAgICBpZiAoYW1kZ3B1X2F0b21fYXNpY19pbml0KHRtcF9hZGV2LT5tb2RlX2luZm8uYXRv
bV9jb250ZXh0KSkgewo+PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldl93YXJu
KHRtcF9hZGV2LT5kZXYsICJhc2ljIGF0b20gaW5pdCBmYWlsZWQhIik7Cj4+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgciA9IC1FQUdBSU47Cj4+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZ290byBvdXQ7Cj4+IC0gICAgICAgICAgICAgICAgICAgICAgIH0KPj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKGFtZGdwdV9hdG9tX2FzaWNfaW5pdCh0bXBfYWRldi0+
bW9kZV9pbmZvLmF0b21fY29udGV4dCkpCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgRFJNX1dBUk4oImFzaWMgYXRvbSBpbml0IGZhaWxlZCEiKTsKPj4KPj4gICAgICAgICAgICAg
ICAgICAgICAgICAgIGlmICghcikgewo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBkZXZfaW5mbyh0bXBfYWRldi0+ZGV2LCAiR1BVIHJlc2V0IHN1Y2NlZWRlZCwgdHJ5aW5nIHRv
IHJlc3VtZVxuIik7Cj4+IEBAIC00MTc4LDE4ICs0MTc0LDE2IEBAIHN0YXRpYyBpbnQgYW1kZ3B1
X2RvX2FzaWNfcmVzZXQoc3RydWN0IGFtZGdwdV9oaXZlX2luZm8gKmhpdmUsCj4+ICAgICAgICAg
IHJldHVybiByOwo+PiAgIH0KPj4KPj4gLXN0YXRpYyBib29sIGFtZGdwdV9kZXZpY2VfbG9ja19h
ZGV2KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgYW1kZ3B1X2hpdmVfaW5mbyAq
aGl2ZSkKPj4gK3N0YXRpYyBib29sIGFtZGdwdV9kZXZpY2VfbG9ja19hZGV2KHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2LCBib29sIHRyeWxvY2spCj4+ICAgewo+PiAtICAgICAgIGlmIChhdG9t
aWNfY21weGNoZygmYWRldi0+aW5fZ3B1X3Jlc2V0LCAwLCAxKSAhPSAwKQo+PiAtICAgICAgICAg
ICAgICAgcmV0dXJuIGZhbHNlOwo+PiAtCj4+IC0gICAgICAgaWYgKGhpdmUpIHsKPj4gLSAgICAg
ICAgICAgICAgIGRvd25fd3JpdGVfbmVzdF9sb2NrKCZhZGV2LT5yZXNldF9zZW0sICZoaXZlLT5o
aXZlX2xvY2spOwo+PiAtICAgICAgIH0gZWxzZSB7Cj4+IC0gICAgICAgICAgICAgICBkb3duX3dy
aXRlKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtICAgICAgIH0KPj4gKyAgICAgICBpZiAodHJ5bG9j
aykgewo+PiArICAgICAgICAgICAgICAgaWYgKCFtdXRleF90cnlsb2NrKCZhZGV2LT5sb2NrX3Jl
c2V0KSkKPj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwo+PiArICAgICAg
IH0gZWxzZQo+PiArICAgICAgICAgICAgICAgbXV0ZXhfbG9jaygmYWRldi0+bG9ja19yZXNldCk7
Cj4+Cj4+ICAgICAgICAgIGF0b21pY19pbmMoJmFkZXYtPmdwdV9yZXNldF9jb3VudGVyKTsKPj4g
KyAgICAgICBhZGV2LT5pbl9ncHVfcmVzZXQgPSB0cnVlOwo+PiAgICAgICAgICBzd2l0Y2ggKGFt
ZGdwdV9hc2ljX3Jlc2V0X21ldGhvZChhZGV2KSkgewo+PiAgICAgICAgICBjYXNlIEFNRF9SRVNF
VF9NRVRIT0RfTU9ERTE6Cj4+ICAgICAgICAgICAgICAgICAgYWRldi0+bXAxX3N0YXRlID0gUFBf
TVAxX1NUQVRFX1NIVVRET1dOOwo+PiBAQCAtNDIwOSw4ICs0MjAzLDggQEAgc3RhdGljIHZvaWQg
YW1kZ3B1X2RldmljZV91bmxvY2tfYWRldihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPj4g
ICB7Cj4+ICAgICAgICAgIGFtZGdwdV92Zl9lcnJvcl90cmFuc19hbGwoYWRldik7Cj4+ICAgICAg
ICAgIGFkZXYtPm1wMV9zdGF0ZSA9IFBQX01QMV9TVEFURV9OT05FOwo+PiAtICAgICAgIGF0b21p
Y19zZXQoJmFkZXYtPmluX2dwdV9yZXNldCwgMCk7Cj4+IC0gICAgICAgdXBfd3JpdGUoJmFkZXYt
PnJlc2V0X3NlbSk7Cj4+ICsgICAgICAgYWRldi0+aW5fZ3B1X3Jlc2V0ID0gZmFsc2U7Cj4+ICsg
ICAgICAgbXV0ZXhfdW5sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPj4gICB9Cj4+Cj4+ICAgc3Rh
dGljIHZvaWQgYW1kZ3B1X2RldmljZV9yZXN1bWVfZGlzcGxheV9hdWRpbyhzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqYWRldikKPj4gQEAgLTQzMjAsMTQgKzQzMTQsMTIgQEAgaW50IGFtZGdwdV9kZXZp
Y2VfZ3B1X3JlY292ZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4+ICAgICAgICAgICAq
IFdlIGFsd2F5cyByZXNldCBhbGwgc2NoZWR1bGVycyBmb3IgZGV2aWNlIGFuZCBhbGwgZGV2aWNl
cyBmb3IgWEdNSQo+PiAgICAgICAgICAgKiBoaXZlIHNvIHRoYXQgc2hvdWxkIHRha2UgY2FyZSBv
ZiB0aGVtIHRvby4KPj4gICAgICAgICAgICovCj4+IC0gICAgICAgaGl2ZSA9IGFtZGdwdV9nZXRf
eGdtaV9oaXZlKGFkZXYsIGZhbHNlKTsKPj4gLSAgICAgICBpZiAoaGl2ZSkgewo+PiAtICAgICAg
ICAgICAgICAgaWYgKGF0b21pY19jbXB4Y2hnKCZoaXZlLT5pbl9yZXNldCwgMCwgMSkgIT0gMCkg
ewo+PiAtICAgICAgICAgICAgICAgICAgICAgICBEUk1fSU5GTygiQmFpbGluZyBvbiBURFIgZm9y
IHNfam9iOiVsbHgsIGhpdmU6ICVsbHggYXMgYW5vdGhlciBhbHJlYWR5IGluIHByb2dyZXNzIiwK
Pj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqb2IgPyBqb2ItPmJhc2UuaWQgOiAt
MSwgaGl2ZS0+aGl2ZV9pZCk7Cj4+IC0gICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOwo+
PiAtICAgICAgICAgICAgICAgfQo+PiAtICAgICAgICAgICAgICAgbXV0ZXhfbG9jaygmaGl2ZS0+
aGl2ZV9sb2NrKTsKPj4gKyAgICAgICBoaXZlID0gYW1kZ3B1X2dldF94Z21pX2hpdmUoYWRldiwg
dHJ1ZSk7Cj4+ICsgICAgICAgaWYgKGhpdmUgJiYgIW11dGV4X3RyeWxvY2soJmhpdmUtPnJlc2V0
X2xvY2spKSB7Cj4+ICsgICAgICAgICAgICAgICBEUk1fSU5GTygiQmFpbGluZyBvbiBURFIgZm9y
IHNfam9iOiVsbHgsIGhpdmU6ICVsbHggYXMgYW5vdGhlciBhbHJlYWR5IGluIHByb2dyZXNzIiwK
Pj4gKyAgICAgICAgICAgICAgICAgICAgICAgICBqb2IgPyBqb2ItPmJhc2UuaWQgOiAtMSwgaGl2
ZS0+aGl2ZV9pZCk7Cj4+ICsgICAgICAgICAgICAgICBtdXRleF91bmxvY2soJmhpdmUtPmhpdmVf
bG9jayk7Cj4+ICsgICAgICAgICAgICAgICByZXR1cm4gMDsKPj4gICAgICAgICAgfQo+Pgo+PiAg
ICAgICAgICAvKgo+PiBAQCAtNDM0OSwxMSArNDM0MSwxMSBAQCBpbnQgYW1kZ3B1X2RldmljZV9n
cHVfcmVjb3ZlcihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPj4KPj4gICAgICAgICAgLyog
YmxvY2sgYWxsIHNjaGVkdWxlcnMgYW5kIHJlc2V0IGdpdmVuIGpvYidzIHJpbmcgKi8KPj4gICAg
ICAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeSh0bXBfYWRldiwgZGV2aWNlX2xpc3RfaGFuZGxlLCBn
bWMueGdtaS5oZWFkKSB7Cj4+IC0gICAgICAgICAgICAgICBpZiAoIWFtZGdwdV9kZXZpY2VfbG9j
a19hZGV2KHRtcF9hZGV2LCBoaXZlKSkgewo+PiArICAgICAgICAgICAgICAgaWYgKCFhbWRncHVf
ZGV2aWNlX2xvY2tfYWRldih0bXBfYWRldiwgIWhpdmUpKSB7Cj4+ICAgICAgICAgICAgICAgICAg
ICAgICAgICBEUk1fSU5GTygiQmFpbGluZyBvbiBURFIgZm9yIHNfam9iOiVsbHgsIGFzIGFub3Ro
ZXIgYWxyZWFkeSBpbiBwcm9ncmVzcyIsCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgam9iID8gam9iLT5iYXNlLmlkIDogLTEpOwo+PiAtICAgICAgICAgICAgICAgICAgICAg
ICByID0gMDsKPj4gLSAgICAgICAgICAgICAgICAgICAgICAgZ290byBza2lwX3JlY292ZXJ5Owo+
PiArICAgICAgICAgICAgICAgICAgICAgICBtdXRleF91bmxvY2soJmhpdmUtPmhpdmVfbG9jayk7
Cj4+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOwo+PiAgICAgICAgICAgICAgICAg
IH0KPj4KPj4gICAgICAgICAgICAgICAgICAvKgo+PiBAQCAtNDQ4Niw5ICs0NDc4LDggQEAgaW50
IGFtZGdwdV9kZXZpY2VfZ3B1X3JlY292ZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4+
ICAgICAgICAgICAgICAgICAgYW1kZ3B1X2RldmljZV91bmxvY2tfYWRldih0bXBfYWRldik7Cj4+
ICAgICAgICAgIH0KPj4KPj4gLXNraXBfcmVjb3Zlcnk6Cj4+ICAgICAgICAgIGlmIChoaXZlKSB7
Cj4+IC0gICAgICAgICAgICAgICBhdG9taWNfc2V0KCZoaXZlLT5pbl9yZXNldCwgMCk7Cj4+ICsg
ICAgICAgICAgICAgICBtdXRleF91bmxvY2soJmhpdmUtPnJlc2V0X2xvY2spOwo+PiAgICAgICAg
ICAgICAgICAgIG11dGV4X3VubG9jaygmaGl2ZS0+aGl2ZV9sb2NrKTsKPj4gICAgICAgICAgfQo+
Pgo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dlbS5j
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dlbS5jCj4+IGluZGV4IGVlMWU4
ZmZmODNiMi4uOGM2NGQ4ZDZjYjgyIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfZ2VtLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2dlbS5jCj4+IEBAIC02NzAsOCArNjcwLDYgQEAgaW50IGFtZGdwdV9nZW1fdmFfaW9j
dGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPj4gICAgICAgICAgICAgICAg
ICBib192YSA9IE5VTEw7Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgc3dpdGNoIChhcmdzLT5vcGVyYXRpb24p
IHsKPj4gICAgICAgICAgY2FzZSBBTURHUFVfVkFfT1BfTUFQOgo+PiAgICAgICAgICAgICAgICAg
IHZhX2ZsYWdzID0gYW1kZ3B1X2dlbV92YV9tYXBfZmxhZ3MoYWRldiwgYXJncy0+ZmxhZ3MpOwo+
PiBAQCAtNzAxLDggKzY5OSw2IEBAIGludCBhbWRncHVfZ2VtX3ZhX2lvY3RsKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4+ICAgICAgICAgICAgICAgICAgYW1kZ3B1X2dlbV92
YV91cGRhdGVfdm0oYWRldiwgJmZwcml2LT52bSwgYm9fdmEsCj4+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgYXJncy0+b3BlcmF0aW9uKTsKPj4KPj4gLSAgICAgICB1
cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgZXJyb3JfYmFja29mZjoKPj4gICAg
ICAgICAgdHRtX2V1X2JhY2tvZmZfcmVzZXJ2YXRpb24oJnRpY2tldCwgJmxpc3QpOwo+Pgo+PiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dmeC5jIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dmeC5jCj4+IGluZGV4IDhjY2QxN2QwMmNj
Ni4uYTgxOTM2MGE0YjZhIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfZ2Z4LmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2dmeC5jCj4+IEBAIC03MTksNyArNzE5LDcgQEAgdWludDMyX3QgYW1kZ3B1X2tpcV9ycmVnKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1aW50MzJfdCByZWcpCj4+ICAgICAgICAgICAqCj4+
ICAgICAgICAgICAqIGFsc28gZG9uJ3Qgd2FpdCBhbnltb3JlIGZvciBJUlEgY29udGV4dAo+PiAg
ICAgICAgICAgKiAqLwo+PiAtICAgICAgIGlmIChyIDwgMSAmJiAoYW1kZ3B1X2luX3Jlc2V0KGFk
ZXYpIHx8IGluX2ludGVycnVwdCgpKSkKPj4gKyAgICAgICBpZiAociA8IDEgJiYgKGFkZXYtPmlu
X2dwdV9yZXNldCB8fCBpbl9pbnRlcnJ1cHQoKSkpCj4+ICAgICAgICAgICAgICAgICAgZ290byBm
YWlsZWRfa2lxX3JlYWQ7Cj4+Cj4+ICAgICAgICAgIG1pZ2h0X3NsZWVwKCk7Cj4+IEBAIC03Nzcs
NyArNzc3LDcgQEAgdm9pZCBhbWRncHVfa2lxX3dyZWcoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYsIHVpbnQzMl90IHJlZywgdWludDMyX3QgdikKPj4gICAgICAgICAgICoKPj4gICAgICAgICAg
ICogYWxzbyBkb24ndCB3YWl0IGFueW1vcmUgZm9yIElSUSBjb250ZXh0Cj4+ICAgICAgICAgICAq
ICovCj4+IC0gICAgICAgaWYgKHIgPCAxICYmIChhbWRncHVfaW5fcmVzZXQoYWRldikgfHwgaW5f
aW50ZXJydXB0KCkpKQo+PiArICAgICAgIGlmIChyIDwgMSAmJiAoYWRldi0+aW5fZ3B1X3Jlc2V0
IHx8IGluX2ludGVycnVwdCgpKSkKPj4gICAgICAgICAgICAgICAgICBnb3RvIGZhaWxlZF9raXFf
d3JpdGU7Cj4+Cj4+ICAgICAgICAgIG1pZ2h0X3NsZWVwKCk7Cj4+IEBAIC03OTYsNSArNzk2LDUg
QEAgdm9pZCBhbWRncHVfa2lxX3dyZWcoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHVpbnQz
Ml90IHJlZywgdWludDMyX3QgdikKPj4gICAgICAgICAgYW1kZ3B1X3JpbmdfdW5kbyhyaW5nKTsK
Pj4gICAgICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgma2lxLT5yaW5nX2xvY2ssIGZsYWdz
KTsKPj4gICBmYWlsZWRfa2lxX3dyaXRlOgo+PiAtICAgICAgIGRldl93YXJuKGFkZXYtPmRldiwg
ImZhaWxlZCB0byB3cml0ZSByZWc6JXhcbiIsIHJlZyk7Cj4+ICsgICAgICAgcHJfZXJyKCJmYWls
ZWQgdG8gd3JpdGUgcmVnOiV4XG4iLCByZWcpOwo+PiAgIH0KPj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9qb2IuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9qb2IuYwo+PiBpbmRleCA3NWQzN2RmYjUxYWEuLjkzNzAyOWFkNTI3MSAx
MDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5jCj4+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9qb2IuYwo+PiBAQCAtMjIw
LDE3ICsyMjAsMTcgQEAgc3RhdGljIHN0cnVjdCBkbWFfZmVuY2UgKmFtZGdwdV9qb2JfcnVuKHN0
cnVjdCBkcm1fc2NoZWRfam9iICpzY2hlZF9qb2IpCj4+Cj4+ICAgICAgICAgIHRyYWNlX2FtZGdw
dV9zY2hlZF9ydW5fam9iKGpvYik7Cj4+Cj4+IC0gICAgICAgaWYgKGRvd25fcmVhZF90cnlsb2Nr
KCZyaW5nLT5hZGV2LT5yZXNldF9zZW0pKSB7Cj4+ICsgICAgICAgaWYgKGpvYi0+dnJhbV9sb3N0
X2NvdW50ZXIgIT0gYXRvbWljX3JlYWQoJnJpbmctPmFkZXYtPnZyYW1fbG9zdF9jb3VudGVyKSkK
Pj4gKyAgICAgICAgICAgICAgIGRtYV9mZW5jZV9zZXRfZXJyb3IoZmluaXNoZWQsIC1FQ0FOQ0VM
RUQpOy8qIHNraXAgSUIgYXMgd2VsbCBpZiBWUkFNIGxvc3QgKi8KPj4gKwo+PiArICAgICAgIGlm
IChmaW5pc2hlZC0+ZXJyb3IgPCAwKSB7Cj4+ICsgICAgICAgICAgICAgICBEUk1fSU5GTygiU2tp
cCBzY2hlZHVsaW5nIElCcyFcbiIpOwo+PiArICAgICAgIH0gZWxzZSB7Cj4+ICAgICAgICAgICAg
ICAgICAgciA9IGFtZGdwdV9pYl9zY2hlZHVsZShyaW5nLCBqb2ItPm51bV9pYnMsIGpvYi0+aWJz
LCBqb2IsCj4+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmZmVuY2Up
Owo+PiAtICAgICAgICAgICAgICAgdXBfcmVhZCgmcmluZy0+YWRldi0+cmVzZXRfc2VtKTsKPj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmZlbmNlKTsKPj4gICAgICAg
ICAgICAgICAgICBpZiAocikKPj4gICAgICAgICAgICAgICAgICAgICAgICAgIERSTV9FUlJPUigi
RXJyb3Igc2NoZWR1bGluZyBJQnMgKCVkKVxuIiwgcik7Cj4+IC0gICAgICAgfSBlbHNlIHsKPj4g
LSAgICAgICAgICAgICAgIGRtYV9mZW5jZV9zZXRfZXJyb3IoZmluaXNoZWQsIC1FQ0FOQ0VMRUQp
Owo+PiAtICAgICAgICAgICAgICAgRFJNX0lORk8oIlNraXAgc2NoZWR1bGluZyBJQnMhXG4iKTsK
Pj4gICAgICAgICAgfQo+PiAtCj4+ICAgICAgICAgIC8qIGlmIGdwdSByZXNldCwgaHcgZmVuY2Ug
d2lsbCBiZSByZXBsYWNlZCBoZXJlICovCj4+ICAgICAgICAgIGRtYV9mZW5jZV9wdXQoam9iLT5m
ZW5jZSk7Cj4+ICAgICAgICAgIGpvYi0+ZmVuY2UgPSBkbWFfZmVuY2VfZ2V0KGZlbmNlKTsKPj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYwo+PiBpbmRleCBmOGRlOTQ5ZDI1
MTAuLmI0YTllMDQ3OGYyNSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2ttcy5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9rbXMuYwo+PiBAQCAtMTA4Nyw4ICsxMDg3LDYgQEAgdm9pZCBhbWRncHVfZHJpdmVyX3Bvc3Rj
bG9zZV9rbXMoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPj4gICAgICAgICAgaWYgKCFmcHJpdikK
Pj4gICAgICAgICAgICAgICAgICByZXR1cm47Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGV2LT5k
ZXYpOwo+Pgo+PiAgICAgICAgICBpZiAoYW1kZ3B1X2RldmljZV9pcF9nZXRfaXBfYmxvY2soYWRl
diwgQU1EX0lQX0JMT0NLX1RZUEVfVVZEKSAhPSBOVUxMKQo+PiBAQCAtMTEyNyw4ICsxMTI1LDYg
QEAgdm9pZCBhbWRncHVfZHJpdmVyX3Bvc3RjbG9zZV9rbXMoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwKPj4KPj4gICAgICAgICAgcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZXYtPmRldik7Cj4+
ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRldi0+ZGV2KTsKPj4gLQo+PiAt
ICAgICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICAgfQo+Pgo+PiAgIC8qCj4+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uYyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jCj4+IGluZGV4IDE3MDVlMzI4YzZmYy4u
NjVhZDE3NGJiOTc2IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfcG0uYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0u
Ywo+PiBAQCAtMTYzLDcgKzE2Myw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcG93ZXJf
ZHBtX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgZW51bSBhbWRfcG1fc3Rh
dGVfdHlwZSBwbTsKPj4gICAgICAgICAgaW50IHJldDsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1
X2luX3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAg
ICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgcmV0ID0gcG1fcnVu
dGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtMTcyLDggKzE3Miw2IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9nZXRfcG93ZXJfZHBtX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4g
ICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAg
ZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIGlmIChpc19zdXBw
b3J0X3N3X3NtdShhZGV2KSkgewo+PiAgICAgICAgICAgICAgICAgIGlmIChhZGV2LT5zbXUucHB0
X2Z1bmNzLT5nZXRfY3VycmVudF9wb3dlcl9zdGF0ZSkKPj4gICAgICAgICAgICAgICAgICAgICAg
ICAgIHBtID0gc211X2dldF9jdXJyZW50X3Bvd2VyX3N0YXRlKCZhZGV2LT5zbXUpOwo+PiBAQCAt
MTg1LDggKzE4Myw2IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcG93ZXJfZHBtX3N0YXRl
KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICBwbSA9IGFkZXYtPnBtLmRw
bS51c2VyX3N0YXRlOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+
cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRk
ZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRl
dik7Cj4+Cj4+IEBAIC0yMDUsNyArMjAxLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9w
b3dlcl9kcG1fc3RhdGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBlbnVtIGFtZF9w
bV9zdGF0ZV90eXBlICBzdGF0ZTsKPj4gICAgICAgICAgaW50IHJldDsKPj4KPj4gLSAgICAgICBp
ZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVz
ZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgaWYg
KHN0cm5jbXAoImJhdHRlcnkiLCBidWYsIHN0cmxlbigiYmF0dGVyeSIpKSA9PSAwKQo+PiBAQCAt
MjIzLDggKzIxOSw2IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBtX3N0YXRl
KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+PiAg
ICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAt
Cj4+ICAgICAgICAgIGlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+PiAgICAgICAgICAg
ICAgICAgIG11dGV4X2xvY2soJmFkZXYtPnBtLm11dGV4KTsKPj4gICAgICAgICAgICAgICAgICBh
ZGV2LT5wbS5kcG0udXNlcl9zdGF0ZSA9IHN0YXRlOwo+PiBAQCAtMjM4LDkgKzIzMiw2IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBtX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRl
diwKPj4KPj4gICAgICAgICAgICAgICAgICBhbWRncHVfcG1fY29tcHV0ZV9jbG9ja3MoYWRldik7
Cj4+ICAgICAgICAgIH0KPj4gLQo+PiAtICAgICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7
Cj4+IC0KPj4gICAgICAgICAgcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+
PiAgICAgICAgICBwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+Pgo+PiBA
QCAtMzE2LDcgKzMwNyw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcG93ZXJfZHBtX2Zv
cmNlX3BlcmZvcm1hbmNlX2xldmVsKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgZW51
bSBhbWRfZHBtX2ZvcmNlZF9sZXZlbCBsZXZlbCA9IDB4ZmY7Cj4+ICAgICAgICAgIGludCByZXQ7
Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAo
YWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+
Cj4+ICAgICAgICAgIHJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsKPj4gQEAg
LTMyNSw4ICszMTYsNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bvd2VyX2RwbV9mb3Jj
ZV9wZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAg
ICAgcmV0dXJuIHJldDsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRl
dikpCj4+ICAgICAgICAgICAgICAgICAgbGV2ZWwgPSBzbXVfZ2V0X3BlcmZvcm1hbmNlX2xldmVs
KCZhZGV2LT5zbXUpOwo+PiAgICAgICAgICBlbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVu
Y3MtPmdldF9wZXJmb3JtYW5jZV9sZXZlbCkKPj4gQEAgLTMzNCw4ICszMjMsNiBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfZ2V0X3Bvd2VyX2RwbV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbChzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIGVsc2UKPj4gICAgICAgICAgICAgICAgICBsZXZl
bCA9IGFkZXYtPnBtLmRwbS5mb3JjZWRfbGV2ZWw7Cj4+Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYt
PmRldik7Cj4+Cj4+IEBAIC0zNjIsNyArMzQ5LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3Nl
dF9wb3dlcl9kcG1fZm9yY2VfcGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2LAo+
PiAgICAgICAgICBlbnVtIGFtZF9kcG1fZm9yY2VkX2xldmVsIGN1cnJlbnRfbGV2ZWwgPSAweGZm
Owo+PiAgICAgICAgICBpbnQgcmV0ID0gMDsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jl
c2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAg
ICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgaWYgKHN0cm5jbXAoImxvdyIs
IGJ1Ziwgc3RybGVuKCJsb3ciKSkgPT0gMCkgewo+PiBAQCAtMzkzLDggKzM4MCw2IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBtX2ZvcmNlX3BlcmZvcm1hbmNlX2xldmVsKHN0
cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+PiAgICAg
ICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+
ICAgICAgICAgIGlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPj4gICAgICAgICAgICAgICAg
ICBjdXJyZW50X2xldmVsID0gc211X2dldF9wZXJmb3JtYW5jZV9sZXZlbCgmYWRldi0+c211KTsK
Pj4gICAgICAgICAgZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfcGVyZm9y
bWFuY2VfbGV2ZWwpCj4+IEBAIC00MDMsOCArMzg4LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X3NldF9wb3dlcl9kcG1fZm9yY2VfcGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2
LAo+PiAgICAgICAgICBpZiAoY3VycmVudF9sZXZlbCA9PSBsZXZlbCkgewo+PiAgICAgICAgICAg
ICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAg
ICAgICAgICBwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+PiAtICAgICAg
ICAgICAgICAgcmV0ID0gY291bnQ7Cj4+IC0gICAgICAgICAgICAgICBnb3RvIHByb19lbmQ7Cj4+
ICsgICAgICAgICAgICAgICByZXR1cm4gY291bnQ7Cj4+ICAgICAgICAgIH0KPj4KPj4gICAgICAg
ICAgaWYgKGFkZXYtPmFzaWNfdHlwZSA9PSBDSElQX1JBVkVOKSB7Cj4+IEBAIC00MjUsOCArNDA5
LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wb3dlcl9kcG1fZm9yY2VfcGVyZm9ybWFu
Y2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAgIHByX2Vycigi
Q3VycmVudGx5IG5vdCBpbiBhbnkgcHJvZmlsZSBtb2RlIVxuIik7Cj4+ICAgICAgICAgICAgICAg
ICAgcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAgICAgICAgICAg
ICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+IC0gICAgICAgICAg
ICAgICByZXQgPSAtRUlOVkFMOwo+PiAtICAgICAgICAgICAgICAgZ290byBwcm9fZW5kOwo+PiAr
ICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4+ICAgICAgICAgIH0KPj4KPj4gICAgICAg
ICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7Cj4+IEBAIC00MzQsOCArNDE3LDcgQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wb3dlcl9kcG1fZm9yY2VfcGVyZm9ybWFuY2VfbGV2
ZWwoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAgIGlmIChyZXQpIHsKPj4g
ICAgICAgICAgICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+
ZGV2KTsKPj4gICAgICAgICAgICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNw
ZW5kKGRkZXYtPmRldik7Cj4+IC0gICAgICAgICAgICAgICAgICAgICAgIHJldCA9IC1FSU5WQUw7
Cj4+IC0gICAgICAgICAgICAgICAgICAgICAgIGdvdG8gcHJvX2VuZDsKPj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4+ICAgICAgICAgICAgICAgICAgfQo+PiAgICAg
ICAgICB9IGVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Zm9yY2VfcGVyZm9ybWFu
Y2VfbGV2ZWwpIHsKPj4gICAgICAgICAgICAgICAgICBtdXRleF9sb2NrKCZhZGV2LT5wbS5tdXRl
eCk7Cj4+IEBAIC00NDMsMTYgKzQyNSwxNCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3Bv
d2VyX2RwbV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAg
ICAgICAgICAgICAgICAgICAgICAgICBtdXRleF91bmxvY2soJmFkZXYtPnBtLm11dGV4KTsKPj4g
ICAgICAgICAgICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+
ZGV2KTsKPj4gICAgICAgICAgICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNw
ZW5kKGRkZXYtPmRldik7Cj4+IC0gICAgICAgICAgICAgICAgICAgICAgIHJldCA9IC1FSU5WQUw7
Cj4+IC0gICAgICAgICAgICAgICAgICAgICAgIGdvdG8gcHJvX2VuZDsKPj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4+ICAgICAgICAgICAgICAgICAgfQo+PiAgICAg
ICAgICAgICAgICAgIHJldCA9IGFtZGdwdV9kcG1fZm9yY2VfcGVyZm9ybWFuY2VfbGV2ZWwoYWRl
diwgbGV2ZWwpOwo+PiAgICAgICAgICAgICAgICAgIGlmIChyZXQpIHsKPj4gICAgICAgICAgICAg
ICAgICAgICAgICAgIG11dGV4X3VubG9jaygmYWRldi0+cG0ubXV0ZXgpOwo+PiAgICAgICAgICAg
ICAgICAgICAgICAgICAgcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAg
ICAgICAgICAgICAgICAgICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+
ZGV2KTsKPj4gLSAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsKPj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgZ290byBwcm9fZW5kOwo+PiArICAgICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gLUVJTlZBTDsKPj4gICAgICAgICAgICAgICAgICB9IGVsc2Ugewo+PiAgICAgICAg
ICAgICAgICAgICAgICAgICAgYWRldi0+cG0uZHBtLmZvcmNlZF9sZXZlbCA9IGxldmVsOwo+PiAg
ICAgICAgICAgICAgICAgIH0KPj4gQEAgLTQ2MSw5ICs0NDEsNyBAQCBzdGF0aWMgc3NpemVfdCBh
bWRncHVfc2V0X3Bvd2VyX2RwbV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsK
Pj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4KPj4g
LXByb19lbmQ6Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLSAgICAg
ICByZXR1cm4gcmV0Owo+PiArICAgICAgIHJldHVybiBjb3VudDsKPj4gICB9Cj4+Cj4+ICAgc3Rh
dGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9udW1fc3RhdGVzKHN0cnVjdCBkZXZpY2UgKmRldiwK
Pj4gQEAgLTQ3NSw3ICs0NTMsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX251bV9z
dGF0ZXMoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBzdHJ1Y3QgcHBfc3RhdGVzX2lu
Zm8gZGF0YTsKPj4gICAgICAgICAgaW50IGksIGJ1Zl9sZW4sIHJldDsKPj4KPj4gLSAgICAgICBp
ZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVz
ZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgcmV0
ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtNTE5LDcgKzQ5Nyw3IEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfY3VyX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRl
diwKPj4gICAgICAgICAgZW51bSBhbWRfcG1fc3RhdGVfdHlwZSBwbSA9IDA7Cj4+ICAgICAgICAg
IGludCBpID0gMCwgcmV0ID0gMDsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFk
ZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAg
ICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgcmV0ID0gcG1fcnVudGltZV9nZXRfc3lu
YyhkZGV2LT5kZXYpOwo+PiBAQCAtNTYwLDcgKzUzOCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9nZXRfcHBfZm9yY2Vfc3RhdGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBzdHJ1
Y3QgZHJtX2RldmljZSAqZGRldiA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+PiAgICAgICAgICBz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGRkZXYtPmRldl9wcml2YXRlOwo+Pgo+PiAtICAg
ICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAgaWYgKGFkZXYtPmluX2dw
dV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gLUVQRVJNOwo+Pgo+PiAgICAgICAg
ICBpZiAoYWRldi0+cHBfZm9yY2Vfc3RhdGVfZW5hYmxlZCkKPj4gQEAgLTU4MCw3ICs1NTgsNyBA
QCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2ZvcmNlX3N0YXRlKHN0cnVjdCBkZXZpY2Ug
KmRldiwKPj4gICAgICAgICAgdW5zaWduZWQgbG9uZyBpZHg7Cj4+ICAgICAgICAgIGludCByZXQ7
Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAo
YWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+
Cj4+ICAgICAgICAgIGlmIChzdHJsZW4oYnVmKSA9PSAxKQo+PiBAQCAtNjA2LDcgKzU4NCw2IEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZm9yY2Vfc3RhdGUoc3RydWN0IGRldmljZSAq
ZGV2LAo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPj4gICAgICAgICAg
ICAgICAgICB9Cj4+Cj4+IC0gICAgICAgICAgICAgICBkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3Nl
bSk7Cj4+ICAgICAgICAgICAgICAgICAgLyogb25seSBzZXQgdXNlciBzZWxlY3RlZCBwb3dlciBz
dGF0ZXMgKi8KPj4gICAgICAgICAgICAgICAgICBpZiAoc3RhdGUgIT0gUE9XRVJfU1RBVEVfVFlQ
RV9JTlRFUk5BTF9CT09UICYmCj4+ICAgICAgICAgICAgICAgICAgICAgIHN0YXRlICE9IFBPV0VS
X1NUQVRFX1RZUEVfREVGQVVMVCkgewo+PiBAQCAtNjE0LDggKzU5MSw2IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9zZXRfcHBfZm9yY2Vfc3RhdGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFNRF9QUF9UQVNLX0VOQUJMRV9V
U0VSX1NUQVRFLCAmc3RhdGUpOwo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgYWRldi0+cHBf
Zm9yY2Vfc3RhdGVfZW5hYmxlZCA9IHRydWU7Cj4+ICAgICAgICAgICAgICAgICAgfQo+PiAtICAg
ICAgICAgICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICAg
ICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAg
ICAgICAgICBwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+PiAgICAgICAg
ICB9Cj4+IEBAIC02NDMsNyArNjE4LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF90
YWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIGNoYXIgKnRhYmxlID0gTlVMTDsK
Pj4gICAgICAgICAgaW50IHNpemUsIHJldDsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jl
c2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAg
ICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgcmV0ID0gcG1fcnVudGltZV9n
ZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtNjg3LDcgKzY2Miw3IEBAIHN0YXRpYyBzc2l6ZV90
IGFtZGdwdV9zZXRfcHBfdGFibGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGRkZXYtPmRldl9wcml2YXRlOwo+PiAgICAgICAgICBp
bnQgcmV0ID0gMDsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiAr
ICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJu
IC1FUEVSTTsKPj4KPj4gICAgICAgICAgcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5k
ZXYpOwo+PiBAQCAtNjk2LDIxICs2NzEsMTYgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9w
cF90YWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIHJl
dDsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2Vt
KTsKPj4gLQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsKPj4gICAg
ICAgICAgICAgICAgICByZXQgPSBzbXVfc3lzX3NldF9wcF90YWJsZSgmYWRldi0+c211LCAodm9p
ZCAqKWJ1ZiwgY291bnQpOwo+PiAgICAgICAgICAgICAgICAgIGlmIChyZXQpIHsKPj4gICAgICAg
ICAgICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsK
Pj4gICAgICAgICAgICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRk
ZXYtPmRldik7Cj4+IC0gICAgICAgICAgICAgICAgICAgICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0
X3NlbSk7Cj4+ICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+PiAgICAgICAg
ICAgICAgICAgIH0KPj4gICAgICAgICAgfSBlbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVu
Y3MtPnNldF9wcF90YWJsZSkKPj4gICAgICAgICAgICAgICAgICBhbWRncHVfZHBtX3NldF9wcF90
YWJsZShhZGV2LCBidWYsIGNvdW50KTsKPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+
ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsK
Pj4KPj4gQEAgLTg0NSw3ICs4MTUsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX29k
X2Nsa192b2x0YWdlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgY29uc3QgY2hhciBk
ZWxpbWl0ZXJbM10gPSB7JyAnLCAnXG4nLCAnXDAnfTsKPj4gICAgICAgICAgdWludDMyX3QgdHlw
ZTsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsK
Pj4KPj4gICAgICAgICAgaWYgKGNvdW50ID4gMTI3KQo+PiBAQCAtODg5LDEwICs4NTksNiBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX29kX2Nsa192b2x0YWdlKHN0cnVjdCBkZXZpY2Ug
KmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+PiAgICAgICAgICB9Cj4+Cj4+
IC0gICAgICAgcmV0ID0gY291bnQ7Cj4+IC0KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYtPnJl
c2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7
Cj4+ICAgICAgICAgICAgICAgICAgcmV0ID0gc211X29kX2VkaXRfZHBtX3RhYmxlKCZhZGV2LT5z
bXUsIHR5cGUsCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHBhcmFtZXRlciwgcGFyYW1ldGVyX3NpemUpOwo+PiBAQCAtOTAwLDggKzg2Niw3IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfb2RfY2xrX3ZvbHRhZ2Uoc3RydWN0IGRldmljZSAqZGV2
LAo+PiAgICAgICAgICAgICAgICAgIGlmIChyZXQpIHsKPj4gICAgICAgICAgICAgICAgICAgICAg
ICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgICAg
ICAgICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+IC0g
ICAgICAgICAgICAgICAgICAgICAgIHJldCA9IC1FSU5WQUw7Cj4+IC0gICAgICAgICAgICAgICAg
ICAgICAgIGdvdG8gcHJvX2VuZDsKPj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1F
SU5WQUw7Cj4+ICAgICAgICAgICAgICAgICAgfQo+PiAgICAgICAgICB9IGVsc2Ugewo+PiAgICAg
ICAgICAgICAgICAgIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPm9kbl9lZGl0X2RwbV90
YWJsZSkgewo+PiBAQCAtOTEwLDggKzg3NSw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRf
cHBfb2RfY2xrX3ZvbHRhZ2Uoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKHJldCkgewo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBw
bV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsKPj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIHByb19lbmQ7Cj4+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4+ICAgICAgICAgICAgICAgICAgICAg
ICAgICB9Cj4+ICAgICAgICAgICAgICAgICAgfQo+Pgo+PiBAQCAtOTIyLDIyICs4ODYsMTggQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9vZF9jbGtfdm9sdGFnZShzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBOVUxMKTsKPj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG1fcnVudGltZV9t
YXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+PiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldCA9IGNvdW50Owo+PiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gcHJvX2VuZDsKPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICByZXR1cm4gY291bnQ7Cj4+ICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugewo+
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbV9ydW50aW1lX21hcmtfbGFzdF9i
dXN5KGRkZXYtPmRldik7Cj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBtX3J1
bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsKPj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBnb3RvIHByb19lbmQ7Cj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIC1FSU5WQUw7Cj4+ICAgICAgICAgICAgICAgICAgICAgICAgICB9Cj4+ICAgICAgICAgICAg
ICAgICAgfQo+PiAgICAgICAgICB9Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1
c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRl
di0+ZGV2KTsKPj4KPj4gLXByb19lbmQ6Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPj4gLSAgICAgICByZXR1cm4gcmV0Owo+PiArICAgICAgIHJldHVybiBjb3VudDsKPj4g
ICB9Cj4+Cj4+ICAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9vZF9jbGtfdm9sdGFnZShz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4+IEBAIC05NDksNyArOTA5LDcgQEAgc3RhdGljIHNzaXplX3Qg
YW1kZ3B1X2dldF9wcF9vZF9jbGtfdm9sdGFnZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAg
ICAgIHNzaXplX3Qgc2l6ZTsKPj4gICAgICAgICAgaW50IHJldDsKPj4KPj4gLSAgICAgICBpZiAo
YW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQp
Cj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgcmV0ID0g
cG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtMTAwMyw3ICs5NjMsNyBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2ZlYXR1cmVzKHN0cnVjdCBkZXZpY2UgKmRldiwK
Pj4gICAgICAgICAgdWludDY0X3QgZmVhdHVyZW1hc2s7Cj4+ICAgICAgICAgIGludCByZXQ7Cj4+
Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRl
di0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+
ICAgICAgICAgIHJldCA9IGtzdHJ0b3U2NChidWYsIDAsICZmZWF0dXJlbWFzayk7Cj4+IEBAIC0x
MDE4LDEzICs5NzgsMTEgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9mZWF0dXJlcyhz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPj4gICAg
ICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAg
ICAgICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7Cj4+ICAgICAgICAgICAgICAgICAg
cmV0ID0gc211X3N5c19zZXRfcHBfZmVhdHVyZV9tYXNrKCZhZGV2LT5zbXUsIGZlYXR1cmVtYXNr
KTsKPj4gICAgICAgICAgICAgICAgICBpZiAocmV0KSB7Cj4+ICAgICAgICAgICAgICAgICAgICAg
ICAgICBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4+ICAgICAgICAgICAg
ICAgICAgICAgICAgICBwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+PiAt
ICAgICAgICAgICAgICAgICAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAg
ICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4+ICAgICAgICAgICAgICAgICAg
fQo+PiAgICAgICAgICB9IGVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+c2V0X3Bw
ZmVhdHVyZV9zdGF0dXMpIHsKPj4gQEAgLTEwMzIsMTIgKzk5MCw5IEBAIHN0YXRpYyBzc2l6ZV90
IGFtZGdwdV9zZXRfcHBfZmVhdHVyZXMoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAg
ICAgICAgIGlmIChyZXQpIHsKPj4gICAgICAgICAgICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVf
bWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgICAgICAgICAgICAgICAgIHBt
X3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+IC0gICAgICAgICAgICAgICAg
ICAgICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICAgICAgICAgICAgICAgICAgICAg
ICAgICByZXR1cm4gLUVJTlZBTDsKPj4gICAgICAgICAgICAgICAgICB9Cj4+ICAgICAgICAgIH0K
Pj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBt
X3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGlt
ZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4KPj4gQEAgLTEwNTMsNyArMTAwOCw3IEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZmVhdHVyZXMoc3RydWN0IGRldmljZSAqZGV2
LAo+PiAgICAgICAgICBzc2l6ZV90IHNpemU7Cj4+ICAgICAgICAgIGludCByZXQ7Cj4+Cj4+IC0g
ICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5f
Z3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAg
ICAgIHJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsKPj4gQEAgLTEwNjIsOCAr
MTAxNyw2IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZmVhdHVyZXMoc3RydWN0IGRl
dmljZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4+ICAgICAgICAgIH0K
Pj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAg
ICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+PiAgICAgICAgICAgICAgICAgIHNpemUg
PSBzbXVfc3lzX2dldF9wcF9mZWF0dXJlX21hc2soJmFkZXYtPnNtdSwgYnVmKTsKPj4gICAgICAg
ICAgZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfcHBmZWF0dXJlX3N0YXR1
cykKPj4gQEAgLTEwNzEsOCArMTAyNCw2IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBf
ZmVhdHVyZXMoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBlbHNlCj4+ICAgICAgICAg
ICAgICAgICAgc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiXG4iKTsKPj4KPj4gLSAg
ICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRp
bWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRf
YXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4KPj4gQEAgLTExMTgsNyArMTA2OSw3IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX3NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAg
ICAgICAgICBzc2l6ZV90IHNpemU7Cj4+ICAgICAgICAgIGludCByZXQ7Cj4+Cj4+IC0gICAgICAg
aWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jl
c2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIHJl
dCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsKPj4gQEAgLTExMjcsOCArMTA3OCw2
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX3NjbGsoc3RydWN0IGRldmljZSAq
ZGV2LAo+PiAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4+ICAgICAgICAgIH0KPj4KPj4g
LSAgICAgICBkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgaWYg
KGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+PiAgICAgICAgICAgICAgICAgIHNpemUgPSBzbXVf
cHJpbnRfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfU0NMSywgYnVmKTsKPj4gICAgICAgICAg
ZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5wcmludF9jbG9ja19sZXZlbHMpCj4+
IEBAIC0xMTM2LDggKzEwODUsNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9z
Y2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgZWxzZQo+PiAgICAgICAgICAgICAg
ICAgIHNpemUgPSBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIlxuIik7Cj4+Cj4+IC0gICAgICAg
dXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBwbV9ydW50aW1lX21h
cmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9z
dXNwZW5kKGRkZXYtPmRldik7Cj4+Cj4+IEBAIC0xMTkwLDcgKzExMzcsNyBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfc2V0X3BwX2RwbV9zY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAg
ICAgaW50IHJldDsKPj4gICAgICAgICAgdWludDMyX3QgbWFzayA9IDA7Cj4+Cj4+IC0gICAgICAg
aWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jl
c2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIHJl
dCA9IGFtZGdwdV9yZWFkX21hc2soYnVmLCBjb3VudCwgJm1hc2spOwo+PiBAQCAtMTIwMywxNSAr
MTE1MCwxMSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9zY2xrKHN0cnVjdCBk
ZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+PiAgICAgICAgICB9
Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAg
ICAgIGlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPj4gICAgICAgICAgICAgICAgICByZXQg
PSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfU0NMSywgbWFzayk7Cj4+ICAg
ICAgICAgIGVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2
ZWwpCj4+ICAgICAgICAgICAgICAgICAgcmV0ID0gYW1kZ3B1X2RwbV9mb3JjZV9jbG9ja19sZXZl
bChhZGV2LCBQUF9TQ0xLLCBtYXNrKTsKPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+
ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsK
Pj4KPj4gQEAgLTEyMzAsNyArMTE3Myw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBf
ZHBtX21jbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBzc2l6ZV90IHNpemU7Cj4+
ICAgICAgICAgIGludCByZXQ7Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2
KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAg
IHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIHJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMo
ZGRldi0+ZGV2KTsKPj4gQEAgLTEyMzksOCArMTE4Miw2IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9nZXRfcHBfZHBtX21jbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAg
IHJldHVybiByZXQ7Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYt
PnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYp
KQo+PiAgICAgICAgICAgICAgICAgIHNpemUgPSBzbXVfcHJpbnRfY2xrX2xldmVscygmYWRldi0+
c211LCBTTVVfTUNMSywgYnVmKTsKPj4gICAgICAgICAgZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5
LnBwX2Z1bmNzLT5wcmludF9jbG9ja19sZXZlbHMpCj4+IEBAIC0xMjQ4LDggKzExODksNiBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9tY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwK
Pj4gICAgICAgICAgZWxzZQo+PiAgICAgICAgICAgICAgICAgIHNpemUgPSBzbnByaW50ZihidWYs
IFBBR0VfU0laRSwgIlxuIik7Cj4+Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2Vt
KTsKPj4gLQo+PiAgICAgICAgICBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7
Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+Cj4+
IEBAIC0xMjY2LDcgKzEyMDUsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9t
Y2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgdWludDMyX3QgbWFzayA9IDA7Cj4+
ICAgICAgICAgIGludCByZXQ7Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2
KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAg
IHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIHJldCA9IGFtZGdwdV9yZWFkX21hc2soYnVm
LCBjb3VudCwgJm1hc2spOwo+PiBAQCAtMTI3OSwxNSArMTIxOCwxMSBAQCBzdGF0aWMgc3NpemVf
dCBhbWRncHVfc2V0X3BwX2RwbV9tY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAg
ICAgICAgICByZXR1cm4gcmV0Owo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFk
KCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIGlmIChpc19zdXBwb3J0X3N3X3Nt
dShhZGV2KSkKPj4gICAgICAgICAgICAgICAgICByZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygm
YWRldi0+c211LCBTTVVfTUNMSywgbWFzayk7Cj4+ICAgICAgICAgIGVsc2UgaWYgKGFkZXYtPnBv
d2VycGxheS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpCj4+ICAgICAgICAgICAgICAgICAg
cmV0ID0gYW1kZ3B1X2RwbV9mb3JjZV9jbG9ja19sZXZlbChhZGV2LCBQUF9NQ0xLLCBtYXNrKTsK
Pj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAg
IHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVu
dGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4KPj4gQEAgLTEzMDYsNyArMTI0MSw3
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX3NvY2NsayhzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4+ICAgICAgICAgIHNzaXplX3Qgc2l6ZTsKPj4gICAgICAgICAgaW50IHJldDsKPj4K
Pj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2
LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4g
ICAgICAgICAgcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtMTMx
NSw4ICsxMjUwLDYgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fc29jY2xrKHN0
cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+PiAgICAg
ICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+
ICAgICAgICAgIGlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPj4gICAgICAgICAgICAgICAg
ICBzaXplID0gc211X3ByaW50X2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX1NPQ0NMSywgYnVm
KTsKPj4gICAgICAgICAgZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5wcmludF9j
bG9ja19sZXZlbHMpCj4+IEBAIC0xMzI0LDggKzEyNTcsNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfZ2V0X3BwX2RwbV9zb2NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBlbHNl
Cj4+ICAgICAgICAgICAgICAgICAgc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiXG4i
KTsKPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAg
ICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1f
cnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4KPj4gQEAgLTEzNDIsNyArMTI3
Myw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3NvY2NsayhzdHJ1Y3QgZGV2
aWNlICpkZXYsCj4+ICAgICAgICAgIGludCByZXQ7Cj4+ICAgICAgICAgIHVpbnQzMl90IG1hc2sg
PSAwOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAg
aWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gLUVQRVJN
Owo+Pgo+PiAgICAgICAgICByZXQgPSBhbWRncHVfcmVhZF9tYXNrKGJ1ZiwgY291bnQsICZtYXNr
KTsKPj4gQEAgLTEzNTUsOCArMTI4Niw2IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBf
ZHBtX3NvY2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJu
IHJldDsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAg
ICAgICAgICAgICAgICAgcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01V
X1NPQ0NMSywgbWFzayk7Cj4+ICAgICAgICAgIGVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9m
dW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpCj4+IEBAIC0xMzY0LDggKzEyOTMsNiBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9zb2NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAg
ICAgICAgICBlbHNlCj4+ICAgICAgICAgICAgICAgICAgcmV0ID0gMDsKPj4KPj4gLSAgICAgICB1
cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFy
a19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1
c3BlbmQoZGRldi0+ZGV2KTsKPj4KPj4gQEAgLTEzODQsNyArMTMxMSw3IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9nZXRfcHBfZHBtX2ZjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAg
ICBzc2l6ZV90IHNpemU7Cj4+ICAgICAgICAgIGludCByZXQ7Cj4+Cj4+IC0gICAgICAgaWYgKGFt
ZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+
PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIHJldCA9IHBt
X3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsKPj4gQEAgLTEzOTMsOCArMTMyMCw2IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX2ZjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+
PiAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAg
ICBkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgaWYgKGlzX3N1
cHBvcnRfc3dfc211KGFkZXYpKQo+PiAgICAgICAgICAgICAgICAgIHNpemUgPSBzbXVfcHJpbnRf
Y2xrX2xldmVscygmYWRldi0+c211LCBTTVVfRkNMSywgYnVmKTsKPj4gICAgICAgICAgZWxzZSBp
ZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5wcmludF9jbG9ja19sZXZlbHMpCj4+IEBAIC0x
NDAyLDggKzEzMjcsNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9mY2xrKHN0
cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgZWxzZQo+PiAgICAgICAgICAgICAgICAgIHNp
emUgPSBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIlxuIik7Cj4+Cj4+IC0gICAgICAgdXBfcmVh
ZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBwbV9ydW50aW1lX21hcmtfbGFz
dF9idXN5KGRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5k
KGRkZXYtPmRldik7Cj4+Cj4+IEBAIC0xNDIwLDcgKzEzNDMsNyBAQCBzdGF0aWMgc3NpemVfdCBh
bWRncHVfc2V0X3BwX2RwbV9mY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgaW50
IHJldDsKPj4gICAgICAgICAgdWludDMyX3QgbWFzayA9IDA7Cj4+Cj4+IC0gICAgICAgaWYgKGFt
ZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+
PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIHJldCA9IGFt
ZGdwdV9yZWFkX21hc2soYnVmLCBjb3VudCwgJm1hc2spOwo+PiBAQCAtMTQzMyw4ICsxMzU2LDYg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fZmNsayhzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPj4gICAgICAgICAgfQo+Pgo+PiAt
ICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAo
aXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAgICAgICAgICAgICAgICAgcmV0ID0gc211X2Zv
cmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX0ZDTEssIG1hc2spOwo+PiAgICAgICAgICBl
bHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNlX2Nsb2NrX2xldmVsKQo+PiBA
QCAtMTQ0Miw4ICsxMzYzLDYgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fZmNs
ayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIGVsc2UKPj4gICAgICAgICAgICAgICAg
ICByZXQgPSAwOwo+Pgo+PiAtICAgICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0K
Pj4gICAgICAgICAgcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAg
ICAgICBwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+Pgo+PiBAQCAtMTQ2
Miw3ICsxMzgxLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fZGNlZmNsayhz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIHNzaXplX3Qgc2l6ZTsKPj4gICAgICAgICAg
aW50IHJldDsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiArICAg
ICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1F
UEVSTTsKPj4KPj4gICAgICAgICAgcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYp
Owo+PiBAQCAtMTQ3MSw4ICsxMzkwLDYgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9k
cG1fZGNlZmNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJu
IHJldDsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAg
ICAgICAgICAgICAgICAgc2l6ZSA9IHNtdV9wcmludF9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNN
VV9EQ0VGQ0xLLCBidWYpOwo+PiAgICAgICAgICBlbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBf
ZnVuY3MtPnByaW50X2Nsb2NrX2xldmVscykKPj4gQEAgLTE0ODAsOCArMTM5Nyw2IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX2RjZWZjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+
PiAgICAgICAgICBlbHNlCj4+ICAgICAgICAgICAgICAgICAgc2l6ZSA9IHNucHJpbnRmKGJ1Ziwg
UEFHRV9TSVpFLCAiXG4iKTsKPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Owo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsK
Pj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4KPj4g
QEAgLTE0OTgsNyArMTQxMyw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX2Rj
ZWZjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBpbnQgcmV0Owo+PiAgICAgICAg
ICB1aW50MzJfdCBtYXNrID0gMDsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFk
ZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAg
ICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgcmV0ID0gYW1kZ3B1X3JlYWRfbWFzayhi
dWYsIGNvdW50LCAmbWFzayk7Cj4+IEBAIC0xNTExLDggKzE0MjYsNiBAQCBzdGF0aWMgc3NpemVf
dCBhbWRncHVfc2V0X3BwX2RwbV9kY2VmY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAg
ICAgICAgICAgICByZXR1cm4gcmV0Owo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9y
ZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIGlmIChpc19zdXBwb3J0X3N3
X3NtdShhZGV2KSkKPj4gICAgICAgICAgICAgICAgICByZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVs
cygmYWRldi0+c211LCBTTVVfRENFRkNMSywgbWFzayk7Cj4+ICAgICAgICAgIGVsc2UgaWYgKGFk
ZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpCj4+IEBAIC0xNTIwLDgg
KzE0MzMsNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9kY2VmY2xrKHN0cnVj
dCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgZWxzZQo+PiAgICAgICAgICAgICAgICAgIHJldCA9
IDA7Cj4+Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAg
ICAgICBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBt
X3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+Cj4+IEBAIC0xNTQwLDcgKzE0
NTEsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9wY2llKHN0cnVjdCBkZXZp
Y2UgKmRldiwKPj4gICAgICAgICAgc3NpemVfdCBzaXplOwo+PiAgICAgICAgICBpbnQgcmV0Owo+
Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAgaWYgKGFk
ZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gLUVQRVJNOwo+Pgo+
PiAgICAgICAgICByZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4+IEBAIC0x
NTQ5LDggKzE0NjAsNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9wY2llKHN0
cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+PiAgICAg
ICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+
ICAgICAgICAgIGlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPj4gICAgICAgICAgICAgICAg
ICBzaXplID0gc211X3ByaW50X2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX1BDSUUsIGJ1Zik7
Cj4+ICAgICAgICAgIGVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+cHJpbnRfY2xv
Y2tfbGV2ZWxzKQo+PiBAQCAtMTU1OCw4ICsxNDY3LDYgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2dldF9wcF9kcG1fcGNpZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIGVsc2UKPj4g
ICAgICAgICAgICAgICAgICBzaXplID0gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICJcbiIpOwo+
Pgo+PiAtICAgICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAg
cG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAgICAgICBwbV9ydW50
aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+Pgo+PiBAQCAtMTU3Niw3ICsxNDgzLDcg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fcGNpZShzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4+ICAgICAgICAgIGludCByZXQ7Cj4+ICAgICAgICAgIHVpbnQzMl90IG1hc2sgPSAwOwo+
Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAgaWYgKGFk
ZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gLUVQRVJNOwo+Pgo+
PiAgICAgICAgICByZXQgPSBhbWRncHVfcmVhZF9tYXNrKGJ1ZiwgY291bnQsICZtYXNrKTsKPj4g
QEAgLTE1ODksOCArMTQ5Niw2IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3Bj
aWUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4+
ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+
IC0KPj4gICAgICAgICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+PiAgICAgICAgICAg
ICAgICAgIHJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9QQ0lFLCBt
YXNrKTsKPj4gICAgICAgICAgZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5mb3Jj
ZV9jbG9ja19sZXZlbCkKPj4gQEAgLTE1OTgsOCArMTUwMyw2IEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9zZXRfcHBfZHBtX3BjaWUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBlbHNl
Cj4+ICAgICAgICAgICAgICAgICAgcmV0ID0gMDsKPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3ko
ZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+
ZGV2KTsKPj4KPj4gQEAgLTE2MTgsNyArMTUyMSw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9n
ZXRfcHBfc2Nsa19vZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIHVpbnQzMl90IHZh
bHVlID0gMDsKPj4gICAgICAgICAgaW50IHJldDsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2lu
X3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAg
ICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgcmV0ID0gcG1fcnVudGlt
ZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtMTYyNywxNSArMTUzMCwxMSBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfZ2V0X3BwX3NjbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAg
ICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICBkb3du
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgaWYgKGlzX3N1cHBvcnRf
c3dfc211KGFkZXYpKQo+PiAgICAgICAgICAgICAgICAgIHZhbHVlID0gc211X2dldF9vZF9wZXJj
ZW50YWdlKCYoYWRldi0+c211KSwgU01VX09EX1NDTEspOwo+PiAgICAgICAgICBlbHNlIGlmIChh
ZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9zY2xrX29kKQo+PiAgICAgICAgICAgICAgICAg
IHZhbHVlID0gYW1kZ3B1X2RwbV9nZXRfc2Nsa19vZChhZGV2KTsKPj4KPj4gLSAgICAgICB1cF9y
ZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19s
YXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3Bl
bmQoZGRldi0+ZGV2KTsKPj4KPj4gQEAgLTE2NTIsNyArMTU1MSw3IEBAIHN0YXRpYyBzc2l6ZV90
IGFtZGdwdV9zZXRfcHBfc2Nsa19vZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIGlu
dCByZXQ7Cj4+ICAgICAgICAgIGxvbmcgaW50IHZhbHVlOwo+Pgo+PiAtICAgICAgIGlmIChhbWRn
cHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4g
ICAgICAgICAgICAgICAgICByZXR1cm4gLUVQRVJNOwo+Pgo+PiAgICAgICAgICByZXQgPSBrc3Ry
dG9sKGJ1ZiwgMCwgJnZhbHVlKTsKPj4gQEAgLTE2NjYsOCArMTU2NSw2IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9zZXRfcHBfc2Nsa19vZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAg
ICAgICAgICAgcmV0dXJuIHJldDsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVh
ZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19z
bXUoYWRldikpIHsKPj4gICAgICAgICAgICAgICAgICB2YWx1ZSA9IHNtdV9zZXRfb2RfcGVyY2Vu
dGFnZSgmKGFkZXYtPnNtdSksIFNNVV9PRF9TQ0xLLCAodWludDMyX3QpdmFsdWUpOwo+PiAgICAg
ICAgICB9IGVsc2Ugewo+PiBAQCAtMTY4Miw4ICsxNTc5LDYgQEAgc3RhdGljIHNzaXplX3QgYW1k
Z3B1X3NldF9wcF9zY2xrX29kKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAg
ICB9Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Owo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsK
Pj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4KPj4g
QEAgLTE2OTksNyArMTU5NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfbWNsa19v
ZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIHVpbnQzMl90IHZhbHVlID0gMDsKPj4g
ICAgICAgICAgaW50IHJldDsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYp
KQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAg
cmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhk
ZGV2LT5kZXYpOwo+PiBAQCAtMTcwOCwxNSArMTYwMywxMSBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfZ2V0X3BwX21jbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAg
IHJldHVybiByZXQ7Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYt
PnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYp
KQo+PiAgICAgICAgICAgICAgICAgIHZhbHVlID0gc211X2dldF9vZF9wZXJjZW50YWdlKCYoYWRl
di0+c211KSwgU01VX09EX01DTEspOwo+PiAgICAgICAgICBlbHNlIGlmIChhZGV2LT5wb3dlcnBs
YXkucHBfZnVuY3MtPmdldF9tY2xrX29kKQo+PiAgICAgICAgICAgICAgICAgIHZhbHVlID0gYW1k
Z3B1X2RwbV9nZXRfbWNsa19vZChhZGV2KTsKPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5y
ZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRl
di0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2
KTsKPj4KPj4gQEAgLTE3MzMsNyArMTYyNCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRf
cHBfbWNsa19vZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIGludCByZXQ7Cj4+ICAg
ICAgICAgIGxvbmcgaW50IHZhbHVlOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQo
YWRldikpCj4+ICsgICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAg
ICAgICByZXR1cm4gLUVQRVJNOwo+Pgo+PiAgICAgICAgICByZXQgPSBrc3RydG9sKGJ1ZiwgMCwg
JnZhbHVlKTsKPj4gQEAgLTE3NDcsOCArMTYzOCw2IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9z
ZXRfcHBfbWNsa19vZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0
dXJuIHJldDsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsK
Pj4gICAgICAgICAgICAgICAgICB2YWx1ZSA9IHNtdV9zZXRfb2RfcGVyY2VudGFnZSgmKGFkZXYt
PnNtdSksIFNNVV9PRF9NQ0xLLCAodWludDMyX3QpdmFsdWUpOwo+PiAgICAgICAgICB9IGVsc2Ug
ewo+PiBAQCAtMTc2Myw4ICsxNjUyLDYgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9t
Y2xrX29kKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICB9Cj4+ICAgICAg
ICAgIH0KPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAg
ICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAg
cG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4KPj4gQEAgLTE4MDAsNyAr
MTY4Nyw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfcG93ZXJfcHJvZmlsZV9tb2Rl
KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgc3NpemVfdCBzaXplOwo+PiAgICAgICAg
ICBpbnQgcmV0Owo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsg
ICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4g
LUVQRVJNOwo+Pgo+PiAgICAgICAgICByZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRl
dik7Cj4+IEBAIC0xODA5LDggKzE2OTYsNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bw
X3Bvd2VyX3Byb2ZpbGVfbW9kZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAg
ICAgcmV0dXJuIHJldDsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRl
dikpCj4+ICAgICAgICAgICAgICAgICAgc2l6ZSA9IHNtdV9nZXRfcG93ZXJfcHJvZmlsZV9tb2Rl
KCZhZGV2LT5zbXUsIGJ1Zik7Cj4+ICAgICAgICAgIGVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5w
cF9mdW5jcy0+Z2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZSkKPj4gQEAgLTE4MTgsOCArMTcwMyw2IEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfcG93ZXJfcHJvZmlsZV9tb2RlKHN0cnVjdCBk
ZXZpY2UgKmRldiwKPj4gICAgICAgICAgZWxzZQo+PiAgICAgICAgICAgICAgICAgIHNpemUgPSBz
bnByaW50ZihidWYsIFBBR0VfU0laRSwgIlxuIik7Cj4+Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYt
PmRldik7Cj4+Cj4+IEBAIC0xODQ0LDcgKzE3MjcsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVf
c2V0X3BwX3Bvd2VyX3Byb2ZpbGVfbW9kZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAg
IGxvbmcgaW50IHByb2ZpbGVfbW9kZSA9IDA7Cj4+ICAgICAgICAgIGNvbnN0IGNoYXIgZGVsaW1p
dGVyWzNdID0geycgJywgJ1xuJywgJ1wwJ307Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9y
ZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAg
ICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIHRtcFswXSA9ICooYnVmKTsK
Pj4gQEAgLTE4NzgsMTUgKzE3NjEsMTEgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9w
b3dlcl9wcm9maWxlX21vZGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAg
IHJldHVybiByZXQ7Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYt
PnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYp
KQo+PiAgICAgICAgICAgICAgICAgIHJldCA9IHNtdV9zZXRfcG93ZXJfcHJvZmlsZV9tb2RlKCZh
ZGV2LT5zbXUsIHBhcmFtZXRlciwgcGFyYW1ldGVyX3NpemUsIHRydWUpOwo+PiAgICAgICAgICBl
bHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPnNldF9wb3dlcl9wcm9maWxlX21vZGUp
Cj4+ICAgICAgICAgICAgICAgICAgcmV0ID0gYW1kZ3B1X2RwbV9zZXRfcG93ZXJfcHJvZmlsZV9t
b2RlKGFkZXYsIHBhcmFtZXRlciwgcGFyYW1ldGVyX3NpemUpOwo+Pgo+PiAtICAgICAgIHVwX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgcG1fcnVudGltZV9tYXJrX2xh
c3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAgICAgICBwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVu
ZChkZGV2LT5kZXYpOwo+Pgo+PiBAQCAtMTkxMiw3ICsxNzkxLDcgQEAgc3RhdGljIHNzaXplX3Qg
YW1kZ3B1X2dldF9ncHVfYnVzeV9wZXJjZW50KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAg
ICAgc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBkZGV2LT5kZXZfcHJpdmF0ZTsKPj4gICAg
ICAgICAgaW50IHIsIHZhbHVlLCBzaXplID0gc2l6ZW9mKHZhbHVlKTsKPj4KPj4gLSAgICAgICBp
ZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVz
ZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgciA9
IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsKPj4gQEAgLTE5MjEsMTEgKzE4MDAsOSBA
QCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X2dwdV9idXN5X3BlcmNlbnQoc3RydWN0IGRldmlj
ZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAgIHJldHVybiByOwo+PiAgICAgICAgICB9Cj4+Cj4+
IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAgICAgICAvKiByZWFk
IHRoZSBJUCBidXN5IHNlbnNvciAqLwo+PiAgICAgICAgICByID0gYW1kZ3B1X2RwbV9yZWFkX3Nl
bnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX0dQVV9MT0FELAo+PiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAodm9pZCAqKSZ2YWx1ZSwgJnNpemUpOwo+PiAtICAgICAgIHVw
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19s
YXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3Bl
bmQoZGRldi0+ZGV2KTsKPj4gQEAgLTE5NTIsNyArMTgyOSw3IEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9nZXRfbWVtX2J1c3lfcGVyY2VudChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAg
IHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gZGRldi0+ZGV2X3ByaXZhdGU7Cj4+ICAgICAg
ICAgIGludCByLCB2YWx1ZSwgc2l6ZSA9IHNpemVvZih2YWx1ZSk7Cj4+Cj4+IC0gICAgICAgaWYg
KGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0
KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIHIgPSBw
bV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4+IEBAIC0xOTYxLDE0ICsxODM4LDEwIEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfbWVtX2J1c3lfcGVyY2VudChzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7Cj4+ICAgICAgICAgIH0KPj4KPj4g
LSAgICAgICBkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgLyog
cmVhZCB0aGUgSVAgYnVzeSBzZW5zb3IgKi8KPj4gICAgICAgICAgciA9IGFtZGdwdV9kcG1fcmVh
ZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9NRU1fTE9BRCwKPj4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKHZvaWQgKikmdmFsdWUsICZzaXplKTsKPj4KPj4gLSAg
ICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRp
bWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRf
YXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4KPj4gQEAgLTE5OTksNyArMTg3Miw3IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9nZXRfcGNpZV9idyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAg
ICAgIHVpbnQ2NF90IGNvdW50MCA9IDAsIGNvdW50MSA9IDA7Cj4+ICAgICAgICAgIGludCByZXQ7
Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAo
YWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+
Cj4+ICAgICAgICAgIGlmIChhZGV2LT5mbGFncyAmIEFNRF9JU19BUFUpCj4+IEBAIC0yMDE0LDEy
ICsxODg3LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wY2llX2J3KHN0cnVjdCBkZXZp
Y2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+PiAgICAgICAgICB9Cj4+
Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAg
IGFtZGdwdV9hc2ljX2dldF9wY2llX3VzYWdlKGFkZXYsICZjb3VudDAsICZjb3VudDEpOwo+Pgo+
PiAtICAgICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgcG1f
cnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAgICAgICBwbV9ydW50aW1l
X3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+Pgo+PiBAQCAtMjA0NCw3ICsxOTEzLDcgQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF91bmlxdWVfaWQoc3RydWN0IGRldmljZSAqZGV2LAo+
PiAgICAgICAgICBzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IGRldl9nZXRfZHJ2ZGF0YShkZXYp
Owo+PiAgICAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGRkZXYtPmRldl9wcml2
YXRlOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAg
aWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gLUVQRVJN
Owo+Pgo+PiAgICAgICAgICBpZiAoYWRldi0+dW5pcXVlX2lkKQo+PiBAQCAtMjE0Miw3ICsyMDEx
LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9ncHVfbWV0cmljcyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4+ICAgICAgICAgIHNzaXplX3Qgc2l6ZSA9IDA7Cj4+ICAgICAgICAgIGludCByZXQ7
Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAo
YWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+
Cj4+ICAgICAgICAgIHJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsKPj4gQEAg
LTIxNTEsMTIgKzIwMjAsMTAgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9ncHVfbWV0cmlj
cyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPj4g
ICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4g
ICAgICAgICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+PiAgICAgICAgICAgICAgICAg
IHNpemUgPSBzbXVfc3lzX2dldF9ncHVfbWV0cmljcygmYWRldi0+c211LCAmZ3B1X21ldHJpY3Mp
Owo+PiAgICAgICAgICBlbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9ncHVf
bWV0cmljcykKPj4gICAgICAgICAgICAgICAgICBzaXplID0gYW1kZ3B1X2RwbV9nZXRfZ3B1X21l
dHJpY3MoYWRldiwgJmdwdV9tZXRyaWNzKTsKPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOwo+Pgo+PiAgICAgICAgICBpZiAoc2l6ZSA8PSAwKQo+PiAgICAgICAgICAgICAgICAg
IGdvdG8gb3V0Owo+PiBAQCAtMjM2OCw3ICsyMjM1LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2h3bW9uX3Nob3dfdGVtcChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIGludCBjaGFu
bmVsID0gdG9fc2Vuc29yX2Rldl9hdHRyKGF0dHIpLT5pbmRleDsKPj4gICAgICAgICAgaW50IHIs
IHRlbXAgPSAwLCBzaXplID0gc2l6ZW9mKHRlbXApOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVf
aW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAg
ICAgICAgICAgICAgICByZXR1cm4gLUVQRVJNOwo+Pgo+PiAgICAgICAgICBpZiAoY2hhbm5lbCA+
PSBQUF9URU1QX01BWCkKPj4gQEAgLTIzODAsOCArMjI0Nyw2IEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9od21vbl9zaG93X3RlbXAoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAg
ICAgIHJldHVybiByOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHN3aXRjaCAoY2hhbm5lbCkgewo+PiAgICAg
ICAgICBjYXNlIFBQX1RFTVBfSlVOQ1RJT046Cj4+ICAgICAgICAgICAgICAgICAgLyogZ2V0IGN1
cnJlbnQganVuY3Rpb24gdGVtcGVyYXR1cmUgKi8KPj4gQEAgLTI0MDMsOCArMjI2OCw2IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93X3RlbXAoc3RydWN0IGRldmljZSAqZGV2LAo+
PiAgICAgICAgICAgICAgICAgIGJyZWFrOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgdXBf
cmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBwbV9ydW50aW1lX21hcmtf
bGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1
dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+Cj4+IEBAIC0yNTA4LDcgKzIzNzEsNyBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X3B3bTFfZW5hYmxlKHN0cnVjdCBkZXZpY2Ug
KmRldiwKPj4gICAgICAgICAgdTMyIHB3bV9tb2RlID0gMDsKPj4gICAgICAgICAgaW50IHJldDsK
Pj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChh
ZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4K
Pj4gICAgICAgICAgcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOwo+
PiBAQCAtMjUxNywyMyArMjM4MCwxOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0
X3B3bTFfZW5hYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1
cm4gcmV0Owo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIGlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+
PiAgICAgICAgICAgICAgICAgIHB3bV9tb2RlID0gc211X2dldF9mYW5fY29udHJvbF9tb2RlKCZh
ZGV2LT5zbXUpOwo+PiAgICAgICAgICB9IGVsc2Ugewo+PiAgICAgICAgICAgICAgICAgIGlmICgh
YWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfZmFuX2NvbnRyb2xfbW9kZSkgewo+PiAgICAg
ICAgICAgICAgICAgICAgICAgICAgcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2
LT5kZXYpOwo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1
c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPj4gLSAgICAgICAgICAgICAgICAgICAgICAgdXBfcmVh
ZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAt
RUlOVkFMOwo+PiAgICAgICAgICAgICAgICAgIH0KPj4KPj4gICAgICAgICAgICAgICAgICBwd21f
bW9kZSA9IGFtZGdwdV9kcG1fZ2V0X2Zhbl9jb250cm9sX21vZGUoYWRldik7Cj4+ICAgICAgICAg
IH0KPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAg
ICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsKPj4gICAgICAg
ICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPj4KPj4gQEAg
LTI1NDksNyArMjQwNyw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zZXRfcHdtMV9l
bmFibGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBpbnQgZXJyLCByZXQ7Cj4+ICAg
ICAgICAgIGludCB2YWx1ZTsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYp
KQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAg
cmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgZXJyID0ga3N0cnRvaW50KGJ1ZiwgMTAsICZ2
YWx1ZSk7Cj4+IEBAIC0yNTYyLDIzICsyNDIwLDE4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9o
d21vbl9zZXRfcHdtMV9lbmFibGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAg
ICAgIHJldHVybiByZXQ7Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFk
ZXYpKSB7Cj4+ICAgICAgICAgICAgICAgICAgc211X3NldF9mYW5fY29udHJvbF9tb2RlKCZhZGV2
LT5zbXUsIHZhbHVlKTsKPj4gICAgICAgICAgfSBlbHNlIHsKPj4gICAgICAgICAgICAgICAgICBp
ZiAoIWFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+c2V0X2Zhbl9jb250cm9sX21vZGUpIHsKPj4g
ICAgICAgICAgICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+
ZGRldi0+ZGV2KTsKPj4gICAgICAgICAgICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1
dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+IC0gICAgICAgICAgICAgICAgICAgICAgIHVw
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1
cm4gLUVJTlZBTDsKPj4gICAgICAgICAgICAgICAgICB9Cj4+Cj4+ICAgICAgICAgICAgICAgICAg
YW1kZ3B1X2RwbV9zZXRfZmFuX2NvbnRyb2xfbW9kZShhZGV2LCB2YWx1ZSk7Cj4+ICAgICAgICAg
IH0KPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAg
ICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsKPj4gICAgICAg
ICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPj4KPj4gQEAg
LTI2MDgsNyArMjQ2MSw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zZXRfcHdtMShz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIHUzMiB2YWx1ZTsKPj4gICAgICAgICAgdTMy
IHB3bV9tb2RlOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsg
ICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4g
LUVQRVJNOwo+Pgo+PiAgICAgICAgICBlcnIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRk
ZXYtPmRldik7Cj4+IEBAIC0yNjE3LDE1ICsyNDcwLDExIEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9od21vbl9zZXRfcHdtMShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAg
cmV0dXJuIGVycjsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+
cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikp
Cj4+ICAgICAgICAgICAgICAgICAgcHdtX21vZGUgPSBzbXVfZ2V0X2Zhbl9jb250cm9sX21vZGUo
JmFkZXYtPnNtdSk7Cj4+ICAgICAgICAgIGVsc2UKPj4gICAgICAgICAgICAgICAgICBwd21fbW9k
ZSA9IGFtZGdwdV9kcG1fZ2V0X2Zhbl9jb250cm9sX21vZGUoYWRldik7Cj4+Cj4+IC0gICAgICAg
dXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAocHdtX21vZGUg
IT0gQU1EX0ZBTl9DVFJMX01BTlVBTCkgewo+PiAgICAgICAgICAgICAgICAgIHByX2luZm8oIm1h
bnVhbCBmYW4gc3BlZWQgY29udHJvbCBzaG91bGQgYmUgZW5hYmxlZCBmaXJzdFxuIik7Cj4+ICAg
ICAgICAgICAgICAgICAgcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYp
Owo+PiBAQCAtMjY2Niw3ICsyNTE1LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dl
dF9wd20xKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgaW50IGVycjsKPj4gICAgICAg
ICAgdTMyIHNwZWVkID0gMDsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYp
KQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAg
cmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgZXJyID0gcG1fcnVudGltZV9nZXRfc3luYyhh
ZGV2LT5kZGV2LT5kZXYpOwo+PiBAQCAtMjY3NSw4ICsyNTI0LDYgQEAgc3RhdGljIHNzaXplX3Qg
YW1kZ3B1X2h3bW9uX2dldF9wd20xKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAg
ICAgICByZXR1cm4gZXJyOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZh
ZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIGlmIChpc19zdXBwb3J0X3N3X3NtdShh
ZGV2KSkKPj4gICAgICAgICAgICAgICAgICBlcnIgPSBzbXVfZ2V0X2Zhbl9zcGVlZF9wZXJjZW50
KCZhZGV2LT5zbXUsICZzcGVlZCk7Cj4+ICAgICAgICAgIGVsc2UgaWYgKGFkZXYtPnBvd2VycGxh
eS5wcF9mdW5jcy0+Z2V0X2Zhbl9zcGVlZF9wZXJjZW50KQo+PiBAQCAtMjY4NCw4ICsyNTMxLDYg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dldF9wd20xKHN0cnVjdCBkZXZpY2UgKmRl
diwKPj4gICAgICAgICAgZWxzZQo+PiAgICAgICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4+
Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBw
bV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBt
X3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+Cj4+IEBAIC0yNzA1
LDcgKzI1NTAsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X2ZhbjFfaW5wdXQo
c3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBpbnQgZXJyOwo+PiAgICAgICAgICB1MzIg
c3BlZWQgPSAwOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsg
ICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4g
LUVQRVJNOwo+Pgo+PiAgICAgICAgICBlcnIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRk
ZXYtPmRldik7Cj4+IEBAIC0yNzE0LDggKzI1NTksNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVf
aHdtb25fZ2V0X2ZhbjFfaW5wdXQoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAg
ICAgIHJldHVybiBlcnI7Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFk
ZXYpKQo+PiAgICAgICAgICAgICAgICAgIGVyciA9IHNtdV9nZXRfZmFuX3NwZWVkX3JwbSgmYWRl
di0+c211LCAmc3BlZWQpOwo+PiAgICAgICAgICBlbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBf
ZnVuY3MtPmdldF9mYW5fc3BlZWRfcnBtKQo+PiBAQCAtMjcyMyw4ICsyNTY2LDYgQEAgc3RhdGlj
IHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dldF9mYW4xX2lucHV0KHN0cnVjdCBkZXZpY2UgKmRldiwK
Pj4gICAgICAgICAgZWxzZQo+PiAgICAgICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4+Cj4+
IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBwbV9y
dW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1
bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+Cj4+IEBAIC0yNzQzLDcg
KzI1ODQsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X2ZhbjFfbWluKHN0cnVj
dCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgdTMyIHNpemUgPSBzaXplb2YobWluX3JwbSk7Cj4+
ICAgICAgICAgIGludCByOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikp
Cj4+ICsgICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICBy
ZXR1cm4gLUVQRVJNOwo+Pgo+PiAgICAgICAgICByID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2
LT5kZGV2LT5kZXYpOwo+PiBAQCAtMjc1MiwxMyArMjU5Myw5IEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9od21vbl9nZXRfZmFuMV9taW4oc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAg
ICAgICAgIHJldHVybiByOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZh
ZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHIgPSBhbWRncHVfZHBtX3JlYWRfc2Vu
c29yKGFkZXYsIEFNREdQVV9QUF9TRU5TT1JfTUlOX0ZBTl9SUE0sCj4+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICh2b2lkICopJm1pbl9ycG0sICZzaXplKTsKPj4KPj4gLSAg
ICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRp
bWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGlt
ZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPj4KPj4gQEAgLTI3NzcsNyArMjYx
NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfZmFuMV9tYXgoc3RydWN0IGRl
dmljZSAqZGV2LAo+PiAgICAgICAgICB1MzIgc2l6ZSA9IHNpemVvZihtYXhfcnBtKTsKPj4gICAg
ICAgICAgaW50IHI7Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4g
KyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVy
biAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIHIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRk
ZXYtPmRldik7Cj4+IEBAIC0yNzg2LDEzICsyNjIzLDkgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2h3bW9uX2dldF9mYW4xX21heChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAg
ICAgcmV0dXJuIHI7Cj4+ICAgICAgICAgIH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYt
PnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3Io
YWRldiwgQU1ER1BVX1BQX1NFTlNPUl9NQVhfRkFOX1JQTSwKPj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgKHZvaWQgKikmbWF4X3JwbSwgJnNpemUpOwo+Pgo+PiAtICAgICAg
IHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgcG1fcnVudGltZV9t
YXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+PiAgICAgICAgICBwbV9ydW50aW1lX3B1
dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+Pgo+PiBAQCAtMjgxMCw3ICsyNjQzLDcg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dldF9mYW4xX3RhcmdldChzdHJ1Y3QgZGV2
aWNlICpkZXYsCj4+ICAgICAgICAgIGludCBlcnI7Cj4+ICAgICAgICAgIHUzMiBycG0gPSAwOwo+
Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAgaWYgKGFk
ZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gLUVQRVJNOwo+Pgo+
PiAgICAgICAgICBlcnIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRkZXYtPmRldik7Cj4+
IEBAIC0yODE5LDggKzI2NTIsNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X2Zh
bjFfdGFyZ2V0KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1cm4g
ZXJyOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5yZXNldF9z
ZW0pOwo+PiAtCj4+ICAgICAgICAgIGlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPj4gICAg
ICAgICAgICAgICAgICBlcnIgPSBzbXVfZ2V0X2Zhbl9zcGVlZF9ycG0oJmFkZXYtPnNtdSwgJnJw
bSk7Cj4+ICAgICAgICAgIGVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0X2Zh
bl9zcGVlZF9ycG0pCj4+IEBAIC0yODI4LDggKzI2NTksNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfaHdtb25fZ2V0X2ZhbjFfdGFyZ2V0KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAg
ZWxzZQo+PiAgICAgICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4+Cj4+IC0gICAgICAgdXBf
cmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBwbV9ydW50aW1lX21hcmtf
bGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1
dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+Cj4+IEBAIC0yODQ4LDcgKzI2NzcsNyBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2V0X2ZhbjFfdGFyZ2V0KHN0cnVjdCBkZXZpY2Ug
KmRldiwKPj4gICAgICAgICAgdTMyIHZhbHVlOwo+PiAgICAgICAgICB1MzIgcHdtX21vZGU7Cj4+
Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRl
di0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+
ICAgICAgICAgIGVyciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsKPj4g
QEAgLTI4NTcsMTUgKzI2ODYsMTEgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9m
YW4xX3RhcmdldChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJu
IGVycjsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAg
ICAgICAgICAgICAgICAgcHdtX21vZGUgPSBzbXVfZ2V0X2Zhbl9jb250cm9sX21vZGUoJmFkZXYt
PnNtdSk7Cj4+ICAgICAgICAgIGVsc2UKPj4gICAgICAgICAgICAgICAgICBwd21fbW9kZSA9IGFt
ZGdwdV9kcG1fZ2V0X2Zhbl9jb250cm9sX21vZGUoYWRldik7Cj4+Cj4+IC0gICAgICAgdXBfcmVh
ZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAocHdtX21vZGUgIT0gQU1E
X0ZBTl9DVFJMX01BTlVBTCkgewo+PiAgICAgICAgICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19s
YXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsKPj4gICAgICAgICAgICAgICAgICBwbV9ydW50aW1l
X3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+PiBAQCAtMjg3OSw4ICsyNzA0LDYg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9mYW4xX3RhcmdldChzdHJ1Y3QgZGV2
aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIGVycjsKPj4gICAgICAgICAgfQo+
Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAg
ICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAgICAgICAgICAgICAgICAgZXJyID0g
c211X3NldF9mYW5fc3BlZWRfcnBtKCZhZGV2LT5zbXUsIHZhbHVlKTsKPj4gICAgICAgICAgZWxz
ZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5zZXRfZmFuX3NwZWVkX3JwbSkKPj4gQEAg
LTI4ODgsOCArMjcxMSw2IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zZXRfZmFuMV90
YXJnZXQoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBlbHNlCj4+ICAgICAgICAgICAg
ICAgICAgZXJyID0gLUVJTlZBTDsKPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9z
ZW0pOwo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRl
di0+ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRl
di0+ZGV2KTsKPj4KPj4gQEAgLTI5MDcsNyArMjcyOCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9od21vbl9nZXRfZmFuMV9lbmFibGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICB1
MzIgcHdtX21vZGUgPSAwOwo+PiAgICAgICAgICBpbnQgcmV0Owo+Pgo+PiAtICAgICAgIGlmIChh
bWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkK
Pj4gICAgICAgICAgICAgICAgICByZXR1cm4gLUVQRVJNOwo+Pgo+PiAgICAgICAgICByZXQgPSBw
bV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRkZXYtPmRldik7Cj4+IEBAIC0yOTE2LDIzICsyNzM3
LDE4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfZmFuMV9lbmFibGUoc3RydWN0
IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4+ICAgICAgICAg
IH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAg
ICAgICAgaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7Cj4+ICAgICAgICAgICAgICAgICAg
cHdtX21vZGUgPSBzbXVfZ2V0X2Zhbl9jb250cm9sX21vZGUoJmFkZXYtPnNtdSk7Cj4+ICAgICAg
ICAgIH0gZWxzZSB7Cj4+ICAgICAgICAgICAgICAgICAgaWYgKCFhZGV2LT5wb3dlcnBsYXkucHBf
ZnVuY3MtPmdldF9mYW5fY29udHJvbF9tb2RlKSB7Cj4+ICAgICAgICAgICAgICAgICAgICAgICAg
ICBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgICAgICAg
ICAgICAgICAgICAgICAgICBwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5k
ZXYpOwo+PiAtICAgICAgICAgICAgICAgICAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Owo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4+ICAgICAgICAg
ICAgICAgICAgfQo+Pgo+PiAgICAgICAgICAgICAgICAgIHB3bV9tb2RlID0gYW1kZ3B1X2RwbV9n
ZXRfZmFuX2NvbnRyb2xfbW9kZShhZGV2KTsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIHVw
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgcG1fcnVudGltZV9tYXJr
X2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+PiAgICAgICAgICBwbV9ydW50aW1lX3B1dF9h
dXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+Pgo+PiBAQCAtMjk0OSw3ICsyNzY1LDcgQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9mYW4xX2VuYWJsZShzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4+ICAgICAgICAgIGludCB2YWx1ZTsKPj4gICAgICAgICAgdTMyIHB3bV9tb2RlOwo+
Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAgaWYgKGFk
ZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gLUVQRVJNOwo+Pgo+
PiAgICAgICAgICBlcnIgPSBrc3RydG9pbnQoYnVmLCAxMCwgJnZhbHVlKTsKPj4gQEAgLTI5Njks
MjIgKzI3ODUsMTcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9mYW4xX2VuYWJs
ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIGVycjsKPj4g
ICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4g
LQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsKPj4gICAgICAgICAg
ICAgICAgICBzbXVfc2V0X2Zhbl9jb250cm9sX21vZGUoJmFkZXYtPnNtdSwgcHdtX21vZGUpOwo+
PiAgICAgICAgICB9IGVsc2Ugewo+PiAgICAgICAgICAgICAgICAgIGlmICghYWRldi0+cG93ZXJw
bGF5LnBwX2Z1bmNzLT5zZXRfZmFuX2NvbnRyb2xfbW9kZSkgewo+PiAgICAgICAgICAgICAgICAg
ICAgICAgICAgcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+PiAg
ICAgICAgICAgICAgICAgICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+
ZGRldi0+ZGV2KTsKPj4gLSAgICAgICAgICAgICAgICAgICAgICAgdXBfcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsKPj4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+PiAg
ICAgICAgICAgICAgICAgIH0KPj4gICAgICAgICAgICAgICAgICBhbWRncHVfZHBtX3NldF9mYW5f
Y29udHJvbF9tb2RlKGFkZXYsIHB3bV9tb2RlKTsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAg
IHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+IC0KPj4gICAgICAgICAgcG1fcnVudGltZV9t
YXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+PiAgICAgICAgICBwbV9ydW50aW1lX3B1
dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+Pgo+PiBAQCAtMjk5OSw3ICsyODEwLDcg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfdmRkZ2Z4KHN0cnVjdCBkZXZpY2Ug
KmRldiwKPj4gICAgICAgICAgdTMyIHZkZGdmeDsKPj4gICAgICAgICAgaW50IHIsIHNpemUgPSBz
aXplb2YodmRkZ2Z4KTsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+
PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0
dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+
ZGRldi0+ZGV2KTsKPj4gQEAgLTMwMDgsMTEgKzI4MTksOSBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfaHdtb25fc2hvd192ZGRnZngoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAg
ICAgIHJldHVybiByOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOwo+PiAgICAgICAgICAvKiBnZXQgdGhlIHZvbHRhZ2UgKi8KPj4gICAgICAg
ICAgciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9WRERH
RlgsCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh2b2lkICopJnZkZGdm
eCwgJnNpemUpOwo+PiAtICAgICAgIHVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+Cj4+ICAg
ICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsKPj4gICAg
ICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPj4gQEAg
LTMwMzgsNyArMjg0Nyw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93X3ZkZG5i
KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgdTMyIHZkZG5iOwo+PiAgICAgICAgICBp
bnQgciwgc2l6ZSA9IHNpemVvZih2ZGRuYik7Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9y
ZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAg
ICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIC8qIG9ubHkgQVBVcyBoYXZl
IHZkZG5iICovCj4+IEBAIC0zMDUxLDExICsyODYwLDkgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2h3bW9uX3Nob3dfdmRkbmIoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICAgICAgICAg
IHJldHVybiByOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZhZGV2LT5y
ZXNldF9zZW0pOwo+PiAgICAgICAgICAvKiBnZXQgdGhlIHZvbHRhZ2UgKi8KPj4gICAgICAgICAg
ciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9WREROQiwK
Pj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZvaWQgKikmdmRkbmIsICZz
aXplKTsKPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+Pgo+PiAgICAgICAg
ICBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgICAgICAg
IHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+IEBAIC0zMDgy
LDcgKzI4ODksNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19wb3dlcl9hdmco
c3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBpbnQgciwgc2l6ZSA9IHNpemVvZih1MzIp
Owo+PiAgICAgICAgICB1bnNpZ25lZCB1dzsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jl
c2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAg
ICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgciA9IHBtX3J1bnRpbWVfZ2V0
X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsKPj4gQEAgLTMwOTEsMTEgKzI4OTgsOSBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19wb3dlcl9hdmcoc3RydWN0IGRldmljZSAqZGV2LAo+
PiAgICAgICAgICAgICAgICAgIHJldHVybiByOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAg
ZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAgICAgICAvKiBnZXQgdGhlIHZvbHRh
Z2UgKi8KPj4gICAgICAgICAgciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BV
X1BQX1NFTlNPUl9HUFVfUE9XRVIsCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICh2b2lkICopJnF1ZXJ5LCAmc2l6ZSk7Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsKPj4KPj4gICAgICAgICAgcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5k
ZGV2LT5kZXYpOwo+PiAgICAgICAgICBwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5k
ZGV2LT5kZXYpOwo+PiBAQCAtMzEyNSw3ICsyOTMwLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2h3bW9uX3Nob3dfcG93ZXJfY2FwX21heChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAg
IHNzaXplX3Qgc2l6ZTsKPj4gICAgICAgICAgaW50IHI7Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdw
dV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAg
ICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+ICAgICAgICAgIHIgPSBwbV9ydW50
aW1lX2dldF9zeW5jKGFkZXYtPmRkZXYtPmRldik7Cj4+IEBAIC0zMTM0LDggKzI5MzksNiBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19wb3dlcl9jYXBfbWF4KHN0cnVjdCBkZXZp
Y2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gcjsKPj4gICAgICAgICAgfQo+Pgo+
PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBp
ZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsKPj4gICAgICAgICAgICAgICAgICBzbXVfZ2V0
X3Bvd2VyX2xpbWl0KCZhZGV2LT5zbXUsICZsaW1pdCwgdHJ1ZSk7Cj4+ICAgICAgICAgICAgICAg
ICAgc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJXVcbiIsIGxpbWl0ICogMTAwMDAw
MCk7Cj4+IEBAIC0zMTQ2LDggKzI5NDksNiBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25f
c2hvd19wb3dlcl9jYXBfbWF4KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAg
ICBzaXplID0gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICJcbiIpOwo+PiAgICAgICAgICB9Cj4+
Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBw
bV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBt
X3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+Cj4+IEBAIC0zMTYz
LDcgKzI5NjQsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19wb3dlcl9jYXAo
c3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBzc2l6ZV90IHNpemU7Cj4+ICAgICAgICAg
IGludCByOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAg
ICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gLUVQ
RVJNOwo+Pgo+PiAgICAgICAgICByID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5k
ZXYpOwo+PiBAQCAtMzE3Miw4ICsyOTczLDYgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9u
X3Nob3dfcG93ZXJfY2FwKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICBy
ZXR1cm4gcjsKPj4gICAgICAgICAgfQo+Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsKPj4gLQo+PiAgICAgICAgICBpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsK
Pj4gICAgICAgICAgICAgICAgICBzbXVfZ2V0X3Bvd2VyX2xpbWl0KCZhZGV2LT5zbXUsICZsaW1p
dCwgZmFsc2UpOwo+PiAgICAgICAgICAgICAgICAgIHNpemUgPSBzbnByaW50ZihidWYsIFBBR0Vf
U0laRSwgIiV1XG4iLCBsaW1pdCAqIDEwMDAwMDApOwo+PiBAQCAtMzE4NCw4ICsyOTgzLDYgQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfcG93ZXJfY2FwKHN0cnVjdCBkZXZpY2Ug
KmRldiwKPj4gICAgICAgICAgICAgICAgICBzaXplID0gc25wcmludGYoYnVmLCBQQUdFX1NJWkUs
ICJcbiIpOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPj4gLQo+PiAgICAgICAgICBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRk
ZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRk
ZXYtPmRldik7Cj4+Cj4+IEBAIC0zMjAyLDcgKzI5OTksNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfaHdtb25fc2V0X3Bvd2VyX2NhcChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgIGlu
dCBlcnI7Cj4+ICAgICAgICAgIHUzMiB2YWx1ZTsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2lu
X3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAg
ICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAgaWYgKGFtZGdwdV9zcmlv
dl92ZihhZGV2KSkKPj4gQEAgLTMyMjEsOCArMzAxOCw2IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9od21vbl9zZXRfcG93ZXJfY2FwKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAg
ICAgICByZXR1cm4gZXJyOwo+PiAgICAgICAgICB9Cj4+Cj4+IC0gICAgICAgZG93bl9yZWFkKCZh
ZGV2LT5yZXNldF9zZW0pOwo+PiAtCj4+ICAgICAgICAgIGlmIChpc19zdXBwb3J0X3N3X3NtdShh
ZGV2KSkKPj4gICAgICAgICAgICAgICAgICBlcnIgPSBzbXVfc2V0X3Bvd2VyX2xpbWl0KCZhZGV2
LT5zbXUsIHZhbHVlKTsKPj4gICAgICAgICAgZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1
bmNzICYmIGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+c2V0X3Bvd2VyX2xpbWl0KQo+PiBAQCAt
MzIzMCw4ICszMDI1LDYgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9wb3dlcl9j
YXAoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICBlbHNlCj4+ICAgICAgICAgICAgICAg
ICAgZXJyID0gLUVJTlZBTDsKPj4KPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Owo+PiAtCj4+ICAgICAgICAgIHBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+
ZGV2KTsKPj4gICAgICAgICAgcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+
ZGV2KTsKPj4KPj4gQEAgLTMyNDksNyArMzA0Miw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9o
d21vbl9zaG93X3NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAgICAgICB1aW50MzJfdCBz
Y2xrOwo+PiAgICAgICAgICBpbnQgciwgc2l6ZSA9IHNpemVvZihzY2xrKTsKPj4KPj4gLSAgICAg
ICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9ncHVf
cmVzZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKPj4KPj4gICAgICAgICAg
ciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsKPj4gQEAgLTMyNTgsMTEg
KzMwNTEsOSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19zY2xrKHN0cnVjdCBk
ZXZpY2UgKmRldiwKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gcjsKPj4gICAgICAgICAgfQo+
Pgo+PiAtICAgICAgIGRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAgICAgICAgLyog
Z2V0IHRoZSBzY2xrICovCj4+ICAgICAgICAgIHIgPSBhbWRncHVfZHBtX3JlYWRfc2Vuc29yKGFk
ZXYsIEFNREdQVV9QUF9TRU5TT1JfR0ZYX1NDTEssCj4+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICh2b2lkICopJnNjbGssICZzaXplKTsKPj4gLSAgICAgICB1cF9yZWFkKCZh
ZGV2LT5yZXNldF9zZW0pOwo+Pgo+PiAgICAgICAgICBwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgICAgICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5k
KGFkZXYtPmRkZXYtPmRldik7Cj4+IEBAIC0zMjg4LDcgKzMwNzksNyBAQCBzdGF0aWMgc3NpemVf
dCBhbWRncHVfaHdtb25fc2hvd19tY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgICAgICAg
dWludDMyX3QgbWNsazsKPj4gICAgICAgICAgaW50IHIsIHNpemUgPSBzaXplb2YobWNsayk7Cj4+
Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRl
di0+aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+
ICAgICAgICAgIHIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRkZXYtPmRldik7Cj4+IEBA
IC0zMjk3LDExICszMDg4LDkgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfbWNs
ayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7Cj4+ICAg
ICAgICAgIH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICAg
ICAgICAgIC8qIGdldCB0aGUgc2NsayAqLwo+PiAgICAgICAgICByID0gYW1kZ3B1X2RwbV9yZWFk
X3NlbnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX0dGWF9NQ0xLLAo+PiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAodm9pZCAqKSZtY2xrLCAmc2l6ZSk7Cj4+IC0gICAgICAg
dXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4KPj4gICAgICAgICAgcG1fcnVudGltZV9tYXJr
X2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+PiAgICAgICAgICBwbV9ydW50aW1lX3B1dF9h
dXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+PiBAQCAtNDE4OCw3ICszOTc3LDcgQEAgc3Rh
dGljIGludCBhbWRncHVfZGVidWdmc19wbV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
ZGF0YSkKPj4gICAgICAgICAgdTMyIGZsYWdzID0gMDsKPj4gICAgICAgICAgaW50IHI7Cj4+Cj4+
IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkKPj4gKyAgICAgICBpZiAoYWRldi0+
aW5fZ3B1X3Jlc2V0KQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAtRVBFUk07Cj4+Cj4+ICAg
ICAgICAgIHIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRldi0+ZGV2KTsKPj4gQEAgLTQyMDQsNyAr
Mzk5Myw2IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RlYnVnZnNfcG1faW5mbyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHZvaWQgKmRhdGEpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7Cj4+ICAgICAg
ICAgIH0KPj4KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICAgICAg
ICAgIGlmICghaXNfc3VwcG9ydF9zd19zbXUoYWRldikgJiYKPj4gICAgICAgICAgICAgIGFkZXYt
PnBvd2VycGxheS5wcF9mdW5jcy0+ZGVidWdmc19wcmludF9jdXJyZW50X3BlcmZvcm1hbmNlX2xl
dmVsKSB7Cj4+ICAgICAgICAgICAgICAgICAgbXV0ZXhfbG9jaygmYWRldi0+cG0ubXV0ZXgpOwo+
PiBAQCAtNDIxNywxMyArNDAwNSwxMCBAQCBzdGF0aWMgaW50IGFtZGdwdV9kZWJ1Z2ZzX3BtX2lu
Zm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+PiAgICAgICAgICB9IGVsc2Ugewo+
PiAgICAgICAgICAgICAgICAgIHIgPSBhbWRncHVfZGVidWdmc19wbV9pbmZvX3BwKG0sIGFkZXYp
Owo+PiAgICAgICAgICB9Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4g
ICAgICAgICAgaWYgKHIpCj4+ICAgICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4+Cj4+IC0gICAg
ICAgZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAgICAgICBhbWRncHVfZGV2aWNl
X2lwX2dldF9jbG9ja2dhdGluZ19zdGF0ZShhZGV2LCAmZmxhZ3MpOwo+PiAtICAgICAgIHVwX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+Cj4+ICAgICAgICAgIHNlcV9wcmludGYobSwgIkNsb2Nr
IEdhdGluZyBGbGFncyBNYXNrOiAweCV4XG4iLCBmbGFncyk7Cj4+ICAgICAgICAgIGFtZGdwdV9w
YXJzZV9jZ19zdGF0ZShtLCBmbGFncyk7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfcHNwLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfcHNwLmMKPj4gaW5kZXggMTE2YTg5OTkwZjM5Li5hYTFlNzdjNjBjMGEgMTAwNjQ0Cj4+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wc3AuYwo+PiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcHNwLmMKPj4gQEAgLTE4NjksNyArMTg2OSw3
IEBAIHN0YXRpYyBpbnQgcHNwX2xvYWRfc211X2Z3KHN0cnVjdCBwc3BfY29udGV4dCAqcHNwKQo+
PiAgICAgICAgICAgICAgICAgIHJldHVybiAwOwo+Pgo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVf
aW5fcmVzZXQoYWRldikgJiYgcmFzICYmIHJhcy0+c3VwcG9ydGVkKSB7Cj4+ICsgICAgICAgaWYg
KGFkZXYtPmluX2dwdV9yZXNldCAmJiByYXMgJiYgcmFzLT5zdXBwb3J0ZWQpIHsKPj4gICAgICAg
ICAgICAgICAgICByZXQgPSBhbWRncHVfZHBtX3NldF9tcDFfc3RhdGUoYWRldiwgUFBfTVAxX1NU
QVRFX1VOTE9BRCk7Cj4+ICAgICAgICAgICAgICAgICAgaWYgKHJldCkgewo+PiAgICAgICAgICAg
ICAgICAgICAgICAgICAgRFJNX1dBUk4oIkZhaWxlZCB0byBzZXQgTVAxIHN0YXRlIHByZXBhcmUg
Zm9yIHJlbG9hZFxuIik7Cj4+IEBAIC0xOTg0LDcgKzE5ODQsNyBAQCBzdGF0aWMgaW50IHBzcF9s
b2FkX2Z3KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQo+PiAgICAgICAgICBpbnQgcmV0Owo+
PiAgICAgICAgICBzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCA9ICZhZGV2LT5wc3A7Cj4+Cj4+IC0g
ICAgICAgaWYgKGFtZGdwdV9zcmlvdl92ZihhZGV2KSAmJiBhbWRncHVfaW5fcmVzZXQoYWRldikp
IHsKPj4gKyAgICAgICBpZiAoYW1kZ3B1X3NyaW92X3ZmKGFkZXYpICYmIGFkZXYtPmluX2dwdV9y
ZXNldCkgewo+PiAgICAgICAgICAgICAgICAgIHBzcF9yaW5nX3N0b3AocHNwLCBQU1BfUklOR19U
WVBFX19LTSk7IC8qIHNob3VsZCBub3QgZGVzdHJveSByaW5nLCBvbmx5IHN0b3AgKi8KPj4gICAg
ICAgICAgICAgICAgICBnb3RvIHNraXBfbWVtYWxsb2M7Cj4+ICAgICAgICAgIH0KPj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuYwo+PiBpbmRleCBjZDE0MDNmODNkY2YuLmYw
OTA4MjU3ODg2NSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3Jhcy5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMu
Ywo+PiBAQCAtMjA3OSw3ICsyMDc5LDcgQEAgaW50IGFtZGdwdV9yYXNfbGF0ZV9pbml0KHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2LAo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgYW1kZ3B1
X3Jhc19yZXF1ZXN0X3Jlc2V0X29uX2Jvb3QoYWRldiwKPj4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICByYXNfYmxvY2stPmJsb2NrKTsKPj4gICAgICAgICAgICAgICAg
ICAgICAgICAgIHJldHVybiAwOwo+PiAtICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhZGV2LT5p
bl9zdXNwZW5kIHx8IGFtZGdwdV9pbl9yZXNldChhZGV2KSkgewo+PiArICAgICAgICAgICAgICAg
fSBlbHNlIGlmIChhZGV2LT5pbl9zdXNwZW5kIHx8IGFkZXYtPmluX2dwdV9yZXNldCkgewo+PiAg
ICAgICAgICAgICAgICAgICAgICAgICAgLyogaW4gcmVzdW1lIHBoYXNlLCBpZiBmYWlsIHRvIGVu
YWJsZSByYXMsCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBjbGVhbiB1cCBhbGwgcmFz
IGZzIG5vZGVzLCBhbmQgZGlzYWJsZSByYXMgKi8KPj4gICAgICAgICAgICAgICAgICAgICAgICAg
IGdvdG8gY2xlYW51cDsKPj4gQEAgLTIwODgsNyArMjA4OCw3IEBAIGludCBhbWRncHVfcmFzX2xh
dGVfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPj4gICAgICAgICAgfQo+Pgo+PiAg
ICAgICAgICAvKiBpbiByZXN1bWUgcGhhc2UsIG5vIG5lZWQgdG8gY3JlYXRlIHJhcyBmcyBub2Rl
ICovCj4+IC0gICAgICAgaWYgKGFkZXYtPmluX3N1c3BlbmQgfHwgYW1kZ3B1X2luX3Jlc2V0KGFk
ZXYpKQo+PiArICAgICAgIGlmIChhZGV2LT5pbl9zdXNwZW5kIHx8IGFkZXYtPmluX2dwdV9yZXNl
dCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gMDsKPj4KPj4gICAgICAgICAgaWYgKGloX2lu
Zm8tPmNiKSB7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfdHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmMKPj4gaW5k
ZXggMjBmYTA0OTdhYWE0Li4xZTE5ZDEzMDQ3M2YgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfdHRtLmMKPj4gQEAgLTIxMDMsNyArMjEwMyw3IEBAIHZvaWQgYW1kZ3B1
X3R0bV9zZXRfYnVmZmVyX2Z1bmNzX3N0YXR1cyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwg
Ym9vbCBlbmFibGUpCj4+ICAgICAgICAgIHVpbnQ2NF90IHNpemU7Cj4+ICAgICAgICAgIGludCBy
Owo+Pgo+PiAtICAgICAgIGlmICghYWRldi0+bW1hbi5pbml0aWFsaXplZCB8fCBhbWRncHVfaW5f
cmVzZXQoYWRldikgfHwKPj4gKyAgICAgICBpZiAoIWFkZXYtPm1tYW4uaW5pdGlhbGl6ZWQgfHwg
YWRldi0+aW5fZ3B1X3Jlc2V0IHx8Cj4+ICAgICAgICAgICAgICBhZGV2LT5tbWFuLmJ1ZmZlcl9m
dW5jc19lbmFibGVkID09IGVuYWJsZSkKPj4gICAgICAgICAgICAgICAgICByZXR1cm47Cj4+Cj4+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdWNvZGUuYyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV91Y29kZS5jCj4+IGluZGV4IDAzOTI0
NWM5OGZmOC4uMTgzNzQzYzVmYjdiIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfdWNvZGUuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfdWNvZGUuYwo+PiBAQCAtNjI4LDggKzYyOCw3IEBAIGludCBhbWRncHVfdWNvZGVf
aW5pdF9ibyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPj4gICAgICAgICAgc3RydWN0IGFt
ZGdwdV9maXJtd2FyZV9pbmZvICp1Y29kZSA9IE5VTEw7Cj4+Cj4+ICAgIC8qIGZvciBiYXJlbWV0
YWwsIHRoZSB1Y29kZSBpcyBhbGxvY2F0ZWQgaW4gZ3R0LCBzbyBkb24ndCBuZWVkIHRvIGZpbGwg
dGhlIGJvIHdoZW4gcmVzZXQvc3VzcGVuZCAqLwo+PiAtICAgICAgIGlmICghYW1kZ3B1X3NyaW92
X3ZmKGFkZXYpICYmCj4+IC0gICAgICAgICAgICAgICAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpIHx8
IGFkZXYtPmluX3N1c3BlbmQpKQo+PiArICAgICAgIGlmICghYW1kZ3B1X3NyaW92X3ZmKGFkZXYp
ICYmIChhZGV2LT5pbl9ncHVfcmVzZXQgfHwgYWRldi0+aW5fc3VzcGVuZCkpCj4+ICAgICAgICAg
ICAgICAgICAgcmV0dXJuIDA7Cj4+ICAgICAgICAgIC8qCj4+ICAgICAgICAgICAqIGlmIFNNVSBs
b2FkZWQgZmlybXdhcmUsIGl0IG5lZWRuJ3QgYWRkIFNNQywgVVZELCBhbmQgVkNFCj4+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdmlydC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZpcnQuYwo+PiBpbmRleCAxZTIxMTU0NGYyZGMu
LmFlNzIwYTZkYzVhMCAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3ZpcnQuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
dmlydC5jCj4+IEBAIC05Myw3ICs5Myw3IEBAIHZvaWQgYW1kZ3B1X3ZpcnRfa2lxX3JlZ193cml0
ZV9yZWdfd2FpdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPj4gICAgICAgICAgYW1kZ3B1
X3JpbmdfdW5kbyhyaW5nKTsKPj4gICAgICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgma2lx
LT5yaW5nX2xvY2ssIGZsYWdzKTsKPj4gICBmYWlsZWRfa2lxOgo+PiAtICAgICAgIGRldl93YXJu
KGFkZXYtPmRldiwgImZhaWxlZCB0byB3cml0ZSByZWcgJXggd2FpdCByZWcgJXhcbiIsIHJlZzAs
IHJlZzEpOwo+PiArICAgICAgIHByX2VycigiZmFpbGVkIHRvIHdyaXRlIHJlZyAleCB3YWl0IHJl
ZyAleFxuIiwgcmVnMCwgcmVnMSk7Cj4+ICAgfQo+Pgo+PiAgIC8qKgo+PiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZpcnQuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV92aXJ0LmgKPj4gaW5kZXggYjIwNDZjM2E0MDRkLi5mODI2OTQ1
OTg5YzcgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92
aXJ0LmgKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZpcnQuaAo+
PiBAQCAtMzI1LDkgKzMyNSw5IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBpc192aXJ0dWFsX21hY2hp
bmUodm9pZCkKPj4gICAjZGVmaW5lIGFtZGdwdV9zcmlvdl9pc19wcF9vbmVfdmYoYWRldikgXAo+
PiAgICAgICAgICAoKGFkZXYpLT52aXJ0LmdpbV9mZWF0dXJlICYgQU1ER0lNX0ZFQVRVUkVfUFBf
T05FX1ZGKQo+PiAgICNkZWZpbmUgYW1kZ3B1X3NyaW92X2lzX2RlYnVnKGFkZXYpIFwKPj4gLSAg
ICAgICAoKCFhbWRncHVfaW5fcmVzZXQoYWRldikpICYmIGFkZXYtPnZpcnQudGRyX2RlYnVnKQo+
PiArICAgICAgICgoIWFkZXYtPmluX2dwdV9yZXNldCkgJiYgYWRldi0+dmlydC50ZHJfZGVidWcp
Cj4+ICAgI2RlZmluZSBhbWRncHVfc3Jpb3ZfaXNfbm9ybWFsKGFkZXYpIFwKPj4gLSAgICAgICAo
KCFhbWRncHVfaW5fcmVzZXQoYWRldikpICYmICghYWRldi0+dmlydC50ZHJfZGVidWcpKQo+PiAr
ICAgICAgICgoIWFkZXYtPmluX2dwdV9yZXNldCkgJiYgKCFhZGV2LT52aXJ0LnRkcl9kZWJ1Zykp
Cj4+Cj4+ICAgYm9vbCBhbWRncHVfdmlydF9tbWlvX2Jsb2NrZWQoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYpOwo+PiAgIHZvaWQgYW1kZ3B1X3ZpcnRfaW5pdF9zZXR0aW5nKHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2KTsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV94Z21pLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfeGdt
aS5jCj4+IGluZGV4IDY3YTc1NmY0MzM3Yi4uY2Q2ZTZlYjdkOTY2IDEwMDY0NAo+PiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfeGdtaS5jCj4+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV94Z21pLmMKPj4gQEAgLTM3Miw3ICszNzIsNyBAQCBz
dHJ1Y3QgYW1kZ3B1X2hpdmVfaW5mbyAqYW1kZ3B1X2dldF94Z21pX2hpdmUoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsIGludCBsbwo+PiAgICAgICAgICB0bXAtPmhpdmVfaWQgPSBhZGV2LT5n
bWMueGdtaS5oaXZlX2lkOwo+PiAgICAgICAgICBJTklUX0xJU1RfSEVBRCgmdG1wLT5kZXZpY2Vf
bGlzdCk7Cj4+ICAgICAgICAgIG11dGV4X2luaXQoJnRtcC0+aGl2ZV9sb2NrKTsKPj4gLSAgICAg
ICBhdG9taWNfc2V0KCZ0bXAtPmluX3Jlc2V0LCAwKTsKPj4gKyAgICAgICBtdXRleF9pbml0KCZ0
bXAtPnJlc2V0X2xvY2spOwo+PiAgICAgICAgICB0YXNrX2JhcnJpZXJfaW5pdCgmdG1wLT50Yik7
Cj4+Cj4+ICAgICAgICAgIGlmIChsb2NrKQo+PiBAQCAtMzk3LDcgKzM5Nyw2IEBAIGludCBhbWRn
cHVfeGdtaV9zZXRfcHN0YXRlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBpbnQgcHN0YXRl
KQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGl2
ZS0+aGlfcmVxX2dwdSA6IGFkZXY7Cj4+ICAgICAgICAgIGJvb2wgaXNfaGlfcmVxID0gcHN0YXRl
ID09IEFNREdQVV9YR01JX1BTVEFURV9NQVhfVkVHQTIwOwo+PiAgICAgICAgICBib29sIGluaXRf
bG93ID0gaGl2ZS0+cHN0YXRlID09IEFNREdQVV9YR01JX1BTVEFURV9VTktOT1dOOwo+PiAtICAg
ICAgIGJvb2wgbG9ja2VkOwo+Pgo+PiAgICAgICAgICAvKiBmdyBidWcgc28gdGVtcG9yYXJpbHkg
ZGlzYWJsZSBwc3RhdGUgc3dpdGNoaW5nICovCj4+ICAgICAgICAgIHJldHVybiAwOwo+PiBAQCAt
NDA1LDkgKzQwNCw3IEBAIGludCBhbWRncHVfeGdtaV9zZXRfcHN0YXRlKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2LCBpbnQgcHN0YXRlKQo+PiAgICAgICAgICBpZiAoIWhpdmUgfHwgYWRldi0+
YXNpY190eXBlICE9IENISVBfVkVHQTIwKQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiAwOwo+
Pgo+PiAtICAgICAgIGxvY2tlZCA9IGF0b21pY19yZWFkKCZoaXZlLT5pbl9yZXNldCkgPyBmYWxz
ZSA6IHRydWU7Cj4+IC0gICAgICAgaWYgKGxvY2tlZCkKPj4gLSAgICAgICAgICAgICAgIG11dGV4
X2xvY2soJmhpdmUtPmhpdmVfbG9jayk7Cj4+ICsgICAgICAgbXV0ZXhfbG9jaygmaGl2ZS0+aGl2
ZV9sb2NrKTsKPj4KPj4gICAgICAgICAgaWYgKGlzX2hpX3JlcSkKPj4gICAgICAgICAgICAgICAg
ICBoaXZlLT5oaV9yZXFfY291bnQrKzsKPj4gQEAgLTQ0Miw4ICs0MzksNyBAQCBpbnQgYW1kZ3B1
X3hnbWlfc2V0X3BzdGF0ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgaW50IHBzdGF0ZSkK
Pj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYWRldiA6IE5VTEw7Cj4+ICAgICAgICAgIH0KPj4gICBvdXQ6Cj4+IC0gICAgICAgaWYgKGxv
Y2tlZCkKPj4gLSAgICAgICAgICAgICAgIG11dGV4X3VubG9jaygmaGl2ZS0+aGl2ZV9sb2NrKTsK
Pj4gKyAgICAgICBtdXRleF91bmxvY2soJmhpdmUtPmhpdmVfbG9jayk7Cj4+ICAgICAgICAgIHJl
dHVybiByZXQ7Cj4+ICAgfQo+Pgo+PiBAQCAtNTk4LDYgKzU5NCw3IEBAIGludCBhbWRncHVfeGdt
aV9yZW1vdmVfZGV2aWNlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQo+PiAgICAgICAgICBp
ZighKC0taGl2ZS0+bnVtYmVyX2RldmljZXMpKXsKPj4gICAgICAgICAgICAgICAgICBhbWRncHVf
eGdtaV9zeXNmc19kZXN0cm95KGFkZXYsIGhpdmUpOwo+PiAgICAgICAgICAgICAgICAgIG11dGV4
X2Rlc3Ryb3koJmhpdmUtPmhpdmVfbG9jayk7Cj4+ICsgICAgICAgICAgICAgICBtdXRleF9kZXN0
cm95KCZoaXZlLT5yZXNldF9sb2NrKTsKPj4gICAgICAgICAgfQo+Pgo+PiAgICAgICAgICByZXR1
cm4gcHNwX3hnbWlfdGVybWluYXRlKCZhZGV2LT5wc3ApOwo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3hnbWkuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV94Z21pLmgKPj4gaW5kZXggNjE3MjBjZDRhMWVlLi42OTk5ZWFiMTZhNzIg
MTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV94Z21pLmgK
Pj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3hnbWkuaAo+PiBAQCAt
MzAsOCArMzAsNyBAQCBzdHJ1Y3QgYW1kZ3B1X2hpdmVfaW5mbyB7Cj4+ICAgICAgICAgIHVpbnQ2
NF90ICAgICAgICAgICAgICAgIGhpdmVfaWQ7Cj4+ICAgICAgICAgIHN0cnVjdCBsaXN0X2hlYWQg
ICAgICAgIGRldmljZV9saXN0Owo+PiAgICAgICAgICBpbnQgbnVtYmVyX2RldmljZXM7Cj4+IC0g
ICAgICAgc3RydWN0IG11dGV4IGhpdmVfbG9jazsKPj4gLSAgICAgICBhdG9taWNfdCBpbl9yZXNl
dDsKPj4gKyAgICAgICBzdHJ1Y3QgbXV0ZXggaGl2ZV9sb2NrLCByZXNldF9sb2NrOwo+PiAgICAg
ICAgICBzdHJ1Y3Qga29iamVjdCAqa29iajsKPj4gICAgICAgICAgc3RydWN0IGRldmljZV9hdHRy
aWJ1dGUgZGV2X2F0dHI7Cj4+ICAgICAgICAgIHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2Owo+
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYXRvbS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYXRvbS5jCj4+IGluZGV4IDgzNDFiZDk2NTIwMi4uNGNmYzc4
NjY5OWM3IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hdG9tLmMK
Pj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYXRvbS5jCj4+IEBAIC03NTUsNyAr
NzU1LDYgQEAgc3RhdGljIHZvaWQgYXRvbV9vcF9qdW1wKGF0b21fZXhlY19jb250ZXh0ICpjdHgs
IGludCAqcHRyLCBpbnQgYXJnKQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAv
KiBqaWZmaWVzIHdyYXAgYXJvdW5kIHdlIHdpbGwganVzdCB3YWl0IGEgbGl0dGxlIGxvbmdlciAq
Lwo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgtPmxhc3RfanVtcF9qaWZm
aWVzID0gamlmZmllczsKPj4gICAgICAgICAgICAgICAgICAgICAgICAgIH0KPj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgc2NoZWR1bGUoKTsKPj4gICAgICAgICAgICAgICAgICB9IGVsc2Ugewo+
PiAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5sYXN0X2p1bXAgPSBjdHgtPnN0YXJ0ICsg
dGFyZ2V0Owo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT5sYXN0X2p1bXBfamlmZmll
cyA9IGppZmZpZXM7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9n
ZnhfdjEwXzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92MTBfMC5jCj4+IGlu
ZGV4IGRlNmU2ZGU0MTg2Ny4uZTg3ZDQzNTM3MDEzIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9nZnhfdjEwXzAuYwo+PiBAQCAtNjIwMSw3ICs2MjAxLDcgQEAgc3RhdGljIGludCBn
ZnhfdjEwXzBfZ2Z4X2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQo+PiAgICAg
ICAgICBzdHJ1Y3QgdjEwX2dmeF9tcWQgKm1xZCA9IHJpbmctPm1xZF9wdHI7Cj4+ICAgICAgICAg
IGludCBtcWRfaWR4ID0gcmluZyAtICZhZGV2LT5nZnguZ2Z4X3JpbmdbMF07Cj4+Cj4+IC0gICAg
ICAgaWYgKCFhbWRncHVfaW5fcmVzZXQoYWRldikgJiYgIWFkZXYtPmluX3N1c3BlbmQpIHsKPj4g
KyAgICAgICBpZiAoIWFkZXYtPmluX2dwdV9yZXNldCAmJiAhYWRldi0+aW5fc3VzcGVuZCkgewo+
PiAgICAgICAgICAgICAgICAgIG1lbXNldCgodm9pZCAqKW1xZCwgMCwgc2l6ZW9mKCptcWQpKTsK
Pj4gICAgICAgICAgICAgICAgICBtdXRleF9sb2NrKCZhZGV2LT5zcmJtX211dGV4KTsKPj4gICAg
ICAgICAgICAgICAgICBudl9ncmJtX3NlbGVjdChhZGV2LCByaW5nLT5tZSwgcmluZy0+cGlwZSwg
cmluZy0+cXVldWUsIDApOwo+PiBAQCAtNjIxMyw3ICs2MjEzLDcgQEAgc3RhdGljIGludCBnZnhf
djEwXzBfZ2Z4X2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQo+PiAgICAgICAg
ICAgICAgICAgIG11dGV4X3VubG9jaygmYWRldi0+c3JibV9tdXRleCk7Cj4+ICAgICAgICAgICAg
ICAgICAgaWYgKGFkZXYtPmdmeC5tZS5tcWRfYmFja3VwW21xZF9pZHhdKQo+PiAgICAgICAgICAg
ICAgICAgICAgICAgICAgbWVtY3B5KGFkZXYtPmdmeC5tZS5tcWRfYmFja3VwW21xZF9pZHhdLCBt
cWQsIHNpemVvZigqbXFkKSk7Cj4+IC0gICAgICAgfSBlbHNlIGlmIChhbWRncHVfaW5fcmVzZXQo
YWRldikpIHsKPj4gKyAgICAgICB9IGVsc2UgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkgewo+PiAg
ICAgICAgICAgICAgICAgIC8qIHJlc2V0IG1xZCB3aXRoIHRoZSBiYWNrdXAgY29weSAqLwo+PiAg
ICAgICAgICAgICAgICAgIGlmIChhZGV2LT5nZngubWUubXFkX2JhY2t1cFttcWRfaWR4XSkKPj4g
ICAgICAgICAgICAgICAgICAgICAgICAgIG1lbWNweShtcWQsIGFkZXYtPmdmeC5tZS5tcWRfYmFj
a3VwW21xZF9pZHhdLCBzaXplb2YoKm1xZCkpOwo+PiBAQCAtNjU2Niw3ICs2NTY2LDcgQEAgc3Rh
dGljIGludCBnZnhfdjEwXzBfa2lxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5n
KQo+Pgo+PiAgICAgICAgICBnZnhfdjEwXzBfa2lxX3NldHRpbmcocmluZyk7Cj4+Cj4+IC0gICAg
ICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8K
Pj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KSB7IC8qIGZvciBHUFVfUkVTRVQgY2Fz
ZSAqLwo+PiAgICAgICAgICAgICAgICAgIC8qIHJlc2V0IE1RRCB0byBhIGNsZWFuIHN0YXR1cyAq
Lwo+PiAgICAgICAgICAgICAgICAgIGlmIChhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lk
eF0pCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1jcHkobXFkLCBhZGV2LT5nZngubWVj
Lm1xZF9iYWNrdXBbbXFkX2lkeF0sIHNpemVvZigqbXFkKSk7Cj4+IEBAIC02NjAyLDcgKzY2MDIs
NyBAQCBzdGF0aWMgaW50IGdmeF92MTBfMF9rY3FfaW5pdF9xdWV1ZShzdHJ1Y3QgYW1kZ3B1X3Jp
bmcgKnJpbmcpCj4+ICAgICAgICAgIHN0cnVjdCB2MTBfY29tcHV0ZV9tcWQgKm1xZCA9IHJpbmct
Pm1xZF9wdHI7Cj4+ICAgICAgICAgIGludCBtcWRfaWR4ID0gcmluZyAtICZhZGV2LT5nZnguY29t
cHV0ZV9yaW5nWzBdOwo+Pgo+PiAtICAgICAgIGlmICghYW1kZ3B1X2luX3Jlc2V0KGFkZXYpICYm
ICFhZGV2LT5pbl9zdXNwZW5kKSB7Cj4+ICsgICAgICAgaWYgKCFhZGV2LT5pbl9ncHVfcmVzZXQg
JiYgIWFkZXYtPmluX3N1c3BlbmQpIHsKPj4gICAgICAgICAgICAgICAgICBtZW1zZXQoKHZvaWQg
KiltcWQsIDAsIHNpemVvZigqbXFkKSk7Cj4+ICAgICAgICAgICAgICAgICAgbXV0ZXhfbG9jaygm
YWRldi0+c3JibV9tdXRleCk7Cj4+ICAgICAgICAgICAgICAgICAgbnZfZ3JibV9zZWxlY3QoYWRl
diwgcmluZy0+bWUsIHJpbmctPnBpcGUsIHJpbmctPnF1ZXVlLCAwKTsKPj4gQEAgLTY2MTIsNyAr
NjYxMiw3IEBAIHN0YXRpYyBpbnQgZ2Z4X3YxMF8wX2tjcV9pbml0X3F1ZXVlKHN0cnVjdCBhbWRn
cHVfcmluZyAqcmluZykKPj4KPj4gICAgICAgICAgICAgICAgICBpZiAoYWRldi0+Z2Z4Lm1lYy5t
cWRfYmFja3VwW21xZF9pZHhdKQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtY3B5KGFk
ZXYtPmdmeC5tZWMubXFkX2JhY2t1cFttcWRfaWR4XSwgbXFkLCBzaXplb2YoKm1xZCkpOwo+PiAt
ICAgICAgIH0gZWxzZSBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKSB7IC8qIGZvciBHUFVfUkVT
RVQgY2FzZSAqLwo+PiArICAgICAgIH0gZWxzZSBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KSB7IC8q
IGZvciBHUFVfUkVTRVQgY2FzZSAqLwo+PiAgICAgICAgICAgICAgICAgIC8qIHJlc2V0IE1RRCB0
byBhIGNsZWFuIHN0YXR1cyAqLwo+PiAgICAgICAgICAgICAgICAgIGlmIChhZGV2LT5nZngubWVj
Lm1xZF9iYWNrdXBbbXFkX2lkeF0pCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1jcHko
bXFkLCBhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0sIHNpemVvZigqbXFkKSk7Cj4+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjhfMC5jIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y4XzAuYwo+PiBpbmRleCA3ZGY1NjdhNjY1NmQu
LjE0ZmQwNGI2OTlkYSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
Z2Z4X3Y4XzAuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjhfMC5j
Cj4+IEBAIC00NjMzLDcgKzQ2MzMsNyBAQCBzdGF0aWMgaW50IGdmeF92OF8wX2tpcV9pbml0X3F1
ZXVlKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZykKPj4KPj4gICAgICAgICAgZ2Z4X3Y4XzBfa2lx
X3NldHRpbmcocmluZyk7Cj4+Cj4+IC0gICAgICAgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkg
eyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8KPj4gKyAgICAgICBpZiAoYWRldi0+aW5fZ3B1X3Jl
c2V0KSB7IC8qIGZvciBHUFVfUkVTRVQgY2FzZSAqLwo+PiAgICAgICAgICAgICAgICAgIC8qIHJl
c2V0IE1RRCB0byBhIGNsZWFuIHN0YXR1cyAqLwo+PiAgICAgICAgICAgICAgICAgIGlmIChhZGV2
LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0pCj4+ICAgICAgICAgICAgICAgICAgICAgICAg
ICBtZW1jcHkobXFkLCBhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0sIHNpemVvZihz
dHJ1Y3QgdmlfbXFkX2FsbG9jYXRpb24pKTsKPj4gQEAgLTQ2NzAsNyArNDY3MCw3IEBAIHN0YXRp
YyBpbnQgZ2Z4X3Y4XzBfa2NxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQo+
PiAgICAgICAgICBzdHJ1Y3QgdmlfbXFkICptcWQgPSByaW5nLT5tcWRfcHRyOwo+PiAgICAgICAg
ICBpbnQgbXFkX2lkeCA9IHJpbmcgLSAmYWRldi0+Z2Z4LmNvbXB1dGVfcmluZ1swXTsKPj4KPj4g
LSAgICAgICBpZiAoIWFtZGdwdV9pbl9yZXNldChhZGV2KSAmJiAhYWRldi0+aW5fc3VzcGVuZCkg
ewo+PiArICAgICAgIGlmICghYWRldi0+aW5fZ3B1X3Jlc2V0ICYmICFhZGV2LT5pbl9zdXNwZW5k
KSB7Cj4+ICAgICAgICAgICAgICAgICAgbWVtc2V0KCh2b2lkICopbXFkLCAwLCBzaXplb2Yoc3Ry
dWN0IHZpX21xZF9hbGxvY2F0aW9uKSk7Cj4+ICAgICAgICAgICAgICAgICAgKChzdHJ1Y3Qgdmlf
bXFkX2FsbG9jYXRpb24gKiltcWQpLT5keW5hbWljX2N1X21hc2sgPSAweEZGRkZGRkZGOwo+PiAg
ICAgICAgICAgICAgICAgICgoc3RydWN0IHZpX21xZF9hbGxvY2F0aW9uICopbXFkKS0+ZHluYW1p
Y19yYl9tYXNrID0gMHhGRkZGRkZGRjsKPj4gQEAgLTQ2ODIsNyArNDY4Miw3IEBAIHN0YXRpYyBp
bnQgZ2Z4X3Y4XzBfa2NxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQo+Pgo+
PiAgICAgICAgICAgICAgICAgIGlmIChhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0p
Cj4+ICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1jcHkoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFj
a3VwW21xZF9pZHhdLCBtcWQsIHNpemVvZihzdHJ1Y3QgdmlfbXFkX2FsbG9jYXRpb24pKTsKPj4g
LSAgICAgICB9IGVsc2UgaWYgKGFtZGdwdV9pbl9yZXNldChhZGV2KSkgeyAvKiBmb3IgR1BVX1JF
U0VUIGNhc2UgKi8KPj4gKyAgICAgICB9IGVsc2UgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkgeyAv
KiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8KPj4gICAgICAgICAgICAgICAgICAvKiByZXNldCBNUUQg
dG8gYSBjbGVhbiBzdGF0dXMgKi8KPj4gICAgICAgICAgICAgICAgICBpZiAoYWRldi0+Z2Z4Lm1l
Yy5tcWRfYmFja3VwW21xZF9pZHhdKQo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtY3B5
KG1xZCwgYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdLCBzaXplb2Yoc3RydWN0IHZp
X21xZF9hbGxvY2F0aW9uKSk7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nZnhfdjlfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYwo+
PiBpbmRleCA5M2M2M2ZmM2IzNWUuLjJjNWJiMjgyY2MwMSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9nZnhfdjlfMC5jCj4+IEBAIC0zNjg2LDcgKzM2ODYsNyBAQCBzdGF0aWMgaW50
IGdmeF92OV8wX2tpcV9pbml0X3F1ZXVlKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZykKPj4KPj4g
ICAgICAgICAgZ2Z4X3Y5XzBfa2lxX3NldHRpbmcocmluZyk7Cj4+Cj4+IC0gICAgICAgaWYgKGFt
ZGdwdV9pbl9yZXNldChhZGV2KSkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8KPj4gKyAgICAg
ICBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KSB7IC8qIGZvciBHUFVfUkVTRVQgY2FzZSAqLwo+PiAg
ICAgICAgICAgICAgICAgIC8qIHJlc2V0IE1RRCB0byBhIGNsZWFuIHN0YXR1cyAqLwo+PiAgICAg
ICAgICAgICAgICAgIGlmIChhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0pCj4+ICAg
ICAgICAgICAgICAgICAgICAgICAgICBtZW1jcHkobXFkLCBhZGV2LT5nZngubWVjLm1xZF9iYWNr
dXBbbXFkX2lkeF0sIHNpemVvZihzdHJ1Y3QgdjlfbXFkX2FsbG9jYXRpb24pKTsKPj4gQEAgLTM3
MjQsNyArMzcyNCw3IEBAIHN0YXRpYyBpbnQgZ2Z4X3Y5XzBfa2NxX2luaXRfcXVldWUoc3RydWN0
IGFtZGdwdV9yaW5nICpyaW5nKQo+PiAgICAgICAgICBzdHJ1Y3QgdjlfbXFkICptcWQgPSByaW5n
LT5tcWRfcHRyOwo+PiAgICAgICAgICBpbnQgbXFkX2lkeCA9IHJpbmcgLSAmYWRldi0+Z2Z4LmNv
bXB1dGVfcmluZ1swXTsKPj4KPj4gLSAgICAgICBpZiAoIWFtZGdwdV9pbl9yZXNldChhZGV2KSAm
JiAhYWRldi0+aW5fc3VzcGVuZCkgewo+PiArICAgICAgIGlmICghYWRldi0+aW5fZ3B1X3Jlc2V0
ICYmICFhZGV2LT5pbl9zdXNwZW5kKSB7Cj4+ICAgICAgICAgICAgICAgICAgbWVtc2V0KCh2b2lk
ICopbXFkLCAwLCBzaXplb2Yoc3RydWN0IHY5X21xZF9hbGxvY2F0aW9uKSk7Cj4+ICAgICAgICAg
ICAgICAgICAgKChzdHJ1Y3QgdjlfbXFkX2FsbG9jYXRpb24gKiltcWQpLT5keW5hbWljX2N1X21h
c2sgPSAweEZGRkZGRkZGOwo+PiAgICAgICAgICAgICAgICAgICgoc3RydWN0IHY5X21xZF9hbGxv
Y2F0aW9uICopbXFkKS0+ZHluYW1pY19yYl9tYXNrID0gMHhGRkZGRkZGRjsKPj4gQEAgLTM3MzYs
NyArMzczNiw3IEBAIHN0YXRpYyBpbnQgZ2Z4X3Y5XzBfa2NxX2luaXRfcXVldWUoc3RydWN0IGFt
ZGdwdV9yaW5nICpyaW5nKQo+Pgo+PiAgICAgICAgICAgICAgICAgIGlmIChhZGV2LT5nZngubWVj
Lm1xZF9iYWNrdXBbbXFkX2lkeF0pCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1jcHko
YWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdLCBtcWQsIHNpemVvZihzdHJ1Y3Qgdjlf
bXFkX2FsbG9jYXRpb24pKTsKPj4gLSAgICAgICB9IGVsc2UgaWYgKGFtZGdwdV9pbl9yZXNldChh
ZGV2KSkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8KPj4gKyAgICAgICB9IGVsc2UgaWYgKGFk
ZXYtPmluX2dwdV9yZXNldCkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8KPj4gICAgICAgICAg
ICAgICAgICAvKiByZXNldCBNUUQgdG8gYSBjbGVhbiBzdGF0dXMgKi8KPj4gICAgICAgICAgICAg
ICAgICBpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdKQo+PiAgICAgICAgICAg
ICAgICAgICAgICAgICAgbWVtY3B5KG1xZCwgYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9p
ZHhdLCBzaXplb2Yoc3RydWN0IHY5X21xZF9hbGxvY2F0aW9uKSk7Cj4+IEBAIC0zOTMwLDcgKzM5
MzAsNyBAQCBzdGF0aWMgaW50IGdmeF92OV8wX2h3X2Zpbmkodm9pZCAqaGFuZGxlKQo+PiAgICAg
ICAgICAvKiBVc2UgZGVpbml0aWFsaXplIHNlcXVlbmNlIGZyb20gQ0FJTCB3aGVuIHVuYmluZGlu
ZyBkZXZpY2UgZnJvbSBkcml2ZXIsCj4+ICAgICAgICAgICAqIG90aGVyd2lzZSBLSVEgaXMgaGFu
Z2luZyB3aGVuIGJpbmRpbmcgYmFjawo+PiAgICAgICAgICAgKi8KPj4gLSAgICAgICBpZiAoIWFt
ZGdwdV9pbl9yZXNldChhZGV2KSAmJiAhYWRldi0+aW5fc3VzcGVuZCkgewo+PiArICAgICAgIGlm
ICghYWRldi0+aW5fZ3B1X3Jlc2V0ICYmICFhZGV2LT5pbl9zdXNwZW5kKSB7Cj4+ICAgICAgICAg
ICAgICAgICAgbXV0ZXhfbG9jaygmYWRldi0+c3JibV9tdXRleCk7Cj4+ICAgICAgICAgICAgICAg
ICAgc29jMTVfZ3JibV9zZWxlY3QoYWRldiwgYWRldi0+Z2Z4LmtpcS5yaW5nLm1lLAo+PiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGV2LT5nZngua2lxLnJpbmcucGlwZSwKPj4g
QEAgLTQwODgsNyArNDA4OCw3IEBAIHN0YXRpYyB1aW50NjRfdCBnZnhfdjlfMF9raXFfcmVhZF9j
bG9jayhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPj4gICAgICAgICAgICoKPj4gICAgICAg
ICAgICogYWxzbyBkb24ndCB3YWl0IGFueW1vcmUgZm9yIElSUSBjb250ZXh0Cj4+ICAgICAgICAg
ICAqICovCj4+IC0gICAgICAgaWYgKHIgPCAxICYmIChhbWRncHVfaW5fcmVzZXQoYWRldikgfHwg
aW5faW50ZXJydXB0KCkpKQo+PiArICAgICAgIGlmIChyIDwgMSAmJiAoYWRldi0+aW5fZ3B1X3Jl
c2V0IHx8IGluX2ludGVycnVwdCgpKSkKPj4gICAgICAgICAgICAgICAgICBnb3RvIGZhaWxlZF9r
aXFfcmVhZDsKPj4KPj4gICAgICAgICAgbWlnaHRfc2xlZXAoKTsKPj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvZ21jX3YxMF8wLmMKPj4gaW5kZXggOWQzYjEyNDVhMzM5Li5lYzhjMGFmMzk1NTMg
MTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBfMC5jCj4+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBfMC5jCj4+IEBAIC0yODcs
NyArMjg3LDcgQEAgc3RhdGljIHZvaWQgZ21jX3YxMF8wX2ZsdXNoX2dwdV90bGIoc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYsIHVpbnQzMl90IHZtaWQsCj4+ICAgICAgICAgICAqLwo+PiAgICAg
ICAgICBpZiAoYWRldi0+Z2Z4LmtpcS5yaW5nLnNjaGVkLnJlYWR5ICYmCj4+ICAgICAgICAgICAg
ICAoYW1kZ3B1X3NyaW92X3J1bnRpbWUoYWRldikgfHwgIWFtZGdwdV9zcmlvdl92ZihhZGV2KSkg
JiYKPj4gLSAgICAgICAgICAgIWFtZGdwdV9pbl9yZXNldChhZGV2KSkgewo+PiArICAgICAgICAg
ICAhYWRldi0+aW5fZ3B1X3Jlc2V0KSB7Cj4+Cj4+ICAgICAgICAgICAgICAgICAgc3RydWN0IGFt
ZGdwdV92bWh1YiAqaHViID0gJmFkZXYtPnZtaHViW3ZtaHViXTsKPj4gICAgICAgICAgICAgICAg
ICBjb25zdCB1bnNpZ25lZCBlbmcgPSAxNzsKPj4gQEAgLTMxMiw3ICszMTIsNyBAQCBzdGF0aWMg
dm9pZCBnbWNfdjEwXzBfZmx1c2hfZ3B1X3RsYihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwg
dWludDMyX3Qgdm1pZCwKPj4KPj4gICAgICAgICAgaWYgKCFhZGV2LT5tbWFuLmJ1ZmZlcl9mdW5j
c19lbmFibGVkIHx8Cj4+ICAgICAgICAgICAgICAhYWRldi0+aWJfcG9vbF9yZWFkeSB8fAo+PiAt
ICAgICAgICAgICBhbWRncHVfaW5fcmVzZXQoYWRldikgfHwKPj4gKyAgICAgICAgICAgYWRldi0+
aW5fZ3B1X3Jlc2V0IHx8Cj4+ICAgICAgICAgICAgICByaW5nLT5zY2hlZC5yZWFkeSA9PSBmYWxz
ZSkgewo+PiAgICAgICAgICAgICAgICAgIGdtY192MTBfMF9mbHVzaF92bV9odWIoYWRldiwgdm1p
ZCwgQU1ER1BVX0dGWEhVQl8wLCAwKTsKPj4gICAgICAgICAgICAgICAgICBtdXRleF91bmxvY2so
JmFkZXYtPm1tYW4uZ3R0X3dpbmRvd19sb2NrKTsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2dtY192N18wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9n
bWNfdjdfMC5jCj4+IGluZGV4IDgwYzE0NmRmMzM4YS4uM2NlNWMxZDJmZGYyIDEwMDY0NAo+PiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjdfMC5jCj4+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192N18wLmMKPj4gQEAgLTQzNCw3ICs0MzQsNyBAQCBz
dGF0aWMgaW50IGdtY192N18wX2ZsdXNoX2dwdV90bGJfcGFzaWQoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsCj4+ICAgICAgICAgIGludCB2bWlkOwo+PiAgICAgICAgICB1bnNpZ25lZCBpbnQg
dG1wOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVzZXQoYWRldikpCj4+ICsgICAgICAg
aWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTzsK
Pj4KPj4gICAgICAgICAgZm9yICh2bWlkID0gMTsgdm1pZCA8IDE2OyB2bWlkKyspIHsKPj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OF8wLmMgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjhfMC5jCj4+IGluZGV4IDlhYjY1Y2E3ZGY3Ny4uM2U2
NjE1ZjlkMzljIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNf
djhfMC5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OF8wLmMKPj4g
QEAgLTYzNSw3ICs2MzUsNyBAQCBzdGF0aWMgaW50IGdtY192OF8wX2ZsdXNoX2dwdV90bGJfcGFz
aWQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4+ICAgICAgICAgIGludCB2bWlkOwo+PiAg
ICAgICAgICB1bnNpZ25lZCBpbnQgdG1wOwo+Pgo+PiAtICAgICAgIGlmIChhbWRncHVfaW5fcmVz
ZXQoYWRldikpCj4+ICsgICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gICAgICAgICAg
ICAgICAgICByZXR1cm4gLUVJTzsKPj4KPj4gICAgICAgICAgZm9yICh2bWlkID0gMTsgdm1pZCA8
IDE2OyB2bWlkKyspIHsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2dtY192OV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjlfMC5jCj4+IGlu
ZGV4IDc3M2VlMTFiM2QxNy4uNmE3ODBiNjc0MDE4IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9nbWNfdjlfMC5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2dtY192OV8wLmMKPj4gQEAgLTUwMSw3ICs1MDEsNyBAQCBzdGF0aWMgdm9pZCBnbWNf
djlfMF9mbHVzaF9ncHVfdGxiKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1aW50MzJfdCB2
bWlkLAo+PiAgICAgICAgICAgKi8KPj4gICAgICAgICAgaWYgKGFkZXYtPmdmeC5raXEucmluZy5z
Y2hlZC5yZWFkeSAmJgo+PiAgICAgICAgICAgICAgICAgICAgICAgICAgKGFtZGdwdV9zcmlvdl9y
dW50aW1lKGFkZXYpIHx8ICFhbWRncHVfc3Jpb3ZfdmYoYWRldikpICYmCj4+IC0gICAgICAgICAg
ICAgICAgICAgICAgICFhbWRncHVfaW5fcmVzZXQoYWRldikpIHsKPj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgIWFkZXYtPmluX2dwdV9yZXNldCkgewo+PiAgICAgICAgICAgICAgICAgIHVpbnQz
Ml90IHJlcSA9IGh1Yi0+dm1faW52X2VuZzBfcmVxICsgaHViLT5lbmdfZGlzdGFuY2UgKiBlbmc7
Cj4+ICAgICAgICAgICAgICAgICAgdWludDMyX3QgYWNrID0gaHViLT52bV9pbnZfZW5nMF9hY2sg
KyBodWItPmVuZ19kaXN0YW5jZSAqIGVuZzsKPj4KPj4gQEAgLTU5Niw3ICs1OTYsNyBAQCBzdGF0
aWMgaW50IGdtY192OV8wX2ZsdXNoX2dwdV90bGJfcGFzaWQoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYsCj4+ICAgICAgICAgIHN0cnVjdCBhbWRncHVfcmluZyAqcmluZyA9ICZhZGV2LT5nZngu
a2lxLnJpbmc7Cj4+ICAgICAgICAgIHN0cnVjdCBhbWRncHVfa2lxICpraXEgPSAmYWRldi0+Z2Z4
LmtpcTsKPj4KPj4gLSAgICAgICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQo+PiArICAgICAg
IGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU87
Cj4+Cj4+ICAgICAgICAgIGlmIChyaW5nLT5zY2hlZC5yZWFkeSkgewo+PiBAQCAtNjMzLDggKzYz
Myw3IEBAIHN0YXRpYyBpbnQgZ21jX3Y5XzBfZmx1c2hfZ3B1X3RsYl9wYXNpZChzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiwKPj4gICAgICAgICAgICAgICAgICBzcGluX3VubG9jaygmYWRldi0+
Z2Z4LmtpcS5yaW5nX2xvY2spOwo+PiAgICAgICAgICAgICAgICAgIHIgPSBhbWRncHVfZmVuY2Vf
d2FpdF9wb2xsaW5nKHJpbmcsIHNlcSwgYWRldi0+dXNlY190aW1lb3V0KTsKPj4gICAgICAgICAg
ICAgICAgICBpZiAociA8IDEpIHsKPj4gLSAgICAgICAgICAgICAgICAgICAgICAgZGV2X2luZm8o
YWRldi0+ZGV2LAo+PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3YWl0IGZvciBr
aXEgZmVuY2UgZXJyb3I6ICVsZFxuIiwgcik7Cj4+ICsgICAgICAgICAgICAgICAgICAgICAgIERS
TV9FUlJPUigid2FpdCBmb3Iga2lxIGZlbmNlIGVycm9yOiAlbGQuXG4iLCByKTsKPj4gICAgICAg
ICAgICAgICAgICAgICAgICAgIHJldHVybiAtRVRJTUU7Cj4+ICAgICAgICAgICAgICAgICAgfQo+
Pgo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbXhncHVfYWkuYyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X2FpLmMKPj4gaW5kZXggZmUzMWNiZWNj
ZmU5Li41ZmQ2N2UxY2MyYTAgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L214Z3B1X2FpLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbXhncHVf
YWkuYwo+PiBAQCAtMjM4LDE2ICsyMzgsMjAgQEAgc3RhdGljIHZvaWQgeGdwdV9haV9tYWlsYm94
X2Zscl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPj4gICAgICAgICAgc3RydWN0IGFt
ZGdwdV92aXJ0ICp2aXJ0ID0gY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBhbWRncHVfdmlydCwg
ZmxyX3dvcmspOwo+PiAgICAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGNvbnRh
aW5lcl9vZih2aXJ0LCBzdHJ1Y3QgYW1kZ3B1X2RldmljZSwgdmlydCk7Cj4+ICAgICAgICAgIGlu
dCB0aW1lb3V0ID0gQUlfTUFJTEJPWF9QT0xMX0ZMUl9USU1FRE9VVDsKPj4gKyAgICAgICBpbnQg
bG9ja2VkOwo+Pgo+PiAgICAgICAgICAvKiBibG9jayBhbWRncHVfZ3B1X3JlY292ZXIgdGlsbCBt
c2cgRkxSIENPTVBMRVRFIHJlY2VpdmVkLAo+PiAgICAgICAgICAgKiBvdGhlcndpc2UgdGhlIG1h
aWxib3ggbXNnIHdpbGwgYmUgcnVpbmVkL3Jlc2V0ZWQgYnkKPj4gICAgICAgICAgICogdGhlIFZG
IEZMUi4KPj4gICAgICAgICAgICoKPj4gLSAgICAgICAgKiB3ZSBjYW4gdW5sb2NrIHRoZSByZXNl
dF9zZW0gdG8gYWxsb3cgImFtZGdwdV9qb2JfdGltZWRvdXQiCj4+ICsgICAgICAgICogd2UgY2Fu
IHVubG9jayB0aGUgbG9ja19yZXNldCB0byBhbGxvdyAiYW1kZ3B1X2pvYl90aW1lZG91dCIKPj4g
ICAgICAgICAgICogdG8gcnVuIGdwdV9yZWNvdmVyKCkgYWZ0ZXIgRkxSX05PVElGSUNBVElPTl9D
TVBMIHJlY2VpdmVkCj4+ICAgICAgICAgICAqIHdoaWNoIG1lYW5zIGhvc3Qgc2lkZSBoYWQgZmlu
aXNoZWQgdGhpcyBWRidzIEZMUi4KPj4gICAgICAgICAgICovCj4+IC0gICAgICAgZG93bl9yZWFk
KCZhZGV2LT5yZXNldF9zZW0pOwo+PiArICAgICAgIGxvY2tlZCA9IG11dGV4X3RyeWxvY2soJmFk
ZXYtPmxvY2tfcmVzZXQpOwo+PiArICAgICAgIGlmIChsb2NrZWQpCj4+ICsgICAgICAgICAgICAg
ICBhZGV2LT5pbl9ncHVfcmVzZXQgPSB0cnVlOwo+PiArCj4+ICAgICAgICAgIGRvIHsKPj4gICAg
ICAgICAgICAgICAgICBpZiAoeGdwdV9haV9tYWlsYm94X3BlZWtfbXNnKGFkZXYpID09IElESF9G
TFJfTk9USUZJQ0FUSU9OX0NNUEwpCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGZs
cl9kb25lOwo+PiBAQCAtMjU3LDcgKzI2MSwxMCBAQCBzdGF0aWMgdm9pZCB4Z3B1X2FpX21haWxi
b3hfZmxyX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+PiAgICAgICAgICB9IHdoaWxl
ICh0aW1lb3V0ID4gMSk7Cj4+Cj4+ICAgZmxyX2RvbmU6Cj4+IC0gICAgICAgdXBfcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPj4gKyAgICAgICBpZiAobG9ja2VkKSB7Cj4+ICsgICAgICAgICAgICAg
ICBhZGV2LT5pbl9ncHVfcmVzZXQgPSBmYWxzZTsKPj4gKyAgICAgICAgICAgICAgIG11dGV4X3Vu
bG9jaygmYWRldi0+bG9ja19yZXNldCk7Cj4+ICsgICAgICAgfQo+Pgo+PiAgICAgICAgICAvKiBU
cmlnZ2VyIHJlY292ZXJ5IGZvciB3b3JsZCBzd2l0Y2ggZmFpbHVyZSBpZiBubyBURFIgKi8KPj4g
ICAgICAgICAgaWYgKGFtZGdwdV9kZXZpY2Vfc2hvdWxkX3JlY292ZXJfZ3B1KGFkZXYpCj4+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9teGdwdV9udi5jIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvbXhncHVfbnYuYwo+PiBpbmRleCA2ZjU1MTcyZTgzMzcuLmNl
MmJmMWZiNzllZCAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbXhn
cHVfbnYuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9teGdwdV9udi5jCj4+
IEBAIC0yNTksMTYgKzI1OSwyMCBAQCBzdGF0aWMgdm9pZCB4Z3B1X252X21haWxib3hfZmxyX3dv
cmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+PiAgICAgICAgICBzdHJ1Y3QgYW1kZ3B1X3Zp
cnQgKnZpcnQgPSBjb250YWluZXJfb2Yod29yaywgc3RydWN0IGFtZGdwdV92aXJ0LCBmbHJfd29y
ayk7Cj4+ICAgICAgICAgIHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gY29udGFpbmVyX29m
KHZpcnQsIHN0cnVjdCBhbWRncHVfZGV2aWNlLCB2aXJ0KTsKPj4gICAgICAgICAgaW50IHRpbWVv
dXQgPSBOVl9NQUlMQk9YX1BPTExfRkxSX1RJTUVET1VUOwo+PiArICAgICAgIGludCBsb2NrZWQ7
Cj4+Cj4+ICAgICAgICAgIC8qIGJsb2NrIGFtZGdwdV9ncHVfcmVjb3ZlciB0aWxsIG1zZyBGTFIg
Q09NUExFVEUgcmVjZWl2ZWQsCj4+ICAgICAgICAgICAqIG90aGVyd2lzZSB0aGUgbWFpbGJveCBt
c2cgd2lsbCBiZSBydWluZWQvcmVzZXRlZCBieQo+PiAgICAgICAgICAgKiB0aGUgVkYgRkxSLgo+
PiAgICAgICAgICAgKgo+PiAtICAgICAgICAqIHdlIGNhbiB1bmxvY2sgdGhlIHJlc2V0X3NlbSB0
byBhbGxvdyAiYW1kZ3B1X2pvYl90aW1lZG91dCIKPj4gKyAgICAgICAgKiB3ZSBjYW4gdW5sb2Nr
IHRoZSBsb2NrX3Jlc2V0IHRvIGFsbG93ICJhbWRncHVfam9iX3RpbWVkb3V0Igo+PiAgICAgICAg
ICAgKiB0byBydW4gZ3B1X3JlY292ZXIoKSBhZnRlciBGTFJfTk9USUZJQ0FUSU9OX0NNUEwgcmVj
ZWl2ZWQKPj4gICAgICAgICAgICogd2hpY2ggbWVhbnMgaG9zdCBzaWRlIGhhZCBmaW5pc2hlZCB0
aGlzIFZGJ3MgRkxSLgo+PiAgICAgICAgICAgKi8KPj4gLSAgICAgICBkb3duX3JlYWQoJmFkZXYt
PnJlc2V0X3NlbSk7Cj4+ICsgICAgICAgbG9ja2VkID0gbXV0ZXhfdHJ5bG9jaygmYWRldi0+bG9j
a19yZXNldCk7Cj4+ICsgICAgICAgaWYgKGxvY2tlZCkKPj4gKyAgICAgICAgICAgICAgIGFkZXYt
PmluX2dwdV9yZXNldCA9IHRydWU7Cj4+ICsKPj4gICAgICAgICAgZG8gewo+PiAgICAgICAgICAg
ICAgICAgIGlmICh4Z3B1X252X21haWxib3hfcGVla19tc2coYWRldikgPT0gSURIX0ZMUl9OT1RJ
RklDQVRJT05fQ01QTCkKPj4gICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZmxyX2RvbmU7
Cj4+IEBAIC0yNzgsNyArMjgyLDEwIEBAIHN0YXRpYyB2b2lkIHhncHVfbnZfbWFpbGJveF9mbHJf
d29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4+ICAgICAgICAgIH0gd2hpbGUgKHRpbWVv
dXQgPiAxKTsKPj4KPj4gICBmbHJfZG9uZToKPj4gLSAgICAgICB1cF9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOwo+PiArICAgICAgIGlmIChsb2NrZWQpIHsKPj4gKyAgICAgICAgICAgICAgIGFkZXYt
PmluX2dwdV9yZXNldCA9IGZhbHNlOwo+PiArICAgICAgICAgICAgICAgbXV0ZXhfdW5sb2NrKCZh
ZGV2LT5sb2NrX3Jlc2V0KTsKPj4gKyAgICAgICB9Cj4+Cj4+ICAgICAgICAgIC8qIFRyaWdnZXIg
cmVjb3ZlcnkgZm9yIHdvcmxkIHN3aXRjaCBmYWlsdXJlIGlmIG5vIFREUiAqLwo+PiAgICAgICAg
ICBpZiAoYW1kZ3B1X2RldmljZV9zaG91bGRfcmVjb3Zlcl9ncHUoYWRldikKPj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5j
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmMK
Pj4gaW5kZXggN2FkMTUzNzgyMGI1Li5lMGU2MGIwZDA2NjkgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5jCj4+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5jCj4+
IEBAIC0zMDQsMTcgKzMwNCwxNSBAQCBzdGF0aWMgdm9pZCBkZWFsbG9jYXRlX3ZtaWQoc3RydWN0
IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0sCj4+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBxY21fcHJvY2Vzc19kZXZpY2UgKnFwZCwKPj4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHF1ZXVlICpxKQo+PiAgIHsKPj4gLSAgICAgICBpZiAo
IWRxbS0+aXNfcmVzZXR0aW5nKSB7Cj4+IC0gICAgICAgICAgICAgICAvKiBPbiBHRlggdjcsIENQ
IGRvZXNuJ3QgZmx1c2ggVEMgYXQgZGVxdWV1ZSAqLwo+PiAtICAgICAgICAgICAgICAgaWYgKHEt
PmRldmljZS0+ZGV2aWNlX2luZm8tPmFzaWNfZmFtaWx5ID09IENISVBfSEFXQUlJKQo+PiAtICAg
ICAgICAgICAgICAgICAgICAgICBpZiAoZmx1c2hfdGV4dHVyZV9jYWNoZV9ub2Nwc2NoKHEtPmRl
dmljZSwgcXBkKSkKPj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcl9lcnIoIkZh
aWxlZCB0byBmbHVzaCBUQ1xuIik7Cj4+ICsgICAgICAgLyogT24gR0ZYIHY3LCBDUCBkb2Vzbid0
IGZsdXNoIFRDIGF0IGRlcXVldWUgKi8KPj4gKyAgICAgICBpZiAocS0+ZGV2aWNlLT5kZXZpY2Vf
aW5mby0+YXNpY19mYW1pbHkgPT0gQ0hJUF9IQVdBSUkpCj4+ICsgICAgICAgICAgICAgICBpZiAo
Zmx1c2hfdGV4dHVyZV9jYWNoZV9ub2Nwc2NoKHEtPmRldmljZSwgcXBkKSkKPj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgcHJfZXJyKCJGYWlsZWQgdG8gZmx1c2ggVENcbiIpOwo+Pgo+PiAtICAg
ICAgICAgICAgICAga2ZkX2ZsdXNoX3RsYihxcGRfdG9fcGRkKHFwZCkpOwo+PiArICAgICAgIGtm
ZF9mbHVzaF90bGIocXBkX3RvX3BkZChxcGQpKTsKPj4KPj4gLSAgICAgICAgICAgICAgIC8qIFJl
bGVhc2UgdGhlIHZtaWQgbWFwcGluZyAqLwo+PiAtICAgICAgICAgICAgICAgc2V0X3Bhc2lkX3Zt
aWRfbWFwcGluZyhkcW0sIDAsIHFwZC0+dm1pZCk7Cj4+IC0gICAgICAgfQo+PiArICAgICAgIC8q
IFJlbGVhc2UgdGhlIHZtaWQgbWFwcGluZyAqLwo+PiArICAgICAgIHNldF9wYXNpZF92bWlkX21h
cHBpbmcoZHFtLCAwLCBxcGQtPnZtaWQpOwo+PiAgICAgICAgICBkcW0tPnZtaWRfcGFzaWRbcXBk
LT52bWlkXSA9IDA7Cj4+Cj4+ICAgICAgICAgIHFwZC0+dm1pZCA9IDA7Cj4+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfcHJvY2Vzcy5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRrZmQva2ZkX3Byb2Nlc3MuYwo+PiBpbmRleCA3MWJlODk3ZDRjMmEuLjAxM2My
YjAxOGVkYyAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX3By
b2Nlc3MuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfcHJvY2Vzcy5j
Cj4+IEBAIC0xNTUxLDEwICsxNTUxLDYgQEAgaW50IGtmZF9yZXNlcnZlZF9tZW1fbW1hcChzdHJ1
Y3Qga2ZkX2RldiAqZGV2LCBzdHJ1Y3Qga2ZkX3Byb2Nlc3MgKnByb2Nlc3MsCj4+ICAgdm9pZCBr
ZmRfZmx1c2hfdGxiKHN0cnVjdCBrZmRfcHJvY2Vzc19kZXZpY2UgKnBkZCkKPj4gICB7Cj4+ICAg
ICAgICAgIHN0cnVjdCBrZmRfZGV2ICpkZXYgPSBwZGQtPmRldjsKPj4gLSAgICAgICBzdHJ1Y3Qg
ZGV2aWNlX3F1ZXVlX21hbmFnZXIgKmRxbSA9IGRldi0+ZHFtOwo+PiAtCj4+IC0gICAgICAgaWYg
KGRxbS0+aXNfcmVzZXR0aW5nKQo+PiAtICAgICAgICAgICAgICAgcmV0dXJuOwo+Pgo+PiAgICAg
ICAgICBpZiAoZGV2LT5kcW0tPnNjaGVkX3BvbGljeSA9PSBLRkRfU0NIRURfUE9MSUNZX05PX0hX
Uykgewo+PiAgICAgICAgICAgICAgICAgIC8qIE5vdGhpbmcgdG8gZmx1c2ggdW50aWwgYSBWTUlE
IGlzIGFzc2lnbmVkLCB3aGljaAo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9hbWRncHVfZG0vYW1kZ3B1X2RtLmMKPj4gaW5kZXggZmY1ZjdmN2NlZWM2Li5jNGRhYTIyOTA0
ZGEgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0v
YW1kZ3B1X2RtLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9k
bS9hbWRncHVfZG0uYwo+PiBAQCAtMTY1OCw3ICsxNjU4LDcgQEAgc3RhdGljIGludCBkbV9zdXNw
ZW5kKHZvaWQgKmhhbmRsZSkKPj4gICAgICAgICAgc3RydWN0IGFtZGdwdV9kaXNwbGF5X21hbmFn
ZXIgKmRtID0gJmFkZXYtPmRtOwo+PiAgICAgICAgICBpbnQgcmV0ID0gMDsKPj4KPj4gLSAgICAg
ICBpZiAoYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKSB7Cj4+ICsgICAgICAgaWYgKGFkZXYtPmluX2dw
dV9yZXNldCkgewo+PiAgICAgICAgICAgICAgICAgIG11dGV4X2xvY2soJmRtLT5kY19sb2NrKTsK
Pj4gICAgICAgICAgICAgICAgICBkbS0+Y2FjaGVkX2RjX3N0YXRlID0gZGNfY29weV9zdGF0ZShk
bS0+ZGMtPmN1cnJlbnRfc3RhdGUpOwo+Pgo+PiBAQCAtMTg0NCw3ICsxODQ0LDcgQEAgc3RhdGlj
IGludCBkbV9yZXN1bWUodm9pZCAqaGFuZGxlKQo+PiAgICAgICAgICBzdHJ1Y3QgZGNfc3RhdGUg
KmRjX3N0YXRlOwo+PiAgICAgICAgICBpbnQgaSwgciwgajsKPj4KPj4gLSAgICAgICBpZiAoYW1k
Z3B1X2luX3Jlc2V0KGFkZXYpKSB7Cj4+ICsgICAgICAgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkg
ewo+PiAgICAgICAgICAgICAgICAgIGRjX3N0YXRlID0gZG0tPmNhY2hlZF9kY19zdGF0ZTsKPj4K
Pj4gICAgICAgICAgICAgICAgICByID0gZG1fZG11Yl9od19pbml0KGFkZXYpOwo+PiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jCj4+IGluZGV4IDFmZmFjYzcxMmU1
My4uYzhlMzBkNTllNjU4IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2Vy
cGxheS9hbWRncHVfc211LmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkv
YW1kZ3B1X3NtdS5jCj4+IEBAIC0xMTEwLDcgKzExMTAsNyBAQCBzdGF0aWMgaW50IHNtdV9kaXNh
YmxlX2RwbXMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCj4+ICAgICAgICAgIHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2ID0gc211LT5hZGV2Owo+PiAgICAgICAgICBpbnQgcmV0ID0gMDsKPj4g
ICAgICAgICAgYm9vbCB1c2VfYmFjbyA9ICFzbXUtPmlzX2FwdSAmJgo+PiAtICAgICAgICAgICAg
ICAgKChhbWRncHVfaW5fcmVzZXQoYWRldikgJiYKPj4gKyAgICAgICAgICAgICAgICgoYWRldi0+
aW5fZ3B1X3Jlc2V0ICYmCj4+ICAgICAgICAgICAgICAgICAgICAoYW1kZ3B1X2FzaWNfcmVzZXRf
bWV0aG9kKGFkZXYpID09IEFNRF9SRVNFVF9NRVRIT0RfQkFDTykpIHx8Cj4+ICAgICAgICAgICAg
ICAgICAgICgoYWRldi0+aW5fcnVucG0gfHwgYWRldi0+aW5faGliZXJuYXRlKSAmJiBhbWRncHVf
YXNpY19zdXBwb3J0c19iYWNvKGFkZXYpKSk7Cj4+Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL3Bvd2VycGxheS9od21nci92ZWdhMjBfaHdtZ3IuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvcG93ZXJwbGF5L2h3bWdyL3ZlZ2EyMF9od21nci5jCj4+IGluZGV4IGRhODQwMTJiN2Zk
NS4uYzcyMTYzNjJiNjhkIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2Vy
cGxheS9od21nci92ZWdhMjBfaHdtZ3IuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bv
d2VycGxheS9od21nci92ZWdhMjBfaHdtZ3IuYwo+PiBAQCAtNDg5LDcgKzQ4OSw3IEBAIHN0YXRp
YyBpbnQgdmVnYTIwX3NldHVwX2FzaWNfdGFzayhzdHJ1Y3QgcHBfaHdtZ3IgKmh3bWdyKQo+PiAg
IHsKPj4gICAgICAgICAgc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKikoaHdtZ3ItPmFkZXYpOwo+PiAgICAgICAgICBpbnQgcmV0ID0gMDsKPj4gLSAg
ICAgICBib29sIHVzZV9iYWNvID0gKGFtZGdwdV9pbl9yZXNldChhZGV2KSAmJgo+PiArICAgICAg
IGJvb2wgdXNlX2JhY28gPSAoYWRldi0+aW5fZ3B1X3Jlc2V0ICYmCj4+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKGFtZGdwdV9hc2ljX3Jlc2V0X21ldGhvZChhZGV2KSA9PSBBTURfUkVTRVRf
TUVUSE9EX0JBQ08pKSB8fAo+PiAgICAgICAgICAgICAgICAgIChhZGV2LT5pbl9ydW5wbSAmJiBh
bWRncHVfYXNpY19zdXBwb3J0c19iYWNvKGFkZXYpKTsKPj4KPj4gLS0KPj4gMi4xNy4xCj4+Cj4+
IF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4+IGFtZC1n
ZnggbWFpbGluZyBsaXN0Cj4+IGFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4+IGh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeAoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5n
IGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4Cg==
