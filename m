Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DB85E48F94
	for <lists+amd-gfx@lfdr.de>; Mon, 17 Jun 2019 21:32:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 02C3289D4A;
	Mon, 17 Jun 2019 19:32:36 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qt1-x844.google.com (mail-qt1-x844.google.com
 [IPv6:2607:f8b0:4864:20::844])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BD64389D4A
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:32:33 +0000 (UTC)
Received: by mail-qt1-x844.google.com with SMTP id m29so12269401qtu.1
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 12:32:33 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=SXoOaKym3hk10AcMCREvxQnVbvFIpuv3HDT0o9sGaQQ=;
 b=QJJ4A4mo830doVLs57WIlYWxTv2kpDN6PCGd5RWj0AG1lfkLbzMCrakmuNpQw/NkCJ
 6P8L/3XQvck0x4mVcEw4ES1K4rDD+8034OjCUL8evoLLD2Zcnxz1Z/c73THEtnZHKwQf
 Nxnw9kjm4TjNLfUKiHt+8YWncREJMkB/pD0cY/v5K0LzH5rqRDuTMvBHx6X5MkYhaI7p
 AnWuYLN9lhGZWWbIhM1nmQYn8bSXVdJ9sDObliqLyul7BglXCMJGKGv834tVie5fVKDe
 FQUZfKIoNS2fVW7LpL6sOP3Os5FAu9NuHYh43l+Z1vodJYoOcRWJNq8kfqp12j32zGbJ
 4pFQ==
X-Gm-Message-State: APjAAAU/rSFwMgKx3mrJWSEAtdScRfJ8GIjau+sN8SUnrGIaRhZpGg0M
 LdV3MHaqB6lIRPwnqTs7uHijHCGD228=
X-Google-Smtp-Source: APXvYqyOxFnUo9bYc4She0Grg5R0T+ZVoJS8cmi0y5IB7Pgmk+Hxds3OHPZheDPOqQ+CiWcxQOEtFQ==
X-Received: by 2002:aed:3e3d:: with SMTP id l58mr46706154qtf.382.1560799952133; 
 Mon, 17 Jun 2019 12:32:32 -0700 (PDT)
Received: from localhost.localdomain ([71.219.5.136])
 by smtp.gmail.com with ESMTPSA id u2sm7474875qtj.97.2019.06.17.12.32.31
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 12:32:31 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 287/459] drm/amd/powerplay: simplified od_settings for each
 asic
Date: Mon, 17 Jun 2019 14:30:54 -0500
Message-Id: <20190617193106.18231-88-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617193106.18231-1-alexander.deucher@amd.com>
References: <20190617193106.18231-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=SXoOaKym3hk10AcMCREvxQnVbvFIpuv3HDT0o9sGaQQ=;
 b=nmN1alk5JXJHlaUGh5QgXVb9LyVIQmj87N6Lp2c3U5LK+ESs4ntjswldCdlpksOWYH
 NLhcmhVXL1l1Uac6BYoD9/Rf1eQ+cxtcVvpZc7M3TSbX3kJkQu/nRa64KxVjR3Mm7vby
 noRXjik//aaS90BJ4/QAJ4IfHX6BK9EheEvLzJ7HFJXVzYWsU4/83iqd+RSvwxpMDeag
 hi8t/Y1YeX4X/5K4dxNKCBh2wQxZhFpYb7jqbDZidm7P7ZQI4eLO60F1ihj5rDmxTiKN
 1y8zkTLZ46xpMnVbX4EYhgaxaahTRz6DuGTBgqpgqBv60oYwb8BLTyenWKNAl8y4Pj7d
 tGuw==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>, Kevin Wang <kevin1.wang@amd.com>,
 Huang Rui <ray.huang@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogS2V2aW4gV2FuZyA8a2V2aW4xLndhbmdAYW1kLmNvbT4KCnRoZSBvZF9zZXR0aW5ncyBp
cyBhc2ljIHJlbGF0ZWQgZGF0YSwgc28gbW92ZSBpdCB0byBhc2ljIGZpbGUuCgpTaWduZWQtb2Zm
LWJ5OiBLZXZpbiBXYW5nIDxrZXZpbjEud2FuZ0BhbWQuY29tPgpSZXZpZXdlZC1ieTogSHVhbmcg
UnVpIDxyYXkuaHVhbmdAYW1kLmNvbT4KU2lnbmVkLW9mZi1ieTogQWxleCBEZXVjaGVyIDxhbGV4
YW5kZXIuZGV1Y2hlckBhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5
L2FtZGdwdV9zbXUuYyAgICB8ICAxMiAtLQogLi4uL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMv
YW1kZ3B1X3NtdS5oICAgIHwgICA3ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92
ZWdhMjBfcHB0LmMgICAgfCAxMzkgKysrKysrKysrLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0v
YW1kL3Bvd2VycGxheS92ZWdhMjBfcHB0LmggICAgfCAgIDYgKwogNCBmaWxlcyBjaGFuZ2VkLCA3
NyBpbnNlcnRpb25zKCspLCA4NyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL3Bvd2VycGxheS9hbWRncHVfc211LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bv
d2VycGxheS9hbWRncHVfc211LmMKaW5kZXggYTAxYWNlMWJkYTM0Li5lZGQxZGE2OGM0N2QgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2FtZGdwdV9zbXUuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9hbWRncHVfc211LmMKQEAgLTEwNTgsMjEg
KzEwNTgsOSBAQCBzdGF0aWMgaW50IHNtdV9od19maW5pKHZvaWQgKmhhbmRsZSkKIAlrZnJlZSh0
YWJsZV9jb250ZXh0LT5tYXhfc3VzdGFpbmFibGVfY2xvY2tzKTsKIAl0YWJsZV9jb250ZXh0LT5t
YXhfc3VzdGFpbmFibGVfY2xvY2tzID0gTlVMTDsKIAotCWtmcmVlKHRhYmxlX2NvbnRleHQtPm9k
X2ZlYXR1cmVfY2FwYWJpbGl0aWVzKTsKLQl0YWJsZV9jb250ZXh0LT5vZF9mZWF0dXJlX2NhcGFi
aWxpdGllcyA9IE5VTEw7Ci0KLQlrZnJlZSh0YWJsZV9jb250ZXh0LT5vZF9zZXR0aW5nc19tYXgp
OwotCXRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21heCA9IE5VTEw7Ci0KLQlrZnJlZSh0YWJs
ZV9jb250ZXh0LT5vZF9zZXR0aW5nc19taW4pOwotCXRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdz
X21pbiA9IE5VTEw7Ci0KIAlrZnJlZSh0YWJsZV9jb250ZXh0LT5vdmVyZHJpdmVfdGFibGUpOwog
CXRhYmxlX2NvbnRleHQtPm92ZXJkcml2ZV90YWJsZSA9IE5VTEw7CiAKLQlrZnJlZSh0YWJsZV9j
b250ZXh0LT5vZDhfc2V0dGluZ3MpOwotCXRhYmxlX2NvbnRleHQtPm9kOF9zZXR0aW5ncyA9IE5V
TEw7Ci0KIAlrZnJlZShzbXUtPmlycV9zb3VyY2UpOwogCXNtdS0+aXJxX3NvdXJjZSA9IE5VTEw7
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2luYy9hbWRncHVf
c211LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMvYW1kZ3B1X3NtdS5oCmlu
ZGV4IDgyYzJjMDIzNDdhYy4uYThlNWY0ZDY5ODYxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL3Bvd2VycGxheS9pbmMvYW1kZ3B1X3NtdS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvcG93ZXJwbGF5L2luYy9hbWRncHVfc211LmgKQEAgLTQzMSwxMyArNDMxLDcgQEAgc3RydWN0
IHNtdV90YWJsZV9jb250ZXh0CiAJdWludDhfdCAgICAgICAgICAgICAgICAgICAgICAgICB0aGVy
bWFsX2NvbnRyb2xsZXJfdHlwZTsKIAl1aW50MTZfdAkJCVREUE9ETGltaXQ7CiAKLQl1aW50OF90
CQkJCSpvZF9mZWF0dXJlX2NhcGFiaWxpdGllczsKLQl1aW50MzJfdAkJCSpvZF9zZXR0aW5nc19t
YXg7Ci0JdWludDMyX3QJCQkqb2Rfc2V0dGluZ3NfbWluOwogCXZvaWQJCQkJKm92ZXJkcml2ZV90
YWJsZTsKLQl2b2lkCQkJCSpvZDhfc2V0dGluZ3M7Ci0JYm9vbAkJCQlvZF9nZnhjbGtfdXBkYXRl
OwotCWJvb2wJCQkJb2RfbWVtY2xrX3VwZGF0ZTsKIH07CiAKIHN0cnVjdCBzbXVfZHBtX2NvbnRl
eHQgewpAQCAtNTEwLDYgKzUwNCw3IEBAIHN0cnVjdCBzbXVfY29udGV4dAogCXN0cnVjdCBzbXVf
cG93ZXJfY29udGV4dAlzbXVfcG93ZXI7CiAJc3RydWN0IHNtdV9mZWF0dXJlCQlzbXVfZmVhdHVy
ZTsKIAlzdHJ1Y3QgYW1kX3BwX2Rpc3BsYXlfY29uZmlndXJhdGlvbiAgKmRpc3BsYXlfY29uZmln
OworCXZvaWQgKm9kX3NldHRpbmdzOwogCiAJdWludDMyX3QgcHN0YXRlX3NjbGs7CiAJdWludDMy
X3QgcHN0YXRlX21jbGs7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxh
eS92ZWdhMjBfcHB0LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92ZWdhMjBfcHB0
LmMKaW5kZXggNDNmOWUyYWNiOGU2Li41MTRlNDA5NzlmMTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvcG93ZXJwbGF5L3ZlZ2EyMF9wcHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL3Bvd2VycGxheS92ZWdhMjBfcHB0LmMKQEAgLTM2NSw2ICszNjUsNyBAQCBzdGF0aWMgaW50
IHZlZ2EyMF9zZXR1cF9vZDhfaW5mb3JtYXRpb24oc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCiB7
CiAJQVRPTV9WZWdhMjBfUE9XRVJQTEFZVEFCTEUgKnBvd2VycGxheV90YWJsZSA9IE5VTEw7CiAJ
c3RydWN0IHNtdV90YWJsZV9jb250ZXh0ICp0YWJsZV9jb250ZXh0ID0gJnNtdS0+c211X3RhYmxl
OworCXN0cnVjdCB2ZWdhMjBfb2Q4X3NldHRpbmdzICpvZDhfc2V0dGluZ3MgPSAoc3RydWN0IHZl
Z2EyMF9vZDhfc2V0dGluZ3MgKilzbXUtPm9kX3NldHRpbmdzOwogCiAJdWludDMyX3Qgb2RfZmVh
dHVyZV9jb3VudCwgb2RfZmVhdHVyZV9hcnJheV9zaXplLAogCQkgb2Rfc2V0dGluZ19jb3VudCwg
b2Rfc2V0dGluZ19hcnJheV9zaXplOwpAQCAtMzg1LDEzICszODYsMTMgQEAgc3RhdGljIGludCB2
ZWdhMjBfc2V0dXBfb2Q4X2luZm9ybWF0aW9uKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQogCiAJ
CW9kX2ZlYXR1cmVfYXJyYXlfc2l6ZSA9IHNpemVvZih1aW50OF90KSAqIG9kX2ZlYXR1cmVfY291
bnQ7CiAKLQkJaWYgKHRhYmxlX2NvbnRleHQtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzKQorCQlp
ZiAob2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllcykKIAkJCXJldHVybiAtRUlO
VkFMOwogCi0JCXRhYmxlX2NvbnRleHQtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzID0ga21lbWR1
cCgmcG93ZXJwbGF5X3RhYmxlLT5PdmVyRHJpdmU4VGFibGUuT0RGZWF0dXJlQ2FwYWJpbGl0aWVz
LAorCQlvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzID0ga21lbWR1cCgmcG93
ZXJwbGF5X3RhYmxlLT5PdmVyRHJpdmU4VGFibGUuT0RGZWF0dXJlQ2FwYWJpbGl0aWVzLAogCQkJ
CQkJCQkgb2RfZmVhdHVyZV9hcnJheV9zaXplLAogCQkJCQkJCQkgR0ZQX0tFUk5FTCk7Ci0JCWlm
ICghdGFibGVfY29udGV4dC0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXMpCisJCWlmICghb2Q4X3Nl
dHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllcykKIAkJCXJldHVybiAtRU5PTUVNOwogCiAJ
CS8qIFNldHVwIGNvcnJlY3QgT0RTZXR0aW5nQ291bnQsIGFuZCBzdG9yZSBPRFNldHRpbmdBcnJh
eSBmcm9tCkBAIC00MDQsMzEgKzQwNSwzMSBAQCBzdGF0aWMgaW50IHZlZ2EyMF9zZXR1cF9vZDhf
aW5mb3JtYXRpb24oc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCiAKIAkJb2Rfc2V0dGluZ19hcnJh
eV9zaXplID0gc2l6ZW9mKHVpbnQzMl90KSAqIG9kX3NldHRpbmdfY291bnQ7CiAKLQkJaWYgKHRh
YmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21heCkKKwkJaWYgKG9kOF9zZXR0aW5ncy0+b2Rfc2V0
dGluZ3NfbWF4KQogCQkJcmV0dXJuIC1FSU5WQUw7CiAKLQkJdGFibGVfY29udGV4dC0+b2Rfc2V0
dGluZ3NfbWF4ID0ga21lbWR1cCgmcG93ZXJwbGF5X3RhYmxlLT5PdmVyRHJpdmU4VGFibGUuT0RT
ZXR0aW5nc01heCwKKwkJb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19tYXggPSBrbWVtZHVwKCZw
b3dlcnBsYXlfdGFibGUtPk92ZXJEcml2ZThUYWJsZS5PRFNldHRpbmdzTWF4LAogCQkJCQkJCSBv
ZF9zZXR0aW5nX2FycmF5X3NpemUsCiAJCQkJCQkJIEdGUF9LRVJORUwpOwogCi0JCWlmICghdGFi
bGVfY29udGV4dC0+b2Rfc2V0dGluZ3NfbWF4KSB7Ci0JCQlrZnJlZSh0YWJsZV9jb250ZXh0LT5v
ZF9mZWF0dXJlX2NhcGFiaWxpdGllcyk7Ci0JCQl0YWJsZV9jb250ZXh0LT5vZF9mZWF0dXJlX2Nh
cGFiaWxpdGllcyA9IE5VTEw7CisJCWlmICghb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19tYXgp
IHsKKwkJCWtmcmVlKG9kOF9zZXR0aW5ncy0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXMpOworCQkJ
b2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllcyA9IE5VTEw7CiAJCQlyZXR1cm4g
LUVOT01FTTsKIAkJfQogCi0JCWlmICh0YWJsZV9jb250ZXh0LT5vZF9zZXR0aW5nc19taW4pCisJ
CWlmIChvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbikKIAkJCXJldHVybiAtRUlOVkFMOwog
Ci0JCXRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21pbiA9IGttZW1kdXAoJnBvd2VycGxheV90
YWJsZS0+T3ZlckRyaXZlOFRhYmxlLk9EU2V0dGluZ3NNaW4sCisJCW9kOF9zZXR0aW5ncy0+b2Rf
c2V0dGluZ3NfbWluID0ga21lbWR1cCgmcG93ZXJwbGF5X3RhYmxlLT5PdmVyRHJpdmU4VGFibGUu
T0RTZXR0aW5nc01pbiwKIAkJCQkJCQkgb2Rfc2V0dGluZ19hcnJheV9zaXplLAogCQkJCQkJCSBH
RlBfS0VSTkVMKTsKIAotCQlpZiAoIXRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21pbikgewot
CQkJa2ZyZWUodGFibGVfY29udGV4dC0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXMpOwotCQkJdGFi
bGVfY29udGV4dC0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXMgPSBOVUxMOwotCQkJa2ZyZWUodGFi
bGVfY29udGV4dC0+b2Rfc2V0dGluZ3NfbWF4KTsKLQkJCXRhYmxlX2NvbnRleHQtPm9kX3NldHRp
bmdzX21heCA9IE5VTEw7CisJCWlmICghb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW4pIHsK
KwkJCWtmcmVlKG9kOF9zZXR0aW5ncy0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXMpOworCQkJb2Q4
X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllcyA9IE5VTEw7CisJCQlrZnJlZShvZDhf
c2V0dGluZ3MtPm9kX3NldHRpbmdzX21heCk7CisJCQlvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdz
X21heCA9IE5VTEw7CiAJCQlyZXR1cm4gLUVOT01FTTsKIAkJfQogCX0KQEAgLTk0MCw3ICs5NDEs
NyBAQCBzdGF0aWMgaW50IHZlZ2EyMF9wcmludF9jbGtfbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4
dCAqc211LAogCXN0cnVjdCBzbXVfZHBtX2NvbnRleHQgKnNtdV9kcG0gPSAmc211LT5zbXVfZHBt
OwogCXN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICpkcG1fdGFibGUgPSBOVUxMOwogCXN0cnVjdCB2
ZWdhMjBfb2Q4X3NldHRpbmdzICpvZDhfc2V0dGluZ3MgPQotCQkoc3RydWN0IHZlZ2EyMF9vZDhf
c2V0dGluZ3MgKil0YWJsZV9jb250ZXh0LT5vZDhfc2V0dGluZ3M7CisJCShzdHJ1Y3QgdmVnYTIw
X29kOF9zZXR0aW5ncyAqKXNtdS0+b2Rfc2V0dGluZ3M7CiAJT3ZlckRyaXZlVGFibGVfdCAqb2Rf
dGFibGUgPQogCQkoT3ZlckRyaXZlVGFibGVfdCAqKSh0YWJsZV9jb250ZXh0LT5vdmVyZHJpdmVf
dGFibGUpOwogCVBQVGFibGVfdCAqcHB0YWJsZSA9IChQUFRhYmxlX3QgKil0YWJsZV9jb250ZXh0
LT5kcml2ZXJfcHB0YWJsZTsKQEAgLTE0OTYsMjIgKzE0OTcsMjIgQEAgc3RhdGljIGludCB2ZWdh
MjBfc2V0X2RlZmF1bHRfb2Q4X3NldHR0aW5ncyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKIAlQ
UFRhYmxlX3QgKnNtY19wcHRhYmxlID0gdGFibGVfY29udGV4dC0+ZHJpdmVyX3BwdGFibGU7CiAJ
aW50IGksIHJldDsKIAotCWlmICh0YWJsZV9jb250ZXh0LT5vZDhfc2V0dGluZ3MpCisJaWYgKHNt
dS0+b2Rfc2V0dGluZ3MpCiAJCXJldHVybiAtRUlOVkFMOwogCi0JdGFibGVfY29udGV4dC0+b2Q4
X3NldHRpbmdzID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IHZlZ2EyMF9vZDhfc2V0dGluZ3MpLCBH
RlBfS0VSTkVMKTsKKwlvZDhfc2V0dGluZ3MgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgdmVnYTIw
X29kOF9zZXR0aW5ncyksIEdGUF9LRVJORUwpOwogCi0JaWYgKCF0YWJsZV9jb250ZXh0LT5vZDhf
c2V0dGluZ3MpCisJaWYgKG9kOF9zZXR0aW5ncykKIAkJcmV0dXJuIC1FTk9NRU07CiAKLQlvZDhf
c2V0dGluZ3MgPSAoc3RydWN0IHZlZ2EyMF9vZDhfc2V0dGluZ3MgKil0YWJsZV9jb250ZXh0LT5v
ZDhfc2V0dGluZ3M7CisJc211LT5vZF9zZXR0aW5ncyA9ICh2b2lkICopb2Q4X3NldHRpbmdzOwog
CiAJaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fU09DQ0xL
X0JJVCkpIHsKLQkJaWYgKHRhYmxlX2NvbnRleHQtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzW0FU
T01fVkVHQTIwX09ERkVBVFVSRV9HRlhDTEtfTElNSVRTXSAmJgotCQkgICAgdGFibGVfY29udGV4
dC0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX0dGWENMS19GTUFYXSA+IDAgJiYKLQkJICAg
IHRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21pbltPRDhfU0VUVElOR19HRlhDTEtfRk1JTl0g
PiAwICYmCi0JCSAgICAodGFibGVfY29udGV4dC0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5H
X0dGWENMS19GTUFYXSA+PQotCQkgICAgIHRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21pbltP
RDhfU0VUVElOR19HRlhDTEtfRk1JTl0pKSB7CisJCWlmIChvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1
cmVfY2FwYWJpbGl0aWVzW0FUT01fVkVHQTIwX09ERkVBVFVSRV9HRlhDTEtfTElNSVRTXSAmJgor
CQkgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZN
QVhdID4gMCAmJgorCQkgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJ
TkdfR0ZYQ0xLX0ZNSU5dID4gMCAmJgorCQkgICAgKG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3Nf
bWF4W09EOF9TRVRUSU5HX0dGWENMS19GTUFYXSA+PQorCQkgICAgIG9kOF9zZXR0aW5ncy0+b2Rf
c2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX0dGWENMS19GTUlOXSkpIHsKIAkJCW9kOF9zZXR0aW5n
cy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUlOXS5mZWF0dXJlX2lk
ID0KIAkJCQlPRDhfR0ZYQ0xLX0xJTUlUUzsKIAkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdz
X2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUFYXS5mZWF0dXJlX2lkID0KQEAgLTE1MjIsMTMg
KzE1MjMsMTMgQEAgc3RhdGljIGludCB2ZWdhMjBfc2V0X2RlZmF1bHRfb2Q4X3NldHR0aW5ncyhz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKIAkJCQlvZF90YWJsZS0+R2Z4Y2xrRm1heDsKIAkJfQog
Ci0JCWlmICh0YWJsZV9jb250ZXh0LT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllc1tBVE9NX1ZFR0Ey
MF9PREZFQVRVUkVfR0ZYQ0xLX0NVUlZFXSAmJgotCQkgICAgKHRhYmxlX2NvbnRleHQtPm9kX3Nl
dHRpbmdzX21pbltPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTFdID49CisJCWlmIChvZDhfc2V0
dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzW0FUT01fVkVHQTIwX09ERkVBVFVSRV9HRlhD
TEtfQ1VSVkVdICYmCisJCSAgICAob2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NF
VFRJTkdfR0ZYQ0xLX1ZPTFRBR0UxXSA+PQogCQkgICAgIHNtY19wcHRhYmxlLT5NaW5Wb2x0YWdl
R2Z4IC8gVk9MVEFHRV9TQ0FMRSkgJiYKLQkJICAgICh0YWJsZV9jb250ZXh0LT5vZF9zZXR0aW5n
c19tYXhbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UzXSA8PQorCQkgICAgKG9kOF9zZXR0aW5n
cy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFM10gPD0KIAkJICAg
ICBzbWNfcHB0YWJsZS0+TWF4Vm9sdGFnZUdmeCAvIFZPTFRBR0VfU0NBTEUpICYmCi0JCSAgICAo
dGFibGVfY29udGV4dC0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdF
MV0gPD0KLQkJICAgICB0YWJsZV9jb250ZXh0LT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdf
R0ZYQ0xLX1ZPTFRBR0UzXSkpIHsKKwkJICAgIChvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21p
bltPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTFdIDw9CisJCSAgICAgb2Q4X3NldHRpbmdzLT5v
ZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UzXSkpIHsKIAkJCW9kOF9z
ZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GUkVRMV0uZmVh
dHVyZV9pZCA9CiAJCQkJT0Q4X0dGWENMS19DVVJWRTsKIAkJCW9kOF9zZXR0aW5ncy0+b2Q4X3Nl
dHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMV0uZmVhdHVyZV9pZCA9CkBA
IC0xNTgwLDExICsxNTgxLDExIEBAIHN0YXRpYyBpbnQgdmVnYTIwX3NldF9kZWZhdWx0X29kOF9z
ZXR0dGluZ3Moc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCiAJfQogCiAJaWYgKHNtdV9mZWF0dXJl
X2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVUNMS19CSVQpKSB7Ci0JCWlmICh0YWJs
ZV9jb250ZXh0LT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllc1tBVE9NX1ZFR0EyMF9PREZFQVRVUkVf
VUNMS19NQVhdICYmCi0JCSAgICB0YWJsZV9jb250ZXh0LT5vZF9zZXR0aW5nc19taW5bT0Q4X1NF
VFRJTkdfVUNMS19GTUFYXSA+IDAgJiYKLQkJICAgIHRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdz
X21heFtPRDhfU0VUVElOR19VQ0xLX0ZNQVhdID4gMCAmJgotCQkgICAgKHRhYmxlX2NvbnRleHQt
Pm9kX3NldHRpbmdzX21heFtPRDhfU0VUVElOR19VQ0xLX0ZNQVhdID49Ci0JCSAgICAgdGFibGVf
Y29udGV4dC0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX1VDTEtfRk1BWF0pKSB7CisJCWlm
IChvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzW0FUT01fVkVHQTIwX09ERkVB
VFVSRV9VQ0xLX01BWF0gJiYKKwkJICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09E
OF9TRVRUSU5HX1VDTEtfRk1BWF0gPiAwICYmCisJCSAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRp
bmdzX21heFtPRDhfU0VUVElOR19VQ0xLX0ZNQVhdID4gMCAmJgorCQkgICAgKG9kOF9zZXR0aW5n
cy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX1VDTEtfRk1BWF0gPj0KKwkJICAgICBvZDhf
c2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbltPRDhfU0VUVElOR19VQ0xLX0ZNQVhdKSkgewogCQkJ
b2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfVUNMS19GTUFYXS5m
ZWF0dXJlX2lkID0KIAkJCQlPRDhfVUNMS19NQVg7CiAJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0
aW5nc19hcnJheVtPRDhfU0VUVElOR19VQ0xLX0ZNQVhdLmRlZmF1bHRfdmFsdWUgPQpAQCAtMTU5
MiwxMSArMTU5MywxMSBAQCBzdGF0aWMgaW50IHZlZ2EyMF9zZXRfZGVmYXVsdF9vZDhfc2V0dHRp
bmdzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQogCQl9CiAJfQogCi0JaWYgKHRhYmxlX2NvbnRl
eHQtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzW0FUT01fVkVHQTIwX09ERkVBVFVSRV9QT1dFUl9M
SU1JVF0gJiYKLQkgICAgdGFibGVfY29udGV4dC0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5H
X1BPV0VSX1BFUkNFTlRBR0VdID4gMCAmJgotCSAgICB0YWJsZV9jb250ZXh0LT5vZF9zZXR0aW5n
c19taW5bT0Q4X1NFVFRJTkdfUE9XRVJfUEVSQ0VOVEFHRV0gPD0gMTAwICYmCi0JICAgIHRhYmxl
X2NvbnRleHQtPm9kX3NldHRpbmdzX21heFtPRDhfU0VUVElOR19QT1dFUl9QRVJDRU5UQUdFXSA+
IDAgJiYKLQkgICAgdGFibGVfY29udGV4dC0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX1BP
V0VSX1BFUkNFTlRBR0VdIDw9IDEwMCkgeworCWlmIChvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVf
Y2FwYWJpbGl0aWVzW0FUT01fVkVHQTIwX09ERkVBVFVSRV9QT1dFUl9MSU1JVF0gJiYKKwkgICAg
b2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfUE9XRVJfUEVSQ0VOVEFH
RV0gPiAwICYmCisJICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5H
X1BPV0VSX1BFUkNFTlRBR0VdIDw9IDEwMCAmJgorCSAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRp
bmdzX21heFtPRDhfU0VUVElOR19QT1dFUl9QRVJDRU5UQUdFXSA+IDAgJiYKKwkgICAgb2Q4X3Nl
dHRpbmdzLT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfUE9XRVJfUEVSQ0VOVEFHRV0gPD0g
MTAwKSB7CiAJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX1BP
V0VSX1BFUkNFTlRBR0VdLmZlYXR1cmVfaWQgPQogCQkJT0Q4X1BPV0VSX0xJTUlUOwogCQlvZDhf
c2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19QT1dFUl9QRVJDRU5UQUdF
XS5kZWZhdWx0X3ZhbHVlID0KQEAgLTE2MDQsMjIgKzE2MDUsMjIgQEAgc3RhdGljIGludCB2ZWdh
MjBfc2V0X2RlZmF1bHRfb2Q4X3NldHR0aW5ncyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKIAl9
CiAKIAlpZiAoc211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0ZBTl9DT05U
Uk9MX0JJVCkpIHsKLQkJaWYgKHRhYmxlX2NvbnRleHQtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVz
W0FUT01fVkVHQTIwX09ERkVBVFVSRV9GQU5fQUNPVVNUSUNfTElNSVRdICYmCi0JCSAgICB0YWJs
ZV9jb250ZXh0LT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfRkFOX0FDT1VTVElDX0xJTUlU
XSA+IDAgJiYKLQkJICAgIHRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21heFtPRDhfU0VUVElO
R19GQU5fQUNPVVNUSUNfTElNSVRdID4gMCAmJgotCQkgICAgKHRhYmxlX2NvbnRleHQtPm9kX3Nl
dHRpbmdzX21heFtPRDhfU0VUVElOR19GQU5fQUNPVVNUSUNfTElNSVRdID49Ci0JCSAgICAgdGFi
bGVfY29udGV4dC0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX0ZBTl9BQ09VU1RJQ19MSU1J
VF0pKSB7CisJCWlmIChvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzW0FUT01f
VkVHQTIwX09ERkVBVFVSRV9GQU5fQUNPVVNUSUNfTElNSVRdICYmCisJCSAgICBvZDhfc2V0dGlu
Z3MtPm9kX3NldHRpbmdzX21pbltPRDhfU0VUVElOR19GQU5fQUNPVVNUSUNfTElNSVRdID4gMCAm
JgorCQkgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfRkFOX0FD
T1VTVElDX0xJTUlUXSA+IDAgJiYKKwkJICAgIChvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21h
eFtPRDhfU0VUVElOR19GQU5fQUNPVVNUSUNfTElNSVRdID49CisJCSAgICAgb2Q4X3NldHRpbmdz
LT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfRkFOX0FDT1VTVElDX0xJTUlUXSkpIHsKIAkJ
CW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0ZBTl9BQ09VU1RJ
Q19MSU1JVF0uZmVhdHVyZV9pZCA9CiAJCQkJT0Q4X0FDT1VTVElDX0xJTUlUX1NDTEs7CiAJCQlv
ZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19GQU5fQUNPVVNUSUNf
TElNSVRdLmRlZmF1bHRfdmFsdWUgPQogCQkJCW9kX3RhYmxlLT5GYW5NYXhpbXVtUnBtOwogCQl9
CiAKLQkJaWYgKHRhYmxlX2NvbnRleHQtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzW0FUT01fVkVH
QTIwX09ERkVBVFVSRV9GQU5fU1BFRURfTUlOXSAmJgotCQkgICAgdGFibGVfY29udGV4dC0+b2Rf
c2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX0ZBTl9NSU5fU1BFRURdID4gMCAmJgotCQkgICAgdGFi
bGVfY29udGV4dC0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX0ZBTl9NSU5fU1BFRURdID4g
MCAmJgotCQkgICAgKHRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21heFtPRDhfU0VUVElOR19G
QU5fTUlOX1NQRUVEXSA+PQotCQkgICAgIHRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21pbltP
RDhfU0VUVElOR19GQU5fTUlOX1NQRUVEXSkpIHsKKwkJaWYgKG9kOF9zZXR0aW5ncy0+b2RfZmVh
dHVyZV9jYXBhYmlsaXRpZXNbQVRPTV9WRUdBMjBfT0RGRUFUVVJFX0ZBTl9TUEVFRF9NSU5dICYm
CisJCSAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbltPRDhfU0VUVElOR19GQU5fTUlO
X1NQRUVEXSA+IDAgJiYKKwkJICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9T
RVRUSU5HX0ZBTl9NSU5fU1BFRURdID4gMCAmJgorCQkgICAgKG9kOF9zZXR0aW5ncy0+b2Rfc2V0
dGluZ3NfbWF4W09EOF9TRVRUSU5HX0ZBTl9NSU5fU1BFRURdID49CisJCSAgICAgb2Q4X3NldHRp
bmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfRkFOX01JTl9TUEVFRF0pKSB7CiAJCQlv
ZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19GQU5fTUlOX1NQRUVE
XS5mZWF0dXJlX2lkID0KIAkJCQlPRDhfRkFOX1NQRUVEX01JTjsKIAkJCW9kOF9zZXR0aW5ncy0+
b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0ZBTl9NSU5fU1BFRURdLmRlZmF1bHRfdmFs
dWUgPQpAQCAtMTYyOCwyMiArMTYyOSwyMiBAQCBzdGF0aWMgaW50IHZlZ2EyMF9zZXRfZGVmYXVs
dF9vZDhfc2V0dHRpbmdzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQogCX0KIAogCWlmIChzbXVf
ZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfVEhFUk1BTF9CSVQpKSB7Ci0JCWlm
ICh0YWJsZV9jb250ZXh0LT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllc1tBVE9NX1ZFR0EyMF9PREZF
QVRVUkVfVEVNUEVSQVRVUkVfRkFOXSAmJgotCQkgICAgdGFibGVfY29udGV4dC0+b2Rfc2V0dGlu
Z3NfbWluW09EOF9TRVRUSU5HX0ZBTl9UQVJHRVRfVEVNUF0gPiAwICYmCi0JCSAgICB0YWJsZV9j
b250ZXh0LT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfRkFOX1RBUkdFVF9URU1QXSA+IDAg
JiYKLQkJICAgICh0YWJsZV9jb250ZXh0LT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfRkFO
X1RBUkdFVF9URU1QXSA+PQotCQkgICAgIHRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21pbltP
RDhfU0VUVElOR19GQU5fVEFSR0VUX1RFTVBdKSkgeworCQlpZiAob2Q4X3NldHRpbmdzLT5vZF9m
ZWF0dXJlX2NhcGFiaWxpdGllc1tBVE9NX1ZFR0EyMF9PREZFQVRVUkVfVEVNUEVSQVRVUkVfRkFO
XSAmJgorCQkgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfRkFO
X1RBUkdFVF9URU1QXSA+IDAgJiYKKwkJICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWF4
W09EOF9TRVRUSU5HX0ZBTl9UQVJHRVRfVEVNUF0gPiAwICYmCisJCSAgICAob2Q4X3NldHRpbmdz
LT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfRkFOX1RBUkdFVF9URU1QXSA+PQorCQkgICAg
IG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX0ZBTl9UQVJHRVRfVEVN
UF0pKSB7CiAJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19G
QU5fVEFSR0VUX1RFTVBdLmZlYXR1cmVfaWQgPQogCQkJCU9EOF9URU1QRVJBVFVSRV9GQU47CiAJ
CQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19GQU5fVEFSR0VU
X1RFTVBdLmRlZmF1bHRfdmFsdWUgPQogCQkJCW9kX3RhYmxlLT5GYW5UYXJnZXRUZW1wZXJhdHVy
ZTsKIAkJfQogCi0JCWlmICh0YWJsZV9jb250ZXh0LT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllc1tB
VE9NX1ZFR0EyMF9PREZFQVRVUkVfVEVNUEVSQVRVUkVfU1lTVEVNXSAmJgotCQkgICAgdGFibGVf
Y29udGV4dC0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX09QRVJBVElOR19URU1QX01BWF0g
PiAwICYmCi0JCSAgICB0YWJsZV9jb250ZXh0LT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdf
T1BFUkFUSU5HX1RFTVBfTUFYXSA+IDAgJiYKLQkJICAgICh0YWJsZV9jb250ZXh0LT5vZF9zZXR0
aW5nc19tYXhbT0Q4X1NFVFRJTkdfT1BFUkFUSU5HX1RFTVBfTUFYXSA+PQotCQkgICAgIHRhYmxl
X2NvbnRleHQtPm9kX3NldHRpbmdzX21pbltPRDhfU0VUVElOR19PUEVSQVRJTkdfVEVNUF9NQVhd
KSkgeworCQlpZiAob2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllc1tBVE9NX1ZF
R0EyMF9PREZFQVRVUkVfVEVNUEVSQVRVUkVfU1lTVEVNXSAmJgorCQkgICAgb2Q4X3NldHRpbmdz
LT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfT1BFUkFUSU5HX1RFTVBfTUFYXSA+IDAgJiYK
KwkJICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX09QRVJBVElO
R19URU1QX01BWF0gPiAwICYmCisJCSAgICAob2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19tYXhb
T0Q4X1NFVFRJTkdfT1BFUkFUSU5HX1RFTVBfTUFYXSA+PQorCQkgICAgIG9kOF9zZXR0aW5ncy0+
b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX09QRVJBVElOR19URU1QX01BWF0pKSB7CiAJCQlv
ZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19PUEVSQVRJTkdfVEVN
UF9NQVhdLmZlYXR1cmVfaWQgPQogCQkJCU9EOF9URU1QRVJBVFVSRV9TWVNURU07CiAJCQlvZDhf
c2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19PUEVSQVRJTkdfVEVNUF9N
QVhdLmRlZmF1bHRfdmFsdWUgPQpAQCAtMTY1NCw5ICsxNjU1LDkgQEAgc3RhdGljIGludCB2ZWdh
MjBfc2V0X2RlZmF1bHRfb2Q4X3NldHR0aW5ncyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKIAlm
b3IgKGkgPSAwOyBpIDwgT0Q4X1NFVFRJTkdfQ09VTlQ7IGkrKykgewogCQlpZiAob2Q4X3NldHRp
bmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbaV0uZmVhdHVyZV9pZCkgewogCQkJb2Q4X3NldHRpbmdz
LT5vZDhfc2V0dGluZ3NfYXJyYXlbaV0ubWluX3ZhbHVlID0KLQkJCQl0YWJsZV9jb250ZXh0LT5v
ZF9zZXR0aW5nc19taW5baV07CisJCQkJb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5baV07
CiAJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtpXS5tYXhfdmFsdWUgPQotCQkJ
CXRhYmxlX2NvbnRleHQtPm9kX3NldHRpbmdzX21heFtpXTsKKwkJCQlvZDhfc2V0dGluZ3MtPm9k
X3NldHRpbmdzX21heFtpXTsKIAkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W2ld
LmN1cnJlbnRfdmFsdWUgPQogCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W2ld
LmRlZmF1bHRfdmFsdWU7CiAJCX0gZWxzZSB7CkBAIC0yNDE1LDcgKzI0MTYsNyBAQCBzdGF0aWMg
aW50IHZlZ2EyMF91cGRhdGVfc3BlY2lmaWVkX29kOF92YWx1ZShzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSwKIAlPdmVyRHJpdmVUYWJsZV90ICpvZF90YWJsZSA9CiAJCShPdmVyRHJpdmVUYWJsZV90
ICopKHRhYmxlX2NvbnRleHQtPm92ZXJkcml2ZV90YWJsZSk7CiAJc3RydWN0IHZlZ2EyMF9vZDhf
c2V0dGluZ3MgKm9kOF9zZXR0aW5ncyA9Ci0JCShzdHJ1Y3QgdmVnYTIwX29kOF9zZXR0aW5ncyAq
KXRhYmxlX2NvbnRleHQtPm9kOF9zZXR0aW5nczsKKwkJKHN0cnVjdCB2ZWdhMjBfb2Q4X3NldHRp
bmdzICopc211LT5vZF9zZXR0aW5nczsKIAogCXN3aXRjaCAoaW5kZXgpIHsKIAljYXNlIE9EOF9T
RVRUSU5HX0dGWENMS19GTUlOOgpAQCAtMjU5Niw3ICsyNTk3LDcgQEAgc3RhdGljIGludCB2ZWdh
MjBfb2RuX2VkaXRfZHBtX3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAogCXN0cnVjdCB2
ZWdhMjBfZHBtX3RhYmxlICpkcG1fdGFibGUgPSBOVUxMOwogCXN0cnVjdCB2ZWdhMjBfc2luZ2xl
X2RwbV90YWJsZSAqc2luZ2xlX2RwbV90YWJsZTsKIAlzdHJ1Y3QgdmVnYTIwX29kOF9zZXR0aW5n
cyAqb2Q4X3NldHRpbmdzID0KLQkJKHN0cnVjdCB2ZWdhMjBfb2Q4X3NldHRpbmdzICopdGFibGVf
Y29udGV4dC0+b2Q4X3NldHRpbmdzOworCQkoc3RydWN0IHZlZ2EyMF9vZDhfc2V0dGluZ3MgKilz
bXUtPm9kX3NldHRpbmdzOwogCXN0cnVjdCBwcF9jbG9ja19sZXZlbHNfd2l0aF9sYXRlbmN5IGNs
b2NrczsKIAlpbnQzMl90IGlucHV0X2luZGV4LCBpbnB1dF9jbGssIGlucHV0X3ZvbCwgaTsKIAlp
bnQgb2Q4X2lkOwpAQCAtMjY0MywxMCArMjY0NCwxMCBAQCBzdGF0aWMgaW50IHZlZ2EyMF9vZG5f
ZWRpdF9kcG1fdGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCiAKIAkJCWlmIChpbnB1dF9p
bmRleCA9PSAwICYmIG9kX3RhYmxlLT5HZnhjbGtGbWluICE9IGlucHV0X2NsaykgewogCQkJCW9k
X3RhYmxlLT5HZnhjbGtGbWluID0gaW5wdXRfY2xrOwotCQkJCXRhYmxlX2NvbnRleHQtPm9kX2dm
eGNsa191cGRhdGUgPSB0cnVlOworCQkJCW9kOF9zZXR0aW5ncy0+b2RfZ2Z4Y2xrX3VwZGF0ZSA9
IHRydWU7CiAJCQl9IGVsc2UgaWYgKGlucHV0X2luZGV4ID09IDEgJiYgb2RfdGFibGUtPkdmeGNs
a0ZtYXggIT0gaW5wdXRfY2xrKSB7CiAJCQkJb2RfdGFibGUtPkdmeGNsa0ZtYXggPSBpbnB1dF9j
bGs7Ci0JCQkJdGFibGVfY29udGV4dC0+b2RfZ2Z4Y2xrX3VwZGF0ZSA9IHRydWU7CisJCQkJb2Q4
X3NldHRpbmdzLT5vZF9nZnhjbGtfdXBkYXRlID0gdHJ1ZTsKIAkJCX0KIAkJfQogCkBAIC0yNjkx
LDcgKzI2OTIsNyBAQCBzdGF0aWMgaW50IHZlZ2EyMF9vZG5fZWRpdF9kcG1fdGFibGUoc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUsCiAJCQl9CiAKIAkJCWlmIChpbnB1dF9pbmRleCA9PSAxICYmIG9k
X3RhYmxlLT5VY2xrRm1heCAhPSBpbnB1dF9jbGspIHsKLQkJCQl0YWJsZV9jb250ZXh0LT5vZF9n
ZnhjbGtfdXBkYXRlID0gdHJ1ZTsKKwkJCQlvZDhfc2V0dGluZ3MtPm9kX2dmeGNsa191cGRhdGUg
PSB0cnVlOwogCQkJCW9kX3RhYmxlLT5VY2xrRm1heCA9IGlucHV0X2NsazsKIAkJCX0KIAkJfQpA
QCAtMjc4Miw4ICsyNzgzLDggQEAgc3RhdGljIGludCB2ZWdhMjBfb2RuX2VkaXRfZHBtX3RhYmxl
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LAogCQl9CiAKIAkJLyogcmV0cmlldmUgdXBkYXRlZCBn
ZnhjbGsgdGFibGUgKi8KLQkJaWYgKHRhYmxlX2NvbnRleHQtPm9kX2dmeGNsa191cGRhdGUpIHsK
LQkJCXRhYmxlX2NvbnRleHQtPm9kX2dmeGNsa191cGRhdGUgPSBmYWxzZTsKKwkJaWYgKG9kOF9z
ZXR0aW5ncy0+b2RfZ2Z4Y2xrX3VwZGF0ZSkgeworCQkJb2Q4X3NldHRpbmdzLT5vZF9nZnhjbGtf
dXBkYXRlID0gZmFsc2U7CiAJCQlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPmdmeF90
YWJsZSk7CiAKIAkJCWlmIChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVf
RFBNX0dGWENMS19CSVQpKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2Vy
cGxheS92ZWdhMjBfcHB0LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92ZWdhMjBf
cHB0LmgKaW5kZXggODdmM2E4MzAzNjQ1Li4yZGMxMGU0N2I3NjcgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3ZlZ2EyMF9wcHQuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL3Bvd2VycGxheS92ZWdhMjBfcHB0LmgKQEAgLTE2Niw2ICsxNjYsMTIgQEAgc3RydWN0
IHZlZ2EyMF9vZDhfc2luZ2xlX3NldHRpbmcgewogCiBzdHJ1Y3QgdmVnYTIwX29kOF9zZXR0aW5n
cyB7CiAJc3RydWN0IHZlZ2EyMF9vZDhfc2luZ2xlX3NldHRpbmcJb2Q4X3NldHRpbmdzX2FycmF5
W09EOF9TRVRUSU5HX0NPVU5UXTsKKwl1aW50OF90CQkJCSpvZF9mZWF0dXJlX2NhcGFiaWxpdGll
czsKKwl1aW50MzJfdAkJCSpvZF9zZXR0aW5nc19tYXg7CisJdWludDMyX3QJCQkqb2Rfc2V0dGlu
Z3NfbWluOworCXZvaWQJCQkJKm9kOF9zZXR0aW5nczsKKwlib29sCQkJCW9kX2dmeGNsa191cGRh
dGU7CisJYm9vbAkJCQlvZF9tZW1jbGtfdXBkYXRlOwogfTsKIAogZXh0ZXJuIHZvaWQgdmVnYTIw
X3NldF9wcHRfZnVuY3Moc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpOwotLSAKMi4yMC4xCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxp
bmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
