Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9FEFFF398E
	for <lists+amd-gfx@lfdr.de>; Thu,  7 Nov 2019 21:34:06 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 183B16F7A1;
	Thu,  7 Nov 2019 20:34:05 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM04-CO1-obe.outbound.protection.outlook.com
 (mail-eopbgr690081.outbound.protection.outlook.com [40.107.69.81])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 88AF96F7A1
 for <amd-gfx@lists.freedesktop.org>; Thu,  7 Nov 2019 20:34:03 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=TJk9HmoxGb3Wz8QyEeLxL+n5kPbfoS+JydsOdDDjrDhaF4cKZnsuATluQNVe0MKw1XUtLQcfy8mZ658mLjxxX5U1Jyd1vNeB1T/+ChKf4HLoghJqGEVyIB/5l6JT9+Is7HsrlmUY7amYgqhbglM2dxm7QAj//dImZOeoVWSyYA9aNJsk2adEPlMNrqIR73AVCMijLKRulcUdGlIRVsUu+M1kHtnzmbKDTvQuCpkv44a4TrCT2nK0E+QbatcVwc95hzPX0KdtIykWaZdsR4qW3Nfw8BrMZFAIJKFIi4e4bXyv5oJiEDi10DMXKc6h4OgwdS5XLGCke48ukufv6s0eEA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=+1tC2cme+YIEHO8C0pta5ijLqxm3WIiEGXZxckF0IAI=;
 b=VQGefkDlPsRSShivk8T8eVUb9fyW4DQZJ5MuskGe/uyf8w9zUTNe8Wqi7LiJXjuhNVh13HA50451K7Cqkco/T3zb/JaPoyNAuBBvHps5c0H760E9y+gJfoplyVPWLn33egoJ2IocHUq1dlXGdcDW0oWj8tpr76yCBzI9aMMMVbLOQ7wN3+5SVOuRh3zeolZKrSJgbK35ze4DMRLJoWHZYIWJ6vOVHISw9kv2SzFDK5hHVL2+hkB9t5PNKQS1FpeQGuPG6OeMPMIpa/rPVja+Yo/P+gpmFfIYoFBF+dNJTptquYz7VJ8xc7PqNHtwkOzLa65vClaFujRLQFot4OQnKQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from DM6PR12MB2778.namprd12.prod.outlook.com (20.176.114.145) by
 DM6PR12MB2857.namprd12.prod.outlook.com (20.179.71.22) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2430.20; Thu, 7 Nov 2019 20:34:01 +0000
Received: from DM6PR12MB2778.namprd12.prod.outlook.com
 ([fe80::304d:db58:2aa:d69e]) by DM6PR12MB2778.namprd12.prod.outlook.com
 ([fe80::304d:db58:2aa:d69e%6]) with mapi id 15.20.2430.020; Thu, 7 Nov 2019
 20:34:01 +0000
From: "Zhao, Yong" <Yong.Zhao@amd.com>
To: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: [PATCH] drm/amdkfd: Use kernel queue v9 functions for v10 (ver2)
Thread-Topic: [PATCH] drm/amdkfd: Use kernel queue v9 functions for v10 (ver2)
Thread-Index: AQHVlaqwPhTObydgU0i3ODr2JUPiVA==
Date: Thu, 7 Nov 2019 20:34:01 +0000
Message-ID: <20191107203349.31805-1-Yong.Zhao@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: YTOPR0101CA0068.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:14::45) To DM6PR12MB2778.namprd12.prod.outlook.com
 (2603:10b6:5:50::17)
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.17.1
x-originating-ip: [165.204.55.251]
x-ms-publictraffictype: Email
x-ms-office365-filtering-ht: Tenant
x-ms-office365-filtering-correlation-id: 545b3562-961d-48f5-eef7-08d763c1d2bb
x-ms-traffictypediagnostic: DM6PR12MB2857:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <DM6PR12MB28572C8467F5D1AC6405945EF0780@DM6PR12MB2857.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:10000;
x-forefront-prvs: 0214EB3F68
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(979002)(4636009)(346002)(396003)(39860400002)(366004)(136003)(376002)(51234002)(199004)(189003)(6506007)(2906002)(7736002)(386003)(6916009)(66556008)(86362001)(50226002)(71200400001)(71190400001)(64756008)(476003)(305945005)(26005)(1076003)(316002)(6512007)(81166006)(66476007)(66446008)(2616005)(66946007)(8676002)(486006)(5660300002)(81156014)(6116002)(102836004)(186003)(99286004)(2351001)(8936002)(30864003)(36756003)(14454004)(52116002)(2501003)(6436002)(478600001)(25786009)(5640700003)(3846002)(14444005)(66066001)(256004)(6486002)(4326008)(969003)(989001)(999001)(1009001)(1019001);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM6PR12MB2857;
 H:DM6PR12MB2778.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: oBlb1mhatpgBBT2aC12+zAgsjks7KC30tJqWTdqYNq8Nr7f0Y+SBv+3n/e+4xJetCjH7Q1aEzkJIyT41X2Npzbc+iRp9v62tx+NHOMUOhUxUvO3hECRUVW8Dl9afqgjWdFTKnNMIg0ps3jqQVZLWi0Bf8iNUZJL5uI0T50UlIcjHcYZSGJ4qtlVhFFVT/DIl67q7HYgOcR5BMmHUYfgb511F3gWnqnwUE80ZpzoBfkutUuXzZ6Teg6nmLbYYZNroSQr/RZARBGXFmfJvRI+4HqKXUNvBJV7x07QRge13IKk1SsjTdc0rYf9XQYIqjPiRK2Yzr/qj4RR+d1vP/4ekXks6SsEf9eo0sxNW7OL7kiFHOmia8iqTtBmz9nPXHGH0+44MqKZbzy5gTm6TKb0Pq7oqkf9Myxr6q0hOZXhJPNQ0CsZF/mbNtY9vBZx7UUbE9Ejetau5Th7dTex/GnAmHg==
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 545b3562-961d-48f5-eef7-08d763c1d2bb
X-MS-Exchange-CrossTenant-originalarrivaltime: 07 Nov 2019 20:34:01.4952 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: OfHDa6G0zJWivvgtefsFMExaKN/RDAUYLZSPx0lpwwZwniY12mCvyeFVo8W7PRfx
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB2857
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=+1tC2cme+YIEHO8C0pta5ijLqxm3WIiEGXZxckF0IAI=;
 b=2T4IjblhVm22wzK/QZVIQvQQNefthlut9xLb8ghjUdIb4rQTVedPXzCgqBybALQc6F/MdE9dIuKd/OtAykZz0dLXwI0fdYD+4wZjTs5jJc7Ett7RuUzxLuJJsA5hFv18nyFNJ1ve0/Ppa/4/DLOiNG6HEGhjOqfGcu7AIDmLZCc=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Yong.Zhao@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Zhao, Yong" <Yong.Zhao@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

VGhlIGtlcm5lbCBxdWV1ZSBmdW5jdGlvbnMgZm9yIHY5IGFuZCB2MTAgYXJlIHRoZSBzYW1lIGV4
Y2VwdApwbV9tYXBfcHJvY2Vzc192KiB3aGljaCBoYXZlIHNtYWxsIGRpZmZlcmVuY2UsIHNvIHRo
ZXkgc2hvdWxkIGJlIHJldXNlZC4KVGhpcyBlbGltaW5hdGVzIHRoZSBuZWVkIG9mIHJlYXBwbHlp
bmcgc2V2ZXJhbCBwYXRjaGVzIHdoaWNoIHdlcmUKYXBwbGllZCBvbiB2OSBidXQgbm90IG9uIHYx
MCwgc3VjaCBhcyBiaWdnZXIgR1dTIGFuZCBtb3JlIHRoYW4gMgpTRE1BIGVuZ2luZSBzdXBwb3J0
IHdoaWNoIHdlcmUgaW50cm9kdWNlZCBvbiBBcmN0dXJ1cy4KCkNoYW5nZS1JZDogSTJkMzg1OTYx
ZTNjODg0ZGIxNGUzMGI1YWZjOThkMGQ5ZTRjYjE4MDIKU2lnbmVkLW9mZi1ieTogWW9uZyBaaGFv
IDxZb25nLlpoYW9AYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9NYWtl
ZmlsZSAgICAgICAgICAgfCAgIDEgLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2tl
cm5lbF9xdWV1ZS5jIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2Vy
bmVsX3F1ZXVlLmggfCAgIDEgLQogLi4uL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1
ZXVlX3YxMC5jIHwgMzE3IC0tLS0tLS0tLS0tLS0tLS0tLQogLi4uL2dwdS9kcm0vYW1kL2FtZGtm
ZC9rZmRfa2VybmVsX3F1ZXVlX3Y5LmMgIHwgIDE2ICstCiAuLi4vZ3B1L2RybS9hbWQvYW1ka2Zk
L2tmZF9wYWNrZXRfbWFuYWdlci5jICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
a2ZkL2tmZF9wcml2LmggICAgICAgICB8ICAgNCAtCiA3IGZpbGVzIGNoYW5nZWQsIDE0IGluc2Vy
dGlvbnMoKyksIDMzMyBkZWxldGlvbnMoLSkKIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVlX3YxMC5jCgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRrZmQvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGtmZC9NYWtlZmlsZQppbmRleCA0ODE1NTA2MGE1N2MuLjAxN2E4YjcxNTZkYSAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRrZmQvTWFrZWZpbGUKQEAgLTQxLDcgKzQxLDYgQEAgQU1ES0ZEX0ZJTEVTCTo9
ICQoQU1ES0ZEX1BBVEgpL2tmZF9tb2R1bGUubyBcCiAJCSQoQU1ES0ZEX1BBVEgpL2tmZF9rZXJu
ZWxfcXVldWVfY2lrLm8gXAogCQkkKEFNREtGRF9QQVRIKS9rZmRfa2VybmVsX3F1ZXVlX3ZpLm8g
XAogCQkkKEFNREtGRF9QQVRIKS9rZmRfa2VybmVsX3F1ZXVlX3Y5Lm8gXAotCQkkKEFNREtGRF9Q
QVRIKS9rZmRfa2VybmVsX3F1ZXVlX3YxMC5vIFwKIAkJJChBTURLRkRfUEFUSCkva2ZkX3BhY2tl
dF9tYW5hZ2VyLm8gXAogCQkkKEFNREtGRF9QQVRIKS9rZmRfcHJvY2Vzc19xdWV1ZV9tYW5hZ2Vy
Lm8gXAogCQkkKEFNREtGRF9QQVRIKS9rZmRfZGV2aWNlX3F1ZXVlX21hbmFnZXIubyBcCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVlLmMgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVlLmMKaW5kZXggMTFkMjQ0
ODkxMzkzLi4wZDk2NjQwOGVhODcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
a2ZkL2tmZF9rZXJuZWxfcXVldWUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9r
ZmRfa2VybmVsX3F1ZXVlLmMKQEAgLTMzMiwxMiArMzMyLDEwIEBAIHN0cnVjdCBrZXJuZWxfcXVl
dWUgKmtlcm5lbF9xdWV1ZV9pbml0KHN0cnVjdCBrZmRfZGV2ICpkZXYsCiAJY2FzZSBDSElQX1JB
VkVOOgogCWNhc2UgQ0hJUF9SRU5PSVI6CiAJY2FzZSBDSElQX0FSQ1RVUlVTOgotCQlrZXJuZWxf
cXVldWVfaW5pdF92OSgma3EtPm9wc19hc2ljX3NwZWNpZmljKTsKLQkJYnJlYWs7CiAJY2FzZSBD
SElQX05BVkkxMDoKIAljYXNlIENISVBfTkFWSTEyOgogCWNhc2UgQ0hJUF9OQVZJMTQ6Ci0JCWtl
cm5lbF9xdWV1ZV9pbml0X3YxMCgma3EtPm9wc19hc2ljX3NwZWNpZmljKTsKKwkJa2VybmVsX3F1
ZXVlX2luaXRfdjkoJmtxLT5vcHNfYXNpY19zcGVjaWZpYyk7CiAJCWJyZWFrOwogCWRlZmF1bHQ6
CiAJCVdBUk4oMSwgIlVuZXhwZWN0ZWQgQVNJQyBmYW1pbHkgJXUiLApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2tlcm5lbF9xdWV1ZS5oIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRrZmQva2ZkX2tlcm5lbF9xdWV1ZS5oCmluZGV4IDM2NWZjNjc0ZmVhNC4uYTcx
MTZhOTM5MDI5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfa2Vy
bmVsX3F1ZXVlLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2tlcm5lbF9x
dWV1ZS5oCkBAIC0xMDIsNiArMTAyLDUgQEAgc3RydWN0IGtlcm5lbF9xdWV1ZSB7CiB2b2lkIGtl
cm5lbF9xdWV1ZV9pbml0X2NpayhzdHJ1Y3Qga2VybmVsX3F1ZXVlX29wcyAqb3BzKTsKIHZvaWQg
a2VybmVsX3F1ZXVlX2luaXRfdmkoc3RydWN0IGtlcm5lbF9xdWV1ZV9vcHMgKm9wcyk7CiB2b2lk
IGtlcm5lbF9xdWV1ZV9pbml0X3Y5KHN0cnVjdCBrZXJuZWxfcXVldWVfb3BzICpvcHMpOwotdm9p
ZCBrZXJuZWxfcXVldWVfaW5pdF92MTAoc3RydWN0IGtlcm5lbF9xdWV1ZV9vcHMgKm9wcyk7CiAK
ICNlbmRpZiAvKiBLRkRfS0VSTkVMX1FVRVVFX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGtmZC9rZmRfa2VybmVsX3F1ZXVlX3YxMC5jIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRrZmQva2ZkX2tlcm5lbF9xdWV1ZV92MTAuYwpkZWxldGVkIGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggYmZkNjIyMWFjYWU5Li4wMDAwMDAwMDAwMDAKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRrZmQva2ZkX2tlcm5lbF9xdWV1ZV92MTAuYworKysgL2Rldi9udWxsCkBAIC0xLDMx
NyArMCwwIEBACi0vKgotICogQ29weXJpZ2h0IDIwMTggQWR2YW5jZWQgTWljcm8gRGV2aWNlcywg
SW5jLgotICoKLSAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdl
LCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCi0gKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5k
IGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAotICogdG8g
ZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhv
dXQgbGltaXRhdGlvbgotICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2Us
IHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCi0gKiBhbmQvb3Igc2VsbCBjb3BpZXMg
b2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKLSAqIFNv
ZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNv
bmRpdGlvbnM6Ci0gKgotICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVy
bWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KLSAqIGFsbCBjb3BpZXMgb3Igc3Vi
c3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgotICoKLSAqIFRIRSBTT0ZUV0FSRSBJ
UyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNT
IE9SCi0gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5U
SUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKLSAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQ
T1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAotICogVEhFIENPUFlS
SUdIVCBIT0xERVIoUykgT1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1B
R0VTIE9SCi0gKiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRS
QUNULCBUT1JUIE9SIE9USEVSV0lTRSwKLSAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENP
Tk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgotICogT1RIRVIgREVBTElO
R1MgSU4gVEhFIFNPRlRXQVJFLgotICoKLSAqLwotCi0jaW5jbHVkZSAia2ZkX2tlcm5lbF9xdWV1
ZS5oIgotI2luY2x1ZGUgImtmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5oIgotI2luY2x1ZGUgImtm
ZF9wbTRfaGVhZGVyc19haS5oIgotI2luY2x1ZGUgImtmZF9wbTRfb3Bjb2Rlcy5oIgotI2luY2x1
ZGUgImdjL2djXzEwXzFfMF9zaF9tYXNrLmgiCi0KLXN0YXRpYyBib29sIGluaXRpYWxpemVfdjEw
KHN0cnVjdCBrZXJuZWxfcXVldWUgKmtxLCBzdHJ1Y3Qga2ZkX2RldiAqZGV2LAotCQkJZW51bSBr
ZmRfcXVldWVfdHlwZSB0eXBlLCB1bnNpZ25lZCBpbnQgcXVldWVfc2l6ZSk7Ci1zdGF0aWMgdm9p
ZCB1bmluaXRpYWxpemVfdjEwKHN0cnVjdCBrZXJuZWxfcXVldWUgKmtxKTsKLXN0YXRpYyB2b2lk
IHN1Ym1pdF9wYWNrZXRfdjEwKHN0cnVjdCBrZXJuZWxfcXVldWUgKmtxKTsKLQotdm9pZCBrZXJu
ZWxfcXVldWVfaW5pdF92MTAoc3RydWN0IGtlcm5lbF9xdWV1ZV9vcHMgKm9wcykKLXsKLQlvcHMt
PmluaXRpYWxpemUgPSBpbml0aWFsaXplX3YxMDsKLQlvcHMtPnVuaW5pdGlhbGl6ZSA9IHVuaW5p
dGlhbGl6ZV92MTA7Ci0Jb3BzLT5zdWJtaXRfcGFja2V0ID0gc3VibWl0X3BhY2tldF92MTA7Ci19
Ci0KLXN0YXRpYyBib29sIGluaXRpYWxpemVfdjEwKHN0cnVjdCBrZXJuZWxfcXVldWUgKmtxLCBz
dHJ1Y3Qga2ZkX2RldiAqZGV2LAotCQkJZW51bSBrZmRfcXVldWVfdHlwZSB0eXBlLCB1bnNpZ25l
ZCBpbnQgcXVldWVfc2l6ZSkKLXsKLQlpbnQgcmV0dmFsOwotCi0JcmV0dmFsID0ga2ZkX2d0dF9z
YV9hbGxvY2F0ZShkZXYsIFBBR0VfU0laRSwgJmtxLT5lb3BfbWVtKTsKLQlpZiAocmV0dmFsICE9
IDApCi0JCXJldHVybiBmYWxzZTsKLQotCWtxLT5lb3BfZ3B1X2FkZHIgPSBrcS0+ZW9wX21lbS0+
Z3B1X2FkZHI7Ci0Ja3EtPmVvcF9rZXJuZWxfYWRkciA9IGtxLT5lb3BfbWVtLT5jcHVfcHRyOwot
Ci0JbWVtc2V0KGtxLT5lb3Bfa2VybmVsX2FkZHIsIDAsIFBBR0VfU0laRSk7Ci0KLQlyZXR1cm4g
dHJ1ZTsKLX0KLQotc3RhdGljIHZvaWQgdW5pbml0aWFsaXplX3YxMChzdHJ1Y3Qga2VybmVsX3F1
ZXVlICprcSkKLXsKLQlrZmRfZ3R0X3NhX2ZyZWUoa3EtPmRldiwga3EtPmVvcF9tZW0pOwotfQot
Ci1zdGF0aWMgdm9pZCBzdWJtaXRfcGFja2V0X3YxMChzdHJ1Y3Qga2VybmVsX3F1ZXVlICprcSkK
LXsKLQkqa3EtPndwdHI2NF9rZXJuZWwgPSBrcS0+cGVuZGluZ193cHRyNjQ7Ci0Jd3JpdGVfa2Vy
bmVsX2Rvb3JiZWxsNjQoa3EtPnF1ZXVlLT5wcm9wZXJ0aWVzLmRvb3JiZWxsX3B0ciwKLQkJCQlr
cS0+cGVuZGluZ193cHRyNjQpOwotfQotCi1zdGF0aWMgaW50IHBtX21hcF9wcm9jZXNzX3YxMChz
dHJ1Y3QgcGFja2V0X21hbmFnZXIgKnBtLAotCQl1aW50MzJfdCAqYnVmZmVyLCBzdHJ1Y3QgcWNt
X3Byb2Nlc3NfZGV2aWNlICpxcGQpCi17Ci0Jc3RydWN0IHBtNF9tZXNfbWFwX3Byb2Nlc3MgKnBh
Y2tldDsKLQl1aW50NjRfdCB2bV9wYWdlX3RhYmxlX2Jhc2VfYWRkciA9IHFwZC0+cGFnZV90YWJs
ZV9iYXNlOwotCi0JcGFja2V0ID0gKHN0cnVjdCBwbTRfbWVzX21hcF9wcm9jZXNzICopYnVmZmVy
OwotCW1lbXNldChidWZmZXIsIDAsIHNpemVvZihzdHJ1Y3QgcG00X21lc19tYXBfcHJvY2Vzcykp
OwotCi0JcGFja2V0LT5oZWFkZXIudTMyQWxsID0gcG1fYnVpbGRfcG00X2hlYWRlcihJVF9NQVBf
UFJPQ0VTUywKLQkJCQkJc2l6ZW9mKHN0cnVjdCBwbTRfbWVzX21hcF9wcm9jZXNzKSk7Ci0JcGFj
a2V0LT5iaXRmaWVsZHMyLmRpcV9lbmFibGUgPSAocXBkLT5pc19kZWJ1ZykgPyAxIDogMDsKLQlw
YWNrZXQtPmJpdGZpZWxkczIucHJvY2Vzc19xdWFudHVtID0gMTsKLQlwYWNrZXQtPmJpdGZpZWxk
czIucGFzaWQgPSBxcGQtPnBxbS0+cHJvY2Vzcy0+cGFzaWQ7Ci0JcGFja2V0LT5iaXRmaWVsZHMx
NC5nZHNfc2l6ZSA9IHFwZC0+Z2RzX3NpemU7Ci0JcGFja2V0LT5iaXRmaWVsZHMxNC5udW1fZ3dz
ID0gcXBkLT5udW1fZ3dzOwotCXBhY2tldC0+Yml0ZmllbGRzMTQubnVtX29hYyA9IHFwZC0+bnVt
X29hYzsKLQlwYWNrZXQtPmJpdGZpZWxkczE0LnNkbWFfZW5hYmxlID0gMTsKLQotCXBhY2tldC0+
Yml0ZmllbGRzMTQubnVtX3F1ZXVlcyA9IChxcGQtPmlzX2RlYnVnKSA/IDAgOiBxcGQtPnF1ZXVl
X2NvdW50OwotCi0JcGFja2V0LT5zaF9tZW1fY29uZmlnID0gcXBkLT5zaF9tZW1fY29uZmlnOwot
CXBhY2tldC0+c2hfbWVtX2Jhc2VzID0gcXBkLT5zaF9tZW1fYmFzZXM7Ci0JaWYgKHFwZC0+dGJh
X2FkZHIpIHsKLQkJcGFja2V0LT5zcV9zaGFkZXJfdGJhX2xvID0gbG93ZXJfMzJfYml0cyhxcGQt
PnRiYV9hZGRyID4+IDgpOwotCQlwYWNrZXQtPnNxX3NoYWRlcl90YmFfaGkgPSAoMSA8PCBTUV9T
SEFERVJfVEJBX0hJX19UUkFQX0VOX19TSElGVCkgfAotCQkJdXBwZXJfMzJfYml0cyhxcGQtPnRi
YV9hZGRyID4+IDgpOwotCQlwYWNrZXQtPnNxX3NoYWRlcl90bWFfbG8gPSBsb3dlcl8zMl9iaXRz
KHFwZC0+dG1hX2FkZHIgPj4gOCk7Ci0JCXBhY2tldC0+c3Ffc2hhZGVyX3RtYV9oaSA9IHVwcGVy
XzMyX2JpdHMocXBkLT50bWFfYWRkciA+PiA4KTsKLQl9Ci0KLQlwYWNrZXQtPmdkc19hZGRyX2xv
ID0gbG93ZXJfMzJfYml0cyhxcGQtPmdkc19jb250ZXh0X2FyZWEpOwotCXBhY2tldC0+Z2RzX2Fk
ZHJfaGkgPSB1cHBlcl8zMl9iaXRzKHFwZC0+Z2RzX2NvbnRleHRfYXJlYSk7Ci0KLQlwYWNrZXQt
PnZtX2NvbnRleHRfcGFnZV90YWJsZV9iYXNlX2FkZHJfbG8zMiA9Ci0JCQlsb3dlcl8zMl9iaXRz
KHZtX3BhZ2VfdGFibGVfYmFzZV9hZGRyKTsKLQlwYWNrZXQtPnZtX2NvbnRleHRfcGFnZV90YWJs
ZV9iYXNlX2FkZHJfaGkzMiA9Ci0JCQl1cHBlcl8zMl9iaXRzKHZtX3BhZ2VfdGFibGVfYmFzZV9h
ZGRyKTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IHBtX3J1bmxpc3RfdjEwKHN0cnVj
dCBwYWNrZXRfbWFuYWdlciAqcG0sIHVpbnQzMl90ICpidWZmZXIsCi0JCQl1aW50NjRfdCBpYiwg
c2l6ZV90IGliX3NpemVfaW5fZHdvcmRzLCBib29sIGNoYWluKQotewotCXN0cnVjdCBwbTRfbWVz
X3J1bmxpc3QgKnBhY2tldDsKLQotCWludCBjb25jdXJyZW50X3Byb2NfY250ID0gMDsKLQlzdHJ1
Y3Qga2ZkX2RldiAqa2ZkID0gcG0tPmRxbS0+ZGV2OwotCi0JLyogRGV0ZXJtaW5lIHRoZSBudW1i
ZXIgb2YgcHJvY2Vzc2VzIHRvIG1hcCB0b2dldGhlciB0byBIVzoKLQkgKiBpdCBjYW4gbm90IGV4
Y2VlZCB0aGUgbnVtYmVyIG9mIFZNSURzIGF2YWlsYWJsZSB0byB0aGUKLQkgKiBzY2hlZHVsZXIs
IGFuZCBpdCBpcyBkZXRlcm1pbmVkIGJ5IHRoZSBzbWFsbGVyIG9mIHRoZSBudW1iZXIKLQkgKiBv
ZiBwcm9jZXNzZXMgaW4gdGhlIHJ1bmxpc3QgYW5kIGtmZCBtb2R1bGUgcGFyYW1ldGVyCi0JICog
aHdzX21heF9jb25jX3Byb2MuCi0JICogTm90ZTogdGhlIGFyYml0cmF0aW9uIGJldHdlZW4gdGhl
IG51bWJlciBvZiBWTUlEcyBhbmQKLQkgKiBod3NfbWF4X2NvbmNfcHJvYyBoYXMgYmVlbiBkb25l
IGluCi0JICoga2dkMmtmZF9kZXZpY2VfaW5pdCgpLgotCSAqLwotCWNvbmN1cnJlbnRfcHJvY19j
bnQgPSBtaW4ocG0tPmRxbS0+cHJvY2Vzc2VzX2NvdW50LAotCQkJa2ZkLT5tYXhfcHJvY19wZXJf
cXVhbnR1bSk7Ci0KLQotCXBhY2tldCA9IChzdHJ1Y3QgcG00X21lc19ydW5saXN0ICopYnVmZmVy
OwotCi0JbWVtc2V0KGJ1ZmZlciwgMCwgc2l6ZW9mKHN0cnVjdCBwbTRfbWVzX3J1bmxpc3QpKTsK
LQlwYWNrZXQtPmhlYWRlci51MzJBbGwgPSBwbV9idWlsZF9wbTRfaGVhZGVyKElUX1JVTl9MSVNU
LAotCQkJCQkJc2l6ZW9mKHN0cnVjdCBwbTRfbWVzX3J1bmxpc3QpKTsKLQotCXBhY2tldC0+Yml0
ZmllbGRzNC5pYl9zaXplID0gaWJfc2l6ZV9pbl9kd29yZHM7Ci0JcGFja2V0LT5iaXRmaWVsZHM0
LmNoYWluID0gY2hhaW4gPyAxIDogMDsKLQlwYWNrZXQtPmJpdGZpZWxkczQub2ZmbG9hZF9wb2xs
aW5nID0gMDsKLQlwYWNrZXQtPmJpdGZpZWxkczQudmFsaWQgPSAxOwotCXBhY2tldC0+Yml0Zmll
bGRzNC5wcm9jZXNzX2NudCA9IGNvbmN1cnJlbnRfcHJvY19jbnQ7Ci0JcGFja2V0LT5vcmRpbmFs
MiA9IGxvd2VyXzMyX2JpdHMoaWIpOwotCXBhY2tldC0+aWJfYmFzZV9oaSA9IHVwcGVyXzMyX2Jp
dHMoaWIpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgcG1fbWFwX3F1ZXVlc192MTAo
c3RydWN0IHBhY2tldF9tYW5hZ2VyICpwbSwgdWludDMyX3QgKmJ1ZmZlciwKLQkJc3RydWN0IHF1
ZXVlICpxLCBib29sIGlzX3N0YXRpYykKLXsKLQlzdHJ1Y3QgcG00X21lc19tYXBfcXVldWVzICpw
YWNrZXQ7Ci0JYm9vbCB1c2Vfc3RhdGljID0gaXNfc3RhdGljOwotCi0JcGFja2V0ID0gKHN0cnVj
dCBwbTRfbWVzX21hcF9xdWV1ZXMgKilidWZmZXI7Ci0JbWVtc2V0KGJ1ZmZlciwgMCwgc2l6ZW9m
KHN0cnVjdCBwbTRfbWVzX21hcF9xdWV1ZXMpKTsKLQotCXBhY2tldC0+aGVhZGVyLnUzMkFsbCA9
IHBtX2J1aWxkX3BtNF9oZWFkZXIoSVRfTUFQX1FVRVVFUywKLQkJCQkJc2l6ZW9mKHN0cnVjdCBw
bTRfbWVzX21hcF9xdWV1ZXMpKTsKLQlwYWNrZXQtPmJpdGZpZWxkczIubnVtX3F1ZXVlcyA9IDE7
Ci0JcGFja2V0LT5iaXRmaWVsZHMyLnF1ZXVlX3NlbCA9Ci0JCXF1ZXVlX3NlbF9fbWVzX21hcF9x
dWV1ZXNfX21hcF90b19od3NfZGV0ZXJtaW5lZF9xdWV1ZV9zbG90c192aTsKLQotCXBhY2tldC0+
Yml0ZmllbGRzMi5lbmdpbmVfc2VsID0KLQkJZW5naW5lX3NlbF9fbWVzX21hcF9xdWV1ZXNfX2Nv
bXB1dGVfdmk7Ci0JcGFja2V0LT5iaXRmaWVsZHMyLnF1ZXVlX3R5cGUgPQotCQlxdWV1ZV90eXBl
X19tZXNfbWFwX3F1ZXVlc19fbm9ybWFsX2NvbXB1dGVfdmk7Ci0KLQlzd2l0Y2ggKHEtPnByb3Bl
cnRpZXMudHlwZSkgewotCWNhc2UgS0ZEX1FVRVVFX1RZUEVfQ09NUFVURToKLQkJaWYgKHVzZV9z
dGF0aWMpCi0JCQlwYWNrZXQtPmJpdGZpZWxkczIucXVldWVfdHlwZSA9Ci0JCXF1ZXVlX3R5cGVf
X21lc19tYXBfcXVldWVzX19ub3JtYWxfbGF0ZW5jeV9zdGF0aWNfcXVldWVfdmk7Ci0JCWJyZWFr
OwotCWNhc2UgS0ZEX1FVRVVFX1RZUEVfRElROgotCQlwYWNrZXQtPmJpdGZpZWxkczIucXVldWVf
dHlwZSA9Ci0JCQlxdWV1ZV90eXBlX19tZXNfbWFwX3F1ZXVlc19fZGVidWdfaW50ZXJmYWNlX3F1
ZXVlX3ZpOwotCQlicmVhazsKLQljYXNlIEtGRF9RVUVVRV9UWVBFX1NETUE6Ci0JY2FzZSBLRkRf
UVVFVUVfVFlQRV9TRE1BX1hHTUk6Ci0JCXBhY2tldC0+Yml0ZmllbGRzMi5lbmdpbmVfc2VsID0g
cS0+cHJvcGVydGllcy5zZG1hX2VuZ2luZV9pZCArCi0JCQkJZW5naW5lX3NlbF9fbWVzX21hcF9x
dWV1ZXNfX3NkbWEwX3ZpOwotCQl1c2Vfc3RhdGljID0gZmFsc2U7IC8qIG5vIHN0YXRpYyBxdWV1
ZXMgdW5kZXIgU0RNQSAqLwotCQlicmVhazsKLQlkZWZhdWx0OgotCQlXQVJOKDEsICJxdWV1ZSB0
eXBlICVkXG4iLCBxLT5wcm9wZXJ0aWVzLnR5cGUpOwotCQlyZXR1cm4gLUVJTlZBTDsKLQl9Ci0J
cGFja2V0LT5iaXRmaWVsZHMzLmRvb3JiZWxsX29mZnNldCA9Ci0JCQlxLT5wcm9wZXJ0aWVzLmRv
b3JiZWxsX29mZjsKLQotCXBhY2tldC0+bXFkX2FkZHJfbG8gPQotCQkJbG93ZXJfMzJfYml0cyhx
LT5nYXJ0X21xZF9hZGRyKTsKLQotCXBhY2tldC0+bXFkX2FkZHJfaGkgPQotCQkJdXBwZXJfMzJf
Yml0cyhxLT5nYXJ0X21xZF9hZGRyKTsKLQotCXBhY2tldC0+d3B0cl9hZGRyX2xvID0KLQkJCWxv
d2VyXzMyX2JpdHMoKHVpbnQ2NF90KXEtPnByb3BlcnRpZXMud3JpdGVfcHRyKTsKLQotCXBhY2tl
dC0+d3B0cl9hZGRyX2hpID0KLQkJCXVwcGVyXzMyX2JpdHMoKHVpbnQ2NF90KXEtPnByb3BlcnRp
ZXMud3JpdGVfcHRyKTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IHBtX3VubWFwX3F1
ZXVlc192MTAoc3RydWN0IHBhY2tldF9tYW5hZ2VyICpwbSwgdWludDMyX3QgKmJ1ZmZlciwKLQkJ
CWVudW0ga2ZkX3F1ZXVlX3R5cGUgdHlwZSwKLQkJCWVudW0ga2ZkX3VubWFwX3F1ZXVlc19maWx0
ZXIgZmlsdGVyLAotCQkJdWludDMyX3QgZmlsdGVyX3BhcmFtLCBib29sIHJlc2V0LAotCQkJdW5z
aWduZWQgaW50IHNkbWFfZW5naW5lKQotewotCXN0cnVjdCBwbTRfbWVzX3VubWFwX3F1ZXVlcyAq
cGFja2V0OwotCi0JcGFja2V0ID0gKHN0cnVjdCBwbTRfbWVzX3VubWFwX3F1ZXVlcyAqKWJ1ZmZl
cjsKLQltZW1zZXQoYnVmZmVyLCAwLCBzaXplb2Yoc3RydWN0IHBtNF9tZXNfdW5tYXBfcXVldWVz
KSk7Ci0KLQlwYWNrZXQtPmhlYWRlci51MzJBbGwgPSBwbV9idWlsZF9wbTRfaGVhZGVyKElUX1VO
TUFQX1FVRVVFUywKLQkJCQkJc2l6ZW9mKHN0cnVjdCBwbTRfbWVzX3VubWFwX3F1ZXVlcykpOwot
CXN3aXRjaCAodHlwZSkgewotCWNhc2UgS0ZEX1FVRVVFX1RZUEVfQ09NUFVURToKLQljYXNlIEtG
RF9RVUVVRV9UWVBFX0RJUToKLQkJcGFja2V0LT5iaXRmaWVsZHMyLmVuZ2luZV9zZWwgPQotCQkJ
ZW5naW5lX3NlbF9fbWVzX3VubWFwX3F1ZXVlc19fY29tcHV0ZTsKLQkJYnJlYWs7Ci0JY2FzZSBL
RkRfUVVFVUVfVFlQRV9TRE1BOgotCWNhc2UgS0ZEX1FVRVVFX1RZUEVfU0RNQV9YR01JOgotCQlw
YWNrZXQtPmJpdGZpZWxkczIuZW5naW5lX3NlbCA9Ci0JCQllbmdpbmVfc2VsX19tZXNfdW5tYXBf
cXVldWVzX19zZG1hMCArIHNkbWFfZW5naW5lOwotCQlicmVhazsKLQlkZWZhdWx0OgotCQlXQVJO
KDEsICJxdWV1ZSB0eXBlICVkXG4iLCB0eXBlKTsKLQkJYnJlYWs7Ci0JfQotCi0JaWYgKHJlc2V0
KQotCQlwYWNrZXQtPmJpdGZpZWxkczIuYWN0aW9uID0KLQkJCWFjdGlvbl9fbWVzX3VubWFwX3F1
ZXVlc19fcmVzZXRfcXVldWVzOwotCWVsc2UKLQkJcGFja2V0LT5iaXRmaWVsZHMyLmFjdGlvbiA9
Ci0JCQlhY3Rpb25fX21lc191bm1hcF9xdWV1ZXNfX3ByZWVtcHRfcXVldWVzOwotCi0Jc3dpdGNo
IChmaWx0ZXIpIHsKLQljYXNlIEtGRF9VTk1BUF9RVUVVRVNfRklMVEVSX1NJTkdMRV9RVUVVRToK
LQkJcGFja2V0LT5iaXRmaWVsZHMyLnF1ZXVlX3NlbCA9Ci0JCQlxdWV1ZV9zZWxfX21lc191bm1h
cF9xdWV1ZXNfX3BlcmZvcm1fcmVxdWVzdF9vbl9zcGVjaWZpZWRfcXVldWVzOwotCQlwYWNrZXQt
PmJpdGZpZWxkczIubnVtX3F1ZXVlcyA9IDE7Ci0JCXBhY2tldC0+Yml0ZmllbGRzM2IuZG9vcmJl
bGxfb2Zmc2V0MCA9IGZpbHRlcl9wYXJhbTsKLQkJYnJlYWs7Ci0JY2FzZSBLRkRfVU5NQVBfUVVF
VUVTX0ZJTFRFUl9CWV9QQVNJRDoKLQkJcGFja2V0LT5iaXRmaWVsZHMyLnF1ZXVlX3NlbCA9Ci0J
CQlxdWV1ZV9zZWxfX21lc191bm1hcF9xdWV1ZXNfX3BlcmZvcm1fcmVxdWVzdF9vbl9wYXNpZF9x
dWV1ZXM7Ci0JCXBhY2tldC0+Yml0ZmllbGRzM2EucGFzaWQgPSBmaWx0ZXJfcGFyYW07Ci0JCWJy
ZWFrOwotCWNhc2UgS0ZEX1VOTUFQX1FVRVVFU19GSUxURVJfQUxMX1FVRVVFUzoKLQkJcGFja2V0
LT5iaXRmaWVsZHMyLnF1ZXVlX3NlbCA9Ci0JCQlxdWV1ZV9zZWxfX21lc191bm1hcF9xdWV1ZXNf
X3VubWFwX2FsbF9xdWV1ZXM7Ci0JCWJyZWFrOwotCWNhc2UgS0ZEX1VOTUFQX1FVRVVFU19GSUxU
RVJfRFlOQU1JQ19RVUVVRVM6Ci0JCS8qIGluIHRoaXMgY2FzZSwgd2UgZG8gbm90IHByZWVtcHQg
c3RhdGljIHF1ZXVlcyAqLwotCQlwYWNrZXQtPmJpdGZpZWxkczIucXVldWVfc2VsID0KLQkJCXF1
ZXVlX3NlbF9fbWVzX3VubWFwX3F1ZXVlc19fdW5tYXBfYWxsX25vbl9zdGF0aWNfcXVldWVzOwot
CQlicmVhazsKLQlkZWZhdWx0OgotCQlXQVJOKDEsICJmaWx0ZXIgJWRcbiIsIGZpbHRlcik7Ci0J
CWJyZWFrOwotCX0KLQotCXJldHVybiAwOwotCi19Ci0KLXN0YXRpYyBpbnQgcG1fcXVlcnlfc3Rh
dHVzX3YxMChzdHJ1Y3QgcGFja2V0X21hbmFnZXIgKnBtLCB1aW50MzJfdCAqYnVmZmVyLAotCQkJ
dWludDY0X3QgZmVuY2VfYWRkcmVzcywJdWludDMyX3QgZmVuY2VfdmFsdWUpCi17Ci0Jc3RydWN0
IHBtNF9tZXNfcXVlcnlfc3RhdHVzICpwYWNrZXQ7Ci0KLQlwYWNrZXQgPSAoc3RydWN0IHBtNF9t
ZXNfcXVlcnlfc3RhdHVzICopYnVmZmVyOwotCW1lbXNldChidWZmZXIsIDAsIHNpemVvZihzdHJ1
Y3QgcG00X21lc19xdWVyeV9zdGF0dXMpKTsKLQotCi0JcGFja2V0LT5oZWFkZXIudTMyQWxsID0g
cG1fYnVpbGRfcG00X2hlYWRlcihJVF9RVUVSWV9TVEFUVVMsCi0JCQkJCXNpemVvZihzdHJ1Y3Qg
cG00X21lc19xdWVyeV9zdGF0dXMpKTsKLQotCXBhY2tldC0+Yml0ZmllbGRzMi5jb250ZXh0X2lk
ID0gMDsKLQlwYWNrZXQtPmJpdGZpZWxkczIuaW50ZXJydXB0X3NlbCA9Ci0JCQlpbnRlcnJ1cHRf
c2VsX19tZXNfcXVlcnlfc3RhdHVzX19jb21wbGV0aW9uX3N0YXR1czsKLQlwYWNrZXQtPmJpdGZp
ZWxkczIuY29tbWFuZCA9Ci0JCQljb21tYW5kX19tZXNfcXVlcnlfc3RhdHVzX19mZW5jZV9vbmx5
X2FmdGVyX3dyaXRlX2FjazsKLQotCXBhY2tldC0+YWRkcl9oaSA9IHVwcGVyXzMyX2JpdHMoKHVp
bnQ2NF90KWZlbmNlX2FkZHJlc3MpOwotCXBhY2tldC0+YWRkcl9sbyA9IGxvd2VyXzMyX2JpdHMo
KHVpbnQ2NF90KWZlbmNlX2FkZHJlc3MpOwotCXBhY2tldC0+ZGF0YV9oaSA9IHVwcGVyXzMyX2Jp
dHMoKHVpbnQ2NF90KWZlbmNlX3ZhbHVlKTsKLQlwYWNrZXQtPmRhdGFfbG8gPSBsb3dlcl8zMl9i
aXRzKCh1aW50NjRfdClmZW5jZV92YWx1ZSk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotY29uc3Qgc3Ry
dWN0IHBhY2tldF9tYW5hZ2VyX2Z1bmNzIGtmZF92MTBfcG1fZnVuY3MgPSB7Ci0JLm1hcF9wcm9j
ZXNzCQkJPSBwbV9tYXBfcHJvY2Vzc192MTAsCi0JLnJ1bmxpc3QJCQk9IHBtX3J1bmxpc3RfdjEw
LAotCS5zZXRfcmVzb3VyY2VzCQkJPSBwbV9zZXRfcmVzb3VyY2VzX3ZpLAotCS5tYXBfcXVldWVz
CQkJPSBwbV9tYXBfcXVldWVzX3YxMCwKLQkudW5tYXBfcXVldWVzCQkJPSBwbV91bm1hcF9xdWV1
ZXNfdjEwLAotCS5xdWVyeV9zdGF0dXMJCQk9IHBtX3F1ZXJ5X3N0YXR1c192MTAsCi0JLnJlbGVh
c2VfbWVtCQkJPSBOVUxMLAotCS5tYXBfcHJvY2Vzc19zaXplCQk9IHNpemVvZihzdHJ1Y3QgcG00
X21lc19tYXBfcHJvY2VzcyksCi0JLnJ1bmxpc3Rfc2l6ZQkJCT0gc2l6ZW9mKHN0cnVjdCBwbTRf
bWVzX3J1bmxpc3QpLAotCS5zZXRfcmVzb3VyY2VzX3NpemUJCT0gc2l6ZW9mKHN0cnVjdCBwbTRf
bWVzX3NldF9yZXNvdXJjZXMpLAotCS5tYXBfcXVldWVzX3NpemUJCT0gc2l6ZW9mKHN0cnVjdCBw
bTRfbWVzX21hcF9xdWV1ZXMpLAotCS51bm1hcF9xdWV1ZXNfc2l6ZQkJPSBzaXplb2Yoc3RydWN0
IHBtNF9tZXNfdW5tYXBfcXVldWVzKSwKLQkucXVlcnlfc3RhdHVzX3NpemUJCT0gc2l6ZW9mKHN0
cnVjdCBwbTRfbWVzX3F1ZXJ5X3N0YXR1cyksCi0JLnJlbGVhc2VfbWVtX3NpemUJCT0gMCwKLX07
Ci0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9rZXJuZWxfcXVl
dWVfdjkuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9rZXJuZWxfcXVldWVfdjku
YwppbmRleCBmMGU0OTEwYTg4NjUuLjllMGVhZjQ0NmJhYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRrZmQva2ZkX2tlcm5lbF9xdWV1ZV92OS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1ka2ZkL2tmZF9rZXJuZWxfcXVldWVfdjkuYwpAQCAtMjUsNiArMjUsNyBAQAog
I2luY2x1ZGUgImtmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5oIgogI2luY2x1ZGUgImtmZF9wbTRf
aGVhZGVyc19haS5oIgogI2luY2x1ZGUgImtmZF9wbTRfb3Bjb2Rlcy5oIgorI2luY2x1ZGUgImdj
L2djXzEwXzFfMF9zaF9tYXNrLmgiCiAKIHN0YXRpYyBib29sIGluaXRpYWxpemVfdjkoc3RydWN0
IGtlcm5lbF9xdWV1ZSAqa3EsIHN0cnVjdCBrZmRfZGV2ICpkZXYsCiAJCQllbnVtIGtmZF9xdWV1
ZV90eXBlIHR5cGUsIHVuc2lnbmVkIGludCBxdWV1ZV9zaXplKQpAQCAtODUsMTAgKzg2LDE3IEBA
IHN0YXRpYyBpbnQgcG1fbWFwX3Byb2Nlc3Nfdjkoc3RydWN0IHBhY2tldF9tYW5hZ2VyICpwbSwK
IAogCXBhY2tldC0+c2hfbWVtX2NvbmZpZyA9IHFwZC0+c2hfbWVtX2NvbmZpZzsKIAlwYWNrZXQt
PnNoX21lbV9iYXNlcyA9IHFwZC0+c2hfbWVtX2Jhc2VzOwotCXBhY2tldC0+c3Ffc2hhZGVyX3Ri
YV9sbyA9IGxvd2VyXzMyX2JpdHMocXBkLT50YmFfYWRkciA+PiA4KTsKLQlwYWNrZXQtPnNxX3No
YWRlcl90YmFfaGkgPSB1cHBlcl8zMl9iaXRzKHFwZC0+dGJhX2FkZHIgPj4gOCk7Ci0JcGFja2V0
LT5zcV9zaGFkZXJfdG1hX2xvID0gbG93ZXJfMzJfYml0cyhxcGQtPnRtYV9hZGRyID4+IDgpOwot
CXBhY2tldC0+c3Ffc2hhZGVyX3RtYV9oaSA9IHVwcGVyXzMyX2JpdHMocXBkLT50bWFfYWRkciA+
PiA4KTsKKwlpZiAocXBkLT50YmFfYWRkcikgeworCQlwYWNrZXQtPnNxX3NoYWRlcl90YmFfbG8g
PSBsb3dlcl8zMl9iaXRzKHFwZC0+dGJhX2FkZHIgPj4gOCk7CisJCS8qIE9uIEdGWDksIHVubGlr
ZSBHRlgxMCwgYml0IFRSQVBfRU4gb2YgU1FfU0hBREVSX1RCQV9ISSBpcworCQkgKiBub3QgZGVm
aW5lZCwgc28gc2V0dGluZyBpdCB3b24ndCBkbyBhbnkgaGFybS4KKwkJICovCisJCXBhY2tldC0+
c3Ffc2hhZGVyX3RiYV9oaSA9IHVwcGVyXzMyX2JpdHMocXBkLT50YmFfYWRkciA+PiA4KQorCQkJ
CXwgMSA8PCBTUV9TSEFERVJfVEJBX0hJX19UUkFQX0VOX19TSElGVDsKKworCQlwYWNrZXQtPnNx
X3NoYWRlcl90bWFfbG8gPSBsb3dlcl8zMl9iaXRzKHFwZC0+dG1hX2FkZHIgPj4gOCk7CisJCXBh
Y2tldC0+c3Ffc2hhZGVyX3RtYV9oaSA9IHVwcGVyXzMyX2JpdHMocXBkLT50bWFfYWRkciA+PiA4
KTsKKwl9CiAKIAlwYWNrZXQtPmdkc19hZGRyX2xvID0gbG93ZXJfMzJfYml0cyhxcGQtPmdkc19j
b250ZXh0X2FyZWEpOwogCXBhY2tldC0+Z2RzX2FkZHJfaGkgPSB1cHBlcl8zMl9iaXRzKHFwZC0+
Z2RzX2NvbnRleHRfYXJlYSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtm
ZC9rZmRfcGFja2V0X21hbmFnZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9w
YWNrZXRfbWFuYWdlci5jCmluZGV4IDgzZWY0YjNkZDJmYi4uNzAwYmU0ZjgwODY3IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfcGFja2V0X21hbmFnZXIuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfcGFja2V0X21hbmFnZXIuYwpAQCAtMjQx
LDEyICsyNDEsMTAgQEAgaW50IHBtX2luaXQoc3RydWN0IHBhY2tldF9tYW5hZ2VyICpwbSwgc3Ry
dWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0pCiAJY2FzZSBDSElQX1JBVkVOOgogCWNhc2Ug
Q0hJUF9SRU5PSVI6CiAJY2FzZSBDSElQX0FSQ1RVUlVTOgotCQlwbS0+cG1mID0gJmtmZF92OV9w
bV9mdW5jczsKLQkJYnJlYWs7CiAJY2FzZSBDSElQX05BVkkxMDoKIAljYXNlIENISVBfTkFWSTEy
OgogCWNhc2UgQ0hJUF9OQVZJMTQ6Ci0JCXBtLT5wbWYgPSAma2ZkX3YxMF9wbV9mdW5jczsKKwkJ
cG0tPnBtZiA9ICZrZmRfdjlfcG1fZnVuY3M7CiAJCWJyZWFrOwogCWRlZmF1bHQ6CiAJCVdBUk4o
MSwgIlVuZXhwZWN0ZWQgQVNJQyBmYW1pbHkgJXUiLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRrZmQva2ZkX3ByaXYuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tm
ZF9wcml2LmgKaW5kZXggNjJkYjRkMjBlZDMyLi5mMjA3OGJmYjhhZTEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9wcml2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRrZmQva2ZkX3ByaXYuaApAQCAtOTc3LDcgKzk3Nyw2IEBAIHN0cnVjdCBwYWNrZXRf
bWFuYWdlcl9mdW5jcyB7CiAKIGV4dGVybiBjb25zdCBzdHJ1Y3QgcGFja2V0X21hbmFnZXJfZnVu
Y3Mga2ZkX3ZpX3BtX2Z1bmNzOwogZXh0ZXJuIGNvbnN0IHN0cnVjdCBwYWNrZXRfbWFuYWdlcl9m
dW5jcyBrZmRfdjlfcG1fZnVuY3M7Ci1leHRlcm4gY29uc3Qgc3RydWN0IHBhY2tldF9tYW5hZ2Vy
X2Z1bmNzIGtmZF92MTBfcG1fZnVuY3M7CiAKIGludCBwbV9pbml0KHN0cnVjdCBwYWNrZXRfbWFu
YWdlciAqcG0sIHN0cnVjdCBkZXZpY2VfcXVldWVfbWFuYWdlciAqZHFtKTsKIHZvaWQgcG1fdW5p
bml0KHN0cnVjdCBwYWNrZXRfbWFuYWdlciAqcG0pOwpAQCAtOTk2LDkgKzk5NSw2IEBAIHZvaWQg
cG1fcmVsZWFzZV9pYihzdHJ1Y3QgcGFja2V0X21hbmFnZXIgKnBtKTsKIAogLyogRm9sbG93aW5n
IFBNIGZ1bmNzIGNhbiBiZSBzaGFyZWQgYW1vbmcgVkkgYW5kIEFJICovCiB1bnNpZ25lZCBpbnQg
cG1fYnVpbGRfcG00X2hlYWRlcih1bnNpZ25lZCBpbnQgb3Bjb2RlLCBzaXplX3QgcGFja2V0X3Np
emUpOwotaW50IHBtX3NldF9yZXNvdXJjZXNfdmkoc3RydWN0IHBhY2tldF9tYW5hZ2VyICpwbSwg
dWludDMyX3QgKmJ1ZmZlciwKLQkJCXN0cnVjdCBzY2hlZHVsaW5nX3Jlc291cmNlcyAqcmVzKTsK
LQogCiB1aW50NjRfdCBrZmRfZ2V0X251bWJlcl9lbGVtcyhzdHJ1Y3Qga2ZkX2RldiAqa2ZkKTsK
IAotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
