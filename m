Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E12D5B73C3
	for <lists+amd-gfx@lfdr.de>; Thu, 19 Sep 2019 09:12:38 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 717566F8B7;
	Thu, 19 Sep 2019 07:12:37 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM05-CO1-obe.outbound.protection.outlook.com
 (mail-co1nam05on0613.outbound.protection.outlook.com
 [IPv6:2a01:111:f400:fe50::613])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4B83D6F8B7
 for <amd-gfx@lists.freedesktop.org>; Thu, 19 Sep 2019 07:12:35 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Bn2/zEAso+CnrfSdpJYnF/Isgndm7eoTPshOdX5uom+CgrmeU8KdaNzsN0X+pS/ChFvFIBQTXmQ3NsLvyEba0bFLHgtnevoguWq6RjeiuQ287QcMYysDddTzyLV7b9Ce0JqWxxxHyQUK4cWywDAYAtnHivZizT+EK74yI6/49SRfH52f8Q0ZxxJgLqZqxQDN8iW/INYSE85JeYAGf6T29o0qqxpH3Xa26Kl+DkfAXgiIT8fquSx0U0wEV32txVwKkRlEnnsYCmvEkdL7BYozXjUk2FOVCdP5Jd1FpNkTUpHVSIFohSaq53zgdd4TZVcdRSbH0SJEfGtetGVh+BwsaA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=vyN2elYYI4XIJ9kCXnKw/XzI3+4oHZKZ+ERWQ8+AWfs=;
 b=Z5CFJPIeYgVEyRd9PY1nx/44R8r8wO2lVPhFwf3mbBoAfPTsIXo8dhUP6dgCOyaVuUvZiK1MFQt/xCsbszZ8UI6u0tYIThaXwFfQinFB1HbIMk0317r/BJyBbOK4PHeG6OcpanD7qy6/QAol2g5PQLIDLAaQm+jUp6GT5WC576oHKdHRj5+iEbu/qYshM65HnCNwQzjm7953kRGpmmbJ1gjEGrDPGAKbFv5zYZOWhbIq0oPijDB0bZL44NBhTIPz9s3q1zG/j7ZdN6eDsLmbrNsEzMd46yOU9a683GSR1I7C53kbSzwoU/USseVnvd6vrG3paKtvs76BBGpUJupBBg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from MN2PR12MB3054.namprd12.prod.outlook.com (20.178.244.79) by
 MN2PR12MB2894.namprd12.prod.outlook.com (20.179.84.155) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2284.20; Thu, 19 Sep 2019 07:12:32 +0000
Received: from MN2PR12MB3054.namprd12.prod.outlook.com
 ([fe80::f8cf:7a84:723c:27d0]) by MN2PR12MB3054.namprd12.prod.outlook.com
 ([fe80::f8cf:7a84:723c:27d0%3]) with mapi id 15.20.2263.023; Thu, 19 Sep 2019
 07:12:32 +0000
From: "Zhou1, Tao" <Tao.Zhou1@amd.com>
To: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>, "Chen,
 Guchun" <Guchun.Chen@amd.com>, "Zhang, Hawking" <Hawking.Zhang@amd.com>
Subject: [PATCH 02/21] drm/amdgpu: move umc ras irq functions to umc block
Thread-Topic: [PATCH 02/21] drm/amdgpu: move umc ras irq functions to umc block
Thread-Index: AQHVbrmarrL3Zd4zREq01ZP3U7SoWQ==
Date: Thu, 19 Sep 2019 07:12:32 +0000
Message-ID: <20190919071115.16552-3-tao.zhou1@amd.com>
References: <20190919071115.16552-1-tao.zhou1@amd.com>
In-Reply-To: <20190919071115.16552-1-tao.zhou1@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: HK0PR03CA0092.apcprd03.prod.outlook.com
 (2603:1096:203:72::32) To MN2PR12MB3054.namprd12.prod.outlook.com
 (2603:10b6:208:d1::15)
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.17.1
x-originating-ip: [180.167.199.189]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 28e1f626-62b7-424c-05ff-08d73cd0bd38
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(5600167)(711020)(4605104)(1401327)(4618075)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(2017052603328)(7193020);
 SRVR:MN2PR12MB2894; 
x-ms-traffictypediagnostic: MN2PR12MB2894:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <MN2PR12MB2894B127236FF0EE11952461B0890@MN2PR12MB2894.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:525;
x-forefront-prvs: 016572D96D
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(136003)(346002)(376002)(396003)(39860400002)(366004)(199004)(189003)(186003)(6506007)(102836004)(6512007)(316002)(8676002)(81156014)(64756008)(446003)(2501003)(52116002)(11346002)(476003)(2616005)(66446008)(86362001)(8936002)(5660300002)(66946007)(66476007)(81166006)(66556008)(50226002)(3846002)(2906002)(486006)(76176011)(99286004)(110136005)(6116002)(25786009)(7736002)(256004)(1076003)(66066001)(26005)(14454004)(386003)(6436002)(6486002)(4326008)(478600001)(71190400001)(71200400001)(6636002)(305945005)(36756003);
 DIR:OUT; SFP:1101; SCL:1; SRVR:MN2PR12MB2894;
 H:MN2PR12MB3054.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: CkWRYgqTTOeHlAn9QOVMirgTa320kh4FQPEYEUYYa1+DRWqAVO9uyKxWKJkShLjP8fuwyIj1gLzd+GPlRc+ZLszPVx7i1WUh5MtxcdpKOxgxdPKXD/Ut7D2jAju68mUydeoQ44vVBCg6HTdyz83Vlz0uXlqAjznqdLTXVw8a8TEINBIDDRQMZyxG86cewM46kWLVIfQXEVD3QXdPugkLnyRIPEycWa01Tr06CmrdSFdkLGczWWIfkzif8ygcgiZYuJw4zw65ntEq0PpcPAVMYEaKKqyCGCEJYreXxZYYdM+op9AV2ZmErmfKC94wwEkP0+JMqyJtXhPOTgNOFjVc1j+hfDVvc0I29e0Vo8uExGT8mSCIa5XnTuLO/ao+AYqKcmvqbg29u2HoSU7MIZYDXr8duY1HVfXDBYlkoC3DN8I=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 28e1f626-62b7-424c-05ff-08d73cd0bd38
X-MS-Exchange-CrossTenant-originalarrivaltime: 19 Sep 2019 07:12:32.4442 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: ioz5I0/dHo1J+ayRZESVryxb/wIUhCUgMoMXVgsFP5GIDzusttYf9m8YK1/ZqEKF
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR12MB2894
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=vyN2elYYI4XIJ9kCXnKw/XzI3+4oHZKZ+ERWQ8+AWfs=;
 b=1r4+LoLWKNyj+H0YbPndHyIEC2/GbJV/va7kPe6AsAJwcqEksUKCwurNGCF7VwQ6vJYcXEBGbr9Gu5sk6x138VoWGI9kQNqHwmrbiiSHMc+Bk+gZfw+Sbp1TIh0FxeQ56467Pg5C3CZB/JOPNoTvDi5bp9hFeddIODYZ/TthfAw=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Tao.Zhou1@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Zhou1, Tao" <Tao.Zhou1@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

bW92ZSB1bWMgcmFzIGlycSBmdW5jdGlvbnMgZnJvbSBnbWMgdjkgdG8gZ2VuZXJpYyB1bWMgYmxv
Y2sKClNpZ25lZC1vZmYtYnk6IFRhbyBaaG91IDx0YW8uemhvdTFAYW1kLmNvbT4KLS0tCiBkcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdW1jLmMgfCA2NSArKysrKysrKysrKysrKysr
KysrKysrLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3VtYy5oIHwgIDYgKysr
CiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjlfMC5jICAgfCA2OCArLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tCiAzIGZpbGVzIGNoYW5nZWQsIDcyIGluc2VydGlvbnMoKyksIDY3IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV91bWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV91bWMuYwppbmRleCBj
NWQ4YjA4YWY3MzEuLmQxMWI0ZDM4Y2ExZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3VtYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV91bWMuYwpAQCAtMjEsNyArMjEsNiBAQAogICoKICAqLwogCi0jaW5jbHVkZSAiYW1kZ3B1
LmgiCiAjaW5jbHVkZSAiYW1kZ3B1X3Jhcy5oIgogCiBpbnQgYW1kZ3B1X3VtY19yYXNfbGF0ZV9p
bml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB2b2lkICpyYXNfaWhfaW5mbykKQEAgLTc1
LDMgKzc0LDY3IEBAIGludCBhbWRncHVfdW1jX3Jhc19sYXRlX2luaXQoc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYsIHZvaWQgKnJhc19paF9pbmZvKQogCWFkZXYtPmdtYy51bWNfcmFzX2lmID0g
TlVMTDsKIAlyZXR1cm4gcjsKIH0KKworaW50IGFtZGdwdV91bWNfcHJvY2Vzc19yYXNfZGF0YV9j
YihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKKwkJdm9pZCAqcmFzX2Vycm9yX3N0YXR1cywK
KwkJc3RydWN0IGFtZGdwdV9pdl9lbnRyeSAqZW50cnkpCit7CisJc3RydWN0IHJhc19lcnJfZGF0
YSAqZXJyX2RhdGEgPSAoc3RydWN0IHJhc19lcnJfZGF0YSAqKXJhc19lcnJvcl9zdGF0dXM7CisK
KwlpZiAoYW1kZ3B1X3Jhc19pc19zdXBwb3J0ZWQoYWRldiwgQU1ER1BVX1JBU19CTE9DS19fR0ZY
KSkKKwkJcmV0dXJuIEFNREdQVV9SQVNfU1VDQ0VTUzsKKworCWtnZDJrZmRfc2V0X3NyYW1fZWNj
X2ZsYWcoYWRldi0+a2ZkLmRldik7CisJaWYgKGFkZXYtPnVtYy5mdW5jcyAmJgorCSAgICBhZGV2
LT51bWMuZnVuY3MtPnF1ZXJ5X3Jhc19lcnJvcl9jb3VudCkKKwkgICAgYWRldi0+dW1jLmZ1bmNz
LT5xdWVyeV9yYXNfZXJyb3JfY291bnQoYWRldiwgcmFzX2Vycm9yX3N0YXR1cyk7CisKKwlpZiAo
YWRldi0+dW1jLmZ1bmNzICYmCisJICAgIGFkZXYtPnVtYy5mdW5jcy0+cXVlcnlfcmFzX2Vycm9y
X2FkZHJlc3MgJiYKKwkgICAgYWRldi0+dW1jLm1heF9yYXNfZXJyX2NudF9wZXJfcXVlcnkpIHsK
KwkJZXJyX2RhdGEtPmVycl9hZGRyID0KKwkJCWtjYWxsb2MoYWRldi0+dW1jLm1heF9yYXNfZXJy
X2NudF9wZXJfcXVlcnksCisJCQkJc2l6ZW9mKHN0cnVjdCBlZXByb21fdGFibGVfcmVjb3JkKSwg
R0ZQX0tFUk5FTCk7CisJCS8qIHN0aWxsIGNhbGwgcXVlcnlfcmFzX2Vycm9yX2FkZHJlc3MgdG8g
Y2xlYXIgZXJyb3Igc3RhdHVzCisJCSAqIGV2ZW4gTk9NRU0gZXJyb3IgaXMgZW5jb3VudGVyZWQK
KwkJICovCisJCWlmKCFlcnJfZGF0YS0+ZXJyX2FkZHIpCisJCQlEUk1fV0FSTigiRmFpbGVkIHRv
IGFsbG9jIG1lbW9yeSBmb3IgdW1jIGVycm9yIGFkZHJlc3MgcmVjb3JkIVxuIik7CisKKwkJLyog
dW1jIHF1ZXJ5X3Jhc19lcnJvcl9hZGRyZXNzIGlzIGFsc28gcmVzcG9uc2libGUgZm9yIGNsZWFy
aW5nCisJCSAqIGVycm9yIHN0YXR1cworCQkgKi8KKwkJYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9y
YXNfZXJyb3JfYWRkcmVzcyhhZGV2LCByYXNfZXJyb3Jfc3RhdHVzKTsKKwl9CisKKwkvKiBvbmx5
IHVuY29ycmVjdGFibGUgZXJyb3IgbmVlZHMgZ3B1IHJlc2V0ICovCisJaWYgKGVycl9kYXRhLT51
ZV9jb3VudCkgeworCQlpZiAoZXJyX2RhdGEtPmVycl9hZGRyX2NudCAmJgorCQkgICAgYW1kZ3B1
X3Jhc19hZGRfYmFkX3BhZ2VzKGFkZXYsIGVycl9kYXRhLT5lcnJfYWRkciwKKwkJCQkJCWVycl9k
YXRhLT5lcnJfYWRkcl9jbnQpKQorCQkJRFJNX1dBUk4oIkZhaWxlZCB0byBhZGQgcmFzIGJhZCBw
YWdlIVxuIik7CisKKwkJYW1kZ3B1X3Jhc19yZXNldF9ncHUoYWRldiwgMCk7CisJfQorCisJa2Zy
ZWUoZXJyX2RhdGEtPmVycl9hZGRyKTsKKwlyZXR1cm4gQU1ER1BVX1JBU19TVUNDRVNTOworfQor
CitpbnQgYW1kZ3B1X3VtY19wcm9jZXNzX2VjY19pcnEoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYsCisJCXN0cnVjdCBhbWRncHVfaXJxX3NyYyAqc291cmNlLAorCQlzdHJ1Y3QgYW1kZ3B1X2l2
X2VudHJ5ICplbnRyeSkKK3sKKwlzdHJ1Y3QgcmFzX2NvbW1vbl9pZiAqcmFzX2lmID0gYWRldi0+
Z21jLnVtY19yYXNfaWY7CisJc3RydWN0IHJhc19kaXNwYXRjaF9pZiBpaF9kYXRhID0geworCQku
ZW50cnkgPSBlbnRyeSwKKwl9OworCisJaWYgKCFyYXNfaWYpCisJCXJldHVybiAwOworCisJaWhf
ZGF0YS5oZWFkID0gKnJhc19pZjsKKworCWFtZGdwdV9yYXNfaW50ZXJydXB0X2Rpc3BhdGNoKGFk
ZXYsICZpaF9kYXRhKTsKKwlyZXR1cm4gMDsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV91bWMuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV91bWMuaAppbmRleCAzZWMzNmQ5ZTAxMmEuLjg0YjhiNzkyYjEzYSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3VtYy5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV91bWMuaApAQCAtODEsNCArODEsMTAgQEAgc3RydWN0IGFt
ZGdwdV91bWMgewogfTsKIAogaW50IGFtZGdwdV91bWNfcmFzX2xhdGVfaW5pdChzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiwgdm9pZCAqcmFzX2loX2luZm8pOworaW50IGFtZGdwdV91bWNfcHJv
Y2Vzc19yYXNfZGF0YV9jYihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKKwkJdm9pZCAqcmFz
X2Vycm9yX3N0YXR1cywKKwkJc3RydWN0IGFtZGdwdV9pdl9lbnRyeSAqZW50cnkpOworaW50IGFt
ZGdwdV91bWNfcHJvY2Vzc19lY2NfaXJxKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAorCQlz
dHJ1Y3QgYW1kZ3B1X2lycV9zcmMgKnNvdXJjZSwKKwkJc3RydWN0IGFtZGdwdV9pdl9lbnRyeSAq
ZW50cnkpOwogI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9n
bWNfdjlfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAuYwppbmRleCAz
MDczZTg4NmJiY2UuLmU0ZTA5MTJkNmI3OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvZ21jX3Y5XzAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNf
djlfMC5jCkBAIC0yNDAsNzAgKzI0MCw2IEBAIHN0YXRpYyBpbnQgZ21jX3Y5XzBfZWNjX2ludGVy
cnVwdF9zdGF0ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBnbWNfdjlfMF9wcm9jZXNzX3Jhc19kYXRhX2NiKHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LAotCQl2b2lkICpyYXNfZXJyb3Jfc3RhdHVzLAotCQlzdHJ1Y3QgYW1kZ3B1X2l2
X2VudHJ5ICplbnRyeSkKLXsKLQlzdHJ1Y3QgcmFzX2Vycl9kYXRhICplcnJfZGF0YSA9IChzdHJ1
Y3QgcmFzX2Vycl9kYXRhICopcmFzX2Vycm9yX3N0YXR1czsKLQotCWlmIChhbWRncHVfcmFzX2lz
X3N1cHBvcnRlZChhZGV2LCBBTURHUFVfUkFTX0JMT0NLX19HRlgpKQotCQlyZXR1cm4gQU1ER1BV
X1JBU19TVUNDRVNTOwotCi0Ja2dkMmtmZF9zZXRfc3JhbV9lY2NfZmxhZyhhZGV2LT5rZmQuZGV2
KTsKLQlpZiAoYWRldi0+dW1jLmZ1bmNzICYmCi0JICAgIGFkZXYtPnVtYy5mdW5jcy0+cXVlcnlf
cmFzX2Vycm9yX2NvdW50KQotCSAgICBhZGV2LT51bWMuZnVuY3MtPnF1ZXJ5X3Jhc19lcnJvcl9j
b3VudChhZGV2LCByYXNfZXJyb3Jfc3RhdHVzKTsKLQotCWlmIChhZGV2LT51bWMuZnVuY3MgJiYK
LQkgICAgYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9yYXNfZXJyb3JfYWRkcmVzcyAmJgotCSAgICBh
ZGV2LT51bWMubWF4X3Jhc19lcnJfY250X3Blcl9xdWVyeSkgewotCQllcnJfZGF0YS0+ZXJyX2Fk
ZHIgPQotCQkJa2NhbGxvYyhhZGV2LT51bWMubWF4X3Jhc19lcnJfY250X3Blcl9xdWVyeSwKLQkJ
CQlzaXplb2Yoc3RydWN0IGVlcHJvbV90YWJsZV9yZWNvcmQpLCBHRlBfS0VSTkVMKTsKLQkJLyog
c3RpbGwgY2FsbCBxdWVyeV9yYXNfZXJyb3JfYWRkcmVzcyB0byBjbGVhciBlcnJvciBzdGF0dXMK
LQkJICogZXZlbiBOT01FTSBlcnJvciBpcyBlbmNvdW50ZXJlZAotCQkgKi8KLQkJaWYoIWVycl9k
YXRhLT5lcnJfYWRkcikKLQkJCURSTV9XQVJOKCJGYWlsZWQgdG8gYWxsb2MgbWVtb3J5IGZvciB1
bWMgZXJyb3IgYWRkcmVzcyByZWNvcmQhXG4iKTsKLQotCQkvKiB1bWMgcXVlcnlfcmFzX2Vycm9y
X2FkZHJlc3MgaXMgYWxzbyByZXNwb25zaWJsZSBmb3IgY2xlYXJpbmcKLQkJICogZXJyb3Igc3Rh
dHVzCi0JCSAqLwotCQlhZGV2LT51bWMuZnVuY3MtPnF1ZXJ5X3Jhc19lcnJvcl9hZGRyZXNzKGFk
ZXYsIGVycl9kYXRhKTsKLQl9Ci0KLQkvKiBvbmx5IHVuY29ycmVjdGFibGUgZXJyb3IgbmVlZHMg
Z3B1IHJlc2V0ICovCi0JaWYgKGVycl9kYXRhLT51ZV9jb3VudCkgewotCQlpZiAoZXJyX2RhdGEt
PmVycl9hZGRyX2NudCAmJgotCQkgICAgYW1kZ3B1X3Jhc19hZGRfYmFkX3BhZ2VzKGFkZXYsIGVy
cl9kYXRhLT5lcnJfYWRkciwKLQkJCQkJCWVycl9kYXRhLT5lcnJfYWRkcl9jbnQpKQotCQkJRFJN
X1dBUk4oIkZhaWxlZCB0byBhZGQgcmFzIGJhZCBwYWdlIVxuIik7Ci0KLQkJYW1kZ3B1X3Jhc19y
ZXNldF9ncHUoYWRldiwgMCk7Ci0JfQotCi0Ja2ZyZWUoZXJyX2RhdGEtPmVycl9hZGRyKTsKLQly
ZXR1cm4gQU1ER1BVX1JBU19TVUNDRVNTOwotfQotCi1zdGF0aWMgaW50IGdtY192OV8wX3Byb2Nl
c3NfZWNjX2lycShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKLQkJc3RydWN0IGFtZGdwdV9p
cnFfc3JjICpzb3VyY2UsCi0JCXN0cnVjdCBhbWRncHVfaXZfZW50cnkgKmVudHJ5KQotewotCXN0
cnVjdCByYXNfY29tbW9uX2lmICpyYXNfaWYgPSBhZGV2LT5nbWMudW1jX3Jhc19pZjsKLQlzdHJ1
Y3QgcmFzX2Rpc3BhdGNoX2lmIGloX2RhdGEgPSB7Ci0JCS5lbnRyeSA9IGVudHJ5LAotCX07Ci0K
LQlpZiAoIXJhc19pZikKLQkJcmV0dXJuIDA7Ci0KLQlpaF9kYXRhLmhlYWQgPSAqcmFzX2lmOwot
Ci0JYW1kZ3B1X3Jhc19pbnRlcnJ1cHRfZGlzcGF0Y2goYWRldiwgJmloX2RhdGEpOwotCXJldHVy
biAwOwotfQotCiBzdGF0aWMgaW50IGdtY192OV8wX3ZtX2ZhdWx0X2ludGVycnVwdF9zdGF0ZShz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCQkJc3RydWN0IGFtZGdwdV9pcnFfc3JjICpz
cmMsCiAJCQkJCXVuc2lnbmVkIHR5cGUsCkBAIC00NDQsNyArMzgwLDcgQEAgc3RhdGljIGNvbnN0
IHN0cnVjdCBhbWRncHVfaXJxX3NyY19mdW5jcyBnbWNfdjlfMF9pcnFfZnVuY3MgPSB7CiAKIHN0
YXRpYyBjb25zdCBzdHJ1Y3QgYW1kZ3B1X2lycV9zcmNfZnVuY3MgZ21jX3Y5XzBfZWNjX2Z1bmNz
ID0gewogCS5zZXQgPSBnbWNfdjlfMF9lY2NfaW50ZXJydXB0X3N0YXRlLAotCS5wcm9jZXNzID0g
Z21jX3Y5XzBfcHJvY2Vzc19lY2NfaXJxLAorCS5wcm9jZXNzID0gYW1kZ3B1X3VtY19wcm9jZXNz
X2VjY19pcnEsCiB9OwogCiBzdGF0aWMgdm9pZCBnbWNfdjlfMF9zZXRfaXJxX2Z1bmNzKHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2KQpAQCAtNzk3LDcgKzczMyw3IEBAIHN0YXRpYyBpbnQgZ21j
X3Y5XzBfZWNjX2xhdGVfaW5pdCh2b2lkICpoYW5kbGUpCiAJaW50IHI7CiAJc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7CiAJc3RydWN0
IHJhc19paF9pZiB1bWNfaWhfaW5mbyA9IHsKLQkJLmNiID0gZ21jX3Y5XzBfcHJvY2Vzc19yYXNf
ZGF0YV9jYiwKKwkJLmNiID0gYW1kZ3B1X3VtY19wcm9jZXNzX3Jhc19kYXRhX2NiLAogCX07CiAK
IAlpZiAoYWRldi0+dW1jLmZ1bmNzICYmIGFkZXYtPnVtYy5mdW5jcy0+cmFzX2xhdGVfaW5pdCkg
ewotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
