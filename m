Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A6E1A4EB0F
	for <lists+amd-gfx@lfdr.de>; Fri, 21 Jun 2019 16:49:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F27426E8B8;
	Fri, 21 Jun 2019 14:49:54 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wr1-x444.google.com (mail-wr1-x444.google.com
 [IPv6:2a00:1450:4864:20::444])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 563306E8B8
 for <amd-gfx@lists.freedesktop.org>; Fri, 21 Jun 2019 14:49:53 +0000 (UTC)
Received: by mail-wr1-x444.google.com with SMTP id r16so6841466wrl.11
 for <amd-gfx@lists.freedesktop.org>; Fri, 21 Jun 2019 07:49:53 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:reply-to:subject:to:references:from:message-id
 :date:user-agent:mime-version:in-reply-to:content-transfer-encoding
 :content-language;
 bh=eW/OPnsYH4DH/z+9+y2mJz0jZiUYWiWJHhyQ3T4hCsk=;
 b=flPlvzcKmTtG8zxZPrzAMzOGzFqmygXg9CA5cWzwYdh9Xn0VBlHZJjd5pXbK6bvZ0G
 W+tkoROEK0wb4Kxx/gHoRmTUutHjnJskqgj8/mxCaDKoZqs+zF9c/cQh/o/nhUFihTpY
 /cXcJqW4nntlknypxDwG9ySYRbhtcAJcs6ah51I+iqYr4VBW8QT/77TANulwf15Z2a9C
 AvRKXKgu2wvGlT6z9CnHwOGkdOynJOd5i/0pFtEabW1mDRnDE33fHgxU9Y5UR3Wnyogr
 MyNiBGVtX5QaBh72cfdqXW7f50ZfolMLfKsPQRppwNnqriIxgyDNGgL8OaTNL+JqaHKh
 oGvQ==
X-Gm-Message-State: APjAAAVMNn82ifouGA6NSN1Rv93noto0P6aQlRVODMixGMXapGauFtXH
 /kqSDXOgVWuTAuHNAoOh0oKlyjrU
X-Google-Smtp-Source: APXvYqxEk7TYyI8nsLnX6XpzkFq3LAnf8zgWffQ1Yuk58YioeXOtc7g3GeI4h3MVBdh9y9aQn7X1GQ==
X-Received: by 2002:adf:e50b:: with SMTP id j11mr34037550wrm.351.1561128591905; 
 Fri, 21 Jun 2019 07:49:51 -0700 (PDT)
Received: from ?IPv6:2a02:908:1252:fb60:be8a:bd56:1f94:86e7?
 ([2a02:908:1252:fb60:be8a:bd56:1f94:86e7])
 by smtp.gmail.com with ESMTPSA id y6sm3306765wrp.12.2019.06.21.07.49.51
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Fri, 21 Jun 2019 07:49:51 -0700 (PDT)
Subject: Re: [PATCH] Fix VM handling for VMID 0 w.r.t. SYSTEM_APERTURE
To: "StDenis, Tom" <Tom.StDenis@amd.com>,
 "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
References: <20190620174359.20529-1-tom.stdenis@amd.com>
From: =?UTF-8?Q?Christian_K=c3=b6nig?= <ckoenig.leichtzumerken@gmail.com>
Message-ID: <5e5d9597-0162-9ae6-5e04-13005378582f@gmail.com>
Date: Fri, 21 Jun 2019 16:49:50 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.0
MIME-Version: 1.0
In-Reply-To: <20190620174359.20529-1-tom.stdenis@amd.com>
Content-Language: en-US
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=reply-to:subject:to:references:from:message-id:date:user-agent
 :mime-version:in-reply-to:content-transfer-encoding:content-language;
 bh=eW/OPnsYH4DH/z+9+y2mJz0jZiUYWiWJHhyQ3T4hCsk=;
 b=Jq06WP5WKqQ5hDku0FLf/RKNNd10Fg8IPb2BhUbuY0mW/aDi7DtsXPJ4HfKSWECPAB
 16RVl2jfZKYiGlbOsYgqm5PWrKEVVDGhBS4NDNtulJ8uCdI9VngpYin5SqAZ7fySS5VN
 yyRCA/tKZzmygewIib2QX2UruaPAnJ0Hw/AN9/9JeAlDfM/1pAIPhL52f87+mtmwoEJA
 TOjHme/PoaezGFb26IHgcVc6Nn9HZuBT4TGckTB5PBXMDWHOa7/niT9esbMjSw3idH1h
 KZSCiC3/Ti+6tyRY4yk3zoD9O+f47yCDFyW/26JftM/Q66QZMiBpr/mFY18XB6Yjc6ir
 2tTQ==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Reply-To: christian.koenig@amd.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QW0gMjAuMDYuMTkgdW0gMTk6NDQgc2NocmllYiBTdERlbmlzLCBUb206Cj4gU2lnbmVkLW9mZi1i
eTogVG9tIFN0IERlbmlzIDx0b20uc3RkZW5pc0BhbWQuY29tPgoKQWNrZWQtYnk6IENocmlzdGlh
biBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KCj4gLS0tCj4gICBzcmMvbGliL3Jl
YWRfdnJhbS5jIHwgNDcgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKyst
LS0tCj4gICAxIGZpbGUgY2hhbmdlZCwgNDMgaW5zZXJ0aW9ucygrKSwgNCBkZWxldGlvbnMoLSkK
Pgo+IGRpZmYgLS1naXQgYS9zcmMvbGliL3JlYWRfdnJhbS5jIGIvc3JjL2xpYi9yZWFkX3ZyYW0u
Ywo+IGluZGV4IDEzMWNlYzMuLjgxMmRlOTYgMTAwNjQ0Cj4gLS0tIGEvc3JjL2xpYi9yZWFkX3Zy
YW0uYwo+ICsrKyBiL3NyYy9saWIvcmVhZF92cmFtLmMKPiBAQCAtMzAwLDcgKzMwMCw3IEBAIHN0
YXRpYyBpbnQgdW1yX2FjY2Vzc192cmFtX2FpKHN0cnVjdCB1bXJfYXNpYyAqYXNpYywgdWludDMy
X3Qgdm1pZCwKPiAgIAl1aW50NjRfdCBzdGFydF9hZGRyLCBwYWdlX3RhYmxlX3N0YXJ0X2FkZHIs
IHBhZ2VfdGFibGVfYmFzZV9hZGRyLAo+ICAgCQkgcGFnZV90YWJsZV9zaXplLCBwdGVfaWR4LCBw
ZGVfaWR4LCBwdGVfZW50cnksIHBkZV9lbnRyeSwKPiAgIAkJIHBkZV9hZGRyZXNzLCB2Z2FfYmFz
ZV9hZGRyZXNzLCB2bV9mYl9vZmZzZXQsIHZtX2ZiX2Jhc2UsCj4gLQkJIHZhX21hc2ssIG9mZnNl
dF9tYXNrOwo+ICsJCSB2YV9tYXNrLCBvZmZzZXRfbWFzaywgc3lzdGVtX2FwZXJ0dXJlX2xvdywg
c3lzdGVtX2FwZXJ0dXJlX2hpZ2g7Cj4gICAJdWludDMyX3QgY2h1bmtfc2l6ZSwgdG1wOwo+ICAg
CWludCBwZGVfY250LCBjdXJyZW50X2RlcHRoLCBwYWdlX3RhYmxlX2RlcHRoLCBmaXJzdDsKPiAg
IAlzdHJ1Y3Qgewo+IEBAIC0zMTIsNyArMzEyLDEwIEBAIHN0YXRpYyBpbnQgdW1yX2FjY2Vzc192
cmFtX2FpKHN0cnVjdCB1bXJfYXNpYyAqYXNpYywgdWludDMyX3Qgdm1pZCwKPiAgIAkJCW1tVk1f
Q09OVEVYVHhfUEFHRV9UQUJMRV9CQVNFX0FERFJfSEkzMiwKPiAgIAkJCW1tVkdBX01FTU9SWV9C
QVNFX0FERFJFU1MsCj4gICAJCQltbVZHQV9NRU1PUllfQkFTRV9BRERSRVNTX0hJR0gsCj4gLQkJ
CW1tTUNfVk1fRkJfT0ZGU0VUOwo+ICsJCQltbU1DX1ZNX0ZCX09GRlNFVCwKPiArCQkJbW1NQ19W
TV9NWF9MMV9UTEJfQ05UTCwKPiArCQkJbW1NQ19WTV9TWVNURU1fQVBFUlRVUkVfTE9XX0FERFIs
Cj4gKwkJCW1tTUNfVk1fU1lTVEVNX0FQRVJUVVJFX0hJR0hfQUREUjsKPiAgIAl9IHJlZ2lzdGVy
czsKPiAgIAlzdHJ1Y3Qgewo+ICAgCQl1aW50NjRfdAo+IEBAIC0zODEsNiArMzg0LDExIEBAIHN0
YXRpYyBpbnQgdW1yX2FjY2Vzc192cmFtX2FpKHN0cnVjdCB1bXJfYXNpYyAqYXNpYywgdWludDMy
X3Qgdm1pZCwKPiAgIAl9Cj4gICAKPiAgIAkvLyByZWFkIHZtIHJlZ2lzdGVycwo+ICsJcmVnaXN0
ZXJzLm1tTUNfVk1fU1lTVEVNX0FQRVJUVVJFX0hJR0hfQUREUiA9IHVtcl9yZWFkX3JlZ19ieV9u
YW1lX2J5X2lwKGFzaWMsIGh1YiwgIm1tTUNfVk1fU1lTVEVNX0FQRVJUVVJFX0hJR0hfQUREUiIp
Owo+ICsJcmVnaXN0ZXJzLm1tTUNfVk1fU1lTVEVNX0FQRVJUVVJFX0xPV19BRERSID0gdW1yX3Jl
YWRfcmVnX2J5X25hbWVfYnlfaXAoYXNpYywgaHViLCAibW1NQ19WTV9TWVNURU1fQVBFUlRVUkVf
TE9XX0FERFIiKTsKPiArCXN5c3RlbV9hcGVydHVyZV9sb3cgPSAoKHVpbnQ2NF90KXJlZ2lzdGVy
cy5tbU1DX1ZNX1NZU1RFTV9BUEVSVFVSRV9MT1dfQUREUikgPDwgMTg7Cj4gKwlzeXN0ZW1fYXBl
cnR1cmVfaGlnaCA9ICgodWludDY0X3QpcmVnaXN0ZXJzLm1tTUNfVk1fU1lTVEVNX0FQRVJUVVJF
X0hJR0hfQUREUikgPDwgMTg7Cj4gKwlyZWdpc3RlcnMubW1NQ19WTV9NWF9MMV9UTEJfQ05UTCA9
IHVtcl9yZWFkX3JlZ19ieV9uYW1lX2J5X2lwKGFzaWMsIGh1YiwgIm1tTUNfVk1fTVhfTDFfVExC
X0NOVEwiKTsKPiAgIAlzcHJpbnRmKGJ1ZiwgIm1tVk1fQ09OVEVYVCUiIFBSSXUzMiAiX1BBR0Vf
VEFCTEVfU1RBUlRfQUREUl9MTzMyIiwgdm1pZCk7Cj4gICAJCXJlZ2lzdGVycy5tbVZNX0NPTlRF
WFR4X1BBR0VfVEFCTEVfU1RBUlRfQUREUl9MTzMyID0gdW1yX3JlYWRfcmVnX2J5X25hbWVfYnlf
aXAoYXNpYywgaHViLCBidWYpOwo+ICAgCQlwYWdlX3RhYmxlX3N0YXJ0X2FkZHIgPSAodWludDY0
X3QpcmVnaXN0ZXJzLm1tVk1fQ09OVEVYVHhfUEFHRV9UQUJMRV9TVEFSVF9BRERSX0xPMzIgPDwg
MTI7Cj4gQEAgLTQyNSw3ICs0MzMsMTAgQEAgc3RhdGljIGludCB1bXJfYWNjZXNzX3ZyYW1fYWko
c3RydWN0IHVtcl9hc2ljICphc2ljLCB1aW50MzJfdCB2bWlkLAo+ICAgCQkJCSJtbVZHQV9NRU1P
UllfQkFTRV9BRERSRVNTPTB4JSIgUFJJeDMyICJcbiIKPiAgIAkJCQkibW1WR0FfTUVNT1JZX0JB
U0VfQUREUkVTU19ISUdIPTB4JSIgUFJJeDMyICJcbiIKPiAgIAkJCQkibW1NQ19WTV9GQl9PRkZT
RVQ9MHglIiBQUkl4MzIgIlxuIgo+IC0JCQkJIm1tTUNfVk1fRkJfTE9DQVRJT05fQkFTRT0weCUi
IFBSSXg2NCAiXG4iLAo+ICsJCQkJIm1tTUNfVk1fRkJfTE9DQVRJT05fQkFTRT0weCUiIFBSSXg2
NCAiXG4iCj4gKwkJCQkibW1NQ19WTV9NWF9MMV9UTEJfQ05UTD0weCUiIFBSSXgzMiAiXG4iCj4g
KwkJCQkibW1NQ19WTV9TWVNURU1fQVBFUlRVUkVfTE9XX0FERFI9MHglIiBQUkl4MzIgIlxuIgo+
ICsJCQkJIm1tTUNfVk1fU1lTVEVNX0FQRVJUVVJFX0hJR0hfQUREUj0weCUiIFBSSXgzMiAiXG4i
LAo+ICAgCQkJdm1pZCwgcmVnaXN0ZXJzLm1tVk1fQ09OVEVYVHhfUEFHRV9UQUJMRV9TVEFSVF9B
RERSX0xPMzIsCj4gICAJCQl2bWlkLCByZWdpc3RlcnMubW1WTV9DT05URVhUeF9QQUdFX1RBQkxF
X1NUQVJUX0FERFJfSEkzMiwKPiAgIAkJCXZtaWQsIHJlZ2lzdGVycy5tbVZNX0NPTlRFWFR4X1BB
R0VfVEFCTEVfQkFTRV9BRERSX0xPMzIsCj4gQEAgLTQzNCwxMCArNDQ1LDM4IEBAIHN0YXRpYyBp
bnQgdW1yX2FjY2Vzc192cmFtX2FpKHN0cnVjdCB1bXJfYXNpYyAqYXNpYywgdWludDMyX3Qgdm1p
ZCwKPiAgIAkJCXJlZ2lzdGVycy5tbVZHQV9NRU1PUllfQkFTRV9BRERSRVNTLAo+ICAgCQkJcmVn
aXN0ZXJzLm1tVkdBX01FTU9SWV9CQVNFX0FERFJFU1NfSElHSCwKPiAgIAkJCXJlZ2lzdGVycy5t
bU1DX1ZNX0ZCX09GRlNFVCwKPiAtCQkJdm1fZmJfYmFzZSk7Cj4gKwkJCXZtX2ZiX2Jhc2UsCj4g
KwkJCXJlZ2lzdGVycy5tbU1DX1ZNX01YX0wxX1RMQl9DTlRMLAo+ICsJCQlyZWdpc3RlcnMubW1N
Q19WTV9TWVNURU1fQVBFUlRVUkVfTE9XX0FERFIsCj4gKwkJCXJlZ2lzdGVycy5tbU1DX1ZNX1NZ
U1RFTV9BUEVSVFVSRV9ISUdIX0FERFIKPiArCQkJKTsKPiAgIAo+ICAgCS8vIHRyYW5zZm9ybSBw
YWdlX3RhYmxlX2Jhc2UKPiAgIAlwYWdlX3RhYmxlX2Jhc2VfYWRkciAtPSB2bV9mYl9vZmZzZXQ7
Cj4gKwo+ICsJaWYgKHZtaWQgPT0gMCkgewo+ICsJCXVpbnQzMl90IHNhbSA9IHVtcl9iaXRzbGlj
ZV9yZWdfYnlfbmFtZV9ieV9pcChhc2ljLCBodWIsICJtbU1DX1ZNX01YX0wxX1RMQl9DTlRMIiwg
IlNZU1RFTV9BQ0NFU1NfTU9ERSIsIHJlZ2lzdGVycy5tbU1DX1ZNX01YX0wxX1RMQl9DTlRMKTsK
PiArCQkvLyBhZGRyZXNzZXMgaW4gVk1JRDAgbmVlZCBzcGVjaWFsIGhhbmRsaW5nIHcuci50LiBQ
QUdFX1RBQkxFX1NUQVJUX0FERFIKPiArCQlzd2l0Y2ggKHNhbSkgewo+ICsJCQljYXNlIDA6IC8v
IHBoeXNpY2FsIGFjY2Vzcwo+ICsJCQkJcmV0dXJuIHVtcl9hY2Nlc3NfdnJhbShhc2ljLCBVTVJf
TElORUFSX0hVQiwgYWRkcmVzcywgc2l6ZSwgZHN0LCB3cml0ZV9lbik7Cj4gKwkJCWNhc2UgMTog
Ly8gYWx3YXlzIFZNIGFjY2Vzcwo+ICsJCQkJYnJlYWs7Cj4gKwkJCWNhc2UgMjogLy8gaW5zaWRl
IHN5c3RlbSBhcGVydHVyZSBpcyBtYXBwZWQsIG90aGVyd2lzZSB1bm1hcHBlZAo+ICsJCQkJaWYg
KCEoYWRkcmVzcyA+PSBzeXN0ZW1fYXBlcnR1cmVfbG93ICYmIGFkZHJlc3MgPCBzeXN0ZW1fYXBl
cnR1cmVfaGlnaCkpCj4gKwkJCQkJcmV0dXJuIHVtcl9hY2Nlc3NfdnJhbShhc2ljLCBVTVJfTElO
RUFSX0hVQiwgYWRkcmVzcywgc2l6ZSwgZHN0LCB3cml0ZV9lbik7Cj4gKwkJCQlicmVhazsKPiAr
CQkJY2FzZSAzOiAvLyBpbnNpZGUgc3lzdGVtIGFwZXJ0dXJlIGlzIHVubWFwcGVkLCBvdGhlcndp
c2UgbWFwcGVkCj4gKwkJCQlpZiAoYWRkcmVzcyA+PSBzeXN0ZW1fYXBlcnR1cmVfbG93ICYmIGFk
ZHJlc3MgPCBzeXN0ZW1fYXBlcnR1cmVfaGlnaCkKPiArCQkJCQlyZXR1cm4gdW1yX2FjY2Vzc192
cmFtKGFzaWMsIFVNUl9MSU5FQVJfSFVCLCBhZGRyZXNzLCBzaXplLCBkc3QsIHdyaXRlX2VuKTsK
PiArCQkJCWJyZWFrOwo+ICsJCQlkZWZhdWx0Ogo+ICsJCQkJYXNpYy0+bWVtX2Z1bmNzLnZtX21l
c3NhZ2UoIltXQVJOSU5HXTogVW5oYW5kbGVkIFNZU1RFTV9BQ0NFU1NfTU9ERSBtb2RlIFslIiBQ
Ukl1MzIgIl1cbiIsIHNhbSk7Cj4gKwkJCQlicmVhazsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJLy8g
ZmFsbHRocm91Z2gsIGFuZC9vciBWTUlEcyBmb3IgPj0gMSBhcmUgYWx3YXlzIG1hcHBlZAo+ICAg
CWFkZHJlc3MgLT0gcGFnZV90YWJsZV9zdGFydF9hZGRyOwo+ICAgCj4gICAJZG8gewoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5n
IGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
