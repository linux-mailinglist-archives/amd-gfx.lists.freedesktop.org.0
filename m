Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5D62898514
	for <lists+amd-gfx@lfdr.de>; Wed, 21 Aug 2019 22:02:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D931B6E9C5;
	Wed, 21 Aug 2019 20:02:53 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM02-BL2-obe.outbound.protection.outlook.com
 (mail-eopbgr750040.outbound.protection.outlook.com [40.107.75.40])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AFA1A6E9C5
 for <amd-gfx@lists.freedesktop.org>; Wed, 21 Aug 2019 20:02:52 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=BepJq9m/Oix0nsQzPk7BbHQ00kUFNTMoSEVktV+T+TtISFDFZN7pV7vVNPmzHctYj3sFVisvBUfcUpeyBhXl+VWYeoo6PP6jQYRkqyueRk0ED92Z9mEfnHZlv06w9tPYwDm/SFziPUNApIz7gGw5Kr9hxtFwobLITDu0YgrWjJMOfDkBWZivCNFY1c+7GoLQAmjAMUVrNp8pywA8/Kz5dwYB6o1Q5nT8FKIVToRnVs6vbtyCu2fqis9rIkYy9nrc6wTwkTSAaAFIbXKx61h9wojPUo0tvd/aivHrrfF4Y+GzR5v/FpqPm1FUbo+dFBFa8xNRDRSFyi7PtPApNU1FCw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=JlrOD44XU8OcQidYO3hqCO+n2FUQGrvaj6fvk09VyJM=;
 b=GHm83qMQS5pBTs5cJc3kjrBWlot9bdYboPxjNnBCJdnRQy+K2w6sbD7TGEbelu3z4wqAbHwZUcJ9PTTJ7XhbquQjK/ZrMYVTOpr8sJpfb/+0EI0AE5ZSSrncqmIVn8RGGCBS6vcMI7SEkHwdDeQ6GCXzPhlHfL8HBStnQDYNEWpe7yp/kQPZxcs8rPuXhCtWIQ6XSW+H2RFS/4E8F6VEHbHb7Q5E49diSfZN2LNj14EL5eJ5AaswdyXy/m1m5cAui+Cck1aiPX02uPFSWEtdx4vYAUOY3ltTi2dYNjV4Tv5jeaaFaZyaqWlMaDh8LL0/3boXTZqbDFWYFW+AIus7sQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=none (sender ip is
 165.204.84.17) smtp.rcpttodomain=lists.freedesktop.org smtp.mailfrom=amd.com; 
 dmarc=permerror action=none header.from=amd.com; dkim=none (message not
 signed); arc=none
Received: from BN6PR12CA0030.namprd12.prod.outlook.com (2603:10b6:405:70::16)
 by BN6PR12MB1266.namprd12.prod.outlook.com (2603:10b6:404:14::8) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2178.16; Wed, 21 Aug
 2019 20:02:49 +0000
Received: from DM3NAM03FT056.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e49::203) by BN6PR12CA0030.outlook.office365.com
 (2603:10b6:405:70::16) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.2178.16 via Frontend
 Transport; Wed, 21 Aug 2019 20:02:49 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV01.amd.com (165.204.84.17) by
 DM3NAM03FT056.mail.protection.outlook.com (10.152.83.158) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.2178.16 via Frontend Transport; Wed, 21 Aug 2019 20:02:49 +0000
Received: from agrodzovsky-All-Series.amd.com (10.34.1.3) by
 SATLEXCHOV01.amd.com (10.181.40.71) with Microsoft SMTP Server id 14.3.389.1; 
 Wed, 21 Aug 2019 15:02:47 -0500
From: Andrey Grodzovsky <andrey.grodzovsky@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH v4 4/4] drm/amdgpu: Vega20 SMU I2C HW engine controller.
Date: Wed, 21 Aug 2019 16:01:59 -0400
Message-ID: <1566417719-1528-5-git-send-email-andrey.grodzovsky@amd.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1566417719-1528-1-git-send-email-andrey.grodzovsky@amd.com>
References: <1566417719-1528-1-git-send-email-andrey.grodzovsky@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(346002)(376002)(39860400002)(396003)(136003)(2980300002)(428003)(199004)(189003)(76176011)(51416003)(81166006)(7696005)(16586007)(50466002)(4326008)(26005)(14444005)(186003)(36756003)(70586007)(70206006)(8936002)(336012)(426003)(6916009)(478600001)(86362001)(48376002)(47776003)(356004)(6666004)(316002)(8676002)(81156014)(53416004)(30864003)(50226002)(2906002)(2351001)(305945005)(54906003)(486006)(126002)(44832011)(476003)(2616005)(446003)(53936002)(5660300002)(11346002);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BN6PR12MB1266; H:SATLEXCHOV01.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; A:1; MX:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: c7606db1-5b67-47d1-e761-08d726728af3
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328);
 SRVR:BN6PR12MB1266; 
X-MS-TrafficTypeDiagnostic: BN6PR12MB1266:
X-Microsoft-Antispam-PRVS: <BN6PR12MB126695362F60C691CE6515D1EAAA0@BN6PR12MB1266.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:10000;
X-Forefront-PRVS: 0136C1DDA4
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: 6whf9wjZNk18qzRE/N4fEh1nxVOFw4jMQnKr8hHYB+/k+fOEkMY/Dm/M3ytsl2qQ8Vpd0fVi1lTFCzWTUbcNce1aFwnfXqXssW/q+kNtNYf2nir/pe8VuOFFn/21hY9jiNPr4py1SUjJALcequdAyOvxrXiGIJHY6YAlDQhun2xch5h95Xy0jlQWbykvqF4bEwTOzusruppKWkmh5Unfm064vok1x1bHv9Ml4hC0KYrmX4hPNS7wKozQQ+QHmHZe5/ovuPqG35prpBGZBeJf+IxWOwerqRD1pgE3No5snP747d1bQIPRlE0ihEtFrR/pN0lluRopnkP2uEtPd58YnRjWjmx1D2WmcEoZRT56oyViBS+O4VvL/McuQWGsxN98M99xRUFGzvnAsqkbatgBrHJCueZ6S14fSQTWSCIhx2U=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 21 Aug 2019 20:02:49.3180 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: c7606db1-5b67-47d1-e761-08d726728af3
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV01.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN6PR12MB1266
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=JlrOD44XU8OcQidYO3hqCO+n2FUQGrvaj6fvk09VyJM=;
 b=dRuBFqw1zaJA9baLM6SbslVD1NhR3AI7T8WYcYZAR9lRT3RPIq5OglNtd2vUdD8mXlf79x+t+S7bvFttOGePRjrIfkNJuZecXLORi1oUZ1aXh23u+NLYYbK102qiQiID6bqOPEm7XKdU8c1nINZm+jCDqaTR4SVmrjmAAQReDBs=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: David.Panariti@amd.com, Lijo.Lazar@amd.com,
 Andrey Grodzovsky <andrey.grodzovsky@amd.com>, Xinhui.Pan@amd.com,
 Luben.Tuikov@amd.com, Kent.Russell@amd.com, Tao.Zhou1@amd.com,
 Alexander.Deucher@amd.com, evan.quan@amd.com, Hawking.Zhang@amd.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

SW1wbGVtZW50IEhXIEkyQyBlbmlnbmUgY29udHJvbGxlciB0byBiZSB1c2VkIGJ5IHRoZSBSQVMg
RUVQUk9NCnRhYmxlIG1hbmFnZXIuIFRoaXMgaXMgYmFzZWQgb24gY29kZSBmcm9tIEFUSVRPT0xz
LgoKdjI6ClJlbmFtZSB0aGUgZmlsZSBhbmQgYWxsIGZ1bmN0aW9uIHByZWZpeGVzIHRvIHNtdV92
MTFfMF9pMmMKCkJ5IEx1YmVuJ3Mgb2JzZXJ2YXRpb24gYWx3YXlzIGZpbGwgdGhlIFRYIGZpZm8g
dG8gZnVsbCBzbwp3ZSBkb24ndCBoYXZlIGdhcmJhZGdlIGludGVycHJldGVkIGJ5IHRoZSBzbGF2
ZSBhcyB2YWxpZCBkYXRhLgoKdjM6ClJlbW92ZSBwcmVlbXB0aW9uIGRpc2FibGUgYXMgdGhlIEhX
IEkyQyBjb250cm9sbGVyIHdpbGwgbm90CnN0b3AgdGhlIGNsb2NrIG9uIGVtcHR5IFRYIGZpZm8g
YW5kIHNvIGl0J3Mgbm90IGNyaXRpY2FsIHRvCmtlZXAgbm90IGVtcHR5IHF1ZXVlLgpTd2l0Y2gg
dG8gZmFzdCBtb2RlIDQwMCBraHogU0NMIGNsb2NrIGZvciBmYXN0ZXIgcmVhZCBhbmQgd3JpdGUu
CgpTaWduZWQtb2ZmLWJ5OiBBbmRyZXkgR3JvZHpvdnNreSA8YW5kcmV5Lmdyb2R6b3Zza3lAYW1k
LmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9NYWtlZmlsZSAgICAgICAgICAg
IHwgICA1ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmFzX2VlcHJvbS5j
IHwgICA1ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zbXVfdjExXzBfaTJjLmMgICAg
IHwgNzEwICsrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L3NtdV92MTFfMF9pMmMuaCAgICAgfCAgMzQgKysKIDQgZmlsZXMgY2hhbmdlZCwgNzUxIGlu
c2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvc211X3YxMV8wX2kyYy5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc211X3YxMV8wX2kyYy5oCgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9NYWtlZmlsZQppbmRleCBmMDE2Y2YxLi4xNDczM2ZmIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9NYWtlZmlsZQpAQCAtMzgsNiArMzgsOSBAQCBjY2ZsYWdzLXkgOj0gLUkkKEZVTExfQU1E
X1BBVEgpL2luY2x1ZGUvYXNpY19yZWcgXAogCS1JJChGVUxMX0FNRF9ESVNQTEFZX1BBVEgpL2Ft
ZGdwdV9kbSBcCiAJLUkkKEZVTExfQU1EX1BBVEgpL2FtZGtmZAogCisKKworCiBhbWRncHUteSA6
PSBhbWRncHVfZHJ2Lm8KIAogIyBhZGQgS01TIGRyaXZlcgpAQCAtNTQsNyArNTcsNyBAQCBhbWRn
cHUteSArPSBhbWRncHVfZGV2aWNlLm8gYW1kZ3B1X2ttcy5vIFwKIAlhbWRncHVfZ3R0X21nci5v
IGFtZGdwdV92cmFtX21nci5vIGFtZGdwdV92aXJ0Lm8gYW1kZ3B1X2F0b21maXJtd2FyZS5vIFwK
IAlhbWRncHVfdmZfZXJyb3IubyBhbWRncHVfc2NoZWQubyBhbWRncHVfZGVidWdmcy5vIGFtZGdw
dV9pZHMubyBcCiAJYW1kZ3B1X2dtYy5vIGFtZGdwdV94Z21pLm8gYW1kZ3B1X2NzYS5vIGFtZGdw
dV9yYXMubyBhbWRncHVfdm1fY3B1Lm8gXAotCWFtZGdwdV92bV9zZG1hLm8gYW1kZ3B1X3BtdS5v
IGFtZGdwdV9kaXNjb3ZlcnkubyBhbWRncHVfcmFzX2VlcHJvbS5vCisJYW1kZ3B1X3ZtX3NkbWEu
byBhbWRncHVfcG11Lm8gYW1kZ3B1X2Rpc2NvdmVyeS5vIGFtZGdwdV9yYXNfZWVwcm9tLm8gc211
X3YxMV8wX2kyYy5vCiAKIGFtZGdwdS0kKENPTkZJR19QRVJGX0VWRU5UUykgKz0gYW1kZ3B1X3Bt
dS5vCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXNf
ZWVwcm9tLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmFzX2VlcHJvbS5j
CmluZGV4IGJmMDc1MTUuLmU2YjJlMTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9yYXNfZWVwcm9tLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3Jhc19lZXByb20uYwpAQCAtMjUsNiArMjUsNyBAQAogI2luY2x1ZGUgImFtZGdw
dS5oIgogI2luY2x1ZGUgImFtZGdwdV9yYXMuaCIKICNpbmNsdWRlIDxsaW51eC9iaXRzLmg+Cisj
aW5jbHVkZSAic211X3YxMV8wX2kyYy5oIgogCiAjZGVmaW5lIEVFUFJPTV9JMkNfVEFSR0VUX0FE
RFIgMHhBMAogCkBAIC0xMTEsNyArMTEyLDcgQEAgaW50IGFtZGdwdV9yYXNfZWVwcm9tX2luaXQo
c3RydWN0IGFtZGdwdV9yYXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2wpCiAKIAlzd2l0Y2ggKGFk
ZXYtPmFzaWNfdHlwZSkgewogCWNhc2UgQ0hJUF9WRUdBMjA6Ci0JLypUT0RPIEFkZCBNSS02MCAq
LworCQlyZXQgPSBzbXVfdjExXzBfaTJjX2VlcHJvbV9jb250cm9sX2luaXQoJmNvbnRyb2wtPmVl
cHJvbV9hY2Nlc3Nvcik7CiAJCWJyZWFrOwogCiAJZGVmYXVsdDoKQEAgLTE2Myw3ICsxNjQsNyBA
QCB2b2lkIGFtZGdwdV9yYXNfZWVwcm9tX2Zpbmkoc3RydWN0IGFtZGdwdV9yYXNfZWVwcm9tX2Nv
bnRyb2wgKmNvbnRyb2wpCiAKIAlzd2l0Y2ggKGFkZXYtPmFzaWNfdHlwZSkgewogCWNhc2UgQ0hJ
UF9WRUdBMjA6Ci0JCS8qVE9ETyBBZGQgTUktNjAgKi8KKwkJc211X3YxMV8wX2kyY19lZXByb21f
Y29udHJvbF9maW5pKCZjb250cm9sLT5lZXByb21fYWNjZXNzb3IpOwogCQlicmVhazsKIAogCWRl
ZmF1bHQ6CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zbXVfdjExXzBf
aTJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zbXVfdjExXzBfaTJjLmMKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uMjQ0MDVmYQotLS0gL2Rldi9udWxsCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3NtdV92MTFfMF9pMmMuYwpAQCAtMCwwICsxLDcx
MCBAQAorLyoKKyAqIENvcHlyaWdodCAyMDE5IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4K
KyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8g
YW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3Nv
Y2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwg
aW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxp
bWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJs
aXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRo
ZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2Fy
ZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRp
b25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Np
b24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50
aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJP
VklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgor
ICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBP
RiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBB
TkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQg
SE9MREVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBP
UgorICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwg
VE9SVCBPUiBPVEhFUldJU0UsCisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNU
SU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElO
IFRIRSBTT0ZUV0FSRS4KKyAqCisgKi8KKworI2luY2x1ZGUgInNtdWlvL3NtdWlvXzExXzBfMF9v
ZmZzZXQuaCIKKyNpbmNsdWRlICJzbXVpby9zbXVpb18xMV8wXzBfc2hfbWFzay5oIgorCisjaW5j
bHVkZSAic211X3YxMV8wX2kyYy5oIgorI2luY2x1ZGUgImFtZGdwdS5oIgorI2luY2x1ZGUgInNv
YzE1X2NvbW1vbi5oIgorI2luY2x1ZGUgPGRybS9kcm1fZml4ZWQuaD4KKyNpbmNsdWRlICJhbWRn
cHVfYW1ka2ZkLmgiCisjaW5jbHVkZSA8bGludXgvaTJjLmg+CisjaW5jbHVkZSAiYW1kZ3B1X3Jh
cy5oIgorCisvKiBlcnJvciBjb2RlcyAqLworI2RlZmluZSBJMkNfT0sJCQkJMAorI2RlZmluZSBJ
MkNfTkFLXzdCX0FERFJfTk9BQ0sJCTEKKyNkZWZpbmUgSTJDX05BS19UWERBVEFfTk9BQ0sJCTIK
KyNkZWZpbmUgSTJDX1RJTUVPVVQJCQk0CisjZGVmaW5lIEkyQ19TV19USU1FT1VUCQkJOAorI2Rl
ZmluZSBJMkNfQUJPUlQJCQkweDEwCisKKy8qIEkyQyB0cmFuc2FjdGlvbiBmbGFncyAqLworI2Rl
ZmluZSBJMkNfTk9fU1RPUAkxCisjZGVmaW5lIEkyQ19SRVNUQVJUCTIKKworI2RlZmluZSB0b19h
bWRncHVfZGV2aWNlKHgpIChjb250YWluZXJfb2YoeCwgc3RydWN0IGFtZGdwdV9yYXMsIGVlcHJv
bV9jb250cm9sLmVlcHJvbV9hY2Nlc3NvcikpLT5hZGV2CisjZGVmaW5lIHRvX2VlcHJvbV9jb250
cm9sKHgpIGNvbnRhaW5lcl9vZih4LCBzdHJ1Y3QgYW1kZ3B1X3Jhc19lZXByb21fY29udHJvbCwg
ZWVwcm9tX2FjY2Vzc29yKQorCitzdGF0aWMgdm9pZCBzbXVfdjExXzBfaTJjX2Rpc19jbG9ja19n
YXRpbmcoc3RydWN0IGkyY19hZGFwdGVyICpjb250cm9sKQoreworCXN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2ID0gdG9fYW1kZ3B1X2RldmljZShjb250cm9sKTsKKwl1aW50MzJfdCByZWc7CisK
KwlyZWcgPSBSUkVHMzJfU09DMTUoU01VSU8sIDAsIG1tU01VSU9fUFdSTUdUKTsKKwlyZWcgPSBS
RUdfU0VUX0ZJRUxEKHJlZywgU01VSU9fUFdSTUdULCBpMmNfY2xrX2dhdGVfZW4sIDApOworCVdS
RUczMl9TT0MxNShTTVVJTywgMCwgbW1TTVVJT19QV1JNR1QsIHJlZyk7Cit9CisKKworc3RhdGlj
IHZvaWQgc211X3YxMV8wX2kyY19lbmFibGUoc3RydWN0IGkyY19hZGFwdGVyICpjb250cm9sLCBi
b29sIGVuYWJsZSkKK3sKKwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IHRvX2FtZGdwdV9k
ZXZpY2UoY29udHJvbCk7CisKKwlXUkVHMzJfU09DMTUoU01VSU8sIDAsIG1tQ0tTVklJMkNfSUNf
RU5BQkxFLCBlbmFibGUgPyAxIDogMCk7Cit9CisKK3N0YXRpYyB2b2lkIHNtdV92MTFfMF9pMmNf
Y2xlYXJfc3RhdHVzKHN0cnVjdCBpMmNfYWRhcHRlciAqY29udHJvbCkKK3sKKwlzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiA9IHRvX2FtZGdwdV9kZXZpY2UoY29udHJvbCk7CisJLyogZG8gKi8K
Kwl7CisJCVJSRUczMl9TT0MxNShTTVVJTywgMCwgbW1DS1NWSUkyQ19JQ19DTFJfSU5UUik7CisK
Kwl9IC8qIHdoaWxlIChyZWdfQ0tTVklJMkNfaWNfY2xyX2ludHIgPT0gMCkgKi8KK30KKworc3Rh
dGljIHZvaWQgc211X3YxMV8wX2kyY19jb25maWd1cmUoc3RydWN0IGkyY19hZGFwdGVyICpjb250
cm9sKQoreworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gdG9fYW1kZ3B1X2RldmljZShj
b250cm9sKTsKKwl1aW50MzJfdCByZWcgPSAwOworCisJcmVnID0gUkVHX1NFVF9GSUVMRChyZWcs
IENLU1ZJSTJDX0lDX0NPTiwgSUNfU0xBVkVfRElTQUJMRSwgMSk7CisJcmVnID0gUkVHX1NFVF9G
SUVMRChyZWcsIENLU1ZJSTJDX0lDX0NPTiwgSUNfUkVTVEFSVF9FTiwgMSk7CisJcmVnID0gUkVH
X1NFVF9GSUVMRChyZWcsIENLU1ZJSTJDX0lDX0NPTiwgSUNfMTBCSVRBRERSX01BU1RFUiwgMCk7
CisJcmVnID0gUkVHX1NFVF9GSUVMRChyZWcsIENLU1ZJSTJDX0lDX0NPTiwgSUNfMTBCSVRBRERS
X1NMQVZFLCAwKTsKKwkvKiBTdGFuZGFyZCBtb2RlICovCisJcmVnID0gUkVHX1NFVF9GSUVMRChy
ZWcsIENLU1ZJSTJDX0lDX0NPTiwgSUNfTUFYX1NQRUVEX01PREUsIDIpOworCXJlZyA9IFJFR19T
RVRfRklFTEQocmVnLCBDS1NWSUkyQ19JQ19DT04sIElDX01BU1RFUl9NT0RFLCAxKTsKKworCVdS
RUczMl9TT0MxNShTTVVJTywgMCwgbW1DS1NWSUkyQ19JQ19DT04sIHJlZyk7Cit9CisKK3N0YXRp
YyB2b2lkIHNtdV92MTFfMF9pMmNfc2V0X2Nsb2NrKHN0cnVjdCBpMmNfYWRhcHRlciAqY29udHJv
bCkKK3sKKwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IHRvX2FtZGdwdV9kZXZpY2UoY29u
dHJvbCk7CisKKwkvKgorCSAqIFN0YW5kYXJkIG1vZGUgc3BlZWQsIFRoZXNlIHZhbHVlcyBhcmUg
dGFrZW4gZnJvbSBTTVVJTyBNQVMsCisJICogYnV0IGFyZSBkaWZmZXJlbnQgZnJvbSB3aGF0IGlz
IGdpdmVuIGlzCisJICogU3lub3BzeXMgc3BlYy4gVGhlIHZhbHVlcyBoZXJlIGFyZSBiYXNlZCBv
biBhc3N1bXB0aW9uCisJICogdGhhdCByZWZjbG9jayBpcyAxMDBNSHoKKwkgKgorCSAqIENvbmZp
Z3VyYXRpb24gZm9yIHN0YW5kYXJkIG1vZGU7IFNwZWVkID0gMTAwa2JwcworCSAqIFNjYWxlIGxp
bmVhcmx5LCBmb3Igbm93IG9ubHkgc3VwcG9ydCBzdGFuZGFyZCBzcGVlZCBjbG9jaworCSAqIFRo
aXMgd2lsbCB3b3JrIG9ubHkgd2l0aCAxMDBNIHJlZiBjbG9jaworCSAqCisJICogVEJEOkNoYW5n
ZSB0aGUgY2FsY3VsYXRpb24gdG8gdGFrZSBpbnRvIGFjY291bnQgcmVmIGNsb2NrIHZhbHVlcyBh
bHNvLgorCSAqLworCisJV1JFRzMyX1NPQzE1KFNNVUlPLCAwLCBtbUNLU1ZJSTJDX0lDX0ZTX1NQ
S0xFTiwgMik7CisJV1JFRzMyX1NPQzE1KFNNVUlPLCAwLCBtbUNLU1ZJSTJDX0lDX1NTX1NDTF9I
Q05ULCAxMjApOworCVdSRUczMl9TT0MxNShTTVVJTywgMCwgbW1DS1NWSUkyQ19JQ19TU19TQ0xf
TENOVCwgMTMwKTsKKwlXUkVHMzJfU09DMTUoU01VSU8sIDAsIG1tQ0tTVklJMkNfSUNfU0RBX0hP
TEQsIDIwKTsKK30KKworc3RhdGljIHZvaWQgc211X3YxMV8wX2kyY19zZXRfYWRkcmVzcyhzdHJ1
Y3QgaTJjX2FkYXB0ZXIgKmNvbnRyb2wsIHVpbnQ4X3QgYWRkcmVzcykKK3sKKwlzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiA9IHRvX2FtZGdwdV9kZXZpY2UoY29udHJvbCk7CisKKwkvKiBDb252
ZXJ0IGZyb21yIDgtYml0IHRvIDctYml0IGFkZHJlc3MgKi8KKwlhZGRyZXNzID4+PSAxOworCVdS
RUczMl9TT0MxNShTTVVJTywgMCwgbW1DS1NWSUkyQ19JQ19UQVIsIChhZGRyZXNzICYgMHhGRikp
OworfQorCitzdGF0aWMgdWludDMyX3Qgc211X3YxMV8wX2kyY19wb2xsX3R4X3N0YXR1cyhzdHJ1
Y3QgaTJjX2FkYXB0ZXIgKmNvbnRyb2wpCit7CisJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYg
PSB0b19hbWRncHVfZGV2aWNlKGNvbnRyb2wpOworCXVpbnQzMl90IHJldCA9IEkyQ19PSzsKKwl1
aW50MzJfdCByZWcsIHJlZ19jX3R4X2FicnRfc291cmNlOworCisJLypDaGVjayBpZiB0cmFuc21p
c3Npb24gaXMgY29tcGxldGVkICovCisJdW5zaWduZWQgbG9uZyAgdGltZW91dF9jb3VudGVyID0g
amlmZmllcyArIG1zZWNzX3RvX2ppZmZpZXMoMjApOworCisJZG8geworCQlyZWcgPSBSUkVHMzJf
U09DMTUoU01VSU8sIDAsIG1tQ0tTVklJMkNfSUNfU1RBVFVTKTsKKworCQlpZiAodGltZV9hZnRl
cihqaWZmaWVzLCB0aW1lb3V0X2NvdW50ZXIpKSB7CisJCQlyZXQgfD0gSTJDX1NXX1RJTUVPVVQ7
CisJCQlicmVhazsKKwkJfQorCX0gd2hpbGUgKFJFR19HRVRfRklFTEQocmVnLCBDS1NWSUkyQ19J
Q19TVEFUVVMsIFRGRSkgPT0gMCk7CisKKwlpZiAocmV0ICE9IEkyQ19PSykKKwkJcmV0dXJuIHJl
dDsKKworCS8qIFRoaXMgb25seSBjaGVja3MgaWYgTkFLIGlzIHJlY2VpdmVkIGFuZCB0cmFuc2Fj
dGlvbiBnb3QgYWJvcnRlZCAqLworCXJlZyA9IFJSRUczMl9TT0MxNShTTVVJTywgMCwgbW1DS1NW
SUkyQ19JQ19JTlRSX1NUQVQpOworCisJaWYgKFJFR19HRVRfRklFTEQocmVnLCBDS1NWSUkyQ19J
Q19JTlRSX1NUQVQsIFJfVFhfQUJSVCkgPT0gMSkgeworCQlyZWdfY190eF9hYnJ0X3NvdXJjZSA9
IFJSRUczMl9TT0MxNShTTVVJTywgMCwgbW1DS1NWSUkyQ19JQ19UWF9BQlJUX1NPVVJDRSk7CisJ
CURSTV9JTkZPKCJUWCB3YXMgdGVybWluYXRlZCwgSUNfVFhfQUJSVF9TT1VSQ0UgdmFsIGlzOiV4
IiwgcmVnX2NfdHhfYWJydF9zb3VyY2UpOworCisJCS8qIENoZWNrIGZvciBzdG9wIGR1ZSB0byBO
QUNLICovCisJCWlmIChSRUdfR0VUX0ZJRUxEKHJlZ19jX3R4X2FicnRfc291cmNlLAorCQkJCSAg
Q0tTVklJMkNfSUNfVFhfQUJSVF9TT1VSQ0UsCisJCQkJICBBQlJUX1RYREFUQV9OT0FDSykgPT0g
MSkgeworCisJCQlyZXQgfD0gSTJDX05BS19UWERBVEFfTk9BQ0s7CisKKwkJfSBlbHNlIGlmIChS
RUdfR0VUX0ZJRUxEKHJlZ19jX3R4X2FicnRfc291cmNlLAorCQkJCQkgQ0tTVklJMkNfSUNfVFhf
QUJSVF9TT1VSQ0UsCisJCQkJCSBBQlJUXzdCX0FERFJfTk9BQ0spID09IDEpIHsKKworCQkJcmV0
IHw9IEkyQ19OQUtfN0JfQUREUl9OT0FDSzsKKwkJfSBlbHNlIHsKKwkJCXJldCB8PSBJMkNfQUJP
UlQ7CisJCX0KKworCQlzbXVfdjExXzBfaTJjX2NsZWFyX3N0YXR1cyhjb250cm9sKTsKKwl9CisK
KwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgdWludDMyX3Qgc211X3YxMV8wX2kyY19wb2xsX3J4
X3N0YXR1cyhzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmNvbnRyb2wpCit7CisJc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYgPSB0b19hbWRncHVfZGV2aWNlKGNvbnRyb2wpOworCXVpbnQzMl90IHJldCA9
IEkyQ19PSzsKKwl1aW50MzJfdCByZWdfaWNfc3RhdHVzLCByZWdfY190eF9hYnJ0X3NvdXJjZTsK
KworCXJlZ19jX3R4X2FicnRfc291cmNlID0gUlJFRzMyX1NPQzE1KFNNVUlPLCAwLCBtbUNLU1ZJ
STJDX0lDX1RYX0FCUlRfU09VUkNFKTsKKworCS8qIElmIHNsYXZlIGlzIG5vdCBwcmVzZW50ICov
CisJaWYgKFJFR19HRVRfRklFTEQocmVnX2NfdHhfYWJydF9zb3VyY2UsCisJCQkgIENLU1ZJSTJD
X0lDX1RYX0FCUlRfU09VUkNFLAorCQkJICBBQlJUXzdCX0FERFJfTk9BQ0spID09IDEpIHsKKwkJ
cmV0IHw9IEkyQ19OQUtfN0JfQUREUl9OT0FDSzsKKworCQlzbXVfdjExXzBfaTJjX2NsZWFyX3N0
YXR1cyhjb250cm9sKTsKKwl9IGVsc2UgeyAgLyogd2FpdCB0aWxsIHNvbWUgZGF0YSBpcyB0aGVy
ZSBpbiBSWEZJRk8gKi8KKwkJLyogUG9sbCBmb3Igc29tZSBieXRlIGluIFJYRklGTyAqLworCQl1
bnNpZ25lZCBsb25nICB0aW1lb3V0X2NvdW50ZXIgPSBqaWZmaWVzICsgbXNlY3NfdG9famlmZmll
cygyMCk7CisKKwkJZG8geworCQkJcmVnX2ljX3N0YXR1cyA9IFJSRUczMl9TT0MxNShTTVVJTywg
MCwgbW1DS1NWSUkyQ19JQ19TVEFUVVMpOworCisJCQlpZiAodGltZV9hZnRlcihqaWZmaWVzLCB0
aW1lb3V0X2NvdW50ZXIpKSB7CisJCQkJcmV0IHw9IEkyQ19TV19USU1FT1VUOworCQkJCWJyZWFr
OworCQkJfQorCQl9IHdoaWxlIChSRUdfR0VUX0ZJRUxEKHJlZ19pY19zdGF0dXMsIENLU1ZJSTJD
X0lDX1NUQVRVUywgUkZORSkgPT0gMCk7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworCisKKwor
LyoqCisgKiBzbXVfdjExXzBfaTJjX3RyYW5zbWl0IC0gU2VuZCBhIGJsb2NrIG9mIGRhdGEgb3Zl
ciB0aGUgSTJDIGJ1cyB0byBhIHNsYXZlIGRldmljZS4KKyAqCisgKiBAYWRkcmVzczogVGhlIEky
QyBhZGRyZXNzIG9mIHRoZSBzbGF2ZSBkZXZpY2UuCisgKiBAZGF0YTogVGhlIGRhdGEgdG8gdHJh
bnNtaXQgb3ZlciB0aGUgYnVzLgorICogQG51bWJ5dGVzOiBUaGUgYW1vdW50IG9mIGRhdGEgdG8g
dHJhbnNtaXQuCisgKiBAaTJjX2ZsYWc6IEZsYWdzIGZvciB0cmFuc21pc3Npb24KKyAqCisgKiBS
ZXR1cm5zIDAgb24gc3VjY2VzcyBvciBlcnJvci4KKyAqLworc3RhdGljIHVpbnQzMl90IHNtdV92
MTFfMF9pMmNfdHJhbnNtaXQoc3RydWN0IGkyY19hZGFwdGVyICpjb250cm9sLAorCQkJCSAgdWlu
dDhfdCBhZGRyZXNzLCB1aW50OF90ICpkYXRhLAorCQkJCSAgdWludDMyX3QgbnVtYnl0ZXMsIHVp
bnQzMl90IGkyY19mbGFnKQoreworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gdG9fYW1k
Z3B1X2RldmljZShjb250cm9sKTsKKwl1aW50MzJfdCBieXRlc19zZW50LCByZWcsIHJldCA9IDA7
CisJdW5zaWduZWQgbG9uZyAgdGltZW91dF9jb3VudGVyOworCisJYnl0ZXNfc2VudCA9IDA7CisK
KwlEUk1fREVCVUdfRFJJVkVSKCJJMkNfVHJhbnNtaXQoKSwgYWRkcmVzcyA9ICV4LCBieXRlcyA9
ICVkICwgZGF0YTogIiwKKwkJICh1aW50MTZfdClhZGRyZXNzLCBudW1ieXRlcyk7CisKKwlpZiAo
ZHJtX2RlYnVnICYgRFJNX1VUX0RSSVZFUikgeworCQlwcmludF9oZXhfZHVtcChLRVJOX0lORk8s
ICJkYXRhOiAiLCBEVU1QX1BSRUZJWF9OT05FLAorCQkJICAgICAgIDE2LCAxLCBkYXRhLCBudW1i
eXRlcywgZmFsc2UpOworCX0KKworCS8qIFNldCB0aGUgSTJDIHNsYXZlIGFkZHJlc3MgKi8KKwlz
bXVfdjExXzBfaTJjX3NldF9hZGRyZXNzKGNvbnRyb2wsIGFkZHJlc3MpOworCS8qIEVuYWJsZSBJ
MkMgKi8KKwlzbXVfdjExXzBfaTJjX2VuYWJsZShjb250cm9sLCB0cnVlKTsKKworCS8qIENsZWFy
IHN0YXR1cyBiaXRzICovCisJc211X3YxMV8wX2kyY19jbGVhcl9zdGF0dXMoY29udHJvbCk7CisK
KworCXRpbWVvdXRfY291bnRlciA9IGppZmZpZXMgKyBtc2Vjc190b19qaWZmaWVzKDIwKTsKKwor
CXdoaWxlIChudW1ieXRlcyA+IDApIHsKKwkJcmVnID0gUlJFRzMyX1NPQzE1KFNNVUlPLCAwLCBt
bUNLU1ZJSTJDX0lDX1NUQVRVUyk7CisJCWlmIChSRUdfR0VUX0ZJRUxEKHJlZywgQ0tTVklJMkNf
SUNfU1RBVFVTLCBURk5GKSkgeworCQkJZG8geworCQkJCXJlZyA9IDA7CisJCQkJLyoKKwkJCQkg
KiBQcmVwYXJlIHRyYW5zYWN0aW9uLCBubyBuZWVkIHRvIHNldCBSRVNUQVJULiBJMkMgZW5naW5l
IHdpbGwgc2VuZAorCQkJCSAqIFNUQVJUIGFzIHNvb24gYXMgaXQgc2VlcyBkYXRhIGluIFRYRklG
TworCQkJCSAqLworCQkJCWlmIChieXRlc19zZW50ID09IDApCisJCQkJCXJlZyA9IFJFR19TRVRf
RklFTEQocmVnLCBDS1NWSUkyQ19JQ19EQVRBX0NNRCwgUkVTVEFSVCwKKwkJCQkJCQkgICAgKGky
Y19mbGFnICYgSTJDX1JFU1RBUlQpID8gMSA6IDApOworCQkJCXJlZyA9IFJFR19TRVRfRklFTEQo
cmVnLCBDS1NWSUkyQ19JQ19EQVRBX0NNRCwgREFULCBkYXRhW2J5dGVzX3NlbnRdKTsKKworCQkJ
CS8qIGRldGVybWluZSBpZiB3ZSBuZWVkIHRvIHNlbmQgU1RPUCBiaXQgb3Igbm90ICovCisJCQkJ
aWYgKG51bWJ5dGVzID09IDEpCisJCQkJCS8qIEZpbmFsIHRyYW5zYWN0aW9uLCBzbyBzZW5kIHN0
b3AgdW5sZXNzIEkyQ19OT19TVE9QICovCisJCQkJCXJlZyA9IFJFR19TRVRfRklFTEQocmVnLCBD
S1NWSUkyQ19JQ19EQVRBX0NNRCwgU1RPUCwKKwkJCQkJCQkgICAgKGkyY19mbGFnICYgSTJDX05P
X1NUT1ApID8gMCA6IDEpOworCQkJCS8qIFdyaXRlICovCisJCQkJcmVnID0gUkVHX1NFVF9GSUVM
RChyZWcsIENLU1ZJSTJDX0lDX0RBVEFfQ01ELCBDTUQsIDApOworCQkJCVdSRUczMl9TT0MxNShT
TVVJTywgMCwgbW1DS1NWSUkyQ19JQ19EQVRBX0NNRCwgcmVnKTsKKworCQkJCS8qIFJlY29yZCB0
aGF0IHRoZSBieXRlcyB3ZXJlIHRyYW5zbWl0dGVkICovCisJCQkJYnl0ZXNfc2VudCsrOworCQkJ
CW51bWJ5dGVzLS07CisKKwkJCQlyZWcgPSBSUkVHMzJfU09DMTUoU01VSU8sIDAsIG1tQ0tTVklJ
MkNfSUNfU1RBVFVTKTsKKworCQkJfSB3aGlsZSAobnVtYnl0ZXMgJiYgIFJFR19HRVRfRklFTEQo
cmVnLCBDS1NWSUkyQ19JQ19TVEFUVVMsIFRGTkYpKTsKKwkJfQorCisKKwkJaWYgKHRpbWVfYWZ0
ZXIoamlmZmllcywgdGltZW91dF9jb3VudGVyKSkgeworCQkJcmV0IHw9IEkyQ19TV19USU1FT1VU
OworCQkJZ290byBlcnI7CisJCX0KKwl9CisKKwlyZXQgPSBzbXVfdjExXzBfaTJjX3BvbGxfdHhf
c3RhdHVzKGNvbnRyb2wpOworCitlcnI6CisJLyogQW55IGVycm9yLCBubyBwb2ludCBpbiBwcm9j
ZWVkaW5nICovCisJaWYgKHJldCAhPSBJMkNfT0spIHsKKwkJaWYgKHJldCAmIEkyQ19TV19USU1F
T1VUKQorCQkJRFJNX0VSUk9SKCJUSU1FT1VUIEVSUk9SICEhISIpOworCisJCWlmIChyZXQgJiBJ
MkNfTkFLXzdCX0FERFJfTk9BQ0spCisJCQlEUk1fRVJST1IoIlJlY2VpdmVkIEkyQ19OQUtfN0Jf
QUREUl9OT0FDSyAhISEiKTsKKworCisJCWlmIChyZXQgJiBJMkNfTkFLX1RYREFUQV9OT0FDSykK
KwkJCURSTV9FUlJPUigiUmVjZWl2ZWQgSTJDX05BS19UWERBVEFfTk9BQ0sgISEhIik7CisJfQor
CisJcmV0dXJuIHJldDsKK30KKworCisvKioKKyAqIHNtdV92MTFfMF9pMmNfcmVjZWl2ZSAtIFJl
Y2VpdmUgYSBibG9jayBvZiBkYXRhIG92ZXIgdGhlIEkyQyBidXMgZnJvbSBhIHNsYXZlIGRldmlj
ZS4KKyAqCisgKiBAYWRkcmVzczogVGhlIEkyQyBhZGRyZXNzIG9mIHRoZSBzbGF2ZSBkZXZpY2Uu
CisgKiBAbnVtYnl0ZXM6IFRoZSBhbW91bnQgb2YgZGF0YSB0byB0cmFuc21pdC4KKyAqIEBpMmNf
ZmxhZzogRmxhZ3MgZm9yIHRyYW5zbWlzc2lvbgorICoKKyAqIFJldHVybnMgMCBvbiBzdWNjZXNz
IG9yIGVycm9yLgorICovCitzdGF0aWMgdWludDMyX3Qgc211X3YxMV8wX2kyY19yZWNlaXZlKHN0
cnVjdCBpMmNfYWRhcHRlciAqY29udHJvbCwKKwkJCQkgdWludDhfdCBhZGRyZXNzLCB1aW50OF90
ICpkYXRhLAorCQkJCSB1aW50MzJfdCBudW1ieXRlcywgdWludDhfdCBpMmNfZmxhZykKK3sKKwlz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IHRvX2FtZGdwdV9kZXZpY2UoY29udHJvbCk7CisJ
dWludDMyX3QgYnl0ZXNfcmVjZWl2ZWQsIHJldCA9IEkyQ19PSzsKKworCWJ5dGVzX3JlY2VpdmVk
ID0gMDsKKworCS8qIFNldCB0aGUgSTJDIHNsYXZlIGFkZHJlc3MgKi8KKwlzbXVfdjExXzBfaTJj
X3NldF9hZGRyZXNzKGNvbnRyb2wsIGFkZHJlc3MpOworCisJLyogRW5hYmxlIEkyQyAqLworCXNt
dV92MTFfMF9pMmNfZW5hYmxlKGNvbnRyb2wsIHRydWUpOworCisJd2hpbGUgKG51bWJ5dGVzID4g
MCkgeworCQl1aW50MzJfdCByZWcgPSAwOworCisJCXNtdV92MTFfMF9pMmNfY2xlYXJfc3RhdHVz
KGNvbnRyb2wpOworCisKKwkJLyogUHJlcGFyZSB0cmFuc2FjdGlvbiAqLworCisJCS8qIEVhY2gg
dGltZSB3ZSBkaXNhYmxlIEkyQywgc28gdGhpcyBpcyBub3QgYSByZXN0YXJ0ICovCisJCWlmIChi
eXRlc19yZWNlaXZlZCA9PSAwKQorCQkJcmVnID0gUkVHX1NFVF9GSUVMRChyZWcsIENLU1ZJSTJD
X0lDX0RBVEFfQ01ELCBSRVNUQVJULAorCQkJCQkgICAgKGkyY19mbGFnICYgSTJDX1JFU1RBUlQp
ID8gMSA6IDApOworCisJCXJlZyA9IFJFR19TRVRfRklFTEQocmVnLCBDS1NWSUkyQ19JQ19EQVRB
X0NNRCwgREFULCAwKTsKKwkJLyogUmVhZCAqLworCQlyZWcgPSBSRUdfU0VUX0ZJRUxEKHJlZywg
Q0tTVklJMkNfSUNfREFUQV9DTUQsIENNRCwgMSk7CisKKwkJLyogVHJhbnNtaXR0aW5nIGxhc3Qg
Ynl0ZSAqLworCQlpZiAobnVtYnl0ZXMgPT0gMSkKKwkJCS8qIEZpbmFsIHRyYW5zYWN0aW9uLCBz
byBzZW5kIHN0b3AgaWYgcmVxdWVzdGVkICovCisJCQlyZWcgPSBSRUdfU0VUX0ZJRUxEKHJlZywg
Q0tTVklJMkNfSUNfREFUQV9DTUQsIFNUT1AsCisJCQkJCSAgICAoaTJjX2ZsYWcgJiBJMkNfTk9f
U1RPUCkgPyAwIDogMSk7CisKKwkJV1JFRzMyX1NPQzE1KFNNVUlPLCAwLCBtbUNLU1ZJSTJDX0lD
X0RBVEFfQ01ELCByZWcpOworCisJCXJldCA9IHNtdV92MTFfMF9pMmNfcG9sbF9yeF9zdGF0dXMo
Y29udHJvbCk7CisKKwkJLyogQW55IGVycm9yLCBubyBwb2ludCBpbiBwcm9jZWVkaW5nICovCisJ
CWlmIChyZXQgIT0gSTJDX09LKSB7CisJCQlpZiAocmV0ICYgSTJDX1NXX1RJTUVPVVQpCisJCQkJ
RFJNX0VSUk9SKCJUSU1FT1VUIEVSUk9SICEhISIpOworCisJCQlpZiAocmV0ICYgSTJDX05BS183
Ql9BRERSX05PQUNLKQorCQkJCURSTV9FUlJPUigiUmVjZWl2ZWQgSTJDX05BS183Ql9BRERSX05P
QUNLICEhISIpOworCisJCQlpZiAocmV0ICYgSTJDX05BS19UWERBVEFfTk9BQ0spCisJCQkJRFJN
X0VSUk9SKCJSZWNlaXZlZCBJMkNfTkFLX1RYREFUQV9OT0FDSyAhISEiKTsKKworCQkJYnJlYWs7
CisJCX0KKworCQlyZWcgPSBSUkVHMzJfU09DMTUoU01VSU8sIDAsIG1tQ0tTVklJMkNfSUNfREFU
QV9DTUQpOworCQlkYXRhW2J5dGVzX3JlY2VpdmVkXSA9IFJFR19HRVRfRklFTEQocmVnLCBDS1NW
SUkyQ19JQ19EQVRBX0NNRCwgREFUKTsKKworCQkvKiBSZWNvcmQgdGhhdCB0aGUgYnl0ZXMgd2Vy
ZSByZWNlaXZlZCAqLworCQlieXRlc19yZWNlaXZlZCsrOworCQludW1ieXRlcy0tOworCX0KKwor
CURSTV9ERUJVR19EUklWRVIoIkkyQ19SZWNlaXZlKCksIGFkZHJlc3MgPSAleCwgYnl0ZXMgPSAl
ZCwgZGF0YSA6IiwKKwkJICAodWludDE2X3QpYWRkcmVzcywgYnl0ZXNfcmVjZWl2ZWQpOworCisJ
aWYgKGRybV9kZWJ1ZyAmIERSTV9VVF9EUklWRVIpIHsKKwkJcHJpbnRfaGV4X2R1bXAoS0VSTl9J
TkZPLCAiZGF0YTogIiwgRFVNUF9QUkVGSVhfTk9ORSwKKwkJCSAgICAgICAxNiwgMSwgZGF0YSwg
Ynl0ZXNfcmVjZWl2ZWQsIGZhbHNlKTsKKwl9CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMg
dm9pZCBzbXVfdjExXzBfaTJjX2Fib3J0KHN0cnVjdCBpMmNfYWRhcHRlciAqY29udHJvbCkKK3sK
KwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IHRvX2FtZGdwdV9kZXZpY2UoY29udHJvbCk7
CisJdWludDMyX3QgcmVnID0gMDsKKworCS8qIEVuYWJsZSBJMkMgZW5naW5lOyAqLworCXJlZyA9
IFJFR19TRVRfRklFTEQocmVnLCBDS1NWSUkyQ19JQ19FTkFCTEUsIEVOQUJMRSwgMSk7CisJV1JF
RzMyX1NPQzE1KFNNVUlPLCAwLCBtbUNLU1ZJSTJDX0lDX0VOQUJMRSwgcmVnKTsKKworCS8qIEFi
b3J0IHByZXZpb3VzIHRyYW5zYWN0aW9uICovCisJcmVnID0gUkVHX1NFVF9GSUVMRChyZWcsIENL
U1ZJSTJDX0lDX0VOQUJMRSwgQUJPUlQsIDEpOworCVdSRUczMl9TT0MxNShTTVVJTywgMCwgbW1D
S1NWSUkyQ19JQ19FTkFCTEUsIHJlZyk7CisKKwlEUk1fREVCVUdfRFJJVkVSKCJJMkNfQWJvcnQo
KSBEb25lLiIpOworfQorCisKK3N0YXRpYyBib29sIHNtdV92MTFfMF9pMmNfYWN0aXZpdHlfZG9u
ZShzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmNvbnRyb2wpCit7CisJc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYgPSB0b19hbWRncHVfZGV2aWNlKGNvbnRyb2wpOworCisJY29uc3QgdWludDMyX3QgSURM
RV9USU1FT1VUID0gMTAyNDsKKwl1aW50MzJfdCB0aW1lb3V0Q291bnQgPSAwOworCXVpbnQzMl90
IHJlZ19pY19lbmFibGUsIHJlZ19pY19lbmFibGVfc3RhdHVzLCByZWdfaWNfY2xyX2FjdGl2aXR5
OworCisJcmVnX2ljX2VuYWJsZV9zdGF0dXMgPSBSUkVHMzJfU09DMTUoU01VSU8sIDAsIG1tQ0tT
VklJMkNfSUNfRU5BQkxFX1NUQVRVUyk7CisJcmVnX2ljX2VuYWJsZSA9IFJSRUczMl9TT0MxNShT
TVVJTywgMCwgbW1DS1NWSUkyQ19JQ19FTkFCTEUpOworCisKKwlpZiAoKFJFR19HRVRfRklFTEQo
cmVnX2ljX2VuYWJsZSwgQ0tTVklJMkNfSUNfRU5BQkxFLCBFTkFCTEUpID09IDApICYmCisJICAg
IChSRUdfR0VUX0ZJRUxEKHJlZ19pY19lbmFibGVfc3RhdHVzLCBDS1NWSUkyQ19JQ19FTkFCTEVf
U1RBVFVTLCBJQ19FTikgPT0gMSkpIHsKKwkJLyoKKwkJICogTm9ib2R5IGlzIHVzaW5nIEkyQyBl
bmdpbmUsIGJ1dCBlbmdpbmUgcmVtYWlucyBhY3RpdmUgYmVjYXVzZQorCQkgKiBzb21lb25lIG1p
c3NlZCB0byBzZW5kIFNUT1AKKwkJICovCisJCXNtdV92MTFfMF9pMmNfYWJvcnQoY29udHJvbCk7
CisJfSBlbHNlIGlmIChSRUdfR0VUX0ZJRUxEKHJlZ19pY19lbmFibGUsIENLU1ZJSTJDX0lDX0VO
QUJMRSwgRU5BQkxFKSA9PSAwKSB7CisJCS8qIE5vYm9keSBpcyB1c2luZyBJMkMgZW5naW5lICov
CisJCXJldHVybiB0cnVlOworCX0KKworCS8qIEtlZXAgcmVhZGluZyBhY3Rpdml0eSBiaXQgdW50
aWwgaXQncyBjbGVhcmVkICovCisJZG8geworCQlyZWdfaWNfY2xyX2FjdGl2aXR5ID0gUlJFRzMy
X1NPQzE1KFNNVUlPLCAwLCBtbUNLU1ZJSTJDX0lDX0NMUl9BQ1RJVklUWSk7CisKKwkJaWYgKFJF
R19HRVRfRklFTEQocmVnX2ljX2Nscl9hY3Rpdml0eSwKKwkJICAgIENLU1ZJSTJDX0lDX0NMUl9B
Q1RJVklUWSwgQ0xSX0FDVElWSVRZKSA9PSAwKQorCQkJcmV0dXJuIHRydWU7CisKKwkJKyt0aW1l
b3V0Q291bnQ7CisKKwl9IHdoaWxlICh0aW1lb3V0Q291bnQgPCBJRExFX1RJTUVPVVQpOworCisJ
cmV0dXJuIGZhbHNlOworfQorCitzdGF0aWMgdm9pZCBzbXVfdjExXzBfaTJjX2luaXQoc3RydWN0
IGkyY19hZGFwdGVyICpjb250cm9sKQoreworCS8qIERpc2FibGUgY2xvY2sgZ2F0aW5nICovCisJ
c211X3YxMV8wX2kyY19kaXNfY2xvY2tfZ2F0aW5nKGNvbnRyb2wpOworCisJaWYgKCFzbXVfdjEx
XzBfaTJjX2FjdGl2aXR5X2RvbmUoY29udHJvbCkpCisJCURSTV9XQVJOKCJJMkMgYnVzeSAhIik7
CisKKwkvKiBEaXNhYmxlIEkyQyAqLworCXNtdV92MTFfMF9pMmNfZW5hYmxlKGNvbnRyb2wsIGZh
bHNlKTsKKworCS8qIENvbmZpZ3VyZSBJMkMgdG8gb3BlcmF0ZSBhcyBtYXN0ZXIgYW5kIGluIHN0
YW5kYXJkIG1vZGUgKi8KKwlzbXVfdjExXzBfaTJjX2NvbmZpZ3VyZShjb250cm9sKTsKKworCS8q
IEluaXRpYWxpemUgdGhlIGNsb2NrIHRvIDUwIGtIeiBkZWZhdWx0ICovCisJc211X3YxMV8wX2ky
Y19zZXRfY2xvY2soY29udHJvbCk7CisKK30KKworc3RhdGljIHZvaWQgc211X3YxMV8wX2kyY19m
aW5pKHN0cnVjdCBpMmNfYWRhcHRlciAqY29udHJvbCkKK3sKKwlzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiA9IHRvX2FtZGdwdV9kZXZpY2UoY29udHJvbCk7CisJdWludDMyX3QgcmVnX2ljX2Vu
YWJsZV9zdGF0dXMsIHJlZ19pY19lbmFibGU7CisKKwlzbXVfdjExXzBfaTJjX2VuYWJsZShjb250
cm9sLCBmYWxzZSk7CisKKwkvKiBEb3VibGUgY2hlY2sgaWYgZGlzYWJsZWQsIGVsc2UgZm9yY2Ug
YWJvcnQgKi8KKwlyZWdfaWNfZW5hYmxlX3N0YXR1cyA9IFJSRUczMl9TT0MxNShTTVVJTywgMCwg
bW1DS1NWSUkyQ19JQ19FTkFCTEVfU1RBVFVTKTsKKwlyZWdfaWNfZW5hYmxlID0gUlJFRzMyX1NP
QzE1KFNNVUlPLCAwLCBtbUNLU1ZJSTJDX0lDX0VOQUJMRSk7CisKKwlpZiAoKFJFR19HRVRfRklF
TEQocmVnX2ljX2VuYWJsZSwgQ0tTVklJMkNfSUNfRU5BQkxFLCBFTkFCTEUpID09IDApICYmCisJ
ICAgIChSRUdfR0VUX0ZJRUxEKHJlZ19pY19lbmFibGVfc3RhdHVzLAorCQkJICAgQ0tTVklJMkNf
SUNfRU5BQkxFX1NUQVRVUywgSUNfRU4pID09IDEpKSB7CisJCS8qCisJCSAqIE5vYm9keSBpcyB1
c2luZyBJMkMgZW5naW5lLCBidXQgZW5naW5lIHJlbWFpbnMgYWN0aXZlIGJlY2F1c2UKKwkJICog
c29tZW9uZSBtaXNzZWQgdG8gc2VuZCBTVE9QCisJCSAqLworCQlzbXVfdjExXzBfaTJjX2Fib3J0
KGNvbnRyb2wpOworCX0KKworfQorCitzdGF0aWMgYm9vbCBzbXVfdjExXzBfaTJjX2J1c19sb2Nr
KHN0cnVjdCBpMmNfYWRhcHRlciAqY29udHJvbCkKK3sKKwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiA9IHRvX2FtZGdwdV9kZXZpY2UoY29udHJvbCk7CisKKwkvKiBTZW5kICBQUFNNQ19NU0df
UmVxdWVzdEkyQ0J1cyAqLworCWlmICghYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5zbXVfaTJj
X2J1c19hY2Nlc3MpCisJCWdvdG8gZmFpbDsKKworCisJaWYgKCFhZGV2LT5wb3dlcnBsYXkucHBf
ZnVuY3MtPnNtdV9pMmNfYnVzX2FjY2VzcyhhZGV2LT5wb3dlcnBsYXkucHBfaGFuZGxlLCB0cnVl
KSkKKwkJcmV0dXJuIHRydWU7CisKK2ZhaWw6CisJcmV0dXJuIGZhbHNlOworfQorCitzdGF0aWMg
Ym9vbCBzbXVfdjExXzBfaTJjX2J1c191bmxvY2soc3RydWN0IGkyY19hZGFwdGVyICpjb250cm9s
KQoreworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gdG9fYW1kZ3B1X2RldmljZShjb250
cm9sKTsKKworCS8qIFNlbmQgIFBQU01DX01TR19SZXF1ZXN0STJDQnVzICovCisJaWYgKCFhZGV2
LT5wb3dlcnBsYXkucHBfZnVuY3MtPnNtdV9pMmNfYnVzX2FjY2VzcykKKwkJZ290byBmYWlsOwor
CisJLyogU2VuZCAgUFBTTUNfTVNHX1JlbGVhc2VJMkNCdXMgKi8KKwlpZiAoIWFkZXYtPnBvd2Vy
cGxheS5wcF9mdW5jcy0+c211X2kyY19idXNfYWNjZXNzKGFkZXYtPnBvd2VycGxheS5wcF9oYW5k
bGUsCisJCQkJCQkJICAgICBmYWxzZSkpCisJCXJldHVybiB0cnVlOworCitmYWlsOgorCXJldHVy
biBmYWxzZTsKK30KKworLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqIEVFUFJPTSBJMkMg
R0xVRSAqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworCitzdGF0aWMgdWludDMyX3Qgc211
X3YxMV8wX2kyY19lZXByb21fcmVhZF9kYXRhKHN0cnVjdCBpMmNfYWRhcHRlciAqY29udHJvbCwK
KwkJCQkJICAgICAgIHVpbnQ4X3QgYWRkcmVzcywKKwkJCQkJICAgICAgIHVpbnQ4X3QgKmRhdGEs
CisJCQkJCSAgICAgICB1aW50MzJfdCBudW1ieXRlcykKK3sKKwl1aW50MzJfdCAgcmV0ID0gMDsK
KworCS8qIEZpcnN0IDIgYnl0ZXMgYXJlIGR1bW15IHdyaXRlIHRvIHNldCBFRVBST00gYWRkcmVz
cyAqLworCXJldCA9IHNtdV92MTFfMF9pMmNfdHJhbnNtaXQoY29udHJvbCwgYWRkcmVzcywgZGF0
YSwgMiwgSTJDX05PX1NUT1ApOworCWlmIChyZXQgIT0gSTJDX09LKQorCQlnb3RvIGZhaWw7CisK
KwkvKiBOb3cgcmVhZCBkYXRhIHN0YXJ0aW5nIHdpdGggdGhhdCBhZGRyZXNzICovCisJcmV0ID0g
c211X3YxMV8wX2kyY19yZWNlaXZlKGNvbnRyb2wsIGFkZHJlc3MsIGRhdGEgKyAyLCBudW1ieXRl
cyAtIDIsCisJCQkJICAgIEkyQ19SRVNUQVJUKTsKKworZmFpbDoKKwlpZiAocmV0ICE9IEkyQ19P
SykKKwkJRFJNX0VSUk9SKCJSZWFkRGF0YSgpIC0gSTJDIGVycm9yIG9jY3VycmVkIDoleCIsIHJl
dCk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgdWludDMyX3Qgc211X3YxMV8wX2kyY19l
ZXByb21fd3JpdGVfZGF0YShzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmNvbnRyb2wsCisJCQkJCQl1aW50
OF90IGFkZHJlc3MsCisJCQkJCQl1aW50OF90ICpkYXRhLAorCQkJCQkJdWludDMyX3QgbnVtYnl0
ZXMpCit7CisJdWludDMyX3QgIHJldDsKKworCXJldCA9IHNtdV92MTFfMF9pMmNfdHJhbnNtaXQo
Y29udHJvbCwgYWRkcmVzcywgZGF0YSwgbnVtYnl0ZXMsIDApOworCisJaWYgKHJldCAhPSBJMkNf
T0spCisJCURSTV9FUlJPUigiV3JpdGVJMkNEYXRhKCkgLSBJMkMgZXJyb3Igb2NjdXJyZWQgOiV4
IiwgcmV0KTsKKwllbHNlCisJCS8qCisJCSAqIEFjY29yZGluZyB0byBFRVBST00gc3BlYyB0aGVy
ZSBpcyBhIE1BWCBvZiAxMCBtcyByZXF1aXJlZCBmb3IKKwkJICogRUVQUk9NIHRvIGZsdXNoIGlu
dGVybmFsIFJYIGJ1ZmZlciBhZnRlciBTVE9QIHdhcyBpc3N1ZWQgYXQgdGhlCisJCSAqIGVuZCBv
ZiB3cml0ZSB0cmFuc2FjdGlvbi4gRHVyaW5nIHRoaXMgdGltZSB0aGUgRUVQUk9NIHdpbGwgbm90
IGJlCisJCSAqIHJlc3BvbnNpdmUgdG8gYW55IG1vcmUgY29tbWFuZHMgLSBzbyB3YWl0IGEgYml0
IG1vcmUuCisJCSAqCisJCSAqIFRPRE8gSW1wcm92ZSB0byB3YWl0IGZvciBmaXJzdCBBQ0sgZm9y
IHNsYXZlIGFkZHJlc3MgYWZ0ZXIKKwkJICogaW50ZXJuYWwgd3JpdGUgY3ljbGUgZG9uZS4KKwkJ
ICovCisJCW1zbGVlcCgxMCk7CisKKwlyZXR1cm4gcmV0OworCit9CisKK3N0YXRpYyB2b2lkIGxv
Y2tfYnVzKHN0cnVjdCBpMmNfYWRhcHRlciAqaTJjLCB1bnNpZ25lZCBpbnQgZmxhZ3MpCit7CisJ
c3RydWN0IGFtZGdwdV9yYXNfZWVwcm9tX2NvbnRyb2wgKmNvbnRyb2wgPSB0b19lZXByb21fY29u
dHJvbChpMmMpOworCisJaWYgKCFzbXVfdjExXzBfaTJjX2J1c19sb2NrKGkyYykpIHsKKwkJRFJN
X0VSUk9SKCJGYWlsZWQgdG8gbG9jayB0aGUgYnVzIGZyb20gU01VIik7CisJCXJldHVybjsKKwl9
CisKKwljb250cm9sLT5idXNfbG9ja2VkID0gdHJ1ZTsKK30KKworc3RhdGljIGludCB0cnlsb2Nr
X2J1cyhzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmkyYywgdW5zaWduZWQgaW50IGZsYWdzKQoreworCVdB
Uk5fT05DRSgxLCAiVGhpcyBvcGVyYXRpb24gbm90IHN1cHBvc2VkIHRvIHJ1biBpbiBhdG9taWMg
Y29udGV4dCEiKTsKKwlyZXR1cm4gZmFsc2U7Cit9CisKK3N0YXRpYyB2b2lkIHVubG9ja19idXMo
c3RydWN0IGkyY19hZGFwdGVyICppMmMsIHVuc2lnbmVkIGludCBmbGFncykKK3sKKwlzdHJ1Y3Qg
YW1kZ3B1X3Jhc19lZXByb21fY29udHJvbCAqY29udHJvbCA9IHRvX2VlcHJvbV9jb250cm9sKGky
Yyk7CisKKwlpZiAoIXNtdV92MTFfMF9pMmNfYnVzX3VubG9jayhpMmMpKSB7CisJCURSTV9FUlJP
UigiRmFpbGVkIHRvIHVubG9jayB0aGUgYnVzIGZyb20gU01VIik7CisJCXJldHVybjsKKwl9CisK
Kwljb250cm9sLT5idXNfbG9ja2VkID0gZmFsc2U7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qg
aTJjX2xvY2tfb3BlcmF0aW9ucyBzbXVfdjExXzBfaTJjX2kyY19sb2NrX29wcyA9IHsKKwkubG9j
a19idXMgPSBsb2NrX2J1cywKKwkudHJ5bG9ja19idXMgPSB0cnlsb2NrX2J1cywKKwkudW5sb2Nr
X2J1cyA9IHVubG9ja19idXMsCit9OworCitzdGF0aWMgaW50IHNtdV92MTFfMF9pMmNfZWVwcm9t
X2kyY194ZmVyKHN0cnVjdCBpMmNfYWRhcHRlciAqaTJjX2FkYXAsCisJCQkgICAgICBzdHJ1Y3Qg
aTJjX21zZyAqbXNncywgaW50IG51bSkKK3sKKwlpbnQgaSwgcmV0OworCXN0cnVjdCBhbWRncHVf
cmFzX2VlcHJvbV9jb250cm9sICpjb250cm9sID0gdG9fZWVwcm9tX2NvbnRyb2woaTJjX2FkYXAp
OworCisJaWYgKCFjb250cm9sLT5idXNfbG9ja2VkKSB7CisJCURSTV9FUlJPUigiSTJDIGJ1cyB1
bmxvY2tlZCwgc3RvcHBpbmcgdHJhbnNhY3Rpb24hIik7CisJCXJldHVybiAtRUlPOworCX0KKwor
CXNtdV92MTFfMF9pMmNfaW5pdChpMmNfYWRhcCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgbnVtOyBp
KyspIHsKKwkJaWYgKG1zZ3NbaV0uZmxhZ3MgJiBJMkNfTV9SRCkKKwkJCXJldCA9IHNtdV92MTFf
MF9pMmNfZWVwcm9tX3JlYWRfZGF0YShpMmNfYWRhcCwKKwkJCQkJCQkodWludDhfdCltc2dzW2ld
LmFkZHIsCisJCQkJCQkJbXNnc1tpXS5idWYsIG1zZ3NbaV0ubGVuKTsKKwkJZWxzZQorCQkJcmV0
ID0gc211X3YxMV8wX2kyY19lZXByb21fd3JpdGVfZGF0YShpMmNfYWRhcCwKKwkJCQkJCQkgKHVp
bnQ4X3QpbXNnc1tpXS5hZGRyLAorCQkJCQkJCSBtc2dzW2ldLmJ1ZiwgbXNnc1tpXS5sZW4pOwor
CisJCWlmIChyZXQgIT0gSTJDX09LKSB7CisJCQludW0gPSAtRUlPOworCQkJYnJlYWs7CisJCX0K
Kwl9CisKKwlzbXVfdjExXzBfaTJjX2ZpbmkoaTJjX2FkYXApOworCXJldHVybiBudW07Cit9CisK
K3N0YXRpYyB1MzIgc211X3YxMV8wX2kyY19lZXByb21faTJjX2Z1bmMoc3RydWN0IGkyY19hZGFw
dGVyICphZGFwKQoreworCXJldHVybiBJMkNfRlVOQ19JMkMgfCBJMkNfRlVOQ19TTUJVU19FTVVM
OworfQorCisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaTJjX2FsZ29yaXRobSBzbXVfdjExXzBfaTJj
X2VlcHJvbV9pMmNfYWxnbyA9IHsKKwkubWFzdGVyX3hmZXIgPSBzbXVfdjExXzBfaTJjX2VlcHJv
bV9pMmNfeGZlciwKKwkuZnVuY3Rpb25hbGl0eSA9IHNtdV92MTFfMF9pMmNfZWVwcm9tX2kyY19m
dW5jLAorfTsKKworaW50IHNtdV92MTFfMF9pMmNfZWVwcm9tX2NvbnRyb2xfaW5pdChzdHJ1Y3Qg
aTJjX2FkYXB0ZXIgKmNvbnRyb2wpCit7CisJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSB0
b19hbWRncHVfZGV2aWNlKGNvbnRyb2wpOworCWludCByZXM7CisKKwljb250cm9sLT5vd25lciA9
IFRISVNfTU9EVUxFOworCWNvbnRyb2wtPmNsYXNzID0gSTJDX0NMQVNTX1NQRDsKKwljb250cm9s
LT5kZXYucGFyZW50ID0gJmFkZXYtPnBkZXYtPmRldjsKKwljb250cm9sLT5hbGdvID0gJnNtdV92
MTFfMF9pMmNfZWVwcm9tX2kyY19hbGdvOworCXNucHJpbnRmKGNvbnRyb2wtPm5hbWUsIHNpemVv
Zihjb250cm9sLT5uYW1lKSwgIlJBUyBFRVBST00iKTsKKwljb250cm9sLT5sb2NrX29wcyA9ICZz
bXVfdjExXzBfaTJjX2kyY19sb2NrX29wczsKKworCXJlcyA9IGkyY19hZGRfYWRhcHRlcihjb250
cm9sKTsKKwlpZiAocmVzKQorCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZWdpc3RlciBodyBpMmMs
IGVycjogJWRcbiIsIHJlcyk7CisKKwlyZXR1cm4gcmVzOworfQorCit2b2lkIHNtdV92MTFfMF9p
MmNfZWVwcm9tX2NvbnRyb2xfZmluaShzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmNvbnRyb2wpCit7CisJ
aTJjX2RlbF9hZGFwdGVyKGNvbnRyb2wpOworfQorCisjZGVmaW5lIEkyQ19UQVJHRVRfQUREUiAw
eEEwCisKK2Jvb2wgc211X3YxMV8wX2kyY190ZXN0X2J1cyhzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmNv
bnRyb2wpCit7CisKKwl1aW50MzJfdCByZXQgPSBJMkNfT0s7CisJdWludDhfdCBkYXRhWzZdID0g
ezB4ZiwgMCwgMHhkZSwgMHhhZCwgMHhiZSwgMHhlZn07CisKKworCURSTV9JTkZPKCJCZWdpbiIp
OworCisJaWYgKCFzbXVfdjExXzBfaTJjX2J1c19sb2NrKGNvbnRyb2wpKSB7CisJCURSTV9FUlJP
UigiRmFpbGVkIHRvIGxvY2sgdGhlIGJ1cyEuIik7CisJCXJldHVybiBmYWxzZTsKKwl9CisKKwlz
bXVfdjExXzBfaTJjX2luaXQoY29udHJvbCk7CisKKwkvKiBXcml0ZSAweGRlIHRvIGFkZHJlc3Mg
MHgwMDAwIG9uIHRoZSBFRVBST00gKi8KKwlyZXQgPSBzbXVfdjExXzBfaTJjX2VlcHJvbV93cml0
ZV9kYXRhKGNvbnRyb2wsIEkyQ19UQVJHRVRfQUREUiwgZGF0YSwgNik7CisKKwlyZXQgPSBzbXVf
djExXzBfaTJjX2VlcHJvbV9yZWFkX2RhdGEoY29udHJvbCwgSTJDX1RBUkdFVF9BRERSLCBkYXRh
LCA2KTsKKworCXNtdV92MTFfMF9pMmNfZmluaShjb250cm9sKTsKKworCXNtdV92MTFfMF9pMmNf
YnVzX3VubG9jayhjb250cm9sKTsKKworCisJRFJNX0lORk8oIkVuZCIpOworCXJldHVybiB0cnVl
OworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc211X3YxMV8wX2ky
Yy5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc211X3YxMV8wX2kyYy5oCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjk3M2YyOGQKLS0tIC9kZXYvbnVsbAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zbXVfdjExXzBfaTJjLmgKQEAgLTAsMCArMSwzNCBA
QAorLyoKKyAqIENvcHlyaWdodCAyMDE5IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KKyAq
CisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55
IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lh
dGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4g
dGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0
YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNo
LCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBT
b2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBp
cyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25z
OgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24g
bm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFs
IHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklE
RUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICog
SU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBN
RVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQg
Tk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQgSE9M
REVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgor
ICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9S
VCBPUiBPVEhFUldJU0UsCisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9O
IFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElOIFRI
RSBTT0ZUV0FSRS4KKyAqCisgKi8KKworI2lmbmRlZiBTTVVfVjExX0kyQ19DT05UUk9MX0gKKyNk
ZWZpbmUgU01VX1YxMV9JMkNfQ09OVFJPTF9ICisKKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgor
CitzdHJ1Y3QgaTJjX2FkYXB0ZXI7CisKK2ludCBzbXVfdjExXzBfaTJjX2VlcHJvbV9jb250cm9s
X2luaXQoc3RydWN0IGkyY19hZGFwdGVyICpjb250cm9sKTsKK3ZvaWQgc211X3YxMV8wX2kyY19l
ZXByb21fY29udHJvbF9maW5pKHN0cnVjdCBpMmNfYWRhcHRlciAqY29udHJvbCk7CisKKyNlbmRp
ZgotLSAKMi43LjQKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
