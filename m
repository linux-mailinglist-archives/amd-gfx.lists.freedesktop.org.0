Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 047D321BCA1
	for <lists+amd-gfx@lfdr.de>; Fri, 10 Jul 2020 19:54:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9C2646EC19;
	Fri, 10 Jul 2020 17:54:32 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM11-DM6-obe.outbound.protection.outlook.com
 (mail-dm6nam11on2044.outbound.protection.outlook.com [40.107.223.44])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A292C6EC19
 for <amd-gfx@lists.freedesktop.org>; Fri, 10 Jul 2020 17:54:30 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Ad3FUn6lkJi8kUV+k9Ugjo1/UzwIfgI8AK7zEV83/F1ANoRG6MeMDGZIqJvTbrH6zzCyHJv2sM4rbEgpoqDE+hZj11snMKISKUewRKd2tHTfNUxoa+WlrpQyS+/orwix4aO9fJVytYgqUjO1rYngtUwWE/ajqCJ+2H12ztweRD/VwkGV5VB8tPdHYT1ei9u4HZ3kiE0qwrtZBrEYaoeJ47qMEaqWU3JnOjoqdZ4Nu1lbIKN0bYLOesFpd8iAdRC4r42OZJAzalX7FC/ZcyAhywm6V5/ObvOFnfNWDze3iPqrVja/61LGbXpKNX8VOUCI7wXckIIaze/YuKR+w/fA3g==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=ydmGf1bp24eNX05PITJwa3bhEBDE4zbF9LFOV6NwGVc=;
 b=WKQYVyXmRd5AI1fPqTKYxfNl+irAVzlHPtxIO947s6YXYFG05pQL4AeHzBFvwk88Yu/HNy896SzZgM+bhV5hVOMVsAKbaYOuUYUtZa7Pf2XVBjdoNT62nG+3bFYrRnhZJ6nbsyDvKuH+dJTQaatGsZD7otgB45+SPYwuCRwYAIjcjk187KpJSt2+rpjjImOZfJq0N3VxQjyvco4qhH/hsjfVJm5tUh3BE04GVYooF2Jb32ESbs6S5sLoY2RqiUZUaC5hLY4idliyrAnCWx3f2+WNTmEkhmp0KMKtQv8RlHEK1lCJPYKIcmi2gWFDnrsTTI6LhQ8h+0i19t8LmSSTrg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=ydmGf1bp24eNX05PITJwa3bhEBDE4zbF9LFOV6NwGVc=;
 b=3GPnqUqyD1rwL8TlhxU5Lvlznp1uNvzADMlgHhN5KiTnIBTQtLLSoq0TaQqNGnUAm1purX2QveGFXMcswEAlqKSXsYi1reQHZ1HVgjBQnCHV+/DsVdbzJsq9NWARYEno7viCMVInuoVxhD1UuF323nYJ+c8S3TwFBejCavzLvEA=
Authentication-Results: amd.com; dkim=none (message not signed)
 header.d=none;amd.com; dmarc=none action=none header.from=amd.com;
Received: from DM6PR12MB4340.namprd12.prod.outlook.com (2603:10b6:5:2a8::7) by
 DM5PR12MB2581.namprd12.prod.outlook.com (2603:10b6:4:b2::36) with
 Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.3174.21; Fri, 10 Jul 2020 17:54:27 +0000
Received: from DM6PR12MB4340.namprd12.prod.outlook.com
 ([fe80::f5e6:e937:2eac:18cf]) by DM6PR12MB4340.namprd12.prod.outlook.com
 ([fe80::f5e6:e937:2eac:18cf%3]) with mapi id 15.20.3174.023; Fri, 10 Jul 2020
 17:54:27 +0000
Subject: Re: [PATCH v2] drm/amdgpu: fix system hang issue during GPU reset
To: "Li, Dennis" <Dennis.Li@amd.com>,
 "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>,
 "Deucher, Alexander" <Alexander.Deucher@amd.com>,
 "Zhou1, Tao" <Tao.Zhou1@amd.com>, "Zhang, Hawking" <Hawking.Zhang@amd.com>,
 "Chen, Guchun" <Guchun.Chen@amd.com>,
 "Koenig, Christian" <Christian.Koenig@amd.com>
References: <20200708074800.10093-1-Dennis.Li@amd.com>
 <9b37bb53-1579-9a68-3317-e51f4e38f26f@amd.com>
 <DM5PR12MB25331941DBCCFBE97F1C99A8ED650@DM5PR12MB2533.namprd12.prod.outlook.com>
From: Andrey Grodzovsky <Andrey.Grodzovsky@amd.com>
Message-ID: <66c807cd-b3a4-a66d-a31d-7947419ab7f9@amd.com>
Date: Fri, 10 Jul 2020 13:54:25 -0400
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.4.0
In-Reply-To: <DM5PR12MB25331941DBCCFBE97F1C99A8ED650@DM5PR12MB2533.namprd12.prod.outlook.com>
Content-Language: en-US
X-ClientProxiedBy: YTOPR0101CA0011.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:15::24) To DM6PR12MB4340.namprd12.prod.outlook.com
 (2603:10b6:5:2a8::7)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from [172.27.231.243] (165.204.55.251) by
 YTOPR0101CA0011.CANPRD01.PROD.OUTLOOK.COM (2603:10b6:b00:15::24) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3174.20 via Frontend
 Transport; Fri, 10 Jul 2020 17:54:27 +0000
X-Originating-IP: [165.204.55.251]
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-HT: Tenant
X-MS-Office365-Filtering-Correlation-Id: 76a9da7b-2bbb-4e23-6974-08d824fa49de
X-MS-TrafficTypeDiagnostic: DM5PR12MB2581:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <DM5PR12MB258178757F873B15AFEA20DBEA650@DM5PR12MB2581.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:4714;
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: j02+2dcuvvi6fLkCbvrIadp5Yhq8qlyaKolRlitx/y5TPf/JmLDwFdkRDNa9Sm1FFfRmgK3GG1Q0s5KxMX2dOZU56nn7q1DQsKynl1KJV821LjeVJx/wJtjVXI+OGRpJBCYOUgt4isUWwzHrrQ7idZC94r6IQ5gcn0gh7VNHPuwoNaqBDfvHR1CcUImqfyM6BMhHIX+LZojHFbEI4AuIM7Q76lZHJbEDaluCRbTean0v+h7qve0VWfHbYDTgGytDlHxAFuZnYwa3dh20eZz7TYBqgSmISSM6nNEtTyxf7k9yRkZYh1VaYFclFsVknggyZ84Ri1mOankX7aSKfchqD+fglNIeLwVyhyePAO0qxPXgVyzo9fKEHz0RJ397LY8xZW8778Bu08KUr2fGT5PBrw==
X-Forefront-Antispam-Report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:DM6PR12MB4340.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFTY:;
 SFS:(4636009)(136003)(346002)(396003)(39860400002)(376002)(366004)(316002)(478600001)(2616005)(110136005)(6636002)(36756003)(31686004)(956004)(30864003)(5660300002)(31696002)(86362001)(66946007)(66476007)(66556008)(186003)(6486002)(53546011)(26005)(16526019)(16576012)(52116002)(8936002)(8676002)(83380400001)(2906002)(921003)(43740500002)(579004)(559001);
 DIR:OUT; SFP:1101; 
X-MS-Exchange-AntiSpam-MessageData: RtgmmSwCiXzWKO1us3IFJkcxYKFOBSMUOHmKO15PrAG26aeKzrkLys7pMrxVr3FO14PUp7nQqBptB9J4eBuodyHHKTvuluBCXuxfzkGfuxPV6SjbQDek2P141bKlbqgaFh3zdAXqALbyMhqttpDmKNWexHkQ5n+X2I09g/VKIGe1biI0a5XtzEh28SAhtoUDxzqY55hDZYdyuTK5mmYMcpEWMXPott1u+NTu4AVCxKK03POGkN3ic11EYhHNA6toUYe3D3KO79qvHjFCO4aK8LBt2HiV3P/2/jNZwxRd9KcqIDY+qBaoyekCyeoXY7balxfcXiZvTsr0EubyH/Zb2GESTtvSZ5zLZquNlj2R8KoV2TIjnRl1J7JZOs6hfr0RHgSHB08qVbFYSaDxXqIHGepyNPMSGmgR3ueZ0f6f6qXEJo7bNNINfnpC9CrSEWzj899iIx0kvbaHBjMHwsHDBlRpR7HbE6oF36fvmTB0nqhleBty9xtrVKMS0mWXMO8C
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 76a9da7b-2bbb-4e23-6974-08d824fa49de
X-MS-Exchange-CrossTenant-AuthSource: DM6PR12MB4340.namprd12.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 10 Jul 2020 17:54:27.5101 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: dyLbqC9FzXa2SDW6CY9Hz9mvPGxqrkRlWukphvc/kLe1Ed/a2XO14bOXmvE7fx9IIuabONe7gpgTvwjkeXw+Kw==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM5PR12MB2581
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

Ck9uIDcvMTAvMjAgMToyNCBQTSwgTGksIERlbm5pcyB3cm90ZToKPiBbQU1EIE9mZmljaWFsIFVz
ZSBPbmx5IC0gSW50ZXJuYWwgRGlzdHJpYnV0aW9uIE9ubHldCj4KPiBIaSwgQW5kcmV5LAo+ICAg
ICAgICBQbGVhc2Ugc2VlIG15IGJlbG93IGNvbW1lbnRzLgo+Cj4gQmVzdCBSZWdhcmRzCj4gRGVu
bmlzIExpCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0KPiBGcm9tOiBHcm9kem92c2t5LCBB
bmRyZXkgPEFuZHJleS5Hcm9kem92c2t5QGFtZC5jb20+Cj4gU2VudDogRnJpZGF5LCBKdWx5IDEw
LCAyMDIwIDExOjA4IFBNCj4gVG86IExpLCBEZW5uaXMgPERlbm5pcy5MaUBhbWQuY29tPjsgYW1k
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmc7IERldWNoZXIsIEFsZXhhbmRlciA8QWxleGFuZGVy
LkRldWNoZXJAYW1kLmNvbT47IFpob3UxLCBUYW8gPFRhby5aaG91MUBhbWQuY29tPjsgWmhhbmcs
IEhhd2tpbmcgPEhhd2tpbmcuWmhhbmdAYW1kLmNvbT47IENoZW4sIEd1Y2h1biA8R3VjaHVuLkNo
ZW5AYW1kLmNvbT47IEtvZW5pZywgQ2hyaXN0aWFuIDxDaHJpc3RpYW4uS29lbmlnQGFtZC5jb20+
Cj4gU3ViamVjdDogUmU6IFtQQVRDSCB2Ml0gZHJtL2FtZGdwdTogZml4IHN5c3RlbSBoYW5nIGlz
c3VlIGR1cmluZyBHUFUgcmVzZXQKPgo+Cj4gT24gNy84LzIwIDM6NDggQU0sIERlbm5pcyBMaSB3
cm90ZToKPj4gRHVyaW5nIEdQVSByZXNldCwgZHJpdmVyIHNob3VsZCBob2xkIG9uIGFsbCBleHRl
cm5hbCBhY2Nlc3MgdG8KPj4gR1BVLCBvdGhlcndpc2UgcHNwIHdpbGwgcmFuZG9tbHkgZmFpbCB0
byBkbyBwb3N0LCBhbmQgdGhlbiBjYXVzZQo+PiBzeXN0ZW0gaGFuZy4KPj4KPj4gdjI6Cj4+IDEu
IGFkZCByd2xvY2sgZm9yIHNvbWUgaW9jdGxzLCBkZWJ1Z2ZzIGFuZCBmaWxlLWNsb3NlIGZ1bmN0
aW9uLgo+PiAyLiBjaGFuZ2UgdG8gdXNlIGRxbS0+aXNfcmVzZXR0aW5nIGFuZCBkcW1fbG9jayBm
b3IgcHJvdGVjdGlvbiBpbiBrZmQKPj4gZHJpdmVyLgo+PiAzLiByZW1vdmUgdHJ5X2xvY2sgYW5k
IGNoYW5nZSBhZGV2LT5pbl9ncHVfcmVzZXQgYXMgYXRvbWljLCB0byBhdm9pZAo+PiByZS1lbnRl
ciBHUFUgcmVjb3ZlcnkgZm9yIHRoZSBzYW1lIEdQVSBoYW5nLgo+Cj4gU3RpbGwgYWRldi0+aW5f
Z3B1X3Jlc2V0IGlzIHByb25lIHRvIHJhY2UsIG5vID8gSSBtZWFuIGlmIHRoZSByZXNldCBzdGFy
dHMgcmlnaHQgQUZURVIgd2UgY2hlY2tlZCBmb3IgdGhlIGZsYWcgdmFsdWUgdGhlbiB3ZSBzdGls
bCBoYXZlIGEgcHJvYmxlbS4KPiBbRGVubmlzXTogcmlnaHQsIGFkZXYtPmluX2dwdV9yZXNldCBj
YW4ndCBzb2x2ZSByYWNlIGlzc3VlLCBzbyBJIGludHJvZHVjZWQgYWRldi0+cmVzZXRfc2VtLgoK
ClRoZW4gd2h5IGtlZXAgaW5fZ3B1X3Jlc2V0IGFuZCBub3QgY29udmVydCBhbGwgdGhvc2UgcGxh
Y2VzIGl0J3MgdXNlZCB0byB1c2luZyAKcmVzZXRfc2VtID8KCkFsc28gYmVsbG93IHRoZXJlIHdh
cyBhIGNvbW1lbnQgb24gYW1kZ3B1X2RldmljZV9sb2NrX2FkZXYsIHRha2UgYSBsb29rIHBsZWFz
ZS4KCkFuZHJleQoKPgo+IEkgcmVjZW50bHkgd29ya2VkIChhbmQgc3RpbGwgZG8pIG9uIGRldmlj
ZSB1bnBsdWcgc3VwcG9ydCwgSSB3YXMgdGhpbmtpbmcgLSBjYW4gd2UgdXNlIHNvbWV0aGluZyBh
bGlrZSBkcm1fZGV2X2VudGVyL2RybV9kZXZfZXhpdCBhbmQgZHJtX2Rldl91bnBsdWcgZm9yIG91
ciBjYXVzZSBhbmQgdGhpcyB3b3VsZCByZXBsYWNlIGJvdGggYWRldi0+aW5fZ3B1X3Jlc2V0IGFu
ZCB0aGUgbG9ja19yZXNldCBtdXRleChvciByd19zZW1hcGhvdGUpID8gSW4gb3VyIGNhc2Ugd2Ug
YWxzbyB3b3VsZCBuZWVkIGEgICdkcm1fZGV2X3BsdWdfYmFjaycgZnVuY3Rpb24gdG9vLiBNYXli
ZSB3ZSBjYW4gZXZlbiB1c2UgdGhlIGV4aXN0aW5nIGRybSBoZWxwZXJzIGFzIGlzIGFzIGJlY2F1
c2Ugd2hpbGUgZGV2aWNlIGlzIGJlaW5nIHJlc2V0IGl0J3MgZWZmZWN0aXZlbHkgdGhlIHNhbWUg
YXMgaWYgaXQncyB1bnBsdWdnZWQgaSB0aGluay4uLgo+IFtEZW5uaXNdOiBXaGVuIEdQVSBkbyBi
YWNvIHJlc2V0LCBidXMgaXMgc3RpbGwgYWN0aXZlIHdoaWNoIGlzIGRpZmZlcmVudCB1bnBsdWcu
IEkgcHJlZmVyIHRvIHVzZSBhZGV2LT5yZXNldF9zZW0uCj4KPiBTb21lIG1vcmUgYmVsbG93Cj4K
Pj4gU2lnbmVkLW9mZi1ieTogRGVubmlzIExpIDxEZW5uaXMuTGlAYW1kLmNvbT4KPj4gQ2hhbmdl
LUlkOiBJN2Y3N2E3Mjc5NTQ2MjU4N2VkN2Q1ZjUxZmU1M2E1OTRhMGYxZjcwOAo+Pgo+PiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1LmggYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaAo+PiBpbmRleCA4MGYzMmIzYmViODguLmYyMzU0OTI3
OTlkNyAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1LmgK
Pj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1LmgKPj4gQEAgLTk2Myw5
ICs5NjMsOSBAQCBzdHJ1Y3QgYW1kZ3B1X2RldmljZSB7Cj4+ICAgIAlib29sICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGluX3N1c3BlbmQ7Cj4+ICAgIAlib29sCQkJCWluX2hpYmVybmF0ZTsK
Pj4gICAgCj4+IC0JYm9vbCAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbl9ncHVfcmVzZXQ7
Cj4+ICsJYXRvbWljX3QgICAgICAgICAgICAgICAgICAgICAgICBpbl9ncHVfcmVzZXQ7Cj4+ICAg
IAllbnVtIHBwX21wMV9zdGF0ZSAgICAgICAgICAgICAgIG1wMV9zdGF0ZTsKPj4gLQlzdHJ1Y3Qg
bXV0ZXggIGxvY2tfcmVzZXQ7Cj4+ICsJc3RydWN0IHJ3X3NlbWFwaG9yZQlyZXNldF9zZW07Cj4+
ICAgIAlzdHJ1Y3QgYW1kZ3B1X2Rvb3JiZWxsX2luZGV4IGRvb3JiZWxsX2luZGV4Owo+PiAgICAK
Pj4gICAgCXN0cnVjdCBtdXRleAkJCW5vdGlmaWVyX2xvY2s7Cj4+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92MTAuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3YxMC5jCj4+IGluZGV4IDY5MWM4
OTcwNWJjZC4uYWY3MWQ4ZTkzMDgxIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92MTAuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92MTAuYwo+PiBAQCAtNTQzLDcgKzU0Myw3IEBA
IHN0YXRpYyBpbnQga2dkX2hxZF9kZXN0cm95KHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQgKm1x
ZCwKPj4gICAgCXVpbnQzMl90IHRlbXA7Cj4+ICAgIAlzdHJ1Y3QgdjEwX2NvbXB1dGVfbXFkICpt
ID0gZ2V0X21xZChtcWQpOwo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAr
CWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVJ
TzsKPj4gICAgCj4+ICAgICNpZiAwCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92Ny5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjcuYwo+PiBpbmRleCAwYjdlNzg3NDg1NDAuLjc1MGE4MzA4
Yzg2OCAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Ft
ZGtmZF9nZnhfdjcuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
YW1ka2ZkX2dmeF92Ny5jCj4+IEBAIC00MjUsNyArNDI1LDcgQEAgc3RhdGljIGludCBrZ2RfaHFk
X2Rlc3Ryb3koc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFkLAo+PiAgICAJdW5zaWduZWQg
bG9uZyBmbGFncywgZW5kX2ppZmZpZXM7Cj4+ICAgIAlpbnQgcmV0cnk7Cj4+ICAgIAo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKQo+PiAgICAJCXJldHVybiAtRUlPOwo+PiAgICAKPj4gICAgCWFjcXVpcmVfcXVldWUo
a2dkLCBwaXBlX2lkLCBxdWV1ZV9pZCk7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92OC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjguYwo+PiBpbmRleCBjY2Q2MzViODEyYjUuLjAyNzc5
M2UwYzFjYSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2FtZGtmZF9nZnhfdjguYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfYW1ka2ZkX2dmeF92OC5jCj4+IEBAIC00MjEsNyArNDIxLDcgQEAgc3RhdGljIGludCBrZ2Rf
aHFkX2Rlc3Ryb3koc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFkLAo+PiAgICAJaW50IHJl
dHJ5Owo+PiAgICAJc3RydWN0IHZpX21xZCAqbSA9IGdldF9tcWQobXFkKTsKPj4gICAgCj4+IC0J
aWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dw
dV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1FSU87Cj4+ICAgIAo+PiAgICAJYWNxdWlyZV9xdWV1
ZShrZ2QsIHBpcGVfaWQsIHF1ZXVlX2lkKTsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y5LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92OS5jCj4+IGluZGV4IGRmODQxYzJhYzVlNy4uZTRh
NzdmN2E0YzJkIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfYW1ka2ZkX2dmeF92OS5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9hbWRrZmRfZ2Z4X3Y5LmMKPj4gQEAgLTU0MSw3ICs1NDEsNyBAQCBpbnQga2dkX2dmeF92
OV9ocWRfZGVzdHJveShzdHJ1Y3Qga2dkX2RldiAqa2dkLCB2b2lkICptcWQsCj4+ICAgIAl1aW50
MzJfdCB0ZW1wOwo+PiAgICAJc3RydWN0IHY5X21xZCAqbSA9IGdldF9tcWQobXFkKTsKPj4gICAg
Cj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYt
PmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1FSU87Cj4+ICAgIAo+PiAgICAJYWNxdWly
ZV9xdWV1ZShrZ2QsIHBpcGVfaWQsIHF1ZXVlX2lkKTsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2NzLmMKPj4gaW5kZXggZmZiY2FmNGJmYjhiLi5hOTRiM2Y4NjJmYzIgMTAwNjQ0
Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jCj4+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jCj4+IEBAIC0xMjkyLDYgKzEy
OTIsOCBAQCBpbnQgYW1kZ3B1X2NzX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQg
KmRhdGEsIHN0cnVjdCBkcm1fZmlsZSAqZmlscCkKPj4gICAgCXBhcnNlci5hZGV2ID0gYWRldjsK
Pj4gICAgCXBhcnNlci5maWxwID0gZmlscDsKPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5y
ZXNldF9zZW0pOwo+PiArCj4+ICAgIAlyID0gYW1kZ3B1X2NzX3BhcnNlcl9pbml0KCZwYXJzZXIs
IGRhdGEpOwo+PiAgICAJaWYgKHIpIHsKPj4gICAgCQlEUk1fRVJST1IoIkZhaWxlZCB0byBpbml0
aWFsaXplIHBhcnNlciAlZCFcbiIsIHIpOwo+PiBAQCAtMTMzMSw2ICsxMzMzLDggQEAgaW50IGFt
ZGdwdV9jc19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLCBzdHJ1Y3Qg
ZHJtX2ZpbGUgKmZpbHApCj4+ICAgIG91dDoKPj4gICAgCWFtZGdwdV9jc19wYXJzZXJfZmluaSgm
cGFyc2VyLCByLCByZXNlcnZlZF9idWZmZXJzKTsKPj4gICAgCj4+ICsJdXBfcmVhZCgmYWRldi0+
cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJcmV0dXJuIHI7Cj4+ICAgIH0KPj4gICAgCj4+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3R4LmMgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3R4LmMKPj4gaW5kZXggODg0MmM1NWQ0NDkwLi5k
ODVkMTNmN2EwNDMgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9jdHguYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3R4
LmMKPj4gQEAgLTM1OCw2ICszNTgsOCBAQCBzdGF0aWMgaW50IGFtZGdwdV9jdHhfcXVlcnkyKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+PiAgICAJaWYgKGF0b21pY19yZWFkKCZjdHgtPmd1
aWx0eSkpCj4+ICAgIAkJb3V0LT5zdGF0ZS5mbGFncyB8PSBBTURHUFVfQ1RYX1FVRVJZMl9GTEFH
U19HVUlMVFk7Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+
PiAgICAJLypxdWVyeSB1ZSBjb3VudCovCj4+ICAgIAlyYXNfY291bnRlciA9IGFtZGdwdV9yYXNf
cXVlcnlfZXJyb3JfY291bnQoYWRldiwgZmFsc2UpOwo+PiAgICAJLypyYXMgY291bnRlciBpcyBt
b25vdG9uaWMgaW5jcmVhc2luZyovCj4+IEBAIC0zNzMsNiArMzc1LDggQEAgc3RhdGljIGludCBh
bWRncHVfY3R4X3F1ZXJ5MihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPj4gICAgCQljdHgt
PnJhc19jb3VudGVyX2NlID0gcmFzX2NvdW50ZXI7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCXVwX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCW11dGV4X3VubG9jaygmbWdyLT5sb2Nr
KTsKPj4gICAgCXJldHVybiAwOwo+PiAgICB9Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2RlYnVnZnMuYwo+PiBpbmRleCBhZWFkYTdjOWZiZWEuLmVjYmZmNTMyYTIxYiAx
MDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RlYnVnZnMu
Ywo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGVidWdmcy5jCj4+
IEBAIC0xMDAsMTQgKzEwMCwxNCBAQCBzdGF0aWMgaW50IGFtZGdwdV9kZWJ1Z2ZzX2F1dG9kdW1w
X29wZW4oc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCj4+ICAgIAo+PiAg
ICAJZmlsZS0+cHJpdmF0ZV9kYXRhID0gYWRldjsKPj4gICAgCj4+IC0JbXV0ZXhfbG9jaygmYWRl
di0+bG9ja19yZXNldCk7Cj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAJ
aWYgKGFkZXYtPmF1dG9kdW1wLmR1bXBpbmcuZG9uZSkgewo+PiAgICAJCXJlaW5pdF9jb21wbGV0
aW9uKCZhZGV2LT5hdXRvZHVtcC5kdW1waW5nKTsKPj4gICAgCQlyZXQgPSAwOwo+PiAgICAJfSBl
bHNlIHsKPj4gICAgCQlyZXQgPSAtRUJVU1k7Cj4+ICAgIAl9Cj4+IC0JbXV0ZXhfdW5sb2NrKCZh
ZGV2LT5sb2NrX3Jlc2V0KTsKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAK
Pj4gICAgCXJldHVybiByZXQ7Cj4+ICAgIH0KPj4gQEAgLTEyNiw3ICsxMjYsNyBAQCBzdGF0aWMg
dW5zaWduZWQgaW50IGFtZGdwdV9kZWJ1Z2ZzX2F1dG9kdW1wX3BvbGwoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCBwb2xsXwo+PiAgICAKPj4gICAgCXBvbGxfd2FpdChmaWxlLCAmYWRldi0+YXV0
b2R1bXAuZ3B1X2hhbmcsIHBvbGxfdGFibGUpOwo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1
X3Jlc2V0KQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAg
CQlyZXR1cm4gUE9MTElOIHwgUE9MTFJETk9STSB8IFBPTExXUk5PUk07Cj4+ICAgIAo+PiAgICAJ
cmV0dXJuIDA7Cj4+IEBAIC0xMTg4LDcgKzExODgsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV9kZWJ1
Z2ZzX3Rlc3RfaWIoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+PiAgICAJfQo+PiAg
ICAKPj4gICAgCS8qIEF2b2lkIGFjY2lkZW50bHkgdW5wYXJraW5nIHRoZSBzY2hlZCB0aHJlYWQg
ZHVyaW5nIEdQVSByZXNldCAqLwo+PiAtCW11dGV4X2xvY2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+
PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAgCj4+ICAgIAkvKiBob2xkIG9u
IHRoZSBzY2hlZHVsZXIgKi8KPj4gICAgCWZvciAoaSA9IDA7IGkgPCBBTURHUFVfTUFYX1JJTkdT
OyBpKyspIHsKPj4gQEAgLTEyMTUsNyArMTIxNSw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RlYnVn
ZnNfdGVzdF9pYihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4+ICAgIAkJa3RocmVh
ZF91bnBhcmsocmluZy0+c2NoZWQudGhyZWFkKTsKPj4gICAgCX0KPj4gICAgCj4+IC0JbXV0ZXhf
dW5sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Owo+PiAgICAKPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGV2LT5kZXYpOwo+PiAg
ICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGV2LT5kZXYpOwo+PiBAQCAtMTM5NSw3ICsx
Mzk1LDcgQEAgc3RhdGljIGludCBhbWRncHVfZGVidWdmc19pYl9wcmVlbXB0KHZvaWQgKmRhdGEs
IHU2NCB2YWwpCj4+ICAgIAkJcmV0dXJuIC1FTk9NRU07Cj4+ICAgIAo+PiAgICAJLyogQXZvaWQg
YWNjaWRlbnRseSB1bnBhcmtpbmcgdGhlIHNjaGVkIHRocmVhZCBkdXJpbmcgR1BVIHJlc2V0ICov
Cj4+IC0JbXV0ZXhfbG9jaygmYWRldi0+bG9ja19yZXNldCk7Cj4+ICsJZG93bl9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOwo+PiAgICAKPj4gICAgCS8qIHN0b3AgdGhlIHNjaGVkdWxlciAqLwo+PiAg
ICAJa3RocmVhZF9wYXJrKHJpbmctPnNjaGVkLnRocmVhZCk7Cj4+IEBAIC0xNDM2LDcgKzE0MzYs
NyBAQCBzdGF0aWMgaW50IGFtZGdwdV9kZWJ1Z2ZzX2liX3ByZWVtcHQodm9pZCAqZGF0YSwgdTY0
IHZhbCkKPj4gICAgCS8qIHJlc3RhcnQgdGhlIHNjaGVkdWxlciAqLwo+PiAgICAJa3RocmVhZF91
bnBhcmsocmluZy0+c2NoZWQudGhyZWFkKTsKPj4gICAgCj4+IC0JbXV0ZXhfdW5sb2NrKCZhZGV2
LT5sb2NrX3Jlc2V0KTsKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAKPj4g
ICAgCXR0bV9ib191bmxvY2tfZGVsYXllZF93b3JrcXVldWUoJmFkZXYtPm1tYW4uYmRldiwgcmVz
Y2hlZCk7Cj4+ICAgIAo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rldmlj
ZS5jCj4+IGluZGV4IDI5MTNlNDFmNjNhNS4uNGYzZWM5NzQ2ZDBjIDEwMDY0NAo+PiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMKPj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jCj4+IEBAIC0xOTI5LDcgKzE5Mjks
NyBAQCBzdGF0aWMgaW50IGFtZGdwdV9kZXZpY2VfZndfbG9hZGluZyhzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldikKPj4gICAgCQkJaWYgKGFkZXYtPmlwX2Jsb2Nrc1tpXS5zdGF0dXMuaHcgPT0g
dHJ1ZSkKPj4gICAgCQkJCWJyZWFrOwo+PiAgICAKPj4gLQkJCWlmIChhZGV2LT5pbl9ncHVfcmVz
ZXQgfHwgYWRldi0+aW5fc3VzcGVuZCkgewo+PiArCQkJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5p
bl9ncHVfcmVzZXQpIHx8IGFkZXYtPmluX3N1c3BlbmQpIHsKPj4gICAgCQkJCXIgPSBhZGV2LT5p
cF9ibG9ja3NbaV0udmVyc2lvbi0+ZnVuY3MtPnJlc3VtZShhZGV2KTsKPj4gICAgCQkJCWlmIChy
KSB7Cj4+ICAgIAkJCQkJRFJNX0VSUk9SKCJyZXN1bWUgb2YgSVAgYmxvY2sgPCVzPiBmYWlsZWQg
JWRcbiIsCj4+IEBAIC0yMTAwLDcgKzIxMDAsNyBAQCBzdGF0aWMgYm9vbCBhbWRncHVfZGV2aWNl
X2NoZWNrX3ZyYW1fbG9zdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPj4gICAgCQkJQU1E
R1BVX1JFU0VUX01BR0lDX05VTSkpCj4+ICAgIAkJcmV0dXJuIHRydWU7Cj4+ICAgIAo+PiAtCWlm
ICghYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlmICghYXRvbWljX3JlYWQoJmFkZXYtPmluX2dw
dV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIGZhbHNlOwo+PiAgICAKPj4gICAgCS8qCj4+IEBAIC0z
MDI2LDcgKzMwMjYsOCBAQCBpbnQgYW1kZ3B1X2RldmljZV9pbml0KHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LAo+PiAgICAJbXV0ZXhfaW5pdCgmYWRldi0+bW5fbG9jayk7Cj4+ICAgIAltdXRl
eF9pbml0KCZhZGV2LT52aXJ0LnZmX2Vycm9ycy5sb2NrKTsKPj4gICAgCWhhc2hfaW5pdChhZGV2
LT5tbl9oYXNoKTsKPj4gLQltdXRleF9pbml0KCZhZGV2LT5sb2NrX3Jlc2V0KTsKPj4gKwlpbml0
X3J3c2VtKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCWF0b21pY19zZXQoJmFkZXYtPmluX2dwdV9y
ZXNldCwgMCk7Cj4+ICAgIAltdXRleF9pbml0KCZhZGV2LT5wc3AubXV0ZXgpOwo+PiAgICAJbXV0
ZXhfaW5pdCgmYWRldi0+bm90aWZpZXJfbG9jayk7Cj4+ICAgIAo+PiBAQCAtNDEzMSwxNiArNDEz
MiwxNCBAQCBzdGF0aWMgaW50IGFtZGdwdV9kb19hc2ljX3Jlc2V0KHN0cnVjdCBhbWRncHVfaGl2
ZV9pbmZvICpoaXZlLAo+PiAgICAJcmV0dXJuIHI7Cj4+ICAgIH0KPj4gICAgCj4+IC1zdGF0aWMg
Ym9vbCBhbWRncHVfZGV2aWNlX2xvY2tfYWRldihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwg
Ym9vbCB0cnlsb2NrKQo+PiArc3RhdGljIGJvb2wgYW1kZ3B1X2RldmljZV9sb2NrX2FkZXYoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4+ICAgIHsKPj4gLQlpZiAodHJ5bG9jaykgewo+PiAt
CQlpZiAoIW11dGV4X3RyeWxvY2soJmFkZXYtPmxvY2tfcmVzZXQpKQo+PiAtCQkJcmV0dXJuIGZh
bHNlOwo+PiAtCX0gZWxzZQo+PiAtCQltdXRleF9sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPj4g
KwlpZiAoYXRvbWljX2NtcHhjaGcoJmFkZXYtPmluX2dwdV9yZXNldCwgMCwgMSkgIT0gMCkKPj4g
KwkJcmV0dXJuIGZhbHNlOwo+PiArCj4+ICsJZG93bl93cml0ZSgmYWRldi0+cmVzZXRfc2VtKTsK
Pgo+IEluIFYxIENocmlzdGlhbiByYWlzZWQgYSBjb25jZXJuIG9mIHRoaXMgY2hhbmdlIGluY3Jl
YXNpbmfCoCB0aGUgY2hhbmNlIGZvciBncHUKPiByZWNvdmVyeSBhYm9ydCBkdWUgdG8gY29sbGlz
aW9uIG9mIGFtZGdwdV9kZXZpY2VfbG9ja19hZGV2IGRvaW5nIGRvd25fd3JpdGUKPiB0cnlsb2Nr
IHdpdGggcmVhZCBzaWRlIGxvY2sgb2YgYW55IG9mIHRoZSBtYW55IG9wZXJhdGlvbnMgaGVyZS4g
SSB1bmRlcnN0YW5kIHRoZQo+IG5lZWQgZm9yIHRoaXMgYnV0IGJlZm9yZSB0aGUgJ3RyeWxvY2sn
wqAgd2FzIHVzZWQgb25seSBmb3IgWEdNSSBjYXNlIGJlY2F1c2Ugd2UKPiBrbmV3IFhHTUkgaGFu
ZyBvbiBvbmNlIGNhcmQgd2lsbCB0cmlnZ2VyIGhhbmdzIG9uIGFsbCBvdGhlciBjYXJkcyBpbiB0
aGUgaGl2ZQo+IGJ1dCBub3cgdGhlICd0cnlsb2NrJyBsb2dpYyAoaW1wbGVtZW50ZWQgYnkgYXRv
bWljX2NtcHhjaGcpIGFsc28gYXBwbGllcyB0byB0aGUKPiBtb3JlIGNvbW1vbiBub24gWEdNSSBj
YXNlCj4KPiBBbmRyZXkKPgo+Cj4+ICAgIAo+PiAgICAJYXRvbWljX2luYygmYWRldi0+Z3B1X3Jl
c2V0X2NvdW50ZXIpOwo+PiAtCWFkZXYtPmluX2dwdV9yZXNldCA9IHRydWU7Cj4+ICAgIAlzd2l0
Y2ggKGFtZGdwdV9hc2ljX3Jlc2V0X21ldGhvZChhZGV2KSkgewo+PiAgICAJY2FzZSBBTURfUkVT
RVRfTUVUSE9EX01PREUxOgo+PiAgICAJCWFkZXYtPm1wMV9zdGF0ZSA9IFBQX01QMV9TVEFURV9T
SFVURE9XTjsKPj4gQEAgLTQxNjAsOCArNDE1OSw4IEBAIHN0YXRpYyB2b2lkIGFtZGdwdV9kZXZp
Y2VfdW5sb2NrX2FkZXYoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4+ICAgIHsKPj4gICAg
CWFtZGdwdV92Zl9lcnJvcl90cmFuc19hbGwoYWRldik7Cj4+ICAgIAlhZGV2LT5tcDFfc3RhdGUg
PSBQUF9NUDFfU1RBVEVfTk9ORTsKPj4gLQlhZGV2LT5pbl9ncHVfcmVzZXQgPSBmYWxzZTsKPj4g
LQltdXRleF91bmxvY2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+PiArCWF0b21pY19zZXQoJmFkZXYt
PmluX2dwdV9yZXNldCwgMCk7Cj4+ICsJdXBfd3JpdGUoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICAg
IH0KPj4gICAgCj4+ICAgIHN0YXRpYyB2b2lkIGFtZGdwdV9kZXZpY2VfcmVzdW1lX2Rpc3BsYXlf
YXVkaW8oc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4+IEBAIC00Mjk3LDcgKzQyOTYsNyBA
QCBpbnQgYW1kZ3B1X2RldmljZV9ncHVfcmVjb3ZlcihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwKPj4gICAgCj4+ICAgIAkvKiBibG9jayBhbGwgc2NoZWR1bGVycyBhbmQgcmVzZXQgZ2l2ZW4g
am9iJ3MgcmluZyAqLwo+PiAgICAJbGlzdF9mb3JfZWFjaF9lbnRyeSh0bXBfYWRldiwgZGV2aWNl
X2xpc3RfaGFuZGxlLCBnbWMueGdtaS5oZWFkKSB7Cj4+IC0JCWlmICghYW1kZ3B1X2RldmljZV9s
b2NrX2FkZXYodG1wX2FkZXYsICFoaXZlKSkgewo+PiArCQlpZiAoIWFtZGdwdV9kZXZpY2VfbG9j
a19hZGV2KHRtcF9hZGV2KSkgewo+PiAgICAJCQlEUk1fSU5GTygiQmFpbGluZyBvbiBURFIgZm9y
IHNfam9iOiVsbHgsIGFzIGFub3RoZXIgYWxyZWFkeSBpbiBwcm9ncmVzcyIsCj4+ICAgIAkJCQkg
IGpvYiA/IGpvYi0+YmFzZS5pZCA6IC0xKTsKPj4gICAgCQkJbXV0ZXhfdW5sb2NrKCZoaXZlLT5o
aXZlX2xvY2spOwo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dlbS5jCj4+IGlu
ZGV4IDc3ZDk4OGEwMDMzZi4uOTZkZjM2NjlhOWQyIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ2VtLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X2dlbS5jCj4+IEBAIC02NzAsNiArNjcwLDggQEAgaW50IGFtZGdwdV9n
ZW1fdmFfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPj4gICAgCQli
b192YSA9IE5VTEw7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPj4gKwo+PiAgICAJc3dpdGNoIChhcmdzLT5vcGVyYXRpb24pIHsKPj4gICAgCWNhc2Ug
QU1ER1BVX1ZBX09QX01BUDoKPj4gICAgCQl2YV9mbGFncyA9IGFtZGdwdV9nZW1fdmFfbWFwX2Zs
YWdzKGFkZXYsIGFyZ3MtPmZsYWdzKTsKPj4gQEAgLTY5OSw2ICs3MDEsOCBAQCBpbnQgYW1kZ3B1
X2dlbV92YV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+PiAgICAJ
CWFtZGdwdV9nZW1fdmFfdXBkYXRlX3ZtKGFkZXYsICZmcHJpdi0+dm0sIGJvX3ZhLAo+PiAgICAJ
CQkJCWFyZ3MtPm9wZXJhdGlvbik7Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3Nl
bSk7Cj4+ICsKPj4gICAgZXJyb3JfYmFja29mZjoKPj4gICAgCXR0bV9ldV9iYWNrb2ZmX3Jlc2Vy
dmF0aW9uKCZ0aWNrZXQsICZsaXN0KTsKPj4gICAgCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ2Z4LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfZ2Z4LmMKPj4gaW5kZXggZDYxMjAzM2EyM2FjLi5jOWYxM2Y4MzZhN2EgMTAwNjQ0
Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZnguYwo+PiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZ2Z4LmMKPj4gQEAgLTcxMCw3ICs3
MTAsNyBAQCB1aW50MzJfdCBhbWRncHVfa2lxX3JyZWcoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYsIHVpbnQzMl90IHJlZykKPj4gICAgCSAqCj4+ICAgIAkgKiBhbHNvIGRvbid0IHdhaXQgYW55
bW9yZSBmb3IgSVJRIGNvbnRleHQKPj4gICAgCSAqICovCj4+IC0JaWYgKHIgPCAxICYmIChhZGV2
LT5pbl9ncHVfcmVzZXQgfHwgaW5faW50ZXJydXB0KCkpKQo+PiArCWlmIChyIDwgMSAmJiAoYXRv
bWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkgfHwgaW5faW50ZXJydXB0KCkpKQo+PiAgICAJ
CWdvdG8gZmFpbGVkX2tpcV9yZWFkOwo+PiAgICAKPj4gICAgCW1pZ2h0X3NsZWVwKCk7Cj4+IEBA
IC03NjgsNyArNzY4LDcgQEAgdm9pZCBhbWRncHVfa2lxX3dyZWcoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsIHVpbnQzMl90IHJlZywgdWludDMyX3QgdikKPj4gICAgCSAqCj4+ICAgIAkgKiBh
bHNvIGRvbid0IHdhaXQgYW55bW9yZSBmb3IgSVJRIGNvbnRleHQKPj4gICAgCSAqICovCj4+IC0J
aWYgKHIgPCAxICYmIChhZGV2LT5pbl9ncHVfcmVzZXQgfHwgaW5faW50ZXJydXB0KCkpKQo+PiAr
CWlmIChyIDwgMSAmJiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkgfHwgaW5faW50
ZXJydXB0KCkpKQo+PiAgICAJCWdvdG8gZmFpbGVkX2tpcV93cml0ZTsKPj4gICAgCj4+ICAgIAlt
aWdodF9zbGVlcCgpOwo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2pvYi5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5jCj4+
IGluZGV4IDkzNzAyOWFkNTI3MS4uMzY3NTI4ZGUxNjU4IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfam9iLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5jCj4+IEBAIC0yMjYsOCArMjI2LDEwIEBAIHN0YXRpYyBz
dHJ1Y3QgZG1hX2ZlbmNlICphbWRncHVfam9iX3J1bihzdHJ1Y3QgZHJtX3NjaGVkX2pvYiAqc2No
ZWRfam9iKQo+PiAgICAJaWYgKGZpbmlzaGVkLT5lcnJvciA8IDApIHsKPj4gICAgCQlEUk1fSU5G
TygiU2tpcCBzY2hlZHVsaW5nIElCcyFcbiIpOwo+PiAgICAJfSBlbHNlIHsKPj4gKwkJZG93bl9y
ZWFkKCZyaW5nLT5hZGV2LT5yZXNldF9zZW0pOwo+PiAgICAJCXIgPSBhbWRncHVfaWJfc2NoZWR1
bGUocmluZywgam9iLT5udW1faWJzLCBqb2ItPmlicywgam9iLAo+PiAgICAJCQkJICAgICAgICZm
ZW5jZSk7Cj4+ICsJCXVwX3JlYWQoJnJpbmctPmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICAgIAkJaWYg
KHIpCj4+ICAgIAkJCURSTV9FUlJPUigiRXJyb3Igc2NoZWR1bGluZyBJQnMgKCVkKVxuIiwgcik7
Cj4+ICAgIAl9Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfa21zLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfa21zLmMKPj4gaW5k
ZXggOWMyYzVlNGVkMWViLi5lZWJiZTIxMDNlMzIgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfa21zLmMKPj4gQEAgLTEwODQsNiArMTA4NCw4IEBAIHZvaWQgYW1kZ3B1
X2RyaXZlcl9wb3N0Y2xvc2Vfa21zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4+ICAgIAlpZiAo
IWZwcml2KQo+PiAgICAJCXJldHVybjsKPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX2dldF9zeW5jKGRldi0+ZGV2KTsKPj4gICAg
Cj4+ICAgIAlpZiAoYW1kZ3B1X2RldmljZV9pcF9nZXRfaXBfYmxvY2soYWRldiwgQU1EX0lQX0JM
T0NLX1RZUEVfVVZEKSAhPSBOVUxMKQo+PiBAQCAtMTEyMiw2ICsxMTI0LDggQEAgdm9pZCBhbWRn
cHVfZHJpdmVyX3Bvc3RjbG9zZV9rbXMoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPj4gICAgCj4+
ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRp
bWVfcHV0X2F1dG9zdXNwZW5kKGRldi0+ZGV2KTsKPj4gKwo+PiArCXVwX3JlYWQoJmFkZXYtPnJl
c2V0X3NlbSk7Cj4+ICAgIH0KPj4gICAgCj4+ICAgIC8qCj4+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9wbS5jCj4+IGluZGV4IGQyNDAxMzc5YmQzMy4uNjFiMjNhZTkwNmQ3IDEwMDY0
NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uYwo+PiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uYwo+PiBAQCAtMTYzLDcgKzE2
Myw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcG93ZXJfZHBtX3N0YXRlKHN0cnVjdCBk
ZXZpY2UgKmRldiwKPj4gICAgCWVudW0gYW1kX3BtX3N0YXRlX3R5cGUgcG07Cj4+ICAgIAlpbnQg
cmV0Owo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlmIChhdG9taWNf
cmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVQRVJNOwo+PiAgICAK
Pj4gICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsKPj4gQEAgLTE3Miw2
ICsxNzIsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bvd2VyX2RwbV9zdGF0ZShzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIHJldDsKPj4gICAgCX0KPj4gICAgCj4+ICsJ
ZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9z
d19zbXUoYWRldikpIHsKPj4gICAgCQlpZiAoYWRldi0+c211LnBwdF9mdW5jcy0+Z2V0X2N1cnJl
bnRfcG93ZXJfc3RhdGUpCj4+ICAgIAkJCXBtID0gc211X2dldF9jdXJyZW50X3Bvd2VyX3N0YXRl
KCZhZGV2LT5zbXUpOwo+PiBAQCAtMTgzLDYgKzE4NSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9nZXRfcG93ZXJfZHBtX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQlwbSA9IGFk
ZXYtPnBtLmRwbS51c2VyX3N0YXRlOwo+PiAgICAJfQo+PiAgICAKPj4gKwl1cF9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYt
PmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+PiAg
ICAKPj4gQEAgLTIwMSw3ICsyMDUsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3Bvd2Vy
X2RwbV9zdGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAllbnVtIGFtZF9wbV9zdGF0ZV90
eXBlICBzdGF0ZTsKPj4gICAgCWludCByZXQ7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVf
cmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJ
CXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJaWYgKHN0cm5jbXAoImJhdHRlcnkiLCBidWYs
IHN0cmxlbigiYmF0dGVyeSIpKSA9PSAwKQo+PiBAQCAtMjE5LDYgKzIyMyw4IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBtX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4g
ICAgCQlyZXR1cm4gcmV0Owo+PiAgICAJfQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJl
c2V0X3NlbSk7Cj4+ICsKPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+PiAg
ICAJCW11dGV4X2xvY2soJmFkZXYtPnBtLm11dGV4KTsKPj4gICAgCQlhZGV2LT5wbS5kcG0udXNl
cl9zdGF0ZSA9IHN0YXRlOwo+PiBAQCAtMjMyLDYgKzIzOCw5IEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9zZXRfcG93ZXJfZHBtX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCj4+ICAg
IAkJYW1kZ3B1X3BtX2NvbXB1dGVfY2xvY2tzKGFkZXYpOwo+PiAgICAJfQo+PiArCj4+ICsJdXBf
cmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3Rf
YnVzeShkZGV2LT5kZXYpOwo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+
ZGV2KTsKPj4gICAgCj4+IEBAIC0zMDcsNyArMzE2LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2dldF9wb3dlcl9kcG1fZm9yY2VfcGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2
LAo+PiAgICAJZW51bSBhbWRfZHBtX2ZvcmNlZF9sZXZlbCBsZXZlbCA9IDB4ZmY7Cj4+ICAgIAlp
bnQgcmV0Owo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlmIChhdG9t
aWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVQRVJNOwo+PiAg
ICAKPj4gICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsKPj4gQEAgLTMx
Niw2ICszMjUsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bvd2VyX2RwbV9mb3JjZV9w
ZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIHJldDsK
Pj4gICAgCX0KPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+
ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAgIAkJbGV2ZWwgPSBzbXVfZ2V0
X3BlcmZvcm1hbmNlX2xldmVsKCZhZGV2LT5zbXUpOwo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93
ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfcGVyZm9ybWFuY2VfbGV2ZWwpCj4+IEBAIC0zMjMsNiArMzM0
LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wb3dlcl9kcG1fZm9yY2VfcGVyZm9ybWFu
Y2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJZWxzZQo+PiAgICAJCWxldmVsID0g
YWRldi0+cG0uZHBtLmZvcmNlZF9sZXZlbDsKPj4gICAgCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsKPj4gKwo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYp
Owo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4gICAgCj4+
IEBAIC0zNDksNyArMzYyLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wb3dlcl9kcG1f
Zm9yY2VfcGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJZW51bSBh
bWRfZHBtX2ZvcmNlZF9sZXZlbCBjdXJyZW50X2xldmVsID0gMHhmZjsKPj4gICAgCWludCByZXQg
PSAwOwo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlmIChhdG9taWNf
cmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVQRVJNOwo+PiAgICAK
Pj4gICAgCWlmIChzdHJuY21wKCJsb3ciLCBidWYsIHN0cmxlbigibG93IikpID09IDApIHsKPj4g
QEAgLTM4MCw2ICszOTMsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3Bvd2VyX2RwbV9m
b3JjZV9wZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJu
IHJldDsKPj4gICAgCX0KPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+
PiArCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAgIAkJY3VycmVudF9s
ZXZlbCA9IHNtdV9nZXRfcGVyZm9ybWFuY2VfbGV2ZWwoJmFkZXYtPnNtdSk7Cj4+ICAgIAllbHNl
IGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9wZXJmb3JtYW5jZV9sZXZlbCkKPj4g
QEAgLTM4OCw3ICs0MDMsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3Bvd2VyX2RwbV9m
b3JjZV9wZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAlpZiAoY3Vy
cmVudF9sZXZlbCA9PSBsZXZlbCkgewo+PiAgICAJCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3ko
ZGRldi0+ZGV2KTsKPj4gICAgCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYp
Owo+PiAtCQlyZXR1cm4gY291bnQ7Cj4+ICsJCXJldCA9IGNvdW50Owo+PiArCQlnb3RvIHByb19l
bmQ7Cj4+ICAgIAl9Cj4+ICAgIAo+PiAgICAJaWYgKGFkZXYtPmFzaWNfdHlwZSA9PSBDSElQX1JB
VkVOKSB7Cj4+IEBAIC00MDksNyArNDI1LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9w
b3dlcl9kcG1fZm9yY2VfcGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2LAo+PiAg
ICAJCXByX2VycigiQ3VycmVudGx5IG5vdCBpbiBhbnkgcHJvZmlsZSBtb2RlIVxuIik7Cj4+ICAg
IAkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAJCXBtX3J1bnRp
bWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+IC0JCXJldHVybiAtRUlOVkFMOwo+PiAr
CQlyZXQgPSAtRUlOVkFMOwo+PiArCQlnb3RvIHByb19lbmQ7Cj4+ICAgIAl9Cj4+ICAgIAo+PiAg
ICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7Cj4+IEBAIC00MTcsNyArNDM0LDggQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wb3dlcl9kcG1fZm9yY2VfcGVyZm9ybWFuY2VfbGV2
ZWwoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJCWlmIChyZXQpIHsKPj4gICAgCQkJcG1fcnVu
dGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAJCQlwbV9ydW50aW1lX3B1dF9h
dXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+PiAtCQkJcmV0dXJuIC1FSU5WQUw7Cj4+ICsJCQlyZXQg
PSAtRUlOVkFMOwo+PiArCQkJZ290byBwcm9fZW5kOwo+PiAgICAJCX0KPj4gICAgCX0gZWxzZSBp
ZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbCkgewo+
PiAgICAJCW11dGV4X2xvY2soJmFkZXYtPnBtLm11dGV4KTsKPj4gQEAgLTQyNSwxNCArNDQzLDE2
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBtX2ZvcmNlX3BlcmZvcm1hbmNl
X2xldmVsKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQkJbXV0ZXhfdW5sb2NrKCZhZGV2LT5w
bS5tdXRleCk7Cj4+ICAgIAkJCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsK
Pj4gICAgCQkJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4gLQkJCXJl
dHVybiAtRUlOVkFMOwo+PiArCQkJcmV0ID0gLUVJTlZBTDsKPj4gKwkJCWdvdG8gcHJvX2VuZDsK
Pj4gICAgCQl9Cj4+ICAgIAkJcmV0ID0gYW1kZ3B1X2RwbV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZl
bChhZGV2LCBsZXZlbCk7Cj4+ICAgIAkJaWYgKHJldCkgewo+PiAgICAJCQltdXRleF91bmxvY2so
JmFkZXYtPnBtLm11dGV4KTsKPj4gICAgCQkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2
LT5kZXYpOwo+PiAgICAJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+
PiAtCQkJcmV0dXJuIC1FSU5WQUw7Cj4+ICsJCQlyZXQgPSAtRUlOVkFMOwo+PiArCQkJZ290byBw
cm9fZW5kOwo+PiAgICAJCX0gZWxzZSB7Cj4+ICAgIAkJCWFkZXYtPnBtLmRwbS5mb3JjZWRfbGV2
ZWwgPSBsZXZlbDsKPj4gICAgCQl9Cj4+IEBAIC00NDEsNyArNDYxLDkgQEAgc3RhdGljIHNzaXpl
X3QgYW1kZ3B1X3NldF9wb3dlcl9kcG1fZm9yY2VfcGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRl
dmljZSAqZGV2LAo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+
PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4gICAgCj4+IC0J
cmV0dXJuIGNvdW50Owo+PiArcHJvX2VuZDoKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Owo+PiArCXJldHVybiByZXQ7Cj4+ICAgIH0KPj4gICAgCj4+ICAgIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9nZXRfcHBfbnVtX3N0YXRlcyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+IEBAIC00NTMsNyAr
NDc1LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9udW1fc3RhdGVzKHN0cnVjdCBk
ZXZpY2UgKmRldiwKPj4gICAgCXN0cnVjdCBwcF9zdGF0ZXNfaW5mbyBkYXRhOwo+PiAgICAJaW50
IGksIGJ1Zl9sZW4sIHJldDsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4g
KwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1F
UEVSTTsKPj4gICAgCj4+ICAgIAlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7
Cj4+IEBAIC00OTcsNyArNTE5LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9jdXJf
c3RhdGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJZW51bSBhbWRfcG1fc3RhdGVfdHlwZSBw
bSA9IDA7Cj4+ICAgIAlpbnQgaSA9IDAsIHJldCA9IDA7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5p
bl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+
PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJcmV0ID0gcG1fcnVudGltZV9nZXRf
c3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtNTM4LDcgKzU2MCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9nZXRfcHBfZm9yY2Vfc3RhdGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJc3RydWN0
IGRybV9kZXZpY2UgKmRkZXYgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPj4gICAgCXN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2ID0gZGRldi0+ZGV2X3ByaXZhdGU7Cj4+ICAgIAo+PiAtCWlmIChh
ZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVz
ZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJaWYgKGFkZXYtPnBwX2Zv
cmNlX3N0YXRlX2VuYWJsZWQpCj4+IEBAIC01NTgsNyArNTgwLDcgQEAgc3RhdGljIHNzaXplX3Qg
YW1kZ3B1X3NldF9wcF9mb3JjZV9zdGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAl1bnNp
Z25lZCBsb25nIGlkeDsKPj4gICAgCWludCByZXQ7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9n
cHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAg
ICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJaWYgKHN0cmxlbihidWYpID09IDEpCj4+
IEBAIC01ODQsNiArNjA2LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9mb3JjZV9z
dGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJCXJldHVybiByZXQ7Cj4+ICAgIAkJfQo+
PiAgICAKPj4gKwkJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAJCS8qIG9ubHkg
c2V0IHVzZXIgc2VsZWN0ZWQgcG93ZXIgc3RhdGVzICovCj4+ICAgIAkJaWYgKHN0YXRlICE9IFBP
V0VSX1NUQVRFX1RZUEVfSU5URVJOQUxfQk9PVCAmJgo+PiAgICAJCSAgICBzdGF0ZSAhPSBQT1dF
Ul9TVEFURV9UWVBFX0RFRkFVTFQpIHsKPj4gQEAgLTU5MSw2ICs2MTQsOCBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfc2V0X3BwX2ZvcmNlX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAg
CQkJCQlBTURfUFBfVEFTS19FTkFCTEVfVVNFUl9TVEFURSwgJnN0YXRlKTsKPj4gICAgCQkJYWRl
di0+cHBfZm9yY2Vfc3RhdGVfZW5hYmxlZCA9IHRydWU7Cj4+ICAgIAkJfQo+PiArCQl1cF9yZWFk
KCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVz
eShkZGV2LT5kZXYpOwo+PiAgICAJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRl
dik7Cj4+ICAgIAl9Cj4+IEBAIC02MTgsNyArNjQzLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2dldF9wcF90YWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAljaGFyICp0YWJsZSA9IE5V
TEw7Cj4+ICAgIAlpbnQgc2l6ZSwgcmV0Owo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jl
c2V0KQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQly
ZXR1cm4gLUVQRVJNOwo+PiAgICAKPj4gICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRl
di0+ZGV2KTsKPj4gQEAgLTY2Miw3ICs2ODcsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0
X3BwX3RhYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCXN0cnVjdCBhbWRncHVfZGV2aWNl
ICphZGV2ID0gZGRldi0+ZGV2X3ByaXZhdGU7Cj4+ICAgIAlpbnQgcmV0ID0gMDsKPj4gICAgCj4+
IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmlu
X2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAgIAlyZXQgPSBw
bV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4+IEBAIC02NzEsMTYgKzY5NiwyMSBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX3RhYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4g
ICAgCQlyZXR1cm4gcmV0Owo+PiAgICAJfQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJl
c2V0X3NlbSk7Cj4+ICsKPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+PiAg
ICAJCXJldCA9IHNtdV9zeXNfc2V0X3BwX3RhYmxlKCZhZGV2LT5zbXUsICh2b2lkICopYnVmLCBj
b3VudCk7Cj4+ICAgIAkJaWYgKHJldCkgewo+PiAgICAJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9i
dXN5KGRkZXYtPmRldik7Cj4+ICAgIAkJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYt
PmRldik7Cj4+ICsJCQl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAJCQlyZXR1cm4g
cmV0Owo+PiAgICAJCX0KPj4gICAgCX0gZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNz
LT5zZXRfcHBfdGFibGUpCj4+ICAgIAkJYW1kZ3B1X2RwbV9zZXRfcHBfdGFibGUoYWRldiwgYnVm
LCBjb3VudCk7Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4g
ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRp
bWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+ICAgIAo+PiBAQCAtNzY5LDcgKzc5OSw3
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfb2RfY2xrX3ZvbHRhZ2Uoc3RydWN0IGRl
dmljZSAqZGV2LAo+PiAgICAJY29uc3QgY2hhciBkZWxpbWl0ZXJbM10gPSB7JyAnLCAnXG4nLCAn
XDAnfTsKPj4gICAgCXVpbnQzMl90IHR5cGU7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVf
cmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJ
CXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJaWYgKGNvdW50ID4gMTI3KQo+PiBAQCAtODEz
LDYgKzg0MywxMCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX29kX2Nsa192b2x0YWdl
KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQlyZXR1cm4gcmV0Owo+PiAgICAJfQo+PiAgICAK
Pj4gKwlyZXQgPSBjb3VudDsKPj4gKwo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsK
Pj4gKwo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7Cj4+ICAgIAkJcmV0ID0g
c211X29kX2VkaXRfZHBtX3RhYmxlKCZhZGV2LT5zbXUsIHR5cGUsCj4+ICAgIAkJCQkJICAgIHBh
cmFtZXRlciwgcGFyYW1ldGVyX3NpemUpOwo+PiBAQCAtODIwLDcgKzg1NCw4IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9zZXRfcHBfb2RfY2xrX3ZvbHRhZ2Uoc3RydWN0IGRldmljZSAqZGV2LAo+
PiAgICAJCWlmIChyZXQpIHsKPj4gICAgCQkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2
LT5kZXYpOwo+PiAgICAJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+
PiAtCQkJcmV0dXJuIC1FSU5WQUw7Cj4+ICsJCQlyZXQgPSAtRUlOVkFMOwo+PiArCQkJZ290byBw
cm9fZW5kOwo+PiAgICAJCX0KPj4gICAgCX0gZWxzZSB7Cj4+ICAgIAkJaWYgKGFkZXYtPnBvd2Vy
cGxheS5wcF9mdW5jcy0+b2RuX2VkaXRfZHBtX3RhYmxlKSB7Cj4+IEBAIC04MjksNyArODY0LDgg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9vZF9jbGtfdm9sdGFnZShzdHJ1Y3QgZGV2
aWNlICpkZXYsCj4+ICAgIAkJCWlmIChyZXQpIHsKPj4gICAgCQkJCXBtX3J1bnRpbWVfbWFya19s
YXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgCQkJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5k
KGRkZXYtPmRldik7Cj4+IC0JCQkJcmV0dXJuIC1FSU5WQUw7Cj4+ICsJCQkJcmV0ID0gLUVJTlZB
TDsKPj4gKwkJCQlnb3RvIHByb19lbmQ7Cj4+ICAgIAkJCX0KPj4gICAgCQl9Cj4+ICAgIAo+PiBA
QCAtODQwLDE4ICs4NzYsMjIgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9vZF9jbGtf
dm9sdGFnZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJCQkJCU5VTEwpOwo+PiAgICAJCQkJ
cG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAJCQkJcG1fcnVudGlt
ZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4gLQkJCQlyZXR1cm4gY291bnQ7Cj4+ICsJ
CQkJcmV0ID0gY291bnQ7Cj4+ICsJCQkJZ290byBwcm9fZW5kOwo+PiAgICAJCQl9IGVsc2Ugewo+
PiAgICAJCQkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAJCQkJ
cG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4gLQkJCQlyZXR1cm4gLUVJ
TlZBTDsKPj4gKwkJCQlyZXQgPSAtRUlOVkFMOwo+PiArCQkJCWdvdG8gcHJvX2VuZDsKPj4gICAg
CQkJfQo+PiAgICAJCX0KPj4gICAgCX0KPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3ko
ZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7
Cj4+ICAgIAo+PiAtCXJldHVybiBjb3VudDsKPj4gK3Byb19lbmQ6Cj4+ICsJdXBfcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPj4gKwlyZXR1cm4gcmV0Owo+PiAgICB9Cj4+ICAgIAo+PiAgICBzdGF0
aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX29kX2Nsa192b2x0YWdlKHN0cnVjdCBkZXZpY2UgKmRl
diwKPj4gQEAgLTg2Myw3ICs5MDMsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX29k
X2Nsa192b2x0YWdlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCXNzaXplX3Qgc2l6ZTsKPj4g
ICAgCWludCByZXQ7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYg
KGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07
Cj4+ICAgIAo+PiAgICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBA
QCAtOTE3LDcgKzk1Nyw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZmVhdHVyZXMo
c3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJdWludDY0X3QgZmVhdHVyZW1hc2s7Cj4+ICAgIAlp
bnQgcmV0Owo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlmIChhdG9t
aWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVQRVJNOwo+PiAg
ICAKPj4gICAgCXJldCA9IGtzdHJ0b3U2NChidWYsIDAsICZmZWF0dXJlbWFzayk7Cj4+IEBAIC05
MzIsMTEgKzk3MiwxMyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2ZlYXR1cmVzKHN0
cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQlyZXR1cm4gcmV0Owo+PiAgICAJfQo+PiAgICAKPj4g
Kwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19z
bXUoYWRldikpIHsKPj4gICAgCQlyZXQgPSBzbXVfc3lzX3NldF9wcF9mZWF0dXJlX21hc2soJmFk
ZXYtPnNtdSwgZmVhdHVyZW1hc2spOwo+PiAgICAJCWlmIChyZXQpIHsKPj4gICAgCQkJcG1fcnVu
dGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAJCQlwbV9ydW50aW1lX3B1dF9h
dXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+PiArCQkJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsK
Pj4gICAgCQkJcmV0dXJuIC1FSU5WQUw7Cj4+ICAgIAkJfQo+PiAgICAJfSBlbHNlIGlmIChhZGV2
LT5wb3dlcnBsYXkucHBfZnVuY3MtPnNldF9wcGZlYXR1cmVfc3RhdHVzKSB7Cj4+IEBAIC05NDQs
OSArOTg2LDEyIEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZmVhdHVyZXMoc3RydWN0
IGRldmljZSAqZGV2LAo+PiAgICAJCWlmIChyZXQpIHsKPj4gICAgCQkJcG1fcnVudGltZV9tYXJr
X2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVu
ZChkZGV2LT5kZXYpOwo+PiArCQkJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAgCQkJ
cmV0dXJuIC1FSU5WQUw7Cj4+ICAgIAkJfQo+PiAgICAJfQo+PiArCXVwX3JlYWQoJmFkZXYtPnJl
c2V0X3NlbSk7Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2
KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+ICAgIAo+
PiBAQCAtOTYyLDcgKzEwMDcsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2ZlYXR1
cmVzKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCXNzaXplX3Qgc2l6ZTsKPj4gICAgCWludCBy
ZXQ7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19y
ZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+
PiAgICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtOTcxLDYg
KzEwMTYsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2ZlYXR1cmVzKHN0cnVjdCBk
ZXZpY2UgKmRldiwKPj4gICAgCQlyZXR1cm4gcmV0Owo+PiAgICAJfQo+PiAgICAKPj4gKwlkb3du
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3Nt
dShhZGV2KSkKPj4gICAgCQlzaXplID0gc211X3N5c19nZXRfcHBfZmVhdHVyZV9tYXNrKCZhZGV2
LT5zbXUsIGJ1Zik7Cj4+ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdl
dF9wcGZlYXR1cmVfc3RhdHVzKQo+PiBAQCAtOTc4LDYgKzEwMjUsOCBAQCBzdGF0aWMgc3NpemVf
dCBhbWRncHVfZ2V0X3BwX2ZlYXR1cmVzKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCWVsc2UK
Pj4gICAgCQlzaXplID0gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICJcbiIpOwo+PiAgICAKPj4g
Kwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX21hcmtf
bGFzdF9idXN5KGRkZXYtPmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChk
ZGV2LT5kZXYpOwo+PiAgICAKPj4gQEAgLTEwMjMsNyArMTA3Miw3IEBAIHN0YXRpYyBzc2l6ZV90
IGFtZGdwdV9nZXRfcHBfZHBtX3NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJc3NpemVf
dCBzaXplOwo+PiAgICAJaW50IHJldDsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNl
dCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0
dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAgIAlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYt
PmRldik7Cj4+IEBAIC0xMDMyLDYgKzEwODEsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0
X3BwX2RwbV9zY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQlyZXR1cm4gcmV0Owo+PiAg
ICAJfQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAg
CWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPj4gICAgCQlzaXplID0gc211X3ByaW50X2Ns
a19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX1NDTEssIGJ1Zik7Cj4+ICAgIAllbHNlIGlmIChhZGV2
LT5wb3dlcnBsYXkucHBfZnVuY3MtPnByaW50X2Nsb2NrX2xldmVscykKPj4gQEAgLTEwMzksNiAr
MTA5MCw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX3NjbGsoc3RydWN0IGRl
dmljZSAqZGV2LAo+PiAgICAJZWxzZQo+PiAgICAJCXNpemUgPSBzbnByaW50ZihidWYsIFBBR0Vf
U0laRSwgIlxuIik7Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsK
Pj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1
bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+ICAgIAo+PiBAQCAtMTA5MSw3ICsx
MTQ0LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fc2NsayhzdHJ1Y3QgZGV2
aWNlICpkZXYsCj4+ICAgIAlpbnQgcmV0Owo+PiAgICAJdWludDMyX3QgbWFzayA9IDA7Cj4+ICAg
IAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2
LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJcmV0
ID0gYW1kZ3B1X3JlYWRfbWFzayhidWYsIGNvdW50LCAmbWFzayk7Cj4+IEBAIC0xMTA0LDExICsx
MTU3LDE1IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3NjbGsoc3RydWN0IGRl
dmljZSAqZGV2LAo+PiAgICAJCXJldHVybiByZXQ7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25f
cmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211
KGFkZXYpKQo+PiAgICAJCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNN
VV9TQ0xLLCBtYXNrLCB0cnVlKTsKPj4gICAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9m
dW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpCj4+ICAgIAkJcmV0ID0gYW1kZ3B1X2RwbV9mb3JjZV9j
bG9ja19sZXZlbChhZGV2LCBQUF9TQ0xLLCBtYXNrKTsKPj4gICAgCj4+ICsJdXBfcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2
LT5kZXYpOwo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4g
ICAgCj4+IEBAIC0xMTI3LDcgKzExODQsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bw
X2RwbV9tY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCXNzaXplX3Qgc2l6ZTsKPj4gICAg
CWludCByZXQ7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0
b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+
ICAgIAo+PiAgICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAt
MTEzNiw2ICsxMTkzLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fbWNsayhz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIHJldDsKPj4gICAgCX0KPj4gICAgCj4+
ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlpZiAoaXNfc3VwcG9y
dF9zd19zbXUoYWRldikpCj4+ICAgIAkJc2l6ZSA9IHNtdV9wcmludF9jbGtfbGV2ZWxzKCZhZGV2
LT5zbXUsIFNNVV9NQ0xLLCBidWYpOwo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBw
X2Z1bmNzLT5wcmludF9jbG9ja19sZXZlbHMpCj4+IEBAIC0xMTQzLDYgKzEyMDIsOCBAQCBzdGF0
aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9tY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4g
ICAgCWVsc2UKPj4gICAgCQlzaXplID0gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICJcbiIpOwo+
PiAgICAKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50
aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRv
c3VzcGVuZChkZGV2LT5kZXYpOwo+PiAgICAKPj4gQEAgLTExNTksNyArMTIyMCw3IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX21jbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAg
ICAJdWludDMyX3QgbWFzayA9IDA7Cj4+ICAgIAlpbnQgcmV0Owo+PiAgICAKPj4gLQlpZiAoYWRl
di0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0
KSkKPj4gICAgCQlyZXR1cm4gLUVQRVJNOwo+PiAgICAKPj4gICAgCXJldCA9IGFtZGdwdV9yZWFk
X21hc2soYnVmLCBjb3VudCwgJm1hc2spOwo+PiBAQCAtMTE3MiwxMSArMTIzMywxNSBAQCBzdGF0
aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9tY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4g
ICAgCQlyZXR1cm4gcmV0Owo+PiAgICAJfQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJl
c2V0X3NlbSk7Cj4+ICsKPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPj4gICAg
CQlyZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfTUNMSywgbWFzaywg
dHJ1ZSk7Cj4+ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNlX2Ns
b2NrX2xldmVsKQo+PiAgICAJCXJldCA9IGFtZGdwdV9kcG1fZm9yY2VfY2xvY2tfbGV2ZWwoYWRl
diwgUFBfTUNMSywgbWFzayk7Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7
Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAg
CXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+ICAgIAo+PiBAQCAtMTE5
NSw3ICsxMjYwLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fc29jY2xrKHN0
cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCXNzaXplX3Qgc2l6ZTsKPj4gICAgCWludCByZXQ7Cj4+
ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZh
ZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJ
cmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtMTIwNCw2ICsxMjY5
LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fc29jY2xrKHN0cnVjdCBkZXZp
Y2UgKmRldiwKPj4gICAgCQlyZXR1cm4gcmV0Owo+PiAgICAJfQo+PiAgICAKPj4gKwlkb3duX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShh
ZGV2KSkKPj4gICAgCQlzaXplID0gc211X3ByaW50X2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01V
X1NPQ0NMSywgYnVmKTsKPj4gICAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+
cHJpbnRfY2xvY2tfbGV2ZWxzKQo+PiBAQCAtMTIxMSw2ICsxMjc4LDggQEAgc3RhdGljIHNzaXpl
X3QgYW1kZ3B1X2dldF9wcF9kcG1fc29jY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCWVs
c2UKPj4gICAgCQlzaXplID0gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICJcbiIpOwo+PiAgICAK
Pj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX21h
cmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVu
ZChkZGV2LT5kZXYpOwo+PiAgICAKPj4gQEAgLTEyMjcsNyArMTI5Niw3IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3NvY2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAlp
bnQgcmV0Owo+PiAgICAJdWludDMyX3QgbWFzayA9IDA7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5p
bl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+
PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJcmV0ID0gYW1kZ3B1X3JlYWRfbWFz
ayhidWYsIGNvdW50LCAmbWFzayk7Cj4+IEBAIC0xMjQwLDYgKzEzMDksOCBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfc2V0X3BwX2RwbV9zb2NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJ
CXJldHVybiByZXQ7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPj4gKwo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+PiAgICAJCXJl
dCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9TT0NDTEssIG1hc2ssIHRy
dWUpOwo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5mb3JjZV9jbG9j
a19sZXZlbCkKPj4gQEAgLTEyNDcsNiArMTMxOCw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9z
ZXRfcHBfZHBtX3NvY2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAllbHNlCj4+ICAgIAkJ
cmV0ID0gMDsKPj4gICAgCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+PiAg
ICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAJcG1fcnVudGlt
ZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4gICAgCj4+IEBAIC0xMjY1LDcgKzEzMzgs
NyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9mY2xrKHN0cnVjdCBkZXZpY2Ug
KmRldiwKPj4gICAgCXNzaXplX3Qgc2l6ZTsKPj4gICAgCWludCByZXQ7Cj4+ICAgIAo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJcmV0ID0gcG1fcnVu
dGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtMTI3NCw2ICsxMzQ3LDggQEAgc3RhdGlj
IHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fZmNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAg
IAkJcmV0dXJuIHJldDsKPj4gICAgCX0KPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOwo+PiArCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAgIAkJ
c2l6ZSA9IHNtdV9wcmludF9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9GQ0xLLCBidWYpOwo+
PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5wcmludF9jbG9ja19sZXZl
bHMpCj4+IEBAIC0xMjgxLDYgKzEzNTYsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bw
X2RwbV9mY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCWVsc2UKPj4gICAgCQlzaXplID0g
c25wcmludGYoYnVmLCBQQUdFX1NJWkUsICJcbiIpOwo+PiAgICAKPj4gKwl1cF9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYt
PmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+PiAg
ICAKPj4gQEAgLTEyOTcsNyArMTM3NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBf
ZHBtX2ZjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJaW50IHJldDsKPj4gICAgCXVpbnQz
Ml90IG1hc2sgPSAwOwo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlm
IChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVQRVJN
Owo+PiAgICAKPj4gICAgCXJldCA9IGFtZGdwdV9yZWFkX21hc2soYnVmLCBjb3VudCwgJm1hc2sp
Owo+PiBAQCAtMTMxMCw2ICsxMzg3LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9k
cG1fZmNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIHJldDsKPj4gICAgCX0K
Pj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlpZiAo
aXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAgIAkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZl
bHMoJmFkZXYtPnNtdSwgU01VX0ZDTEssIG1hc2ssIHRydWUpOwo+PiAgICAJZWxzZSBpZiAoYWRl
di0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5mb3JjZV9jbG9ja19sZXZlbCkKPj4gQEAgLTEzMTcsNiAr
MTM5Niw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX2ZjbGsoc3RydWN0IGRl
dmljZSAqZGV2LAo+PiAgICAJZWxzZQo+PiAgICAJCXJldCA9IDA7Cj4+ICAgIAo+PiArCXVwX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1
c3koZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRl
dik7Cj4+ICAgIAo+PiBAQCAtMTMzNSw3ICsxNDE2LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2dldF9wcF9kcG1fZGNlZmNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAlzc2l6ZV90IHNp
emU7Cj4+ICAgIAlpbnQgcmV0Owo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+
PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4g
LUVQRVJNOwo+PiAgICAKPj4gICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2
KTsKPj4gQEAgLTEzNDQsNiArMTQyNSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBf
ZHBtX2RjZWZjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJCXJldHVybiByZXQ7Cj4+ICAg
IAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJ
aWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+PiAgICAJCXNpemUgPSBzbXVfcHJpbnRfY2xr
X2xldmVscygmYWRldi0+c211LCBTTVVfRENFRkNMSywgYnVmKTsKPj4gICAgCWVsc2UgaWYgKGFk
ZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+cHJpbnRfY2xvY2tfbGV2ZWxzKQo+PiBAQCAtMTM1MSw2
ICsxNDM0LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fZGNlZmNsayhzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAllbHNlCj4+ICAgIAkJc2l6ZSA9IHNucHJpbnRmKGJ1Ziwg
UEFHRV9TSVpFLCAiXG4iKTsKPj4gICAgCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsK
Pj4gKwo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAJ
cG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4gICAgCj4+IEBAIC0xMzY3
LDcgKzE0NTIsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9kY2VmY2xrKHN0
cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCWludCByZXQ7Cj4+ICAgIAl1aW50MzJfdCBtYXNrID0g
MDsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3Jl
YWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsKPj4gICAgCj4+
ICAgIAlyZXQgPSBhbWRncHVfcmVhZF9tYXNrKGJ1ZiwgY291bnQsICZtYXNrKTsKPj4gQEAgLTEz
ODAsNiArMTQ2NSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX2RjZWZjbGso
c3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJCXJldHVybiByZXQ7Cj4+ICAgIAl9Cj4+ICAgIAo+
PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJaWYgKGlzX3N1cHBv
cnRfc3dfc211KGFkZXYpKQo+PiAgICAJCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2
LT5zbXUsIFNNVV9EQ0VGQ0xLLCBtYXNrLCB0cnVlKTsKPj4gICAgCWVsc2UgaWYgKGFkZXYtPnBv
d2VycGxheS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpCj4+IEBAIC0xMzg3LDYgKzE0NzQs
OCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9kY2VmY2xrKHN0cnVjdCBkZXZp
Y2UgKmRldiwKPj4gICAgCWVsc2UKPj4gICAgCQlyZXQgPSAwOwo+PiAgICAKPj4gKwl1cF9yZWFk
KCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGRkZXYtPmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYp
Owo+PiAgICAKPj4gQEAgLTE0MDUsNyArMTQ5NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9n
ZXRfcHBfZHBtX3BjaWUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJc3NpemVfdCBzaXplOwo+
PiAgICAJaW50IHJldDsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlp
ZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1FUEVS
TTsKPj4gICAgCj4+ICAgIAlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4+
IEBAIC0xNDE0LDYgKzE1MDMsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9w
Y2llKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQlyZXR1cm4gcmV0Owo+PiAgICAJfQo+PiAg
ICAKPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCWlmIChpc19z
dXBwb3J0X3N3X3NtdShhZGV2KSkKPj4gICAgCQlzaXplID0gc211X3ByaW50X2Nsa19sZXZlbHMo
JmFkZXYtPnNtdSwgU01VX1BDSUUsIGJ1Zik7Cj4+ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBs
YXkucHBfZnVuY3MtPnByaW50X2Nsb2NrX2xldmVscykKPj4gQEAgLTE0MjEsNiArMTUxMiw4IEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX3BjaWUoc3RydWN0IGRldmljZSAqZGV2
LAo+PiAgICAJZWxzZQo+PiAgICAJCXNpemUgPSBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIlxu
Iik7Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCXBt
X3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0
X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+ICAgIAo+PiBAQCAtMTQzNyw3ICsxNTMwLDcgQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fcGNpZShzdHJ1Y3QgZGV2aWNlICpkZXYs
Cj4+ICAgIAlpbnQgcmV0Owo+PiAgICAJdWludDMyX3QgbWFzayA9IDA7Cj4+ICAgIAo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJcmV0ID0gYW1kZ3B1
X3JlYWRfbWFzayhidWYsIGNvdW50LCAmbWFzayk7Cj4+IEBAIC0xNDUwLDYgKzE1NDMsOCBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9wY2llKHN0cnVjdCBkZXZpY2UgKmRldiwK
Pj4gICAgCQlyZXR1cm4gcmV0Owo+PiAgICAJfQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFkZXYt
PnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPj4g
ICAgCQlyZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfUENJRSwgbWFz
aywgdHJ1ZSk7Cj4+ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNl
X2Nsb2NrX2xldmVsKQo+PiBAQCAtMTQ1Nyw2ICsxNTUyLDggQEAgc3RhdGljIHNzaXplX3QgYW1k
Z3B1X3NldF9wcF9kcG1fcGNpZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAllbHNlCj4+ICAg
IAkJcmV0ID0gMDsKPj4gICAgCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+
PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAJcG1fcnVu
dGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPj4gICAgCj4+IEBAIC0xNDc1LDcgKzE1
NzIsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX3NjbGtfb2Qoc3RydWN0IGRldmlj
ZSAqZGV2LAo+PiAgICAJdWludDMyX3QgdmFsdWUgPSAwOwo+PiAgICAJaW50IHJldDsKPj4gICAg
Cj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYt
PmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAgIAlyZXQg
PSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4+IEBAIC0xNDg0LDExICsxNTgxLDE1
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfc2Nsa19vZChzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4+ICAgIAkJcmV0dXJuIHJldDsKPj4gICAgCX0KPj4gICAgCj4+ICsJZG93bl9yZWFkKCZh
ZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikp
Cj4+ICAgIAkJdmFsdWUgPSBzbXVfZ2V0X29kX3BlcmNlbnRhZ2UoJihhZGV2LT5zbXUpLCBTTVVf
T0RfU0NMSyk7Cj4+ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9z
Y2xrX29kKQo+PiAgICAJCXZhbHVlID0gYW1kZ3B1X2RwbV9nZXRfc2Nsa19vZChhZGV2KTsKPj4g
ICAgCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJcG1fcnVudGlt
ZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1
c3BlbmQoZGRldi0+ZGV2KTsKPj4gICAgCj4+IEBAIC0xNTA1LDcgKzE2MDYsNyBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfc2V0X3BwX3NjbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJ
aW50IHJldDsKPj4gICAgCWxvbmcgaW50IHZhbHVlOwo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5f
Z3B1X3Jlc2V0KQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4g
ICAgCQlyZXR1cm4gLUVQRVJNOwo+PiAgICAKPj4gICAgCXJldCA9IGtzdHJ0b2woYnVmLCAwLCAm
dmFsdWUpOwo+PiBAQCAtMTUxOSw2ICsxNjIwLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3Nl
dF9wcF9zY2xrX29kKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQlyZXR1cm4gcmV0Owo+PiAg
ICAJfQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAg
CWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+PiAgICAJCXZhbHVlID0gc211X3NldF9v
ZF9wZXJjZW50YWdlKCYoYWRldi0+c211KSwgU01VX09EX1NDTEssICh1aW50MzJfdCl2YWx1ZSk7
Cj4+ICAgIAl9IGVsc2Ugewo+PiBAQCAtMTUzMyw2ICsxNjM2LDggQEAgc3RhdGljIHNzaXplX3Qg
YW1kZ3B1X3NldF9wcF9zY2xrX29kKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQl9Cj4+ICAg
IAl9Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCXBt
X3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0
X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+ICAgIAo+PiBAQCAtMTU0OCw3ICsxNjUzLDcgQEAg
c3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9tY2xrX29kKHN0cnVjdCBkZXZpY2UgKmRldiwK
Pj4gICAgCXVpbnQzMl90IHZhbHVlID0gMDsKPj4gICAgCWludCByZXQ7Cj4+ICAgIAo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJcmV0ID0gcG1fcnVu
dGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtMTU1NywxMSArMTY2MiwxNSBAQCBzdGF0
aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX21jbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LAo+PiAg
ICAJCXJldHVybiByZXQ7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsKPj4gKwo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+PiAgICAJ
CXZhbHVlID0gc211X2dldF9vZF9wZXJjZW50YWdlKCYoYWRldi0+c211KSwgU01VX09EX01DTEsp
Owo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfbWNsa19vZCkK
Pj4gICAgCQl2YWx1ZSA9IGFtZGdwdV9kcG1fZ2V0X21jbGtfb2QoYWRldik7Cj4+ICAgIAo+PiAr
CXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFya19s
YXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRk
ZXYtPmRldik7Cj4+ICAgIAo+PiBAQCAtMTU3OCw3ICsxNjg3LDcgQEAgc3RhdGljIHNzaXplX3Qg
YW1kZ3B1X3NldF9wcF9tY2xrX29kKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCWludCByZXQ7
Cj4+ICAgIAlsb25nIGludCB2YWx1ZTsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNl
dCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0
dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAgIAlyZXQgPSBrc3RydG9sKGJ1ZiwgMCwgJnZhbHVlKTsK
Pj4gQEAgLTE1OTIsNiArMTcwMSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfbWNs
a19vZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIHJldDsKPj4gICAgCX0KPj4g
ICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlpZiAoaXNf
c3VwcG9ydF9zd19zbXUoYWRldikpIHsKPj4gICAgCQl2YWx1ZSA9IHNtdV9zZXRfb2RfcGVyY2Vu
dGFnZSgmKGFkZXYtPnNtdSksIFNNVV9PRF9NQ0xLLCAodWludDMyX3QpdmFsdWUpOwo+PiAgICAJ
fSBlbHNlIHsKPj4gQEAgLTE2MDYsNiArMTcxNyw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9z
ZXRfcHBfbWNsa19vZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJfQo+PiAgICAJfQo+PiAg
ICAKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1l
X21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3Vz
cGVuZChkZGV2LT5kZXYpOwo+PiAgICAKPj4gQEAgLTE2NDEsNyArMTc1NCw3IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9nZXRfcHBfcG93ZXJfcHJvZmlsZV9tb2RlKHN0cnVjdCBkZXZpY2UgKmRl
diwKPj4gICAgCXNzaXplX3Qgc2l6ZTsKPj4gICAgCWludCByZXQ7Cj4+ICAgIAo+PiAtCWlmIChh
ZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVz
ZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJcmV0ID0gcG1fcnVudGlt
ZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+PiBAQCAtMTY1MCw2ICsxNzYzLDggQEAgc3RhdGljIHNz
aXplX3QgYW1kZ3B1X2dldF9wcF9wb3dlcl9wcm9maWxlX21vZGUoc3RydWN0IGRldmljZSAqZGV2
LAo+PiAgICAJCXJldHVybiByZXQ7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+
PiAgICAJCXNpemUgPSBzbXVfZ2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZSgmYWRldi0+c211LCBidWYp
Owo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfcG93ZXJfcHJv
ZmlsZV9tb2RlKQo+PiBAQCAtMTY1Nyw2ICsxNzcyLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2dldF9wcF9wb3dlcl9wcm9maWxlX21vZGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJZWxz
ZQo+PiAgICAJCXNpemUgPSBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIlxuIik7Cj4+ICAgIAo+
PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFy
a19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5k
KGRkZXYtPmRldik7Cj4+ICAgIAo+PiBAQCAtMTY4MSw3ICsxNzk4LDcgQEAgc3RhdGljIHNzaXpl
X3QgYW1kZ3B1X3NldF9wcF9wb3dlcl9wcm9maWxlX21vZGUoc3RydWN0IGRldmljZSAqZGV2LAo+
PiAgICAJbG9uZyBpbnQgcHJvZmlsZV9tb2RlID0gMDsKPj4gICAgCWNvbnN0IGNoYXIgZGVsaW1p
dGVyWzNdID0geycgJywgJ1xuJywgJ1wwJ307Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVf
cmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJ
CXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJdG1wWzBdID0gKihidWYpOwo+PiBAQCAtMTcx
NSwxMSArMTgzMiwxNSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX3Bvd2VyX3Byb2Zp
bGVfbW9kZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIHJldDsKPj4gICAgCX0K
Pj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlpZiAo
aXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAgIAkJcmV0ID0gc211X3NldF9wb3dlcl9wcm9m
aWxlX21vZGUoJmFkZXYtPnNtdSwgcGFyYW1ldGVyLCBwYXJhbWV0ZXJfc2l6ZSwgdHJ1ZSk7Cj4+
ICAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPnNldF9wb3dlcl9wcm9maWxl
X21vZGUpCj4+ICAgIAkJcmV0ID0gYW1kZ3B1X2RwbV9zZXRfcG93ZXJfcHJvZmlsZV9tb2RlKGFk
ZXYsIHBhcmFtZXRlciwgcGFyYW1ldGVyX3NpemUpOwo+PiAgICAKPj4gKwl1cF9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYt
PmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+PiAg
ICAKPj4gQEAgLTE3NDUsNyArMTg2Niw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfZ3B1
X2J1c3lfcGVyY2VudChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAlzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldiA9IGRkZXYtPmRldl9wcml2YXRlOwo+PiAgICAJaW50IHIsIHZhbHVlLCBzaXpl
ID0gc2l6ZW9mKHZhbHVlKTsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4g
KwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1F
UEVSTTsKPj4gICAgCj4+ICAgIAlyID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+
PiBAQCAtMTc1NCw5ICsxODc1LDExIEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfZ3B1X2J1
c3lfcGVyY2VudChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIHI7Cj4+ICAgIAl9
Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAgCS8qIHJlYWQg
dGhlIElQIGJ1c3kgc2Vuc29yICovCj4+ICAgIAlyID0gYW1kZ3B1X2RwbV9yZWFkX3NlbnNvcihh
ZGV2LCBBTURHUFVfUFBfU0VOU09SX0dQVV9MT0FELAo+PiAgICAJCQkJICAgKHZvaWQgKikmdmFs
dWUsICZzaXplKTsKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAKPj4gICAg
CXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVf
cHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4+IEBAIC0xNzgzLDcgKzE5MDYsNyBAQCBzdGF0
aWMgc3NpemVfdCBhbWRncHVfZ2V0X21lbV9idXN5X3BlcmNlbnQoc3RydWN0IGRldmljZSAqZGV2
LAo+PiAgICAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBkZGV2LT5kZXZfcHJpdmF0ZTsK
Pj4gICAgCWludCByLCB2YWx1ZSwgc2l6ZSA9IHNpemVvZih2YWx1ZSk7Cj4+ICAgIAo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJciA9IHBtX3J1bnRp
bWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsKPj4gQEAgLTE3OTIsMTAgKzE5MTUsMTQgQEAgc3RhdGlj
IHNzaXplX3QgYW1kZ3B1X2dldF9tZW1fYnVzeV9wZXJjZW50KHN0cnVjdCBkZXZpY2UgKmRldiwK
Pj4gICAgCQlyZXR1cm4gcjsKPj4gICAgCX0KPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5y
ZXNldF9zZW0pOwo+PiArCj4+ICAgIAkvKiByZWFkIHRoZSBJUCBidXN5IHNlbnNvciAqLwo+PiAg
ICAJciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9NRU1f
TE9BRCwKPj4gICAgCQkJCSAgICh2b2lkICopJnZhbHVlLCAmc2l6ZSk7Cj4+ICAgIAo+PiArCXVw
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0
X2J1c3koZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYt
PmRldik7Cj4+ICAgIAo+PiBAQCAtMTgyNiw3ICsxOTUzLDcgQEAgc3RhdGljIHNzaXplX3QgYW1k
Z3B1X2dldF9wY2llX2J3KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCXVpbnQ2NF90IGNvdW50
MCA9IDAsIGNvdW50MSA9IDA7Cj4+ICAgIAlpbnQgcmV0Owo+PiAgICAKPj4gLQlpZiAoYWRldi0+
aW5fZ3B1X3Jlc2V0KQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkK
Pj4gICAgCQlyZXR1cm4gLUVQRVJNOwo+PiAgICAKPj4gICAgCWlmIChhZGV2LT5mbGFncyAmIEFN
RF9JU19BUFUpCj4+IEBAIC0xODQxLDggKzE5NjgsMTIgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2dldF9wY2llX2J3KHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQlyZXR1cm4gcmV0Owo+PiAg
ICAJfQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAg
CWFtZGdwdV9hc2ljX2dldF9wY2llX3VzYWdlKGFkZXYsICZjb3VudDAsICZjb3VudDEpOwo+PiAg
ICAKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1l
X21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3Vz
cGVuZChkZGV2LT5kZXYpOwo+PiAgICAKPj4gQEAgLTE4NjcsNyArMTk5OCw3IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9nZXRfdW5pcXVlX2lkKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCXN0
cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4+ICAgIAlzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGRkZXYtPmRldl9wcml2YXRlOwo+PiAgICAKPj4gLQlp
ZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1
X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVQRVJNOwo+PiAgICAKPj4gICAgCWlmIChhZGV2LT51
bmlxdWVfaWQpCj4+IEBAIC0yMTM0LDcgKzIyNjUsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVf
aHdtb25fc2hvd190ZW1wKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCWludCBjaGFubmVsID0g
dG9fc2Vuc29yX2Rldl9hdHRyKGF0dHIpLT5pbmRleDsKPj4gICAgCWludCByLCB0ZW1wID0gMCwg
c2l6ZSA9IHNpemVvZih0ZW1wKTsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkK
Pj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJu
IC1FUEVSTTsKPj4gICAgCj4+ICAgIAlpZiAoY2hhbm5lbCA+PSBQUF9URU1QX01BWCkKPj4gQEAg
LTIxNDYsNiArMjI3Nyw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93X3RlbXAo
c3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJCXJldHVybiByOwo+PiAgICAJfQo+PiAgICAKPj4g
Kwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCXN3aXRjaCAoY2hhbm5l
bCkgewo+PiAgICAJY2FzZSBQUF9URU1QX0pVTkNUSU9OOgo+PiAgICAJCS8qIGdldCBjdXJyZW50
IGp1bmN0aW9uIHRlbXBlcmF0dXJlICovCj4+IEBAIC0yMTY3LDYgKzIzMDAsOCBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfaHdtb25fc2hvd190ZW1wKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAg
CQlicmVhazsKPj4gICAgCX0KPj4gICAgCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsK
Pj4gKwo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+
PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPj4gICAg
Cj4+IEBAIC0yMjcwLDcgKzI0MDUsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0
X3B3bTFfZW5hYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCXUzMiBwd21fbW9kZSA9IDA7
Cj4+ICAgIAlpbnQgcmV0Owo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiAr
CWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVQ
RVJNOwo+PiAgICAKPj4gICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+
ZGV2KTsKPj4gQEAgLTIyNzksMTggKzI0MTQsMjMgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3
bW9uX2dldF9wd20xX2VuYWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIHJl
dDsKPj4gICAgCX0KPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAr
Cj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsKPj4gICAgCQlwd21fbW9kZSA9
IHNtdV9nZXRfZmFuX2NvbnRyb2xfbW9kZSgmYWRldi0+c211KTsKPj4gICAgCX0gZWxzZSB7Cj4+
ICAgIAkJaWYgKCFhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9mYW5fY29udHJvbF9tb2Rl
KSB7Cj4+ICAgIAkJCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsK
Pj4gICAgCQkJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPj4g
KwkJCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICAgIAkJCXJldHVybiAtRUlOVkFMOwo+
PiAgICAJCX0KPj4gICAgCj4+ICAgIAkJcHdtX21vZGUgPSBhbWRncHVfZHBtX2dldF9mYW5fY29u
dHJvbF9tb2RlKGFkZXYpOwo+PiAgICAJfQo+PiAgICAKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYt
PmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYp
Owo+PiAgICAKPj4gQEAgLTIzMDYsNyArMjQ0Niw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9o
d21vbl9zZXRfcHdtMV9lbmFibGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJaW50IGVyciwg
cmV0Owo+PiAgICAJaW50IHZhbHVlOwo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0
KQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1
cm4gLUVQRVJNOwo+PiAgICAKPj4gICAgCWVyciA9IGtzdHJ0b2ludChidWYsIDEwLCAmdmFsdWUp
Owo+PiBAQCAtMjMxOSwxOCArMjQ1OSwyMyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25f
c2V0X3B3bTFfZW5hYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQlyZXR1cm4gcmV0Owo+
PiAgICAJfQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4g
ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+PiAgICAJCXNtdV9zZXRfZmFuX2Nv
bnRyb2xfbW9kZSgmYWRldi0+c211LCB2YWx1ZSk7Cj4+ICAgIAl9IGVsc2Ugewo+PiAgICAJCWlm
ICghYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5zZXRfZmFuX2NvbnRyb2xfbW9kZSkgewo+PiAg
ICAJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgIAkJ
CXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+ICsJCQl1cF9y
ZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAJCQlyZXR1cm4gLUVJTlZBTDsKPj4gICAgCQl9
Cj4+ICAgIAo+PiAgICAJCWFtZGdwdV9kcG1fc2V0X2Zhbl9jb250cm9sX21vZGUoYWRldiwgdmFs
dWUpOwo+PiAgICAJfQo+PiAgICAKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAr
Cj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAg
IAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+PiAgICAKPj4g
QEAgLTIzNjAsNyArMjUwNSw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zZXRfcHdt
MShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAl1MzIgdmFsdWU7Cj4+ICAgIAl1MzIgcHdtX21v
ZGU7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19y
ZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+
PiAgICAJZXJyID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOwo+PiBAQCAt
MjM2OSwxMSArMjUxNCwxNSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2V0X3B3bTEo
c3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJCXJldHVybiBlcnI7Cj4+ICAgIAl9Cj4+ICAgIAo+
PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJaWYgKGlzX3N1cHBv
cnRfc3dfc211KGFkZXYpKQo+PiAgICAJCXB3bV9tb2RlID0gc211X2dldF9mYW5fY29udHJvbF9t
b2RlKCZhZGV2LT5zbXUpOwo+PiAgICAJZWxzZQo+PiAgICAJCXB3bV9tb2RlID0gYW1kZ3B1X2Rw
bV9nZXRfZmFuX2NvbnRyb2xfbW9kZShhZGV2KTsKPj4gICAgCj4+ICsJdXBfcmVhZCgmYWRldi0+
cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJaWYgKHB3bV9tb2RlICE9IEFNRF9GQU5fQ1RSTF9NQU5V
QUwpIHsKPj4gICAgCQlwcl9pbmZvKCJtYW51YWwgZmFuIHNwZWVkIGNvbnRyb2wgc2hvdWxkIGJl
IGVuYWJsZWQgZmlyc3RcbiIpOwo+PiAgICAJCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRl
di0+ZGRldi0+ZGV2KTsKPj4gQEAgLTI0MTQsNyArMjU2Myw3IEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9od21vbl9nZXRfcHdtMShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAlpbnQgZXJyOwo+
PiAgICAJdTMyIHNwZWVkID0gMDsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkK
Pj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJu
IC1FUEVSTTsKPj4gICAgCj4+ICAgIAllcnIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRk
ZXYtPmRldik7Cj4+IEBAIC0yNDIzLDYgKzI1NzIsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVf
aHdtb25fZ2V0X3B3bTEoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJCXJldHVybiBlcnI7Cj4+
ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+PiAg
ICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+PiAgICAJCWVyciA9IHNtdV9nZXRfZmFu
X3NwZWVkX3BlcmNlbnQoJmFkZXYtPnNtdSwgJnNwZWVkKTsKPj4gICAgCWVsc2UgaWYgKGFkZXYt
PnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0X2Zhbl9zcGVlZF9wZXJjZW50KQo+PiBAQCAtMjQzMCw2
ICsyNTgxLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dldF9wd20xKHN0cnVjdCBk
ZXZpY2UgKmRldiwKPj4gICAgCWVsc2UKPj4gICAgCQllcnIgPSAtRUlOVkFMOwo+PiAgICAKPj4g
Kwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX21hcmtf
bGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3Vz
cGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+PiAgICAKPj4gQEAgLTI0NDksNyArMjYwMiw3IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfZmFuMV9pbnB1dChzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4+ICAgIAlpbnQgZXJyOwo+PiAgICAJdTMyIHNwZWVkID0gMDsKPj4gICAgCj4+IC0JaWYg
KGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9y
ZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAgIAllcnIgPSBwbV9ydW50
aW1lX2dldF9zeW5jKGFkZXYtPmRkZXYtPmRldik7Cj4+IEBAIC0yNDU4LDYgKzI2MTEsOCBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X2ZhbjFfaW5wdXQoc3RydWN0IGRldmljZSAq
ZGV2LAo+PiAgICAJCXJldHVybiBlcnI7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYp
KQo+PiAgICAJCWVyciA9IHNtdV9nZXRfZmFuX3NwZWVkX3JwbSgmYWRldi0+c211LCAmc3BlZWQp
Owo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfZmFuX3NwZWVk
X3JwbSkKPj4gQEAgLTI0NjUsNiArMjYyMCw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21v
bl9nZXRfZmFuMV9pbnB1dChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAllbHNlCj4+ICAgIAkJ
ZXJyID0gLUVJTlZBTDsKPj4gICAgCj4+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4g
Kwo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+PiAg
ICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPj4gICAgCj4+
IEBAIC0yNDgzLDcgKzI2NDAsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X2Zh
bjFfbWluKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCXUzMiBzaXplID0gc2l6ZW9mKG1pbl9y
cG0pOwo+PiAgICAJaW50IHI7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+
ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAt
RVBFUk07Cj4+ICAgIAo+PiAgICAJciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+
ZGV2KTsKPj4gQEAgLTI0OTIsOSArMjY0OSwxMyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdt
b25fZ2V0X2ZhbjFfbWluKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQlyZXR1cm4gcjsKPj4g
ICAgCX0KPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAg
IAlyID0gYW1kZ3B1X2RwbV9yZWFkX3NlbnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX01JTl9G
QU5fUlBNLAo+PiAgICAJCQkJICAgKHZvaWQgKikmbWluX3JwbSwgJnNpemUpOwo+PiAgICAKPj4g
Kwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX21hcmtf
bGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3Vz
cGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+PiAgICAKPj4gQEAgLTI1MTMsNyArMjY3NCw3IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfZmFuMV9tYXgoc3RydWN0IGRldmljZSAqZGV2
LAo+PiAgICAJdTMyIHNpemUgPSBzaXplb2YobWF4X3JwbSk7Cj4+ICAgIAlpbnQgcjsKPj4gICAg
Cj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYt
PmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAgIAlyID0g
cG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOwo+PiBAQCAtMjUyMiw5ICsyNjgz
LDEzIEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfZmFuMV9tYXgoc3RydWN0IGRl
dmljZSAqZGV2LAo+PiAgICAJCXJldHVybiByOwo+PiAgICAJfQo+PiAgICAKPj4gKwlkb3duX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCXIgPSBhbWRncHVfZHBtX3JlYWRfc2Vu
c29yKGFkZXYsIEFNREdQVV9QUF9TRU5TT1JfTUFYX0ZBTl9SUE0sCj4+ICAgIAkJCQkgICAodm9p
ZCAqKSZtYXhfcnBtLCAmc2l6ZSk7Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3Nl
bSk7Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2
KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+
ICAgIAo+PiBAQCAtMjU0Miw3ICsyNzA3LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9u
X2dldF9mYW4xX3RhcmdldChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAlpbnQgZXJyOwo+PiAg
ICAJdTMyIHJwbSA9IDA7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJ
aWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBF
Uk07Cj4+ICAgIAo+PiAgICAJZXJyID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5k
ZXYpOwo+PiBAQCAtMjU1MSw2ICsyNzE2LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9u
X2dldF9mYW4xX3RhcmdldChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIGVycjsK
Pj4gICAgCX0KPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiArCj4+
ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4+ICAgIAkJZXJyID0gc211X2dldF9m
YW5fc3BlZWRfcnBtKCZhZGV2LT5zbXUsICZycG0pOwo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93
ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfZmFuX3NwZWVkX3JwbSkKPj4gQEAgLTI1NTgsNiArMjcyNSw4
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfZmFuMV90YXJnZXQoc3RydWN0IGRl
dmljZSAqZGV2LAo+PiAgICAJZWxzZQo+PiAgICAJCWVyciA9IC1FSU5WQUw7Cj4+ICAgIAo+PiAr
CXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFya19s
YXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNw
ZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgIAo+PiBAQCAtMjU3Niw3ICsyNzQ1LDcgQEAgc3Rh
dGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9mYW4xX3RhcmdldChzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4+ICAgIAl1MzIgdmFsdWU7Cj4+ICAgIAl1MzIgcHdtX21vZGU7Cj4+ICAgIAo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJZXJyID0gcG1fcnVu
dGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOwo+PiBAQCAtMjU4NSwxMSArMjc1NCwxNSBA
QCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2V0X2ZhbjFfdGFyZ2V0KHN0cnVjdCBkZXZp
Y2UgKmRldiwKPj4gICAgCQlyZXR1cm4gZXJyOwo+PiAgICAJfQo+PiAgICAKPj4gKwlkb3duX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShh
ZGV2KSkKPj4gICAgCQlwd21fbW9kZSA9IHNtdV9nZXRfZmFuX2NvbnRyb2xfbW9kZSgmYWRldi0+
c211KTsKPj4gICAgCWVsc2UKPj4gICAgCQlwd21fbW9kZSA9IGFtZGdwdV9kcG1fZ2V0X2Zhbl9j
b250cm9sX21vZGUoYWRldik7Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7
Cj4+ICsKPj4gICAgCWlmIChwd21fbW9kZSAhPSBBTURfRkFOX0NUUkxfTUFOVUFMKSB7Cj4+ICAg
IAkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+PiAgICAJCXBt
X3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+IEBAIC0yNjAzLDYg
KzI3NzYsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2V0X2ZhbjFfdGFyZ2V0KHN0
cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCQlyZXR1cm4gZXJyOwo+PiAgICAJfQo+PiAgICAKPj4g
Kwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCWlmIChpc19zdXBwb3J0
X3N3X3NtdShhZGV2KSkKPj4gICAgCQllcnIgPSBzbXVfc2V0X2Zhbl9zcGVlZF9ycG0oJmFkZXYt
PnNtdSwgdmFsdWUpOwo+PiAgICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5z
ZXRfZmFuX3NwZWVkX3JwbSkKPj4gQEAgLTI2MTAsNiArMjc4NSw4IEBAIHN0YXRpYyBzc2l6ZV90
IGFtZGdwdV9od21vbl9zZXRfZmFuMV90YXJnZXQoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJ
ZWxzZQo+PiAgICAJCWVyciA9IC1FSU5WQUw7Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJl
c2V0X3NlbSk7Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRl
di0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRl
dik7Cj4+ICAgIAo+PiBAQCAtMjYyNyw3ICsyODA0LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2h3bW9uX2dldF9mYW4xX2VuYWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAl1MzIgcHdt
X21vZGUgPSAwOwo+PiAgICAJaW50IHJldDsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9y
ZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+ICAgIAkJ
cmV0dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAgIAlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFk
ZXYtPmRkZXYtPmRldik7Cj4+IEBAIC0yNjM2LDE4ICsyODEzLDIzIEBAIHN0YXRpYyBzc2l6ZV90
IGFtZGdwdV9od21vbl9nZXRfZmFuMV9lbmFibGUoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJ
CXJldHVybiByZXQ7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPj4gKwo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7Cj4+ICAgIAkJ
cHdtX21vZGUgPSBzbXVfZ2V0X2Zhbl9jb250cm9sX21vZGUoJmFkZXYtPnNtdSk7Cj4+ICAgIAl9
IGVsc2Ugewo+PiAgICAJCWlmICghYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfZmFuX2Nv
bnRyb2xfbW9kZSkgewo+PiAgICAJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRk
ZXYtPmRldik7Cj4+ICAgIAkJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYt
PmRldik7Cj4+ICsJCQl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAJCQlyZXR1cm4g
LUVJTlZBTDsKPj4gICAgCQl9Cj4+ICAgIAo+PiAgICAJCXB3bV9tb2RlID0gYW1kZ3B1X2RwbV9n
ZXRfZmFuX2NvbnRyb2xfbW9kZShhZGV2KTsKPj4gICAgCX0KPj4gICAgCj4+ICsJdXBfcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShh
ZGV2LT5kZGV2LT5kZXYpOwo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+
ZGRldi0+ZGV2KTsKPj4gICAgCj4+IEBAIC0yNjY0LDcgKzI4NDYsNyBAQCBzdGF0aWMgc3NpemVf
dCBhbWRncHVfaHdtb25fc2V0X2ZhbjFfZW5hYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAg
CWludCB2YWx1ZTsKPj4gICAgCXUzMiBwd21fbW9kZTsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmlu
X2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+
ICAgIAkJcmV0dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAgIAllcnIgPSBrc3RydG9pbnQoYnVmLCAx
MCwgJnZhbHVlKTsKPj4gQEAgLTI2ODQsMTcgKzI4NjYsMjIgQEAgc3RhdGljIHNzaXplX3QgYW1k
Z3B1X2h3bW9uX3NldF9mYW4xX2VuYWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0
dXJuIGVycjsKPj4gICAgCX0KPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Owo+PiArCj4+ICAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsKPj4gICAgCQlzbXVf
c2V0X2Zhbl9jb250cm9sX21vZGUoJmFkZXYtPnNtdSwgcHdtX21vZGUpOwo+PiAgICAJfSBlbHNl
IHsKPj4gICAgCQlpZiAoIWFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+c2V0X2Zhbl9jb250cm9s
X21vZGUpIHsKPj4gICAgCQkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5k
ZXYpOwo+PiAgICAJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYp
Owo+PiArCQkJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAgCQkJcmV0dXJuIC1FSU5W
QUw7Cj4+ICAgIAkJfQo+PiAgICAJCWFtZGdwdV9kcG1fc2V0X2Zhbl9jb250cm9sX21vZGUoYWRl
diwgcHdtX21vZGUpOwo+PiAgICAJfQo+PiAgICAKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9z
ZW0pOwo+PiArCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRl
dik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+
PiAgICAKPj4gQEAgLTI3MDksNyArMjg5Niw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21v
bl9zaG93X3ZkZGdmeChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAl1MzIgdmRkZ2Z4Owo+PiAg
ICAJaW50IHIsIHNpemUgPSBzaXplb2YodmRkZ2Z4KTsKPj4gICAgCj4+IC0JaWYgKGFkZXYtPmlu
X2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4+
ICAgIAkJcmV0dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAgIAlyID0gcG1fcnVudGltZV9nZXRfc3lu
YyhhZGV2LT5kZGV2LT5kZXYpOwo+PiBAQCAtMjcxOCw5ICsyOTA1LDExIEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9od21vbl9zaG93X3ZkZGdmeChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJ
cmV0dXJuIHI7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2Vt
KTsKPj4gICAgCS8qIGdldCB0aGUgdm9sdGFnZSAqLwo+PiAgICAJciA9IGFtZGdwdV9kcG1fcmVh
ZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9WRERHRlgsCj4+ICAgIAkJCQkgICAodm9p
ZCAqKSZ2ZGRnZngsICZzaXplKTsKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAg
ICAKPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsKPj4g
ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+IEBAIC0y
NzQ2LDcgKzI5MzUsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd192ZGRuYihz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAl1MzIgdmRkbmI7Cj4+ICAgIAlpbnQgciwgc2l6ZSA9
IHNpemVvZih2ZGRuYik7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJ
aWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBF
Uk07Cj4+ICAgIAo+PiAgICAJLyogb25seSBBUFVzIGhhdmUgdmRkbmIgKi8KPj4gQEAgLTI3NTks
OSArMjk0OCwxMSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd192ZGRuYihzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIHI7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRv
d25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAgCS8qIGdldCB0aGUgdm9sdGFnZSAqLwo+
PiAgICAJciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9W
REROQiwKPj4gICAgCQkJCSAgICh2b2lkICopJnZkZG5iLCAmc2l6ZSk7Cj4+ICsJdXBfcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsKPj4gICAgCj4+ICAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2
LT5kZGV2LT5kZXYpOwo+PiBAQCAtMjc4OCw3ICsyOTc5LDcgQEAgc3RhdGljIHNzaXplX3QgYW1k
Z3B1X2h3bW9uX3Nob3dfcG93ZXJfYXZnKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCWludCBy
LCBzaXplID0gc2l6ZW9mKHUzMik7Cj4+ICAgIAl1bnNpZ25lZCB1dzsKPj4gICAgCj4+IC0JaWYg
KGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9y
ZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAgIAlyID0gcG1fcnVudGlt
ZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOwo+PiBAQCAtMjc5Nyw5ICsyOTg4LDExIEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93X3Bvd2VyX2F2ZyhzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4+ICAgIAkJcmV0dXJuIHI7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPj4gICAgCS8qIGdldCB0aGUgdm9sdGFnZSAqLwo+PiAgICAJciA9IGFt
ZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9HUFVfUE9XRVIsCj4+
ICAgIAkJCQkgICAodm9pZCAqKSZxdWVyeSwgJnNpemUpOwo+PiArCXVwX3JlYWQoJmFkZXYtPnJl
c2V0X3NlbSk7Cj4+ICAgIAo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5k
ZGV2LT5kZXYpOwo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+
ZGV2KTsKPj4gQEAgLTI4MjksNyArMzAyMiw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21v
bl9zaG93X3Bvd2VyX2NhcF9tYXgoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJc3NpemVfdCBz
aXplOwo+PiAgICAJaW50IHI7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+
ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAt
RVBFUk07Cj4+ICAgIAo+PiAgICAJciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+
ZGV2KTsKPj4gQEAgLTI4MzgsNiArMzAzMSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21v
bl9zaG93X3Bvd2VyX2NhcF9tYXgoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJCXJldHVybiBy
Owo+PiAgICAJfQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsK
Pj4gICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+PiAgICAJCXNtdV9nZXRfcG93
ZXJfbGltaXQoJmFkZXYtPnNtdSwgJmxpbWl0LCB0cnVlKTsKPj4gICAgCQlzaXplID0gc25wcmlu
dGYoYnVmLCBQQUdFX1NJWkUsICIldVxuIiwgbGltaXQgKiAxMDAwMDAwKTsKPj4gQEAgLTI4NDgs
NiArMzA0Myw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93X3Bvd2VyX2NhcF9t
YXgoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJCXNpemUgPSBzbnByaW50ZihidWYsIFBBR0Vf
U0laRSwgIlxuIik7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3Nl
bSk7Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2
KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+
ICAgIAo+PiBAQCAtMjg2Myw3ICszMDYwLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9u
X3Nob3dfcG93ZXJfY2FwKHN0cnVjdCBkZXZpY2UgKmRldiwKPj4gICAgCXNzaXplX3Qgc2l6ZTsK
Pj4gICAgCWludCByOwo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlm
IChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVQRVJN
Owo+PiAgICAKPj4gICAgCXIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRkZXYtPmRldik7
Cj4+IEBAIC0yODcyLDYgKzMwNjksOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hv
d19wb3dlcl9jYXAoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJCXJldHVybiByOwo+PiAgICAJ
fQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCWlm
IChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+PiAgICAJCXNtdV9nZXRfcG93ZXJfbGltaXQo
JmFkZXYtPnNtdSwgJmxpbWl0LCBmYWxzZSk7Cj4+ICAgIAkJc2l6ZSA9IHNucHJpbnRmKGJ1Ziwg
UEFHRV9TSVpFLCAiJXVcbiIsIGxpbWl0ICogMTAwMDAwMCk7Cj4+IEBAIC0yODgyLDYgKzMwODEs
OCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19wb3dlcl9jYXAoc3RydWN0IGRl
dmljZSAqZGV2LAo+PiAgICAJCXNpemUgPSBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIlxuIik7
Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4g
ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsKPj4gICAgCXBt
X3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+ICAgIAo+PiBAQCAt
Mjg5OCw3ICszMDk5LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9wb3dlcl9j
YXAoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJaW50IGVycjsKPj4gICAgCXUzMiB2YWx1ZTsK
Pj4gICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlpZiAoYXRvbWljX3JlYWQo
JmFkZXYtPmluX2dwdV9yZXNldCkpCj4+ICAgIAkJcmV0dXJuIC1FUEVSTTsKPj4gICAgCj4+ICAg
IAlpZiAoYW1kZ3B1X3NyaW92X3ZmKGFkZXYpKQo+PiBAQCAtMjkxNyw2ICszMTE4LDggQEAgc3Rh
dGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9wb3dlcl9jYXAoc3RydWN0IGRldmljZSAqZGV2
LAo+PiAgICAJCXJldHVybiBlcnI7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPj4gKwo+PiAgICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+
PiAgICAJCWVyciA9IHNtdV9zZXRfcG93ZXJfbGltaXQoJmFkZXYtPnNtdSwgdmFsdWUpOwo+PiAg
ICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzICYmIGFkZXYtPnBvd2VycGxheS5w
cF9mdW5jcy0+c2V0X3Bvd2VyX2xpbWl0KQo+PiBAQCAtMjkyNCw2ICszMTI3LDggQEAgc3RhdGlj
IHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9wb3dlcl9jYXAoc3RydWN0IGRldmljZSAqZGV2LAo+
PiAgICAJZWxzZQo+PiAgICAJCWVyciA9IC1FSU5WQUw7Cj4+ICAgIAo+PiArCXVwX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7Cj4+ICsKPj4gICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRl
di0+ZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRk
ZXYtPmRldik7Cj4+ICAgIAo+PiBAQCAtMjk0MSw3ICszMTQ2LDcgQEAgc3RhdGljIHNzaXplX3Qg
YW1kZ3B1X2h3bW9uX3Nob3dfc2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAl1aW50MzJf
dCBzY2xrOwo+PiAgICAJaW50IHIsIHNpemUgPSBzaXplb2Yoc2Nsayk7Cj4+ICAgIAo+PiAtCWlm
IChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKQo+PiAgICAJCXJldHVybiAtRVBFUk07Cj4+ICAgIAo+PiAgICAJciA9IHBtX3J1bnRp
bWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsKPj4gQEAgLTI5NTAsOSArMzE1NSwxMSBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19zY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwK
Pj4gICAgCQlyZXR1cm4gcjsKPj4gICAgCX0KPj4gICAgCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5y
ZXNldF9zZW0pOwo+PiAgICAJLyogZ2V0IHRoZSBzY2xrICovCj4+ICAgIAlyID0gYW1kZ3B1X2Rw
bV9yZWFkX3NlbnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX0dGWF9TQ0xLLAo+PiAgICAJCQkJ
ICAgKHZvaWQgKikmc2NsaywgJnNpemUpOwo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7
Cj4+ICAgIAo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYp
Owo+PiAgICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPj4g
QEAgLTI5NzgsNyArMzE4NSw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93X21j
bGsoc3RydWN0IGRldmljZSAqZGV2LAo+PiAgICAJdWludDMyX3QgbWNsazsKPj4gICAgCWludCBy
LCBzaXplID0gc2l6ZW9mKG1jbGspOwo+PiAgICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0
KQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1
cm4gLUVQRVJNOwo+PiAgICAKPj4gICAgCXIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRk
ZXYtPmRldik7Cj4+IEBAIC0yOTg3LDkgKzMxOTQsMTEgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2h3bW9uX3Nob3dfbWNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4+ICAgIAkJcmV0dXJuIHI7Cj4+
ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAgCS8q
IGdldCB0aGUgc2NsayAqLwo+PiAgICAJciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwg
QU1ER1BVX1BQX1NFTlNPUl9HRlhfTUNMSywKPj4gICAgCQkJCSAgICh2b2lkICopJm1jbGssICZz
aXplKTsKPj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAKPj4gICAgCXBtX3J1
bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+ZGV2KTsKPj4gICAgCXBtX3J1bnRpbWVf
cHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4+IEBAIC0zODcwLDcgKzQwNzksNyBA
QCBzdGF0aWMgaW50IGFtZGdwdV9kZWJ1Z2ZzX3BtX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICpkYXRhKQo+PiAgICAJdTMyIGZsYWdzID0gMDsKPj4gICAgCWludCByOwo+PiAgICAKPj4g
LQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5f
Z3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVQRVJNOwo+PiAgICAKPj4gICAgCXIgPSBwbV9y
dW50aW1lX2dldF9zeW5jKGRldi0+ZGV2KTsKPj4gQEAgLTM4NzksNyArNDA4OCwxMCBAQCBzdGF0
aWMgaW50IGFtZGdwdV9kZWJ1Z2ZzX3BtX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpk
YXRhKQo+PiAgICAJCXJldHVybiByOwo+PiAgICAJfQo+PiAgICAKPj4gKwlkb3duX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7Cj4+ICAgIAlhbWRncHVfZGV2aWNlX2lwX2dldF9jbG9ja2dhdGluZ19z
dGF0ZShhZGV2LCAmZmxhZ3MpOwo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICsK
Pj4gICAgCXNlcV9wcmludGYobSwgIkNsb2NrIEdhdGluZyBGbGFncyBNYXNrOiAweCV4XG4iLCBm
bGFncyk7Cj4+ICAgIAlhbWRncHVfcGFyc2VfY2dfc3RhdGUobSwgZmxhZ3MpOwo+PiAgICAJc2Vx
X3ByaW50ZihtLCAiXG4iKTsKPj4gQEAgLTM4OTEsNiArNDEwMyw3IEBAIHN0YXRpYyBpbnQgYW1k
Z3B1X2RlYnVnZnNfcG1faW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4+ICAg
IAkJcmV0dXJuIDA7Cj4+ICAgIAl9Cj4+ICAgIAo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPj4gICAgCWlmICghaXNfc3VwcG9ydF9zd19zbXUoYWRldikgJiYKPj4gICAgCSAgICBh
ZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmRlYnVnZnNfcHJpbnRfY3VycmVudF9wZXJmb3JtYW5j
ZV9sZXZlbCkgewo+PiAgICAJCW11dGV4X2xvY2soJmFkZXYtPnBtLm11dGV4KTsKPj4gQEAgLTM5
MDMsNiArNDExNiw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RlYnVnZnNfcG1faW5mbyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4+ICAgIAl9IGVsc2Ugewo+PiAgICAJCXIgPSBhbWRn
cHVfZGVidWdmc19wbV9pbmZvX3BwKG0sIGFkZXYpOwo+PiAgICAJfQo+PiArCXVwX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7Cj4+ICAgIAo+PiAgICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShk
ZXYtPmRldik7Cj4+ICAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZXYtPmRldik7Cj4+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcHNwLmMgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcHNwLmMKPj4gaW5kZXggZTIwNjk1YjQ0
ZGJlLi5hYjA4ODNlZWFkYjMgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9wc3AuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfcHNwLmMKPj4gQEAgLTE2ODIsNyArMTY4Miw3IEBAIHN0YXRpYyBpbnQgcHNwX2xvYWRfc211
X2Z3KHN0cnVjdCBwc3BfY29udGV4dCAqcHNwKQo+PiAgICAJCXJldHVybiAwOwo+PiAgICAKPj4g
ICAgCj4+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCAmJiByYXMgJiYgcmFzLT5zdXBwb3J0ZWQp
IHsKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkgJiYgcmFzICYmIHJh
cy0+c3VwcG9ydGVkKSB7Cj4+ICAgIAkJcmV0ID0gYW1kZ3B1X2RwbV9zZXRfbXAxX3N0YXRlKGFk
ZXYsIFBQX01QMV9TVEFURV9VTkxPQUQpOwo+PiAgICAJCWlmIChyZXQpIHsKPj4gICAgCQkJRFJN
X1dBUk4oIkZhaWxlZCB0byBzZXQgTVAxIHN0YXRlIHByZXBhcmUgZm9yIHJlbG9hZFxuIik7Cj4+
IEBAIC0xNzk2LDcgKzE3OTYsNyBAQCBzdGF0aWMgaW50IHBzcF9sb2FkX2Z3KHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2KQo+PiAgICAJaW50IHJldDsKPj4gICAgCXN0cnVjdCBwc3BfY29udGV4
dCAqcHNwID0gJmFkZXYtPnBzcDsKPj4gICAgCj4+IC0JaWYgKGFtZGdwdV9zcmlvdl92ZihhZGV2
KSAmJiBhZGV2LT5pbl9ncHVfcmVzZXQpIHsKPj4gKwlpZiAoYW1kZ3B1X3NyaW92X3ZmKGFkZXYp
ICYmIGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKSB7Cj4+ICAgIAkJcHNwX3Jpbmdf
c3RvcChwc3AsIFBTUF9SSU5HX1RZUEVfX0tNKTsgLyogc2hvdWxkIG5vdCBkZXN0cm95IHJpbmcs
IG9ubHkgc3RvcCAqLwo+PiAgICAJCWdvdG8gc2tpcF9tZW1hbGxvYzsKPj4gICAgCX0KPj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuYyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuYwo+PiBpbmRleCBhYjhlN2M5MWM2NDUu
LjNlNTM0MjYyZTM4MSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3Jhcy5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9y
YXMuYwo+PiBAQCAtMTk3NSw3ICsxOTc1LDcgQEAgaW50IGFtZGdwdV9yYXNfbGF0ZV9pbml0KHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+PiAgICAJCQlhbWRncHVfcmFzX3JlcXVlc3RfcmVz
ZXRfb25fYm9vdChhZGV2LAo+PiAgICAJCQkJCXJhc19ibG9jay0+YmxvY2spOwo+PiAgICAJCQly
ZXR1cm4gMDsKPj4gLQkJfSBlbHNlIGlmIChhZGV2LT5pbl9zdXNwZW5kIHx8IGFkZXYtPmluX2dw
dV9yZXNldCkgewo+PiArCQl9IGVsc2UgaWYgKGFkZXYtPmluX3N1c3BlbmQgfHwgYXRvbWljX3Jl
YWQoJmFkZXYtPmluX2dwdV9yZXNldCkpIHsKPj4gICAgCQkJLyogaW4gcmVzdW1lIHBoYXNlLCBp
ZiBmYWlsIHRvIGVuYWJsZSByYXMsCj4+ICAgIAkJCSAqIGNsZWFuIHVwIGFsbCByYXMgZnMgbm9k
ZXMsIGFuZCBkaXNhYmxlIHJhcyAqLwo+PiAgICAJCQlnb3RvIGNsZWFudXA7Cj4+IEBAIC0xOTg0
LDcgKzE5ODQsNyBAQCBpbnQgYW1kZ3B1X3Jhc19sYXRlX2luaXQoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsCj4+ICAgIAl9Cj4+ICAgIAo+PiAgICAJLyogaW4gcmVzdW1lIHBoYXNlLCBubyBu
ZWVkIHRvIGNyZWF0ZSByYXMgZnMgbm9kZSAqLwo+PiAtCWlmIChhZGV2LT5pbl9zdXNwZW5kIHx8
IGFkZXYtPmluX2dwdV9yZXNldCkKPj4gKwlpZiAoYWRldi0+aW5fc3VzcGVuZCB8fCBhdG9taWNf
cmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gMDsKPj4gICAgCj4+ICAg
IAlpZiAoaWhfaW5mby0+Y2IpIHsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90
dG0uYwo+PiBpbmRleCA1NmJlYWZiZDNhYjkuLjJlNjcwYWE2ODc1OCAxMDA2NDQKPj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCj4+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwo+PiBAQCAtMjA5Myw3ICsyMDkzLDcgQEAg
dm9pZCBhbWRncHVfdHRtX3NldF9idWZmZXJfZnVuY3Nfc3RhdHVzKHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LCBib29sIGVuYWJsZSkKPj4gICAgCXVpbnQ2NF90IHNpemU7Cj4+ICAgIAlpbnQg
cjsKPj4gICAgCj4+IC0JaWYgKCFhZGV2LT5tbWFuLmluaXRpYWxpemVkIHx8IGFkZXYtPmluX2dw
dV9yZXNldCB8fAo+PiArCWlmICghYWRldi0+bW1hbi5pbml0aWFsaXplZCB8fCBhdG9taWNfcmVh
ZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSB8fAo+PiAgICAJICAgIGFkZXYtPm1tYW4uYnVmZmVyX2Z1
bmNzX2VuYWJsZWQgPT0gZW5hYmxlKQo+PiAgICAJCXJldHVybjsKPj4gICAgCj4+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdWNvZGUuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV91Y29kZS5jCj4+IGluZGV4IDc0NDQwNGEwNWZlZS4u
ZGE2ZmEyOGIxYjVmIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfdWNvZGUuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
dWNvZGUuYwo+PiBAQCAtNjI4LDcgKzYyOCw3IEBAIGludCBhbWRncHVfdWNvZGVfaW5pdF9ibyhz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPj4gICAgCXN0cnVjdCBhbWRncHVfZmlybXdhcmVf
aW5mbyAqdWNvZGUgPSBOVUxMOwo+PiAgICAKPj4gICAgIC8qIGZvciBiYXJlbWV0YWwsIHRoZSB1
Y29kZSBpcyBhbGxvY2F0ZWQgaW4gZ3R0LCBzbyBkb24ndCBuZWVkIHRvIGZpbGwgdGhlIGJvIHdo
ZW4gcmVzZXQvc3VzcGVuZCAqLwo+PiAtCWlmICghYW1kZ3B1X3NyaW92X3ZmKGFkZXYpICYmIChh
ZGV2LT5pbl9ncHVfcmVzZXQgfHwgYWRldi0+aW5fc3VzcGVuZCkpCj4+ICsJaWYgKCFhbWRncHVf
c3Jpb3ZfdmYoYWRldikgJiYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpIHx8IGFk
ZXYtPmluX3N1c3BlbmQpKQo+PiAgICAJCXJldHVybiAwOwo+PiAgICAJLyoKPj4gICAgCSAqIGlm
IFNNVSBsb2FkZWQgZmlybXdhcmUsIGl0IG5lZWRuJ3QgYWRkIFNNQywgVVZELCBhbmQgVkNFCj4+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdmlydC5oIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZpcnQuaAo+PiBpbmRleCBmODI2OTQ1
OTg5YzcuLjMzNmZhOGJhMjQ2NSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3ZpcnQuaAo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfdmlydC5oCj4+IEBAIC0zMjUsOSArMzI1LDkgQEAgc3RhdGljIGlubGluZSBib29sIGlz
X3ZpcnR1YWxfbWFjaGluZSh2b2lkKQo+PiAgICAjZGVmaW5lIGFtZGdwdV9zcmlvdl9pc19wcF9v
bmVfdmYoYWRldikgXAo+PiAgICAJKChhZGV2KS0+dmlydC5naW1fZmVhdHVyZSAmIEFNREdJTV9G
RUFUVVJFX1BQX09ORV9WRikKPj4gICAgI2RlZmluZSBhbWRncHVfc3Jpb3ZfaXNfZGVidWcoYWRl
dikgXAo+PiAtCSgoIWFkZXYtPmluX2dwdV9yZXNldCkgJiYgYWRldi0+dmlydC50ZHJfZGVidWcp
Cj4+ICsJKCghYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpICYmIGFkZXYtPnZpcnQu
dGRyX2RlYnVnKQo+PiAgICAjZGVmaW5lIGFtZGdwdV9zcmlvdl9pc19ub3JtYWwoYWRldikgXAo+
PiAtCSgoIWFkZXYtPmluX2dwdV9yZXNldCkgJiYgKCFhZGV2LT52aXJ0LnRkcl9kZWJ1ZykpCj4+
ICsJKCghYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpICYmICghYWRldi0+dmlydC50
ZHJfZGVidWcpKQo+PiAgICAKPj4gICAgYm9vbCBhbWRncHVfdmlydF9tbWlvX2Jsb2NrZWQoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpOwo+PiAgICB2b2lkIGFtZGdwdV92aXJ0X2luaXRfc2V0
dGluZyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldik7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2dmeF92MTBfMC5jCj4+IGluZGV4IGE2MTcwYTM0NmIzOS4uYjNjMWUwNWRhNDVlIDEwMDY0
NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYwo+PiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYwo+PiBAQCAtNjEwMiw3ICs2
MTAyLDcgQEAgc3RhdGljIGludCBnZnhfdjEwXzBfZ2Z4X2luaXRfcXVldWUoc3RydWN0IGFtZGdw
dV9yaW5nICpyaW5nKQo+PiAgICAJc3RydWN0IHYxMF9nZnhfbXFkICptcWQgPSByaW5nLT5tcWRf
cHRyOwo+PiAgICAJaW50IG1xZF9pZHggPSByaW5nIC0gJmFkZXYtPmdmeC5nZnhfcmluZ1swXTsK
Pj4gICAgCj4+IC0JaWYgKCFhZGV2LT5pbl9ncHVfcmVzZXQgJiYgIWFkZXYtPmluX3N1c3BlbmQp
IHsKPj4gKwlpZiAoIWF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpICYmICFhZGV2LT5p
bl9zdXNwZW5kKSB7Cj4+ICAgIAkJbWVtc2V0KCh2b2lkICopbXFkLCAwLCBzaXplb2YoKm1xZCkp
Owo+PiAgICAJCW11dGV4X2xvY2soJmFkZXYtPnNyYm1fbXV0ZXgpOwo+PiAgICAJCW52X2dyYm1f
c2VsZWN0KGFkZXYsIHJpbmctPm1lLCByaW5nLT5waXBlLCByaW5nLT5xdWV1ZSwgMCk7Cj4+IEBA
IC02MTE0LDcgKzYxMTQsNyBAQCBzdGF0aWMgaW50IGdmeF92MTBfMF9nZnhfaW5pdF9xdWV1ZShz
dHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpCj4+ICAgIAkJbXV0ZXhfdW5sb2NrKCZhZGV2LT5zcmJt
X211dGV4KTsKPj4gICAgCQlpZiAoYWRldi0+Z2Z4Lm1lLm1xZF9iYWNrdXBbbXFkX2lkeF0pCj4+
ICAgIAkJCW1lbWNweShhZGV2LT5nZngubWUubXFkX2JhY2t1cFttcWRfaWR4XSwgbXFkLCBzaXpl
b2YoKm1xZCkpOwo+PiAtCX0gZWxzZSBpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KSB7Cj4+ICsJfSBl
bHNlIGlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkgewo+PiAgICAJCS8qIHJl
c2V0IG1xZCB3aXRoIHRoZSBiYWNrdXAgY29weSAqLwo+PiAgICAJCWlmIChhZGV2LT5nZngubWUu
bXFkX2JhY2t1cFttcWRfaWR4XSkKPj4gICAgCQkJbWVtY3B5KG1xZCwgYWRldi0+Z2Z4Lm1lLm1x
ZF9iYWNrdXBbbXFkX2lkeF0sIHNpemVvZigqbXFkKSk7Cj4+IEBAIC02NDYzLDcgKzY0NjMsNyBA
QCBzdGF0aWMgaW50IGdmeF92MTBfMF9raXFfaW5pdF9xdWV1ZShzdHJ1Y3QgYW1kZ3B1X3Jpbmcg
KnJpbmcpCj4+ICAgIAo+PiAgICAJZ2Z4X3YxMF8wX2tpcV9zZXR0aW5nKHJpbmcpOwo+PiAgICAK
Pj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KSB7IC8qIGZvciBHUFVfUkVTRVQgY2FzZSAqLwo+
PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkgeyAvKiBmb3IgR1BVX1JF
U0VUIGNhc2UgKi8KPj4gICAgCQkvKiByZXNldCBNUUQgdG8gYSBjbGVhbiBzdGF0dXMgKi8KPj4g
ICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdKQo+PiAgICAJCQltZW1j
cHkobXFkLCBhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0sIHNpemVvZigqbXFkKSk7
Cj4+IEBAIC02NDk5LDcgKzY0OTksNyBAQCBzdGF0aWMgaW50IGdmeF92MTBfMF9rY3FfaW5pdF9x
dWV1ZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpCj4+ICAgIAlzdHJ1Y3QgdjEwX2NvbXB1dGVf
bXFkICptcWQgPSByaW5nLT5tcWRfcHRyOwo+PiAgICAJaW50IG1xZF9pZHggPSByaW5nIC0gJmFk
ZXYtPmdmeC5jb21wdXRlX3JpbmdbMF07Cj4+ICAgIAo+PiAtCWlmICghYWRldi0+aW5fZ3B1X3Jl
c2V0ICYmICFhZGV2LT5pbl9zdXNwZW5kKSB7Cj4+ICsJaWYgKCFhdG9taWNfcmVhZCgmYWRldi0+
aW5fZ3B1X3Jlc2V0KSAmJiAhYWRldi0+aW5fc3VzcGVuZCkgewo+PiAgICAJCW1lbXNldCgodm9p
ZCAqKW1xZCwgMCwgc2l6ZW9mKCptcWQpKTsKPj4gICAgCQltdXRleF9sb2NrKCZhZGV2LT5zcmJt
X211dGV4KTsKPj4gICAgCQludl9ncmJtX3NlbGVjdChhZGV2LCByaW5nLT5tZSwgcmluZy0+cGlw
ZSwgcmluZy0+cXVldWUsIDApOwo+PiBAQCAtNjUwOSw3ICs2NTA5LDcgQEAgc3RhdGljIGludCBn
ZnhfdjEwXzBfa2NxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQo+PiAgICAK
Pj4gICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdKQo+PiAgICAJCQlt
ZW1jcHkoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdLCBtcWQsIHNpemVvZigqbXFk
KSk7Cj4+IC0JfSBlbHNlIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsgLyogZm9yIEdQVV9SRVNF
VCBjYXNlICovCj4+ICsJfSBlbHNlIGlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0
KSkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8KPj4gICAgCQkvKiByZXNldCBNUUQgdG8gYSBj
bGVhbiBzdGF0dXMgKi8KPj4gICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9p
ZHhdKQo+PiAgICAJCQltZW1jcHkobXFkLCBhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lk
eF0sIHNpemVvZigqbXFkKSk7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nZnhfdjhfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y4XzAuYwo+
PiBpbmRleCAzM2YxYzRhNDZlYmUuLmM3MGYzYmM1Y2VhMiAxMDA2NDQKPj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y4XzAuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9nZnhfdjhfMC5jCj4+IEBAIC00NjMyLDcgKzQ2MzIsNyBAQCBzdGF0aWMgaW50
IGdmeF92OF8wX2tpcV9pbml0X3F1ZXVlKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZykKPj4gICAg
Cj4+ICAgIAlnZnhfdjhfMF9raXFfc2V0dGluZyhyaW5nKTsKPj4gICAgCj4+IC0JaWYgKGFkZXYt
PmluX2dwdV9yZXNldCkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8KPj4gKwlpZiAoYXRvbWlj
X3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpIHsgLyogZm9yIEdQVV9SRVNFVCBjYXNlICovCj4+
ICAgIAkJLyogcmVzZXQgTVFEIHRvIGEgY2xlYW4gc3RhdHVzICovCj4+ICAgIAkJaWYgKGFkZXYt
PmdmeC5tZWMubXFkX2JhY2t1cFttcWRfaWR4XSkKPj4gICAgCQkJbWVtY3B5KG1xZCwgYWRldi0+
Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdLCBzaXplb2Yoc3RydWN0IHZpX21xZF9hbGxvY2F0
aW9uKSk7Cj4+IEBAIC00NjY5LDcgKzQ2NjksNyBAQCBzdGF0aWMgaW50IGdmeF92OF8wX2tjcV9p
bml0X3F1ZXVlKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZykKPj4gICAgCXN0cnVjdCB2aV9tcWQg
Km1xZCA9IHJpbmctPm1xZF9wdHI7Cj4+ICAgIAlpbnQgbXFkX2lkeCA9IHJpbmcgLSAmYWRldi0+
Z2Z4LmNvbXB1dGVfcmluZ1swXTsKPj4gICAgCj4+IC0JaWYgKCFhZGV2LT5pbl9ncHVfcmVzZXQg
JiYgIWFkZXYtPmluX3N1c3BlbmQpIHsKPj4gKwlpZiAoIWF0b21pY19yZWFkKCZhZGV2LT5pbl9n
cHVfcmVzZXQpICYmICFhZGV2LT5pbl9zdXNwZW5kKSB7Cj4+ICAgIAkJbWVtc2V0KCh2b2lkICop
bXFkLCAwLCBzaXplb2Yoc3RydWN0IHZpX21xZF9hbGxvY2F0aW9uKSk7Cj4+ICAgIAkJKChzdHJ1
Y3QgdmlfbXFkX2FsbG9jYXRpb24gKiltcWQpLT5keW5hbWljX2N1X21hc2sgPSAweEZGRkZGRkZG
Owo+PiAgICAJCSgoc3RydWN0IHZpX21xZF9hbGxvY2F0aW9uICopbXFkKS0+ZHluYW1pY19yYl9t
YXNrID0gMHhGRkZGRkZGRjsKPj4gQEAgLTQ2ODEsNyArNDY4MSw3IEBAIHN0YXRpYyBpbnQgZ2Z4
X3Y4XzBfa2NxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQo+PiAgICAKPj4g
ICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdKQo+PiAgICAJCQltZW1j
cHkoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdLCBtcWQsIHNpemVvZihzdHJ1Y3Qg
dmlfbXFkX2FsbG9jYXRpb24pKTsKPj4gLQl9IGVsc2UgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkg
eyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8KPj4gKwl9IGVsc2UgaWYgKGF0b21pY19yZWFkKCZh
ZGV2LT5pbl9ncHVfcmVzZXQpKSB7IC8qIGZvciBHUFVfUkVTRVQgY2FzZSAqLwo+PiAgICAJCS8q
IHJlc2V0IE1RRCB0byBhIGNsZWFuIHN0YXR1cyAqLwo+PiAgICAJCWlmIChhZGV2LT5nZngubWVj
Lm1xZF9iYWNrdXBbbXFkX2lkeF0pCj4+ICAgIAkJCW1lbWNweShtcWQsIGFkZXYtPmdmeC5tZWMu
bXFkX2JhY2t1cFttcWRfaWR4XSwgc2l6ZW9mKHN0cnVjdCB2aV9tcWRfYWxsb2NhdGlvbikpOwo+
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OV8wLmMKPj4gaW5kZXggY2I5ZDYwYTRlMDVl
Li45MDIwYTBmNDBlMjggMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2dmeF92OV8wLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAu
Ywo+PiBAQCAtMzY4NCw3ICszNjg0LDcgQEAgc3RhdGljIGludCBnZnhfdjlfMF9raXFfaW5pdF9x
dWV1ZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpCj4+ICAgIAo+PiAgICAJZ2Z4X3Y5XzBfa2lx
X3NldHRpbmcocmluZyk7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsgLyog
Zm9yIEdQVV9SRVNFVCBjYXNlICovCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKSB7IC8qIGZvciBHUFVfUkVTRVQgY2FzZSAqLwo+PiAgICAJCS8qIHJlc2V0IE1RRCB0
byBhIGNsZWFuIHN0YXR1cyAqLwo+PiAgICAJCWlmIChhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBb
bXFkX2lkeF0pCj4+ICAgIAkJCW1lbWNweShtcWQsIGFkZXYtPmdmeC5tZWMubXFkX2JhY2t1cFtt
cWRfaWR4XSwgc2l6ZW9mKHN0cnVjdCB2OV9tcWRfYWxsb2NhdGlvbikpOwo+PiBAQCAtMzcyMiw3
ICszNzIyLDcgQEAgc3RhdGljIGludCBnZnhfdjlfMF9rY3FfaW5pdF9xdWV1ZShzdHJ1Y3QgYW1k
Z3B1X3JpbmcgKnJpbmcpCj4+ICAgIAlzdHJ1Y3QgdjlfbXFkICptcWQgPSByaW5nLT5tcWRfcHRy
Owo+PiAgICAJaW50IG1xZF9pZHggPSByaW5nIC0gJmFkZXYtPmdmeC5jb21wdXRlX3JpbmdbMF07
Cj4+ICAgIAo+PiAtCWlmICghYWRldi0+aW5fZ3B1X3Jlc2V0ICYmICFhZGV2LT5pbl9zdXNwZW5k
KSB7Cj4+ICsJaWYgKCFhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSAmJiAhYWRldi0+
aW5fc3VzcGVuZCkgewo+PiAgICAJCW1lbXNldCgodm9pZCAqKW1xZCwgMCwgc2l6ZW9mKHN0cnVj
dCB2OV9tcWRfYWxsb2NhdGlvbikpOwo+PiAgICAJCSgoc3RydWN0IHY5X21xZF9hbGxvY2F0aW9u
ICopbXFkKS0+ZHluYW1pY19jdV9tYXNrID0gMHhGRkZGRkZGRjsKPj4gICAgCQkoKHN0cnVjdCB2
OV9tcWRfYWxsb2NhdGlvbiAqKW1xZCktPmR5bmFtaWNfcmJfbWFzayA9IDB4RkZGRkZGRkY7Cj4+
IEBAIC0zNzM0LDcgKzM3MzQsNyBAQCBzdGF0aWMgaW50IGdmeF92OV8wX2tjcV9pbml0X3F1ZXVl
KHN0cnVjdCBhbWRncHVfcmluZyAqcmluZykKPj4gICAgCj4+ICAgIAkJaWYgKGFkZXYtPmdmeC5t
ZWMubXFkX2JhY2t1cFttcWRfaWR4XSkKPj4gICAgCQkJbWVtY3B5KGFkZXYtPmdmeC5tZWMubXFk
X2JhY2t1cFttcWRfaWR4XSwgbXFkLCBzaXplb2Yoc3RydWN0IHY5X21xZF9hbGxvY2F0aW9uKSk7
Cj4+IC0JfSBlbHNlIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsgLyogZm9yIEdQVV9SRVNFVCBj
YXNlICovCj4+ICsJfSBlbHNlIGlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkg
eyAvKiBmb3IgR1BVX1JFU0VUIGNhc2UgKi8KPj4gICAgCQkvKiByZXNldCBNUUQgdG8gYSBjbGVh
biBzdGF0dXMgKi8KPj4gICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhd
KQo+PiAgICAJCQltZW1jcHkobXFkLCBhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0s
IHNpemVvZihzdHJ1Y3QgdjlfbXFkX2FsbG9jYXRpb24pKTsKPj4gQEAgLTM5MjgsNyArMzkyOCw3
IEBAIHN0YXRpYyBpbnQgZ2Z4X3Y5XzBfaHdfZmluaSh2b2lkICpoYW5kbGUpCj4+ICAgIAkvKiBV
c2UgZGVpbml0aWFsaXplIHNlcXVlbmNlIGZyb20gQ0FJTCB3aGVuIHVuYmluZGluZyBkZXZpY2Ug
ZnJvbSBkcml2ZXIsCj4+ICAgIAkgKiBvdGhlcndpc2UgS0lRIGlzIGhhbmdpbmcgd2hlbiBiaW5k
aW5nIGJhY2sKPj4gICAgCSAqLwo+PiAtCWlmICghYWRldi0+aW5fZ3B1X3Jlc2V0ICYmICFhZGV2
LT5pbl9zdXNwZW5kKSB7Cj4+ICsJaWYgKCFhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0
KSAmJiAhYWRldi0+aW5fc3VzcGVuZCkgewo+PiAgICAJCW11dGV4X2xvY2soJmFkZXYtPnNyYm1f
bXV0ZXgpOwo+PiAgICAJCXNvYzE1X2dyYm1fc2VsZWN0KGFkZXYsIGFkZXYtPmdmeC5raXEucmlu
Zy5tZSwKPj4gICAgCQkJCWFkZXYtPmdmeC5raXEucmluZy5waXBlLAo+PiBAQCAtNDA4Niw3ICs0
MDg2LDcgQEAgc3RhdGljIHVpbnQ2NF90IGdmeF92OV8wX2tpcV9yZWFkX2Nsb2NrKHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2KQo+PiAgICAJICoKPj4gICAgCSAqIGFsc28gZG9uJ3Qgd2FpdCBh
bnltb3JlIGZvciBJUlEgY29udGV4dAo+PiAgICAJICogKi8KPj4gLQlpZiAociA8IDEgJiYgKGFk
ZXYtPmluX2dwdV9yZXNldCB8fCBpbl9pbnRlcnJ1cHQoKSkpCj4+ICsJaWYgKHIgPCAxICYmIChh
dG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSB8fCBpbl9pbnRlcnJ1cHQoKSkpCj4+ICAg
IAkJZ290byBmYWlsZWRfa2lxX3JlYWQ7Cj4+ICAgIAo+PiAgICAJbWlnaHRfc2xlZXAoKTsKPj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBfMC5jIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3YxMF8wLmMKPj4gaW5kZXggOGYyOWY3OWY4MjBk
Li5iNzYxYmY1OWVkMTEgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2dtY192MTBfMC5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192MTBf
MC5jCj4+IEBAIC0zNTYsNyArMzU2LDcgQEAgc3RhdGljIHZvaWQgZ21jX3YxMF8wX2ZsdXNoX2dw
dV90bGIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHVpbnQzMl90IHZtaWQsCj4+ICAgIAkg
Ki8KPj4gICAgCWlmIChhZGV2LT5nZngua2lxLnJpbmcuc2NoZWQucmVhZHkgJiYKPj4gICAgCSAg
ICAoYW1kZ3B1X3NyaW92X3J1bnRpbWUoYWRldikgfHwgIWFtZGdwdV9zcmlvdl92ZihhZGV2KSkg
JiYKPj4gLQkgICAgIWFkZXYtPmluX2dwdV9yZXNldCkgewo+PiArCSAgICAhYXRvbWljX3JlYWQo
JmFkZXYtPmluX2dwdV9yZXNldCkpIHsKPj4gICAgCj4+ICAgIAkJc3RydWN0IGFtZGdwdV92bWh1
YiAqaHViID0gJmFkZXYtPnZtaHViW3ZtaHViXTsKPj4gICAgCQljb25zdCB1bnNpZ25lZCBlbmcg
PSAxNzsKPj4gQEAgLTM4MSw3ICszODEsNyBAQCBzdGF0aWMgdm9pZCBnbWNfdjEwXzBfZmx1c2hf
Z3B1X3RsYihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgdWludDMyX3Qgdm1pZCwKPj4gICAg
Cj4+ICAgIAlpZiAoIWFkZXYtPm1tYW4uYnVmZmVyX2Z1bmNzX2VuYWJsZWQgfHwKPj4gICAgCSAg
ICAhYWRldi0+aWJfcG9vbF9yZWFkeSB8fAo+PiAtCSAgICBhZGV2LT5pbl9ncHVfcmVzZXQgfHwK
Pj4gKwkgICAgYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkgfHwKPj4gICAgCSAgICBy
aW5nLT5zY2hlZC5yZWFkeSA9PSBmYWxzZSkgewo+PiAgICAJCWdtY192MTBfMF9mbHVzaF92bV9o
dWIoYWRldiwgdm1pZCwgQU1ER1BVX0dGWEhVQl8wLCAwKTsKPj4gICAgCQltdXRleF91bmxvY2so
JmFkZXYtPm1tYW4uZ3R0X3dpbmRvd19sb2NrKTsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2dtY192N18wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9n
bWNfdjdfMC5jCj4+IGluZGV4IGUxODI5NmRjMTM4Ni4uZDgzYjgzNDU5YmE3IDEwMDY0NAo+PiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjdfMC5jCj4+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192N18wLmMKPj4gQEAgLTQzNCw3ICs0MzQsNyBAQCBz
dGF0aWMgaW50IGdtY192N18wX2ZsdXNoX2dwdV90bGJfcGFzaWQoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsCj4+ICAgIAlpbnQgdm1pZDsKPj4gICAgCXVuc2lnbmVkIGludCB0bXA7Cj4+ICAg
IAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2
LT5pbl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAtRUlPOwo+PiAgICAKPj4gICAgCWZvciAo
dm1pZCA9IDE7IHZtaWQgPCAxNjsgdm1pZCsrKSB7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9nbWNfdjhfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
Z21jX3Y4XzAuYwo+PiBpbmRleCBhOWU3MjJiOGE0NTguLjU4NTRkZjZkY2MzMiAxMDA2NDQKPj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y4XzAuYwo+PiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjhfMC5jCj4+IEBAIC02MzUsNyArNjM1LDcgQEAg
c3RhdGljIGludCBnbWNfdjhfMF9mbHVzaF9ncHVfdGxiX3Bhc2lkKHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LAo+PiAgICAJaW50IHZtaWQ7Cj4+ICAgIAl1bnNpZ25lZCBpbnQgdG1wOwo+PiAg
ICAKPj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+PiArCWlmIChhdG9taWNfcmVhZCgmYWRl
di0+aW5fZ3B1X3Jlc2V0KSkKPj4gICAgCQlyZXR1cm4gLUVJTzsKPj4gICAgCj4+ICAgIAlmb3Ig
KHZtaWQgPSAxOyB2bWlkIDwgMTY7IHZtaWQrKykgewo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2dtY192OV8wLmMKPj4gaW5kZXggNmU0ZjNmZjQ4MTBmLi5iODJhMWFmODZmNDMgMTAwNjQ0Cj4+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMKPj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAuYwo+PiBAQCAtNTAxLDcgKzUwMSw3IEBA
IHN0YXRpYyB2b2lkIGdtY192OV8wX2ZsdXNoX2dwdV90bGIoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYsIHVpbnQzMl90IHZtaWQsCj4+ICAgIAkgKi8KPj4gICAgCWlmIChhZGV2LT5nZngua2lx
LnJpbmcuc2NoZWQucmVhZHkgJiYKPj4gICAgCQkJKGFtZGdwdV9zcmlvdl9ydW50aW1lKGFkZXYp
IHx8ICFhbWRncHVfc3Jpb3ZfdmYoYWRldikpICYmCj4+IC0JCQkhYWRldi0+aW5fZ3B1X3Jlc2V0
KSB7Cj4+ICsJCQkhYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpIHsKPj4gICAgCQl1
aW50MzJfdCByZXEgPSBodWItPnZtX2ludl9lbmcwX3JlcSArIGh1Yi0+ZW5nX2Rpc3RhbmNlICog
ZW5nOwo+PiAgICAJCXVpbnQzMl90IGFjayA9IGh1Yi0+dm1faW52X2VuZzBfYWNrICsgaHViLT5l
bmdfZGlzdGFuY2UgKiBlbmc7Cj4+ICAgIAo+PiBAQCAtNTk2LDcgKzU5Niw3IEBAIHN0YXRpYyBp
bnQgZ21jX3Y5XzBfZmx1c2hfZ3B1X3RsYl9wYXNpZChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwKPj4gICAgCXN0cnVjdCBhbWRncHVfcmluZyAqcmluZyA9ICZhZGV2LT5nZngua2lxLnJpbmc7
Cj4+ICAgIAlzdHJ1Y3QgYW1kZ3B1X2tpcSAqa2lxID0gJmFkZXYtPmdmeC5raXE7Cj4+ICAgIAo+
PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5p
bl9ncHVfcmVzZXQpKQo+PiAgICAJCXJldHVybiAtRUlPOwo+PiAgICAKPj4gICAgCWlmIChyaW5n
LT5zY2hlZC5yZWFkeSkgewo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvbXhncHVfYWkuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X2FpLmMKPj4g
aW5kZXggNWZkNjdlMWNjMmEwLi5mZTMxY2JlY2NmZTkgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X2FpLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvbXhncHVfYWkuYwo+PiBAQCAtMjM4LDIwICsyMzgsMTYgQEAgc3RhdGljIHZvaWQg
eGdwdV9haV9tYWlsYm94X2Zscl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPj4gICAg
CXN0cnVjdCBhbWRncHVfdmlydCAqdmlydCA9IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgYW1k
Z3B1X3ZpcnQsIGZscl93b3JrKTsKPj4gICAgCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0g
Y29udGFpbmVyX29mKHZpcnQsIHN0cnVjdCBhbWRncHVfZGV2aWNlLCB2aXJ0KTsKPj4gICAgCWlu
dCB0aW1lb3V0ID0gQUlfTUFJTEJPWF9QT0xMX0ZMUl9USU1FRE9VVDsKPj4gLQlpbnQgbG9ja2Vk
Owo+PiAgICAKPj4gICAgCS8qIGJsb2NrIGFtZGdwdV9ncHVfcmVjb3ZlciB0aWxsIG1zZyBGTFIg
Q09NUExFVEUgcmVjZWl2ZWQsCj4+ICAgIAkgKiBvdGhlcndpc2UgdGhlIG1haWxib3ggbXNnIHdp
bGwgYmUgcnVpbmVkL3Jlc2V0ZWQgYnkKPj4gICAgCSAqIHRoZSBWRiBGTFIuCj4+ICAgIAkgKgo+
PiAtCSAqIHdlIGNhbiB1bmxvY2sgdGhlIGxvY2tfcmVzZXQgdG8gYWxsb3cgImFtZGdwdV9qb2Jf
dGltZWRvdXQiCj4+ICsJICogd2UgY2FuIHVubG9jayB0aGUgcmVzZXRfc2VtIHRvIGFsbG93ICJh
bWRncHVfam9iX3RpbWVkb3V0Igo+PiAgICAJICogdG8gcnVuIGdwdV9yZWNvdmVyKCkgYWZ0ZXIg
RkxSX05PVElGSUNBVElPTl9DTVBMIHJlY2VpdmVkCj4+ICAgIAkgKiB3aGljaCBtZWFucyBob3N0
IHNpZGUgaGFkIGZpbmlzaGVkIHRoaXMgVkYncyBGTFIuCj4+ICAgIAkgKi8KPj4gLQlsb2NrZWQg
PSBtdXRleF90cnlsb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPj4gLQlpZiAobG9ja2VkKQo+PiAt
CQlhZGV2LT5pbl9ncHVfcmVzZXQgPSB0cnVlOwo+PiAtCj4+ICsJZG93bl9yZWFkKCZhZGV2LT5y
ZXNldF9zZW0pOwo+PiAgICAJZG8gewo+PiAgICAJCWlmICh4Z3B1X2FpX21haWxib3hfcGVla19t
c2coYWRldikgPT0gSURIX0ZMUl9OT1RJRklDQVRJT05fQ01QTCkKPj4gICAgCQkJZ290byBmbHJf
ZG9uZTsKPj4gQEAgLTI2MSwxMCArMjU3LDcgQEAgc3RhdGljIHZvaWQgeGdwdV9haV9tYWlsYm94
X2Zscl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPj4gICAgCX0gd2hpbGUgKHRpbWVv
dXQgPiAxKTsKPj4gICAgCj4+ICAgIGZscl9kb25lOgo+PiAtCWlmIChsb2NrZWQpIHsKPj4gLQkJ
YWRldi0+aW5fZ3B1X3Jlc2V0ID0gZmFsc2U7Cj4+IC0JCW11dGV4X3VubG9jaygmYWRldi0+bG9j
a19yZXNldCk7Cj4+IC0JfQo+PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4+ICAgIAo+
PiAgICAJLyogVHJpZ2dlciByZWNvdmVyeSBmb3Igd29ybGQgc3dpdGNoIGZhaWx1cmUgaWYgbm8g
VERSICovCj4+ICAgIAlpZiAoYW1kZ3B1X2RldmljZV9zaG91bGRfcmVjb3Zlcl9ncHUoYWRldikK
Pj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X252LmMgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9teGdwdV9udi5jCj4+IGluZGV4IGNlMmJmMWZiNzll
ZC4uNmY1NTE3MmU4MzM3IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9teGdwdV9udi5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X252
LmMKPj4gQEAgLTI1OSwyMCArMjU5LDE2IEBAIHN0YXRpYyB2b2lkIHhncHVfbnZfbWFpbGJveF9m
bHJfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4+ICAgIAlzdHJ1Y3QgYW1kZ3B1X3Zp
cnQgKnZpcnQgPSBjb250YWluZXJfb2Yod29yaywgc3RydWN0IGFtZGdwdV92aXJ0LCBmbHJfd29y
ayk7Cj4+ICAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGNvbnRhaW5lcl9vZih2aXJ0
LCBzdHJ1Y3QgYW1kZ3B1X2RldmljZSwgdmlydCk7Cj4+ICAgIAlpbnQgdGltZW91dCA9IE5WX01B
SUxCT1hfUE9MTF9GTFJfVElNRURPVVQ7Cj4+IC0JaW50IGxvY2tlZDsKPj4gICAgCj4+ICAgIAkv
KiBibG9jayBhbWRncHVfZ3B1X3JlY292ZXIgdGlsbCBtc2cgRkxSIENPTVBMRVRFIHJlY2VpdmVk
LAo+PiAgICAJICogb3RoZXJ3aXNlIHRoZSBtYWlsYm94IG1zZyB3aWxsIGJlIHJ1aW5lZC9yZXNl
dGVkIGJ5Cj4+ICAgIAkgKiB0aGUgVkYgRkxSLgo+PiAgICAJICoKPj4gLQkgKiB3ZSBjYW4gdW5s
b2NrIHRoZSBsb2NrX3Jlc2V0IHRvIGFsbG93ICJhbWRncHVfam9iX3RpbWVkb3V0Igo+PiArCSAq
IHdlIGNhbiB1bmxvY2sgdGhlIHJlc2V0X3NlbSB0byBhbGxvdyAiYW1kZ3B1X2pvYl90aW1lZG91
dCIKPj4gICAgCSAqIHRvIHJ1biBncHVfcmVjb3ZlcigpIGFmdGVyIEZMUl9OT1RJRklDQVRJT05f
Q01QTCByZWNlaXZlZAo+PiAgICAJICogd2hpY2ggbWVhbnMgaG9zdCBzaWRlIGhhZCBmaW5pc2hl
ZCB0aGlzIFZGJ3MgRkxSLgo+PiAgICAJICovCj4+IC0JbG9ja2VkID0gbXV0ZXhfdHJ5bG9jaygm
YWRldi0+bG9ja19yZXNldCk7Cj4+IC0JaWYgKGxvY2tlZCkKPj4gLQkJYWRldi0+aW5fZ3B1X3Jl
c2V0ID0gdHJ1ZTsKPj4gLQo+PiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPj4gICAg
CWRvIHsKPj4gICAgCQlpZiAoeGdwdV9udl9tYWlsYm94X3BlZWtfbXNnKGFkZXYpID09IElESF9G
TFJfTk9USUZJQ0FUSU9OX0NNUEwpCj4+ICAgIAkJCWdvdG8gZmxyX2RvbmU7Cj4+IEBAIC0yODIs
MTAgKzI3OCw3IEBAIHN0YXRpYyB2b2lkIHhncHVfbnZfbWFpbGJveF9mbHJfd29yayhzdHJ1Y3Qg
d29ya19zdHJ1Y3QgKndvcmspCj4+ICAgIAl9IHdoaWxlICh0aW1lb3V0ID4gMSk7Cj4+ICAgIAo+
PiAgICBmbHJfZG9uZToKPj4gLQlpZiAobG9ja2VkKSB7Cj4+IC0JCWFkZXYtPmluX2dwdV9yZXNl
dCA9IGZhbHNlOwo+PiAtCQltdXRleF91bmxvY2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+PiAtCX0K
Pj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+PiAgICAKPj4gICAgCS8qIFRyaWdnZXIg
cmVjb3ZlcnkgZm9yIHdvcmxkIHN3aXRjaCBmYWlsdXJlIGlmIG5vIFREUiAqLwo+PiAgICAJaWYg
KGFtZGdwdV9kZXZpY2Vfc2hvdWxkX3JlY292ZXJfZ3B1KGFkZXYpCj4+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfY2hhcmRldi5jIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRrZmQva2ZkX2NoYXJkZXYuYwo+PiBpbmRleCBlOWI5NmFkM2Q5YTUuLjM5MzY0MmMz
MjM4NyAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2NoYXJk
ZXYuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfY2hhcmRldi5jCj4+
IEBAIC0xNDgyLDEzICsxNDgyLDIwIEBAIHN0YXRpYyBpbnQga2ZkX2lvY3RsX21hcF9tZW1vcnlf
dG9fZ3B1KHN0cnVjdCBmaWxlICpmaWxlcCwKPj4gICAgCj4+ICAgIAkvKiBGbHVzaCBUTEJzIGFm
dGVyIHdhaXRpbmcgZm9yIHRoZSBwYWdlIHRhYmxlIHVwZGF0ZXMgdG8gY29tcGxldGUgKi8KPj4g
ICAgCWZvciAoaSA9IDA7IGkgPCBhcmdzLT5uX2RldmljZXM7IGkrKykgewo+PiArCQlzdHJ1Y3Qg
ZGV2aWNlX3F1ZXVlX21hbmFnZXIgKmRxbTsKPj4gKwo+PiAgICAJCXBlZXIgPSBrZmRfZGV2aWNl
X2J5X2lkKGRldmljZXNfYXJyW2ldKTsKPj4gICAgCQlpZiAoV0FSTl9PTl9PTkNFKCFwZWVyKSkK
Pj4gICAgCQkJY29udGludWU7Cj4+ICAgIAkJcGVlcl9wZGQgPSBrZmRfZ2V0X3Byb2Nlc3NfZGV2
aWNlX2RhdGEocGVlciwgcCk7Cj4+ICAgIAkJaWYgKFdBUk5fT05fT05DRSghcGVlcl9wZGQpKQo+
PiAgICAJCQljb250aW51ZTsKPj4gKwo+PiArCQlkcW0gPSBwZWVyX3BkZC0+ZGV2LT5kcW07Cj4+
ICsKPj4gKwkJZHFtX2xvY2soZHFtKTsKPj4gICAgCQlrZmRfZmx1c2hfdGxiKHBlZXJfcGRkKTsK
Pj4gKwkJZHFtX3VubG9jayhkcW0pOwo+PiAgICAJfQo+PiAgICAKPj4gICAgCWtmcmVlKGRldmlj
ZXNfYXJyKTsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9k
ZXZpY2VfcXVldWVfbWFuYWdlci5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2Rl
dmljZV9xdWV1ZV9tYW5hZ2VyLmMKPj4gaW5kZXggZGQ1NTAwMjVkMWMxLi4wYjU0MDljZWRlNTIg
MTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZpY2VfcXVl
dWVfbWFuYWdlci5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZp
Y2VfcXVldWVfbWFuYWdlci5jCj4+IEBAIC0zMDQsMTUgKzMwNCwxNyBAQCBzdGF0aWMgdm9pZCBk
ZWFsbG9jYXRlX3ZtaWQoc3RydWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0sCj4+ICAgIAkJ
CQlzdHJ1Y3QgcWNtX3Byb2Nlc3NfZGV2aWNlICpxcGQsCj4+ICAgIAkJCQlzdHJ1Y3QgcXVldWUg
KnEpCj4+ICAgIHsKPj4gLQkvKiBPbiBHRlggdjcsIENQIGRvZXNuJ3QgZmx1c2ggVEMgYXQgZGVx
dWV1ZSAqLwo+PiAtCWlmIChxLT5kZXZpY2UtPmRldmljZV9pbmZvLT5hc2ljX2ZhbWlseSA9PSBD
SElQX0hBV0FJSSkKPj4gLQkJaWYgKGZsdXNoX3RleHR1cmVfY2FjaGVfbm9jcHNjaChxLT5kZXZp
Y2UsIHFwZCkpCj4+IC0JCQlwcl9lcnIoIkZhaWxlZCB0byBmbHVzaCBUQ1xuIik7Cj4+ICsJaWYg
KCFkcW0tPmlzX3Jlc2V0dGluZykgewo+PiArCQkvKiBPbiBHRlggdjcsIENQIGRvZXNuJ3QgZmx1
c2ggVEMgYXQgZGVxdWV1ZSAqLwo+PiArCQlpZiAocS0+ZGV2aWNlLT5kZXZpY2VfaW5mby0+YXNp
Y19mYW1pbHkgPT0gQ0hJUF9IQVdBSUkpCj4+ICsJCQlpZiAoZmx1c2hfdGV4dHVyZV9jYWNoZV9u
b2Nwc2NoKHEtPmRldmljZSwgcXBkKSkKPj4gKwkJCQlwcl9lcnIoIkZhaWxlZCB0byBmbHVzaCBU
Q1xuIik7Cj4+ICAgIAo+PiAtCWtmZF9mbHVzaF90bGIocXBkX3RvX3BkZChxcGQpKTsKPj4gKwkJ
a2ZkX2ZsdXNoX3RsYihxcGRfdG9fcGRkKHFwZCkpOwo+PiAgICAKPj4gLQkvKiBSZWxlYXNlIHRo
ZSB2bWlkIG1hcHBpbmcgKi8KPj4gLQlzZXRfcGFzaWRfdm1pZF9tYXBwaW5nKGRxbSwgMCwgcXBk
LT52bWlkKTsKPj4gKwkJLyogUmVsZWFzZSB0aGUgdm1pZCBtYXBwaW5nICovCj4+ICsJCXNldF9w
YXNpZF92bWlkX21hcHBpbmcoZHFtLCAwLCBxcGQtPnZtaWQpOwo+PiArCX0KPj4gICAgCWRxbS0+
dm1pZF9wYXNpZFtxcGQtPnZtaWRdID0gMDsKPj4gICAgCj4+ICAgIAlxcGQtPnZtaWQgPSAwOwo+
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX3Byb2Nlc3MuYyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9wcm9jZXNzLmMKPj4gaW5kZXggMDEzYzJi
MDE4ZWRjLi43MWJlODk3ZDRjMmEgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1ka2ZkL2tmZF9wcm9jZXNzLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQv
a2ZkX3Byb2Nlc3MuYwo+PiBAQCAtMTU1MSw2ICsxNTUxLDEwIEBAIGludCBrZmRfcmVzZXJ2ZWRf
bWVtX21tYXAoc3RydWN0IGtmZF9kZXYgKmRldiwgc3RydWN0IGtmZF9wcm9jZXNzICpwcm9jZXNz
LAo+PiAgICB2b2lkIGtmZF9mbHVzaF90bGIoc3RydWN0IGtmZF9wcm9jZXNzX2RldmljZSAqcGRk
KQo+PiAgICB7Cj4+ICAgIAlzdHJ1Y3Qga2ZkX2RldiAqZGV2ID0gcGRkLT5kZXY7Cj4+ICsJc3Ry
dWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0gPSBkZXYtPmRxbTsKPj4gKwo+PiArCWlmIChk
cW0tPmlzX3Jlc2V0dGluZykKPj4gKwkJcmV0dXJuOwo+PiAgICAKPj4gICAgCWlmIChkZXYtPmRx
bS0+c2NoZWRfcG9saWN5ID09IEtGRF9TQ0hFRF9QT0xJQ1lfTk9fSFdTKSB7Cj4+ICAgIAkJLyog
Tm90aGluZyB0byBmbHVzaCB1bnRpbCBhIFZNSUQgaXMgYXNzaWduZWQsIHdoaWNoCj4+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbS5j
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYwo+PiBp
bmRleCBiNGUxMjBlOTU0MzguLmRiMzMyMjgyYzAxZSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYwo+PiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbS5jCj4+IEBAIC0xNjQwLDcg
KzE2NDAsNyBAQCBzdGF0aWMgaW50IGRtX3N1c3BlbmQodm9pZCAqaGFuZGxlKQo+PiAgICAJc3Ry
dWN0IGFtZGdwdV9kaXNwbGF5X21hbmFnZXIgKmRtID0gJmFkZXYtPmRtOwo+PiAgICAJaW50IHJl
dCA9IDA7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsKPj4gKwlpZiAoYXRv
bWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpIHsKPj4gICAgCQltdXRleF9sb2NrKCZkbS0+
ZGNfbG9jayk7Cj4+ICAgIAkJZG0tPmNhY2hlZF9kY19zdGF0ZSA9IGRjX2NvcHlfc3RhdGUoZG0t
PmRjLT5jdXJyZW50X3N0YXRlKTsKPj4gICAgCj4+IEBAIC0xODI2LDcgKzE4MjYsNyBAQCBzdGF0
aWMgaW50IGRtX3Jlc3VtZSh2b2lkICpoYW5kbGUpCj4+ICAgIAlzdHJ1Y3QgZGNfc3RhdGUgKmRj
X3N0YXRlOwo+PiAgICAJaW50IGksIHIsIGo7Cj4+ICAgIAo+PiAtCWlmIChhZGV2LT5pbl9ncHVf
cmVzZXQpIHsKPj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpIHsKPj4g
ICAgCQlkY19zdGF0ZSA9IGRtLT5jYWNoZWRfZGNfc3RhdGU7Cj4+ICAgIAo+PiAgICAJCXIgPSBk
bV9kbXViX2h3X2luaXQoYWRldik7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L3Bvd2VycGxheS9hbWRncHVfc211LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9h
bWRncHVfc211LmMKPj4gaW5kZXggZmU0OTQ4YWE2NjJmLi42OTEzNGEwZDY2MGMgMTAwNjQ0Cj4+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2FtZGdwdV9zbXUuYwo+PiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9hbWRncHVfc211LmMKPj4gQEAgLTEzNDEs
NyArMTM0MSw3IEBAIHN0YXRpYyBpbnQgc211X2Rpc2FibGVfZHBtcyhzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSkKPj4gICAgCXVpbnQ2NF90IGZlYXR1cmVzX3RvX2Rpc2FibGU7Cj4+ICAgIAlpbnQg
cmV0ID0gMDsKPj4gICAgCWJvb2wgdXNlX2JhY28gPSAhc211LT5pc19hcHUgJiYKPj4gLQkJKChh
ZGV2LT5pbl9ncHVfcmVzZXQgJiYKPj4gKwkJKChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jl
c2V0KSAmJgo+PiAgICAJCSAgKGFtZGdwdV9hc2ljX3Jlc2V0X21ldGhvZChhZGV2KSA9PSBBTURf
UkVTRVRfTUVUSE9EX0JBQ08pKSB8fAo+PiAgICAJCSAoKGFkZXYtPmluX3J1bnBtIHx8IGFkZXYt
PmluX2hpYmVybmF0ZSkgJiYgYW1kZ3B1X2FzaWNfc3VwcG9ydHNfYmFjbyhhZGV2KSkpOwo+PiAg
ICAKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2h3bWdyL3Zl
Z2EyMF9od21nci5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaHdtZ3IvdmVnYTIw
X2h3bWdyLmMKPj4gaW5kZXggM2I4ODM5NjQxNzcwLi4xM2UzMDQwNjZkOTQgMTAwNjQ0Cj4+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2h3bWdyL3ZlZ2EyMF9od21nci5jCj4+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2h3bWdyL3ZlZ2EyMF9od21nci5j
Cj4+IEBAIC00ODQsNyArNDg0LDcgQEAgc3RhdGljIGludCB2ZWdhMjBfc2V0dXBfYXNpY190YXNr
KHN0cnVjdCBwcF9od21nciAqaHdtZ3IpCj4+ICAgIHsKPj4gICAgCXN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2ID0gKHN0cnVjdCBhbWRncHVfZGV2aWNlICopKGh3bWdyLT5hZGV2KTsKPj4gICAg
CWludCByZXQgPSAwOwo+PiAtCWJvb2wgdXNlX2JhY28gPSAoYWRldi0+aW5fZ3B1X3Jlc2V0ICYm
Cj4+ICsJYm9vbCB1c2VfYmFjbyA9IChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSAm
Jgo+PiAgICAJCQkgKGFtZGdwdV9hc2ljX3Jlc2V0X21ldGhvZChhZGV2KSA9PSBBTURfUkVTRVRf
TUVUSE9EX0JBQ08pKSB8fAo+PiAgICAJCShhZGV2LT5pbl9ydW5wbSAmJiBhbWRncHVfYXNpY19z
dXBwb3J0c19iYWNvKGFkZXYpKTsKPj4gICAgCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vYW1kLWdmeAo=
