Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 81EBF5807F
	for <lists+amd-gfx@lfdr.de>; Thu, 27 Jun 2019 12:36:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E3BA66E12D;
	Thu, 27 Jun 2019 10:36:12 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM03-CO1-obe.outbound.protection.outlook.com
 (mail-eopbgr790079.outbound.protection.outlook.com [40.107.79.79])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1DB766E13C
 for <amd-gfx@lists.freedesktop.org>; Thu, 27 Jun 2019 10:36:12 +0000 (UTC)
Received: from CH2PR12CA0028.namprd12.prod.outlook.com (2603:10b6:610:57::38)
 by BN8PR12MB2913.namprd12.prod.outlook.com (2603:10b6:408:9c::33)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2008.16; Thu, 27 Jun
 2019 10:36:05 +0000
Received: from BY2NAM03FT050.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e4a::202) by CH2PR12CA0028.outlook.office365.com
 (2603:10b6:610:57::38) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.2008.16 via Frontend
 Transport; Thu, 27 Jun 2019 10:36:05 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV01.amd.com (165.204.84.17) by
 BY2NAM03FT050.mail.protection.outlook.com (10.152.85.137) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.2032.15 via Frontend Transport; Thu, 27 Jun 2019 10:36:04 +0000
Received: from prike.amd.com (10.34.1.3) by SATLEXCHOV01.amd.com
 (10.181.40.71) with Microsoft SMTP Server (TLS) id 14.3.389.1; Thu, 27 Jun
 2019 05:35:59 -0500
From: Prike Liang <Prike.Liang@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH] drm/amd/powerplay:Move powerplay table implement to pptable
 centralized management
Date: Thu, 27 Jun 2019 18:35:48 +0800
Message-ID: <1561631748-14861-1-git-send-email-Prike.Liang@amd.com>
X-Mailer: git-send-email 2.7.4
MIME-Version: 1.0
X-Originating-IP: [10.34.1.3]
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(376002)(39860400002)(136003)(346002)(396003)(2980300002)(428003)(189003)(199004)(50226002)(4326008)(7696005)(3846002)(2906002)(68736007)(476003)(8936002)(6666004)(54906003)(14444005)(356004)(5660300002)(81156014)(126002)(47776003)(426003)(86362001)(16586007)(51416003)(81166006)(486006)(8676002)(2616005)(316002)(336012)(77096007)(186003)(53416004)(72206003)(48376002)(50466002)(66574012)(70206006)(30864003)(2351001)(16526019)(478600001)(6116002)(53936002)(7736002)(53946003)(36756003)(6916009)(305945005)(70586007)(26005)(559001)(579004)(569006);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BN8PR12MB2913; H:SATLEXCHOV01.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; MX:1; A:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 3c2f2a59-47e5-49ed-b44b-08d6faeb41e9
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328)(7193020);
 SRVR:BN8PR12MB2913; 
X-MS-TrafficTypeDiagnostic: BN8PR12MB2913:
X-Microsoft-Antispam-PRVS: <BN8PR12MB291379A72D21207EA3F95EFDFBFD0@BN8PR12MB2913.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:7691;
X-Forefront-PRVS: 008184426E
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: 5Sji1xHHO+m5w9asu+jqZ1zUxXb0M5CdPQj7Fjo4fgZsMWlrzLRnxehpvKSmNutSDtXH0k20Dann/9W2vLx5za29lWHZEBFuVTQxtbwMnfAC9W9sdRj0/NLblkoE8//VMbZz10IG9Tu7VNpSnjEt5I3lYK2jV+oZT4k402daJLtfVZRc2OdWyQamOVe/vVERZZ0eVwl3s8oYBtKyxyDGQqroFbAgG3IzKnIOPFq0AKh65ezzigdqBz9afIuLx+Sx8Rhj6euNWoQBJZXaPjc+GX6usH8m8x51r9qZuoRhDg3BjgIcHHhcAOo2JdWBEI/5UpHxzHW9trk7ImGpwxayCscSWYvSbeGbhLwyliLgDZfyUKfUd2p3PTUfVHPLgbGXkpeQUSKwthgqSnGPvGHuoHPsRvjG37h3lum5i8LTGE0=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 27 Jun 2019 10:36:04.7315 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 3c2f2a59-47e5-49ed-b44b-08d6faeb41e9
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV01.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN8PR12MB2913
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=Z8fZPdhhFEpWSWLKsBTO22Hfdyl1x/4vfqlLeckHEjE=;
 b=IJHioaxNOfScUDmPLRHYm7m8xqavZEx6QW2xHMfgLygqca0uYe4S7kpdn5HGKOIF61CaOxC4RrNRyrMt1XBOdDaPuM15y9U+RiwxizILbKCrQXAAVdGabxkS2uyzFG9YXNS4yj/xxao9Cl+YFHYtJzHXre1Whuqz0E7JvH3oqA8=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: kenneth.feng@amd.com, Prike
 Liang <Prike.Liang@amd.com>, Evan.Quan@amd.com, Ray.Huang@amd.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

Y2VudHJhbGl6ZWQgbWFuYWdlIHBvd2VycGxheSB0YWJsZSByZWxhdGVkIGZ1bmN0aW9ucyB0byBh
dm9pZAp2YXJpb3VzIHByb2R1Y3RzIG1lc3MgdXAgcm9vdCBwbGFjZW1lbnQgb2YgcG93ZXJwbGF5
LgoKQ2hhbmdlLUlkOiBJM2QyMzAyMWNjYjVlZjVmZDdmZmU4OTZhNjQ1ODE4NzZkMzQwOWQ1YgpT
aWduZWQtb2ZmLWJ5OiBQcmlrZSBMaWFuZyA8UHJpa2UuTGlhbmdAYW1kLmNvbT4KLS0tCiBkcml2
ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9NYWtlZmlsZSAgICAgICAgICAgICB8ICAgIDcgKy0K
IGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25hdmkxMF9wcHQuYyAgICAgICAgIHwgMTUx
NCAtLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25hdmkxMF9wcHQuaCAg
ICAgICAgIHwgICAyOCAtCiBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9wcHRhYmxlL01h
a2VmaWxlICAgICB8ICAgMzAgKwogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcHB0YWJs
ZS9uYXZpMTBfcHB0LmMgfCAxNTE0ICsrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dl
cnBsYXkvcHB0YWJsZS9uYXZpMTBfcHB0LmggfCAgIDI4ICsKIGRyaXZlcnMvZ3B1L2RybS9hbWQv
cG93ZXJwbGF5L3BwdGFibGUvdmVnYTIwX3BwdC5jIHwgMzMwMiArKysrKysrKysrKysrKysrKysr
KwogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcHB0YWJsZS92ZWdhMjBfcHB0LmggfCAg
MTc5ICsrCiBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92ZWdhMjBfcHB0LmMgICAgICAg
ICB8IDMzMDIgLS0tLS0tLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJw
bGF5L3ZlZ2EyMF9wcHQuaCAgICAgICAgIHwgIDE3OSAtLQogMTAgZmlsZXMgY2hhbmdlZCwgNTA1
NyBpbnNlcnRpb25zKCspLCA1MDI2IGRlbGV0aW9ucygtKQogZGVsZXRlIG1vZGUgMTAwNjQ0IGRy
aXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25hdmkxMF9wcHQuYwogZGVsZXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25hdmkxMF9wcHQuaAogY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3BwdGFibGUvTWFrZWZpbGUK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9wcHRhYmxl
L25hdmkxMF9wcHQuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93
ZXJwbGF5L3BwdGFibGUvbmF2aTEwX3BwdC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9n
cHUvZHJtL2FtZC9wb3dlcnBsYXkvcHB0YWJsZS92ZWdhMjBfcHB0LmMKIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9wcHRhYmxlL3ZlZ2EyMF9wcHQuaAog
ZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3ZlZ2EyMF9w
cHQuYwogZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3Zl
Z2EyMF9wcHQuaAoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L01h
a2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvTWFrZWZpbGUKaW5kZXggNzI3
YzVjZi4uYzI3M2MyNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkv
TWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvTWFrZWZpbGUKQEAg
LTI1LDE3ICsyNSwxOCBAQCBzdWJkaXItY2NmbGFncy15ICs9IFwKIAkJLUkkKEZVTExfQU1EX1BB
VEgpL2luY2x1ZGUvYXNpY19yZWcgIFwKIAkJLUkkKEZVTExfQU1EX1BBVEgpL2luY2x1ZGUgIFwK
IAkJLUkkKEZVTExfQU1EX1BBVEgpL3Bvd2VycGxheS9zbXVtZ3JcCi0JCS1JJChGVUxMX0FNRF9Q
QVRIKS9wb3dlcnBsYXkvaHdtZ3IKKwkJLUkkKEZVTExfQU1EX1BBVEgpL3Bvd2VycGxheS9od21n
ciBcCisJCS1JJChGVUxMX0FNRF9QQVRIKS9wb3dlcnBsYXkvcHB0YWJsZQogCiBBTURfUFBfUEFU
SCA9IC4uL3Bvd2VycGxheQogCi1QUF9MSUJTID0gc211bWdyIGh3bWdyCitQUF9MSUJTID0gc211
bWdyIGh3bWdyIHBwdGFibGUKIAogQU1EX1BPV0VSUExBWSA9ICQoYWRkc3VmZml4IC9NYWtlZmls
ZSwkKGFkZHByZWZpeCAkKEZVTExfQU1EX1BBVEgpL3Bvd2VycGxheS8sJChQUF9MSUJTKSkpCiAK
IGluY2x1ZGUgJChBTURfUE9XRVJQTEFZKQogCi1QT1dFUl9NR1IgPSBhbWRfcG93ZXJwbGF5Lm8g
YW1kZ3B1X3NtdS5vIHNtdV92MTFfMC5vIHZlZ2EyMF9wcHQubyBuYXZpMTBfcHB0Lm8KK1BPV0VS
X01HUiA9IGFtZF9wb3dlcnBsYXkubyBhbWRncHVfc211Lm8gc211X3YxMV8wLm8KIAogQU1EX1BQ
X1BPV0VSID0gJChhZGRwcmVmaXggJChBTURfUFBfUEFUSCkvLCQoUE9XRVJfTUdSKSkKIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvbmF2aTEwX3BwdC5jIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvbmF2aTEwX3BwdC5jCmRlbGV0ZWQgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCA5OTU2NmRlLi4wMDAwMDAwCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
cG93ZXJwbGF5L25hdmkxMF9wcHQuYworKysgL2Rldi9udWxsCkBAIC0xLDE1MTQgKzAsMCBAQAot
LyoKLSAqIENvcHlyaWdodCAyMDE5IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KLSAqCi0g
KiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBl
cnNvbiBvYnRhaW5pbmcgYQotICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVk
IGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKLSAqIHRvIGRlYWwgaW4gdGhl
IFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRp
b24KLSAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBk
aXN0cmlidXRlLCBzdWJsaWNlbnNlLAotICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0
d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCi0gKiBTb2Z0d2FyZSBpcyBm
dXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgot
ICoKLSAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90
aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCi0gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBv
cnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KLSAqCi0gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQg
IkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgotICogSU1Q
TElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJD
SEFOVEFCSUxJVFksCi0gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9O
SU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKLSAqIFRIRSBDT1BZUklHSFQgSE9MREVS
KFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgotICog
T1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBP
UiBPVEhFUldJU0UsCi0gKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJ
VEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKLSAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBT
T0ZUV0FSRS4KLSAqCi0gKi8KLQotI2luY2x1ZGUgInBwX2RlYnVnLmgiCi0jaW5jbHVkZSA8bGlu
dXgvZmlybXdhcmUuaD4KLSNpbmNsdWRlICJhbWRncHUuaCIKLSNpbmNsdWRlICJhbWRncHVfc211
LmgiCi0jaW5jbHVkZSAiYXRvbWZpcm13YXJlLmgiCi0jaW5jbHVkZSAiYW1kZ3B1X2F0b21maXJt
d2FyZS5oIgotI2luY2x1ZGUgInNtdV92MTFfMC5oIgotI2luY2x1ZGUgInNtdTExX2RyaXZlcl9p
Zl9uYXZpMTAuaCIKLSNpbmNsdWRlICJzb2MxNV9jb21tb24uaCIKLSNpbmNsdWRlICJhdG9tLmgi
Ci0jaW5jbHVkZSAibmF2aTEwX3BwdC5oIgotI2luY2x1ZGUgInNtdV92MTFfMF9wcHRhYmxlLmgi
Ci0jaW5jbHVkZSAic211X3YxMV8wX3Bwc21jLmgiCi0KLSNpbmNsdWRlICJhc2ljX3JlZy9tcC9t
cF8xMV8wX3NoX21hc2suaCIKLQotI2RlZmluZSBGRUFUVVJFX01BU0soZmVhdHVyZSkgKDFVTEwg
PDwgZmVhdHVyZSkKLSNkZWZpbmUgU01DX0RQTV9GRUFUVVJFICggXAotCUZFQVRVUkVfTUFTSyhG
RUFUVVJFX0RQTV9QUkVGRVRDSEVSX0JJVCkgfCBcCi0JRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBN
X0dGWENMS19CSVQpCSB8IFwKLQlGRUFUVVJFX01BU0soRkVBVFVSRV9EUE1fR0ZYX1BBQ0VfQklU
KQkgfCBcCi0JRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX1VDTEtfQklUKQkgfCBcCi0JRkVBVFVS
RV9NQVNLKEZFQVRVUkVfRFBNX1NPQ0NMS19CSVQpCSB8IFwKLQlGRUFUVVJFX01BU0soRkVBVFVS
RV9EUE1fTVAwQ0xLX0JJVCkJIHwgXAotCUZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9MSU5LX0JJ
VCkJIHwgXAotCUZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9EQ0VGQ0xLX0JJVCkpCi0KLSNkZWZp
bmUgTVNHX01BUChtc2csIGluZGV4KSBcCi0JW1NNVV9NU0dfIyNtc2ddID0gaW5kZXgKLQotc3Rh
dGljIGludCBuYXZpMTBfbWVzc2FnZV9tYXBbU01VX01TR19NQVhfQ09VTlRdID0gewotCU1TR19N
QVAoVGVzdE1lc3NhZ2UsCQkJUFBTTUNfTVNHX1Rlc3RNZXNzYWdlKSwKLQlNU0dfTUFQKEdldFNt
dVZlcnNpb24sCQkJUFBTTUNfTVNHX0dldFNtdVZlcnNpb24pLAotCU1TR19NQVAoR2V0RHJpdmVy
SWZWZXJzaW9uLAkJUFBTTUNfTVNHX0dldERyaXZlcklmVmVyc2lvbiksCi0JTVNHX01BUChTZXRB
bGxvd2VkRmVhdHVyZXNNYXNrTG93LAlQUFNNQ19NU0dfU2V0QWxsb3dlZEZlYXR1cmVzTWFza0xv
dyksCi0JTVNHX01BUChTZXRBbGxvd2VkRmVhdHVyZXNNYXNrSGlnaCwJUFBTTUNfTVNHX1NldEFs
bG93ZWRGZWF0dXJlc01hc2tIaWdoKSwKLQlNU0dfTUFQKEVuYWJsZUFsbFNtdUZlYXR1cmVzLAkJ
UFBTTUNfTVNHX0VuYWJsZUFsbFNtdUZlYXR1cmVzKSwKLQlNU0dfTUFQKERpc2FibGVBbGxTbXVG
ZWF0dXJlcywJCVBQU01DX01TR19EaXNhYmxlQWxsU211RmVhdHVyZXMpLAotCU1TR19NQVAoRW5h
YmxlU211RmVhdHVyZXNMb3csCQlQUFNNQ19NU0dfRW5hYmxlU211RmVhdHVyZXNMb3cpLAotCU1T
R19NQVAoRW5hYmxlU211RmVhdHVyZXNIaWdoLAkJUFBTTUNfTVNHX0VuYWJsZVNtdUZlYXR1cmVz
SGlnaCksCi0JTVNHX01BUChEaXNhYmxlU211RmVhdHVyZXNMb3csCQlQUFNNQ19NU0dfRGlzYWJs
ZVNtdUZlYXR1cmVzTG93KSwKLQlNU0dfTUFQKERpc2FibGVTbXVGZWF0dXJlc0hpZ2gsCQlQUFNN
Q19NU0dfRGlzYWJsZVNtdUZlYXR1cmVzSGlnaCksCi0JTVNHX01BUChHZXRFbmFibGVkU211RmVh
dHVyZXNMb3csCVBQU01DX01TR19HZXRFbmFibGVkU211RmVhdHVyZXNMb3cpLAotCU1TR19NQVAo
R2V0RW5hYmxlZFNtdUZlYXR1cmVzSGlnaCwJUFBTTUNfTVNHX0dldEVuYWJsZWRTbXVGZWF0dXJl
c0hpZ2gpLAotCU1TR19NQVAoU2V0V29ya2xvYWRNYXNrLAkJUFBTTUNfTVNHX1NldFdvcmtsb2Fk
TWFzayksCi0JTVNHX01BUChTZXRQcHRMaW1pdCwJCQlQUFNNQ19NU0dfU2V0UHB0TGltaXQpLAot
CU1TR19NQVAoU2V0RHJpdmVyRHJhbUFkZHJIaWdoLAkJUFBTTUNfTVNHX1NldERyaXZlckRyYW1B
ZGRySGlnaCksCi0JTVNHX01BUChTZXREcml2ZXJEcmFtQWRkckxvdywJCVBQU01DX01TR19TZXRE
cml2ZXJEcmFtQWRkckxvdyksCi0JTVNHX01BUChTZXRUb29sc0RyYW1BZGRySGlnaCwJCVBQU01D
X01TR19TZXRUb29sc0RyYW1BZGRySGlnaCksCi0JTVNHX01BUChTZXRUb29sc0RyYW1BZGRyTG93
LAkJUFBTTUNfTVNHX1NldFRvb2xzRHJhbUFkZHJMb3cpLAotCU1TR19NQVAoVHJhbnNmZXJUYWJs
ZVNtdTJEcmFtLAkJUFBTTUNfTVNHX1RyYW5zZmVyVGFibGVTbXUyRHJhbSksCi0JTVNHX01BUChU
cmFuc2ZlclRhYmxlRHJhbTJTbXUsCQlQUFNNQ19NU0dfVHJhbnNmZXJUYWJsZURyYW0yU211KSwK
LQlNU0dfTUFQKFVzZURlZmF1bHRQUFRhYmxlLAkJUFBTTUNfTVNHX1VzZURlZmF1bHRQUFRhYmxl
KSwKLQlNU0dfTUFQKFVzZUJhY2t1cFBQVGFibGUsCQlQUFNNQ19NU0dfVXNlQmFja3VwUFBUYWJs
ZSksCi0JTVNHX01BUChSdW5CdGMsCQkJCVBQU01DX01TR19SdW5CdGMpLAotCU1TR19NQVAoRW50
ZXJCYWNvLAkJCVBQU01DX01TR19FbnRlckJhY28pLAotCU1TR19NQVAoU2V0U29mdE1pbkJ5RnJl
cSwJCVBQU01DX01TR19TZXRTb2Z0TWluQnlGcmVxKSwKLQlNU0dfTUFQKFNldFNvZnRNYXhCeUZy
ZXEsCQlQUFNNQ19NU0dfU2V0U29mdE1heEJ5RnJlcSksCi0JTVNHX01BUChTZXRIYXJkTWluQnlG
cmVxLAkJUFBTTUNfTVNHX1NldEhhcmRNaW5CeUZyZXEpLAotCU1TR19NQVAoU2V0SGFyZE1heEJ5
RnJlcSwJCVBQU01DX01TR19TZXRIYXJkTWF4QnlGcmVxKSwKLQlNU0dfTUFQKEdldE1pbkRwbUZy
ZXEsCQkJUFBTTUNfTVNHX0dldE1pbkRwbUZyZXEpLAotCU1TR19NQVAoR2V0TWF4RHBtRnJlcSwJ
CQlQUFNNQ19NU0dfR2V0TWF4RHBtRnJlcSksCi0JTVNHX01BUChHZXREcG1GcmVxQnlJbmRleCwJ
CVBQU01DX01TR19HZXREcG1GcmVxQnlJbmRleCksCi0JTVNHX01BUChTZXRNZW1vcnlDaGFubmVs
Q29uZmlnLAkJUFBTTUNfTVNHX1NldE1lbW9yeUNoYW5uZWxDb25maWcpLAotCU1TR19NQVAoU2V0
R2VtaW5pTW9kZSwJCQlQUFNNQ19NU0dfU2V0R2VtaW5pTW9kZSksCi0JTVNHX01BUChTZXRHZW1p
bmlBcGVydHVyZUhpZ2gsCQlQUFNNQ19NU0dfU2V0R2VtaW5pQXBlcnR1cmVIaWdoKSwKLQlNU0df
TUFQKFNldEdlbWluaUFwZXJ0dXJlTG93LAkJUFBTTUNfTVNHX1NldEdlbWluaUFwZXJ0dXJlTG93
KSwKLQlNU0dfTUFQKE92ZXJyaWRlUGNpZVBhcmFtZXRlcnMsCQlQUFNNQ19NU0dfT3ZlcnJpZGVQ
Y2llUGFyYW1ldGVycyksCi0JTVNHX01BUChTZXRNaW5EZWVwU2xlZXBEY2VmY2xrLAkJUFBTTUNf
TVNHX1NldE1pbkRlZXBTbGVlcERjZWZjbGspLAotCU1TR19NQVAoUmVlbmFibGVBY0RjSW50ZXJy
dXB0LAkJUFBTTUNfTVNHX1JlZW5hYmxlQWNEY0ludGVycnVwdCksCi0JTVNHX01BUChOb3RpZnlQ
b3dlclNvdXJjZSwJCVBQU01DX01TR19Ob3RpZnlQb3dlclNvdXJjZSksCi0JTVNHX01BUChTZXRV
Y2xrRmFzdFN3aXRjaCwJCVBQU01DX01TR19TZXRVY2xrRmFzdFN3aXRjaCksCi0JTVNHX01BUChT
ZXRWaWRlb0ZwcywJCQlQUFNNQ19NU0dfU2V0VmlkZW9GcHMpLAotCU1TR19NQVAoUHJlcGFyZU1w
MUZvclVubG9hZCwJCVBQU01DX01TR19QcmVwYXJlTXAxRm9yVW5sb2FkKSwKLQlNU0dfTUFQKERy
YW1Mb2dTZXREcmFtQWRkckhpZ2gsCQlQUFNNQ19NU0dfRHJhbUxvZ1NldERyYW1BZGRySGlnaCks
Ci0JTVNHX01BUChEcmFtTG9nU2V0RHJhbUFkZHJMb3csCQlQUFNNQ19NU0dfRHJhbUxvZ1NldERy
YW1BZGRyTG93KSwKLQlNU0dfTUFQKERyYW1Mb2dTZXREcmFtU2l6ZSwJCVBQU01DX01TR19EcmFt
TG9nU2V0RHJhbVNpemUpLAotCU1TR19NQVAoQ29uZmlndXJlR2Z4RGlkdCwJCVBQU01DX01TR19D
b25maWd1cmVHZnhEaWR0KSwKLQlNU0dfTUFQKE51bU9mRGlzcGxheXMsCQkJUFBTTUNfTVNHX051
bU9mRGlzcGxheXMpLAotCU1TR19NQVAoU2V0U3lzdGVtVmlydHVhbERyYW1BZGRySGlnaCwJUFBT
TUNfTVNHX1NldFN5c3RlbVZpcnR1YWxEcmFtQWRkckhpZ2gpLAotCU1TR19NQVAoU2V0U3lzdGVt
VmlydHVhbERyYW1BZGRyTG93LAlQUFNNQ19NU0dfU2V0U3lzdGVtVmlydHVhbERyYW1BZGRyTG93
KSwKLQlNU0dfTUFQKEFsbG93R2Z4T2ZmLAkJCVBQU01DX01TR19BbGxvd0dmeE9mZiksCi0JTVNH
X01BUChEaXNhbGxvd0dmeE9mZiwJCQlQUFNNQ19NU0dfRGlzYWxsb3dHZnhPZmYpLAotCU1TR19N
QVAoR2V0UHB0TGltaXQsCQkJUFBTTUNfTVNHX0dldFBwdExpbWl0KSwKLQlNU0dfTUFQKEdldERj
TW9kZU1heERwbUZyZXEsCQlQUFNNQ19NU0dfR2V0RGNNb2RlTWF4RHBtRnJlcSksCi0JTVNHX01B
UChHZXREZWJ1Z0RhdGEsCQkJUFBTTUNfTVNHX0dldERlYnVnRGF0YSksCi0JTVNHX01BUChFeGl0
QmFjbywJCQlQUFNNQ19NU0dfRXhpdEJhY28pLAotCU1TR19NQVAoUHJlcGFyZU1wMUZvclJlc2V0
LAkJUFBTTUNfTVNHX1ByZXBhcmVNcDFGb3JSZXNldCksCi0JTVNHX01BUChQcmVwYXJlTXAxRm9y
U2h1dGRvd24sCQlQUFNNQ19NU0dfUHJlcGFyZU1wMUZvclNodXRkb3duKSwKLQlNU0dfTUFQKFBv
d2VyVXBWY24sCQlQUFNNQ19NU0dfUG93ZXJVcFZjbiksCi0JTVNHX01BUChQb3dlckRvd25WY24s
CQlQUFNNQ19NU0dfUG93ZXJEb3duVmNuKSwKLQlNU0dfTUFQKFBvd2VyVXBKcGVnLAkJUFBTTUNf
TVNHX1Bvd2VyVXBKcGVnKSwKLQlNU0dfTUFQKFBvd2VyRG93bkpwZWcsCQlQUFNNQ19NU0dfUG93
ZXJEb3duSnBlZyksCi0JTVNHX01BUChCYWNvQXVkaW9EM1BNRSwJCVBQU01DX01TR19CYWNvQXVk
aW9EM1BNRSksCi19OwotCi1zdGF0aWMgaW50IG5hdmkxMF9jbGtfbWFwW1NNVV9DTEtfQ09VTlRd
ID0gewotCUNMS19NQVAoR0ZYQ0xLLCBQUENMS19HRlhDTEspLAotCUNMS19NQVAoU0NMSywJUFBD
TEtfR0ZYQ0xLKSwKLQlDTEtfTUFQKFNPQ0NMSywgUFBDTEtfU09DQ0xLKSwKLQlDTEtfTUFQKEZD
TEssIFBQQ0xLX1NPQ0NMSyksCi0JQ0xLX01BUChVQ0xLLCBQUENMS19VQ0xLKSwKLQlDTEtfTUFQ
KE1DTEssIFBQQ0xLX1VDTEspLAotCUNMS19NQVAoRENMSywgUFBDTEtfRENMSyksCi0JQ0xLX01B
UChWQ0xLLCBQUENMS19WQ0xLKSwKLQlDTEtfTUFQKERDRUZDTEssIFBQQ0xLX0RDRUZDTEspLAot
CUNMS19NQVAoRElTUENMSywgUFBDTEtfRElTUENMSyksCi0JQ0xLX01BUChQSVhDTEssIFBQQ0xL
X1BJWENMSyksCi0JQ0xLX01BUChQSFlDTEssIFBQQ0xLX1BIWUNMSyksCi19OwotCi1zdGF0aWMg
aW50IG5hdmkxMF9mZWF0dXJlX21hc2tfbWFwW1NNVV9GRUFUVVJFX0NPVU5UXSA9IHsKLQlGRUFf
TUFQKERQTV9QUkVGRVRDSEVSKSwKLQlGRUFfTUFQKERQTV9HRlhDTEspLAotCUZFQV9NQVAoRFBN
X0dGWF9QQUNFKSwKLQlGRUFfTUFQKERQTV9VQ0xLKSwKLQlGRUFfTUFQKERQTV9TT0NDTEspLAot
CUZFQV9NQVAoRFBNX01QMENMSyksCi0JRkVBX01BUChEUE1fTElOSyksCi0JRkVBX01BUChEUE1f
RENFRkNMSyksCi0JRkVBX01BUChNRU1fVkREQ0lfU0NBTElORyksCi0JRkVBX01BUChNRU1fTVZE
RF9TQ0FMSU5HKSwKLQlGRUFfTUFQKERTX0dGWENMSyksCi0JRkVBX01BUChEU19TT0NDTEspLAot
CUZFQV9NQVAoRFNfTENMSyksCi0JRkVBX01BUChEU19EQ0VGQ0xLKSwKLQlGRUFfTUFQKERTX1VD
TEspLAotCUZFQV9NQVAoR0ZYX1VMViksCi0JRkVBX01BUChGV19EU1RBVEUpLAotCUZFQV9NQVAo
R0ZYT0ZGKSwKLQlGRUFfTUFQKEJBQ08pLAotCUZFQV9NQVAoVkNOX1BHKSwKLQlGRUFfTUFQKEpQ
RUdfUEcpLAotCUZFQV9NQVAoVVNCX1BHKSwKLQlGRUFfTUFQKFJTTVVfU01OX0NHKSwKLQlGRUFf
TUFQKFBQVCksCi0JRkVBX01BUChUREMpLAotCUZFQV9NQVAoR0ZYX0VEQyksCi0JRkVBX01BUChB
UENDX1BMVVMpLAotCUZFQV9NQVAoR1RIUiksCi0JRkVBX01BUChBQ0RDKSwKLQlGRUFfTUFQKFZS
MEhPVCksCi0JRkVBX01BUChWUjFIT1QpLAotCUZFQV9NQVAoRldfQ1RGKSwKLQlGRUFfTUFQKEZB
Tl9DT05UUk9MKSwKLQlGRUFfTUFQKFRIRVJNQUwpLAotCUZFQV9NQVAoR0ZYX0RDUyksCi0JRkVB
X01BUChSTSksCi0JRkVBX01BUChMRURfRElTUExBWSksCi0JRkVBX01BUChHRlhfU1MpLAotCUZF
QV9NQVAoT1VUX09GX0JBTkRfTU9OSVRPUiksCi0JRkVBX01BUChURU1QX0RFUEVOREVOVF9WTUlO
KSwKLQlGRUFfTUFQKE1NSFVCX1BHKSwKLQlGRUFfTUFQKEFUSFVCX1BHKSwKLX07Ci0KLXN0YXRp
YyBpbnQgbmF2aTEwX3RhYmxlX21hcFtTTVVfVEFCTEVfQ09VTlRdID0gewotCVRBQl9NQVAoUFBU
QUJMRSksCi0JVEFCX01BUChXQVRFUk1BUktTKSwKLQlUQUJfTUFQKEFWRlMpLAotCVRBQl9NQVAo
QVZGU19QU01fREVCVUcpLAotCVRBQl9NQVAoQVZGU19GVVNFX09WRVJSSURFKSwKLQlUQUJfTUFQ
KFBNU1RBVFVTTE9HKSwKLQlUQUJfTUFQKFNNVV9NRVRSSUNTKSwKLQlUQUJfTUFQKERSSVZFUl9T
TVVfQ09ORklHKSwKLQlUQUJfTUFQKEFDVElWSVRZX01PTklUT1JfQ09FRkYpLAotCVRBQl9NQVAo
T1ZFUkRSSVZFKSwKLQlUQUJfTUFQKEkyQ19DT01NQU5EUyksCi0JVEFCX01BUChQQUNFKSwKLX07
Ci0KLXN0YXRpYyBpbnQgbmF2aTEwX3B3cl9zcmNfbWFwW1NNVV9QT1dFUl9TT1VSQ0VfQ09VTlRd
ID0gewotCVBXUl9NQVAoQUMpLAotCVBXUl9NQVAoREMpLAotfTsKLQotc3RhdGljIGludCBuYXZp
MTBfd29ya2xvYWRfbWFwW10gPSB7Ci0JV09SS0xPQURfTUFQKFBQX1NNQ19QT1dFUl9QUk9GSUxF
X0JPT1RVUF9ERUZBVUxULAlXT1JLTE9BRF9QUExJQl9ERUZBVUxUX0JJVCksCi0JV09SS0xPQURf
TUFQKFBQX1NNQ19QT1dFUl9QUk9GSUxFX0ZVTExTQ1JFRU4zRCwJCVdPUktMT0FEX1BQTElCX0ZV
TExfU0NSRUVOXzNEX0JJVCksCi0JV09SS0xPQURfTUFQKFBQX1NNQ19QT1dFUl9QUk9GSUxFX1BP
V0VSU0FWSU5HLAkJV09SS0xPQURfUFBMSUJfUE9XRVJfU0FWSU5HX0JJVCksCi0JV09SS0xPQURf
TUFQKFBQX1NNQ19QT1dFUl9QUk9GSUxFX1ZJREVPLAkJV09SS0xPQURfUFBMSUJfVklERU9fQklU
KSwKLQlXT1JLTE9BRF9NQVAoUFBfU01DX1BPV0VSX1BST0ZJTEVfVlIsCQkJV09SS0xPQURfUFBM
SUJfVlJfQklUKSwKLQlXT1JLTE9BRF9NQVAoUFBfU01DX1BPV0VSX1BST0ZJTEVfQ09NUFVURSwJ
CVdPUktMT0FEX1BQTElCX0NVU1RPTV9CSVQpLAotCVdPUktMT0FEX01BUChQUF9TTUNfUE9XRVJf
UFJPRklMRV9DVVNUT00sCQlXT1JLTE9BRF9QUExJQl9DVVNUT01fQklUKSwKLX07Ci0KLXN0YXRp
YyBpbnQgbmF2aTEwX2dldF9zbXVfbXNnX2luZGV4KHN0cnVjdCBzbXVfY29udGV4dCAqc21jLCB1
aW50MzJfdCBpbmRleCkKLXsKLQlpbnQgdmFsOwotCWlmIChpbmRleCA+IFNNVV9NU0dfTUFYX0NP
VU5UKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCXZhbCA9IG5hdmkxMF9tZXNzYWdlX21hcFtpbmRl
eF07Ci0JaWYgKHZhbCA+IFBQU01DX01lc3NhZ2VfQ291bnQpCi0JCXJldHVybiAtRUlOVkFMOwot
Ci0JcmV0dXJuIHZhbDsKLX0KLQotc3RhdGljIGludCBuYXZpMTBfZ2V0X3NtdV9jbGtfaW5kZXgo
c3RydWN0IHNtdV9jb250ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4KQotewotCWludCB2YWw7Ci0J
aWYgKGluZGV4ID49IFNNVV9DTEtfQ09VTlQpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JdmFsID0g
bmF2aTEwX2Nsa19tYXBbaW5kZXhdOwotCWlmICh2YWwgPj0gUFBDTEtfQ09VTlQpCi0JCXJldHVy
biAtRUlOVkFMOwotCi0JcmV0dXJuIHZhbDsKLX0KLQotc3RhdGljIGludCBuYXZpMTBfZ2V0X3Nt
dV9mZWF0dXJlX2luZGV4KHN0cnVjdCBzbXVfY29udGV4dCAqc21jLCB1aW50MzJfdCBpbmRleCkK
LXsKLQlpbnQgdmFsOwotCWlmIChpbmRleCA+PSBTTVVfRkVBVFVSRV9DT1VOVCkKLQkJcmV0dXJu
IC1FSU5WQUw7Ci0KLQl2YWwgPSBuYXZpMTBfZmVhdHVyZV9tYXNrX21hcFtpbmRleF07Ci0JaWYg
KHZhbCA+IDY0KQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCXJldHVybiB2YWw7Ci19Ci0KLXN0YXRp
YyBpbnQgbmF2aTEwX2dldF9zbXVfdGFibGVfaW5kZXgoc3RydWN0IHNtdV9jb250ZXh0ICpzbWMs
IHVpbnQzMl90IGluZGV4KQotewotCWludCB2YWw7Ci0JaWYgKGluZGV4ID49IFNNVV9UQUJMRV9D
T1VOVCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQl2YWwgPSBuYXZpMTBfdGFibGVfbWFwW2luZGV4
XTsKLQlpZiAodmFsID49IFRBQkxFX0NPVU5UKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCXJldHVy
biB2YWw7Ci19Ci0KLXN0YXRpYyBpbnQgbmF2aTEwX2dldF9wd3Jfc3JjX2luZGV4KHN0cnVjdCBz
bXVfY29udGV4dCAqc21jLCB1aW50MzJfdCBpbmRleCkKLXsKLQlpbnQgdmFsOwotCWlmIChpbmRl
eCA+PSBTTVVfUE9XRVJfU09VUkNFX0NPVU5UKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCXZhbCA9
IG5hdmkxMF9wd3Jfc3JjX21hcFtpbmRleF07Ci0JaWYgKHZhbCA+PSBQT1dFUl9TT1VSQ0VfQ09V
TlQpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JcmV0dXJuIHZhbDsKLX0KLQotCi1zdGF0aWMgaW50
IG5hdmkxMF9nZXRfd29ya2xvYWRfdHlwZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBQ
UF9TTUNfUE9XRVJfUFJPRklMRSBwcm9maWxlKQotewotCWludCB2YWw7Ci0JaWYgKHByb2ZpbGUg
PiBQUF9TTUNfUE9XRVJfUFJPRklMRV9DVVNUT00pCi0JCXJldHVybiAtRUlOVkFMOwotCi0JdmFs
ID0gbmF2aTEwX3dvcmtsb2FkX21hcFtwcm9maWxlXTsKLQotCXJldHVybiB2YWw7Ci19Ci0KLXN0
YXRpYyBib29sIGlzX2FzaWNfc2VjdXJlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQotewotCXN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gc211LT5hZGV2OwotCWJvb2wgaXNfc2VjdXJlID0g
dHJ1ZTsKLQl1aW50MzJfdCBtcDBfZndfaW50ZjsKLQotCW1wMF9md19pbnRmID0gUlJFRzMyX1BD
SUUoTVAwX1B1YmxpYyB8Ci0JCQkJICAgKHNtbk1QMF9GV19JTlRGICYgMHhmZmZmZmZmZikpOwot
Ci0JaWYgKCEobXAwX2Z3X2ludGYgJiAoMSA8PCAxOSkpKQotCQlpc19zZWN1cmUgPSBmYWxzZTsK
LQotCXJldHVybiBpc19zZWN1cmU7Ci19Ci0KLXN0YXRpYyBpbnQKLW5hdmkxMF9nZXRfYWxsb3dl
ZF9mZWF0dXJlX21hc2soc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCi0JCQkJICB1aW50MzJfdCAq
ZmVhdHVyZV9tYXNrLCB1aW50MzJfdCBudW0pCi17Ci0Jc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYgPSBzbXUtPmFkZXY7Ci0KLQlpZiAobnVtID4gMikKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlt
ZW1zZXQoZmVhdHVyZV9tYXNrLCAwLCBzaXplb2YodWludDMyX3QpICogbnVtKTsKLQotCSoodWlu
dDY0X3QgKilmZWF0dXJlX21hc2sgfD0gRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX1BSRUZFVENI
RVJfQklUKQotCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX0dGWENMS19CSVQpCi0JCQkJ
fCBGRUFUVVJFX01BU0soRkVBVFVSRV9EUE1fU09DQ0xLX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFT
SyhGRUFUVVJFX0RQTV9NUDBDTEtfQklUKQotCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBN
X0xJTktfQklUKQotCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfR0ZYX1VMVl9CSVQpCi0JCQkJ
fCBGRUFUVVJFX01BU0soRkVBVFVSRV9SU01VX1NNTl9DR19CSVQpCi0JCQkJfCBGRUFUVVJFX01B
U0soRkVBVFVSRV9EU19TT0NDTEtfQklUKQotCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfUFBU
X0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX1REQ19CSVQpCi0JCQkJfCBGRUFUVVJF
X01BU0soRkVBVFVSRV9HRlhfRURDX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX1ZS
MEhPVF9CSVQpCi0JCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9GQU5fQ09OVFJPTF9CSVQpCi0J
CQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9USEVSTUFMX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFT
SyhGRUFUVVJFX0xFRF9ESVNQTEFZX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQ
TV9EQ0VGQ0xLX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0RTX0dGWENMS19CSVQp
Ci0JCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9EU19EQ0VGQ0xLX0JJVCkKLQkJCQl8IEZFQVRV
UkVfTUFTSyhGRUFUVVJFX0ZXX0RTVEFURV9CSVQpCi0JCQkJfCBGRUFUVVJFX01BU0soRkVBVFVS
RV9CQUNPX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0FDRENfQklUKTsKLQotCWlm
IChhZGV2LT5wbS5wcF9mZWF0dXJlICYgUFBfTUNMS19EUE1fTUFTSykKLQkJKih1aW50NjRfdCAq
KWZlYXR1cmVfbWFzayB8PSBGRUFUVVJFX01BU0soRkVBVFVSRV9EUE1fVUNMS19CSVQpCi0JCQkJ
fCBGRUFUVVJFX01BU0soRkVBVFVSRV9NRU1fVkREQ0lfU0NBTElOR19CSVQpCi0JCQkJfCBGRUFU
VVJFX01BU0soRkVBVFVSRV9NRU1fTVZERF9TQ0FMSU5HX0JJVCk7Ci0KLQlpZiAoYWRldi0+cG0u
cHBfZmVhdHVyZSAmIFBQX0dGWE9GRl9NQVNLKSB7Ci0JCSoodWludDY0X3QgKilmZWF0dXJlX21h
c2sgfD0gRkVBVFVSRV9NQVNLKEZFQVRVUkVfR0ZYX1NTX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFT
SyhGRUFUVVJFX0dGWE9GRl9CSVQpOwotCQkvKiBUT0RPOiByZW1vdmUgaXQgb25jZSBmdyBmaXgg
dGhlIGJ1ZyAqLwotCQkqKHVpbnQ2NF90ICopZmVhdHVyZV9tYXNrICY9IH5GRUFUVVJFX01BU0so
RkVBVFVSRV9GV19EU1RBVEVfQklUKTsKLQl9Ci0KLQlpZiAoc211LT5hZGV2LT5wZ19mbGFncyAm
IEFNRF9QR19TVVBQT1JUX01NSFVCKQotCQkqKHVpbnQ2NF90ICopZmVhdHVyZV9tYXNrIHw9IEZF
QVRVUkVfTUFTSyhGRUFUVVJFX01NSFVCX1BHX0JJVCk7Ci0KLQlpZiAoc211LT5hZGV2LT5wZ19m
bGFncyAmIEFNRF9QR19TVVBQT1JUX0FUSFVCKQotCQkqKHVpbnQ2NF90ICopZmVhdHVyZV9tYXNr
IHw9IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0FUSFVCX1BHX0JJVCk7Ci0KLQlpZiAoc211LT5hZGV2
LT5wZ19mbGFncyAmIEFNRF9QR19TVVBQT1JUX1ZDTikKLQkJKih1aW50NjRfdCAqKWZlYXR1cmVf
bWFzayB8PSBGRUFUVVJFX01BU0soRkVBVFVSRV9WQ05fUEdfQklUKTsKLQotCS8qIGRpc2FibGUg
RFBNIFVDTEsgYW5kIERTIFNPQ0NMSyBvbiBuYXZpMTAgQTAgc2VjdXJlIGJvYXJkICovCi0JaWYg
KGlzX2FzaWNfc2VjdXJlKHNtdSkpIHsKLQkJLyogb25seSBmb3IgbmF2aTEwIEEwICovCi0JCWlm
ICgoYWRldi0+YXNpY190eXBlID09IENISVBfTkFWSTEwKSAmJgotCQkJKGFkZXYtPnJldl9pZCA9
PSAwKSkgewotCQkJKih1aW50NjRfdCAqKWZlYXR1cmVfbWFzayAmPQotCQkJCQl+KEZFQVRVUkVf
TUFTSyhGRUFUVVJFX0RQTV9VQ0xLX0JJVCkKLQkJCQkJICB8IEZFQVRVUkVfTUFTSyhGRUFUVVJF
X01FTV9WRERDSV9TQ0FMSU5HX0JJVCkKLQkJCQkJICB8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX01F
TV9NVkREX1NDQUxJTkdfQklUKSk7Ci0JCQkqKHVpbnQ2NF90ICopZmVhdHVyZV9tYXNrICY9Ci0J
CQkJCX5GRUFUVVJFX01BU0soRkVBVFVSRV9EU19TT0NDTEtfQklUKTsKLQkJfQotCX0KLQotCXJl
dHVybiAwOwotfQotCi1zdGF0aWMgaW50IG5hdmkxMF9jaGVja19wb3dlcnBsYXlfdGFibGUoc3Ry
dWN0IHNtdV9jb250ZXh0ICpzbXUpCi17Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgbmF2
aTEwX2FwcGVuZF9wb3dlcnBsYXlfdGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCi17Ci0J
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBzbXUtPmFkZXY7Ci0Jc3RydWN0IHNtdV90YWJs
ZV9jb250ZXh0ICp0YWJsZV9jb250ZXh0ID0gJnNtdS0+c211X3RhYmxlOwotCVBQVGFibGVfdCAq
c21jX3BwdGFibGUgPSB0YWJsZV9jb250ZXh0LT5kcml2ZXJfcHB0YWJsZTsKLQlzdHJ1Y3QgYXRv
bV9zbWNfZHBtX2luZm9fdjRfNSAqc21jX2RwbV90YWJsZTsKLQlpbnQgaW5kZXgsIHJldDsKLQot
CWluZGV4ID0gZ2V0X2luZGV4X2ludG9fbWFzdGVyX3RhYmxlKGF0b21fbWFzdGVyX2xpc3Rfb2Zf
ZGF0YV90YWJsZXNfdjJfMSwKLQkJCQkJICAgc21jX2RwbV9pbmZvKTsKLQotCXJldCA9IHNtdV9n
ZXRfYXRvbV9kYXRhX3RhYmxlKHNtdSwgaW5kZXgsIE5VTEwsIE5VTEwsIE5VTEwsCi0JCQkJICAg
ICAgKHVpbnQ4X3QgKiopJnNtY19kcG1fdGFibGUpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7
Ci0KLQltZW1jcHkoc21jX3BwdGFibGUtPkkyY0NvbnRyb2xsZXJzLCBzbWNfZHBtX3RhYmxlLT5J
MmNDb250cm9sbGVycywKLQkgICAgICAgc2l6ZW9mKEkyY0NvbnRyb2xsZXJDb25maWdfdCkgKiBO
VU1fSTJDX0NPTlRST0xMRVJTKTsKLQotCS8qIFNWSTIgQm9hcmQgUGFyYW1ldGVycyAqLwotCXNt
Y19wcHRhYmxlLT5NYXhWb2x0YWdlU3RlcEdmeCA9IHNtY19kcG1fdGFibGUtPk1heFZvbHRhZ2VT
dGVwR2Z4OwotCXNtY19wcHRhYmxlLT5NYXhWb2x0YWdlU3RlcFNvYyA9IHNtY19kcG1fdGFibGUt
Pk1heFZvbHRhZ2VTdGVwU29jOwotCXNtY19wcHRhYmxlLT5WZGRHZnhWck1hcHBpbmcgPSBzbWNf
ZHBtX3RhYmxlLT5WZGRHZnhWck1hcHBpbmc7Ci0Jc21jX3BwdGFibGUtPlZkZFNvY1ZyTWFwcGlu
ZyA9IHNtY19kcG1fdGFibGUtPlZkZFNvY1ZyTWFwcGluZzsKLQlzbWNfcHB0YWJsZS0+VmRkTWVt
MFZyTWFwcGluZyA9IHNtY19kcG1fdGFibGUtPlZkZE1lbTBWck1hcHBpbmc7Ci0Jc21jX3BwdGFi
bGUtPlZkZE1lbTFWck1hcHBpbmcgPSBzbWNfZHBtX3RhYmxlLT5WZGRNZW0xVnJNYXBwaW5nOwot
CXNtY19wcHRhYmxlLT5HZnhVbHZQaGFzZVNoZWRkaW5nTWFzayA9IHNtY19kcG1fdGFibGUtPkdm
eFVsdlBoYXNlU2hlZGRpbmdNYXNrOwotCXNtY19wcHRhYmxlLT5Tb2NVbHZQaGFzZVNoZWRkaW5n
TWFzayA9IHNtY19kcG1fdGFibGUtPlNvY1VsdlBoYXNlU2hlZGRpbmdNYXNrOwotCXNtY19wcHRh
YmxlLT5FeHRlcm5hbFNlbnNvclByZXNlbnQgPSBzbWNfZHBtX3RhYmxlLT5FeHRlcm5hbFNlbnNv
clByZXNlbnQ7Ci0Jc21jX3BwdGFibGUtPlBhZGRpbmc4X1YgPSBzbWNfZHBtX3RhYmxlLT5QYWRk
aW5nOF9WOwotCi0JLyogVGVsZW1ldHJ5IFNldHRpbmdzICovCi0Jc21jX3BwdGFibGUtPkdmeE1h
eEN1cnJlbnQgPSBzbWNfZHBtX3RhYmxlLT5HZnhNYXhDdXJyZW50OwotCXNtY19wcHRhYmxlLT5H
ZnhPZmZzZXQgPSBzbWNfZHBtX3RhYmxlLT5HZnhPZmZzZXQ7Ci0Jc21jX3BwdGFibGUtPlBhZGRp
bmdfVGVsZW1ldHJ5R2Z4ID0gc21jX2RwbV90YWJsZS0+UGFkZGluZ19UZWxlbWV0cnlHZng7Ci0J
c21jX3BwdGFibGUtPlNvY01heEN1cnJlbnQgPSBzbWNfZHBtX3RhYmxlLT5Tb2NNYXhDdXJyZW50
OwotCXNtY19wcHRhYmxlLT5Tb2NPZmZzZXQgPSBzbWNfZHBtX3RhYmxlLT5Tb2NPZmZzZXQ7Ci0J
c21jX3BwdGFibGUtPlBhZGRpbmdfVGVsZW1ldHJ5U29jID0gc21jX2RwbV90YWJsZS0+UGFkZGlu
Z19UZWxlbWV0cnlTb2M7Ci0Jc21jX3BwdGFibGUtPk1lbTBNYXhDdXJyZW50ID0gc21jX2RwbV90
YWJsZS0+TWVtME1heEN1cnJlbnQ7Ci0Jc21jX3BwdGFibGUtPk1lbTBPZmZzZXQgPSBzbWNfZHBt
X3RhYmxlLT5NZW0wT2Zmc2V0OwotCXNtY19wcHRhYmxlLT5QYWRkaW5nX1RlbGVtZXRyeU1lbTAg
PSBzbWNfZHBtX3RhYmxlLT5QYWRkaW5nX1RlbGVtZXRyeU1lbTA7Ci0Jc21jX3BwdGFibGUtPk1l
bTFNYXhDdXJyZW50ID0gc21jX2RwbV90YWJsZS0+TWVtMU1heEN1cnJlbnQ7Ci0Jc21jX3BwdGFi
bGUtPk1lbTFPZmZzZXQgPSBzbWNfZHBtX3RhYmxlLT5NZW0xT2Zmc2V0OwotCXNtY19wcHRhYmxl
LT5QYWRkaW5nX1RlbGVtZXRyeU1lbTEgPSBzbWNfZHBtX3RhYmxlLT5QYWRkaW5nX1RlbGVtZXRy
eU1lbTE7Ci0KLQkvKiBHUElPIFNldHRpbmdzICovCi0Jc21jX3BwdGFibGUtPkFjRGNHcGlvID0g
c21jX2RwbV90YWJsZS0+QWNEY0dwaW87Ci0Jc21jX3BwdGFibGUtPkFjRGNQb2xhcml0eSA9IHNt
Y19kcG1fdGFibGUtPkFjRGNQb2xhcml0eTsKLQlzbWNfcHB0YWJsZS0+VlIwSG90R3BpbyA9IHNt
Y19kcG1fdGFibGUtPlZSMEhvdEdwaW87Ci0Jc21jX3BwdGFibGUtPlZSMEhvdFBvbGFyaXR5ID0g
c21jX2RwbV90YWJsZS0+VlIwSG90UG9sYXJpdHk7Ci0Jc21jX3BwdGFibGUtPlZSMUhvdEdwaW8g
PSBzbWNfZHBtX3RhYmxlLT5WUjFIb3RHcGlvOwotCXNtY19wcHRhYmxlLT5WUjFIb3RQb2xhcml0
eSA9IHNtY19kcG1fdGFibGUtPlZSMUhvdFBvbGFyaXR5OwotCXNtY19wcHRhYmxlLT5HdGhyR3Bp
byA9IHNtY19kcG1fdGFibGUtPkd0aHJHcGlvOwotCXNtY19wcHRhYmxlLT5HdGhyUG9sYXJpdHkg
PSBzbWNfZHBtX3RhYmxlLT5HdGhyUG9sYXJpdHk7Ci0KLQkvKiBMRUQgRGlzcGxheSBTZXR0aW5n
cyAqLwotCXNtY19wcHRhYmxlLT5MZWRQaW4wID0gc21jX2RwbV90YWJsZS0+TGVkUGluMDsKLQlz
bWNfcHB0YWJsZS0+TGVkUGluMSA9IHNtY19kcG1fdGFibGUtPkxlZFBpbjE7Ci0Jc21jX3BwdGFi
bGUtPkxlZFBpbjIgPSBzbWNfZHBtX3RhYmxlLT5MZWRQaW4yOwotCXNtY19wcHRhYmxlLT5wYWRk
aW5nOF80ID0gc21jX2RwbV90YWJsZS0+cGFkZGluZzhfNDsKLQotCS8qIEdGWENMSyBQTEwgU3By
ZWFkIFNwZWN0cnVtICovCi0Jc21jX3BwdGFibGUtPlBsbEdmeGNsa1NwcmVhZEVuYWJsZWQgPSBz
bWNfZHBtX3RhYmxlLT5QbGxHZnhjbGtTcHJlYWRFbmFibGVkOwotCXNtY19wcHRhYmxlLT5QbGxH
ZnhjbGtTcHJlYWRQZXJjZW50ID0gc21jX2RwbV90YWJsZS0+UGxsR2Z4Y2xrU3ByZWFkUGVyY2Vu
dDsKLQlzbWNfcHB0YWJsZS0+UGxsR2Z4Y2xrU3ByZWFkRnJlcSA9IHNtY19kcG1fdGFibGUtPlBs
bEdmeGNsa1NwcmVhZEZyZXE7Ci0KLQkvKiBHRlhDTEsgREZMTCBTcHJlYWQgU3BlY3RydW0gKi8K
LQlzbWNfcHB0YWJsZS0+RGZsbEdmeGNsa1NwcmVhZEVuYWJsZWQgPSBzbWNfZHBtX3RhYmxlLT5E
ZmxsR2Z4Y2xrU3ByZWFkRW5hYmxlZDsKLQlzbWNfcHB0YWJsZS0+RGZsbEdmeGNsa1NwcmVhZFBl
cmNlbnQgPSBzbWNfZHBtX3RhYmxlLT5EZmxsR2Z4Y2xrU3ByZWFkUGVyY2VudDsKLQlzbWNfcHB0
YWJsZS0+RGZsbEdmeGNsa1NwcmVhZEZyZXEgPSBzbWNfZHBtX3RhYmxlLT5EZmxsR2Z4Y2xrU3By
ZWFkRnJlcTsKLQotCS8qIFVDTEsgU3ByZWFkIFNwZWN0cnVtICovCi0Jc21jX3BwdGFibGUtPlVj
bGtTcHJlYWRFbmFibGVkID0gc21jX2RwbV90YWJsZS0+VWNsa1NwcmVhZEVuYWJsZWQ7Ci0Jc21j
X3BwdGFibGUtPlVjbGtTcHJlYWRQZXJjZW50ID0gc21jX2RwbV90YWJsZS0+VWNsa1NwcmVhZFBl
cmNlbnQ7Ci0Jc21jX3BwdGFibGUtPlVjbGtTcHJlYWRGcmVxID0gc21jX2RwbV90YWJsZS0+VWNs
a1NwcmVhZEZyZXE7Ci0KLQkvKiBTT0NDTEsgU3ByZWFkIFNwZWN0cnVtICovCi0Jc21jX3BwdGFi
bGUtPlNvY2xrU3ByZWFkRW5hYmxlZCA9IHNtY19kcG1fdGFibGUtPlNvY2xrU3ByZWFkRW5hYmxl
ZDsKLQlzbWNfcHB0YWJsZS0+U29jY2xrU3ByZWFkUGVyY2VudCA9IHNtY19kcG1fdGFibGUtPlNv
Y2Nsa1NwcmVhZFBlcmNlbnQ7Ci0Jc21jX3BwdGFibGUtPlNvY2Nsa1NwcmVhZEZyZXEgPSBzbWNf
ZHBtX3RhYmxlLT5Tb2NjbGtTcHJlYWRGcmVxOwotCi0JLyogVG90YWwgYm9hcmQgcG93ZXIgKi8K
LQlzbWNfcHB0YWJsZS0+VG90YWxCb2FyZFBvd2VyID0gc21jX2RwbV90YWJsZS0+VG90YWxCb2Fy
ZFBvd2VyOwotCXNtY19wcHRhYmxlLT5Cb2FyZFBhZGRpbmcgPSBzbWNfZHBtX3RhYmxlLT5Cb2Fy
ZFBhZGRpbmc7Ci0KLQkvKiBNdmRkIFN2aTIgRGl2IFJhdGlvIFNldHRpbmcgKi8KLQlzbWNfcHB0
YWJsZS0+TXZkZFJhdGlvID0gc21jX2RwbV90YWJsZS0+TXZkZFJhdGlvOwotCi0JaWYgKGFkZXYt
PnBtLnBwX2ZlYXR1cmUgJiBQUF9HRlhPRkZfTUFTSykgewotCQkqKHVpbnQ2NF90ICopc21jX3Bw
dGFibGUtPkZlYXR1cmVzVG9SdW4gfD0gRkVBVFVSRV9NQVNLKEZFQVRVUkVfR0ZYX1NTX0JJVCkK
LQkJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9HRlhPRkZfQklUKTsKLQotCQkvKiBUT0RPOiBy
ZW1vdmUgaXQgb25jZSBTTVUgZncgZml4IGl0ICovCi0JCXNtY19wcHRhYmxlLT5EZWJ1Z092ZXJy
aWRlcyB8PSBEUE1fT1ZFUlJJREVfRElTQUJMRV9ERkxMX1BMTF9TSFVURE9XTjsKLQl9Ci0KLQly
ZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBuYXZpMTBfc3RvcmVfcG93ZXJwbGF5X3RhYmxlKHN0
cnVjdCBzbXVfY29udGV4dCAqc211KQotewotCXN0cnVjdCBzbXVfMTFfMF9wb3dlcnBsYXlfdGFi
bGUgKnBvd2VycGxheV90YWJsZSA9IE5VTEw7Ci0Jc3RydWN0IHNtdV90YWJsZV9jb250ZXh0ICp0
YWJsZV9jb250ZXh0ID0gJnNtdS0+c211X3RhYmxlOwotCi0JaWYgKCF0YWJsZV9jb250ZXh0LT5w
b3dlcl9wbGF5X3RhYmxlKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCXBvd2VycGxheV90YWJsZSA9
IHRhYmxlX2NvbnRleHQtPnBvd2VyX3BsYXlfdGFibGU7Ci0KLQltZW1jcHkodGFibGVfY29udGV4
dC0+ZHJpdmVyX3BwdGFibGUsICZwb3dlcnBsYXlfdGFibGUtPnNtY19wcHRhYmxlLAotCSAgICAg
ICBzaXplb2YoUFBUYWJsZV90KSk7Ci0KLQl0YWJsZV9jb250ZXh0LT50aGVybWFsX2NvbnRyb2xs
ZXJfdHlwZSA9IHBvd2VycGxheV90YWJsZS0+dGhlcm1hbF9jb250cm9sbGVyX3R5cGU7Ci0KLQly
ZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBuYXZpMTBfdGFibGVzX2luaXQoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUsIHN0cnVjdCBzbXVfdGFibGUgKnRhYmxlcykKLXsKLQlTTVVfVEFCTEVfSU5J
VCh0YWJsZXMsIFNNVV9UQUJMRV9QUFRBQkxFLCBzaXplb2YoUFBUYWJsZV90KSwKLQkJICAgICAg
IFBBR0VfU0laRSwgQU1ER1BVX0dFTV9ET01BSU5fVlJBTSk7Ci0JU01VX1RBQkxFX0lOSVQodGFi
bGVzLCBTTVVfVEFCTEVfV0FURVJNQVJLUywgc2l6ZW9mKFdhdGVybWFya3NfdCksCi0JCSAgICAg
ICBQQUdFX1NJWkUsIEFNREdQVV9HRU1fRE9NQUlOX1ZSQU0pOwotCVNNVV9UQUJMRV9JTklUKHRh
YmxlcywgU01VX1RBQkxFX1NNVV9NRVRSSUNTLCBzaXplb2YoU211TWV0cmljc190KSwKLQkJICAg
ICAgIFBBR0VfU0laRSwgQU1ER1BVX0dFTV9ET01BSU5fVlJBTSk7Ci0JU01VX1RBQkxFX0lOSVQo
dGFibGVzLCBTTVVfVEFCTEVfT1ZFUkRSSVZFLCBzaXplb2YoT3ZlckRyaXZlVGFibGVfdCksCi0J
CSAgICAgICBQQUdFX1NJWkUsIEFNREdQVV9HRU1fRE9NQUlOX1ZSQU0pOwotCVNNVV9UQUJMRV9J
TklUKHRhYmxlcywgU01VX1RBQkxFX1BNU1RBVFVTTE9HLCBTTVUxMV9UT09MX1NJWkUsCi0JCSAg
ICAgICBQQUdFX1NJWkUsIEFNREdQVV9HRU1fRE9NQUlOX1ZSQU0pOwotCVNNVV9UQUJMRV9JTklU
KHRhYmxlcywgU01VX1RBQkxFX0FDVElWSVRZX01PTklUT1JfQ09FRkYsCi0JCSAgICAgICBzaXpl
b2YoRHBtQWN0aXZpdHlNb25pdG9yQ29lZmZJbnRfdCksIFBBR0VfU0laRSwKLQkgICAgICAgICAg
ICAgICBBTURHUFVfR0VNX0RPTUFJTl9WUkFNKTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMg
aW50IG5hdmkxMF9hbGxvY2F0ZV9kcG1fY29udGV4dChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkK
LXsKLQlzdHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpzbXVfZHBtID0gJnNtdS0+c211X2RwbTsKLQot
CWlmIChzbXVfZHBtLT5kcG1fY29udGV4dCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlzbXVfZHBt
LT5kcG1fY29udGV4dCA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBzbXVfMTFfMF9kcG1fY29udGV4
dCksCi0JCQkJICAgICAgIEdGUF9LRVJORUwpOwotCWlmICghc211X2RwbS0+ZHBtX2NvbnRleHQp
Ci0JCXJldHVybiAtRU5PTUVNOwotCi0Jc211X2RwbS0+ZHBtX2NvbnRleHRfc2l6ZSA9IHNpemVv
ZihzdHJ1Y3Qgc211XzExXzBfZHBtX2NvbnRleHQpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRp
YyBpbnQgbmF2aTEwX3NldF9kZWZhdWx0X2RwbV90YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNt
dSkKLXsKLQlzdHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpzbXVfZHBtID0gJnNtdS0+c211X2RwbTsK
LQlzdHJ1Y3Qgc211X3RhYmxlX2NvbnRleHQgKnRhYmxlX2NvbnRleHQgPSAmc211LT5zbXVfdGFi
bGU7Ci0Jc3RydWN0IHNtdV8xMV8wX2RwbV9jb250ZXh0ICpkcG1fY29udGV4dCA9IHNtdV9kcG0t
PmRwbV9jb250ZXh0OwotCVBQVGFibGVfdCAqZHJpdmVyX3BwdCA9IE5VTEw7Ci0KLSAgICAgICAg
ZHJpdmVyX3BwdCA9IHRhYmxlX2NvbnRleHQtPmRyaXZlcl9wcHRhYmxlOwotCi0gICAgICAgIGRw
bV9jb250ZXh0LT5kcG1fdGFibGVzLnNvY190YWJsZS5taW4gPSBkcml2ZXJfcHB0LT5GcmVxVGFi
bGVTb2NjbGtbMF07Ci0gICAgICAgIGRwbV9jb250ZXh0LT5kcG1fdGFibGVzLnNvY190YWJsZS5t
YXggPSBkcml2ZXJfcHB0LT5GcmVxVGFibGVTb2NjbGtbTlVNX1NPQ0NMS19EUE1fTEVWRUxTIC0g
MV07Ci0KLSAgICAgICAgZHBtX2NvbnRleHQtPmRwbV90YWJsZXMuZ2Z4X3RhYmxlLm1pbiA9IGRy
aXZlcl9wcHQtPkZyZXFUYWJsZUdmeFswXTsKLSAgICAgICAgZHBtX2NvbnRleHQtPmRwbV90YWJs
ZXMuZ2Z4X3RhYmxlLm1heCA9IGRyaXZlcl9wcHQtPkZyZXFUYWJsZUdmeFtOVU1fR0ZYQ0xLX0RQ
TV9MRVZFTFMgLSAxXTsKLQotICAgICAgICBkcG1fY29udGV4dC0+ZHBtX3RhYmxlcy51Y2xrX3Rh
YmxlLm1pbiA9IGRyaXZlcl9wcHQtPkZyZXFUYWJsZVVjbGtbMF07Ci0gICAgICAgIGRwbV9jb250
ZXh0LT5kcG1fdGFibGVzLnVjbGtfdGFibGUubWF4ID0gZHJpdmVyX3BwdC0+RnJlcVRhYmxlVWNs
a1tOVU1fVUNMS19EUE1fTEVWRUxTIC0gMV07Ci0KLSAgICAgICAgZHBtX2NvbnRleHQtPmRwbV90
YWJsZXMudmNsa190YWJsZS5taW4gPSBkcml2ZXJfcHB0LT5GcmVxVGFibGVWY2xrWzBdOwotICAg
ICAgICBkcG1fY29udGV4dC0+ZHBtX3RhYmxlcy52Y2xrX3RhYmxlLm1heCA9IGRyaXZlcl9wcHQt
PkZyZXFUYWJsZVZjbGtbTlVNX1ZDTEtfRFBNX0xFVkVMUyAtIDFdOwotCi0gICAgICAgIGRwbV9j
b250ZXh0LT5kcG1fdGFibGVzLmRjbGtfdGFibGUubWluID0gZHJpdmVyX3BwdC0+RnJlcVRhYmxl
RGNsa1swXTsKLSAgICAgICAgZHBtX2NvbnRleHQtPmRwbV90YWJsZXMuZGNsa190YWJsZS5tYXgg
PSBkcml2ZXJfcHB0LT5GcmVxVGFibGVEY2xrW05VTV9EQ0xLX0RQTV9MRVZFTFMgLSAxXTsKLQot
ICAgICAgICBkcG1fY29udGV4dC0+ZHBtX3RhYmxlcy5kY2VmX3RhYmxlLm1pbiA9IGRyaXZlcl9w
cHQtPkZyZXFUYWJsZURjZWZjbGtbMF07Ci0gICAgICAgIGRwbV9jb250ZXh0LT5kcG1fdGFibGVz
LmRjZWZfdGFibGUubWF4ID0gZHJpdmVyX3BwdC0+RnJlcVRhYmxlRGNlZmNsa1tOVU1fRENFRkNM
S19EUE1fTEVWRUxTIC0gMV07Ci0KLSAgICAgICAgZHBtX2NvbnRleHQtPmRwbV90YWJsZXMucGl4
ZWxfdGFibGUubWluID0gZHJpdmVyX3BwdC0+RnJlcVRhYmxlUGl4Y2xrWzBdOwotICAgICAgICBk
cG1fY29udGV4dC0+ZHBtX3RhYmxlcy5waXhlbF90YWJsZS5tYXggPSBkcml2ZXJfcHB0LT5GcmVx
VGFibGVQaXhjbGtbTlVNX1BJWENMS19EUE1fTEVWRUxTIC0gMV07Ci0KLSAgICAgICAgZHBtX2Nv
bnRleHQtPmRwbV90YWJsZXMuZGlzcGxheV90YWJsZS5taW4gPSBkcml2ZXJfcHB0LT5GcmVxVGFi
bGVEaXNwY2xrWzBdOwotICAgICAgICBkcG1fY29udGV4dC0+ZHBtX3RhYmxlcy5kaXNwbGF5X3Rh
YmxlLm1heCA9IGRyaXZlcl9wcHQtPkZyZXFUYWJsZURpc3BjbGtbTlVNX0RJU1BDTEtfRFBNX0xF
VkVMUyAtIDFdOwotCi0gICAgICAgIGRwbV9jb250ZXh0LT5kcG1fdGFibGVzLnBoeV90YWJsZS5t
aW4gPSBkcml2ZXJfcHB0LT5GcmVxVGFibGVQaHljbGtbMF07Ci0gICAgICAgIGRwbV9jb250ZXh0
LT5kcG1fdGFibGVzLnBoeV90YWJsZS5tYXggPSBkcml2ZXJfcHB0LT5GcmVxVGFibGVQaHljbGtb
TlVNX1BIWUNMS19EUE1fTEVWRUxTIC0gMV07Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGlu
dCBuYXZpMTBfZHBtX3NldF91dmRfZW5hYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBib29s
IGVuYWJsZSkKLXsKLQlpbnQgcmV0ID0gMDsKLQlzdHJ1Y3Qgc211X3Bvd2VyX2NvbnRleHQgKnNt
dV9wb3dlciA9ICZzbXUtPnNtdV9wb3dlcjsKLQlzdHJ1Y3Qgc211X3Bvd2VyX2dhdGUgKnBvd2Vy
X2dhdGUgPSAmc211X3Bvd2VyLT5wb3dlcl9nYXRlOwotCi0JaWYgKGVuYWJsZSAmJiBwb3dlcl9n
YXRlLT51dmRfZ2F0ZWQpIHsKLQkJaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVf
RkVBVFVSRV9EUE1fVVZEX0JJVCkpIHsKLQkJCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9w
YXJhbShzbXUsIFNNVV9NU0dfUG93ZXJVcFZjbiwgMSk7Ci0JCQlpZiAocmV0KQotCQkJCXJldHVy
biByZXQ7Ci0JCX0KLQkJcG93ZXJfZ2F0ZS0+dXZkX2dhdGVkID0gZmFsc2U7Ci0JfSBlbHNlIHsK
LQkJaWYgKCFlbmFibGUgJiYgIXBvd2VyX2dhdGUtPnV2ZF9nYXRlZCkgewotCQkJaWYgKHNtdV9m
ZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVVZEX0JJVCkpIHsKLQkJCQly
ZXQgPSBzbXVfc2VuZF9zbWNfbXNnKHNtdSwgU01VX01TR19Qb3dlckRvd25WY24pOwotCQkJCWlm
IChyZXQpCi0JCQkJCXJldHVybiByZXQ7Ci0JCQl9Ci0JCQlwb3dlcl9nYXRlLT51dmRfZ2F0ZWQg
PSB0cnVlOwotCQl9Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgbmF2aTEwX2dl
dF9jdXJyZW50X2Nsa19mcmVxX2J5X3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAotCQkJ
CSAgICAgICBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwKLQkJCQkgICAgICAgdWludDMyX3Qg
KnZhbHVlKQotewotCXN0YXRpYyBTbXVNZXRyaWNzX3QgbWV0cmljcyA9IHswfTsKLQlpbnQgcmV0
ID0gMCwgY2xrX2lkID0gMDsKLQotCWlmICghdmFsdWUpCi0JCXJldHVybiAtRUlOVkFMOwotCi0J
cmV0ID0gc211X3VwZGF0ZV90YWJsZShzbXUsIFNNVV9UQUJMRV9TTVVfTUVUUklDUywgKHZvaWQg
KikmbWV0cmljcywgZmFsc2UpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7Ci0KLQljbGtfaWQg
PSBzbXVfY2xrX2dldF9pbmRleChzbXUsIGNsa190eXBlKTsKLQlpZiAoY2xrX2lkIDwgMCkKLQkJ
cmV0dXJuIGNsa19pZDsKLQotCSp2YWx1ZSA9IG1ldHJpY3MuQ3VyckNsb2NrW2Nsa19pZF07Ci0K
LQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IG5hdmkxMF9wcmludF9jbGtfbGV2ZWxzKHN0
cnVjdCBzbXVfY29udGV4dCAqc211LAotCQkJZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsIGNo
YXIgKmJ1ZikKLXsKLQlpbnQgaSwgc2l6ZSA9IDAsIHJldCA9IDA7Ci0JdWludDMyX3QgY3VyX3Zh
bHVlID0gMCwgdmFsdWUgPSAwLCBjb3VudCA9IDA7Ci0KLQlzd2l0Y2ggKGNsa190eXBlKSB7Ci0J
Y2FzZSBTTVVfR0ZYQ0xLOgotCWNhc2UgU01VX1NDTEs6Ci0JY2FzZSBTTVVfU09DQ0xLOgotCWNh
c2UgU01VX01DTEs6Ci0JY2FzZSBTTVVfVUNMSzoKLQljYXNlIFNNVV9GQ0xLOgotCWNhc2UgU01V
X0RDRUZDTEs6Ci0JCXJldCA9IHNtdV9nZXRfY3VycmVudF9jbGtfZnJlcShzbXUsIGNsa190eXBl
LCAmY3VyX3ZhbHVlKTsKLQkJaWYgKHJldCkKLQkJCXJldHVybiBzaXplOwotCQkvKiAxMEtIeiAt
PiBNSHogKi8KLQkJY3VyX3ZhbHVlID0gY3VyX3ZhbHVlIC8gMTAwOwotCi0JCXNpemUgKz0gc3By
aW50ZihidWYsICJjdXJyZW50IGNsazogJXVNaHpcbiIsIGN1cl92YWx1ZSk7Ci0KLQkJcmV0ID0g
c211X2dldF9kcG1fbGV2ZWxfY291bnQoc211LCBjbGtfdHlwZSwgJmNvdW50KTsKLQkJaWYgKHJl
dCkKLQkJCXJldHVybiBzaXplOwotCi0JCWZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7Ci0J
CQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX2J5X2luZGV4KHNtdSwgY2xrX3R5cGUsIGksICZ2YWx1
ZSk7Ci0JCQlpZiAocmV0KQotCQkJCXJldHVybiBzaXplOwotCi0JCQlzaXplICs9IHNwcmludGYo
YnVmICsgc2l6ZSwgIiVkOiAldU1oeiAlc1xuIiwgaSwgdmFsdWUsCi0JCQkJCWN1cl92YWx1ZSA9
PSB2YWx1ZSA/ICIqIiA6ICIiKTsKLQkJfQotCQlicmVhazsKLQlkZWZhdWx0OgotCQlicmVhazsK
LQl9Ci0KLQlyZXR1cm4gc2l6ZTsKLX0KLQotc3RhdGljIGludCBuYXZpMTBfZm9yY2VfY2xrX2xl
dmVscyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKLQkJCQkgICBlbnVtIHNtdV9jbGtfdHlwZSBj
bGtfdHlwZSwgdWludDMyX3QgbWFzaykKLXsKLQotCWludCByZXQgPSAwLCBzaXplID0gMDsKLQl1
aW50MzJfdCBzb2Z0X21pbl9sZXZlbCA9IDAsIHNvZnRfbWF4X2xldmVsID0gMCwgbWluX2ZyZXEg
PSAwLCBtYXhfZnJlcSA9IDA7Ci0KLQlzb2Z0X21pbl9sZXZlbCA9IG1hc2sgPyAoZmZzKG1hc2sp
IC0gMSkgOiAwOwotCXNvZnRfbWF4X2xldmVsID0gbWFzayA/IChmbHMobWFzaykgLSAxKSA6IDA7
Ci0KLQlzd2l0Y2ggKGNsa190eXBlKSB7Ci0JY2FzZSBTTVVfR0ZYQ0xLOgotCWNhc2UgU01VX1ND
TEs6Ci0JY2FzZSBTTVVfU09DQ0xLOgotCWNhc2UgU01VX01DTEs6Ci0JY2FzZSBTTVVfVUNMSzoK
LQljYXNlIFNNVV9EQ0VGQ0xLOgotCWNhc2UgU01VX0ZDTEs6Ci0JCXJldCA9IHNtdV9nZXRfZHBt
X2ZyZXFfYnlfaW5kZXgoc211LCBjbGtfdHlwZSwgc29mdF9taW5fbGV2ZWwsICZtaW5fZnJlcSk7
Ci0JCWlmIChyZXQpCi0JCQlyZXR1cm4gc2l6ZTsKLQotCQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVx
X2J5X2luZGV4KHNtdSwgY2xrX3R5cGUsIHNvZnRfbWF4X2xldmVsLCAmbWF4X2ZyZXEpOwotCQlp
ZiAocmV0KQotCQkJcmV0dXJuIHNpemU7Ci0KLQkJcmV0ID0gc211X3NldF9zb2Z0X2ZyZXFfcmFu
Z2Uoc211LCBjbGtfdHlwZSwgbWluX2ZyZXEsIG1heF9mcmVxKTsKLQkJaWYgKHJldCkKLQkJCXJl
dHVybiBzaXplOwotCQlicmVhazsKLQlkZWZhdWx0OgotCQlicmVhazsKLQl9Ci0KLQlyZXR1cm4g
c2l6ZTsKLX0KLQotc3RhdGljIGludCBuYXZpMTBfcG9wdWxhdGVfdW1kX3N0YXRlX2NsayhzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSkKLXsKLQlpbnQgcmV0ID0gMDsKLQl1aW50MzJfdCBtaW5fc2Ns
a19mcmVxID0gMDsKLQotCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBTTVVfU0NM
SywgJm1pbl9zY2xrX2ZyZXEsIE5VTEwpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7Ci0KLQlz
bXUtPnBzdGF0ZV9zY2xrID0gbWluX3NjbGtfZnJlcSAqIDEwMDsKLQotCXJldHVybiByZXQ7Ci19
Ci0KLXN0YXRpYyBpbnQgbmF2aTEwX2dldF9jbG9ja19ieV90eXBlX3dpdGhfbGF0ZW5jeShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSwKLQkJCQkJCSBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwK
LQkJCQkJCSBzdHJ1Y3QgcHBfY2xvY2tfbGV2ZWxzX3dpdGhfbGF0ZW5jeSAqY2xvY2tzKQotewot
CWludCByZXQgPSAwLCBpID0gMDsKLQl1aW50MzJfdCBsZXZlbF9jb3VudCA9IDAsIGZyZXEgPSAw
OwotCi0Jc3dpdGNoIChjbGtfdHlwZSkgewotCWNhc2UgU01VX0dGWENMSzoKLQljYXNlIFNNVV9E
Q0VGQ0xLOgotCWNhc2UgU01VX1NPQ0NMSzoKLQkJcmV0ID0gc211X2dldF9kcG1fbGV2ZWxfY291
bnQoc211LCBjbGtfdHlwZSwgJmxldmVsX2NvdW50KTsKLQkJaWYgKHJldCkKLQkJCXJldHVybiBy
ZXQ7Ci0KLQkJbGV2ZWxfY291bnQgPSBtaW4obGV2ZWxfY291bnQsICh1aW50MzJfdClNQVhfTlVN
X0NMT0NLUyk7Ci0JCWNsb2Nrcy0+bnVtX2xldmVscyA9IGxldmVsX2NvdW50OwotCi0JCWZvciAo
aSA9IDA7IGkgPCBsZXZlbF9jb3VudDsgaSsrKSB7Ci0JCQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVx
X2J5X2luZGV4KHNtdSwgY2xrX3R5cGUsIGksICZmcmVxKTsKLQkJCWlmIChyZXQpCi0JCQkJcmV0
dXJuIHJldDsKLQotCQkJY2xvY2tzLT5kYXRhW2ldLmNsb2Nrc19pbl9raHogPSBmcmVxICogMTAw
MDsKLQkJCWNsb2Nrcy0+ZGF0YVtpXS5sYXRlbmN5X2luX3VzID0gMDsKLQkJfQotCQlicmVhazsK
LQlkZWZhdWx0OgotCQlicmVhazsKLQl9Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50
IG5hdmkxMF9wcmVfZGlzcGxheV9jb25maWdfY2hhbmdlZChzdHJ1Y3Qgc211X2NvbnRleHQgKnNt
dSkKLXsKLQlpbnQgcmV0ID0gMDsKLQl1aW50MzJfdCBtYXhfZnJlcSA9IDA7Ci0KLQlyZXQgPSBz
bXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LCBTTVVfTVNHX051bU9mRGlzcGxheXMsIDAp
OwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7Ci0KLQlpZiAoc211X2ZlYXR1cmVfaXNfZW5hYmxl
ZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9VQ0xLX0JJVCkpIHsKLQkJcmV0ID0gc211X2dldF9kcG1f
ZnJlcV9yYW5nZShzbXUsIFNNVV9VQ0xLLCBOVUxMLCAmbWF4X2ZyZXEpOwotCQlpZiAocmV0KQot
CQkJcmV0dXJuIHJldDsKLQkJcmV0ID0gc211X3NldF9oYXJkX2ZyZXFfcmFuZ2Uoc211LCBTTVVf
VUNMSywgMCwgbWF4X2ZyZXEpOwotCQlpZiAocmV0KQotCQkJcmV0dXJuIHJldDsKLQl9Ci0KLQly
ZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IG5hdmkxMF9kaXNwbGF5X2NvbmZpZ19jaGFuZ2Vk
KHN0cnVjdCBzbXVfY29udGV4dCAqc211KQotewotCWludCByZXQgPSAwOwotCi0JaWYgKChzbXUt
PndhdGVybWFya3NfYml0bWFwICYgV0FURVJNQVJLU19FWElTVCkgJiYKLQkgICAgIShzbXUtPndh
dGVybWFya3NfYml0bWFwICYgV0FURVJNQVJLU19MT0FERUQpKSB7Ci0JCXJldCA9IHNtdV93cml0
ZV93YXRlcm1hcmtzX3RhYmxlKHNtdSk7Ci0JCWlmIChyZXQpCi0JCQlyZXR1cm4gcmV0OwotCi0J
CXNtdS0+d2F0ZXJtYXJrc19iaXRtYXAgfD0gV0FURVJNQVJLU19MT0FERUQ7Ci0JfQotCi0JaWYg
KChzbXUtPndhdGVybWFya3NfYml0bWFwICYgV0FURVJNQVJLU19FWElTVCkgJiYKLQkgICAgc211
X2ZlYXR1cmVfaXNfc3VwcG9ydGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX0RDRUZDTEtfQklUKSAm
JgotCSAgICBzbXVfZmVhdHVyZV9pc19zdXBwb3J0ZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fU09D
Q0xLX0JJVCkpIHsKLQkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwgU01V
X01TR19OdW1PZkRpc3BsYXlzLAotCQkJCQkJICBzbXUtPmRpc3BsYXlfY29uZmlnLT5udW1fZGlz
cGxheSk7Ci0JCWlmIChyZXQpCi0JCQlyZXR1cm4gcmV0OwotCX0KLQotCXJldHVybiByZXQ7Ci19
Ci0KLXN0YXRpYyBpbnQgbmF2aTEwX2ZvcmNlX2RwbV9saW1pdF92YWx1ZShzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSwgYm9vbCBoaWdoZXN0KQotewotCWludCByZXQgPSAwLCBpID0gMDsKLQl1aW50
MzJfdCBtaW5fZnJlcSwgbWF4X2ZyZXEsIGZvcmNlX2ZyZXE7Ci0JZW51bSBzbXVfY2xrX3R5cGUg
Y2xrX3R5cGU7Ci0KLQllbnVtIHNtdV9jbGtfdHlwZSBjbGtzW10gPSB7Ci0JCVNNVV9HRlhDTEss
Ci0JCVNNVV9NQ0xLLAotCQlTTVVfU09DQ0xLLAotCX07Ci0KLQlmb3IgKGkgPSAwOyBpIDwgQVJS
QVlfU0laRShjbGtzKTsgaSsrKSB7Ci0JCWNsa190eXBlID0gY2xrc1tpXTsKLQkJcmV0ID0gc211
X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCAmbWluX2ZyZXEsICZtYXhfZnJlcSk7
Ci0JCWlmIChyZXQpCi0JCQlyZXR1cm4gcmV0OwotCi0JCWZvcmNlX2ZyZXEgPSBoaWdoZXN0ID8g
bWF4X2ZyZXEgOiBtaW5fZnJlcTsKLQkJcmV0ID0gc211X3NldF9zb2Z0X2ZyZXFfcmFuZ2Uoc211
LCBjbGtfdHlwZSwgZm9yY2VfZnJlcSwgZm9yY2VfZnJlcSk7Ci0JCWlmIChyZXQpCi0JCQlyZXR1
cm4gcmV0OwotCX0KLQotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRpYyBpbnQgbmF2aTEwX3VuZm9y
Y2VfZHBtX2xldmVscyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkgewotCi0JaW50IHJldCA9IDAs
IGkgPSAwOwotCXVpbnQzMl90IG1pbl9mcmVxLCBtYXhfZnJlcTsKLQllbnVtIHNtdV9jbGtfdHlw
ZSBjbGtfdHlwZTsKLQotCXN0cnVjdCBjbGtfZmVhdHVyZV9tYXAgewotCQllbnVtIHNtdV9jbGtf
dHlwZSBjbGtfdHlwZTsKLQkJdWludDMyX3QJZmVhdHVyZTsKLQl9IGNsa19mZWF0dXJlX21hcFtd
ID0gewotCQl7U01VX0dGWENMSywgU01VX0ZFQVRVUkVfRFBNX0dGWENMS19CSVR9LAotCQl7U01V
X01DTEssICAgU01VX0ZFQVRVUkVfRFBNX1VDTEtfQklUfSwKLQkJe1NNVV9TT0NDTEssIFNNVV9G
RUFUVVJFX0RQTV9TT0NDTEtfQklUfSwKLQl9OwotCi0JZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJ
WkUoY2xrX2ZlYXR1cmVfbWFwKTsgaSsrKSB7Ci0JCWlmICghc211X2ZlYXR1cmVfaXNfZW5hYmxl
ZChzbXUsIGNsa19mZWF0dXJlX21hcFtpXS5mZWF0dXJlKSkKLQkJICAgIGNvbnRpbnVlOwotCi0J
CWNsa190eXBlID0gY2xrX2ZlYXR1cmVfbWFwW2ldLmNsa190eXBlOwotCi0JCXJldCA9IHNtdV9n
ZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlwZSwgJm1pbl9mcmVxLCAmbWF4X2ZyZXEpOwot
CQlpZiAocmV0KQotCQkJcmV0dXJuIHJldDsKLQotCQlyZXQgPSBzbXVfc2V0X3NvZnRfZnJlcV9y
YW5nZShzbXUsIGNsa190eXBlLCBtaW5fZnJlcSwgbWF4X2ZyZXEpOwotCQlpZiAocmV0KQotCQkJ
cmV0dXJuIHJldDsKLQl9Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IG5hdmkxMF9n
ZXRfZ3B1X3Bvd2VyKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1aW50MzJfdCAqdmFsdWUpCi17
Ci0JaW50IHJldCA9IDA7Ci0JU211TWV0cmljc190IG1ldHJpY3M7Ci0KLQlpZiAoIXZhbHVlKQot
CQlyZXR1cm4gLUVJTlZBTDsKLQotCXJldCA9IHNtdV91cGRhdGVfdGFibGUoc211LCBTTVVfVEFC
TEVfU01VX01FVFJJQ1MsICh2b2lkICopJm1ldHJpY3MsCi0JCQkgICAgICAgZmFsc2UpOwotCWlm
IChyZXQpCi0JCXJldHVybiByZXQ7Ci0KLQkqdmFsdWUgPSBtZXRyaWNzLkN1cnJTb2NrZXRQb3dl
ciA8PCA4OwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgbmF2aTEwX2dldF9jdXJyZW50
X2FjdGl2aXR5X3BlcmNlbnQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCi0JCQkJCSAgICAgICB1
aW50MzJfdCAqdmFsdWUpCi17Ci0JaW50IHJldCA9IDA7Ci0JU211TWV0cmljc190IG1ldHJpY3M7
Ci0KLQlpZiAoIXZhbHVlKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCW1zbGVlcCgxKTsKLQotCXJl
dCA9IHNtdV91cGRhdGVfdGFibGUoc211LCBTTVVfVEFCTEVfU01VX01FVFJJQ1MsCi0JCQkgICAg
ICAgKHZvaWQgKikmbWV0cmljcywgZmFsc2UpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7Ci0K
LQkqdmFsdWUgPSBtZXRyaWNzLkF2ZXJhZ2VHZnhBY3Rpdml0eTsKLQotCXJldHVybiAwOwotfQot
Ci1zdGF0aWMgYm9vbCBuYXZpMTBfaXNfZHBtX3J1bm5pbmcoc3RydWN0IHNtdV9jb250ZXh0ICpz
bXUpCi17Ci0JaW50IHJldCA9IDA7Ci0JdWludDMyX3QgZmVhdHVyZV9tYXNrWzJdOwotCXVuc2ln
bmVkIGxvbmcgZmVhdHVyZV9lbmFibGVkOwotCXJldCA9IHNtdV9mZWF0dXJlX2dldF9lbmFibGVk
X21hc2soc211LCBmZWF0dXJlX21hc2ssIDIpOwotCWZlYXR1cmVfZW5hYmxlZCA9ICh1bnNpZ25l
ZCBsb25nKSgodWludDY0X3QpZmVhdHVyZV9tYXNrWzBdIHwKLQkJCSAgICgodWludDY0X3QpZmVh
dHVyZV9tYXNrWzFdIDw8IDMyKSk7Ci0JcmV0dXJuICEhKGZlYXR1cmVfZW5hYmxlZCAmIFNNQ19E
UE1fRkVBVFVSRSk7Ci19Ci0KLXN0YXRpYyBpbnQgbmF2aTEwX2dldF9mYW5fc3BlZWQoc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQxNl90ICp2YWx1ZSkKLXsKLQlTbXVNZXRyaWNzX3QgbWV0
cmljcyA9IHswfTsKLQlpbnQgcmV0ID0gMDsKLQotCWlmICghdmFsdWUpCi0JCXJldHVybiAtRUlO
VkFMOwotCi0JcmV0ID0gc211X3VwZGF0ZV90YWJsZShzbXUsIFNNVV9UQUJMRV9TTVVfTUVUUklD
UywKLQkJCSAgICAgICAodm9pZCAqKSZtZXRyaWNzLCBmYWxzZSk7Ci0JaWYgKHJldCkKLQkJcmV0
dXJuIHJldDsKLQotCSp2YWx1ZSA9IG1ldHJpY3MuQ3VyckZhblNwZWVkOwotCi0JcmV0dXJuIHJl
dDsKLX0KLQotc3RhdGljIGludCBuYXZpMTBfZ2V0X2Zhbl9zcGVlZF9wZXJjZW50KHN0cnVjdCBz
bXVfY29udGV4dCAqc211LAotCQkJCQl1aW50MzJfdCAqc3BlZWQpCi17Ci0JaW50IHJldCA9IDA7
Ci0JdWludDMyX3QgcGVyY2VudCA9IDA7Ci0JdWludDE2X3QgY3VycmVudF9ycG07Ci0JUFBUYWJs
ZV90ICpwcHRhYmxlID0gc211LT5zbXVfdGFibGUuZHJpdmVyX3BwdGFibGU7Ci0KLQlyZXQgPSBu
YXZpMTBfZ2V0X2Zhbl9zcGVlZChzbXUsICZjdXJyZW50X3JwbSk7Ci0JaWYgKHJldCkKLQkJcmV0
dXJuIHJldDsKLQotCXBlcmNlbnQgPSBjdXJyZW50X3JwbSAqIDEwMCAvIHBwdGFibGUtPkZhbk1h
eGltdW1ScG07Ci0JKnNwZWVkID0gcGVyY2VudCA+IDEwMCA/IDEwMCA6IHBlcmNlbnQ7Ci0KLQly
ZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IG5hdmkxMF9nZXRfcG93ZXJfcHJvZmlsZV9tb2Rl
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBjaGFyICpidWYpCi17Ci0JRHBtQWN0aXZpdHlNb25p
dG9yQ29lZmZJbnRfdCBhY3Rpdml0eV9tb25pdG9yOwotCXVpbnQzMl90IGksIHNpemUgPSAwOwot
CXVpbnQxNl90IHdvcmtsb2FkX3R5cGUgPSAwOwotCXN0YXRpYyBjb25zdCBjaGFyICpwcm9maWxl
X25hbWVbXSA9IHsKLQkJCQkJIkJPT1RVUF9ERUZBVUxUIiwKLQkJCQkJIjNEX0ZVTExfU0NSRUVO
IiwKLQkJCQkJIlBPV0VSX1NBVklORyIsCi0JCQkJCSJWSURFTyIsCi0JCQkJCSJWUiIsCi0JCQkJ
CSJDT01QVVRFIiwKLQkJCQkJIkNVU1RPTSJ9OwotCXN0YXRpYyBjb25zdCBjaGFyICp0aXRsZVtd
ID0gewotCQkJIlBST0ZJTEVfSU5ERVgoTkFNRSkiLAotCQkJIkNMT0NLX1RZUEUoTkFNRSkiLAot
CQkJIkZQUyIsCi0JCQkiTWluRnJlcVR5cGUiLAotCQkJIk1pbkFjdGl2ZUZyZXFUeXBlIiwKLQkJ
CSJNaW5BY3RpdmVGcmVxIiwKLQkJCSJCb29zdGVyRnJlcVR5cGUiLAotCQkJIkJvb3N0ZXJGcmVx
IiwKLQkJCSJQRF9EYXRhX2xpbWl0X2MiLAotCQkJIlBEX0RhdGFfZXJyb3JfY29lZmYiLAotCQkJ
IlBEX0RhdGFfZXJyb3JfcmF0ZV9jb2VmZiJ9OwotCWludCByZXN1bHQgPSAwOwotCi0JaWYgKCFi
dWYpCi0JCXJldHVybiAtRUlOVkFMOwotCi0Jc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIl
MTZzICVzICVzICVzICVzICVzICVzICVzICVzICVzICVzXG4iLAotCQkJdGl0bGVbMF0sIHRpdGxl
WzFdLCB0aXRsZVsyXSwgdGl0bGVbM10sIHRpdGxlWzRdLCB0aXRsZVs1XSwKLQkJCXRpdGxlWzZd
LCB0aXRsZVs3XSwgdGl0bGVbOF0sIHRpdGxlWzldLCB0aXRsZVsxMF0pOwotCi0JZm9yIChpID0g
MDsgaSA8PSBQUF9TTUNfUE9XRVJfUFJPRklMRV9DVVNUT007IGkrKykgewotCQkvKiBjb252IFBQ
X1NNQ19QT1dFUl9QUk9GSUxFKiB0byBXT1JLTE9BRF9QUExJQl8qX0JJVCAqLwotCQl3b3JrbG9h
ZF90eXBlID0gc211X3dvcmtsb2FkX2dldF90eXBlKHNtdSwgaSk7Ci0JCXJlc3VsdCA9IHNtdV91
cGRhdGVfdGFibGUoc211LAotCQkJCQkgIFNNVV9UQUJMRV9BQ1RJVklUWV9NT05JVE9SX0NPRUZG
IHwgd29ya2xvYWRfdHlwZSA8PCAxNiwKLQkJCQkJICAodm9pZCAqKSgmYWN0aXZpdHlfbW9uaXRv
ciksIGZhbHNlKTsKLQkJaWYgKHJlc3VsdCkgewotCQkJcHJfZXJyKCJbJXNdIEZhaWxlZCB0byBn
ZXQgYWN0aXZpdHkgbW9uaXRvciEiLCBfX2Z1bmNfXyk7Ci0JCQlyZXR1cm4gcmVzdWx0OwotCQl9
Ci0KLQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIlMmQgJTE0cyVzOlxuIiwKLQkJCWks
IHByb2ZpbGVfbmFtZVtpXSwgKGkgPT0gc211LT5wb3dlcl9wcm9maWxlX21vZGUpID8gIioiIDog
IiAiKTsKLQotCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIiUxOXMgJWQoJTEzcykgJTdk
ICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2RcbiIsCi0JCQkiICIsCi0JCQkwLAotCQkJ
IkdGWENMSyIsCi0JCQlhY3Rpdml0eV9tb25pdG9yLkdmeF9GUFMsCi0JCQlhY3Rpdml0eV9tb25p
dG9yLkdmeF9NaW5GcmVxU3RlcCwKLQkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X01pbkFjdGl2ZUZy
ZXFUeXBlLAotCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfTWluQWN0aXZlRnJlcSwKLQkJCWFjdGl2
aXR5X21vbml0b3IuR2Z4X0Jvb3N0ZXJGcmVxVHlwZSwKLQkJCWFjdGl2aXR5X21vbml0b3IuR2Z4
X0Jvb3N0ZXJGcmVxLAotCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfUERfRGF0YV9saW1pdF9jLAot
CQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfUERfRGF0YV9lcnJvcl9jb2VmZiwKLQkJCWFjdGl2aXR5
X21vbml0b3IuR2Z4X1BEX0RhdGFfZXJyb3JfcmF0ZV9jb2VmZik7Ci0KLQkJc2l6ZSArPSBzcHJp
bnRmKGJ1ZiArIHNpemUsICIlMTlzICVkKCUxM3MpICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkICU3
ZCAlN2QgJTdkXG4iLAotCQkJIiAiLAotCQkJMSwKLQkJCSJTT0NDTEsiLAotCQkJYWN0aXZpdHlf
bW9uaXRvci5Tb2NfRlBTLAotCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfTWluRnJlcVN0ZXAsCi0J
CQlhY3Rpdml0eV9tb25pdG9yLlNvY19NaW5BY3RpdmVGcmVxVHlwZSwKLQkJCWFjdGl2aXR5X21v
bml0b3IuU29jX01pbkFjdGl2ZUZyZXEsCi0JCQlhY3Rpdml0eV9tb25pdG9yLlNvY19Cb29zdGVy
RnJlcVR5cGUsCi0JCQlhY3Rpdml0eV9tb25pdG9yLlNvY19Cb29zdGVyRnJlcSwKLQkJCWFjdGl2
aXR5X21vbml0b3IuU29jX1BEX0RhdGFfbGltaXRfYywKLQkJCWFjdGl2aXR5X21vbml0b3IuU29j
X1BEX0RhdGFfZXJyb3JfY29lZmYsCi0JCQlhY3Rpdml0eV9tb25pdG9yLlNvY19QRF9EYXRhX2Vy
cm9yX3JhdGVfY29lZmYpOwotCi0JCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiJTE5cyAl
ZCglMTNzKSAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZFxuIiwKLQkJCSIgIiwK
LQkJCTIsCi0JCQkiTUVNTEsiLAotCQkJYWN0aXZpdHlfbW9uaXRvci5NZW1fRlBTLAotCQkJYWN0
aXZpdHlfbW9uaXRvci5NZW1fTWluRnJlcVN0ZXAsCi0JCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9N
aW5BY3RpdmVGcmVxVHlwZSwKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX01pbkFjdGl2ZUZyZXEs
Ci0JCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9Cb29zdGVyRnJlcVR5cGUsCi0JCQlhY3Rpdml0eV9t
b25pdG9yLk1lbV9Cb29zdGVyRnJlcSwKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX1BEX0RhdGFf
bGltaXRfYywKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX1BEX0RhdGFfZXJyb3JfY29lZmYsCi0J
CQlhY3Rpdml0eV9tb25pdG9yLk1lbV9QRF9EYXRhX2Vycm9yX3JhdGVfY29lZmYpOwotCX0KLQot
CXJldHVybiBzaXplOwotfQotCi1zdGF0aWMgaW50IG5hdmkxMF9zZXRfcG93ZXJfcHJvZmlsZV9t
b2RlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBsb25nICppbnB1dCwgdWludDMyX3Qgc2l6ZSkK
LXsKLQlEcG1BY3Rpdml0eU1vbml0b3JDb2VmZkludF90IGFjdGl2aXR5X21vbml0b3I7Ci0JaW50
IHdvcmtsb2FkX3R5cGUsIHJldCA9IDA7Ci0KLQlzbXUtPnBvd2VyX3Byb2ZpbGVfbW9kZSA9IGlu
cHV0W3NpemVdOwotCi0JaWYgKHNtdS0+cG93ZXJfcHJvZmlsZV9tb2RlID4gUFBfU01DX1BPV0VS
X1BST0ZJTEVfQ1VTVE9NKSB7Ci0JCXByX2VycigiSW52YWxpZCBwb3dlciBwcm9maWxlIG1vZGUg
JWRcbiIsIHNtdS0+cG93ZXJfcHJvZmlsZV9tb2RlKTsKLQkJcmV0dXJuIC1FSU5WQUw7Ci0JfQot
Ci0JaWYgKHNtdS0+cG93ZXJfcHJvZmlsZV9tb2RlID09IFBQX1NNQ19QT1dFUl9QUk9GSUxFX0NV
U1RPTSkgewotCQlpZiAoc2l6ZSA8IDApCi0JCQlyZXR1cm4gLUVJTlZBTDsKLQotCQlyZXQgPSBz
bXVfdXBkYXRlX3RhYmxlKHNtdSwKLQkJCQkgICAgICAgU01VX1RBQkxFX0FDVElWSVRZX01PTklU
T1JfQ09FRkYgfCBXT1JLTE9BRF9QUExJQl9DVVNUT01fQklUIDw8IDE2LAotCQkJCSAgICAgICAo
dm9pZCAqKSgmYWN0aXZpdHlfbW9uaXRvciksIGZhbHNlKTsKLQkJaWYgKHJldCkgewotCQkJcHJf
ZXJyKCJbJXNdIEZhaWxlZCB0byBnZXQgYWN0aXZpdHkgbW9uaXRvciEiLCBfX2Z1bmNfXyk7Ci0J
CQlyZXR1cm4gcmV0OwotCQl9Ci0KLQkJc3dpdGNoIChpbnB1dFswXSkgewotCQljYXNlIDA6IC8q
IEdmeGNsayAqLwotCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfRlBTID0gaW5wdXRbMV07Ci0JCQlh
Y3Rpdml0eV9tb25pdG9yLkdmeF9NaW5GcmVxU3RlcCA9IGlucHV0WzJdOwotCQkJYWN0aXZpdHlf
bW9uaXRvci5HZnhfTWluQWN0aXZlRnJlcVR5cGUgPSBpbnB1dFszXTsKLQkJCWFjdGl2aXR5X21v
bml0b3IuR2Z4X01pbkFjdGl2ZUZyZXEgPSBpbnB1dFs0XTsKLQkJCWFjdGl2aXR5X21vbml0b3Iu
R2Z4X0Jvb3N0ZXJGcmVxVHlwZSA9IGlucHV0WzVdOwotCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhf
Qm9vc3RlckZyZXEgPSBpbnB1dFs2XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X1BEX0RhdGFf
bGltaXRfYyA9IGlucHV0WzddOwotCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfUERfRGF0YV9lcnJv
cl9jb2VmZiA9IGlucHV0WzhdOwotCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfUERfRGF0YV9lcnJv
cl9yYXRlX2NvZWZmID0gaW5wdXRbOV07Ci0JCQlicmVhazsKLQkJY2FzZSAxOiAvKiBTb2NjbGsg
Ki8KLQkJCWFjdGl2aXR5X21vbml0b3IuU29jX0ZQUyA9IGlucHV0WzFdOwotCQkJYWN0aXZpdHlf
bW9uaXRvci5Tb2NfTWluRnJlcVN0ZXAgPSBpbnB1dFsyXTsKLQkJCWFjdGl2aXR5X21vbml0b3Iu
U29jX01pbkFjdGl2ZUZyZXFUeXBlID0gaW5wdXRbM107Ci0JCQlhY3Rpdml0eV9tb25pdG9yLlNv
Y19NaW5BY3RpdmVGcmVxID0gaW5wdXRbNF07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLlNvY19Cb29z
dGVyRnJlcVR5cGUgPSBpbnB1dFs1XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuU29jX0Jvb3N0ZXJG
cmVxID0gaW5wdXRbNl07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLlNvY19QRF9EYXRhX2xpbWl0X2Mg
PSBpbnB1dFs3XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuU29jX1BEX0RhdGFfZXJyb3JfY29lZmYg
PSBpbnB1dFs4XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuU29jX1BEX0RhdGFfZXJyb3JfcmF0ZV9j
b2VmZiA9IGlucHV0WzldOwotCQkJYnJlYWs7Ci0JCWNhc2UgMjogLyogTWVtbGsgKi8KLQkJCWFj
dGl2aXR5X21vbml0b3IuTWVtX0ZQUyA9IGlucHV0WzFdOwotCQkJYWN0aXZpdHlfbW9uaXRvci5N
ZW1fTWluRnJlcVN0ZXAgPSBpbnB1dFsyXTsKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX01pbkFj
dGl2ZUZyZXFUeXBlID0gaW5wdXRbM107Ci0JCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9NaW5BY3Rp
dmVGcmVxID0gaW5wdXRbNF07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9Cb29zdGVyRnJlcVR5
cGUgPSBpbnB1dFs1XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX0Jvb3N0ZXJGcmVxID0gaW5w
dXRbNl07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9QRF9EYXRhX2xpbWl0X2MgPSBpbnB1dFs3
XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX1BEX0RhdGFfZXJyb3JfY29lZmYgPSBpbnB1dFs4
XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX1BEX0RhdGFfZXJyb3JfcmF0ZV9jb2VmZiA9IGlu
cHV0WzldOwotCQkJYnJlYWs7Ci0JCX0KLQotCQlyZXQgPSBzbXVfdXBkYXRlX3RhYmxlKHNtdSwK
LQkJCQkgICAgICAgU01VX1RBQkxFX0FDVElWSVRZX01PTklUT1JfQ09FRkYgfCBXT1JLTE9BRF9Q
UExJQl9DVVNUT01fQklUIDw8IDE2LAotCQkJCSAgICAgICAodm9pZCAqKSgmYWN0aXZpdHlfbW9u
aXRvciksIHRydWUpOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIoIlslc10gRmFpbGVkIHRvIHNl
dCBhY3Rpdml0eSBtb25pdG9yISIsIF9fZnVuY19fKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KLQl9
Ci0KLQkvKiBjb252IFBQX1NNQ19QT1dFUl9QUk9GSUxFKiB0byBXT1JLTE9BRF9QUExJQl8qX0JJ
VCAqLwotCXdvcmtsb2FkX3R5cGUgPSBzbXVfd29ya2xvYWRfZ2V0X3R5cGUoc211LCBzbXUtPnBv
d2VyX3Byb2ZpbGVfbW9kZSk7Ci0Jc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwgU01V
X01TR19TZXRXb3JrbG9hZE1hc2ssCi0JCQkJICAgIDEgPDwgd29ya2xvYWRfdHlwZSk7Ci0KLQly
ZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IG5hdmkxMF9nZXRfcHJvZmlsaW5nX2Nsa19tYXNr
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LAotCQkJCQkgZW51bSBhbWRfZHBtX2ZvcmNlZF9sZXZl
bCBsZXZlbCwKLQkJCQkJIHVpbnQzMl90ICpzY2xrX21hc2ssCi0JCQkJCSB1aW50MzJfdCAqbWNs
a19tYXNrLAotCQkJCQkgdWludDMyX3QgKnNvY19tYXNrKQotewotCWludCByZXQgPSAwOwotCXVp
bnQzMl90IGxldmVsX2NvdW50ID0gMDsKLQotCWlmIChsZXZlbCA9PSBBTURfRFBNX0ZPUkNFRF9M
RVZFTF9QUk9GSUxFX01JTl9TQ0xLKSB7Ci0JCWlmIChzY2xrX21hc2spCi0JCQkqc2Nsa19tYXNr
ID0gMDsKLQl9IGVsc2UgaWYgKGxldmVsID09IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVf
TUlOX01DTEspIHsKLQkJaWYgKG1jbGtfbWFzaykKLQkJCSptY2xrX21hc2sgPSAwOwotCX0gZWxz
ZSBpZiAobGV2ZWwgPT0gQU1EX0RQTV9GT1JDRURfTEVWRUxfUFJPRklMRV9QRUFLKSB7Ci0JCWlm
KHNjbGtfbWFzaykgewotCQkJcmV0ID0gc211X2dldF9kcG1fbGV2ZWxfY291bnQoc211LCBTTVVf
U0NMSywgJmxldmVsX2NvdW50KTsKLQkJCWlmIChyZXQpCi0JCQkJcmV0dXJuIHJldDsKLQkJCSpz
Y2xrX21hc2sgPSBsZXZlbF9jb3VudCAtIDE7Ci0JCX0KLQotCQlpZihtY2xrX21hc2spIHsKLQkJ
CXJldCA9IHNtdV9nZXRfZHBtX2xldmVsX2NvdW50KHNtdSwgU01VX01DTEssICZsZXZlbF9jb3Vu
dCk7Ci0JCQlpZiAocmV0KQotCQkJCXJldHVybiByZXQ7Ci0JCQkqc2Nsa19tYXNrID0gbGV2ZWxf
Y291bnQgLSAxOwotCQl9Ci0KLQkJaWYoc29jX21hc2spIHsKLQkJCXJldCA9IHNtdV9nZXRfZHBt
X2xldmVsX2NvdW50KHNtdSwgU01VX1NPQ0NMSywgJmxldmVsX2NvdW50KTsKLQkJCWlmIChyZXQp
Ci0JCQkJcmV0dXJuIHJldDsKLQkJCSpzY2xrX21hc2sgPSBsZXZlbF9jb3VudCAtIDE7Ci0JCX0K
LQl9Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IG5hdmkxMF9ub3RpZnlfc21jX2Rp
c3BhbHlfY29uZmlnKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQotewotCXN0cnVjdCBzbXVfY2xv
Y2tzIG1pbl9jbG9ja3MgPSB7MH07Ci0Jc3RydWN0IHBwX2Rpc3BsYXlfY2xvY2tfcmVxdWVzdCBj
bG9ja19yZXE7Ci0JaW50IHJldCA9IDA7Ci0KLQltaW5fY2xvY2tzLmRjZWZfY2xvY2sgPSBzbXUt
PmRpc3BsYXlfY29uZmlnLT5taW5fZGNlZl9zZXRfY2xrOwotCW1pbl9jbG9ja3MuZGNlZl9jbG9j
a19pbl9zciA9IHNtdS0+ZGlzcGxheV9jb25maWctPm1pbl9kY2VmX2RlZXBfc2xlZXBfc2V0X2Ns
azsKLQltaW5fY2xvY2tzLm1lbW9yeV9jbG9jayA9IHNtdS0+ZGlzcGxheV9jb25maWctPm1pbl9t
ZW1fc2V0X2Nsb2NrOwotCi0JaWYgKHNtdV9mZWF0dXJlX2lzX3N1cHBvcnRlZChzbXUsIFNNVV9G
RUFUVVJFX0RQTV9EQ0VGQ0xLX0JJVCkpIHsKLQkJY2xvY2tfcmVxLmNsb2NrX3R5cGUgPSBhbWRf
cHBfZGNlZl9jbG9jazsKLQkJY2xvY2tfcmVxLmNsb2NrX2ZyZXFfaW5fa2h6ID0gbWluX2Nsb2Nr
cy5kY2VmX2Nsb2NrICogMTA7Ci0JCWlmICghc211X2Rpc3BsYXlfY2xvY2tfdm9sdGFnZV9yZXF1
ZXN0KHNtdSwgJmNsb2NrX3JlcSkpIHsKLQkJCWlmIChzbXVfZmVhdHVyZV9pc19zdXBwb3J0ZWQo
c211LCBTTVVfRkVBVFVSRV9EU19EQ0VGQ0xLX0JJVCkpIHsKLQkJCQlyZXQgPSBzbXVfc2VuZF9z
bWNfbXNnX3dpdGhfcGFyYW0oc211LAotCQkJCQkJCQkgIFNNVV9NU0dfU2V0TWluRGVlcFNsZWVw
RGNlZmNsaywKLQkJCQkJCQkJICBtaW5fY2xvY2tzLmRjZWZfY2xvY2tfaW5fc3IvMTAwKTsKLQkJ
CQlpZiAocmV0KSB7Ci0JCQkJCXByX2VycigiQXR0ZW1wdCB0byBzZXQgZGl2aWRlciBmb3IgRENF
RkNMSyBGYWlsZWQhIik7Ci0JCQkJCXJldHVybiByZXQ7Ci0JCQkJfQotCQkJfQotCQl9IGVsc2Ug
ewotCQkJcHJfaW5mbygiQXR0ZW1wdCB0byBzZXQgSGFyZCBNaW4gZm9yIERDRUZDTEsgRmFpbGVk
ISIpOwotCQl9Ci0JfQotCi0JaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVB
VFVSRV9EUE1fVUNMS19CSVQpKSB7Ci0JCXJldCA9IHNtdV9zZXRfaGFyZF9mcmVxX3JhbmdlKHNt
dSwgU01VX1VDTEssIG1pbl9jbG9ja3MubWVtb3J5X2Nsb2NrLzEwMCwgMCk7Ci0JCWlmIChyZXQp
IHsKLQkJCXByX2VycigiWyVzXSBTZXQgaGFyZCBtaW4gdWNsayBmYWlsZWQhIiwgX19mdW5jX18p
OwotCQkJcmV0dXJuIHJldDsKLQkJfQotCX0KLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50
IG5hdmkxMF9zZXRfd2F0ZXJtYXJrc190YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKLQkJ
CQkgICAgICAgdm9pZCAqd2F0ZXJtYXJrcywgc3RydWN0Ci0JCQkJICAgICAgIGRtX3BwX3dtX3Nl
dHNfd2l0aF9jbG9ja19yYW5nZXNfc29jMTUKLQkJCQkgICAgICAgKmNsb2NrX3JhbmdlcykKLXsK
LQlpbnQgaTsKLQlXYXRlcm1hcmtzX3QgKnRhYmxlID0gd2F0ZXJtYXJrczsKLQotCWlmICghdGFi
bGUgfHwgIWNsb2NrX3JhbmdlcykKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlpZiAoY2xvY2tfcmFu
Z2VzLT5udW1fd21fZG1pZl9zZXRzID4gNCB8fAotCSAgICBjbG9ja19yYW5nZXMtPm51bV93bV9t
Y2lmX3NldHMgPiA0KQotICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwotCi0gICAgICAg
IGZvciAoaSA9IDA7IGkgPCBjbG9ja19yYW5nZXMtPm51bV93bV9kbWlmX3NldHM7IGkrKykgewot
CQl0YWJsZS0+V2F0ZXJtYXJrUm93WzFdW2ldLk1pbkNsb2NrID0KLQkJCWNwdV90b19sZTE2KCh1
aW50MTZfdCkKLQkJCShjbG9ja19yYW5nZXMtPndtX2RtaWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9t
aW5fZGNmY2xrX2Nsa19pbl9raHogLwotCQkJMTAwMCkpOwotCQl0YWJsZS0+V2F0ZXJtYXJrUm93
WzFdW2ldLk1heENsb2NrID0KLQkJCWNwdV90b19sZTE2KCh1aW50MTZfdCkKLQkJCShjbG9ja19y
YW5nZXMtPndtX2RtaWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9tYXhfZGNmY2xrX2Nsa19pbl9raHog
LwotCQkJMTAwMCkpOwotCQl0YWJsZS0+V2F0ZXJtYXJrUm93WzFdW2ldLk1pblVjbGsgPQotCQkJ
Y3B1X3RvX2xlMTYoKHVpbnQxNl90KQotCQkJKGNsb2NrX3Jhbmdlcy0+d21fZG1pZl9jbG9ja3Nf
cmFuZ2VzW2ldLndtX21pbl9tZW1fY2xrX2luX2toeiAvCi0JCQkxMDAwKSk7Ci0JCXRhYmxlLT5X
YXRlcm1hcmtSb3dbMV1baV0uTWF4VWNsayA9Ci0JCQljcHVfdG9fbGUxNigodWludDE2X3QpCi0J
CQkoY2xvY2tfcmFuZ2VzLT53bV9kbWlmX2Nsb2Nrc19yYW5nZXNbaV0ud21fbWF4X21lbV9jbGtf
aW5fa2h6IC8KLQkJCTEwMDApKTsKLQkJdGFibGUtPldhdGVybWFya1Jvd1sxXVtpXS5XbVNldHRp
bmcgPSAodWludDhfdCkKLQkJCQljbG9ja19yYW5nZXMtPndtX2RtaWZfY2xvY2tzX3Jhbmdlc1tp
XS53bV9zZXRfaWQ7Ci0gICAgICAgIH0KLQotCWZvciAoaSA9IDA7IGkgPCBjbG9ja19yYW5nZXMt
Pm51bV93bV9tY2lmX3NldHM7IGkrKykgewotCQl0YWJsZS0+V2F0ZXJtYXJrUm93WzBdW2ldLk1p
bkNsb2NrID0KLQkJCWNwdV90b19sZTE2KCh1aW50MTZfdCkKLQkJCShjbG9ja19yYW5nZXMtPndt
X21jaWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9taW5fc29jY2xrX2Nsa19pbl9raHogLwotCQkJMTAw
MCkpOwotCQl0YWJsZS0+V2F0ZXJtYXJrUm93WzBdW2ldLk1heENsb2NrID0KLQkJCWNwdV90b19s
ZTE2KCh1aW50MTZfdCkKLQkJCShjbG9ja19yYW5nZXMtPndtX21jaWZfY2xvY2tzX3Jhbmdlc1tp
XS53bV9tYXhfc29jY2xrX2Nsa19pbl9raHogLwotCQkJMTAwMCkpOwotCQl0YWJsZS0+V2F0ZXJt
YXJrUm93WzBdW2ldLk1pblVjbGsgPQotCQkJY3B1X3RvX2xlMTYoKHVpbnQxNl90KQotCQkJKGNs
b2NrX3Jhbmdlcy0+d21fbWNpZl9jbG9ja3NfcmFuZ2VzW2ldLndtX21pbl9tZW1fY2xrX2luX2to
eiAvCi0JCQkxMDAwKSk7Ci0JCXRhYmxlLT5XYXRlcm1hcmtSb3dbMF1baV0uTWF4VWNsayA9Ci0J
CQljcHVfdG9fbGUxNigodWludDE2X3QpCi0JCQkoY2xvY2tfcmFuZ2VzLT53bV9tY2lmX2Nsb2Nr
c19yYW5nZXNbaV0ud21fbWF4X21lbV9jbGtfaW5fa2h6IC8KLQkJCTEwMDApKTsKLQkJdGFibGUt
PldhdGVybWFya1Jvd1swXVtpXS5XbVNldHRpbmcgPSAodWludDhfdCkKLQkJCQljbG9ja19yYW5n
ZXMtPndtX21jaWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9zZXRfaWQ7Ci0gICAgICAgIH0KLQotCXJl
dHVybiAwOwotfQotCi1zdGF0aWMgaW50IG5hdmkxMF9yZWFkX3NlbnNvcihzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSwKLQkJCQkgZW51bSBhbWRfcHBfc2Vuc29ycyBzZW5zb3IsCi0JCQkJIHZvaWQg
KmRhdGEsIHVpbnQzMl90ICpzaXplKQotewotCWludCByZXQgPSAwOwotCXN0cnVjdCBzbXVfdGFi
bGVfY29udGV4dCAqdGFibGVfY29udGV4dCA9ICZzbXUtPnNtdV90YWJsZTsKLQlQUFRhYmxlX3Qg
KnBwdGFibGUgPSB0YWJsZV9jb250ZXh0LT5kcml2ZXJfcHB0YWJsZTsKLQotCXN3aXRjaCAoc2Vu
c29yKSB7Ci0JY2FzZSBBTURHUFVfUFBfU0VOU09SX01BWF9GQU5fUlBNOgotCQkqKHVpbnQzMl90
ICopZGF0YSA9IHBwdGFibGUtPkZhbk1heGltdW1ScG07Ci0JCSpzaXplID0gNDsKLQkJYnJlYWs7
Ci0JY2FzZSBBTURHUFVfUFBfU0VOU09SX0dQVV9MT0FEOgotCQlyZXQgPSBuYXZpMTBfZ2V0X2N1
cnJlbnRfYWN0aXZpdHlfcGVyY2VudChzbXUsICh1aW50MzJfdCAqKWRhdGEpOwotCQkqc2l6ZSA9
IDQ7Ci0JCWJyZWFrOwotCWNhc2UgQU1ER1BVX1BQX1NFTlNPUl9HUFVfUE9XRVI6Ci0JCXJldCA9
IG5hdmkxMF9nZXRfZ3B1X3Bvd2VyKHNtdSwgKHVpbnQzMl90ICopZGF0YSk7Ci0JCSpzaXplID0g
NDsKLQkJYnJlYWs7Ci0JZGVmYXVsdDoKLQkJcmV0dXJuIC1FSU5WQUw7Ci0JfQotCi0JcmV0dXJu
IHJldDsKLX0KLQotc3RhdGljIGludCBuYXZpMTBfZ2V0X3VjbGtfZHBtX3N0YXRlcyhzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSwgdWludDMyX3QgKmNsb2Nrc19pbl9raHosIHVpbnQzMl90ICpudW1f
c3RhdGVzKQotewotCXVpbnQzMl90IG51bV9kaXNjcmV0ZV9sZXZlbHMgPSAwOwotCXVpbnQxNl90
ICpkcG1fbGV2ZWxzID0gTlVMTDsKLQl1aW50MTZfdCBpID0gMDsKLQlzdHJ1Y3Qgc211X3RhYmxl
X2NvbnRleHQgKnRhYmxlX2NvbnRleHQgPSAmc211LT5zbXVfdGFibGU7Ci0JUFBUYWJsZV90ICpk
cml2ZXJfcHB0ID0gTlVMTDsKLQotCWlmICghY2xvY2tzX2luX2toeiB8fCAhIG51bV9zdGF0ZXMg
fHwgIXRhYmxlX2NvbnRleHQtPmRyaXZlcl9wcHRhYmxlKQotCQlyZXR1cm4gLUVJTlZBTDsKLQot
CWRyaXZlcl9wcHQgPSB0YWJsZV9jb250ZXh0LT5kcml2ZXJfcHB0YWJsZTsKLQludW1fZGlzY3Jl
dGVfbGV2ZWxzID0gZHJpdmVyX3BwdC0+RHBtRGVzY3JpcHRvcltQUENMS19VQ0xLXS5OdW1EaXNj
cmV0ZUxldmVsczsKLQlkcG1fbGV2ZWxzID0gZHJpdmVyX3BwdC0+RnJlcVRhYmxlVWNsazsKLQot
CWlmIChudW1fZGlzY3JldGVfbGV2ZWxzID09IDAgfHwgZHBtX2xldmVscyA9PSBOVUxMKQotCQly
ZXR1cm4gLUVJTlZBTDsKLQotCSpudW1fc3RhdGVzID0gbnVtX2Rpc2NyZXRlX2xldmVsczsKLQlm
b3IgKGkgPSAwOyBpIDwgbnVtX2Rpc2NyZXRlX2xldmVsczsgaSsrKSB7Ci0JCS8qIGNvbnZlcnQg
dG8ga2h6ICovCi0JCSpjbG9ja3NfaW5fa2h6ID0gKCpkcG1fbGV2ZWxzKSAqIDEwMDA7Ci0JCWNs
b2Nrc19pbl9raHorKzsKLQkJZHBtX2xldmVscysrOwotCX0KLQotCXJldHVybiAwOwotfQotCi1z
dGF0aWMgaW50IG5hdmkxMF9nZXRfcHBmZWF0dXJlX3N0YXR1cyhzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSwKLQkJCQkgICAgICAgY2hhciAqYnVmKQotewotCXN0YXRpYyBjb25zdCBjaGFyICpwcGZl
YXR1cmVfbmFtZVtdID0gewotCQkJCSJEUE1fUFJFRkVUQ0hFUiIsCi0JCQkJIkRQTV9HRlhDTEsi
LAotCQkJCSJEUE1fR0ZYX1BBQ0UiLAotCQkJCSJEUE1fVUNMSyIsCi0JCQkJIkRQTV9TT0NDTEsi
LAotCQkJCSJEUE1fTVAwQ0xLIiwKLQkJCQkiRFBNX0xJTksiLAotCQkJCSJEUE1fRENFRkNMSyIs
Ci0JCQkJIk1FTV9WRERDSV9TQ0FMSU5HIiwKLQkJCQkiTUVNX01WRERfU0NBTElORyIsCi0JCQkJ
IkRTX0dGWENMSyIsCi0JCQkJIkRTX1NPQ0NMSyIsCi0JCQkJIkRTX0xDTEsiLAotCQkJCSJEU19E
Q0VGQ0xLIiwKLQkJCQkiRFNfVUNMSyIsCi0JCQkJIkdGWF9VTFYiLAotCQkJCSJGV19EU1RBVEUi
LAotCQkJCSJHRlhPRkYiLAotCQkJCSJCQUNPIiwKLQkJCQkiVkNOX1BHIiwKLQkJCQkiSlBFR19Q
RyIsCi0JCQkJIlVTQl9QRyIsCi0JCQkJIlJTTVVfU01OX0NHIiwKLQkJCQkiUFBUIiwKLQkJCQki
VERDIiwKLQkJCQkiR0ZYX0VEQyIsCi0JCQkJIkFQQ0NfUExVUyIsCi0JCQkJIkdUSFIiLAotCQkJ
CSJBQ0RDIiwKLQkJCQkiVlIwSE9UIiwKLQkJCQkiVlIxSE9UIiwKLQkJCQkiRldfQ1RGIiwKLQkJ
CQkiRkFOX0NPTlRST0wiLAotCQkJCSJUSEVSTUFMIiwKLQkJCQkiR0ZYX0RDUyIsCi0JCQkJIlJN
IiwKLQkJCQkiTEVEX0RJU1BMQVkiLAotCQkJCSJHRlhfU1MiLAotCQkJCSJPVVRfT0ZfQkFORF9N
T05JVE9SIiwKLQkJCQkiVEVNUF9ERVBFTkRFTlRfVk1JTiIsCi0JCQkJIk1NSFVCX1BHIiwKLQkJ
CQkiQVRIVUJfUEcifTsKLQlzdGF0aWMgY29uc3QgY2hhciAqb3V0cHV0X3RpdGxlW10gPSB7Ci0J
CQkJIkZFQVRVUkVTIiwKLQkJCQkiQklUTUFTSyIsCi0JCQkJIkVOQUJMRU1FTlQifTsKLQl1aW50
NjRfdCBmZWF0dXJlc19lbmFibGVkOwotCXVpbnQzMl90IGZlYXR1cmVfbWFza1syXTsKLQlpbnQg
aTsKLQlpbnQgcmV0ID0gMDsKLQlpbnQgc2l6ZSA9IDA7Ci0KLQlyZXQgPSBzbXVfZmVhdHVyZV9n
ZXRfZW5hYmxlZF9tYXNrKHNtdSwgZmVhdHVyZV9tYXNrLCAyKTsKLQlQUF9BU1NFUlRfV0lUSF9D
T0RFKCFyZXQsCi0JCQkiW0dldFBQZmVhdHVyZVN0YXR1c10gRmFpbGVkIHRvIGdldCBlbmFibGVk
IHNtYyBmZWF0dXJlcyEiLAotCQkJcmV0dXJuIHJldCk7Ci0JZmVhdHVyZXNfZW5hYmxlZCA9ICh1
aW50NjRfdClmZWF0dXJlX21hc2tbMF0gfAotCQkJICAgKHVpbnQ2NF90KWZlYXR1cmVfbWFza1sx
XSA8PCAzMjsKLQotCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiQ3VycmVudCBwcGZlYXR1
cmVzOiAweCUwMTZsbHhcbiIsIGZlYXR1cmVzX2VuYWJsZWQpOwotCXNpemUgKz0gc3ByaW50Zihi
dWYgKyBzaXplLCAiJS0xOXMgJS0yMnMgJXNcbiIsCi0JCQkJb3V0cHV0X3RpdGxlWzBdLAotCQkJ
CW91dHB1dF90aXRsZVsxXSwKLQkJCQlvdXRwdXRfdGl0bGVbMl0pOwotCWZvciAoaSA9IDA7IGkg
PCAoc2l6ZW9mKHBwZmVhdHVyZV9uYW1lKSAvIHNpemVvZihwcGZlYXR1cmVfbmFtZVswXSkpOyBp
KyspIHsKLQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIlLTE5cyAweCUwMTZsbHggJTZz
XG4iLAotCQkJCQlwcGZlYXR1cmVfbmFtZVtpXSwKLQkJCQkJMVVMTCA8PCBpLAotCQkJCQkoZmVh
dHVyZXNfZW5hYmxlZCAmICgxVUxMIDw8IGkpKSA/ICJZIiA6ICJOIik7Ci0JfQotCi0JcmV0dXJu
IHNpemU7Ci19Ci0KLXN0YXRpYyBpbnQgbmF2aTEwX2VuYWJsZV9zbWNfZmVhdHVyZXMoc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUsCi0JCQkJICAgICAgYm9vbCBlbmFibGVkLAotCQkJCSAgICAgIHVp
bnQ2NF90IGZlYXR1cmVfbWFza3MpCi17Ci0Jc3RydWN0IHNtdV9mZWF0dXJlICpmZWF0dXJlID0g
JnNtdS0+c211X2ZlYXR1cmU7Ci0JdWludDMyX3QgZmVhdHVyZV9sb3csIGZlYXR1cmVfaGlnaDsK
LQl1aW50MzJfdCBmZWF0dXJlX21hc2tbMl07Ci0JaW50IHJldCA9IDA7Ci0KLQlmZWF0dXJlX2xv
dyA9ICh1aW50MzJfdCkoZmVhdHVyZV9tYXNrcyAmIDB4RkZGRkZGRkYpOwotCWZlYXR1cmVfaGln
aCA9ICh1aW50MzJfdCkoKGZlYXR1cmVfbWFza3MgJiAweEZGRkZGRkZGMDAwMDAwMDBVTEwpID4+
IDMyKTsKLQotCWlmIChlbmFibGVkKSB7Ci0JCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9w
YXJhbShzbXUsIFNNVV9NU0dfRW5hYmxlU211RmVhdHVyZXNMb3csCi0JCQkJCQkgIGZlYXR1cmVf
bG93KTsKLQkJaWYgKHJldCkKLQkJCXJldHVybiByZXQ7Ci0JCXJldCA9IHNtdV9zZW5kX3NtY19t
c2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfRW5hYmxlU211RmVhdHVyZXNIaWdoLAotCQkJCQkJ
ICBmZWF0dXJlX2hpZ2gpOwotCQlpZiAocmV0KQotCQkJcmV0dXJuIHJldDsKLQl9IGVsc2Ugewot
CQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LCBTTVVfTVNHX0Rpc2FibGVT
bXVGZWF0dXJlc0xvdywKLQkJCQkJCSAgZmVhdHVyZV9sb3cpOwotCQlpZiAocmV0KQotCQkJcmV0
dXJuIHJldDsKLQkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwgU01VX01T
R19EaXNhYmxlU211RmVhdHVyZXNIaWdoLAotCQkJCQkJICBmZWF0dXJlX2hpZ2gpOwotCQlpZiAo
cmV0KQotCQkJcmV0dXJuIHJldDsKLQl9Ci0KLQlyZXQgPSBzbXVfZmVhdHVyZV9nZXRfZW5hYmxl
ZF9tYXNrKHNtdSwgZmVhdHVyZV9tYXNrLCAyKTsKLQlpZiAocmV0KQotCQlyZXR1cm4gcmV0Owot
Ci0JbXV0ZXhfbG9jaygmZmVhdHVyZS0+bXV0ZXgpOwotCWJpdG1hcF9jb3B5KGZlYXR1cmUtPmVu
YWJsZWQsICh1bnNpZ25lZCBsb25nICopJmZlYXR1cmVfbWFzaywKLQkJICAgIGZlYXR1cmUtPmZl
YXR1cmVfbnVtKTsKLQltdXRleF91bmxvY2soJmZlYXR1cmUtPm11dGV4KTsKLQotCXJldHVybiAw
OwotfQotCi1zdGF0aWMgaW50IG5hdmkxMF9zZXRfcHBmZWF0dXJlX3N0YXR1cyhzdHJ1Y3Qgc211
X2NvbnRleHQgKnNtdSwKLQkJCQkgICAgICAgdWludDY0X3QgbmV3X3BwZmVhdHVyZV9tYXNrcykK
LXsKLQl1aW50NjRfdCBmZWF0dXJlc19lbmFibGVkOwotCXVpbnQzMl90IGZlYXR1cmVfbWFza1sy
XTsKLQl1aW50NjRfdCBmZWF0dXJlc190b19lbmFibGU7Ci0JdWludDY0X3QgZmVhdHVyZXNfdG9f
ZGlzYWJsZTsKLQlpbnQgcmV0ID0gMDsKLQotCXJldCA9IHNtdV9mZWF0dXJlX2dldF9lbmFibGVk
X21hc2soc211LCBmZWF0dXJlX21hc2ssIDIpOwotCVBQX0FTU0VSVF9XSVRIX0NPREUoIXJldCwK
LQkJCSJbU2V0UFBmZWF0dXJlU3RhdHVzXSBGYWlsZWQgdG8gZ2V0IGVuYWJsZWQgc21jIGZlYXR1
cmVzISIsCi0JCQlyZXR1cm4gcmV0KTsKLQlmZWF0dXJlc19lbmFibGVkID0gKHVpbnQ2NF90KWZl
YXR1cmVfbWFza1swXSB8Ci0JCQkgICAodWludDY0X3QpZmVhdHVyZV9tYXNrWzFdIDw8IDMyOwot
Ci0JZmVhdHVyZXNfdG9fZGlzYWJsZSA9Ci0JCWZlYXR1cmVzX2VuYWJsZWQgJiB+bmV3X3BwZmVh
dHVyZV9tYXNrczsKLQlmZWF0dXJlc190b19lbmFibGUgPQotCQl+ZmVhdHVyZXNfZW5hYmxlZCAm
IG5ld19wcGZlYXR1cmVfbWFza3M7Ci0KLQlwcl9kZWJ1ZygiZmVhdHVyZXNfdG9fZGlzYWJsZSAw
eCVsbHhcbiIsIGZlYXR1cmVzX3RvX2Rpc2FibGUpOwotCXByX2RlYnVnKCJmZWF0dXJlc190b19l
bmFibGUgMHglbGx4XG4iLCBmZWF0dXJlc190b19lbmFibGUpOwotCi0JaWYgKGZlYXR1cmVzX3Rv
X2Rpc2FibGUpIHsKLQkJcmV0ID0gbmF2aTEwX2VuYWJsZV9zbWNfZmVhdHVyZXMoc211LCBmYWxz
ZSwgZmVhdHVyZXNfdG9fZGlzYWJsZSk7Ci0JCVBQX0FTU0VSVF9XSVRIX0NPREUoIXJldCwKLQkJ
CQkiW1NldFBQZmVhdHVyZVN0YXR1c10gRmFpbGVkIHRvIGRpc2FibGUgc21jIGZlYXR1cmVzISIs
Ci0JCQkJcmV0dXJuIHJldCk7Ci0JfQotCi0JaWYgKGZlYXR1cmVzX3RvX2VuYWJsZSkgewotCQly
ZXQgPSBuYXZpMTBfZW5hYmxlX3NtY19mZWF0dXJlcyhzbXUsIHRydWUsIGZlYXR1cmVzX3RvX2Vu
YWJsZSk7Ci0JCVBQX0FTU0VSVF9XSVRIX0NPREUoIXJldCwKLQkJCQkiW1NldFBQZmVhdHVyZVN0
YXR1c10gRmFpbGVkIHRvIGVuYWJsZSBzbWMgZmVhdHVyZXMhIiwKLQkJCQlyZXR1cm4gcmV0KTsK
LQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGNvbnN0IHN0cnVjdCBwcHRhYmxlX2Z1bmNz
IG5hdmkxMF9wcHRfZnVuY3MgPSB7Ci0JLnRhYmxlc19pbml0ID0gbmF2aTEwX3RhYmxlc19pbml0
LAotCS5hbGxvY19kcG1fY29udGV4dCA9IG5hdmkxMF9hbGxvY2F0ZV9kcG1fY29udGV4dCwKLQku
c3RvcmVfcG93ZXJwbGF5X3RhYmxlID0gbmF2aTEwX3N0b3JlX3Bvd2VycGxheV90YWJsZSwKLQku
Y2hlY2tfcG93ZXJwbGF5X3RhYmxlID0gbmF2aTEwX2NoZWNrX3Bvd2VycGxheV90YWJsZSwKLQku
YXBwZW5kX3Bvd2VycGxheV90YWJsZSA9IG5hdmkxMF9hcHBlbmRfcG93ZXJwbGF5X3RhYmxlLAot
CS5nZXRfc211X21zZ19pbmRleCA9IG5hdmkxMF9nZXRfc211X21zZ19pbmRleCwKLQkuZ2V0X3Nt
dV9jbGtfaW5kZXggPSBuYXZpMTBfZ2V0X3NtdV9jbGtfaW5kZXgsCi0JLmdldF9zbXVfZmVhdHVy
ZV9pbmRleCA9IG5hdmkxMF9nZXRfc211X2ZlYXR1cmVfaW5kZXgsCi0JLmdldF9zbXVfdGFibGVf
aW5kZXggPSBuYXZpMTBfZ2V0X3NtdV90YWJsZV9pbmRleCwKLQkuZ2V0X3NtdV9wb3dlcl9pbmRl
eD0gbmF2aTEwX2dldF9wd3Jfc3JjX2luZGV4LAotCS5nZXRfd29ya2xvYWRfdHlwZSA9IG5hdmkx
MF9nZXRfd29ya2xvYWRfdHlwZSwKLQkuZ2V0X2FsbG93ZWRfZmVhdHVyZV9tYXNrID0gbmF2aTEw
X2dldF9hbGxvd2VkX2ZlYXR1cmVfbWFzaywKLQkuc2V0X2RlZmF1bHRfZHBtX3RhYmxlID0gbmF2
aTEwX3NldF9kZWZhdWx0X2RwbV90YWJsZSwKLQkuZHBtX3NldF91dmRfZW5hYmxlID0gbmF2aTEw
X2RwbV9zZXRfdXZkX2VuYWJsZSwKLQkuZ2V0X2N1cnJlbnRfY2xrX2ZyZXFfYnlfdGFibGUgPSBu
YXZpMTBfZ2V0X2N1cnJlbnRfY2xrX2ZyZXFfYnlfdGFibGUsCi0JLnByaW50X2Nsa19sZXZlbHMg
PSBuYXZpMTBfcHJpbnRfY2xrX2xldmVscywKLQkuZm9yY2VfY2xrX2xldmVscyA9IG5hdmkxMF9m
b3JjZV9jbGtfbGV2ZWxzLAotCS5wb3B1bGF0ZV91bWRfc3RhdGVfY2xrID0gbmF2aTEwX3BvcHVs
YXRlX3VtZF9zdGF0ZV9jbGssCi0JLmdldF9jbG9ja19ieV90eXBlX3dpdGhfbGF0ZW5jeSA9IG5h
dmkxMF9nZXRfY2xvY2tfYnlfdHlwZV93aXRoX2xhdGVuY3ksCi0JLnByZV9kaXNwbGF5X2NvbmZp
Z19jaGFuZ2VkID0gbmF2aTEwX3ByZV9kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkLAotCS5kaXNwbGF5
X2NvbmZpZ19jaGFuZ2VkID0gbmF2aTEwX2Rpc3BsYXlfY29uZmlnX2NoYW5nZWQsCi0JLm5vdGlm
eV9zbWNfZGlzcGFseV9jb25maWcgPSBuYXZpMTBfbm90aWZ5X3NtY19kaXNwYWx5X2NvbmZpZywK
LQkuZm9yY2VfZHBtX2xpbWl0X3ZhbHVlID0gbmF2aTEwX2ZvcmNlX2RwbV9saW1pdF92YWx1ZSwK
LQkudW5mb3JjZV9kcG1fbGV2ZWxzID0gbmF2aTEwX3VuZm9yY2VfZHBtX2xldmVscywKLQkuaXNf
ZHBtX3J1bm5pbmcgPSBuYXZpMTBfaXNfZHBtX3J1bm5pbmcsCi0JLmdldF9mYW5fc3BlZWRfcGVy
Y2VudCA9IG5hdmkxMF9nZXRfZmFuX3NwZWVkX3BlcmNlbnQsCi0JLmdldF9wb3dlcl9wcm9maWxl
X21vZGUgPSBuYXZpMTBfZ2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZSwKLQkuc2V0X3Bvd2VyX3Byb2Zp
bGVfbW9kZSA9IG5hdmkxMF9zZXRfcG93ZXJfcHJvZmlsZV9tb2RlLAotCS5nZXRfcHJvZmlsaW5n
X2Nsa19tYXNrID0gbmF2aTEwX2dldF9wcm9maWxpbmdfY2xrX21hc2ssCi0JLnNldF93YXRlcm1h
cmtzX3RhYmxlID0gbmF2aTEwX3NldF93YXRlcm1hcmtzX3RhYmxlLAotCS5yZWFkX3NlbnNvciA9
IG5hdmkxMF9yZWFkX3NlbnNvciwKLQkuZ2V0X3VjbGtfZHBtX3N0YXRlcyA9IG5hdmkxMF9nZXRf
dWNsa19kcG1fc3RhdGVzLAotCS5nZXRfcHBmZWF0dXJlX3N0YXR1cyA9IG5hdmkxMF9nZXRfcHBm
ZWF0dXJlX3N0YXR1cywKLQkuc2V0X3BwZmVhdHVyZV9zdGF0dXMgPSBuYXZpMTBfc2V0X3BwZmVh
dHVyZV9zdGF0dXMsCi19OwotCi12b2lkIG5hdmkxMF9zZXRfcHB0X2Z1bmNzKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211KQotewotCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqc211X3RhYmxlID0g
JnNtdS0+c211X3RhYmxlOwotCi0Jc211LT5wcHRfZnVuY3MgPSAmbmF2aTEwX3BwdF9mdW5jczsK
LQlzbXUtPnNtY19pZl92ZXJzaW9uID0gU01VMTFfRFJJVkVSX0lGX1ZFUlNJT047Ci0Jc211X3Rh
YmxlLT50YWJsZV9jb3VudCA9IFRBQkxFX0NPVU5UOwotfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9wb3dlcnBsYXkvbmF2aTEwX3BwdC5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9w
b3dlcnBsYXkvbmF2aTEwX3BwdC5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCA5NTcy
ODhlLi4wMDAwMDAwCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25hdmkxMF9w
cHQuaAorKysgL2Rldi9udWxsCkBAIC0xLDI4ICswLDAgQEAKLS8qCi0gKiBDb3B5cmlnaHQgMjAx
OSBBZHZhbmNlZCBNaWNybyBEZXZpY2VzLCBJbmMuCi0gKgotICogUGVybWlzc2lvbiBpcyBoZXJl
YnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKLSAq
IGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVz
ICh0aGUgIlNvZnR3YXJlIiksCi0gKiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJl
c3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uCi0gKiB0aGUgcmlnaHRzIHRv
IHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5z
ZSwKLSAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQg
cGVyc29ucyB0byB3aG9tIHRoZQotICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBz
dWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKLSAqCi0gKiBUaGUgYWJvdmUgY29w
eXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRl
ZCBpbgotICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdh
cmUuCi0gKgotICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FS
UkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKLSAqIElNUExJRUQsIElOQ0xVRElORyBCVVQg
Tk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAotICogRklU
TkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5P
IEVWRU5UIFNIQUxMCi0gKiBUSEUgQ09QWVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1IoUykgQkUg
TElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IKLSAqIE9USEVSIExJQUJJTElUWSwgV0hF
VEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAotICogQVJJ
U0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBU
SEUgVVNFIE9SCi0gKiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCi0gKgotICovCi0j
aWZuZGVmIF9fTkFWSTEwX1BQVF9IX18KLSNkZWZpbmUgX19OQVZJMTBfUFBUX0hfXwotCi1leHRl
cm4gdm9pZCBuYXZpMTBfc2V0X3BwdF9mdW5jcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSk7Ci0K
LSNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcHB0YWJs
ZS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3BwdGFibGUvTWFrZWZp
bGUKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uMDMwNThmYQotLS0gL2Rldi9u
dWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3BwdGFibGUvTWFrZWZpbGUK
QEAgLTAsMCArMSwzMCBAQAorIworIyBDb3B5cmlnaHQgMjAxNyBBZHZhbmNlZCBNaWNybyBEZXZp
Y2VzLCBJbmMuCisjCisjIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hh
cmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCisjIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBh
bmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisjIHRv
IGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRo
b3V0IGxpbWl0YXRpb24KKyMgdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2Us
IHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCisjIGFuZC9vciBzZWxsIGNvcGllcyBv
ZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQorIyBTb2Z0
d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25k
aXRpb25zOgorIworIyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNz
aW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgorIyBhbGwgY29waWVzIG9yIHN1YnN0YW50
aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyMKKyMgVEhFIFNPRlRXQVJFIElTIFBST1ZJ
REVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyMg
SU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBN
RVJDSEFOVEFCSUxJVFksCisjIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBO
T05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAorIyBUSEUgQ09QWVJJR0hUIEhPTERF
UihTKSBPUiBBVVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IKKyMg
T1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBP
UiBPVEhFUldJU0UsCisjIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lU
SCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgorIyBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09G
VFdBUkUuCisjCisjCisjIE1ha2VmaWxlIGZvciB0aGUgJ3BwIHRhYmxlICcgc3ViLWNvbXBvbmVu
dCBvZiBwb3dlcnBsYXkuCisjIEl0IHByb3ZpZGVzIHRoZSBwcCB0YWJsZSBmdW5jdGlvbiAgc2Vy
dmljZXMgZm9yIHRoZSBkcml2ZXIuCisKK1BQVF9NR1IgPSB2ZWdhMjBfcHB0Lm8gbmF2aTEwX3Bw
dC5vCisKK0FNRF9QUF9QUFRNR1IgPSAkKGFkZHByZWZpeCAkKEFNRF9QUF9QQVRIKS9wcHRhYmxl
LywkKFBQVF9NR1IpKQorCitBTURfUE9XRVJQTEFZX0ZJTEVTICs9ICQoQU1EX1BQX1BQVE1HUikK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3BwdGFibGUvbmF2aTEw
X3BwdC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcHB0YWJsZS9uYXZpMTBfcHB0
LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uOTk1NjZkZQotLS0gL2Rldi9u
dWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3BwdGFibGUvbmF2aTEwX3Bw
dC5jCkBAIC0wLDAgKzEsMTUxNCBAQAorLyoKKyAqIENvcHlyaWdodCAyMDE5IEFkdmFuY2VkIE1p
Y3JvIERldmljZXMsIEluYy4KKyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBm
cmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlz
IHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdh
cmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGlu
Y2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBt
b2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29y
IHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdo
b20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhl
IGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNl
IGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwg
Y29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBU
SEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkg
S0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBU
TyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBB
UlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwK
KyAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFO
WSBDTEFJTSwgREFNQUdFUyBPUgorICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFD
VElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsCisgKiBBUklTSU5HIEZST00sIE9V
VCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAq
IE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KKyAqCisgKi8KKworI2luY2x1ZGUgInBw
X2RlYnVnLmgiCisjaW5jbHVkZSA8bGludXgvZmlybXdhcmUuaD4KKyNpbmNsdWRlICJhbWRncHUu
aCIKKyNpbmNsdWRlICJhbWRncHVfc211LmgiCisjaW5jbHVkZSAiYXRvbWZpcm13YXJlLmgiCisj
aW5jbHVkZSAiYW1kZ3B1X2F0b21maXJtd2FyZS5oIgorI2luY2x1ZGUgInNtdV92MTFfMC5oIgor
I2luY2x1ZGUgInNtdTExX2RyaXZlcl9pZl9uYXZpMTAuaCIKKyNpbmNsdWRlICJzb2MxNV9jb21t
b24uaCIKKyNpbmNsdWRlICJhdG9tLmgiCisjaW5jbHVkZSAibmF2aTEwX3BwdC5oIgorI2luY2x1
ZGUgInNtdV92MTFfMF9wcHRhYmxlLmgiCisjaW5jbHVkZSAic211X3YxMV8wX3Bwc21jLmgiCisK
KyNpbmNsdWRlICJhc2ljX3JlZy9tcC9tcF8xMV8wX3NoX21hc2suaCIKKworI2RlZmluZSBGRUFU
VVJFX01BU0soZmVhdHVyZSkgKDFVTEwgPDwgZmVhdHVyZSkKKyNkZWZpbmUgU01DX0RQTV9GRUFU
VVJFICggXAorCUZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9QUkVGRVRDSEVSX0JJVCkgfCBcCisJ
RkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX0dGWENMS19CSVQpCSB8IFwKKwlGRUFUVVJFX01BU0so
RkVBVFVSRV9EUE1fR0ZYX1BBQ0VfQklUKQkgfCBcCisJRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBN
X1VDTEtfQklUKQkgfCBcCisJRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX1NPQ0NMS19CSVQpCSB8
IFwKKwlGRUFUVVJFX01BU0soRkVBVFVSRV9EUE1fTVAwQ0xLX0JJVCkJIHwgXAorCUZFQVRVUkVf
TUFTSyhGRUFUVVJFX0RQTV9MSU5LX0JJVCkJIHwgXAorCUZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQ
TV9EQ0VGQ0xLX0JJVCkpCisKKyNkZWZpbmUgTVNHX01BUChtc2csIGluZGV4KSBcCisJW1NNVV9N
U0dfIyNtc2ddID0gaW5kZXgKKworc3RhdGljIGludCBuYXZpMTBfbWVzc2FnZV9tYXBbU01VX01T
R19NQVhfQ09VTlRdID0geworCU1TR19NQVAoVGVzdE1lc3NhZ2UsCQkJUFBTTUNfTVNHX1Rlc3RN
ZXNzYWdlKSwKKwlNU0dfTUFQKEdldFNtdVZlcnNpb24sCQkJUFBTTUNfTVNHX0dldFNtdVZlcnNp
b24pLAorCU1TR19NQVAoR2V0RHJpdmVySWZWZXJzaW9uLAkJUFBTTUNfTVNHX0dldERyaXZlcklm
VmVyc2lvbiksCisJTVNHX01BUChTZXRBbGxvd2VkRmVhdHVyZXNNYXNrTG93LAlQUFNNQ19NU0df
U2V0QWxsb3dlZEZlYXR1cmVzTWFza0xvdyksCisJTVNHX01BUChTZXRBbGxvd2VkRmVhdHVyZXNN
YXNrSGlnaCwJUFBTTUNfTVNHX1NldEFsbG93ZWRGZWF0dXJlc01hc2tIaWdoKSwKKwlNU0dfTUFQ
KEVuYWJsZUFsbFNtdUZlYXR1cmVzLAkJUFBTTUNfTVNHX0VuYWJsZUFsbFNtdUZlYXR1cmVzKSwK
KwlNU0dfTUFQKERpc2FibGVBbGxTbXVGZWF0dXJlcywJCVBQU01DX01TR19EaXNhYmxlQWxsU211
RmVhdHVyZXMpLAorCU1TR19NQVAoRW5hYmxlU211RmVhdHVyZXNMb3csCQlQUFNNQ19NU0dfRW5h
YmxlU211RmVhdHVyZXNMb3cpLAorCU1TR19NQVAoRW5hYmxlU211RmVhdHVyZXNIaWdoLAkJUFBT
TUNfTVNHX0VuYWJsZVNtdUZlYXR1cmVzSGlnaCksCisJTVNHX01BUChEaXNhYmxlU211RmVhdHVy
ZXNMb3csCQlQUFNNQ19NU0dfRGlzYWJsZVNtdUZlYXR1cmVzTG93KSwKKwlNU0dfTUFQKERpc2Fi
bGVTbXVGZWF0dXJlc0hpZ2gsCQlQUFNNQ19NU0dfRGlzYWJsZVNtdUZlYXR1cmVzSGlnaCksCisJ
TVNHX01BUChHZXRFbmFibGVkU211RmVhdHVyZXNMb3csCVBQU01DX01TR19HZXRFbmFibGVkU211
RmVhdHVyZXNMb3cpLAorCU1TR19NQVAoR2V0RW5hYmxlZFNtdUZlYXR1cmVzSGlnaCwJUFBTTUNf
TVNHX0dldEVuYWJsZWRTbXVGZWF0dXJlc0hpZ2gpLAorCU1TR19NQVAoU2V0V29ya2xvYWRNYXNr
LAkJUFBTTUNfTVNHX1NldFdvcmtsb2FkTWFzayksCisJTVNHX01BUChTZXRQcHRMaW1pdCwJCQlQ
UFNNQ19NU0dfU2V0UHB0TGltaXQpLAorCU1TR19NQVAoU2V0RHJpdmVyRHJhbUFkZHJIaWdoLAkJ
UFBTTUNfTVNHX1NldERyaXZlckRyYW1BZGRySGlnaCksCisJTVNHX01BUChTZXREcml2ZXJEcmFt
QWRkckxvdywJCVBQU01DX01TR19TZXREcml2ZXJEcmFtQWRkckxvdyksCisJTVNHX01BUChTZXRU
b29sc0RyYW1BZGRySGlnaCwJCVBQU01DX01TR19TZXRUb29sc0RyYW1BZGRySGlnaCksCisJTVNH
X01BUChTZXRUb29sc0RyYW1BZGRyTG93LAkJUFBTTUNfTVNHX1NldFRvb2xzRHJhbUFkZHJMb3cp
LAorCU1TR19NQVAoVHJhbnNmZXJUYWJsZVNtdTJEcmFtLAkJUFBTTUNfTVNHX1RyYW5zZmVyVGFi
bGVTbXUyRHJhbSksCisJTVNHX01BUChUcmFuc2ZlclRhYmxlRHJhbTJTbXUsCQlQUFNNQ19NU0df
VHJhbnNmZXJUYWJsZURyYW0yU211KSwKKwlNU0dfTUFQKFVzZURlZmF1bHRQUFRhYmxlLAkJUFBT
TUNfTVNHX1VzZURlZmF1bHRQUFRhYmxlKSwKKwlNU0dfTUFQKFVzZUJhY2t1cFBQVGFibGUsCQlQ
UFNNQ19NU0dfVXNlQmFja3VwUFBUYWJsZSksCisJTVNHX01BUChSdW5CdGMsCQkJCVBQU01DX01T
R19SdW5CdGMpLAorCU1TR19NQVAoRW50ZXJCYWNvLAkJCVBQU01DX01TR19FbnRlckJhY28pLAor
CU1TR19NQVAoU2V0U29mdE1pbkJ5RnJlcSwJCVBQU01DX01TR19TZXRTb2Z0TWluQnlGcmVxKSwK
KwlNU0dfTUFQKFNldFNvZnRNYXhCeUZyZXEsCQlQUFNNQ19NU0dfU2V0U29mdE1heEJ5RnJlcSks
CisJTVNHX01BUChTZXRIYXJkTWluQnlGcmVxLAkJUFBTTUNfTVNHX1NldEhhcmRNaW5CeUZyZXEp
LAorCU1TR19NQVAoU2V0SGFyZE1heEJ5RnJlcSwJCVBQU01DX01TR19TZXRIYXJkTWF4QnlGcmVx
KSwKKwlNU0dfTUFQKEdldE1pbkRwbUZyZXEsCQkJUFBTTUNfTVNHX0dldE1pbkRwbUZyZXEpLAor
CU1TR19NQVAoR2V0TWF4RHBtRnJlcSwJCQlQUFNNQ19NU0dfR2V0TWF4RHBtRnJlcSksCisJTVNH
X01BUChHZXREcG1GcmVxQnlJbmRleCwJCVBQU01DX01TR19HZXREcG1GcmVxQnlJbmRleCksCisJ
TVNHX01BUChTZXRNZW1vcnlDaGFubmVsQ29uZmlnLAkJUFBTTUNfTVNHX1NldE1lbW9yeUNoYW5u
ZWxDb25maWcpLAorCU1TR19NQVAoU2V0R2VtaW5pTW9kZSwJCQlQUFNNQ19NU0dfU2V0R2VtaW5p
TW9kZSksCisJTVNHX01BUChTZXRHZW1pbmlBcGVydHVyZUhpZ2gsCQlQUFNNQ19NU0dfU2V0R2Vt
aW5pQXBlcnR1cmVIaWdoKSwKKwlNU0dfTUFQKFNldEdlbWluaUFwZXJ0dXJlTG93LAkJUFBTTUNf
TVNHX1NldEdlbWluaUFwZXJ0dXJlTG93KSwKKwlNU0dfTUFQKE92ZXJyaWRlUGNpZVBhcmFtZXRl
cnMsCQlQUFNNQ19NU0dfT3ZlcnJpZGVQY2llUGFyYW1ldGVycyksCisJTVNHX01BUChTZXRNaW5E
ZWVwU2xlZXBEY2VmY2xrLAkJUFBTTUNfTVNHX1NldE1pbkRlZXBTbGVlcERjZWZjbGspLAorCU1T
R19NQVAoUmVlbmFibGVBY0RjSW50ZXJydXB0LAkJUFBTTUNfTVNHX1JlZW5hYmxlQWNEY0ludGVy
cnVwdCksCisJTVNHX01BUChOb3RpZnlQb3dlclNvdXJjZSwJCVBQU01DX01TR19Ob3RpZnlQb3dl
clNvdXJjZSksCisJTVNHX01BUChTZXRVY2xrRmFzdFN3aXRjaCwJCVBQU01DX01TR19TZXRVY2xr
RmFzdFN3aXRjaCksCisJTVNHX01BUChTZXRWaWRlb0ZwcywJCQlQUFNNQ19NU0dfU2V0VmlkZW9G
cHMpLAorCU1TR19NQVAoUHJlcGFyZU1wMUZvclVubG9hZCwJCVBQU01DX01TR19QcmVwYXJlTXAx
Rm9yVW5sb2FkKSwKKwlNU0dfTUFQKERyYW1Mb2dTZXREcmFtQWRkckhpZ2gsCQlQUFNNQ19NU0df
RHJhbUxvZ1NldERyYW1BZGRySGlnaCksCisJTVNHX01BUChEcmFtTG9nU2V0RHJhbUFkZHJMb3cs
CQlQUFNNQ19NU0dfRHJhbUxvZ1NldERyYW1BZGRyTG93KSwKKwlNU0dfTUFQKERyYW1Mb2dTZXRE
cmFtU2l6ZSwJCVBQU01DX01TR19EcmFtTG9nU2V0RHJhbVNpemUpLAorCU1TR19NQVAoQ29uZmln
dXJlR2Z4RGlkdCwJCVBQU01DX01TR19Db25maWd1cmVHZnhEaWR0KSwKKwlNU0dfTUFQKE51bU9m
RGlzcGxheXMsCQkJUFBTTUNfTVNHX051bU9mRGlzcGxheXMpLAorCU1TR19NQVAoU2V0U3lzdGVt
VmlydHVhbERyYW1BZGRySGlnaCwJUFBTTUNfTVNHX1NldFN5c3RlbVZpcnR1YWxEcmFtQWRkckhp
Z2gpLAorCU1TR19NQVAoU2V0U3lzdGVtVmlydHVhbERyYW1BZGRyTG93LAlQUFNNQ19NU0dfU2V0
U3lzdGVtVmlydHVhbERyYW1BZGRyTG93KSwKKwlNU0dfTUFQKEFsbG93R2Z4T2ZmLAkJCVBQU01D
X01TR19BbGxvd0dmeE9mZiksCisJTVNHX01BUChEaXNhbGxvd0dmeE9mZiwJCQlQUFNNQ19NU0df
RGlzYWxsb3dHZnhPZmYpLAorCU1TR19NQVAoR2V0UHB0TGltaXQsCQkJUFBTTUNfTVNHX0dldFBw
dExpbWl0KSwKKwlNU0dfTUFQKEdldERjTW9kZU1heERwbUZyZXEsCQlQUFNNQ19NU0dfR2V0RGNN
b2RlTWF4RHBtRnJlcSksCisJTVNHX01BUChHZXREZWJ1Z0RhdGEsCQkJUFBTTUNfTVNHX0dldERl
YnVnRGF0YSksCisJTVNHX01BUChFeGl0QmFjbywJCQlQUFNNQ19NU0dfRXhpdEJhY28pLAorCU1T
R19NQVAoUHJlcGFyZU1wMUZvclJlc2V0LAkJUFBTTUNfTVNHX1ByZXBhcmVNcDFGb3JSZXNldCks
CisJTVNHX01BUChQcmVwYXJlTXAxRm9yU2h1dGRvd24sCQlQUFNNQ19NU0dfUHJlcGFyZU1wMUZv
clNodXRkb3duKSwKKwlNU0dfTUFQKFBvd2VyVXBWY24sCQlQUFNNQ19NU0dfUG93ZXJVcFZjbiks
CisJTVNHX01BUChQb3dlckRvd25WY24sCQlQUFNNQ19NU0dfUG93ZXJEb3duVmNuKSwKKwlNU0df
TUFQKFBvd2VyVXBKcGVnLAkJUFBTTUNfTVNHX1Bvd2VyVXBKcGVnKSwKKwlNU0dfTUFQKFBvd2Vy
RG93bkpwZWcsCQlQUFNNQ19NU0dfUG93ZXJEb3duSnBlZyksCisJTVNHX01BUChCYWNvQXVkaW9E
M1BNRSwJCVBQU01DX01TR19CYWNvQXVkaW9EM1BNRSksCit9OworCitzdGF0aWMgaW50IG5hdmkx
MF9jbGtfbWFwW1NNVV9DTEtfQ09VTlRdID0geworCUNMS19NQVAoR0ZYQ0xLLCBQUENMS19HRlhD
TEspLAorCUNMS19NQVAoU0NMSywJUFBDTEtfR0ZYQ0xLKSwKKwlDTEtfTUFQKFNPQ0NMSywgUFBD
TEtfU09DQ0xLKSwKKwlDTEtfTUFQKEZDTEssIFBQQ0xLX1NPQ0NMSyksCisJQ0xLX01BUChVQ0xL
LCBQUENMS19VQ0xLKSwKKwlDTEtfTUFQKE1DTEssIFBQQ0xLX1VDTEspLAorCUNMS19NQVAoRENM
SywgUFBDTEtfRENMSyksCisJQ0xLX01BUChWQ0xLLCBQUENMS19WQ0xLKSwKKwlDTEtfTUFQKERD
RUZDTEssIFBQQ0xLX0RDRUZDTEspLAorCUNMS19NQVAoRElTUENMSywgUFBDTEtfRElTUENMSyks
CisJQ0xLX01BUChQSVhDTEssIFBQQ0xLX1BJWENMSyksCisJQ0xLX01BUChQSFlDTEssIFBQQ0xL
X1BIWUNMSyksCit9OworCitzdGF0aWMgaW50IG5hdmkxMF9mZWF0dXJlX21hc2tfbWFwW1NNVV9G
RUFUVVJFX0NPVU5UXSA9IHsKKwlGRUFfTUFQKERQTV9QUkVGRVRDSEVSKSwKKwlGRUFfTUFQKERQ
TV9HRlhDTEspLAorCUZFQV9NQVAoRFBNX0dGWF9QQUNFKSwKKwlGRUFfTUFQKERQTV9VQ0xLKSwK
KwlGRUFfTUFQKERQTV9TT0NDTEspLAorCUZFQV9NQVAoRFBNX01QMENMSyksCisJRkVBX01BUChE
UE1fTElOSyksCisJRkVBX01BUChEUE1fRENFRkNMSyksCisJRkVBX01BUChNRU1fVkREQ0lfU0NB
TElORyksCisJRkVBX01BUChNRU1fTVZERF9TQ0FMSU5HKSwKKwlGRUFfTUFQKERTX0dGWENMSyks
CisJRkVBX01BUChEU19TT0NDTEspLAorCUZFQV9NQVAoRFNfTENMSyksCisJRkVBX01BUChEU19E
Q0VGQ0xLKSwKKwlGRUFfTUFQKERTX1VDTEspLAorCUZFQV9NQVAoR0ZYX1VMViksCisJRkVBX01B
UChGV19EU1RBVEUpLAorCUZFQV9NQVAoR0ZYT0ZGKSwKKwlGRUFfTUFQKEJBQ08pLAorCUZFQV9N
QVAoVkNOX1BHKSwKKwlGRUFfTUFQKEpQRUdfUEcpLAorCUZFQV9NQVAoVVNCX1BHKSwKKwlGRUFf
TUFQKFJTTVVfU01OX0NHKSwKKwlGRUFfTUFQKFBQVCksCisJRkVBX01BUChUREMpLAorCUZFQV9N
QVAoR0ZYX0VEQyksCisJRkVBX01BUChBUENDX1BMVVMpLAorCUZFQV9NQVAoR1RIUiksCisJRkVB
X01BUChBQ0RDKSwKKwlGRUFfTUFQKFZSMEhPVCksCisJRkVBX01BUChWUjFIT1QpLAorCUZFQV9N
QVAoRldfQ1RGKSwKKwlGRUFfTUFQKEZBTl9DT05UUk9MKSwKKwlGRUFfTUFQKFRIRVJNQUwpLAor
CUZFQV9NQVAoR0ZYX0RDUyksCisJRkVBX01BUChSTSksCisJRkVBX01BUChMRURfRElTUExBWSks
CisJRkVBX01BUChHRlhfU1MpLAorCUZFQV9NQVAoT1VUX09GX0JBTkRfTU9OSVRPUiksCisJRkVB
X01BUChURU1QX0RFUEVOREVOVF9WTUlOKSwKKwlGRUFfTUFQKE1NSFVCX1BHKSwKKwlGRUFfTUFQ
KEFUSFVCX1BHKSwKK307CisKK3N0YXRpYyBpbnQgbmF2aTEwX3RhYmxlX21hcFtTTVVfVEFCTEVf
Q09VTlRdID0geworCVRBQl9NQVAoUFBUQUJMRSksCisJVEFCX01BUChXQVRFUk1BUktTKSwKKwlU
QUJfTUFQKEFWRlMpLAorCVRBQl9NQVAoQVZGU19QU01fREVCVUcpLAorCVRBQl9NQVAoQVZGU19G
VVNFX09WRVJSSURFKSwKKwlUQUJfTUFQKFBNU1RBVFVTTE9HKSwKKwlUQUJfTUFQKFNNVV9NRVRS
SUNTKSwKKwlUQUJfTUFQKERSSVZFUl9TTVVfQ09ORklHKSwKKwlUQUJfTUFQKEFDVElWSVRZX01P
TklUT1JfQ09FRkYpLAorCVRBQl9NQVAoT1ZFUkRSSVZFKSwKKwlUQUJfTUFQKEkyQ19DT01NQU5E
UyksCisJVEFCX01BUChQQUNFKSwKK307CisKK3N0YXRpYyBpbnQgbmF2aTEwX3B3cl9zcmNfbWFw
W1NNVV9QT1dFUl9TT1VSQ0VfQ09VTlRdID0geworCVBXUl9NQVAoQUMpLAorCVBXUl9NQVAoREMp
LAorfTsKKworc3RhdGljIGludCBuYXZpMTBfd29ya2xvYWRfbWFwW10gPSB7CisJV09SS0xPQURf
TUFQKFBQX1NNQ19QT1dFUl9QUk9GSUxFX0JPT1RVUF9ERUZBVUxULAlXT1JLTE9BRF9QUExJQl9E
RUZBVUxUX0JJVCksCisJV09SS0xPQURfTUFQKFBQX1NNQ19QT1dFUl9QUk9GSUxFX0ZVTExTQ1JF
RU4zRCwJCVdPUktMT0FEX1BQTElCX0ZVTExfU0NSRUVOXzNEX0JJVCksCisJV09SS0xPQURfTUFQ
KFBQX1NNQ19QT1dFUl9QUk9GSUxFX1BPV0VSU0FWSU5HLAkJV09SS0xPQURfUFBMSUJfUE9XRVJf
U0FWSU5HX0JJVCksCisJV09SS0xPQURfTUFQKFBQX1NNQ19QT1dFUl9QUk9GSUxFX1ZJREVPLAkJ
V09SS0xPQURfUFBMSUJfVklERU9fQklUKSwKKwlXT1JLTE9BRF9NQVAoUFBfU01DX1BPV0VSX1BS
T0ZJTEVfVlIsCQkJV09SS0xPQURfUFBMSUJfVlJfQklUKSwKKwlXT1JLTE9BRF9NQVAoUFBfU01D
X1BPV0VSX1BST0ZJTEVfQ09NUFVURSwJCVdPUktMT0FEX1BQTElCX0NVU1RPTV9CSVQpLAorCVdP
UktMT0FEX01BUChQUF9TTUNfUE9XRVJfUFJPRklMRV9DVVNUT00sCQlXT1JLTE9BRF9QUExJQl9D
VVNUT01fQklUKSwKK307CisKK3N0YXRpYyBpbnQgbmF2aTEwX2dldF9zbXVfbXNnX2luZGV4KHN0
cnVjdCBzbXVfY29udGV4dCAqc21jLCB1aW50MzJfdCBpbmRleCkKK3sKKwlpbnQgdmFsOworCWlm
IChpbmRleCA+IFNNVV9NU0dfTUFYX0NPVU5UKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXZhbCA9
IG5hdmkxMF9tZXNzYWdlX21hcFtpbmRleF07CisJaWYgKHZhbCA+IFBQU01DX01lc3NhZ2VfQ291
bnQpCisJCXJldHVybiAtRUlOVkFMOworCisJcmV0dXJuIHZhbDsKK30KKworc3RhdGljIGludCBu
YXZpMTBfZ2V0X3NtdV9jbGtfaW5kZXgoc3RydWN0IHNtdV9jb250ZXh0ICpzbWMsIHVpbnQzMl90
IGluZGV4KQoreworCWludCB2YWw7CisJaWYgKGluZGV4ID49IFNNVV9DTEtfQ09VTlQpCisJCXJl
dHVybiAtRUlOVkFMOworCisJdmFsID0gbmF2aTEwX2Nsa19tYXBbaW5kZXhdOworCWlmICh2YWwg
Pj0gUFBDTEtfQ09VTlQpCisJCXJldHVybiAtRUlOVkFMOworCisJcmV0dXJuIHZhbDsKK30KKwor
c3RhdGljIGludCBuYXZpMTBfZ2V0X3NtdV9mZWF0dXJlX2luZGV4KHN0cnVjdCBzbXVfY29udGV4
dCAqc21jLCB1aW50MzJfdCBpbmRleCkKK3sKKwlpbnQgdmFsOworCWlmIChpbmRleCA+PSBTTVVf
RkVBVFVSRV9DT1VOVCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwl2YWwgPSBuYXZpMTBfZmVhdHVy
ZV9tYXNrX21hcFtpbmRleF07CisJaWYgKHZhbCA+IDY0KQorCQlyZXR1cm4gLUVJTlZBTDsKKwor
CXJldHVybiB2YWw7Cit9CisKK3N0YXRpYyBpbnQgbmF2aTEwX2dldF9zbXVfdGFibGVfaW5kZXgo
c3RydWN0IHNtdV9jb250ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4KQoreworCWludCB2YWw7CisJ
aWYgKGluZGV4ID49IFNNVV9UQUJMRV9DT1VOVCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwl2YWwg
PSBuYXZpMTBfdGFibGVfbWFwW2luZGV4XTsKKwlpZiAodmFsID49IFRBQkxFX0NPVU5UKQorCQly
ZXR1cm4gLUVJTlZBTDsKKworCXJldHVybiB2YWw7Cit9CisKK3N0YXRpYyBpbnQgbmF2aTEwX2dl
dF9wd3Jfc3JjX2luZGV4KHN0cnVjdCBzbXVfY29udGV4dCAqc21jLCB1aW50MzJfdCBpbmRleCkK
K3sKKwlpbnQgdmFsOworCWlmIChpbmRleCA+PSBTTVVfUE9XRVJfU09VUkNFX0NPVU5UKQorCQly
ZXR1cm4gLUVJTlZBTDsKKworCXZhbCA9IG5hdmkxMF9wd3Jfc3JjX21hcFtpbmRleF07CisJaWYg
KHZhbCA+PSBQT1dFUl9TT1VSQ0VfQ09VTlQpCisJCXJldHVybiAtRUlOVkFMOworCisJcmV0dXJu
IHZhbDsKK30KKworCitzdGF0aWMgaW50IG5hdmkxMF9nZXRfd29ya2xvYWRfdHlwZShzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSwgZW51bSBQUF9TTUNfUE9XRVJfUFJPRklMRSBwcm9maWxlKQorewor
CWludCB2YWw7CisJaWYgKHByb2ZpbGUgPiBQUF9TTUNfUE9XRVJfUFJPRklMRV9DVVNUT00pCisJ
CXJldHVybiAtRUlOVkFMOworCisJdmFsID0gbmF2aTEwX3dvcmtsb2FkX21hcFtwcm9maWxlXTsK
KworCXJldHVybiB2YWw7Cit9CisKK3N0YXRpYyBib29sIGlzX2FzaWNfc2VjdXJlKHN0cnVjdCBz
bXVfY29udGV4dCAqc211KQoreworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gc211LT5h
ZGV2OworCWJvb2wgaXNfc2VjdXJlID0gdHJ1ZTsKKwl1aW50MzJfdCBtcDBfZndfaW50ZjsKKwor
CW1wMF9md19pbnRmID0gUlJFRzMyX1BDSUUoTVAwX1B1YmxpYyB8CisJCQkJICAgKHNtbk1QMF9G
V19JTlRGICYgMHhmZmZmZmZmZikpOworCisJaWYgKCEobXAwX2Z3X2ludGYgJiAoMSA8PCAxOSkp
KQorCQlpc19zZWN1cmUgPSBmYWxzZTsKKworCXJldHVybiBpc19zZWN1cmU7Cit9CisKK3N0YXRp
YyBpbnQKK25hdmkxMF9nZXRfYWxsb3dlZF9mZWF0dXJlX21hc2soc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUsCisJCQkJICB1aW50MzJfdCAqZmVhdHVyZV9tYXNrLCB1aW50MzJfdCBudW0pCit7CisJ
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBzbXUtPmFkZXY7CisKKwlpZiAobnVtID4gMikK
KwkJcmV0dXJuIC1FSU5WQUw7CisKKwltZW1zZXQoZmVhdHVyZV9tYXNrLCAwLCBzaXplb2YodWlu
dDMyX3QpICogbnVtKTsKKworCSoodWludDY0X3QgKilmZWF0dXJlX21hc2sgfD0gRkVBVFVSRV9N
QVNLKEZFQVRVUkVfRFBNX1BSRUZFVENIRVJfQklUKQorCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRV
UkVfRFBNX0dGWENMS19CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9EUE1fU09DQ0xL
X0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9NUDBDTEtfQklUKQorCQkJCXwg
RkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX0xJTktfQklUKQorCQkJCXwgRkVBVFVSRV9NQVNLKEZF
QVRVUkVfR0ZYX1VMVl9CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9SU01VX1NNTl9D
R19CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9EU19TT0NDTEtfQklUKQorCQkJCXwg
RkVBVFVSRV9NQVNLKEZFQVRVUkVfUFBUX0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJF
X1REQ19CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9HRlhfRURDX0JJVCkKKwkJCQl8
IEZFQVRVUkVfTUFTSyhGRUFUVVJFX1ZSMEhPVF9CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVB
VFVSRV9GQU5fQ09OVFJPTF9CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9USEVSTUFM
X0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0xFRF9ESVNQTEFZX0JJVCkKKwkJCQl8
IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9EQ0VGQ0xLX0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFT
SyhGRUFUVVJFX0RTX0dGWENMS19CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9EU19E
Q0VGQ0xLX0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0ZXX0RTVEFURV9CSVQpCisJ
CQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9CQUNPX0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFTSyhG
RUFUVVJFX0FDRENfQklUKTsKKworCWlmIChhZGV2LT5wbS5wcF9mZWF0dXJlICYgUFBfTUNMS19E
UE1fTUFTSykKKwkJKih1aW50NjRfdCAqKWZlYXR1cmVfbWFzayB8PSBGRUFUVVJFX01BU0soRkVB
VFVSRV9EUE1fVUNMS19CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9NRU1fVkREQ0lf
U0NBTElOR19CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9NRU1fTVZERF9TQ0FMSU5H
X0JJVCk7CisKKwlpZiAoYWRldi0+cG0ucHBfZmVhdHVyZSAmIFBQX0dGWE9GRl9NQVNLKSB7CisJ
CSoodWludDY0X3QgKilmZWF0dXJlX21hc2sgfD0gRkVBVFVSRV9NQVNLKEZFQVRVUkVfR0ZYX1NT
X0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0dGWE9GRl9CSVQpOworCQkvKiBUT0RP
OiByZW1vdmUgaXQgb25jZSBmdyBmaXggdGhlIGJ1ZyAqLworCQkqKHVpbnQ2NF90ICopZmVhdHVy
ZV9tYXNrICY9IH5GRUFUVVJFX01BU0soRkVBVFVSRV9GV19EU1RBVEVfQklUKTsKKwl9CisKKwlp
ZiAoc211LT5hZGV2LT5wZ19mbGFncyAmIEFNRF9QR19TVVBQT1JUX01NSFVCKQorCQkqKHVpbnQ2
NF90ICopZmVhdHVyZV9tYXNrIHw9IEZFQVRVUkVfTUFTSyhGRUFUVVJFX01NSFVCX1BHX0JJVCk7
CisKKwlpZiAoc211LT5hZGV2LT5wZ19mbGFncyAmIEFNRF9QR19TVVBQT1JUX0FUSFVCKQorCQkq
KHVpbnQ2NF90ICopZmVhdHVyZV9tYXNrIHw9IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0FUSFVCX1BH
X0JJVCk7CisKKwlpZiAoc211LT5hZGV2LT5wZ19mbGFncyAmIEFNRF9QR19TVVBQT1JUX1ZDTikK
KwkJKih1aW50NjRfdCAqKWZlYXR1cmVfbWFzayB8PSBGRUFUVVJFX01BU0soRkVBVFVSRV9WQ05f
UEdfQklUKTsKKworCS8qIGRpc2FibGUgRFBNIFVDTEsgYW5kIERTIFNPQ0NMSyBvbiBuYXZpMTAg
QTAgc2VjdXJlIGJvYXJkICovCisJaWYgKGlzX2FzaWNfc2VjdXJlKHNtdSkpIHsKKwkJLyogb25s
eSBmb3IgbmF2aTEwIEEwICovCisJCWlmICgoYWRldi0+YXNpY190eXBlID09IENISVBfTkFWSTEw
KSAmJgorCQkJKGFkZXYtPnJldl9pZCA9PSAwKSkgeworCQkJKih1aW50NjRfdCAqKWZlYXR1cmVf
bWFzayAmPQorCQkJCQl+KEZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9VQ0xLX0JJVCkKKwkJCQkJ
ICB8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX01FTV9WRERDSV9TQ0FMSU5HX0JJVCkKKwkJCQkJICB8
IEZFQVRVUkVfTUFTSyhGRUFUVVJFX01FTV9NVkREX1NDQUxJTkdfQklUKSk7CisJCQkqKHVpbnQ2
NF90ICopZmVhdHVyZV9tYXNrICY9CisJCQkJCX5GRUFUVVJFX01BU0soRkVBVFVSRV9EU19TT0ND
TEtfQklUKTsKKwkJfQorCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IG5hdmkxMF9j
aGVja19wb3dlcnBsYXlfdGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCit7CisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgbmF2aTEwX2FwcGVuZF9wb3dlcnBsYXlfdGFibGUoc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUpCit7CisJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBzbXUt
PmFkZXY7CisJc3RydWN0IHNtdV90YWJsZV9jb250ZXh0ICp0YWJsZV9jb250ZXh0ID0gJnNtdS0+
c211X3RhYmxlOworCVBQVGFibGVfdCAqc21jX3BwdGFibGUgPSB0YWJsZV9jb250ZXh0LT5kcml2
ZXJfcHB0YWJsZTsKKwlzdHJ1Y3QgYXRvbV9zbWNfZHBtX2luZm9fdjRfNSAqc21jX2RwbV90YWJs
ZTsKKwlpbnQgaW5kZXgsIHJldDsKKworCWluZGV4ID0gZ2V0X2luZGV4X2ludG9fbWFzdGVyX3Rh
YmxlKGF0b21fbWFzdGVyX2xpc3Rfb2ZfZGF0YV90YWJsZXNfdjJfMSwKKwkJCQkJICAgc21jX2Rw
bV9pbmZvKTsKKworCXJldCA9IHNtdV9nZXRfYXRvbV9kYXRhX3RhYmxlKHNtdSwgaW5kZXgsIE5V
TEwsIE5VTEwsIE5VTEwsCisJCQkJICAgICAgKHVpbnQ4X3QgKiopJnNtY19kcG1fdGFibGUpOwor
CWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwltZW1jcHkoc21jX3BwdGFibGUtPkkyY0NvbnRy
b2xsZXJzLCBzbWNfZHBtX3RhYmxlLT5JMmNDb250cm9sbGVycywKKwkgICAgICAgc2l6ZW9mKEky
Y0NvbnRyb2xsZXJDb25maWdfdCkgKiBOVU1fSTJDX0NPTlRST0xMRVJTKTsKKworCS8qIFNWSTIg
Qm9hcmQgUGFyYW1ldGVycyAqLworCXNtY19wcHRhYmxlLT5NYXhWb2x0YWdlU3RlcEdmeCA9IHNt
Y19kcG1fdGFibGUtPk1heFZvbHRhZ2VTdGVwR2Z4OworCXNtY19wcHRhYmxlLT5NYXhWb2x0YWdl
U3RlcFNvYyA9IHNtY19kcG1fdGFibGUtPk1heFZvbHRhZ2VTdGVwU29jOworCXNtY19wcHRhYmxl
LT5WZGRHZnhWck1hcHBpbmcgPSBzbWNfZHBtX3RhYmxlLT5WZGRHZnhWck1hcHBpbmc7CisJc21j
X3BwdGFibGUtPlZkZFNvY1ZyTWFwcGluZyA9IHNtY19kcG1fdGFibGUtPlZkZFNvY1ZyTWFwcGlu
ZzsKKwlzbWNfcHB0YWJsZS0+VmRkTWVtMFZyTWFwcGluZyA9IHNtY19kcG1fdGFibGUtPlZkZE1l
bTBWck1hcHBpbmc7CisJc21jX3BwdGFibGUtPlZkZE1lbTFWck1hcHBpbmcgPSBzbWNfZHBtX3Rh
YmxlLT5WZGRNZW0xVnJNYXBwaW5nOworCXNtY19wcHRhYmxlLT5HZnhVbHZQaGFzZVNoZWRkaW5n
TWFzayA9IHNtY19kcG1fdGFibGUtPkdmeFVsdlBoYXNlU2hlZGRpbmdNYXNrOworCXNtY19wcHRh
YmxlLT5Tb2NVbHZQaGFzZVNoZWRkaW5nTWFzayA9IHNtY19kcG1fdGFibGUtPlNvY1VsdlBoYXNl
U2hlZGRpbmdNYXNrOworCXNtY19wcHRhYmxlLT5FeHRlcm5hbFNlbnNvclByZXNlbnQgPSBzbWNf
ZHBtX3RhYmxlLT5FeHRlcm5hbFNlbnNvclByZXNlbnQ7CisJc21jX3BwdGFibGUtPlBhZGRpbmc4
X1YgPSBzbWNfZHBtX3RhYmxlLT5QYWRkaW5nOF9WOworCisJLyogVGVsZW1ldHJ5IFNldHRpbmdz
ICovCisJc21jX3BwdGFibGUtPkdmeE1heEN1cnJlbnQgPSBzbWNfZHBtX3RhYmxlLT5HZnhNYXhD
dXJyZW50OworCXNtY19wcHRhYmxlLT5HZnhPZmZzZXQgPSBzbWNfZHBtX3RhYmxlLT5HZnhPZmZz
ZXQ7CisJc21jX3BwdGFibGUtPlBhZGRpbmdfVGVsZW1ldHJ5R2Z4ID0gc21jX2RwbV90YWJsZS0+
UGFkZGluZ19UZWxlbWV0cnlHZng7CisJc21jX3BwdGFibGUtPlNvY01heEN1cnJlbnQgPSBzbWNf
ZHBtX3RhYmxlLT5Tb2NNYXhDdXJyZW50OworCXNtY19wcHRhYmxlLT5Tb2NPZmZzZXQgPSBzbWNf
ZHBtX3RhYmxlLT5Tb2NPZmZzZXQ7CisJc21jX3BwdGFibGUtPlBhZGRpbmdfVGVsZW1ldHJ5U29j
ID0gc21jX2RwbV90YWJsZS0+UGFkZGluZ19UZWxlbWV0cnlTb2M7CisJc21jX3BwdGFibGUtPk1l
bTBNYXhDdXJyZW50ID0gc21jX2RwbV90YWJsZS0+TWVtME1heEN1cnJlbnQ7CisJc21jX3BwdGFi
bGUtPk1lbTBPZmZzZXQgPSBzbWNfZHBtX3RhYmxlLT5NZW0wT2Zmc2V0OworCXNtY19wcHRhYmxl
LT5QYWRkaW5nX1RlbGVtZXRyeU1lbTAgPSBzbWNfZHBtX3RhYmxlLT5QYWRkaW5nX1RlbGVtZXRy
eU1lbTA7CisJc21jX3BwdGFibGUtPk1lbTFNYXhDdXJyZW50ID0gc21jX2RwbV90YWJsZS0+TWVt
MU1heEN1cnJlbnQ7CisJc21jX3BwdGFibGUtPk1lbTFPZmZzZXQgPSBzbWNfZHBtX3RhYmxlLT5N
ZW0xT2Zmc2V0OworCXNtY19wcHRhYmxlLT5QYWRkaW5nX1RlbGVtZXRyeU1lbTEgPSBzbWNfZHBt
X3RhYmxlLT5QYWRkaW5nX1RlbGVtZXRyeU1lbTE7CisKKwkvKiBHUElPIFNldHRpbmdzICovCisJ
c21jX3BwdGFibGUtPkFjRGNHcGlvID0gc21jX2RwbV90YWJsZS0+QWNEY0dwaW87CisJc21jX3Bw
dGFibGUtPkFjRGNQb2xhcml0eSA9IHNtY19kcG1fdGFibGUtPkFjRGNQb2xhcml0eTsKKwlzbWNf
cHB0YWJsZS0+VlIwSG90R3BpbyA9IHNtY19kcG1fdGFibGUtPlZSMEhvdEdwaW87CisJc21jX3Bw
dGFibGUtPlZSMEhvdFBvbGFyaXR5ID0gc21jX2RwbV90YWJsZS0+VlIwSG90UG9sYXJpdHk7CisJ
c21jX3BwdGFibGUtPlZSMUhvdEdwaW8gPSBzbWNfZHBtX3RhYmxlLT5WUjFIb3RHcGlvOworCXNt
Y19wcHRhYmxlLT5WUjFIb3RQb2xhcml0eSA9IHNtY19kcG1fdGFibGUtPlZSMUhvdFBvbGFyaXR5
OworCXNtY19wcHRhYmxlLT5HdGhyR3BpbyA9IHNtY19kcG1fdGFibGUtPkd0aHJHcGlvOworCXNt
Y19wcHRhYmxlLT5HdGhyUG9sYXJpdHkgPSBzbWNfZHBtX3RhYmxlLT5HdGhyUG9sYXJpdHk7CisK
KwkvKiBMRUQgRGlzcGxheSBTZXR0aW5ncyAqLworCXNtY19wcHRhYmxlLT5MZWRQaW4wID0gc21j
X2RwbV90YWJsZS0+TGVkUGluMDsKKwlzbWNfcHB0YWJsZS0+TGVkUGluMSA9IHNtY19kcG1fdGFi
bGUtPkxlZFBpbjE7CisJc21jX3BwdGFibGUtPkxlZFBpbjIgPSBzbWNfZHBtX3RhYmxlLT5MZWRQ
aW4yOworCXNtY19wcHRhYmxlLT5wYWRkaW5nOF80ID0gc21jX2RwbV90YWJsZS0+cGFkZGluZzhf
NDsKKworCS8qIEdGWENMSyBQTEwgU3ByZWFkIFNwZWN0cnVtICovCisJc21jX3BwdGFibGUtPlBs
bEdmeGNsa1NwcmVhZEVuYWJsZWQgPSBzbWNfZHBtX3RhYmxlLT5QbGxHZnhjbGtTcHJlYWRFbmFi
bGVkOworCXNtY19wcHRhYmxlLT5QbGxHZnhjbGtTcHJlYWRQZXJjZW50ID0gc21jX2RwbV90YWJs
ZS0+UGxsR2Z4Y2xrU3ByZWFkUGVyY2VudDsKKwlzbWNfcHB0YWJsZS0+UGxsR2Z4Y2xrU3ByZWFk
RnJlcSA9IHNtY19kcG1fdGFibGUtPlBsbEdmeGNsa1NwcmVhZEZyZXE7CisKKwkvKiBHRlhDTEsg
REZMTCBTcHJlYWQgU3BlY3RydW0gKi8KKwlzbWNfcHB0YWJsZS0+RGZsbEdmeGNsa1NwcmVhZEVu
YWJsZWQgPSBzbWNfZHBtX3RhYmxlLT5EZmxsR2Z4Y2xrU3ByZWFkRW5hYmxlZDsKKwlzbWNfcHB0
YWJsZS0+RGZsbEdmeGNsa1NwcmVhZFBlcmNlbnQgPSBzbWNfZHBtX3RhYmxlLT5EZmxsR2Z4Y2xr
U3ByZWFkUGVyY2VudDsKKwlzbWNfcHB0YWJsZS0+RGZsbEdmeGNsa1NwcmVhZEZyZXEgPSBzbWNf
ZHBtX3RhYmxlLT5EZmxsR2Z4Y2xrU3ByZWFkRnJlcTsKKworCS8qIFVDTEsgU3ByZWFkIFNwZWN0
cnVtICovCisJc21jX3BwdGFibGUtPlVjbGtTcHJlYWRFbmFibGVkID0gc21jX2RwbV90YWJsZS0+
VWNsa1NwcmVhZEVuYWJsZWQ7CisJc21jX3BwdGFibGUtPlVjbGtTcHJlYWRQZXJjZW50ID0gc21j
X2RwbV90YWJsZS0+VWNsa1NwcmVhZFBlcmNlbnQ7CisJc21jX3BwdGFibGUtPlVjbGtTcHJlYWRG
cmVxID0gc21jX2RwbV90YWJsZS0+VWNsa1NwcmVhZEZyZXE7CisKKwkvKiBTT0NDTEsgU3ByZWFk
IFNwZWN0cnVtICovCisJc21jX3BwdGFibGUtPlNvY2xrU3ByZWFkRW5hYmxlZCA9IHNtY19kcG1f
dGFibGUtPlNvY2xrU3ByZWFkRW5hYmxlZDsKKwlzbWNfcHB0YWJsZS0+U29jY2xrU3ByZWFkUGVy
Y2VudCA9IHNtY19kcG1fdGFibGUtPlNvY2Nsa1NwcmVhZFBlcmNlbnQ7CisJc21jX3BwdGFibGUt
PlNvY2Nsa1NwcmVhZEZyZXEgPSBzbWNfZHBtX3RhYmxlLT5Tb2NjbGtTcHJlYWRGcmVxOworCisJ
LyogVG90YWwgYm9hcmQgcG93ZXIgKi8KKwlzbWNfcHB0YWJsZS0+VG90YWxCb2FyZFBvd2VyID0g
c21jX2RwbV90YWJsZS0+VG90YWxCb2FyZFBvd2VyOworCXNtY19wcHRhYmxlLT5Cb2FyZFBhZGRp
bmcgPSBzbWNfZHBtX3RhYmxlLT5Cb2FyZFBhZGRpbmc7CisKKwkvKiBNdmRkIFN2aTIgRGl2IFJh
dGlvIFNldHRpbmcgKi8KKwlzbWNfcHB0YWJsZS0+TXZkZFJhdGlvID0gc21jX2RwbV90YWJsZS0+
TXZkZFJhdGlvOworCisJaWYgKGFkZXYtPnBtLnBwX2ZlYXR1cmUgJiBQUF9HRlhPRkZfTUFTSykg
eworCQkqKHVpbnQ2NF90ICopc21jX3BwdGFibGUtPkZlYXR1cmVzVG9SdW4gfD0gRkVBVFVSRV9N
QVNLKEZFQVRVUkVfR0ZYX1NTX0JJVCkKKwkJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9HRlhP
RkZfQklUKTsKKworCQkvKiBUT0RPOiByZW1vdmUgaXQgb25jZSBTTVUgZncgZml4IGl0ICovCisJ
CXNtY19wcHRhYmxlLT5EZWJ1Z092ZXJyaWRlcyB8PSBEUE1fT1ZFUlJJREVfRElTQUJMRV9ERkxM
X1BMTF9TSFVURE9XTjsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBuYXZpMTBf
c3RvcmVfcG93ZXJwbGF5X3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQoreworCXN0cnVj
dCBzbXVfMTFfMF9wb3dlcnBsYXlfdGFibGUgKnBvd2VycGxheV90YWJsZSA9IE5VTEw7CisJc3Ry
dWN0IHNtdV90YWJsZV9jb250ZXh0ICp0YWJsZV9jb250ZXh0ID0gJnNtdS0+c211X3RhYmxlOwor
CisJaWYgKCF0YWJsZV9jb250ZXh0LT5wb3dlcl9wbGF5X3RhYmxlKQorCQlyZXR1cm4gLUVJTlZB
TDsKKworCXBvd2VycGxheV90YWJsZSA9IHRhYmxlX2NvbnRleHQtPnBvd2VyX3BsYXlfdGFibGU7
CisKKwltZW1jcHkodGFibGVfY29udGV4dC0+ZHJpdmVyX3BwdGFibGUsICZwb3dlcnBsYXlfdGFi
bGUtPnNtY19wcHRhYmxlLAorCSAgICAgICBzaXplb2YoUFBUYWJsZV90KSk7CisKKwl0YWJsZV9j
b250ZXh0LT50aGVybWFsX2NvbnRyb2xsZXJfdHlwZSA9IHBvd2VycGxheV90YWJsZS0+dGhlcm1h
bF9jb250cm9sbGVyX3R5cGU7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBuYXZpMTBf
dGFibGVzX2luaXQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHN0cnVjdCBzbXVfdGFibGUgKnRh
YmxlcykKK3sKKwlTTVVfVEFCTEVfSU5JVCh0YWJsZXMsIFNNVV9UQUJMRV9QUFRBQkxFLCBzaXpl
b2YoUFBUYWJsZV90KSwKKwkJICAgICAgIFBBR0VfU0laRSwgQU1ER1BVX0dFTV9ET01BSU5fVlJB
TSk7CisJU01VX1RBQkxFX0lOSVQodGFibGVzLCBTTVVfVEFCTEVfV0FURVJNQVJLUywgc2l6ZW9m
KFdhdGVybWFya3NfdCksCisJCSAgICAgICBQQUdFX1NJWkUsIEFNREdQVV9HRU1fRE9NQUlOX1ZS
QU0pOworCVNNVV9UQUJMRV9JTklUKHRhYmxlcywgU01VX1RBQkxFX1NNVV9NRVRSSUNTLCBzaXpl
b2YoU211TWV0cmljc190KSwKKwkJICAgICAgIFBBR0VfU0laRSwgQU1ER1BVX0dFTV9ET01BSU5f
VlJBTSk7CisJU01VX1RBQkxFX0lOSVQodGFibGVzLCBTTVVfVEFCTEVfT1ZFUkRSSVZFLCBzaXpl
b2YoT3ZlckRyaXZlVGFibGVfdCksCisJCSAgICAgICBQQUdFX1NJWkUsIEFNREdQVV9HRU1fRE9N
QUlOX1ZSQU0pOworCVNNVV9UQUJMRV9JTklUKHRhYmxlcywgU01VX1RBQkxFX1BNU1RBVFVTTE9H
LCBTTVUxMV9UT09MX1NJWkUsCisJCSAgICAgICBQQUdFX1NJWkUsIEFNREdQVV9HRU1fRE9NQUlO
X1ZSQU0pOworCVNNVV9UQUJMRV9JTklUKHRhYmxlcywgU01VX1RBQkxFX0FDVElWSVRZX01PTklU
T1JfQ09FRkYsCisJCSAgICAgICBzaXplb2YoRHBtQWN0aXZpdHlNb25pdG9yQ29lZmZJbnRfdCks
IFBBR0VfU0laRSwKKwkgICAgICAgICAgICAgICBBTURHUFVfR0VNX0RPTUFJTl9WUkFNKTsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IG5hdmkxMF9hbGxvY2F0ZV9kcG1fY29udGV4dChz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKK3sKKwlzdHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpzbXVf
ZHBtID0gJnNtdS0+c211X2RwbTsKKworCWlmIChzbXVfZHBtLT5kcG1fY29udGV4dCkKKwkJcmV0
dXJuIC1FSU5WQUw7CisKKwlzbXVfZHBtLT5kcG1fY29udGV4dCA9IGt6YWxsb2Moc2l6ZW9mKHN0
cnVjdCBzbXVfMTFfMF9kcG1fY29udGV4dCksCisJCQkJICAgICAgIEdGUF9LRVJORUwpOworCWlm
ICghc211X2RwbS0+ZHBtX2NvbnRleHQpCisJCXJldHVybiAtRU5PTUVNOworCisJc211X2RwbS0+
ZHBtX2NvbnRleHRfc2l6ZSA9IHNpemVvZihzdHJ1Y3Qgc211XzExXzBfZHBtX2NvbnRleHQpOwor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbmF2aTEwX3NldF9kZWZhdWx0X2RwbV90YWJs
ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKK3sKKwlzdHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpz
bXVfZHBtID0gJnNtdS0+c211X2RwbTsKKwlzdHJ1Y3Qgc211X3RhYmxlX2NvbnRleHQgKnRhYmxl
X2NvbnRleHQgPSAmc211LT5zbXVfdGFibGU7CisJc3RydWN0IHNtdV8xMV8wX2RwbV9jb250ZXh0
ICpkcG1fY29udGV4dCA9IHNtdV9kcG0tPmRwbV9jb250ZXh0OworCVBQVGFibGVfdCAqZHJpdmVy
X3BwdCA9IE5VTEw7CisKKyAgICAgICAgZHJpdmVyX3BwdCA9IHRhYmxlX2NvbnRleHQtPmRyaXZl
cl9wcHRhYmxlOworCisgICAgICAgIGRwbV9jb250ZXh0LT5kcG1fdGFibGVzLnNvY190YWJsZS5t
aW4gPSBkcml2ZXJfcHB0LT5GcmVxVGFibGVTb2NjbGtbMF07CisgICAgICAgIGRwbV9jb250ZXh0
LT5kcG1fdGFibGVzLnNvY190YWJsZS5tYXggPSBkcml2ZXJfcHB0LT5GcmVxVGFibGVTb2NjbGtb
TlVNX1NPQ0NMS19EUE1fTEVWRUxTIC0gMV07CisKKyAgICAgICAgZHBtX2NvbnRleHQtPmRwbV90
YWJsZXMuZ2Z4X3RhYmxlLm1pbiA9IGRyaXZlcl9wcHQtPkZyZXFUYWJsZUdmeFswXTsKKyAgICAg
ICAgZHBtX2NvbnRleHQtPmRwbV90YWJsZXMuZ2Z4X3RhYmxlLm1heCA9IGRyaXZlcl9wcHQtPkZy
ZXFUYWJsZUdmeFtOVU1fR0ZYQ0xLX0RQTV9MRVZFTFMgLSAxXTsKKworICAgICAgICBkcG1fY29u
dGV4dC0+ZHBtX3RhYmxlcy51Y2xrX3RhYmxlLm1pbiA9IGRyaXZlcl9wcHQtPkZyZXFUYWJsZVVj
bGtbMF07CisgICAgICAgIGRwbV9jb250ZXh0LT5kcG1fdGFibGVzLnVjbGtfdGFibGUubWF4ID0g
ZHJpdmVyX3BwdC0+RnJlcVRhYmxlVWNsa1tOVU1fVUNMS19EUE1fTEVWRUxTIC0gMV07CisKKyAg
ICAgICAgZHBtX2NvbnRleHQtPmRwbV90YWJsZXMudmNsa190YWJsZS5taW4gPSBkcml2ZXJfcHB0
LT5GcmVxVGFibGVWY2xrWzBdOworICAgICAgICBkcG1fY29udGV4dC0+ZHBtX3RhYmxlcy52Y2xr
X3RhYmxlLm1heCA9IGRyaXZlcl9wcHQtPkZyZXFUYWJsZVZjbGtbTlVNX1ZDTEtfRFBNX0xFVkVM
UyAtIDFdOworCisgICAgICAgIGRwbV9jb250ZXh0LT5kcG1fdGFibGVzLmRjbGtfdGFibGUubWlu
ID0gZHJpdmVyX3BwdC0+RnJlcVRhYmxlRGNsa1swXTsKKyAgICAgICAgZHBtX2NvbnRleHQtPmRw
bV90YWJsZXMuZGNsa190YWJsZS5tYXggPSBkcml2ZXJfcHB0LT5GcmVxVGFibGVEY2xrW05VTV9E
Q0xLX0RQTV9MRVZFTFMgLSAxXTsKKworICAgICAgICBkcG1fY29udGV4dC0+ZHBtX3RhYmxlcy5k
Y2VmX3RhYmxlLm1pbiA9IGRyaXZlcl9wcHQtPkZyZXFUYWJsZURjZWZjbGtbMF07CisgICAgICAg
IGRwbV9jb250ZXh0LT5kcG1fdGFibGVzLmRjZWZfdGFibGUubWF4ID0gZHJpdmVyX3BwdC0+RnJl
cVRhYmxlRGNlZmNsa1tOVU1fRENFRkNMS19EUE1fTEVWRUxTIC0gMV07CisKKyAgICAgICAgZHBt
X2NvbnRleHQtPmRwbV90YWJsZXMucGl4ZWxfdGFibGUubWluID0gZHJpdmVyX3BwdC0+RnJlcVRh
YmxlUGl4Y2xrWzBdOworICAgICAgICBkcG1fY29udGV4dC0+ZHBtX3RhYmxlcy5waXhlbF90YWJs
ZS5tYXggPSBkcml2ZXJfcHB0LT5GcmVxVGFibGVQaXhjbGtbTlVNX1BJWENMS19EUE1fTEVWRUxT
IC0gMV07CisKKyAgICAgICAgZHBtX2NvbnRleHQtPmRwbV90YWJsZXMuZGlzcGxheV90YWJsZS5t
aW4gPSBkcml2ZXJfcHB0LT5GcmVxVGFibGVEaXNwY2xrWzBdOworICAgICAgICBkcG1fY29udGV4
dC0+ZHBtX3RhYmxlcy5kaXNwbGF5X3RhYmxlLm1heCA9IGRyaXZlcl9wcHQtPkZyZXFUYWJsZURp
c3BjbGtbTlVNX0RJU1BDTEtfRFBNX0xFVkVMUyAtIDFdOworCisgICAgICAgIGRwbV9jb250ZXh0
LT5kcG1fdGFibGVzLnBoeV90YWJsZS5taW4gPSBkcml2ZXJfcHB0LT5GcmVxVGFibGVQaHljbGtb
MF07CisgICAgICAgIGRwbV9jb250ZXh0LT5kcG1fdGFibGVzLnBoeV90YWJsZS5tYXggPSBkcml2
ZXJfcHB0LT5GcmVxVGFibGVQaHljbGtbTlVNX1BIWUNMS19EUE1fTEVWRUxTIC0gMV07CisKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIGludCBuYXZpMTBfZHBtX3NldF91dmRfZW5hYmxlKHN0cnVj
dCBzbXVfY29udGV4dCAqc211LCBib29sIGVuYWJsZSkKK3sKKwlpbnQgcmV0ID0gMDsKKwlzdHJ1
Y3Qgc211X3Bvd2VyX2NvbnRleHQgKnNtdV9wb3dlciA9ICZzbXUtPnNtdV9wb3dlcjsKKwlzdHJ1
Y3Qgc211X3Bvd2VyX2dhdGUgKnBvd2VyX2dhdGUgPSAmc211X3Bvd2VyLT5wb3dlcl9nYXRlOwor
CisJaWYgKGVuYWJsZSAmJiBwb3dlcl9nYXRlLT51dmRfZ2F0ZWQpIHsKKwkJaWYgKHNtdV9mZWF0
dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVVZEX0JJVCkpIHsKKwkJCXJldCA9
IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfUG93ZXJVcFZjbiwgMSk7
CisJCQlpZiAocmV0KQorCQkJCXJldHVybiByZXQ7CisJCX0KKwkJcG93ZXJfZ2F0ZS0+dXZkX2dh
dGVkID0gZmFsc2U7CisJfSBlbHNlIHsKKwkJaWYgKCFlbmFibGUgJiYgIXBvd2VyX2dhdGUtPnV2
ZF9nYXRlZCkgeworCQkJaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVS
RV9EUE1fVVZEX0JJVCkpIHsKKwkJCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnKHNtdSwgU01VX01T
R19Qb3dlckRvd25WY24pOworCQkJCWlmIChyZXQpCisJCQkJCXJldHVybiByZXQ7CisJCQl9CisJ
CQlwb3dlcl9nYXRlLT51dmRfZ2F0ZWQgPSB0cnVlOworCQl9CisJfQorCisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgbmF2aTEwX2dldF9jdXJyZW50X2Nsa19mcmVxX2J5X3RhYmxlKHN0cnVj
dCBzbXVfY29udGV4dCAqc211LAorCQkJCSAgICAgICBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlw
ZSwKKwkJCQkgICAgICAgdWludDMyX3QgKnZhbHVlKQoreworCXN0YXRpYyBTbXVNZXRyaWNzX3Qg
bWV0cmljcyA9IHswfTsKKwlpbnQgcmV0ID0gMCwgY2xrX2lkID0gMDsKKworCWlmICghdmFsdWUp
CisJCXJldHVybiAtRUlOVkFMOworCisJcmV0ID0gc211X3VwZGF0ZV90YWJsZShzbXUsIFNNVV9U
QUJMRV9TTVVfTUVUUklDUywgKHZvaWQgKikmbWV0cmljcywgZmFsc2UpOworCWlmIChyZXQpCisJ
CXJldHVybiByZXQ7CisKKwljbGtfaWQgPSBzbXVfY2xrX2dldF9pbmRleChzbXUsIGNsa190eXBl
KTsKKwlpZiAoY2xrX2lkIDwgMCkKKwkJcmV0dXJuIGNsa19pZDsKKworCSp2YWx1ZSA9IG1ldHJp
Y3MuQ3VyckNsb2NrW2Nsa19pZF07CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IG5h
dmkxMF9wcmludF9jbGtfbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAorCQkJZW51bSBz
bXVfY2xrX3R5cGUgY2xrX3R5cGUsIGNoYXIgKmJ1ZikKK3sKKwlpbnQgaSwgc2l6ZSA9IDAsIHJl
dCA9IDA7CisJdWludDMyX3QgY3VyX3ZhbHVlID0gMCwgdmFsdWUgPSAwLCBjb3VudCA9IDA7CisK
Kwlzd2l0Y2ggKGNsa190eXBlKSB7CisJY2FzZSBTTVVfR0ZYQ0xLOgorCWNhc2UgU01VX1NDTEs6
CisJY2FzZSBTTVVfU09DQ0xLOgorCWNhc2UgU01VX01DTEs6CisJY2FzZSBTTVVfVUNMSzoKKwlj
YXNlIFNNVV9GQ0xLOgorCWNhc2UgU01VX0RDRUZDTEs6CisJCXJldCA9IHNtdV9nZXRfY3VycmVu
dF9jbGtfZnJlcShzbXUsIGNsa190eXBlLCAmY3VyX3ZhbHVlKTsKKwkJaWYgKHJldCkKKwkJCXJl
dHVybiBzaXplOworCQkvKiAxMEtIeiAtPiBNSHogKi8KKwkJY3VyX3ZhbHVlID0gY3VyX3ZhbHVl
IC8gMTAwOworCisJCXNpemUgKz0gc3ByaW50ZihidWYsICJjdXJyZW50IGNsazogJXVNaHpcbiIs
IGN1cl92YWx1ZSk7CisKKwkJcmV0ID0gc211X2dldF9kcG1fbGV2ZWxfY291bnQoc211LCBjbGtf
dHlwZSwgJmNvdW50KTsKKwkJaWYgKHJldCkKKwkJCXJldHVybiBzaXplOworCisJCWZvciAoaSA9
IDA7IGkgPCBjb3VudDsgaSsrKSB7CisJCQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX2J5X2luZGV4
KHNtdSwgY2xrX3R5cGUsIGksICZ2YWx1ZSk7CisJCQlpZiAocmV0KQorCQkJCXJldHVybiBzaXpl
OworCisJCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIiVkOiAldU1oeiAlc1xuIiwgaSwg
dmFsdWUsCisJCQkJCWN1cl92YWx1ZSA9PSB2YWx1ZSA/ICIqIiA6ICIiKTsKKwkJfQorCQlicmVh
azsKKwlkZWZhdWx0OgorCQlicmVhazsKKwl9CisKKwlyZXR1cm4gc2l6ZTsKK30KKworc3RhdGlj
IGludCBuYXZpMTBfZm9yY2VfY2xrX2xldmVscyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKKwkJ
CQkgICBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwgdWludDMyX3QgbWFzaykKK3sKKworCWlu
dCByZXQgPSAwLCBzaXplID0gMDsKKwl1aW50MzJfdCBzb2Z0X21pbl9sZXZlbCA9IDAsIHNvZnRf
bWF4X2xldmVsID0gMCwgbWluX2ZyZXEgPSAwLCBtYXhfZnJlcSA9IDA7CisKKwlzb2Z0X21pbl9s
ZXZlbCA9IG1hc2sgPyAoZmZzKG1hc2spIC0gMSkgOiAwOworCXNvZnRfbWF4X2xldmVsID0gbWFz
ayA/IChmbHMobWFzaykgLSAxKSA6IDA7CisKKwlzd2l0Y2ggKGNsa190eXBlKSB7CisJY2FzZSBT
TVVfR0ZYQ0xLOgorCWNhc2UgU01VX1NDTEs6CisJY2FzZSBTTVVfU09DQ0xLOgorCWNhc2UgU01V
X01DTEs6CisJY2FzZSBTTVVfVUNMSzoKKwljYXNlIFNNVV9EQ0VGQ0xLOgorCWNhc2UgU01VX0ZD
TEs6CisJCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfYnlfaW5kZXgoc211LCBjbGtfdHlwZSwgc29m
dF9taW5fbGV2ZWwsICZtaW5fZnJlcSk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4gc2l6ZTsKKwor
CQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX2J5X2luZGV4KHNtdSwgY2xrX3R5cGUsIHNvZnRfbWF4
X2xldmVsLCAmbWF4X2ZyZXEpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHNpemU7CisKKwkJcmV0
ID0gc211X3NldF9zb2Z0X2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlwZSwgbWluX2ZyZXEsIG1heF9m
cmVxKTsKKwkJaWYgKHJldCkKKwkJCXJldHVybiBzaXplOworCQlicmVhazsKKwlkZWZhdWx0Ogor
CQlicmVhazsKKwl9CisKKwlyZXR1cm4gc2l6ZTsKK30KKworc3RhdGljIGludCBuYXZpMTBfcG9w
dWxhdGVfdW1kX3N0YXRlX2NsayhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKK3sKKwlpbnQgcmV0
ID0gMDsKKwl1aW50MzJfdCBtaW5fc2Nsa19mcmVxID0gMDsKKworCXJldCA9IHNtdV9nZXRfZHBt
X2ZyZXFfcmFuZ2Uoc211LCBTTVVfU0NMSywgJm1pbl9zY2xrX2ZyZXEsIE5VTEwpOworCWlmIChy
ZXQpCisJCXJldHVybiByZXQ7CisKKwlzbXUtPnBzdGF0ZV9zY2xrID0gbWluX3NjbGtfZnJlcSAq
IDEwMDsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgbmF2aTEwX2dldF9jbG9ja19i
eV90eXBlX3dpdGhfbGF0ZW5jeShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKKwkJCQkJCSBlbnVt
IHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwKKwkJCQkJCSBzdHJ1Y3QgcHBfY2xvY2tfbGV2ZWxzX3dp
dGhfbGF0ZW5jeSAqY2xvY2tzKQoreworCWludCByZXQgPSAwLCBpID0gMDsKKwl1aW50MzJfdCBs
ZXZlbF9jb3VudCA9IDAsIGZyZXEgPSAwOworCisJc3dpdGNoIChjbGtfdHlwZSkgeworCWNhc2Ug
U01VX0dGWENMSzoKKwljYXNlIFNNVV9EQ0VGQ0xLOgorCWNhc2UgU01VX1NPQ0NMSzoKKwkJcmV0
ID0gc211X2dldF9kcG1fbGV2ZWxfY291bnQoc211LCBjbGtfdHlwZSwgJmxldmVsX2NvdW50KTsK
KwkJaWYgKHJldCkKKwkJCXJldHVybiByZXQ7CisKKwkJbGV2ZWxfY291bnQgPSBtaW4obGV2ZWxf
Y291bnQsICh1aW50MzJfdClNQVhfTlVNX0NMT0NLUyk7CisJCWNsb2Nrcy0+bnVtX2xldmVscyA9
IGxldmVsX2NvdW50OworCisJCWZvciAoaSA9IDA7IGkgPCBsZXZlbF9jb3VudDsgaSsrKSB7CisJ
CQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX2J5X2luZGV4KHNtdSwgY2xrX3R5cGUsIGksICZmcmVx
KTsKKwkJCWlmIChyZXQpCisJCQkJcmV0dXJuIHJldDsKKworCQkJY2xvY2tzLT5kYXRhW2ldLmNs
b2Nrc19pbl9raHogPSBmcmVxICogMTAwMDsKKwkJCWNsb2Nrcy0+ZGF0YVtpXS5sYXRlbmN5X2lu
X3VzID0gMDsKKwkJfQorCQlicmVhazsKKwlkZWZhdWx0OgorCQlicmVhazsKKwl9CisKKwlyZXR1
cm4gcmV0OworfQorCitzdGF0aWMgaW50IG5hdmkxMF9wcmVfZGlzcGxheV9jb25maWdfY2hhbmdl
ZChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKK3sKKwlpbnQgcmV0ID0gMDsKKwl1aW50MzJfdCBt
YXhfZnJlcSA9IDA7CisKKwlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LCBT
TVVfTVNHX051bU9mRGlzcGxheXMsIDApOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlp
ZiAoc211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9VQ0xLX0JJVCkp
IHsKKwkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9VQ0xLLCBOVUxMLCAm
bWF4X2ZyZXEpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKwkJcmV0ID0gc211X3NldF9o
YXJkX2ZyZXFfcmFuZ2Uoc211LCBTTVVfVUNMSywgMCwgbWF4X2ZyZXEpOworCQlpZiAocmV0KQor
CQkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IG5hdmkx
MF9kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQoreworCWlu
dCByZXQgPSAwOworCisJaWYgKChzbXUtPndhdGVybWFya3NfYml0bWFwICYgV0FURVJNQVJLU19F
WElTVCkgJiYKKwkgICAgIShzbXUtPndhdGVybWFya3NfYml0bWFwICYgV0FURVJNQVJLU19MT0FE
RUQpKSB7CisJCXJldCA9IHNtdV93cml0ZV93YXRlcm1hcmtzX3RhYmxlKHNtdSk7CisJCWlmIChy
ZXQpCisJCQlyZXR1cm4gcmV0OworCisJCXNtdS0+d2F0ZXJtYXJrc19iaXRtYXAgfD0gV0FURVJN
QVJLU19MT0FERUQ7CisJfQorCisJaWYgKChzbXUtPndhdGVybWFya3NfYml0bWFwICYgV0FURVJN
QVJLU19FWElTVCkgJiYKKwkgICAgc211X2ZlYXR1cmVfaXNfc3VwcG9ydGVkKHNtdSwgU01VX0ZF
QVRVUkVfRFBNX0RDRUZDTEtfQklUKSAmJgorCSAgICBzbXVfZmVhdHVyZV9pc19zdXBwb3J0ZWQo
c211LCBTTVVfRkVBVFVSRV9EUE1fU09DQ0xLX0JJVCkpIHsKKwkJcmV0ID0gc211X3NlbmRfc21j
X21zZ193aXRoX3BhcmFtKHNtdSwgU01VX01TR19OdW1PZkRpc3BsYXlzLAorCQkJCQkJICBzbXUt
PmRpc3BsYXlfY29uZmlnLT5udW1fZGlzcGxheSk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4gcmV0
OworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgbmF2aTEwX2ZvcmNlX2RwbV9s
aW1pdF92YWx1ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgYm9vbCBoaWdoZXN0KQoreworCWlu
dCByZXQgPSAwLCBpID0gMDsKKwl1aW50MzJfdCBtaW5fZnJlcSwgbWF4X2ZyZXEsIGZvcmNlX2Zy
ZXE7CisJZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGU7CisKKwllbnVtIHNtdV9jbGtfdHlwZSBj
bGtzW10gPSB7CisJCVNNVV9HRlhDTEssCisJCVNNVV9NQ0xLLAorCQlTTVVfU09DQ0xLLAorCX07
CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShjbGtzKTsgaSsrKSB7CisJCWNsa190eXBl
ID0gY2xrc1tpXTsKKwkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIGNsa190eXBl
LCAmbWluX2ZyZXEsICZtYXhfZnJlcSk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4gcmV0OworCisJ
CWZvcmNlX2ZyZXEgPSBoaWdoZXN0ID8gbWF4X2ZyZXEgOiBtaW5fZnJlcTsKKwkJcmV0ID0gc211
X3NldF9zb2Z0X2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlwZSwgZm9yY2VfZnJlcSwgZm9yY2VfZnJl
cSk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4gcmV0OworCX0KKworCXJldHVybiByZXQ7Cit9CisK
K3N0YXRpYyBpbnQgbmF2aTEwX3VuZm9yY2VfZHBtX2xldmVscyhzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSkgeworCisJaW50IHJldCA9IDAsIGkgPSAwOworCXVpbnQzMl90IG1pbl9mcmVxLCBtYXhf
ZnJlcTsKKwllbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlwZTsKKworCXN0cnVjdCBjbGtfZmVhdHVy
ZV9tYXAgeworCQllbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlwZTsKKwkJdWludDMyX3QJZmVhdHVy
ZTsKKwl9IGNsa19mZWF0dXJlX21hcFtdID0geworCQl7U01VX0dGWENMSywgU01VX0ZFQVRVUkVf
RFBNX0dGWENMS19CSVR9LAorCQl7U01VX01DTEssICAgU01VX0ZFQVRVUkVfRFBNX1VDTEtfQklU
fSwKKwkJe1NNVV9TT0NDTEssIFNNVV9GRUFUVVJFX0RQTV9TT0NDTEtfQklUfSwKKwl9OworCisJ
Zm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY2xrX2ZlYXR1cmVfbWFwKTsgaSsrKSB7CisJCWlm
ICghc211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIGNsa19mZWF0dXJlX21hcFtpXS5mZWF0dXJl
KSkKKwkJICAgIGNvbnRpbnVlOworCisJCWNsa190eXBlID0gY2xrX2ZlYXR1cmVfbWFwW2ldLmNs
a190eXBlOworCisJCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBjbGtfdHlwZSwg
Jm1pbl9mcmVxLCAmbWF4X2ZyZXEpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKworCQly
ZXQgPSBzbXVfc2V0X3NvZnRfZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCBtaW5fZnJlcSwgbWF4
X2ZyZXEpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXR1cm4gcmV0Owor
fQorCitzdGF0aWMgaW50IG5hdmkxMF9nZXRfZ3B1X3Bvd2VyKHN0cnVjdCBzbXVfY29udGV4dCAq
c211LCB1aW50MzJfdCAqdmFsdWUpCit7CisJaW50IHJldCA9IDA7CisJU211TWV0cmljc190IG1l
dHJpY3M7CisKKwlpZiAoIXZhbHVlKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXJldCA9IHNtdV91
cGRhdGVfdGFibGUoc211LCBTTVVfVEFCTEVfU01VX01FVFJJQ1MsICh2b2lkICopJm1ldHJpY3Ms
CisJCQkgICAgICAgZmFsc2UpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwkqdmFsdWUg
PSBtZXRyaWNzLkN1cnJTb2NrZXRQb3dlciA8PCA4OworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBpbnQgbmF2aTEwX2dldF9jdXJyZW50X2FjdGl2aXR5X3BlcmNlbnQoc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUsCisJCQkJCSAgICAgICB1aW50MzJfdCAqdmFsdWUpCit7CisJaW50IHJldCA9IDA7
CisJU211TWV0cmljc190IG1ldHJpY3M7CisKKwlpZiAoIXZhbHVlKQorCQlyZXR1cm4gLUVJTlZB
TDsKKworCW1zbGVlcCgxKTsKKworCXJldCA9IHNtdV91cGRhdGVfdGFibGUoc211LCBTTVVfVEFC
TEVfU01VX01FVFJJQ1MsCisJCQkgICAgICAgKHZvaWQgKikmbWV0cmljcywgZmFsc2UpOworCWlm
IChyZXQpCisJCXJldHVybiByZXQ7CisKKwkqdmFsdWUgPSBtZXRyaWNzLkF2ZXJhZ2VHZnhBY3Rp
dml0eTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgYm9vbCBuYXZpMTBfaXNfZHBtX3J1bm5p
bmcoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCit7CisJaW50IHJldCA9IDA7CisJdWludDMyX3Qg
ZmVhdHVyZV9tYXNrWzJdOworCXVuc2lnbmVkIGxvbmcgZmVhdHVyZV9lbmFibGVkOworCXJldCA9
IHNtdV9mZWF0dXJlX2dldF9lbmFibGVkX21hc2soc211LCBmZWF0dXJlX21hc2ssIDIpOworCWZl
YXR1cmVfZW5hYmxlZCA9ICh1bnNpZ25lZCBsb25nKSgodWludDY0X3QpZmVhdHVyZV9tYXNrWzBd
IHwKKwkJCSAgICgodWludDY0X3QpZmVhdHVyZV9tYXNrWzFdIDw8IDMyKSk7CisJcmV0dXJuICEh
KGZlYXR1cmVfZW5hYmxlZCAmIFNNQ19EUE1fRkVBVFVSRSk7Cit9CisKK3N0YXRpYyBpbnQgbmF2
aTEwX2dldF9mYW5fc3BlZWQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQxNl90ICp2YWx1
ZSkKK3sKKwlTbXVNZXRyaWNzX3QgbWV0cmljcyA9IHswfTsKKwlpbnQgcmV0ID0gMDsKKworCWlm
ICghdmFsdWUpCisJCXJldHVybiAtRUlOVkFMOworCisJcmV0ID0gc211X3VwZGF0ZV90YWJsZShz
bXUsIFNNVV9UQUJMRV9TTVVfTUVUUklDUywKKwkJCSAgICAgICAodm9pZCAqKSZtZXRyaWNzLCBm
YWxzZSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCSp2YWx1ZSA9IG1ldHJpY3MuQ3Vy
ckZhblNwZWVkOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBuYXZpMTBfZ2V0X2Zh
bl9zcGVlZF9wZXJjZW50KHN0cnVjdCBzbXVfY29udGV4dCAqc211LAorCQkJCQl1aW50MzJfdCAq
c3BlZWQpCit7CisJaW50IHJldCA9IDA7CisJdWludDMyX3QgcGVyY2VudCA9IDA7CisJdWludDE2
X3QgY3VycmVudF9ycG07CisJUFBUYWJsZV90ICpwcHRhYmxlID0gc211LT5zbXVfdGFibGUuZHJp
dmVyX3BwdGFibGU7CisKKwlyZXQgPSBuYXZpMTBfZ2V0X2Zhbl9zcGVlZChzbXUsICZjdXJyZW50
X3JwbSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXBlcmNlbnQgPSBjdXJyZW50X3Jw
bSAqIDEwMCAvIHBwdGFibGUtPkZhbk1heGltdW1ScG07CisJKnNwZWVkID0gcGVyY2VudCA+IDEw
MCA/IDEwMCA6IHBlcmNlbnQ7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IG5hdmkx
MF9nZXRfcG93ZXJfcHJvZmlsZV9tb2RlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBjaGFyICpi
dWYpCit7CisJRHBtQWN0aXZpdHlNb25pdG9yQ29lZmZJbnRfdCBhY3Rpdml0eV9tb25pdG9yOwor
CXVpbnQzMl90IGksIHNpemUgPSAwOworCXVpbnQxNl90IHdvcmtsb2FkX3R5cGUgPSAwOworCXN0
YXRpYyBjb25zdCBjaGFyICpwcm9maWxlX25hbWVbXSA9IHsKKwkJCQkJIkJPT1RVUF9ERUZBVUxU
IiwKKwkJCQkJIjNEX0ZVTExfU0NSRUVOIiwKKwkJCQkJIlBPV0VSX1NBVklORyIsCisJCQkJCSJW
SURFTyIsCisJCQkJCSJWUiIsCisJCQkJCSJDT01QVVRFIiwKKwkJCQkJIkNVU1RPTSJ9OworCXN0
YXRpYyBjb25zdCBjaGFyICp0aXRsZVtdID0geworCQkJIlBST0ZJTEVfSU5ERVgoTkFNRSkiLAor
CQkJIkNMT0NLX1RZUEUoTkFNRSkiLAorCQkJIkZQUyIsCisJCQkiTWluRnJlcVR5cGUiLAorCQkJ
Ik1pbkFjdGl2ZUZyZXFUeXBlIiwKKwkJCSJNaW5BY3RpdmVGcmVxIiwKKwkJCSJCb29zdGVyRnJl
cVR5cGUiLAorCQkJIkJvb3N0ZXJGcmVxIiwKKwkJCSJQRF9EYXRhX2xpbWl0X2MiLAorCQkJIlBE
X0RhdGFfZXJyb3JfY29lZmYiLAorCQkJIlBEX0RhdGFfZXJyb3JfcmF0ZV9jb2VmZiJ9OworCWlu
dCByZXN1bHQgPSAwOworCisJaWYgKCFidWYpCisJCXJldHVybiAtRUlOVkFMOworCisJc2l6ZSAr
PSBzcHJpbnRmKGJ1ZiArIHNpemUsICIlMTZzICVzICVzICVzICVzICVzICVzICVzICVzICVzICVz
XG4iLAorCQkJdGl0bGVbMF0sIHRpdGxlWzFdLCB0aXRsZVsyXSwgdGl0bGVbM10sIHRpdGxlWzRd
LCB0aXRsZVs1XSwKKwkJCXRpdGxlWzZdLCB0aXRsZVs3XSwgdGl0bGVbOF0sIHRpdGxlWzldLCB0
aXRsZVsxMF0pOworCisJZm9yIChpID0gMDsgaSA8PSBQUF9TTUNfUE9XRVJfUFJPRklMRV9DVVNU
T007IGkrKykgeworCQkvKiBjb252IFBQX1NNQ19QT1dFUl9QUk9GSUxFKiB0byBXT1JLTE9BRF9Q
UExJQl8qX0JJVCAqLworCQl3b3JrbG9hZF90eXBlID0gc211X3dvcmtsb2FkX2dldF90eXBlKHNt
dSwgaSk7CisJCXJlc3VsdCA9IHNtdV91cGRhdGVfdGFibGUoc211LAorCQkJCQkgIFNNVV9UQUJM
RV9BQ1RJVklUWV9NT05JVE9SX0NPRUZGIHwgd29ya2xvYWRfdHlwZSA8PCAxNiwKKwkJCQkJICAo
dm9pZCAqKSgmYWN0aXZpdHlfbW9uaXRvciksIGZhbHNlKTsKKwkJaWYgKHJlc3VsdCkgeworCQkJ
cHJfZXJyKCJbJXNdIEZhaWxlZCB0byBnZXQgYWN0aXZpdHkgbW9uaXRvciEiLCBfX2Z1bmNfXyk7
CisJCQlyZXR1cm4gcmVzdWx0OworCQl9CisKKwkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUs
ICIlMmQgJTE0cyVzOlxuIiwKKwkJCWksIHByb2ZpbGVfbmFtZVtpXSwgKGkgPT0gc211LT5wb3dl
cl9wcm9maWxlX21vZGUpID8gIioiIDogIiAiKTsKKworCQlzaXplICs9IHNwcmludGYoYnVmICsg
c2l6ZSwgIiUxOXMgJWQoJTEzcykgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2Rc
biIsCisJCQkiICIsCisJCQkwLAorCQkJIkdGWENMSyIsCisJCQlhY3Rpdml0eV9tb25pdG9yLkdm
eF9GUFMsCisJCQlhY3Rpdml0eV9tb25pdG9yLkdmeF9NaW5GcmVxU3RlcCwKKwkJCWFjdGl2aXR5
X21vbml0b3IuR2Z4X01pbkFjdGl2ZUZyZXFUeXBlLAorCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhf
TWluQWN0aXZlRnJlcSwKKwkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X0Jvb3N0ZXJGcmVxVHlwZSwK
KwkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X0Jvb3N0ZXJGcmVxLAorCQkJYWN0aXZpdHlfbW9uaXRv
ci5HZnhfUERfRGF0YV9saW1pdF9jLAorCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfUERfRGF0YV9l
cnJvcl9jb2VmZiwKKwkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X1BEX0RhdGFfZXJyb3JfcmF0ZV9j
b2VmZik7CisKKwkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIlMTlzICVkKCUxM3MpICU3
ZCAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkXG4iLAorCQkJIiAiLAorCQkJMSwKKwkJ
CSJTT0NDTEsiLAorCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfRlBTLAorCQkJYWN0aXZpdHlfbW9u
aXRvci5Tb2NfTWluRnJlcVN0ZXAsCisJCQlhY3Rpdml0eV9tb25pdG9yLlNvY19NaW5BY3RpdmVG
cmVxVHlwZSwKKwkJCWFjdGl2aXR5X21vbml0b3IuU29jX01pbkFjdGl2ZUZyZXEsCisJCQlhY3Rp
dml0eV9tb25pdG9yLlNvY19Cb29zdGVyRnJlcVR5cGUsCisJCQlhY3Rpdml0eV9tb25pdG9yLlNv
Y19Cb29zdGVyRnJlcSwKKwkJCWFjdGl2aXR5X21vbml0b3IuU29jX1BEX0RhdGFfbGltaXRfYywK
KwkJCWFjdGl2aXR5X21vbml0b3IuU29jX1BEX0RhdGFfZXJyb3JfY29lZmYsCisJCQlhY3Rpdml0
eV9tb25pdG9yLlNvY19QRF9EYXRhX2Vycm9yX3JhdGVfY29lZmYpOworCisJCXNpemUgKz0gc3By
aW50ZihidWYgKyBzaXplLCAiJTE5cyAlZCglMTNzKSAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZCAl
N2QgJTdkICU3ZFxuIiwKKwkJCSIgIiwKKwkJCTIsCisJCQkiTUVNTEsiLAorCQkJYWN0aXZpdHlf
bW9uaXRvci5NZW1fRlBTLAorCQkJYWN0aXZpdHlfbW9uaXRvci5NZW1fTWluRnJlcVN0ZXAsCisJ
CQlhY3Rpdml0eV9tb25pdG9yLk1lbV9NaW5BY3RpdmVGcmVxVHlwZSwKKwkJCWFjdGl2aXR5X21v
bml0b3IuTWVtX01pbkFjdGl2ZUZyZXEsCisJCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9Cb29zdGVy
RnJlcVR5cGUsCisJCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9Cb29zdGVyRnJlcSwKKwkJCWFjdGl2
aXR5X21vbml0b3IuTWVtX1BEX0RhdGFfbGltaXRfYywKKwkJCWFjdGl2aXR5X21vbml0b3IuTWVt
X1BEX0RhdGFfZXJyb3JfY29lZmYsCisJCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9QRF9EYXRhX2Vy
cm9yX3JhdGVfY29lZmYpOworCX0KKworCXJldHVybiBzaXplOworfQorCitzdGF0aWMgaW50IG5h
dmkxMF9zZXRfcG93ZXJfcHJvZmlsZV9tb2RlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBsb25n
ICppbnB1dCwgdWludDMyX3Qgc2l6ZSkKK3sKKwlEcG1BY3Rpdml0eU1vbml0b3JDb2VmZkludF90
IGFjdGl2aXR5X21vbml0b3I7CisJaW50IHdvcmtsb2FkX3R5cGUsIHJldCA9IDA7CisKKwlzbXUt
PnBvd2VyX3Byb2ZpbGVfbW9kZSA9IGlucHV0W3NpemVdOworCisJaWYgKHNtdS0+cG93ZXJfcHJv
ZmlsZV9tb2RlID4gUFBfU01DX1BPV0VSX1BST0ZJTEVfQ1VTVE9NKSB7CisJCXByX2VycigiSW52
YWxpZCBwb3dlciBwcm9maWxlIG1vZGUgJWRcbiIsIHNtdS0+cG93ZXJfcHJvZmlsZV9tb2RlKTsK
KwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJaWYgKHNtdS0+cG93ZXJfcHJvZmlsZV9tb2RlID09
IFBQX1NNQ19QT1dFUl9QUk9GSUxFX0NVU1RPTSkgeworCQlpZiAoc2l6ZSA8IDApCisJCQlyZXR1
cm4gLUVJTlZBTDsKKworCQlyZXQgPSBzbXVfdXBkYXRlX3RhYmxlKHNtdSwKKwkJCQkgICAgICAg
U01VX1RBQkxFX0FDVElWSVRZX01PTklUT1JfQ09FRkYgfCBXT1JLTE9BRF9QUExJQl9DVVNUT01f
QklUIDw8IDE2LAorCQkJCSAgICAgICAodm9pZCAqKSgmYWN0aXZpdHlfbW9uaXRvciksIGZhbHNl
KTsKKwkJaWYgKHJldCkgeworCQkJcHJfZXJyKCJbJXNdIEZhaWxlZCB0byBnZXQgYWN0aXZpdHkg
bW9uaXRvciEiLCBfX2Z1bmNfXyk7CisJCQlyZXR1cm4gcmV0OworCQl9CisKKwkJc3dpdGNoIChp
bnB1dFswXSkgeworCQljYXNlIDA6IC8qIEdmeGNsayAqLworCQkJYWN0aXZpdHlfbW9uaXRvci5H
ZnhfRlBTID0gaW5wdXRbMV07CisJCQlhY3Rpdml0eV9tb25pdG9yLkdmeF9NaW5GcmVxU3RlcCA9
IGlucHV0WzJdOworCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfTWluQWN0aXZlRnJlcVR5cGUgPSBp
bnB1dFszXTsKKwkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X01pbkFjdGl2ZUZyZXEgPSBpbnB1dFs0
XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X0Jvb3N0ZXJGcmVxVHlwZSA9IGlucHV0WzVdOwor
CQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfQm9vc3RlckZyZXEgPSBpbnB1dFs2XTsKKwkJCWFjdGl2
aXR5X21vbml0b3IuR2Z4X1BEX0RhdGFfbGltaXRfYyA9IGlucHV0WzddOworCQkJYWN0aXZpdHlf
bW9uaXRvci5HZnhfUERfRGF0YV9lcnJvcl9jb2VmZiA9IGlucHV0WzhdOworCQkJYWN0aXZpdHlf
bW9uaXRvci5HZnhfUERfRGF0YV9lcnJvcl9yYXRlX2NvZWZmID0gaW5wdXRbOV07CisJCQlicmVh
azsKKwkJY2FzZSAxOiAvKiBTb2NjbGsgKi8KKwkJCWFjdGl2aXR5X21vbml0b3IuU29jX0ZQUyA9
IGlucHV0WzFdOworCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfTWluRnJlcVN0ZXAgPSBpbnB1dFsy
XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuU29jX01pbkFjdGl2ZUZyZXFUeXBlID0gaW5wdXRbM107
CisJCQlhY3Rpdml0eV9tb25pdG9yLlNvY19NaW5BY3RpdmVGcmVxID0gaW5wdXRbNF07CisJCQlh
Y3Rpdml0eV9tb25pdG9yLlNvY19Cb29zdGVyRnJlcVR5cGUgPSBpbnB1dFs1XTsKKwkJCWFjdGl2
aXR5X21vbml0b3IuU29jX0Jvb3N0ZXJGcmVxID0gaW5wdXRbNl07CisJCQlhY3Rpdml0eV9tb25p
dG9yLlNvY19QRF9EYXRhX2xpbWl0X2MgPSBpbnB1dFs3XTsKKwkJCWFjdGl2aXR5X21vbml0b3Iu
U29jX1BEX0RhdGFfZXJyb3JfY29lZmYgPSBpbnB1dFs4XTsKKwkJCWFjdGl2aXR5X21vbml0b3Iu
U29jX1BEX0RhdGFfZXJyb3JfcmF0ZV9jb2VmZiA9IGlucHV0WzldOworCQkJYnJlYWs7CisJCWNh
c2UgMjogLyogTWVtbGsgKi8KKwkJCWFjdGl2aXR5X21vbml0b3IuTWVtX0ZQUyA9IGlucHV0WzFd
OworCQkJYWN0aXZpdHlfbW9uaXRvci5NZW1fTWluRnJlcVN0ZXAgPSBpbnB1dFsyXTsKKwkJCWFj
dGl2aXR5X21vbml0b3IuTWVtX01pbkFjdGl2ZUZyZXFUeXBlID0gaW5wdXRbM107CisJCQlhY3Rp
dml0eV9tb25pdG9yLk1lbV9NaW5BY3RpdmVGcmVxID0gaW5wdXRbNF07CisJCQlhY3Rpdml0eV9t
b25pdG9yLk1lbV9Cb29zdGVyRnJlcVR5cGUgPSBpbnB1dFs1XTsKKwkJCWFjdGl2aXR5X21vbml0
b3IuTWVtX0Jvb3N0ZXJGcmVxID0gaW5wdXRbNl07CisJCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9Q
RF9EYXRhX2xpbWl0X2MgPSBpbnB1dFs3XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuTWVtX1BEX0Rh
dGFfZXJyb3JfY29lZmYgPSBpbnB1dFs4XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuTWVtX1BEX0Rh
dGFfZXJyb3JfcmF0ZV9jb2VmZiA9IGlucHV0WzldOworCQkJYnJlYWs7CisJCX0KKworCQlyZXQg
PSBzbXVfdXBkYXRlX3RhYmxlKHNtdSwKKwkJCQkgICAgICAgU01VX1RBQkxFX0FDVElWSVRZX01P
TklUT1JfQ09FRkYgfCBXT1JLTE9BRF9QUExJQl9DVVNUT01fQklUIDw8IDE2LAorCQkJCSAgICAg
ICAodm9pZCAqKSgmYWN0aXZpdHlfbW9uaXRvciksIHRydWUpOworCQlpZiAocmV0KSB7CisJCQlw
cl9lcnIoIlslc10gRmFpbGVkIHRvIHNldCBhY3Rpdml0eSBtb25pdG9yISIsIF9fZnVuY19fKTsK
KwkJCXJldHVybiByZXQ7CisJCX0KKwl9CisKKwkvKiBjb252IFBQX1NNQ19QT1dFUl9QUk9GSUxF
KiB0byBXT1JLTE9BRF9QUExJQl8qX0JJVCAqLworCXdvcmtsb2FkX3R5cGUgPSBzbXVfd29ya2xv
YWRfZ2V0X3R5cGUoc211LCBzbXUtPnBvd2VyX3Byb2ZpbGVfbW9kZSk7CisJc211X3NlbmRfc21j
X21zZ193aXRoX3BhcmFtKHNtdSwgU01VX01TR19TZXRXb3JrbG9hZE1hc2ssCisJCQkJICAgIDEg
PDwgd29ya2xvYWRfdHlwZSk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IG5hdmkx
MF9nZXRfcHJvZmlsaW5nX2Nsa19tYXNrKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAorCQkJCQkg
ZW51bSBhbWRfZHBtX2ZvcmNlZF9sZXZlbCBsZXZlbCwKKwkJCQkJIHVpbnQzMl90ICpzY2xrX21h
c2ssCisJCQkJCSB1aW50MzJfdCAqbWNsa19tYXNrLAorCQkJCQkgdWludDMyX3QgKnNvY19tYXNr
KQoreworCWludCByZXQgPSAwOworCXVpbnQzMl90IGxldmVsX2NvdW50ID0gMDsKKworCWlmIChs
ZXZlbCA9PSBBTURfRFBNX0ZPUkNFRF9MRVZFTF9QUk9GSUxFX01JTl9TQ0xLKSB7CisJCWlmIChz
Y2xrX21hc2spCisJCQkqc2Nsa19tYXNrID0gMDsKKwl9IGVsc2UgaWYgKGxldmVsID09IEFNRF9E
UE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVfTUlOX01DTEspIHsKKwkJaWYgKG1jbGtfbWFzaykKKwkJ
CSptY2xrX21hc2sgPSAwOworCX0gZWxzZSBpZiAobGV2ZWwgPT0gQU1EX0RQTV9GT1JDRURfTEVW
RUxfUFJPRklMRV9QRUFLKSB7CisJCWlmKHNjbGtfbWFzaykgeworCQkJcmV0ID0gc211X2dldF9k
cG1fbGV2ZWxfY291bnQoc211LCBTTVVfU0NMSywgJmxldmVsX2NvdW50KTsKKwkJCWlmIChyZXQp
CisJCQkJcmV0dXJuIHJldDsKKwkJCSpzY2xrX21hc2sgPSBsZXZlbF9jb3VudCAtIDE7CisJCX0K
KworCQlpZihtY2xrX21hc2spIHsKKwkJCXJldCA9IHNtdV9nZXRfZHBtX2xldmVsX2NvdW50KHNt
dSwgU01VX01DTEssICZsZXZlbF9jb3VudCk7CisJCQlpZiAocmV0KQorCQkJCXJldHVybiByZXQ7
CisJCQkqc2Nsa19tYXNrID0gbGV2ZWxfY291bnQgLSAxOworCQl9CisKKwkJaWYoc29jX21hc2sp
IHsKKwkJCXJldCA9IHNtdV9nZXRfZHBtX2xldmVsX2NvdW50KHNtdSwgU01VX1NPQ0NMSywgJmxl
dmVsX2NvdW50KTsKKwkJCWlmIChyZXQpCisJCQkJcmV0dXJuIHJldDsKKwkJCSpzY2xrX21hc2sg
PSBsZXZlbF9jb3VudCAtIDE7CisJCX0KKwl9CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMg
aW50IG5hdmkxMF9ub3RpZnlfc21jX2Rpc3BhbHlfY29uZmlnKHN0cnVjdCBzbXVfY29udGV4dCAq
c211KQoreworCXN0cnVjdCBzbXVfY2xvY2tzIG1pbl9jbG9ja3MgPSB7MH07CisJc3RydWN0IHBw
X2Rpc3BsYXlfY2xvY2tfcmVxdWVzdCBjbG9ja19yZXE7CisJaW50IHJldCA9IDA7CisKKwltaW5f
Y2xvY2tzLmRjZWZfY2xvY2sgPSBzbXUtPmRpc3BsYXlfY29uZmlnLT5taW5fZGNlZl9zZXRfY2xr
OworCW1pbl9jbG9ja3MuZGNlZl9jbG9ja19pbl9zciA9IHNtdS0+ZGlzcGxheV9jb25maWctPm1p
bl9kY2VmX2RlZXBfc2xlZXBfc2V0X2NsazsKKwltaW5fY2xvY2tzLm1lbW9yeV9jbG9jayA9IHNt
dS0+ZGlzcGxheV9jb25maWctPm1pbl9tZW1fc2V0X2Nsb2NrOworCisJaWYgKHNtdV9mZWF0dXJl
X2lzX3N1cHBvcnRlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9EQ0VGQ0xLX0JJVCkpIHsKKwkJY2xv
Y2tfcmVxLmNsb2NrX3R5cGUgPSBhbWRfcHBfZGNlZl9jbG9jazsKKwkJY2xvY2tfcmVxLmNsb2Nr
X2ZyZXFfaW5fa2h6ID0gbWluX2Nsb2Nrcy5kY2VmX2Nsb2NrICogMTA7CisJCWlmICghc211X2Rp
c3BsYXlfY2xvY2tfdm9sdGFnZV9yZXF1ZXN0KHNtdSwgJmNsb2NrX3JlcSkpIHsKKwkJCWlmIChz
bXVfZmVhdHVyZV9pc19zdXBwb3J0ZWQoc211LCBTTVVfRkVBVFVSRV9EU19EQ0VGQ0xLX0JJVCkp
IHsKKwkJCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LAorCQkJCQkJCQkg
IFNNVV9NU0dfU2V0TWluRGVlcFNsZWVwRGNlZmNsaywKKwkJCQkJCQkJICBtaW5fY2xvY2tzLmRj
ZWZfY2xvY2tfaW5fc3IvMTAwKTsKKwkJCQlpZiAocmV0KSB7CisJCQkJCXByX2VycigiQXR0ZW1w
dCB0byBzZXQgZGl2aWRlciBmb3IgRENFRkNMSyBGYWlsZWQhIik7CisJCQkJCXJldHVybiByZXQ7
CisJCQkJfQorCQkJfQorCQl9IGVsc2UgeworCQkJcHJfaW5mbygiQXR0ZW1wdCB0byBzZXQgSGFy
ZCBNaW4gZm9yIERDRUZDTEsgRmFpbGVkISIpOworCQl9CisJfQorCisJaWYgKHNtdV9mZWF0dXJl
X2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVUNMS19CSVQpKSB7CisJCXJldCA9IHNt
dV9zZXRfaGFyZF9mcmVxX3JhbmdlKHNtdSwgU01VX1VDTEssIG1pbl9jbG9ja3MubWVtb3J5X2Ns
b2NrLzEwMCwgMCk7CisJCWlmIChyZXQpIHsKKwkJCXByX2VycigiWyVzXSBTZXQgaGFyZCBtaW4g
dWNsayBmYWlsZWQhIiwgX19mdW5jX18pOworCQkJcmV0dXJuIHJldDsKKwkJfQorCX0KKworCXJl
dHVybiAwOworfQorCitzdGF0aWMgaW50IG5hdmkxMF9zZXRfd2F0ZXJtYXJrc190YWJsZShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSwKKwkJCQkgICAgICAgdm9pZCAqd2F0ZXJtYXJrcywgc3RydWN0
CisJCQkJICAgICAgIGRtX3BwX3dtX3NldHNfd2l0aF9jbG9ja19yYW5nZXNfc29jMTUKKwkJCQkg
ICAgICAgKmNsb2NrX3JhbmdlcykKK3sKKwlpbnQgaTsKKwlXYXRlcm1hcmtzX3QgKnRhYmxlID0g
d2F0ZXJtYXJrczsKKworCWlmICghdGFibGUgfHwgIWNsb2NrX3JhbmdlcykKKwkJcmV0dXJuIC1F
SU5WQUw7CisKKwlpZiAoY2xvY2tfcmFuZ2VzLT5udW1fd21fZG1pZl9zZXRzID4gNCB8fAorCSAg
ICBjbG9ja19yYW5nZXMtPm51bV93bV9tY2lmX3NldHMgPiA0KQorICAgICAgICAgICAgICAgIHJl
dHVybiAtRUlOVkFMOworCisgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjbG9ja19yYW5nZXMtPm51
bV93bV9kbWlmX3NldHM7IGkrKykgeworCQl0YWJsZS0+V2F0ZXJtYXJrUm93WzFdW2ldLk1pbkNs
b2NrID0KKwkJCWNwdV90b19sZTE2KCh1aW50MTZfdCkKKwkJCShjbG9ja19yYW5nZXMtPndtX2Rt
aWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9taW5fZGNmY2xrX2Nsa19pbl9raHogLworCQkJMTAwMCkp
OworCQl0YWJsZS0+V2F0ZXJtYXJrUm93WzFdW2ldLk1heENsb2NrID0KKwkJCWNwdV90b19sZTE2
KCh1aW50MTZfdCkKKwkJCShjbG9ja19yYW5nZXMtPndtX2RtaWZfY2xvY2tzX3Jhbmdlc1tpXS53
bV9tYXhfZGNmY2xrX2Nsa19pbl9raHogLworCQkJMTAwMCkpOworCQl0YWJsZS0+V2F0ZXJtYXJr
Um93WzFdW2ldLk1pblVjbGsgPQorCQkJY3B1X3RvX2xlMTYoKHVpbnQxNl90KQorCQkJKGNsb2Nr
X3Jhbmdlcy0+d21fZG1pZl9jbG9ja3NfcmFuZ2VzW2ldLndtX21pbl9tZW1fY2xrX2luX2toeiAv
CisJCQkxMDAwKSk7CisJCXRhYmxlLT5XYXRlcm1hcmtSb3dbMV1baV0uTWF4VWNsayA9CisJCQlj
cHVfdG9fbGUxNigodWludDE2X3QpCisJCQkoY2xvY2tfcmFuZ2VzLT53bV9kbWlmX2Nsb2Nrc19y
YW5nZXNbaV0ud21fbWF4X21lbV9jbGtfaW5fa2h6IC8KKwkJCTEwMDApKTsKKwkJdGFibGUtPldh
dGVybWFya1Jvd1sxXVtpXS5XbVNldHRpbmcgPSAodWludDhfdCkKKwkJCQljbG9ja19yYW5nZXMt
PndtX2RtaWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9zZXRfaWQ7CisgICAgICAgIH0KKworCWZvciAo
aSA9IDA7IGkgPCBjbG9ja19yYW5nZXMtPm51bV93bV9tY2lmX3NldHM7IGkrKykgeworCQl0YWJs
ZS0+V2F0ZXJtYXJrUm93WzBdW2ldLk1pbkNsb2NrID0KKwkJCWNwdV90b19sZTE2KCh1aW50MTZf
dCkKKwkJCShjbG9ja19yYW5nZXMtPndtX21jaWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9taW5fc29j
Y2xrX2Nsa19pbl9raHogLworCQkJMTAwMCkpOworCQl0YWJsZS0+V2F0ZXJtYXJrUm93WzBdW2ld
Lk1heENsb2NrID0KKwkJCWNwdV90b19sZTE2KCh1aW50MTZfdCkKKwkJCShjbG9ja19yYW5nZXMt
PndtX21jaWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9tYXhfc29jY2xrX2Nsa19pbl9raHogLworCQkJ
MTAwMCkpOworCQl0YWJsZS0+V2F0ZXJtYXJrUm93WzBdW2ldLk1pblVjbGsgPQorCQkJY3B1X3Rv
X2xlMTYoKHVpbnQxNl90KQorCQkJKGNsb2NrX3Jhbmdlcy0+d21fbWNpZl9jbG9ja3NfcmFuZ2Vz
W2ldLndtX21pbl9tZW1fY2xrX2luX2toeiAvCisJCQkxMDAwKSk7CisJCXRhYmxlLT5XYXRlcm1h
cmtSb3dbMF1baV0uTWF4VWNsayA9CisJCQljcHVfdG9fbGUxNigodWludDE2X3QpCisJCQkoY2xv
Y2tfcmFuZ2VzLT53bV9tY2lmX2Nsb2Nrc19yYW5nZXNbaV0ud21fbWF4X21lbV9jbGtfaW5fa2h6
IC8KKwkJCTEwMDApKTsKKwkJdGFibGUtPldhdGVybWFya1Jvd1swXVtpXS5XbVNldHRpbmcgPSAo
dWludDhfdCkKKwkJCQljbG9ja19yYW5nZXMtPndtX21jaWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9z
ZXRfaWQ7CisgICAgICAgIH0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IG5hdmkxMF9y
ZWFkX3NlbnNvcihzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKKwkJCQkgZW51bSBhbWRfcHBfc2Vu
c29ycyBzZW5zb3IsCisJCQkJIHZvaWQgKmRhdGEsIHVpbnQzMl90ICpzaXplKQoreworCWludCBy
ZXQgPSAwOworCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFibGVfY29udGV4dCA9ICZzbXUt
PnNtdV90YWJsZTsKKwlQUFRhYmxlX3QgKnBwdGFibGUgPSB0YWJsZV9jb250ZXh0LT5kcml2ZXJf
cHB0YWJsZTsKKworCXN3aXRjaCAoc2Vuc29yKSB7CisJY2FzZSBBTURHUFVfUFBfU0VOU09SX01B
WF9GQU5fUlBNOgorCQkqKHVpbnQzMl90ICopZGF0YSA9IHBwdGFibGUtPkZhbk1heGltdW1ScG07
CisJCSpzaXplID0gNDsKKwkJYnJlYWs7CisJY2FzZSBBTURHUFVfUFBfU0VOU09SX0dQVV9MT0FE
OgorCQlyZXQgPSBuYXZpMTBfZ2V0X2N1cnJlbnRfYWN0aXZpdHlfcGVyY2VudChzbXUsICh1aW50
MzJfdCAqKWRhdGEpOworCQkqc2l6ZSA9IDQ7CisJCWJyZWFrOworCWNhc2UgQU1ER1BVX1BQX1NF
TlNPUl9HUFVfUE9XRVI6CisJCXJldCA9IG5hdmkxMF9nZXRfZ3B1X3Bvd2VyKHNtdSwgKHVpbnQz
Ml90ICopZGF0YSk7CisJCSpzaXplID0gNDsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJcmV0dXJu
IC1FSU5WQUw7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBuYXZpMTBfZ2V0
X3VjbGtfZHBtX3N0YXRlcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDMyX3QgKmNsb2Nr
c19pbl9raHosIHVpbnQzMl90ICpudW1fc3RhdGVzKQoreworCXVpbnQzMl90IG51bV9kaXNjcmV0
ZV9sZXZlbHMgPSAwOworCXVpbnQxNl90ICpkcG1fbGV2ZWxzID0gTlVMTDsKKwl1aW50MTZfdCBp
ID0gMDsKKwlzdHJ1Y3Qgc211X3RhYmxlX2NvbnRleHQgKnRhYmxlX2NvbnRleHQgPSAmc211LT5z
bXVfdGFibGU7CisJUFBUYWJsZV90ICpkcml2ZXJfcHB0ID0gTlVMTDsKKworCWlmICghY2xvY2tz
X2luX2toeiB8fCAhIG51bV9zdGF0ZXMgfHwgIXRhYmxlX2NvbnRleHQtPmRyaXZlcl9wcHRhYmxl
KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWRyaXZlcl9wcHQgPSB0YWJsZV9jb250ZXh0LT5kcml2
ZXJfcHB0YWJsZTsKKwludW1fZGlzY3JldGVfbGV2ZWxzID0gZHJpdmVyX3BwdC0+RHBtRGVzY3Jp
cHRvcltQUENMS19VQ0xLXS5OdW1EaXNjcmV0ZUxldmVsczsKKwlkcG1fbGV2ZWxzID0gZHJpdmVy
X3BwdC0+RnJlcVRhYmxlVWNsazsKKworCWlmIChudW1fZGlzY3JldGVfbGV2ZWxzID09IDAgfHwg
ZHBtX2xldmVscyA9PSBOVUxMKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCSpudW1fc3RhdGVzID0g
bnVtX2Rpc2NyZXRlX2xldmVsczsKKwlmb3IgKGkgPSAwOyBpIDwgbnVtX2Rpc2NyZXRlX2xldmVs
czsgaSsrKSB7CisJCS8qIGNvbnZlcnQgdG8ga2h6ICovCisJCSpjbG9ja3NfaW5fa2h6ID0gKCpk
cG1fbGV2ZWxzKSAqIDEwMDA7CisJCWNsb2Nrc19pbl9raHorKzsKKwkJZHBtX2xldmVscysrOwor
CX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IG5hdmkxMF9nZXRfcHBmZWF0dXJlX3N0
YXR1cyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKKwkJCQkgICAgICAgY2hhciAqYnVmKQorewor
CXN0YXRpYyBjb25zdCBjaGFyICpwcGZlYXR1cmVfbmFtZVtdID0geworCQkJCSJEUE1fUFJFRkVU
Q0hFUiIsCisJCQkJIkRQTV9HRlhDTEsiLAorCQkJCSJEUE1fR0ZYX1BBQ0UiLAorCQkJCSJEUE1f
VUNMSyIsCisJCQkJIkRQTV9TT0NDTEsiLAorCQkJCSJEUE1fTVAwQ0xLIiwKKwkJCQkiRFBNX0xJ
TksiLAorCQkJCSJEUE1fRENFRkNMSyIsCisJCQkJIk1FTV9WRERDSV9TQ0FMSU5HIiwKKwkJCQki
TUVNX01WRERfU0NBTElORyIsCisJCQkJIkRTX0dGWENMSyIsCisJCQkJIkRTX1NPQ0NMSyIsCisJ
CQkJIkRTX0xDTEsiLAorCQkJCSJEU19EQ0VGQ0xLIiwKKwkJCQkiRFNfVUNMSyIsCisJCQkJIkdG
WF9VTFYiLAorCQkJCSJGV19EU1RBVEUiLAorCQkJCSJHRlhPRkYiLAorCQkJCSJCQUNPIiwKKwkJ
CQkiVkNOX1BHIiwKKwkJCQkiSlBFR19QRyIsCisJCQkJIlVTQl9QRyIsCisJCQkJIlJTTVVfU01O
X0NHIiwKKwkJCQkiUFBUIiwKKwkJCQkiVERDIiwKKwkJCQkiR0ZYX0VEQyIsCisJCQkJIkFQQ0Nf
UExVUyIsCisJCQkJIkdUSFIiLAorCQkJCSJBQ0RDIiwKKwkJCQkiVlIwSE9UIiwKKwkJCQkiVlIx
SE9UIiwKKwkJCQkiRldfQ1RGIiwKKwkJCQkiRkFOX0NPTlRST0wiLAorCQkJCSJUSEVSTUFMIiwK
KwkJCQkiR0ZYX0RDUyIsCisJCQkJIlJNIiwKKwkJCQkiTEVEX0RJU1BMQVkiLAorCQkJCSJHRlhf
U1MiLAorCQkJCSJPVVRfT0ZfQkFORF9NT05JVE9SIiwKKwkJCQkiVEVNUF9ERVBFTkRFTlRfVk1J
TiIsCisJCQkJIk1NSFVCX1BHIiwKKwkJCQkiQVRIVUJfUEcifTsKKwlzdGF0aWMgY29uc3QgY2hh
ciAqb3V0cHV0X3RpdGxlW10gPSB7CisJCQkJIkZFQVRVUkVTIiwKKwkJCQkiQklUTUFTSyIsCisJ
CQkJIkVOQUJMRU1FTlQifTsKKwl1aW50NjRfdCBmZWF0dXJlc19lbmFibGVkOworCXVpbnQzMl90
IGZlYXR1cmVfbWFza1syXTsKKwlpbnQgaTsKKwlpbnQgcmV0ID0gMDsKKwlpbnQgc2l6ZSA9IDA7
CisKKwlyZXQgPSBzbXVfZmVhdHVyZV9nZXRfZW5hYmxlZF9tYXNrKHNtdSwgZmVhdHVyZV9tYXNr
LCAyKTsKKwlQUF9BU1NFUlRfV0lUSF9DT0RFKCFyZXQsCisJCQkiW0dldFBQZmVhdHVyZVN0YXR1
c10gRmFpbGVkIHRvIGdldCBlbmFibGVkIHNtYyBmZWF0dXJlcyEiLAorCQkJcmV0dXJuIHJldCk7
CisJZmVhdHVyZXNfZW5hYmxlZCA9ICh1aW50NjRfdClmZWF0dXJlX21hc2tbMF0gfAorCQkJICAg
KHVpbnQ2NF90KWZlYXR1cmVfbWFza1sxXSA8PCAzMjsKKworCXNpemUgKz0gc3ByaW50ZihidWYg
KyBzaXplLCAiQ3VycmVudCBwcGZlYXR1cmVzOiAweCUwMTZsbHhcbiIsIGZlYXR1cmVzX2VuYWJs
ZWQpOworCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiJS0xOXMgJS0yMnMgJXNcbiIsCisJ
CQkJb3V0cHV0X3RpdGxlWzBdLAorCQkJCW91dHB1dF90aXRsZVsxXSwKKwkJCQlvdXRwdXRfdGl0
bGVbMl0pOworCWZvciAoaSA9IDA7IGkgPCAoc2l6ZW9mKHBwZmVhdHVyZV9uYW1lKSAvIHNpemVv
ZihwcGZlYXR1cmVfbmFtZVswXSkpOyBpKyspIHsKKwkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNp
emUsICIlLTE5cyAweCUwMTZsbHggJTZzXG4iLAorCQkJCQlwcGZlYXR1cmVfbmFtZVtpXSwKKwkJ
CQkJMVVMTCA8PCBpLAorCQkJCQkoZmVhdHVyZXNfZW5hYmxlZCAmICgxVUxMIDw8IGkpKSA/ICJZ
IiA6ICJOIik7CisJfQorCisJcmV0dXJuIHNpemU7Cit9CisKK3N0YXRpYyBpbnQgbmF2aTEwX2Vu
YWJsZV9zbWNfZmVhdHVyZXMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCisJCQkJICAgICAgYm9v
bCBlbmFibGVkLAorCQkJCSAgICAgIHVpbnQ2NF90IGZlYXR1cmVfbWFza3MpCit7CisJc3RydWN0
IHNtdV9mZWF0dXJlICpmZWF0dXJlID0gJnNtdS0+c211X2ZlYXR1cmU7CisJdWludDMyX3QgZmVh
dHVyZV9sb3csIGZlYXR1cmVfaGlnaDsKKwl1aW50MzJfdCBmZWF0dXJlX21hc2tbMl07CisJaW50
IHJldCA9IDA7CisKKwlmZWF0dXJlX2xvdyA9ICh1aW50MzJfdCkoZmVhdHVyZV9tYXNrcyAmIDB4
RkZGRkZGRkYpOworCWZlYXR1cmVfaGlnaCA9ICh1aW50MzJfdCkoKGZlYXR1cmVfbWFza3MgJiAw
eEZGRkZGRkZGMDAwMDAwMDBVTEwpID4+IDMyKTsKKworCWlmIChlbmFibGVkKSB7CisJCXJldCA9
IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfRW5hYmxlU211RmVhdHVy
ZXNMb3csCisJCQkJCQkgIGZlYXR1cmVfbG93KTsKKwkJaWYgKHJldCkKKwkJCXJldHVybiByZXQ7
CisJCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfRW5hYmxl
U211RmVhdHVyZXNIaWdoLAorCQkJCQkJICBmZWF0dXJlX2hpZ2gpOworCQlpZiAocmV0KQorCQkJ
cmV0dXJuIHJldDsKKwl9IGVsc2UgeworCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFy
YW0oc211LCBTTVVfTVNHX0Rpc2FibGVTbXVGZWF0dXJlc0xvdywKKwkJCQkJCSAgZmVhdHVyZV9s
b3cpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKwkJcmV0ID0gc211X3NlbmRfc21jX21z
Z193aXRoX3BhcmFtKHNtdSwgU01VX01TR19EaXNhYmxlU211RmVhdHVyZXNIaWdoLAorCQkJCQkJ
ICBmZWF0dXJlX2hpZ2gpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQg
PSBzbXVfZmVhdHVyZV9nZXRfZW5hYmxlZF9tYXNrKHNtdSwgZmVhdHVyZV9tYXNrLCAyKTsKKwlp
ZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJbXV0ZXhfbG9jaygmZmVhdHVyZS0+bXV0ZXgpOwor
CWJpdG1hcF9jb3B5KGZlYXR1cmUtPmVuYWJsZWQsICh1bnNpZ25lZCBsb25nICopJmZlYXR1cmVf
bWFzaywKKwkJICAgIGZlYXR1cmUtPmZlYXR1cmVfbnVtKTsKKwltdXRleF91bmxvY2soJmZlYXR1
cmUtPm11dGV4KTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IG5hdmkxMF9zZXRfcHBm
ZWF0dXJlX3N0YXR1cyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKKwkJCQkgICAgICAgdWludDY0
X3QgbmV3X3BwZmVhdHVyZV9tYXNrcykKK3sKKwl1aW50NjRfdCBmZWF0dXJlc19lbmFibGVkOwor
CXVpbnQzMl90IGZlYXR1cmVfbWFza1syXTsKKwl1aW50NjRfdCBmZWF0dXJlc190b19lbmFibGU7
CisJdWludDY0X3QgZmVhdHVyZXNfdG9fZGlzYWJsZTsKKwlpbnQgcmV0ID0gMDsKKworCXJldCA9
IHNtdV9mZWF0dXJlX2dldF9lbmFibGVkX21hc2soc211LCBmZWF0dXJlX21hc2ssIDIpOworCVBQ
X0FTU0VSVF9XSVRIX0NPREUoIXJldCwKKwkJCSJbU2V0UFBmZWF0dXJlU3RhdHVzXSBGYWlsZWQg
dG8gZ2V0IGVuYWJsZWQgc21jIGZlYXR1cmVzISIsCisJCQlyZXR1cm4gcmV0KTsKKwlmZWF0dXJl
c19lbmFibGVkID0gKHVpbnQ2NF90KWZlYXR1cmVfbWFza1swXSB8CisJCQkgICAodWludDY0X3Qp
ZmVhdHVyZV9tYXNrWzFdIDw8IDMyOworCisJZmVhdHVyZXNfdG9fZGlzYWJsZSA9CisJCWZlYXR1
cmVzX2VuYWJsZWQgJiB+bmV3X3BwZmVhdHVyZV9tYXNrczsKKwlmZWF0dXJlc190b19lbmFibGUg
PQorCQl+ZmVhdHVyZXNfZW5hYmxlZCAmIG5ld19wcGZlYXR1cmVfbWFza3M7CisKKwlwcl9kZWJ1
ZygiZmVhdHVyZXNfdG9fZGlzYWJsZSAweCVsbHhcbiIsIGZlYXR1cmVzX3RvX2Rpc2FibGUpOwor
CXByX2RlYnVnKCJmZWF0dXJlc190b19lbmFibGUgMHglbGx4XG4iLCBmZWF0dXJlc190b19lbmFi
bGUpOworCisJaWYgKGZlYXR1cmVzX3RvX2Rpc2FibGUpIHsKKwkJcmV0ID0gbmF2aTEwX2VuYWJs
ZV9zbWNfZmVhdHVyZXMoc211LCBmYWxzZSwgZmVhdHVyZXNfdG9fZGlzYWJsZSk7CisJCVBQX0FT
U0VSVF9XSVRIX0NPREUoIXJldCwKKwkJCQkiW1NldFBQZmVhdHVyZVN0YXR1c10gRmFpbGVkIHRv
IGRpc2FibGUgc21jIGZlYXR1cmVzISIsCisJCQkJcmV0dXJuIHJldCk7CisJfQorCisJaWYgKGZl
YXR1cmVzX3RvX2VuYWJsZSkgeworCQlyZXQgPSBuYXZpMTBfZW5hYmxlX3NtY19mZWF0dXJlcyhz
bXUsIHRydWUsIGZlYXR1cmVzX3RvX2VuYWJsZSk7CisJCVBQX0FTU0VSVF9XSVRIX0NPREUoIXJl
dCwKKwkJCQkiW1NldFBQZmVhdHVyZVN0YXR1c10gRmFpbGVkIHRvIGVuYWJsZSBzbWMgZmVhdHVy
ZXMhIiwKKwkJCQlyZXR1cm4gcmV0KTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNv
bnN0IHN0cnVjdCBwcHRhYmxlX2Z1bmNzIG5hdmkxMF9wcHRfZnVuY3MgPSB7CisJLnRhYmxlc19p
bml0ID0gbmF2aTEwX3RhYmxlc19pbml0LAorCS5hbGxvY19kcG1fY29udGV4dCA9IG5hdmkxMF9h
bGxvY2F0ZV9kcG1fY29udGV4dCwKKwkuc3RvcmVfcG93ZXJwbGF5X3RhYmxlID0gbmF2aTEwX3N0
b3JlX3Bvd2VycGxheV90YWJsZSwKKwkuY2hlY2tfcG93ZXJwbGF5X3RhYmxlID0gbmF2aTEwX2No
ZWNrX3Bvd2VycGxheV90YWJsZSwKKwkuYXBwZW5kX3Bvd2VycGxheV90YWJsZSA9IG5hdmkxMF9h
cHBlbmRfcG93ZXJwbGF5X3RhYmxlLAorCS5nZXRfc211X21zZ19pbmRleCA9IG5hdmkxMF9nZXRf
c211X21zZ19pbmRleCwKKwkuZ2V0X3NtdV9jbGtfaW5kZXggPSBuYXZpMTBfZ2V0X3NtdV9jbGtf
aW5kZXgsCisJLmdldF9zbXVfZmVhdHVyZV9pbmRleCA9IG5hdmkxMF9nZXRfc211X2ZlYXR1cmVf
aW5kZXgsCisJLmdldF9zbXVfdGFibGVfaW5kZXggPSBuYXZpMTBfZ2V0X3NtdV90YWJsZV9pbmRl
eCwKKwkuZ2V0X3NtdV9wb3dlcl9pbmRleD0gbmF2aTEwX2dldF9wd3Jfc3JjX2luZGV4LAorCS5n
ZXRfd29ya2xvYWRfdHlwZSA9IG5hdmkxMF9nZXRfd29ya2xvYWRfdHlwZSwKKwkuZ2V0X2FsbG93
ZWRfZmVhdHVyZV9tYXNrID0gbmF2aTEwX2dldF9hbGxvd2VkX2ZlYXR1cmVfbWFzaywKKwkuc2V0
X2RlZmF1bHRfZHBtX3RhYmxlID0gbmF2aTEwX3NldF9kZWZhdWx0X2RwbV90YWJsZSwKKwkuZHBt
X3NldF91dmRfZW5hYmxlID0gbmF2aTEwX2RwbV9zZXRfdXZkX2VuYWJsZSwKKwkuZ2V0X2N1cnJl
bnRfY2xrX2ZyZXFfYnlfdGFibGUgPSBuYXZpMTBfZ2V0X2N1cnJlbnRfY2xrX2ZyZXFfYnlfdGFi
bGUsCisJLnByaW50X2Nsa19sZXZlbHMgPSBuYXZpMTBfcHJpbnRfY2xrX2xldmVscywKKwkuZm9y
Y2VfY2xrX2xldmVscyA9IG5hdmkxMF9mb3JjZV9jbGtfbGV2ZWxzLAorCS5wb3B1bGF0ZV91bWRf
c3RhdGVfY2xrID0gbmF2aTEwX3BvcHVsYXRlX3VtZF9zdGF0ZV9jbGssCisJLmdldF9jbG9ja19i
eV90eXBlX3dpdGhfbGF0ZW5jeSA9IG5hdmkxMF9nZXRfY2xvY2tfYnlfdHlwZV93aXRoX2xhdGVu
Y3ksCisJLnByZV9kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkID0gbmF2aTEwX3ByZV9kaXNwbGF5X2Nv
bmZpZ19jaGFuZ2VkLAorCS5kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkID0gbmF2aTEwX2Rpc3BsYXlf
Y29uZmlnX2NoYW5nZWQsCisJLm5vdGlmeV9zbWNfZGlzcGFseV9jb25maWcgPSBuYXZpMTBfbm90
aWZ5X3NtY19kaXNwYWx5X2NvbmZpZywKKwkuZm9yY2VfZHBtX2xpbWl0X3ZhbHVlID0gbmF2aTEw
X2ZvcmNlX2RwbV9saW1pdF92YWx1ZSwKKwkudW5mb3JjZV9kcG1fbGV2ZWxzID0gbmF2aTEwX3Vu
Zm9yY2VfZHBtX2xldmVscywKKwkuaXNfZHBtX3J1bm5pbmcgPSBuYXZpMTBfaXNfZHBtX3J1bm5p
bmcsCisJLmdldF9mYW5fc3BlZWRfcGVyY2VudCA9IG5hdmkxMF9nZXRfZmFuX3NwZWVkX3BlcmNl
bnQsCisJLmdldF9wb3dlcl9wcm9maWxlX21vZGUgPSBuYXZpMTBfZ2V0X3Bvd2VyX3Byb2ZpbGVf
bW9kZSwKKwkuc2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZSA9IG5hdmkxMF9zZXRfcG93ZXJfcHJvZmls
ZV9tb2RlLAorCS5nZXRfcHJvZmlsaW5nX2Nsa19tYXNrID0gbmF2aTEwX2dldF9wcm9maWxpbmdf
Y2xrX21hc2ssCisJLnNldF93YXRlcm1hcmtzX3RhYmxlID0gbmF2aTEwX3NldF93YXRlcm1hcmtz
X3RhYmxlLAorCS5yZWFkX3NlbnNvciA9IG5hdmkxMF9yZWFkX3NlbnNvciwKKwkuZ2V0X3VjbGtf
ZHBtX3N0YXRlcyA9IG5hdmkxMF9nZXRfdWNsa19kcG1fc3RhdGVzLAorCS5nZXRfcHBmZWF0dXJl
X3N0YXR1cyA9IG5hdmkxMF9nZXRfcHBmZWF0dXJlX3N0YXR1cywKKwkuc2V0X3BwZmVhdHVyZV9z
dGF0dXMgPSBuYXZpMTBfc2V0X3BwZmVhdHVyZV9zdGF0dXMsCit9OworCit2b2lkIG5hdmkxMF9z
ZXRfcHB0X2Z1bmNzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQoreworCXN0cnVjdCBzbXVfdGFi
bGVfY29udGV4dCAqc211X3RhYmxlID0gJnNtdS0+c211X3RhYmxlOworCisJc211LT5wcHRfZnVu
Y3MgPSAmbmF2aTEwX3BwdF9mdW5jczsKKwlzbXUtPnNtY19pZl92ZXJzaW9uID0gU01VMTFfRFJJ
VkVSX0lGX1ZFUlNJT047CisJc211X3RhYmxlLT50YWJsZV9jb3VudCA9IFRBQkxFX0NPVU5UOwor
fQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcHB0YWJsZS9uYXZp
MTBfcHB0LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9wcHRhYmxlL25hdmkxMF9w
cHQuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi45NTcyODhlCi0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcHB0YWJsZS9uYXZpMTBf
cHB0LmgKQEAgLTAsMCArMSwyOCBAQAorLyoKKyAqIENvcHlyaWdodCAyMDE5IEFkdmFuY2VkIE1p
Y3JvIERldmljZXMsIEluYy4KKyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBm
cmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlz
IHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdh
cmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGlu
Y2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBt
b2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29y
IHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdo
b20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhl
IGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNl
IGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwg
Y29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBU
SEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkg
S0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBU
TyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBB
UlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwK
KyAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFO
WSBDTEFJTSwgREFNQUdFUyBPUgorICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFD
VElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsCisgKiBBUklTSU5HIEZST00sIE9V
VCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAq
IE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KKyAqCisgKi8KKyNpZm5kZWYgX19OQVZJ
MTBfUFBUX0hfXworI2RlZmluZSBfX05BVkkxMF9QUFRfSF9fCisKK2V4dGVybiB2b2lkIG5hdmkx
MF9zZXRfcHB0X2Z1bmNzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KTsKKworI2VuZGlmCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9wcHRhYmxlL3ZlZ2EyMF9wcHQu
YyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3BwdGFibGUvdmVnYTIwX3BwdC5jCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjlhNTM1ZjcKLS0tIC9kZXYvbnVsbAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9wcHRhYmxlL3ZlZ2EyMF9wcHQuYwpA
QCAtMCwwICsxLDMzMDIgQEAKKy8qCisgKiBDb3B5cmlnaHQgMjAxOSBBZHZhbmNlZCBNaWNybyBE
ZXZpY2VzLCBJbmMuCisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBv
ZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0
d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiks
CisgKiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRp
bmcgd2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5
LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxs
IGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRo
ZQorICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xs
b3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQg
dGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgorICogYWxsIGNvcGll
cyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCisgKgorICogVEhFIFNP
RlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQs
IEVYUFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhF
IFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNV
TEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBU
SEUgQ09QWVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xB
SU0sIERBTUFHRVMgT1IKKyAqIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04g
T0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAorICogQVJJU0lORyBGUk9NLCBPVVQgT0Yg
T1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SCisgKiBPVEhF
UiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCisgKgorICovCisKKyNpbmNsdWRlICJwcF9kZWJ1
Zy5oIgorI2luY2x1ZGUgPGxpbnV4L2Zpcm13YXJlLmg+CisjaW5jbHVkZSAiYW1kZ3B1LmgiCisj
aW5jbHVkZSAiYW1kZ3B1X3NtdS5oIgorI2luY2x1ZGUgImF0b21maXJtd2FyZS5oIgorI2luY2x1
ZGUgImFtZGdwdV9hdG9tZmlybXdhcmUuaCIKKyNpbmNsdWRlICJzbXVfdjExXzAuaCIKKyNpbmNs
dWRlICJzbXUxMV9kcml2ZXJfaWYuaCIKKyNpbmNsdWRlICJzb2MxNV9jb21tb24uaCIKKyNpbmNs
dWRlICJhdG9tLmgiCisjaW5jbHVkZSAicG93ZXJfc3RhdGUuaCIKKyNpbmNsdWRlICJ2ZWdhMjBf
cHB0LmgiCisjaW5jbHVkZSAidmVnYTIwX3BwdGFibGUuaCIKKyNpbmNsdWRlICJ2ZWdhMjBfcHBz
bWMuaCIKKyNpbmNsdWRlICJuYmlvL25iaW9fN180X3NoX21hc2suaCIKKyNpbmNsdWRlICJhc2lj
X3JlZy90aG0vdGhtXzExXzBfMl9vZmZzZXQuaCIKKyNpbmNsdWRlICJhc2ljX3JlZy90aG0vdGht
XzExXzBfMl9zaF9tYXNrLmgiCisKKyNkZWZpbmUgc21uUENJRV9MQ19TUEVFRF9DTlRMCQkJMHgx
MTE0MDI5MAorI2RlZmluZSBzbW5QQ0lFX0xDX0xJTktfV0lEVEhfQ05UTAkJMHgxMTE0MDI4OAor
CisjZGVmaW5lIENURl9PRkZTRVRfRURHRQkJCTUKKyNkZWZpbmUgQ1RGX09GRlNFVF9IT1RTUE9U
CQk1CisjZGVmaW5lIENURl9PRkZTRVRfSEJNCQkJNQorCisjZGVmaW5lIE1TR19NQVAobXNnKSBc
CisJW1NNVV9NU0dfIyNtc2ddID0gUFBTTUNfTVNHXyMjbXNnCisKKyNkZWZpbmUgU01DX0RQTV9G
RUFUVVJFIChGRUFUVVJFX0RQTV9QUkVGRVRDSEVSX01BU0sgfCBcCisJCQkgRkVBVFVSRV9EUE1f
R0ZYQ0xLX01BU0sgfCBcCisJCQkgRkVBVFVSRV9EUE1fVUNMS19NQVNLIHwgXAorCQkJIEZFQVRV
UkVfRFBNX1NPQ0NMS19NQVNLIHwgXAorCQkJIEZFQVRVUkVfRFBNX1VWRF9NQVNLIHwgXAorCQkJ
IEZFQVRVUkVfRFBNX1ZDRV9NQVNLIHwgXAorCQkJIEZFQVRVUkVfRFBNX01QMENMS19NQVNLIHwg
XAorCQkJIEZFQVRVUkVfRFBNX0xJTktfTUFTSyB8IFwKKwkJCSBGRUFUVVJFX0RQTV9EQ0VGQ0xL
X01BU0spCisKK3N0YXRpYyBpbnQgdmVnYTIwX21lc3NhZ2VfbWFwW1NNVV9NU0dfTUFYX0NPVU5U
XSA9IHsKKwlNU0dfTUFQKFRlc3RNZXNzYWdlKSwKKwlNU0dfTUFQKEdldFNtdVZlcnNpb24pLAor
CU1TR19NQVAoR2V0RHJpdmVySWZWZXJzaW9uKSwKKwlNU0dfTUFQKFNldEFsbG93ZWRGZWF0dXJl
c01hc2tMb3cpLAorCU1TR19NQVAoU2V0QWxsb3dlZEZlYXR1cmVzTWFza0hpZ2gpLAorCU1TR19N
QVAoRW5hYmxlQWxsU211RmVhdHVyZXMpLAorCU1TR19NQVAoRGlzYWJsZUFsbFNtdUZlYXR1cmVz
KSwKKwlNU0dfTUFQKEVuYWJsZVNtdUZlYXR1cmVzTG93KSwKKwlNU0dfTUFQKEVuYWJsZVNtdUZl
YXR1cmVzSGlnaCksCisJTVNHX01BUChEaXNhYmxlU211RmVhdHVyZXNMb3cpLAorCU1TR19NQVAo
RGlzYWJsZVNtdUZlYXR1cmVzSGlnaCksCisJTVNHX01BUChHZXRFbmFibGVkU211RmVhdHVyZXNM
b3cpLAorCU1TR19NQVAoR2V0RW5hYmxlZFNtdUZlYXR1cmVzSGlnaCksCisJTVNHX01BUChTZXRX
b3JrbG9hZE1hc2spLAorCU1TR19NQVAoU2V0UHB0TGltaXQpLAorCU1TR19NQVAoU2V0RHJpdmVy
RHJhbUFkZHJIaWdoKSwKKwlNU0dfTUFQKFNldERyaXZlckRyYW1BZGRyTG93KSwKKwlNU0dfTUFQ
KFNldFRvb2xzRHJhbUFkZHJIaWdoKSwKKwlNU0dfTUFQKFNldFRvb2xzRHJhbUFkZHJMb3cpLAor
CU1TR19NQVAoVHJhbnNmZXJUYWJsZVNtdTJEcmFtKSwKKwlNU0dfTUFQKFRyYW5zZmVyVGFibGVE
cmFtMlNtdSksCisJTVNHX01BUChVc2VEZWZhdWx0UFBUYWJsZSksCisJTVNHX01BUChVc2VCYWNr
dXBQUFRhYmxlKSwKKwlNU0dfTUFQKFJ1bkJ0YyksCisJTVNHX01BUChSZXF1ZXN0STJDQnVzKSwK
KwlNU0dfTUFQKFJlbGVhc2VJMkNCdXMpLAorCU1TR19NQVAoU2V0Rmxvb3JTb2NWb2x0YWdlKSwK
KwlNU0dfTUFQKFNvZnRSZXNldCksCisJTVNHX01BUChTdGFydEJhY29Nb25pdG9yKSwKKwlNU0df
TUFQKENhbmNlbEJhY29Nb25pdG9yKSwKKwlNU0dfTUFQKEVudGVyQmFjbyksCisJTVNHX01BUChT
ZXRTb2Z0TWluQnlGcmVxKSwKKwlNU0dfTUFQKFNldFNvZnRNYXhCeUZyZXEpLAorCU1TR19NQVAo
U2V0SGFyZE1pbkJ5RnJlcSksCisJTVNHX01BUChTZXRIYXJkTWF4QnlGcmVxKSwKKwlNU0dfTUFQ
KEdldE1pbkRwbUZyZXEpLAorCU1TR19NQVAoR2V0TWF4RHBtRnJlcSksCisJTVNHX01BUChHZXRE
cG1GcmVxQnlJbmRleCksCisJTVNHX01BUChHZXREcG1DbG9ja0ZyZXEpLAorCU1TR19NQVAoR2V0
U3NWb2x0YWdlQnlEcG0pLAorCU1TR19NQVAoU2V0TWVtb3J5Q2hhbm5lbENvbmZpZyksCisJTVNH
X01BUChTZXRHZW1pbmlNb2RlKSwKKwlNU0dfTUFQKFNldEdlbWluaUFwZXJ0dXJlSGlnaCksCisJ
TVNHX01BUChTZXRHZW1pbmlBcGVydHVyZUxvdyksCisJTVNHX01BUChTZXRNaW5MaW5rRHBtQnlJ
bmRleCksCisJTVNHX01BUChPdmVycmlkZVBjaWVQYXJhbWV0ZXJzKSwKKwlNU0dfTUFQKE92ZXJE
cml2ZVNldFBlcmNlbnRhZ2UpLAorCU1TR19NQVAoU2V0TWluRGVlcFNsZWVwRGNlZmNsayksCisJ
TVNHX01BUChSZWVuYWJsZUFjRGNJbnRlcnJ1cHQpLAorCU1TR19NQVAoTm90aWZ5UG93ZXJTb3Vy
Y2UpLAorCU1TR19NQVAoU2V0VWNsa0Zhc3RTd2l0Y2gpLAorCU1TR19NQVAoU2V0VWNsa0Rvd25I
eXN0KSwKKwlNU0dfTUFQKEdldEN1cnJlbnRScG0pLAorCU1TR19NQVAoU2V0VmlkZW9GcHMpLAor
CU1TR19NQVAoU2V0VGpNYXgpLAorCU1TR19NQVAoU2V0RmFuVGVtcGVyYXR1cmVUYXJnZXQpLAor
CU1TR19NQVAoUHJlcGFyZU1wMUZvclVubG9hZCksCisJTVNHX01BUChEcmFtTG9nU2V0RHJhbUFk
ZHJIaWdoKSwKKwlNU0dfTUFQKERyYW1Mb2dTZXREcmFtQWRkckxvdyksCisJTVNHX01BUChEcmFt
TG9nU2V0RHJhbVNpemUpLAorCU1TR19NQVAoU2V0RmFuTWF4UnBtKSwKKwlNU0dfTUFQKFNldEZh
bk1pblB3bSksCisJTVNHX01BUChDb25maWd1cmVHZnhEaWR0KSwKKwlNU0dfTUFQKE51bU9mRGlz
cGxheXMpLAorCU1TR19NQVAoUmVtb3ZlTWFyZ2lucyksCisJTVNHX01BUChSZWFkU2VyaWFsTnVt
VG9wMzIpLAorCU1TR19NQVAoUmVhZFNlcmlhbE51bUJvdHRvbTMyKSwKKwlNU0dfTUFQKFNldFN5
c3RlbVZpcnR1YWxEcmFtQWRkckhpZ2gpLAorCU1TR19NQVAoU2V0U3lzdGVtVmlydHVhbERyYW1B
ZGRyTG93KSwKKwlNU0dfTUFQKFdhZmxUZXN0KSwKKwlNU0dfTUFQKFNldEZjbGtHZnhDbGtSYXRp
byksCisJTVNHX01BUChBbGxvd0dmeE9mZiksCisJTVNHX01BUChEaXNhbGxvd0dmeE9mZiksCisJ
TVNHX01BUChHZXRQcHRMaW1pdCksCisJTVNHX01BUChHZXREY01vZGVNYXhEcG1GcmVxKSwKKwlN
U0dfTUFQKEdldERlYnVnRGF0YSksCisJTVNHX01BUChTZXRYZ21pTW9kZSksCisJTVNHX01BUChS
dW5BZmxsQnRjKSwKKwlNU0dfTUFQKEV4aXRCYWNvKSwKKwlNU0dfTUFQKFByZXBhcmVNcDFGb3JS
ZXNldCksCisJTVNHX01BUChQcmVwYXJlTXAxRm9yU2h1dGRvd24pLAorCU1TR19NQVAoU2V0TUdw
dUZhbkJvb3N0TGltaXRScG0pLAorCU1TR19NQVAoR2V0QVZGU1ZvbHRhZ2VCeURwbSksCit9Owor
CitzdGF0aWMgaW50IHZlZ2EyMF9jbGtfbWFwW1NNVV9DTEtfQ09VTlRdID0geworCUNMS19NQVAo
R0ZYQ0xLLCBQUENMS19HRlhDTEspLAorCUNMS19NQVAoVkNMSywgUFBDTEtfVkNMSyksCisJQ0xL
X01BUChEQ0xLLCBQUENMS19EQ0xLKSwKKwlDTEtfTUFQKEVDTEssIFBQQ0xLX0VDTEspLAorCUNM
S19NQVAoU09DQ0xLLCBQUENMS19TT0NDTEspLAorCUNMS19NQVAoVUNMSywgUFBDTEtfVUNMSyks
CisJQ0xLX01BUChEQ0VGQ0xLLCBQUENMS19EQ0VGQ0xLKSwKKwlDTEtfTUFQKERJU1BDTEssIFBQ
Q0xLX0RJU1BDTEspLAorCUNMS19NQVAoUElYQ0xLLCBQUENMS19QSVhDTEspLAorCUNMS19NQVAo
UEhZQ0xLLCBQUENMS19QSFlDTEspLAorCUNMS19NQVAoRkNMSywgUFBDTEtfRkNMSyksCit9Owor
CitzdGF0aWMgaW50IHZlZ2EyMF9mZWF0dXJlX21hc2tfbWFwW1NNVV9GRUFUVVJFX0NPVU5UXSA9
IHsKKwlGRUFfTUFQKERQTV9QUkVGRVRDSEVSKSwKKwlGRUFfTUFQKERQTV9HRlhDTEspLAorCUZF
QV9NQVAoRFBNX1VDTEspLAorCUZFQV9NQVAoRFBNX1NPQ0NMSyksCisJRkVBX01BUChEUE1fVVZE
KSwKKwlGRUFfTUFQKERQTV9WQ0UpLAorCUZFQV9NQVAoVUxWKSwKKwlGRUFfTUFQKERQTV9NUDBD
TEspLAorCUZFQV9NQVAoRFBNX0xJTkspLAorCUZFQV9NQVAoRFBNX0RDRUZDTEspLAorCUZFQV9N
QVAoRFNfR0ZYQ0xLKSwKKwlGRUFfTUFQKERTX1NPQ0NMSyksCisJRkVBX01BUChEU19MQ0xLKSwK
KwlGRUFfTUFQKFBQVCksCisJRkVBX01BUChUREMpLAorCUZFQV9NQVAoVEhFUk1BTCksCisJRkVB
X01BUChHRlhfUEVSX0NVX0NHKSwKKwlGRUFfTUFQKFJNKSwKKwlGRUFfTUFQKERTX0RDRUZDTEsp
LAorCUZFQV9NQVAoQUNEQyksCisJRkVBX01BUChWUjBIT1QpLAorCUZFQV9NQVAoVlIxSE9UKSwK
KwlGRUFfTUFQKEZXX0NURiksCisJRkVBX01BUChMRURfRElTUExBWSksCisJRkVBX01BUChGQU5f
Q09OVFJPTCksCisJRkVBX01BUChHRlhfRURDKSwKKwlGRUFfTUFQKEdGWE9GRiksCisJRkVBX01B
UChDRyksCisJRkVBX01BUChEUE1fRkNMSyksCisJRkVBX01BUChEU19GQ0xLKSwKKwlGRUFfTUFQ
KERTX01QMUNMSyksCisJRkVBX01BUChEU19NUDBDTEspLAorCUZFQV9NQVAoWEdNSSksCit9Owor
CitzdGF0aWMgaW50IHZlZ2EyMF90YWJsZV9tYXBbU01VX1RBQkxFX0NPVU5UXSA9IHsKKwlUQUJf
TUFQKFBQVEFCTEUpLAorCVRBQl9NQVAoV0FURVJNQVJLUyksCisJVEFCX01BUChBVkZTKSwKKwlU
QUJfTUFQKEFWRlNfUFNNX0RFQlVHKSwKKwlUQUJfTUFQKEFWRlNfRlVTRV9PVkVSUklERSksCisJ
VEFCX01BUChQTVNUQVRVU0xPRyksCisJVEFCX01BUChTTVVfTUVUUklDUyksCisJVEFCX01BUChE
UklWRVJfU01VX0NPTkZJRyksCisJVEFCX01BUChBQ1RJVklUWV9NT05JVE9SX0NPRUZGKSwKKwlU
QUJfTUFQKE9WRVJEUklWRSksCit9OworCitzdGF0aWMgaW50IHZlZ2EyMF9wd3Jfc3JjX21hcFtT
TVVfUE9XRVJfU09VUkNFX0NPVU5UXSA9IHsKKwlQV1JfTUFQKEFDKSwKKwlQV1JfTUFQKERDKSwK
K307CisKK3N0YXRpYyBpbnQgdmVnYTIwX3dvcmtsb2FkX21hcFtdID0geworCVdPUktMT0FEX01B
UChQUF9TTUNfUE9XRVJfUFJPRklMRV9CT09UVVBfREVGQVVMVCwJV09SS0xPQURfREVGQVVMVF9C
SVQpLAorCVdPUktMT0FEX01BUChQUF9TTUNfUE9XRVJfUFJPRklMRV9GVUxMU0NSRUVOM0QsCQlX
T1JLTE9BRF9QUExJQl9GVUxMX1NDUkVFTl8zRF9CSVQpLAorCVdPUktMT0FEX01BUChQUF9TTUNf
UE9XRVJfUFJPRklMRV9QT1dFUlNBVklORywJCVdPUktMT0FEX1BQTElCX1BPV0VSX1NBVklOR19C
SVQpLAorCVdPUktMT0FEX01BUChQUF9TTUNfUE9XRVJfUFJPRklMRV9WSURFTywJCVdPUktMT0FE
X1BQTElCX1ZJREVPX0JJVCksCisJV09SS0xPQURfTUFQKFBQX1NNQ19QT1dFUl9QUk9GSUxFX1ZS
LAkJCVdPUktMT0FEX1BQTElCX1ZSX0JJVCksCisJV09SS0xPQURfTUFQKFBQX1NNQ19QT1dFUl9Q
Uk9GSUxFX0NPTVBVVEUsCQlXT1JLTE9BRF9QUExJQl9DVVNUT01fQklUKSwKKwlXT1JLTE9BRF9N
QVAoUFBfU01DX1BPV0VSX1BST0ZJTEVfQ1VTVE9NLAkJV09SS0xPQURfUFBMSUJfQ1VTVE9NX0JJ
VCksCit9OworCitzdGF0aWMgaW50IHZlZ2EyMF9nZXRfc211X3RhYmxlX2luZGV4KHN0cnVjdCBz
bXVfY29udGV4dCAqc21jLCB1aW50MzJfdCBpbmRleCkKK3sKKwlpbnQgdmFsOworCWlmIChpbmRl
eCA+PSBTTVVfVEFCTEVfQ09VTlQpCisJCXJldHVybiAtRUlOVkFMOworCisJdmFsID0gdmVnYTIw
X3RhYmxlX21hcFtpbmRleF07CisJaWYgKHZhbCA+PSBUQUJMRV9DT1VOVCkKKwkJcmV0dXJuIC1F
SU5WQUw7CisKKwlyZXR1cm4gdmFsOworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9nZXRfcHdyX3Ny
Y19pbmRleChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtYywgdWludDMyX3QgaW5kZXgpCit7CisJaW50
IHZhbDsKKwlpZiAoaW5kZXggPj0gU01VX1BPV0VSX1NPVVJDRV9DT1VOVCkKKwkJcmV0dXJuIC1F
SU5WQUw7CisKKwl2YWwgPSB2ZWdhMjBfcHdyX3NyY19tYXBbaW5kZXhdOworCWlmICh2YWwgPj0g
UE9XRVJfU09VUkNFX0NPVU5UKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXJldHVybiB2YWw7Cit9
CisKK3N0YXRpYyBpbnQgdmVnYTIwX2dldF9zbXVfZmVhdHVyZV9pbmRleChzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtYywgdWludDMyX3QgaW5kZXgpCit7CisJaW50IHZhbDsKKwlpZiAoaW5kZXggPj0g
U01VX0ZFQVRVUkVfQ09VTlQpCisJCXJldHVybiAtRUlOVkFMOworCisJdmFsID0gdmVnYTIwX2Zl
YXR1cmVfbWFza19tYXBbaW5kZXhdOworCWlmICh2YWwgPiA2NCkKKwkJcmV0dXJuIC1FSU5WQUw7
CisKKwlyZXR1cm4gdmFsOworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9nZXRfc211X2Nsa19pbmRl
eChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtYywgdWludDMyX3QgaW5kZXgpCit7CisJaW50IHZhbDsK
KwlpZiAoaW5kZXggPj0gU01VX0NMS19DT1VOVCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwl2YWwg
PSB2ZWdhMjBfY2xrX21hcFtpbmRleF07CisJaWYgKHZhbCA+PSBQUENMS19DT1VOVCkKKwkJcmV0
dXJuIC1FSU5WQUw7CisKKwlyZXR1cm4gdmFsOworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9nZXRf
c211X21zZ19pbmRleChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtYywgdWludDMyX3QgaW5kZXgpCit7
CisJaW50IHZhbDsKKworCWlmIChpbmRleCA+PSBTTVVfTVNHX01BWF9DT1VOVCkKKwkJcmV0dXJu
IC1FSU5WQUw7CisKKwl2YWwgPSB2ZWdhMjBfbWVzc2FnZV9tYXBbaW5kZXhdOworCWlmICh2YWwg
PiBQUFNNQ19NZXNzYWdlX0NvdW50KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXJldHVybiB2YWw7
Cit9CisKK3N0YXRpYyBpbnQgdmVnYTIwX2dldF93b3JrbG9hZF90eXBlKHN0cnVjdCBzbXVfY29u
dGV4dCAqc211LCBlbnVtIFBQX1NNQ19QT1dFUl9QUk9GSUxFIHByb2ZpbGUpCit7CisJaW50IHZh
bDsKKwlpZiAocHJvZmlsZSA+IFBQX1NNQ19QT1dFUl9QUk9GSUxFX0NVU1RPTSkKKwkJcmV0dXJu
IC1FSU5WQUw7CisKKwl2YWwgPSB2ZWdhMjBfd29ya2xvYWRfbWFwW3Byb2ZpbGVdOworCisJcmV0
dXJuIHZhbDsKK30KKworc3RhdGljIGludCB2ZWdhMjBfdGFibGVzX2luaXQoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUsIHN0cnVjdCBzbXVfdGFibGUgKnRhYmxlcykKK3sKKwlzdHJ1Y3Qgc211X3Rh
YmxlX2NvbnRleHQgKnNtdV90YWJsZSA9ICZzbXUtPnNtdV90YWJsZTsKKworCVNNVV9UQUJMRV9J
TklUKHRhYmxlcywgU01VX1RBQkxFX1BQVEFCTEUsIHNpemVvZihQUFRhYmxlX3QpLAorCQkgICAg
ICAgUEFHRV9TSVpFLCBBTURHUFVfR0VNX0RPTUFJTl9WUkFNKTsKKwlTTVVfVEFCTEVfSU5JVCh0
YWJsZXMsIFNNVV9UQUJMRV9XQVRFUk1BUktTLCBzaXplb2YoV2F0ZXJtYXJrc190KSwKKwkJICAg
ICAgIFBBR0VfU0laRSwgQU1ER1BVX0dFTV9ET01BSU5fVlJBTSk7CisJU01VX1RBQkxFX0lOSVQo
dGFibGVzLCBTTVVfVEFCTEVfU01VX01FVFJJQ1MsIHNpemVvZihTbXVNZXRyaWNzX3QpLAorCQkg
ICAgICAgUEFHRV9TSVpFLCBBTURHUFVfR0VNX0RPTUFJTl9WUkFNKTsKKwlTTVVfVEFCTEVfSU5J
VCh0YWJsZXMsIFNNVV9UQUJMRV9PVkVSRFJJVkUsIHNpemVvZihPdmVyRHJpdmVUYWJsZV90KSwK
KwkJICAgICAgIFBBR0VfU0laRSwgQU1ER1BVX0dFTV9ET01BSU5fVlJBTSk7CisJU01VX1RBQkxF
X0lOSVQodGFibGVzLCBTTVVfVEFCTEVfUE1TVEFUVVNMT0csIFNNVTExX1RPT0xfU0laRSwKKwkJ
ICAgICAgIFBBR0VfU0laRSwgQU1ER1BVX0dFTV9ET01BSU5fVlJBTSk7CisJU01VX1RBQkxFX0lO
SVQodGFibGVzLCBTTVVfVEFCTEVfQUNUSVZJVFlfTU9OSVRPUl9DT0VGRiwKKwkJICAgICAgIHNp
emVvZihEcG1BY3Rpdml0eU1vbml0b3JDb2VmZkludF90KSwgUEFHRV9TSVpFLAorCSAgICAgICAg
ICAgICAgIEFNREdQVV9HRU1fRE9NQUlOX1ZSQU0pOworCisJc211X3RhYmxlLT5tZXRyaWNzX3Rh
YmxlID0ga3phbGxvYyhzaXplb2YoU211TWV0cmljc190KSwgR0ZQX0tFUk5FTCk7CisJaWYgKHNt
dV90YWJsZS0+bWV0cmljc190YWJsZSkKKwkJcmV0dXJuIC1FTk9NRU07CisJc211X3RhYmxlLT5t
ZXRyaWNzX3RpbWUgPSAwOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmVnYTIwX2Fs
bG9jYXRlX2RwbV9jb250ZXh0KHN0cnVjdCBzbXVfY29udGV4dCAqc211KQoreworCXN0cnVjdCBz
bXVfZHBtX2NvbnRleHQgKnNtdV9kcG0gPSAmc211LT5zbXVfZHBtOworCisJaWYgKHNtdV9kcG0t
PmRwbV9jb250ZXh0KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXNtdV9kcG0tPmRwbV9jb250ZXh0
ID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUpLAorCQkJCSAgICAgICBH
RlBfS0VSTkVMKTsKKwlpZiAoIXNtdV9kcG0tPmRwbV9jb250ZXh0KQorCQlyZXR1cm4gLUVOT01F
TTsKKworCWlmIChzbXVfZHBtLT5nb2xkZW5fZHBtX2NvbnRleHQpCisJCXJldHVybiAtRUlOVkFM
OworCisJc211X2RwbS0+Z29sZGVuX2RwbV9jb250ZXh0ID0ga3phbGxvYyhzaXplb2Yoc3RydWN0
IHZlZ2EyMF9kcG1fdGFibGUpLAorCQkJCQkgICAgICBHRlBfS0VSTkVMKTsKKwlpZiAoIXNtdV9k
cG0tPmdvbGRlbl9kcG1fY29udGV4dCkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlzbXVfZHBtLT5k
cG1fY29udGV4dF9zaXplID0gc2l6ZW9mKHN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlKTsKKworCXNt
dV9kcG0tPmRwbV9jdXJyZW50X3Bvd2VyX3N0YXRlID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IHNt
dV9wb3dlcl9zdGF0ZSksCisJCQkJICAgICAgIEdGUF9LRVJORUwpOworCWlmICghc211X2RwbS0+
ZHBtX2N1cnJlbnRfcG93ZXJfc3RhdGUpCisJCXJldHVybiAtRU5PTUVNOworCisJc211X2RwbS0+
ZHBtX3JlcXVlc3RfcG93ZXJfc3RhdGUgPSBremFsbG9jKHNpemVvZihzdHJ1Y3Qgc211X3Bvd2Vy
X3N0YXRlKSwKKwkJCQkgICAgICAgR0ZQX0tFUk5FTCk7CisJaWYgKCFzbXVfZHBtLT5kcG1fcmVx
dWVzdF9wb3dlcl9zdGF0ZSkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCB2ZWdhMjBfc2V0dXBfb2Q4X2luZm9ybWF0aW9uKHN0cnVjdCBzbXVfY29udGV4
dCAqc211KQoreworCUFUT01fVmVnYTIwX1BPV0VSUExBWVRBQkxFICpwb3dlcnBsYXlfdGFibGUg
PSBOVUxMOworCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFibGVfY29udGV4dCA9ICZzbXUt
PnNtdV90YWJsZTsKKwlzdHJ1Y3QgdmVnYTIwX29kOF9zZXR0aW5ncyAqb2Q4X3NldHRpbmdzID0g
KHN0cnVjdCB2ZWdhMjBfb2Q4X3NldHRpbmdzICopc211LT5vZF9zZXR0aW5nczsKKworCXVpbnQz
Ml90IG9kX2ZlYXR1cmVfY291bnQsIG9kX2ZlYXR1cmVfYXJyYXlfc2l6ZSwKKwkJIG9kX3NldHRp
bmdfY291bnQsIG9kX3NldHRpbmdfYXJyYXlfc2l6ZTsKKworCWlmICghdGFibGVfY29udGV4dC0+
cG93ZXJfcGxheV90YWJsZSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlwb3dlcnBsYXlfdGFibGUg
PSB0YWJsZV9jb250ZXh0LT5wb3dlcl9wbGF5X3RhYmxlOworCisJaWYgKHBvd2VycGxheV90YWJs
ZS0+T3ZlckRyaXZlOFRhYmxlLnVjT0RUYWJsZVJldmlzaW9uID09IDEpIHsKKwkJLyogU2V0dXAg
Y29ycmVjdCBPREZlYXR1cmVDb3VudCwgYW5kIHN0b3JlIE9ERmVhdHVyZUFycmF5IGZyb20KKwkJ
ICogcG93ZXJwbGF5IHRhYmxlIHRvIG9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzICovCisJCW9kX2Zl
YXR1cmVfY291bnQgPQorCQkJKGxlMzJfdG9fY3B1KHBvd2VycGxheV90YWJsZS0+T3ZlckRyaXZl
OFRhYmxlLk9ERmVhdHVyZUNvdW50KSA+CisJCQkgQVRPTV9WRUdBMjBfT0RGRUFUVVJFX0NPVU5U
KSA/CisJCQlBVE9NX1ZFR0EyMF9PREZFQVRVUkVfQ09VTlQgOgorCQkJbGUzMl90b19jcHUocG93
ZXJwbGF5X3RhYmxlLT5PdmVyRHJpdmU4VGFibGUuT0RGZWF0dXJlQ291bnQpOworCisJCW9kX2Zl
YXR1cmVfYXJyYXlfc2l6ZSA9IHNpemVvZih1aW50OF90KSAqIG9kX2ZlYXR1cmVfY291bnQ7CisK
KwkJaWYgKG9kOF9zZXR0aW5ncy0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXMpCisJCQlyZXR1cm4g
LUVJTlZBTDsKKworCQlvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzID0ga21l
bWR1cCgmcG93ZXJwbGF5X3RhYmxlLT5PdmVyRHJpdmU4VGFibGUuT0RGZWF0dXJlQ2FwYWJpbGl0
aWVzLAorCQkJCQkJCQkgb2RfZmVhdHVyZV9hcnJheV9zaXplLAorCQkJCQkJCQkgR0ZQX0tFUk5F
TCk7CisJCWlmICghb2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllcykKKwkJCXJl
dHVybiAtRU5PTUVNOworCisJCS8qIFNldHVwIGNvcnJlY3QgT0RTZXR0aW5nQ291bnQsIGFuZCBz
dG9yZSBPRFNldHRpbmdBcnJheSBmcm9tCisJCSAqIHBvd2VycGxheSB0YWJsZSB0byBvZF9zZXR0
aW5nc19tYXggYW5kIG9kX3NldHRpbmdfbWluICovCisJCW9kX3NldHRpbmdfY291bnQgPQorCQkJ
KGxlMzJfdG9fY3B1KHBvd2VycGxheV90YWJsZS0+T3ZlckRyaXZlOFRhYmxlLk9EU2V0dGluZ0Nv
dW50KSA+CisJCQkgQVRPTV9WRUdBMjBfT0RTRVRUSU5HX0NPVU5UKSA/CisJCQlBVE9NX1ZFR0Ey
MF9PRFNFVFRJTkdfQ09VTlQgOgorCQkJbGUzMl90b19jcHUocG93ZXJwbGF5X3RhYmxlLT5PdmVy
RHJpdmU4VGFibGUuT0RTZXR0aW5nQ291bnQpOworCisJCW9kX3NldHRpbmdfYXJyYXlfc2l6ZSA9
IHNpemVvZih1aW50MzJfdCkgKiBvZF9zZXR0aW5nX2NvdW50OworCisJCWlmIChvZDhfc2V0dGlu
Z3MtPm9kX3NldHRpbmdzX21heCkKKwkJCXJldHVybiAtRUlOVkFMOworCisJCW9kOF9zZXR0aW5n
cy0+b2Rfc2V0dGluZ3NfbWF4ID0ga21lbWR1cCgmcG93ZXJwbGF5X3RhYmxlLT5PdmVyRHJpdmU4
VGFibGUuT0RTZXR0aW5nc01heCwKKwkJCQkJCQkgb2Rfc2V0dGluZ19hcnJheV9zaXplLAorCQkJ
CQkJCSBHRlBfS0VSTkVMKTsKKworCQlpZiAoIW9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWF4
KSB7CisJCQlrZnJlZShvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzKTsKKwkJ
CW9kOF9zZXR0aW5ncy0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXMgPSBOVUxMOworCQkJcmV0dXJu
IC1FTk9NRU07CisJCX0KKworCQlpZiAob2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW4pCisJ
CQlyZXR1cm4gLUVJTlZBTDsKKworCQlvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbiA9IGtt
ZW1kdXAoJnBvd2VycGxheV90YWJsZS0+T3ZlckRyaXZlOFRhYmxlLk9EU2V0dGluZ3NNaW4sCisJ
CQkJCQkJIG9kX3NldHRpbmdfYXJyYXlfc2l6ZSwKKwkJCQkJCQkgR0ZQX0tFUk5FTCk7CisKKwkJ
aWYgKCFvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbikgeworCQkJa2ZyZWUob2Q4X3NldHRp
bmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllcyk7CisJCQlvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1
cmVfY2FwYWJpbGl0aWVzID0gTlVMTDsKKwkJCWtmcmVlKG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGlu
Z3NfbWF4KTsKKwkJCW9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWF4ID0gTlVMTDsKKwkJCXJl
dHVybiAtRU5PTUVNOworCQl9CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmVn
YTIwX3N0b3JlX3Bvd2VycGxheV90YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKK3sKKwlB
VE9NX1ZlZ2EyMF9QT1dFUlBMQVlUQUJMRSAqcG93ZXJwbGF5X3RhYmxlID0gTlVMTDsKKwlzdHJ1
Y3Qgc211X3RhYmxlX2NvbnRleHQgKnRhYmxlX2NvbnRleHQgPSAmc211LT5zbXVfdGFibGU7CisJ
aW50IHJldDsKKworCWlmICghdGFibGVfY29udGV4dC0+cG93ZXJfcGxheV90YWJsZSkKKwkJcmV0
dXJuIC1FSU5WQUw7CisKKwlwb3dlcnBsYXlfdGFibGUgPSB0YWJsZV9jb250ZXh0LT5wb3dlcl9w
bGF5X3RhYmxlOworCisJbWVtY3B5KHRhYmxlX2NvbnRleHQtPmRyaXZlcl9wcHRhYmxlLCAmcG93
ZXJwbGF5X3RhYmxlLT5zbWNQUFRhYmxlLAorCSAgICAgICBzaXplb2YoUFBUYWJsZV90KSk7CisK
Kwl0YWJsZV9jb250ZXh0LT5zb2Z0d2FyZV9zaHV0ZG93bl90ZW1wID0gcG93ZXJwbGF5X3RhYmxl
LT51c1NvZnR3YXJlU2h1dGRvd25UZW1wOworCXRhYmxlX2NvbnRleHQtPnRoZXJtYWxfY29udHJv
bGxlcl90eXBlID0gcG93ZXJwbGF5X3RhYmxlLT51Y1RoZXJtYWxDb250cm9sbGVyVHlwZTsKKwl0
YWJsZV9jb250ZXh0LT5URFBPRExpbWl0ID0gbGUzMl90b19jcHUocG93ZXJwbGF5X3RhYmxlLT5P
dmVyRHJpdmU4VGFibGUuT0RTZXR0aW5nc01heFtBVE9NX1ZFR0EyMF9PRFNFVFRJTkdfUE9XRVJQ
RVJDRU5UQUdFXSk7CisKKwlyZXQgPSB2ZWdhMjBfc2V0dXBfb2Q4X2luZm9ybWF0aW9uKHNtdSk7
CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9hcHBlbmRfcG93ZXJwbGF5
X3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQoreworCXN0cnVjdCBzbXVfdGFibGVfY29u
dGV4dCAqdGFibGVfY29udGV4dCA9ICZzbXUtPnNtdV90YWJsZTsKKwlQUFRhYmxlX3QgKnNtY19w
cHRhYmxlID0gdGFibGVfY29udGV4dC0+ZHJpdmVyX3BwdGFibGU7CisJc3RydWN0IGF0b21fc21j
X2RwbV9pbmZvX3Y0XzQgKnNtY19kcG1fdGFibGU7CisJaW50IGluZGV4LCBpLCByZXQ7CisKKwlp
bmRleCA9IGdldF9pbmRleF9pbnRvX21hc3Rlcl90YWJsZShhdG9tX21hc3Rlcl9saXN0X29mX2Rh
dGFfdGFibGVzX3YyXzEsCisJCQkJCSAgIHNtY19kcG1faW5mbyk7CisKKwlyZXQgPSBzbXVfZ2V0
X2F0b21fZGF0YV90YWJsZShzbXUsIGluZGV4LCBOVUxMLCBOVUxMLCBOVUxMLAorCQkJCSAgICAg
ICh1aW50OF90ICoqKSZzbWNfZHBtX3RhYmxlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0Owor
CisJc21jX3BwdGFibGUtPk1heFZvbHRhZ2VTdGVwR2Z4ID0gc21jX2RwbV90YWJsZS0+bWF4dm9s
dGFnZXN0ZXBnZng7CisJc21jX3BwdGFibGUtPk1heFZvbHRhZ2VTdGVwU29jID0gc21jX2RwbV90
YWJsZS0+bWF4dm9sdGFnZXN0ZXBzb2M7CisKKwlzbWNfcHB0YWJsZS0+VmRkR2Z4VnJNYXBwaW5n
ID0gc21jX2RwbV90YWJsZS0+dmRkZ2Z4dnJtYXBwaW5nOworCXNtY19wcHRhYmxlLT5WZGRTb2NW
ck1hcHBpbmcgPSBzbWNfZHBtX3RhYmxlLT52ZGRzb2N2cm1hcHBpbmc7CisJc21jX3BwdGFibGUt
PlZkZE1lbTBWck1hcHBpbmcgPSBzbWNfZHBtX3RhYmxlLT52ZGRtZW0wdnJtYXBwaW5nOworCXNt
Y19wcHRhYmxlLT5WZGRNZW0xVnJNYXBwaW5nID0gc21jX2RwbV90YWJsZS0+dmRkbWVtMXZybWFw
cGluZzsKKworCXNtY19wcHRhYmxlLT5HZnhVbHZQaGFzZVNoZWRkaW5nTWFzayA9IHNtY19kcG1f
dGFibGUtPmdmeHVsdnBoYXNlc2hlZGRpbmdtYXNrOworCXNtY19wcHRhYmxlLT5Tb2NVbHZQaGFz
ZVNoZWRkaW5nTWFzayA9IHNtY19kcG1fdGFibGUtPnNvY3VsdnBoYXNlc2hlZGRpbmdtYXNrOwor
CXNtY19wcHRhYmxlLT5FeHRlcm5hbFNlbnNvclByZXNlbnQgPSBzbWNfZHBtX3RhYmxlLT5leHRl
cm5hbHNlbnNvcnByZXNlbnQ7CisKKwlzbWNfcHB0YWJsZS0+R2Z4TWF4Q3VycmVudCA9IHNtY19k
cG1fdGFibGUtPmdmeG1heGN1cnJlbnQ7CisJc21jX3BwdGFibGUtPkdmeE9mZnNldCA9IHNtY19k
cG1fdGFibGUtPmdmeG9mZnNldDsKKwlzbWNfcHB0YWJsZS0+UGFkZGluZ19UZWxlbWV0cnlHZngg
PSBzbWNfZHBtX3RhYmxlLT5wYWRkaW5nX3RlbGVtZXRyeWdmeDsKKworCXNtY19wcHRhYmxlLT5T
b2NNYXhDdXJyZW50ID0gc21jX2RwbV90YWJsZS0+c29jbWF4Y3VycmVudDsKKwlzbWNfcHB0YWJs
ZS0+U29jT2Zmc2V0ID0gc21jX2RwbV90YWJsZS0+c29jb2Zmc2V0OworCXNtY19wcHRhYmxlLT5Q
YWRkaW5nX1RlbGVtZXRyeVNvYyA9IHNtY19kcG1fdGFibGUtPnBhZGRpbmdfdGVsZW1ldHJ5c29j
OworCisJc21jX3BwdGFibGUtPk1lbTBNYXhDdXJyZW50ID0gc21jX2RwbV90YWJsZS0+bWVtMG1h
eGN1cnJlbnQ7CisJc21jX3BwdGFibGUtPk1lbTBPZmZzZXQgPSBzbWNfZHBtX3RhYmxlLT5tZW0w
b2Zmc2V0OworCXNtY19wcHRhYmxlLT5QYWRkaW5nX1RlbGVtZXRyeU1lbTAgPSBzbWNfZHBtX3Rh
YmxlLT5wYWRkaW5nX3RlbGVtZXRyeW1lbTA7CisKKwlzbWNfcHB0YWJsZS0+TWVtMU1heEN1cnJl
bnQgPSBzbWNfZHBtX3RhYmxlLT5tZW0xbWF4Y3VycmVudDsKKwlzbWNfcHB0YWJsZS0+TWVtMU9m
ZnNldCA9IHNtY19kcG1fdGFibGUtPm1lbTFvZmZzZXQ7CisJc21jX3BwdGFibGUtPlBhZGRpbmdf
VGVsZW1ldHJ5TWVtMSA9IHNtY19kcG1fdGFibGUtPnBhZGRpbmdfdGVsZW1ldHJ5bWVtMTsKKwor
CXNtY19wcHRhYmxlLT5BY0RjR3BpbyA9IHNtY19kcG1fdGFibGUtPmFjZGNncGlvOworCXNtY19w
cHRhYmxlLT5BY0RjUG9sYXJpdHkgPSBzbWNfZHBtX3RhYmxlLT5hY2RjcG9sYXJpdHk7CisJc21j
X3BwdGFibGUtPlZSMEhvdEdwaW8gPSBzbWNfZHBtX3RhYmxlLT52cjBob3RncGlvOworCXNtY19w
cHRhYmxlLT5WUjBIb3RQb2xhcml0eSA9IHNtY19kcG1fdGFibGUtPnZyMGhvdHBvbGFyaXR5Owor
CisJc21jX3BwdGFibGUtPlZSMUhvdEdwaW8gPSBzbWNfZHBtX3RhYmxlLT52cjFob3RncGlvOwor
CXNtY19wcHRhYmxlLT5WUjFIb3RQb2xhcml0eSA9IHNtY19kcG1fdGFibGUtPnZyMWhvdHBvbGFy
aXR5OworCXNtY19wcHRhYmxlLT5QYWRkaW5nMSA9IHNtY19kcG1fdGFibGUtPnBhZGRpbmcxOwor
CXNtY19wcHRhYmxlLT5QYWRkaW5nMiA9IHNtY19kcG1fdGFibGUtPnBhZGRpbmcyOworCisJc21j
X3BwdGFibGUtPkxlZFBpbjAgPSBzbWNfZHBtX3RhYmxlLT5sZWRwaW4wOworCXNtY19wcHRhYmxl
LT5MZWRQaW4xID0gc21jX2RwbV90YWJsZS0+bGVkcGluMTsKKwlzbWNfcHB0YWJsZS0+TGVkUGlu
MiA9IHNtY19kcG1fdGFibGUtPmxlZHBpbjI7CisKKwlzbWNfcHB0YWJsZS0+UGxsR2Z4Y2xrU3By
ZWFkRW5hYmxlZCA9IHNtY19kcG1fdGFibGUtPnBsbGdmeGNsa3NwcmVhZGVuYWJsZWQ7CisJc21j
X3BwdGFibGUtPlBsbEdmeGNsa1NwcmVhZFBlcmNlbnQgPSBzbWNfZHBtX3RhYmxlLT5wbGxnZnhj
bGtzcHJlYWRwZXJjZW50OworCXNtY19wcHRhYmxlLT5QbGxHZnhjbGtTcHJlYWRGcmVxID0gc21j
X2RwbV90YWJsZS0+cGxsZ2Z4Y2xrc3ByZWFkZnJlcTsKKworCXNtY19wcHRhYmxlLT5VY2xrU3By
ZWFkRW5hYmxlZCA9IDA7CisJc21jX3BwdGFibGUtPlVjbGtTcHJlYWRQZXJjZW50ID0gc21jX2Rw
bV90YWJsZS0+dWNsa3NwcmVhZHBlcmNlbnQ7CisJc21jX3BwdGFibGUtPlVjbGtTcHJlYWRGcmVx
ID0gc21jX2RwbV90YWJsZS0+dWNsa3NwcmVhZGZyZXE7CisKKwlzbWNfcHB0YWJsZS0+RmNsa1Nw
cmVhZEVuYWJsZWQgPSBzbWNfZHBtX3RhYmxlLT5mY2xrc3ByZWFkZW5hYmxlZDsKKwlzbWNfcHB0
YWJsZS0+RmNsa1NwcmVhZFBlcmNlbnQgPSBzbWNfZHBtX3RhYmxlLT5mY2xrc3ByZWFkcGVyY2Vu
dDsKKwlzbWNfcHB0YWJsZS0+RmNsa1NwcmVhZEZyZXEgPSBzbWNfZHBtX3RhYmxlLT5mY2xrc3By
ZWFkZnJlcTsKKworCXNtY19wcHRhYmxlLT5GbGxHZnhjbGtTcHJlYWRFbmFibGVkID0gc21jX2Rw
bV90YWJsZS0+ZmxsZ2Z4Y2xrc3ByZWFkZW5hYmxlZDsKKwlzbWNfcHB0YWJsZS0+RmxsR2Z4Y2xr
U3ByZWFkUGVyY2VudCA9IHNtY19kcG1fdGFibGUtPmZsbGdmeGNsa3NwcmVhZHBlcmNlbnQ7CisJ
c21jX3BwdGFibGUtPkZsbEdmeGNsa1NwcmVhZEZyZXEgPSBzbWNfZHBtX3RhYmxlLT5mbGxnZnhj
bGtzcHJlYWRmcmVxOworCisJZm9yIChpID0gMDsgaSA8IEkyQ19DT05UUk9MTEVSX05BTUVfQ09V
TlQ7IGkrKykgeworCQlzbWNfcHB0YWJsZS0+STJjQ29udHJvbGxlcnNbaV0uRW5hYmxlZCA9CisJ
CQlzbWNfZHBtX3RhYmxlLT5pMmNjb250cm9sbGVyc1tpXS5lbmFibGVkOworCQlzbWNfcHB0YWJs
ZS0+STJjQ29udHJvbGxlcnNbaV0uU2xhdmVBZGRyZXNzID0KKwkJCXNtY19kcG1fdGFibGUtPmky
Y2NvbnRyb2xsZXJzW2ldLnNsYXZlYWRkcmVzczsKKwkJc21jX3BwdGFibGUtPkkyY0NvbnRyb2xs
ZXJzW2ldLkNvbnRyb2xsZXJQb3J0ID0KKwkJCXNtY19kcG1fdGFibGUtPmkyY2NvbnRyb2xsZXJz
W2ldLmNvbnRyb2xsZXJwb3J0OworCQlzbWNfcHB0YWJsZS0+STJjQ29udHJvbGxlcnNbaV0uVGhl
cm1hbFRocm90dGxlciA9CisJCQlzbWNfZHBtX3RhYmxlLT5pMmNjb250cm9sbGVyc1tpXS50aGVy
bWFsdGhyb3R0bGVyOworCQlzbWNfcHB0YWJsZS0+STJjQ29udHJvbGxlcnNbaV0uSTJjUHJvdG9j
b2wgPQorCQkJc21jX2RwbV90YWJsZS0+aTJjY29udHJvbGxlcnNbaV0uaTJjcHJvdG9jb2w7CisJ
CXNtY19wcHRhYmxlLT5JMmNDb250cm9sbGVyc1tpXS5JMmNTcGVlZCA9CisJCQlzbWNfZHBtX3Rh
YmxlLT5pMmNjb250cm9sbGVyc1tpXS5pMmNzcGVlZDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCB2ZWdhMjBfY2hlY2tfcG93ZXJwbGF5X3RhYmxlKHN0cnVjdCBzbXVfY29udGV4
dCAqc211KQoreworCUFUT01fVmVnYTIwX1BPV0VSUExBWVRBQkxFICpwb3dlcnBsYXlfdGFibGUg
PSBOVUxMOworCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFibGVfY29udGV4dCA9ICZzbXUt
PnNtdV90YWJsZTsKKworCXBvd2VycGxheV90YWJsZSA9IHRhYmxlX2NvbnRleHQtPnBvd2VyX3Bs
YXlfdGFibGU7CisKKwlpZiAocG93ZXJwbGF5X3RhYmxlLT5zSGVhZGVyLmZvcm1hdF9yZXZpc2lv
biA8IEFUT01fVkVHQTIwX1RBQkxFX1JFVklTSU9OX1ZFR0EyMCkgeworCQlwcl9lcnIoIlVuc3Vw
cG9ydGVkIFBQVGFibGUgZm9ybWF0ISIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlpZiAo
IXBvd2VycGxheV90YWJsZS0+c0hlYWRlci5zdHJ1Y3R1cmVzaXplKSB7CisJCXByX2VycigiSW52
YWxpZCBQb3dlclBsYXkgVGFibGUhIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXJldHVy
biAwOworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9ydW5fYnRjX2FmbGwoc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUpCit7CisJcmV0dXJuIHNtdV9zZW5kX3NtY19tc2coc211LCBTTVVfTVNHX1J1bkFm
bGxCdGMpOworfQorCisjZGVmaW5lIEZFQVRVUkVfTUFTSyhmZWF0dXJlKSAoMVVMTCA8PCBmZWF0
dXJlKQorc3RhdGljIGludAordmVnYTIwX2dldF9hbGxvd2VkX2ZlYXR1cmVfbWFzayhzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSwKKwkJCQkgIHVpbnQzMl90ICpmZWF0dXJlX21hc2ssIHVpbnQzMl90
IG51bSkKK3sKKwlpZiAobnVtID4gMikKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwltZW1zZXQoZmVh
dHVyZV9tYXNrLCAwLCBzaXplb2YodWludDMyX3QpICogbnVtKTsKKworCSoodWludDY0X3QgKilm
ZWF0dXJlX21hc2sgfD0gRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX1BSRUZFVENIRVJfQklUKQor
CQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX0dGWENMS19CSVQpCisJCQkJfCBGRUFUVVJF
X01BU0soRkVBVFVSRV9EUE1fVUNMS19CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9E
UE1fU09DQ0xLX0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9VVkRfQklUKQor
CQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX1ZDRV9CSVQpCisJCQkJfCBGRUFUVVJFX01B
U0soRkVBVFVSRV9VTFZfQklUKQorCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX01QMENM
S19CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9EUE1fTElOS19CSVQpCisJCQkJfCBG
RUFUVVJFX01BU0soRkVBVFVSRV9EUE1fRENFRkNMS19CSVQpCisJCQkJfCBGRUFUVVJFX01BU0so
RkVBVFVSRV9QUFRfQklUKQorCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfVERDX0JJVCkKKwkJ
CQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX1RIRVJNQUxfQklUKQorCQkJCXwgRkVBVFVSRV9NQVNL
KEZFQVRVUkVfR0ZYX1BFUl9DVV9DR19CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9S
TV9CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9BQ0RDX0JJVCkKKwkJCQl8IEZFQVRV
UkVfTUFTSyhGRUFUVVJFX1ZSMEhPVF9CSVQpCisJCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9W
UjFIT1RfQklUKQorCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfRldfQ1RGX0JJVCkKKwkJCQl8
IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0xFRF9ESVNQTEFZX0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFT
SyhGRUFUVVJFX0ZBTl9DT05UUk9MX0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0dG
WF9FRENfQklUKQorCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfR0ZYT0ZGX0JJVCkKKwkJCQl8
IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0NHX0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJF
X0RQTV9GQ0xLX0JJVCkKKwkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX1hHTUlfQklUKTsKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIGVudW0KK2FtZF9wbV9zdGF0ZV90eXBlIHZlZ2EyMF9nZXRf
Y3VycmVudF9wb3dlcl9zdGF0ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKK3sKKwllbnVtIGFt
ZF9wbV9zdGF0ZV90eXBlIHBtX3R5cGU7CisJc3RydWN0IHNtdV9kcG1fY29udGV4dCAqc211X2Rw
bV9jdHggPSAmKHNtdS0+c211X2RwbSk7CisKKwlpZiAoIXNtdV9kcG1fY3R4LT5kcG1fY29udGV4
dCB8fAorCSAgICAhc211X2RwbV9jdHgtPmRwbV9jdXJyZW50X3Bvd2VyX3N0YXRlKQorCQlyZXR1
cm4gLUVJTlZBTDsKKworCW11dGV4X2xvY2soJihzbXUtPm11dGV4KSk7CisJc3dpdGNoIChzbXVf
ZHBtX2N0eC0+ZHBtX2N1cnJlbnRfcG93ZXJfc3RhdGUtPmNsYXNzaWZpY2F0aW9uLnVpX2xhYmVs
KSB7CisJY2FzZSBTTVVfU1RBVEVfVUlfTEFCRUxfQkFUVEVSWToKKwkJcG1fdHlwZSA9IFBPV0VS
X1NUQVRFX1RZUEVfQkFUVEVSWTsKKwkJYnJlYWs7CisJY2FzZSBTTVVfU1RBVEVfVUlfTEFCRUxf
QkFMTEFOQ0VEOgorCQlwbV90eXBlID0gUE9XRVJfU1RBVEVfVFlQRV9CQUxBTkNFRDsKKwkJYnJl
YWs7CisJY2FzZSBTTVVfU1RBVEVfVUlfTEFCRUxfUEVSRk9STUFOQ0U6CisJCXBtX3R5cGUgPSBQ
T1dFUl9TVEFURV9UWVBFX1BFUkZPUk1BTkNFOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlpZiAo
c211X2RwbV9jdHgtPmRwbV9jdXJyZW50X3Bvd2VyX3N0YXRlLT5jbGFzc2lmaWNhdGlvbi5mbGFn
cyAmIFNNVV9TVEFURV9DTEFTU0lGSUNBVElPTl9GTEFHX0JPT1QpCisJCQlwbV90eXBlID0gUE9X
RVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9CT09UOworCQllbHNlCisJCQlwbV90eXBlID0gUE9XRVJf
U1RBVEVfVFlQRV9ERUZBVUxUOworCQlicmVhazsKKwl9CisJbXV0ZXhfdW5sb2NrKCYoc211LT5t
dXRleCkpOworCisJcmV0dXJuIHBtX3R5cGU7Cit9CisKK3N0YXRpYyBpbnQKK3ZlZ2EyMF9zZXRf
c2luZ2xlX2RwbV90YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKKwkJCSAgICBzdHJ1Y3Qg
dmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgKnNpbmdsZV9kcG1fdGFibGUsCisJCQkgICAgUFBDTEtf
ZSBjbGtfaWQpCit7CisJaW50IHJldCA9IDA7CisJdWludDMyX3QgaSwgbnVtX29mX2xldmVscyA9
IDAsIGNsazsKKworCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsCisJCQlT
TVVfTVNHX0dldERwbUZyZXFCeUluZGV4LAorCQkJKGNsa19pZCA8PCAxNiB8IDB4RkYpKTsKKwlp
ZiAocmV0KSB7CisJCXByX2VycigiW0dldE51bU9mRHBtTGV2ZWxdIGZhaWxlZCB0byBnZXQgZHBt
IGxldmVscyEiKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlzbXVfcmVhZF9zbWNfYXJnKHNtdSwg
Jm51bV9vZl9sZXZlbHMpOworCWlmICghbnVtX29mX2xldmVscykgeworCQlwcl9lcnIoIltHZXRO
dW1PZkRwbUxldmVsXSBudW1iZXIgb2YgY2xrIGxldmVscyBpcyBpbnZhbGlkISIpOworCQlyZXR1
cm4gLUVJTlZBTDsKKwl9CisKKwlzaW5nbGVfZHBtX3RhYmxlLT5jb3VudCA9IG51bV9vZl9sZXZl
bHM7CisKKwlmb3IgKGkgPSAwOyBpIDwgbnVtX29mX2xldmVsczsgaSsrKSB7CisJCXJldCA9IHNt
dV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsCisJCQkJU01VX01TR19HZXREcG1GcmVxQnlJ
bmRleCwKKwkJCQkoY2xrX2lkIDw8IDE2IHwgaSkpOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIo
IltHZXREcG1GcmVxQnlJbmRleF0gZmFpbGVkIHRvIGdldCBkcG0gZnJlcSBieSBpbmRleCEiKTsK
KwkJCXJldHVybiByZXQ7CisJCX0KKwkJc211X3JlYWRfc21jX2FyZyhzbXUsICZjbGspOworCQlp
ZiAoIWNsaykgeworCQkJcHJfZXJyKCJbR2V0RHBtRnJlcUJ5SW5kZXhdIGNsayB2YWx1ZSBpcyBp
bnZhbGlkISIpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKwkJc2luZ2xlX2RwbV90YWJsZS0+
ZHBtX2xldmVsc1tpXS52YWx1ZSA9IGNsazsKKwkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX2xldmVs
c1tpXS5lbmFibGVkID0gdHJ1ZTsKKwl9CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIHZl
Z2EyMF9pbml0X3NpbmdsZV9kcG1fc3RhdGUoc3RydWN0IHZlZ2EyMF9kcG1fc3RhdGUgKmRwbV9z
dGF0ZSkKK3sKKwlkcG1fc3RhdGUtPnNvZnRfbWluX2xldmVsID0gMHgwOworCWRwbV9zdGF0ZS0+
c29mdF9tYXhfbGV2ZWwgPSAweGZmZmY7CisgICAgICAgIGRwbV9zdGF0ZS0+aGFyZF9taW5fbGV2
ZWwgPSAweDA7CisgICAgICAgIGRwbV9zdGF0ZS0+aGFyZF9tYXhfbGV2ZWwgPSAweGZmZmY7Cit9
CisKK3N0YXRpYyBpbnQgdmVnYTIwX3NldF9kZWZhdWx0X2RwbV90YWJsZShzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSkKK3sKKwlpbnQgcmV0OworCisJc3RydWN0IHNtdV9kcG1fY29udGV4dCAqc211
X2RwbSA9ICZzbXUtPnNtdV9kcG07CisJc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKmRwbV90YWJs
ZSA9IE5VTEw7CisJc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICpzaW5nbGVfZHBtX3Rh
YmxlOworCisJZHBtX3RhYmxlID0gc211X2RwbS0+ZHBtX2NvbnRleHQ7CisKKwkvKiBzb2NjbGsg
Ki8KKwlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPnNvY190YWJsZSk7CisKKwlpZiAo
c211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9TT0NDTEtfQklUKSkg
eworCQlyZXQgPSB2ZWdhMjBfc2V0X3NpbmdsZV9kcG1fdGFibGUoc211LCBzaW5nbGVfZHBtX3Rh
YmxlLAorCQkJCQkJICBQUENMS19TT0NDTEspOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIltT
ZXR1cERlZmF1bHREcG1UYWJsZV0gZmFpbGVkIHRvIGdldCBzb2NjbGsgZHBtIGxldmVscyEiKTsK
KwkJCXJldHVybiByZXQ7CisJCX0KKwl9IGVsc2UgeworCQlzaW5nbGVfZHBtX3RhYmxlLT5jb3Vu
dCA9IDE7CisJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWUgPSBzbXUtPnNt
dV90YWJsZS5ib290X3ZhbHVlcy5zb2NjbGsgLyAxMDA7CisJfQorCXZlZ2EyMF9pbml0X3Npbmds
ZV9kcG1fc3RhdGUoJihzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUpKTsKKworCS8qIGdmeGNs
ayAqLworCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+Z2Z4X3RhYmxlKTsKKworCWlm
IChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX0dGWENMS19CSVQp
KSB7CisJCXJldCA9IHZlZ2EyMF9zZXRfc2luZ2xlX2RwbV90YWJsZShzbXUsIHNpbmdsZV9kcG1f
dGFibGUsCisJCQkJCQkgIFBQQ0xLX0dGWENMSyk7CisJCWlmIChyZXQpIHsKKwkJCXByX2Vycigi
W1NldHVwRGVmYXVsdERwbVRhYmxlXSBmYWlsZWQgdG8gZ2V0IGdmeGNsayBkcG0gbGV2ZWxzISIp
OworCQkJcmV0dXJuIHJldDsKKwkJfQorCX0gZWxzZSB7CisJCXNpbmdsZV9kcG1fdGFibGUtPmNv
dW50ID0gMTsKKwkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1ZSA9IHNtdS0+
c211X3RhYmxlLmJvb3RfdmFsdWVzLmdmeGNsayAvIDEwMDsKKwl9CisJdmVnYTIwX2luaXRfc2lu
Z2xlX2RwbV9zdGF0ZSgmKHNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZSkpOworCisJLyogbWVt
Y2xrICovCisJc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5tZW1fdGFibGUpOworCisJ
aWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVUNMS19CSVQp
KSB7CisJCXJldCA9IHZlZ2EyMF9zZXRfc2luZ2xlX2RwbV90YWJsZShzbXUsIHNpbmdsZV9kcG1f
dGFibGUsCisJCQkJCQkgIFBQQ0xLX1VDTEspOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIltT
ZXR1cERlZmF1bHREcG1UYWJsZV0gZmFpbGVkIHRvIGdldCBtZW1jbGsgZHBtIGxldmVscyEiKTsK
KwkJCXJldHVybiByZXQ7CisJCX0KKwl9IGVsc2UgeworCQlzaW5nbGVfZHBtX3RhYmxlLT5jb3Vu
dCA9IDE7CisJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWUgPSBzbXUtPnNt
dV90YWJsZS5ib290X3ZhbHVlcy51Y2xrIC8gMTAwOworCX0KKwl2ZWdhMjBfaW5pdF9zaW5nbGVf
ZHBtX3N0YXRlKCYoc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlKSk7CisKKwkvKiBlY2xrICov
CisJc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5lY2xrX3RhYmxlKTsKKworCWlmIChz
bXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX1ZDRV9CSVQpKSB7CisJ
CXJldCA9IHZlZ2EyMF9zZXRfc2luZ2xlX2RwbV90YWJsZShzbXUsIHNpbmdsZV9kcG1fdGFibGUs
IFBQQ0xLX0VDTEspOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIltTZXR1cERlZmF1bHREcG1U
YWJsZV0gZmFpbGVkIHRvIGdldCBlY2xrIGRwbSBsZXZlbHMhIik7CisJCQlyZXR1cm4gcmV0Owor
CQl9CisJfSBlbHNlIHsKKwkJc2luZ2xlX2RwbV90YWJsZS0+Y291bnQgPSAxOworCQlzaW5nbGVf
ZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlID0gc211LT5zbXVfdGFibGUuYm9vdF92YWx1
ZXMuZWNsayAvIDEwMDsKKwl9CisJdmVnYTIwX2luaXRfc2luZ2xlX2RwbV9zdGF0ZSgmKHNpbmds
ZV9kcG1fdGFibGUtPmRwbV9zdGF0ZSkpOworCisJLyogdmNsayAqLworCXNpbmdsZV9kcG1fdGFi
bGUgPSAmKGRwbV90YWJsZS0+dmNsa190YWJsZSk7CisKKwlpZiAoc211X2ZlYXR1cmVfaXNfZW5h
YmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9VVkRfQklUKSkgeworCQlyZXQgPSB2ZWdhMjBfc2V0
X3NpbmdsZV9kcG1fdGFibGUoc211LCBzaW5nbGVfZHBtX3RhYmxlLCBQUENMS19WQ0xLKTsKKwkJ
aWYgKHJldCkgeworCQkJcHJfZXJyKCJbU2V0dXBEZWZhdWx0RHBtVGFibGVdIGZhaWxlZCB0byBn
ZXQgdmNsayBkcG0gbGV2ZWxzISIpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCX0gZWxzZSB7CisJ
CXNpbmdsZV9kcG1fdGFibGUtPmNvdW50ID0gMTsKKwkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX2xl
dmVsc1swXS52YWx1ZSA9IHNtdS0+c211X3RhYmxlLmJvb3RfdmFsdWVzLnZjbGsgLyAxMDA7CisJ
fQorCXZlZ2EyMF9pbml0X3NpbmdsZV9kcG1fc3RhdGUoJihzaW5nbGVfZHBtX3RhYmxlLT5kcG1f
c3RhdGUpKTsKKworCS8qIGRjbGsgKi8KKwlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUt
PmRjbGtfdGFibGUpOworCisJaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVB
VFVSRV9EUE1fVVZEX0JJVCkpIHsKKwkJcmV0ID0gdmVnYTIwX3NldF9zaW5nbGVfZHBtX3RhYmxl
KHNtdSwgc2luZ2xlX2RwbV90YWJsZSwgUFBDTEtfRENMSyk7CisJCWlmIChyZXQpIHsKKwkJCXBy
X2VycigiW1NldHVwRGVmYXVsdERwbVRhYmxlXSBmYWlsZWQgdG8gZ2V0IGRjbGsgZHBtIGxldmVs
cyEiKTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9IGVsc2UgeworCQlzaW5nbGVfZHBtX3RhYmxl
LT5jb3VudCA9IDE7CisJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWUgPSBz
bXUtPnNtdV90YWJsZS5ib290X3ZhbHVlcy5kY2xrIC8gMTAwOworCX0KKwl2ZWdhMjBfaW5pdF9z
aW5nbGVfZHBtX3N0YXRlKCYoc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlKSk7CisKKwkvKiBk
Y2VmY2xrICovCisJc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5kY2VmX3RhYmxlKTsK
KworCWlmIChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX0RDRUZD
TEtfQklUKSkgeworCQlyZXQgPSB2ZWdhMjBfc2V0X3NpbmdsZV9kcG1fdGFibGUoc211LCBzaW5n
bGVfZHBtX3RhYmxlLAorCQkJCQkJICBQUENMS19EQ0VGQ0xLKTsKKwkJaWYgKHJldCkgeworCQkJ
cHJfZXJyKCJbU2V0dXBEZWZhdWx0RHBtVGFibGVdIGZhaWxlZCB0byBnZXQgZGNlZmNsayBkcG0g
bGV2ZWxzISIpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCX0gZWxzZSB7CisJCXNpbmdsZV9kcG1f
dGFibGUtPmNvdW50ID0gMTsKKwkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1
ZSA9IHNtdS0+c211X3RhYmxlLmJvb3RfdmFsdWVzLmRjZWZjbGsgLyAxMDA7CisJfQorCXZlZ2Ey
MF9pbml0X3NpbmdsZV9kcG1fc3RhdGUoJihzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUpKTsK
KworCS8qIHBpeGNsayAqLworCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+cGl4ZWxf
dGFibGUpOworCisJaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9E
UE1fRENFRkNMS19CSVQpKSB7CisJCXJldCA9IHZlZ2EyMF9zZXRfc2luZ2xlX2RwbV90YWJsZShz
bXUsIHNpbmdsZV9kcG1fdGFibGUsCisJCQkJCQkgIFBQQ0xLX1BJWENMSyk7CisJCWlmIChyZXQp
IHsKKwkJCXByX2VycigiW1NldHVwRGVmYXVsdERwbVRhYmxlXSBmYWlsZWQgdG8gZ2V0IHBpeGNs
ayBkcG0gbGV2ZWxzISIpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCX0gZWxzZSB7CisJCXNpbmds
ZV9kcG1fdGFibGUtPmNvdW50ID0gMDsKKwl9CisJdmVnYTIwX2luaXRfc2luZ2xlX2RwbV9zdGF0
ZSgmKHNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZSkpOworCisJLyogZGlzcGNsayAqLworCXNp
bmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+ZGlzcGxheV90YWJsZSk7CisKKwlpZiAoc211
X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9EQ0VGQ0xLX0JJVCkpIHsK
KwkJcmV0ID0gdmVnYTIwX3NldF9zaW5nbGVfZHBtX3RhYmxlKHNtdSwgc2luZ2xlX2RwbV90YWJs
ZSwKKwkJCQkJCSAgUFBDTEtfRElTUENMSyk7CisJCWlmIChyZXQpIHsKKwkJCXByX2VycigiW1Nl
dHVwRGVmYXVsdERwbVRhYmxlXSBmYWlsZWQgdG8gZ2V0IGRpc3BjbGsgZHBtIGxldmVscyEiKTsK
KwkJCXJldHVybiByZXQ7CisJCX0KKwl9IGVsc2UgeworCQlzaW5nbGVfZHBtX3RhYmxlLT5jb3Vu
dCA9IDA7CisJfQorCXZlZ2EyMF9pbml0X3NpbmdsZV9kcG1fc3RhdGUoJihzaW5nbGVfZHBtX3Rh
YmxlLT5kcG1fc3RhdGUpKTsKKworCS8qIHBoeWNsayAqLworCXNpbmdsZV9kcG1fdGFibGUgPSAm
KGRwbV90YWJsZS0+cGh5X3RhYmxlKTsKKworCWlmIChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNt
dSwgU01VX0ZFQVRVUkVfRFBNX0RDRUZDTEtfQklUKSkgeworCQlyZXQgPSB2ZWdhMjBfc2V0X3Np
bmdsZV9kcG1fdGFibGUoc211LCBzaW5nbGVfZHBtX3RhYmxlLAorCQkJCQkJICBQUENMS19QSFlD
TEspOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIltTZXR1cERlZmF1bHREcG1UYWJsZV0gZmFp
bGVkIHRvIGdldCBwaHljbGsgZHBtIGxldmVscyEiKTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9
IGVsc2UgeworCQlzaW5nbGVfZHBtX3RhYmxlLT5jb3VudCA9IDA7CisJfQorCXZlZ2EyMF9pbml0
X3NpbmdsZV9kcG1fc3RhdGUoJihzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUpKTsKKworCS8q
IGZjbGsgKi8KKwlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPmZjbGtfdGFibGUpOwor
CisJaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LEZFQVRVUkVfRFBNX0ZDTEtfQklUKSkg
eworCQlyZXQgPSB2ZWdhMjBfc2V0X3NpbmdsZV9kcG1fdGFibGUoc211LCBzaW5nbGVfZHBtX3Rh
YmxlLAorCQkJCQkJICBQUENMS19GQ0xLKTsKKwkJaWYgKHJldCkgeworCQkJcHJfZXJyKCJbU2V0
dXBEZWZhdWx0RHBtVGFibGVdIGZhaWxlZCB0byBnZXQgZmNsayBkcG0gbGV2ZWxzISIpOworCQkJ
cmV0dXJuIHJldDsKKwkJfQorCX0gZWxzZSB7CisJCXNpbmdsZV9kcG1fdGFibGUtPmNvdW50ID0g
MDsKKwl9CisJdmVnYTIwX2luaXRfc2luZ2xlX2RwbV9zdGF0ZSgmKHNpbmdsZV9kcG1fdGFibGUt
PmRwbV9zdGF0ZSkpOworCisJbWVtY3B5KHNtdV9kcG0tPmdvbGRlbl9kcG1fY29udGV4dCwgZHBt
X3RhYmxlLAorCSAgICAgICBzaXplb2Yoc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUpKTsKKworCXJl
dHVybiAwOworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9wb3B1bGF0ZV91bWRfc3RhdGVfY2xrKHN0
cnVjdCBzbXVfY29udGV4dCAqc211KQoreworCXN0cnVjdCBzbXVfZHBtX2NvbnRleHQgKnNtdV9k
cG0gPSAmc211LT5zbXVfZHBtOworCXN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICpkcG1fdGFibGUg
PSBOVUxMOworCXN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAqZ2Z4X3RhYmxlID0gTlVM
TDsKKwlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgKm1lbV90YWJsZSA9IE5VTEw7CisK
KwlkcG1fdGFibGUgPSBzbXVfZHBtLT5kcG1fY29udGV4dDsKKwlnZnhfdGFibGUgPSAmKGRwbV90
YWJsZS0+Z2Z4X3RhYmxlKTsKKwltZW1fdGFibGUgPSAmKGRwbV90YWJsZS0+bWVtX3RhYmxlKTsK
KworCXNtdS0+cHN0YXRlX3NjbGsgPSBnZnhfdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWU7CisJ
c211LT5wc3RhdGVfbWNsayA9IG1lbV90YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1ZTsKKworCWlm
IChnZnhfdGFibGUtPmNvdW50ID4gVkVHQTIwX1VNRF9QU1RBVEVfR0ZYQ0xLX0xFVkVMICYmCisJ
ICAgIG1lbV90YWJsZS0+Y291bnQgPiBWRUdBMjBfVU1EX1BTVEFURV9NQ0xLX0xFVkVMKSB7CisJ
CXNtdS0+cHN0YXRlX3NjbGsgPSBnZnhfdGFibGUtPmRwbV9sZXZlbHNbVkVHQTIwX1VNRF9QU1RB
VEVfR0ZYQ0xLX0xFVkVMXS52YWx1ZTsKKwkJc211LT5wc3RhdGVfbWNsayA9IG1lbV90YWJsZS0+
ZHBtX2xldmVsc1tWRUdBMjBfVU1EX1BTVEFURV9NQ0xLX0xFVkVMXS52YWx1ZTsKKwl9CisKKwlz
bXUtPnBzdGF0ZV9zY2xrID0gc211LT5wc3RhdGVfc2NsayAqIDEwMDsKKwlzbXUtPnBzdGF0ZV9t
Y2xrID0gc211LT5wc3RhdGVfbWNsayAqIDEwMDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMg
aW50IHZlZ2EyMF9nZXRfY2xrX3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAorCQkJc3Ry
dWN0IHBwX2Nsb2NrX2xldmVsc193aXRoX2xhdGVuY3kgKmNsb2NrcywKKwkJCXN0cnVjdCB2ZWdh
MjBfc2luZ2xlX2RwbV90YWJsZSAqZHBtX3RhYmxlKQoreworCWludCBpLCBjb3VudDsKKworCWNv
dW50ID0gKGRwbV90YWJsZS0+Y291bnQgPiBNQVhfTlVNX0NMT0NLUykgPyBNQVhfTlVNX0NMT0NL
UyA6IGRwbV90YWJsZS0+Y291bnQ7CisJY2xvY2tzLT5udW1fbGV2ZWxzID0gY291bnQ7CisKKwlm
b3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykgeworCQljbG9ja3MtPmRhdGFbaV0uY2xvY2tzX2lu
X2toeiA9CisJCQlkcG1fdGFibGUtPmRwbV9sZXZlbHNbaV0udmFsdWUgKiAxMDAwOworCQljbG9j
a3MtPmRhdGFbaV0ubGF0ZW5jeV9pbl91cyA9IDA7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBpbnQgdmVnYTIwX3ByaW50X2Nsa19sZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUs
CisJCQllbnVtIHNtdV9jbGtfdHlwZSB0eXBlLCBjaGFyICpidWYpCit7CisJaW50IGksIG5vdywg
c2l6ZSA9IDA7CisJaW50IHJldCA9IDA7CisJdWludDMyX3QgZ2VuX3NwZWVkLCBsYW5lX3dpZHRo
OworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gc211LT5hZGV2OworCXN0cnVjdCBwcF9j
bG9ja19sZXZlbHNfd2l0aF9sYXRlbmN5IGNsb2NrczsKKwlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9k
cG1fdGFibGUgKnNpbmdsZV9kcG1fdGFibGU7CisJc3RydWN0IHNtdV90YWJsZV9jb250ZXh0ICp0
YWJsZV9jb250ZXh0ID0gJnNtdS0+c211X3RhYmxlOworCXN0cnVjdCBzbXVfZHBtX2NvbnRleHQg
KnNtdV9kcG0gPSAmc211LT5zbXVfZHBtOworCXN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICpkcG1f
dGFibGUgPSBOVUxMOworCXN0cnVjdCB2ZWdhMjBfb2Q4X3NldHRpbmdzICpvZDhfc2V0dGluZ3Mg
PQorCQkoc3RydWN0IHZlZ2EyMF9vZDhfc2V0dGluZ3MgKilzbXUtPm9kX3NldHRpbmdzOworCU92
ZXJEcml2ZVRhYmxlX3QgKm9kX3RhYmxlID0KKwkJKE92ZXJEcml2ZVRhYmxlX3QgKikodGFibGVf
Y29udGV4dC0+b3ZlcmRyaXZlX3RhYmxlKTsKKwlQUFRhYmxlX3QgKnBwdGFibGUgPSAoUFBUYWJs
ZV90ICopdGFibGVfY29udGV4dC0+ZHJpdmVyX3BwdGFibGU7CisKKwlkcG1fdGFibGUgPSBzbXVf
ZHBtLT5kcG1fY29udGV4dDsKKworCXN3aXRjaCAodHlwZSkgeworCWNhc2UgU01VX1NDTEs6CisJ
CXJldCA9IHNtdV9nZXRfY3VycmVudF9jbGtfZnJlcShzbXUsIFNNVV9HRlhDTEssICZub3cpOwor
CQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIkF0dGVtcHQgdG8gZ2V0IGN1cnJlbnQgZ2Z4IGNsayBG
YWlsZWQhIik7CisJCQlyZXR1cm4gcmV0OworCQl9CisKKwkJc2luZ2xlX2RwbV90YWJsZSA9ICYo
ZHBtX3RhYmxlLT5nZnhfdGFibGUpOworCQlyZXQgPSB2ZWdhMjBfZ2V0X2Nsa190YWJsZShzbXUs
ICZjbG9ja3MsIHNpbmdsZV9kcG1fdGFibGUpOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIkF0
dGVtcHQgdG8gZ2V0IGdmeCBjbGsgbGV2ZWxzIEZhaWxlZCEiKTsKKwkJCXJldHVybiByZXQ7CisJ
CX0KKworCQlmb3IgKGkgPSAwOyBpIDwgY2xvY2tzLm51bV9sZXZlbHM7IGkrKykKKwkJCXNpemUg
Kz0gc3ByaW50ZihidWYgKyBzaXplLCAiJWQ6ICV1TWh6ICVzXG4iLCBpLAorCQkJCQljbG9ja3Mu
ZGF0YVtpXS5jbG9ja3NfaW5fa2h6IC8gMTAwMCwKKwkJCQkJKGNsb2Nrcy5kYXRhW2ldLmNsb2Nr
c19pbl9raHogPT0gbm93ICogMTApCisJCQkJCT8gIioiIDogIiIpOworCQlicmVhazsKKworCWNh
c2UgU01VX01DTEs6CisJCXJldCA9IHNtdV9nZXRfY3VycmVudF9jbGtfZnJlcShzbXUsIFNNVV9V
Q0xLLCAmbm93KTsKKwkJaWYgKHJldCkgeworCQkJcHJfZXJyKCJBdHRlbXB0IHRvIGdldCBjdXJy
ZW50IG1jbGsgRmFpbGVkISIpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCisJCXNpbmdsZV9kcG1f
dGFibGUgPSAmKGRwbV90YWJsZS0+bWVtX3RhYmxlKTsKKwkJcmV0ID0gdmVnYTIwX2dldF9jbGtf
dGFibGUoc211LCAmY2xvY2tzLCBzaW5nbGVfZHBtX3RhYmxlKTsKKwkJaWYgKHJldCkgeworCQkJ
cHJfZXJyKCJBdHRlbXB0IHRvIGdldCBtZW1vcnkgY2xrIGxldmVscyBGYWlsZWQhIik7CisJCQly
ZXR1cm4gcmV0OworCQl9CisKKwkJZm9yIChpID0gMDsgaSA8IGNsb2Nrcy5udW1fbGV2ZWxzOyBp
KyspCisJCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIiVkOiAldU1oeiAlc1xuIiwKKwkJ
CQlpLCBjbG9ja3MuZGF0YVtpXS5jbG9ja3NfaW5fa2h6IC8gMTAwMCwKKwkJCQkoY2xvY2tzLmRh
dGFbaV0uY2xvY2tzX2luX2toeiA9PSBub3cgKiAxMCkKKwkJCQk/ICIqIiA6ICIiKTsKKwkJYnJl
YWs7CisKKwljYXNlIFNNVV9TT0NDTEs6CisJCXJldCA9IHNtdV9nZXRfY3VycmVudF9jbGtfZnJl
cShzbXUsIFBQQ0xLX1NPQ0NMSywgJm5vdyk7CisJCWlmIChyZXQpIHsKKwkJCXByX2VycigiQXR0
ZW1wdCB0byBnZXQgY3VycmVudCBzb2NjbGsgRmFpbGVkISIpOworCQkJcmV0dXJuIHJldDsKKwkJ
fQorCisJCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+c29jX3RhYmxlKTsKKwkJcmV0
ID0gdmVnYTIwX2dldF9jbGtfdGFibGUoc211LCAmY2xvY2tzLCBzaW5nbGVfZHBtX3RhYmxlKTsK
KwkJaWYgKHJldCkgeworCQkJcHJfZXJyKCJBdHRlbXB0IHRvIGdldCBzb2NjbGsgbGV2ZWxzIEZh
aWxlZCEiKTsKKwkJCXJldHVybiByZXQ7CisJCX0KKworCQlmb3IgKGkgPSAwOyBpIDwgY2xvY2tz
Lm51bV9sZXZlbHM7IGkrKykKKwkJCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiJWQ6ICV1
TWh6ICVzXG4iLAorCQkJCWksIGNsb2Nrcy5kYXRhW2ldLmNsb2Nrc19pbl9raHogLyAxMDAwLAor
CQkJCShjbG9ja3MuZGF0YVtpXS5jbG9ja3NfaW5fa2h6ID09IG5vdyAqIDEwKQorCQkJCT8gIioi
IDogIiIpOworCQlicmVhazsKKworCWNhc2UgU01VX0ZDTEs6CisJCXJldCA9IHNtdV9nZXRfY3Vy
cmVudF9jbGtfZnJlcShzbXUsIFBQQ0xLX0ZDTEssICZub3cpOworCQlpZiAocmV0KSB7CisJCQlw
cl9lcnIoIkF0dGVtcHQgdG8gZ2V0IGN1cnJlbnQgZmNsayBGYWlsZWQhIik7CisJCQlyZXR1cm4g
cmV0OworCQl9CisKKwkJc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5mY2xrX3RhYmxl
KTsKKwkJZm9yIChpID0gMDsgaSA8IHNpbmdsZV9kcG1fdGFibGUtPmNvdW50OyBpKyspCisJCQlz
aXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIiVkOiAldU1oeiAlc1xuIiwKKwkJCQlpLCBzaW5n
bGVfZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2ldLnZhbHVlLAorCQkJCShzaW5nbGVfZHBtX3RhYmxl
LT5kcG1fbGV2ZWxzW2ldLnZhbHVlID09IG5vdyAvIDEwMCkKKwkJCQk/ICIqIiA6ICIiKTsKKwkJ
YnJlYWs7CisKKwljYXNlIFNNVV9EQ0VGQ0xLOgorCQlyZXQgPSBzbXVfZ2V0X2N1cnJlbnRfY2xr
X2ZyZXEoc211LCBQUENMS19EQ0VGQ0xLLCAmbm93KTsKKwkJaWYgKHJldCkgeworCQkJcHJfZXJy
KCJBdHRlbXB0IHRvIGdldCBjdXJyZW50IGRjZWZjbGsgRmFpbGVkISIpOworCQkJcmV0dXJuIHJl
dDsKKwkJfQorCisJCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+ZGNlZl90YWJsZSk7
CisJCXJldCA9IHZlZ2EyMF9nZXRfY2xrX3RhYmxlKHNtdSwgJmNsb2Nrcywgc2luZ2xlX2RwbV90
YWJsZSk7CisJCWlmIChyZXQpIHsKKwkJCXByX2VycigiQXR0ZW1wdCB0byBnZXQgZGNlZmNsayBs
ZXZlbHMgRmFpbGVkISIpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCisJCWZvciAoaSA9IDA7IGkg
PCBjbG9ja3MubnVtX2xldmVsczsgaSsrKQorCQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUs
ICIlZDogJXVNaHogJXNcbiIsCisJCQkJaSwgY2xvY2tzLmRhdGFbaV0uY2xvY2tzX2luX2toeiAv
IDEwMDAsCisJCQkJKGNsb2Nrcy5kYXRhW2ldLmNsb2Nrc19pbl9raHogPT0gbm93ICogMTApID8g
IioiIDogIiIpOworCQlicmVhazsKKworCWNhc2UgU01VX1BDSUU6CisJCWdlbl9zcGVlZCA9IChS
UkVHMzJfUENJRShzbW5QQ0lFX0xDX1NQRUVEX0NOVEwpICYKKwkJCSAgICAgUFNXVVNQMF9QQ0lF
X0xDX1NQRUVEX0NOVExfX0xDX0NVUlJFTlRfREFUQV9SQVRFX01BU0spCisJCQk+PiBQU1dVU1Aw
X1BDSUVfTENfU1BFRURfQ05UTF9fTENfQ1VSUkVOVF9EQVRBX1JBVEVfX1NISUZUOworCQlsYW5l
X3dpZHRoID0gKFJSRUczMl9QQ0lFKHNtblBDSUVfTENfTElOS19XSURUSF9DTlRMKSAmCisJCQkg
ICAgICBQQ0lFX0xDX0xJTktfV0lEVEhfQ05UTF9fTENfTElOS19XSURUSF9SRF9NQVNLKQorCQkJ
Pj4gUENJRV9MQ19MSU5LX1dJRFRIX0NOVExfX0xDX0xJTktfV0lEVEhfUkRfX1NISUZUOworCQlm
b3IgKGkgPSAwOyBpIDwgTlVNX0xJTktfTEVWRUxTOyBpKyspCisJCQlzaXplICs9IHNwcmludGYo
YnVmICsgc2l6ZSwgIiVkOiAlcyAlcyAlZE1oeiAlc1xuIiwgaSwKKwkJCQkJKHBwdGFibGUtPlBj
aWVHZW5TcGVlZFtpXSA9PSAwKSA/ICIyLjVHVC9zLCIgOgorCQkJCQkocHB0YWJsZS0+UGNpZUdl
blNwZWVkW2ldID09IDEpID8gIjUuMEdUL3MsIiA6CisJCQkJCShwcHRhYmxlLT5QY2llR2VuU3Bl
ZWRbaV0gPT0gMikgPyAiOC4wR1QvcywiIDoKKwkJCQkJKHBwdGFibGUtPlBjaWVHZW5TcGVlZFtp
XSA9PSAzKSA/ICIxNi4wR1QvcywiIDogIiIsCisJCQkJCShwcHRhYmxlLT5QY2llTGFuZUNvdW50
W2ldID09IDEpID8gIngxIiA6CisJCQkJCShwcHRhYmxlLT5QY2llTGFuZUNvdW50W2ldID09IDIp
ID8gIngyIiA6CisJCQkJCShwcHRhYmxlLT5QY2llTGFuZUNvdW50W2ldID09IDMpID8gIng0IiA6
CisJCQkJCShwcHRhYmxlLT5QY2llTGFuZUNvdW50W2ldID09IDQpID8gIng4IiA6CisJCQkJCShw
cHRhYmxlLT5QY2llTGFuZUNvdW50W2ldID09IDUpID8gIngxMiIgOgorCQkJCQkocHB0YWJsZS0+
UGNpZUxhbmVDb3VudFtpXSA9PSA2KSA/ICJ4MTYiIDogIiIsCisJCQkJCXBwdGFibGUtPkxjbGtG
cmVxW2ldLAorCQkJCQkoZ2VuX3NwZWVkID09IHBwdGFibGUtPlBjaWVHZW5TcGVlZFtpXSkgJiYK
KwkJCQkJKGxhbmVfd2lkdGggPT0gcHB0YWJsZS0+UGNpZUxhbmVDb3VudFtpXSkgPworCQkJCQki
KiIgOiAiIik7CisJCWJyZWFrOworCisJY2FzZSBTTVVfT0RfU0NMSzoKKwkJaWYgKG9kOF9zZXR0
aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUlOXS5mZWF0dXJl
X2lkICYmCisJCSAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElO
R19HRlhDTEtfRk1BWF0uZmVhdHVyZV9pZCkgeworCQkJc2l6ZSA9IHNwcmludGYoYnVmLCAiJXM6
XG4iLCAiT0RfU0NMSyIpOworCQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIwOiAlMTB1
TWh6XG4iLAorCQkJCQlvZF90YWJsZS0+R2Z4Y2xrRm1pbik7CisJCQlzaXplICs9IHNwcmludGYo
YnVmICsgc2l6ZSwgIjE6ICUxMHVNaHpcbiIsCisJCQkJCW9kX3RhYmxlLT5HZnhjbGtGbWF4KTsK
KwkJfQorCisJCWJyZWFrOworCisJY2FzZSBTTVVfT0RfTUNMSzoKKwkJaWYgKG9kOF9zZXR0aW5n
cy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX1VDTEtfRk1BWF0uZmVhdHVyZV9pZCkg
eworCQkJc2l6ZSA9IHNwcmludGYoYnVmLCAiJXM6XG4iLCAiT0RfTUNMSyIpOworCQkJc2l6ZSAr
PSBzcHJpbnRmKGJ1ZiArIHNpemUsICIxOiAlMTB1TWh6XG4iLAorCQkJCQkgb2RfdGFibGUtPlVj
bGtGbWF4KTsKKwkJfQorCisJCWJyZWFrOworCisJY2FzZSBTTVVfT0RfVkREQ19DVVJWRToKKwkJ
aWYgKG9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19G
UkVRMV0uZmVhdHVyZV9pZCAmJgorCQkgICAgb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJy
YXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVEyXS5mZWF0dXJlX2lkICYmCisJCSAgICBvZDhfc2V0
dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRlJFUTNdLmZlYXR1
cmVfaWQgJiYKKwkJICAgIG9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRU
SU5HX0dGWENMS19WT0xUQUdFMV0uZmVhdHVyZV9pZCAmJgorCQkgICAgb2Q4X3NldHRpbmdzLT5v
ZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UyXS5mZWF0dXJlX2lk
ICYmCisJCSAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19H
RlhDTEtfVk9MVEFHRTNdLmZlYXR1cmVfaWQpIHsKKwkJCXNpemUgPSBzcHJpbnRmKGJ1ZiwgIiVz
OlxuIiwgIk9EX1ZERENfQ1VSVkUiKTsKKwkJCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAi
MDogJTEwdU1oeiAlMTBkbVZcbiIsCisJCQkJCW9kX3RhYmxlLT5HZnhjbGtGcmVxMSwKKwkJCQkJ
b2RfdGFibGUtPkdmeGNsa1ZvbHQxIC8gVk9MVEFHRV9TQ0FMRSk7CisJCQlzaXplICs9IHNwcmlu
dGYoYnVmICsgc2l6ZSwgIjE6ICUxMHVNaHogJTEwZG1WXG4iLAorCQkJCQlvZF90YWJsZS0+R2Z4
Y2xrRnJlcTIsCisJCQkJCW9kX3RhYmxlLT5HZnhjbGtWb2x0MiAvIFZPTFRBR0VfU0NBTEUpOwor
CQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIyOiAlMTB1TWh6ICUxMGRtVlxuIiwKKwkJ
CQkJb2RfdGFibGUtPkdmeGNsa0ZyZXEzLAorCQkJCQlvZF90YWJsZS0+R2Z4Y2xrVm9sdDMgLyBW
T0xUQUdFX1NDQUxFKTsKKwkJfQorCisJCWJyZWFrOworCisJY2FzZSBTTVVfT0RfUkFOR0U6CisJ
CXNpemUgPSBzcHJpbnRmKGJ1ZiwgIiVzOlxuIiwgIk9EX1JBTkdFIik7CisKKwkJaWYgKG9kOF9z
ZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUlOXS5mZWF0
dXJlX2lkICYmCisJCSAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VU
VElOR19HRlhDTEtfRk1BWF0uZmVhdHVyZV9pZCkgeworCQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiAr
IHNpemUsICJTQ0xLOiAlN3VNaHogJTEwdU1oelxuIiwKKwkJCQkJb2Q4X3NldHRpbmdzLT5vZDhf
c2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZNSU5dLm1pbl92YWx1ZSwKKwkJCQkJ
b2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZNQVhd
Lm1heF92YWx1ZSk7CisJCX0KKworCQlpZiAob2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJy
YXlbT0Q4X1NFVFRJTkdfVUNMS19GTUFYXS5mZWF0dXJlX2lkKSB7CisJCQlzaW5nbGVfZHBtX3Rh
YmxlID0gJihkcG1fdGFibGUtPm1lbV90YWJsZSk7CisJCQlyZXQgPSB2ZWdhMjBfZ2V0X2Nsa190
YWJsZShzbXUsICZjbG9ja3MsIHNpbmdsZV9kcG1fdGFibGUpOworCQkJaWYgKHJldCkgeworCQkJ
CXByX2VycigiQXR0ZW1wdCB0byBnZXQgbWVtb3J5IGNsayBsZXZlbHMgRmFpbGVkISIpOworCQkJ
CXJldHVybiByZXQ7CisJCQl9CisKKwkJCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiTUNM
SzogJTd1TWh6ICUxMHVNaHpcbiIsCisJCQkJCWNsb2Nrcy5kYXRhWzBdLmNsb2Nrc19pbl9raHog
LyAxMDAwLAorCQkJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElO
R19VQ0xLX0ZNQVhdLm1heF92YWx1ZSk7CisJCX0KKworCQlpZiAob2Q4X3NldHRpbmdzLT5vZDhf
c2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVExXS5mZWF0dXJlX2lkICYmCisJ
CSAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtf
RlJFUTJdLmZlYXR1cmVfaWQgJiYKKwkJICAgIG9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2Fy
cmF5W09EOF9TRVRUSU5HX0dGWENMS19GUkVRM10uZmVhdHVyZV9pZCAmJgorCQkgICAgb2Q4X3Nl
dHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UxXS5m
ZWF0dXJlX2lkICYmCisJCSAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhf
U0VUVElOR19HRlhDTEtfVk9MVEFHRTJdLmZlYXR1cmVfaWQgJiYKKwkJICAgIG9kOF9zZXR0aW5n
cy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFM10uZmVhdHVy
ZV9pZCkgeworCQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICJWRERDX0NVUlZFX1NDTEtb
MF06ICU3dU1oeiAlMTB1TWh6XG4iLAorCQkJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19h
cnJheVtPRDhfU0VUVElOR19HRlhDTEtfRlJFUTFdLm1pbl92YWx1ZSwKKwkJCQkJb2Q4X3NldHRp
bmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVExXS5tYXhfdmFs
dWUpOworCQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICJWRERDX0NVUlZFX1ZPTFRbMF06
ICU3ZG1WICUxMWRtVlxuIiwKKwkJCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlb
T0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UxXS5taW5fdmFsdWUsCisJCQkJCW9kOF9zZXR0aW5n
cy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMV0ubWF4X3Zh
bHVlKTsKKwkJCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiVkREQ19DVVJWRV9TQ0xLWzFd
OiAlN3VNaHogJTEwdU1oelxuIiwKKwkJCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJy
YXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVEyXS5taW5fdmFsdWUsCisJCQkJCW9kOF9zZXR0aW5n
cy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GUkVRMl0ubWF4X3ZhbHVl
KTsKKwkJCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiVkREQ19DVVJWRV9WT0xUWzFdOiAl
N2RtViAlMTFkbVZcbiIsCisJCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09E
OF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMl0ubWluX3ZhbHVlLAorCQkJCQlvZDhfc2V0dGluZ3Mt
Pm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTJdLm1heF92YWx1
ZSk7CisJCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIlZERENfQ1VSVkVfU0NMS1syXTog
JTd1TWh6ICUxMHVNaHpcbiIsCisJCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5
W09EOF9TRVRUSU5HX0dGWENMS19GUkVRM10ubWluX3ZhbHVlLAorCQkJCQlvZDhfc2V0dGluZ3Mt
Pm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRlJFUTNdLm1heF92YWx1ZSk7
CisJCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIlZERENfQ1VSVkVfVk9MVFsyXTogJTdk
bVYgJTExZG1WXG4iLAorCQkJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhf
U0VUVElOR19HRlhDTEtfVk9MVEFHRTNdLm1pbl92YWx1ZSwKKwkJCQkJb2Q4X3NldHRpbmdzLT5v
ZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UzXS5tYXhfdmFsdWUp
OworCQl9CisKKwkJYnJlYWs7CisKKwlkZWZhdWx0OgorCQlicmVhazsKKwl9CisJcmV0dXJuIHNp
emU7Cit9CisKK3N0YXRpYyBpbnQgdmVnYTIwX3VwbG9hZF9kcG1fbGV2ZWwoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUsIGJvb2wgbWF4LAorCQkJCSAgIHVpbnQzMl90IGZlYXR1cmVfbWFzaykKK3sK
KwlzdHJ1Y3QgdmVnYTIwX2RwbV90YWJsZSAqZHBtX3RhYmxlOworCXN0cnVjdCB2ZWdhMjBfc2lu
Z2xlX2RwbV90YWJsZSAqc2luZ2xlX2RwbV90YWJsZTsKKwl1aW50MzJfdCBmcmVxOworCWludCBy
ZXQgPSAwOworCisJZHBtX3RhYmxlID0gc211LT5zbXVfZHBtLmRwbV9jb250ZXh0OworCisJaWYg
KHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fR0ZYQ0xLX0JJVCkg
JiYKKwkgICAgKGZlYXR1cmVfbWFzayAmIEZFQVRVUkVfRFBNX0dGWENMS19NQVNLKSkgeworCQlz
aW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPmdmeF90YWJsZSk7CisJCWZyZXEgPSBtYXgg
PyBzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgOgorCQkJc2luZ2xl
X2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsOworCQlyZXQgPSBzbXVfc2VuZF9z
bWNfbXNnX3dpdGhfcGFyYW0oc211LAorCQkJKG1heCA/IFNNVV9NU0dfU2V0U29mdE1heEJ5RnJl
cSA6IFNNVV9NU0dfU2V0U29mdE1pbkJ5RnJlcSksCisJCQkoUFBDTEtfR0ZYQ0xLIDw8IDE2KSB8
IChmcmVxICYgMHhmZmZmKSk7CisJCWlmIChyZXQpIHsKKwkJCXByX2VycigiRmFpbGVkIHRvIHNl
dCBzb2Z0ICVzIGdmeGNsayAhXG4iLAorCQkJCQkJbWF4ID8gIm1heCIgOiAibWluIik7CisJCQly
ZXR1cm4gcmV0OworCQl9CisJfQorCisJaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBT
TVVfRkVBVFVSRV9EUE1fVUNMS19CSVQpICYmCisJICAgIChmZWF0dXJlX21hc2sgJiBGRUFUVVJF
X0RQTV9VQ0xLX01BU0spKSB7CisJCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+bWVt
X3RhYmxlKTsKKwkJZnJlcSA9IG1heCA/IHNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0
X21heF9sZXZlbCA6CisJCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5fbGV2
ZWw7CisJCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsCisJCQkobWF4ID8g
U01VX01TR19TZXRTb2Z0TWF4QnlGcmVxIDogU01VX01TR19TZXRTb2Z0TWluQnlGcmVxKSwKKwkJ
CShQUENMS19VQ0xLIDw8IDE2KSB8IChmcmVxICYgMHhmZmZmKSk7CisJCWlmIChyZXQpIHsKKwkJ
CXByX2VycigiRmFpbGVkIHRvIHNldCBzb2Z0ICVzIG1lbWNsayAhXG4iLAorCQkJCQkJbWF4ID8g
Im1heCIgOiAibWluIik7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfQorCisJaWYgKHNtdV9mZWF0
dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fU09DQ0xLX0JJVCkgJiYKKwkgICAg
KGZlYXR1cmVfbWFzayAmIEZFQVRVUkVfRFBNX1NPQ0NMS19NQVNLKSkgeworCQlzaW5nbGVfZHBt
X3RhYmxlID0gJihkcG1fdGFibGUtPnNvY190YWJsZSk7CisJCWZyZXEgPSBtYXggPyBzaW5nbGVf
ZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgOgorCQkJc2luZ2xlX2RwbV90YWJs
ZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsOworCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dp
dGhfcGFyYW0oc211LAorCQkJKG1heCA/IFNNVV9NU0dfU2V0U29mdE1heEJ5RnJlcSA6IFNNVV9N
U0dfU2V0U29mdE1pbkJ5RnJlcSksCisJCQkoUFBDTEtfU09DQ0xLIDw8IDE2KSB8IChmcmVxICYg
MHhmZmZmKSk7CisJCWlmIChyZXQpIHsKKwkJCXByX2VycigiRmFpbGVkIHRvIHNldCBzb2Z0ICVz
IHNvY2NsayAhXG4iLAorCQkJCQkJbWF4ID8gIm1heCIgOiAibWluIik7CisJCQlyZXR1cm4gcmV0
OworCQl9CisJfQorCisJaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVS
RV9EUE1fRkNMS19CSVQpICYmCisJICAgIChmZWF0dXJlX21hc2sgJiBGRUFUVVJFX0RQTV9GQ0xL
X01BU0spKSB7CisJCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+ZmNsa190YWJsZSk7
CisJCWZyZXEgPSBtYXggPyBzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2
ZWwgOgorCQkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsOworCQly
ZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LAorCQkJKG1heCA/IFNNVV9NU0df
U2V0U29mdE1heEJ5RnJlcSA6IFNNVV9NU0dfU2V0U29mdE1pbkJ5RnJlcSksCisJCQkoUFBDTEtf
RkNMSyA8PCAxNikgfCAoZnJlcSAmIDB4ZmZmZikpOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIo
IkZhaWxlZCB0byBzZXQgc29mdCAlcyBmY2xrICFcbiIsCisJCQkJCQltYXggPyAibWF4IiA6ICJt
aW4iKTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9CisKKwlpZiAoc211X2ZlYXR1cmVfaXNfZW5h
YmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9EQ0VGQ0xLX0JJVCkgJiYKKwkgICAgKGZlYXR1cmVf
bWFzayAmIEZFQVRVUkVfRFBNX0RDRUZDTEtfTUFTSykpIHsKKwkJc2luZ2xlX2RwbV90YWJsZSA9
ICYoZHBtX3RhYmxlLT5kY2VmX3RhYmxlKTsKKwkJZnJlcSA9IHNpbmdsZV9kcG1fdGFibGUtPmRw
bV9zdGF0ZS5oYXJkX21pbl9sZXZlbDsKKwkJaWYgKCFtYXgpIHsKKwkJCXJldCA9IHNtdV9zZW5k
X3NtY19tc2dfd2l0aF9wYXJhbShzbXUsCisJCQkJU01VX01TR19TZXRIYXJkTWluQnlGcmVxLAor
CQkJCShQUENMS19EQ0VGQ0xLIDw8IDE2KSB8IChmcmVxICYgMHhmZmZmKSk7CisJCQlpZiAocmV0
KSB7CisJCQkJcHJfZXJyKCJGYWlsZWQgdG8gc2V0IGhhcmQgbWluIGRjZWZjbGsgIVxuIik7CisJ
CQkJcmV0dXJuIHJldDsKKwkJCX0KKwkJfQorCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRp
YyBpbnQgdmVnYTIwX2ZvcmNlX2Nsa19sZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCisJ
CQllbnVtICBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsIHVpbnQzMl90IG1hc2spCit7CisJc3RydWN0
IHZlZ2EyMF9kcG1fdGFibGUgKmRwbV90YWJsZTsKKwlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1f
dGFibGUgKnNpbmdsZV9kcG1fdGFibGU7CisJdWludDMyX3Qgc29mdF9taW5fbGV2ZWwsIHNvZnRf
bWF4X2xldmVsLCBoYXJkX21pbl9sZXZlbDsKKwlzdHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpzbXVf
ZHBtID0gJnNtdS0+c211X2RwbTsKKwlpbnQgcmV0ID0gMDsKKworCWlmIChzbXVfZHBtLT5kcG1f
bGV2ZWwgIT0gQU1EX0RQTV9GT1JDRURfTEVWRUxfTUFOVUFMKSB7CisJCXByX2luZm8oImZvcmNl
IGNsb2NrIGxldmVsIGlzIGZvciBkcG0gbWFudWFsIG1vZGUgb25seS5cbiIpOworCQlyZXR1cm4g
LUVJTlZBTDsKKwl9CisKKwltdXRleF9sb2NrKCYoc211LT5tdXRleCkpOworCisJc29mdF9taW5f
bGV2ZWwgPSBtYXNrID8gKGZmcyhtYXNrKSAtIDEpIDogMDsKKwlzb2Z0X21heF9sZXZlbCA9IG1h
c2sgPyAoZmxzKG1hc2spIC0gMSkgOiAwOworCisJZHBtX3RhYmxlID0gc211LT5zbXVfZHBtLmRw
bV9jb250ZXh0OworCisJc3dpdGNoIChjbGtfdHlwZSkgeworCWNhc2UgU01VX1NDTEs6CisJCXNp
bmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+Z2Z4X3RhYmxlKTsKKworCQlpZiAoc29mdF9t
YXhfbGV2ZWwgPj0gc2luZ2xlX2RwbV90YWJsZS0+Y291bnQpIHsKKwkJCXByX2VycigiQ2xvY2sg
bGV2ZWwgc3BlY2lmaWVkICVkIGlzIG92ZXIgbWF4IGFsbG93ZWQgJWRcbiIsCisJCQkJCXNvZnRf
bWF4X2xldmVsLCBzaW5nbGVfZHBtX3RhYmxlLT5jb3VudCAtIDEpOworCQkJcmV0ID0gLUVJTlZB
TDsKKwkJCWJyZWFrOworCQl9CisKKwkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRf
bWluX2xldmVsID0KKwkJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbc29mdF9taW5fbGV2
ZWxdLnZhbHVlOworCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwg
PQorCQkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX2xldmVsc1tzb2Z0X21heF9sZXZlbF0udmFsdWU7
CisKKwkJcmV0ID0gdmVnYTIwX3VwbG9hZF9kcG1fbGV2ZWwoc211LCBmYWxzZSwgRkVBVFVSRV9E
UE1fR0ZYQ0xLX01BU0spOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIkZhaWxlZCB0byB1cGxv
YWQgYm9vdCBsZXZlbCB0byBsb3dlc3QhXG4iKTsKKwkJCWJyZWFrOworCQl9CisKKwkJcmV0ID0g
dmVnYTIwX3VwbG9hZF9kcG1fbGV2ZWwoc211LCB0cnVlLCBGRUFUVVJFX0RQTV9HRlhDTEtfTUFT
Syk7CisJCWlmIChyZXQpCisJCQlwcl9lcnIoIkZhaWxlZCB0byB1cGxvYWQgZHBtIG1heCBsZXZl
bCB0byBoaWdoZXN0IVxuIik7CisKKwkJYnJlYWs7CisKKwljYXNlIFNNVV9NQ0xLOgorCQlzaW5n
bGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPm1lbV90YWJsZSk7CisKKwkJaWYgKHNvZnRfbWF4
X2xldmVsID49IHNpbmdsZV9kcG1fdGFibGUtPmNvdW50KSB7CisJCQlwcl9lcnIoIkNsb2NrIGxl
dmVsIHNwZWNpZmllZCAlZCBpcyBvdmVyIG1heCBhbGxvd2VkICVkXG4iLAorCQkJCQlzb2Z0X21h
eF9sZXZlbCwgc2luZ2xlX2RwbV90YWJsZS0+Y291bnQgLSAxKTsKKwkJCXJldCA9IC1FSU5WQUw7
CisJCQlicmVhazsKKwkJfQorCisJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21p
bl9sZXZlbCA9CisJCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW3NvZnRfbWluX2xldmVs
XS52YWx1ZTsKKwkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsID0K
KwkJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbc29mdF9tYXhfbGV2ZWxdLnZhbHVlOwor
CisJCXJldCA9IHZlZ2EyMF91cGxvYWRfZHBtX2xldmVsKHNtdSwgZmFsc2UsIEZFQVRVUkVfRFBN
X1VDTEtfTUFTSyk7CisJCWlmIChyZXQpIHsKKwkJCXByX2VycigiRmFpbGVkIHRvIHVwbG9hZCBi
b290IGxldmVsIHRvIGxvd2VzdCFcbiIpOworCQkJYnJlYWs7CisJCX0KKworCQlyZXQgPSB2ZWdh
MjBfdXBsb2FkX2RwbV9sZXZlbChzbXUsIHRydWUsIEZFQVRVUkVfRFBNX1VDTEtfTUFTSyk7CisJ
CWlmIChyZXQpCisJCQlwcl9lcnIoIkZhaWxlZCB0byB1cGxvYWQgZHBtIG1heCBsZXZlbCB0byBo
aWdoZXN0IVxuIik7CisKKwkJYnJlYWs7CisKKwljYXNlIFNNVV9TT0NDTEs6CisJCXNpbmdsZV9k
cG1fdGFibGUgPSAmKGRwbV90YWJsZS0+c29jX3RhYmxlKTsKKworCQlpZiAoc29mdF9tYXhfbGV2
ZWwgPj0gc2luZ2xlX2RwbV90YWJsZS0+Y291bnQpIHsKKwkJCXByX2VycigiQ2xvY2sgbGV2ZWwg
c3BlY2lmaWVkICVkIGlzIG92ZXIgbWF4IGFsbG93ZWQgJWRcbiIsCisJCQkJCXNvZnRfbWF4X2xl
dmVsLCBzaW5nbGVfZHBtX3RhYmxlLT5jb3VudCAtIDEpOworCQkJcmV0ID0gLUVJTlZBTDsKKwkJ
CWJyZWFrOworCQl9CisKKwkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xl
dmVsID0KKwkJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbc29mdF9taW5fbGV2ZWxdLnZh
bHVlOworCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgPQorCQkJ
c2luZ2xlX2RwbV90YWJsZS0+ZHBtX2xldmVsc1tzb2Z0X21heF9sZXZlbF0udmFsdWU7CisKKwkJ
cmV0ID0gdmVnYTIwX3VwbG9hZF9kcG1fbGV2ZWwoc211LCBmYWxzZSwgRkVBVFVSRV9EUE1fU09D
Q0xLX01BU0spOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIkZhaWxlZCB0byB1cGxvYWQgYm9v
dCBsZXZlbCB0byBsb3dlc3QhXG4iKTsKKwkJCWJyZWFrOworCQl9CisKKwkJcmV0ID0gdmVnYTIw
X3VwbG9hZF9kcG1fbGV2ZWwoc211LCB0cnVlLCBGRUFUVVJFX0RQTV9TT0NDTEtfTUFTSyk7CisJ
CWlmIChyZXQpCisJCQlwcl9lcnIoIkZhaWxlZCB0byB1cGxvYWQgZHBtIG1heCBsZXZlbCB0byBo
aWdoZXN0IVxuIik7CisKKwkJYnJlYWs7CisKKwljYXNlIFNNVV9GQ0xLOgorCQlzaW5nbGVfZHBt
X3RhYmxlID0gJihkcG1fdGFibGUtPmZjbGtfdGFibGUpOworCisJCWlmIChzb2Z0X21heF9sZXZl
bCA+PSBzaW5nbGVfZHBtX3RhYmxlLT5jb3VudCkgeworCQkJcHJfZXJyKCJDbG9jayBsZXZlbCBz
cGVjaWZpZWQgJWQgaXMgb3ZlciBtYXggYWxsb3dlZCAlZFxuIiwKKwkJCQkJc29mdF9tYXhfbGV2
ZWwsIHNpbmdsZV9kcG1fdGFibGUtPmNvdW50IC0gMSk7CisJCQlyZXQgPSAtRUlOVkFMOworCQkJ
YnJlYWs7CisJCX0KKworCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5fbGV2
ZWwgPQorCQkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX2xldmVsc1tzb2Z0X21pbl9sZXZlbF0udmFs
dWU7CisJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9CisJCQlz
aW5nbGVfZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW3NvZnRfbWF4X2xldmVsXS52YWx1ZTsKKworCQly
ZXQgPSB2ZWdhMjBfdXBsb2FkX2RwbV9sZXZlbChzbXUsIGZhbHNlLCBGRUFUVVJFX0RQTV9GQ0xL
X01BU0spOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIkZhaWxlZCB0byB1cGxvYWQgYm9vdCBs
ZXZlbCB0byBsb3dlc3QhXG4iKTsKKwkJCWJyZWFrOworCQl9CisKKwkJcmV0ID0gdmVnYTIwX3Vw
bG9hZF9kcG1fbGV2ZWwoc211LCB0cnVlLCBGRUFUVVJFX0RQTV9GQ0xLX01BU0spOworCQlpZiAo
cmV0KQorCQkJcHJfZXJyKCJGYWlsZWQgdG8gdXBsb2FkIGRwbSBtYXggbGV2ZWwgdG8gaGlnaGVz
dCFcbiIpOworCisJCWJyZWFrOworCisJY2FzZSBTTVVfRENFRkNMSzoKKwkJaGFyZF9taW5fbGV2
ZWwgPSBzb2Z0X21pbl9sZXZlbDsKKwkJc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5k
Y2VmX3RhYmxlKTsKKworCQlpZiAoaGFyZF9taW5fbGV2ZWwgPj0gc2luZ2xlX2RwbV90YWJsZS0+
Y291bnQpIHsKKwkJCXByX2VycigiQ2xvY2sgbGV2ZWwgc3BlY2lmaWVkICVkIGlzIG92ZXIgbWF4
IGFsbG93ZWQgJWRcbiIsCisJCQkJCWhhcmRfbWluX2xldmVsLCBzaW5nbGVfZHBtX3RhYmxlLT5j
b3VudCAtIDEpOworCQkJcmV0ID0gLUVJTlZBTDsKKwkJCWJyZWFrOworCQl9CisKKwkJc2luZ2xl
X2RwbV90YWJsZS0+ZHBtX3N0YXRlLmhhcmRfbWluX2xldmVsID0KKwkJCXNpbmdsZV9kcG1fdGFi
bGUtPmRwbV9sZXZlbHNbaGFyZF9taW5fbGV2ZWxdLnZhbHVlOworCisJCXJldCA9IHZlZ2EyMF91
cGxvYWRfZHBtX2xldmVsKHNtdSwgZmFsc2UsIEZFQVRVUkVfRFBNX0RDRUZDTEtfTUFTSyk7CisJ
CWlmIChyZXQpCisJCQlwcl9lcnIoIkZhaWxlZCB0byB1cGxvYWQgYm9vdCBsZXZlbCB0byBsb3dl
c3QhXG4iKTsKKworCQlicmVhazsKKworCWNhc2UgU01VX1BDSUU6CisJCWlmIChzb2Z0X21pbl9s
ZXZlbCA+PSBOVU1fTElOS19MRVZFTFMgfHwKKwkJICAgIHNvZnRfbWF4X2xldmVsID49IE5VTV9M
SU5LX0xFVkVMUykgeworCQkJcmV0ID0gLUVJTlZBTDsKKwkJCWJyZWFrOworCQl9CisKKwkJcmV0
ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwKKwkJCQlTTVVfTVNHX1NldE1pbkxp
bmtEcG1CeUluZGV4LCBzb2Z0X21pbl9sZXZlbCk7CisJCWlmIChyZXQpCisJCQlwcl9lcnIoIkZh
aWxlZCB0byBzZXQgbWluIGxpbmsgZHBtIGxldmVsIVxuIik7CisKKwkJYnJlYWs7CisKKwlkZWZh
dWx0OgorCQlicmVhazsKKwl9CisKKwltdXRleF91bmxvY2soJihzbXUtPm11dGV4KSk7CisJcmV0
dXJuIHJldDsKK30KKworc3RhdGljIGludCB2ZWdhMjBfZ2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF9s
YXRlbmN5KHN0cnVjdCBzbXVfY29udGV4dCAqc211LAorCQkJCQkJIGVudW0gc211X2Nsa190eXBl
IGNsa190eXBlLAorCQkJCQkJIHN0cnVjdCBwcF9jbG9ja19sZXZlbHNfd2l0aF9sYXRlbmN5ICpj
bG9ja3MpCit7CisJaW50IHJldDsKKwlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgKnNp
bmdsZV9kcG1fdGFibGU7CisJc3RydWN0IHNtdV9kcG1fY29udGV4dCAqc211X2RwbSA9ICZzbXUt
PnNtdV9kcG07CisJc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKmRwbV90YWJsZSA9IE5VTEw7CisK
KwlkcG1fdGFibGUgPSBzbXVfZHBtLT5kcG1fY29udGV4dDsKKworCW11dGV4X2xvY2soJnNtdS0+
bXV0ZXgpOworCisJc3dpdGNoIChjbGtfdHlwZSkgeworCWNhc2UgU01VX0dGWENMSzoKKwkJc2lu
Z2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5nZnhfdGFibGUpOworCQlyZXQgPSB2ZWdhMjBf
Z2V0X2Nsa190YWJsZShzbXUsIGNsb2Nrcywgc2luZ2xlX2RwbV90YWJsZSk7CisJCWJyZWFrOwor
CWNhc2UgU01VX01DTEs6CisJCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+bWVtX3Rh
YmxlKTsKKwkJcmV0ID0gdmVnYTIwX2dldF9jbGtfdGFibGUoc211LCBjbG9ja3MsIHNpbmdsZV9k
cG1fdGFibGUpOworCQlicmVhazsKKwljYXNlIFNNVV9EQ0VGQ0xLOgorCQlzaW5nbGVfZHBtX3Rh
YmxlID0gJihkcG1fdGFibGUtPmRjZWZfdGFibGUpOworCQlyZXQgPSB2ZWdhMjBfZ2V0X2Nsa190
YWJsZShzbXUsIGNsb2Nrcywgc2luZ2xlX2RwbV90YWJsZSk7CisJCWJyZWFrOworCWNhc2UgU01V
X1NPQ0NMSzoKKwkJc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5zb2NfdGFibGUpOwor
CQlyZXQgPSB2ZWdhMjBfZ2V0X2Nsa190YWJsZShzbXUsIGNsb2Nrcywgc2luZ2xlX2RwbV90YWJs
ZSk7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCXJldCA9IC1FSU5WQUw7CisJfQorCisJbXV0ZXhf
dW5sb2NrKCZzbXUtPm11dGV4KTsKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHZlZ2Ey
MF9vdmVyZHJpdmVfZ2V0X2dmeF9jbGtfYmFzZV92b2x0YWdlKHN0cnVjdCBzbXVfY29udGV4dCAq
c211LAorCQkJCQkJICAgICB1aW50MzJfdCAqdm9sdGFnZSwKKwkJCQkJCSAgICAgdWludDMyX3Qg
ZnJlcSkKK3sKKwlpbnQgcmV0OworCisJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFt
KHNtdSwKKwkJCVNNVV9NU0dfR2V0QVZGU1ZvbHRhZ2VCeURwbSwKKwkJCSgoQVZGU19DVVJWRSA8
PCAyNCkgfCAoT0Q4X0hPVENVUlZFX1RFTVBFUkFUVVJFIDw8IDE2KSB8IGZyZXEpKTsKKwlpZiAo
cmV0KSB7CisJCXByX2VycigiW0dldEJhc2VWb2x0YWdlXSBmYWlsZWQgdG8gZ2V0IEdGWENMSyBB
VkZTIHZvbHRhZ2UgZnJvbSBTTVUhIik7CisJCXJldHVybiByZXQ7CisJfQorCisJc211X3JlYWRf
c21jX2FyZyhzbXUsIHZvbHRhZ2UpOworCSp2b2x0YWdlID0gKnZvbHRhZ2UgLyBWT0xUQUdFX1ND
QUxFOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmVnYTIwX3NldF9kZWZhdWx0X29k
OF9zZXR0dGluZ3Moc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCit7CisJc3RydWN0IHNtdV90YWJs
ZV9jb250ZXh0ICp0YWJsZV9jb250ZXh0ID0gJnNtdS0+c211X3RhYmxlOworCU92ZXJEcml2ZVRh
YmxlX3QgKm9kX3RhYmxlID0gKE92ZXJEcml2ZVRhYmxlX3QgKikodGFibGVfY29udGV4dC0+b3Zl
cmRyaXZlX3RhYmxlKTsKKwlzdHJ1Y3QgdmVnYTIwX29kOF9zZXR0aW5ncyAqb2Q4X3NldHRpbmdz
ID0gTlVMTDsKKwlQUFRhYmxlX3QgKnNtY19wcHRhYmxlID0gdGFibGVfY29udGV4dC0+ZHJpdmVy
X3BwdGFibGU7CisJaW50IGksIHJldDsKKworCWlmIChzbXUtPm9kX3NldHRpbmdzKQorCQlyZXR1
cm4gLUVJTlZBTDsKKworCW9kOF9zZXR0aW5ncyA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCB2ZWdh
MjBfb2Q4X3NldHRpbmdzKSwgR0ZQX0tFUk5FTCk7CisKKwlpZiAob2Q4X3NldHRpbmdzKQorCQly
ZXR1cm4gLUVOT01FTTsKKworCXNtdS0+b2Rfc2V0dGluZ3MgPSAodm9pZCAqKW9kOF9zZXR0aW5n
czsKKworCWlmIChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX1NP
Q0NMS19CSVQpKSB7CisJCWlmIChvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVz
W0FUT01fVkVHQTIwX09ERkVBVFVSRV9HRlhDTEtfTElNSVRTXSAmJgorCQkgICAgb2Q4X3NldHRp
bmdzLT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZNQVhdID4gMCAmJgorCQkg
ICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZNSU5d
ID4gMCAmJgorCQkgICAgKG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5H
X0dGWENMS19GTUFYXSA+PQorCQkgICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09E
OF9TRVRUSU5HX0dGWENMS19GTUlOXSkpIHsKKwkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdz
X2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUlOXS5mZWF0dXJlX2lkID0KKwkJCQlPRDhfR0ZY
Q0xLX0xJTUlUUzsKKwkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRU
SU5HX0dGWENMS19GTUFYXS5mZWF0dXJlX2lkID0KKwkJCQlPRDhfR0ZYQ0xLX0xJTUlUUzsKKwkJ
CW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUlO
XS5kZWZhdWx0X3ZhbHVlID0KKwkJCQlvZF90YWJsZS0+R2Z4Y2xrRm1pbjsKKwkJCW9kOF9zZXR0
aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUFYXS5kZWZhdWx0
X3ZhbHVlID0KKwkJCQlvZF90YWJsZS0+R2Z4Y2xrRm1heDsKKwkJfQorCisJCWlmIChvZDhfc2V0
dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzW0FUT01fVkVHQTIwX09ERkVBVFVSRV9HRlhD
TEtfQ1VSVkVdICYmCisJCSAgICAob2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NF
VFRJTkdfR0ZYQ0xLX1ZPTFRBR0UxXSA+PQorCQkgICAgIHNtY19wcHRhYmxlLT5NaW5Wb2x0YWdl
R2Z4IC8gVk9MVEFHRV9TQ0FMRSkgJiYKKwkJICAgIChvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdz
X21heFtPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTNdIDw9CisJCSAgICAgc21jX3BwdGFibGUt
Pk1heFZvbHRhZ2VHZnggLyBWT0xUQUdFX1NDQUxFKSAmJgorCQkgICAgKG9kOF9zZXR0aW5ncy0+
b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMV0gPD0KKwkJICAgICBv
ZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21heFtPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTNd
KSkgeworCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZY
Q0xLX0ZSRVExXS5mZWF0dXJlX2lkID0KKwkJCQlPRDhfR0ZYQ0xLX0NVUlZFOworCQkJb2Q4X3Nl
dHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UxXS5m
ZWF0dXJlX2lkID0KKwkJCQlPRDhfR0ZYQ0xLX0NVUlZFOworCQkJb2Q4X3NldHRpbmdzLT5vZDhf
c2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVEyXS5mZWF0dXJlX2lkID0KKwkJ
CQlPRDhfR0ZYQ0xLX0NVUlZFOworCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlb
T0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UyXS5mZWF0dXJlX2lkID0KKwkJCQlPRDhfR0ZYQ0xL
X0NVUlZFOworCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdf
R0ZYQ0xLX0ZSRVEzXS5mZWF0dXJlX2lkID0KKwkJCQlPRDhfR0ZYQ0xLX0NVUlZFOworCQkJb2Q4
X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0Uz
XS5mZWF0dXJlX2lkID0KKwkJCQlPRDhfR0ZYQ0xLX0NVUlZFOworCisJCQlvZF90YWJsZS0+R2Z4
Y2xrRnJlcTEgPSBvZF90YWJsZS0+R2Z4Y2xrRm1pbjsKKwkJCW9kX3RhYmxlLT5HZnhjbGtGcmVx
MiA9IChvZF90YWJsZS0+R2Z4Y2xrRm1pbiArIG9kX3RhYmxlLT5HZnhjbGtGbWF4KSAvIDI7CisJ
CQlvZF90YWJsZS0+R2Z4Y2xrRnJlcTMgPSBvZF90YWJsZS0+R2Z4Y2xrRm1heDsKKwkJCW9kOF9z
ZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GUkVRMV0uZGVm
YXVsdF92YWx1ZSA9CisJCQkJb2RfdGFibGUtPkdmeGNsa0ZyZXExOworCQkJb2Q4X3NldHRpbmdz
LT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVEyXS5kZWZhdWx0X3Zh
bHVlID0KKwkJCQlvZF90YWJsZS0+R2Z4Y2xrRnJlcTI7CisJCQlvZDhfc2V0dGluZ3MtPm9kOF9z
ZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRlJFUTNdLmRlZmF1bHRfdmFsdWUgPQor
CQkJCW9kX3RhYmxlLT5HZnhjbGtGcmVxMzsKKworCQkJcmV0ID0gdmVnYTIwX292ZXJkcml2ZV9n
ZXRfZ2Z4X2Nsa19iYXNlX3ZvbHRhZ2Uoc211LAorCQkJCSZvZDhfc2V0dGluZ3MtPm9kOF9zZXR0
aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTFdLmRlZmF1bHRfdmFsdWUsCisJ
CQkJb2RfdGFibGUtPkdmeGNsa0ZyZXExKTsKKwkJCWlmIChyZXQpCisJCQkJb2Q4X3NldHRpbmdz
LT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UxXS5kZWZhdWx0
X3ZhbHVlID0gMDsKKwkJCW9kX3RhYmxlLT5HZnhjbGtWb2x0MSA9CisJCQkJb2Q4X3NldHRpbmdz
LT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UxXS5kZWZhdWx0
X3ZhbHVlCisJCQkJKiBWT0xUQUdFX1NDQUxFOworCQkJcmV0ID0gdmVnYTIwX292ZXJkcml2ZV9n
ZXRfZ2Z4X2Nsa19iYXNlX3ZvbHRhZ2Uoc211LAorCQkJCSZvZDhfc2V0dGluZ3MtPm9kOF9zZXR0
aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTJdLmRlZmF1bHRfdmFsdWUsCisJ
CQkJb2RfdGFibGUtPkdmeGNsa0ZyZXEyKTsKKwkJCWlmIChyZXQpCisJCQkJb2Q4X3NldHRpbmdz
LT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UyXS5kZWZhdWx0
X3ZhbHVlID0gMDsKKwkJCW9kX3RhYmxlLT5HZnhjbGtWb2x0MiA9CisJCQkJb2Q4X3NldHRpbmdz
LT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UyXS5kZWZhdWx0
X3ZhbHVlCisJCQkJKiBWT0xUQUdFX1NDQUxFOworCQkJcmV0ID0gdmVnYTIwX292ZXJkcml2ZV9n
ZXRfZ2Z4X2Nsa19iYXNlX3ZvbHRhZ2Uoc211LAorCQkJCSZvZDhfc2V0dGluZ3MtPm9kOF9zZXR0
aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTNdLmRlZmF1bHRfdmFsdWUsCisJ
CQkJb2RfdGFibGUtPkdmeGNsa0ZyZXEzKTsKKwkJCWlmIChyZXQpCisJCQkJb2Q4X3NldHRpbmdz
LT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UzXS5kZWZhdWx0
X3ZhbHVlID0gMDsKKwkJCW9kX3RhYmxlLT5HZnhjbGtWb2x0MyA9CisJCQkJb2Q4X3NldHRpbmdz
LT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UzXS5kZWZhdWx0
X3ZhbHVlCisJCQkJKiBWT0xUQUdFX1NDQUxFOworCQl9CisJfQorCisJaWYgKHNtdV9mZWF0dXJl
X2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVUNMS19CSVQpKSB7CisJCWlmIChvZDhf
c2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzW0FUT01fVkVHQTIwX09ERkVBVFVSRV9V
Q0xLX01BWF0gJiYKKwkJICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRU
SU5HX1VDTEtfRk1BWF0gPiAwICYmCisJCSAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21h
eFtPRDhfU0VUVElOR19VQ0xLX0ZNQVhdID4gMCAmJgorCQkgICAgKG9kOF9zZXR0aW5ncy0+b2Rf
c2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX1VDTEtfRk1BWF0gPj0KKwkJICAgICBvZDhfc2V0dGlu
Z3MtPm9kX3NldHRpbmdzX21pbltPRDhfU0VUVElOR19VQ0xLX0ZNQVhdKSkgeworCQkJb2Q4X3Nl
dHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfVUNMS19GTUFYXS5mZWF0dXJl
X2lkID0KKwkJCQlPRDhfVUNMS19NQVg7CisJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19h
cnJheVtPRDhfU0VUVElOR19VQ0xLX0ZNQVhdLmRlZmF1bHRfdmFsdWUgPQorCQkJCW9kX3RhYmxl
LT5VY2xrRm1heDsKKwkJfQorCX0KKworCWlmIChvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2Fw
YWJpbGl0aWVzW0FUT01fVkVHQTIwX09ERkVBVFVSRV9QT1dFUl9MSU1JVF0gJiYKKwkgICAgb2Q4
X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfUE9XRVJfUEVSQ0VOVEFHRV0g
PiAwICYmCisJICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX1BP
V0VSX1BFUkNFTlRBR0VdIDw9IDEwMCAmJgorCSAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdz
X21heFtPRDhfU0VUVElOR19QT1dFUl9QRVJDRU5UQUdFXSA+IDAgJiYKKwkgICAgb2Q4X3NldHRp
bmdzLT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfUE9XRVJfUEVSQ0VOVEFHRV0gPD0gMTAw
KSB7CisJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX1BPV0VS
X1BFUkNFTlRBR0VdLmZlYXR1cmVfaWQgPQorCQkJT0Q4X1BPV0VSX0xJTUlUOworCQlvZDhfc2V0
dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19QT1dFUl9QRVJDRU5UQUdFXS5k
ZWZhdWx0X3ZhbHVlID0KKwkJCW9kX3RhYmxlLT5PdmVyRHJpdmVQY3Q7CisJfQorCisJaWYgKHNt
dV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9GQU5fQ09OVFJPTF9CSVQpKSB7
CisJCWlmIChvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzW0FUT01fVkVHQTIw
X09ERkVBVFVSRV9GQU5fQUNPVVNUSUNfTElNSVRdICYmCisJCSAgICBvZDhfc2V0dGluZ3MtPm9k
X3NldHRpbmdzX21pbltPRDhfU0VUVElOR19GQU5fQUNPVVNUSUNfTElNSVRdID4gMCAmJgorCQkg
ICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfRkFOX0FDT1VTVElD
X0xJTUlUXSA+IDAgJiYKKwkJICAgIChvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21heFtPRDhf
U0VUVElOR19GQU5fQUNPVVNUSUNfTElNSVRdID49CisJCSAgICAgb2Q4X3NldHRpbmdzLT5vZF9z
ZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfRkFOX0FDT1VTVElDX0xJTUlUXSkpIHsKKwkJCW9kOF9z
ZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0ZBTl9BQ09VU1RJQ19MSU1J
VF0uZmVhdHVyZV9pZCA9CisJCQkJT0Q4X0FDT1VTVElDX0xJTUlUX1NDTEs7CisJCQlvZDhfc2V0
dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19GQU5fQUNPVVNUSUNfTElNSVRd
LmRlZmF1bHRfdmFsdWUgPQorCQkJCW9kX3RhYmxlLT5GYW5NYXhpbXVtUnBtOworCQl9CisKKwkJ
aWYgKG9kOF9zZXR0aW5ncy0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXNbQVRPTV9WRUdBMjBfT0RG
RUFUVVJFX0ZBTl9TUEVFRF9NSU5dICYmCisJCSAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdz
X21pbltPRDhfU0VUVElOR19GQU5fTUlOX1NQRUVEXSA+IDAgJiYKKwkJICAgIG9kOF9zZXR0aW5n
cy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX0ZBTl9NSU5fU1BFRURdID4gMCAmJgorCQkg
ICAgKG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX0ZBTl9NSU5fU1BF
RURdID49CisJCSAgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdf
RkFOX01JTl9TUEVFRF0pKSB7CisJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtP
RDhfU0VUVElOR19GQU5fTUlOX1NQRUVEXS5mZWF0dXJlX2lkID0KKwkJCQlPRDhfRkFOX1NQRUVE
X01JTjsKKwkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0ZB
Tl9NSU5fU1BFRURdLmRlZmF1bHRfdmFsdWUgPQorCQkJCW9kX3RhYmxlLT5GYW5NaW5pbXVtUHdt
ICogc21jX3BwdGFibGUtPkZhbk1heGltdW1ScG0gLyAxMDA7CisJCX0KKwl9CisKKwlpZiAoc211
X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX1RIRVJNQUxfQklUKSkgeworCQlp
ZiAob2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllc1tBVE9NX1ZFR0EyMF9PREZF
QVRVUkVfVEVNUEVSQVRVUkVfRkFOXSAmJgorCQkgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5n
c19taW5bT0Q4X1NFVFRJTkdfRkFOX1RBUkdFVF9URU1QXSA+IDAgJiYKKwkJICAgIG9kOF9zZXR0
aW5ncy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX0ZBTl9UQVJHRVRfVEVNUF0gPiAwICYm
CisJCSAgICAob2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfRkFOX1RB
UkdFVF9URU1QXSA+PQorCQkgICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09EOF9T
RVRUSU5HX0ZBTl9UQVJHRVRfVEVNUF0pKSB7CisJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5n
c19hcnJheVtPRDhfU0VUVElOR19GQU5fVEFSR0VUX1RFTVBdLmZlYXR1cmVfaWQgPQorCQkJCU9E
OF9URU1QRVJBVFVSRV9GQU47CisJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtP
RDhfU0VUVElOR19GQU5fVEFSR0VUX1RFTVBdLmRlZmF1bHRfdmFsdWUgPQorCQkJCW9kX3RhYmxl
LT5GYW5UYXJnZXRUZW1wZXJhdHVyZTsKKwkJfQorCisJCWlmIChvZDhfc2V0dGluZ3MtPm9kX2Zl
YXR1cmVfY2FwYWJpbGl0aWVzW0FUT01fVkVHQTIwX09ERkVBVFVSRV9URU1QRVJBVFVSRV9TWVNU
RU1dICYmCisJCSAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbltPRDhfU0VUVElOR19P
UEVSQVRJTkdfVEVNUF9NQVhdID4gMCAmJgorCQkgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5n
c19tYXhbT0Q4X1NFVFRJTkdfT1BFUkFUSU5HX1RFTVBfTUFYXSA+IDAgJiYKKwkJICAgIChvZDhf
c2V0dGluZ3MtPm9kX3NldHRpbmdzX21heFtPRDhfU0VUVElOR19PUEVSQVRJTkdfVEVNUF9NQVhd
ID49CisJCSAgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfT1BF
UkFUSU5HX1RFTVBfTUFYXSkpIHsKKwkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5
W09EOF9TRVRUSU5HX09QRVJBVElOR19URU1QX01BWF0uZmVhdHVyZV9pZCA9CisJCQkJT0Q4X1RF
TVBFUkFUVVJFX1NZU1RFTTsKKwkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09E
OF9TRVRUSU5HX09QRVJBVElOR19URU1QX01BWF0uZGVmYXVsdF92YWx1ZSA9CisJCQkJb2RfdGFi
bGUtPk1heE9wVGVtcDsKKwkJfQorCX0KKworCWZvciAoaSA9IDA7IGkgPCBPRDhfU0VUVElOR19D
T1VOVDsgaSsrKSB7CisJCWlmIChvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtpXS5m
ZWF0dXJlX2lkKSB7CisJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtpXS5taW5f
dmFsdWUgPQorCQkJCW9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW2ldOworCQkJb2Q4X3Nl
dHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbaV0ubWF4X3ZhbHVlID0KKwkJCQlvZDhfc2V0dGlu
Z3MtPm9kX3NldHRpbmdzX21heFtpXTsKKwkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2Fy
cmF5W2ldLmN1cnJlbnRfdmFsdWUgPQorCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2Fy
cmF5W2ldLmRlZmF1bHRfdmFsdWU7CisJCX0gZWxzZSB7CisJCQlvZDhfc2V0dGluZ3MtPm9kOF9z
ZXR0aW5nc19hcnJheVtpXS5taW5fdmFsdWUgPSAwOworCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0
dGluZ3NfYXJyYXlbaV0ubWF4X3ZhbHVlID0gMDsKKwkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRp
bmdzX2FycmF5W2ldLmN1cnJlbnRfdmFsdWUgPSAwOworCQl9CisJfQorCisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgdmVnYTIwX2dldF9tZXRyaWNzX3RhYmxlKHN0cnVjdCBzbXVfY29udGV4
dCAqc211LAorCQkJCSAgICBTbXVNZXRyaWNzX3QgKm1ldHJpY3NfdGFibGUpCit7CisJc3RydWN0
IHNtdV90YWJsZV9jb250ZXh0ICpzbXVfdGFibGU9ICZzbXUtPnNtdV90YWJsZTsKKwlpbnQgcmV0
ID0gMDsKKworCWlmICghc211X3RhYmxlLT5tZXRyaWNzX3RpbWUgfHwgdGltZV9hZnRlcihqaWZm
aWVzLCBzbXVfdGFibGUtPm1ldHJpY3NfdGltZSArIEhaIC8gMTAwMCkpIHsKKwkJcmV0ID0gc211
X3VwZGF0ZV90YWJsZShzbXUsIFNNVV9UQUJMRV9TTVVfTUVUUklDUywKKwkJCQkodm9pZCAqKXNt
dV90YWJsZS0+bWV0cmljc190YWJsZSwgZmFsc2UpOworCQlpZiAocmV0KSB7CisJCQlwcl9pbmZv
KCJGYWlsZWQgdG8gZXhwb3J0IFNNVSBtZXRyaWNzIHRhYmxlIVxuIik7CisJCQlyZXR1cm4gcmV0
OworCQl9CisJCXNtdV90YWJsZS0+bWV0cmljc190aW1lID0gamlmZmllczsKKwl9CisKKwltZW1j
cHkobWV0cmljc190YWJsZSwgc211X3RhYmxlLT5tZXRyaWNzX3RhYmxlLCBzaXplb2YoU211TWV0
cmljc190KSk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9zZXRfZGVm
YXVsdF9vZF9zZXR0aW5ncyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKKwkJCQkJICBib29sIGlu
aXRpYWxpemUpCit7CisJc3RydWN0IHNtdV90YWJsZV9jb250ZXh0ICp0YWJsZV9jb250ZXh0ID0g
JnNtdS0+c211X3RhYmxlOworCWludCByZXQ7CisKKwlpZiAoaW5pdGlhbGl6ZSkgeworCQlpZiAo
dGFibGVfY29udGV4dC0+b3ZlcmRyaXZlX3RhYmxlKQorCQkJcmV0dXJuIC1FSU5WQUw7CisKKwkJ
dGFibGVfY29udGV4dC0+b3ZlcmRyaXZlX3RhYmxlID0ga3phbGxvYyhzaXplb2YoT3ZlckRyaXZl
VGFibGVfdCksIEdGUF9LRVJORUwpOworCisJCWlmICghdGFibGVfY29udGV4dC0+b3ZlcmRyaXZl
X3RhYmxlKQorCQkJcmV0dXJuIC1FTk9NRU07CisKKwkJcmV0ID0gc211X3VwZGF0ZV90YWJsZShz
bXUsIFNNVV9UQUJMRV9PVkVSRFJJVkUsCisJCQkJICAgICAgIHRhYmxlX2NvbnRleHQtPm92ZXJk
cml2ZV90YWJsZSwgZmFsc2UpOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIkZhaWxlZCB0byBl
eHBvcnQgb3ZlciBkcml2ZSB0YWJsZSFcbiIpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCisJCXJl
dCA9IHZlZ2EyMF9zZXRfZGVmYXVsdF9vZDhfc2V0dHRpbmdzKHNtdSk7CisJCWlmIChyZXQpCisJ
CQlyZXR1cm4gcmV0OworCX0KKworCXJldCA9IHNtdV91cGRhdGVfdGFibGUoc211LCBTTVVfVEFC
TEVfT1ZFUkRSSVZFLAorCQkJICAgICAgIHRhYmxlX2NvbnRleHQtPm92ZXJkcml2ZV90YWJsZSwg
dHJ1ZSk7CisJaWYgKHJldCkgeworCQlwcl9lcnIoIkZhaWxlZCB0byBpbXBvcnQgb3ZlciBkcml2
ZSB0YWJsZSFcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldHVybiAwOworfQorCitzdGF0
aWMgaW50IHZlZ2EyMF9nZXRfb2RfcGVyY2VudGFnZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwK
KwkJCQkgICAgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUpCit7CisJc3RydWN0IHNtdV9kcG1f
Y29udGV4dCAqc211X2RwbSA9ICZzbXUtPnNtdV9kcG07CisJc3RydWN0IHZlZ2EyMF9kcG1fdGFi
bGUgKmRwbV90YWJsZSA9IE5VTEw7CisJc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKmdvbGRlbl90
YWJsZSA9IE5VTEw7CisJc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICpzaW5nbGVfZHBt
X3RhYmxlOworCXN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAqZ29sZGVuX2RwbV90YWJs
ZTsKKwlpbnQgdmFsdWUsIGdvbGRlbl92YWx1ZTsKKworCWRwbV90YWJsZSA9IHNtdV9kcG0tPmRw
bV9jb250ZXh0OworCWdvbGRlbl90YWJsZSA9IHNtdV9kcG0tPmdvbGRlbl9kcG1fY29udGV4dDsK
KworCXN3aXRjaCAoY2xrX3R5cGUpIHsKKwljYXNlIFNNVV9PRF9TQ0xLOgorCQlzaW5nbGVfZHBt
X3RhYmxlID0gJihkcG1fdGFibGUtPmdmeF90YWJsZSk7CisJCWdvbGRlbl9kcG1fdGFibGUgPSAm
KGdvbGRlbl90YWJsZS0+Z2Z4X3RhYmxlKTsKKwkJYnJlYWs7CisJY2FzZSBTTVVfT0RfTUNMSzoK
KwkJc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5tZW1fdGFibGUpOworCQlnb2xkZW5f
ZHBtX3RhYmxlID0gJihnb2xkZW5fdGFibGUtPm1lbV90YWJsZSk7CisJCWJyZWFrOworCWRlZmF1
bHQ6CisJCXJldHVybiAtRUlOVkFMOworCQlicmVhazsKKwl9CisKKwl2YWx1ZSA9IHNpbmdsZV9k
cG1fdGFibGUtPmRwbV9sZXZlbHNbc2luZ2xlX2RwbV90YWJsZS0+Y291bnQgLSAxXS52YWx1ZTsK
Kwlnb2xkZW5fdmFsdWUgPSBnb2xkZW5fZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2dvbGRlbl9kcG1f
dGFibGUtPmNvdW50IC0gMV0udmFsdWU7CisKKwl2YWx1ZSAtPSBnb2xkZW5fdmFsdWU7CisJdmFs
dWUgPSBESVZfUk9VTkRfVVAodmFsdWUgKiAxMDAsIGdvbGRlbl92YWx1ZSk7CisKKwlyZXR1cm4g
dmFsdWU7Cit9CisKK3N0YXRpYyBpbnQgdmVnYTIwX2dldF9wb3dlcl9wcm9maWxlX21vZGUoc3Ry
dWN0IHNtdV9jb250ZXh0ICpzbXUsIGNoYXIgKmJ1ZikKK3sKKwlEcG1BY3Rpdml0eU1vbml0b3JD
b2VmZkludF90IGFjdGl2aXR5X21vbml0b3I7CisJdWludDMyX3QgaSwgc2l6ZSA9IDA7CisJdWlu
dDE2X3Qgd29ya2xvYWRfdHlwZSA9IDA7CisJc3RhdGljIGNvbnN0IGNoYXIgKnByb2ZpbGVfbmFt
ZVtdID0geworCQkJCQkiQk9PVFVQX0RFRkFVTFQiLAorCQkJCQkiM0RfRlVMTF9TQ1JFRU4iLAor
CQkJCQkiUE9XRVJfU0FWSU5HIiwKKwkJCQkJIlZJREVPIiwKKwkJCQkJIlZSIiwKKwkJCQkJIkNP
TVBVVEUiLAorCQkJCQkiQ1VTVE9NIn07CisJc3RhdGljIGNvbnN0IGNoYXIgKnRpdGxlW10gPSB7
CisJCQkiUFJPRklMRV9JTkRFWChOQU1FKSIsCisJCQkiQ0xPQ0tfVFlQRShOQU1FKSIsCisJCQki
RlBTIiwKKwkJCSJVc2VSbGNCdXN5IiwKKwkJCSJNaW5BY3RpdmVGcmVxVHlwZSIsCisJCQkiTWlu
QWN0aXZlRnJlcSIsCisJCQkiQm9vc3RlckZyZXFUeXBlIiwKKwkJCSJCb29zdGVyRnJlcSIsCisJ
CQkiUERfRGF0YV9saW1pdF9jIiwKKwkJCSJQRF9EYXRhX2Vycm9yX2NvZWZmIiwKKwkJCSJQRF9E
YXRhX2Vycm9yX3JhdGVfY29lZmYifTsKKwlpbnQgcmVzdWx0ID0gMDsKKworCWlmICghc211LT5w
bV9lbmFibGVkIHx8ICFidWYpCisJCXJldHVybiAtRUlOVkFMOworCisJc2l6ZSArPSBzcHJpbnRm
KGJ1ZiArIHNpemUsICIlMTZzICVzICVzICVzICVzICVzICVzICVzICVzICVzICVzXG4iLAorCQkJ
dGl0bGVbMF0sIHRpdGxlWzFdLCB0aXRsZVsyXSwgdGl0bGVbM10sIHRpdGxlWzRdLCB0aXRsZVs1
XSwKKwkJCXRpdGxlWzZdLCB0aXRsZVs3XSwgdGl0bGVbOF0sIHRpdGxlWzldLCB0aXRsZVsxMF0p
OworCisJZm9yIChpID0gMDsgaSA8PSBQUF9TTUNfUE9XRVJfUFJPRklMRV9DVVNUT007IGkrKykg
eworCQkvKiBjb252IFBQX1NNQ19QT1dFUl9QUk9GSUxFKiB0byBXT1JLTE9BRF9QUExJQl8qX0JJ
VCAqLworCQl3b3JrbG9hZF90eXBlID0gc211X3dvcmtsb2FkX2dldF90eXBlKHNtdSwgaSk7CisJ
CXJlc3VsdCA9IHNtdV91cGRhdGVfdGFibGUoc211LAorCQkJCQkgIFNNVV9UQUJMRV9BQ1RJVklU
WV9NT05JVE9SX0NPRUZGIHwgd29ya2xvYWRfdHlwZSA8PCAxNiwKKwkJCQkJICAodm9pZCAqKSgm
YWN0aXZpdHlfbW9uaXRvciksIGZhbHNlKTsKKwkJaWYgKHJlc3VsdCkgeworCQkJcHJfZXJyKCJb
JXNdIEZhaWxlZCB0byBnZXQgYWN0aXZpdHkgbW9uaXRvciEiLCBfX2Z1bmNfXyk7CisJCQlyZXR1
cm4gcmVzdWx0OworCQl9CisKKwkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIlMmQgJTE0
cyVzOlxuIiwKKwkJCWksIHByb2ZpbGVfbmFtZVtpXSwgKGkgPT0gc211LT5wb3dlcl9wcm9maWxl
X21vZGUpID8gIioiIDogIiAiKTsKKworCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIiUx
OXMgJWQoJTEzcykgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2RcbiIsCisJCQki
ICIsCisJCQkwLAorCQkJIkdGWENMSyIsCisJCQlhY3Rpdml0eV9tb25pdG9yLkdmeF9GUFMsCisJ
CQlhY3Rpdml0eV9tb25pdG9yLkdmeF9Vc2VSbGNCdXN5LAorCQkJYWN0aXZpdHlfbW9uaXRvci5H
ZnhfTWluQWN0aXZlRnJlcVR5cGUsCisJCQlhY3Rpdml0eV9tb25pdG9yLkdmeF9NaW5BY3RpdmVG
cmVxLAorCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfQm9vc3RlckZyZXFUeXBlLAorCQkJYWN0aXZp
dHlfbW9uaXRvci5HZnhfQm9vc3RlckZyZXEsCisJCQlhY3Rpdml0eV9tb25pdG9yLkdmeF9QRF9E
YXRhX2xpbWl0X2MsCisJCQlhY3Rpdml0eV9tb25pdG9yLkdmeF9QRF9EYXRhX2Vycm9yX2NvZWZm
LAorCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfUERfRGF0YV9lcnJvcl9yYXRlX2NvZWZmKTsKKwor
CQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIiUxOXMgJWQoJTEzcykgJTdkICU3ZCAlN2Qg
JTdkICU3ZCAlN2QgJTdkICU3ZCAlN2RcbiIsCisJCQkiICIsCisJCQkxLAorCQkJIlNPQ0NMSyIs
CisJCQlhY3Rpdml0eV9tb25pdG9yLlNvY19GUFMsCisJCQlhY3Rpdml0eV9tb25pdG9yLlNvY19V
c2VSbGNCdXN5LAorCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfTWluQWN0aXZlRnJlcVR5cGUsCisJ
CQlhY3Rpdml0eV9tb25pdG9yLlNvY19NaW5BY3RpdmVGcmVxLAorCQkJYWN0aXZpdHlfbW9uaXRv
ci5Tb2NfQm9vc3RlckZyZXFUeXBlLAorCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfQm9vc3RlckZy
ZXEsCisJCQlhY3Rpdml0eV9tb25pdG9yLlNvY19QRF9EYXRhX2xpbWl0X2MsCisJCQlhY3Rpdml0
eV9tb25pdG9yLlNvY19QRF9EYXRhX2Vycm9yX2NvZWZmLAorCQkJYWN0aXZpdHlfbW9uaXRvci5T
b2NfUERfRGF0YV9lcnJvcl9yYXRlX2NvZWZmKTsKKworCQlzaXplICs9IHNwcmludGYoYnVmICsg
c2l6ZSwgIiUxOXMgJWQoJTEzcykgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2Rc
biIsCisJCQkiICIsCisJCQkyLAorCQkJIlVDTEsiLAorCQkJYWN0aXZpdHlfbW9uaXRvci5NZW1f
RlBTLAorCQkJYWN0aXZpdHlfbW9uaXRvci5NZW1fVXNlUmxjQnVzeSwKKwkJCWFjdGl2aXR5X21v
bml0b3IuTWVtX01pbkFjdGl2ZUZyZXFUeXBlLAorCQkJYWN0aXZpdHlfbW9uaXRvci5NZW1fTWlu
QWN0aXZlRnJlcSwKKwkJCWFjdGl2aXR5X21vbml0b3IuTWVtX0Jvb3N0ZXJGcmVxVHlwZSwKKwkJ
CWFjdGl2aXR5X21vbml0b3IuTWVtX0Jvb3N0ZXJGcmVxLAorCQkJYWN0aXZpdHlfbW9uaXRvci5N
ZW1fUERfRGF0YV9saW1pdF9jLAorCQkJYWN0aXZpdHlfbW9uaXRvci5NZW1fUERfRGF0YV9lcnJv
cl9jb2VmZiwKKwkJCWFjdGl2aXR5X21vbml0b3IuTWVtX1BEX0RhdGFfZXJyb3JfcmF0ZV9jb2Vm
Zik7CisKKwkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIlMTlzICVkKCUxM3MpICU3ZCAl
N2QgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkXG4iLAorCQkJIiAiLAorCQkJMywKKwkJCSJG
Q0xLIiwKKwkJCWFjdGl2aXR5X21vbml0b3IuRmNsa19GUFMsCisJCQlhY3Rpdml0eV9tb25pdG9y
LkZjbGtfVXNlUmxjQnVzeSwKKwkJCWFjdGl2aXR5X21vbml0b3IuRmNsa19NaW5BY3RpdmVGcmVx
VHlwZSwKKwkJCWFjdGl2aXR5X21vbml0b3IuRmNsa19NaW5BY3RpdmVGcmVxLAorCQkJYWN0aXZp
dHlfbW9uaXRvci5GY2xrX0Jvb3N0ZXJGcmVxVHlwZSwKKwkJCWFjdGl2aXR5X21vbml0b3IuRmNs
a19Cb29zdGVyRnJlcSwKKwkJCWFjdGl2aXR5X21vbml0b3IuRmNsa19QRF9EYXRhX2xpbWl0X2Ms
CisJCQlhY3Rpdml0eV9tb25pdG9yLkZjbGtfUERfRGF0YV9lcnJvcl9jb2VmZiwKKwkJCWFjdGl2
aXR5X21vbml0b3IuRmNsa19QRF9EYXRhX2Vycm9yX3JhdGVfY29lZmYpOworCX0KKworCXJldHVy
biBzaXplOworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9zZXRfcG93ZXJfcHJvZmlsZV9tb2RlKHN0
cnVjdCBzbXVfY29udGV4dCAqc211LCBsb25nICppbnB1dCwgdWludDMyX3Qgc2l6ZSkKK3sKKwlE
cG1BY3Rpdml0eU1vbml0b3JDb2VmZkludF90IGFjdGl2aXR5X21vbml0b3I7CisJaW50IHdvcmts
b2FkX3R5cGUgPSAwLCByZXQgPSAwOworCisJc211LT5wb3dlcl9wcm9maWxlX21vZGUgPSBpbnB1
dFtzaXplXTsKKworCWlmICghc211LT5wbV9lbmFibGVkKQorCQlyZXR1cm4gcmV0OworCWlmIChz
bXUtPnBvd2VyX3Byb2ZpbGVfbW9kZSA+IFBQX1NNQ19QT1dFUl9QUk9GSUxFX0NVU1RPTSkgewor
CQlwcl9lcnIoIkludmFsaWQgcG93ZXIgcHJvZmlsZSBtb2RlICVkXG4iLCBzbXUtPnBvd2VyX3By
b2ZpbGVfbW9kZSk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWlmIChzbXUtPnBvd2VyX3By
b2ZpbGVfbW9kZSA9PSBQUF9TTUNfUE9XRVJfUFJPRklMRV9DVVNUT00pIHsKKwkJcmV0ID0gc211
X3VwZGF0ZV90YWJsZShzbXUsCisJCQkJICAgICAgIFNNVV9UQUJMRV9BQ1RJVklUWV9NT05JVE9S
X0NPRUZGIHwgV09SS0xPQURfUFBMSUJfQ1VTVE9NX0JJVCA8PCAxNiwKKwkJCQkgICAgICAgKHZv
aWQgKikoJmFjdGl2aXR5X21vbml0b3IpLCBmYWxzZSk7CisJCWlmIChyZXQpIHsKKwkJCXByX2Vy
cigiWyVzXSBGYWlsZWQgdG8gZ2V0IGFjdGl2aXR5IG1vbml0b3IhIiwgX19mdW5jX18pOworCQkJ
cmV0dXJuIHJldDsKKwkJfQorCisJCXN3aXRjaCAoaW5wdXRbMF0pIHsKKwkJY2FzZSAwOiAvKiBH
ZnhjbGsgKi8KKwkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X0ZQUyA9IGlucHV0WzFdOworCQkJYWN0
aXZpdHlfbW9uaXRvci5HZnhfVXNlUmxjQnVzeSA9IGlucHV0WzJdOworCQkJYWN0aXZpdHlfbW9u
aXRvci5HZnhfTWluQWN0aXZlRnJlcVR5cGUgPSBpbnB1dFszXTsKKwkJCWFjdGl2aXR5X21vbml0
b3IuR2Z4X01pbkFjdGl2ZUZyZXEgPSBpbnB1dFs0XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuR2Z4
X0Jvb3N0ZXJGcmVxVHlwZSA9IGlucHV0WzVdOworCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfQm9v
c3RlckZyZXEgPSBpbnB1dFs2XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X1BEX0RhdGFfbGlt
aXRfYyA9IGlucHV0WzddOworCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfUERfRGF0YV9lcnJvcl9j
b2VmZiA9IGlucHV0WzhdOworCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfUERfRGF0YV9lcnJvcl9y
YXRlX2NvZWZmID0gaW5wdXRbOV07CisJCQlicmVhazsKKwkJY2FzZSAxOiAvKiBTb2NjbGsgKi8K
KwkJCWFjdGl2aXR5X21vbml0b3IuU29jX0ZQUyA9IGlucHV0WzFdOworCQkJYWN0aXZpdHlfbW9u
aXRvci5Tb2NfVXNlUmxjQnVzeSA9IGlucHV0WzJdOworCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2Nf
TWluQWN0aXZlRnJlcVR5cGUgPSBpbnB1dFszXTsKKwkJCWFjdGl2aXR5X21vbml0b3IuU29jX01p
bkFjdGl2ZUZyZXEgPSBpbnB1dFs0XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuU29jX0Jvb3N0ZXJG
cmVxVHlwZSA9IGlucHV0WzVdOworCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfQm9vc3RlckZyZXEg
PSBpbnB1dFs2XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuU29jX1BEX0RhdGFfbGltaXRfYyA9IGlu
cHV0WzddOworCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfUERfRGF0YV9lcnJvcl9jb2VmZiA9IGlu
cHV0WzhdOworCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfUERfRGF0YV9lcnJvcl9yYXRlX2NvZWZm
ID0gaW5wdXRbOV07CisJCQlicmVhazsKKwkJY2FzZSAyOiAvKiBVY2xrICovCisJCQlhY3Rpdml0
eV9tb25pdG9yLk1lbV9GUFMgPSBpbnB1dFsxXTsKKwkJCWFjdGl2aXR5X21vbml0b3IuTWVtX1Vz
ZVJsY0J1c3kgPSBpbnB1dFsyXTsKKwkJCWFjdGl2aXR5X21vbml0b3IuTWVtX01pbkFjdGl2ZUZy
ZXFUeXBlID0gaW5wdXRbM107CisJCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9NaW5BY3RpdmVGcmVx
ID0gaW5wdXRbNF07CisJCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9Cb29zdGVyRnJlcVR5cGUgPSBp
bnB1dFs1XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuTWVtX0Jvb3N0ZXJGcmVxID0gaW5wdXRbNl07
CisJCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9QRF9EYXRhX2xpbWl0X2MgPSBpbnB1dFs3XTsKKwkJ
CWFjdGl2aXR5X21vbml0b3IuTWVtX1BEX0RhdGFfZXJyb3JfY29lZmYgPSBpbnB1dFs4XTsKKwkJ
CWFjdGl2aXR5X21vbml0b3IuTWVtX1BEX0RhdGFfZXJyb3JfcmF0ZV9jb2VmZiA9IGlucHV0Wzld
OworCQkJYnJlYWs7CisJCWNhc2UgMzogLyogRmNsayAqLworCQkJYWN0aXZpdHlfbW9uaXRvci5G
Y2xrX0ZQUyA9IGlucHV0WzFdOworCQkJYWN0aXZpdHlfbW9uaXRvci5GY2xrX1VzZVJsY0J1c3kg
PSBpbnB1dFsyXTsKKwkJCWFjdGl2aXR5X21vbml0b3IuRmNsa19NaW5BY3RpdmVGcmVxVHlwZSA9
IGlucHV0WzNdOworCQkJYWN0aXZpdHlfbW9uaXRvci5GY2xrX01pbkFjdGl2ZUZyZXEgPSBpbnB1
dFs0XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuRmNsa19Cb29zdGVyRnJlcVR5cGUgPSBpbnB1dFs1
XTsKKwkJCWFjdGl2aXR5X21vbml0b3IuRmNsa19Cb29zdGVyRnJlcSA9IGlucHV0WzZdOworCQkJ
YWN0aXZpdHlfbW9uaXRvci5GY2xrX1BEX0RhdGFfbGltaXRfYyA9IGlucHV0WzddOworCQkJYWN0
aXZpdHlfbW9uaXRvci5GY2xrX1BEX0RhdGFfZXJyb3JfY29lZmYgPSBpbnB1dFs4XTsKKwkJCWFj
dGl2aXR5X21vbml0b3IuRmNsa19QRF9EYXRhX2Vycm9yX3JhdGVfY29lZmYgPSBpbnB1dFs5XTsK
KwkJCWJyZWFrOworCQl9CisKKwkJcmV0ID0gc211X3VwZGF0ZV90YWJsZShzbXUsCisJCQkJICAg
ICAgIFNNVV9UQUJMRV9BQ1RJVklUWV9NT05JVE9SX0NPRUZGIHwgV09SS0xPQURfUFBMSUJfQ1VT
VE9NX0JJVCA8PCAxNiwKKwkJCQkgICAgICAgKHZvaWQgKikoJmFjdGl2aXR5X21vbml0b3IpLCB0
cnVlKTsKKwkJaWYgKHJldCkgeworCQkJcHJfZXJyKCJbJXNdIEZhaWxlZCB0byBzZXQgYWN0aXZp
dHkgbW9uaXRvciEiLCBfX2Z1bmNfXyk7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfQorCisJLyog
Y29udiBQUF9TTUNfUE9XRVJfUFJPRklMRSogdG8gV09SS0xPQURfUFBMSUJfKl9CSVQgKi8KKwl3
b3JrbG9hZF90eXBlID0gc211X3dvcmtsb2FkX2dldF90eXBlKHNtdSwgc211LT5wb3dlcl9wcm9m
aWxlX21vZGUpOworCXNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfU2V0
V29ya2xvYWRNYXNrLAorCQkJCSAgICAxIDw8IHdvcmtsb2FkX3R5cGUpOworCisJcmV0dXJuIHJl
dDsKK30KKworc3RhdGljIGludAordmVnYTIwX2dldF9wcm9maWxpbmdfY2xrX21hc2soc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUsCisJCQkgICAgICBlbnVtIGFtZF9kcG1fZm9yY2VkX2xldmVsIGxl
dmVsLAorCQkJICAgICAgdWludDMyX3QgKnNjbGtfbWFzaywKKwkJCSAgICAgIHVpbnQzMl90ICpt
Y2xrX21hc2ssCisJCQkgICAgICB1aW50MzJfdCAqc29jX21hc2spCit7CisJc3RydWN0IHZlZ2Ey
MF9kcG1fdGFibGUgKmRwbV90YWJsZSA9IChzdHJ1Y3QgdmVnYTIwX2RwbV90YWJsZSAqKXNtdS0+
c211X2RwbS5kcG1fY29udGV4dDsKKwlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgKmdm
eF9kcG1fdGFibGU7CisJc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICptZW1fZHBtX3Rh
YmxlOworCXN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAqc29jX2RwbV90YWJsZTsKKwor
CWlmICghc211LT5zbXVfZHBtLmRwbV9jb250ZXh0KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWdm
eF9kcG1fdGFibGUgPSAmZHBtX3RhYmxlLT5nZnhfdGFibGU7CisJbWVtX2RwbV90YWJsZSA9ICZk
cG1fdGFibGUtPm1lbV90YWJsZTsKKwlzb2NfZHBtX3RhYmxlID0gJmRwbV90YWJsZS0+c29jX3Rh
YmxlOworCisJKnNjbGtfbWFzayA9IDA7CisJKm1jbGtfbWFzayA9IDA7CisJKnNvY19tYXNrICA9
IDA7CisKKwlpZiAoZ2Z4X2RwbV90YWJsZS0+Y291bnQgPiBWRUdBMjBfVU1EX1BTVEFURV9HRlhD
TEtfTEVWRUwgJiYKKwkgICAgbWVtX2RwbV90YWJsZS0+Y291bnQgPiBWRUdBMjBfVU1EX1BTVEFU
RV9NQ0xLX0xFVkVMICYmCisJICAgIHNvY19kcG1fdGFibGUtPmNvdW50ID4gVkVHQTIwX1VNRF9Q
U1RBVEVfU09DQ0xLX0xFVkVMKSB7CisJCSpzY2xrX21hc2sgPSBWRUdBMjBfVU1EX1BTVEFURV9H
RlhDTEtfTEVWRUw7CisJCSptY2xrX21hc2sgPSBWRUdBMjBfVU1EX1BTVEFURV9NQ0xLX0xFVkVM
OworCQkqc29jX21hc2sgID0gVkVHQTIwX1VNRF9QU1RBVEVfU09DQ0xLX0xFVkVMOworCX0KKwor
CWlmIChsZXZlbCA9PSBBTURfRFBNX0ZPUkNFRF9MRVZFTF9QUk9GSUxFX01JTl9TQ0xLKSB7CisJ
CSpzY2xrX21hc2sgPSAwOworCX0gZWxzZSBpZiAobGV2ZWwgPT0gQU1EX0RQTV9GT1JDRURfTEVW
RUxfUFJPRklMRV9NSU5fTUNMSykgeworCQkqbWNsa19tYXNrID0gMDsKKwl9IGVsc2UgaWYgKGxl
dmVsID09IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVfUEVBSykgeworCQkqc2Nsa19tYXNr
ID0gZ2Z4X2RwbV90YWJsZS0+Y291bnQgLSAxOworCQkqbWNsa19tYXNrID0gbWVtX2RwbV90YWJs
ZS0+Y291bnQgLSAxOworCQkqc29jX21hc2sgID0gc29jX2RwbV90YWJsZS0+Y291bnQgLSAxOwor
CX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50Cit2ZWdhMjBfc2V0X3VjbGtfdG9faGln
aGVzdF9kcG1fbGV2ZWwoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCisJCQkJICAgICBzdHJ1Y3Qg
dmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgKmRwbV90YWJsZSkKK3sKKwlpbnQgcmV0ID0gMDsKKwlz
dHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpzbXVfZHBtX2N0eCA9ICYoc211LT5zbXVfZHBtKTsKKwlp
ZiAoIXNtdV9kcG1fY3R4LT5kcG1fY29udGV4dCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlpZiAo
c211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9VQ0xLX0JJVCkpIHsK
KwkJaWYgKGRwbV90YWJsZS0+Y291bnQgPD0gMCkgeworCQkJcHJfZXJyKCJbJXNdIERwbSB0YWJs
ZSBoYXMgbm8gZW50cnkhIiwgX19mdW5jX18pOworCQkJCXJldHVybiAtRUlOVkFMOworCQl9CisK
KwkJaWYgKGRwbV90YWJsZS0+Y291bnQgPiBOVU1fVUNMS19EUE1fTEVWRUxTKSB7CisJCQlwcl9l
cnIoIlslc10gRHBtIHRhYmxlIGhhcyB0b28gbWFueSBlbnRyaWVzISIsIF9fZnVuY19fKTsKKwkJ
CQlyZXR1cm4gLUVJTlZBTDsKKwkJfQorCisJCWRwbV90YWJsZS0+ZHBtX3N0YXRlLmhhcmRfbWlu
X2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQgLSAxXS52YWx1
ZTsKKwkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwKKwkJCQlTTVVfTVNH
X1NldEhhcmRNaW5CeUZyZXEsCisJCQkJKFBQQ0xLX1VDTEsgPDwgMTYpIHwgZHBtX3RhYmxlLT5k
cG1fc3RhdGUuaGFyZF9taW5fbGV2ZWwpOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIlslc10g
U2V0IGhhcmQgbWluIHVjbGsgZmFpbGVkISIsIF9fZnVuY19fKTsKKwkJCQlyZXR1cm4gcmV0Owor
CQl9CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCB2ZWdhMjBfcHJlX2Rpc3Bs
YXlfY29uZmlnX2NoYW5nZWQoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCit7CisJaW50IHJldCA9
IDA7CisJc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKmRwbV90YWJsZSA9IHNtdS0+c211X2RwbS5k
cG1fY29udGV4dDsKKworCWlmICghc211LT5zbXVfZHBtLmRwbV9jb250ZXh0KQorCQlyZXR1cm4g
LUVJTlZBTDsKKworCXNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfTnVt
T2ZEaXNwbGF5cywgMCk7CisJcmV0ID0gdmVnYTIwX3NldF91Y2xrX3RvX2hpZ2hlc3RfZHBtX2xl
dmVsKHNtdSwKKwkJCQkJCSAgICZkcG1fdGFibGUtPm1lbV90YWJsZSk7CisJaWYgKHJldCkKKwkJ
cHJfZXJyKCJGYWlsZWQgdG8gc2V0IHVjbGsgdG8gaGlnaGVzdCBkcG0gbGV2ZWwiKTsKKwlyZXR1
cm4gcmV0OworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkKHN0
cnVjdCBzbXVfY29udGV4dCAqc211KQoreworCWludCByZXQgPSAwOworCisJaWYgKChzbXUtPndh
dGVybWFya3NfYml0bWFwICYgV0FURVJNQVJLU19FWElTVCkgJiYKKwkgICAgIShzbXUtPndhdGVy
bWFya3NfYml0bWFwICYgV0FURVJNQVJLU19MT0FERUQpKSB7CisJCXJldCA9IHNtdV93cml0ZV93
YXRlcm1hcmtzX3RhYmxlKHNtdSk7CisJCWlmIChyZXQpIHsKKwkJCXByX2VycigiRmFpbGVkIHRv
IHVwZGF0ZSBXTVRBQkxFISIpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCQlzbXUtPndhdGVybWFy
a3NfYml0bWFwIHw9IFdBVEVSTUFSS1NfTE9BREVEOworCX0KKworCWlmICgoc211LT53YXRlcm1h
cmtzX2JpdG1hcCAmIFdBVEVSTUFSS1NfRVhJU1QpICYmCisJICAgIHNtdV9mZWF0dXJlX2lzX3N1
cHBvcnRlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9EQ0VGQ0xLX0JJVCkgJiYKKwkgICAgc211X2Zl
YXR1cmVfaXNfc3VwcG9ydGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX1NPQ0NMS19CSVQpKSB7CisJ
CXNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsCisJCQkJCSAgICBTTVVfTVNHX051bU9m
RGlzcGxheXMsCisJCQkJCSAgICBzbXUtPmRpc3BsYXlfY29uZmlnLT5udW1fZGlzcGxheSk7CisJ
fQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCB2ZWdhMjBfYXBwbHlfY2xvY2tzX2Fk
anVzdF9ydWxlcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKK3sKKwlzdHJ1Y3Qgc211X2RwbV9j
b250ZXh0ICpzbXVfZHBtX2N0eCA9ICYoc211LT5zbXVfZHBtKTsKKwlzdHJ1Y3QgdmVnYTIwX2Rw
bV90YWJsZSAqZHBtX2N0eCA9IChzdHJ1Y3QgdmVnYTIwX2RwbV90YWJsZSAqKShzbXVfZHBtX2N0
eC0+ZHBtX2NvbnRleHQpOworCXN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAqZHBtX3Rh
YmxlOworCWJvb2wgdmJsYW5rX3Rvb19zaG9ydCA9IGZhbHNlOworCWJvb2wgZGlzYWJsZV9tY2xr
X3N3aXRjaGluZzsKKwl1aW50MzJfdCBpLCBsYXRlbmN5OworCisJZGlzYWJsZV9tY2xrX3N3aXRj
aGluZyA9ICgoMSA8IHNtdS0+ZGlzcGxheV9jb25maWctPm51bV9kaXNwbGF5KSAmJgorCQkJCSAg
IXNtdS0+ZGlzcGxheV9jb25maWctPm11bHRpX21vbml0b3JfaW5fc3luYykgfHwgdmJsYW5rX3Rv
b19zaG9ydDsKKwlsYXRlbmN5ID0gc211LT5kaXNwbGF5X2NvbmZpZy0+ZGNlX3RvbGVyYWJsZV9t
Y2xrX2luX2FjdGl2ZV9sYXRlbmN5OworCisJLyogZ2Z4Y2xrICovCisJZHBtX3RhYmxlID0gJihk
cG1fY3R4LT5nZnhfdGFibGUpOworCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVs
ID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlOworCWRwbV90YWJsZS0+ZHBtX3N0YXRl
LnNvZnRfbWF4X2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQg
LSAxXS52YWx1ZTsKKwlkcG1fdGFibGUtPmRwbV9zdGF0ZS5oYXJkX21pbl9sZXZlbCA9IGRwbV90
YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1ZTsKKwlkcG1fdGFibGUtPmRwbV9zdGF0ZS5oYXJkX21h
eF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFs
dWU7CisKKwkJaWYgKFZFR0EyMF9VTURfUFNUQVRFX0dGWENMS19MRVZFTCA8IGRwbV90YWJsZS0+
Y291bnQpIHsKKwkJCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBtX3Rh
YmxlLT5kcG1fbGV2ZWxzW1ZFR0EyMF9VTURfUFNUQVRFX0dGWENMS19MRVZFTF0udmFsdWU7CisJ
CQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xl
dmVsc1tWRUdBMjBfVU1EX1BTVEFURV9HRlhDTEtfTEVWRUxdLnZhbHVlOworCQl9CisKKwkJaWYg
KHNtdV9kcG1fY3R4LT5kcG1fbGV2ZWwgPT0gQU1EX0RQTV9GT1JDRURfTEVWRUxfUFJPRklMRV9N
SU5fU0NMSykgeworCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1f
dGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWU7CisJCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0
X21heF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1ZTsKKwkJfQorCisJCWlm
IChzbXVfZHBtX2N0eC0+ZHBtX2xldmVsID09IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVf
UEVBSykgeworCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFi
bGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOworCQkJZHBtX3RhYmxl
LT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3Rh
YmxlLT5jb3VudCAtIDFdLnZhbHVlOworCQl9CisKKwkvKiBtZW1jbGsgKi8KKwlkcG1fdGFibGUg
PSAmKGRwbV9jdHgtPm1lbV90YWJsZSk7CisJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5f
bGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWU7CisJZHBtX3RhYmxlLT5kcG1f
c3RhdGUuc29mdF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5j
b3VudCAtIDFdLnZhbHVlOworCWRwbV90YWJsZS0+ZHBtX3N0YXRlLmhhcmRfbWluX2xldmVsID0g
ZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlOworCWRwbV90YWJsZS0+ZHBtX3N0YXRlLmhh
cmRfbWF4X2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQgLSAx
XS52YWx1ZTsKKworCQlpZiAoVkVHQTIwX1VNRF9QU1RBVEVfTUNMS19MRVZFTCA8IGRwbV90YWJs
ZS0+Y291bnQpIHsKKwkJCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBt
X3RhYmxlLT5kcG1fbGV2ZWxzW1ZFR0EyMF9VTURfUFNUQVRFX01DTEtfTEVWRUxdLnZhbHVlOwor
CQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9s
ZXZlbHNbVkVHQTIwX1VNRF9QU1RBVEVfTUNMS19MRVZFTF0udmFsdWU7CisJCX0KKworCQlpZiAo
c211X2RwbV9jdHgtPmRwbV9sZXZlbCA9PSBBTURfRFBNX0ZPUkNFRF9MRVZFTF9QUk9GSUxFX01J
Tl9NQ0xLKSB7CisJCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90
YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1ZTsKKwkJCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRf
bWF4X2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlOworCQl9CisKKwkJaWYg
KHNtdV9kcG1fY3R4LT5kcG1fbGV2ZWwgPT0gQU1EX0RQTV9GT1JDRURfTEVWRUxfUFJPRklMRV9Q
RUFLKSB7CisJCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJs
ZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7CisJCQlkcG1fdGFibGUt
PmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFi
bGUtPmNvdW50IC0gMV0udmFsdWU7CisJCX0KKworCS8qIGhvbm91ciBEQUwncyBVQ0xLIEhhcmRt
aW4gKi8KKwlpZiAoZHBtX3RhYmxlLT5kcG1fc3RhdGUuaGFyZF9taW5fbGV2ZWwgPCAoc211LT5k
aXNwbGF5X2NvbmZpZy0+bWluX21lbV9zZXRfY2xvY2sgLyAxMDApKQorCQlkcG1fdGFibGUtPmRw
bV9zdGF0ZS5oYXJkX21pbl9sZXZlbCA9IHNtdS0+ZGlzcGxheV9jb25maWctPm1pbl9tZW1fc2V0
X2Nsb2NrIC8gMTAwOworCisJLyogSGFyZG1pbiBpcyBkZXBlbmRlbnQgb24gZGlzcGxheWNvbmZp
ZyAqLworCWlmIChkaXNhYmxlX21jbGtfc3dpdGNoaW5nKSB7CisJCWRwbV90YWJsZS0+ZHBtX3N0
YXRlLmhhcmRfbWluX2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291
bnQgLSAxXS52YWx1ZTsKKwkJZm9yIChpID0gMDsgaSA8IHNtdV9kcG1fY3R4LT5tY2xrX2xhdGVu
Y3lfdGFibGUtPmNvdW50IC0gMTsgaSsrKSB7CisJCQlpZiAoc211X2RwbV9jdHgtPm1jbGtfbGF0
ZW5jeV90YWJsZS0+ZW50cmllc1tpXS5sYXRlbmN5IDw9IGxhdGVuY3kpIHsKKwkJCQlpZiAoZHBt
X3RhYmxlLT5kcG1fbGV2ZWxzW2ldLnZhbHVlID49IChzbXUtPmRpc3BsYXlfY29uZmlnLT5taW5f
bWVtX3NldF9jbG9jayAvIDEwMCkpIHsKKwkJCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuaGFyZF9t
aW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbaV0udmFsdWU7CisJCQkJCWJyZWFrOwor
CQkJCX0KKwkJCX0KKwkJfQorCX0KKworCWlmIChzbXUtPmRpc3BsYXlfY29uZmlnLT5uYl9wc3Rh
dGVfc3dpdGNoX2Rpc2FibGUpCisJCWRwbV90YWJsZS0+ZHBtX3N0YXRlLmhhcmRfbWluX2xldmVs
ID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQgLSAxXS52YWx1ZTsKKwor
CS8qIHZjbGsgKi8KKwlkcG1fdGFibGUgPSAmKGRwbV9jdHgtPnZjbGtfdGFibGUpOworCWRwbV90
YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBd
LnZhbHVlOworCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsID0gZHBtX3RhYmxl
LT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQgLSAxXS52YWx1ZTsKKwlkcG1fdGFibGUtPmRw
bV9zdGF0ZS5oYXJkX21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1ZTsK
KwlkcG1fdGFibGUtPmRwbV9zdGF0ZS5oYXJkX21heF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xl
dmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7CisKKwkJaWYgKFZFR0EyMF9VTURfUFNU
QVRFX1VWRENMS19MRVZFTCA8IGRwbV90YWJsZS0+Y291bnQpIHsKKwkJCWRwbV90YWJsZS0+ZHBt
X3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW1ZFR0EyMF9VTURf
UFNUQVRFX1VWRENMS19MRVZFTF0udmFsdWU7CisJCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0
X21heF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tWRUdBMjBfVU1EX1BTVEFURV9VVkRD
TEtfTEVWRUxdLnZhbHVlOworCQl9CisKKwkJaWYgKHNtdV9kcG1fY3R4LT5kcG1fbGV2ZWwgPT0g
QU1EX0RQTV9GT1JDRURfTEVWRUxfUFJPRklMRV9QRUFLKSB7CisJCQlkcG1fdGFibGUtPmRwbV9z
dGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNv
dW50IC0gMV0udmFsdWU7CisJCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9
IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7CisJCX0K
KworCS8qIGRjbGsgKi8KKwlkcG1fdGFibGUgPSAmKGRwbV9jdHgtPmRjbGtfdGFibGUpOworCWRw
bV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxz
WzBdLnZhbHVlOworCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsID0gZHBtX3Rh
YmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQgLSAxXS52YWx1ZTsKKwlkcG1fdGFibGUt
PmRwbV9zdGF0ZS5oYXJkX21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1
ZTsKKwlkcG1fdGFibGUtPmRwbV9zdGF0ZS5oYXJkX21heF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBt
X2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7CisKKwkJaWYgKFZFR0EyMF9VTURf
UFNUQVRFX1VWRENMS19MRVZFTCA8IGRwbV90YWJsZS0+Y291bnQpIHsKKwkJCWRwbV90YWJsZS0+
ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW1ZFR0EyMF9V
TURfUFNUQVRFX1VWRENMS19MRVZFTF0udmFsdWU7CisJCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5z
b2Z0X21heF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tWRUdBMjBfVU1EX1BTVEFURV9V
VkRDTEtfTEVWRUxdLnZhbHVlOworCQl9CisKKwkJaWYgKHNtdV9kcG1fY3R4LT5kcG1fbGV2ZWwg
PT0gQU1EX0RQTV9GT1JDRURfTEVWRUxfUFJPRklMRV9QRUFLKSB7CisJCQlkcG1fdGFibGUtPmRw
bV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUt
PmNvdW50IC0gMV0udmFsdWU7CisJCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZl
bCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7CisJ
CX0KKworCS8qIHNvY2NsayAqLworCWRwbV90YWJsZSA9ICYoZHBtX2N0eC0+c29jX3RhYmxlKTsK
KwlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xl
dmVsc1swXS52YWx1ZTsKKwlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9IGRw
bV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7CisJZHBtX3Rh
YmxlLT5kcG1fc3RhdGUuaGFyZF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0u
dmFsdWU7CisJZHBtX3RhYmxlLT5kcG1fc3RhdGUuaGFyZF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUt
PmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOworCisJCWlmIChWRUdBMjBf
VU1EX1BTVEFURV9TT0NDTEtfTEVWRUwgPCBkcG1fdGFibGUtPmNvdW50KSB7CisJCQlkcG1fdGFi
bGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tWRUdB
MjBfVU1EX1BTVEFURV9TT0NDTEtfTEVWRUxdLnZhbHVlOworCQkJZHBtX3RhYmxlLT5kcG1fc3Rh
dGUuc29mdF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbVkVHQTIwX1VNRF9QU1RB
VEVfU09DQ0xLX0xFVkVMXS52YWx1ZTsKKwkJfQorCisJCWlmIChzbXVfZHBtX2N0eC0+ZHBtX2xl
dmVsID09IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVfUEVBSykgeworCQkJZHBtX3RhYmxl
LT5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3Rh
YmxlLT5jb3VudCAtIDFdLnZhbHVlOworCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhf
bGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVl
OworCQl9CisKKwkvKiBlY2xrICovCisJZHBtX3RhYmxlID0gJihkcG1fY3R4LT5lY2xrX3RhYmxl
KTsKKwlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBt
X2xldmVsc1swXS52YWx1ZTsKKwlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9
IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7CisJZHBt
X3RhYmxlLT5kcG1fc3RhdGUuaGFyZF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNb
MF0udmFsdWU7CisJZHBtX3RhYmxlLT5kcG1fc3RhdGUuaGFyZF9tYXhfbGV2ZWwgPSBkcG1fdGFi
bGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOworCisJCWlmIChWRUdB
MjBfVU1EX1BTVEFURV9WQ0VNQ0xLX0xFVkVMIDwgZHBtX3RhYmxlLT5jb3VudCkgeworCQkJZHBt
X3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNb
VkVHQTIwX1VNRF9QU1RBVEVfVkNFTUNMS19MRVZFTF0udmFsdWU7CisJCQlkcG1fdGFibGUtPmRw
bV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tWRUdBMjBfVU1E
X1BTVEFURV9WQ0VNQ0xLX0xFVkVMXS52YWx1ZTsKKwkJfQorCisJCWlmIChzbXVfZHBtX2N0eC0+
ZHBtX2xldmVsID09IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVfUEVBSykgeworCQkJZHBt
X3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNb
ZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOworCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29m
dF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFd
LnZhbHVlOworCQl9CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQKK3ZlZ2EyMF9ub3RpZnlf
c21jX2Rpc3BhbHlfY29uZmlnKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQoreworCXN0cnVjdCB2
ZWdhMjBfZHBtX3RhYmxlICpkcG1fdGFibGUgPSBzbXUtPnNtdV9kcG0uZHBtX2NvbnRleHQ7CisJ
c3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICptZW10YWJsZSA9ICZkcG1fdGFibGUtPm1l
bV90YWJsZTsKKwlzdHJ1Y3Qgc211X2Nsb2NrcyBtaW5fY2xvY2tzID0gezB9OworCXN0cnVjdCBw
cF9kaXNwbGF5X2Nsb2NrX3JlcXVlc3QgY2xvY2tfcmVxOworCWludCByZXQgPSAwOworCisJbWlu
X2Nsb2Nrcy5kY2VmX2Nsb2NrID0gc211LT5kaXNwbGF5X2NvbmZpZy0+bWluX2RjZWZfc2V0X2Ns
azsKKwltaW5fY2xvY2tzLmRjZWZfY2xvY2tfaW5fc3IgPSBzbXUtPmRpc3BsYXlfY29uZmlnLT5t
aW5fZGNlZl9kZWVwX3NsZWVwX3NldF9jbGs7CisJbWluX2Nsb2Nrcy5tZW1vcnlfY2xvY2sgPSBz
bXUtPmRpc3BsYXlfY29uZmlnLT5taW5fbWVtX3NldF9jbG9jazsKKworCWlmIChzbXVfZmVhdHVy
ZV9pc19zdXBwb3J0ZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fRENFRkNMS19CSVQpKSB7CisJCWNs
b2NrX3JlcS5jbG9ja190eXBlID0gYW1kX3BwX2RjZWZfY2xvY2s7CisJCWNsb2NrX3JlcS5jbG9j
a19mcmVxX2luX2toeiA9IG1pbl9jbG9ja3MuZGNlZl9jbG9jayAqIDEwOworCQlpZiAoIXNtdS0+
ZnVuY3MtPmRpc3BsYXlfY2xvY2tfdm9sdGFnZV9yZXF1ZXN0KHNtdSwgJmNsb2NrX3JlcSkpIHsK
KwkJCWlmIChzbXVfZmVhdHVyZV9pc19zdXBwb3J0ZWQoc211LCBTTVVfRkVBVFVSRV9EU19EQ0VG
Q0xLX0JJVCkpIHsKKwkJCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LAor
CQkJCQkJCQkgIFNNVV9NU0dfU2V0TWluRGVlcFNsZWVwRGNlZmNsaywKKwkJCQkJCQkJICBtaW5f
Y2xvY2tzLmRjZWZfY2xvY2tfaW5fc3IvMTAwKTsKKwkJCQlpZiAocmV0KSB7CisJCQkJCXByX2Vy
cigiQXR0ZW1wdCB0byBzZXQgZGl2aWRlciBmb3IgRENFRkNMSyBGYWlsZWQhIik7CisJCQkJCXJl
dHVybiByZXQ7CisJCQkJfQorCQkJfQorCQl9IGVsc2UgeworCQkJcHJfaW5mbygiQXR0ZW1wdCB0
byBzZXQgSGFyZCBNaW4gZm9yIERDRUZDTEsgRmFpbGVkISIpOworCQl9CisJfQorCisJaWYgKHNt
dV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVUNMS19CSVQpKSB7CisJ
CW1lbXRhYmxlLT5kcG1fc3RhdGUuaGFyZF9taW5fbGV2ZWwgPSBtaW5fY2xvY2tzLm1lbW9yeV9j
bG9jay8xMDA7CisJCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsCisJCQkJ
CQkgIFNNVV9NU0dfU2V0SGFyZE1pbkJ5RnJlcSwKKwkJCQkJCSAgKFBQQ0xLX1VDTEsgPDwgMTYp
IHwgbWVtdGFibGUtPmRwbV9zdGF0ZS5oYXJkX21pbl9sZXZlbCk7CisJCWlmIChyZXQpIHsKKwkJ
CXByX2VycigiWyVzXSBTZXQgaGFyZCBtaW4gdWNsayBmYWlsZWQhIiwgX19mdW5jX18pOworCQkJ
cmV0dXJuIHJldDsKKwkJfQorCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgdWludDMyX3Qg
dmVnYTIwX2ZpbmRfbG93ZXN0X2RwbV9sZXZlbChzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFi
bGUgKnRhYmxlKQoreworCXVpbnQzMl90IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgdGFibGUtPmNv
dW50OyBpKyspIHsKKwkJaWYgKHRhYmxlLT5kcG1fbGV2ZWxzW2ldLmVuYWJsZWQpCisJCQlicmVh
azsKKwl9CisJaWYgKGkgPj0gdGFibGUtPmNvdW50KSB7CisJCWkgPSAwOworCQl0YWJsZS0+ZHBt
X2xldmVsc1tpXS5lbmFibGVkID0gdHJ1ZTsKKwl9CisKKwlyZXR1cm4gaTsKK30KKworc3RhdGlj
IHVpbnQzMl90IHZlZ2EyMF9maW5kX2hpZ2hlc3RfZHBtX2xldmVsKHN0cnVjdCB2ZWdhMjBfc2lu
Z2xlX2RwbV90YWJsZSAqdGFibGUpCit7CisJaW50IGkgPSAwOworCisJaWYgKCF0YWJsZSkgewor
CQlwcl9lcnIoIlslc10gRFBNIFRhYmxlIGRvZXMgbm90IGV4aXN0ISIsIF9fZnVuY19fKTsKKwkJ
cmV0dXJuIDA7CisJfQorCWlmICh0YWJsZS0+Y291bnQgPD0gMCkgeworCQlwcl9lcnIoIlslc10g
RFBNIFRhYmxlIGhhcyBubyBlbnRyeSEiLCBfX2Z1bmNfXyk7CisJCXJldHVybiAwOworCX0KKwlp
ZiAodGFibGUtPmNvdW50ID4gTUFYX1JFR1VMQVJfRFBNX05VTUJFUikgeworCQlwcl9lcnIoIlsl
c10gRFBNIFRhYmxlIGhhcyB0b28gbWFueSBlbnRyaWVzISIsIF9fZnVuY19fKTsKKwkJcmV0dXJu
IE1BWF9SRUdVTEFSX0RQTV9OVU1CRVIgLSAxOworCX0KKworCWZvciAoaSA9IHRhYmxlLT5jb3Vu
dCAtIDE7IGkgPj0gMDsgaS0tKSB7CisJCWlmICh0YWJsZS0+ZHBtX2xldmVsc1tpXS5lbmFibGVk
KQorCQkJYnJlYWs7CisJfQorCWlmIChpIDwgMCkgeworCQlpID0gMDsKKwkJdGFibGUtPmRwbV9s
ZXZlbHNbaV0uZW5hYmxlZCA9IHRydWU7CisJfQorCisJcmV0dXJuIGk7Cit9CisKK3N0YXRpYyBp
bnQgdmVnYTIwX2ZvcmNlX2RwbV9saW1pdF92YWx1ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwg
Ym9vbCBoaWdoZXN0KQoreworCXVpbnQzMl90IHNvZnRfbGV2ZWw7CisJaW50IHJldCA9IDA7CisJ
c3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKmRwbV90YWJsZSA9CisJCShzdHJ1Y3QgdmVnYTIwX2Rw
bV90YWJsZSAqKXNtdS0+c211X2RwbS5kcG1fY29udGV4dDsKKworCWlmIChoaWdoZXN0KQorCQlz
b2Z0X2xldmVsID0gdmVnYTIwX2ZpbmRfaGlnaGVzdF9kcG1fbGV2ZWwoJihkcG1fdGFibGUtPmdm
eF90YWJsZSkpOworCWVsc2UKKwkJc29mdF9sZXZlbCA9IHZlZ2EyMF9maW5kX2xvd2VzdF9kcG1f
bGV2ZWwoJihkcG1fdGFibGUtPmdmeF90YWJsZSkpOworCisJZHBtX3RhYmxlLT5nZnhfdGFibGUu
ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0KKwkJZHBtX3RhYmxlLT5nZnhfdGFibGUuZHBtX3N0
YXRlLnNvZnRfbWF4X2xldmVsID0KKwkJZHBtX3RhYmxlLT5nZnhfdGFibGUuZHBtX2xldmVsc1tz
b2Z0X2xldmVsXS52YWx1ZTsKKworCWlmIChoaWdoZXN0KQorCQlzb2Z0X2xldmVsID0gdmVnYTIw
X2ZpbmRfaGlnaGVzdF9kcG1fbGV2ZWwoJihkcG1fdGFibGUtPm1lbV90YWJsZSkpOworCWVsc2UK
KwkJc29mdF9sZXZlbCA9IHZlZ2EyMF9maW5kX2xvd2VzdF9kcG1fbGV2ZWwoJihkcG1fdGFibGUt
Pm1lbV90YWJsZSkpOworCisJZHBtX3RhYmxlLT5tZW1fdGFibGUuZHBtX3N0YXRlLnNvZnRfbWlu
X2xldmVsID0KKwkJZHBtX3RhYmxlLT5tZW1fdGFibGUuZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVs
ID0KKwkJZHBtX3RhYmxlLT5tZW1fdGFibGUuZHBtX2xldmVsc1tzb2Z0X2xldmVsXS52YWx1ZTsK
KworCWlmIChoaWdoZXN0KQorCQlzb2Z0X2xldmVsID0gdmVnYTIwX2ZpbmRfaGlnaGVzdF9kcG1f
bGV2ZWwoJihkcG1fdGFibGUtPnNvY190YWJsZSkpOworCWVsc2UKKwkJc29mdF9sZXZlbCA9IHZl
Z2EyMF9maW5kX2xvd2VzdF9kcG1fbGV2ZWwoJihkcG1fdGFibGUtPnNvY190YWJsZSkpOworCisJ
ZHBtX3RhYmxlLT5zb2NfdGFibGUuZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0KKwkJZHBtX3Rh
YmxlLT5zb2NfdGFibGUuZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsID0KKwkJZHBtX3RhYmxlLT5z
b2NfdGFibGUuZHBtX2xldmVsc1tzb2Z0X2xldmVsXS52YWx1ZTsKKworCXJldCA9IHZlZ2EyMF91
cGxvYWRfZHBtX2xldmVsKHNtdSwgZmFsc2UsIDB4RkZGRkZGRkYpOworCWlmIChyZXQpIHsKKwkJ
cHJfZXJyKCJGYWlsZWQgdG8gdXBsb2FkIGJvb3QgbGV2ZWwgdG8gJXMhXG4iLAorCQkJCWhpZ2hl
c3QgPyAiaGlnaGVzdCIgOiAibG93ZXN0Iik7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0g
dmVnYTIwX3VwbG9hZF9kcG1fbGV2ZWwoc211LCB0cnVlLCAweEZGRkZGRkZGKTsKKwlpZiAocmV0
KSB7CisJCXByX2VycigiRmFpbGVkIHRvIHVwbG9hZCBkcG0gbWF4IGxldmVsIHRvICVzIVxuISIs
CisJCQkJaGlnaGVzdCA/ICJoaWdoZXN0IiA6ICJsb3dlc3QiKTsKKwkJcmV0dXJuIHJldDsKKwl9
CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHZlZ2EyMF91bmZvcmNlX2RwbV9sZXZl
bHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCit7CisJdWludDMyX3Qgc29mdF9taW5fbGV2ZWws
IHNvZnRfbWF4X2xldmVsOworCWludCByZXQgPSAwOworCXN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxl
ICpkcG1fdGFibGUgPQorCQkoc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKilzbXUtPnNtdV9kcG0u
ZHBtX2NvbnRleHQ7CisKKwlzb2Z0X21pbl9sZXZlbCA9IHZlZ2EyMF9maW5kX2xvd2VzdF9kcG1f
bGV2ZWwoJihkcG1fdGFibGUtPmdmeF90YWJsZSkpOworCXNvZnRfbWF4X2xldmVsID0gdmVnYTIw
X2ZpbmRfaGlnaGVzdF9kcG1fbGV2ZWwoJihkcG1fdGFibGUtPmdmeF90YWJsZSkpOworCWRwbV90
YWJsZS0+Z2Z4X3RhYmxlLmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9CisJCWRwbV90YWJsZS0+
Z2Z4X3RhYmxlLmRwbV9sZXZlbHNbc29mdF9taW5fbGV2ZWxdLnZhbHVlOworCWRwbV90YWJsZS0+
Z2Z4X3RhYmxlLmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9CisJCWRwbV90YWJsZS0+Z2Z4X3Rh
YmxlLmRwbV9sZXZlbHNbc29mdF9tYXhfbGV2ZWxdLnZhbHVlOworCisJc29mdF9taW5fbGV2ZWwg
PSB2ZWdhMjBfZmluZF9sb3dlc3RfZHBtX2xldmVsKCYoZHBtX3RhYmxlLT5tZW1fdGFibGUpKTsK
Kwlzb2Z0X21heF9sZXZlbCA9IHZlZ2EyMF9maW5kX2hpZ2hlc3RfZHBtX2xldmVsKCYoZHBtX3Rh
YmxlLT5tZW1fdGFibGUpKTsKKwlkcG1fdGFibGUtPm1lbV90YWJsZS5kcG1fc3RhdGUuc29mdF9t
aW5fbGV2ZWwgPQorCQlkcG1fdGFibGUtPmdmeF90YWJsZS5kcG1fbGV2ZWxzW3NvZnRfbWluX2xl
dmVsXS52YWx1ZTsKKwlkcG1fdGFibGUtPm1lbV90YWJsZS5kcG1fc3RhdGUuc29mdF9tYXhfbGV2
ZWwgPQorCQlkcG1fdGFibGUtPmdmeF90YWJsZS5kcG1fbGV2ZWxzW3NvZnRfbWF4X2xldmVsXS52
YWx1ZTsKKworCXNvZnRfbWluX2xldmVsID0gdmVnYTIwX2ZpbmRfbG93ZXN0X2RwbV9sZXZlbCgm
KGRwbV90YWJsZS0+c29jX3RhYmxlKSk7CisJc29mdF9tYXhfbGV2ZWwgPSB2ZWdhMjBfZmluZF9o
aWdoZXN0X2RwbV9sZXZlbCgmKGRwbV90YWJsZS0+c29jX3RhYmxlKSk7CisJZHBtX3RhYmxlLT5z
b2NfdGFibGUuZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0KKwkJZHBtX3RhYmxlLT5zb2NfdGFi
bGUuZHBtX2xldmVsc1tzb2Z0X21pbl9sZXZlbF0udmFsdWU7CisJZHBtX3RhYmxlLT5zb2NfdGFi
bGUuZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsID0KKwkJZHBtX3RhYmxlLT5zb2NfdGFibGUuZHBt
X2xldmVsc1tzb2Z0X21heF9sZXZlbF0udmFsdWU7CisKKwlyZXQgPSB2ZWdhMjBfdXBsb2FkX2Rw
bV9sZXZlbChzbXUsIGZhbHNlLCAweEZGRkZGRkZGKTsKKwlpZiAocmV0KSB7CisJCXByX2Vycigi
RmFpbGVkIHRvIHVwbG9hZCBEUE0gQm9vdHVwIExldmVscyEiKTsKKwkJcmV0dXJuIHJldDsKKwl9
CisKKwlyZXQgPSB2ZWdhMjBfdXBsb2FkX2RwbV9sZXZlbChzbXUsIHRydWUsIDB4RkZGRkZGRkYp
OworCWlmIChyZXQpIHsKKwkJcHJfZXJyKCJGYWlsZWQgdG8gdXBsb2FkIERQTSBNYXggTGV2ZWxz
ISIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQg
dmVnYTIwX3VwZGF0ZV9zcGVjaWZpZWRfb2Q4X3ZhbHVlKHN0cnVjdCBzbXVfY29udGV4dCAqc211
LAorCQkJCQkgICAgIHVpbnQzMl90IGluZGV4LAorCQkJCQkgICAgIHVpbnQzMl90IHZhbHVlKQor
eworCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFibGVfY29udGV4dCA9ICZzbXUtPnNtdV90
YWJsZTsKKwlPdmVyRHJpdmVUYWJsZV90ICpvZF90YWJsZSA9CisJCShPdmVyRHJpdmVUYWJsZV90
ICopKHRhYmxlX2NvbnRleHQtPm92ZXJkcml2ZV90YWJsZSk7CisJc3RydWN0IHZlZ2EyMF9vZDhf
c2V0dGluZ3MgKm9kOF9zZXR0aW5ncyA9CisJCShzdHJ1Y3QgdmVnYTIwX29kOF9zZXR0aW5ncyAq
KXNtdS0+b2Rfc2V0dGluZ3M7CisKKwlzd2l0Y2ggKGluZGV4KSB7CisJY2FzZSBPRDhfU0VUVElO
R19HRlhDTEtfRk1JTjoKKwkJb2RfdGFibGUtPkdmeGNsa0ZtaW4gPSAodWludDE2X3QpdmFsdWU7
CisJCWJyZWFrOworCisJY2FzZSBPRDhfU0VUVElOR19HRlhDTEtfRk1BWDoKKwkJaWYgKHZhbHVl
IDwgb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZN
QVhdLm1pbl92YWx1ZSB8fAorCQkgICAgdmFsdWUgPiBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5n
c19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRk1BWF0ubWF4X3ZhbHVlKQorCQkJcmV0dXJuIC1F
SU5WQUw7CisJCW9kX3RhYmxlLT5HZnhjbGtGbWF4ID0gKHVpbnQxNl90KXZhbHVlOworCQlicmVh
azsKKworCWNhc2UgT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVExOgorCQlvZF90YWJsZS0+R2Z4Y2xr
RnJlcTEgPSAodWludDE2X3QpdmFsdWU7CisJCWJyZWFrOworCisJY2FzZSBPRDhfU0VUVElOR19H
RlhDTEtfVk9MVEFHRTE6CisJCW9kX3RhYmxlLT5HZnhjbGtWb2x0MSA9ICh1aW50MTZfdCl2YWx1
ZTsKKwkJYnJlYWs7CisKKwljYXNlIE9EOF9TRVRUSU5HX0dGWENMS19GUkVRMjoKKwkJb2RfdGFi
bGUtPkdmeGNsa0ZyZXEyID0gKHVpbnQxNl90KXZhbHVlOworCQlicmVhazsKKworCWNhc2UgT0Q4
X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UyOgorCQlvZF90YWJsZS0+R2Z4Y2xrVm9sdDIgPSAodWlu
dDE2X3QpdmFsdWU7CisJCWJyZWFrOworCisJY2FzZSBPRDhfU0VUVElOR19HRlhDTEtfRlJFUTM6
CisJCW9kX3RhYmxlLT5HZnhjbGtGcmVxMyA9ICh1aW50MTZfdCl2YWx1ZTsKKwkJYnJlYWs7CisK
KwljYXNlIE9EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMzoKKwkJb2RfdGFibGUtPkdmeGNsa1Zv
bHQzID0gKHVpbnQxNl90KXZhbHVlOworCQlicmVhazsKKworCWNhc2UgT0Q4X1NFVFRJTkdfVUNM
S19GTUFYOgorCQlpZiAodmFsdWUgPCBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtP
RDhfU0VUVElOR19VQ0xLX0ZNQVhdLm1pbl92YWx1ZSB8fAorCQkgICAgdmFsdWUgPiBvZDhfc2V0
dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19VQ0xLX0ZNQVhdLm1heF92YWx1
ZSkKKwkJCXJldHVybiAtRUlOVkFMOworCQlvZF90YWJsZS0+VWNsa0ZtYXggPSAodWludDE2X3Qp
dmFsdWU7CisJCWJyZWFrOworCisJY2FzZSBPRDhfU0VUVElOR19QT1dFUl9QRVJDRU5UQUdFOgor
CQlvZF90YWJsZS0+T3ZlckRyaXZlUGN0ID0gKGludDE2X3QpdmFsdWU7CisJCWJyZWFrOworCisJ
Y2FzZSBPRDhfU0VUVElOR19GQU5fQUNPVVNUSUNfTElNSVQ6CisJCW9kX3RhYmxlLT5GYW5NYXhp
bXVtUnBtID0gKHVpbnQxNl90KXZhbHVlOworCQlicmVhazsKKworCWNhc2UgT0Q4X1NFVFRJTkdf
RkFOX01JTl9TUEVFRDoKKwkJb2RfdGFibGUtPkZhbk1pbmltdW1Qd20gPSAodWludDE2X3QpdmFs
dWU7CisJCWJyZWFrOworCisJY2FzZSBPRDhfU0VUVElOR19GQU5fVEFSR0VUX1RFTVA6CisJCW9k
X3RhYmxlLT5GYW5UYXJnZXRUZW1wZXJhdHVyZSA9ICh1aW50MTZfdCl2YWx1ZTsKKwkJYnJlYWs7
CisKKwljYXNlIE9EOF9TRVRUSU5HX09QRVJBVElOR19URU1QX01BWDoKKwkJb2RfdGFibGUtPk1h
eE9wVGVtcCA9ICh1aW50MTZfdCl2YWx1ZTsKKwkJYnJlYWs7CisJfQorCisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgdmVnYTIwX3VwZGF0ZV9vZDhfc2V0dGluZ3Moc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUsCisJCQkJICAgICAgdWludDMyX3QgaW5kZXgsCisJCQkJICAgICAgdWludDMyX3Qg
dmFsdWUpCit7CisJc3RydWN0IHNtdV90YWJsZV9jb250ZXh0ICp0YWJsZV9jb250ZXh0ID0gJnNt
dS0+c211X3RhYmxlOworCWludCByZXQ7CisKKwlyZXQgPSBzbXVfdXBkYXRlX3RhYmxlKHNtdSwg
U01VX1RBQkxFX09WRVJEUklWRSwKKwkJCSAgICAgICB0YWJsZV9jb250ZXh0LT5vdmVyZHJpdmVf
dGFibGUsIGZhbHNlKTsKKwlpZiAocmV0KSB7CisJCXByX2VycigiRmFpbGVkIHRvIGV4cG9ydCBv
dmVyIGRyaXZlIHRhYmxlIVxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0ID0gdmVnYTIw
X3VwZGF0ZV9zcGVjaWZpZWRfb2Q4X3ZhbHVlKHNtdSwgaW5kZXgsIHZhbHVlKTsKKwlpZiAocmV0
KQorCQlyZXR1cm4gcmV0OworCisJcmV0ID0gc211X3VwZGF0ZV90YWJsZShzbXUsIFNNVV9UQUJM
RV9PVkVSRFJJVkUsCisJCQkgICAgICAgdGFibGVfY29udGV4dC0+b3ZlcmRyaXZlX3RhYmxlLCB0
cnVlKTsKKwlpZiAocmV0KSB7CisJCXByX2VycigiRmFpbGVkIHRvIGltcG9ydCBvdmVyIGRyaXZl
IHRhYmxlIVxuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBpbnQgdmVnYTIwX3NldF9vZF9wZXJjZW50YWdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAor
CQkJCSAgICBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwKKwkJCQkgICAgdWludDMyX3QgdmFs
dWUpCit7CisJc3RydWN0IHNtdV9kcG1fY29udGV4dCAqc211X2RwbSA9ICZzbXUtPnNtdV9kcG07
CisJc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKmRwbV90YWJsZSA9IE5VTEw7CisJc3RydWN0IHZl
Z2EyMF9kcG1fdGFibGUgKmdvbGRlbl90YWJsZSA9IE5VTEw7CisJc3RydWN0IHZlZ2EyMF9zaW5n
bGVfZHBtX3RhYmxlICpzaW5nbGVfZHBtX3RhYmxlOworCXN0cnVjdCB2ZWdhMjBfc2luZ2xlX2Rw
bV90YWJsZSAqZ29sZGVuX2RwbV90YWJsZTsKKwl1aW50MzJfdCBvZF9jbGssIGluZGV4OworCWlu
dCByZXQgPSAwOworCWludCBmZWF0dXJlX2VuYWJsZWQ7CisJUFBDTEtfZSBjbGtfaWQ7CisKKwlt
dXRleF9sb2NrKCYoc211LT5tdXRleCkpOworCisJZHBtX3RhYmxlID0gc211X2RwbS0+ZHBtX2Nv
bnRleHQ7CisJZ29sZGVuX3RhYmxlID0gc211X2RwbS0+Z29sZGVuX2RwbV9jb250ZXh0OworCisJ
c3dpdGNoIChjbGtfdHlwZSkgeworCWNhc2UgU01VX09EX1NDTEs6CisJCXNpbmdsZV9kcG1fdGFi
bGUgPSAmKGRwbV90YWJsZS0+Z2Z4X3RhYmxlKTsKKwkJZ29sZGVuX2RwbV90YWJsZSA9ICYoZ29s
ZGVuX3RhYmxlLT5nZnhfdGFibGUpOworCQlmZWF0dXJlX2VuYWJsZWQgPSBzbXVfZmVhdHVyZV9p
c19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX0dGWENMS19CSVQpOworCQljbGtfaWQgPSBQ
UENMS19HRlhDTEs7CisJCWluZGV4ID0gT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZNQVg7CisJCWJyZWFr
OworCWNhc2UgU01VX09EX01DTEs6CisJCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+
bWVtX3RhYmxlKTsKKwkJZ29sZGVuX2RwbV90YWJsZSA9ICYoZ29sZGVuX3RhYmxlLT5tZW1fdGFi
bGUpOworCQlmZWF0dXJlX2VuYWJsZWQgPSBzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01V
X0ZFQVRVUkVfRFBNX1VDTEtfQklUKTsKKwkJY2xrX2lkID0gUFBDTEtfVUNMSzsKKwkJaW5kZXgg
PSBPRDhfU0VUVElOR19VQ0xLX0ZNQVg7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCXJldCA9IC1F
SU5WQUw7CisJCWJyZWFrOworCX0KKworCWlmIChyZXQpCisJCWdvdG8gc2V0X29kX2ZhaWxlZDsK
KworCW9kX2NsayA9IGdvbGRlbl9kcG1fdGFibGUtPmRwbV9sZXZlbHNbZ29sZGVuX2RwbV90YWJs
ZS0+Y291bnQgLSAxXS52YWx1ZSAqIHZhbHVlOworCW9kX2NsayAvPSAxMDA7CisJb2RfY2xrICs9
IGdvbGRlbl9kcG1fdGFibGUtPmRwbV9sZXZlbHNbZ29sZGVuX2RwbV90YWJsZS0+Y291bnQgLSAx
XS52YWx1ZTsKKworCXJldCA9IHZlZ2EyMF91cGRhdGVfb2Q4X3NldHRpbmdzKHNtdSwgaW5kZXgs
IG9kX2Nsayk7CisJaWYgKHJldCkgeworCQlwcl9lcnIoIltTZXRvdmVyZHJpdmVdIGZhaWxlZCB0
byBzZXQgb2QgY2xrIVxuIik7CisJCWdvdG8gc2V0X29kX2ZhaWxlZDsKKwl9CisKKwlpZiAoZmVh
dHVyZV9lbmFibGVkKSB7CisJCXJldCA9IHZlZ2EyMF9zZXRfc2luZ2xlX2RwbV90YWJsZShzbXUs
IHNpbmdsZV9kcG1fdGFibGUsCisJCQkJCQkgIGNsa19pZCk7CisJCWlmIChyZXQpIHsKKwkJCXBy
X2VycigiW1NldG92ZXJkcml2ZV0gZmFpbGVkIHRvIHJlZnJlc2ggZHBtIHRhYmxlIVxuIik7CisJ
CQlnb3RvIHNldF9vZF9mYWlsZWQ7CisJCX0KKwl9IGVsc2UgeworCQlzaW5nbGVfZHBtX3RhYmxl
LT5jb3VudCA9IDE7CisJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWUgPSBz
bXUtPnNtdV90YWJsZS5ib290X3ZhbHVlcy5nZnhjbGsgLyAxMDA7CisJfQorCisJcmV0ID0gc211
X2hhbmRsZV90YXNrKHNtdSwgc211X2RwbS0+ZHBtX2xldmVsLAorCQkJICAgICAgQU1EX1BQX1RB
U0tfUkVBREpVU1RfUE9XRVJfU1RBVEUpOworCitzZXRfb2RfZmFpbGVkOgorCW11dGV4X3VubG9j
aygmKHNtdS0+bXV0ZXgpKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgdmVnYTIw
X29kbl9lZGl0X2RwbV90YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKKwkJCQkgICAgIGVu
dW0gUFBfT0RfRFBNX1RBQkxFX0NPTU1BTkQgdHlwZSwKKwkJCQkgICAgIGxvbmcgKmlucHV0LCB1
aW50MzJfdCBzaXplKQoreworCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFibGVfY29udGV4
dCA9ICZzbXUtPnNtdV90YWJsZTsKKwlPdmVyRHJpdmVUYWJsZV90ICpvZF90YWJsZSA9CisJCShP
dmVyRHJpdmVUYWJsZV90ICopKHRhYmxlX2NvbnRleHQtPm92ZXJkcml2ZV90YWJsZSk7CisJc3Ry
dWN0IHNtdV9kcG1fY29udGV4dCAqc211X2RwbSA9ICZzbXUtPnNtdV9kcG07CisJc3RydWN0IHZl
Z2EyMF9kcG1fdGFibGUgKmRwbV90YWJsZSA9IE5VTEw7CisJc3RydWN0IHZlZ2EyMF9zaW5nbGVf
ZHBtX3RhYmxlICpzaW5nbGVfZHBtX3RhYmxlOworCXN0cnVjdCB2ZWdhMjBfb2Q4X3NldHRpbmdz
ICpvZDhfc2V0dGluZ3MgPQorCQkoc3RydWN0IHZlZ2EyMF9vZDhfc2V0dGluZ3MgKilzbXUtPm9k
X3NldHRpbmdzOworCXN0cnVjdCBwcF9jbG9ja19sZXZlbHNfd2l0aF9sYXRlbmN5IGNsb2NrczsK
KwlpbnQzMl90IGlucHV0X2luZGV4LCBpbnB1dF9jbGssIGlucHV0X3ZvbCwgaTsKKwlpbnQgb2Q4
X2lkOworCWludCByZXQgPSAwOworCisJZHBtX3RhYmxlID0gc211X2RwbS0+ZHBtX2NvbnRleHQ7
CisKKwlpZiAoIWlucHV0KSB7CisJCXByX3dhcm4oIk5VTEwgdXNlciBpbnB1dCBmb3IgY2xvY2sg
YW5kIHZvbHRhZ2VcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlzd2l0Y2ggKHR5cGUp
IHsKKwljYXNlIFBQX09EX0VESVRfU0NMS19WRERDX1RBQkxFOgorCQlpZiAoIShvZDhfc2V0dGlu
Z3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRk1JTl0uZmVhdHVyZV9p
ZCAmJgorCQkgICAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElO
R19HRlhDTEtfRk1BWF0uZmVhdHVyZV9pZCkpIHsKKwkJCXByX2luZm8oIlNjbGsgbWluL21heCBm
cmVxdWVuY3kgb3ZlcmRyaXZlIG5vdCBzdXBwb3J0ZWRcbiIpOworCQkJcmV0dXJuIC1FT1BOT1RT
VVBQOworCQl9CisKKwkJZm9yIChpID0gMDsgaSA8IHNpemU7IGkgKz0gMikgeworCQkJaWYgKGkg
KyAyID4gc2l6ZSkgeworCQkJCXByX2luZm8oImludmFsaWQgbnVtYmVyIG9mIGlucHV0IHBhcmFt
ZXRlcnMgJWRcbiIsIHNpemUpOworCQkJCXJldHVybiAtRUlOVkFMOworCQkJfQorCisJCQlpbnB1
dF9pbmRleCA9IGlucHV0W2ldOworCQkJaW5wdXRfY2xrID0gaW5wdXRbaSArIDFdOworCisJCQlp
ZiAoaW5wdXRfaW5kZXggIT0gMCAmJiBpbnB1dF9pbmRleCAhPSAxKSB7CisJCQkJcHJfaW5mbygi
SW52YWxpZCBpbmRleCAlZFxuIiwgaW5wdXRfaW5kZXgpOworCQkJCXByX2luZm8oIlN1cHBvcnQg
bWluL21heCBzY2xrIGZyZXF1ZW5jeSBzZXR0aW5nb25seSB3aGljaCBpbmRleCBieSAwLzFcbiIp
OworCQkJCXJldHVybiAtRUlOVkFMOworCQkJfQorCisJCQlpZiAoaW5wdXRfY2xrIDwgb2Q4X3Nl
dHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZNSU5dLm1pbl92
YWx1ZSB8fAorCQkJICAgIGlucHV0X2NsayA+IG9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2Fy
cmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUFYXS5tYXhfdmFsdWUpIHsKKwkJCQlwcl9pbmZvKCJj
bG9jayBmcmVxICVkIGlzIG5vdCB3aXRoaW4gYWxsb3dlZCByYW5nZSBbJWQgLSAlZF1cbiIsCisJ
CQkJCWlucHV0X2NsaywKKwkJCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4
X1NFVFRJTkdfR0ZYQ0xLX0ZNSU5dLm1pbl92YWx1ZSwKKwkJCQkJb2Q4X3NldHRpbmdzLT5vZDhf
c2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZNQVhdLm1heF92YWx1ZSk7CisJCQkJ
cmV0dXJuIC1FSU5WQUw7CisJCQl9CisKKwkJCWlmIChpbnB1dF9pbmRleCA9PSAwICYmIG9kX3Rh
YmxlLT5HZnhjbGtGbWluICE9IGlucHV0X2NsaykgeworCQkJCW9kX3RhYmxlLT5HZnhjbGtGbWlu
ID0gaW5wdXRfY2xrOworCQkJCW9kOF9zZXR0aW5ncy0+b2RfZ2Z4Y2xrX3VwZGF0ZSA9IHRydWU7
CisJCQl9IGVsc2UgaWYgKGlucHV0X2luZGV4ID09IDEgJiYgb2RfdGFibGUtPkdmeGNsa0ZtYXgg
IT0gaW5wdXRfY2xrKSB7CisJCQkJb2RfdGFibGUtPkdmeGNsa0ZtYXggPSBpbnB1dF9jbGs7CisJ
CQkJb2Q4X3NldHRpbmdzLT5vZF9nZnhjbGtfdXBkYXRlID0gdHJ1ZTsKKwkJCX0KKwkJfQorCisJ
CWJyZWFrOworCisJY2FzZSBQUF9PRF9FRElUX01DTEtfVkREQ19UQUJMRToKKwkJaWYgKCFvZDhf
c2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19VQ0xLX0ZNQVhdLmZlYXR1
cmVfaWQpIHsKKwkJCXByX2luZm8oIk1jbGsgbWF4IGZyZXF1ZW5jeSBvdmVyZHJpdmUgbm90IHN1
cHBvcnRlZFxuIik7CisJCQlyZXR1cm4gLUVPUE5PVFNVUFA7CisJCX0KKworCQlzaW5nbGVfZHBt
X3RhYmxlID0gJihkcG1fdGFibGUtPm1lbV90YWJsZSk7CisJCXJldCA9IHZlZ2EyMF9nZXRfY2xr
X3RhYmxlKHNtdSwgJmNsb2Nrcywgc2luZ2xlX2RwbV90YWJsZSk7CisJCWlmIChyZXQpIHsKKwkJ
CXByX2VycigiQXR0ZW1wdCB0byBnZXQgbWVtb3J5IGNsayBsZXZlbHMgRmFpbGVkISIpOworCQkJ
cmV0dXJuIHJldDsKKwkJfQorCisJCWZvciAoaSA9IDA7IGkgPCBzaXplOyBpICs9IDIpIHsKKwkJ
CWlmIChpICsgMiA+IHNpemUpIHsKKwkJCQlwcl9pbmZvKCJpbnZhbGlkIG51bWJlciBvZiBpbnB1
dCBwYXJhbWV0ZXJzICVkXG4iLAorCQkJCQkgc2l6ZSk7CisJCQkJcmV0dXJuIC1FSU5WQUw7CisJ
CQl9CisKKwkJCWlucHV0X2luZGV4ID0gaW5wdXRbaV07CisJCQlpbnB1dF9jbGsgPSBpbnB1dFtp
ICsgMV07CisKKwkJCWlmIChpbnB1dF9pbmRleCAhPSAxKSB7CisJCQkJcHJfaW5mbygiSW52YWxp
ZCBpbmRleCAlZFxuIiwgaW5wdXRfaW5kZXgpOworCQkJCXByX2luZm8oIlN1cHBvcnQgbWF4IE1j
bGsgZnJlcXVlbmN5IHNldHRpbmcgb25seSB3aGljaCBpbmRleCBieSAxXG4iKTsKKwkJCQlyZXR1
cm4gLUVJTlZBTDsKKwkJCX0KKworCQkJaWYgKGlucHV0X2NsayA8IGNsb2Nrcy5kYXRhWzBdLmNs
b2Nrc19pbl9raHogLyAxMDAwIHx8CisJCQkgICAgaW5wdXRfY2xrID4gb2Q4X3NldHRpbmdzLT5v
ZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfVUNMS19GTUFYXS5tYXhfdmFsdWUpIHsKKwkJ
CQlwcl9pbmZvKCJjbG9jayBmcmVxICVkIGlzIG5vdCB3aXRoaW4gYWxsb3dlZCByYW5nZSBbJWQg
LSAlZF1cbiIsCisJCQkJCWlucHV0X2NsaywKKwkJCQkJY2xvY2tzLmRhdGFbMF0uY2xvY2tzX2lu
X2toeiAvIDEwMDAsCisJCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9T
RVRUSU5HX1VDTEtfRk1BWF0ubWF4X3ZhbHVlKTsKKwkJCQlyZXR1cm4gLUVJTlZBTDsKKwkJCX0K
KworCQkJaWYgKGlucHV0X2luZGV4ID09IDEgJiYgb2RfdGFibGUtPlVjbGtGbWF4ICE9IGlucHV0
X2NsaykgeworCQkJCW9kOF9zZXR0aW5ncy0+b2RfZ2Z4Y2xrX3VwZGF0ZSA9IHRydWU7CisJCQkJ
b2RfdGFibGUtPlVjbGtGbWF4ID0gaW5wdXRfY2xrOworCQkJfQorCQl9CisKKwkJYnJlYWs7CisK
KwljYXNlIFBQX09EX0VESVRfVkREQ19DVVJWRToKKwkJaWYgKCEob2Q4X3NldHRpbmdzLT5vZDhf
c2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVExXS5mZWF0dXJlX2lkICYmCisJ
CSAgICAgIG9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENM
S19GUkVRMl0uZmVhdHVyZV9pZCAmJgorCQkgICAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5n
c19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRlJFUTNdLmZlYXR1cmVfaWQgJiYKKwkJICAgICAg
b2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRB
R0UxXS5mZWF0dXJlX2lkICYmCisJCSAgICAgIG9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2Fy
cmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMl0uZmVhdHVyZV9pZCAmJgorCQkgICAgICBv
ZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFH
RTNdLmZlYXR1cmVfaWQpKSB7CisJCQlwcl9pbmZvKCJWb2x0YWdlIGN1cnZlIGNhbGlicmF0ZSBu
b3Qgc3VwcG9ydGVkXG4iKTsKKwkJCXJldHVybiAtRU9QTk9UU1VQUDsKKwkJfQorCisJCWZvciAo
aSA9IDA7IGkgPCBzaXplOyBpICs9IDMpIHsKKwkJCWlmIChpICsgMyA+IHNpemUpIHsKKwkJCQlw
cl9pbmZvKCJpbnZhbGlkIG51bWJlciBvZiBpbnB1dCBwYXJhbWV0ZXJzICVkXG4iLAorCQkJCQlz
aXplKTsKKwkJCQlyZXR1cm4gLUVJTlZBTDsKKwkJCX0KKworCQkJaW5wdXRfaW5kZXggPSBpbnB1
dFtpXTsKKwkJCWlucHV0X2NsayA9IGlucHV0W2kgKyAxXTsKKwkJCWlucHV0X3ZvbCA9IGlucHV0
W2kgKyAyXTsKKworCQkJaWYgKGlucHV0X2luZGV4ID4gMikgeworCQkJCXByX2luZm8oIlNldHRp
bmcgZm9yIHBvaW50ICVkIGlzIG5vdCBzdXBwb3J0ZWRcbiIsCisJCQkJCWlucHV0X2luZGV4ICsg
MSk7CisJCQkJcHJfaW5mbygiVGhyZWUgc3VwcG9ydGVkIHBvaW50cyBpbmRleCBieSAwLCAxLCAy
XG4iKTsKKwkJCQlyZXR1cm4gLUVJTlZBTDsKKwkJCX0KKworCQkJb2Q4X2lkID0gT0Q4X1NFVFRJ
TkdfR0ZYQ0xLX0ZSRVExICsgMiAqIGlucHV0X2luZGV4OworCQkJaWYgKGlucHV0X2NsayA8IG9k
OF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W29kOF9pZF0ubWluX3ZhbHVlIHx8CisJCQkg
ICAgaW5wdXRfY2xrID4gb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbb2Q4X2lkXS5t
YXhfdmFsdWUpIHsKKwkJCQlwcl9pbmZvKCJjbG9jayBmcmVxICVkIGlzIG5vdCB3aXRoaW4gYWxs
b3dlZCByYW5nZSBbJWQgLSAlZF1cbiIsCisJCQkJCWlucHV0X2NsaywKKwkJCQkJb2Q4X3NldHRp
bmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbb2Q4X2lkXS5taW5fdmFsdWUsCisJCQkJCW9kOF9zZXR0
aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W29kOF9pZF0ubWF4X3ZhbHVlKTsKKwkJCQlyZXR1cm4g
LUVJTlZBTDsKKwkJCX0KKworCQkJb2Q4X2lkID0gT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0Ux
ICsgMiAqIGlucHV0X2luZGV4OworCQkJaWYgKGlucHV0X3ZvbCA8IG9kOF9zZXR0aW5ncy0+b2Q4
X3NldHRpbmdzX2FycmF5W29kOF9pZF0ubWluX3ZhbHVlIHx8CisJCQkgICAgaW5wdXRfdm9sID4g
b2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbb2Q4X2lkXS5tYXhfdmFsdWUpIHsKKwkJ
CQlwcl9pbmZvKCJjbG9jayB2b2x0YWdlICVkIGlzIG5vdCB3aXRoaW4gYWxsb3dlZCByYW5nZSBb
JWQtICVkXVxuIiwKKwkJCQkJaW5wdXRfdm9sLAorCQkJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0
aW5nc19hcnJheVtvZDhfaWRdLm1pbl92YWx1ZSwKKwkJCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0
dGluZ3NfYXJyYXlbb2Q4X2lkXS5tYXhfdmFsdWUpOworCQkJCXJldHVybiAtRUlOVkFMOworCQkJ
fQorCisJCQlzd2l0Y2ggKGlucHV0X2luZGV4KSB7CisJCQljYXNlIDA6CisJCQkJb2RfdGFibGUt
PkdmeGNsa0ZyZXExID0gaW5wdXRfY2xrOworCQkJCW9kX3RhYmxlLT5HZnhjbGtWb2x0MSA9IGlu
cHV0X3ZvbCAqIFZPTFRBR0VfU0NBTEU7CisJCQkJYnJlYWs7CisJCQljYXNlIDE6CisJCQkJb2Rf
dGFibGUtPkdmeGNsa0ZyZXEyID0gaW5wdXRfY2xrOworCQkJCW9kX3RhYmxlLT5HZnhjbGtWb2x0
MiA9IGlucHV0X3ZvbCAqIFZPTFRBR0VfU0NBTEU7CisJCQkJYnJlYWs7CisJCQljYXNlIDI6CisJ
CQkJb2RfdGFibGUtPkdmeGNsa0ZyZXEzID0gaW5wdXRfY2xrOworCQkJCW9kX3RhYmxlLT5HZnhj
bGtWb2x0MyA9IGlucHV0X3ZvbCAqIFZPTFRBR0VfU0NBTEU7CisJCQkJYnJlYWs7CisJCQl9CisJ
CX0KKworCQlicmVhazsKKworCWNhc2UgUFBfT0RfUkVTVE9SRV9ERUZBVUxUX1RBQkxFOgorCQly
ZXQgPSBzbXVfdXBkYXRlX3RhYmxlKHNtdSwgU01VX1RBQkxFX09WRVJEUklWRSwgdGFibGVfY29u
dGV4dC0+b3ZlcmRyaXZlX3RhYmxlLCBmYWxzZSk7CisJCWlmIChyZXQpIHsKKwkJCXByX2Vycigi
RmFpbGVkIHRvIGV4cG9ydCBvdmVyIGRyaXZlIHRhYmxlIVxuIik7CisJCQlyZXR1cm4gcmV0Owor
CQl9CisKKwkJYnJlYWs7CisKKwljYXNlIFBQX09EX0NPTU1JVF9EUE1fVEFCTEU6CisJCXJldCA9
IHNtdV91cGRhdGVfdGFibGUoc211LCBTTVVfVEFCTEVfT1ZFUkRSSVZFLCB0YWJsZV9jb250ZXh0
LT5vdmVyZHJpdmVfdGFibGUsIHRydWUpOworCQlpZiAocmV0KSB7CisJCQlwcl9lcnIoIkZhaWxl
ZCB0byBpbXBvcnQgb3ZlciBkcml2ZSB0YWJsZSFcbiIpOworCQkJcmV0dXJuIHJldDsKKwkJfQor
CisJCS8qIHJldHJpZXZlIHVwZGF0ZWQgZ2Z4Y2xrIHRhYmxlICovCisJCWlmIChvZDhfc2V0dGlu
Z3MtPm9kX2dmeGNsa191cGRhdGUpIHsKKwkJCW9kOF9zZXR0aW5ncy0+b2RfZ2Z4Y2xrX3VwZGF0
ZSA9IGZhbHNlOworCQkJc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5nZnhfdGFibGUp
OworCisJCQlpZiAoc211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9H
RlhDTEtfQklUKSkgeworCQkJCXJldCA9IHZlZ2EyMF9zZXRfc2luZ2xlX2RwbV90YWJsZShzbXUs
IHNpbmdsZV9kcG1fdGFibGUsCisJCQkJCQkJCSAgUFBDTEtfR0ZYQ0xLKTsKKwkJCQlpZiAocmV0
KSB7CisJCQkJCXByX2VycigiW1NldG92ZXJkcml2ZV0gZmFpbGVkIHRvIHJlZnJlc2ggZHBtIHRh
YmxlIVxuIik7CisJCQkJCXJldHVybiByZXQ7CisJCQkJfQorCQkJfSBlbHNlIHsKKwkJCQlzaW5n
bGVfZHBtX3RhYmxlLT5jb3VudCA9IDE7CisJCQkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX2xldmVs
c1swXS52YWx1ZSA9IHNtdS0+c211X3RhYmxlLmJvb3RfdmFsdWVzLmdmeGNsayAvIDEwMDsKKwkJ
CX0KKwkJfQorCisJCWJyZWFrOworCisJZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQor
CisJaWYgKHR5cGUgPT0gUFBfT0RfQ09NTUlUX0RQTV9UQUJMRSkgeworCQltdXRleF9sb2NrKCYo
c211LT5tdXRleCkpOworCQlyZXQgPSBzbXVfaGFuZGxlX3Rhc2soc211LCBzbXVfZHBtLT5kcG1f
bGV2ZWwsCisJCQkJICAgICAgQU1EX1BQX1RBU0tfUkVBREpVU1RfUE9XRVJfU1RBVEUpOworCQlt
dXRleF91bmxvY2soJihzbXUtPm11dGV4KSk7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3Rh
dGljIGludCB2ZWdhMjBfZHBtX3NldF91dmRfZW5hYmxlKHN0cnVjdCBzbXVfY29udGV4dCAqc211
LCBib29sIGVuYWJsZSkKK3sKKwlpZiAoIXNtdV9mZWF0dXJlX2lzX3N1cHBvcnRlZChzbXUsIFNN
VV9GRUFUVVJFX0RQTV9VVkRfQklUKSkKKwkJcmV0dXJuIDA7CisKKwlpZiAoZW5hYmxlID09IHNt
dV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVVZEX0JJVCkpCisJCXJl
dHVybiAwOworCisJcmV0dXJuIHNtdV9mZWF0dXJlX3NldF9lbmFibGVkKHNtdSwgU01VX0ZFQVRV
UkVfRFBNX1VWRF9CSVQsIGVuYWJsZSk7Cit9CisKK3N0YXRpYyBpbnQgdmVnYTIwX2RwbV9zZXRf
dmNlX2VuYWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgYm9vbCBlbmFibGUpCit7CisJaWYg
KCFzbXVfZmVhdHVyZV9pc19zdXBwb3J0ZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVkNFX0JJVCkp
CisJCXJldHVybiAwOworCisJaWYgKGVuYWJsZSA9PSBzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNt
dSwgU01VX0ZFQVRVUkVfRFBNX1ZDRV9CSVQpKQorCQlyZXR1cm4gMDsKKworCXJldHVybiBzbXVf
ZmVhdHVyZV9zZXRfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9WQ0VfQklULCBlbmFibGUp
OworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9nZXRfZW5hYmxlZF9zbWNfZmVhdHVyZXMoc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUsCisJCXVpbnQ2NF90ICpmZWF0dXJlc19lbmFibGVkKQoreworCXVp
bnQzMl90IGZlYXR1cmVfbWFza1syXSA9IHswLCAwfTsKKwlpbnQgcmV0ID0gMDsKKworCXJldCA9
IHNtdV9mZWF0dXJlX2dldF9lbmFibGVkX21hc2soc211LCBmZWF0dXJlX21hc2ssIDIpOworCWlm
IChyZXQpCisJCXJldHVybiByZXQ7CisKKwkqZmVhdHVyZXNfZW5hYmxlZCA9ICgoKCh1aW50NjRf
dClmZWF0dXJlX21hc2tbMF0gPDwgU01VX0ZFQVRVUkVTX0xPV19TSElGVCkgJiBTTVVfRkVBVFVS
RVNfTE9XX01BU0spIHwKKwkJCSgoKHVpbnQ2NF90KWZlYXR1cmVfbWFza1sxXSA8PCBTTVVfRkVB
VFVSRVNfSElHSF9TSElGVCkgJiBTTVVfRkVBVFVSRVNfSElHSF9NQVNLKSk7CisKKwlyZXR1cm4g
cmV0OworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9lbmFibGVfc21jX2ZlYXR1cmVzKHN0cnVjdCBz
bXVfY29udGV4dCAqc211LAorCQlib29sIGVuYWJsZSwgdWludDY0X3QgZmVhdHVyZV9tYXNrKQor
eworCXVpbnQzMl90IHNtdV9mZWF0dXJlc19sb3csIHNtdV9mZWF0dXJlc19oaWdoOworCWludCBy
ZXQgPSAwOworCisJc211X2ZlYXR1cmVzX2xvdyA9ICh1aW50MzJfdCkoKGZlYXR1cmVfbWFzayAm
IFNNVV9GRUFUVVJFU19MT1dfTUFTSykgPj4gU01VX0ZFQVRVUkVTX0xPV19TSElGVCk7CisJc211
X2ZlYXR1cmVzX2hpZ2ggPSAodWludDMyX3QpKChmZWF0dXJlX21hc2sgJiBTTVVfRkVBVFVSRVNf
SElHSF9NQVNLKSA+PiBTTVVfRkVBVFVSRVNfSElHSF9TSElGVCk7CisKKwlpZiAoZW5hYmxlKSB7
CisJCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfRW5hYmxl
U211RmVhdHVyZXNMb3csCisJCQkJCQkgIHNtdV9mZWF0dXJlc19sb3cpOworCQlpZiAocmV0KQor
CQkJcmV0dXJuIHJldDsKKwkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwg
U01VX01TR19FbmFibGVTbXVGZWF0dXJlc0hpZ2gsCisJCQkJCQkgIHNtdV9mZWF0dXJlc19oaWdo
KTsKKwkJaWYgKHJldCkKKwkJCXJldHVybiByZXQ7CisJfSBlbHNlIHsKKwkJcmV0ID0gc211X3Nl
bmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwgU01VX01TR19EaXNhYmxlU211RmVhdHVyZXNMb3cs
CisJCQkJCQkgIHNtdV9mZWF0dXJlc19sb3cpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsK
KwkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwgU01VX01TR19EaXNhYmxl
U211RmVhdHVyZXNIaWdoLAorCQkJCQkJICBzbXVfZmVhdHVyZXNfaGlnaCk7CisJCWlmIChyZXQp
CisJCQlyZXR1cm4gcmV0OworCX0KKworCXJldHVybiAwOworCit9CisKK3N0YXRpYyBpbnQgdmVn
YTIwX2dldF9wcGZlYXR1cmVfc3RhdHVzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBjaGFyICpi
dWYpCit7CisJc3RhdGljIGNvbnN0IGNoYXIgKnBwZmVhdHVyZV9uYW1lW10gPSB7CisJCQkJIkRQ
TV9QUkVGRVRDSEVSIiwKKwkJCQkiR0ZYQ0xLX0RQTSIsCisJCQkJIlVDTEtfRFBNIiwKKwkJCQki
U09DQ0xLX0RQTSIsCisJCQkJIlVWRF9EUE0iLAorCQkJCSJWQ0VfRFBNIiwKKwkJCQkiVUxWIiwK
KwkJCQkiTVAwQ0xLX0RQTSIsCisJCQkJIkxJTktfRFBNIiwKKwkJCQkiRENFRkNMS19EUE0iLAor
CQkJCSJHRlhDTEtfRFMiLAorCQkJCSJTT0NDTEtfRFMiLAorCQkJCSJMQ0xLX0RTIiwKKwkJCQki
UFBUIiwKKwkJCQkiVERDIiwKKwkJCQkiVEhFUk1BTCIsCisJCQkJIkdGWF9QRVJfQ1VfQ0ciLAor
CQkJCSJSTSIsCisJCQkJIkRDRUZDTEtfRFMiLAorCQkJCSJBQ0RDIiwKKwkJCQkiVlIwSE9UIiwK
KwkJCQkiVlIxSE9UIiwKKwkJCQkiRldfQ1RGIiwKKwkJCQkiTEVEX0RJU1BMQVkiLAorCQkJCSJG
QU5fQ09OVFJPTCIsCisJCQkJIkdGWF9FREMiLAorCQkJCSJHRlhPRkYiLAorCQkJCSJDRyIsCisJ
CQkJIkZDTEtfRFBNIiwKKwkJCQkiRkNMS19EUyIsCisJCQkJIk1QMUNMS19EUyIsCisJCQkJIk1Q
MENMS19EUyIsCisJCQkJIlhHTUkiLAorCQkJCSJFQ0MifTsKKwlzdGF0aWMgY29uc3QgY2hhciAq
b3V0cHV0X3RpdGxlW10gPSB7CisJCQkJIkZFQVRVUkVTIiwKKwkJCQkiQklUTUFTSyIsCisJCQkJ
IkVOQUJMRU1FTlQifTsKKwl1aW50NjRfdCBmZWF0dXJlc19lbmFibGVkOworCWludCBpOworCWlu
dCByZXQgPSAwOworCWludCBzaXplID0gMDsKKworCXJldCA9IHZlZ2EyMF9nZXRfZW5hYmxlZF9z
bWNfZmVhdHVyZXMoc211LCAmZmVhdHVyZXNfZW5hYmxlZCk7CisJaWYgKHJldCkKKwkJcmV0dXJu
IHJldDsKKworCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiQ3VycmVudCBwcGZlYXR1cmVz
OiAweCUwMTZsbHhcbiIsIGZlYXR1cmVzX2VuYWJsZWQpOworCXNpemUgKz0gc3ByaW50ZihidWYg
KyBzaXplLCAiJS0xOXMgJS0yMnMgJXNcbiIsCisJCQkJb3V0cHV0X3RpdGxlWzBdLAorCQkJCW91
dHB1dF90aXRsZVsxXSwKKwkJCQlvdXRwdXRfdGl0bGVbMl0pOworCWZvciAoaSA9IDA7IGkgPCBH
TkxEX0ZFQVRVUkVTX01BWDsgaSsrKSB7CisJCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAi
JS0xOXMgMHglMDE2bGx4ICU2c1xuIiwKKwkJCQkJcHBmZWF0dXJlX25hbWVbaV0sCisJCQkJCTFV
TEwgPDwgaSwKKwkJCQkJKGZlYXR1cmVzX2VuYWJsZWQgJiAoMVVMTCA8PCBpKSkgPyAiWSIgOiAi
TiIpOworCX0KKworCXJldHVybiBzaXplOworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9zZXRfcHBm
ZWF0dXJlX3N0YXR1cyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDY0X3QgbmV3X3BwZmVh
dHVyZV9tYXNrcykKK3sKKwl1aW50NjRfdCBmZWF0dXJlc19lbmFibGVkOworCXVpbnQ2NF90IGZl
YXR1cmVzX3RvX2VuYWJsZTsKKwl1aW50NjRfdCBmZWF0dXJlc190b19kaXNhYmxlOworCWludCBy
ZXQgPSAwOworCisJaWYgKG5ld19wcGZlYXR1cmVfbWFza3MgPj0gKDFVTEwgPDwgR05MRF9GRUFU
VVJFU19NQVgpKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXJldCA9IHZlZ2EyMF9nZXRfZW5hYmxl
ZF9zbWNfZmVhdHVyZXMoc211LCAmZmVhdHVyZXNfZW5hYmxlZCk7CisJaWYgKHJldCkKKwkJcmV0
dXJuIHJldDsKKworCWZlYXR1cmVzX3RvX2Rpc2FibGUgPQorCQlmZWF0dXJlc19lbmFibGVkICYg
fm5ld19wcGZlYXR1cmVfbWFza3M7CisJZmVhdHVyZXNfdG9fZW5hYmxlID0KKwkJfmZlYXR1cmVz
X2VuYWJsZWQgJiBuZXdfcHBmZWF0dXJlX21hc2tzOworCisJcHJfZGVidWcoImZlYXR1cmVzX3Rv
X2Rpc2FibGUgMHglbGx4XG4iLCBmZWF0dXJlc190b19kaXNhYmxlKTsKKwlwcl9kZWJ1ZygiZmVh
dHVyZXNfdG9fZW5hYmxlIDB4JWxseFxuIiwgZmVhdHVyZXNfdG9fZW5hYmxlKTsKKworCWlmIChm
ZWF0dXJlc190b19kaXNhYmxlKSB7CisJCXJldCA9IHZlZ2EyMF9lbmFibGVfc21jX2ZlYXR1cmVz
KHNtdSwgZmFsc2UsIGZlYXR1cmVzX3RvX2Rpc2FibGUpOworCQlpZiAocmV0KQorCQkJcmV0dXJu
IHJldDsKKwl9CisKKwlpZiAoZmVhdHVyZXNfdG9fZW5hYmxlKSB7CisJCXJldCA9IHZlZ2EyMF9l
bmFibGVfc21jX2ZlYXR1cmVzKHNtdSwgdHJ1ZSwgZmVhdHVyZXNfdG9fZW5hYmxlKTsKKwkJaWYg
KHJldCkKKwkJCXJldHVybiByZXQ7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBib29s
IHZlZ2EyMF9pc19kcG1fcnVubmluZyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKK3sKKwlpbnQg
cmV0ID0gMDsKKwl1aW50MzJfdCBmZWF0dXJlX21hc2tbMl07CisJdW5zaWduZWQgbG9uZyBmZWF0
dXJlX2VuYWJsZWQ7CisJcmV0ID0gc211X2ZlYXR1cmVfZ2V0X2VuYWJsZWRfbWFzayhzbXUsIGZl
YXR1cmVfbWFzaywgMik7CisJZmVhdHVyZV9lbmFibGVkID0gKHVuc2lnbmVkIGxvbmcpKCh1aW50
NjRfdClmZWF0dXJlX21hc2tbMF0gfAorCQkJICAgKCh1aW50NjRfdClmZWF0dXJlX21hc2tbMV0g
PDwgMzIpKTsKKwlyZXR1cm4gISEoZmVhdHVyZV9lbmFibGVkICYgU01DX0RQTV9GRUFUVVJFKTsK
K30KKworc3RhdGljIGludCB2ZWdhMjBfc2V0X3RoZXJtYWxfZmFuX3RhYmxlKHN0cnVjdCBzbXVf
Y29udGV4dCAqc211KQoreworCWludCByZXQ7CisJc3RydWN0IHNtdV90YWJsZV9jb250ZXh0ICp0
YWJsZV9jb250ZXh0ID0gJnNtdS0+c211X3RhYmxlOworCVBQVGFibGVfdCAqcHB0YWJsZSA9IHRh
YmxlX2NvbnRleHQtPmRyaXZlcl9wcHRhYmxlOworCisJcmV0ID0gc211X3NlbmRfc21jX21zZ193
aXRoX3BhcmFtKHNtdSwgU01VX01TR19TZXRGYW5UZW1wZXJhdHVyZVRhcmdldCwKKwkJCSh1aW50
MzJfdClwcHRhYmxlLT5GYW5UYXJnZXRUZW1wZXJhdHVyZSk7CisKKwlyZXR1cm4gcmV0OworfQor
CitzdGF0aWMgaW50IHZlZ2EyMF9nZXRfZmFuX3NwZWVkX3BlcmNlbnQoc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUsCisJCQkJCXVpbnQzMl90ICpzcGVlZCkKK3sKKwlpbnQgcmV0ID0gMDsKKwl1aW50
MzJfdCBwZXJjZW50ID0gMDsKKwl1aW50MzJfdCBjdXJyZW50X3JwbTsKKwlQUFRhYmxlX3QgKnBw
dGFibGUgPSBzbXUtPnNtdV90YWJsZS5kcml2ZXJfcHB0YWJsZTsKKworCXJldCA9IHNtdV9nZXRf
Y3VycmVudF9ycG0oc211LCAmY3VycmVudF9ycG0pOworCXBlcmNlbnQgPSBjdXJyZW50X3JwbSAq
IDEwMCAvIHBwdGFibGUtPkZhbk1heGltdW1ScG07CisJKnNwZWVkID0gcGVyY2VudCA+IDEwMCA/
IDEwMCA6IHBlcmNlbnQ7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHZlZ2EyMF9n
ZXRfZ3B1X3Bvd2VyKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1aW50MzJfdCAqdmFsdWUpCit7
CisJaW50IHJldCA9IDA7CisJU211TWV0cmljc190IG1ldHJpY3M7CisKKwlpZiAoIXZhbHVlKQor
CQlyZXR1cm4gLUVJTlZBTDsKKworCXJldCA9IHZlZ2EyMF9nZXRfbWV0cmljc190YWJsZShzbXUs
ICZtZXRyaWNzKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJKnZhbHVlID0gbWV0cmlj
cy5DdXJyU29ja2V0UG93ZXIgPDwgODsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHZl
Z2EyMF9nZXRfY3VycmVudF9hY3Rpdml0eV9wZXJjZW50KHN0cnVjdCBzbXVfY29udGV4dCAqc211
LAorCQkJCQkgICAgICAgZW51bSBhbWRfcHBfc2Vuc29ycyBzZW5zb3IsCisJCQkJCSAgICAgICB1
aW50MzJfdCAqdmFsdWUpCit7CisJaW50IHJldCA9IDA7CisJU211TWV0cmljc190IG1ldHJpY3M7
CisKKwlpZiAoIXZhbHVlKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXJldCA9IHZlZ2EyMF9nZXRf
bWV0cmljc190YWJsZShzbXUsICZtZXRyaWNzKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0Owor
CisJc3dpdGNoIChzZW5zb3IpIHsKKwljYXNlIEFNREdQVV9QUF9TRU5TT1JfR1BVX0xPQUQ6CisJ
CSp2YWx1ZSA9IG1ldHJpY3MuQXZlcmFnZUdmeEFjdGl2aXR5OworCQlicmVhazsKKwljYXNlIEFN
REdQVV9QUF9TRU5TT1JfTUVNX0xPQUQ6CisJCSp2YWx1ZSA9IG1ldHJpY3MuQXZlcmFnZVVjbGtB
Y3Rpdml0eTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJcHJfZXJyKCJJbnZhbGlkIHNlbnNvciBm
b3IgcmV0cmlldmluZyBjbG9jayBhY3Rpdml0eVxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0K
KworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHZlZ2EyMF90aGVybWFsX2dldF90ZW1wZXJh
dHVyZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKKwkJCQkJICAgICBlbnVtIGFtZF9wcF9zZW5z
b3JzIHNlbnNvciwKKwkJCQkJICAgICB1aW50MzJfdCAqdmFsdWUpCit7CisJc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYgPSBzbXUtPmFkZXY7CisJU211TWV0cmljc190IG1ldHJpY3M7CisJdWlu
dDMyX3QgdGVtcCA9IDA7CisJaW50IHJldCA9IDA7CisKKwlpZiAoIXZhbHVlKQorCQlyZXR1cm4g
LUVJTlZBTDsKKworCXJldCA9IHZlZ2EyMF9nZXRfbWV0cmljc190YWJsZShzbXUsICZtZXRyaWNz
KTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJc3dpdGNoIChzZW5zb3IpIHsKKwljYXNl
IEFNREdQVV9QUF9TRU5TT1JfSE9UU1BPVF9URU1QOgorCQl0ZW1wID0gUlJFRzMyX1NPQzE1KFRI
TSwgMCwgbW1DR19NVUxUX1RIRVJNQUxfU1RBVFVTKTsKKwkJdGVtcCA9ICh0ZW1wICYgQ0dfTVVM
VF9USEVSTUFMX1NUQVRVU19fQ1RGX1RFTVBfTUFTSykgPj4KKwkJCQlDR19NVUxUX1RIRVJNQUxf
U1RBVFVTX19DVEZfVEVNUF9fU0hJRlQ7CisKKwkJdGVtcCA9IHRlbXAgJiAweDFmZjsKKwkJdGVt
cCAqPSBTTVVfVEVNUEVSQVRVUkVfVU5JVFNfUEVSX0NFTlRJR1JBREVTOworCisJCSp2YWx1ZSA9
IHRlbXA7CisJCWJyZWFrOworCWNhc2UgQU1ER1BVX1BQX1NFTlNPUl9FREdFX1RFTVA6CisJCSp2
YWx1ZSA9IG1ldHJpY3MuVGVtcGVyYXR1cmVFZGdlICoKKwkJCVNNVV9URU1QRVJBVFVSRV9VTklU
U19QRVJfQ0VOVElHUkFERVM7CisJCWJyZWFrOworCWNhc2UgQU1ER1BVX1BQX1NFTlNPUl9NRU1f
VEVNUDoKKwkJKnZhbHVlID0gbWV0cmljcy5UZW1wZXJhdHVyZUhCTSAqCisJCQlTTVVfVEVNUEVS
QVRVUkVfVU5JVFNfUEVSX0NFTlRJR1JBREVTOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlwcl9l
cnIoIkludmFsaWQgc2Vuc29yIGZvciByZXRyaWV2aW5nIHRlbXBcbiIpOworCQlyZXR1cm4gLUVJ
TlZBTDsKKwl9CisKKwlyZXR1cm4gMDsKK30KK3N0YXRpYyBpbnQgdmVnYTIwX3JlYWRfc2Vuc29y
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LAorCQkJCSBlbnVtIGFtZF9wcF9zZW5zb3JzIHNlbnNv
ciwKKwkJCQkgdm9pZCAqZGF0YSwgdWludDMyX3QgKnNpemUpCit7CisJaW50IHJldCA9IDA7CisJ
c3RydWN0IHNtdV90YWJsZV9jb250ZXh0ICp0YWJsZV9jb250ZXh0ID0gJnNtdS0+c211X3RhYmxl
OworCVBQVGFibGVfdCAqcHB0YWJsZSA9IHRhYmxlX2NvbnRleHQtPmRyaXZlcl9wcHRhYmxlOwor
CisJc3dpdGNoIChzZW5zb3IpIHsKKwljYXNlIEFNREdQVV9QUF9TRU5TT1JfTUFYX0ZBTl9SUE06
CisJCSoodWludDMyX3QgKilkYXRhID0gcHB0YWJsZS0+RmFuTWF4aW11bVJwbTsKKwkJKnNpemUg
PSA0OworCQlicmVhazsKKwljYXNlIEFNREdQVV9QUF9TRU5TT1JfTUVNX0xPQUQ6CisJY2FzZSBB
TURHUFVfUFBfU0VOU09SX0dQVV9MT0FEOgorCQlyZXQgPSB2ZWdhMjBfZ2V0X2N1cnJlbnRfYWN0
aXZpdHlfcGVyY2VudChzbXUsCisJCQkJCQlzZW5zb3IsCisJCQkJCQkodWludDMyX3QgKilkYXRh
KTsKKwkJKnNpemUgPSA0OworCQlicmVhazsKKwljYXNlIEFNREdQVV9QUF9TRU5TT1JfR1BVX1BP
V0VSOgorCQlyZXQgPSB2ZWdhMjBfZ2V0X2dwdV9wb3dlcihzbXUsICh1aW50MzJfdCAqKWRhdGEp
OworCQkqc2l6ZSA9IDQ7CisJCWJyZWFrOworCWNhc2UgQU1ER1BVX1BQX1NFTlNPUl9IT1RTUE9U
X1RFTVA6CisJY2FzZSBBTURHUFVfUFBfU0VOU09SX0VER0VfVEVNUDoKKwljYXNlIEFNREdQVV9Q
UF9TRU5TT1JfTUVNX1RFTVA6CisJCXJldCA9IHZlZ2EyMF90aGVybWFsX2dldF90ZW1wZXJhdHVy
ZShzbXUsIHNlbnNvciwgKHVpbnQzMl90ICopZGF0YSk7CisJCSpzaXplID0gNDsKKwkJYnJlYWs7
CisJZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJcmV0dXJuIHJldDsKK30KKwor
c3RhdGljIGludCB2ZWdhMjBfc2V0X3dhdGVybWFya3NfdGFibGUoc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUsCisJCQkJICAgICAgIHZvaWQgKndhdGVybWFya3MsIHN0cnVjdAorCQkJCSAgICAgICBk
bV9wcF93bV9zZXRzX3dpdGhfY2xvY2tfcmFuZ2VzX3NvYzE1CisJCQkJICAgICAgICpjbG9ja19y
YW5nZXMpCit7CisJaW50IGk7CisJV2F0ZXJtYXJrc190ICp0YWJsZSA9IHdhdGVybWFya3M7CisK
KwlpZiAoIXRhYmxlIHx8ICFjbG9ja19yYW5nZXMpCisJCXJldHVybiAtRUlOVkFMOworCisJaWYg
KGNsb2NrX3Jhbmdlcy0+bnVtX3dtX2RtaWZfc2V0cyA+IDQgfHwKKwkgICAgY2xvY2tfcmFuZ2Vz
LT5udW1fd21fbWNpZl9zZXRzID4gNCkKKyAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsK
KworICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2xvY2tfcmFuZ2VzLT5udW1fd21fZG1pZl9zZXRz
OyBpKyspIHsKKwkJdGFibGUtPldhdGVybWFya1Jvd1sxXVtpXS5NaW5DbG9jayA9CisJCQljcHVf
dG9fbGUxNigodWludDE2X3QpCisJCQkoY2xvY2tfcmFuZ2VzLT53bV9kbWlmX2Nsb2Nrc19yYW5n
ZXNbaV0ud21fbWluX2RjZmNsa19jbGtfaW5fa2h6IC8KKwkJCTEwMDApKTsKKwkJdGFibGUtPldh
dGVybWFya1Jvd1sxXVtpXS5NYXhDbG9jayA9CisJCQljcHVfdG9fbGUxNigodWludDE2X3QpCisJ
CQkoY2xvY2tfcmFuZ2VzLT53bV9kbWlmX2Nsb2Nrc19yYW5nZXNbaV0ud21fbWF4X2RjZmNsa19j
bGtfaW5fa2h6IC8KKwkJCTEwMDApKTsKKwkJdGFibGUtPldhdGVybWFya1Jvd1sxXVtpXS5NaW5V
Y2xrID0KKwkJCWNwdV90b19sZTE2KCh1aW50MTZfdCkKKwkJCShjbG9ja19yYW5nZXMtPndtX2Rt
aWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9taW5fbWVtX2Nsa19pbl9raHogLworCQkJMTAwMCkpOwor
CQl0YWJsZS0+V2F0ZXJtYXJrUm93WzFdW2ldLk1heFVjbGsgPQorCQkJY3B1X3RvX2xlMTYoKHVp
bnQxNl90KQorCQkJKGNsb2NrX3Jhbmdlcy0+d21fZG1pZl9jbG9ja3NfcmFuZ2VzW2ldLndtX21h
eF9tZW1fY2xrX2luX2toeiAvCisJCQkxMDAwKSk7CisJCXRhYmxlLT5XYXRlcm1hcmtSb3dbMV1b
aV0uV21TZXR0aW5nID0gKHVpbnQ4X3QpCisJCQkJY2xvY2tfcmFuZ2VzLT53bV9kbWlmX2Nsb2Nr
c19yYW5nZXNbaV0ud21fc2V0X2lkOworICAgICAgICB9CisKKwlmb3IgKGkgPSAwOyBpIDwgY2xv
Y2tfcmFuZ2VzLT5udW1fd21fbWNpZl9zZXRzOyBpKyspIHsKKwkJdGFibGUtPldhdGVybWFya1Jv
d1swXVtpXS5NaW5DbG9jayA9CisJCQljcHVfdG9fbGUxNigodWludDE2X3QpCisJCQkoY2xvY2tf
cmFuZ2VzLT53bV9tY2lmX2Nsb2Nrc19yYW5nZXNbaV0ud21fbWluX3NvY2Nsa19jbGtfaW5fa2h6
IC8KKwkJCTEwMDApKTsKKwkJdGFibGUtPldhdGVybWFya1Jvd1swXVtpXS5NYXhDbG9jayA9CisJ
CQljcHVfdG9fbGUxNigodWludDE2X3QpCisJCQkoY2xvY2tfcmFuZ2VzLT53bV9tY2lmX2Nsb2Nr
c19yYW5nZXNbaV0ud21fbWF4X3NvY2Nsa19jbGtfaW5fa2h6IC8KKwkJCTEwMDApKTsKKwkJdGFi
bGUtPldhdGVybWFya1Jvd1swXVtpXS5NaW5VY2xrID0KKwkJCWNwdV90b19sZTE2KCh1aW50MTZf
dCkKKwkJCShjbG9ja19yYW5nZXMtPndtX21jaWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9taW5fbWVt
X2Nsa19pbl9raHogLworCQkJMTAwMCkpOworCQl0YWJsZS0+V2F0ZXJtYXJrUm93WzBdW2ldLk1h
eFVjbGsgPQorCQkJY3B1X3RvX2xlMTYoKHVpbnQxNl90KQorCQkJKGNsb2NrX3Jhbmdlcy0+d21f
bWNpZl9jbG9ja3NfcmFuZ2VzW2ldLndtX21heF9tZW1fY2xrX2luX2toeiAvCisJCQkxMDAwKSk7
CisJCXRhYmxlLT5XYXRlcm1hcmtSb3dbMF1baV0uV21TZXR0aW5nID0gKHVpbnQ4X3QpCisJCQkJ
Y2xvY2tfcmFuZ2VzLT53bV9tY2lmX2Nsb2Nrc19yYW5nZXNbaV0ud21fc2V0X2lkOworICAgICAg
ICB9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBzbXVfdGVtcGVyYXR1
cmVfcmFuZ2UgdmVnYTIwX3RoZXJtYWxfcG9saWN5W10gPQoreworCXstMjczMTUwLCAgOTkwMDAs
IDk5MDAwLCAtMjczMTUwLCA5OTAwMCwgOTkwMDAsIC0yNzMxNTAsIDk5MDAwLCA5OTAwMH0sCisJ
eyAxMjAwMDAsIDEyMDAwMCwgMTIwMDAwLCAxMjAwMDAsIDEyMDAwMCwgMTIwMDAwLCAxMjAwMDAs
IDEyMDAwMCwgMTIwMDAwfSwKK307CisKK3N0YXRpYyBpbnQgdmVnYTIwX2dldF90aGVybWFsX3Rl
bXBlcmF0dXJlX3JhbmdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAorCQkJCQkJc3RydWN0IHNt
dV90ZW1wZXJhdHVyZV9yYW5nZSpyYW5nZSkKK3sKKworCVBQVGFibGVfdCAqcHB0YWJsZSA9IHNt
dS0+c211X3RhYmxlLmRyaXZlcl9wcHRhYmxlOworCisJaWYgKCFyYW5nZSkKKwkJcmV0dXJuIC1F
SU5WQUw7CisKKwltZW1jcHkocmFuZ2UsICZ2ZWdhMjBfdGhlcm1hbF9wb2xpY3lbMF0sIHNpemVv
ZihzdHJ1Y3Qgc211X3RlbXBlcmF0dXJlX3JhbmdlKSk7CisKKwlyYW5nZS0+bWF4ID0gcHB0YWJs
ZS0+VGVkZ2VMaW1pdCAqCisJCVNNVV9URU1QRVJBVFVSRV9VTklUU19QRVJfQ0VOVElHUkFERVM7
CisJcmFuZ2UtPmVkZ2VfZW1lcmdlbmN5X21heCA9IChwcHRhYmxlLT5UZWRnZUxpbWl0ICsgQ1RG
X09GRlNFVF9FREdFKSAqCisJCVNNVV9URU1QRVJBVFVSRV9VTklUU19QRVJfQ0VOVElHUkFERVM7
CisJcmFuZ2UtPmhvdHNwb3RfY3JpdF9tYXggPSBwcHRhYmxlLT5UaG90c3BvdExpbWl0ICoKKwkJ
U01VX1RFTVBFUkFUVVJFX1VOSVRTX1BFUl9DRU5USUdSQURFUzsKKwlyYW5nZS0+aG90c3BvdF9l
bWVyZ2VuY3lfbWF4ID0gKHBwdGFibGUtPlRob3RzcG90TGltaXQgKyBDVEZfT0ZGU0VUX0hPVFNQ
T1QpICoKKwkJU01VX1RFTVBFUkFUVVJFX1VOSVRTX1BFUl9DRU5USUdSQURFUzsKKwlyYW5nZS0+
bWVtX2NyaXRfbWF4ID0gcHB0YWJsZS0+VGhibUxpbWl0ICoKKwkJU01VX1RFTVBFUkFUVVJFX1VO
SVRTX1BFUl9DRU5USUdSQURFUzsKKwlyYW5nZS0+bWVtX2VtZXJnZW5jeV9tYXggPSAocHB0YWJs
ZS0+VGhibUxpbWl0ICsgQ1RGX09GRlNFVF9IQk0pKgorCQlTTVVfVEVNUEVSQVRVUkVfVU5JVFNf
UEVSX0NFTlRJR1JBREVTOworCisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVj
dCBwcHRhYmxlX2Z1bmNzIHZlZ2EyMF9wcHRfZnVuY3MgPSB7CisJLnRhYmxlc19pbml0ID0gdmVn
YTIwX3RhYmxlc19pbml0LAorCS5hbGxvY19kcG1fY29udGV4dCA9IHZlZ2EyMF9hbGxvY2F0ZV9k
cG1fY29udGV4dCwKKwkuc3RvcmVfcG93ZXJwbGF5X3RhYmxlID0gdmVnYTIwX3N0b3JlX3Bvd2Vy
cGxheV90YWJsZSwKKwkuY2hlY2tfcG93ZXJwbGF5X3RhYmxlID0gdmVnYTIwX2NoZWNrX3Bvd2Vy
cGxheV90YWJsZSwKKwkuYXBwZW5kX3Bvd2VycGxheV90YWJsZSA9IHZlZ2EyMF9hcHBlbmRfcG93
ZXJwbGF5X3RhYmxlLAorCS5nZXRfc211X21zZ19pbmRleCA9IHZlZ2EyMF9nZXRfc211X21zZ19p
bmRleCwKKwkuZ2V0X3NtdV9jbGtfaW5kZXggPSB2ZWdhMjBfZ2V0X3NtdV9jbGtfaW5kZXgsCisJ
LmdldF9zbXVfZmVhdHVyZV9pbmRleCA9IHZlZ2EyMF9nZXRfc211X2ZlYXR1cmVfaW5kZXgsCisJ
LmdldF9zbXVfdGFibGVfaW5kZXggPSB2ZWdhMjBfZ2V0X3NtdV90YWJsZV9pbmRleCwKKwkuZ2V0
X3NtdV9wb3dlcl9pbmRleCA9IHZlZ2EyMF9nZXRfcHdyX3NyY19pbmRleCwKKwkuZ2V0X3dvcmts
b2FkX3R5cGUgPSB2ZWdhMjBfZ2V0X3dvcmtsb2FkX3R5cGUsCisJLnJ1bl9hZmxsX2J0YyA9IHZl
Z2EyMF9ydW5fYnRjX2FmbGwsCisJLmdldF9hbGxvd2VkX2ZlYXR1cmVfbWFzayA9IHZlZ2EyMF9n
ZXRfYWxsb3dlZF9mZWF0dXJlX21hc2ssCisJLmdldF9jdXJyZW50X3Bvd2VyX3N0YXRlID0gdmVn
YTIwX2dldF9jdXJyZW50X3Bvd2VyX3N0YXRlLAorCS5zZXRfZGVmYXVsdF9kcG1fdGFibGUgPSB2
ZWdhMjBfc2V0X2RlZmF1bHRfZHBtX3RhYmxlLAorCS5zZXRfcG93ZXJfc3RhdGUgPSBOVUxMLAor
CS5wb3B1bGF0ZV91bWRfc3RhdGVfY2xrID0gdmVnYTIwX3BvcHVsYXRlX3VtZF9zdGF0ZV9jbGss
CisJLnByaW50X2Nsa19sZXZlbHMgPSB2ZWdhMjBfcHJpbnRfY2xrX2xldmVscywKKwkuZm9yY2Vf
Y2xrX2xldmVscyA9IHZlZ2EyMF9mb3JjZV9jbGtfbGV2ZWxzLAorCS5nZXRfY2xvY2tfYnlfdHlw
ZV93aXRoX2xhdGVuY3kgPSB2ZWdhMjBfZ2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF9sYXRlbmN5LAor
CS5nZXRfb2RfcGVyY2VudGFnZSA9IHZlZ2EyMF9nZXRfb2RfcGVyY2VudGFnZSwKKwkuZ2V0X3Bv
d2VyX3Byb2ZpbGVfbW9kZSA9IHZlZ2EyMF9nZXRfcG93ZXJfcHJvZmlsZV9tb2RlLAorCS5zZXRf
cG93ZXJfcHJvZmlsZV9tb2RlID0gdmVnYTIwX3NldF9wb3dlcl9wcm9maWxlX21vZGUsCisJLnNl
dF9vZF9wZXJjZW50YWdlID0gdmVnYTIwX3NldF9vZF9wZXJjZW50YWdlLAorCS5zZXRfZGVmYXVs
dF9vZF9zZXR0aW5ncyA9IHZlZ2EyMF9zZXRfZGVmYXVsdF9vZF9zZXR0aW5ncywKKwkub2RfZWRp
dF9kcG1fdGFibGUgPSB2ZWdhMjBfb2RuX2VkaXRfZHBtX3RhYmxlLAorCS5kcG1fc2V0X3V2ZF9l
bmFibGUgPSB2ZWdhMjBfZHBtX3NldF91dmRfZW5hYmxlLAorCS5kcG1fc2V0X3ZjZV9lbmFibGUg
PSB2ZWdhMjBfZHBtX3NldF92Y2VfZW5hYmxlLAorCS5yZWFkX3NlbnNvciA9IHZlZ2EyMF9yZWFk
X3NlbnNvciwKKwkucHJlX2Rpc3BsYXlfY29uZmlnX2NoYW5nZWQgPSB2ZWdhMjBfcHJlX2Rpc3Bs
YXlfY29uZmlnX2NoYW5nZWQsCisJLmRpc3BsYXlfY29uZmlnX2NoYW5nZWQgPSB2ZWdhMjBfZGlz
cGxheV9jb25maWdfY2hhbmdlZCwKKwkuYXBwbHlfY2xvY2tzX2FkanVzdF9ydWxlcyA9IHZlZ2Ey
MF9hcHBseV9jbG9ja3NfYWRqdXN0X3J1bGVzLAorCS5ub3RpZnlfc21jX2Rpc3BhbHlfY29uZmln
ID0gdmVnYTIwX25vdGlmeV9zbWNfZGlzcGFseV9jb25maWcsCisJLmZvcmNlX2RwbV9saW1pdF92
YWx1ZSA9IHZlZ2EyMF9mb3JjZV9kcG1fbGltaXRfdmFsdWUsCisJLnVuZm9yY2VfZHBtX2xldmVs
cyA9IHZlZ2EyMF91bmZvcmNlX2RwbV9sZXZlbHMsCisJLmdldF9wcm9maWxpbmdfY2xrX21hc2sg
PSB2ZWdhMjBfZ2V0X3Byb2ZpbGluZ19jbGtfbWFzaywKKwkuc2V0X3BwZmVhdHVyZV9zdGF0dXMg
PSB2ZWdhMjBfc2V0X3BwZmVhdHVyZV9zdGF0dXMsCisJLmdldF9wcGZlYXR1cmVfc3RhdHVzID0g
dmVnYTIwX2dldF9wcGZlYXR1cmVfc3RhdHVzLAorCS5pc19kcG1fcnVubmluZyA9IHZlZ2EyMF9p
c19kcG1fcnVubmluZywKKwkuc2V0X3RoZXJtYWxfZmFuX3RhYmxlID0gdmVnYTIwX3NldF90aGVy
bWFsX2Zhbl90YWJsZSwKKwkuZ2V0X2Zhbl9zcGVlZF9wZXJjZW50ID0gdmVnYTIwX2dldF9mYW5f
c3BlZWRfcGVyY2VudCwKKwkuc2V0X3dhdGVybWFya3NfdGFibGUgPSB2ZWdhMjBfc2V0X3dhdGVy
bWFya3NfdGFibGUsCisJLmdldF90aGVybWFsX3RlbXBlcmF0dXJlX3JhbmdlID0gdmVnYTIwX2dl
dF90aGVybWFsX3RlbXBlcmF0dXJlX3JhbmdlCit9OworCit2b2lkIHZlZ2EyMF9zZXRfcHB0X2Z1
bmNzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQoreworCXN0cnVjdCBzbXVfdGFibGVfY29udGV4
dCAqc211X3RhYmxlID0gJnNtdS0+c211X3RhYmxlOworCisJc211LT5wcHRfZnVuY3MgPSAmdmVn
YTIwX3BwdF9mdW5jczsKKwlzbXUtPnNtY19pZl92ZXJzaW9uID0gU01VMTFfRFJJVkVSX0lGX1ZF
UlNJT047CisJc211X3RhYmxlLT50YWJsZV9jb3VudCA9IFRBQkxFX0NPVU5UOworfQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcHB0YWJsZS92ZWdhMjBfcHB0Lmgg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9wcHRhYmxlL3ZlZ2EyMF9wcHQuaApuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4yZGMxMGU0Ci0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcHB0YWJsZS92ZWdhMjBfcHB0LmgKQEAg
LTAsMCArMSwxNzkgQEAKKy8qCisgKiBDb3B5cmlnaHQgMjAxOSBBZHZhbmNlZCBNaWNybyBEZXZp
Y2VzLCBJbmMuCisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBj
aGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2Fy
ZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisg
KiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcg
d2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBt
ZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNv
cGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQor
ICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dp
bmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhp
cyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgorICogYWxsIGNvcGllcyBv
ciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCisgKgorICogVEhFIFNPRlRX
QVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVY
UFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdB
UlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFS
IFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUg
Q09QWVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0s
IERBTUFHRVMgT1IKKyAqIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0Yg
Q09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAorICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1Ig
SU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SCisgKiBPVEhFUiBE
RUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCisgKgorICovCisjaWZuZGVmIF9fVkVHQTIwX1BQVF9I
X18KKyNkZWZpbmUgX19WRUdBMjBfUFBUX0hfXworCisjZGVmaW5lIFZFR0EyMF9VTURfUFNUQVRF
X0dGWENMS19MRVZFTCAgICAgICAgIDB4MworI2RlZmluZSBWRUdBMjBfVU1EX1BTVEFURV9TT0ND
TEtfTEVWRUwgICAgICAgICAweDMKKyNkZWZpbmUgVkVHQTIwX1VNRF9QU1RBVEVfTUNMS19MRVZF
TCAgICAgICAgICAgMHgyCisjZGVmaW5lIFZFR0EyMF9VTURfUFNUQVRFX1VWRENMS19MRVZFTCAg
ICAgICAgIDB4MworI2RlZmluZSBWRUdBMjBfVU1EX1BTVEFURV9WQ0VNQ0xLX0xFVkVMICAgICAg
ICAweDMKKworI2RlZmluZSBNQVhfUkVHVUxBUl9EUE1fTlVNQkVSIDE2CisjZGVmaW5lIE1BWF9Q
Q0lFX0NPTkYgMgorCisjZGVmaW5lIFZPTFRBR0VfU0NBTEUgNAorI2RlZmluZSBBVkZTX0NVUlZF
IDAKKyNkZWZpbmUgT0Q4X0hPVENVUlZFX1RFTVBFUkFUVVJFIDg1CisKKyNkZWZpbmUgU01VX0ZF
QVRVUkVTX0xPV19NQVNLICAgICAgICAweDAwMDAwMDAwRkZGRkZGRkYKKyNkZWZpbmUgU01VX0ZF
QVRVUkVTX0xPV19TSElGVCAgICAgICAwCisjZGVmaW5lIFNNVV9GRUFUVVJFU19ISUdIX01BU0sg
ICAgICAgMHhGRkZGRkZGRjAwMDAwMDAwCisjZGVmaW5lIFNNVV9GRUFUVVJFU19ISUdIX1NISUZU
ICAgICAgMzIKKworZW51bSB7CisJR05MRF9EUE1fUFJFRkVUQ0hFUiA9IDAsCisJR05MRF9EUE1f
R0ZYQ0xLLAorCUdOTERfRFBNX1VDTEssCisJR05MRF9EUE1fU09DQ0xLLAorCUdOTERfRFBNX1VW
RCwKKwlHTkxEX0RQTV9WQ0UsCisJR05MRF9VTFYsCisJR05MRF9EUE1fTVAwQ0xLLAorCUdOTERf
RFBNX0xJTkssCisJR05MRF9EUE1fRENFRkNMSywKKwlHTkxEX0RTX0dGWENMSywKKwlHTkxEX0RT
X1NPQ0NMSywKKwlHTkxEX0RTX0xDTEssCisJR05MRF9QUFQsCisJR05MRF9UREMsCisJR05MRF9U
SEVSTUFMLAorCUdOTERfR0ZYX1BFUl9DVV9DRywKKwlHTkxEX1JNLAorCUdOTERfRFNfRENFRkNM
SywKKwlHTkxEX0FDREMsCisJR05MRF9WUjBIT1QsCisJR05MRF9WUjFIT1QsCisJR05MRF9GV19D
VEYsCisJR05MRF9MRURfRElTUExBWSwKKwlHTkxEX0ZBTl9DT05UUk9MLAorCUdOTERfRElEVCwK
KwlHTkxEX0dGWE9GRiwKKwlHTkxEX0NHLAorCUdOTERfRFBNX0ZDTEssCisJR05MRF9EU19GQ0xL
LAorCUdOTERfRFNfTVAxQ0xLLAorCUdOTERfRFNfTVAwQ0xLLAorCUdOTERfWEdNSSwKKwlHTkxE
X0VDQywKKworCUdOTERfRkVBVFVSRVNfTUFYCit9OworCitzdHJ1Y3QgdmVnYTIwX2RwbV9sZXZl
bCB7CisgICAgICAgIGJvb2wgICAgICAgICAgICBlbmFibGVkOworICAgICAgICB1aW50MzJfdCAg
ICAgICAgdmFsdWU7CisgICAgICAgIHVpbnQzMl90ICAgICAgICBwYXJhbTE7Cit9OworCitzdHJ1
Y3QgdmVnYTIwX2RwbV9zdGF0ZSB7CisgICAgICAgIHVpbnQzMl90ICBzb2Z0X21pbl9sZXZlbDsK
KyAgICAgICAgdWludDMyX3QgIHNvZnRfbWF4X2xldmVsOworICAgICAgICB1aW50MzJfdCAgaGFy
ZF9taW5fbGV2ZWw7CisgICAgICAgIHVpbnQzMl90ICBoYXJkX21heF9sZXZlbDsKK307CisKK3N0
cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSB7CisgICAgICAgIHVpbnQzMl90ICAgICAgICAg
ICAgICAgIGNvdW50OworICAgICAgICBzdHJ1Y3QgdmVnYTIwX2RwbV9zdGF0ZSBkcG1fc3RhdGU7
CisgICAgICAgIHN0cnVjdCB2ZWdhMjBfZHBtX2xldmVsIGRwbV9sZXZlbHNbTUFYX1JFR1VMQVJf
RFBNX05VTUJFUl07Cit9OworCitzdHJ1Y3QgdmVnYTIwX3BjaWVfdGFibGUgeworICAgICAgICB1
aW50MTZfdCBjb3VudDsKKyAgICAgICAgdWludDhfdCAgcGNpZV9nZW5bTUFYX1BDSUVfQ09ORl07
CisgICAgICAgIHVpbnQ4X3QgIHBjaWVfbGFuZVtNQVhfUENJRV9DT05GXTsKKyAgICAgICAgdWlu
dDMyX3QgbGNsa1tNQVhfUENJRV9DT05GXTsKK307CisKK3N0cnVjdCB2ZWdhMjBfZHBtX3RhYmxl
IHsKKwlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgIHNvY190YWJsZTsKKyAgICAgICAg
c3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICBnZnhfdGFibGU7CisgICAgICAgIHN0cnVj
dCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAgbWVtX3RhYmxlOworICAgICAgICBzdHJ1Y3QgdmVn
YTIwX3NpbmdsZV9kcG1fdGFibGUgIGVjbGtfdGFibGU7CisgICAgICAgIHN0cnVjdCB2ZWdhMjBf
c2luZ2xlX2RwbV90YWJsZSAgdmNsa190YWJsZTsKKyAgICAgICAgc3RydWN0IHZlZ2EyMF9zaW5n
bGVfZHBtX3RhYmxlICBkY2xrX3RhYmxlOworICAgICAgICBzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9k
cG1fdGFibGUgIGRjZWZfdGFibGU7CisgICAgICAgIHN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90
YWJsZSAgcGl4ZWxfdGFibGU7CisgICAgICAgIHN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJs
ZSAgZGlzcGxheV90YWJsZTsKKyAgICAgICAgc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxl
ICBwaHlfdGFibGU7CisgICAgICAgIHN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAgZmNs
a190YWJsZTsKKyAgICAgICAgc3RydWN0IHZlZ2EyMF9wY2llX3RhYmxlICAgICAgICBwY2llX3Rh
YmxlOworfTsKKworZW51bSBPRDhfRkVBVFVSRV9JRAoreworCU9EOF9HRlhDTEtfTElNSVRTICAg
ICAgICAgICAgICAgPSAxIDw8IDAsCisJT0Q4X0dGWENMS19DVVJWRSAgICAgICAgICAgICAgICA9
IDEgPDwgMSwKKwlPRDhfVUNMS19NQVggICAgICAgICAgICAgICAgICAgID0gMSA8PCAyLAorCU9E
OF9QT1dFUl9MSU1JVCAgICAgICAgICAgICAgICAgPSAxIDw8IDMsCisJT0Q4X0FDT1VTVElDX0xJ
TUlUX1NDTEsgICAgICAgICA9IDEgPDwgNCwgICAvL0Zhbk1heGltdW1ScG0KKwlPRDhfRkFOX1NQ
RUVEX01JTiAgICAgICAgICAgICAgID0gMSA8PCA1LCAgIC8vRmFuTWluaW11bVB3bQorCU9EOF9U
RU1QRVJBVFVSRV9GQU4gICAgICAgICAgICAgPSAxIDw8IDYsICAgLy9GYW5UYXJnZXRUZW1wZXJh
dHVyZQorCU9EOF9URU1QRVJBVFVSRV9TWVNURU0gICAgICAgICAgPSAxIDw8IDcsICAgLy9NYXhP
cFRlbXAKKwlPRDhfTUVNT1JZX1RJTUlOR19UVU5FICAgICAgICAgID0gMSA8PCA4LAorCU9EOF9G
QU5fWkVST19SUE1fQ09OVFJPTCAgICAgICAgPSAxIDw8IDkKK307CisKK2VudW0gT0Q4X1NFVFRJ
TkdfSUQKK3sKKwlPRDhfU0VUVElOR19HRlhDTEtfRk1JTiA9IDAsCisJT0Q4X1NFVFRJTkdfR0ZY
Q0xLX0ZNQVgsCisJT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVExLAorCU9EOF9TRVRUSU5HX0dGWENM
S19WT0xUQUdFMSwKKwlPRDhfU0VUVElOR19HRlhDTEtfRlJFUTIsCisJT0Q4X1NFVFRJTkdfR0ZY
Q0xLX1ZPTFRBR0UyLAorCU9EOF9TRVRUSU5HX0dGWENMS19GUkVRMywKKwlPRDhfU0VUVElOR19H
RlhDTEtfVk9MVEFHRTMsCisJT0Q4X1NFVFRJTkdfVUNMS19GTUFYLAorCU9EOF9TRVRUSU5HX1BP
V0VSX1BFUkNFTlRBR0UsCisJT0Q4X1NFVFRJTkdfRkFOX0FDT1VTVElDX0xJTUlULAorCU9EOF9T
RVRUSU5HX0ZBTl9NSU5fU1BFRUQsCisJT0Q4X1NFVFRJTkdfRkFOX1RBUkdFVF9URU1QLAorCU9E
OF9TRVRUSU5HX09QRVJBVElOR19URU1QX01BWCwKKwlPRDhfU0VUVElOR19BQ19USU1JTkcsCisJ
T0Q4X1NFVFRJTkdfRkFOX1pFUk9fUlBNX0NPTlRST0wsCisJT0Q4X1NFVFRJTkdfQ09VTlQKK307
CisKK3N0cnVjdCB2ZWdhMjBfb2Q4X3NpbmdsZV9zZXR0aW5nIHsKKwl1aW50MzJfdAlmZWF0dXJl
X2lkOworCWludDMyX3QJCW1pbl92YWx1ZTsKKwlpbnQzMl90CQltYXhfdmFsdWU7CisJaW50MzJf
dAkJY3VycmVudF92YWx1ZTsKKwlpbnQzMl90CQlkZWZhdWx0X3ZhbHVlOworfTsKKworc3RydWN0
IHZlZ2EyMF9vZDhfc2V0dGluZ3MgeworCXN0cnVjdCB2ZWdhMjBfb2Q4X3NpbmdsZV9zZXR0aW5n
CW9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19DT1VOVF07CisJdWludDhfdAkJCQkqb2Rf
ZmVhdHVyZV9jYXBhYmlsaXRpZXM7CisJdWludDMyX3QJCQkqb2Rfc2V0dGluZ3NfbWF4OworCXVp
bnQzMl90CQkJKm9kX3NldHRpbmdzX21pbjsKKwl2b2lkCQkJCSpvZDhfc2V0dGluZ3M7CisJYm9v
bAkJCQlvZF9nZnhjbGtfdXBkYXRlOworCWJvb2wJCQkJb2RfbWVtY2xrX3VwZGF0ZTsKK307CisK
K2V4dGVybiB2b2lkIHZlZ2EyMF9zZXRfcHB0X2Z1bmNzKHN0cnVjdCBzbXVfY29udGV4dCAqc211
KTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92
ZWdhMjBfcHB0LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92ZWdhMjBfcHB0LmMK
ZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDlhNTM1ZjcuLjAwMDAwMDAKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvdmVnYTIwX3BwdC5jCisrKyAvZGV2L251bGwKQEAg
LTEsMzMwMiArMCwwIEBACi0vKgotICogQ29weXJpZ2h0IDIwMTkgQWR2YW5jZWQgTWljcm8gRGV2
aWNlcywgSW5jLgotICoKLSAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2Yg
Y2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCi0gKiBjb3B5IG9mIHRoaXMgc29mdHdh
cmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAot
ICogdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5n
IHdpdGhvdXQgbGltaXRhdGlvbgotICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwg
bWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCi0gKiBhbmQvb3Igc2VsbCBj
b3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUK
LSAqIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93
aW5nIGNvbmRpdGlvbnM6Ci0gKgotICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRo
aXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KLSAqIGFsbCBjb3BpZXMg
b3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgotICoKLSAqIFRIRSBTT0ZU
V0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBF
WFBSRVNTIE9SCi0gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBX
QVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKLSAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxB
UiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAotICogVEhF
IENPUFlSSUdIVCBIT0xERVIoUykgT1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlN
LCBEQU1BR0VTIE9SCi0gKiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9G
IENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwKLSAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9S
IElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgotICogT1RIRVIg
REVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgotICoKLSAqLwotCi0jaW5jbHVkZSAicHBfZGVidWcu
aCIKLSNpbmNsdWRlIDxsaW51eC9maXJtd2FyZS5oPgotI2luY2x1ZGUgImFtZGdwdS5oIgotI2lu
Y2x1ZGUgImFtZGdwdV9zbXUuaCIKLSNpbmNsdWRlICJhdG9tZmlybXdhcmUuaCIKLSNpbmNsdWRl
ICJhbWRncHVfYXRvbWZpcm13YXJlLmgiCi0jaW5jbHVkZSAic211X3YxMV8wLmgiCi0jaW5jbHVk
ZSAic211MTFfZHJpdmVyX2lmLmgiCi0jaW5jbHVkZSAic29jMTVfY29tbW9uLmgiCi0jaW5jbHVk
ZSAiYXRvbS5oIgotI2luY2x1ZGUgInBvd2VyX3N0YXRlLmgiCi0jaW5jbHVkZSAidmVnYTIwX3Bw
dC5oIgotI2luY2x1ZGUgInZlZ2EyMF9wcHRhYmxlLmgiCi0jaW5jbHVkZSAidmVnYTIwX3Bwc21j
LmgiCi0jaW5jbHVkZSAibmJpby9uYmlvXzdfNF9zaF9tYXNrLmgiCi0jaW5jbHVkZSAiYXNpY19y
ZWcvdGhtL3RobV8xMV8wXzJfb2Zmc2V0LmgiCi0jaW5jbHVkZSAiYXNpY19yZWcvdGhtL3RobV8x
MV8wXzJfc2hfbWFzay5oIgotCi0jZGVmaW5lIHNtblBDSUVfTENfU1BFRURfQ05UTAkJCTB4MTEx
NDAyOTAKLSNkZWZpbmUgc21uUENJRV9MQ19MSU5LX1dJRFRIX0NOVEwJCTB4MTExNDAyODgKLQot
I2RlZmluZSBDVEZfT0ZGU0VUX0VER0UJCQk1Ci0jZGVmaW5lIENURl9PRkZTRVRfSE9UU1BPVAkJ
NQotI2RlZmluZSBDVEZfT0ZGU0VUX0hCTQkJCTUKLQotI2RlZmluZSBNU0dfTUFQKG1zZykgXAot
CVtTTVVfTVNHXyMjbXNnXSA9IFBQU01DX01TR18jI21zZwotCi0jZGVmaW5lIFNNQ19EUE1fRkVB
VFVSRSAoRkVBVFVSRV9EUE1fUFJFRkVUQ0hFUl9NQVNLIHwgXAotCQkJIEZFQVRVUkVfRFBNX0dG
WENMS19NQVNLIHwgXAotCQkJIEZFQVRVUkVfRFBNX1VDTEtfTUFTSyB8IFwKLQkJCSBGRUFUVVJF
X0RQTV9TT0NDTEtfTUFTSyB8IFwKLQkJCSBGRUFUVVJFX0RQTV9VVkRfTUFTSyB8IFwKLQkJCSBG
RUFUVVJFX0RQTV9WQ0VfTUFTSyB8IFwKLQkJCSBGRUFUVVJFX0RQTV9NUDBDTEtfTUFTSyB8IFwK
LQkJCSBGRUFUVVJFX0RQTV9MSU5LX01BU0sgfCBcCi0JCQkgRkVBVFVSRV9EUE1fRENFRkNMS19N
QVNLKQotCi1zdGF0aWMgaW50IHZlZ2EyMF9tZXNzYWdlX21hcFtTTVVfTVNHX01BWF9DT1VOVF0g
PSB7Ci0JTVNHX01BUChUZXN0TWVzc2FnZSksCi0JTVNHX01BUChHZXRTbXVWZXJzaW9uKSwKLQlN
U0dfTUFQKEdldERyaXZlcklmVmVyc2lvbiksCi0JTVNHX01BUChTZXRBbGxvd2VkRmVhdHVyZXNN
YXNrTG93KSwKLQlNU0dfTUFQKFNldEFsbG93ZWRGZWF0dXJlc01hc2tIaWdoKSwKLQlNU0dfTUFQ
KEVuYWJsZUFsbFNtdUZlYXR1cmVzKSwKLQlNU0dfTUFQKERpc2FibGVBbGxTbXVGZWF0dXJlcyks
Ci0JTVNHX01BUChFbmFibGVTbXVGZWF0dXJlc0xvdyksCi0JTVNHX01BUChFbmFibGVTbXVGZWF0
dXJlc0hpZ2gpLAotCU1TR19NQVAoRGlzYWJsZVNtdUZlYXR1cmVzTG93KSwKLQlNU0dfTUFQKERp
c2FibGVTbXVGZWF0dXJlc0hpZ2gpLAotCU1TR19NQVAoR2V0RW5hYmxlZFNtdUZlYXR1cmVzTG93
KSwKLQlNU0dfTUFQKEdldEVuYWJsZWRTbXVGZWF0dXJlc0hpZ2gpLAotCU1TR19NQVAoU2V0V29y
a2xvYWRNYXNrKSwKLQlNU0dfTUFQKFNldFBwdExpbWl0KSwKLQlNU0dfTUFQKFNldERyaXZlckRy
YW1BZGRySGlnaCksCi0JTVNHX01BUChTZXREcml2ZXJEcmFtQWRkckxvdyksCi0JTVNHX01BUChT
ZXRUb29sc0RyYW1BZGRySGlnaCksCi0JTVNHX01BUChTZXRUb29sc0RyYW1BZGRyTG93KSwKLQlN
U0dfTUFQKFRyYW5zZmVyVGFibGVTbXUyRHJhbSksCi0JTVNHX01BUChUcmFuc2ZlclRhYmxlRHJh
bTJTbXUpLAotCU1TR19NQVAoVXNlRGVmYXVsdFBQVGFibGUpLAotCU1TR19NQVAoVXNlQmFja3Vw
UFBUYWJsZSksCi0JTVNHX01BUChSdW5CdGMpLAotCU1TR19NQVAoUmVxdWVzdEkyQ0J1cyksCi0J
TVNHX01BUChSZWxlYXNlSTJDQnVzKSwKLQlNU0dfTUFQKFNldEZsb29yU29jVm9sdGFnZSksCi0J
TVNHX01BUChTb2Z0UmVzZXQpLAotCU1TR19NQVAoU3RhcnRCYWNvTW9uaXRvciksCi0JTVNHX01B
UChDYW5jZWxCYWNvTW9uaXRvciksCi0JTVNHX01BUChFbnRlckJhY28pLAotCU1TR19NQVAoU2V0
U29mdE1pbkJ5RnJlcSksCi0JTVNHX01BUChTZXRTb2Z0TWF4QnlGcmVxKSwKLQlNU0dfTUFQKFNl
dEhhcmRNaW5CeUZyZXEpLAotCU1TR19NQVAoU2V0SGFyZE1heEJ5RnJlcSksCi0JTVNHX01BUChH
ZXRNaW5EcG1GcmVxKSwKLQlNU0dfTUFQKEdldE1heERwbUZyZXEpLAotCU1TR19NQVAoR2V0RHBt
RnJlcUJ5SW5kZXgpLAotCU1TR19NQVAoR2V0RHBtQ2xvY2tGcmVxKSwKLQlNU0dfTUFQKEdldFNz
Vm9sdGFnZUJ5RHBtKSwKLQlNU0dfTUFQKFNldE1lbW9yeUNoYW5uZWxDb25maWcpLAotCU1TR19N
QVAoU2V0R2VtaW5pTW9kZSksCi0JTVNHX01BUChTZXRHZW1pbmlBcGVydHVyZUhpZ2gpLAotCU1T
R19NQVAoU2V0R2VtaW5pQXBlcnR1cmVMb3cpLAotCU1TR19NQVAoU2V0TWluTGlua0RwbUJ5SW5k
ZXgpLAotCU1TR19NQVAoT3ZlcnJpZGVQY2llUGFyYW1ldGVycyksCi0JTVNHX01BUChPdmVyRHJp
dmVTZXRQZXJjZW50YWdlKSwKLQlNU0dfTUFQKFNldE1pbkRlZXBTbGVlcERjZWZjbGspLAotCU1T
R19NQVAoUmVlbmFibGVBY0RjSW50ZXJydXB0KSwKLQlNU0dfTUFQKE5vdGlmeVBvd2VyU291cmNl
KSwKLQlNU0dfTUFQKFNldFVjbGtGYXN0U3dpdGNoKSwKLQlNU0dfTUFQKFNldFVjbGtEb3duSHlz
dCksCi0JTVNHX01BUChHZXRDdXJyZW50UnBtKSwKLQlNU0dfTUFQKFNldFZpZGVvRnBzKSwKLQlN
U0dfTUFQKFNldFRqTWF4KSwKLQlNU0dfTUFQKFNldEZhblRlbXBlcmF0dXJlVGFyZ2V0KSwKLQlN
U0dfTUFQKFByZXBhcmVNcDFGb3JVbmxvYWQpLAotCU1TR19NQVAoRHJhbUxvZ1NldERyYW1BZGRy
SGlnaCksCi0JTVNHX01BUChEcmFtTG9nU2V0RHJhbUFkZHJMb3cpLAotCU1TR19NQVAoRHJhbUxv
Z1NldERyYW1TaXplKSwKLQlNU0dfTUFQKFNldEZhbk1heFJwbSksCi0JTVNHX01BUChTZXRGYW5N
aW5Qd20pLAotCU1TR19NQVAoQ29uZmlndXJlR2Z4RGlkdCksCi0JTVNHX01BUChOdW1PZkRpc3Bs
YXlzKSwKLQlNU0dfTUFQKFJlbW92ZU1hcmdpbnMpLAotCU1TR19NQVAoUmVhZFNlcmlhbE51bVRv
cDMyKSwKLQlNU0dfTUFQKFJlYWRTZXJpYWxOdW1Cb3R0b20zMiksCi0JTVNHX01BUChTZXRTeXN0
ZW1WaXJ0dWFsRHJhbUFkZHJIaWdoKSwKLQlNU0dfTUFQKFNldFN5c3RlbVZpcnR1YWxEcmFtQWRk
ckxvdyksCi0JTVNHX01BUChXYWZsVGVzdCksCi0JTVNHX01BUChTZXRGY2xrR2Z4Q2xrUmF0aW8p
LAotCU1TR19NQVAoQWxsb3dHZnhPZmYpLAotCU1TR19NQVAoRGlzYWxsb3dHZnhPZmYpLAotCU1T
R19NQVAoR2V0UHB0TGltaXQpLAotCU1TR19NQVAoR2V0RGNNb2RlTWF4RHBtRnJlcSksCi0JTVNH
X01BUChHZXREZWJ1Z0RhdGEpLAotCU1TR19NQVAoU2V0WGdtaU1vZGUpLAotCU1TR19NQVAoUnVu
QWZsbEJ0YyksCi0JTVNHX01BUChFeGl0QmFjbyksCi0JTVNHX01BUChQcmVwYXJlTXAxRm9yUmVz
ZXQpLAotCU1TR19NQVAoUHJlcGFyZU1wMUZvclNodXRkb3duKSwKLQlNU0dfTUFQKFNldE1HcHVG
YW5Cb29zdExpbWl0UnBtKSwKLQlNU0dfTUFQKEdldEFWRlNWb2x0YWdlQnlEcG0pLAotfTsKLQot
c3RhdGljIGludCB2ZWdhMjBfY2xrX21hcFtTTVVfQ0xLX0NPVU5UXSA9IHsKLQlDTEtfTUFQKEdG
WENMSywgUFBDTEtfR0ZYQ0xLKSwKLQlDTEtfTUFQKFZDTEssIFBQQ0xLX1ZDTEspLAotCUNMS19N
QVAoRENMSywgUFBDTEtfRENMSyksCi0JQ0xLX01BUChFQ0xLLCBQUENMS19FQ0xLKSwKLQlDTEtf
TUFQKFNPQ0NMSywgUFBDTEtfU09DQ0xLKSwKLQlDTEtfTUFQKFVDTEssIFBQQ0xLX1VDTEspLAot
CUNMS19NQVAoRENFRkNMSywgUFBDTEtfRENFRkNMSyksCi0JQ0xLX01BUChESVNQQ0xLLCBQUENM
S19ESVNQQ0xLKSwKLQlDTEtfTUFQKFBJWENMSywgUFBDTEtfUElYQ0xLKSwKLQlDTEtfTUFQKFBI
WUNMSywgUFBDTEtfUEhZQ0xLKSwKLQlDTEtfTUFQKEZDTEssIFBQQ0xLX0ZDTEspLAotfTsKLQot
c3RhdGljIGludCB2ZWdhMjBfZmVhdHVyZV9tYXNrX21hcFtTTVVfRkVBVFVSRV9DT1VOVF0gPSB7
Ci0JRkVBX01BUChEUE1fUFJFRkVUQ0hFUiksCi0JRkVBX01BUChEUE1fR0ZYQ0xLKSwKLQlGRUFf
TUFQKERQTV9VQ0xLKSwKLQlGRUFfTUFQKERQTV9TT0NDTEspLAotCUZFQV9NQVAoRFBNX1VWRCks
Ci0JRkVBX01BUChEUE1fVkNFKSwKLQlGRUFfTUFQKFVMViksCi0JRkVBX01BUChEUE1fTVAwQ0xL
KSwKLQlGRUFfTUFQKERQTV9MSU5LKSwKLQlGRUFfTUFQKERQTV9EQ0VGQ0xLKSwKLQlGRUFfTUFQ
KERTX0dGWENMSyksCi0JRkVBX01BUChEU19TT0NDTEspLAotCUZFQV9NQVAoRFNfTENMSyksCi0J
RkVBX01BUChQUFQpLAotCUZFQV9NQVAoVERDKSwKLQlGRUFfTUFQKFRIRVJNQUwpLAotCUZFQV9N
QVAoR0ZYX1BFUl9DVV9DRyksCi0JRkVBX01BUChSTSksCi0JRkVBX01BUChEU19EQ0VGQ0xLKSwK
LQlGRUFfTUFQKEFDREMpLAotCUZFQV9NQVAoVlIwSE9UKSwKLQlGRUFfTUFQKFZSMUhPVCksCi0J
RkVBX01BUChGV19DVEYpLAotCUZFQV9NQVAoTEVEX0RJU1BMQVkpLAotCUZFQV9NQVAoRkFOX0NP
TlRST0wpLAotCUZFQV9NQVAoR0ZYX0VEQyksCi0JRkVBX01BUChHRlhPRkYpLAotCUZFQV9NQVAo
Q0cpLAotCUZFQV9NQVAoRFBNX0ZDTEspLAotCUZFQV9NQVAoRFNfRkNMSyksCi0JRkVBX01BUChE
U19NUDFDTEspLAotCUZFQV9NQVAoRFNfTVAwQ0xLKSwKLQlGRUFfTUFQKFhHTUkpLAotfTsKLQot
c3RhdGljIGludCB2ZWdhMjBfdGFibGVfbWFwW1NNVV9UQUJMRV9DT1VOVF0gPSB7Ci0JVEFCX01B
UChQUFRBQkxFKSwKLQlUQUJfTUFQKFdBVEVSTUFSS1MpLAotCVRBQl9NQVAoQVZGUyksCi0JVEFC
X01BUChBVkZTX1BTTV9ERUJVRyksCi0JVEFCX01BUChBVkZTX0ZVU0VfT1ZFUlJJREUpLAotCVRB
Ql9NQVAoUE1TVEFUVVNMT0cpLAotCVRBQl9NQVAoU01VX01FVFJJQ1MpLAotCVRBQl9NQVAoRFJJ
VkVSX1NNVV9DT05GSUcpLAotCVRBQl9NQVAoQUNUSVZJVFlfTU9OSVRPUl9DT0VGRiksCi0JVEFC
X01BUChPVkVSRFJJVkUpLAotfTsKLQotc3RhdGljIGludCB2ZWdhMjBfcHdyX3NyY19tYXBbU01V
X1BPV0VSX1NPVVJDRV9DT1VOVF0gPSB7Ci0JUFdSX01BUChBQyksCi0JUFdSX01BUChEQyksCi19
OwotCi1zdGF0aWMgaW50IHZlZ2EyMF93b3JrbG9hZF9tYXBbXSA9IHsKLQlXT1JLTE9BRF9NQVAo
UFBfU01DX1BPV0VSX1BST0ZJTEVfQk9PVFVQX0RFRkFVTFQsCVdPUktMT0FEX0RFRkFVTFRfQklU
KSwKLQlXT1JLTE9BRF9NQVAoUFBfU01DX1BPV0VSX1BST0ZJTEVfRlVMTFNDUkVFTjNELAkJV09S
S0xPQURfUFBMSUJfRlVMTF9TQ1JFRU5fM0RfQklUKSwKLQlXT1JLTE9BRF9NQVAoUFBfU01DX1BP
V0VSX1BST0ZJTEVfUE9XRVJTQVZJTkcsCQlXT1JLTE9BRF9QUExJQl9QT1dFUl9TQVZJTkdfQklU
KSwKLQlXT1JLTE9BRF9NQVAoUFBfU01DX1BPV0VSX1BST0ZJTEVfVklERU8sCQlXT1JLTE9BRF9Q
UExJQl9WSURFT19CSVQpLAotCVdPUktMT0FEX01BUChQUF9TTUNfUE9XRVJfUFJPRklMRV9WUiwJ
CQlXT1JLTE9BRF9QUExJQl9WUl9CSVQpLAotCVdPUktMT0FEX01BUChQUF9TTUNfUE9XRVJfUFJP
RklMRV9DT01QVVRFLAkJV09SS0xPQURfUFBMSUJfQ1VTVE9NX0JJVCksCi0JV09SS0xPQURfTUFQ
KFBQX1NNQ19QT1dFUl9QUk9GSUxFX0NVU1RPTSwJCVdPUktMT0FEX1BQTElCX0NVU1RPTV9CSVQp
LAotfTsKLQotc3RhdGljIGludCB2ZWdhMjBfZ2V0X3NtdV90YWJsZV9pbmRleChzdHJ1Y3Qgc211
X2NvbnRleHQgKnNtYywgdWludDMyX3QgaW5kZXgpCi17Ci0JaW50IHZhbDsKLQlpZiAoaW5kZXgg
Pj0gU01VX1RBQkxFX0NPVU5UKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCXZhbCA9IHZlZ2EyMF90
YWJsZV9tYXBbaW5kZXhdOwotCWlmICh2YWwgPj0gVEFCTEVfQ09VTlQpCi0JCXJldHVybiAtRUlO
VkFMOwotCi0JcmV0dXJuIHZhbDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfZ2V0X3B3cl9zcmNf
aW5kZXgoc3RydWN0IHNtdV9jb250ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4KQotewotCWludCB2
YWw7Ci0JaWYgKGluZGV4ID49IFNNVV9QT1dFUl9TT1VSQ0VfQ09VTlQpCi0JCXJldHVybiAtRUlO
VkFMOwotCi0JdmFsID0gdmVnYTIwX3B3cl9zcmNfbWFwW2luZGV4XTsKLQlpZiAodmFsID49IFBP
V0VSX1NPVVJDRV9DT1VOVCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlyZXR1cm4gdmFsOwotfQot
Ci1zdGF0aWMgaW50IHZlZ2EyMF9nZXRfc211X2ZlYXR1cmVfaW5kZXgoc3RydWN0IHNtdV9jb250
ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4KQotewotCWludCB2YWw7Ci0JaWYgKGluZGV4ID49IFNN
VV9GRUFUVVJFX0NPVU5UKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCXZhbCA9IHZlZ2EyMF9mZWF0
dXJlX21hc2tfbWFwW2luZGV4XTsKLQlpZiAodmFsID4gNjQpCi0JCXJldHVybiAtRUlOVkFMOwot
Ci0JcmV0dXJuIHZhbDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfZ2V0X3NtdV9jbGtfaW5kZXgo
c3RydWN0IHNtdV9jb250ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4KQotewotCWludCB2YWw7Ci0J
aWYgKGluZGV4ID49IFNNVV9DTEtfQ09VTlQpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JdmFsID0g
dmVnYTIwX2Nsa19tYXBbaW5kZXhdOwotCWlmICh2YWwgPj0gUFBDTEtfQ09VTlQpCi0JCXJldHVy
biAtRUlOVkFMOwotCi0JcmV0dXJuIHZhbDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfZ2V0X3Nt
dV9tc2dfaW5kZXgoc3RydWN0IHNtdV9jb250ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4KQotewot
CWludCB2YWw7Ci0KLQlpZiAoaW5kZXggPj0gU01VX01TR19NQVhfQ09VTlQpCi0JCXJldHVybiAt
RUlOVkFMOwotCi0JdmFsID0gdmVnYTIwX21lc3NhZ2VfbWFwW2luZGV4XTsKLQlpZiAodmFsID4g
UFBTTUNfTWVzc2FnZV9Db3VudCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlyZXR1cm4gdmFsOwot
fQotCi1zdGF0aWMgaW50IHZlZ2EyMF9nZXRfd29ya2xvYWRfdHlwZShzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSwgZW51bSBQUF9TTUNfUE9XRVJfUFJPRklMRSBwcm9maWxlKQotewotCWludCB2YWw7
Ci0JaWYgKHByb2ZpbGUgPiBQUF9TTUNfUE9XRVJfUFJPRklMRV9DVVNUT00pCi0JCXJldHVybiAt
RUlOVkFMOwotCi0JdmFsID0gdmVnYTIwX3dvcmtsb2FkX21hcFtwcm9maWxlXTsKLQotCXJldHVy
biB2YWw7Ci19Ci0KLXN0YXRpYyBpbnQgdmVnYTIwX3RhYmxlc19pbml0KHN0cnVjdCBzbXVfY29u
dGV4dCAqc211LCBzdHJ1Y3Qgc211X3RhYmxlICp0YWJsZXMpCi17Ci0Jc3RydWN0IHNtdV90YWJs
ZV9jb250ZXh0ICpzbXVfdGFibGUgPSAmc211LT5zbXVfdGFibGU7Ci0KLQlTTVVfVEFCTEVfSU5J
VCh0YWJsZXMsIFNNVV9UQUJMRV9QUFRBQkxFLCBzaXplb2YoUFBUYWJsZV90KSwKLQkJICAgICAg
IFBBR0VfU0laRSwgQU1ER1BVX0dFTV9ET01BSU5fVlJBTSk7Ci0JU01VX1RBQkxFX0lOSVQodGFi
bGVzLCBTTVVfVEFCTEVfV0FURVJNQVJLUywgc2l6ZW9mKFdhdGVybWFya3NfdCksCi0JCSAgICAg
ICBQQUdFX1NJWkUsIEFNREdQVV9HRU1fRE9NQUlOX1ZSQU0pOwotCVNNVV9UQUJMRV9JTklUKHRh
YmxlcywgU01VX1RBQkxFX1NNVV9NRVRSSUNTLCBzaXplb2YoU211TWV0cmljc190KSwKLQkJICAg
ICAgIFBBR0VfU0laRSwgQU1ER1BVX0dFTV9ET01BSU5fVlJBTSk7Ci0JU01VX1RBQkxFX0lOSVQo
dGFibGVzLCBTTVVfVEFCTEVfT1ZFUkRSSVZFLCBzaXplb2YoT3ZlckRyaXZlVGFibGVfdCksCi0J
CSAgICAgICBQQUdFX1NJWkUsIEFNREdQVV9HRU1fRE9NQUlOX1ZSQU0pOwotCVNNVV9UQUJMRV9J
TklUKHRhYmxlcywgU01VX1RBQkxFX1BNU1RBVFVTTE9HLCBTTVUxMV9UT09MX1NJWkUsCi0JCSAg
ICAgICBQQUdFX1NJWkUsIEFNREdQVV9HRU1fRE9NQUlOX1ZSQU0pOwotCVNNVV9UQUJMRV9JTklU
KHRhYmxlcywgU01VX1RBQkxFX0FDVElWSVRZX01PTklUT1JfQ09FRkYsCi0JCSAgICAgICBzaXpl
b2YoRHBtQWN0aXZpdHlNb25pdG9yQ29lZmZJbnRfdCksIFBBR0VfU0laRSwKLQkgICAgICAgICAg
ICAgICBBTURHUFVfR0VNX0RPTUFJTl9WUkFNKTsKLQotCXNtdV90YWJsZS0+bWV0cmljc190YWJs
ZSA9IGt6YWxsb2Moc2l6ZW9mKFNtdU1ldHJpY3NfdCksIEdGUF9LRVJORUwpOwotCWlmIChzbXVf
dGFibGUtPm1ldHJpY3NfdGFibGUpCi0JCXJldHVybiAtRU5PTUVNOwotCXNtdV90YWJsZS0+bWV0
cmljc190aW1lID0gMDsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IHZlZ2EyMF9hbGxv
Y2F0ZV9kcG1fY29udGV4dChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKLXsKLQlzdHJ1Y3Qgc211
X2RwbV9jb250ZXh0ICpzbXVfZHBtID0gJnNtdS0+c211X2RwbTsKLQotCWlmIChzbXVfZHBtLT5k
cG1fY29udGV4dCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlzbXVfZHBtLT5kcG1fY29udGV4dCA9
IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlKSwKLQkJCQkgICAgICAgR0ZQ
X0tFUk5FTCk7Ci0JaWYgKCFzbXVfZHBtLT5kcG1fY29udGV4dCkKLQkJcmV0dXJuIC1FTk9NRU07
Ci0KLQlpZiAoc211X2RwbS0+Z29sZGVuX2RwbV9jb250ZXh0KQotCQlyZXR1cm4gLUVJTlZBTDsK
LQotCXNtdV9kcG0tPmdvbGRlbl9kcG1fY29udGV4dCA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCB2
ZWdhMjBfZHBtX3RhYmxlKSwKLQkJCQkJICAgICAgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFzbXVfZHBt
LT5nb2xkZW5fZHBtX2NvbnRleHQpCi0JCXJldHVybiAtRU5PTUVNOwotCi0Jc211X2RwbS0+ZHBt
X2NvbnRleHRfc2l6ZSA9IHNpemVvZihzdHJ1Y3QgdmVnYTIwX2RwbV90YWJsZSk7Ci0KLQlzbXVf
ZHBtLT5kcG1fY3VycmVudF9wb3dlcl9zdGF0ZSA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBzbXVf
cG93ZXJfc3RhdGUpLAotCQkJCSAgICAgICBHRlBfS0VSTkVMKTsKLQlpZiAoIXNtdV9kcG0tPmRw
bV9jdXJyZW50X3Bvd2VyX3N0YXRlKQotCQlyZXR1cm4gLUVOT01FTTsKLQotCXNtdV9kcG0tPmRw
bV9yZXF1ZXN0X3Bvd2VyX3N0YXRlID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IHNtdV9wb3dlcl9z
dGF0ZSksCi0JCQkJICAgICAgIEdGUF9LRVJORUwpOwotCWlmICghc211X2RwbS0+ZHBtX3JlcXVl
c3RfcG93ZXJfc3RhdGUpCi0JCXJldHVybiAtRU5PTUVNOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0
YXRpYyBpbnQgdmVnYTIwX3NldHVwX29kOF9pbmZvcm1hdGlvbihzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSkKLXsKLQlBVE9NX1ZlZ2EyMF9QT1dFUlBMQVlUQUJMRSAqcG93ZXJwbGF5X3RhYmxlID0g
TlVMTDsKLQlzdHJ1Y3Qgc211X3RhYmxlX2NvbnRleHQgKnRhYmxlX2NvbnRleHQgPSAmc211LT5z
bXVfdGFibGU7Ci0Jc3RydWN0IHZlZ2EyMF9vZDhfc2V0dGluZ3MgKm9kOF9zZXR0aW5ncyA9IChz
dHJ1Y3QgdmVnYTIwX29kOF9zZXR0aW5ncyAqKXNtdS0+b2Rfc2V0dGluZ3M7Ci0KLQl1aW50MzJf
dCBvZF9mZWF0dXJlX2NvdW50LCBvZF9mZWF0dXJlX2FycmF5X3NpemUsCi0JCSBvZF9zZXR0aW5n
X2NvdW50LCBvZF9zZXR0aW5nX2FycmF5X3NpemU7Ci0KLQlpZiAoIXRhYmxlX2NvbnRleHQtPnBv
d2VyX3BsYXlfdGFibGUpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JcG93ZXJwbGF5X3RhYmxlID0g
dGFibGVfY29udGV4dC0+cG93ZXJfcGxheV90YWJsZTsKLQotCWlmIChwb3dlcnBsYXlfdGFibGUt
Pk92ZXJEcml2ZThUYWJsZS51Y09EVGFibGVSZXZpc2lvbiA9PSAxKSB7Ci0JCS8qIFNldHVwIGNv
cnJlY3QgT0RGZWF0dXJlQ291bnQsIGFuZCBzdG9yZSBPREZlYXR1cmVBcnJheSBmcm9tCi0JCSAq
IHBvd2VycGxheSB0YWJsZSB0byBvZF9mZWF0dXJlX2NhcGFiaWxpdGllcyAqLwotCQlvZF9mZWF0
dXJlX2NvdW50ID0KLQkJCShsZTMyX3RvX2NwdShwb3dlcnBsYXlfdGFibGUtPk92ZXJEcml2ZThU
YWJsZS5PREZlYXR1cmVDb3VudCkgPgotCQkJIEFUT01fVkVHQTIwX09ERkVBVFVSRV9DT1VOVCkg
PwotCQkJQVRPTV9WRUdBMjBfT0RGRUFUVVJFX0NPVU5UIDoKLQkJCWxlMzJfdG9fY3B1KHBvd2Vy
cGxheV90YWJsZS0+T3ZlckRyaXZlOFRhYmxlLk9ERmVhdHVyZUNvdW50KTsKLQotCQlvZF9mZWF0
dXJlX2FycmF5X3NpemUgPSBzaXplb2YodWludDhfdCkgKiBvZF9mZWF0dXJlX2NvdW50OwotCi0J
CWlmIChvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzKQotCQkJcmV0dXJuIC1F
SU5WQUw7Ci0KLQkJb2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllcyA9IGttZW1k
dXAoJnBvd2VycGxheV90YWJsZS0+T3ZlckRyaXZlOFRhYmxlLk9ERmVhdHVyZUNhcGFiaWxpdGll
cywKLQkJCQkJCQkJIG9kX2ZlYXR1cmVfYXJyYXlfc2l6ZSwKLQkJCQkJCQkJIEdGUF9LRVJORUwp
OwotCQlpZiAoIW9kOF9zZXR0aW5ncy0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXMpCi0JCQlyZXR1
cm4gLUVOT01FTTsKLQotCQkvKiBTZXR1cCBjb3JyZWN0IE9EU2V0dGluZ0NvdW50LCBhbmQgc3Rv
cmUgT0RTZXR0aW5nQXJyYXkgZnJvbQotCQkgKiBwb3dlcnBsYXkgdGFibGUgdG8gb2Rfc2V0dGlu
Z3NfbWF4IGFuZCBvZF9zZXR0aW5nX21pbiAqLwotCQlvZF9zZXR0aW5nX2NvdW50ID0KLQkJCShs
ZTMyX3RvX2NwdShwb3dlcnBsYXlfdGFibGUtPk92ZXJEcml2ZThUYWJsZS5PRFNldHRpbmdDb3Vu
dCkgPgotCQkJIEFUT01fVkVHQTIwX09EU0VUVElOR19DT1VOVCkgPwotCQkJQVRPTV9WRUdBMjBf
T0RTRVRUSU5HX0NPVU5UIDoKLQkJCWxlMzJfdG9fY3B1KHBvd2VycGxheV90YWJsZS0+T3ZlckRy
aXZlOFRhYmxlLk9EU2V0dGluZ0NvdW50KTsKLQotCQlvZF9zZXR0aW5nX2FycmF5X3NpemUgPSBz
aXplb2YodWludDMyX3QpICogb2Rfc2V0dGluZ19jb3VudDsKLQotCQlpZiAob2Q4X3NldHRpbmdz
LT5vZF9zZXR0aW5nc19tYXgpCi0JCQlyZXR1cm4gLUVJTlZBTDsKLQotCQlvZDhfc2V0dGluZ3Mt
Pm9kX3NldHRpbmdzX21heCA9IGttZW1kdXAoJnBvd2VycGxheV90YWJsZS0+T3ZlckRyaXZlOFRh
YmxlLk9EU2V0dGluZ3NNYXgsCi0JCQkJCQkJIG9kX3NldHRpbmdfYXJyYXlfc2l6ZSwKLQkJCQkJ
CQkgR0ZQX0tFUk5FTCk7Ci0KLQkJaWYgKCFvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21heCkg
ewotCQkJa2ZyZWUob2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllcyk7Ci0JCQlv
ZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzID0gTlVMTDsKLQkJCXJldHVybiAt
RU5PTUVNOwotCQl9Ci0KLQkJaWYgKG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluKQotCQkJ
cmV0dXJuIC1FSU5WQUw7Ci0KLQkJb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW4gPSBrbWVt
ZHVwKCZwb3dlcnBsYXlfdGFibGUtPk92ZXJEcml2ZThUYWJsZS5PRFNldHRpbmdzTWluLAotCQkJ
CQkJCSBvZF9zZXR0aW5nX2FycmF5X3NpemUsCi0JCQkJCQkJIEdGUF9LRVJORUwpOwotCi0JCWlm
ICghb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW4pIHsKLQkJCWtmcmVlKG9kOF9zZXR0aW5n
cy0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXMpOwotCQkJb2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJl
X2NhcGFiaWxpdGllcyA9IE5VTEw7Ci0JCQlrZnJlZShvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdz
X21heCk7Ci0JCQlvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21heCA9IE5VTEw7Ci0JCQlyZXR1
cm4gLUVOT01FTTsKLQkJfQotCX0KLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IHZlZ2Ey
MF9zdG9yZV9wb3dlcnBsYXlfdGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCi17Ci0JQVRP
TV9WZWdhMjBfUE9XRVJQTEFZVEFCTEUgKnBvd2VycGxheV90YWJsZSA9IE5VTEw7Ci0Jc3RydWN0
IHNtdV90YWJsZV9jb250ZXh0ICp0YWJsZV9jb250ZXh0ID0gJnNtdS0+c211X3RhYmxlOwotCWlu
dCByZXQ7Ci0KLQlpZiAoIXRhYmxlX2NvbnRleHQtPnBvd2VyX3BsYXlfdGFibGUpCi0JCXJldHVy
biAtRUlOVkFMOwotCi0JcG93ZXJwbGF5X3RhYmxlID0gdGFibGVfY29udGV4dC0+cG93ZXJfcGxh
eV90YWJsZTsKLQotCW1lbWNweSh0YWJsZV9jb250ZXh0LT5kcml2ZXJfcHB0YWJsZSwgJnBvd2Vy
cGxheV90YWJsZS0+c21jUFBUYWJsZSwKLQkgICAgICAgc2l6ZW9mKFBQVGFibGVfdCkpOwotCi0J
dGFibGVfY29udGV4dC0+c29mdHdhcmVfc2h1dGRvd25fdGVtcCA9IHBvd2VycGxheV90YWJsZS0+
dXNTb2Z0d2FyZVNodXRkb3duVGVtcDsKLQl0YWJsZV9jb250ZXh0LT50aGVybWFsX2NvbnRyb2xs
ZXJfdHlwZSA9IHBvd2VycGxheV90YWJsZS0+dWNUaGVybWFsQ29udHJvbGxlclR5cGU7Ci0JdGFi
bGVfY29udGV4dC0+VERQT0RMaW1pdCA9IGxlMzJfdG9fY3B1KHBvd2VycGxheV90YWJsZS0+T3Zl
ckRyaXZlOFRhYmxlLk9EU2V0dGluZ3NNYXhbQVRPTV9WRUdBMjBfT0RTRVRUSU5HX1BPV0VSUEVS
Q0VOVEFHRV0pOwotCi0JcmV0ID0gdmVnYTIwX3NldHVwX29kOF9pbmZvcm1hdGlvbihzbXUpOwot
Ci0JcmV0dXJuIHJldDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfYXBwZW5kX3Bvd2VycGxheV90
YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKLXsKLQlzdHJ1Y3Qgc211X3RhYmxlX2NvbnRl
eHQgKnRhYmxlX2NvbnRleHQgPSAmc211LT5zbXVfdGFibGU7Ci0JUFBUYWJsZV90ICpzbWNfcHB0
YWJsZSA9IHRhYmxlX2NvbnRleHQtPmRyaXZlcl9wcHRhYmxlOwotCXN0cnVjdCBhdG9tX3NtY19k
cG1faW5mb192NF80ICpzbWNfZHBtX3RhYmxlOwotCWludCBpbmRleCwgaSwgcmV0OwotCi0JaW5k
ZXggPSBnZXRfaW5kZXhfaW50b19tYXN0ZXJfdGFibGUoYXRvbV9tYXN0ZXJfbGlzdF9vZl9kYXRh
X3RhYmxlc192Ml8xLAotCQkJCQkgICBzbWNfZHBtX2luZm8pOwotCi0JcmV0ID0gc211X2dldF9h
dG9tX2RhdGFfdGFibGUoc211LCBpbmRleCwgTlVMTCwgTlVMTCwgTlVMTCwKLQkJCQkgICAgICAo
dWludDhfdCAqKikmc21jX2RwbV90YWJsZSk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKLQot
CXNtY19wcHRhYmxlLT5NYXhWb2x0YWdlU3RlcEdmeCA9IHNtY19kcG1fdGFibGUtPm1heHZvbHRh
Z2VzdGVwZ2Z4OwotCXNtY19wcHRhYmxlLT5NYXhWb2x0YWdlU3RlcFNvYyA9IHNtY19kcG1fdGFi
bGUtPm1heHZvbHRhZ2VzdGVwc29jOwotCi0Jc21jX3BwdGFibGUtPlZkZEdmeFZyTWFwcGluZyA9
IHNtY19kcG1fdGFibGUtPnZkZGdmeHZybWFwcGluZzsKLQlzbWNfcHB0YWJsZS0+VmRkU29jVnJN
YXBwaW5nID0gc21jX2RwbV90YWJsZS0+dmRkc29jdnJtYXBwaW5nOwotCXNtY19wcHRhYmxlLT5W
ZGRNZW0wVnJNYXBwaW5nID0gc21jX2RwbV90YWJsZS0+dmRkbWVtMHZybWFwcGluZzsKLQlzbWNf
cHB0YWJsZS0+VmRkTWVtMVZyTWFwcGluZyA9IHNtY19kcG1fdGFibGUtPnZkZG1lbTF2cm1hcHBp
bmc7Ci0KLQlzbWNfcHB0YWJsZS0+R2Z4VWx2UGhhc2VTaGVkZGluZ01hc2sgPSBzbWNfZHBtX3Rh
YmxlLT5nZnh1bHZwaGFzZXNoZWRkaW5nbWFzazsKLQlzbWNfcHB0YWJsZS0+U29jVWx2UGhhc2VT
aGVkZGluZ01hc2sgPSBzbWNfZHBtX3RhYmxlLT5zb2N1bHZwaGFzZXNoZWRkaW5nbWFzazsKLQlz
bWNfcHB0YWJsZS0+RXh0ZXJuYWxTZW5zb3JQcmVzZW50ID0gc21jX2RwbV90YWJsZS0+ZXh0ZXJu
YWxzZW5zb3JwcmVzZW50OwotCi0Jc21jX3BwdGFibGUtPkdmeE1heEN1cnJlbnQgPSBzbWNfZHBt
X3RhYmxlLT5nZnhtYXhjdXJyZW50OwotCXNtY19wcHRhYmxlLT5HZnhPZmZzZXQgPSBzbWNfZHBt
X3RhYmxlLT5nZnhvZmZzZXQ7Ci0Jc21jX3BwdGFibGUtPlBhZGRpbmdfVGVsZW1ldHJ5R2Z4ID0g
c21jX2RwbV90YWJsZS0+cGFkZGluZ190ZWxlbWV0cnlnZng7Ci0KLQlzbWNfcHB0YWJsZS0+U29j
TWF4Q3VycmVudCA9IHNtY19kcG1fdGFibGUtPnNvY21heGN1cnJlbnQ7Ci0Jc21jX3BwdGFibGUt
PlNvY09mZnNldCA9IHNtY19kcG1fdGFibGUtPnNvY29mZnNldDsKLQlzbWNfcHB0YWJsZS0+UGFk
ZGluZ19UZWxlbWV0cnlTb2MgPSBzbWNfZHBtX3RhYmxlLT5wYWRkaW5nX3RlbGVtZXRyeXNvYzsK
LQotCXNtY19wcHRhYmxlLT5NZW0wTWF4Q3VycmVudCA9IHNtY19kcG1fdGFibGUtPm1lbTBtYXhj
dXJyZW50OwotCXNtY19wcHRhYmxlLT5NZW0wT2Zmc2V0ID0gc21jX2RwbV90YWJsZS0+bWVtMG9m
ZnNldDsKLQlzbWNfcHB0YWJsZS0+UGFkZGluZ19UZWxlbWV0cnlNZW0wID0gc21jX2RwbV90YWJs
ZS0+cGFkZGluZ190ZWxlbWV0cnltZW0wOwotCi0Jc21jX3BwdGFibGUtPk1lbTFNYXhDdXJyZW50
ID0gc21jX2RwbV90YWJsZS0+bWVtMW1heGN1cnJlbnQ7Ci0Jc21jX3BwdGFibGUtPk1lbTFPZmZz
ZXQgPSBzbWNfZHBtX3RhYmxlLT5tZW0xb2Zmc2V0OwotCXNtY19wcHRhYmxlLT5QYWRkaW5nX1Rl
bGVtZXRyeU1lbTEgPSBzbWNfZHBtX3RhYmxlLT5wYWRkaW5nX3RlbGVtZXRyeW1lbTE7Ci0KLQlz
bWNfcHB0YWJsZS0+QWNEY0dwaW8gPSBzbWNfZHBtX3RhYmxlLT5hY2RjZ3BpbzsKLQlzbWNfcHB0
YWJsZS0+QWNEY1BvbGFyaXR5ID0gc21jX2RwbV90YWJsZS0+YWNkY3BvbGFyaXR5OwotCXNtY19w
cHRhYmxlLT5WUjBIb3RHcGlvID0gc21jX2RwbV90YWJsZS0+dnIwaG90Z3BpbzsKLQlzbWNfcHB0
YWJsZS0+VlIwSG90UG9sYXJpdHkgPSBzbWNfZHBtX3RhYmxlLT52cjBob3Rwb2xhcml0eTsKLQot
CXNtY19wcHRhYmxlLT5WUjFIb3RHcGlvID0gc21jX2RwbV90YWJsZS0+dnIxaG90Z3BpbzsKLQlz
bWNfcHB0YWJsZS0+VlIxSG90UG9sYXJpdHkgPSBzbWNfZHBtX3RhYmxlLT52cjFob3Rwb2xhcml0
eTsKLQlzbWNfcHB0YWJsZS0+UGFkZGluZzEgPSBzbWNfZHBtX3RhYmxlLT5wYWRkaW5nMTsKLQlz
bWNfcHB0YWJsZS0+UGFkZGluZzIgPSBzbWNfZHBtX3RhYmxlLT5wYWRkaW5nMjsKLQotCXNtY19w
cHRhYmxlLT5MZWRQaW4wID0gc21jX2RwbV90YWJsZS0+bGVkcGluMDsKLQlzbWNfcHB0YWJsZS0+
TGVkUGluMSA9IHNtY19kcG1fdGFibGUtPmxlZHBpbjE7Ci0Jc21jX3BwdGFibGUtPkxlZFBpbjIg
PSBzbWNfZHBtX3RhYmxlLT5sZWRwaW4yOwotCi0Jc21jX3BwdGFibGUtPlBsbEdmeGNsa1NwcmVh
ZEVuYWJsZWQgPSBzbWNfZHBtX3RhYmxlLT5wbGxnZnhjbGtzcHJlYWRlbmFibGVkOwotCXNtY19w
cHRhYmxlLT5QbGxHZnhjbGtTcHJlYWRQZXJjZW50ID0gc21jX2RwbV90YWJsZS0+cGxsZ2Z4Y2xr
c3ByZWFkcGVyY2VudDsKLQlzbWNfcHB0YWJsZS0+UGxsR2Z4Y2xrU3ByZWFkRnJlcSA9IHNtY19k
cG1fdGFibGUtPnBsbGdmeGNsa3NwcmVhZGZyZXE7Ci0KLQlzbWNfcHB0YWJsZS0+VWNsa1NwcmVh
ZEVuYWJsZWQgPSAwOwotCXNtY19wcHRhYmxlLT5VY2xrU3ByZWFkUGVyY2VudCA9IHNtY19kcG1f
dGFibGUtPnVjbGtzcHJlYWRwZXJjZW50OwotCXNtY19wcHRhYmxlLT5VY2xrU3ByZWFkRnJlcSA9
IHNtY19kcG1fdGFibGUtPnVjbGtzcHJlYWRmcmVxOwotCi0Jc21jX3BwdGFibGUtPkZjbGtTcHJl
YWRFbmFibGVkID0gc21jX2RwbV90YWJsZS0+ZmNsa3NwcmVhZGVuYWJsZWQ7Ci0Jc21jX3BwdGFi
bGUtPkZjbGtTcHJlYWRQZXJjZW50ID0gc21jX2RwbV90YWJsZS0+ZmNsa3NwcmVhZHBlcmNlbnQ7
Ci0Jc21jX3BwdGFibGUtPkZjbGtTcHJlYWRGcmVxID0gc21jX2RwbV90YWJsZS0+ZmNsa3NwcmVh
ZGZyZXE7Ci0KLQlzbWNfcHB0YWJsZS0+RmxsR2Z4Y2xrU3ByZWFkRW5hYmxlZCA9IHNtY19kcG1f
dGFibGUtPmZsbGdmeGNsa3NwcmVhZGVuYWJsZWQ7Ci0Jc21jX3BwdGFibGUtPkZsbEdmeGNsa1Nw
cmVhZFBlcmNlbnQgPSBzbWNfZHBtX3RhYmxlLT5mbGxnZnhjbGtzcHJlYWRwZXJjZW50OwotCXNt
Y19wcHRhYmxlLT5GbGxHZnhjbGtTcHJlYWRGcmVxID0gc21jX2RwbV90YWJsZS0+ZmxsZ2Z4Y2xr
c3ByZWFkZnJlcTsKLQotCWZvciAoaSA9IDA7IGkgPCBJMkNfQ09OVFJPTExFUl9OQU1FX0NPVU5U
OyBpKyspIHsKLQkJc21jX3BwdGFibGUtPkkyY0NvbnRyb2xsZXJzW2ldLkVuYWJsZWQgPQotCQkJ
c21jX2RwbV90YWJsZS0+aTJjY29udHJvbGxlcnNbaV0uZW5hYmxlZDsKLQkJc21jX3BwdGFibGUt
PkkyY0NvbnRyb2xsZXJzW2ldLlNsYXZlQWRkcmVzcyA9Ci0JCQlzbWNfZHBtX3RhYmxlLT5pMmNj
b250cm9sbGVyc1tpXS5zbGF2ZWFkZHJlc3M7Ci0JCXNtY19wcHRhYmxlLT5JMmNDb250cm9sbGVy
c1tpXS5Db250cm9sbGVyUG9ydCA9Ci0JCQlzbWNfZHBtX3RhYmxlLT5pMmNjb250cm9sbGVyc1tp
XS5jb250cm9sbGVycG9ydDsKLQkJc21jX3BwdGFibGUtPkkyY0NvbnRyb2xsZXJzW2ldLlRoZXJt
YWxUaHJvdHRsZXIgPQotCQkJc21jX2RwbV90YWJsZS0+aTJjY29udHJvbGxlcnNbaV0udGhlcm1h
bHRocm90dGxlcjsKLQkJc21jX3BwdGFibGUtPkkyY0NvbnRyb2xsZXJzW2ldLkkyY1Byb3RvY29s
ID0KLQkJCXNtY19kcG1fdGFibGUtPmkyY2NvbnRyb2xsZXJzW2ldLmkyY3Byb3RvY29sOwotCQlz
bWNfcHB0YWJsZS0+STJjQ29udHJvbGxlcnNbaV0uSTJjU3BlZWQgPQotCQkJc21jX2RwbV90YWJs
ZS0+aTJjY29udHJvbGxlcnNbaV0uaTJjc3BlZWQ7Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0
YXRpYyBpbnQgdmVnYTIwX2NoZWNrX3Bvd2VycGxheV90YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSkKLXsKLQlBVE9NX1ZlZ2EyMF9QT1dFUlBMQVlUQUJMRSAqcG93ZXJwbGF5X3RhYmxlID0g
TlVMTDsKLQlzdHJ1Y3Qgc211X3RhYmxlX2NvbnRleHQgKnRhYmxlX2NvbnRleHQgPSAmc211LT5z
bXVfdGFibGU7Ci0KLQlwb3dlcnBsYXlfdGFibGUgPSB0YWJsZV9jb250ZXh0LT5wb3dlcl9wbGF5
X3RhYmxlOwotCi0JaWYgKHBvd2VycGxheV90YWJsZS0+c0hlYWRlci5mb3JtYXRfcmV2aXNpb24g
PCBBVE9NX1ZFR0EyMF9UQUJMRV9SRVZJU0lPTl9WRUdBMjApIHsKLQkJcHJfZXJyKCJVbnN1cHBv
cnRlZCBQUFRhYmxlIGZvcm1hdCEiKTsKLQkJcmV0dXJuIC1FSU5WQUw7Ci0JfQotCi0JaWYgKCFw
b3dlcnBsYXlfdGFibGUtPnNIZWFkZXIuc3RydWN0dXJlc2l6ZSkgewotCQlwcl9lcnIoIkludmFs
aWQgUG93ZXJQbGF5IFRhYmxlISIpOwotCQlyZXR1cm4gLUVJTlZBTDsKLQl9Ci0KLQlyZXR1cm4g
MDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfcnVuX2J0Y19hZmxsKHN0cnVjdCBzbXVfY29udGV4
dCAqc211KQotewotCXJldHVybiBzbXVfc2VuZF9zbWNfbXNnKHNtdSwgU01VX01TR19SdW5BZmxs
QnRjKTsKLX0KLQotI2RlZmluZSBGRUFUVVJFX01BU0soZmVhdHVyZSkgKDFVTEwgPDwgZmVhdHVy
ZSkKLXN0YXRpYyBpbnQKLXZlZ2EyMF9nZXRfYWxsb3dlZF9mZWF0dXJlX21hc2soc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUsCi0JCQkJICB1aW50MzJfdCAqZmVhdHVyZV9tYXNrLCB1aW50MzJfdCBu
dW0pCi17Ci0JaWYgKG51bSA+IDIpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JbWVtc2V0KGZlYXR1
cmVfbWFzaywgMCwgc2l6ZW9mKHVpbnQzMl90KSAqIG51bSk7Ci0KLQkqKHVpbnQ2NF90ICopZmVh
dHVyZV9tYXNrIHw9IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9QUkVGRVRDSEVSX0JJVCkKLQkJ
CQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9HRlhDTEtfQklUKQotCQkJCXwgRkVBVFVSRV9N
QVNLKEZFQVRVUkVfRFBNX1VDTEtfQklUKQotCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBN
X1NPQ0NMS19CSVQpCi0JCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9EUE1fVVZEX0JJVCkKLQkJ
CQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9WQ0VfQklUKQotCQkJCXwgRkVBVFVSRV9NQVNL
KEZFQVRVUkVfVUxWX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0RQTV9NUDBDTEtf
QklUKQotCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfRFBNX0xJTktfQklUKQotCQkJCXwgRkVB
VFVSRV9NQVNLKEZFQVRVUkVfRFBNX0RDRUZDTEtfQklUKQotCQkJCXwgRkVBVFVSRV9NQVNLKEZF
QVRVUkVfUFBUX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX1REQ19CSVQpCi0JCQkJ
fCBGRUFUVVJFX01BU0soRkVBVFVSRV9USEVSTUFMX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFTSyhG
RUFUVVJFX0dGWF9QRVJfQ1VfQ0dfQklUKQotCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfUk1f
QklUKQotCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfQUNEQ19CSVQpCi0JCQkJfCBGRUFUVVJF
X01BU0soRkVBVFVSRV9WUjBIT1RfQklUKQotCQkJCXwgRkVBVFVSRV9NQVNLKEZFQVRVUkVfVlIx
SE9UX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0ZXX0NURl9CSVQpCi0JCQkJfCBG
RUFUVVJFX01BU0soRkVBVFVSRV9MRURfRElTUExBWV9CSVQpCi0JCQkJfCBGRUFUVVJFX01BU0so
RkVBVFVSRV9GQU5fQ09OVFJPTF9CSVQpCi0JCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9HRlhf
RURDX0JJVCkKLQkJCQl8IEZFQVRVUkVfTUFTSyhGRUFUVVJFX0dGWE9GRl9CSVQpCi0JCQkJfCBG
RUFUVVJFX01BU0soRkVBVFVSRV9DR19CSVQpCi0JCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9E
UE1fRkNMS19CSVQpCi0JCQkJfCBGRUFUVVJFX01BU0soRkVBVFVSRV9YR01JX0JJVCk7Ci0JcmV0
dXJuIDA7Ci19Ci0KLXN0YXRpYyBlbnVtCi1hbWRfcG1fc3RhdGVfdHlwZSB2ZWdhMjBfZ2V0X2N1
cnJlbnRfcG93ZXJfc3RhdGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCi17Ci0JZW51bSBhbWRf
cG1fc3RhdGVfdHlwZSBwbV90eXBlOwotCXN0cnVjdCBzbXVfZHBtX2NvbnRleHQgKnNtdV9kcG1f
Y3R4ID0gJihzbXUtPnNtdV9kcG0pOwotCi0JaWYgKCFzbXVfZHBtX2N0eC0+ZHBtX2NvbnRleHQg
fHwKLQkgICAgIXNtdV9kcG1fY3R4LT5kcG1fY3VycmVudF9wb3dlcl9zdGF0ZSkKLQkJcmV0dXJu
IC1FSU5WQUw7Ci0KLQltdXRleF9sb2NrKCYoc211LT5tdXRleCkpOwotCXN3aXRjaCAoc211X2Rw
bV9jdHgtPmRwbV9jdXJyZW50X3Bvd2VyX3N0YXRlLT5jbGFzc2lmaWNhdGlvbi51aV9sYWJlbCkg
ewotCWNhc2UgU01VX1NUQVRFX1VJX0xBQkVMX0JBVFRFUlk6Ci0JCXBtX3R5cGUgPSBQT1dFUl9T
VEFURV9UWVBFX0JBVFRFUlk7Ci0JCWJyZWFrOwotCWNhc2UgU01VX1NUQVRFX1VJX0xBQkVMX0JB
TExBTkNFRDoKLQkJcG1fdHlwZSA9IFBPV0VSX1NUQVRFX1RZUEVfQkFMQU5DRUQ7Ci0JCWJyZWFr
OwotCWNhc2UgU01VX1NUQVRFX1VJX0xBQkVMX1BFUkZPUk1BTkNFOgotCQlwbV90eXBlID0gUE9X
RVJfU1RBVEVfVFlQRV9QRVJGT1JNQU5DRTsKLQkJYnJlYWs7Ci0JZGVmYXVsdDoKLQkJaWYgKHNt
dV9kcG1fY3R4LT5kcG1fY3VycmVudF9wb3dlcl9zdGF0ZS0+Y2xhc3NpZmljYXRpb24uZmxhZ3Mg
JiBTTVVfU1RBVEVfQ0xBU1NJRklDQVRJT05fRkxBR19CT09UKQotCQkJcG1fdHlwZSA9IFBPV0VS
X1NUQVRFX1RZUEVfSU5URVJOQUxfQk9PVDsKLQkJZWxzZQotCQkJcG1fdHlwZSA9IFBPV0VSX1NU
QVRFX1RZUEVfREVGQVVMVDsKLQkJYnJlYWs7Ci0JfQotCW11dGV4X3VubG9jaygmKHNtdS0+bXV0
ZXgpKTsKLQotCXJldHVybiBwbV90eXBlOwotfQotCi1zdGF0aWMgaW50Ci12ZWdhMjBfc2V0X3Np
bmdsZV9kcG1fdGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCi0JCQkgICAgc3RydWN0IHZl
Z2EyMF9zaW5nbGVfZHBtX3RhYmxlICpzaW5nbGVfZHBtX3RhYmxlLAotCQkJICAgIFBQQ0xLX2Ug
Y2xrX2lkKQotewotCWludCByZXQgPSAwOwotCXVpbnQzMl90IGksIG51bV9vZl9sZXZlbHMgPSAw
LCBjbGs7Ci0KLQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LAotCQkJU01V
X01TR19HZXREcG1GcmVxQnlJbmRleCwKLQkJCShjbGtfaWQgPDwgMTYgfCAweEZGKSk7Ci0JaWYg
KHJldCkgewotCQlwcl9lcnIoIltHZXROdW1PZkRwbUxldmVsXSBmYWlsZWQgdG8gZ2V0IGRwbSBs
ZXZlbHMhIik7Ci0JCXJldHVybiByZXQ7Ci0JfQotCi0Jc211X3JlYWRfc21jX2FyZyhzbXUsICZu
dW1fb2ZfbGV2ZWxzKTsKLQlpZiAoIW51bV9vZl9sZXZlbHMpIHsKLQkJcHJfZXJyKCJbR2V0TnVt
T2ZEcG1MZXZlbF0gbnVtYmVyIG9mIGNsayBsZXZlbHMgaXMgaW52YWxpZCEiKTsKLQkJcmV0dXJu
IC1FSU5WQUw7Ci0JfQotCi0Jc2luZ2xlX2RwbV90YWJsZS0+Y291bnQgPSBudW1fb2ZfbGV2ZWxz
OwotCi0JZm9yIChpID0gMDsgaSA8IG51bV9vZl9sZXZlbHM7IGkrKykgewotCQlyZXQgPSBzbXVf
c2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LAotCQkJCVNNVV9NU0dfR2V0RHBtRnJlcUJ5SW5k
ZXgsCi0JCQkJKGNsa19pZCA8PCAxNiB8IGkpKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJb
R2V0RHBtRnJlcUJ5SW5kZXhdIGZhaWxlZCB0byBnZXQgZHBtIGZyZXEgYnkgaW5kZXghIik7Ci0J
CQlyZXR1cm4gcmV0OwotCQl9Ci0JCXNtdV9yZWFkX3NtY19hcmcoc211LCAmY2xrKTsKLQkJaWYg
KCFjbGspIHsKLQkJCXByX2VycigiW0dldERwbUZyZXFCeUluZGV4XSBjbGsgdmFsdWUgaXMgaW52
YWxpZCEiKTsKLQkJCXJldHVybiAtRUlOVkFMOwotCQl9Ci0JCXNpbmdsZV9kcG1fdGFibGUtPmRw
bV9sZXZlbHNbaV0udmFsdWUgPSBjbGs7Ci0JCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNb
aV0uZW5hYmxlZCA9IHRydWU7Ci0JfQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgdm9pZCB2ZWdh
MjBfaW5pdF9zaW5nbGVfZHBtX3N0YXRlKHN0cnVjdCB2ZWdhMjBfZHBtX3N0YXRlICpkcG1fc3Rh
dGUpCi17Ci0JZHBtX3N0YXRlLT5zb2Z0X21pbl9sZXZlbCA9IDB4MDsKLQlkcG1fc3RhdGUtPnNv
ZnRfbWF4X2xldmVsID0gMHhmZmZmOwotICAgICAgICBkcG1fc3RhdGUtPmhhcmRfbWluX2xldmVs
ID0gMHgwOwotICAgICAgICBkcG1fc3RhdGUtPmhhcmRfbWF4X2xldmVsID0gMHhmZmZmOwotfQot
Ci1zdGF0aWMgaW50IHZlZ2EyMF9zZXRfZGVmYXVsdF9kcG1fdGFibGUoc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUpCi17Ci0JaW50IHJldDsKLQotCXN0cnVjdCBzbXVfZHBtX2NvbnRleHQgKnNtdV9k
cG0gPSAmc211LT5zbXVfZHBtOwotCXN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICpkcG1fdGFibGUg
PSBOVUxMOwotCXN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAqc2luZ2xlX2RwbV90YWJs
ZTsKLQotCWRwbV90YWJsZSA9IHNtdV9kcG0tPmRwbV9jb250ZXh0OwotCi0JLyogc29jY2xrICov
Ci0Jc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5zb2NfdGFibGUpOwotCi0JaWYgKHNt
dV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fU09DQ0xLX0JJVCkpIHsK
LQkJcmV0ID0gdmVnYTIwX3NldF9zaW5nbGVfZHBtX3RhYmxlKHNtdSwgc2luZ2xlX2RwbV90YWJs
ZSwKLQkJCQkJCSAgUFBDTEtfU09DQ0xLKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJbU2V0
dXBEZWZhdWx0RHBtVGFibGVdIGZhaWxlZCB0byBnZXQgc29jY2xrIGRwbSBsZXZlbHMhIik7Ci0J
CQlyZXR1cm4gcmV0OwotCQl9Ci0JfSBlbHNlIHsKLQkJc2luZ2xlX2RwbV90YWJsZS0+Y291bnQg
PSAxOwotCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlID0gc211LT5zbXVf
dGFibGUuYm9vdF92YWx1ZXMuc29jY2xrIC8gMTAwOwotCX0KLQl2ZWdhMjBfaW5pdF9zaW5nbGVf
ZHBtX3N0YXRlKCYoc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlKSk7Ci0KLQkvKiBnZnhjbGsg
Ki8KLQlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPmdmeF90YWJsZSk7Ci0KLQlpZiAo
c211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9HRlhDTEtfQklUKSkg
ewotCQlyZXQgPSB2ZWdhMjBfc2V0X3NpbmdsZV9kcG1fdGFibGUoc211LCBzaW5nbGVfZHBtX3Rh
YmxlLAotCQkJCQkJICBQUENMS19HRlhDTEspOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIoIltT
ZXR1cERlZmF1bHREcG1UYWJsZV0gZmFpbGVkIHRvIGdldCBnZnhjbGsgZHBtIGxldmVscyEiKTsK
LQkJCXJldHVybiByZXQ7Ci0JCX0KLQl9IGVsc2UgewotCQlzaW5nbGVfZHBtX3RhYmxlLT5jb3Vu
dCA9IDE7Ci0JCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWUgPSBzbXUtPnNt
dV90YWJsZS5ib290X3ZhbHVlcy5nZnhjbGsgLyAxMDA7Ci0JfQotCXZlZ2EyMF9pbml0X3Npbmds
ZV9kcG1fc3RhdGUoJihzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUpKTsKLQotCS8qIG1lbWNs
ayAqLwotCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+bWVtX3RhYmxlKTsKLQotCWlm
IChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX1VDTEtfQklUKSkg
ewotCQlyZXQgPSB2ZWdhMjBfc2V0X3NpbmdsZV9kcG1fdGFibGUoc211LCBzaW5nbGVfZHBtX3Rh
YmxlLAotCQkJCQkJICBQUENMS19VQ0xLKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJbU2V0
dXBEZWZhdWx0RHBtVGFibGVdIGZhaWxlZCB0byBnZXQgbWVtY2xrIGRwbSBsZXZlbHMhIik7Ci0J
CQlyZXR1cm4gcmV0OwotCQl9Ci0JfSBlbHNlIHsKLQkJc2luZ2xlX2RwbV90YWJsZS0+Y291bnQg
PSAxOwotCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlID0gc211LT5zbXVf
dGFibGUuYm9vdF92YWx1ZXMudWNsayAvIDEwMDsKLQl9Ci0JdmVnYTIwX2luaXRfc2luZ2xlX2Rw
bV9zdGF0ZSgmKHNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZSkpOwotCi0JLyogZWNsayAqLwot
CXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+ZWNsa190YWJsZSk7Ci0KLQlpZiAoc211
X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9WQ0VfQklUKSkgewotCQly
ZXQgPSB2ZWdhMjBfc2V0X3NpbmdsZV9kcG1fdGFibGUoc211LCBzaW5nbGVfZHBtX3RhYmxlLCBQ
UENMS19FQ0xLKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJbU2V0dXBEZWZhdWx0RHBtVGFi
bGVdIGZhaWxlZCB0byBnZXQgZWNsayBkcG0gbGV2ZWxzISIpOwotCQkJcmV0dXJuIHJldDsKLQkJ
fQotCX0gZWxzZSB7Ci0JCXNpbmdsZV9kcG1fdGFibGUtPmNvdW50ID0gMTsKLQkJc2luZ2xlX2Rw
bV90YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1ZSA9IHNtdS0+c211X3RhYmxlLmJvb3RfdmFsdWVz
LmVjbGsgLyAxMDA7Ci0JfQotCXZlZ2EyMF9pbml0X3NpbmdsZV9kcG1fc3RhdGUoJihzaW5nbGVf
ZHBtX3RhYmxlLT5kcG1fc3RhdGUpKTsKLQotCS8qIHZjbGsgKi8KLQlzaW5nbGVfZHBtX3RhYmxl
ID0gJihkcG1fdGFibGUtPnZjbGtfdGFibGUpOwotCi0JaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJs
ZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVVZEX0JJVCkpIHsKLQkJcmV0ID0gdmVnYTIwX3NldF9z
aW5nbGVfZHBtX3RhYmxlKHNtdSwgc2luZ2xlX2RwbV90YWJsZSwgUFBDTEtfVkNMSyk7Ci0JCWlm
IChyZXQpIHsKLQkJCXByX2VycigiW1NldHVwRGVmYXVsdERwbVRhYmxlXSBmYWlsZWQgdG8gZ2V0
IHZjbGsgZHBtIGxldmVscyEiKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KLQl9IGVsc2UgewotCQlz
aW5nbGVfZHBtX3RhYmxlLT5jb3VudCA9IDE7Ci0JCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZl
bHNbMF0udmFsdWUgPSBzbXUtPnNtdV90YWJsZS5ib290X3ZhbHVlcy52Y2xrIC8gMTAwOwotCX0K
LQl2ZWdhMjBfaW5pdF9zaW5nbGVfZHBtX3N0YXRlKCYoc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0
YXRlKSk7Ci0KLQkvKiBkY2xrICovCi0Jc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5k
Y2xrX3RhYmxlKTsKLQotCWlmIChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRV
UkVfRFBNX1VWRF9CSVQpKSB7Ci0JCXJldCA9IHZlZ2EyMF9zZXRfc2luZ2xlX2RwbV90YWJsZShz
bXUsIHNpbmdsZV9kcG1fdGFibGUsIFBQQ0xLX0RDTEspOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9l
cnIoIltTZXR1cERlZmF1bHREcG1UYWJsZV0gZmFpbGVkIHRvIGdldCBkY2xrIGRwbSBsZXZlbHMh
Iik7Ci0JCQlyZXR1cm4gcmV0OwotCQl9Ci0JfSBlbHNlIHsKLQkJc2luZ2xlX2RwbV90YWJsZS0+
Y291bnQgPSAxOwotCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlID0gc211
LT5zbXVfdGFibGUuYm9vdF92YWx1ZXMuZGNsayAvIDEwMDsKLQl9Ci0JdmVnYTIwX2luaXRfc2lu
Z2xlX2RwbV9zdGF0ZSgmKHNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZSkpOwotCi0JLyogZGNl
ZmNsayAqLwotCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+ZGNlZl90YWJsZSk7Ci0K
LQlpZiAoc211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9EQ0VGQ0xL
X0JJVCkpIHsKLQkJcmV0ID0gdmVnYTIwX3NldF9zaW5nbGVfZHBtX3RhYmxlKHNtdSwgc2luZ2xl
X2RwbV90YWJsZSwKLQkJCQkJCSAgUFBDTEtfRENFRkNMSyk7Ci0JCWlmIChyZXQpIHsKLQkJCXBy
X2VycigiW1NldHVwRGVmYXVsdERwbVRhYmxlXSBmYWlsZWQgdG8gZ2V0IGRjZWZjbGsgZHBtIGxl
dmVscyEiKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KLQl9IGVsc2UgewotCQlzaW5nbGVfZHBtX3Rh
YmxlLT5jb3VudCA9IDE7Ci0JCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWUg
PSBzbXUtPnNtdV90YWJsZS5ib290X3ZhbHVlcy5kY2VmY2xrIC8gMTAwOwotCX0KLQl2ZWdhMjBf
aW5pdF9zaW5nbGVfZHBtX3N0YXRlKCYoc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlKSk7Ci0K
LQkvKiBwaXhjbGsgKi8KLQlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPnBpeGVsX3Rh
YmxlKTsKLQotCWlmIChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBN
X0RDRUZDTEtfQklUKSkgewotCQlyZXQgPSB2ZWdhMjBfc2V0X3NpbmdsZV9kcG1fdGFibGUoc211
LCBzaW5nbGVfZHBtX3RhYmxlLAotCQkJCQkJICBQUENMS19QSVhDTEspOwotCQlpZiAocmV0KSB7
Ci0JCQlwcl9lcnIoIltTZXR1cERlZmF1bHREcG1UYWJsZV0gZmFpbGVkIHRvIGdldCBwaXhjbGsg
ZHBtIGxldmVscyEiKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KLQl9IGVsc2UgewotCQlzaW5nbGVf
ZHBtX3RhYmxlLT5jb3VudCA9IDA7Ci0JfQotCXZlZ2EyMF9pbml0X3NpbmdsZV9kcG1fc3RhdGUo
JihzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUpKTsKLQotCS8qIGRpc3BjbGsgKi8KLQlzaW5n
bGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPmRpc3BsYXlfdGFibGUpOwotCi0JaWYgKHNtdV9m
ZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fRENFRkNMS19CSVQpKSB7Ci0J
CXJldCA9IHZlZ2EyMF9zZXRfc2luZ2xlX2RwbV90YWJsZShzbXUsIHNpbmdsZV9kcG1fdGFibGUs
Ci0JCQkJCQkgIFBQQ0xLX0RJU1BDTEspOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIoIltTZXR1
cERlZmF1bHREcG1UYWJsZV0gZmFpbGVkIHRvIGdldCBkaXNwY2xrIGRwbSBsZXZlbHMhIik7Ci0J
CQlyZXR1cm4gcmV0OwotCQl9Ci0JfSBlbHNlIHsKLQkJc2luZ2xlX2RwbV90YWJsZS0+Y291bnQg
PSAwOwotCX0KLQl2ZWdhMjBfaW5pdF9zaW5nbGVfZHBtX3N0YXRlKCYoc2luZ2xlX2RwbV90YWJs
ZS0+ZHBtX3N0YXRlKSk7Ci0KLQkvKiBwaHljbGsgKi8KLQlzaW5nbGVfZHBtX3RhYmxlID0gJihk
cG1fdGFibGUtPnBoeV90YWJsZSk7Ci0KLQlpZiAoc211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUs
IFNNVV9GRUFUVVJFX0RQTV9EQ0VGQ0xLX0JJVCkpIHsKLQkJcmV0ID0gdmVnYTIwX3NldF9zaW5n
bGVfZHBtX3RhYmxlKHNtdSwgc2luZ2xlX2RwbV90YWJsZSwKLQkJCQkJCSAgUFBDTEtfUEhZQ0xL
KTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJbU2V0dXBEZWZhdWx0RHBtVGFibGVdIGZhaWxl
ZCB0byBnZXQgcGh5Y2xrIGRwbSBsZXZlbHMhIik7Ci0JCQlyZXR1cm4gcmV0OwotCQl9Ci0JfSBl
bHNlIHsKLQkJc2luZ2xlX2RwbV90YWJsZS0+Y291bnQgPSAwOwotCX0KLQl2ZWdhMjBfaW5pdF9z
aW5nbGVfZHBtX3N0YXRlKCYoc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlKSk7Ci0KLQkvKiBm
Y2xrICovCi0Jc2luZ2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5mY2xrX3RhYmxlKTsKLQot
CWlmIChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSxGRUFUVVJFX0RQTV9GQ0xLX0JJVCkpIHsK
LQkJcmV0ID0gdmVnYTIwX3NldF9zaW5nbGVfZHBtX3RhYmxlKHNtdSwgc2luZ2xlX2RwbV90YWJs
ZSwKLQkJCQkJCSAgUFBDTEtfRkNMSyk7Ci0JCWlmIChyZXQpIHsKLQkJCXByX2VycigiW1NldHVw
RGVmYXVsdERwbVRhYmxlXSBmYWlsZWQgdG8gZ2V0IGZjbGsgZHBtIGxldmVscyEiKTsKLQkJCXJl
dHVybiByZXQ7Ci0JCX0KLQl9IGVsc2UgewotCQlzaW5nbGVfZHBtX3RhYmxlLT5jb3VudCA9IDA7
Ci0JfQotCXZlZ2EyMF9pbml0X3NpbmdsZV9kcG1fc3RhdGUoJihzaW5nbGVfZHBtX3RhYmxlLT5k
cG1fc3RhdGUpKTsKLQotCW1lbWNweShzbXVfZHBtLT5nb2xkZW5fZHBtX2NvbnRleHQsIGRwbV90
YWJsZSwKLQkgICAgICAgc2l6ZW9mKHN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlKSk7Ci0KLQlyZXR1
cm4gMDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfcG9wdWxhdGVfdW1kX3N0YXRlX2NsayhzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSkKLXsKLQlzdHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpzbXVfZHBt
ID0gJnNtdS0+c211X2RwbTsKLQlzdHJ1Y3QgdmVnYTIwX2RwbV90YWJsZSAqZHBtX3RhYmxlID0g
TlVMTDsKLQlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgKmdmeF90YWJsZSA9IE5VTEw7
Ci0Jc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICptZW1fdGFibGUgPSBOVUxMOwotCi0J
ZHBtX3RhYmxlID0gc211X2RwbS0+ZHBtX2NvbnRleHQ7Ci0JZ2Z4X3RhYmxlID0gJihkcG1fdGFi
bGUtPmdmeF90YWJsZSk7Ci0JbWVtX3RhYmxlID0gJihkcG1fdGFibGUtPm1lbV90YWJsZSk7Ci0K
LQlzbXUtPnBzdGF0ZV9zY2xrID0gZ2Z4X3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlOwotCXNt
dS0+cHN0YXRlX21jbGsgPSBtZW1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWU7Ci0KLQlpZiAo
Z2Z4X3RhYmxlLT5jb3VudCA+IFZFR0EyMF9VTURfUFNUQVRFX0dGWENMS19MRVZFTCAmJgotCSAg
ICBtZW1fdGFibGUtPmNvdW50ID4gVkVHQTIwX1VNRF9QU1RBVEVfTUNMS19MRVZFTCkgewotCQlz
bXUtPnBzdGF0ZV9zY2xrID0gZ2Z4X3RhYmxlLT5kcG1fbGV2ZWxzW1ZFR0EyMF9VTURfUFNUQVRF
X0dGWENMS19MRVZFTF0udmFsdWU7Ci0JCXNtdS0+cHN0YXRlX21jbGsgPSBtZW1fdGFibGUtPmRw
bV9sZXZlbHNbVkVHQTIwX1VNRF9QU1RBVEVfTUNMS19MRVZFTF0udmFsdWU7Ci0JfQotCi0Jc211
LT5wc3RhdGVfc2NsayA9IHNtdS0+cHN0YXRlX3NjbGsgKiAxMDA7Ci0Jc211LT5wc3RhdGVfbWNs
ayA9IHNtdS0+cHN0YXRlX21jbGsgKiAxMDA7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGlu
dCB2ZWdhMjBfZ2V0X2Nsa190YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKLQkJCXN0cnVj
dCBwcF9jbG9ja19sZXZlbHNfd2l0aF9sYXRlbmN5ICpjbG9ja3MsCi0JCQlzdHJ1Y3QgdmVnYTIw
X3NpbmdsZV9kcG1fdGFibGUgKmRwbV90YWJsZSkKLXsKLQlpbnQgaSwgY291bnQ7Ci0KLQljb3Vu
dCA9IChkcG1fdGFibGUtPmNvdW50ID4gTUFYX05VTV9DTE9DS1MpID8gTUFYX05VTV9DTE9DS1Mg
OiBkcG1fdGFibGUtPmNvdW50OwotCWNsb2Nrcy0+bnVtX2xldmVscyA9IGNvdW50OwotCi0JZm9y
IChpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKLQkJY2xvY2tzLT5kYXRhW2ldLmNsb2Nrc19pbl9r
aHogPQotCQkJZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2ldLnZhbHVlICogMTAwMDsKLQkJY2xvY2tz
LT5kYXRhW2ldLmxhdGVuY3lfaW5fdXMgPSAwOwotCX0KLQotCXJldHVybiAwOwotfQotCi1zdGF0
aWMgaW50IHZlZ2EyMF9wcmludF9jbGtfbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAot
CQkJZW51bSBzbXVfY2xrX3R5cGUgdHlwZSwgY2hhciAqYnVmKQotewotCWludCBpLCBub3csIHNp
emUgPSAwOwotCWludCByZXQgPSAwOwotCXVpbnQzMl90IGdlbl9zcGVlZCwgbGFuZV93aWR0aDsK
LQlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IHNtdS0+YWRldjsKLQlzdHJ1Y3QgcHBfY2xv
Y2tfbGV2ZWxzX3dpdGhfbGF0ZW5jeSBjbG9ja3M7Ci0Jc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBt
X3RhYmxlICpzaW5nbGVfZHBtX3RhYmxlOwotCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFi
bGVfY29udGV4dCA9ICZzbXUtPnNtdV90YWJsZTsKLQlzdHJ1Y3Qgc211X2RwbV9jb250ZXh0ICpz
bXVfZHBtID0gJnNtdS0+c211X2RwbTsKLQlzdHJ1Y3QgdmVnYTIwX2RwbV90YWJsZSAqZHBtX3Rh
YmxlID0gTlVMTDsKLQlzdHJ1Y3QgdmVnYTIwX29kOF9zZXR0aW5ncyAqb2Q4X3NldHRpbmdzID0K
LQkJKHN0cnVjdCB2ZWdhMjBfb2Q4X3NldHRpbmdzICopc211LT5vZF9zZXR0aW5nczsKLQlPdmVy
RHJpdmVUYWJsZV90ICpvZF90YWJsZSA9Ci0JCShPdmVyRHJpdmVUYWJsZV90ICopKHRhYmxlX2Nv
bnRleHQtPm92ZXJkcml2ZV90YWJsZSk7Ci0JUFBUYWJsZV90ICpwcHRhYmxlID0gKFBQVGFibGVf
dCAqKXRhYmxlX2NvbnRleHQtPmRyaXZlcl9wcHRhYmxlOwotCi0JZHBtX3RhYmxlID0gc211X2Rw
bS0+ZHBtX2NvbnRleHQ7Ci0KLQlzd2l0Y2ggKHR5cGUpIHsKLQljYXNlIFNNVV9TQ0xLOgotCQly
ZXQgPSBzbXVfZ2V0X2N1cnJlbnRfY2xrX2ZyZXEoc211LCBTTVVfR0ZYQ0xLLCAmbm93KTsKLQkJ
aWYgKHJldCkgewotCQkJcHJfZXJyKCJBdHRlbXB0IHRvIGdldCBjdXJyZW50IGdmeCBjbGsgRmFp
bGVkISIpOwotCQkJcmV0dXJuIHJldDsKLQkJfQotCi0JCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRw
bV90YWJsZS0+Z2Z4X3RhYmxlKTsKLQkJcmV0ID0gdmVnYTIwX2dldF9jbGtfdGFibGUoc211LCAm
Y2xvY2tzLCBzaW5nbGVfZHBtX3RhYmxlKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJBdHRl
bXB0IHRvIGdldCBnZnggY2xrIGxldmVscyBGYWlsZWQhIik7Ci0JCQlyZXR1cm4gcmV0OwotCQl9
Ci0KLQkJZm9yIChpID0gMDsgaSA8IGNsb2Nrcy5udW1fbGV2ZWxzOyBpKyspCi0JCQlzaXplICs9
IHNwcmludGYoYnVmICsgc2l6ZSwgIiVkOiAldU1oeiAlc1xuIiwgaSwKLQkJCQkJY2xvY2tzLmRh
dGFbaV0uY2xvY2tzX2luX2toeiAvIDEwMDAsCi0JCQkJCShjbG9ja3MuZGF0YVtpXS5jbG9ja3Nf
aW5fa2h6ID09IG5vdyAqIDEwKQotCQkJCQk/ICIqIiA6ICIiKTsKLQkJYnJlYWs7Ci0KLQljYXNl
IFNNVV9NQ0xLOgotCQlyZXQgPSBzbXVfZ2V0X2N1cnJlbnRfY2xrX2ZyZXEoc211LCBTTVVfVUNM
SywgJm5vdyk7Ci0JCWlmIChyZXQpIHsKLQkJCXByX2VycigiQXR0ZW1wdCB0byBnZXQgY3VycmVu
dCBtY2xrIEZhaWxlZCEiKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KLQotCQlzaW5nbGVfZHBtX3Rh
YmxlID0gJihkcG1fdGFibGUtPm1lbV90YWJsZSk7Ci0JCXJldCA9IHZlZ2EyMF9nZXRfY2xrX3Rh
YmxlKHNtdSwgJmNsb2Nrcywgc2luZ2xlX2RwbV90YWJsZSk7Ci0JCWlmIChyZXQpIHsKLQkJCXBy
X2VycigiQXR0ZW1wdCB0byBnZXQgbWVtb3J5IGNsayBsZXZlbHMgRmFpbGVkISIpOwotCQkJcmV0
dXJuIHJldDsKLQkJfQotCi0JCWZvciAoaSA9IDA7IGkgPCBjbG9ja3MubnVtX2xldmVsczsgaSsr
KQotCQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIlZDogJXVNaHogJXNcbiIsCi0JCQkJ
aSwgY2xvY2tzLmRhdGFbaV0uY2xvY2tzX2luX2toeiAvIDEwMDAsCi0JCQkJKGNsb2Nrcy5kYXRh
W2ldLmNsb2Nrc19pbl9raHogPT0gbm93ICogMTApCi0JCQkJPyAiKiIgOiAiIik7Ci0JCWJyZWFr
OwotCi0JY2FzZSBTTVVfU09DQ0xLOgotCQlyZXQgPSBzbXVfZ2V0X2N1cnJlbnRfY2xrX2ZyZXEo
c211LCBQUENMS19TT0NDTEssICZub3cpOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIoIkF0dGVt
cHQgdG8gZ2V0IGN1cnJlbnQgc29jY2xrIEZhaWxlZCEiKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0K
LQotCQlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPnNvY190YWJsZSk7Ci0JCXJldCA9
IHZlZ2EyMF9nZXRfY2xrX3RhYmxlKHNtdSwgJmNsb2Nrcywgc2luZ2xlX2RwbV90YWJsZSk7Ci0J
CWlmIChyZXQpIHsKLQkJCXByX2VycigiQXR0ZW1wdCB0byBnZXQgc29jY2xrIGxldmVscyBGYWls
ZWQhIik7Ci0JCQlyZXR1cm4gcmV0OwotCQl9Ci0KLQkJZm9yIChpID0gMDsgaSA8IGNsb2Nrcy5u
dW1fbGV2ZWxzOyBpKyspCi0JCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIiVkOiAldU1o
eiAlc1xuIiwKLQkJCQlpLCBjbG9ja3MuZGF0YVtpXS5jbG9ja3NfaW5fa2h6IC8gMTAwMCwKLQkJ
CQkoY2xvY2tzLmRhdGFbaV0uY2xvY2tzX2luX2toeiA9PSBub3cgKiAxMCkKLQkJCQk/ICIqIiA6
ICIiKTsKLQkJYnJlYWs7Ci0KLQljYXNlIFNNVV9GQ0xLOgotCQlyZXQgPSBzbXVfZ2V0X2N1cnJl
bnRfY2xrX2ZyZXEoc211LCBQUENMS19GQ0xLLCAmbm93KTsKLQkJaWYgKHJldCkgewotCQkJcHJf
ZXJyKCJBdHRlbXB0IHRvIGdldCBjdXJyZW50IGZjbGsgRmFpbGVkISIpOwotCQkJcmV0dXJuIHJl
dDsKLQkJfQotCi0JCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+ZmNsa190YWJsZSk7
Ci0JCWZvciAoaSA9IDA7IGkgPCBzaW5nbGVfZHBtX3RhYmxlLT5jb3VudDsgaSsrKQotCQkJc2l6
ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIlZDogJXVNaHogJXNcbiIsCi0JCQkJaSwgc2luZ2xl
X2RwbV90YWJsZS0+ZHBtX2xldmVsc1tpXS52YWx1ZSwKLQkJCQkoc2luZ2xlX2RwbV90YWJsZS0+
ZHBtX2xldmVsc1tpXS52YWx1ZSA9PSBub3cgLyAxMDApCi0JCQkJPyAiKiIgOiAiIik7Ci0JCWJy
ZWFrOwotCi0JY2FzZSBTTVVfRENFRkNMSzoKLQkJcmV0ID0gc211X2dldF9jdXJyZW50X2Nsa19m
cmVxKHNtdSwgUFBDTEtfRENFRkNMSywgJm5vdyk7Ci0JCWlmIChyZXQpIHsKLQkJCXByX2Vycigi
QXR0ZW1wdCB0byBnZXQgY3VycmVudCBkY2VmY2xrIEZhaWxlZCEiKTsKLQkJCXJldHVybiByZXQ7
Ci0JCX0KLQotCQlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPmRjZWZfdGFibGUpOwot
CQlyZXQgPSB2ZWdhMjBfZ2V0X2Nsa190YWJsZShzbXUsICZjbG9ja3MsIHNpbmdsZV9kcG1fdGFi
bGUpOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIoIkF0dGVtcHQgdG8gZ2V0IGRjZWZjbGsgbGV2
ZWxzIEZhaWxlZCEiKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KLQotCQlmb3IgKGkgPSAwOyBpIDwg
Y2xvY2tzLm51bV9sZXZlbHM7IGkrKykKLQkJCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAi
JWQ6ICV1TWh6ICVzXG4iLAotCQkJCWksIGNsb2Nrcy5kYXRhW2ldLmNsb2Nrc19pbl9raHogLyAx
MDAwLAotCQkJCShjbG9ja3MuZGF0YVtpXS5jbG9ja3NfaW5fa2h6ID09IG5vdyAqIDEwKSA/ICIq
IiA6ICIiKTsKLQkJYnJlYWs7Ci0KLQljYXNlIFNNVV9QQ0lFOgotCQlnZW5fc3BlZWQgPSAoUlJF
RzMyX1BDSUUoc21uUENJRV9MQ19TUEVFRF9DTlRMKSAmCi0JCQkgICAgIFBTV1VTUDBfUENJRV9M
Q19TUEVFRF9DTlRMX19MQ19DVVJSRU5UX0RBVEFfUkFURV9NQVNLKQotCQkJPj4gUFNXVVNQMF9Q
Q0lFX0xDX1NQRUVEX0NOVExfX0xDX0NVUlJFTlRfREFUQV9SQVRFX19TSElGVDsKLQkJbGFuZV93
aWR0aCA9IChSUkVHMzJfUENJRShzbW5QQ0lFX0xDX0xJTktfV0lEVEhfQ05UTCkgJgotCQkJICAg
ICAgUENJRV9MQ19MSU5LX1dJRFRIX0NOVExfX0xDX0xJTktfV0lEVEhfUkRfTUFTSykKLQkJCT4+
IFBDSUVfTENfTElOS19XSURUSF9DTlRMX19MQ19MSU5LX1dJRFRIX1JEX19TSElGVDsKLQkJZm9y
IChpID0gMDsgaSA8IE5VTV9MSU5LX0xFVkVMUzsgaSsrKQotCQkJc2l6ZSArPSBzcHJpbnRmKGJ1
ZiArIHNpemUsICIlZDogJXMgJXMgJWRNaHogJXNcbiIsIGksCi0JCQkJCShwcHRhYmxlLT5QY2ll
R2VuU3BlZWRbaV0gPT0gMCkgPyAiMi41R1QvcywiIDoKLQkJCQkJKHBwdGFibGUtPlBjaWVHZW5T
cGVlZFtpXSA9PSAxKSA/ICI1LjBHVC9zLCIgOgotCQkJCQkocHB0YWJsZS0+UGNpZUdlblNwZWVk
W2ldID09IDIpID8gIjguMEdUL3MsIiA6Ci0JCQkJCShwcHRhYmxlLT5QY2llR2VuU3BlZWRbaV0g
PT0gMykgPyAiMTYuMEdUL3MsIiA6ICIiLAotCQkJCQkocHB0YWJsZS0+UGNpZUxhbmVDb3VudFtp
XSA9PSAxKSA/ICJ4MSIgOgotCQkJCQkocHB0YWJsZS0+UGNpZUxhbmVDb3VudFtpXSA9PSAyKSA/
ICJ4MiIgOgotCQkJCQkocHB0YWJsZS0+UGNpZUxhbmVDb3VudFtpXSA9PSAzKSA/ICJ4NCIgOgot
CQkJCQkocHB0YWJsZS0+UGNpZUxhbmVDb3VudFtpXSA9PSA0KSA/ICJ4OCIgOgotCQkJCQkocHB0
YWJsZS0+UGNpZUxhbmVDb3VudFtpXSA9PSA1KSA/ICJ4MTIiIDoKLQkJCQkJKHBwdGFibGUtPlBj
aWVMYW5lQ291bnRbaV0gPT0gNikgPyAieDE2IiA6ICIiLAotCQkJCQlwcHRhYmxlLT5MY2xrRnJl
cVtpXSwKLQkJCQkJKGdlbl9zcGVlZCA9PSBwcHRhYmxlLT5QY2llR2VuU3BlZWRbaV0pICYmCi0J
CQkJCShsYW5lX3dpZHRoID09IHBwdGFibGUtPlBjaWVMYW5lQ291bnRbaV0pID8KLQkJCQkJIioi
IDogIiIpOwotCQlicmVhazsKLQotCWNhc2UgU01VX09EX1NDTEs6Ci0JCWlmIChvZDhfc2V0dGlu
Z3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRk1JTl0uZmVhdHVyZV9p
ZCAmJgotCQkgICAgb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdf
R0ZYQ0xLX0ZNQVhdLmZlYXR1cmVfaWQpIHsKLQkJCXNpemUgPSBzcHJpbnRmKGJ1ZiwgIiVzOlxu
IiwgIk9EX1NDTEsiKTsKLQkJCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiMDogJTEwdU1o
elxuIiwKLQkJCQkJb2RfdGFibGUtPkdmeGNsa0ZtaW4pOwotCQkJc2l6ZSArPSBzcHJpbnRmKGJ1
ZiArIHNpemUsICIxOiAlMTB1TWh6XG4iLAotCQkJCQlvZF90YWJsZS0+R2Z4Y2xrRm1heCk7Ci0J
CX0KLQotCQlicmVhazsKLQotCWNhc2UgU01VX09EX01DTEs6Ci0JCWlmIChvZDhfc2V0dGluZ3Mt
Pm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19VQ0xLX0ZNQVhdLmZlYXR1cmVfaWQpIHsK
LQkJCXNpemUgPSBzcHJpbnRmKGJ1ZiwgIiVzOlxuIiwgIk9EX01DTEsiKTsKLQkJCXNpemUgKz0g
c3ByaW50ZihidWYgKyBzaXplLCAiMTogJTEwdU1oelxuIiwKLQkJCQkJIG9kX3RhYmxlLT5VY2xr
Rm1heCk7Ci0JCX0KLQotCQlicmVhazsKLQotCWNhc2UgU01VX09EX1ZERENfQ1VSVkU6Ci0JCWlm
IChvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRlJF
UTFdLmZlYXR1cmVfaWQgJiYKLQkJICAgIG9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5
W09EOF9TRVRUSU5HX0dGWENMS19GUkVRMl0uZmVhdHVyZV9pZCAmJgotCQkgICAgb2Q4X3NldHRp
bmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVEzXS5mZWF0dXJl
X2lkICYmCi0JCSAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElO
R19HRlhDTEtfVk9MVEFHRTFdLmZlYXR1cmVfaWQgJiYKLQkJICAgIG9kOF9zZXR0aW5ncy0+b2Q4
X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMl0uZmVhdHVyZV9pZCAm
JgotCQkgICAgb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZY
Q0xLX1ZPTFRBR0UzXS5mZWF0dXJlX2lkKSB7Ci0JCQlzaXplID0gc3ByaW50ZihidWYsICIlczpc
biIsICJPRF9WRERDX0NVUlZFIik7Ci0JCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIjA6
ICUxMHVNaHogJTEwZG1WXG4iLAotCQkJCQlvZF90YWJsZS0+R2Z4Y2xrRnJlcTEsCi0JCQkJCW9k
X3RhYmxlLT5HZnhjbGtWb2x0MSAvIFZPTFRBR0VfU0NBTEUpOwotCQkJc2l6ZSArPSBzcHJpbnRm
KGJ1ZiArIHNpemUsICIxOiAlMTB1TWh6ICUxMGRtVlxuIiwKLQkJCQkJb2RfdGFibGUtPkdmeGNs
a0ZyZXEyLAotCQkJCQlvZF90YWJsZS0+R2Z4Y2xrVm9sdDIgLyBWT0xUQUdFX1NDQUxFKTsKLQkJ
CXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiMjogJTEwdU1oeiAlMTBkbVZcbiIsCi0JCQkJ
CW9kX3RhYmxlLT5HZnhjbGtGcmVxMywKLQkJCQkJb2RfdGFibGUtPkdmeGNsa1ZvbHQzIC8gVk9M
VEFHRV9TQ0FMRSk7Ci0JCX0KLQotCQlicmVhazsKLQotCWNhc2UgU01VX09EX1JBTkdFOgotCQlz
aXplID0gc3ByaW50ZihidWYsICIlczpcbiIsICJPRF9SQU5HRSIpOwotCi0JCWlmIChvZDhfc2V0
dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRk1JTl0uZmVhdHVy
ZV9pZCAmJgotCQkgICAgb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJ
TkdfR0ZYQ0xLX0ZNQVhdLmZlYXR1cmVfaWQpIHsKLQkJCXNpemUgKz0gc3ByaW50ZihidWYgKyBz
aXplLCAiU0NMSzogJTd1TWh6ICUxMHVNaHpcbiIsCi0JCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3Nl
dHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUlOXS5taW5fdmFsdWUsCi0JCQkJCW9k
OF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUFYXS5t
YXhfdmFsdWUpOwotCQl9Ci0KLQkJaWYgKG9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5
W09EOF9TRVRUSU5HX1VDTEtfRk1BWF0uZmVhdHVyZV9pZCkgewotCQkJc2luZ2xlX2RwbV90YWJs
ZSA9ICYoZHBtX3RhYmxlLT5tZW1fdGFibGUpOwotCQkJcmV0ID0gdmVnYTIwX2dldF9jbGtfdGFi
bGUoc211LCAmY2xvY2tzLCBzaW5nbGVfZHBtX3RhYmxlKTsKLQkJCWlmIChyZXQpIHsKLQkJCQlw
cl9lcnIoIkF0dGVtcHQgdG8gZ2V0IG1lbW9yeSBjbGsgbGV2ZWxzIEZhaWxlZCEiKTsKLQkJCQly
ZXR1cm4gcmV0OwotCQkJfQotCi0JCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIk1DTEs6
ICU3dU1oeiAlMTB1TWh6XG4iLAotCQkJCQljbG9ja3MuZGF0YVswXS5jbG9ja3NfaW5fa2h6IC8g
MTAwMCwKLQkJCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdf
VUNMS19GTUFYXS5tYXhfdmFsdWUpOwotCQl9Ci0KLQkJaWYgKG9kOF9zZXR0aW5ncy0+b2Q4X3Nl
dHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GUkVRMV0uZmVhdHVyZV9pZCAmJgotCQkg
ICAgb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZS
RVEyXS5mZWF0dXJlX2lkICYmCi0JCSAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJh
eVtPRDhfU0VUVElOR19HRlhDTEtfRlJFUTNdLmZlYXR1cmVfaWQgJiYKLQkJICAgIG9kOF9zZXR0
aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMV0uZmVh
dHVyZV9pZCAmJgotCQkgICAgb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NF
VFRJTkdfR0ZYQ0xLX1ZPTFRBR0UyXS5mZWF0dXJlX2lkICYmCi0JCSAgICBvZDhfc2V0dGluZ3Mt
Pm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTNdLmZlYXR1cmVf
aWQpIHsKLQkJCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiVkREQ19DVVJWRV9TQ0xLWzBd
OiAlN3VNaHogJTEwdU1oelxuIiwKLQkJCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJy
YXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVExXS5taW5fdmFsdWUsCi0JCQkJCW9kOF9zZXR0aW5n
cy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GUkVRMV0ubWF4X3ZhbHVl
KTsKLQkJCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiVkREQ19DVVJWRV9WT0xUWzBdOiAl
N2RtViAlMTFkbVZcbiIsCi0JCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09E
OF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMV0ubWluX3ZhbHVlLAotCQkJCQlvZDhfc2V0dGluZ3Mt
Pm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTFdLm1heF92YWx1
ZSk7Ci0JCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIlZERENfQ1VSVkVfU0NMS1sxXTog
JTd1TWh6ICUxMHVNaHpcbiIsCi0JCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5
W09EOF9TRVRUSU5HX0dGWENMS19GUkVRMl0ubWluX3ZhbHVlLAotCQkJCQlvZDhfc2V0dGluZ3Mt
Pm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRlJFUTJdLm1heF92YWx1ZSk7
Ci0JCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIlZERENfQ1VSVkVfVk9MVFsxXTogJTdk
bVYgJTExZG1WXG4iLAotCQkJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhf
U0VUVElOR19HRlhDTEtfVk9MVEFHRTJdLm1pbl92YWx1ZSwKLQkJCQkJb2Q4X3NldHRpbmdzLT5v
ZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UyXS5tYXhfdmFsdWUp
OwotCQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICJWRERDX0NVUlZFX1NDTEtbMl06ICU3
dU1oeiAlMTB1TWh6XG4iLAotCQkJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtP
RDhfU0VUVElOR19HRlhDTEtfRlJFUTNdLm1pbl92YWx1ZSwKLQkJCQkJb2Q4X3NldHRpbmdzLT5v
ZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVEzXS5tYXhfdmFsdWUpOwot
CQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICJWRERDX0NVUlZFX1ZPTFRbMl06ICU3ZG1W
ICUxMWRtVlxuIiwKLQkJCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NF
VFRJTkdfR0ZYQ0xLX1ZPTFRBR0UzXS5taW5fdmFsdWUsCi0JCQkJCW9kOF9zZXR0aW5ncy0+b2Q4
X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFM10ubWF4X3ZhbHVlKTsK
LQkJfQotCi0JCWJyZWFrOwotCi0JZGVmYXVsdDoKLQkJYnJlYWs7Ci0JfQotCXJldHVybiBzaXpl
OwotfQotCi1zdGF0aWMgaW50IHZlZ2EyMF91cGxvYWRfZHBtX2xldmVsKHN0cnVjdCBzbXVfY29u
dGV4dCAqc211LCBib29sIG1heCwKLQkJCQkgICB1aW50MzJfdCBmZWF0dXJlX21hc2spCi17Ci0J
c3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKmRwbV90YWJsZTsKLQlzdHJ1Y3QgdmVnYTIwX3Npbmds
ZV9kcG1fdGFibGUgKnNpbmdsZV9kcG1fdGFibGU7Ci0JdWludDMyX3QgZnJlcTsKLQlpbnQgcmV0
ID0gMDsKLQotCWRwbV90YWJsZSA9IHNtdS0+c211X2RwbS5kcG1fY29udGV4dDsKLQotCWlmIChz
bXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX0dGWENMS19CSVQpICYm
Ci0JICAgIChmZWF0dXJlX21hc2sgJiBGRUFUVVJFX0RQTV9HRlhDTEtfTUFTSykpIHsKLQkJc2lu
Z2xlX2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5nZnhfdGFibGUpOwotCQlmcmVxID0gbWF4ID8g
c2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsIDoKLQkJCXNpbmdsZV9k
cG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbDsKLQkJcmV0ID0gc211X3NlbmRfc21j
X21zZ193aXRoX3BhcmFtKHNtdSwKLQkJCShtYXggPyBTTVVfTVNHX1NldFNvZnRNYXhCeUZyZXEg
OiBTTVVfTVNHX1NldFNvZnRNaW5CeUZyZXEpLAotCQkJKFBQQ0xLX0dGWENMSyA8PCAxNikgfCAo
ZnJlcSAmIDB4ZmZmZikpOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIoIkZhaWxlZCB0byBzZXQg
c29mdCAlcyBnZnhjbGsgIVxuIiwKLQkJCQkJCW1heCA/ICJtYXgiIDogIm1pbiIpOwotCQkJcmV0
dXJuIHJldDsKLQkJfQotCX0KLQotCWlmIChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01V
X0ZFQVRVUkVfRFBNX1VDTEtfQklUKSAmJgotCSAgICAoZmVhdHVyZV9tYXNrICYgRkVBVFVSRV9E
UE1fVUNMS19NQVNLKSkgewotCQlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPm1lbV90
YWJsZSk7Ci0JCWZyZXEgPSBtYXggPyBzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9t
YXhfbGV2ZWwgOgotCQkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVs
OwotCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LAotCQkJKG1heCA/IFNN
VV9NU0dfU2V0U29mdE1heEJ5RnJlcSA6IFNNVV9NU0dfU2V0U29mdE1pbkJ5RnJlcSksCi0JCQko
UFBDTEtfVUNMSyA8PCAxNikgfCAoZnJlcSAmIDB4ZmZmZikpOwotCQlpZiAocmV0KSB7Ci0JCQlw
cl9lcnIoIkZhaWxlZCB0byBzZXQgc29mdCAlcyBtZW1jbGsgIVxuIiwKLQkJCQkJCW1heCA/ICJt
YXgiIDogIm1pbiIpOwotCQkJcmV0dXJuIHJldDsKLQkJfQotCX0KLQotCWlmIChzbXVfZmVhdHVy
ZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX1NPQ0NMS19CSVQpICYmCi0JICAgIChm
ZWF0dXJlX21hc2sgJiBGRUFUVVJFX0RQTV9TT0NDTEtfTUFTSykpIHsKLQkJc2luZ2xlX2RwbV90
YWJsZSA9ICYoZHBtX3RhYmxlLT5zb2NfdGFibGUpOwotCQlmcmVxID0gbWF4ID8gc2luZ2xlX2Rw
bV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsIDoKLQkJCXNpbmdsZV9kcG1fdGFibGUt
PmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbDsKLQkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRo
X3BhcmFtKHNtdSwKLQkJCShtYXggPyBTTVVfTVNHX1NldFNvZnRNYXhCeUZyZXEgOiBTTVVfTVNH
X1NldFNvZnRNaW5CeUZyZXEpLAotCQkJKFBQQ0xLX1NPQ0NMSyA8PCAxNikgfCAoZnJlcSAmIDB4
ZmZmZikpOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIoIkZhaWxlZCB0byBzZXQgc29mdCAlcyBz
b2NjbGsgIVxuIiwKLQkJCQkJCW1heCA/ICJtYXgiIDogIm1pbiIpOwotCQkJcmV0dXJuIHJldDsK
LQkJfQotCX0KLQotCWlmIChzbXVfZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVf
RFBNX0ZDTEtfQklUKSAmJgotCSAgICAoZmVhdHVyZV9tYXNrICYgRkVBVFVSRV9EUE1fRkNMS19N
QVNLKSkgewotCQlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPmZjbGtfdGFibGUpOwot
CQlmcmVxID0gbWF4ID8gc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVs
IDoKLQkJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbDsKLQkJcmV0
ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwKLQkJCShtYXggPyBTTVVfTVNHX1Nl
dFNvZnRNYXhCeUZyZXEgOiBTTVVfTVNHX1NldFNvZnRNaW5CeUZyZXEpLAotCQkJKFBQQ0xLX0ZD
TEsgPDwgMTYpIHwgKGZyZXEgJiAweGZmZmYpKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJG
YWlsZWQgdG8gc2V0IHNvZnQgJXMgZmNsayAhXG4iLAotCQkJCQkJbWF4ID8gIm1heCIgOiAibWlu
Iik7Ci0JCQlyZXR1cm4gcmV0OwotCQl9Ci0JfQotCi0JaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJs
ZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fRENFRkNMS19CSVQpICYmCi0JICAgIChmZWF0dXJlX21h
c2sgJiBGRUFUVVJFX0RQTV9EQ0VGQ0xLX01BU0spKSB7Ci0JCXNpbmdsZV9kcG1fdGFibGUgPSAm
KGRwbV90YWJsZS0+ZGNlZl90YWJsZSk7Ci0JCWZyZXEgPSBzaW5nbGVfZHBtX3RhYmxlLT5kcG1f
c3RhdGUuaGFyZF9taW5fbGV2ZWw7Ci0JCWlmICghbWF4KSB7Ci0JCQlyZXQgPSBzbXVfc2VuZF9z
bWNfbXNnX3dpdGhfcGFyYW0oc211LAotCQkJCVNNVV9NU0dfU2V0SGFyZE1pbkJ5RnJlcSwKLQkJ
CQkoUFBDTEtfRENFRkNMSyA8PCAxNikgfCAoZnJlcSAmIDB4ZmZmZikpOwotCQkJaWYgKHJldCkg
ewotCQkJCXByX2VycigiRmFpbGVkIHRvIHNldCBoYXJkIG1pbiBkY2VmY2xrICFcbiIpOwotCQkJ
CXJldHVybiByZXQ7Ci0JCQl9Ci0JCX0KLQl9Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMg
aW50IHZlZ2EyMF9mb3JjZV9jbGtfbGV2ZWxzKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAotCQkJ
ZW51bSAgc211X2Nsa190eXBlIGNsa190eXBlLCB1aW50MzJfdCBtYXNrKQotewotCXN0cnVjdCB2
ZWdhMjBfZHBtX3RhYmxlICpkcG1fdGFibGU7Ci0Jc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3Rh
YmxlICpzaW5nbGVfZHBtX3RhYmxlOwotCXVpbnQzMl90IHNvZnRfbWluX2xldmVsLCBzb2Z0X21h
eF9sZXZlbCwgaGFyZF9taW5fbGV2ZWw7Ci0Jc3RydWN0IHNtdV9kcG1fY29udGV4dCAqc211X2Rw
bSA9ICZzbXUtPnNtdV9kcG07Ci0JaW50IHJldCA9IDA7Ci0KLQlpZiAoc211X2RwbS0+ZHBtX2xl
dmVsICE9IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX01BTlVBTCkgewotCQlwcl9pbmZvKCJmb3JjZSBj
bG9jayBsZXZlbCBpcyBmb3IgZHBtIG1hbnVhbCBtb2RlIG9ubHkuXG4iKTsKLQkJcmV0dXJuIC1F
SU5WQUw7Ci0JfQotCi0JbXV0ZXhfbG9jaygmKHNtdS0+bXV0ZXgpKTsKLQotCXNvZnRfbWluX2xl
dmVsID0gbWFzayA/IChmZnMobWFzaykgLSAxKSA6IDA7Ci0Jc29mdF9tYXhfbGV2ZWwgPSBtYXNr
ID8gKGZscyhtYXNrKSAtIDEpIDogMDsKLQotCWRwbV90YWJsZSA9IHNtdS0+c211X2RwbS5kcG1f
Y29udGV4dDsKLQotCXN3aXRjaCAoY2xrX3R5cGUpIHsKLQljYXNlIFNNVV9TQ0xLOgotCQlzaW5n
bGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPmdmeF90YWJsZSk7Ci0KLQkJaWYgKHNvZnRfbWF4
X2xldmVsID49IHNpbmdsZV9kcG1fdGFibGUtPmNvdW50KSB7Ci0JCQlwcl9lcnIoIkNsb2NrIGxl
dmVsIHNwZWNpZmllZCAlZCBpcyBvdmVyIG1heCBhbGxvd2VkICVkXG4iLAotCQkJCQlzb2Z0X21h
eF9sZXZlbCwgc2luZ2xlX2RwbV90YWJsZS0+Y291bnQgLSAxKTsKLQkJCXJldCA9IC1FSU5WQUw7
Ci0JCQlicmVhazsKLQkJfQotCi0JCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21p
bl9sZXZlbCA9Ci0JCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW3NvZnRfbWluX2xldmVs
XS52YWx1ZTsKLQkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsID0K
LQkJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbc29mdF9tYXhfbGV2ZWxdLnZhbHVlOwot
Ci0JCXJldCA9IHZlZ2EyMF91cGxvYWRfZHBtX2xldmVsKHNtdSwgZmFsc2UsIEZFQVRVUkVfRFBN
X0dGWENMS19NQVNLKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJGYWlsZWQgdG8gdXBsb2Fk
IGJvb3QgbGV2ZWwgdG8gbG93ZXN0IVxuIik7Ci0JCQlicmVhazsKLQkJfQotCi0JCXJldCA9IHZl
Z2EyMF91cGxvYWRfZHBtX2xldmVsKHNtdSwgdHJ1ZSwgRkVBVFVSRV9EUE1fR0ZYQ0xLX01BU0sp
OwotCQlpZiAocmV0KQotCQkJcHJfZXJyKCJGYWlsZWQgdG8gdXBsb2FkIGRwbSBtYXggbGV2ZWwg
dG8gaGlnaGVzdCFcbiIpOwotCi0JCWJyZWFrOwotCi0JY2FzZSBTTVVfTUNMSzoKLQkJc2luZ2xl
X2RwbV90YWJsZSA9ICYoZHBtX3RhYmxlLT5tZW1fdGFibGUpOwotCi0JCWlmIChzb2Z0X21heF9s
ZXZlbCA+PSBzaW5nbGVfZHBtX3RhYmxlLT5jb3VudCkgewotCQkJcHJfZXJyKCJDbG9jayBsZXZl
bCBzcGVjaWZpZWQgJWQgaXMgb3ZlciBtYXggYWxsb3dlZCAlZFxuIiwKLQkJCQkJc29mdF9tYXhf
bGV2ZWwsIHNpbmdsZV9kcG1fdGFibGUtPmNvdW50IC0gMSk7Ci0JCQlyZXQgPSAtRUlOVkFMOwot
CQkJYnJlYWs7Ci0JCX0KLQotCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5f
bGV2ZWwgPQotCQkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX2xldmVsc1tzb2Z0X21pbl9sZXZlbF0u
dmFsdWU7Ci0JCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9Ci0J
CQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW3NvZnRfbWF4X2xldmVsXS52YWx1ZTsKLQot
CQlyZXQgPSB2ZWdhMjBfdXBsb2FkX2RwbV9sZXZlbChzbXUsIGZhbHNlLCBGRUFUVVJFX0RQTV9V
Q0xLX01BU0spOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIoIkZhaWxlZCB0byB1cGxvYWQgYm9v
dCBsZXZlbCB0byBsb3dlc3QhXG4iKTsKLQkJCWJyZWFrOwotCQl9Ci0KLQkJcmV0ID0gdmVnYTIw
X3VwbG9hZF9kcG1fbGV2ZWwoc211LCB0cnVlLCBGRUFUVVJFX0RQTV9VQ0xLX01BU0spOwotCQlp
ZiAocmV0KQotCQkJcHJfZXJyKCJGYWlsZWQgdG8gdXBsb2FkIGRwbSBtYXggbGV2ZWwgdG8gaGln
aGVzdCFcbiIpOwotCi0JCWJyZWFrOwotCi0JY2FzZSBTTVVfU09DQ0xLOgotCQlzaW5nbGVfZHBt
X3RhYmxlID0gJihkcG1fdGFibGUtPnNvY190YWJsZSk7Ci0KLQkJaWYgKHNvZnRfbWF4X2xldmVs
ID49IHNpbmdsZV9kcG1fdGFibGUtPmNvdW50KSB7Ci0JCQlwcl9lcnIoIkNsb2NrIGxldmVsIHNw
ZWNpZmllZCAlZCBpcyBvdmVyIG1heCBhbGxvd2VkICVkXG4iLAotCQkJCQlzb2Z0X21heF9sZXZl
bCwgc2luZ2xlX2RwbV90YWJsZS0+Y291bnQgLSAxKTsKLQkJCXJldCA9IC1FSU5WQUw7Ci0JCQli
cmVhazsKLQkJfQotCi0JCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZl
bCA9Ci0JCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW3NvZnRfbWluX2xldmVsXS52YWx1
ZTsKLQkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsID0KLQkJCXNp
bmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbc29mdF9tYXhfbGV2ZWxdLnZhbHVlOwotCi0JCXJl
dCA9IHZlZ2EyMF91cGxvYWRfZHBtX2xldmVsKHNtdSwgZmFsc2UsIEZFQVRVUkVfRFBNX1NPQ0NM
S19NQVNLKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJGYWlsZWQgdG8gdXBsb2FkIGJvb3Qg
bGV2ZWwgdG8gbG93ZXN0IVxuIik7Ci0JCQlicmVhazsKLQkJfQotCi0JCXJldCA9IHZlZ2EyMF91
cGxvYWRfZHBtX2xldmVsKHNtdSwgdHJ1ZSwgRkVBVFVSRV9EUE1fU09DQ0xLX01BU0spOwotCQlp
ZiAocmV0KQotCQkJcHJfZXJyKCJGYWlsZWQgdG8gdXBsb2FkIGRwbSBtYXggbGV2ZWwgdG8gaGln
aGVzdCFcbiIpOwotCi0JCWJyZWFrOwotCi0JY2FzZSBTTVVfRkNMSzoKLQkJc2luZ2xlX2RwbV90
YWJsZSA9ICYoZHBtX3RhYmxlLT5mY2xrX3RhYmxlKTsKLQotCQlpZiAoc29mdF9tYXhfbGV2ZWwg
Pj0gc2luZ2xlX2RwbV90YWJsZS0+Y291bnQpIHsKLQkJCXByX2VycigiQ2xvY2sgbGV2ZWwgc3Bl
Y2lmaWVkICVkIGlzIG92ZXIgbWF4IGFsbG93ZWQgJWRcbiIsCi0JCQkJCXNvZnRfbWF4X2xldmVs
LCBzaW5nbGVfZHBtX3RhYmxlLT5jb3VudCAtIDEpOwotCQkJcmV0ID0gLUVJTlZBTDsKLQkJCWJy
ZWFrOwotCQl9Ci0KLQkJc2luZ2xlX2RwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVs
ID0KLQkJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNbc29mdF9taW5fbGV2ZWxdLnZhbHVl
OwotCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgPQotCQkJc2lu
Z2xlX2RwbV90YWJsZS0+ZHBtX2xldmVsc1tzb2Z0X21heF9sZXZlbF0udmFsdWU7Ci0KLQkJcmV0
ID0gdmVnYTIwX3VwbG9hZF9kcG1fbGV2ZWwoc211LCBmYWxzZSwgRkVBVFVSRV9EUE1fRkNMS19N
QVNLKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJGYWlsZWQgdG8gdXBsb2FkIGJvb3QgbGV2
ZWwgdG8gbG93ZXN0IVxuIik7Ci0JCQlicmVhazsKLQkJfQotCi0JCXJldCA9IHZlZ2EyMF91cGxv
YWRfZHBtX2xldmVsKHNtdSwgdHJ1ZSwgRkVBVFVSRV9EUE1fRkNMS19NQVNLKTsKLQkJaWYgKHJl
dCkKLQkJCXByX2VycigiRmFpbGVkIHRvIHVwbG9hZCBkcG0gbWF4IGxldmVsIHRvIGhpZ2hlc3Qh
XG4iKTsKLQotCQlicmVhazsKLQotCWNhc2UgU01VX0RDRUZDTEs6Ci0JCWhhcmRfbWluX2xldmVs
ID0gc29mdF9taW5fbGV2ZWw7Ci0JCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+ZGNl
Zl90YWJsZSk7Ci0KLQkJaWYgKGhhcmRfbWluX2xldmVsID49IHNpbmdsZV9kcG1fdGFibGUtPmNv
dW50KSB7Ci0JCQlwcl9lcnIoIkNsb2NrIGxldmVsIHNwZWNpZmllZCAlZCBpcyBvdmVyIG1heCBh
bGxvd2VkICVkXG4iLAotCQkJCQloYXJkX21pbl9sZXZlbCwgc2luZ2xlX2RwbV90YWJsZS0+Y291
bnQgLSAxKTsKLQkJCXJldCA9IC1FSU5WQUw7Ci0JCQlicmVhazsKLQkJfQotCi0JCXNpbmdsZV9k
cG1fdGFibGUtPmRwbV9zdGF0ZS5oYXJkX21pbl9sZXZlbCA9Ci0JCQlzaW5nbGVfZHBtX3RhYmxl
LT5kcG1fbGV2ZWxzW2hhcmRfbWluX2xldmVsXS52YWx1ZTsKLQotCQlyZXQgPSB2ZWdhMjBfdXBs
b2FkX2RwbV9sZXZlbChzbXUsIGZhbHNlLCBGRUFUVVJFX0RQTV9EQ0VGQ0xLX01BU0spOwotCQlp
ZiAocmV0KQotCQkJcHJfZXJyKCJGYWlsZWQgdG8gdXBsb2FkIGJvb3QgbGV2ZWwgdG8gbG93ZXN0
IVxuIik7Ci0KLQkJYnJlYWs7Ci0KLQljYXNlIFNNVV9QQ0lFOgotCQlpZiAoc29mdF9taW5fbGV2
ZWwgPj0gTlVNX0xJTktfTEVWRUxTIHx8Ci0JCSAgICBzb2Z0X21heF9sZXZlbCA+PSBOVU1fTElO
S19MRVZFTFMpIHsKLQkJCXJldCA9IC1FSU5WQUw7Ci0JCQlicmVhazsKLQkJfQotCi0JCXJldCA9
IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsCi0JCQkJU01VX01TR19TZXRNaW5MaW5r
RHBtQnlJbmRleCwgc29mdF9taW5fbGV2ZWwpOwotCQlpZiAocmV0KQotCQkJcHJfZXJyKCJGYWls
ZWQgdG8gc2V0IG1pbiBsaW5rIGRwbSBsZXZlbCFcbiIpOwotCi0JCWJyZWFrOwotCi0JZGVmYXVs
dDoKLQkJYnJlYWs7Ci0JfQotCi0JbXV0ZXhfdW5sb2NrKCYoc211LT5tdXRleCkpOwotCXJldHVy
biByZXQ7Ci19Ci0KLXN0YXRpYyBpbnQgdmVnYTIwX2dldF9jbG9ja19ieV90eXBlX3dpdGhfbGF0
ZW5jeShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKLQkJCQkJCSBlbnVtIHNtdV9jbGtfdHlwZSBj
bGtfdHlwZSwKLQkJCQkJCSBzdHJ1Y3QgcHBfY2xvY2tfbGV2ZWxzX3dpdGhfbGF0ZW5jeSAqY2xv
Y2tzKQotewotCWludCByZXQ7Ci0Jc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICpzaW5n
bGVfZHBtX3RhYmxlOwotCXN0cnVjdCBzbXVfZHBtX2NvbnRleHQgKnNtdV9kcG0gPSAmc211LT5z
bXVfZHBtOwotCXN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICpkcG1fdGFibGUgPSBOVUxMOwotCi0J
ZHBtX3RhYmxlID0gc211X2RwbS0+ZHBtX2NvbnRleHQ7Ci0KLQltdXRleF9sb2NrKCZzbXUtPm11
dGV4KTsKLQotCXN3aXRjaCAoY2xrX3R5cGUpIHsKLQljYXNlIFNNVV9HRlhDTEs6Ci0JCXNpbmds
ZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+Z2Z4X3RhYmxlKTsKLQkJcmV0ID0gdmVnYTIwX2dl
dF9jbGtfdGFibGUoc211LCBjbG9ja3MsIHNpbmdsZV9kcG1fdGFibGUpOwotCQlicmVhazsKLQlj
YXNlIFNNVV9NQ0xLOgotCQlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPm1lbV90YWJs
ZSk7Ci0JCXJldCA9IHZlZ2EyMF9nZXRfY2xrX3RhYmxlKHNtdSwgY2xvY2tzLCBzaW5nbGVfZHBt
X3RhYmxlKTsKLQkJYnJlYWs7Ci0JY2FzZSBTTVVfRENFRkNMSzoKLQkJc2luZ2xlX2RwbV90YWJs
ZSA9ICYoZHBtX3RhYmxlLT5kY2VmX3RhYmxlKTsKLQkJcmV0ID0gdmVnYTIwX2dldF9jbGtfdGFi
bGUoc211LCBjbG9ja3MsIHNpbmdsZV9kcG1fdGFibGUpOwotCQlicmVhazsKLQljYXNlIFNNVV9T
T0NDTEs6Ci0JCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+c29jX3RhYmxlKTsKLQkJ
cmV0ID0gdmVnYTIwX2dldF9jbGtfdGFibGUoc211LCBjbG9ja3MsIHNpbmdsZV9kcG1fdGFibGUp
OwotCQlicmVhazsKLQlkZWZhdWx0OgotCQlyZXQgPSAtRUlOVkFMOwotCX0KLQotCW11dGV4X3Vu
bG9jaygmc211LT5tdXRleCk7Ci0JcmV0dXJuIHJldDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBf
b3ZlcmRyaXZlX2dldF9nZnhfY2xrX2Jhc2Vfdm9sdGFnZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNt
dSwKLQkJCQkJCSAgICAgdWludDMyX3QgKnZvbHRhZ2UsCi0JCQkJCQkgICAgIHVpbnQzMl90IGZy
ZXEpCi17Ci0JaW50IHJldDsKLQotCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShz
bXUsCi0JCQlTTVVfTVNHX0dldEFWRlNWb2x0YWdlQnlEcG0sCi0JCQkoKEFWRlNfQ1VSVkUgPDwg
MjQpIHwgKE9EOF9IT1RDVVJWRV9URU1QRVJBVFVSRSA8PCAxNikgfCBmcmVxKSk7Ci0JaWYgKHJl
dCkgewotCQlwcl9lcnIoIltHZXRCYXNlVm9sdGFnZV0gZmFpbGVkIHRvIGdldCBHRlhDTEsgQVZG
UyB2b2x0YWdlIGZyb20gU01VISIpOwotCQlyZXR1cm4gcmV0OwotCX0KLQotCXNtdV9yZWFkX3Nt
Y19hcmcoc211LCB2b2x0YWdlKTsKLQkqdm9sdGFnZSA9ICp2b2x0YWdlIC8gVk9MVEFHRV9TQ0FM
RTsKLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IHZlZ2EyMF9zZXRfZGVmYXVsdF9vZDhf
c2V0dHRpbmdzKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQotewotCXN0cnVjdCBzbXVfdGFibGVf
Y29udGV4dCAqdGFibGVfY29udGV4dCA9ICZzbXUtPnNtdV90YWJsZTsKLQlPdmVyRHJpdmVUYWJs
ZV90ICpvZF90YWJsZSA9IChPdmVyRHJpdmVUYWJsZV90ICopKHRhYmxlX2NvbnRleHQtPm92ZXJk
cml2ZV90YWJsZSk7Ci0Jc3RydWN0IHZlZ2EyMF9vZDhfc2V0dGluZ3MgKm9kOF9zZXR0aW5ncyA9
IE5VTEw7Ci0JUFBUYWJsZV90ICpzbWNfcHB0YWJsZSA9IHRhYmxlX2NvbnRleHQtPmRyaXZlcl9w
cHRhYmxlOwotCWludCBpLCByZXQ7Ci0KLQlpZiAoc211LT5vZF9zZXR0aW5ncykKLQkJcmV0dXJu
IC1FSU5WQUw7Ci0KLQlvZDhfc2V0dGluZ3MgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgdmVnYTIw
X29kOF9zZXR0aW5ncyksIEdGUF9LRVJORUwpOwotCi0JaWYgKG9kOF9zZXR0aW5ncykKLQkJcmV0
dXJuIC1FTk9NRU07Ci0KLQlzbXUtPm9kX3NldHRpbmdzID0gKHZvaWQgKilvZDhfc2V0dGluZ3M7
Ci0KLQlpZiAoc211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9TT0ND
TEtfQklUKSkgewotCQlpZiAob2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllc1tB
VE9NX1ZFR0EyMF9PREZFQVRVUkVfR0ZYQ0xLX0xJTUlUU10gJiYKLQkJICAgIG9kOF9zZXR0aW5n
cy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX0dGWENMS19GTUFYXSA+IDAgJiYKLQkJICAg
IG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX0dGWENMS19GTUlOXSA+
IDAgJiYKLQkJICAgIChvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21heFtPRDhfU0VUVElOR19H
RlhDTEtfRk1BWF0gPj0KLQkJICAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbltPRDhf
U0VUVElOR19HRlhDTEtfRk1JTl0pKSB7Ci0JCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19h
cnJheVtPRDhfU0VUVElOR19HRlhDTEtfRk1JTl0uZmVhdHVyZV9pZCA9Ci0JCQkJT0Q4X0dGWENM
S19MSU1JVFM7Ci0JCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElO
R19HRlhDTEtfRk1BWF0uZmVhdHVyZV9pZCA9Ci0JCQkJT0Q4X0dGWENMS19MSU1JVFM7Ci0JCQlv
ZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRk1JTl0u
ZGVmYXVsdF92YWx1ZSA9Ci0JCQkJb2RfdGFibGUtPkdmeGNsa0ZtaW47Ci0JCQlvZDhfc2V0dGlu
Z3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRk1BWF0uZGVmYXVsdF92
YWx1ZSA9Ci0JCQkJb2RfdGFibGUtPkdmeGNsa0ZtYXg7Ci0JCX0KLQotCQlpZiAob2Q4X3NldHRp
bmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllc1tBVE9NX1ZFR0EyMF9PREZFQVRVUkVfR0ZYQ0xL
X0NVUlZFXSAmJgotCQkgICAgKG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRU
SU5HX0dGWENMS19WT0xUQUdFMV0gPj0KLQkJICAgICBzbWNfcHB0YWJsZS0+TWluVm9sdGFnZUdm
eCAvIFZPTFRBR0VfU0NBTEUpICYmCi0JCSAgICAob2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19t
YXhbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UzXSA8PQotCQkgICAgIHNtY19wcHRhYmxlLT5N
YXhWb2x0YWdlR2Z4IC8gVk9MVEFHRV9TQ0FMRSkgJiYKLQkJICAgIChvZDhfc2V0dGluZ3MtPm9k
X3NldHRpbmdzX21pbltPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTFdIDw9Ci0JCSAgICAgb2Q4
X3NldHRpbmdzLT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UzXSkp
IHsKLQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENM
S19GUkVRMV0uZmVhdHVyZV9pZCA9Ci0JCQkJT0Q4X0dGWENMS19DVVJWRTsKLQkJCW9kOF9zZXR0
aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMV0uZmVh
dHVyZV9pZCA9Ci0JCQkJT0Q4X0dGWENMS19DVVJWRTsKLQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3Nl
dHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GUkVRMl0uZmVhdHVyZV9pZCA9Ci0JCQkJ
T0Q4X0dGWENMS19DVVJWRTsKLQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09E
OF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMl0uZmVhdHVyZV9pZCA9Ci0JCQkJT0Q4X0dGWENMS19D
VVJWRTsKLQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dG
WENMS19GUkVRM10uZmVhdHVyZV9pZCA9Ci0JCQkJT0Q4X0dGWENMS19DVVJWRTsKLQkJCW9kOF9z
ZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFM10u
ZmVhdHVyZV9pZCA9Ci0JCQkJT0Q4X0dGWENMS19DVVJWRTsKLQotCQkJb2RfdGFibGUtPkdmeGNs
a0ZyZXExID0gb2RfdGFibGUtPkdmeGNsa0ZtaW47Ci0JCQlvZF90YWJsZS0+R2Z4Y2xrRnJlcTIg
PSAob2RfdGFibGUtPkdmeGNsa0ZtaW4gKyBvZF90YWJsZS0+R2Z4Y2xrRm1heCkgLyAyOwotCQkJ
b2RfdGFibGUtPkdmeGNsa0ZyZXEzID0gb2RfdGFibGUtPkdmeGNsa0ZtYXg7Ci0JCQlvZDhfc2V0
dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtfRlJFUTFdLmRlZmF1
bHRfdmFsdWUgPQotCQkJCW9kX3RhYmxlLT5HZnhjbGtGcmVxMTsKLQkJCW9kOF9zZXR0aW5ncy0+
b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GUkVRMl0uZGVmYXVsdF92YWx1
ZSA9Ci0JCQkJb2RfdGFibGUtPkdmeGNsa0ZyZXEyOwotCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0
dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVEzXS5kZWZhdWx0X3ZhbHVlID0KLQkJ
CQlvZF90YWJsZS0+R2Z4Y2xrRnJlcTM7Ci0KLQkJCXJldCA9IHZlZ2EyMF9vdmVyZHJpdmVfZ2V0
X2dmeF9jbGtfYmFzZV92b2x0YWdlKHNtdSwKLQkJCQkmb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGlu
Z3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UxXS5kZWZhdWx0X3ZhbHVlLAotCQkJ
CW9kX3RhYmxlLT5HZnhjbGtGcmVxMSk7Ci0JCQlpZiAocmV0KQotCQkJCW9kOF9zZXR0aW5ncy0+
b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMV0uZGVmYXVsdF92
YWx1ZSA9IDA7Ci0JCQlvZF90YWJsZS0+R2Z4Y2xrVm9sdDEgPQotCQkJCW9kOF9zZXR0aW5ncy0+
b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMV0uZGVmYXVsdF92
YWx1ZQotCQkJCSogVk9MVEFHRV9TQ0FMRTsKLQkJCXJldCA9IHZlZ2EyMF9vdmVyZHJpdmVfZ2V0
X2dmeF9jbGtfYmFzZV92b2x0YWdlKHNtdSwKLQkJCQkmb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGlu
Z3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UyXS5kZWZhdWx0X3ZhbHVlLAotCQkJ
CW9kX3RhYmxlLT5HZnhjbGtGcmVxMik7Ci0JCQlpZiAocmV0KQotCQkJCW9kOF9zZXR0aW5ncy0+
b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMl0uZGVmYXVsdF92
YWx1ZSA9IDA7Ci0JCQlvZF90YWJsZS0+R2Z4Y2xrVm9sdDIgPQotCQkJCW9kOF9zZXR0aW5ncy0+
b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMl0uZGVmYXVsdF92
YWx1ZQotCQkJCSogVk9MVEFHRV9TQ0FMRTsKLQkJCXJldCA9IHZlZ2EyMF9vdmVyZHJpdmVfZ2V0
X2dmeF9jbGtfYmFzZV92b2x0YWdlKHNtdSwKLQkJCQkmb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGlu
Z3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UzXS5kZWZhdWx0X3ZhbHVlLAotCQkJ
CW9kX3RhYmxlLT5HZnhjbGtGcmVxMyk7Ci0JCQlpZiAocmV0KQotCQkJCW9kOF9zZXR0aW5ncy0+
b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFM10uZGVmYXVsdF92
YWx1ZSA9IDA7Ci0JCQlvZF90YWJsZS0+R2Z4Y2xrVm9sdDMgPQotCQkJCW9kOF9zZXR0aW5ncy0+
b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFM10uZGVmYXVsdF92
YWx1ZQotCQkJCSogVk9MVEFHRV9TQ0FMRTsKLQkJfQotCX0KLQotCWlmIChzbXVfZmVhdHVyZV9p
c19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX1VDTEtfQklUKSkgewotCQlpZiAob2Q4X3Nl
dHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllc1tBVE9NX1ZFR0EyMF9PREZFQVRVUkVfVUNM
S19NQVhdICYmCi0JCSAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbltPRDhfU0VUVElO
R19VQ0xLX0ZNQVhdID4gMCAmJgotCQkgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19tYXhb
T0Q4X1NFVFRJTkdfVUNMS19GTUFYXSA+IDAgJiYKLQkJICAgIChvZDhfc2V0dGluZ3MtPm9kX3Nl
dHRpbmdzX21heFtPRDhfU0VUVElOR19VQ0xLX0ZNQVhdID49Ci0JCSAgICAgb2Q4X3NldHRpbmdz
LT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfVUNMS19GTUFYXSkpIHsKLQkJCW9kOF9zZXR0
aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX1VDTEtfRk1BWF0uZmVhdHVyZV9p
ZCA9Ci0JCQkJT0Q4X1VDTEtfTUFYOwotCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJy
YXlbT0Q4X1NFVFRJTkdfVUNMS19GTUFYXS5kZWZhdWx0X3ZhbHVlID0KLQkJCQlvZF90YWJsZS0+
VWNsa0ZtYXg7Ci0JCX0KLQl9Ci0KLQlpZiAob2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFi
aWxpdGllc1tBVE9NX1ZFR0EyMF9PREZFQVRVUkVfUE9XRVJfTElNSVRdICYmCi0JICAgIG9kOF9z
ZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX1BPV0VSX1BFUkNFTlRBR0VdID4g
MCAmJgotCSAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbltPRDhfU0VUVElOR19QT1dF
Ul9QRVJDRU5UQUdFXSA8PSAxMDAgJiYKLQkgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19t
YXhbT0Q4X1NFVFRJTkdfUE9XRVJfUEVSQ0VOVEFHRV0gPiAwICYmCi0JICAgIG9kOF9zZXR0aW5n
cy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX1BPV0VSX1BFUkNFTlRBR0VdIDw9IDEwMCkg
ewotCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19QT1dFUl9Q
RVJDRU5UQUdFXS5mZWF0dXJlX2lkID0KLQkJCU9EOF9QT1dFUl9MSU1JVDsKLQkJb2Q4X3NldHRp
bmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfUE9XRVJfUEVSQ0VOVEFHRV0uZGVm
YXVsdF92YWx1ZSA9Ci0JCQlvZF90YWJsZS0+T3ZlckRyaXZlUGN0OwotCX0KLQotCWlmIChzbXVf
ZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRkFOX0NPTlRST0xfQklUKSkgewot
CQlpZiAob2Q4X3NldHRpbmdzLT5vZF9mZWF0dXJlX2NhcGFiaWxpdGllc1tBVE9NX1ZFR0EyMF9P
REZFQVRVUkVfRkFOX0FDT1VTVElDX0xJTUlUXSAmJgotCQkgICAgb2Q4X3NldHRpbmdzLT5vZF9z
ZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfRkFOX0FDT1VTVElDX0xJTUlUXSA+IDAgJiYKLQkJICAg
IG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX0ZBTl9BQ09VU1RJQ19M
SU1JVF0gPiAwICYmCi0JCSAgICAob2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NF
VFRJTkdfRkFOX0FDT1VTVElDX0xJTUlUXSA+PQotCQkgICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0
dGluZ3NfbWluW09EOF9TRVRUSU5HX0ZBTl9BQ09VU1RJQ19MSU1JVF0pKSB7Ci0JCQlvZDhfc2V0
dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19GQU5fQUNPVVNUSUNfTElNSVRd
LmZlYXR1cmVfaWQgPQotCQkJCU9EOF9BQ09VU1RJQ19MSU1JVF9TQ0xLOwotCQkJb2Q4X3NldHRp
bmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfRkFOX0FDT1VTVElDX0xJTUlUXS5k
ZWZhdWx0X3ZhbHVlID0KLQkJCQlvZF90YWJsZS0+RmFuTWF4aW11bVJwbTsKLQkJfQotCi0JCWlm
IChvZDhfc2V0dGluZ3MtPm9kX2ZlYXR1cmVfY2FwYWJpbGl0aWVzW0FUT01fVkVHQTIwX09ERkVB
VFVSRV9GQU5fU1BFRURfTUlOXSAmJgotCQkgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19t
aW5bT0Q4X1NFVFRJTkdfRkFOX01JTl9TUEVFRF0gPiAwICYmCi0JCSAgICBvZDhfc2V0dGluZ3Mt
Pm9kX3NldHRpbmdzX21heFtPRDhfU0VUVElOR19GQU5fTUlOX1NQRUVEXSA+IDAgJiYKLQkJICAg
IChvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21heFtPRDhfU0VUVElOR19GQU5fTUlOX1NQRUVE
XSA+PQotCQkgICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX0ZB
Tl9NSU5fU1BFRURdKSkgewotCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4
X1NFVFRJTkdfRkFOX01JTl9TUEVFRF0uZmVhdHVyZV9pZCA9Ci0JCQkJT0Q4X0ZBTl9TUEVFRF9N
SU47Ci0JCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19GQU5f
TUlOX1NQRUVEXS5kZWZhdWx0X3ZhbHVlID0KLQkJCQlvZF90YWJsZS0+RmFuTWluaW11bVB3bSAq
IHNtY19wcHRhYmxlLT5GYW5NYXhpbXVtUnBtIC8gMTAwOwotCQl9Ci0JfQotCi0JaWYgKHNtdV9m
ZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9USEVSTUFMX0JJVCkpIHsKLQkJaWYg
KG9kOF9zZXR0aW5ncy0+b2RfZmVhdHVyZV9jYXBhYmlsaXRpZXNbQVRPTV9WRUdBMjBfT0RGRUFU
VVJFX1RFTVBFUkFUVVJFX0ZBTl0gJiYKLQkJICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3Nf
bWluW09EOF9TRVRUSU5HX0ZBTl9UQVJHRVRfVEVNUF0gPiAwICYmCi0JCSAgICBvZDhfc2V0dGlu
Z3MtPm9kX3NldHRpbmdzX21heFtPRDhfU0VUVElOR19GQU5fVEFSR0VUX1RFTVBdID4gMCAmJgot
CQkgICAgKG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWF4W09EOF9TRVRUSU5HX0ZBTl9UQVJH
RVRfVEVNUF0gPj0KLQkJICAgICBvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbltPRDhfU0VU
VElOR19GQU5fVEFSR0VUX1RFTVBdKSkgewotCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3Nf
YXJyYXlbT0Q4X1NFVFRJTkdfRkFOX1RBUkdFVF9URU1QXS5mZWF0dXJlX2lkID0KLQkJCQlPRDhf
VEVNUEVSQVRVUkVfRkFOOwotCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4
X1NFVFRJTkdfRkFOX1RBUkdFVF9URU1QXS5kZWZhdWx0X3ZhbHVlID0KLQkJCQlvZF90YWJsZS0+
RmFuVGFyZ2V0VGVtcGVyYXR1cmU7Ci0JCX0KLQotCQlpZiAob2Q4X3NldHRpbmdzLT5vZF9mZWF0
dXJlX2NhcGFiaWxpdGllc1tBVE9NX1ZFR0EyMF9PREZFQVRVUkVfVEVNUEVSQVRVUkVfU1lTVEVN
XSAmJgotCQkgICAgb2Q4X3NldHRpbmdzLT5vZF9zZXR0aW5nc19taW5bT0Q4X1NFVFRJTkdfT1BF
UkFUSU5HX1RFTVBfTUFYXSA+IDAgJiYKLQkJICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3Nf
bWF4W09EOF9TRVRUSU5HX09QRVJBVElOR19URU1QX01BWF0gPiAwICYmCi0JCSAgICAob2Q4X3Nl
dHRpbmdzLT5vZF9zZXR0aW5nc19tYXhbT0Q4X1NFVFRJTkdfT1BFUkFUSU5HX1RFTVBfTUFYXSA+
PQotCQkgICAgIG9kOF9zZXR0aW5ncy0+b2Rfc2V0dGluZ3NfbWluW09EOF9TRVRUSU5HX09QRVJB
VElOR19URU1QX01BWF0pKSB7Ci0JCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtP
RDhfU0VUVElOR19PUEVSQVRJTkdfVEVNUF9NQVhdLmZlYXR1cmVfaWQgPQotCQkJCU9EOF9URU1Q
RVJBVFVSRV9TWVNURU07Ci0JCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhf
U0VUVElOR19PUEVSQVRJTkdfVEVNUF9NQVhdLmRlZmF1bHRfdmFsdWUgPQotCQkJCW9kX3RhYmxl
LT5NYXhPcFRlbXA7Ci0JCX0KLQl9Ci0KLQlmb3IgKGkgPSAwOyBpIDwgT0Q4X1NFVFRJTkdfQ09V
TlQ7IGkrKykgewotCQlpZiAob2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbaV0uZmVh
dHVyZV9pZCkgewotCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbaV0ubWluX3Zh
bHVlID0KLQkJCQlvZDhfc2V0dGluZ3MtPm9kX3NldHRpbmdzX21pbltpXTsKLQkJCW9kOF9zZXR0
aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W2ldLm1heF92YWx1ZSA9Ci0JCQkJb2Q4X3NldHRpbmdz
LT5vZF9zZXR0aW5nc19tYXhbaV07Ci0JCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJh
eVtpXS5jdXJyZW50X3ZhbHVlID0KLQkJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJh
eVtpXS5kZWZhdWx0X3ZhbHVlOwotCQl9IGVsc2UgewotCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0
dGluZ3NfYXJyYXlbaV0ubWluX3ZhbHVlID0gMDsKLQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRp
bmdzX2FycmF5W2ldLm1heF92YWx1ZSA9IDA7Ci0JCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5n
c19hcnJheVtpXS5jdXJyZW50X3ZhbHVlID0gMDsKLQkJfQotCX0KLQotCXJldHVybiAwOwotfQot
Ci1zdGF0aWMgaW50IHZlZ2EyMF9nZXRfbWV0cmljc190YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSwKLQkJCQkgICAgU211TWV0cmljc190ICptZXRyaWNzX3RhYmxlKQotewotCXN0cnVjdCBz
bXVfdGFibGVfY29udGV4dCAqc211X3RhYmxlPSAmc211LT5zbXVfdGFibGU7Ci0JaW50IHJldCA9
IDA7Ci0KLQlpZiAoIXNtdV90YWJsZS0+bWV0cmljc190aW1lIHx8IHRpbWVfYWZ0ZXIoamlmZmll
cywgc211X3RhYmxlLT5tZXRyaWNzX3RpbWUgKyBIWiAvIDEwMDApKSB7Ci0JCXJldCA9IHNtdV91
cGRhdGVfdGFibGUoc211LCBTTVVfVEFCTEVfU01VX01FVFJJQ1MsCi0JCQkJKHZvaWQgKilzbXVf
dGFibGUtPm1ldHJpY3NfdGFibGUsIGZhbHNlKTsKLQkJaWYgKHJldCkgewotCQkJcHJfaW5mbygi
RmFpbGVkIHRvIGV4cG9ydCBTTVUgbWV0cmljcyB0YWJsZSFcbiIpOwotCQkJcmV0dXJuIHJldDsK
LQkJfQotCQlzbXVfdGFibGUtPm1ldHJpY3NfdGltZSA9IGppZmZpZXM7Ci0JfQotCi0JbWVtY3B5
KG1ldHJpY3NfdGFibGUsIHNtdV90YWJsZS0+bWV0cmljc190YWJsZSwgc2l6ZW9mKFNtdU1ldHJp
Y3NfdCkpOwotCi0JcmV0dXJuIHJldDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfc2V0X2RlZmF1
bHRfb2Rfc2V0dGluZ3Moc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCi0JCQkJCSAgYm9vbCBpbml0
aWFsaXplKQotewotCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFibGVfY29udGV4dCA9ICZz
bXUtPnNtdV90YWJsZTsKLQlpbnQgcmV0OwotCi0JaWYgKGluaXRpYWxpemUpIHsKLQkJaWYgKHRh
YmxlX2NvbnRleHQtPm92ZXJkcml2ZV90YWJsZSkKLQkJCXJldHVybiAtRUlOVkFMOwotCi0JCXRh
YmxlX2NvbnRleHQtPm92ZXJkcml2ZV90YWJsZSA9IGt6YWxsb2Moc2l6ZW9mKE92ZXJEcml2ZVRh
YmxlX3QpLCBHRlBfS0VSTkVMKTsKLQotCQlpZiAoIXRhYmxlX2NvbnRleHQtPm92ZXJkcml2ZV90
YWJsZSkKLQkJCXJldHVybiAtRU5PTUVNOwotCi0JCXJldCA9IHNtdV91cGRhdGVfdGFibGUoc211
LCBTTVVfVEFCTEVfT1ZFUkRSSVZFLAotCQkJCSAgICAgICB0YWJsZV9jb250ZXh0LT5vdmVyZHJp
dmVfdGFibGUsIGZhbHNlKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJGYWlsZWQgdG8gZXhw
b3J0IG92ZXIgZHJpdmUgdGFibGUhXG4iKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KLQotCQlyZXQg
PSB2ZWdhMjBfc2V0X2RlZmF1bHRfb2Q4X3NldHR0aW5ncyhzbXUpOwotCQlpZiAocmV0KQotCQkJ
cmV0dXJuIHJldDsKLQl9Ci0KLQlyZXQgPSBzbXVfdXBkYXRlX3RhYmxlKHNtdSwgU01VX1RBQkxF
X09WRVJEUklWRSwKLQkJCSAgICAgICB0YWJsZV9jb250ZXh0LT5vdmVyZHJpdmVfdGFibGUsIHRy
dWUpOwotCWlmIChyZXQpIHsKLQkJcHJfZXJyKCJGYWlsZWQgdG8gaW1wb3J0IG92ZXIgZHJpdmUg
dGFibGUhXG4iKTsKLQkJcmV0dXJuIHJldDsKLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGlj
IGludCB2ZWdhMjBfZ2V0X29kX3BlcmNlbnRhZ2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCi0J
CQkJICAgIGVudW0gc211X2Nsa190eXBlIGNsa190eXBlKQotewotCXN0cnVjdCBzbXVfZHBtX2Nv
bnRleHQgKnNtdV9kcG0gPSAmc211LT5zbXVfZHBtOwotCXN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxl
ICpkcG1fdGFibGUgPSBOVUxMOwotCXN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICpnb2xkZW5fdGFi
bGUgPSBOVUxMOwotCXN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAqc2luZ2xlX2RwbV90
YWJsZTsKLQlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgKmdvbGRlbl9kcG1fdGFibGU7
Ci0JaW50IHZhbHVlLCBnb2xkZW5fdmFsdWU7Ci0KLQlkcG1fdGFibGUgPSBzbXVfZHBtLT5kcG1f
Y29udGV4dDsKLQlnb2xkZW5fdGFibGUgPSBzbXVfZHBtLT5nb2xkZW5fZHBtX2NvbnRleHQ7Ci0K
LQlzd2l0Y2ggKGNsa190eXBlKSB7Ci0JY2FzZSBTTVVfT0RfU0NMSzoKLQkJc2luZ2xlX2RwbV90
YWJsZSA9ICYoZHBtX3RhYmxlLT5nZnhfdGFibGUpOwotCQlnb2xkZW5fZHBtX3RhYmxlID0gJihn
b2xkZW5fdGFibGUtPmdmeF90YWJsZSk7Ci0JCWJyZWFrOwotCWNhc2UgU01VX09EX01DTEs6Ci0J
CXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+bWVtX3RhYmxlKTsKLQkJZ29sZGVuX2Rw
bV90YWJsZSA9ICYoZ29sZGVuX3RhYmxlLT5tZW1fdGFibGUpOwotCQlicmVhazsKLQlkZWZhdWx0
OgotCQlyZXR1cm4gLUVJTlZBTDsKLQkJYnJlYWs7Ci0JfQotCi0JdmFsdWUgPSBzaW5nbGVfZHBt
X3RhYmxlLT5kcG1fbGV2ZWxzW3NpbmdsZV9kcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7Ci0J
Z29sZGVuX3ZhbHVlID0gZ29sZGVuX2RwbV90YWJsZS0+ZHBtX2xldmVsc1tnb2xkZW5fZHBtX3Rh
YmxlLT5jb3VudCAtIDFdLnZhbHVlOwotCi0JdmFsdWUgLT0gZ29sZGVuX3ZhbHVlOwotCXZhbHVl
ID0gRElWX1JPVU5EX1VQKHZhbHVlICogMTAwLCBnb2xkZW5fdmFsdWUpOwotCi0JcmV0dXJuIHZh
bHVlOwotfQotCi1zdGF0aWMgaW50IHZlZ2EyMF9nZXRfcG93ZXJfcHJvZmlsZV9tb2RlKHN0cnVj
dCBzbXVfY29udGV4dCAqc211LCBjaGFyICpidWYpCi17Ci0JRHBtQWN0aXZpdHlNb25pdG9yQ29l
ZmZJbnRfdCBhY3Rpdml0eV9tb25pdG9yOwotCXVpbnQzMl90IGksIHNpemUgPSAwOwotCXVpbnQx
Nl90IHdvcmtsb2FkX3R5cGUgPSAwOwotCXN0YXRpYyBjb25zdCBjaGFyICpwcm9maWxlX25hbWVb
XSA9IHsKLQkJCQkJIkJPT1RVUF9ERUZBVUxUIiwKLQkJCQkJIjNEX0ZVTExfU0NSRUVOIiwKLQkJ
CQkJIlBPV0VSX1NBVklORyIsCi0JCQkJCSJWSURFTyIsCi0JCQkJCSJWUiIsCi0JCQkJCSJDT01Q
VVRFIiwKLQkJCQkJIkNVU1RPTSJ9OwotCXN0YXRpYyBjb25zdCBjaGFyICp0aXRsZVtdID0gewot
CQkJIlBST0ZJTEVfSU5ERVgoTkFNRSkiLAotCQkJIkNMT0NLX1RZUEUoTkFNRSkiLAotCQkJIkZQ
UyIsCi0JCQkiVXNlUmxjQnVzeSIsCi0JCQkiTWluQWN0aXZlRnJlcVR5cGUiLAotCQkJIk1pbkFj
dGl2ZUZyZXEiLAotCQkJIkJvb3N0ZXJGcmVxVHlwZSIsCi0JCQkiQm9vc3RlckZyZXEiLAotCQkJ
IlBEX0RhdGFfbGltaXRfYyIsCi0JCQkiUERfRGF0YV9lcnJvcl9jb2VmZiIsCi0JCQkiUERfRGF0
YV9lcnJvcl9yYXRlX2NvZWZmIn07Ci0JaW50IHJlc3VsdCA9IDA7Ci0KLQlpZiAoIXNtdS0+cG1f
ZW5hYmxlZCB8fCAhYnVmKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCXNpemUgKz0gc3ByaW50Zihi
dWYgKyBzaXplLCAiJTE2cyAlcyAlcyAlcyAlcyAlcyAlcyAlcyAlcyAlcyAlc1xuIiwKLQkJCXRp
dGxlWzBdLCB0aXRsZVsxXSwgdGl0bGVbMl0sIHRpdGxlWzNdLCB0aXRsZVs0XSwgdGl0bGVbNV0s
Ci0JCQl0aXRsZVs2XSwgdGl0bGVbN10sIHRpdGxlWzhdLCB0aXRsZVs5XSwgdGl0bGVbMTBdKTsK
LQotCWZvciAoaSA9IDA7IGkgPD0gUFBfU01DX1BPV0VSX1BST0ZJTEVfQ1VTVE9NOyBpKyspIHsK
LQkJLyogY29udiBQUF9TTUNfUE9XRVJfUFJPRklMRSogdG8gV09SS0xPQURfUFBMSUJfKl9CSVQg
Ki8KLQkJd29ya2xvYWRfdHlwZSA9IHNtdV93b3JrbG9hZF9nZXRfdHlwZShzbXUsIGkpOwotCQly
ZXN1bHQgPSBzbXVfdXBkYXRlX3RhYmxlKHNtdSwKLQkJCQkJICBTTVVfVEFCTEVfQUNUSVZJVFlf
TU9OSVRPUl9DT0VGRiB8IHdvcmtsb2FkX3R5cGUgPDwgMTYsCi0JCQkJCSAgKHZvaWQgKikoJmFj
dGl2aXR5X21vbml0b3IpLCBmYWxzZSk7Ci0JCWlmIChyZXN1bHQpIHsKLQkJCXByX2VycigiWyVz
XSBGYWlsZWQgdG8gZ2V0IGFjdGl2aXR5IG1vbml0b3IhIiwgX19mdW5jX18pOwotCQkJcmV0dXJu
IHJlc3VsdDsKLQkJfQotCi0JCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiJTJkICUxNHMl
czpcbiIsCi0JCQlpLCBwcm9maWxlX25hbWVbaV0sIChpID09IHNtdS0+cG93ZXJfcHJvZmlsZV9t
b2RlKSA/ICIqIiA6ICIgIik7Ci0KLQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIlMTlz
ICVkKCUxM3MpICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkXG4iLAotCQkJIiAi
LAotCQkJMCwKLQkJCSJHRlhDTEsiLAotCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfRlBTLAotCQkJ
YWN0aXZpdHlfbW9uaXRvci5HZnhfVXNlUmxjQnVzeSwKLQkJCWFjdGl2aXR5X21vbml0b3IuR2Z4
X01pbkFjdGl2ZUZyZXFUeXBlLAotCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfTWluQWN0aXZlRnJl
cSwKLQkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X0Jvb3N0ZXJGcmVxVHlwZSwKLQkJCWFjdGl2aXR5
X21vbml0b3IuR2Z4X0Jvb3N0ZXJGcmVxLAotCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfUERfRGF0
YV9saW1pdF9jLAotCQkJYWN0aXZpdHlfbW9uaXRvci5HZnhfUERfRGF0YV9lcnJvcl9jb2VmZiwK
LQkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X1BEX0RhdGFfZXJyb3JfcmF0ZV9jb2VmZik7Ci0KLQkJ
c2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNpemUsICIlMTlzICVkKCUxM3MpICU3ZCAlN2QgJTdkICU3
ZCAlN2QgJTdkICU3ZCAlN2QgJTdkXG4iLAotCQkJIiAiLAotCQkJMSwKLQkJCSJTT0NDTEsiLAot
CQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfRlBTLAotCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfVXNl
UmxjQnVzeSwKLQkJCWFjdGl2aXR5X21vbml0b3IuU29jX01pbkFjdGl2ZUZyZXFUeXBlLAotCQkJ
YWN0aXZpdHlfbW9uaXRvci5Tb2NfTWluQWN0aXZlRnJlcSwKLQkJCWFjdGl2aXR5X21vbml0b3Iu
U29jX0Jvb3N0ZXJGcmVxVHlwZSwKLQkJCWFjdGl2aXR5X21vbml0b3IuU29jX0Jvb3N0ZXJGcmVx
LAotCQkJYWN0aXZpdHlfbW9uaXRvci5Tb2NfUERfRGF0YV9saW1pdF9jLAotCQkJYWN0aXZpdHlf
bW9uaXRvci5Tb2NfUERfRGF0YV9lcnJvcl9jb2VmZiwKLQkJCWFjdGl2aXR5X21vbml0b3IuU29j
X1BEX0RhdGFfZXJyb3JfcmF0ZV9jb2VmZik7Ci0KLQkJc2l6ZSArPSBzcHJpbnRmKGJ1ZiArIHNp
emUsICIlMTlzICVkKCUxM3MpICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkXG4i
LAotCQkJIiAiLAotCQkJMiwKLQkJCSJVQ0xLIiwKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX0ZQ
UywKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX1VzZVJsY0J1c3ksCi0JCQlhY3Rpdml0eV9tb25p
dG9yLk1lbV9NaW5BY3RpdmVGcmVxVHlwZSwKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX01pbkFj
dGl2ZUZyZXEsCi0JCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9Cb29zdGVyRnJlcVR5cGUsCi0JCQlh
Y3Rpdml0eV9tb25pdG9yLk1lbV9Cb29zdGVyRnJlcSwKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVt
X1BEX0RhdGFfbGltaXRfYywKLQkJCWFjdGl2aXR5X21vbml0b3IuTWVtX1BEX0RhdGFfZXJyb3Jf
Y29lZmYsCi0JCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9QRF9EYXRhX2Vycm9yX3JhdGVfY29lZmYp
OwotCi0JCXNpemUgKz0gc3ByaW50ZihidWYgKyBzaXplLCAiJTE5cyAlZCglMTNzKSAlN2QgJTdk
ICU3ZCAlN2QgJTdkICU3ZCAlN2QgJTdkICU3ZFxuIiwKLQkJCSIgIiwKLQkJCTMsCi0JCQkiRkNM
SyIsCi0JCQlhY3Rpdml0eV9tb25pdG9yLkZjbGtfRlBTLAotCQkJYWN0aXZpdHlfbW9uaXRvci5G
Y2xrX1VzZVJsY0J1c3ksCi0JCQlhY3Rpdml0eV9tb25pdG9yLkZjbGtfTWluQWN0aXZlRnJlcVR5
cGUsCi0JCQlhY3Rpdml0eV9tb25pdG9yLkZjbGtfTWluQWN0aXZlRnJlcSwKLQkJCWFjdGl2aXR5
X21vbml0b3IuRmNsa19Cb29zdGVyRnJlcVR5cGUsCi0JCQlhY3Rpdml0eV9tb25pdG9yLkZjbGtf
Qm9vc3RlckZyZXEsCi0JCQlhY3Rpdml0eV9tb25pdG9yLkZjbGtfUERfRGF0YV9saW1pdF9jLAot
CQkJYWN0aXZpdHlfbW9uaXRvci5GY2xrX1BEX0RhdGFfZXJyb3JfY29lZmYsCi0JCQlhY3Rpdml0
eV9tb25pdG9yLkZjbGtfUERfRGF0YV9lcnJvcl9yYXRlX2NvZWZmKTsKLQl9Ci0KLQlyZXR1cm4g
c2l6ZTsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfc2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSwgbG9uZyAqaW5wdXQsIHVpbnQzMl90IHNpemUpCi17Ci0JRHBt
QWN0aXZpdHlNb25pdG9yQ29lZmZJbnRfdCBhY3Rpdml0eV9tb25pdG9yOwotCWludCB3b3JrbG9h
ZF90eXBlID0gMCwgcmV0ID0gMDsKLQotCXNtdS0+cG93ZXJfcHJvZmlsZV9tb2RlID0gaW5wdXRb
c2l6ZV07Ci0KLQlpZiAoIXNtdS0+cG1fZW5hYmxlZCkKLQkJcmV0dXJuIHJldDsKLQlpZiAoc211
LT5wb3dlcl9wcm9maWxlX21vZGUgPiBQUF9TTUNfUE9XRVJfUFJPRklMRV9DVVNUT00pIHsKLQkJ
cHJfZXJyKCJJbnZhbGlkIHBvd2VyIHByb2ZpbGUgbW9kZSAlZFxuIiwgc211LT5wb3dlcl9wcm9m
aWxlX21vZGUpOwotCQlyZXR1cm4gLUVJTlZBTDsKLQl9Ci0KLQlpZiAoc211LT5wb3dlcl9wcm9m
aWxlX21vZGUgPT0gUFBfU01DX1BPV0VSX1BST0ZJTEVfQ1VTVE9NKSB7Ci0JCXJldCA9IHNtdV91
cGRhdGVfdGFibGUoc211LAotCQkJCSAgICAgICBTTVVfVEFCTEVfQUNUSVZJVFlfTU9OSVRPUl9D
T0VGRiB8IFdPUktMT0FEX1BQTElCX0NVU1RPTV9CSVQgPDwgMTYsCi0JCQkJICAgICAgICh2b2lk
ICopKCZhY3Rpdml0eV9tb25pdG9yKSwgZmFsc2UpOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIo
Ilslc10gRmFpbGVkIHRvIGdldCBhY3Rpdml0eSBtb25pdG9yISIsIF9fZnVuY19fKTsKLQkJCXJl
dHVybiByZXQ7Ci0JCX0KLQotCQlzd2l0Y2ggKGlucHV0WzBdKSB7Ci0JCWNhc2UgMDogLyogR2Z4
Y2xrICovCi0JCQlhY3Rpdml0eV9tb25pdG9yLkdmeF9GUFMgPSBpbnB1dFsxXTsKLQkJCWFjdGl2
aXR5X21vbml0b3IuR2Z4X1VzZVJsY0J1c3kgPSBpbnB1dFsyXTsKLQkJCWFjdGl2aXR5X21vbml0
b3IuR2Z4X01pbkFjdGl2ZUZyZXFUeXBlID0gaW5wdXRbM107Ci0JCQlhY3Rpdml0eV9tb25pdG9y
LkdmeF9NaW5BY3RpdmVGcmVxID0gaW5wdXRbNF07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLkdmeF9C
b29zdGVyRnJlcVR5cGUgPSBpbnB1dFs1XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X0Jvb3N0
ZXJGcmVxID0gaW5wdXRbNl07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLkdmeF9QRF9EYXRhX2xpbWl0
X2MgPSBpbnB1dFs3XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X1BEX0RhdGFfZXJyb3JfY29l
ZmYgPSBpbnB1dFs4XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuR2Z4X1BEX0RhdGFfZXJyb3JfcmF0
ZV9jb2VmZiA9IGlucHV0WzldOwotCQkJYnJlYWs7Ci0JCWNhc2UgMTogLyogU29jY2xrICovCi0J
CQlhY3Rpdml0eV9tb25pdG9yLlNvY19GUFMgPSBpbnB1dFsxXTsKLQkJCWFjdGl2aXR5X21vbml0
b3IuU29jX1VzZVJsY0J1c3kgPSBpbnB1dFsyXTsKLQkJCWFjdGl2aXR5X21vbml0b3IuU29jX01p
bkFjdGl2ZUZyZXFUeXBlID0gaW5wdXRbM107Ci0JCQlhY3Rpdml0eV9tb25pdG9yLlNvY19NaW5B
Y3RpdmVGcmVxID0gaW5wdXRbNF07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLlNvY19Cb29zdGVyRnJl
cVR5cGUgPSBpbnB1dFs1XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuU29jX0Jvb3N0ZXJGcmVxID0g
aW5wdXRbNl07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLlNvY19QRF9EYXRhX2xpbWl0X2MgPSBpbnB1
dFs3XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuU29jX1BEX0RhdGFfZXJyb3JfY29lZmYgPSBpbnB1
dFs4XTsKLQkJCWFjdGl2aXR5X21vbml0b3IuU29jX1BEX0RhdGFfZXJyb3JfcmF0ZV9jb2VmZiA9
IGlucHV0WzldOwotCQkJYnJlYWs7Ci0JCWNhc2UgMjogLyogVWNsayAqLwotCQkJYWN0aXZpdHlf
bW9uaXRvci5NZW1fRlBTID0gaW5wdXRbMV07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9Vc2VS
bGNCdXN5ID0gaW5wdXRbMl07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9NaW5BY3RpdmVGcmVx
VHlwZSA9IGlucHV0WzNdOwotCQkJYWN0aXZpdHlfbW9uaXRvci5NZW1fTWluQWN0aXZlRnJlcSA9
IGlucHV0WzRdOwotCQkJYWN0aXZpdHlfbW9uaXRvci5NZW1fQm9vc3RlckZyZXFUeXBlID0gaW5w
dXRbNV07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLk1lbV9Cb29zdGVyRnJlcSA9IGlucHV0WzZdOwot
CQkJYWN0aXZpdHlfbW9uaXRvci5NZW1fUERfRGF0YV9saW1pdF9jID0gaW5wdXRbN107Ci0JCQlh
Y3Rpdml0eV9tb25pdG9yLk1lbV9QRF9EYXRhX2Vycm9yX2NvZWZmID0gaW5wdXRbOF07Ci0JCQlh
Y3Rpdml0eV9tb25pdG9yLk1lbV9QRF9EYXRhX2Vycm9yX3JhdGVfY29lZmYgPSBpbnB1dFs5XTsK
LQkJCWJyZWFrOwotCQljYXNlIDM6IC8qIEZjbGsgKi8KLQkJCWFjdGl2aXR5X21vbml0b3IuRmNs
a19GUFMgPSBpbnB1dFsxXTsKLQkJCWFjdGl2aXR5X21vbml0b3IuRmNsa19Vc2VSbGNCdXN5ID0g
aW5wdXRbMl07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLkZjbGtfTWluQWN0aXZlRnJlcVR5cGUgPSBp
bnB1dFszXTsKLQkJCWFjdGl2aXR5X21vbml0b3IuRmNsa19NaW5BY3RpdmVGcmVxID0gaW5wdXRb
NF07Ci0JCQlhY3Rpdml0eV9tb25pdG9yLkZjbGtfQm9vc3RlckZyZXFUeXBlID0gaW5wdXRbNV07
Ci0JCQlhY3Rpdml0eV9tb25pdG9yLkZjbGtfQm9vc3RlckZyZXEgPSBpbnB1dFs2XTsKLQkJCWFj
dGl2aXR5X21vbml0b3IuRmNsa19QRF9EYXRhX2xpbWl0X2MgPSBpbnB1dFs3XTsKLQkJCWFjdGl2
aXR5X21vbml0b3IuRmNsa19QRF9EYXRhX2Vycm9yX2NvZWZmID0gaW5wdXRbOF07Ci0JCQlhY3Rp
dml0eV9tb25pdG9yLkZjbGtfUERfRGF0YV9lcnJvcl9yYXRlX2NvZWZmID0gaW5wdXRbOV07Ci0J
CQlicmVhazsKLQkJfQotCi0JCXJldCA9IHNtdV91cGRhdGVfdGFibGUoc211LAotCQkJCSAgICAg
ICBTTVVfVEFCTEVfQUNUSVZJVFlfTU9OSVRPUl9DT0VGRiB8IFdPUktMT0FEX1BQTElCX0NVU1RP
TV9CSVQgPDwgMTYsCi0JCQkJICAgICAgICh2b2lkICopKCZhY3Rpdml0eV9tb25pdG9yKSwgdHJ1
ZSk7Ci0JCWlmIChyZXQpIHsKLQkJCXByX2VycigiWyVzXSBGYWlsZWQgdG8gc2V0IGFjdGl2aXR5
IG1vbml0b3IhIiwgX19mdW5jX18pOwotCQkJcmV0dXJuIHJldDsKLQkJfQotCX0KLQotCS8qIGNv
bnYgUFBfU01DX1BPV0VSX1BST0ZJTEUqIHRvIFdPUktMT0FEX1BQTElCXypfQklUICovCi0Jd29y
a2xvYWRfdHlwZSA9IHNtdV93b3JrbG9hZF9nZXRfdHlwZShzbXUsIHNtdS0+cG93ZXJfcHJvZmls
ZV9tb2RlKTsKLQlzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LCBTTVVfTVNHX1NldFdv
cmtsb2FkTWFzaywKLQkJCQkgICAgMSA8PCB3b3JrbG9hZF90eXBlKTsKLQotCXJldHVybiByZXQ7
Ci19Ci0KLXN0YXRpYyBpbnQKLXZlZ2EyMF9nZXRfcHJvZmlsaW5nX2Nsa19tYXNrKHN0cnVjdCBz
bXVfY29udGV4dCAqc211LAotCQkJICAgICAgZW51bSBhbWRfZHBtX2ZvcmNlZF9sZXZlbCBsZXZl
bCwKLQkJCSAgICAgIHVpbnQzMl90ICpzY2xrX21hc2ssCi0JCQkgICAgICB1aW50MzJfdCAqbWNs
a19tYXNrLAotCQkJICAgICAgdWludDMyX3QgKnNvY19tYXNrKQotewotCXN0cnVjdCB2ZWdhMjBf
ZHBtX3RhYmxlICpkcG1fdGFibGUgPSAoc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKilzbXUtPnNt
dV9kcG0uZHBtX2NvbnRleHQ7Ci0Jc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICpnZnhf
ZHBtX3RhYmxlOwotCXN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAqbWVtX2RwbV90YWJs
ZTsKLQlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgKnNvY19kcG1fdGFibGU7Ci0KLQlp
ZiAoIXNtdS0+c211X2RwbS5kcG1fY29udGV4dCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlnZnhf
ZHBtX3RhYmxlID0gJmRwbV90YWJsZS0+Z2Z4X3RhYmxlOwotCW1lbV9kcG1fdGFibGUgPSAmZHBt
X3RhYmxlLT5tZW1fdGFibGU7Ci0Jc29jX2RwbV90YWJsZSA9ICZkcG1fdGFibGUtPnNvY190YWJs
ZTsKLQotCSpzY2xrX21hc2sgPSAwOwotCSptY2xrX21hc2sgPSAwOwotCSpzb2NfbWFzayAgPSAw
OwotCi0JaWYgKGdmeF9kcG1fdGFibGUtPmNvdW50ID4gVkVHQTIwX1VNRF9QU1RBVEVfR0ZYQ0xL
X0xFVkVMICYmCi0JICAgIG1lbV9kcG1fdGFibGUtPmNvdW50ID4gVkVHQTIwX1VNRF9QU1RBVEVf
TUNMS19MRVZFTCAmJgotCSAgICBzb2NfZHBtX3RhYmxlLT5jb3VudCA+IFZFR0EyMF9VTURfUFNU
QVRFX1NPQ0NMS19MRVZFTCkgewotCQkqc2Nsa19tYXNrID0gVkVHQTIwX1VNRF9QU1RBVEVfR0ZY
Q0xLX0xFVkVMOwotCQkqbWNsa19tYXNrID0gVkVHQTIwX1VNRF9QU1RBVEVfTUNMS19MRVZFTDsK
LQkJKnNvY19tYXNrICA9IFZFR0EyMF9VTURfUFNUQVRFX1NPQ0NMS19MRVZFTDsKLQl9Ci0KLQlp
ZiAobGV2ZWwgPT0gQU1EX0RQTV9GT1JDRURfTEVWRUxfUFJPRklMRV9NSU5fU0NMSykgewotCQkq
c2Nsa19tYXNrID0gMDsKLQl9IGVsc2UgaWYgKGxldmVsID09IEFNRF9EUE1fRk9SQ0VEX0xFVkVM
X1BST0ZJTEVfTUlOX01DTEspIHsKLQkJKm1jbGtfbWFzayA9IDA7Ci0JfSBlbHNlIGlmIChsZXZl
bCA9PSBBTURfRFBNX0ZPUkNFRF9MRVZFTF9QUk9GSUxFX1BFQUspIHsKLQkJKnNjbGtfbWFzayA9
IGdmeF9kcG1fdGFibGUtPmNvdW50IC0gMTsKLQkJKm1jbGtfbWFzayA9IG1lbV9kcG1fdGFibGUt
PmNvdW50IC0gMTsKLQkJKnNvY19tYXNrICA9IHNvY19kcG1fdGFibGUtPmNvdW50IC0gMTsKLQl9
Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludAotdmVnYTIwX3NldF91Y2xrX3RvX2hpZ2hl
c3RfZHBtX2xldmVsKHN0cnVjdCBzbXVfY29udGV4dCAqc211LAotCQkJCSAgICAgc3RydWN0IHZl
Z2EyMF9zaW5nbGVfZHBtX3RhYmxlICpkcG1fdGFibGUpCi17Ci0JaW50IHJldCA9IDA7Ci0Jc3Ry
dWN0IHNtdV9kcG1fY29udGV4dCAqc211X2RwbV9jdHggPSAmKHNtdS0+c211X2RwbSk7Ci0JaWYg
KCFzbXVfZHBtX2N0eC0+ZHBtX2NvbnRleHQpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JaWYgKHNt
dV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVUNMS19CSVQpKSB7Ci0J
CWlmIChkcG1fdGFibGUtPmNvdW50IDw9IDApIHsKLQkJCXByX2VycigiWyVzXSBEcG0gdGFibGUg
aGFzIG5vIGVudHJ5ISIsIF9fZnVuY19fKTsKLQkJCQlyZXR1cm4gLUVJTlZBTDsKLQkJfQotCi0J
CWlmIChkcG1fdGFibGUtPmNvdW50ID4gTlVNX1VDTEtfRFBNX0xFVkVMUykgewotCQkJcHJfZXJy
KCJbJXNdIERwbSB0YWJsZSBoYXMgdG9vIG1hbnkgZW50cmllcyEiLCBfX2Z1bmNfXyk7Ci0JCQkJ
cmV0dXJuIC1FSU5WQUw7Ci0JCX0KLQotCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5oYXJkX21pbl9s
ZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7
Ci0JCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsCi0JCQkJU01VX01TR19T
ZXRIYXJkTWluQnlGcmVxLAotCQkJCShQUENMS19VQ0xLIDw8IDE2KSB8IGRwbV90YWJsZS0+ZHBt
X3N0YXRlLmhhcmRfbWluX2xldmVsKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJbJXNdIFNl
dCBoYXJkIG1pbiB1Y2xrIGZhaWxlZCEiLCBfX2Z1bmNfXyk7Ci0JCQkJcmV0dXJuIHJldDsKLQkJ
fQotCX0KLQotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRpYyBpbnQgdmVnYTIwX3ByZV9kaXNwbGF5
X2NvbmZpZ19jaGFuZ2VkKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQotewotCWludCByZXQgPSAw
OwotCXN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICpkcG1fdGFibGUgPSBzbXUtPnNtdV9kcG0uZHBt
X2NvbnRleHQ7Ci0KLQlpZiAoIXNtdS0+c211X2RwbS5kcG1fY29udGV4dCkKLQkJcmV0dXJuIC1F
SU5WQUw7Ci0KLQlzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LCBTTVVfTVNHX051bU9m
RGlzcGxheXMsIDApOwotCXJldCA9IHZlZ2EyMF9zZXRfdWNsa190b19oaWdoZXN0X2RwbV9sZXZl
bChzbXUsCi0JCQkJCQkgICAmZHBtX3RhYmxlLT5tZW1fdGFibGUpOwotCWlmIChyZXQpCi0JCXBy
X2VycigiRmFpbGVkIHRvIHNldCB1Y2xrIHRvIGhpZ2hlc3QgZHBtIGxldmVsIik7Ci0JcmV0dXJu
IHJldDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfZGlzcGxheV9jb25maWdfY2hhbmdlZChzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSkKLXsKLQlpbnQgcmV0ID0gMDsKLQotCWlmICgoc211LT53YXRl
cm1hcmtzX2JpdG1hcCAmIFdBVEVSTUFSS1NfRVhJU1QpICYmCi0JICAgICEoc211LT53YXRlcm1h
cmtzX2JpdG1hcCAmIFdBVEVSTUFSS1NfTE9BREVEKSkgewotCQlyZXQgPSBzbXVfd3JpdGVfd2F0
ZXJtYXJrc190YWJsZShzbXUpOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIoIkZhaWxlZCB0byB1
cGRhdGUgV01UQUJMRSEiKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KLQkJc211LT53YXRlcm1hcmtz
X2JpdG1hcCB8PSBXQVRFUk1BUktTX0xPQURFRDsKLQl9Ci0KLQlpZiAoKHNtdS0+d2F0ZXJtYXJr
c19iaXRtYXAgJiBXQVRFUk1BUktTX0VYSVNUKSAmJgotCSAgICBzbXVfZmVhdHVyZV9pc19zdXBw
b3J0ZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fRENFRkNMS19CSVQpICYmCi0JICAgIHNtdV9mZWF0
dXJlX2lzX3N1cHBvcnRlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9TT0NDTEtfQklUKSkgewotCQlz
bXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LAotCQkJCQkgICAgU01VX01TR19OdW1PZkRp
c3BsYXlzLAotCQkJCQkgICAgc211LT5kaXNwbGF5X2NvbmZpZy0+bnVtX2Rpc3BsYXkpOwotCX0K
LQotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRpYyBpbnQgdmVnYTIwX2FwcGx5X2Nsb2Nrc19hZGp1
c3RfcnVsZXMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCi17Ci0Jc3RydWN0IHNtdV9kcG1fY29u
dGV4dCAqc211X2RwbV9jdHggPSAmKHNtdS0+c211X2RwbSk7Ci0Jc3RydWN0IHZlZ2EyMF9kcG1f
dGFibGUgKmRwbV9jdHggPSAoc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgKikoc211X2RwbV9jdHgt
PmRwbV9jb250ZXh0KTsKLQlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgKmRwbV90YWJs
ZTsKLQlib29sIHZibGFua190b29fc2hvcnQgPSBmYWxzZTsKLQlib29sIGRpc2FibGVfbWNsa19z
d2l0Y2hpbmc7Ci0JdWludDMyX3QgaSwgbGF0ZW5jeTsKLQotCWRpc2FibGVfbWNsa19zd2l0Y2hp
bmcgPSAoKDEgPCBzbXUtPmRpc3BsYXlfY29uZmlnLT5udW1fZGlzcGxheSkgJiYKLQkJCQkgICFz
bXUtPmRpc3BsYXlfY29uZmlnLT5tdWx0aV9tb25pdG9yX2luX3N5bmMpIHx8IHZibGFua190b29f
c2hvcnQ7Ci0JbGF0ZW5jeSA9IHNtdS0+ZGlzcGxheV9jb25maWctPmRjZV90b2xlcmFibGVfbWNs
a19pbl9hY3RpdmVfbGF0ZW5jeTsKLQotCS8qIGdmeGNsayAqLwotCWRwbV90YWJsZSA9ICYoZHBt
X2N0eC0+Z2Z4X3RhYmxlKTsKLQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9
IGRwbV90YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1ZTsKLQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5z
b2Z0X21heF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0g
MV0udmFsdWU7Ci0JZHBtX3RhYmxlLT5kcG1fc3RhdGUuaGFyZF9taW5fbGV2ZWwgPSBkcG1fdGFi
bGUtPmRwbV9sZXZlbHNbMF0udmFsdWU7Ci0JZHBtX3RhYmxlLT5kcG1fc3RhdGUuaGFyZF9tYXhf
bGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVl
OwotCi0JCWlmIChWRUdBMjBfVU1EX1BTVEFURV9HRlhDTEtfTEVWRUwgPCBkcG1fdGFibGUtPmNv
dW50KSB7Ci0JCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJs
ZS0+ZHBtX2xldmVsc1tWRUdBMjBfVU1EX1BTVEFURV9HRlhDTEtfTEVWRUxdLnZhbHVlOwotCQkJ
ZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZl
bHNbVkVHQTIwX1VNRF9QU1RBVEVfR0ZYQ0xLX0xFVkVMXS52YWx1ZTsKLQkJfQotCi0JCWlmIChz
bXVfZHBtX2N0eC0+ZHBtX2xldmVsID09IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVfTUlO
X1NDTEspIHsKLQkJCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBtX3Rh
YmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlOwotCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9t
YXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWU7Ci0JCX0KLQotCQlpZiAo
c211X2RwbV9jdHgtPmRwbV9sZXZlbCA9PSBBTURfRFBNX0ZPUkNFRF9MRVZFTF9QUk9GSUxFX1BF
QUspIHsKLQkJCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBtX3RhYmxl
LT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQgLSAxXS52YWx1ZTsKLQkJCWRwbV90YWJsZS0+
ZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJs
ZS0+Y291bnQgLSAxXS52YWx1ZTsKLQkJfQotCi0JLyogbWVtY2xrICovCi0JZHBtX3RhYmxlID0g
JihkcG1fY3R4LT5tZW1fdGFibGUpOwotCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xl
dmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlOwotCWRwbV90YWJsZS0+ZHBtX3N0
YXRlLnNvZnRfbWF4X2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291
bnQgLSAxXS52YWx1ZTsKLQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5oYXJkX21pbl9sZXZlbCA9IGRw
bV90YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1ZTsKLQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5oYXJk
X21heF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0u
dmFsdWU7Ci0KLQkJaWYgKFZFR0EyMF9VTURfUFNUQVRFX01DTEtfTEVWRUwgPCBkcG1fdGFibGUt
PmNvdW50KSB7Ci0JCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90
YWJsZS0+ZHBtX2xldmVsc1tWRUdBMjBfVU1EX1BTVEFURV9NQ0xLX0xFVkVMXS52YWx1ZTsKLQkJ
CWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2
ZWxzW1ZFR0EyMF9VTURfUFNUQVRFX01DTEtfTEVWRUxdLnZhbHVlOwotCQl9Ci0KLQkJaWYgKHNt
dV9kcG1fY3R4LT5kcG1fbGV2ZWwgPT0gQU1EX0RQTV9GT1JDRURfTEVWRUxfUFJPRklMRV9NSU5f
TUNMSykgewotCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFi
bGUtPmRwbV9sZXZlbHNbMF0udmFsdWU7Ci0JCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21h
eF9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1swXS52YWx1ZTsKLQkJfQotCi0JCWlmIChz
bXVfZHBtX2N0eC0+ZHBtX2xldmVsID09IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVfUEVB
SykgewotCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFibGUt
PmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOwotCQkJZHBtX3RhYmxlLT5k
cG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxl
LT5jb3VudCAtIDFdLnZhbHVlOwotCQl9Ci0KLQkvKiBob25vdXIgREFMJ3MgVUNMSyBIYXJkbWlu
ICovCi0JaWYgKGRwbV90YWJsZS0+ZHBtX3N0YXRlLmhhcmRfbWluX2xldmVsIDwgKHNtdS0+ZGlz
cGxheV9jb25maWctPm1pbl9tZW1fc2V0X2Nsb2NrIC8gMTAwKSkKLQkJZHBtX3RhYmxlLT5kcG1f
c3RhdGUuaGFyZF9taW5fbGV2ZWwgPSBzbXUtPmRpc3BsYXlfY29uZmlnLT5taW5fbWVtX3NldF9j
bG9jayAvIDEwMDsKLQotCS8qIEhhcmRtaW4gaXMgZGVwZW5kZW50IG9uIGRpc3BsYXljb25maWcg
Ki8KLQlpZiAoZGlzYWJsZV9tY2xrX3N3aXRjaGluZykgewotCQlkcG1fdGFibGUtPmRwbV9zdGF0
ZS5oYXJkX21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50
IC0gMV0udmFsdWU7Ci0JCWZvciAoaSA9IDA7IGkgPCBzbXVfZHBtX2N0eC0+bWNsa19sYXRlbmN5
X3RhYmxlLT5jb3VudCAtIDE7IGkrKykgewotCQkJaWYgKHNtdV9kcG1fY3R4LT5tY2xrX2xhdGVu
Y3lfdGFibGUtPmVudHJpZXNbaV0ubGF0ZW5jeSA8PSBsYXRlbmN5KSB7Ci0JCQkJaWYgKGRwbV90
YWJsZS0+ZHBtX2xldmVsc1tpXS52YWx1ZSA+PSAoc211LT5kaXNwbGF5X2NvbmZpZy0+bWluX21l
bV9zZXRfY2xvY2sgLyAxMDApKSB7Ci0JCQkJCWRwbV90YWJsZS0+ZHBtX3N0YXRlLmhhcmRfbWlu
X2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2ldLnZhbHVlOwotCQkJCQlicmVhazsKLQkJ
CQl9Ci0JCQl9Ci0JCX0KLQl9Ci0KLQlpZiAoc211LT5kaXNwbGF5X2NvbmZpZy0+bmJfcHN0YXRl
X3N3aXRjaF9kaXNhYmxlKQotCQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5oYXJkX21pbl9sZXZlbCA9
IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7Ci0KLQkv
KiB2Y2xrICovCi0JZHBtX3RhYmxlID0gJihkcG1fY3R4LT52Y2xrX3RhYmxlKTsKLQlkcG1fdGFi
bGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1swXS52
YWx1ZTsKLQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9IGRwbV90YWJsZS0+
ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7Ci0JZHBtX3RhYmxlLT5kcG1f
c3RhdGUuaGFyZF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWU7Ci0J
ZHBtX3RhYmxlLT5kcG1fc3RhdGUuaGFyZF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZl
bHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOwotCi0JCWlmIChWRUdBMjBfVU1EX1BTVEFU
RV9VVkRDTEtfTEVWRUwgPCBkcG1fdGFibGUtPmNvdW50KSB7Ci0JCQlkcG1fdGFibGUtPmRwbV9z
dGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tWRUdBMjBfVU1EX1BT
VEFURV9VVkRDTEtfTEVWRUxdLnZhbHVlOwotCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9t
YXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbVkVHQTIwX1VNRF9QU1RBVEVfVVZEQ0xL
X0xFVkVMXS52YWx1ZTsKLQkJfQotCi0JCWlmIChzbXVfZHBtX2N0eC0+ZHBtX2xldmVsID09IEFN
RF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVfUEVBSykgewotCQkJZHBtX3RhYmxlLT5kcG1fc3Rh
dGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3Vu
dCAtIDFdLnZhbHVlOwotCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgPSBk
cG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOwotCQl9Ci0K
LQkvKiBkY2xrICovCi0JZHBtX3RhYmxlID0gJihkcG1fY3R4LT5kY2xrX3RhYmxlKTsKLQlkcG1f
dGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1sw
XS52YWx1ZTsKLQlkcG1fdGFibGUtPmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9IGRwbV90YWJs
ZS0+ZHBtX2xldmVsc1tkcG1fdGFibGUtPmNvdW50IC0gMV0udmFsdWU7Ci0JZHBtX3RhYmxlLT5k
cG1fc3RhdGUuaGFyZF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbMF0udmFsdWU7
Ci0JZHBtX3RhYmxlLT5kcG1fc3RhdGUuaGFyZF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9s
ZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOwotCi0JCWlmIChWRUdBMjBfVU1EX1BT
VEFURV9VVkRDTEtfTEVWRUwgPCBkcG1fdGFibGUtPmNvdW50KSB7Ci0JCQlkcG1fdGFibGUtPmRw
bV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9IGRwbV90YWJsZS0+ZHBtX2xldmVsc1tWRUdBMjBfVU1E
X1BTVEFURV9VVkRDTEtfTEVWRUxdLnZhbHVlOwotCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29m
dF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbVkVHQTIwX1VNRF9QU1RBVEVfVVZE
Q0xLX0xFVkVMXS52YWx1ZTsKLQkJfQotCi0JCWlmIChzbXVfZHBtX2N0eC0+ZHBtX2xldmVsID09
IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX1BST0ZJTEVfUEVBSykgewotCQkJZHBtX3RhYmxlLT5kcG1f
c3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5j
b3VudCAtIDFdLnZhbHVlOwotCQkJZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwg
PSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOwotCQl9
Ci0KLQkvKiBzb2NjbGsgKi8KLQlkcG1fdGFibGUgPSAmKGRwbV9jdHgtPnNvY190YWJsZSk7Ci0J
ZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZl
bHNbMF0udmFsdWU7Ci0JZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgPSBkcG1f
dGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOwotCWRwbV90YWJs
ZS0+ZHBtX3N0YXRlLmhhcmRfbWluX2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZh
bHVlOwotCWRwbV90YWJsZS0+ZHBtX3N0YXRlLmhhcmRfbWF4X2xldmVsID0gZHBtX3RhYmxlLT5k
cG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQgLSAxXS52YWx1ZTsKLQotCQlpZiAoVkVHQTIwX1VN
RF9QU1RBVEVfU09DQ0xLX0xFVkVMIDwgZHBtX3RhYmxlLT5jb3VudCkgewotCQkJZHBtX3RhYmxl
LT5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbVkVHQTIw
X1VNRF9QU1RBVEVfU09DQ0xLX0xFVkVMXS52YWx1ZTsKLQkJCWRwbV90YWJsZS0+ZHBtX3N0YXRl
LnNvZnRfbWF4X2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW1ZFR0EyMF9VTURfUFNUQVRF
X1NPQ0NMS19MRVZFTF0udmFsdWU7Ci0JCX0KLQotCQlpZiAoc211X2RwbV9jdHgtPmRwbV9sZXZl
bCA9PSBBTURfRFBNX0ZPUkNFRF9MRVZFTF9QUk9GSUxFX1BFQUspIHsKLQkJCWRwbV90YWJsZS0+
ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJs
ZS0+Y291bnQgLSAxXS52YWx1ZTsKLQkJCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWF4X2xl
dmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQgLSAxXS52YWx1ZTsK
LQkJfQotCi0JLyogZWNsayAqLwotCWRwbV90YWJsZSA9ICYoZHBtX2N0eC0+ZWNsa190YWJsZSk7
Ci0JZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9s
ZXZlbHNbMF0udmFsdWU7Ci0JZHBtX3RhYmxlLT5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgPSBk
cG1fdGFibGUtPmRwbV9sZXZlbHNbZHBtX3RhYmxlLT5jb3VudCAtIDFdLnZhbHVlOwotCWRwbV90
YWJsZS0+ZHBtX3N0YXRlLmhhcmRfbWluX2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBd
LnZhbHVlOwotCWRwbV90YWJsZS0+ZHBtX3N0YXRlLmhhcmRfbWF4X2xldmVsID0gZHBtX3RhYmxl
LT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQgLSAxXS52YWx1ZTsKLQotCQlpZiAoVkVHQTIw
X1VNRF9QU1RBVEVfVkNFTUNMS19MRVZFTCA8IGRwbV90YWJsZS0+Y291bnQpIHsKLQkJCWRwbV90
YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW1ZF
R0EyMF9VTURfUFNUQVRFX1ZDRU1DTEtfTEVWRUxdLnZhbHVlOwotCQkJZHBtX3RhYmxlLT5kcG1f
c3RhdGUuc29mdF9tYXhfbGV2ZWwgPSBkcG1fdGFibGUtPmRwbV9sZXZlbHNbVkVHQTIwX1VNRF9Q
U1RBVEVfVkNFTUNMS19MRVZFTF0udmFsdWU7Ci0JCX0KLQotCQlpZiAoc211X2RwbV9jdHgtPmRw
bV9sZXZlbCA9PSBBTURfRFBNX0ZPUkNFRF9MRVZFTF9QUk9GSUxFX1BFQUspIHsKLQkJCWRwbV90
YWJsZS0+ZHBtX3N0YXRlLnNvZnRfbWluX2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2Rw
bV90YWJsZS0+Y291bnQgLSAxXS52YWx1ZTsKLQkJCWRwbV90YWJsZS0+ZHBtX3N0YXRlLnNvZnRf
bWF4X2xldmVsID0gZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2RwbV90YWJsZS0+Y291bnQgLSAxXS52
YWx1ZTsKLQkJfQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50Ci12ZWdhMjBfbm90aWZ5X3Nt
Y19kaXNwYWx5X2NvbmZpZyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKLXsKLQlzdHJ1Y3QgdmVn
YTIwX2RwbV90YWJsZSAqZHBtX3RhYmxlID0gc211LT5zbXVfZHBtLmRwbV9jb250ZXh0OwotCXN0
cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAqbWVtdGFibGUgPSAmZHBtX3RhYmxlLT5tZW1f
dGFibGU7Ci0Jc3RydWN0IHNtdV9jbG9ja3MgbWluX2Nsb2NrcyA9IHswfTsKLQlzdHJ1Y3QgcHBf
ZGlzcGxheV9jbG9ja19yZXF1ZXN0IGNsb2NrX3JlcTsKLQlpbnQgcmV0ID0gMDsKLQotCW1pbl9j
bG9ja3MuZGNlZl9jbG9jayA9IHNtdS0+ZGlzcGxheV9jb25maWctPm1pbl9kY2VmX3NldF9jbGs7
Ci0JbWluX2Nsb2Nrcy5kY2VmX2Nsb2NrX2luX3NyID0gc211LT5kaXNwbGF5X2NvbmZpZy0+bWlu
X2RjZWZfZGVlcF9zbGVlcF9zZXRfY2xrOwotCW1pbl9jbG9ja3MubWVtb3J5X2Nsb2NrID0gc211
LT5kaXNwbGF5X2NvbmZpZy0+bWluX21lbV9zZXRfY2xvY2s7Ci0KLQlpZiAoc211X2ZlYXR1cmVf
aXNfc3VwcG9ydGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX0RDRUZDTEtfQklUKSkgewotCQljbG9j
a19yZXEuY2xvY2tfdHlwZSA9IGFtZF9wcF9kY2VmX2Nsb2NrOwotCQljbG9ja19yZXEuY2xvY2tf
ZnJlcV9pbl9raHogPSBtaW5fY2xvY2tzLmRjZWZfY2xvY2sgKiAxMDsKLQkJaWYgKCFzbXUtPmZ1
bmNzLT5kaXNwbGF5X2Nsb2NrX3ZvbHRhZ2VfcmVxdWVzdChzbXUsICZjbG9ja19yZXEpKSB7Ci0J
CQlpZiAoc211X2ZlYXR1cmVfaXNfc3VwcG9ydGVkKHNtdSwgU01VX0ZFQVRVUkVfRFNfRENFRkNM
S19CSVQpKSB7Ci0JCQkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwKLQkJ
CQkJCQkJICBTTVVfTVNHX1NldE1pbkRlZXBTbGVlcERjZWZjbGssCi0JCQkJCQkJCSAgbWluX2Ns
b2Nrcy5kY2VmX2Nsb2NrX2luX3NyLzEwMCk7Ci0JCQkJaWYgKHJldCkgewotCQkJCQlwcl9lcnIo
IkF0dGVtcHQgdG8gc2V0IGRpdmlkZXIgZm9yIERDRUZDTEsgRmFpbGVkISIpOwotCQkJCQlyZXR1
cm4gcmV0OwotCQkJCX0KLQkJCX0KLQkJfSBlbHNlIHsKLQkJCXByX2luZm8oIkF0dGVtcHQgdG8g
c2V0IEhhcmQgTWluIGZvciBEQ0VGQ0xLIEZhaWxlZCEiKTsKLQkJfQotCX0KLQotCWlmIChzbXVf
ZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX1VDTEtfQklUKSkgewotCQlt
ZW10YWJsZS0+ZHBtX3N0YXRlLmhhcmRfbWluX2xldmVsID0gbWluX2Nsb2Nrcy5tZW1vcnlfY2xv
Y2svMTAwOwotCQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LAotCQkJCQkJ
ICBTTVVfTVNHX1NldEhhcmRNaW5CeUZyZXEsCi0JCQkJCQkgIChQUENMS19VQ0xLIDw8IDE2KSB8
IG1lbXRhYmxlLT5kcG1fc3RhdGUuaGFyZF9taW5fbGV2ZWwpOwotCQlpZiAocmV0KSB7Ci0JCQlw
cl9lcnIoIlslc10gU2V0IGhhcmQgbWluIHVjbGsgZmFpbGVkISIsIF9fZnVuY19fKTsKLQkJCXJl
dHVybiByZXQ7Ci0JCX0KLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIHVpbnQzMl90IHZl
Z2EyMF9maW5kX2xvd2VzdF9kcG1fbGV2ZWwoc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxl
ICp0YWJsZSkKLXsKLQl1aW50MzJfdCBpOwotCi0JZm9yIChpID0gMDsgaSA8IHRhYmxlLT5jb3Vu
dDsgaSsrKSB7Ci0JCWlmICh0YWJsZS0+ZHBtX2xldmVsc1tpXS5lbmFibGVkKQotCQkJYnJlYWs7
Ci0JfQotCWlmIChpID49IHRhYmxlLT5jb3VudCkgewotCQlpID0gMDsKLQkJdGFibGUtPmRwbV9s
ZXZlbHNbaV0uZW5hYmxlZCA9IHRydWU7Ci0JfQotCi0JcmV0dXJuIGk7Ci19Ci0KLXN0YXRpYyB1
aW50MzJfdCB2ZWdhMjBfZmluZF9oaWdoZXN0X2RwbV9sZXZlbChzdHJ1Y3QgdmVnYTIwX3Npbmds
ZV9kcG1fdGFibGUgKnRhYmxlKQotewotCWludCBpID0gMDsKLQotCWlmICghdGFibGUpIHsKLQkJ
cHJfZXJyKCJbJXNdIERQTSBUYWJsZSBkb2VzIG5vdCBleGlzdCEiLCBfX2Z1bmNfXyk7Ci0JCXJl
dHVybiAwOwotCX0KLQlpZiAodGFibGUtPmNvdW50IDw9IDApIHsKLQkJcHJfZXJyKCJbJXNdIERQ
TSBUYWJsZSBoYXMgbm8gZW50cnkhIiwgX19mdW5jX18pOwotCQlyZXR1cm4gMDsKLQl9Ci0JaWYg
KHRhYmxlLT5jb3VudCA+IE1BWF9SRUdVTEFSX0RQTV9OVU1CRVIpIHsKLQkJcHJfZXJyKCJbJXNd
IERQTSBUYWJsZSBoYXMgdG9vIG1hbnkgZW50cmllcyEiLCBfX2Z1bmNfXyk7Ci0JCXJldHVybiBN
QVhfUkVHVUxBUl9EUE1fTlVNQkVSIC0gMTsKLQl9Ci0KLQlmb3IgKGkgPSB0YWJsZS0+Y291bnQg
LSAxOyBpID49IDA7IGktLSkgewotCQlpZiAodGFibGUtPmRwbV9sZXZlbHNbaV0uZW5hYmxlZCkK
LQkJCWJyZWFrOwotCX0KLQlpZiAoaSA8IDApIHsKLQkJaSA9IDA7Ci0JCXRhYmxlLT5kcG1fbGV2
ZWxzW2ldLmVuYWJsZWQgPSB0cnVlOwotCX0KLQotCXJldHVybiBpOwotfQotCi1zdGF0aWMgaW50
IHZlZ2EyMF9mb3JjZV9kcG1fbGltaXRfdmFsdWUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGJv
b2wgaGlnaGVzdCkKLXsKLQl1aW50MzJfdCBzb2Z0X2xldmVsOwotCWludCByZXQgPSAwOwotCXN0
cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICpkcG1fdGFibGUgPQotCQkoc3RydWN0IHZlZ2EyMF9kcG1f
dGFibGUgKilzbXUtPnNtdV9kcG0uZHBtX2NvbnRleHQ7Ci0KLQlpZiAoaGlnaGVzdCkKLQkJc29m
dF9sZXZlbCA9IHZlZ2EyMF9maW5kX2hpZ2hlc3RfZHBtX2xldmVsKCYoZHBtX3RhYmxlLT5nZnhf
dGFibGUpKTsKLQllbHNlCi0JCXNvZnRfbGV2ZWwgPSB2ZWdhMjBfZmluZF9sb3dlc3RfZHBtX2xl
dmVsKCYoZHBtX3RhYmxlLT5nZnhfdGFibGUpKTsKLQotCWRwbV90YWJsZS0+Z2Z4X3RhYmxlLmRw
bV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9Ci0JCWRwbV90YWJsZS0+Z2Z4X3RhYmxlLmRwbV9zdGF0
ZS5zb2Z0X21heF9sZXZlbCA9Ci0JCWRwbV90YWJsZS0+Z2Z4X3RhYmxlLmRwbV9sZXZlbHNbc29m
dF9sZXZlbF0udmFsdWU7Ci0KLQlpZiAoaGlnaGVzdCkKLQkJc29mdF9sZXZlbCA9IHZlZ2EyMF9m
aW5kX2hpZ2hlc3RfZHBtX2xldmVsKCYoZHBtX3RhYmxlLT5tZW1fdGFibGUpKTsKLQllbHNlCi0J
CXNvZnRfbGV2ZWwgPSB2ZWdhMjBfZmluZF9sb3dlc3RfZHBtX2xldmVsKCYoZHBtX3RhYmxlLT5t
ZW1fdGFibGUpKTsKLQotCWRwbV90YWJsZS0+bWVtX3RhYmxlLmRwbV9zdGF0ZS5zb2Z0X21pbl9s
ZXZlbCA9Ci0JCWRwbV90YWJsZS0+bWVtX3RhYmxlLmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9
Ci0JCWRwbV90YWJsZS0+bWVtX3RhYmxlLmRwbV9sZXZlbHNbc29mdF9sZXZlbF0udmFsdWU7Ci0K
LQlpZiAoaGlnaGVzdCkKLQkJc29mdF9sZXZlbCA9IHZlZ2EyMF9maW5kX2hpZ2hlc3RfZHBtX2xl
dmVsKCYoZHBtX3RhYmxlLT5zb2NfdGFibGUpKTsKLQllbHNlCi0JCXNvZnRfbGV2ZWwgPSB2ZWdh
MjBfZmluZF9sb3dlc3RfZHBtX2xldmVsKCYoZHBtX3RhYmxlLT5zb2NfdGFibGUpKTsKLQotCWRw
bV90YWJsZS0+c29jX3RhYmxlLmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9Ci0JCWRwbV90YWJs
ZS0+c29jX3RhYmxlLmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9Ci0JCWRwbV90YWJsZS0+c29j
X3RhYmxlLmRwbV9sZXZlbHNbc29mdF9sZXZlbF0udmFsdWU7Ci0KLQlyZXQgPSB2ZWdhMjBfdXBs
b2FkX2RwbV9sZXZlbChzbXUsIGZhbHNlLCAweEZGRkZGRkZGKTsKLQlpZiAocmV0KSB7Ci0JCXBy
X2VycigiRmFpbGVkIHRvIHVwbG9hZCBib290IGxldmVsIHRvICVzIVxuIiwKLQkJCQloaWdoZXN0
ID8gImhpZ2hlc3QiIDogImxvd2VzdCIpOwotCQlyZXR1cm4gcmV0OwotCX0KLQotCXJldCA9IHZl
Z2EyMF91cGxvYWRfZHBtX2xldmVsKHNtdSwgdHJ1ZSwgMHhGRkZGRkZGRik7Ci0JaWYgKHJldCkg
ewotCQlwcl9lcnIoIkZhaWxlZCB0byB1cGxvYWQgZHBtIG1heCBsZXZlbCB0byAlcyFcbiEiLAot
CQkJCWhpZ2hlc3QgPyAiaGlnaGVzdCIgOiAibG93ZXN0Iik7Ci0JCXJldHVybiByZXQ7Ci0JfQot
Ci0JcmV0dXJuIHJldDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfdW5mb3JjZV9kcG1fbGV2ZWxz
KHN0cnVjdCBzbXVfY29udGV4dCAqc211KQotewotCXVpbnQzMl90IHNvZnRfbWluX2xldmVsLCBz
b2Z0X21heF9sZXZlbDsKLQlpbnQgcmV0ID0gMDsKLQlzdHJ1Y3QgdmVnYTIwX2RwbV90YWJsZSAq
ZHBtX3RhYmxlID0KLQkJKHN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICopc211LT5zbXVfZHBtLmRw
bV9jb250ZXh0OwotCi0Jc29mdF9taW5fbGV2ZWwgPSB2ZWdhMjBfZmluZF9sb3dlc3RfZHBtX2xl
dmVsKCYoZHBtX3RhYmxlLT5nZnhfdGFibGUpKTsKLQlzb2Z0X21heF9sZXZlbCA9IHZlZ2EyMF9m
aW5kX2hpZ2hlc3RfZHBtX2xldmVsKCYoZHBtX3RhYmxlLT5nZnhfdGFibGUpKTsKLQlkcG1fdGFi
bGUtPmdmeF90YWJsZS5kcG1fc3RhdGUuc29mdF9taW5fbGV2ZWwgPQotCQlkcG1fdGFibGUtPmdm
eF90YWJsZS5kcG1fbGV2ZWxzW3NvZnRfbWluX2xldmVsXS52YWx1ZTsKLQlkcG1fdGFibGUtPmdm
eF90YWJsZS5kcG1fc3RhdGUuc29mdF9tYXhfbGV2ZWwgPQotCQlkcG1fdGFibGUtPmdmeF90YWJs
ZS5kcG1fbGV2ZWxzW3NvZnRfbWF4X2xldmVsXS52YWx1ZTsKLQotCXNvZnRfbWluX2xldmVsID0g
dmVnYTIwX2ZpbmRfbG93ZXN0X2RwbV9sZXZlbCgmKGRwbV90YWJsZS0+bWVtX3RhYmxlKSk7Ci0J
c29mdF9tYXhfbGV2ZWwgPSB2ZWdhMjBfZmluZF9oaWdoZXN0X2RwbV9sZXZlbCgmKGRwbV90YWJs
ZS0+bWVtX3RhYmxlKSk7Ci0JZHBtX3RhYmxlLT5tZW1fdGFibGUuZHBtX3N0YXRlLnNvZnRfbWlu
X2xldmVsID0KLQkJZHBtX3RhYmxlLT5nZnhfdGFibGUuZHBtX2xldmVsc1tzb2Z0X21pbl9sZXZl
bF0udmFsdWU7Ci0JZHBtX3RhYmxlLT5tZW1fdGFibGUuZHBtX3N0YXRlLnNvZnRfbWF4X2xldmVs
ID0KLQkJZHBtX3RhYmxlLT5nZnhfdGFibGUuZHBtX2xldmVsc1tzb2Z0X21heF9sZXZlbF0udmFs
dWU7Ci0KLQlzb2Z0X21pbl9sZXZlbCA9IHZlZ2EyMF9maW5kX2xvd2VzdF9kcG1fbGV2ZWwoJihk
cG1fdGFibGUtPnNvY190YWJsZSkpOwotCXNvZnRfbWF4X2xldmVsID0gdmVnYTIwX2ZpbmRfaGln
aGVzdF9kcG1fbGV2ZWwoJihkcG1fdGFibGUtPnNvY190YWJsZSkpOwotCWRwbV90YWJsZS0+c29j
X3RhYmxlLmRwbV9zdGF0ZS5zb2Z0X21pbl9sZXZlbCA9Ci0JCWRwbV90YWJsZS0+c29jX3RhYmxl
LmRwbV9sZXZlbHNbc29mdF9taW5fbGV2ZWxdLnZhbHVlOwotCWRwbV90YWJsZS0+c29jX3RhYmxl
LmRwbV9zdGF0ZS5zb2Z0X21heF9sZXZlbCA9Ci0JCWRwbV90YWJsZS0+c29jX3RhYmxlLmRwbV9s
ZXZlbHNbc29mdF9tYXhfbGV2ZWxdLnZhbHVlOwotCi0JcmV0ID0gdmVnYTIwX3VwbG9hZF9kcG1f
bGV2ZWwoc211LCBmYWxzZSwgMHhGRkZGRkZGRik7Ci0JaWYgKHJldCkgewotCQlwcl9lcnIoIkZh
aWxlZCB0byB1cGxvYWQgRFBNIEJvb3R1cCBMZXZlbHMhIik7Ci0JCXJldHVybiByZXQ7Ci0JfQot
Ci0JcmV0ID0gdmVnYTIwX3VwbG9hZF9kcG1fbGV2ZWwoc211LCB0cnVlLCAweEZGRkZGRkZGKTsK
LQlpZiAocmV0KSB7Ci0JCXByX2VycigiRmFpbGVkIHRvIHVwbG9hZCBEUE0gTWF4IExldmVscyEi
KTsKLQkJcmV0dXJuIHJldDsKLQl9Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IHZl
Z2EyMF91cGRhdGVfc3BlY2lmaWVkX29kOF92YWx1ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwK
LQkJCQkJICAgICB1aW50MzJfdCBpbmRleCwKLQkJCQkJICAgICB1aW50MzJfdCB2YWx1ZSkKLXsK
LQlzdHJ1Y3Qgc211X3RhYmxlX2NvbnRleHQgKnRhYmxlX2NvbnRleHQgPSAmc211LT5zbXVfdGFi
bGU7Ci0JT3ZlckRyaXZlVGFibGVfdCAqb2RfdGFibGUgPQotCQkoT3ZlckRyaXZlVGFibGVfdCAq
KSh0YWJsZV9jb250ZXh0LT5vdmVyZHJpdmVfdGFibGUpOwotCXN0cnVjdCB2ZWdhMjBfb2Q4X3Nl
dHRpbmdzICpvZDhfc2V0dGluZ3MgPQotCQkoc3RydWN0IHZlZ2EyMF9vZDhfc2V0dGluZ3MgKilz
bXUtPm9kX3NldHRpbmdzOwotCi0Jc3dpdGNoIChpbmRleCkgewotCWNhc2UgT0Q4X1NFVFRJTkdf
R0ZYQ0xLX0ZNSU46Ci0JCW9kX3RhYmxlLT5HZnhjbGtGbWluID0gKHVpbnQxNl90KXZhbHVlOwot
CQlicmVhazsKLQotCWNhc2UgT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZNQVg6Ci0JCWlmICh2YWx1ZSA8
IG9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUFY
XS5taW5fdmFsdWUgfHwKLQkJICAgIHZhbHVlID4gb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3Nf
YXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZNQVhdLm1heF92YWx1ZSkKLQkJCXJldHVybiAtRUlO
VkFMOwotCQlvZF90YWJsZS0+R2Z4Y2xrRm1heCA9ICh1aW50MTZfdCl2YWx1ZTsKLQkJYnJlYWs7
Ci0KLQljYXNlIE9EOF9TRVRUSU5HX0dGWENMS19GUkVRMToKLQkJb2RfdGFibGUtPkdmeGNsa0Zy
ZXExID0gKHVpbnQxNl90KXZhbHVlOwotCQlicmVhazsKLQotCWNhc2UgT0Q4X1NFVFRJTkdfR0ZY
Q0xLX1ZPTFRBR0UxOgotCQlvZF90YWJsZS0+R2Z4Y2xrVm9sdDEgPSAodWludDE2X3QpdmFsdWU7
Ci0JCWJyZWFrOwotCi0JY2FzZSBPRDhfU0VUVElOR19HRlhDTEtfRlJFUTI6Ci0JCW9kX3RhYmxl
LT5HZnhjbGtGcmVxMiA9ICh1aW50MTZfdCl2YWx1ZTsKLQkJYnJlYWs7Ci0KLQljYXNlIE9EOF9T
RVRUSU5HX0dGWENMS19WT0xUQUdFMjoKLQkJb2RfdGFibGUtPkdmeGNsa1ZvbHQyID0gKHVpbnQx
Nl90KXZhbHVlOwotCQlicmVhazsKLQotCWNhc2UgT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVEzOgot
CQlvZF90YWJsZS0+R2Z4Y2xrRnJlcTMgPSAodWludDE2X3QpdmFsdWU7Ci0JCWJyZWFrOwotCi0J
Y2FzZSBPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTM6Ci0JCW9kX3RhYmxlLT5HZnhjbGtWb2x0
MyA9ICh1aW50MTZfdCl2YWx1ZTsKLQkJYnJlYWs7Ci0KLQljYXNlIE9EOF9TRVRUSU5HX1VDTEtf
Rk1BWDoKLQkJaWYgKHZhbHVlIDwgb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4
X1NFVFRJTkdfVUNMS19GTUFYXS5taW5fdmFsdWUgfHwKLQkJICAgIHZhbHVlID4gb2Q4X3NldHRp
bmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfVUNMS19GTUFYXS5tYXhfdmFsdWUp
Ci0JCQlyZXR1cm4gLUVJTlZBTDsKLQkJb2RfdGFibGUtPlVjbGtGbWF4ID0gKHVpbnQxNl90KXZh
bHVlOwotCQlicmVhazsKLQotCWNhc2UgT0Q4X1NFVFRJTkdfUE9XRVJfUEVSQ0VOVEFHRToKLQkJ
b2RfdGFibGUtPk92ZXJEcml2ZVBjdCA9IChpbnQxNl90KXZhbHVlOwotCQlicmVhazsKLQotCWNh
c2UgT0Q4X1NFVFRJTkdfRkFOX0FDT1VTVElDX0xJTUlUOgotCQlvZF90YWJsZS0+RmFuTWF4aW11
bVJwbSA9ICh1aW50MTZfdCl2YWx1ZTsKLQkJYnJlYWs7Ci0KLQljYXNlIE9EOF9TRVRUSU5HX0ZB
Tl9NSU5fU1BFRUQ6Ci0JCW9kX3RhYmxlLT5GYW5NaW5pbXVtUHdtID0gKHVpbnQxNl90KXZhbHVl
OwotCQlicmVhazsKLQotCWNhc2UgT0Q4X1NFVFRJTkdfRkFOX1RBUkdFVF9URU1QOgotCQlvZF90
YWJsZS0+RmFuVGFyZ2V0VGVtcGVyYXR1cmUgPSAodWludDE2X3QpdmFsdWU7Ci0JCWJyZWFrOwot
Ci0JY2FzZSBPRDhfU0VUVElOR19PUEVSQVRJTkdfVEVNUF9NQVg6Ci0JCW9kX3RhYmxlLT5NYXhP
cFRlbXAgPSAodWludDE2X3QpdmFsdWU7Ci0JCWJyZWFrOwotCX0KLQotCXJldHVybiAwOwotfQot
Ci1zdGF0aWMgaW50IHZlZ2EyMF91cGRhdGVfb2Q4X3NldHRpbmdzKHN0cnVjdCBzbXVfY29udGV4
dCAqc211LAotCQkJCSAgICAgIHVpbnQzMl90IGluZGV4LAotCQkJCSAgICAgIHVpbnQzMl90IHZh
bHVlKQotewotCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFibGVfY29udGV4dCA9ICZzbXUt
PnNtdV90YWJsZTsKLQlpbnQgcmV0OwotCi0JcmV0ID0gc211X3VwZGF0ZV90YWJsZShzbXUsIFNN
VV9UQUJMRV9PVkVSRFJJVkUsCi0JCQkgICAgICAgdGFibGVfY29udGV4dC0+b3ZlcmRyaXZlX3Rh
YmxlLCBmYWxzZSk7Ci0JaWYgKHJldCkgewotCQlwcl9lcnIoIkZhaWxlZCB0byBleHBvcnQgb3Zl
ciBkcml2ZSB0YWJsZSFcbiIpOwotCQlyZXR1cm4gcmV0OwotCX0KLQotCXJldCA9IHZlZ2EyMF91
cGRhdGVfc3BlY2lmaWVkX29kOF92YWx1ZShzbXUsIGluZGV4LCB2YWx1ZSk7Ci0JaWYgKHJldCkK
LQkJcmV0dXJuIHJldDsKLQotCXJldCA9IHNtdV91cGRhdGVfdGFibGUoc211LCBTTVVfVEFCTEVf
T1ZFUkRSSVZFLAotCQkJICAgICAgIHRhYmxlX2NvbnRleHQtPm92ZXJkcml2ZV90YWJsZSwgdHJ1
ZSk7Ci0JaWYgKHJldCkgewotCQlwcl9lcnIoIkZhaWxlZCB0byBpbXBvcnQgb3ZlciBkcml2ZSB0
YWJsZSFcbiIpOwotCQlyZXR1cm4gcmV0OwotCX0KLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMg
aW50IHZlZ2EyMF9zZXRfb2RfcGVyY2VudGFnZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKLQkJ
CQkgICAgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsCi0JCQkJICAgIHVpbnQzMl90IHZhbHVl
KQotewotCXN0cnVjdCBzbXVfZHBtX2NvbnRleHQgKnNtdV9kcG0gPSAmc211LT5zbXVfZHBtOwot
CXN0cnVjdCB2ZWdhMjBfZHBtX3RhYmxlICpkcG1fdGFibGUgPSBOVUxMOwotCXN0cnVjdCB2ZWdh
MjBfZHBtX3RhYmxlICpnb2xkZW5fdGFibGUgPSBOVUxMOwotCXN0cnVjdCB2ZWdhMjBfc2luZ2xl
X2RwbV90YWJsZSAqc2luZ2xlX2RwbV90YWJsZTsKLQlzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1f
dGFibGUgKmdvbGRlbl9kcG1fdGFibGU7Ci0JdWludDMyX3Qgb2RfY2xrLCBpbmRleDsKLQlpbnQg
cmV0ID0gMDsKLQlpbnQgZmVhdHVyZV9lbmFibGVkOwotCVBQQ0xLX2UgY2xrX2lkOwotCi0JbXV0
ZXhfbG9jaygmKHNtdS0+bXV0ZXgpKTsKLQotCWRwbV90YWJsZSA9IHNtdV9kcG0tPmRwbV9jb250
ZXh0OwotCWdvbGRlbl90YWJsZSA9IHNtdV9kcG0tPmdvbGRlbl9kcG1fY29udGV4dDsKLQotCXN3
aXRjaCAoY2xrX3R5cGUpIHsKLQljYXNlIFNNVV9PRF9TQ0xLOgotCQlzaW5nbGVfZHBtX3RhYmxl
ID0gJihkcG1fdGFibGUtPmdmeF90YWJsZSk7Ci0JCWdvbGRlbl9kcG1fdGFibGUgPSAmKGdvbGRl
bl90YWJsZS0+Z2Z4X3RhYmxlKTsKLQkJZmVhdHVyZV9lbmFibGVkID0gc211X2ZlYXR1cmVfaXNf
ZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJFX0RQTV9HRlhDTEtfQklUKTsKLQkJY2xrX2lkID0gUFBD
TEtfR0ZYQ0xLOwotCQlpbmRleCA9IE9EOF9TRVRUSU5HX0dGWENMS19GTUFYOwotCQlicmVhazsK
LQljYXNlIFNNVV9PRF9NQ0xLOgotCQlzaW5nbGVfZHBtX3RhYmxlID0gJihkcG1fdGFibGUtPm1l
bV90YWJsZSk7Ci0JCWdvbGRlbl9kcG1fdGFibGUgPSAmKGdvbGRlbl90YWJsZS0+bWVtX3RhYmxl
KTsKLQkJZmVhdHVyZV9lbmFibGVkID0gc211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUsIFNNVV9G
RUFUVVJFX0RQTV9VQ0xLX0JJVCk7Ci0JCWNsa19pZCA9IFBQQ0xLX1VDTEs7Ci0JCWluZGV4ID0g
T0Q4X1NFVFRJTkdfVUNMS19GTUFYOwotCQlicmVhazsKLQlkZWZhdWx0OgotCQlyZXQgPSAtRUlO
VkFMOwotCQlicmVhazsKLQl9Ci0KLQlpZiAocmV0KQotCQlnb3RvIHNldF9vZF9mYWlsZWQ7Ci0K
LQlvZF9jbGsgPSBnb2xkZW5fZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2dvbGRlbl9kcG1fdGFibGUt
PmNvdW50IC0gMV0udmFsdWUgKiB2YWx1ZTsKLQlvZF9jbGsgLz0gMTAwOwotCW9kX2NsayArPSBn
b2xkZW5fZHBtX3RhYmxlLT5kcG1fbGV2ZWxzW2dvbGRlbl9kcG1fdGFibGUtPmNvdW50IC0gMV0u
dmFsdWU7Ci0KLQlyZXQgPSB2ZWdhMjBfdXBkYXRlX29kOF9zZXR0aW5ncyhzbXUsIGluZGV4LCBv
ZF9jbGspOwotCWlmIChyZXQpIHsKLQkJcHJfZXJyKCJbU2V0b3ZlcmRyaXZlXSBmYWlsZWQgdG8g
c2V0IG9kIGNsayFcbiIpOwotCQlnb3RvIHNldF9vZF9mYWlsZWQ7Ci0JfQotCi0JaWYgKGZlYXR1
cmVfZW5hYmxlZCkgewotCQlyZXQgPSB2ZWdhMjBfc2V0X3NpbmdsZV9kcG1fdGFibGUoc211LCBz
aW5nbGVfZHBtX3RhYmxlLAotCQkJCQkJICBjbGtfaWQpOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9l
cnIoIltTZXRvdmVyZHJpdmVdIGZhaWxlZCB0byByZWZyZXNoIGRwbSB0YWJsZSFcbiIpOwotCQkJ
Z290byBzZXRfb2RfZmFpbGVkOwotCQl9Ci0JfSBlbHNlIHsKLQkJc2luZ2xlX2RwbV90YWJsZS0+
Y291bnQgPSAxOwotCQlzaW5nbGVfZHBtX3RhYmxlLT5kcG1fbGV2ZWxzWzBdLnZhbHVlID0gc211
LT5zbXVfdGFibGUuYm9vdF92YWx1ZXMuZ2Z4Y2xrIC8gMTAwOwotCX0KLQotCXJldCA9IHNtdV9o
YW5kbGVfdGFzayhzbXUsIHNtdV9kcG0tPmRwbV9sZXZlbCwKLQkJCSAgICAgIEFNRF9QUF9UQVNL
X1JFQURKVVNUX1BPV0VSX1NUQVRFKTsKLQotc2V0X29kX2ZhaWxlZDoKLQltdXRleF91bmxvY2so
JihzbXUtPm11dGV4KSk7Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IHZlZ2EyMF9v
ZG5fZWRpdF9kcG1fdGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCi0JCQkJICAgICBlbnVt
IFBQX09EX0RQTV9UQUJMRV9DT01NQU5EIHR5cGUsCi0JCQkJICAgICBsb25nICppbnB1dCwgdWlu
dDMyX3Qgc2l6ZSkKLXsKLQlzdHJ1Y3Qgc211X3RhYmxlX2NvbnRleHQgKnRhYmxlX2NvbnRleHQg
PSAmc211LT5zbXVfdGFibGU7Ci0JT3ZlckRyaXZlVGFibGVfdCAqb2RfdGFibGUgPQotCQkoT3Zl
ckRyaXZlVGFibGVfdCAqKSh0YWJsZV9jb250ZXh0LT5vdmVyZHJpdmVfdGFibGUpOwotCXN0cnVj
dCBzbXVfZHBtX2NvbnRleHQgKnNtdV9kcG0gPSAmc211LT5zbXVfZHBtOwotCXN0cnVjdCB2ZWdh
MjBfZHBtX3RhYmxlICpkcG1fdGFibGUgPSBOVUxMOwotCXN0cnVjdCB2ZWdhMjBfc2luZ2xlX2Rw
bV90YWJsZSAqc2luZ2xlX2RwbV90YWJsZTsKLQlzdHJ1Y3QgdmVnYTIwX29kOF9zZXR0aW5ncyAq
b2Q4X3NldHRpbmdzID0KLQkJKHN0cnVjdCB2ZWdhMjBfb2Q4X3NldHRpbmdzICopc211LT5vZF9z
ZXR0aW5nczsKLQlzdHJ1Y3QgcHBfY2xvY2tfbGV2ZWxzX3dpdGhfbGF0ZW5jeSBjbG9ja3M7Ci0J
aW50MzJfdCBpbnB1dF9pbmRleCwgaW5wdXRfY2xrLCBpbnB1dF92b2wsIGk7Ci0JaW50IG9kOF9p
ZDsKLQlpbnQgcmV0ID0gMDsKLQotCWRwbV90YWJsZSA9IHNtdV9kcG0tPmRwbV9jb250ZXh0Owot
Ci0JaWYgKCFpbnB1dCkgewotCQlwcl93YXJuKCJOVUxMIHVzZXIgaW5wdXQgZm9yIGNsb2NrIGFu
ZCB2b2x0YWdlXG4iKTsKLQkJcmV0dXJuIC1FSU5WQUw7Ci0JfQotCi0Jc3dpdGNoICh0eXBlKSB7
Ci0JY2FzZSBQUF9PRF9FRElUX1NDTEtfVkREQ19UQUJMRToKLQkJaWYgKCEob2Q4X3NldHRpbmdz
LT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZNSU5dLmZlYXR1cmVfaWQg
JiYKLQkJICAgICAgb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdf
R0ZYQ0xLX0ZNQVhdLmZlYXR1cmVfaWQpKSB7Ci0JCQlwcl9pbmZvKCJTY2xrIG1pbi9tYXggZnJl
cXVlbmN5IG92ZXJkcml2ZSBub3Qgc3VwcG9ydGVkXG4iKTsKLQkJCXJldHVybiAtRU9QTk9UU1VQ
UDsKLQkJfQotCi0JCWZvciAoaSA9IDA7IGkgPCBzaXplOyBpICs9IDIpIHsKLQkJCWlmIChpICsg
MiA+IHNpemUpIHsKLQkJCQlwcl9pbmZvKCJpbnZhbGlkIG51bWJlciBvZiBpbnB1dCBwYXJhbWV0
ZXJzICVkXG4iLCBzaXplKTsKLQkJCQlyZXR1cm4gLUVJTlZBTDsKLQkJCX0KLQotCQkJaW5wdXRf
aW5kZXggPSBpbnB1dFtpXTsKLQkJCWlucHV0X2NsayA9IGlucHV0W2kgKyAxXTsKLQotCQkJaWYg
KGlucHV0X2luZGV4ICE9IDAgJiYgaW5wdXRfaW5kZXggIT0gMSkgewotCQkJCXByX2luZm8oIklu
dmFsaWQgaW5kZXggJWRcbiIsIGlucHV0X2luZGV4KTsKLQkJCQlwcl9pbmZvKCJTdXBwb3J0IG1p
bi9tYXggc2NsayBmcmVxdWVuY3kgc2V0dGluZ29ubHkgd2hpY2ggaW5kZXggYnkgMC8xXG4iKTsK
LQkJCQlyZXR1cm4gLUVJTlZBTDsKLQkJCX0KLQotCQkJaWYgKGlucHV0X2NsayA8IG9kOF9zZXR0
aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUlOXS5taW5fdmFs
dWUgfHwKLQkJCSAgICBpbnB1dF9jbGsgPiBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJh
eVtPRDhfU0VUVElOR19HRlhDTEtfRk1BWF0ubWF4X3ZhbHVlKSB7Ci0JCQkJcHJfaW5mbygiY2xv
Y2sgZnJlcSAlZCBpcyBub3Qgd2l0aGluIGFsbG93ZWQgcmFuZ2UgWyVkIC0gJWRdXG4iLAotCQkJ
CQlpbnB1dF9jbGssCi0JCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9T
RVRUSU5HX0dGWENMS19GTUlOXS5taW5fdmFsdWUsCi0JCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3Nl
dHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GTUFYXS5tYXhfdmFsdWUpOwotCQkJCXJl
dHVybiAtRUlOVkFMOwotCQkJfQotCi0JCQlpZiAoaW5wdXRfaW5kZXggPT0gMCAmJiBvZF90YWJs
ZS0+R2Z4Y2xrRm1pbiAhPSBpbnB1dF9jbGspIHsKLQkJCQlvZF90YWJsZS0+R2Z4Y2xrRm1pbiA9
IGlucHV0X2NsazsKLQkJCQlvZDhfc2V0dGluZ3MtPm9kX2dmeGNsa191cGRhdGUgPSB0cnVlOwot
CQkJfSBlbHNlIGlmIChpbnB1dF9pbmRleCA9PSAxICYmIG9kX3RhYmxlLT5HZnhjbGtGbWF4ICE9
IGlucHV0X2NsaykgewotCQkJCW9kX3RhYmxlLT5HZnhjbGtGbWF4ID0gaW5wdXRfY2xrOwotCQkJ
CW9kOF9zZXR0aW5ncy0+b2RfZ2Z4Y2xrX3VwZGF0ZSA9IHRydWU7Ci0JCQl9Ci0JCX0KLQotCQli
cmVhazsKLQotCWNhc2UgUFBfT0RfRURJVF9NQ0xLX1ZERENfVEFCTEU6Ci0JCWlmICghb2Q4X3Nl
dHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfVUNMS19GTUFYXS5mZWF0dXJl
X2lkKSB7Ci0JCQlwcl9pbmZvKCJNY2xrIG1heCBmcmVxdWVuY3kgb3ZlcmRyaXZlIG5vdCBzdXBw
b3J0ZWRcbiIpOwotCQkJcmV0dXJuIC1FT1BOT1RTVVBQOwotCQl9Ci0KLQkJc2luZ2xlX2RwbV90
YWJsZSA9ICYoZHBtX3RhYmxlLT5tZW1fdGFibGUpOwotCQlyZXQgPSB2ZWdhMjBfZ2V0X2Nsa190
YWJsZShzbXUsICZjbG9ja3MsIHNpbmdsZV9kcG1fdGFibGUpOwotCQlpZiAocmV0KSB7Ci0JCQlw
cl9lcnIoIkF0dGVtcHQgdG8gZ2V0IG1lbW9yeSBjbGsgbGV2ZWxzIEZhaWxlZCEiKTsKLQkJCXJl
dHVybiByZXQ7Ci0JCX0KLQotCQlmb3IgKGkgPSAwOyBpIDwgc2l6ZTsgaSArPSAyKSB7Ci0JCQlp
ZiAoaSArIDIgPiBzaXplKSB7Ci0JCQkJcHJfaW5mbygiaW52YWxpZCBudW1iZXIgb2YgaW5wdXQg
cGFyYW1ldGVycyAlZFxuIiwKLQkJCQkJIHNpemUpOwotCQkJCXJldHVybiAtRUlOVkFMOwotCQkJ
fQotCi0JCQlpbnB1dF9pbmRleCA9IGlucHV0W2ldOwotCQkJaW5wdXRfY2xrID0gaW5wdXRbaSAr
IDFdOwotCi0JCQlpZiAoaW5wdXRfaW5kZXggIT0gMSkgewotCQkJCXByX2luZm8oIkludmFsaWQg
aW5kZXggJWRcbiIsIGlucHV0X2luZGV4KTsKLQkJCQlwcl9pbmZvKCJTdXBwb3J0IG1heCBNY2xr
IGZyZXF1ZW5jeSBzZXR0aW5nIG9ubHkgd2hpY2ggaW5kZXggYnkgMVxuIik7Ci0JCQkJcmV0dXJu
IC1FSU5WQUw7Ci0JCQl9Ci0KLQkJCWlmIChpbnB1dF9jbGsgPCBjbG9ja3MuZGF0YVswXS5jbG9j
a3NfaW5fa2h6IC8gMTAwMCB8fAotCQkJICAgIGlucHV0X2NsayA+IG9kOF9zZXR0aW5ncy0+b2Q4
X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX1VDTEtfRk1BWF0ubWF4X3ZhbHVlKSB7Ci0JCQkJ
cHJfaW5mbygiY2xvY2sgZnJlcSAlZCBpcyBub3Qgd2l0aGluIGFsbG93ZWQgcmFuZ2UgWyVkIC0g
JWRdXG4iLAotCQkJCQlpbnB1dF9jbGssCi0JCQkJCWNsb2Nrcy5kYXRhWzBdLmNsb2Nrc19pbl9r
aHogLyAxMDAwLAotCQkJCQlvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VU
VElOR19VQ0xLX0ZNQVhdLm1heF92YWx1ZSk7Ci0JCQkJcmV0dXJuIC1FSU5WQUw7Ci0JCQl9Ci0K
LQkJCWlmIChpbnB1dF9pbmRleCA9PSAxICYmIG9kX3RhYmxlLT5VY2xrRm1heCAhPSBpbnB1dF9j
bGspIHsKLQkJCQlvZDhfc2V0dGluZ3MtPm9kX2dmeGNsa191cGRhdGUgPSB0cnVlOwotCQkJCW9k
X3RhYmxlLT5VY2xrRm1heCA9IGlucHV0X2NsazsKLQkJCX0KLQkJfQotCi0JCWJyZWFrOwotCi0J
Y2FzZSBQUF9PRF9FRElUX1ZERENfQ1VSVkU6Ci0JCWlmICghKG9kOF9zZXR0aW5ncy0+b2Q4X3Nl
dHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19GUkVRMV0uZmVhdHVyZV9pZCAmJgotCQkg
ICAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtPRDhfU0VUVElOR19HRlhDTEtf
RlJFUTJdLmZlYXR1cmVfaWQgJiYKLQkJICAgICAgb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGluZ3Nf
YXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX0ZSRVEzXS5mZWF0dXJlX2lkICYmCi0JCSAgICAgIG9k
OF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W09EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdF
MV0uZmVhdHVyZV9pZCAmJgotCQkgICAgICBvZDhfc2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJh
eVtPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTJdLmZlYXR1cmVfaWQgJiYKLQkJICAgICAgb2Q4
X3NldHRpbmdzLT5vZDhfc2V0dGluZ3NfYXJyYXlbT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0Uz
XS5mZWF0dXJlX2lkKSkgewotCQkJcHJfaW5mbygiVm9sdGFnZSBjdXJ2ZSBjYWxpYnJhdGUgbm90
IHN1cHBvcnRlZFxuIik7Ci0JCQlyZXR1cm4gLUVPUE5PVFNVUFA7Ci0JCX0KLQotCQlmb3IgKGkg
PSAwOyBpIDwgc2l6ZTsgaSArPSAzKSB7Ci0JCQlpZiAoaSArIDMgPiBzaXplKSB7Ci0JCQkJcHJf
aW5mbygiaW52YWxpZCBudW1iZXIgb2YgaW5wdXQgcGFyYW1ldGVycyAlZFxuIiwKLQkJCQkJc2l6
ZSk7Ci0JCQkJcmV0dXJuIC1FSU5WQUw7Ci0JCQl9Ci0KLQkJCWlucHV0X2luZGV4ID0gaW5wdXRb
aV07Ci0JCQlpbnB1dF9jbGsgPSBpbnB1dFtpICsgMV07Ci0JCQlpbnB1dF92b2wgPSBpbnB1dFtp
ICsgMl07Ci0KLQkJCWlmIChpbnB1dF9pbmRleCA+IDIpIHsKLQkJCQlwcl9pbmZvKCJTZXR0aW5n
IGZvciBwb2ludCAlZCBpcyBub3Qgc3VwcG9ydGVkXG4iLAotCQkJCQlpbnB1dF9pbmRleCArIDEp
OwotCQkJCXByX2luZm8oIlRocmVlIHN1cHBvcnRlZCBwb2ludHMgaW5kZXggYnkgMCwgMSwgMlxu
Iik7Ci0JCQkJcmV0dXJuIC1FSU5WQUw7Ci0JCQl9Ci0KLQkJCW9kOF9pZCA9IE9EOF9TRVRUSU5H
X0dGWENMS19GUkVRMSArIDIgKiBpbnB1dF9pbmRleDsKLQkJCWlmIChpbnB1dF9jbGsgPCBvZDhf
c2V0dGluZ3MtPm9kOF9zZXR0aW5nc19hcnJheVtvZDhfaWRdLm1pbl92YWx1ZSB8fAotCQkJICAg
IGlucHV0X2NsayA+IG9kOF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W29kOF9pZF0ubWF4
X3ZhbHVlKSB7Ci0JCQkJcHJfaW5mbygiY2xvY2sgZnJlcSAlZCBpcyBub3Qgd2l0aGluIGFsbG93
ZWQgcmFuZ2UgWyVkIC0gJWRdXG4iLAotCQkJCQlpbnB1dF9jbGssCi0JCQkJCW9kOF9zZXR0aW5n
cy0+b2Q4X3NldHRpbmdzX2FycmF5W29kOF9pZF0ubWluX3ZhbHVlLAotCQkJCQlvZDhfc2V0dGlu
Z3MtPm9kOF9zZXR0aW5nc19hcnJheVtvZDhfaWRdLm1heF92YWx1ZSk7Ci0JCQkJcmV0dXJuIC1F
SU5WQUw7Ci0JCQl9Ci0KLQkJCW9kOF9pZCA9IE9EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMSAr
IDIgKiBpbnB1dF9pbmRleDsKLQkJCWlmIChpbnB1dF92b2wgPCBvZDhfc2V0dGluZ3MtPm9kOF9z
ZXR0aW5nc19hcnJheVtvZDhfaWRdLm1pbl92YWx1ZSB8fAotCQkJICAgIGlucHV0X3ZvbCA+IG9k
OF9zZXR0aW5ncy0+b2Q4X3NldHRpbmdzX2FycmF5W29kOF9pZF0ubWF4X3ZhbHVlKSB7Ci0JCQkJ
cHJfaW5mbygiY2xvY2sgdm9sdGFnZSAlZCBpcyBub3Qgd2l0aGluIGFsbG93ZWQgcmFuZ2UgWyVk
LSAlZF1cbiIsCi0JCQkJCWlucHV0X3ZvbCwKLQkJCQkJb2Q4X3NldHRpbmdzLT5vZDhfc2V0dGlu
Z3NfYXJyYXlbb2Q4X2lkXS5taW5fdmFsdWUsCi0JCQkJCW9kOF9zZXR0aW5ncy0+b2Q4X3NldHRp
bmdzX2FycmF5W29kOF9pZF0ubWF4X3ZhbHVlKTsKLQkJCQlyZXR1cm4gLUVJTlZBTDsKLQkJCX0K
LQotCQkJc3dpdGNoIChpbnB1dF9pbmRleCkgewotCQkJY2FzZSAwOgotCQkJCW9kX3RhYmxlLT5H
ZnhjbGtGcmVxMSA9IGlucHV0X2NsazsKLQkJCQlvZF90YWJsZS0+R2Z4Y2xrVm9sdDEgPSBpbnB1
dF92b2wgKiBWT0xUQUdFX1NDQUxFOwotCQkJCWJyZWFrOwotCQkJY2FzZSAxOgotCQkJCW9kX3Rh
YmxlLT5HZnhjbGtGcmVxMiA9IGlucHV0X2NsazsKLQkJCQlvZF90YWJsZS0+R2Z4Y2xrVm9sdDIg
PSBpbnB1dF92b2wgKiBWT0xUQUdFX1NDQUxFOwotCQkJCWJyZWFrOwotCQkJY2FzZSAyOgotCQkJ
CW9kX3RhYmxlLT5HZnhjbGtGcmVxMyA9IGlucHV0X2NsazsKLQkJCQlvZF90YWJsZS0+R2Z4Y2xr
Vm9sdDMgPSBpbnB1dF92b2wgKiBWT0xUQUdFX1NDQUxFOwotCQkJCWJyZWFrOwotCQkJfQotCQl9
Ci0KLQkJYnJlYWs7Ci0KLQljYXNlIFBQX09EX1JFU1RPUkVfREVGQVVMVF9UQUJMRToKLQkJcmV0
ID0gc211X3VwZGF0ZV90YWJsZShzbXUsIFNNVV9UQUJMRV9PVkVSRFJJVkUsIHRhYmxlX2NvbnRl
eHQtPm92ZXJkcml2ZV90YWJsZSwgZmFsc2UpOwotCQlpZiAocmV0KSB7Ci0JCQlwcl9lcnIoIkZh
aWxlZCB0byBleHBvcnQgb3ZlciBkcml2ZSB0YWJsZSFcbiIpOwotCQkJcmV0dXJuIHJldDsKLQkJ
fQotCi0JCWJyZWFrOwotCi0JY2FzZSBQUF9PRF9DT01NSVRfRFBNX1RBQkxFOgotCQlyZXQgPSBz
bXVfdXBkYXRlX3RhYmxlKHNtdSwgU01VX1RBQkxFX09WRVJEUklWRSwgdGFibGVfY29udGV4dC0+
b3ZlcmRyaXZlX3RhYmxlLCB0cnVlKTsKLQkJaWYgKHJldCkgewotCQkJcHJfZXJyKCJGYWlsZWQg
dG8gaW1wb3J0IG92ZXIgZHJpdmUgdGFibGUhXG4iKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KLQot
CQkvKiByZXRyaWV2ZSB1cGRhdGVkIGdmeGNsayB0YWJsZSAqLwotCQlpZiAob2Q4X3NldHRpbmdz
LT5vZF9nZnhjbGtfdXBkYXRlKSB7Ci0JCQlvZDhfc2V0dGluZ3MtPm9kX2dmeGNsa191cGRhdGUg
PSBmYWxzZTsKLQkJCXNpbmdsZV9kcG1fdGFibGUgPSAmKGRwbV90YWJsZS0+Z2Z4X3RhYmxlKTsK
LQotCQkJaWYgKHNtdV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fR0ZY
Q0xLX0JJVCkpIHsKLQkJCQlyZXQgPSB2ZWdhMjBfc2V0X3NpbmdsZV9kcG1fdGFibGUoc211LCBz
aW5nbGVfZHBtX3RhYmxlLAotCQkJCQkJCQkgIFBQQ0xLX0dGWENMSyk7Ci0JCQkJaWYgKHJldCkg
ewotCQkJCQlwcl9lcnIoIltTZXRvdmVyZHJpdmVdIGZhaWxlZCB0byByZWZyZXNoIGRwbSB0YWJs
ZSFcbiIpOwotCQkJCQlyZXR1cm4gcmV0OwotCQkJCX0KLQkJCX0gZWxzZSB7Ci0JCQkJc2luZ2xl
X2RwbV90YWJsZS0+Y291bnQgPSAxOwotCQkJCXNpbmdsZV9kcG1fdGFibGUtPmRwbV9sZXZlbHNb
MF0udmFsdWUgPSBzbXUtPnNtdV90YWJsZS5ib290X3ZhbHVlcy5nZnhjbGsgLyAxMDA7Ci0JCQl9
Ci0JCX0KLQotCQlicmVhazsKLQotCWRlZmF1bHQ6Ci0JCXJldHVybiAtRUlOVkFMOwotCX0KLQot
CWlmICh0eXBlID09IFBQX09EX0NPTU1JVF9EUE1fVEFCTEUpIHsKLQkJbXV0ZXhfbG9jaygmKHNt
dS0+bXV0ZXgpKTsKLQkJcmV0ID0gc211X2hhbmRsZV90YXNrKHNtdSwgc211X2RwbS0+ZHBtX2xl
dmVsLAotCQkJCSAgICAgIEFNRF9QUF9UQVNLX1JFQURKVVNUX1BPV0VSX1NUQVRFKTsKLQkJbXV0
ZXhfdW5sb2NrKCYoc211LT5tdXRleCkpOwotCX0KLQotCXJldHVybiByZXQ7Ci19Ci0KLXN0YXRp
YyBpbnQgdmVnYTIwX2RwbV9zZXRfdXZkX2VuYWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwg
Ym9vbCBlbmFibGUpCi17Ci0JaWYgKCFzbXVfZmVhdHVyZV9pc19zdXBwb3J0ZWQoc211LCBTTVVf
RkVBVFVSRV9EUE1fVVZEX0JJVCkpCi0JCXJldHVybiAwOwotCi0JaWYgKGVuYWJsZSA9PSBzbXVf
ZmVhdHVyZV9pc19lbmFibGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX1VWRF9CSVQpKQotCQlyZXR1
cm4gMDsKLQotCXJldHVybiBzbXVfZmVhdHVyZV9zZXRfZW5hYmxlZChzbXUsIFNNVV9GRUFUVVJF
X0RQTV9VVkRfQklULCBlbmFibGUpOwotfQotCi1zdGF0aWMgaW50IHZlZ2EyMF9kcG1fc2V0X3Zj
ZV9lbmFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGJvb2wgZW5hYmxlKQotewotCWlmICgh
c211X2ZlYXR1cmVfaXNfc3VwcG9ydGVkKHNtdSwgU01VX0ZFQVRVUkVfRFBNX1ZDRV9CSVQpKQot
CQlyZXR1cm4gMDsKLQotCWlmIChlbmFibGUgPT0gc211X2ZlYXR1cmVfaXNfZW5hYmxlZChzbXUs
IFNNVV9GRUFUVVJFX0RQTV9WQ0VfQklUKSkKLQkJcmV0dXJuIDA7Ci0KLQlyZXR1cm4gc211X2Zl
YXR1cmVfc2V0X2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVkNFX0JJVCwgZW5hYmxlKTsK
LX0KLQotc3RhdGljIGludCB2ZWdhMjBfZ2V0X2VuYWJsZWRfc21jX2ZlYXR1cmVzKHN0cnVjdCBz
bXVfY29udGV4dCAqc211LAotCQl1aW50NjRfdCAqZmVhdHVyZXNfZW5hYmxlZCkKLXsKLQl1aW50
MzJfdCBmZWF0dXJlX21hc2tbMl0gPSB7MCwgMH07Ci0JaW50IHJldCA9IDA7Ci0KLQlyZXQgPSBz
bXVfZmVhdHVyZV9nZXRfZW5hYmxlZF9tYXNrKHNtdSwgZmVhdHVyZV9tYXNrLCAyKTsKLQlpZiAo
cmV0KQotCQlyZXR1cm4gcmV0OwotCi0JKmZlYXR1cmVzX2VuYWJsZWQgPSAoKCgodWludDY0X3Qp
ZmVhdHVyZV9tYXNrWzBdIDw8IFNNVV9GRUFUVVJFU19MT1dfU0hJRlQpICYgU01VX0ZFQVRVUkVT
X0xPV19NQVNLKSB8Ci0JCQkoKCh1aW50NjRfdClmZWF0dXJlX21hc2tbMV0gPDwgU01VX0ZFQVRV
UkVTX0hJR0hfU0hJRlQpICYgU01VX0ZFQVRVUkVTX0hJR0hfTUFTSykpOwotCi0JcmV0dXJuIHJl
dDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfZW5hYmxlX3NtY19mZWF0dXJlcyhzdHJ1Y3Qgc211
X2NvbnRleHQgKnNtdSwKLQkJYm9vbCBlbmFibGUsIHVpbnQ2NF90IGZlYXR1cmVfbWFzaykKLXsK
LQl1aW50MzJfdCBzbXVfZmVhdHVyZXNfbG93LCBzbXVfZmVhdHVyZXNfaGlnaDsKLQlpbnQgcmV0
ID0gMDsKLQotCXNtdV9mZWF0dXJlc19sb3cgPSAodWludDMyX3QpKChmZWF0dXJlX21hc2sgJiBT
TVVfRkVBVFVSRVNfTE9XX01BU0spID4+IFNNVV9GRUFUVVJFU19MT1dfU0hJRlQpOwotCXNtdV9m
ZWF0dXJlc19oaWdoID0gKHVpbnQzMl90KSgoZmVhdHVyZV9tYXNrICYgU01VX0ZFQVRVUkVTX0hJ
R0hfTUFTSykgPj4gU01VX0ZFQVRVUkVTX0hJR0hfU0hJRlQpOwotCi0JaWYgKGVuYWJsZSkgewot
CQlyZXQgPSBzbXVfc2VuZF9zbWNfbXNnX3dpdGhfcGFyYW0oc211LCBTTVVfTVNHX0VuYWJsZVNt
dUZlYXR1cmVzTG93LAotCQkJCQkJICBzbXVfZmVhdHVyZXNfbG93KTsKLQkJaWYgKHJldCkKLQkJ
CXJldHVybiByZXQ7Ci0JCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNN
VV9NU0dfRW5hYmxlU211RmVhdHVyZXNIaWdoLAotCQkJCQkJICBzbXVfZmVhdHVyZXNfaGlnaCk7
Ci0JCWlmIChyZXQpCi0JCQlyZXR1cm4gcmV0OwotCX0gZWxzZSB7Ci0JCXJldCA9IHNtdV9zZW5k
X3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfRGlzYWJsZVNtdUZlYXR1cmVzTG93LAot
CQkJCQkJICBzbXVfZmVhdHVyZXNfbG93KTsKLQkJaWYgKHJldCkKLQkJCXJldHVybiByZXQ7Ci0J
CXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0aF9wYXJhbShzbXUsIFNNVV9NU0dfRGlzYWJsZVNt
dUZlYXR1cmVzSGlnaCwKLQkJCQkJCSAgc211X2ZlYXR1cmVzX2hpZ2gpOwotCQlpZiAocmV0KQot
CQkJcmV0dXJuIHJldDsKLQl9Ci0KLQlyZXR1cm4gMDsKLQotfQotCi1zdGF0aWMgaW50IHZlZ2Ey
MF9nZXRfcHBmZWF0dXJlX3N0YXR1cyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgY2hhciAqYnVm
KQotewotCXN0YXRpYyBjb25zdCBjaGFyICpwcGZlYXR1cmVfbmFtZVtdID0gewotCQkJCSJEUE1f
UFJFRkVUQ0hFUiIsCi0JCQkJIkdGWENMS19EUE0iLAotCQkJCSJVQ0xLX0RQTSIsCi0JCQkJIlNP
Q0NMS19EUE0iLAotCQkJCSJVVkRfRFBNIiwKLQkJCQkiVkNFX0RQTSIsCi0JCQkJIlVMViIsCi0J
CQkJIk1QMENMS19EUE0iLAotCQkJCSJMSU5LX0RQTSIsCi0JCQkJIkRDRUZDTEtfRFBNIiwKLQkJ
CQkiR0ZYQ0xLX0RTIiwKLQkJCQkiU09DQ0xLX0RTIiwKLQkJCQkiTENMS19EUyIsCi0JCQkJIlBQ
VCIsCi0JCQkJIlREQyIsCi0JCQkJIlRIRVJNQUwiLAotCQkJCSJHRlhfUEVSX0NVX0NHIiwKLQkJ
CQkiUk0iLAotCQkJCSJEQ0VGQ0xLX0RTIiwKLQkJCQkiQUNEQyIsCi0JCQkJIlZSMEhPVCIsCi0J
CQkJIlZSMUhPVCIsCi0JCQkJIkZXX0NURiIsCi0JCQkJIkxFRF9ESVNQTEFZIiwKLQkJCQkiRkFO
X0NPTlRST0wiLAotCQkJCSJHRlhfRURDIiwKLQkJCQkiR0ZYT0ZGIiwKLQkJCQkiQ0ciLAotCQkJ
CSJGQ0xLX0RQTSIsCi0JCQkJIkZDTEtfRFMiLAotCQkJCSJNUDFDTEtfRFMiLAotCQkJCSJNUDBD
TEtfRFMiLAotCQkJCSJYR01JIiwKLQkJCQkiRUNDIn07Ci0Jc3RhdGljIGNvbnN0IGNoYXIgKm91
dHB1dF90aXRsZVtdID0gewotCQkJCSJGRUFUVVJFUyIsCi0JCQkJIkJJVE1BU0siLAotCQkJCSJF
TkFCTEVNRU5UIn07Ci0JdWludDY0X3QgZmVhdHVyZXNfZW5hYmxlZDsKLQlpbnQgaTsKLQlpbnQg
cmV0ID0gMDsKLQlpbnQgc2l6ZSA9IDA7Ci0KLQlyZXQgPSB2ZWdhMjBfZ2V0X2VuYWJsZWRfc21j
X2ZlYXR1cmVzKHNtdSwgJmZlYXR1cmVzX2VuYWJsZWQpOwotCWlmIChyZXQpCi0JCXJldHVybiBy
ZXQ7Ci0KLQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIkN1cnJlbnQgcHBmZWF0dXJlczog
MHglMDE2bGx4XG4iLCBmZWF0dXJlc19lbmFibGVkKTsKLQlzaXplICs9IHNwcmludGYoYnVmICsg
c2l6ZSwgIiUtMTlzICUtMjJzICVzXG4iLAotCQkJCW91dHB1dF90aXRsZVswXSwKLQkJCQlvdXRw
dXRfdGl0bGVbMV0sCi0JCQkJb3V0cHV0X3RpdGxlWzJdKTsKLQlmb3IgKGkgPSAwOyBpIDwgR05M
RF9GRUFUVVJFU19NQVg7IGkrKykgewotCQlzaXplICs9IHNwcmludGYoYnVmICsgc2l6ZSwgIiUt
MTlzIDB4JTAxNmxseCAlNnNcbiIsCi0JCQkJCXBwZmVhdHVyZV9uYW1lW2ldLAotCQkJCQkxVUxM
IDw8IGksCi0JCQkJCShmZWF0dXJlc19lbmFibGVkICYgKDFVTEwgPDwgaSkpID8gIlkiIDogIk4i
KTsKLQl9Ci0KLQlyZXR1cm4gc2l6ZTsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfc2V0X3BwZmVh
dHVyZV9zdGF0dXMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQ2NF90IG5ld19wcGZlYXR1
cmVfbWFza3MpCi17Ci0JdWludDY0X3QgZmVhdHVyZXNfZW5hYmxlZDsKLQl1aW50NjRfdCBmZWF0
dXJlc190b19lbmFibGU7Ci0JdWludDY0X3QgZmVhdHVyZXNfdG9fZGlzYWJsZTsKLQlpbnQgcmV0
ID0gMDsKLQotCWlmIChuZXdfcHBmZWF0dXJlX21hc2tzID49ICgxVUxMIDw8IEdOTERfRkVBVFVS
RVNfTUFYKSkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlyZXQgPSB2ZWdhMjBfZ2V0X2VuYWJsZWRf
c21jX2ZlYXR1cmVzKHNtdSwgJmZlYXR1cmVzX2VuYWJsZWQpOwotCWlmIChyZXQpCi0JCXJldHVy
biByZXQ7Ci0KLQlmZWF0dXJlc190b19kaXNhYmxlID0KLQkJZmVhdHVyZXNfZW5hYmxlZCAmIH5u
ZXdfcHBmZWF0dXJlX21hc2tzOwotCWZlYXR1cmVzX3RvX2VuYWJsZSA9Ci0JCX5mZWF0dXJlc19l
bmFibGVkICYgbmV3X3BwZmVhdHVyZV9tYXNrczsKLQotCXByX2RlYnVnKCJmZWF0dXJlc190b19k
aXNhYmxlIDB4JWxseFxuIiwgZmVhdHVyZXNfdG9fZGlzYWJsZSk7Ci0JcHJfZGVidWcoImZlYXR1
cmVzX3RvX2VuYWJsZSAweCVsbHhcbiIsIGZlYXR1cmVzX3RvX2VuYWJsZSk7Ci0KLQlpZiAoZmVh
dHVyZXNfdG9fZGlzYWJsZSkgewotCQlyZXQgPSB2ZWdhMjBfZW5hYmxlX3NtY19mZWF0dXJlcyhz
bXUsIGZhbHNlLCBmZWF0dXJlc190b19kaXNhYmxlKTsKLQkJaWYgKHJldCkKLQkJCXJldHVybiBy
ZXQ7Ci0JfQotCi0JaWYgKGZlYXR1cmVzX3RvX2VuYWJsZSkgewotCQlyZXQgPSB2ZWdhMjBfZW5h
YmxlX3NtY19mZWF0dXJlcyhzbXUsIHRydWUsIGZlYXR1cmVzX3RvX2VuYWJsZSk7Ci0JCWlmIChy
ZXQpCi0JCQlyZXR1cm4gcmV0OwotCX0KLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgYm9vbCB2
ZWdhMjBfaXNfZHBtX3J1bm5pbmcoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCi17Ci0JaW50IHJl
dCA9IDA7Ci0JdWludDMyX3QgZmVhdHVyZV9tYXNrWzJdOwotCXVuc2lnbmVkIGxvbmcgZmVhdHVy
ZV9lbmFibGVkOwotCXJldCA9IHNtdV9mZWF0dXJlX2dldF9lbmFibGVkX21hc2soc211LCBmZWF0
dXJlX21hc2ssIDIpOwotCWZlYXR1cmVfZW5hYmxlZCA9ICh1bnNpZ25lZCBsb25nKSgodWludDY0
X3QpZmVhdHVyZV9tYXNrWzBdIHwKLQkJCSAgICgodWludDY0X3QpZmVhdHVyZV9tYXNrWzFdIDw8
IDMyKSk7Ci0JcmV0dXJuICEhKGZlYXR1cmVfZW5hYmxlZCAmIFNNQ19EUE1fRkVBVFVSRSk7Ci19
Ci0KLXN0YXRpYyBpbnQgdmVnYTIwX3NldF90aGVybWFsX2Zhbl90YWJsZShzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSkKLXsKLQlpbnQgcmV0OwotCXN0cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFi
bGVfY29udGV4dCA9ICZzbXUtPnNtdV90YWJsZTsKLQlQUFRhYmxlX3QgKnBwdGFibGUgPSB0YWJs
ZV9jb250ZXh0LT5kcml2ZXJfcHB0YWJsZTsKLQotCXJldCA9IHNtdV9zZW5kX3NtY19tc2dfd2l0
aF9wYXJhbShzbXUsIFNNVV9NU0dfU2V0RmFuVGVtcGVyYXR1cmVUYXJnZXQsCi0JCQkodWludDMy
X3QpcHB0YWJsZS0+RmFuVGFyZ2V0VGVtcGVyYXR1cmUpOwotCi0JcmV0dXJuIHJldDsKLX0KLQot
c3RhdGljIGludCB2ZWdhMjBfZ2V0X2Zhbl9zcGVlZF9wZXJjZW50KHN0cnVjdCBzbXVfY29udGV4
dCAqc211LAotCQkJCQl1aW50MzJfdCAqc3BlZWQpCi17Ci0JaW50IHJldCA9IDA7Ci0JdWludDMy
X3QgcGVyY2VudCA9IDA7Ci0JdWludDMyX3QgY3VycmVudF9ycG07Ci0JUFBUYWJsZV90ICpwcHRh
YmxlID0gc211LT5zbXVfdGFibGUuZHJpdmVyX3BwdGFibGU7Ci0KLQlyZXQgPSBzbXVfZ2V0X2N1
cnJlbnRfcnBtKHNtdSwgJmN1cnJlbnRfcnBtKTsKLQlwZXJjZW50ID0gY3VycmVudF9ycG0gKiAx
MDAgLyBwcHRhYmxlLT5GYW5NYXhpbXVtUnBtOwotCSpzcGVlZCA9IHBlcmNlbnQgPiAxMDAgPyAx
MDAgOiBwZXJjZW50OwotCi0JcmV0dXJuIHJldDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfZ2V0
X2dwdV9wb3dlcihzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDMyX3QgKnZhbHVlKQotewot
CWludCByZXQgPSAwOwotCVNtdU1ldHJpY3NfdCBtZXRyaWNzOwotCi0JaWYgKCF2YWx1ZSkKLQkJ
cmV0dXJuIC1FSU5WQUw7Ci0KLQlyZXQgPSB2ZWdhMjBfZ2V0X21ldHJpY3NfdGFibGUoc211LCAm
bWV0cmljcyk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKLQotCSp2YWx1ZSA9IG1ldHJpY3Mu
Q3VyclNvY2tldFBvd2VyIDw8IDg7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCB2ZWdh
MjBfZ2V0X2N1cnJlbnRfYWN0aXZpdHlfcGVyY2VudChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwK
LQkJCQkJICAgICAgIGVudW0gYW1kX3BwX3NlbnNvcnMgc2Vuc29yLAotCQkJCQkgICAgICAgdWlu
dDMyX3QgKnZhbHVlKQotewotCWludCByZXQgPSAwOwotCVNtdU1ldHJpY3NfdCBtZXRyaWNzOwot
Ci0JaWYgKCF2YWx1ZSkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlyZXQgPSB2ZWdhMjBfZ2V0X21l
dHJpY3NfdGFibGUoc211LCAmbWV0cmljcyk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKLQot
CXN3aXRjaCAoc2Vuc29yKSB7Ci0JY2FzZSBBTURHUFVfUFBfU0VOU09SX0dQVV9MT0FEOgotCQkq
dmFsdWUgPSBtZXRyaWNzLkF2ZXJhZ2VHZnhBY3Rpdml0eTsKLQkJYnJlYWs7Ci0JY2FzZSBBTURH
UFVfUFBfU0VOU09SX01FTV9MT0FEOgotCQkqdmFsdWUgPSBtZXRyaWNzLkF2ZXJhZ2VVY2xrQWN0
aXZpdHk7Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCXByX2VycigiSW52YWxpZCBzZW5zb3IgZm9y
IHJldHJpZXZpbmcgY2xvY2sgYWN0aXZpdHlcbiIpOwotCQlyZXR1cm4gLUVJTlZBTDsKLQl9Ci0K
LQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCB2ZWdhMjBfdGhlcm1hbF9nZXRfdGVtcGVyYXR1
cmUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsCi0JCQkJCSAgICAgZW51bSBhbWRfcHBfc2Vuc29y
cyBzZW5zb3IsCi0JCQkJCSAgICAgdWludDMyX3QgKnZhbHVlKQotewotCXN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2ID0gc211LT5hZGV2OwotCVNtdU1ldHJpY3NfdCBtZXRyaWNzOwotCXVpbnQz
Ml90IHRlbXAgPSAwOwotCWludCByZXQgPSAwOwotCi0JaWYgKCF2YWx1ZSkKLQkJcmV0dXJuIC1F
SU5WQUw7Ci0KLQlyZXQgPSB2ZWdhMjBfZ2V0X21ldHJpY3NfdGFibGUoc211LCAmbWV0cmljcyk7
Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKLQotCXN3aXRjaCAoc2Vuc29yKSB7Ci0JY2FzZSBB
TURHUFVfUFBfU0VOU09SX0hPVFNQT1RfVEVNUDoKLQkJdGVtcCA9IFJSRUczMl9TT0MxNShUSE0s
IDAsIG1tQ0dfTVVMVF9USEVSTUFMX1NUQVRVUyk7Ci0JCXRlbXAgPSAodGVtcCAmIENHX01VTFRf
VEhFUk1BTF9TVEFUVVNfX0NURl9URU1QX01BU0spID4+Ci0JCQkJQ0dfTVVMVF9USEVSTUFMX1NU
QVRVU19fQ1RGX1RFTVBfX1NISUZUOwotCi0JCXRlbXAgPSB0ZW1wICYgMHgxZmY7Ci0JCXRlbXAg
Kj0gU01VX1RFTVBFUkFUVVJFX1VOSVRTX1BFUl9DRU5USUdSQURFUzsKLQotCQkqdmFsdWUgPSB0
ZW1wOwotCQlicmVhazsKLQljYXNlIEFNREdQVV9QUF9TRU5TT1JfRURHRV9URU1QOgotCQkqdmFs
dWUgPSBtZXRyaWNzLlRlbXBlcmF0dXJlRWRnZSAqCi0JCQlTTVVfVEVNUEVSQVRVUkVfVU5JVFNf
UEVSX0NFTlRJR1JBREVTOwotCQlicmVhazsKLQljYXNlIEFNREdQVV9QUF9TRU5TT1JfTUVNX1RF
TVA6Ci0JCSp2YWx1ZSA9IG1ldHJpY3MuVGVtcGVyYXR1cmVIQk0gKgotCQkJU01VX1RFTVBFUkFU
VVJFX1VOSVRTX1BFUl9DRU5USUdSQURFUzsKLQkJYnJlYWs7Ci0JZGVmYXVsdDoKLQkJcHJfZXJy
KCJJbnZhbGlkIHNlbnNvciBmb3IgcmV0cmlldmluZyB0ZW1wXG4iKTsKLQkJcmV0dXJuIC1FSU5W
QUw7Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci1zdGF0aWMgaW50IHZlZ2EyMF9yZWFkX3NlbnNvcihz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKLQkJCQkgZW51bSBhbWRfcHBfc2Vuc29ycyBzZW5zb3Is
Ci0JCQkJIHZvaWQgKmRhdGEsIHVpbnQzMl90ICpzaXplKQotewotCWludCByZXQgPSAwOwotCXN0
cnVjdCBzbXVfdGFibGVfY29udGV4dCAqdGFibGVfY29udGV4dCA9ICZzbXUtPnNtdV90YWJsZTsK
LQlQUFRhYmxlX3QgKnBwdGFibGUgPSB0YWJsZV9jb250ZXh0LT5kcml2ZXJfcHB0YWJsZTsKLQot
CXN3aXRjaCAoc2Vuc29yKSB7Ci0JY2FzZSBBTURHUFVfUFBfU0VOU09SX01BWF9GQU5fUlBNOgot
CQkqKHVpbnQzMl90ICopZGF0YSA9IHBwdGFibGUtPkZhbk1heGltdW1ScG07Ci0JCSpzaXplID0g
NDsKLQkJYnJlYWs7Ci0JY2FzZSBBTURHUFVfUFBfU0VOU09SX01FTV9MT0FEOgotCWNhc2UgQU1E
R1BVX1BQX1NFTlNPUl9HUFVfTE9BRDoKLQkJcmV0ID0gdmVnYTIwX2dldF9jdXJyZW50X2FjdGl2
aXR5X3BlcmNlbnQoc211LAotCQkJCQkJc2Vuc29yLAotCQkJCQkJKHVpbnQzMl90ICopZGF0YSk7
Ci0JCSpzaXplID0gNDsKLQkJYnJlYWs7Ci0JY2FzZSBBTURHUFVfUFBfU0VOU09SX0dQVV9QT1dF
UjoKLQkJcmV0ID0gdmVnYTIwX2dldF9ncHVfcG93ZXIoc211LCAodWludDMyX3QgKilkYXRhKTsK
LQkJKnNpemUgPSA0OwotCQlicmVhazsKLQljYXNlIEFNREdQVV9QUF9TRU5TT1JfSE9UU1BPVF9U
RU1QOgotCWNhc2UgQU1ER1BVX1BQX1NFTlNPUl9FREdFX1RFTVA6Ci0JY2FzZSBBTURHUFVfUFBf
U0VOU09SX01FTV9URU1QOgotCQlyZXQgPSB2ZWdhMjBfdGhlcm1hbF9nZXRfdGVtcGVyYXR1cmUo
c211LCBzZW5zb3IsICh1aW50MzJfdCAqKWRhdGEpOwotCQkqc2l6ZSA9IDQ7Ci0JCWJyZWFrOwot
CWRlZmF1bHQ6Ci0JCXJldHVybiAtRUlOVkFMOwotCX0KLQotCXJldHVybiByZXQ7Ci19Ci0KLXN0
YXRpYyBpbnQgdmVnYTIwX3NldF93YXRlcm1hcmtzX3RhYmxlKHN0cnVjdCBzbXVfY29udGV4dCAq
c211LAotCQkJCSAgICAgICB2b2lkICp3YXRlcm1hcmtzLCBzdHJ1Y3QKLQkJCQkgICAgICAgZG1f
cHBfd21fc2V0c193aXRoX2Nsb2NrX3Jhbmdlc19zb2MxNQotCQkJCSAgICAgICAqY2xvY2tfcmFu
Z2VzKQotewotCWludCBpOwotCVdhdGVybWFya3NfdCAqdGFibGUgPSB3YXRlcm1hcmtzOwotCi0J
aWYgKCF0YWJsZSB8fCAhY2xvY2tfcmFuZ2VzKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCWlmIChj
bG9ja19yYW5nZXMtPm51bV93bV9kbWlmX3NldHMgPiA0IHx8Ci0JICAgIGNsb2NrX3Jhbmdlcy0+
bnVtX3dtX21jaWZfc2V0cyA+IDQpCi0gICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Ci0K
LSAgICAgICAgZm9yIChpID0gMDsgaSA8IGNsb2NrX3Jhbmdlcy0+bnVtX3dtX2RtaWZfc2V0czsg
aSsrKSB7Ci0JCXRhYmxlLT5XYXRlcm1hcmtSb3dbMV1baV0uTWluQ2xvY2sgPQotCQkJY3B1X3Rv
X2xlMTYoKHVpbnQxNl90KQotCQkJKGNsb2NrX3Jhbmdlcy0+d21fZG1pZl9jbG9ja3NfcmFuZ2Vz
W2ldLndtX21pbl9kY2ZjbGtfY2xrX2luX2toeiAvCi0JCQkxMDAwKSk7Ci0JCXRhYmxlLT5XYXRl
cm1hcmtSb3dbMV1baV0uTWF4Q2xvY2sgPQotCQkJY3B1X3RvX2xlMTYoKHVpbnQxNl90KQotCQkJ
KGNsb2NrX3Jhbmdlcy0+d21fZG1pZl9jbG9ja3NfcmFuZ2VzW2ldLndtX21heF9kY2ZjbGtfY2xr
X2luX2toeiAvCi0JCQkxMDAwKSk7Ci0JCXRhYmxlLT5XYXRlcm1hcmtSb3dbMV1baV0uTWluVWNs
ayA9Ci0JCQljcHVfdG9fbGUxNigodWludDE2X3QpCi0JCQkoY2xvY2tfcmFuZ2VzLT53bV9kbWlm
X2Nsb2Nrc19yYW5nZXNbaV0ud21fbWluX21lbV9jbGtfaW5fa2h6IC8KLQkJCTEwMDApKTsKLQkJ
dGFibGUtPldhdGVybWFya1Jvd1sxXVtpXS5NYXhVY2xrID0KLQkJCWNwdV90b19sZTE2KCh1aW50
MTZfdCkKLQkJCShjbG9ja19yYW5nZXMtPndtX2RtaWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9tYXhf
bWVtX2Nsa19pbl9raHogLwotCQkJMTAwMCkpOwotCQl0YWJsZS0+V2F0ZXJtYXJrUm93WzFdW2ld
LldtU2V0dGluZyA9ICh1aW50OF90KQotCQkJCWNsb2NrX3Jhbmdlcy0+d21fZG1pZl9jbG9ja3Nf
cmFuZ2VzW2ldLndtX3NldF9pZDsKLSAgICAgICAgfQotCi0JZm9yIChpID0gMDsgaSA8IGNsb2Nr
X3Jhbmdlcy0+bnVtX3dtX21jaWZfc2V0czsgaSsrKSB7Ci0JCXRhYmxlLT5XYXRlcm1hcmtSb3db
MF1baV0uTWluQ2xvY2sgPQotCQkJY3B1X3RvX2xlMTYoKHVpbnQxNl90KQotCQkJKGNsb2NrX3Jh
bmdlcy0+d21fbWNpZl9jbG9ja3NfcmFuZ2VzW2ldLndtX21pbl9zb2NjbGtfY2xrX2luX2toeiAv
Ci0JCQkxMDAwKSk7Ci0JCXRhYmxlLT5XYXRlcm1hcmtSb3dbMF1baV0uTWF4Q2xvY2sgPQotCQkJ
Y3B1X3RvX2xlMTYoKHVpbnQxNl90KQotCQkJKGNsb2NrX3Jhbmdlcy0+d21fbWNpZl9jbG9ja3Nf
cmFuZ2VzW2ldLndtX21heF9zb2NjbGtfY2xrX2luX2toeiAvCi0JCQkxMDAwKSk7Ci0JCXRhYmxl
LT5XYXRlcm1hcmtSb3dbMF1baV0uTWluVWNsayA9Ci0JCQljcHVfdG9fbGUxNigodWludDE2X3Qp
Ci0JCQkoY2xvY2tfcmFuZ2VzLT53bV9tY2lmX2Nsb2Nrc19yYW5nZXNbaV0ud21fbWluX21lbV9j
bGtfaW5fa2h6IC8KLQkJCTEwMDApKTsKLQkJdGFibGUtPldhdGVybWFya1Jvd1swXVtpXS5NYXhV
Y2xrID0KLQkJCWNwdV90b19sZTE2KCh1aW50MTZfdCkKLQkJCShjbG9ja19yYW5nZXMtPndtX21j
aWZfY2xvY2tzX3Jhbmdlc1tpXS53bV9tYXhfbWVtX2Nsa19pbl9raHogLwotCQkJMTAwMCkpOwot
CQl0YWJsZS0+V2F0ZXJtYXJrUm93WzBdW2ldLldtU2V0dGluZyA9ICh1aW50OF90KQotCQkJCWNs
b2NrX3Jhbmdlcy0+d21fbWNpZl9jbG9ja3NfcmFuZ2VzW2ldLndtX3NldF9pZDsKLSAgICAgICAg
fQotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3Qgc211X3RlbXBlcmF0dXJl
X3JhbmdlIHZlZ2EyMF90aGVybWFsX3BvbGljeVtdID0KLXsKLQl7LTI3MzE1MCwgIDk5MDAwLCA5
OTAwMCwgLTI3MzE1MCwgOTkwMDAsIDk5MDAwLCAtMjczMTUwLCA5OTAwMCwgOTkwMDB9LAotCXsg
MTIwMDAwLCAxMjAwMDAsIDEyMDAwMCwgMTIwMDAwLCAxMjAwMDAsIDEyMDAwMCwgMTIwMDAwLCAx
MjAwMDAsIDEyMDAwMH0sCi19OwotCi1zdGF0aWMgaW50IHZlZ2EyMF9nZXRfdGhlcm1hbF90ZW1w
ZXJhdHVyZV9yYW5nZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwKLQkJCQkJCXN0cnVjdCBzbXVf
dGVtcGVyYXR1cmVfcmFuZ2UqcmFuZ2UpCi17Ci0KLQlQUFRhYmxlX3QgKnBwdGFibGUgPSBzbXUt
PnNtdV90YWJsZS5kcml2ZXJfcHB0YWJsZTsKLQotCWlmICghcmFuZ2UpCi0JCXJldHVybiAtRUlO
VkFMOwotCi0JbWVtY3B5KHJhbmdlLCAmdmVnYTIwX3RoZXJtYWxfcG9saWN5WzBdLCBzaXplb2Yo
c3RydWN0IHNtdV90ZW1wZXJhdHVyZV9yYW5nZSkpOwotCi0JcmFuZ2UtPm1heCA9IHBwdGFibGUt
PlRlZGdlTGltaXQgKgotCQlTTVVfVEVNUEVSQVRVUkVfVU5JVFNfUEVSX0NFTlRJR1JBREVTOwot
CXJhbmdlLT5lZGdlX2VtZXJnZW5jeV9tYXggPSAocHB0YWJsZS0+VGVkZ2VMaW1pdCArIENURl9P
RkZTRVRfRURHRSkgKgotCQlTTVVfVEVNUEVSQVRVUkVfVU5JVFNfUEVSX0NFTlRJR1JBREVTOwot
CXJhbmdlLT5ob3RzcG90X2NyaXRfbWF4ID0gcHB0YWJsZS0+VGhvdHNwb3RMaW1pdCAqCi0JCVNN
VV9URU1QRVJBVFVSRV9VTklUU19QRVJfQ0VOVElHUkFERVM7Ci0JcmFuZ2UtPmhvdHNwb3RfZW1l
cmdlbmN5X21heCA9IChwcHRhYmxlLT5UaG90c3BvdExpbWl0ICsgQ1RGX09GRlNFVF9IT1RTUE9U
KSAqCi0JCVNNVV9URU1QRVJBVFVSRV9VTklUU19QRVJfQ0VOVElHUkFERVM7Ci0JcmFuZ2UtPm1l
bV9jcml0X21heCA9IHBwdGFibGUtPlRoYm1MaW1pdCAqCi0JCVNNVV9URU1QRVJBVFVSRV9VTklU
U19QRVJfQ0VOVElHUkFERVM7Ci0JcmFuZ2UtPm1lbV9lbWVyZ2VuY3lfbWF4ID0gKHBwdGFibGUt
PlRoYm1MaW1pdCArIENURl9PRkZTRVRfSEJNKSoKLQkJU01VX1RFTVBFUkFUVVJFX1VOSVRTX1BF
Ul9DRU5USUdSQURFUzsKLQotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3Qg
cHB0YWJsZV9mdW5jcyB2ZWdhMjBfcHB0X2Z1bmNzID0gewotCS50YWJsZXNfaW5pdCA9IHZlZ2Ey
MF90YWJsZXNfaW5pdCwKLQkuYWxsb2NfZHBtX2NvbnRleHQgPSB2ZWdhMjBfYWxsb2NhdGVfZHBt
X2NvbnRleHQsCi0JLnN0b3JlX3Bvd2VycGxheV90YWJsZSA9IHZlZ2EyMF9zdG9yZV9wb3dlcnBs
YXlfdGFibGUsCi0JLmNoZWNrX3Bvd2VycGxheV90YWJsZSA9IHZlZ2EyMF9jaGVja19wb3dlcnBs
YXlfdGFibGUsCi0JLmFwcGVuZF9wb3dlcnBsYXlfdGFibGUgPSB2ZWdhMjBfYXBwZW5kX3Bvd2Vy
cGxheV90YWJsZSwKLQkuZ2V0X3NtdV9tc2dfaW5kZXggPSB2ZWdhMjBfZ2V0X3NtdV9tc2dfaW5k
ZXgsCi0JLmdldF9zbXVfY2xrX2luZGV4ID0gdmVnYTIwX2dldF9zbXVfY2xrX2luZGV4LAotCS5n
ZXRfc211X2ZlYXR1cmVfaW5kZXggPSB2ZWdhMjBfZ2V0X3NtdV9mZWF0dXJlX2luZGV4LAotCS5n
ZXRfc211X3RhYmxlX2luZGV4ID0gdmVnYTIwX2dldF9zbXVfdGFibGVfaW5kZXgsCi0JLmdldF9z
bXVfcG93ZXJfaW5kZXggPSB2ZWdhMjBfZ2V0X3B3cl9zcmNfaW5kZXgsCi0JLmdldF93b3JrbG9h
ZF90eXBlID0gdmVnYTIwX2dldF93b3JrbG9hZF90eXBlLAotCS5ydW5fYWZsbF9idGMgPSB2ZWdh
MjBfcnVuX2J0Y19hZmxsLAotCS5nZXRfYWxsb3dlZF9mZWF0dXJlX21hc2sgPSB2ZWdhMjBfZ2V0
X2FsbG93ZWRfZmVhdHVyZV9tYXNrLAotCS5nZXRfY3VycmVudF9wb3dlcl9zdGF0ZSA9IHZlZ2Ey
MF9nZXRfY3VycmVudF9wb3dlcl9zdGF0ZSwKLQkuc2V0X2RlZmF1bHRfZHBtX3RhYmxlID0gdmVn
YTIwX3NldF9kZWZhdWx0X2RwbV90YWJsZSwKLQkuc2V0X3Bvd2VyX3N0YXRlID0gTlVMTCwKLQku
cG9wdWxhdGVfdW1kX3N0YXRlX2NsayA9IHZlZ2EyMF9wb3B1bGF0ZV91bWRfc3RhdGVfY2xrLAot
CS5wcmludF9jbGtfbGV2ZWxzID0gdmVnYTIwX3ByaW50X2Nsa19sZXZlbHMsCi0JLmZvcmNlX2Ns
a19sZXZlbHMgPSB2ZWdhMjBfZm9yY2VfY2xrX2xldmVscywKLQkuZ2V0X2Nsb2NrX2J5X3R5cGVf
d2l0aF9sYXRlbmN5ID0gdmVnYTIwX2dldF9jbG9ja19ieV90eXBlX3dpdGhfbGF0ZW5jeSwKLQku
Z2V0X29kX3BlcmNlbnRhZ2UgPSB2ZWdhMjBfZ2V0X29kX3BlcmNlbnRhZ2UsCi0JLmdldF9wb3dl
cl9wcm9maWxlX21vZGUgPSB2ZWdhMjBfZ2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZSwKLQkuc2V0X3Bv
d2VyX3Byb2ZpbGVfbW9kZSA9IHZlZ2EyMF9zZXRfcG93ZXJfcHJvZmlsZV9tb2RlLAotCS5zZXRf
b2RfcGVyY2VudGFnZSA9IHZlZ2EyMF9zZXRfb2RfcGVyY2VudGFnZSwKLQkuc2V0X2RlZmF1bHRf
b2Rfc2V0dGluZ3MgPSB2ZWdhMjBfc2V0X2RlZmF1bHRfb2Rfc2V0dGluZ3MsCi0JLm9kX2VkaXRf
ZHBtX3RhYmxlID0gdmVnYTIwX29kbl9lZGl0X2RwbV90YWJsZSwKLQkuZHBtX3NldF91dmRfZW5h
YmxlID0gdmVnYTIwX2RwbV9zZXRfdXZkX2VuYWJsZSwKLQkuZHBtX3NldF92Y2VfZW5hYmxlID0g
dmVnYTIwX2RwbV9zZXRfdmNlX2VuYWJsZSwKLQkucmVhZF9zZW5zb3IgPSB2ZWdhMjBfcmVhZF9z
ZW5zb3IsCi0JLnByZV9kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkID0gdmVnYTIwX3ByZV9kaXNwbGF5
X2NvbmZpZ19jaGFuZ2VkLAotCS5kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkID0gdmVnYTIwX2Rpc3Bs
YXlfY29uZmlnX2NoYW5nZWQsCi0JLmFwcGx5X2Nsb2Nrc19hZGp1c3RfcnVsZXMgPSB2ZWdhMjBf
YXBwbHlfY2xvY2tzX2FkanVzdF9ydWxlcywKLQkubm90aWZ5X3NtY19kaXNwYWx5X2NvbmZpZyA9
IHZlZ2EyMF9ub3RpZnlfc21jX2Rpc3BhbHlfY29uZmlnLAotCS5mb3JjZV9kcG1fbGltaXRfdmFs
dWUgPSB2ZWdhMjBfZm9yY2VfZHBtX2xpbWl0X3ZhbHVlLAotCS51bmZvcmNlX2RwbV9sZXZlbHMg
PSB2ZWdhMjBfdW5mb3JjZV9kcG1fbGV2ZWxzLAotCS5nZXRfcHJvZmlsaW5nX2Nsa19tYXNrID0g
dmVnYTIwX2dldF9wcm9maWxpbmdfY2xrX21hc2ssCi0JLnNldF9wcGZlYXR1cmVfc3RhdHVzID0g
dmVnYTIwX3NldF9wcGZlYXR1cmVfc3RhdHVzLAotCS5nZXRfcHBmZWF0dXJlX3N0YXR1cyA9IHZl
Z2EyMF9nZXRfcHBmZWF0dXJlX3N0YXR1cywKLQkuaXNfZHBtX3J1bm5pbmcgPSB2ZWdhMjBfaXNf
ZHBtX3J1bm5pbmcsCi0JLnNldF90aGVybWFsX2Zhbl90YWJsZSA9IHZlZ2EyMF9zZXRfdGhlcm1h
bF9mYW5fdGFibGUsCi0JLmdldF9mYW5fc3BlZWRfcGVyY2VudCA9IHZlZ2EyMF9nZXRfZmFuX3Nw
ZWVkX3BlcmNlbnQsCi0JLnNldF93YXRlcm1hcmtzX3RhYmxlID0gdmVnYTIwX3NldF93YXRlcm1h
cmtzX3RhYmxlLAotCS5nZXRfdGhlcm1hbF90ZW1wZXJhdHVyZV9yYW5nZSA9IHZlZ2EyMF9nZXRf
dGhlcm1hbF90ZW1wZXJhdHVyZV9yYW5nZQotfTsKLQotdm9pZCB2ZWdhMjBfc2V0X3BwdF9mdW5j
cyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkKLXsKLQlzdHJ1Y3Qgc211X3RhYmxlX2NvbnRleHQg
KnNtdV90YWJsZSA9ICZzbXUtPnNtdV90YWJsZTsKLQotCXNtdS0+cHB0X2Z1bmNzID0gJnZlZ2Ey
MF9wcHRfZnVuY3M7Ci0Jc211LT5zbWNfaWZfdmVyc2lvbiA9IFNNVTExX0RSSVZFUl9JRl9WRVJT
SU9OOwotCXNtdV90YWJsZS0+dGFibGVfY291bnQgPSBUQUJMRV9DT1VOVDsKLX0KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3ZlZ2EyMF9wcHQuaCBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvcG93ZXJwbGF5L3ZlZ2EyMF9wcHQuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMmRjMTBlNC4uMDAwMDAwMAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2Vy
cGxheS92ZWdhMjBfcHB0LmgKKysrIC9kZXYvbnVsbApAQCAtMSwxNzkgKzAsMCBAQAotLyoKLSAq
IENvcHlyaWdodCAyMDE5IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KLSAqCi0gKiBQZXJt
aXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBv
YnRhaW5pbmcgYQotICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3Vt
ZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKLSAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3
YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KLSAq
IHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmli
dXRlLCBzdWJsaWNlbnNlLAotICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwg
YW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCi0gKiBTb2Z0d2FyZSBpcyBmdXJuaXNo
ZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgotICoKLSAq
IFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNo
YWxsIGJlIGluY2x1ZGVkIGluCi0gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25z
IG9mIHRoZSBTb2Z0d2FyZS4KLSAqCi0gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElT
IiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgotICogSU1QTElFRCwg
SU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFC
SUxJVFksCi0gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklO
R0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKLSAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9S
IEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgotICogT1RIRVIg
TElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhF
UldJU0UsCi0gKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhF
IFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKLSAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FS
RS4KLSAqCi0gKi8KLSNpZm5kZWYgX19WRUdBMjBfUFBUX0hfXwotI2RlZmluZSBfX1ZFR0EyMF9Q
UFRfSF9fCi0KLSNkZWZpbmUgVkVHQTIwX1VNRF9QU1RBVEVfR0ZYQ0xLX0xFVkVMICAgICAgICAg
MHgzCi0jZGVmaW5lIFZFR0EyMF9VTURfUFNUQVRFX1NPQ0NMS19MRVZFTCAgICAgICAgIDB4Mwot
I2RlZmluZSBWRUdBMjBfVU1EX1BTVEFURV9NQ0xLX0xFVkVMICAgICAgICAgICAweDIKLSNkZWZp
bmUgVkVHQTIwX1VNRF9QU1RBVEVfVVZEQ0xLX0xFVkVMICAgICAgICAgMHgzCi0jZGVmaW5lIFZF
R0EyMF9VTURfUFNUQVRFX1ZDRU1DTEtfTEVWRUwgICAgICAgIDB4MwotCi0jZGVmaW5lIE1BWF9S
RUdVTEFSX0RQTV9OVU1CRVIgMTYKLSNkZWZpbmUgTUFYX1BDSUVfQ09ORiAyCi0KLSNkZWZpbmUg
Vk9MVEFHRV9TQ0FMRSA0Ci0jZGVmaW5lIEFWRlNfQ1VSVkUgMAotI2RlZmluZSBPRDhfSE9UQ1VS
VkVfVEVNUEVSQVRVUkUgODUKLQotI2RlZmluZSBTTVVfRkVBVFVSRVNfTE9XX01BU0sgICAgICAg
IDB4MDAwMDAwMDBGRkZGRkZGRgotI2RlZmluZSBTTVVfRkVBVFVSRVNfTE9XX1NISUZUICAgICAg
IDAKLSNkZWZpbmUgU01VX0ZFQVRVUkVTX0hJR0hfTUFTSyAgICAgICAweEZGRkZGRkZGMDAwMDAw
MDAKLSNkZWZpbmUgU01VX0ZFQVRVUkVTX0hJR0hfU0hJRlQgICAgICAzMgotCi1lbnVtIHsKLQlH
TkxEX0RQTV9QUkVGRVRDSEVSID0gMCwKLQlHTkxEX0RQTV9HRlhDTEssCi0JR05MRF9EUE1fVUNM
SywKLQlHTkxEX0RQTV9TT0NDTEssCi0JR05MRF9EUE1fVVZELAotCUdOTERfRFBNX1ZDRSwKLQlH
TkxEX1VMViwKLQlHTkxEX0RQTV9NUDBDTEssCi0JR05MRF9EUE1fTElOSywKLQlHTkxEX0RQTV9E
Q0VGQ0xLLAotCUdOTERfRFNfR0ZYQ0xLLAotCUdOTERfRFNfU09DQ0xLLAotCUdOTERfRFNfTENM
SywKLQlHTkxEX1BQVCwKLQlHTkxEX1REQywKLQlHTkxEX1RIRVJNQUwsCi0JR05MRF9HRlhfUEVS
X0NVX0NHLAotCUdOTERfUk0sCi0JR05MRF9EU19EQ0VGQ0xLLAotCUdOTERfQUNEQywKLQlHTkxE
X1ZSMEhPVCwKLQlHTkxEX1ZSMUhPVCwKLQlHTkxEX0ZXX0NURiwKLQlHTkxEX0xFRF9ESVNQTEFZ
LAotCUdOTERfRkFOX0NPTlRST0wsCi0JR05MRF9ESURULAotCUdOTERfR0ZYT0ZGLAotCUdOTERf
Q0csCi0JR05MRF9EUE1fRkNMSywKLQlHTkxEX0RTX0ZDTEssCi0JR05MRF9EU19NUDFDTEssCi0J
R05MRF9EU19NUDBDTEssCi0JR05MRF9YR01JLAotCUdOTERfRUNDLAotCi0JR05MRF9GRUFUVVJF
U19NQVgKLX07Ci0KLXN0cnVjdCB2ZWdhMjBfZHBtX2xldmVsIHsKLSAgICAgICAgYm9vbCAgICAg
ICAgICAgIGVuYWJsZWQ7Ci0gICAgICAgIHVpbnQzMl90ICAgICAgICB2YWx1ZTsKLSAgICAgICAg
dWludDMyX3QgICAgICAgIHBhcmFtMTsKLX07Ci0KLXN0cnVjdCB2ZWdhMjBfZHBtX3N0YXRlIHsK
LSAgICAgICAgdWludDMyX3QgIHNvZnRfbWluX2xldmVsOwotICAgICAgICB1aW50MzJfdCAgc29m
dF9tYXhfbGV2ZWw7Ci0gICAgICAgIHVpbnQzMl90ICBoYXJkX21pbl9sZXZlbDsKLSAgICAgICAg
dWludDMyX3QgIGhhcmRfbWF4X2xldmVsOwotfTsKLQotc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBt
X3RhYmxlIHsKLSAgICAgICAgdWludDMyX3QgICAgICAgICAgICAgICAgY291bnQ7Ci0gICAgICAg
IHN0cnVjdCB2ZWdhMjBfZHBtX3N0YXRlIGRwbV9zdGF0ZTsKLSAgICAgICAgc3RydWN0IHZlZ2Ey
MF9kcG1fbGV2ZWwgZHBtX2xldmVsc1tNQVhfUkVHVUxBUl9EUE1fTlVNQkVSXTsKLX07Ci0KLXN0
cnVjdCB2ZWdhMjBfcGNpZV90YWJsZSB7Ci0gICAgICAgIHVpbnQxNl90IGNvdW50OwotICAgICAg
ICB1aW50OF90ICBwY2llX2dlbltNQVhfUENJRV9DT05GXTsKLSAgICAgICAgdWludDhfdCAgcGNp
ZV9sYW5lW01BWF9QQ0lFX0NPTkZdOwotICAgICAgICB1aW50MzJfdCBsY2xrW01BWF9QQ0lFX0NP
TkZdOwotfTsKLQotc3RydWN0IHZlZ2EyMF9kcG1fdGFibGUgewotCXN0cnVjdCB2ZWdhMjBfc2lu
Z2xlX2RwbV90YWJsZSAgc29jX3RhYmxlOwotICAgICAgICBzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9k
cG1fdGFibGUgIGdmeF90YWJsZTsKLSAgICAgICAgc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3Rh
YmxlICBtZW1fdGFibGU7Ci0gICAgICAgIHN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAg
ZWNsa190YWJsZTsKLSAgICAgICAgc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICB2Y2xr
X3RhYmxlOwotICAgICAgICBzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgIGRjbGtfdGFi
bGU7Ci0gICAgICAgIHN0cnVjdCB2ZWdhMjBfc2luZ2xlX2RwbV90YWJsZSAgZGNlZl90YWJsZTsK
LSAgICAgICAgc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICBwaXhlbF90YWJsZTsKLSAg
ICAgICAgc3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICBkaXNwbGF5X3RhYmxlOwotICAg
ICAgICBzdHJ1Y3QgdmVnYTIwX3NpbmdsZV9kcG1fdGFibGUgIHBoeV90YWJsZTsKLSAgICAgICAg
c3RydWN0IHZlZ2EyMF9zaW5nbGVfZHBtX3RhYmxlICBmY2xrX3RhYmxlOwotICAgICAgICBzdHJ1
Y3QgdmVnYTIwX3BjaWVfdGFibGUgICAgICAgIHBjaWVfdGFibGU7Ci19OwotCi1lbnVtIE9EOF9G
RUFUVVJFX0lECi17Ci0JT0Q4X0dGWENMS19MSU1JVFMgICAgICAgICAgICAgICA9IDEgPDwgMCwK
LQlPRDhfR0ZYQ0xLX0NVUlZFICAgICAgICAgICAgICAgID0gMSA8PCAxLAotCU9EOF9VQ0xLX01B
WCAgICAgICAgICAgICAgICAgICAgPSAxIDw8IDIsCi0JT0Q4X1BPV0VSX0xJTUlUICAgICAgICAg
ICAgICAgICA9IDEgPDwgMywKLQlPRDhfQUNPVVNUSUNfTElNSVRfU0NMSyAgICAgICAgID0gMSA8
PCA0LCAgIC8vRmFuTWF4aW11bVJwbQotCU9EOF9GQU5fU1BFRURfTUlOICAgICAgICAgICAgICAg
PSAxIDw8IDUsICAgLy9GYW5NaW5pbXVtUHdtCi0JT0Q4X1RFTVBFUkFUVVJFX0ZBTiAgICAgICAg
ICAgICA9IDEgPDwgNiwgICAvL0ZhblRhcmdldFRlbXBlcmF0dXJlCi0JT0Q4X1RFTVBFUkFUVVJF
X1NZU1RFTSAgICAgICAgICA9IDEgPDwgNywgICAvL01heE9wVGVtcAotCU9EOF9NRU1PUllfVElN
SU5HX1RVTkUgICAgICAgICAgPSAxIDw8IDgsCi0JT0Q4X0ZBTl9aRVJPX1JQTV9DT05UUk9MICAg
ICAgICA9IDEgPDwgOQotfTsKLQotZW51bSBPRDhfU0VUVElOR19JRAotewotCU9EOF9TRVRUSU5H
X0dGWENMS19GTUlOID0gMCwKLQlPRDhfU0VUVElOR19HRlhDTEtfRk1BWCwKLQlPRDhfU0VUVElO
R19HRlhDTEtfRlJFUTEsCi0JT0Q4X1NFVFRJTkdfR0ZYQ0xLX1ZPTFRBR0UxLAotCU9EOF9TRVRU
SU5HX0dGWENMS19GUkVRMiwKLQlPRDhfU0VUVElOR19HRlhDTEtfVk9MVEFHRTIsCi0JT0Q4X1NF
VFRJTkdfR0ZYQ0xLX0ZSRVEzLAotCU9EOF9TRVRUSU5HX0dGWENMS19WT0xUQUdFMywKLQlPRDhf
U0VUVElOR19VQ0xLX0ZNQVgsCi0JT0Q4X1NFVFRJTkdfUE9XRVJfUEVSQ0VOVEFHRSwKLQlPRDhf
U0VUVElOR19GQU5fQUNPVVNUSUNfTElNSVQsCi0JT0Q4X1NFVFRJTkdfRkFOX01JTl9TUEVFRCwK
LQlPRDhfU0VUVElOR19GQU5fVEFSR0VUX1RFTVAsCi0JT0Q4X1NFVFRJTkdfT1BFUkFUSU5HX1RF
TVBfTUFYLAotCU9EOF9TRVRUSU5HX0FDX1RJTUlORywKLQlPRDhfU0VUVElOR19GQU5fWkVST19S
UE1fQ09OVFJPTCwKLQlPRDhfU0VUVElOR19DT1VOVAotfTsKLQotc3RydWN0IHZlZ2EyMF9vZDhf
c2luZ2xlX3NldHRpbmcgewotCXVpbnQzMl90CWZlYXR1cmVfaWQ7Ci0JaW50MzJfdAkJbWluX3Zh
bHVlOwotCWludDMyX3QJCW1heF92YWx1ZTsKLQlpbnQzMl90CQljdXJyZW50X3ZhbHVlOwotCWlu
dDMyX3QJCWRlZmF1bHRfdmFsdWU7Ci19OwotCi1zdHJ1Y3QgdmVnYTIwX29kOF9zZXR0aW5ncyB7
Ci0Jc3RydWN0IHZlZ2EyMF9vZDhfc2luZ2xlX3NldHRpbmcJb2Q4X3NldHRpbmdzX2FycmF5W09E
OF9TRVRUSU5HX0NPVU5UXTsKLQl1aW50OF90CQkJCSpvZF9mZWF0dXJlX2NhcGFiaWxpdGllczsK
LQl1aW50MzJfdAkJCSpvZF9zZXR0aW5nc19tYXg7Ci0JdWludDMyX3QJCQkqb2Rfc2V0dGluZ3Nf
bWluOwotCXZvaWQJCQkJKm9kOF9zZXR0aW5nczsKLQlib29sCQkJCW9kX2dmeGNsa191cGRhdGU7
Ci0JYm9vbAkJCQlvZF9tZW1jbGtfdXBkYXRlOwotfTsKLQotZXh0ZXJuIHZvaWQgdmVnYTIwX3Nl
dF9wcHRfZnVuY3Moc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpOwotCi0jZW5kaWYKLS0gCjIuNy40
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4
IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
