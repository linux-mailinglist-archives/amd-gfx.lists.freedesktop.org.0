Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6F1CBDAFD7
	for <lists+amd-gfx@lfdr.de>; Thu, 17 Oct 2019 16:22:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BE8576EAAD;
	Thu, 17 Oct 2019 14:22:12 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM02-BL2-obe.outbound.protection.outlook.com
 (mail-eopbgr750079.outbound.protection.outlook.com [40.107.75.79])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D62B06EAAD
 for <amd-gfx@lists.freedesktop.org>; Thu, 17 Oct 2019 14:22:11 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=KX66Hr/Uq4lanPb7itdEAeGjP9l7IkwTM2qHLrxEclqAB7ElqFFTp8evyHEi6wvHEAzEzcvck3KKN3kPUEyIuA6vZ3MQQmGRkhaW39ZA5yvrAZxbg2GxMQJcc8fuRyTyLBQ02mPhj6WhDsRXSEYTrKNQPPxLBwEHIv+Eys+DD7TtcqDv8URK10gPNGQdQOtLLv7ZUfDBoCCHny1lb8VCOD8UXIjLMmlqNdNZL8LnvlN9fS9btmp1jVnrwDyA8o6xRhltpGcufrfkcOe8t2cGxdmQOyngKMsvAUVtf05v21eEog4/+K2ZaCqw+6HQIof6HaBaH3lQKtBGCr1JjCtQuA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=eNh2s872pFs8ewNfFlWZx8kZk4455RiTG8gcM+l8Hog=;
 b=oQ8uH18AcWMjkK6leSAH0KQsNCeczCB1Jqhzd1WOLja4DbL0K4PDkEeEvM4Uqc59oNHwkeMTOco97R3uQrRKwcz3ecBGs0WliACRMbTZ/c67SQW3w0xI87MsJYQwCygIk/yzlbXb5EQP4Caxcn057jSFHS5yBexEyI3mzQUtq+SsAgIPAUVooW7yiKNRv765+J+YXl8JhGhXbNs07iAfaaEdQhnAG9JrvjjzXQSoQpT17CtS7r+Xelg4p2rDTVKPiLcSsdmI8054x0b1Pswzv93SQDOeYTuv8jnXq3avzuCDKvbJuufoI/EWIMezqmX61XWvPzO4HEyfuGQy6fapEA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from MWHPR12MB1453.namprd12.prod.outlook.com (10.172.55.22) by
 MWHPR12MB1709.namprd12.prod.outlook.com (10.175.54.148) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2347.16; Thu, 17 Oct 2019 14:22:08 +0000
Received: from MWHPR12MB1453.namprd12.prod.outlook.com
 ([fe80::3963:88a3:88f1:4a1d]) by MWHPR12MB1453.namprd12.prod.outlook.com
 ([fe80::3963:88a3:88f1:4a1d%4]) with mapi id 15.20.2347.023; Thu, 17 Oct 2019
 14:22:08 +0000
From: "Grodzovsky, Andrey" <Andrey.Grodzovsky@amd.com>
To: "Quan, Evan" <Evan.Quan@amd.com>, "amd-gfx@lists.freedesktop.org"
 <amd-gfx@lists.freedesktop.org>
Subject: Re: [PATCH] drm/amd/powerplay: add lock protection for swSMU APIs
Thread-Topic: [PATCH] drm/amd/powerplay: add lock protection for swSMU APIs
Thread-Index: AQHVhJ7FlmM4UII0ZkOOWAgJrddWNade40KA
Date: Thu, 17 Oct 2019 14:22:08 +0000
Message-ID: <5f926214-e197-3f79-e969-81ab9dfbe4e1@amd.com>
References: <20191017035532.24894-1-evan.quan@amd.com>
In-Reply-To: <20191017035532.24894-1-evan.quan@amd.com>
Accept-Language: en-GB, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: YT1PR01CA0002.CANPRD01.PROD.OUTLOOK.COM (2603:10b6:b01::15)
 To MWHPR12MB1453.namprd12.prod.outlook.com
 (2603:10b6:301:e::22)
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [165.204.55.251]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 7b53db7d-d47c-41e1-4131-08d7530d6419
x-ms-office365-filtering-ht: Tenant
x-ms-traffictypediagnostic: MWHPR12MB1709:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <MWHPR12MB1709475618DF1B1D4761C235EA6D0@MWHPR12MB1709.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:5236;
x-forefront-prvs: 01930B2BA8
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(366004)(39860400002)(346002)(136003)(396003)(376002)(199004)(189003)(186003)(26005)(14444005)(316002)(66066001)(6116002)(446003)(256004)(102836004)(3846002)(305945005)(476003)(53546011)(478600001)(2616005)(7736002)(110136005)(14454004)(6506007)(386003)(486006)(6486002)(8936002)(2906002)(99286004)(5660300002)(52116002)(86362001)(229853002)(31696002)(6436002)(76176011)(11346002)(31686004)(2501003)(30864003)(25786009)(6246003)(66556008)(64756008)(66446008)(36756003)(8676002)(81156014)(81166006)(66946007)(6512007)(71200400001)(66574012)(71190400001)(66476007)(579004)(569006);
 DIR:OUT; SFP:1101; SCL:1; SRVR:MWHPR12MB1709;
 H:MWHPR12MB1453.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: UcFBKNyC0YBdFB1/z/kxQC8CYPgB52S/Ri9xJIK1eoKGMtECOzkGvZsDbTCwBqoGGfd4c4I/Yvsp5kI1YrLebZNmN4pOxnDRqCsQobIeLmBkSn64pw+ax5Cv0p3iGLw5RkTh4Ef92BYxIrDj09FwNf/seIcICfC2zVHydLiV8Qah5mW+O4w/vZm7rp8PuGK4Nu2yXWTOPbF8yZVd8CtOj7gmbpKQcVlyequF4JCqAITXcYKld9pXVW2lFCCjRa8QcSknSyesw+/d51IVafjl7ap9QhK2p+rU5Q5QrZVJNuiQcD06lKIdmCgXeXw34cptgs9iGpTENiH9Wv47iZrse6PgrOgHMw06CWUAkCPwJ0V56epcfwLnXjo1aVkpPRiij9DxRIdu4lnyjuOj1LFWu1IqB1k4L2C4v7OHDQWn5rw=
Content-ID: <EF646916F53D3F4ABDD98C3F559CC129@namprd12.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 7b53db7d-d47c-41e1-4131-08d7530d6419
X-MS-Exchange-CrossTenant-originalarrivaltime: 17 Oct 2019 14:22:08.1538 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: fynYwBllTzDEoayTFf2Ncc2KYhfrk/nUVbP33l4Um6kFivmG/cKdf3uGpKkiL7Ed0PlRKaTgM17LT/GR7XwNIA==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MWHPR12MB1709
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=eNh2s872pFs8ewNfFlWZx8kZk4455RiTG8gcM+l8Hog=;
 b=hx0uDE9JZ3oAE98bVmMc5VgT+0mgok8tssh5mv/oaP9Or8O5CbV98a2RXvwad9JsZ9aEwF7RH+3Vz0xUxJ3m81LzV41wYemVyvqT3mr6+kXU9WBs9yGy7UHW28zrRPARA/TqVmKrLHGhVfBD4I90D4jRJTcBBa6Oodq2agTyJiI=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Andrey.Grodzovsky@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

DQpPbiAxMC8xNi8xOSAxMTo1NSBQTSwgUXVhbiwgRXZhbiB3cm90ZToNCj4gVGhpcyBpcyBhIHF1
aWNrIGFuZCBsb3cgcmlzayBmaXguIFRob3NlIEFQSXMgd2hpY2gNCj4gYXJlIGV4cG9zZWQgdG8g
b3RoZXIgSVBzIG9yIHRvIHN1cHBvcnQgc3lzZnMvaHdtb24NCj4gaW50ZXJmYWNlcyBvciBEQUwg
d2lsbCBoYXZlIGxvY2sgcHJvdGVjdGlvbi4gTWVhbndoaWxlDQo+IG5vIGxvY2sgcHJvdGVjdGlv
biBpcyBlbmZvcmNlZCBmb3Igc3dTTVUgaW50ZXJuYWwgdXNlZA0KPiBBUElzLiBGdXR1cmUgb3B0
aW1pemF0aW9uIGlzIG5lZWRlZC4NCg0KDQpEb2VzIGl0IG1lYW4gdGhhdCB0aGVyZSBpcyBzdGls
bCByaXNrIG9mIGNvbGxpc2lvbiBvbiBTTVUgYWNjZXNzIGJldHdlZW4gDQpleHRlcm5hbCBBUEkg
ZnVuY3Rpb24gdG8gaW50ZXJuYWwgb25lID8NCg0KQW5kcmV5DQoNCg0KPg0KPiBDaGFuZ2UtSWQ6
IEk4MzkyNjUyYzlkYTE1NzRhODVhY2Q5YjE3MWYwNDM4MGYzNjMwODUyDQo+IFNpZ25lZC1vZmYt
Ynk6IEV2YW4gUXVhbiA8ZXZhbi5xdWFuQGFtZC5jb20+DQo+IC0tLQ0KPiAgIGRyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0uYyAgICAgICB8ICAgNiArLQ0KPiAgIGRyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0uaCAgICAgICB8ICAgNiAtDQo+ICAgZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BtLmMgICAgICAgIHwgIDIzICstDQo+ICAgLi4u
L2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG1fcHBfc211LmMgIHwgICA0ICstDQo+ICAg
ZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jICAgIHwgNjg0ICsrKysr
KysrKysrKysrKystLQ0KPiAgIC4uLi9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5jL2FtZGdwdV9z
bXUuaCAgICB8IDE2MyArKystLQ0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25h
dmkxMF9wcHQuYyAgICB8ICAxNSArLQ0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5
L3Jlbm9pcl9wcHQuYyAgICB8ICAxMiArLQ0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJw
bGF5L3NtdV92MTFfMC5jICAgICB8ICAgNyArLQ0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvcG93
ZXJwbGF5L3ZlZ2EyMF9wcHQuYyAgICB8ICAgNiArLQ0KPiAgIDEwIGZpbGVzIGNoYW5nZWQsIDc3
MyBpbnNlcnRpb25zKCspLCAxNTMgZGVsZXRpb25zKC0pDQo+DQo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHBtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfZHBtLmMNCj4gaW5kZXggMjYzMjY1MjQ1ZTE5Li4yOGQzMjcyNTI4NWIg
MTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0uYw0K
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHBtLmMNCj4gQEAgLTkx
Miw3ICs5MTIsOCBAQCBpbnQgYW1kZ3B1X2RwbV9nZXRfc2NsayhzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwgYm9vbCBsb3cpDQo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgew0K
PiAgIAkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZSgmYWRldi0+c211LCBTTVVfR0ZYQ0xL
LA0KPiAgIAkJCQkJICAgICBsb3cgPyAmY2xrX2ZyZXEgOiBOVUxMLA0KPiAtCQkJCQkgICAgICFs
b3cgPyAmY2xrX2ZyZXEgOiBOVUxMKTsNCj4gKwkJCQkJICAgICAhbG93ID8gJmNsa19mcmVxIDog
TlVMTCwNCj4gKwkJCQkJICAgICB0cnVlKTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJcmV0dXJu
IDA7DQo+ICAgCQlyZXR1cm4gY2xrX2ZyZXEgKiAxMDA7DQo+IEBAIC05MzAsNyArOTMxLDggQEAg
aW50IGFtZGdwdV9kcG1fZ2V0X21jbGsoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIGJvb2wg
bG93KQ0KPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsNCj4gICAJCXJldCA9IHNt
dV9nZXRfZHBtX2ZyZXFfcmFuZ2UoJmFkZXYtPnNtdSwgU01VX1VDTEssDQo+ICAgCQkJCQkgICAg
IGxvdyA/ICZjbGtfZnJlcSA6IE5VTEwsDQo+IC0JCQkJCSAgICAgIWxvdyA/ICZjbGtfZnJlcSA6
IE5VTEwpOw0KPiArCQkJCQkgICAgICFsb3cgPyAmY2xrX2ZyZXEgOiBOVUxMLA0KPiArCQkJCQkg
ICAgIHRydWUpOw0KPiAgIAkJaWYgKHJldCkNCj4gICAJCQlyZXR1cm4gMDsNCj4gICAJCXJldHVy
biBjbGtfZnJlcSAqIDEwMDsNCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9kcG0uaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0u
aA0KPiBpbmRleCAxYzVjMGZkNzZkYmYuLjJjZmI2NzcyNzJhZiAxMDA2NDQNCj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5oDQo+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0uaA0KPiBAQCAtMjk4LDEyICsyOTgsNiBAQCBlbnVt
IGFtZGdwdV9wY2llX2dlbiB7DQo+ICAgI2RlZmluZSBhbWRncHVfZHBtX2dldF9jdXJyZW50X3Bv
d2VyX3N0YXRlKGFkZXYpIFwNCj4gICAJCSgoYWRldiktPnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0
X2N1cnJlbnRfcG93ZXJfc3RhdGUoKGFkZXYpLT5wb3dlcnBsYXkucHBfaGFuZGxlKSkNCj4gICAN
Cj4gLSNkZWZpbmUgYW1kZ3B1X3NtdV9nZXRfY3VycmVudF9wb3dlcl9zdGF0ZShhZGV2KSBcDQo+
IC0JCSgoYWRldiktPnNtdS5wcHRfZnVuY3MtPmdldF9jdXJyZW50X3Bvd2VyX3N0YXRlKCYoKGFk
ZXYpLT5zbXUpKSkNCj4gLQ0KPiAtI2RlZmluZSBhbWRncHVfc211X3NldF9wb3dlcl9zdGF0ZShh
ZGV2KSBcDQo+IC0JCSgoYWRldiktPnNtdS5wcHRfZnVuY3MtPnNldF9wb3dlcl9zdGF0ZSgmKChh
ZGV2KS0+c211KSkpDQo+IC0NCj4gICAjZGVmaW5lIGFtZGdwdV9kcG1fZ2V0X3BwX251bV9zdGF0
ZXMoYWRldiwgZGF0YSkgXA0KPiAgIAkJKChhZGV2KS0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRf
cHBfbnVtX3N0YXRlcygoYWRldiktPnBvd2VycGxheS5wcF9oYW5kbGUsIGRhdGEpKQ0KPiAgIA0K
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BtLmMgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uYw0KPiBpbmRleCBjNTBkNWYxZTc1
ZTUuLjM2ZjM2YjM1MDAwZCAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3BtLmMNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3BtLmMNCj4gQEAgLTIxMSw3ICsyMTEsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X2Rw
bV9zdGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+ICAgDQo+ICAgCWlmIChpc19zdXBwb3J0X3N3
X3NtdShhZGV2KSkgew0KPiAgIAkJaWYgKGFkZXYtPnNtdS5wcHRfZnVuY3MtPmdldF9jdXJyZW50
X3Bvd2VyX3N0YXRlKQ0KPiAtCQkJcG0gPSBhbWRncHVfc211X2dldF9jdXJyZW50X3Bvd2VyX3N0
YXRlKGFkZXYpOw0KPiArCQkJcG0gPSBzbXVfZ2V0X2N1cnJlbnRfcG93ZXJfc3RhdGUoJmFkZXYt
PnNtdSk7DQo+ICAgCQllbHNlDQo+ICAgCQkJcG0gPSBhZGV2LT5wbS5kcG0udXNlcl9zdGF0ZTsN
Cj4gICAJfSBlbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9jdXJyZW50X3Bv
d2VyX3N0YXRlKSB7DQo+IEBAIC05NTcsNyArOTU3LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X3NldF9wcF9kcG1fc2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+ICAgCQlyZXR1cm4gcmV0Ow0K
PiAgIA0KPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpDQo+IC0JCXJldCA9IHNtdV9m
b3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9TQ0xLLCBtYXNrKTsNCj4gKwkJcmV0ID0g
c211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX1NDTEssIG1hc2ssIHRydWUpOw0K
PiAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNlX2Nsb2NrX2xldmVs
KQ0KPiAgIAkJcmV0ID0gYW1kZ3B1X2RwbV9mb3JjZV9jbG9ja19sZXZlbChhZGV2LCBQUF9TQ0xL
LCBtYXNrKTsNCj4gICANCj4gQEAgLTEwMDQsNyArMTAwNCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9zZXRfcHBfZHBtX21jbGsoc3RydWN0IGRldmljZSAqZGV2LA0KPiAgIAkJcmV0dXJuIHJl
dDsNCj4gICANCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPiAtCQlyZXQgPSBz
bXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfTUNMSywgbWFzayk7DQo+ICsJCXJl
dCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9NQ0xLLCBtYXNrLCB0cnVl
KTsNCj4gICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5mb3JjZV9jbG9ja19s
ZXZlbCkNCj4gICAJCXJldCA9IGFtZGdwdV9kcG1fZm9yY2VfY2xvY2tfbGV2ZWwoYWRldiwgUFBf
TUNMSywgbWFzayk7DQo+ICAgDQo+IEBAIC0xMDQ0LDcgKzEwNDQsNyBAQCBzdGF0aWMgc3NpemVf
dCBhbWRncHVfc2V0X3BwX2RwbV9zb2NjbGsoc3RydWN0IGRldmljZSAqZGV2LA0KPiAgIAkJcmV0
dXJuIHJldDsNCj4gICANCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPiAtCQly
ZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfU09DQ0xLLCBtYXNrKTsN
Cj4gKwkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX1NPQ0NMSywg
bWFzaywgdHJ1ZSk7DQo+ICAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Zm9y
Y2VfY2xvY2tfbGV2ZWwpDQo+ICAgCQlyZXQgPSBhbWRncHVfZHBtX2ZvcmNlX2Nsb2NrX2xldmVs
KGFkZXYsIFBQX1NPQ0NMSywgbWFzayk7DQo+ICAgDQo+IEBAIC0xMDg0LDcgKzEwODQsNyBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9mY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwN
Cj4gICAJCXJldHVybiByZXQ7DQo+ICAgDQo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2
KSkNCj4gLQkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX0ZDTEss
IG1hc2spOw0KPiArCQlyZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVf
RkNMSywgbWFzaywgdHJ1ZSk7DQo+ICAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5j
cy0+Zm9yY2VfY2xvY2tfbGV2ZWwpDQo+ICAgCQlyZXQgPSBhbWRncHVfZHBtX2ZvcmNlX2Nsb2Nr
X2xldmVsKGFkZXYsIFBQX0ZDTEssIG1hc2spOw0KPiAgIA0KPiBAQCAtMTEyNCw3ICsxMTI0LDcg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fZGNlZmNsayhzdHJ1Y3QgZGV2aWNl
ICpkZXYsDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19z
bXUoYWRldikpDQo+IC0JCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNN
VV9EQ0VGQ0xLLCBtYXNrKTsNCj4gKwkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYt
PnNtdSwgU01VX0RDRUZDTEssIG1hc2ssIHRydWUpOw0KPiAgIAllbHNlIGlmIChhZGV2LT5wb3dl
cnBsYXkucHBfZnVuY3MtPmZvcmNlX2Nsb2NrX2xldmVsKQ0KPiAgIAkJcmV0ID0gYW1kZ3B1X2Rw
bV9mb3JjZV9jbG9ja19sZXZlbChhZGV2LCBQUF9EQ0VGQ0xLLCBtYXNrKTsNCj4gICANCj4gQEAg
LTExNjQsNyArMTE2NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3BjaWUo
c3RydWN0IGRldmljZSAqZGV2LA0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gICAJaWYgKGlz
X3N1cHBvcnRfc3dfc211KGFkZXYpKQ0KPiAtCQlyZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygm
YWRldi0+c211LCBTTVVfUENJRSwgbWFzayk7DQo+ICsJCXJldCA9IHNtdV9mb3JjZV9jbGtfbGV2
ZWxzKCZhZGV2LT5zbXUsIFNNVV9QQ0lFLCBtYXNrLCB0cnVlKTsNCj4gICAJZWxzZSBpZiAoYWRl
di0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5mb3JjZV9jbG9ja19sZXZlbCkNCj4gICAJCXJldCA9IGFt
ZGdwdV9kcG1fZm9yY2VfY2xvY2tfbGV2ZWwoYWRldiwgUFBfUENJRSwgbWFzayk7DQo+ICAgDQo+
IEBAIC0xMzU2LDcgKzEzNTYsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX3Bvd2Vy
X3Byb2ZpbGVfbW9kZShzdHJ1Y3QgZGV2aWNlICpkZXYsDQo+ICAgCX0NCj4gICAJcGFyYW1ldGVy
W3BhcmFtZXRlcl9zaXplXSA9IHByb2ZpbGVfbW9kZTsNCj4gICAJaWYgKGlzX3N1cHBvcnRfc3df
c211KGFkZXYpKQ0KPiAtCQlyZXQgPSBzbXVfc2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZSgmYWRldi0+
c211LCBwYXJhbWV0ZXIsIHBhcmFtZXRlcl9zaXplKTsNCj4gKwkJcmV0ID0gc211X3NldF9wb3dl
cl9wcm9maWxlX21vZGUoJmFkZXYtPnNtdSwgcGFyYW1ldGVyLCBwYXJhbWV0ZXJfc2l6ZSwgdHJ1
ZSk7DQo+ICAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+c2V0X3Bvd2VyX3By
b2ZpbGVfbW9kZSkNCj4gICAJCXJldCA9IGFtZGdwdV9kcG1fc2V0X3Bvd2VyX3Byb2ZpbGVfbW9k
ZShhZGV2LCBwYXJhbWV0ZXIsIHBhcmFtZXRlcl9zaXplKTsNCj4gICAJaWYgKCFyZXQpDQo+IEBA
IC0yMDY1LDcgKzIwNjUsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19wb3dl
cl9jYXBfbWF4KHN0cnVjdCBkZXZpY2UgKmRldiwNCj4gICAJdWludDMyX3QgbGltaXQgPSAwOw0K
PiAgIA0KPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsNCj4gLQkJc211X2dldF9w
b3dlcl9saW1pdCgmYWRldi0+c211LCAmbGltaXQsIHRydWUpOw0KPiArCQlzbXVfZ2V0X3Bvd2Vy
X2xpbWl0KCZhZGV2LT5zbXUsICZsaW1pdCwgdHJ1ZSwgdHJ1ZSk7DQo+ICAgCQlyZXR1cm4gc25w
cmludGYoYnVmLCBQQUdFX1NJWkUsICIldVxuIiwgbGltaXQgKiAxMDAwMDAwKTsNCj4gICAJfSBl
bHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MgJiYgYWRldi0+cG93ZXJwbGF5LnBwX2Z1
bmNzLT5nZXRfcG93ZXJfbGltaXQpIHsNCj4gICAJCWFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+
Z2V0X3Bvd2VyX2xpbWl0KGFkZXYtPnBvd2VycGxheS5wcF9oYW5kbGUsICZsaW1pdCwgdHJ1ZSk7
DQo+IEBAIC0yMDgzLDcgKzIwODMsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hv
d19wb3dlcl9jYXAoc3RydWN0IGRldmljZSAqZGV2LA0KPiAgIAl1aW50MzJfdCBsaW1pdCA9IDA7
DQo+ICAgDQo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgew0KPiAtCQlzbXVfZ2V0
X3Bvd2VyX2xpbWl0KCZhZGV2LT5zbXUsICZsaW1pdCwgZmFsc2UpOw0KPiArCQlzbXVfZ2V0X3Bv
d2VyX2xpbWl0KCZhZGV2LT5zbXUsICZsaW1pdCwgZmFsc2UsICB0cnVlKTsNCj4gICAJCXJldHVy
biBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIiV1XG4iLCBsaW1pdCAqIDEwMDAwMDApOw0KPiAg
IAl9IGVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcyAmJiBhZGV2LT5wb3dlcnBsYXku
cHBfZnVuY3MtPmdldF9wb3dlcl9saW1pdCkgew0KPiAgIAkJYWRldi0+cG93ZXJwbGF5LnBwX2Z1
bmNzLT5nZXRfcG93ZXJfbGltaXQoYWRldi0+cG93ZXJwbGF5LnBwX2hhbmRsZSwgJmxpbWl0LCBm
YWxzZSk7DQo+IEBAIC0zMDY0LDcgKzMwNjQsOCBAQCB2b2lkIGFtZGdwdV9wbV9jb21wdXRlX2Ns
b2NrcyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikNCj4gICAJCXN0cnVjdCBzbXVfZHBtX2Nv
bnRleHQgKnNtdV9kcG0gPSAmYWRldi0+c211LnNtdV9kcG07DQo+ICAgCQlzbXVfaGFuZGxlX3Rh
c2soJmFkZXYtPnNtdSwNCj4gICAJCQkJc211X2RwbS0+ZHBtX2xldmVsLA0KPiAtCQkJCUFNRF9Q
UF9UQVNLX0RJU1BMQVlfQ09ORklHX0NIQU5HRSk7DQo+ICsJCQkJQU1EX1BQX1RBU0tfRElTUExB
WV9DT05GSUdfQ0hBTkdFLA0KPiArCQkJCXRydWUpOw0KPiAgIAl9IGVsc2Ugew0KPiAgIAkJaWYg
KGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+ZGlzcGF0Y2hfdGFza3MpIHsNCj4gICAJCQlpZiAo
IWFtZGdwdV9kZXZpY2VfaGFzX2RjX3N1cHBvcnQoYWRldikpIHsNCj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX3BwX3NtdS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG1fcHBfc211LmMN
Cj4gaW5kZXggMTM1MjAxOTY0OGMwLi5lZTk5MTVkNjFjZjEgMTAwNjQ0DQo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX3BwX3NtdS5jDQo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtX3BwX3Nt
dS5jDQo+IEBAIC04NzYsNyArODc2LDcgQEAgZW51bSBwcF9zbXVfc3RhdHVzIHBwX252X2dldF9t
YXhpbXVtX3N1c3RhaW5hYmxlX2Nsb2NrcygNCj4gICAJaWYgKCFzbXUtPmZ1bmNzLT5nZXRfbWF4
X3N1c3RhaW5hYmxlX2Nsb2Nrc19ieV9kYykNCj4gICAJCXJldHVybiBQUF9TTVVfUkVTVUxUX1VO
U1VQUE9SVEVEOw0KPiAgIA0KPiAtCWlmICghc211LT5mdW5jcy0+Z2V0X21heF9zdXN0YWluYWJs
ZV9jbG9ja3NfYnlfZGMoc211LCBtYXhfY2xvY2tzKSkNCj4gKwlpZiAoIXNtdV9nZXRfbWF4X3N1
c3RhaW5hYmxlX2Nsb2Nrc19ieV9kYyhzbXUsIG1heF9jbG9ja3MpKQ0KPiAgIAkJcmV0dXJuIFBQ
X1NNVV9SRVNVTFRfT0s7DQo+ICAgDQo+ICAgCXJldHVybiBQUF9TTVVfUkVTVUxUX0ZBSUw7DQo+
IEBAIC04OTUsNyArODk1LDcgQEAgZW51bSBwcF9zbXVfc3RhdHVzIHBwX252X2dldF91Y2xrX2Rw
bV9zdGF0ZXMoc3RydWN0IHBwX3NtdSAqcHAsDQo+ICAgCWlmICghc211LT5wcHRfZnVuY3MtPmdl
dF91Y2xrX2RwbV9zdGF0ZXMpDQo+ICAgCQlyZXR1cm4gUFBfU01VX1JFU1VMVF9VTlNVUFBPUlRF
RDsNCj4gICANCj4gLQlpZiAoIXNtdS0+cHB0X2Z1bmNzLT5nZXRfdWNsa19kcG1fc3RhdGVzKHNt
dSwNCj4gKwlpZiAoIXNtdV9nZXRfdWNsa19kcG1fc3RhdGVzKHNtdSwNCj4gICAJCQljbG9ja192
YWx1ZXNfaW5fa2h6LCBudW1fc3RhdGVzKSkNCj4gICAJCXJldHVybiBQUF9TTVVfUkVTVUxUX09L
Ow0KPiAgIA0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1k
Z3B1X3NtdS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jDQo+
IGluZGV4IDI2Y2FjYzg5OWRmZS4uZGEzZWI4ZTQ3MTJiIDEwMDY0NA0KPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL3Bvd2VycGxheS9hbWRncHVfc211LmMNCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jDQo+IEBAIC02Nyw2ICs2Nyw4IEBAIHNpemVf
dCBzbXVfc3lzX2dldF9wcF9mZWF0dXJlX21hc2soc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGNo
YXIgKmJ1ZikNCj4gICAJdWludDMyX3Qgc29ydF9mZWF0dXJlW1NNVV9GRUFUVVJFX0NPVU5UXTsN
Cj4gICAJdWludDY0X3QgaHdfZmVhdHVyZV9jb3VudCA9IDA7DQo+ICAgDQo+ICsJbXV0ZXhfbG9j
aygmc211LT5tdXRleCk7DQo+ICsNCj4gICAJcmV0ID0gc211X2ZlYXR1cmVfZ2V0X2VuYWJsZWRf
bWFzayhzbXUsIGZlYXR1cmVfbWFzaywgMik7DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlnb3RvIGZh
aWxlZDsNCj4gQEAgLTkyLDYgKzk0LDggQEAgc2l6ZV90IHNtdV9zeXNfZ2V0X3BwX2ZlYXR1cmVf
bWFzayhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgY2hhciAqYnVmKQ0KPiAgIAl9DQo+ICAgDQo+
ICAgZmFpbGVkOg0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gICAJcmV0
dXJuIHNpemU7DQo+ICAgfQ0KPiAgIA0KPiBAQCAtMTQ5LDkgKzE1MywxMSBAQCBpbnQgc211X3N5
c19zZXRfcHBfZmVhdHVyZV9tYXNrKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1aW50NjRfdCBu
ZXdfbWFzaykNCj4gICAJdWludDY0X3QgZmVhdHVyZV8yX2Rpc2FibGVkID0gMDsNCj4gICAJdWlu
dDY0X3QgZmVhdHVyZV9lbmFibGVzID0gMDsNCj4gICANCj4gKwltdXRleF9sb2NrKCZzbXUtPm11
dGV4KTsNCj4gKw0KPiAgIAlyZXQgPSBzbXVfZmVhdHVyZV9nZXRfZW5hYmxlZF9tYXNrKHNtdSwg
ZmVhdHVyZV9tYXNrLCAyKTsNCj4gICAJaWYgKHJldCkNCj4gLQkJcmV0dXJuIHJldDsNCj4gKwkJ
Z290byBvdXQ7DQo+ICAgDQo+ICAgCWZlYXR1cmVfZW5hYmxlcyA9ICgodWludDY0X3QpZmVhdHVy
ZV9tYXNrWzFdIDw8IDMyIHwgKHVpbnQ2NF90KWZlYXR1cmVfbWFza1swXSk7DQo+ICAgDQo+IEBA
IC0xNjEsMTQgKzE2NywxNyBAQCBpbnQgc211X3N5c19zZXRfcHBfZmVhdHVyZV9tYXNrKHN0cnVj
dCBzbXVfY29udGV4dCAqc211LCB1aW50NjRfdCBuZXdfbWFzaykNCj4gICAJaWYgKGZlYXR1cmVf
Ml9lbmFibGVkKSB7DQo+ICAgCQlyZXQgPSBzbXVfZmVhdHVyZV91cGRhdGVfZW5hYmxlX3N0YXRl
KHNtdSwgZmVhdHVyZV8yX2VuYWJsZWQsIHRydWUpOw0KPiAgIAkJaWYgKHJldCkNCj4gLQkJCXJl
dHVybiByZXQ7DQo+ICsJCQlnb3RvIG91dDsNCj4gICAJfQ0KPiAgIAlpZiAoZmVhdHVyZV8yX2Rp
c2FibGVkKSB7DQo+ICAgCQlyZXQgPSBzbXVfZmVhdHVyZV91cGRhdGVfZW5hYmxlX3N0YXRlKHNt
dSwgZmVhdHVyZV8yX2Rpc2FibGVkLCBmYWxzZSk7DQo+ICAgCQlpZiAocmV0KQ0KPiAtCQkJcmV0
dXJuIHJldDsNCj4gKwkJCWdvdG8gb3V0Ow0KPiAgIAl9DQo+ICAgDQo+ICtvdXQ6DQo+ICsJbXV0
ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAgIAlyZXR1cm4gcmV0Ow0KPiAgIH0NCj4g
ICANCj4gQEAgLTI1NCw3ICsyNjMsNyBAQCBpbnQgc211X3NldF9oYXJkX2ZyZXFfcmFuZ2Uoc3Ry
dWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0gc211X2Nsa190eXBlIGNsa190eXBlLA0KPiAgIH0N
Cj4gICANCj4gICBpbnQgc211X2dldF9kcG1fZnJlcV9yYW5nZShzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSwgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsDQo+IC0JCQkgICB1aW50MzJfdCAqbWlu
LCB1aW50MzJfdCAqbWF4KQ0KPiArCQkJICAgdWludDMyX3QgKm1pbiwgdWludDMyX3QgKm1heCwg
Ym9vbCBsb2NrX25lZWRlZCkNCj4gICB7DQo+ICAgCXVpbnQzMl90IGNsb2NrX2xpbWl0Ow0KPiAg
IAlpbnQgcmV0ID0gMDsNCj4gQEAgLTI4OCwxMSArMjk3LDE5IEBAIGludCBzbXVfZ2V0X2RwbV9m
cmVxX3JhbmdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSBjbGtf
dHlwZSwNCj4gICANCj4gICAJCXJldHVybiAwOw0KPiAgIAl9DQo+ICsNCj4gKwlpZiAobG9ja19u
ZWVkZWQpDQo+ICsJCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICAgCS8qDQo+ICAg
CSAqIFRvZG86IFVzZSBlYWNoIGFzaWMoQVNJQ19wcHQgZnVuY3MpIGNvbnRyb2wgdGhlIGNhbGxi
YWNrcyBleHBvc2VkIHRvIHRoZQ0KPiAgIAkgKiBjb3JlIGRyaXZlciBhbmQgdGhlbiBoYXZlIGhl
bHBlcnMgZm9yIHN0dWZmIHRoYXQgaXMgY29tbW9uKFNNVV92MTFfeCB8IFNNVV92MTJfeCBmdW5j
cykuDQo+ICAgCSAqLw0KPiAgIAlyZXQgPSBzbXVfZ2V0X2RwbV91bHRpbWF0ZV9mcmVxKHNtdSwg
Y2xrX3R5cGUsIG1pbiwgbWF4KTsNCj4gKw0KPiArCWlmIChsb2NrX25lZWRlZCkNCj4gKwkJbXV0
ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAgIAlyZXR1cm4gcmV0Ow0KPiAgIH0NCj4g
ICANCj4gQEAgLTM2OSw2ICszODYsOCBAQCBpbnQgc211X2RwbV9zZXRfcG93ZXJfZ2F0ZShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDMyX3QgYmxvY2tfdHlwZSwNCj4gICB7DQo+ICAgCWlu
dCByZXQgPSAwOw0KPiAgIA0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICAg
CXN3aXRjaCAoYmxvY2tfdHlwZSkgew0KPiAgIAljYXNlIEFNRF9JUF9CTE9DS19UWVBFX1VWRDoN
Cj4gICAJCXJldCA9IHNtdV9kcG1fc2V0X3V2ZF9lbmFibGUoc211LCBnYXRlKTsNCj4gQEAgLTM4
NiwxMyArNDA1LDkgQEAgaW50IHNtdV9kcG1fc2V0X3Bvd2VyX2dhdGUoc3RydWN0IHNtdV9jb250
ZXh0ICpzbXUsIHVpbnQzMl90IGJsb2NrX3R5cGUsDQo+ICAgCQlicmVhazsNCj4gICAJfQ0KPiAg
IA0KPiAtCXJldHVybiByZXQ7DQo+IC19DQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsN
Cj4gICANCj4gLWVudW0gYW1kX3BtX3N0YXRlX3R5cGUgc211X2dldF9jdXJyZW50X3Bvd2VyX3N0
YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KPiAtew0KPiAtCS8qIG5vdCBzdXBwb3J0IHBv
d2VyIHN0YXRlICovDQo+IC0JcmV0dXJuIFBPV0VSX1NUQVRFX1RZUEVfREVGQVVMVDsNCj4gKwly
ZXR1cm4gcmV0Ow0KPiAgIH0NCj4gICANCj4gICBpbnQgc211X2dldF9wb3dlcl9udW1fc3RhdGVz
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiBAQCAtNTIwLDE2ICs1MzUsMjMgQEAgYm9vbCBp
c19zdXBwb3J0X3N3X3NtdV94Z21pKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQ0KPiAgIGlu
dCBzbXVfc3lzX2dldF9wcF90YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdm9pZCAqKnRh
YmxlKQ0KPiAgIHsNCj4gICAJc3RydWN0IHNtdV90YWJsZV9jb250ZXh0ICpzbXVfdGFibGUgPSAm
c211LT5zbXVfdGFibGU7DQo+ICsJdWludDMyX3QgcG93ZXJwbGF5X3RhYmxlX3NpemU7DQo+ICAg
DQo+ICAgCWlmICghc211X3RhYmxlLT5wb3dlcl9wbGF5X3RhYmxlICYmICFzbXVfdGFibGUtPmhh
cmRjb2RlX3BwdGFibGUpDQo+ICAgCQlyZXR1cm4gLUVJTlZBTDsNCj4gICANCj4gKwltdXRleF9s
b2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAgIAlpZiAoc211X3RhYmxlLT5oYXJkY29kZV9wcHRh
YmxlKQ0KPiAgIAkJKnRhYmxlID0gc211X3RhYmxlLT5oYXJkY29kZV9wcHRhYmxlOw0KPiAgIAll
bHNlDQo+ICAgCQkqdGFibGUgPSBzbXVfdGFibGUtPnBvd2VyX3BsYXlfdGFibGU7DQo+ICAgDQo+
IC0JcmV0dXJuIHNtdV90YWJsZS0+cG93ZXJfcGxheV90YWJsZV9zaXplOw0KPiArCXBvd2VycGxh
eV90YWJsZV9zaXplID0gc211X3RhYmxlLT5wb3dlcl9wbGF5X3RhYmxlX3NpemU7DQo+ICsNCj4g
KwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHBvd2VycGxheV90
YWJsZV9zaXplOw0KPiAgIH0NCj4gICANCj4gICBpbnQgc211X3N5c19zZXRfcHBfdGFibGUoc3Ry
dWN0IHNtdV9jb250ZXh0ICpzbXUsICB2b2lkICpidWYsIHNpemVfdCBzaXplKQ0KPiBAQCAtNTU2
LDEyICs1NzgsMTMgQEAgaW50IHNtdV9zeXNfc2V0X3BwX3RhYmxlKHN0cnVjdCBzbXVfY29udGV4
dCAqc211LCAgdm9pZCAqYnVmLCBzaXplX3Qgc2l6ZSkNCj4gICAJbWVtY3B5KHNtdV90YWJsZS0+
aGFyZGNvZGVfcHB0YWJsZSwgYnVmLCBzaXplKTsNCj4gICAJc211X3RhYmxlLT5wb3dlcl9wbGF5
X3RhYmxlID0gc211X3RhYmxlLT5oYXJkY29kZV9wcHRhYmxlOw0KPiAgIAlzbXVfdGFibGUtPnBv
d2VyX3BsYXlfdGFibGVfc2l6ZSA9IHNpemU7DQo+IC0JbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4
KTsNCj4gICANCj4gICAJcmV0ID0gc211X3Jlc2V0KHNtdSk7DQo+ICAgCWlmIChyZXQpDQo+ICAg
CQlwcl9pbmZvKCJzbXUgcmVzZXQgZmFpbGVkLCByZXQgPSAlZFxuIiwgcmV0KTsNCj4gICANCj4g
KwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICAgCXJldHVybiByZXQ7DQo+ICAg
DQo+ICAgZmFpbGVkOg0KPiBAQCAtNzI2LDExICs3NDksMTAgQEAgc3RhdGljIGludCBzbXVfbGF0
ZV9pbml0KHZvaWQgKmhhbmRsZSkNCj4gICAJaWYgKCFzbXUtPnBtX2VuYWJsZWQpDQo+ICAgCQly
ZXR1cm4gMDsNCj4gICANCj4gLQltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gICAJc211X2hh
bmRsZV90YXNrKCZhZGV2LT5zbXUsDQo+ICAgCQkJc211LT5zbXVfZHBtLmRwbV9sZXZlbCwNCj4g
LQkJCUFNRF9QUF9UQVNLX0NPTVBMRVRFX0lOSVQpOw0KPiAtCW11dGV4X3VubG9jaygmc211LT5t
dXRleCk7DQo+ICsJCQlBTURfUFBfVEFTS19DT01QTEVURV9JTklULA0KPiArCQkJZmFsc2UpOw0K
PiAgIA0KPiAgIAlyZXR1cm4gMDsNCj4gICB9DQo+IEBAIC0xMDc0LDcgKzEwOTYsNyBAQCBzdGF0
aWMgaW50IHNtdV9zbWNfdGFibGVfaHdfaW5pdChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4g
ICAJCWlmIChyZXQpDQo+ICAgCQkJcmV0dXJuIHJldDsNCj4gICANCj4gLQkJcmV0ID0gc211X2dl
dF9wb3dlcl9saW1pdChzbXUsICZzbXUtPmRlZmF1bHRfcG93ZXJfbGltaXQsIHRydWUpOw0KPiAr
CQlyZXQgPSBzbXVfZ2V0X3Bvd2VyX2xpbWl0KHNtdSwgJnNtdS0+ZGVmYXVsdF9wb3dlcl9saW1p
dCwgdHJ1ZSwgZmFsc2UpOw0KPiAgIAkJaWYgKHJldCkNCj4gICAJCQlyZXR1cm4gcmV0Ow0KPiAg
IAl9DQo+IEBAIC0xMTYwLDE1ICsxMTgyLDE5IEBAIHN0YXRpYyBpbnQgc211X3N0YXJ0X3NtY19l
bmdpbmUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpDQo+ICAgDQo+ICAgCWlmIChhZGV2LT5maXJt
d2FyZS5sb2FkX3R5cGUgIT0gQU1ER1BVX0ZXX0xPQURfUFNQKSB7DQo+ICAgCQlpZiAoYWRldi0+
YXNpY190eXBlIDwgQ0hJUF9OQVZJMTApIHsNCj4gLQkJCXJldCA9IHNtdV9sb2FkX21pY3JvY29k
ZShzbXUpOw0KPiAtCQkJaWYgKHJldCkNCj4gLQkJCQlyZXR1cm4gcmV0Ow0KPiArCQkJaWYgKHNt
dS0+ZnVuY3MtPmxvYWRfbWljcm9jb2RlKSB7DQo+ICsJCQkJcmV0ID0gc211LT5mdW5jcy0+bG9h
ZF9taWNyb2NvZGUoc211KTsNCj4gKwkJCQlpZiAocmV0KQ0KPiArCQkJCQlyZXR1cm4gcmV0Ow0K
PiArCQkJfQ0KPiAgIAkJfQ0KPiAgIAl9DQo+ICAgDQo+IC0JcmV0ID0gc211X2NoZWNrX2Z3X3N0
YXR1cyhzbXUpOw0KPiAtCWlmIChyZXQpDQo+IC0JCXByX2VycigiU01DIGlzIG5vdCByZWFkeVxu
Iik7DQo+ICsJaWYgKHNtdS0+ZnVuY3MtPmNoZWNrX2Z3X3N0YXR1cykgew0KPiArCQlyZXQgPSBz
bXUtPmZ1bmNzLT5jaGVja19md19zdGF0dXMoc211KTsNCj4gKwkJaWYgKHJldCkNCj4gKwkJCXBy
X2VycigiU01DIGlzIG5vdCByZWFkeVxuIik7DQo+ICsJfQ0KPiAgIA0KPiAgIAlyZXR1cm4gcmV0
Ow0KPiAgIH0NCj4gQEAgLTEzMzQsOCArMTM2MCw2IEBAIHN0YXRpYyBpbnQgc211X3Jlc3VtZSh2
b2lkICpoYW5kbGUpDQo+ICAgDQo+ICAgCXByX2luZm8oIlNNVSBpcyByZXN1bWluZy4uLlxuIik7
DQo+ICAgDQo+IC0JbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+IC0NCj4gICAJcmV0ID0gc211
X3N0YXJ0X3NtY19lbmdpbmUoc211KTsNCj4gICAJaWYgKHJldCkgew0KPiAgIAkJcHJfZXJyKCJT
TVUgaXMgbm90IHJlYWR5IHlldCFcbiIpOw0KPiBAQCAtMTM1MCwxMyArMTM3NCwxMSBAQCBzdGF0
aWMgaW50IHNtdV9yZXN1bWUodm9pZCAqaGFuZGxlKQ0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJZ290
byBmYWlsZWQ7DQo+ICAgDQo+IC0JbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gLQ0KPiAg
IAlwcl9pbmZvKCJTTVUgaXMgcmVzdW1lZCBzdWNjZXNzZnVsbHkhXG4iKTsNCj4gICANCj4gICAJ
cmV0dXJuIDA7DQo+ICsNCj4gICBmYWlsZWQ6DQo+IC0JbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4
KTsNCj4gICAJcmV0dXJuIHJldDsNCj4gICB9DQo+ICAgDQo+IEBAIC0xMzc0LDggKzEzOTYsOSBA
QCBpbnQgc211X2Rpc3BsYXlfY29uZmlndXJhdGlvbl9jaGFuZ2Uoc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUsDQo+ICAgDQo+ICAgCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiAgIA0KPiAtCXNt
dV9zZXRfZGVlcF9zbGVlcF9kY2VmY2xrKHNtdSwNCj4gLQkJCQkgICBkaXNwbGF5X2NvbmZpZy0+
bWluX2RjZWZfZGVlcF9zbGVlcF9zZXRfY2xrIC8gMTAwKTsNCj4gKwlpZiAoc211LT5mdW5jcy0+
c2V0X2RlZXBfc2xlZXBfZGNlZmNsaykNCj4gKwkJc211LT5mdW5jcy0+c2V0X2RlZXBfc2xlZXBf
ZGNlZmNsayhzbXUsDQo+ICsJCQkJZGlzcGxheV9jb25maWctPm1pbl9kY2VmX2RlZXBfc2xlZXBf
c2V0X2NsayAvIDEwMCk7DQo+ICAgDQo+ICAgCWZvciAoaW5kZXggPSAwOyBpbmRleCA8IGRpc3Bs
YXlfY29uZmlnLT5udW1fcGF0aF9pbmNsdWRpbmdfbm9uX2Rpc3BsYXk7IGluZGV4KyspIHsNCj4g
ICAJCWlmIChkaXNwbGF5X2NvbmZpZy0+ZGlzcGxheXNbaW5kZXhdLmNvbnRyb2xsZXJfaWQgIT0g
MCkNCj4gQEAgLTE1NTMsOSArMTU3Niw5IEBAIHN0YXRpYyBpbnQgc211X2RlZmF1bHRfc2V0X3Bl
cmZvcm1hbmNlX2xldmVsKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIGFtZF9kDQo+ICAg
CQkJCQkJICZzb2NfbWFzayk7DQo+ICAgCQlpZiAocmV0KQ0KPiAgIAkJCXJldHVybiByZXQ7DQo+
IC0JCXNtdV9mb3JjZV9jbGtfbGV2ZWxzKHNtdSwgU01VX1NDTEssIDEgPDwgc2Nsa19tYXNrKTsN
Cj4gLQkJc211X2ZvcmNlX2Nsa19sZXZlbHMoc211LCBTTVVfTUNMSywgMSA8PCBtY2xrX21hc2sp
Ow0KPiAtCQlzbXVfZm9yY2VfY2xrX2xldmVscyhzbXUsIFNNVV9TT0NDTEssIDEgPDwgc29jX21h
c2spOw0KPiArCQlzbXVfZm9yY2VfY2xrX2xldmVscyhzbXUsIFNNVV9TQ0xLLCAxIDw8IHNjbGtf
bWFzaywgZmFsc2UpOw0KPiArCQlzbXVfZm9yY2VfY2xrX2xldmVscyhzbXUsIFNNVV9NQ0xLLCAx
IDw8IG1jbGtfbWFzaywgZmFsc2UpOw0KPiArCQlzbXVfZm9yY2VfY2xrX2xldmVscyhzbXUsIFNN
VV9TT0NDTEssIDEgPDwgc29jX21hc2ssIGZhbHNlKTsNCj4gICAJCWJyZWFrOw0KPiAgIAljYXNl
IEFNRF9EUE1fRk9SQ0VEX0xFVkVMX01BTlVBTDoNCj4gICAJY2FzZSBBTURfRFBNX0ZPUkNFRF9M
RVZFTF9QUk9GSUxFX0VYSVQ6DQo+IEBAIC0xNjE5LDcgKzE2NDIsNyBAQCBpbnQgc211X2FkanVz
dF9wb3dlcl9zdGF0ZV9keW5hbWljKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiAgIAkJd29y
a2xvYWQgPSBzbXUtPndvcmtsb2FkX3NldHRpbmdbaW5kZXhdOw0KPiAgIA0KPiAgIAkJaWYgKHNt
dS0+cG93ZXJfcHJvZmlsZV9tb2RlICE9IHdvcmtsb2FkKQ0KPiAtCQkJc211X3NldF9wb3dlcl9w
cm9maWxlX21vZGUoc211LCAmd29ya2xvYWQsIDApOw0KPiArCQkJc211X3NldF9wb3dlcl9wcm9m
aWxlX21vZGUoc211LCAmd29ya2xvYWQsIDAsIGZhbHNlKTsNCj4gICAJfQ0KPiAgIA0KPiAgIAly
ZXR1cm4gcmV0Ow0KPiBAQCAtMTYyNywxOCArMTY1MCwyMiBAQCBpbnQgc211X2FkanVzdF9wb3dl
cl9zdGF0ZV9keW5hbWljKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiAgIA0KPiAgIGludCBz
bXVfaGFuZGxlX3Rhc2soc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCQkgICAgZW51bSBh
bWRfZHBtX2ZvcmNlZF9sZXZlbCBsZXZlbCwNCj4gLQkJICAgIGVudW0gYW1kX3BwX3Rhc2sgdGFz
a19pZCkNCj4gKwkJICAgIGVudW0gYW1kX3BwX3Rhc2sgdGFza19pZCwNCj4gKwkJICAgIGJvb2wg
bG9ja19uZWVkZWQpDQo+ICAgew0KPiAgIAlpbnQgcmV0ID0gMDsNCj4gICANCj4gKwlpZiAobG9j
a19uZWVkZWQpDQo+ICsJCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICAgCXN3aXRj
aCAodGFza19pZCkgew0KPiAgIAljYXNlIEFNRF9QUF9UQVNLX0RJU1BMQVlfQ09ORklHX0NIQU5H
RToNCj4gICAJCXJldCA9IHNtdV9wcmVfZGlzcGxheV9jb25maWdfY2hhbmdlZChzbXUpOw0KPiAg
IAkJaWYgKHJldCkNCj4gLQkJCXJldHVybiByZXQ7DQo+ICsJCQlnb3RvIG91dDsNCj4gICAJCXJl
dCA9IHNtdV9zZXRfY3B1X3Bvd2VyX3N0YXRlKHNtdSk7DQo+ICAgCQlpZiAocmV0KQ0KPiAtCQkJ
cmV0dXJuIHJldDsNCj4gKwkJCWdvdG8gb3V0Ow0KPiAgIAkJcmV0ID0gc211X2FkanVzdF9wb3dl
cl9zdGF0ZV9keW5hbWljKHNtdSwgbGV2ZWwsIGZhbHNlKTsNCj4gICAJCWJyZWFrOw0KPiAgIAlj
YXNlIEFNRF9QUF9UQVNLX0NPTVBMRVRFX0lOSVQ6DQo+IEBAIC0xNjQ5LDYgKzE2NzYsMTAgQEAg
aW50IHNtdV9oYW5kbGVfdGFzayhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJCWJyZWFr
Ow0KPiAgIAl9DQo+ICAgDQo+ICtvdXQ6DQo+ICsJaWYgKGxvY2tfbmVlZGVkKQ0KPiArCQltdXRl
eF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICAgCXJldHVybiByZXQ7DQo+ICAgfQ0KPiAg
IA0KPiBAQCAtMTY4MSw3ICsxNzEyLDcgQEAgaW50IHNtdV9zd2l0Y2hfcG93ZXJfcHJvZmlsZShz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJfQ0KPiAgIA0KPiAgIAlpZiAoc211X2RwbV9j
dHgtPmRwbV9sZXZlbCAhPSBBTURfRFBNX0ZPUkNFRF9MRVZFTF9NQU5VQUwpDQo+IC0JCXNtdV9z
ZXRfcG93ZXJfcHJvZmlsZV9tb2RlKHNtdSwgJndvcmtsb2FkLCAwKTsNCj4gKwkJc211X3NldF9w
b3dlcl9wcm9maWxlX21vZGUoc211LCAmd29ya2xvYWQsIDAsIGZhbHNlKTsNCj4gICANCj4gICAJ
bXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gICANCj4gQEAgLTE3MTEsMTIgKzE3NDIsMTkg
QEAgaW50IHNtdV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbChzdHJ1Y3Qgc211X2NvbnRleHQgKnNt
dSwgZW51bSBhbWRfZHBtX2ZvcmNlZF9sZXYNCj4gICAJaWYgKCFzbXUtPmlzX2FwdSAmJiAhc211
X2RwbV9jdHgtPmRwbV9jb250ZXh0KQ0KPiAgIAkJcmV0dXJuIC1FSU5WQUw7DQo+ICAgDQo+ICsJ
bXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gICAJcmV0ID0gc211X2VuYWJsZV91bWRf
cHN0YXRlKHNtdSwgJmxldmVsKTsNCj4gLQlpZiAocmV0KQ0KPiArCWlmIChyZXQpIHsNCj4gKwkJ
bXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gICAJCXJldHVybiByZXQ7DQo+ICsJfQ0KPiAg
IA0KPiAgIAlyZXQgPSBzbXVfaGFuZGxlX3Rhc2soc211LCBsZXZlbCwNCj4gLQkJCSAgICAgIEFN
RF9QUF9UQVNLX1JFQURKVVNUX1BPV0VSX1NUQVRFKTsNCj4gKwkJCSAgICAgIEFNRF9QUF9UQVNL
X1JFQURKVVNUX1BPV0VSX1NUQVRFLA0KPiArCQkJICAgICAgZmFsc2UpOw0KPiArDQo+ICsJbXV0
ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gICANCj4gICAJcmV0dXJuIHJldDsNCj4gICB9DQo+
IEBAIC0xNzM0LDcgKzE3NzIsOCBAQCBpbnQgc211X3NldF9kaXNwbGF5X2NvdW50KHN0cnVjdCBz
bXVfY29udGV4dCAqc211LCB1aW50MzJfdCBjb3VudCkNCj4gICANCj4gICBpbnQgc211X2ZvcmNl
X2Nsa19sZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCQkJIGVudW0gc211X2Ns
a190eXBlIGNsa190eXBlLA0KPiAtCQkJIHVpbnQzMl90IG1hc2spDQo+ICsJCQkgdWludDMyX3Qg
bWFzaywNCj4gKwkJCSBib29sIGxvY2tfbmVlZGVkKQ0KPiAgIHsNCj4gICAJc3RydWN0IHNtdV9k
cG1fY29udGV4dCAqc211X2RwbV9jdHggPSAmKHNtdS0+c211X2RwbSk7DQo+ICAgCWludCByZXQg
PSAwOw0KPiBAQCAtMTc0NCw5ICsxNzgzLDE1IEBAIGludCBzbXVfZm9yY2VfY2xrX2xldmVscyhz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJCXJldHVybiAtRUlOVkFMOw0KPiAgIAl9DQo+
ICAgDQo+ICsJaWYgKGxvY2tfbmVlZGVkKQ0KPiArCQltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsN
Cj4gKw0KPiAgIAlpZiAoc211LT5wcHRfZnVuY3MgJiYgc211LT5wcHRfZnVuY3MtPmZvcmNlX2Ns
a19sZXZlbHMpDQo+ICAgCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+Zm9yY2VfY2xrX2xldmVscyhz
bXUsIGNsa190eXBlLCBtYXNrKTsNCj4gICANCj4gKwlpZiAobG9ja19uZWVkZWQpDQo+ICsJCW11
dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gICAJcmV0dXJuIHJldDsNCj4gICB9DQo+
ICAgDQo+IEBAIC0xNzY0LDYgKzE4MDksOCBAQCBpbnQgc211X3NldF9tcDFfc3RhdGUoc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCWlmICghc211LT5wbV9lbmFibGVkKQ0KPiAgIAkJcmV0
dXJuIDA7DQo+ICAgDQo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gICAJc3dp
dGNoIChtcDFfc3RhdGUpIHsNCj4gICAJY2FzZSBQUF9NUDFfU1RBVEVfU0hVVERPV046DQo+ICAg
CQltc2cgPSBTTVVfTVNHX1ByZXBhcmVNcDFGb3JTaHV0ZG93bjsNCj4gQEAgLTE3NzYsMTcgKzE4
MjMsMjIgQEAgaW50IHNtdV9zZXRfbXAxX3N0YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0K
PiAgIAkJYnJlYWs7DQo+ICAgCWNhc2UgUFBfTVAxX1NUQVRFX05PTkU6DQo+ICAgCWRlZmF1bHQ6
DQo+ICsJCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICAgCQlyZXR1cm4gMDsNCj4gICAJ
fQ0KPiAgIA0KPiAgIAkvKiBzb21lIGFzaWNzIG1heSBub3Qgc3VwcG9ydCB0aG9zZSBtZXNzYWdl
cyAqLw0KPiAtCWlmIChzbXVfbXNnX2dldF9pbmRleChzbXUsIG1zZykgPCAwKQ0KPiArCWlmIChz
bXVfbXNnX2dldF9pbmRleChzbXUsIG1zZykgPCAwKSB7DQo+ICsJCW11dGV4X3VubG9jaygmc211
LT5tdXRleCk7DQo+ICAgCQlyZXR1cm4gMDsNCj4gKwl9DQo+ICAgDQo+ICAgCXJldCA9IHNtdV9z
ZW5kX3NtY19tc2coc211LCBtc2cpOw0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcHJfZXJyKCJbUHJl
cGFyZU1wMV0gRmFpbGVkIVxuIik7DQo+ICAgDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4
KTsNCj4gKw0KPiAgIAlyZXR1cm4gcmV0Ow0KPiAgIH0NCj4gICANCj4gQEAgLTE4MDYsMTAgKzE4
NTgsMTQgQEAgaW50IHNtdV9zZXRfZGZfY3N0YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0K
PiAgIAlpZiAoIXNtdS0+cHB0X2Z1bmNzIHx8ICFzbXUtPnBwdF9mdW5jcy0+c2V0X2RmX2NzdGF0
ZSkNCj4gICAJCXJldHVybiAwOw0KPiAgIA0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0K
PiArDQo+ICAgCXJldCA9IHNtdS0+cHB0X2Z1bmNzLT5zZXRfZGZfY3N0YXRlKHNtdSwgc3RhdGUp
Ow0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcHJfZXJyKCJbU2V0RGZDc3RhdGVdIGZhaWxlZCFcbiIp
Ow0KPiAgIA0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gICAJcmV0dXJu
IHJldDsNCj4gICB9DQo+ICAgDQo+IEBAIC0xODQ5LDMgKzE5MDUsNTQ5IEBAIGNvbnN0IHN0cnVj
dCBhbWRncHVfaXBfYmxvY2tfdmVyc2lvbiBzbXVfdjEyXzBfaXBfYmxvY2sgPQ0KPiAgIAkucmV2
ID0gMCwNCj4gICAJLmZ1bmNzID0gJnNtdV9pcF9mdW5jcywNCj4gICB9Ow0KPiArDQo+ICtpbnQg
c211X2xvYWRfbWljcm9jb2RlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KPiArew0KPiArCWlu
dCByZXQgPSAwOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlp
ZiAoc211LT5mdW5jcy0+bG9hZF9taWNyb2NvZGUpDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPmxv
YWRfbWljcm9jb2RlKHNtdSk7DQo+ICsNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0K
PiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNtdV9jaGVja19md19zdGF0
dXMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsN
Cj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPmZ1bmNzLT5j
aGVja19md19zdGF0dXMpDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPmNoZWNrX2Z3X3N0YXR1cyhz
bXUpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVy
biByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBzbXVfc2V0X2dmeF9jZ3BnKHN0cnVjdCBzbXVfY29u
dGV4dCAqc211LCBib29sIGVuYWJsZWQpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4g
KwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRf
Z2Z4X2NncGcpDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPnNldF9nZnhfY2dwZyhzbXUsIGVuYWJs
ZWQpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVy
biByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBzbXVfc2V0X2Zhbl9zcGVlZF9ycG0oc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUsIHVpbnQzMl90IHNwZWVkKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0K
PiArDQo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5mdW5j
cy0+c2V0X2Zhbl9zcGVlZF9ycG0pDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPnNldF9mYW5fc3Bl
ZWRfcnBtKHNtdSwgc3BlZWQpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsN
Cj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBzbXVfZ2V0X3Bvd2VyX2xp
bWl0KHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiArCQkJdWludDMyX3QgKmxpbWl0LA0KPiAr
CQkJYm9vbCBkZWYsDQo+ICsJCQlib29sIGxvY2tfbmVlZGVkKQ0KPiArew0KPiArCWludCByZXQg
PSAwOw0KPiArDQo+ICsJaWYgKGxvY2tfbmVlZGVkKQ0KPiArCQltdXRleF9sb2NrKCZzbXUtPm11
dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPnBwdF9mdW5jcy0+Z2V0X3Bvd2VyX2xpbWl0KQ0KPiAr
CQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+Z2V0X3Bvd2VyX2xpbWl0KHNtdSwgbGltaXQsIGRlZik7
DQo+ICsNCj4gKwlpZiAobG9ja19uZWVkZWQpDQo+ICsJCW11dGV4X3VubG9jaygmc211LT5tdXRl
eCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211X3NldF9wb3dl
cl9saW1pdChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDMyX3QgbGltaXQpDQo+ICt7DQo+
ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0K
PiArCWlmIChzbXUtPmZ1bmNzLT5zZXRfcG93ZXJfbGltaXQpDQo+ICsJCXJldCA9IHNtdS0+ZnVu
Y3MtPnNldF9wb3dlcl9saW1pdChzbXUsIGxpbWl0KTsNCj4gKw0KPiArCW11dGV4X3VubG9jaygm
c211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211
X3ByaW50X2Nsa19sZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0gc211X2Nsa190
eXBlIGNsa190eXBlLCBjaGFyICpidWYpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4g
KwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPnBwdF9mdW5jcy0+
cHJpbnRfY2xrX2xldmVscykNCj4gKwkJcmV0ID0gc211LT5wcHRfZnVuY3MtPnByaW50X2Nsa19s
ZXZlbHMoc211LCBjbGtfdHlwZSwgYnVmKTsNCj4gKw0KPiArCW11dGV4X3VubG9jaygmc211LT5t
dXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211X2dldF9v
ZF9wZXJjZW50YWdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSB0
eXBlKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygmc211LT5t
dXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPmdldF9vZF9wZXJjZW50YWdlKQ0K
PiArCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+Z2V0X29kX3BlcmNlbnRhZ2Uoc211LCB0eXBlKTsN
Cj4gKw0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0
Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211X3NldF9vZF9wZXJjZW50YWdlKHN0cnVjdCBzbXVfY29u
dGV4dCAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSB0eXBlLCB1aW50MzJfdCB2YWx1ZSkNCj4gK3sN
Cj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiAr
DQo+ICsJaWYgKHNtdS0+cHB0X2Z1bmNzLT5zZXRfb2RfcGVyY2VudGFnZSkNCj4gKwkJcmV0ID0g
c211LT5wcHRfZnVuY3MtPnNldF9vZF9wZXJjZW50YWdlKHNtdSwgdHlwZSwgdmFsdWUpOw0KPiAr
DQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+
ICt9DQo+ICsNCj4gK2ludCBzbXVfb2RfZWRpdF9kcG1fdGFibGUoc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUsDQo+ICsJCQkgIGVudW0gUFBfT0RfRFBNX1RBQkxFX0NPTU1BTkQgdHlwZSwNCj4gKwkJ
CSAgbG9uZyAqaW5wdXQsIHVpbnQzMl90IHNpemUpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+
ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPnBwdF9m
dW5jcy0+b2RfZWRpdF9kcG1fdGFibGUpDQo+ICsJCXJldCA9IHNtdS0+cHB0X2Z1bmNzLT5vZF9l
ZGl0X2RwbV90YWJsZShzbXUsIHR5cGUsIGlucHV0LCBzaXplKTsNCj4gKw0KPiArCW11dGV4X3Vu
bG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtp
bnQgc211X3JlYWRfc2Vuc29yKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiArCQkgICAgZW51
bSBhbWRfcHBfc2Vuc29ycyBzZW5zb3IsDQo+ICsJCSAgICB2b2lkICpkYXRhLCB1aW50MzJfdCAq
c2l6ZSkNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+
bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+cHB0X2Z1bmNzLT5yZWFkX3NlbnNvcikNCj4gKwkJ
cmV0ID0gc211LT5wcHRfZnVuY3MtPnJlYWRfc2Vuc29yKHNtdSwgc2Vuc29yLCBkYXRhLCBzaXpl
KTsNCj4gKw0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4g
cmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211X2dldF9wb3dlcl9wcm9maWxlX21vZGUoc3RydWN0
IHNtdV9jb250ZXh0ICpzbXUsIGNoYXIgKmJ1ZikNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4g
Kw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+cHB0X2Z1
bmNzLT5nZXRfcG93ZXJfcHJvZmlsZV9tb2RlKQ0KPiArCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+
Z2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZShzbXUsIGJ1Zik7DQo+ICsNCj4gKwltdXRleF91bmxvY2so
JnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNt
dV9zZXRfcG93ZXJfcHJvZmlsZV9tb2RlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiArCQkJ
ICAgICAgIGxvbmcgKnBhcmFtLA0KPiArCQkJICAgICAgIHVpbnQzMl90IHBhcmFtX3NpemUsDQo+
ICsJCQkgICAgICAgYm9vbCBsb2NrX25lZWRlZCkNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4g
Kw0KPiArCWlmIChsb2NrX25lZWRlZCkNCj4gKwkJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+
ICsNCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPnNldF9wb3dlcl9wcm9maWxlX21vZGUpDQo+ICsJ
CXJldCA9IHNtdS0+cHB0X2Z1bmNzLT5zZXRfcG93ZXJfcHJvZmlsZV9tb2RlKHNtdSwgcGFyYW0s
IHBhcmFtX3NpemUpOw0KPiArDQo+ICsJaWYgKGxvY2tfbmVlZGVkKQ0KPiArCQltdXRleF91bmxv
Y2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiArDQo+
ICtpbnQgc211X2dldF9mYW5fY29udHJvbF9tb2RlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0K
PiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7
DQo+ICsNCj4gKwlpZiAoc211LT5mdW5jcy0+Z2V0X2Zhbl9jb250cm9sX21vZGUpDQo+ICsJCXJl
dCA9IHNtdS0+ZnVuY3MtPmdldF9mYW5fY29udHJvbF9tb2RlKHNtdSk7DQo+ICsNCj4gKwltdXRl
eF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0K
PiAraW50IHNtdV9zZXRfZmFuX2NvbnRyb2xfbW9kZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwg
aW50IHZhbHVlKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygm
c211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5mdW5jcy0+c2V0X2Zhbl9jb250cm9sX21v
ZGUpDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPnNldF9mYW5fY29udHJvbF9tb2RlKHNtdSwgdmFs
dWUpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVy
biByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBzbXVfZ2V0X2Zhbl9zcGVlZF9wZXJjZW50KHN0cnVj
dCBzbXVfY29udGV4dCAqc211LCB1aW50MzJfdCAqc3BlZWQpDQo+ICt7DQo+ICsJaW50IHJldCA9
IDA7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUt
PnBwdF9mdW5jcy0+Z2V0X2Zhbl9zcGVlZF9wZXJjZW50KQ0KPiArCQlyZXQgPSBzbXUtPnBwdF9m
dW5jcy0+Z2V0X2Zhbl9zcGVlZF9wZXJjZW50KHNtdSwgc3BlZWQpOw0KPiArDQo+ICsJbXV0ZXhf
dW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4g
K2ludCBzbXVfc2V0X2Zhbl9zcGVlZF9wZXJjZW50KHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1
aW50MzJfdCBzcGVlZCkNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xv
Y2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPnNldF9mYW5fc3BlZWRf
cGVyY2VudCkNCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+c2V0X2Zhbl9zcGVlZF9wZXJjZW50KHNt
dSwgc3BlZWQpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiAr
CXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBzbXVfZ2V0X2Zhbl9zcGVlZF9ycG0oc3Ry
dWN0IHNtdV9jb250ZXh0ICpzbXUsIHVpbnQzMl90ICpzcGVlZCkNCj4gK3sNCj4gKwlpbnQgcmV0
ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNt
dS0+cHB0X2Z1bmNzLT5nZXRfZmFuX3NwZWVkX3JwbSkNCj4gKwkJcmV0ID0gc211LT5wcHRfZnVu
Y3MtPmdldF9mYW5fc3BlZWRfcnBtKHNtdSwgc3BlZWQpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2Nr
KCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBz
bXVfc2V0X2RlZXBfc2xlZXBfZGNlZmNsayhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgaW50IGNs
aykNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0
ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPnNldF9kZWVwX3NsZWVwX2RjZWZjbGspDQo+
ICsJCXJldCA9IHNtdS0+ZnVuY3MtPnNldF9kZWVwX3NsZWVwX2RjZWZjbGsoc211LCBjbGspOw0K
PiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7
DQo+ICt9DQo+ICsNCj4gK2ludCBzbXVfc2V0X2FjdGl2ZV9kaXNwbGF5X2NvdW50KHN0cnVjdCBz
bXVfY29udGV4dCAqc211LCB1aW50MzJfdCBjb3VudCkNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsN
Cj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVu
Y3MtPnNldF9hY3RpdmVfZGlzcGxheV9jb3VudCkNCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+c2V0
X2FjdGl2ZV9kaXNwbGF5X2NvdW50KHNtdSwgY291bnQpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2Nr
KCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBz
bXVfZ2V0X2Nsb2NrX2J5X3R5cGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICsJCQkgIGVu
dW0gYW1kX3BwX2Nsb2NrX3R5cGUgdHlwZSwNCj4gKwkJCSAgc3RydWN0IGFtZF9wcF9jbG9ja3Mg
KmNsb2NrcykNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNt
dS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPmdldF9jbG9ja19ieV90eXBlKQ0K
PiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5nZXRfY2xvY2tfYnlfdHlwZShzbXUsIHR5cGUsIGNsb2Nr
cyk7DQo+ICsNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJu
IHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNtdV9nZXRfbWF4X2hpZ2hfY2xvY2tzKHN0cnVjdCBz
bXVfY29udGV4dCAqc211LA0KPiArCQkJICAgIHN0cnVjdCBhbWRfcHBfc2ltcGxlX2Nsb2NrX2lu
Zm8gKmNsb2NrcykNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2so
JnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPmdldF9tYXhfaGlnaF9jbG9j
a3MpDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPmdldF9tYXhfaGlnaF9jbG9ja3Moc211LCBjbG9j
a3MpOw0KPiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVy
biByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBzbXVfZ2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF9sYXRl
bmN5KHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiArCQkJCSAgICAgICBlbnVtIHNtdV9jbGtf
dHlwZSBjbGtfdHlwZSwNCj4gKwkJCQkgICAgICAgc3RydWN0IHBwX2Nsb2NrX2xldmVsc193aXRo
X2xhdGVuY3kgKmNsb2NrcykNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4
X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+cHB0X2Z1bmNzLT5nZXRfY2xv
Y2tfYnlfdHlwZV93aXRoX2xhdGVuY3kpDQo+ICsJCXJldCA9IHNtdS0+cHB0X2Z1bmNzLT5nZXRf
Y2xvY2tfYnlfdHlwZV93aXRoX2xhdGVuY3koc211LCBjbGtfdHlwZSwgY2xvY2tzKTsNCj4gKw0K
PiArCW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiAr
fQ0KPiArDQo+ICtpbnQgc211X2dldF9jbG9ja19ieV90eXBlX3dpdGhfdm9sdGFnZShzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSwNCj4gKwkJCQkgICAgICAgZW51bSBhbWRfcHBfY2xvY2tfdHlwZSB0
eXBlLA0KPiArCQkJCSAgICAgICBzdHJ1Y3QgcHBfY2xvY2tfbGV2ZWxzX3dpdGhfdm9sdGFnZSAq
Y2xvY2tzKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygmc211
LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5wcHRfZnVuY3MtPmdldF9jbG9ja19ieV90eXBl
X3dpdGhfdm9sdGFnZSkNCj4gKwkJcmV0ID0gc211LT5wcHRfZnVuY3MtPmdldF9jbG9ja19ieV90
eXBlX3dpdGhfdm9sdGFnZShzbXUsIHR5cGUsIGNsb2Nrcyk7DQo+ICsNCj4gKwltdXRleF91bmxv
Y2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiArDQo+
ICtpbnQgc211X2Rpc3BsYXlfY2xvY2tfdm9sdGFnZV9yZXF1ZXN0KHN0cnVjdCBzbXVfY29udGV4
dCAqc211LA0KPiArCQkJCSAgICAgIHN0cnVjdCBwcF9kaXNwbGF5X2Nsb2NrX3JlcXVlc3QgKmNs
b2NrX3JlcSkNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNt
dS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPmRpc3BsYXlfY2xvY2tfdm9sdGFn
ZV9yZXF1ZXN0KQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5kaXNwbGF5X2Nsb2NrX3ZvbHRhZ2Vf
cmVxdWVzdChzbXUsIGNsb2NrX3JlcSk7DQo+ICsNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0
ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiArDQo+ICtpbnQgc211X2Rp
c3BsYXlfZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dpdGNoKHN0cnVjdCBzbXVfY29udGV4dCAqc211
LCBib29sIGRpc2FibGVfbWVtb3J5X2Nsb2NrX3N3aXRjaCkNCj4gK3sNCj4gKwlpbnQgcmV0ID0g
LUVJTlZBTDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYg
KHNtdS0+cHB0X2Z1bmNzLT5kaXNwbGF5X2Rpc2FibGVfbWVtb3J5X2Nsb2NrX3N3aXRjaCkNCj4g
KwkJcmV0ID0gc211LT5wcHRfZnVuY3MtPmRpc3BsYXlfZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dp
dGNoKHNtdSwgZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dpdGNoKTsNCj4gKw0KPiArCW11dGV4X3Vu
bG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtp
bnQgc211X25vdGlmeV9zbXVfZW5hYmxlX3B3ZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4g
K3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0K
PiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPm5vdGlmeV9zbXVfZW5hYmxlX3B3ZSkNCj4gKwkJcmV0
ID0gc211LT5mdW5jcy0+bm90aWZ5X3NtdV9lbmFibGVfcHdlKHNtdSk7DQo+ICsNCj4gKwltdXRl
eF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0K
PiAraW50IHNtdV9zZXRfd2F0ZXJtYXJrc19mb3JfY2xvY2tfcmFuZ2VzKHN0cnVjdCBzbXVfY29u
dGV4dCAqc211LA0KPiArCQkJCQlzdHJ1Y3QgZG1fcHBfd21fc2V0c193aXRoX2Nsb2NrX3Jhbmdl
c19zb2MxNSAqY2xvY2tfcmFuZ2VzKQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiArDQo+ICsJ
bXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5mdW5jcy0+c2V0X3dh
dGVybWFya3NfZm9yX2Nsb2NrX3JhbmdlcykNCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+c2V0X3dh
dGVybWFya3NfZm9yX2Nsb2NrX3JhbmdlcyhzbXUsIGNsb2NrX3Jhbmdlcyk7DQo+ICsNCj4gKwlt
dXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4g
Kw0KPiAraW50IHNtdV9zZXRfeGdtaV9wc3RhdGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+
ICsJCQl1aW50MzJfdCBwc3RhdGUpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwlt
dXRleF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRfeGdt
aV9wc3RhdGUpDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPnNldF94Z21pX3BzdGF0ZShzbXUsIHBz
dGF0ZSk7DQo+ICsNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0
dXJuIHJldDsNCj4gK30NCj4gKw0KPiAraW50IHNtdV9zZXRfYXphbGlhX2QzX3BtZShzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSkNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4
X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPnNldF9hemFsaWFf
ZDNfcG1lKQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5zZXRfYXphbGlhX2QzX3BtZShzbXUpOw0K
PiArDQo+ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7
DQo+ICt9DQo+ICsNCj4gK2Jvb2wgc211X2JhY29faXNfc3VwcG9ydChzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSkNCj4gK3sNCj4gKwlib29sIHJldCA9IGZhbHNlOw0KPiArDQo+ICsJbXV0ZXhfbG9j
aygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5mdW5jcy0+YmFjb19pc19zdXBwb3J0
KQ0KPiArCQlyZXQgPSBzbXUtPmZ1bmNzLT5iYWNvX2lzX3N1cHBvcnQoc211KTsNCj4gKw0KPiAr
CW11dGV4X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0K
PiArDQo+ICtpbnQgc211X2JhY29fZ2V0X3N0YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBl
bnVtIHNtdV9iYWNvX3N0YXRlICpzdGF0ZSkNCj4gK3sNCj4gKwlpZiAoc211LT5mdW5jcy0+YmFj
b19nZXRfc3RhdGUpDQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygm
c211LT5tdXRleCk7DQo+ICsJKnN0YXRlID0gc211LT5mdW5jcy0+YmFjb19nZXRfc3RhdGUoc211
KTsNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+
ICt9DQo+ICsNCj4gK2ludCBzbXVfYmFjb19yZXNldChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkN
Cj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNtdS0+bXV0ZXgp
Ow0KPiArDQo+ICsJaWYgKHNtdS0+ZnVuY3MtPmJhY29fcmVzZXQpDQo+ICsJCXJldCA9IHNtdS0+
ZnVuY3MtPmJhY29fcmVzZXQoc211KTsNCj4gKw0KPiArCW11dGV4X3VubG9jaygmc211LT5tdXRl
eCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgc211X21vZGUyX3Jl
c2V0KHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KPiArew0KPiArCWludCByZXQgPSAwOw0KPiAr
DQo+ICsJbXV0ZXhfbG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlpZiAoc211LT5mdW5jcy0+
bW9kZTJfcmVzZXQpDQo+ICsJCXJldCA9IHNtdS0+ZnVuY3MtPm1vZGUyX3Jlc2V0KHNtdSk7DQo+
ICsNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsN
Cj4gK30NCj4gKw0KPiAraW50IHNtdV9nZXRfbWF4X3N1c3RhaW5hYmxlX2Nsb2Nrc19ieV9kYyhz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gKwkJCQkJIHN0cnVjdCBwcF9zbXVfbnZfY2xvY2tf
dGFibGUgKm1heF9jbG9ja3MpDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwltdXRl
eF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPmZ1bmNzLT5nZXRfbWF4X3N1
c3RhaW5hYmxlX2Nsb2Nrc19ieV9kYykNCj4gKwkJcmV0ID0gc211LT5mdW5jcy0+Z2V0X21heF9z
dXN0YWluYWJsZV9jbG9ja3NfYnlfZGMoc211LCBtYXhfY2xvY2tzKTsNCj4gKw0KPiArCW11dGV4
X3VubG9jaygmc211LT5tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+
ICtpbnQgc211X2dldF91Y2xrX2RwbV9zdGF0ZXMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+
ICsJCQkgICAgdW5zaWduZWQgaW50ICpjbG9ja192YWx1ZXNfaW5fa2h6LA0KPiArCQkJICAgIHVu
c2lnbmVkIGludCAqbnVtX3N0YXRlcykNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiAr
CW11dGV4X2xvY2soJnNtdS0+bXV0ZXgpOw0KPiArDQo+ICsJaWYgKHNtdS0+cHB0X2Z1bmNzLT5n
ZXRfdWNsa19kcG1fc3RhdGVzKQ0KPiArCQlyZXQgPSBzbXUtPnBwdF9mdW5jcy0+Z2V0X3VjbGtf
ZHBtX3N0YXRlcyhzbXUsIGNsb2NrX3ZhbHVlc19pbl9raHosIG51bV9zdGF0ZXMpOw0KPiArDQo+
ICsJbXV0ZXhfdW5sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9
DQo+ICsNCj4gK2VudW0gYW1kX3BtX3N0YXRlX3R5cGUgc211X2dldF9jdXJyZW50X3Bvd2VyX3N0
YXRlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KPiArew0KPiArCWVudW0gYW1kX3BtX3N0YXRl
X3R5cGUgcG1fc3RhdGUgPSBQT1dFUl9TVEFURV9UWVBFX0RFRkFVTFQ7DQo+ICsNCj4gKwltdXRl
eF9sb2NrKCZzbXUtPm11dGV4KTsNCj4gKw0KPiArCWlmIChzbXUtPnBwdF9mdW5jcy0+Z2V0X2N1
cnJlbnRfcG93ZXJfc3RhdGUpDQo+ICsJCXBtX3N0YXRlID0gc211LT5wcHRfZnVuY3MtPmdldF9j
dXJyZW50X3Bvd2VyX3N0YXRlKHNtdSk7DQo+ICsNCj4gKwltdXRleF91bmxvY2soJnNtdS0+bXV0
ZXgpOw0KPiArDQo+ICsJcmV0dXJuIHBtX3N0YXRlOw0KPiArfQ0KPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5jL2FtZGdwdV9zbXUuaCBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvcG93ZXJwbGF5L2luYy9hbWRncHVfc211LmgNCj4gaW5kZXggY2RiODQ1ZjVmMjNl
Li4zZTM0NjRmYTJmZjUgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJw
bGF5L2luYy9hbWRncHVfc211LmgNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBs
YXkvaW5jL2FtZGdwdV9zbXUuaA0KPiBAQCAtNTY1LDE4ICs1NjUsMTcgQEAgc3RydWN0IHNtdV9m
dW5jcw0KPiAgIAkoKHNtdSktPmZ1bmNzLT5pbml0X3Bvd2VyID8gKHNtdSktPmZ1bmNzLT5pbml0
X3Bvd2VyKChzbXUpKSA6IDApDQo+ICAgI2RlZmluZSBzbXVfZmluaV9wb3dlcihzbXUpIFwNCj4g
ICAJKChzbXUpLT5mdW5jcy0+ZmluaV9wb3dlciA/IChzbXUpLT5mdW5jcy0+ZmluaV9wb3dlcigo
c211KSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfbG9hZF9taWNyb2NvZGUoc211KSBcDQo+IC0JKChz
bXUpLT5mdW5jcy0+bG9hZF9taWNyb2NvZGUgPyAoc211KS0+ZnVuY3MtPmxvYWRfbWljcm9jb2Rl
KChzbXUpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9jaGVja19md19zdGF0dXMoc211KSBcDQo+IC0J
KChzbXUpLT5mdW5jcy0+Y2hlY2tfZndfc3RhdHVzID8gKHNtdSktPmZ1bmNzLT5jaGVja19md19z
dGF0dXMoKHNtdSkpIDogMCkNCj4gK2ludCBzbXVfbG9hZF9taWNyb2NvZGUoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUpOw0KPiArDQo+ICtpbnQgc211X2NoZWNrX2Z3X3N0YXR1cyhzdHJ1Y3Qgc211
X2NvbnRleHQgKnNtdSk7DQo+ICsNCj4gICAjZGVmaW5lIHNtdV9zZXR1cF9wcHRhYmxlKHNtdSkg
XA0KPiAgIAkoKHNtdSktPmZ1bmNzLT5zZXR1cF9wcHRhYmxlID8gKHNtdSktPmZ1bmNzLT5zZXR1
cF9wcHRhYmxlKChzbXUpKSA6IDApDQo+ICAgI2RlZmluZSBzbXVfcG93ZXJnYXRlX3NkbWEoc211
LCBnYXRlKSBcDQo+ICAgCSgoc211KS0+ZnVuY3MtPnBvd2VyZ2F0ZV9zZG1hID8gKHNtdSktPmZ1
bmNzLT5wb3dlcmdhdGVfc2RtYSgoc211KSwgKGdhdGUpKSA6IDApDQo+ICAgI2RlZmluZSBzbXVf
cG93ZXJnYXRlX3ZjbihzbXUsIGdhdGUpIFwNCj4gICAJKChzbXUpLT5mdW5jcy0+cG93ZXJnYXRl
X3ZjbiA/IChzbXUpLT5mdW5jcy0+cG93ZXJnYXRlX3Zjbigoc211KSwgKGdhdGUpKSA6IDApDQo+
IC0jZGVmaW5lIHNtdV9zZXRfZ2Z4X2NncGcoc211LCBlbmFibGVkKSBcDQo+IC0JKChzbXUpLT5m
dW5jcy0+c2V0X2dmeF9jZ3BnID8gKHNtdSktPmZ1bmNzLT5zZXRfZ2Z4X2NncGcoKHNtdSksIChl
bmFibGVkKSkgOiAwKQ0KPiAraW50IHNtdV9zZXRfZ2Z4X2NncGcoc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUsIGJvb2wgZW5hYmxlZCk7DQo+ICAgI2RlZmluZSBzbXVfZ2V0X3ZiaW9zX2Jvb3R1cF92
YWx1ZXMoc211KSBcDQo+ICAgCSgoc211KS0+ZnVuY3MtPmdldF92Ymlvc19ib290dXBfdmFsdWVz
ID8gKHNtdSktPmZ1bmNzLT5nZXRfdmJpb3NfYm9vdHVwX3ZhbHVlcygoc211KSkgOiAwKQ0KPiAg
ICNkZWZpbmUgc211X2dldF9jbGtfaW5mb19mcm9tX3ZiaW9zKHNtdSkgXA0KPiBAQCAtNjEwLDgg
KzYwOSw4IEBAIHN0cnVjdCBzbXVfZnVuY3MNCj4gICAJKChzbXUpLT5mdW5jcy0+aW5pdF9tYXhf
c3VzdGFpbmFibGVfY2xvY2tzID8gKHNtdSktPmZ1bmNzLT5pbml0X21heF9zdXN0YWluYWJsZV9j
bG9ja3MoKHNtdSkpIDogMCkNCj4gICAjZGVmaW5lIHNtdV9zZXRfZGVmYXVsdF9vZF9zZXR0aW5n
cyhzbXUsIGluaXRpYWxpemUpIFwNCj4gICAJKChzbXUpLT5wcHRfZnVuY3MtPnNldF9kZWZhdWx0
X29kX3NldHRpbmdzID8gKHNtdSktPnBwdF9mdW5jcy0+c2V0X2RlZmF1bHRfb2Rfc2V0dGluZ3Mo
KHNtdSksIChpbml0aWFsaXplKSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfc2V0X2Zhbl9zcGVlZF9y
cG0oc211LCBzcGVlZCkgXA0KPiAtCSgoc211KS0+ZnVuY3MtPnNldF9mYW5fc3BlZWRfcnBtID8g
KHNtdSktPmZ1bmNzLT5zZXRfZmFuX3NwZWVkX3JwbSgoc211KSwgKHNwZWVkKSkgOiAwKQ0KPiAr
aW50IHNtdV9zZXRfZmFuX3NwZWVkX3JwbShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDMy
X3Qgc3BlZWQpOw0KPiArDQo+ICAgI2RlZmluZSBzbXVfc2VuZF9zbWNfbXNnKHNtdSwgbXNnKSBc
DQo+ICAgCSgoc211KS0+ZnVuY3MtPnNlbmRfc21jX21zZz8gKHNtdSktPmZ1bmNzLT5zZW5kX3Nt
Y19tc2coKHNtdSksIChtc2cpKSA6IDApDQo+ICAgI2RlZmluZSBzbXVfc2VuZF9zbWNfbXNnX3dp
dGhfcGFyYW0oc211LCBtc2csIHBhcmFtKSBcDQo+IEBAIC02NDIsMjAgKzY0MSwyMiBAQCBzdHJ1
Y3Qgc211X2Z1bmNzDQo+ICAgCSgoc211KS0+cHB0X2Z1bmNzLT5wb3B1bGF0ZV91bWRfc3RhdGVf
Y2xrID8gKHNtdSktPnBwdF9mdW5jcy0+cG9wdWxhdGVfdW1kX3N0YXRlX2Nsaygoc211KSkgOiAw
KQ0KPiAgICNkZWZpbmUgc211X3NldF9kZWZhdWx0X29kOF9zZXR0aW5ncyhzbXUpIFwNCj4gICAJ
KChzbXUpLT5wcHRfZnVuY3MtPnNldF9kZWZhdWx0X29kOF9zZXR0aW5ncyA/IChzbXUpLT5wcHRf
ZnVuY3MtPnNldF9kZWZhdWx0X29kOF9zZXR0aW5ncygoc211KSkgOiAwKQ0KPiAtI2RlZmluZSBz
bXVfZ2V0X3Bvd2VyX2xpbWl0KHNtdSwgbGltaXQsIGRlZikgXA0KPiAtCSgoc211KS0+cHB0X2Z1
bmNzLT5nZXRfcG93ZXJfbGltaXQgPyAoc211KS0+cHB0X2Z1bmNzLT5nZXRfcG93ZXJfbGltaXQo
KHNtdSksIChsaW1pdCksIChkZWYpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9zZXRfcG93ZXJfbGlt
aXQoc211LCBsaW1pdCkgXA0KPiAtCSgoc211KS0+ZnVuY3MtPnNldF9wb3dlcl9saW1pdCA/IChz
bXUpLT5mdW5jcy0+c2V0X3Bvd2VyX2xpbWl0KChzbXUpLCAobGltaXQpKSA6IDApDQo+ICsNCj4g
K2ludCBzbXVfZ2V0X3Bvd2VyX2xpbWl0KHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiArCQkJ
dWludDMyX3QgKmxpbWl0LA0KPiArCQkJYm9vbCBkZWYsDQo+ICsJCQlib29sIGxvY2tfbmVlZGVk
KTsNCj4gKw0KPiAraW50IHNtdV9zZXRfcG93ZXJfbGltaXQoc3RydWN0IHNtdV9jb250ZXh0ICpz
bXUsIHVpbnQzMl90IGxpbWl0KTsNCj4gICAjZGVmaW5lIHNtdV9nZXRfY3VycmVudF9jbGtfZnJl
cShzbXUsIGNsa19pZCwgdmFsdWUpIFwNCj4gICAJKChzbXUpLT5mdW5jcy0+Z2V0X2N1cnJlbnRf
Y2xrX2ZyZXE/IChzbXUpLT5mdW5jcy0+Z2V0X2N1cnJlbnRfY2xrX2ZyZXEoKHNtdSksIChjbGtf
aWQpLCAodmFsdWUpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9wcmludF9jbGtfbGV2ZWxzKHNtdSwg
Y2xrX3R5cGUsIGJ1ZikgXA0KPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5wcmludF9jbGtfbGV2ZWxz
ID8gKHNtdSktPnBwdF9mdW5jcy0+cHJpbnRfY2xrX2xldmVscygoc211KSwgKGNsa190eXBlKSwg
KGJ1ZikpIDogMCkNCj4gLSNkZWZpbmUgc211X2dldF9vZF9wZXJjZW50YWdlKHNtdSwgdHlwZSkg
XA0KPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5nZXRfb2RfcGVyY2VudGFnZSA/IChzbXUpLT5wcHRf
ZnVuY3MtPmdldF9vZF9wZXJjZW50YWdlKChzbXUpLCAodHlwZSkpIDogMCkNCj4gLSNkZWZpbmUg
c211X3NldF9vZF9wZXJjZW50YWdlKHNtdSwgdHlwZSwgdmFsdWUpIFwNCj4gLQkoKHNtdSktPnBw
dF9mdW5jcy0+c2V0X29kX3BlcmNlbnRhZ2UgPyAoc211KS0+cHB0X2Z1bmNzLT5zZXRfb2RfcGVy
Y2VudGFnZSgoc211KSwgKHR5cGUpLCAodmFsdWUpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9vZF9l
ZGl0X2RwbV90YWJsZShzbXUsIHR5cGUsIGlucHV0LCBzaXplKSBcDQo+IC0JKChzbXUpLT5wcHRf
ZnVuY3MtPm9kX2VkaXRfZHBtX3RhYmxlID8gKHNtdSktPnBwdF9mdW5jcy0+b2RfZWRpdF9kcG1f
dGFibGUoKHNtdSksICh0eXBlKSwgKGlucHV0KSwgKHNpemUpKSA6IDApDQo+ICtpbnQgc211X3By
aW50X2Nsa19sZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0gc211X2Nsa190eXBl
IGNsa190eXBlLCBjaGFyICpidWYpOw0KPiAraW50IHNtdV9nZXRfb2RfcGVyY2VudGFnZShzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVfY2xrX3R5cGUgdHlwZSk7DQo+ICtpbnQgc211
X3NldF9vZF9wZXJjZW50YWdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9jbGtf
dHlwZSB0eXBlLCB1aW50MzJfdCB2YWx1ZSk7DQo+ICsNCj4gK2ludCBzbXVfb2RfZWRpdF9kcG1f
dGFibGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICsJCQkgIGVudW0gUFBfT0RfRFBNX1RB
QkxFX0NPTU1BTkQgdHlwZSwNCj4gKwkJCSAgbG9uZyAqaW5wdXQsIHVpbnQzMl90IHNpemUpOw0K
PiAgICNkZWZpbmUgc211X3RhYmxlc19pbml0KHNtdSwgdGFiKSBcDQo+ICAgCSgoc211KS0+cHB0
X2Z1bmNzLT50YWJsZXNfaW5pdCA/IChzbXUpLT5wcHRfZnVuY3MtPnRhYmxlc19pbml0KChzbXUp
LCAodGFiKSkgOiAwKQ0KPiAgICNkZWZpbmUgc211X3NldF90aGVybWFsX2Zhbl90YWJsZShzbXUp
IFwNCj4gQEAgLTY2NCwxNCArNjY1LDE4IEBAIHN0cnVjdCBzbXVfZnVuY3MNCj4gICAJKChzbXUp
LT5mdW5jcy0+c3RhcnRfdGhlcm1hbF9jb250cm9sPyAoc211KS0+ZnVuY3MtPnN0YXJ0X3RoZXJt
YWxfY29udHJvbCgoc211KSkgOiAwKQ0KPiAgICNkZWZpbmUgc211X3N0b3BfdGhlcm1hbF9jb250
cm9sKHNtdSkgXA0KPiAgIAkoKHNtdSktPmZ1bmNzLT5zdG9wX3RoZXJtYWxfY29udHJvbD8gKHNt
dSktPmZ1bmNzLT5zdG9wX3RoZXJtYWxfY29udHJvbCgoc211KSkgOiAwKQ0KPiAtI2RlZmluZSBz
bXVfcmVhZF9zZW5zb3Ioc211LCBzZW5zb3IsIGRhdGEsIHNpemUpIFwNCj4gLQkoKHNtdSktPnBw
dF9mdW5jcy0+cmVhZF9zZW5zb3I/IChzbXUpLT5wcHRfZnVuY3MtPnJlYWRfc2Vuc29yKChzbXUp
LCAoc2Vuc29yKSwgKGRhdGEpLCAoc2l6ZSkpIDogMCkNCj4gKw0KPiAraW50IHNtdV9yZWFkX3Nl
bnNvcihzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gKwkJICAgIGVudW0gYW1kX3BwX3NlbnNv
cnMgc2Vuc29yLA0KPiArCQkgICAgdm9pZCAqZGF0YSwgdWludDMyX3QgKnNpemUpOw0KPiAgICNk
ZWZpbmUgc211X3NtY19yZWFkX3NlbnNvcihzbXUsIHNlbnNvciwgZGF0YSwgc2l6ZSkgXA0KPiAg
IAkoKHNtdSktPmZ1bmNzLT5yZWFkX3NlbnNvcj8gKHNtdSktPmZ1bmNzLT5yZWFkX3NlbnNvcigo
c211KSwgKHNlbnNvciksIChkYXRhKSwgKHNpemUpKSA6IC1FSU5WQUwpDQo+IC0jZGVmaW5lIHNt
dV9nZXRfcG93ZXJfcHJvZmlsZV9tb2RlKHNtdSwgYnVmKSBcDQo+IC0JKChzbXUpLT5wcHRfZnVu
Y3MtPmdldF9wb3dlcl9wcm9maWxlX21vZGUgPyAoc211KS0+cHB0X2Z1bmNzLT5nZXRfcG93ZXJf
cHJvZmlsZV9tb2RlKChzbXUpLCBidWYpIDogMCkNCj4gLSNkZWZpbmUgc211X3NldF9wb3dlcl9w
cm9maWxlX21vZGUoc211LCBwYXJhbSwgcGFyYW1fc2l6ZSkgXA0KPiAtCSgoc211KS0+cHB0X2Z1
bmNzLT5zZXRfcG93ZXJfcHJvZmlsZV9tb2RlID8gKHNtdSktPnBwdF9mdW5jcy0+c2V0X3Bvd2Vy
X3Byb2ZpbGVfbW9kZSgoc211KSwgKHBhcmFtKSwgKHBhcmFtX3NpemUpKSA6IDApDQo+ICtpbnQg
c211X2dldF9wb3dlcl9wcm9maWxlX21vZGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGNoYXIg
KmJ1Zik7DQo+ICsNCj4gK2ludCBzbXVfc2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZShzdHJ1Y3Qgc211
X2NvbnRleHQgKnNtdSwNCj4gKwkJCSAgICAgICBsb25nICpwYXJhbSwNCj4gKwkJCSAgICAgICB1
aW50MzJfdCBwYXJhbV9zaXplLA0KPiArCQkJICAgICAgIGJvb2wgbG9ja19uZWVkZWQpOw0KPiAg
ICNkZWZpbmUgc211X3ByZV9kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkKHNtdSkgXA0KPiAgIAkoKHNt
dSktPnBwdF9mdW5jcy0+cHJlX2Rpc3BsYXlfY29uZmlnX2NoYW5nZWQgPyAoc211KS0+cHB0X2Z1
bmNzLT5wcmVfZGlzcGxheV9jb25maWdfY2hhbmdlZCgoc211KSkgOiAwKQ0KPiAgICNkZWZpbmUg
c211X2Rpc3BsYXlfY29uZmlnX2NoYW5nZWQoc211KSBcDQo+IEBAIC02ODgsMTYgKzY5MywxMSBA
QCBzdHJ1Y3Qgc211X2Z1bmNzDQo+ICAgCSgoc211KS0+cHB0X2Z1bmNzLT5nZXRfcHJvZmlsaW5n
X2Nsa19tYXNrID8gKHNtdSktPnBwdF9mdW5jcy0+Z2V0X3Byb2ZpbGluZ19jbGtfbWFzaygoc211
KSwgKGxldmVsKSwgKHNjbGtfbWFzayksIChtY2xrX21hc2spLCAoc29jX21hc2spKSA6IDApDQo+
ICAgI2RlZmluZSBzbXVfc2V0X2NwdV9wb3dlcl9zdGF0ZShzbXUpIFwNCj4gICAJKChzbXUpLT5w
cHRfZnVuY3MtPnNldF9jcHVfcG93ZXJfc3RhdGUgPyAoc211KS0+cHB0X2Z1bmNzLT5zZXRfY3B1
X3Bvd2VyX3N0YXRlKChzbXUpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9nZXRfZmFuX2NvbnRyb2xf
bW9kZShzbXUpIFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5nZXRfZmFuX2NvbnRyb2xfbW9kZSA/IChz
bXUpLT5mdW5jcy0+Z2V0X2Zhbl9jb250cm9sX21vZGUoKHNtdSkpIDogMCkNCj4gLSNkZWZpbmUg
c211X3NldF9mYW5fY29udHJvbF9tb2RlKHNtdSwgdmFsdWUpIFwNCj4gLQkoKHNtdSktPmZ1bmNz
LT5zZXRfZmFuX2NvbnRyb2xfbW9kZSA/IChzbXUpLT5mdW5jcy0+c2V0X2Zhbl9jb250cm9sX21v
ZGUoKHNtdSksICh2YWx1ZSkpIDogMCkNCj4gLSNkZWZpbmUgc211X2dldF9mYW5fc3BlZWRfcGVy
Y2VudChzbXUsIHNwZWVkKSBcDQo+IC0JKChzbXUpLT5wcHRfZnVuY3MtPmdldF9mYW5fc3BlZWRf
cGVyY2VudCA/IChzbXUpLT5wcHRfZnVuY3MtPmdldF9mYW5fc3BlZWRfcGVyY2VudCgoc211KSwg
KHNwZWVkKSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfc2V0X2Zhbl9zcGVlZF9wZXJjZW50KHNtdSwg
c3BlZWQpIFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5zZXRfZmFuX3NwZWVkX3BlcmNlbnQgPyAoc211
KS0+ZnVuY3MtPnNldF9mYW5fc3BlZWRfcGVyY2VudCgoc211KSwgKHNwZWVkKSkgOiAwKQ0KPiAt
I2RlZmluZSBzbXVfZ2V0X2Zhbl9zcGVlZF9ycG0oc211LCBzcGVlZCkgXA0KPiAtCSgoc211KS0+
cHB0X2Z1bmNzLT5nZXRfZmFuX3NwZWVkX3JwbSA/IChzbXUpLT5wcHRfZnVuY3MtPmdldF9mYW5f
c3BlZWRfcnBtKChzbXUpLCAoc3BlZWQpKSA6IDApDQo+ICtpbnQgc211X2dldF9mYW5fY29udHJv
bF9tb2RlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KTsNCj4gK2ludCBzbXVfc2V0X2Zhbl9jb250
cm9sX21vZGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGludCB2YWx1ZSk7DQo+ICtpbnQgc211
X2dldF9mYW5fc3BlZWRfcGVyY2VudChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDMyX3Qg
KnNwZWVkKTsNCj4gK2ludCBzbXVfc2V0X2Zhbl9zcGVlZF9wZXJjZW50KHN0cnVjdCBzbXVfY29u
dGV4dCAqc211LCB1aW50MzJfdCBzcGVlZCk7DQo+ICtpbnQgc211X2dldF9mYW5fc3BlZWRfcnBt
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LCB1aW50MzJfdCAqc3BlZWQpOw0KPiAgIA0KPiAgICNk
ZWZpbmUgc211X21zZ19nZXRfaW5kZXgoc211LCBtc2cpIFwNCj4gICAJKChzbXUpLT5wcHRfZnVu
Y3M/ICgoc211KS0+cHB0X2Z1bmNzLT5nZXRfc211X21zZ19pbmRleD8gKHNtdSktPnBwdF9mdW5j
cy0+Z2V0X3NtdV9tc2dfaW5kZXgoKHNtdSksIChtc2cpKSA6IC1FSU5WQUwpIDogLUVJTlZBTCkN
Cj4gQEAgLTcxNSw0MCArNzE1LDQ2IEBAIHN0cnVjdCBzbXVfZnVuY3MNCj4gICAJKChzbXUpLT5w
cHRfZnVuY3M/ICgoc211KS0+cHB0X2Z1bmNzLT5ydW5fYnRjPyAoc211KS0+cHB0X2Z1bmNzLT5y
dW5fYnRjKChzbXUpKSA6IDApIDogMCkNCj4gICAjZGVmaW5lIHNtdV9nZXRfYWxsb3dlZF9mZWF0
dXJlX21hc2soc211LCBmZWF0dXJlX21hc2ssIG51bSkgXA0KPiAgIAkoKHNtdSktPnBwdF9mdW5j
cz8gKChzbXUpLT5wcHRfZnVuY3MtPmdldF9hbGxvd2VkX2ZlYXR1cmVfbWFzaz8gKHNtdSktPnBw
dF9mdW5jcy0+Z2V0X2FsbG93ZWRfZmVhdHVyZV9tYXNrKChzbXUpLCAoZmVhdHVyZV9tYXNrKSwg
KG51bSkpIDogMCkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfc2V0X2RlZXBfc2xlZXBfZGNlZmNsayhz
bXUsIGNsaykgXA0KPiAtCSgoc211KS0+ZnVuY3MtPnNldF9kZWVwX3NsZWVwX2RjZWZjbGsgPyAo
c211KS0+ZnVuY3MtPnNldF9kZWVwX3NsZWVwX2RjZWZjbGsoKHNtdSksIChjbGspKSA6IDApDQo+
IC0jZGVmaW5lIHNtdV9zZXRfYWN0aXZlX2Rpc3BsYXlfY291bnQoc211LCBjb3VudCkgXA0KPiAt
CSgoc211KS0+ZnVuY3MtPnNldF9hY3RpdmVfZGlzcGxheV9jb3VudCA/IChzbXUpLT5mdW5jcy0+
c2V0X2FjdGl2ZV9kaXNwbGF5X2NvdW50KChzbXUpLCAoY291bnQpKSA6IDApDQo+ICtpbnQgc211
X3NldF9kZWVwX3NsZWVwX2RjZWZjbGsoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGludCBjbGsp
Ow0KPiAraW50IHNtdV9zZXRfYWN0aXZlX2Rpc3BsYXlfY291bnQoc3RydWN0IHNtdV9jb250ZXh0
ICpzbXUsIHVpbnQzMl90IGNvdW50KTsNCj4gICAjZGVmaW5lIHNtdV9zdG9yZV9jYzZfZGF0YShz
bXUsIHN0LCBjYzZfZGlzLCBwc3RfZGlzLCBwc3Rfc3dfZGlzKSBcDQo+ICAgCSgoc211KS0+ZnVu
Y3MtPnN0b3JlX2NjNl9kYXRhID8gKHNtdSktPmZ1bmNzLT5zdG9yZV9jYzZfZGF0YSgoc211KSwg
KHN0KSwgKGNjNl9kaXMpLCAocHN0X2RpcyksIChwc3Rfc3dfZGlzKSkgOiAwKQ0KPiAtI2RlZmlu
ZSBzbXVfZ2V0X2Nsb2NrX2J5X3R5cGUoc211LCB0eXBlLCBjbG9ja3MpIFwNCj4gLQkoKHNtdSkt
PmZ1bmNzLT5nZXRfY2xvY2tfYnlfdHlwZSA/IChzbXUpLT5mdW5jcy0+Z2V0X2Nsb2NrX2J5X3R5
cGUoKHNtdSksICh0eXBlKSwgKGNsb2NrcykpIDogMCkNCj4gLSNkZWZpbmUgc211X2dldF9tYXhf
aGlnaF9jbG9ja3Moc211LCBjbG9ja3MpIFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5nZXRfbWF4X2hp
Z2hfY2xvY2tzID8gKHNtdSktPmZ1bmNzLT5nZXRfbWF4X2hpZ2hfY2xvY2tzKChzbXUpLCAoY2xv
Y2tzKSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfZ2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF9sYXRlbmN5
KHNtdSwgY2xrX3R5cGUsIGNsb2NrcykgXA0KPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5nZXRfY2xv
Y2tfYnlfdHlwZV93aXRoX2xhdGVuY3kgPyAoc211KS0+cHB0X2Z1bmNzLT5nZXRfY2xvY2tfYnlf
dHlwZV93aXRoX2xhdGVuY3koKHNtdSksIChjbGtfdHlwZSksIChjbG9ja3MpKSA6IDApDQo+IC0j
ZGVmaW5lIHNtdV9nZXRfY2xvY2tfYnlfdHlwZV93aXRoX3ZvbHRhZ2Uoc211LCB0eXBlLCBjbG9j
a3MpIFwNCj4gLQkoKHNtdSktPnBwdF9mdW5jcy0+Z2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF92b2x0
YWdlID8gKHNtdSktPnBwdF9mdW5jcy0+Z2V0X2Nsb2NrX2J5X3R5cGVfd2l0aF92b2x0YWdlKChz
bXUpLCAodHlwZSksIChjbG9ja3MpKSA6IDApDQo+IC0jZGVmaW5lIHNtdV9kaXNwbGF5X2Nsb2Nr
X3ZvbHRhZ2VfcmVxdWVzdChzbXUsIGNsb2NrX3JlcSkgXA0KPiAtCSgoc211KS0+ZnVuY3MtPmRp
c3BsYXlfY2xvY2tfdm9sdGFnZV9yZXF1ZXN0ID8gKHNtdSktPmZ1bmNzLT5kaXNwbGF5X2Nsb2Nr
X3ZvbHRhZ2VfcmVxdWVzdCgoc211KSwgKGNsb2NrX3JlcSkpIDogMCkNCj4gLSNkZWZpbmUgc211
X2Rpc3BsYXlfZGlzYWJsZV9tZW1vcnlfY2xvY2tfc3dpdGNoKHNtdSwgZGlzYWJsZV9tZW1vcnlf
Y2xvY2tfc3dpdGNoKSBcDQo+IC0JKChzbXUpLT5wcHRfZnVuY3MtPmRpc3BsYXlfZGlzYWJsZV9t
ZW1vcnlfY2xvY2tfc3dpdGNoID8gKHNtdSktPnBwdF9mdW5jcy0+ZGlzcGxheV9kaXNhYmxlX21l
bW9yeV9jbG9ja19zd2l0Y2goKHNtdSksIChkaXNhYmxlX21lbW9yeV9jbG9ja19zd2l0Y2gpKSA6
IC1FSU5WQUwpDQo+ICsNCj4gK2ludCBzbXVfZ2V0X2Nsb2NrX2J5X3R5cGUoc3RydWN0IHNtdV9j
b250ZXh0ICpzbXUsDQo+ICsJCQkgIGVudW0gYW1kX3BwX2Nsb2NrX3R5cGUgdHlwZSwNCj4gKwkJ
CSAgc3RydWN0IGFtZF9wcF9jbG9ja3MgKmNsb2Nrcyk7DQo+ICsNCj4gK2ludCBzbXVfZ2V0X21h
eF9oaWdoX2Nsb2NrcyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gKwkJCSAgICBzdHJ1Y3Qg
YW1kX3BwX3NpbXBsZV9jbG9ja19pbmZvICpjbG9ja3MpOw0KPiArDQo+ICtpbnQgc211X2dldF9j
bG9ja19ieV90eXBlX3dpdGhfbGF0ZW5jeShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gKwkJ
CQkgICAgICAgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsDQo+ICsJCQkJICAgICAgIHN0cnVj
dCBwcF9jbG9ja19sZXZlbHNfd2l0aF9sYXRlbmN5ICpjbG9ja3MpOw0KPiArDQo+ICtpbnQgc211
X2dldF9jbG9ja19ieV90eXBlX3dpdGhfdm9sdGFnZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwN
Cj4gKwkJCQkgICAgICAgZW51bSBhbWRfcHBfY2xvY2tfdHlwZSB0eXBlLA0KPiArCQkJCSAgICAg
ICBzdHJ1Y3QgcHBfY2xvY2tfbGV2ZWxzX3dpdGhfdm9sdGFnZSAqY2xvY2tzKTsNCj4gKw0KPiAr
aW50IHNtdV9kaXNwbGF5X2Nsb2NrX3ZvbHRhZ2VfcmVxdWVzdChzdHJ1Y3Qgc211X2NvbnRleHQg
KnNtdSwNCj4gKwkJCQkgICAgICBzdHJ1Y3QgcHBfZGlzcGxheV9jbG9ja19yZXF1ZXN0ICpjbG9j
a19yZXEpOw0KPiAraW50IHNtdV9kaXNwbGF5X2Rpc2FibGVfbWVtb3J5X2Nsb2NrX3N3aXRjaChz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgYm9vbCBkaXNhYmxlX21lbW9yeV9jbG9ja19zd2l0Y2gp
Ow0KPiAgICNkZWZpbmUgc211X2dldF9kYWxfcG93ZXJfbGV2ZWwoc211LCBjbG9ja3MpIFwNCj4g
ICAJKChzbXUpLT5mdW5jcy0+Z2V0X2RhbF9wb3dlcl9sZXZlbCA/IChzbXUpLT5mdW5jcy0+Z2V0
X2RhbF9wb3dlcl9sZXZlbCgoc211KSwgKGNsb2NrcykpIDogMCkNCj4gICAjZGVmaW5lIHNtdV9n
ZXRfcGVyZl9sZXZlbChzbXUsIGRlc2lnbmF0aW9uLCBsZXZlbCkgXA0KPiAgIAkoKHNtdSktPmZ1
bmNzLT5nZXRfcGVyZl9sZXZlbCA/IChzbXUpLT5mdW5jcy0+Z2V0X3BlcmZfbGV2ZWwoKHNtdSks
IChkZXNpZ25hdGlvbiksIChsZXZlbCkpIDogMCkNCj4gICAjZGVmaW5lIHNtdV9nZXRfY3VycmVu
dF9zaGFsbG93X3NsZWVwX2Nsb2NrcyhzbXUsIGNsb2NrcykgXA0KPiAgIAkoKHNtdSktPmZ1bmNz
LT5nZXRfY3VycmVudF9zaGFsbG93X3NsZWVwX2Nsb2NrcyA/IChzbXUpLT5mdW5jcy0+Z2V0X2N1
cnJlbnRfc2hhbGxvd19zbGVlcF9jbG9ja3MoKHNtdSksIChjbG9ja3MpKSA6IDApDQo+IC0jZGVm
aW5lIHNtdV9ub3RpZnlfc211X2VuYWJsZV9wd2Uoc211KSBcDQo+IC0JKChzbXUpLT5mdW5jcy0+
bm90aWZ5X3NtdV9lbmFibGVfcHdlID8gKHNtdSktPmZ1bmNzLT5ub3RpZnlfc211X2VuYWJsZV9w
d2UoKHNtdSkpIDogMCkNCj4gLSNkZWZpbmUgc211X3NldF93YXRlcm1hcmtzX2Zvcl9jbG9ja19y
YW5nZXMoc211LCBjbG9ja19yYW5nZXMpIFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5zZXRfd2F0ZXJt
YXJrc19mb3JfY2xvY2tfcmFuZ2VzID8gKHNtdSktPmZ1bmNzLT5zZXRfd2F0ZXJtYXJrc19mb3Jf
Y2xvY2tfcmFuZ2VzKChzbXUpLCAoY2xvY2tfcmFuZ2VzKSkgOiAwKQ0KPiAraW50IHNtdV9ub3Rp
Znlfc211X2VuYWJsZV9wd2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpOw0KPiArDQo+ICtpbnQg
c211X3NldF93YXRlcm1hcmtzX2Zvcl9jbG9ja19yYW5nZXMoc3RydWN0IHNtdV9jb250ZXh0ICpz
bXUsDQo+ICsJCQkJCXN0cnVjdCBkbV9wcF93bV9zZXRzX3dpdGhfY2xvY2tfcmFuZ2VzX3NvYzE1
ICpjbG9ja19yYW5nZXMpOw0KPiAgICNkZWZpbmUgc211X2RwbV9zZXRfdXZkX2VuYWJsZShzbXUs
IGVuYWJsZSkgXA0KPiAgIAkoKHNtdSktPnBwdF9mdW5jcy0+ZHBtX3NldF91dmRfZW5hYmxlID8g
KHNtdSktPnBwdF9mdW5jcy0+ZHBtX3NldF91dmRfZW5hYmxlKChzbXUpLCAoZW5hYmxlKSkgOiAw
KQ0KPiAgICNkZWZpbmUgc211X2RwbV9zZXRfdmNlX2VuYWJsZShzbXUsIGVuYWJsZSkgXA0KPiAg
IAkoKHNtdSktPnBwdF9mdW5jcy0+ZHBtX3NldF92Y2VfZW5hYmxlID8gKHNtdSktPnBwdF9mdW5j
cy0+ZHBtX3NldF92Y2VfZW5hYmxlKChzbXUpLCAoZW5hYmxlKSkgOiAwKQ0KPiAtI2RlZmluZSBz
bXVfc2V0X3hnbWlfcHN0YXRlKHNtdSwgcHN0YXRlKSBcDQo+IC0JCSgoc211KS0+ZnVuY3MtPnNl
dF94Z21pX3BzdGF0ZSA/IChzbXUpLT5mdW5jcy0+c2V0X3hnbWlfcHN0YXRlKChzbXUpLCAocHN0
YXRlKSkgOiAwKQ0KPiArDQo+ICtpbnQgc211X3NldF94Z21pX3BzdGF0ZShzdHJ1Y3Qgc211X2Nv
bnRleHQgKnNtdSwNCj4gKwkJCXVpbnQzMl90IHBzdGF0ZSk7DQo+ICAgI2RlZmluZSBzbXVfc2V0
X3dhdGVybWFya3NfdGFibGUoc211LCB0YWIsIGNsb2NrX3JhbmdlcykgXA0KPiAgIAkoKHNtdSkt
PnBwdF9mdW5jcy0+c2V0X3dhdGVybWFya3NfdGFibGUgPyAoc211KS0+cHB0X2Z1bmNzLT5zZXRf
d2F0ZXJtYXJrc190YWJsZSgoc211KSwgKHRhYiksIChjbG9ja19yYW5nZXMpKSA6IDApDQo+ICAg
I2RlZmluZSBzbXVfZ2V0X2N1cnJlbnRfY2xrX2ZyZXFfYnlfdGFibGUoc211LCBjbGtfdHlwZSwg
dmFsdWUpIFwNCj4gQEAgLTc1OSwyMiArNzY1LDE4IEBAIHN0cnVjdCBzbXVfZnVuY3MNCj4gICAJ
KChzbXUpLT5wcHRfZnVuY3MtPmdldF90aGVybWFsX3RlbXBlcmF0dXJlX3JhbmdlPyAoc211KS0+
cHB0X2Z1bmNzLT5nZXRfdGhlcm1hbF90ZW1wZXJhdHVyZV9yYW5nZSgoc211KSwgKHJhbmdlKSkg
OiAwKQ0KPiAgICNkZWZpbmUgc211X3JlZ2lzdGVyX2lycV9oYW5kbGVyKHNtdSkgXA0KPiAgIAko
KHNtdSktPmZ1bmNzLT5yZWdpc3Rlcl9pcnFfaGFuZGxlciA/IChzbXUpLT5mdW5jcy0+cmVnaXN0
ZXJfaXJxX2hhbmRsZXIoc211KSA6IDApDQo+IC0jZGVmaW5lIHNtdV9zZXRfYXphbGlhX2QzX3Bt
ZShzbXUpIFwNCj4gLQkoKHNtdSktPmZ1bmNzLT5zZXRfYXphbGlhX2QzX3BtZSA/IChzbXUpLT5m
dW5jcy0+c2V0X2F6YWxpYV9kM19wbWUoKHNtdSkpIDogMCkNCj4gKw0KPiAraW50IHNtdV9zZXRf
YXphbGlhX2QzX3BtZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSk7DQo+ICAgI2RlZmluZSBzbXVf
Z2V0X2RwbV91bHRpbWF0ZV9mcmVxKHNtdSwgcGFyYW0sIG1pbiwgbWF4KSBcDQo+ICAgCQkoKHNt
dSktPmZ1bmNzLT5nZXRfZHBtX3VsdGltYXRlX2ZyZXEgPyAoc211KS0+ZnVuY3MtPmdldF9kcG1f
dWx0aW1hdGVfZnJlcSgoc211KSwgKHBhcmFtKSwgKG1pbiksIChtYXgpKSA6IDApDQo+IC0jZGVm
aW5lIHNtdV9nZXRfdWNsa19kcG1fc3RhdGVzKHNtdSwgY2xvY2tzX2luX2toeiwgbnVtX3N0YXRl
cykgXA0KPiAtCSgoc211KS0+cHB0X2Z1bmNzLT5nZXRfdWNsa19kcG1fc3RhdGVzID8gKHNtdSkt
PnBwdF9mdW5jcy0+Z2V0X3VjbGtfZHBtX3N0YXRlcygoc211KSwgKGNsb2Nrc19pbl9raHopLCAo
bnVtX3N0YXRlcykpIDogMCkNCj4gLSNkZWZpbmUgc211X2dldF9tYXhfc3VzdGFpbmFibGVfY2xv
Y2tzX2J5X2RjKHNtdSwgbWF4X2Nsb2NrcykgXA0KPiAtCSgoc211KS0+ZnVuY3MtPmdldF9tYXhf
c3VzdGFpbmFibGVfY2xvY2tzX2J5X2RjID8gKHNtdSktPmZ1bmNzLT5nZXRfbWF4X3N1c3RhaW5h
YmxlX2Nsb2Nrc19ieV9kYygoc211KSwgKG1heF9jbG9ja3MpKSA6IDApDQo+IC0jZGVmaW5lIHNt
dV9iYWNvX2lzX3N1cHBvcnQoc211KSBcDQo+IC0JKChzbXUpLT5mdW5jcy0+YmFjb19pc19zdXBw
b3J0PyAoc211KS0+ZnVuY3MtPmJhY29faXNfc3VwcG9ydCgoc211KSkgOiBmYWxzZSkNCj4gLSNk
ZWZpbmUgc211X2JhY29fZ2V0X3N0YXRlKHNtdSwgc3RhdGUpIFwNCj4gLQkoKHNtdSktPmZ1bmNz
LT5iYWNvX2dldF9zdGF0ZT8gKHNtdSktPmZ1bmNzLT5iYWNvX2dldF9zdGF0ZSgoc211KSwgKHN0
YXRlKSkgOiAwKQ0KPiAtI2RlZmluZSBzbXVfYmFjb19yZXNldChzbXUpIFwNCj4gLQkoKHNtdSkt
PmZ1bmNzLT5iYWNvX3Jlc2V0PyAoc211KS0+ZnVuY3MtPmJhY29fcmVzZXQoKHNtdSkpIDogMCkN
Cj4gLSNkZWZpbmUgc211X21vZGUyX3Jlc2V0KHNtdSkgXA0KPiAtCSgoc211KS0+ZnVuY3MtPm1v
ZGUyX3Jlc2V0PyAoc211KS0+ZnVuY3MtPm1vZGUyX3Jlc2V0KChzbXUpKSA6IDApDQo+ICsNCj4g
K2Jvb2wgc211X2JhY29faXNfc3VwcG9ydChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSk7DQo+ICsN
Cj4gK2ludCBzbXVfYmFjb19nZXRfc3RhdGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0g
c211X2JhY29fc3RhdGUgKnN0YXRlKTsNCj4gKw0KPiAraW50IHNtdV9iYWNvX3Jlc2V0KHN0cnVj
dCBzbXVfY29udGV4dCAqc211KTsNCj4gKw0KPiAraW50IHNtdV9tb2RlMl9yZXNldChzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSk7DQo+ICAgI2RlZmluZSBzbXVfYXNpY19zZXRfcGVyZm9ybWFuY2Vf
bGV2ZWwoc211LCBsZXZlbCkgXA0KPiAgIAkoKHNtdSktPnBwdF9mdW5jcy0+c2V0X3BlcmZvcm1h
bmNlX2xldmVsPyAoc211KS0+cHB0X2Z1bmNzLT5zZXRfcGVyZm9ybWFuY2VfbGV2ZWwoKHNtdSks
IChsZXZlbCkpIDogLUVJTlZBTCk7DQo+ICAgI2RlZmluZSBzbXVfZHVtcF9wcHRhYmxlKHNtdSkg
XA0KPiBAQCAtODMzLDcgKzgzNSw4IEBAIGV4dGVybiBpbnQgc211X2dldF9jdXJyZW50X2Nsb2Nr
cyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICBleHRlcm4gaW50IHNtdV9kcG1fc2V0X3Bv
d2VyX2dhdGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsdWludDMyX3QgYmxvY2tfdHlwZSwgYm9v
bCBnYXRlKTsNCj4gICBleHRlcm4gaW50IHNtdV9oYW5kbGVfdGFzayhzdHJ1Y3Qgc211X2NvbnRl
eHQgKnNtdSwNCj4gICAJCQkgICBlbnVtIGFtZF9kcG1fZm9yY2VkX2xldmVsIGxldmVsLA0KPiAt
CQkJICAgZW51bSBhbWRfcHBfdGFzayB0YXNrX2lkKTsNCj4gKwkJCSAgIGVudW0gYW1kX3BwX3Rh
c2sgdGFza19pZCwNCj4gKwkJCSAgIGJvb2wgbG9ja19uZWVkZWQpOw0KPiAgIGludCBzbXVfc3dp
dGNoX3Bvd2VyX3Byb2ZpbGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCQkJICAgICBl
bnVtIFBQX1NNQ19QT1dFUl9QUk9GSUxFIHR5cGUsDQo+ICAgCQkJICAgICBib29sIGVuKTsNCj4g
QEAgLTg0Myw3ICs4NDYsNyBAQCBpbnQgc211X2dldF9kcG1fZnJlcV9ieV9pbmRleChzdHJ1Y3Qg
c211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cA0KPiAgIGludCBzbXVf
Z2V0X2RwbV9sZXZlbF9jb3VudChzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBzbXVfY2xr
X3R5cGUgY2xrX3R5cGUsDQo+ICAgCQkJICAgIHVpbnQzMl90ICp2YWx1ZSk7DQo+ICAgaW50IHNt
dV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGVudW0gc211X2Ns
a190eXBlIGNsa190eXBlLA0KPiAtCQkJICAgdWludDMyX3QgKm1pbiwgdWludDMyX3QgKm1heCk7
DQo+ICsJCQkgICB1aW50MzJfdCAqbWluLCB1aW50MzJfdCAqbWF4LCBib29sIGxvY2tfbmVlZGVk
KTsNCj4gICBpbnQgc211X3NldF9zb2Z0X2ZyZXFfcmFuZ2Uoc3RydWN0IHNtdV9jb250ZXh0ICpz
bXUsIGVudW0gc211X2Nsa190eXBlIGNsa190eXBlLA0KPiAgIAkJCSAgICB1aW50MzJfdCBtaW4s
IHVpbnQzMl90IG1heCk7DQo+ICAgaW50IHNtdV9zZXRfaGFyZF9mcmVxX3JhbmdlKHN0cnVjdCBz
bXVfY29udGV4dCAqc211LCBlbnVtIHNtdV9jbGtfdHlwZSBjbGtfdHlwZSwNCj4gQEAgLTg1OCwx
MCArODYxLDIwIEBAIHNpemVfdCBzbXVfc3lzX2dldF9wcF9mZWF0dXJlX21hc2soc3RydWN0IHNt
dV9jb250ZXh0ICpzbXUsIGNoYXIgKmJ1Zik7DQo+ICAgaW50IHNtdV9zeXNfc2V0X3BwX2ZlYXR1
cmVfbWFzayhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgdWludDY0X3QgbmV3X21hc2spOw0KPiAg
IGludCBzbXVfZm9yY2VfY2xrX2xldmVscyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJ
CQkgZW51bSBzbXVfY2xrX3R5cGUgY2xrX3R5cGUsDQo+IC0JCQkgdWludDMyX3QgbWFzayk7DQo+
ICsJCQkgdWludDMyX3QgbWFzaywNCj4gKwkJCSBib29sIGxvY2tfbmVlZGVkKTsNCj4gICBpbnQg
c211X3NldF9tcDFfc3RhdGUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCQkgICAgICBl
bnVtIHBwX21wMV9zdGF0ZSBtcDFfc3RhdGUpOw0KPiAgIGludCBzbXVfc2V0X2RmX2NzdGF0ZShz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJCSAgICAgIGVudW0gcHBfZGZfY3N0YXRlIHN0
YXRlKTsNCj4gICANCj4gK2ludCBzbXVfZ2V0X21heF9zdXN0YWluYWJsZV9jbG9ja3NfYnlfZGMo
c3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICsJCQkJCSBzdHJ1Y3QgcHBfc211X252X2Nsb2Nr
X3RhYmxlICptYXhfY2xvY2tzKTsNCj4gKw0KPiAraW50IHNtdV9nZXRfdWNsa19kcG1fc3RhdGVz
KHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiArCQkJICAgIHVuc2lnbmVkIGludCAqY2xvY2tf
dmFsdWVzX2luX2toeiwNCj4gKwkJCSAgICB1bnNpZ25lZCBpbnQgKm51bV9zdGF0ZXMpOw0KPiAr
DQo+ICtlbnVtIGFtZF9wbV9zdGF0ZV90eXBlIHNtdV9nZXRfY3VycmVudF9wb3dlcl9zdGF0ZShz
dHJ1Y3Qgc211X2NvbnRleHQgKnNtdSk7DQo+ICsNCj4gICAjZW5kaWYNCj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25hdmkxMF9wcHQuYyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvcG93ZXJwbGF5L25hdmkxMF9wcHQuYw0KPiBpbmRleCBiODhhYWU5YmIyNDIuLmVh
ZDQwYjI4NDBmOSAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkv
bmF2aTEwX3BwdC5jDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25hdmkx
MF9wcHQuYw0KPiBAQCAtNzk1LDEzICs3OTUsMTMgQEAgc3RhdGljIGludCBuYXZpMTBfcG9wdWxh
dGVfdW1kX3N0YXRlX2NsayhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4gICAJaW50IHJldCA9
IDA7DQo+ICAgCXVpbnQzMl90IG1pbl9zY2xrX2ZyZXEgPSAwLCBtaW5fbWNsa19mcmVxID0gMDsN
Cj4gICANCj4gLQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgU01VX1NDTEssICZt
aW5fc2Nsa19mcmVxLCBOVUxMKTsNCj4gKwlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNt
dSwgU01VX1NDTEssICZtaW5fc2Nsa19mcmVxLCBOVUxMLCBmYWxzZSk7DQo+ICAgCWlmIChyZXQp
DQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiAgIAlzbXUtPnBzdGF0ZV9zY2xrID0gbWluX3Nj
bGtfZnJlcSAqIDEwMDsNCj4gICANCj4gLQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNt
dSwgU01VX01DTEssICZtaW5fbWNsa19mcmVxLCBOVUxMKTsNCj4gKwlyZXQgPSBzbXVfZ2V0X2Rw
bV9mcmVxX3JhbmdlKHNtdSwgU01VX01DTEssICZtaW5fbWNsa19mcmVxLCBOVUxMLCBmYWxzZSk7
DQo+ICAgCWlmIChyZXQpDQo+ICAgCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiBAQCAtODU0LDcgKzg1
NCw3IEBAIHN0YXRpYyBpbnQgbmF2aTEwX3ByZV9kaXNwbGF5X2NvbmZpZ19jaGFuZ2VkKHN0cnVj
dCBzbXVfY29udGV4dCAqc211KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gICAJaWYgKHNt
dV9mZWF0dXJlX2lzX2VuYWJsZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fVUNMS19CSVQpKSB7DQo+
IC0JCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBTTVVfVUNMSywgTlVMTCwgJm1h
eF9mcmVxKTsNCj4gKwkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9VQ0xL
LCBOVUxMLCAmbWF4X2ZyZXEsIGZhbHNlKTsNCj4gICAJCWlmIChyZXQpDQo+ICAgCQkJcmV0dXJu
IHJldDsNCj4gICAJCXJldCA9IHNtdV9zZXRfaGFyZF9mcmVxX3JhbmdlKHNtdSwgU01VX1VDTEss
IDAsIG1heF9mcmVxKTsNCj4gQEAgLTkwNCw3ICs5MDQsNyBAQCBzdGF0aWMgaW50IG5hdmkxMF9m
b3JjZV9kcG1fbGltaXRfdmFsdWUoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIGJvb2wgaGlnaGVz
dCkNCj4gICANCj4gICAJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY2xrcyk7IGkrKykgew0K
PiAgIAkJY2xrX3R5cGUgPSBjbGtzW2ldOw0KPiAtCQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3Jh
bmdlKHNtdSwgY2xrX3R5cGUsICZtaW5fZnJlcSwgJm1heF9mcmVxKTsNCj4gKwkJcmV0ID0gc211
X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCAmbWluX2ZyZXEsICZtYXhfZnJlcSwg
ZmFsc2UpOw0KPiAgIAkJaWYgKHJldCkNCj4gICAJCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiBAQCAt
OTMxLDcgKzkzMSw3IEBAIHN0YXRpYyBpbnQgbmF2aTEwX3VuZm9yY2VfZHBtX2xldmVscyhzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4gICANCj4gICAJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJ
WkUoY2xrcyk7IGkrKykgew0KPiAgIAkJY2xrX3R5cGUgPSBjbGtzW2ldOw0KPiAtCQlyZXQgPSBz
bXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgY2xrX3R5cGUsICZtaW5fZnJlcSwgJm1heF9mcmVx
KTsNCj4gKwkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCAmbWlu
X2ZyZXEsICZtYXhfZnJlcSwgZmFsc2UpOw0KPiAgIAkJaWYgKHJldCkNCj4gICAJCQlyZXR1cm4g
cmV0Ow0KPiAgIA0KPiBAQCAtMTI2Niw3ICsxMjY2LDEwIEBAIHN0YXRpYyBpbnQgbmF2aTEwX25v
dGlmeV9zbWNfZGlzcGFseV9jb25maWcoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpDQo+ICAgCWlm
IChzbXVfZmVhdHVyZV9pc19zdXBwb3J0ZWQoc211LCBTTVVfRkVBVFVSRV9EUE1fRENFRkNMS19C
SVQpKSB7DQo+ICAgCQljbG9ja19yZXEuY2xvY2tfdHlwZSA9IGFtZF9wcF9kY2VmX2Nsb2NrOw0K
PiAgIAkJY2xvY2tfcmVxLmNsb2NrX2ZyZXFfaW5fa2h6ID0gbWluX2Nsb2Nrcy5kY2VmX2Nsb2Nr
ICogMTA7DQo+IC0JCWlmICghc211X2Rpc3BsYXlfY2xvY2tfdm9sdGFnZV9yZXF1ZXN0KHNtdSwg
JmNsb2NrX3JlcSkpIHsNCj4gKw0KPiArCQlpZiAoc211LT5mdW5jcy0+ZGlzcGxheV9jbG9ja192
b2x0YWdlX3JlcXVlc3QpDQo+ICsJCQlyZXQgPSBzbXUtPmZ1bmNzLT5kaXNwbGF5X2Nsb2NrX3Zv
bHRhZ2VfcmVxdWVzdChzbXUsICZjbG9ja19yZXEpOw0KPiArCQlpZiAoIXJldCkgew0KPiAgIAkJ
CWlmIChzbXVfZmVhdHVyZV9pc19zdXBwb3J0ZWQoc211LCBTTVVfRkVBVFVSRV9EU19EQ0VGQ0xL
X0JJVCkpIHsNCj4gICAJCQkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwN
Cj4gICAJCQkJCQkJCSAgU01VX01TR19TZXRNaW5EZWVwU2xlZXBEY2VmY2xrLA0KPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcmVub2lyX3BwdC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvcmVub2lyX3BwdC5jDQo+IGluZGV4IDZhZWRmZmQ3Mzlk
Yi4uMDI2ZjYxMWQ3ZDMyIDEwMDY0NA0KPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2Vy
cGxheS9yZW5vaXJfcHB0LmMNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkv
cmVub2lyX3BwdC5jDQo+IEBAIC0xOTQsNyArMTk0LDcgQEAgc3RhdGljIGludCByZW5vaXJfcHJp
bnRfY2xrX2xldmVscyhzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJY2FzZSBTTVVfU0NM
SzoNCj4gICAJCS8qIHJldGlydmUgdGFibGUgcmV0dXJuZWQgcGFyYW10ZXJzIHVuaXQgaXMgTUh6
ICovDQo+ICAgCQljdXJfdmFsdWUgPSBtZXRyaWNzLkNsb2NrRnJlcXVlbmN5W0NMT0NLX0dGWENM
S107DQo+IC0JCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBTTVVfR0ZYQ0xLLCAm
bWluLCAmbWF4KTsNCj4gKwkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9H
RlhDTEssICZtaW4sICZtYXgsIGZhbHNlKTsNCj4gICAJCWlmICghcmV0KSB7DQo+ICAgCQkJLyog
ZHJpdmVyIG9ubHkga25vdyBtaW4vbWF4IGdmeF9jbGssIEFkZCBsZXZlbCAxIGZvciBhbGwgb3Ro
ZXIgZ2Z4IGNsa3MgKi8NCj4gICAJCQlpZiAoY3VyX3ZhbHVlICA9PSBtYXgpDQo+IEBAIC0zMTQs
NyArMzE0LDcgQEAgc3RhdGljIGludCByZW5vaXJfZm9yY2VfZHBtX2xpbWl0X3ZhbHVlKHN0cnVj
dCBzbXVfY29udGV4dCAqc211LCBib29sIGhpZ2hlc3QpDQo+ICAgDQo+ICAgCWZvciAoaSA9IDA7
IGkgPCBBUlJBWV9TSVpFKGNsa3MpOyBpKyspIHsNCj4gICAJCWNsa190eXBlID0gY2xrc1tpXTsN
Cj4gLQkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIGNsa190eXBlLCAmbWluX2Zy
ZXEsICZtYXhfZnJlcSk7DQo+ICsJCXJldCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBj
bGtfdHlwZSwgJm1pbl9mcmVxLCAmbWF4X2ZyZXEsIGZhbHNlKTsNCj4gICAJCWlmIChyZXQpDQo+
ICAgCQkJcmV0dXJuIHJldDsNCj4gICANCj4gQEAgLTM0OCw3ICszNDgsNyBAQCBzdGF0aWMgaW50
IHJlbm9pcl91bmZvcmNlX2RwbV9sZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpIHsNCj4g
ICANCj4gICAJCWNsa190eXBlID0gY2xrX2ZlYXR1cmVfbWFwW2ldLmNsa190eXBlOw0KPiAgIA0K
PiAtCQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgY2xrX3R5cGUsICZtaW5fZnJl
cSwgJm1heF9mcmVxKTsNCj4gKwkJcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIGNs
a190eXBlLCAmbWluX2ZyZXEsICZtYXhfZnJlcSwgZmFsc2UpOw0KPiAgIAkJaWYgKHJldCkNCj4g
ICAJCQlyZXR1cm4gcmV0Ow0KPiAgIA0KPiBAQCAtNDM1LDcgKzQzNSw3IEBAIHN0YXRpYyBpbnQg
cmVub2lyX2ZvcmNlX2Nsa19sZXZlbHMoc3RydWN0IHNtdV9jb250ZXh0ICpzbXUsDQo+ICAgCQkJ
cmV0dXJuIC1FSU5WQUw7DQo+ICAgCQl9DQo+ICAgDQo+IC0JCXJldCA9IHNtdV9nZXRfZHBtX2Zy
ZXFfcmFuZ2Uoc211LCBTTVVfR0ZYQ0xLLCAmbWluX2ZyZXEsICZtYXhfZnJlcSk7DQo+ICsJCXJl
dCA9IHNtdV9nZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBTTVVfR0ZYQ0xLLCAmbWluX2ZyZXEsICZt
YXhfZnJlcSwgZmFsc2UpOw0KPiAgIAkJaWYgKHJldCkNCj4gICAJCQlyZXR1cm4gcmV0Ow0KPiAg
IAkJcmV0ID0gc211X3NlbmRfc21jX21zZ193aXRoX3BhcmFtKHNtdSwgU01VX01TR19TZXRTb2Z0
TWF4R2Z4Q2xrLA0KPiBAQCAtNTExLDcgKzUxMSw3IEBAIHN0YXRpYyBpbnQgcmVub2lyX3NldF9w
ZWFrX2Nsb2NrX2J5X2RldmljZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSkNCj4gICAJaW50IHJl
dCA9IDA7DQo+ICAgCXVpbnQzMl90IHNjbGtfZnJlcSA9IDAsIHVjbGtfZnJlcSA9IDA7DQo+ICAg
DQo+IC0JcmV0ID0gc211X2dldF9kcG1fZnJlcV9yYW5nZShzbXUsIFNNVV9TQ0xLLCBOVUxMLCAm
c2Nsa19mcmVxKTsNCj4gKwlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVxX3JhbmdlKHNtdSwgU01VX1ND
TEssIE5VTEwsICZzY2xrX2ZyZXEsIGZhbHNlKTsNCj4gICAJaWYgKHJldCkNCj4gICAJCXJldHVy
biByZXQ7DQo+ICAgDQo+IEBAIC01MTksNyArNTE5LDcgQEAgc3RhdGljIGludCByZW5vaXJfc2V0
X3BlYWtfY2xvY2tfYnlfZGV2aWNlKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KPiAgIAlpZiAo
cmV0KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gLQlyZXQgPSBzbXVfZ2V0X2RwbV9mcmVx
X3JhbmdlKHNtdSwgU01VX1VDTEssIE5VTEwsICZ1Y2xrX2ZyZXEpOw0KPiArCXJldCA9IHNtdV9n
ZXRfZHBtX2ZyZXFfcmFuZ2Uoc211LCBTTVVfVUNMSywgTlVMTCwgJnVjbGtfZnJlcSwgZmFsc2Up
Ow0KPiAgIAlpZiAocmV0KQ0KPiAgIAkJcmV0dXJuIHJldDsNCj4gICANCj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3NtdV92MTFfMC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9wb3dlcnBsYXkvc211X3YxMV8wLmMNCj4gaW5kZXggYjY4Y2I4YmFkYzc1Li5hMTU3
NmE0ODI4ZDEgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3Nt
dV92MTFfMC5jDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3NtdV92MTFf
MC5jDQo+IEBAIC04MDksOCArODA5LDExIEBAIHN0YXRpYyBpbnQgc211X3YxMV8wX3NldF9taW5f
ZGNlZl9kZWVwX3NsZWVwKHN0cnVjdCBzbXVfY29udGV4dCAqc211KQ0KPiAgIAlpZiAoIXRhYmxl
X2NvbnRleHQpDQo+ICAgCQlyZXR1cm4gLUVJTlZBTDsNCj4gICANCj4gLQlyZXR1cm4gc211X3Nl
dF9kZWVwX3NsZWVwX2RjZWZjbGsoc211LA0KPiAtCQkJCQkgIHRhYmxlX2NvbnRleHQtPmJvb3Rf
dmFsdWVzLmRjZWZjbGsgLyAxMDApOw0KPiArCWlmIChzbXUtPmZ1bmNzLT5zZXRfZGVlcF9zbGVl
cF9kY2VmY2xrKQ0KPiArCQlyZXR1cm4gc211LT5mdW5jcy0+c2V0X2RlZXBfc2xlZXBfZGNlZmNs
ayhzbXUsDQo+ICsJCQkJdGFibGVfY29udGV4dC0+Ym9vdF92YWx1ZXMuZGNlZmNsayAvIDEwMCk7
DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gICB9DQo+ICAgDQo+ICAgc3RhdGljIGludCBzbXVfdjEx
XzBfc2V0X3Rvb2xfdGFibGVfbG9jYXRpb24oc3RydWN0IHNtdV9jb250ZXh0ICpzbXUpDQo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92ZWdhMjBfcHB0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92ZWdhMjBfcHB0LmMNCj4gaW5kZXggYTc2ZmZk
NTg0MDRlLi4zZWY5OTYzNzE4YzggMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
cG93ZXJwbGF5L3ZlZ2EyMF9wcHQuYw0KPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2Vy
cGxheS92ZWdhMjBfcHB0LmMNCj4gQEAgLTI1OTMsNyArMjU5Myw4IEBAIHN0YXRpYyBpbnQgdmVn
YTIwX3NldF9vZF9wZXJjZW50YWdlKHN0cnVjdCBzbXVfY29udGV4dCAqc211LA0KPiAgIAl9DQo+
ICAgDQo+ICAgCXJldCA9IHNtdV9oYW5kbGVfdGFzayhzbXUsIHNtdV9kcG0tPmRwbV9sZXZlbCwN
Cj4gLQkJCSAgICAgIEFNRF9QUF9UQVNLX1JFQURKVVNUX1BPV0VSX1NUQVRFKTsNCj4gKwkJCSAg
ICAgIEFNRF9QUF9UQVNLX1JFQURKVVNUX1BPV0VSX1NUQVRFLA0KPiArCQkJICAgICAgZmFsc2Up
Ow0KPiAgIA0KPiAgIHNldF9vZF9mYWlsZWQ6DQo+ICAgCW11dGV4X3VubG9jaygmKHNtdS0+bXV0
ZXgpKTsNCj4gQEAgLTI4MjQsNyArMjgyNSw4IEBAIHN0YXRpYyBpbnQgdmVnYTIwX29kbl9lZGl0
X2RwbV90YWJsZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwNCj4gICAJaWYgKHR5cGUgPT0gUFBf
T0RfQ09NTUlUX0RQTV9UQUJMRSkgew0KPiAgIAkJbXV0ZXhfbG9jaygmKHNtdS0+bXV0ZXgpKTsN
Cj4gICAJCXJldCA9IHNtdV9oYW5kbGVfdGFzayhzbXUsIHNtdV9kcG0tPmRwbV9sZXZlbCwNCj4g
LQkJCQkgICAgICBBTURfUFBfVEFTS19SRUFESlVTVF9QT1dFUl9TVEFURSk7DQo+ICsJCQkJICAg
ICAgQU1EX1BQX1RBU0tfUkVBREpVU1RfUE9XRVJfU1RBVEUsDQo+ICsJCQkJICAgICAgZmFsc2Up
Ow0KPiAgIAkJbXV0ZXhfdW5sb2NrKCYoc211LT5tdXRleCkpOw0KPiAgIAl9DQo+ICAgDQpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxp
bmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
