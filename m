Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 193116B74F
	for <lists+amd-gfx@lfdr.de>; Wed, 17 Jul 2019 09:16:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8D53D6E260;
	Wed, 17 Jul 2019 07:15:59 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wm1-x32f.google.com (mail-wm1-x32f.google.com
 [IPv6:2a00:1450:4864:20::32f])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0972A6E260
 for <amd-gfx@lists.freedesktop.org>; Wed, 17 Jul 2019 07:15:57 +0000 (UTC)
Received: by mail-wm1-x32f.google.com with SMTP id s15so20974658wmj.3
 for <amd-gfx@lists.freedesktop.org>; Wed, 17 Jul 2019 00:15:57 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:reply-to:subject:to:references:from:message-id
 :date:user-agent:mime-version:in-reply-to:content-transfer-encoding
 :content-language;
 bh=2owbuQUtnjG61LvG7Wc4M+T2+CjnXKuW0nbbzeafUQs=;
 b=ZzavodR3Q/r6CKaqrVig9QHi6Kz+HzYjfpQLIgKnUoCA1JDwVi64ymoM2DXVpqMInZ
 xguNjHCkbxAsmGys/o6FaP19rXdGsGGTNDUAN1OD8n1kI8quP1+x8wSjsZQVnaj163TE
 GhiNg07BXYsGqQ5ZYXXkAR3+Qkj8on2AWBQ6kqn5fPKWQBJUBd+0KTl7a0O6IpPHYLNr
 zq63EJrOeZ8qEUczy3f4LuRcqaa0lTW7F4XUWq/6eD1Ecm4dNfJHLzVttaDS4hrUIDnT
 HRO+cg1yDK78Ng2hxCyp9VF4qSt0SYmVYaGRkbTUKayIAo703avKmcjcL1EUH4WogaCV
 uIiw==
X-Gm-Message-State: APjAAAXg/8iwaTTX/HiqCVtq01sq9e570U3j9RCOItfoPNEfdf3HhlOo
 YJqx6C9TF8j5OkfKGW1FjGNmT4Zg
X-Google-Smtp-Source: APXvYqwA85TWgH7diA6VzXq0luTvfTiCQkFl6nWOkoFwJsJIntmdqDXgiMMwgzGyISoNdMFKnzOSdA==
X-Received: by 2002:a05:600c:2243:: with SMTP id
 a3mr33374926wmm.83.1563347756573; 
 Wed, 17 Jul 2019 00:15:56 -0700 (PDT)
Received: from ?IPv6:2a02:908:1252:fb60:be8a:bd56:1f94:86e7?
 ([2a02:908:1252:fb60:be8a:bd56:1f94:86e7])
 by smtp.gmail.com with ESMTPSA id f12sm24722640wrg.5.2019.07.17.00.15.55
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
 Wed, 17 Jul 2019 00:15:56 -0700 (PDT)
Subject: Re: [PATCH] drm/amdgpu: reserve GDS resources on the gfx ring for
 gfx10
To: =?UTF-8?B?TWFyZWsgT2zFocOhaw==?= <maraeo@gmail.com>,
 amd-gfx@lists.freedesktop.org, Felix Kuehling <felix.kuehling@amd.com>
References: <20190717000606.7181-1-maraeo@gmail.com>
From: =?UTF-8?Q?Christian_K=c3=b6nig?= <ckoenig.leichtzumerken@gmail.com>
Message-ID: <26330d7e-3cc0-f460-b7e0-b234597f382d@gmail.com>
Date: Wed, 17 Jul 2019 09:15:54 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.2
MIME-Version: 1.0
In-Reply-To: <20190717000606.7181-1-maraeo@gmail.com>
Content-Language: en-US
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=reply-to:subject:to:references:from:message-id:date:user-agent
 :mime-version:in-reply-to:content-transfer-encoding:content-language;
 bh=2owbuQUtnjG61LvG7Wc4M+T2+CjnXKuW0nbbzeafUQs=;
 b=Dx4nsLDUsPNDwk77gQBnxJLOfwee+92Y9tO+InJ4NOxppIdtmDdBLLfFuceAK0K3h2
 ZBbyrRH6PwpSfYMqffh/oMjdAERB+aeU9Gv5Bn7vEXxgfdjb7KrjvPHWkij9mFTZa7Ih
 DbIOZ50Drq0tkT7FzB8UuR1KmpIQgGQ4dcZYuYmUJeduRsE81MsaoxZ3OUtDCAcoSeot
 o21E3Zx3PT2KxASMdOblon3gKQ2GtjWxmjibtm035TpTOxJmhKRlmzOsZidyftV+RgOq
 k9b225RP3pCPzg5EH+Xt2RgnJHxAI9FvlWpisPFhcIEYslDiDNHFQhIsOQMFARrvurss
 q0ig==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Reply-To: christian.koenig@amd.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QW0gMTcuMDcuMTkgdW0gMDI6MDYgc2NocmllYiBNYXJlayBPbMWhw6FrOgo+IEZyb206IE1hcmVr
IE9sxaHDoWsgPG1hcmVrLm9sc2FrQGFtZC5jb20+Cj4KPiBIb3BlZnVsbHkgd2UnbGwgb25seSB1
c2UgMSBnZnggcmluZywgYmVjYXVzZSBvdGhlcndpc2Ugd2UnZCBoYXZlIHRvIGhhdmUKPiBzZXBh
cmF0ZSBHRFMgYnVmZmVycyBmb3IgZWFjaCBnZnggcmluZy4KPgo+IFRoaXMgaXMgYSB3b3JrYXJv
dW5kIHRvIGVuc3VyZSBzdGFiaWxpdHkgb2YgdHJhbnNmb3JtIGZlZWRiYWNrLiBTaGFkZXJzIGhh
bmcKPiB3YWl0aW5nIGZvciBhIEdEUyBpbnN0cnVjdGlvbiAoZHNfc3ViLCBub3QgZHNfb3JkZXJl
ZF9jb3VudCkuCj4KPiBUaGUgZGlzYWR2YW50YWdlIGlzIHRoYXQgY29tcHV0ZSBJQnMgbWlnaHQg
Z2V0IGEgZGlmZmVyZW50IFZNSUQsCj4gYmVjYXVzZSBub3cgZ2Z4IGFsd2F5cyBoYXMgR0RTIGFu
ZCBjb21wdXRlIGRvZXNuJ3QuCgpTbyBmYXIgY29tcHV0ZSBpcyBvbmx5IHVzaW5nIEdXUywgYnV0
IEkgZG9uJ3QgdGhpbmsgdGhhdCB0aG9zZSAKcmVzZXJ2YXRpb25zIGFyZSBhIGdvb2QgaWRlYSBp
biBnZW5lcmFsLgoKSG93IHNldmVyZSBpcyB0aGUgRU5PTUVNIHByb2JsZW0geW91IHNlZSB3aXRo
IHVzaW5nIGFuIGV4cGxpY2l0IEdXUyAKYWxsb2NhdGlvbj8KClJlZ2FyZHMsCkNocmlzdGlhbi4K
Cj4KPiBTaWduZWQtb2ZmLWJ5OiBNYXJlayBPbMWhw6FrIDxtYXJlay5vbHNha0BhbWQuY29tPgo+
IC0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1LmggICAgIHwgIDEgKwo+
ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMgIHwgMTAgKysrKysrKysr
Kwo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dkcy5oIHwgIDYgKysrKysr
Cj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYyAgfCAyMCArKysrKysr
KysrKysrKysrKysrKwo+ICAgNCBmaWxlcyBjaGFuZ2VkLCAzNyBpbnNlcnRpb25zKCspCj4KPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1LmggYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaAo+IGluZGV4IDRiNTE0YTQ0MTg0Yy4uY2JkNTVk
MDYxYjcyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5o
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1LmgKPiBAQCAtNDU2LDIw
ICs0NTYsMjEgQEAgc3RydWN0IGFtZGdwdV9jc19wYXJzZXIgewo+ICAgCXN0cnVjdCBkcm1fZmls
ZQkJKmZpbHA7Cj4gICAJc3RydWN0IGFtZGdwdV9jdHgJKmN0eDsKPiAgIAo+ICAgCS8qIGNodW5r
cyAqLwo+ICAgCXVuc2lnbmVkCQluY2h1bmtzOwo+ICAgCXN0cnVjdCBhbWRncHVfY3NfY2h1bmsJ
KmNodW5rczsKPiAgIAo+ICAgCS8qIHNjaGVkdWxlciBqb2Igb2JqZWN0ICovCj4gICAJc3RydWN0
IGFtZGdwdV9qb2IJKmpvYjsKPiAgIAlzdHJ1Y3QgZHJtX3NjaGVkX2VudGl0eQkqZW50aXR5Owo+
ICsJdW5zaWduZWQJCWh3X2lwOwo+ICAgCj4gICAJLyogYnVmZmVyIG9iamVjdHMgKi8KPiAgIAlz
dHJ1Y3Qgd3dfYWNxdWlyZV9jdHgJCXRpY2tldDsKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2JvX2xpc3QJ
CSpib19saXN0Owo+ICAgCXN0cnVjdCBhbWRncHVfbW4JCSptbjsKPiAgIAlzdHJ1Y3QgYW1kZ3B1
X2JvX2xpc3RfZW50cnkJdm1fcGQ7Cj4gICAJc3RydWN0IGxpc3RfaGVhZAkJdmFsaWRhdGVkOwo+
ICAgCXN0cnVjdCBkbWFfZmVuY2UJCSpmZW5jZTsKPiAgIAl1aW50NjRfdAkJCWJ5dGVzX21vdmVk
X3RocmVzaG9sZDsKPiAgIAl1aW50NjRfdAkJCWJ5dGVzX21vdmVkX3Zpc190aHJlc2hvbGQ7Cj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMKPiBpbmRleCBjNjkxZGY2ZjdhNTcu
LjkxMjVjZDY5YTEyNCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfY3MuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5j
Cj4gQEAgLTY3OCwyMCArNjc4LDI4IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2NzX3BhcnNlcl9ib3Mo
c3RydWN0IGFtZGdwdV9jc19wYXJzZXIgKnAsCj4gICAJaWYgKHIpCj4gICAJCWdvdG8gZXJyb3Jf
dmFsaWRhdGU7Cj4gICAKPiAgIAlhbWRncHVfY3NfcmVwb3J0X21vdmVkX2J5dGVzKHAtPmFkZXYs
IHAtPmJ5dGVzX21vdmVkLAo+ICAgCQkJCSAgICAgcC0+Ynl0ZXNfbW92ZWRfdmlzKTsKPiAgIAo+
ICAgCWdkcyA9IHAtPmJvX2xpc3QtPmdkc19vYmo7Cj4gICAJZ3dzID0gcC0+Ym9fbGlzdC0+Z3dz
X29iajsKPiAgIAlvYSA9IHAtPmJvX2xpc3QtPm9hX29iajsKPiAgIAo+ICsJaWYgKHAtPmh3X2lw
ID09IEFNREdQVV9IV19JUF9HRlgpIHsKPiArCQkvKiBPbmx5IGdmeDEwIGFsbG9jYXRlcyB0aGVz
ZS4gKi8KPiArCQlpZiAoIWdkcykKPiArCQkJZ2RzID0gcC0+YWRldi0+Z2RzLmdkc19nZnhfYm87
Cj4gKwkJaWYgKCFvYSkKPiArCQkJb2EgPSBwLT5hZGV2LT5nZHMub2FfZ2Z4X2JvOwo+ICsJfQo+
ICsKPiAgIAlhbWRncHVfYm9fbGlzdF9mb3JfZWFjaF9lbnRyeShlLCBwLT5ib19saXN0KSB7Cj4g
ICAJCXN0cnVjdCBhbWRncHVfYm8gKmJvID0gdHRtX3RvX2FtZGdwdV9ibyhlLT50di5ibyk7Cj4g
ICAKPiAgIAkJLyogTWFrZSBzdXJlIHdlIHVzZSB0aGUgZXhjbHVzaXZlIHNsb3QgZm9yIHNoYXJl
ZCBCT3MgKi8KPiAgIAkJaWYgKGJvLT5wcmltZV9zaGFyZWRfY291bnQpCj4gICAJCQllLT50di5u
dW1fc2hhcmVkID0gMDsKPiAgIAkJZS0+Ym9fdmEgPSBhbWRncHVfdm1fYm9fZmluZCh2bSwgYm8p
Owo+ICAgCX0KPiAgIAo+ICAgCWlmIChnZHMpIHsKPiBAQCAtOTU0LDIwICs5NjIsMjIgQEAgc3Rh
dGljIGludCBhbWRncHVfY3NfaWJfZmlsbChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAg
IAkJc3RydWN0IGRybV9hbWRncHVfY3NfY2h1bmtfaWIgKmNodW5rX2liOwo+ICAgCQlzdHJ1Y3Qg
ZHJtX3NjaGVkX2VudGl0eSAqZW50aXR5Owo+ICAgCj4gICAJCWNodW5rID0gJnBhcnNlci0+Y2h1
bmtzW2ldOwo+ICAgCQlpYiA9ICZwYXJzZXItPmpvYi0+aWJzW2pdOwo+ICAgCQljaHVua19pYiA9
IChzdHJ1Y3QgZHJtX2FtZGdwdV9jc19jaHVua19pYiAqKWNodW5rLT5rZGF0YTsKPiAgIAo+ICAg
CQlpZiAoY2h1bmstPmNodW5rX2lkICE9IEFNREdQVV9DSFVOS19JRF9JQikKPiAgIAkJCWNvbnRp
bnVlOwo+ICAgCj4gKwkJcGFyc2VyLT5od19pcCA9IGNodW5rX2liLT5pcF90eXBlOwo+ICsKPiAg
IAkJaWYgKGNodW5rX2liLT5pcF90eXBlID09IEFNREdQVV9IV19JUF9HRlggJiYKPiAgIAkJICAg
IChhbWRncHVfbWNicCB8fCBhbWRncHVfc3Jpb3ZfdmYoYWRldikpKSB7Cj4gICAJCQlpZiAoY2h1
bmtfaWItPmZsYWdzICYgQU1ER1BVX0lCX0ZMQUdfUFJFRU1QVCkgewo+ICAgCQkJCWlmIChjaHVu
a19pYi0+ZmxhZ3MgJiBBTURHUFVfSUJfRkxBR19DRSkKPiAgIAkJCQkJY2VfcHJlZW1wdCsrOwo+
ICAgCQkJCWVsc2UKPiAgIAkJCQkJZGVfcHJlZW1wdCsrOwo+ICAgCQkJfQo+ICAgCj4gICAJCQkv
KiBlYWNoIEdGWCBjb21tYW5kIHN1Ym1pdCBhbGxvd3MgMCBvciAxIElCIHByZWVtcHRpYmxlIGZv
ciBDRSAmIERFICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9nZHMuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZHMuaAo+IGlu
ZGV4IGRmOGEyMzU1NDgzMS4uMDk0M2I4ZTFkOTdlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZHMuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9nZHMuaAo+IEBAIC0yNiwyMCArMjYsMjYgQEAKPiAgIAo+ICAgc3RydWN0
IGFtZGdwdV9yaW5nOwo+ICAgc3RydWN0IGFtZGdwdV9ibzsKPiAgIAo+ICAgc3RydWN0IGFtZGdw
dV9nZHMgewo+ICAgCXVpbnQzMl90IGdkc19zaXplOwo+ICAgCXVpbnQzMl90IGd3c19zaXplOwo+
ICAgCXVpbnQzMl90IG9hX3NpemU7Cj4gICAJdWludDMyX3QgZ2RzX2NvbXB1dGVfbWF4X3dhdmVf
aWQ7Cj4gICAJdWludDMyX3Qgdmd0X2dzX21heF93YXZlX2lkOwo+ICsKPiArCS8qIFJlc2VydmVk
IE9BIGZvciB0aGUgZ2Z4IHJpbmcuIChnZngxMCkgKi8KPiArCXVpbnQzMl90IGdkc19nZnhfcmVz
ZXJ2YXRpb25fc2l6ZTsKPiArCXVpbnQzMl90IG9hX2dmeF9yZXNlcnZhdGlvbl9zaXplOwo+ICsJ
c3RydWN0IGFtZGdwdV9ibyAqZ2RzX2dmeF9ibzsKPiArCXN0cnVjdCBhbWRncHVfYm8gKm9hX2dm
eF9ibzsKPiAgIH07Cj4gICAKPiAgIHN0cnVjdCBhbWRncHVfZ2RzX3JlZ19vZmZzZXQgewo+ICAg
CXVpbnQzMl90CW1lbV9iYXNlOwo+ICAgCXVpbnQzMl90CW1lbV9zaXplOwo+ICAgCXVpbnQzMl90
CWd3czsKPiAgIAl1aW50MzJfdAlvYTsKPiAgIH07Cj4gICAKPiAgICNlbmRpZiAvKiBfX0FNREdQ
VV9HRFNfSF9fICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dm
eF92MTBfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3YxMF8wLmMKPiBpbmRl
eCA2MTgyOTFkZjY1OWIuLjM5NTI3NTRjMDRmZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9nZnhfdjEwXzAuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2dmeF92MTBfMC5jCj4gQEAgLTEzMTQsMjAgKzEzMTQsMzMgQEAgc3RhdGljIGludCBnZnhf
djEwXzBfc3dfaW5pdCh2b2lkICpoYW5kbGUpCj4gICAKPiAgIAlraXEgPSAmYWRldi0+Z2Z4Lmtp
cTsKPiAgIAlyID0gYW1kZ3B1X2dmeF9raXFfaW5pdF9yaW5nKGFkZXYsICZraXEtPnJpbmcsICZr
aXEtPmlycSk7Cj4gICAJaWYgKHIpCj4gICAJCXJldHVybiByOwo+ICAgCj4gICAJciA9IGFtZGdw
dV9nZnhfbXFkX3N3X2luaXQoYWRldiwgc2l6ZW9mKHN0cnVjdCB2MTBfY29tcHV0ZV9tcWQpKTsK
PiAgIAlpZiAocikKPiAgIAkJcmV0dXJuIHI7Cj4gICAKPiArCS8qIGFsbG9jYXRlIHJlc2VydmVk
IEdEUyByZXNvdXJjZXMgZm9yIHRyYW5zZm9ybSBmZWVkYmFjayAqLwo+ICsJciA9IGFtZGdwdV9i
b19jcmVhdGVfa2VybmVsKGFkZXYsIGFkZXYtPmdkcy5nZHNfZ2Z4X3Jlc2VydmF0aW9uX3NpemUs
Cj4gKwkJCQkgICAgNCwgQU1ER1BVX0dFTV9ET01BSU5fR0RTLAo+ICsJCQkJICAgICZhZGV2LT5n
ZHMuZ2RzX2dmeF9ibywgTlVMTCwgTlVMTCk7Cj4gKwlpZiAocikKPiArCQlyZXR1cm4gcjsKPiAr
Cj4gKwlyID0gYW1kZ3B1X2JvX2NyZWF0ZV9rZXJuZWwoYWRldiwgYWRldi0+Z2RzLm9hX2dmeF9y
ZXNlcnZhdGlvbl9zaXplLAo+ICsJCQkJICAgIDEsIEFNREdQVV9HRU1fRE9NQUlOX09BLAo+ICsJ
CQkJICAgICZhZGV2LT5nZHMub2FfZ2Z4X2JvLCBOVUxMLCBOVUxMKTsKPiArCWlmIChyKQo+ICsJ
CXJldHVybiByOwo+ICsKPiAgIAkvKiBhbGxvY2F0ZSB2aXNpYmxlIEZCIGZvciBybGMgYXV0by1s
b2FkaW5nIGZ3ICovCj4gICAJaWYgKGFkZXYtPmZpcm13YXJlLmxvYWRfdHlwZSA9PSBBTURHUFVf
RldfTE9BRF9STENfQkFDS0RPT1JfQVVUTykgewo+ICAgCQlyID0gZ2Z4X3YxMF8wX3JsY19iYWNr
ZG9vcl9hdXRvbG9hZF9idWZmZXJfaW5pdChhZGV2KTsKPiAgIAkJaWYgKHIpCj4gICAJCQlyZXR1
cm4gcjsKPiAgIAl9Cj4gICAKPiAgIAlhZGV2LT5nZnguY2VfcmFtX3NpemUgPSBGMzJfQ0VfUFJP
R1JBTV9SQU1fU0laRTsKPiAgIAo+ICAgCWdmeF92MTBfMF9ncHVfZWFybHlfaW5pdChhZGV2KTsK
PiBAQCAtMTM1NCwyMCArMTM2NywyMyBAQCBzdGF0aWMgdm9pZCBnZnhfdjEwXzBfbWVfZmluaShz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiAgIAlhbWRncHVfYm9fZnJlZV9rZXJuZWwoJmFk
ZXYtPmdmeC5tZS5tZV9md19vYmosCj4gICAJCQkgICAgICAmYWRldi0+Z2Z4Lm1lLm1lX2Z3X2dw
dV9hZGRyLAo+ICAgCQkJICAgICAgKHZvaWQgKiopJmFkZXYtPmdmeC5tZS5tZV9md19wdHIpOwo+
ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IGdmeF92MTBfMF9zd19maW5pKHZvaWQgKmhhbmRsZSkK
PiAgIHsKPiAgIAlpbnQgaTsKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqKWhhbmRsZTsKPiAgIAo+ICsJYW1kZ3B1X2JvX2ZyZWVfa2VybmVs
KCZhZGV2LT5nZHMuZ2RzX2dmeF9ibywgTlVMTCwgTlVMTCk7Cj4gKwlhbWRncHVfYm9fZnJlZV9r
ZXJuZWwoJmFkZXYtPmdkcy5vYV9nZnhfYm8sIE5VTEwsIE5VTEwpOwo+ICsKPiAgIAlmb3IgKGkg
PSAwOyBpIDwgYWRldi0+Z2Z4Lm51bV9nZnhfcmluZ3M7IGkrKykKPiAgIAkJYW1kZ3B1X3Jpbmdf
ZmluaSgmYWRldi0+Z2Z4LmdmeF9yaW5nW2ldKTsKPiAgIAlmb3IgKGkgPSAwOyBpIDwgYWRldi0+
Z2Z4Lm51bV9jb21wdXRlX3JpbmdzOyBpKyspCj4gICAJCWFtZGdwdV9yaW5nX2ZpbmkoJmFkZXYt
PmdmeC5jb21wdXRlX3JpbmdbaV0pOwo+ICAgCj4gICAJYW1kZ3B1X2dmeF9tcWRfc3dfZmluaShh
ZGV2KTsKPiAgIAlhbWRncHVfZ2Z4X2tpcV9mcmVlX3JpbmcoJmFkZXYtPmdmeC5raXEucmluZywg
JmFkZXYtPmdmeC5raXEuaXJxKTsKPiAgIAlhbWRncHVfZ2Z4X2tpcV9maW5pKGFkZXYpOwo+ICAg
Cj4gICAJZ2Z4X3YxMF8wX3BmcF9maW5pKGFkZXYpOwo+IEBAIC01MTgxLDIwICs1MTk3LDI0IEBA
IHN0YXRpYyB2b2lkIGdmeF92MTBfMF9zZXRfZ2RzX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYpCj4gICAJY2FzZSBDSElQX05BVkkxMDoKPiAgIAlkZWZhdWx0Ogo+ICAgCQlhZGV2LT5n
ZHMuZ2RzX3NpemUgPSAweDEwMDAwOwo+ICAgCQlhZGV2LT5nZHMuZ2RzX2NvbXB1dGVfbWF4X3dh
dmVfaWQgPSAweDRmZjsKPiAgIAkJYWRldi0+Z2RzLnZndF9nc19tYXhfd2F2ZV9pZCA9IDB4M2Zm
Owo+ICAgCQlicmVhazsKPiAgIAl9Cj4gICAKPiAgIAlhZGV2LT5nZHMuZ3dzX3NpemUgPSA2NDsK
PiAgIAlhZGV2LT5nZHMub2Ffc2l6ZSA9IDE2Owo+ICsKPiArCS8qIFJlc2VydmVkIGZvciB0cmFu
c2Zvcm0gZmVlZGJhY2suICovCj4gKwlhZGV2LT5nZHMuZ2RzX2dmeF9yZXNlcnZhdGlvbl9zaXpl
ID0gMjU2Owo+ICsJYWRldi0+Z2RzLm9hX2dmeF9yZXNlcnZhdGlvbl9zaXplID0gNDsKPiAgIH0K
PiAgIAo+ICAgc3RhdGljIHZvaWQgZ2Z4X3YxMF8wX3NldF91c2VyX3dncF9pbmFjdGl2ZV9iaXRt
YXBfcGVyX3NoKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICAgCQkJCQkJCSAgdTMyIGJp
dG1hcCkKPiAgIHsKPiAgIAl1MzIgZGF0YTsKPiAgIAo+ICAgCWlmICghYml0bWFwKQo+ICAgCQly
ZXR1cm47Cj4gICAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
