Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 144C3667CA
	for <lists+amd-gfx@lfdr.de>; Fri, 12 Jul 2019 09:35:23 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8A6DC6E2DC;
	Fri, 12 Jul 2019 07:35:21 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM02-CY1-obe.outbound.protection.outlook.com
 (mail-eopbgr760083.outbound.protection.outlook.com [40.107.76.83])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4FA6E6E2DC
 for <amd-gfx@lists.freedesktop.org>; Fri, 12 Jul 2019 07:35:20 +0000 (UTC)
Received: from CY4PR1201CA0010.namprd12.prod.outlook.com
 (2603:10b6:910:16::20) by DM6PR12MB3932.namprd12.prod.outlook.com
 (2603:10b6:5:1cb::13) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2052.19; Fri, 12 Jul
 2019 07:35:18 +0000
Received: from BY2NAM03FT033.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e4a::207) by CY4PR1201CA0010.outlook.office365.com
 (2603:10b6:910:16::20) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.2073.14 via Frontend
 Transport; Fri, 12 Jul 2019 07:35:18 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV01.amd.com (165.204.84.17) by
 BY2NAM03FT033.mail.protection.outlook.com (10.152.84.220) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.2052.18 via Frontend Transport; Fri, 12 Jul 2019 07:35:17 +0000
Received: from build-machine.amd.com (10.34.1.3) by SATLEXCHOV01.amd.com
 (10.181.40.71) with Microsoft SMTP Server id 14.3.389.1; Fri, 12 Jul 2019
 02:35:16 -0500
From: Evan Quan <evan.quan@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 1/2] drm/amd/powerplay: correct SW SMU valid mapping check
Date: Fri, 12 Jul 2019 15:35:04 +0800
Message-ID: <20190712073505.17563-1-evan.quan@amd.com>
X-Mailer: git-send-email 2.21.0
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(136003)(376002)(396003)(346002)(39860400002)(2980300002)(428003)(189003)(199004)(70586007)(81166006)(5660300002)(2870700001)(70206006)(426003)(186003)(2906002)(26005)(478600001)(81156014)(6916009)(2616005)(126002)(30864003)(476003)(50226002)(305945005)(4326008)(68736007)(8676002)(36756003)(6666004)(2351001)(7696005)(53416004)(48376002)(356004)(336012)(47776003)(44832011)(1076003)(51416003)(486006)(53936002)(14444005)(316002)(50466002)(8936002)(86362001);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM6PR12MB3932; H:SATLEXCHOV01.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; MX:1; A:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 6cfebf57-36a3-4235-d924-08d7069b7cd8
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328);
 SRVR:DM6PR12MB3932; 
X-MS-TrafficTypeDiagnostic: DM6PR12MB3932:
X-Microsoft-Antispam-PRVS: <DM6PR12MB393244C8D4B7820F868C5766E4F20@DM6PR12MB3932.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:1051;
X-Forefront-PRVS: 00963989E5
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: b6itd3296NoK0dcb8z5GZ9Llt3rH9RXbJUJkIaKL17QG13ZF3FH9S3eLfu9Oe0ysHXfepgYoj9MJl9g8pISLr3Jhw/a6h/qJrr1Ao6ULb7ar/kQjFwBXWv7DfE8t6jKtVDH7S2drTISeVguelnBB2aMEcGLJpvpkqTfLpbacHXpxPv/7EhNsajOF02rgVrU0AUPRbyqtASGKXJMrT4RdQalOspwvNDnPOJvokoXcUh1ZBPNB37yUKQGNe7q6H5hbKOfWN6fcV80XVhXq8d/XqNFfkFtShQESJtqr4jlxU20m/mwD9VF/gZPOC93CSXguoplicYa90PGw2pWl32ueTpFoyyf7K94tidaCSz/4mr7/No6Cxoex7paoxKwofmkdZSdyyqRub88IWC+QKuoSKd9EcDt659lE7Xkvc2qjOO8=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 12 Jul 2019 07:35:17.8036 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 6cfebf57-36a3-4235-d924-08d7069b7cd8
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV01.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB3932
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=MX/iP1Q+JODSU4KuMJmNmZSfybAZw97hkPhy2RqTRNA=;
 b=JglrkZtD7lXy+ocHa0l08H5XACrJuVQE8NbvFLNict/gJT3O1TL6X1s0Z6udAQtf2r+u/nA5+ETRfywY4BwfpGPuV+VJLQ3/LjZ8rGZRorTDljtxBTBgTIoiVAnA046zRvheaz7TwoHueJWG+KhZxUHbVGdFZBYaQKjCWmCMfS0=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Evan Quan <evan.quan@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

Q3VycmVudCBpbXBsZW1lbnRhdGlvbiBpcyBub3QgYWN0dWFsbHkgYWJsZSB0byBkZXRlY3QKaW52
YWxpZCBtZXNzYWdlL3RhYmxlL3dvcmtsb2FkIG1hcHBpbmcuCgpDaGFuZ2UtSWQ6IEk2NjU4OGYy
MGRjMmMzOWRmZWI4YWVmYjY2NzU3ODEyNTg5ZWFiODEyClNpZ25lZC1vZmYtYnk6IEV2YW4gUXVh
biA8ZXZhbi5xdWFuQGFtZC5jb20+Ci0tLQogLi4uL2dwdS9kcm0vYW1kL2luY2x1ZGUva2dkX3Bw
X2ludGVyZmFjZS5oICAgIHwgIDEgKwogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5j
L3NtdV92MTFfMC5oIHwgMTUgKystLQogZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvbmF2
aTEwX3BwdC5jICAgIHwgNjggKysrKysrKysrKystLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2Ft
ZC9wb3dlcnBsYXkvdmVnYTIwX3BwdC5jICAgIHwgNjcgKysrKysrKysrKy0tLS0tLS0tCiA0IGZp
bGVzIGNoYW5nZWQsIDg2IGluc2VydGlvbnMoKyksIDY1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvaW5jbHVkZS9rZ2RfcHBfaW50ZXJmYWNlLmggYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2luY2x1ZGUva2dkX3BwX2ludGVyZmFjZS5oCmluZGV4IDlmNjYxYmY5
NmVkMC4uOTczM2JiZjliYzcyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2luY2x1
ZGUva2dkX3BwX2ludGVyZmFjZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvaW5jbHVkZS9r
Z2RfcHBfaW50ZXJmYWNlLmgKQEAgLTE0MSw2ICsxNDEsNyBAQCBlbnVtIFBQX1NNQ19QT1dFUl9Q
Uk9GSUxFIHsKIAlQUF9TTUNfUE9XRVJfUFJPRklMRV9WUiAgICAgICAgICAgPSAweDQsCiAJUFBf
U01DX1BPV0VSX1BST0ZJTEVfQ09NUFVURSAgICAgID0gMHg1LAogCVBQX1NNQ19QT1dFUl9QUk9G
SUxFX0NVU1RPTSAgICAgICA9IDB4NiwKKwlQUF9TTUNfUE9XRVJfUFJPRklMRV9DT1VOVCwKIH07
CiAKIGVudW0gewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5j
L3NtdV92MTFfMC5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaW5jL3NtdV92MTFf
MC5oCmluZGV4IDJmZmY0YjE2Y2I0ZS4uZmNiNTgwMTIxNzBmIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL3Bvd2VycGxheS9pbmMvc211X3YxMV8wLmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9wb3dlcnBsYXkvaW5jL3NtdV92MTFfMC5oCkBAIC00MywxOSArNDMsMjQgQEAKICNk
ZWZpbmUgU01VMTFfVE9PTF9TSVpFCQkJMHgxOTAwMAogCiAjZGVmaW5lIENMS19NQVAoY2xrLCBp
bmRleCkgXAotCVtTTVVfIyNjbGtdID0gaW5kZXgKKwlbU01VXyMjY2xrXSA9IHsxLCAoaW5kZXgp
fQogCiAjZGVmaW5lIEZFQV9NQVAoZmVhKSBcCi0JW1NNVV9GRUFUVVJFXyMjZmVhIyNfQklUXSA9
IEZFQVRVUkVfIyNmZWEjI19CSVQKKwlbU01VX0ZFQVRVUkVfIyNmZWEjI19CSVRdID0gezEsIEZF
QVRVUkVfIyNmZWEjI19CSVR9CiAKICNkZWZpbmUgVEFCX01BUCh0YWIpIFwKLQlbU01VX1RBQkxF
XyMjdGFiXSA9IFRBQkxFXyMjdGFiCisJW1NNVV9UQUJMRV8jI3RhYl0gPSB7MSwgVEFCTEVfIyN0
YWJ9CiAKICNkZWZpbmUgUFdSX01BUCh0YWIpIFwKLQlbU01VX1BPV0VSX1NPVVJDRV8jI3RhYl0g
PSBQT1dFUl9TT1VSQ0VfIyN0YWIKKwlbU01VX1BPV0VSX1NPVVJDRV8jI3RhYl0gPSB7MSwgUE9X
RVJfU09VUkNFXyMjdGFifQogCiAjZGVmaW5lIFdPUktMT0FEX01BUChwcm9maWxlLCB3b3JrbG9h
ZCkgXAotCVtwcm9maWxlXSA9IHdvcmtsb2FkCisJW3Byb2ZpbGVdID0gezEsICh3b3JrbG9hZCl9
CisKK3N0cnVjdCBzbXVfMTFfMF9jbW4yYWlzY19tYXBwaW5nIHsKKwlpbnQJdmFsaWRfbWFwcGlu
ZzsKKwlpbnQJbWFwX3RvOworfTsKIAogc3RydWN0IHNtdV8xMV8wX21heF9zdXN0YWluYWJsZV9j
bG9ja3MgewogCXVpbnQzMl90IGRpc3BsYXlfY2xvY2s7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bv
d2VycGxheS9uYXZpMTBfcHB0LmMKaW5kZXggNWVlNjUwOGYxZDEzLi5lNWZhODJlMTA1MzUgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L25hdmkxMF9wcHQuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9uYXZpMTBfcHB0LmMKQEAgLTQ5LDkgKzQ5
LDkgQEAKIAlGRUFUVVJFX01BU0soRkVBVFVSRV9EUE1fRENFRkNMS19CSVQpKQogCiAjZGVmaW5l
IE1TR19NQVAobXNnLCBpbmRleCkgXAotCVtTTVVfTVNHXyMjbXNnXSA9IGluZGV4CisJW1NNVV9N
U0dfIyNtc2ddID0gezEsIChpbmRleCl9CiAKLXN0YXRpYyBpbnQgbmF2aTEwX21lc3NhZ2VfbWFw
W1NNVV9NU0dfTUFYX0NPVU5UXSA9IHsKK3N0YXRpYyBzdHJ1Y3Qgc211XzExXzBfY21uMmFpc2Nf
bWFwcGluZyBuYXZpMTBfbWVzc2FnZV9tYXBbU01VX01TR19NQVhfQ09VTlRdID0gewogCU1TR19N
QVAoVGVzdE1lc3NhZ2UsCQkJUFBTTUNfTVNHX1Rlc3RNZXNzYWdlKSwKIAlNU0dfTUFQKEdldFNt
dVZlcnNpb24sCQkJUFBTTUNfTVNHX0dldFNtdVZlcnNpb24pLAogCU1TR19NQVAoR2V0RHJpdmVy
SWZWZXJzaW9uLAkJUFBTTUNfTVNHX0dldERyaXZlcklmVmVyc2lvbiksCkBAIC0xMTgsNyArMTE4
LDcgQEAgc3RhdGljIGludCBuYXZpMTBfbWVzc2FnZV9tYXBbU01VX01TR19NQVhfQ09VTlRdID0g
ewogCU1TR19NQVAoQXJtRDMsCQkJUFBTTUNfTVNHX0FybUQzKSwKIH07CiAKLXN0YXRpYyBpbnQg
bmF2aTEwX2Nsa19tYXBbU01VX0NMS19DT1VOVF0gPSB7CitzdGF0aWMgc3RydWN0IHNtdV8xMV8w
X2NtbjJhaXNjX21hcHBpbmcgbmF2aTEwX2Nsa19tYXBbU01VX0NMS19DT1VOVF0gPSB7CiAJQ0xL
X01BUChHRlhDTEssIFBQQ0xLX0dGWENMSyksCiAJQ0xLX01BUChTQ0xLLAlQUENMS19HRlhDTEsp
LAogCUNMS19NQVAoU09DQ0xLLCBQUENMS19TT0NDTEspLApAQCAtMTMzLDcgKzEzMyw3IEBAIHN0
YXRpYyBpbnQgbmF2aTEwX2Nsa19tYXBbU01VX0NMS19DT1VOVF0gPSB7CiAJQ0xLX01BUChQSFlD
TEssIFBQQ0xLX1BIWUNMSyksCiB9OwogCi1zdGF0aWMgaW50IG5hdmkxMF9mZWF0dXJlX21hc2tf
bWFwW1NNVV9GRUFUVVJFX0NPVU5UXSA9IHsKK3N0YXRpYyBzdHJ1Y3Qgc211XzExXzBfY21uMmFp
c2NfbWFwcGluZyBuYXZpMTBfZmVhdHVyZV9tYXNrX21hcFtTTVVfRkVBVFVSRV9DT1VOVF0gPSB7
CiAJRkVBX01BUChEUE1fUFJFRkVUQ0hFUiksCiAJRkVBX01BUChEUE1fR0ZYQ0xLKSwKIAlGRUFf
TUFQKERQTV9HRlhfUEFDRSksCkBAIC0xNzgsNyArMTc4LDcgQEAgc3RhdGljIGludCBuYXZpMTBf
ZmVhdHVyZV9tYXNrX21hcFtTTVVfRkVBVFVSRV9DT1VOVF0gPSB7CiAJRkVBX01BUChBVEhVQl9Q
RyksCiB9OwogCi1zdGF0aWMgaW50IG5hdmkxMF90YWJsZV9tYXBbU01VX1RBQkxFX0NPVU5UXSA9
IHsKK3N0YXRpYyBzdHJ1Y3Qgc211XzExXzBfY21uMmFpc2NfbWFwcGluZyBuYXZpMTBfdGFibGVf
bWFwW1NNVV9UQUJMRV9DT1VOVF0gPSB7CiAJVEFCX01BUChQUFRBQkxFKSwKIAlUQUJfTUFQKFdB
VEVSTUFSS1MpLAogCVRBQl9NQVAoQVZGUyksCkBAIC0xOTMsMTIgKzE5MywxMiBAQCBzdGF0aWMg
aW50IG5hdmkxMF90YWJsZV9tYXBbU01VX1RBQkxFX0NPVU5UXSA9IHsKIAlUQUJfTUFQKFBBQ0Up
LAogfTsKIAotc3RhdGljIGludCBuYXZpMTBfcHdyX3NyY19tYXBbU01VX1BPV0VSX1NPVVJDRV9D
T1VOVF0gPSB7CitzdGF0aWMgc3RydWN0IHNtdV8xMV8wX2NtbjJhaXNjX21hcHBpbmcgbmF2aTEw
X3B3cl9zcmNfbWFwW1NNVV9QT1dFUl9TT1VSQ0VfQ09VTlRdID0gewogCVBXUl9NQVAoQUMpLAog
CVBXUl9NQVAoREMpLAogfTsKIAotc3RhdGljIGludCBuYXZpMTBfd29ya2xvYWRfbWFwW10gPSB7
CitzdGF0aWMgc3RydWN0IHNtdV8xMV8wX2NtbjJhaXNjX21hcHBpbmcgbmF2aTEwX3dvcmtsb2Fk
X21hcFtQUF9TTUNfUE9XRVJfUFJPRklMRV9DT1VOVF0gPSB7CiAJV09SS0xPQURfTUFQKFBQX1NN
Q19QT1dFUl9QUk9GSUxFX0JPT1RVUF9ERUZBVUxULAlXT1JLTE9BRF9QUExJQl9ERUZBVUxUX0JJ
VCksCiAJV09SS0xPQURfTUFQKFBQX1NNQ19QT1dFUl9QUk9GSUxFX0ZVTExTQ1JFRU4zRCwJCVdP
UktMT0FEX1BQTElCX0ZVTExfU0NSRUVOXzNEX0JJVCksCiAJV09SS0xPQURfTUFQKFBQX1NNQ19Q
T1dFUl9QUk9GSUxFX1BPV0VSU0FWSU5HLAkJV09SS0xPQURfUFBMSUJfUE9XRVJfU0FWSU5HX0JJ
VCksCkBAIC0yMTAsNzkgKzIxMCw4NyBAQCBzdGF0aWMgaW50IG5hdmkxMF93b3JrbG9hZF9tYXBb
XSA9IHsKIAogc3RhdGljIGludCBuYXZpMTBfZ2V0X3NtdV9tc2dfaW5kZXgoc3RydWN0IHNtdV9j
b250ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4KQogewotCWludCB2YWw7CisJc3RydWN0IHNtdV8x
MV8wX2NtbjJhaXNjX21hcHBpbmcgbWFwcGluZzsKKwogCWlmIChpbmRleCA+IFNNVV9NU0dfTUFY
X0NPVU5UKQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCXZhbCA9IG5hdmkxMF9tZXNzYWdlX21hcFtp
bmRleF07Ci0JaWYgKHZhbCA+IFBQU01DX01lc3NhZ2VfQ291bnQpCisJbWFwcGluZyA9IG5hdmkx
MF9tZXNzYWdlX21hcFtpbmRleF07CisJaWYgKCEobWFwcGluZy52YWxpZF9tYXBwaW5nKSkKIAkJ
cmV0dXJuIC1FSU5WQUw7CiAKLQlyZXR1cm4gdmFsOworCXJldHVybiBtYXBwaW5nLm1hcF90bzsK
IH0KIAogc3RhdGljIGludCBuYXZpMTBfZ2V0X3NtdV9jbGtfaW5kZXgoc3RydWN0IHNtdV9jb250
ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4KQogewotCWludCB2YWw7CisJc3RydWN0IHNtdV8xMV8w
X2NtbjJhaXNjX21hcHBpbmcgbWFwcGluZzsKKwogCWlmIChpbmRleCA+PSBTTVVfQ0xLX0NPVU5U
KQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCXZhbCA9IG5hdmkxMF9jbGtfbWFwW2luZGV4XTsKLQlp
ZiAodmFsID49IFBQQ0xLX0NPVU5UKQorCW1hcHBpbmcgPSBuYXZpMTBfY2xrX21hcFtpbmRleF07
CisJaWYgKCEobWFwcGluZy52YWxpZF9tYXBwaW5nKSkKIAkJcmV0dXJuIC1FSU5WQUw7CiAKLQly
ZXR1cm4gdmFsOworCXJldHVybiBtYXBwaW5nLm1hcF90bzsKIH0KIAogc3RhdGljIGludCBuYXZp
MTBfZ2V0X3NtdV9mZWF0dXJlX2luZGV4KHN0cnVjdCBzbXVfY29udGV4dCAqc21jLCB1aW50MzJf
dCBpbmRleCkKIHsKLQlpbnQgdmFsOworCXN0cnVjdCBzbXVfMTFfMF9jbW4yYWlzY19tYXBwaW5n
IG1hcHBpbmc7CisKIAlpZiAoaW5kZXggPj0gU01VX0ZFQVRVUkVfQ09VTlQpCiAJCXJldHVybiAt
RUlOVkFMOwogCi0JdmFsID0gbmF2aTEwX2ZlYXR1cmVfbWFza19tYXBbaW5kZXhdOwotCWlmICh2
YWwgPiA2NCkKKwltYXBwaW5nID0gbmF2aTEwX2ZlYXR1cmVfbWFza19tYXBbaW5kZXhdOworCWlm
ICghKG1hcHBpbmcudmFsaWRfbWFwcGluZykpCiAJCXJldHVybiAtRUlOVkFMOwogCi0JcmV0dXJu
IHZhbDsKKwlyZXR1cm4gbWFwcGluZy5tYXBfdG87CiB9CiAKIHN0YXRpYyBpbnQgbmF2aTEwX2dl
dF9zbXVfdGFibGVfaW5kZXgoc3RydWN0IHNtdV9jb250ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4
KQogewotCWludCB2YWw7CisJc3RydWN0IHNtdV8xMV8wX2NtbjJhaXNjX21hcHBpbmcgbWFwcGlu
ZzsKKwogCWlmIChpbmRleCA+PSBTTVVfVEFCTEVfQ09VTlQpCiAJCXJldHVybiAtRUlOVkFMOwog
Ci0JdmFsID0gbmF2aTEwX3RhYmxlX21hcFtpbmRleF07Ci0JaWYgKHZhbCA+PSBUQUJMRV9DT1VO
VCkKKwltYXBwaW5nID0gbmF2aTEwX3RhYmxlX21hcFtpbmRleF07CisJaWYgKCEobWFwcGluZy52
YWxpZF9tYXBwaW5nKSkKIAkJcmV0dXJuIC1FSU5WQUw7CiAKLQlyZXR1cm4gdmFsOworCXJldHVy
biBtYXBwaW5nLm1hcF90bzsKIH0KIAogc3RhdGljIGludCBuYXZpMTBfZ2V0X3B3cl9zcmNfaW5k
ZXgoc3RydWN0IHNtdV9jb250ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4KQogewotCWludCB2YWw7
CisJc3RydWN0IHNtdV8xMV8wX2NtbjJhaXNjX21hcHBpbmcgbWFwcGluZzsKKwogCWlmIChpbmRl
eCA+PSBTTVVfUE9XRVJfU09VUkNFX0NPVU5UKQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCXZhbCA9
IG5hdmkxMF9wd3Jfc3JjX21hcFtpbmRleF07Ci0JaWYgKHZhbCA+PSBQT1dFUl9TT1VSQ0VfQ09V
TlQpCisJbWFwcGluZyA9IG5hdmkxMF9wd3Jfc3JjX21hcFtpbmRleF07CisJaWYgKCEobWFwcGlu
Zy52YWxpZF9tYXBwaW5nKSkKIAkJcmV0dXJuIC1FSU5WQUw7CiAKLQlyZXR1cm4gdmFsOworCXJl
dHVybiBtYXBwaW5nLm1hcF90bzsKIH0KIAogCiBzdGF0aWMgaW50IG5hdmkxMF9nZXRfd29ya2xv
YWRfdHlwZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBQUF9TTUNfUE9XRVJfUFJPRklM
RSBwcm9maWxlKQogewotCWludCB2YWw7CisJc3RydWN0IHNtdV8xMV8wX2NtbjJhaXNjX21hcHBp
bmcgbWFwcGluZzsKKwogCWlmIChwcm9maWxlID4gUFBfU01DX1BPV0VSX1BST0ZJTEVfQ1VTVE9N
KQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCXZhbCA9IG5hdmkxMF93b3JrbG9hZF9tYXBbcHJvZmls
ZV07CisJbWFwcGluZyA9IG5hdmkxMF93b3JrbG9hZF9tYXBbcHJvZmlsZV07CisJaWYgKCEobWFw
cGluZy52YWxpZF9tYXBwaW5nKSkKKwkJcmV0dXJuIC1FSU5WQUw7CiAKLQlyZXR1cm4gdmFsOwor
CXJldHVybiBtYXBwaW5nLm1hcF90bzsKIH0KIAogc3RhdGljIGJvb2wgaXNfYXNpY19zZWN1cmUo
c3RydWN0IHNtdV9jb250ZXh0ICpzbXUpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L3Bvd2VycGxheS92ZWdhMjBfcHB0LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS92
ZWdhMjBfcHB0LmMKaW5kZXggZDk3NDAzODRhMDhlLi40Njg1NzkxYTY1ZGEgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L3ZlZ2EyMF9wcHQuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL3Bvd2VycGxheS92ZWdhMjBfcHB0LmMKQEAgLTQ3LDcgKzQ3LDcgQEAKICNk
ZWZpbmUgQ1RGX09GRlNFVF9IQk0JCQk1CiAKICNkZWZpbmUgTVNHX01BUChtc2cpIFwKLQlbU01V
X01TR18jI21zZ10gPSBQUFNNQ19NU0dfIyNtc2cKKwlbU01VX01TR18jI21zZ10gPSB7MSwgUFBT
TUNfTVNHXyMjbXNnfQogCiAjZGVmaW5lIFNNQ19EUE1fRkVBVFVSRSAoRkVBVFVSRV9EUE1fUFJF
RkVUQ0hFUl9NQVNLIHwgXAogCQkJIEZFQVRVUkVfRFBNX0dGWENMS19NQVNLIHwgXApAQCAtNTks
NyArNTksNyBAQAogCQkJIEZFQVRVUkVfRFBNX0xJTktfTUFTSyB8IFwKIAkJCSBGRUFUVVJFX0RQ
TV9EQ0VGQ0xLX01BU0spCiAKLXN0YXRpYyBpbnQgdmVnYTIwX21lc3NhZ2VfbWFwW1NNVV9NU0df
TUFYX0NPVU5UXSA9IHsKK3N0YXRpYyBzdHJ1Y3Qgc211XzExXzBfY21uMmFpc2NfbWFwcGluZyB2
ZWdhMjBfbWVzc2FnZV9tYXBbU01VX01TR19NQVhfQ09VTlRdID0gewogCU1TR19NQVAoVGVzdE1l
c3NhZ2UpLAogCU1TR19NQVAoR2V0U211VmVyc2lvbiksCiAJTVNHX01BUChHZXREcml2ZXJJZlZl
cnNpb24pLApAQCAtMTQ1LDcgKzE0NSw3IEBAIHN0YXRpYyBpbnQgdmVnYTIwX21lc3NhZ2VfbWFw
W1NNVV9NU0dfTUFYX0NPVU5UXSA9IHsKIAlNU0dfTUFQKEdldEFWRlNWb2x0YWdlQnlEcG0pLAog
fTsKIAotc3RhdGljIGludCB2ZWdhMjBfY2xrX21hcFtTTVVfQ0xLX0NPVU5UXSA9IHsKK3N0YXRp
YyBzdHJ1Y3Qgc211XzExXzBfY21uMmFpc2NfbWFwcGluZyB2ZWdhMjBfY2xrX21hcFtTTVVfQ0xL
X0NPVU5UXSA9IHsKIAlDTEtfTUFQKEdGWENMSywgUFBDTEtfR0ZYQ0xLKSwKIAlDTEtfTUFQKFZD
TEssIFBQQ0xLX1ZDTEspLAogCUNMS19NQVAoRENMSywgUFBDTEtfRENMSyksCkBAIC0xNTksNyAr
MTU5LDcgQEAgc3RhdGljIGludCB2ZWdhMjBfY2xrX21hcFtTTVVfQ0xLX0NPVU5UXSA9IHsKIAlD
TEtfTUFQKEZDTEssIFBQQ0xLX0ZDTEspLAogfTsKIAotc3RhdGljIGludCB2ZWdhMjBfZmVhdHVy
ZV9tYXNrX21hcFtTTVVfRkVBVFVSRV9DT1VOVF0gPSB7CitzdGF0aWMgc3RydWN0IHNtdV8xMV8w
X2NtbjJhaXNjX21hcHBpbmcgdmVnYTIwX2ZlYXR1cmVfbWFza19tYXBbU01VX0ZFQVRVUkVfQ09V
TlRdID0gewogCUZFQV9NQVAoRFBNX1BSRUZFVENIRVIpLAogCUZFQV9NQVAoRFBNX0dGWENMSyks
CiAJRkVBX01BUChEUE1fVUNMSyksCkBAIC0xOTUsNyArMTk1LDcgQEAgc3RhdGljIGludCB2ZWdh
MjBfZmVhdHVyZV9tYXNrX21hcFtTTVVfRkVBVFVSRV9DT1VOVF0gPSB7CiAJRkVBX01BUChYR01J
KSwKIH07CiAKLXN0YXRpYyBpbnQgdmVnYTIwX3RhYmxlX21hcFtTTVVfVEFCTEVfQ09VTlRdID0g
eworc3RhdGljIHN0cnVjdCBzbXVfMTFfMF9jbW4yYWlzY19tYXBwaW5nIHZlZ2EyMF90YWJsZV9t
YXBbU01VX1RBQkxFX0NPVU5UXSA9IHsKIAlUQUJfTUFQKFBQVEFCTEUpLAogCVRBQl9NQVAoV0FU
RVJNQVJLUyksCiAJVEFCX01BUChBVkZTKSwKQEAgLTIwOCwxMiArMjA4LDEyIEBAIHN0YXRpYyBp
bnQgdmVnYTIwX3RhYmxlX21hcFtTTVVfVEFCTEVfQ09VTlRdID0gewogCVRBQl9NQVAoT1ZFUkRS
SVZFKSwKIH07CiAKLXN0YXRpYyBpbnQgdmVnYTIwX3B3cl9zcmNfbWFwW1NNVV9QT1dFUl9TT1VS
Q0VfQ09VTlRdID0geworc3RhdGljIHN0cnVjdCBzbXVfMTFfMF9jbW4yYWlzY19tYXBwaW5nIHZl
Z2EyMF9wd3Jfc3JjX21hcFtTTVVfUE9XRVJfU09VUkNFX0NPVU5UXSA9IHsKIAlQV1JfTUFQKEFD
KSwKIAlQV1JfTUFQKERDKSwKIH07CiAKLXN0YXRpYyBpbnQgdmVnYTIwX3dvcmtsb2FkX21hcFtd
ID0geworc3RhdGljIHN0cnVjdCBzbXVfMTFfMF9jbW4yYWlzY19tYXBwaW5nIHZlZ2EyMF93b3Jr
bG9hZF9tYXBbUFBfU01DX1BPV0VSX1BST0ZJTEVfQ09VTlRdID0gewogCVdPUktMT0FEX01BUChQ
UF9TTUNfUE9XRVJfUFJPRklMRV9CT09UVVBfREVGQVVMVCwJV09SS0xPQURfREVGQVVMVF9CSVQp
LAogCVdPUktMT0FEX01BUChQUF9TTUNfUE9XRVJfUFJPRklMRV9GVUxMU0NSRUVOM0QsCQlXT1JL
TE9BRF9QUExJQl9GVUxMX1NDUkVFTl8zRF9CSVQpLAogCVdPUktMT0FEX01BUChQUF9TTUNfUE9X
RVJfUFJPRklMRV9QT1dFUlNBVklORywJCVdPUktMT0FEX1BQTElCX1BPV0VSX1NBVklOR19CSVQp
LApAQCAtMjI1LDc5ICsyMjUsODYgQEAgc3RhdGljIGludCB2ZWdhMjBfd29ya2xvYWRfbWFwW10g
PSB7CiAKIHN0YXRpYyBpbnQgdmVnYTIwX2dldF9zbXVfdGFibGVfaW5kZXgoc3RydWN0IHNtdV9j
b250ZXh0ICpzbWMsIHVpbnQzMl90IGluZGV4KQogewotCWludCB2YWw7CisJc3RydWN0IHNtdV8x
MV8wX2NtbjJhaXNjX21hcHBpbmcgbWFwcGluZzsKKwogCWlmIChpbmRleCA+PSBTTVVfVEFCTEVf
Q09VTlQpCiAJCXJldHVybiAtRUlOVkFMOwogCi0JdmFsID0gdmVnYTIwX3RhYmxlX21hcFtpbmRl
eF07Ci0JaWYgKHZhbCA+PSBUQUJMRV9DT1VOVCkKKwltYXBwaW5nID0gdmVnYTIwX3RhYmxlX21h
cFtpbmRleF07CisJaWYgKCEobWFwcGluZy52YWxpZF9tYXBwaW5nKSkKIAkJcmV0dXJuIC1FSU5W
QUw7CiAKLQlyZXR1cm4gdmFsOworCXJldHVybiBtYXBwaW5nLm1hcF90bzsKIH0KIAogc3RhdGlj
IGludCB2ZWdhMjBfZ2V0X3B3cl9zcmNfaW5kZXgoc3RydWN0IHNtdV9jb250ZXh0ICpzbWMsIHVp
bnQzMl90IGluZGV4KQogewotCWludCB2YWw7CisJc3RydWN0IHNtdV8xMV8wX2NtbjJhaXNjX21h
cHBpbmcgbWFwcGluZzsKKwogCWlmIChpbmRleCA+PSBTTVVfUE9XRVJfU09VUkNFX0NPVU5UKQog
CQlyZXR1cm4gLUVJTlZBTDsKIAotCXZhbCA9IHZlZ2EyMF9wd3Jfc3JjX21hcFtpbmRleF07Ci0J
aWYgKHZhbCA+PSBQT1dFUl9TT1VSQ0VfQ09VTlQpCisJbWFwcGluZyA9IHZlZ2EyMF9wd3Jfc3Jj
X21hcFtpbmRleF07CisJaWYgKCEobWFwcGluZy52YWxpZF9tYXBwaW5nKSkKIAkJcmV0dXJuIC1F
SU5WQUw7CiAKLQlyZXR1cm4gdmFsOworCXJldHVybiBtYXBwaW5nLm1hcF90bzsKIH0KIAogc3Rh
dGljIGludCB2ZWdhMjBfZ2V0X3NtdV9mZWF0dXJlX2luZGV4KHN0cnVjdCBzbXVfY29udGV4dCAq
c21jLCB1aW50MzJfdCBpbmRleCkKIHsKLQlpbnQgdmFsOworCXN0cnVjdCBzbXVfMTFfMF9jbW4y
YWlzY19tYXBwaW5nIG1hcHBpbmc7CisKIAlpZiAoaW5kZXggPj0gU01VX0ZFQVRVUkVfQ09VTlQp
CiAJCXJldHVybiAtRUlOVkFMOwogCi0JdmFsID0gdmVnYTIwX2ZlYXR1cmVfbWFza19tYXBbaW5k
ZXhdOwotCWlmICh2YWwgPiA2NCkKKwltYXBwaW5nID0gdmVnYTIwX2ZlYXR1cmVfbWFza19tYXBb
aW5kZXhdOworCWlmICghKG1hcHBpbmcudmFsaWRfbWFwcGluZykpCiAJCXJldHVybiAtRUlOVkFM
OwogCi0JcmV0dXJuIHZhbDsKKwlyZXR1cm4gbWFwcGluZy5tYXBfdG87CiB9CiAKIHN0YXRpYyBp
bnQgdmVnYTIwX2dldF9zbXVfY2xrX2luZGV4KHN0cnVjdCBzbXVfY29udGV4dCAqc21jLCB1aW50
MzJfdCBpbmRleCkKIHsKLQlpbnQgdmFsOworCXN0cnVjdCBzbXVfMTFfMF9jbW4yYWlzY19tYXBw
aW5nIG1hcHBpbmc7CisKIAlpZiAoaW5kZXggPj0gU01VX0NMS19DT1VOVCkKIAkJcmV0dXJuIC1F
SU5WQUw7CiAKLQl2YWwgPSB2ZWdhMjBfY2xrX21hcFtpbmRleF07Ci0JaWYgKHZhbCA+PSBQUENM
S19DT1VOVCkKKwltYXBwaW5nID0gdmVnYTIwX2Nsa19tYXBbaW5kZXhdOworCWlmICghKG1hcHBp
bmcudmFsaWRfbWFwcGluZykpCiAJCXJldHVybiAtRUlOVkFMOwogCi0JcmV0dXJuIHZhbDsKKwly
ZXR1cm4gbWFwcGluZy5tYXBfdG87CiB9CiAKIHN0YXRpYyBpbnQgdmVnYTIwX2dldF9zbXVfbXNn
X2luZGV4KHN0cnVjdCBzbXVfY29udGV4dCAqc21jLCB1aW50MzJfdCBpbmRleCkKIHsKLQlpbnQg
dmFsOworCXN0cnVjdCBzbXVfMTFfMF9jbW4yYWlzY19tYXBwaW5nIG1hcHBpbmc7CiAKIAlpZiAo
aW5kZXggPj0gU01VX01TR19NQVhfQ09VTlQpCiAJCXJldHVybiAtRUlOVkFMOwogCi0JdmFsID0g
dmVnYTIwX21lc3NhZ2VfbWFwW2luZGV4XTsKLQlpZiAodmFsID4gUFBTTUNfTWVzc2FnZV9Db3Vu
dCkKKwltYXBwaW5nID0gdmVnYTIwX21lc3NhZ2VfbWFwW2luZGV4XTsKKwlpZiAoIShtYXBwaW5n
LnZhbGlkX21hcHBpbmcpKQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCXJldHVybiB2YWw7CisJcmV0
dXJuIG1hcHBpbmcubWFwX3RvOwogfQogCiBzdGF0aWMgaW50IHZlZ2EyMF9nZXRfd29ya2xvYWRf
dHlwZShzdHJ1Y3Qgc211X2NvbnRleHQgKnNtdSwgZW51bSBQUF9TTUNfUE9XRVJfUFJPRklMRSBw
cm9maWxlKQogewotCWludCB2YWw7CisJc3RydWN0IHNtdV8xMV8wX2NtbjJhaXNjX21hcHBpbmcg
bWFwcGluZzsKKwogCWlmIChwcm9maWxlID4gUFBfU01DX1BPV0VSX1BST0ZJTEVfQ1VTVE9NKQog
CQlyZXR1cm4gLUVJTlZBTDsKIAotCXZhbCA9IHZlZ2EyMF93b3JrbG9hZF9tYXBbcHJvZmlsZV07
CisJbWFwcGluZyA9IHZlZ2EyMF93b3JrbG9hZF9tYXBbcHJvZmlsZV07CisJaWYgKCEobWFwcGlu
Zy52YWxpZF9tYXBwaW5nKSkKKwkJcmV0dXJuIC1FSU5WQUw7CiAKLQlyZXR1cm4gdmFsOworCXJl
dHVybiBtYXBwaW5nLm1hcF90bzsKIH0KIAogc3RhdGljIGludCB2ZWdhMjBfdGFibGVzX2luaXQo
c3RydWN0IHNtdV9jb250ZXh0ICpzbXUsIHN0cnVjdCBzbXVfdGFibGUgKnRhYmxlcykKLS0gCjIu
MjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1k
LWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
