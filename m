Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B2AE619B79E
	for <lists+amd-gfx@lfdr.de>; Wed,  1 Apr 2020 23:30:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1A30F6E9A6;
	Wed,  1 Apr 2020 21:30:03 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM11-BN8-obe.outbound.protection.outlook.com
 (mail-bn8nam11on2050.outbound.protection.outlook.com [40.107.236.50])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C19A86E9A6
 for <amd-gfx@lists.freedesktop.org>; Wed,  1 Apr 2020 21:30:01 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=TmFwb8avcju/4kGSzG4Xg+jFrPi01RkDnuecopswpUttafqb4WTllTyYCy7pTvormxmZS6ZTdqew8kX+DYzfrYZJ/oKIJyuz+ItBEeZwQfyRVcz8UedUynaf/uZOHWLudb4mYUEbA0tncScfeBItA5CNZDOKixZvL5lk1KCzp/PrCIgGvU0+6zeSzz5uTronLcVkvYzJwFiMRCHg9OL+Ey9E/z9WJlnSUR4HCovhg4XJroXpAogJrK9oHjVaPgKs80x3ZKMVUKaUOKQcW/j+Jh69YtC+csM2A92C71rsKEmJmpJf1xBobPKXNpy61i0jLoNXAs2YjI7Nfe+Gkf8snQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=qebYG+ng/RazogcA+7jcJVP9kPjVLKlX8Tu1xKHJZrY=;
 b=jyy0AdjXi2Jg0j9SZzfyhi/8/j/8tukiW4/QDpUKQOxysTRRqBQyCfyNmzWaagbWu8GI1PpZCQ1wgjsG/hqr0BDWdjQhEZ07XgMewT+yyom3+H8H8GARplVSzI55fkZWwbWTmZoxv5azKKs91sG+KgPEtAfWEzcaJCcNSCXNtF9q53qQbRzbQ/Fro+/M7CJjejulnvAfZZemzxq8v0c8s0kZUNTZkB99KzEnYEb/JuTViYePhZ/Px1Zj0TW2Y6+0+7SMPYYLY7iCkRCay83bRl9MAm2oHUpGTk2OscZnmaNetvOBJAtBzG5r843pZrS38Nn+mOoOXlRnPM0E0yVjEQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=qebYG+ng/RazogcA+7jcJVP9kPjVLKlX8Tu1xKHJZrY=;
 b=KfG8ByAeghhNrav+6vlXcej78yxHxiA28wDVnJHeA9pAbE8zvXnKW/tEHYbdSopdRkjW+VsW1K1VhSelx+GauzI4nOzie/oWNqtvoFbHRGeTLAfzsVFw4bfLVC3RDkP8DpRuDv6hNB0NhGoJT9m1bXE2kAwlKH3cYkbdJdZdMi0=
Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Felix.Kuehling@amd.com; 
Received: from SN1PR12MB2414.namprd12.prod.outlook.com (2603:10b6:802:2e::31)
 by SN1PR12MB2493.namprd12.prod.outlook.com (2603:10b6:802:2d::30)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2878.15; Wed, 1 Apr
 2020 21:29:59 +0000
Received: from SN1PR12MB2414.namprd12.prod.outlook.com
 ([fe80::38ef:1510:9525:f806]) by SN1PR12MB2414.namprd12.prod.outlook.com
 ([fe80::38ef:1510:9525:f806%7]) with mapi id 15.20.2856.019; Wed, 1 Apr 2020
 21:29:59 +0000
Subject: Re: [PATCH] Revert "drm/amdgpu: call psp to program ih cntl in SR-IOV
 for Navi"
To: Alex Sierra <alex.sierra@amd.com>, amd-gfx@lists.freedesktop.org
References: <20200401210052.10420-1-alex.sierra@amd.com>
From: Felix Kuehling <felix.kuehling@amd.com>
Message-ID: <12f3789b-1a0a-d960-ae6c-cd823d7b3c5f@amd.com>
Date: Wed, 1 Apr 2020 17:29:57 -0400
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.4.1
In-Reply-To: <20200401210052.10420-1-alex.sierra@amd.com>
Content-Language: en-US
X-ClientProxiedBy: YTBPR01CA0005.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b01:14::18) To SN1PR12MB2414.namprd12.prod.outlook.com
 (2603:10b6:802:2e::31)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from [192.168.2.100] (142.116.63.128) by
 YTBPR01CA0005.CANPRD01.PROD.OUTLOOK.COM (2603:10b6:b01:14::18) with Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2878.15 via Frontend Transport; Wed, 1 Apr 2020 21:29:59 +0000
X-Originating-IP: [142.116.63.128]
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-HT: Tenant
X-MS-Office365-Filtering-Correlation-Id: ad6e8013-859a-4f72-e033-08d7d683d4b9
X-MS-TrafficTypeDiagnostic: SN1PR12MB2493:|SN1PR12MB2493:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <SN1PR12MB2493E92066A84F50106D6E5792C90@SN1PR12MB2493.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:6790;
X-Forefront-PRVS: 03607C04F0
X-Forefront-Antispam-Report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:SN1PR12MB2414.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFTY:;
 SFS:(10009020)(4636009)(39860400002)(136003)(346002)(396003)(376002)(366004)(316002)(81166006)(81156014)(16576012)(2906002)(31696002)(86362001)(2616005)(956004)(44832011)(8936002)(66946007)(36756003)(31686004)(66556008)(66476007)(52116002)(478600001)(5660300002)(8676002)(6486002)(186003)(26005)(16526019)(309714004);
 DIR:OUT; SFP:1101; 
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: UP7H/D04DzcQe8TSmF5FcAiuv0sM1OQuVfe8oStCbHzR4hJJoFdJhE1LyuKfn+jJRX8ALh99O9IxWKXN6RoyAZPCaJl+QJJUxK/6QbJx292U0SDUURlI8im14IkLj8LkPJhbLFmsNamBYV4PyS4QyLWaVbOz08LHYcprvIlW15FkgcHljJGoSIUUhn4xRGFgcEtVWzE9FrNs+YszC5Fwt+3ZgQjD+K+K9HU6tKK8vFLA0p33je6yQEtXi7pUWmvFA69wbco8uTljmdKuZbk03H6Ott2c4oX4q8ZMMDiqA12JLHey0Fj094+c7KHvk1hnA+IYJtUIysd7UqHDFRb+0lUSkOEfuMU3xqInWcqzA4sY7YoG3onG/4F+mNBIoeke8BVZSEakx8m1y/CFdsjYvAfXah40UMASorDkvAu6040qm2451xXOajwjOz22JhpJ3RySNwWdymiPJqxWhykjObGni3BkeIjah7uEL3cbBREnWd+h3p0of3Di9wXDFF0+
X-MS-Exchange-AntiSpam-MessageData: 94+k/HQx4XUkoZdZjTqHCouQbsgJA1hMRRWHw4qsdXc3arfk8wDoKtpnbEhM+874h06n7x3mauRhLzds+ANxZsYSsG37WBLf8m+5BlHsibmEgRZ8JFNwIE+Ko+JW4k3K58UtkCW3tQ/7kLcHQgtInA==
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: ad6e8013-859a-4f72-e033-08d7d683d4b9
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 01 Apr 2020 21:29:59.5854 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: TaSNL1SoVBLGRPE+bvHvk1pj+HfTvEVAVunnoGnefTTy+E6NCh05N+SbaIiX6Y2Pr15e+F0jFV9bUm7VJazZ2A==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SN1PR12MB2493
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QW0gMjAyMC0wNC0wMSB1bSA1OjAwIHAubS4gc2NocmllYiBBbGV4IFNpZXJyYToKPiBUaGlzIHJl
dmVydHMgY29tbWl0IDllNTE3YmI4NGMyODJjMWYwNmVkZGVkMjBmMTZmOTI3NDI2ZDJlNDAuCj4g
TmF2aSBBU0lDcyBkb24ndCByZXF1aXJlIHRvIGFjY2VzcyB0aHJvdWdoIFBTUCB0byBvc3NzeXMg
cmVnaXN0ZXJzLgo+IFRoaXMgb24gU1ItSU9WIGNvbmZpZ3VyYXRpb24uCgpJZiB5b3Ugc3VibWl0
IHRoaXMgY2hhbmdlLCBwbGVhc2UgZG9uJ3QgZm9yZ2V0IHRvIGFkZCBhIFNpZ25lZC1vZmYtYnkK
bGluZSBhbmQgZmVlbCBmcmVlIHRvIGFkZCBteSBSZXZpZXdlZC1ieS4KCkJ1dCBJIHRoaW5rIHdl
IGRvbid0IG5lZWQgdG8gcmV2ZXJ0IGl0LiBKdXN0IGNoYW5nZSB0aGUgY29uZGl0aW9uIGZvcgp1
c2luZyBQU1AuIFNlZSBpbmxpbmUgLi4uCgoKPiAtLS0KPiAgZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvbmF2aTEwX2loLmMgfCA4OSArKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo+ICAxIGZp
bGUgY2hhbmdlZCwgOSBpbnNlcnRpb25zKCspLCA4MCBkZWxldGlvbnMoLSkKPgo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9uYXZpMTBfaWguYyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L25hdmkxMF9paC5jCj4gaW5kZXggNmZjYTUyMDY4MzNkLi40OTY4MjU5
YTIyYzQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbmF2aTEwX2lo
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9uYXZpMTBfaWguYwo+IEBAIC00
OSwzMCArNDksMTQgQEAgc3RhdGljIHZvaWQgbmF2aTEwX2loX2VuYWJsZV9pbnRlcnJ1cHRzKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQo+ICAKPiAgCWloX3JiX2NudGwgPSBSRUdfU0VUX0ZJ
RUxEKGloX3JiX2NudGwsIElIX1JCX0NOVEwsIFJCX0VOQUJMRSwgMSk7Cj4gIAlpaF9yYl9jbnRs
ID0gUkVHX1NFVF9GSUVMRChpaF9yYl9jbnRsLCBJSF9SQl9DTlRMLCBFTkFCTEVfSU5UUiwgMSk7
Cj4gLQlpZiAoYW1kZ3B1X3NyaW92X3ZmKGFkZXYpKSB7CgpKdXN0IGNoYW5nZSB0aGlzIGNvbmRp
dGlvbiB0byBpZiAoYW1kZ3B1X3NyaW92X3ZmKGFkZXYpICYmCmFkZXYtPmFzaWNfdHlwZSA8IENI
SVBfTkFWSTEwKSBldmVyeXdoZXJlLgoKUmVnYXJkcywKwqAgRmVsaXgKCgo+IC0JCWlmIChwc3Bf
cmVnX3Byb2dyYW0oJmFkZXYtPnBzcCwgUFNQX1JFR19JSF9SQl9DTlRMLCBpaF9yYl9jbnRsKSkg
ewo+IC0JCQlEUk1fRVJST1IoIlBTUCBwcm9ncmFtIElIX1JCX0NOVEwgZmFpbGVkIVxuIik7Cj4g
LQkJCXJldHVybjsKPiAtCQl9Cj4gLQl9IGVsc2Ugewo+IC0JCVdSRUczMl9TT0MxNShPU1NTWVMs
IDAsIG1tSUhfUkJfQ05UTCwgaWhfcmJfY250bCk7Cj4gLQl9Cj4gLQo+ICsJV1JFRzMyX1NPQzE1
KE9TU1NZUywgMCwgbW1JSF9SQl9DTlRMLCBpaF9yYl9jbnRsKTsKPiAgCWFkZXYtPmlycS5paC5l
bmFibGVkID0gdHJ1ZTsKPiAgCj4gIAlpZiAoYWRldi0+aXJxLmloMS5yaW5nX3NpemUpIHsKPiAg
CQlpaF9yYl9jbnRsID0gUlJFRzMyX1NPQzE1KE9TU1NZUywgMCwgbW1JSF9SQl9DTlRMX1JJTkcx
KTsKPiAgCQlpaF9yYl9jbnRsID0gUkVHX1NFVF9GSUVMRChpaF9yYl9jbnRsLCBJSF9SQl9DTlRM
X1JJTkcxLAo+ICAJCQkJCSAgIFJCX0VOQUJMRSwgMSk7Cj4gLQkJaWYgKGFtZGdwdV9zcmlvdl92
ZihhZGV2KSkgewo+IC0JCQlpZiAocHNwX3JlZ19wcm9ncmFtKCZhZGV2LT5wc3AsIFBTUF9SRUdf
SUhfUkJfQ05UTF9SSU5HMSwKPiAtCQkJCQkJaWhfcmJfY250bCkpIHsKPiAtCQkJCURSTV9FUlJP
UigicHJvZ3JhbSBJSF9SQl9DTlRMX1JJTkcxIGZhaWxlZCFcbiIpOwo+IC0JCQkJcmV0dXJuOwo+
IC0JCQl9Cj4gLQkJfSBlbHNlIHsKPiAtCQkJV1JFRzMyX1NPQzE1KE9TU1NZUywgMCwgbW1JSF9S
Ql9DTlRMX1JJTkcxLCBpaF9yYl9jbnRsKTsKPiAtCQl9Cj4gKwkJV1JFRzMyX1NPQzE1KE9TU1NZ
UywgMCwgbW1JSF9SQl9DTlRMX1JJTkcxLCBpaF9yYl9jbnRsKTsKPiAgCQlhZGV2LT5pcnEuaWgx
LmVuYWJsZWQgPSB0cnVlOwo+ICAJfQo+ICAKPiBAQCAtODAsMTUgKzY0LDcgQEAgc3RhdGljIHZv
aWQgbmF2aTEwX2loX2VuYWJsZV9pbnRlcnJ1cHRzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
KQo+ICAJCWloX3JiX2NudGwgPSBSUkVHMzJfU09DMTUoT1NTU1lTLCAwLCBtbUlIX1JCX0NOVExf
UklORzIpOwo+ICAJCWloX3JiX2NudGwgPSBSRUdfU0VUX0ZJRUxEKGloX3JiX2NudGwsIElIX1JC
X0NOVExfUklORzIsCj4gIAkJCQkJICAgUkJfRU5BQkxFLCAxKTsKPiAtCQlpZiAoYW1kZ3B1X3Ny
aW92X3ZmKGFkZXYpKSB7Cj4gLQkJCWlmIChwc3BfcmVnX3Byb2dyYW0oJmFkZXYtPnBzcCwgUFNQ
X1JFR19JSF9SQl9DTlRMX1JJTkcyLAo+IC0JCQkJCQlpaF9yYl9jbnRsKSkgewo+IC0JCQkJRFJN
X0VSUk9SKCJwcm9ncmFtIElIX1JCX0NOVExfUklORzIgZmFpbGVkIVxuIik7Cj4gLQkJCQlyZXR1
cm47Cj4gLQkJCX0KPiAtCQl9IGVsc2Ugewo+IC0JCQlXUkVHMzJfU09DMTUoT1NTU1lTLCAwLCBt
bUlIX1JCX0NOVExfUklORzIsIGloX3JiX2NudGwpOwo+IC0JCX0KPiArCQlXUkVHMzJfU09DMTUo
T1NTU1lTLCAwLCBtbUlIX1JCX0NOVExfUklORzIsIGloX3JiX2NudGwpOwo+ICAJCWFkZXYtPmly
cS5paDIuZW5hYmxlZCA9IHRydWU7Cj4gIAl9Cj4gIH0KPiBAQCAtMTA2LDE1ICs4Miw3IEBAIHN0
YXRpYyB2b2lkIG5hdmkxMF9paF9kaXNhYmxlX2ludGVycnVwdHMoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYpCj4gIAo+ICAJaWhfcmJfY250bCA9IFJFR19TRVRfRklFTEQoaWhfcmJfY250bCwg
SUhfUkJfQ05UTCwgUkJfRU5BQkxFLCAwKTsKPiAgCWloX3JiX2NudGwgPSBSRUdfU0VUX0ZJRUxE
KGloX3JiX2NudGwsIElIX1JCX0NOVEwsIEVOQUJMRV9JTlRSLCAwKTsKPiAtCWlmIChhbWRncHVf
c3Jpb3ZfdmYoYWRldikpIHsKPiAtCQlpZiAocHNwX3JlZ19wcm9ncmFtKCZhZGV2LT5wc3AsIFBT
UF9SRUdfSUhfUkJfQ05UTCwgaWhfcmJfY250bCkpIHsKPiAtCQkJRFJNX0VSUk9SKCJQU1AgcHJv
Z3JhbSBJSF9SQl9DTlRMIGZhaWxlZCFcbiIpOwo+IC0JCQlyZXR1cm47Cj4gLQkJfQo+IC0JfSBl
bHNlIHsKPiAtCQlXUkVHMzJfU09DMTUoT1NTU1lTLCAwLCBtbUlIX1JCX0NOVEwsIGloX3JiX2Nu
dGwpOwo+IC0JfQo+IC0KPiArCVdSRUczMl9TT0MxNShPU1NTWVMsIDAsIG1tSUhfUkJfQ05UTCwg
aWhfcmJfY250bCk7Cj4gIAkvKiBzZXQgcnB0ciwgd3B0ciB0byAwICovCj4gIAlXUkVHMzJfU09D
MTUoT1NTU1lTLCAwLCBtbUlIX1JCX1JQVFIsIDApOwo+ICAJV1JFRzMyX1NPQzE1KE9TU1NZUywg
MCwgbW1JSF9SQl9XUFRSLCAwKTsKPiBAQCAtMTI1LDE1ICs5Myw3IEBAIHN0YXRpYyB2b2lkIG5h
dmkxMF9paF9kaXNhYmxlX2ludGVycnVwdHMoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4g
IAkJaWhfcmJfY250bCA9IFJSRUczMl9TT0MxNShPU1NTWVMsIDAsIG1tSUhfUkJfQ05UTF9SSU5H
MSk7Cj4gIAkJaWhfcmJfY250bCA9IFJFR19TRVRfRklFTEQoaWhfcmJfY250bCwgSUhfUkJfQ05U
TF9SSU5HMSwKPiAgCQkJCQkgICBSQl9FTkFCTEUsIDApOwo+IC0JCWlmIChhbWRncHVfc3Jpb3Zf
dmYoYWRldikpIHsKPiAtCQkJaWYgKHBzcF9yZWdfcHJvZ3JhbSgmYWRldi0+cHNwLCBQU1BfUkVH
X0lIX1JCX0NOVExfUklORzEsCj4gLQkJCQkJCWloX3JiX2NudGwpKSB7Cj4gLQkJCQlEUk1fRVJS
T1IoInByb2dyYW0gSUhfUkJfQ05UTF9SSU5HMSBmYWlsZWQhXG4iKTsKPiAtCQkJCXJldHVybjsK
PiAtCQkJfQo+IC0JCX0gZWxzZSB7Cj4gLQkJCVdSRUczMl9TT0MxNShPU1NTWVMsIDAsIG1tSUhf
UkJfQ05UTF9SSU5HMSwgaWhfcmJfY250bCk7Cj4gLQkJfQo+ICsJCVdSRUczMl9TT0MxNShPU1NT
WVMsIDAsIG1tSUhfUkJfQ05UTF9SSU5HMSwgaWhfcmJfY250bCk7Cj4gIAkJLyogc2V0IHJwdHIs
IHdwdHIgdG8gMCAqLwo+ICAJCVdSRUczMl9TT0MxNShPU1NTWVMsIDAsIG1tSUhfUkJfUlBUUl9S
SU5HMSwgMCk7Cj4gIAkJV1JFRzMyX1NPQzE1KE9TU1NZUywgMCwgbW1JSF9SQl9XUFRSX1JJTkcx
LCAwKTsKPiBAQCAtMTQ1LDE1ICsxMDUsNyBAQCBzdGF0aWMgdm9pZCBuYXZpMTBfaWhfZGlzYWJs
ZV9pbnRlcnJ1cHRzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQo+ICAJCWloX3JiX2NudGwg
PSBSUkVHMzJfU09DMTUoT1NTU1lTLCAwLCBtbUlIX1JCX0NOVExfUklORzIpOwo+ICAJCWloX3Ji
X2NudGwgPSBSRUdfU0VUX0ZJRUxEKGloX3JiX2NudGwsIElIX1JCX0NOVExfUklORzIsCj4gIAkJ
CQkJICAgUkJfRU5BQkxFLCAwKTsKPiAtCQlpZiAoYW1kZ3B1X3NyaW92X3ZmKGFkZXYpKSB7Cj4g
LQkJCWlmIChwc3BfcmVnX3Byb2dyYW0oJmFkZXYtPnBzcCwgUFNQX1JFR19JSF9SQl9DTlRMX1JJ
TkcyLAo+IC0JCQkJCQlpaF9yYl9jbnRsKSkgewo+IC0JCQkJRFJNX0VSUk9SKCJwcm9ncmFtIElI
X1JCX0NOVExfUklORzIgZmFpbGVkIVxuIik7Cj4gLQkJCQlyZXR1cm47Cj4gLQkJCX0KPiAtCQl9
IGVsc2Ugewo+IC0JCQlXUkVHMzJfU09DMTUoT1NTU1lTLCAwLCBtbUlIX1JCX0NOVExfUklORzIs
IGloX3JiX2NudGwpOwo+IC0JCX0KPiArCQlXUkVHMzJfU09DMTUoT1NTU1lTLCAwLCBtbUlIX1JC
X0NOVExfUklORzIsIGloX3JiX2NudGwpOwo+ICAJCS8qIHNldCBycHRyLCB3cHRyIHRvIDAgKi8K
PiAgCQlXUkVHMzJfU09DMTUoT1NTU1lTLCAwLCBtbUlIX1JCX1JQVFJfUklORzIsIDApOwo+ICAJ
CVdSRUczMl9TT0MxNShPU1NTWVMsIDAsIG1tSUhfUkJfV1BUUl9SSU5HMiwgMCk7Cj4gQEAgLTI1
MywxNCArMjA1LDcgQEAgc3RhdGljIGludCBuYXZpMTBfaWhfaXJxX2luaXQoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYpCj4gIAlpaF9yYl9jbnRsID0gbmF2aTEwX2loX3JiX2NudGwoaWgsIGlo
X3JiX2NudGwpOwo+ICAJaWhfcmJfY250bCA9IFJFR19TRVRfRklFTEQoaWhfcmJfY250bCwgSUhf
UkJfQ05UTCwgUlBUUl9SRUFSTSwKPiAgCQkJCSAgICEhYWRldi0+aXJxLm1zaV9lbmFibGVkKTsK
PiAtCWlmIChhbWRncHVfc3Jpb3ZfdmYoYWRldikpIHsKPiAtCQlpZiAocHNwX3JlZ19wcm9ncmFt
KCZhZGV2LT5wc3AsIFBTUF9SRUdfSUhfUkJfQ05UTCwgaWhfcmJfY250bCkpIHsKPiAtCQkJRFJN
X0VSUk9SKCJQU1AgcHJvZ3JhbSBJSF9SQl9DTlRMIGZhaWxlZCFcbiIpOwo+IC0JCQlyZXR1cm4g
LUVUSU1FRE9VVDsKPiAtCQl9Cj4gLQl9IGVsc2Ugewo+IC0JCVdSRUczMl9TT0MxNShPU1NTWVMs
IDAsIG1tSUhfUkJfQ05UTCwgaWhfcmJfY250bCk7Cj4gLQl9Cj4gKwlXUkVHMzJfU09DMTUoT1NT
U1lTLCAwLCBtbUlIX1JCX0NOVEwsIGloX3JiX2NudGwpOwo+ICAJbmF2aTEwX2loX3Jlcm91dGVf
aWgoYWRldik7Cj4gIAo+ICAJaWYgKHVubGlrZWx5KGFkZXYtPmZpcm13YXJlLmxvYWRfdHlwZSA9
PSBBTURHUFVfRldfTE9BRF9ESVJFQ1QpKSB7Cj4gQEAgLTMwMCwxNSArMjQ1LDcgQEAgc3RhdGlj
IGludCBuYXZpMTBfaWhfaXJxX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCj4gIAkJ
CQkJICAgV1BUUl9PVkVSRkxPV19FTkFCTEUsIDApOwo+ICAJCWloX3JiX2NudGwgPSBSRUdfU0VU
X0ZJRUxEKGloX3JiX2NudGwsIElIX1JCX0NOVEwsCj4gIAkJCQkJICAgUkJfRlVMTF9EUkFJTl9F
TkFCTEUsIDEpOwo+IC0JCWlmIChhbWRncHVfc3Jpb3ZfdmYoYWRldikpIHsKPiAtCQkJaWYgKHBz
cF9yZWdfcHJvZ3JhbSgmYWRldi0+cHNwLCBQU1BfUkVHX0lIX1JCX0NOVExfUklORzEsCj4gLQkJ
CQkJCWloX3JiX2NudGwpKSB7Cj4gLQkJCQlEUk1fRVJST1IoInByb2dyYW0gSUhfUkJfQ05UTF9S
SU5HMSBmYWlsZWQhXG4iKTsKPiAtCQkJCXJldHVybiAtRVRJTUVET1VUOwo+IC0JCQl9Cj4gLQkJ
fSBlbHNlIHsKPiAtCQkJV1JFRzMyX1NPQzE1KE9TU1NZUywgMCwgbW1JSF9SQl9DTlRMX1JJTkcx
LCBpaF9yYl9jbnRsKTsKPiAtCQl9Cj4gKwkJV1JFRzMyX1NPQzE1KE9TU1NZUywgMCwgbW1JSF9S
Ql9DTlRMX1JJTkcxLCBpaF9yYl9jbnRsKTsKPiAgCQkvKiBzZXQgcnB0ciwgd3B0ciB0byAwICov
Cj4gIAkJV1JFRzMyX1NPQzE1KE9TU1NZUywgMCwgbW1JSF9SQl9XUFRSX1JJTkcxLCAwKTsKPiAg
CQlXUkVHMzJfU09DMTUoT1NTU1lTLCAwLCBtbUlIX1JCX1JQVFJfUklORzEsIDApOwo+IEBAIC0z
MjYsMTUgKzI2Myw3IEBAIHN0YXRpYyBpbnQgbmF2aTEwX2loX2lycV9pbml0KHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2KQo+ICAJCWloX3JiX2NudGwgPSBSUkVHMzJfU09DMTUoT1NTU1lTLCAw
LCBtbUlIX1JCX0NOVExfUklORzIpOwo+ICAJCWloX3JiX2NudGwgPSBuYXZpMTBfaWhfcmJfY250
bChpaCwgaWhfcmJfY250bCk7Cj4gIAo+IC0JCWlmIChhbWRncHVfc3Jpb3ZfdmYoYWRldikpIHsK
PiAtCQkJaWYgKHBzcF9yZWdfcHJvZ3JhbSgmYWRldi0+cHNwLCBQU1BfUkVHX0lIX1JCX0NOVExf
UklORzIsCj4gLQkJCQkJCWloX3JiX2NudGwpKSB7Cj4gLQkJCQlEUk1fRVJST1IoInByb2dyYW0g
SUhfUkJfQ05UTF9SSU5HMiBmYWlsZWQhXG4iKTsKPiAtCQkJCXJldHVybiAtRVRJTUVET1VUOwo+
IC0JCQl9Cj4gLQkJfSBlbHNlIHsKPiAtCQkJV1JFRzMyX1NPQzE1KE9TU1NZUywgMCwgbW1JSF9S
Ql9DTlRMX1JJTkcyLCBpaF9yYl9jbnRsKTsKPiAtCQl9Cj4gKwkJV1JFRzMyX1NPQzE1KE9TU1NZ
UywgMCwgbW1JSF9SQl9DTlRMX1JJTkcyLCBpaF9yYl9jbnRsKTsKPiAgCQkvKiBzZXQgcnB0ciwg
d3B0ciB0byAwICovCj4gIAkJV1JFRzMyX1NPQzE1KE9TU1NZUywgMCwgbW1JSF9SQl9XUFRSX1JJ
TkcyLCAwKTsKPiAgCQlXUkVHMzJfU09DMTUoT1NTU1lTLCAwLCBtbUlIX1JCX1JQVFJfUklORzIs
IDApOwpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQt
Z2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZngK
