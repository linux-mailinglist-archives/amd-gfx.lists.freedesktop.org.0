Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7098324CDF4
	for <lists+amd-gfx@lfdr.de>; Fri, 21 Aug 2020 08:25:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5C9CD6EA93;
	Fri, 21 Aug 2020 06:25:13 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wm1-x341.google.com (mail-wm1-x341.google.com
 [IPv6:2a00:1450:4864:20::341])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 240AE6EA93
 for <amd-gfx@lists.freedesktop.org>; Fri, 21 Aug 2020 06:25:12 +0000 (UTC)
Received: by mail-wm1-x341.google.com with SMTP id f18so615261wmc.0
 for <amd-gfx@lists.freedesktop.org>; Thu, 20 Aug 2020 23:25:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=reply-to:subject:to:references:from:message-id:date:user-agent
 :mime-version:in-reply-to:content-transfer-encoding:content-language;
 bh=LcF5tRtM8JK7H5gbuXX9P+SuwwKj4u9zZHpjm0shAfg=;
 b=ldHl8cAte5lkrOPyAVBTdmUngpOY6pGBtmHTCIeBwgPQs/VNAoZHfJIbjMKHU9Kqc+
 MLdzRSdNWxIE8qiw8tQBdbwd2btxC7GAaIPKAfhxQv8VUCSOlw7BXCHMX4yn2LoYzCVv
 c2X5bEtymfhYYkCLa6khp/1SkbKnErHBRoLjytreYAJCTN7/Uy8RdGiScifknoGotDUa
 /2gwqjqCY9XZsI+iUPaJmHXeO2QRwM/8gVRPyJJo9IxFihCQF5riYipSG9aOptM/ckLu
 w+IWJLYfxJcApeyJT6AAkUYc6kNkjCLkXw02g5Jf+YKdSFzubZN8e/WV1KDposMc9npr
 xdXw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:reply-to:subject:to:references:from:message-id
 :date:user-agent:mime-version:in-reply-to:content-transfer-encoding
 :content-language;
 bh=LcF5tRtM8JK7H5gbuXX9P+SuwwKj4u9zZHpjm0shAfg=;
 b=rbZr2bbwWXnjpc8ITpYFBwF/WC+1BI1X2HJ9n3e8LGYTsFJch1yJXG32fGZnGnX4z2
 sxGyrpaKVhMuMjlt9E/0EqW1hGTGk28SjmYP51O8BN1yAA74cm2LtwOPF3n1BeU680RP
 W7/tXGyPlXz1DbGNwAhNkr46Yl6N2X78HayIPUdsbZ20clvN0UXenUYzHkxmjgFoAq5L
 aGxrh37tHWUv8wE18haUMY0tL//nngq6cP+u07M42Z52zAi5P4BbuRc5ZZLeR4dxyTOx
 Sy2OGezByisxgqXWfdeNF/riUkR0MSD2RUDV2LMmbwHuzThX5fjDMxujj1+FZiw2+VyX
 sbzg==
X-Gm-Message-State: AOAM530m+35ji0lkbIHUYLGrSto6RbUoGGOLuw6H7AxbG/HEYWYot+va
 h6ejBQeifr2911YagM8c8EI=
X-Google-Smtp-Source: ABdhPJyg5lg7r4vAr8slPlz9laH6VHz4bR6NTL0ylO4OfmDa+tDUNUnW2B3sPtoO9i2zw87uG5AnRA==
X-Received: by 2002:a7b:c242:: with SMTP id b2mr1523540wmj.90.1597991110743;
 Thu, 20 Aug 2020 23:25:10 -0700 (PDT)
Received: from ?IPv6:2a02:908:1252:fb60:be8a:bd56:1f94:86e7?
 ([2a02:908:1252:fb60:be8a:bd56:1f94:86e7])
 by smtp.gmail.com with ESMTPSA id v16sm2648338wmj.14.2020.08.20.23.25.09
 (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
 Thu, 20 Aug 2020 23:25:10 -0700 (PDT)
Subject: Re: [PATCH v3] drm/amdgpu: change reset lock from mutex to
 rw_semaphore
To: Dennis Li <Dennis.Li@amd.com>, amd-gfx@lists.freedesktop.org,
 Alexander.Deucher@amd.com, felix.kuehling@amd.com, Hawking.Zhang@amd.com,
 christian.koenig@amd.com, monk.liu@amd.com
References: <20200821034736.27106-1-Dennis.Li@amd.com>
From: =?UTF-8?Q?Christian_K=c3=b6nig?= <ckoenig.leichtzumerken@gmail.com>
Message-ID: <978f4e0c-98b8-d966-4571-b16eb5f893d9@gmail.com>
Date: Fri, 21 Aug 2020 08:25:08 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.10.0
MIME-Version: 1.0
In-Reply-To: <20200821034736.27106-1-Dennis.Li@amd.com>
Content-Language: en-US
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Reply-To: christian.koenig@amd.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QW0gMjEuMDguMjAgdW0gMDU6NDcgc2NocmllYiBEZW5uaXMgTGk6Cj4gY2xpZW50cyBkb24ndCBu
ZWVkIHJlc2V0LWxvY2sgZm9yIHN5bmNocm9uaXphdGlvbiB3aGVuIG5vCj4gR1BVIHJlY292ZXJ5
Lgo+Cj4gdjI6Cj4gY2hhbmdlIHRvIHJldHVybiB0aGUgcmV0dXJuIHZhbHVlIG9mIGRvd25fcmVh
ZF9raWxsYWJsZS4KPgo+IHYzOgo+IGlmIEdQVSByZWNvdmVyeSBiZWdpbiwgVkYgaWdub3JlIEZM
UiBub3RpZmljYXRpb24uCj4KPiBTaWduZWQtb2ZmLWJ5OiBEZW5uaXMgTGkgPERlbm5pcy5MaUBh
bWQuY29tPgoKQWNrZWQtYnk6IENocmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdAYW1k
LmNvbT4KCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaAo+IGluZGV4IGM4YWVjODMy
YjI0NC4uZWMxMWVkMmE5Y2E0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdS5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1LmgK
PiBAQCAtOTU0LDcgKzk1NCw3IEBAIHN0cnVjdCBhbWRncHVfZGV2aWNlIHsKPiAgIAo+ICAgCWF0
b21pY190IAkJCWluX2dwdV9yZXNldDsKPiAgIAllbnVtIHBwX21wMV9zdGF0ZSAgICAgICAgICAg
ICAgIG1wMV9zdGF0ZTsKPiAtCXN0cnVjdCBtdXRleCAgbG9ja19yZXNldDsKPiArCXN0cnVjdCBy
d19zZW1hcGhvcmUgcmVzZXRfc2VtOwo+ICAgCXN0cnVjdCBhbWRncHVfZG9vcmJlbGxfaW5kZXgg
ZG9vcmJlbGxfaW5kZXg7Cj4gICAKPiAgIAlzdHJ1Y3QgbXV0ZXgJCQlub3RpZmllcl9sb2NrOwo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGVidWdmcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RlYnVnZnMuYwo+IGluZGV4IDc5
YjM5NzgwMGNiYy4uY2M1YzdmODFjNTQwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9kZWJ1Z2ZzLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfZGVidWdmcy5jCj4gQEAgLTEwMSwxNCArMTAxLDE4IEBAIHN0YXRpYyBpbnQg
YW1kZ3B1X2RlYnVnZnNfYXV0b2R1bXBfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3Qg
ZmlsZSAqZmlsZSkKPiAgIAo+ICAgCWZpbGUtPnByaXZhdGVfZGF0YSA9IGFkZXY7Cj4gICAKPiAt
CW11dGV4X2xvY2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+ICsJcmV0ID0gZG93bl9yZWFkX2tpbGxh
YmxlKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsJaWYgKHJldCkKPiArCQlyZXR1cm4gcmV0Owo+ICsK
PiAgIAlpZiAoYWRldi0+YXV0b2R1bXAuZHVtcGluZy5kb25lKSB7Cj4gICAJCXJlaW5pdF9jb21w
bGV0aW9uKCZhZGV2LT5hdXRvZHVtcC5kdW1waW5nKTsKPiAgIAkJcmV0ID0gMDsKPiAgIAl9IGVs
c2Ugewo+ICAgCQlyZXQgPSAtRUJVU1k7Cj4gICAJfQo+IC0JbXV0ZXhfdW5sb2NrKCZhZGV2LT5s
b2NrX3Jlc2V0KTsKPiArCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICAgCj4gICAJ
cmV0dXJuIHJldDsKPiAgIH0KPiBAQCAtMTI0Miw3ICsxMjQ2LDkgQEAgc3RhdGljIGludCBhbWRn
cHVfZGVidWdmc190ZXN0X2liKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAgIAl9
Cj4gICAKPiAgIAkvKiBBdm9pZCBhY2NpZGVudGx5IHVucGFya2luZyB0aGUgc2NoZWQgdGhyZWFk
IGR1cmluZyBHUFUgcmVzZXQgKi8KPiAtCW11dGV4X2xvY2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+
ICsJciA9IGRvd25fcmVhZF9raWxsYWJsZSgmYWRldi0+cmVzZXRfc2VtKTsKPiArCWlmIChyKQo+
ICsJCXJldHVybiByOwo+ICAgCj4gICAJLyogaG9sZCBvbiB0aGUgc2NoZWR1bGVyICovCj4gICAJ
Zm9yIChpID0gMDsgaSA8IEFNREdQVV9NQVhfUklOR1M7IGkrKykgewo+IEBAIC0xMjY5LDcgKzEy
NzUsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV9kZWJ1Z2ZzX3Rlc3RfaWIoc3RydWN0IHNlcV9maWxl
ICptLCB2b2lkICpkYXRhKQo+ICAgCQlrdGhyZWFkX3VucGFyayhyaW5nLT5zY2hlZC50aHJlYWQp
Owo+ICAgCX0KPiAgIAo+IC0JbXV0ZXhfdW5sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPiArCXVw
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAKPiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9i
dXN5KGRldi0+ZGV2KTsKPiAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZXYtPmRldik7
Cj4gQEAgLTE0NTksNyArMTQ2NSw5IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RlYnVnZnNfaWJfcHJl
ZW1wdCh2b2lkICpkYXRhLCB1NjQgdmFsKQo+ICAgCQlyZXR1cm4gLUVOT01FTTsKPiAgIAo+ICAg
CS8qIEF2b2lkIGFjY2lkZW50bHkgdW5wYXJraW5nIHRoZSBzY2hlZCB0aHJlYWQgZHVyaW5nIEdQ
VSByZXNldCAqLwo+IC0JbXV0ZXhfbG9jaygmYWRldi0+bG9ja19yZXNldCk7Cj4gKwlyID0gZG93
bl9yZWFkX2tpbGxhYmxlKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsJaWYgKHIpCj4gKwkJZ290byBw
cm9fZW5kOwo+ICAgCj4gICAJLyogc3RvcCB0aGUgc2NoZWR1bGVyICovCj4gICAJa3RocmVhZF9w
YXJrKHJpbmctPnNjaGVkLnRocmVhZCk7Cj4gQEAgLTE1MDAsMTMgKzE1MDgsMTQgQEAgc3RhdGlj
IGludCBhbWRncHVfZGVidWdmc19pYl9wcmVlbXB0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCj4gICAJ
LyogcmVzdGFydCB0aGUgc2NoZWR1bGVyICovCj4gICAJa3RocmVhZF91bnBhcmsocmluZy0+c2No
ZWQudGhyZWFkKTsKPiAgIAo+IC0JbXV0ZXhfdW5sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPiAr
CXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAKPiAgIAl0dG1fYm9fdW5sb2NrX2RlbGF5
ZWRfd29ya3F1ZXVlKCZhZGV2LT5tbWFuLmJkZXYsIHJlc2NoZWQpOwo+ICAgCj4gK3Byb19lbmQ6
Cj4gICAJa2ZyZWUoZmVuY2VzKTsKPiAgIAo+IC0JcmV0dXJuIDA7Cj4gKwlyZXR1cm4gcjsKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIGludCBhbWRncHVfZGVidWdmc19zY2xrX3NldCh2b2lkICpkYXRh
LCB1NjQgdmFsKQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfZGV2aWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMK
PiBpbmRleCA3OGZkMmM5YTdiN2QuLjgyMjQyZTJmNTY1OCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMKPiBAQCAtMzA1NCw3ICszMDU0LDcgQEAgaW50
IGFtZGdwdV9kZXZpY2VfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgIAltdXRl
eF9pbml0KCZhZGV2LT52aXJ0LnZmX2Vycm9ycy5sb2NrKTsKPiAgIAloYXNoX2luaXQoYWRldi0+
bW5faGFzaCk7Cj4gICAJYXRvbWljX3NldCgmYWRldi0+aW5fZ3B1X3Jlc2V0LCAwKTsKPiAtCW11
dGV4X2luaXQoJmFkZXYtPmxvY2tfcmVzZXQpOwo+ICsJaW5pdF9yd3NlbSgmYWRldi0+cmVzZXRf
c2VtKTsKPiAgIAltdXRleF9pbml0KCZhZGV2LT5wc3AubXV0ZXgpOwo+ICAgCW11dGV4X2luaXQo
JmFkZXYtPm5vdGlmaWVyX2xvY2spOwo+ICAgCj4gQEAgLTQyMDYsNyArNDIwNiw3IEBAIHN0YXRp
YyBib29sIGFtZGdwdV9kZXZpY2VfbG9ja19hZGV2KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
KQo+ICAgCWlmIChhdG9taWNfY21weGNoZygmYWRldi0+aW5fZ3B1X3Jlc2V0LCAwLCAxKSAhPSAw
KQo+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gICAKPiAtCW11dGV4X2xvY2soJmFkZXYtPmxvY2tfcmVz
ZXQpOwo+ICsJZG93bl93cml0ZSgmYWRldi0+cmVzZXRfc2VtKTsKPiAgIAo+ICAgCWF0b21pY19p
bmMoJmFkZXYtPmdwdV9yZXNldF9jb3VudGVyKTsKPiAgIAlzd2l0Y2ggKGFtZGdwdV9hc2ljX3Jl
c2V0X21ldGhvZChhZGV2KSkgewo+IEBAIC00MjI5LDcgKzQyMjksNyBAQCBzdGF0aWMgdm9pZCBh
bWRncHVfZGV2aWNlX3VubG9ja19hZGV2KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQo+ICAg
CWFtZGdwdV92Zl9lcnJvcl90cmFuc19hbGwoYWRldik7Cj4gICAJYWRldi0+bXAxX3N0YXRlID0g
UFBfTVAxX1NUQVRFX05PTkU7Cj4gICAJYXRvbWljX3NldCgmYWRldi0+aW5fZ3B1X3Jlc2V0LCAw
KTsKPiAtCW11dGV4X3VubG9jaygmYWRldi0+bG9ja19yZXNldCk7Cj4gKwl1cF93cml0ZSgmYWRl
di0+cmVzZXRfc2VtKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgYW1kZ3B1X2RldmljZV9y
ZXN1bWVfZGlzcGxheV9hdWRpbyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbXhncHVfYWkuYyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L214Z3B1X2FpLmMKPiBpbmRleCBmMjdkODNmMmRlNzguLjljMDcwMTRk
OWJkNiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9teGdwdV9haS5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbXhncHVfYWkuYwo+IEBAIC0yMzgs
MTkgKzIzOCwxNSBAQCBzdGF0aWMgdm9pZCB4Z3B1X2FpX21haWxib3hfZmxyX3dvcmsoc3RydWN0
IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgCXN0cnVjdCBhbWRncHVfdmlydCAqdmlydCA9IGNvbnRh
aW5lcl9vZih3b3JrLCBzdHJ1Y3QgYW1kZ3B1X3ZpcnQsIGZscl93b3JrKTsKPiAgIAlzdHJ1Y3Qg
YW1kZ3B1X2RldmljZSAqYWRldiA9IGNvbnRhaW5lcl9vZih2aXJ0LCBzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSwgdmlydCk7Cj4gICAJaW50IHRpbWVvdXQgPSBBSV9NQUlMQk9YX1BPTExfRkxSX1RJTUVE
T1VUOwo+IC0JaW50IGxvY2tlZDsKPiAgIAo+ICAgCS8qIGJsb2NrIGFtZGdwdV9ncHVfcmVjb3Zl
ciB0aWxsIG1zZyBGTFIgQ09NUExFVEUgcmVjZWl2ZWQsCj4gICAJICogb3RoZXJ3aXNlIHRoZSBt
YWlsYm94IG1zZyB3aWxsIGJlIHJ1aW5lZC9yZXNldGVkIGJ5Cj4gICAJICogdGhlIFZGIEZMUi4K
PiAtCSAqCj4gLQkgKiB3ZSBjYW4gdW5sb2NrIHRoZSBsb2NrX3Jlc2V0IHRvIGFsbG93ICJhbWRn
cHVfam9iX3RpbWVkb3V0Igo+IC0JICogdG8gcnVuIGdwdV9yZWNvdmVyKCkgYWZ0ZXIgRkxSX05P
VElGSUNBVElPTl9DTVBMIHJlY2VpdmVkCj4gLQkgKiB3aGljaCBtZWFucyBob3N0IHNpZGUgaGFk
IGZpbmlzaGVkIHRoaXMgVkYncyBGTFIuCj4gICAJICovCj4gLQlsb2NrZWQgPSBtdXRleF90cnls
b2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPiAtCWlmIChsb2NrZWQpCj4gLQkJYXRvbWljX3NldCgm
YWRldi0+aW5fZ3B1X3Jlc2V0LCAxKTsKPiArCWlmICghZG93bl9yZWFkX3RyeWxvY2soJmFkZXYt
PnJlc2V0X3NlbSkpCj4gKwkJcmV0dXJuOwo+ICsKPiArCWF0b21pY19zZXQoJmFkZXYtPmluX2dw
dV9yZXNldCwgMSk7Cj4gICAKPiAgIAlkbyB7Cj4gICAJCWlmICh4Z3B1X2FpX21haWxib3hfcGVl
a19tc2coYWRldikgPT0gSURIX0ZMUl9OT1RJRklDQVRJT05fQ01QTCkKPiBAQCAtMjYxLDEwICsy
NTcsOCBAQCBzdGF0aWMgdm9pZCB4Z3B1X2FpX21haWxib3hfZmxyX3dvcmsoc3RydWN0IHdvcmtf
c3RydWN0ICp3b3JrKQo+ICAgCX0gd2hpbGUgKHRpbWVvdXQgPiAxKTsKPiAgIAo+ICAgZmxyX2Rv
bmU6Cj4gLQlpZiAobG9ja2VkKSB7Cj4gLQkJYXRvbWljX3NldCgmYWRldi0+aW5fZ3B1X3Jlc2V0
LCAwKTsKPiAtCQltdXRleF91bmxvY2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+IC0JfQo+ICsJYXRv
bWljX3NldCgmYWRldi0+aW5fZ3B1X3Jlc2V0LCAwKTsKPiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0
X3NlbSk7Cj4gICAKPiAgIAkvKiBUcmlnZ2VyIHJlY292ZXJ5IGZvciB3b3JsZCBzd2l0Y2ggZmFp
bHVyZSBpZiBubyBURFIgKi8KPiAgIAlpZiAoYW1kZ3B1X2RldmljZV9zaG91bGRfcmVjb3Zlcl9n
cHUoYWRldikKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbXhncHVf
bnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X252LmMKPiBpbmRleCAzY2Ix
MGFiOTQzYTYuLjljMjNhYmY5YjE0MCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9teGdwdV9udi5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbXhn
cHVfbnYuYwo+IEBAIC0yNTksMTkgKzI1OSwxNSBAQCBzdGF0aWMgdm9pZCB4Z3B1X252X21haWxi
b3hfZmxyX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgCXN0cnVjdCBhbWRncHVf
dmlydCAqdmlydCA9IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgYW1kZ3B1X3ZpcnQsIGZscl93
b3JrKTsKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGNvbnRhaW5lcl9vZih2aXJ0
LCBzdHJ1Y3QgYW1kZ3B1X2RldmljZSwgdmlydCk7Cj4gICAJaW50IHRpbWVvdXQgPSBOVl9NQUlM
Qk9YX1BPTExfRkxSX1RJTUVET1VUOwo+IC0JaW50IGxvY2tlZDsKPiAgIAo+ICAgCS8qIGJsb2Nr
IGFtZGdwdV9ncHVfcmVjb3ZlciB0aWxsIG1zZyBGTFIgQ09NUExFVEUgcmVjZWl2ZWQsCj4gICAJ
ICogb3RoZXJ3aXNlIHRoZSBtYWlsYm94IG1zZyB3aWxsIGJlIHJ1aW5lZC9yZXNldGVkIGJ5Cj4g
ICAJICogdGhlIFZGIEZMUi4KPiAtCSAqCj4gLQkgKiB3ZSBjYW4gdW5sb2NrIHRoZSBsb2NrX3Jl
c2V0IHRvIGFsbG93ICJhbWRncHVfam9iX3RpbWVkb3V0Igo+IC0JICogdG8gcnVuIGdwdV9yZWNv
dmVyKCkgYWZ0ZXIgRkxSX05PVElGSUNBVElPTl9DTVBMIHJlY2VpdmVkCj4gLQkgKiB3aGljaCBt
ZWFucyBob3N0IHNpZGUgaGFkIGZpbmlzaGVkIHRoaXMgVkYncyBGTFIuCj4gICAJICovCj4gLQls
b2NrZWQgPSBtdXRleF90cnlsb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPiAtCWlmIChsb2NrZWQp
Cj4gLQkJYXRvbWljX3NldCgmYWRldi0+aW5fZ3B1X3Jlc2V0LCAxKTsKPiArCWlmICghZG93bl9y
ZWFkX3RyeWxvY2soJmFkZXYtPnJlc2V0X3NlbSkpCj4gKwkJcmV0dXJuOwo+ICsKPiArCWF0b21p
Y19zZXQoJmFkZXYtPmluX2dwdV9yZXNldCwgMSk7Cj4gICAKPiAgIAlkbyB7Cj4gICAJCWlmICh4
Z3B1X252X21haWxib3hfcGVla19tc2coYWRldikgPT0gSURIX0ZMUl9OT1RJRklDQVRJT05fQ01Q
TCkKPiBAQCAtMjgyLDEwICsyNzgsOCBAQCBzdGF0aWMgdm9pZCB4Z3B1X252X21haWxib3hfZmxy
X3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgCX0gd2hpbGUgKHRpbWVvdXQgPiAx
KTsKPiAgIAo+ICAgZmxyX2RvbmU6Cj4gLQlpZiAobG9ja2VkKSB7Cj4gLQkJYXRvbWljX3NldCgm
YWRldi0+aW5fZ3B1X3Jlc2V0LCAwKTsKPiAtCQltdXRleF91bmxvY2soJmFkZXYtPmxvY2tfcmVz
ZXQpOwo+IC0JfQo+ICsJYXRvbWljX3NldCgmYWRldi0+aW5fZ3B1X3Jlc2V0LCAwKTsKPiArCXVw
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAKPiAgIAkvKiBUcmlnZ2VyIHJlY292ZXJ5IGZv
ciB3b3JsZCBzd2l0Y2ggZmFpbHVyZSBpZiBubyBURFIgKi8KPiAgIAlpZiAoYW1kZ3B1X2Rldmlj
ZV9zaG91bGRfcmVjb3Zlcl9ncHUoYWRldikKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vYW1kLWdmeAo=
