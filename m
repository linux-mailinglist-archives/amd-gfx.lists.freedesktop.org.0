Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6791A69D96
	for <lists+amd-gfx@lfdr.de>; Mon, 15 Jul 2019 23:21:16 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E577089BA3;
	Mon, 15 Jul 2019 21:21:14 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM01-SN1-obe.outbound.protection.outlook.com
 (mail-eopbgr820077.outbound.protection.outlook.com [40.107.82.77])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 738AA89B96
 for <amd-gfx@lists.freedesktop.org>; Mon, 15 Jul 2019 21:21:10 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=TVt3xPV/i2S/q1xDxExKDYTp2WVElOXH4B7lVo1wPLg/gO+7ViX7TzZCqAWLqZ3dNmYaK0eAALGU3ypehGU9k2zOasbDyk4OzsugdwE/KfcVHXAFjh6Yx78k8JEBqh5ru0/SpUkMHgnyI2Fxr0/7mXFxK1+QxntQc5XdwO5HmvSHYvg0FNcpJdnqz+Hgb6A9H1bpnYquFnJ/+CKXdPeI4M3OA2b9auxRi3CVTdM8WLYQgxkJZWbrd93T/vU8ePR/N/Su4Zfo5grzZAtuhWdYqwZIa6mHCzbirKYEEFUm2JmOIS+vKeyW5TwOMWNCW9+TtnwvrtXh7x34mYe+KUiGlQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=LTz2q+hZi2DMuRXb+hVlNpBAyy2HiUM4vp6ra92mdho=;
 b=X6+hdV3nsE3NuZ4BeeQ74JKXFraiF7ftsANeASgqsfCav7ImjjazT4F1LQngUQP2LimiDVVleCroJsDDzPXUjoAoiz912j1pPS5z+VfQeJDrxE5BHVyEnRNOtAiLJwx8r6fR72aTfiqeG0KqhOAUXsRwMDSw7Z9efjFUFzJGER+e2dLRHf5fPugJ6EUuvfQ3oQjgsBO2jSvHT6/rskFbhatIdXk9Nb3juSI7qT4gxRitRZB/LKef1tSe3R+F9gqp2pucffvJxfKtGI5c8M1YsbiegjafUSnAEI6w4aJ1AhC+dPJITVKoBBLVNevdniZZu6VE0WlY7nw1X9cyi9fjyQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1;spf=none (sender ip is
 165.204.84.17) smtp.rcpttodomain=lists.freedesktop.org
 smtp.mailfrom=amd.com;dmarc=permerror action=none
 header.from=amd.com;dkim=none (message not signed);arc=none
Received: from MWHPR12CA0041.namprd12.prod.outlook.com (2603:10b6:301:2::27)
 by MN2PR12MB3103.namprd12.prod.outlook.com (2603:10b6:208:c5::32) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2073.14; Mon, 15 Jul
 2019 21:21:08 +0000
Received: from CO1NAM03FT009.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e48::209) by MWHPR12CA0041.outlook.office365.com
 (2603:10b6:301:2::27) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.2073.14 via Frontend
 Transport; Mon, 15 Jul 2019 21:21:07 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV01.amd.com (165.204.84.17) by
 CO1NAM03FT009.mail.protection.outlook.com (10.152.80.67) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.2052.18 via Frontend Transport; Mon, 15 Jul 2019 21:21:07 +0000
Received: from localhost.localdomain (10.180.168.240) by SATLEXCHOV01.amd.com
 (10.181.40.71) with Microsoft SMTP Server id 14.3.389.1;
 Mon, 15 Jul 2019 16:21:03 -0500
From: <sunpeng.li@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 02/87] drm/amd/display: Add ability to set preferred link
 training parameters.
Date: Mon, 15 Jul 2019 17:19:24 -0400
Message-ID: <20190715212049.4584-3-sunpeng.li@amd.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190715212049.4584-1-sunpeng.li@amd.com>
References: <20190715212049.4584-1-sunpeng.li@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(376002)(396003)(346002)(136003)(39860400002)(2980300002)(428003)(199004)(189003)(5660300002)(2870700001)(47776003)(4326008)(14444005)(6916009)(53936002)(76176011)(2876002)(336012)(446003)(51416003)(186003)(26005)(476003)(11346002)(2616005)(53946003)(2351001)(426003)(486006)(2906002)(305945005)(30864003)(36756003)(86362001)(81166006)(81156014)(48376002)(126002)(50226002)(478600001)(49486002)(50466002)(54906003)(8676002)(316002)(8936002)(1076003)(70206006)(70586007)(68736007)(6666004)(356004);
 DIR:OUT; SFP:1101; SCL:1; SRVR:MN2PR12MB3103; H:SATLEXCHOV01.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; A:1; MX:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 640b87f4-1757-4352-2485-08d7096a5a0f
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328);
 SRVR:MN2PR12MB3103; 
X-MS-TrafficTypeDiagnostic: MN2PR12MB3103:
X-Microsoft-Antispam-PRVS: <MN2PR12MB31038C5DC1A877E869154A8A82CF0@MN2PR12MB3103.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:1751;
X-Forefront-PRVS: 00997889E7
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: VompkMwuGYMoght9I1aMvvLWwx3mVKmpTKP8Vb5hDnRhXy/dt10GnU8bsLTWDeE6SeU5RDSYpUIMMSFfBipsytJXPOj+jHebTheOAVXGxWnPHkCSVu3OhIVwXBC6EmB0tt9M4jywjPV9QaeYzPX2/fOORr64zmKpCV4UIuzjuRk5G+exzk4cPlcceF+i1fkbW3C/NsS8Wk15Al7DadKkcE8RY1uLrXkJ+CZXmoqZpyQsBibTiTZRDqb34yHxUMjE5Uf8eBt+9kmRqghoSo0Artwj9TZ/bEe/mAwKGl3U9ti2YqAY3GhpteBCjM+ZKCKH0hvPuwvHYQHjy7hKyJ+tU96tnGpiBqL2OExM/Wg2pmyx3FzlcXL3H2LrdXryAYYCjcd/kUEaVNivB/Brb2KztTZoulMEaROYU+SUrndU5a4=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 15 Jul 2019 21:21:07.6448 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 640b87f4-1757-4352-2485-08d7096a5a0f
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV01.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR12MB3103
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=LTz2q+hZi2DMuRXb+hVlNpBAyy2HiUM4vp6ra92mdho=;
 b=bI4f9Qaqhh/NXQd+u46D3CT+4GQppFx1uxj8yURGiRy3rwrVK/FspFy/O+hvrsTvTvlDA3iJNB4nJob6R1jFbsjB6hmAnb1nk9L379UuDU2GA23uhvpcHguAdgQ4TswORNwFTy+UgDOWZWwioDIXpPxUBpl/xgY+aR/ZL86hxX4=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Leo Li <sunpeng.li@amd.com>, Tony Cheng <Tony.Cheng@amd.com>,
 David Galiffi <David.Galiffi@amd.com>, Anthony Koo <Anthony.Koo@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogRGF2aWQgR2FsaWZmaSA8RGF2aWQuR2FsaWZmaUBhbWQuY29tPgoKW1dIWV0KVG8gYWRk
IHN1cHBvcnQgZm9yIE9TIHJlcXVpcmVtZW50IHRvIHNldCBwcmVmZXJyZWQgbGluayB0cmFpbmlu
ZwpwYXJhbWV0ZXJzLgoKW0hPV10KQ3JlYXRlIG5ldyBzdHJ1Y3R1cmUgb2YgZHAgbGluayB0cmFp
bmluZyBvdmVycmlkZXMuIER1cmluZyBsaW5rIHRyYWluaW5nCnByb2Nlc3NlcywgdGhlc2UgdmFs
dWVzIHNob3VsZCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIGRlZmF1bHQgdHJhaW5pbmcKcGFyYW1l
dGVycy4KClNpZ25lZC1vZmYtYnk6IERhdmlkIEdhbGlmZmkgPERhdmlkLkdhbGlmZmlAYW1kLmNv
bT4KUmV2aWV3ZWQtYnk6IFRvbnkgQ2hlbmcgPFRvbnkuQ2hlbmdAYW1kLmNvbT4KQWNrZWQtYnk6
IEFudGhvbnkgS29vIDxBbnRob255Lktvb0BhbWQuY29tPgpBY2tlZC1ieTogTGVvIExpIDxzdW5w
ZW5nLmxpQGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2NvcmUv
ZGNfbGluay5jIHwgIDQ2ICsrLQogLi4uL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kY19s
aW5rX2RwLmMgIHwgMzM3ICsrKysrKysrKysrKystLS0tLQogLi4uL2RybS9hbWQvZGlzcGxheS9k
Yy9jb3JlL2RjX2xpbmtfaHdzcy5jICAgIHwgIDI4ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvZGNfZHBfdHlwZXMuaCAgfCAgMjEgKysKIGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9kYy9kY19saW5rLmggICAgICB8ICAxMSArCiAuLi4vZ3B1L2RybS9hbWQvZGlzcGxheS9k
Yy9pbmMvbGlua19od3NzLmggICAgfCAgIDIgKy0KIC4uLi9hbWQvZGlzcGxheS9pbmNsdWRlL2xp
bmtfc2VydmljZV90eXBlcy5oICB8ICAxNyArLQogNyBmaWxlcyBjaGFuZ2VkLCAzMzggaW5zZXJ0
aW9ucygrKSwgMTI0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9jb3JlL2RjX2xpbmsuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9jb3JlL2RjX2xpbmsuYwppbmRleCA2MTY3ZTFjYjBiNDguLjA5MThjMzM0ZjBlMiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2NvcmUvZGNfbGluay5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9jb3JlL2RjX2xpbmsuYwpAQCAtMTE4
Nyw2ICsxMTg3LDkgQEAgc3RhdGljIGJvb2wgY29uc3RydWN0KAogCWxpbmstPmN0eCA9IGRjX2N0
eDsKIAlsaW5rLT5saW5rX2luZGV4ID0gaW5pdF9wYXJhbXMtPmxpbmtfaW5kZXg7CiAKKwltZW1z
ZXQoJmxpbmstPnByZWZlcnJlZF90cmFpbmluZ19zZXR0aW5ncywgMCwgc2l6ZW9mKHN0cnVjdCBk
Y19saW5rX3RyYWluaW5nX292ZXJyaWRlcykpOworCW1lbXNldCgmbGluay0+cHJlZmVycmVkX2xp
bmtfc2V0dGluZywgMCwgc2l6ZW9mKHN0cnVjdCBkY19saW5rX3NldHRpbmdzKSk7CisKIAlsaW5r
LT5saW5rX2lkID0gYmlvcy0+ZnVuY3MtPmdldF9jb25uZWN0b3JfaWQoYmlvcywgaW5pdF9wYXJh
bXMtPmNvbm5lY3Rvcl9pbmRleCk7CiAKIAlpZiAobGluay0+bGlua19pZC50eXBlICE9IE9CSkVD
VF9UWVBFX0NPTk5FQ1RPUikgewpAQCAtMTQ2NSw2ICsxNDY4LDkgQEAgc3RhdGljIGVudW0gZGNf
c3RhdHVzIGVuYWJsZV9saW5rX2RwKAogCXN0cnVjdCBkY19saW5rICpsaW5rID0gc3RyZWFtLT5s
aW5rOwogCXN0cnVjdCBkY19saW5rX3NldHRpbmdzIGxpbmtfc2V0dGluZ3MgPSB7MH07CiAJZW51
bSBkcF9wYW5lbF9tb2RlIHBhbmVsX21vZGU7CisjaWZkZWYgQ09ORklHX0RSTV9BTURfRENfRFND
X1NVUFBPUlQKKwlib29sIGZlY19lbmFibGU7CisjZW5kaWYKIAogCS8qIGdldCBsaW5rIHNldHRp
bmdzIGZvciB2aWRlbyBtb2RlIHRpbWluZyAqLwogCWRlY2lkZV9saW5rX3NldHRpbmdzKHN0cmVh
bSwgJmxpbmtfc2V0dGluZ3MpOwpAQCAtMTUwOSwxMCArMTUxNSwyMCBAQCBzdGF0aWMgZW51bSBk
Y19zdGF0dXMgZW5hYmxlX2xpbmtfZHAoCiAJCQlza2lwX3ZpZGVvX3BhdHRlcm4gPSBmYWxzZTsK
IAogI2lmZGVmIENPTkZJR19EUk1fQU1EX0RDX0RTQ19TVVBQT1JUCi0JZHBfc2V0X2ZlY19yZWFk
eShsaW5rLCB0cnVlKTsKKwlpZiAobGluay0+cHJlZmVycmVkX3RyYWluaW5nX3NldHRpbmdzLmZl
Y19lbmFibGUgIT0gTlVMTCkKKwkJZmVjX2VuYWJsZSA9ICpsaW5rLT5wcmVmZXJyZWRfdHJhaW5p
bmdfc2V0dGluZ3MuZmVjX2VuYWJsZTsKKwllbHNlCisJCWZlY19lbmFibGUgPSB0cnVlOworCisJ
ZHBfc2V0X2ZlY19yZWFkeShsaW5rLCBmZWNfZW5hYmxlKTsKICNlbmRpZgogCi0JaWYgKHBlcmZv
cm1fbGlua190cmFpbmluZ193aXRoX3JldHJpZXMoCisJaWYgKGxpbmstPmF1eF9hY2Nlc3NfZGlz
YWJsZWQpIHsKKwkJZGNfbGlua19kcF9wZXJmb3JtX2xpbmtfdHJhaW5pbmdfc2tpcF9hdXgobGlu
aywgJmxpbmtfc2V0dGluZ3MpOworCisJCWxpbmstPmN1cl9saW5rX3NldHRpbmdzID0gbGlua19z
ZXR0aW5nczsKKwkJc3RhdHVzID0gRENfT0s7CisJfSBlbHNlIGlmIChwZXJmb3JtX2xpbmtfdHJh
aW5pbmdfd2l0aF9yZXRyaWVzKAogCQkJbGluaywKIAkJCSZsaW5rX3NldHRpbmdzLAogCQkJc2tp
cF92aWRlb19wYXR0ZXJuLApAQCAtMTUyNCw3ICsxNTQwLDcgQEAgc3RhdGljIGVudW0gZGNfc3Rh
dHVzIGVuYWJsZV9saW5rX2RwKAogCQlzdGF0dXMgPSBEQ19GQUlMX0RQX0xJTktfVFJBSU5JTkc7
CiAKICNpZmRlZiBDT05GSUdfRFJNX0FNRF9EQ19EU0NfU1VQUE9SVAotCWRwX3NldF9mZWNfZW5h
YmxlKGxpbmssIHRydWUpOworCWRwX3NldF9mZWNfZW5hYmxlKGxpbmssIGZlY19lbmFibGUpOwog
I2VuZGlmCiAJcmV0dXJuIHN0YXR1czsKIH0KQEAgLTMwMTIsNiArMzAyOCwyOSBAQCB2b2lkIGRj
X2xpbmtfc2V0X3ByZWZlcnJlZF9saW5rX3NldHRpbmdzKHN0cnVjdCBkYyAqZGMsCiAJCWRwX3Jl
dHJhaW5fbGlua19kcF90ZXN0KGxpbmssICZzdG9yZV9zZXR0aW5ncywgZmFsc2UpOwogfQogCit2
b2lkIGRjX2xpbmtfc2V0X3ByZWZlcnJlZF90cmFpbmluZ19zZXR0aW5ncyhzdHJ1Y3QgZGMgKmRj
LAorCQkJCQkJIHN0cnVjdCBkY19saW5rX3NldHRpbmdzICpsaW5rX3NldHRpbmcsCisJCQkJCQkg
c3RydWN0IGRjX2xpbmtfdHJhaW5pbmdfb3ZlcnJpZGVzICpsdF9vdmVycmlkZXMsCisJCQkJCQkg
c3RydWN0IGRjX2xpbmsgKmxpbmssCisJCQkJCQkgYm9vbCBza2lwX2ltbWVkaWF0ZV9yZXRyYWlu
KQoreworCWlmIChsdF9vdmVycmlkZXMgIT0gTlVMTCkKKwkJbGluay0+cHJlZmVycmVkX3RyYWlu
aW5nX3NldHRpbmdzID0gKmx0X292ZXJyaWRlczsKKwllbHNlCisJCW1lbXNldCgmbGluay0+cHJl
ZmVycmVkX3RyYWluaW5nX3NldHRpbmdzLCAwLCBzaXplb2YobGluay0+cHJlZmVycmVkX3RyYWlu
aW5nX3NldHRpbmdzKSk7CisKKwlpZiAobGlua19zZXR0aW5nICE9IE5VTEwpIHsKKwkJbGluay0+
cHJlZmVycmVkX2xpbmtfc2V0dGluZyA9ICpsaW5rX3NldHRpbmc7CisJfSBlbHNlIHsKKwkJbGlu
ay0+cHJlZmVycmVkX2xpbmtfc2V0dGluZy5sYW5lX2NvdW50ID0gTEFORV9DT1VOVF9VTktOT1dO
OworCQlsaW5rLT5wcmVmZXJyZWRfbGlua19zZXR0aW5nLmxpbmtfcmF0ZSA9IExJTktfUkFURV9V
TktOT1dOOworCX0KKworCS8qIFJldHJhaW4gbm93LCBvciB3YWl0IHVudGlsIG5leHQgc3RyZWFt
IHVwZGF0ZSB0byBhcHBseSAqLworCWlmIChza2lwX2ltbWVkaWF0ZV9yZXRyYWluID09IGZhbHNl
KQorCQlkY19saW5rX3NldF9wcmVmZXJyZWRfbGlua19zZXR0aW5ncyhkYywgJmxpbmstPnByZWZl
cnJlZF9saW5rX3NldHRpbmcsIGxpbmspOworfQorCiB2b2lkIGRjX2xpbmtfZW5hYmxlX2hwZChj
b25zdCBzdHJ1Y3QgZGNfbGluayAqbGluaykKIHsKIAlkY19saW5rX2RwX2VuYWJsZV9ocGQobGlu
ayk7CkBAIC0zMDIyLDcgKzMwNjEsNiBAQCB2b2lkIGRjX2xpbmtfZGlzYWJsZV9ocGQoY29uc3Qg
c3RydWN0IGRjX2xpbmsgKmxpbmspCiAJZGNfbGlua19kcF9kaXNhYmxlX2hwZChsaW5rKTsKIH0K
IAotCiB2b2lkIGRjX2xpbmtfc2V0X3Rlc3RfcGF0dGVybihzdHJ1Y3QgZGNfbGluayAqbGluaywK
IAkJCSAgICAgIGVudW0gZHBfdGVzdF9wYXR0ZXJuIHRlc3RfcGF0dGVybiwKIAkJCSAgICAgIGNv
bnN0IHN0cnVjdCBsaW5rX3RyYWluaW5nX3NldHRpbmdzICpwX2xpbmtfc2V0dGluZ3MsCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kY19saW5rX2RwLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY29yZS9kY19saW5rX2RwLmMKaW5kZXgg
MDU2YmU0YzM0YTk4Li4zZjhhOGY2MWNkNzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9jb3JlL2RjX2xpbmtfZHAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvY29yZS9kY19saW5rX2RwLmMKQEAgLTQ5LDcgKzQ5LDcgQEAgc3RhdGljIHN0
cnVjdCBkY19saW5rX3NldHRpbmdzIGdldF9jb21tb25fc3VwcG9ydGVkX2xpbmtfc2V0dGluZ3Mo
CiAJCXN0cnVjdCBkY19saW5rX3NldHRpbmdzIGxpbmtfc2V0dGluZ19hLAogCQlzdHJ1Y3QgZGNf
bGlua19zZXR0aW5ncyBsaW5rX3NldHRpbmdfYik7CiAKLXN0YXRpYyB2b2lkIHdhaXRfZm9yX3Ry
YWluaW5nX2F1eF9yZF9pbnRlcnZhbCgKK3N0YXRpYyB1aW50MzJfdCBnZXRfdHJhaW5pbmdfYXV4
X3JkX2ludGVydmFsKAogCXN0cnVjdCBkY19saW5rICpsaW5rLAogCXVpbnQzMl90IGRlZmF1bHRf
d2FpdF9pbl9taWNyb19zZWNzKQogewpAQCAtNjgsMTUgKzY4LDIxIEBAIHN0YXRpYyB2b2lkIHdh
aXRfZm9yX3RyYWluaW5nX2F1eF9yZF9pbnRlcnZhbCgKIAkJCXNpemVvZih0cmFpbmluZ19yZF9p
bnRlcnZhbCkpOwogCiAJCWlmICh0cmFpbmluZ19yZF9pbnRlcnZhbC5iaXRzLlRSQUlOSUdfQVVY
X1JEX0lOVEVSVkFMKQotCQkJZGVmYXVsdF93YWl0X2luX21pY3JvX3NlY3MgPQotCQkJCXRyYWlu
aW5nX3JkX2ludGVydmFsLmJpdHMuVFJBSU5JR19BVVhfUkRfSU5URVJWQUwgKiA0MDAwOworCQkJ
ZGVmYXVsdF93YWl0X2luX21pY3JvX3NlY3MgPSB0cmFpbmluZ19yZF9pbnRlcnZhbC5iaXRzLlRS
QUlOSUdfQVVYX1JEX0lOVEVSVkFMICogNDAwMDsKIAl9CiAKLQl1ZGVsYXkoZGVmYXVsdF93YWl0
X2luX21pY3JvX3NlY3MpOworCXJldHVybiBkZWZhdWx0X3dhaXRfaW5fbWljcm9fc2VjczsKK30K
Kworc3RhdGljIHZvaWQgd2FpdF9mb3JfdHJhaW5pbmdfYXV4X3JkX2ludGVydmFsKAorCXN0cnVj
dCBkY19saW5rICpsaW5rLAorCXVpbnQzMl90IHdhaXRfaW5fbWljcm9fc2VjcykKK3sKKwl1ZGVs
YXkod2FpdF9pbl9taWNyb19zZWNzKTsKIAogCURDX0xPR19IV19MSU5LX1RSQUlOSU5HKCIlczpc
biB3YWl0ID0gJWRcbiIsCiAJCV9fZnVuY19fLAotCQlkZWZhdWx0X3dhaXRfaW5fbWljcm9fc2Vj
cyk7CisJCXdhaXRfaW5fbWljcm9fc2Vjcyk7CiB9CiAKIHN0YXRpYyB2b2lkIGRwY2Rfc2V0X3Ry
YWluaW5nX3BhdHRlcm4oCkBAIC05NSwyNyArMTAxLDI3IEBAIHN0YXRpYyB2b2lkIGRwY2Rfc2V0
X3RyYWluaW5nX3BhdHRlcm4oCiAJCWRwY2RfcGF0dGVybi52MV80LlRSQUlOSU5HX1BBVFRFUk5f
U0VUKTsKIH0KIAotc3RhdGljIGVudW0gaHdfZHBfdHJhaW5pbmdfcGF0dGVybiBnZXRfc3VwcG9y
dGVkX3RwKHN0cnVjdCBkY19saW5rICpsaW5rKQorc3RhdGljIGVudW0gZGNfZHBfdHJhaW5pbmdf
cGF0dGVybiBnZXRfc3VwcG9ydGVkX3RwKHN0cnVjdCBkY19saW5rICpsaW5rKQogewotCWVudW0g
aHdfZHBfdHJhaW5pbmdfcGF0dGVybiBoaWdoZXN0X3RwID0gSFdfRFBfVFJBSU5JTkdfUEFUVEVS
Tl8yOworCWVudW0gZGNfZHBfdHJhaW5pbmdfcGF0dGVybiBoaWdoZXN0X3RwID0gRFBfVFJBSU5J
TkdfUEFUVEVSTl9TRVFVRU5DRV8yOwogCXN0cnVjdCBlbmNvZGVyX2ZlYXR1cmVfc3VwcG9ydCAq
ZmVhdHVyZXMgPSAmbGluay0+bGlua19lbmMtPmZlYXR1cmVzOwogCXN0cnVjdCBkcGNkX2NhcHMg
KmRwY2RfY2FwcyA9ICZsaW5rLT5kcGNkX2NhcHM7CiAKIAlpZiAoZmVhdHVyZXMtPmZsYWdzLmJp
dHMuSVNfVFBTM19DQVBBQkxFKQotCQloaWdoZXN0X3RwID0gSFdfRFBfVFJBSU5JTkdfUEFUVEVS
Tl8zOworCQloaWdoZXN0X3RwID0gRFBfVFJBSU5JTkdfUEFUVEVSTl9TRVFVRU5DRV8zOwogCiAJ
aWYgKGZlYXR1cmVzLT5mbGFncy5iaXRzLklTX1RQUzRfQ0FQQUJMRSkKLQkJaGlnaGVzdF90cCA9
IEhXX0RQX1RSQUlOSU5HX1BBVFRFUk5fNDsKKwkJaGlnaGVzdF90cCA9IERQX1RSQUlOSU5HX1BB
VFRFUk5fU0VRVUVOQ0VfNDsKIAogCWlmIChkcGNkX2NhcHMtPm1heF9kb3duX3NwcmVhZC5iaXRz
LlRQUzRfU1VQUE9SVEVEICYmCi0JCWhpZ2hlc3RfdHAgPj0gSFdfRFBfVFJBSU5JTkdfUEFUVEVS
Tl80KQotCQlyZXR1cm4gSFdfRFBfVFJBSU5JTkdfUEFUVEVSTl80OworCQloaWdoZXN0X3RwID49
IERQX1RSQUlOSU5HX1BBVFRFUk5fU0VRVUVOQ0VfNCkKKwkJcmV0dXJuIERQX1RSQUlOSU5HX1BB
VFRFUk5fU0VRVUVOQ0VfNDsKIAogCWlmIChkcGNkX2NhcHMtPm1heF9sbl9jb3VudC5iaXRzLlRQ
UzNfU1VQUE9SVEVEICYmCi0JCWhpZ2hlc3RfdHAgPj0gSFdfRFBfVFJBSU5JTkdfUEFUVEVSTl8z
KQotCQlyZXR1cm4gSFdfRFBfVFJBSU5JTkdfUEFUVEVSTl8zOworCQloaWdoZXN0X3RwID49IERQ
X1RSQUlOSU5HX1BBVFRFUk5fU0VRVUVOQ0VfMykKKwkJcmV0dXJuIERQX1RSQUlOSU5HX1BBVFRF
Uk5fU0VRVUVOQ0VfMzsKIAotCXJldHVybiBIV19EUF9UUkFJTklOR19QQVRURVJOXzI7CisJcmV0
dXJuIERQX1RSQUlOSU5HX1BBVFRFUk5fU0VRVUVOQ0VfMjsKIH0KIAogc3RhdGljIHZvaWQgZHBj
ZF9zZXRfbGlua19zZXR0aW5ncygKQEAgLTEyNiw3ICsxMzIsNyBAQCBzdGF0aWMgdm9pZCBkcGNk
X3NldF9saW5rX3NldHRpbmdzKAogCiAJdW5pb24gZG93bl9zcHJlYWRfY3RybCBkb3duc3ByZWFk
ID0geyB7MH0gfTsKIAl1bmlvbiBsYW5lX2NvdW50X3NldCBsYW5lX2NvdW50X3NldCA9IHsgezB9
IH07Ci0JZW51bSBod19kcF90cmFpbmluZ19wYXR0ZXJuIGh3X3RyX3BhdHRlcm47CisJZW51bSBk
Y19kcF90cmFpbmluZ19wYXR0ZXJuIGRwX3RyX3BhdHRlcm47CiAKIAlkb3duc3ByZWFkLnJhdyA9
ICh1aW50OF90KQogCShsdF9zZXR0aW5ncy0+bGlua19zZXR0aW5ncy5saW5rX3NwcmVhZCk7CkBA
IC0xMzQsMjEgKzE0MCwyMSBAQCBzdGF0aWMgdm9pZCBkcGNkX3NldF9saW5rX3NldHRpbmdzKAog
CWxhbmVfY291bnRfc2V0LmJpdHMuTEFORV9DT1VOVF9TRVQgPQogCWx0X3NldHRpbmdzLT5saW5r
X3NldHRpbmdzLmxhbmVfY291bnQ7CiAKLQlsYW5lX2NvdW50X3NldC5iaXRzLkVOSEFOQ0VEX0ZS
QU1JTkcgPSAxOwotCisJbGFuZV9jb3VudF9zZXQuYml0cy5FTkhBTkNFRF9GUkFNSU5HID0gbHRf
c2V0dGluZ3MtPmVuaGFuY2VkX2ZyYW1pbmc7CiAJbGFuZV9jb3VudF9zZXQuYml0cy5QT1NUX0xU
X0FESl9SRVFfR1JBTlRFRCA9IDA7CiAKLQlod190cl9wYXR0ZXJuID0gZ2V0X3N1cHBvcnRlZF90
cChsaW5rKTsKLQlpZiAoaHdfdHJfcGF0dGVybiAhPSBIV19EUF9UUkFJTklOR19QQVRURVJOXzQp
IHsKKwlkcF90cl9wYXR0ZXJuID0gZ2V0X3N1cHBvcnRlZF90cChsaW5rKTsKKworCWlmIChkcF90
cl9wYXR0ZXJuICE9IERQX1RSQUlOSU5HX1BBVFRFUk5fU0VRVUVOQ0VfNCkgewogCQlsYW5lX2Nv
dW50X3NldC5iaXRzLlBPU1RfTFRfQURKX1JFUV9HUkFOVEVEID0KIAkJCQlsaW5rLT5kcGNkX2Nh
cHMubWF4X2xuX2NvdW50LmJpdHMuUE9TVF9MVF9BREpfUkVRX1NVUFBPUlRFRDsKIAl9CiAKIAlj
b3JlX2xpbmtfd3JpdGVfZHBjZChsaW5rLCBEUF9ET1dOU1BSRUFEX0NUUkwsCi0JJmRvd25zcHJl
YWQucmF3LCBzaXplb2YoZG93bnNwcmVhZCkpOworCQkmZG93bnNwcmVhZC5yYXcsIHNpemVvZihk
b3duc3ByZWFkKSk7CiAKIAljb3JlX2xpbmtfd3JpdGVfZHBjZChsaW5rLCBEUF9MQU5FX0NPVU5U
X1NFVCwKLQkmbGFuZV9jb3VudF9zZXQucmF3LCAxKTsKKwkJJmxhbmVfY291bnRfc2V0LnJhdywg
MSk7CiAKIAlpZiAobGluay0+ZHBjZF9jYXBzLmRwY2RfcmV2LnJhdyA+PSBEUENEX1JFVl8xNCAm
JgogCQkJbHRfc2V0dGluZ3MtPmxpbmtfc2V0dGluZ3MudXNlX2xpbmtfcmF0ZV9zZXQgPT0gdHJ1
ZSkgewpAQCAtMTYyLDQ2ICsxNjgsNDcgQEAgc3RhdGljIHZvaWQgZHBjZF9zZXRfbGlua19zZXR0
aW5ncygKIAl9CiAKIAlpZiAocmF0ZSkgewotCQlEQ19MT0dfSFdfTElOS19UUkFJTklORygiJXNc
biAleCByYXRlID0gJXhcbiAleCBsYW5lID0gJXhcbiAleCBzcHJlYWQgPSAleFxuIiwKKwkJRENf
TE9HX0hXX0xJTktfVFJBSU5JTkcoIiVzXG4gJXggcmF0ZSA9ICV4XG4gJXggbGFuZSA9ICV4IGZy
YW1pbmcgPSAleFxuICV4IHNwcmVhZCA9ICV4XG4iLAogCQkJX19mdW5jX18sCiAJCQlEUF9MSU5L
X0JXX1NFVCwKIAkJCWx0X3NldHRpbmdzLT5saW5rX3NldHRpbmdzLmxpbmtfcmF0ZSwKIAkJCURQ
X0xBTkVfQ09VTlRfU0VULAogCQkJbHRfc2V0dGluZ3MtPmxpbmtfc2V0dGluZ3MubGFuZV9jb3Vu
dCwKKwkJCWx0X3NldHRpbmdzLT5lbmhhbmNlZF9mcmFtaW5nLAogCQkJRFBfRE9XTlNQUkVBRF9D
VFJMLAogCQkJbHRfc2V0dGluZ3MtPmxpbmtfc2V0dGluZ3MubGlua19zcHJlYWQpOwogCX0gZWxz
ZSB7Ci0JCURDX0xPR19IV19MSU5LX1RSQUlOSU5HKCIlc1xuICV4IHJhdGUgc2V0ID0gJXhcbiAl
eCBsYW5lID0gJXhcbiAleCBzcHJlYWQgPSAleFxuIiwKKwkJRENfTE9HX0hXX0xJTktfVFJBSU5J
TkcoIiVzXG4gJXggcmF0ZSBzZXQgPSAleFxuICV4IGxhbmUgPSAleCBmcmFtaW5nID0gJXhcbiAl
eCBzcHJlYWQgPSAleFxuIiwKIAkJCV9fZnVuY19fLAogCQkJRFBfTElOS19SQVRFX1NFVCwKIAkJ
CWx0X3NldHRpbmdzLT5saW5rX3NldHRpbmdzLmxpbmtfcmF0ZV9zZXQsCiAJCQlEUF9MQU5FX0NP
VU5UX1NFVCwKIAkJCWx0X3NldHRpbmdzLT5saW5rX3NldHRpbmdzLmxhbmVfY291bnQsCisJCQls
dF9zZXR0aW5ncy0+ZW5oYW5jZWRfZnJhbWluZywKIAkJCURQX0RPV05TUFJFQURfQ1RSTCwKIAkJ
CWx0X3NldHRpbmdzLT5saW5rX3NldHRpbmdzLmxpbmtfc3ByZWFkKTsKIAl9Ci0KIH0KIAogc3Rh
dGljIGVudW0gZHBjZF90cmFpbmluZ19wYXR0ZXJucwotCWh3X3RyYWluaW5nX3BhdHRlcm5fdG9f
ZHBjZF90cmFpbmluZ19wYXR0ZXJuKAorCWRjX2RwX3RyYWluaW5nX3BhdHRlcm5fdG9fZHBjZF90
cmFpbmluZ19wYXR0ZXJuKAogCXN0cnVjdCBkY19saW5rICpsaW5rLAotCWVudW0gaHdfZHBfdHJh
aW5pbmdfcGF0dGVybiBwYXR0ZXJuKQorCWVudW0gZGNfZHBfdHJhaW5pbmdfcGF0dGVybiBwYXR0
ZXJuKQogewogCWVudW0gZHBjZF90cmFpbmluZ19wYXR0ZXJucyBkcGNkX3RyX3BhdHRlcm4gPQog
CURQQ0RfVFJBSU5JTkdfUEFUVEVSTl9WSURFT0lETEU7CiAKIAlzd2l0Y2ggKHBhdHRlcm4pIHsK
LQljYXNlIEhXX0RQX1RSQUlOSU5HX1BBVFRFUk5fMToKKwljYXNlIERQX1RSQUlOSU5HX1BBVFRF
Uk5fU0VRVUVOQ0VfMToKIAkJZHBjZF90cl9wYXR0ZXJuID0gRFBDRF9UUkFJTklOR19QQVRURVJO
XzE7CiAJCWJyZWFrOwotCWNhc2UgSFdfRFBfVFJBSU5JTkdfUEFUVEVSTl8yOgorCWNhc2UgRFBf
VFJBSU5JTkdfUEFUVEVSTl9TRVFVRU5DRV8yOgogCQlkcGNkX3RyX3BhdHRlcm4gPSBEUENEX1RS
QUlOSU5HX1BBVFRFUk5fMjsKIAkJYnJlYWs7Ci0JY2FzZSBIV19EUF9UUkFJTklOR19QQVRURVJO
XzM6CisJY2FzZSBEUF9UUkFJTklOR19QQVRURVJOX1NFUVVFTkNFXzM6CiAJCWRwY2RfdHJfcGF0
dGVybiA9IERQQ0RfVFJBSU5JTkdfUEFUVEVSTl8zOwogCQlicmVhazsKLQljYXNlIEhXX0RQX1RS
QUlOSU5HX1BBVFRFUk5fNDoKKwljYXNlIERQX1RSQUlOSU5HX1BBVFRFUk5fU0VRVUVOQ0VfNDoK
IAkJZHBjZF90cl9wYXR0ZXJuID0gRFBDRF9UUkFJTklOR19QQVRURVJOXzQ7CiAJCWJyZWFrOwog
CWRlZmF1bHQ6CkBAIC0yMTIsMTMgKzIxOSwxMiBAQCBzdGF0aWMgZW51bSBkcGNkX3RyYWluaW5n
X3BhdHRlcm5zCiAJfQogCiAJcmV0dXJuIGRwY2RfdHJfcGF0dGVybjsKLQogfQogCiBzdGF0aWMg
dm9pZCBkcGNkX3NldF9sdF9wYXR0ZXJuX2FuZF9sYW5lX3NldHRpbmdzKAogCXN0cnVjdCBkY19s
aW5rICpsaW5rLAogCWNvbnN0IHN0cnVjdCBsaW5rX3RyYWluaW5nX3NldHRpbmdzICpsdF9zZXR0
aW5ncywKLQllbnVtIGh3X2RwX3RyYWluaW5nX3BhdHRlcm4gcGF0dGVybikKKwllbnVtIGRjX2Rw
X3RyYWluaW5nX3BhdHRlcm4gcGF0dGVybikKIHsKIAl1bmlvbiBkcGNkX3RyYWluaW5nX2xhbmUg
ZHBjZF9sYW5lW0xBTkVfQ09VTlRfRFBfTUFYXSA9IHsgeyB7MH0gfSB9OwogCWNvbnN0IHVpbnQz
Ml90IGRwY2RfYmFzZV9sdF9vZmZzZXQgPQpAQCAtMjMzLDcgKzIzOSw3IEBAIHN0YXRpYyB2b2lk
IGRwY2Rfc2V0X2x0X3BhdHRlcm5fYW5kX2xhbmVfc2V0dGluZ3MoCiAJKiBEcGNkQWRkcmVzc19U
cmFpbmluZ1BhdHRlcm5TZXQKIAkqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KIAlkcGNkX3BhdHRlcm4udjFfNC5UUkFJTklO
R19QQVRURVJOX1NFVCA9Ci0JCWh3X3RyYWluaW5nX3BhdHRlcm5fdG9fZHBjZF90cmFpbmluZ19w
YXR0ZXJuKGxpbmssIHBhdHRlcm4pOworCQlkY19kcF90cmFpbmluZ19wYXR0ZXJuX3RvX2RwY2Rf
dHJhaW5pbmdfcGF0dGVybihsaW5rLCBwYXR0ZXJuKTsKIAogCWRwY2RfbHRfYnVmZmVyW0RQX1RS
QUlOSU5HX1BBVFRFUk5fU0VUIC0gZHBjZF9iYXNlX2x0X29mZnNldF0KIAkJPSBkcGNkX3BhdHRl
cm4ucmF3OwpAQCAtMzQ2LDEyICszNTIsMjAgQEAgc3RhdGljIHZvaWQgdXBkYXRlX2RyaXZlX3Nl
dHRpbmdzKAogewogCXVpbnQzMl90IGxhbmU7CiAJZm9yIChsYW5lID0gMDsgbGFuZSA8IHNyYy5s
aW5rX3NldHRpbmdzLmxhbmVfY291bnQ7IGxhbmUrKykgewotCQlkZXN0LT5sYW5lX3NldHRpbmdz
W2xhbmVdLlZPTFRBR0VfU1dJTkcgPQotCQkJc3JjLmxhbmVfc2V0dGluZ3NbbGFuZV0uVk9MVEFH
RV9TV0lORzsKLQkJZGVzdC0+bGFuZV9zZXR0aW5nc1tsYW5lXS5QUkVfRU1QSEFTSVMgPQotCQkJ
c3JjLmxhbmVfc2V0dGluZ3NbbGFuZV0uUFJFX0VNUEhBU0lTOwotCQlkZXN0LT5sYW5lX3NldHRp
bmdzW2xhbmVdLlBPU1RfQ1VSU09SMiA9Ci0JCQlzcmMubGFuZV9zZXR0aW5nc1tsYW5lXS5QT1NU
X0NVUlNPUjI7CisJCWlmIChkZXN0LT52b2x0YWdlX3N3aW5nID09IE5VTEwpCisJCQlkZXN0LT5s
YW5lX3NldHRpbmdzW2xhbmVdLlZPTFRBR0VfU1dJTkcgPSBzcmMubGFuZV9zZXR0aW5nc1tsYW5l
XS5WT0xUQUdFX1NXSU5HOworCQllbHNlCisJCQlkZXN0LT5sYW5lX3NldHRpbmdzW2xhbmVdLlZP
TFRBR0VfU1dJTkcgPSAqZGVzdC0+dm9sdGFnZV9zd2luZzsKKworCQlpZiAoZGVzdC0+cHJlX2Vt
cGhhc2lzID09IE5VTEwpCisJCQlkZXN0LT5sYW5lX3NldHRpbmdzW2xhbmVdLlBSRV9FTVBIQVNJ
UyA9IHNyYy5sYW5lX3NldHRpbmdzW2xhbmVdLlBSRV9FTVBIQVNJUzsKKwkJZWxzZQorCQkJZGVz
dC0+bGFuZV9zZXR0aW5nc1tsYW5lXS5QUkVfRU1QSEFTSVMgPSAqZGVzdC0+cHJlX2VtcGhhc2lz
OworCisJCWlmIChkZXN0LT5wb3N0X2N1cnNvcjIgPT0gTlVMTCkKKwkJCWRlc3QtPmxhbmVfc2V0
dGluZ3NbbGFuZV0uUE9TVF9DVVJTT1IyID0gc3JjLmxhbmVfc2V0dGluZ3NbbGFuZV0uUE9TVF9D
VVJTT1IyOworCQllbHNlCisJCQlkZXN0LT5sYW5lX3NldHRpbmdzW2xhbmVdLlBPU1RfQ1VSU09S
MiA9ICpkZXN0LT5wb3N0X2N1cnNvcjI7CiAJfQogfQogCkBAIC03NTQsMTUgKzc2OCwxNSBAQCBz
dGF0aWMgZW51bSBsaW5rX3RyYWluaW5nX3Jlc3VsdCBwZXJmb3JtX2NoYW5uZWxfZXF1YWxpemF0
aW9uX3NlcXVlbmNlKAogCXN0cnVjdCBsaW5rX3RyYWluaW5nX3NldHRpbmdzICpsdF9zZXR0aW5n
cykKIHsKIAlzdHJ1Y3QgbGlua190cmFpbmluZ19zZXR0aW5ncyByZXFfc2V0dGluZ3M7Ci0JZW51
bSBod19kcF90cmFpbmluZ19wYXR0ZXJuIGh3X3RyX3BhdHRlcm47CisJZW51bSBkY19kcF90cmFp
bmluZ19wYXR0ZXJuIHRyX3BhdHRlcm47CiAJdWludDMyX3QgcmV0cmllc19jaF9lcTsKIAllbnVt
IGRjX2xhbmVfY291bnQgbGFuZV9jb3VudCA9IGx0X3NldHRpbmdzLT5saW5rX3NldHRpbmdzLmxh
bmVfY291bnQ7CiAJdW5pb24gbGFuZV9hbGlnbl9zdGF0dXNfdXBkYXRlZCBkcGNkX2xhbmVfc3Rh
dHVzX3VwZGF0ZWQgPSB7IHswfSB9OwogCXVuaW9uIGxhbmVfc3RhdHVzIGRwY2RfbGFuZV9zdGF0
dXNbTEFORV9DT1VOVF9EUF9NQVhdID0geyB7IHswfSB9IH07CiAKLQlod190cl9wYXR0ZXJuID0g
Z2V0X3N1cHBvcnRlZF90cChsaW5rKTsKKwl0cl9wYXR0ZXJuID0gbHRfc2V0dGluZ3MtPnBhdHRl
cm5fZm9yX2VxOwogCi0JZHBfc2V0X2h3X3RyYWluaW5nX3BhdHRlcm4obGluaywgaHdfdHJfcGF0
dGVybik7CisJZHBfc2V0X2h3X3RyYWluaW5nX3BhdHRlcm4obGluaywgdHJfcGF0dGVybik7CiAK
IAlmb3IgKHJldHJpZXNfY2hfZXEgPSAwOyByZXRyaWVzX2NoX2VxIDw9IExJTktfVFJBSU5JTkdf
TUFYX1JFVFJZX0NPVU5UOwogCQlyZXRyaWVzX2NoX2VxKyspIHsKQEAgLTc3NiwxMiArNzkwLDEy
IEBAIHN0YXRpYyBlbnVtIGxpbmtfdHJhaW5pbmdfcmVzdWx0IHBlcmZvcm1fY2hhbm5lbF9lcXVh
bGl6YXRpb25fc2VxdWVuY2UoCiAJCQlkcGNkX3NldF9sdF9wYXR0ZXJuX2FuZF9sYW5lX3NldHRp
bmdzKAogCQkJCWxpbmssCiAJCQkJbHRfc2V0dGluZ3MsCi0JCQkJaHdfdHJfcGF0dGVybik7CisJ
CQkJdHJfcGF0dGVybik7CiAJCWVsc2UKIAkJCWRwY2Rfc2V0X2xhbmVfc2V0dGluZ3MobGluaywg
bHRfc2V0dGluZ3MpOwogCiAJCS8qIDMuIHdhaXQgZm9yIHJlY2VpdmVyIHRvIGxvY2stb24qLwot
CQl3YWl0X2Zvcl90cmFpbmluZ19hdXhfcmRfaW50ZXJ2YWwobGluaywgNDAwKTsKKwkJd2FpdF9m
b3JfdHJhaW5pbmdfYXV4X3JkX2ludGVydmFsKGxpbmssIGx0X3NldHRpbmdzLT5lcV9wYXR0ZXJu
X3RpbWUpOwogCiAJCS8qIDQuIFJlYWQgbGFuZSBzdGF0dXMgYW5kIHJlcXVlc3RlZAogCQkgKiBk
cml2ZSBzZXR0aW5ncyBhcyBzZXQgYnkgdGhlIHNpbmsqLwpAQCAtODE3LDI3ICs4MzEsMTYgQEAg
c3RhdGljIGVudW0gbGlua190cmFpbmluZ19yZXN1bHQgcGVyZm9ybV9jbG9ja19yZWNvdmVyeV9z
ZXF1ZW5jZSgKIHsKIAl1aW50MzJfdCByZXRyaWVzX2NyOwogCXVpbnQzMl90IHJldHJ5X2NvdW50
OwotCXVpbnQzMl90IGxhbmU7CiAJc3RydWN0IGxpbmtfdHJhaW5pbmdfc2V0dGluZ3MgcmVxX3Nl
dHRpbmdzOwotCWVudW0gZGNfbGFuZV9jb3VudCBsYW5lX2NvdW50ID0KLQlsdF9zZXR0aW5ncy0+
bGlua19zZXR0aW5ncy5sYW5lX2NvdW50OwotCWVudW0gaHdfZHBfdHJhaW5pbmdfcGF0dGVybiBo
d190cl9wYXR0ZXJuID0gSFdfRFBfVFJBSU5JTkdfUEFUVEVSTl8xOworCWVudW0gZGNfbGFuZV9j
b3VudCBsYW5lX2NvdW50ID0gbHRfc2V0dGluZ3MtPmxpbmtfc2V0dGluZ3MubGFuZV9jb3VudDsK
KwllbnVtIGRjX2RwX3RyYWluaW5nX3BhdHRlcm4gdHJfcGF0dGVybiA9IERQX1RSQUlOSU5HX1BB
VFRFUk5fU0VRVUVOQ0VfMTsKIAl1bmlvbiBsYW5lX3N0YXR1cyBkcGNkX2xhbmVfc3RhdHVzW0xB
TkVfQ09VTlRfRFBfTUFYXTsKIAl1bmlvbiBsYW5lX2FsaWduX3N0YXR1c191cGRhdGVkIGRwY2Rf
bGFuZV9zdGF0dXNfdXBkYXRlZDsKIAogCXJldHJpZXNfY3IgPSAwOwogCXJldHJ5X2NvdW50ID0g
MDsKLQkvKiBpbml0aWFsIGRyaXZlIHNldHRpbmcgKFZTL1BFL1BDMikqLwotCWZvciAobGFuZSA9
IDA7IGxhbmUgPCBMQU5FX0NPVU5UX0RQX01BWDsgbGFuZSsrKSB7Ci0JCWx0X3NldHRpbmdzLT5s
YW5lX3NldHRpbmdzW2xhbmVdLlZPTFRBR0VfU1dJTkcgPQotCQlWT0xUQUdFX1NXSU5HX0xFVkVM
MDsKLQkJbHRfc2V0dGluZ3MtPmxhbmVfc2V0dGluZ3NbbGFuZV0uUFJFX0VNUEhBU0lTID0KLQkJ
UFJFX0VNUEhBU0lTX0RJU0FCTEVEOwotCQlsdF9zZXR0aW5ncy0+bGFuZV9zZXR0aW5nc1tsYW5l
XS5QT1NUX0NVUlNPUjIgPQotCQlQT1NUX0NVUlNPUjJfRElTQUJMRUQ7Ci0JfQogCi0JZHBfc2V0
X2h3X3RyYWluaW5nX3BhdHRlcm4obGluaywgaHdfdHJfcGF0dGVybik7CisJZHBfc2V0X2h3X3Ry
YWluaW5nX3BhdHRlcm4obGluaywgdHJfcGF0dGVybik7CiAKIAkvKiBuYWplZWIgLSBUaGUgc3lu
YXB0aWNzIE1TVCBodWIgY2FuIHB1dCB0aGUgTFQgaW4KIAkqIGluZmluaXRlIGxvb3AgYnkgc3dp
dGNoaW5nIHRoZSBWUwpAQCAtODQ1LDcgKzg0OCw3IEBAIHN0YXRpYyBlbnVtIGxpbmtfdHJhaW5p
bmdfcmVzdWx0IHBlcmZvcm1fY2xvY2tfcmVjb3Zlcnlfc2VxdWVuY2UoCiAJLyogYmV0d2VlbiBs
ZXZlbCAwIGFuZCBsZXZlbCAxIGNvbnRpbnVvdXNseSwgaGVyZQogCSogd2UgdHJ5IGZvciBDUiBs
b2NrIGZvciBMaW5rVHJhaW5pbmdNYXhDUlJldHJ5IGNvdW50Ki8KIAl3aGlsZSAoKHJldHJpZXNf
Y3IgPCBMSU5LX1RSQUlOSU5HX01BWF9SRVRSWV9DT1VOVCkgJiYKLQkocmV0cnlfY291bnQgPCBM
SU5LX1RSQUlOSU5HX01BWF9DUl9SRVRSWSkpIHsKKwkJKHJldHJ5X2NvdW50IDwgTElOS19UUkFJ
TklOR19NQVhfQ1JfUkVUUlkpKSB7CiAKIAkJbWVtc2V0KCZkcGNkX2xhbmVfc3RhdHVzLCAnXDAn
LCBzaXplb2YoZHBjZF9sYW5lX3N0YXR1cykpOwogCQltZW1zZXQoJmRwY2RfbGFuZV9zdGF0dXNf
dXBkYXRlZCwgJ1wwJywKQEAgLTg2Myw3ICs4NjYsNyBAQCBzdGF0aWMgZW51bSBsaW5rX3RyYWlu
aW5nX3Jlc3VsdCBwZXJmb3JtX2Nsb2NrX3JlY292ZXJ5X3NlcXVlbmNlKAogCQkJZHBjZF9zZXRf
bHRfcGF0dGVybl9hbmRfbGFuZV9zZXR0aW5ncygKIAkJCQkJbGluaywKIAkJCQkJbHRfc2V0dGlu
Z3MsCi0JCQkJCWh3X3RyX3BhdHRlcm4pOworCQkJCQl0cl9wYXR0ZXJuKTsKIAkJZWxzZQogCQkJ
ZHBjZF9zZXRfbGFuZV9zZXR0aW5ncygKIAkJCQkJbGluaywKQEAgLTg3Miw3ICs4NzUsNyBAQCBz
dGF0aWMgZW51bSBsaW5rX3RyYWluaW5nX3Jlc3VsdCBwZXJmb3JtX2Nsb2NrX3JlY292ZXJ5X3Nl
cXVlbmNlKAogCQkvKiAzLiB3YWl0IHJlY2VpdmVyIHRvIGxvY2stb24qLwogCQl3YWl0X2Zvcl90
cmFpbmluZ19hdXhfcmRfaW50ZXJ2YWwoCiAJCQkJbGluaywKLQkJCQkxMDApOworCQkJCWx0X3Nl
dHRpbmdzLT5jcl9wYXR0ZXJuX3RpbWUpOwogCiAJCS8qIDQuIFJlYWQgbGFuZSBzdGF0dXMgYW5k
IHJlcXVlc3RlZCBkcml2ZQogCQkqIHNldHRpbmdzIGFzIHNldCBieSB0aGUgc2luawpAQCAtOTM5
LDcgKzk0Miw3IEBAIHN0YXRpYyBpbmxpbmUgZW51bSBsaW5rX3RyYWluaW5nX3Jlc3VsdCBwZXJm
b3JtX2xpbmtfdHJhaW5pbmdfaW50KAogCSAqIFRQUzQgbXVzdCBiZSB1c2VkIGluc3RlYWQgb2Yg
UE9TVF9MVF9BREpfUkVRLgogCSAqLwogCWlmIChsaW5rLT5kcGNkX2NhcHMubWF4X2xuX2NvdW50
LmJpdHMuUE9TVF9MVF9BREpfUkVRX1NVUFBPUlRFRCAhPSAxIHx8Ci0JCQlnZXRfc3VwcG9ydGVk
X3RwKGxpbmspID09IEhXX0RQX1RSQUlOSU5HX1BBVFRFUk5fNCkKKwkJCWdldF9zdXBwb3J0ZWRf
dHAobGluaykgPT0gRFBfVFJBSU5JTkdfUEFUVEVSTl9TRVFVRU5DRV80KQogCQlyZXR1cm4gc3Rh
dHVzOwogCiAJaWYgKHN0YXR1cyA9PSBMSU5LX1RSQUlOSU5HX1NVQ0NFU1MgJiYKQEAgLTk0Nyw3
ICs5NTAsNyBAQCBzdGF0aWMgaW5saW5lIGVudW0gbGlua190cmFpbmluZ19yZXN1bHQgcGVyZm9y
bV9saW5rX3RyYWluaW5nX2ludCgKIAkJc3RhdHVzID0gTElOS19UUkFJTklOR19MUUFfRkFJTDsK
IAogCWxhbmVfY291bnRfc2V0LmJpdHMuTEFORV9DT1VOVF9TRVQgPSBsdF9zZXR0aW5ncy0+bGlu
a19zZXR0aW5ncy5sYW5lX2NvdW50OwotCWxhbmVfY291bnRfc2V0LmJpdHMuRU5IQU5DRURfRlJB
TUlORyA9IDE7CisJbGFuZV9jb3VudF9zZXQuYml0cy5FTkhBTkNFRF9GUkFNSU5HID0gbHRfc2V0
dGluZ3MtPmVuaGFuY2VkX2ZyYW1pbmc7CiAJbGFuZV9jb3VudF9zZXQuYml0cy5QT1NUX0xUX0FE
Sl9SRVFfR1JBTlRFRCA9IDA7CiAKIAljb3JlX2xpbmtfd3JpdGVfZHBjZCgKQEAgLTk1OSwyNCAr
OTYyLDI4IEBAIHN0YXRpYyBpbmxpbmUgZW51bSBsaW5rX3RyYWluaW5nX3Jlc3VsdCBwZXJmb3Jt
X2xpbmtfdHJhaW5pbmdfaW50KAogCXJldHVybiBzdGF0dXM7CiB9CiAKLWVudW0gbGlua190cmFp
bmluZ19yZXN1bHQgZGNfbGlua19kcF9wZXJmb3JtX2xpbmtfdHJhaW5pbmcoCi0Jc3RydWN0IGRj
X2xpbmsgKmxpbmssCitzdGF0aWMgdm9pZCBpbml0aWFsaXplX3RyYWluaW5nX3NldHRpbmdzKAor
CSBzdHJ1Y3QgZGNfbGluayAqbGluaywKIAljb25zdCBzdHJ1Y3QgZGNfbGlua19zZXR0aW5ncyAq
bGlua19zZXR0aW5nLAotCWJvb2wgc2tpcF92aWRlb19wYXR0ZXJuKQorCXN0cnVjdCBsaW5rX3Ry
YWluaW5nX3NldHRpbmdzICpsdF9zZXR0aW5ncykKIHsKLQllbnVtIGxpbmtfdHJhaW5pbmdfcmVz
dWx0IHN0YXR1cyA9IExJTktfVFJBSU5JTkdfU1VDQ0VTUzsKKwl1aW50MzJfdCBsYW5lOwogCi0J
Y2hhciAqbGlua19yYXRlID0gIlVua25vd24iOwotCWNoYXIgKmx0X3Jlc3VsdCA9ICJVbmtub3du
IjsKKwltZW1zZXQobHRfc2V0dGluZ3MsICdcMCcsIHNpemVvZihzdHJ1Y3QgbGlua190cmFpbmlu
Z19zZXR0aW5ncykpOwogCi0Jc3RydWN0IGxpbmtfdHJhaW5pbmdfc2V0dGluZ3MgbHRfc2V0dGlu
Z3M7CisJLyogSW5pdGlhbGl6ZSBsaW5rIHNldHRpbmdzICovCisJbHRfc2V0dGluZ3MtPmxpbmtf
c2V0dGluZ3MudXNlX2xpbmtfcmF0ZV9zZXQgPSBsaW5rX3NldHRpbmctPnVzZV9saW5rX3JhdGVf
c2V0OworCWx0X3NldHRpbmdzLT5saW5rX3NldHRpbmdzLmxpbmtfcmF0ZV9zZXQgPSBsaW5rX3Nl
dHRpbmctPmxpbmtfcmF0ZV9zZXQ7CiAKLQltZW1zZXQoJmx0X3NldHRpbmdzLCAnXDAnLCBzaXpl
b2YobHRfc2V0dGluZ3MpKTsKKwlpZiAobGluay0+cHJlZmVycmVkX2xpbmtfc2V0dGluZy5saW5r
X3JhdGUgIT0gTElOS19SQVRFX1VOS05PV04pCisJCWx0X3NldHRpbmdzLT5saW5rX3NldHRpbmdz
LmxpbmtfcmF0ZSA9IGxpbmstPnByZWZlcnJlZF9saW5rX3NldHRpbmcubGlua19yYXRlOworCWVs
c2UKKwkJbHRfc2V0dGluZ3MtPmxpbmtfc2V0dGluZ3MubGlua19yYXRlID0gbGlua19zZXR0aW5n
LT5saW5rX3JhdGU7CiAKLQlsdF9zZXR0aW5ncy5saW5rX3NldHRpbmdzLmxpbmtfcmF0ZSA9IGxp
bmtfc2V0dGluZy0+bGlua19yYXRlOwotCWx0X3NldHRpbmdzLmxpbmtfc2V0dGluZ3MubGFuZV9j
b3VudCA9IGxpbmtfc2V0dGluZy0+bGFuZV9jb3VudDsKLQlsdF9zZXR0aW5ncy5saW5rX3NldHRp
bmdzLnVzZV9saW5rX3JhdGVfc2V0ID0gbGlua19zZXR0aW5nLT51c2VfbGlua19yYXRlX3NldDsK
LQlsdF9zZXR0aW5ncy5saW5rX3NldHRpbmdzLmxpbmtfcmF0ZV9zZXQgPSBsaW5rX3NldHRpbmct
PmxpbmtfcmF0ZV9zZXQ7CisJaWYgKGxpbmstPnByZWZlcnJlZF9saW5rX3NldHRpbmcubGFuZV9j
b3VudCAhPSBMQU5FX0NPVU5UX1VOS05PV04pCisJCWx0X3NldHRpbmdzLT5saW5rX3NldHRpbmdz
LmxhbmVfY291bnQgPSBsaW5rLT5wcmVmZXJyZWRfbGlua19zZXR0aW5nLmxhbmVfY291bnQ7CisJ
ZWxzZQorCQlsdF9zZXR0aW5ncy0+bGlua19zZXR0aW5ncy5sYW5lX2NvdW50ID0gbGlua19zZXR0
aW5nLT5sYW5lX2NvdW50OwogCiAJLypAdG9kb1t2ZGV2dWxhcF0gbW92ZSBTUyB0byBMUywgc2hv
dWxkIG5vdCBiZSBoYW5kbGVkIGJ5IGRpc3BsYXlwYXRoKi8KIApAQCAtOTg3LDMxICs5OTQsNzUg
QEAgZW51bSBsaW5rX3RyYWluaW5nX3Jlc3VsdCBkY19saW5rX2RwX3BlcmZvcm1fbGlua190cmFp
bmluZygKIAkgKiBMSU5LX1NQUkVBRF8wNV9ET1dOU1BSRUFEXzMwS0haIDoKIAkgKiBMSU5LX1NQ
UkVBRF9ESVNBQkxFRDsKIAkgKi8KKwkvKiBJbml0aWFsaXplIGxpbmsgc3ByZWFkICovCiAJaWYg
KGxpbmstPmRwX3NzX29mZikKLQkJbHRfc2V0dGluZ3MubGlua19zZXR0aW5ncy5saW5rX3NwcmVh
ZCA9IExJTktfU1BSRUFEX0RJU0FCTEVEOworCQlsdF9zZXR0aW5ncy0+bGlua19zZXR0aW5ncy5s
aW5rX3NwcmVhZCA9IExJTktfU1BSRUFEX0RJU0FCTEVEOworCWVsc2UgaWYgKGxpbmstPnByZWZl
cnJlZF90cmFpbmluZ19zZXR0aW5ncy5kb3duc3ByZWFkICE9IE5VTEwpCisJCWx0X3NldHRpbmdz
LT5saW5rX3NldHRpbmdzLmxpbmtfc3ByZWFkCisJCQk9ICpsaW5rLT5wcmVmZXJyZWRfdHJhaW5p
bmdfc2V0dGluZ3MuZG93bnNwcmVhZAorCQkJPyBMSU5LX1NQUkVBRF8wNV9ET1dOU1BSRUFEXzMw
S0haCisJCQk6IExJTktfU1BSRUFEX0RJU0FCTEVEOwogCWVsc2UKLQkJbHRfc2V0dGluZ3MubGlu
a19zZXR0aW5ncy5saW5rX3NwcmVhZCA9IExJTktfU1BSRUFEXzA1X0RPV05TUFJFQURfMzBLSFo7
CisJCWx0X3NldHRpbmdzLT5saW5rX3NldHRpbmdzLmxpbmtfc3ByZWFkID0gTElOS19TUFJFQURf
MDVfRE9XTlNQUkVBRF8zMEtIWjsKIAotCS8qIDEuIHNldCBsaW5rIHJhdGUsIGxhbmUgY291bnQg
YW5kIHNwcmVhZCovCi0JZHBjZF9zZXRfbGlua19zZXR0aW5ncyhsaW5rLCAmbHRfc2V0dGluZ3Mp
OworCS8qIEluaXRpYWxpemUgbGFuZSBzZXR0aW5ncyBvdmVycmlkZXMgKi8KKwlpZiAobGluay0+
cHJlZmVycmVkX3RyYWluaW5nX3NldHRpbmdzLnZvbHRhZ2Vfc3dpbmcgIT0gTlVMTCkKKwkJbHRf
c2V0dGluZ3MtPnZvbHRhZ2Vfc3dpbmcgPSBsaW5rLT5wcmVmZXJyZWRfdHJhaW5pbmdfc2V0dGlu
Z3Mudm9sdGFnZV9zd2luZzsKIAotCS8qIDIuIHBlcmZvcm0gbGluayB0cmFpbmluZyAoc2V0IGxp
bmsgdHJhaW5pbmcgZG9uZQotCSAqICB0byBmYWxzZSBpcyBkb25lIGFzIHdlbGwpKi8KLQlzdGF0
dXMgPSBwZXJmb3JtX2Nsb2NrX3JlY292ZXJ5X3NlcXVlbmNlKGxpbmssICZsdF9zZXR0aW5ncyk7
Ci0JaWYgKHN0YXR1cyA9PSBMSU5LX1RSQUlOSU5HX1NVQ0NFU1MpIHsKLQkJc3RhdHVzID0gcGVy
Zm9ybV9jaGFubmVsX2VxdWFsaXphdGlvbl9zZXF1ZW5jZShsaW5rLAotCQkJCSZsdF9zZXR0aW5n
cyk7Ci0JfQorCWlmIChsaW5rLT5wcmVmZXJyZWRfdHJhaW5pbmdfc2V0dGluZ3MucHJlX2VtcGhh
c2lzICE9IE5VTEwpCisJCWx0X3NldHRpbmdzLT5wcmVfZW1waGFzaXMgPSBsaW5rLT5wcmVmZXJy
ZWRfdHJhaW5pbmdfc2V0dGluZ3MucHJlX2VtcGhhc2lzOwogCi0JaWYgKChzdGF0dXMgPT0gTElO
S19UUkFJTklOR19TVUNDRVNTKSB8fCAhc2tpcF92aWRlb19wYXR0ZXJuKSB7Ci0JCXN0YXR1cyA9
IHBlcmZvcm1fbGlua190cmFpbmluZ19pbnQobGluaywKLQkJCQkmbHRfc2V0dGluZ3MsCi0JCQkJ
c3RhdHVzKTsKKwlpZiAobGluay0+cHJlZmVycmVkX3RyYWluaW5nX3NldHRpbmdzLnBvc3RfY3Vy
c29yMiAhPSBOVUxMKQorCQlsdF9zZXR0aW5ncy0+cG9zdF9jdXJzb3IyID0gbGluay0+cHJlZmVy
cmVkX3RyYWluaW5nX3NldHRpbmdzLnBvc3RfY3Vyc29yMjsKKworCS8qIEluaXRpYWxpemUgbGFu
ZSBzZXR0aW5ncyAoVlMvUEUvUEMyKSAqLworCWZvciAobGFuZSA9IDA7IGxhbmUgPCBMQU5FX0NP
VU5UX0RQX01BWDsgbGFuZSsrKSB7CisJCWx0X3NldHRpbmdzLT5sYW5lX3NldHRpbmdzW2xhbmVd
LlZPTFRBR0VfU1dJTkcgPQorCQkJbHRfc2V0dGluZ3MtPnZvbHRhZ2Vfc3dpbmcgIT0gTlVMTCA/
CisJCQkqbHRfc2V0dGluZ3MtPnZvbHRhZ2Vfc3dpbmcgOgorCQkJVk9MVEFHRV9TV0lOR19MRVZF
TDA7CisJCWx0X3NldHRpbmdzLT5sYW5lX3NldHRpbmdzW2xhbmVdLlBSRV9FTVBIQVNJUyA9CisJ
CQlsdF9zZXR0aW5ncy0+cHJlX2VtcGhhc2lzICE9IE5VTEwgPworCQkJKmx0X3NldHRpbmdzLT5w
cmVfZW1waGFzaXMKKwkJCTogUFJFX0VNUEhBU0lTX0RJU0FCTEVEOworCQlsdF9zZXR0aW5ncy0+
bGFuZV9zZXR0aW5nc1tsYW5lXS5QT1NUX0NVUlNPUjIgPQorCQkJbHRfc2V0dGluZ3MtPnBvc3Rf
Y3Vyc29yMiAhPSBOVUxMID8KKwkJCSpsdF9zZXR0aW5ncy0+cG9zdF9jdXJzb3IyCisJCQk6IFBP
U1RfQ1VSU09SMl9ESVNBQkxFRDsKIAl9CiAKLQkvKiA2LiBwcmludCBzdGF0dXMgbWVzc2FnZSov
Ci0Jc3dpdGNoIChsdF9zZXR0aW5ncy5saW5rX3NldHRpbmdzLmxpbmtfcmF0ZSkgeworCS8qIElu
aXRpYWxpemUgdHJhaW5pbmcgdGltaW5ncyAqLworCWlmIChsaW5rLT5wcmVmZXJyZWRfdHJhaW5p
bmdfc2V0dGluZ3MuY3JfcGF0dGVybl90aW1lICE9IE5VTEwpCisJCWx0X3NldHRpbmdzLT5jcl9w
YXR0ZXJuX3RpbWUgPSAqbGluay0+cHJlZmVycmVkX3RyYWluaW5nX3NldHRpbmdzLmNyX3BhdHRl
cm5fdGltZTsKKwllbHNlCisJCWx0X3NldHRpbmdzLT5jcl9wYXR0ZXJuX3RpbWUgPSBnZXRfdHJh
aW5pbmdfYXV4X3JkX2ludGVydmFsKGxpbmssIDEwMCk7CisKKwlpZiAobGluay0+cHJlZmVycmVk
X3RyYWluaW5nX3NldHRpbmdzLmVxX3BhdHRlcm5fdGltZSAhPSBOVUxMKQorCQlsdF9zZXR0aW5n
cy0+ZXFfcGF0dGVybl90aW1lID0gKmxpbmstPnByZWZlcnJlZF90cmFpbmluZ19zZXR0aW5ncy5l
cV9wYXR0ZXJuX3RpbWU7CisJZWxzZQorCQlsdF9zZXR0aW5ncy0+ZXFfcGF0dGVybl90aW1lID0g
Z2V0X3RyYWluaW5nX2F1eF9yZF9pbnRlcnZhbChsaW5rLCA0MDApOworCisJaWYgKGxpbmstPnBy
ZWZlcnJlZF90cmFpbmluZ19zZXR0aW5ncy5wYXR0ZXJuX2Zvcl9lcSAhPSBOVUxMKQorCQlsdF9z
ZXR0aW5ncy0+cGF0dGVybl9mb3JfZXEgPSAqbGluay0+cHJlZmVycmVkX3RyYWluaW5nX3NldHRp
bmdzLnBhdHRlcm5fZm9yX2VxOworCWVsc2UKKwkJbHRfc2V0dGluZ3MtPnBhdHRlcm5fZm9yX2Vx
ID0gZ2V0X3N1cHBvcnRlZF90cChsaW5rKTsKKworCWlmIChsaW5rLT5wcmVmZXJyZWRfdHJhaW5p
bmdfc2V0dGluZ3MuZW5oYW5jZWRfZnJhbWluZyAhPSBOVUxMKQorCQlsdF9zZXR0aW5ncy0+ZW5o
YW5jZWRfZnJhbWluZyA9ICpsaW5rLT5wcmVmZXJyZWRfdHJhaW5pbmdfc2V0dGluZ3MuZW5oYW5j
ZWRfZnJhbWluZzsKKwllbHNlCisJCWx0X3NldHRpbmdzLT5lbmhhbmNlZF9mcmFtaW5nID0gMTsK
K30KKworc3RhdGljIHZvaWQgcHJpbnRfc3RhdHVzX21lc3NhZ2UoCisJc3RydWN0IGRjX2xpbmsg
KmxpbmssCisJY29uc3Qgc3RydWN0IGxpbmtfdHJhaW5pbmdfc2V0dGluZ3MgKmx0X3NldHRpbmdz
LAorCWVudW0gbGlua190cmFpbmluZ19yZXN1bHQgc3RhdHVzKQoreworCWNoYXIgKmxpbmtfcmF0
ZSA9ICJVbmtub3duIjsKKwljaGFyICpsdF9yZXN1bHQgPSAiVW5rbm93biI7CisJY2hhciAqbHRf
c3ByZWFkID0gIkRpc2FibGVkIjsKIAorCXN3aXRjaCAobHRfc2V0dGluZ3MtPmxpbmtfc2V0dGlu
Z3MubGlua19yYXRlKSB7CiAJY2FzZSBMSU5LX1JBVEVfTE9XOgogCQlsaW5rX3JhdGUgPSAiUkJS
IjsKIAkJYnJlYWs7CkBAIC0xMDU3LDEzICsxMTA4LDEwMiBAQCBlbnVtIGxpbmtfdHJhaW5pbmdf
cmVzdWx0IGRjX2xpbmtfZHBfcGVyZm9ybV9saW5rX3RyYWluaW5nKAogCQlicmVhazsKIAl9CiAK
Kwlzd2l0Y2ggKGx0X3NldHRpbmdzLT5saW5rX3NldHRpbmdzLmxpbmtfc3ByZWFkKSB7CisJY2Fz
ZSBMSU5LX1NQUkVBRF9ESVNBQkxFRDoKKwkJbHRfc3ByZWFkID0gIkRpc2FibGVkIjsKKwkJYnJl
YWs7CisJY2FzZSBMSU5LX1NQUkVBRF8wNV9ET1dOU1BSRUFEXzMwS0haOgorCQlsdF9zcHJlYWQg
PSAiMC41JSAzMEtIeiI7CisJCWJyZWFrOworCWNhc2UgTElOS19TUFJFQURfMDVfRE9XTlNQUkVB
RF8zM0tIWjoKKwkJbHRfc3ByZWFkID0gIjAuNSUgMzNLSHoiOworCQlicmVhazsKKwlkZWZhdWx0
OgorCQlicmVhazsKKwl9CisKIAkvKiBDb25uZWN0aXZpdHkgbG9nOiBsaW5rIHRyYWluaW5nICov
Ci0JQ09OTl9NU0dfTFQobGluaywgIiVzeCVkICVzIFZTPSVkLCBQRT0lZCIsCi0JCQlsaW5rX3Jh
dGUsCi0JCQlsdF9zZXR0aW5ncy5saW5rX3NldHRpbmdzLmxhbmVfY291bnQsCi0JCQlsdF9yZXN1
bHQsCi0JCQlsdF9zZXR0aW5ncy5sYW5lX3NldHRpbmdzWzBdLlZPTFRBR0VfU1dJTkcsCi0JCQls
dF9zZXR0aW5ncy5sYW5lX3NldHRpbmdzWzBdLlBSRV9FTVBIQVNJUyk7CisJQ09OTl9NU0dfTFQo
bGluaywgIiVzeCVkICVzIFZTPSVkLCBQRT0lZCwgRFM9JXMiLAorCQkJCWxpbmtfcmF0ZSwKKwkJ
CQlsdF9zZXR0aW5ncy0+bGlua19zZXR0aW5ncy5sYW5lX2NvdW50LAorCQkJCWx0X3Jlc3VsdCwK
KwkJCQlsdF9zZXR0aW5ncy0+bGFuZV9zZXR0aW5nc1swXS5WT0xUQUdFX1NXSU5HLAorCQkJCWx0
X3NldHRpbmdzLT5sYW5lX3NldHRpbmdzWzBdLlBSRV9FTVBIQVNJUywKKwkJCQlsdF9zcHJlYWQp
OworfQorCitib29sIGRjX2xpbmtfZHBfcGVyZm9ybV9saW5rX3RyYWluaW5nX3NraXBfYXV4KAor
CXN0cnVjdCBkY19saW5rICpsaW5rLAorCWNvbnN0IHN0cnVjdCBkY19saW5rX3NldHRpbmdzICps
aW5rX3NldHRpbmcpCit7CisJc3RydWN0IGxpbmtfdHJhaW5pbmdfc2V0dGluZ3MgbHRfc2V0dGlu
Z3M7CisJZW51bSBkY19kcF90cmFpbmluZ19wYXR0ZXJuIHBhdHRlcm5fZm9yX2NyID0gRFBfVFJB
SU5JTkdfUEFUVEVSTl9TRVFVRU5DRV8xOworCisJaW5pdGlhbGl6ZV90cmFpbmluZ19zZXR0aW5n
cyhsaW5rLCBsaW5rX3NldHRpbmcsICZsdF9zZXR0aW5ncyk7CisKKwkvKiAxLiBQZXJmb3JtX2Ns
b2NrX3JlY292ZXJ5X3NlcXVlbmNlLiAqLworCisJLyogdHJhbnNtaXQgdHJhaW5pbmcgcGF0dGVy
biBmb3IgY2xvY2sgcmVjb3ZlcnkgKi8KKwlkcF9zZXRfaHdfdHJhaW5pbmdfcGF0dGVybihsaW5r
LCBwYXR0ZXJuX2Zvcl9jcik7CisKKwkvKiBjYWxsIEhXU1MgdG8gc2V0IGxhbmUgc2V0dGluZ3Mq
LworCWRwX3NldF9od19sYW5lX3NldHRpbmdzKGxpbmssICZsdF9zZXR0aW5ncyk7CisKKwkvKiB3
YWl0IHJlY2VpdmVyIHRvIGxvY2stb24qLworCXdhaXRfZm9yX3RyYWluaW5nX2F1eF9yZF9pbnRl
cnZhbChsaW5rLCBsdF9zZXR0aW5ncy5jcl9wYXR0ZXJuX3RpbWUpOworCisJLyogMi4gUGVyZm9y
bV9jaGFubmVsX2VxdWFsaXphdGlvbl9zZXF1ZW5jZS4gKi8KKworCS8qIHRyYW5zbWl0IHRyYWlu
aW5nIHBhdHRlcm4gZm9yIGNoYW5uZWwgZXF1YWxpemF0aW9uLiAqLworCWRwX3NldF9od190cmFp
bmluZ19wYXR0ZXJuKGxpbmssIGx0X3NldHRpbmdzLnBhdHRlcm5fZm9yX2VxKTsKKworCS8qIGNh
bGwgSFdTUyB0byBzZXQgbGFuZSBzZXR0aW5ncyovCisJZHBfc2V0X2h3X2xhbmVfc2V0dGluZ3Mo
bGluaywgJmx0X3NldHRpbmdzKTsKKworCS8qIHdhaXQgcmVjZWl2ZXIgdG8gbG9jay1vbi4gKi8K
Kwl3YWl0X2Zvcl90cmFpbmluZ19hdXhfcmRfaW50ZXJ2YWwobGluaywgbHRfc2V0dGluZ3MuZXFf
cGF0dGVybl90aW1lKTsKKworCS8qIDMuIFBlcmZvcm1fbGlua190cmFpbmluZ19pbnQuICovCisK
KwkvKiBNYWlubGluayBvdXRwdXQgaWRsZSBwYXR0ZXJuLiAqLworCWRwX3NldF9od190ZXN0X3Bh
dHRlcm4obGluaywgRFBfVEVTVF9QQVRURVJOX1ZJREVPX01PREUsIE5VTEwsIDApOworCisJcHJp
bnRfc3RhdHVzX21lc3NhZ2UobGluaywgJmx0X3NldHRpbmdzLCBMSU5LX1RSQUlOSU5HX1NVQ0NF
U1MpOworCisJcmV0dXJuIHRydWU7Cit9CisKK2VudW0gbGlua190cmFpbmluZ19yZXN1bHQgZGNf
bGlua19kcF9wZXJmb3JtX2xpbmtfdHJhaW5pbmcoCisJc3RydWN0IGRjX2xpbmsgKmxpbmssCisJ
Y29uc3Qgc3RydWN0IGRjX2xpbmtfc2V0dGluZ3MgKmxpbmtfc2V0dGluZywKKwlib29sIHNraXBf
dmlkZW9fcGF0dGVybikKK3sKKwllbnVtIGxpbmtfdHJhaW5pbmdfcmVzdWx0IHN0YXR1cyA9IExJ
TktfVFJBSU5JTkdfU1VDQ0VTUzsKKworCXN0cnVjdCBsaW5rX3RyYWluaW5nX3NldHRpbmdzIGx0
X3NldHRpbmdzOworCisJaW5pdGlhbGl6ZV90cmFpbmluZ19zZXR0aW5ncyhsaW5rLCBsaW5rX3Nl
dHRpbmcsICZsdF9zZXR0aW5ncyk7CisKKwkvKiAxLiBzZXQgbGluayByYXRlLCBsYW5lIGNvdW50
IGFuZCBzcHJlYWQuICovCisJZHBjZF9zZXRfbGlua19zZXR0aW5ncyhsaW5rLCAmbHRfc2V0dGlu
Z3MpOworCisJLyogMi4gcGVyZm9ybSBsaW5rIHRyYWluaW5nIChzZXQgbGluayB0cmFpbmluZyBk
b25lCisJICogIHRvIGZhbHNlIGlzIGRvbmUgYXMgd2VsbCkKKwkgKi8KKwlzdGF0dXMgPSBwZXJm
b3JtX2Nsb2NrX3JlY292ZXJ5X3NlcXVlbmNlKGxpbmssICZsdF9zZXR0aW5ncyk7CisJaWYgKHN0
YXR1cyA9PSBMSU5LX1RSQUlOSU5HX1NVQ0NFU1MpIHsKKwkJc3RhdHVzID0gcGVyZm9ybV9jaGFu
bmVsX2VxdWFsaXphdGlvbl9zZXF1ZW5jZShsaW5rLAorCQkJCSZsdF9zZXR0aW5ncyk7CisJfQor
CisJaWYgKChzdGF0dXMgPT0gTElOS19UUkFJTklOR19TVUNDRVNTKSB8fCAhc2tpcF92aWRlb19w
YXR0ZXJuKSB7CisJCXN0YXR1cyA9IHBlcmZvcm1fbGlua190cmFpbmluZ19pbnQobGluaywKKwkJ
CQkmbHRfc2V0dGluZ3MsCisJCQkJc3RhdHVzKTsKKwl9CisKKwkvKiA2LiBwcmludCBzdGF0dXMg
bWVzc2FnZSovCisJcHJpbnRfc3RhdHVzX21lc3NhZ2UobGluaywgJmx0X3NldHRpbmdzLCBzdGF0
dXMpOwogCiAJaWYgKHN0YXR1cyAhPSBMSU5LX1RSQUlOSU5HX1NVQ0NFU1MpCiAJCWxpbmstPmN0
eC0+ZGMtPmRlYnVnX2RhdGEubHRGYWlsQ291bnQrKzsKQEAgLTEwNzEsNyArMTIxMSw2IEBAIGVu
dW0gbGlua190cmFpbmluZ19yZXN1bHQgZGNfbGlua19kcF9wZXJmb3JtX2xpbmtfdHJhaW5pbmco
CiAJcmV0dXJuIHN0YXR1czsKIH0KIAotCiBib29sIHBlcmZvcm1fbGlua190cmFpbmluZ193aXRo
X3JldHJpZXMoCiAJc3RydWN0IGRjX2xpbmsgKmxpbmssCiAJY29uc3Qgc3RydWN0IGRjX2xpbmtf
c2V0dGluZ3MgKmxpbmtfc2V0dGluZywKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9jb3JlL2RjX2xpbmtfaHdzcy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNw
bGF5L2RjL2NvcmUvZGNfbGlua19od3NzLmMKaW5kZXggMmQwMTllMWY2MTM1Li4yMTFmYWRlZmUy
ZjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9jb3JlL2RjX2xp
bmtfaHdzcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9jb3JlL2RjX2xp
bmtfaHdzcy5jCkBAIC0yNSwxMCArMjUsMTEgQEAgZW51bSBkY19zdGF0dXMgY29yZV9saW5rX3Jl
YWRfZHBjZCgKIAl1aW50OF90ICpkYXRhLAogCXVpbnQzMl90IHNpemUpCiB7Ci0JaWYgKCFkbV9o
ZWxwZXJzX2RwX3JlYWRfZHBjZChsaW5rLT5jdHgsCi0JCQlsaW5rLAotCQkJYWRkcmVzcywgZGF0
YSwgc2l6ZSkpCi0JCQlyZXR1cm4gRENfRVJST1JfVU5FWFBFQ1RFRDsKKwlpZiAoIWxpbmstPmF1
eF9hY2Nlc3NfZGlzYWJsZWQgJiYKKwkJCSFkbV9oZWxwZXJzX2RwX3JlYWRfZHBjZChsaW5rLT5j
dHgsCisJCQlsaW5rLCBhZGRyZXNzLCBkYXRhLCBzaXplKSkgeworCQlyZXR1cm4gRENfRVJST1Jf
VU5FWFBFQ1RFRDsKKwl9CiAKIAlyZXR1cm4gRENfT0s7CiB9CkBAIC0zOSwxMCArNDAsMTEgQEAg
ZW51bSBkY19zdGF0dXMgY29yZV9saW5rX3dyaXRlX2RwY2QoCiAJY29uc3QgdWludDhfdCAqZGF0
YSwKIAl1aW50MzJfdCBzaXplKQogewotCWlmICghZG1faGVscGVyc19kcF93cml0ZV9kcGNkKGxp
bmstPmN0eCwKLQkJCWxpbmssCi0JCQlhZGRyZXNzLCBkYXRhLCBzaXplKSkKLQkJCQlyZXR1cm4g
RENfRVJST1JfVU5FWFBFQ1RFRDsKKwlpZiAoIWxpbmstPmF1eF9hY2Nlc3NfZGlzYWJsZWQgJiYK
KwkJCSFkbV9oZWxwZXJzX2RwX3dyaXRlX2RwY2QobGluay0+Y3R4LAorCQkJbGluaywgYWRkcmVz
cywgZGF0YSwgc2l6ZSkpIHsKKwkJcmV0dXJuIERDX0VSUk9SX1VORVhQRUNURUQ7CisJfQogCiAJ
cmV0dXJuIERDX09LOwogfQpAQCAtMjAzLDIxICsyMDUsMjEgQEAgdm9pZCBkcF9kaXNhYmxlX2xp
bmtfcGh5X21zdChzdHJ1Y3QgZGNfbGluayAqbGluaywgZW51bSBzaWduYWxfdHlwZSBzaWduYWwp
CiAKIGJvb2wgZHBfc2V0X2h3X3RyYWluaW5nX3BhdHRlcm4oCiAJc3RydWN0IGRjX2xpbmsgKmxp
bmssCi0JZW51bSBod19kcF90cmFpbmluZ19wYXR0ZXJuIHBhdHRlcm4pCisJZW51bSBkY19kcF90
cmFpbmluZ19wYXR0ZXJuIHBhdHRlcm4pCiB7CiAJZW51bSBkcF90ZXN0X3BhdHRlcm4gdGVzdF9w
YXR0ZXJuID0gRFBfVEVTVF9QQVRURVJOX1VOU1VQUE9SVEVEOwogCiAJc3dpdGNoIChwYXR0ZXJu
KSB7Ci0JY2FzZSBIV19EUF9UUkFJTklOR19QQVRURVJOXzE6CisJY2FzZSBEUF9UUkFJTklOR19Q
QVRURVJOX1NFUVVFTkNFXzE6CiAJCXRlc3RfcGF0dGVybiA9IERQX1RFU1RfUEFUVEVSTl9UUkFJ
TklOR19QQVRURVJOMTsKIAkJYnJlYWs7Ci0JY2FzZSBIV19EUF9UUkFJTklOR19QQVRURVJOXzI6
CisJY2FzZSBEUF9UUkFJTklOR19QQVRURVJOX1NFUVVFTkNFXzI6CiAJCXRlc3RfcGF0dGVybiA9
IERQX1RFU1RfUEFUVEVSTl9UUkFJTklOR19QQVRURVJOMjsKIAkJYnJlYWs7Ci0JY2FzZSBIV19E
UF9UUkFJTklOR19QQVRURVJOXzM6CisJY2FzZSBEUF9UUkFJTklOR19QQVRURVJOX1NFUVVFTkNF
XzM6CiAJCXRlc3RfcGF0dGVybiA9IERQX1RFU1RfUEFUVEVSTl9UUkFJTklOR19QQVRURVJOMzsK
IAkJYnJlYWs7Ci0JY2FzZSBIV19EUF9UUkFJTklOR19QQVRURVJOXzQ6CisJY2FzZSBEUF9UUkFJ
TklOR19QQVRURVJOX1NFUVVFTkNFXzQ6CiAJCXRlc3RfcGF0dGVybiA9IERQX1RFU1RfUEFUVEVS
Tl9UUkFJTklOR19QQVRURVJONDsKIAkJYnJlYWs7CiAJZGVmYXVsdDoKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY19kcF90eXBlcy5oIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2RjX2RwX3R5cGVzLmgKaW5kZXggZGZjZWM0ZDNlOWMwLi5lZmE3
YTQ3ZjZiN2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY19k
cF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY19kcF90eXBl
cy5oCkBAIC05MCw2ICs5MCwxMyBAQCBlbnVtIGRjX3Bvc3RfY3Vyc29yMiB7CiAJUE9TVF9DVVJT
T1IyX01BWF9MRVZFTCA9IFBPU1RfQ1VSU09SMl9MRVZFTDMsCiB9OwogCitlbnVtIGRjX2RwX3Ry
YWluaW5nX3BhdHRlcm4geworCURQX1RSQUlOSU5HX1BBVFRFUk5fU0VRVUVOQ0VfMSA9IDAsCisJ
RFBfVFJBSU5JTkdfUEFUVEVSTl9TRVFVRU5DRV8yLAorCURQX1RSQUlOSU5HX1BBVFRFUk5fU0VR
VUVOQ0VfMywKKwlEUF9UUkFJTklOR19QQVRURVJOX1NFUVVFTkNFXzQsCit9OworCiBzdHJ1Y3Qg
ZGNfbGlua19zZXR0aW5ncyB7CiAJZW51bSBkY19sYW5lX2NvdW50IGxhbmVfY291bnQ7CiAJZW51
bSBkY19saW5rX3JhdGUgbGlua19yYXRlOwpAQCAtMTA5LDYgKzExNiwyMCBAQCBzdHJ1Y3QgZGNf
bGlua190cmFpbmluZ19zZXR0aW5ncyB7CiAJc3RydWN0IGRjX2xhbmVfc2V0dGluZ3MgbGFuZV9z
ZXR0aW5nc1tMQU5FX0NPVU5UX0RQX01BWF07CiB9OwogCitzdHJ1Y3QgZGNfbGlua190cmFpbmlu
Z19vdmVycmlkZXMgeworCWVudW0gZGNfdm9sdGFnZV9zd2luZyAqdm9sdGFnZV9zd2luZzsKKwll
bnVtIGRjX3ByZV9lbXBoYXNpcyAqcHJlX2VtcGhhc2lzOworCWVudW0gZGNfcG9zdF9jdXJzb3Iy
ICpwb3N0X2N1cnNvcjI7CisKKwl1aW50MTZfdCAqY3JfcGF0dGVybl90aW1lOworCXVpbnQxNl90
ICplcV9wYXR0ZXJuX3RpbWU7CisJZW51bSBkY19kcF90cmFpbmluZ19wYXR0ZXJuICpwYXR0ZXJu
X2Zvcl9lcTsKKworCWVudW0gZGNfbGlua19zcHJlYWQgKmRvd25zcHJlYWQ7CisJYm9vbCAqYWx0
ZXJuYXRlX3NjcmFtYmxlcl9yZXNldDsKKwlib29sICplbmhhbmNlZF9mcmFtaW5nOworCWJvb2wg
KmZlY19lbmFibGU7Cit9OwogCiB1bmlvbiBkcGNkX3JldiB7CiAJc3RydWN0IHsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY19saW5rLmggYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNfbGluay5oCmluZGV4IDZmMGI4MDExMWU1OC4uZDZmZjVh
ZjcwYzcxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNfbGlu
ay5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY19saW5rLmgKQEAgLTgz
LDYgKzgzLDcgQEAgc3RydWN0IGRjX2xpbmsgewogCWJvb2wgaXNfaHBkX2ZpbHRlcl9kaXNhYmxl
ZDsKIAlib29sIGRwX3NzX29mZjsKIAlib29sIGxpbmtfc3RhdGVfdmFsaWQ7CisJYm9vbCBhdXhf
YWNjZXNzX2Rpc2FibGVkOwogCiAJLyogY2FwcyBpcyB0aGUgc2FtZSBhcyByZXBvcnRlZF9saW5r
X2NhcC4gbGlua190cmFpbmcgdXNlCiAJICogcmVwb3J0ZWRfbGlua19jYXAuIFdpbGwgY2xlYW4g
dXAuICBUT0RPCkBAIC05Miw2ICs5Myw3IEBAIHN0cnVjdCBkY19saW5rIHsKIAlzdHJ1Y3QgZGNf
bGlua19zZXR0aW5ncyBjdXJfbGlua19zZXR0aW5nczsKIAlzdHJ1Y3QgZGNfbGFuZV9zZXR0aW5n
cyBjdXJfbGFuZV9zZXR0aW5nOwogCXN0cnVjdCBkY19saW5rX3NldHRpbmdzIHByZWZlcnJlZF9s
aW5rX3NldHRpbmc7CisJc3RydWN0IGRjX2xpbmtfdHJhaW5pbmdfb3ZlcnJpZGVzIHByZWZlcnJl
ZF90cmFpbmluZ19zZXR0aW5nczsKIAogCXVpbnQ4X3QgZGRjX2h3X2luc3Q7CiAKQEAgLTIxNyw2
ICsyMTksMTAgQEAgdm9pZCBkY19saW5rX2RwX3NldF9kcml2ZV9zZXR0aW5ncygKIAlzdHJ1Y3Qg
ZGNfbGluayAqbGluaywKIAlzdHJ1Y3QgbGlua190cmFpbmluZ19zZXR0aW5ncyAqbHRfc2V0dGlu
Z3MpOwogCitib29sIGRjX2xpbmtfZHBfcGVyZm9ybV9saW5rX3RyYWluaW5nX3NraXBfYXV4KAor
CXN0cnVjdCBkY19saW5rICpsaW5rLAorCWNvbnN0IHN0cnVjdCBkY19saW5rX3NldHRpbmdzICps
aW5rX3NldHRpbmcpOworCiBlbnVtIGxpbmtfdHJhaW5pbmdfcmVzdWx0IGRjX2xpbmtfZHBfcGVy
Zm9ybV9saW5rX3RyYWluaW5nKAogCXN0cnVjdCBkY19saW5rICpsaW5rLAogCWNvbnN0IHN0cnVj
dCBkY19saW5rX3NldHRpbmdzICpsaW5rX3NldHRpbmcsCkBAIC0yNTEsNiArMjU3LDExIEBAIHZv
aWQgZGNfbGlua19wZXJmb3JtX2xpbmtfdHJhaW5pbmcoc3RydWN0IGRjICpkYywKIHZvaWQgZGNf
bGlua19zZXRfcHJlZmVycmVkX2xpbmtfc2V0dGluZ3Moc3RydWN0IGRjICpkYywKIAkJCQkJIHN0
cnVjdCBkY19saW5rX3NldHRpbmdzICpsaW5rX3NldHRpbmcsCiAJCQkJCSBzdHJ1Y3QgZGNfbGlu
ayAqbGluayk7Cit2b2lkIGRjX2xpbmtfc2V0X3ByZWZlcnJlZF90cmFpbmluZ19zZXR0aW5ncyhz
dHJ1Y3QgZGMgKmRjLAorCQkJCQlzdHJ1Y3QgZGNfbGlua19zZXR0aW5ncyAqbGlua19zZXR0aW5n
LAorCQkJCQlzdHJ1Y3QgZGNfbGlua190cmFpbmluZ19vdmVycmlkZXMgKmx0X292ZXJyaWRlcywK
KwkJCQkJc3RydWN0IGRjX2xpbmsgKmxpbmssCisJCQkJCWJvb2wgc2tpcF9pbW1lZGlhdGVfcmV0
cmFpbik7CiB2b2lkIGRjX2xpbmtfZW5hYmxlX2hwZChjb25zdCBzdHJ1Y3QgZGNfbGluayAqbGlu
ayk7CiB2b2lkIGRjX2xpbmtfZGlzYWJsZV9ocGQoY29uc3Qgc3RydWN0IGRjX2xpbmsgKmxpbmsp
Owogdm9pZCBkY19saW5rX3NldF90ZXN0X3BhdHRlcm4oc3RydWN0IGRjX2xpbmsgKmxpbmssCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2xpbmtfaHdzcy5o
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9saW5rX2h3c3MuaAppbmRleCAz
MGJlN2JiNGEwMWEuLjM2ODA4NDY2NzRlOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9kaXNwbGF5L2RjL2luYy9saW5rX2h3c3MuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvaW5jL2xpbmtfaHdzcy5oCkBAIC02MCw3ICs2MCw3IEBAIHZvaWQgZHBfZGlzYWJs
ZV9saW5rX3BoeV9tc3Qoc3RydWN0IGRjX2xpbmsgKmxpbmssIGVudW0gc2lnbmFsX3R5cGUgc2ln
bmFsKTsKIAogYm9vbCBkcF9zZXRfaHdfdHJhaW5pbmdfcGF0dGVybigKIAlzdHJ1Y3QgZGNfbGlu
ayAqbGluaywKLQllbnVtIGh3X2RwX3RyYWluaW5nX3BhdHRlcm4gcGF0dGVybik7CisJZW51bSBk
Y19kcF90cmFpbmluZ19wYXR0ZXJuIHBhdHRlcm4pOwogCiB2b2lkIGRwX3NldF9od19sYW5lX3Nl
dHRpbmdzKAogCXN0cnVjdCBkY19saW5rICpsaW5rLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2luY2x1ZGUvbGlua19zZXJ2aWNlX3R5cGVzLmggYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvaW5jbHVkZS9saW5rX3NlcnZpY2VfdHlwZXMuaAppbmRleCA4MGYw
ZDkzY2ZkOTQuLjg3NmIwYjNlMWE5YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2luY2x1ZGUvbGlua19zZXJ2aWNlX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2luY2x1ZGUvbGlua19zZXJ2aWNlX3R5cGVzLmgKQEAgLTcxLDE0ICs3MSwx
NyBAQCBlbnVtIGxpbmtfdHJhaW5pbmdfcmVzdWx0IHsKIHN0cnVjdCBsaW5rX3RyYWluaW5nX3Nl
dHRpbmdzIHsKIAlzdHJ1Y3QgZGNfbGlua19zZXR0aW5ncyBsaW5rX3NldHRpbmdzOwogCXN0cnVj
dCBkY19sYW5lX3NldHRpbmdzIGxhbmVfc2V0dGluZ3NbTEFORV9DT1VOVF9EUF9NQVhdOwotCWJv
b2wgYWxsb3dfaW52YWxpZF9tc2FfdGltaW5nX3BhcmFtOwotfTsKIAotZW51bSBod19kcF90cmFp
bmluZ19wYXR0ZXJuIHsKLQlIV19EUF9UUkFJTklOR19QQVRURVJOXzEgPSAwLAotCUhXX0RQX1RS
QUlOSU5HX1BBVFRFUk5fMiwKLQlIV19EUF9UUkFJTklOR19QQVRURVJOXzMsCi0JSFdfRFBfVFJB
SU5JTkdfUEFUVEVSTl80CisJZW51bSBkY192b2x0YWdlX3N3aW5nICp2b2x0YWdlX3N3aW5nOwor
CWVudW0gZGNfcHJlX2VtcGhhc2lzICpwcmVfZW1waGFzaXM7CisJZW51bSBkY19wb3N0X2N1cnNv
cjIgKnBvc3RfY3Vyc29yMjsKKworCXVpbnQxNl90IGNyX3BhdHRlcm5fdGltZTsKKwl1aW50MTZf
dCBlcV9wYXR0ZXJuX3RpbWU7CisJZW51bSBkY19kcF90cmFpbmluZ19wYXR0ZXJuIHBhdHRlcm5f
Zm9yX2VxOworCisJYm9vbCBlbmhhbmNlZF9mcmFtaW5nOworCWJvb2wgYWxsb3dfaW52YWxpZF9t
c2FfdGltaW5nX3BhcmFtOwogfTsKIAogLypUT0RPOiBNb3ZlIHRoaXMgZW51bSB0ZXN0IGhhcm5l
c3MqLwotLSAKMi4yMi4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
