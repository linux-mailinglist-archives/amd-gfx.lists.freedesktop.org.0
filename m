Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 65249105AA0
	for <lists+amd-gfx@lfdr.de>; Thu, 21 Nov 2019 20:53:26 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E94476E199;
	Thu, 21 Nov 2019 19:53:24 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-lj1-x242.google.com (mail-lj1-x242.google.com
 [IPv6:2a00:1450:4864:20::242])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7CE156E199
 for <amd-gfx@lists.freedesktop.org>; Thu, 21 Nov 2019 19:53:23 +0000 (UTC)
Received: by mail-lj1-x242.google.com with SMTP id n5so4600657ljc.9
 for <amd-gfx@lists.freedesktop.org>; Thu, 21 Nov 2019 11:53:23 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=mE7p5zXxApFqGfht9kLCUWMQXJ0VsDZxjmrL2cCm7/w=;
 b=OnVK61gDgqXDERKFXt7a5htLrU5KZBat5yJPsmJVqxyjVMXf2u+Gry0yBlqsdWi+TJ
 LIXnA3sLl9wBs1cT9JJBS65dEhUplyIHQ3rc1N5nzhbhVjFvAiAlM3YUuAoEv5GaG9CD
 LRH9kiYbt/3nzN5fUGaaKQpRy43go/eZCyxRDJfu6zP2kpFadANE7z4ewjSunnTGpyNL
 vOIgmM9AblbfpjQUyqxpqqguU5nqNYW7ddv5K52h1ekceVCUar0nVzgGdhFcKEFn7DfS
 x/6TSX+UbFVqGyQzwo/+oKtbVy86YFgQC1sarMFYf9t1OcwAdHvVuD8vXMobQGkFW2fs
 HG4A==
X-Gm-Message-State: APjAAAUKdKCK/3nG415C/rxO0/N3zNKAFMLqsGi9iEvcHD/YgzFPtsxe
 N5K/eG4jhNMzAJkveqoxWHlIbOQOsNYwaG4+nds=
X-Google-Smtp-Source: APXvYqz6le+AkJUSRc7y1ZGGoEcQP2aElNul/odMwb7k3ChwTWi6vUFJTeyu4vKB5e5G1qtQGHvLhl2oSmH37Uu2Ahc=
X-Received: by 2002:a05:651c:87:: with SMTP id 7mr9475414ljq.20.1574366001577; 
 Thu, 21 Nov 2019 11:53:21 -0800 (PST)
MIME-Version: 1.0
References: <20191121165529.3941-1-alexander.deucher@amd.com>
In-Reply-To: <20191121165529.3941-1-alexander.deucher@amd.com>
From: Dave Airlie <airlied@gmail.com>
Date: Fri, 22 Nov 2019 05:53:10 +1000
Message-ID: <CAPM=9twAwCJaXHS=cWNCihsyfydAKqQ1igjLt1g_vbFBL0bdMg@mail.gmail.com>
Subject: Re: [PATCH] drm/amdgpu: move pci handling out of pm ops
To: Alex Deucher <alexdeucher@gmail.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=mE7p5zXxApFqGfht9kLCUWMQXJ0VsDZxjmrL2cCm7/w=;
 b=BhYeOuL5XTT8e89IfBCOiniMAUmWxeO42gkFQQBOZE1sUh8y745cQ7JtfspDw3K60m
 dkzAiCEt+opIA4svTVwNAV8sybcNHRYVCfqT9LFyPCxTdVowzy+lcoT6/TbXSpo53OFl
 jFoq+l6uQVaizyu2KVS3NeQj9hICk0Ec7K01nT9UF8ncAQZhD4hzbbwxpcN4U5vxWEK5
 aAb5lzKbZpqxr6oAB1Sxov4LjCVIq/1cwjRUQxT2dBG0iXivQV+kYLgzheSIz/yjVm0B
 6hYGni1U9Y6jnuMGH4nQpnWNk3aqbyKtWldPlvFfDYpgV3706OIW4eCt1jQGmAyU+JdF
 6biA==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>,
 amd-gfx mailing list <amd-gfx@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

T24gRnJpLCAyMiBOb3YgMjAxOSBhdCAwMjo1NSwgQWxleCBEZXVjaGVyIDxhbGV4ZGV1Y2hlckBn
bWFpbC5jb20+IHdyb3RlOgo+Cj4gVGhlIGRvY3VtZW50YXRpb24gc2F5cyB0aGUgdGhhdCBQQ0kg
Y29yZSBoYW5kbGVzIHRoaXMKPiBmb3IgeW91IHVubGVzcyB5b3UgY2hvb3NlIHRvIGltcGxlbWVu
dCBpdC4gIEp1c3QgcmVseQo+IG9uIHRoZSBQQ0kgY29yZSB0byBoYW5kbGUgdGhlIHBjaSBzcGVj
aWZpYyBiaXRzLgo+Cj4gU2lnbmVkLW9mZi1ieTogQWxleCBEZXVjaGVyIDxhbGV4YW5kZXIuZGV1
Y2hlckBhbWQuY29tPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUu
aCAgICAgICAgfCAgNCArLS0KPiAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rl
dmljZS5jIHwgMzMgKysrKysrKysrLS0tLS0tLS0tLS0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfZHJ2LmMgICAgfCAxNiArKysrKy0tLS0tLQo+ICAzIGZpbGVzIGNoYW5n
ZWQsIDI0IGluc2VydGlvbnMoKyksIDI5IGRlbGV0aW9ucygtKQo+Cj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1LmgKPiBpbmRleCA5Nzg0MzQ2MmMyZmIuLjJlOWQwYmUwNWYyZiAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaAo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5oCj4gQEAgLTExOTEsOCArMTE5MSw4IEBAIGlu
dCBhbWRncHVfZHJpdmVyX29wZW5fa21zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBk
cm1fZmlsZSAqZmlsZV9wcml2KTsKPiAgdm9pZCBhbWRncHVfZHJpdmVyX3Bvc3RjbG9zZV9rbXMo
c3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdik7Cj4gIGludCBhbWRncHVfZGV2aWNlX2lwX3N1
c3BlbmQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpOwo+IC1pbnQgYW1kZ3B1X2RldmljZV9z
dXNwZW5kKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGJvb2wgc3VzcGVuZCwgYm9vbCBmYmNvbik7
Cj4gLWludCBhbWRncHVfZGV2aWNlX3Jlc3VtZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBib29s
IHJlc3VtZSwgYm9vbCBmYmNvbik7Cj4gK2ludCBhbWRncHVfZGV2aWNlX3N1c3BlbmQoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwgYm9vbCBmYmNvbik7Cj4gK2ludCBhbWRncHVfZGV2aWNlX3Jlc3Vt
ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBib29sIGZiY29uKTsKPiAgdTMyIGFtZGdwdV9nZXRf
dmJsYW5rX2NvdW50ZXJfa21zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBw
aXBlKTsKPiAgaW50IGFtZGdwdV9lbmFibGVfdmJsYW5rX2ttcyhzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSk7Cj4gIHZvaWQgYW1kZ3B1X2Rpc2FibGVfdmJsYW5rX2tt
cyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSk7Cj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYwo+IGluZGV4IGIxNDA4YzVlNDY0MC4u
ZDgzMmJkMjJiYTlkIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9kZXZpY2UuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9k
ZXZpY2UuYwo+IEBAIC0xMDkwLDYgKzEwOTAsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV9kZXZpY2Vf
Y2hlY2tfYXJndW1lbnRzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQo+ICBzdGF0aWMgdm9p
ZCBhbWRncHVfc3dpdGNoZXJvb19zZXRfc3RhdGUoc3RydWN0IHBjaV9kZXYgKnBkZXYsIGVudW0g
dmdhX3N3aXRjaGVyb29fc3RhdGUgc3RhdGUpCj4gIHsKPiAgICAgICAgIHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSBwY2lfZ2V0X2RydmRhdGEocGRldik7Cj4gKyAgICAgICBpbnQgcjsKPgo+ICAg
ICAgICAgaWYgKGFtZGdwdV9kZXZpY2Vfc3VwcG9ydHNfYm9jbyhkZXYpICYmIHN0YXRlID09IFZH
QV9TV0lUQ0hFUk9PX09GRikKPiAgICAgICAgICAgICAgICAgcmV0dXJuOwo+IEBAIC0xMDk5LDcg
KzExMDAsMTIgQEAgc3RhdGljIHZvaWQgYW1kZ3B1X3N3aXRjaGVyb29fc2V0X3N0YXRlKHN0cnVj
dCBwY2lfZGV2ICpwZGV2LCBlbnVtIHZnYV9zd2l0Y2hlcm8KPiAgICAgICAgICAgICAgICAgLyog
ZG9uJ3Qgc3VzcGVuZCBvciByZXN1bWUgY2FyZCBub3JtYWxseSAqLwo+ICAgICAgICAgICAgICAg
ICBkZXYtPnN3aXRjaF9wb3dlcl9zdGF0ZSA9IERSTV9TV0lUQ0hfUE9XRVJfQ0hBTkdJTkc7Cj4K
PiAtICAgICAgICAgICAgICAgYW1kZ3B1X2RldmljZV9yZXN1bWUoZGV2LCB0cnVlLCB0cnVlKTsK
PiArICAgICAgICAgICAgICAgcGNpX3NldF9wb3dlcl9zdGF0ZShkZXYtPnBkZXYsIFBDSV9EMCk7
Cj4gKyAgICAgICAgICAgICAgIHBjaV9yZXN0b3JlX3N0YXRlKGRldi0+cGRldik7Cj4gKyAgICAg
ICAgICAgICAgIHIgPSBwY2lfZW5hYmxlX2RldmljZShkZXYtPnBkZXYpOwo+ICsgICAgICAgICAg
ICAgICBpZiAocikKPiArICAgICAgICAgICAgICAgICAgICAgICBEUk1fV0FSTigicGNpX2VuYWJs
ZV9kZXZpY2UgZmFpbGVkICglZClcbiIsIHIpOwo+ICsgICAgICAgICAgICAgICBhbWRncHVfZGV2
aWNlX3Jlc3VtZShkZXYsIHRydWUpOwo+Cj4gICAgICAgICAgICAgICAgIGRldi0+c3dpdGNoX3Bv
d2VyX3N0YXRlID0gRFJNX1NXSVRDSF9QT1dFUl9PTjsKPiAgICAgICAgICAgICAgICAgZHJtX2tt
c19oZWxwZXJfcG9sbF9lbmFibGUoZGV2KTsKPiBAQCAtMTEwNyw3ICsxMTEzLDExIEBAIHN0YXRp
YyB2b2lkIGFtZGdwdV9zd2l0Y2hlcm9vX3NldF9zdGF0ZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwg
ZW51bSB2Z2Ffc3dpdGNoZXJvCj4gICAgICAgICAgICAgICAgIHByX2luZm8oImFtZGdwdTogc3dp
dGNoZWQgb2ZmXG4iKTsKPiAgICAgICAgICAgICAgICAgZHJtX2ttc19oZWxwZXJfcG9sbF9kaXNh
YmxlKGRldik7Cj4gICAgICAgICAgICAgICAgIGRldi0+c3dpdGNoX3Bvd2VyX3N0YXRlID0gRFJN
X1NXSVRDSF9QT1dFUl9DSEFOR0lORzsKPiAtICAgICAgICAgICAgICAgYW1kZ3B1X2RldmljZV9z
dXNwZW5kKGRldiwgdHJ1ZSwgdHJ1ZSk7Cj4gKyAgICAgICAgICAgICAgIGFtZGdwdV9kZXZpY2Vf
c3VzcGVuZChkZXYsIHRydWUpOwo+ICsgICAgICAgICAgICAgICBwY2lfc2F2ZV9zdGF0ZShkZXYt
PnBkZXYpOwo+ICsgICAgICAgICAgICAgICAvKiBTaHV0IGRvd24gdGhlIGRldmljZSAqLwo+ICsg
ICAgICAgICAgICAgICBwY2lfZGlzYWJsZV9kZXZpY2UoZGV2LT5wZGV2KTsKPiArICAgICAgICAg
ICAgICAgcGNpX3NldF9wb3dlcl9zdGF0ZShkZXYtPnBkZXYsIFBDSV9EM2NvbGQpOwoKCkkgdGhp
bmsgdGhpcyB3aWxsIGJyZWFrIEQzIGNvbGQgb24gQVRQWCBzeXN0ZW1zIChpLmUuIGJlZm9yZSBQ
Q0lFIGQzCmNvbGQgc3VwcG9ydCkuCgpJJ20gbm90IDEwMCUgc3VyZSBidXQgSSdkIHJlYWxseSBs
aWtlIHRvIHRlc3QgaXQsIGFzIEkgZG9uJ3QgdGhpbmsgdGhlCmNvcmUgd2lsbCBwdXQgdGhlIGRl
dmljZSBpbnRvIEQzY29sZCBmb3IgdXMgaGVyZS4KCkRhdmUuCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vYW1kLWdmeA==
