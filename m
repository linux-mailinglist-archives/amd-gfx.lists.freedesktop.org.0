Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 81D1238BC65
	for <lists+amd-gfx@lfdr.de>; Fri, 21 May 2021 04:23:22 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6E786887DE;
	Fri, 21 May 2021 02:23:15 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM11-CO1-obe.outbound.protection.outlook.com
 (mail-co1nam11on2079.outbound.protection.outlook.com [40.107.220.79])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 73F586E46B
 for <amd-gfx@lists.freedesktop.org>; Fri, 21 May 2021 02:23:14 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=KyOGau7MRjggi0P4abtaV6ygOADVSnxQD8uBpFivw80YmhwcuoE2dhp4vVBipzvz9lZPriVO8BnOSf1P0PCLAkRCUJZGzo1Tk2JStVZLsJ2vh56GVvxPs8IIqE5aZ778N9JArAFjmeDLIEFFUMptfJJYTe/S9MlP/NOY5mXvtX4SncdwwUOJa4Od4qWIjeW7OlMmfah10yK+aAq+IfwYBWkiahaeZCgsrJOP2Al+ARub5nEvAcpOCBWQhudr98eH7WDXJ93TACCxhMr+AfIR2f1KmvBPbGEgl6+0BnWGAvGtcvXTcqbyuK7y6KHyBM03zvOXJyX5id4GHr4krVUrPQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=J6FYOVm7OSpuTPVKTWeeCn+tgM7kwCLyIseosiadTKs=;
 b=lUxVwGRg3Gn+ukVrdS/6hBKRgNp5JA6ui52WWGkMLBRW7uUWpBCSDiMjDGRYO35Z9lbB2PRqc9Lec0bjxiwieHd9KV4q7tXUUj8dLkwzV9G9l93WQf67NKp0C6RO7pXAabdxVWCc5Y3q7fuRCBe1rOUGYiAVLZU6NfFdEPz7sOjU0kpvncrBqZN19vJXPGlJl19dBYT0fBGu+f2Tx5uUCpkyqRg0nKr9kLiJJLu0mLDKqvIZx9QO4I6pTHzImNuF0Se5INOk7rUNpGY+OYYknJCmHhogVuwKI9keES5OMAt5ka8iQol7fmJ3ghKV95PZ6KNiLvuYUYqfcFQZWHnP7Q==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=amd.com; s=selector1; 
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=J6FYOVm7OSpuTPVKTWeeCn+tgM7kwCLyIseosiadTKs=;
 b=a2VtnJUOxvTaM8Tbdmx5glxzGgRO1jOue79otV4QCnWOL0NeRKK8kpbqEfL8lp/gW9m3H+SXbdROLcARRD/upn0mQ4zHFsC8f+rYFPR/By+JJrs5glHOdsfm1K2G+JmlY6rLzSDUz9Hnjc6mECnRGA+KAtd/KDfNrb683/X9Qms=
Authentication-Results: lists.freedesktop.org; dkim=none (message not signed)
 header.d=none; lists.freedesktop.org;
 dmarc=none action=none header.from=amd.com;
Received: from BN9PR12MB5129.namprd12.prod.outlook.com (2603:10b6:408:136::12)
 by BN9PR12MB5049.namprd12.prod.outlook.com (2603:10b6:408:132::16)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4150.23; Fri, 21 May
 2021 02:23:12 +0000
Received: from BN9PR12MB5129.namprd12.prod.outlook.com
 ([fe80::3c78:e58b:fba7:b8dd]) by BN9PR12MB5129.namprd12.prod.outlook.com
 ([fe80::3c78:e58b:fba7:b8dd%6]) with mapi id 15.20.4129.034; Fri, 21 May 2021
 02:23:12 +0000
From: Felix Kuehling <Felix.Kuehling@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH v2 1/3] drm/amdgpu: Add new placement for preemptible SG BOs
Date: Thu, 20 May 2021 22:22:54 -0400
Message-Id: <20210521022256.14184-1-Felix.Kuehling@amd.com>
X-Mailer: git-send-email 2.31.1
X-Originating-IP: [165.204.55.251]
X-ClientProxiedBy: YTOPR0101CA0038.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:14::15) To BN9PR12MB5129.namprd12.prod.outlook.com
 (2603:10b6:408:136::12)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from Harpoon.amd.com (165.204.55.251) by
 YTOPR0101CA0038.CANPRD01.PROD.OUTLOOK.COM (2603:10b6:b00:14::15) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4108.30 via Frontend
 Transport; Fri, 21 May 2021 02:23:11 +0000
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 47e16009-700b-48fe-ba45-08d91bff61bb
X-MS-TrafficTypeDiagnostic: BN9PR12MB5049:
X-Microsoft-Antispam-PRVS: <BN9PR12MB504920CF8366A03565818C6292299@BN9PR12MB5049.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:10000;
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: 4P85MlqRTITQOF5VJ4DGJAsMl3VblAgBT6etptxhfpp8JAG22tKvghCfqo2uIv41Nhvjj2wyoWudmwN2BQkfwdXZYSqsjkh4s/929CKHFNrm/mau2MgZx08C3cEbrD+tTY2Vj5Ax1kZjSYoTNtL34nkWxyRB2SByMh0LvVjfD9g8dFTIR8PdD086iHpyWMFXydyom8iY21/1jENto7479qV5lg3HYf9dLGLmRIfDiF+/N5LhAPsUmTmjiamA8IVYcYsL1YycyS9EUijVTXkEBg+lQmOYZ1tr56pGViCIpnkG0oA29M0GG9VPCpfnfm6cLt2yNcsNPgIJeLKudbCoHw67DL1mWk2vn9S/xp4t4aL7G1pw1QJCTZTjT5jkSNYQE1C87e9ehWP5LUtzqx1R1ZM6qsrMzWmq6hsn+QcclDaa3JGWv5u2dtugvvzFDUwia1GSzrBZ3PVIZLwQa/RZqE/CRRQAmjBV6GL48XcWzrda2HS1DBKPhTV6A3rk/lr63SKYk2zZlRLiyI8nqPx1ndKUvAIMm9FX1AxLAnmFPuXbdWud4iWH8/9m3Fd0XffTdq2FwiXZUMYLg66C2uVzav0ym7WIzwq9whkVS2nnPmmAF9qwK/yBMLJ9YAu/IQHliNOVXFeoWFw+Vfwel2uLqg1dP+VeDfevF13icreao+U=
X-Forefront-Antispam-Report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:BN9PR12MB5129.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(4636009)(346002)(376002)(396003)(136003)(39860400002)(366004)(38100700002)(36756003)(8676002)(2616005)(316002)(38350700002)(956004)(30864003)(8936002)(26005)(5660300002)(2906002)(6666004)(6486002)(1076003)(478600001)(66574015)(66556008)(16526019)(66476007)(86362001)(6916009)(52116002)(7696005)(186003)(83380400001)(66946007);
 DIR:OUT; SFP:1101; 
X-MS-Exchange-AntiSpam-MessageData: =?utf-8?B?NG0vOUxSSFBHaWk0djFrMkkxaG12cVZxSG9ySXU0MHJacCs0WG8wVUNWc3hD?=
 =?utf-8?B?YlBlR3loTXFkbGRZWTB6QjUwSkRiZGZkY3AybjEvUlRwYSt5ZEFsbWtWNWdT?=
 =?utf-8?B?WEJVYVBkRUJ0cUNZWGlsN0hZTWNuc2dPU2kyWXpZOHMzNFJkckdFb29mbFg3?=
 =?utf-8?B?S2dHY0VDQk9zQmo3MjYwL0NFbVdOVDI0d2R3MVBvL1YrSmNwUDIxeTdsWHBI?=
 =?utf-8?B?QUVsb1E2NUJFbWY0eUxDSWlpU3JBc0Jma1NmcGFGQkRhcHRNaGJMNmZQaGJo?=
 =?utf-8?B?TzhxY2dqSkp3Y09WL3VrMkVMWXAwNVJDZWxrc3lCOE5jaGpSV3laaHM2bWtH?=
 =?utf-8?B?ZURKNk9JM2NPYVdSNEVlVkdDcmpsNUdZYXkycXBMMGdNbksxblRmV2w5SEF6?=
 =?utf-8?B?T3k2N0NNc1E4RklYYXp0cGplRzM2cVhxYUxXNGo2STNMSHNvRUN3d3FWTWND?=
 =?utf-8?B?R2p1c1lwOHkxMndMZll4bkJjVW1PdmpWQVlOaDRleCtZaUkvK3dqeHBFQktT?=
 =?utf-8?B?Mm5relNNSDZwQkNxS3lKTTNvcFpjMmZKbDBjbHhyOWRIMmFxeW5CS2M2VnlW?=
 =?utf-8?B?UHo1eGdCdEJnSUJEb084N2d5Qngzci9lS1hkaEtGemh6T0E0bmEzVTlZZ0wx?=
 =?utf-8?B?cjZ4OUxYakdtaVJ2QjU1RnJ6S0FJUk9sTDRDMWNkWndod1lyUWwxeW5lZ3Br?=
 =?utf-8?B?TkVyWTVsTTl4dWFCUWxOejJLb1RZNEdHck1ERytPNW5UQWpHQVNIb0FuKzIr?=
 =?utf-8?B?UXZzUDQwU0w2N1JUVEhmSjlMQlE4YUttQXpodUZKSnArUWxtdWY1QldFWmJY?=
 =?utf-8?B?N0xYWEVNVzZLcSt0bno0WUlyTjBCdm0zN3I3M0pGY0tzWXZzbGZGYnh2Zm1K?=
 =?utf-8?B?RG9BUkJMRFFDUDYyTlJWa1BZcS9jeFZGOExFSTdvMzNJWUZiVTFUK3BuUUsr?=
 =?utf-8?B?QVBheEQ4ajN3UGd5cy9mS3NWeXRvTlc1YnRvQmNQTC81U2JGemlwQXlySVY5?=
 =?utf-8?B?WXZkbjVKUXJDeUI1VUdMempvckd6dHp3SmhpNXVkaGpxOEV5aWJKNWdJOFZQ?=
 =?utf-8?B?djkrYkdLeHo1QVpHRU1yT2lQQXcxU3ZVYWJmWm5hSWxhUVd0RjRxSGhUbjBU?=
 =?utf-8?B?TlFmYjlaekVLeGdlSVdVUXczYmNBUlNvRWloK0txMVJ1SmpkOUQ2WnFkT1I2?=
 =?utf-8?B?U3pMRXFLbmttZllvYU5CNmpGSG1yeDNBMjZLVGExTjJQZ09lT0lZTjNMd3BQ?=
 =?utf-8?B?VUlJek92eHZnUExJWUIzMTRvV0RTaXlGZ0wxYnZTeE1JWk9pZ0xoMC80Z01l?=
 =?utf-8?B?UVZyK0NVV2xYNTlhOG0yYlFiU1lsTEhZNFI4T0lhdmFWWUFCSVdxTjk0cThW?=
 =?utf-8?B?QkVacUFjNmgxdm91NCt2bmlwZjNGWTBmbzBSTkV2M0pFNlRuN2pKdEs0UW50?=
 =?utf-8?B?Y0ExME53Z0NtZDVPMnd3eW5QRzkyVlptQjFRUjNCc0UrcXNNa3U2TGV0UUVJ?=
 =?utf-8?B?alpZeHorbXFXNG1BU3g5emhLalBhMnJNMDMxVjdLMzd1SjRxM0RpMXZXSGVl?=
 =?utf-8?B?UUFRT2djaUtaVGc3THF3S1Z3dndwNnR2RFR2R2xueC9ic21ZQysxRlpwTU0r?=
 =?utf-8?B?WG8zWGZTNjh5R3AyaWo5cHNnTm1ZZFJTcmlYczhaUm9FZ3R4bEdYc0N2dXhh?=
 =?utf-8?B?ZmpSczVGUC9IV3lhTXBVMlJjUml0VXp6TnE5TDc0dHhOS2VhcHJTbzI2eVdD?=
 =?utf-8?Q?Qa7SrOK8Th98sSBBJH+eaMVfS36CHxrr862OkCJ?=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 47e16009-700b-48fe-ba45-08d91bff61bb
X-MS-Exchange-CrossTenant-AuthSource: BN9PR12MB5129.namprd12.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 21 May 2021 02:23:12.0875 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: DFLvrdAQPlt8sSDLpDn8zFGej2nHOrDuaGWx1rtVG7mf9zy6/6113b8rfjPHQFetgH+d0I7W3e0ULE+3RTe3fA==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN9PR12MB5049
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

U0cgQk9zIHN1Y2ggYXMgZG1hYnVmIGltcG9ydHMgYW5kIHVzZXJwdHIgQk9zIGRvIG5vdCBjb25z
dW1lIHN5c3RlbQpyZXNvdXJjZXMgZGlyZWN0bHkuIEluc3RlYWQgdGhleSBwb2ludCB0byByZXNv
dXJjZXMgb3duZWQgZWxzZXdoZXJlLgpUaGV5IHR5cGljYWxseSBnZXQgZXZpY3RlZCBieSBETUFC
dWYgbW92ZSBub3RpZmllcnMgb2YgTU1VIG5vdGlmaWVycy4KSWYgdGhvc2Ugbm90aWZpZXJzIGRv
bid0IG5lZWQgdG8gd2FpdCBmb3IgaGFyZHdhcmUgZmVuY2VzIChpLmUuIHRoZSBTRwpCT3MgYXJl
IHVzZWQgaW4gYSBwcmVlbXB0aWJsZSBjb250ZXh0KSwgdGhlbiB3ZSBkb24ndCBuZWVkIHRvIGxp
bWl0CnRoZW0gdG8gdGhlIEdUVCBzaXplIGFuZCB3ZSBkb24ndCBuZWVkIFRUTSB0byBldmljdCB0
aGVtLgoKQ3JlYXRlIGEgbmV3IHBsYWNlbWVudCBmb3Igc3VjaCBwcmVlbXB0aWJsZSBTRyBCT3Mg
dGhhdCBkb2VzIG5vdCBpbXBvc2UKYXJ0aWZpY2lhbCBzaXplIGxpbWl0cyBhbmQgVFRNIGV2aWN0
aW9ucy4KClNpZ25lZC1vZmYtYnk6IEZlbGl4IEt1ZWhsaW5nIDxGZWxpeC5LdWVobGluZ0BhbWQu
Y29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L01ha2VmaWxlICAgICAgICAgICB8
ICAgNyArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jICAgIHwg
ICA0ICstCiAuLi4vZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wcmVlbXB0X21nci5jICAgfCAx
OTAgKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
dHRtLmMgICAgICAgfCAgMzcgKysrLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X3R0bS5oICAgICAgIHwgIDExICsKIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92
bS5jICAgICAgICB8ICAgMyArLQogaW5jbHVkZS91YXBpL2RybS9hbWRncHVfZHJtLmggICAgICAg
ICAgICAgICAgIHwgICA0ICsKIDcgZmlsZXMgY2hhbmdlZCwgMjQ3IGluc2VydGlvbnMoKyksIDkg
ZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3ByZWVtcHRfbWdyLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L01ha2VmaWxlCmlu
ZGV4IDYzMzFhMTEyOTlkMC4uNmNmMGZlODcxZDZjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9N
YWtlZmlsZQpAQCAtNTEsOSArNTEsMTAgQEAgYW1kZ3B1LXkgKz0gYW1kZ3B1X2RldmljZS5vIGFt
ZGdwdV9rbXMubyBcCiAJYXRvbWJpb3NfZW5jb2RlcnMubyBhbWRncHVfc2EubyBhdG9tYmlvc19p
MmMubyBcCiAJYW1kZ3B1X2RtYV9idWYubyBhbWRncHVfdm0ubyBhbWRncHVfaWIubyBhbWRncHVf
cGxsLm8gXAogCWFtZGdwdV91Y29kZS5vIGFtZGdwdV9ib19saXN0Lm8gYW1kZ3B1X2N0eC5vIGFt
ZGdwdV9zeW5jLm8gXAotCWFtZGdwdV9ndHRfbWdyLm8gYW1kZ3B1X3ZyYW1fbWdyLm8gYW1kZ3B1
X3ZpcnQubyBhbWRncHVfYXRvbWZpcm13YXJlLm8gXAotCWFtZGdwdV92Zl9lcnJvci5vIGFtZGdw
dV9zY2hlZC5vIGFtZGdwdV9kZWJ1Z2ZzLm8gYW1kZ3B1X2lkcy5vIFwKLQlhbWRncHVfZ21jLm8g
YW1kZ3B1X21taHViLm8gYW1kZ3B1X3hnbWkubyBhbWRncHVfY3NhLm8gYW1kZ3B1X3Jhcy5vIGFt
ZGdwdV92bV9jcHUubyBcCisJYW1kZ3B1X2d0dF9tZ3IubyBhbWRncHVfcHJlZW1wdF9tZ3IubyBh
bWRncHVfdnJhbV9tZ3IubyBhbWRncHVfdmlydC5vIFwKKwlhbWRncHVfYXRvbWZpcm13YXJlLm8g
YW1kZ3B1X3ZmX2Vycm9yLm8gYW1kZ3B1X3NjaGVkLm8gXAorCWFtZGdwdV9kZWJ1Z2ZzLm8gYW1k
Z3B1X2lkcy5vIGFtZGdwdV9nbWMubyBhbWRncHVfbW1odWIubyBcCisJYW1kZ3B1X3hnbWkubyBh
bWRncHVfY3NhLm8gYW1kZ3B1X3Jhcy5vIGFtZGdwdV92bV9jcHUubyBcCiAJYW1kZ3B1X3ZtX3Nk
bWEubyBhbWRncHVfZGlzY292ZXJ5Lm8gYW1kZ3B1X3Jhc19lZXByb20ubyBhbWRncHVfbmJpby5v
IFwKIAlhbWRncHVfdW1jLm8gc211X3YxMV8wX2kyYy5vIGFtZGdwdV9mcnVfZWVwcm9tLm8gYW1k
Z3B1X3JhcC5vIFwKIAlhbWRncHVfZndfYXR0ZXN0YXRpb24ubyBhbWRncHVfc2VjdXJlZGlzcGxh
eS5vIGFtZGdwdV9oZHAubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X29iamVjdC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X29iamVj
dC5jCmluZGV4IDc0NWZjZjNlYTQ1MC4uM2Y4NWJhODIyMmVmIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jCkBAIC0xNTcsNyArMTU3LDkgQEAgdm9pZCBhbWRn
cHVfYm9fcGxhY2VtZW50X2Zyb21fZG9tYWluKHN0cnVjdCBhbWRncHVfYm8gKmFibywgdTMyIGRv
bWFpbikKIAlpZiAoZG9tYWluICYgQU1ER1BVX0dFTV9ET01BSU5fR1RUKSB7CiAJCXBsYWNlc1tj
XS5mcGZuID0gMDsKIAkJcGxhY2VzW2NdLmxwZm4gPSAwOwotCQlwbGFjZXNbY10ubWVtX3R5cGUg
PSBUVE1fUExfVFQ7CisJCXBsYWNlc1tjXS5tZW1fdHlwZSA9CisJCQlhYm8tPmZsYWdzICYgQU1E
R1BVX0dFTV9DUkVBVEVfUFJFRU1QVElCTEUgPworCQkJQU1ER1BVX1BMX1BSRUVNUFQgOiBUVE1f
UExfVFQ7CiAJCXBsYWNlc1tjXS5mbGFncyA9IDA7CiAJCWMrKzsKIAl9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcHJlZW1wdF9tZ3IuYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wcmVlbXB0X21nci5jCm5ldyBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZDYwN2YzMTRjYzFiCi0tLSAvZGV2L251bGwKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ByZWVtcHRfbWdyLmMKQEAgLTAsMCAr
MSwxOTAgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wIE9SIE1JVAorLyoK
KyAqIENvcHlyaWdodCAyMDE2LTIwMjEgQWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5jLgorICoK
KyAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkg
cGVyc29uIG9idGFpbmluZyBhCisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0
ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVhbCBpbiB0
aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRh
dGlvbgorICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gs
IGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNv
ZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlz
IGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6
CisgKgorICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBu
b3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwg
cG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURF
RCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJ
TVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1F
UkNIQU5UQUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBO
T05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIENPUFlSSUdIVCBIT0xE
RVIoUykgT1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SCisg
KiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JU
IE9SIE9USEVSV0lTRSwKKyAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04g
V0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgorICogT1RIRVIgREVBTElOR1MgSU4gVEhF
IFNPRlRXQVJFLgorICoKKyAqIEF1dGhvcnM6IENocmlzdGlhbiBLw7ZuaWcsIEZlbGl4IEt1ZWhs
aW5nCisgKi8KKworI2luY2x1ZGUgImFtZGdwdS5oIgorCitzdGF0aWMgaW5saW5lIHN0cnVjdCBh
bWRncHVfcHJlZW1wdF9tZ3IgKgordG9fcHJlZW1wdF9tZ3Ioc3RydWN0IHR0bV9yZXNvdXJjZV9t
YW5hZ2VyICptYW4pCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihtYW4sIHN0cnVjdCBhbWRncHVf
cHJlZW1wdF9tZ3IsIG1hbmFnZXIpOworfQorCisvKioKKyAqIERPQzogbWVtX2luZm9fcHJlZW1w
dF91c2VkCisgKgorICogVGhlIGFtZGdwdSBkcml2ZXIgcHJvdmlkZXMgYSBzeXNmcyBBUEkgZm9y
IHJlcG9ydGluZyBjdXJyZW50IHRvdGFsIGFtb3VudCBvZgorICogdXNlZCBwcmVlbXB0aWJsZSBt
ZW1vcnkuCisgKiBUaGUgZmlsZSBtZW1faW5mb19wcmVlbXB0X3VzZWQgaXMgdXNlZCBmb3IgdGhp
cywgYW5kIHJldHVybnMgdGhlIGN1cnJlbnQKKyAqIHVzZWQgc2l6ZSBvZiB0aGUgcHJlZW1wdGli
bGUgYmxvY2ssIGluIGJ5dGVzCisgKi8KK3N0YXRpYyBzc2l6ZV90IG1lbV9pbmZvX3ByZWVtcHRf
dXNlZF9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkJICBzdHJ1Y3QgZGV2aWNlX2F0dHJp
YnV0ZSAqYXR0ciwKKwkJCQkJICBjaGFyICpidWYpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRk
ZXYgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9
IGRybV90b19hZGV2KGRkZXYpOworCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuOwor
CisJbWFuID0gdHRtX21hbmFnZXJfdHlwZSgmYWRldi0+bW1hbi5iZGV2LCBBTURHUFVfUExfUFJF
RU1QVCk7CisJcmV0dXJuIHN5c2ZzX2VtaXQoYnVmLCAiJWxsdVxuIiwgYW1kZ3B1X3ByZWVtcHRf
bWdyX3VzYWdlKG1hbikpOworfQorCitzdGF0aWMgREVWSUNFX0FUVFJfUk8obWVtX2luZm9fcHJl
ZW1wdF91c2VkKTsKKworLyoqCisgKiBhbWRncHVfcHJlZW1wdF9tZ3JfbmV3IC0gYWxsb2NhdGUg
YSBuZXcgbm9kZQorICoKKyAqIEBtYW46IFRUTSBtZW1vcnkgdHlwZSBtYW5hZ2VyCisgKiBAdGJv
OiBUVE0gQk8gd2UgbmVlZCB0aGlzIHJhbmdlIGZvcgorICogQHBsYWNlOiBwbGFjZW1lbnQgZmxh
Z3MgYW5kIHJlc3RyaWN0aW9ucworICogQG1lbTogdGhlIHJlc3VsdGluZyBtZW0gb2JqZWN0Cisg
KgorICogRHVtbXksIGp1c3QgY291bnQgdGhlIHNwYWNlIHVzZWQgd2l0aG91dCBhbGxvY2F0aW5n
IHJlc291cmNlcyBvciBhbnkgbGltaXQuCisgKi8KK3N0YXRpYyBpbnQgYW1kZ3B1X3ByZWVtcHRf
bWdyX25ldyhzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKKwkJCQkgIHN0cnVjdCB0
dG1fYnVmZmVyX29iamVjdCAqdGJvLAorCQkJCSAgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSAqcGxh
Y2UsCisJCQkJICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCit7CisJc3RydWN0IGFtZGdwdV9w
cmVlbXB0X21nciAqbWdyID0gdG9fcHJlZW1wdF9tZ3IobWFuKTsKKworCWF0b21pYzY0X2FkZCht
ZW0tPm51bV9wYWdlcywgJm1nci0+dXNlZCk7CisKKwltZW0tPm1tX25vZGUgPSBOVUxMOworCW1l
bS0+c3RhcnQgPSBBTURHUFVfQk9fSU5WQUxJRF9PRkZTRVQ7CisJcmV0dXJuIDA7Cit9CisKKy8q
KgorICogYW1kZ3B1X3ByZWVtcHRfbWdyX2RlbCAtIGZyZWUgcmFuZ2VzCisgKgorICogQG1hbjog
VFRNIG1lbW9yeSB0eXBlIG1hbmFnZXIKKyAqIEBtZW06IFRUTSBtZW1vcnkgb2JqZWN0CisgKgor
ICogRnJlZSB0aGUgYWxsb2NhdGVkIEdUVCBhZ2Fpbi4KKyAqLworc3RhdGljIHZvaWQgYW1kZ3B1
X3ByZWVtcHRfbWdyX2RlbChzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiwKKwkJCQkg
ICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0pCit7CisJc3RydWN0IGFtZGdwdV9wcmVlbXB0X21n
ciAqbWdyID0gdG9fcHJlZW1wdF9tZ3IobWFuKTsKKworCWF0b21pYzY0X3N1YihtZW0tPm51bV9w
YWdlcywgJm1nci0+dXNlZCk7Cit9CisKKy8qKgorICogYW1kZ3B1X3ByZWVtcHRfbWdyX3VzYWdl
IC0gcmV0dXJuIHVzYWdlIG9mIFBSRUVNUFQgZG9tYWluCisgKgorICogQG1hbjogVFRNIG1lbW9y
eSB0eXBlIG1hbmFnZXIKKyAqCisgKiBSZXR1cm4gaG93IG1hbnkgYnl0ZXMgYXJlIHVzZWQgaW4g
dGhlIEdUVCBkb21haW4KKyAqLwordWludDY0X3QgYW1kZ3B1X3ByZWVtcHRfbWdyX3VzYWdlKHN0
cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuKQoreworCXN0cnVjdCBhbWRncHVfcHJlZW1w
dF9tZ3IgKm1nciA9IHRvX3ByZWVtcHRfbWdyKG1hbik7CisJczY0IHJlc3VsdCA9IGF0b21pYzY0
X3JlYWQoJm1nci0+dXNlZCk7CisKKwlyZXR1cm4gKHJlc3VsdCA+IDAgPyByZXN1bHQgOiAwKSAq
IFBBR0VfU0laRTsKK30KKworLyoqCisgKiBhbWRncHVfcHJlZW1wdF9tZ3JfZGVidWcgLSBkdW1w
IFZSQU0gdGFibGUKKyAqCisgKiBAbWFuOiBUVE0gbWVtb3J5IHR5cGUgbWFuYWdlcgorICogQHBy
aW50ZXI6IERSTSBwcmludGVyIHRvIHVzZQorICoKKyAqIER1bXAgdGhlIHRhYmxlIGNvbnRlbnQg
dXNpbmcgcHJpbnRrLgorICovCitzdGF0aWMgdm9pZCBhbWRncHVfcHJlZW1wdF9tZ3JfZGVidWco
c3RydWN0IHR0bV9yZXNvdXJjZV9tYW5hZ2VyICptYW4sCisJCQkJICAgICBzdHJ1Y3QgZHJtX3By
aW50ZXIgKnByaW50ZXIpCit7CisJc3RydWN0IGFtZGdwdV9wcmVlbXB0X21nciAqbWdyID0gdG9f
cHJlZW1wdF9tZ3IobWFuKTsKKworCWRybV9wcmludGYocHJpbnRlciwgIm1hbiBzaXplOiVsbHUg
cGFnZXMsIHByZWVtcHQgdXNlZDolbGxkIHBhZ2VzXG4iLAorCQkgICBtYW4tPnNpemUsICh1NjQp
YXRvbWljNjRfcmVhZCgmbWdyLT51c2VkKSk7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdHRt
X3Jlc291cmNlX21hbmFnZXJfZnVuYyBhbWRncHVfcHJlZW1wdF9tZ3JfZnVuYyA9IHsKKwkuYWxs
b2MgPSBhbWRncHVfcHJlZW1wdF9tZ3JfbmV3LAorCS5mcmVlID0gYW1kZ3B1X3ByZWVtcHRfbWdy
X2RlbCwKKwkuZGVidWcgPSBhbWRncHVfcHJlZW1wdF9tZ3JfZGVidWcKK307CisKKy8qKgorICog
YW1kZ3B1X3ByZWVtcHRfbWdyX2luaXQgLSBpbml0IFBSRUVNUFQgbWFuYWdlciBhbmQgRFJNIE1N
CisgKgorICogQGFkZXY6IGFtZGdwdV9kZXZpY2UgcG9pbnRlcgorICoKKyAqIEFsbG9jYXRlIGFu
ZCBpbml0aWFsaXplIHRoZSBHVFQgbWFuYWdlci4KKyAqLworaW50IGFtZGdwdV9wcmVlbXB0X21n
cl9pbml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQoreworCXN0cnVjdCBhbWRncHVfcHJl
ZW1wdF9tZ3IgKm1nciA9ICZhZGV2LT5tbWFuLnByZWVtcHRfbWdyOworCXN0cnVjdCB0dG1fcmVz
b3VyY2VfbWFuYWdlciAqbWFuID0gJm1nci0+bWFuYWdlcjsKKwlpbnQgcmV0OworCisJbWFuLT51
c2VfdHQgPSB0cnVlOworCW1hbi0+ZnVuYyA9ICZhbWRncHVfcHJlZW1wdF9tZ3JfZnVuYzsKKwor
CXR0bV9yZXNvdXJjZV9tYW5hZ2VyX2luaXQobWFuLCAoMSA8PCAzMCkpOworCisJYXRvbWljNjRf
c2V0KCZtZ3ItPnVzZWQsIDApOworCisJcmV0ID0gZGV2aWNlX2NyZWF0ZV9maWxlKGFkZXYtPmRl
diwgJmRldl9hdHRyX21lbV9pbmZvX3ByZWVtcHRfdXNlZCk7CisJaWYgKHJldCkgeworCQlEUk1f
RVJST1IoIkZhaWxlZCB0byBjcmVhdGUgZGV2aWNlIGZpbGUgbWVtX2luZm9fcHJlZW1wdF91c2Vk
XG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwl0dG1fc2V0X2RyaXZlcl9tYW5hZ2VyKCZhZGV2
LT5tbWFuLmJkZXYsIEFNREdQVV9QTF9QUkVFTVBULAorCQkJICAgICAgICZtZ3ItPm1hbmFnZXIp
OworCXR0bV9yZXNvdXJjZV9tYW5hZ2VyX3NldF91c2VkKG1hbiwgdHJ1ZSk7CisJcmV0dXJuIDA7
Cit9CisKKy8qKgorICogYW1kZ3B1X3ByZWVtcHRfbWdyX2ZpbmkgLSBmcmVlIGFuZCBkZXN0cm95
IEdUVCBtYW5hZ2VyCisgKgorICogQGFkZXY6IGFtZGdwdV9kZXZpY2UgcG9pbnRlcgorICoKKyAq
IERlc3Ryb3kgYW5kIGZyZWUgdGhlIEdUVCBtYW5hZ2VyLCByZXR1cm5zIC1FQlVTWSBpZiByYW5n
ZXMgYXJlIHN0aWxsCisgKiBhbGxvY2F0ZWQgaW5zaWRlIGl0LgorICovCit2b2lkIGFtZGdwdV9w
cmVlbXB0X21ncl9maW5pKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQoreworCXN0cnVjdCBh
bWRncHVfcHJlZW1wdF9tZ3IgKm1nciA9ICZhZGV2LT5tbWFuLnByZWVtcHRfbWdyOworCXN0cnVj
dCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuID0gJm1nci0+bWFuYWdlcjsKKwlpbnQgcmV0Owor
CisJdHRtX3Jlc291cmNlX21hbmFnZXJfc2V0X3VzZWQobWFuLCBmYWxzZSk7CisKKwlyZXQgPSB0
dG1fcmVzb3VyY2VfbWFuYWdlcl9ldmljdF9hbGwoJmFkZXYtPm1tYW4uYmRldiwgbWFuKTsKKwlp
ZiAocmV0KQorCQlyZXR1cm47CisKKwlkZXZpY2VfcmVtb3ZlX2ZpbGUoYWRldi0+ZGV2LCAmZGV2
X2F0dHJfbWVtX2luZm9fcHJlZW1wdF91c2VkKTsKKworCXR0bV9yZXNvdXJjZV9tYW5hZ2VyX2Ns
ZWFudXAobWFuKTsKKwl0dG1fc2V0X2RyaXZlcl9tYW5hZ2VyKCZhZGV2LT5tbWFuLmJkZXYsIEFN
REdQVV9QTF9QUkVFTVBULCBOVUxMKTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV90dG0uYwppbmRleCA5NGQ0NzAxMDhmODMuLmMwYWVmMzI3MjkyYSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwpAQCAtMTU4LDYgKzE1OCw3IEBAIHN0YXRpYyB2b2lk
IGFtZGdwdV9ldmljdF9mbGFncyhzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCQl9CiAJ
CWJyZWFrOwogCWNhc2UgVFRNX1BMX1RUOgorCWNhc2UgQU1ER1BVX1BMX1BSRUVNUFQ6CiAJZGVm
YXVsdDoKIAkJYW1kZ3B1X2JvX3BsYWNlbWVudF9mcm9tX2RvbWFpbihhYm8sIEFNREdQVV9HRU1f
RE9NQUlOX0NQVSk7CiAJCWJyZWFrOwpAQCAtMjE3LDYgKzIxOCw3IEBAIHN0YXRpYyBpbnQgYW1k
Z3B1X3R0bV9tYXBfYnVmZmVyKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCiAKIAlCVUdf
T04oYWRldi0+bW1hbi5idWZmZXJfZnVuY3MtPmNvcHlfbWF4X2J5dGVzIDwKIAkgICAgICAgQU1E
R1BVX0dUVF9NQVhfVFJBTlNGRVJfU0laRSAqIDgpOworCUJVR19PTihtZW0tPm1lbV90eXBlID09
IEFNREdQVV9QTF9QUkVFTVBUKTsKIAogCS8qIE1hcCBvbmx5IHdoYXQgY2FuJ3QgYmUgYWNjZXNz
ZWQgZGlyZWN0bHkgKi8KIAlpZiAoIXRteiAmJiBtZW0tPnN0YXJ0ICE9IEFNREdQVV9CT19JTlZB
TElEX09GRlNFVCkgewpAQCAtNDgwLDcgKzQ4Miw4IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2JvX21v
dmUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgYm9vbCBldmljdCwKIAlzdHJ1Y3QgdHRt
X3Jlc291cmNlICpvbGRfbWVtID0gJmJvLT5tZW07CiAJaW50IHI7CiAKLQlpZiAobmV3X21lbS0+
bWVtX3R5cGUgPT0gVFRNX1BMX1RUKSB7CisJaWYgKG5ld19tZW0tPm1lbV90eXBlID09IFRUTV9Q
TF9UVCB8fAorCSAgICBuZXdfbWVtLT5tZW1fdHlwZSA9PSBBTURHUFVfUExfUFJFRU1QVCkgewog
CQlyID0gYW1kZ3B1X3R0bV9iYWNrZW5kX2JpbmQoYm8tPmJkZXYsIGJvLT50dG0sIG5ld19tZW0p
OwogCQlpZiAocikKIAkJCXJldHVybiByOwpAQCAtNDk4LDExICs1MDEsMTMgQEAgc3RhdGljIGlu
dCBhbWRncHVfYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCBib29sIGV2aWN0
LAogCQlnb3RvIG91dDsKIAl9CiAJaWYgKG9sZF9tZW0tPm1lbV90eXBlID09IFRUTV9QTF9TWVNU
RU0gJiYKLQkgICAgbmV3X21lbS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUKSB7CisJICAgIChuZXdf
bWVtLT5tZW1fdHlwZSA9PSBUVE1fUExfVFQgfHwKKwkgICAgIG5ld19tZW0tPm1lbV90eXBlID09
IEFNREdQVV9QTF9QUkVFTVBUKSkgewogCQl0dG1fYm9fbW92ZV9udWxsKGJvLCBuZXdfbWVtKTsK
IAkJZ290byBvdXQ7CiAJfQotCWlmIChvbGRfbWVtLT5tZW1fdHlwZSA9PSBUVE1fUExfVFQgJiYK
KwlpZiAoKG9sZF9tZW0tPm1lbV90eXBlID09IFRUTV9QTF9UVCB8fAorCSAgICAgb2xkX21lbS0+
bWVtX3R5cGUgPT0gQU1ER1BVX1BMX1BSRUVNUFQpICYmCiAJICAgIG5ld19tZW0tPm1lbV90eXBl
ID09IFRUTV9QTF9TWVNURU0pIHsKIAkJciA9IHR0bV9ib193YWl0X2N0eChibywgY3R4KTsKIAkJ
aWYgKHIpCkBAIC01ODcsNiArNTkyLDcgQEAgc3RhdGljIGludCBhbWRncHVfdHRtX2lvX21lbV9y
ZXNlcnZlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LAogCQkvKiBzeXN0ZW0gbWVtb3J5ICovCiAJ
CXJldHVybiAwOwogCWNhc2UgVFRNX1BMX1RUOgorCWNhc2UgQU1ER1BVX1BMX1BSRUVNUFQ6CiAJ
CWJyZWFrOwogCWNhc2UgVFRNX1BMX1ZSQU06CiAJCW1lbS0+YnVzLm9mZnNldCA9IG1lbS0+c3Rh
cnQgPDwgUEFHRV9TSElGVDsKQEAgLTEyOTQsNyArMTMwMCw4IEBAIHVpbnQ2NF90IGFtZGdwdV90
dG1fdHRfcGRlX2ZsYWdzKHN0cnVjdCB0dG1fdHQgKnR0bSwgc3RydWN0IHR0bV9yZXNvdXJjZSAq
bWVtKQogCWlmIChtZW0gJiYgbWVtLT5tZW1fdHlwZSAhPSBUVE1fUExfU1lTVEVNKQogCQlmbGFn
cyB8PSBBTURHUFVfUFRFX1ZBTElEOwogCi0JaWYgKG1lbSAmJiBtZW0tPm1lbV90eXBlID09IFRU
TV9QTF9UVCkgeworCWlmIChtZW0gJiYgKG1lbS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUIHx8CisJ
CSAgICBtZW0tPm1lbV90eXBlID09IEFNREdQVV9QTF9QUkVFTVBUKSkgewogCQlmbGFncyB8PSBB
TURHUFVfUFRFX1NZU1RFTTsKIAogCQlpZiAodHRtLT5jYWNoaW5nID09IHR0bV9jYWNoZWQpCkBA
IC0xMzY4LDYgKzEzNzUsMTUgQEAgc3RhdGljIGJvb2wgYW1kZ3B1X3R0bV9ib19ldmljdGlvbl92
YWx1YWJsZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCX0KIAogCXN3aXRjaCAoYm8t
Pm1lbS5tZW1fdHlwZSkgeworCWNhc2UgQU1ER1BVX1BMX1BSRUVNUFQ6CisJCS8qIFByZWVtcHRp
YmxlIEJPcyBkb24ndCBvd24gc3lzdGVtIHJlc291cmNlcyBtYW5hZ2VkIGJ5IHRoZQorCQkgKiBk
cml2ZXIgKHBhZ2VzLCBWUkFNLCBHQVJUIHNwYWNlKS4gVGhleSBwb2ludCB0byByZXNvdXJjZXMK
KwkJICogb3duZWQgYnkgc29tZW9uZSBlbHNlIChlLmcuIHBhZ2VhYmxlIG1lbW9yeSBpbiB1c2Vy
IG1vZGUKKwkJICogb3IgYSBETUFCdWYpLiBUaGV5IGFyZSB1c2VkIGluIGEgcHJlZW1wdGlibGUg
Y29udGV4dCBzbyB3ZQorCQkgKiBjYW4gZ3VhcmFudGVlIG5vIGRlYWRsb2NrcyBhbmQgZ29vZCBR
b1MgaW4gY2FzZSBvZiBNTVUKKwkJICogbm90aWZpZXJzIG9yIERNQUJ1ZiBtb3ZlIG5vdGlmaWVy
cyBmcm9tIHRoZSByZXNvdXJjZSBvd25lci4KKwkJICovCisJCXJldHVybiBmYWxzZTsKIAljYXNl
IFRUTV9QTF9UVDoKIAkJaWYgKGFtZGdwdV9ib19pc19hbWRncHVfYm8oYm8pICYmCiAJCSAgICBh
bWRncHVfYm9fZW5jcnlwdGVkKHR0bV90b19hbWRncHVfYm8oYm8pKSkKQEAgLTE3NDksNiArMTc2
NSwxMyBAQCBpbnQgYW1kZ3B1X3R0bV9pbml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQog
CURSTV9JTkZPKCJhbWRncHU6ICV1TSBvZiBHVFQgbWVtb3J5IHJlYWR5LlxuIiwKIAkJICh1bnNp
Z25lZCkoZ3R0X3NpemUgLyAoMTAyNCAqIDEwMjQpKSk7CiAKKwkvKiBJbml0aWFsaXplIHByZWVt
cHRpYmxlIG1lbW9yeSBwb29sICovCisJciA9IGFtZGdwdV9wcmVlbXB0X21ncl9pbml0KGFkZXYp
OworCWlmIChyKSB7CisJCURSTV9FUlJPUigiRmFpbGVkIGluaXRpYWxpemluZyBQUkVFTVBUIGhl
YXAuXG4iKTsKKwkJcmV0dXJuIHI7CisJfQorCiAJLyogSW5pdGlhbGl6ZSB2YXJpb3VzIG9uLWNo
aXAgbWVtb3J5IHBvb2xzICovCiAJciA9IGFtZGdwdV90dG1faW5pdF9vbl9jaGlwKGFkZXYsIEFN
REdQVV9QTF9HRFMsIGFkZXYtPmdkcy5nZHNfc2l6ZSk7CiAJaWYgKHIpIHsKQEAgLTE3OTMsNiAr
MTgxNiw3IEBAIHZvaWQgYW1kZ3B1X3R0bV9maW5pKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
KQogCiAJYW1kZ3B1X3ZyYW1fbWdyX2ZpbmkoYWRldik7CiAJYW1kZ3B1X2d0dF9tZ3JfZmluaShh
ZGV2KTsKKwlhbWRncHVfcHJlZW1wdF9tZ3JfZmluaShhZGV2KTsKIAl0dG1fcmFuZ2VfbWFuX2Zp
bmkoJmFkZXYtPm1tYW4uYmRldiwgQU1ER1BVX1BMX0dEUyk7CiAJdHRtX3JhbmdlX21hbl9maW5p
KCZhZGV2LT5tbWFuLmJkZXYsIEFNREdQVV9QTF9HV1MpOwogCXR0bV9yYW5nZV9tYW5fZmluaSgm
YWRldi0+bW1hbi5iZGV2LCBBTURHUFVfUExfT0EpOwpAQCAtMTk4Nyw2ICsyMDExLDExIEBAIGlu
dCBhbWRncHVfZmlsbF9idWZmZXIoc3RydWN0IGFtZGdwdV9ibyAqYm8sCiAJCXJldHVybiAtRUlO
VkFMOwogCX0KIAorCWlmIChiby0+dGJvLm1lbS5tZW1fdHlwZSA9PSBBTURHUFVfUExfUFJFRU1Q
VCkgeworCQlEUk1fRVJST1IoIlRyeWluZyB0byBjbGVhciBwcmVlbXB0aWJsZSBtZW1vcnkuXG4i
KTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCiAJaWYgKGJvLT50Ym8ubWVtLm1lbV90eXBlID09
IFRUTV9QTF9UVCkgewogCQlyID0gYW1kZ3B1X3R0bV9hbGxvY19nYXJ0KCZiby0+dGJvKTsKIAkJ
aWYgKHIpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRt
LmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmgKaW5kZXggZWI4NGE2
OWM0Yjc0Li4yODc3YTkyNDA4NmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV90dG0uaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
dHRtLmgKQEAgLTMxLDYgKzMxLDcgQEAKICNkZWZpbmUgQU1ER1BVX1BMX0dEUwkJKFRUTV9QTF9Q
UklWICsgMCkKICNkZWZpbmUgQU1ER1BVX1BMX0dXUwkJKFRUTV9QTF9QUklWICsgMSkKICNkZWZp
bmUgQU1ER1BVX1BMX09BCQkoVFRNX1BMX1BSSVYgKyAyKQorI2RlZmluZSBBTURHUFVfUExfUFJF
RU1QVAkoVFRNX1BMX1BSSVYgKyAzKQogCiAjZGVmaW5lIEFNREdQVV9HVFRfTUFYX1RSQU5TRkVS
X1NJWkUJNTEyCiAjZGVmaW5lIEFNREdQVV9HVFRfTlVNX1RSQU5TRkVSX1dJTkRPV1MJMgpAQCAt
NTQsNiArNTUsMTEgQEAgc3RydWN0IGFtZGdwdV9ndHRfbWdyIHsKIAlhdG9taWM2NF90IGF2YWls
YWJsZTsKIH07CiAKK3N0cnVjdCBhbWRncHVfcHJlZW1wdF9tZ3IgeworCXN0cnVjdCB0dG1fcmVz
b3VyY2VfbWFuYWdlciBtYW5hZ2VyOworCWF0b21pYzY0X3QgdXNlZDsKK307CisKIHN0cnVjdCBh
bWRncHVfbW1hbiB7CiAJc3RydWN0IHR0bV9kZXZpY2UJCWJkZXY7CiAJYm9vbAkJCQlpbml0aWFs
aXplZDsKQEAgLTcwLDYgKzc2LDcgQEAgc3RydWN0IGFtZGdwdV9tbWFuIHsKIAogCXN0cnVjdCBh
bWRncHVfdnJhbV9tZ3IgdnJhbV9tZ3I7CiAJc3RydWN0IGFtZGdwdV9ndHRfbWdyIGd0dF9tZ3I7
CisJc3RydWN0IGFtZGdwdV9wcmVlbXB0X21nciBwcmVlbXB0X21ncjsKIAogCXVpbnQ2NF90CQlz
dG9sZW5fdmdhX3NpemU7CiAJc3RydWN0IGFtZGdwdV9ibwkqc3RvbGVuX3ZnYV9tZW1vcnk7CkBA
IC05Nyw2ICsxMDQsOCBAQCBzdHJ1Y3QgYW1kZ3B1X2NvcHlfbWVtIHsKIAogaW50IGFtZGdwdV9n
dHRfbWdyX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHVpbnQ2NF90IGd0dF9zaXpl
KTsKIHZvaWQgYW1kZ3B1X2d0dF9tZ3JfZmluaShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldik7
CitpbnQgYW1kZ3B1X3ByZWVtcHRfbWdyX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYp
Owordm9pZCBhbWRncHVfcHJlZW1wdF9tZ3JfZmluaShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
dik7CiBpbnQgYW1kZ3B1X3ZyYW1fbWdyX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYp
Owogdm9pZCBhbWRncHVfdnJhbV9tZ3JfZmluaShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldik7
CiAKQEAgLTEwNCw2ICsxMTMsOCBAQCBib29sIGFtZGdwdV9ndHRfbWdyX2hhc19nYXJ0X2FkZHIo
c3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtKTsKIHVpbnQ2NF90IGFtZGdwdV9ndHRfbWdyX3VzYWdl
KHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuKTsKIGludCBhbWRncHVfZ3R0X21ncl9y
ZWNvdmVyKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuKTsKIAordWludDY0X3QgYW1k
Z3B1X3ByZWVtcHRfbWdyX3VzYWdlKHN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqbWFuKTsK
KwogdTY0IGFtZGdwdV92cmFtX21ncl9ib192aXNpYmxlX3NpemUoc3RydWN0IGFtZGdwdV9ibyAq
Ym8pOwogaW50IGFtZGdwdV92cmFtX21ncl9hbGxvY19zZ3Qoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYsCiAJCQkgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlICptZW0sCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV92bS5jCmluZGV4IDU1OTkxZjM5MzQ4MS4uZGExNTVjMjc2YzUxIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYwpAQCAtMTgxNyw3ICsxODE3LDgg
QEAgaW50IGFtZGdwdV92bV9ib191cGRhdGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHN0
cnVjdCBhbWRncHVfYm9fdmEgKmJvX3ZhLAogCQkJCWJvID0gZ2VtX3RvX2FtZGdwdV9ibyhnb2Jq
KTsKIAkJfQogCQltZW0gPSAmYm8tPnRiby5tZW07Ci0JCWlmIChtZW0tPm1lbV90eXBlID09IFRU
TV9QTF9UVCkKKwkJaWYgKG1lbS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUIHx8CisJCSAgICBtZW0t
Pm1lbV90eXBlID09IEFNREdQVV9QTF9QUkVFTVBUKQogCQkJcGFnZXNfYWRkciA9IGJvLT50Ym8u
dHRtLT5kbWFfYWRkcmVzczsKIAl9CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9kcm0vYW1k
Z3B1X2RybS5oIGIvaW5jbHVkZS91YXBpL2RybS9hbWRncHVfZHJtLmgKaW5kZXggOTBiY2Q2NGMw
MTQ3Li5mN2E0ZjlmZDJiZTggMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9kcm0vYW1kZ3B1X2Ry
bS5oCisrKyBiL2luY2x1ZGUvdWFwaS9kcm0vYW1kZ3B1X2RybS5oCkBAIC0xMzksNiArMTM5LDEw
IEBAIGV4dGVybiAiQyIgewogICogYWNjZXNzaW5nIGl0IHdpdGggdmFyaW91cyBodyBibG9ja3MK
ICAqLwogI2RlZmluZSBBTURHUFVfR0VNX0NSRUFURV9FTkNSWVBURUQJCSgxIDw8IDEwKQorLyog
RmxhZyB0aGF0IEJPIHdpbGwgYmUgdXNlZCBvbmx5IGluIHByZWVtcHRpYmxlIGNvbnRleHQsIHdo
aWNoIGRvZXMKKyAqIG5vdCByZXF1aXJlIEdUVCBtZW1vcnkgYWNjb3VudGluZworICovCisjZGVm
aW5lIEFNREdQVV9HRU1fQ1JFQVRFX1BSRUVNUFRJQkxFCQkoMSA8PCAxMSkKIAogc3RydWN0IGRy
bV9hbWRncHVfZ2VtX2NyZWF0ZV9pbiAgewogCS8qKiB0aGUgcmVxdWVzdGVkIG1lbW9yeSBzaXpl
ICovCi0tIAoyLjMxLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeAo=
