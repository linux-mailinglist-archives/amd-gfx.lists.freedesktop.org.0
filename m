Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 835CDD59E4
	for <lists+amd-gfx@lfdr.de>; Mon, 14 Oct 2019 05:21:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EBEE96E1D3;
	Mon, 14 Oct 2019 03:21:39 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM03-BY2-obe.outbound.protection.outlook.com
 (mail-eopbgr780058.outbound.protection.outlook.com [40.107.78.58])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3A6176E1D5
 for <amd-gfx@lists.freedesktop.org>; Mon, 14 Oct 2019 03:21:38 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=lAKe3M3YQslYYCdVaW/S/NNhDRVx410RuWenCRSGEcXFsmmgIaPF00S54JScCDytFXs2ClTQdtZNtHAP6Xjp9bAqC1+VnjMr2TqdqL3elTaH3gPH63oc6PEGh4LPOlJwrbYoz6tiSQeyTYzhzuoeNRg9zE4MBFMfvJCgqtjlqeo/F3R5P8mySYezT0SgqWBCi4c9KMmFHZk7u6ZXSW8IeUehq0dAPEHl2d+xy9m+VFT9b5lO+dG0s3qbGGFDiSzxv5K65zJlibIy1uyuXqlm0Vb+KBsq0vXcte09DiiuFx5lAkDSG2ZVJ/82n9zgWKZfL6IyEP0xCNz2vnBX3bGfaw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=zS+TKzFip2wZnFTMODvFe+9SW4IewSBgUAWLMvF9k4w=;
 b=kHEYV9eGNvHnx4A+rcC+v4S1Js6KVMMLgXUKtzS9ZvnSG+Yg2H6t+D7HGbJNEuk8U23NW/INTLvKDo//RSs7dyvvegb/C9Ojm9/NSS6xfv0BSbd8YDuZg1PZ/hbMKksW9DnHib0SRCITAQVIE9zdOqua1grXd6j0MsskzVJXAAquO/sG56z97umUDblQcUmxiqD32rfJzqpOLRwo8qFd13K8S7GjAV8jtyK3A26jpS2jX+co6j3QgM/RnHJOJGaNmDY5aCfNbINH0yNFJK6xPHPQRGp/xz3CYOD5YXxZAyGqBCInXndgQeSbuHt9KgMI/2DpkssZQ7tuXKsLWdeoYA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=none (sender ip is
 165.204.84.17) smtp.rcpttodomain=lists.freedesktop.org smtp.mailfrom=amd.com; 
 dmarc=permerror action=none header.from=amd.com; dkim=none (message not
 signed); arc=none
Received: from DM3PR12CA0129.namprd12.prod.outlook.com (2603:10b6:0:51::25) by
 DM5PR1201MB0090.namprd12.prod.outlook.com (2603:10b6:4:53::12) with
 Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2347.16; Mon, 14 Oct 2019 03:21:37 +0000
Received: from BY2NAM03FT022.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e4a::208) by DM3PR12CA0129.outlook.office365.com
 (2603:10b6:0:51::25) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.2347.16 via Frontend
 Transport; Mon, 14 Oct 2019 03:21:36 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXMB01.amd.com (165.204.84.17) by
 BY2NAM03FT022.mail.protection.outlook.com (10.152.84.225) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256) id
 15.20.2347.21 via Frontend Transport; Mon, 14 Oct 2019 03:21:36 +0000
Received: from SATLEXMB02.amd.com (10.181.40.143) by SATLEXMB01.amd.com
 (10.181.40.142) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.1713.5; Sun, 13 Oct
 2019 22:21:36 -0500
Received: from rico-code.amd.com (10.180.168.240) by SATLEXMB02.amd.com
 (10.181.40.143) with Microsoft SMTP Server id 15.1.1713.5 via Frontend
 Transport; Sun, 13 Oct 2019 22:21:34 -0500
From: Tianci Yin <tianci.yin@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 8/8] drm/amdgpu/psp: add psp memory training implementation
Date: Mon, 14 Oct 2019 11:21:18 +0800
Message-ID: <20191014032118.14020-8-tianci.yin@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191014032118.14020-1-tianci.yin@amd.com>
References: <20191014032118.14020-1-tianci.yin@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(136003)(39860400002)(396003)(346002)(376002)(428003)(189003)(199004)(26005)(186003)(36756003)(50466002)(14444005)(336012)(11346002)(446003)(70586007)(70206006)(53416004)(426003)(478600001)(44832011)(2351001)(476003)(47776003)(126002)(2616005)(486006)(2906002)(5660300002)(6666004)(356004)(6916009)(81166006)(305945005)(4326008)(48376002)(1076003)(86362001)(54906003)(8676002)(316002)(51416003)(7696005)(16586007)(8936002)(76176011)(50226002)(81156014);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM5PR1201MB0090; H:SATLEXMB01.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; MX:1; A:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 358b15c7-f8ea-44a7-3e50-08d750559f17
X-MS-TrafficTypeDiagnostic: DM5PR1201MB0090:
X-Microsoft-Antispam-PRVS: <DM5PR1201MB0090E9C266E922840BA6F84D95900@DM5PR1201MB0090.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:597;
X-Forefront-PRVS: 01901B3451
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: qlsLISwvVLu1zwhWRrsUeu9+1F0jS0/fhFyUBa+ubXH73aJ0U5l5uG/kta6kB2I9pxA9HMIOwQMuIIYXTKIM8Tu9oq6lCb5qFh4tdLo4OguuHX1ODxzPCPbu/F6K63BRGybFl4Xkcok+hHZfYZgOXxzE+daIDff6GrkqBDW5yUgiyV4iuNrtxjJMNaOwk5+ipus+dAHFBqSjcGCiVtZQX20nVoza5R6eXJHtI6+ngPqXubRepzAVZ9rQUt2NMfE0UO99qu3jZIYyPeImcbDjPCZwY6dGkf0711oQW3IablmsQ/44iisisQba34Mi/G0EDifpMdBrH2pUU55kq0BqIQujOFnYzWg6ZsMBktLjvymIGkCWrRwAEu9CB+iKwhA2g97xlnhVQWB/opo6vHeCPhkStk3udmlCv4cvNWPLixw=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 14 Oct 2019 03:21:36.6446 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 358b15c7-f8ea-44a7-3e50-08d750559f17
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXMB01.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM5PR1201MB0090
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=zS+TKzFip2wZnFTMODvFe+9SW4IewSBgUAWLMvF9k4w=;
 b=dEVfUqIRd8CAsYvN+TS0+XdbV3DU6vOrVSYliNXftvdfYiyPVODb/2yIwIKClcxX8iDcXFnmuQCDsfunCHPg6DZWR1XxjwCk+qQC0ljJEhmSL0t+6L0n9mrRz8qCdDebCBU/51iloADQHpuuK44OH5iofKDf+oHAQcea7TO5DWA=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Deucher Alexander <Alexander.Deucher@amd.com>,
 Tuikov Luben <Luben.Tuikov@amd.com>,
 =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>,
 Tianci Yin <tianci.yin@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogIlRpYW5jaS5ZaW4iIDx0aWFuY2kueWluQGFtZC5jb20+CgphZGQgbWVtb3J5IHRyYWlu
aW5nIGltcGxlbWVudGF0aW9uIGNvZGUgdG8gc2F2ZSByZXN1bWUgdGltZS4KCkNoYW5nZS1JZDog
STYyNTc5NGE3ODBiMTFkODI0YWI1N2VmMzljYzMzYjg3MmM2ZGM2YzkKUmV2aWV3ZWQtYnk6IEFs
ZXggRGV1Y2hlciA8YWxleGFuZGVyLmRldWNoZXJAYW1kLmNvbT4KU2lnbmVkLW9mZi1ieTogVGlh
bmNpLllpbiA8dGlhbmNpLnlpbkBhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdS5oICAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfZHJ2LmMgfCAgIDkgKysKIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3BzcF92MTFfMC5j
ICB8IDE1OSArKysrKysrKysrKysrKysrKysrKysrKysKIDMgZmlsZXMgY2hhbmdlZCwgMTY5IGlu
c2VydGlvbnMoKykKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHUuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5oCmluZGV4IDg3MDRmOTNj
YWJmMi4uYzJiNzc2ZmQ4MmI1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHUuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaApAQCAt
MTUxLDYgKzE1MSw3IEBAIGV4dGVybiB1aW50IGFtZGdwdV9zZG1hX3BoYXNlX3F1YW50dW07CiBl
eHRlcm4gY2hhciAqYW1kZ3B1X2Rpc2FibGVfY3U7CiBleHRlcm4gY2hhciAqYW1kZ3B1X3ZpcnR1
YWxfZGlzcGxheTsKIGV4dGVybiB1aW50IGFtZGdwdV9wcF9mZWF0dXJlX21hc2s7CitleHRlcm4g
dWludCBhbWRncHVfZm9yY2VfbG9uZ190cmFpbmluZzsKIGV4dGVybiBpbnQgYW1kZ3B1X2pvYl9o
YW5nX2xpbWl0OwogZXh0ZXJuIGludCBhbWRncHVfbGJwdzsKIGV4dGVybiBpbnQgYW1kZ3B1X2Nv
bXB1dGVfbXVsdGlwaXBlOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rydi5jCmlu
ZGV4IGRhN2NiZWUyNWM2MS4uYzdkMDg2NTY5YWNiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2Rydi5jCkBAIC0xMjcsNiArMTI3LDcgQEAgY2hhciAqYW1kZ3B1X2Rpc2FibGVf
Y3UgPSBOVUxMOwogY2hhciAqYW1kZ3B1X3ZpcnR1YWxfZGlzcGxheSA9IE5VTEw7CiAvKiBPdmVy
RHJpdmUoYml0IDE0KSBkaXNhYmxlZCBieSBkZWZhdWx0Ki8KIHVpbnQgYW1kZ3B1X3BwX2ZlYXR1
cmVfbWFzayA9IDB4ZmZmZmJmZmY7Cit1aW50IGFtZGdwdV9mb3JjZV9sb25nX3RyYWluaW5nID0g
MDsKIGludCBhbWRncHVfam9iX2hhbmdfbGltaXQgPSAwOwogaW50IGFtZGdwdV9sYnB3ID0gLTE7
CiBpbnQgYW1kZ3B1X2NvbXB1dGVfbXVsdGlwaXBlID0gLTE7CkBAIC0zOTAsNiArMzkxLDE0IEBA
IG1vZHVsZV9wYXJhbV9uYW1lZChzY2hlZF9od19zdWJtaXNzaW9uLCBhbWRncHVfc2NoZWRfaHdf
c3VibWlzc2lvbiwgaW50LCAwNDQ0KTsKIE1PRFVMRV9QQVJNX0RFU0MocHBmZWF0dXJlbWFzaywg
ImFsbCBwb3dlciBmZWF0dXJlcyBlbmFibGVkIChkZWZhdWx0KSkiKTsKIG1vZHVsZV9wYXJhbV9u
YW1lZChwcGZlYXR1cmVtYXNrLCBhbWRncHVfcHBfZmVhdHVyZV9tYXNrLCB1aW50LCAwNDQ0KTsK
IAorLyoqCisgKiBET0M6IGZvcmNlbG9uZ3RyYWluaW5nICh1aW50KQorICogRm9yY2UgbG9uZyBt
ZW1vcnkgdHJhaW5pbmcgaW4gcmVzdW1lLgorICogVGhlIGRlZmF1bHQgaXMgemVybywgaW5kaWNh
dGVzIHNob3J0IHRyYWluaW5nIGluIHJlc3VtZS4KKyAqLworTU9EVUxFX1BBUk1fREVTQyhmb3Jj
ZWxvbmd0cmFpbmluZywgImZvcmNlIG1lbW9yeSBsb25nIHRyYWluaW5nIik7Cittb2R1bGVfcGFy
YW1fbmFtZWQoZm9yY2Vsb25ndHJhaW5pbmcsIGFtZGdwdV9mb3JjZV9sb25nX3RyYWluaW5nLCB1
aW50LCAwNDQ0KTsKKwogLyoqCiAgKiBET0M6IHBjaWVfZ2VuX2NhcCAodWludCkKICAqIE92ZXJy
aWRlIFBDSUUgZ2VuIHNwZWVkIGNhcGFiaWxpdGllcy4gU2VlIHRoZSBDQUlMIGZsYWdzIGluIGRy
aXZlcnMvZ3B1L2RybS9hbWQvaW5jbHVkZS9hbWRfcGNpZS5oLgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvcHNwX3YxMV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9wc3BfdjExXzAuYwppbmRleCAyYmEwZjY4Y2VkMTAuLmI3ZWZhYTNlOTEzYyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvcHNwX3YxMV8wLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvcHNwX3YxMV8wLmMKQEAgLTkwMiw2ICs5MDIsMTYyIEBAIHN0
YXRpYyBpbnQgcHNwX3YxMV8wX3JsY19hdXRvbG9hZF9zdGFydChzdHJ1Y3QgcHNwX2NvbnRleHQg
KnBzcCkKIAlyZXR1cm4gcHNwX3JsY19hdXRvbG9hZF9zdGFydChwc3ApOwogfQogCitzdGF0aWMg
aW50IHBzcF92MTFfMF9tZW1vcnlfdHJhaW5pbmdfc2VuZF9tc2coc3RydWN0IHBzcF9jb250ZXh0
ICpwc3AsIGludCBtc2cpCit7CisJaW50IHJldCA9IDA7CisJaW50IGkgPSAwOworCXVpbnQzMl90
IGRhdGFfMzIgPSAwOworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gcHNwLT5hZGV2Owor
CisJZGF0YV8zMiA9IChwc3AtPm1lbV90cmFpbl9jdHguYzJwX3RyYWluX2RhdGFfb2Zmc2V0ID4+
IDIwKTsKKwlXUkVHMzJfU09DMTUoTVAwLCAwLCBtbU1QMF9TTU5fQzJQTVNHXzM2LCBkYXRhXzMy
KTsKKwlXUkVHMzJfU09DMTUoTVAwLCAwLCBtbU1QMF9TTU5fQzJQTVNHXzM1LCBtc2cpOworCisJ
LyptYXggNXMqLworCXdoaWxlIChpIDwgNTApIHsKKwkJcmV0ID0gcHNwX3dhaXRfZm9yKHBzcCwg
U09DMTVfUkVHX09GRlNFVChNUDAsIDAsIG1tTVAwX1NNTl9DMlBNU0dfMzUpLAorCQkJCSAgIDB4
ODAwMDAwMDAsIDB4ODAwMDAwMDAsIGZhbHNlKTsKKwkJaWYgKHJldCA9PSAwKQorCQkJYnJlYWs7
CisJCWkrKzsKKwl9CisJRFJNX0RFQlVHKCIlcyB0cmFpbmluZyAlcywgY29zdCAlZCAqICVkbXMu
XG4iLAorCQkgIChtc2cgPT0gUFNQX0JMX19EUkFNX1NIT1JUX1RSQUlOKSA/ICJzaG9ydCIgOiAi
bG9uZyIsCisJCSAgKHJldCA9PSAwKSA/ICJzdWNjZWVkIiA6ICJmYWlsZWQiLAorCQkgIGksIGFk
ZXYtPnVzZWNfdGltZW91dC8xMDAwKTsKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHBz
cF92MTFfMF9tZW1vcnlfdHJhaW5pbmdfZmluaShzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCkKK3sK
KwlpbnQgcmV0ID0gMDsKKwlzdHJ1Y3QgcHNwX21lbW9yeV90cmFpbmluZ19jb250ZXh0ICpjdHgg
PSAmcHNwLT5tZW1fdHJhaW5fY3R4OworCisJY3R4LT5pbml0ID0gUFNQX01FTV9UUkFJTl9OT1Rf
U1VQUE9SVDsKKwlpZihjdHgtPnN5c19jYWNoZSkgeworCQlrZnJlZShjdHgtPnN5c19jYWNoZSk7
CisJCWN0eC0+c3lzX2NhY2hlID0gTlVMTDsKKwl9CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0
aWMgaW50IHBzcF92MTFfMF9tZW1vcnlfdHJhaW5pbmdfaW5pdChzdHJ1Y3QgcHNwX2NvbnRleHQg
KnBzcCkKK3sKKwlpbnQgcmV0ID0gMDsKKwlzdHJ1Y3QgcHNwX21lbW9yeV90cmFpbmluZ19jb250
ZXh0ICpjdHggPSAmcHNwLT5tZW1fdHJhaW5fY3R4OworCisJaWYoY3R4LT5pbml0ICE9IFBTUF9N
RU1fVFJBSU5fUkVTRVJWRV9TVUNDRVNTKSB7CisJCURSTV9ERUJVRygibWVtb3J5IHRyYWluaW5n
IGRvZXMgbm90IHN1cHBvcnQhXG4iKTsKKwkJcmV0dXJuIDA7CisJfQorCisJY3R4LT5zeXNfY2Fj
aGUgPSBremFsbG9jKGN0eC0+dHJhaW5fZGF0YV9zaXplLCBHRlBfS0VSTkVMKTsKKwlpZihjdHgt
PnN5c19jYWNoZSA9PSBOVUxMKSB7CisJCURSTV9FUlJPUigiYWxsb2MgbWVtX3RyYWluX2N0eC5z
eXNfY2FjaGUgZmFpbGVkKCVkKSFcbiIsIHJldCk7CisJCXJldCA9IC1FTk9NRU07CisJCWdvdG8g
RXJyX291dDsKKwl9CisKKwlEUk1fREVCVUcoInRyYWluX2RhdGFfc2l6ZTolbGx4LHAyY190cmFp
bl9kYXRhX29mZnNldDolbGx4LGMycF90cmFpbl9kYXRhX29mZnNldDolbGx4LlxuIiwKKwkJICBj
dHgtPnRyYWluX2RhdGFfc2l6ZSwKKwkJICBjdHgtPnAyY190cmFpbl9kYXRhX29mZnNldCwKKwkJ
ICBjdHgtPmMycF90cmFpbl9kYXRhX29mZnNldCk7CisJY3R4LT5pbml0ID0gUFNQX01FTV9UUkFJ
Tl9JTklUX1NVQ0NFU1M7CisJcmV0dXJuIDA7CisKK0Vycl9vdXQ6CisJcHNwX3YxMV8wX21lbW9y
eV90cmFpbmluZ19maW5pKHBzcCk7CisJcmV0dXJuIHJldDsKK30KKworLyoKKyAqIHNhdmUgYW5k
IHJlc3RvcmUgcHJvY2VzCisgKi8KK3N0YXRpYyBpbnQgcHNwX3YxMV8wX21lbW9yeV90cmFpbmlu
ZyhzdHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCwgdWludDMyX3Qgb3BzKQoreworCWludCByZXQgPSAw
OworCXVpbnQzMl90IHAyY19oZWFkZXJbNF07CisJc3RydWN0IHBzcF9tZW1vcnlfdHJhaW5pbmdf
Y29udGV4dCAqY3R4ID0gJnBzcC0+bWVtX3RyYWluX2N0eDsKKwl1aW50MzJfdCAqcGNhY2hlID0g
KHVpbnQzMl90KiljdHgtPnN5c19jYWNoZTsKKworCWlmIChjdHgtPmluaXQgPT0gUFNQX01FTV9U
UkFJTl9OT1RfU1VQUE9SVCkgeworCQlEUk1fREVCVUcoIk1lbW9yeSB0cmFpbmluZyBkb2VzIG5v
dCBzdXBwb3J0LlxuIik7CisJCXJldHVybiAwOworCX0gZWxzZSBpZiAoY3R4LT5pbml0ICE9IFBT
UF9NRU1fVFJBSU5fSU5JVF9TVUNDRVNTKSB7CisJCURSTV9FUlJPUigiUGxlYXNlIGNoZWNrIGlu
aXRpYWxpemF0aW9uIGZhaWx1cmUuXG4iKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJaWYg
KHBzcF92MTFfMF9pc19zb3NfYWxpdmUocHNwKSkgeworCQlEUk1fREVCVUcoInNvcyBpcyBhbGl2
ZSwgc2tpcCBtZW1vcnkgdHJhaW5pbmcuXG4iKTsKKwkJcmV0dXJuIDA7CisJfQorCisJYW1kZ3B1
X2RldmljZV92cmFtX2FjY2Vzcyhwc3AtPmFkZXYsIGN0eC0+cDJjX3RyYWluX2RhdGFfb2Zmc2V0
LCBwMmNfaGVhZGVyLCBzaXplb2YocDJjX2hlYWRlciksIGZhbHNlKTsKKwlEUk1fREVCVUcoInN5
c19jYWNoZVslMDh4LCUwOHgsJTA4eCwlMDh4XSBwMmNfaGVhZGVyWyUwOHgsJTA4eCwlMDh4LCUw
OHhdXG4iLAorCQkgIHBjYWNoZVswXSwgcGNhY2hlWzFdLCBwY2FjaGVbMl0sIHBjYWNoZVszXSwK
KwkJICBwMmNfaGVhZGVyWzBdLCBwMmNfaGVhZGVyWzFdLCBwMmNfaGVhZGVyWzJdLCBwMmNfaGVh
ZGVyWzNdKTsKKworCWlmIChvcHMgJiBQU1BfTUVNX1RSQUlOX1NFTkRfU0hPUlRfTVNHKSB7CisJ
CURSTV9ERUJVRygic2hvcnQgdHJhaW5pbmcgZGVwZW5kIG9uIHJlc3RvcmUuXG4iKTsKKwkJb3Bz
IHw9IFBTUF9NRU1fVFJBSU5fUkVTVE9SRTsKKwl9CisKKwlpZiAoKG9wcyAmIFBTUF9NRU1fVFJB
SU5fUkVTVE9SRSkgJiYKKwkgICAgcGNhY2hlWzBdICE9IE1FTV9UUkFJTl9TWVNURU1fU0lHTkFU
VVJFKSB7CisJCURSTV9ERUJVRygic3lzX2NhY2hlWzBdIGlzIGludmFsaWQsIHJlc3RvcmUgZGVw
ZW5kIG9uIHNhdmUuXG4iKTsKKwkJb3BzIHw9IFBTUF9NRU1fVFJBSU5fU0FWRTsKKwl9CisKKwlp
ZiAocDJjX2hlYWRlclswXSA9PSBNRU1fVFJBSU5fU1lTVEVNX1NJR05BVFVSRSAmJgorCSAgICAh
KHBjYWNoZVswXSA9PSBNRU1fVFJBSU5fU1lTVEVNX1NJR05BVFVSRSAmJgorCSAgICAgIHBjYWNo
ZVszXSA9PSBwMmNfaGVhZGVyWzNdKSkgeworCQlEUk1fREVCVUcoInN5c19jYWNoZSBpcyBpbnZh
bGlkIG9yIG91dC1vZi1kYXRlLCBuZWVkIHNhdmUgdHJhaW5pbmcgZGF0YSB0byBzeXNfY2FjaGUu
XG4iKTsKKwkJb3BzIHw9IFBTUF9NRU1fVFJBSU5fU0FWRTsKKwl9CisKKwlpZiAoKG9wcyAmIFBT
UF9NRU1fVFJBSU5fU0FWRSkgJiYKKwkgICAgcDJjX2hlYWRlclswXSAhPSBNRU1fVFJBSU5fU1lT
VEVNX1NJR05BVFVSRSkgeworCQlEUk1fREVCVUcoInAyY19oZWFkZXJbMF0gaXMgaW52YWxpZCwg
c2F2ZSBkZXBlbmQgb24gbG9uZyB0cmFpbmluZy5cbiIpOworCQlvcHMgfD0gUFNQX01FTV9UUkFJ
Tl9TRU5EX0xPTkdfTVNHOworCX0KKworCWlmIChvcHMgJiBQU1BfTUVNX1RSQUlOX1NFTkRfTE9O
R19NU0cpIHsKKwkJb3BzICY9IH5QU1BfTUVNX1RSQUlOX1NFTkRfU0hPUlRfTVNHOworCQlvcHMg
fD0gUFNQX01FTV9UUkFJTl9TQVZFOworCX0KKworCURSTV9ERUJVRygibWVtIHRyYWluaW5nIG9w
czoleC5cbiIsIG9wcyk7CisKKwlpZiAob3BzICYgUFNQX01FTV9UUkFJTl9TRU5EX0xPTkdfTVNH
KSB7CisJCXJldCA9IHBzcF92MTFfMF9tZW1vcnlfdHJhaW5pbmdfc2VuZF9tc2cocHNwLCBQU1Bf
QkxfX0RSQU1fTE9OR19UUkFJTik7CisJCWlmIChyZXQpIHsKKwkJCURSTV9FUlJPUigic2VuZCBs
b25nIHRyYWluaW5nIG1zZyBmYWlsZWQuXG4iKTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9CisK
KwlpZiAob3BzICYgUFNQX01FTV9UUkFJTl9TQVZFKSB7CisJCWFtZGdwdV9kZXZpY2VfdnJhbV9h
Y2Nlc3MocHNwLT5hZGV2LCBjdHgtPnAyY190cmFpbl9kYXRhX29mZnNldCwgY3R4LT5zeXNfY2Fj
aGUsIGN0eC0+dHJhaW5fZGF0YV9zaXplLCBmYWxzZSk7CisJfQorCisJaWYgKG9wcyAmIFBTUF9N
RU1fVFJBSU5fUkVTVE9SRSkgeworCQlhbWRncHVfZGV2aWNlX3ZyYW1fYWNjZXNzKHBzcC0+YWRl
diwgY3R4LT5jMnBfdHJhaW5fZGF0YV9vZmZzZXQsIGN0eC0+c3lzX2NhY2hlLCBjdHgtPnRyYWlu
X2RhdGFfc2l6ZSwgdHJ1ZSk7CisJfQorCisJaWYgKG9wcyAmIFBTUF9NRU1fVFJBSU5fU0VORF9T
SE9SVF9NU0cpIHsKKwkJcmV0ID0gcHNwX3YxMV8wX21lbW9yeV90cmFpbmluZ19zZW5kX21zZyhw
c3AsIChhbWRncHVfZm9yY2VfbG9uZ190cmFpbmluZyA+IDApID8KKwkJCQkJCQkgUFNQX0JMX19E
UkFNX0xPTkdfVFJBSU4gOiBQU1BfQkxfX0RSQU1fU0hPUlRfVFJBSU4pOworCQlpZiAocmV0KSB7
CisJCQlEUk1fRVJST1IoInNlbmQgdHJhaW5pbmcgbXNnIGZhaWxlZC5cbiIpOworCQkJcmV0dXJu
IHJldDsKKwkJfQorCX0KKwljdHgtPnRyYWluaW5nX2NudCsrOworCXJldHVybiByZXQ7Cit9CisK
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgcHNwX2Z1bmNzIHBzcF92MTFfMF9mdW5jcyA9IHsKIAkuaW5p
dF9taWNyb2NvZGUgPSBwc3BfdjExXzBfaW5pdF9taWNyb2NvZGUsCiAJLmJvb3Rsb2FkZXJfbG9h
ZF9rZGIgPSBwc3BfdjExXzBfYm9vdGxvYWRlcl9sb2FkX2tkYiwKQEAgLTkyMiw2ICsxMDc4LDkg
QEAgc3RhdGljIGNvbnN0IHN0cnVjdCBwc3BfZnVuY3MgcHNwX3YxMV8wX2Z1bmNzID0gewogCS5y
YXNfdHJpZ2dlcl9lcnJvciA9IHBzcF92MTFfMF9yYXNfdHJpZ2dlcl9lcnJvciwKIAkucmFzX2N1
cmVfcG9zaW9uID0gcHNwX3YxMV8wX3Jhc19jdXJlX3Bvc2lvbiwKIAkucmxjX2F1dG9sb2FkX3N0
YXJ0ID0gcHNwX3YxMV8wX3JsY19hdXRvbG9hZF9zdGFydCwKKwkubWVtX3RyYWluaW5nX2luaXQg
PSBwc3BfdjExXzBfbWVtb3J5X3RyYWluaW5nX2luaXQsCisJLm1lbV90cmFpbmluZ19maW5pID0g
cHNwX3YxMV8wX21lbW9yeV90cmFpbmluZ19maW5pLAorCS5tZW1fdHJhaW5pbmcgPSBwc3BfdjEx
XzBfbWVtb3J5X3RyYWluaW5nLAogfTsKIAogdm9pZCBwc3BfdjExXzBfc2V0X3BzcF9mdW5jcyhz
dHJ1Y3QgcHNwX2NvbnRleHQgKnBzcCkKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1kLWdmeEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9hbWQtZ2Z4
