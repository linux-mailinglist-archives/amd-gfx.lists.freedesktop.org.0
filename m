Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 687042438F5
	for <lists+amd-gfx@lfdr.de>; Thu, 13 Aug 2020 12:52:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DCDF16E203;
	Thu, 13 Aug 2020 10:52:25 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM11-BN8-obe.outbound.protection.outlook.com
 (mail-bn8nam11on2077.outbound.protection.outlook.com [40.107.236.77])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E65CC6E203
 for <amd-gfx@lists.freedesktop.org>; Thu, 13 Aug 2020 10:52:23 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=IEKb+fpO1oqrwJKicO0Wb7JAv2hhzKdCVstXozUdYxwEhFWUBOJdmdpGQWUA3DrAZmjRpMmf9rUltBcFObYyg3g9emkliiJnvpV1wVD0U07smW87el/iiM/2qWfklvlIBd63CRg3wV+evRt3cAs/JKbAVgBPr8MJw8s/BFFWTtVA5azeNX59UKB/tGCrsEZtYa+moXK7IiZLVYorEyxdKalXDjkceVTCF0YMwhpEjtlzAW4+/lL23lfq4quo+Sf3z0eVJP6dUTjE3KUxF5OXPBobRk7o4zcck88Mm7T1vtrVa7vmFCYGCVs8p5cQzOb4Aj+EoxmXwuQ3jCfIb0nFZA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=cWJn8QdAMf8sHI+Bs2wJxHKifUlJkDGcJ65++iW+Jy4=;
 b=G2k2DqrKbDtYy53YJko0J0LtNCGg+DWXt++uPbor/G6TeUd/+e+3Xc/fA+VpxU+i7e3QUliphvLrbykVcpb1pNO/NL4C5cofVFroin7XBIooYn3n4EaOxiILbXJS1WF5X8mHcu4RZ8bC8orih2Jg5VDnRQgEYW/SvXer+t0GDpl/Csk2AGP/TS/HQ7Cv2TnjgvH6YHtv5kvzdRFHbnm/ZFYtOjljLrx3CXd8KS/CFRGikKZln3Q/e9s+S8j4RCGWawsfv3GoCopa1kDY9O3U6h0g7TCXPJcb5/MmhgWAsM/Fgn4CvKpzxWuBxfEjc+u2Q15RpCVlsXlwSKgxXgtsBw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=cWJn8QdAMf8sHI+Bs2wJxHKifUlJkDGcJ65++iW+Jy4=;
 b=HOnP/tv69BXhS20mM/D0/JBDyTfSruLu3oaExvK5TpmhevepOQ9VYZsRfRMHcbMFzRttjpsyADvzHiX9xyrpr0raqXoXJ2K/KOHPZF/hDh2Dok1gEY5UPic46btPXwmKPbgXbJADa9fVA9NG6Qawl+JHw2CY2bDod2kTVQshSAs=
Authentication-Results: amd.com; dkim=none (message not signed)
 header.d=none;amd.com; dmarc=none action=none header.from=amd.com;
Received: from CH2PR12MB3911.namprd12.prod.outlook.com (2603:10b6:610:2f::12)
 by CH2PR12MB3846.namprd12.prod.outlook.com (2603:10b6:610:24::24)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3283.20; Thu, 13 Aug
 2020 10:52:14 +0000
Received: from CH2PR12MB3911.namprd12.prod.outlook.com
 ([fe80::718b:874b:e858:382c]) by CH2PR12MB3911.namprd12.prod.outlook.com
 ([fe80::718b:874b:e858:382c%2]) with mapi id 15.20.3283.018; Thu, 13 Aug 2020
 10:52:14 +0000
Subject: Re: [PATCH 4/4] drm/amd/powerplay: put those exposed power interfaces
 in amdgpu_dpm.c
To: Evan Quan <evan.quan@amd.com>, amd-gfx@lists.freedesktop.org
References: <20200813090819.32115-1-evan.quan@amd.com>
 <20200813090819.32115-4-evan.quan@amd.com>
From: Nirmoy <nirmodas@amd.com>
Message-ID: <90cf2433-2c27-5a76-d08b-6838a6aa8c88@amd.com>
Date: Thu, 13 Aug 2020 12:55:42 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.10.0
In-Reply-To: <20200813090819.32115-4-evan.quan@amd.com>
Content-Language: en-US
X-ClientProxiedBy: AM0PR02CA0078.eurprd02.prod.outlook.com
 (2603:10a6:208:154::19) To CH2PR12MB3911.namprd12.prod.outlook.com
 (2603:10b6:610:2f::12)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from [192.168.178.87] (217.86.124.70) by
 AM0PR02CA0078.eurprd02.prod.outlook.com (2603:10a6:208:154::19) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3283.15 via Frontend
 Transport; Thu, 13 Aug 2020 10:52:12 +0000
X-Originating-IP: [217.86.124.70]
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-HT: Tenant
X-MS-Office365-Filtering-Correlation-Id: 97e31a04-eddb-430e-722f-08d83f76efde
X-MS-TrafficTypeDiagnostic: CH2PR12MB3846:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <CH2PR12MB3846490E43CC4ABC332199CB8B430@CH2PR12MB3846.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:883;
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: 4SAebWy3DI3VQKY2NUYEmh+2qnKSVDtJaL61dG410mdPVHLmoT6YnMsLlOAxGKCTi8rc/3FHnfjRmHafuoy6B/BArWXjz62OC+Qw1cnfZ1D6nEEj3LVWrFNHW6r9jroQta7gH/1x/ResCuVoKQmzyCPOno/oVWbynXa8TCR0YkVwP1dSeHKLJWPcwrYzWChAYtUuIaKKUNZKvhHE9snjmRTgc2jmldQL3QYO8jd6zA1lYsMvuBFFUwfki8/OnzgIeoMSoolnFtePCCXqEvbHMS4RMgPTZpnWCvLrWUKBJSB/pp84vcneMOLhyFUbf7XnqMHGh+wLZsNIsq690ZWBGtiAHs+84Cc7VHa0U9yEr8TYA2nI/H12zrVL+PP7jD8zgoH10ek6gh6Rq1Pmxg/4WUc1yItbwfmrIp81ZdslT6o=
X-Forefront-Antispam-Report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:CH2PR12MB3911.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(4636009)(39860400002)(366004)(136003)(396003)(346002)(376002)(31686004)(8676002)(16526019)(186003)(5660300002)(36756003)(30864003)(8936002)(2906002)(478600001)(26005)(6486002)(31696002)(66476007)(66946007)(83380400001)(66556008)(6666004)(52116002)(316002)(16576012)(4326008)(2616005)(53546011)(956004)(31153001)(21314003)(43740500002);
 DIR:OUT; SFP:1101; 
X-MS-Exchange-AntiSpam-MessageData: 14zbTOiQ07wqiJyZtBHu8TMRwCre8VMt6lsKkPoSXcX5wq7CvIndtUbiWeGktn7cSzdRv+JR08nsteOs7XWbyPZBhbGXMUNLbbFtgObzAGGuDt1wZN0tsqtYtbXN7HfoEd6OI4VrahHSmExEAnwhvPoUSJSNoY8iEHOOQttdOmKrjYkq3C3mRumEETKoYqW7o252ngB1Gu6Aj1s1NlLyOfqs4NUpoQjaRZbcBBT6djYC0e+DQ8BB8BW39qS2UdVbXFskkU9A+Lya/UrfyZHBBTXB9+fjjgRBdgqGpvEwAbLknrLEfhaSX9lvq+eaW/g6+SzC+f6t/29OUHsKg7RC0/Zo2yodKRGkXpjvMaX7Lq6/vhm/lQOg8DRQCB5fgw2f67EeMeo5DYfWYrFKlMv1CdleZirJb0XoiVBqC4hpPAOc8i0QQMQ93oKG1c+8JvYW4HyajXWo72EjRuoN0AkPFmmCR8IwvdPwiXmdIeQf59XIat21+sSgSiQ+BKs270BvLh6Fr1L/gCC1SMzs/n32Z+KxztVgRe6qFR7SodxZN/OiJr2rSn4k/IHlcdNRYBRWXxyUD+JixBVxb9msNAVj/EpC2sVlR5ceHrXDsY8d4lWgQWqgr2I/0i9BSj2STg4gf6NoWG2mM3WdgsUJSK9eOg==
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 97e31a04-eddb-430e-722f-08d83f76efde
X-MS-Exchange-CrossTenant-AuthSource: CH2PR12MB3911.namprd12.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 13 Aug 2020 10:52:14.0076 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: bxvYiCso/Yt5dnRds3CqAfqfzLKd2uN9OM2Ab2mwASKnsDOy0Qj0MnmUaPslSDGFN9KDFUEsy3kM30mRAG7hog==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: CH2PR12MB3846
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: alexander.deucher@amd.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QWNrZWQtYnk6IE5pcm1veSBEYXMgPG5pcm1veS5kYXNAYW1kLmNvbT4gZm9yIDFzdCAzIHBhdGNo
ZXMuIENoZWNrIGZvciAKYmVsb3cgZm9yCgptb3JlIGNvbW1lbnRzLgoKT24gOC8xMy8yMCAxMTow
OCBBTSwgRXZhbiBRdWFuIHdyb3RlOgo+IEFzIG90aGVyIHBvd2VyIGludGVyZmFjZXMuCj4KPiBD
aGFuZ2UtSWQ6IEk1ZTNiODVhZTIxYzRiMWQwMjM5ZjU0ZmE3NTI0N2IzM2NmZGI3ZGRjCj4gU2ln
bmVkLW9mZi1ieTogRXZhbiBRdWFuIDxldmFuLnF1YW5AYW1kLmNvbT4KPiAtLS0KPiAgIGRyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0uYyB8IDQyNSArKysrKysrKysrKysrKysr
KysrKysrKysKPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcG0uaCB8ICAx
NCArCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uYyAgfCA0MjMgLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9wbS5oICB8ICAgOCAtCj4gICA0IGZpbGVzIGNoYW5nZWQsIDQzOSBpbnNlcnRpb25zKCspLCA0
MzEgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2RwbS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5j
Cj4gaW5kZXggMjE5ODE0ODMxOWUyLi5lMTE0YjVjYmQ4YjAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5jCj4gQEAgLTI4LDYgKzI4LDExIEBACj4gICAjaW5jbHVk
ZSAiYW1kZ3B1X2RwbS5oIgo+ICAgI2luY2x1ZGUgImF0b20uaCIKPiAgICNpbmNsdWRlICJhbWRf
cGNpZS5oIgo+ICsjaW5jbHVkZSAiYW1kZ3B1X2Rpc3BsYXkuaCIKPiArI2luY2x1ZGUgImh3bWdy
LmgiCj4gKyNpbmNsdWRlIDxsaW51eC9wb3dlcl9zdXBwbHkuaD4KPiArCj4gKyNkZWZpbmUgV0lE
VEhfNEsgMzg0MAo+ICAgCj4gICB2b2lkIGFtZGdwdV9kcG1fcHJpbnRfY2xhc3NfaW5mbyh1MzIg
Y2xhc3MsIHUzMiBjbGFzczIpCj4gICB7Cj4gQEAgLTEyNjIsMyArMTI2Nyw0MjMgQEAgaW50IGFt
ZGdwdV9kcG1fc211X2kyY19idXNfYWNjZXNzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+
ICAgCj4gICAJcmV0dXJuIHJldDsKPiAgIH0KPiArCj4gK3ZvaWQgYW1kZ3B1X3BtX2FjcGlfZXZl
bnRfaGFuZGxlcihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiArewo+ICsJaWYgKGFkZXYt
PnBtLmRwbV9lbmFibGVkKSB7Cj4gKwkJbXV0ZXhfbG9jaygmYWRldi0+cG0ubXV0ZXgpOwo+ICsJ
CWlmIChwb3dlcl9zdXBwbHlfaXNfc3lzdGVtX3N1cHBsaWVkKCkgPiAwKQo+ICsJCQlhZGV2LT5w
bS5hY19wb3dlciA9IHRydWU7Cj4gKwkJZWxzZQo+ICsJCQlhZGV2LT5wbS5hY19wb3dlciA9IGZh
bHNlOwo+ICsJCWlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MgJiYKPiArCQkgICAgYWRldi0+
cG93ZXJwbGF5LnBwX2Z1bmNzLT5lbmFibGVfYmFwbSkKPiArCQkJYW1kZ3B1X2RwbV9lbmFibGVf
YmFwbShhZGV2LCBhZGV2LT5wbS5hY19wb3dlcik7Cj4gKwkJbXV0ZXhfdW5sb2NrKCZhZGV2LT5w
bS5tdXRleCk7Cj4gKwo+ICsJCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPiArCQkJc211
X3NldF9hY19kYygmYWRldi0+c211KTsKPiArCX0KPiArfQo+ICsKPiAraW50IGFtZGdwdV9kcG1f
cmVhZF9zZW5zb3Ioc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIGVudW0gYW1kX3BwX3NlbnNv
cnMgc2Vuc29yLAo+ICsJCQkgICB2b2lkICpkYXRhLCB1aW50MzJfdCAqc2l6ZSkKPiArewo+ICsJ
aW50IHJldCA9IDA7Cj4gKwo+ICsJaWYgKCFkYXRhIHx8ICFzaXplKQo+ICsJCXJldHVybiAtRUlO
VkFMOwo+ICsKPiArCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPiArCQlyZXQgPSBzbXVf
cmVhZF9zZW5zb3IoJmFkZXYtPnNtdSwgc2Vuc29yLCBkYXRhLCBzaXplKTsKPiArCWVsc2Ugewo+
ICsJCWlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MgJiYgYWRldi0+cG93ZXJwbGF5LnBwX2Z1
bmNzLT5yZWFkX3NlbnNvcikKPiArCQkJcmV0ID0gYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5y
ZWFkX3NlbnNvcigoYWRldiktPnBvd2VycGxheS5wcF9oYW5kbGUsCj4gKwkJCQkJCQkJICAgIHNl
bnNvciwgZGF0YSwgc2l6ZSk7Cj4gKwkJZWxzZQo+ICsJCQlyZXQgPSAtRUlOVkFMOwo+ICsJfQo+
ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK3ZvaWQgYW1kZ3B1X2RwbV90aGVybWFsX3dv
cmtfaGFuZGxlcihzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gK3sKPiArCXN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2ID0KPiArCQljb250YWluZXJfb2Yod29yaywgc3RydWN0IGFtZGdwdV9k
ZXZpY2UsCj4gKwkJCSAgICAgcG0uZHBtLnRoZXJtYWwud29yayk7Cj4gKwkvKiBzd2l0Y2ggdG8g
dGhlIHRoZXJtYWwgc3RhdGUgKi8KPiArCWVudW0gYW1kX3BtX3N0YXRlX3R5cGUgZHBtX3N0YXRl
ID0gUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9USEVSTUFMOwo+ICsJaW50IHRlbXAsIHNpemUg
PSBzaXplb2YodGVtcCk7Cj4gKwo+ICsJaWYgKCFhZGV2LT5wbS5kcG1fZW5hYmxlZCkKPiArCQly
ZXR1cm47Cj4gKwo+ICsJaWYgKCFhbWRncHVfZHBtX3JlYWRfc2Vuc29yKGFkZXYsIEFNREdQVV9Q
UF9TRU5TT1JfR1BVX1RFTVAsCj4gKwkJCQkgICAgKHZvaWQgKikmdGVtcCwgJnNpemUpKSB7Cj4g
KwkJaWYgKHRlbXAgPCBhZGV2LT5wbS5kcG0udGhlcm1hbC5taW5fdGVtcCkKPiArCQkJLyogc3dp
dGNoIGJhY2sgdGhlIHVzZXIgc3RhdGUgKi8KPiArCQkJZHBtX3N0YXRlID0gYWRldi0+cG0uZHBt
LnVzZXJfc3RhdGU7Cj4gKwl9IGVsc2Ugewo+ICsJCWlmIChhZGV2LT5wbS5kcG0udGhlcm1hbC5o
aWdoX3RvX2xvdykKPiArCQkJLyogc3dpdGNoIGJhY2sgdGhlIHVzZXIgc3RhdGUgKi8KPiArCQkJ
ZHBtX3N0YXRlID0gYWRldi0+cG0uZHBtLnVzZXJfc3RhdGU7Cj4gKwl9Cj4gKwltdXRleF9sb2Nr
KCZhZGV2LT5wbS5tdXRleCk7Cj4gKwlpZiAoZHBtX3N0YXRlID09IFBPV0VSX1NUQVRFX1RZUEVf
SU5URVJOQUxfVEhFUk1BTCkKPiArCQlhZGV2LT5wbS5kcG0udGhlcm1hbF9hY3RpdmUgPSB0cnVl
Owo+ICsJZWxzZQo+ICsJCWFkZXYtPnBtLmRwbS50aGVybWFsX2FjdGl2ZSA9IGZhbHNlOwo+ICsJ
YWRldi0+cG0uZHBtLnN0YXRlID0gZHBtX3N0YXRlOwo+ICsJbXV0ZXhfdW5sb2NrKCZhZGV2LT5w
bS5tdXRleCk7Cj4gKwo+ICsJYW1kZ3B1X3BtX2NvbXB1dGVfY2xvY2tzKGFkZXYpOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgc3RydWN0IGFtZGdwdV9wcyAqYW1kZ3B1X2RwbV9waWNrX3Bvd2VyX3N0YXRl
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAo+ICsJCQkJCQkgICAgIGVudW0gYW1kX3BtX3N0
YXRlX3R5cGUgZHBtX3N0YXRlKQo+ICt7Cj4gKwlpbnQgaTsKPiArCXN0cnVjdCBhbWRncHVfcHMg
KnBzOwo+ICsJdTMyIHVpX2NsYXNzOwo+ICsJYm9vbCBzaW5nbGVfZGlzcGxheSA9IChhZGV2LT5w
bS5kcG0ubmV3X2FjdGl2ZV9jcnRjX2NvdW50IDwgMikgPwo+ICsJCXRydWUgOiBmYWxzZTsKPiAr
Cj4gKwkvKiBjaGVjayBpZiB0aGUgdmJsYW5rIHBlcmlvZCBpcyB0b28gc2hvcnQgdG8gYWRqdXN0
IHRoZSBtY2xrICovCj4gKwlpZiAoc2luZ2xlX2Rpc3BsYXkgJiYgYWRldi0+cG93ZXJwbGF5LnBw
X2Z1bmNzLT52YmxhbmtfdG9vX3Nob3J0KSB7Cj4gKwkJaWYgKGFtZGdwdV9kcG1fdmJsYW5rX3Rv
b19zaG9ydChhZGV2KSkKPiArCQkJc2luZ2xlX2Rpc3BsYXkgPSBmYWxzZTsKPiArCX0KPiArCj4g
KwkvKiBjZXJ0YWluIG9sZGVyIGFzaWNzIGhhdmUgYSBzZXBhcmFyZSAzRCBwZXJmb3JtYW5jZSBz
dGF0ZSwKPiArCSAqIHNvIHRyeSB0aGF0IGZpcnN0IGlmIHRoZSB1c2VyIHNlbGVjdGVkIHBlcmZv
cm1hbmNlCj4gKwkgKi8KPiArCWlmIChkcG1fc3RhdGUgPT0gUE9XRVJfU1RBVEVfVFlQRV9QRVJG
T1JNQU5DRSkKPiArCQlkcG1fc3RhdGUgPSBQT1dFUl9TVEFURV9UWVBFX0lOVEVSTkFMXzNEUEVS
RjsKPiArCS8qIGJhbGFuY2VkIHN0YXRlcyBkb24ndCBleGlzdCBhdCB0aGUgbW9tZW50ICovCj4g
KwlpZiAoZHBtX3N0YXRlID09IFBPV0VSX1NUQVRFX1RZUEVfQkFMQU5DRUQpCj4gKwkJZHBtX3N0
YXRlID0gUE9XRVJfU1RBVEVfVFlQRV9QRVJGT1JNQU5DRTsKPiArCj4gK3Jlc3RhcnRfc2VhcmNo
Ogo+ICsJLyogUGljayB0aGUgYmVzdCBwb3dlciBzdGF0ZSBiYXNlZCBvbiBjdXJyZW50IGNvbmRp
dGlvbnMgKi8KPiArCWZvciAoaSA9IDA7IGkgPCBhZGV2LT5wbS5kcG0ubnVtX3BzOyBpKyspIHsK
PiArCQlwcyA9ICZhZGV2LT5wbS5kcG0ucHNbaV07Cj4gKwkJdWlfY2xhc3MgPSBwcy0+Y2xhc3Mg
JiBBVE9NX1BQTElCX0NMQVNTSUZJQ0FUSU9OX1VJX01BU0s7Cj4gKwkJc3dpdGNoIChkcG1fc3Rh
dGUpIHsKPiArCQkvKiB1c2VyIHN0YXRlcyAqLwo+ICsJCWNhc2UgUE9XRVJfU1RBVEVfVFlQRV9C
QVRURVJZOgo+ICsJCQlpZiAodWlfY2xhc3MgPT0gQVRPTV9QUExJQl9DTEFTU0lGSUNBVElPTl9V
SV9CQVRURVJZKSB7Cj4gKwkJCQlpZiAocHMtPmNhcHMgJiBBVE9NX1BQTElCX1NJTkdMRV9ESVNQ
TEFZX09OTFkpIHsKPiArCQkJCQlpZiAoc2luZ2xlX2Rpc3BsYXkpCj4gKwkJCQkJCXJldHVybiBw
czsKPiArCQkJCX0gZWxzZQo+ICsJCQkJCXJldHVybiBwczsKPiArCQkJfQo+ICsJCQlicmVhazsK
PiArCQljYXNlIFBPV0VSX1NUQVRFX1RZUEVfQkFMQU5DRUQ6Cj4gKwkJCWlmICh1aV9jbGFzcyA9
PSBBVE9NX1BQTElCX0NMQVNTSUZJQ0FUSU9OX1VJX0JBTEFOQ0VEKSB7Cj4gKwkJCQlpZiAocHMt
PmNhcHMgJiBBVE9NX1BQTElCX1NJTkdMRV9ESVNQTEFZX09OTFkpIHsKPiArCQkJCQlpZiAoc2lu
Z2xlX2Rpc3BsYXkpCj4gKwkJCQkJCXJldHVybiBwczsKPiArCQkJCX0gZWxzZQo+ICsJCQkJCXJl
dHVybiBwczsKPiArCQkJfQo+ICsJCQlicmVhazsKPiArCQljYXNlIFBPV0VSX1NUQVRFX1RZUEVf
UEVSRk9STUFOQ0U6Cj4gKwkJCWlmICh1aV9jbGFzcyA9PSBBVE9NX1BQTElCX0NMQVNTSUZJQ0FU
SU9OX1VJX1BFUkZPUk1BTkNFKSB7Cj4gKwkJCQlpZiAocHMtPmNhcHMgJiBBVE9NX1BQTElCX1NJ
TkdMRV9ESVNQTEFZX09OTFkpIHsKPiArCQkJCQlpZiAoc2luZ2xlX2Rpc3BsYXkpCj4gKwkJCQkJ
CXJldHVybiBwczsKPiArCQkJCX0gZWxzZQo+ICsJCQkJCXJldHVybiBwczsKPiArCQkJfQo+ICsJ
CQlicmVhazsKPiArCQkvKiBpbnRlcm5hbCBzdGF0ZXMgKi8KPiArCQljYXNlIFBPV0VSX1NUQVRF
X1RZUEVfSU5URVJOQUxfVVZEOgo+ICsJCQlpZiAoYWRldi0+cG0uZHBtLnV2ZF9wcykKPiArCQkJ
CXJldHVybiBhZGV2LT5wbS5kcG0udXZkX3BzOwo+ICsJCQllbHNlCgoKV2UgZG9uJ3QgbmVlZCB0
aGUgImVsc2UiIGhlcmUuCgoKPiArCQkJCWJyZWFrOwo+ICsJCWNhc2UgUE9XRVJfU1RBVEVfVFlQ
RV9JTlRFUk5BTF9VVkRfU0Q6Cj4gKwkJCWlmIChwcy0+Y2xhc3MgJiBBVE9NX1BQTElCX0NMQVNT
SUZJQ0FUSU9OX1NEU1RBVEUpCj4gKwkJCQlyZXR1cm4gcHM7Cj4gKwkJCWJyZWFrOwo+ICsJCWNh
c2UgUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9VVkRfSEQ6Cj4gKwkJCWlmIChwcy0+Y2xhc3Mg
JiBBVE9NX1BQTElCX0NMQVNTSUZJQ0FUSU9OX0hEU1RBVEUpCj4gKwkJCQlyZXR1cm4gcHM7Cj4g
KwkJCWJyZWFrOwo+ICsJCWNhc2UgUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9VVkRfSEQyOgo+
ICsJCQlpZiAocHMtPmNsYXNzICYgQVRPTV9QUExJQl9DTEFTU0lGSUNBVElPTl9IRDJTVEFURSkK
PiArCQkJCXJldHVybiBwczsKPiArCQkJYnJlYWs7Cj4gKwkJY2FzZSBQT1dFUl9TVEFURV9UWVBF
X0lOVEVSTkFMX1VWRF9NVkM6Cj4gKwkJCWlmIChwcy0+Y2xhc3MyICYgQVRPTV9QUExJQl9DTEFT
U0lGSUNBVElPTjJfTVZDKQo+ICsJCQkJcmV0dXJuIHBzOwo+ICsJCQlicmVhazsKPiArCQljYXNl
IFBPV0VSX1NUQVRFX1RZUEVfSU5URVJOQUxfQk9PVDoKPiArCQkJcmV0dXJuIGFkZXYtPnBtLmRw
bS5ib290X3BzOwo+ICsJCWNhc2UgUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9USEVSTUFMOgo+
ICsJCQlpZiAocHMtPmNsYXNzICYgQVRPTV9QUExJQl9DTEFTU0lGSUNBVElPTl9USEVSTUFMKQo+
ICsJCQkJcmV0dXJuIHBzOwo+ICsJCQlicmVhazsKPiArCQljYXNlIFBPV0VSX1NUQVRFX1RZUEVf
SU5URVJOQUxfQUNQSToKPiArCQkJaWYgKHBzLT5jbGFzcyAmIEFUT01fUFBMSUJfQ0xBU1NJRklD
QVRJT05fQUNQSSkKPiArCQkJCXJldHVybiBwczsKPiArCQkJYnJlYWs7Cj4gKwkJY2FzZSBQT1dF
Ul9TVEFURV9UWVBFX0lOVEVSTkFMX1VMVjoKPiArCQkJaWYgKHBzLT5jbGFzczIgJiBBVE9NX1BQ
TElCX0NMQVNTSUZJQ0FUSU9OMl9VTFYpCj4gKwkJCQlyZXR1cm4gcHM7Cj4gKwkJCWJyZWFrOwo+
ICsJCWNhc2UgUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF8zRFBFUkY6Cj4gKwkJCWlmIChwcy0+
Y2xhc3MgJiBBVE9NX1BQTElCX0NMQVNTSUZJQ0FUSU9OXzNEUEVSRk9STUFOQ0UpCj4gKwkJCQly
ZXR1cm4gcHM7Cj4gKwkJCWJyZWFrOwo+ICsJCWRlZmF1bHQ6Cj4gKwkJCWJyZWFrOwo+ICsJCX0K
PiArCX0KPiArCS8qIHVzZSBhIGZhbGxiYWNrIHN0YXRlIGlmIHdlIGRpZG4ndCBtYXRjaCAqLwo+
ICsJc3dpdGNoIChkcG1fc3RhdGUpIHsKPiArCWNhc2UgUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5B
TF9VVkRfU0Q6Cj4gKwkJZHBtX3N0YXRlID0gUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9VVkRf
SEQ7Cj4gKwkJZ290byByZXN0YXJ0X3NlYXJjaDsKPiArCWNhc2UgUE9XRVJfU1RBVEVfVFlQRV9J
TlRFUk5BTF9VVkRfSEQ6Cj4gKwljYXNlIFBPV0VSX1NUQVRFX1RZUEVfSU5URVJOQUxfVVZEX0hE
MjoKPiArCWNhc2UgUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9VVkRfTVZDOgo+ICsJCWlmIChh
ZGV2LT5wbS5kcG0udXZkX3BzKSB7Cj4gKwkJCXJldHVybiBhZGV2LT5wbS5kcG0udXZkX3BzOwo+
ICsJCX0gZWxzZSB7Cj4gKwkJCWRwbV9zdGF0ZSA9IFBPV0VSX1NUQVRFX1RZUEVfUEVSRk9STUFO
Q0U7Cj4gKwkJCWdvdG8gcmVzdGFydF9zZWFyY2g7Cj4gKwkJfQo+ICsJY2FzZSBQT1dFUl9TVEFU
RV9UWVBFX0lOVEVSTkFMX1RIRVJNQUw6Cj4gKwkJZHBtX3N0YXRlID0gUE9XRVJfU1RBVEVfVFlQ
RV9JTlRFUk5BTF9BQ1BJOwo+ICsJCWdvdG8gcmVzdGFydF9zZWFyY2g7Cj4gKwljYXNlIFBPV0VS
X1NUQVRFX1RZUEVfSU5URVJOQUxfQUNQSToKPiArCQlkcG1fc3RhdGUgPSBQT1dFUl9TVEFURV9U
WVBFX0JBVFRFUlk7Cj4gKwkJZ290byByZXN0YXJ0X3NlYXJjaDsKPiArCWNhc2UgUE9XRVJfU1RB
VEVfVFlQRV9CQVRURVJZOgo+ICsJY2FzZSBQT1dFUl9TVEFURV9UWVBFX0JBTEFOQ0VEOgo+ICsJ
Y2FzZSBQT1dFUl9TVEFURV9UWVBFX0lOVEVSTkFMXzNEUEVSRjoKPiArCQlkcG1fc3RhdGUgPSBQ
T1dFUl9TVEFURV9UWVBFX1BFUkZPUk1BTkNFOwo+ICsJCWdvdG8gcmVzdGFydF9zZWFyY2g7CgoK
SSB0aGluayBpdCB3aWxsIGJlIGEgZ29vZCBpZGVhIHRvIG1vdmUgcmVzdGFydF9zZWFyY2ggYmxv
Y2sgdG8gYSAKZnVuY3Rpb24gc28gd2UgY2FuIGVhc2lseQoKcnVsZSBvdXQgYW55IGluZmluaXRl
IGxvb3BzIHdpdGggImdvdG8gcmVzdGFydF9zZWFyY2giIHVzYWdlcy4KCgoKPiArCWRlZmF1bHQ6
Cj4gKwkJYnJlYWs7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIE5VTEw7Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkIGFtZGdwdV9kcG1fY2hhbmdlX3Bvd2VyX3N0YXRlX2xvY2tlZChzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqYWRldikKPiArewo+ICsJc3RydWN0IGFtZGdwdV9wcyAqcHM7Cj4gKwllbnVtIGFt
ZF9wbV9zdGF0ZV90eXBlIGRwbV9zdGF0ZTsKPiArCWludCByZXQ7Cj4gKwlib29sIGVxdWFsID0g
ZmFsc2U7Cj4gKwo+ICsJLyogaWYgZHBtIGluaXQgZmFpbGVkICovCj4gKwlpZiAoIWFkZXYtPnBt
LmRwbV9lbmFibGVkKQo+ICsJCXJldHVybjsKPiArCj4gKwlpZiAoYWRldi0+cG0uZHBtLnVzZXJf
c3RhdGUgIT0gYWRldi0+cG0uZHBtLnN0YXRlKSB7Cj4gKwkJLyogYWRkIG90aGVyIHN0YXRlIG92
ZXJyaWRlIGNoZWNrcyBoZXJlICovCj4gKwkJaWYgKCghYWRldi0+cG0uZHBtLnRoZXJtYWxfYWN0
aXZlKSAmJgo+ICsJCSAgICAoIWFkZXYtPnBtLmRwbS51dmRfYWN0aXZlKSkKPiArCQkJYWRldi0+
cG0uZHBtLnN0YXRlID0gYWRldi0+cG0uZHBtLnVzZXJfc3RhdGU7Cj4gKwl9Cj4gKwlkcG1fc3Rh
dGUgPSBhZGV2LT5wbS5kcG0uc3RhdGU7Cj4gKwo+ICsJcHMgPSBhbWRncHVfZHBtX3BpY2tfcG93
ZXJfc3RhdGUoYWRldiwgZHBtX3N0YXRlKTsKPiArCWlmIChwcykKPiArCQlhZGV2LT5wbS5kcG0u
cmVxdWVzdGVkX3BzID0gcHM7Cj4gKwllbHNlCj4gKwkJcmV0dXJuOwoKCm5pdHBpY2s6CgppZigh
bnMpCgogwqDCoMKgIHJldHVybjsKCmFkZXYtPnBtLmRwbS5yZXF1ZXN0ZWRfcHMgPSBwczsKCgo+
ICsKPiArCWlmIChhbWRncHVfZHBtID09IDEgJiYgYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5w
cmludF9wb3dlcl9zdGF0ZSkgewo+ICsJCXByaW50aygic3dpdGNoaW5nIGZyb20gcG93ZXIgc3Rh
dGU6XG4iKTsKPiArCQlhbWRncHVfZHBtX3ByaW50X3Bvd2VyX3N0YXRlKGFkZXYsIGFkZXYtPnBt
LmRwbS5jdXJyZW50X3BzKTsKPiArCQlwcmludGsoInN3aXRjaGluZyB0byBwb3dlciBzdGF0ZTpc
biIpOwo+ICsJCWFtZGdwdV9kcG1fcHJpbnRfcG93ZXJfc3RhdGUoYWRldiwgYWRldi0+cG0uZHBt
LnJlcXVlc3RlZF9wcyk7Cj4gKwl9Cj4gKwo+ICsJLyogdXBkYXRlIHdoZXRoZXIgdmNlIGlzIGFj
dGl2ZSAqLwo+ICsJcHMtPnZjZV9hY3RpdmUgPSBhZGV2LT5wbS5kcG0udmNlX2FjdGl2ZTsKPiAr
CWlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmRpc3BsYXlfY29uZmlndXJhdGlvbl9jaGFu
Z2VkKQo+ICsJCWFtZGdwdV9kcG1fZGlzcGxheV9jb25maWd1cmF0aW9uX2NoYW5nZWQoYWRldik7
Cj4gKwo+ICsJcmV0ID0gYW1kZ3B1X2RwbV9wcmVfc2V0X3Bvd2VyX3N0YXRlKGFkZXYpOwo+ICsJ
aWYgKHJldCkKPiArCQlyZXR1cm47Cj4gKwo+ICsJaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5j
cy0+Y2hlY2tfc3RhdGVfZXF1YWwpIHsKPiArCQlpZiAoMCAhPSBhbWRncHVfZHBtX2NoZWNrX3N0
YXRlX2VxdWFsKGFkZXYsIGFkZXYtPnBtLmRwbS5jdXJyZW50X3BzLCBhZGV2LT5wbS5kcG0ucmVx
dWVzdGVkX3BzLCAmZXF1YWwpKQoKCldlIGRvbid0IG5lZWQgdGhhdCBjaGVjayBhcyBhbWRncHVf
ZHBtX2NoZWNrX3N0YXRlX2VxdWFsKCkgc2hvdWxkIG5vdCAKbW9kaWZ5IChkZWZhdWx0KXZhbHVl
IG9mCgoiZXF1YWwiIG9uIGVycm9yLgoKCk5pcm1veQoKPiArCQkJZXF1YWwgPSBmYWxzZTsKPiAr
CX0KPiArCj4gKwlpZiAoZXF1YWwpCj4gKwkJcmV0dXJuOwo+ICsKPiArCWFtZGdwdV9kcG1fc2V0
X3Bvd2VyX3N0YXRlKGFkZXYpOwo+ICsJYW1kZ3B1X2RwbV9wb3N0X3NldF9wb3dlcl9zdGF0ZShh
ZGV2KTsKPiArCj4gKwlhZGV2LT5wbS5kcG0uY3VycmVudF9hY3RpdmVfY3J0Y3MgPSBhZGV2LT5w
bS5kcG0ubmV3X2FjdGl2ZV9jcnRjczsKPiArCWFkZXYtPnBtLmRwbS5jdXJyZW50X2FjdGl2ZV9j
cnRjX2NvdW50ID0gYWRldi0+cG0uZHBtLm5ld19hY3RpdmVfY3J0Y19jb3VudDsKPiArCj4gKwlp
ZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbCkgewo+
ICsJCWlmIChhZGV2LT5wbS5kcG0udGhlcm1hbF9hY3RpdmUpIHsKPiArCQkJZW51bSBhbWRfZHBt
X2ZvcmNlZF9sZXZlbCBsZXZlbCA9IGFkZXYtPnBtLmRwbS5mb3JjZWRfbGV2ZWw7Cj4gKwkJCS8q
IGZvcmNlIGxvdyBwZXJmIGxldmVsIGZvciB0aGVybWFsICovCj4gKwkJCWFtZGdwdV9kcG1fZm9y
Y2VfcGVyZm9ybWFuY2VfbGV2ZWwoYWRldiwgQU1EX0RQTV9GT1JDRURfTEVWRUxfTE9XKTsKPiAr
CQkJLyogc2F2ZSB0aGUgdXNlcidzIGxldmVsICovCj4gKwkJCWFkZXYtPnBtLmRwbS5mb3JjZWRf
bGV2ZWwgPSBsZXZlbDsKPiArCQl9IGVsc2Ugewo+ICsJCQkvKiBvdGhlcndpc2UsIHVzZXIgc2Vs
ZWN0ZWQgbGV2ZWwgKi8KPiArCQkJYW1kZ3B1X2RwbV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbChh
ZGV2LCBhZGV2LT5wbS5kcG0uZm9yY2VkX2xldmVsKTsKPiArCQl9Cj4gKwl9Cj4gK30KPiArCj4g
K3ZvaWQgYW1kZ3B1X3BtX2NvbXB1dGVfY2xvY2tzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
KQo+ICt7Cj4gKwlpbnQgaSA9IDA7Cj4gKwo+ICsJaWYgKCFhZGV2LT5wbS5kcG1fZW5hYmxlZCkK
PiArCQlyZXR1cm47Cj4gKwo+ICsJaWYgKGFkZXYtPm1vZGVfaW5mby5udW1fY3J0YykKPiArCQlh
bWRncHVfZGlzcGxheV9iYW5kd2lkdGhfdXBkYXRlKGFkZXYpOwo+ICsKPiArCWZvciAoaSA9IDA7
IGkgPCBBTURHUFVfTUFYX1JJTkdTOyBpKyspIHsKPiArCQlzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJp
bmcgPSBhZGV2LT5yaW5nc1tpXTsKPiArCQlpZiAocmluZyAmJiByaW5nLT5zY2hlZC5yZWFkeSkK
PiArCQkJYW1kZ3B1X2ZlbmNlX3dhaXRfZW1wdHkocmluZyk7Cj4gKwl9Cj4gKwo+ICsJaWYgKGlz
X3N1cHBvcnRfc3dfc211KGFkZXYpKSB7Cj4gKwkJc3RydWN0IHNtdV9kcG1fY29udGV4dCAqc211
X2RwbSA9ICZhZGV2LT5zbXUuc211X2RwbTsKPiArCQlzbXVfaGFuZGxlX3Rhc2soJmFkZXYtPnNt
dSwKPiArCQkJCXNtdV9kcG0tPmRwbV9sZXZlbCwKPiArCQkJCUFNRF9QUF9UQVNLX0RJU1BMQVlf
Q09ORklHX0NIQU5HRSwKPiArCQkJCXRydWUpOwo+ICsJfSBlbHNlIHsKPiArCQlpZiAoYWRldi0+
cG93ZXJwbGF5LnBwX2Z1bmNzLT5kaXNwYXRjaF90YXNrcykgewo+ICsJCQlpZiAoIWFtZGdwdV9k
ZXZpY2VfaGFzX2RjX3N1cHBvcnQoYWRldikpIHsKPiArCQkJCW11dGV4X2xvY2soJmFkZXYtPnBt
Lm11dGV4KTsKPiArCQkJCWFtZGdwdV9kcG1fZ2V0X2FjdGl2ZV9kaXNwbGF5cyhhZGV2KTsKPiAr
CQkJCWFkZXYtPnBtLnBtX2Rpc3BsYXlfY2ZnLm51bV9kaXNwbGF5ID0gYWRldi0+cG0uZHBtLm5l
d19hY3RpdmVfY3J0Y19jb3VudDsKPiArCQkJCWFkZXYtPnBtLnBtX2Rpc3BsYXlfY2ZnLnZyZWZy
ZXNoID0gYW1kZ3B1X2RwbV9nZXRfdnJlZnJlc2goYWRldik7Cj4gKwkJCQlhZGV2LT5wbS5wbV9k
aXNwbGF5X2NmZy5taW5fdmJsYW5rX3RpbWUgPSBhbWRncHVfZHBtX2dldF92YmxhbmtfdGltZShh
ZGV2KTsKPiArCQkJCS8qIHdlIGhhdmUgaXNzdWVzIHdpdGggbWNsayBzd2l0Y2hpbmcgd2l0aCBy
ZWZyZXNoIHJhdGVzIG92ZXIgMTIwIGh6IG9uIHRoZSBub24tREMgY29kZS4gKi8KPiArCQkJCWlm
IChhZGV2LT5wbS5wbV9kaXNwbGF5X2NmZy52cmVmcmVzaCA+IDEyMCkKPiArCQkJCQlhZGV2LT5w
bS5wbV9kaXNwbGF5X2NmZy5taW5fdmJsYW5rX3RpbWUgPSAwOwo+ICsJCQkJaWYgKGFkZXYtPnBv
d2VycGxheS5wcF9mdW5jcy0+ZGlzcGxheV9jb25maWd1cmF0aW9uX2NoYW5nZSkKPiArCQkJCQlh
ZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmRpc3BsYXlfY29uZmlndXJhdGlvbl9jaGFuZ2UoCj4g
KwkJCQkJCQkJCWFkZXYtPnBvd2VycGxheS5wcF9oYW5kbGUsCj4gKwkJCQkJCQkJCSZhZGV2LT5w
bS5wbV9kaXNwbGF5X2NmZyk7Cj4gKwkJCQltdXRleF91bmxvY2soJmFkZXYtPnBtLm11dGV4KTsK
PiArCQkJfQo+ICsJCQlhbWRncHVfZHBtX2Rpc3BhdGNoX3Rhc2soYWRldiwgQU1EX1BQX1RBU0tf
RElTUExBWV9DT05GSUdfQ0hBTkdFLCBOVUxMKTsKPiArCQl9IGVsc2Ugewo+ICsJCQltdXRleF9s
b2NrKCZhZGV2LT5wbS5tdXRleCk7Cj4gKwkJCWFtZGdwdV9kcG1fZ2V0X2FjdGl2ZV9kaXNwbGF5
cyhhZGV2KTsKPiArCQkJYW1kZ3B1X2RwbV9jaGFuZ2VfcG93ZXJfc3RhdGVfbG9ja2VkKGFkZXYp
Owo+ICsJCQltdXRleF91bmxvY2soJmFkZXYtPnBtLm11dGV4KTsKPiArCQl9Cj4gKwl9Cj4gK30K
PiArCj4gK3ZvaWQgYW1kZ3B1X2RwbV9lbmFibGVfdXZkKHN0cnVjdCBhbWRncHVfZGV2aWNlICph
ZGV2LCBib29sIGVuYWJsZSkKPiArewo+ICsJaW50IHJldCA9IDA7Cj4gKwo+ICsJaWYgKGFkZXYt
PmZhbWlseSA9PSBBTURHUFVfRkFNSUxZX1NJKSB7Cj4gKwkJbXV0ZXhfbG9jaygmYWRldi0+cG0u
bXV0ZXgpOwo+ICsJCWlmIChlbmFibGUpIHsKPiArCQkJYWRldi0+cG0uZHBtLnV2ZF9hY3RpdmUg
PSB0cnVlOwo+ICsJCQlhZGV2LT5wbS5kcG0uc3RhdGUgPSBQT1dFUl9TVEFURV9UWVBFX0lOVEVS
TkFMX1VWRDsKPiArCQl9IGVsc2Ugewo+ICsJCQlhZGV2LT5wbS5kcG0udXZkX2FjdGl2ZSA9IGZh
bHNlOwo+ICsJCX0KPiArCQltdXRleF91bmxvY2soJmFkZXYtPnBtLm11dGV4KTsKPiArCj4gKwkJ
YW1kZ3B1X3BtX2NvbXB1dGVfY2xvY2tzKGFkZXYpOwo+ICsJfSBlbHNlIHsKPiArCQlyZXQgPSBh
bWRncHVfZHBtX3NldF9wb3dlcmdhdGluZ19ieV9zbXUoYWRldiwgQU1EX0lQX0JMT0NLX1RZUEVf
VVZELCAhZW5hYmxlKTsKPiArCQlpZiAocmV0KQo+ICsJCQlEUk1fRVJST1IoIkRwbSAlcyB1dmQg
ZmFpbGVkLCByZXQgPSAlZC4gXG4iLAo+ICsJCQkJICBlbmFibGUgPyAiZW5hYmxlIiA6ICJkaXNh
YmxlIiwgcmV0KTsKPiArCj4gKwkJLyogZW5hYmxlL2Rpc2FibGUgTG93IE1lbW9yeSBQU3RhdGUg
Zm9yIFVWRCAoNGsgdmlkZW9zKSAqLwo+ICsJCWlmIChhZGV2LT5hc2ljX3R5cGUgPT0gQ0hJUF9T
VE9ORVkgJiYKPiArCQkJYWRldi0+dXZkLmRlY29kZV9pbWFnZV93aWR0aCA+PSBXSURUSF80Sykg
ewo+ICsJCQlzdHJ1Y3QgcHBfaHdtZ3IgKmh3bWdyID0gYWRldi0+cG93ZXJwbGF5LnBwX2hhbmRs
ZTsKPiArCj4gKwkJCWlmIChod21nciAmJiBod21nci0+aHdtZ3JfZnVuYyAmJgo+ICsJCQkgICAg
aHdtZ3ItPmh3bWdyX2Z1bmMtPnVwZGF0ZV9uYmRwbV9wc3RhdGUpCj4gKwkJCQlod21nci0+aHdt
Z3JfZnVuYy0+dXBkYXRlX25iZHBtX3BzdGF0ZShod21nciwKPiArCQkJCQkJCQkgICAgICAgIWVu
YWJsZSwKPiArCQkJCQkJCQkgICAgICAgdHJ1ZSk7Cj4gKwkJfQo+ICsJfQo+ICt9Cj4gKwo+ICt2
b2lkIGFtZGdwdV9kcG1fZW5hYmxlX3ZjZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9v
bCBlbmFibGUpCj4gK3sKPiArCWludCByZXQgPSAwOwo+ICsKPiArCWlmIChhZGV2LT5mYW1pbHkg
PT0gQU1ER1BVX0ZBTUlMWV9TSSkgewo+ICsJCW11dGV4X2xvY2soJmFkZXYtPnBtLm11dGV4KTsK
PiArCQlpZiAoZW5hYmxlKSB7Cj4gKwkJCWFkZXYtPnBtLmRwbS52Y2VfYWN0aXZlID0gdHJ1ZTsK
PiArCQkJLyogWFhYIHNlbGVjdCB2Y2UgbGV2ZWwgYmFzZWQgb24gcmluZy90YXNrICovCj4gKwkJ
CWFkZXYtPnBtLmRwbS52Y2VfbGV2ZWwgPSBBTURfVkNFX0xFVkVMX0FDX0FMTDsKPiArCQl9IGVs
c2Ugewo+ICsJCQlhZGV2LT5wbS5kcG0udmNlX2FjdGl2ZSA9IGZhbHNlOwo+ICsJCX0KPiArCQlt
dXRleF91bmxvY2soJmFkZXYtPnBtLm11dGV4KTsKPiArCj4gKwkJYW1kZ3B1X3BtX2NvbXB1dGVf
Y2xvY2tzKGFkZXYpOwo+ICsJfSBlbHNlIHsKPiArCQlyZXQgPSBhbWRncHVfZHBtX3NldF9wb3dl
cmdhdGluZ19ieV9zbXUoYWRldiwgQU1EX0lQX0JMT0NLX1RZUEVfVkNFLCAhZW5hYmxlKTsKPiAr
CQlpZiAocmV0KQo+ICsJCQlEUk1fRVJST1IoIkRwbSAlcyB2Y2UgZmFpbGVkLCByZXQgPSAlZC4g
XG4iLAo+ICsJCQkJICBlbmFibGUgPyAiZW5hYmxlIiA6ICJkaXNhYmxlIiwgcmV0KTsKPiArCX0K
PiArfQo+ICsKPiArdm9pZCBhbWRncHVfcG1fcHJpbnRfcG93ZXJfc3RhdGVzKHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2KQo+ICt7Cj4gKwlpbnQgaTsKPiArCj4gKwlpZiAoYWRldi0+cG93ZXJw
bGF5LnBwX2Z1bmNzLT5wcmludF9wb3dlcl9zdGF0ZSA9PSBOVUxMKQo+ICsJCXJldHVybjsKPiAr
Cj4gKwlmb3IgKGkgPSAwOyBpIDwgYWRldi0+cG0uZHBtLm51bV9wczsgaSsrKQo+ICsJCWFtZGdw
dV9kcG1fcHJpbnRfcG93ZXJfc3RhdGUoYWRldiwgJmFkZXYtPnBtLmRwbS5wc1tpXSk7Cj4gKwo+
ICt9Cj4gKwo+ICt2b2lkIGFtZGdwdV9kcG1fZW5hYmxlX2pwZWcoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsIGJvb2wgZW5hYmxlKQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwlyZXQg
PSBhbWRncHVfZHBtX3NldF9wb3dlcmdhdGluZ19ieV9zbXUoYWRldiwgQU1EX0lQX0JMT0NLX1RZ
UEVfSlBFRywgIWVuYWJsZSk7Cj4gKwlpZiAocmV0KQo+ICsJCURSTV9FUlJPUigiRHBtICVzIGpw
ZWcgZmFpbGVkLCByZXQgPSAlZC4gXG4iLAo+ICsJCQkgIGVuYWJsZSA/ICJlbmFibGUiIDogImRp
c2FibGUiLCByZXQpOwo+ICt9Cj4gKwo+ICtpbnQgYW1kZ3B1X3BtX2xvYWRfc211X2Zpcm13YXJl
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1aW50MzJfdCAqc211X3ZlcnNpb24pCj4gK3sK
PiArCWludCByOwo+ICsKPiArCWlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MgJiYgYWRldi0+
cG93ZXJwbGF5LnBwX2Z1bmNzLT5sb2FkX2Zpcm13YXJlKSB7Cj4gKwkJciA9IGFkZXYtPnBvd2Vy
cGxheS5wcF9mdW5jcy0+bG9hZF9maXJtd2FyZShhZGV2LT5wb3dlcnBsYXkucHBfaGFuZGxlKTsK
PiArCQlpZiAocikgewo+ICsJCQlwcl9lcnIoInNtdSBmaXJtd2FyZSBsb2FkaW5nIGZhaWxlZFxu
Iik7Cj4gKwkJCXJldHVybiByOwo+ICsJCX0KPiArCQkqc211X3ZlcnNpb24gPSBhZGV2LT5wbS5m
d192ZXJzaW9uOwo+ICsJfQo+ICsJcmV0dXJuIDA7Cj4gK30KPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2RwbS5oCj4gaW5kZXggNWEyMzQ0ZjgzOWYyLi5kZmY0YTVmOTliYjAgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5oCj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RwbS5oCj4gQEAgLTU0OCw0ICs1
NDgsMTggQEAgaW50IGFtZGdwdV9kcG1fc2V0X2Nsb2NrZ2F0aW5nX2J5X3NtdShzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiwKPiAgIGludCBhbWRncHVfZHBtX3NtdV9pMmNfYnVzX2FjY2Vzcyhz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgIAkJCQkgIGJvb2wgYWNxdWlyZSk7Cj4gICAK
PiArdm9pZCBhbWRncHVfcG1fYWNwaV9ldmVudF9oYW5kbGVyKHN0cnVjdCBhbWRncHVfZGV2aWNl
ICphZGV2KTsKPiArCj4gK2ludCBhbWRncHVfZHBtX3JlYWRfc2Vuc29yKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2LCBlbnVtIGFtZF9wcF9zZW5zb3JzIHNlbnNvciwKPiArCQkJICAgdm9pZCAq
ZGF0YSwgdWludDMyX3QgKnNpemUpOwo+ICsKPiArdm9pZCBhbWRncHVfZHBtX3RoZXJtYWxfd29y
a19oYW5kbGVyKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yayk7Cj4gKwo+ICt2b2lkIGFtZGdwdV9w
bV9jb21wdXRlX2Nsb2NrcyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldik7Cj4gK3ZvaWQgYW1k
Z3B1X2RwbV9lbmFibGVfdXZkKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBib29sIGVuYWJs
ZSk7Cj4gK3ZvaWQgYW1kZ3B1X2RwbV9lbmFibGVfdmNlKHN0cnVjdCBhbWRncHVfZGV2aWNlICph
ZGV2LCBib29sIGVuYWJsZSk7Cj4gK3ZvaWQgYW1kZ3B1X2RwbV9lbmFibGVfanBlZyhzdHJ1Y3Qg
YW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCBlbmFibGUpOwo+ICt2b2lkIGFtZGdwdV9wbV9wcmlu
dF9wb3dlcl9zdGF0ZXMoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpOwo+ICtpbnQgYW1kZ3B1
X3BtX2xvYWRfc211X2Zpcm13YXJlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1aW50MzJf
dCAqc211X3ZlcnNpb24pOwo+ICsKPiAgICNlbmRpZgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9wbS5jCj4gaW5kZXggMTcwNWUzMjhjNmZjLi45ODc0Zjk0N2UyYWQgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BtLmMKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uYwo+IEBAIC0yOSwxNyArMjksMTQgQEAK
PiAgICNpbmNsdWRlICJhbWRncHVfZHJ2LmgiCj4gICAjaW5jbHVkZSAiYW1kZ3B1X3BtLmgiCj4g
ICAjaW5jbHVkZSAiYW1kZ3B1X2RwbS5oIgo+IC0jaW5jbHVkZSAiYW1kZ3B1X2Rpc3BsYXkuaCIK
PiAgICNpbmNsdWRlICJhbWRncHVfc211LmgiCj4gICAjaW5jbHVkZSAiYXRvbS5oIgo+IC0jaW5j
bHVkZSA8bGludXgvcG93ZXJfc3VwcGx5Lmg+Cj4gICAjaW5jbHVkZSA8bGludXgvcGNpLmg+Cj4g
ICAjaW5jbHVkZSA8bGludXgvaHdtb24uaD4KPiAgICNpbmNsdWRlIDxsaW51eC9od21vbi1zeXNm
cy5oPgo+ICAgI2luY2x1ZGUgPGxpbnV4L25vc3BlYy5oPgo+ICAgI2luY2x1ZGUgPGxpbnV4L3Bt
X3J1bnRpbWUuaD4KPiAgICNpbmNsdWRlICJod21nci5oIgo+IC0jZGVmaW5lIFdJRFRIXzRLIDM4
NDAKPiAgIAo+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBjZ19mbGFnX25hbWUgY2xvY2tzW10gPSB7
Cj4gICAJe0FNRF9DR19TVVBQT1JUX0dGWF9NR0NHLCAiR3JhcGhpY3MgTWVkaXVtIEdyYWluIENs
b2NrIEdhdGluZyJ9LAo+IEBAIC04MSw0NSArNzgsNiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGh3
bW9uX3RlbXBfbGFiZWwgewo+ICAgCXtQUF9URU1QX01FTSwgIm1lbSJ9LAo+ICAgfTsKPiAgIAo+
IC12b2lkIGFtZGdwdV9wbV9hY3BpX2V2ZW50X2hhbmRsZXIoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYpCj4gLXsKPiAtCWlmIChhZGV2LT5wbS5kcG1fZW5hYmxlZCkgewo+IC0JCW11dGV4X2xv
Y2soJmFkZXYtPnBtLm11dGV4KTsKPiAtCQlpZiAocG93ZXJfc3VwcGx5X2lzX3N5c3RlbV9zdXBw
bGllZCgpID4gMCkKPiAtCQkJYWRldi0+cG0uYWNfcG93ZXIgPSB0cnVlOwo+IC0JCWVsc2UKPiAt
CQkJYWRldi0+cG0uYWNfcG93ZXIgPSBmYWxzZTsKPiAtCQlpZiAoYWRldi0+cG93ZXJwbGF5LnBw
X2Z1bmNzICYmCj4gLQkJICAgIGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+ZW5hYmxlX2JhcG0p
Cj4gLQkJCWFtZGdwdV9kcG1fZW5hYmxlX2JhcG0oYWRldiwgYWRldi0+cG0uYWNfcG93ZXIpOwo+
IC0JCW11dGV4X3VubG9jaygmYWRldi0+cG0ubXV0ZXgpOwo+IC0KPiAtCQlpZiAoaXNfc3VwcG9y
dF9zd19zbXUoYWRldikpCj4gLQkJCXNtdV9zZXRfYWNfZGMoJmFkZXYtPnNtdSk7Cj4gLQl9Cj4g
LX0KPiAtCj4gLWludCBhbWRncHVfZHBtX3JlYWRfc2Vuc29yKHN0cnVjdCBhbWRncHVfZGV2aWNl
ICphZGV2LCBlbnVtIGFtZF9wcF9zZW5zb3JzIHNlbnNvciwKPiAtCQkJICAgdm9pZCAqZGF0YSwg
dWludDMyX3QgKnNpemUpCj4gLXsKPiAtCWludCByZXQgPSAwOwo+IC0KPiAtCWlmICghZGF0YSB8
fCAhc2l6ZSkKPiAtCQlyZXR1cm4gLUVJTlZBTDsKPiAtCj4gLQlpZiAoaXNfc3VwcG9ydF9zd19z
bXUoYWRldikpCj4gLQkJcmV0ID0gc211X3JlYWRfc2Vuc29yKCZhZGV2LT5zbXUsIHNlbnNvciwg
ZGF0YSwgc2l6ZSk7Cj4gLQllbHNlIHsKPiAtCQlpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNz
ICYmIGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+cmVhZF9zZW5zb3IpCj4gLQkJCXJldCA9IGFk
ZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+cmVhZF9zZW5zb3IoKGFkZXYpLT5wb3dlcnBsYXkucHBf
aGFuZGxlLAo+IC0JCQkJCQkJCSAgICBzZW5zb3IsIGRhdGEsIHNpemUpOwo+IC0JCWVsc2UKPiAt
CQkJcmV0ID0gLUVJTlZBTDsKPiAtCX0KPiAtCj4gLQlyZXR1cm4gcmV0Owo+IC19Cj4gLQo+ICAg
LyoqCj4gICAgKiBET0M6IHBvd2VyX2RwbV9zdGF0ZQo+ICAgICoKPiBAQCAtMzYzNiwzMzggKzM1
OTQsNiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCAqaHdtb25fZ3JvdXBz
W10gPSB7Cj4gICAJTlVMTAo+ICAgfTsKPiAgIAo+IC12b2lkIGFtZGdwdV9kcG1fdGhlcm1hbF93
b3JrX2hhbmRsZXIoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+IC17Cj4gLQlzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiA9Cj4gLQkJY29udGFpbmVyX29mKHdvcmssIHN0cnVjdCBhbWRncHVf
ZGV2aWNlLAo+IC0JCQkgICAgIHBtLmRwbS50aGVybWFsLndvcmspOwo+IC0JLyogc3dpdGNoIHRv
IHRoZSB0aGVybWFsIHN0YXRlICovCj4gLQllbnVtIGFtZF9wbV9zdGF0ZV90eXBlIGRwbV9zdGF0
ZSA9IFBPV0VSX1NUQVRFX1RZUEVfSU5URVJOQUxfVEhFUk1BTDsKPiAtCWludCB0ZW1wLCBzaXpl
ID0gc2l6ZW9mKHRlbXApOwo+IC0KPiAtCWlmICghYWRldi0+cG0uZHBtX2VuYWJsZWQpCj4gLQkJ
cmV0dXJuOwo+IC0KPiAtCWlmICghYW1kZ3B1X2RwbV9yZWFkX3NlbnNvcihhZGV2LCBBTURHUFVf
UFBfU0VOU09SX0dQVV9URU1QLAo+IC0JCQkJICAgICh2b2lkICopJnRlbXAsICZzaXplKSkgewo+
IC0JCWlmICh0ZW1wIDwgYWRldi0+cG0uZHBtLnRoZXJtYWwubWluX3RlbXApCj4gLQkJCS8qIHN3
aXRjaCBiYWNrIHRoZSB1c2VyIHN0YXRlICovCj4gLQkJCWRwbV9zdGF0ZSA9IGFkZXYtPnBtLmRw
bS51c2VyX3N0YXRlOwo+IC0JfSBlbHNlIHsKPiAtCQlpZiAoYWRldi0+cG0uZHBtLnRoZXJtYWwu
aGlnaF90b19sb3cpCj4gLQkJCS8qIHN3aXRjaCBiYWNrIHRoZSB1c2VyIHN0YXRlICovCj4gLQkJ
CWRwbV9zdGF0ZSA9IGFkZXYtPnBtLmRwbS51c2VyX3N0YXRlOwo+IC0JfQo+IC0JbXV0ZXhfbG9j
aygmYWRldi0+cG0ubXV0ZXgpOwo+IC0JaWYgKGRwbV9zdGF0ZSA9PSBQT1dFUl9TVEFURV9UWVBF
X0lOVEVSTkFMX1RIRVJNQUwpCj4gLQkJYWRldi0+cG0uZHBtLnRoZXJtYWxfYWN0aXZlID0gdHJ1
ZTsKPiAtCWVsc2UKPiAtCQlhZGV2LT5wbS5kcG0udGhlcm1hbF9hY3RpdmUgPSBmYWxzZTsKPiAt
CWFkZXYtPnBtLmRwbS5zdGF0ZSA9IGRwbV9zdGF0ZTsKPiAtCW11dGV4X3VubG9jaygmYWRldi0+
cG0ubXV0ZXgpOwo+IC0KPiAtCWFtZGdwdV9wbV9jb21wdXRlX2Nsb2NrcyhhZGV2KTsKPiAtfQo+
IC0KPiAtc3RhdGljIHN0cnVjdCBhbWRncHVfcHMgKmFtZGdwdV9kcG1fcGlja19wb3dlcl9zdGF0
ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAtCQkJCQkJICAgICBlbnVtIGFtZF9wbV9z
dGF0ZV90eXBlIGRwbV9zdGF0ZSkKPiAtewo+IC0JaW50IGk7Cj4gLQlzdHJ1Y3QgYW1kZ3B1X3Bz
ICpwczsKPiAtCXUzMiB1aV9jbGFzczsKPiAtCWJvb2wgc2luZ2xlX2Rpc3BsYXkgPSAoYWRldi0+
cG0uZHBtLm5ld19hY3RpdmVfY3J0Y19jb3VudCA8IDIpID8KPiAtCQl0cnVlIDogZmFsc2U7Cj4g
LQo+IC0JLyogY2hlY2sgaWYgdGhlIHZibGFuayBwZXJpb2QgaXMgdG9vIHNob3J0IHRvIGFkanVz
dCB0aGUgbWNsayAqLwo+IC0JaWYgKHNpbmdsZV9kaXNwbGF5ICYmIGFkZXYtPnBvd2VycGxheS5w
cF9mdW5jcy0+dmJsYW5rX3Rvb19zaG9ydCkgewo+IC0JCWlmIChhbWRncHVfZHBtX3ZibGFua190
b29fc2hvcnQoYWRldikpCj4gLQkJCXNpbmdsZV9kaXNwbGF5ID0gZmFsc2U7Cj4gLQl9Cj4gLQo+
IC0JLyogY2VydGFpbiBvbGRlciBhc2ljcyBoYXZlIGEgc2VwYXJhcmUgM0QgcGVyZm9ybWFuY2Ug
c3RhdGUsCj4gLQkgKiBzbyB0cnkgdGhhdCBmaXJzdCBpZiB0aGUgdXNlciBzZWxlY3RlZCBwZXJm
b3JtYW5jZQo+IC0JICovCj4gLQlpZiAoZHBtX3N0YXRlID09IFBPV0VSX1NUQVRFX1RZUEVfUEVS
Rk9STUFOQ0UpCj4gLQkJZHBtX3N0YXRlID0gUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF8zRFBF
UkY7Cj4gLQkvKiBiYWxhbmNlZCBzdGF0ZXMgZG9uJ3QgZXhpc3QgYXQgdGhlIG1vbWVudCAqLwo+
IC0JaWYgKGRwbV9zdGF0ZSA9PSBQT1dFUl9TVEFURV9UWVBFX0JBTEFOQ0VEKQo+IC0JCWRwbV9z
dGF0ZSA9IFBPV0VSX1NUQVRFX1RZUEVfUEVSRk9STUFOQ0U7Cj4gLQo+IC1yZXN0YXJ0X3NlYXJj
aDoKPiAtCS8qIFBpY2sgdGhlIGJlc3QgcG93ZXIgc3RhdGUgYmFzZWQgb24gY3VycmVudCBjb25k
aXRpb25zICovCj4gLQlmb3IgKGkgPSAwOyBpIDwgYWRldi0+cG0uZHBtLm51bV9wczsgaSsrKSB7
Cj4gLQkJcHMgPSAmYWRldi0+cG0uZHBtLnBzW2ldOwo+IC0JCXVpX2NsYXNzID0gcHMtPmNsYXNz
ICYgQVRPTV9QUExJQl9DTEFTU0lGSUNBVElPTl9VSV9NQVNLOwo+IC0JCXN3aXRjaCAoZHBtX3N0
YXRlKSB7Cj4gLQkJLyogdXNlciBzdGF0ZXMgKi8KPiAtCQljYXNlIFBPV0VSX1NUQVRFX1RZUEVf
QkFUVEVSWToKPiAtCQkJaWYgKHVpX2NsYXNzID09IEFUT01fUFBMSUJfQ0xBU1NJRklDQVRJT05f
VUlfQkFUVEVSWSkgewo+IC0JCQkJaWYgKHBzLT5jYXBzICYgQVRPTV9QUExJQl9TSU5HTEVfRElT
UExBWV9PTkxZKSB7Cj4gLQkJCQkJaWYgKHNpbmdsZV9kaXNwbGF5KQo+IC0JCQkJCQlyZXR1cm4g
cHM7Cj4gLQkJCQl9IGVsc2UKPiAtCQkJCQlyZXR1cm4gcHM7Cj4gLQkJCX0KPiAtCQkJYnJlYWs7
Cj4gLQkJY2FzZSBQT1dFUl9TVEFURV9UWVBFX0JBTEFOQ0VEOgo+IC0JCQlpZiAodWlfY2xhc3Mg
PT0gQVRPTV9QUExJQl9DTEFTU0lGSUNBVElPTl9VSV9CQUxBTkNFRCkgewo+IC0JCQkJaWYgKHBz
LT5jYXBzICYgQVRPTV9QUExJQl9TSU5HTEVfRElTUExBWV9PTkxZKSB7Cj4gLQkJCQkJaWYgKHNp
bmdsZV9kaXNwbGF5KQo+IC0JCQkJCQlyZXR1cm4gcHM7Cj4gLQkJCQl9IGVsc2UKPiAtCQkJCQly
ZXR1cm4gcHM7Cj4gLQkJCX0KPiAtCQkJYnJlYWs7Cj4gLQkJY2FzZSBQT1dFUl9TVEFURV9UWVBF
X1BFUkZPUk1BTkNFOgo+IC0JCQlpZiAodWlfY2xhc3MgPT0gQVRPTV9QUExJQl9DTEFTU0lGSUNB
VElPTl9VSV9QRVJGT1JNQU5DRSkgewo+IC0JCQkJaWYgKHBzLT5jYXBzICYgQVRPTV9QUExJQl9T
SU5HTEVfRElTUExBWV9PTkxZKSB7Cj4gLQkJCQkJaWYgKHNpbmdsZV9kaXNwbGF5KQo+IC0JCQkJ
CQlyZXR1cm4gcHM7Cj4gLQkJCQl9IGVsc2UKPiAtCQkJCQlyZXR1cm4gcHM7Cj4gLQkJCX0KPiAt
CQkJYnJlYWs7Cj4gLQkJLyogaW50ZXJuYWwgc3RhdGVzICovCj4gLQkJY2FzZSBQT1dFUl9TVEFU
RV9UWVBFX0lOVEVSTkFMX1VWRDoKPiAtCQkJaWYgKGFkZXYtPnBtLmRwbS51dmRfcHMpCj4gLQkJ
CQlyZXR1cm4gYWRldi0+cG0uZHBtLnV2ZF9wczsKPiAtCQkJZWxzZQo+IC0JCQkJYnJlYWs7Cj4g
LQkJY2FzZSBQT1dFUl9TVEFURV9UWVBFX0lOVEVSTkFMX1VWRF9TRDoKPiAtCQkJaWYgKHBzLT5j
bGFzcyAmIEFUT01fUFBMSUJfQ0xBU1NJRklDQVRJT05fU0RTVEFURSkKPiAtCQkJCXJldHVybiBw
czsKPiAtCQkJYnJlYWs7Cj4gLQkJY2FzZSBQT1dFUl9TVEFURV9UWVBFX0lOVEVSTkFMX1VWRF9I
RDoKPiAtCQkJaWYgKHBzLT5jbGFzcyAmIEFUT01fUFBMSUJfQ0xBU1NJRklDQVRJT05fSERTVEFU
RSkKPiAtCQkJCXJldHVybiBwczsKPiAtCQkJYnJlYWs7Cj4gLQkJY2FzZSBQT1dFUl9TVEFURV9U
WVBFX0lOVEVSTkFMX1VWRF9IRDI6Cj4gLQkJCWlmIChwcy0+Y2xhc3MgJiBBVE9NX1BQTElCX0NM
QVNTSUZJQ0FUSU9OX0hEMlNUQVRFKQo+IC0JCQkJcmV0dXJuIHBzOwo+IC0JCQlicmVhazsKPiAt
CQljYXNlIFBPV0VSX1NUQVRFX1RZUEVfSU5URVJOQUxfVVZEX01WQzoKPiAtCQkJaWYgKHBzLT5j
bGFzczIgJiBBVE9NX1BQTElCX0NMQVNTSUZJQ0FUSU9OMl9NVkMpCj4gLQkJCQlyZXR1cm4gcHM7
Cj4gLQkJCWJyZWFrOwo+IC0JCWNhc2UgUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9CT09UOgo+
IC0JCQlyZXR1cm4gYWRldi0+cG0uZHBtLmJvb3RfcHM7Cj4gLQkJY2FzZSBQT1dFUl9TVEFURV9U
WVBFX0lOVEVSTkFMX1RIRVJNQUw6Cj4gLQkJCWlmIChwcy0+Y2xhc3MgJiBBVE9NX1BQTElCX0NM
QVNTSUZJQ0FUSU9OX1RIRVJNQUwpCj4gLQkJCQlyZXR1cm4gcHM7Cj4gLQkJCWJyZWFrOwo+IC0J
CWNhc2UgUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9BQ1BJOgo+IC0JCQlpZiAocHMtPmNsYXNz
ICYgQVRPTV9QUExJQl9DTEFTU0lGSUNBVElPTl9BQ1BJKQo+IC0JCQkJcmV0dXJuIHBzOwo+IC0J
CQlicmVhazsKPiAtCQljYXNlIFBPV0VSX1NUQVRFX1RZUEVfSU5URVJOQUxfVUxWOgo+IC0JCQlp
ZiAocHMtPmNsYXNzMiAmIEFUT01fUFBMSUJfQ0xBU1NJRklDQVRJT04yX1VMVikKPiAtCQkJCXJl
dHVybiBwczsKPiAtCQkJYnJlYWs7Cj4gLQkJY2FzZSBQT1dFUl9TVEFURV9UWVBFX0lOVEVSTkFM
XzNEUEVSRjoKPiAtCQkJaWYgKHBzLT5jbGFzcyAmIEFUT01fUFBMSUJfQ0xBU1NJRklDQVRJT05f
M0RQRVJGT1JNQU5DRSkKPiAtCQkJCXJldHVybiBwczsKPiAtCQkJYnJlYWs7Cj4gLQkJZGVmYXVs
dDoKPiAtCQkJYnJlYWs7Cj4gLQkJfQo+IC0JfQo+IC0JLyogdXNlIGEgZmFsbGJhY2sgc3RhdGUg
aWYgd2UgZGlkbid0IG1hdGNoICovCj4gLQlzd2l0Y2ggKGRwbV9zdGF0ZSkgewo+IC0JY2FzZSBQ
T1dFUl9TVEFURV9UWVBFX0lOVEVSTkFMX1VWRF9TRDoKPiAtCQlkcG1fc3RhdGUgPSBQT1dFUl9T
VEFURV9UWVBFX0lOVEVSTkFMX1VWRF9IRDsKPiAtCQlnb3RvIHJlc3RhcnRfc2VhcmNoOwo+IC0J
Y2FzZSBQT1dFUl9TVEFURV9UWVBFX0lOVEVSTkFMX1VWRF9IRDoKPiAtCWNhc2UgUE9XRVJfU1RB
VEVfVFlQRV9JTlRFUk5BTF9VVkRfSEQyOgo+IC0JY2FzZSBQT1dFUl9TVEFURV9UWVBFX0lOVEVS
TkFMX1VWRF9NVkM6Cj4gLQkJaWYgKGFkZXYtPnBtLmRwbS51dmRfcHMpIHsKPiAtCQkJcmV0dXJu
IGFkZXYtPnBtLmRwbS51dmRfcHM7Cj4gLQkJfSBlbHNlIHsKPiAtCQkJZHBtX3N0YXRlID0gUE9X
RVJfU1RBVEVfVFlQRV9QRVJGT1JNQU5DRTsKPiAtCQkJZ290byByZXN0YXJ0X3NlYXJjaDsKPiAt
CQl9Cj4gLQljYXNlIFBPV0VSX1NUQVRFX1RZUEVfSU5URVJOQUxfVEhFUk1BTDoKPiAtCQlkcG1f
c3RhdGUgPSBQT1dFUl9TVEFURV9UWVBFX0lOVEVSTkFMX0FDUEk7Cj4gLQkJZ290byByZXN0YXJ0
X3NlYXJjaDsKPiAtCWNhc2UgUE9XRVJfU1RBVEVfVFlQRV9JTlRFUk5BTF9BQ1BJOgo+IC0JCWRw
bV9zdGF0ZSA9IFBPV0VSX1NUQVRFX1RZUEVfQkFUVEVSWTsKPiAtCQlnb3RvIHJlc3RhcnRfc2Vh
cmNoOwo+IC0JY2FzZSBQT1dFUl9TVEFURV9UWVBFX0JBVFRFUlk6Cj4gLQljYXNlIFBPV0VSX1NU
QVRFX1RZUEVfQkFMQU5DRUQ6Cj4gLQljYXNlIFBPV0VSX1NUQVRFX1RZUEVfSU5URVJOQUxfM0RQ
RVJGOgo+IC0JCWRwbV9zdGF0ZSA9IFBPV0VSX1NUQVRFX1RZUEVfUEVSRk9STUFOQ0U7Cj4gLQkJ
Z290byByZXN0YXJ0X3NlYXJjaDsKPiAtCWRlZmF1bHQ6Cj4gLQkJYnJlYWs7Cj4gLQl9Cj4gLQo+
IC0JcmV0dXJuIE5VTEw7Cj4gLX0KPiAtCj4gLXN0YXRpYyB2b2lkIGFtZGdwdV9kcG1fY2hhbmdl
X3Bvd2VyX3N0YXRlX2xvY2tlZChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiAtewo+IC0J
c3RydWN0IGFtZGdwdV9wcyAqcHM7Cj4gLQllbnVtIGFtZF9wbV9zdGF0ZV90eXBlIGRwbV9zdGF0
ZTsKPiAtCWludCByZXQ7Cj4gLQlib29sIGVxdWFsID0gZmFsc2U7Cj4gLQo+IC0JLyogaWYgZHBt
IGluaXQgZmFpbGVkICovCj4gLQlpZiAoIWFkZXYtPnBtLmRwbV9lbmFibGVkKQo+IC0JCXJldHVy
bjsKPiAtCj4gLQlpZiAoYWRldi0+cG0uZHBtLnVzZXJfc3RhdGUgIT0gYWRldi0+cG0uZHBtLnN0
YXRlKSB7Cj4gLQkJLyogYWRkIG90aGVyIHN0YXRlIG92ZXJyaWRlIGNoZWNrcyBoZXJlICovCj4g
LQkJaWYgKCghYWRldi0+cG0uZHBtLnRoZXJtYWxfYWN0aXZlKSAmJgo+IC0JCSAgICAoIWFkZXYt
PnBtLmRwbS51dmRfYWN0aXZlKSkKPiAtCQkJYWRldi0+cG0uZHBtLnN0YXRlID0gYWRldi0+cG0u
ZHBtLnVzZXJfc3RhdGU7Cj4gLQl9Cj4gLQlkcG1fc3RhdGUgPSBhZGV2LT5wbS5kcG0uc3RhdGU7
Cj4gLQo+IC0JcHMgPSBhbWRncHVfZHBtX3BpY2tfcG93ZXJfc3RhdGUoYWRldiwgZHBtX3N0YXRl
KTsKPiAtCWlmIChwcykKPiAtCQlhZGV2LT5wbS5kcG0ucmVxdWVzdGVkX3BzID0gcHM7Cj4gLQll
bHNlCj4gLQkJcmV0dXJuOwo+IC0KPiAtCWlmIChhbWRncHVfZHBtID09IDEgJiYgYWRldi0+cG93
ZXJwbGF5LnBwX2Z1bmNzLT5wcmludF9wb3dlcl9zdGF0ZSkgewo+IC0JCXByaW50aygic3dpdGNo
aW5nIGZyb20gcG93ZXIgc3RhdGU6XG4iKTsKPiAtCQlhbWRncHVfZHBtX3ByaW50X3Bvd2VyX3N0
YXRlKGFkZXYsIGFkZXYtPnBtLmRwbS5jdXJyZW50X3BzKTsKPiAtCQlwcmludGsoInN3aXRjaGlu
ZyB0byBwb3dlciBzdGF0ZTpcbiIpOwo+IC0JCWFtZGdwdV9kcG1fcHJpbnRfcG93ZXJfc3RhdGUo
YWRldiwgYWRldi0+cG0uZHBtLnJlcXVlc3RlZF9wcyk7Cj4gLQl9Cj4gLQo+IC0JLyogdXBkYXRl
IHdoZXRoZXIgdmNlIGlzIGFjdGl2ZSAqLwo+IC0JcHMtPnZjZV9hY3RpdmUgPSBhZGV2LT5wbS5k
cG0udmNlX2FjdGl2ZTsKPiAtCWlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmRpc3BsYXlf
Y29uZmlndXJhdGlvbl9jaGFuZ2VkKQo+IC0JCWFtZGdwdV9kcG1fZGlzcGxheV9jb25maWd1cmF0
aW9uX2NoYW5nZWQoYWRldik7Cj4gLQo+IC0JcmV0ID0gYW1kZ3B1X2RwbV9wcmVfc2V0X3Bvd2Vy
X3N0YXRlKGFkZXYpOwo+IC0JaWYgKHJldCkKPiAtCQlyZXR1cm47Cj4gLQo+IC0JaWYgKGFkZXYt
PnBvd2VycGxheS5wcF9mdW5jcy0+Y2hlY2tfc3RhdGVfZXF1YWwpIHsKPiAtCQlpZiAoMCAhPSBh
bWRncHVfZHBtX2NoZWNrX3N0YXRlX2VxdWFsKGFkZXYsIGFkZXYtPnBtLmRwbS5jdXJyZW50X3Bz
LCBhZGV2LT5wbS5kcG0ucmVxdWVzdGVkX3BzLCAmZXF1YWwpKQo+IC0JCQllcXVhbCA9IGZhbHNl
Owo+IC0JfQo+IC0KPiAtCWlmIChlcXVhbCkKPiAtCQlyZXR1cm47Cj4gLQo+IC0JYW1kZ3B1X2Rw
bV9zZXRfcG93ZXJfc3RhdGUoYWRldik7Cj4gLQlhbWRncHVfZHBtX3Bvc3Rfc2V0X3Bvd2VyX3N0
YXRlKGFkZXYpOwo+IC0KPiAtCWFkZXYtPnBtLmRwbS5jdXJyZW50X2FjdGl2ZV9jcnRjcyA9IGFk
ZXYtPnBtLmRwbS5uZXdfYWN0aXZlX2NydGNzOwo+IC0JYWRldi0+cG0uZHBtLmN1cnJlbnRfYWN0
aXZlX2NydGNfY291bnQgPSBhZGV2LT5wbS5kcG0ubmV3X2FjdGl2ZV9jcnRjX2NvdW50Owo+IC0K
PiAtCWlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNlX3BlcmZvcm1hbmNlX2xldmVs
KSB7Cj4gLQkJaWYgKGFkZXYtPnBtLmRwbS50aGVybWFsX2FjdGl2ZSkgewo+IC0JCQllbnVtIGFt
ZF9kcG1fZm9yY2VkX2xldmVsIGxldmVsID0gYWRldi0+cG0uZHBtLmZvcmNlZF9sZXZlbDsKPiAt
CQkJLyogZm9yY2UgbG93IHBlcmYgbGV2ZWwgZm9yIHRoZXJtYWwgKi8KPiAtCQkJYW1kZ3B1X2Rw
bV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbChhZGV2LCBBTURfRFBNX0ZPUkNFRF9MRVZFTF9MT1cp
Owo+IC0JCQkvKiBzYXZlIHRoZSB1c2VyJ3MgbGV2ZWwgKi8KPiAtCQkJYWRldi0+cG0uZHBtLmZv
cmNlZF9sZXZlbCA9IGxldmVsOwo+IC0JCX0gZWxzZSB7Cj4gLQkJCS8qIG90aGVyd2lzZSwgdXNl
ciBzZWxlY3RlZCBsZXZlbCAqLwo+IC0JCQlhbWRncHVfZHBtX2ZvcmNlX3BlcmZvcm1hbmNlX2xl
dmVsKGFkZXYsIGFkZXYtPnBtLmRwbS5mb3JjZWRfbGV2ZWwpOwo+IC0JCX0KPiAtCX0KPiAtfQo+
IC0KPiAtdm9pZCBhbWRncHVfZHBtX2VuYWJsZV91dmQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYsIGJvb2wgZW5hYmxlKQo+IC17Cj4gLQlpbnQgcmV0ID0gMDsKPiAtCj4gLQlpZiAoYWRldi0+
ZmFtaWx5ID09IEFNREdQVV9GQU1JTFlfU0kpIHsKPiAtCQltdXRleF9sb2NrKCZhZGV2LT5wbS5t
dXRleCk7Cj4gLQkJaWYgKGVuYWJsZSkgewo+IC0JCQlhZGV2LT5wbS5kcG0udXZkX2FjdGl2ZSA9
IHRydWU7Cj4gLQkJCWFkZXYtPnBtLmRwbS5zdGF0ZSA9IFBPV0VSX1NUQVRFX1RZUEVfSU5URVJO
QUxfVVZEOwo+IC0JCX0gZWxzZSB7Cj4gLQkJCWFkZXYtPnBtLmRwbS51dmRfYWN0aXZlID0gZmFs
c2U7Cj4gLQkJfQo+IC0JCW11dGV4X3VubG9jaygmYWRldi0+cG0ubXV0ZXgpOwo+IC0KPiAtCQlh
bWRncHVfcG1fY29tcHV0ZV9jbG9ja3MoYWRldik7Cj4gLQl9IGVsc2Ugewo+IC0JCXJldCA9IGFt
ZGdwdV9kcG1fc2V0X3Bvd2VyZ2F0aW5nX2J5X3NtdShhZGV2LCBBTURfSVBfQkxPQ0tfVFlQRV9V
VkQsICFlbmFibGUpOwo+IC0JCWlmIChyZXQpCj4gLQkJCURSTV9FUlJPUigiRHBtICVzIHV2ZCBm
YWlsZWQsIHJldCA9ICVkLiBcbiIsCj4gLQkJCQkgIGVuYWJsZSA/ICJlbmFibGUiIDogImRpc2Fi
bGUiLCByZXQpOwo+IC0KPiAtCQkvKiBlbmFibGUvZGlzYWJsZSBMb3cgTWVtb3J5IFBTdGF0ZSBm
b3IgVVZEICg0ayB2aWRlb3MpICovCj4gLQkJaWYgKGFkZXYtPmFzaWNfdHlwZSA9PSBDSElQX1NU
T05FWSAmJgo+IC0JCQlhZGV2LT51dmQuZGVjb2RlX2ltYWdlX3dpZHRoID49IFdJRFRIXzRLKSB7
Cj4gLQkJCXN0cnVjdCBwcF9od21nciAqaHdtZ3IgPSBhZGV2LT5wb3dlcnBsYXkucHBfaGFuZGxl
Owo+IC0KPiAtCQkJaWYgKGh3bWdyICYmIGh3bWdyLT5od21ncl9mdW5jICYmCj4gLQkJCSAgICBo
d21nci0+aHdtZ3JfZnVuYy0+dXBkYXRlX25iZHBtX3BzdGF0ZSkKPiAtCQkJCWh3bWdyLT5od21n
cl9mdW5jLT51cGRhdGVfbmJkcG1fcHN0YXRlKGh3bWdyLAo+IC0JCQkJCQkJCSAgICAgICAhZW5h
YmxlLAo+IC0JCQkJCQkJCSAgICAgICB0cnVlKTsKPiAtCQl9Cj4gLQl9Cj4gLX0KPiAtCj4gLXZv
aWQgYW1kZ3B1X2RwbV9lbmFibGVfdmNlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBib29s
IGVuYWJsZSkKPiAtewo+IC0JaW50IHJldCA9IDA7Cj4gLQo+IC0JaWYgKGFkZXYtPmZhbWlseSA9
PSBBTURHUFVfRkFNSUxZX1NJKSB7Cj4gLQkJbXV0ZXhfbG9jaygmYWRldi0+cG0ubXV0ZXgpOwo+
IC0JCWlmIChlbmFibGUpIHsKPiAtCQkJYWRldi0+cG0uZHBtLnZjZV9hY3RpdmUgPSB0cnVlOwo+
IC0JCQkvKiBYWFggc2VsZWN0IHZjZSBsZXZlbCBiYXNlZCBvbiByaW5nL3Rhc2sgKi8KPiAtCQkJ
YWRldi0+cG0uZHBtLnZjZV9sZXZlbCA9IEFNRF9WQ0VfTEVWRUxfQUNfQUxMOwo+IC0JCX0gZWxz
ZSB7Cj4gLQkJCWFkZXYtPnBtLmRwbS52Y2VfYWN0aXZlID0gZmFsc2U7Cj4gLQkJfQo+IC0JCW11
dGV4X3VubG9jaygmYWRldi0+cG0ubXV0ZXgpOwo+IC0KPiAtCQlhbWRncHVfcG1fY29tcHV0ZV9j
bG9ja3MoYWRldik7Cj4gLQl9IGVsc2Ugewo+IC0JCXJldCA9IGFtZGdwdV9kcG1fc2V0X3Bvd2Vy
Z2F0aW5nX2J5X3NtdShhZGV2LCBBTURfSVBfQkxPQ0tfVFlQRV9WQ0UsICFlbmFibGUpOwo+IC0J
CWlmIChyZXQpCj4gLQkJCURSTV9FUlJPUigiRHBtICVzIHZjZSBmYWlsZWQsIHJldCA9ICVkLiBc
biIsCj4gLQkJCQkgIGVuYWJsZSA/ICJlbmFibGUiIDogImRpc2FibGUiLCByZXQpOwo+IC0JfQo+
IC19Cj4gLQo+IC12b2lkIGFtZGdwdV9wbV9wcmludF9wb3dlcl9zdGF0ZXMoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYpCj4gLXsKPiAtCWludCBpOwo+IC0KPiAtCWlmIChhZGV2LT5wb3dlcnBs
YXkucHBfZnVuY3MtPnByaW50X3Bvd2VyX3N0YXRlID09IE5VTEwpCj4gLQkJcmV0dXJuOwo+IC0K
PiAtCWZvciAoaSA9IDA7IGkgPCBhZGV2LT5wbS5kcG0ubnVtX3BzOyBpKyspCj4gLQkJYW1kZ3B1
X2RwbV9wcmludF9wb3dlcl9zdGF0ZShhZGV2LCAmYWRldi0+cG0uZHBtLnBzW2ldKTsKPiAtCj4g
LX0KPiAtCj4gLXZvaWQgYW1kZ3B1X2RwbV9lbmFibGVfanBlZyhzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwgYm9vbCBlbmFibGUpCj4gLXsKPiAtCWludCByZXQgPSAwOwo+IC0KPiAtCXJldCA9
IGFtZGdwdV9kcG1fc2V0X3Bvd2VyZ2F0aW5nX2J5X3NtdShhZGV2LCBBTURfSVBfQkxPQ0tfVFlQ
RV9KUEVHLCAhZW5hYmxlKTsKPiAtCWlmIChyZXQpCj4gLQkJRFJNX0VSUk9SKCJEcG0gJXMganBl
ZyBmYWlsZWQsIHJldCA9ICVkLiBcbiIsCj4gLQkJCSAgZW5hYmxlID8gImVuYWJsZSIgOiAiZGlz
YWJsZSIsIHJldCk7Cj4gLX0KPiAtCj4gLWludCBhbWRncHVfcG1fbG9hZF9zbXVfZmlybXdhcmUo
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHVpbnQzMl90ICpzbXVfdmVyc2lvbikKPiAtewo+
IC0JaW50IHI7Cj4gLQo+IC0JaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcyAmJiBhZGV2LT5w
b3dlcnBsYXkucHBfZnVuY3MtPmxvYWRfZmlybXdhcmUpIHsKPiAtCQlyID0gYWRldi0+cG93ZXJw
bGF5LnBwX2Z1bmNzLT5sb2FkX2Zpcm13YXJlKGFkZXYtPnBvd2VycGxheS5wcF9oYW5kbGUpOwo+
IC0JCWlmIChyKSB7Cj4gLQkJCXByX2Vycigic211IGZpcm13YXJlIGxvYWRpbmcgZmFpbGVkXG4i
KTsKPiAtCQkJcmV0dXJuIHI7Cj4gLQkJfQo+IC0JCSpzbXVfdmVyc2lvbiA9IGFkZXYtPnBtLmZ3
X3ZlcnNpb247Cj4gLQl9Cj4gLQlyZXR1cm4gMDsKPiAtfQo+IC0KPiAgIGludCBhbWRncHVfcG1f
c3lzZnNfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiAgIHsKPiAgIAlpbnQgcmV0
Owo+IEBAIC00MDI4LDU1ICszNjU0LDYgQEAgdm9pZCBhbWRncHVfcG1fc3lzZnNfZmluaShzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiAgIAlhbWRncHVfZGV2aWNlX2F0dHJfcmVtb3ZlX2dy
b3VwcyhhZGV2LCAmYWRldi0+cG0ucG1fYXR0cl9saXN0KTsKPiAgIH0KPiAgIAo+IC12b2lkIGFt
ZGdwdV9wbV9jb21wdXRlX2Nsb2NrcyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiAtewo+
IC0JaW50IGkgPSAwOwo+IC0KPiAtCWlmICghYWRldi0+cG0uZHBtX2VuYWJsZWQpCj4gLQkJcmV0
dXJuOwo+IC0KPiAtCWlmIChhZGV2LT5tb2RlX2luZm8ubnVtX2NydGMpCj4gLQkJYW1kZ3B1X2Rp
c3BsYXlfYmFuZHdpZHRoX3VwZGF0ZShhZGV2KTsKPiAtCj4gLQlmb3IgKGkgPSAwOyBpIDwgQU1E
R1BVX01BWF9SSU5HUzsgaSsrKSB7Cj4gLQkJc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nID0gYWRl
di0+cmluZ3NbaV07Cj4gLQkJaWYgKHJpbmcgJiYgcmluZy0+c2NoZWQucmVhZHkpCj4gLQkJCWFt
ZGdwdV9mZW5jZV93YWl0X2VtcHR5KHJpbmcpOwo+IC0JfQo+IC0KPiAtCWlmIChpc19zdXBwb3J0
X3N3X3NtdShhZGV2KSkgewo+IC0JCXN0cnVjdCBzbXVfZHBtX2NvbnRleHQgKnNtdV9kcG0gPSAm
YWRldi0+c211LnNtdV9kcG07Cj4gLQkJc211X2hhbmRsZV90YXNrKCZhZGV2LT5zbXUsCj4gLQkJ
CQlzbXVfZHBtLT5kcG1fbGV2ZWwsCj4gLQkJCQlBTURfUFBfVEFTS19ESVNQTEFZX0NPTkZJR19D
SEFOR0UsCj4gLQkJCQl0cnVlKTsKPiAtCX0gZWxzZSB7Cj4gLQkJaWYgKGFkZXYtPnBvd2VycGxh
eS5wcF9mdW5jcy0+ZGlzcGF0Y2hfdGFza3MpIHsKPiAtCQkJaWYgKCFhbWRncHVfZGV2aWNlX2hh
c19kY19zdXBwb3J0KGFkZXYpKSB7Cj4gLQkJCQltdXRleF9sb2NrKCZhZGV2LT5wbS5tdXRleCk7
Cj4gLQkJCQlhbWRncHVfZHBtX2dldF9hY3RpdmVfZGlzcGxheXMoYWRldik7Cj4gLQkJCQlhZGV2
LT5wbS5wbV9kaXNwbGF5X2NmZy5udW1fZGlzcGxheSA9IGFkZXYtPnBtLmRwbS5uZXdfYWN0aXZl
X2NydGNfY291bnQ7Cj4gLQkJCQlhZGV2LT5wbS5wbV9kaXNwbGF5X2NmZy52cmVmcmVzaCA9IGFt
ZGdwdV9kcG1fZ2V0X3ZyZWZyZXNoKGFkZXYpOwo+IC0JCQkJYWRldi0+cG0ucG1fZGlzcGxheV9j
ZmcubWluX3ZibGFua190aW1lID0gYW1kZ3B1X2RwbV9nZXRfdmJsYW5rX3RpbWUoYWRldik7Cj4g
LQkJCQkvKiB3ZSBoYXZlIGlzc3VlcyB3aXRoIG1jbGsgc3dpdGNoaW5nIHdpdGggcmVmcmVzaCBy
YXRlcyBvdmVyIDEyMCBoeiBvbiB0aGUgbm9uLURDIGNvZGUuICovCj4gLQkJCQlpZiAoYWRldi0+
cG0ucG1fZGlzcGxheV9jZmcudnJlZnJlc2ggPiAxMjApCj4gLQkJCQkJYWRldi0+cG0ucG1fZGlz
cGxheV9jZmcubWluX3ZibGFua190aW1lID0gMDsKPiAtCQkJCWlmIChhZGV2LT5wb3dlcnBsYXku
cHBfZnVuY3MtPmRpc3BsYXlfY29uZmlndXJhdGlvbl9jaGFuZ2UpCj4gLQkJCQkJYWRldi0+cG93
ZXJwbGF5LnBwX2Z1bmNzLT5kaXNwbGF5X2NvbmZpZ3VyYXRpb25fY2hhbmdlKAo+IC0JCQkJCQkJ
CQlhZGV2LT5wb3dlcnBsYXkucHBfaGFuZGxlLAo+IC0JCQkJCQkJCQkmYWRldi0+cG0ucG1fZGlz
cGxheV9jZmcpOwo+IC0JCQkJbXV0ZXhfdW5sb2NrKCZhZGV2LT5wbS5tdXRleCk7Cj4gLQkJCX0K
PiAtCQkJYW1kZ3B1X2RwbV9kaXNwYXRjaF90YXNrKGFkZXYsIEFNRF9QUF9UQVNLX0RJU1BMQVlf
Q09ORklHX0NIQU5HRSwgTlVMTCk7Cj4gLQkJfSBlbHNlIHsKPiAtCQkJbXV0ZXhfbG9jaygmYWRl
di0+cG0ubXV0ZXgpOwo+IC0JCQlhbWRncHVfZHBtX2dldF9hY3RpdmVfZGlzcGxheXMoYWRldik7
Cj4gLQkJCWFtZGdwdV9kcG1fY2hhbmdlX3Bvd2VyX3N0YXRlX2xvY2tlZChhZGV2KTsKPiAtCQkJ
bXV0ZXhfdW5sb2NrKCZhZGV2LT5wbS5tdXRleCk7Cj4gLQkJfQo+IC0JfQo+IC19Cj4gLQo+ICAg
LyoKPiAgICAqIERlYnVnZnMgaW5mbwo+ICAgICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3BtLmgKPiBpbmRleCBkOWFlMmI0OWE0MDIuLjQ1YTIyZTEwMWQxNSAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0uaAo+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5oCj4gQEAgLTc5LDE4ICs3OSwxMCBAQCBz
dHJ1Y3QgYW1kZ3B1X2RldmljZV9hdHRyX2VudHJ5IHsKPiAgIAkJCSAgICAgYW1kZ3B1X2dldF8j
I19uYW1lLCBOVUxMLAkJCVwKPiAgIAkJCSAgICAgX2ZsYWdzLCAjI19fVkFfQVJHU19fKQo+ICAg
Cj4gLXZvaWQgYW1kZ3B1X3BtX2FjcGlfZXZlbnRfaGFuZGxlcihzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldik7Cj4gICBpbnQgYW1kZ3B1X3BtX3N5c2ZzX2luaXQoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYpOwo+ICAgaW50IGFtZGdwdV9wbV92aXJ0X3N5c2ZzX2luaXQoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYpOwo+ICAgdm9pZCBhbWRncHVfcG1fc3lzZnNfZmluaShzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldik7Cj4gICB2b2lkIGFtZGdwdV9wbV92aXJ0X3N5c2ZzX2Zpbmkoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpOwo+IC12b2lkIGFtZGdwdV9wbV9wcmludF9wb3dlcl9z
dGF0ZXMoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpOwo+IC1pbnQgYW1kZ3B1X3BtX2xvYWRf
c211X2Zpcm13YXJlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1aW50MzJfdCAqc211X3Zl
cnNpb24pOwo+IC12b2lkIGFtZGdwdV9wbV9jb21wdXRlX2Nsb2NrcyhzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldik7Cj4gLXZvaWQgYW1kZ3B1X2RwbV90aGVybWFsX3dvcmtfaGFuZGxlcihzdHJ1
Y3Qgd29ya19zdHJ1Y3QgKndvcmspOwo+IC12b2lkIGFtZGdwdV9kcG1fZW5hYmxlX3V2ZChzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCBlbmFibGUpOwo+IC12b2lkIGFtZGdwdV9kcG1f
ZW5hYmxlX3ZjZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCBlbmFibGUpOwo+IC12
b2lkIGFtZGdwdV9kcG1fZW5hYmxlX2pwZWcoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIGJv
b2wgZW5hYmxlKTsKPiAgIAo+ICAgaW50IGFtZGdwdV9kZWJ1Z2ZzX3BtX2luaXQoc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYpOwo+ICAgCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
YW1kLWdmeAo=
