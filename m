Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1BD715FB73
	for <lists+amd-gfx@lfdr.de>; Thu,  4 Jul 2019 18:06:17 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A22976E36D;
	Thu,  4 Jul 2019 16:06:15 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM03-DM3-obe.outbound.protection.outlook.com
 (mail-dm3nam03on061c.outbound.protection.outlook.com
 [IPv6:2a01:111:f400:fe49::61c])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EB9A96E36D
 for <amd-gfx@lists.freedesktop.org>; Thu,  4 Jul 2019 16:06:13 +0000 (UTC)
Received: from CH2PR12CA0010.namprd12.prod.outlook.com (2603:10b6:610:57::20)
 by CY4PR12MB1845.namprd12.prod.outlook.com (2603:10b6:903:126::12)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2052.18; Thu, 4 Jul
 2019 16:05:59 +0000
Received: from BY2NAM03FT029.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e4a::209) by CH2PR12CA0010.outlook.office365.com
 (2603:10b6:610:57::20) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.2052.18 via Frontend
 Transport; Thu, 4 Jul 2019 16:05:59 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV02.amd.com (165.204.84.17) by
 BY2NAM03FT029.mail.protection.outlook.com (10.152.84.213) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.2052.18 via Frontend Transport; Thu, 4 Jul 2019 16:05:58 +0000
Received: from navi10-uefi.amd.com (10.180.168.240) by SATLEXCHOV02.amd.com
 (10.181.40.72) with Microsoft SMTP Server (TLS) id 14.3.389.1; Thu, 4 Jul
 2019 11:05:56 -0500
From: <boyuan.zhang@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 04/17] drm/amdgpu: implement jpeg enc ring functions
Date: Thu, 4 Jul 2019 12:04:16 -0400
Message-ID: <20190704160429.14758-4-boyuan.zhang@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190704160429.14758-1-boyuan.zhang@amd.com>
References: <20190704160429.14758-1-boyuan.zhang@amd.com>
MIME-Version: 1.0
X-Originating-IP: [10.180.168.240]
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(136003)(376002)(39860400002)(396003)(346002)(2980300002)(428003)(199004)(189003)(478600001)(336012)(72206003)(81166006)(81156014)(8676002)(76176011)(77096007)(26005)(16526019)(186003)(8936002)(4326008)(2876002)(2906002)(70206006)(5660300002)(70586007)(53936002)(3846002)(6116002)(68736007)(7736002)(6666004)(50226002)(486006)(1076003)(305945005)(126002)(476003)(356004)(86362001)(11346002)(2616005)(446003)(50466002)(426003)(48376002)(36756003)(316002)(51416003)(7696005)(16586007)(6916009)(47776003)(53416004)(2351001);
 DIR:OUT; SFP:1101; SCL:1; SRVR:CY4PR12MB1845; H:SATLEXCHOV02.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; A:1; MX:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: 65a6148e-7560-4ff3-a9ed-08d7009980fc
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328)(7193020);
 SRVR:CY4PR12MB1845; 
X-MS-TrafficTypeDiagnostic: CY4PR12MB1845:
X-Microsoft-Antispam-PRVS: <CY4PR12MB18457F898D9758FF1DD7C8A987FA0@CY4PR12MB1845.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:2000;
X-Forefront-PRVS: 0088C92887
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: CLUmydhKOxdcKhpVePw7Eu+jgMJcYIsEbIxN5mbWE/3ZYdPBkmclqsUwluxdcS37v4xMmT0LHh5vqMoslM3CqY6+NCcjHjMjenN4rv98PD5iApSqVKQVqtEdMQ+VN8Spf6GuQvPOvwYf/Pw6MWmtJnOr07aMgMqPln5xaffGX0SoBYse2zg0jH77A9TxtNDRq5WaJbBEg/Vu6z5iMtQLjzdlb3/+c3XDDsB/3BSJoCg+3KjDSmSC633VJuzL5IAGD9AeI4ks/46LFk58/cFiz7TjOXwkAXLCT07FVcJz20QYK6JovI19hW+rnWQOxZwgLGqq2Uuj2LoR5KVvjIKQcPBIxhYukljSo5eKCrRZHtAR+g/g1AVGUC57XFTefRFTexjJteUkBQv0zUW42rr91Z3v0UKOgAT6a+wA6ivTazE=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 04 Jul 2019 16:05:58.8691 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: 65a6148e-7560-4ff3-a9ed-08d7009980fc
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV02.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: CY4PR12MB1845
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=AIsl7b7qepUeYE+4pBaED5JGWrhVhrD90AwFLHBAGBw=;
 b=piTqvrX+0NttvK9ZJeUtknpQyuG6HnLNHWAA1rEUHe8PNkXWEmBs1w7ckQlPXqqVNHmOnqd3nOxaIaS5EmN9xKtQnR8o3HiaF6WGzIHlCZH9OgSziBTsJ6t1kZ0qM8Yz+w0mXo6g75XoGYuURqii4ckgVv26zT/M/Y51xH8IZxc=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Boyuan Zhang <boyuan.zhang@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogQm95dWFuIFpoYW5nIDxib3l1YW4uemhhbmdAYW1kLmNvbT4KCkltcGxlbWVudCBhbGwg
cmluZyBmdW5jdGlvbnMgbmVlZGVkIGZvciBqcGVnIGVuY29kZSByaW5nLgoKU2lnbmVkLW9mZi1i
eTogQm95dWFuIFpoYW5nIDxib3l1YW4uemhhbmdAYW1kLmNvbT4KUmV2aWV3ZWQtYnk6IEFsZXgg
RGV1Y2hlciA8YWxleGFuZGVyLmRldWNoZXJAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS92Y25fdjJfMC5jIHwgMjY3ICsrKysrKysrKysrKysrKysrKysrKysrKysrCiAx
IGZpbGUgY2hhbmdlZCwgMjY3IGluc2VydGlvbnMoKykKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS92Y25fdjJfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
dmNuX3YyXzAuYwppbmRleCA0YmRkNzNjMzMyNjIuLmI5NTNmNjQyMjU2MCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvdmNuX3YyXzAuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS92Y25fdjJfMC5jCkBAIC0xNjY5LDYgKzE2NjksMjczIEBAIHN0YXRpYyB2
b2lkIHZjbl92Ml8wX2pwZWdfcmluZ19ub3Aoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nLCB1aW50
MzJfdCBjb3VudCkKIAl9CiB9CiAKKy8qKgorICogdmNuX3YyXzBfanBlZ19lbmNfcmluZ19nZXRf
cnB0ciAtIGdldCByZWFkIHBvaW50ZXIKKyAqCisgKiBAcmluZzogYW1kZ3B1X3JpbmcgcG9pbnRl
cgorICoKKyAqIFJldHVybnMgdGhlIGN1cnJlbnQgaGFyZHdhcmUgcmVhZCBwb2ludGVyCisgKi8K
K3N0YXRpYyB1aW50NjRfdCB2Y25fdjJfMF9qcGVnX2VuY19yaW5nX2dldF9ycHRyKHN0cnVjdCBh
bWRncHVfcmluZyAqcmluZykKK3sKKwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IHJpbmct
PmFkZXY7CisKKwlyZXR1cm4gUlJFRzMyX1NPQzE1KFVWRCwgMCwgbW1VVkRfSlJCQ19FTkNfUkJf
UlBUUik7Cit9CisKKy8qKgorICogdmNuX3YyXzBfanBlZ19lbmNfcmluZ19nZXRfd3B0ciAtIGdl
dCB3cml0ZSBwb2ludGVyCisgKgorICogQHJpbmc6IGFtZGdwdV9yaW5nIHBvaW50ZXIKKyAqCisg
KiBSZXR1cm5zIHRoZSBjdXJyZW50IGhhcmR3YXJlIHdyaXRlIHBvaW50ZXIKKyAqLworc3RhdGlj
IHVpbnQ2NF90IHZjbl92Ml8wX2pwZWdfZW5jX3JpbmdfZ2V0X3dwdHIoc3RydWN0IGFtZGdwdV9y
aW5nICpyaW5nKQoreworCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gcmluZy0+YWRldjsK
KworCWlmIChyaW5nLT51c2VfZG9vcmJlbGwpCisJCXJldHVybiBhZGV2LT53Yi53YltyaW5nLT53
cHRyX29mZnNdOworCWVsc2UKKwkJcmV0dXJuIFJSRUczMl9TT0MxNShVVkQsIDAsIG1tVVZEX0pS
QkNfRU5DX1JCX1dQVFIpOworfQorCisvKioKKyAqIHZjbl92Ml8wX2pwZWdfZW5jX3Jpbmdfc2V0
X3dwdHIgLSBzZXQgd3JpdGUgcG9pbnRlcgorICoKKyAqIEByaW5nOiBhbWRncHVfcmluZyBwb2lu
dGVyCisgKgorICogQ29tbWl0cyB0aGUgd3JpdGUgcG9pbnRlciB0byB0aGUgaGFyZHdhcmUKKyAq
Lworc3RhdGljIHZvaWQgdmNuX3YyXzBfanBlZ19lbmNfcmluZ19zZXRfd3B0cihzdHJ1Y3QgYW1k
Z3B1X3JpbmcgKnJpbmcpCit7CisJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSByaW5nLT5h
ZGV2OworCisJaWYgKHJpbmctPnVzZV9kb29yYmVsbCkgeworCQlhZGV2LT53Yi53YltyaW5nLT53
cHRyX29mZnNdID0gbG93ZXJfMzJfYml0cyhyaW5nLT53cHRyKTsKKwkJV0RPT1JCRUxMMzIocmlu
Zy0+ZG9vcmJlbGxfaW5kZXgsIGxvd2VyXzMyX2JpdHMocmluZy0+d3B0cikpOworCX0gZWxzZQor
CQlXUkVHMzJfU09DMTUoVVZELCAwLCBtbVVWRF9KUkJDX0VOQ19SQl9XUFRSLCBsb3dlcl8zMl9i
aXRzKHJpbmctPndwdHIpKTsKK30KKworLyoqCisgKiB2Y25fdjJfMF9qcGVnX2VuY19yaW5nX2lu
c2VydF9zdGFydCAtIGluc2VydCBhIHN0YXJ0IGNvbW1hbmQKKyAqCisgKiBAcmluZzogYW1kZ3B1
X3JpbmcgcG9pbnRlcgorICoKKyAqIFdyaXRlIGEgc3RhcnQgY29tbWFuZCB0byB0aGUgcmluZy4K
KyAqLworc3RhdGljIHZvaWQgdmNuX3YyXzBfanBlZ19lbmNfcmluZ19pbnNlcnRfc3RhcnQoc3Ry
dWN0IGFtZGdwdV9yaW5nICpyaW5nKQoreworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIFBBQ0tF
VEoobW1VVkRfSlJCQ19FTkNfRVhURVJOQUxfUkVHX0lOVEVSTkFMX09GRlNFVCwKKwkJMCwgMCwg
UEFDS0VUSl9UWVBFMCkpOworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIDB4NjhlMDQpOworCisJ
YW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgUEFDS0VUSihKUkJDX0VOQ19FWFRFUk5BTF9SRUdfV1JJ
VEVfQUREUiwKKwkJMCwgMCwgUEFDS0VUSl9UWVBFMCkpOworCWFtZGdwdV9yaW5nX3dyaXRlKHJp
bmcsIDB4ODAwMDQwMDApOworfQorCisvKioKKyAqIHZjbl92Ml8wX2pwZWdfZW5jX3JpbmdfaW5z
ZXJ0X2VuZCAtIGluc2VydCBhIGVuZCBjb21tYW5kCisgKgorICogQHJpbmc6IGFtZGdwdV9yaW5n
IHBvaW50ZXIKKyAqCisgKiBXcml0ZSBhIGVuZCBjb21tYW5kIHRvIHRoZSByaW5nLgorICovCitz
dGF0aWMgdm9pZCB2Y25fdjJfMF9qcGVnX2VuY19yaW5nX2luc2VydF9lbmQoc3RydWN0IGFtZGdw
dV9yaW5nICpyaW5nKQoreworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIFBBQ0tFVEoobW1VVkRf
SlJCQ19FTkNfRVhURVJOQUxfUkVHX0lOVEVSTkFMX09GRlNFVCwKKwkJMCwgMCwgUEFDS0VUSl9U
WVBFMCkpOworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIDB4NjhlMDQpOworCisJYW1kZ3B1X3Jp
bmdfd3JpdGUocmluZywgUEFDS0VUSihKUkJDX0VOQ19FWFRFUk5BTF9SRUdfV1JJVEVfQUREUiwK
KwkJMCwgMCwgUEFDS0VUSl9UWVBFMCkpOworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIDB4MDAw
MDQwMDApOworfQorCisvKioKKyAqIHZjbl92Ml8wX2pwZWdfZW5jX3JpbmdfZW1pdF9mZW5jZSAt
IGVtaXQgYW4gZmVuY2UgJiB0cmFwIGNvbW1hbmQKKyAqCisgKiBAcmluZzogYW1kZ3B1X3Jpbmcg
cG9pbnRlcgorICogQGZlbmNlOiBmZW5jZSB0byBlbWl0CisgKgorICogV3JpdGUgYSBmZW5jZSBh
bmQgYSB0cmFwIGNvbW1hbmQgdG8gdGhlIHJpbmcuCisgKi8KK3N0YXRpYyB2b2lkIHZjbl92Ml8w
X2pwZWdfZW5jX3JpbmdfZW1pdF9mZW5jZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsIHU2NCBh
ZGRyLCB1NjQgc2VxLAorCQkJCSAgICAgdW5zaWduZWQgZmxhZ3MpCit7CisJV0FSTl9PTihmbGFn
cyAmIEFNREdQVV9GRU5DRV9GTEFHXzY0QklUKTsKKworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcs
IFBBQ0tFVEoobW1VVkRfSlBFR19FTkNfR1BDT01fREFUQTBfSU5URVJOQUxfT0ZGU0VULAorCQkw
LCAwLCBQQUNLRVRKX1RZUEUwKSk7CisJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgc2VxKTsKKwor
CWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsCVBBQ0tFVEoobW1VVkRfSlBFR19FTkNfR1BDT01fREFU
QTFfSU5URVJOQUxfT0ZGU0VULAorCQkwLCAwLCBQQUNLRVRKX1RZUEUwKSk7CisJYW1kZ3B1X3Jp
bmdfd3JpdGUocmluZywgc2VxKTsKKworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsCVBBQ0tFVEoo
bW1VVkRfTE1JX0VKUkJDX1JCX01FTV9XUl82NEJJVF9CQVJfTE9XX0lOVEVSTkFMX09GRlNFVCwK
KwkJMCwgMCwgUEFDS0VUSl9UWVBFMCkpOworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIGxvd2Vy
XzMyX2JpdHMoYWRkcikpOworCisJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywJUEFDS0VUSihtbVVW
RF9MTUlfRUpSQkNfUkJfTUVNX1dSXzY0QklUX0JBUl9ISUdIX0lOVEVSTkFMX09GRlNFVCwKKwkJ
MCwgMCwgUEFDS0VUSl9UWVBFMCkpOworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIHVwcGVyXzMy
X2JpdHMoYWRkcikpOworCisJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywJUEFDS0VUSihtbVVWRF9K
UEVHX0VOQ19HUENPTV9DTURfSU5URVJOQUxfT0ZGU0VULAorCQkwLCAwLCBQQUNLRVRKX1RZUEUw
KSk7CisJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgMHg4KTsKKworCWFtZGdwdV9yaW5nX3dyaXRl
KHJpbmcsCVBBQ0tFVEoobW1VVkRfSlBFR19FTkNfR1BDT01fQ01EX0lOVEVSTkFMX09GRlNFVCwK
KwkJMCwgUEFDS0VUSl9DT05ESVRJT05fQ0hFQ0swLCBQQUNLRVRKX1RZUEU0KSk7CisJYW1kZ3B1
X3Jpbmdfd3JpdGUocmluZywgMCk7CisKKwlhbWRncHVfcmluZ193cml0ZShyaW5nLAlQQUNLRVRK
KG1tVVZEX0pSQkNfRU5DX0VYVEVSTkFMX1JFR19JTlRFUk5BTF9PRkZTRVQsCisJCTAsIDAsIFBB
Q0tFVEpfVFlQRTApKTsKKwlhbWRncHVfcmluZ193cml0ZShyaW5nLCAweDNmYmMpOworCisJYW1k
Z3B1X3Jpbmdfd3JpdGUocmluZywgUEFDS0VUSihKUkJDX0VOQ19FWFRFUk5BTF9SRUdfV1JJVEVf
QUREUiwKKwkJMCwgMCwgUEFDS0VUSl9UWVBFMCkpOworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcs
IDB4MSk7CisKKwlhbWRncHVfcmluZ193cml0ZShyaW5nLCBQQUNLRVRKKDAsIDAsIDAsIFBBQ0tF
VEpfVFlQRTcpKTsKKwlhbWRncHVfcmluZ193cml0ZShyaW5nLCAwKTsKK30KKworLyoqCisgKiB2
Y25fdjJfMF9qcGVnX2VuY19yaW5nX2VtaXRfaWIgLSBleGVjdXRlIGluZGlyZWN0IGJ1ZmZlcgor
ICoKKyAqIEByaW5nOiBhbWRncHVfcmluZyBwb2ludGVyCisgKiBAaWI6IGluZGlyZWN0IGJ1ZmZl
ciB0byBleGVjdXRlCisgKgorICogV3JpdGUgcmluZyBjb21tYW5kcyB0byBleGVjdXRlIHRoZSBp
bmRpcmVjdCBidWZmZXIuCisgKi8KK3N0YXRpYyB2b2lkIHZjbl92Ml8wX2pwZWdfZW5jX3Jpbmdf
ZW1pdF9pYihzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsCisJCQkJICAgICAgIHN0cnVjdCBhbWRn
cHVfam9iICpqb2IsCisJCQkJICAgICAgIHN0cnVjdCBhbWRncHVfaWIgKmliLAorCQkJCSAgICAg
ICB1aW50MzJfdCBmbGFncykKK3sKKwl1bnNpZ25lZCB2bWlkID0gQU1ER1BVX0pPQl9HRVRfVk1J
RChqb2IpOworCisJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgUEFDS0VUSihtbVVWRF9KTUlfRU5D
X0pSQkNfSUJfVk1JRF9JTlRFUk5BTF9PRkZTRVQsCisJCTAsIDAsIFBBQ0tFVEpfVFlQRTApKTsK
KwlhbWRncHVfcmluZ193cml0ZShyaW5nLCAodm1pZCB8ICh2bWlkIDw8IDQpKSk7CisKKwlhbWRn
cHVfcmluZ193cml0ZShyaW5nLCBQQUNLRVRKKG1tVVZEX0pNSV9FTkNfSlBFR19WTUlEX0lOVEVS
TkFMX09GRlNFVCwKKwkJMCwgMCwgUEFDS0VUSl9UWVBFMCkpOworCWFtZGdwdV9yaW5nX3dyaXRl
KHJpbmcsICh2bWlkIHwgKHZtaWQgPDwgNCkpKTsKKworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcs
CVBBQ0tFVEoobW1VVkRfTE1JX0VKUkJDX0lCXzY0QklUX0JBUl9MT1dfSU5URVJOQUxfT0ZGU0VU
LAorCQkwLCAwLCBQQUNLRVRKX1RZUEUwKSk7CisJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgbG93
ZXJfMzJfYml0cyhpYi0+Z3B1X2FkZHIpKTsKKworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsCVBB
Q0tFVEoobW1VVkRfTE1JX0VKUkJDX0lCXzY0QklUX0JBUl9ISUdIX0lOVEVSTkFMX09GRlNFVCwK
KwkJMCwgMCwgUEFDS0VUSl9UWVBFMCkpOworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIHVwcGVy
XzMyX2JpdHMoaWItPmdwdV9hZGRyKSk7CisKKwlhbWRncHVfcmluZ193cml0ZShyaW5nLAlQQUNL
RVRKKG1tVVZEX0pSQkNfRU5DX0lCX1NJWkVfSU5URVJOQUxfT0ZGU0VULAorCQkwLCAwLCBQQUNL
RVRKX1RZUEUwKSk7CisJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgaWItPmxlbmd0aF9kdyk7CisK
KwlhbWRncHVfcmluZ193cml0ZShyaW5nLAlQQUNLRVRKKG1tVVZEX0xNSV9FSlJCQ19SQl9NRU1f
UkRfNjRCSVRfQkFSX0xPV19JTlRFUk5BTF9PRkZTRVQsCisJCTAsIDAsIFBBQ0tFVEpfVFlQRTAp
KTsKKwlhbWRncHVfcmluZ193cml0ZShyaW5nLCBsb3dlcl8zMl9iaXRzKHJpbmctPmdwdV9hZGRy
KSk7CisKKwlhbWRncHVfcmluZ193cml0ZShyaW5nLAlQQUNLRVRKKG1tVVZEX0xNSV9FSlJCQ19S
Ql9NRU1fUkRfNjRCSVRfQkFSX0hJR0hfSU5URVJOQUxfT0ZGU0VULAorCQkwLCAwLCBQQUNLRVRK
X1RZUEUwKSk7CisJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgdXBwZXJfMzJfYml0cyhyaW5nLT5n
cHVfYWRkcikpOworCisJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywJUEFDS0VUSigwLCAwLCBQQUNL
RVRKX0NPTkRJVElPTl9DSEVDSzAsIFBBQ0tFVEpfVFlQRTIpKTsKKwlhbWRncHVfcmluZ193cml0
ZShyaW5nLCAwKTsKKworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsCVBBQ0tFVEoobW1VVkRfSlJC
Q19FTkNfUkJfQ09ORF9SRF9USU1FUl9JTlRFUk5BTF9PRkZTRVQsCisJCTAsIDAsIFBBQ0tFVEpf
VFlQRTApKTsKKwlhbWRncHVfcmluZ193cml0ZShyaW5nLCAweDAxNDAwMjAwKTsKKworCWFtZGdw
dV9yaW5nX3dyaXRlKHJpbmcsIFBBQ0tFVEoobW1VVkRfSlJCQ19FTkNfUkJfUkVGX0RBVEFfSU5U
RVJOQUxfT0ZGU0VULAorCQkwLCAwLCBQQUNLRVRKX1RZUEUwKSk7CisJYW1kZ3B1X3Jpbmdfd3Jp
dGUocmluZywgMHgyKTsKKworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsCVBBQ0tFVEoobW1VVkRf
SlJCQ19FTkNfU1RBVFVTX0lOVEVSTkFMX09GRlNFVCwKKwkJMCwgUEFDS0VUSl9DT05ESVRJT05f
Q0hFQ0szLCBQQUNLRVRKX1RZUEUzKSk7CisJYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywgMHgyKTsK
K30KKworc3RhdGljIHZvaWQgdmNuX3YyXzBfanBlZ19lbmNfcmluZ19lbWl0X3JlZ193YWl0KHN0
cnVjdCBhbWRncHVfcmluZyAqcmluZywKKwkJCQkJICAgIHVpbnQzMl90IHJlZywgdWludDMyX3Qg
dmFsLAorCQkJCQkgICAgdWludDMyX3QgbWFzaykKK3sKKwl1aW50MzJfdCByZWdfb2Zmc2V0ID0g
KHJlZyA8PCAyKTsKKworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIFBBQ0tFVEoobW1VVkRfSlJC
Q19FTkNfUkJfQ09ORF9SRF9USU1FUl9JTlRFUk5BTF9PRkZTRVQsCisJCTAsIDAsIFBBQ0tFVEpf
VFlQRTApKTsKKwlhbWRncHVfcmluZ193cml0ZShyaW5nLCAweDAxNDAwMjAwKTsKKworCWFtZGdw
dV9yaW5nX3dyaXRlKHJpbmcsCVBBQ0tFVEoobW1VVkRfSlJCQ19FTkNfUkJfUkVGX0RBVEFfSU5U
RVJOQUxfT0ZGU0VULAorCQkwLCAwLCBQQUNLRVRKX1RZUEUwKSk7CisJYW1kZ3B1X3Jpbmdfd3Jp
dGUocmluZywgdmFsKTsKKworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIFBBQ0tFVEoobW1VVkRf
SlJCQ19FTkNfRVhURVJOQUxfUkVHX0lOVEVSTkFMX09GRlNFVCwKKwkJMCwgMCwgUEFDS0VUSl9U
WVBFMCkpOworCWlmIChyZWdfb2Zmc2V0ID49IDB4MTAwMDAgJiYgcmVnX29mZnNldCA8PSAweDEw
NWZmKSB7CisJCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIDApOworCQlhbWRncHVfcmluZ193cml0
ZShyaW5nLAorCQkJUEFDS0VUSigocmVnX29mZnNldCA+PiAyKSwgMCwgMCwgUEFDS0VUSl9UWVBF
MykpOworCX0gZWxzZSB7CisJCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIHJlZ19vZmZzZXQpOwor
CQlhbWRncHVfcmluZ193cml0ZShyaW5nLAlQQUNLRVRKKEpSQkNfRU5DX0VYVEVSTkFMX1JFR19X
UklURV9BRERSLAorCQkJMCwgMCwgUEFDS0VUSl9UWVBFMykpOworCX0KKwlhbWRncHVfcmluZ193
cml0ZShyaW5nLCBtYXNrKTsKK30KKworc3RhdGljIHZvaWQgdmNuX3YyXzBfanBlZ19lbmNfcmlu
Z19lbWl0X3ZtX2ZsdXNoKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZywKKwkJdW5zaWduZWQgdm1p
ZCwgdWludDY0X3QgcGRfYWRkcikKK3sKKwlzdHJ1Y3QgYW1kZ3B1X3ZtaHViICpodWIgPSAmcmlu
Zy0+YWRldi0+dm1odWJbcmluZy0+ZnVuY3MtPnZtaHViXTsKKwl1aW50MzJfdCBkYXRhMCwgZGF0
YTEsIG1hc2s7CisKKwlwZF9hZGRyID0gYW1kZ3B1X2dtY19lbWl0X2ZsdXNoX2dwdV90bGIocmlu
Zywgdm1pZCwgcGRfYWRkcik7CisKKwkvKiB3YWl0IGZvciByZWdpc3RlciB3cml0ZSAqLworCWRh
dGEwID0gaHViLT5jdHgwX3B0Yl9hZGRyX2xvMzIgKyB2bWlkICogMjsKKwlkYXRhMSA9IGxvd2Vy
XzMyX2JpdHMocGRfYWRkcik7CisJbWFzayA9IDB4ZmZmZmZmZmY7CisJdmNuX3YyXzBfanBlZ19y
aW5nX2VtaXRfcmVnX3dhaXQocmluZywgZGF0YTAsIGRhdGExLCBtYXNrKTsKK30KKworc3RhdGlj
IHZvaWQgdmNuX3YyXzBfanBlZ19lbmNfcmluZ19lbWl0X3dyZWcoc3RydWN0IGFtZGdwdV9yaW5n
ICpyaW5nLAorCQkJCQl1aW50MzJfdCByZWcsIHVpbnQzMl90IHZhbCkKK3sKKwl1aW50MzJfdCBy
ZWdfb2Zmc2V0ID0gKHJlZyA8PCAyKTsKKworCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsCVBBQ0tF
VEoobW1VVkRfSlJCQ19FTkNfRVhURVJOQUxfUkVHX0lOVEVSTkFMX09GRlNFVCwKKwkJMCwgMCwg
UEFDS0VUSl9UWVBFMCkpOworCWlmIChyZWdfb2Zmc2V0ID49IDB4MTAwMDAgJiYgcmVnX29mZnNl
dCA8PSAweDEwNWZmKSB7CisJCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIDApOworCQlhbWRncHVf
cmluZ193cml0ZShyaW5nLAorCQkJUEFDS0VUSigocmVnX29mZnNldCA+PiAyKSwgMCwgMCwgUEFD
S0VUSl9UWVBFMCkpOworCX0gZWxzZSB7CisJCWFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIHJlZ19v
ZmZzZXQpOworCQlhbWRncHVfcmluZ193cml0ZShyaW5nLAlQQUNLRVRKKEpSQkNfRU5DX0VYVEVS
TkFMX1JFR19XUklURV9BRERSLAorCQkJMCwgMCwgUEFDS0VUSl9UWVBFMCkpOworCX0KKwlhbWRn
cHVfcmluZ193cml0ZShyaW5nLCB2YWwpOworfQorCitzdGF0aWMgdm9pZCB2Y25fdjJfMF9qcGVn
X2VuY19yaW5nX25vcChzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsIHVpbnQzMl90IGNvdW50KQor
eworCWludCBpOworCisJV0FSTl9PTihyaW5nLT53cHRyICUgMiB8fCBjb3VudCAlIDIpOworCisJ
Zm9yIChpID0gMDsgaSA8IGNvdW50IC8gMjsgaSsrKSB7CisJCWFtZGdwdV9yaW5nX3dyaXRlKHJp
bmcsIFBBQ0tFVEooMCwgMCwgMCwgUEFDS0VUSl9UWVBFNikpOworCQlhbWRncHVfcmluZ193cml0
ZShyaW5nLCAwKTsKKwl9Cit9CisKIHN0YXRpYyBpbnQgdmNuX3YyXzBfc2V0X2ludGVycnVwdF9z
dGF0ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCQkJc3RydWN0IGFtZGdwdV9pcnFf
c3JjICpzb3VyY2UsCiAJCQkJCXVuc2lnbmVkIHR5cGUsCi0tIAoyLjE3LjEKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0
CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
