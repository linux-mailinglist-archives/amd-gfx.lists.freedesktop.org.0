Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 70615A2C17
	for <lists+amd-gfx@lfdr.de>; Fri, 30 Aug 2019 03:10:51 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C501F6E0EB;
	Fri, 30 Aug 2019 01:10:49 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM03-DM3-obe.outbound.protection.outlook.com
 (mail-eopbgr800085.outbound.protection.outlook.com [40.107.80.85])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 203F06E0EB
 for <amd-gfx@lists.freedesktop.org>; Fri, 30 Aug 2019 01:10:48 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=AMNqo1DIY+JuPBtJLdjUklSLEh4Opo9iyd/PSGH08QjXFl7InF9m6QHd/VXPSKvbC8g315t0hkEB5rQZUqwIrhtr44P5ehp4R4mHWL6VFdc67VnGu8br3IgECCTiHcuapwOaZ4PHQ66Nv0vwLPfw8QbYcRSVjmnS6LC1zu/jDCPpmQ1OnT9AbqeAZ+XnOFMbriWF9g+lPknsfq/wQxR2qoEhBbUN1NgkR8hErgQswGnef6xoSwtjTK9A9r+FLzCvQ6q6uoRuEZ4g3DRDlorbTQjTwlvyiqkWcg4cK9giTORFNMNALNjxoCGtAr2o/WsmuR0suR9mDF19e3B0BKI6pw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=Il6ImPG82vKCd4h4koAbLk9SrWaj3eYWmfXJ2ifbQYQ=;
 b=gfB3UOtIfVQW+rm7cu1cv8CM6A5+4j3fevzD1gmQMxTQQGpGHBhz4eRKEYG237Zd2cHi1vky77at7ODMdrMpLDptIZ+T1Yni/7TazUmaaM12BK+DqviopM/iN7akTaEOhGt8eLFHSXlkvUrB6JAkOh+rxBlKDt0E+et9oWdgCcV3fE5FCnK1FSUydtH5qkTzsMGyVRi/owfFPXWogUZVqeQfWmdoai9co/UKcBTUDSnSd1dB73b4sv9jzID7ALTTBn4/XsJAWPaheYw3wwDNoW77aV39GSOK01YbWck2vDgREFDoAGl5O2HmuAfavZ8YMEQS+uW8wyoq1/1EO+tLcg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
Received: from DM6PR12MB3947.namprd12.prod.outlook.com (10.255.174.156) by
 DM6PR12MB2970.namprd12.prod.outlook.com (20.178.29.83) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2199.21; Fri, 30 Aug 2019 01:10:46 +0000
Received: from DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::3d2a:29d4:df8:4d5]) by DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::3d2a:29d4:df8:4d5%2]) with mapi id 15.20.2199.021; Fri, 30 Aug 2019
 01:10:46 +0000
From: "Kuehling, Felix" <Felix.Kuehling@amd.com>
To: "Grodzovsky, Andrey" <Andrey.Grodzovsky@amd.com>,
 "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: Re: [PATCH v2 1/2] dmr/amdgpu: Avoid HW GPU reset for RAS.
Thread-Topic: [PATCH v2 1/2] dmr/amdgpu: Avoid HW GPU reset for RAS.
Thread-Index: AQHVXs1sDsM66bqOTUK8KQuyojp4z6cS4eMA
Date: Fri, 30 Aug 2019 01:10:45 +0000
Message-ID: <12fa9aec-90e0-d9bb-dd26-011123cc574c@amd.com>
References: <1567126427-13912-1-git-send-email-andrey.grodzovsky@amd.com>
In-Reply-To: <1567126427-13912-1-git-send-email-andrey.grodzovsky@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [165.204.55.251]
user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
x-clientproxiedby: YT1PR01CA0015.CANPRD01.PROD.OUTLOOK.COM (2603:10b6:b01::28)
 To DM6PR12MB3947.namprd12.prod.outlook.com
 (2603:10b6:5:1cb::28)
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 8e0a8252-5a3a-4bc1-a47a-08d72ce6e2db
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(5600166)(711020)(4605104)(1401327)(4618075)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(2017052603328)(7193020);
 SRVR:DM6PR12MB2970; 
x-ms-traffictypediagnostic: DM6PR12MB2970:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <DM6PR12MB297022DBB1B744CFAFD216DF92BD0@DM6PR12MB2970.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:913;
x-forefront-prvs: 0145758B1D
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(136003)(39860400002)(346002)(376002)(366004)(396003)(189003)(199004)(31696002)(81166006)(5660300002)(446003)(81156014)(71200400001)(316002)(11346002)(2906002)(476003)(2616005)(66446008)(6486002)(66476007)(305945005)(66556008)(25786009)(8676002)(486006)(53546011)(7736002)(110136005)(4326008)(71190400001)(386003)(6506007)(54906003)(66066001)(30864003)(8936002)(65806001)(64756008)(76176011)(65956001)(86362001)(2501003)(256004)(26005)(14444005)(99286004)(229853002)(14454004)(6246003)(3846002)(66946007)(186003)(478600001)(102836004)(6436002)(36756003)(53946003)(52116002)(31686004)(58126008)(6116002)(53936002)(6512007)(309714004);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM6PR12MB2970;
 H:DM6PR12MB3947.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: Y2S5SqF16Qg2RtJpI5ORHgsdNIFZi9BdS8V70B7sCYlIKLoDvrBvXLLe0MSfSqWLhK35bL8O8fzvwwAg+c0hQwiPKLcsxKD7gSEWnZA9FAizlxPSsrsXn5XUhNrvyHraWzsJH/4fcMxsuIBnSTKdRwHEV8ekQFJSiJsxZXJHQdgGaY/fMv3xjV/kj7pvk9Ejnh6fr7cpESJ5Li+kaRkyuPaw6WWJkemrj3GCvVhC1lBXH2tpFnDdKlu0V8IIjDSavxXAqQgdHlgBGrW/Ob105CJ/IHC4hzRtFqQIb3bBV3Rlv8AvQTfTLJdn+4k20FGPNiMGCPhNWh1hp9y4f6pO9F/w6/xiGNHGfc/IcxsoCWZq9GgjaqXAV1UrtiEsfm0BGORpoy+mhurmWckoGMNHyTaAWSJrx2+syjveZm8WyRI=
Content-ID: <649945F64F781E438AB843284B2C78D8@namprd12.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 8e0a8252-5a3a-4bc1-a47a-08d72ce6e2db
X-MS-Exchange-CrossTenant-originalarrivaltime: 30 Aug 2019 01:10:45.8702 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 6CdujHKGHLlsv0dLnGBlLKVfD/Kcw+bkArVWzUng9rbtSJ+NfzXsZ6vN5+4wTBVDo8N4K7sVJySUf5/dPA5wcw==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB2970
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=Il6ImPG82vKCd4h4koAbLk9SrWaj3eYWmfXJ2ifbQYQ=;
 b=HpuvLIdHaifLd+Q/GRaNSNN5f6kr8KcssukDalBaNzJbPGvPo+nDcks+7jMAEk66T6QaCceRAIZyj9NCTf1Is/OXH5PDccXN6eLdn34kiVaCj/oi5SPdq/AuAqkjYyWJyBiqSD5EATWlgil+DKjjE5E7sNfNDHYFbLCC/xabvPU=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Felix.Kuehling@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "alexdeucher@gmail.com" <alexdeucher@gmail.com>,
 "ckoenig.leichtzumerken@gmail.com" <ckoenig.leichtzumerken@gmail.com>, "Zhou1,
 Tao" <Tao.Zhou1@amd.com>, "Zhang, Hawking" <Hawking.Zhang@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

DQpPbiAyMDE5LTA4LTI5IDg6NTMgcC5tLiwgQW5kcmV5IEdyb2R6b3Zza3kgd3JvdGU6DQo+IFBy
b2JsZW06DQo+IFVuZGVyIGNlcnRhaW4gY29uZGl0aW9ucywgd2hlbiBzb21lIElQIGJvY2tzIHRh
a2UgYSBSQVMgZXJyb3IsDQo+IHdlIGNhbiBnZXQgaW50byBhIHNpdHVhdGlvbiB3aGVyZSBhIEdQ
VSByZXNldCBpcyBub3QgcG9zc2libGUNCj4gZHVlIHRvIGlzc3VlcyBpbiBSQVMgaW4gU01VL1BT
UC4NCj4NCj4gVGVtcG9yYXJ5IGZpeCB1bnRpbCBwcm9wZXIgc29sdXRpb24gaW4gUFNQL1NNVSBp
cyByZWFkeToNCj4gV2hlbiB1bmNvcnJlY3RhYmxlIGVycm9yIGhhcHBlbnMgdGhlIERGIHdpbGwg
dW5jb25kaXRpb25hbGx5DQo+IGJyb2FkY2FzdCBlcnJvciBldmVudCBwYWNrZXRzIHRvIGFsbCBp
dHMgY2xpZW50cy9zbGF2ZSB1cG9uDQo+IHJlY2VpdmluZyBmYXRhbCBlcnJvciBldmVudCBhbmQg
ZnJlZXplIGFsbCBpdHMgb3V0Ym91bmQgcXVldWVzLA0KPiBlcnJfZXZlbnRfYXRodWIgaW50ZXJy
dXB0ICB3aWxsIGJlIHRyaWdnZXJlZC4NCj4gSW4gc3VjaCBjYXNlIGFuZCB3ZSB1c2UgdGhpcyBp
bnRlcnJ1cHQNCj4gdG8gaXNzdWUgR1BVIHJlc2V0LiBUSGUgR1BVIHJlc2V0IGNvZGUgaXMgbW9k
aWZpZWQgZm9yIHN1Y2ggY2FzZSB0byBhdm9pZCBIVw0KPiByZXNldCwgb25seSBzdG9wcyBzY2hl
ZHVsZXJzLCBkZWF0Y2hlcyBhbGwgaW4gcHJvZ3Jlc3MgYW5kIG5vdCB5ZXQgc2NoZWR1bGVkDQo+
IGpvYidzIGZlbmNlcywgc2V0IGVycm9yIGNvZGUgb24gdGhlbSBhbmQgc2lnbmFscy4NCj4gQWxz
byByZWplY3QgYW55IG5ldyBpbmNvbWluZyBqb2Igc3VibWlzc2lvbnMgZnJvbSB1c2VyIHNwYWNl
Lg0KPiBBbGwgdGhpcyBpcyBkb25lIHRvIG5vdGlmeSB0aGUgYXBwbGljYXRpb25zIG9mIHRoZSBw
cm9ibGVtLg0KPg0KPiB2MjoNCj4gRXh0cmFjdCBhbWRncHVfYW1ka2ZkX3ByZS9wb3N0X3Jlc2V0
IGZyb20gYW1kZ3B1X2RldmljZV9sb2NrL3VubG9ja19hZGV2DQo+IE1vdmUgYW1kZ3B1X2pvYl9z
dG9wX2FsbF9qb2JzX29uX3NjaGVkIHRvIGFtZGdwdV9qb2IuYw0KPiBSZW1vdmUgcHJpbnQgcGFy
YW0gZnJvbSBhbWRncHVfcmFzX3F1ZXJ5X2Vycm9yX2NvdW50DQo+DQo+IFNpZ25lZC1vZmYtYnk6
IEFuZHJleSBHcm9kem92c2t5IDxhbmRyZXkuZ3JvZHpvdnNreUBhbWQuY29tPg0KPiAtLS0NCj4g
ICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3MuYyAgICAgfCAgNCArKysNCj4g
ICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMgfCA0NiArKysrKysr
KysrKysrKysrKysrKysrKy0tLS0tLS0NCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfZHJ2LmMgICAgfCAgNSArKysrDQo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2pvYi5jICAgIHwgMzggKysrKysrKysrKysrKysrKysrKysrKysrDQo+ICAgZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5oICAgIHwgIDMgKysNCj4gICBkcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfa21zLmMgICAgfCAgNiArKysrDQo+ICAgZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jhcy5jICAgIHwgMjIgKysrKysrKysrKysrLS0N
Cj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmFzLmggICAgfCAxMCArKysr
KysrDQo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYyAgICAgIHwgMTAg
KysrKy0tLQ0KPiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMgICAgICB8
IDI0ICsrKysrKysrKy0tLS0tLS0NCj4gICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9uYmlv
X3Y3XzQuYyAgICAgfCAgNSArKysrDQo+ICAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvc2Rt
YV92NF8wLmMgICAgIHwgMzIgKysrKysrKysrKystLS0tLS0tLS0tDQo+ICAgMTIgZmlsZXMgY2hh
bmdlZCwgMTYzIGluc2VydGlvbnMoKyksIDQyIGRlbGV0aW9ucygtKQ0KPg0KPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfY3MuYw0KPiBpbmRleCA5ZGE2ODFlLi4zMDBhZGI4IDEwMDY0
NA0KPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3MuYw0KPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3MuYw0KPiBAQCAtMzgsNiArMzgs
NyBAQA0KPiAgICNpbmNsdWRlICJhbWRncHVfZ21jLmgiDQo+ICAgI2luY2x1ZGUgImFtZGdwdV9n
ZW0uaCINCj4gICAjaW5jbHVkZSAiYW1kZ3B1X2Rpc3BsYXkuaCINCj4gKyNpbmNsdWRlICJhbWRn
cHVfcmFzLmgiDQo+ICAgDQo+ICAgI2lmIGRlZmluZWQoSEFWRV9EUk1fRlJFRV9MQVJHRSkNCj4g
ICAjZGVmaW5lIGt2ZnJlZSBkcm1fZnJlZV9sYXJnZQ0KPiBAQCAtMTQ2MSw2ICsxNDYyLDkgQEAg
aW50IGFtZGdwdV9jc19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLCBz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbHApDQo+ICAgCWJvb2wgcmVzZXJ2ZWRfYnVmZmVycyA9IGZhbHNl
Ow0KPiAgIAlpbnQgaSwgcjsNCj4gICANCj4gKwlpZiAoYW1kZ3B1X3Jhc19pbnRyX3RyaWdnZXJl
ZCgpKQ0KPiArCQlyZXR1cm4gLUVIV1BPSVNPTjsNCj4gKw0KPiAgIAlpZiAoIWFkZXYtPmFjY2Vs
X3dvcmtpbmcpDQo+ICAgCQlyZXR1cm4gLUVCVVNZOw0KPiAgIA0KPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jDQo+IGluZGV4IGE1ZGFjY2MuLmQzYTA3OGIgMTAw
NjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYw0K
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2aWNlLmMNCj4gQEAg
LTM3MjcsMjUgKzM3MjcsMTggQEAgc3RhdGljIGJvb2wgYW1kZ3B1X2RldmljZV9sb2NrX2FkZXYo
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIGJvb2wgdHJ5bG9jaykNCj4gICAJCWFkZXYtPm1w
MV9zdGF0ZSA9IFBQX01QMV9TVEFURV9OT05FOw0KPiAgIAkJYnJlYWs7DQo+ICAgCX0NCj4gLQkv
KiBCbG9jayBrZmQ6IFNSSU9WIHdvdWxkIGRvIGl0IHNlcGFyYXRlbHkgKi8NCj4gLQlpZiAoIWFt
ZGdwdV9zcmlvdl92ZihhZGV2KSkNCj4gLSAgICAgICAgICAgICAgICBhbWRncHVfYW1ka2ZkX3By
ZV9yZXNldChhZGV2KTsNCj4gICANCj4gICAJcmV0dXJuIHRydWU7DQo+ICAgfQ0KPiAgIA0KPiAg
IHN0YXRpYyB2b2lkIGFtZGdwdV9kZXZpY2VfdW5sb2NrX2FkZXYoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYpDQo+ICAgew0KPiAtCS8qdW5sb2NrIGtmZDogU1JJT1Ygd291bGQgZG8gaXQgc2Vw
YXJhdGVseSAqLw0KPiAtCWlmICghYW1kZ3B1X3NyaW92X3ZmKGFkZXYpKQ0KPiAtICAgICAgICAg
ICAgICAgIGFtZGdwdV9hbWRrZmRfcG9zdF9yZXNldChhZGV2KTsNCj4gICAJYW1kZ3B1X3ZmX2Vy
cm9yX3RyYW5zX2FsbChhZGV2KTsNCj4gICAJYWRldi0+bXAxX3N0YXRlID0gUFBfTVAxX1NUQVRF
X05PTkU7DQo+ICAgCWFkZXYtPmluX2dwdV9yZXNldCA9IDA7DQo+ICAgCW11dGV4X3VubG9jaygm
YWRldi0+bG9ja19yZXNldCk7DQo+ICAgfQ0KPiAgIA0KPiAtDQo+ICAgLyoqDQo+ICAgICogYW1k
Z3B1X2RldmljZV9ncHVfcmVjb3ZlciAtIHJlc2V0IHRoZSBhc2ljIGFuZCByZWNvdmVyIHNjaGVk
dWxlcg0KPiAgICAqDQo+IEBAIC0zNzY1LDExICszNzU4LDEyIEBAIGludCBhbWRncHVfZGV2aWNl
X2dwdV9yZWNvdmVyKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KPiAgIAlzdHJ1Y3QgYW1k
Z3B1X2hpdmVfaW5mbyAqaGl2ZSA9IE5VTEw7DQo+ICAgCXN0cnVjdCBhbWRncHVfZGV2aWNlICp0
bXBfYWRldiA9IE5VTEw7DQo+ICAgCWludCBpLCByID0gMDsNCj4gKwlib29sIGluX3Jhc19pbnRy
ID0gYW1kZ3B1X3Jhc19pbnRyX3RyaWdnZXJlZCgpOw0KPiAgIA0KPiAgIAluZWVkX2Z1bGxfcmVz
ZXQgPSBqb2Jfc2lnbmFsZWQgPSBmYWxzZTsNCj4gICAJSU5JVF9MSVNUX0hFQUQoJmRldmljZV9s
aXN0KTsNCj4gICANCj4gLQlkZXZfaW5mbyhhZGV2LT5kZXYsICJHUFUgcmVzZXQgYmVnaW4hXG4i
KTsNCj4gKwlkZXZfaW5mbyhhZGV2LT5kZXYsICJHUFUgJXMgYmVnaW4hXG4iLCBpbl9yYXNfaW50
ciA/ICJqb2JzIHN0b3AiOiJyZXNldCIpOw0KPiAgIA0KPiAgIAljYW5jZWxfZGVsYXllZF93b3Jr
X3N5bmMoJmFkZXYtPmRlbGF5ZWRfaW5pdF93b3JrKTsNCj4gICANCj4gQEAgLTM3OTYsOSArMzc5
MCwxNiBAQCBpbnQgYW1kZ3B1X2RldmljZV9ncHVfcmVjb3ZlcihzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwNCj4gICAJCXJldHVybiAwOw0KPiAgIAl9DQo+ICAgDQo+ICsJLyogQmxvY2sga2Zk
OiBTUklPViB3b3VsZCBkbyBpdCBzZXBhcmF0ZWx5ICovDQo+ICsJaWYgKCFhbWRncHVfc3Jpb3Zf
dmYoYWRldikpDQo+ICsgICAgICAgICAgICAgICAgYW1kZ3B1X2FtZGtmZF9wcmVfcmVzZXQoYWRl
dik7DQo+ICsNCj4gICAJLyogQnVpbGQgbGlzdCBvZiBkZXZpY2VzIHRvIHJlc2V0ICovDQo+ICAg
CWlmICAoYWRldi0+Z21jLnhnbWkubnVtX3BoeXNpY2FsX25vZGVzID4gMSkgew0KPiAgIAkJaWYg
KCFoaXZlKSB7DQo+ICsJCQkvKnVubG9jayBrZmQ6IFNSSU9WIHdvdWxkIGRvIGl0IHNlcGFyYXRl
bHkgKi8NCj4gKwkJCWlmICghYW1kZ3B1X3NyaW92X3ZmKGFkZXYpKQ0KPiArCQkgICAgICAgICAg
ICAgICAgYW1kZ3B1X2FtZGtmZF9wb3N0X3Jlc2V0KGFkZXYpOw0KPiAgIAkJCWFtZGdwdV9kZXZp
Y2VfdW5sb2NrX2FkZXYoYWRldik7DQo+ICAgCQkJcmV0dXJuIC1FTk9ERVY7DQo+ICAgCQl9DQo+
IEBAIC0zODI0LDcgKzM4MjUsNyBAQCBpbnQgYW1kZ3B1X2RldmljZV9ncHVfcmVjb3ZlcihzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwNCj4gICAJLyogYmxvY2sgYWxsIHNjaGVkdWxlcnMgYW5k
IHJlc2V0IGdpdmVuIGpvYidzIHJpbmcgKi8NCj4gICAJbGlzdF9mb3JfZWFjaF9lbnRyeSh0bXBf
YWRldiwgZGV2aWNlX2xpc3RfaGFuZGxlLCBnbWMueGdtaS5oZWFkKSB7DQo+ICAgCQkvKiBkaXNh
YmxlIHJhcyBvbiBBTEwgSVBzICovDQo+IC0JCWlmIChhbWRncHVfZGV2aWNlX2lwX25lZWRfZnVs
bF9yZXNldCh0bXBfYWRldikpDQo+ICsJCWlmICghaW5fcmFzX2ludHIgJiYgYW1kZ3B1X2Rldmlj
ZV9pcF9uZWVkX2Z1bGxfcmVzZXQodG1wX2FkZXYpKQ0KPiAgIAkJCWFtZGdwdV9yYXNfc3VzcGVu
ZCh0bXBfYWRldik7DQo+ICAgDQo+ICAgCQlmb3IgKGkgPSAwOyBpIDwgQU1ER1BVX01BWF9SSU5H
UzsgKytpKSB7DQo+IEBAIC0zODM0LDEwICszODM1LDI2IEBAIGludCBhbWRncHVfZGV2aWNlX2dw
dV9yZWNvdmVyKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KPiAgIAkJCQljb250aW51ZTsN
Cj4gICANCj4gICAJCQlkcm1fc2NoZWRfc3RvcCgmcmluZy0+c2NoZWQsIGpvYiA/ICZqb2ItPmJh
c2UgOiBOVUxMKTsNCj4gKw0KPiArCQkJaWYgKGluX3Jhc19pbnRyKQ0KPiArCQkJCWFtZGdwdV9q
b2Jfc3RvcF9hbGxfam9ic19vbl9zY2hlZCgmcmluZy0+c2NoZWQpOw0KPiAgIAkJfQ0KPiAgIAl9
DQo+ICAgDQo+ICAgDQo+ICsJaWYgKGluX3Jhc19pbnRyKSB7DQo+ICsJCWxpc3RfZm9yX2VhY2hf
ZW50cnkodG1wX2FkZXYsIGRldmljZV9saXN0X2hhbmRsZSwgZ21jLnhnbWkuaGVhZCkgew0KPiAr
CQkJaWYgKHRtcF9hZGV2ID09IGFkZXYpDQo+ICsJCQkJY29udGludWU7DQo+ICsNCj4gKwkJCWlm
IChhbWRncHVfZGV2aWNlX2xvY2tfYWRldih0bXBfYWRldiwgZmFsc2UpICYmICFhbWRncHVfc3Jp
b3ZfdmYodG1wX2FkZXYpKQ0KPiArCQkJCWFtZGdwdV9hbWRrZmRfcHJlX3Jlc2V0KHRtcF9hZGV2
KTsNCj4gKw0KPiArCQl9DQo+ICsNCj4gKwkJZ290byBza2lwX3NjaGVkX3Jlc3VtZTsNCj4gKwl9
DQo+ICsNCj4gICAJLyoNCj4gICAJICogTXVzdCBjaGVjayBndWlsdHkgc2lnbmFsIGhlcmUgc2lu
Y2UgYWZ0ZXIgdGhpcyBwb2ludCBhbGwgb2xkDQo+ICAgCSAqIEhXIGZlbmNlcyBhcmUgZm9yY2Ug
c2lnbmFsZWQuDQo+IEBAIC0zODcyLDcgKzM4ODksOSBAQCBpbnQgYW1kZ3B1X2RldmljZV9ncHVf
cmVjb3ZlcihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwNCj4gICAJCWlmICh0bXBfYWRldiA9
PSBhZGV2KQ0KPiAgIAkJCWNvbnRpbnVlOw0KPiAgIA0KPiAtCQlhbWRncHVfZGV2aWNlX2xvY2tf
YWRldih0bXBfYWRldiwgZmFsc2UpOw0KPiArCQlpZiAoYW1kZ3B1X2RldmljZV9sb2NrX2FkZXYo
dG1wX2FkZXYsIGZhbHNlKSAmJiAhYW1kZ3B1X3NyaW92X3ZmKHRtcF9hZGV2KSkNCj4gKwkJCWFt
ZGdwdV9hbWRrZmRfcHJlX3Jlc2V0KHRtcF9hZGV2KTsNCj4gKw0KPiAgIAkJciA9IGFtZGdwdV9k
ZXZpY2VfcHJlX2FzaWNfcmVzZXQodG1wX2FkZXYsDQo+ICAgCQkJCQkJIE5VTEwsDQo+ICAgCQkJ
CQkJICZuZWVkX2Z1bGxfcmVzZXQpOw0KPiBAQCAtMzkwMCw2ICszOTE5LDcgQEAgaW50IGFtZGdw
dV9kZXZpY2VfZ3B1X3JlY292ZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQo+ICAgDQo+
ICAgCS8qIFBvc3QgQVNJQyByZXNldCBmb3IgYWxsIGRldnMgLiovDQo+ICAgCWxpc3RfZm9yX2Vh
Y2hfZW50cnkodG1wX2FkZXYsIGRldmljZV9saXN0X2hhbmRsZSwgZ21jLnhnbWkuaGVhZCkgew0K
PiArDQo+ICAgCQlmb3IgKGkgPSAwOyBpIDwgQU1ER1BVX01BWF9SSU5HUzsgKytpKSB7DQo+ICAg
CQkJc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nID0gdG1wX2FkZXYtPnJpbmdzW2ldOw0KPiAgIA0K
PiBAQCAtMzkyNiw3ICszOTQ2LDEzIEBAIGludCBhbWRncHVfZGV2aWNlX2dwdV9yZWNvdmVyKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KPiAgIAkJfSBlbHNlIHsNCj4gICAJCQlkZXZfaW5m
byh0bXBfYWRldi0+ZGV2LCAiR1BVIHJlc2V0KCVkKSBzdWNjZWVkZWQhXG4iLCBhdG9taWNfcmVh
ZCgmYWRldi0+Z3B1X3Jlc2V0X2NvdW50ZXIpKTsNCj4gICAJCX0NCj4gKwl9DQo+ICAgDQo+ICtz
a2lwX3NjaGVkX3Jlc3VtZToNCj4gKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KHRtcF9hZGV2LCBkZXZp
Y2VfbGlzdF9oYW5kbGUsIGdtYy54Z21pLmhlYWQpIHsNCj4gKwkJLyp1bmxvY2sga2ZkOiBTUklP
ViB3b3VsZCBkbyBpdCBzZXBhcmF0ZWx5ICovDQo+ICsJCWlmICghaW5fcmFzX2ludHIgJiYgIWFt
ZGdwdV9zcmlvdl92Zih0bXBfYWRldikpDQo+ICsJICAgICAgICAgICAgICAgIGFtZGdwdV9hbWRr
ZmRfcG9zdF9yZXNldCh0bXBfYWRldik7DQoNCkkgdGhpbmsgdGhpcyBkb2Vzbid0IGhhbmRsZSB0
aGUgY2FzZSBjb3JyZWN0bHkgdGhhdCBsb2NrX2FkZXYgZmFpbGVkLiBJbiANCnRoYXQgY2FzZSBw
cmVfcmVzZXQgd2Fzbid0IGNhbGxlZCwgc28geW91IHNob3VsZCBub3QgY2FsbCBwb3N0X3Jlc2V0
IGVpdGhlci4NCg0KUmVnYXJkcywNCiDCoCBGZWxpeA0KDQoNCj4gICAJCWFtZGdwdV9kZXZpY2Vf
dW5sb2NrX2FkZXYodG1wX2FkZXYpOw0KPiAgIAl9DQo+ICAgDQo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfZHJ2LmMNCj4gaW5kZXggMTUxZDdmMi4uNzU3ZmQ2ZCAxMDA2NDQNCj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rydi5jDQo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kcnYuYw0KPiBAQCAtNDAsNiArNDAsOCBA
QA0KPiAgIA0KPiAgICNpbmNsdWRlICJhbWRncHVfYW1ka2ZkLmgiDQo+ICAgDQo+ICsjaW5jbHVk
ZSAiYW1kZ3B1X3Jhcy5oIg0KPiArDQo+ICAgLyoNCj4gICAgKiBLTVMgd3JhcHBlci4NCj4gICAg
KiAtIDMuMC4wIC0gaW5pdGlhbCBkcml2ZXINCj4gQEAgLTExNzksNiArMTE4MSw5IEBAIGFtZGdw
dV9wY2lfc2h1dGRvd24oc3RydWN0IHBjaV9kZXYgKnBkZXYpDQo+ICAgCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSBwY2lfZ2V0X2RydmRhdGEocGRldik7DQo+ICAgCXN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2ID0gZGV2LT5kZXZfcHJpdmF0ZTsNCj4gICANCj4gKwlpZiAoYW1kZ3B1X3Jhc19p
bnRyX3RyaWdnZXJlZCgpKQ0KPiArCQlyZXR1cm47DQo+ICsNCj4gICAJLyogaWYgd2UgYXJlIHJ1
bm5pbmcgaW4gYSBWTSwgbWFrZSBzdXJlIHRoZSBkZXZpY2UNCj4gICAJICogdG9ybiBkb3duIHBy
b3Blcmx5IG9uIHJlYm9vdC9zaHV0ZG93bi4NCj4gICAJICogdW5mb3J0dW5hdGVseSB3ZSBjYW4n
dCBkZXRlY3QgY2VydGFpbg0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2pvYi5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5j
DQo+IGluZGV4IDRkNjdiNzcuLmIxMjk4MWUgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9qb2IuYw0KPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfam9iLmMNCj4gQEAgLTI1MCw2ICsyNTAsNDQgQEAgc3RhdGljIHN0cnVjdCBk
bWFfZmVuY2UgKmFtZGdwdV9qb2JfcnVuKHN0cnVjdCBkcm1fc2NoZWRfam9iICpzY2hlZF9qb2Ip
DQo+ICAgCXJldHVybiBmZW5jZTsNCj4gICB9DQo+ICAgDQo+ICsjZGVmaW5lIHRvX2RybV9zY2hl
ZF9qb2Ioc2NoZWRfam9iKQkJXA0KPiArCQljb250YWluZXJfb2YoKHNjaGVkX2pvYiksIHN0cnVj
dCBkcm1fc2NoZWRfam9iLCBxdWV1ZV9ub2RlKQ0KPiArDQo+ICt2b2lkIGFtZGdwdV9qb2Jfc3Rv
cF9hbGxfam9ic19vbl9zY2hlZChzdHJ1Y3QgZHJtX2dwdV9zY2hlZHVsZXIgKnNjaGVkKQ0KPiAr
ew0KPiArCXN0cnVjdCBkcm1fc2NoZWRfam9iICpzX2pvYjsNCj4gKwlzdHJ1Y3QgZHJtX3NjaGVk
X2VudGl0eSAqc19lbnRpdHkgPSBOVUxMOw0KPiArCWludCBpOw0KPiArDQo+ICsJLyogU2lnbmFs
IGFsbCBqb2JzIG5vdCB5ZXQgc2NoZWR1bGVkICovDQo+ICsJZm9yIChpID0gRFJNX1NDSEVEX1BS
SU9SSVRZX01BWCAtIDE7IGkgPj0gRFJNX1NDSEVEX1BSSU9SSVRZX01JTjsgaS0tKSB7DQo+ICsJ
CXN0cnVjdCBkcm1fc2NoZWRfcnEgKnJxID0gJnNjaGVkLT5zY2hlZF9ycVtpXTsNCj4gKw0KPiAr
CQlpZiAoIXJxKQ0KPiArCQkJY29udGludWU7DQo+ICsNCj4gKwkJc3Bpbl9sb2NrKCZycS0+bG9j
ayk7DQo+ICsJCWxpc3RfZm9yX2VhY2hfZW50cnkoc19lbnRpdHksICZycS0+ZW50aXRpZXMsIGxp
c3QpIHsNCj4gKwkJCXdoaWxlICgoc19qb2IgPSB0b19kcm1fc2NoZWRfam9iKHNwc2NfcXVldWVf
cG9wKCZzX2VudGl0eS0+am9iX3F1ZXVlKSkpKSB7DQo+ICsJCQkJc3RydWN0IGRybV9zY2hlZF9m
ZW5jZSAqc19mZW5jZSA9IHNfam9iLT5zX2ZlbmNlOw0KPiArDQo+ICsJCQkJZG1hX2ZlbmNlX3Np
Z25hbCgmc19mZW5jZS0+c2NoZWR1bGVkKTsNCj4gKwkJCQlkbWFfZmVuY2Vfc2V0X2Vycm9yKCZz
X2ZlbmNlLT5maW5pc2hlZCwgLUVIV1BPSVNPTik7DQo+ICsJCQkJZG1hX2ZlbmNlX3NpZ25hbCgm
c19mZW5jZS0+ZmluaXNoZWQpOw0KPiArCQkJfQ0KPiArCQl9DQo+ICsJCXNwaW5fdW5sb2NrKCZy
cS0+bG9jayk7DQo+ICsJfQ0KPiArDQo+ICsJLyogU2lnbmFsIGFsbCBqb2JzIGFscmVhZHkgc2No
ZWR1bGVkIHRvIEhXICovDQo+ICsJbGlzdF9mb3JfZWFjaF9lbnRyeShzX2pvYiwgJnNjaGVkLT5y
aW5nX21pcnJvcl9saXN0LCBub2RlKSB7DQo+ICsJCXN0cnVjdCBkcm1fc2NoZWRfZmVuY2UgKnNf
ZmVuY2UgPSBzX2pvYi0+c19mZW5jZTsNCj4gKw0KPiArCQlkbWFfZmVuY2Vfc2V0X2Vycm9yKCZz
X2ZlbmNlLT5maW5pc2hlZCwgLUVIV1BPSVNPTik7DQo+ICsJCWRtYV9mZW5jZV9zaWduYWwoJnNf
ZmVuY2UtPmZpbmlzaGVkKTsNCj4gKwl9DQo+ICt9DQo+ICsNCj4gICBjb25zdCBzdHJ1Y3QgZHJt
X3NjaGVkX2JhY2tlbmRfb3BzIGFtZGdwdV9zY2hlZF9vcHMgPSB7DQo+ICAgCS5kZXBlbmRlbmN5
ID0gYW1kZ3B1X2pvYl9kZXBlbmRlbmN5LA0KPiAgIAkucnVuX2pvYiA9IGFtZGdwdV9qb2JfcnVu
LA0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5o
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2pvYi5oDQo+IGluZGV4IDUxZTYy
NTAuLmRjN2VlOTMgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9qb2IuaA0KPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfam9i
LmgNCj4gQEAgLTc2LDQgKzc2LDcgQEAgaW50IGFtZGdwdV9qb2Jfc3VibWl0KHN0cnVjdCBhbWRn
cHVfam9iICpqb2IsIHN0cnVjdCBkcm1fc2NoZWRfZW50aXR5ICplbnRpdHksDQo+ICAgCQkgICAg
ICB2b2lkICpvd25lciwgc3RydWN0IGRtYV9mZW5jZSAqKmYpOw0KPiAgIGludCBhbWRncHVfam9i
X3N1Ym1pdF9kaXJlY3Qoc3RydWN0IGFtZGdwdV9qb2IgKmpvYiwgc3RydWN0IGFtZGdwdV9yaW5n
ICpyaW5nLA0KPiAgIAkJCSAgICAgc3RydWN0IGRtYV9mZW5jZSAqKmZlbmNlKTsNCj4gKw0KPiAr
dm9pZCBhbWRncHVfam9iX3N0b3BfYWxsX2pvYnNfb25fc2NoZWQoc3RydWN0IGRybV9ncHVfc2No
ZWR1bGVyICpzY2hlZCk7DQo+ICsNCj4gICAjZW5kaWYNCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9rbXMuYw0KPiBpbmRleCBkYTIxNDNkLi5jZWQ3NjZjIDEwMDY0NA0KPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfa21zLmMNCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ttcy5jDQo+IEBAIC0xMDQ2LDYgKzEwNDYsMTIg
QEAgaW50IGFtZGdwdV9kcml2ZXJfb3Blbl9rbXMoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3Ry
dWN0IGRybV9maWxlICpmaWxlX3ByaXYpDQo+ICAgCS8qIEVuc3VyZSBJQiB0ZXN0cyBhcmUgcnVu
IG9uIHJpbmcgKi8NCj4gICAJZmx1c2hfZGVsYXllZF93b3JrKCZhZGV2LT5kZWxheWVkX2luaXRf
d29yayk7DQo+ICAgDQo+ICsNCj4gKwlpZiAoYW1kZ3B1X3Jhc19pbnRyX3RyaWdnZXJlZCgpKSB7
DQo+ICsJCURSTV9FUlJPUigiUkFTIEludHIgdHJpZ2dlcmVkLCBkZXZpY2UgZGlzYWJsZWQhISIp
Ow0KPiArCQlyZXR1cm4gLUVIV1BPSVNPTjsNCj4gKwl9DQo+ICsNCj4gICAJZmlsZV9wcml2LT5k
cml2ZXJfcHJpdiA9IE5VTEw7DQo+ICAgDQo+ICAgCXIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRl
di0+ZGV2KTsNCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9yYXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuYw0KPiBpbmRl
eCAyZDU4OTdhLi43YjAwYWM2IDEwMDY0NA0KPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfcmFzLmMNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3Jhcy5jDQo+IEBAIC0yNCw2ICsyNCw4IEBADQo+ICAgI2luY2x1ZGUgPGxpbnV4L2RlYnVn
ZnMuaD4NCj4gICAjaW5jbHVkZSA8bGludXgvbGlzdC5oPg0KPiAgICNpbmNsdWRlIDxsaW51eC9t
b2R1bGUuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC9yZWJvb3QuaD4NCj4gKyNpbmNsdWRlIDxsaW51
eC9zeXNjYWxscy5oPg0KPiAgICNpbmNsdWRlICJhbWRncHUuaCINCj4gICAjaW5jbHVkZSAiYW1k
Z3B1X3Jhcy5oIg0KPiAgICNpbmNsdWRlICJhbWRncHVfYXRvbWZpcm13YXJlLmgiDQo+IEBAIC02
NCw2ICs2Niw5IEBAIGNvbnN0IGNoYXIgKnJhc19ibG9ja19zdHJpbmdbXSA9IHsNCj4gICAvKiBp
bmplY3QgYWRkcmVzcyBpcyA1MiBiaXRzICovDQo+ICAgI2RlZmluZQlSQVNfVU1DX0lOSkVDVF9B
RERSX0xJTUlUCSgweDFVTEwgPDwgNTIpDQo+ICAgDQo+ICsNCj4gK2F0b21pY190IGFtZGdwdV9y
YXNfaW5faW50ciA9IEFUT01JQ19JTklUKDApOw0KPiArDQo+ICAgc3RhdGljIGludCBhbWRncHVf
cmFzX3Jlc2VydmVfdnJhbShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwNCj4gICAJCXVpbnQ2
NF90IG9mZnNldCwgdWludDY0X3Qgc2l6ZSwNCj4gICAJCXN0cnVjdCBhbWRncHVfYm8gKipib19w
dHIpOw0KPiBAQCAtMTg4LDYgKzE5MywxMCBAQCBzdGF0aWMgaW50IGFtZGdwdV9yYXNfZGVidWdm
c19jdHJsX3BhcnNlX2RhdGEoc3RydWN0IGZpbGUgKmYsDQo+ICAgDQo+ICAgCXJldHVybiAwOw0K
PiAgIH0NCj4gKw0KPiArc3RhdGljIHN0cnVjdCByYXNfbWFuYWdlciAqYW1kZ3B1X3Jhc19maW5k
X29iaihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwNCj4gKwkJc3RydWN0IHJhc19jb21tb25f
aWYgKmhlYWQpOw0KPiArDQo+ICAgLyoqDQo+ICAgICogRE9DOiBBTURHUFUgUkFTIGRlYnVnZnMg
Y29udHJvbCBpbnRlcmZhY2UNCj4gICAgKg0KPiBAQCAtNjI3LDEyICs2MzYsMTQgQEAgaW50IGFt
ZGdwdV9yYXNfZXJyb3JfcXVlcnkoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQo+ICAgCWlu
Zm8tPnVlX2NvdW50ID0gb2JqLT5lcnJfZGF0YS51ZV9jb3VudDsNCj4gICAJaW5mby0+Y2VfY291
bnQgPSBvYmotPmVycl9kYXRhLmNlX2NvdW50Ow0KPiAgIA0KPiAtCWlmIChlcnJfZGF0YS5jZV9j
b3VudCkNCj4gKwlpZiAoZXJyX2RhdGEuY2VfY291bnQpIHsNCj4gICAJCWRldl9pbmZvKGFkZXYt
PmRldiwgIiVsZCBjb3JyZWN0YWJsZSBlcnJvcnMgZGV0ZWN0ZWQgaW4gJXMgYmxvY2tcbiIsDQo+
ICAgCQkJIG9iai0+ZXJyX2RhdGEuY2VfY291bnQsIHJhc19ibG9ja19zdHIoaW5mby0+aGVhZC5i
bG9jaykpOw0KPiAtCWlmIChlcnJfZGF0YS51ZV9jb3VudCkNCj4gKwl9DQo+ICsJaWYgKGVycl9k
YXRhLnVlX2NvdW50KSB7DQo+ICAgCQlkZXZfaW5mbyhhZGV2LT5kZXYsICIlbGQgdW5jb3JyZWN0
YWJsZSBlcnJvcnMgZGV0ZWN0ZWQgaW4gJXMgYmxvY2tcbiIsDQo+ICAgCQkJIG9iai0+ZXJyX2Rh
dGEudWVfY291bnQsIHJhc19ibG9ja19zdHIoaW5mby0+aGVhZC5ibG9jaykpOw0KPiArCX0NCj4g
ICANCj4gICAJcmV0dXJuIDA7DQo+ICAgfQ0KPiBAQCAtMTcxOCwzICsxNzI5LDEwIEBAIGludCBh
bWRncHVfcmFzX2Zpbmkoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpDQo+ICAgDQo+ICAgCXJl
dHVybiAwOw0KPiAgIH0NCj4gKw0KPiArdm9pZCBhbWRncHVfcmFzX2dsb2JhbF9yYXNfaXNyKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQ0KPiArew0KPiArCWlmIChhdG9taWNfY21weGNoZygm
YW1kZ3B1X3Jhc19pbl9pbnRyLCAwLCAxKSA9PSAwKSB7DQo+ICsJCURSTV9XQVJOKCJSQVMgZXZl
bnQgb2YgdHlwZSBFUlJFVkVOVF9BVEhVQl9JTlRFUlJVUFQgZGV0ZWN0ZWQhIFN0b3BwaW5nIGFs
bCBHUFUgam9icy5cbiIpOw0KPiArCX0NCj4gK30NCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9yYXMuaA0KPiBpbmRleCA1YTBkZjczLi5jZjVmZmI2IDEwMDY0NA0KPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcmFzLmgNCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Jhcy5oDQo+IEBAIC02MDAsNCArNjAwLDE0IEBAIGlu
dCBhbWRncHVfcmFzX2ludGVycnVwdF9yZW1vdmVfaGFuZGxlcihzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwNCj4gICANCj4gICBpbnQgYW1kZ3B1X3Jhc19pbnRlcnJ1cHRfZGlzcGF0Y2goc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQo+ICAgCQlzdHJ1Y3QgcmFzX2Rpc3BhdGNoX2lmICpp
bmZvKTsNCj4gKw0KPiArZXh0ZXJuIGF0b21pY190IGFtZGdwdV9yYXNfaW5faW50cjsNCj4gKw0K
PiArc3RhdGljIGlubGluZSBib29sIGFtZGdwdV9yYXNfaW50cl90cmlnZ2VyZWQodm9pZCkNCj4g
K3sNCj4gKwlyZXR1cm4gISFhdG9taWNfcmVhZCgmYW1kZ3B1X3Jhc19pbl9pbnRyKTsNCj4gK30N
Cj4gKw0KPiArdm9pZCBhbWRncHVfcmFzX2dsb2JhbF9yYXNfaXNyKHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2KTsNCj4gKw0KPiAgICNlbmRpZg0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dm
eF92OV8wLmMNCj4gaW5kZXggYjJjODZhMC4uZTdhODNmNiAxMDA2NDQNCj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYw0KPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9nZnhfdjlfMC5jDQo+IEBAIC01NjY5LDEwICs1NjY5LDEyIEBAIHN0YXRpYyBp
bnQgZ2Z4X3Y5XzBfcHJvY2Vzc19yYXNfZGF0YV9jYihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwNCj4gICAJCXN0cnVjdCBhbWRncHVfaXZfZW50cnkgKmVudHJ5KQ0KPiAgIHsNCj4gICAJLyog
VE9ETyB1ZSB3aWxsIHRyaWdnZXIgYW4gaW50ZXJydXB0LiAqLw0KPiAtCWtnZDJrZmRfc2V0X3Ny
YW1fZWNjX2ZsYWcoYWRldi0+a2ZkLmRldik7DQo+IC0JaWYgKGFkZXYtPmdmeC5mdW5jcy0+cXVl
cnlfcmFzX2Vycm9yX2NvdW50KQ0KPiAtCQlhZGV2LT5nZnguZnVuY3MtPnF1ZXJ5X3Jhc19lcnJv
cl9jb3VudChhZGV2LCBlcnJfZGF0YSk7DQo+IC0JYW1kZ3B1X3Jhc19yZXNldF9ncHUoYWRldiwg
MCk7DQo+ICsJaWYgKCFhbWRncHVfcmFzX2lzX3N1cHBvcnRlZChhZGV2LCBBTURHUFVfUkFTX0JM
T0NLX19HRlgpKSB7DQo+ICsJCWtnZDJrZmRfc2V0X3NyYW1fZWNjX2ZsYWcoYWRldi0+a2ZkLmRl
dik7DQo+ICsJCWlmIChhZGV2LT5nZnguZnVuY3MtPnF1ZXJ5X3Jhc19lcnJvcl9jb3VudCkNCj4g
KwkJCWFkZXYtPmdmeC5mdW5jcy0+cXVlcnlfcmFzX2Vycm9yX2NvdW50KGFkZXYsIGVycl9kYXRh
KTsNCj4gKwkJYW1kZ3B1X3Jhc19yZXNldF9ncHUoYWRldiwgMCk7DQo+ICsJfQ0KPiAgIAlyZXR1
cm4gQU1ER1BVX1JBU19TVUNDRVNTOw0KPiAgIH0NCj4gICANCj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nbWNfdjlfMC5jDQo+IGluZGV4IDQzYjRmYmMuLjg3YTY2YzIgMTAwNjQ0DQo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMNCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAuYw0KPiBAQCAtMjQzLDE4ICsyNDMsMjAgQEAgc3Rh
dGljIGludCBnbWNfdjlfMF9wcm9jZXNzX3Jhc19kYXRhX2NiKHN0cnVjdCBhbWRncHVfZGV2aWNl
ICphZGV2LA0KPiAgIAkJc3RydWN0IHJhc19lcnJfZGF0YSAqZXJyX2RhdGEsDQo+ICAgCQlzdHJ1
Y3QgYW1kZ3B1X2l2X2VudHJ5ICplbnRyeSkNCj4gICB7DQo+IC0Ja2dkMmtmZF9zZXRfc3JhbV9l
Y2NfZmxhZyhhZGV2LT5rZmQuZGV2KTsNCj4gLQlpZiAoYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9y
YXNfZXJyb3JfY291bnQpDQo+IC0JCWFkZXYtPnVtYy5mdW5jcy0+cXVlcnlfcmFzX2Vycm9yX2Nv
dW50KGFkZXYsIGVycl9kYXRhKTsNCj4gLQkvKiB1bWMgcXVlcnlfcmFzX2Vycm9yX2FkZHJlc3Mg
aXMgYWxzbyByZXNwb25zaWJsZSBmb3IgY2xlYXJpbmcNCj4gLQkgKiBlcnJvciBzdGF0dXMNCj4g
LQkgKi8NCj4gLQlpZiAoYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9yYXNfZXJyb3JfYWRkcmVzcykN
Cj4gLQkJYWRldi0+dW1jLmZ1bmNzLT5xdWVyeV9yYXNfZXJyb3JfYWRkcmVzcyhhZGV2LCBlcnJf
ZGF0YSk7DQo+ICsJaWYgKCFhbWRncHVfcmFzX2lzX3N1cHBvcnRlZChhZGV2LCBBTURHUFVfUkFT
X0JMT0NLX19HRlgpKSB7DQo+ICsJCWtnZDJrZmRfc2V0X3NyYW1fZWNjX2ZsYWcoYWRldi0+a2Zk
LmRldik7DQo+ICsJCWlmIChhZGV2LT51bWMuZnVuY3MtPnF1ZXJ5X3Jhc19lcnJvcl9jb3VudCkN
Cj4gKwkJCWFkZXYtPnVtYy5mdW5jcy0+cXVlcnlfcmFzX2Vycm9yX2NvdW50KGFkZXYsIGVycl9k
YXRhKTsNCj4gKwkJLyogdW1jIHF1ZXJ5X3Jhc19lcnJvcl9hZGRyZXNzIGlzIGFsc28gcmVzcG9u
c2libGUgZm9yIGNsZWFyaW5nDQo+ICsJCSAqIGVycm9yIHN0YXR1cw0KPiArCQkgKi8NCj4gKwkJ
aWYgKGFkZXYtPnVtYy5mdW5jcy0+cXVlcnlfcmFzX2Vycm9yX2FkZHJlc3MpDQo+ICsJCQlhZGV2
LT51bWMuZnVuY3MtPnF1ZXJ5X3Jhc19lcnJvcl9hZGRyZXNzKGFkZXYsIGVycl9kYXRhKTsNCj4g
ICANCj4gLQkvKiBvbmx5IHVuY29ycmVjdGFibGUgZXJyb3IgbmVlZHMgZ3B1IHJlc2V0ICovDQo+
IC0JaWYgKGVycl9kYXRhLT51ZV9jb3VudCkNCj4gLQkJYW1kZ3B1X3Jhc19yZXNldF9ncHUoYWRl
diwgMCk7DQo+ICsJCS8qIG9ubHkgdW5jb3JyZWN0YWJsZSBlcnJvciBuZWVkcyBncHUgcmVzZXQg
Ki8NCj4gKwkJaWYgKGVycl9kYXRhLT51ZV9jb3VudCkNCj4gKwkJCWFtZGdwdV9yYXNfcmVzZXRf
Z3B1KGFkZXYsIDApOw0KPiArCX0NCj4gICANCj4gICAJcmV0dXJuIEFNREdQVV9SQVNfU1VDQ0VT
UzsNCj4gICB9DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9uYmlv
X3Y3XzQuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L25iaW9fdjdfNC5jDQo+IGluZGV4
IDM2N2Y5ZDYuLjU0NTk5MGMgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L25iaW9fdjdfNC5jDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L25iaW9f
djdfNC5jDQo+IEBAIC0zMCw2ICszMCw3IEBADQo+ICAgI2luY2x1ZGUgIm5iaW8vbmJpb183XzRf
MF9zbW4uaCINCj4gICAjaW5jbHVkZSAiaXZzcmNpZC9uYmlvL2lycXNyY3NfbmJpZl83XzQuaCIN
Cj4gICAjaW5jbHVkZSA8dWFwaS9saW51eC9rZmRfaW9jdGwuaD4NCj4gKyNpbmNsdWRlICJhbWRn
cHVfcmFzLmgiDQo+ICAgDQo+ICAgI2RlZmluZSBzbW5OQklGX01HQ0dfQ1RSTF9MQ0xLCTB4MTAx
M2EyMWMNCj4gICANCj4gQEAgLTMyOSw2ICszMzAsOCBAQCBzdGF0aWMgdm9pZCBuYmlvX3Y3XzRf
aGFuZGxlX3Jhc19jb250cm9sbGVyX2ludHJfbm9fYmlmcmluZyhzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZQ0KPiAgIAkJCQkJCUJJRl9ET09SQkVMTF9JTlRfQ05UTCwNCj4gICAJCQkJCQlSQVNfQ05UTFJf
SU5URVJSVVBUX0NMRUFSLCAxKTsNCj4gICAJCVdSRUczMl9TT0MxNShOQklPLCAwLCBtbUJJRl9E
T09SQkVMTF9JTlRfQ05UTCwgYmlmX2Rvb3JiZWxsX2ludHJfY250bCk7DQo+ICsNCj4gKwkJYW1k
Z3B1X3Jhc19nbG9iYWxfcmFzX2lzcihhZGV2KTsNCj4gICAJfQ0KPiAgIH0NCj4gICANCj4gQEAg
LTM0NCw2ICszNDcsOCBAQCBzdGF0aWMgdm9pZCBuYmlvX3Y3XzRfaGFuZGxlX3Jhc19lcnJfZXZl
bnRfYXRodWJfaW50cl9ub19iaWZyaW5nKHN0cnVjdCBhbWRncHVfZA0KPiAgIAkJCQkJCUJJRl9E
T09SQkVMTF9JTlRfQ05UTCwNCj4gICAJCQkJCQlSQVNfQVRIVUJfRVJSX0VWRU5UX0lOVEVSUlVQ
VF9DTEVBUiwgMSk7DQo+ICAgCQlXUkVHMzJfU09DMTUoTkJJTywgMCwgbW1CSUZfRE9PUkJFTExf
SU5UX0NOVEwsIGJpZl9kb29yYmVsbF9pbnRyX2NudGwpOw0KPiArDQo+ICsJCWFtZGdwdV9yYXNf
Z2xvYmFsX3Jhc19pc3IoYWRldik7DQo+ICAgCX0NCj4gICB9DQo+ICAgDQo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zZG1hX3Y0XzAuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L3NkbWFfdjRfMC5jDQo+IGluZGV4IDk1NjQzMmYuLjQzOGU1MDQgMTAwNjQ0
DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3NkbWFfdjRfMC5jDQo+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L3NkbWFfdjRfMC5jDQo+IEBAIC0xOTcyLDI0ICsx
OTcyLDI2IEBAIHN0YXRpYyBpbnQgc2RtYV92NF8wX3Byb2Nlc3NfcmFzX2RhdGFfY2Ioc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQo+ICAgCXVpbnQzMl90IGVycl9zb3VyY2U7DQo+ICAgCWlu
dCBpbnN0YW5jZTsNCj4gICANCj4gLQlpbnN0YW5jZSA9IHNkbWFfdjRfMF9pcnFfaWRfdG9fc2Vx
KGVudHJ5LT5jbGllbnRfaWQpOw0KPiAtCWlmIChpbnN0YW5jZSA8IDApDQo+IC0JCXJldHVybiAw
Ow0KPiArCWlmICghYW1kZ3B1X3Jhc19pc19zdXBwb3J0ZWQoYWRldiwgQU1ER1BVX1JBU19CTE9D
S19fR0ZYKSkgew0KPiArCQlpbnN0YW5jZSA9IHNkbWFfdjRfMF9pcnFfaWRfdG9fc2VxKGVudHJ5
LT5jbGllbnRfaWQpOw0KPiArCQlpZiAoaW5zdGFuY2UgPCAwKQ0KPiArCQkJcmV0dXJuIDA7DQo+
ICAgDQo+IC0Jc3dpdGNoIChlbnRyeS0+c3JjX2lkKSB7DQo+IC0JY2FzZSBTRE1BMF80XzBfX1NS
Q0lEX19TRE1BX1NSQU1fRUNDOg0KPiAtCQllcnJfc291cmNlID0gMDsNCj4gLQkJYnJlYWs7DQo+
IC0JY2FzZSBTRE1BMF80XzBfX1NSQ0lEX19TRE1BX0VDQzoNCj4gLQkJZXJyX3NvdXJjZSA9IDE7
DQo+IC0JCWJyZWFrOw0KPiAtCWRlZmF1bHQ6DQo+IC0JCXJldHVybiAwOw0KPiAtCX0NCj4gKwkJ
c3dpdGNoIChlbnRyeS0+c3JjX2lkKSB7DQo+ICsJCWNhc2UgU0RNQTBfNF8wX19TUkNJRF9fU0RN
QV9TUkFNX0VDQzoNCj4gKwkJCWVycl9zb3VyY2UgPSAwOw0KPiArCQkJYnJlYWs7DQo+ICsJCWNh
c2UgU0RNQTBfNF8wX19TUkNJRF9fU0RNQV9FQ0M6DQo+ICsJCQllcnJfc291cmNlID0gMTsNCj4g
KwkJCWJyZWFrOw0KPiArCQlkZWZhdWx0Og0KPiArCQkJcmV0dXJuIDA7DQo+ICsJCX0NCj4gICAN
Cj4gLQlrZ2Qya2ZkX3NldF9zcmFtX2VjY19mbGFnKGFkZXYtPmtmZC5kZXYpOw0KPiArCQlrZ2Qy
a2ZkX3NldF9zcmFtX2VjY19mbGFnKGFkZXYtPmtmZC5kZXYpOw0KPiAgIA0KPiAtCWFtZGdwdV9y
YXNfcmVzZXRfZ3B1KGFkZXYsIDApOw0KPiArCQlhbWRncHVfcmFzX3Jlc2V0X2dwdShhZGV2LCAw
KTsNCj4gKwl9DQo+ICAgDQo+ICAgCXJldHVybiBBTURHUFVfUkFTX1NVQ0NFU1M7DQo+ICAgfQ0K
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBt
YWlsaW5nIGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
