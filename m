Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id AEB031A233
	for <lists+amd-gfx@lfdr.de>; Fri, 10 May 2019 19:20:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E3F1189FAC;
	Fri, 10 May 2019 17:20:23 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM01-BY2-obe.outbound.protection.outlook.com
 (mail-eopbgr810054.outbound.protection.outlook.com [40.107.81.54])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0CFB789F89
 for <amd-gfx@lists.freedesktop.org>; Fri, 10 May 2019 17:20:23 +0000 (UTC)
Received: from DM3PR12CA0062.namprd12.prod.outlook.com (2603:10b6:0:56::30) by
 MWHPR12MB1278.namprd12.prod.outlook.com (2603:10b6:300:10::14) with
 Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1878.20; Fri, 10 May 2019 17:20:21 +0000
Received: from CO1NAM03FT005.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e48::201) by DM3PR12CA0062.outlook.office365.com
 (2603:10b6:0:56::30) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.1878.21 via Frontend
 Transport; Fri, 10 May 2019 17:20:21 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV01.amd.com (165.204.84.17) by
 CO1NAM03FT005.mail.protection.outlook.com (10.152.80.156) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.1856.11 via Frontend Transport; Fri, 10 May 2019 17:20:20 +0000
Received: from blakha.amd.com (10.180.168.240) by SATLEXCHOV01.amd.com
 (10.181.40.71) with Microsoft SMTP Server id 14.3.389.1; Fri, 10 May 2019
 12:20:12 -0500
From: Bhawanpreet Lakha <Bhawanpreet.Lakha@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 07/16] drm/amd/display: Program VTG params after programming
 Global Sync
Date: Fri, 10 May 2019 13:19:26 -0400
Message-ID: <20190510171935.19792-8-Bhawanpreet.Lakha@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190510171935.19792-1-Bhawanpreet.Lakha@amd.com>
References: <20190510171935.19792-1-Bhawanpreet.Lakha@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(376002)(396003)(346002)(136003)(39860400002)(2980300002)(428003)(189003)(199004)(47776003)(72206003)(86362001)(305945005)(8676002)(5660300002)(6666004)(81156014)(53416004)(4326008)(81166006)(356004)(186003)(426003)(68736007)(36756003)(336012)(2351001)(50226002)(50466002)(48376002)(1076003)(126002)(77096007)(486006)(2906002)(76176011)(8936002)(11346002)(51416003)(446003)(6916009)(7696005)(16586007)(476003)(2616005)(316002)(70586007)(26005)(70206006)(53936002)(478600001)(14444005);
 DIR:OUT; SFP:1101; SCL:1; SRVR:MWHPR12MB1278; H:SATLEXCHOV01.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; MX:1; A:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: aa1d88f1-7b89-45db-addb-08d6d56bc7df
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600141)(711020)(4605104)(2017052603328);
 SRVR:MWHPR12MB1278; 
X-MS-TrafficTypeDiagnostic: MWHPR12MB1278:
X-Microsoft-Antispam-PRVS: <MWHPR12MB12785D70903AAACADF098A82F90C0@MWHPR12MB1278.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:8882;
X-Forefront-PRVS: 0033AAD26D
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: iCxcJ3q+dgY8wVT8V1QbN9Kibn0naWniFjfV6MqdH+wOsyluJnZXUhKiv9jUBCefyzIogrnyGAcLf+RPNiw7J3zW+agxr8/cuMEgGK6A0HDEF/a5JjVxLupjfTKXcGS38badpAAzNO3p4B/Mz1N4Roqm+mI6fFv6eLCxKVr91/uuITeez9GYltgOK96bDCV5KE+ye8VWxRnkmmGHkEwcRK0PBbkHc2nsM1xoa6/Ino6Kj3Lib1bV2vcCNytkRbhMSt86D0xvogtXUa8lzezhiWxxGc8YGtmEFqOjGRiO77KjQKbAH1fKAAIX5VYZusT0XDpWPvQ5RshXFY+TDhrO/u4OCEWuDp7x+JRVUd23ZakDeMyRv9k5Vop9JbIDJOCuSEXnRGt3MUQlzPJq5GILDkD42AiZniHk9cDhu5ZHLFk=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 10 May 2019 17:20:20.8643 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: aa1d88f1-7b89-45db-addb-08d6d56bc7df
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV01.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MWHPR12MB1278
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amd-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=fJl9GOtGVAPLLlLBjia7RxNomSofEXhowJYfsRSNUXQ=;
 b=LhjpFc0+D62AqTi4iMWBZgsAb0s2R7mwN8AHdx+vfxO5WnUzMGxng7LOcO9ne5ejfZ7Bn5+u53rNQv9RSG1S0fRcfBQQ7EgHTNPpg4XsVxiKPss6hwKlIxHNeJmyPL0eMQFt6JvVMck6IoSfxiEo3HGD4WEOSKsO7rc27A+v6s4=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Joshua Aberback <joshua.aberback@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogSm9zaHVhIEFiZXJiYWNrIDxqb3NodWEuYWJlcmJhY2tAYW1kLmNvbT4KCltXaHldClZU
RyBoYXMgYSBwYXJhbWV0ZXIgRlAyLCB3aGljaCBpcyBkZWZpbmVkIGFzOgogICAgaWYgVlNUQVJU
VVAgaXMgYmVmb3JlIFZTWU5DOgogICAgICAgIEZQMiA9IG51bWJlciBvZiBsaW5lcyBpbiBiZXR3
ZWVuIFZTVEFSVFVQIGFuZCBWU1lOQwogICAgZWxzZQogICAgICAgIEZQMiA9IDAKQ3VycmVudGx5
LCBGUDIgaXMgb25seSBwcm9ncmFtbWVkIGR1cmluZyAicHJvZ3JhbV90aW1pbmciLiBIb3dldmVy
LCB0aGUKcG9zaXRpb24gb2YgVlNUQVJUVVAgaXMgYWZmZWN0ZWQgYnkgdGhlIHByZWZldGNoaW5n
IHJlcXVpcmVtZW50cyBvbiBhbGwgcGlwZXMsCnNvIHRoZSBwb3NpdGlvbiBtaWdodCBjaGFuZ2Ug
d2hlbiB3ZSBkbyBtZW1vcnkgcmVxdWVzdCBjb250cm9sIG9uIGFub3RoZXIgcGlwZSwgc28gd2Ug
bmVlZAp0byBtYWtlIHN1cmUgdGhhdCBGUDIgc3RheXMgdXAtdG8tZGF0ZSB3aGVuZXZlciB3ZSBh
ZGp1c3QgVlNUQVJUVVAuCgpbSG93XQogLSByZWZhY3RvciBWVEdfQ09OVFJPTCBwcm9ncmFtbWlu
ZyBpbnRvIGEgbmV3IGZ1bmN0aW9uICJzZXRfdnRnX3BhcmFtcyIKIC0gY2FsbCBpdCBhZnRlciBj
YWxsaW5nICJwcm9ncmFtX2dsb2JhbF9zeW5jIgogICAtIG1ha2Ugc3VyZSBpdCdzIGNhbGxlZCBh
ZnRlciBiZWNhdXNlIGl0IHJlbGllcyBvbiB0aGUgY2FjaGVkIGRsZyBwYXJhbXMKClNpZ25lZC1v
ZmYtYnk6IEpvc2h1YSBBYmVyYmFjayA8am9zaHVhLmFiZXJiYWNrQGFtZC5jb20+ClJldmlld2Vk
LWJ5OiBUb255IENoZW5nIDxUb255LkNoZW5nQGFtZC5jb20+CkFja2VkLWJ5OiBCaGF3YW5wcmVl
dCBMYWtoYSA8Qmhhd2FucHJlZXQuTGFraGFAYW1kLmNvbT4KQWNrZWQtYnk6IEp1biBMZWkgPEp1
bi5MZWlAYW1kLmNvbT4KLS0tCiAuLi4vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfaHdfc2Vx
dWVuY2VyLmMgfCAgIDMgKwogLi4uL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBf
b3B0Yy5jIHwgMTE1ICsrKysrKysrKystLS0tLS0tLQogLi4uL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvZGNuMTAvZGNuMTBfb3B0Yy5oIHwgICAzICsKIC4uLi9hbWQvZGlzcGxheS9kYy9pbmMvaHcv
dGltaW5nX2dlbmVyYXRvci5oICB8ICAgMiArCiA0IGZpbGVzIGNoYW5nZWQsIDczIGluc2VydGlv
bnMoKyksIDUwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kY24xMC9kY24xMF9od19zZXF1ZW5jZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9od19zZXF1ZW5jZXIuYwppbmRleCBiZjBkYjg3NGQ5
OWYuLjY2YmIwZTdkYjI1YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2RjbjEwL2RjbjEwX2h3X3NlcXVlbmNlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kY24xMC9kY24xMF9od19zZXF1ZW5jZXIuYwpAQCAtMjI4NSw2ICsyMjg1LDkg
QEAgc3RhdGljIHZvaWQgcHJvZ3JhbV9hbGxfcGlwZV9pbl90cmVlKAogCQkJCXBpcGVfY3R4LT5w
aXBlX2RsZ19wYXJhbS52dXBkYXRlX29mZnNldCwKIAkJCQlwaXBlX2N0eC0+cGlwZV9kbGdfcGFy
YW0udnVwZGF0ZV93aWR0aCk7CiAKKwkJcGlwZV9jdHgtPnN0cmVhbV9yZXMudGctPmZ1bmNzLT5z
ZXRfdnRnX3BhcmFtcygKKwkJCQlwaXBlX2N0eC0+c3RyZWFtX3Jlcy50ZywgJnBpcGVfY3R4LT5z
dHJlYW0tPnRpbWluZyk7CisKIAkJZGMtPmh3c3MuYmxhbmtfcGl4ZWxfZGF0YShkYywgcGlwZV9j
dHgsIGJsYW5rKTsKIAogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9kY24xMC9kY24xMF9vcHRjLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMv
ZGNuMTAvZGNuMTBfb3B0Yy5jCmluZGV4IDNiZGRhZWRjYjUyNy4uMTNmZTYzOGM5ZDljIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfb3B0Yy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9vcHRjLmMK
QEAgLTQ2LDkgKzQ2LDcgQEAKICogVGhpcyBpcyBhIHdvcmthcm91bmQgZm9yIGEgYnVnIHRoYXQg
aGFzIGV4aXN0ZWQgc2luY2UgUjV4eCBhbmQgaGFzIG5vdCBiZWVuCiAqIGZpeGVkIGtlZXAgRnJv
bnQgcG9yY2ggYXQgbWluaW11bSAyIGZvciBJbnRlcmxhY2VkIG1vZGUgb3IgMSBmb3IgcHJvZ3Jl
c3NpdmUuCiAqLwotc3RhdGljIHZvaWQgb3B0YzFfYXBwbHlfZnJvbnRfcG9yY2hfd29ya2Fyb3Vu
ZCgKLQlzdHJ1Y3QgdGltaW5nX2dlbmVyYXRvciAqb3B0YywKLQlzdHJ1Y3QgZGNfY3J0Y190aW1p
bmcgKnRpbWluZykKK3N0YXRpYyB2b2lkIGFwcGx5X2Zyb250X3BvcmNoX3dvcmthcm91bmQoc3Ry
dWN0IGRjX2NydGNfdGltaW5nICp0aW1pbmcpCiB7CiAJaWYgKHRpbWluZy0+ZmxhZ3MuSU5URVJM
QUNFID09IDEpIHsKIAkJaWYgKHRpbWluZy0+dl9mcm9udF9wb3JjaCA8IDIpCkBAIC0xNDksMTcg
KzE0NywxNCBAQCB2b2lkIG9wdGMxX3Byb2dyYW1fdGltaW5nKAogCWJvb2wgdXNlX3ZiaW9zKQog
ewogCXN0cnVjdCBkY19jcnRjX3RpbWluZyBwYXRjaGVkX2NydGNfdGltaW5nOwotCXVpbnQzMl90
IHZlc2Ffc3luY19zdGFydDsKIAl1aW50MzJfdCBhc2ljX2JsYW5rX2VuZDsKIAl1aW50MzJfdCBh
c2ljX2JsYW5rX3N0YXJ0OwogCXVpbnQzMl90IHZfdG90YWw7CiAJdWludDMyX3Qgdl9zeW5jX2Vu
ZDsKLQl1aW50MzJfdCB2X2luaXQsIHZfZnAyOwogCXVpbnQzMl90IGhfc3luY19wb2xhcml0eSwg
dl9zeW5jX3BvbGFyaXR5OwogCXVpbnQzMl90IHN0YXJ0X3BvaW50ID0gMDsKIAl1aW50MzJfdCBm
aWVsZF9udW0gPSAwOwogCXVpbnQzMl90IGhfZGl2XzI7Ci0JaW50MzJfdCB2ZXJ0aWNhbF9saW5l
X3N0YXJ0OwogCiAJc3RydWN0IG9wdGMgKm9wdGMxID0gRENOMTBUR19GUk9NX1RHKG9wdGMpOwog
CkBAIC0xNjksNyArMTY0LDcgQEAgdm9pZCBvcHRjMV9wcm9ncmFtX3RpbWluZygKIAlvcHRjMS0+
dnVwZGF0ZV9vZmZzZXQgPSB2dXBkYXRlX29mZnNldDsKIAlvcHRjMS0+dnVwZGF0ZV93aWR0aCA9
IHZ1cGRhdGVfd2lkdGg7CiAJcGF0Y2hlZF9jcnRjX3RpbWluZyA9ICpkY19jcnRjX3RpbWluZzsK
LQlvcHRjMV9hcHBseV9mcm9udF9wb3JjaF93b3JrYXJvdW5kKG9wdGMsICZwYXRjaGVkX2NydGNf
dGltaW5nKTsKKwlhcHBseV9mcm9udF9wb3JjaF93b3JrYXJvdW5kKCZwYXRjaGVkX2NydGNfdGlt
aW5nKTsKIAogCS8qIExvYWQgaG9yaXpvbnRhbCB0aW1pbmcgKi8KIApAQCAtMTgyLDI0ICsxNzcs
MTYgQEAgdm9pZCBvcHRjMV9wcm9ncmFtX3RpbWluZygKIAkJCU9UR19IX1NZTkNfQV9TVEFSVCwg
MCwKIAkJCU9UR19IX1NZTkNfQV9FTkQsIHBhdGNoZWRfY3J0Y190aW1pbmcuaF9zeW5jX3dpZHRo
KTsKIAotCS8qIGFzaWNfaF9ibGFua19lbmQgPSBIc3luY1dpZHRoICsgSGJhY2tQb3JjaCA9Ci0J
ICogdmVzYS4gdXNIb3Jpem9udGFsVG90YWwgLSB2ZXNhLiB1c0hvcml6b250YWxTeW5jU3RhcnQg
LQotCSAqIHZlc2EuaF9sZWZ0X2JvcmRlcgotCSAqLwotCXZlc2Ffc3luY19zdGFydCA9IHBhdGNo
ZWRfY3J0Y190aW1pbmcuaF9hZGRyZXNzYWJsZSArCi0JCQlwYXRjaGVkX2NydGNfdGltaW5nLmhf
Ym9yZGVyX3JpZ2h0ICsKKwkvKiBibGFua19zdGFydCA9IGxpbmUgZW5kIC0gZnJvbnQgcG9yY2gg
Ki8KKwlhc2ljX2JsYW5rX3N0YXJ0ID0gcGF0Y2hlZF9jcnRjX3RpbWluZy5oX3RvdGFsIC0KIAkJ
CXBhdGNoZWRfY3J0Y190aW1pbmcuaF9mcm9udF9wb3JjaDsKIAotCWFzaWNfYmxhbmtfZW5kID0g
cGF0Y2hlZF9jcnRjX3RpbWluZy5oX3RvdGFsIC0KLQkJCXZlc2Ffc3luY19zdGFydCAtCisJLyog
YmxhbmtfZW5kID0gYmxhbmtfc3RhcnQgLSBhY3RpdmUgKi8KKwlhc2ljX2JsYW5rX2VuZCA9IGFz
aWNfYmxhbmtfc3RhcnQgLQorCQkJcGF0Y2hlZF9jcnRjX3RpbWluZy5oX2JvcmRlcl9yaWdodCAt
CisJCQlwYXRjaGVkX2NydGNfdGltaW5nLmhfYWRkcmVzc2FibGUgLQogCQkJcGF0Y2hlZF9jcnRj
X3RpbWluZy5oX2JvcmRlcl9sZWZ0OwogCi0JLyogaF9ibGFua19zdGFydCA9IHZfYmxhbmtfZW5k
ICsgdl9hY3RpdmUgKi8KLQlhc2ljX2JsYW5rX3N0YXJ0ID0gYXNpY19ibGFua19lbmQgKwotCQkJ
cGF0Y2hlZF9jcnRjX3RpbWluZy5oX2JvcmRlcl9sZWZ0ICsKLQkJCXBhdGNoZWRfY3J0Y190aW1p
bmcuaF9hZGRyZXNzYWJsZSArCi0JCQlwYXRjaGVkX2NydGNfdGltaW5nLmhfYm9yZGVyX3JpZ2h0
OwotCiAJUkVHX1VQREFURV8yKE9UR19IX0JMQU5LX1NUQVJUX0VORCwKIAkJCU9UR19IX0JMQU5L
X1NUQVJULCBhc2ljX2JsYW5rX3N0YXJ0LAogCQkJT1RHX0hfQkxBTktfRU5ELCBhc2ljX2JsYW5r
X2VuZCk7CkBAIC0yMzEsMjQgKzIxOCwxNSBAQCB2b2lkIG9wdGMxX3Byb2dyYW1fdGltaW5nKAog
CQkJT1RHX1ZfU1lOQ19BX1NUQVJULCAwLAogCQkJT1RHX1ZfU1lOQ19BX0VORCwgdl9zeW5jX2Vu
ZCk7CiAKLQl2ZXNhX3N5bmNfc3RhcnQgPSBwYXRjaGVkX2NydGNfdGltaW5nLnZfYWRkcmVzc2Fi
bGUgKwotCQkJcGF0Y2hlZF9jcnRjX3RpbWluZy52X2JvcmRlcl9ib3R0b20gKworCS8qIGJsYW5r
X3N0YXJ0ID0gZnJhbWUgZW5kIC0gZnJvbnQgcG9yY2ggKi8KKwlhc2ljX2JsYW5rX3N0YXJ0ID0g
cGF0Y2hlZF9jcnRjX3RpbWluZy52X3RvdGFsIC0KIAkJCXBhdGNoZWRfY3J0Y190aW1pbmcudl9m
cm9udF9wb3JjaDsKIAotCWFzaWNfYmxhbmtfZW5kID0gKHBhdGNoZWRfY3J0Y190aW1pbmcudl90
b3RhbCAtCi0JCQl2ZXNhX3N5bmNfc3RhcnQgLQotCQkJcGF0Y2hlZF9jcnRjX3RpbWluZy52X2Jv
cmRlcl90b3ApOwotCi0JLyogdl9ibGFua19zdGFydCA9IHZfYmxhbmtfZW5kICsgdl9hY3RpdmUg
Ki8KLQlhc2ljX2JsYW5rX3N0YXJ0ID0gYXNpY19ibGFua19lbmQgKwotCQkJKHBhdGNoZWRfY3J0
Y190aW1pbmcudl9ib3JkZXJfdG9wICsKLQkJCXBhdGNoZWRfY3J0Y190aW1pbmcudl9hZGRyZXNz
YWJsZSArCi0JCQlwYXRjaGVkX2NydGNfdGltaW5nLnZfYm9yZGVyX2JvdHRvbSk7Ci0KLQl2ZXJ0
aWNhbF9saW5lX3N0YXJ0ID0gYXNpY19ibGFua19lbmQgLSBvcHRjMS0+dnN0YXJ0dXBfc3RhcnQg
KyAxOwotCXZfZnAyID0gMDsKLQlpZiAodmVydGljYWxfbGluZV9zdGFydCA8IDApCi0JCXZfZnAy
ID0gLXZlcnRpY2FsX2xpbmVfc3RhcnQ7CisJLyogYmxhbmtfZW5kID0gYmxhbmtfc3RhcnQgLSBh
Y3RpdmUgKi8KKwlhc2ljX2JsYW5rX2VuZCA9IGFzaWNfYmxhbmtfc3RhcnQgLQorCQkJcGF0Y2hl
ZF9jcnRjX3RpbWluZy52X2JvcmRlcl9ib3R0b20gLQorCQkJcGF0Y2hlZF9jcnRjX3RpbWluZy52
X2FkZHJlc3NhYmxlIC0KKwkJCXBhdGNoZWRfY3J0Y190aW1pbmcudl9ib3JkZXJfdG9wOwogCiAJ
UkVHX1VQREFURV8yKE9UR19WX0JMQU5LX1NUQVJUX0VORCwKIAkJCU9UR19WX0JMQU5LX1NUQVJU
LCBhc2ljX2JsYW5rX3N0YXJ0LApAQCAtMjYxLDEwICsyMzksOSBAQCB2b2lkIG9wdGMxX3Byb2dy
YW1fdGltaW5nKAogCVJFR19VUERBVEUoT1RHX1ZfU1lOQ19BX0NOVEwsCiAJCU9UR19WX1NZTkNf
QV9QT0wsIHZfc3luY19wb2xhcml0eSk7CiAKLQl2X2luaXQgPSBhc2ljX2JsYW5rX3N0YXJ0Owog
CWlmIChvcHRjMS0+c2lnbmFsID09IFNJR05BTF9UWVBFX0RJU1BMQVlfUE9SVCB8fAotCQlvcHRj
MS0+c2lnbmFsID09IFNJR05BTF9UWVBFX0RJU1BMQVlfUE9SVF9NU1QgfHwKLQkJb3B0YzEtPnNp
Z25hbCA9PSBTSUdOQUxfVFlQRV9FRFApIHsKKwkJCW9wdGMxLT5zaWduYWwgPT0gU0lHTkFMX1RZ
UEVfRElTUExBWV9QT1JUX01TVCB8fAorCQkJb3B0YzEtPnNpZ25hbCA9PSBTSUdOQUxfVFlQRV9F
RFApIHsKIAkJc3RhcnRfcG9pbnQgPSAxOwogCQlpZiAocGF0Y2hlZF9jcnRjX3RpbWluZy5mbGFn
cy5JTlRFUkxBQ0UgPT0gMSkKIAkJCWZpZWxkX251bSA9IDE7CkBAIC0yNzIsMTMgKzI0OSwxMCBA
QCB2b2lkIG9wdGMxX3Byb2dyYW1fdGltaW5nKAogCiAJLyogSW50ZXJsYWNlICovCiAJaWYgKFJF
RyhPVEdfSU5URVJMQUNFX0NPTlRST0wpKSB7Ci0JCWlmIChwYXRjaGVkX2NydGNfdGltaW5nLmZs
YWdzLklOVEVSTEFDRSA9PSAxKSB7CisJCWlmIChwYXRjaGVkX2NydGNfdGltaW5nLmZsYWdzLklO
VEVSTEFDRSA9PSAxKQogCQkJUkVHX1VQREFURShPVEdfSU5URVJMQUNFX0NPTlRST0wsCiAJCQkJ
CU9UR19JTlRFUkxBQ0VfRU5BQkxFLCAxKTsKLQkJCXZfaW5pdCA9IHZfaW5pdCAvIDI7Ci0JCQlp
ZiAoKG9wdGMxLT52c3RhcnR1cF9zdGFydC8yKSoyID4gYXNpY19ibGFua19lbmQpCi0JCQkJdl9m
cDIgPSB2X2ZwMiAvIDI7Ci0JCX0gZWxzZQorCQllbHNlCiAJCQlSRUdfVVBEQVRFKE9UR19JTlRF
UkxBQ0VfQ09OVFJPTCwKIAkJCQkJT1RHX0lOVEVSTEFDRV9FTkFCTEUsIDApOwogCX0KQEAgLTI4
NywyMSArMjYxLDE5IEBAIHZvaWQgb3B0YzFfcHJvZ3JhbV90aW1pbmcoCiAJUkVHX1VQREFURShD
T05UUk9MLAogCQkJVlRHMF9FTkFCTEUsIDApOwogCi0JUkVHX1VQREFURV8yKENPTlRST0wsCi0J
CQlWVEcwX0ZQMiwgdl9mcDIsCi0JCQlWVEcwX1ZDT1VOVF9JTklULCB2X2luaXQpOwotCiAJLyog
b3JpZ2luYWwgY29kZSBpcyB1c2luZyBWVEcgb2Zmc2V0IHRvIGFkZHJlc3MgT1RHIHJlZywgc2Vl
bXMgd3JvbmcgKi8KIAlSRUdfVVBEQVRFXzIoT1RHX0NPTlRST0wsCiAJCQlPVEdfU1RBUlRfUE9J
TlRfQ05UTCwgc3RhcnRfcG9pbnQsCiAJCQlPVEdfRklFTERfTlVNQkVSX0NOVEwsIGZpZWxkX251
bSk7CiAKLQlvcHRjMV9wcm9ncmFtX2dsb2JhbF9zeW5jKG9wdGMsCisJb3B0Yy0+ZnVuY3MtPnBy
b2dyYW1fZ2xvYmFsX3N5bmMob3B0YywKIAkJCXZyZWFkeV9vZmZzZXQsCiAJCQl2c3RhcnR1cF9z
dGFydCwKIAkJCXZ1cGRhdGVfb2Zmc2V0LAogCQkJdnVwZGF0ZV93aWR0aCk7CiAKKwlvcHRjLT5m
dW5jcy0+c2V0X3Z0Z19wYXJhbXMob3B0YywgZGNfY3J0Y190aW1pbmcpOworCiAJLyogVE9ETwog
CSAqIHBhdGNoZWRfY3J0Y190aW1pbmcuZmxhZ3MuSE9SWl9DT1VOVF9CWV9UV08gPT0gMQogCSAq
IHByb2dyYW1faG9yel9jb3VudF9ieV8yCkBAIC0zMTksNiArMjkxLDQ4IEBAIHZvaWQgb3B0YzFf
cHJvZ3JhbV90aW1pbmcoCiAKIH0KIAordm9pZCBvcHRjMV9zZXRfdnRnX3BhcmFtcyhzdHJ1Y3Qg
dGltaW5nX2dlbmVyYXRvciAqb3B0YywKKwkJY29uc3Qgc3RydWN0IGRjX2NydGNfdGltaW5nICpk
Y19jcnRjX3RpbWluZykKK3sKKwlzdHJ1Y3QgZGNfY3J0Y190aW1pbmcgcGF0Y2hlZF9jcnRjX3Rp
bWluZzsKKwl1aW50MzJfdCBhc2ljX2JsYW5rX2VuZDsKKwl1aW50MzJfdCB2X2luaXQ7CisJdWlu
dDMyX3Qgdl9mcDIgPSAwOworCWludDMyX3QgdmVydGljYWxfbGluZV9zdGFydDsKKworCXN0cnVj
dCBvcHRjICpvcHRjMSA9IERDTjEwVEdfRlJPTV9URyhvcHRjKTsKKworCXBhdGNoZWRfY3J0Y190
aW1pbmcgPSAqZGNfY3J0Y190aW1pbmc7CisJYXBwbHlfZnJvbnRfcG9yY2hfd29ya2Fyb3VuZCgm
cGF0Y2hlZF9jcnRjX3RpbWluZyk7CisKKwkvKiBWQ09VTlRfSU5JVCBpcyB0aGUgc3RhcnQgb2Yg
YmxhbmsgKi8KKwl2X2luaXQgPSBwYXRjaGVkX2NydGNfdGltaW5nLnZfdG90YWwgLSBwYXRjaGVk
X2NydGNfdGltaW5nLnZfZnJvbnRfcG9yY2g7CisKKwkvKiBlbmQgb2YgYmxhbmsgPSB2X2luaXQg
LSBhY3RpdmUgKi8KKwlhc2ljX2JsYW5rX2VuZCA9IHZfaW5pdCAtCisJCQlwYXRjaGVkX2NydGNf
dGltaW5nLnZfYm9yZGVyX2JvdHRvbSAtCisJCQlwYXRjaGVkX2NydGNfdGltaW5nLnZfYWRkcmVz
c2FibGUgLQorCQkJcGF0Y2hlZF9jcnRjX3RpbWluZy52X2JvcmRlcl90b3A7CisKKwkvKiBpZiBW
U1RBUlRVUCBpcyBiZWZvcmUgVlNZTkMsIEZQMiBpcyB0aGUgb2Zmc2V0LCBvdGhlcndpc2UgMCAq
LworCXZlcnRpY2FsX2xpbmVfc3RhcnQgPSBhc2ljX2JsYW5rX2VuZCAtIG9wdGMxLT52c3RhcnR1
cF9zdGFydCArIDE7CisJaWYgKHZlcnRpY2FsX2xpbmVfc3RhcnQgPCAwKQorCQl2X2ZwMiA9IC12
ZXJ0aWNhbF9saW5lX3N0YXJ0OworCisJLyogSW50ZXJsYWNlICovCisJaWYgKFJFRyhPVEdfSU5U
RVJMQUNFX0NPTlRST0wpKSB7CisJCWlmIChwYXRjaGVkX2NydGNfdGltaW5nLmZsYWdzLklOVEVS
TEFDRSA9PSAxKSB7CisJCQl2X2luaXQgPSB2X2luaXQgLyAyOworCQkJaWYgKChvcHRjMS0+dnN0
YXJ0dXBfc3RhcnQvMikqMiA+IGFzaWNfYmxhbmtfZW5kKQorCQkJCXZfZnAyID0gdl9mcDIgLyAy
OworCQl9CisJfQorCisJUkVHX1VQREFURV8yKENPTlRST0wsCisJCQlWVEcwX0ZQMiwgdl9mcDIs
CisJCQlWVEcwX1ZDT1VOVF9JTklULCB2X2luaXQpOworfQorCiB2b2lkIG9wdGMxX3NldF9ibGFu
a19kYXRhX2RvdWJsZV9idWZmZXIoc3RydWN0IHRpbWluZ19nZW5lcmF0b3IgKm9wdGMsIGJvb2wg
ZW5hYmxlKQogewogCXN0cnVjdCBvcHRjICpvcHRjMSA9IERDTjEwVEdfRlJPTV9URyhvcHRjKTsK
QEAgLTE0NTEsNiArMTQ2NSw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdGltaW5nX2dlbmVyYXRv
cl9mdW5jcyBkY24xMF90Z19mdW5jcyA9IHsKIAkJLmNsZWFyX29wdGNfdW5kZXJmbG93ID0gb3B0
YzFfY2xlYXJfb3B0Y191bmRlcmZsb3csCiAJCS5nZXRfY3JjID0gb3B0YzFfZ2V0X2NyYywKIAkJ
LmNvbmZpZ3VyZV9jcmMgPSBvcHRjMV9jb25maWd1cmVfY3JjLAorCQkuc2V0X3Z0Z19wYXJhbXMg
PSBvcHRjMV9zZXRfdnRnX3BhcmFtcywKIH07CiAKIHZvaWQgZGNuMTBfdGltaW5nX2dlbmVyYXRv
cl9pbml0KHN0cnVjdCBvcHRjICpvcHRjMSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9vcHRjLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvZGNuMTAvZGNuMTBfb3B0Yy5oCmluZGV4IDdiYjQxNGMzNWQxMy4uNjUxYjhjYWE0
YjlmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNu
MTBfb3B0Yy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24x
MF9vcHRjLmgKQEAgLTU5Nyw0ICs1OTcsNyBAQCBib29sIG9wdGMxX2dldF9jcmMoc3RydWN0IHRp
bWluZ19nZW5lcmF0b3IgKm9wdGMsCiAKIGJvb2wgb3B0YzFfaXNfdHdvX3BpeGVsc19wZXJfY29u
dGFpbnRlcihjb25zdCBzdHJ1Y3QgZGNfY3J0Y190aW1pbmcgKnRpbWluZyk7CiAKK3ZvaWQgb3B0
YzFfc2V0X3Z0Z19wYXJhbXMoc3RydWN0IHRpbWluZ19nZW5lcmF0b3IgKm9wdGMsCisJCWNvbnN0
IHN0cnVjdCBkY19jcnRjX3RpbWluZyAqZGNfY3J0Y190aW1pbmcpOworCiAjZW5kaWYgLyogX19E
Q19USU1JTkdfR0VORVJBVE9SX0RDTjEwX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9ody90aW1pbmdfZ2VuZXJhdG9yLmggYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3L3RpbWluZ19nZW5lcmF0b3IuaAppbmRleCBlNGIw
ZGUwMDg5YWYuLjBiOGM2ODk2NTgxZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2luYy9ody90aW1pbmdfZ2VuZXJhdG9yLmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2luYy9ody90aW1pbmdfZ2VuZXJhdG9yLmgKQEAgLTIzOCw2ICsyMzgs
OCBAQCBzdHJ1Y3QgdGltaW5nX2dlbmVyYXRvcl9mdW5jcyB7CiAJYm9vbCAoKmdldF9jcmMpKHN0
cnVjdCB0aW1pbmdfZ2VuZXJhdG9yICp0ZywKIAkJCXVpbnQzMl90ICpyX2NyLCB1aW50MzJfdCAq
Z195LCB1aW50MzJfdCAqYl9jYik7CiAKKwl2b2lkICgqc2V0X3Z0Z19wYXJhbXMpKHN0cnVjdCB0
aW1pbmdfZ2VuZXJhdG9yICpvcHRjLAorCQkJY29uc3Qgc3RydWN0IGRjX2NydGNfdGltaW5nICpk
Y19jcnRjX3RpbWluZyk7CiB9OwogCiAjZW5kaWYKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5nIGxpc3QKYW1k
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
