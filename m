Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6D2F22EAA1
	for <lists+amd-gfx@lfdr.de>; Thu, 30 May 2019 04:22:54 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id ABFBE6E29A;
	Thu, 30 May 2019 02:22:52 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM04-BN3-obe.outbound.protection.outlook.com
 (mail-eopbgr680066.outbound.protection.outlook.com [40.107.68.66])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7BABA6E29A
 for <amd-gfx@lists.freedesktop.org>; Thu, 30 May 2019 02:22:51 +0000 (UTC)
Received: from SN6PR12MB2800.namprd12.prod.outlook.com (52.135.107.150) by
 SN6PR12MB2846.namprd12.prod.outlook.com (52.135.103.161) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1922.21; Thu, 30 May 2019 02:22:49 +0000
Received: from SN6PR12MB2800.namprd12.prod.outlook.com
 ([fe80::4df8:270e:c062:6f8c]) by SN6PR12MB2800.namprd12.prod.outlook.com
 ([fe80::4df8:270e:c062:6f8c%7]) with mapi id 15.20.1922.021; Thu, 30 May 2019
 02:22:49 +0000
From: "Pan, Xinhui" <Xinhui.Pan@amd.com>
To: Alex Deucher <alexdeucher@gmail.com>, "amd-gfx@lists.freedesktop.org"
 <amd-gfx@lists.freedesktop.org>
Subject: =?gb2312?B?u9i4tDogW1BBVENIXSBkcm0vYW1kZ3B1OiBmaXggYSByYWNlIGluIEdQVSBy?=
 =?gb2312?Q?eset_with_IB_test_(v2)?=
Thread-Topic: =?gb2312?B?u9i4tDogW1BBVENIXSBkcm0vYW1kZ3B1OiBmaXggYSByYWNlIGluIEdQVSBy?=
 =?gb2312?Q?eset_with_IB_test_(v2)?=
Thread-Index: AQHVFk6Q1ipG/jNMOEi0c/moUxjGwqaDdliC
Date: Thu, 30 May 2019 02:22:49 +0000
Message-ID: <SN6PR12MB2800765F545154DA626B7C2F87180@SN6PR12MB2800.namprd12.prod.outlook.com>
References: <20190529184411.16894-1-alexander.deucher@amd.com>
In-Reply-To: <20190529184411.16894-1-alexander.deucher@amd.com>
Accept-Language: zh-CN, en-US
Content-Language: zh-CN
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [180.167.199.185]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: bd10c8ff-ae2c-46db-5892-08d6e4a5b638
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);
 SRVR:SN6PR12MB2846; 
x-ms-traffictypediagnostic: SN6PR12MB2846:
x-microsoft-antispam-prvs: <SN6PR12MB284674E6A66CB01D1127C19B87180@SN6PR12MB2846.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:8273;
x-forefront-prvs: 00531FAC2C
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(396003)(366004)(376002)(346002)(39860400002)(136003)(189003)(199004)(53936002)(26005)(8936002)(186003)(81156014)(316002)(81166006)(7736002)(2501003)(76116006)(11346002)(305945005)(25786009)(476003)(2906002)(446003)(4326008)(86362001)(5660300002)(74316002)(486006)(71190400001)(256004)(14444005)(99286004)(14454004)(33656002)(66066001)(478600001)(72206003)(71200400001)(52536014)(224303003)(91956017)(55016002)(9686003)(66556008)(73956011)(110136005)(66446008)(64756008)(66476007)(76176011)(7696005)(3846002)(6116002)(66946007)(6506007)(102836004)(6436002)(68736007);
 DIR:OUT; SFP:1101; SCL:1; SRVR:SN6PR12MB2846;
 H:SN6PR12MB2800.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: /AXZGARaVrr6ctC3vQ0E5x+aumrIkFUoNpkNT0P8KVB17J84/CXSYDcGW5SUGgL/5NuV2fhnkaqoO6TIWhf6Nf5JaLBg+kJaNSH6RMvH0zQ9x+bdNY8FwfEkOM9Br0NkYcL8ZNsPLKuyX0stc8ZCSfWTXUf/wi2d/9amrkSpdkhS37b7DugCoWo63/XbwRn1xmbvPFClwHK5msRxDHYWbSsBy9p/26b2jy/1zTBAjR9fDopaGJDpsXrIk2nuBR36UBxtzEbxOH6PREnpUj/IxI81rYMu9IxRQ5qeP1jB6fVSa6scxoNbSFdF/N7rsjYCMWu4UMbY97s1FQkShk9qK/tNAXpPlopWe0eTsJhqMNB6C6bpXB67As647/OR54VWRhoND3E7/hv++3FTti+hiPwfCON10YDHVg01N/daNPA=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: bd10c8ff-ae2c-46db-5892-08d6e4a5b638
X-MS-Exchange-CrossTenant-originalarrivaltime: 30 May 2019 02:22:49.6057 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: xpan@amd.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SN6PR12MB2846
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=GsYEeVfS3o3fVyFMUg2A5LnWQLBw+6+EskRGIeDWwwc=;
 b=1i7YQ3WVzNiHLqQFZKWEeifBrHVvcfAFVw6ELb18uEFOoM5wt3qCwRyVHpa2tSiSluvEyUmc3lWIlCT3yQkoAgp186cyCi/9LPU2j7/otOOeZmyIKKJJDguvPs140n/oICsQZFZpgZL4vP4KLjKbFNRWjpqctmX1SNpJLhVRWg4=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Xinhui.Pan@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Deucher, Alexander" <Alexander.Deucher@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

bG9va3MgZ29vZCB0byBtZS4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18K5Y+R5Lu25Lq6OiBBbGV4IERldWNoZXIgPGFsZXhkZXVjaGVyQGdtYWlsLmNvbT4K5Y+R6YCB
5pe26Ze0OiAyMDE55bm0NeaciDMw5pelIDI6NDQK5pS25Lu25Lq6OiBhbWQtZ2Z4QGxpc3RzLmZy
ZWVkZXNrdG9wLm9yZwrmioTpgIE6IERldWNoZXIsIEFsZXhhbmRlcjsgUGFuLCBYaW5odWkK5Li7
6aKYOiBbUEFUQ0hdIGRybS9hbWRncHU6IGZpeCBhIHJhY2UgaW4gR1BVIHJlc2V0IHdpdGggSUIg
dGVzdCAodjIpCgpTcGxpdCBsYXRlX2luaXQgaW50byB0d28gZnVuY3Rpb25zLCBvbmUgKGRvX2xh
dGVfaW5pdCkgd2hpY2gKanVzdCBkb2VzIHRoZSBodyBpbml0LCBhbmQgbGF0ZV9pbml0IHdoaWNo
IGNhbGxzIGRvX2xhdGVfaW5pdAphbmQgc2NoZWR1bGVzIHRoZSBJQiB0ZXN0IHdvcmsuICBDYWxs
IGRvX2xhdGVfaW5pdCBpbgp0aGUgR1BVIHJlc2V0IGNvZGUgdG8gcnVuIHRoZSBpbml0IGNvZGUs
IGJ1dCBub3Qgc2NoZWR1bGUKdGhlIElCIHRlc3QgY29kZS4gIFRoZSBJQiB0ZXN0IGNvZGUgaXMg
Y2FsbGVkIGRpcmVjdGx5CmluIHRoZSBncHUgcmVzZXQgY29kZSBzbyBubyBuZWVkIHRvIHJ1biB0
aGUgSUIgdGVzdHMKaW4gYSBzZXBhcmF0ZSB3b3JrIHRocmVhZC4gIElmIHdlIGRvLCB3ZSBlbmQg
dXAgcmFjaW5nLgoKdjI6IFJld29yayBsYXRlX2luaXQuICBQdWxsIG91dCB0aGUgbWdwdSBmYW4g
Ym9vc3QgYW5kIHhnbWkKcHN0YXRlIGNvZGUgaW50byBsYXRlX2luaXQgc28gdGhleSBnZXQgY2Fs
bGVkIGluIGFsbCBjYXNlcy4KcmVuYW1lIHRoZSBsYXRlX2luaXQgd29ya2VyIHRocmVhZCB0byBk
ZWxheWVkIHdvcmsgc2luY2UgaXQncwpqdXN0IHRoZSBJQiB0ZXN0cyBub3cgd2hpY2ggY2FuIGhh
cHBlbiBsYXRlci4gIFNjaGVkdWxlIHRoZQp3b3JrIGF0IGluaXQgYW5kIHJlc3VtZSB0aW1lLiAg
SXQncyBub3QgbmVlZGVkIGF0IHJlc2V0IHRpbWUKYmVjYXVzZSB0aGUgSUIgdGVzdHMgYXJlIGNh
bGxlZCBkaXJlY3RseS4KCkNjOiBYaW5odWkgUGFuIDx4aW5odWkucGFuQGFtZC5jb20+ClNpZ25l
ZC1vZmYtYnk6IEFsZXggRGV1Y2hlciA8YWxleGFuZGVyLmRldWNoZXJAYW1kLmNvbT4KLS0tCiBk
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaCAgICAgICAgfCAgIDIgKy0KIGRyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kZXZpY2UuYyB8IDExNiArKysrKysrKysrKy0t
LS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYyAgICB8ICAg
MiArLQogMyBmaWxlcyBjaGFuZ2VkLCA2MSBpbnNlcnRpb25zKCspLCA1OSBkZWxldGlvbnMoLSkK
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaCBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5oCmluZGV4IGQzNTVlOWEwOWFkMS4uMTlhMDAy
ODJlMzRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaApAQCAtOTI1LDcgKzkyNSw3
IEBAIHN0cnVjdCBhbWRncHVfZGV2aWNlIHsKICAgICAgICBjb25zdCBzdHJ1Y3QgYW1kZ3B1X2Rm
X2Z1bmNzICAgICpkZl9mdW5jczsKCiAgICAgICAgLyogZGVsYXllZCB3b3JrX2Z1bmMgZm9yIGRl
ZmVycmluZyBjbG9ja2dhdGluZyBkdXJpbmcgcmVzdW1lICovCi0gICAgICAgc3RydWN0IGRlbGF5
ZWRfd29yayAgICAgbGF0ZV9pbml0X3dvcms7CisgICAgICAgc3RydWN0IGRlbGF5ZWRfd29yayAg
ICAgZGVsYXllZF9pbml0X3dvcms7CgogICAgICAgIHN0cnVjdCBhbWRncHVfdmlydCAgICAgIHZp
cnQ7CiAgICAgICAgLyogZmlybXdhcmUgVlJBTSByZXNlcnZhdGlvbiAqLwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jCmluZGV4IDdhOGMyMjAxY2QwNC4uZDAwZmQ1
ZGQzMDdhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGV2
aWNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jCkBA
IC0xODY5LDYgKzE4NjksNDMgQEAgc3RhdGljIGludCBhbWRncHVfZGV2aWNlX3NldF9wZ19zdGF0
ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgZW51bSBhbWRfcG93ZXIKICAgICAgICByZXR1
cm4gMDsKIH0KCitzdGF0aWMgaW50IGFtZGdwdV9kZXZpY2VfZW5hYmxlX21ncHVfZmFuX2Jvb3N0
KHZvaWQpCit7CisgICAgICAgc3RydWN0IGFtZGdwdV9ncHVfaW5zdGFuY2UgKmdwdV9pbnM7Cisg
ICAgICAgc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXY7CisgICAgICAgaW50IGksIHJldCA9IDA7
CisKKyAgICAgICBtdXRleF9sb2NrKCZtZ3B1X2luZm8ubXV0ZXgpOworCisgICAgICAgLyoKKyAg
ICAgICAgKiBNR1BVIGZhbiBib29zdCBmZWF0dXJlIHNob3VsZCBiZSBlbmFibGVkCisgICAgICAg
ICogb25seSB3aGVuIHRoZXJlIGFyZSB0d28gb3IgbW9yZSBkR1BVcyBpbgorICAgICAgICAqIHRo
ZSBzeXN0ZW0KKyAgICAgICAgKi8KKyAgICAgICBpZiAobWdwdV9pbmZvLm51bV9kZ3B1IDwgMikK
KyAgICAgICAgICAgICAgIGdvdG8gb3V0OworCisgICAgICAgZm9yIChpID0gMDsgaSA8IG1ncHVf
aW5mby5udW1fZGdwdTsgaSsrKSB7CisgICAgICAgICAgICAgICBncHVfaW5zID0gJihtZ3B1X2lu
Zm8uZ3B1X2luc1tpXSk7CisgICAgICAgICAgICAgICBhZGV2ID0gZ3B1X2lucy0+YWRldjsKKyAg
ICAgICAgICAgICAgIGlmICghKGFkZXYtPmZsYWdzICYgQU1EX0lTX0FQVSkgJiYKKyAgICAgICAg
ICAgICAgICAgICAhZ3B1X2lucy0+bWdwdV9mYW5fZW5hYmxlZCAmJgorICAgICAgICAgICAgICAg
ICAgIGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcyAmJgorICAgICAgICAgICAgICAgICAgIGFkZXYt
PnBvd2VycGxheS5wcF9mdW5jcy0+ZW5hYmxlX21ncHVfZmFuX2Jvb3N0KSB7CisgICAgICAgICAg
ICAgICAgICAgICAgIHJldCA9IGFtZGdwdV9kcG1fZW5hYmxlX21ncHVfZmFuX2Jvb3N0KGFkZXYp
OworICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0KQorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGJyZWFrOworCisgICAgICAgICAgICAgICAgICAgICAgIGdwdV9pbnMtPm1ncHVf
ZmFuX2VuYWJsZWQgPSAxOworICAgICAgICAgICAgICAgfQorICAgICAgIH0KKworb3V0OgorICAg
ICAgIG11dGV4X3VubG9jaygmbWdwdV9pbmZvLm11dGV4KTsKKworICAgICAgIHJldHVybiByZXQ7
Cit9CisKIC8qKgogICogYW1kZ3B1X2RldmljZV9pcF9sYXRlX2luaXQgLSBydW4gbGF0ZSBpbml0
IGZvciBoYXJkd2FyZSBJUHMKICAqCkBAIC0xOTAyLDExICsxOTM5LDE1IEBAIHN0YXRpYyBpbnQg
YW1kZ3B1X2RldmljZV9pcF9sYXRlX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiAg
ICAgICAgYW1kZ3B1X2RldmljZV9zZXRfY2dfc3RhdGUoYWRldiwgQU1EX0NHX1NUQVRFX0dBVEUp
OwogICAgICAgIGFtZGdwdV9kZXZpY2Vfc2V0X3BnX3N0YXRlKGFkZXYsIEFNRF9QR19TVEFURV9H
QVRFKTsKCi0gICAgICAgcXVldWVfZGVsYXllZF93b3JrKHN5c3RlbV93cSwgJmFkZXYtPmxhdGVf
aW5pdF93b3JrLAotICAgICAgICAgICAgICAgICAgICAgICAgICBtc2Vjc190b19qaWZmaWVzKEFN
REdQVV9SRVNVTUVfTVMpKTsKLQogICAgICAgIGFtZGdwdV9kZXZpY2VfZmlsbF9yZXNldF9tYWdp
YyhhZGV2KTsKCisgICAgICAgciA9IGFtZGdwdV9kZXZpY2VfZW5hYmxlX21ncHVfZmFuX2Jvb3N0
KCk7CisgICAgICAgaWYgKHIpCisgICAgICAgICAgICAgICBEUk1fRVJST1IoImVuYWJsZSBtZ3B1
IGZhbiBib29zdCBmYWlsZWQgKCVkKS5cbiIsIHIpOworCisgICAgICAgLyogc2V0IHRvIGxvdyBw
c3RhdGUgYnkgZGVmYXVsdCAqLworICAgICAgIGFtZGdwdV94Z21pX3NldF9wc3RhdGUoYWRldiwg
MCk7CisKICAgICAgICByZXR1cm4gMDsKIH0KCkBAIC0yMDA1LDY1ICsyMDQ2LDIwIEBAIHN0YXRp
YyBpbnQgYW1kZ3B1X2RldmljZV9pcF9maW5pKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQog
ICAgICAgIHJldHVybiAwOwogfQoKLXN0YXRpYyBpbnQgYW1kZ3B1X2RldmljZV9lbmFibGVfbWdw
dV9mYW5fYm9vc3Qodm9pZCkKLXsKLSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2dwdV9pbnN0YW5jZSAq
Z3B1X2luczsKLSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldjsKLSAgICAgICBpbnQg
aSwgcmV0ID0gMDsKLQotICAgICAgIG11dGV4X2xvY2soJm1ncHVfaW5mby5tdXRleCk7Ci0KLSAg
ICAgICAvKgotICAgICAgICAqIE1HUFUgZmFuIGJvb3N0IGZlYXR1cmUgc2hvdWxkIGJlIGVuYWJs
ZWQKLSAgICAgICAgKiBvbmx5IHdoZW4gdGhlcmUgYXJlIHR3byBvciBtb3JlIGRHUFVzIGluCi0g
ICAgICAgICogdGhlIHN5c3RlbQotICAgICAgICAqLwotICAgICAgIGlmIChtZ3B1X2luZm8ubnVt
X2RncHUgPCAyKQotICAgICAgICAgICAgICAgZ290byBvdXQ7Ci0KLSAgICAgICBmb3IgKGkgPSAw
OyBpIDwgbWdwdV9pbmZvLm51bV9kZ3B1OyBpKyspIHsKLSAgICAgICAgICAgICAgIGdwdV9pbnMg
PSAmKG1ncHVfaW5mby5ncHVfaW5zW2ldKTsKLSAgICAgICAgICAgICAgIGFkZXYgPSBncHVfaW5z
LT5hZGV2OwotICAgICAgICAgICAgICAgaWYgKCEoYWRldi0+ZmxhZ3MgJiBBTURfSVNfQVBVKSAm
JgotICAgICAgICAgICAgICAgICAgICFncHVfaW5zLT5tZ3B1X2Zhbl9lbmFibGVkICYmCi0gICAg
ICAgICAgICAgICAgICAgYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzICYmCi0gICAgICAgICAgICAg
ICAgICAgYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5lbmFibGVfbWdwdV9mYW5fYm9vc3QpIHsK
LSAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gYW1kZ3B1X2RwbV9lbmFibGVfbWdwdV9mYW5f
Ym9vc3QoYWRldik7Ci0gICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXQpCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Ci0KLSAgICAgICAgICAgICAgICAgICAgICAgZ3B1
X2lucy0+bWdwdV9mYW5fZW5hYmxlZCA9IDE7Ci0gICAgICAgICAgICAgICB9Ci0gICAgICAgfQot
Ci1vdXQ6Ci0gICAgICAgbXV0ZXhfdW5sb2NrKCZtZ3B1X2luZm8ubXV0ZXgpOwotCi0gICAgICAg
cmV0dXJuIHJldDsKLX0KLQogLyoqCi0gKiBhbWRncHVfZGV2aWNlX2lwX2xhdGVfaW5pdF9mdW5j
X2hhbmRsZXIgLSB3b3JrIGhhbmRsZXIgZm9yIGliIHRlc3QKKyAqIGFtZGdwdV9kZXZpY2VfZGVs
YXllZF9pbml0X3dvcmtfaGFuZGxlciAtIHdvcmsgaGFuZGxlciBmb3IgSUIgdGVzdHMKICAqCiAg
KiBAd29yazogd29ya19zdHJ1Y3QuCiAgKi8KLXN0YXRpYyB2b2lkIGFtZGdwdV9kZXZpY2VfaXBf
bGF0ZV9pbml0X2Z1bmNfaGFuZGxlcihzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCitzdGF0aWMg
dm9pZCBhbWRncHVfZGV2aWNlX2RlbGF5ZWRfaW5pdF93b3JrX2hhbmRsZXIoc3RydWN0IHdvcmtf
c3RydWN0ICp3b3JrKQogewogICAgICAgIHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0KLSAg
ICAgICAgICAgICAgIGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgYW1kZ3B1X2RldmljZSwgbGF0
ZV9pbml0X3dvcmsud29yayk7CisgICAgICAgICAgICAgICBjb250YWluZXJfb2Yod29yaywgc3Ry
dWN0IGFtZGdwdV9kZXZpY2UsIGRlbGF5ZWRfaW5pdF93b3JrLndvcmspOwogICAgICAgIGludCBy
OwoKICAgICAgICByID0gYW1kZ3B1X2liX3JpbmdfdGVzdHMoYWRldik7CiAgICAgICAgaWYgKHIp
CiAgICAgICAgICAgICAgICBEUk1fRVJST1IoImliIHJpbmcgdGVzdCBmYWlsZWQgKCVkKS5cbiIs
IHIpOwotCi0gICAgICAgciA9IGFtZGdwdV9kZXZpY2VfZW5hYmxlX21ncHVfZmFuX2Jvb3N0KCk7
Ci0gICAgICAgaWYgKHIpCi0gICAgICAgICAgICAgICBEUk1fRVJST1IoImVuYWJsZSBtZ3B1IGZh
biBib29zdCBmYWlsZWQgKCVkKS5cbiIsIHIpOwotCi0gICAgICAgLypzZXQgdG8gbG93IHBzdGF0
ZSBieSBkZWZhdWx0ICovCi0gICAgICAgYW1kZ3B1X3hnbWlfc2V0X3BzdGF0ZShhZGV2LCAwKTsK
LQogfQoKIHN0YXRpYyB2b2lkIGFtZGdwdV9kZXZpY2VfZGVsYXlfZW5hYmxlX2dmeF9vZmYoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKQpAQCAtMjUzNSw4ICsyNTMxLDggQEAgaW50IGFtZGdwdV9k
ZXZpY2VfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKICAgICAgICBJTklUX0xJU1Rf
SEVBRCgmYWRldi0+cmluZ19scnVfbGlzdCk7CiAgICAgICAgc3Bpbl9sb2NrX2luaXQoJmFkZXYt
PnJpbmdfbHJ1X2xpc3RfbG9jayk7CgotICAgICAgIElOSVRfREVMQVlFRF9XT1JLKCZhZGV2LT5s
YXRlX2luaXRfd29yaywKLSAgICAgICAgICAgICAgICAgICAgICAgICBhbWRncHVfZGV2aWNlX2lw
X2xhdGVfaW5pdF9mdW5jX2hhbmRsZXIpOworICAgICAgIElOSVRfREVMQVlFRF9XT1JLKCZhZGV2
LT5kZWxheWVkX2luaXRfd29yaywKKyAgICAgICAgICAgICAgICAgICAgICAgICBhbWRncHVfZGV2
aWNlX2RlbGF5ZWRfaW5pdF93b3JrX2hhbmRsZXIpOwogICAgICAgIElOSVRfREVMQVlFRF9XT1JL
KCZhZGV2LT5nZnguZ2Z4X29mZl9kZWxheV93b3JrLAogICAgICAgICAgICAgICAgICAgICAgICAg
IGFtZGdwdV9kZXZpY2VfZGVsYXlfZW5hYmxlX2dmeF9vZmYpOwoKQEAgLTI3NDksNiArMjc0NSw5
IEBAIGludCBhbWRncHVfZGV2aWNlX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAg
ICAgICAgLyogbXVzdCBzdWNjZWVkLiAqLwogICAgICAgIGFtZGdwdV9yYXNfcmVzdW1lKGFkZXYp
OwoKKyAgICAgICBxdWV1ZV9kZWxheWVkX3dvcmsoc3lzdGVtX3dxLCAmYWRldi0+ZGVsYXllZF9p
bml0X3dvcmssCisgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZWNzX3RvX2ppZmZpZXMoQU1E
R1BVX1JFU1VNRV9NUykpOworCiAgICAgICAgciA9IGRldmljZV9jcmVhdGVfZmlsZShhZGV2LT5k
ZXYsICZkZXZfYXR0cl9wY2llX3JlcGxheV9jb3VudCk7CiAgICAgICAgaWYgKHIpIHsKICAgICAg
ICAgICAgICAgIGRldl9lcnIoYWRldi0+ZGV2LCAiQ291bGQgbm90IGNyZWF0ZSBwY2llX3JlcGxh
eV9jb3VudCIpOwpAQCAtMjc5Niw3ICsyNzk1LDcgQEAgdm9pZCBhbWRncHVfZGV2aWNlX2Zpbmko
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiAgICAgICAgICAgICAgICBhZGV2LT5maXJtd2Fy
ZS5ncHVfaW5mb19mdyA9IE5VTEw7CiAgICAgICAgfQogICAgICAgIGFkZXYtPmFjY2VsX3dvcmtp
bmcgPSBmYWxzZTsKLSAgICAgICBjYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJmFkZXYtPmxhdGVf
aW5pdF93b3JrKTsKKyAgICAgICBjYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJmFkZXYtPmRlbGF5
ZWRfaW5pdF93b3JrKTsKICAgICAgICAvKiBmcmVlIGkyYyBidXNlcyAqLwogICAgICAgIGlmICgh
YW1kZ3B1X2RldmljZV9oYXNfZGNfc3VwcG9ydChhZGV2KSkKICAgICAgICAgICAgICAgIGFtZGdw
dV9pMmNfZmluaShhZGV2KTsKQEAgLTI4NTksNyArMjg1OCw3IEBAIGludCBhbWRncHVfZGV2aWNl
X3N1c3BlbmQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgYm9vbCBzdXNwZW5kLCBib29sIGZiY29u
KQogICAgICAgIGlmIChmYmNvbikKICAgICAgICAgICAgICAgIGFtZGdwdV9mYmRldl9zZXRfc3Vz
cGVuZChhZGV2LCAxKTsKCi0gICAgICAgY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZhZGV2LT5s
YXRlX2luaXRfd29yayk7CisgICAgICAgY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZhZGV2LT5k
ZWxheWVkX2luaXRfd29yayk7CgogICAgICAgIGlmICghYW1kZ3B1X2RldmljZV9oYXNfZGNfc3Vw
cG9ydChhZGV2KSkgewogICAgICAgICAgICAgICAgLyogdHVybiBvZmYgZGlzcGxheSBodyAqLwpA
QCAtMjk3OSw2ICsyOTc4LDkgQEAgaW50IGFtZGdwdV9kZXZpY2VfcmVzdW1lKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYsIGJvb2wgcmVzdW1lLCBib29sIGZiY29uKQogICAgICAgIGlmIChyKQogICAg
ICAgICAgICAgICAgcmV0dXJuIHI7CgorICAgICAgIHF1ZXVlX2RlbGF5ZWRfd29yayhzeXN0ZW1f
d3EsICZhZGV2LT5kZWxheWVkX2luaXRfd29yaywKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
bXNlY3NfdG9famlmZmllcyhBTURHUFVfUkVTVU1FX01TKSk7CisKICAgICAgICBpZiAoIWFtZGdw
dV9kZXZpY2VfaGFzX2RjX3N1cHBvcnQoYWRldikpIHsKICAgICAgICAgICAgICAgIC8qIHBpbiBj
dXJzb3JzICovCiAgICAgICAgICAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KGNydGMsICZkZXYt
Pm1vZGVfY29uZmlnLmNydGNfbGlzdCwgaGVhZCkgewpAQCAtMzAwMiw3ICszMDA0LDcgQEAgaW50
IGFtZGdwdV9kZXZpY2VfcmVzdW1lKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGJvb2wgcmVzdW1l
LCBib29sIGZiY29uKQogICAgICAgICAgICAgICAgcmV0dXJuIHI7CgogICAgICAgIC8qIE1ha2Ug
c3VyZSBJQiB0ZXN0cyBmbHVzaGVkICovCi0gICAgICAgZmx1c2hfZGVsYXllZF93b3JrKCZhZGV2
LT5sYXRlX2luaXRfd29yayk7CisgICAgICAgZmx1c2hfZGVsYXllZF93b3JrKCZhZGV2LT5kZWxh
eWVkX2luaXRfd29yayk7CgogICAgICAgIC8qIGJsYXQgdGhlIG1vZGUgYmFjayBpbiAqLwogICAg
ICAgIGlmIChmYmNvbikgewpAQCAtMzU5Myw3ICszNTk1LDcgQEAgaW50IGFtZGdwdV9kZXZpY2Vf
Z3B1X3JlY292ZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCgogICAgICAgIGRldl9pbmZv
KGFkZXYtPmRldiwgIkdQVSByZXNldCBiZWdpbiFcbiIpOwoKLSAgICAgICBjYW5jZWxfZGVsYXll
ZF93b3JrX3N5bmMoJmFkZXYtPmxhdGVfaW5pdF93b3JrKTsKKyAgICAgICBjYW5jZWxfZGVsYXll
ZF93b3JrX3N5bmMoJmFkZXYtPmRlbGF5ZWRfaW5pdF93b3JrKTsKCiAgICAgICAgaGl2ZSA9IGFt
ZGdwdV9nZXRfeGdtaV9oaXZlKGFkZXYsIGZhbHNlKTsKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfa21zLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfa21zLmMKaW5kZXggODdhOTM4NzRkNzFlLi5iZTk3NzcxNTI1ZTEgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfa21zLmMKQEAgLTk3NCw3ICs5NzQsNyBAQCBpbnQg
YW1kZ3B1X2RyaXZlcl9vcGVuX2ttcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGVfcHJpdikKICAgICAgICBpbnQgciwgcGFzaWQ7CgogICAgICAgIC8qIEVuc3Vy
ZSBJQiB0ZXN0cyBhcmUgcnVuIG9uIHJpbmcgKi8KLSAgICAgICBmbHVzaF9kZWxheWVkX3dvcmso
JmFkZXYtPmxhdGVfaW5pdF93b3JrKTsKKyAgICAgICBmbHVzaF9kZWxheWVkX3dvcmsoJmFkZXYt
PmRlbGF5ZWRfaW5pdF93b3JrKTsKCiAgICAgICAgZmlsZV9wcml2LT5kcml2ZXJfcHJpdiA9IE5V
TEw7CgotLQoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
