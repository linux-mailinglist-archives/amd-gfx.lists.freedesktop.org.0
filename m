Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7737D48DF5
	for <lists+amd-gfx@lfdr.de>; Mon, 17 Jun 2019 21:18:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DE92489468;
	Mon, 17 Jun 2019 19:17:59 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qt1-x844.google.com (mail-qt1-x844.google.com
 [IPv6:2607:f8b0:4864:20::844])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DCC5F89428
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:17:57 +0000 (UTC)
Received: by mail-qt1-x844.google.com with SMTP id d23so12199410qto.2
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 12:17:57 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=tTifYh5+WNN3iVtWZ5eFAKP6PpZbiiPDVqdsFK/1W9Q=;
 b=IWX7szD4P0gxRBRKbFdEGd30Z2J857ilOVPXJekRC8iMauViQyuLZfsO45LSX6wWef
 HOSYiwk57EQQrONyg7y7FRlwrAz689nBuphtiLbVxNKZd67zirZPuDMukcENq1SGDTgM
 iDtRl+2P7u6ipo7ldvf15bBUT9Q0p7JuPXhPyZcxFisO28icjhkPGTlSWOX7dn/+oN+1
 nrj8HOBw6IY+Ps1zOHEPc70fKSeVMA1lHTRzh96D/BTuOmPRA5xHza0JtxDN1DQ0SKnX
 NAdCDgB2hs4f7yt/8iZy1lGG+R9NfI3MwluW0/lfqPsvj9snTa47ZZw42yQkafniJBXL
 UIFg==
X-Gm-Message-State: APjAAAUXRSzPJTNlHM2vL+6SzHBVMOsEjmKGrYd6cYA6cJzYDSfSg1k6
 /JfTquQu8PsRb4LAEiPtsUEDVY7MiDI=
X-Google-Smtp-Source: APXvYqyzrB7gksXjxKj3gYLVQ0zoSUq2J5Ep5EFEx3O5k9ZolpyM0jBE5HfMnlI4h7Zl96GRVQp4zA==
X-Received: by 2002:ac8:1410:: with SMTP id k16mr18409836qtj.335.1560799076539; 
 Mon, 17 Jun 2019 12:17:56 -0700 (PDT)
Received: from localhost.localdomain ([71.219.5.136])
 by smtp.gmail.com with ESMTPSA id s35sm7754876qth.79.2019.06.17.12.17.55
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 12:17:56 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 055/459] drm/amdgpu: add mmhub v2 block for navi10 (v4)
Date: Mon, 17 Jun 2019 14:10:16 -0500
Message-Id: <20190617191700.17899-44-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617191700.17899-1-alexander.deucher@amd.com>
References: <20190617191700.17899-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=tTifYh5+WNN3iVtWZ5eFAKP6PpZbiiPDVqdsFK/1W9Q=;
 b=rl7/HoRGvmlpN7caZQIqs4T+FjETCzP51CG4c5UbpClRLAAiuVL6m1OWmHNNBEaTmS
 3fgL0jLS3KNB1nEDIZjH1f3nGtmuUYvZCH9rjh6domZwAD6T7wYUIl7WIJERBMephAGh
 UHefwGnB9IUJHc7rLCsW1fsx/1zqYhtS7cea6H1ffjsQSM2c0yXYK6zoP5XW80B+yw4j
 QqKqbPklxljKQxeWoDetVkQ/IcyJAjp9FUO50rlFk+3jKTpRAUv4C5ZcRjS+fGquaLJR
 4mkmByhJ4EVOv6XMBCi+HujMlJ3K/a6w3lNCsvDdXYv1H8gOBfuG+o0lTg0v29Lg+4KY
 1fdw==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>, Huang Rui <ray.huang@amd.com>,
 Hawking Zhang <Hawking.Zhang@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogSGF3a2luZyBaaGFuZyA8SGF3a2luZy5aaGFuZ0BhbWQuY29tPgoKdjE6IGFkZCBwbGFj
ZSBob2xkZXIgYW5kIGluaXRpYWwgZnVuY3Rpb25zIChSYXkpCnYyOiByZXBsYWNlIGxlZ2FjeSBh
bWRncHVfbWMgc3RydWN0dXJlIHdpdGggYW1kZ3B1X2dtYyAoSGF3a2luZykKdjM6IHN3aXRjaCB0
byB1c2UgYW1kZ3B1X2dtY19wZF9hZGRyIChIYXdraW5nKQp2NDogc3F1YXNoIGluIHVwZGF0ZXMg
KEFsZXgpCgpTaWduZWQtb2ZmLWJ5OiBIdWFuZyBSdWkgPHJheS5odWFuZ0BhbWQuY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBIYXdraW5nIFpoYW5nIDxIYXdraW5nLlpoYW5nQGFtZC5jb20+ClJldmlld2Vk
LWJ5OiBBbGV4IERldWNoZXIgPGFsZXhhbmRlci5kZXVjaGVyQGFtZC5jb20+ClJldmlld2VkLWJ5
OiBIYXdraW5nIFpoYW5nIDxIYXdraW5nLlpoYW5nQGFtZC5jb20+ClNpZ25lZC1vZmYtYnk6IEFs
ZXggRGV1Y2hlciA8YWxleGFuZGVyLmRldWNoZXJAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9NYWtlZmlsZSAgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L21taHViX3YyXzAuYyB8IDQ0MiArKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L21taHViX3YyXzAuaCB8ICAzNSArKwogMyBmaWxlcyBjaGFu
Z2VkLCA0NzggaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQogY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L21taHViX3YyXzAuYwogY3JlYXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L21taHViX3YyXzAuaAoKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvTWFrZWZpbGUKaW5kZXggNzQxY2E3NzIwYjVjLi4zZTZhMTI2OTI2ZWUgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L01ha2VmaWxlCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L01ha2VmaWxlCkBAIC03Niw3ICs3Niw3IEBAIGFtZGdwdS15ICs9
IFwKIAlnbWNfdjdfMC5vIFwKIAlnbWNfdjhfMC5vIFwKIAlnZnhodWJfdjFfMC5vIG1taHViX3Yx
XzAubyBnbWNfdjlfMC5vIGdmeGh1Yl92MV8xLm8gXAotCWdmeGh1Yl92Ml8wLm8KKwlnZnhodWJf
djJfMC5vIG1taHViX3YyXzAubwogCiAjIGFkZCBJSCBibG9jawogYW1kZ3B1LXkgKz0gXApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbW1odWJfdjJfMC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvbW1odWJfdjJfMC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAwMDAwMC4uZjY1YjljODI3OTcwCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvbW1odWJfdjJfMC5jCkBAIC0wLDAgKzEsNDQyIEBACisvKgor
ICogQ29weXJpZ2h0IDIwMTkgQWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5jLgorICoKKyAqIFBl
cm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29u
IG9idGFpbmluZyBhCisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9j
dW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVhbCBpbiB0aGUgU29m
dHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgor
ICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3Ry
aWJ1dGUsIHN1YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJl
LCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlzIGZ1cm5p
c2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CisgKgor
ICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ug
c2hhbGwgYmUgaW5jbHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlv
bnMgb2YgdGhlIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMg
SVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVE
LCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5U
QUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZS
SU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIENPUFlSSUdIVCBIT0xERVIoUykg
T1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SCisgKiBPVEhF
UiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9U
SEVSV0lTRSwKKyAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBU
SEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgorICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRX
QVJFLgorICoKKyAqLworCisjaW5jbHVkZSAiYW1kZ3B1LmgiCisjaW5jbHVkZSAibW1odWJfdjJf
MC5oIgorCisjaW5jbHVkZSAibW1odWIvbW1odWJfMl8wXzBfb2Zmc2V0LmgiCisjaW5jbHVkZSAi
bW1odWIvbW1odWJfMl8wXzBfc2hfbWFzay5oIgorI2luY2x1ZGUgIm1taHViL21taHViXzJfMF8w
X2RlZmF1bHQuaCIKKyNpbmNsdWRlICJuYXZpMTBfZW51bS5oIgorCisjaW5jbHVkZSAic29jMTVf
Y29tbW9uLmgiCisKK3N0YXRpYyB2b2lkIG1taHViX3YyXzBfaW5pdF9nYXJ0X3B0X3JlZ3Moc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCit7CisJdWludDY0X3QgdmFsdWUgPSBhbWRncHVfZ21j
X3BkX2FkZHIoYWRldi0+Z2FydC5ibyk7CisKKwlXUkVHMzJfU09DMTUoTU1IVUIsIDAsIG1tTU1W
TV9DT05URVhUMF9QQUdFX1RBQkxFX0JBU0VfQUREUl9MTzMyLAorCQkgICAgIGxvd2VyXzMyX2Jp
dHModmFsdWUpKTsKKworCVdSRUczMl9TT0MxNShNTUhVQiwgMCwgbW1NTVZNX0NPTlRFWFQwX1BB
R0VfVEFCTEVfQkFTRV9BRERSX0hJMzIsCisJCSAgICAgdXBwZXJfMzJfYml0cyh2YWx1ZSkpOwor
fQorCitzdGF0aWMgdm9pZCBtbWh1Yl92Ml8wX2luaXRfZ2FydF9hcGVydHVyZV9yZWdzKHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2KQoreworCW1taHViX3YyXzBfaW5pdF9nYXJ0X3B0X3JlZ3Mo
YWRldik7CisKKwlXUkVHMzJfU09DMTUoTU1IVUIsIDAsIG1tTU1WTV9DT05URVhUMF9QQUdFX1RB
QkxFX1NUQVJUX0FERFJfTE8zMiwKKwkJICAgICAodTMyKShhZGV2LT5nbWMuZ2FydF9zdGFydCA+
PiAxMikpOworCVdSRUczMl9TT0MxNShNTUhVQiwgMCwgbW1NTVZNX0NPTlRFWFQwX1BBR0VfVEFC
TEVfU1RBUlRfQUREUl9ISTMyLAorCQkgICAgICh1MzIpKGFkZXYtPmdtYy5nYXJ0X3N0YXJ0ID4+
IDQ0KSk7CisKKwlXUkVHMzJfU09DMTUoTU1IVUIsIDAsIG1tTU1WTV9DT05URVhUMF9QQUdFX1RB
QkxFX0VORF9BRERSX0xPMzIsCisJCSAgICAgKHUzMikoYWRldi0+Z21jLmdhcnRfZW5kID4+IDEy
KSk7CisJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NVk1fQ09OVEVYVDBfUEFHRV9UQUJMRV9F
TkRfQUREUl9ISTMyLAorCQkgICAgICh1MzIpKGFkZXYtPmdtYy5nYXJ0X2VuZCA+PiA0NCkpOwor
fQorCitzdGF0aWMgdm9pZCBtbWh1Yl92Ml8wX2luaXRfc3lzdGVtX2FwZXJ0dXJlX3JlZ3Moc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCit7CisJdWludDY0X3QgdmFsdWU7CisJdWludDMyX3Qg
dG1wOworCisJLyogRGlzYWJsZSBBR1AuICovCisJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1N
TUNfVk1fQUdQX0JBU0UsIDApOworCVdSRUczMl9TT0MxNShNTUhVQiwgMCwgbW1NTU1DX1ZNX0FH
UF9UT1AsIDApOworCVdSRUczMl9TT0MxNShNTUhVQiwgMCwgbW1NTU1DX1ZNX0FHUF9CT1QsIDB4
MDBGRkZGRkYpOworCisJLyogUHJvZ3JhbSB0aGUgc3lzdGVtIGFwZXJ0dXJlIGxvdyBsb2dpY2Fs
IHBhZ2UgbnVtYmVyLiAqLworCVdSRUczMl9TT0MxNShNTUhVQiwgMCwgbW1NTU1DX1ZNX1NZU1RF
TV9BUEVSVFVSRV9MT1dfQUREUiwKKwkJICAgICBhZGV2LT5nbWMudnJhbV9zdGFydCA+PiAxOCk7
CisJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NTUNfVk1fU1lTVEVNX0FQRVJUVVJFX0hJR0hf
QUREUiwKKwkJICAgICBhZGV2LT5nbWMudnJhbV9lbmQgPj4gMTgpOworCisJLyogU2V0IGRlZmF1
bHQgcGFnZSBhZGRyZXNzLiAqLworCXZhbHVlID0gYWRldi0+dnJhbV9zY3JhdGNoLmdwdV9hZGRy
IC0gYWRldi0+Z21jLnZyYW1fc3RhcnQgKworCQlhZGV2LT52bV9tYW5hZ2VyLnZyYW1fYmFzZV9v
ZmZzZXQ7CisJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NTUNfVk1fU1lTVEVNX0FQRVJUVVJF
X0RFRkFVTFRfQUREUl9MU0IsCisJCSAgICAgKHUzMikodmFsdWUgPj4gMTIpKTsKKwlXUkVHMzJf
U09DMTUoTU1IVUIsIDAsIG1tTU1NQ19WTV9TWVNURU1fQVBFUlRVUkVfREVGQVVMVF9BRERSX01T
QiwKKwkJICAgICAodTMyKSh2YWx1ZSA+PiA0NCkpOworCisJLyogUHJvZ3JhbSAicHJvdGVjdGlv
biBmYXVsdCIuICovCisJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NVk1fTDJfUFJPVEVDVElP
Tl9GQVVMVF9ERUZBVUxUX0FERFJfTE8zMiwKKwkJICAgICAodTMyKShhZGV2LT5kdW1teV9wYWdl
X2FkZHIgPj4gMTIpKTsKKwlXUkVHMzJfU09DMTUoTU1IVUIsIDAsIG1tTU1WTV9MMl9QUk9URUNU
SU9OX0ZBVUxUX0RFRkFVTFRfQUREUl9ISTMyLAorCQkgICAgICh1MzIpKCh1NjQpYWRldi0+ZHVt
bXlfcGFnZV9hZGRyID4+IDQ0KSk7CisKKwl0bXAgPSBSUkVHMzJfU09DMTUoTU1IVUIsIDAsIG1t
TU1WTV9MMl9QUk9URUNUSU9OX0ZBVUxUX0NOVEwyKTsKKwl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRt
cCwgTU1WTV9MMl9QUk9URUNUSU9OX0ZBVUxUX0NOVEwyLAorCQkJICAgIEFDVElWRV9QQUdFX01J
R1JBVElPTl9QVEVfUkVBRF9SRVRSWSwgMSk7CisJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1N
Vk1fTDJfUFJPVEVDVElPTl9GQVVMVF9DTlRMMiwgdG1wKTsKK30KKworc3RhdGljIHZvaWQgbW1o
dWJfdjJfMF9pbml0X3RsYl9yZWdzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQoreworCXVp
bnQzMl90IHRtcDsKKworCS8qIFNldHVwIFRMQiBjb250cm9sICovCisJdG1wID0gUlJFRzMyX1NP
QzE1KE1NSFVCLCAwLCBtbU1NTUNfVk1fTVhfTDFfVExCX0NOVEwpOworCisJdG1wID0gUkVHX1NF
VF9GSUVMRCh0bXAsIE1NTUNfVk1fTVhfTDFfVExCX0NOVEwsIEVOQUJMRV9MMV9UTEIsIDEpOwor
CXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBNTU1DX1ZNX01YX0wxX1RMQl9DTlRMLCBTWVNURU1f
QUNDRVNTX01PREUsIDMpOworCXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBNTU1DX1ZNX01YX0wx
X1RMQl9DTlRMLAorCQkJICAgIEVOQUJMRV9BRFZBTkNFRF9EUklWRVJfTU9ERUwsIDEpOworCXRt
cCA9IFJFR19TRVRfRklFTEQodG1wLCBNTU1DX1ZNX01YX0wxX1RMQl9DTlRMLAorCQkJICAgIFNZ
U1RFTV9BUEVSVFVSRV9VTk1BUFBFRF9BQ0NFU1MsIDApOworCXRtcCA9IFJFR19TRVRfRklFTEQo
dG1wLCBNTU1DX1ZNX01YX0wxX1RMQl9DTlRMLCBFQ09fQklUUywgMCk7CisJdG1wID0gUkVHX1NF
VF9GSUVMRCh0bXAsIE1NTUNfVk1fTVhfTDFfVExCX0NOVEwsCisJCQkgICAgTVRZUEUsIE1UWVBF
X1VDKTsgLyogVUMsIHVuY2FjaGVkICovCisKKwlXUkVHMzJfU09DMTUoTU1IVUIsIDAsIG1tTU1N
Q19WTV9NWF9MMV9UTEJfQ05UTCwgdG1wKTsKK30KKworc3RhdGljIHZvaWQgbW1odWJfdjJfMF9p
bml0X2NhY2hlX3JlZ3Moc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCit7CisJdWludDMyX3Qg
dG1wOworCisJLyogU2V0dXAgTDIgY2FjaGUgKi8KKwl0bXAgPSBSUkVHMzJfU09DMTUoTU1IVUIs
IDAsIG1tTU1WTV9MMl9DTlRMKTsKKwl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgTU1WTV9MMl9D
TlRMLCBFTkFCTEVfTDJfQ0FDSEUsIDEpOworCXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBNTVZN
X0wyX0NOVEwsIEVOQUJMRV9MMl9GUkFHTUVOVF9QUk9DRVNTSU5HLCAwKTsKKwkvKiBYWFggZm9y
IGVtdWxhdGlvbiwgUmVmZXIgdG8gY2xvc2VkIHNvdXJjZSBjb2RlLiovCisJdG1wID0gUkVHX1NF
VF9GSUVMRCh0bXAsIE1NVk1fTDJfQ05UTCwgTDJfUERFMF9DQUNIRV9UQUdfR0VORVJBVElPTl9N
T0RFLAorCQkJICAgIDApOworCXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBNTVZNX0wyX0NOVEws
IFBERV9GQVVMVF9DTEFTU0lGSUNBVElPTiwgMSk7CisJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAs
IE1NVk1fTDJfQ05UTCwgQ09OVEVYVDFfSURFTlRJVFlfQUNDRVNTX01PREUsIDEpOworCXRtcCA9
IFJFR19TRVRfRklFTEQodG1wLCBNTVZNX0wyX0NOVEwsIElERU5USVRZX01PREVfRlJBR01FTlRf
U0laRSwgMCk7CisJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NVk1fTDJfQ05UTCwgdG1wKTsK
KworCXRtcCA9IFJSRUczMl9TT0MxNShNTUhVQiwgMCwgbW1NTVZNX0wyX0NOVEwyKTsKKwl0bXAg
PSBSRUdfU0VUX0ZJRUxEKHRtcCwgTU1WTV9MMl9DTlRMMiwgSU5WQUxJREFURV9BTExfTDFfVExC
UywgMSk7CisJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIE1NVk1fTDJfQ05UTDIsIElOVkFMSURB
VEVfTDJfQ0FDSEUsIDEpOworCVdSRUczMl9TT0MxNShNTUhVQiwgMCwgbW1NTVZNX0wyX0NOVEwy
LCB0bXApOworCisJdG1wID0gbW1NTVZNX0wyX0NOVEwzX0RFRkFVTFQ7CisJV1JFRzMyX1NPQzE1
KE1NSFVCLCAwLCBtbU1NVk1fTDJfQ05UTDMsIHRtcCk7CisKKwl0bXAgPSBtbU1NVk1fTDJfQ05U
TDRfREVGQVVMVDsKKwl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgTU1WTV9MMl9DTlRMNCwgVk1D
X1RBUF9QREVfUkVRVUVTVF9QSFlTSUNBTCwgMCk7CisJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAs
IE1NVk1fTDJfQ05UTDQsIFZNQ19UQVBfUFRFX1JFUVVFU1RfUEhZU0lDQUwsIDApOworCVdSRUcz
Ml9TT0MxNShNTUhVQiwgMCwgbW1NTVZNX0wyX0NOVEw0LCB0bXApOworfQorCitzdGF0aWMgdm9p
ZCBtbWh1Yl92Ml8wX2VuYWJsZV9zeXN0ZW1fZG9tYWluKHN0cnVjdCBhbWRncHVfZGV2aWNlICph
ZGV2KQoreworCXVpbnQzMl90IHRtcDsKKworCXRtcCA9IFJSRUczMl9TT0MxNShNTUhVQiwgMCwg
bW1NTVZNX0NPTlRFWFQwX0NOVEwpOworCXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBNTVZNX0NP
TlRFWFQwX0NOVEwsIEVOQUJMRV9DT05URVhULCAxKTsKKwl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRt
cCwgTU1WTV9DT05URVhUMF9DTlRMLCBQQUdFX1RBQkxFX0RFUFRILCAwKTsKKwlXUkVHMzJfU09D
MTUoTU1IVUIsIDAsIG1tTU1WTV9DT05URVhUMF9DTlRMLCB0bXApOworfQorCitzdGF0aWMgdm9p
ZCBtbWh1Yl92Ml8wX2Rpc2FibGVfaWRlbnRpdHlfYXBlcnR1cmUoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYpCit7CisJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLAorCQkgICAgIG1tTU1WTV9MMl9D
T05URVhUMV9JREVOVElUWV9BUEVSVFVSRV9MT1dfQUREUl9MTzMyLAorCQkgICAgIDB4RkZGRkZG
RkYpOworCVdSRUczMl9TT0MxNShNTUhVQiwgMCwKKwkJICAgICBtbU1NVk1fTDJfQ09OVEVYVDFf
SURFTlRJVFlfQVBFUlRVUkVfTE9XX0FERFJfSEkzMiwKKwkJICAgICAweDAwMDAwMDBGKTsKKwor
CVdSRUczMl9TT0MxNShNTUhVQiwgMCwKKwkJICAgICBtbU1NVk1fTDJfQ09OVEVYVDFfSURFTlRJ
VFlfQVBFUlRVUkVfSElHSF9BRERSX0xPMzIsIDApOworCVdSRUczMl9TT0MxNShNTUhVQiwgMCwK
KwkJICAgICBtbU1NVk1fTDJfQ09OVEVYVDFfSURFTlRJVFlfQVBFUlRVUkVfSElHSF9BRERSX0hJ
MzIsIDApOworCisJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NVk1fTDJfQ09OVEVYVF9JREVO
VElUWV9QSFlTSUNBTF9PRkZTRVRfTE8zMiwKKwkJICAgICAwKTsKKwlXUkVHMzJfU09DMTUoTU1I
VUIsIDAsIG1tTU1WTV9MMl9DT05URVhUX0lERU5USVRZX1BIWVNJQ0FMX09GRlNFVF9ISTMyLAor
CQkgICAgIDApOworfQorCitzdGF0aWMgdm9pZCBtbWh1Yl92Ml8wX3NldHVwX3ZtaWRfY29uZmln
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQoreworCWludCBpOworCXVpbnQzMl90IHRtcDsK
KworCWZvciAoaSA9IDA7IGkgPD0gMTQ7IGkrKykgeworCQl0bXAgPSBSUkVHMzJfU09DMTVfT0ZG
U0VUKE1NSFVCLCAwLCBtbU1NVk1fQ09OVEVYVDFfQ05UTCwgaSk7CisJCXRtcCA9IFJFR19TRVRf
RklFTEQodG1wLCBNTVZNX0NPTlRFWFQxX0NOVEwsIEVOQUJMRV9DT05URVhULCAxKTsKKwkJdG1w
ID0gUkVHX1NFVF9GSUVMRCh0bXAsIE1NVk1fQ09OVEVYVDFfQ05UTCwgUEFHRV9UQUJMRV9ERVBU
SCwKKwkJCQkgICAgYWRldi0+dm1fbWFuYWdlci5udW1fbGV2ZWwpOworCQl0bXAgPSBSRUdfU0VU
X0ZJRUxEKHRtcCwgTU1WTV9DT05URVhUMV9DTlRMLAorCQkJCSAgICBSQU5HRV9QUk9URUNUSU9O
X0ZBVUxUX0VOQUJMRV9ERUZBVUxULCAxKTsKKwkJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIE1N
Vk1fQ09OVEVYVDFfQ05UTCwKKwkJCQkgICAgRFVNTVlfUEFHRV9QUk9URUNUSU9OX0ZBVUxUX0VO
QUJMRV9ERUZBVUxULAorCQkJCSAgICAxKTsKKwkJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIE1N
Vk1fQ09OVEVYVDFfQ05UTCwKKwkJCQkgICAgUERFMF9QUk9URUNUSU9OX0ZBVUxUX0VOQUJMRV9E
RUZBVUxULCAxKTsKKwkJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIE1NVk1fQ09OVEVYVDFfQ05U
TCwKKwkJCQkgICAgVkFMSURfUFJPVEVDVElPTl9GQVVMVF9FTkFCTEVfREVGQVVMVCwgMSk7CisJ
CXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBNTVZNX0NPTlRFWFQxX0NOVEwsCisJCQkJICAgIFJF
QURfUFJPVEVDVElPTl9GQVVMVF9FTkFCTEVfREVGQVVMVCwgMSk7CisJCXRtcCA9IFJFR19TRVRf
RklFTEQodG1wLCBNTVZNX0NPTlRFWFQxX0NOVEwsCisJCQkJICAgIFdSSVRFX1BST1RFQ1RJT05f
RkFVTFRfRU5BQkxFX0RFRkFVTFQsIDEpOworCQl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgTU1W
TV9DT05URVhUMV9DTlRMLAorCQkJCSAgICBFWEVDVVRFX1BST1RFQ1RJT05fRkFVTFRfRU5BQkxF
X0RFRkFVTFQsIDEpOworCQl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgTU1WTV9DT05URVhUMV9D
TlRMLAorCQkJCSAgICBQQUdFX1RBQkxFX0JMT0NLX1NJWkUsCisJCQkJICAgIGFkZXYtPnZtX21h
bmFnZXIuYmxvY2tfc2l6ZSAtIDkpOworCQkvKiBTZW5kIG5vLXJldHJ5IFhOQUNLIG9uIGZhdWx0
IHRvIHN1cHByZXNzIFZNIGZhdWx0IHN0b3JtLiAqLworCQl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRt
cCwgTU1WTV9DT05URVhUMV9DTlRMLAorCQkJCSAgICBSRVRSWV9QRVJNSVNTSU9OX09SX0lOVkFM
SURfUEFHRV9GQVVMVCwgMCk7CisJCVdSRUczMl9TT0MxNV9PRkZTRVQoTU1IVUIsIDAsIG1tTU1W
TV9DT05URVhUMV9DTlRMLCBpLCB0bXApOworCQlXUkVHMzJfU09DMTVfT0ZGU0VUKE1NSFVCLCAw
LCBtbU1NVk1fQ09OVEVYVDFfUEFHRV9UQUJMRV9TVEFSVF9BRERSX0xPMzIsIGkqMiwgMCk7CisJ
CVdSRUczMl9TT0MxNV9PRkZTRVQoTU1IVUIsIDAsIG1tTU1WTV9DT05URVhUMV9QQUdFX1RBQkxF
X1NUQVJUX0FERFJfSEkzMiwgaSoyLCAwKTsKKwkJV1JFRzMyX1NPQzE1X09GRlNFVChNTUhVQiwg
MCwgbW1NTVZNX0NPTlRFWFQxX1BBR0VfVEFCTEVfRU5EX0FERFJfTE8zMiwgaSoyLAorCQkJbG93
ZXJfMzJfYml0cyhhZGV2LT52bV9tYW5hZ2VyLm1heF9wZm4gLSAxKSk7CisJCVdSRUczMl9TT0Mx
NV9PRkZTRVQoTU1IVUIsIDAsIG1tTU1WTV9DT05URVhUMV9QQUdFX1RBQkxFX0VORF9BRERSX0hJ
MzIsIGkqMiwKKwkJCXVwcGVyXzMyX2JpdHMoYWRldi0+dm1fbWFuYWdlci5tYXhfcGZuIC0gMSkp
OworCX0KK30KKworc3RhdGljIHZvaWQgbW1odWJfdjJfMF9wcm9ncmFtX2ludmFsaWRhdGlvbihz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKK3sKKwl1bnNpZ25lZCBpOworCisJZm9yIChpID0g
MDsgaSA8IDE4OyArK2kpIHsKKwkJV1JFRzMyX1NPQzE1X09GRlNFVChNTUhVQiwgMCwgbW1NTVZN
X0lOVkFMSURBVEVfRU5HMF9BRERSX1JBTkdFX0xPMzIsCisJCQkJICAgIDIgKiBpLCAweGZmZmZm
ZmZmKTsKKwkJV1JFRzMyX1NPQzE1X09GRlNFVChNTUhVQiwgMCwgbW1NTVZNX0lOVkFMSURBVEVf
RU5HMF9BRERSX1JBTkdFX0hJMzIsCisJCQkJICAgIDIgKiBpLCAweDFmKTsKKwl9Cit9CisKK2lu
dCBtbWh1Yl92Ml8wX2dhcnRfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQorewor
CWlmIChhbWRncHVfc3Jpb3ZfdmYoYWRldikpIHsKKwkJLyoKKwkJICogTU1NQ19WTV9GQl9MT0NB
VElPTl9CQVNFL1RPUCBpcyBOVUxMIGZvciBWRiwgYmVjdWFzZSB0aGV5IGFyZQorCQkgKiBWRiBj
b3B5IHJlZ2lzdGVycyBzbyB2YmlvcyBwb3N0IGRvZXNuJ3QgcHJvZ3JhbSB0aGVtLCBmb3IKKwkJ
ICogU1JJT1YgZHJpdmVyIG5lZWQgdG8gcHJvZ3JhbSB0aGVtCisJCSAqLworCQlXUkVHMzJfU09D
MTUoTU1IVUIsIDAsIG1tTU1NQ19WTV9GQl9MT0NBVElPTl9CQVNFLAorCQkJICAgICBhZGV2LT5n
bWMudnJhbV9zdGFydCA+PiAyNCk7CisJCVdSRUczMl9TT0MxNShNTUhVQiwgMCwgbW1NTU1DX1ZN
X0ZCX0xPQ0FUSU9OX1RPUCwKKwkJCSAgICAgYWRldi0+Z21jLnZyYW1fZW5kID4+IDI0KTsKKwl9
CisKKwkvKiBHQVJUIEVuYWJsZS4gKi8KKwltbWh1Yl92Ml8wX2luaXRfZ2FydF9hcGVydHVyZV9y
ZWdzKGFkZXYpOworCW1taHViX3YyXzBfaW5pdF9zeXN0ZW1fYXBlcnR1cmVfcmVncyhhZGV2KTsK
KwltbWh1Yl92Ml8wX2luaXRfdGxiX3JlZ3MoYWRldik7CisJbW1odWJfdjJfMF9pbml0X2NhY2hl
X3JlZ3MoYWRldik7CisKKwltbWh1Yl92Ml8wX2VuYWJsZV9zeXN0ZW1fZG9tYWluKGFkZXYpOwor
CW1taHViX3YyXzBfZGlzYWJsZV9pZGVudGl0eV9hcGVydHVyZShhZGV2KTsKKwltbWh1Yl92Ml8w
X3NldHVwX3ZtaWRfY29uZmlnKGFkZXYpOworCW1taHViX3YyXzBfcHJvZ3JhbV9pbnZhbGlkYXRp
b24oYWRldik7CisKKwlyZXR1cm4gMDsKK30KKwordm9pZCBtbWh1Yl92Ml8wX2dhcnRfZGlzYWJs
ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKK3sKKwl1MzIgdG1wOworCXUzMiBpOworCisJ
LyogRGlzYWJsZSBhbGwgdGFibGVzICovCisJZm9yIChpID0gMDsgaSA8IDE2OyBpKyspCisJCVdS
RUczMl9TT0MxNV9PRkZTRVQoTU1IVUIsIDAsIG1tTU1WTV9DT05URVhUMF9DTlRMLCBpLCAwKTsK
KworCS8qIFNldHVwIFRMQiBjb250cm9sICovCisJdG1wID0gUlJFRzMyX1NPQzE1KE1NSFVCLCAw
LCBtbU1NTUNfVk1fTVhfTDFfVExCX0NOVEwpOworCXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBN
TU1DX1ZNX01YX0wxX1RMQl9DTlRMLCBFTkFCTEVfTDFfVExCLCAwKTsKKwl0bXAgPSBSRUdfU0VU
X0ZJRUxEKHRtcCwgTU1NQ19WTV9NWF9MMV9UTEJfQ05UTCwKKwkJCSAgICBFTkFCTEVfQURWQU5D
RURfRFJJVkVSX01PREVMLCAwKTsKKwlXUkVHMzJfU09DMTUoTU1IVUIsIDAsIG1tTU1NQ19WTV9N
WF9MMV9UTEJfQ05UTCwgdG1wKTsKKworCS8qIFNldHVwIEwyIGNhY2hlICovCisJdG1wID0gUlJF
RzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NVk1fTDJfQ05UTCk7CisJdG1wID0gUkVHX1NFVF9GSUVM
RCh0bXAsIE1NVk1fTDJfQ05UTCwgRU5BQkxFX0wyX0NBQ0hFLCAwKTsKKwlXUkVHMzJfU09DMTUo
TU1IVUIsIDAsIG1tTU1WTV9MMl9DTlRMLCB0bXApOworCVdSRUczMl9TT0MxNShNTUhVQiwgMCwg
bW1NTVZNX0wyX0NOVEwzLCAwKTsKK30KKworLyoqCisgKiBtbWh1Yl92Ml8wX3NldF9mYXVsdF9l
bmFibGVfZGVmYXVsdCAtIHVwZGF0ZSBHQVJUL1ZNIGZhdWx0IGhhbmRsaW5nCisgKgorICogQGFk
ZXY6IGFtZGdwdV9kZXZpY2UgcG9pbnRlcgorICogQHZhbHVlOiB0cnVlIHJlZGlyZWN0cyBWTSBm
YXVsdHMgdG8gdGhlIGRlZmF1bHQgcGFnZQorICovCit2b2lkIG1taHViX3YyXzBfc2V0X2ZhdWx0
X2VuYWJsZV9kZWZhdWx0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBib29sIHZhbHVlKQor
eworCXUzMiB0bXA7CisJdG1wID0gUlJFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NVk1fTDJfUFJP
VEVDVElPTl9GQVVMVF9DTlRMKTsKKwl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgTU1WTV9MMl9Q
Uk9URUNUSU9OX0ZBVUxUX0NOVEwsCisJCQkgICAgUkFOR0VfUFJPVEVDVElPTl9GQVVMVF9FTkFC
TEVfREVGQVVMVCwgdmFsdWUpOworCXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBNTVZNX0wyX1BS
T1RFQ1RJT05fRkFVTFRfQ05UTCwKKwkJCSAgICBQREUwX1BST1RFQ1RJT05fRkFVTFRfRU5BQkxF
X0RFRkFVTFQsIHZhbHVlKTsKKwl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgTU1WTV9MMl9QUk9U
RUNUSU9OX0ZBVUxUX0NOVEwsCisJCQkgICAgUERFMV9QUk9URUNUSU9OX0ZBVUxUX0VOQUJMRV9E
RUZBVUxULCB2YWx1ZSk7CisJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIE1NVk1fTDJfUFJPVEVD
VElPTl9GQVVMVF9DTlRMLAorCQkJICAgIFBERTJfUFJPVEVDVElPTl9GQVVMVF9FTkFCTEVfREVG
QVVMVCwgdmFsdWUpOworCXRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBNTVZNX0wyX1BST1RFQ1RJ
T05fRkFVTFRfQ05UTCwKKwkJCSAgICBUUkFOU0xBVEVfRlVSVEhFUl9QUk9URUNUSU9OX0ZBVUxU
X0VOQUJMRV9ERUZBVUxULAorCQkJICAgIHZhbHVlKTsKKwl0bXAgPSBSRUdfU0VUX0ZJRUxEKHRt
cCwgTU1WTV9MMl9QUk9URUNUSU9OX0ZBVUxUX0NOVEwsCisJCQkgICAgTkFDS19QUk9URUNUSU9O
X0ZBVUxUX0VOQUJMRV9ERUZBVUxULCB2YWx1ZSk7CisJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAs
IE1NVk1fTDJfUFJPVEVDVElPTl9GQVVMVF9DTlRMLAorCQkJICAgIERVTU1ZX1BBR0VfUFJPVEVD
VElPTl9GQVVMVF9FTkFCTEVfREVGQVVMVCwgdmFsdWUpOworCXRtcCA9IFJFR19TRVRfRklFTEQo
dG1wLCBNTVZNX0wyX1BST1RFQ1RJT05fRkFVTFRfQ05UTCwKKwkJCSAgICBWQUxJRF9QUk9URUNU
SU9OX0ZBVUxUX0VOQUJMRV9ERUZBVUxULCB2YWx1ZSk7CisJdG1wID0gUkVHX1NFVF9GSUVMRCh0
bXAsIE1NVk1fTDJfUFJPVEVDVElPTl9GQVVMVF9DTlRMLAorCQkJICAgIFJFQURfUFJPVEVDVElP
Tl9GQVVMVF9FTkFCTEVfREVGQVVMVCwgdmFsdWUpOworCXRtcCA9IFJFR19TRVRfRklFTEQodG1w
LCBNTVZNX0wyX1BST1RFQ1RJT05fRkFVTFRfQ05UTCwKKwkJCSAgICBXUklURV9QUk9URUNUSU9O
X0ZBVUxUX0VOQUJMRV9ERUZBVUxULCB2YWx1ZSk7CisJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAs
IE1NVk1fTDJfUFJPVEVDVElPTl9GQVVMVF9DTlRMLAorCQkJICAgIEVYRUNVVEVfUFJPVEVDVElP
Tl9GQVVMVF9FTkFCTEVfREVGQVVMVCwgdmFsdWUpOworCWlmICghdmFsdWUpIHsKKwkJdG1wID0g
UkVHX1NFVF9GSUVMRCh0bXAsIE1NVk1fTDJfUFJPVEVDVElPTl9GQVVMVF9DTlRMLAorCQkJCUNS
QVNIX09OX05PX1JFVFJZX0ZBVUxULCAxKTsKKwkJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIE1N
Vk1fTDJfUFJPVEVDVElPTl9GQVVMVF9DTlRMLAorCQkJCUNSQVNIX09OX1JFVFJZX0ZBVUxULCAx
KTsKKwl9CisJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NVk1fTDJfUFJPVEVDVElPTl9GQVVM
VF9DTlRMLCB0bXApOworfQorCit2b2lkIG1taHViX3YyXzBfaW5pdChzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldikKK3sKKwlzdHJ1Y3QgYW1kZ3B1X3ZtaHViICpodWIgPSAmYWRldi0+dm1odWJb
QU1ER1BVX01NSFVCXTsKKworCWh1Yi0+Y3R4MF9wdGJfYWRkcl9sbzMyID0KKwkJU09DMTVfUkVH
X09GRlNFVChNTUhVQiwgMCwKKwkJCQkgbW1NTVZNX0NPTlRFWFQwX1BBR0VfVEFCTEVfQkFTRV9B
RERSX0xPMzIpOworCWh1Yi0+Y3R4MF9wdGJfYWRkcl9oaTMyID0KKwkJU09DMTVfUkVHX09GRlNF
VChNTUhVQiwgMCwKKwkJCQkgbW1NTVZNX0NPTlRFWFQwX1BBR0VfVEFCTEVfQkFTRV9BRERSX0hJ
MzIpOworCWh1Yi0+dm1faW52X2VuZzBfcmVxID0KKwkJU09DMTVfUkVHX09GRlNFVChNTUhVQiwg
MCwgbW1NTVZNX0lOVkFMSURBVEVfRU5HMF9SRVEpOworCWh1Yi0+dm1faW52X2VuZzBfYWNrID0K
KwkJU09DMTVfUkVHX09GRlNFVChNTUhVQiwgMCwgbW1NTVZNX0lOVkFMSURBVEVfRU5HMF9BQ0sp
OworCWh1Yi0+dm1fY29udGV4dDBfY250bCA9CisJCVNPQzE1X1JFR19PRkZTRVQoTU1IVUIsIDAs
IG1tTU1WTV9DT05URVhUMF9DTlRMKTsKKwlodWItPnZtX2wyX3Byb19mYXVsdF9zdGF0dXMgPQor
CQlTT0MxNV9SRUdfT0ZGU0VUKE1NSFVCLCAwLCBtbU1NVk1fTDJfUFJPVEVDVElPTl9GQVVMVF9T
VEFUVVMpOworCWh1Yi0+dm1fbDJfcHJvX2ZhdWx0X2NudGwgPQorCQlTT0MxNV9SRUdfT0ZGU0VU
KE1NSFVCLCAwLCBtbU1NVk1fTDJfUFJPVEVDVElPTl9GQVVMVF9DTlRMKTsKKworfQorCitzdGF0
aWMgdm9pZCBtbWh1Yl92Ml8wX3VwZGF0ZV9tZWRpdW1fZ3JhaW5fY2xvY2tfZ2F0aW5nKHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2LAorCQkJCQkJCWJvb2wgZW5hYmxlKQoreworCXVpbnQzMl90
IGRlZiwgZGF0YSwgZGVmMSwgZGF0YTE7CisKKwlkZWYgID0gZGF0YSAgPSBSUkVHMzJfU09DMTUo
TU1IVUIsIDAsIG1tTU1fQVRDX0wyX01JU0NfQ0cpOworCisJZGVmMSA9IGRhdGExID0gUlJFRzMy
X1NPQzE1KE1NSFVCLCAwLCBtbURBR0IwX0NOVExfTUlTQzIpOworCisJaWYgKGVuYWJsZSAmJiAo
YWRldi0+Y2dfZmxhZ3MgJiBBTURfQ0dfU1VQUE9SVF9NQ19NR0NHKSkgeworCQlkYXRhIHw9IE1N
X0FUQ19MMl9NSVNDX0NHX19FTkFCTEVfTUFTSzsKKworCQlkYXRhMSAmPSB+KERBR0IwX0NOVExf
TUlTQzJfX0RJU0FCTEVfV1JSRVFfQ0dfTUFTSyB8CisJCSAgICAgICAgICAgREFHQjBfQ05UTF9N
SVNDMl9fRElTQUJMRV9XUlJFVF9DR19NQVNLIHwKKwkJICAgICAgICAgICBEQUdCMF9DTlRMX01J
U0MyX19ESVNBQkxFX1JEUkVRX0NHX01BU0sgfAorCQkgICAgICAgICAgIERBR0IwX0NOVExfTUlT
QzJfX0RJU0FCTEVfUkRSRVRfQ0dfTUFTSyB8CisJCSAgICAgICAgICAgREFHQjBfQ05UTF9NSVND
Ml9fRElTQUJMRV9UTEJXUl9DR19NQVNLIHwKKwkJICAgICAgICAgICBEQUdCMF9DTlRMX01JU0My
X19ESVNBQkxFX1RMQlJEX0NHX01BU0spOworCisJfSBlbHNlIHsKKwkJZGF0YSAmPSB+TU1fQVRD
X0wyX01JU0NfQ0dfX0VOQUJMRV9NQVNLOworCisJCWRhdGExIHw9IChEQUdCMF9DTlRMX01JU0My
X19ESVNBQkxFX1dSUkVRX0NHX01BU0sgfAorCQkJICBEQUdCMF9DTlRMX01JU0MyX19ESVNBQkxF
X1dSUkVUX0NHX01BU0sgfAorCQkJICBEQUdCMF9DTlRMX01JU0MyX19ESVNBQkxFX1JEUkVRX0NH
X01BU0sgfAorCQkJICBEQUdCMF9DTlRMX01JU0MyX19ESVNBQkxFX1JEUkVUX0NHX01BU0sgfAor
CQkJICBEQUdCMF9DTlRMX01JU0MyX19ESVNBQkxFX1RMQldSX0NHX01BU0sgfAorCQkJICBEQUdC
MF9DTlRMX01JU0MyX19ESVNBQkxFX1RMQlJEX0NHX01BU0spOworCX0KKworCWlmIChkZWYgIT0g
ZGF0YSkKKwkJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NX0FUQ19MMl9NSVNDX0NHLCBkYXRh
KTsKKworCWlmIChkZWYxICE9IGRhdGExKQorCQlXUkVHMzJfU09DMTUoTU1IVUIsIDAsIG1tREFH
QjBfQ05UTF9NSVNDMiwgZGF0YTEpOworfQorCitzdGF0aWMgdm9pZCBtbWh1Yl92Ml8wX3VwZGF0
ZV9tZWRpdW1fZ3JhaW5fbGlnaHRfc2xlZXAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCisJ
CQkJCQkgICAgICAgYm9vbCBlbmFibGUpCit7CisJdWludDMyX3QgZGVmLCBkYXRhOworCisJZGVm
ID0gZGF0YSA9IFJSRUczMl9TT0MxNShNTUhVQiwgMCwgbW1NTV9BVENfTDJfTUlTQ19DRyk7CisK
KwlpZiAoZW5hYmxlICYmIChhZGV2LT5jZ19mbGFncyAmIEFNRF9DR19TVVBQT1JUX01DX0xTKSkK
KwkJZGF0YSB8PSBNTV9BVENfTDJfTUlTQ19DR19fTUVNX0xTX0VOQUJMRV9NQVNLOworCWVsc2UK
KwkJZGF0YSAmPSB+TU1fQVRDX0wyX01JU0NfQ0dfX01FTV9MU19FTkFCTEVfTUFTSzsKKworCWlm
IChkZWYgIT0gZGF0YSkKKwkJV1JFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NX0FUQ19MMl9NSVND
X0NHLCBkYXRhKTsKK30KKworaW50IG1taHViX3YyXzBfc2V0X2Nsb2NrZ2F0aW5nKHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2LAorCQkJICAgICAgIGVudW0gYW1kX2Nsb2NrZ2F0aW5nX3N0YXRl
IHN0YXRlKQoreworCWlmIChhbWRncHVfc3Jpb3ZfdmYoYWRldikpCisJCXJldHVybiAwOworCisJ
c3dpdGNoIChhZGV2LT5hc2ljX3R5cGUpIHsKKwljYXNlIENISVBfTkFWSTEwOgorCQltbWh1Yl92
Ml8wX3VwZGF0ZV9tZWRpdW1fZ3JhaW5fY2xvY2tfZ2F0aW5nKGFkZXYsCisJCQkJc3RhdGUgPT0g
QU1EX0NHX1NUQVRFX0dBVEUgPyB0cnVlIDogZmFsc2UpOworCQltbWh1Yl92Ml8wX3VwZGF0ZV9t
ZWRpdW1fZ3JhaW5fbGlnaHRfc2xlZXAoYWRldiwKKwkJCQlzdGF0ZSA9PSBBTURfQ0dfU1RBVEVf
R0FURSA/IHRydWUgOiBmYWxzZSk7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCWJyZWFrOworCX0K
KworCXJldHVybiAwOworfQorCit2b2lkIG1taHViX3YyXzBfZ2V0X2Nsb2NrZ2F0aW5nKHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2LCB1MzIgKmZsYWdzKQoreworCWludCBkYXRhLCBkYXRhMTsK
KworCWlmIChhbWRncHVfc3Jpb3ZfdmYoYWRldikpCisJCSpmbGFncyA9IDA7CisKKwlkYXRhID0g
UlJFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbU1NX0FUQ19MMl9NSVNDX0NHKTsKKworCWRhdGExID0g
UlJFRzMyX1NPQzE1KE1NSFVCLCAwLCBtbURBR0IwX0NOVExfTUlTQzIpOworCisJLyogQU1EX0NH
X1NVUFBPUlRfTUNfTUdDRyAqLworCWlmICgoZGF0YSAmIE1NX0FUQ19MMl9NSVNDX0NHX19FTkFC
TEVfTUFTSykgJiYKKwkgICAgIShkYXRhMSAmIChEQUdCMF9DTlRMX01JU0MyX19ESVNBQkxFX1dS
UkVRX0NHX01BU0sgfAorCQkgICAgICAgREFHQjBfQ05UTF9NSVNDMl9fRElTQUJMRV9XUlJFVF9D
R19NQVNLIHwKKwkJICAgICAgIERBR0IwX0NOVExfTUlTQzJfX0RJU0FCTEVfUkRSRVFfQ0dfTUFT
SyB8CisJCSAgICAgICBEQUdCMF9DTlRMX01JU0MyX19ESVNBQkxFX1JEUkVUX0NHX01BU0sgfAor
CQkgICAgICAgREFHQjBfQ05UTF9NSVNDMl9fRElTQUJMRV9UTEJXUl9DR19NQVNLIHwKKwkJICAg
ICAgIERBR0IwX0NOVExfTUlTQzJfX0RJU0FCTEVfVExCUkRfQ0dfTUFTSykpKQorCQkqZmxhZ3Mg
fD0gQU1EX0NHX1NVUFBPUlRfTUNfTUdDRzsKKworCS8qIEFNRF9DR19TVVBQT1JUX01DX0xTICov
CisJaWYgKGRhdGEgJiBNTV9BVENfTDJfTUlTQ19DR19fTUVNX0xTX0VOQUJMRV9NQVNLKQorCQkq
ZmxhZ3MgfD0gQU1EX0NHX1NVUFBPUlRfTUNfTFM7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9tbWh1Yl92Ml8wLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9tbWh1Yl92Ml8wLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5k
YjE2ZjNlY2UyMTgKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9tbWh1Yl92Ml8wLmgKQEAgLTAsMCArMSwzNSBAQAorLyoKKyAqIENvcHlyaWdodCAyMDE5IEFk
dmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KKyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBn
cmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29w
eSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRo
ZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJp
Y3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNl
LCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAor
ICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJz
b25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1Ympl
Y3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmln
aHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGlu
CisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4K
KyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5U
WSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1Qg
TElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNT
IEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZF
TlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFC
TEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgorICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVS
IElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsCisgKiBBUklTSU5H
IEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBV
U0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KKyAqCisgKi8KKyNpZm5k
ZWYgX19NTUhVQl9WMl8wX0hfXworI2RlZmluZSBfX01NSFVCX1YyXzBfSF9fCisKK2ludCBtbWh1
Yl92Ml8wX2dhcnRfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KTsKK3ZvaWQgbW1o
dWJfdjJfMF9nYXJ0X2Rpc2FibGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpOwordm9pZCBt
bWh1Yl92Ml8wX3NldF9mYXVsdF9lbmFibGVfZGVmYXVsdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiwKKwkJCQkJIGJvb2wgdmFsdWUpOwordm9pZCBtbWh1Yl92Ml8wX2luaXQoc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYpOworaW50IG1taHViX3YyXzBfc2V0X2Nsb2NrZ2F0aW5nKHN0cnVj
dCBhbWRncHVfZGV2aWNlICphZGV2LAorCQkJICAgICAgIGVudW0gYW1kX2Nsb2NrZ2F0aW5nX3N0
YXRlIHN0YXRlKTsKK3ZvaWQgbW1odWJfdjJfMF9nZXRfY2xvY2tnYXRpbmcoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsIHUzMiAqZmxhZ3MpOworCisjZW5kaWYKLS0gCjIuMjAuMQoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KYW1kLWdmeCBtYWlsaW5n
IGxpc3QKYW1kLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9hbWQtZ2Z4
