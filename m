Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CFBF448F5C
	for <lists+amd-gfx@lfdr.de>; Mon, 17 Jun 2019 21:32:00 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C60BB89C33;
	Mon, 17 Jun 2019 19:31:58 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qt1-x844.google.com (mail-qt1-x844.google.com
 [IPv6:2607:f8b0:4864:20::844])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B873389C25
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:31:57 +0000 (UTC)
Received: by mail-qt1-x844.google.com with SMTP id p15so12256353qtl.3
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 12:31:57 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Uo/flRDczPZ5CtXkDriyAlcWzR53YynoeNEINQeBJ7w=;
 b=A+cvKI6dnj+tiMFb1ZHZx1nvs4fW8u90HSGKEwFzKqrW4cMg21FB31tj9nbg95O70U
 vz6YRu2+1c8yB1tXQS8mKa5+DC7+QlBX3rV6DT/bXdzrL2qlNWVcRHqdXNljMdrFrMH1
 Hqvgqd7xRkPrIE5P+HNikAbGkbVgXrNj7RuZJd+aingbfQAOFsHf1f8bgf5qZJx3qKzf
 prb4y3agTjWYNeI0X6Q4FnCy5MxgVbDmXqdq/Hz1e3eHLu95vd+riehkuryheLRhubqv
 lXYvRRRJPXG+MkCSIUwYi/euznbxwVEeq/xLzNUYZHDDUyEqEcHPWwYBhWuZN5I4S4op
 0XjA==
X-Gm-Message-State: APjAAAXLQunatR98i+1l/hjoAhkVGLMJ/0FK+gi3YQdc+X13/UGkytIR
 wMdxcFcmqQsw4E2kqDpmtUoD5nwmZf8=
X-Google-Smtp-Source: APXvYqxqInjFIWTw5a4b/qpvVRfAW417s06nPivmksxJTLx2UP/V9vQkmEGwIFnWI9JS6owoWAn6hg==
X-Received: by 2002:a0c:81f6:: with SMTP id 51mr23158599qve.213.1560799916687; 
 Mon, 17 Jun 2019 12:31:56 -0700 (PDT)
Received: from localhost.localdomain ([71.219.5.136])
 by smtp.gmail.com with ESMTPSA id u2sm7474875qtj.97.2019.06.17.12.31.55
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 12:31:56 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 247/459] Revert "drm/amdgpu: mask some pm interfaces for
 navi10 because they are changed or not workable so far"
Date: Mon, 17 Jun 2019 14:30:14 -0500
Message-Id: <20190617193106.18231-48-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617193106.18231-1-alexander.deucher@amd.com>
References: <20190617193106.18231-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Uo/flRDczPZ5CtXkDriyAlcWzR53YynoeNEINQeBJ7w=;
 b=q5D4ov7aEqH5k0ywmP8wLwh7YFbG3p9/Fi0zjolZ3Lc0vA7ZWQhIJxnsYmq5BPyBqO
 kB9UQfB4D5coRYJC5XMeyhY4U01zETyiyDIaxYdO/B1GyPySzbSv7UCOn1yVFUjijpzl
 j2cbdrg1dnL7v+ab7Qr6BKLJT47kn0l7gX6z6KVyF0moyhTeOZMCfZRDBtiNC6aWSovN
 KdwuR04JwGEieqwXLpUKlSRPxL+ZYBK7jkX+iJcLMQ7g21ZMkYX1izfceIWBTXgSKkIZ
 aUjQc7XamSTM1vERckrOu8xX7dz5fzvgM3lkAILavPVQVFki5vyGe7j3ZmOIfBebBjzK
 yPvA==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>, Kevin Wang <kevin1.wang@amd.com>,
 Huang Rui <ray.huang@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogS2V2aW4gV2FuZyA8a2V2aW4xLndhbmdAYW1kLmNvbT4KClRoaXMgcmV2ZXJ0cyBjb21t
aXQgZmQ5Yzc1ZDIxN2Q1YjRlZDcyNjcyNzIyYjY2MjFlMjYzNTM2M2RmZS4KClNpZ25lZC1vZmYt
Ynk6IEtldmluIFdhbmcgPGtldmluMS53YW5nQGFtZC5jb20+ClJldmlld2VkLWJ5OiBIdWFuZyBS
dWkgPHJheS5odWFuZ0BhbWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBBbGV4IERldWNoZXIgPGFsZXhh
bmRlci5kZXVjaGVyQGFtZC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2ttcy5jIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfcG0u
YyAgfCAxNTYgKysrKysrKysrKystLS0tLS0tLS0tLS0tCiAyIGZpbGVzIGNoYW5nZWQsIDczIGlu
c2VydGlvbnMoKyksIDg1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9rbXMuYwppbmRleCBhZjg2ZDlmNDc3ODUuLmVkMDUxZmRiNTA5ZiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ttcy5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYwpAQCAtNjkwLDcgKzY5MCw3IEBAIHN0YXRpYyBp
bnQgYW1kZ3B1X2luZm9faW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwg
c3RydWN0IGRybV9maWxlCiAJCWRldl9pbmZvLm51bV9zaGFkZXJfYXJyYXlzX3Blcl9lbmdpbmUg
PSBhZGV2LT5nZnguY29uZmlnLm1heF9zaF9wZXJfc2U7CiAJCS8qIHJldHVybiBhbGwgY2xvY2tz
IGluIEtIeiAqLwogCQlkZXZfaW5mby5ncHVfY291bnRlcl9mcmVxID0gYW1kZ3B1X2FzaWNfZ2V0
X3hjbGsoYWRldikgKiAxMDsKLQkJaWYgKGFkZXYtPnBtLmRwbV9lbmFibGVkICYmIGFkZXYtPmFz
aWNfdHlwZSAhPSBDSElQX05BVkkxMCkgeworCQlpZiAoYWRldi0+cG0uZHBtX2VuYWJsZWQpIHsK
IAkJCWRldl9pbmZvLm1heF9lbmdpbmVfY2xvY2sgPSBhbWRncHVfZHBtX2dldF9zY2xrKGFkZXYs
IGZhbHNlKSAqIDEwOwogCQkJZGV2X2luZm8ubWF4X21lbW9yeV9jbG9jayA9IGFtZGdwdV9kcG1f
Z2V0X21jbGsoYWRldiwgZmFsc2UpICogMTA7CiAJCX0gZWxzZSBpZiAoYW1kZ3B1X3NyaW92X3Zm
KGFkZXYpICYmIGFtZGdpbV9pc19od3BlcmYoYWRldikgJiYKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3BtLmMKaW5kZXggOGMyOGY4MTZiNTBmLi42Yjk3ZjMwOTgxMTggMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jCkBAIC0yNzkzLDMzICsyNzkzLDMyIEBAIGlu
dCBhbWRncHVfcG1fc3lzZnNfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAkJcmV0
dXJuIHJldDsKIAl9CiAKLQlpZiAoYWRldi0+YXNpY190eXBlICE9IENISVBfTkFWSTEwKSB7Ci0J
CXJldCA9IGRldmljZV9jcmVhdGVfZmlsZShhZGV2LT5kZXYsICZkZXZfYXR0cl9wb3dlcl9kcG1f
c3RhdGUpOwotCQlpZiAocmV0KSB7Ci0JCQlEUk1fRVJST1IoImZhaWxlZCB0byBjcmVhdGUgZGV2
aWNlIGZpbGUgZm9yIGRwbSBzdGF0ZVxuIik7Ci0JCQlyZXR1cm4gcmV0OwotCQl9Ci0JCXJldCA9
IGRldmljZV9jcmVhdGVfZmlsZShhZGV2LT5kZXYsICZkZXZfYXR0cl9wb3dlcl9kcG1fZm9yY2Vf
cGVyZm9ybWFuY2VfbGV2ZWwpOwotCQlpZiAocmV0KSB7Ci0JCQlEUk1fRVJST1IoImZhaWxlZCB0
byBjcmVhdGUgZGV2aWNlIGZpbGUgZm9yIGRwbSBzdGF0ZVxuIik7Ci0JCQlyZXR1cm4gcmV0Owot
CQl9CisJcmV0ID0gZGV2aWNlX2NyZWF0ZV9maWxlKGFkZXYtPmRldiwgJmRldl9hdHRyX3Bvd2Vy
X2RwbV9zdGF0ZSk7CisJaWYgKHJldCkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBjcmVhdGUg
ZGV2aWNlIGZpbGUgZm9yIGRwbSBzdGF0ZVxuIik7CisJCXJldHVybiByZXQ7CisJfQorCXJldCA9
IGRldmljZV9jcmVhdGVfZmlsZShhZGV2LT5kZXYsICZkZXZfYXR0cl9wb3dlcl9kcG1fZm9yY2Vf
cGVyZm9ybWFuY2VfbGV2ZWwpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8g
Y3JlYXRlIGRldmljZSBmaWxlIGZvciBkcG0gc3RhdGVcbiIpOworCQlyZXR1cm4gcmV0OworCX0K
IAotCQlyZXQgPSBkZXZpY2VfY3JlYXRlX2ZpbGUoYWRldi0+ZGV2LCAmZGV2X2F0dHJfcHBfbnVt
X3N0YXRlcyk7Ci0JCWlmIChyZXQpIHsKLQkJCURSTV9FUlJPUigiZmFpbGVkIHRvIGNyZWF0ZSBk
ZXZpY2UgZmlsZSBwcF9udW1fc3RhdGVzXG4iKTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KLQkJcmV0
ID0gZGV2aWNlX2NyZWF0ZV9maWxlKGFkZXYtPmRldiwgJmRldl9hdHRyX3BwX2N1cl9zdGF0ZSk7
Ci0JCWlmIChyZXQpIHsKLQkJCURSTV9FUlJPUigiZmFpbGVkIHRvIGNyZWF0ZSBkZXZpY2UgZmls
ZSBwcF9jdXJfc3RhdGVcbiIpOwotCQkJcmV0dXJuIHJldDsKLQkJfQotCQlyZXQgPSBkZXZpY2Vf
Y3JlYXRlX2ZpbGUoYWRldi0+ZGV2LCAmZGV2X2F0dHJfcHBfZm9yY2Vfc3RhdGUpOwotCQlpZiAo
cmV0KSB7Ci0JCQlEUk1fRVJST1IoImZhaWxlZCB0byBjcmVhdGUgZGV2aWNlIGZpbGUgcHBfZm9y
Y2Vfc3RhdGVcbiIpOwotCQkJcmV0dXJuIHJldDsKLQkJfQorCisJcmV0ID0gZGV2aWNlX2NyZWF0
ZV9maWxlKGFkZXYtPmRldiwgJmRldl9hdHRyX3BwX251bV9zdGF0ZXMpOworCWlmIChyZXQpIHsK
KwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gY3JlYXRlIGRldmljZSBmaWxlIHBwX251bV9zdGF0ZXNc
biIpOworCQlyZXR1cm4gcmV0OworCX0KKwlyZXQgPSBkZXZpY2VfY3JlYXRlX2ZpbGUoYWRldi0+
ZGV2LCAmZGV2X2F0dHJfcHBfY3VyX3N0YXRlKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJPUigi
ZmFpbGVkIHRvIGNyZWF0ZSBkZXZpY2UgZmlsZSBwcF9jdXJfc3RhdGVcbiIpOworCQlyZXR1cm4g
cmV0OworCX0KKwlyZXQgPSBkZXZpY2VfY3JlYXRlX2ZpbGUoYWRldi0+ZGV2LCAmZGV2X2F0dHJf
cHBfZm9yY2Vfc3RhdGUpOworCWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gY3Jl
YXRlIGRldmljZSBmaWxlIHBwX2ZvcmNlX3N0YXRlXG4iKTsKKwkJcmV0dXJuIHJldDsKIAl9CiAJ
cmV0ID0gZGV2aWNlX2NyZWF0ZV9maWxlKGFkZXYtPmRldiwgJmRldl9hdHRyX3BwX3RhYmxlKTsK
IAlpZiAocmV0KSB7CkBAIC0yODMyLDU1ICsyODMxLDUyIEBAIGludCBhbWRncHVfcG1fc3lzZnNf
aW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAkJRFJNX0VSUk9SKCJmYWlsZWQgdG8g
Y3JlYXRlIGRldmljZSBmaWxlIHBwX2RwbV9zY2xrXG4iKTsKIAkJcmV0dXJuIHJldDsKIAl9Ci0K
LQlpZiAoYWRldi0+YXNpY190eXBlICE9IENISVBfTkFWSTEwKSB7Ci0JCXJldCA9IGRldmljZV9j
cmVhdGVfZmlsZShhZGV2LT5kZXYsICZkZXZfYXR0cl9wcF9kcG1fbWNsayk7Ci0JCWlmIChyZXQp
IHsKLQkJCURSTV9FUlJPUigiZmFpbGVkIHRvIGNyZWF0ZSBkZXZpY2UgZmlsZSBwcF9kcG1fbWNs
a1xuIik7Ci0JCQlyZXR1cm4gcmV0OwotCQl9Ci0JCWlmIChhZGV2LT5hc2ljX3R5cGUgPj0gQ0hJ
UF9WRUdBMTApIHsKLQkJCXJldCA9IGRldmljZV9jcmVhdGVfZmlsZShhZGV2LT5kZXYsICZkZXZf
YXR0cl9wcF9kcG1fc29jY2xrKTsKLQkJCWlmIChyZXQpIHsKLQkJCQlEUk1fRVJST1IoImZhaWxl
ZCB0byBjcmVhdGUgZGV2aWNlIGZpbGUgcHBfZHBtX3NvY2Nsa1xuIik7Ci0JCQkJcmV0dXJuIHJl
dDsKLQkJCX0KLQkJCXJldCA9IGRldmljZV9jcmVhdGVfZmlsZShhZGV2LT5kZXYsICZkZXZfYXR0
cl9wcF9kcG1fZGNlZmNsayk7Ci0JCQlpZiAocmV0KSB7Ci0JCQkJRFJNX0VSUk9SKCJmYWlsZWQg
dG8gY3JlYXRlIGRldmljZSBmaWxlIHBwX2RwbV9kY2VmY2xrXG4iKTsKLQkJCQlyZXR1cm4gcmV0
OwotCQkJfQotCQl9Ci0JCWlmIChhZGV2LT5hc2ljX3R5cGUgPj0gQ0hJUF9WRUdBMjApIHsKLQkJ
CXJldCA9IGRldmljZV9jcmVhdGVfZmlsZShhZGV2LT5kZXYsICZkZXZfYXR0cl9wcF9kcG1fZmNs
ayk7Ci0JCQlpZiAocmV0KSB7Ci0JCQkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gY3JlYXRlIGRldmlj
ZSBmaWxlIHBwX2RwbV9mY2xrXG4iKTsKLQkJCQlyZXR1cm4gcmV0OwotCQkJfQotCQl9Ci0JCXJl
dCA9IGRldmljZV9jcmVhdGVfZmlsZShhZGV2LT5kZXYsICZkZXZfYXR0cl9wcF9kcG1fcGNpZSk7
Ci0JCWlmIChyZXQpIHsKLQkJCURSTV9FUlJPUigiZmFpbGVkIHRvIGNyZWF0ZSBkZXZpY2UgZmls
ZSBwcF9kcG1fcGNpZVxuIik7Ci0JCQlyZXR1cm4gcmV0OwotCQl9Ci0JCXJldCA9IGRldmljZV9j
cmVhdGVfZmlsZShhZGV2LT5kZXYsICZkZXZfYXR0cl9wcF9zY2xrX29kKTsKKwlyZXQgPSBkZXZp
Y2VfY3JlYXRlX2ZpbGUoYWRldi0+ZGV2LCAmZGV2X2F0dHJfcHBfZHBtX21jbGspOworCWlmIChy
ZXQpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gY3JlYXRlIGRldmljZSBmaWxlIHBwX2RwbV9t
Y2xrXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisJaWYgKGFkZXYtPmFzaWNfdHlwZSA+PSBDSElQ
X1ZFR0ExMCkgeworCQlyZXQgPSBkZXZpY2VfY3JlYXRlX2ZpbGUoYWRldi0+ZGV2LCAmZGV2X2F0
dHJfcHBfZHBtX3NvY2Nsayk7CiAJCWlmIChyZXQpIHsKLQkJCURSTV9FUlJPUigiZmFpbGVkIHRv
IGNyZWF0ZSBkZXZpY2UgZmlsZSBwcF9zY2xrX29kXG4iKTsKKwkJCURSTV9FUlJPUigiZmFpbGVk
IHRvIGNyZWF0ZSBkZXZpY2UgZmlsZSBwcF9kcG1fc29jY2xrXG4iKTsKIAkJCXJldHVybiByZXQ7
CiAJCX0KLQkJcmV0ID0gZGV2aWNlX2NyZWF0ZV9maWxlKGFkZXYtPmRldiwgJmRldl9hdHRyX3Bw
X21jbGtfb2QpOworCQlyZXQgPSBkZXZpY2VfY3JlYXRlX2ZpbGUoYWRldi0+ZGV2LCAmZGV2X2F0
dHJfcHBfZHBtX2RjZWZjbGspOwogCQlpZiAocmV0KSB7Ci0JCQlEUk1fRVJST1IoImZhaWxlZCB0
byBjcmVhdGUgZGV2aWNlIGZpbGUgcHBfbWNsa19vZFxuIik7CisJCQlEUk1fRVJST1IoImZhaWxl
ZCB0byBjcmVhdGUgZGV2aWNlIGZpbGUgcHBfZHBtX2RjZWZjbGtcbiIpOwogCQkJcmV0dXJuIHJl
dDsKIAkJfQotCQlyZXQgPSBkZXZpY2VfY3JlYXRlX2ZpbGUoYWRldi0+ZGV2LAotCQkJCSZkZXZf
YXR0cl9wcF9wb3dlcl9wcm9maWxlX21vZGUpOworCX0KKwlpZiAoYWRldi0+YXNpY190eXBlID49
IENISVBfVkVHQTIwKSB7CisJCXJldCA9IGRldmljZV9jcmVhdGVfZmlsZShhZGV2LT5kZXYsICZk
ZXZfYXR0cl9wcF9kcG1fZmNsayk7CiAJCWlmIChyZXQpIHsKLQkJCURSTV9FUlJPUigiZmFpbGVk
IHRvIGNyZWF0ZSBkZXZpY2UgZmlsZQkiCi0JCQkJCSJwcF9wb3dlcl9wcm9maWxlX21vZGVcbiIp
OworCQkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gY3JlYXRlIGRldmljZSBmaWxlIHBwX2RwbV9mY2xr
XG4iKTsKIAkJCXJldHVybiByZXQ7CiAJCX0KIAl9CisJcmV0ID0gZGV2aWNlX2NyZWF0ZV9maWxl
KGFkZXYtPmRldiwgJmRldl9hdHRyX3BwX2RwbV9wY2llKTsKKwlpZiAocmV0KSB7CisJCURSTV9F
UlJPUigiZmFpbGVkIHRvIGNyZWF0ZSBkZXZpY2UgZmlsZSBwcF9kcG1fcGNpZVxuIik7CisJCXJl
dHVybiByZXQ7CisJfQorCXJldCA9IGRldmljZV9jcmVhdGVfZmlsZShhZGV2LT5kZXYsICZkZXZf
YXR0cl9wcF9zY2xrX29kKTsKKwlpZiAocmV0KSB7CisJCURSTV9FUlJPUigiZmFpbGVkIHRvIGNy
ZWF0ZSBkZXZpY2UgZmlsZSBwcF9zY2xrX29kXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisJcmV0
ID0gZGV2aWNlX2NyZWF0ZV9maWxlKGFkZXYtPmRldiwgJmRldl9hdHRyX3BwX21jbGtfb2QpOwor
CWlmIChyZXQpIHsKKwkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gY3JlYXRlIGRldmljZSBmaWxlIHBw
X21jbGtfb2RcbiIpOworCQlyZXR1cm4gcmV0OworCX0KKwlyZXQgPSBkZXZpY2VfY3JlYXRlX2Zp
bGUoYWRldi0+ZGV2LAorCQkJJmRldl9hdHRyX3BwX3Bvd2VyX3Byb2ZpbGVfbW9kZSk7CisJaWYg
KHJldCkgeworCQlEUk1fRVJST1IoImZhaWxlZCB0byBjcmVhdGUgZGV2aWNlIGZpbGUJIgorCQkJ
CSJwcF9wb3dlcl9wcm9maWxlX21vZGVcbiIpOworCQlyZXR1cm4gcmV0OworCX0KIAlpZiAoKGlz
X3N1cHBvcnRfc3dfc211KGFkZXYpICYmIGFkZXYtPnNtdS5vZF9lbmFibGVkKSB8fAogCSAgICAo
IWlzX3N1cHBvcnRfc3dfc211KGFkZXYpICYmIGh3bWdyLT5vZF9lbmFibGVkKSkgewogCQlyZXQg
PSBkZXZpY2VfY3JlYXRlX2ZpbGUoYWRldi0+ZGV2LApAQCAtMzA1NiwyNSArMzA1MiwyMSBAQCBz
dGF0aWMgaW50IGFtZGdwdV9kZWJ1Z2ZzX3BtX2luZm9fcHAoc3RydWN0IHNlcV9maWxlICptLCBz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYQogCS8qIEdQVSBDbG9ja3MgKi8KIAlzaXplID0gc2l6ZW9m
KHZhbHVlKTsKIAlzZXFfcHJpbnRmKG0sICJHRlggQ2xvY2tzIGFuZCBQb3dlcjpcbiIpOwotCWlm
IChhZGV2LT5hc2ljX3R5cGUgIT0gQ0hJUF9OQVZJMTApIHsKLQkJaWYgKCFhbWRncHVfZHBtX3Jl
YWRfc2Vuc29yKGFkZXYsIEFNREdQVV9QUF9TRU5TT1JfR0ZYX01DTEssICh2b2lkICopJnZhbHVl
LCAmc2l6ZSkpCi0JCQlzZXFfcHJpbnRmKG0sICJcdCV1IE1IeiAoTUNMSylcbiIsIHZhbHVlLzEw
MCk7Ci0JCWlmICghYW1kZ3B1X2RwbV9yZWFkX3NlbnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09S
X0dGWF9TQ0xLLCAodm9pZCAqKSZ2YWx1ZSwgJnNpemUpKQotCQkJc2VxX3ByaW50ZihtLCAiXHQl
dSBNSHogKFNDTEspXG4iLCB2YWx1ZS8xMDApOwotCQlpZiAoIWFtZGdwdV9kcG1fcmVhZF9zZW5z
b3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9TVEFCTEVfUFNUQVRFX1NDTEssICh2b2lkICopJnZh
bHVlLCAmc2l6ZSkpCi0JCQlzZXFfcHJpbnRmKG0sICJcdCV1IE1IeiAoUFNUQVRFX1NDTEspXG4i
LCB2YWx1ZS8xMDApOwotCQlpZiAoIWFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BV
X1BQX1NFTlNPUl9TVEFCTEVfUFNUQVRFX01DTEssICh2b2lkICopJnZhbHVlLCAmc2l6ZSkpCi0J
CQlzZXFfcHJpbnRmKG0sICJcdCV1IE1IeiAoUFNUQVRFX01DTEspXG4iLCB2YWx1ZS8xMDApOwot
CX0KKwlpZiAoIWFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9H
RlhfTUNMSywgKHZvaWQgKikmdmFsdWUsICZzaXplKSkKKwkJc2VxX3ByaW50ZihtLCAiXHQldSBN
SHogKE1DTEspXG4iLCB2YWx1ZS8xMDApOworCWlmICghYW1kZ3B1X2RwbV9yZWFkX3NlbnNvcihh
ZGV2LCBBTURHUFVfUFBfU0VOU09SX0dGWF9TQ0xLLCAodm9pZCAqKSZ2YWx1ZSwgJnNpemUpKQor
CQlzZXFfcHJpbnRmKG0sICJcdCV1IE1IeiAoU0NMSylcbiIsIHZhbHVlLzEwMCk7CisJaWYgKCFh
bWRncHVfZHBtX3JlYWRfc2Vuc29yKGFkZXYsIEFNREdQVV9QUF9TRU5TT1JfU1RBQkxFX1BTVEFU
RV9TQ0xLLCAodm9pZCAqKSZ2YWx1ZSwgJnNpemUpKQorCQlzZXFfcHJpbnRmKG0sICJcdCV1IE1I
eiAoUFNUQVRFX1NDTEspXG4iLCB2YWx1ZS8xMDApOworCWlmICghYW1kZ3B1X2RwbV9yZWFkX3Nl
bnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX1NUQUJMRV9QU1RBVEVfTUNMSywgKHZvaWQgKikm
dmFsdWUsICZzaXplKSkKKwkJc2VxX3ByaW50ZihtLCAiXHQldSBNSHogKFBTVEFURV9NQ0xLKVxu
IiwgdmFsdWUvMTAwKTsKIAlpZiAoIWFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BV
X1BQX1NFTlNPUl9WRERHRlgsICh2b2lkICopJnZhbHVlLCAmc2l6ZSkpCiAJCXNlcV9wcmludGYo
bSwgIlx0JXUgbVYgKFZEREdGWClcbiIsIHZhbHVlKTsKIAlpZiAoIWFtZGdwdV9kcG1fcmVhZF9z
ZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9WREROQiwgKHZvaWQgKikmdmFsdWUsICZzaXpl
KSkKIAkJc2VxX3ByaW50ZihtLCAiXHQldSBtViAoVkRETkIpXG4iLCB2YWx1ZSk7Ci0JaWYgKGFk
ZXYtPmFzaWNfdHlwZSAhPSBDSElQX05BVkkxMCkgewotCQlzaXplID0gc2l6ZW9mKHVpbnQzMl90
KTsKLQkJaWYgKCFhbWRncHVfZHBtX3JlYWRfc2Vuc29yKGFkZXYsIEFNREdQVV9QUF9TRU5TT1Jf
R1BVX1BPV0VSLCAodm9pZCAqKSZxdWVyeSwgJnNpemUpKQotCQkJc2VxX3ByaW50ZihtLCAiXHQl
dS4ldSBXIChhdmVyYWdlIEdQVSlcbiIsIHF1ZXJ5ID4+IDgsIHF1ZXJ5ICYgMHhmZik7Ci0JfQor
CXNpemUgPSBzaXplb2YodWludDMyX3QpOworCWlmICghYW1kZ3B1X2RwbV9yZWFkX3NlbnNvcihh
ZGV2LCBBTURHUFVfUFBfU0VOU09SX0dQVV9QT1dFUiwgKHZvaWQgKikmcXVlcnksICZzaXplKSkK
KwkJc2VxX3ByaW50ZihtLCAiXHQldS4ldSBXIChhdmVyYWdlIEdQVSlcbiIsIHF1ZXJ5ID4+IDgs
IHF1ZXJ5ICYgMHhmZik7CiAJc2l6ZSA9IHNpemVvZih2YWx1ZSk7CiAJc2VxX3ByaW50ZihtLCAi
XG4iKTsKIApAQCAtMzA4MiwxMCArMzA3NCw2IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RlYnVnZnNf
cG1faW5mb19wcChzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBhbWRncHVfZGV2aWNlICphCiAJ
aWYgKCFhbWRncHVfZHBtX3JlYWRfc2Vuc29yKGFkZXYsIEFNREdQVV9QUF9TRU5TT1JfR1BVX1RF
TVAsICh2b2lkICopJnZhbHVlLCAmc2l6ZSkpCiAJCXNlcV9wcmludGYobSwgIkdQVSBUZW1wZXJh
dHVyZTogJXUgQ1xuIiwgdmFsdWUvMTAwMCk7CiAKLQkvKiBUT0RPOiB3aWxsIGJlIHJlbW92ZWQg
YWZ0ZXIgZ3B1IGxvYWQsIGZlYXR1cmUgbWFzaywgdXZkL3ZjZSBjbG9ja3MgZW5hYmxlZCBvbiBu
YXZpMTAgKi8KLQlpZiAoYWRldi0+YXNpY190eXBlID09IENISVBfTkFWSTEwKQotCQlyZXR1cm4g
MDsKLQogCS8qIEdQVSBMb2FkICovCiAJaWYgKCFhbWRncHVfZHBtX3JlYWRfc2Vuc29yKGFkZXYs
IEFNREdQVV9QUF9TRU5TT1JfR1BVX0xPQUQsICh2b2lkICopJnZhbHVlLCAmc2l6ZSkpCiAJCXNl
cV9wcmludGYobSwgIkdQVSBMb2FkOiAldSAlJVxuIiwgdmFsdWUpOwotLSAKMi4yMC4xCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxp
bmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
