Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B79671A0F1C
	for <lists+amd-gfx@lfdr.de>; Tue,  7 Apr 2020 16:27:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F239A6E0DC;
	Tue,  7 Apr 2020 14:27:32 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wr1-x441.google.com (mail-wr1-x441.google.com
 [IPv6:2a00:1450:4864:20::441])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 565AD6E0DC
 for <amd-gfx@lists.freedesktop.org>; Tue,  7 Apr 2020 14:27:31 +0000 (UTC)
Received: by mail-wr1-x441.google.com with SMTP id h15so4126137wrx.9
 for <amd-gfx@lists.freedesktop.org>; Tue, 07 Apr 2020 07:27:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=T0FhXwqW+rIwUrl9rIW7i06/XBe/O/nViwxaWAwZAw8=;
 b=m2PNyi9FvDLgkZZRh3ODzqUmMlW+qpLCl6xSNdcWUE43gL09wCD0pNJgl0dHNh1SKL
 hZ4P/1W+dLVGYgwmV47nY8NJ7aI5zsFQIH+zuMaa+SSA/HVjzTForQ5z1O7D/6oPHHO/
 OJLKfm72lequo+5mf+UCP94YwinrDr/FtSMJpFP885G1RhPHpJO2D2ZVyYXfwiAcP5AF
 S/Vb4VH/Dy69Nn0PkHf6WXDHdYR+ITb0gJMbjeqBQyhNhxakVWHiRlVRNlISFpTe9C0q
 HTG7YtEp86SOwemt3mmxaqE9KYU69o+60Dq796OYR+wxpTu42Q/v0UZ8eLH/3A1vI6XT
 ZHPw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=T0FhXwqW+rIwUrl9rIW7i06/XBe/O/nViwxaWAwZAw8=;
 b=JDaNmanACxYXRi65z+QJdUq4890ZZ67SbPJWZ6ZeHNFNb6owvjBkHjLQUTFOShWgtc
 +Q6nG62On1nrH9tRFjWEGE5VE0OF/9+FkHwdYo4Xda9RXbDF4mvOLHdm1dNRfaKmBt9M
 WiszeSFNwBF6enR6nnFtZtdRB6gYkzW3lXvVs3DvggTLlHDZLQFLA+72vdMUyyxCix2C
 S9HSKIiDvBzWfzLpUJU/7aMcSxUd9rMS6CruywEf+PAF4wrC/4aHqH9VWA5nEe+efXHw
 XP9nqaR33w5Xo6+86Fxmrab/R6NO273576lJvVSljfb2OvhiG2WvA9JmX6sxCP5a9ste
 7KWg==
X-Gm-Message-State: AGi0PuYBAs3FoFft1SBN/FZbQtF+0WQ/A0q3od3pFtAGu5dMGQWkl/+U
 PstqVLl+RCBx4tjSngWY+lbg+o9z
X-Google-Smtp-Source: APiQypIcawm8JnI7s3Pk7dnSDydgoGfNEIPWhZZt/OjbeDBTsJNkPZBetOnuLtMY0s4DfHX7QOVNGw==
X-Received: by 2002:adf:fc01:: with SMTP id i1mr3310017wrr.198.1586269649395; 
 Tue, 07 Apr 2020 07:27:29 -0700 (PDT)
Received: from abel.fritz.box ([2a02:908:1252:fb60:cb4:6800:b8cb:179f])
 by smtp.gmail.com with ESMTPSA id r4sm2733782wrj.57.2020.04.07.07.27.27
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 07 Apr 2020 07:27:28 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: amd-gfx@lists.freedesktop.org, Felix.Kuehling@amd.com, Alex.Sierra@amd.com
Subject: [PATCH 3/4] drm/amdgpu: rename direct to immediate for VM updates
Date: Tue,  7 Apr 2020 16:27:24 +0200
Message-Id: <20200407142725.17668-3-christian.koenig@amd.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200407142725.17668-1-christian.koenig@amd.com>
References: <20200407142725.17668-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

VG8gYXZvaWQgY29uZnVzaW9uIHdpdGggZGlyZWN0IHJpbmcgc3VibWlzc2lvbnMgcmVuYW1lIGJv
dHRvbQpvZiBwaXBlIFZNIHRhYmxlIGNoYW5nZXMgdG8gaW1tZWRpYXRlIHVwZGF0ZXMuCgpTaWdu
ZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+Ci0t
LQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2lkcy5jICAgICB8ICA2ICstLQog
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMgICAgICB8IDYwICsrKysrKysr
KystLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmggICAg
ICB8IDEwICsrLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bV9jcHUuYyAg
fCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtX3NkbWEuYyB8IDIz
ICsrKystLS0tCiA1IGZpbGVzIGNoYW5nZWQsIDUxIGluc2VydGlvbnMoKyksIDUwIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9pZHMu
YyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9pZHMuYwppbmRleCAzYTY3ZjZj
MDQ2ZDQuLmZlOTJkY2Q5NGQ0YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2lkcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9p
ZHMuYwpAQCAtMjgyLDcgKzI4Miw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3ZtaWRfZ3JhYl9yZXNl
cnZlZChzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwKIAkgICAgIWRtYV9mZW5jZV9pc19sYXRlcih1cGRh
dGVzLCAoKmlkKS0+Zmx1c2hlZF91cGRhdGVzKSkKIAkgICAgdXBkYXRlcyA9IE5VTEw7CiAKLQlp
ZiAoKCppZCktPm93bmVyICE9IHZtLT5kaXJlY3QuZmVuY2VfY29udGV4dCB8fAorCWlmICgoKmlk
KS0+b3duZXIgIT0gdm0tPmltbWVkaWF0ZS5mZW5jZV9jb250ZXh0IHx8CiAJICAgIGpvYi0+dm1f
cGRfYWRkciAhPSAoKmlkKS0+cGRfZ3B1X2FkZHIgfHwKIAkgICAgdXBkYXRlcyB8fCAhKCppZCkt
Pmxhc3RfZmx1c2ggfHwKIAkgICAgKCgqaWQpLT5sYXN0X2ZsdXNoLT5jb250ZXh0ICE9IGZlbmNl
X2NvbnRleHQgJiYKQEAgLTM0OSw3ICszNDksNyBAQCBzdGF0aWMgaW50IGFtZGdwdV92bWlkX2dy
YWJfdXNlZChzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwKIAkJc3RydWN0IGRtYV9mZW5jZSAqZmx1c2hl
ZDsKIAogCQkvKiBDaGVjayBhbGwgdGhlIHByZXJlcXVpc2l0ZXMgdG8gdXNpbmcgdGhpcyBWTUlE
ICovCi0JCWlmICgoKmlkKS0+b3duZXIgIT0gdm0tPmRpcmVjdC5mZW5jZV9jb250ZXh0KQorCQlp
ZiAoKCppZCktPm93bmVyICE9IHZtLT5pbW1lZGlhdGUuZmVuY2VfY29udGV4dCkKIAkJCWNvbnRp
bnVlOwogCiAJCWlmICgoKmlkKS0+cGRfZ3B1X2FkZHIgIT0gam9iLT52bV9wZF9hZGRyKQpAQCAt
NDQ4LDcgKzQ0OCw3IEBAIGludCBhbWRncHVfdm1pZF9ncmFiKHN0cnVjdCBhbWRncHVfdm0gKnZt
LCBzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsCiAJfQogCiAJaWQtPnBkX2dwdV9hZGRyID0gam9i
LT52bV9wZF9hZGRyOwotCWlkLT5vd25lciA9IHZtLT5kaXJlY3QuZmVuY2VfY29udGV4dDsKKwlp
ZC0+b3duZXIgPSB2bS0+aW1tZWRpYXRlLmZlbmNlX2NvbnRleHQ7CiAKIAlpZiAoam9iLT52bV9u
ZWVkc19mbHVzaCkgewogCQlkbWFfZmVuY2VfcHV0KGlkLT5sYXN0X2ZsdXNoKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMKaW5kZXggM2IyZTc0ODQxMTM2Li4xZWU4N2I0NjBi
OTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5jCkBAIC03MjYsNyArNzI2
LDcgQEAgYm9vbCBhbWRncHVfdm1fcmVhZHkoc3RydWN0IGFtZGdwdV92bSAqdm0pCiAgKiBAYWRl
djogYW1kZ3B1X2RldmljZSBwb2ludGVyCiAgKiBAdm06IFZNIHRvIGNsZWFyIEJPIGZyb20KICAq
IEBibzogQk8gdG8gY2xlYXIKLSAqIEBkaXJlY3Q6IHVzZSBhIGRpcmVjdCB1cGRhdGUKKyAqIEBp
bW1lZGlhdGU6IHVzZSBhbiBpbW1lZGlhdGUgdXBkYXRlCiAgKgogICogUm9vdCBQRCBuZWVkcyB0
byBiZSByZXNlcnZlZCB3aGVuIGNhbGxpbmcgdGhpcy4KICAqCkBAIC03MzYsNyArNzM2LDcgQEAg
Ym9vbCBhbWRncHVfdm1fcmVhZHkoc3RydWN0IGFtZGdwdV92bSAqdm0pCiBzdGF0aWMgaW50IGFt
ZGdwdV92bV9jbGVhcl9ibyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCSAgICAgIHN0
cnVjdCBhbWRncHVfdm0gKnZtLAogCQkJICAgICAgc3RydWN0IGFtZGdwdV9ibyAqYm8sCi0JCQkg
ICAgICBib29sIGRpcmVjdCkKKwkJCSAgICAgIGJvb2wgaW1tZWRpYXRlKQogewogCXN0cnVjdCB0
dG1fb3BlcmF0aW9uX2N0eCBjdHggPSB7IHRydWUsIGZhbHNlIH07CiAJdW5zaWduZWQgbGV2ZWwg
PSBhZGV2LT52bV9tYW5hZ2VyLnJvb3RfbGV2ZWw7CkBAIC03OTUsNyArNzk1LDcgQEAgc3RhdGlj
IGludCBhbWRncHVfdm1fY2xlYXJfYm8oc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJbWVt
c2V0KCZwYXJhbXMsIDAsIHNpemVvZihwYXJhbXMpKTsKIAlwYXJhbXMuYWRldiA9IGFkZXY7CiAJ
cGFyYW1zLnZtID0gdm07Ci0JcGFyYW1zLmRpcmVjdCA9IGRpcmVjdDsKKwlwYXJhbXMuaW1tZWRp
YXRlID0gaW1tZWRpYXRlOwogCiAJciA9IHZtLT51cGRhdGVfZnVuY3MtPnByZXBhcmUoJnBhcmFt
cywgTlVMTCwgQU1ER1BVX1NZTkNfRVhQTElDSVQpOwogCWlmIChyKQpAQCAtODUwLDExICs4NTAs
MTEgQEAgc3RhdGljIGludCBhbWRncHVfdm1fY2xlYXJfYm8oc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYsCiAgKiBAYWRldjogYW1kZ3B1X2RldmljZSBwb2ludGVyCiAgKiBAdm06IHJlcXVlc3Rp
bmcgdm0KICAqIEBsZXZlbDogdGhlIHBhZ2UgdGFibGUgbGV2ZWwKLSAqIEBkaXJlY3Q6IHVzZSBh
IGRpcmVjdCB1cGRhdGUKKyAqIEBpbW1lZGlhdGU6IHVzZSBhIGltbWVkaWF0ZSB1cGRhdGUKICAq
IEBicDogcmVzdWx0aW5nIEJPIGFsbG9jYXRpb24gcGFyYW1ldGVycwogICovCiBzdGF0aWMgdm9p
ZCBhbWRncHVfdm1fYm9fcGFyYW0oc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHN0cnVjdCBh
bWRncHVfdm0gKnZtLAotCQkJICAgICAgIGludCBsZXZlbCwgYm9vbCBkaXJlY3QsCisJCQkgICAg
ICAgaW50IGxldmVsLCBib29sIGltbWVkaWF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2Jv
X3BhcmFtICpicCkKIHsKIAltZW1zZXQoYnAsIDAsIHNpemVvZigqYnApKTsKQEAgLTg3MCw3ICs4
NzAsNyBAQCBzdGF0aWMgdm9pZCBhbWRncHVfdm1fYm9fcGFyYW0oc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtLAogCWVsc2UgaWYgKCF2bS0+cm9vdC5iYXNl
LmJvIHx8IHZtLT5yb290LmJhc2UuYm8tPnNoYWRvdykKIAkJYnAtPmZsYWdzIHw9IEFNREdQVV9H
RU1fQ1JFQVRFX1NIQURPVzsKIAlicC0+dHlwZSA9IHR0bV9ib190eXBlX2tlcm5lbDsKLQlicC0+
bm9fd2FpdF9ncHUgPSBkaXJlY3Q7CisJYnAtPm5vX3dhaXRfZ3B1ID0gaW1tZWRpYXRlOwogCWlm
ICh2bS0+cm9vdC5iYXNlLmJvKQogCQlicC0+cmVzdiA9IHZtLT5yb290LmJhc2UuYm8tPnRiby5i
YXNlLnJlc3Y7CiB9CkBAIC04ODEsNyArODgxLDcgQEAgc3RhdGljIHZvaWQgYW1kZ3B1X3ZtX2Jv
X3BhcmFtKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwK
ICAqIEBhZGV2OiBhbWRncHVfZGV2aWNlIHBvaW50ZXIKICAqIEB2bTogVk0gdG8gYWxsb2NhdGUg
cGFnZSB0YWJsZXMgZm9yCiAgKiBAY3Vyc29yOiBXaGljaCBwYWdlIHRhYmxlIHRvIGFsbG9jYXRl
Ci0gKiBAZGlyZWN0OiB1c2UgYSBkaXJlY3QgdXBkYXRlCisgKiBAaW1tZWRpYXRlOiB1c2UgYW4g
aW1tZWRpYXRlIHVwZGF0ZQogICoKICAqIE1ha2Ugc3VyZSBhIHNwZWNpZmljIHBhZ2UgdGFibGUg
b3IgZGlyZWN0b3J5IGlzIGFsbG9jYXRlZC4KICAqCkBAIC04OTIsNyArODkyLDcgQEAgc3RhdGlj
IHZvaWQgYW1kZ3B1X3ZtX2JvX3BhcmFtKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1
Y3QgYW1kZ3B1X3ZtICp2bSwKIHN0YXRpYyBpbnQgYW1kZ3B1X3ZtX2FsbG9jX3B0cyhzdHJ1Y3Qg
YW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCSAgICAgICBzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwKIAkJ
CSAgICAgICBzdHJ1Y3QgYW1kZ3B1X3ZtX3B0X2N1cnNvciAqY3Vyc29yLAotCQkJICAgICAgIGJv
b2wgZGlyZWN0KQorCQkJICAgICAgIGJvb2wgaW1tZWRpYXRlKQogewogCXN0cnVjdCBhbWRncHVf
dm1fcHQgKmVudHJ5ID0gY3Vyc29yLT5lbnRyeTsKIAlzdHJ1Y3QgYW1kZ3B1X2JvX3BhcmFtIGJw
OwpAQCAtOTEzLDcgKzkxMyw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3ZtX2FsbG9jX3B0cyhzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAlpZiAoZW50cnktPmJhc2UuYm8pCiAJCXJldHVybiAw
OwogCi0JYW1kZ3B1X3ZtX2JvX3BhcmFtKGFkZXYsIHZtLCBjdXJzb3ItPmxldmVsLCBkaXJlY3Qs
ICZicCk7CisJYW1kZ3B1X3ZtX2JvX3BhcmFtKGFkZXYsIHZtLCBjdXJzb3ItPmxldmVsLCBpbW1l
ZGlhdGUsICZicCk7CiAKIAlyID0gYW1kZ3B1X2JvX2NyZWF0ZShhZGV2LCAmYnAsICZwdCk7CiAJ
aWYgKHIpCkBAIC05MjUsNyArOTI1LDcgQEAgc3RhdGljIGludCBhbWRncHVfdm1fYWxsb2NfcHRz
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCXB0LT5wYXJlbnQgPSBhbWRncHVfYm9fcmVm
KGN1cnNvci0+cGFyZW50LT5iYXNlLmJvKTsKIAlhbWRncHVfdm1fYm9fYmFzZV9pbml0KCZlbnRy
eS0+YmFzZSwgdm0sIHB0KTsKIAotCXIgPSBhbWRncHVfdm1fY2xlYXJfYm8oYWRldiwgdm0sIHB0
LCBkaXJlY3QpOworCXIgPSBhbWRncHVfdm1fY2xlYXJfYm8oYWRldiwgdm0sIHB0LCBpbW1lZGlh
dGUpOwogCWlmIChyKQogCQlnb3RvIGVycm9yX2ZyZWVfcHQ7CiAKQEAgLTEyNzYsNyArMTI3Niw3
IEBAIHN0YXRpYyB2b2lkIGFtZGdwdV92bV9pbnZhbGlkYXRlX3BkcyhzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldiwKICAqCiAgKiBAYWRldjogYW1kZ3B1X2RldmljZSBwb2ludGVyCiAgKiBAdm06
IHJlcXVlc3RlZCB2bQotICogQGRpcmVjdDogc3VibWl0IGRpcmVjdGx5IHRvIHRoZSBwYWdpbmcg
cXVldWUKKyAqIEBpbW1lZGlhdGU6IHN1Ym1pdCBpbW1lZGlhdGVseSB0byB0aGUgcGFnaW5nIHF1
ZXVlCiAgKgogICogTWFrZXMgc3VyZSBhbGwgZGlyZWN0b3JpZXMgYXJlIHVwIHRvIGRhdGUuCiAg
KgpAQCAtMTI4NCw3ICsxMjg0LDcgQEAgc3RhdGljIHZvaWQgYW1kZ3B1X3ZtX2ludmFsaWRhdGVf
cGRzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogICogMCBmb3Igc3VjY2VzcywgZXJyb3Ig
Zm9yIGZhaWx1cmUuCiAgKi8KIGludCBhbWRncHVfdm1fdXBkYXRlX3BkZXMoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsCi0JCQkgIHN0cnVjdCBhbWRncHVfdm0gKnZtLCBib29sIGRpcmVjdCkK
KwkJCSAgc3RydWN0IGFtZGdwdV92bSAqdm0sIGJvb2wgaW1tZWRpYXRlKQogewogCXN0cnVjdCBh
bWRncHVfdm1fdXBkYXRlX3BhcmFtcyBwYXJhbXM7CiAJaW50IHI7CkBAIC0xMjk1LDcgKzEyOTUs
NyBAQCBpbnQgYW1kZ3B1X3ZtX3VwZGF0ZV9wZGVzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
LAogCW1lbXNldCgmcGFyYW1zLCAwLCBzaXplb2YocGFyYW1zKSk7CiAJcGFyYW1zLmFkZXYgPSBh
ZGV2OwogCXBhcmFtcy52bSA9IHZtOwotCXBhcmFtcy5kaXJlY3QgPSBkaXJlY3Q7CisJcGFyYW1z
LmltbWVkaWF0ZSA9IGltbWVkaWF0ZTsKIAogCXIgPSB2bS0+dXBkYXRlX2Z1bmNzLT5wcmVwYXJl
KCZwYXJhbXMsIE5VTEwsIEFNREdQVV9TWU5DX0VYUExJQ0lUKTsKIAlpZiAocikKQEAgLTE0NTEs
NyArMTQ1MSw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3ZtX3VwZGF0ZV9wdGVzKHN0cnVjdCBhbWRn
cHVfdm1fdXBkYXRlX3BhcmFtcyAqcGFyYW1zLAogCQkJICogYWRkcmVzcyByYW5nZSBhcmUgYWN0
dWFsbHkgYWxsb2NhdGVkCiAJCQkgKi8KIAkJCXIgPSBhbWRncHVfdm1fYWxsb2NfcHRzKHBhcmFt
cy0+YWRldiwgcGFyYW1zLT52bSwKLQkJCQkJCSZjdXJzb3IsIHBhcmFtcy0+ZGlyZWN0KTsKKwkJ
CQkJCSZjdXJzb3IsIHBhcmFtcy0+aW1tZWRpYXRlKTsKIAkJCWlmIChyKQogCQkJCXJldHVybiBy
OwogCQl9CkBAIC0xNTU3LDcgKzE1NTcsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV92bV91cGRhdGVf
cHRlcyhzdHJ1Y3QgYW1kZ3B1X3ZtX3VwZGF0ZV9wYXJhbXMgKnBhcmFtcywKICAqCiAgKiBAYWRl
djogYW1kZ3B1X2RldmljZSBwb2ludGVyCiAgKiBAdm06IHJlcXVlc3RlZCB2bQotICogQGRpcmVj
dDogZGlyZWN0IHN1Ym1pc3Npb24gaW4gYSBwYWdlIGZhdWx0CisgKiBAaW1tZWRpYXRlOiBpbW1l
ZGlhdGUgc3VibWlzc2lvbiBpbiBhIHBhZ2UgZmF1bHQKICAqIEByZXN2OiBmZW5jZXMgd2UgbmVl
ZCB0byBzeW5jIHRvCiAgKiBAc3RhcnQ6IHN0YXJ0IG9mIG1hcHBlZCByYW5nZQogICogQGxhc3Q6
IGxhc3QgbWFwcGVkIGVudHJ5CkBAIC0xNTcyLDcgKzE1NzIsNyBAQCBzdGF0aWMgaW50IGFtZGdw
dV92bV91cGRhdGVfcHRlcyhzdHJ1Y3QgYW1kZ3B1X3ZtX3VwZGF0ZV9wYXJhbXMgKnBhcmFtcywK
ICAqIDAgZm9yIHN1Y2Nlc3MsIC1FSU5WQUwgZm9yIGZhaWx1cmUuCiAgKi8KIHN0YXRpYyBpbnQg
YW1kZ3B1X3ZtX2JvX3VwZGF0ZV9tYXBwaW5nKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAot
CQkJCSAgICAgICBzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwgYm9vbCBkaXJlY3QsCisJCQkJICAgICAg
IHN0cnVjdCBhbWRncHVfdm0gKnZtLCBib29sIGltbWVkaWF0ZSwKIAkJCQkgICAgICAgc3RydWN0
IGRtYV9yZXN2ICpyZXN2LAogCQkJCSAgICAgICB1aW50NjRfdCBzdGFydCwgdWludDY0X3QgbGFz
dCwKIAkJCQkgICAgICAgdWludDY0X3QgZmxhZ3MsIHVpbnQ2NF90IGFkZHIsCkBAIC0xNTg2LDcg
KzE1ODYsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV92bV9ib191cGRhdGVfbWFwcGluZyhzdHJ1Y3Qg
YW1kZ3B1X2RldmljZSAqYWRldiwKIAltZW1zZXQoJnBhcmFtcywgMCwgc2l6ZW9mKHBhcmFtcykp
OwogCXBhcmFtcy5hZGV2ID0gYWRldjsKIAlwYXJhbXMudm0gPSB2bTsKLQlwYXJhbXMuZGlyZWN0
ID0gZGlyZWN0OworCXBhcmFtcy5pbW1lZGlhdGUgPSBpbW1lZGlhdGU7CiAJcGFyYW1zLnBhZ2Vz
X2FkZHIgPSBwYWdlc19hZGRyOwogCiAJLyogSW1wbGljaXRseSBzeW5jIHRvIGNvbW1hbmQgc3Vi
bWlzc2lvbnMgaW4gdGhlIHNhbWUgVk0gYmVmb3JlCkBAIC0xNjA2LDggKzE2MDYsOCBAQCBzdGF0
aWMgaW50IGFtZGdwdV92bV9ib191cGRhdGVfbWFwcGluZyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiwKIAlpZiAoZmxhZ3MgJiAoQU1ER1BVX1BURV9WQUxJRCB8IEFNREdQVV9QVEVfUFJUKSkg
ewogCQlzdHJ1Y3QgYW1kZ3B1X2JvICpyb290ID0gdm0tPnJvb3QuYmFzZS5ibzsKIAotCQlpZiAo
IWRtYV9mZW5jZV9pc19zaWduYWxlZCh2bS0+bGFzdF9kaXJlY3QpKQotCQkJYW1kZ3B1X2JvX2Zl
bmNlKHJvb3QsIHZtLT5sYXN0X2RpcmVjdCwgdHJ1ZSk7CisJCWlmICghZG1hX2ZlbmNlX2lzX3Np
Z25hbGVkKHZtLT5sYXN0X2ltbWVkaWF0ZSkpCisJCQlhbWRncHVfYm9fZmVuY2Uocm9vdCwgdm0t
Pmxhc3RfaW1tZWRpYXRlLCB0cnVlKTsKIAl9CiAKIAlyID0gdm0tPnVwZGF0ZV9mdW5jcy0+cHJl
cGFyZSgmcGFyYW1zLCByZXN2LCBzeW5jX21vZGUpOwpAQCAtMjU4OSw3ICsyNTg5LDcgQEAgYm9v
bCBhbWRncHVfdm1fZXZpY3RhYmxlKHN0cnVjdCBhbWRncHVfYm8gKmJvKQogCQlyZXR1cm4gZmFs
c2U7CiAKIAkvKiBEb24ndCBldmljdCBWTSBwYWdlIHRhYmxlcyB3aGlsZSB0aGV5IGFyZSB1cGRh
dGVkICovCi0JaWYgKCFkbWFfZmVuY2VfaXNfc2lnbmFsZWQoYm9fYmFzZS0+dm0tPmxhc3RfZGly
ZWN0KSkgeworCWlmICghZG1hX2ZlbmNlX2lzX3NpZ25hbGVkKGJvX2Jhc2UtPnZtLT5sYXN0X2lt
bWVkaWF0ZSkpIHsKIAkJYW1kZ3B1X3ZtX2V2aWN0aW9uX3VubG9jayhib19iYXNlLT52bSk7CiAJ
CXJldHVybiBmYWxzZTsKIAl9CkBAIC0yNzY2LDcgKzI3NjYsNyBAQCBsb25nIGFtZGdwdV92bV93
YWl0X2lkbGUoc3RydWN0IGFtZGdwdV92bSAqdm0sIGxvbmcgdGltZW91dCkKIAlpZiAodGltZW91
dCA8PSAwKQogCQlyZXR1cm4gdGltZW91dDsKIAotCXJldHVybiBkbWFfZmVuY2Vfd2FpdF90aW1l
b3V0KHZtLT5sYXN0X2RpcmVjdCwgdHJ1ZSwgdGltZW91dCk7CisJcmV0dXJuIGRtYV9mZW5jZV93
YWl0X3RpbWVvdXQodm0tPmxhc3RfaW1tZWRpYXRlLCB0cnVlLCB0aW1lb3V0KTsKIH0KIAogLyoq
CkBAIC0yODAyLDcgKzI4MDIsNyBAQCBpbnQgYW1kZ3B1X3ZtX2luaXQoc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtLAogCiAKIAkvKiBjcmVhdGUgc2NoZWR1
bGVyIGVudGl0aWVzIGZvciBwYWdlIHRhYmxlIHVwZGF0ZXMgKi8KLQlyID0gZHJtX3NjaGVkX2Vu
dGl0eV9pbml0KCZ2bS0+ZGlyZWN0LCBEUk1fU0NIRURfUFJJT1JJVFlfTk9STUFMLAorCXIgPSBk
cm1fc2NoZWRfZW50aXR5X2luaXQoJnZtLT5pbW1lZGlhdGUsIERSTV9TQ0hFRF9QUklPUklUWV9O
T1JNQUwsCiAJCQkJICBhZGV2LT52bV9tYW5hZ2VyLnZtX3B0ZV9zY2hlZHMsCiAJCQkJICBhZGV2
LT52bV9tYW5hZ2VyLnZtX3B0ZV9udW1fc2NoZWRzLCBOVUxMKTsKIAlpZiAocikKQEAgLTI4MTIs
NyArMjgxMiw3IEBAIGludCBhbWRncHVfdm1faW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwgc3RydWN0IGFtZGdwdV92bSAqdm0sCiAJCQkJICBhZGV2LT52bV9tYW5hZ2VyLnZtX3B0ZV9z
Y2hlZHMsCiAJCQkJICBhZGV2LT52bV9tYW5hZ2VyLnZtX3B0ZV9udW1fc2NoZWRzLCBOVUxMKTsK
IAlpZiAocikKLQkJZ290byBlcnJvcl9mcmVlX2RpcmVjdDsKKwkJZ290byBlcnJvcl9mcmVlX2lt
bWVkaWF0ZTsKIAogCXZtLT5wdGVfc3VwcG9ydF9hdHMgPSBmYWxzZTsKIAl2bS0+aXNfY29tcHV0
ZV9jb250ZXh0ID0gZmFsc2U7CkBAIC0yODM4LDcgKzI4MzgsNyBAQCBpbnQgYW1kZ3B1X3ZtX2lu
aXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtLAogCWVs
c2UKIAkJdm0tPnVwZGF0ZV9mdW5jcyA9ICZhbWRncHVfdm1fc2RtYV9mdW5jczsKIAl2bS0+bGFz
dF91cGRhdGUgPSBOVUxMOwotCXZtLT5sYXN0X2RpcmVjdCA9IGRtYV9mZW5jZV9nZXRfc3R1Yigp
OworCXZtLT5sYXN0X2ltbWVkaWF0ZSA9IGRtYV9mZW5jZV9nZXRfc3R1YigpOwogCiAJbXV0ZXhf
aW5pdCgmdm0tPmV2aWN0aW9uX2xvY2spOwogCXZtLT5ldmljdGluZyA9IGZhbHNlOwpAQCAtMjg5
MiwxMSArMjg5MiwxMSBAQCBpbnQgYW1kZ3B1X3ZtX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtLAogCXZtLT5yb290LmJhc2UuYm8gPSBOVUxMOwog
CiBlcnJvcl9mcmVlX2RlbGF5ZWQ6Ci0JZG1hX2ZlbmNlX3B1dCh2bS0+bGFzdF9kaXJlY3QpOwor
CWRtYV9mZW5jZV9wdXQodm0tPmxhc3RfaW1tZWRpYXRlKTsKIAlkcm1fc2NoZWRfZW50aXR5X2Rl
c3Ryb3koJnZtLT5kZWxheWVkKTsKIAotZXJyb3JfZnJlZV9kaXJlY3Q6Ci0JZHJtX3NjaGVkX2Vu
dGl0eV9kZXN0cm95KCZ2bS0+ZGlyZWN0KTsKK2Vycm9yX2ZyZWVfaW1tZWRpYXRlOgorCWRybV9z
Y2hlZF9lbnRpdHlfZGVzdHJveSgmdm0tPmltbWVkaWF0ZSk7CiAKIAlyZXR1cm4gcjsKIH0KQEAg
LTMwOTMsOCArMzA5Myw4IEBAIHZvaWQgYW1kZ3B1X3ZtX2Zpbmkoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtKQogCQl2bS0+cGFzaWQgPSAwOwogCX0KIAot
CWRtYV9mZW5jZV93YWl0KHZtLT5sYXN0X2RpcmVjdCwgZmFsc2UpOwotCWRtYV9mZW5jZV9wdXQo
dm0tPmxhc3RfZGlyZWN0KTsKKwlkbWFfZmVuY2Vfd2FpdCh2bS0+bGFzdF9pbW1lZGlhdGUsIGZh
bHNlKTsKKwlkbWFfZmVuY2VfcHV0KHZtLT5sYXN0X2ltbWVkaWF0ZSk7CiAKIAlsaXN0X2Zvcl9l
YWNoX2VudHJ5X3NhZmUobWFwcGluZywgdG1wLCAmdm0tPmZyZWVkLCBsaXN0KSB7CiAJCWlmICht
YXBwaW5nLT5mbGFncyAmIEFNREdQVV9QVEVfUFJUICYmIHBydF9maW5pX25lZWRlZCkgewpAQCAt
MzExMSw3ICszMTExLDcgQEAgdm9pZCBhbWRncHVfdm1fZmluaShzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqYWRldiwgc3RydWN0IGFtZGdwdV92bSAqdm0pCiAJYW1kZ3B1X2JvX3VucmVmKCZyb290KTsK
IAlXQVJOX09OKHZtLT5yb290LmJhc2UuYm8pOwogCi0JZHJtX3NjaGVkX2VudGl0eV9kZXN0cm95
KCZ2bS0+ZGlyZWN0KTsKKwlkcm1fc2NoZWRfZW50aXR5X2Rlc3Ryb3koJnZtLT5pbW1lZGlhdGUp
OwogCWRybV9zY2hlZF9lbnRpdHlfZGVzdHJveSgmdm0tPmRlbGF5ZWQpOwogCiAJaWYgKCFSQl9F
TVBUWV9ST09UKCZ2bS0+dmEucmJfcm9vdCkpIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X3ZtLmgKaW5kZXggYjUyZWZjNTkxMTYwLi4wYjY0MjAwZWM0NWYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5oCkBAIC0yMDYsOSArMjA2LDkgQEAgc3RydWN0IGFtZGdw
dV92bV91cGRhdGVfcGFyYW1zIHsKIAlzdHJ1Y3QgYW1kZ3B1X3ZtICp2bTsKIAogCS8qKgotCSAq
IEBkaXJlY3Q6IGlmIGNoYW5nZXMgc2hvdWxkIGJlIG1hZGUgZGlyZWN0bHkKKwkgKiBAaW1tZWRp
YXRlOiBpZiBjaGFuZ2VzIHNob3VsZCBiZSBtYWRlIGltbWVkaWF0ZWx5CiAJICovCi0JYm9vbCBk
aXJlY3Q7CisJYm9vbCBpbW1lZGlhdGU7CiAKIAkvKioKIAkgKiBAcGFnZXNfYWRkcjoKQEAgLTI3
NCwxMSArMjc0LDExIEBAIHN0cnVjdCBhbWRncHVfdm0gewogCXN0cnVjdCBkbWFfZmVuY2UJKmxh
c3RfdXBkYXRlOwogCiAJLyogU2NoZWR1bGVyIGVudGl0aWVzIGZvciBwYWdlIHRhYmxlIHVwZGF0
ZXMgKi8KLQlzdHJ1Y3QgZHJtX3NjaGVkX2VudGl0eQlkaXJlY3Q7CisJc3RydWN0IGRybV9zY2hl
ZF9lbnRpdHkJaW1tZWRpYXRlOwogCXN0cnVjdCBkcm1fc2NoZWRfZW50aXR5CWRlbGF5ZWQ7CiAK
IAkvKiBMYXN0IHN1Ym1pc3Npb24gdG8gdGhlIHNjaGVkdWxlciBlbnRpdGllcyAqLwotCXN0cnVj
dCBkbWFfZmVuY2UJKmxhc3RfZGlyZWN0OworCXN0cnVjdCBkbWFfZmVuY2UJKmxhc3RfaW1tZWRp
YXRlOwogCiAJdW5zaWduZWQgaW50CQlwYXNpZDsKIAkvKiBkZWRpY2F0ZWQgdG8gdm0gKi8KQEAg
LTM4Myw3ICszODMsNyBAQCBpbnQgYW1kZ3B1X3ZtX3ZhbGlkYXRlX3B0X2JvcyhzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiwgc3RydWN0IGFtZGdwdV92bSAqdm0sCiAJCQkgICAgICB2b2lkICpw
YXJhbSk7CiBpbnQgYW1kZ3B1X3ZtX2ZsdXNoKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZywgc3Ry
dWN0IGFtZGdwdV9qb2IgKmpvYiwgYm9vbCBuZWVkX3BpcGVfc3luYyk7CiBpbnQgYW1kZ3B1X3Zt
X3VwZGF0ZV9wZGVzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAotCQkJICBzdHJ1Y3QgYW1k
Z3B1X3ZtICp2bSwgYm9vbCBkaXJlY3QpOworCQkJICBzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwgYm9v
bCBpbW1lZGlhdGUpOwogaW50IGFtZGdwdV92bV9jbGVhcl9mcmVlZChzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldiwKIAkJCSAgc3RydWN0IGFtZGdwdV92bSAqdm0sCiAJCQkgIHN0cnVjdCBkbWFf
ZmVuY2UgKipmZW5jZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfdm1fY3B1LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm1fY3B1
LmMKaW5kZXggZTM4NTE2MzA0MDcwLi4zOWM3MDRhMWZiMGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bV9jcHUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfdm1fY3B1LmMKQEAgLTg0LDcgKzg0LDcgQEAgc3RhdGljIGludCBh
bWRncHVfdm1fY3B1X3VwZGF0ZShzdHJ1Y3QgYW1kZ3B1X3ZtX3VwZGF0ZV9wYXJhbXMgKnAsCiAK
IAlwZSArPSAodW5zaWduZWQgbG9uZylhbWRncHVfYm9fa3B0cihibyk7CiAKLQl0cmFjZV9hbWRn
cHVfdm1fc2V0X3B0ZXMocGUsIGFkZHIsIGNvdW50LCBpbmNyLCBmbGFncywgcC0+ZGlyZWN0KTsK
Kwl0cmFjZV9hbWRncHVfdm1fc2V0X3B0ZXMocGUsIGFkZHIsIGNvdW50LCBpbmNyLCBmbGFncywg
cC0+aW1tZWRpYXRlKTsKIAogCWZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAJCXZhbHVl
ID0gcC0+cGFnZXNfYWRkciA/CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfdm1fc2RtYS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Zt
X3NkbWEuYwppbmRleCBiOTZjOGQ5YTE5NDYuLmM3OGJjZWJkOTM3OCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtX3NkbWEuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm1fc2RtYS5jCkBAIC02MSw4ICs2MSw4IEBAIHN0YXRp
YyBpbnQgYW1kZ3B1X3ZtX3NkbWFfcHJlcGFyZShzdHJ1Y3QgYW1kZ3B1X3ZtX3VwZGF0ZV9wYXJh
bXMgKnAsCiAJCQkJICBzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YsCiAJCQkJICBlbnVtIGFtZGdwdV9z
eW5jX21vZGUgc3luY19tb2RlKQogewotCWVudW0gYW1kZ3B1X2liX3Bvb2xfdHlwZSBwb29sID0g
cC0+ZGlyZWN0ID8gQU1ER1BVX0lCX1BPT0xfSU1NRURJQVRFIDoKLQkJQU1ER1BVX0lCX1BPT0xf
REVMQVlFRDsKKwllbnVtIGFtZGdwdV9pYl9wb29sX3R5cGUgcG9vbCA9IHAtPmltbWVkaWF0ZSA/
IEFNREdQVV9JQl9QT09MX0lNTUVESUFURQorCQk6IEFNREdQVV9JQl9QT09MX0RFTEFZRUQ7CiAJ
dW5zaWduZWQgaW50IG5kdyA9IEFNREdQVV9WTV9TRE1BX01JTl9OVU1fRFc7CiAJaW50IHI7CiAK
QEAgLTk2LDcgKzk2LDcgQEAgc3RhdGljIGludCBhbWRncHVfdm1fc2RtYV9jb21taXQoc3RydWN0
IGFtZGdwdV92bV91cGRhdGVfcGFyYW1zICpwLAogCXN0cnVjdCBhbWRncHVfcmluZyAqcmluZzsK
IAlpbnQgcjsKIAotCWVudGl0eSA9IHAtPmRpcmVjdCA/ICZwLT52bS0+ZGlyZWN0IDogJnAtPnZt
LT5kZWxheWVkOworCWVudGl0eSA9IHAtPmltbWVkaWF0ZSA/ICZwLT52bS0+aW1tZWRpYXRlIDog
JnAtPnZtLT5kZWxheWVkOwogCXJpbmcgPSBjb250YWluZXJfb2YoZW50aXR5LT5ycS0+c2NoZWQs
IHN0cnVjdCBhbWRncHVfcmluZywgc2NoZWQpOwogCiAJV0FSTl9PTihpYi0+bGVuZ3RoX2R3ID09
IDApOwpAQCAtMTA2LDE1ICsxMDYsMTYgQEAgc3RhdGljIGludCBhbWRncHVfdm1fc2RtYV9jb21t
aXQoc3RydWN0IGFtZGdwdV92bV91cGRhdGVfcGFyYW1zICpwLAogCWlmIChyKQogCQlnb3RvIGVy
cm9yOwogCi0JaWYgKHAtPmRpcmVjdCkgeworCWlmIChwLT5pbW1lZGlhdGUpIHsKIAkJdG1wID0g
ZG1hX2ZlbmNlX2dldChmKTsKLQkJc3dhcChwLT52bS0+bGFzdF9kaXJlY3QsIHRtcCk7CisJCXN3
YXAocC0+dm0tPmxhc3RfaW1tZWRpYXRlLCBmKTsKIAkJZG1hX2ZlbmNlX3B1dCh0bXApOwogCX0g
ZWxzZSB7Ci0JCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UocC0+dm0tPnJvb3QuYmFzZS5iby0+
dGJvLmJhc2UucmVzdiwgZik7CisJCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UocC0+dm0tPnJv
b3QuYmFzZS5iby0+dGJvLmJhc2UucmVzdiwKKwkJCQkJICBmKTsKIAl9CiAKLQlpZiAoZmVuY2Ug
JiYgIXAtPmRpcmVjdCkKKwlpZiAoZmVuY2UgJiYgIXAtPmltbWVkaWF0ZSkKIAkJc3dhcCgqZmVu
Y2UsIGYpOwogCWRtYV9mZW5jZV9wdXQoZik7CiAJcmV0dXJuIDA7CkBAIC0xNDQsNyArMTQ1LDcg
QEAgc3RhdGljIHZvaWQgYW1kZ3B1X3ZtX3NkbWFfY29weV9wdGVzKHN0cnVjdCBhbWRncHVfdm1f
dXBkYXRlX3BhcmFtcyAqcCwKIAlzcmMgKz0gcC0+bnVtX2R3X2xlZnQgKiA0OwogCiAJcGUgKz0g
YW1kZ3B1X2dtY19zaWduX2V4dGVuZChiby0+dGJvLm9mZnNldCk7Ci0JdHJhY2VfYW1kZ3B1X3Zt
X2NvcHlfcHRlcyhwZSwgc3JjLCBjb3VudCwgcC0+ZGlyZWN0KTsKKwl0cmFjZV9hbWRncHVfdm1f
Y29weV9wdGVzKHBlLCBzcmMsIGNvdW50LCBwLT5pbW1lZGlhdGUpOwogCiAJYW1kZ3B1X3ZtX2Nv
cHlfcHRlKHAtPmFkZXYsIGliLCBwZSwgc3JjLCBjb3VudCk7CiB9CkBAIC0xNzEsNyArMTcyLDcg
QEAgc3RhdGljIHZvaWQgYW1kZ3B1X3ZtX3NkbWFfc2V0X3B0ZXMoc3RydWN0IGFtZGdwdV92bV91
cGRhdGVfcGFyYW1zICpwLAogCXN0cnVjdCBhbWRncHVfaWIgKmliID0gcC0+am9iLT5pYnM7CiAK
IAlwZSArPSBhbWRncHVfZ21jX3NpZ25fZXh0ZW5kKGJvLT50Ym8ub2Zmc2V0KTsKLQl0cmFjZV9h
bWRncHVfdm1fc2V0X3B0ZXMocGUsIGFkZHIsIGNvdW50LCBpbmNyLCBmbGFncywgcC0+ZGlyZWN0
KTsKKwl0cmFjZV9hbWRncHVfdm1fc2V0X3B0ZXMocGUsIGFkZHIsIGNvdW50LCBpbmNyLCBmbGFn
cywgcC0+aW1tZWRpYXRlKTsKIAlpZiAoY291bnQgPCAzKSB7CiAJCWFtZGdwdV92bV93cml0ZV9w
dGUocC0+YWRldiwgaWIsIHBlLCBhZGRyIHwgZmxhZ3MsCiAJCQkJICAgIGNvdW50LCBpbmNyKTsK
QEAgLTIwMCw4ICsyMDEsOCBAQCBzdGF0aWMgaW50IGFtZGdwdV92bV9zZG1hX3VwZGF0ZShzdHJ1
Y3QgYW1kZ3B1X3ZtX3VwZGF0ZV9wYXJhbXMgKnAsCiAJCQkJIHVpbnQ2NF90IGFkZHIsIHVuc2ln
bmVkIGNvdW50LCB1aW50MzJfdCBpbmNyLAogCQkJCSB1aW50NjRfdCBmbGFncykKIHsKLQllbnVt
IGFtZGdwdV9pYl9wb29sX3R5cGUgcG9vbCA9IHAtPmRpcmVjdCA/IEFNREdQVV9JQl9QT09MX0lN
TUVESUFURSA6Ci0JCUFNREdQVV9JQl9QT09MX0RFTEFZRUQ7CisJZW51bSBhbWRncHVfaWJfcG9v
bF90eXBlIHBvb2wgPSBwLT5pbW1lZGlhdGUgPyBBTURHUFVfSUJfUE9PTF9JTU1FRElBVEUKKwkJ
OiBBTURHUFVfSUJfUE9PTF9ERUxBWUVEOwogCXVuc2lnbmVkIGludCBpLCBuZHcsIG5wdGVzOwog
CXVpbnQ2NF90ICpwdGU7CiAJaW50IHI7Ci0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vYW1kLWdmeAo=
