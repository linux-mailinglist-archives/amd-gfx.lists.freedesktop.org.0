Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3A8A021B916
	for <lists+amd-gfx@lfdr.de>; Fri, 10 Jul 2020 17:08:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D4D486E05C;
	Fri, 10 Jul 2020 15:08:01 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM10-BN7-obe.outbound.protection.outlook.com
 (mail-bn7nam10on2079.outbound.protection.outlook.com [40.107.92.79])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4A5BC6E05C
 for <amd-gfx@lists.freedesktop.org>; Fri, 10 Jul 2020 15:07:59 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=mxpYIwpXSkn/1IghluWK8cFnskXXRRXyKCPx4EJTEjRI/NvCHQ09qtdfMjKGCUF9lGQPNluPq09Kvh94vjDyb03Y3Wp23llVw3J+WZJQj4Irwa8qT4D93ZokQ7uflYXI9uXPLDSHg2J9Q6FfJFZV/cpCeg7a3y8ImfOL027NhaGR29iDhJ0oWkIMXmrzBapFzUyoUr10rt/oOcXX1B1M8xi6F2ZqIERW0hgKiB2HUEeIVqtu+A4wfkwdyORQfqw2YY7YOMG9jr9wRxpUZWna3ASziEDU9dUd5LzA5Ahd9XSPnVpCMqzBHMrAN0XMO7QQMZRzN2OmWinwgo04a+xMdg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=WZZfOc+iG/wMswCuRzPgcMf4Q7SrnyUrE1i+5LXtTE0=;
 b=aHBf+hKQ2dDRbtp7UV1q9vATWeDTDHwbBFa0leBG1jQ1s1aZQb0V9jA7vvjsSWpuuAZDcURz2kAHLAIeIk5LOoPR3/kYfOKK0Ucfh/2AlMJjh+QL6O8B66wmhNZkuLv+cNwr00/oU/MzHgHwOX8kr6qwKE3z13Oa+fduyDRBo4Cgh3r9him89UwLC+WyeppKPPY6XIDsLygTdUuR6ZOrBn2LgQh2SLekPmAwhngFBbeKrtgTF7vvsC2Gi2aDIoIUrQq7/yO3iaodwQQBTxfS1QYQ20/ZqVH/9nPqPbU83dabM1aqjNneHD7MJrO9GLJD0DVGBXCwmDQt70NeSuum+g==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector2-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=WZZfOc+iG/wMswCuRzPgcMf4Q7SrnyUrE1i+5LXtTE0=;
 b=sDaSR+hFxHJgUovIYj3NquBpO2HMC91cLxEkHdKPGyKbIywFFwqjkw4EffSm3195K8EPw0csKiYHYhVz6obXc7WsmgsGP8//SIa5Ns5JTTx+NZjvyYIGkgK2nI9BIUup5fIBlofd289K1Nmdt4rORNJpQLz4a0Rd9/R+nWLp/ck=
Authentication-Results: amd.com; dkim=none (message not signed)
 header.d=none;amd.com; dmarc=none action=none header.from=amd.com;
Received: from DM6PR12MB4340.namprd12.prod.outlook.com (2603:10b6:5:2a8::7) by
 DM6PR12MB3740.namprd12.prod.outlook.com (2603:10b6:5:1c3::13) with
 Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.3174.22; Fri, 10 Jul 2020 15:07:52 +0000
Received: from DM6PR12MB4340.namprd12.prod.outlook.com
 ([fe80::f5e6:e937:2eac:18cf]) by DM6PR12MB4340.namprd12.prod.outlook.com
 ([fe80::f5e6:e937:2eac:18cf%3]) with mapi id 15.20.3174.023; Fri, 10 Jul 2020
 15:07:52 +0000
Subject: Re: [PATCH v2] drm/amdgpu: fix system hang issue during GPU reset
To: Dennis Li <Dennis.Li@amd.com>, amd-gfx@lists.freedesktop.org,
 Alexander.Deucher@amd.com, Tao.Zhou1@amd.com, Hawking.Zhang@amd.com,
 Guchun.Chen@amd.com, "Koenig, Christian" <Christian.Koenig@amd.com>
References: <20200708074800.10093-1-Dennis.Li@amd.com>
From: Andrey Grodzovsky <Andrey.Grodzovsky@amd.com>
Message-ID: <9b37bb53-1579-9a68-3317-e51f4e38f26f@amd.com>
Date: Fri, 10 Jul 2020 11:07:50 -0400
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.4.0
In-Reply-To: <20200708074800.10093-1-Dennis.Li@amd.com>
Content-Language: en-US
X-ClientProxiedBy: YTXPR0101CA0063.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:1::40) To DM6PR12MB4340.namprd12.prod.outlook.com
 (2603:10b6:5:2a8::7)
MIME-Version: 1.0
X-MS-Exchange-MessageSentRepresentingType: 1
Received: from [172.27.231.243] (165.204.55.251) by
 YTXPR0101CA0063.CANPRD01.PROD.OUTLOOK.COM (2603:10b6:b00:1::40) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3174.22 via Frontend
 Transport; Fri, 10 Jul 2020 15:07:51 +0000
X-Originating-IP: [165.204.55.251]
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-HT: Tenant
X-MS-Office365-Filtering-Correlation-Id: 1ad8a953-ce5f-43da-f592-08d824e303f7
X-MS-TrafficTypeDiagnostic: DM6PR12MB3740:
X-MS-Exchange-Transport-Forked: True
X-Microsoft-Antispam-PRVS: <DM6PR12MB374003A22A5FC21DBEBAF463EA650@DM6PR12MB3740.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:2000;
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam: BCL:0;
X-Microsoft-Antispam-Message-Info: V/V+JOorLK6CtFWZUVDMLHrULFX0UpsnF8n41kjKObWp49zb/wYD0Ce2D2/KGfnxDSwfj72KJlRJvo3i1O6yToBNq9OdQBiozx48n9rvIMGhuEhYMWV5TWIhsxTtHiydb/U1RNhMjZQ4gVV3piL0yX/5ENlZl5aEKuN/yvAVbL+Qap2ZZXggO2AjSuqLOHD1gaqXaO/gbXajEJkQaks6uEN+6yNkFs8DuKkH18hqMOuVRQz4weYTZdmmsI/Q/aT8y79l0QBSe6X+7NkIC7zZjz6xjAp0F6ycEIsvDEVjGMjawSDcLyGHf/MdXsWm9Tnf0l7Od1BzYRlcwNWj0XA+YDIHkICHJDyK++B1unLznajsgLjvzP83tkIR+06/pX7S
X-Forefront-Antispam-Report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:DM6PR12MB4340.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFTY:;
 SFS:(4636009)(376002)(136003)(39860400002)(366004)(396003)(346002)(31696002)(26005)(31686004)(478600001)(86362001)(52116002)(6636002)(956004)(2616005)(186003)(2906002)(53546011)(16526019)(83380400001)(30864003)(8936002)(8676002)(5660300002)(66556008)(6486002)(66476007)(316002)(16576012)(66946007)(36756003)(110136005)(43740500002)(579004)(559001);
 DIR:OUT; SFP:1101; 
X-MS-Exchange-AntiSpam-MessageData: vFpm3ePWtNBk/X6gx+DzGvpdD1qw2IQSR+Mhh15yIzw8vH/+K2ROgM3tCf5MP/XxF8ijGzeCLD7BHObNUYCmyUEQJGpwvvMbvlxXMxt/2y0ndL8DSVbJlKSOVNEmn7JbAl5A33iOIJ6XZWSSEF8PVJZoQC1B/opOlmDRv2dJJ99S30w4gs5XKOMCgRMANw+O1TA0adM/lF6ILpSgThNa8cANaPj6EfEibW3/6Dqm99suRcGng+adwY/ND8amowXRStSjEt1A0ON9CZO5GRsmKvVZXDU84r/b61CVvtvCTyI+bcapQP7qtamf6/aGtQP8C2C26lhMxpARO8AS0XEszEWN101YRDKrZRlc/GxT2PjvZ80FWLd4FISVj+X8Q9F1b3dtKoYVDQg9ThL0LvDIdvGI0amybtkyxQuoqptEM+c1nzt/tOfsDPFmmb537BFYgpeWLOcEp0KC8XScQVCraAZXzGYNkXGFioI7J7KjIdx0B273cP+A7/HYeDe8wRyw
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 1ad8a953-ce5f-43da-f592-08d824e303f7
X-MS-Exchange-CrossTenant-AuthSource: DM6PR12MB4340.namprd12.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 10 Jul 2020 15:07:51.8699 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: b8aO4h19Mnh9Q60lEyNhswzhgMMT7Q+j2ZNUIrmIRyRmw0YR/5oLURgS/NQQNxA/ZBsTo+amrnaRz6hy6yX+jg==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB3740
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

Ck9uIDcvOC8yMCAzOjQ4IEFNLCBEZW5uaXMgTGkgd3JvdGU6Cj4gRHVyaW5nIEdQVSByZXNldCwg
ZHJpdmVyIHNob3VsZCBob2xkIG9uIGFsbCBleHRlcm5hbCBhY2Nlc3MgdG8KPiBHUFUsIG90aGVy
d2lzZSBwc3Agd2lsbCByYW5kb21seSBmYWlsIHRvIGRvIHBvc3QsIGFuZCB0aGVuIGNhdXNlCj4g
c3lzdGVtIGhhbmcuCj4KPiB2MjoKPiAxLiBhZGQgcndsb2NrIGZvciBzb21lIGlvY3RscywgZGVi
dWdmcyBhbmQgZmlsZS1jbG9zZSBmdW5jdGlvbi4KPiAyLiBjaGFuZ2UgdG8gdXNlIGRxbS0+aXNf
cmVzZXR0aW5nIGFuZCBkcW1fbG9jayBmb3IgcHJvdGVjdGlvbiBpbiBrZmQKPiBkcml2ZXIuCj4g
My4gcmVtb3ZlIHRyeV9sb2NrIGFuZCBjaGFuZ2UgYWRldi0+aW5fZ3B1X3Jlc2V0IGFzIGF0b21p
YywgdG8gYXZvaWQKPiByZS1lbnRlciBHUFUgcmVjb3ZlcnkgZm9yIHRoZSBzYW1lIEdQVSBoYW5n
LgoKClN0aWxsIGFkZXYtPmluX2dwdV9yZXNldCBpcyBwcm9uZSB0byByYWNlLCBubyA/IEkgbWVh
biBpZiB0aGUgcmVzZXQgc3RhcnRzIHJpZ2h0IEFGVEVSIHdlIGNoZWNrZWQgZm9yIHRoZSBmbGFn
IHZhbHVlIHRoZW4gd2Ugc3RpbGwgaGF2ZSBhIHByb2JsZW0uCgpJIHJlY2VudGx5IHdvcmtlZCAo
YW5kIHN0aWxsIGRvKSBvbiBkZXZpY2UgdW5wbHVnIHN1cHBvcnQsIEkgd2FzIHRoaW5raW5nIC0g
Y2FuIHdlIHVzZSBzb21ldGhpbmcgYWxpa2UgZHJtX2Rldl9lbnRlci9kcm1fZGV2X2V4aXQgYW5k
IGRybV9kZXZfdW5wbHVnIGZvciBvdXIgY2F1c2UgYW5kIHRoaXMgd291bGQgcmVwbGFjZSBib3Ro
IGFkZXYtPmluX2dwdV9yZXNldCBhbmQgdGhlIGxvY2tfcmVzZXQgbXV0ZXgob3Igcndfc2VtYXBo
b3RlKSA/IEluIG91ciBjYXNlIHdlIGFsc28gd291bGQgbmVlZCBhICAnZHJtX2Rldl9wbHVnX2Jh
Y2snIGZ1bmN0aW9uIHRvby4gTWF5YmUgd2UgY2FuIGV2ZW4gdXNlIHRoZSBleGlzdGluZyBkcm0g
aGVscGVycyBhcyBpcyBhcyBiZWNhdXNlIHdoaWxlIGRldmljZSBpcyBiZWluZyByZXNldCBpdCdz
IGVmZmVjdGl2ZWx5IHRoZSBzYW1lIGFzIGlmIGl0J3MgdW5wbHVnZ2VkIGkgdGhpbmsuLi4KClNv
bWUgbW9yZSBiZWxsb3cKCj4KPiBTaWduZWQtb2ZmLWJ5OiBEZW5uaXMgTGkgPERlbm5pcy5MaUBh
bWQuY29tPgo+IENoYW5nZS1JZDogSTdmNzdhNzI3OTU0NjI1ODdlZDdkNWY1MWZlNTNhNTk0YTBm
MWY3MDgKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUu
aCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5oCj4gaW5kZXggODBmMzJiM2Jl
Yjg4Li5mMjM1NDkyNzk5ZDcgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaAo+
IEBAIC05NjMsOSArOTYzLDkgQEAgc3RydWN0IGFtZGdwdV9kZXZpY2Ugewo+ICAgCWJvb2wgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaW5fc3VzcGVuZDsKPiAgIAlib29sCQkJCWluX2hpYmVy
bmF0ZTsKPiAgIAo+IC0JYm9vbCAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbl9ncHVfcmVz
ZXQ7Cj4gKwlhdG9taWNfdCAgICAgICAgICAgICAgICAgICAgICAgIGluX2dwdV9yZXNldDsKPiAg
IAllbnVtIHBwX21wMV9zdGF0ZSAgICAgICAgICAgICAgIG1wMV9zdGF0ZTsKPiAtCXN0cnVjdCBt
dXRleCAgbG9ja19yZXNldDsKPiArCXN0cnVjdCByd19zZW1hcGhvcmUJcmVzZXRfc2VtOwo+ICAg
CXN0cnVjdCBhbWRncHVfZG9vcmJlbGxfaW5kZXggZG9vcmJlbGxfaW5kZXg7Cj4gICAKPiAgIAlz
dHJ1Y3QgbXV0ZXgJCQlub3RpZmllcl9sb2NrOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92MTAuYyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3YxMC5jCj4gaW5kZXggNjkxYzg5NzA1YmNkLi5h
ZjcxZDhlOTMwODEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2FtZGtmZF9nZnhfdjEwLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfYW1ka2ZkX2dmeF92MTAuYwo+IEBAIC01NDMsNyArNTQzLDcgQEAgc3RhdGljIGludCBr
Z2RfaHFkX2Rlc3Ryb3koc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFkLAo+ICAgCXVpbnQz
Ml90IHRlbXA7Cj4gICAJc3RydWN0IHYxMF9jb21wdXRlX21xZCAqbSA9IGdldF9tcWQobXFkKTsK
PiAgIAo+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRl
di0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJuIC1FSU87Cj4gICAKPiAgICNpZiAwCj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y3
LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92Ny5jCj4g
aW5kZXggMGI3ZTc4NzQ4NTQwLi43NTBhODMwOGM4NjggMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjcuYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y3LmMKPiBAQCAtNDI1LDcgKzQy
NSw3IEBAIHN0YXRpYyBpbnQga2dkX2hxZF9kZXN0cm95KHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZv
aWQgKm1xZCwKPiAgIAl1bnNpZ25lZCBsb25nIGZsYWdzLCBlbmRfamlmZmllczsKPiAgIAlpbnQg
cmV0cnk7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3Jl
YWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRUlPOwo+ICAgCj4gICAJYWNx
dWlyZV9xdWV1ZShrZ2QsIHBpcGVfaWQsIHF1ZXVlX2lkKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjguYyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y4LmMKPiBpbmRleCBjY2Q2MzViODEy
YjUuLjAyNzc5M2UwYzFjYSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfYW1ka2ZkX2dmeF92OC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjguYwo+IEBAIC00MjEsNyArNDIxLDcgQEAgc3RhdGljIGlu
dCBrZ2RfaHFkX2Rlc3Ryb3koc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFkLAo+ICAgCWlu
dCByZXRyeTsKPiAgIAlzdHJ1Y3QgdmlfbXFkICptID0gZ2V0X21xZChtcWQpOwo+ICAgCj4gLQlp
ZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVJTzsKPiAgIAo+ICAgCWFjcXVpcmVfcXVldWUoa2dkLCBw
aXBlX2lkLCBxdWV1ZV9pZCk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y5LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfYW1ka2ZkX2dmeF92OS5jCj4gaW5kZXggZGY4NDFjMmFjNWU3Li5lNGE3N2Y3YTRjMmQg
MTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9n
ZnhfdjkuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRf
Z2Z4X3Y5LmMKPiBAQCAtNTQxLDcgKzU0MSw3IEBAIGludCBrZ2RfZ2Z4X3Y5X2hxZF9kZXN0cm95
KHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQgKm1xZCwKPiAgIAl1aW50MzJfdCB0ZW1wOwo+ICAg
CXN0cnVjdCB2OV9tcWQgKm0gPSBnZXRfbXFkKG1xZCk7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9n
cHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJ
CXJldHVybiAtRUlPOwo+ICAgCj4gICAJYWNxdWlyZV9xdWV1ZShrZ2QsIHBpcGVfaWQsIHF1ZXVl
X2lkKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Nz
LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3MuYwo+IGluZGV4IGZmYmNh
ZjRiZmI4Yi4uYTk0YjNmODYyZmMyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9jcy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2NzLmMKPiBAQCAtMTI5Miw2ICsxMjkyLDggQEAgaW50IGFtZGdwdV9jc19pb2N0bChzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbHApCj4g
ICAJcGFyc2VyLmFkZXYgPSBhZGV2Owo+ICAgCXBhcnNlci5maWxwID0gZmlscDsKPiAgIAo+ICsJ
ZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlyID0gYW1kZ3B1X2NzX3BhcnNl
cl9pbml0KCZwYXJzZXIsIGRhdGEpOwo+ICAgCWlmIChyKSB7Cj4gICAJCURSTV9FUlJPUigiRmFp
bGVkIHRvIGluaXRpYWxpemUgcGFyc2VyICVkIVxuIiwgcik7Cj4gQEAgLTEzMzEsNiArMTMzMyw4
IEBAIGludCBhbWRncHVfY3NfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwgc3RydWN0IGRybV9maWxlICpmaWxwKQo+ICAgb3V0Ogo+ICAgCWFtZGdwdV9jc19wYXJzZXJf
ZmluaSgmcGFyc2VyLCByLCByZXNlcnZlZF9idWZmZXJzKTsKPiAgIAo+ICsJdXBfcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPiArCj4gICAJcmV0dXJuIHI7Cj4gICB9Cj4gICAKPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2N0eC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2N0eC5jCj4gaW5kZXggODg0MmM1NWQ0NDkwLi5kODVkMTNm
N2EwNDMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2N0
eC5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2N0eC5jCj4gQEAg
LTM1OCw2ICszNTgsOCBAQCBzdGF0aWMgaW50IGFtZGdwdV9jdHhfcXVlcnkyKHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2LAo+ICAgCWlmIChhdG9taWNfcmVhZCgmY3R4LT5ndWlsdHkpKQo+ICAg
CQlvdXQtPnN0YXRlLmZsYWdzIHw9IEFNREdQVV9DVFhfUVVFUlkyX0ZMQUdTX0dVSUxUWTsKPiAg
IAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAkvKnF1ZXJ5IHVlIGNv
dW50Ki8KPiAgIAlyYXNfY291bnRlciA9IGFtZGdwdV9yYXNfcXVlcnlfZXJyb3JfY291bnQoYWRl
diwgZmFsc2UpOwo+ICAgCS8qcmFzIGNvdW50ZXIgaXMgbW9ub3RvbmljIGluY3JlYXNpbmcqLwo+
IEBAIC0zNzMsNiArMzc1LDggQEAgc3RhdGljIGludCBhbWRncHVfY3R4X3F1ZXJ5MihzdHJ1Y3Qg
YW1kZ3B1X2RldmljZSAqYWRldiwKPiAgIAkJY3R4LT5yYXNfY291bnRlcl9jZSA9IHJhc19jb3Vu
dGVyOwo+ICAgCX0KPiAgIAo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJ
bXV0ZXhfdW5sb2NrKCZtZ3ItPmxvY2spOwo+ICAgCXJldHVybiAwOwo+ICAgfQo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGVidWdmcy5jIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RlYnVnZnMuYwo+IGluZGV4IGFlYWRhN2M5ZmJl
YS4uZWNiZmY1MzJhMjFiIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9kZWJ1Z2ZzLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfZGVidWdmcy5jCj4gQEAgLTEwMCwxNCArMTAwLDE0IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2Rl
YnVnZnNfYXV0b2R1bXBfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmls
ZSkKPiAgIAo+ICAgCWZpbGUtPnByaXZhdGVfZGF0YSA9IGFkZXY7Cj4gICAKPiAtCW11dGV4X2xv
Y2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+
ICAgCWlmIChhZGV2LT5hdXRvZHVtcC5kdW1waW5nLmRvbmUpIHsKPiAgIAkJcmVpbml0X2NvbXBs
ZXRpb24oJmFkZXYtPmF1dG9kdW1wLmR1bXBpbmcpOwo+ICAgCQlyZXQgPSAwOwo+ICAgCX0gZWxz
ZSB7Cj4gICAJCXJldCA9IC1FQlVTWTsKPiAgIAl9Cj4gLQltdXRleF91bmxvY2soJmFkZXYtPmxv
Y2tfcmVzZXQpOwo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAgIAo+ICAgCXJldHVy
biByZXQ7Cj4gICB9Cj4gQEAgLTEyNiw3ICsxMjYsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGFt
ZGdwdV9kZWJ1Z2ZzX2F1dG9kdW1wX3BvbGwoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCBwb2xs
Xwo+ICAgCj4gICAJcG9sbF93YWl0KGZpbGUsICZhZGV2LT5hdXRvZHVtcC5ncHVfaGFuZywgcG9s
bF90YWJsZSk7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWlj
X3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiBQT0xMSU4gfCBQT0xMUkRO
T1JNIHwgUE9MTFdSTk9STTsKPiAgIAo+ICAgCXJldHVybiAwOwo+IEBAIC0xMTg4LDcgKzExODgs
NyBAQCBzdGF0aWMgaW50IGFtZGdwdV9kZWJ1Z2ZzX3Rlc3RfaWIoc3RydWN0IHNlcV9maWxlICpt
LCB2b2lkICpkYXRhKQo+ICAgCX0KPiAgIAo+ICAgCS8qIEF2b2lkIGFjY2lkZW50bHkgdW5wYXJr
aW5nIHRoZSBzY2hlZCB0aHJlYWQgZHVyaW5nIEdQVSByZXNldCAqLwo+IC0JbXV0ZXhfbG9jaygm
YWRldi0+bG9ja19yZXNldCk7Cj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAK
PiAgIAkvKiBob2xkIG9uIHRoZSBzY2hlZHVsZXIgKi8KPiAgIAlmb3IgKGkgPSAwOyBpIDwgQU1E
R1BVX01BWF9SSU5HUzsgaSsrKSB7Cj4gQEAgLTEyMTUsNyArMTIxNSw3IEBAIHN0YXRpYyBpbnQg
YW1kZ3B1X2RlYnVnZnNfdGVzdF9pYihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4g
ICAJCWt0aHJlYWRfdW5wYXJrKHJpbmctPnNjaGVkLnRocmVhZCk7Cj4gICAJfQo+ICAgCj4gLQlt
dXRleF91bmxvY2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPiAgIAo+ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGV2LT5kZXYpOwo+ICAg
CXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRldi0+ZGV2KTsKPiBAQCAtMTM5NSw3ICsxMzk1
LDcgQEAgc3RhdGljIGludCBhbWRncHVfZGVidWdmc19pYl9wcmVlbXB0KHZvaWQgKmRhdGEsIHU2
NCB2YWwpCj4gICAJCXJldHVybiAtRU5PTUVNOwo+ICAgCj4gICAJLyogQXZvaWQgYWNjaWRlbnRs
eSB1bnBhcmtpbmcgdGhlIHNjaGVkIHRocmVhZCBkdXJpbmcgR1BVIHJlc2V0ICovCj4gLQltdXRl
eF9sb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2Vt
KTsKPiAgIAo+ICAgCS8qIHN0b3AgdGhlIHNjaGVkdWxlciAqLwo+ICAgCWt0aHJlYWRfcGFyayhy
aW5nLT5zY2hlZC50aHJlYWQpOwo+IEBAIC0xNDM2LDcgKzE0MzYsNyBAQCBzdGF0aWMgaW50IGFt
ZGdwdV9kZWJ1Z2ZzX2liX3ByZWVtcHQodm9pZCAqZGF0YSwgdTY0IHZhbCkKPiAgIAkvKiByZXN0
YXJ0IHRoZSBzY2hlZHVsZXIgKi8KPiAgIAlrdGhyZWFkX3VucGFyayhyaW5nLT5zY2hlZC50aHJl
YWQpOwo+ICAgCj4gLQltdXRleF91bmxvY2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+ICsJdXBfcmVh
ZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAgIAo+ICAgCXR0bV9ib191bmxvY2tfZGVsYXllZF93b3Jr
cXVldWUoJmFkZXYtPm1tYW4uYmRldiwgcmVzY2hlZCk7Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5jCj4gaW5kZXggMjkxM2U0MWY2M2E1Li40ZjNlYzk3
NDZkMGMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rl
dmljZS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2RldmljZS5j
Cj4gQEAgLTE5MjksNyArMTkyOSw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RldmljZV9md19sb2Fk
aW5nKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQo+ICAgCQkJaWYgKGFkZXYtPmlwX2Jsb2Nr
c1tpXS5zdGF0dXMuaHcgPT0gdHJ1ZSkKPiAgIAkJCQlicmVhazsKPiAgIAo+IC0JCQlpZiAoYWRl
di0+aW5fZ3B1X3Jlc2V0IHx8IGFkZXYtPmluX3N1c3BlbmQpIHsKPiArCQkJaWYgKGF0b21pY19y
ZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpIHx8IGFkZXYtPmluX3N1c3BlbmQpIHsKPiAgIAkJCQly
ID0gYWRldi0+aXBfYmxvY2tzW2ldLnZlcnNpb24tPmZ1bmNzLT5yZXN1bWUoYWRldik7Cj4gICAJ
CQkJaWYgKHIpIHsKPiAgIAkJCQkJRFJNX0VSUk9SKCJyZXN1bWUgb2YgSVAgYmxvY2sgPCVzPiBm
YWlsZWQgJWRcbiIsCj4gQEAgLTIxMDAsNyArMjEwMCw3IEBAIHN0YXRpYyBib29sIGFtZGdwdV9k
ZXZpY2VfY2hlY2tfdnJhbV9sb3N0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQo+ICAgCQkJ
QU1ER1BVX1JFU0VUX01BR0lDX05VTSkpCj4gICAJCXJldHVybiB0cnVlOwo+ICAgCj4gLQlpZiAo
IWFkZXYtPmluX2dwdV9yZXNldCkKPiArCWlmICghYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9y
ZXNldCkpCj4gICAJCXJldHVybiBmYWxzZTsKPiAgIAo+ICAgCS8qCj4gQEAgLTMwMjYsNyArMzAy
Niw4IEBAIGludCBhbWRncHVfZGV2aWNlX2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
Cj4gICAJbXV0ZXhfaW5pdCgmYWRldi0+bW5fbG9jayk7Cj4gICAJbXV0ZXhfaW5pdCgmYWRldi0+
dmlydC52Zl9lcnJvcnMubG9jayk7Cj4gICAJaGFzaF9pbml0KGFkZXYtPm1uX2hhc2gpOwo+IC0J
bXV0ZXhfaW5pdCgmYWRldi0+bG9ja19yZXNldCk7Cj4gKwlpbml0X3J3c2VtKCZhZGV2LT5yZXNl
dF9zZW0pOwo+ICsJYXRvbWljX3NldCgmYWRldi0+aW5fZ3B1X3Jlc2V0LCAwKTsKPiAgIAltdXRl
eF9pbml0KCZhZGV2LT5wc3AubXV0ZXgpOwo+ICAgCW11dGV4X2luaXQoJmFkZXYtPm5vdGlmaWVy
X2xvY2spOwo+ICAgCj4gQEAgLTQxMzEsMTYgKzQxMzIsMTQgQEAgc3RhdGljIGludCBhbWRncHVf
ZG9fYXNpY19yZXNldChzdHJ1Y3QgYW1kZ3B1X2hpdmVfaW5mbyAqaGl2ZSwKPiAgIAlyZXR1cm4g
cjsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgYm9vbCBhbWRncHVfZGV2aWNlX2xvY2tfYWRldihzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCB0cnlsb2NrKQo+ICtzdGF0aWMgYm9vbCBhbWRn
cHVfZGV2aWNlX2xvY2tfYWRldihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiAgIHsKPiAt
CWlmICh0cnlsb2NrKSB7Cj4gLQkJaWYgKCFtdXRleF90cnlsb2NrKCZhZGV2LT5sb2NrX3Jlc2V0
KSkKPiAtCQkJcmV0dXJuIGZhbHNlOwo+IC0JfSBlbHNlCj4gLQkJbXV0ZXhfbG9jaygmYWRldi0+
bG9ja19yZXNldCk7Cj4gKwlpZiAoYXRvbWljX2NtcHhjaGcoJmFkZXYtPmluX2dwdV9yZXNldCwg
MCwgMSkgIT0gMCkKPiArCQlyZXR1cm4gZmFsc2U7Cj4gKwo+ICsJZG93bl93cml0ZSgmYWRldi0+
cmVzZXRfc2VtKTsKCgpJbiBWMSBDaHJpc3RpYW4gcmFpc2VkIGEgY29uY2VybiBvZiB0aGlzIGNo
YW5nZSBpbmNyZWFzaW5nwqAgdGhlIGNoYW5jZSBmb3IgZ3B1IApyZWNvdmVyeSBhYm9ydCBkdWUg
dG8gY29sbGlzaW9uIG9mIGFtZGdwdV9kZXZpY2VfbG9ja19hZGV2IGRvaW5nIGRvd25fd3JpdGUg
CnRyeWxvY2sgd2l0aCByZWFkIHNpZGUgbG9jayBvZiBhbnkgb2YgdGhlIG1hbnkgb3BlcmF0aW9u
cyBoZXJlLiBJIHVuZGVyc3RhbmQgdGhlIApuZWVkIGZvciB0aGlzIGJ1dCBiZWZvcmUgdGhlICd0
cnlsb2NrJ8KgIHdhcyB1c2VkIG9ubHkgZm9yIFhHTUkgY2FzZSBiZWNhdXNlIHdlIAprbmV3IFhH
TUkgaGFuZyBvbiBvbmNlIGNhcmQgd2lsbCB0cmlnZ2VyIGhhbmdzIG9uIGFsbCBvdGhlciBjYXJk
cyBpbiB0aGUgaGl2ZSAKYnV0IG5vdyB0aGUgJ3RyeWxvY2snIGxvZ2ljIChpbXBsZW1lbnRlZCBi
eSBhdG9taWNfY21weGNoZykgYWxzbyBhcHBsaWVzIHRvIHRoZSAKbW9yZSBjb21tb24gbm9uIFhH
TUkgY2FzZQoKQW5kcmV5CgoKPiAgIAo+ICAgCWF0b21pY19pbmMoJmFkZXYtPmdwdV9yZXNldF9j
b3VudGVyKTsKPiAtCWFkZXYtPmluX2dwdV9yZXNldCA9IHRydWU7Cj4gICAJc3dpdGNoIChhbWRn
cHVfYXNpY19yZXNldF9tZXRob2QoYWRldikpIHsKPiAgIAljYXNlIEFNRF9SRVNFVF9NRVRIT0Rf
TU9ERTE6Cj4gICAJCWFkZXYtPm1wMV9zdGF0ZSA9IFBQX01QMV9TVEFURV9TSFVURE9XTjsKPiBA
QCAtNDE2MCw4ICs0MTU5LDggQEAgc3RhdGljIHZvaWQgYW1kZ3B1X2RldmljZV91bmxvY2tfYWRl
dihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKPiAgIHsKPiAgIAlhbWRncHVfdmZfZXJyb3Jf
dHJhbnNfYWxsKGFkZXYpOwo+ICAgCWFkZXYtPm1wMV9zdGF0ZSA9IFBQX01QMV9TVEFURV9OT05F
Owo+IC0JYWRldi0+aW5fZ3B1X3Jlc2V0ID0gZmFsc2U7Cj4gLQltdXRleF91bmxvY2soJmFkZXYt
PmxvY2tfcmVzZXQpOwo+ICsJYXRvbWljX3NldCgmYWRldi0+aW5fZ3B1X3Jlc2V0LCAwKTsKPiAr
CXVwX3dyaXRlKCZhZGV2LT5yZXNldF9zZW0pOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZCBh
bWRncHVfZGV2aWNlX3Jlc3VtZV9kaXNwbGF5X2F1ZGlvKHN0cnVjdCBhbWRncHVfZGV2aWNlICph
ZGV2KQo+IEBAIC00Mjk3LDcgKzQyOTYsNyBAQCBpbnQgYW1kZ3B1X2RldmljZV9ncHVfcmVjb3Zl
cihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgIAo+ICAgCS8qIGJsb2NrIGFsbCBzY2hl
ZHVsZXJzIGFuZCByZXNldCBnaXZlbiBqb2IncyByaW5nICovCj4gICAJbGlzdF9mb3JfZWFjaF9l
bnRyeSh0bXBfYWRldiwgZGV2aWNlX2xpc3RfaGFuZGxlLCBnbWMueGdtaS5oZWFkKSB7Cj4gLQkJ
aWYgKCFhbWRncHVfZGV2aWNlX2xvY2tfYWRldih0bXBfYWRldiwgIWhpdmUpKSB7Cj4gKwkJaWYg
KCFhbWRncHVfZGV2aWNlX2xvY2tfYWRldih0bXBfYWRldikpIHsKPiAgIAkJCURSTV9JTkZPKCJC
YWlsaW5nIG9uIFREUiBmb3Igc19qb2I6JWxseCwgYXMgYW5vdGhlciBhbHJlYWR5IGluIHByb2dy
ZXNzIiwKPiAgIAkJCQkgIGpvYiA/IGpvYi0+YmFzZS5pZCA6IC0xKTsKPiAgIAkJCW11dGV4X3Vu
bG9jaygmaGl2ZS0+aGl2ZV9sb2NrKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2dlbS5jCj4gaW5kZXggNzdkOTg4YTAwMzNmLi45NmRmMzY2OWE5ZDIgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dlbS5jCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2dlbS5jCj4gQEAgLTY3MCw2ICs2NzAsOCBAQCBpbnQg
YW1kZ3B1X2dlbV92YV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+
ICAgCQlib192YSA9IE5VTEw7Cj4gICAJfQo+ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0
X3NlbSk7Cj4gKwo+ICAgCXN3aXRjaCAoYXJncy0+b3BlcmF0aW9uKSB7Cj4gICAJY2FzZSBBTURH
UFVfVkFfT1BfTUFQOgo+ICAgCQl2YV9mbGFncyA9IGFtZGdwdV9nZW1fdmFfbWFwX2ZsYWdzKGFk
ZXYsIGFyZ3MtPmZsYWdzKTsKPiBAQCAtNjk5LDYgKzcwMSw4IEBAIGludCBhbWRncHVfZ2VtX3Zh
X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gICAJCWFtZGdwdV9n
ZW1fdmFfdXBkYXRlX3ZtKGFkZXYsICZmcHJpdi0+dm0sIGJvX3ZhLAo+ICAgCQkJCQlhcmdzLT5v
cGVyYXRpb24pOwo+ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIGVy
cm9yX2JhY2tvZmY6Cj4gICAJdHRtX2V1X2JhY2tvZmZfcmVzZXJ2YXRpb24oJnRpY2tldCwgJmxp
c3QpOwo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9nZnguYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9nZnguYwo+IGluZGV4
IGQ2MTIwMzNhMjNhYy4uYzlmMTNmODM2YTdhIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9nZnguYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9nZnguYwo+IEBAIC03MTAsNyArNzEwLDcgQEAgdWludDMyX3QgYW1kZ3B1X2tp
cV9ycmVnKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1aW50MzJfdCByZWcpCj4gICAJICoK
PiAgIAkgKiBhbHNvIGRvbid0IHdhaXQgYW55bW9yZSBmb3IgSVJRIGNvbnRleHQKPiAgIAkgKiAq
Lwo+IC0JaWYgKHIgPCAxICYmIChhZGV2LT5pbl9ncHVfcmVzZXQgfHwgaW5faW50ZXJydXB0KCkp
KQo+ICsJaWYgKHIgPCAxICYmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSB8fCBp
bl9pbnRlcnJ1cHQoKSkpCj4gICAJCWdvdG8gZmFpbGVkX2tpcV9yZWFkOwo+ICAgCj4gICAJbWln
aHRfc2xlZXAoKTsKPiBAQCAtNzY4LDcgKzc2OCw3IEBAIHZvaWQgYW1kZ3B1X2tpcV93cmVnKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCB1aW50MzJfdCByZWcsIHVpbnQzMl90IHYpCj4gICAJ
ICoKPiAgIAkgKiBhbHNvIGRvbid0IHdhaXQgYW55bW9yZSBmb3IgSVJRIGNvbnRleHQKPiAgIAkg
KiAqLwo+IC0JaWYgKHIgPCAxICYmIChhZGV2LT5pbl9ncHVfcmVzZXQgfHwgaW5faW50ZXJydXB0
KCkpKQo+ICsJaWYgKHIgPCAxICYmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSB8
fCBpbl9pbnRlcnJ1cHQoKSkpCj4gICAJCWdvdG8gZmFpbGVkX2tpcV93cml0ZTsKPiAgIAo+ICAg
CW1pZ2h0X3NsZWVwKCk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV9qb2IuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9qb2IuYwo+
IGluZGV4IDkzNzAyOWFkNTI3MS4uMzY3NTI4ZGUxNjU4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9qb2IuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9qb2IuYwo+IEBAIC0yMjYsOCArMjI2LDEwIEBAIHN0YXRpYyBzdHJ1
Y3QgZG1hX2ZlbmNlICphbWRncHVfam9iX3J1bihzdHJ1Y3QgZHJtX3NjaGVkX2pvYiAqc2NoZWRf
am9iKQo+ICAgCWlmIChmaW5pc2hlZC0+ZXJyb3IgPCAwKSB7Cj4gICAJCURSTV9JTkZPKCJTa2lw
IHNjaGVkdWxpbmcgSUJzIVxuIik7Cj4gICAJfSBlbHNlIHsKPiArCQlkb3duX3JlYWQoJnJpbmct
PmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAJCXIgPSBhbWRncHVfaWJfc2NoZWR1bGUocmluZywgam9i
LT5udW1faWJzLCBqb2ItPmlicywgam9iLAo+ICAgCQkJCSAgICAgICAmZmVuY2UpOwo+ICsJCXVw
X3JlYWQoJnJpbmctPmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAJCWlmIChyKQo+ICAgCQkJRFJNX0VS
Uk9SKCJFcnJvciBzY2hlZHVsaW5nIElCcyAoJWQpXG4iLCByKTsKPiAgIAl9Cj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYwo+IGluZGV4IDljMmM1ZTRlZDFlYi4uZWViYmUy
MTAzZTMyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9r
bXMuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYwo+IEBA
IC0xMDg0LDYgKzEwODQsOCBAQCB2b2lkIGFtZGdwdV9kcml2ZXJfcG9zdGNsb3NlX2ttcyhzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LAo+ICAgCWlmICghZnByaXYpCj4gICAJCXJldHVybjsKPiAgIAo+
ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50aW1lX2dldF9z
eW5jKGRldi0+ZGV2KTsKPiAgIAo+ICAgCWlmIChhbWRncHVfZGV2aWNlX2lwX2dldF9pcF9ibG9j
ayhhZGV2LCBBTURfSVBfQkxPQ0tfVFlQRV9VVkQpICE9IE5VTEwpCj4gQEAgLTExMjIsNiArMTEy
NCw4IEBAIHZvaWQgYW1kZ3B1X2RyaXZlcl9wb3N0Y2xvc2Vfa21zKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYsCj4gICAKPiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRldi0+ZGV2KTsKPiAg
IAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZXYtPmRldik7Cj4gKwo+ICsJdXBfcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsKPiAgIH0KPiAgIAo+ICAgLyoKPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9hbWRncHVfcG0uYwo+IGluZGV4IGQyNDAxMzc5YmQzMy4uNjFiMjNhZTkwNmQ3IDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9wbS5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BtLmMKPiBAQCAtMTYzLDcgKzE2Myw3
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcG93ZXJfZHBtX3N0YXRlKHN0cnVjdCBkZXZp
Y2UgKmRldiwKPiAgIAllbnVtIGFtZF9wbV9zdGF0ZV90eXBlIHBtOwo+ICAgCWludCByZXQ7Cj4g
ICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYt
PmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAlyZXQgPSBwbV9y
dW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4gQEAgLTE3Miw2ICsxNzIsOCBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfZ2V0X3Bvd2VyX2RwbV9zdGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4g
ICAJCXJldHVybiByZXQ7Cj4gICAJfQo+ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3Nl
bSk7Cj4gKwo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+ICAgCQlpZiAoYWRl
di0+c211LnBwdF9mdW5jcy0+Z2V0X2N1cnJlbnRfcG93ZXJfc3RhdGUpCj4gICAJCQlwbSA9IHNt
dV9nZXRfY3VycmVudF9wb3dlcl9zdGF0ZSgmYWRldi0+c211KTsKPiBAQCAtMTgzLDYgKzE4NSw4
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcG93ZXJfZHBtX3N0YXRlKHN0cnVjdCBkZXZp
Y2UgKmRldiwKPiAgIAkJcG0gPSBhZGV2LT5wbS5kcG0udXNlcl9zdGF0ZTsKPiAgIAl9Cj4gICAK
PiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCXBtX3J1bnRpbWVfbWFya19s
YXN0X2J1c3koZGRldi0+ZGV2KTsKPiAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2
LT5kZXYpOwo+ICAgCj4gQEAgLTIwMSw3ICsyMDUsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVf
c2V0X3Bvd2VyX2RwbV9zdGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJZW51bSBhbWRfcG1f
c3RhdGVfdHlwZSAgc3RhdGU7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKGFkZXYtPmluX2dw
dV9yZXNldCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJ
cmV0dXJuIC1FUEVSTTsKPiAgIAo+ICAgCWlmIChzdHJuY21wKCJiYXR0ZXJ5IiwgYnVmLCBzdHJs
ZW4oImJhdHRlcnkiKSkgPT0gMCkKPiBAQCAtMjE5LDYgKzIyMyw4IEBAIHN0YXRpYyBzc2l6ZV90
IGFtZGdwdV9zZXRfcG93ZXJfZHBtX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0
dXJuIHJldDsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAr
Cj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7Cj4gICAJCW11dGV4X2xvY2soJmFk
ZXYtPnBtLm11dGV4KTsKPiAgIAkJYWRldi0+cG0uZHBtLnVzZXJfc3RhdGUgPSBzdGF0ZTsKPiBA
QCAtMjMyLDYgKzIzOCw5IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBtX3N0
YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAo+ICAgCQlhbWRncHVfcG1fY29tcHV0ZV9jbG9j
a3MoYWRldik7Cj4gICAJfQo+ICsKPiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+
ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPiAgIAlwbV9ydW50aW1l
X3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+ICAgCj4gQEAgLTMwNyw3ICszMTYsNyBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bvd2VyX2RwbV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZl
bChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJZW51bSBhbWRfZHBtX2ZvcmNlZF9sZXZlbCBsZXZl
bCA9IDB4ZmY7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkK
PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJuIC1F
UEVSTTsKPiAgIAo+ICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoZGRldi0+ZGV2KTsKPiBA
QCAtMzE2LDYgKzMyNSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcG93ZXJfZHBtX2Zv
cmNlX3BlcmZvcm1hbmNlX2xldmVsKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIHJl
dDsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJ
aWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+ICAgCQlsZXZlbCA9IHNtdV9nZXRfcGVyZm9y
bWFuY2VfbGV2ZWwoJmFkZXYtPnNtdSk7Cj4gICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBw
X2Z1bmNzLT5nZXRfcGVyZm9ybWFuY2VfbGV2ZWwpCj4gQEAgLTMyMyw2ICszMzQsOCBAQCBzdGF0
aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bvd2VyX2RwbV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbChz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJZWxzZQo+ICAgCQlsZXZlbCA9IGFkZXYtPnBtLmRwbS5m
b3JjZWRfbGV2ZWw7Cj4gICAKPiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAg
CXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPiAgIAlwbV9ydW50aW1lX3B1
dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+ICAgCj4gQEAgLTM0OSw3ICszNjIsNyBAQCBzdGF0
aWMgc3NpemVfdCBhbWRncHVfc2V0X3Bvd2VyX2RwbV9mb3JjZV9wZXJmb3JtYW5jZV9sZXZlbChz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJZW51bSBhbWRfZHBtX2ZvcmNlZF9sZXZlbCBjdXJyZW50
X2xldmVsID0gMHhmZjsKPiAgIAlpbnQgcmV0ID0gMDsKPiAgIAo+IC0JaWYgKGFkZXYtPmluX2dw
dV9yZXNldCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJ
cmV0dXJuIC1FUEVSTTsKPiAgIAo+ICAgCWlmIChzdHJuY21wKCJsb3ciLCBidWYsIHN0cmxlbigi
bG93IikpID09IDApIHsKPiBAQCAtMzgwLDYgKzM5Myw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9zZXRfcG93ZXJfZHBtX2ZvcmNlX3BlcmZvcm1hbmNlX2xldmVsKHN0cnVjdCBkZXZpY2UgKmRl
diwKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsKPiArCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+ICAgCQljdXJy
ZW50X2xldmVsID0gc211X2dldF9wZXJmb3JtYW5jZV9sZXZlbCgmYWRldi0+c211KTsKPiAgIAll
bHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9wZXJmb3JtYW5jZV9sZXZlbCkK
PiBAQCAtMzg4LDcgKzQwMyw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBt
X2ZvcmNlX3BlcmZvcm1hbmNlX2xldmVsKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAlpZiAoY3Vy
cmVudF9sZXZlbCA9PSBsZXZlbCkgewo+ICAgCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRk
ZXYtPmRldik7Cj4gICAJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4g
LQkJcmV0dXJuIGNvdW50Owo+ICsJCXJldCA9IGNvdW50Owo+ICsJCWdvdG8gcHJvX2VuZDsKPiAg
IAl9Cj4gICAKPiAgIAlpZiAoYWRldi0+YXNpY190eXBlID09IENISVBfUkFWRU4pIHsKPiBAQCAt
NDA5LDcgKzQyNSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJfZHBtX2ZvcmNl
X3BlcmZvcm1hbmNlX2xldmVsKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcHJfZXJyKCJDdXJy
ZW50bHkgbm90IGluIGFueSBwcm9maWxlIG1vZGUhXG4iKTsKPiAgIAkJcG1fcnVudGltZV9tYXJr
X2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+ICAgCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChk
ZGV2LT5kZXYpOwo+IC0JCXJldHVybiAtRUlOVkFMOwo+ICsJCXJldCA9IC1FSU5WQUw7Cj4gKwkJ
Z290byBwcm9fZW5kOwo+ICAgCX0KPiAgIAo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2
KSkgewo+IEBAIC00MTcsNyArNDM0LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wb3dl
cl9kcG1fZm9yY2VfcGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCQlp
ZiAocmV0KSB7Cj4gICAJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4g
ICAJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+IC0JCQlyZXR1cm4g
LUVJTlZBTDsKPiArCQkJcmV0ID0gLUVJTlZBTDsKPiArCQkJZ290byBwcm9fZW5kOwo+ICAgCQl9
Cj4gICAJfSBlbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNlX3BlcmZvcm1h
bmNlX2xldmVsKSB7Cj4gICAJCW11dGV4X2xvY2soJmFkZXYtPnBtLm11dGV4KTsKPiBAQCAtNDI1
LDE0ICs0NDMsMTYgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wb3dlcl9kcG1fZm9yY2Vf
cGVyZm9ybWFuY2VfbGV2ZWwoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCQkJbXV0ZXhfdW5sb2Nr
KCZhZGV2LT5wbS5tdXRleCk7Cj4gICAJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYt
PmRldik7Cj4gICAJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+IC0J
CQlyZXR1cm4gLUVJTlZBTDsKPiArCQkJcmV0ID0gLUVJTlZBTDsKPiArCQkJZ290byBwcm9fZW5k
Owo+ICAgCQl9Cj4gICAJCXJldCA9IGFtZGdwdV9kcG1fZm9yY2VfcGVyZm9ybWFuY2VfbGV2ZWwo
YWRldiwgbGV2ZWwpOwo+ICAgCQlpZiAocmV0KSB7Cj4gICAJCQltdXRleF91bmxvY2soJmFkZXYt
PnBtLm11dGV4KTsKPiAgIAkJCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsK
PiAgIAkJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4gLQkJCXJldHVy
biAtRUlOVkFMOwo+ICsJCQlyZXQgPSAtRUlOVkFMOwo+ICsJCQlnb3RvIHByb19lbmQ7Cj4gICAJ
CX0gZWxzZSB7Cj4gICAJCQlhZGV2LT5wbS5kcG0uZm9yY2VkX2xldmVsID0gbGV2ZWw7Cj4gICAJ
CX0KPiBAQCAtNDQxLDcgKzQ2MSw5IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcG93ZXJf
ZHBtX2ZvcmNlX3BlcmZvcm1hbmNlX2xldmVsKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAlwbV9y
dW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0
b3N1c3BlbmQoZGRldi0+ZGV2KTsKPiAgIAo+IC0JcmV0dXJuIGNvdW50Owo+ICtwcm9fZW5kOgo+
ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCXJldHVybiByZXQ7Cj4gICB9Cj4gICAK
PiAgIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfbnVtX3N0YXRlcyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4gQEAgLTQ1Myw3ICs0NzUsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bw
X251bV9zdGF0ZXMoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCXN0cnVjdCBwcF9zdGF0ZXNfaW5m
byBkYXRhOwo+ICAgCWludCBpLCBidWZfbGVuLCByZXQ7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9n
cHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJ
CXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYt
PmRldik7Cj4gQEAgLTQ5Nyw3ICs1MTksNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3Bw
X2N1cl9zdGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJZW51bSBhbWRfcG1fc3RhdGVfdHlw
ZSBwbSA9IDA7Cj4gICAJaW50IGkgPSAwLCByZXQgPSAwOwo+ICAgCj4gLQlpZiAoYWRldi0+aW5f
Z3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAg
CQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2
LT5kZXYpOwo+IEBAIC01MzgsNyArNTYwLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9w
cF9mb3JjZV9zdGF0ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJc3RydWN0IGRybV9kZXZpY2Ug
KmRkZXYgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiA9IGRkZXYtPmRldl9wcml2YXRlOwo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0
KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4g
LUVQRVJNOwo+ICAgCj4gICAJaWYgKGFkZXYtPnBwX2ZvcmNlX3N0YXRlX2VuYWJsZWQpCj4gQEAg
LTU1OCw3ICs1ODAsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2ZvcmNlX3N0YXRl
KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAl1bnNpZ25lZCBsb25nIGlkeDsKPiAgIAlpbnQgcmV0
Owo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZh
ZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJaWYgKHN0
cmxlbihidWYpID09IDEpCj4gQEAgLTU4NCw2ICs2MDYsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfc2V0X3BwX2ZvcmNlX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJCXJldHVybiBy
ZXQ7Cj4gICAJCX0KPiAgIAo+ICsJCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAgIAkJ
Lyogb25seSBzZXQgdXNlciBzZWxlY3RlZCBwb3dlciBzdGF0ZXMgKi8KPiAgIAkJaWYgKHN0YXRl
ICE9IFBPV0VSX1NUQVRFX1RZUEVfSU5URVJOQUxfQk9PVCAmJgo+ICAgCQkgICAgc3RhdGUgIT0g
UE9XRVJfU1RBVEVfVFlQRV9ERUZBVUxUKSB7Cj4gQEAgLTU5MSw2ICs2MTQsOCBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfc2V0X3BwX2ZvcmNlX3N0YXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAg
IAkJCQkJQU1EX1BQX1RBU0tfRU5BQkxFX1VTRVJfU1RBVEUsICZzdGF0ZSk7Cj4gICAJCQlhZGV2
LT5wcF9mb3JjZV9zdGF0ZV9lbmFibGVkID0gdHJ1ZTsKPiAgIAkJfQo+ICsJCXVwX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYt
PmRldik7Cj4gICAJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4gICAJ
fQo+IEBAIC02MTgsNyArNjQzLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF90YWJs
ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJY2hhciAqdGFibGUgPSBOVUxMOwo+ICAgCWludCBz
aXplLCByZXQ7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWlj
X3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRVBFUk07Cj4gICAKPiAg
IAlyZXQgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4gQEAgLTY2Miw3ICs2ODcs
NyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX3RhYmxlKHN0cnVjdCBkZXZpY2UgKmRl
diwKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGRkZXYtPmRldl9wcml2YXRlOwo+
ICAgCWludCByZXQgPSAwOwo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYg
KGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+
ICAgCj4gICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+IEBAIC02NzEs
MTYgKzY5NiwyMSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX3RhYmxlKHN0cnVjdCBk
ZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7
Cj4gICAJCXJldCA9IHNtdV9zeXNfc2V0X3BwX3RhYmxlKCZhZGV2LT5zbXUsICh2b2lkICopYnVm
LCBjb3VudCk7Cj4gICAJCWlmIChyZXQpIHsKPiAgIAkJCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1
c3koZGRldi0+ZGV2KTsKPiAgIAkJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRl
dik7Cj4gKwkJCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAJCQlyZXR1cm4gcmV0Owo+
ICAgCQl9Cj4gICAJfSBlbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPnNldF9wcF90
YWJsZSkKPiAgIAkJYW1kZ3B1X2RwbV9zZXRfcHBfdGFibGUoYWRldiwgYnVmLCBjb3VudCk7Cj4g
ICAKPiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCXBtX3J1bnRpbWVfbWFy
a19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPiAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChk
ZGV2LT5kZXYpOwo+ICAgCj4gQEAgLTc2OSw3ICs3OTksNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfc2V0X3BwX29kX2Nsa192b2x0YWdlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAljb25zdCBj
aGFyIGRlbGltaXRlclszXSA9IHsnICcsICdcbicsICdcMCd9Owo+ICAgCXVpbnQzMl90IHR5cGU7
Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFk
ZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAlpZiAoY291
bnQgPiAxMjcpCj4gQEAgLTgxMyw2ICs4NDMsMTAgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3Nl
dF9wcF9vZF9jbGtfdm9sdGFnZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByZXQ7
Cj4gICAJfQo+ICAgCj4gKwlyZXQgPSBjb3VudDsKPiArCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJl
c2V0X3NlbSk7Cj4gKwo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+ICAgCQly
ZXQgPSBzbXVfb2RfZWRpdF9kcG1fdGFibGUoJmFkZXYtPnNtdSwgdHlwZSwKPiAgIAkJCQkJICAg
IHBhcmFtZXRlciwgcGFyYW1ldGVyX3NpemUpOwo+IEBAIC04MjAsNyArODU0LDggQEAgc3RhdGlj
IHNzaXplX3QgYW1kZ3B1X3NldF9wcF9vZF9jbGtfdm9sdGFnZShzdHJ1Y3QgZGV2aWNlICpkZXYs
Cj4gICAJCWlmIChyZXQpIHsKPiAgIAkJCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+
ZGV2KTsKPiAgIAkJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4gLQkJ
CXJldHVybiAtRUlOVkFMOwo+ICsJCQlyZXQgPSAtRUlOVkFMOwo+ICsJCQlnb3RvIHByb19lbmQ7
Cj4gICAJCX0KPiAgIAl9IGVsc2Ugewo+ICAgCQlpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNz
LT5vZG5fZWRpdF9kcG1fdGFibGUpIHsKPiBAQCAtODI5LDcgKzg2NCw4IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9zZXRfcHBfb2RfY2xrX3ZvbHRhZ2Uoc3RydWN0IGRldmljZSAqZGV2LAo+ICAg
CQkJaWYgKHJldCkgewo+ICAgCQkJCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2
KTsKPiAgIAkJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+IC0JCQkJ
cmV0dXJuIC1FSU5WQUw7Cj4gKwkJCQlyZXQgPSAtRUlOVkFMOwo+ICsJCQkJZ290byBwcm9fZW5k
Owo+ICAgCQkJfQo+ICAgCQl9Cj4gICAKPiBAQCAtODQwLDE4ICs4NzYsMjIgQEAgc3RhdGljIHNz
aXplX3QgYW1kZ3B1X3NldF9wcF9vZF9jbGtfdm9sdGFnZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4g
ICAJCQkJCQlOVUxMKTsKPiAgIAkJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRl
dik7Cj4gICAJCQkJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPiAtCQkJ
CXJldHVybiBjb3VudDsKPiArCQkJCXJldCA9IGNvdW50Owo+ICsJCQkJZ290byBwcm9fZW5kOwo+
ICAgCQkJfSBlbHNlIHsKPiAgIAkJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRl
dik7Cj4gICAJCQkJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPiAtCQkJ
CXJldHVybiAtRUlOVkFMOwo+ICsJCQkJcmV0ID0gLUVJTlZBTDsKPiArCQkJCWdvdG8gcHJvX2Vu
ZDsKPiAgIAkJCX0KPiAgIAkJfQo+ICAgCX0KPiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsK
PiAgIAo+IC0JcmV0dXJuIGNvdW50Owo+ICtwcm9fZW5kOgo+ICsJdXBfcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsKPiArCXJldHVybiByZXQ7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9nZXRfcHBfb2RfY2xrX3ZvbHRhZ2Uoc3RydWN0IGRldmljZSAqZGV2LAo+IEBAIC04NjMs
NyArOTAzLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9vZF9jbGtfdm9sdGFnZShz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJc3NpemVfdCBzaXplOwo+ICAgCWludCByZXQ7Cj4gICAK
PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmlu
X2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAlyZXQgPSBwbV9ydW50
aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4gQEAgLTkxNyw3ICs5NTcsNyBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfc2V0X3BwX2ZlYXR1cmVzKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAl1aW50
NjRfdCBmZWF0dXJlbWFzazsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1
X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQly
ZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJcmV0ID0ga3N0cnRvdTY0KGJ1ZiwgMCwgJmZlYXR1cmVt
YXNrKTsKPiBAQCAtOTMyLDExICs5NzIsMTMgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9w
cF9mZWF0dXJlcyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByZXQ7Cj4gICAJfQo+
ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAJaWYgKGlzX3N1cHBvcnRf
c3dfc211KGFkZXYpKSB7Cj4gICAJCXJldCA9IHNtdV9zeXNfc2V0X3BwX2ZlYXR1cmVfbWFzaygm
YWRldi0+c211LCBmZWF0dXJlbWFzayk7Cj4gICAJCWlmIChyZXQpIHsKPiAgIAkJCXBtX3J1bnRp
bWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPiAgIAkJCXBtX3J1bnRpbWVfcHV0X2F1dG9z
dXNwZW5kKGRkZXYtPmRldik7Cj4gKwkJCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAJ
CQlyZXR1cm4gLUVJTlZBTDsKPiAgIAkJfQo+ICAgCX0gZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5
LnBwX2Z1bmNzLT5zZXRfcHBmZWF0dXJlX3N0YXR1cykgewo+IEBAIC05NDQsOSArOTg2LDEyIEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZmVhdHVyZXMoc3RydWN0IGRldmljZSAqZGV2
LAo+ICAgCQlpZiAocmV0KSB7Cj4gICAJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYt
PmRldik7Cj4gICAJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+ICsJ
CQl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICAgCQkJcmV0dXJuIC1FSU5WQUw7Cj4gICAJ
CX0KPiAgIAl9Cj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50
aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1
c3BlbmQoZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC05NjIsNyArMTAwNyw3IEBAIHN0YXRpYyBzc2l6
ZV90IGFtZGdwdV9nZXRfcHBfZmVhdHVyZXMoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCXNzaXpl
X3Qgc2l6ZTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+
ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQ
RVJNOwo+ICAgCj4gICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+IEBA
IC05NzEsNiArMTAxNiw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZmVhdHVyZXMo
c3RydWN0IGRldmljZSAqZGV2LAo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAgIAo+ICsJZG93
bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUo
YWRldikpCj4gICAJCXNpemUgPSBzbXVfc3lzX2dldF9wcF9mZWF0dXJlX21hc2soJmFkZXYtPnNt
dSwgYnVmKTsKPiAgIAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9wcGZl
YXR1cmVfc3RhdHVzKQo+IEBAIC05NzgsNiArMTAyNSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9nZXRfcHBfZmVhdHVyZXMoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCWVsc2UKPiAgIAkJc2l6
ZSA9IHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiXG4iKTsKPiAgIAo+ICsJdXBfcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5k
ZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4gICAKPiBA
QCAtMTAyMyw3ICsxMDcyLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fc2Ns
ayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJc3NpemVfdCBzaXplOwo+ICAgCWludCByZXQ7Cj4g
ICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYt
PmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAlyZXQgPSBwbV9y
dW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4gQEAgLTEwMzIsNiArMTA4MSw4IEBAIHN0YXRp
YyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX3NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+ICAg
CQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAgIAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Owo+ICsKPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4gICAJCXNpemUgPSBzbXVf
cHJpbnRfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfU0NMSywgYnVmKTsKPiAgIAllbHNlIGlm
IChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPnByaW50X2Nsb2NrX2xldmVscykKPiBAQCAtMTAz
OSw2ICsxMDkwLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fc2NsayhzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4gICAJZWxzZQo+ICAgCQlzaXplID0gc25wcmludGYoYnVmLCBQQUdF
X1NJWkUsICJcbiIpOwo+ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAg
IAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9w
dXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0xMDkxLDcgKzExNDQsNyBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9zY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwK
PiAgIAlpbnQgcmV0Owo+ICAgCXVpbnQzMl90IG1hc2sgPSAwOwo+ICAgCj4gLQlpZiAoYWRldi0+
aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+
ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJcmV0ID0gYW1kZ3B1X3JlYWRfbWFzayhidWYs
IGNvdW50LCAmbWFzayk7Cj4gQEAgLTExMDQsMTEgKzExNTcsMTUgQEAgc3RhdGljIHNzaXplX3Qg
YW1kZ3B1X3NldF9wcF9kcG1fc2NsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiBy
ZXQ7Cj4gICAJfQo+ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAg
CWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPiAgIAkJcmV0ID0gc211X2ZvcmNlX2Nsa19s
ZXZlbHMoJmFkZXYtPnNtdSwgU01VX1NDTEssIG1hc2ssIHRydWUpOwo+ICAgCWVsc2UgaWYgKGFk
ZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpCj4gICAJCXJldCA9IGFt
ZGdwdV9kcG1fZm9yY2VfY2xvY2tfbGV2ZWwoYWRldiwgUFBfU0NMSywgbWFzayk7Cj4gICAKPiAr
CXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0
X2J1c3koZGRldi0+ZGV2KTsKPiAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5k
ZXYpOwo+ICAgCj4gQEAgLTExMjcsNyArMTE4NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9n
ZXRfcHBfZHBtX21jbGsoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCXNzaXplX3Qgc2l6ZTsKPiAg
IAlpbnQgcmV0Owo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21p
Y19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4g
ICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+IEBAIC0xMTM2LDYgKzEx
OTMsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9tY2xrKHN0cnVjdCBkZXZp
Y2UgKmRldiwKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPiArCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+ICAg
CQlzaXplID0gc211X3ByaW50X2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01VX01DTEssIGJ1Zik7
Cj4gICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5wcmludF9jbG9ja19sZXZl
bHMpCj4gQEAgLTExNDMsNiArMTIwMiw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBf
ZHBtX21jbGsoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCWVsc2UKPiAgIAkJc2l6ZSA9IHNucHJp
bnRmKGJ1ZiwgUEFHRV9TSVpFLCAiXG4iKTsKPiAgIAo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRf
c2VtKTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+ICAg
CXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4gICAKPiBAQCAtMTE1OSw3
ICsxMjIwLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fbWNsayhzdHJ1Y3Qg
ZGV2aWNlICpkZXYsCj4gICAJdWludDMyX3QgbWFzayA9IDA7Cj4gICAJaW50IHJldDsKPiAgIAo+
IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5f
Z3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJuIC1FUEVSTTsKPiAgIAo+ICAgCXJldCA9IGFtZGdwdV9y
ZWFkX21hc2soYnVmLCBjb3VudCwgJm1hc2spOwo+IEBAIC0xMTcyLDExICsxMjMzLDE1IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX21jbGsoc3RydWN0IGRldmljZSAqZGV2LAo+
ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAgIAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9z
ZW0pOwo+ICsKPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4gICAJCXJldCA9IHNt
dV9mb3JjZV9jbGtfbGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9NQ0xLLCBtYXNrLCB0cnVlKTsKPiAg
IAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNlX2Nsb2NrX2xldmVsKQo+
ICAgCQlyZXQgPSBhbWRncHVfZHBtX2ZvcmNlX2Nsb2NrX2xldmVsKGFkZXYsIFBQX01DTEssIG1h
c2spOwo+ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50
aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1
c3BlbmQoZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0xMTk1LDcgKzEyNjAsNyBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfZ2V0X3BwX2RwbV9zb2NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCXNz
aXplX3Qgc2l6ZTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0
KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4g
LUVQRVJNOwo+ICAgCj4gICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+
IEBAIC0xMjA0LDYgKzEyNjksOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9z
b2NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAgIAo+
ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlpZiAoaXNfc3VwcG9ydF9z
d19zbXUoYWRldikpCj4gICAJCXNpemUgPSBzbXVfcHJpbnRfY2xrX2xldmVscygmYWRldi0+c211
LCBTTVVfU09DQ0xLLCBidWYpOwo+ICAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5j
cy0+cHJpbnRfY2xvY2tfbGV2ZWxzKQo+IEBAIC0xMjExLDYgKzEyNzgsOCBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfZ2V0X3BwX2RwbV9zb2NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCWVs
c2UKPiAgIAkJc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiXG4iKTsKPiAgIAo+ICsJ
dXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3Rf
YnVzeShkZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRl
dik7Cj4gICAKPiBAQCAtMTIyNyw3ICsxMjk2LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3Nl
dF9wcF9kcG1fc29jY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAlpbnQgcmV0Owo+ICAgCXVp
bnQzMl90IG1hc2sgPSAwOwo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYg
KGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+
ICAgCj4gICAJcmV0ID0gYW1kZ3B1X3JlYWRfbWFzayhidWYsIGNvdW50LCAmbWFzayk7Cj4gQEAg
LTEyNDAsNiArMTMwOSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX3NvY2Ns
ayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByZXQ7Cj4gICAJfQo+ICAgCj4gKwlk
b3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3Nt
dShhZGV2KSkKPiAgIAkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZlbHMoJmFkZXYtPnNtdSwgU01V
X1NPQ0NMSywgbWFzaywgdHJ1ZSk7Cj4gICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1
bmNzLT5mb3JjZV9jbG9ja19sZXZlbCkKPiBAQCAtMTI0Nyw2ICsxMzE4LDggQEAgc3RhdGljIHNz
aXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fc29jY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAll
bHNlCj4gICAJCXJldCA9IDA7Cj4gICAKPiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4g
Kwo+ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPiAgIAlwbV9ydW50
aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+ICAgCj4gQEAgLTEyNjUsNyArMTMzOCw3
IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX2ZjbGsoc3RydWN0IGRldmljZSAq
ZGV2LAo+ICAgCXNzaXplX3Qgc2l6ZTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlpZiAoYWRldi0+
aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+
ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhk
ZGV2LT5kZXYpOwo+IEBAIC0xMjc0LDYgKzEzNDcsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVf
Z2V0X3BwX2RwbV9mY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIHJldDsKPiAg
IAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJaWYgKGlz
X3N1cHBvcnRfc3dfc211KGFkZXYpKQo+ICAgCQlzaXplID0gc211X3ByaW50X2Nsa19sZXZlbHMo
JmFkZXYtPnNtdSwgU01VX0ZDTEssIGJ1Zik7Cj4gICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5
LnBwX2Z1bmNzLT5wcmludF9jbG9ja19sZXZlbHMpCj4gQEAgLTEyODEsNiArMTM1Niw4IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX2ZjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+
ICAgCWVsc2UKPiAgIAkJc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiXG4iKTsKPiAg
IAo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJr
X2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRk
ZXYtPmRldik7Cj4gICAKPiBAQCAtMTI5Nyw3ICsxMzc0LDcgQEAgc3RhdGljIHNzaXplX3QgYW1k
Z3B1X3NldF9wcF9kcG1fZmNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJaW50IHJldDsKPiAg
IAl1aW50MzJfdCBtYXNrID0gMDsKPiAgIAo+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPiAr
CWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJuIC1FUEVS
TTsKPiAgIAo+ICAgCXJldCA9IGFtZGdwdV9yZWFkX21hc2soYnVmLCBjb3VudCwgJm1hc2spOwo+
IEBAIC0xMzEwLDYgKzEzODcsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9m
Y2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAl9Cj4gICAKPiAr
CWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJaWYgKGlzX3N1cHBvcnRfc3df
c211KGFkZXYpKQo+ICAgCQlyZXQgPSBzbXVfZm9yY2VfY2xrX2xldmVscygmYWRldi0+c211LCBT
TVVfRkNMSywgbWFzaywgdHJ1ZSk7Cj4gICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1
bmNzLT5mb3JjZV9jbG9ja19sZXZlbCkKPiBAQCAtMTMxNyw2ICsxMzk2LDggQEAgc3RhdGljIHNz
aXplX3QgYW1kZ3B1X3NldF9wcF9kcG1fZmNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJZWxz
ZQo+ICAgCQlyZXQgPSAwOwo+ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsK
PiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4gICAJcG1fcnVudGlt
ZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0xMzM1LDcgKzE0MTYsNyBA
QCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9kY2VmY2xrKHN0cnVjdCBkZXZpY2Ug
KmRldiwKPiAgIAlzc2l6ZV90IHNpemU7Cj4gICAJaW50IHJldDsKPiAgIAo+IC0JaWYgKGFkZXYt
PmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkK
PiAgIAkJcmV0dXJuIC1FUEVSTTsKPiAgIAo+ICAgCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMo
ZGRldi0+ZGV2KTsKPiBAQCAtMTM0NCw2ICsxNDI1LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2dldF9wcF9kcG1fZGNlZmNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByZXQ7
Cj4gICAJfQo+ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCWlm
IChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPiAgIAkJc2l6ZSA9IHNtdV9wcmludF9jbGtfbGV2
ZWxzKCZhZGV2LT5zbXUsIFNNVV9EQ0VGQ0xLLCBidWYpOwo+ICAgCWVsc2UgaWYgKGFkZXYtPnBv
d2VycGxheS5wcF9mdW5jcy0+cHJpbnRfY2xvY2tfbGV2ZWxzKQo+IEBAIC0xMzUxLDYgKzE0MzQs
OCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX2RwbV9kY2VmY2xrKHN0cnVjdCBkZXZp
Y2UgKmRldiwKPiAgIAllbHNlCj4gICAJCXNpemUgPSBzbnByaW50ZihidWYsIFBBR0VfU0laRSwg
IlxuIik7Cj4gICAKPiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCXBtX3J1
bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPiAgIAlwbV9ydW50aW1lX3B1dF9hdXRv
c3VzcGVuZChkZGV2LT5kZXYpOwo+ICAgCj4gQEAgLTEzNjcsNyArMTQ1Miw3IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX2RjZWZjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+ICAg
CWludCByZXQ7Cj4gICAJdWludDMyX3QgbWFzayA9IDA7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9n
cHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJ
CXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAlyZXQgPSBhbWRncHVfcmVhZF9tYXNrKGJ1ZiwgY291
bnQsICZtYXNrKTsKPiBAQCAtMTM4MCw2ICsxNDY1LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X3NldF9wcF9kcG1fZGNlZmNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByZXQ7
Cj4gICAJfQo+ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCWlm
IChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPiAgIAkJcmV0ID0gc211X2ZvcmNlX2Nsa19sZXZl
bHMoJmFkZXYtPnNtdSwgU01VX0RDRUZDTEssIG1hc2ssIHRydWUpOwo+ICAgCWVsc2UgaWYgKGFk
ZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Zm9yY2VfY2xvY2tfbGV2ZWwpCj4gQEAgLTEzODcsNiAr
MTQ3NCw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfZHBtX2RjZWZjbGsoc3RydWN0
IGRldmljZSAqZGV2LAo+ICAgCWVsc2UKPiAgIAkJcmV0ID0gMDsKPiAgIAo+ICsJdXBfcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2
LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4gICAK
PiBAQCAtMTQwNSw3ICsxNDk0LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1f
cGNpZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJc3NpemVfdCBzaXplOwo+ICAgCWludCByZXQ7
Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFk
ZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAlyZXQgPSBw
bV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4gQEAgLTE0MTQsNiArMTUwMyw4IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfZHBtX3BjaWUoc3RydWN0IGRldmljZSAqZGV2LAo+
ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAgIAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9z
ZW0pOwo+ICsKPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4gICAJCXNpemUgPSBz
bXVfcHJpbnRfY2xrX2xldmVscygmYWRldi0+c211LCBTTVVfUENJRSwgYnVmKTsKPiAgIAllbHNl
IGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPnByaW50X2Nsb2NrX2xldmVscykKPiBAQCAt
MTQyMSw2ICsxNTEyLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9kcG1fcGNpZShz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJZWxzZQo+ICAgCQlzaXplID0gc25wcmludGYoYnVmLCBQ
QUdFX1NJWkUsICJcbiIpOwo+ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsK
PiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4gICAJcG1fcnVudGlt
ZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0xNDM3LDcgKzE1MzAsNyBA
QCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9wY2llKHN0cnVjdCBkZXZpY2UgKmRl
diwKPiAgIAlpbnQgcmV0Owo+ICAgCXVpbnQzMl90IG1hc2sgPSAwOwo+ICAgCj4gLQlpZiAoYWRl
di0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQp
KQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJcmV0ID0gYW1kZ3B1X3JlYWRfbWFzayhi
dWYsIGNvdW50LCAmbWFzayk7Cj4gQEAgLTE0NTAsNiArMTU0Myw4IEBAIHN0YXRpYyBzc2l6ZV90
IGFtZGdwdV9zZXRfcHBfZHBtX3BjaWUoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCQlyZXR1cm4g
cmV0Owo+ICAgCX0KPiAgIAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAg
IAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpCj4gICAJCXJldCA9IHNtdV9mb3JjZV9jbGtf
bGV2ZWxzKCZhZGV2LT5zbXUsIFNNVV9QQ0lFLCBtYXNrLCB0cnVlKTsKPiAgIAllbHNlIGlmIChh
ZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmZvcmNlX2Nsb2NrX2xldmVsKQo+IEBAIC0xNDU3LDYg
KzE1NTIsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX2RwbV9wY2llKHN0cnVjdCBk
ZXZpY2UgKmRldiwKPiAgIAllbHNlCj4gICAJCXJldCA9IDA7Cj4gICAKPiArCXVwX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+
ZGV2KTsKPiAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+ICAgCj4g
QEAgLTE0NzUsNyArMTU3Miw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfc2Nsa19v
ZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJdWludDMyX3QgdmFsdWUgPSAwOwo+ICAgCWludCBy
ZXQ7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQo
JmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAlyZXQg
PSBwbV9ydW50aW1lX2dldF9zeW5jKGRkZXYtPmRldik7Cj4gQEAgLTE0ODQsMTEgKzE1ODEsMTUg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9zY2xrX29kKHN0cnVjdCBkZXZpY2UgKmRl
diwKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsKPiArCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+ICAgCQl2YWx1
ZSA9IHNtdV9nZXRfb2RfcGVyY2VudGFnZSgmKGFkZXYtPnNtdSksIFNNVV9PRF9TQ0xLKTsKPiAg
IAllbHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9zY2xrX29kKQo+ICAgCQl2
YWx1ZSA9IGFtZGdwdV9kcG1fZ2V0X3NjbGtfb2QoYWRldik7Cj4gICAKPiArCXVwX3JlYWQoJmFk
ZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+
ZGV2KTsKPiAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+ICAgCj4g
QEAgLTE1MDUsNyArMTYwNiw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfc2Nsa19v
ZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJaW50IHJldDsKPiAgIAlsb25nIGludCB2YWx1ZTsK
PiAgIAo+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRl
di0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJuIC1FUEVSTTsKPiAgIAo+ICAgCXJldCA9IGtz
dHJ0b2woYnVmLCAwLCAmdmFsdWUpOwo+IEBAIC0xNTE5LDYgKzE2MjAsOCBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfc2V0X3BwX3NjbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCQlyZXR1
cm4gcmV0Owo+ICAgCX0KPiAgIAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsK
PiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsKPiAgIAkJdmFsdWUgPSBzbXVfc2V0
X29kX3BlcmNlbnRhZ2UoJihhZGV2LT5zbXUpLCBTTVVfT0RfU0NMSywgKHVpbnQzMl90KXZhbHVl
KTsKPiAgIAl9IGVsc2Ugewo+IEBAIC0xNTMzLDYgKzE2MzYsOCBAQCBzdGF0aWMgc3NpemVfdCBh
bWRncHVfc2V0X3BwX3NjbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCQl9Cj4gICAJfQo+
ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50aW1lX21h
cmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQo
ZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0xNTQ4LDcgKzE2NTMsNyBAQCBzdGF0aWMgc3NpemVfdCBh
bWRncHVfZ2V0X3BwX21jbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCXVpbnQzMl90IHZh
bHVlID0gMDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+
ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQ
RVJNOwo+ICAgCj4gICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+IEBA
IC0xNTU3LDExICsxNjYyLDE1IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcHBfbWNsa19v
ZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByZXQ7Cj4gICAJfQo+ICAgCj4gKwlk
b3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3Nt
dShhZGV2KSkKPiAgIAkJdmFsdWUgPSBzbXVfZ2V0X29kX3BlcmNlbnRhZ2UoJihhZGV2LT5zbXUp
LCBTTVVfT0RfTUNMSyk7Cj4gICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5n
ZXRfbWNsa19vZCkKPiAgIAkJdmFsdWUgPSBhbWRncHVfZHBtX2dldF9tY2xrX29kKGFkZXYpOwo+
ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50aW1lX21h
cmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQo
ZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0xNTc4LDcgKzE2ODcsNyBAQCBzdGF0aWMgc3NpemVfdCBh
bWRncHVfc2V0X3BwX21jbGtfb2Qoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCWludCByZXQ7Cj4g
ICAJbG9uZyBpbnQgdmFsdWU7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlp
ZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRVBFUk07
Cj4gICAKPiAgIAlyZXQgPSBrc3RydG9sKGJ1ZiwgMCwgJnZhbHVlKTsKPiBAQCAtMTU5Miw2ICsx
NzAxLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9tY2xrX29kKHN0cnVjdCBkZXZp
Y2UgKmRldiwKPiAgIAkJcmV0dXJuIHJldDsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPiArCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKSB7Cj4g
ICAJCXZhbHVlID0gc211X3NldF9vZF9wZXJjZW50YWdlKCYoYWRldi0+c211KSwgU01VX09EX01D
TEssICh1aW50MzJfdCl2YWx1ZSk7Cj4gICAJfSBlbHNlIHsKPiBAQCAtMTYwNiw2ICsxNzE3LDgg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X3NldF9wcF9tY2xrX29kKHN0cnVjdCBkZXZpY2UgKmRl
diwKPiAgIAkJfQo+ICAgCX0KPiAgIAo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAr
Cj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRp
bWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4gICAKPiBAQCAtMTY0MSw3ICsxNzU0LDcg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9wcF9wb3dlcl9wcm9maWxlX21vZGUoc3RydWN0
IGRldmljZSAqZGV2LAo+ICAgCXNzaXplX3Qgc2l6ZTsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlp
ZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJcmV0ID0gcG1fcnVudGltZV9n
ZXRfc3luYyhkZGV2LT5kZXYpOwo+IEBAIC0xNjUwLDYgKzE3NjMsOCBAQCBzdGF0aWMgc3NpemVf
dCBhbWRncHVfZ2V0X3BwX3Bvd2VyX3Byb2ZpbGVfbW9kZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4g
ICAJCXJldHVybiByZXQ7Cj4gICAJfQo+ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3Nl
bSk7Cj4gKwo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkKPiAgIAkJc2l6ZSA9IHNt
dV9nZXRfcG93ZXJfcHJvZmlsZV9tb2RlKCZhZGV2LT5zbXUsIGJ1Zik7Cj4gICAJZWxzZSBpZiAo
YWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfcG93ZXJfcHJvZmlsZV9tb2RlKQo+IEBAIC0x
NjU3LDYgKzE3NzIsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0X3BwX3Bvd2VyX3Byb2Zp
bGVfbW9kZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJZWxzZQo+ICAgCQlzaXplID0gc25wcmlu
dGYoYnVmLCBQQUdFX1NJWkUsICJcbiIpOwo+ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9z
ZW0pOwo+ICsKPiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGRkZXYtPmRldik7Cj4gICAJ
cG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0xNjgxLDcg
KzE3OTgsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfc2V0X3BwX3Bvd2VyX3Byb2ZpbGVfbW9k
ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJbG9uZyBpbnQgcHJvZmlsZV9tb2RlID0gMDsKPiAg
IAljb25zdCBjaGFyIGRlbGltaXRlclszXSA9IHsnICcsICdcbicsICdcMCd9Owo+ICAgCj4gLQlp
ZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJdG1wWzBdID0gKihidWYpOwo+
IEBAIC0xNzE1LDExICsxODMyLDE1IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9zZXRfcHBfcG93
ZXJfcHJvZmlsZV9tb2RlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIHJldDsKPiAg
IAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJaWYgKGlz
X3N1cHBvcnRfc3dfc211KGFkZXYpKQo+ICAgCQlyZXQgPSBzbXVfc2V0X3Bvd2VyX3Byb2ZpbGVf
bW9kZSgmYWRldi0+c211LCBwYXJhbWV0ZXIsIHBhcmFtZXRlcl9zaXplLCB0cnVlKTsKPiAgIAll
bHNlIGlmIChhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPnNldF9wb3dlcl9wcm9maWxlX21vZGUp
Cj4gICAJCXJldCA9IGFtZGdwdV9kcG1fc2V0X3Bvd2VyX3Byb2ZpbGVfbW9kZShhZGV2LCBwYXJh
bWV0ZXIsIHBhcmFtZXRlcl9zaXplKTsKPiAgIAo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2Vt
KTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+ICAgCXBt
X3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4gICAKPiBAQCAtMTc0NSw3ICsx
ODY2LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2dldF9ncHVfYnVzeV9wZXJjZW50KHN0cnVj
dCBkZXZpY2UgKmRldiwKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGRkZXYtPmRl
dl9wcml2YXRlOwo+ICAgCWludCByLCB2YWx1ZSwgc2l6ZSA9IHNpemVvZih2YWx1ZSk7Cj4gICAK
PiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmlu
X2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAlyID0gcG1fcnVudGlt
ZV9nZXRfc3luYyhkZGV2LT5kZXYpOwo+IEBAIC0xNzU0LDkgKzE4NzUsMTEgQEAgc3RhdGljIHNz
aXplX3QgYW1kZ3B1X2dldF9ncHVfYnVzeV9wZXJjZW50KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAg
IAkJcmV0dXJuIHI7Cj4gICAJfQo+ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7
Cj4gICAJLyogcmVhZCB0aGUgSVAgYnVzeSBzZW5zb3IgKi8KPiAgIAlyID0gYW1kZ3B1X2RwbV9y
ZWFkX3NlbnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX0dQVV9MT0FELAo+ICAgCQkJCSAgICh2
b2lkICopJnZhbHVlLCAmc2l6ZSk7Cj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICAg
Cj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShkZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRp
bWVfcHV0X2F1dG9zdXNwZW5kKGRkZXYtPmRldik7Cj4gQEAgLTE3ODMsNyArMTkwNiw3IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfbWVtX2J1c3lfcGVyY2VudChzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4gICAJc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSBkZGV2LT5kZXZfcHJpdmF0ZTsK
PiAgIAlpbnQgciwgdmFsdWUsIHNpemUgPSBzaXplb2YodmFsdWUpOwo+ICAgCj4gLQlpZiAoYWRl
di0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQp
KQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMo
ZGRldi0+ZGV2KTsKPiBAQCAtMTc5MiwxMCArMTkxNSwxNCBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfZ2V0X21lbV9idXN5X3BlcmNlbnQoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCQlyZXR1cm4g
cjsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJ
LyogcmVhZCB0aGUgSVAgYnVzeSBzZW5zb3IgKi8KPiAgIAlyID0gYW1kZ3B1X2RwbV9yZWFkX3Nl
bnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX01FTV9MT0FELAo+ICAgCQkJCSAgICh2b2lkICop
JnZhbHVlLCAmc2l6ZSk7Cj4gICAKPiArCXVwX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+
ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGRldi0+ZGV2KTsKPiAgIAlwbV9ydW50aW1l
X3B1dF9hdXRvc3VzcGVuZChkZGV2LT5kZXYpOwo+ICAgCj4gQEAgLTE4MjYsNyArMTk1Myw3IEBA
IHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9nZXRfcGNpZV9idyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4g
ICAJdWludDY0X3QgY291bnQwID0gMCwgY291bnQxID0gMDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4g
LQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9n
cHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJaWYgKGFkZXYtPmZsYWdz
ICYgQU1EX0lTX0FQVSkKPiBAQCAtMTg0MSw4ICsxOTY4LDEyIEBAIHN0YXRpYyBzc2l6ZV90IGFt
ZGdwdV9nZXRfcGNpZV9idyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByZXQ7Cj4g
ICAJfQo+ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCWFtZGdw
dV9hc2ljX2dldF9wY2llX3VzYWdlKGFkZXYsICZjb3VudDAsICZjb3VudDEpOwo+ICAgCj4gKwl1
cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9i
dXN5KGRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoZGRldi0+ZGV2
KTsKPiAgIAo+IEBAIC0xODY3LDcgKzE5OTgsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfZ2V0
X3VuaXF1ZV9pZChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRk
ZXYgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diA9IGRkZXYtPmRldl9wcml2YXRlOwo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+
ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQ
RVJNOwo+ICAgCj4gICAJaWYgKGFkZXYtPnVuaXF1ZV9pZCkKPiBAQCAtMjEzNCw3ICsyMjY1LDcg
QEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfdGVtcChzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4gICAJaW50IGNoYW5uZWwgPSB0b19zZW5zb3JfZGV2X2F0dHIoYXR0ciktPmluZGV4Owo+
ICAgCWludCByLCB0ZW1wID0gMCwgc2l6ZSA9IHNpemVvZih0ZW1wKTsKPiAgIAo+IC0JaWYgKGFk
ZXYtPmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0
KSkKPiAgIAkJcmV0dXJuIC1FUEVSTTsKPiAgIAo+ICAgCWlmIChjaGFubmVsID49IFBQX1RFTVBf
TUFYKQo+IEBAIC0yMTQ2LDYgKzIyNzcsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25f
c2hvd190ZW1wKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIHI7Cj4gICAJfQo+ICAg
Cj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCXN3aXRjaCAoY2hhbm5l
bCkgewo+ICAgCWNhc2UgUFBfVEVNUF9KVU5DVElPTjoKPiAgIAkJLyogZ2V0IGN1cnJlbnQganVu
Y3Rpb24gdGVtcGVyYXR1cmUgKi8KPiBAQCAtMjE2Nyw2ICsyMzAwLDggQEAgc3RhdGljIHNzaXpl
X3QgYW1kZ3B1X2h3bW9uX3Nob3dfdGVtcChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCWJyZWFr
Owo+ICAgCX0KPiAgIAo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJcG1f
cnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVf
cHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4gICAKPiBAQCAtMjI3MCw3ICsyNDA1
LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dldF9wd20xX2VuYWJsZShzdHJ1Y3Qg
ZGV2aWNlICpkZXYsCj4gICAJdTMyIHB3bV9tb2RlID0gMDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4g
LQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9n
cHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJcmV0ID0gcG1fcnVudGlt
ZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOwo+IEBAIC0yMjc5LDE4ICsyNDE0LDIzIEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRfcHdtMV9lbmFibGUoc3RydWN0IGRldmljZSAq
ZGV2LAo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAgIAo+ICsJZG93bl9yZWFkKCZhZGV2LT5y
ZXNldF9zZW0pOwo+ICsKPiAgIAlpZiAoaXNfc3VwcG9ydF9zd19zbXUoYWRldikpIHsKPiAgIAkJ
cHdtX21vZGUgPSBzbXVfZ2V0X2Zhbl9jb250cm9sX21vZGUoJmFkZXYtPnNtdSk7Cj4gICAJfSBl
bHNlIHsKPiAgIAkJaWYgKCFhZGV2LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9mYW5fY29udHJv
bF9tb2RlKSB7Cj4gICAJCQlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRl
dik7Cj4gICAJCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+
ICsJCQl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICAgCQkJcmV0dXJuIC1FSU5WQUw7Cj4g
ICAJCX0KPiAgIAo+ICAgCQlwd21fbW9kZSA9IGFtZGdwdV9kcG1fZ2V0X2Zhbl9jb250cm9sX21v
ZGUoYWRldik7Cj4gICAJfQo+ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsK
PiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4gICAJcG1f
cnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0yMzA2
LDcgKzI0NDYsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2V0X3B3bTFfZW5hYmxl
KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAlpbnQgZXJyLCByZXQ7Cj4gICAJaW50IHZhbHVlOwo+
ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2
LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJZXJyID0ga3N0
cnRvaW50KGJ1ZiwgMTAsICZ2YWx1ZSk7Cj4gQEAgLTIzMTksMTggKzI0NTksMjMgQEAgc3RhdGlj
IHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9wd20xX2VuYWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYs
Cj4gICAJCXJldHVybiByZXQ7Cj4gICAJfQo+ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0
X3NlbSk7Cj4gKwo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2KSkgewo+ICAgCQlzbXVf
c2V0X2Zhbl9jb250cm9sX21vZGUoJmFkZXYtPnNtdSwgdmFsdWUpOwo+ICAgCX0gZWxzZSB7Cj4g
ICAJCWlmICghYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5zZXRfZmFuX2NvbnRyb2xfbW9kZSkg
ewo+ICAgCQkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+ICAg
CQkJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPiArCQkJdXBf
cmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAgIAkJCXJldHVybiAtRUlOVkFMOwo+ICAgCQl9Cj4g
ICAKPiAgIAkJYW1kZ3B1X2RwbV9zZXRfZmFuX2NvbnRyb2xfbW9kZShhZGV2LCB2YWx1ZSk7Cj4g
ICAJfQo+ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50
aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRf
YXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0yMzYwLDcgKzI1MDUsNyBA
QCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2V0X3B3bTEoc3RydWN0IGRldmljZSAqZGV2
LAo+ICAgCXUzMiB2YWx1ZTsKPiAgIAl1MzIgcHdtX21vZGU7Cj4gICAKPiAtCWlmIChhZGV2LT5p
bl9ncHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4g
ICAJCXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAllcnIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFk
ZXYtPmRkZXYtPmRldik7Cj4gQEAgLTIzNjksMTEgKzI1MTQsMTUgQEAgc3RhdGljIHNzaXplX3Qg
YW1kZ3B1X2h3bW9uX3NldF9wd20xKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIGVy
cjsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJ
aWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+ICAgCQlwd21fbW9kZSA9IHNtdV9nZXRfZmFu
X2NvbnRyb2xfbW9kZSgmYWRldi0+c211KTsKPiAgIAllbHNlCj4gICAJCXB3bV9tb2RlID0gYW1k
Z3B1X2RwbV9nZXRfZmFuX2NvbnRyb2xfbW9kZShhZGV2KTsKPiAgIAo+ICsJdXBfcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPiArCj4gICAJaWYgKHB3bV9tb2RlICE9IEFNRF9GQU5fQ1RSTF9NQU5V
QUwpIHsKPiAgIAkJcHJfaW5mbygibWFudWFsIGZhbiBzcGVlZCBjb250cm9sIHNob3VsZCBiZSBl
bmFibGVkIGZpcnN0XG4iKTsKPiAgIAkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5k
ZGV2LT5kZXYpOwo+IEBAIC0yNDE0LDcgKzI1NjMsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVf
aHdtb25fZ2V0X3B3bTEoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCWludCBlcnI7Cj4gICAJdTMy
IHNwZWVkID0gMDsKPiAgIAo+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9t
aWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJuIC1FUEVSTTsKPiAgIAo+
ICAgCWVyciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsKPiBAQCAtMjQy
Myw2ICsyNTcyLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dldF9wd20xKHN0cnVj
dCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIGVycjsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVh
ZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYp
KQo+ICAgCQllcnIgPSBzbXVfZ2V0X2Zhbl9zcGVlZF9wZXJjZW50KCZhZGV2LT5zbXUsICZzcGVl
ZCk7Cj4gICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzLT5nZXRfZmFuX3NwZWVk
X3BlcmNlbnQpCj4gQEAgLTI0MzAsNiArMjU4MSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9o
d21vbl9nZXRfcHdtMShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJZWxzZQo+ICAgCQllcnIgPSAt
RUlOVkFMOwo+ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9y
dW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9w
dXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0yNDQ5LDcgKzI2MDIs
NyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X2ZhbjFfaW5wdXQoc3RydWN0IGRl
dmljZSAqZGV2LAo+ICAgCWludCBlcnI7Cj4gICAJdTMyIHNwZWVkID0gMDsKPiAgIAo+IC0JaWYg
KGFkZXYtPmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jl
c2V0KSkKPiAgIAkJcmV0dXJuIC1FUEVSTTsKPiAgIAo+ICAgCWVyciA9IHBtX3J1bnRpbWVfZ2V0
X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsKPiBAQCAtMjQ1OCw2ICsyNjExLDggQEAgc3RhdGljIHNz
aXplX3QgYW1kZ3B1X2h3bW9uX2dldF9mYW4xX2lucHV0KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAg
IAkJcmV0dXJuIGVycjsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2Vt
KTsKPiArCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+ICAgCQllcnIgPSBzbXVf
Z2V0X2Zhbl9zcGVlZF9ycG0oJmFkZXYtPnNtdSwgJnNwZWVkKTsKPiAgIAllbHNlIGlmIChhZGV2
LT5wb3dlcnBsYXkucHBfZnVuY3MtPmdldF9mYW5fc3BlZWRfcnBtKQo+IEBAIC0yNDY1LDYgKzI2
MjAsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fZ2V0X2ZhbjFfaW5wdXQoc3RydWN0
IGRldmljZSAqZGV2LAo+ICAgCWVsc2UKPiAgIAkJZXJyID0gLUVJTlZBTDsKPiAgIAo+ICsJdXBf
cmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVz
eShhZGV2LT5kZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYt
PmRkZXYtPmRldik7Cj4gICAKPiBAQCAtMjQ4Myw3ICsyNjQwLDcgQEAgc3RhdGljIHNzaXplX3Qg
YW1kZ3B1X2h3bW9uX2dldF9mYW4xX21pbihzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJdTMyIHNp
emUgPSBzaXplb2YobWluX3JwbSk7Cj4gICAJaW50IHI7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9n
cHVfcmVzZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJ
CXJldHVybiAtRVBFUk07Cj4gICAKPiAgIAlyID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5k
ZGV2LT5kZXYpOwo+IEBAIC0yNDkyLDkgKzI2NDksMTMgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2h3bW9uX2dldF9mYW4xX21pbihzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByOwo+
ICAgCX0KPiAgIAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlyID0g
YW1kZ3B1X2RwbV9yZWFkX3NlbnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX01JTl9GQU5fUlBN
LAo+ICAgCQkJCSAgICh2b2lkICopJm1pbl9ycG0sICZzaXplKTsKPiAgIAo+ICsJdXBfcmVhZCgm
YWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2
LT5kZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYt
PmRldik7Cj4gICAKPiBAQCAtMjUxMyw3ICsyNjc0LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2h3bW9uX2dldF9mYW4xX21heChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJdTMyIHNpemUgPSBz
aXplb2YobWF4X3JwbSk7Cj4gICAJaW50IHI7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVz
ZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVy
biAtRVBFUk07Cj4gICAKPiAgIAlyID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5k
ZXYpOwo+IEBAIC0yNTIyLDkgKzI2ODMsMTMgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9u
X2dldF9mYW4xX21heChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByOwo+ICAgCX0K
PiAgIAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlyID0gYW1kZ3B1
X2RwbV9yZWFkX3NlbnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX01BWF9GQU5fUlBNLAo+ICAg
CQkJCSAgICh2b2lkICopJm1heF9ycG0sICZzaXplKTsKPiAgIAo+ICsJdXBfcmVhZCgmYWRldi0+
cmVzZXRfc2VtKTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2
LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7
Cj4gICAKPiBAQCAtMjU0Miw3ICsyNzA3LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9u
X2dldF9mYW4xX3RhcmdldChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJaW50IGVycjsKPiAgIAl1
MzIgcnBtID0gMDsKPiAgIAo+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9t
aWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJuIC1FUEVSTTsKPiAgIAo+
ICAgCWVyciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsKPiBAQCAtMjU1
MSw2ICsyNzE2LDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX2dldF9mYW4xX3Rhcmdl
dChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiBlcnI7Cj4gICAJfQo+ICAgCj4gKwlk
b3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3Nt
dShhZGV2KSkKPiAgIAkJZXJyID0gc211X2dldF9mYW5fc3BlZWRfcnBtKCZhZGV2LT5zbXUsICZy
cG0pOwo+ICAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxheS5wcF9mdW5jcy0+Z2V0X2Zhbl9zcGVl
ZF9ycG0pCj4gQEAgLTI1NTgsNiArMjcyNSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21v
bl9nZXRfZmFuMV90YXJnZXQoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCWVsc2UKPiAgIAkJZXJy
ID0gLUVJTlZBTDsKPiAgIAo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJ
cG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRp
bWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7Cj4gICAKPiBAQCAtMjU3Niw3ICsy
NzQ1LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9mYW4xX3RhcmdldChzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4gICAJdTMyIHZhbHVlOwo+ICAgCXUzMiBwd21fbW9kZTsKPiAgIAo+
IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5f
Z3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJuIC1FUEVSTTsKPiAgIAo+ICAgCWVyciA9IHBtX3J1bnRp
bWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsKPiBAQCAtMjU4NSwxMSArMjc1NCwxNSBAQCBz
dGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2V0X2ZhbjFfdGFyZ2V0KHN0cnVjdCBkZXZpY2Ug
KmRldiwKPiAgIAkJcmV0dXJuIGVycjsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+
cmVzZXRfc2VtKTsKPiArCj4gICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+ICAgCQlw
d21fbW9kZSA9IHNtdV9nZXRfZmFuX2NvbnRyb2xfbW9kZSgmYWRldi0+c211KTsKPiAgIAllbHNl
Cj4gICAJCXB3bV9tb2RlID0gYW1kZ3B1X2RwbV9nZXRfZmFuX2NvbnRyb2xfbW9kZShhZGV2KTsK
PiAgIAo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4gICAJaWYgKHB3bV9tb2Rl
ICE9IEFNRF9GQU5fQ1RSTF9NQU5VQUwpIHsKPiAgIAkJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVz
eShhZGV2LT5kZGV2LT5kZXYpOwo+ICAgCQlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2
LT5kZGV2LT5kZXYpOwo+IEBAIC0yNjAzLDYgKzI3NzYsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRn
cHVfaHdtb25fc2V0X2ZhbjFfdGFyZ2V0KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJu
IGVycjsKPiAgIAl9Cj4gICAKPiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiArCj4g
ICAJaWYgKGlzX3N1cHBvcnRfc3dfc211KGFkZXYpKQo+ICAgCQllcnIgPSBzbXVfc2V0X2Zhbl9z
cGVlZF9ycG0oJmFkZXYtPnNtdSwgdmFsdWUpOwo+ICAgCWVsc2UgaWYgKGFkZXYtPnBvd2VycGxh
eS5wcF9mdW5jcy0+c2V0X2Zhbl9zcGVlZF9ycG0pCj4gQEAgLTI2MTAsNiArMjc4NSw4IEBAIHN0
YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zZXRfZmFuMV90YXJnZXQoc3RydWN0IGRldmljZSAq
ZGV2LAo+ICAgCWVsc2UKPiAgIAkJZXJyID0gLUVJTlZBTDsKPiAgIAo+ICsJdXBfcmVhZCgmYWRl
di0+cmVzZXRfc2VtKTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5k
ZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRl
dik7Cj4gICAKPiBAQCAtMjYyNyw3ICsyODA0LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3
bW9uX2dldF9mYW4xX2VuYWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJdTMyIHB3bV9tb2Rl
ID0gMDsKPiAgIAlpbnQgcmV0Owo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJ
aWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJN
Owo+ICAgCj4gICAJcmV0ID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOwo+
IEBAIC0yNjM2LDE4ICsyODEzLDIzIEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9nZXRf
ZmFuMV9lbmFibGUoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0K
PiAgIAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlpZiAoaXNfc3Vw
cG9ydF9zd19zbXUoYWRldikpIHsKPiAgIAkJcHdtX21vZGUgPSBzbXVfZ2V0X2Zhbl9jb250cm9s
X21vZGUoJmFkZXYtPnNtdSk7Cj4gICAJfSBlbHNlIHsKPiAgIAkJaWYgKCFhZGV2LT5wb3dlcnBs
YXkucHBfZnVuY3MtPmdldF9mYW5fY29udHJvbF9tb2RlKSB7Cj4gICAJCQlwbV9ydW50aW1lX21h
cmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4gICAJCQlwbV9ydW50aW1lX3B1dF9hdXRv
c3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+ICsJCQl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0p
Owo+ICAgCQkJcmV0dXJuIC1FSU5WQUw7Cj4gICAJCX0KPiAgIAo+ICAgCQlwd21fbW9kZSA9IGFt
ZGdwdV9kcG1fZ2V0X2Zhbl9jb250cm9sX21vZGUoYWRldik7Cj4gICAJfQo+ICAgCj4gKwl1cF9y
ZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGFkZXYtPmRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+
ZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0yNjY0LDcgKzI4NDYsNyBAQCBzdGF0aWMgc3NpemVfdCBh
bWRncHVfaHdtb25fc2V0X2ZhbjFfZW5hYmxlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAlpbnQg
dmFsdWU7Cj4gICAJdTMyIHB3bV9tb2RlOwo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0
KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4g
LUVQRVJNOwo+ICAgCj4gICAJZXJyID0ga3N0cnRvaW50KGJ1ZiwgMTAsICZ2YWx1ZSk7Cj4gQEAg
LTI2ODQsMTcgKzI4NjYsMjIgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3NldF9mYW4x
X2VuYWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiBlcnI7Cj4gICAJfQo+ICAg
Cj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCWlmIChpc19zdXBwb3J0
X3N3X3NtdShhZGV2KSkgewo+ICAgCQlzbXVfc2V0X2Zhbl9jb250cm9sX21vZGUoJmFkZXYtPnNt
dSwgcHdtX21vZGUpOwo+ICAgCX0gZWxzZSB7Cj4gICAJCWlmICghYWRldi0+cG93ZXJwbGF5LnBw
X2Z1bmNzLT5zZXRfZmFuX2NvbnRyb2xfbW9kZSkgewo+ICAgCQkJcG1fcnVudGltZV9tYXJrX2xh
c3RfYnVzeShhZGV2LT5kZGV2LT5kZXYpOwo+ICAgCQkJcG1fcnVudGltZV9wdXRfYXV0b3N1c3Bl
bmQoYWRldi0+ZGRldi0+ZGV2KTsKPiArCQkJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAg
IAkJCXJldHVybiAtRUlOVkFMOwo+ICAgCQl9Cj4gICAJCWFtZGdwdV9kcG1fc2V0X2Zhbl9jb250
cm9sX21vZGUoYWRldiwgcHdtX21vZGUpOwo+ICAgCX0KPiAgIAo+ICsJdXBfcmVhZCgmYWRldi0+
cmVzZXRfc2VtKTsKPiArCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5kZGV2
LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRldik7
Cj4gICAKPiBAQCAtMjcwOSw3ICsyODk2LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9u
X3Nob3dfdmRkZ2Z4KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAl1MzIgdmRkZ2Z4Owo+ICAgCWlu
dCByLCBzaXplID0gc2l6ZW9mKHZkZGdmeCk7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVz
ZXQpCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVy
biAtRVBFUk07Cj4gICAKPiAgIAlyID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5k
ZXYpOwo+IEBAIC0yNzE4LDkgKzI5MDUsMTEgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9u
X3Nob3dfdmRkZ2Z4KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIHI7Cj4gICAJfQo+
ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAJLyogZ2V0IHRoZSB2b2x0
YWdlICovCj4gICAJciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NF
TlNPUl9WRERHRlgsCj4gICAJCQkJICAgKHZvaWQgKikmdmRkZ2Z4LCAmc2l6ZSk7Cj4gKwl1cF9y
ZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICAgCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVz
eShhZGV2LT5kZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYt
PmRkZXYtPmRldik7Cj4gQEAgLTI3NDYsNyArMjkzNSw3IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdw
dV9od21vbl9zaG93X3ZkZG5iKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAl1MzIgdmRkbmI7Cj4g
ICAJaW50IHIsIHNpemUgPSBzaXplb2YodmRkbmIpOwo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1
X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQly
ZXR1cm4gLUVQRVJNOwo+ICAgCj4gICAJLyogb25seSBBUFVzIGhhdmUgdmRkbmIgKi8KPiBAQCAt
Mjc1OSw5ICsyOTQ4LDExIEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93X3ZkZG5i
KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIHI7Cj4gICAJfQo+ICAgCj4gKwlkb3du
X3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAJLyogZ2V0IHRoZSB2b2x0YWdlICovCj4gICAJ
ciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9WREROQiwK
PiAgIAkJCQkgICAodm9pZCAqKSZ2ZGRuYiwgJnNpemUpOwo+ICsJdXBfcmVhZCgmYWRldi0+cmVz
ZXRfc2VtKTsKPiAgIAo+ICAgCXBtX3J1bnRpbWVfbWFya19sYXN0X2J1c3koYWRldi0+ZGRldi0+
ZGV2KTsKPiAgIAlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZChhZGV2LT5kZGV2LT5kZXYpOwo+
IEBAIC0yNzg4LDcgKzI5NzksNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hvd19w
b3dlcl9hdmcoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCWludCByLCBzaXplID0gc2l6ZW9mKHUz
Mik7Cj4gICAJdW5zaWduZWQgdXc7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpCj4g
KwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAtRVBF
Uk07Cj4gICAKPiAgIAlyID0gcG1fcnVudGltZV9nZXRfc3luYyhhZGV2LT5kZGV2LT5kZXYpOwo+
IEBAIC0yNzk3LDkgKzI5ODgsMTEgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3df
cG93ZXJfYXZnKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIHI7Cj4gICAJfQo+ICAg
Cj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAJLyogZ2V0IHRoZSB2b2x0YWdl
ICovCj4gICAJciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNP
Ul9HUFVfUE9XRVIsCj4gICAJCQkJICAgKHZvaWQgKikmcXVlcnksICZzaXplKTsKPiArCXVwX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAKPiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5
KGFkZXYtPmRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+
ZGRldi0+ZGV2KTsKPiBAQCAtMjgyOSw3ICszMDIyLDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1
X2h3bW9uX3Nob3dfcG93ZXJfY2FwX21heChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJc3NpemVf
dCBzaXplOwo+ICAgCWludCByOwo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJ
aWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQRVJN
Owo+ICAgCj4gICAJciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsKPiBA
QCAtMjgzOCw2ICszMDMxLDggQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3Nob3dfcG93
ZXJfY2FwX21heChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByOwo+ICAgCX0KPiAg
IAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlpZiAoaXNfc3VwcG9y
dF9zd19zbXUoYWRldikpIHsKPiAgIAkJc211X2dldF9wb3dlcl9saW1pdCgmYWRldi0+c211LCAm
bGltaXQsIHRydWUpOwo+ICAgCQlzaXplID0gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIldVxu
IiwgbGltaXQgKiAxMDAwMDAwKTsKPiBAQCAtMjg0OCw2ICszMDQzLDggQEAgc3RhdGljIHNzaXpl
X3QgYW1kZ3B1X2h3bW9uX3Nob3dfcG93ZXJfY2FwX21heChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4g
ICAJCXNpemUgPSBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIlxuIik7Cj4gICAJfQo+ICAgCj4g
Kwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50aW1lX21hcmtfbGFz
dF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQo
YWRldi0+ZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0yODYzLDcgKzMwNjAsNyBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfaHdtb25fc2hvd19wb3dlcl9jYXAoc3RydWN0IGRldmljZSAqZGV2LAo+ICAg
CXNzaXplX3Qgc2l6ZTsKPiAgIAlpbnQgcjsKPiAgIAo+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNl
dCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJu
IC1FUEVSTTsKPiAgIAo+ICAgCXIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRkZXYtPmRl
dik7Cj4gQEAgLTI4NzIsNiArMzA2OSw4IEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9z
aG93X3Bvd2VyX2NhcChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiByOwo+ICAgCX0K
PiAgIAo+ICsJZG93bl9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlpZiAoaXNfc3Vw
cG9ydF9zd19zbXUoYWRldikpIHsKPiAgIAkJc211X2dldF9wb3dlcl9saW1pdCgmYWRldi0+c211
LCAmbGltaXQsIGZhbHNlKTsKPiAgIAkJc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAi
JXVcbiIsIGxpbWl0ICogMTAwMDAwMCk7Cj4gQEAgLTI4ODIsNiArMzA4MSw4IEBAIHN0YXRpYyBz
c2l6ZV90IGFtZGdwdV9od21vbl9zaG93X3Bvd2VyX2NhcChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4g
ICAJCXNpemUgPSBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIlxuIik7Cj4gICAJfQo+ICAgCj4g
Kwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50aW1lX21hcmtfbGFz
dF9idXN5KGFkZXYtPmRkZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQo
YWRldi0+ZGRldi0+ZGV2KTsKPiAgIAo+IEBAIC0yODk4LDcgKzMwOTksNyBAQCBzdGF0aWMgc3Np
emVfdCBhbWRncHVfaHdtb25fc2V0X3Bvd2VyX2NhcChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJ
aW50IGVycjsKPiAgIAl1MzIgdmFsdWU7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQp
Cj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpCj4gICAJCXJldHVybiAt
RVBFUk07Cj4gICAKPiAgIAlpZiAoYW1kZ3B1X3NyaW92X3ZmKGFkZXYpKQo+IEBAIC0yOTE3LDYg
KzMxMTgsOCBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2V0X3Bvd2VyX2NhcChzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4gICAJCXJldHVybiBlcnI7Cj4gICAJfQo+ICAgCj4gKwlkb3duX3Jl
YWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gKwo+ICAgCWlmIChpc19zdXBwb3J0X3N3X3NtdShhZGV2
KSkKPiAgIAkJZXJyID0gc211X3NldF9wb3dlcl9saW1pdCgmYWRldi0+c211LCB2YWx1ZSk7Cj4g
ICAJZWxzZSBpZiAoYWRldi0+cG93ZXJwbGF5LnBwX2Z1bmNzICYmIGFkZXYtPnBvd2VycGxheS5w
cF9mdW5jcy0+c2V0X3Bvd2VyX2xpbWl0KQo+IEBAIC0yOTI0LDYgKzMxMjcsOCBAQCBzdGF0aWMg
c3NpemVfdCBhbWRncHVfaHdtb25fc2V0X3Bvd2VyX2NhcChzdHJ1Y3QgZGV2aWNlICpkZXYsCj4g
ICAJZWxzZQo+ICAgCQllcnIgPSAtRUlOVkFMOwo+ICAgCj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNl
dF9zZW0pOwo+ICsKPiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRkZXYtPmRl
dik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2KTsKPiAg
IAo+IEBAIC0yOTQxLDcgKzMxNDYsNyBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hv
d19zY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAl1aW50MzJfdCBzY2xrOwo+ICAgCWludCBy
LCBzaXplID0gc2l6ZW9mKHNjbGspOwo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+
ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVQ
RVJNOwo+ICAgCj4gICAJciA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoYWRldi0+ZGRldi0+ZGV2KTsK
PiBAQCAtMjk1MCw5ICszMTU1LDExIEBAIHN0YXRpYyBzc2l6ZV90IGFtZGdwdV9od21vbl9zaG93
X3NjbGsoc3RydWN0IGRldmljZSAqZGV2LAo+ICAgCQlyZXR1cm4gcjsKPiAgIAl9Cj4gICAKPiAr
CWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAgIAkvKiBnZXQgdGhlIHNjbGsgKi8KPiAg
IAlyID0gYW1kZ3B1X2RwbV9yZWFkX3NlbnNvcihhZGV2LCBBTURHUFVfUFBfU0VOU09SX0dGWF9T
Q0xLLAo+ICAgCQkJCSAgICh2b2lkICopJnNjbGssICZzaXplKTsKPiArCXVwX3JlYWQoJmFkZXYt
PnJlc2V0X3NlbSk7Cj4gICAKPiAgIAlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KGFkZXYtPmRk
ZXYtPmRldik7Cj4gICAJcG1fcnVudGltZV9wdXRfYXV0b3N1c3BlbmQoYWRldi0+ZGRldi0+ZGV2
KTsKPiBAQCAtMjk3OCw3ICszMTg1LDcgQEAgc3RhdGljIHNzaXplX3QgYW1kZ3B1X2h3bW9uX3No
b3dfbWNsayhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gICAJdWludDMyX3QgbWNsazsKPiAgIAlpbnQg
ciwgc2l6ZSA9IHNpemVvZihtY2xrKTsKPiAgIAo+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkK
PiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJuIC1F
UEVSTTsKPiAgIAo+ICAgCXIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGFkZXYtPmRkZXYtPmRldik7
Cj4gQEAgLTI5ODcsOSArMzE5NCwxMSBAQCBzdGF0aWMgc3NpemVfdCBhbWRncHVfaHdtb25fc2hv
d19tY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAgIAkJcmV0dXJuIHI7Cj4gICAJfQo+ICAgCj4g
Kwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAJLyogZ2V0IHRoZSBzY2xrICovCj4g
ICAJciA9IGFtZGdwdV9kcG1fcmVhZF9zZW5zb3IoYWRldiwgQU1ER1BVX1BQX1NFTlNPUl9HRlhf
TUNMSywKPiAgIAkJCQkgICAodm9pZCAqKSZtY2xrLCAmc2l6ZSk7Cj4gKwl1cF9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOwo+ICAgCj4gICAJcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShhZGV2LT5k
ZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGFkZXYtPmRkZXYtPmRl
dik7Cj4gQEAgLTM4NzAsNyArNDA3OSw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RlYnVnZnNfcG1f
aW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gICAJdTMyIGZsYWdzID0gMDsK
PiAgIAlpbnQgcjsKPiAgIAo+IC0JaWYgKGFkZXYtPmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9t
aWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJuIC1FUEVSTTsKPiAgIAo+
ICAgCXIgPSBwbV9ydW50aW1lX2dldF9zeW5jKGRldi0+ZGV2KTsKPiBAQCAtMzg3OSw3ICs0MDg4
LDEwIEBAIHN0YXRpYyBpbnQgYW1kZ3B1X2RlYnVnZnNfcG1faW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sIHZvaWQgKmRhdGEpCj4gICAJCXJldHVybiByOwo+ICAgCX0KPiAgIAo+ICsJZG93bl9yZWFk
KCZhZGV2LT5yZXNldF9zZW0pOwo+ICAgCWFtZGdwdV9kZXZpY2VfaXBfZ2V0X2Nsb2NrZ2F0aW5n
X3N0YXRlKGFkZXYsICZmbGFncyk7Cj4gKwl1cF9yZWFkKCZhZGV2LT5yZXNldF9zZW0pOwo+ICsK
PiAgIAlzZXFfcHJpbnRmKG0sICJDbG9jayBHYXRpbmcgRmxhZ3MgTWFzazogMHgleFxuIiwgZmxh
Z3MpOwo+ICAgCWFtZGdwdV9wYXJzZV9jZ19zdGF0ZShtLCBmbGFncyk7Cj4gICAJc2VxX3ByaW50
ZihtLCAiXG4iKTsKPiBAQCAtMzg5MSw2ICs0MTAzLDcgQEAgc3RhdGljIGludCBhbWRncHVfZGVi
dWdmc19wbV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiAgIAkJcmV0dXJu
IDA7Cj4gICAJfQo+ICAgCj4gKwlkb3duX3JlYWQoJmFkZXYtPnJlc2V0X3NlbSk7Cj4gICAJaWYg
KCFpc19zdXBwb3J0X3N3X3NtdShhZGV2KSAmJgo+ICAgCSAgICBhZGV2LT5wb3dlcnBsYXkucHBf
ZnVuY3MtPmRlYnVnZnNfcHJpbnRfY3VycmVudF9wZXJmb3JtYW5jZV9sZXZlbCkgewo+ICAgCQlt
dXRleF9sb2NrKCZhZGV2LT5wbS5tdXRleCk7Cj4gQEAgLTM5MDMsNiArNDExNiw3IEBAIHN0YXRp
YyBpbnQgYW1kZ3B1X2RlYnVnZnNfcG1faW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpCj4gICAJfSBlbHNlIHsKPiAgIAkJciA9IGFtZGdwdV9kZWJ1Z2ZzX3BtX2luZm9fcHAobSwg
YWRldik7Cj4gICAJfQo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAgIAo+ICAgCXBt
X3J1bnRpbWVfbWFya19sYXN0X2J1c3koZGV2LT5kZXYpOwo+ICAgCXBtX3J1bnRpbWVfcHV0X2F1
dG9zdXNwZW5kKGRldi0+ZGV2KTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3BzcC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Bz
cC5jCj4gaW5kZXggZTIwNjk1YjQ0ZGJlLi5hYjA4ODNlZWFkYjMgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BzcC5jCj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3BzcC5jCj4gQEAgLTE2ODIsNyArMTY4Miw3IEBAIHN0YXRp
YyBpbnQgcHNwX2xvYWRfc211X2Z3KHN0cnVjdCBwc3BfY29udGV4dCAqcHNwKQo+ICAgCQlyZXR1
cm4gMDsKPiAgIAo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0ICYmIHJhcyAmJiByYXMt
PnN1cHBvcnRlZCkgewo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpICYm
IHJhcyAmJiByYXMtPnN1cHBvcnRlZCkgewo+ICAgCQlyZXQgPSBhbWRncHVfZHBtX3NldF9tcDFf
c3RhdGUoYWRldiwgUFBfTVAxX1NUQVRFX1VOTE9BRCk7Cj4gICAJCWlmIChyZXQpIHsKPiAgIAkJ
CURSTV9XQVJOKCJGYWlsZWQgdG8gc2V0IE1QMSBzdGF0ZSBwcmVwYXJlIGZvciByZWxvYWRcbiIp
Owo+IEBAIC0xNzk2LDcgKzE3OTYsNyBAQCBzdGF0aWMgaW50IHBzcF9sb2FkX2Z3KHN0cnVjdCBh
bWRncHVfZGV2aWNlICphZGV2KQo+ICAgCWludCByZXQ7Cj4gICAJc3RydWN0IHBzcF9jb250ZXh0
ICpwc3AgPSAmYWRldi0+cHNwOwo+ICAgCj4gLQlpZiAoYW1kZ3B1X3NyaW92X3ZmKGFkZXYpICYm
IGFkZXYtPmluX2dwdV9yZXNldCkgewo+ICsJaWYgKGFtZGdwdV9zcmlvdl92ZihhZGV2KSAmJiBh
dG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkgewo+ICAgCQlwc3BfcmluZ19zdG9wKHBz
cCwgUFNQX1JJTkdfVFlQRV9fS00pOyAvKiBzaG91bGQgbm90IGRlc3Ryb3kgcmluZywgb25seSBz
dG9wICovCj4gICAJCWdvdG8gc2tpcF9tZW1hbGxvYzsKPiAgIAl9Cj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9yYXMuYwo+IGluZGV4IGFiOGU3YzkxYzY0NS4uM2U1MzQyNjJlMzgx
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuYwo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9yYXMuYwo+IEBAIC0xOTc1
LDcgKzE5NzUsNyBAQCBpbnQgYW1kZ3B1X3Jhc19sYXRlX2luaXQoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsCj4gICAJCQlhbWRncHVfcmFzX3JlcXVlc3RfcmVzZXRfb25fYm9vdChhZGV2LAo+
ICAgCQkJCQlyYXNfYmxvY2stPmJsb2NrKTsKPiAgIAkJCXJldHVybiAwOwo+IC0JCX0gZWxzZSBp
ZiAoYWRldi0+aW5fc3VzcGVuZCB8fCBhZGV2LT5pbl9ncHVfcmVzZXQpIHsKPiArCQl9IGVsc2Ug
aWYgKGFkZXYtPmluX3N1c3BlbmQgfHwgYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkp
IHsKPiAgIAkJCS8qIGluIHJlc3VtZSBwaGFzZSwgaWYgZmFpbCB0byBlbmFibGUgcmFzLAo+ICAg
CQkJICogY2xlYW4gdXAgYWxsIHJhcyBmcyBub2RlcywgYW5kIGRpc2FibGUgcmFzICovCj4gICAJ
CQlnb3RvIGNsZWFudXA7Cj4gQEAgLTE5ODQsNyArMTk4NCw3IEBAIGludCBhbWRncHVfcmFzX2xh
dGVfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgIAl9Cj4gICAKPiAgIAkvKiBp
biByZXN1bWUgcGhhc2UsIG5vIG5lZWQgdG8gY3JlYXRlIHJhcyBmcyBub2RlICovCj4gLQlpZiAo
YWRldi0+aW5fc3VzcGVuZCB8fCBhZGV2LT5pbl9ncHVfcmVzZXQpCj4gKwlpZiAoYWRldi0+aW5f
c3VzcGVuZCB8fCBhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkKPiAgIAkJcmV0dXJu
IDA7Cj4gICAKPiAgIAlpZiAoaWhfaW5mby0+Y2IpIHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X3R0bS5jCj4gaW5kZXggNTZiZWFmYmQzYWI5Li4yZTY3MGFhNjg3NTggMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCj4gQEAgLTIwOTMsNyArMjA5
Myw3IEBAIHZvaWQgYW1kZ3B1X3R0bV9zZXRfYnVmZmVyX2Z1bmNzX3N0YXR1cyhzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiwgYm9vbCBlbmFibGUpCj4gICAJdWludDY0X3Qgc2l6ZTsKPiAgIAlp
bnQgcjsKPiAgIAo+IC0JaWYgKCFhZGV2LT5tbWFuLmluaXRpYWxpemVkIHx8IGFkZXYtPmluX2dw
dV9yZXNldCB8fAo+ICsJaWYgKCFhZGV2LT5tbWFuLmluaXRpYWxpemVkIHx8IGF0b21pY19yZWFk
KCZhZGV2LT5pbl9ncHVfcmVzZXQpIHx8Cj4gICAJICAgIGFkZXYtPm1tYW4uYnVmZmVyX2Z1bmNz
X2VuYWJsZWQgPT0gZW5hYmxlKQo+ICAgCQlyZXR1cm47Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Vjb2RlLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9hbWRncHVfdWNvZGUuYwo+IGluZGV4IDc0NDQwNGEwNWZlZS4uZGE2ZmEyOGIx
YjVmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV91Y29k
ZS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3Vjb2RlLmMKPiBA
QCAtNjI4LDcgKzYyOCw3IEBAIGludCBhbWRncHVfdWNvZGVfaW5pdF9ibyhzdHJ1Y3QgYW1kZ3B1
X2RldmljZSAqYWRldikKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2Zpcm13YXJlX2luZm8gKnVjb2RlID0g
TlVMTDsKPiAgIAo+ICAgIC8qIGZvciBiYXJlbWV0YWwsIHRoZSB1Y29kZSBpcyBhbGxvY2F0ZWQg
aW4gZ3R0LCBzbyBkb24ndCBuZWVkIHRvIGZpbGwgdGhlIGJvIHdoZW4gcmVzZXQvc3VzcGVuZCAq
Lwo+IC0JaWYgKCFhbWRncHVfc3Jpb3ZfdmYoYWRldikgJiYgKGFkZXYtPmluX2dwdV9yZXNldCB8
fCBhZGV2LT5pbl9zdXNwZW5kKSkKPiArCWlmICghYW1kZ3B1X3NyaW92X3ZmKGFkZXYpICYmIChh
dG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSB8fCBhZGV2LT5pbl9zdXNwZW5kKSkKPiAg
IAkJcmV0dXJuIDA7Cj4gICAJLyoKPiAgIAkgKiBpZiBTTVUgbG9hZGVkIGZpcm13YXJlLCBpdCBu
ZWVkbid0IGFkZCBTTUMsIFVWRCwgYW5kIFZDRQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfdmlydC5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X3ZpcnQuaAo+IGluZGV4IGY4MjY5NDU5ODljNy4uMzM2ZmE4YmEyNDY1IDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92aXJ0LmgKPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdmlydC5oCj4gQEAgLTMyNSw5ICszMjUs
OSBAQCBzdGF0aWMgaW5saW5lIGJvb2wgaXNfdmlydHVhbF9tYWNoaW5lKHZvaWQpCj4gICAjZGVm
aW5lIGFtZGdwdV9zcmlvdl9pc19wcF9vbmVfdmYoYWRldikgXAo+ICAgCSgoYWRldiktPnZpcnQu
Z2ltX2ZlYXR1cmUgJiBBTURHSU1fRkVBVFVSRV9QUF9PTkVfVkYpCj4gICAjZGVmaW5lIGFtZGdw
dV9zcmlvdl9pc19kZWJ1ZyhhZGV2KSBcCj4gLQkoKCFhZGV2LT5pbl9ncHVfcmVzZXQpICYmIGFk
ZXYtPnZpcnQudGRyX2RlYnVnKQo+ICsJKCghYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNl
dCkpICYmIGFkZXYtPnZpcnQudGRyX2RlYnVnKQo+ICAgI2RlZmluZSBhbWRncHVfc3Jpb3ZfaXNf
bm9ybWFsKGFkZXYpIFwKPiAtCSgoIWFkZXYtPmluX2dwdV9yZXNldCkgJiYgKCFhZGV2LT52aXJ0
LnRkcl9kZWJ1ZykpCj4gKwkoKCFhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkgJiYg
KCFhZGV2LT52aXJ0LnRkcl9kZWJ1ZykpCj4gICAKPiAgIGJvb2wgYW1kZ3B1X3ZpcnRfbW1pb19i
bG9ja2VkKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KTsKPiAgIHZvaWQgYW1kZ3B1X3ZpcnRf
aW5pdF9zZXR0aW5nKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KTsKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3YxMF8wLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9nZnhfdjEwXzAuYwo+IGluZGV4IGE2MTcwYTM0NmIzOS4uYjNjMWUwNWRhNDVl
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92MTBfMC5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3YxMF8wLmMKPiBAQCAtNjEwMiw3
ICs2MTAyLDcgQEAgc3RhdGljIGludCBnZnhfdjEwXzBfZ2Z4X2luaXRfcXVldWUoc3RydWN0IGFt
ZGdwdV9yaW5nICpyaW5nKQo+ICAgCXN0cnVjdCB2MTBfZ2Z4X21xZCAqbXFkID0gcmluZy0+bXFk
X3B0cjsKPiAgIAlpbnQgbXFkX2lkeCA9IHJpbmcgLSAmYWRldi0+Z2Z4LmdmeF9yaW5nWzBdOwo+
ICAgCj4gLQlpZiAoIWFkZXYtPmluX2dwdV9yZXNldCAmJiAhYWRldi0+aW5fc3VzcGVuZCkgewo+
ICsJaWYgKCFhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSAmJiAhYWRldi0+aW5fc3Vz
cGVuZCkgewo+ICAgCQltZW1zZXQoKHZvaWQgKiltcWQsIDAsIHNpemVvZigqbXFkKSk7Cj4gICAJ
CW11dGV4X2xvY2soJmFkZXYtPnNyYm1fbXV0ZXgpOwo+ICAgCQludl9ncmJtX3NlbGVjdChhZGV2
LCByaW5nLT5tZSwgcmluZy0+cGlwZSwgcmluZy0+cXVldWUsIDApOwo+IEBAIC02MTE0LDcgKzYx
MTQsNyBAQCBzdGF0aWMgaW50IGdmeF92MTBfMF9nZnhfaW5pdF9xdWV1ZShzdHJ1Y3QgYW1kZ3B1
X3JpbmcgKnJpbmcpCj4gICAJCW11dGV4X3VubG9jaygmYWRldi0+c3JibV9tdXRleCk7Cj4gICAJ
CWlmIChhZGV2LT5nZngubWUubXFkX2JhY2t1cFttcWRfaWR4XSkKPiAgIAkJCW1lbWNweShhZGV2
LT5nZngubWUubXFkX2JhY2t1cFttcWRfaWR4XSwgbXFkLCBzaXplb2YoKm1xZCkpOwo+IC0JfSBl
bHNlIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsKPiArCX0gZWxzZSBpZiAoYXRvbWljX3JlYWQo
JmFkZXYtPmluX2dwdV9yZXNldCkpIHsKPiAgIAkJLyogcmVzZXQgbXFkIHdpdGggdGhlIGJhY2t1
cCBjb3B5ICovCj4gICAJCWlmIChhZGV2LT5nZngubWUubXFkX2JhY2t1cFttcWRfaWR4XSkKPiAg
IAkJCW1lbWNweShtcWQsIGFkZXYtPmdmeC5tZS5tcWRfYmFja3VwW21xZF9pZHhdLCBzaXplb2Yo
Km1xZCkpOwo+IEBAIC02NDYzLDcgKzY0NjMsNyBAQCBzdGF0aWMgaW50IGdmeF92MTBfMF9raXFf
aW5pdF9xdWV1ZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpCj4gICAKPiAgIAlnZnhfdjEwXzBf
a2lxX3NldHRpbmcocmluZyk7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsgLyog
Zm9yIEdQVV9SRVNFVCBjYXNlICovCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9y
ZXNldCkpIHsgLyogZm9yIEdQVV9SRVNFVCBjYXNlICovCj4gICAJCS8qIHJlc2V0IE1RRCB0byBh
IGNsZWFuIHN0YXR1cyAqLwo+ICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9p
ZHhdKQo+ICAgCQkJbWVtY3B5KG1xZCwgYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhd
LCBzaXplb2YoKm1xZCkpOwo+IEBAIC02NDk5LDcgKzY0OTksNyBAQCBzdGF0aWMgaW50IGdmeF92
MTBfMF9rY3FfaW5pdF9xdWV1ZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpCj4gICAJc3RydWN0
IHYxMF9jb21wdXRlX21xZCAqbXFkID0gcmluZy0+bXFkX3B0cjsKPiAgIAlpbnQgbXFkX2lkeCA9
IHJpbmcgLSAmYWRldi0+Z2Z4LmNvbXB1dGVfcmluZ1swXTsKPiAgIAo+IC0JaWYgKCFhZGV2LT5p
bl9ncHVfcmVzZXQgJiYgIWFkZXYtPmluX3N1c3BlbmQpIHsKPiArCWlmICghYXRvbWljX3JlYWQo
JmFkZXYtPmluX2dwdV9yZXNldCkgJiYgIWFkZXYtPmluX3N1c3BlbmQpIHsKPiAgIAkJbWVtc2V0
KCh2b2lkICopbXFkLCAwLCBzaXplb2YoKm1xZCkpOwo+ICAgCQltdXRleF9sb2NrKCZhZGV2LT5z
cmJtX211dGV4KTsKPiAgIAkJbnZfZ3JibV9zZWxlY3QoYWRldiwgcmluZy0+bWUsIHJpbmctPnBp
cGUsIHJpbmctPnF1ZXVlLCAwKTsKPiBAQCAtNjUwOSw3ICs2NTA5LDcgQEAgc3RhdGljIGludCBn
ZnhfdjEwXzBfa2NxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQo+ICAgCj4g
ICAJCWlmIChhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0pCj4gICAJCQltZW1jcHko
YWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdLCBtcWQsIHNpemVvZigqbXFkKSk7Cj4g
LQl9IGVsc2UgaWYgKGFkZXYtPmluX2dwdV9yZXNldCkgeyAvKiBmb3IgR1BVX1JFU0VUIGNhc2Ug
Ki8KPiArCX0gZWxzZSBpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpIHsgLyog
Zm9yIEdQVV9SRVNFVCBjYXNlICovCj4gICAJCS8qIHJlc2V0IE1RRCB0byBhIGNsZWFuIHN0YXR1
cyAqLwo+ICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdKQo+ICAgCQkJ
bWVtY3B5KG1xZCwgYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdLCBzaXplb2YoKm1x
ZCkpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjhfMC5j
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y4XzAuYwo+IGluZGV4IDMzZjFjNGE0
NmViZS4uYzcwZjNiYzVjZWEyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2dmeF92OF8wLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjhf
MC5jCj4gQEAgLTQ2MzIsNyArNDYzMiw3IEBAIHN0YXRpYyBpbnQgZ2Z4X3Y4XzBfa2lxX2luaXRf
cXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQo+ICAgCj4gICAJZ2Z4X3Y4XzBfa2lxX3Nl
dHRpbmcocmluZyk7Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsgLyogZm9yIEdQ
VV9SRVNFVCBjYXNlICovCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkp
IHsgLyogZm9yIEdQVV9SRVNFVCBjYXNlICovCj4gICAJCS8qIHJlc2V0IE1RRCB0byBhIGNsZWFu
IHN0YXR1cyAqLwo+ICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdKQo+
ICAgCQkJbWVtY3B5KG1xZCwgYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdLCBzaXpl
b2Yoc3RydWN0IHZpX21xZF9hbGxvY2F0aW9uKSk7Cj4gQEAgLTQ2NjksNyArNDY2OSw3IEBAIHN0
YXRpYyBpbnQgZ2Z4X3Y4XzBfa2NxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5n
KQo+ICAgCXN0cnVjdCB2aV9tcWQgKm1xZCA9IHJpbmctPm1xZF9wdHI7Cj4gICAJaW50IG1xZF9p
ZHggPSByaW5nIC0gJmFkZXYtPmdmeC5jb21wdXRlX3JpbmdbMF07Cj4gICAKPiAtCWlmICghYWRl
di0+aW5fZ3B1X3Jlc2V0ICYmICFhZGV2LT5pbl9zdXNwZW5kKSB7Cj4gKwlpZiAoIWF0b21pY19y
ZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpICYmICFhZGV2LT5pbl9zdXNwZW5kKSB7Cj4gICAJCW1l
bXNldCgodm9pZCAqKW1xZCwgMCwgc2l6ZW9mKHN0cnVjdCB2aV9tcWRfYWxsb2NhdGlvbikpOwo+
ICAgCQkoKHN0cnVjdCB2aV9tcWRfYWxsb2NhdGlvbiAqKW1xZCktPmR5bmFtaWNfY3VfbWFzayA9
IDB4RkZGRkZGRkY7Cj4gICAJCSgoc3RydWN0IHZpX21xZF9hbGxvY2F0aW9uICopbXFkKS0+ZHlu
YW1pY19yYl9tYXNrID0gMHhGRkZGRkZGRjsKPiBAQCAtNDY4MSw3ICs0NjgxLDcgQEAgc3RhdGlj
IGludCBnZnhfdjhfMF9rY3FfaW5pdF9xdWV1ZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpCj4g
ICAKPiAgIAkJaWYgKGFkZXYtPmdmeC5tZWMubXFkX2JhY2t1cFttcWRfaWR4XSkKPiAgIAkJCW1l
bWNweShhZGV2LT5nZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0sIG1xZCwgc2l6ZW9mKHN0cnVj
dCB2aV9tcWRfYWxsb2NhdGlvbikpOwo+IC0JfSBlbHNlIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQp
IHsgLyogZm9yIEdQVV9SRVNFVCBjYXNlICovCj4gKwl9IGVsc2UgaWYgKGF0b21pY19yZWFkKCZh
ZGV2LT5pbl9ncHVfcmVzZXQpKSB7IC8qIGZvciBHUFVfUkVTRVQgY2FzZSAqLwo+ICAgCQkvKiBy
ZXNldCBNUUQgdG8gYSBjbGVhbiBzdGF0dXMgKi8KPiAgIAkJaWYgKGFkZXYtPmdmeC5tZWMubXFk
X2JhY2t1cFttcWRfaWR4XSkKPiAgIAkJCW1lbWNweShtcWQsIGFkZXYtPmdmeC5tZWMubXFkX2Jh
Y2t1cFttcWRfaWR4XSwgc2l6ZW9mKHN0cnVjdCB2aV9tcWRfYWxsb2NhdGlvbikpOwo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYwo+IGluZGV4IGNiOWQ2MGE0ZTA1ZS4uOTAyMGEw
ZjQwZTI4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeF92OV8w
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jCj4gQEAgLTM2
ODQsNyArMzY4NCw3IEBAIHN0YXRpYyBpbnQgZ2Z4X3Y5XzBfa2lxX2luaXRfcXVldWUoc3RydWN0
IGFtZGdwdV9yaW5nICpyaW5nKQo+ICAgCj4gICAJZ2Z4X3Y5XzBfa2lxX3NldHRpbmcocmluZyk7
Cj4gICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsgLyogZm9yIEdQVV9SRVNFVCBjYXNl
ICovCj4gKwlpZiAoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dwdV9yZXNldCkpIHsgLyogZm9yIEdQ
VV9SRVNFVCBjYXNlICovCj4gICAJCS8qIHJlc2V0IE1RRCB0byBhIGNsZWFuIHN0YXR1cyAqLwo+
ICAgCQlpZiAoYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdKQo+ICAgCQkJbWVtY3B5
KG1xZCwgYWRldi0+Z2Z4Lm1lYy5tcWRfYmFja3VwW21xZF9pZHhdLCBzaXplb2Yoc3RydWN0IHY5
X21xZF9hbGxvY2F0aW9uKSk7Cj4gQEAgLTM3MjIsNyArMzcyMiw3IEBAIHN0YXRpYyBpbnQgZ2Z4
X3Y5XzBfa2NxX2luaXRfcXVldWUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQo+ICAgCXN0cnVj
dCB2OV9tcWQgKm1xZCA9IHJpbmctPm1xZF9wdHI7Cj4gICAJaW50IG1xZF9pZHggPSByaW5nIC0g
JmFkZXYtPmdmeC5jb21wdXRlX3JpbmdbMF07Cj4gICAKPiAtCWlmICghYWRldi0+aW5fZ3B1X3Jl
c2V0ICYmICFhZGV2LT5pbl9zdXNwZW5kKSB7Cj4gKwlpZiAoIWF0b21pY19yZWFkKCZhZGV2LT5p
bl9ncHVfcmVzZXQpICYmICFhZGV2LT5pbl9zdXNwZW5kKSB7Cj4gICAJCW1lbXNldCgodm9pZCAq
KW1xZCwgMCwgc2l6ZW9mKHN0cnVjdCB2OV9tcWRfYWxsb2NhdGlvbikpOwo+ICAgCQkoKHN0cnVj
dCB2OV9tcWRfYWxsb2NhdGlvbiAqKW1xZCktPmR5bmFtaWNfY3VfbWFzayA9IDB4RkZGRkZGRkY7
Cj4gICAJCSgoc3RydWN0IHY5X21xZF9hbGxvY2F0aW9uICopbXFkKS0+ZHluYW1pY19yYl9tYXNr
ID0gMHhGRkZGRkZGRjsKPiBAQCAtMzczNCw3ICszNzM0LDcgQEAgc3RhdGljIGludCBnZnhfdjlf
MF9rY3FfaW5pdF9xdWV1ZShzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpCj4gICAKPiAgIAkJaWYg
KGFkZXYtPmdmeC5tZWMubXFkX2JhY2t1cFttcWRfaWR4XSkKPiAgIAkJCW1lbWNweShhZGV2LT5n
ZngubWVjLm1xZF9iYWNrdXBbbXFkX2lkeF0sIG1xZCwgc2l6ZW9mKHN0cnVjdCB2OV9tcWRfYWxs
b2NhdGlvbikpOwo+IC0JfSBlbHNlIGlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsgLyogZm9yIEdQ
VV9SRVNFVCBjYXNlICovCj4gKwl9IGVsc2UgaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVf
cmVzZXQpKSB7IC8qIGZvciBHUFVfUkVTRVQgY2FzZSAqLwo+ICAgCQkvKiByZXNldCBNUUQgdG8g
YSBjbGVhbiBzdGF0dXMgKi8KPiAgIAkJaWYgKGFkZXYtPmdmeC5tZWMubXFkX2JhY2t1cFttcWRf
aWR4XSkKPiAgIAkJCW1lbWNweShtcWQsIGFkZXYtPmdmeC5tZWMubXFkX2JhY2t1cFttcWRfaWR4
XSwgc2l6ZW9mKHN0cnVjdCB2OV9tcWRfYWxsb2NhdGlvbikpOwo+IEBAIC0zOTI4LDcgKzM5Mjgs
NyBAQCBzdGF0aWMgaW50IGdmeF92OV8wX2h3X2Zpbmkodm9pZCAqaGFuZGxlKQo+ICAgCS8qIFVz
ZSBkZWluaXRpYWxpemUgc2VxdWVuY2UgZnJvbSBDQUlMIHdoZW4gdW5iaW5kaW5nIGRldmljZSBm
cm9tIGRyaXZlciwKPiAgIAkgKiBvdGhlcndpc2UgS0lRIGlzIGhhbmdpbmcgd2hlbiBiaW5kaW5n
IGJhY2sKPiAgIAkgKi8KPiAtCWlmICghYWRldi0+aW5fZ3B1X3Jlc2V0ICYmICFhZGV2LT5pbl9z
dXNwZW5kKSB7Cj4gKwlpZiAoIWF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpICYmICFh
ZGV2LT5pbl9zdXNwZW5kKSB7Cj4gICAJCW11dGV4X2xvY2soJmFkZXYtPnNyYm1fbXV0ZXgpOwo+
ICAgCQlzb2MxNV9ncmJtX3NlbGVjdChhZGV2LCBhZGV2LT5nZngua2lxLnJpbmcubWUsCj4gICAJ
CQkJYWRldi0+Z2Z4LmtpcS5yaW5nLnBpcGUsCj4gQEAgLTQwODYsNyArNDA4Niw3IEBAIHN0YXRp
YyB1aW50NjRfdCBnZnhfdjlfMF9raXFfcmVhZF9jbG9jayhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldikKPiAgIAkgKgo+ICAgCSAqIGFsc28gZG9uJ3Qgd2FpdCBhbnltb3JlIGZvciBJUlEgY29u
dGV4dAo+ICAgCSAqICovCj4gLQlpZiAociA8IDEgJiYgKGFkZXYtPmluX2dwdV9yZXNldCB8fCBp
bl9pbnRlcnJ1cHQoKSkpCj4gKwlpZiAociA8IDEgJiYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9n
cHVfcmVzZXQpIHx8IGluX2ludGVycnVwdCgpKSkKPiAgIAkJZ290byBmYWlsZWRfa2lxX3JlYWQ7
Cj4gICAKPiAgIAltaWdodF9zbGVlcCgpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9nbWNfdjEwXzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192
MTBfMC5jCj4gaW5kZXggOGYyOWY3OWY4MjBkLi5iNzYxYmY1OWVkMTEgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3YxMF8wLmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9nbWNfdjEwXzAuYwo+IEBAIC0zNTYsNyArMzU2LDcgQEAgc3RhdGlj
IHZvaWQgZ21jX3YxMF8wX2ZsdXNoX2dwdV90bGIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
IHVpbnQzMl90IHZtaWQsCj4gICAJICovCj4gICAJaWYgKGFkZXYtPmdmeC5raXEucmluZy5zY2hl
ZC5yZWFkeSAmJgo+ICAgCSAgICAoYW1kZ3B1X3NyaW92X3J1bnRpbWUoYWRldikgfHwgIWFtZGdw
dV9zcmlvdl92ZihhZGV2KSkgJiYKPiAtCSAgICAhYWRldi0+aW5fZ3B1X3Jlc2V0KSB7Cj4gKwkg
ICAgIWF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKSB7Cj4gICAKPiAgIAkJc3RydWN0
IGFtZGdwdV92bWh1YiAqaHViID0gJmFkZXYtPnZtaHViW3ZtaHViXTsKPiAgIAkJY29uc3QgdW5z
aWduZWQgZW5nID0gMTc7Cj4gQEAgLTM4MSw3ICszODEsNyBAQCBzdGF0aWMgdm9pZCBnbWNfdjEw
XzBfZmx1c2hfZ3B1X3RsYihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgdWludDMyX3Qgdm1p
ZCwKPiAgIAo+ICAgCWlmICghYWRldi0+bW1hbi5idWZmZXJfZnVuY3NfZW5hYmxlZCB8fAo+ICAg
CSAgICAhYWRldi0+aWJfcG9vbF9yZWFkeSB8fAo+IC0JICAgIGFkZXYtPmluX2dwdV9yZXNldCB8
fAo+ICsJICAgIGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpIHx8Cj4gICAJICAgIHJp
bmctPnNjaGVkLnJlYWR5ID09IGZhbHNlKSB7Cj4gICAJCWdtY192MTBfMF9mbHVzaF92bV9odWIo
YWRldiwgdm1pZCwgQU1ER1BVX0dGWEhVQl8wLCAwKTsKPiAgIAkJbXV0ZXhfdW5sb2NrKCZhZGV2
LT5tbWFuLmd0dF93aW5kb3dfbG9jayk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2dtY192N18wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjdf
MC5jCj4gaW5kZXggZTE4Mjk2ZGMxMzg2Li5kODNiODM0NTliYTcgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y3XzAuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2dtY192N18wLmMKPiBAQCAtNDM0LDcgKzQzNCw3IEBAIHN0YXRpYyBpbnQg
Z21jX3Y3XzBfZmx1c2hfZ3B1X3RsYl9wYXNpZChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwK
PiAgIAlpbnQgdm1pZDsKPiAgIAl1bnNpZ25lZCBpbnQgdG1wOwo+ICAgCj4gLQlpZiAoYWRldi0+
aW5fZ3B1X3Jlc2V0KQo+ICsJaWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+
ICAgCQlyZXR1cm4gLUVJTzsKPiAgIAo+ICAgCWZvciAodm1pZCA9IDE7IHZtaWQgPCAxNjsgdm1p
ZCsrKSB7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OF8w
LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjhfMC5jCj4gaW5kZXggYTllNzIy
YjhhNDU4Li41ODU0ZGY2ZGNjMzIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvZ21jX3Y4XzAuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192
OF8wLmMKPiBAQCAtNjM1LDcgKzYzNSw3IEBAIHN0YXRpYyBpbnQgZ21jX3Y4XzBfZmx1c2hfZ3B1
X3RsYl9wYXNpZChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAgIAlpbnQgdm1pZDsKPiAg
IAl1bnNpZ25lZCBpbnQgdG1wOwo+ICAgCj4gLQlpZiAoYWRldi0+aW5fZ3B1X3Jlc2V0KQo+ICsJ
aWYgKGF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKQo+ICAgCQlyZXR1cm4gLUVJTzsK
PiAgIAo+ICAgCWZvciAodm1pZCA9IDE7IHZtaWQgPCAxNjsgdm1pZCsrKSB7Cj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMgYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9nbWNfdjlfMC5jCj4gaW5kZXggNmU0ZjNmZjQ4MTBmLi5iODJhMWFmODZm
NDMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y5XzAuYwo+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMKPiBAQCAtNTAxLDcg
KzUwMSw3IEBAIHN0YXRpYyB2b2lkIGdtY192OV8wX2ZsdXNoX2dwdV90bGIoc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsIHVpbnQzMl90IHZtaWQsCj4gICAJICovCj4gICAJaWYgKGFkZXYtPmdm
eC5raXEucmluZy5zY2hlZC5yZWFkeSAmJgo+ICAgCQkJKGFtZGdwdV9zcmlvdl9ydW50aW1lKGFk
ZXYpIHx8ICFhbWRncHVfc3Jpb3ZfdmYoYWRldikpICYmCj4gLQkJCSFhZGV2LT5pbl9ncHVfcmVz
ZXQpIHsKPiArCQkJIWF0b21pY19yZWFkKCZhZGV2LT5pbl9ncHVfcmVzZXQpKSB7Cj4gICAJCXVp
bnQzMl90IHJlcSA9IGh1Yi0+dm1faW52X2VuZzBfcmVxICsgaHViLT5lbmdfZGlzdGFuY2UgKiBl
bmc7Cj4gICAJCXVpbnQzMl90IGFjayA9IGh1Yi0+dm1faW52X2VuZzBfYWNrICsgaHViLT5lbmdf
ZGlzdGFuY2UgKiBlbmc7Cj4gICAKPiBAQCAtNTk2LDcgKzU5Niw3IEBAIHN0YXRpYyBpbnQgZ21j
X3Y5XzBfZmx1c2hfZ3B1X3RsYl9wYXNpZChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPiAg
IAlzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcgPSAmYWRldi0+Z2Z4LmtpcS5yaW5nOwo+ICAgCXN0
cnVjdCBhbWRncHVfa2lxICpraXEgPSAmYWRldi0+Z2Z4LmtpcTsKPiAgIAo+IC0JaWYgKGFkZXYt
PmluX2dwdV9yZXNldCkKPiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSkK
PiAgIAkJcmV0dXJuIC1FSU87Cj4gICAKPiAgIAlpZiAocmluZy0+c2NoZWQucmVhZHkpIHsKPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbXhncHVfYWkuYyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X2FpLmMKPiBpbmRleCA1ZmQ2N2UxY2MyYTAuLmZl
MzFjYmVjY2ZlOSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9teGdw
dV9haS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbXhncHVfYWkuYwo+IEBA
IC0yMzgsMjAgKzIzOCwxNiBAQCBzdGF0aWMgdm9pZCB4Z3B1X2FpX21haWxib3hfZmxyX3dvcmso
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ICAgCXN0cnVjdCBhbWRncHVfdmlydCAqdmlydCA9
IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgYW1kZ3B1X3ZpcnQsIGZscl93b3JrKTsKPiAgIAlz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGNvbnRhaW5lcl9vZih2aXJ0LCBzdHJ1Y3QgYW1k
Z3B1X2RldmljZSwgdmlydCk7Cj4gICAJaW50IHRpbWVvdXQgPSBBSV9NQUlMQk9YX1BPTExfRkxS
X1RJTUVET1VUOwo+IC0JaW50IGxvY2tlZDsKPiAgIAo+ICAgCS8qIGJsb2NrIGFtZGdwdV9ncHVf
cmVjb3ZlciB0aWxsIG1zZyBGTFIgQ09NUExFVEUgcmVjZWl2ZWQsCj4gICAJICogb3RoZXJ3aXNl
IHRoZSBtYWlsYm94IG1zZyB3aWxsIGJlIHJ1aW5lZC9yZXNldGVkIGJ5Cj4gICAJICogdGhlIFZG
IEZMUi4KPiAgIAkgKgo+IC0JICogd2UgY2FuIHVubG9jayB0aGUgbG9ja19yZXNldCB0byBhbGxv
dyAiYW1kZ3B1X2pvYl90aW1lZG91dCIKPiArCSAqIHdlIGNhbiB1bmxvY2sgdGhlIHJlc2V0X3Nl
bSB0byBhbGxvdyAiYW1kZ3B1X2pvYl90aW1lZG91dCIKPiAgIAkgKiB0byBydW4gZ3B1X3JlY292
ZXIoKSBhZnRlciBGTFJfTk9USUZJQ0FUSU9OX0NNUEwgcmVjZWl2ZWQKPiAgIAkgKiB3aGljaCBt
ZWFucyBob3N0IHNpZGUgaGFkIGZpbmlzaGVkIHRoaXMgVkYncyBGTFIuCj4gICAJICovCj4gLQls
b2NrZWQgPSBtdXRleF90cnlsb2NrKCZhZGV2LT5sb2NrX3Jlc2V0KTsKPiAtCWlmIChsb2NrZWQp
Cj4gLQkJYWRldi0+aW5fZ3B1X3Jlc2V0ID0gdHJ1ZTsKPiAtCj4gKwlkb3duX3JlYWQoJmFkZXYt
PnJlc2V0X3NlbSk7Cj4gICAJZG8gewo+ICAgCQlpZiAoeGdwdV9haV9tYWlsYm94X3BlZWtfbXNn
KGFkZXYpID09IElESF9GTFJfTk9USUZJQ0FUSU9OX0NNUEwpCj4gICAJCQlnb3RvIGZscl9kb25l
Owo+IEBAIC0yNjEsMTAgKzI1Nyw3IEBAIHN0YXRpYyB2b2lkIHhncHVfYWlfbWFpbGJveF9mbHJf
d29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gICAJfSB3aGlsZSAodGltZW91dCA+IDEp
Owo+ICAgCj4gICBmbHJfZG9uZToKPiAtCWlmIChsb2NrZWQpIHsKPiAtCQlhZGV2LT5pbl9ncHVf
cmVzZXQgPSBmYWxzZTsKPiAtCQltdXRleF91bmxvY2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+IC0J
fQo+ICsJdXBfcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAgIAo+ICAgCS8qIFRyaWdnZXIgcmVj
b3ZlcnkgZm9yIHdvcmxkIHN3aXRjaCBmYWlsdXJlIGlmIG5vIFREUiAqLwo+ICAgCWlmIChhbWRn
cHVfZGV2aWNlX3Nob3VsZF9yZWNvdmVyX2dwdShhZGV2KQo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9teGdwdV9udi5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvbXhncHVfbnYuYwo+IGluZGV4IGNlMmJmMWZiNzllZC4uNmY1NTE3MmU4MzM3IDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L214Z3B1X252LmMKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9teGdwdV9udi5jCj4gQEAgLTI1OSwyMCArMjU5LDE2IEBA
IHN0YXRpYyB2b2lkIHhncHVfbnZfbWFpbGJveF9mbHJfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3Qg
KndvcmspCj4gICAJc3RydWN0IGFtZGdwdV92aXJ0ICp2aXJ0ID0gY29udGFpbmVyX29mKHdvcmss
IHN0cnVjdCBhbWRncHVfdmlydCwgZmxyX3dvcmspOwo+ICAgCXN0cnVjdCBhbWRncHVfZGV2aWNl
ICphZGV2ID0gY29udGFpbmVyX29mKHZpcnQsIHN0cnVjdCBhbWRncHVfZGV2aWNlLCB2aXJ0KTsK
PiAgIAlpbnQgdGltZW91dCA9IE5WX01BSUxCT1hfUE9MTF9GTFJfVElNRURPVVQ7Cj4gLQlpbnQg
bG9ja2VkOwo+ICAgCj4gICAJLyogYmxvY2sgYW1kZ3B1X2dwdV9yZWNvdmVyIHRpbGwgbXNnIEZM
UiBDT01QTEVURSByZWNlaXZlZCwKPiAgIAkgKiBvdGhlcndpc2UgdGhlIG1haWxib3ggbXNnIHdp
bGwgYmUgcnVpbmVkL3Jlc2V0ZWQgYnkKPiAgIAkgKiB0aGUgVkYgRkxSLgo+ICAgCSAqCj4gLQkg
KiB3ZSBjYW4gdW5sb2NrIHRoZSBsb2NrX3Jlc2V0IHRvIGFsbG93ICJhbWRncHVfam9iX3RpbWVk
b3V0Igo+ICsJICogd2UgY2FuIHVubG9jayB0aGUgcmVzZXRfc2VtIHRvIGFsbG93ICJhbWRncHVf
am9iX3RpbWVkb3V0Igo+ICAgCSAqIHRvIHJ1biBncHVfcmVjb3ZlcigpIGFmdGVyIEZMUl9OT1RJ
RklDQVRJT05fQ01QTCByZWNlaXZlZAo+ICAgCSAqIHdoaWNoIG1lYW5zIGhvc3Qgc2lkZSBoYWQg
ZmluaXNoZWQgdGhpcyBWRidzIEZMUi4KPiAgIAkgKi8KPiAtCWxvY2tlZCA9IG11dGV4X3RyeWxv
Y2soJmFkZXYtPmxvY2tfcmVzZXQpOwo+IC0JaWYgKGxvY2tlZCkKPiAtCQlhZGV2LT5pbl9ncHVf
cmVzZXQgPSB0cnVlOwo+IC0KPiArCWRvd25fcmVhZCgmYWRldi0+cmVzZXRfc2VtKTsKPiAgIAlk
byB7Cj4gICAJCWlmICh4Z3B1X252X21haWxib3hfcGVla19tc2coYWRldikgPT0gSURIX0ZMUl9O
T1RJRklDQVRJT05fQ01QTCkKPiAgIAkJCWdvdG8gZmxyX2RvbmU7Cj4gQEAgLTI4MiwxMCArMjc4
LDcgQEAgc3RhdGljIHZvaWQgeGdwdV9udl9tYWlsYm94X2Zscl93b3JrKHN0cnVjdCB3b3JrX3N0
cnVjdCAqd29yaykKPiAgIAl9IHdoaWxlICh0aW1lb3V0ID4gMSk7Cj4gICAKPiAgIGZscl9kb25l
Ogo+IC0JaWYgKGxvY2tlZCkgewo+IC0JCWFkZXYtPmluX2dwdV9yZXNldCA9IGZhbHNlOwo+IC0J
CW11dGV4X3VubG9jaygmYWRldi0+bG9ja19yZXNldCk7Cj4gLQl9Cj4gKwl1cF9yZWFkKCZhZGV2
LT5yZXNldF9zZW0pOwo+ICAgCj4gICAJLyogVHJpZ2dlciByZWNvdmVyeSBmb3Igd29ybGQgc3dp
dGNoIGZhaWx1cmUgaWYgbm8gVERSICovCj4gICAJaWYgKGFtZGdwdV9kZXZpY2Vfc2hvdWxkX3Jl
Y292ZXJfZ3B1KGFkZXYpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2Zk
L2tmZF9jaGFyZGV2LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfY2hhcmRldi5j
Cj4gaW5kZXggZTliOTZhZDNkOWE1Li4zOTM2NDJjMzIzODcgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2NoYXJkZXYuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1ka2ZkL2tmZF9jaGFyZGV2LmMKPiBAQCAtMTQ4MiwxMyArMTQ4MiwyMCBAQCBzdGF0
aWMgaW50IGtmZF9pb2N0bF9tYXBfbWVtb3J5X3RvX2dwdShzdHJ1Y3QgZmlsZSAqZmlsZXAsCj4g
ICAKPiAgIAkvKiBGbHVzaCBUTEJzIGFmdGVyIHdhaXRpbmcgZm9yIHRoZSBwYWdlIHRhYmxlIHVw
ZGF0ZXMgdG8gY29tcGxldGUgKi8KPiAgIAlmb3IgKGkgPSAwOyBpIDwgYXJncy0+bl9kZXZpY2Vz
OyBpKyspIHsKPiArCQlzdHJ1Y3QgZGV2aWNlX3F1ZXVlX21hbmFnZXIgKmRxbTsKPiArCj4gICAJ
CXBlZXIgPSBrZmRfZGV2aWNlX2J5X2lkKGRldmljZXNfYXJyW2ldKTsKPiAgIAkJaWYgKFdBUk5f
T05fT05DRSghcGVlcikpCj4gICAJCQljb250aW51ZTsKPiAgIAkJcGVlcl9wZGQgPSBrZmRfZ2V0
X3Byb2Nlc3NfZGV2aWNlX2RhdGEocGVlciwgcCk7Cj4gICAJCWlmIChXQVJOX09OX09OQ0UoIXBl
ZXJfcGRkKSkKPiAgIAkJCWNvbnRpbnVlOwo+ICsKPiArCQlkcW0gPSBwZWVyX3BkZC0+ZGV2LT5k
cW07Cj4gKwo+ICsJCWRxbV9sb2NrKGRxbSk7Cj4gICAJCWtmZF9mbHVzaF90bGIocGVlcl9wZGQp
Owo+ICsJCWRxbV91bmxvY2soZHFtKTsKPiAgIAl9Cj4gICAKPiAgIAlrZnJlZShkZXZpY2VzX2Fy
cik7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZpY2Vf
cXVldWVfbWFuYWdlci5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX2RldmljZV9x
dWV1ZV9tYW5hZ2VyLmMKPiBpbmRleCBkZDU1MDAyNWQxYzEuLjBiNTQwOWNlZGU1MiAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfZGV2aWNlX3F1ZXVlX21hbmFn
ZXIuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZpY2VfcXVldWVf
bWFuYWdlci5jCj4gQEAgLTMwNCwxNSArMzA0LDE3IEBAIHN0YXRpYyB2b2lkIGRlYWxsb2NhdGVf
dm1pZChzdHJ1Y3QgZGV2aWNlX3F1ZXVlX21hbmFnZXIgKmRxbSwKPiAgIAkJCQlzdHJ1Y3QgcWNt
X3Byb2Nlc3NfZGV2aWNlICpxcGQsCj4gICAJCQkJc3RydWN0IHF1ZXVlICpxKQo+ICAgewo+IC0J
LyogT24gR0ZYIHY3LCBDUCBkb2Vzbid0IGZsdXNoIFRDIGF0IGRlcXVldWUgKi8KPiAtCWlmIChx
LT5kZXZpY2UtPmRldmljZV9pbmZvLT5hc2ljX2ZhbWlseSA9PSBDSElQX0hBV0FJSSkKPiAtCQlp
ZiAoZmx1c2hfdGV4dHVyZV9jYWNoZV9ub2Nwc2NoKHEtPmRldmljZSwgcXBkKSkKPiAtCQkJcHJf
ZXJyKCJGYWlsZWQgdG8gZmx1c2ggVENcbiIpOwo+ICsJaWYgKCFkcW0tPmlzX3Jlc2V0dGluZykg
ewo+ICsJCS8qIE9uIEdGWCB2NywgQ1AgZG9lc24ndCBmbHVzaCBUQyBhdCBkZXF1ZXVlICovCj4g
KwkJaWYgKHEtPmRldmljZS0+ZGV2aWNlX2luZm8tPmFzaWNfZmFtaWx5ID09IENISVBfSEFXQUlJ
KQo+ICsJCQlpZiAoZmx1c2hfdGV4dHVyZV9jYWNoZV9ub2Nwc2NoKHEtPmRldmljZSwgcXBkKSkK
PiArCQkJCXByX2VycigiRmFpbGVkIHRvIGZsdXNoIFRDXG4iKTsKPiAgIAo+IC0Ja2ZkX2ZsdXNo
X3RsYihxcGRfdG9fcGRkKHFwZCkpOwo+ICsJCWtmZF9mbHVzaF90bGIocXBkX3RvX3BkZChxcGQp
KTsKPiAgIAo+IC0JLyogUmVsZWFzZSB0aGUgdm1pZCBtYXBwaW5nICovCj4gLQlzZXRfcGFzaWRf
dm1pZF9tYXBwaW5nKGRxbSwgMCwgcXBkLT52bWlkKTsKPiArCQkvKiBSZWxlYXNlIHRoZSB2bWlk
IG1hcHBpbmcgKi8KPiArCQlzZXRfcGFzaWRfdm1pZF9tYXBwaW5nKGRxbSwgMCwgcXBkLT52bWlk
KTsKPiArCX0KPiAgIAlkcW0tPnZtaWRfcGFzaWRbcXBkLT52bWlkXSA9IDA7Cj4gICAKPiAgIAlx
cGQtPnZtaWQgPSAwOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9r
ZmRfcHJvY2Vzcy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQva2ZkX3Byb2Nlc3MuYwo+
IGluZGV4IDAxM2MyYjAxOGVkYy4uNzFiZTg5N2Q0YzJhIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9wcm9jZXNzLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGtmZC9rZmRfcHJvY2Vzcy5jCj4gQEAgLTE1NTEsNiArMTU1MSwxMCBAQCBpbnQga2Zk
X3Jlc2VydmVkX21lbV9tbWFwKHN0cnVjdCBrZmRfZGV2ICpkZXYsIHN0cnVjdCBrZmRfcHJvY2Vz
cyAqcHJvY2VzcywKPiAgIHZvaWQga2ZkX2ZsdXNoX3RsYihzdHJ1Y3Qga2ZkX3Byb2Nlc3NfZGV2
aWNlICpwZGQpCj4gICB7Cj4gICAJc3RydWN0IGtmZF9kZXYgKmRldiA9IHBkZC0+ZGV2Owo+ICsJ
c3RydWN0IGRldmljZV9xdWV1ZV9tYW5hZ2VyICpkcW0gPSBkZXYtPmRxbTsKPiArCj4gKwlpZiAo
ZHFtLT5pc19yZXNldHRpbmcpCj4gKwkJcmV0dXJuOwo+ICAgCj4gICAJaWYgKGRldi0+ZHFtLT5z
Y2hlZF9wb2xpY3kgPT0gS0ZEX1NDSEVEX1BPTElDWV9OT19IV1MpIHsKPiAgIAkJLyogTm90aGlu
ZyB0byBmbHVzaCB1bnRpbCBhIFZNSUQgaXMgYXNzaWduZWQsIHdoaWNoCj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtLmMgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvYW1kZ3B1X2RtL2FtZGdwdV9kbS5jCj4gaW5kZXggYjRl
MTIwZTk1NDM4Li5kYjMzMjI4MmMwMWUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9kaXNwbGF5L2FtZGdwdV9kbS9hbWRncHVfZG0uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9hbWRncHVfZG0vYW1kZ3B1X2RtLmMKPiBAQCAtMTY0MCw3ICsxNjQwLDcgQEAg
c3RhdGljIGludCBkbV9zdXNwZW5kKHZvaWQgKmhhbmRsZSkKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2Rp
c3BsYXlfbWFuYWdlciAqZG0gPSAmYWRldi0+ZG07Cj4gICAJaW50IHJldCA9IDA7Cj4gICAKPiAt
CWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsKPiArCWlmIChhdG9taWNfcmVhZCgmYWRldi0+aW5f
Z3B1X3Jlc2V0KSkgewo+ICAgCQltdXRleF9sb2NrKCZkbS0+ZGNfbG9jayk7Cj4gICAJCWRtLT5j
YWNoZWRfZGNfc3RhdGUgPSBkY19jb3B5X3N0YXRlKGRtLT5kYy0+Y3VycmVudF9zdGF0ZSk7Cj4g
ICAKPiBAQCAtMTgyNiw3ICsxODI2LDcgQEAgc3RhdGljIGludCBkbV9yZXN1bWUodm9pZCAqaGFu
ZGxlKQo+ICAgCXN0cnVjdCBkY19zdGF0ZSAqZGNfc3RhdGU7Cj4gICAJaW50IGksIHIsIGo7Cj4g
ICAKPiAtCWlmIChhZGV2LT5pbl9ncHVfcmVzZXQpIHsKPiArCWlmIChhdG9taWNfcmVhZCgmYWRl
di0+aW5fZ3B1X3Jlc2V0KSkgewo+ICAgCQlkY19zdGF0ZSA9IGRtLT5jYWNoZWRfZGNfc3RhdGU7
Cj4gICAKPiAgIAkJciA9IGRtX2RtdWJfaHdfaW5pdChhZGV2KTsKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5jCj4gaW5kZXggZmU0OTQ4YWE2NjJmLi42OTEzNGEw
ZDY2MGMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1
X3NtdS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvYW1kZ3B1X3NtdS5j
Cj4gQEAgLTEzNDEsNyArMTM0MSw3IEBAIHN0YXRpYyBpbnQgc211X2Rpc2FibGVfZHBtcyhzdHJ1
Y3Qgc211X2NvbnRleHQgKnNtdSkKPiAgIAl1aW50NjRfdCBmZWF0dXJlc190b19kaXNhYmxlOwo+
ICAgCWludCByZXQgPSAwOwo+ICAgCWJvb2wgdXNlX2JhY28gPSAhc211LT5pc19hcHUgJiYKPiAt
CQkoKGFkZXYtPmluX2dwdV9yZXNldCAmJgo+ICsJCSgoYXRvbWljX3JlYWQoJmFkZXYtPmluX2dw
dV9yZXNldCkgJiYKPiAgIAkJICAoYW1kZ3B1X2FzaWNfcmVzZXRfbWV0aG9kKGFkZXYpID09IEFN
RF9SRVNFVF9NRVRIT0RfQkFDTykpIHx8Cj4gICAJCSAoKGFkZXYtPmluX3J1bnBtIHx8IGFkZXYt
PmluX2hpYmVybmF0ZSkgJiYgYW1kZ3B1X2FzaWNfc3VwcG9ydHNfYmFjbyhhZGV2KSkpOwo+ICAg
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2h3bWdyL3ZlZ2Ey
MF9od21nci5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9wb3dlcnBsYXkvaHdtZ3IvdmVnYTIwX2h3
bWdyLmMKPiBpbmRleCAzYjg4Mzk2NDE3NzAuLjEzZTMwNDA2NmQ5NCAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL3Bvd2VycGxheS9od21nci92ZWdhMjBfaHdtZ3IuYwo+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9hbWQvcG93ZXJwbGF5L2h3bWdyL3ZlZ2EyMF9od21nci5jCj4gQEAg
LTQ4NCw3ICs0ODQsNyBAQCBzdGF0aWMgaW50IHZlZ2EyMF9zZXR1cF9hc2ljX3Rhc2soc3RydWN0
IHBwX2h3bWdyICpod21ncikKPiAgIHsKPiAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9
IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKShod21nci0+YWRldik7Cj4gICAJaW50IHJldCA9IDA7
Cj4gLQlib29sIHVzZV9iYWNvID0gKGFkZXYtPmluX2dwdV9yZXNldCAmJgo+ICsJYm9vbCB1c2Vf
YmFjbyA9IChhdG9taWNfcmVhZCgmYWRldi0+aW5fZ3B1X3Jlc2V0KSAmJgo+ICAgCQkJIChhbWRn
cHVfYXNpY19yZXNldF9tZXRob2QoYWRldikgPT0gQU1EX1JFU0VUX01FVEhPRF9CQUNPKSkgfHwK
PiAgIAkJKGFkZXYtPmluX3J1bnBtICYmIGFtZGdwdV9hc2ljX3N1cHBvcnRzX2JhY28oYWRldikp
Owo+ICAgCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmFt
ZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeAo=
