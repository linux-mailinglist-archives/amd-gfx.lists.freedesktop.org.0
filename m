Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 9B8B3114464
	for <lists+amd-gfx@lfdr.de>; Thu,  5 Dec 2019 17:07:02 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C22ED6F8A0;
	Thu,  5 Dec 2019 16:07:00 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-wm1-x342.google.com (mail-wm1-x342.google.com
 [IPv6:2a00:1450:4864:20::342])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7E23A6E124
 for <amd-gfx@lists.freedesktop.org>; Thu,  5 Dec 2019 14:43:08 +0000 (UTC)
Received: by mail-wm1-x342.google.com with SMTP id p17so3976347wmi.3
 for <amd-gfx@lists.freedesktop.org>; Thu, 05 Dec 2019 06:43:08 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=ctHLggrQdvbR78S+E5ac8rOte7lO6l75URAOR/MdmOk=;
 b=gbFiUBOhZCWKygEIuIkjSxL+JGcc7Kjdv9GXDIXq3COH3+hlUH/UhGqLwCG3iyZAII
 tyRF+n4MzPztSJI9ClrAcuWpiEo221dtYcd8UFvoy3C8AZgOoIEQyeIWQebQbqtJiXIX
 SDfg8molCdiB8DeCQKe6DwN4PSwzHvEvfyAB8SPxwetclE8Pe82JZaJx1XHgPsHqM2b9
 QeGOvUZaIjOGZhPYpQeLefiUAauqVvdQZ/FgP0u0mPEedJBsEb/ZI88o5UK43ISLTBnm
 Z7nW/UnelSad4jEpFUBDX5/0gDdPqoQi4bdH7q6ix6v4gYL66keBAayDrRoMSHc2o3kl
 v8sg==
X-Gm-Message-State: APjAAAV+lWXNprhW+E5Pi8eh5ySSbUFfLAtgdW8QvvDouJi88X87LxEe
 8dAt67o70x/4rKxW0je7opg=
X-Google-Smtp-Source: APXvYqw8Dc2Wde5WNe1D5zJxKMEyS5o23JseDsMRfwAeq6D8Ntx+WdNXk3XJmFWKjdAxi5WxY6mrLg==
X-Received: by 2002:a7b:c386:: with SMTP id s6mr5633242wmj.105.1575556986794; 
 Thu, 05 Dec 2019 06:43:06 -0800 (PST)
Received: from brihaspati.fritz.box
 (p200300C58F4C0B00CD778BFFF597420F.dip0.t-ipconnect.de.
 [2003:c5:8f4c:b00:cd77:8bff:f597:420f])
 by smtp.gmail.com with ESMTPSA id v14sm12611614wrm.28.2019.12.05.06.43.05
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 05 Dec 2019 06:43:05 -0800 (PST)
From: Nirmoy Das <nirmoy.aiemd@gmail.com>
X-Google-Original-From: Nirmoy Das <nirmoy.das@amd.com>
To: alexander.deucher@amd.com,
	kenny.ho@amd.com,
	christian.koenig@amd.com
Subject: [PATCH] drm/scheduler: rework entity creation
Date: Thu,  5 Dec 2019 15:42:58 +0100
Message-Id: <20191205144258.5580-1-nirmoy.das@amd.com>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
X-Mailman-Approved-At: Thu, 05 Dec 2019 16:06:59 +0000
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=ctHLggrQdvbR78S+E5ac8rOte7lO6l75URAOR/MdmOk=;
 b=XYJHnlm2HjKEhRdf+NPN9HHzBBSnrBYr075GdQgD49lTvJ9Di/kxfqgLppN/cARUUa
 aEbtCaw2jDAIMWq0NhloJEhDGuhQXHWkDefq7Hil0FzFeY8wC/64vwiAMJ++KLCfn+9q
 12dIjtrg4NapR/BDud4R07dZYk7DNZVIjFDOx2fLRi6vEutzP4jt1aZBDnFxUQlhGFnZ
 y5lF7LINKGhhhJhSXfMFlcC8A8TsgdkQCePYOTmbwkgt9d75odQRaXujx0gE7Jm+0ixr
 1lurQFTeC6lCYGxsujVrXW96mPaDYabeAXDvrwfuhqzC7HzhF56ZSEKfyBNmx0FHFd9U
 I5Hg==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: nirmoy.das@amd.com, amd-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RW50aXR5IGN1cnJlbnRseSBrZWVwcyBhIGNvcHkgb2YgcnVuX3F1ZXVlIGxpc3QgYW5kIG1vZGlm
eSBpdCBpbgpkcm1fc2NoZWRfZW50aXR5X3NldF9wcmlvcml0eSgpLiBFbnRpdGllcyBzaG91bGRu
J3QgbW9kaWZ5IHJ1bl9xdWV1ZQpsaXN0LiBVc2UgZHJtX2dwdV9zY2hlZHVsZXIgbGlzdCBpbnN0
ZWFkIG9mIGRybV9zY2hlZF9ycSBsaXN0CmluIGRybV9zY2hlZF9lbnRpdHkgc3RydWN0LiBJbiB0
aGlzIHdheSB3ZSBjYW4gc2VsZWN0IGEgcnVucXVldWUgYmFzZWQKb24gZW50aXR5L2N0eCdzIHBy
aW9yaXR5IGZvciBhICBkcm0gc2NoZWR1bGVyLgoKU2lnbmVkLW9mZi1ieTogTmlybW95IERhcyA8
bmlybW95LmRhc0BhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9jdHguYyAgfCAgNyArKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0u
YyAgfCAgOCArKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV91dmQuYyAgfCAg
NyArKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92Y2UuYyAgfCAgNyArKy0K
IGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5jICAgfCAxNCArKystLQogZHJp
dmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kcnYuYyAgICB8ICA3ICsrLQogZHJpdmVycy9n
cHUvZHJtL2xpbWEvbGltYV9zY2hlZC5jICAgICAgICB8ICA1ICstCiBkcml2ZXJzL2dwdS9kcm0v
cGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMgIHwgIDggKystCiBkcml2ZXJzL2dwdS9kcm0vc2NoZWR1
bGVyL3NjaGVkX2VudGl0eS5jIHwgNzAgKysrKysrKysrKy0tLS0tLS0tLS0tLS0tCiBkcml2ZXJz
L2dwdS9kcm0vdjNkL3YzZF9kcnYuYyAgICAgICAgICAgIHwgIDggKystCiBpbmNsdWRlL2RybS9n
cHVfc2NoZWR1bGVyLmggICAgICAgICAgICAgIHwgIDggKystCiAxMSBmaWxlcyBjaGFuZ2VkLCA3
NyBpbnNlcnRpb25zKCspLCA3MiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3R4LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfY3R4LmMKaW5kZXggYTBkM2Q3Yjc1NmViLi4xZDY4NTBhZjk5MDggMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jdHguYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfY3R4LmMKQEAgLTEyMiw3ICsxMjIsNyBAQCBzdGF0
aWMgaW50IGFtZGdwdV9jdHhfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAogCWZv
ciAoaSA9IDA7IGkgPCBBTURHUFVfSFdfSVBfTlVNOyArK2kpIHsKIAkJc3RydWN0IGFtZGdwdV9y
aW5nICpyaW5nc1tBTURHUFVfTUFYX1JJTkdTXTsKLQkJc3RydWN0IGRybV9zY2hlZF9ycSAqcnFz
W0FNREdQVV9NQVhfUklOR1NdOworCQlzdHJ1Y3QgZHJtX2dwdV9zY2hlZHVsZXIgKnNjaGVkX2xp
c3RbQU1ER1BVX01BWF9SSU5HU107CiAJCXVuc2lnbmVkIG51bV9yaW5ncyA9IDA7CiAJCXVuc2ln
bmVkIG51bV9ycXMgPSAwOwogCkBAIC0xODEsMTIgKzE4MSwxMyBAQCBzdGF0aWMgaW50IGFtZGdw
dV9jdHhfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCWlmICghcmluZ3Nbal0t
PmFkZXYpCiAJCQkJY29udGludWU7CiAKLQkJCXJxc1tudW1fcnFzKytdID0gJnJpbmdzW2pdLT5z
Y2hlZC5zY2hlZF9ycVtwcmlvcml0eV07CisJCQlzY2hlZF9saXN0W251bV9ycXMrK10gPSAmcmlu
Z3Nbal0tPnNjaGVkOwogCQl9CiAKIAkJZm9yIChqID0gMDsgaiA8IGFtZGdwdV9jdHhfbnVtX2Vu
dGl0aWVzW2ldOyArK2opCiAJCQlyID0gZHJtX3NjaGVkX2VudGl0eV9pbml0KCZjdHgtPmVudGl0
aWVzW2ldW2pdLmVudGl0eSwKLQkJCQkJCSAgcnFzLCBudW1fcnFzLCAmY3R4LT5ndWlsdHkpOwor
CQkJCQkJICBwcmlvcml0eSwgc2NoZWRfbGlzdCwKKwkJCQkJCSAgbnVtX3JxcywgJmN0eC0+Z3Vp
bHR5KTsKIAkJaWYgKHIpCiAJCQlnb3RvIGVycm9yX2NsZWFudXBfZW50aXRpZXM7CiAJfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCmluZGV4IDE5ZmZlMDBkOTA3Mi4uMmI2
ZTM1ODkzOTE4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
dHRtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCkBAIC0x
OTU3LDExICsxOTU3LDEzIEBAIHZvaWQgYW1kZ3B1X3R0bV9zZXRfYnVmZmVyX2Z1bmNzX3N0YXR1
cyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCBlbmFibGUpCiAKIAlpZiAoZW5hYmxl
KSB7CiAJCXN0cnVjdCBhbWRncHVfcmluZyAqcmluZzsKLQkJc3RydWN0IGRybV9zY2hlZF9ycSAq
cnE7CisJCXN0cnVjdCBkcm1fZ3B1X3NjaGVkdWxlciAqc2NoZWQ7CiAKIAkJcmluZyA9IGFkZXYt
Pm1tYW4uYnVmZmVyX2Z1bmNzX3Jpbmc7Ci0JCXJxID0gJnJpbmctPnNjaGVkLnNjaGVkX3JxW0RS
TV9TQ0hFRF9QUklPUklUWV9LRVJORUxdOwotCQlyID0gZHJtX3NjaGVkX2VudGl0eV9pbml0KCZh
ZGV2LT5tbWFuLmVudGl0eSwgJnJxLCAxLCBOVUxMKTsKKwkJc2NoZWQgPSAmcmluZy0+c2NoZWQ7
CisJCXIgPSBkcm1fc2NoZWRfZW50aXR5X2luaXQoJmFkZXYtPm1tYW4uZW50aXR5LAorCQkJCSAg
ICAgICAgICBEUk1fU0NIRURfUFJJT1JJVFlfS0VSTkVMLCAmc2NoZWQsCisJCQkJCSAgMSwgTlVM
TCk7CiAJCWlmIChyKSB7CiAJCQlEUk1fRVJST1IoIkZhaWxlZCBzZXR0aW5nIHVwIFRUTSBCTyBt
b3ZlIGVudGl0eSAoJWQpXG4iLAogCQkJCSAgcik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfdXZkLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9h
bWRncHVfdXZkLmMKaW5kZXggZTMyNGJmZTZjNThmLi5hMWExMTBmNTUxM2QgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV91dmQuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdXZkLmMKQEAgLTMzMCwxMiArMzMwLDEzIEBAIGludCBh
bWRncHVfdXZkX3N3X2Zpbmkoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpCiBpbnQgYW1kZ3B1
X3V2ZF9lbnRpdHlfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIHsKIAlzdHJ1Y3Qg
YW1kZ3B1X3JpbmcgKnJpbmc7Ci0Jc3RydWN0IGRybV9zY2hlZF9ycSAqcnE7CisJc3RydWN0IGRy
bV9ncHVfc2NoZWR1bGVyICpzY2hlZDsKIAlpbnQgcjsKIAogCXJpbmcgPSAmYWRldi0+dXZkLmlu
c3RbMF0ucmluZzsKLQlycSA9ICZyaW5nLT5zY2hlZC5zY2hlZF9ycVtEUk1fU0NIRURfUFJJT1JJ
VFlfTk9STUFMXTsKLQlyID0gZHJtX3NjaGVkX2VudGl0eV9pbml0KCZhZGV2LT51dmQuZW50aXR5
LCAmcnEsIDEsIE5VTEwpOworCXNjaGVkID0gJnJpbmctPnNjaGVkOworCXIgPSBkcm1fc2NoZWRf
ZW50aXR5X2luaXQoJmFkZXYtPnV2ZC5lbnRpdHksIERSTV9TQ0hFRF9QUklPUklUWV9OT1JNQUws
CisJCQkJICAmc2NoZWQsIDEsIE5VTEwpOwogCWlmIChyKSB7CiAJCURSTV9FUlJPUigiRmFpbGVk
IHNldHRpbmcgdXAgVVZEIGtlcm5lbCBlbnRpdHkuXG4iKTsKIAkJcmV0dXJuIHI7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdmNlLmMgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdmNlLmMKaW5kZXggNDZiNTkwYWYyZmQyLi5jZWIwZGJm
Njg1ZjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92Y2Uu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdmNlLmMKQEAgLTI0MCwx
MiArMjQwLDEzIEBAIGludCBhbWRncHVfdmNlX3N3X2Zpbmkoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYpCiBpbnQgYW1kZ3B1X3ZjZV9lbnRpdHlfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldikKIHsKIAlzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmc7Ci0Jc3RydWN0IGRybV9zY2hlZF9y
cSAqcnE7CisJc3RydWN0IGRybV9ncHVfc2NoZWR1bGVyICpzY2hlZDsKIAlpbnQgcjsKIAogCXJp
bmcgPSAmYWRldi0+dmNlLnJpbmdbMF07Ci0JcnEgPSAmcmluZy0+c2NoZWQuc2NoZWRfcnFbRFJN
X1NDSEVEX1BSSU9SSVRZX05PUk1BTF07Ci0JciA9IGRybV9zY2hlZF9lbnRpdHlfaW5pdCgmYWRl
di0+dmNlLmVudGl0eSwgJnJxLCAxLCBOVUxMKTsKKwlzY2hlZCA9ICZyaW5nLT5zY2hlZDsKKwly
ID0gZHJtX3NjaGVkX2VudGl0eV9pbml0KCZhZGV2LT52Y2UuZW50aXR5LCBEUk1fU0NIRURfUFJJ
T1JJVFlfTk9STUFMLAorCQkJCSAgJnNjaGVkLCAxLCBOVUxMKTsKIAlpZiAociAhPSAwKSB7CiAJ
CURSTV9FUlJPUigiRmFpbGVkIHNldHRpbmcgdXAgVkNFIHJ1biBxdWV1ZS5cbiIpOwogCQlyZXR1
cm4gcjsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5j
IGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3ZtLmMKaW5kZXggYTk0YzRmYWE1
YWYxLi5hYzg5OWViMzVkNTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV92bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5j
CkBAIC0yNjg3LDYgKzI2ODcsNyBAQCBpbnQgYW1kZ3B1X3ZtX2luaXQoc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtLAogewogCXN0cnVjdCBhbWRncHVfYm9f
cGFyYW0gYnA7CiAJc3RydWN0IGFtZGdwdV9ibyAqcm9vdDsKKyAgICAgICAgc3RydWN0IGRybV9n
cHVfc2NoZWR1bGVyICpzY2hlZF9saXN0W0FNREdQVV9NQVhfUklOR1NdOwogCWludCByLCBpOwog
CiAJdm0tPnZhID0gUkJfUk9PVF9DQUNIRUQ7CkBAIC0yNzAwLDE0ICsyNzAxLDE5IEBAIGludCBh
bWRncHVfdm1faW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgc3RydWN0IGFtZGdwdV92
bSAqdm0sCiAJc3Bpbl9sb2NrX2luaXQoJnZtLT5pbnZhbGlkYXRlZF9sb2NrKTsKIAlJTklUX0xJ
U1RfSEVBRCgmdm0tPmZyZWVkKTsKIAorICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYWRldi0+dm1f
bWFuYWdlci52bV9wdGVfbnVtX3JxczsgaSsrKQorCSAgICAgICBzY2hlZF9saXN0W2ldID0gYWRl
di0+dm1fbWFuYWdlci52bV9wdGVfcnFzW2ldLT5zY2hlZDsKKwogCS8qIGNyZWF0ZSBzY2hlZHVs
ZXIgZW50aXRpZXMgZm9yIHBhZ2UgdGFibGUgdXBkYXRlcyAqLwotCXIgPSBkcm1fc2NoZWRfZW50
aXR5X2luaXQoJnZtLT5kaXJlY3QsIGFkZXYtPnZtX21hbmFnZXIudm1fcHRlX3JxcywKLQkJCQkg
IGFkZXYtPnZtX21hbmFnZXIudm1fcHRlX251bV9ycXMsIE5VTEwpOworCXIgPSBkcm1fc2NoZWRf
ZW50aXR5X2luaXQoJnZtLT5kaXJlY3QsIERSTV9TQ0hFRF9QUklPUklUWV9OT1JNQUwsCisJCQkJ
ICBzY2hlZF9saXN0LCBhZGV2LT52bV9tYW5hZ2VyLnZtX3B0ZV9udW1fcnFzLAorCQkJCSAgTlVM
TCk7CiAJaWYgKHIpCiAJCXJldHVybiByOwogCi0JciA9IGRybV9zY2hlZF9lbnRpdHlfaW5pdCgm
dm0tPmRlbGF5ZWQsIGFkZXYtPnZtX21hbmFnZXIudm1fcHRlX3JxcywKLQkJCQkgIGFkZXYtPnZt
X21hbmFnZXIudm1fcHRlX251bV9ycXMsIE5VTEwpOworCXIgPSBkcm1fc2NoZWRfZW50aXR5X2lu
aXQoJnZtLT5kZWxheWVkLCBEUk1fU0NIRURfUFJJT1JJVFlfTk9STUFMLAorCQkJCSAgc2NoZWRf
bGlzdCwgYWRldi0+dm1fbWFuYWdlci52bV9wdGVfbnVtX3JxcywKKwkJCQkgIE5VTEwpOwogCWlm
IChyKQogCQlnb3RvIGVycm9yX2ZyZWVfZGlyZWN0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vZXRuYXZpdi9ldG5hdml2X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRu
YXZpdl9kcnYuYwppbmRleCAxZjljMDFiZTQwZDcuLjc2ZWNkZjhiZDMxYyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vZXRuYXZpdi9ldG5hdml2X2Rydi5jCkBAIC02NSwxMiArNjUsMTMgQEAgc3RhdGljIGludCBl
dG5hdml2X29wZW4oc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9maWxlICpmaWxl
KQogCiAJZm9yIChpID0gMDsgaSA8IEVUTkFfTUFYX1BJUEVTOyBpKyspIHsKIAkJc3RydWN0IGV0
bmF2aXZfZ3B1ICpncHUgPSBwcml2LT5ncHVbaV07Ci0JCXN0cnVjdCBkcm1fc2NoZWRfcnEgKnJx
OworCQlzdHJ1Y3QgZHJtX2dwdV9zY2hlZHVsZXIgKnNjaGVkOwogCiAJCWlmIChncHUpIHsKLQkJ
CXJxID0gJmdwdS0+c2NoZWQuc2NoZWRfcnFbRFJNX1NDSEVEX1BSSU9SSVRZX05PUk1BTF07CisJ
CQlzY2hlZCA9ICZncHUtPnNjaGVkOwogCQkJZHJtX3NjaGVkX2VudGl0eV9pbml0KCZjdHgtPnNj
aGVkX2VudGl0eVtpXSwKLQkJCQkJICAgICAgJnJxLCAxLCBOVUxMKTsKKwkJCQkJICAgICAgRFJN
X1NDSEVEX1BSSU9SSVRZX05PUk1BTCwgJnNjaGVkLAorCQkJCQkgICAgICAxLCBOVUxMKTsKIAkJ
CX0KIAl9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9saW1hL2xpbWFfc2NoZWQuYyBi
L2RyaXZlcnMvZ3B1L2RybS9saW1hL2xpbWFfc2NoZWQuYwppbmRleCBmNTIyYzVmOTk3MjkuLmZj
ODM2MmU0MTQ5YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2xpbWEvbGltYV9zY2hlZC5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9saW1hL2xpbWFfc2NoZWQuYwpAQCAtMTU5LDkgKzE1OSwx
MCBAQCBpbnQgbGltYV9zY2hlZF9jb250ZXh0X2luaXQoc3RydWN0IGxpbWFfc2NoZWRfcGlwZSAq
cGlwZSwKIAkJCSAgICBzdHJ1Y3QgbGltYV9zY2hlZF9jb250ZXh0ICpjb250ZXh0LAogCQkJICAg
IGF0b21pY190ICpndWlsdHkpCiB7Ci0Jc3RydWN0IGRybV9zY2hlZF9ycSAqcnEgPSBwaXBlLT5i
YXNlLnNjaGVkX3JxICsgRFJNX1NDSEVEX1BSSU9SSVRZX05PUk1BTDsKKwlzdHJ1Y3QgZHJtX2dw
dV9zY2hlZHVsZXIgKnNjaGVkID0gJnBpcGUtPmJhc2U7CiAKLQlyZXR1cm4gZHJtX3NjaGVkX2Vu
dGl0eV9pbml0KCZjb250ZXh0LT5iYXNlLCAmcnEsIDEsIGd1aWx0eSk7CisJcmV0dXJuIGRybV9z
Y2hlZF9lbnRpdHlfaW5pdCgmY29udGV4dC0+YmFzZSwgRFJNX1NDSEVEX1BSSU9SSVRZX05PUk1B
TCwKKwkJCQkgICAgICZzY2hlZCwgMSwgZ3VpbHR5KTsKIH0KIAogdm9pZCBsaW1hX3NjaGVkX2Nv
bnRleHRfZmluaShzdHJ1Y3QgbGltYV9zY2hlZF9waXBlICpwaXBlLApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5jIGIvZHJpdmVycy9ncHUvZHJtL3Bh
bmZyb3N0L3BhbmZyb3N0X2pvYi5jCmluZGV4IGQ0MTFlYjZjOGViOS4uNGY5YWU1YTEyMDkwIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5jCkBAIC01NDIsMTIgKzU0Miwx
NCBAQCBpbnQgcGFuZnJvc3Rfam9iX29wZW4oc3RydWN0IHBhbmZyb3N0X2ZpbGVfcHJpdiAqcGFu
ZnJvc3RfcHJpdikKIHsKIAlzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiA9IHBhbmZyb3N0
X3ByaXYtPnBmZGV2OwogCXN0cnVjdCBwYW5mcm9zdF9qb2Jfc2xvdCAqanMgPSBwZmRldi0+anM7
Ci0Jc3RydWN0IGRybV9zY2hlZF9ycSAqcnE7CisJc3RydWN0IGRybV9ncHVfc2NoZWR1bGVyICpz
Y2hlZDsKIAlpbnQgcmV0LCBpOwogCiAJZm9yIChpID0gMDsgaSA8IE5VTV9KT0JfU0xPVFM7IGkr
KykgewotCQlycSA9ICZqcy0+cXVldWVbaV0uc2NoZWQuc2NoZWRfcnFbRFJNX1NDSEVEX1BSSU9S
SVRZX05PUk1BTF07Ci0JCXJldCA9IGRybV9zY2hlZF9lbnRpdHlfaW5pdCgmcGFuZnJvc3RfcHJp
di0+c2NoZWRfZW50aXR5W2ldLCAmcnEsIDEsIE5VTEwpOworCQlzY2hlZCA9ICZqcy0+cXVldWVb
aV0uc2NoZWQ7CisJCXJldCA9IGRybV9zY2hlZF9lbnRpdHlfaW5pdCgmcGFuZnJvc3RfcHJpdi0+
c2NoZWRfZW50aXR5W2ldLAorCQkJCQkgICAgRFJNX1NDSEVEX1BSSU9SSVRZX05PUk1BTCwgJnNj
aGVkLAorCQkJCQkgICAgMSwgTlVMTCwgRFJNX1NDSEVEX1BSSU9SSVRZX05PUk1BTCk7CiAJCWlm
IChXQVJOX09OKHJldCkpCiAJCQlyZXR1cm4gcmV0OwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9zY2hlZHVsZXIvc2NoZWRfZW50aXR5LmMgYi9kcml2ZXJzL2dwdS9kcm0vc2NoZWR1
bGVyL3NjaGVkX2VudGl0eS5jCmluZGV4IDQ2MWE3YTgxMjlmNC4uYzQ3ZmIyZmJlNjhiIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vc2NoZWR1bGVyL3NjaGVkX2VudGl0eS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9zY2hlZHVsZXIvc2NoZWRfZW50aXR5LmMKQEAgLTM4LDkgKzM4LDEwIEBA
CiAgKiBzdWJtaXQgdG8gSFcgcmluZy4KICAqCiAgKiBAZW50aXR5OiBzY2hlZHVsZXIgZW50aXR5
IHRvIGluaXQKLSAqIEBycV9saXN0OiB0aGUgbGlzdCBvZiBydW4gcXVldWUgb24gd2hpY2ggam9i
cyBmcm9tIHRoaXMKKyAqIEBwcmlvcml0eTogcHJpb3JpdHkgb2YgdGhlIGVudGl0eQorICogQHNj
aGVkX2xpc3Q6IHRoZSBsaXN0IG9mIGRybSBzY2hlZHMgb24gd2hpY2ggam9icyBmcm9tIHRoaXMK
ICAqICAgICAgICAgICBlbnRpdHkgY2FuIGJlIHN1Ym1pdHRlZAotICogQG51bV9ycV9saXN0OiBu
dW1iZXIgb2YgcnVuIHF1ZXVlIGluIHJxX2xpc3QKKyAqIEBudW1fc2NoZWRfbGlzdDogbnVtYmVy
IG9mIGRybSBzY2hlZCBpbiBzY2hlZF9saXN0CiAgKiBAZ3VpbHR5OiBhdG9taWNfdCBzZXQgdG8g
MSB3aGVuIGEgam9iIG9uIHRoaXMgcXVldWUKICAqICAgICAgICAgIGlzIGZvdW5kIHRvIGJlIGd1
aWx0eSBjYXVzaW5nIGEgdGltZW91dAogICoKQEAgLTUwLDMyICs1MSwzNSBAQAogICogUmV0dXJu
cyAwIG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlIG9uIGZhaWx1cmUuCiAgKi8K
IGludCBkcm1fc2NoZWRfZW50aXR5X2luaXQoc3RydWN0IGRybV9zY2hlZF9lbnRpdHkgKmVudGl0
eSwKLQkJCSAgc3RydWN0IGRybV9zY2hlZF9ycSAqKnJxX2xpc3QsCi0JCQkgIHVuc2lnbmVkIGlu
dCBudW1fcnFfbGlzdCwKKwkJCSAgZW51bSBkcm1fc2NoZWRfcHJpb3JpdHkgcHJpb3JpdHksCisJ
CQkgIHN0cnVjdCBkcm1fZ3B1X3NjaGVkdWxlciAqKnNjaGVkX2xpc3QsCisJCQkgIHVuc2lnbmVk
IGludCBudW1fc2NoZWRfbGlzdCwKIAkJCSAgYXRvbWljX3QgKmd1aWx0eSkKIHsKIAlpbnQgaTsK
IAotCWlmICghKGVudGl0eSAmJiBycV9saXN0ICYmIChudW1fcnFfbGlzdCA9PSAwIHx8IHJxX2xp
c3RbMF0pKSkKKwlpZiAoIShlbnRpdHkgJiYgc2NoZWRfbGlzdCAmJiAobnVtX3NjaGVkX2xpc3Qg
PT0gMCB8fCBzY2hlZF9saXN0WzBdKSkpCiAJCXJldHVybiAtRUlOVkFMOwogCiAJbWVtc2V0KGVu
dGl0eSwgMCwgc2l6ZW9mKHN0cnVjdCBkcm1fc2NoZWRfZW50aXR5KSk7CiAJSU5JVF9MSVNUX0hF
QUQoJmVudGl0eS0+bGlzdCk7CiAJZW50aXR5LT5ycSA9IE5VTEw7CiAJZW50aXR5LT5ndWlsdHkg
PSBndWlsdHk7Ci0JZW50aXR5LT5udW1fcnFfbGlzdCA9IG51bV9ycV9saXN0OwotCWVudGl0eS0+
cnFfbGlzdCA9IGtjYWxsb2MobnVtX3JxX2xpc3QsIHNpemVvZihzdHJ1Y3QgZHJtX3NjaGVkX3Jx
ICopLAotCQkJCUdGUF9LRVJORUwpOwotCWlmICghZW50aXR5LT5ycV9saXN0KQorCWVudGl0eS0+
bnVtX3NjaGVkX2xpc3QgPSBudW1fc2NoZWRfbGlzdDsKKwllbnRpdHktPnByaW9yaXR5ID0gcHJp
b3JpdHk7CisJZW50aXR5LT5zY2hlZF9saXN0ID0gIGtjYWxsb2MobnVtX3NjaGVkX2xpc3QsCisJ
CQkJICAgICAgc2l6ZW9mKHN0cnVjdCBkcm1fZ3B1X3NjaGVkdWxlciAqKSwgR0ZQX0tFUk5FTCk7
CisKKwlpZighZW50aXR5LT5zY2hlZF9saXN0KQogCQlyZXR1cm4gLUVOT01FTTsKIAogCWluaXRf
Y29tcGxldGlvbigmZW50aXR5LT5lbnRpdHlfaWRsZSk7CiAKLQlmb3IgKGkgPSAwOyBpIDwgbnVt
X3JxX2xpc3Q7ICsraSkKLQkJZW50aXR5LT5ycV9saXN0W2ldID0gcnFfbGlzdFtpXTsKKwlmb3Ig
KGkgPSAwOyBpIDwgbnVtX3NjaGVkX2xpc3Q7IGkrKykKKwkJZW50aXR5LT5zY2hlZF9saXN0W2ld
ID0gc2NoZWRfbGlzdFtpXTsKIAotCWlmIChudW1fcnFfbGlzdCkKLQkJZW50aXR5LT5ycSA9IHJx
X2xpc3RbMF07CisJaWYgKG51bV9zY2hlZF9saXN0KQorCQllbnRpdHktPnJxID0gJmVudGl0eS0+
c2NoZWRfbGlzdFswXS0+c2NoZWRfcnFbZW50aXR5LT5wcmlvcml0eV07CiAKIAllbnRpdHktPmxh
c3Rfc2NoZWR1bGVkID0gTlVMTDsKIApAQCAtMTM5LDEwICsxNDMsMTAgQEAgZHJtX3NjaGVkX2Vu
dGl0eV9nZXRfZnJlZV9zY2hlZChzdHJ1Y3QgZHJtX3NjaGVkX2VudGl0eSAqZW50aXR5KQogCXVu
c2lnbmVkIGludCBtaW5fam9icyA9IFVJTlRfTUFYLCBudW1fam9iczsKIAlpbnQgaTsKIAotCWZv
ciAoaSA9IDA7IGkgPCBlbnRpdHktPm51bV9ycV9saXN0OyArK2kpIHsKLQkJc3RydWN0IGRybV9n
cHVfc2NoZWR1bGVyICpzY2hlZCA9IGVudGl0eS0+cnFfbGlzdFtpXS0+c2NoZWQ7CisJZm9yIChp
ID0gMDsgaSA8IGVudGl0eS0+bnVtX3NjaGVkX2xpc3Q7ICsraSkgeworCQlzdHJ1Y3QgZHJtX2dw
dV9zY2hlZHVsZXIgKnNjaGVkID0gZW50aXR5LT5zY2hlZF9saXN0W2ldOwogCi0JCWlmICghZW50
aXR5LT5ycV9saXN0W2ldLT5zY2hlZC0+cmVhZHkpIHsKKwkJaWYgKCFlbnRpdHktPnNjaGVkX2xp
c3RbaV0tPnJlYWR5KSB7CiAJCQlEUk1fV0FSTigic2NoZWQlcyBpcyBub3QgcmVhZHksIHNraXBw
aW5nIiwgc2NoZWQtPm5hbWUpOwogCQkJY29udGludWU7CiAJCX0KQEAgLTE1MCw3ICsxNTQsNyBA
QCBkcm1fc2NoZWRfZW50aXR5X2dldF9mcmVlX3NjaGVkKHN0cnVjdCBkcm1fc2NoZWRfZW50aXR5
ICplbnRpdHkpCiAJCW51bV9qb2JzID0gYXRvbWljX3JlYWQoJnNjaGVkLT5udW1fam9icyk7CiAJ
CWlmIChudW1fam9icyA8IG1pbl9qb2JzKSB7CiAJCQltaW5fam9icyA9IG51bV9qb2JzOwotCQkJ
cnEgPSBlbnRpdHktPnJxX2xpc3RbaV07CisJCQlycSA9ICZlbnRpdHktPnNjaGVkX2xpc3RbaV0t
PnNjaGVkX3JxW2VudGl0eS0+cHJpb3JpdHldOwogCQl9CiAJfQogCkBAIC0zMDgsNyArMzEyLDcg
QEAgdm9pZCBkcm1fc2NoZWRfZW50aXR5X2Zpbmkoc3RydWN0IGRybV9zY2hlZF9lbnRpdHkgKmVu
dGl0eSkKIAogCWRtYV9mZW5jZV9wdXQoZW50aXR5LT5sYXN0X3NjaGVkdWxlZCk7CiAJZW50aXR5
LT5sYXN0X3NjaGVkdWxlZCA9IE5VTEw7Ci0Ja2ZyZWUoZW50aXR5LT5ycV9saXN0KTsKKwlrZnJl
ZShlbnRpdHktPnNjaGVkX2xpc3QpOwogfQogRVhQT1JUX1NZTUJPTChkcm1fc2NoZWRfZW50aXR5
X2ZpbmkpOwogCkBAIC0zNTMsMTUgKzM1Nyw2IEBAIHN0YXRpYyB2b2lkIGRybV9zY2hlZF9lbnRp
dHlfd2FrZXVwKHN0cnVjdCBkbWFfZmVuY2UgKmYsCiAJZHJtX3NjaGVkX3dha2V1cChlbnRpdHkt
PnJxLT5zY2hlZCk7CiB9CiAKLS8qKgotICogZHJtX3NjaGVkX2VudGl0eV9zZXRfcnFfcHJpb3Jp
dHkgLSBoZWxwZXIgZm9yIGRybV9zY2hlZF9lbnRpdHlfc2V0X3ByaW9yaXR5Ci0gKi8KLXN0YXRp
YyB2b2lkIGRybV9zY2hlZF9lbnRpdHlfc2V0X3JxX3ByaW9yaXR5KHN0cnVjdCBkcm1fc2NoZWRf
cnEgKipycSwKLQkJCQkJICAgICBlbnVtIGRybV9zY2hlZF9wcmlvcml0eSBwcmlvcml0eSkKLXsK
LQkqcnEgPSAmKCpycSktPnNjaGVkLT5zY2hlZF9ycVtwcmlvcml0eV07Ci19Ci0KIC8qKgogICog
ZHJtX3NjaGVkX2VudGl0eV9zZXRfcHJpb3JpdHkgLSBTZXRzIHByaW9yaXR5IG9mIHRoZSBlbnRp
dHkKICAqCkBAIC0zNzMsMTkgKzM2OCw4IEBAIHN0YXRpYyB2b2lkIGRybV9zY2hlZF9lbnRpdHlf
c2V0X3JxX3ByaW9yaXR5KHN0cnVjdCBkcm1fc2NoZWRfcnEgKipycSwKIHZvaWQgZHJtX3NjaGVk
X2VudGl0eV9zZXRfcHJpb3JpdHkoc3RydWN0IGRybV9zY2hlZF9lbnRpdHkgKmVudGl0eSwKIAkJ
CQkgICBlbnVtIGRybV9zY2hlZF9wcmlvcml0eSBwcmlvcml0eSkKIHsKLQl1bnNpZ25lZCBpbnQg
aTsKLQogCXNwaW5fbG9jaygmZW50aXR5LT5ycV9sb2NrKTsKLQotCWZvciAoaSA9IDA7IGkgPCBl
bnRpdHktPm51bV9ycV9saXN0OyArK2kpCi0JCWRybV9zY2hlZF9lbnRpdHlfc2V0X3JxX3ByaW9y
aXR5KCZlbnRpdHktPnJxX2xpc3RbaV0sIHByaW9yaXR5KTsKLQotCWlmIChlbnRpdHktPnJxKSB7
Ci0JCWRybV9zY2hlZF9ycV9yZW1vdmVfZW50aXR5KGVudGl0eS0+cnEsIGVudGl0eSk7Ci0JCWRy
bV9zY2hlZF9lbnRpdHlfc2V0X3JxX3ByaW9yaXR5KCZlbnRpdHktPnJxLCBwcmlvcml0eSk7Ci0J
CWRybV9zY2hlZF9ycV9hZGRfZW50aXR5KGVudGl0eS0+cnEsIGVudGl0eSk7Ci0JfQotCisJZW50
aXR5LT5wcmlvcml0eSA9IHByaW9yaXR5OwogCXNwaW5fdW5sb2NrKCZlbnRpdHktPnJxX2xvY2sp
OwogfQogRVhQT1JUX1NZTUJPTChkcm1fc2NoZWRfZW50aXR5X3NldF9wcmlvcml0eSk7CkBAIC00
OTAsMTggKzQ3NCwyMCBAQCB2b2lkIGRybV9zY2hlZF9lbnRpdHlfc2VsZWN0X3JxKHN0cnVjdCBk
cm1fc2NoZWRfZW50aXR5ICplbnRpdHkpCiAJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7CiAJc3Ry
dWN0IGRybV9zY2hlZF9ycSAqcnE7CiAKLQlpZiAoc3BzY19xdWV1ZV9jb3VudCgmZW50aXR5LT5q
b2JfcXVldWUpIHx8IGVudGl0eS0+bnVtX3JxX2xpc3QgPD0gMSkKKwlpZiAoc3BzY19xdWV1ZV9j
b3VudCgmZW50aXR5LT5qb2JfcXVldWUpIHx8IGVudGl0eS0+bnVtX3NjaGVkX2xpc3QgPD0gMSkK
IAkJcmV0dXJuOwogCiAJZmVuY2UgPSBSRUFEX09OQ0UoZW50aXR5LT5sYXN0X3NjaGVkdWxlZCk7
CiAJaWYgKGZlbmNlICYmICFkbWFfZmVuY2VfaXNfc2lnbmFsZWQoZmVuY2UpKQogCQlyZXR1cm47
CiAKKwlzcGluX2xvY2soJmVudGl0eS0+cnFfbG9jayk7CiAJcnEgPSBkcm1fc2NoZWRfZW50aXR5
X2dldF9mcmVlX3NjaGVkKGVudGl0eSk7Ci0JaWYgKHJxID09IGVudGl0eS0+cnEpCisJaWYgKHJx
ID09IGVudGl0eS0+cnEpIHsKKwkJc3Bpbl91bmxvY2soJmVudGl0eS0+cnFfbG9jayk7CiAJCXJl
dHVybjsKKwl9CiAKLQlzcGluX2xvY2soJmVudGl0eS0+cnFfbG9jayk7CiAJZHJtX3NjaGVkX3Jx
X3JlbW92ZV9lbnRpdHkoZW50aXR5LT5ycSwgZW50aXR5KTsKIAllbnRpdHktPnJxID0gcnE7CiAJ
c3Bpbl91bmxvY2soJmVudGl0eS0+cnFfbG9jayk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vdjNkL3YzZF9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS92M2QvdjNkX2Rydi5jCmluZGV4IDFh
MDc0NjJiNDUyOC4uZWFhOGU5NjgyMzczIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdjNk
L3YzZF9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdjNkL3YzZF9kcnYuYwpAQCAtMTQwLDcg
KzE0MCw3IEBAIHYzZF9vcGVuKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBkcm1fZmls
ZSAqZmlsZSkKIHsKIAlzdHJ1Y3QgdjNkX2RldiAqdjNkID0gdG9fdjNkX2RldihkZXYpOwogCXN0
cnVjdCB2M2RfZmlsZV9wcml2ICp2M2RfcHJpdjsKLQlzdHJ1Y3QgZHJtX3NjaGVkX3JxICpycTsK
KwlzdHJ1Y3QgZHJtX2dwdV9zY2hlZHVsZXIgKnNjaGVkOwogCWludCBpOwogCiAJdjNkX3ByaXYg
PSBremFsbG9jKHNpemVvZigqdjNkX3ByaXYpLCBHRlBfS0VSTkVMKTsKQEAgLTE1MCw4ICsxNTAs
MTAgQEAgdjNkX29wZW4oc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9maWxlICpm
aWxlKQogCXYzZF9wcml2LT52M2QgPSB2M2Q7CiAKIAlmb3IgKGkgPSAwOyBpIDwgVjNEX01BWF9R
VUVVRVM7IGkrKykgewotCQlycSA9ICZ2M2QtPnF1ZXVlW2ldLnNjaGVkLnNjaGVkX3JxW0RSTV9T
Q0hFRF9QUklPUklUWV9OT1JNQUxdOwotCQlkcm1fc2NoZWRfZW50aXR5X2luaXQoJnYzZF9wcml2
LT5zY2hlZF9lbnRpdHlbaV0sICZycSwgMSwgTlVMTCk7CisJCXNjaGVkID0gJnYzZC0+cXVldWVb
aV0uc2NoZWQ7CisJCWRybV9zY2hlZF9lbnRpdHlfaW5pdCgmdjNkX3ByaXYtPnNjaGVkX2VudGl0
eVtpXSwKKwkJCQkgICAgICBEUk1fU0NIRURfUFJJT1JJVFlfTk9STUFMLCAmc2NoZWQsCisJCQkJ
ICAgICAgMSwgTlVMTCk7CiAJfQogCiAJZmlsZS0+ZHJpdmVyX3ByaXYgPSB2M2RfcHJpdjsKZGlm
ZiAtLWdpdCBhL2luY2x1ZGUvZHJtL2dwdV9zY2hlZHVsZXIuaCBiL2luY2x1ZGUvZHJtL2dwdV9z
Y2hlZHVsZXIuaAppbmRleCA2ODQ2OTJhOGVkNzYuLjk2YTFhMWI3NTI2ZSAxMDA2NDQKLS0tIGEv
aW5jbHVkZS9kcm0vZ3B1X3NjaGVkdWxlci5oCisrKyBiL2luY2x1ZGUvZHJtL2dwdV9zY2hlZHVs
ZXIuaApAQCAtODEsOCArODEsOSBAQCBlbnVtIGRybV9zY2hlZF9wcmlvcml0eSB7CiBzdHJ1Y3Qg
ZHJtX3NjaGVkX2VudGl0eSB7CiAJc3RydWN0IGxpc3RfaGVhZAkJbGlzdDsKIAlzdHJ1Y3QgZHJt
X3NjaGVkX3JxCQkqcnE7Ci0Jc3RydWN0IGRybV9zY2hlZF9ycQkJKipycV9saXN0OwotCXVuc2ln
bmVkIGludCAgICAgICAgICAgICAgICAgICAgbnVtX3JxX2xpc3Q7CisJdW5zaWduZWQgaW50ICAg
ICAgICAgICAgICAgICAgICBudW1fc2NoZWRfbGlzdDsKKwlzdHJ1Y3QgZHJtX2dwdV9zY2hlZHVs
ZXIgICAgICAgICoqc2NoZWRfbGlzdDsKKwllbnVtIGRybV9zY2hlZF9wcmlvcml0eSAgICAgICAg
IHByaW9yaXR5OwogCXNwaW5sb2NrX3QJCQlycV9sb2NrOwogCiAJc3RydWN0IHNwc2NfcXVldWUJ
CWpvYl9xdWV1ZTsKQEAgLTMxMiw3ICszMTMsOCBAQCB2b2lkIGRybV9zY2hlZF9ycV9yZW1vdmVf
ZW50aXR5KHN0cnVjdCBkcm1fc2NoZWRfcnEgKnJxLAogCQkJCXN0cnVjdCBkcm1fc2NoZWRfZW50
aXR5ICplbnRpdHkpOwogCiBpbnQgZHJtX3NjaGVkX2VudGl0eV9pbml0KHN0cnVjdCBkcm1fc2No
ZWRfZW50aXR5ICplbnRpdHksCi0JCQkgIHN0cnVjdCBkcm1fc2NoZWRfcnEgKipycV9saXN0LAor
CQkJICBlbnVtIGRybV9zY2hlZF9wcmlvcml0eSBwcmlvcml0eSwKKwkJCSAgc3RydWN0IGRybV9n
cHVfc2NoZWR1bGVyICoqc2NoZWRfbGlzdCwKIAkJCSAgdW5zaWduZWQgaW50IG51bV9ycV9saXN0
LAogCQkJICBhdG9taWNfdCAqZ3VpbHR5KTsKIGxvbmcgZHJtX3NjaGVkX2VudGl0eV9mbHVzaChz
dHJ1Y3QgZHJtX3NjaGVkX2VudGl0eSAqZW50aXR5LCBsb25nIHRpbWVvdXQpOwotLSAKMi4yMy4w
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4
IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
