Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7D2CD16F35
	for <lists+amd-gfx@lfdr.de>; Wed,  8 May 2019 04:46:23 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1E16D6E869;
	Wed,  8 May 2019 02:46:22 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM01-BY2-obe.outbound.protection.outlook.com
 (mail-eopbgr810050.outbound.protection.outlook.com [40.107.81.50])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2D0CE6E869
 for <amd-gfx@lists.freedesktop.org>; Wed,  8 May 2019 02:46:21 +0000 (UTC)
Received: from BN4PR12CA0004.namprd12.prod.outlook.com (2603:10b6:403:2::14)
 by BN6PR12MB1140.namprd12.prod.outlook.com (2603:10b6:404:19::14) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.1856.11; Wed, 8 May
 2019 02:46:19 +0000
Received: from DM3NAM03FT030.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e49::201) by BN4PR12CA0004.outlook.office365.com
 (2603:10b6:403:2::14) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.1856.10 via Frontend
 Transport; Wed, 8 May 2019 02:46:19 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV02.amd.com (165.204.84.17) by
 DM3NAM03FT030.mail.protection.outlook.com (10.152.82.203) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.1856.11 via Frontend Transport; Wed, 8 May 2019 02:46:18 +0000
Received: from bb-VirtualBox.amd.com (10.34.1.3) by SATLEXCHOV02.amd.com
 (10.181.40.72) with Microsoft SMTP Server id 14.3.389.1; Tue, 7 May 2019
 21:46:15 -0500
From: Trigger Huang <Trigger.Huang@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 9/9] drm/amdgpu: RLC to program regs for Vega10 SR-IOV
Date: Wed, 8 May 2019 10:45:41 +0800
Message-ID: <1557283541-7877-10-git-send-email-Trigger.Huang@amd.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1557283541-7877-1-git-send-email-Trigger.Huang@amd.com>
References: <1557283541-7877-1-git-send-email-Trigger.Huang@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(376002)(396003)(346002)(39860400002)(136003)(2980300002)(428003)(189003)(199004)(4326008)(356004)(53936002)(426003)(48376002)(51416003)(76176011)(50466002)(7696005)(16586007)(336012)(54906003)(316002)(26005)(6916009)(2906002)(186003)(53416004)(8676002)(86362001)(5660300002)(77096007)(2351001)(305945005)(81166006)(81156014)(36756003)(8936002)(30864003)(68736007)(6666004)(476003)(478600001)(11346002)(70586007)(446003)(126002)(47776003)(70206006)(50226002)(14444005)(486006)(72206003)(2616005)(21314003);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BN6PR12MB1140; H:SATLEXCHOV02.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; MX:1; A:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: ac782051-5d8c-4e3f-f09e-08d6d35f5934
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600141)(711020)(4605104)(2017052603328);
 SRVR:BN6PR12MB1140; 
X-MS-TrafficTypeDiagnostic: BN6PR12MB1140:
X-Microsoft-Antispam-PRVS: <BN6PR12MB1140EA86BDDF01093E87778EFE320@BN6PR12MB1140.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:639;
X-Forefront-PRVS: 0031A0FFAF
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: pKFBqgX+XAzkOhqOWWD2uOjQOBiXdfjWTT/5C6Sy5Vofsri0reSeH6u/HeOVHJOrccUMQ3NvR8GHSTXEoWIw6ANr9N9gAzGTwUFpUjl0QQxhRDagup/c8XIOZ8byaBIUhkCGQ6olEjZ0ulB8fkJFOhZUHh5hRKlI1MMnL+Qgbl/a4CiSD6BCUqAuy1/vqqfEPVebuW1kb8iF2ltNXmAgNQxP+4p1QXzktEH2898q335JYsmt0MqkEUrbKbqvCVOJhABfj9X56aAwuIISkbXc93MLhpH6y0NxiQHk6MmTAhRxvbgGN7ktJFY0EFk1vtXZhTHWh1eVfE+68fP+rgygHvuUVkivgVAN8t667XFJfdJLlws+TE0BhrGeGiVmtJa8hXesWLxRYNPTGEu1SVq3n54GRom5me8SbCyweHoS8HM=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 08 May 2019 02:46:18.9627 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: ac782051-5d8c-4e3f-f09e-08d6d35f5934
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV02.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN6PR12MB1140
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amd-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=5PLRp08I5S6JFS9D16/WwYS3r89wHRy4p81btcrP5e0=;
 b=WGcPBlMjBGrW9MXv5bCo7BefOZMYHAc21ykedlhbzDvt5tXYpmi2xilQAdO5mk7XlQgOGc6bMdL66n3WgjmutNNF7hlL3jU6qT6TLC9e6bG/Id2SHkIzXRoP9VfH2p4+ojqa54YiqhRrJGhTgtOZ+ei3WW8EYMi1C54ObhQ3Mbc=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Daniel.Wang2@amd.com, Rashid.Sohail@amd.com, Trigger.Huang@amd.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

VW5kZXIgVmVnYTEwIFNSLUlPViwgd2l0aCBuZXcgUkxDJ3MgbmV3IGZlYXR1cmUsIFZGIHNob3Vs
ZCBjYWxsIFJMQwp0byBwcm9ncmFtIHNvbWUgcmVnaXN0ZXJzIGlmIHN1cHBvcnRlZAoKU2lnbmVk
LW9mZi1ieTogVHJpZ2dlciBIdWFuZyA8VHJpZ2dlci5IdWFuZ0BhbWQuY29tPgotLS0KIGRyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y5LmMgfCAgMzAgKysrLS0t
LQogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3Y5XzAuYyAgICAgICAgICAgICB8IDEw
MCArKysrKysrKysrKy0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnho
dWJfdjFfMC5jICAgICAgICAgIHwgIDIwICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9zb2MxNS5jICAgICAgICAgICAgICAgIHwgIDEyICsrLQogNCBmaWxlcyBjaGFuZ2VkLCA4NSBp
bnNlcnRpb25zKCspLCA3NyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92OS5jIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjkuYwppbmRleCA2MjA2N2QwLi45Y2QwZmQ3IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92
OS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y5
LmMKQEAgLTI1OSw4ICsyNTksOCBAQCBzdGF0aWMgdm9pZCBrZ2RfcHJvZ3JhbV9zaF9tZW1fc2V0
dGluZ3Moc3RydWN0IGtnZF9kZXYgKmtnZCwgdWludDMyX3Qgdm1pZCwKIAogCWxvY2tfc3JibShr
Z2QsIDAsIDAsIDAsIHZtaWQpOwogCi0JV1JFRzMyKFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1t
U0hfTUVNX0NPTkZJRyksIHNoX21lbV9jb25maWcpOwotCVdSRUczMihTT0MxNV9SRUdfT0ZGU0VU
KEdDLCAwLCBtbVNIX01FTV9CQVNFUyksIHNoX21lbV9iYXNlcyk7CisJV1JFRzMyX1JMQyhTT0Mx
NV9SRUdfT0ZGU0VUKEdDLCAwLCBtbVNIX01FTV9DT05GSUcpLCBzaF9tZW1fY29uZmlnKTsKKwlX
UkVHMzJfUkxDKFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tU0hfTUVNX0JBU0VTKSwgc2hfbWVt
X2Jhc2VzKTsKIAkvKiBBUEUxIG5vIGxvbmdlciBleGlzdHMgb24gR0ZYOSAqLwogCiAJdW5sb2Nr
X3NyYm0oa2dkKTsKQEAgLTQxMyw3ICs0MTMsNyBAQCBzdGF0aWMgaW50IGtnZF9ocWRfbG9hZChz
dHJ1Y3Qga2dkX2RldiAqa2dkLCB2b2lkICptcWQsIHVpbnQzMl90IHBpcGVfaWQsCiAJCXZhbHVl
ID0gUlJFRzMyKFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tUkxDX0NQX1NDSEVEVUxFUlMpKTsK
IAkJdmFsdWUgPSBSRUdfU0VUX0ZJRUxEKHZhbHVlLCBSTENfQ1BfU0NIRURVTEVSUywgc2NoZWR1
bGVyMSwKIAkJCSgobWVjIDw8IDUpIHwgKHBpcGUgPDwgMykgfCBxdWV1ZV9pZCB8IDB4ODApKTsK
LQkJV1JFRzMyKFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tUkxDX0NQX1NDSEVEVUxFUlMpLCB2
YWx1ZSk7CisJCVdSRUczMl9STEMoU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1STENfQ1BfU0NI
RURVTEVSUyksIHZhbHVlKTsKIAl9CiAKIAkvKiBIUUQgcmVnaXN0ZXJzIGV4dGVuZCBmcm9tIENQ
X01RRF9CQVNFX0FERFIgdG8gQ1BfSFFEX0VPUF9XUFRSX01FTS4gKi8KQEAgLTQyMiwxMyArNDIy
LDEzIEBAIHN0YXRpYyBpbnQga2dkX2hxZF9sb2FkKHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQg
Km1xZCwgdWludDMyX3QgcGlwZV9pZCwKIAogCWZvciAocmVnID0gaHFkX2Jhc2U7CiAJICAgICBy
ZWcgPD0gU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9ISSk7IHJlZysr
KQotCQlXUkVHMzIocmVnLCBtcWRfaHFkW3JlZyAtIGhxZF9iYXNlXSk7CisJCVdSRUczMl9STEMo
cmVnLCBtcWRfaHFkW3JlZyAtIGhxZF9iYXNlXSk7CiAKIAogCS8qIEFjdGl2YXRlIGRvb3JiZWxs
IGxvZ2ljIGJlZm9yZSB0cmlnZ2VyaW5nIFdQVFIgcG9sbC4gKi8KIAlkYXRhID0gUkVHX1NFVF9G
SUVMRChtLT5jcF9ocWRfcHFfZG9vcmJlbGxfY29udHJvbCwKIAkJCSAgICAgQ1BfSFFEX1BRX0RP
T1JCRUxMX0NPTlRST0wsIERPT1JCRUxMX0VOLCAxKTsKLQlXUkVHMzIoU09DMTVfUkVHX09GRlNF
VChHQywgMCwgbW1DUF9IUURfUFFfRE9PUkJFTExfQ09OVFJPTCksIGRhdGEpOworCVdSRUczMl9S
TEMoU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9IUURfUFFfRE9PUkJFTExfQ09OVFJPTCks
IGRhdGEpOwogCiAJaWYgKHdwdHIpIHsKIAkJLyogRG9uJ3QgcmVhZCB3cHRyIHdpdGggZ2V0X3Vz
ZXIgYmVjYXVzZSB0aGUgdXNlcgpAQCAtNDU3LDI1ICs0NTcsMjUgQEAgc3RhdGljIGludCBrZ2Rf
aHFkX2xvYWQoc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFkLCB1aW50MzJfdCBwaXBlX2lk
LAogCQlndWVzc2VkX3dwdHIgKz0gbS0+Y3BfaHFkX3BxX3dwdHJfbG8gJiB+KHF1ZXVlX3NpemUg
LSAxKTsKIAkJZ3Vlc3NlZF93cHRyICs9ICh1aW50NjRfdCltLT5jcF9ocWRfcHFfd3B0cl9oaSA8
PCAzMjsKIAotCQlXUkVHMzIoU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9IUURfUFFfV1BU
Ul9MTyksCisJCVdSRUczMl9STEMoU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9IUURfUFFf
V1BUUl9MTyksCiAJCSAgICAgICBsb3dlcl8zMl9iaXRzKGd1ZXNzZWRfd3B0cikpOwotCQlXUkVH
MzIoU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9ISSksCisJCVdSRUcz
Ml9STEMoU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9ISSksCiAJCSAg
ICAgICB1cHBlcl8zMl9iaXRzKGd1ZXNzZWRfd3B0cikpOwotCQlXUkVHMzIoU09DMTVfUkVHX09G
RlNFVChHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9QT0xMX0FERFIpLAorCQlXUkVHMzJfUkxDKFNP
QzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tQ1BfSFFEX1BRX1dQVFJfUE9MTF9BRERSKSwKIAkJICAg
ICAgIGxvd2VyXzMyX2JpdHMoKHVpbnRwdHJfdCl3cHRyKSk7Ci0JCVdSRUczMihTT0MxNV9SRUdf
T0ZGU0VUKEdDLCAwLCBtbUNQX0hRRF9QUV9XUFRSX1BPTExfQUREUl9ISSksCisJCVdSRUczMl9S
TEMoU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9QT0xMX0FERFJfSEkp
LAogCQkgICAgICAgdXBwZXJfMzJfYml0cygodWludHB0cl90KXdwdHIpKTsKIAkJV1JFRzMyKFNP
QzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tQ1BfUFFfV1BUUl9QT0xMX0NOVEwxKSwKIAkJICAgICAg
IGdldF9xdWV1ZV9tYXNrKGFkZXYsIHBpcGVfaWQsIHF1ZXVlX2lkKSk7CiAJfQogCiAJLyogU3Rh
cnQgdGhlIEVPUCBmZXRjaGVyICovCi0JV1JFRzMyKFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1t
Q1BfSFFEX0VPUF9SUFRSKSwKKwlXUkVHMzJfUkxDKFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1t
Q1BfSFFEX0VPUF9SUFRSKSwKIAkgICAgICAgUkVHX1NFVF9GSUVMRChtLT5jcF9ocWRfZW9wX3Jw
dHIsCiAJCQkgICAgIENQX0hRRF9FT1BfUlBUUiwgSU5JVF9GRVRDSEVSLCAxKSk7CiAKIAlkYXRh
ID0gUkVHX1NFVF9GSUVMRChtLT5jcF9ocWRfYWN0aXZlLCBDUF9IUURfQUNUSVZFLCBBQ1RJVkUs
IDEpOwotCVdSRUczMihTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbUNQX0hRRF9BQ1RJVkUpLCBk
YXRhKTsKKwlXUkVHMzJfUkxDKFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tQ1BfSFFEX0FDVElW
RSksIGRhdGEpOwogCiAJcmVsZWFzZV9xdWV1ZShrZ2QpOwogCkBAIC02NzcsNyArNjc3LDcgQEAg
c3RhdGljIGludCBrZ2RfaHFkX2Rlc3Ryb3koc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFk
LAogCWFjcXVpcmVfcXVldWUoa2dkLCBwaXBlX2lkLCBxdWV1ZV9pZCk7CiAKIAlpZiAobS0+Y3Bf
aHFkX3ZtaWQgPT0gMCkKLQkJV1JFRzMyX0ZJRUxEMTUoR0MsIDAsIFJMQ19DUF9TQ0hFRFVMRVJT
LCBzY2hlZHVsZXIxLCAwKTsKKwkJV1JFRzMyX0ZJRUxEMTVfUkxDKEdDLCAwLCBSTENfQ1BfU0NI
RURVTEVSUywgc2NoZWR1bGVyMSwgMCk7CiAKIAlzd2l0Y2ggKHJlc2V0X3R5cGUpIHsKIAljYXNl
IEtGRF9QUkVFTVBUX1RZUEVfV0FWRUZST05UX0RSQUlOOgpAQCAtNjkxLDcgKzY5MSw3IEBAIHN0
YXRpYyBpbnQga2dkX2hxZF9kZXN0cm95KHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQgKm1xZCwK
IAkJYnJlYWs7CiAJfQogCi0JV1JFRzMyKFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tQ1BfSFFE
X0RFUVVFVUVfUkVRVUVTVCksIHR5cGUpOworCVdSRUczMl9STEMoU09DMTVfUkVHX09GRlNFVChH
QywgMCwgbW1DUF9IUURfREVRVUVVRV9SRVFVRVNUKSwgdHlwZSk7CiAKIAllbmRfamlmZmllcyA9
ICh1dGltZW91dCAqIEhaIC8gMTAwMCkgKyBqaWZmaWVzOwogCXdoaWxlICh0cnVlKSB7CkBAIC05
MjUsNyArOTI1LDcgQEAgc3RhdGljIGludCBrZ2Rfd2F2ZV9jb250cm9sX2V4ZWN1dGUoc3RydWN0
IGtnZF9kZXYgKmtnZCwKIAogCW11dGV4X2xvY2soJmFkZXYtPmdyYm1faWR4X211dGV4KTsKIAot
CVdSRUczMihTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbUdSQk1fR0ZYX0lOREVYKSwgZ2Z4X2lu
ZGV4X3ZhbCk7CisJV1JFRzMyX1NPQzE1X1JMQ19TSEFET1coR0MsIDAsIG1tR1JCTV9HRlhfSU5E
RVgsIGdmeF9pbmRleF92YWwpOwogCVdSRUczMihTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbVNR
X0NNRCksIHNxX2NtZCk7CiAKIAlkYXRhID0gUkVHX1NFVF9GSUVMRChkYXRhLCBHUkJNX0dGWF9J
TkRFWCwKQEAgLTkzNSw3ICs5MzUsNyBAQCBzdGF0aWMgaW50IGtnZF93YXZlX2NvbnRyb2xfZXhl
Y3V0ZShzdHJ1Y3Qga2dkX2RldiAqa2dkLAogCWRhdGEgPSBSRUdfU0VUX0ZJRUxEKGRhdGEsIEdS
Qk1fR0ZYX0lOREVYLAogCQlTRV9CUk9BRENBU1RfV1JJVEVTLCAxKTsKIAotCVdSRUczMihTT0Mx
NV9SRUdfT0ZGU0VUKEdDLCAwLCBtbUdSQk1fR0ZYX0lOREVYKSwgZGF0YSk7CisJV1JFRzMyX1NP
QzE1X1JMQ19TSEFET1coR0MsIDAsIG1tR1JCTV9HRlhfSU5ERVgsIGRhdGEpOwogCW11dGV4X3Vu
bG9jaygmYWRldi0+Z3JibV9pZHhfbXV0ZXgpOwogCiAJcmV0dXJuIDA7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvZ2Z4X3Y5XzAuYwppbmRleCA2YjIwM2M5Li4zZWJkMGFmIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nZnhfdjlfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2dmeF92OV8wLmMKQEAgLTE4MzYsNyArMTgzNiw3IEBAIHN0YXRpYyB2b2lk
IGdmeF92OV8wX3NlbGVjdF9zZV9zaChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgdTMyIHNl
X251bSwgdTMyIHNoCiAJZWxzZQogCQlkYXRhID0gUkVHX1NFVF9GSUVMRChkYXRhLCBHUkJNX0dG
WF9JTkRFWCwgU0hfSU5ERVgsIHNoX251bSk7CiAKLQlXUkVHMzJfU09DMTUoR0MsIDAsIG1tR1JC
TV9HRlhfSU5ERVgsIGRhdGEpOworCVdSRUczMl9TT0MxNV9STENfU0hBRE9XKEdDLCAwLCBtbUdS
Qk1fR0ZYX0lOREVYLCBkYXRhKTsKIH0KIAogc3RhdGljIHUzMiBnZnhfdjlfMF9nZXRfcmJfYWN0
aXZlX2JpdG1hcChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKQEAgLTE5MDQsOCArMTkwNCw4
IEBAIHN0YXRpYyB2b2lkIGdmeF92OV8wX2luaXRfY29tcHV0ZV92bWlkKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2KQogCWZvciAoaSA9IEZJUlNUX0NPTVBVVEVfVk1JRDsgaSA8IExBU1RfQ09N
UFVURV9WTUlEOyBpKyspIHsKIAkJc29jMTVfZ3JibV9zZWxlY3QoYWRldiwgMCwgMCwgMCwgaSk7
CiAJCS8qIENQIGFuZCBzaGFkZXJzICovCi0JCVdSRUczMl9TT0MxNShHQywgMCwgbW1TSF9NRU1f
Q09ORklHLCBzaF9tZW1fY29uZmlnKTsKLQkJV1JFRzMyX1NPQzE1KEdDLCAwLCBtbVNIX01FTV9C
QVNFUywgc2hfbWVtX2Jhc2VzKTsKKwkJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1TSF9NRU1f
Q09ORklHLCBzaF9tZW1fY29uZmlnKTsKKwkJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1TSF9N
RU1fQkFTRVMsIHNoX21lbV9iYXNlcyk7CiAJfQogCXNvYzE1X2dyYm1fc2VsZWN0KGFkZXYsIDAs
IDAsIDAsIDApOwogCW11dGV4X3VubG9jaygmYWRldi0+c3JibV9tdXRleCk7CkBAIC0xOTE2LDcg
KzE5MTYsNyBAQCBzdGF0aWMgdm9pZCBnZnhfdjlfMF9jb25zdGFudHNfaW5pdChzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldikKIAl1MzIgdG1wOwogCWludCBpOwogCi0JV1JFRzMyX0ZJRUxEMTUo
R0MsIDAsIEdSQk1fQ05UTCwgUkVBRF9USU1FT1VULCAweGZmKTsKKwlXUkVHMzJfRklFTEQxNV9S
TEMoR0MsIDAsIEdSQk1fQ05UTCwgUkVBRF9USU1FT1VULCAweGZmKTsKIAogCWdmeF92OV8wX3Rp
bGluZ19tb2RlX3RhYmxlX2luaXQoYWRldik7CiAKQEAgLTE5NjMsNyArMTk2Myw3IEBAIHN0YXRp
YyB2b2lkIGdmeF92OV8wX2NvbnN0YW50c19pbml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2
KQogCSAqLwogCWdmeF92OV8wX3NlbGVjdF9zZV9zaChhZGV2LCAweGZmZmZmZmZmLCAweGZmZmZm
ZmZmLCAweGZmZmZmZmZmKTsKIAotCVdSRUczMl9TT0MxNShHQywgMCwgbW1QQV9TQ19GSUZPX1NJ
WkUsCisJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1QQV9TQ19GSUZPX1NJWkUsCiAJCSAgIChh
ZGV2LT5nZnguY29uZmlnLnNjX3ByaW1fZmlmb19zaXplX2Zyb250ZW5kIDw8CiAJCQlQQV9TQ19G
SUZPX1NJWkVfX1NDX0ZST05URU5EX1BSSU1fRklGT19TSVpFX19TSElGVCkgfAogCQkgICAoYWRl
di0+Z2Z4LmNvbmZpZy5zY19wcmltX2ZpZm9fc2l6ZV9iYWNrZW5kIDw8CkBAIC0yMDMwLDExICsy
MDMwLDExIEBAIHN0YXRpYyB2b2lkIGdmeF92OV8wX2VuYWJsZV9ndWlfaWRsZV9pbnRlcnJ1cHQo
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiBzdGF0aWMgdm9pZCBnZnhfdjlfMF9pbml0X2Nz
YihzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIHsKIAkvKiBjc2liICovCi0JV1JFRzMyKFNP
QzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tUkxDX0NTSUJfQUREUl9ISSksCisJV1JFRzMyX1JMQyhT
T0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbVJMQ19DU0lCX0FERFJfSEkpLAogCQkJYWRldi0+Z2Z4
LnJsYy5jbGVhcl9zdGF0ZV9ncHVfYWRkciA+PiAzMik7Ci0JV1JFRzMyKFNPQzE1X1JFR19PRkZT
RVQoR0MsIDAsIG1tUkxDX0NTSUJfQUREUl9MTyksCisJV1JFRzMyX1JMQyhTT0MxNV9SRUdfT0ZG
U0VUKEdDLCAwLCBtbVJMQ19DU0lCX0FERFJfTE8pLAogCQkJYWRldi0+Z2Z4LnJsYy5jbGVhcl9z
dGF0ZV9ncHVfYWRkciAmIDB4ZmZmZmZmZmMpOwotCVdSRUczMihTT0MxNV9SRUdfT0ZGU0VUKEdD
LCAwLCBtbVJMQ19DU0lCX0xFTkdUSCksCisJV1JFRzMyX1JMQyhTT0MxNV9SRUdfT0ZGU0VUKEdD
LCAwLCBtbVJMQ19DU0lCX0xFTkdUSCksCiAJCQlhZGV2LT5nZngucmxjLmNsZWFyX3N0YXRlX3Np
emUpOwogfQogCkBAIC0yNTA2LDcgKzI1MDYsNyBAQCBzdGF0aWMgdm9pZCBnZnhfdjlfMF9jcF9n
ZnhfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBib29sIGVuYWJsZSkKIAkJZm9y
IChpID0gMDsgaSA8IGFkZXYtPmdmeC5udW1fZ2Z4X3JpbmdzOyBpKyspCiAJCQlhZGV2LT5nZngu
Z2Z4X3JpbmdbaV0uc2NoZWQucmVhZHkgPSBmYWxzZTsKIAl9Ci0JV1JFRzMyX1NPQzE1KEdDLCAw
LCBtbUNQX01FX0NOVEwsIHRtcCk7CisJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1DUF9NRV9D
TlRMLCB0bXApOwogCXVkZWxheSg1MCk7CiB9CiAKQEAgLTI3MDQsOSArMjcwNCw5IEBAIHN0YXRp
YyB2b2lkIGdmeF92OV8wX2NwX2NvbXB1dGVfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNlICph
ZGV2LCBib29sIGVuYWJsZSkKIAlpbnQgaTsKIAogCWlmIChlbmFibGUpIHsKLQkJV1JFRzMyX1NP
QzE1KEdDLCAwLCBtbUNQX01FQ19DTlRMLCAwKTsKKwkJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwg
bW1DUF9NRUNfQ05UTCwgMCk7CiAJfSBlbHNlIHsKLQkJV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQ
X01FQ19DTlRMLAorCQlXUkVHMzJfU09DMTVfUkxDKEdDLCAwLCBtbUNQX01FQ19DTlRMLAogCQkJ
KENQX01FQ19DTlRMX19NRUNfTUUxX0hBTFRfTUFTSyB8IENQX01FQ19DTlRMX19NRUNfTUUyX0hB
TFRfTUFTSykpOwogCQlmb3IgKGkgPSAwOyBpIDwgYWRldi0+Z2Z4Lm51bV9jb21wdXRlX3Jpbmdz
OyBpKyspCiAJCQlhZGV2LT5nZnguY29tcHV0ZV9yaW5nW2ldLnNjaGVkLnJlYWR5ID0gZmFsc2U7
CkBAIC0yNzY3LDkgKzI3NjcsOSBAQCBzdGF0aWMgdm9pZCBnZnhfdjlfMF9raXFfc2V0dGluZyhz
dHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpCiAJdG1wID0gUlJFRzMyX1NPQzE1KEdDLCAwLCBtbVJM
Q19DUF9TQ0hFRFVMRVJTKTsKIAl0bXAgJj0gMHhmZmZmZmYwMDsKIAl0bXAgfD0gKHJpbmctPm1l
IDw8IDUpIHwgKHJpbmctPnBpcGUgPDwgMykgfCAocmluZy0+cXVldWUpOwotCVdSRUczMl9TT0Mx
NShHQywgMCwgbW1STENfQ1BfU0NIRURVTEVSUywgdG1wKTsKKwlXUkVHMzJfU09DMTVfUkxDKEdD
LCAwLCBtbVJMQ19DUF9TQ0hFRFVMRVJTLCB0bXApOwogCXRtcCB8PSAweDgwOwotCVdSRUczMl9T
T0MxNShHQywgMCwgbW1STENfQ1BfU0NIRURVTEVSUywgdG1wKTsKKwlXUkVHMzJfU09DMTVfUkxD
KEdDLCAwLCBtbVJMQ19DUF9TQ0hFRFVMRVJTLCB0bXApOwogfQogCiBzdGF0aWMgaW50IGdmeF92
OV8wX2tpcV9rY3FfZW5hYmxlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQpAQCAtMjk4Nyw2
NyArMjk4Nyw2NyBAQCBzdGF0aWMgaW50IGdmeF92OV8wX2tpcV9pbml0X3JlZ2lzdGVyKHN0cnVj
dCBhbWRncHVfcmluZyAqcmluZykKIAkvKiBkaXNhYmxlIHdwdHIgcG9sbGluZyAqLwogCVdSRUcz
Ml9GSUVMRDE1KEdDLCAwLCBDUF9QUV9XUFRSX1BPTExfQ05UTCwgRU4sIDApOwogCi0JV1JFRzMy
X1NPQzE1KEdDLCAwLCBtbUNQX0hRRF9FT1BfQkFTRV9BRERSLAorCVdSRUczMl9TT0MxNV9STEMo
R0MsIDAsIG1tQ1BfSFFEX0VPUF9CQVNFX0FERFIsCiAJICAgICAgIG1xZC0+Y3BfaHFkX2VvcF9i
YXNlX2FkZHJfbG8pOwotCVdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfRU9QX0JBU0VfQURE
Ul9ISSwKKwlXUkVHMzJfU09DMTVfUkxDKEdDLCAwLCBtbUNQX0hRRF9FT1BfQkFTRV9BRERSX0hJ
LAogCSAgICAgICBtcWQtPmNwX2hxZF9lb3BfYmFzZV9hZGRyX2hpKTsKIAogCS8qIHNldCB0aGUg
RU9QIHNpemUsIHJlZ2lzdGVyIHZhbHVlIGlzIDJeKEVPUF9TSVpFKzEpIGR3b3JkcyAqLwotCVdS
RUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfRU9QX0NPTlRST0wsCisJV1JFRzMyX1NPQzE1X1JM
QyhHQywgMCwgbW1DUF9IUURfRU9QX0NPTlRST0wsCiAJICAgICAgIG1xZC0+Y3BfaHFkX2VvcF9j
b250cm9sKTsKIAogCS8qIGVuYWJsZSBkb29yYmVsbD8gKi8KLQlXUkVHMzJfU09DMTUoR0MsIDAs
IG1tQ1BfSFFEX1BRX0RPT1JCRUxMX0NPTlRST0wsCisJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwg
bW1DUF9IUURfUFFfRE9PUkJFTExfQ09OVFJPTCwKIAkgICAgICAgbXFkLT5jcF9ocWRfcHFfZG9v
cmJlbGxfY29udHJvbCk7CiAKIAkvKiBkaXNhYmxlIHRoZSBxdWV1ZSBpZiBpdCdzIGFjdGl2ZSAq
LwogCWlmIChSUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfSFFEX0FDVElWRSkgJiAxKSB7Ci0JCVdS
RUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfREVRVUVVRV9SRVFVRVNULCAxKTsKKwkJV1JFRzMy
X1NPQzE1X1JMQyhHQywgMCwgbW1DUF9IUURfREVRVUVVRV9SRVFVRVNULCAxKTsKIAkJZm9yIChq
ID0gMDsgaiA8IGFkZXYtPnVzZWNfdGltZW91dDsgaisrKSB7CiAJCQlpZiAoIShSUkVHMzJfU09D
MTUoR0MsIDAsIG1tQ1BfSFFEX0FDVElWRSkgJiAxKSkKIAkJCQlicmVhazsKIAkJCXVkZWxheSgx
KTsKIAkJfQotCQlXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfSFFEX0RFUVVFVUVfUkVRVUVTVCwK
KwkJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1DUF9IUURfREVRVUVVRV9SRVFVRVNULAogCQkg
ICAgICAgbXFkLT5jcF9ocWRfZGVxdWV1ZV9yZXF1ZXN0KTsKLQkJV1JFRzMyX1NPQzE1KEdDLCAw
LCBtbUNQX0hRRF9QUV9SUFRSLAorCQlXUkVHMzJfU09DMTVfUkxDKEdDLCAwLCBtbUNQX0hRRF9Q
UV9SUFRSLAogCQkgICAgICAgbXFkLT5jcF9ocWRfcHFfcnB0cik7Ci0JCVdSRUczMl9TT0MxNShH
QywgMCwgbW1DUF9IUURfUFFfV1BUUl9MTywKKwkJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1D
UF9IUURfUFFfV1BUUl9MTywKIAkJICAgICAgIG1xZC0+Y3BfaHFkX3BxX3dwdHJfbG8pOwotCQlX
UkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfSFFEX1BRX1dQVFJfSEksCisJCVdSRUczMl9TT0MxNV9S
TEMoR0MsIDAsIG1tQ1BfSFFEX1BRX1dQVFJfSEksCiAJCSAgICAgICBtcWQtPmNwX2hxZF9wcV93
cHRyX2hpKTsKIAl9CiAKIAkvKiBzZXQgdGhlIHBvaW50ZXIgdG8gdGhlIE1RRCAqLwotCVdSRUcz
Ml9TT0MxNShHQywgMCwgbW1DUF9NUURfQkFTRV9BRERSLAorCVdSRUczMl9TT0MxNV9STEMoR0Ms
IDAsIG1tQ1BfTVFEX0JBU0VfQUREUiwKIAkgICAgICAgbXFkLT5jcF9tcWRfYmFzZV9hZGRyX2xv
KTsKLQlXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfTVFEX0JBU0VfQUREUl9ISSwKKwlXUkVHMzJf
U09DMTVfUkxDKEdDLCAwLCBtbUNQX01RRF9CQVNFX0FERFJfSEksCiAJICAgICAgIG1xZC0+Y3Bf
bXFkX2Jhc2VfYWRkcl9oaSk7CiAKIAkvKiBzZXQgTVFEIHZtaWQgdG8gMCAqLwotCVdSRUczMl9T
T0MxNShHQywgMCwgbW1DUF9NUURfQ09OVFJPTCwKKwlXUkVHMzJfU09DMTVfUkxDKEdDLCAwLCBt
bUNQX01RRF9DT05UUk9MLAogCSAgICAgICBtcWQtPmNwX21xZF9jb250cm9sKTsKIAogCS8qIHNl
dCB0aGUgcG9pbnRlciB0byB0aGUgSFFELCB0aGlzIGlzIHNpbWlsYXIgQ1BfUkIwX0JBU0UvX0hJ
ICovCi0JV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX0hRRF9QUV9CQVNFLAorCVdSRUczMl9TT0Mx
NV9STEMoR0MsIDAsIG1tQ1BfSFFEX1BRX0JBU0UsCiAJICAgICAgIG1xZC0+Y3BfaHFkX3BxX2Jh
c2VfbG8pOwotCVdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfUFFfQkFTRV9ISSwKKwlXUkVH
MzJfU09DMTVfUkxDKEdDLCAwLCBtbUNQX0hRRF9QUV9CQVNFX0hJLAogCSAgICAgICBtcWQtPmNw
X2hxZF9wcV9iYXNlX2hpKTsKIAogCS8qIHNldCB1cCB0aGUgSFFELCB0aGlzIGlzIHNpbWlsYXIg
dG8gQ1BfUkIwX0NOVEwgKi8KLQlXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfSFFEX1BRX0NPTlRS
T0wsCisJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1DUF9IUURfUFFfQ09OVFJPTCwKIAkgICAg
ICAgbXFkLT5jcF9ocWRfcHFfY29udHJvbCk7CiAKIAkvKiBzZXQgdGhlIHdiIGFkZHJlc3Mgd2hl
dGhlciBpdCdzIGVuYWJsZWQgb3Igbm90ICovCi0JV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX0hR
RF9QUV9SUFRSX1JFUE9SVF9BRERSLAorCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1tQ1BfSFFE
X1BRX1JQVFJfUkVQT1JUX0FERFIsCiAJCQkJbXFkLT5jcF9ocWRfcHFfcnB0cl9yZXBvcnRfYWRk
cl9sbyk7Ci0JV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX0hRRF9QUV9SUFRSX1JFUE9SVF9BRERS
X0hJLAorCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1tQ1BfSFFEX1BRX1JQVFJfUkVQT1JUX0FE
RFJfSEksCiAJCQkJbXFkLT5jcF9ocWRfcHFfcnB0cl9yZXBvcnRfYWRkcl9oaSk7CiAKIAkvKiBv
bmx5IHVzZWQgaWYgQ1BfUFFfV1BUUl9QT0xMX0NOVEwuQ1BfUFFfV1BUUl9QT0xMX0NOVExfX0VO
X01BU0s9MSAqLwotCVdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9QT0xMX0FE
RFIsCisJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9QT0xMX0FERFIs
CiAJICAgICAgIG1xZC0+Y3BfaHFkX3BxX3dwdHJfcG9sbF9hZGRyX2xvKTsKLQlXUkVHMzJfU09D
MTUoR0MsIDAsIG1tQ1BfSFFEX1BRX1dQVFJfUE9MTF9BRERSX0hJLAorCVdSRUczMl9TT0MxNV9S
TEMoR0MsIDAsIG1tQ1BfSFFEX1BRX1dQVFJfUE9MTF9BRERSX0hJLAogCSAgICAgICBtcWQtPmNw
X2hxZF9wcV93cHRyX3BvbGxfYWRkcl9oaSk7CiAKIAkvKiBlbmFibGUgdGhlIGRvb3JiZWxsIGlm
IHJlcXVlc3RlZCAqLwpAQCAtMzA2MiwxOSArMzA2MiwxOSBAQCBzdGF0aWMgaW50IGdmeF92OV8w
X2tpcV9pbml0X3JlZ2lzdGVyKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZykKIAkgICAgICAgbXFk
LT5jcF9ocWRfcHFfZG9vcmJlbGxfY29udHJvbCk7CiAKIAkvKiByZXNldCByZWFkIGFuZCB3cml0
ZSBwb2ludGVycywgc2ltaWxhciB0byBDUF9SQjBfV1BUUi9fUlBUUiAqLwotCVdSRUczMl9TT0Mx
NShHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9MTywKKwlXUkVHMzJfU09DMTVfUkxDKEdDLCAwLCBt
bUNQX0hRRF9QUV9XUFRSX0xPLAogCSAgICAgICBtcWQtPmNwX2hxZF9wcV93cHRyX2xvKTsKLQlX
UkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfSFFEX1BRX1dQVFJfSEksCisJV1JFRzMyX1NPQzE1X1JM
QyhHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9ISSwKIAkgICAgICAgbXFkLT5jcF9ocWRfcHFfd3B0
cl9oaSk7CiAKIAkvKiBzZXQgdGhlIHZtaWQgZm9yIHRoZSBxdWV1ZSAqLwotCVdSRUczMl9TT0Mx
NShHQywgMCwgbW1DUF9IUURfVk1JRCwgbXFkLT5jcF9ocWRfdm1pZCk7CisJV1JFRzMyX1NPQzE1
X1JMQyhHQywgMCwgbW1DUF9IUURfVk1JRCwgbXFkLT5jcF9ocWRfdm1pZCk7CiAKLQlXUkVHMzJf
U09DMTUoR0MsIDAsIG1tQ1BfSFFEX1BFUlNJU1RFTlRfU1RBVEUsCisJV1JFRzMyX1NPQzE1X1JM
QyhHQywgMCwgbW1DUF9IUURfUEVSU0lTVEVOVF9TVEFURSwKIAkgICAgICAgbXFkLT5jcF9ocWRf
cGVyc2lzdGVudF9zdGF0ZSk7CiAKIAkvKiBhY3RpdmF0ZSB0aGUgcXVldWUgKi8KLQlXUkVHMzJf
U09DMTUoR0MsIDAsIG1tQ1BfSFFEX0FDVElWRSwKKwlXUkVHMzJfU09DMTVfUkxDKEdDLCAwLCBt
bUNQX0hRRF9BQ1RJVkUsCiAJICAgICAgIG1xZC0+Y3BfaHFkX2FjdGl2ZSk7CiAKIAlpZiAocmlu
Zy0+dXNlX2Rvb3JiZWxsKQpAQCAtMzA5MSw3ICszMDkxLDcgQEAgc3RhdGljIGludCBnZnhfdjlf
MF9raXFfZmluaV9yZWdpc3RlcihzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcpCiAJLyogZGlzYWJs
ZSB0aGUgcXVldWUgaWYgaXQncyBhY3RpdmUgKi8KIAlpZiAoUlJFRzMyX1NPQzE1KEdDLCAwLCBt
bUNQX0hRRF9BQ1RJVkUpICYgMSkgewogCi0JCVdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURf
REVRVUVVRV9SRVFVRVNULCAxKTsKKwkJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1DUF9IUURf
REVRVUVVRV9SRVFVRVNULCAxKTsKIAogCQlmb3IgKGogPSAwOyBqIDwgYWRldi0+dXNlY190aW1l
b3V0OyBqKyspIHsKIAkJCWlmICghKFJSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfQUNUSVZF
KSAmIDEpKQpAQCAtMzEwMywyMSArMzEwMywyMSBAQCBzdGF0aWMgaW50IGdmeF92OV8wX2tpcV9m
aW5pX3JlZ2lzdGVyKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZykKIAkJCURSTV9ERUJVRygiS0lR
IGRlcXVldWUgcmVxdWVzdCBmYWlsZWQuXG4iKTsKIAogCQkJLyogTWFudWFsIGRpc2FibGUgaWYg
ZGVxdWV1ZSByZXF1ZXN0IHRpbWVzIG91dCAqLwotCQkJV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQ
X0hRRF9BQ1RJVkUsIDApOworCQkJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1DUF9IUURfQUNU
SVZFLCAwKTsKIAkJfQogCi0JCVdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfREVRVUVVRV9S
RVFVRVNULAorCQlXUkVHMzJfU09DMTVfUkxDKEdDLCAwLCBtbUNQX0hRRF9ERVFVRVVFX1JFUVVF
U1QsCiAJCSAgICAgIDApOwogCX0KIAotCVdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfSVFf
VElNRVIsIDApOwotCVdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfSUJfQ09OVFJPTCwgMCk7
Ci0JV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX0hRRF9QRVJTSVNURU5UX1NUQVRFLCAwKTsKLQlX
UkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfSFFEX1BRX0RPT1JCRUxMX0NPTlRST0wsIDB4NDAwMDAw
MDApOwotCVdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfUFFfRE9PUkJFTExfQ09OVFJPTCwg
MCk7Ci0JV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX0hRRF9QUV9SUFRSLCAwKTsKLQlXUkVHMzJf
U09DMTUoR0MsIDAsIG1tQ1BfSFFEX1BRX1dQVFJfSEksIDApOwotCVdSRUczMl9TT0MxNShHQywg
MCwgbW1DUF9IUURfUFFfV1BUUl9MTywgMCk7CisJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1D
UF9IUURfSVFfVElNRVIsIDApOworCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1tQ1BfSFFEX0lC
X0NPTlRST0wsIDApOworCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1tQ1BfSFFEX1BFUlNJU1RF
TlRfU1RBVEUsIDApOworCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1tQ1BfSFFEX1BRX0RPT1JC
RUxMX0NPTlRST0wsIDB4NDAwMDAwMDApOworCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1tQ1Bf
SFFEX1BRX0RPT1JCRUxMX0NPTlRST0wsIDApOworCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1t
Q1BfSFFEX1BRX1JQVFIsIDApOworCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1tQ1BfSFFEX1BR
X1dQVFJfSEksIDApOworCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1tQ1BfSFFEX1BRX1dQVFJf
TE8sIDApOwogCiAJcmV0dXJuIDA7CiB9CkBAIC00MzI3LDggKzQzMjcsOCBAQCBzdGF0aWMgdm9p
ZCBnZnhfdjlfMF9ocWRfc2V0X3ByaW9yaXR5KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAog
CW11dGV4X2xvY2soJmFkZXYtPnNyYm1fbXV0ZXgpOwogCXNvYzE1X2dyYm1fc2VsZWN0KGFkZXYs
IHJpbmctPm1lLCByaW5nLT5waXBlLCByaW5nLT5xdWV1ZSwgMCk7CiAKLQlXUkVHMzJfU09DMTUo
R0MsIDAsIG1tQ1BfSFFEX1BJUEVfUFJJT1JJVFksIHBpcGVfcHJpb3JpdHkpOwotCVdSRUczMl9T
T0MxNShHQywgMCwgbW1DUF9IUURfUVVFVUVfUFJJT1JJVFksIHF1ZXVlX3ByaW9yaXR5KTsKKwlX
UkVHMzJfU09DMTVfUkxDKEdDLCAwLCBtbUNQX0hRRF9QSVBFX1BSSU9SSVRZLCBwaXBlX3ByaW9y
aXR5KTsKKwlXUkVHMzJfU09DMTVfUkxDKEdDLCAwLCBtbUNQX0hRRF9RVUVVRV9QUklPUklUWSwg
cXVldWVfcHJpb3JpdHkpOwogCiAJc29jMTVfZ3JibV9zZWxlY3QoYWRldiwgMCwgMCwgMCwgMCk7
CiAJbXV0ZXhfdW5sb2NrKCZhZGV2LT5zcmJtX211dGV4KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2dmeGh1Yl92MV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nZnhodWJfdjFfMC5jCmluZGV4IDdiYjUzNTkuLjBkYzg5MjYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dmeGh1Yl92MV8wLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvZ2Z4aHViX3YxXzAuYwpAQCAtNzEsMTIgKzcxLDEyIEBAIHN0YXRpYyB2
b2lkIGdmeGh1Yl92MV8wX2luaXRfc3lzdGVtX2FwZXJ0dXJlX3JlZ3Moc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYpCiAJdWludDY0X3QgdmFsdWU7CiAKIAkvKiBQcm9ncmFtIHRoZSBBR1AgQkFS
ICovCi0JV1JFRzMyX1NPQzE1KEdDLCAwLCBtbU1DX1ZNX0FHUF9CQVNFLCAwKTsKLQlXUkVHMzJf
U09DMTUoR0MsIDAsIG1tTUNfVk1fQUdQX0JPVCwgYWRldi0+Z21jLmFncF9zdGFydCA+PiAyNCk7
Ci0JV1JFRzMyX1NPQzE1KEdDLCAwLCBtbU1DX1ZNX0FHUF9UT1AsIGFkZXYtPmdtYy5hZ3BfZW5k
ID4+IDI0KTsKKwlXUkVHMzJfU09DMTVfUkxDKEdDLCAwLCBtbU1DX1ZNX0FHUF9CQVNFLCAwKTsK
KwlXUkVHMzJfU09DMTVfUkxDKEdDLCAwLCBtbU1DX1ZNX0FHUF9CT1QsIGFkZXYtPmdtYy5hZ3Bf
c3RhcnQgPj4gMjQpOworCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1tTUNfVk1fQUdQX1RPUCwg
YWRldi0+Z21jLmFncF9lbmQgPj4gMjQpOwogCiAJLyogUHJvZ3JhbSB0aGUgc3lzdGVtIGFwZXJ0
dXJlIGxvdyBsb2dpY2FsIHBhZ2UgbnVtYmVyLiAqLwotCVdSRUczMl9TT0MxNShHQywgMCwgbW1N
Q19WTV9TWVNURU1fQVBFUlRVUkVfTE9XX0FERFIsCisJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwg
bW1NQ19WTV9TWVNURU1fQVBFUlRVUkVfTE9XX0FERFIsCiAJCSAgICAgbWluKGFkZXYtPmdtYy5m
Yl9zdGFydCwgYWRldi0+Z21jLmFncF9zdGFydCkgPj4gMTgpOwogCiAJaWYgKGFkZXYtPmFzaWNf
dHlwZSA9PSBDSElQX1JBVkVOICYmIGFkZXYtPnJldl9pZCA+PSAweDgpCkBAIC04NiwxMSArODYs
MTEgQEAgc3RhdGljIHZvaWQgZ2Z4aHViX3YxXzBfaW5pdF9zeXN0ZW1fYXBlcnR1cmVfcmVncyhz
dHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKIAkJICogd29ya2Fyb3VuZCB0aGF0IGluY3JlYXNl
IHN5c3RlbSBhcGVydHVyZSBoaWdoIGFkZHJlc3MgKGFkZCAxKQogCQkgKiB0byBnZXQgcmlkIG9m
IHRoZSBWTSBmYXVsdCBhbmQgaGFyZHdhcmUgaGFuZy4KIAkJICovCi0JCVdSRUczMl9TT0MxNShH
QywgMCwgbW1NQ19WTV9TWVNURU1fQVBFUlRVUkVfSElHSF9BRERSLAorCQlXUkVHMzJfU09DMTVf
UkxDKEdDLCAwLCBtbU1DX1ZNX1NZU1RFTV9BUEVSVFVSRV9ISUdIX0FERFIsCiAJCQkgICAgIG1h
eCgoYWRldi0+Z21jLmZiX2VuZCA+PiAxOCkgKyAweDEsCiAJCQkJIGFkZXYtPmdtYy5hZ3BfZW5k
ID4+IDE4KSk7CiAJZWxzZQotCQlXUkVHMzJfU09DMTUoR0MsIDAsIG1tTUNfVk1fU1lTVEVNX0FQ
RVJUVVJFX0hJR0hfQUREUiwKKwkJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1NQ19WTV9TWVNU
RU1fQVBFUlRVUkVfSElHSF9BRERSLAogCQkJICAgICBtYXgoYWRldi0+Z21jLmZiX2VuZCwgYWRl
di0+Z21jLmFncF9lbmQpID4+IDE4KTsKIAogCS8qIFNldCBkZWZhdWx0IHBhZ2UgYWRkcmVzcy4g
Ki8KQEAgLTEyOSw3ICsxMjksNyBAQCBzdGF0aWMgdm9pZCBnZnhodWJfdjFfMF9pbml0X3RsYl9y
ZWdzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQogCQkJICAgIE1UWVBFLCBNVFlQRV9VQyk7
LyogWFhYIGZvciBlbXVsYXRpb24uICovCiAJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIE1DX1ZN
X01YX0wxX1RMQl9DTlRMLCBBVENfRU4sIDEpOwogCi0JV1JFRzMyX1NPQzE1KEdDLCAwLCBtbU1D
X1ZNX01YX0wxX1RMQl9DTlRMLCB0bXApOworCVdSRUczMl9TT0MxNV9STEMoR0MsIDAsIG1tTUNf
Vk1fTVhfTDFfVExCX0NOVEwsIHRtcCk7CiB9CiAKIHN0YXRpYyB2b2lkIGdmeGh1Yl92MV8wX2lu
aXRfY2FjaGVfcmVncyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldikKQEAgLTI2Nyw5ICsyNjcs
OSBAQCBpbnQgZ2Z4aHViX3YxXzBfZ2FydF9lbmFibGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFk
ZXYpCiAJCSAqIFZGIGNvcHkgcmVnaXN0ZXJzIHNvIHZiaW9zIHBvc3QgZG9lc24ndCBwcm9ncmFt
IHRoZW0sIGZvcgogCQkgKiBTUklPViBkcml2ZXIgbmVlZCB0byBwcm9ncmFtIHRoZW0KIAkJICov
Ci0JCVdSRUczMl9TT0MxNShHQywgMCwgbW1NQ19WTV9GQl9MT0NBVElPTl9CQVNFLAorCQlXUkVH
MzJfU09DMTVfUkxDKEdDLCAwLCBtbU1DX1ZNX0ZCX0xPQ0FUSU9OX0JBU0UsCiAJCQkgICAgIGFk
ZXYtPmdtYy52cmFtX3N0YXJ0ID4+IDI0KTsKLQkJV1JFRzMyX1NPQzE1KEdDLCAwLCBtbU1DX1ZN
X0ZCX0xPQ0FUSU9OX1RPUCwKKwkJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1NQ19WTV9GQl9M
T0NBVElPTl9UT1AsCiAJCQkgICAgIGFkZXYtPmdtYy52cmFtX2VuZCA+PiAyNCk7CiAJfQogCkBA
IC0zMDMsNyArMzAzLDcgQEAgdm9pZCBnZnhodWJfdjFfMF9nYXJ0X2Rpc2FibGUoc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYpCiAJCQkJTUNfVk1fTVhfTDFfVExCX0NOVEwsCiAJCQkJRU5BQkxF
X0FEVkFOQ0VEX0RSSVZFUl9NT0RFTCwKIAkJCQkwKTsKLQlXUkVHMzJfU09DMTUoR0MsIDAsIG1t
TUNfVk1fTVhfTDFfVExCX0NOVEwsIHRtcCk7CisJV1JFRzMyX1NPQzE1X1JMQyhHQywgMCwgbW1N
Q19WTV9NWF9MMV9UTEJfQ05UTCwgdG1wKTsKIAogCS8qIFNldHVwIEwyIGNhY2hlICovCiAJV1JF
RzMyX0ZJRUxEMTUoR0MsIDAsIFZNX0wyX0NOVEwsIEVOQUJMRV9MMl9DQUNIRSwgMCk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zb2MxNS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvc29jMTUuYwppbmRleCA0YjdkY2FhLi40M2I3NGQwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9zb2MxNS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L3NvYzE1LmMKQEAgLTIzMCw3ICsyMzAsNyBAQCB2b2lkIHNvYzE1X2dyYm1f
c2VsZWN0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCWdyYm1fZ2Z4X2NudGwgPSBSRUdf
U0VUX0ZJRUxEKGdyYm1fZ2Z4X2NudGwsIEdSQk1fR0ZYX0NOVEwsIFZNSUQsIHZtaWQpOwogCWdy
Ym1fZ2Z4X2NudGwgPSBSRUdfU0VUX0ZJRUxEKGdyYm1fZ2Z4X2NudGwsIEdSQk1fR0ZYX0NOVEws
IFFVRVVFSUQsIHF1ZXVlKTsKIAotCVdSRUczMihTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbUdS
Qk1fR0ZYX0NOVEwpLCBncmJtX2dmeF9jbnRsKTsKKwlXUkVHMzJfU09DMTVfUkxDX1NIQURPVyhH
QywgMCwgbW1HUkJNX0dGWF9DTlRMLCBncmJtX2dmeF9jbnRsKTsKIH0KIAogc3RhdGljIHZvaWQg
c29jMTVfdmdhX3NldF9zdGF0ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCBzdGF0
ZSkKQEAgLTM4NSw3ICszODUsMTUgQEAgdm9pZCBzb2MxNV9wcm9ncmFtX3JlZ2lzdGVyX3NlcXVl
bmNlKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LAogCQkJdG1wICY9IH4oZW50cnktPmFuZF9t
YXNrKTsKIAkJCXRtcCB8PSBlbnRyeS0+b3JfbWFzazsKIAkJfQotCQlXUkVHMzIocmVnLCB0bXAp
OworCisJCWlmIChyZWcgPT0gU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1QQV9TQ19CSU5ORVJf
RVZFTlRfQ05UTF8zKSB8fAorCQkJcmVnID09IFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tUEFf
U0NfRU5IQU5DRSkgfHwKKwkJCXJlZyA9PSBTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbVBBX1ND
X0VOSEFOQ0VfMSkgfHwKKwkJCXJlZyA9PSBTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbVNIX01F
TV9DT05GSUcpKQorCQkJV1JFRzMyX1JMQyhyZWcsIHRtcCk7CisJCWVsc2UKKwkJCVdSRUczMihy
ZWcsIHRtcCk7CisKIAl9CiAKIH0KLS0gCjIuNy40CgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2FtZC1nZng=
