Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B389928ED57
	for <lists+amd-gfx@lfdr.de>; Thu, 15 Oct 2020 09:04:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 46FA06E06B;
	Thu, 15 Oct 2020 07:04:14 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-ed1-x544.google.com (mail-ed1-x544.google.com
 [IPv6:2a00:1450:4864:20::544])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A0CE36E06B
 for <amd-gfx@lists.freedesktop.org>; Thu, 15 Oct 2020 07:04:13 +0000 (UTC)
Received: by mail-ed1-x544.google.com with SMTP id t20so1925975edr.11
 for <amd-gfx@lists.freedesktop.org>; Thu, 15 Oct 2020 00:04:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=reply-to:subject:to:cc:references:from:message-id:date:user-agent
 :mime-version:in-reply-to:content-transfer-encoding:content-language;
 bh=FGWPL5KwDuHRrnuDerXXU4tUzeVIwe6+odxSIA26Hj0=;
 b=t2akKgLS678k+mHX36NvoMjDqIDd/TIw9uRSwKjoy869MU7sgpsRmWiwLdnSEGbjyf
 I0xz9wLVfSxCpVO/zvt1mIwJYMwSI+6dVkH5nsyJkqPqfGXa1acaT+6M3tQiUF5EtnbM
 lOyAZHuH23s7meelVK+k3AEzlbOtHvNAvmZQi/PiaISrTGWP0wGSgDKMQj7HkkL1oCJ0
 t95821kcry0toMJnBansXfIuRl7dHnR5iPFWXadeq1/F/DTtEJ9A0sE03mOvyOyqhXsw
 cdOPFs9SyAUvVmL7Yx+ycssKs3MPgDzzAgXJCaNRJ9/Qy0UmmTbnZ8AQvlOxF/1dkFQg
 EnhA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:reply-to:subject:to:cc:references:from
 :message-id:date:user-agent:mime-version:in-reply-to
 :content-transfer-encoding:content-language;
 bh=FGWPL5KwDuHRrnuDerXXU4tUzeVIwe6+odxSIA26Hj0=;
 b=Ci3QZ7lt+YaV1VR5akKHXOYQoSVcD2GtyaAEKhsiU+pGPi4pL0GhvfPSV7vErNsaFB
 Gz1iItAKtXueXBs+Cw0nqAAGgtU9EwYXxaAldbDtGbX0mWooCTOSy9Gsv8sG3RuY7hhn
 IEbSVJe4T5pJy2EPWtKqilthAOoZ0L/c8f5eUn2fUQ/gFqf8cPJKPxwaPPzGY/UsZ+PQ
 rmBpOjykXsrTMcaAYMuP4KZMHm7inJvXdcC7tdEdXyk5Vg8nTj4efvJLokodFVNcc2gV
 0aPbG3kFqCQeglijtUgnYU+NXBRQwJpAuT2FIyhzL+F5xQEucQbvzDNpRHx3niv7m4ED
 nEXw==
X-Gm-Message-State: AOAM530/ezFF1YBUxBFshBCb3fFhW2FUVI32UAHHn3Ipl7CuxBQDQ/9+
 MNDwjWTshSGsE08RIRj8FgE=
X-Google-Smtp-Source: ABdhPJzIdDm0uNwP2fKzKOlB9QSDfRZYDcRmsLivPLIgMhLiFiYNMRAVAVsH50PBMEptIc/fututcw==
X-Received: by 2002:a50:f389:: with SMTP id g9mr2941101edm.367.1602745451925; 
 Thu, 15 Oct 2020 00:04:11 -0700 (PDT)
Received: from ?IPv6:2a02:908:1252:fb60:be8a:bd56:1f94:86e7?
 ([2a02:908:1252:fb60:be8a:bd56:1f94:86e7])
 by smtp.gmail.com with ESMTPSA id e5sm919253ejb.26.2020.10.15.00.04.10
 (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
 Thu, 15 Oct 2020 00:04:11 -0700 (PDT)
Subject: Re: [PATCH 2/2] drm/amdgpu: nuke amdgpu_vm_bo_split_mapping
To: Luben Tuikov <luben.tuikov@amd.com>, amd-gfx@lists.freedesktop.org
References: <20201013170820.1548-1-christian.koenig@amd.com>
 <20201013170820.1548-2-christian.koenig@amd.com>
 <2eff0639-03df-b8e7-1895-1390cd6773b5@amd.com>
From: =?UTF-8?Q?Christian_K=c3=b6nig?= <ckoenig.leichtzumerken@gmail.com>
Message-ID: <b6c3412a-245d-f1a2-02f4-9f0e2a0f05f0@gmail.com>
Date: Thu, 15 Oct 2020 09:04:10 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.10.0
MIME-Version: 1.0
In-Reply-To: <2eff0639-03df-b8e7-1895-1390cd6773b5@amd.com>
Content-Language: en-US
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Reply-To: christian.koenig@amd.com
Cc: Madhav.Chauhan@amd.com, xinhui.pan@amd.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QW0gMTQuMTAuMjAgdW0gMjI6NDggc2NocmllYiBMdWJlbiBUdWlrb3Y6Cj4gT24gMjAyMC0xMC0x
MyAxMzowOCwgQ2hyaXN0aWFuIEvDtm5pZyB3cm90ZToKPj4gTWVyZ2UgdGhlIGZ1bmN0aW9uYWxp
dHkgbW9zdGx5IGludG8gYW1kZ3B1X3ZtX2JvX3VwZGF0ZV9tYXBwaW5nLgo+Pgo+PiBUaGlzIHdh
eSB3ZSBjYW4gZXZlbiBoYW5kbGUgc21hbGwgY29udGlndW91cyBzeXN0ZW0gcGFnZXMgd2l0aG91
dAo+PiB0byBtdWNoIGV4dHJhIENQVSBvdmVyaGVhZC4KPj4KPj4gTGFyZ2UgY29udGlndW91cyBh
bGxvY2F0aW9ucyAoMUdCKSBzdGlsbCBpbXByb3ZlIGZyb20gMS4yIHRvIDAuMyBzZWNvbmRzLgo+
Pgo+PiBTaWduZWQtb2ZmLWJ5OiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFt
ZC5jb20+Cj4+IC0tLQo+PiAgIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5j
IHwgMjMxICsrKysrKysrKysrLS0tLS0tLS0tLS0tLS0KPj4gICAxIGZpbGUgY2hhbmdlZCwgMTAz
IGluc2VydGlvbnMoKyksIDEyOCBkZWxldGlvbnMoLSkKPj4KPj4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3ZtLmMKPj4gaW5kZXggM2NkOTQ5YWFkNTAwLi40ODM0MmU1NGIyY2IgMTAw
NjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5jCj4+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV92bS5jCj4+IEBAIC0xNDI5LDIx
ICsxNDI5LDE4IEBAIHN0YXRpYyB2b2lkIGFtZGdwdV92bV9mcmFnbWVudChzdHJ1Y3QgYW1kZ3B1
X3ZtX3VwZGF0ZV9wYXJhbXMgKnBhcmFtcywKPj4gICAgKiAwIGZvciBzdWNjZXNzLCAtRUlOVkFM
IGZvciBmYWlsdXJlLgo+PiAgICAqLwo+PiAgIHN0YXRpYyBpbnQgYW1kZ3B1X3ZtX3VwZGF0ZV9w
dGVzKHN0cnVjdCBhbWRncHVfdm1fdXBkYXRlX3BhcmFtcyAqcGFyYW1zLAo+PiArCQkJCSBzdHJ1
Y3QgYW1kZ3B1X3ZtX3B0X2N1cnNvciAqY3Vyc29yLAo+PiAgIAkJCQkgdWludDY0X3Qgc3RhcnQs
IHVpbnQ2NF90IGVuZCwKPj4gICAJCQkJIHVpbnQ2NF90IGRzdCwgdWludDY0X3QgZmxhZ3MpCj4+
ICAgewo+PiAgIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IHBhcmFtcy0+YWRldjsKPj4g
LQlzdHJ1Y3QgYW1kZ3B1X3ZtX3B0X2N1cnNvciBjdXJzb3I7Cj4+ICAgCXVpbnQ2NF90IGZyYWdf
c3RhcnQgPSBzdGFydCwgZnJhZ19lbmQ7Cj4+ICAgCXVuc2lnbmVkIGludCBmcmFnOwo+PiAgIAlp
bnQgcjsKPj4gICAKPj4gICAJLyogZmlndXJlIG91dCB0aGUgaW5pdGlhbCBmcmFnbWVudCAqLwo+
PiAgIAlhbWRncHVfdm1fZnJhZ21lbnQocGFyYW1zLCBmcmFnX3N0YXJ0LCBlbmQsIGZsYWdzLCAm
ZnJhZywgJmZyYWdfZW5kKTsKPj4gLQo+PiAtCS8qIHdhbGsgb3ZlciB0aGUgYWRkcmVzcyBzcGFj
ZSBhbmQgdXBkYXRlIHRoZSBQVHMgKi8KPj4gLQlhbWRncHVfdm1fcHRfc3RhcnQoYWRldiwgcGFy
YW1zLT52bSwgc3RhcnQsICZjdXJzb3IpOwo+PiAtCXdoaWxlIChjdXJzb3IucGZuIDwgZW5kKSB7
Cj4+ICsJd2hpbGUgKGN1cnNvci0+cGZuIDwgZW5kKSB7Cj4+ICAgCQl1bnNpZ25lZCBzaGlmdCwg
cGFyZW50X3NoaWZ0LCBtYXNrOwo+PiAgIAkJdWludDY0X3QgaW5jciwgZW50cnlfZW5kLCBwZV9z
dGFydDsKPj4gICAJCXN0cnVjdCBhbWRncHVfYm8gKnB0Owo+PiBAQCAtMTQ1MywyMiArMTQ1MCwy
MiBAQCBzdGF0aWMgaW50IGFtZGdwdV92bV91cGRhdGVfcHRlcyhzdHJ1Y3QgYW1kZ3B1X3ZtX3Vw
ZGF0ZV9wYXJhbXMgKnBhcmFtcywKPj4gICAJCQkgKiBhZGRyZXNzIHJhbmdlIGFyZSBhY3R1YWxs
eSBhbGxvY2F0ZWQKPj4gICAJCQkgKi8KPj4gICAJCQlyID0gYW1kZ3B1X3ZtX2FsbG9jX3B0cyhw
YXJhbXMtPmFkZXYsIHBhcmFtcy0+dm0sCj4+IC0JCQkJCQkmY3Vyc29yLCBwYXJhbXMtPmltbWVk
aWF0ZSk7Cj4+ICsJCQkJCQljdXJzb3IsIHBhcmFtcy0+aW1tZWRpYXRlKTsKPj4gICAJCQlpZiAo
cikKPj4gICAJCQkJcmV0dXJuIHI7Cj4+ICAgCQl9Cj4+ICAgCj4+IC0JCXNoaWZ0ID0gYW1kZ3B1
X3ZtX2xldmVsX3NoaWZ0KGFkZXYsIGN1cnNvci5sZXZlbCk7Cj4+IC0JCXBhcmVudF9zaGlmdCA9
IGFtZGdwdV92bV9sZXZlbF9zaGlmdChhZGV2LCBjdXJzb3IubGV2ZWwgLSAxKTsKPj4gKwkJc2hp
ZnQgPSBhbWRncHVfdm1fbGV2ZWxfc2hpZnQoYWRldiwgY3Vyc29yLT5sZXZlbCk7Cj4+ICsJCXBh
cmVudF9zaGlmdCA9IGFtZGdwdV92bV9sZXZlbF9zaGlmdChhZGV2LCBjdXJzb3ItPmxldmVsIC0g
MSk7Cj4+ICAgCQlpZiAocGFyYW1zLT51bmxvY2tlZCkgewo+PiAgIAkJCS8qIFVubG9ja2VkIHVw
ZGF0ZXMgYXJlIG9ubHkgYWxsb3dlZCBvbiB0aGUgbGVhdmVzICovCj4+IC0JCQlpZiAoYW1kZ3B1
X3ZtX3B0X2Rlc2NlbmRhbnQoYWRldiwgJmN1cnNvcikpCj4+ICsJCQlpZiAoYW1kZ3B1X3ZtX3B0
X2Rlc2NlbmRhbnQoYWRldiwgY3Vyc29yKSkKPj4gICAJCQkJY29udGludWU7Cj4+ICAgCQl9IGVs
c2UgaWYgKGFkZXYtPmFzaWNfdHlwZSA8IENISVBfVkVHQTEwICYmCj4+ICAgCQkJICAgKGZsYWdz
ICYgQU1ER1BVX1BURV9WQUxJRCkpIHsKPj4gICAJCQkvKiBObyBodWdlIHBhZ2Ugc3VwcG9ydCBi
ZWZvcmUgR01DIHY5ICovCj4+IC0JCQlpZiAoY3Vyc29yLmxldmVsICE9IEFNREdQVV9WTV9QVEIp
IHsKPj4gLQkJCQlpZiAoIWFtZGdwdV92bV9wdF9kZXNjZW5kYW50KGFkZXYsICZjdXJzb3IpKQo+
PiArCQkJaWYgKGN1cnNvci0+bGV2ZWwgIT0gQU1ER1BVX1ZNX1BUQikgewo+PiArCQkJCWlmICgh
YW1kZ3B1X3ZtX3B0X2Rlc2NlbmRhbnQoYWRldiwgY3Vyc29yKSkKPj4gICAJCQkJCXJldHVybiAt
RU5PRU5UOwo+PiAgIAkJCQljb250aW51ZTsKPj4gICAJCQl9Cj4+IEBAIC0xNDc3LDE4ICsxNDc0
LDE4IEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3ZtX3VwZGF0ZV9wdGVzKHN0cnVjdCBhbWRncHVfdm1f
dXBkYXRlX3BhcmFtcyAqcGFyYW1zLAo+PiAgIAkJCSAqIHNtYWxsZXIgdGhhbiB0aGUgYWRkcmVz
cyBzaGlmdC4gR28gdG8gdGhlIG5leHQKPj4gICAJCQkgKiBjaGlsZCBlbnRyeSBhbmQgdHJ5IGFn
YWluLgo+PiAgIAkJCSAqLwo+PiAtCQkJaWYgKGFtZGdwdV92bV9wdF9kZXNjZW5kYW50KGFkZXYs
ICZjdXJzb3IpKQo+PiArCQkJaWYgKGFtZGdwdV92bV9wdF9kZXNjZW5kYW50KGFkZXYsIGN1cnNv
cikpCj4+ICAgCQkJCWNvbnRpbnVlOwo+PiAgIAkJfSBlbHNlIGlmIChmcmFnID49IHBhcmVudF9z
aGlmdCkgewo+PiAgIAkJCS8qIElmIHRoZSBmcmFnbWVudCBzaXplIGlzIGV2ZW4gbGFyZ2VyIHRo
YW4gdGhlIHBhcmVudAo+PiAgIAkJCSAqIHNoaWZ0IHdlIHNob3VsZCBnbyB1cCBvbmUgbGV2ZWwg
YW5kIGNoZWNrIGl0IGFnYWluLgo+PiAgIAkJCSAqLwo+PiAtCQkJaWYgKCFhbWRncHVfdm1fcHRf
YW5jZXN0b3IoJmN1cnNvcikpCj4+ICsJCQlpZiAoIWFtZGdwdV92bV9wdF9hbmNlc3RvcihjdXJz
b3IpKQo+PiAgIAkJCQlyZXR1cm4gLUVJTlZBTDsKPj4gICAJCQljb250aW51ZTsKPj4gICAJCX0K
Pj4gICAKPj4gLQkJcHQgPSBjdXJzb3IuZW50cnktPmJhc2UuYm87Cj4+ICsJCXB0ID0gY3Vyc29y
LT5lbnRyeS0+YmFzZS5ibzsKPj4gICAJCWlmICghcHQpIHsKPj4gICAJCQkvKiBXZSBuZWVkIGFs
bCBQRHMgYW5kIFBUcyBmb3IgbWFwcGluZyBzb21ldGhpbmcsICovCj4+ICAgCQkJaWYgKGZsYWdz
ICYgQU1ER1BVX1BURV9WQUxJRCkKPj4gQEAgLTE0OTcsMTAgKzE0OTQsMTAgQEAgc3RhdGljIGlu
dCBhbWRncHVfdm1fdXBkYXRlX3B0ZXMoc3RydWN0IGFtZGdwdV92bV91cGRhdGVfcGFyYW1zICpw
YXJhbXMsCj4+ICAgCQkJLyogYnV0IHVubWFwcGluZyBzb21ldGhpbmcgY2FuIGhhcHBlbiBhdCBh
IGhpZ2hlcgo+PiAgIAkJCSAqIGxldmVsLgo+PiAgIAkJCSAqLwo+PiAtCQkJaWYgKCFhbWRncHVf
dm1fcHRfYW5jZXN0b3IoJmN1cnNvcikpCj4+ICsJCQlpZiAoIWFtZGdwdV92bV9wdF9hbmNlc3Rv
cihjdXJzb3IpKQo+PiAgIAkJCQlyZXR1cm4gLUVJTlZBTDsKPj4gICAKPj4gLQkJCXB0ID0gY3Vy
c29yLmVudHJ5LT5iYXNlLmJvOwo+PiArCQkJcHQgPSBjdXJzb3ItPmVudHJ5LT5iYXNlLmJvOwo+
PiAgIAkJCXNoaWZ0ID0gcGFyZW50X3NoaWZ0Owo+PiAgIAkJCWZyYWdfZW5kID0gbWF4KGZyYWdf
ZW5kLCBBTElHTihmcmFnX3N0YXJ0ICsgMSwKPj4gICAJCQkJICAgMVVMTCA8PCBzaGlmdCkpOwo+
PiBAQCAtMTUwOCwxMCArMTUwNSwxMCBAQCBzdGF0aWMgaW50IGFtZGdwdV92bV91cGRhdGVfcHRl
cyhzdHJ1Y3QgYW1kZ3B1X3ZtX3VwZGF0ZV9wYXJhbXMgKnBhcmFtcywKPj4gICAKPj4gICAJCS8q
IExvb2tzIGdvb2Qgc28gZmFyLCBjYWxjdWxhdGUgcGFyYW1ldGVycyBmb3IgdGhlIHVwZGF0ZSAq
Lwo+PiAgIAkJaW5jciA9ICh1aW50NjRfdClBTURHUFVfR1BVX1BBR0VfU0laRSA8PCBzaGlmdDsK
Pj4gLQkJbWFzayA9IGFtZGdwdV92bV9lbnRyaWVzX21hc2soYWRldiwgY3Vyc29yLmxldmVsKTsK
Pj4gLQkJcGVfc3RhcnQgPSAoKGN1cnNvci5wZm4gPj4gc2hpZnQpICYgbWFzaykgKiA4Owo+PiAr
CQltYXNrID0gYW1kZ3B1X3ZtX2VudHJpZXNfbWFzayhhZGV2LCBjdXJzb3ItPmxldmVsKTsKPj4g
KwkJcGVfc3RhcnQgPSAoKGN1cnNvci0+cGZuID4+IHNoaWZ0KSAmIG1hc2spICogODsKPj4gICAJ
CWVudHJ5X2VuZCA9ICgodWludDY0X3QpbWFzayArIDEpIDw8IHNoaWZ0Owo+PiAtCQllbnRyeV9l
bmQgKz0gY3Vyc29yLnBmbiAmIH4oZW50cnlfZW5kIC0gMSk7Cj4+ICsJCWVudHJ5X2VuZCArPSBj
dXJzb3ItPnBmbiAmIH4oZW50cnlfZW5kIC0gMSk7Cj4+ICAgCQllbnRyeV9lbmQgPSBtaW4oZW50
cnlfZW5kLCBlbmQpOwo+PiAgIAo+PiAgIAkJZG8gewo+PiBAQCAtMTUyOSw3ICsxNTI2LDcgQEAg
c3RhdGljIGludCBhbWRncHVfdm1fdXBkYXRlX3B0ZXMoc3RydWN0IGFtZGdwdV92bV91cGRhdGVf
cGFyYW1zICpwYXJhbXMsCj4+ICAgCQkJCQkJICAgIG5wdGVzLCBkc3QsIGluY3IsIHVwZF9mbGFn
cywKPj4gICAJCQkJCQkgICAgdm0tPnRhc2tfaW5mby5waWQsCj4+ICAgCQkJCQkJICAgIHZtLT5p
bW1lZGlhdGUuZmVuY2VfY29udGV4dCk7Cj4+IC0JCQlhbWRncHVfdm1fdXBkYXRlX2ZsYWdzKHBh
cmFtcywgcHQsIGN1cnNvci5sZXZlbCwKPj4gKwkJCWFtZGdwdV92bV91cGRhdGVfZmxhZ3MocGFy
YW1zLCBwdCwgY3Vyc29yLT5sZXZlbCwKPj4gICAJCQkJCSAgICAgICBwZV9zdGFydCwgZHN0LCBu
cHRlcywgaW5jciwKPj4gICAJCQkJCSAgICAgICB1cGRfZmxhZ3MpOwo+PiAgIAo+PiBAQCAtMTU0
NiwyMSArMTU0MywyMSBAQCBzdGF0aWMgaW50IGFtZGdwdV92bV91cGRhdGVfcHRlcyhzdHJ1Y3Qg
YW1kZ3B1X3ZtX3VwZGF0ZV9wYXJhbXMgKnBhcmFtcywKPj4gICAJCQl9Cj4+ICAgCQl9IHdoaWxl
IChmcmFnX3N0YXJ0IDwgZW50cnlfZW5kKTsKPj4gICAKPj4gLQkJaWYgKGFtZGdwdV92bV9wdF9k
ZXNjZW5kYW50KGFkZXYsICZjdXJzb3IpKSB7Cj4+ICsJCWlmIChhbWRncHVfdm1fcHRfZGVzY2Vu
ZGFudChhZGV2LCBjdXJzb3IpKSB7Cj4+ICAgCQkJLyogRnJlZSBhbGwgY2hpbGQgZW50cmllcy4K
Pj4gICAJCQkgKiBVcGRhdGUgdGhlIHRhYmxlcyB3aXRoIHRoZSBmbGFncyBhbmQgYWRkcmVzc2Vz
IGFuZCBmcmVlIHVwIHN1YnNlcXVlbnQKPj4gICAJCQkgKiB0YWJsZXMgaW4gdGhlIGNhc2Ugb2Yg
aHVnZSBwYWdlcyBvciBmcmVlZCB1cCBhcmVhcy4KPj4gICAJCQkgKiBUaGlzIGlzIHRoZSBtYXhp
bXVtIHlvdSBjYW4gZnJlZSwgYmVjYXVzZSBhbGwgb3RoZXIgcGFnZSB0YWJsZXMgYXJlIG5vdAo+
PiAgIAkJCSAqIGNvbXBsZXRlbHkgY292ZXJlZCBieSB0aGUgcmFuZ2UgYW5kIHNvIHBvdGVudGlh
bGx5IHN0aWxsIGluIHVzZS4KPj4gICAJCQkgKi8KPj4gLQkJCXdoaWxlIChjdXJzb3IucGZuIDwg
ZnJhZ19zdGFydCkgewo+PiAtCQkJCWFtZGdwdV92bV9mcmVlX3B0cyhhZGV2LCBwYXJhbXMtPnZt
LCAmY3Vyc29yKTsKPj4gLQkJCQlhbWRncHVfdm1fcHRfbmV4dChhZGV2LCAmY3Vyc29yKTsKPj4g
KwkJCXdoaWxlIChjdXJzb3ItPnBmbiA8IGZyYWdfc3RhcnQpIHsKPj4gKwkJCQlhbWRncHVfdm1f
ZnJlZV9wdHMoYWRldiwgcGFyYW1zLT52bSwgY3Vyc29yKTsKPj4gKwkJCQlhbWRncHVfdm1fcHRf
bmV4dChhZGV2LCBjdXJzb3IpOwo+PiAgIAkJCX0KPj4gICAKPj4gICAJCX0gZWxzZSBpZiAoZnJh
ZyA+PSBzaGlmdCkgewo+PiAgIAkJCS8qIG9yIGp1c3QgbW92ZSBvbiB0byB0aGUgbmV4dCBvbiB0
aGUgc2FtZSBsZXZlbC4gKi8KPj4gLQkJCWFtZGdwdV92bV9wdF9uZXh0KGFkZXYsICZjdXJzb3Ip
Owo+PiArCQkJYW1kZ3B1X3ZtX3B0X25leHQoYWRldiwgY3Vyc29yKTsKPj4gICAJCX0KPj4gICAJ
fQo+PiAgIAo+PiBAQCAtMTU3MCw3ICsxNTY3LDggQEAgc3RhdGljIGludCBhbWRncHVfdm1fdXBk
YXRlX3B0ZXMoc3RydWN0IGFtZGdwdV92bV91cGRhdGVfcGFyYW1zICpwYXJhbXMsCj4+ICAgLyoq
Cj4+ICAgICogYW1kZ3B1X3ZtX2JvX3VwZGF0ZV9tYXBwaW5nIC0gdXBkYXRlIGEgbWFwcGluZyBp
biB0aGUgdm0gcGFnZSB0YWJsZQo+PiAgICAqCj4+IC0gKiBAYWRldjogYW1kZ3B1X2RldmljZSBw
b2ludGVyCj4+ICsgKiBAYWRldjogYW1kZ3B1X2RldmljZSBwb2ludGVyIG9mIHRoZSBWTQo+PiAr
ICogQGJvX2FkZXY6IGFtZGdwdV9kZXZpY2UgcG9pbnRlciBvZiB0aGUgbWFwcGVkIEJPCj4+ICAg
ICogQHZtOiByZXF1ZXN0ZWQgdm0KPj4gICAgKiBAaW1tZWRpYXRlOiBpbW1lZGlhdGUgc3VibWlz
c2lvbiBpbiBhIHBhZ2UgZmF1bHQKPj4gICAgKiBAdW5sb2NrZWQ6IHVubG9ja2VkIGludmFsaWRh
dGlvbiBkdXJpbmcgTU0gY2FsbGJhY2sKPj4gQEAgLTE1NzgsNyArMTU3Niw4IEBAIHN0YXRpYyBp
bnQgYW1kZ3B1X3ZtX3VwZGF0ZV9wdGVzKHN0cnVjdCBhbWRncHVfdm1fdXBkYXRlX3BhcmFtcyAq
cGFyYW1zLAo+PiAgICAqIEBzdGFydDogc3RhcnQgb2YgbWFwcGVkIHJhbmdlCj4+ICAgICogQGxh
c3Q6IGxhc3QgbWFwcGVkIGVudHJ5Cj4+ICAgICogQGZsYWdzOiBmbGFncyBmb3IgdGhlIGVudHJp
ZXMKPj4gLSAqIEBhZGRyOiBhZGRyIHRvIHNldCB0aGUgYXJlYSB0bwo+PiArICogQG9mZnNldDog
b2Zmc2V0IGludG8gbm9kZXMgYW5kIHBhZ2VzX2FkZHIKPj4gKyAqIEBub2RlczogYXJyYXkgb2Yg
ZHJtX21tX25vZGVzIHdpdGggdGhlIE1DIGFkZHJlc3Nlcwo+PiAgICAqIEBwYWdlc19hZGRyOiBE
TUEgYWRkcmVzc2VzIHRvIHVzZSBmb3IgbWFwcGluZwo+PiAgICAqIEBmZW5jZTogb3B0aW9uYWwg
cmVzdWx0aW5nIGZlbmNlCj4+ICAgICoKPj4gQEAgLTE1ODgsMTUgKzE1ODcsMTkgQEAgc3RhdGlj
IGludCBhbWRncHVfdm1fdXBkYXRlX3B0ZXMoc3RydWN0IGFtZGdwdV92bV91cGRhdGVfcGFyYW1z
ICpwYXJhbXMsCj4+ICAgICogMCBmb3Igc3VjY2VzcywgLUVJTlZBTCBmb3IgZmFpbHVyZS4KPj4g
ICAgKi8KPj4gICBzdGF0aWMgaW50IGFtZGdwdV92bV9ib191cGRhdGVfbWFwcGluZyhzdHJ1Y3Qg
YW1kZ3B1X2RldmljZSAqYWRldiwKPj4gKwkJCQkgICAgICAgc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmJvX2FkZXYsCj4+ICAgCQkJCSAgICAgICBzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwgYm9vbCBpbW1l
ZGlhdGUsCj4+ICAgCQkJCSAgICAgICBib29sIHVubG9ja2VkLCBzdHJ1Y3QgZG1hX3Jlc3YgKnJl
c3YsCj4+ICAgCQkJCSAgICAgICB1aW50NjRfdCBzdGFydCwgdWludDY0X3QgbGFzdCwKPj4gLQkJ
CQkgICAgICAgdWludDY0X3QgZmxhZ3MsIHVpbnQ2NF90IGFkZHIsCj4+ICsJCQkJICAgICAgIHVp
bnQ2NF90IGZsYWdzLCB1aW50NjRfdCBvZmZzZXQsCj4+ICsJCQkJICAgICAgIHN0cnVjdCBkcm1f
bW1fbm9kZSAqbm9kZXMsCj4+ICAgCQkJCSAgICAgICBkbWFfYWRkcl90ICpwYWdlc19hZGRyLAo+
PiAgIAkJCQkgICAgICAgc3RydWN0IGRtYV9mZW5jZSAqKmZlbmNlKQo+PiAgIHsKPj4gICAJc3Ry
dWN0IGFtZGdwdV92bV91cGRhdGVfcGFyYW1zIHBhcmFtczsKPj4gKwlzdHJ1Y3QgYW1kZ3B1X3Zt
X3B0X2N1cnNvciBjdXJzb3I7Cj4+ICAgCWVudW0gYW1kZ3B1X3N5bmNfbW9kZSBzeW5jX21vZGU7
Cj4+ICsJdWludDY0X3QgcGZuOwo+PiAgIAlpbnQgcjsKPj4gICAKPj4gICAJbWVtc2V0KCZwYXJh
bXMsIDAsIHNpemVvZihwYXJhbXMpKTsKPj4gQEAgLTE2MTQsNiArMTYxNywxNCBAQCBzdGF0aWMg
aW50IGFtZGdwdV92bV9ib191cGRhdGVfbWFwcGluZyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwKPj4gICAJZWxzZQo+PiAgIAkJc3luY19tb2RlID0gQU1ER1BVX1NZTkNfRVhQTElDSVQ7Cj4+
ICAgCj4+ICsJcGZuID0gb2Zmc2V0ID4+IFBBR0VfU0hJRlQ7Cj4+ICsJaWYgKG5vZGVzKSB7Cj4+
ICsJCXdoaWxlIChwZm4gPj0gbm9kZXMtPnNpemUpIHsKPj4gKwkJCXBmbiAtPSBub2Rlcy0+c2l6
ZTsKPj4gKwkJCSsrbm9kZXM7Cj4+ICsJCX0KPj4gKwl9Cj4+ICsKPiBJIGJlbGlldmUgaGVyZSB5
b3UgY2FuIGp1c3QgZG86Cj4KPiAJaWYgKG5vZGVzKQo+IAkJbm9kZXMgKz0gcGZuIC8gbm9kZXMt
PnNpemU7Cj4KPiBTbyBsb25nIGFzIHBmbiBhbmQgbm9kZXMtPnNpemUgYXJlIG5vbi1uZWdhdGl2
ZQo+IGludGVnZXJzIGFuZCBub2Rlcy0+c2l6ZSBpcyBub24temVybywgd2hpY2gKPiBjb25kaXRp
b25zIGFwcGVhciB0byBiZSBzYXRpc2ZpZWQuCgpUaGF0IHdvbid0IHdvcmssIHRoZSBub2Rlcy0+
c2l6ZSBpcyBub3QgY29uc3RhbnQgYnV0IGJhc2VkIG9uIHdoaWNoIGJpdHMgCndoZXJlIHNldCBp
biB0aGUgb3JpZ2luYWwgYWxsb2NhdGlvbiBzaXplLgoKSW4gb3RoZXIgd29yZHMgaWYgeW91IGFs
bG9jYXRlIDg0S2lCIG9mIG1lbW9yeSB5b3UgZ2V0IG5vZGUgc2l6ZXMgb2YgCjY0S2lCLCAxNktp
QiwgNEtpQiBJSVJDLgoKVGhlIGV4Y2VwdGlvbiBpcyBpZiB3ZSBoYXZlIGFuIGFsbG9jYXRpb24g
bGFyZ2VyIHRoYW4gMk1pQiBhbmQgYXJlIGluIGFuIApvdXQgb2YgbWVtb3J5IHNpdHVhdGlvbi4g
SW4gdGhpcyBjYXNlIHdlIGNhcCBhdCAyTWlCIGFsbG9jYXRpb25zLiBCdXQgCnRoaXMgY2FzZSBp
cyBzbyByYXJlIHRoYXQgaXQgaXMgcHJvYmFibHkgbm90IHdvcnRoIHRoZSBleHRyYSBoYW5kbGlu
Zy4KClJlZ2FyZHMsCkNocmlzdGlhbi4KCj4KPiBSZWdhcmRzLAo+IEx1YmVuCj4KPgo+PiAgIAlh
bWRncHVfdm1fZXZpY3Rpb25fbG9jayh2bSk7Cj4+ICAgCWlmICh2bS0+ZXZpY3RpbmcpIHsKPj4g
ICAJCXIgPSAtRUJVU1k7Cj4+IEBAIC0xNjMyLDEwNSArMTY0Myw0NyBAQCBzdGF0aWMgaW50IGFt
ZGdwdV92bV9ib191cGRhdGVfbWFwcGluZyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPj4g
ICAJaWYgKHIpCj4+ICAgCQlnb3RvIGVycm9yX3VubG9jazsKPj4gICAKPj4gLQlyID0gYW1kZ3B1
X3ZtX3VwZGF0ZV9wdGVzKCZwYXJhbXMsIHN0YXJ0LCBsYXN0ICsgMSwgYWRkciwgZmxhZ3MpOwo+
PiAtCWlmIChyKQo+PiAtCQlnb3RvIGVycm9yX3VubG9jazsKPj4gLQo+PiAtCXIgPSB2bS0+dXBk
YXRlX2Z1bmNzLT5jb21taXQoJnBhcmFtcywgZmVuY2UpOwo+PiAtCj4+IC1lcnJvcl91bmxvY2s6
Cj4+IC0JYW1kZ3B1X3ZtX2V2aWN0aW9uX3VubG9jayh2bSk7Cj4+IC0JcmV0dXJuIHI7Cj4+IC19
Cj4+IC0KPj4gLS8qKgo+PiAtICogYW1kZ3B1X3ZtX2JvX3NwbGl0X21hcHBpbmcgLSBzcGxpdCBh
IG1hcHBpbmcgaW50byBzbWFsbGVyIGNodW5rcwo+PiAtICoKPj4gLSAqIEBhZGV2OiBhbWRncHVf
ZGV2aWNlIHBvaW50ZXIKPj4gLSAqIEByZXN2OiBmZW5jZXMgd2UgbmVlZCB0byBzeW5jIHRvCj4+
IC0gKiBAcGFnZXNfYWRkcjogRE1BIGFkZHJlc3NlcyB0byB1c2UgZm9yIG1hcHBpbmcKPj4gLSAq
IEB2bTogcmVxdWVzdGVkIHZtCj4+IC0gKiBAbWFwcGluZzogbWFwcGVkIHJhbmdlIGFuZCBmbGFn
cyB0byB1c2UgZm9yIHRoZSB1cGRhdGUKPj4gLSAqIEBmbGFnczogSFcgZmxhZ3MgZm9yIHRoZSBt
YXBwaW5nCj4+IC0gKiBAYm9fYWRldjogYW1kZ3B1X2RldmljZSBwb2ludGVyIHRoYXQgYm8gYWN0
dWFsbHkgYmVlbiBhbGxvY2F0ZWQKPj4gLSAqIEBub2RlczogYXJyYXkgb2YgZHJtX21tX25vZGVz
IHdpdGggdGhlIE1DIGFkZHJlc3Nlcwo+PiAtICogQGZlbmNlOiBvcHRpb25hbCByZXN1bHRpbmcg
ZmVuY2UKPj4gLSAqCj4+IC0gKiBTcGxpdCB0aGUgbWFwcGluZyBpbnRvIHNtYWxsZXIgY2h1bmtz
IHNvIHRoYXQgZWFjaCB1cGRhdGUgZml0cwo+PiAtICogaW50byBhIFNETUEgSUIuCj4+IC0gKgo+
PiAtICogUmV0dXJuczoKPj4gLSAqIDAgZm9yIHN1Y2Nlc3MsIC1FSU5WQUwgZm9yIGZhaWx1cmUu
Cj4+IC0gKi8KPj4gLXN0YXRpYyBpbnQgYW1kZ3B1X3ZtX2JvX3NwbGl0X21hcHBpbmcoc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4+IC0JCQkJICAgICAgc3RydWN0IGRtYV9yZXN2ICpyZXN2
LAo+PiAtCQkJCSAgICAgIGRtYV9hZGRyX3QgKnBhZ2VzX2FkZHIsCj4+IC0JCQkJICAgICAgc3Ry
dWN0IGFtZGdwdV92bSAqdm0sCj4+IC0JCQkJICAgICAgc3RydWN0IGFtZGdwdV9ib192YV9tYXBw
aW5nICptYXBwaW5nLAo+PiAtCQkJCSAgICAgIHVpbnQ2NF90IGZsYWdzLAo+PiAtCQkJCSAgICAg
IHN0cnVjdCBhbWRncHVfZGV2aWNlICpib19hZGV2LAo+PiAtCQkJCSAgICAgIHN0cnVjdCBkcm1f
bW1fbm9kZSAqbm9kZXMsCj4+IC0JCQkJICAgICAgc3RydWN0IGRtYV9mZW5jZSAqKmZlbmNlKQo+
PiAtewo+PiAtCXVuc2lnbmVkIG1pbl9saW5lYXJfcGFnZXMgPSAxIDw8IGFkZXYtPnZtX21hbmFn
ZXIuZnJhZ21lbnRfc2l6ZTsKPj4gLQl1aW50NjRfdCBwZm4sIHN0YXJ0ID0gbWFwcGluZy0+c3Rh
cnQ7Cj4+IC0JaW50IHI7Cj4+IC0KPj4gLQkvKiBub3JtYWxseSxib192YS0+ZmxhZ3Mgb25seSBj
b250aWFucyBSRUFEQUJMRSBhbmQgV0lSVEVBQkxFIGJpdCBnbyBoZXJlCj4+IC0JICogYnV0IGlu
IGNhc2Ugb2Ygc29tZXRoaW5nLCB3ZSBmaWx0ZXIgdGhlIGZsYWdzIGluIGZpcnN0IHBsYWNlCj4+
IC0JICovCj4+IC0JaWYgKCEobWFwcGluZy0+ZmxhZ3MgJiBBTURHUFVfUFRFX1JFQURBQkxFKSkK
Pj4gLQkJZmxhZ3MgJj0gfkFNREdQVV9QVEVfUkVBREFCTEU7Cj4+IC0JaWYgKCEobWFwcGluZy0+
ZmxhZ3MgJiBBTURHUFVfUFRFX1dSSVRFQUJMRSkpCj4+IC0JCWZsYWdzICY9IH5BTURHUFVfUFRF
X1dSSVRFQUJMRTsKPj4gLQo+PiAtCS8qIEFwcGx5IEFTSUMgc3BlY2lmaWMgbWFwcGluZyBmbGFn
cyAqLwo+PiAtCWFtZGdwdV9nbWNfZ2V0X3ZtX3B0ZShhZGV2LCBtYXBwaW5nLCAmZmxhZ3MpOwo+
PiAtCj4+IC0JdHJhY2VfYW1kZ3B1X3ZtX2JvX3VwZGF0ZShtYXBwaW5nKTsKPj4gLQo+PiAtCXBm
biA9IG1hcHBpbmctPm9mZnNldCA+PiBQQUdFX1NISUZUOwo+PiAtCWlmIChub2Rlcykgewo+PiAt
CQl3aGlsZSAocGZuID49IG5vZGVzLT5zaXplKSB7Cj4+IC0JCQlwZm4gLT0gbm9kZXMtPnNpemU7
Cj4+IC0JCQkrK25vZGVzOwo+PiAtCQl9Cj4+IC0JfQo+PiAtCj4+ICsJYW1kZ3B1X3ZtX3B0X3N0
YXJ0KGFkZXYsIHZtLCBzdGFydCwgJmN1cnNvcik7Cj4+ICAgCWRvIHsKPj4gLQkJZG1hX2FkZHJf
dCAqZG1hX2FkZHIgPSBOVUxMOwo+PiAtCQl1aW50NjRfdCBtYXhfZW50cmllczsKPj4gLQkJdWlu
dDY0X3QgYWRkciwgbGFzdDsKPj4gKwkJdWludDY0X3QgdG1wLCBudW1fZW50cmllcywgYWRkcjsK
Pj4gICAKPj4gLQkJbWF4X2VudHJpZXMgPSBtYXBwaW5nLT5sYXN0IC0gc3RhcnQgKyAxOwo+PiAr
CQludW1fZW50cmllcyA9IGxhc3QgLSBzdGFydCArIDE7Cj4+ICAgCQlpZiAobm9kZXMpIHsKPj4g
ICAJCQlhZGRyID0gbm9kZXMtPnN0YXJ0IDw8IFBBR0VfU0hJRlQ7Cj4+IC0JCQltYXhfZW50cmll
cyA9IG1pbigobm9kZXMtPnNpemUgLSBwZm4pICoKPj4gLQkJCQlBTURHUFVfR1BVX1BBR0VTX0lO
X0NQVV9QQUdFLCBtYXhfZW50cmllcyk7Cj4+ICsJCQludW1fZW50cmllcyA9IG1pbigobm9kZXMt
PnNpemUgLSBwZm4pICoKPj4gKwkJCQlBTURHUFVfR1BVX1BBR0VTX0lOX0NQVV9QQUdFLCBudW1f
ZW50cmllcyk7Cj4+ICAgCQl9IGVsc2Ugewo+PiAgIAkJCWFkZHIgPSAwOwo+PiAgIAkJfQo+PiAg
IAo+PiAgIAkJaWYgKHBhZ2VzX2FkZHIpIHsKPj4gLQkJCXVpbnQ2NF90IGNvdW50Owo+PiArCQkJ
Ym9vbCBjb250aWd1b3VzID0gdHJ1ZTsKPj4gICAKPj4gLQkJCWZvciAoY291bnQgPSAxOwo+PiAt
CQkJICAgICBjb3VudCA8IG1heF9lbnRyaWVzIC8gQU1ER1BVX0dQVV9QQUdFU19JTl9DUFVfUEFH
RTsKPj4gLQkJCSAgICAgKytjb3VudCkgewo+PiAtCQkJCXVpbnQ2NF90IGlkeCA9IHBmbiArIGNv
dW50Owo+PiArCQkJaWYgKG51bV9lbnRyaWVzIDwgQU1ER1BVX0dQVV9QQUdFU19JTl9DUFVfUEFH
RSkgewo+PiArCQkJCXVpbnQ2NF90IGNvdW50Owo+PiAgIAo+PiAtCQkJCWlmIChwYWdlc19hZGRy
W2lkeF0gIT0KPj4gLQkJCQkgICAgKHBhZ2VzX2FkZHJbaWR4IC0gMV0gKyBQQUdFX1NJWkUpKQo+
PiAtCQkJCQlicmVhazsKPj4gKwkJCQljb250aWd1b3VzID0gcGFnZXNfYWRkcltwZm4gKyAxXSA9
PQo+PiArCQkJCQlwYWdlc19hZGRyW3Bmbl0gKyBQQUdFX1NJWkU7Cj4+ICsKPj4gKwkJCQl0bXAg
PSBudW1fZW50cmllcyAvCj4+ICsJCQkJCUFNREdQVV9HUFVfUEFHRVNfSU5fQ1BVX1BBR0U7Cj4+
ICsJCQkJZm9yIChjb3VudCA9IDI7IGNvdW50IDwgdG1wOyArK2NvdW50KSB7Cj4+ICsJCQkJCXVp
bnQ2NF90IGlkeCA9IHBmbiArIGNvdW50Owo+PiArCj4+ICsJCQkJCWlmIChjb250aWd1b3VzICE9
IChwYWdlc19hZGRyW2lkeF0gPT0KPj4gKwkJCQkJICAgIHBhZ2VzX2FkZHJbaWR4IC0gMV0gKyBQ
QUdFX1NJWkUpKQo+PiArCQkJCQkJYnJlYWs7Cj4+ICsJCQkJfQo+PiArCQkJCW51bV9lbnRyaWVz
ID0gY291bnQgKgo+PiArCQkJCQlBTURHUFVfR1BVX1BBR0VTX0lOX0NQVV9QQUdFOwo+PiAgIAkJ
CX0KPj4gICAKPj4gLQkJCWlmIChjb3VudCA8IG1pbl9saW5lYXJfcGFnZXMpIHsKPj4gKwkJCWlm
ICghY29udGlndW91cykgewo+PiAgIAkJCQlhZGRyID0gcGZuIDw8IFBBR0VfU0hJRlQ7Cj4+IC0J
CQkJZG1hX2FkZHIgPSBwYWdlc19hZGRyOwo+PiArCQkJCXBhcmFtcy5wYWdlc19hZGRyID0gcGFn
ZXNfYWRkcjsKPj4gICAJCQl9IGVsc2Ugewo+PiAgIAkJCQlhZGRyID0gcGFnZXNfYWRkcltwZm5d
Owo+PiAtCQkJCW1heF9lbnRyaWVzID0gY291bnQgKgo+PiAtCQkJCQlBTURHUFVfR1BVX1BBR0VT
X0lOX0NQVV9QQUdFOwo+PiArCQkJCXBhcmFtcy5wYWdlc19hZGRyID0gTlVMTDsKPj4gICAJCQl9
Cj4+ICAgCj4+ICAgCQl9IGVsc2UgaWYgKGZsYWdzICYgKEFNREdQVV9QVEVfVkFMSUQgfCBBTURH
UFVfUFRFX1BSVCkpIHsKPj4gQEAgLTE3MzgsMjMgKzE2OTEsMjYgQEAgc3RhdGljIGludCBhbWRn
cHVfdm1fYm9fc3BsaXRfbWFwcGluZyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKPj4gICAJ
CQlhZGRyICs9IHBmbiA8PCBQQUdFX1NISUZUOwo+PiAgIAkJfQo+PiAgIAo+PiAtCQlsYXN0ID0g
c3RhcnQgKyBtYXhfZW50cmllcyAtIDE7Cj4+IC0JCXIgPSBhbWRncHVfdm1fYm9fdXBkYXRlX21h
cHBpbmcoYWRldiwgdm0sIGZhbHNlLCBmYWxzZSwgcmVzdiwKPj4gLQkJCQkJCXN0YXJ0LCBsYXN0
LCBmbGFncywgYWRkciwKPj4gLQkJCQkJCWRtYV9hZGRyLCBmZW5jZSk7Cj4+ICsJCXRtcCA9IHN0
YXJ0ICsgbnVtX2VudHJpZXM7Cj4+ICsJCXIgPSBhbWRncHVfdm1fdXBkYXRlX3B0ZXMoJnBhcmFt
cywgJmN1cnNvciwgc3RhcnQsIHRtcCwgYWRkciwKPj4gKwkJCQkJICBmbGFncyk7Cj4+ICAgCQlp
ZiAocikKPj4gLQkJCXJldHVybiByOwo+PiArCQkJZ290byBlcnJvcl91bmxvY2s7Cj4+ICAgCj4+
IC0JCXBmbiArPSAobGFzdCAtIHN0YXJ0ICsgMSkgLyBBTURHUFVfR1BVX1BBR0VTX0lOX0NQVV9Q
QUdFOwo+PiArCQlwZm4gKz0gbnVtX2VudHJpZXMgLyBBTURHUFVfR1BVX1BBR0VTX0lOX0NQVV9Q
QUdFOwo+PiAgIAkJaWYgKG5vZGVzICYmIG5vZGVzLT5zaXplID09IHBmbikgewo+PiAgIAkJCXBm
biA9IDA7Cj4+ICAgCQkJKytub2RlczsKPj4gICAJCX0KPj4gLQkJc3RhcnQgPSBsYXN0ICsgMTsK
Pj4gKwkJc3RhcnQgPSB0bXA7Cj4+ICAgCj4+IC0JfSB3aGlsZSAodW5saWtlbHkoc3RhcnQgIT0g
bWFwcGluZy0+bGFzdCArIDEpKTsKPj4gKwl9IHdoaWxlICh1bmxpa2VseShzdGFydCAhPSBsYXN0
ICsgMSkpOwo+PiAgIAo+PiAtCXJldHVybiAwOwo+PiArCXIgPSB2bS0+dXBkYXRlX2Z1bmNzLT5j
b21taXQoJnBhcmFtcywgZmVuY2UpOwo+PiArCj4+ICtlcnJvcl91bmxvY2s6Cj4+ICsJYW1kZ3B1
X3ZtX2V2aWN0aW9uX3VubG9jayh2bSk7Cj4+ICsJcmV0dXJuIHI7Cj4+ICAgfQo+PiAgIAo+PiAg
IC8qKgo+PiBAQCAtMTgzNSw5ICsxNzkxLDI2IEBAIGludCBhbWRncHVfdm1fYm9fdXBkYXRlKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgYW1kZ3B1X2JvX3ZhICpib192YSwKPj4g
ICAJfQo+PiAgIAo+PiAgIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KG1hcHBpbmcsICZib192YS0+aW52
YWxpZHMsIGxpc3QpIHsKPj4gLQkJciA9IGFtZGdwdV92bV9ib19zcGxpdF9tYXBwaW5nKGFkZXYs
IHJlc3YsIHBhZ2VzX2FkZHIsIHZtLAo+PiAtCQkJCQkgICAgICAgbWFwcGluZywgZmxhZ3MsIGJv
X2FkZXYsIG5vZGVzLAo+PiAtCQkJCQkgICAgICAgbGFzdF91cGRhdGUpOwo+PiArCQl1aW50NjRf
dCB1cGRhdGVfZmxhZ3MgPSBmbGFnczsKPj4gKwo+PiArCQkvKiBub3JtYWxseSxib192YS0+Zmxh
Z3Mgb25seSBjb250aWFucyBSRUFEQUJMRSBhbmQgV0lSVEVBQkxFIGJpdCBnbyBoZXJlCj4+ICsJ
CSAqIGJ1dCBpbiBjYXNlIG9mIHNvbWV0aGluZywgd2UgZmlsdGVyIHRoZSBmbGFncyBpbiBmaXJz
dCBwbGFjZQo+PiArCQkgKi8KPj4gKwkJaWYgKCEobWFwcGluZy0+ZmxhZ3MgJiBBTURHUFVfUFRF
X1JFQURBQkxFKSkKPj4gKwkJCXVwZGF0ZV9mbGFncyAmPSB+QU1ER1BVX1BURV9SRUFEQUJMRTsK
Pj4gKwkJaWYgKCEobWFwcGluZy0+ZmxhZ3MgJiBBTURHUFVfUFRFX1dSSVRFQUJMRSkpCj4+ICsJ
CQl1cGRhdGVfZmxhZ3MgJj0gfkFNREdQVV9QVEVfV1JJVEVBQkxFOwo+PiArCj4+ICsJCS8qIEFw
cGx5IEFTSUMgc3BlY2lmaWMgbWFwcGluZyBmbGFncyAqLwo+PiArCQlhbWRncHVfZ21jX2dldF92
bV9wdGUoYWRldiwgbWFwcGluZywgJnVwZGF0ZV9mbGFncyk7Cj4+ICsKPj4gKwkJdHJhY2VfYW1k
Z3B1X3ZtX2JvX3VwZGF0ZShtYXBwaW5nKTsKPj4gKwo+PiArCQlyID0gYW1kZ3B1X3ZtX2JvX3Vw
ZGF0ZV9tYXBwaW5nKGFkZXYsIGJvX2FkZXYsIHZtLCBmYWxzZSwgZmFsc2UsCj4+ICsJCQkJCQly
ZXN2LCBtYXBwaW5nLT5zdGFydCwKPj4gKwkJCQkJCW1hcHBpbmctPmxhc3QsIHVwZGF0ZV9mbGFn
cywKPj4gKwkJCQkJCW1hcHBpbmctPm9mZnNldCwgbm9kZXMsCj4+ICsJCQkJCQlwYWdlc19hZGRy
LCBsYXN0X3VwZGF0ZSk7Cj4+ICAgCQlpZiAocikKPj4gICAJCQlyZXR1cm4gcjsKPj4gICAJfQo+
PiBAQCAtMjA0NSw5ICsyMDE4LDEwIEBAIGludCBhbWRncHVfdm1fY2xlYXJfZnJlZWQoc3RydWN0
IGFtZGdwdV9kZXZpY2UgKmFkZXYsCj4+ICAgCQkgICAgbWFwcGluZy0+c3RhcnQgPCBBTURHUFVf
R01DX0hPTEVfU1RBUlQpCj4+ICAgCQkJaW5pdF9wdGVfdmFsdWUgPSBBTURHUFVfUFRFX0RFRkFV
TFRfQVRDOwo+PiAgIAo+PiAtCQlyID0gYW1kZ3B1X3ZtX2JvX3VwZGF0ZV9tYXBwaW5nKGFkZXYs
IHZtLCBmYWxzZSwgZmFsc2UsIHJlc3YsCj4+IC0JCQkJCQltYXBwaW5nLT5zdGFydCwgbWFwcGlu
Zy0+bGFzdCwKPj4gLQkJCQkJCWluaXRfcHRlX3ZhbHVlLCAwLCBOVUxMLCAmZik7Cj4+ICsJCXIg
PSBhbWRncHVfdm1fYm9fdXBkYXRlX21hcHBpbmcoYWRldiwgYWRldiwgdm0sIGZhbHNlLCBmYWxz
ZSwKPj4gKwkJCQkJCXJlc3YsIG1hcHBpbmctPnN0YXJ0LAo+PiArCQkJCQkJbWFwcGluZy0+bGFz
dCwgaW5pdF9wdGVfdmFsdWUsCj4+ICsJCQkJCQkwLCBOVUxMLCBOVUxMLCAmZik7Cj4+ICAgCQlh
bWRncHVfdm1fZnJlZV9tYXBwaW5nKGFkZXYsIHZtLCBtYXBwaW5nLCBmKTsKPj4gICAJCWlmIChy
KSB7Cj4+ICAgCQkJZG1hX2ZlbmNlX3B1dChmKTsKPj4gQEAgLTMzNzUsOCArMzM0OSw5IEBAIGJv
b2wgYW1kZ3B1X3ZtX2hhbmRsZV9mYXVsdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgdW5z
aWduZWQgaW50IHBhc2lkLAo+PiAgIAkJdmFsdWUgPSAwOwo+PiAgIAl9Cj4+ICAgCj4+IC0JciA9
IGFtZGdwdV92bV9ib191cGRhdGVfbWFwcGluZyhhZGV2LCB2bSwgdHJ1ZSwgZmFsc2UsIE5VTEws
IGFkZHIsCj4+IC0JCQkJCWFkZHIgKyAxLCBmbGFncywgdmFsdWUsIE5VTEwsIE5VTEwpOwo+PiAr
CXIgPSBhbWRncHVfdm1fYm9fdXBkYXRlX21hcHBpbmcoYWRldiwgYWRldiwgdm0sIHRydWUsIGZh
bHNlLCBOVUxMLCBhZGRyLAo+PiArCQkJCQlhZGRyICsgMSwgZmxhZ3MsIHZhbHVlLCBOVUxMLCBO
VUxMLAo+PiArCQkJCQlOVUxMKTsKPj4gICAJaWYgKHIpCj4+ICAgCQlnb3RvIGVycm9yX3VubG9j
azsKPj4gICAKPj4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeAo=
