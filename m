Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1B34269DEF
	for <lists+amd-gfx@lfdr.de>; Mon, 15 Jul 2019 23:22:20 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9E66989DA5;
	Mon, 15 Jul 2019 21:22:18 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM03-BY2-obe.outbound.protection.outlook.com
 (mail-eopbgr780042.outbound.protection.outlook.com [40.107.78.42])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6D80889D64
 for <amd-gfx@lists.freedesktop.org>; Mon, 15 Jul 2019 21:22:09 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=oVbQp/vGs0VSKGHweyqAk6Lp9jWekUjYJVRqs8QTDFKOAC5+hF90Aq4ky4U5CYWeBAkEq/GhDE4pR4POHGvBiPwL9vdV9hFLeU8GLSLTBM0/YT+egbLRUSFE+KiXKdp4X3bJoSOPwbO0fNX6DkrFhWNIC2wPDboybh9CRiEjPkJpHvAs2BmpgUmJ5P8XEhBrGu2z6/1iCpRNWfet1UDDpVvpFSKZMjZimVxVOZ1xBPyAcluDapMIRzsnOPq8Tit3DbOo55ytsqURNF+gEDf6/dX9S1dyG6VsbVubkHhAqTP3SrVaJTu6eb4vPw4bYTXPmQh1ekof32o4Qs5J6hp/dQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=E/NFwVhde5G308EdIagXVniVc5V9UCEvLR0MMvkjKA0=;
 b=Q8JneOu9/bxCUVSX2nEHGjKrwNKzg3WaYmD//SfpyjJpfB/KUonkTokABfpx2LiBJyknpph+EUAQaFxqC/E6MLl00fRmPgYaKKLJ25Sx6R8QKsXbBWe2z4mEhGxdrxs5cVRBzw9p8qs7LPV/J06+2Oxmf72QE22nMeK1GRDPTrW7+9XvmDbJL9M7EkvI4UoidzI+myRw6J/125s5Cktf/D3qu8NL8ZLe9rpYWEtvlrOZgFar7iepVLFGl67p7D5LFXwijEeQRh4KMQCnOXYLoRZSeW+Z9IibV95knxjcF0Aomu9QhRrfsghTU49OUetRgblqOwTsZLLz/MWG7AG2KA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1;spf=none (sender ip is
 165.204.84.17) smtp.rcpttodomain=lists.freedesktop.org
 smtp.mailfrom=amd.com;dmarc=permerror action=none
 header.from=amd.com;dkim=none (message not signed);arc=none
Received: from DM3PR12CA0103.namprd12.prod.outlook.com (2603:10b6:0:55::23) by
 BY5PR12MB3921.namprd12.prod.outlook.com (2603:10b6:a03:1a2::17) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2073.14; Mon, 15 Jul
 2019 21:22:04 +0000
Received: from CO1NAM03FT048.eop-NAM03.prod.protection.outlook.com
 (2a01:111:f400:7e48::202) by DM3PR12CA0103.outlook.office365.com
 (2603:10b6:0:55::23) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id 15.20.2073.10 via Frontend
 Transport; Mon, 15 Jul 2019 21:22:03 +0000
Received-SPF: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
Received: from SATLEXCHOV01.amd.com (165.204.84.17) by
 CO1NAM03FT048.mail.protection.outlook.com (10.152.81.49) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384) id
 15.20.2052.18 via Frontend Transport; Mon, 15 Jul 2019 21:22:03 +0000
Received: from localhost.localdomain (10.180.168.240) by SATLEXCHOV01.amd.com
 (10.181.40.71) with Microsoft SMTP Server id 14.3.389.1;
 Mon, 15 Jul 2019 16:21:41 -0500
From: <sunpeng.li@amd.com>
To: <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 81/87] drm/amd/display: support "dummy pstate"
Date: Mon, 15 Jul 2019 17:20:43 -0400
Message-ID: <20190715212049.4584-82-sunpeng.li@amd.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190715212049.4584-1-sunpeng.li@amd.com>
References: <20190715212049.4584-1-sunpeng.li@amd.com>
MIME-Version: 1.0
X-EOPAttributedMessage: 0
X-MS-Office365-Filtering-HT: Tenant
X-Forefront-Antispam-Report: CIP:165.204.84.17; IPV:NLI; CTRY:US; EFV:NLI;
 SFV:NSPM;
 SFS:(10009020)(4636009)(136003)(346002)(39860400002)(396003)(376002)(2980300002)(428003)(199004)(189003)(2906002)(48376002)(5660300002)(6916009)(126002)(53936002)(49486002)(53946003)(446003)(30864003)(81166006)(50226002)(50466002)(70206006)(81156014)(4326008)(70586007)(11346002)(476003)(2616005)(2870700001)(426003)(47776003)(19627235002)(26005)(8936002)(8676002)(316002)(356004)(186003)(14444005)(51416003)(2351001)(336012)(86362001)(45954011)(305945005)(54906003)(1076003)(486006)(2876002)(76176011)(36756003)(478600001)(68736007)(579004)(559001)(569006);
 DIR:OUT; SFP:1101; SCL:1; SRVR:BY5PR12MB3921; H:SATLEXCHOV01.amd.com; FPR:;
 SPF:None; LANG:en; PTR:InfoDomainNonexistent; A:1; MX:1; 
X-MS-PublicTrafficType: Email
X-MS-Office365-Filtering-Correlation-Id: e9441cc3-2453-4c6f-0918-08d7096a7b28
X-Microsoft-Antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328);
 SRVR:BY5PR12MB3921; 
X-MS-TrafficTypeDiagnostic: BY5PR12MB3921:
X-Microsoft-Antispam-PRVS: <BY5PR12MB392108A4A84450486369677882CF0@BY5PR12MB3921.namprd12.prod.outlook.com>
X-MS-Oob-TLC-OOBClassifiers: OLM:7219;
X-Forefront-PRVS: 00997889E7
X-MS-Exchange-SenderADCheck: 1
X-Microsoft-Antispam-Message-Info: Eibd/HrO41zJcvddNTl72PnLKk5VT7hqg5T2YOcfMGzfFwS1q8DyKNNDKBNhJwxfbKQZfhlHaaityhk7YEL0cC7AkRQmJRPky63D7XzyuW/oaTSJoy5vTBUgtE7lMrsZydjhzH/H+4DRGNWk37hq9jz6LYhsHZ+jKeHI8xl8XMVtbiCvMxLVMebJW2fS49feEt8DzDit+MuXcZm67prUk48w/d4mQP6tUhdffCW8B41TmjFdbZHX3M7TgT52j5TSS3AA4/hNZGb8/sI9MOK+7TmNrn0A8Ar+cUxkslCGKdsFBlD5197dWhepv/IN8QPnBaQBob3p5jZawvSCFaJ9tpA3klapeniakofS4WeR5YmXMd+i3XfhwT2EnRl2uo9eYIKQGnCxHXdrEk8iIftalGHHfHeMnbOZ3BWi11i8yfA=
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 15 Jul 2019 21:22:03.1567 (UTC)
X-MS-Exchange-CrossTenant-Network-Message-Id: e9441cc3-2453-4c6f-0918-08d7096a7b28
X-MS-Exchange-CrossTenant-Id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=3dd8961f-e488-4e60-8e11-a82d994e183d; Ip=[165.204.84.17];
 Helo=[SATLEXCHOV01.amd.com]
X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BY5PR12MB3921
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=E/NFwVhde5G308EdIagXVniVc5V9UCEvLR0MMvkjKA0=;
 b=aUczXNJqz/09FyVrqQ+Wv+BmXzSmz4QftoML/PCBg/eaRjrPF42JdXmtQ9qeNlRXT3S1KjelSExOY/UE0kkkTGphKru7u7gziuYNyjsFVGob9gMgrISPanlM5ITzVkdm4obxWU3Wr4wRvDXCo6z657r+nAaPvuPkkJwtSzEo738=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is
 165.204.84.17)
 smtp.mailfrom=amd.com; lists.freedesktop.org; dkim=none (message not signed)
 header.d=none;lists.freedesktop.org; dmarc=permerror action=none
 header.from=amd.com;
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Dmytro Laktyushkin <Dmytro.Laktyushkin@amd.com>,
 Leo Li <sunpeng.li@amd.com>, Jun Lei <Jun.Lei@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogSnVuIExlaSA8SnVuLkxlaUBhbWQuY29tPgoKW3doeV0KRXhpc3Rpbmcgc3VwcG9ydCBp
biBEQyBmb3IgcHN0YXRlIG9ubHkgYWNjb3VudHMgZm9yIGEgc2luZ2xlIGxhdGVuY3kuICBUaGlz
IGlzIHN1ZmZpY2llbnQgd2hlbiB0aGUKdmFyaWFuY2Ugb2YgbGF0ZW5jeSBpcyBzbWFsbCwgb3Ig
dGhhdCBwc3RhdGUgc3VwcG9ydCBpc24ndCBuZWNlc3NhcnkgZm9yIGNvcnJlY3QgQVNJQyBmdW5j
dGlvbmFsaXR5LgoKTmV3ZXIgQVNJQ3MgdmlvbGF0ZSBib3RoIGV4aXN0aW5nIGFzc3VtcHRpb25z
LiAgUFN0YXRlIHN1cHBvcnQgaXMgbWFuZGF0b3J5IG9mIGNvcnJlY3QgQVNJQwpmdW5jdGlvbmFs
aXR5LCBidXQgbm90IGFsbCBsYXRlbmNpZXMgaGF2ZSB0byBiZSBzdXBwb3J0ZWQuICBFeGlzdGlu
ZyBjb2RlIHN1cHBvcnRzIGEgImZ1bGwgcCBzdGF0ZSIgd2hpY2gKYWxsb3dzIG1lbW9yeSBjbG9j
ayB0byBjaGFuZ2UsIGJ1dCBpcyBoYXJkIGZvciBEQ04gdG8gc3VwcG9ydCAoYXMgaXQgcmVxdWly
ZXMgdmVyeSBsYXJnZSBidWZmZXJzKS4KTmV3IGNvZGUgd2lsbCBub3cgZmFsbCBiYWNrIHRvIGEg
ImR1bW15IHAgc3RhdGUiIHN1cHBvcnQgd2hlbiAiZnVsbCBwIHN0YXRlIiBjYW5ub3QgYmUgc3Vw
cG9ydC4KVGhpcyBlYXN5IHAgc3RhdGUgc3VwcG9ydCBzaG91bGQgYWx3YXlzIGJlIGFsbG93ZWQu
CgpbaG93XQpEZWZpbmUgYSBuZXcgbGF0ZW5jeSBpbiBzb2NCQi4gIEFkZCBmYWxsYmFjayBsb2dp
YyB0byBzdXBwb3J0IGl0LiAgTm90ZSBETUwgaXMgYWxzbyB1cGRhdGVkIHRvIGVuc3VyZQp0aGF0
IGZhbGxiYWNrIHdpbGwgYWx3YXlzIHdvcmsuCgpDaGFuZ2UtSWQ6IEkwNjhlMzRjYWU4ZmEyZjdj
ZDMxYjUzMGE2ODgyMmM0Nzk1MjUwNDhjClNpZ25lZC1vZmYtYnk6IEp1biBMZWkgPEp1bi5MZWlA
YW1kLmNvbT4KUmV2aWV3ZWQtYnk6IERteXRybyBMYWt0eXVzaGtpbiA8RG15dHJvLkxha3R5dXNo
a2luQGFtZC5jb20+CkFja2VkLWJ5OiBMZW8gTGkgPHN1bnBlbmcubGlAYW1kLmNvbT4KLS0tCiAu
Li4vZGlzcGxheS9kYy9jbGtfbWdyL2RjbjIwL2RjbjIwX2Nsa19tZ3IuYyAgfCAgICAyICsKIGRy
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kYy5oICAgICAgICAgICB8ICAgIDcgKwogLi4u
L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9odWJidWIuYyAgIHwgICAxMSArCiAuLi4v
ZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h3c2VxLmMgICAgfCAgIDEwICstCiAuLi4v
ZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX3Jlc291cmNlLmMgfCAgIDU5ICstCiBkcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL01ha2VmaWxlICAgfCAgICAzICsKIC4uLi9k
Yy9kbWwvZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMHYyLmMgICAgICB8IDUxMDkgKysrKysrKysr
KysrKysrKysKIC4uLi9kYy9kbWwvZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMHYyLmggICAgICB8
ICAgMzIgKwogLi4uL2RjL2RtbC9kY24yMC9kaXNwbGF5X3JxX2RsZ19jYWxjXzIwdjIuYyAgIHwg
MTcwMSArKysrKysKIC4uLi9kYy9kbWwvZGNuMjAvZGlzcGxheV9ycV9kbGdfY2FsY18yMHYyLmgg
ICB8ICAgNzQgKwogLi4uL2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5j
IHwgICAxMiArCiAuLi4vZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kaXNwbGF5X21vZGVfbGliLmgg
fCAgICAxICsKIC4uLi9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX3N0cnVjdHMuaCB8
ICAgIDEgKwogLi4uL2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX3ZiYS5jIHwg
ICAgOCArLQogMTQgZmlsZXMgY2hhbmdlZCwgNzAyMiBpbnNlcnRpb25zKCspLCA4IGRlbGV0aW9u
cygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
bWwvZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMHYyLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2RjbjIwL2Rpc3BsYXlfbW9kZV92YmFfMjB2
Mi5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2Rt
bC9kY24yMC9kaXNwbGF5X3JxX2RsZ19jYWxjXzIwdjIuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRy
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGNuMjAvZGlzcGxheV9ycV9kbGdfY2Fs
Y18yMHYyLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvY2xr
X21nci9kY24yMC9kY24yMF9jbGtfbWdyLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvY2xrX21nci9kY24yMC9kY24yMF9jbGtfbWdyLmMKaW5kZXggM2NmZjRmMDUxOGQzLi43ZmYw
Mzk2OTU2YjMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9jbGtf
bWdyL2RjbjIwL2RjbjIwX2Nsa19tZ3IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvY2xrX21nci9kY24yMC9kY24yMF9jbGtfbWdyLmMKQEAgLTIwMSw2ICsyMDEsNyBAQCB2
b2lkIGRjbjJfdXBkYXRlX2Nsb2NrcyhzdHJ1Y3QgY2xrX21nciAqY2xrX21ncl9iYXNlLAogCX0K
IAogCWlmIChzaG91bGRfdXBkYXRlX3BzdGF0ZV9zdXBwb3J0KHNhZmVfdG9fbG93ZXIsIG5ld19j
bG9ja3MtPnBfc3RhdGVfY2hhbmdlX3N1cHBvcnQsIGNsa19tZ3JfYmFzZS0+Y2xrcy5wX3N0YXRl
X2NoYW5nZV9zdXBwb3J0KSkgeworCQljbGtfbWdyX2Jhc2UtPmNsa3MucHJldl9wX3N0YXRlX2No
YW5nZV9zdXBwb3J0ID0gY2xrX21ncl9iYXNlLT5jbGtzLnBfc3RhdGVfY2hhbmdlX3N1cHBvcnQ7
CiAJCWNsa19tZ3JfYmFzZS0+Y2xrcy5wX3N0YXRlX2NoYW5nZV9zdXBwb3J0ID0gbmV3X2Nsb2Nr
cy0+cF9zdGF0ZV9jaGFuZ2Vfc3VwcG9ydDsKIAkJaWYgKHBwX3NtdSAmJiBwcF9zbXUtPnNldF9w
c3RhdGVfaGFuZHNoYWtlX3N1cHBvcnQpCiAJCQlwcF9zbXUtPnNldF9wc3RhdGVfaGFuZHNoYWtl
X3N1cHBvcnQoJnBwX3NtdS0+cHBfc211LCBjbGtfbWdyX2Jhc2UtPmNsa3MucF9zdGF0ZV9jaGFu
Z2Vfc3VwcG9ydCk7CkBAIC0zMDgsNiArMzA5LDcgQEAgdm9pZCBkY24yX2luaXRfY2xvY2tzKHN0
cnVjdCBjbGtfbWdyICpjbGtfbWdyKQogCW1lbXNldCgmKGNsa19tZ3ItPmNsa3MpLCAwLCBzaXpl
b2Yoc3RydWN0IGRjX2Nsb2NrcykpOwogCS8vIEFzc3VtcHRpb24gaXMgdGhhdCBib290IHN0YXRl
IGFsd2F5cyBzdXBwb3J0cyBwc3RhdGUKIAljbGtfbWdyLT5jbGtzLnBfc3RhdGVfY2hhbmdlX3N1
cHBvcnQgPSB0cnVlOworCWNsa19tZ3ItPmNsa3MucHJldl9wX3N0YXRlX2NoYW5nZV9zdXBwb3J0
ID0gdHJ1ZTsKIH0KIAogdm9pZCBkY24yX2VuYWJsZV9wbWVfd2Eoc3RydWN0IGNsa19tZ3IgKmNs
a19tZ3JfYmFzZSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
Yy5oIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjLmgKaW5kZXggYjEyZWVlOTNj
MjUzLi42ZGEwYTZmZTI5NzMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9kYy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kYy5oCkBAIC0x
MjEsNiArMTIxLDcgQEAgc3RydWN0IGRjX2NhcHMgewogc3RydWN0IGRjX2J1Z193YSB7CiAJYm9v
bCBub19jb25uZWN0X3BoeV9jb25maWc7CiAJYm9vbCBkZWRjbjIwXzMwNV93YTsKKwlzdHJ1Y3Qg
ZGlzcGxheV9tb2RlX2xpYiBhbHRlcm5hdGVfZG1sOwogfTsKICNlbmRpZgogCkBAIC0yNjMsNiAr
MjY0LDEyIEBAIHN0cnVjdCBkY19jbG9ja3MgewogCWludCBwaHljbGtfa2h6OwogCWludCBkcmFt
Y2xrX2toejsKIAlib29sIHBfc3RhdGVfY2hhbmdlX3N1cHBvcnQ7CisKKwkvKgorCSAqIEVsZW1l
bnRzIGJlbG93IGFyZSBub3QgY29tcGFyZWQgZm9yIHRoZSBwdXJwb3NlcyBvZgorCSAqIG9wdGlt
aXphdGlvbiByZXF1aXJlZAorCSAqLworCWJvb2wgcHJldl9wX3N0YXRlX2NoYW5nZV9zdXBwb3J0
OwogfTsKIAogc3RydWN0IGRjX2J3X3ZhbGlkYXRpb25fcHJvZmlsZSB7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHViYnViLmMgYi9kcml2
ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHViYnViLmMKaW5kZXggNmUy
ZGJkMDNmOWJmLi4zMWQ2ZTc5YmEyYjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kY24yMC9kY24yMF9odWJidWIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHViYnViLmMKQEAgLTI2LDYgKzI2LDcgQEAKIAogI2lu
Y2x1ZGUgImRjbjIwX2h1YmJ1Yi5oIgogI2luY2x1ZGUgInJlZ19oZWxwZXIuaCIKKyNpbmNsdWRl
ICJjbGtfbWdyLmgiCiAKICNkZWZpbmUgUkVHKHJlZylcCiAJaHViYnViMS0+cmVncy0+cmVnCkBA
IC01NTMsNiArNTU0LDE2IEBAIHN0YXRpYyB2b2lkIGh1YmJ1YjJfcHJvZ3JhbV93YXRlcm1hcmtz
KAogCSAqLwogCWh1YmJ1YjFfcHJvZ3JhbV91cmdlbnRfd2F0ZXJtYXJrcyhodWJidWIsIHdhdGVy
bWFya3MsIHJlZmNsa19taHosIHNhZmVfdG9fbG93ZXIpOwogCWh1YmJ1YjFfcHJvZ3JhbV9zdHV0
dGVyX3dhdGVybWFya3MoaHViYnViLCB3YXRlcm1hcmtzLCByZWZjbGtfbWh6LCBzYWZlX3RvX2xv
d2VyKTsKKworCS8qCisJICogVGhlcmUncyBhIHNwZWNpYWwgY2FzZSB3aGVuIGdvaW5nIGZyb20g
cC1zdGF0ZSBzdXBwb3J0IHRvIHAtc3RhdGUgdW5zdXBwb3J0ZWQKKwkgKiBoZXJlIHdlIGFyZSBn
b2luZyB0byBMT1dFUiB3YXRlcm1hcmtzIHRvIGdvIHRvIGR1bW15IHAtc3RhdGUgb25seSwgYnV0
IHRoaXMgaGFzCisJICogdG8gYmUgZG9uZSBwcmVwYXJlX2JhbmR3aWR0aCwgbm90IG9wdGltaXpl
CisJICovCisJaWYgKGh1YmJ1YjEtPmJhc2UuY3R4LT5kYy0+Y2xrX21nci0+Y2xrcy5wcmV2X3Bf
c3RhdGVfY2hhbmdlX3N1cHBvcnQgPT0gdHJ1ZSAmJgorCQlodWJidWIxLT5iYXNlLmN0eC0+ZGMt
PmNsa19tZ3ItPmNsa3MucF9zdGF0ZV9jaGFuZ2Vfc3VwcG9ydCA9PSBmYWxzZSkKKwkJc2FmZV90
b19sb3dlciA9IHRydWU7CisKIAlodWJidWIxX3Byb2dyYW1fcHN0YXRlX3dhdGVybWFya3MoaHVi
YnViLCB3YXRlcm1hcmtzLCByZWZjbGtfbWh6LCBzYWZlX3RvX2xvd2VyKTsKIAogCVJFR19TRVQo
RENIVUJCVUJfQVJCX1NBVF9MRVZFTCwgMCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9od3NlcS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h3c2VxLmMKaW5kZXggNzZjZTYyMmUxNDIxLi5iNjE3NzRk
MmU4YjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9k
Y24yMF9od3NlcS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9k
Y24yMF9od3NlcS5jCkBAIC0xNDQzLDE2ICsxNDQzLDE2IEBAIHZvaWQgZGNuMjBfcHJlcGFyZV9i
YW5kd2lkdGgoCiB7CiAJc3RydWN0IGh1YmJ1YiAqaHViYnViID0gZGMtPnJlc19wb29sLT5odWJi
dWI7CiAKKwlkYy0+Y2xrX21nci0+ZnVuY3MtPnVwZGF0ZV9jbG9ja3MoCisJCQlkYy0+Y2xrX21n
ciwKKwkJCWNvbnRleHQsCisJCQlmYWxzZSk7CisKIAkvKiBwcm9ncmFtIGRjaHViYnViIHdhdGVy
bWFya3MgKi8KIAlodWJidWItPmZ1bmNzLT5wcm9ncmFtX3dhdGVybWFya3MoaHViYnViLAogCQkJ
CQkmY29udGV4dC0+YndfY3R4LmJ3LmRjbi53YXRlcm1hcmtzLAogCQkJCQlkYy0+cmVzX3Bvb2wt
PnJlZl9jbG9ja3MuZGNodWJfcmVmX2Nsb2NrX2luS2h6IC8gMTAwMCwKIAkJCQkJZmFsc2UpOwot
Ci0JZGMtPmNsa19tZ3ItPmZ1bmNzLT51cGRhdGVfY2xvY2tzKAotCQkJZGMtPmNsa19tZ3IsCi0J
CQljb250ZXh0LAotCQkJZmFsc2UpOwogfQogCiB2b2lkIGRjbjIwX29wdGltaXplX2JhbmR3aWR0
aCgKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24y
MF9yZXNvdXJjZS5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIw
X3Jlc291cmNlLmMKaW5kZXggMTkzMjcwYmE2MGU2Li4yY2Y3ODhhMzcwNGUgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9yZXNvdXJjZS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9yZXNvdXJjZS5j
CkBAIC0yNDI1LDcgKzI0MjUsNyBAQCB2b2lkIGRjbjIwX2NhbGN1bGF0ZV9kbGdfcGFyYW1zKAog
CX0KIH0KIAotYm9vbCBkY24yMF92YWxpZGF0ZV9iYW5kd2lkdGgoc3RydWN0IGRjICpkYywgc3Ry
dWN0IGRjX3N0YXRlICpjb250ZXh0LAorc3RhdGljIGJvb2wgZGNuMjBfdmFsaWRhdGVfYmFuZHdp
ZHRoX2ludGVybmFsKHN0cnVjdCBkYyAqZGMsIHN0cnVjdCBkY19zdGF0ZSAqY29udGV4dCwKIAkJ
Ym9vbCBmYXN0X3ZhbGlkYXRlKQogewogCWJvb2wgb3V0ID0gZmFsc2U7CkBAIC0yNDc3LDYgKzI0
NzcsNjIgQEAgYm9vbCBkY24yMF92YWxpZGF0ZV9iYW5kd2lkdGgoc3RydWN0IGRjICpkYywgc3Ry
dWN0IGRjX3N0YXRlICpjb250ZXh0LAogCXJldHVybiBvdXQ7CiB9CiAKKworYm9vbCBkY24yMF92
YWxpZGF0ZV9iYW5kd2lkdGgoc3RydWN0IGRjICpkYywgc3RydWN0IGRjX3N0YXRlICpjb250ZXh0
LAorCQlib29sIGZhc3RfdmFsaWRhdGUpCit7CisJYm9vbCB2b2x0YWdlX3N1cHBvcnRlZCA9IGZh
bHNlOworCWJvb2wgZnVsbF9wc3RhdGVfc3VwcG9ydGVkID0gZmFsc2U7CisJYm9vbCBkdW1teV9w
c3RhdGVfc3VwcG9ydGVkID0gZmFsc2U7CisJZG91YmxlIHBfc3RhdGVfbGF0ZW5jeV91cyA9IGNv
bnRleHQtPmJ3X2N0eC5kbWwuc29jLmRyYW1fY2xvY2tfY2hhbmdlX2xhdGVuY3lfdXM7CisKKwlp
ZiAoZmFzdF92YWxpZGF0ZSkKKwkJcmV0dXJuIGRjbjIwX3ZhbGlkYXRlX2JhbmR3aWR0aF9pbnRl
cm5hbChkYywgY29udGV4dCwgdHJ1ZSk7CisKKworCS8vIEJlc3QgY2FzZSwgd2Ugc3VwcG9ydCBm
dWxsIFVDTEsgc3dpdGNoIGxhdGVuY3kKKwl2b2x0YWdlX3N1cHBvcnRlZCA9IGRjbjIwX3ZhbGlk
YXRlX2JhbmR3aWR0aF9pbnRlcm5hbChkYywgY29udGV4dCwgZmFsc2UpOworCWZ1bGxfcHN0YXRl
X3N1cHBvcnRlZCA9IGNvbnRleHQtPmJ3X2N0eC5idy5kY24uY2xrLnBfc3RhdGVfY2hhbmdlX3N1
cHBvcnQ7CisKKwlpZiAoY29udGV4dC0+YndfY3R4LmRtbC5zb2MuZHVtbXlfcHN0YXRlX2xhdGVu
Y3lfdXMgPT0gMCB8fAorCQkodm9sdGFnZV9zdXBwb3J0ZWQgJiYgZnVsbF9wc3RhdGVfc3VwcG9y
dGVkKSkgeworCQljb250ZXh0LT5id19jdHguYncuZGNuLmNsay5wX3N0YXRlX2NoYW5nZV9zdXBw
b3J0ID0gdHJ1ZTsKKwkJZ290byByZXN0b3JlX2RtbF9zdGF0ZTsKKwl9CisKKwkvLyBGYWxsYmFj
ayAjMTogVHJ5IHRvIG9ubHkgc3VwcG9ydCBHNiB0ZW1wZXJhdHVyZSByZWFkIGxhdGVuY3kKKwlj
b250ZXh0LT5id19jdHguZG1sLnNvYy5kcmFtX2Nsb2NrX2NoYW5nZV9sYXRlbmN5X3VzID0gY29u
dGV4dC0+YndfY3R4LmRtbC5zb2MuZHVtbXlfcHN0YXRlX2xhdGVuY3lfdXM7CisKKwl2b2x0YWdl
X3N1cHBvcnRlZCA9IGRjbjIwX3ZhbGlkYXRlX2JhbmR3aWR0aF9pbnRlcm5hbChkYywgY29udGV4
dCwgZmFsc2UpOworCWR1bW15X3BzdGF0ZV9zdXBwb3J0ZWQgPSBjb250ZXh0LT5id19jdHguYncu
ZGNuLmNsay5wX3N0YXRlX2NoYW5nZV9zdXBwb3J0OworCisJaWYgKHZvbHRhZ2Vfc3VwcG9ydGVk
ICYmIGR1bW15X3BzdGF0ZV9zdXBwb3J0ZWQpIHsKKwkJY29udGV4dC0+YndfY3R4LmJ3LmRjbi5j
bGsucF9zdGF0ZV9jaGFuZ2Vfc3VwcG9ydCA9IGZhbHNlOworCQlnb3RvIHJlc3RvcmVfZG1sX3N0
YXRlOworCX0KKworCS8vIEZhbGxiYWNrICMyOiBSZXRyeSB3aXRoICJuZXciIERDTjIwIHRvIHN1
cHBvcnQgRzYgdGVtcGVyYXR1cmUgcmVhZCBsYXRlbmN5CisJbWVtY3B5ICgmY29udGV4dC0+Yndf
Y3R4LmRtbCwgJmRjLT53b3JrX2Fyb3VuZHMuYWx0ZXJuYXRlX2RtbCwgc2l6ZW9mIChzdHJ1Y3Qg
ZGlzcGxheV9tb2RlX2xpYikpOworCWNvbnRleHQtPmJ3X2N0eC5kbWwuc29jLmRyYW1fY2xvY2tf
Y2hhbmdlX2xhdGVuY3lfdXMgPSBjb250ZXh0LT5id19jdHguZG1sLnNvYy5kdW1teV9wc3RhdGVf
bGF0ZW5jeV91czsKKworCXZvbHRhZ2Vfc3VwcG9ydGVkID0gZGNuMjBfdmFsaWRhdGVfYmFuZHdp
ZHRoX2ludGVybmFsKGRjLCBjb250ZXh0LCBmYWxzZSk7CisJZHVtbXlfcHN0YXRlX3N1cHBvcnRl
ZCA9IGNvbnRleHQtPmJ3X2N0eC5idy5kY24uY2xrLnBfc3RhdGVfY2hhbmdlX3N1cHBvcnQ7CisK
KwlpZiAodm9sdGFnZV9zdXBwb3J0ZWQgJiYgZHVtbXlfcHN0YXRlX3N1cHBvcnRlZCkgeworCQlj
b250ZXh0LT5id19jdHguYncuZGNuLmNsay5wX3N0YXRlX2NoYW5nZV9zdXBwb3J0ID0gZmFsc2U7
CisJCWdvdG8gcmVzdG9yZV9kbWxfc3RhdGU7CisJfQorCisJLy8gRVJST1I6IGZhbGxiYWNrICMy
IGlzIHN1cHBvc2VkIHRvIGFsd2F5cyB3b3JrLgorCUFTU0VSVChmYWxzZSk7CisKK3Jlc3RvcmVf
ZG1sX3N0YXRlOgorCW1lbWNweSgmY29udGV4dC0+YndfY3R4LmRtbCwgJmRjLT5kbWwsIHNpemVv
ZihzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYikpOworCWNvbnRleHQtPmJ3X2N0eC5kbWwuc29jLmRy
YW1fY2xvY2tfY2hhbmdlX2xhdGVuY3lfdXMgPSBwX3N0YXRlX2xhdGVuY3lfdXM7CisKKwlyZXR1
cm4gdm9sdGFnZV9zdXBwb3J0ZWQ7Cit9CisKIHN0cnVjdCBwaXBlX2N0eCAqZGNuMjBfYWNxdWly
ZV9pZGxlX3BpcGVfZm9yX2xheWVyKAogCQlzdHJ1Y3QgZGNfc3RhdGUgKnN0YXRlLAogCQljb25z
dCBzdHJ1Y3QgcmVzb3VyY2VfcG9vbCAqcG9vbCwKQEAgLTMwNzMsNiArMzEyOSw3IEBAIHN0YXRp
YyBib29sIGNvbnN0cnVjdCgKIAl9CiAKIAlkbWxfaW5pdF9pbnN0YW5jZSgmZGMtPmRtbCwgJmRj
bjJfMF9zb2MsICZkY24yXzBfaXAsIERNTF9QUk9KRUNUX05BVkkxMCk7CisJZG1sX2luaXRfaW5z
dGFuY2UoJmRjLT53b3JrX2Fyb3VuZHMuYWx0ZXJuYXRlX2RtbCwgJmRjbjJfMF9zb2MsICZkY24y
XzBfaXAsIERNTF9QUk9KRUNUX05BVkkxMHYyKTsKIAogCWlmICghZGMtPmRlYnVnLmRpc2FibGVf
cHBsaWJfd21fcmFuZ2UpIHsKIAkJc3RydWN0IHBwX3NtdV93bV9yYW5nZV9zZXRzIHJhbmdlcyA9
IHswfTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvTWFr
ZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL01ha2VmaWxlCmluZGV4
IDBiYjdhMjA2NzVjNC4uMTczNWZjMWUyZWIxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZG1sL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9kYy9kbWwvTWFrZWZpbGUKQEAgLTM4LDYgKzM4LDggQEAgaWZkZWYgQ09ORklHX0RSTV9B
TURfRENfRENOMl8wCiBDRkxBR1NfZGlzcGxheV9tb2RlX3ZiYS5vIDo9ICQoZG1sX2NjZmxhZ3Mp
CiBDRkxBR1NfZGlzcGxheV9tb2RlX3ZiYV8yMC5vIDo9ICQoZG1sX2NjZmxhZ3MpCiBDRkxBR1Nf
ZGlzcGxheV9ycV9kbGdfY2FsY18yMC5vIDo9ICQoZG1sX2NjZmxhZ3MpCitDRkxBR1NfZGlzcGxh
eV9tb2RlX3ZiYV8yMHYyLm8gOj0gJChkbWxfY2NmbGFncykKK0NGTEFHU19kaXNwbGF5X3JxX2Rs
Z19jYWxjXzIwdjIubyA6PSAkKGRtbF9jY2ZsYWdzKQogZW5kaWYKIGlmZGVmIENPTkZJR19EUk1f
QU1EX0RDTjNBRwogQ0ZMQUdTX2Rpc3BsYXlfbW9kZV92YmFfM2FnLm8gOj0gJChkbWxfY2NmbGFn
cykKQEAgLTUxLDYgKzUzLDcgQEAgRE1MID0gZGlzcGxheV9tb2RlX2xpYi5vIGRpc3BsYXlfcnFf
ZGxnX2hlbHBlcnMubyBkbWwxX2Rpc3BsYXlfcnFfZGxnX2NhbGMubyBcCiAKIGlmZGVmIENPTkZJ
R19EUk1fQU1EX0RDX0RDTjJfMAogRE1MICs9IGRpc3BsYXlfbW9kZV92YmEubyBkY24yMC9kaXNw
bGF5X3JxX2RsZ19jYWxjXzIwLm8gZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMC5vCitETUwgKz0g
ZGNuMjAvZGlzcGxheV9ycV9kbGdfY2FsY18yMHYyLm8gZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8y
MHYyLm8KIGVuZGlmCiAKIEFNRF9EQUxfRE1MID0gJChhZGRwcmVmaXggJChBTUREQUxQQVRIKS9k
Yy9kbWwvLCQoRE1MKSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9k
Yy9kbWwvZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMHYyLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvZG1sL2RjbjIwL2Rpc3BsYXlfbW9kZV92YmFfMjB2Mi5jCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMjI0NTVkYjU0OTgwCi0tLSAvZGV2L251bGwK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24yMC9kaXNwbGF5X21v
ZGVfdmJhXzIwdjIuYwpAQCAtMCwwICsxLDUxMDkgQEAKKy8qCisgKiBDb3B5cmlnaHQgMjAxOCBB
ZHZhbmNlZCBNaWNybyBEZXZpY2VzLCBJbmMuCisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkg
Z3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNv
cHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0
aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3Ry
aWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVz
ZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwK
KyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVy
c29ucyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJq
ZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJp
Z2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBp
bgorICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUu
CisgKgorICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFO
VFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9U
IExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAorICogRklUTkVT
UyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVW
RU5UIFNIQUxMCisgKiBUSEUgQ09QWVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1IoUykgQkUgTElB
QkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IKKyAqIE9USEVSIExJQUJJTElUWSwgV0hFVEhF
UiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAorICogQVJJU0lO
RyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUg
VVNFIE9SCisgKiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCisgKgorICogQXV0aG9y
czogQU1ECisgKgorICovCisKKyNpbmNsdWRlICIuLi9kaXNwbGF5X21vZGVfbGliLmgiCisjaW5j
bHVkZSAiZGlzcGxheV9tb2RlX3ZiYV8yMHYyLmgiCisjaW5jbHVkZSAiLi4vZG1sX2lubGluZV9k
ZWZzLmgiCisKKy8qCisgKiBOT1RFOgorICogICBUaGlzIGZpbGUgaXMgZ2NjLXBhcnNlYWJsZSBI
VyBnb3NwZWwsIGNvbWluZyBzdHJhaWdodCBmcm9tIEhXIGVuZ2luZWVycy4KKyAqCisgKiBJdCBk
b2Vzbid0IGFkaGVyZSB0byBMaW51eCBrZXJuZWwgc3R5bGUgYW5kIHNvbWV0aW1lcyB3aWxsIGRv
IHRoaW5ncyBpbiBvZGQKKyAqIHdheXMuIFVubGVzcyB0aGVyZSBpcyBzb21ldGhpbmcgY2xlYXJs
eSB3cm9uZyB3aXRoIGl0IHRoZSBjb2RlIHNob3VsZAorICogcmVtYWluIGFzLWlzIGFzIGl0IHBy
b3ZpZGVzIHVzIHdpdGggYSBndWFyYW50ZWUgZnJvbSBIVyB0aGF0IGl0IGlzIGNvcnJlY3QuCisg
Ki8KKworI2RlZmluZSBCUFBfSU5WQUxJRCAwCisjZGVmaW5lIEJQUF9CTEVOREVEX1BJUEUgMHhm
ZmZmZmZmZgorCitzdGF0aWMgZG91YmxlIGFkanVzdF9SZXR1cm5CVygKKwkJc3RydWN0IGRpc3Bs
YXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgUmV0dXJuQlcsCisJCWJvb2wgRENDRW5h
YmxlZEFueVBsYW5lLAorCQlkb3VibGUgUmV0dXJuQmFuZHdpZHRoVG9EQ04pOworc3RhdGljIHVu
c2lnbmVkIGludCBkc2NjZUNvbXB1dGVEZWxheSgKKwkJdW5zaWduZWQgaW50IGJwYywKKwkJZG91
YmxlIGJwcCwKKwkJdW5zaWduZWQgaW50IHNsaWNlV2lkdGgsCisJCXVuc2lnbmVkIGludCBudW1T
bGljZXMsCisJCWVudW0gb3V0cHV0X2Zvcm1hdF9jbGFzcyBwaXhlbEZvcm1hdCk7CitzdGF0aWMg
dW5zaWduZWQgaW50IGRzY0NvbXB1dGVEZWxheShlbnVtIG91dHB1dF9mb3JtYXRfY2xhc3MgcGl4
ZWxGb3JtYXQpOworc3RhdGljIGJvb2wgQ2FsY3VsYXRlRGVsYXlBZnRlclNjYWxlcigKKwkJc3Ry
dWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgUmV0dXJuQlcsCisJCWRv
dWJsZSBSZWFkQmFuZHdpZHRoUGxhbmVMdW1hLAorCQlkb3VibGUgUmVhZEJhbmR3aWR0aFBsYW5l
Q2hyb21hLAorCQlkb3VibGUgVG90YWxEYXRhUmVhZEJhbmR3aWR0aCwKKwkJZG91YmxlIERpc3Bs
YXlQaXBlTGluZURlbGl2ZXJ5VGltZUx1bWEsCisJCWRvdWJsZSBEaXNwbGF5UGlwZUxpbmVEZWxp
dmVyeVRpbWVDaHJvbWEsCisJCWRvdWJsZSBEUFBDTEssCisJCWRvdWJsZSBESVNQQ0xLLAorCQlk
b3VibGUgUGl4ZWxDbG9jaywKKwkJdW5zaWduZWQgaW50IERTQ0RlbGF5LAorCQl1bnNpZ25lZCBp
bnQgRFBQUGVyUGxhbmUsCisJCWJvb2wgU2NhbGVyRW5hYmxlZCwKKwkJdW5zaWduZWQgaW50IE51
bWJlck9mQ3Vyc29ycywKKwkJZG91YmxlIERQUENMS0RlbGF5U3VidG90YWwsCisJCWRvdWJsZSBE
UFBDTEtEZWxheVNDTCwKKwkJZG91YmxlIERQUENMS0RlbGF5U0NMTEJPbmx5LAorCQlkb3VibGUg
RFBQQ0xLRGVsYXlDTlZDRm9ybWF0ZXIsCisJCWRvdWJsZSBEUFBDTEtEZWxheUNOVkNDdXJzb3Is
CisJCWRvdWJsZSBESVNQQ0xLRGVsYXlTdWJ0b3RhbCwKKwkJdW5zaWduZWQgaW50IFNjYWxlclJl
Y291dFdpZHRoLAorCQllbnVtIG91dHB1dF9mb3JtYXRfY2xhc3MgT3V0cHV0Rm9ybWF0LAorCQl1
bnNpZ25lZCBpbnQgSFRvdGFsLAorCQl1bnNpZ25lZCBpbnQgU3dhdGhXaWR0aFNpbmdsZURQUFks
CisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxERVRZLAorCQlkb3VibGUgQnl0ZVBlclBpeGVsREVUQywK
KwkJdW5zaWduZWQgaW50IFN3YXRoSGVpZ2h0WSwKKwkJdW5zaWduZWQgaW50IFN3YXRoSGVpZ2h0
QywKKwkJYm9vbCBJbnRlcmxhY2UsCisJCWJvb2wgUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJ
bk9QUCwKKwkJZG91YmxlICpEU1RYQWZ0ZXJTY2FsZXIsCisJCWRvdWJsZSAqRFNUWUFmdGVyU2Nh
bGVyCisJCSk7CisvLyBTdXBlciBtb25zdGVyIGZ1bmN0aW9uIHdpdGggc29tZSA0NSBhcmd1bWVu
dAorc3RhdGljIGJvb2wgQ2FsY3VsYXRlUHJlZmV0Y2hTY2hlZHVsZSgKKwkJc3RydWN0IGRpc3Bs
YXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgRFBQQ0xLLAorCQlkb3VibGUgRElTUENM
SywKKwkJZG91YmxlIFBpeGVsQ2xvY2ssCisJCWRvdWJsZSBEQ0ZDTEtEZWVwU2xlZXAsCisJCXVu
c2lnbmVkIGludCBEUFBQZXJQbGFuZSwKKwkJdW5zaWduZWQgaW50IE51bWJlck9mQ3Vyc29ycywK
KwkJdW5zaWduZWQgaW50IFZCbGFuaywKKwkJdW5zaWduZWQgaW50IEhUb3RhbCwKKwkJdW5zaWdu
ZWQgaW50IE1heEludGVyRENOVGlsZVJlcGVhdGVycywKKwkJdW5zaWduZWQgaW50IFZTdGFydHVw
LAorCQl1bnNpZ25lZCBpbnQgUGFnZVRhYmxlTGV2ZWxzLAorCQlib29sIEdQVVZNRW5hYmxlLAor
CQlib29sIER5bmFtaWNNZXRhZGF0YUVuYWJsZSwKKwkJdW5zaWduZWQgaW50IER5bmFtaWNNZXRh
ZGF0YUxpbmVzQmVmb3JlQWN0aXZlUmVxdWlyZWQsCisJCXVuc2lnbmVkIGludCBEeW5hbWljTWV0
YWRhdGFUcmFuc21pdHRlZEJ5dGVzLAorCQlib29sIERDQ0VuYWJsZSwKKwkJZG91YmxlIFVyZ2Vu
dExhdGVuY3lQaXhlbERhdGFPbmx5LAorCQlkb3VibGUgVXJnZW50RXh0cmFMYXRlbmN5LAorCQlk
b3VibGUgVENhbGMsCisJCXVuc2lnbmVkIGludCBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZSwKKwkJ
dW5zaWduZWQgaW50IE1ldGFSb3dCeXRlLAorCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVCeXRlc1Bl
clJvdywKKwkJZG91YmxlIFByZWZldGNoU291cmNlTGluZXNZLAorCQl1bnNpZ25lZCBpbnQgU3dh
dGhXaWR0aFksCisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxERVRZLAorCQlkb3VibGUgVkluaXRQcmVG
aWxsWSwKKwkJdW5zaWduZWQgaW50IE1heE51bVN3YXRoWSwKKwkJZG91YmxlIFByZWZldGNoU291
cmNlTGluZXNDLAorCQlkb3VibGUgQnl0ZVBlclBpeGVsREVUQywKKwkJZG91YmxlIFZJbml0UHJl
RmlsbEMsCisJCXVuc2lnbmVkIGludCBNYXhOdW1Td2F0aEMsCisJCXVuc2lnbmVkIGludCBTd2F0
aEhlaWdodFksCisJCXVuc2lnbmVkIGludCBTd2F0aEhlaWdodEMsCisJCWRvdWJsZSBUV2FpdCwK
KwkJYm9vbCBYRkNFbmFibGVkLAorCQlkb3VibGUgWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSwK
KwkJYm9vbCBJbnRlcmxhY2VFbmFibGUsCisJCWJvb2wgUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVu
aXRJbk9QUCwKKwkJZG91YmxlIERTVFhBZnRlclNjYWxlciwKKwkJZG91YmxlIERTVFlBZnRlclNj
YWxlciwKKwkJZG91YmxlICpEZXN0aW5hdGlvbkxpbmVzRm9yUHJlZmV0Y2gsCisJCWRvdWJsZSAq
UHJlZmV0Y2hCYW5kd2lkdGgsCisJCWRvdWJsZSAqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZN
SW5WQmxhbmssCisJCWRvdWJsZSAqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luVkJsYW5r
LAorCQlkb3VibGUgKlZSYXRpb1ByZWZldGNoWSwKKwkJZG91YmxlICpWUmF0aW9QcmVmZXRjaEMs
CisJCWRvdWJsZSAqUmVxdWlyZWRQcmVmZXRjaFBpeERhdGFCVywKKwkJZG91YmxlICpUbm9fYncs
CisJCXVuc2lnbmVkIGludCAqVlVwZGF0ZU9mZnNldFBpeCwKKwkJZG91YmxlICpWVXBkYXRlV2lk
dGhQaXgsCisJCWRvdWJsZSAqVlJlYWR5T2Zmc2V0UGl4KTsKK3N0YXRpYyBkb3VibGUgUm91bmRU
b0RGU0dyYW51bGFyaXR5VXAoZG91YmxlIENsb2NrLCBkb3VibGUgVkNPU3BlZWQpOworc3RhdGlj
IGRvdWJsZSBSb3VuZFRvREZTR3JhbnVsYXJpdHlEb3duKGRvdWJsZSBDbG9jaywgZG91YmxlIFZD
T1NwZWVkKTsKK3N0YXRpYyBkb3VibGUgQ2FsY3VsYXRlUHJlZmV0Y2hTb3VyY2VMaW5lcygKKwkJ
c3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgVlJhdGlvLAorCQlk
b3VibGUgdnRhcHMsCisJCWJvb2wgSW50ZXJsYWNlLAorCQlib29sIFByb2dyZXNzaXZlVG9JbnRl
cmxhY2VVbml0SW5PUFAsCisJCXVuc2lnbmVkIGludCBTd2F0aEhlaWdodCwKKwkJdW5zaWduZWQg
aW50IFZpZXdwb3J0WVN0YXJ0LAorCQlkb3VibGUgKlZJbml0UHJlRmlsbCwKKwkJdW5zaWduZWQg
aW50ICpNYXhOdW1Td2F0aCk7CitzdGF0aWMgdW5zaWduZWQgaW50IENhbGN1bGF0ZVZNQW5kUm93
Qnl0ZXMoCisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJYm9vbCBEQ0NF
bmFibGUsCisJCXVuc2lnbmVkIGludCBCbG9ja0hlaWdodDI1NkJ5dGVzLAorCQl1bnNpZ25lZCBp
bnQgQmxvY2tXaWR0aDI1NkJ5dGVzLAorCQllbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MgU291cmNl
UGl4ZWxGb3JtYXQsCisJCXVuc2lnbmVkIGludCBTdXJmYWNlVGlsaW5nLAorCQl1bnNpZ25lZCBp
bnQgQnl0ZVBlclBpeGVsLAorCQllbnVtIHNjYW5fZGlyZWN0aW9uX2NsYXNzIFNjYW5EaXJlY3Rp
b24sCisJCXVuc2lnbmVkIGludCBWaWV3cG9ydFdpZHRoLAorCQl1bnNpZ25lZCBpbnQgVmlld3Bv
cnRIZWlnaHQsCisJCXVuc2lnbmVkIGludCBTd2F0aFdpZHRoWSwKKwkJYm9vbCBHUFVWTUVuYWJs
ZSwKKwkJdW5zaWduZWQgaW50IFZNTVBhZ2VTaXplLAorCQl1bnNpZ25lZCBpbnQgUFRFQnVmZmVy
U2l6ZUluUmVxdWVzdHNMdW1hLAorCQl1bnNpZ25lZCBpbnQgUERFUHJvY2Vzc2luZ0J1ZkluNjRL
QlJlcXMsCisJCXVuc2lnbmVkIGludCBQaXRjaCwKKwkJdW5zaWduZWQgaW50IERDQ01ldGFQaXRj
aCwKKwkJdW5zaWduZWQgaW50ICpNYWNyb1RpbGVXaWR0aCwKKwkJdW5zaWduZWQgaW50ICpNZXRh
Um93Qnl0ZSwKKwkJdW5zaWduZWQgaW50ICpQaXhlbFBURUJ5dGVzUGVyUm93LAorCQlib29sICpQ
VEVCdWZmZXJTaXplTm90RXhjZWVkZWQsCisJCXVuc2lnbmVkIGludCAqZHB0ZV9yb3dfaGVpZ2h0
LAorCQl1bnNpZ25lZCBpbnQgKm1ldGFfcm93X2hlaWdodCk7CitzdGF0aWMgZG91YmxlIENhbGN1
bGF0ZVRXYWl0KAorCQl1bnNpZ25lZCBpbnQgUHJlZmV0Y2hNb2RlLAorCQlkb3VibGUgRFJBTUNs
b2NrQ2hhbmdlTGF0ZW5jeSwKKwkJZG91YmxlIFVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5LAor
CQlkb3VibGUgU1JFbnRlclBsdXNFeGl0VGltZSk7CitzdGF0aWMgZG91YmxlIENhbGN1bGF0ZVJl
bW90ZVN1cmZhY2VGbGlwRGVsYXkoCisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xp
YiwKKwkJZG91YmxlIFZSYXRpbywKKwkJZG91YmxlIFN3YXRoV2lkdGgsCisJCWRvdWJsZSBCcHAs
CisJCWRvdWJsZSBMaW5lVGltZSwKKwkJZG91YmxlIFhGQ1RTbHZWdXBkYXRlT2Zmc2V0LAorCQlk
b3VibGUgWEZDVFNsdlZ1cGRhdGVXaWR0aCwKKwkJZG91YmxlIFhGQ1RTbHZWcmVhZHlPZmZzZXQs
CisJCWRvdWJsZSBYRkNYQlVGTGF0ZW5jeVRvbGVyYW5jZSwKKwkJZG91YmxlIFhGQ0ZpbGxCV092
ZXJoZWFkLAorCQlkb3VibGUgWEZDU2x2Q2h1bmtTaXplLAorCQlkb3VibGUgWEZDQnVzVHJhbnNw
b3J0VGltZSwKKwkJZG91YmxlIFRDYWxjLAorCQlkb3VibGUgVFdhaXQsCisJCWRvdWJsZSAqU3Jj
QWN0aXZlRHJhaW5SYXRlLAorCQlkb3VibGUgKlRJbml0WEZpbGwsCisJCWRvdWJsZSAqVHNsdkNo
ayk7CitzdGF0aWMgdm9pZCBDYWxjdWxhdGVBY3RpdmVSb3dCYW5kd2lkdGgoCisJCWJvb2wgR1BV
Vk1FbmFibGUsCisJCWVudW0gc291cmNlX2Zvcm1hdF9jbGFzcyBTb3VyY2VQaXhlbEZvcm1hdCwK
KwkJZG91YmxlIFZSYXRpbywKKwkJYm9vbCBEQ0NFbmFibGUsCisJCWRvdWJsZSBMaW5lVGltZSwK
KwkJdW5zaWduZWQgaW50IE1ldGFSb3dCeXRlTHVtYSwKKwkJdW5zaWduZWQgaW50IE1ldGFSb3dC
eXRlQ2hyb21hLAorCQl1bnNpZ25lZCBpbnQgbWV0YV9yb3dfaGVpZ2h0X2x1bWEsCisJCXVuc2ln
bmVkIGludCBtZXRhX3Jvd19oZWlnaHRfY2hyb21hLAorCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVC
eXRlc1BlclJvd0x1bWEsCisJCXVuc2lnbmVkIGludCBQaXhlbFBURUJ5dGVzUGVyUm93Q2hyb21h
LAorCQl1bnNpZ25lZCBpbnQgZHB0ZV9yb3dfaGVpZ2h0X2x1bWEsCisJCXVuc2lnbmVkIGludCBk
cHRlX3Jvd19oZWlnaHRfY2hyb21hLAorCQlkb3VibGUgKm1ldGFfcm93X2J3LAorCQlkb3VibGUg
KmRwdGVfcm93X2J3LAorCQlkb3VibGUgKnF1YWxfcm93X2J3KTsKK3N0YXRpYyB2b2lkIENhbGN1
bGF0ZUZsaXBTY2hlZHVsZSgKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAor
CQlkb3VibGUgVXJnZW50RXh0cmFMYXRlbmN5LAorCQlkb3VibGUgVXJnZW50TGF0ZW5jeVBpeGVs
RGF0YU9ubHksCisJCXVuc2lnbmVkIGludCBHUFVWTU1heFBhZ2VUYWJsZUxldmVscywKKwkJYm9v
bCBHUFVWTUVuYWJsZSwKKwkJZG91YmxlIEJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZs
aXAsCisJCXVuc2lnbmVkIGludCBUb3RJbW1lZGlhdGVGbGlwQnl0ZXMsCisJCWVudW0gc291cmNl
X2Zvcm1hdF9jbGFzcyBTb3VyY2VQaXhlbEZvcm1hdCwKKwkJdW5zaWduZWQgaW50IEltbWVkaWF0
ZUZsaXBCeXRlcywKKwkJZG91YmxlIExpbmVUaW1lLAorCQlkb3VibGUgVlJhdGlvLAorCQlkb3Vi
bGUgVG5vX2J3LAorCQlkb3VibGUgUERFQW5kTWV0YVBURUJ5dGVzRnJhbWUsCisJCXVuc2lnbmVk
IGludCBNZXRhUm93Qnl0ZSwKKwkJdW5zaWduZWQgaW50IFBpeGVsUFRFQnl0ZXNQZXJSb3csCisJ
CWJvb2wgRENDRW5hYmxlLAorCQl1bnNpZ25lZCBpbnQgZHB0ZV9yb3dfaGVpZ2h0LAorCQl1bnNp
Z25lZCBpbnQgbWV0YV9yb3dfaGVpZ2h0LAorCQlkb3VibGUgcXVhbF9yb3dfYncsCisJCWRvdWJs
ZSAqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5JbW1lZGlhdGVGbGlwLAorCQlkb3VibGUg
KkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJbkltbWVkaWF0ZUZsaXAsCisJCWRvdWJsZSAq
ZmluYWxfZmxpcF9idywKKwkJYm9vbCAqSW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclBpcGUpOwor
c3RhdGljIGRvdWJsZSBDYWxjdWxhdGVXcml0ZUJhY2tEZWxheSgKKwkJZW51bSBzb3VyY2VfZm9y
bWF0X2NsYXNzIFdyaXRlYmFja1BpeGVsRm9ybWF0LAorCQlkb3VibGUgV3JpdGViYWNrSFJhdGlv
LAorCQlkb3VibGUgV3JpdGViYWNrVlJhdGlvLAorCQl1bnNpZ25lZCBpbnQgV3JpdGViYWNrTHVt
YUhUYXBzLAorCQl1bnNpZ25lZCBpbnQgV3JpdGViYWNrTHVtYVZUYXBzLAorCQl1bnNpZ25lZCBp
bnQgV3JpdGViYWNrQ2hyb21hSFRhcHMsCisJCXVuc2lnbmVkIGludCBXcml0ZWJhY2tDaHJvbWFW
VGFwcywKKwkJdW5zaWduZWQgaW50IFdyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGgpOworCitzdGF0
aWMgdm9pZCBkbWwyMHYyX0Rpc3BsYXlQaXBlQ29uZmlndXJhdGlvbihzdHJ1Y3QgZGlzcGxheV9t
b2RlX2xpYiAqbW9kZV9saWIpOworc3RhdGljIHZvaWQgZG1sMjB2Ml9ESVNQQ0xLRFBQQ0xLRENG
Q0xLRGVlcFNsZWVwUHJlZmV0Y2hQYXJhbWV0ZXJzV2F0ZXJtYXJrc0FuZFBlcmZvcm1hbmNlQ2Fs
Y3VsYXRpb24oCisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYik7CisKK3ZvaWQg
ZG1sMjB2Ml9yZWNhbGN1bGF0ZShzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIpCit7
CisJTW9kZVN1cHBvcnRBbmRTeXN0ZW1Db25maWd1cmF0aW9uKG1vZGVfbGliKTsKKwltb2RlX2xp
Yi0+dmJhLkZhYnJpY0FuZERSQU1CYW5kd2lkdGggPSBkbWxfbWluKAorCQltb2RlX2xpYi0+dmJh
LkRSQU1TcGVlZCAqIG1vZGVfbGliLT52YmEuTnVtYmVyT2ZDaGFubmVscyAqIG1vZGVfbGliLT52
YmEuRFJBTUNoYW5uZWxXaWR0aCwKKwkJbW9kZV9saWItPnZiYS5GYWJyaWNDbG9jayAqIG1vZGVf
bGliLT52YmEuRmFicmljRGF0YXBhdGhUb0RDTkRhdGFSZXR1cm4pIC8gMTAwMC4wOworCVBpeGVs
Q2xvY2tBZGp1c3RtZW50Rm9yUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXQobW9kZV9saWIpOwor
CWRtbDIwdjJfRGlzcGxheVBpcGVDb25maWd1cmF0aW9uKG1vZGVfbGliKTsKKwlkbWwyMHYyX0RJ
U1BDTEtEUFBDTEtEQ0ZDTEtEZWVwU2xlZXBQcmVmZXRjaFBhcmFtZXRlcnNXYXRlcm1hcmtzQW5k
UGVyZm9ybWFuY2VDYWxjdWxhdGlvbihtb2RlX2xpYik7Cit9CisKK3N0YXRpYyBkb3VibGUgYWRq
dXN0X1JldHVybkJXKAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRv
dWJsZSBSZXR1cm5CVywKKwkJYm9vbCBEQ0NFbmFibGVkQW55UGxhbmUsCisJCWRvdWJsZSBSZXR1
cm5CYW5kd2lkdGhUb0RDTikKK3sKKwlkb3VibGUgQ3JpdGljYWxDb21wcmVzc2lvbjsKKworCWlm
IChEQ0NFbmFibGVkQW55UGxhbmUKKwkJCSYmIFJldHVybkJhbmR3aWR0aFRvRENOCisJCQkJCT4g
bW9kZV9saWItPnZiYS5EQ0ZDTEsgKiBtb2RlX2xpYi0+dmJhLlJldHVybkJ1c1dpZHRoIC8gNC4w
KQorCQlSZXR1cm5CVyA9CisJCQkJZG1sX21pbigKKwkJCQkJCVJldHVybkJXLAorCQkJCQkJUmV0
dXJuQmFuZHdpZHRoVG9EQ04gKiA0CisJCQkJCQkJCSogKDEuMAorCQkJCQkJCQkJCS0gbW9kZV9s
aWItPnZiYS5VcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seQorCQkJCQkJCQkJCQkJLyAoKG1vZGVf
bGliLT52YmEuUk9CQnVmZmVyU2l6ZUluS0J5dGUKKwkJCQkJCQkJCQkJCQkJLSBtb2RlX2xpYi0+
dmJhLlBpeGVsQ2h1bmtTaXplSW5LQnl0ZSkKKwkJCQkJCQkJCQkJCQkJKiAxMDI0CisJCQkJCQkJ
CQkJCQkJCS8gUmV0dXJuQmFuZHdpZHRoVG9EQ04KKwkJCQkJCQkJCQkJCQkJLSBtb2RlX2xpYi0+
dmJhLkRDRkNMSworCQkJCQkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5SZXR1cm5CdXNXaWR0
aAorCQkJCQkJCQkJCQkJCQkJCS8gNCkKKwkJCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuVXJnZW50
TGF0ZW5jeVBpeGVsRGF0YU9ubHkpKTsKKworCUNyaXRpY2FsQ29tcHJlc3Npb24gPSAyLjAgKiBt
b2RlX2xpYi0+dmJhLlJldHVybkJ1c1dpZHRoICogbW9kZV9saWItPnZiYS5EQ0ZDTEsKKwkJCSog
bW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seQorCQkJLyAoUmV0dXJuQmFu
ZHdpZHRoVG9EQ04gKiBtb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5CisJ
CQkJCSsgKG1vZGVfbGliLT52YmEuUk9CQnVmZmVyU2l6ZUluS0J5dGUKKwkJCQkJCQktIG1vZGVf
bGliLT52YmEuUGl4ZWxDaHVua1NpemVJbktCeXRlKQorCQkJCQkJCSogMTAyNCk7CisKKwlpZiAo
RENDRW5hYmxlZEFueVBsYW5lICYmIENyaXRpY2FsQ29tcHJlc3Npb24gPiAxLjAgJiYgQ3JpdGlj
YWxDb21wcmVzc2lvbiA8IDQuMCkKKwkJUmV0dXJuQlcgPQorCQkJCWRtbF9taW4oCisJCQkJCQlS
ZXR1cm5CVywKKwkJCQkJCTQuMCAqIFJldHVybkJhbmR3aWR0aFRvRENOCisJCQkJCQkJCSogKG1v
ZGVfbGliLT52YmEuUk9CQnVmZmVyU2l6ZUluS0J5dGUKKwkJCQkJCQkJCQktIG1vZGVfbGliLT52
YmEuUGl4ZWxDaHVua1NpemVJbktCeXRlKQorCQkJCQkJCQkqIDEwMjQKKwkJCQkJCQkJKiBtb2Rl
X2xpYi0+dmJhLlJldHVybkJ1c1dpZHRoCisJCQkJCQkJCSogbW9kZV9saWItPnZiYS5EQ0ZDTEsK
KwkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5CisJCQkJ
CQkJCS8gZG1sX3BvdygKKwkJCQkJCQkJCQkoUmV0dXJuQmFuZHdpZHRoVG9EQ04KKwkJCQkJCQkJ
CQkJCSogbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seQorCQkJCQkJCQkJ
CQkJKyAobW9kZV9saWItPnZiYS5ST0JCdWZmZXJTaXplSW5LQnl0ZQorCQkJCQkJCQkJCQkJCQkt
IG1vZGVfbGliLT52YmEuUGl4ZWxDaHVua1NpemVJbktCeXRlKQorCQkJCQkJCQkJCQkJCQkqIDEw
MjQpLAorCQkJCQkJCQkJCTIpKTsKKworCXJldHVybiBSZXR1cm5CVzsKK30KKworc3RhdGljIHVu
c2lnbmVkIGludCBkc2NjZUNvbXB1dGVEZWxheSgKKwkJdW5zaWduZWQgaW50IGJwYywKKwkJZG91
YmxlIGJwcCwKKwkJdW5zaWduZWQgaW50IHNsaWNlV2lkdGgsCisJCXVuc2lnbmVkIGludCBudW1T
bGljZXMsCisJCWVudW0gb3V0cHV0X2Zvcm1hdF9jbGFzcyBwaXhlbEZvcm1hdCkKK3sKKwkvLyB2
YWxpZCBicGMgICAgICAgICA9IHNvdXJjZSBiaXRzIHBlciBjb21wb25lbnQgaW4gdGhlIHNldCBv
ZiB7OCwgMTAsIDEyfQorCS8vIHZhbGlkIGJwcCAgICAgICAgID0gaW5jcmVtZW50cyBvZiAxLzE2
IG9mIGEgYml0CisJLy8gICAgICAgICAgICAgICAgICAgIG1pbiA9IDYvNy84IGluIE40MjAvTjQy
Mi80NDQsIHJlc3BlY3RpdmVseQorCS8vICAgICAgICAgICAgICAgICAgICBtYXggPSBzdWNoIHRo
YXQgY29tcHJlc3Npb24gaXMgMToxCisJLy92YWxpZCBzbGljZVdpZHRoICA9IG51bWJlciBvZiBw
aXhlbHMgcGVyIHNsaWNlIGxpbmUsIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIDUxODQv
bnVtU2xpY2VzIChvciA0MDk2L251bVNsaWNlcyBpbiA0MjAgbW9kZSkKKwkvL3ZhbGlkIG51bVNs
aWNlcyAgID0gbnVtYmVyIG9mIHNsaWNlcyBpbiB0aGUgaG9yaXppb250YWwgZGlyZWN0aW9uIHBl
ciBEU0MgZW5naW5lIGluIHRoZSBzZXQgb2YgezEsIDIsIDMsIDR9CisJLy92YWxpZCBwaXhlbEZv
cm1hdCA9IHBpeGVsL2NvbG9yIGZvcm1hdCBpbiB0aGUgc2V0IG9mIHs6TjQ0NF9SR0IsIDpTNDIy
LCA6TjQyMiwgOk40MjB9CisKKwkvLyBmaXhlZCB2YWx1ZQorCXVuc2lnbmVkIGludCByY01vZGVs
U2l6ZSA9IDgxOTI7CisKKwkvLyBONDIyL040MjAgb3BlcmF0ZSBhdCAyIHBpeGVscyBwZXIgY2xv
Y2sKKwl1bnNpZ25lZCBpbnQgcGl4ZWxzUGVyQ2xvY2ssIGxzdGFsbCwgRCwgaW5pdGFsWG1pdERl
bGF5LCB3LCBzLCBpeCwgd3gsIHAsIGwwLCBhLCBheCwgbCwKKwkJCURlbGF5LCBwaXhlbHM7CisK
KwlpZiAocGl4ZWxGb3JtYXQgPT0gZG1fbjQyMiB8fCBwaXhlbEZvcm1hdCA9PSBkbV80MjApCisJ
CXBpeGVsc1BlckNsb2NrID0gMjsKKwkvLyAjYWxsIG90aGVyIG1vZGVzIG9wZXJhdGUgYXQgMSBw
aXhlbCBwZXIgY2xvY2sKKwllbHNlCisJCXBpeGVsc1BlckNsb2NrID0gMTsKKworCS8vaW5pdGlh
bCB0cmFuc21pdCBkZWxheSBhcyBwZXIgUFBTCisJaW5pdGFsWG1pdERlbGF5ID0gZG1sX3JvdW5k
KHJjTW9kZWxTaXplIC8gMi4wIC8gYnBwIC8gcGl4ZWxzUGVyQ2xvY2spOworCisJLy9jb21wdXRl
IHNzbSBkZWxheQorCWlmIChicGMgPT0gOCkKKwkJRCA9IDgxOworCWVsc2UgaWYgKGJwYyA9PSAx
MCkKKwkJRCA9IDg5OworCWVsc2UKKwkJRCA9IDExMzsKKworCS8vZGl2aWRlIGJ5IHBpeGVsIHBl
ciBjeWNsZSB0byBjb21wdXRlIHNsaWNlIHdpZHRoIGFzIHNlZW4gYnkgRFNDCisJdyA9IHNsaWNl
V2lkdGggLyBwaXhlbHNQZXJDbG9jazsKKworCS8vNDIyIG1vZGUgaGFzIGFuIGFkZGl0aW9uYWwg
Y3ljbGUgb2YgZGVsYXkKKwlpZiAocGl4ZWxGb3JtYXQgPT0gZG1fczQyMikKKwkJcyA9IDE7CisJ
ZWxzZQorCQlzID0gMDsKKworCS8vbWFpbiBjYWxjdWxhdGlvbiBmb3IgdGhlIGRzY2NlCisJaXgg
PSBpbml0YWxYbWl0RGVsYXkgKyA0NTsKKwl3eCA9ICh3ICsgMikgLyAzOworCXAgPSAzICogd3gg
LSB3OworCWwwID0gaXggLyB3OworCWEgPSBpeCArIHAgKiBsMDsKKwlheCA9IChhICsgMikgLyAz
ICsgRCArIDYgKyAxOworCWwgPSAoYXggKyB3eCAtIDEpIC8gd3g7CisJaWYgKChpeCAlIHcpID09
IDAgJiYgcCAhPSAwKQorCQlsc3RhbGwgPSAxOworCWVsc2UKKwkJbHN0YWxsID0gMDsKKwlEZWxh
eSA9IGwgKiB3eCAqIChudW1TbGljZXMgLSAxKSArIGF4ICsgcyArIGxzdGFsbCArIDIyOworCisJ
Ly9kc2MgcHJvY2Vzc2VzIDMgcGl4ZWwgY29udGFpbmVycyBwZXIgY3ljbGUgYW5kIGEgY29udGFp
bmVyIGNhbiBjb250YWluIDEgb3IgMiBwaXhlbHMKKwlwaXhlbHMgPSBEZWxheSAqIDMgKiBwaXhl
bHNQZXJDbG9jazsKKwlyZXR1cm4gcGl4ZWxzOworfQorCitzdGF0aWMgdW5zaWduZWQgaW50IGRz
Y0NvbXB1dGVEZWxheShlbnVtIG91dHB1dF9mb3JtYXRfY2xhc3MgcGl4ZWxGb3JtYXQpCit7CisJ
dW5zaWduZWQgaW50IERlbGF5ID0gMDsKKworCWlmIChwaXhlbEZvcm1hdCA9PSBkbV80MjApIHsK
KwkJLy8gICBzZnIKKwkJRGVsYXkgPSBEZWxheSArIDI7CisJCS8vICAgZHNjY2lmCisJCURlbGF5
ID0gRGVsYXkgKyAwOworCQkvLyAgIGRzY2MgLSBpbnB1dCBkZXNlcmlhbGl6ZXIKKwkJRGVsYXkg
PSBEZWxheSArIDM7CisJCS8vICAgZHNjYyBnZXRzIHBpeGVscyBldmVyeSBvdGhlciBjeWNsZQor
CQlEZWxheSA9IERlbGF5ICsgMjsKKwkJLy8gICBkc2NjIC0gaW5wdXQgY2RjIGZpZm8KKwkJRGVs
YXkgPSBEZWxheSArIDEyOworCQkvLyAgIGRzY2MgZ2V0cyBwaXhlbHMgZXZlcnkgb3RoZXIgY3lj
bGUKKwkJRGVsYXkgPSBEZWxheSArIDEzOworCQkvLyAgIGRzY2MgLSBjZGMgdW5jZXJ0YWludHkK
KwkJRGVsYXkgPSBEZWxheSArIDI7CisJCS8vICAgZHNjYyAtIG91dHB1dCBjZGMgZmlmbworCQlE
ZWxheSA9IERlbGF5ICsgNzsKKwkJLy8gICBkc2NjIGdldHMgcGl4ZWxzIGV2ZXJ5IG90aGVyIGN5
Y2xlCisJCURlbGF5ID0gRGVsYXkgKyAzOworCQkvLyAgIGRzY2MgLSBjZGMgdW5jZXJ0YWludHkK
KwkJRGVsYXkgPSBEZWxheSArIDI7CisJCS8vICAgZHNjYyAtIG91dHB1dCBzZXJpYWxpemVyCisJ
CURlbGF5ID0gRGVsYXkgKyAxOworCQkvLyAgIHNmdAorCQlEZWxheSA9IERlbGF5ICsgMTsKKwl9
IGVsc2UgaWYgKHBpeGVsRm9ybWF0ID09IGRtX240MjIpIHsKKwkJLy8gICBzZnIKKwkJRGVsYXkg
PSBEZWxheSArIDI7CisJCS8vICAgZHNjY2lmCisJCURlbGF5ID0gRGVsYXkgKyAxOworCQkvLyAg
IGRzY2MgLSBpbnB1dCBkZXNlcmlhbGl6ZXIKKwkJRGVsYXkgPSBEZWxheSArIDU7CisJCS8vICBk
c2NjIC0gaW5wdXQgY2RjIGZpZm8KKwkJRGVsYXkgPSBEZWxheSArIDI1OworCQkvLyAgIGRzY2Mg
LSBjZGMgdW5jZXJ0YWludHkKKwkJRGVsYXkgPSBEZWxheSArIDI7CisJCS8vICAgZHNjYyAtIG91
dHB1dCBjZGMgZmlmbworCQlEZWxheSA9IERlbGF5ICsgMTA7CisJCS8vICAgZHNjYyAtIGNkYyB1
bmNlcnRhaW50eQorCQlEZWxheSA9IERlbGF5ICsgMjsKKwkJLy8gICBkc2NjIC0gb3V0cHV0IHNl
cmlhbGl6ZXIKKwkJRGVsYXkgPSBEZWxheSArIDE7CisJCS8vICAgc2Z0CisJCURlbGF5ID0gRGVs
YXkgKyAxOworCX0gZWxzZSB7CisJCS8vICAgc2ZyCisJCURlbGF5ID0gRGVsYXkgKyAyOworCQkv
LyAgIGRzY2NpZgorCQlEZWxheSA9IERlbGF5ICsgMDsKKwkJLy8gICBkc2NjIC0gaW5wdXQgZGVz
ZXJpYWxpemVyCisJCURlbGF5ID0gRGVsYXkgKyAzOworCQkvLyAgIGRzY2MgLSBpbnB1dCBjZGMg
ZmlmbworCQlEZWxheSA9IERlbGF5ICsgMTI7CisJCS8vICAgZHNjYyAtIGNkYyB1bmNlcnRhaW50
eQorCQlEZWxheSA9IERlbGF5ICsgMjsKKwkJLy8gICBkc2NjIC0gb3V0cHV0IGNkYyBmaWZvCisJ
CURlbGF5ID0gRGVsYXkgKyA3OworCQkvLyAgIGRzY2MgLSBvdXRwdXQgc2VyaWFsaXplcgorCQlE
ZWxheSA9IERlbGF5ICsgMTsKKwkJLy8gICBkc2NjIC0gY2RjIHVuY2VydGFpbnR5CisJCURlbGF5
ID0gRGVsYXkgKyAyOworCQkvLyAgIHNmdAorCQlEZWxheSA9IERlbGF5ICsgMTsKKwl9CisKKwly
ZXR1cm4gRGVsYXk7Cit9CisKK3N0YXRpYyBib29sIENhbGN1bGF0ZURlbGF5QWZ0ZXJTY2FsZXIo
CisJCXN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJZG91YmxlIFJldHVybkJX
LAorCQlkb3VibGUgUmVhZEJhbmR3aWR0aFBsYW5lTHVtYSwKKwkJZG91YmxlIFJlYWRCYW5kd2lk
dGhQbGFuZUNocm9tYSwKKwkJZG91YmxlIFRvdGFsRGF0YVJlYWRCYW5kd2lkdGgsCisJCWRvdWJs
ZSBEaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVMdW1hLAorCQlkb3VibGUgRGlzcGxheVBpcGVM
aW5lRGVsaXZlcnlUaW1lQ2hyb21hLAorCQlkb3VibGUgRFBQQ0xLLAorCQlkb3VibGUgRElTUENM
SywKKwkJZG91YmxlIFBpeGVsQ2xvY2ssCisJCXVuc2lnbmVkIGludCBEU0NEZWxheSwKKwkJdW5z
aWduZWQgaW50IERQUFBlclBsYW5lLAorCQlib29sIFNjYWxlckVuYWJsZWQsCisJCXVuc2lnbmVk
IGludCBOdW1iZXJPZkN1cnNvcnMsCisJCWRvdWJsZSBEUFBDTEtEZWxheVN1YnRvdGFsLAorCQlk
b3VibGUgRFBQQ0xLRGVsYXlTQ0wsCisJCWRvdWJsZSBEUFBDTEtEZWxheVNDTExCT25seSwKKwkJ
ZG91YmxlIERQUENMS0RlbGF5Q05WQ0Zvcm1hdGVyLAorCQlkb3VibGUgRFBQQ0xLRGVsYXlDTlZD
Q3Vyc29yLAorCQlkb3VibGUgRElTUENMS0RlbGF5U3VidG90YWwsCisJCXVuc2lnbmVkIGludCBT
Y2FsZXJSZWNvdXRXaWR0aCwKKwkJZW51bSBvdXRwdXRfZm9ybWF0X2NsYXNzIE91dHB1dEZvcm1h
dCwKKwkJdW5zaWduZWQgaW50IEhUb3RhbCwKKwkJdW5zaWduZWQgaW50IFN3YXRoV2lkdGhTaW5n
bGVEUFBZLAorCQlkb3VibGUgQnl0ZVBlclBpeGVsREVUWSwKKwkJZG91YmxlIEJ5dGVQZXJQaXhl
bERFVEMsCisJCXVuc2lnbmVkIGludCBTd2F0aEhlaWdodFksCisJCXVuc2lnbmVkIGludCBTd2F0
aEhlaWdodEMsCisJCWJvb2wgSW50ZXJsYWNlLAorCQlib29sIFByb2dyZXNzaXZlVG9JbnRlcmxh
Y2VVbml0SW5PUFAsCisJCWRvdWJsZSAqRFNUWEFmdGVyU2NhbGVyLAorCQlkb3VibGUgKkRTVFlB
ZnRlclNjYWxlcgorCQkpCit7CisJdW5zaWduZWQgaW50IERQUEN5Y2xlcywgRElTUENMS0N5Y2xl
czsKKwlkb3VibGUgRGF0YUZhYnJpY0xpbmVEZWxpdmVyeVRpbWVMdW1hOworCWRvdWJsZSBEYXRh
RmFicmljTGluZURlbGl2ZXJ5VGltZUNocm9tYTsKKwlkb3VibGUgRFNUVG90YWxQaXhlbHNBZnRl
clNjYWxlcjsKKworCURhdGFGYWJyaWNMaW5lRGVsaXZlcnlUaW1lTHVtYSA9IFN3YXRoV2lkdGhT
aW5nbGVEUFBZICogU3dhdGhIZWlnaHRZICogZG1sX2NlaWwoQnl0ZVBlclBpeGVsREVUWSwgMSkg
LyAobW9kZV9saWItPnZiYS5SZXR1cm5CVyAqIFJlYWRCYW5kd2lkdGhQbGFuZUx1bWEgLyBUb3Rh
bERhdGFSZWFkQmFuZHdpZHRoKTsKKwltb2RlX2xpYi0+dmJhLkxhc3RQaXhlbE9mTGluZUV4dHJh
V2F0ZXJtYXJrID0gZG1sX21heChtb2RlX2xpYi0+dmJhLkxhc3RQaXhlbE9mTGluZUV4dHJhV2F0
ZXJtYXJrLCBEYXRhRmFicmljTGluZURlbGl2ZXJ5VGltZUx1bWEgLSBEaXNwbGF5UGlwZUxpbmVE
ZWxpdmVyeVRpbWVMdW1hKTsKKworCWlmIChCeXRlUGVyUGl4ZWxERVRDICE9IDApIHsKKwkJRGF0
YUZhYnJpY0xpbmVEZWxpdmVyeVRpbWVDaHJvbWEgPSBTd2F0aFdpZHRoU2luZ2xlRFBQWSAvIDIg
KiBTd2F0aEhlaWdodEMgKiBkbWxfY2VpbChCeXRlUGVyUGl4ZWxERVRDLCAyKSAvIChtb2RlX2xp
Yi0+dmJhLlJldHVybkJXICogUmVhZEJhbmR3aWR0aFBsYW5lQ2hyb21hIC8gVG90YWxEYXRhUmVh
ZEJhbmR3aWR0aCk7CisJCW1vZGVfbGliLT52YmEuTGFzdFBpeGVsT2ZMaW5lRXh0cmFXYXRlcm1h
cmsgPSBkbWxfbWF4KG1vZGVfbGliLT52YmEuTGFzdFBpeGVsT2ZMaW5lRXh0cmFXYXRlcm1hcmss
IERhdGFGYWJyaWNMaW5lRGVsaXZlcnlUaW1lQ2hyb21hIC0gRGlzcGxheVBpcGVMaW5lRGVsaXZl
cnlUaW1lQ2hyb21hKTsKKwl9CisKKwlpZiAoU2NhbGVyRW5hYmxlZCkKKwkJRFBQQ3ljbGVzID0g
RFBQQ0xLRGVsYXlTdWJ0b3RhbCArIERQUENMS0RlbGF5U0NMOworCWVsc2UKKwkJRFBQQ3ljbGVz
ID0gRFBQQ0xLRGVsYXlTdWJ0b3RhbCArIERQUENMS0RlbGF5U0NMTEJPbmx5OworCisJRFBQQ3lj
bGVzID0gRFBQQ3ljbGVzICsgRFBQQ0xLRGVsYXlDTlZDRm9ybWF0ZXIgKyBOdW1iZXJPZkN1cnNv
cnMgKiBEUFBDTEtEZWxheUNOVkNDdXJzb3I7CisKKwlESVNQQ0xLQ3ljbGVzID0gRElTUENMS0Rl
bGF5U3VidG90YWw7CisKKwlpZiAoRFBQQ0xLID09IDAuMCB8fCBESVNQQ0xLID09IDAuMCkKKwkJ
cmV0dXJuIHRydWU7CisKKwkqRFNUWEFmdGVyU2NhbGVyID0gRFBQQ3ljbGVzICogUGl4ZWxDbG9j
ayAvIERQUENMSyArIERJU1BDTEtDeWNsZXMgKiBQaXhlbENsb2NrIC8gRElTUENMSworCQkJKyBE
U0NEZWxheTsKKworCWlmIChEUFBQZXJQbGFuZSA+IDEpCisJCSpEU1RYQWZ0ZXJTY2FsZXIgPSAq
RFNUWEFmdGVyU2NhbGVyICsgU2NhbGVyUmVjb3V0V2lkdGg7CisKKwlpZiAoT3V0cHV0Rm9ybWF0
ID09IGRtXzQyMCB8fCAoSW50ZXJsYWNlICYmIFByb2dyZXNzaXZlVG9JbnRlcmxhY2VVbml0SW5P
UFApKQorCQkqRFNUWUFmdGVyU2NhbGVyID0gMTsKKwllbHNlCisJCSpEU1RZQWZ0ZXJTY2FsZXIg
PSAwOworCisJRFNUVG90YWxQaXhlbHNBZnRlclNjYWxlciA9ICgoZG91YmxlKSAoKkRTVFlBZnRl
clNjYWxlciAqIEhUb3RhbCkpICsgKkRTVFhBZnRlclNjYWxlcjsKKwkqRFNUWUFmdGVyU2NhbGVy
ID0gZG1sX2Zsb29yKERTVFRvdGFsUGl4ZWxzQWZ0ZXJTY2FsZXIgLyBIVG90YWwsIDEpOworCSpE
U1RYQWZ0ZXJTY2FsZXIgPSBEU1RUb3RhbFBpeGVsc0FmdGVyU2NhbGVyIC0gKChkb3VibGUpICgq
RFNUWUFmdGVyU2NhbGVyICogSFRvdGFsKSk7CisKKwlyZXR1cm4gdHJ1ZTsKK30KKworc3RhdGlj
IGJvb2wgQ2FsY3VsYXRlUHJlZmV0Y2hTY2hlZHVsZSgKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9s
aWIgKm1vZGVfbGliLAorCQlkb3VibGUgRFBQQ0xLLAorCQlkb3VibGUgRElTUENMSywKKwkJZG91
YmxlIFBpeGVsQ2xvY2ssCisJCWRvdWJsZSBEQ0ZDTEtEZWVwU2xlZXAsCisJCXVuc2lnbmVkIGlu
dCBEUFBQZXJQbGFuZSwKKwkJdW5zaWduZWQgaW50IE51bWJlck9mQ3Vyc29ycywKKwkJdW5zaWdu
ZWQgaW50IFZCbGFuaywKKwkJdW5zaWduZWQgaW50IEhUb3RhbCwKKwkJdW5zaWduZWQgaW50IE1h
eEludGVyRENOVGlsZVJlcGVhdGVycywKKwkJdW5zaWduZWQgaW50IFZTdGFydHVwLAorCQl1bnNp
Z25lZCBpbnQgUGFnZVRhYmxlTGV2ZWxzLAorCQlib29sIEdQVVZNRW5hYmxlLAorCQlib29sIER5
bmFtaWNNZXRhZGF0YUVuYWJsZSwKKwkJdW5zaWduZWQgaW50IER5bmFtaWNNZXRhZGF0YUxpbmVz
QmVmb3JlQWN0aXZlUmVxdWlyZWQsCisJCXVuc2lnbmVkIGludCBEeW5hbWljTWV0YWRhdGFUcmFu
c21pdHRlZEJ5dGVzLAorCQlib29sIERDQ0VuYWJsZSwKKwkJZG91YmxlIFVyZ2VudExhdGVuY3lQ
aXhlbERhdGFPbmx5LAorCQlkb3VibGUgVXJnZW50RXh0cmFMYXRlbmN5LAorCQlkb3VibGUgVENh
bGMsCisJCXVuc2lnbmVkIGludCBQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZSwKKwkJdW5zaWduZWQg
aW50IE1ldGFSb3dCeXRlLAorCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVCeXRlc1BlclJvdywKKwkJ
ZG91YmxlIFByZWZldGNoU291cmNlTGluZXNZLAorCQl1bnNpZ25lZCBpbnQgU3dhdGhXaWR0aFks
CisJCWRvdWJsZSBCeXRlUGVyUGl4ZWxERVRZLAorCQlkb3VibGUgVkluaXRQcmVGaWxsWSwKKwkJ
dW5zaWduZWQgaW50IE1heE51bVN3YXRoWSwKKwkJZG91YmxlIFByZWZldGNoU291cmNlTGluZXND
LAorCQlkb3VibGUgQnl0ZVBlclBpeGVsREVUQywKKwkJZG91YmxlIFZJbml0UHJlRmlsbEMsCisJ
CXVuc2lnbmVkIGludCBNYXhOdW1Td2F0aEMsCisJCXVuc2lnbmVkIGludCBTd2F0aEhlaWdodFks
CisJCXVuc2lnbmVkIGludCBTd2F0aEhlaWdodEMsCisJCWRvdWJsZSBUV2FpdCwKKwkJYm9vbCBY
RkNFbmFibGVkLAorCQlkb3VibGUgWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSwKKwkJYm9vbCBJ
bnRlcmxhY2VFbmFibGUsCisJCWJvb2wgUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCwK
KwkJZG91YmxlIERTVFhBZnRlclNjYWxlciwKKwkJZG91YmxlIERTVFlBZnRlclNjYWxlciwKKwkJ
ZG91YmxlICpEZXN0aW5hdGlvbkxpbmVzRm9yUHJlZmV0Y2gsCisJCWRvdWJsZSAqUHJlZmV0Y2hC
YW5kd2lkdGgsCisJCWRvdWJsZSAqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxhbmss
CisJCWRvdWJsZSAqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rLAorCQlkb3Vi
bGUgKlZSYXRpb1ByZWZldGNoWSwKKwkJZG91YmxlICpWUmF0aW9QcmVmZXRjaEMsCisJCWRvdWJs
ZSAqUmVxdWlyZWRQcmVmZXRjaFBpeERhdGFCVywKKwkJZG91YmxlICpUbm9fYncsCisJCXVuc2ln
bmVkIGludCAqVlVwZGF0ZU9mZnNldFBpeCwKKwkJZG91YmxlICpWVXBkYXRlV2lkdGhQaXgsCisJ
CWRvdWJsZSAqVlJlYWR5T2Zmc2V0UGl4KQoreworCWJvb2wgTXlFcnJvciA9IGZhbHNlOworCWRv
dWJsZSBUb3RhbFJlcGVhdGVyRGVsYXlUaW1lOworCWRvdWJsZSBUZG0sIExpbmVUaW1lLCBUc2V0
dXA7CisJZG91YmxlIGRzdF95X3ByZWZldGNoX2VxdTsKKwlkb3VibGUgVHN3X290bzsKKwlkb3Vi
bGUgcHJlZmV0Y2hfYndfb3RvOworCWRvdWJsZSBUdm1fb3RvOworCWRvdWJsZSBUcjBfb3RvOwor
CWRvdWJsZSBUcHJlX290bzsKKwlkb3VibGUgZHN0X3lfcHJlZmV0Y2hfb3RvOworCWRvdWJsZSBU
aW1lRm9yRmV0Y2hpbmdNZXRhUFRFID0gMDsKKwlkb3VibGUgVGltZUZvckZldGNoaW5nUm93SW5W
QmxhbmsgPSAwOworCWRvdWJsZSBMaW5lc1RvUmVxdWVzdFByZWZldGNoUGl4ZWxEYXRhID0gMDsK
KworCSpWVXBkYXRlT2Zmc2V0UGl4ID0gZG1sX2NlaWwoSFRvdGFsIC8gNC4wLCAxKTsKKwlUb3Rh
bFJlcGVhdGVyRGVsYXlUaW1lID0gTWF4SW50ZXJEQ05UaWxlUmVwZWF0ZXJzICogKDIuMCAvIERQ
UENMSyArIDMuMCAvIERJU1BDTEspOworCSpWVXBkYXRlV2lkdGhQaXggPSAoMTQuMCAvIERDRkNM
S0RlZXBTbGVlcCArIDEyLjAgLyBEUFBDTEsgKyBUb3RhbFJlcGVhdGVyRGVsYXlUaW1lKQorCQkJ
KiBQaXhlbENsb2NrOworCisJKlZSZWFkeU9mZnNldFBpeCA9IGRtbF9tYXgoCisJCQkxNTAuMCAv
IERQUENMSywKKwkJCVRvdGFsUmVwZWF0ZXJEZWxheVRpbWUgKyAyMC4wIC8gRENGQ0xLRGVlcFNs
ZWVwICsgMTAuMCAvIERQUENMSykKKwkJCSogUGl4ZWxDbG9jazsKKworCVRzZXR1cCA9IChkb3Vi
bGUpICgqVlVwZGF0ZU9mZnNldFBpeCArICpWVXBkYXRlV2lkdGhQaXggKyAqVlJlYWR5T2Zmc2V0
UGl4KSAvIFBpeGVsQ2xvY2s7CisKKwlMaW5lVGltZSA9IChkb3VibGUpIEhUb3RhbCAvIFBpeGVs
Q2xvY2s7CisKKwlpZiAoRHluYW1pY01ldGFkYXRhRW5hYmxlKSB7CisJCWRvdWJsZSBUZG1iZiwg
VGRtZWMsIFRkbXNrczsKKworCQlUZG0gPSBkbWxfbWF4KDAuMCwgVXJnZW50RXh0cmFMYXRlbmN5
IC0gVENhbGMpOworCQlUZG1iZiA9IER5bmFtaWNNZXRhZGF0YVRyYW5zbWl0dGVkQnl0ZXMgLyA0
LjAgLyBESVNQQ0xLOworCQlUZG1lYyA9IExpbmVUaW1lOworCQlpZiAoRHluYW1pY01ldGFkYXRh
TGluZXNCZWZvcmVBY3RpdmVSZXF1aXJlZCA9PSAwKQorCQkJVGRtc2tzID0gVkJsYW5rICogTGlu
ZVRpbWUgLyAyLjA7CisJCWVsc2UKKwkJCVRkbXNrcyA9IER5bmFtaWNNZXRhZGF0YUxpbmVzQmVm
b3JlQWN0aXZlUmVxdWlyZWQgKiBMaW5lVGltZTsKKwkJaWYgKEludGVybGFjZUVuYWJsZSAmJiAh
UHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCkKKwkJCVRkbXNrcyA9IFRkbXNrcyAvIDI7
CisJCWlmIChWU3RhcnR1cCAqIExpbmVUaW1lCisJCQkJPCBUc2V0dXAgKyBUV2FpdCArIFVyZ2Vu
dEV4dHJhTGF0ZW5jeSArIFRkbWJmICsgVGRtZWMgKyBUZG1za3MpIHsKKwkJCU15RXJyb3IgPSB0
cnVlOworCQl9CisJfSBlbHNlCisJCVRkbSA9IDA7CisKKwlpZiAoR1BVVk1FbmFibGUpIHsKKwkJ
aWYgKFBhZ2VUYWJsZUxldmVscyA9PSA0KQorCQkJKlRub19idyA9IFVyZ2VudEV4dHJhTGF0ZW5j
eSArIFVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5OworCQllbHNlIGlmIChQYWdlVGFibGVMZXZl
bHMgPT0gMykKKwkJCSpUbm9fYncgPSBVcmdlbnRFeHRyYUxhdGVuY3k7CisJCWVsc2UKKwkJCSpU
bm9fYncgPSAwOworCX0gZWxzZSBpZiAoRENDRW5hYmxlKQorCQkqVG5vX2J3ID0gTGluZVRpbWU7
CisJZWxzZQorCQkqVG5vX2J3ID0gTGluZVRpbWUgLyA0OworCisJZHN0X3lfcHJlZmV0Y2hfZXF1
ID0gVlN0YXJ0dXAgLSBkbWxfbWF4KFRDYWxjICsgVFdhaXQsIFhGQ1JlbW90ZVN1cmZhY2VGbGlw
RGVsYXkpIC8gTGluZVRpbWUKKwkJCS0gKFRzZXR1cCArIFRkbSkgLyBMaW5lVGltZQorCQkJLSAo
RFNUWUFmdGVyU2NhbGVyICsgRFNUWEFmdGVyU2NhbGVyIC8gSFRvdGFsKTsKKworCVRzd19vdG8g
PSBkbWxfbWF4KFByZWZldGNoU291cmNlTGluZXNZLCBQcmVmZXRjaFNvdXJjZUxpbmVzQykgKiBM
aW5lVGltZTsKKworCXByZWZldGNoX2J3X290byA9IChNZXRhUm93Qnl0ZSArIFBpeGVsUFRFQnl0
ZXNQZXJSb3cKKwkJCSsgUHJlZmV0Y2hTb3VyY2VMaW5lc1kgKiBTd2F0aFdpZHRoWSAqIGRtbF9j
ZWlsKEJ5dGVQZXJQaXhlbERFVFksIDEpCisJCQkrIFByZWZldGNoU291cmNlTGluZXNDICogU3dh
dGhXaWR0aFkgLyAyICogZG1sX2NlaWwoQnl0ZVBlclBpeGVsREVUQywgMikpCisJCQkvIFRzd19v
dG87CisKKwlpZiAoR1BVVk1FbmFibGUgPT0gdHJ1ZSkgeworCQlUdm1fb3RvID0KKwkJCQlkbWxf
bWF4KAorCQkJCQkJKlRub19idyArIFBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lIC8gcHJlZmV0Y2hf
Yndfb3RvLAorCQkJCQkJZG1sX21heCgKKwkJCQkJCQkJVXJnZW50RXh0cmFMYXRlbmN5CisJCQkJ
CQkJCQkJKyBVcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seQorCQkJCQkJCQkJCQkJKiAoUGFnZVRh
YmxlTGV2ZWxzCisJCQkJCQkJCQkJCQkJCS0gMSksCisJCQkJCQkJCUxpbmVUaW1lIC8gNC4wKSk7
CisJfSBlbHNlCisJCVR2bV9vdG8gPSBMaW5lVGltZSAvIDQuMDsKKworCWlmICgoR1BVVk1FbmFi
bGUgPT0gdHJ1ZSB8fCBEQ0NFbmFibGUgPT0gdHJ1ZSkpIHsKKwkJVHIwX290byA9IGRtbF9tYXgo
CisJCQkJKE1ldGFSb3dCeXRlICsgUGl4ZWxQVEVCeXRlc1BlclJvdykgLyBwcmVmZXRjaF9id19v
dG8sCisJCQkJZG1sX21heChVcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seSwgZG1sX21heChMaW5l
VGltZSAtIFR2bV9vdG8sIExpbmVUaW1lIC8gNCkpKTsKKwl9IGVsc2UKKwkJVHIwX290byA9IExp
bmVUaW1lIC0gVHZtX290bzsKKworCVRwcmVfb3RvID0gVHZtX290byArIFRyMF9vdG8gKyBUc3df
b3RvOworCisJZHN0X3lfcHJlZmV0Y2hfb3RvID0gVHByZV9vdG8gLyBMaW5lVGltZTsKKworCWlm
IChkc3RfeV9wcmVmZXRjaF9vdG8gPCBkc3RfeV9wcmVmZXRjaF9lcXUpCisJCSpEZXN0aW5hdGlv
bkxpbmVzRm9yUHJlZmV0Y2ggPSBkc3RfeV9wcmVmZXRjaF9vdG87CisJZWxzZQorCQkqRGVzdGlu
YXRpb25MaW5lc0ZvclByZWZldGNoID0gZHN0X3lfcHJlZmV0Y2hfZXF1OworCisJKkRlc3RpbmF0
aW9uTGluZXNGb3JQcmVmZXRjaCA9IGRtbF9mbG9vcig0LjAgKiAoKkRlc3RpbmF0aW9uTGluZXNG
b3JQcmVmZXRjaCArIDAuMTI1KSwgMSkKKwkJCS8gNDsKKworCWRtbF9wcmludCgiRE1MOiBWU3Rh
cnR1cDogJWRcbiIsIFZTdGFydHVwKTsKKwlkbWxfcHJpbnQoIkRNTDogVENhbGM6ICVmXG4iLCBU
Q2FsYyk7CisJZG1sX3ByaW50KCJETUw6IFRXYWl0OiAlZlxuIiwgVFdhaXQpOworCWRtbF9wcmlu
dCgiRE1MOiBYRkNSZW1vdGVTdXJmYWNlRmxpcERlbGF5OiAlZlxuIiwgWEZDUmVtb3RlU3VyZmFj
ZUZsaXBEZWxheSk7CisJZG1sX3ByaW50KCJETUw6IExpbmVUaW1lOiAlZlxuIiwgTGluZVRpbWUp
OworCWRtbF9wcmludCgiRE1MOiBUc2V0dXA6ICVmXG4iLCBUc2V0dXApOworCWRtbF9wcmludCgi
RE1MOiBUZG06ICVmXG4iLCBUZG0pOworCWRtbF9wcmludCgiRE1MOiBEU1RZQWZ0ZXJTY2FsZXI6
ICVmXG4iLCBEU1RZQWZ0ZXJTY2FsZXIpOworCWRtbF9wcmludCgiRE1MOiBEU1RYQWZ0ZXJTY2Fs
ZXI6ICVmXG4iLCBEU1RYQWZ0ZXJTY2FsZXIpOworCWRtbF9wcmludCgiRE1MOiBIVG90YWw6ICVk
XG4iLCBIVG90YWwpOworCisJKlByZWZldGNoQmFuZHdpZHRoID0gMDsKKwkqRGVzdGluYXRpb25M
aW5lc1RvUmVxdWVzdFZNSW5WQmxhbmsgPSAwOworCSpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0
Um93SW5WQmxhbmsgPSAwOworCSpWUmF0aW9QcmVmZXRjaFkgPSAwOworCSpWUmF0aW9QcmVmZXRj
aEMgPSAwOworCSpSZXF1aXJlZFByZWZldGNoUGl4RGF0YUJXID0gMDsKKwlpZiAoKkRlc3RpbmF0
aW9uTGluZXNGb3JQcmVmZXRjaCA+IDEpIHsKKwkJKlByZWZldGNoQmFuZHdpZHRoID0gKFBERUFu
ZE1ldGFQVEVCeXRlc0ZyYW1lICsgMiAqIE1ldGFSb3dCeXRlCisJCQkJKyAyICogUGl4ZWxQVEVC
eXRlc1BlclJvdworCQkJCSsgUHJlZmV0Y2hTb3VyY2VMaW5lc1kgKiBTd2F0aFdpZHRoWSAqIGRt
bF9jZWlsKEJ5dGVQZXJQaXhlbERFVFksIDEpCisJCQkJKyBQcmVmZXRjaFNvdXJjZUxpbmVzQyAq
IFN3YXRoV2lkdGhZIC8gMgorCQkJCQkJKiBkbWxfY2VpbChCeXRlUGVyUGl4ZWxERVRDLCAyKSkK
KwkJCQkvICgqRGVzdGluYXRpb25MaW5lc0ZvclByZWZldGNoICogTGluZVRpbWUgLSAqVG5vX2J3
KTsKKwkJaWYgKEdQVVZNRW5hYmxlKSB7CisJCQlUaW1lRm9yRmV0Y2hpbmdNZXRhUFRFID0KKwkJ
CQkJZG1sX21heCgKKwkJCQkJCQkqVG5vX2J3CisJCQkJCQkJCQkrIChkb3VibGUpIFBERUFuZE1l
dGFQVEVCeXRlc0ZyYW1lCisJCQkJCQkJCQkJCS8gKlByZWZldGNoQmFuZHdpZHRoLAorCQkJCQkJ
CWRtbF9tYXgoCisJCQkJCQkJCQlVcmdlbnRFeHRyYUxhdGVuY3kKKwkJCQkJCQkJCQkJKyBVcmdl
bnRMYXRlbmN5UGl4ZWxEYXRhT25seQorCQkJCQkJCQkJCQkJCSogKFBhZ2VUYWJsZUxldmVscwor
CQkJCQkJCQkJCQkJCQkJLSAxKSwKKwkJCQkJCQkJCUxpbmVUaW1lIC8gNCkpOworCQl9IGVsc2Ug
eworCQkJaWYgKE51bWJlck9mQ3Vyc29ycyA+IDAgfHwgWEZDRW5hYmxlZCkKKwkJCQlUaW1lRm9y
RmV0Y2hpbmdNZXRhUFRFID0gTGluZVRpbWUgLyA0OworCQkJZWxzZQorCQkJCVRpbWVGb3JGZXRj
aGluZ01ldGFQVEUgPSAwLjA7CisJCX0KKworCQlpZiAoKEdQVVZNRW5hYmxlID09IHRydWUgfHwg
RENDRW5hYmxlID09IHRydWUpKSB7CisJCQlUaW1lRm9yRmV0Y2hpbmdSb3dJblZCbGFuayA9CisJ
CQkJCWRtbF9tYXgoCisJCQkJCQkJKE1ldGFSb3dCeXRlICsgUGl4ZWxQVEVCeXRlc1BlclJvdykK
KwkJCQkJCQkJCS8gKlByZWZldGNoQmFuZHdpZHRoLAorCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJ
CQlVcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seSwKKwkJCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJ
CQkJCUxpbmVUaW1lCisJCQkJCQkJCQkJCQkJLSBUaW1lRm9yRmV0Y2hpbmdNZXRhUFRFLAorCQkJ
CQkJCQkJCQlMaW5lVGltZQorCQkJCQkJCQkJCQkJCS8gNC4wKSkpOworCQl9IGVsc2UgeworCQkJ
aWYgKE51bWJlck9mQ3Vyc29ycyA+IDAgfHwgWEZDRW5hYmxlZCkKKwkJCQlUaW1lRm9yRmV0Y2hp
bmdSb3dJblZCbGFuayA9IExpbmVUaW1lIC0gVGltZUZvckZldGNoaW5nTWV0YVBURTsKKwkJCWVs
c2UKKwkJCQlUaW1lRm9yRmV0Y2hpbmdSb3dJblZCbGFuayA9IDAuMDsKKwkJfQorCisJCSpEZXN0
aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JblZCbGFuayA9IGRtbF9mbG9vcigKKwkJCQk0LjAgKiAo
VGltZUZvckZldGNoaW5nTWV0YVBURSAvIExpbmVUaW1lICsgMC4xMjUpLAorCQkJCTEpIC8gNC4w
OworCisJCSpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5WQmxhbmsgPSBkbWxfZmxvb3Io
CisJCQkJNC4wICogKFRpbWVGb3JGZXRjaGluZ1Jvd0luVkJsYW5rIC8gTGluZVRpbWUgKyAwLjEy
NSksCisJCQkJMSkgLyA0LjA7CisKKwkJTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0YSA9
CisJCQkJKkRlc3RpbmF0aW9uTGluZXNGb3JQcmVmZXRjaAorCQkJCQkJLSAoKE51bWJlck9mQ3Vy
c29ycyA+IDAgfHwgR1BVVk1FbmFibGUKKwkJCQkJCQkJfHwgRENDRW5hYmxlKSA/CisJCQkJCQkJ
CSgqRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxhbmsKKwkJCQkJCQkJCQkrICpEZXN0
aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5WQmxhbmspIDoKKwkJCQkJCQkJMC4wKTsKKworCQlp
ZiAoTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0YSA+IDApIHsKKworCQkJKlZSYXRpb1By
ZWZldGNoWSA9IChkb3VibGUpIFByZWZldGNoU291cmNlTGluZXNZCisJCQkJCS8gTGluZXNUb1Jl
cXVlc3RQcmVmZXRjaFBpeGVsRGF0YTsKKwkJCSpWUmF0aW9QcmVmZXRjaFkgPSBkbWxfbWF4KCpW
UmF0aW9QcmVmZXRjaFksIDEuMCk7CisJCQlpZiAoKFN3YXRoSGVpZ2h0WSA+IDQpICYmIChWSW5p
dFByZUZpbGxZID4gMykpIHsKKwkJCQlpZiAoTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0
YSA+IChWSW5pdFByZUZpbGxZIC0gMy4wKSAvIDIuMCkgeworCQkJCQkqVlJhdGlvUHJlZmV0Y2hZ
ID0KKwkJCQkJCQlkbWxfbWF4KAorCQkJCQkJCQkJKGRvdWJsZSkgUHJlZmV0Y2hTb3VyY2VMaW5l
c1kKKwkJCQkJCQkJCQkJLyBMaW5lc1RvUmVxdWVzdFByZWZldGNoUGl4ZWxEYXRhLAorCQkJCQkJ
CQkJKGRvdWJsZSkgTWF4TnVtU3dhdGhZCisJCQkJCQkJCQkJCSogU3dhdGhIZWlnaHRZCisJCQkJ
CQkJCQkJCS8gKExpbmVzVG9SZXF1ZXN0UHJlZmV0Y2hQaXhlbERhdGEKKwkJCQkJCQkJCQkJCQkt
IChWSW5pdFByZUZpbGxZCisJCQkJCQkJCQkJCQkJCQktIDMuMCkKKwkJCQkJCQkJCQkJCQkJCS8g
Mi4wKSk7CisJCQkJCSpWUmF0aW9QcmVmZXRjaFkgPSBkbWxfbWF4KCpWUmF0aW9QcmVmZXRjaFks
IDEuMCk7CisJCQkJfSBlbHNlIHsKKwkJCQkJTXlFcnJvciA9IHRydWU7CisJCQkJCSpWUmF0aW9Q
cmVmZXRjaFkgPSAwOworCQkJCX0KKwkJCX0KKworCQkJKlZSYXRpb1ByZWZldGNoQyA9IChkb3Vi
bGUpIFByZWZldGNoU291cmNlTGluZXNDCisJCQkJCS8gTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBp
eGVsRGF0YTsKKwkJCSpWUmF0aW9QcmVmZXRjaEMgPSBkbWxfbWF4KCpWUmF0aW9QcmVmZXRjaEMs
IDEuMCk7CisKKwkJCWlmICgoU3dhdGhIZWlnaHRDID4gNCkpIHsKKwkJCQlpZiAoTGluZXNUb1Jl
cXVlc3RQcmVmZXRjaFBpeGVsRGF0YSA+IChWSW5pdFByZUZpbGxDIC0gMy4wKSAvIDIuMCkgewor
CQkJCQkqVlJhdGlvUHJlZmV0Y2hDID0KKwkJCQkJCQlkbWxfbWF4KAorCQkJCQkJCQkJKlZSYXRp
b1ByZWZldGNoQywKKwkJCQkJCQkJCShkb3VibGUpIE1heE51bVN3YXRoQworCQkJCQkJCQkJCQkq
IFN3YXRoSGVpZ2h0QworCQkJCQkJCQkJCQkvIChMaW5lc1RvUmVxdWVzdFByZWZldGNoUGl4ZWxE
YXRhCisJCQkJCQkJCQkJCQkJLSAoVkluaXRQcmVGaWxsQworCQkJCQkJCQkJCQkJCQkJLSAzLjAp
CisJCQkJCQkJCQkJCQkJCQkvIDIuMCkpOworCQkJCQkqVlJhdGlvUHJlZmV0Y2hDID0gZG1sX21h
eCgqVlJhdGlvUHJlZmV0Y2hDLCAxLjApOworCQkJCX0gZWxzZSB7CisJCQkJCU15RXJyb3IgPSB0
cnVlOworCQkJCQkqVlJhdGlvUHJlZmV0Y2hDID0gMDsKKwkJCQl9CisJCQl9CisKKwkJCSpSZXF1
aXJlZFByZWZldGNoUGl4RGF0YUJXID0KKwkJCQkJRFBQUGVyUGxhbmUKKwkJCQkJCQkqICgoZG91
YmxlKSBQcmVmZXRjaFNvdXJjZUxpbmVzWQorCQkJCQkJCQkJLyBMaW5lc1RvUmVxdWVzdFByZWZl
dGNoUGl4ZWxEYXRhCisJCQkJCQkJCQkqIGRtbF9jZWlsKAorCQkJCQkJCQkJCQlCeXRlUGVyUGl4
ZWxERVRZLAorCQkJCQkJCQkJCQkxKQorCQkJCQkJCQkJKyAoZG91YmxlKSBQcmVmZXRjaFNvdXJj
ZUxpbmVzQworCQkJCQkJCQkJCQkvIExpbmVzVG9SZXF1ZXN0UHJlZmV0Y2hQaXhlbERhdGEKKwkJ
CQkJCQkJCQkJKiBkbWxfY2VpbCgKKwkJCQkJCQkJCQkJCQlCeXRlUGVyUGl4ZWxERVRDLAorCQkJ
CQkJCQkJCQkJCTIpCisJCQkJCQkJCQkJCS8gMikKKwkJCQkJCQkqIFN3YXRoV2lkdGhZIC8gTGlu
ZVRpbWU7CisJCX0gZWxzZSB7CisJCQlNeUVycm9yID0gdHJ1ZTsKKwkJCSpWUmF0aW9QcmVmZXRj
aFkgPSAwOworCQkJKlZSYXRpb1ByZWZldGNoQyA9IDA7CisJCQkqUmVxdWlyZWRQcmVmZXRjaFBp
eERhdGFCVyA9IDA7CisJCX0KKworCX0gZWxzZSB7CisJCU15RXJyb3IgPSB0cnVlOworCX0KKwor
CWlmIChNeUVycm9yKSB7CisJCSpQcmVmZXRjaEJhbmR3aWR0aCA9IDA7CisJCVRpbWVGb3JGZXRj
aGluZ01ldGFQVEUgPSAwOworCQlUaW1lRm9yRmV0Y2hpbmdSb3dJblZCbGFuayA9IDA7CisJCSpE
ZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JblZCbGFuayA9IDA7CisJCSpEZXN0aW5hdGlvbkxp
bmVzVG9SZXF1ZXN0Um93SW5WQmxhbmsgPSAwOworCQkqRGVzdGluYXRpb25MaW5lc0ZvclByZWZl
dGNoID0gMDsKKwkJTGluZXNUb1JlcXVlc3RQcmVmZXRjaFBpeGVsRGF0YSA9IDA7CisJCSpWUmF0
aW9QcmVmZXRjaFkgPSAwOworCQkqVlJhdGlvUHJlZmV0Y2hDID0gMDsKKwkJKlJlcXVpcmVkUHJl
ZmV0Y2hQaXhEYXRhQlcgPSAwOworCX0KKworCXJldHVybiBNeUVycm9yOworfQorCitzdGF0aWMg
ZG91YmxlIFJvdW5kVG9ERlNHcmFudWxhcml0eVVwKGRvdWJsZSBDbG9jaywgZG91YmxlIFZDT1Nw
ZWVkKQoreworCXJldHVybiBWQ09TcGVlZCAqIDQgLyBkbWxfZmxvb3IoVkNPU3BlZWQgKiA0IC8g
Q2xvY2ssIDEpOworfQorCitzdGF0aWMgZG91YmxlIFJvdW5kVG9ERlNHcmFudWxhcml0eURvd24o
ZG91YmxlIENsb2NrLCBkb3VibGUgVkNPU3BlZWQpCit7CisJcmV0dXJuIFZDT1NwZWVkICogNCAv
IGRtbF9jZWlsKFZDT1NwZWVkICogNCAvIENsb2NrLCAxKTsKK30KKworc3RhdGljIGRvdWJsZSBD
YWxjdWxhdGVQcmVmZXRjaFNvdXJjZUxpbmVzKAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAq
bW9kZV9saWIsCisJCWRvdWJsZSBWUmF0aW8sCisJCWRvdWJsZSB2dGFwcywKKwkJYm9vbCBJbnRl
cmxhY2UsCisJCWJvb2wgUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCwKKwkJdW5zaWdu
ZWQgaW50IFN3YXRoSGVpZ2h0LAorCQl1bnNpZ25lZCBpbnQgVmlld3BvcnRZU3RhcnQsCisJCWRv
dWJsZSAqVkluaXRQcmVGaWxsLAorCQl1bnNpZ25lZCBpbnQgKk1heE51bVN3YXRoKQoreworCXVu
c2lnbmVkIGludCBNYXhQYXJ0aWFsU3dhdGg7CisKKwlpZiAoUHJvZ3Jlc3NpdmVUb0ludGVybGFj
ZVVuaXRJbk9QUCkKKwkJKlZJbml0UHJlRmlsbCA9IGRtbF9mbG9vcigoVlJhdGlvICsgdnRhcHMg
KyAxKSAvIDIuMCwgMSk7CisJZWxzZQorCQkqVkluaXRQcmVGaWxsID0gZG1sX2Zsb29yKChWUmF0
aW8gKyB2dGFwcyArIDEgKyBJbnRlcmxhY2UgKiAwLjUgKiBWUmF0aW8pIC8gMi4wLCAxKTsKKwor
CWlmICghbW9kZV9saWItPnZiYS5JZ25vcmVWaWV3cG9ydFBvc2l0aW9uaW5nKSB7CisKKwkJKk1h
eE51bVN3YXRoID0gZG1sX2NlaWwoKCpWSW5pdFByZUZpbGwgLSAxLjApIC8gU3dhdGhIZWlnaHQs
IDEpICsgMS4wOworCisJCWlmICgqVkluaXRQcmVGaWxsID4gMS4wKQorCQkJTWF4UGFydGlhbFN3
YXRoID0gKHVuc2lnbmVkIGludCkgKCpWSW5pdFByZUZpbGwgLSAyKSAlIFN3YXRoSGVpZ2h0Owor
CQllbHNlCisJCQlNYXhQYXJ0aWFsU3dhdGggPSAodW5zaWduZWQgaW50KSAoKlZJbml0UHJlRmls
bCArIFN3YXRoSGVpZ2h0IC0gMikKKwkJCQkJJSBTd2F0aEhlaWdodDsKKwkJTWF4UGFydGlhbFN3
YXRoID0gZG1sX21heCgxVSwgTWF4UGFydGlhbFN3YXRoKTsKKworCX0gZWxzZSB7CisKKwkJaWYg
KFZpZXdwb3J0WVN0YXJ0ICE9IDApCisJCQlkbWxfcHJpbnQoCisJCQkJCSJXQVJOSU5HIERNTDog
dXNpbmcgdmlld3BvcnQgeSBwb3NpdGlvbiBvZiAwIGV2ZW4gdGhvdWdoIGFjdHVhbCB2aWV3cG9y
dCB5IHBvc2l0aW9uIGlzIG5vbi16ZXJvIGluIHByZWZldGNoIHNvdXJjZSBsaW5lcyBjYWxjdWxh
dGlvblxuIik7CisKKwkJKk1heE51bVN3YXRoID0gZG1sX2NlaWwoKlZJbml0UHJlRmlsbCAvIFN3
YXRoSGVpZ2h0LCAxKTsKKworCQlpZiAoKlZJbml0UHJlRmlsbCA+IDEuMCkKKwkJCU1heFBhcnRp
YWxTd2F0aCA9ICh1bnNpZ25lZCBpbnQpICgqVkluaXRQcmVGaWxsIC0gMSkgJSBTd2F0aEhlaWdo
dDsKKwkJZWxzZQorCQkJTWF4UGFydGlhbFN3YXRoID0gKHVuc2lnbmVkIGludCkgKCpWSW5pdFBy
ZUZpbGwgKyBTd2F0aEhlaWdodCAtIDEpCisJCQkJCSUgU3dhdGhIZWlnaHQ7CisJfQorCisJcmV0
dXJuICpNYXhOdW1Td2F0aCAqIFN3YXRoSGVpZ2h0ICsgTWF4UGFydGlhbFN3YXRoOworfQorCitz
dGF0aWMgdW5zaWduZWQgaW50IENhbGN1bGF0ZVZNQW5kUm93Qnl0ZXMoCisJCXN0cnVjdCBkaXNw
bGF5X21vZGVfbGliICptb2RlX2xpYiwKKwkJYm9vbCBEQ0NFbmFibGUsCisJCXVuc2lnbmVkIGlu
dCBCbG9ja0hlaWdodDI1NkJ5dGVzLAorCQl1bnNpZ25lZCBpbnQgQmxvY2tXaWR0aDI1NkJ5dGVz
LAorCQllbnVtIHNvdXJjZV9mb3JtYXRfY2xhc3MgU291cmNlUGl4ZWxGb3JtYXQsCisJCXVuc2ln
bmVkIGludCBTdXJmYWNlVGlsaW5nLAorCQl1bnNpZ25lZCBpbnQgQnl0ZVBlclBpeGVsLAorCQll
bnVtIHNjYW5fZGlyZWN0aW9uX2NsYXNzIFNjYW5EaXJlY3Rpb24sCisJCXVuc2lnbmVkIGludCBW
aWV3cG9ydFdpZHRoLAorCQl1bnNpZ25lZCBpbnQgVmlld3BvcnRIZWlnaHQsCisJCXVuc2lnbmVk
IGludCBTd2F0aFdpZHRoLAorCQlib29sIEdQVVZNRW5hYmxlLAorCQl1bnNpZ25lZCBpbnQgVk1N
UGFnZVNpemUsCisJCXVuc2lnbmVkIGludCBQVEVCdWZmZXJTaXplSW5SZXF1ZXN0c0x1bWEsCisJ
CXVuc2lnbmVkIGludCBQREVQcm9jZXNzaW5nQnVmSW42NEtCUmVxcywKKwkJdW5zaWduZWQgaW50
IFBpdGNoLAorCQl1bnNpZ25lZCBpbnQgRENDTWV0YVBpdGNoLAorCQl1bnNpZ25lZCBpbnQgKk1h
Y3JvVGlsZVdpZHRoLAorCQl1bnNpZ25lZCBpbnQgKk1ldGFSb3dCeXRlLAorCQl1bnNpZ25lZCBp
bnQgKlBpeGVsUFRFQnl0ZXNQZXJSb3csCisJCWJvb2wgKlBURUJ1ZmZlclNpemVOb3RFeGNlZWRl
ZCwKKwkJdW5zaWduZWQgaW50ICpkcHRlX3Jvd19oZWlnaHQsCisJCXVuc2lnbmVkIGludCAqbWV0
YV9yb3dfaGVpZ2h0KQoreworCXVuc2lnbmVkIGludCBNZXRhUmVxdWVzdEhlaWdodDsKKwl1bnNp
Z25lZCBpbnQgTWV0YVJlcXVlc3RXaWR0aDsKKwl1bnNpZ25lZCBpbnQgTWV0YVN1cmZXaWR0aDsK
Kwl1bnNpZ25lZCBpbnQgTWV0YVN1cmZIZWlnaHQ7CisJdW5zaWduZWQgaW50IE1QREVCeXRlc0Zy
YW1lOworCXVuc2lnbmVkIGludCBNZXRhUFRFQnl0ZXNGcmFtZTsKKwl1bnNpZ25lZCBpbnQgREND
TWV0YVN1cmZhY2VCeXRlczsKKworCXVuc2lnbmVkIGludCBNYWNyb1RpbGVTaXplQnl0ZXM7CisJ
dW5zaWduZWQgaW50IE1hY3JvVGlsZUhlaWdodDsKKwl1bnNpZ25lZCBpbnQgRFBERTBCeXRlc0Zy
YW1lOworCXVuc2lnbmVkIGludCBFeHRyYURQREVCeXRlc0ZyYW1lOworCXVuc2lnbmVkIGludCBQ
REVBbmRNZXRhUFRFQnl0ZXNGcmFtZTsKKworCWlmIChEQ0NFbmFibGUgPT0gdHJ1ZSkgeworCQlN
ZXRhUmVxdWVzdEhlaWdodCA9IDggKiBCbG9ja0hlaWdodDI1NkJ5dGVzOworCQlNZXRhUmVxdWVz
dFdpZHRoID0gOCAqIEJsb2NrV2lkdGgyNTZCeXRlczsKKwkJaWYgKFNjYW5EaXJlY3Rpb24gPT0g
ZG1faG9yeikgeworCQkJKm1ldGFfcm93X2hlaWdodCA9IE1ldGFSZXF1ZXN0SGVpZ2h0OworCQkJ
TWV0YVN1cmZXaWR0aCA9IGRtbF9jZWlsKChkb3VibGUpIFN3YXRoV2lkdGggLSAxLCBNZXRhUmVx
dWVzdFdpZHRoKQorCQkJCQkrIE1ldGFSZXF1ZXN0V2lkdGg7CisJCQkqTWV0YVJvd0J5dGUgPSBN
ZXRhU3VyZldpZHRoICogTWV0YVJlcXVlc3RIZWlnaHQgKiBCeXRlUGVyUGl4ZWwgLyAyNTYuMDsK
KwkJfSBlbHNlIHsKKwkJCSptZXRhX3Jvd19oZWlnaHQgPSBNZXRhUmVxdWVzdFdpZHRoOworCQkJ
TWV0YVN1cmZIZWlnaHQgPSBkbWxfY2VpbCgoZG91YmxlKSBTd2F0aFdpZHRoIC0gMSwgTWV0YVJl
cXVlc3RIZWlnaHQpCisJCQkJCSsgTWV0YVJlcXVlc3RIZWlnaHQ7CisJCQkqTWV0YVJvd0J5dGUg
PSBNZXRhU3VyZkhlaWdodCAqIE1ldGFSZXF1ZXN0V2lkdGggKiBCeXRlUGVyUGl4ZWwgLyAyNTYu
MDsKKwkJfQorCQlpZiAoU2NhbkRpcmVjdGlvbiA9PSBkbV9ob3J6KSB7CisJCQlEQ0NNZXRhU3Vy
ZmFjZUJ5dGVzID0gRENDTWV0YVBpdGNoCisJCQkJCSogKGRtbF9jZWlsKFZpZXdwb3J0SGVpZ2h0
IC0gMSwgNjQgKiBCbG9ja0hlaWdodDI1NkJ5dGVzKQorCQkJCQkJCSsgNjQgKiBCbG9ja0hlaWdo
dDI1NkJ5dGVzKSAqIEJ5dGVQZXJQaXhlbAorCQkJCQkvIDI1NjsKKwkJfSBlbHNlIHsKKwkJCURD
Q01ldGFTdXJmYWNlQnl0ZXMgPSBEQ0NNZXRhUGl0Y2gKKwkJCQkJKiAoZG1sX2NlaWwoCisJCQkJ
CQkJKGRvdWJsZSkgVmlld3BvcnRIZWlnaHQgLSAxLAorCQkJCQkJCTY0ICogQmxvY2tIZWlnaHQy
NTZCeXRlcykKKwkJCQkJCQkrIDY0ICogQmxvY2tIZWlnaHQyNTZCeXRlcykgKiBCeXRlUGVyUGl4
ZWwKKwkJCQkJLyAyNTY7CisJCX0KKwkJaWYgKEdQVVZNRW5hYmxlID09IHRydWUpIHsKKwkJCU1l
dGFQVEVCeXRlc0ZyYW1lID0gKGRtbF9jZWlsKAorCQkJCQkoZG91YmxlKSAoRENDTWV0YVN1cmZh
Y2VCeXRlcyAtIFZNTVBhZ2VTaXplKQorCQkJCQkJCS8gKDggKiBWTU1QYWdlU2l6ZSksCisJCQkJ
CTEpICsgMSkgKiA2NDsKKwkJCU1QREVCeXRlc0ZyYW1lID0gMTI4ICogKG1vZGVfbGliLT52YmEu
R1BVVk1NYXhQYWdlVGFibGVMZXZlbHMgLSAxKTsKKwkJfSBlbHNlIHsKKwkJCU1ldGFQVEVCeXRl
c0ZyYW1lID0gMDsKKwkJCU1QREVCeXRlc0ZyYW1lID0gMDsKKwkJfQorCX0gZWxzZSB7CisJCU1l
dGFQVEVCeXRlc0ZyYW1lID0gMDsKKwkJTVBERUJ5dGVzRnJhbWUgPSAwOworCQkqTWV0YVJvd0J5
dGUgPSAwOworCX0KKworCWlmIChTdXJmYWNlVGlsaW5nID09IGRtX3N3X2xpbmVhciB8fCBTdXJm
YWNlVGlsaW5nID09IGRtX3N3X2dmeDdfMmRfdGhpbl9nbCB8fCBTdXJmYWNlVGlsaW5nID09IGRt
X3N3X2dmeDdfMmRfdGhpbl9sdnApIHsKKwkJTWFjcm9UaWxlU2l6ZUJ5dGVzID0gMjU2OworCQlN
YWNyb1RpbGVIZWlnaHQgPSBCbG9ja0hlaWdodDI1NkJ5dGVzOworCX0gZWxzZSBpZiAoU3VyZmFj
ZVRpbGluZyA9PSBkbV9zd180a2JfcyB8fCBTdXJmYWNlVGlsaW5nID09IGRtX3N3XzRrYl9zX3gK
KwkJCXx8IFN1cmZhY2VUaWxpbmcgPT0gZG1fc3dfNGtiX2QgfHwgU3VyZmFjZVRpbGluZyA9PSBk
bV9zd180a2JfZF94KSB7CisJCU1hY3JvVGlsZVNpemVCeXRlcyA9IDQwOTY7CisJCU1hY3JvVGls
ZUhlaWdodCA9IDQgKiBCbG9ja0hlaWdodDI1NkJ5dGVzOworCX0gZWxzZSBpZiAoU3VyZmFjZVRp
bGluZyA9PSBkbV9zd182NGtiX3MgfHwgU3VyZmFjZVRpbGluZyA9PSBkbV9zd182NGtiX3NfdAor
CQkJfHwgU3VyZmFjZVRpbGluZyA9PSBkbV9zd182NGtiX3NfeCB8fCBTdXJmYWNlVGlsaW5nID09
IGRtX3N3XzY0a2JfZAorCQkJfHwgU3VyZmFjZVRpbGluZyA9PSBkbV9zd182NGtiX2RfdCB8fCBT
dXJmYWNlVGlsaW5nID09IGRtX3N3XzY0a2JfZF94CisJCQl8fCBTdXJmYWNlVGlsaW5nID09IGRt
X3N3XzY0a2Jfcl94KSB7CisJCU1hY3JvVGlsZVNpemVCeXRlcyA9IDY1NTM2OworCQlNYWNyb1Rp
bGVIZWlnaHQgPSAxNiAqIEJsb2NrSGVpZ2h0MjU2Qnl0ZXM7CisJfSBlbHNlIHsKKwkJTWFjcm9U
aWxlU2l6ZUJ5dGVzID0gMjYyMTQ0OworCQlNYWNyb1RpbGVIZWlnaHQgPSAzMiAqIEJsb2NrSGVp
Z2h0MjU2Qnl0ZXM7CisJfQorCSpNYWNyb1RpbGVXaWR0aCA9IE1hY3JvVGlsZVNpemVCeXRlcyAv
IEJ5dGVQZXJQaXhlbCAvIE1hY3JvVGlsZUhlaWdodDsKKworCWlmIChHUFVWTUVuYWJsZSA9PSB0
cnVlICYmIG1vZGVfbGliLT52YmEuR1BVVk1NYXhQYWdlVGFibGVMZXZlbHMgPiAxKSB7CisJCWlm
IChTY2FuRGlyZWN0aW9uID09IGRtX2hvcnopIHsKKwkJCURQREUwQnl0ZXNGcmFtZSA9CisJCQkJ
CTY0CisJCQkJCQkJKiAoZG1sX2NlaWwoCisJCQkJCQkJCQkoKFBpdGNoCisJCQkJCQkJCQkJCSog
KGRtbF9jZWlsKAorCQkJCQkJCQkJCQkJCVZpZXdwb3J0SGVpZ2h0CisJCQkJCQkJCQkJCQkJCQkt
IDEsCisJCQkJCQkJCQkJCQkJTWFjcm9UaWxlSGVpZ2h0KQorCQkJCQkJCQkJCQkJCSsgTWFjcm9U
aWxlSGVpZ2h0KQorCQkJCQkJCQkJCQkqIEJ5dGVQZXJQaXhlbCkKKwkJCQkJCQkJCQkJLSBNYWNy
b1RpbGVTaXplQnl0ZXMpCisJCQkJCQkJCQkJCS8gKDgKKwkJCQkJCQkJCQkJCQkqIDIwOTcxNTIp
LAorCQkJCQkJCQkJMSkgKyAxKTsKKwkJfSBlbHNlIHsKKwkJCURQREUwQnl0ZXNGcmFtZSA9CisJ
CQkJCTY0CisJCQkJCQkJKiAoZG1sX2NlaWwoCisJCQkJCQkJCQkoKFBpdGNoCisJCQkJCQkJCQkJ
CSogKGRtbF9jZWlsKAorCQkJCQkJCQkJCQkJCShkb3VibGUpIFN3YXRoV2lkdGgKKwkJCQkJCQkJ
CQkJCQkJCS0gMSwKKwkJCQkJCQkJCQkJCQlNYWNyb1RpbGVIZWlnaHQpCisJCQkJCQkJCQkJCQkJ
KyBNYWNyb1RpbGVIZWlnaHQpCisJCQkJCQkJCQkJCSogQnl0ZVBlclBpeGVsKQorCQkJCQkJCQkJ
CQktIE1hY3JvVGlsZVNpemVCeXRlcykKKwkJCQkJCQkJCQkJLyAoOAorCQkJCQkJCQkJCQkJCSog
MjA5NzE1MiksCisJCQkJCQkJCQkxKSArIDEpOworCQl9CisJCUV4dHJhRFBERUJ5dGVzRnJhbWUg
PSAxMjggKiAobW9kZV9saWItPnZiYS5HUFVWTU1heFBhZ2VUYWJsZUxldmVscyAtIDIpOworCX0g
ZWxzZSB7CisJCURQREUwQnl0ZXNGcmFtZSA9IDA7CisJCUV4dHJhRFBERUJ5dGVzRnJhbWUgPSAw
OworCX0KKworCVBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lID0gTWV0YVBURUJ5dGVzRnJhbWUgKyBN
UERFQnl0ZXNGcmFtZSArIERQREUwQnl0ZXNGcmFtZQorCQkJKyBFeHRyYURQREVCeXRlc0ZyYW1l
OworCisJaWYgKEdQVVZNRW5hYmxlID09IHRydWUpIHsKKwkJdW5zaWduZWQgaW50IFBURVJlcXVl
c3RTaXplOworCQl1bnNpZ25lZCBpbnQgUGl4ZWxQVEVSZXFIZWlnaHQ7CisJCXVuc2lnbmVkIGlu
dCBQaXhlbFBURVJlcVdpZHRoOworCQlkb3VibGUgRnJhY3Rpb25PZlBURVJldHVybkRyb3A7CisJ
CXVuc2lnbmVkIGludCBFZmZlY3RpdmVQREVQcm9jZXNzaW5nQnVmSW42NEtCUmVxczsKKworCQlp
ZiAoU3VyZmFjZVRpbGluZyA9PSBkbV9zd19saW5lYXIpIHsKKwkJCVBpeGVsUFRFUmVxSGVpZ2h0
ID0gMTsKKwkJCVBpeGVsUFRFUmVxV2lkdGggPSA4LjAgKiBWTU1QYWdlU2l6ZSAvIEJ5dGVQZXJQ
aXhlbDsKKwkJCVBURVJlcXVlc3RTaXplID0gNjQ7CisJCQlGcmFjdGlvbk9mUFRFUmV0dXJuRHJv
cCA9IDA7CisJCX0gZWxzZSBpZiAoTWFjcm9UaWxlU2l6ZUJ5dGVzID09IDQwOTYpIHsKKwkJCVBp
eGVsUFRFUmVxSGVpZ2h0ID0gTWFjcm9UaWxlSGVpZ2h0OworCQkJUGl4ZWxQVEVSZXFXaWR0aCA9
IDggKiAqTWFjcm9UaWxlV2lkdGg7CisJCQlQVEVSZXF1ZXN0U2l6ZSA9IDY0OworCQkJaWYgKFNj
YW5EaXJlY3Rpb24gPT0gZG1faG9yeikKKwkJCQlGcmFjdGlvbk9mUFRFUmV0dXJuRHJvcCA9IDA7
CisJCQllbHNlCisJCQkJRnJhY3Rpb25PZlBURVJldHVybkRyb3AgPSA3IC8gODsKKwkJfSBlbHNl
IGlmIChWTU1QYWdlU2l6ZSA9PSA0MDk2ICYmIE1hY3JvVGlsZVNpemVCeXRlcyA+IDQwOTYpIHsK
KwkJCVBpeGVsUFRFUmVxSGVpZ2h0ID0gMTYgKiBCbG9ja0hlaWdodDI1NkJ5dGVzOworCQkJUGl4
ZWxQVEVSZXFXaWR0aCA9IDE2ICogQmxvY2tXaWR0aDI1NkJ5dGVzOworCQkJUFRFUmVxdWVzdFNp
emUgPSAxMjg7CisJCQlGcmFjdGlvbk9mUFRFUmV0dXJuRHJvcCA9IDA7CisJCX0gZWxzZSB7CisJ
CQlQaXhlbFBURVJlcUhlaWdodCA9IE1hY3JvVGlsZUhlaWdodDsKKwkJCVBpeGVsUFRFUmVxV2lk
dGggPSA4ICogKk1hY3JvVGlsZVdpZHRoOworCQkJUFRFUmVxdWVzdFNpemUgPSA2NDsKKwkJCUZy
YWN0aW9uT2ZQVEVSZXR1cm5Ecm9wID0gMDsKKwkJfQorCisJCWlmIChTb3VyY2VQaXhlbEZvcm1h
dCA9PSBkbV80MjBfOCB8fCBTb3VyY2VQaXhlbEZvcm1hdCA9PSBkbV80MjBfMTApCisJCQlFZmZl
Y3RpdmVQREVQcm9jZXNzaW5nQnVmSW42NEtCUmVxcyA9IFBERVByb2Nlc3NpbmdCdWZJbjY0S0JS
ZXFzIC8gMjsKKwkJZWxzZQorCQkJRWZmZWN0aXZlUERFUHJvY2Vzc2luZ0J1ZkluNjRLQlJlcXMg
PSBQREVQcm9jZXNzaW5nQnVmSW42NEtCUmVxczsKKworCQlpZiAoU3VyZmFjZVRpbGluZyA9PSBk
bV9zd19saW5lYXIpIHsKKwkJCSpkcHRlX3Jvd19oZWlnaHQgPQorCQkJCQlkbWxfbWluKAorCQkJ
CQkJCTEyOCwKKwkJCQkJCQkxCisJCQkJCQkJCQk8PCAodW5zaWduZWQgaW50KSBkbWxfZmxvb3Io
CisJCQkJCQkJCQkJCWRtbF9sb2cyKAorCQkJCQkJCQkJCQkJCWRtbF9taW4oCisJCQkJCQkJCQkJ
CQkJCQkoZG91YmxlKSBQVEVCdWZmZXJTaXplSW5SZXF1ZXN0c0x1bWEKKwkJCQkJCQkJCQkJCQkJ
CQkJKiBQaXhlbFBURVJlcVdpZHRoLAorCQkJCQkJCQkJCQkJCQkJRWZmZWN0aXZlUERFUHJvY2Vz
c2luZ0J1ZkluNjRLQlJlcXMKKwkJCQkJCQkJCQkJCQkJCQkJKiA2NTUzNi4wCisJCQkJCQkJCQkJ
CQkJCQkJCS8gQnl0ZVBlclBpeGVsKQorCQkJCQkJCQkJCQkJCQkJLyBQaXRjaCksCisJCQkJCQkJ
CQkJCTEpKTsKKwkJCSpQaXhlbFBURUJ5dGVzUGVyUm93ID0gUFRFUmVxdWVzdFNpemUKKwkJCQkJ
KiAoZG1sX2NlaWwoCisJCQkJCQkJKGRvdWJsZSkgKFBpdGNoICogKmRwdGVfcm93X2hlaWdodCAt
IDEpCisJCQkJCQkJCQkvIFBpeGVsUFRFUmVxV2lkdGgsCisJCQkJCQkJMSkgKyAxKTsKKwkJfSBl
bHNlIGlmIChTY2FuRGlyZWN0aW9uID09IGRtX2hvcnopIHsKKwkJCSpkcHRlX3Jvd19oZWlnaHQg
PSBQaXhlbFBURVJlcUhlaWdodDsKKwkJCSpQaXhlbFBURUJ5dGVzUGVyUm93ID0gUFRFUmVxdWVz
dFNpemUKKwkJCQkJKiAoZG1sX2NlaWwoKChkb3VibGUpIFN3YXRoV2lkdGggLSAxKSAvIFBpeGVs
UFRFUmVxV2lkdGgsIDEpCisJCQkJCQkJKyAxKTsKKwkJfSBlbHNlIHsKKwkJCSpkcHRlX3Jvd19o
ZWlnaHQgPSBkbWxfbWluKFBpeGVsUFRFUmVxV2lkdGgsICpNYWNyb1RpbGVXaWR0aCk7CisJCQkq
UGl4ZWxQVEVCeXRlc1BlclJvdyA9IFBURVJlcXVlc3RTaXplCisJCQkJCSogKGRtbF9jZWlsKAor
CQkJCQkJCSgoZG91YmxlKSBTd2F0aFdpZHRoIC0gMSkKKwkJCQkJCQkJCS8gUGl4ZWxQVEVSZXFI
ZWlnaHQsCisJCQkJCQkJMSkgKyAxKTsKKwkJfQorCQlpZiAoKlBpeGVsUFRFQnl0ZXNQZXJSb3cg
KiAoMSAtIEZyYWN0aW9uT2ZQVEVSZXR1cm5Ecm9wKQorCQkJCTw9IDY0ICogUFRFQnVmZmVyU2l6
ZUluUmVxdWVzdHNMdW1hKSB7CisJCQkqUFRFQnVmZmVyU2l6ZU5vdEV4Y2VlZGVkID0gdHJ1ZTsK
KwkJfSBlbHNlIHsKKwkJCSpQVEVCdWZmZXJTaXplTm90RXhjZWVkZWQgPSBmYWxzZTsKKwkJfQor
CX0gZWxzZSB7CisJCSpQaXhlbFBURUJ5dGVzUGVyUm93ID0gMDsKKwkJKlBURUJ1ZmZlclNpemVO
b3RFeGNlZWRlZCA9IHRydWU7CisJfQorCisJcmV0dXJuIFBERUFuZE1ldGFQVEVCeXRlc0ZyYW1l
OworfQorCitzdGF0aWMgdm9pZCBkbWwyMHYyX0RJU1BDTEtEUFBDTEtEQ0ZDTEtEZWVwU2xlZXBQ
cmVmZXRjaFBhcmFtZXRlcnNXYXRlcm1hcmtzQW5kUGVyZm9ybWFuY2VDYWxjdWxhdGlvbigKKwkJ
c3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliKQoreworCXVuc2lnbmVkIGludCBqLCBr
OworCisJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tESVNQQ0xLID0gMC4wOworCW1vZGVfbGliLT52
YmEuRElTUENMS1dpdGhSYW1waW5nID0gMDsKKwltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRob3V0
UmFtcGluZyA9IDA7CisJbW9kZV9saWItPnZiYS5HbG9iYWxEUFBDTEsgPSAwLjA7CisKKwkvLyBk
bWxfbWwtPnZiYS5ESVNQQ0xLIGFuZCBkbWxfbWwtPnZiYS5EUFBDTEsgQ2FsY3VsYXRpb24KKwkv
LworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyAr
K2spIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrRW5hYmxlW2tdKSB7CisJCQltb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0RJU1BDTEsgPQorCQkJCQlkbWxfbWF4KAorCQkJCQkJCW1vZGVf
bGliLT52YmEuV3JpdGViYWNrRElTUENMSywKKwkJCQkJCQlDYWxjdWxhdGVXcml0ZUJhY2tESVNQ
Q0xLKAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSwKKwkJ
CQkJCQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52
YmEuV3JpdGViYWNrSFJhdGlvW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tW
UmF0aW9ba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFIVGFwc1trXSwK
KwkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYVZUYXBzW2tdLAorCQkJCQkJCQkJ
bW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFIVGFwc1trXSwKKwkJCQkJCQkJCW1vZGVfbGli
LT52YmEuV3JpdGViYWNrQ2hyb21hVlRhcHNba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldy
aXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhUb3Rh
bFtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hTGluZUJ1ZmZlcldp
ZHRoKSk7CisJCX0KKwl9CisKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJP
ZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLkhSYXRpb1trXSA+IDEp
IHsKKwkJCW1vZGVfbGliLT52YmEuUFNDTF9USFJPVUdIUFVUX0xVTUFba10gPSBkbWxfbWluKAor
CQkJCQltb2RlX2xpYi0+dmJhLk1heERDSFVCVG9QU0NMVGhyb3VnaHB1dCwKKwkJCQkJbW9kZV9s
aWItPnZiYS5NYXhQU0NMVG9MQlRocm91Z2hwdXQKKwkJCQkJCQkqIG1vZGVfbGliLT52YmEuSFJh
dGlvW2tdCisJCQkJCQkJLyBkbWxfY2VpbCgKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuaHRhcHNb
a10KKwkJCQkJCQkJCQkJLyA2LjAsCisJCQkJCQkJCQkxKSk7CisJCX0gZWxzZSB7CisJCQltb2Rl
X2xpYi0+dmJhLlBTQ0xfVEhST1VHSFBVVF9MVU1BW2tdID0gZG1sX21pbigKKwkJCQkJbW9kZV9s
aWItPnZiYS5NYXhEQ0hVQlRvUFNDTFRocm91Z2hwdXQsCisJCQkJCW1vZGVfbGliLT52YmEuTWF4
UFNDTFRvTEJUaHJvdWdocHV0KTsKKwkJfQorCisJCW1vZGVfbGliLT52YmEuRFBQQ0xLVXNpbmdT
aW5nbGVEUFBMdW1hID0KKwkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10KKwkJCQkJCSog
ZG1sX21heCgKKwkJCQkJCQkJbW9kZV9saWItPnZiYS52dGFwc1trXSAvIDYuMAorCQkJCQkJCQkJ
CSogZG1sX21pbigKKwkJCQkJCQkJCQkJCTEuMCwKKwkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEu
SFJhdGlvW2tdKSwKKwkJCQkJCQkJZG1sX21heCgKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhS
YXRpb1trXQorCQkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXQorCQkJCQkJCQkJ
CQkJLyBtb2RlX2xpYi0+dmJhLlBTQ0xfVEhST1VHSFBVVF9MVU1BW2tdLAorCQkJCQkJCQkJCTEu
MCkpOworCisJCWlmICgobW9kZV9saWItPnZiYS5odGFwc1trXSA+IDYgfHwgbW9kZV9saWItPnZi
YS52dGFwc1trXSA+IDYpCisJCQkJJiYgbW9kZV9saWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQ
UEx1bWEKKwkJCQkJCTwgMiAqIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkgeworCQkJbW9k
ZV9saWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQUEx1bWEgPSAyICogbW9kZV9saWItPnZiYS5Q
aXhlbENsb2NrW2tdOworCQl9CisKKwkJaWYgKChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9y
bWF0W2tdICE9IGRtXzQyMF84CisJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1h
dFtrXSAhPSBkbV80MjBfMTApKSB7CisJCQltb2RlX2xpYi0+dmJhLlBTQ0xfVEhST1VHSFBVVF9D
SFJPTUFba10gPSAwLjA7CisJCQltb2RlX2xpYi0+dmJhLkRQUENMS1VzaW5nU2luZ2xlRFBQW2td
ID0KKwkJCQkJbW9kZV9saWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQUEx1bWE7CisJCX0gZWxz
ZSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5IUmF0aW9ba10gPiAxKSB7CisJCQkJbW9kZV9saWIt
PnZiYS5QU0NMX1RIUk9VR0hQVVRfQ0hST01BW2tdID0KKwkJCQkJCWRtbF9taW4oCisJCQkJCQkJ
CW1vZGVfbGliLT52YmEuTWF4RENIVUJUb1BTQ0xUaHJvdWdocHV0LAorCQkJCQkJCQltb2RlX2xp
Yi0+dmJhLk1heFBTQ0xUb0xCVGhyb3VnaHB1dAorCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5I
UmF0aW9ba10KKwkJCQkJCQkJCQkvIDIKKwkJCQkJCQkJCQkvIGRtbF9jZWlsKAorCQkJCQkJCQkJ
CQkJbW9kZV9saWItPnZiYS5IVEFQc0Nocm9tYVtrXQorCQkJCQkJCQkJCQkJCQkvIDYuMCwKKwkJ
CQkJCQkJCQkJCTEuMCkpOworCQkJfSBlbHNlIHsKKwkJCQltb2RlX2xpYi0+dmJhLlBTQ0xfVEhS
T1VHSFBVVF9DSFJPTUFba10gPSBkbWxfbWluKAorCQkJCQkJbW9kZV9saWItPnZiYS5NYXhEQ0hV
QlRvUFNDTFRocm91Z2hwdXQsCisJCQkJCQltb2RlX2xpYi0+dmJhLk1heFBTQ0xUb0xCVGhyb3Vn
aHB1dCk7CisJCQl9CisJCQltb2RlX2xpYi0+dmJhLkRQUENMS1VzaW5nU2luZ2xlRFBQQ2hyb21h
ID0KKwkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCQkJKiBkbWxfbWF4KAor
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5WVEFQc0Nocm9tYVtrXQorCQkJCQkJCQkJCQkvIDYuMAor
CQkJCQkJCQkJCQkqIGRtbF9taW4oCisJCQkJCQkJCQkJCQkJMS4wLAorCQkJCQkJCQkJCQkJCW1v
ZGVfbGliLT52YmEuSFJhdGlvW2tdCisJCQkJCQkJCQkJCQkJCQkvIDIpLAorCQkJCQkJCQkJZG1s
X21heCgKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJCQkJCQkq
IG1vZGVfbGliLT52YmEuVlJhdGlvW2tdCisJCQkJCQkJCQkJCQkJLyA0CisJCQkJCQkJCQkJCQkJ
LyBtb2RlX2xpYi0+dmJhLlBTQ0xfVEhST1VHSFBVVF9DSFJPTUFba10sCisJCQkJCQkJCQkJCTEu
MCkpOworCisJCQlpZiAoKG1vZGVfbGliLT52YmEuSFRBUHNDaHJvbWFba10gPiA2IHx8IG1vZGVf
bGliLT52YmEuVlRBUHNDaHJvbWFba10gPiA2KQorCQkJCQkmJiBtb2RlX2xpYi0+dmJhLkRQUENM
S1VzaW5nU2luZ2xlRFBQQ2hyb21hCisJCQkJCQkJPCAyICogbW9kZV9saWItPnZiYS5QaXhlbENs
b2NrW2tdKSB7CisJCQkJbW9kZV9saWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQUENocm9tYSA9
IDIKKwkJCQkJCSogbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdOworCQkJfQorCisJCQltb2Rl
X2xpYi0+dmJhLkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdID0gZG1sX21heCgKKwkJCQkJbW9kZV9s
aWItPnZiYS5EUFBDTEtVc2luZ1NpbmdsZURQUEx1bWEsCisJCQkJCW1vZGVfbGliLT52YmEuRFBQ
Q0xLVXNpbmdTaW5nbGVEUFBDaHJvbWEpOworCQl9CisJfQorCisJZm9yIChrID0gMDsgayA8IG1v
ZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlpZiAobW9kZV9saWIt
PnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSAhPSBrKQorCQkJY29udGludWU7CisJCWlmIChtb2Rl
X2xpYi0+dmJhLk9ETUNvbWJpbmVFbmFibGVkW2tdKSB7CisJCQltb2RlX2xpYi0+dmJhLkRJU1BD
TEtXaXRoUmFtcGluZyA9CisJCQkJCWRtbF9tYXgoCisJCQkJCQkJbW9kZV9saWItPnZiYS5ESVNQ
Q0xLV2l0aFJhbXBpbmcsCisJCQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdIC8gMgor
CQkJCQkJCQkJKiAoMQorCQkJCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RT
Q0NMS0Rvd25TcHJlYWRpbmcKKwkJCQkJCQkJCQkJCQkvIDEwMCkKKwkJCQkJCQkJCSogKDEKKwkJ
CQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtSYW1waW5nTWFyZ2luCisJCQkJCQkJCQkJ
CQkJLyAxMDApKTsKKwkJCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRSYW1waW5nID0KKwkJ
CQkJZG1sX21heCgKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRob3V0UmFtcGluZywK
KwkJCQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10gLyAyCisJCQkJCQkJCQkqICgxCisJ
CQkJCQkJCQkJCSsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGlu
ZworCQkJCQkJCQkJCQkJCS8gMTAwKSk7CisJCX0gZWxzZSBpZiAoIW1vZGVfbGliLT52YmEuT0RN
Q29tYmluZUVuYWJsZWRba10pIHsKKwkJCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhSYW1waW5n
ID0KKwkJCQkJZG1sX21heCgKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRoUmFtcGlu
ZywKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10KKwkJCQkJCQkJCSogKDEKKwkJ
CQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0NDTEtEb3duU3ByZWFkaW5n
CisJCQkJCQkJCQkJCQkJLyAxMDApCisJCQkJCQkJCQkqICgxCisJCQkJCQkJCQkJCSsgbW9kZV9s
aWItPnZiYS5ESVNQQ0xLUmFtcGluZ01hcmdpbgorCQkJCQkJCQkJCQkJCS8gMTAwKSk7CisJCQlt
b2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRob3V0UmFtcGluZyA9CisJCQkJCWRtbF9tYXgoCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aG91dFJhbXBpbmcsCisJCQkJCQkJbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCQkJCQkqICgxCisJCQkJCQkJCQkJCSsgbW9kZV9saWIt
PnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGluZworCQkJCQkJCQkJCQkJCS8gMTAw
KSk7CisJCX0KKwl9CisKKwltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRoUmFtcGluZyA9IGRtbF9t
YXgoCisJCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtXaXRoUmFtcGluZywKKwkJCW1vZGVfbGliLT52
YmEuV3JpdGViYWNrRElTUENMSyk7CisJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aG91dFJhbXBp
bmcgPSBkbWxfbWF4KAorCQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aG91dFJhbXBpbmcsCisJ
CQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0RJU1BDTEspOworCisJQVNTRVJUKG1vZGVfbGliLT52
YmEuRElTUENMS0RQUENMS1ZDT1NwZWVkICE9IDApOworCW1vZGVfbGliLT52YmEuRElTUENMS1dp
dGhSYW1waW5nUm91bmRlZFRvREZTR3JhbnVsYXJpdHkgPSBSb3VuZFRvREZTR3JhbnVsYXJpdHlV
cCgKKwkJCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhSYW1waW5nLAorCQkJbW9kZV9saWItPnZi
YS5ESVNQQ0xLRFBQQ0xLVkNPU3BlZWQpOworCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRS
YW1waW5nUm91bmRlZFRvREZTR3JhbnVsYXJpdHkgPSBSb3VuZFRvREZTR3JhbnVsYXJpdHlVcCgK
KwkJCW1vZGVfbGliLT52YmEuRElTUENMS1dpdGhvdXRSYW1waW5nLAorCQkJbW9kZV9saWItPnZi
YS5ESVNQQ0xLRFBQQ0xLVkNPU3BlZWQpOworCW1vZGVfbGliLT52YmEuTWF4RGlzcGNsa1JvdW5k
ZWRUb0RGU0dyYW51bGFyaXR5ID0gUm91bmRUb0RGU0dyYW51bGFyaXR5RG93bigKKwkJCW1vZGVf
bGliLT52YmEuc29jLmNsb2NrX2xpbWl0c1ttb2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzXS5k
aXNwY2xrX21oeiwKKwkJCW1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS1ZDT1NwZWVkKTsKKwlp
ZiAobW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0aG91dFJhbXBpbmdSb3VuZGVkVG9ERlNHcmFudWxh
cml0eQorCQkJPiBtb2RlX2xpYi0+dmJhLk1heERpc3BjbGtSb3VuZGVkVG9ERlNHcmFudWxhcml0
eSkgeworCQltb2RlX2xpYi0+dmJhLkRJU1BDTEtfY2FsY3VsYXRlZCA9CisJCQkJbW9kZV9saWIt
PnZiYS5ESVNQQ0xLV2l0aG91dFJhbXBpbmdSb3VuZGVkVG9ERlNHcmFudWxhcml0eTsKKwl9IGVs
c2UgaWYgKG1vZGVfbGliLT52YmEuRElTUENMS1dpdGhSYW1waW5nUm91bmRlZFRvREZTR3JhbnVs
YXJpdHkKKwkJCT4gbW9kZV9saWItPnZiYS5NYXhEaXNwY2xrUm91bmRlZFRvREZTR3JhbnVsYXJp
dHkpIHsKKwkJbW9kZV9saWItPnZiYS5ESVNQQ0xLX2NhbGN1bGF0ZWQgPSBtb2RlX2xpYi0+dmJh
Lk1heERpc3BjbGtSb3VuZGVkVG9ERlNHcmFudWxhcml0eTsKKwl9IGVsc2UgeworCQltb2RlX2xp
Yi0+dmJhLkRJU1BDTEtfY2FsY3VsYXRlZCA9CisJCQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLV2l0
aFJhbXBpbmdSb3VuZGVkVG9ERlNHcmFudWxhcml0eTsKKwl9CisJRFRSQUNFKCIgICBkaXNwY2xr
X21oeiAoY2FsY3VsYXRlZCkgPSAlZiIsIG1vZGVfbGliLT52YmEuRElTUENMS19jYWxjdWxhdGVk
KTsKKworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVz
OyArK2spIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba10gPT0gMCkgeworCQkJ
bW9kZV9saWItPnZiYS5EUFBDTEtfY2FsY3VsYXRlZFtrXSA9IDA7CisJCX0gZWxzZSB7CisJCQlt
b2RlX2xpYi0+dmJhLkRQUENMS19jYWxjdWxhdGVkW2tdID0gbW9kZV9saWItPnZiYS5EUFBDTEtV
c2luZ1NpbmdsZURQUFtrXQorCQkJCQkvIG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba10KKwkJ
CQkJKiAoMSArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcg
LyAxMDApOworCQl9CisJCW1vZGVfbGliLT52YmEuR2xvYmFsRFBQQ0xLID0gZG1sX21heCgKKwkJ
CQltb2RlX2xpYi0+dmJhLkdsb2JhbERQUENMSywKKwkJCQltb2RlX2xpYi0+dmJhLkRQUENMS19j
YWxjdWxhdGVkW2tdKTsKKwl9CisJbW9kZV9saWItPnZiYS5HbG9iYWxEUFBDTEsgPSBSb3VuZFRv
REZTR3JhbnVsYXJpdHlVcCgKKwkJCW1vZGVfbGliLT52YmEuR2xvYmFsRFBQQ0xLLAorCQkJbW9k
ZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLVkNPU3BlZWQpOworCWZvciAoayA9IDA7IGsgPCBtb2Rl
X2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJbW9kZV9saWItPnZiYS5E
UFBDTEtfY2FsY3VsYXRlZFtrXSA9IG1vZGVfbGliLT52YmEuR2xvYmFsRFBQQ0xLIC8gMjU1CisJ
CQkJKiBkbWxfY2VpbCgKKwkJCQkJCW1vZGVfbGliLT52YmEuRFBQQ0xLX2NhbGN1bGF0ZWRba10g
KiAyNTUKKwkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkdsb2JhbERQUENMSywKKwkJCQkJCTEpOwor
CQlEVFJBQ0UoIiAgIGRwcGNsa19taHpbJWldIChjYWxjdWxhdGVkKSA9ICVmIiwgaywgbW9kZV9s
aWItPnZiYS5EUFBDTEtfY2FsY3VsYXRlZFtrXSk7CisJfQorCisJLy8gVXJnZW50IFdhdGVybWFy
aworCW1vZGVfbGliLT52YmEuRENDRW5hYmxlZEFueVBsYW5lID0gZmFsc2U7CisJZm9yIChrID0g
MDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykKKwkJaWYgKG1v
ZGVfbGliLT52YmEuRENDRW5hYmxlW2tdKQorCQkJbW9kZV9saWItPnZiYS5EQ0NFbmFibGVkQW55
UGxhbmUgPSB0cnVlOworCisJbW9kZV9saWItPnZiYS5SZXR1cm5CYW5kd2lkdGhUb0RDTiA9IGRt
bF9taW4oCisJCQltb2RlX2xpYi0+dmJhLlJldHVybkJ1c1dpZHRoICogbW9kZV9saWItPnZiYS5E
Q0ZDTEssCisJCQltb2RlX2xpYi0+dmJhLkZhYnJpY0FuZERSQU1CYW5kd2lkdGggKiAxMDAwKQor
CQkJKiBtb2RlX2xpYi0+dmJhLlBlcmNlbnRPZklkZWFsRFJBTUZhYnJpY0FuZFNEUFBvcnRCV1Jl
Y2VpdmVkQWZ0ZXJVcmdMYXRlbmN5UGl4ZWxEYXRhT25seSAvIDEwMDsKKworCW1vZGVfbGliLT52
YmEuUmV0dXJuQlcgPSBtb2RlX2xpYi0+dmJhLlJldHVybkJhbmR3aWR0aFRvRENOOworCW1vZGVf
bGliLT52YmEuUmV0dXJuQlcgPSBhZGp1c3RfUmV0dXJuQlcoCisJCQltb2RlX2xpYiwKKwkJCW1v
ZGVfbGliLT52YmEuUmV0dXJuQlcsCisJCQltb2RlX2xpYi0+dmJhLkRDQ0VuYWJsZWRBbnlQbGFu
ZSwKKwkJCW1vZGVfbGliLT52YmEuUmV0dXJuQmFuZHdpZHRoVG9EQ04pOworCisJLy8gTGV0J3Mg
ZG8gdGhpcyBjYWxjdWxhdGlvbiBhZ2Fpbj8/CisJbW9kZV9saWItPnZiYS5SZXR1cm5CYW5kd2lk
dGhUb0RDTiA9IGRtbF9taW4oCisJCQltb2RlX2xpYi0+dmJhLlJldHVybkJ1c1dpZHRoICogbW9k
ZV9saWItPnZiYS5EQ0ZDTEssCisJCQltb2RlX2xpYi0+dmJhLkZhYnJpY0FuZERSQU1CYW5kd2lk
dGggKiAxMDAwKTsKKwltb2RlX2xpYi0+dmJhLlJldHVybkJXID0gYWRqdXN0X1JldHVybkJXKAor
CQkJbW9kZV9saWIsCisJCQltb2RlX2xpYi0+dmJhLlJldHVybkJXLAorCQkJbW9kZV9saWItPnZi
YS5EQ0NFbmFibGVkQW55UGxhbmUsCisJCQltb2RlX2xpYi0+dmJhLlJldHVybkJhbmR3aWR0aFRv
RENOKTsKKworCURUUkFDRSgiICAgZGNmY2xrX21oeiAgICAgICAgID0gJWYiLCBtb2RlX2xpYi0+
dmJhLkRDRkNMSyk7CisJRFRSQUNFKCIgICByZXR1cm5fYndfdG9fZGNuICAgPSAlZiIsIG1vZGVf
bGliLT52YmEuUmV0dXJuQmFuZHdpZHRoVG9EQ04pOworCURUUkFDRSgiICAgcmV0dXJuX2J1c19i
dyAgICAgID0gJWYiLCBtb2RlX2xpYi0+dmJhLlJldHVybkJXKTsKKworCWZvciAoayA9IDA7IGsg
PCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJYm9vbCBNYWlu
UGxhbmVEb2VzT0RNQ29tYmluZSA9IGZhbHNlOworCisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJj
ZVNjYW5ba10gPT0gZG1faG9yeikKKwkJCW1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFNpbmdsZURQ
UFlba10gPSBtb2RlX2xpYi0+dmJhLlZpZXdwb3J0V2lkdGhba107CisJCWVsc2UKKwkJCW1vZGVf
bGliLT52YmEuU3dhdGhXaWR0aFNpbmdsZURQUFlba10gPSBtb2RlX2xpYi0+dmJhLlZpZXdwb3J0
SGVpZ2h0W2tdOworCisJCWlmIChtb2RlX2xpYi0+dmJhLk9ETUNvbWJpbmVFbmFibGVkW2tdID09
IHRydWUpCisJCQlNYWluUGxhbmVEb2VzT0RNQ29tYmluZSA9IHRydWU7CisJCWZvciAoaiA9IDA7
IGogPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2opCisJCQlpZiAobW9k
ZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBqCisJCQkJCSYmIG1vZGVfbGliLT52
YmEuT0RNQ29tYmluZUVuYWJsZWRbal0gPT0gdHJ1ZSkKKwkJCQlNYWluUGxhbmVEb2VzT0RNQ29t
YmluZSA9IHRydWU7CisKKwkJaWYgKE1haW5QbGFuZURvZXNPRE1Db21iaW5lID09IHRydWUpCisJ
CQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdID0gZG1sX21pbigKKwkJCQkJKGRvdWJsZSkg
bW9kZV9saWItPnZiYS5Td2F0aFdpZHRoU2luZ2xlRFBQWVtrXSwKKwkJCQkJZG1sX3JvdW5kKAor
CQkJCQkJCW1vZGVfbGliLT52YmEuSEFjdGl2ZVtrXSAvIDIuMAorCQkJCQkJCQkJKiBtb2RlX2xp
Yi0+dmJhLkhSYXRpb1trXSkpOworCQllbHNlIHsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLkRQUFBl
clBsYW5lW2tdID09IDApIHsKKwkJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdID0gMDsK
KwkJCX0gZWxzZSB7CisJCQkJbW9kZV9saWItPnZiYS5Td2F0aFdpZHRoWVtrXSA9IG1vZGVfbGli
LT52YmEuU3dhdGhXaWR0aFNpbmdsZURQUFlba10KKwkJCQkJCS8gbW9kZV9saWItPnZiYS5EUFBQ
ZXJQbGFuZVtrXTsKKwkJCX0KKwkJfQorCX0KKworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+
dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuU291
cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzY0KSB7CisJCQltb2RlX2xpYi0+dmJhLkJ5dGVQ
ZXJQaXhlbERFVFlba10gPSA4OworCQkJbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRDW2td
ID0gMDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09
IGRtXzQ0NF8zMikgeworCQkJbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRZW2tdID0gNDsK
KwkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUQ1trXSA9IDA7CisJCX0gZWxzZSBpZiAo
bW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80NDRfMTYpIHsKKwkJCW1v
ZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUWVtrXSA9IDI7CisJCQltb2RlX2xpYi0+dmJhLkJ5
dGVQZXJQaXhlbERFVENba10gPSAwOworCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNl
UGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzgpIHsKKwkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBp
eGVsREVUWVtrXSA9IDE7CisJCQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10gPSAw
OworCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1f
NDIwXzgpIHsKKwkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUWVtrXSA9IDE7CisJCQlt
b2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10gPSAyOworCQl9IGVsc2UgeyAvLyBkbV80
MjBfMTAKKwkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUWVtrXSA9IDQuMCAvIDMuMDsK
KwkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUQ1trXSA9IDguMCAvIDMuMDsKKwkJfQor
CX0KKworCW1vZGVfbGliLT52YmEuVG90YWxEYXRhUmVhZEJhbmR3aWR0aCA9IDAuMDsKKwlmb3Ig
KGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJ
CW1vZGVfbGliLT52YmEuUmVhZEJhbmR3aWR0aFBsYW5lTHVtYVtrXSA9IG1vZGVfbGliLT52YmEu
U3dhdGhXaWR0aFNpbmdsZURQUFlba10KKwkJCQkqIGRtbF9jZWlsKG1vZGVfbGliLT52YmEuQnl0
ZVBlclBpeGVsREVUWVtrXSwgMSkKKwkJCQkvIChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvIG1v
ZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkKKwkJCQkqIG1vZGVfbGliLT52YmEuVlJhdGlvW2td
OworCQltb2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXSA9IG1vZGVfbGli
LT52YmEuU3dhdGhXaWR0aFNpbmdsZURQUFlba10KKwkJCQkvIDIgKiBkbWxfY2VpbChtb2RlX2xp
Yi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10sIDIpCisJCQkJLyAobW9kZV9saWItPnZiYS5IVG90
YWxba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pCisJCQkJKiBtb2RlX2xpYi0+dmJh
LlZSYXRpb1trXSAvIDI7CisJCURUUkFDRSgKKwkJCQkiICAgcmVhZF9id1slaV0gPSAlZkJwcyIs
CisJCQkJaywKKwkJCQltb2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUx1bWFba10KKwkJ
CQkJCSsgbW9kZV9saWItPnZiYS5SZWFkQmFuZHdpZHRoUGxhbmVDaHJvbWFba10pOworCQltb2Rl
X2xpYi0+dmJhLlRvdGFsRGF0YVJlYWRCYW5kd2lkdGggKz0gbW9kZV9saWItPnZiYS5SZWFkQmFu
ZHdpZHRoUGxhbmVMdW1hW2tdCisJCQkJKyBtb2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFu
ZUNocm9tYVtrXTsKKwl9CisKKwltb2RlX2xpYi0+dmJhLlRvdGFsRENDQWN0aXZlRFBQID0gMDsK
Kwltb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlRFBQID0gMDsKKwlmb3IgKGsgPSAwOyBrIDwgbW9k
ZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCW1vZGVfbGliLT52YmEu
VG90YWxBY3RpdmVEUFAgPSBtb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlRFBQCisJCQkJKyBtb2Rl
X2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdOworCQlpZiAobW9kZV9saWItPnZiYS5EQ0NFbmFibGVb
a10pCisJCQltb2RlX2xpYi0+dmJhLlRvdGFsRENDQWN0aXZlRFBQID0gbW9kZV9saWItPnZiYS5U
b3RhbERDQ0FjdGl2ZURQUAorCQkJCQkrIG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba107CisJ
fQorCisJbW9kZV9saWItPnZiYS5VcmdlbnRSb3VuZFRyaXBBbmRPdXRPZk9yZGVyTGF0ZW5jeSA9
CisJCQkobW9kZV9saWItPnZiYS5Sb3VuZFRyaXBQaW5nTGF0ZW5jeUN5Y2xlcyArIDMyKSAvIG1v
ZGVfbGliLT52YmEuRENGQ0xLCisJCQkJCSsgbW9kZV9saWItPnZiYS5VcmdlbnRPdXRPZk9yZGVy
UmV0dXJuUGVyQ2hhbm5lbFBpeGVsRGF0YU9ubHkKKwkJCQkJCQkqIG1vZGVfbGliLT52YmEuTnVt
YmVyT2ZDaGFubmVscworCQkJCQkJCS8gbW9kZV9saWItPnZiYS5SZXR1cm5CVzsKKworCW1vZGVf
bGliLT52YmEuTGFzdFBpeGVsT2ZMaW5lRXh0cmFXYXRlcm1hcmsgPSAwOworCisJbW9kZV9saWIt
PnZiYS5VcmdlbnRFeHRyYUxhdGVuY3kgPSBtb2RlX2xpYi0+dmJhLlVyZ2VudFJvdW5kVHJpcEFu
ZE91dE9mT3JkZXJMYXRlbmN5CisJCQkrIChtb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlRFBQICog
bW9kZV9saWItPnZiYS5QaXhlbENodW5rU2l6ZUluS0J5dGUKKwkJCQkJKyBtb2RlX2xpYi0+dmJh
LlRvdGFsRENDQWN0aXZlRFBQCisJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLk1ldGFDaHVua1NpemUp
ICogMTAyNC4wCisJCQkJCS8gbW9kZV9saWItPnZiYS5SZXR1cm5CVzsKKworCWlmIChtb2RlX2xp
Yi0+dmJhLkdQVVZNRW5hYmxlKQorCQltb2RlX2xpYi0+dmJhLlVyZ2VudEV4dHJhTGF0ZW5jeSAr
PSBtb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlRFBQCisJCQkJKiBtb2RlX2xpYi0+dmJhLlBURUdy
b3VwU2l6ZSAvIG1vZGVfbGliLT52YmEuUmV0dXJuQlc7CisKKwltb2RlX2xpYi0+dmJhLlVyZ2Vu
dFdhdGVybWFyayA9IG1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeVBpeGVsRGF0YU9ubHkKKwkJ
CSsgbW9kZV9saWItPnZiYS5MYXN0UGl4ZWxPZkxpbmVFeHRyYVdhdGVybWFyaworCQkJKyBtb2Rl
X2xpYi0+dmJhLlVyZ2VudEV4dHJhTGF0ZW5jeTsKKworCURUUkFDRSgiICAgdXJnZW50X2V4dHJh
X2xhdGVuY3kgPSAlZnVzIiwgbW9kZV9saWItPnZiYS5VcmdlbnRFeHRyYUxhdGVuY3kpOworCURU
UkFDRSgiICAgd21fdXJnZW50ID0gJWZ1cyIsIG1vZGVfbGliLT52YmEuVXJnZW50V2F0ZXJtYXJr
KTsKKworCW1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeSA9IG1vZGVfbGliLT52YmEuVXJnZW50
TGF0ZW5jeVBpeGVsRGF0YU9ubHk7CisKKwltb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlV3JpdGVi
YWNrID0gMDsKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBs
YW5lczsgKytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSkKKwkJ
CW1vZGVfbGliLT52YmEuVG90YWxBY3RpdmVXcml0ZWJhY2sgPSBtb2RlX2xpYi0+dmJhLlRvdGFs
QWN0aXZlV3JpdGViYWNrICsgbW9kZV9saWItPnZiYS5BY3RpdmVXcml0ZWJhY2tzUGVyUGxhbmVb
a107CisJfQorCisJaWYgKG1vZGVfbGliLT52YmEuVG90YWxBY3RpdmVXcml0ZWJhY2sgPD0gMSkK
KwkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tVcmdlbnRXYXRlcm1hcmsgPSBtb2RlX2xpYi0+dmJh
LldyaXRlYmFja0xhdGVuY3k7CisJZWxzZQorCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja1VyZ2Vu
dFdhdGVybWFyayA9IG1vZGVfbGliLT52YmEuV3JpdGViYWNrTGF0ZW5jeQorCQkJCSsgbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tDaHVua1NpemUgKiAxMDI0LjAgLyAzMgorCQkJCQkJLyBtb2RlX2xp
Yi0+dmJhLlNPQ0NMSzsKKworCURUUkFDRSgiICAgd21fd2JfdXJnZW50ID0gJWZ1cyIsIG1vZGVf
bGliLT52YmEuV3JpdGViYWNrVXJnZW50V2F0ZXJtYXJrKTsKKworCS8vIE5CIFAtU3RhdGUvRFJB
TSBDbG9jayBDaGFuZ2UgV2F0ZXJtYXJrCisJbW9kZV9saWItPnZiYS5EUkFNQ2xvY2tDaGFuZ2VX
YXRlcm1hcmsgPSBtb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZUxhdGVuY3kKKwkJCSsgbW9k
ZV9saWItPnZiYS5VcmdlbnRXYXRlcm1hcms7CisKKwlEVFJBQ0UoIiAgIHdtX3BzdGF0ZV9jaGFu
Z2UgPSAlZnVzIiwgbW9kZV9saWItPnZiYS5EUkFNQ2xvY2tDaGFuZ2VXYXRlcm1hcmspOworCisJ
RFRSQUNFKCIgICBjYWxjdWxhdGluZyB3YiBwc3RhdGUgd2F0ZXJtYXJrIik7CisJRFRSQUNFKCIg
ICAgICB0b3RhbCB3YiBvdXRwdXRzICVkIiwgbW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZVdyaXRl
YmFjayk7CisJRFRSQUNFKCIgICAgICBzb2NjbGsgZnJlcXVlbmN5ICVmIE1oeiIsIG1vZGVfbGli
LT52YmEuU09DQ0xLKTsKKworCWlmIChtb2RlX2xpYi0+dmJhLlRvdGFsQWN0aXZlV3JpdGViYWNr
IDw9IDEpCisJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJr
ID0KKwkJCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZUxhdGVuY3kKKwkJCQkJCSsgbW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tMYXRlbmN5OworCWVsc2UKKwkJbW9kZV9saWItPnZiYS5Xcml0
ZWJhY2tEUkFNQ2xvY2tDaGFuZ2VXYXRlcm1hcmsgPQorCQkJCW1vZGVfbGliLT52YmEuRFJBTUNs
b2NrQ2hhbmdlTGF0ZW5jeQorCQkJCQkJKyBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0xhdGVuY3kK
KwkJCQkJCSsgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHVua1NpemUgKiAxMDI0LjAgLyAzMgor
CQkJCQkJCQkvIG1vZGVfbGliLT52YmEuU09DQ0xLOworCisJRFRSQUNFKCIgICB3bV93Yl9wc3Rh
dGUgJWZ1cyIsIG1vZGVfbGliLT52YmEuV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJr
KTsKKworCS8vIFN0dXR0ZXIgRWZmaWNpZW5jeQorCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+
dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJbW9kZV9saWItPnZiYS5MaW5lc0lu
REVUWVtrXSA9IG1vZGVfbGliLT52YmEuREVUQnVmZmVyU2l6ZVlba10KKwkJCQkvIG1vZGVfbGli
LT52YmEuQnl0ZVBlclBpeGVsREVUWVtrXSAvIG1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlba107
CisJCW1vZGVfbGliLT52YmEuTGluZXNJbkRFVFlSb3VuZGVkRG93blRvU3dhdGhba10gPSBkbWxf
Zmxvb3IoCisJCQkJbW9kZV9saWItPnZiYS5MaW5lc0luREVUWVtrXSwKKwkJCQltb2RlX2xpYi0+
dmJhLlN3YXRoSGVpZ2h0WVtrXSk7CisJCW1vZGVfbGliLT52YmEuRnVsbERFVEJ1ZmZlcmluZ1Rp
bWVZW2tdID0KKwkJCQltb2RlX2xpYi0+dmJhLkxpbmVzSW5ERVRZUm91bmRlZERvd25Ub1N3YXRo
W2tdCisJCQkJCQkqIChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkvIG1vZGVfbGli
LT52YmEuUGl4ZWxDbG9ja1trXSkKKwkJCQkJCS8gbW9kZV9saWItPnZiYS5WUmF0aW9ba107CisJ
CWlmIChtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10gPiAwKSB7CisJCQltb2RlX2xp
Yi0+dmJhLkxpbmVzSW5ERVRDW2tdID0gbW9kZV9saWItPnZiYS5ERVRCdWZmZXJTaXplQ1trXQor
CQkJCQkvIG1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUQ1trXQorCQkJCQkvIChtb2RlX2xp
Yi0+dmJhLlN3YXRoV2lkdGhZW2tdIC8gMik7CisJCQltb2RlX2xpYi0+dmJhLkxpbmVzSW5ERVRD
Um91bmRlZERvd25Ub1N3YXRoW2tdID0gZG1sX2Zsb29yKAorCQkJCQltb2RlX2xpYi0+dmJhLkxp
bmVzSW5ERVRDW2tdLAorCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSk7CisJCQlt
b2RlX2xpYi0+dmJhLkZ1bGxERVRCdWZmZXJpbmdUaW1lQ1trXSA9CisJCQkJCW1vZGVfbGliLT52
YmEuTGluZXNJbkRFVENSb3VuZGVkRG93blRvU3dhdGhba10KKwkJCQkJCQkqIChtb2RlX2xpYi0+
dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pCisJ
CQkJCQkJLyAobW9kZV9saWItPnZiYS5WUmF0aW9ba10gLyAyKTsKKwkJfSBlbHNlIHsKKwkJCW1v
ZGVfbGliLT52YmEuTGluZXNJbkRFVENba10gPSAwOworCQkJbW9kZV9saWItPnZiYS5MaW5lc0lu
REVUQ1JvdW5kZWREb3duVG9Td2F0aFtrXSA9IDA7CisJCQltb2RlX2xpYi0+dmJhLkZ1bGxERVRC
dWZmZXJpbmdUaW1lQ1trXSA9IDk5OTk5OTsKKwkJfQorCX0KKworCW1vZGVfbGliLT52YmEuTWlu
RnVsbERFVEJ1ZmZlcmluZ1RpbWUgPSA5OTk5OTkuMDsKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9s
aWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJh
LkZ1bGxERVRCdWZmZXJpbmdUaW1lWVtrXQorCQkJCTwgbW9kZV9saWItPnZiYS5NaW5GdWxsREVU
QnVmZmVyaW5nVGltZSkgeworCQkJbW9kZV9saWItPnZiYS5NaW5GdWxsREVUQnVmZmVyaW5nVGlt
ZSA9CisJCQkJCW1vZGVfbGliLT52YmEuRnVsbERFVEJ1ZmZlcmluZ1RpbWVZW2tdOworCQkJbW9k
ZV9saWItPnZiYS5GcmFtZVRpbWVGb3JNaW5GdWxsREVUQnVmZmVyaW5nVGltZSA9CisJCQkJCShk
b3VibGUpIG1vZGVfbGliLT52YmEuVlRvdGFsW2tdICogbW9kZV9saWItPnZiYS5IVG90YWxba10K
KwkJCQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXTsKKwkJfQorCQlpZiAobW9kZV9s
aWItPnZiYS5GdWxsREVUQnVmZmVyaW5nVGltZUNba10KKwkJCQk8IG1vZGVfbGliLT52YmEuTWlu
RnVsbERFVEJ1ZmZlcmluZ1RpbWUpIHsKKwkJCW1vZGVfbGliLT52YmEuTWluRnVsbERFVEJ1ZmZl
cmluZ1RpbWUgPQorCQkJCQltb2RlX2xpYi0+dmJhLkZ1bGxERVRCdWZmZXJpbmdUaW1lQ1trXTsK
KwkJCW1vZGVfbGliLT52YmEuRnJhbWVUaW1lRm9yTWluRnVsbERFVEJ1ZmZlcmluZ1RpbWUgPQor
CQkJCQkoZG91YmxlKSBtb2RlX2xpYi0+dmJhLlZUb3RhbFtrXSAqIG1vZGVfbGliLT52YmEuSFRv
dGFsW2tdCisJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba107CisJCX0KKwl9CisK
Kwltb2RlX2xpYi0+dmJhLkF2ZXJhZ2VSZWFkQmFuZHdpZHRoR0J5dGVQZXJTZWNvbmQgPSAwLjA7
CisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsr
aykgeworCQlpZiAobW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10pIHsKKwkJCW1vZGVfbGliLT52
YmEuQXZlcmFnZVJlYWRCYW5kd2lkdGhHQnl0ZVBlclNlY29uZCA9CisJCQkJCW1vZGVfbGliLT52
YmEuQXZlcmFnZVJlYWRCYW5kd2lkdGhHQnl0ZVBlclNlY29uZAorCQkJCQkJCSsgbW9kZV9saWIt
PnZiYS5SZWFkQmFuZHdpZHRoUGxhbmVMdW1hW2tdCisJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEu
RENDUmF0ZVtrXQorCQkJCQkJCQkJLyAxMDAwCisJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLlJlYWRC
YW5kd2lkdGhQbGFuZUNocm9tYVtrXQorCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkRDQ1JhdGVb
a10KKwkJCQkJCQkJCS8gMTAwMDsKKwkJfSBlbHNlIHsKKwkJCW1vZGVfbGliLT52YmEuQXZlcmFn
ZVJlYWRCYW5kd2lkdGhHQnl0ZVBlclNlY29uZCA9CisJCQkJCW1vZGVfbGliLT52YmEuQXZlcmFn
ZVJlYWRCYW5kd2lkdGhHQnl0ZVBlclNlY29uZAorCQkJCQkJCSsgbW9kZV9saWItPnZiYS5SZWFk
QmFuZHdpZHRoUGxhbmVMdW1hW2tdCisJCQkJCQkJCQkvIDEwMDAKKwkJCQkJCQkrIG1vZGVfbGli
LT52YmEuUmVhZEJhbmR3aWR0aFBsYW5lQ2hyb21hW2tdCisJCQkJCQkJCQkvIDEwMDA7CisJCX0K
KwkJaWYgKG1vZGVfbGliLT52YmEuRENDRW5hYmxlW2tdKSB7CisJCQltb2RlX2xpYi0+dmJhLkF2
ZXJhZ2VSZWFkQmFuZHdpZHRoR0J5dGVQZXJTZWNvbmQgPQorCQkJCQltb2RlX2xpYi0+dmJhLkF2
ZXJhZ2VSZWFkQmFuZHdpZHRoR0J5dGVQZXJTZWNvbmQKKwkJCQkJCQkrIG1vZGVfbGliLT52YmEu
UmVhZEJhbmR3aWR0aFBsYW5lTHVtYVtrXQorCQkJCQkJCQkJLyAxMDAwIC8gMjU2CisJCQkJCQkJ
KyBtb2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXQorCQkJCQkJCQkJLyAx
MDAwIC8gMjU2OworCQl9CisJCWlmIChtb2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlKSB7CisJCQlt
b2RlX2xpYi0+dmJhLkF2ZXJhZ2VSZWFkQmFuZHdpZHRoR0J5dGVQZXJTZWNvbmQgPQorCQkJCQlt
b2RlX2xpYi0+dmJhLkF2ZXJhZ2VSZWFkQmFuZHdpZHRoR0J5dGVQZXJTZWNvbmQKKwkJCQkJCQkr
IG1vZGVfbGliLT52YmEuUmVhZEJhbmR3aWR0aFBsYW5lTHVtYVtrXQorCQkJCQkJCQkJLyAxMDAw
IC8gNTEyCisJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtr
XQorCQkJCQkJCQkJLyAxMDAwIC8gNTEyOworCQl9CisJfQorCisJbW9kZV9saWItPnZiYS5QYXJ0
T2ZCdXJzdFRoYXRGaXRzSW5ST0IgPQorCQkJZG1sX21pbigKKwkJCQkJbW9kZV9saWItPnZiYS5N
aW5GdWxsREVUQnVmZmVyaW5nVGltZQorCQkJCQkJCSogbW9kZV9saWItPnZiYS5Ub3RhbERhdGFS
ZWFkQmFuZHdpZHRoLAorCQkJCQltb2RlX2xpYi0+dmJhLlJPQkJ1ZmZlclNpemVJbktCeXRlICog
MTAyNAorCQkJCQkJCSogbW9kZV9saWItPnZiYS5Ub3RhbERhdGFSZWFkQmFuZHdpZHRoCisJCQkJ
CQkJLyAobW9kZV9saWItPnZiYS5BdmVyYWdlUmVhZEJhbmR3aWR0aEdCeXRlUGVyU2Vjb25kCisJ
CQkJCQkJCQkqIDEwMDApKTsKKwltb2RlX2xpYi0+dmJhLlN0dXR0ZXJCdXJzdFRpbWUgPSBtb2Rl
X2xpYi0+dmJhLlBhcnRPZkJ1cnN0VGhhdEZpdHNJblJPQgorCQkJKiAobW9kZV9saWItPnZiYS5B
dmVyYWdlUmVhZEJhbmR3aWR0aEdCeXRlUGVyU2Vjb25kICogMTAwMCkKKwkJCS8gbW9kZV9saWIt
PnZiYS5Ub3RhbERhdGFSZWFkQmFuZHdpZHRoIC8gbW9kZV9saWItPnZiYS5SZXR1cm5CVworCQkJ
KyAobW9kZV9saWItPnZiYS5NaW5GdWxsREVUQnVmZmVyaW5nVGltZQorCQkJCQkqIG1vZGVfbGli
LT52YmEuVG90YWxEYXRhUmVhZEJhbmR3aWR0aAorCQkJCQktIG1vZGVfbGliLT52YmEuUGFydE9m
QnVyc3RUaGF0Rml0c0luUk9CKQorCQkJCQkvIChtb2RlX2xpYi0+dmJhLkRDRkNMSyAqIDY0KTsK
KwlpZiAobW9kZV9saWItPnZiYS5Ub3RhbEFjdGl2ZVdyaXRlYmFjayA9PSAwKSB7CisJCW1vZGVf
bGliLT52YmEuU3R1dHRlckVmZmljaWVuY3lOb3RJbmNsdWRpbmdWQmxhbmsgPSAoMQorCQkJCS0g
KG1vZGVfbGliLT52YmEuU1JFeGl0VGltZSArIG1vZGVfbGliLT52YmEuU3R1dHRlckJ1cnN0VGlt
ZSkKKwkJCQkJCS8gbW9kZV9saWItPnZiYS5NaW5GdWxsREVUQnVmZmVyaW5nVGltZSkgKiAxMDA7
CisJfSBlbHNlIHsKKwkJbW9kZV9saWItPnZiYS5TdHV0dGVyRWZmaWNpZW5jeU5vdEluY2x1ZGlu
Z1ZCbGFuayA9IDA7CisJfQorCisJbW9kZV9saWItPnZiYS5TbWFsbGVzdFZCbGFuayA9IDk5OTk5
OTsKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsg
KytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLlN5bmNocm9uaXplZFZCbGFuayB8fCBtb2RlX2xp
Yi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzID09IDEpIHsKKwkJCW1vZGVfbGliLT52YmEuVkJs
YW5rVGltZSA9IChkb3VibGUpIChtb2RlX2xpYi0+dmJhLlZUb3RhbFtrXQorCQkJCQktIG1vZGVf
bGliLT52YmEuVkFjdGl2ZVtrXSkgKiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkvIG1v
ZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXTsKKwkJfSBlbHNlIHsKKwkJCW1vZGVfbGliLT52YmEu
VkJsYW5rVGltZSA9IDA7CisJCX0KKwkJbW9kZV9saWItPnZiYS5TbWFsbGVzdFZCbGFuayA9IGRt
bF9taW4oCisJCQkJbW9kZV9saWItPnZiYS5TbWFsbGVzdFZCbGFuaywKKwkJCQltb2RlX2xpYi0+
dmJhLlZCbGFua1RpbWUpOworCX0KKworCW1vZGVfbGliLT52YmEuU3R1dHRlckVmZmljaWVuY3kg
PSAobW9kZV9saWItPnZiYS5TdHV0dGVyRWZmaWNpZW5jeU5vdEluY2x1ZGluZ1ZCbGFuayAvIDEw
MAorCQkJKiAobW9kZV9saWItPnZiYS5GcmFtZVRpbWVGb3JNaW5GdWxsREVUQnVmZmVyaW5nVGlt
ZQorCQkJCQktIG1vZGVfbGliLT52YmEuU21hbGxlc3RWQmxhbmspCisJCQkrIG1vZGVfbGliLT52
YmEuU21hbGxlc3RWQmxhbmspCisJCQkvIG1vZGVfbGliLT52YmEuRnJhbWVUaW1lRm9yTWluRnVs
bERFVEJ1ZmZlcmluZ1RpbWUgKiAxMDA7CisKKwkvLyBkbWxfbWwtPnZiYS5EQ0ZDTEsgRGVlcCBT
bGVlcAorCW1vZGVfbGliLT52YmEuRENGQ0xLRGVlcFNsZWVwID0gOC4wOworCisJZm9yIChrID0g
MDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7IGsrKykgeworCQlpZiAo
bW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRDW2tdID4gMCkgeworCQkJbW9kZV9saWItPnZi
YS5EQ0ZDTEtEZWVwU2xlZXBQZXJQbGFuZVtrXSA9CisJCQkJCWRtbF9tYXgoCisJCQkJCQkJMS4x
ICogbW9kZV9saWItPnZiYS5Td2F0aFdpZHRoWVtrXQorCQkJCQkJCQkJKiBkbWxfY2VpbCgKKwkJ
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRZW2tdLAorCQkJCQkJCQkJCQkx
KSAvIDMyCisJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuRGlzcGxheVBpcGVMaW5lRGVsaXZlcnlU
aW1lTHVtYVtrXSwKKwkJCQkJCQkxLjEgKiBtb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdIC8g
Mi4wCisJCQkJCQkJCQkqIGRtbF9jZWlsKAorCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkJ5dGVQ
ZXJQaXhlbERFVENba10sCisJCQkJCQkJCQkJCTIpIC8gMzIKKwkJCQkJCQkJCS8gbW9kZV9saWIt
PnZiYS5EaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVDaHJvbWFba10pOworCQl9IGVsc2UKKwkJ
CW1vZGVfbGliLT52YmEuRENGQ0xLRGVlcFNsZWVwUGVyUGxhbmVba10gPSAxLjEgKiBtb2RlX2xp
Yi0+dmJhLlN3YXRoV2lkdGhZW2tdCisJCQkJCSogZG1sX2NlaWwobW9kZV9saWItPnZiYS5CeXRl
UGVyUGl4ZWxERVRZW2tdLCAxKSAvIDY0LjAKKwkJCQkJLyBtb2RlX2xpYi0+dmJhLkRpc3BsYXlQ
aXBlTGluZURlbGl2ZXJ5VGltZUx1bWFba107CisJCW1vZGVfbGliLT52YmEuRENGQ0xLRGVlcFNs
ZWVwUGVyUGxhbmVba10gPSBkbWxfbWF4KAorCQkJCW1vZGVfbGliLT52YmEuRENGQ0xLRGVlcFNs
ZWVwUGVyUGxhbmVba10sCisJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdIC8gMTYuMCk7
CisJCW1vZGVfbGliLT52YmEuRENGQ0xLRGVlcFNsZWVwID0gZG1sX21heCgKKwkJCQltb2RlX2xp
Yi0+dmJhLkRDRkNMS0RlZXBTbGVlcCwKKwkJCQltb2RlX2xpYi0+dmJhLkRDRkNMS0RlZXBTbGVl
cFBlclBsYW5lW2tdKTsKKworCQlEVFJBQ0UoCisJCQkJIiAgIGRjZmNsa19kZWVwc2xlZXBfcGVy
X3BsYW5lWyVpXSA9ICVmTUh6IiwKKwkJCQlrLAorCQkJCW1vZGVfbGliLT52YmEuRENGQ0xLRGVl
cFNsZWVwUGVyUGxhbmVba10pOworCX0KKworCURUUkFDRSgiICAgZGNmY2xrX2RlZXBzbGVlcF9t
aHogPSAlZk1IeiIsIG1vZGVfbGliLT52YmEuRENGQ0xLRGVlcFNsZWVwKTsKKworCS8vIFN0dXR0
ZXIgV2F0ZXJtYXJrCisJbW9kZV9saWItPnZiYS5TdHV0dGVyRXhpdFdhdGVybWFyayA9IG1vZGVf
bGliLT52YmEuU1JFeGl0VGltZQorCQkJKyBtb2RlX2xpYi0+dmJhLkxhc3RQaXhlbE9mTGluZUV4
dHJhV2F0ZXJtYXJrCisJCQkrIG1vZGVfbGliLT52YmEuVXJnZW50RXh0cmFMYXRlbmN5ICsgMTAg
LyBtb2RlX2xpYi0+dmJhLkRDRkNMS0RlZXBTbGVlcDsKKwltb2RlX2xpYi0+dmJhLlN0dXR0ZXJF
bnRlclBsdXNFeGl0V2F0ZXJtYXJrID0gbW9kZV9saWItPnZiYS5TUkVudGVyUGx1c0V4aXRUaW1l
CisJCQkrIG1vZGVfbGliLT52YmEuTGFzdFBpeGVsT2ZMaW5lRXh0cmFXYXRlcm1hcmsKKwkJCSsg
bW9kZV9saWItPnZiYS5VcmdlbnRFeHRyYUxhdGVuY3k7CisKKwlEVFJBQ0UoIiAgIHdtX2NzdGF0
ZV9leGl0ICAgICAgID0gJWZ1cyIsIG1vZGVfbGliLT52YmEuU3R1dHRlckV4aXRXYXRlcm1hcmsp
OworCURUUkFDRSgiICAgd21fY3N0YXRlX2VudGVyX2V4aXQgPSAlZnVzIiwgbW9kZV9saWItPnZi
YS5TdHV0dGVyRW50ZXJQbHVzRXhpdFdhdGVybWFyayk7CisKKwkvLyBVcmdlbnQgTGF0ZW5jeSBT
dXBwb3J0ZWQKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBs
YW5lczsgKytrKSB7CisJCW1vZGVfbGliLT52YmEuRWZmZWN0aXZlREVUUGx1c0xCTGluZXNMdW1h
ID0KKwkJCQlkbWxfZmxvb3IoCisJCQkJCQltb2RlX2xpYi0+dmJhLkxpbmVzSW5ERVRZW2tdCisJ
CQkJCQkJCSsgZG1sX21pbigKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkxpbmVzSW5ERVRZW2td
CisJCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuRFBQQ0xLW2tdCisJCQkJCQkJCQkJCQkqIG1v
ZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUWVtrXQorCQkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+
dmJhLlBTQ0xfVEhST1VHSFBVVF9MVU1BW2tdCisJCQkJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJh
LlJldHVybkJXCisJCQkJCQkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5EUFBQZXJQbGFuZVtrXSks
CisJCQkJCQkJCQkJKGRvdWJsZSkgbW9kZV9saWItPnZiYS5FZmZlY3RpdmVMQkxhdGVuY3lIaWRp
bmdTb3VyY2VMaW5lc0x1bWEpLAorCQkJCQkJbW9kZV9saWItPnZiYS5Td2F0aEhlaWdodFlba10p
OworCisJCW1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeVN1cHBvcnRVc0x1bWEgPSBtb2RlX2xp
Yi0+dmJhLkVmZmVjdGl2ZURFVFBsdXNMQkxpbmVzTHVtYQorCQkJCSogKG1vZGVfbGliLT52YmEu
SFRvdGFsW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKQorCQkJCS8gbW9kZV9saWIt
PnZiYS5WUmF0aW9ba10KKwkJCQktIG1vZGVfbGliLT52YmEuRWZmZWN0aXZlREVUUGx1c0xCTGlu
ZXNMdW1hCisJCQkJCQkqIG1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlba10KKwkJCQkJCSogbW9k
ZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRZW2tdCisJCQkJCQkvIChtb2RlX2xpYi0+dmJhLlJl
dHVybkJXCisJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5EUFBQZXJQbGFuZVtrXSk7CisKKwkJaWYg
KG1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUQ1trXSA+IDApIHsKKwkJCW1vZGVfbGliLT52
YmEuRWZmZWN0aXZlREVUUGx1c0xCTGluZXNDaHJvbWEgPQorCQkJCQlkbWxfZmxvb3IoCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5MaW5lc0luREVUQ1trXQorCQkJCQkJCQkJKyBkbWxfbWluKAorCQkJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLkxpbmVzSW5ERVRDW2tdCisJCQkJCQkJCQkJCQkJKiBtb2Rl
X2xpYi0+dmJhLkRQUENMS1trXQorCQkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5CeXRlUGVy
UGl4ZWxERVRDW2tdCisJCQkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlBTQ0xfVEhST1VHSFBV
VF9DSFJPTUFba10KKwkJCQkJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLlJldHVybkJXCisJCQkJ
CQkJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba10pLAorCQkJCQkJCQkJCQko
ZG91YmxlKSBtb2RlX2xpYi0+dmJhLkVmZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ1NvdXJjZUxpbmVz
Q2hyb21hKSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSk7CisJCQltb2Rl
X2xpYi0+dmJhLlVyZ2VudExhdGVuY3lTdXBwb3J0VXNDaHJvbWEgPQorCQkJCQltb2RlX2xpYi0+
dmJhLkVmZmVjdGl2ZURFVFBsdXNMQkxpbmVzQ2hyb21hCisJCQkJCQkJKiAobW9kZV9saWItPnZi
YS5IVG90YWxba10KKwkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKQorCQkJ
CQkJCS8gKG1vZGVfbGliLT52YmEuVlJhdGlvW2tdIC8gMikKKwkJCQkJCQktIG1vZGVfbGliLT52
YmEuRWZmZWN0aXZlREVUUGx1c0xCTGluZXNDaHJvbWEKKwkJCQkJCQkJCSogKG1vZGVfbGliLT52
YmEuU3dhdGhXaWR0aFlba10KKwkJCQkJCQkJCQkJLyAyKQorCQkJCQkJCQkJKiBtb2RlX2xpYi0+
dmJhLkJ5dGVQZXJQaXhlbERFVENba10KKwkJCQkJCQkJCS8gKG1vZGVfbGliLT52YmEuUmV0dXJu
QlcKKwkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdKTsKKwkJCW1vZGVf
bGliLT52YmEuVXJnZW50TGF0ZW5jeVN1cHBvcnRVc1trXSA9IGRtbF9taW4oCisJCQkJCW1vZGVf
bGliLT52YmEuVXJnZW50TGF0ZW5jeVN1cHBvcnRVc0x1bWEsCisJCQkJCW1vZGVfbGliLT52YmEu
VXJnZW50TGF0ZW5jeVN1cHBvcnRVc0Nocm9tYSk7CisJCX0gZWxzZSB7CisJCQltb2RlX2xpYi0+
dmJhLlVyZ2VudExhdGVuY3lTdXBwb3J0VXNba10gPQorCQkJCQltb2RlX2xpYi0+dmJhLlVyZ2Vu
dExhdGVuY3lTdXBwb3J0VXNMdW1hOworCQl9CisJfQorCisJbW9kZV9saWItPnZiYS5NaW5Vcmdl
bnRMYXRlbmN5U3VwcG9ydFVzID0gOTk5OTk5OworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+
dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJbW9kZV9saWItPnZiYS5NaW5Vcmdl
bnRMYXRlbmN5U3VwcG9ydFVzID0gZG1sX21pbigKKwkJCQltb2RlX2xpYi0+dmJhLk1pblVyZ2Vu
dExhdGVuY3lTdXBwb3J0VXMsCisJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5U3VwcG9y
dFVzW2tdKTsKKwl9CisKKwkvLyBOb24tVXJnZW50IExhdGVuY3kgVG9sZXJhbmNlCisJbW9kZV9s
aWItPnZiYS5Ob25VcmdlbnRMYXRlbmN5VG9sZXJhbmNlID0gbW9kZV9saWItPnZiYS5NaW5Vcmdl
bnRMYXRlbmN5U3VwcG9ydFVzCisJCQktIG1vZGVfbGliLT52YmEuVXJnZW50V2F0ZXJtYXJrOwor
CisJLy8gRFNDQ0xLCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3Rp
dmVQbGFuZXM7ICsraykgeworCQlpZiAoKG1vZGVfbGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdb
a10gIT0gaykgfHwgIW1vZGVfbGliLT52YmEuRFNDRW5hYmxlZFtrXSkgeworCQkJbW9kZV9saWIt
PnZiYS5EU0NDTEtfY2FsY3VsYXRlZFtrXSA9IDAuMDsKKwkJfSBlbHNlIHsKKwkJCWlmIChtb2Rl
X2xpYi0+dmJhLk91dHB1dEZvcm1hdFtrXSA9PSBkbV80MjAKKwkJCQkJfHwgbW9kZV9saWItPnZi
YS5PdXRwdXRGb3JtYXRba10gPT0gZG1fbjQyMikKKwkJCQltb2RlX2xpYi0+dmJhLkRTQ0Zvcm1h
dEZhY3RvciA9IDI7CisJCQllbHNlCisJCQkJbW9kZV9saWItPnZiYS5EU0NGb3JtYXRGYWN0b3Ig
PSAxOworCQkJaWYgKG1vZGVfbGliLT52YmEuT0RNQ29tYmluZUVuYWJsZWRba10pCisJCQkJbW9k
ZV9saWItPnZiYS5EU0NDTEtfY2FsY3VsYXRlZFtrXSA9CisJCQkJCQltb2RlX2xpYi0+dmJhLlBp
eGVsQ2xvY2tCYWNrRW5kW2tdIC8gNgorCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuRFNDRm9ybWF0
RmFjdG9yCisJCQkJCQkJCS8gKDEKKwkJCQkJCQkJCQktIG1vZGVfbGliLT52YmEuRElTUENMS0RQ
UENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcKKwkJCQkJCQkJCQkJCS8gMTAwKTsKKwkJCWVsc2UKKwkJ
CQltb2RlX2xpYi0+dmJhLkRTQ0NMS19jYWxjdWxhdGVkW2tdID0KKwkJCQkJCW1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja0JhY2tFbmRba10gLyAzCisJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5EU0NG
b3JtYXRGYWN0b3IKKwkJCQkJCQkJLyAoMQorCQkJCQkJCQkJCS0gbW9kZV9saWItPnZiYS5ESVNQ
Q0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGluZworCQkJCQkJCQkJCQkJLyAxMDApOworCQl9CisJ
fQorCisJLy8gRFNDIERlbGF5CisJLy8gVE9ETworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+
dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJZG91YmxlIGJwcCA9IG1vZGVfbGli
LT52YmEuT3V0cHV0QnBwW2tdOworCQl1bnNpZ25lZCBpbnQgc2xpY2VzID0gbW9kZV9saWItPnZi
YS5OdW1iZXJPZkRTQ1NsaWNlc1trXTsKKworCQlpZiAobW9kZV9saWItPnZiYS5EU0NFbmFibGVk
W2tdICYmIGJwcCAhPSAwKSB7CisJCQlpZiAoIW1vZGVfbGliLT52YmEuT0RNQ29tYmluZUVuYWJs
ZWRba10pIHsKKwkJCQltb2RlX2xpYi0+dmJhLkRTQ0RlbGF5W2tdID0KKwkJCQkJCWRzY2NlQ29t
cHV0ZURlbGF5KAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9uZW50
W2tdLAorCQkJCQkJCQlicHAsCisJCQkJCQkJCWRtbF9jZWlsKAorCQkJCQkJCQkJCShkb3VibGUp
IG1vZGVfbGliLT52YmEuSEFjdGl2ZVtrXQorCQkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLk51
bWJlck9mRFNDU2xpY2VzW2tdLAorCQkJCQkJCQkJCTEpLAorCQkJCQkJCQlzbGljZXMsCisJCQkJ
CQkJCW1vZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0W2tdKQorCQkJCQkJCQkrIGRzY0NvbXB1dGVE
ZWxheSgKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dEZvcm1hdFtrXSk7CisJCQl9IGVs
c2UgeworCQkJCW1vZGVfbGliLT52YmEuRFNDRGVsYXlba10gPQorCQkJCQkJMgorCQkJCQkJCQkq
IChkc2NjZUNvbXB1dGVEZWxheSgKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0
UGVyQ29tcG9uZW50W2tdLAorCQkJCQkJCQkJCWJwcCwKKwkJCQkJCQkJCQlkbWxfY2VpbCgKKwkJ
CQkJCQkJCQkJCShkb3VibGUpIG1vZGVfbGliLT52YmEuSEFjdGl2ZVtrXQorCQkJCQkJCQkJCQkJ
CQkvIG1vZGVfbGliLT52YmEuTnVtYmVyT2ZEU0NTbGljZXNba10sCisJCQkJCQkJCQkJCQkxKSwK
KwkJCQkJCQkJCQlzbGljZXMgLyAyLjAsCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRG
b3JtYXRba10pCisJCQkJCQkJCQkJKyBkc2NDb21wdXRlRGVsYXkoCisJCQkJCQkJCQkJCQltb2Rl
X2xpYi0+dmJhLk91dHB1dEZvcm1hdFtrXSkpOworCQkJfQorCQkJbW9kZV9saWItPnZiYS5EU0NE
ZWxheVtrXSA9IG1vZGVfbGliLT52YmEuRFNDRGVsYXlba10KKwkJCQkJKiBtb2RlX2xpYi0+dmJh
LlBpeGVsQ2xvY2tba10KKwkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNrRW5kW2td
OworCQl9IGVsc2UgeworCQkJbW9kZV9saWItPnZiYS5EU0NEZWxheVtrXSA9IDA7CisJCX0KKwl9
CisKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsg
KytrKQorCQlmb3IgKGogPSAwOyBqIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5l
czsgKytqKSAvLyBOdW1iZXJPZlBsYW5lcworCQkJaWYgKGogIT0gayAmJiBtb2RlX2xpYi0+dmJh
LkJsZW5kaW5nQW5kVGltaW5nW2tdID09IGoKKwkJCQkJJiYgbW9kZV9saWItPnZiYS5EU0NFbmFi
bGVkW2pdKQorCQkJCW1vZGVfbGliLT52YmEuRFNDRGVsYXlba10gPSBtb2RlX2xpYi0+dmJhLkRT
Q0RlbGF5W2pdOworCisJLy8gUHJlZmV0Y2gKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZi
YS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCXVuc2lnbmVkIGludCBQREVBbmRNZXRh
UFRFQnl0ZXNGcmFtZVk7CisJCXVuc2lnbmVkIGludCBQaXhlbFBURUJ5dGVzUGVyUm93WTsKKwkJ
dW5zaWduZWQgaW50IE1ldGFSb3dCeXRlWTsKKwkJdW5zaWduZWQgaW50IE1ldGFSb3dCeXRlQzsK
KwkJdW5zaWduZWQgaW50IFBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lQzsKKwkJdW5zaWduZWQgaW50
IFBpeGVsUFRFQnl0ZXNQZXJSb3dDOworCisJCUNhbGN1bGF0ZTI1NkJCbG9ja1NpemVzKAorCQkJ
CW1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10sCisJCQkJbW9kZV9saWItPnZiYS5T
dXJmYWNlVGlsaW5nW2tdLAorCQkJCWRtbF9jZWlsKG1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVs
REVUWVtrXSwgMSksCisJCQkJZG1sX2NlaWwobW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRD
W2tdLCAyKSwKKwkJCQkmbW9kZV9saWItPnZiYS5CbG9ja0hlaWdodDI1NkJ5dGVzWVtrXSwKKwkJ
CQkmbW9kZV9saWItPnZiYS5CbG9ja0hlaWdodDI1NkJ5dGVzQ1trXSwKKwkJCQkmbW9kZV9saWIt
PnZiYS5CbG9ja1dpZHRoMjU2Qnl0ZXNZW2tdLAorCQkJCSZtb2RlX2xpYi0+dmJhLkJsb2NrV2lk
dGgyNTZCeXRlc0Nba10pOworCQlQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZVkgPSBDYWxjdWxhdGVW
TUFuZFJvd0J5dGVzKAorCQkJCW1vZGVfbGliLAorCQkJCW1vZGVfbGliLT52YmEuRENDRW5hYmxl
W2tdLAorCQkJCW1vZGVfbGliLT52YmEuQmxvY2tIZWlnaHQyNTZCeXRlc1lba10sCisJCQkJbW9k
ZV9saWItPnZiYS5CbG9ja1dpZHRoMjU2Qnl0ZXNZW2tdLAorCQkJCW1vZGVfbGliLT52YmEuU291
cmNlUGl4ZWxGb3JtYXRba10sCisJCQkJbW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdLAor
CQkJCWRtbF9jZWlsKG1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUWVtrXSwgMSksCisJCQkJ
bW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdLAorCQkJCW1vZGVfbGliLT52YmEuVmlld3BvcnRX
aWR0aFtrXSwKKwkJCQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0SGVpZ2h0W2tdLAorCQkJCW1vZGVf
bGliLT52YmEuU3dhdGhXaWR0aFlba10sCisJCQkJbW9kZV9saWItPnZiYS5HUFVWTUVuYWJsZSwK
KwkJCQltb2RlX2xpYi0+dmJhLlZNTVBhZ2VTaXplLAorCQkJCW1vZGVfbGliLT52YmEuUFRFQnVm
ZmVyU2l6ZUluUmVxdWVzdHNMdW1hLAorCQkJCW1vZGVfbGliLT52YmEuUERFUHJvY2Vzc2luZ0J1
ZkluNjRLQlJlcXMsCisJCQkJbW9kZV9saWItPnZiYS5QaXRjaFlba10sCisJCQkJbW9kZV9saWIt
PnZiYS5EQ0NNZXRhUGl0Y2hZW2tdLAorCQkJCSZtb2RlX2xpYi0+dmJhLk1hY3JvVGlsZVdpZHRo
WVtrXSwKKwkJCQkmTWV0YVJvd0J5dGVZLAorCQkJCSZQaXhlbFBURUJ5dGVzUGVyUm93WSwKKwkJ
CQkmbW9kZV9saWItPnZiYS5QVEVCdWZmZXJTaXplTm90RXhjZWVkZWRbbW9kZV9saWItPnZiYS5W
b2x0YWdlTGV2ZWxdWzBdLAorCQkJCSZtb2RlX2xpYi0+dmJhLmRwdGVfcm93X2hlaWdodFtrXSwK
KwkJCQkmbW9kZV9saWItPnZiYS5tZXRhX3Jvd19oZWlnaHRba10pOworCQltb2RlX2xpYi0+dmJh
LlByZWZldGNoU291cmNlTGluZXNZW2tdID0gQ2FsY3VsYXRlUHJlZmV0Y2hTb3VyY2VMaW5lcygK
KwkJCQltb2RlX2xpYiwKKwkJCQltb2RlX2xpYi0+dmJhLlZSYXRpb1trXSwKKwkJCQltb2RlX2xp
Yi0+dmJhLnZ0YXBzW2tdLAorCQkJCW1vZGVfbGliLT52YmEuSW50ZXJsYWNlW2tdLAorCQkJCW1v
ZGVfbGliLT52YmEuUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCwKKwkJCQltb2RlX2xp
Yi0+dmJhLlN3YXRoSGVpZ2h0WVtrXSwKKwkJCQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0WVN0YXJ0
WVtrXSwKKwkJCQkmbW9kZV9saWItPnZiYS5WSW5pdFByZUZpbGxZW2tdLAorCQkJCSZtb2RlX2xp
Yi0+dmJhLk1heE51bVN3YXRoWVtrXSk7CisKKwkJaWYgKChtb2RlX2xpYi0+dmJhLlNvdXJjZVBp
eGVsRm9ybWF0W2tdICE9IGRtXzQ0NF82NAorCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4
ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzMyCisJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhl
bEZvcm1hdFtrXSAhPSBkbV80NDRfMTYKKwkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVs
Rm9ybWF0W2tdICE9IGRtXzQ0NF84KSkgeworCQkJUERFQW5kTWV0YVBURUJ5dGVzRnJhbWVDID0K
KwkJCQkJQ2FsY3VsYXRlVk1BbmRSb3dCeXRlcygKKwkJCQkJCQltb2RlX2xpYiwKKwkJCQkJCQlt
b2RlX2xpYi0+dmJhLkRDQ0VuYWJsZVtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkJsb2NrSGVp
Z2h0MjU2Qnl0ZXNDW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuQmxvY2tXaWR0aDI1NkJ5dGVz
Q1trXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdLAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSwKKwkJCQkJCQlkbWxfY2VpbCgKKwkJCQkJ
CQkJCW1vZGVfbGliLT52YmEuQnl0ZVBlclBpeGVsREVUQ1trXSwKKwkJCQkJCQkJCTIpLAorCQkJ
CQkJCW1vZGVfbGliLT52YmEuU291cmNlU2NhbltrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZp
ZXdwb3J0V2lkdGhba10gLyAyLAorCQkJCQkJCW1vZGVfbGliLT52YmEuVmlld3BvcnRIZWlnaHRb
a10gLyAyLAorCQkJCQkJCW1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlba10gLyAyLAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuR1BVVk1FbmFibGUsCisJCQkJCQkJbW9kZV9saWItPnZiYS5WTU1QYWdl
U2l6ZSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlBURUJ1ZmZlclNpemVJblJlcXVlc3RzTHVtYSwK
KwkJCQkJCQltb2RlX2xpYi0+dmJhLlBERVByb2Nlc3NpbmdCdWZJbjY0S0JSZXFzLAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuUGl0Y2hDW2tdLAorCQkJCQkJCTAsCisJCQkJCQkJJm1vZGVfbGliLT52
YmEuTWFjcm9UaWxlV2lkdGhDW2tdLAorCQkJCQkJCSZNZXRhUm93Qnl0ZUMsCisJCQkJCQkJJlBp
eGVsUFRFQnl0ZXNQZXJSb3dDLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlBURUJ1ZmZlclNpemVO
b3RFeGNlZWRlZFttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1bMF0sCisJCQkJCQkJJm1vZGVf
bGliLT52YmEuZHB0ZV9yb3dfaGVpZ2h0X2Nocm9tYVtrXSwKKwkJCQkJCQkmbW9kZV9saWItPnZi
YS5tZXRhX3Jvd19oZWlnaHRfY2hyb21hW2tdKTsKKwkJCW1vZGVfbGliLT52YmEuUHJlZmV0Y2hT
b3VyY2VMaW5lc0Nba10gPSBDYWxjdWxhdGVQcmVmZXRjaFNvdXJjZUxpbmVzKAorCQkJCQltb2Rl
X2xpYiwKKwkJCQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10gLyAyLAorCQkJCQltb2RlX2xpYi0+
dmJhLlZUQVBzQ2hyb21hW2tdLAorCQkJCQltb2RlX2xpYi0+dmJhLkludGVybGFjZVtrXSwKKwkJ
CQkJbW9kZV9saWItPnZiYS5Qcm9ncmVzc2l2ZVRvSW50ZXJsYWNlVW5pdEluT1BQLAorCQkJCQlt
b2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSwKKwkJCQkJbW9kZV9saWItPnZiYS5WaWV3cG9y
dFlTdGFydENba10sCisJCQkJCSZtb2RlX2xpYi0+dmJhLlZJbml0UHJlRmlsbENba10sCisJCQkJ
CSZtb2RlX2xpYi0+dmJhLk1heE51bVN3YXRoQ1trXSk7CisJCX0gZWxzZSB7CisJCQlQaXhlbFBU
RUJ5dGVzUGVyUm93QyA9IDA7CisJCQlQREVBbmRNZXRhUFRFQnl0ZXNGcmFtZUMgPSAwOworCQkJ
TWV0YVJvd0J5dGVDID0gMDsKKwkJCW1vZGVfbGliLT52YmEuTWF4TnVtU3dhdGhDW2tdID0gMDsK
KwkJCW1vZGVfbGliLT52YmEuUHJlZmV0Y2hTb3VyY2VMaW5lc0Nba10gPSAwOworCQl9CisKKwkJ
bW9kZV9saWItPnZiYS5QaXhlbFBURUJ5dGVzUGVyUm93W2tdID0gUGl4ZWxQVEVCeXRlc1BlclJv
d1kgKyBQaXhlbFBURUJ5dGVzUGVyUm93QzsKKwkJbW9kZV9saWItPnZiYS5QREVBbmRNZXRhUFRF
Qnl0ZXNGcmFtZVtrXSA9IFBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lWQorCQkJCSsgUERFQW5kTWV0
YVBURUJ5dGVzRnJhbWVDOworCQltb2RlX2xpYi0+dmJhLk1ldGFSb3dCeXRlW2tdID0gTWV0YVJv
d0J5dGVZICsgTWV0YVJvd0J5dGVDOworCisJCUNhbGN1bGF0ZUFjdGl2ZVJvd0JhbmR3aWR0aCgK
KwkJCQltb2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlLAorCQkJCW1vZGVfbGliLT52YmEuU291cmNl
UGl4ZWxGb3JtYXRba10sCisJCQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10sCisJCQkJbW9kZV9s
aWItPnZiYS5EQ0NFbmFibGVba10sCisJCQkJbW9kZV9saWItPnZiYS5IVG90YWxba10gLyBtb2Rl
X2xpYi0+dmJhLlBpeGVsQ2xvY2tba10sCisJCQkJTWV0YVJvd0J5dGVZLAorCQkJCU1ldGFSb3dC
eXRlQywKKwkJCQltb2RlX2xpYi0+dmJhLm1ldGFfcm93X2hlaWdodFtrXSwKKwkJCQltb2RlX2xp
Yi0+dmJhLm1ldGFfcm93X2hlaWdodF9jaHJvbWFba10sCisJCQkJUGl4ZWxQVEVCeXRlc1BlclJv
d1ksCisJCQkJUGl4ZWxQVEVCeXRlc1BlclJvd0MsCisJCQkJbW9kZV9saWItPnZiYS5kcHRlX3Jv
d19oZWlnaHRba10sCisJCQkJbW9kZV9saWItPnZiYS5kcHRlX3Jvd19oZWlnaHRfY2hyb21hW2td
LAorCQkJCSZtb2RlX2xpYi0+dmJhLm1ldGFfcm93X2J3W2tdLAorCQkJCSZtb2RlX2xpYi0+dmJh
LmRwdGVfcm93X2J3W2tdLAorCQkJCSZtb2RlX2xpYi0+dmJhLnF1YWxfcm93X2J3W2tdKTsKKwl9
CisKKwltb2RlX2xpYi0+dmJhLlRDYWxjID0gMjQuMCAvIG1vZGVfbGliLT52YmEuRENGQ0xLRGVl
cFNsZWVwOworCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXM7ICsraykgeworCQlpZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9
PSBrKSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tFbmFibGVba10gPT0gdHJ1ZSkg
eworCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVsYXlbbW9kZV9saWItPnZiYS5Wb2x0YWdl
TGV2ZWxdW2tdID0KKwkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTGF0ZW5jeQorCQkJCQkJ
CQkrIENhbGN1bGF0ZVdyaXRlQmFja0RlbGF5KAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3Jp
dGViYWNrUGl4ZWxGb3JtYXRba10sCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tI
UmF0aW9ba10sCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWUmF0aW9ba10sCisJ
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRhcHNba10sCisJCQkJCQkJCQkJ
bW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVlRhcHNba10sCisJCQkJCQkJCQkJbW9kZV9saWIt
PnZiYS5Xcml0ZWJhY2tDaHJvbWFIVGFwc1trXSwKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldy
aXRlYmFja0Nocm9tYVZUYXBzW2tdLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNr
RGVzdGluYXRpb25XaWR0aFtrXSkKKwkJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuRElTUENMSzsK
KwkJCX0gZWxzZQorCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVsYXlbbW9kZV9saWItPnZi
YS5Wb2x0YWdlTGV2ZWxdW2tdID0gMDsKKwkJCWZvciAoaiA9IDA7IGogPCBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2opIHsKKwkJCQlpZiAobW9kZV9saWItPnZiYS5CbGVu
ZGluZ0FuZFRpbWluZ1tqXSA9PSBrCisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Vu
YWJsZVtqXSA9PSB0cnVlKSB7CisJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVsYXlbbW9k
ZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdW2tdID0KKwkJCQkJCQlkbWxfbWF4KAorCQkJCQkJCQkJ
bW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEZWxheVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1b
a10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0xhdGVuY3kKKwkJCQkJCQkJCQkJ
KyBDYWxjdWxhdGVXcml0ZUJhY2tEZWxheSgKKwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldy
aXRlYmFja1BpeGVsRm9ybWF0W2pdLAorCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGVi
YWNrSFJhdGlvW2pdLAorCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrVlJhdGlv
W2pdLAorCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYUhUYXBzW2pdLAor
CQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYVZUYXBzW2pdLAorCQkJCQkJ
CQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hSFRhcHNbal0sCisJCQkJCQkJCQkJ
CQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFWVGFwc1tqXSwKKwkJCQkJCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhbal0pCisJCQkJCQkJCQkJCQkJ
LyBtb2RlX2xpYi0+dmJhLkRJU1BDTEspOworCQkJCX0KKwkJCX0KKwkJfQorCX0KKworCWZvciAo
ayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spCisJCWZv
ciAoaiA9IDA7IGogPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2opCisJ
CQlpZiAobW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBqKQorCQkJCW1vZGVf
bGliLT52YmEuV3JpdGViYWNrRGVsYXlbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdW2tdID0K
KwkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVsYXlbbW9kZV9saWItPnZiYS5Wb2x0YWdl
TGV2ZWxdW2pdOworCisJbW9kZV9saWItPnZiYS5WU3RhcnR1cExpbmVzID0gMTM7CisJZm9yIChr
ID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlt
b2RlX2xpYi0+dmJhLk1heFZTdGFydHVwTGluZXNba10gPQorCQkJCW1vZGVfbGliLT52YmEuVlRv
dGFsW2tdIC0gbW9kZV9saWItPnZiYS5WQWN0aXZlW2tdCisJCQkJCQktIGRtbF9tYXgoCisJCQkJ
CQkJCTEuMCwKKwkJCQkJCQkJZG1sX2NlaWwoCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0
ZWJhY2tEZWxheVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1ba10KKwkJCQkJCQkJCQkJCS8g
KG1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5Q
aXhlbENsb2NrW2tdKSwKKwkJCQkJCQkJCQkxKSk7CisJfQorCisJZm9yIChrID0gMDsgayA8IG1v
ZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykKKwkJbW9kZV9saWItPnZiYS5N
YXhpbXVtTWF4VlN0YXJ0dXBMaW5lcyA9IGRtbF9tYXgoCisJCQkJbW9kZV9saWItPnZiYS5NYXhp
bXVtTWF4VlN0YXJ0dXBMaW5lcywKKwkJCQltb2RlX2xpYi0+dmJhLk1heFZTdGFydHVwTGluZXNb
a10pOworCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFu
ZXM7ICsraykgeworCQltb2RlX2xpYi0+dmJhLmN1cnNvcl9id1trXSA9IDAuMDsKKwkJZm9yIChq
ID0gMDsgaiA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZDdXJzb3JzW2tdOyArK2opCisJCQltb2Rl
X2xpYi0+dmJhLmN1cnNvcl9id1trXSArPSBtb2RlX2xpYi0+dmJhLkN1cnNvcldpZHRoW2tdW2pd
CisJCQkJCSogbW9kZV9saWItPnZiYS5DdXJzb3JCUFBba11bal0gLyA4LjAKKwkJCQkJLyAobW9k
ZV9saWItPnZiYS5IVG90YWxba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pCisJCQkJ
CSogbW9kZV9saWItPnZiYS5WUmF0aW9ba107CisJfQorCisJZG8geworCQlkb3VibGUgTWF4VG90
YWxSREJhbmR3aWR0aCA9IDA7CisJCWJvb2wgRGVzdGluYXRpb25MaW5lVGltZXNGb3JQcmVmZXRj
aExlc3NUaGFuMiA9IGZhbHNlOworCQlib29sIFZSYXRpb1ByZWZldGNoTW9yZVRoYW40ID0gZmFs
c2U7CisJCWJvb2wgcHJlZmV0Y2hfdm1fYndfdmFsaWQgPSB0cnVlOworCQlib29sIHByZWZldGNo
X3Jvd19id192YWxpZCA9IHRydWU7CisJCWRvdWJsZSBUV2FpdCA9IENhbGN1bGF0ZVRXYWl0KAor
CQkJCW1vZGVfbGliLT52YmEuUHJlZmV0Y2hNb2RlW21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVs
XVttb2RlX2xpYi0+dmJhLm1heE1wY0NvbWJdLAorCQkJCW1vZGVfbGliLT52YmEuRFJBTUNsb2Nr
Q2hhbmdlTGF0ZW5jeSwKKwkJCQltb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3lQaXhlbERhdGFP
bmx5LAorCQkJCW1vZGVfbGliLT52YmEuU1JFbnRlclBsdXNFeGl0VGltZSk7CisKKwkJZm9yIChr
ID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQkJ
aWYgKG1vZGVfbGliLT52YmEuWEZDRW5hYmxlZFtrXSA9PSB0cnVlKSB7CisJCQkJbW9kZV9saWIt
PnZiYS5YRkNSZW1vdGVTdXJmYWNlRmxpcERlbGF5ID0KKwkJCQkJCUNhbGN1bGF0ZVJlbW90ZVN1
cmZhY2VGbGlwRGVsYXkoCisJCQkJCQkJCW1vZGVfbGliLAorCQkJCQkJCQltb2RlX2xpYi0+dmJh
LlZSYXRpb1trXSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5Td2F0aFdpZHRoWVtrXSwKKwkJCQkJ
CQkJZG1sX2NlaWwoCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRZW2td
LAorCQkJCQkJCQkJCTEpLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJ
CQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdLAorCQkJCQkJCQltb2RlX2xpYi0+dmJh
LlhGQ1RTbHZWdXBkYXRlT2Zmc2V0LAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1RTbHZWdXBk
YXRlV2lkdGgsCisJCQkJCQkJCW1vZGVfbGliLT52YmEuWEZDVFNsdlZyZWFkeU9mZnNldCwKKwkJ
CQkJCQkJbW9kZV9saWItPnZiYS5YRkNYQlVGTGF0ZW5jeVRvbGVyYW5jZSwKKwkJCQkJCQkJbW9k
ZV9saWItPnZiYS5YRkNGaWxsQldPdmVyaGVhZCwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5YRkNT
bHZDaHVua1NpemUsCisJCQkJCQkJCW1vZGVfbGliLT52YmEuWEZDQnVzVHJhbnNwb3J0VGltZSwK
KwkJCQkJCQkJbW9kZV9saWItPnZiYS5UQ2FsYywKKwkJCQkJCQkJVFdhaXQsCisJCQkJCQkJCSZt
b2RlX2xpYi0+dmJhLlNyY0FjdGl2ZURyYWluUmF0ZSwKKwkJCQkJCQkJJm1vZGVfbGliLT52YmEu
VEluaXRYRmlsbCwKKwkJCQkJCQkJJm1vZGVfbGliLT52YmEuVHNsdkNoayk7CisJCQl9IGVsc2Ug
eworCQkJCW1vZGVfbGliLT52YmEuWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSA9IDA7CisJCQl9
CisKKwkJCUNhbGN1bGF0ZURlbGF5QWZ0ZXJTY2FsZXIobW9kZV9saWIsIG1vZGVfbGliLT52YmEu
UmV0dXJuQlcsIG1vZGVfbGliLT52YmEuUmVhZEJhbmR3aWR0aFBsYW5lTHVtYVtrXSwgbW9kZV9s
aWItPnZiYS5SZWFkQmFuZHdpZHRoUGxhbmVDaHJvbWFba10sIG1vZGVfbGliLT52YmEuVG90YWxE
YXRhUmVhZEJhbmR3aWR0aCwKKwkJCQkJbW9kZV9saWItPnZiYS5EaXNwbGF5UGlwZUxpbmVEZWxp
dmVyeVRpbWVMdW1hW2tdLCBtb2RlX2xpYi0+dmJhLkRpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGlt
ZUNocm9tYVtrXSwKKwkJCQkJbW9kZV9saWItPnZiYS5EUFBDTEtba10sIG1vZGVfbGliLT52YmEu
RElTUENMSywgbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdLCBtb2RlX2xpYi0+dmJhLkRTQ0Rl
bGF5W2tdLCBtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdLCBtb2RlX2xpYi0+dmJhLlNjYWxl
ckVuYWJsZWRba10sIG1vZGVfbGliLT52YmEuTnVtYmVyT2ZDdXJzb3JzW2tdLAorCQkJCQltb2Rl
X2xpYi0+dmJhLkRQUENMS0RlbGF5U3VidG90YWwsIG1vZGVfbGliLT52YmEuRFBQQ0xLRGVsYXlT
Q0wsIG1vZGVfbGliLT52YmEuRFBQQ0xLRGVsYXlTQ0xMQk9ubHksIG1vZGVfbGliLT52YmEuRFBQ
Q0xLRGVsYXlDTlZDRm9ybWF0ZXIsIG1vZGVfbGliLT52YmEuRFBQQ0xLRGVsYXlDTlZDQ3Vyc29y
LCBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEZWxheVN1YnRvdGFsLAorCQkJCQltb2RlX2xpYi0+dmJh
LlN3YXRoV2lkdGhZW2tdIC8gbW9kZV9saWItPnZiYS5IUmF0aW9ba10sIG1vZGVfbGliLT52YmEu
T3V0cHV0Rm9ybWF0W2tdLCBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSwKKwkJCQkJbW9kZV9saWIt
PnZiYS5Td2F0aFdpZHRoU2luZ2xlRFBQWVtrXSwgbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxE
RVRZW2tdLCBtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVENba10sIG1vZGVfbGliLT52YmEu
U3dhdGhIZWlnaHRZW2tdLCBtb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSwgbW9kZV9saWIt
PnZiYS5JbnRlcmxhY2Vba10sCisJCQkJCW1vZGVfbGliLT52YmEuUHJvZ3Jlc3NpdmVUb0ludGVy
bGFjZVVuaXRJbk9QUCwgJm1vZGVfbGliLT52YmEuRFNUWEFmdGVyU2NhbGVyW2tdLCAmbW9kZV9s
aWItPnZiYS5EU1RZQWZ0ZXJTY2FsZXJba10pOworCisJCQltb2RlX2xpYi0+dmJhLkVycm9yUmVz
dWx0W2tdID0KKwkJCQkJQ2FsY3VsYXRlUHJlZmV0Y2hTY2hlZHVsZSgKKwkJCQkJCQltb2RlX2xp
YiwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRQUENMS1trXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJh
LkRJU1BDTEssCisJCQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdLAorCQkJCQkJCW1v
ZGVfbGliLT52YmEuRENGQ0xLRGVlcFNsZWVwLAorCQkJCQkJCW1vZGVfbGliLT52YmEuRFBQUGVy
UGxhbmVba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5OdW1iZXJPZkN1cnNvcnNba10sCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5WVG90YWxba10KKwkJCQkJCQkJCS0gbW9kZV9saWItPnZiYS5WQWN0
aXZlW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuSFRvdGFsW2tdLAorCQkJCQkJCW1vZGVfbGli
LT52YmEuTWF4SW50ZXJEQ05UaWxlUmVwZWF0ZXJzLAorCQkJCQkJCWRtbF9taW4oCisJCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLlZTdGFydHVwTGluZXMsCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLk1h
eFZTdGFydHVwTGluZXNba10pLAorCQkJCQkJCW1vZGVfbGliLT52YmEuR1BVVk1NYXhQYWdlVGFi
bGVMZXZlbHMsCisJCQkJCQkJbW9kZV9saWItPnZiYS5HUFVWTUVuYWJsZSwKKwkJCQkJCQltb2Rl
X2xpYi0+dmJhLkR5bmFtaWNNZXRhZGF0YUVuYWJsZVtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJh
LkR5bmFtaWNNZXRhZGF0YUxpbmVzQmVmb3JlQWN0aXZlUmVxdWlyZWRba10sCisJCQkJCQkJbW9k
ZV9saWItPnZiYS5EeW5hbWljTWV0YWRhdGFUcmFuc21pdHRlZEJ5dGVzW2tdLAorCQkJCQkJCW1v
ZGVfbGliLT52YmEuRENDRW5hYmxlW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50TGF0
ZW5jeVBpeGVsRGF0YU9ubHksCisJCQkJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRFeHRyYUxhdGVu
Y3ksCisJCQkJCQkJbW9kZV9saWItPnZiYS5UQ2FsYywKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlBE
RUFuZE1ldGFQVEVCeXRlc0ZyYW1lW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuTWV0YVJvd0J5
dGVba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5QaXhlbFBURUJ5dGVzUGVyUm93W2tdLAorCQkJ
CQkJCW1vZGVfbGliLT52YmEuUHJlZmV0Y2hTb3VyY2VMaW5lc1lba10sCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5Td2F0aFdpZHRoWVtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhl
bERFVFlba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5WSW5pdFByZUZpbGxZW2tdLAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuTWF4TnVtU3dhdGhZW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUHJl
ZmV0Y2hTb3VyY2VMaW5lc0Nba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxE
RVRDW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuVkluaXRQcmVGaWxsQ1trXSwKKwkJCQkJCQlt
b2RlX2xpYi0+dmJhLk1heE51bVN3YXRoQ1trXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRo
SGVpZ2h0WVtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSwKKwkJCQkJ
CQlUV2FpdCwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ0VuYWJsZWRba10sCisJCQkJCQkJbW9k
ZV9saWItPnZiYS5YRkNSZW1vdGVTdXJmYWNlRmxpcERlbGF5LAorCQkJCQkJCW1vZGVfbGliLT52
YmEuSW50ZXJsYWNlW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUHJvZ3Jlc3NpdmVUb0ludGVy
bGFjZVVuaXRJbk9QUCwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLkRTVFhBZnRlclNjYWxlcltrXSwK
KwkJCQkJCQltb2RlX2xpYi0+dmJhLkRTVFlBZnRlclNjYWxlcltrXSwKKwkJCQkJCQkmbW9kZV9s
aWItPnZiYS5EZXN0aW5hdGlvbkxpbmVzRm9yUHJlZmV0Y2hba10sCisJCQkJCQkJJm1vZGVfbGli
LT52YmEuUHJlZmV0Y2hCYW5kd2lkdGhba10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEuRGVzdGlu
YXRpb25MaW5lc1RvUmVxdWVzdFZNSW5WQmxhbmtba10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEu
RGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rW2tdLAorCQkJCQkJCSZtb2RlX2xp
Yi0+dmJhLlZSYXRpb1ByZWZldGNoWVtrXSwKKwkJCQkJCQkmbW9kZV9saWItPnZiYS5WUmF0aW9Q
cmVmZXRjaENba10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEuUmVxdWlyZWRQcmVmZXRjaFBpeERh
dGFCV0x1bWFba10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEuVG5vX2J3W2tdLAorCQkJCQkJCSZt
b2RlX2xpYi0+dmJhLlZVcGRhdGVPZmZzZXRQaXhba10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEu
VlVwZGF0ZVdpZHRoUGl4W2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLlZSZWFkeU9mZnNldFBp
eFtrXSk7CisKKwkJCWlmIChtb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdID09IGsp
IHsKKwkJCQltb2RlX2xpYi0+dmJhLlZTdGFydHVwW2tdID0gZG1sX21pbigKKwkJCQkJCW1vZGVf
bGliLT52YmEuVlN0YXJ0dXBMaW5lcywKKwkJCQkJCW1vZGVfbGliLT52YmEuTWF4VlN0YXJ0dXBM
aW5lc1trXSk7CisJCQkJaWYgKG1vZGVfbGliLT52YmEuVlN0YXJ0dXBSZXF1aXJlZFdoZW5Ob3RF
bm91Z2hUaW1lRm9yRHluYW1pY01ldGFkYXRhCisJCQkJCQkhPSAwKSB7CisJCQkJCW1vZGVfbGli
LT52YmEuVlN0YXJ0dXBba10gPQorCQkJCQkJCW1vZGVfbGliLT52YmEuVlN0YXJ0dXBSZXF1aXJl
ZFdoZW5Ob3RFbm91Z2hUaW1lRm9yRHluYW1pY01ldGFkYXRhOworCQkJCX0KKwkJCX0gZWxzZSB7
CisJCQkJbW9kZV9saWItPnZiYS5WU3RhcnR1cFtrXSA9CisJCQkJCQlkbWxfbWluKAorCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLlZTdGFydHVwTGluZXMsCisJCQkJCQkJCW1vZGVfbGliLT52YmEuTWF4
VlN0YXJ0dXBMaW5lc1ttb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdXSk7CisJCQl9
CisJCX0KKworCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBs
YW5lczsgKytrKSB7CisKKwkJCWlmIChtb2RlX2xpYi0+dmJhLlBERUFuZE1ldGFQVEVCeXRlc0Zy
YW1lW2tdID09IDApCisJCQkJbW9kZV9saWItPnZiYS5wcmVmZXRjaF92bV9id1trXSA9IDA7CisJ
CQllbHNlIGlmIChtb2RlX2xpYi0+dmJhLkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluVkJs
YW5rW2tdID4gMCkgeworCQkJCW1vZGVfbGliLT52YmEucHJlZmV0Y2hfdm1fYndba10gPQorCQkJ
CQkJKGRvdWJsZSkgbW9kZV9saWItPnZiYS5QREVBbmRNZXRhUFRFQnl0ZXNGcmFtZVtrXQorCQkJ
CQkJCQkvIChtb2RlX2xpYi0+dmJhLkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluVkJsYW5r
W2tdCisJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkJCS8gbW9k
ZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKTsKKwkJCX0gZWxzZSB7CisJCQkJbW9kZV9saWItPnZi
YS5wcmVmZXRjaF92bV9id1trXSA9IDA7CisJCQkJcHJlZmV0Y2hfdm1fYndfdmFsaWQgPSBmYWxz
ZTsKKwkJCX0KKwkJCWlmIChtb2RlX2xpYi0+dmJhLk1ldGFSb3dCeXRlW2tdICsgbW9kZV9saWIt
PnZiYS5QaXhlbFBURUJ5dGVzUGVyUm93W2tdCisJCQkJCT09IDApCisJCQkJbW9kZV9saWItPnZi
YS5wcmVmZXRjaF9yb3dfYndba10gPSAwOworCQkJZWxzZSBpZiAobW9kZV9saWItPnZiYS5EZXN0
aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Um93SW5WQmxhbmtba10gPiAwKSB7CisJCQkJbW9kZV9saWIt
PnZiYS5wcmVmZXRjaF9yb3dfYndba10gPQorCQkJCQkJKGRvdWJsZSkgKG1vZGVfbGliLT52YmEu
TWV0YVJvd0J5dGVba10KKwkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLlBpeGVsUFRFQnl0ZXNQZXJS
b3dba10pCisJCQkJCQkJCS8gKG1vZGVfbGliLT52YmEuRGVzdGluYXRpb25MaW5lc1RvUmVxdWVz
dFJvd0luVkJsYW5rW2tdCisJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJ
CQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKTsKKwkJCX0gZWxzZSB7CisJCQkJ
bW9kZV9saWItPnZiYS5wcmVmZXRjaF9yb3dfYndba10gPSAwOworCQkJCXByZWZldGNoX3Jvd19i
d192YWxpZCA9IGZhbHNlOworCQkJfQorCisJCQlNYXhUb3RhbFJEQmFuZHdpZHRoID0KKwkJCQkJ
TWF4VG90YWxSREJhbmR3aWR0aCArIG1vZGVfbGliLT52YmEuY3Vyc29yX2J3W2tdCisJCQkJCQkJ
KyBkbWxfbWF4KAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5wcmVmZXRjaF92bV9id1trXSwKKwkJ
CQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEucHJlZmV0Y2hfcm93X2J3
W2tdLAorCQkJCQkJCQkJCQlkbWxfbWF4KAorCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuUmVh
ZEJhbmR3aWR0aFBsYW5lTHVtYVtrXQorCQkJCQkJCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLlJl
YWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXSwKKwkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlJl
cXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldMdW1hW2tdKQorCQkJCQkJCQkJCQkJCSsgbW9kZV9saWIt
PnZiYS5tZXRhX3Jvd19id1trXQorCQkJCQkJCQkJCQkJCSsgbW9kZV9saWItPnZiYS5kcHRlX3Jv
d19id1trXSkpOworCisJCQlpZiAobW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxpbmVzRm9yUHJl
ZmV0Y2hba10gPCAyKQorCQkJCURlc3RpbmF0aW9uTGluZVRpbWVzRm9yUHJlZmV0Y2hMZXNzVGhh
bjIgPSB0cnVlOworCQkJaWYgKG1vZGVfbGliLT52YmEuVlJhdGlvUHJlZmV0Y2hZW2tdID4gNAor
CQkJCQl8fCBtb2RlX2xpYi0+dmJhLlZSYXRpb1ByZWZldGNoQ1trXSA+IDQpCisJCQkJVlJhdGlv
UHJlZmV0Y2hNb3JlVGhhbjQgPSB0cnVlOworCQl9CisKKwkJaWYgKE1heFRvdGFsUkRCYW5kd2lk
dGggPD0gbW9kZV9saWItPnZiYS5SZXR1cm5CVyAmJiBwcmVmZXRjaF92bV9id192YWxpZAorCQkJ
CSYmIHByZWZldGNoX3Jvd19id192YWxpZCAmJiAhVlJhdGlvUHJlZmV0Y2hNb3JlVGhhbjQKKwkJ
CQkmJiAhRGVzdGluYXRpb25MaW5lVGltZXNGb3JQcmVmZXRjaExlc3NUaGFuMikKKwkJCW1vZGVf
bGliLT52YmEuUHJlZmV0Y2hNb2RlU3VwcG9ydGVkID0gdHJ1ZTsKKwkJZWxzZSB7CisJCQltb2Rl
X2xpYi0+dmJhLlByZWZldGNoTW9kZVN1cHBvcnRlZCA9IGZhbHNlOworCQkJZG1sX3ByaW50KAor
CQkJCQkiRE1MOiBDYWxjdWxhdGVQcmVmZXRjaFNjaGVkdWxlICoqKmZhaWxlZCoqKi4gQmFuZHdp
ZHRoIHZpb2xhdGlvbi4gUmVzdWx0cyBhcmUgTk9UIHZhbGlkXG4iKTsKKwkJfQorCisJCWlmICht
b2RlX2xpYi0+dmJhLlByZWZldGNoTW9kZVN1cHBvcnRlZCA9PSB0cnVlKSB7CisJCQlkb3VibGUg
ZmluYWxfZmxpcF9id1tEQ19fTlVNX0RQUF9fTUFYXTsKKwkJCXVuc2lnbmVkIGludCBJbW1lZGlh
dGVGbGlwQnl0ZXNbRENfX05VTV9EUFBfX01BWF07CisJCQlkb3VibGUgdG90YWxfZGNuX3JlYWRf
Yndfd2l0aF9mbGlwID0gMDsKKworCQkJbW9kZV9saWItPnZiYS5CYW5kd2lkdGhBdmFpbGFibGVG
b3JJbW1lZGlhdGVGbGlwID0gbW9kZV9saWItPnZiYS5SZXR1cm5CVzsKKwkJCWZvciAoayA9IDA7
IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJCQltb2Rl
X2xpYi0+dmJhLkJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAgPQorCQkJCQkJbW9k
ZV9saWItPnZiYS5CYW5kd2lkdGhBdmFpbGFibGVGb3JJbW1lZGlhdGVGbGlwCisJCQkJCQkJCS0g
bW9kZV9saWItPnZiYS5jdXJzb3JfYndba10KKwkJCQkJCQkJLSBkbWxfbWF4KAorCQkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuUmVhZEJhbmR3aWR0aFBsYW5lTHVtYVtrXQorCQkJCQkJCQkJCQkJKyBt
b2RlX2xpYi0+dmJhLlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXQorCQkJCQkJCQkJCQkJKyBt
b2RlX2xpYi0+dmJhLnF1YWxfcm93X2J3W2tdLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuUHJl
ZmV0Y2hCYW5kd2lkdGhba10pOworCQkJfQorCisJCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCQkJSW1tZWRpYXRlRmxpcEJ5dGVz
W2tdID0gMDsKKwkJCQlpZiAoKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0g
ZG1fNDIwXzgKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0g
ZG1fNDIwXzEwKSkgeworCQkJCQlJbW1lZGlhdGVGbGlwQnl0ZXNba10gPQorCQkJCQkJCW1vZGVf
bGliLT52YmEuUERFQW5kTWV0YVBURUJ5dGVzRnJhbWVba10KKwkJCQkJCQkJCSsgbW9kZV9saWIt
PnZiYS5NZXRhUm93Qnl0ZVtrXQorCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLlBpeGVsUFRFQnl0
ZXNQZXJSb3dba107CisJCQkJfQorCQkJfQorCQkJbW9kZV9saWItPnZiYS5Ub3RJbW1lZGlhdGVG
bGlwQnl0ZXMgPSAwOworCQkJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZB
Y3RpdmVQbGFuZXM7ICsraykgeworCQkJCWlmICgobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZv
cm1hdFtrXSAhPSBkbV80MjBfOAorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZv
cm1hdFtrXSAhPSBkbV80MjBfMTApKSB7CisJCQkJCW1vZGVfbGliLT52YmEuVG90SW1tZWRpYXRl
RmxpcEJ5dGVzID0KKwkJCQkJCQltb2RlX2xpYi0+dmJhLlRvdEltbWVkaWF0ZUZsaXBCeXRlcwor
CQkJCQkJCQkJKyBJbW1lZGlhdGVGbGlwQnl0ZXNba107CisJCQkJfQorCQkJfQorCQkJZm9yIChr
ID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQkJ
CUNhbGN1bGF0ZUZsaXBTY2hlZHVsZSgKKwkJCQkJCW1vZGVfbGliLAorCQkJCQkJbW9kZV9saWIt
PnZiYS5VcmdlbnRFeHRyYUxhdGVuY3ksCisJCQkJCQltb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVu
Y3lQaXhlbERhdGFPbmx5LAorCQkJCQkJbW9kZV9saWItPnZiYS5HUFVWTU1heFBhZ2VUYWJsZUxl
dmVscywKKwkJCQkJCW1vZGVfbGliLT52YmEuR1BVVk1FbmFibGUsCisJCQkJCQltb2RlX2xpYi0+
dmJhLkJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAsCisJCQkJCQltb2RlX2xpYi0+
dmJhLlRvdEltbWVkaWF0ZUZsaXBCeXRlcywKKwkJCQkJCW1vZGVfbGliLT52YmEuU291cmNlUGl4
ZWxGb3JtYXRba10sCisJCQkJCQlJbW1lZGlhdGVGbGlwQnl0ZXNba10sCisJCQkJCQltb2RlX2xp
Yi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSwK
KwkJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCQkJbW9kZV9saWItPnZiYS5Ubm9f
Yndba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlBERUFuZE1ldGFQVEVCeXRlc0ZyYW1lW2tdLAor
CQkJCQkJbW9kZV9saWItPnZiYS5NZXRhUm93Qnl0ZVtrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEu
UGl4ZWxQVEVCeXRlc1BlclJvd1trXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuRENDRW5hYmxlW2td
LAorCQkJCQkJbW9kZV9saWItPnZiYS5kcHRlX3Jvd19oZWlnaHRba10sCisJCQkJCQltb2RlX2xp
Yi0+dmJhLm1ldGFfcm93X2hlaWdodFtrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEucXVhbF9yb3df
Yndba10sCisJCQkJCQkmbW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1J
bkltbWVkaWF0ZUZsaXBba10sCisJCQkJCQkmbW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxpbmVz
VG9SZXF1ZXN0Um93SW5JbW1lZGlhdGVGbGlwW2tdLAorCQkJCQkJJmZpbmFsX2ZsaXBfYndba10s
CisJCQkJCQkmbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkRm9yUGlwZVtrXSk7
CisJCQl9CisJCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBs
YW5lczsgKytrKSB7CisJCQkJdG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwID0KKwkJCQkJCXRv
dGFsX2Rjbl9yZWFkX2J3X3dpdGhfZmxpcAorCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuY3Vyc29y
X2J3W2tdCisJCQkJCQkJCSsgZG1sX21heCgKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLnByZWZl
dGNoX3ZtX2J3W2tdLAorCQkJCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLnByZWZldGNoX3Jvd19id1trXSwKKwkJCQkJCQkJCQkJCWZpbmFsX2ZsaXBfYndba10KKwkJ
CQkJCQkJCQkJCQkJKyBkbWxfbWF4KAorCQkJCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuUmVh
ZEJhbmR3aWR0aFBsYW5lTHVtYVtrXQorCQkJCQkJCQkJCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJh
LlJlYWRCYW5kd2lkdGhQbGFuZUNocm9tYVtrXSwKKwkJCQkJCQkJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLlJlcXVpcmVkUHJlZmV0Y2hQaXhEYXRhQldMdW1hW2tdKSkpOworCQkJfQorCQkJbW9kZV9s
aWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkID0gdHJ1ZTsKKwkJCWlmICh0b3RhbF9kY25f
cmVhZF9id193aXRoX2ZsaXAgPiBtb2RlX2xpYi0+dmJhLlJldHVybkJXKSB7CisJCQkJbW9kZV9s
aWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkID0gZmFsc2U7CisJCQl9CisJCQlmb3IgKGsg
PSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCQkJ
aWYgKG1vZGVfbGliLT52YmEuSW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclBpcGVba10gPT0gZmFs
c2UpIHsKKwkJCQkJbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkID0gZmFsc2U7
CisJCQkJfQorCQkJfQorCQl9IGVsc2UgeworCQkJbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlw
U3VwcG9ydGVkID0gZmFsc2U7CisJCX0KKworCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZi
YS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5FcnJv
clJlc3VsdFtrXSkgeworCQkJCW1vZGVfbGliLT52YmEuUHJlZmV0Y2hNb2RlU3VwcG9ydGVkID0g
ZmFsc2U7CisJCQkJZG1sX3ByaW50KAorCQkJCQkJIkRNTDogQ2FsY3VsYXRlUHJlZmV0Y2hTY2hl
ZHVsZSAqKipmYWlsZWQqKiouIFByZWZldGNoIHNjaGVkdWxlIHZpb2xhdGlvbi4gUmVzdWx0cyBh
cmUgTk9UIHZhbGlkXG4iKTsKKwkJCX0KKwkJfQorCisJCW1vZGVfbGliLT52YmEuVlN0YXJ0dXBM
aW5lcyA9IG1vZGVfbGliLT52YmEuVlN0YXJ0dXBMaW5lcyArIDE7CisJfSB3aGlsZSAoISgobW9k
ZV9saWItPnZiYS5QcmVmZXRjaE1vZGVTdXBwb3J0ZWQKKwkJCSYmICghbW9kZV9saWItPnZiYS5J
bW1lZGlhdGVGbGlwU3VwcG9ydAorCQkJCQl8fCBtb2RlX2xpYi0+dmJhLkltbWVkaWF0ZUZsaXBT
dXBwb3J0ZWQpKQorCQkJfHwgbW9kZV9saWItPnZiYS5NYXhpbXVtTWF4VlN0YXJ0dXBMaW5lcyA8
IG1vZGVfbGliLT52YmEuVlN0YXJ0dXBMaW5lcykpOworCisJLy9EaXNwbGF5IFBpcGVsaW5lIERl
bGl2ZXJ5IFRpbWUgaW4gUHJlZmV0Y2gKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5O
dW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLlZSYXRpb1By
ZWZldGNoWVtrXSA8PSAxKSB7CisJCQltb2RlX2xpYi0+dmJhLkRpc3BsYXlQaXBlTGluZURlbGl2
ZXJ5VGltZUx1bWFQcmVmZXRjaFtrXSA9CisJCQkJCW1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlb
a10gKiBtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdCisJCQkJCQkJLyBtb2RlX2xpYi0+dmJh
LkhSYXRpb1trXQorCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdOworCQl9IGVs
c2UgeworCQkJbW9kZV9saWItPnZiYS5EaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRpbWVMdW1hUHJl
ZmV0Y2hba10gPQorCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdCisJCQkJCQkJLyBt
b2RlX2xpYi0+dmJhLlBTQ0xfVEhST1VHSFBVVF9MVU1BW2tdCisJCQkJCQkJLyBtb2RlX2xpYi0+
dmJhLkRQUENMS1trXTsKKwkJfQorCQlpZiAobW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxERVRD
W2tdID09IDApIHsKKwkJCW1vZGVfbGliLT52YmEuRGlzcGxheVBpcGVMaW5lRGVsaXZlcnlUaW1l
Q2hyb21hUHJlZmV0Y2hba10gPSAwOworCQl9IGVsc2UgeworCQkJaWYgKG1vZGVfbGliLT52YmEu
VlJhdGlvUHJlZmV0Y2hDW2tdIDw9IDEpIHsKKwkJCQltb2RlX2xpYi0+dmJhLkRpc3BsYXlQaXBl
TGluZURlbGl2ZXJ5VGltZUNocm9tYVByZWZldGNoW2tdID0KKwkJCQkJCW1vZGVfbGliLT52YmEu
U3dhdGhXaWR0aFlba10KKwkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdCisJ
CQkJCQkJCS8gbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJLyBtb2RlX2xpYi0+dmJh
LlBpeGVsQ2xvY2tba107CisJCQl9IGVsc2UgeworCQkJCW1vZGVfbGliLT52YmEuRGlzcGxheVBp
cGVMaW5lRGVsaXZlcnlUaW1lQ2hyb21hUHJlZmV0Y2hba10gPQorCQkJCQkJbW9kZV9saWItPnZi
YS5Td2F0aFdpZHRoWVtrXQorCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuUFNDTF9USFJPVUdIUFVU
X0xVTUFba10KKwkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkRQUENMS1trXTsKKwkJCX0KKwkJfQor
CX0KKworCS8vIE1pbiBUVFVWQmxhbmsKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5O
dW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLlByZWZldGNo
TW9kZVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1bbW9kZV9saWItPnZiYS5tYXhNcGNDb21i
XSA9PSAwKSB7CisJCQltb2RlX2xpYi0+dmJhLkFsbG93RFJBTUNsb2NrQ2hhbmdlRHVyaW5nVkJs
YW5rW2tdID0gdHJ1ZTsKKwkJCW1vZGVfbGliLT52YmEuQWxsb3dEUkFNU2VsZlJlZnJlc2hEdXJp
bmdWQmxhbmtba10gPSB0cnVlOworCQkJbW9kZV9saWItPnZiYS5NaW5UVFVWQmxhbmtba10gPSBk
bWxfbWF4KAorCQkJCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZVdhdGVybWFyaywKKwkJ
CQkJZG1sX21heCgKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlN0dXR0ZXJFbnRlclBsdXNFeGl0V2F0
ZXJtYXJrLAorCQkJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50V2F0ZXJtYXJrKSk7CisJCX0gZWxz
ZSBpZiAobW9kZV9saWItPnZiYS5QcmVmZXRjaE1vZGVbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2
ZWxdW21vZGVfbGliLT52YmEubWF4TXBjQ29tYl0gPT0gMSkgeworCQkJbW9kZV9saWItPnZiYS5B
bGxvd0RSQU1DbG9ja0NoYW5nZUR1cmluZ1ZCbGFua1trXSA9IGZhbHNlOworCQkJbW9kZV9saWIt
PnZiYS5BbGxvd0RSQU1TZWxmUmVmcmVzaER1cmluZ1ZCbGFua1trXSA9IHRydWU7CisJCQltb2Rl
X2xpYi0+dmJhLk1pblRUVVZCbGFua1trXSA9IGRtbF9tYXgoCisJCQkJCW1vZGVfbGliLT52YmEu
U3R1dHRlckVudGVyUGx1c0V4aXRXYXRlcm1hcmssCisJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50
V2F0ZXJtYXJrKTsKKwkJfSBlbHNlIHsKKwkJCW1vZGVfbGliLT52YmEuQWxsb3dEUkFNQ2xvY2tD
aGFuZ2VEdXJpbmdWQmxhbmtba10gPSBmYWxzZTsKKwkJCW1vZGVfbGliLT52YmEuQWxsb3dEUkFN
U2VsZlJlZnJlc2hEdXJpbmdWQmxhbmtba10gPSBmYWxzZTsKKwkJCW1vZGVfbGliLT52YmEuTWlu
VFRVVkJsYW5rW2tdID0gbW9kZV9saWItPnZiYS5VcmdlbnRXYXRlcm1hcms7CisJCX0KKwkJaWYg
KCFtb2RlX2xpYi0+dmJhLkR5bmFtaWNNZXRhZGF0YUVuYWJsZVtrXSkKKwkJCW1vZGVfbGliLT52
YmEuTWluVFRVVkJsYW5rW2tdID0gbW9kZV9saWItPnZiYS5UQ2FsYworCQkJCQkrIG1vZGVfbGli
LT52YmEuTWluVFRVVkJsYW5rW2tdOworCX0KKworCS8vIERDQyBDb25maWd1cmF0aW9uCisJbW9k
ZV9saWItPnZiYS5BY3RpdmVEUFBzID0gMDsKKwkvLyBOQiBQLVN0YXRlL0RSQU0gQ2xvY2sgQ2hh
bmdlIFN1cHBvcnQKKwlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2
ZVBsYW5lczsgKytrKSB7CisJCW1vZGVfbGliLT52YmEuQWN0aXZlRFBQcyA9IG1vZGVfbGliLT52
YmEuQWN0aXZlRFBQcyArIG1vZGVfbGliLT52YmEuRFBQUGVyUGxhbmVba107CisJfQorCisJZm9y
IChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXM7ICsraykgewor
CQlkb3VibGUgRWZmZWN0aXZlTEJMYXRlbmN5SGlkaW5nWTsKKwkJZG91YmxlIEVmZmVjdGl2ZUxC
TGF0ZW5jeUhpZGluZ0M7CisJCWRvdWJsZSBEUFBPdXRwdXRCdWZmZXJMaW5lc1k7CisJCWRvdWJs
ZSBEUFBPdXRwdXRCdWZmZXJMaW5lc0M7CisJCWRvdWJsZSBEUFBPUFBCdWZmZXJpbmdZOworCQlk
b3VibGUgTWF4REVUQnVmZmVyaW5nVGltZVk7CisJCWRvdWJsZSBBY3RpdmVEUkFNQ2xvY2tDaGFu
Z2VMYXRlbmN5TWFyZ2luWTsKKworCQltb2RlX2xpYi0+dmJhLkxCTGF0ZW5jeUhpZGluZ1NvdXJj
ZUxpbmVzWSA9CisJCQkJZG1sX21pbigKKwkJCQkJCW1vZGVfbGliLT52YmEuTWF4TGluZUJ1ZmZl
ckxpbmVzLAorCQkJCQkJKHVuc2lnbmVkIGludCkgZG1sX2Zsb29yKAorCQkJCQkJCQkoZG91Ymxl
KSBtb2RlX2xpYi0+dmJhLkxpbmVCdWZmZXJTaXplCisJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJh
LkxCQml0UGVyUGl4ZWxba10KKwkJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZ
W2tdCisJCQkJCQkJCQkJCQkvIGRtbF9tYXgoCisJCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEu
SFJhdGlvW2tdLAorCQkJCQkJCQkJCQkJCQkxLjApKSwKKwkJCQkJCQkJMSkpIC0gKG1vZGVfbGli
LT52YmEudnRhcHNba10gLSAxKTsKKworCQltb2RlX2xpYi0+dmJhLkxCTGF0ZW5jeUhpZGluZ1Nv
dXJjZUxpbmVzQyA9CisJCQkJZG1sX21pbigKKwkJCQkJCW1vZGVfbGliLT52YmEuTWF4TGluZUJ1
ZmZlckxpbmVzLAorCQkJCQkJKHVuc2lnbmVkIGludCkgZG1sX2Zsb29yKAorCQkJCQkJCQkoZG91
YmxlKSBtb2RlX2xpYi0+dmJhLkxpbmVCdWZmZXJTaXplCisJCQkJCQkJCQkJLyBtb2RlX2xpYi0+
dmJhLkxCQml0UGVyUGl4ZWxba10KKwkJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLlN3YXRoV2lk
dGhZW2tdCisJCQkJCQkJCQkJCQkvIDIuMAorCQkJCQkJCQkJCQkJLyBkbWxfbWF4KAorCQkJCQkJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLkhSYXRpb1trXQorCQkJCQkJCQkJCQkJCQkJCS8gMiwKKwkJ
CQkJCQkJCQkJCQkJMS4wKSksCisJCQkJCQkJCTEpKQorCQkJCQkJLSAobW9kZV9saWItPnZiYS5W
VEFQc0Nocm9tYVtrXSAtIDEpOworCisJCUVmZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ1kgPSBtb2Rl
X2xpYi0+dmJhLkxCTGF0ZW5jeUhpZGluZ1NvdXJjZUxpbmVzWQorCQkJCS8gbW9kZV9saWItPnZi
YS5WUmF0aW9ba10KKwkJCQkqIChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvIG1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja1trXSk7CisKKwkJRWZmZWN0aXZlTEJMYXRlbmN5SGlkaW5nQyA9IG1vZGVf
bGliLT52YmEuTEJMYXRlbmN5SGlkaW5nU291cmNlTGluZXNDCisJCQkJLyAobW9kZV9saWItPnZi
YS5WUmF0aW9ba10gLyAyKQorCQkJCSogKG1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9kZV9s
aWItPnZiYS5QaXhlbENsb2NrW2tdKTsKKworCQlpZiAobW9kZV9saWItPnZiYS5Td2F0aFdpZHRo
WVtrXSA+IDIgKiBtb2RlX2xpYi0+dmJhLkRQUE91dHB1dEJ1ZmZlclBpeGVscykgeworCQkJRFBQ
T3V0cHV0QnVmZmVyTGluZXNZID0gbW9kZV9saWItPnZiYS5EUFBPdXRwdXRCdWZmZXJQaXhlbHMK
KwkJCQkJLyBtb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdOworCQl9IGVsc2UgaWYgKG1vZGVf
bGliLT52YmEuU3dhdGhXaWR0aFlba10gPiBtb2RlX2xpYi0+dmJhLkRQUE91dHB1dEJ1ZmZlclBp
eGVscykgeworCQkJRFBQT3V0cHV0QnVmZmVyTGluZXNZID0gMC41OworCQl9IGVsc2UgeworCQkJ
RFBQT3V0cHV0QnVmZmVyTGluZXNZID0gMTsKKwkJfQorCisJCWlmIChtb2RlX2xpYi0+dmJhLlN3
YXRoV2lkdGhZW2tdIC8gMiA+IDIgKiBtb2RlX2xpYi0+dmJhLkRQUE91dHB1dEJ1ZmZlclBpeGVs
cykgeworCQkJRFBQT3V0cHV0QnVmZmVyTGluZXNDID0gbW9kZV9saWItPnZiYS5EUFBPdXRwdXRC
dWZmZXJQaXhlbHMKKwkJCQkJLyAobW9kZV9saWItPnZiYS5Td2F0aFdpZHRoWVtrXSAvIDIpOwor
CQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlba10gLyAyID4gbW9kZV9saWIt
PnZiYS5EUFBPdXRwdXRCdWZmZXJQaXhlbHMpIHsKKwkJCURQUE91dHB1dEJ1ZmZlckxpbmVzQyA9
IDAuNTsKKwkJfSBlbHNlIHsKKwkJCURQUE91dHB1dEJ1ZmZlckxpbmVzQyA9IDE7CisJCX0KKwor
CQlEUFBPUFBCdWZmZXJpbmdZID0gKG1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdKQorCQkJCSogKERQUE91dHB1dEJ1ZmZlckxpbmVzWSArIG1vZGVf
bGliLT52YmEuT1BQT3V0cHV0QnVmZmVyTGluZXMpOworCQlNYXhERVRCdWZmZXJpbmdUaW1lWSA9
IG1vZGVfbGliLT52YmEuRnVsbERFVEJ1ZmZlcmluZ1RpbWVZW2tdCisJCQkJKyAobW9kZV9saWIt
PnZiYS5MaW5lc0luREVUWVtrXQorCQkJCQkJLSBtb2RlX2xpYi0+dmJhLkxpbmVzSW5ERVRZUm91
bmRlZERvd25Ub1N3YXRoW2tdKQorCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0WVtr
XQorCQkJCQkJKiAobW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJCQkJLyBtb2RlX2xpYi0+
dmJhLlBpeGVsQ2xvY2tba10pOworCisJCUFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJn
aW5ZID0gRFBQT1BQQnVmZmVyaW5nWSArIEVmZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ1kKKwkJCQkr
IE1heERFVEJ1ZmZlcmluZ1RpbWVZIC0gbW9kZV9saWItPnZiYS5EUkFNQ2xvY2tDaGFuZ2VXYXRl
cm1hcms7CisKKwkJaWYgKG1vZGVfbGliLT52YmEuQWN0aXZlRFBQcyA+IDEpIHsKKwkJCUFjdGl2
ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5ZID0KKwkJCQkJQWN0aXZlRFJBTUNsb2NrQ2hh
bmdlTGF0ZW5jeU1hcmdpblkKKwkJCQkJCQktICgxIC0gMSAvIChtb2RlX2xpYi0+dmJhLkFjdGl2
ZURQUHMgLSAxKSkKKwkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5Td2F0aEhlaWdodFlba10KKwkJ
CQkJCQkJCSogKG1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJCQkJCS8gbW9kZV9saWIt
PnZiYS5QaXhlbENsb2NrW2tdKTsKKwkJfQorCisJCWlmIChtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQ
aXhlbERFVENba10gPiAwKSB7CisJCQlkb3VibGUgRFBQT1BQQnVmZmVyaW5nQyA9IChtb2RlX2xp
Yi0+dmJhLkhUb3RhbFtrXQorCQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkKKwkJ
CQkJKiAoRFBQT3V0cHV0QnVmZmVyTGluZXNDCisJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLk9QUE91
dHB1dEJ1ZmZlckxpbmVzKTsKKwkJCWRvdWJsZSBNYXhERVRCdWZmZXJpbmdUaW1lQyA9CisJCQkJ
CW1vZGVfbGliLT52YmEuRnVsbERFVEJ1ZmZlcmluZ1RpbWVDW2tdCisJCQkJCQkJKyAobW9kZV9s
aWItPnZiYS5MaW5lc0luREVUQ1trXQorCQkJCQkJCQkJLSBtb2RlX2xpYi0+dmJhLkxpbmVzSW5E
RVRDUm91bmRlZERvd25Ub1N3YXRoW2tdKQorCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlN3YXRo
SGVpZ2h0Q1trXQorCQkJCQkJCQkJKiAobW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJCQkJ
CQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pOworCQkJZG91YmxlIEFjdGl2ZURSQU1D
bG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5DID0gRFBQT1BQQnVmZmVyaW5nQworCQkJCQkrIEVmZmVj
dGl2ZUxCTGF0ZW5jeUhpZGluZ0MgKyBNYXhERVRCdWZmZXJpbmdUaW1lQworCQkJCQktIG1vZGVf
bGliLT52YmEuRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrOworCisJCQlpZiAobW9kZV9saWItPnZi
YS5BY3RpdmVEUFBzID4gMSkgeworCQkJCUFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJn
aW5DID0KKwkJCQkJCUFjdGl2ZURSQU1DbG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5DCisJCQkJCQkJ
CS0gKDEKKwkJCQkJCQkJCQktIDEKKwkJCQkJCQkJCQkJCS8gKG1vZGVfbGliLT52YmEuQWN0aXZl
RFBQcworCQkJCQkJCQkJCQkJCQktIDEpKQorCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5Td2F0
aEhlaWdodENba10KKwkJCQkJCQkJCQkqIChtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJ
CQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pOworCQkJfQorCQkJbW9kZV9saWIt
PnZiYS5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luW2tdID0gZG1sX21pbigKKwkJ
CQkJQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1hcmdpblksCisJCQkJCUFjdGl2ZURSQU1D
bG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5DKTsKKwkJfSBlbHNlIHsKKwkJCW1vZGVfbGliLT52YmEu
QWN0aXZlRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1hcmdpbltrXSA9CisJCQkJCUFjdGl2ZURSQU1D
bG9ja0NoYW5nZUxhdGVuY3lNYXJnaW5ZOworCQl9CisKKwkJaWYgKG1vZGVfbGliLT52YmEuV3Jp
dGViYWNrRW5hYmxlW2tdKSB7CisJCQlkb3VibGUgV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlTGF0
ZW5jeU1hcmdpbjsKKworCQkJaWYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRb
a10gPT0gZG1fNDQ0XzMyKSB7CisJCQkJV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1h
cmdpbiA9CisJCQkJCQkoZG91YmxlKSAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tJbnRlcmZhY2VM
dW1hQnVmZmVyU2l6ZQorCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuV3JpdGViYWNrSW50ZXJmYWNl
Q2hyb21hQnVmZmVyU2l6ZSkKKwkJCQkJCQkJLyAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEZXN0
aW5hdGlvbldpZHRoW2tdCisJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3Rp
bmF0aW9uSGVpZ2h0W2tdCisJCQkJCQkJCQkJLyAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tTb3Vy
Y2VIZWlnaHRba10KKwkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJ
CQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKQorCQkJCQkJCQkJCSogNCkKKwkJ
CQkJCQkJLSBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0RSQU1DbG9ja0NoYW5nZVdhdGVybWFyazsK
KwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSA9PSBk
bV80MjBfMTApIHsKKwkJCQlXcml0ZWJhY2tEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luID0K
KwkJCQkJCWRtbF9taW4oCisJCQkJCQkJCShkb3VibGUpIG1vZGVfbGliLT52YmEuV3JpdGViYWNr
SW50ZXJmYWNlTHVtYUJ1ZmZlclNpemUKKwkJCQkJCQkJCQkqIDguMCAvIDEwLAorCQkJCQkJCQky
LjAKKwkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuV3JpdGViYWNrSW50ZXJmYWNlQ2hyb21hQnVm
ZmVyU2l6ZQorCQkJCQkJCQkJCSogOCAvIDEwKQorCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLldy
aXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuV3Jp
dGViYWNrRGVzdGluYXRpb25IZWlnaHRba10KKwkJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLldy
aXRlYmFja1NvdXJjZUhlaWdodFtrXQorCQkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhUb3Rh
bFtrXQorCQkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pKQorCQkJCQkJ
CQktIG1vZGVfbGliLT52YmEuV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlV2F0ZXJtYXJrOworCQkJ
fSBlbHNlIHsKKwkJCQlXcml0ZWJhY2tEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5TWFyZ2luID0KKwkJ
CQkJCWRtbF9taW4oCisJCQkJCQkJCShkb3VibGUpIG1vZGVfbGliLT52YmEuV3JpdGViYWNrSW50
ZXJmYWNlTHVtYUJ1ZmZlclNpemUsCisJCQkJCQkJCTIuMAorCQkJCQkJCQkJCSogbW9kZV9saWIt
PnZiYS5Xcml0ZWJhY2tJbnRlcmZhY2VDaHJvbWFCdWZmZXJTaXplKQorCQkJCQkJCQkvIChtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJCQkJCQkqIG1vZGVf
bGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25IZWlnaHRba10KKwkJCQkJCQkJCQkvIChtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja1NvdXJjZUhlaWdodFtrXQorCQkJCQkJCQkJCQkJKiBtb2RlX2xp
Yi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tb
a10pKQorCQkJCQkJCQktIG1vZGVfbGliLT52YmEuV3JpdGViYWNrRFJBTUNsb2NrQ2hhbmdlV2F0
ZXJtYXJrOworCQkJfQorCQkJbW9kZV9saWItPnZiYS5BY3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRl
bmN5TWFyZ2luW2tdID0gZG1sX21pbigKKwkJCQkJbW9kZV9saWItPnZiYS5BY3RpdmVEUkFNQ2xv
Y2tDaGFuZ2VMYXRlbmN5TWFyZ2luW2tdLAorCQkJCQlXcml0ZWJhY2tEUkFNQ2xvY2tDaGFuZ2VM
YXRlbmN5TWFyZ2luKTsKKwkJfQorCX0KKworCW1vZGVfbGliLT52YmEuTWluQWN0aXZlRFJBTUNs
b2NrQ2hhbmdlTWFyZ2luID0gOTk5OTk5OworCWZvciAoayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJaWYgKG1vZGVfbGliLT52YmEuQWN0aXZl
RFJBTUNsb2NrQ2hhbmdlTGF0ZW5jeU1hcmdpbltrXQorCQkJCTwgbW9kZV9saWItPnZiYS5NaW5B
Y3RpdmVEUkFNQ2xvY2tDaGFuZ2VNYXJnaW4pIHsKKwkJCW1vZGVfbGliLT52YmEuTWluQWN0aXZl
RFJBTUNsb2NrQ2hhbmdlTWFyZ2luID0KKwkJCQkJbW9kZV9saWItPnZiYS5BY3RpdmVEUkFNQ2xv
Y2tDaGFuZ2VMYXRlbmN5TWFyZ2luW2tdOworCQl9CisJfQorCisJbW9kZV9saWItPnZiYS5NaW5B
Y3RpdmVEUkFNQ2xvY2tDaGFuZ2VMYXRlbmN5U3VwcG9ydGVkID0KKwkJCW1vZGVfbGliLT52YmEu
TWluQWN0aXZlRFJBTUNsb2NrQ2hhbmdlTWFyZ2luCisJCQkJCSsgbW9kZV9saWItPnZiYS5EUkFN
Q2xvY2tDaGFuZ2VMYXRlbmN5OworCisJaWYgKG1vZGVfbGliLT52YmEuTWluQWN0aXZlRFJBTUNs
b2NrQ2hhbmdlTWFyZ2luID4gMCkgeworCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZVN1
cHBvcnRbMF1bMF0gPSBkbV9kcmFtX2Nsb2NrX2NoYW5nZV92YWN0aXZlOworCX0gZWxzZSB7CisJ
CWlmIChtb2RlX2xpYi0+dmJhLlN5bmNocm9uaXplZFZCbGFuayB8fCBtb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzID09IDEpIHsKKwkJCW1vZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hh
bmdlU3VwcG9ydFswXVswXSA9IGRtX2RyYW1fY2xvY2tfY2hhbmdlX3ZibGFuazsKKwkJCWZvciAo
ayA9IDA7IGsgPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2spIHsKKwkJ
CQlpZiAoIW1vZGVfbGliLT52YmEuQWxsb3dEUkFNQ2xvY2tDaGFuZ2VEdXJpbmdWQmxhbmtba10p
IHsKKwkJCQkJbW9kZV9saWItPnZiYS5EUkFNQ2xvY2tDaGFuZ2VTdXBwb3J0WzBdWzBdID0KKwkJ
CQkJCQlkbV9kcmFtX2Nsb2NrX2NoYW5nZV91bnN1cHBvcnRlZDsKKwkJCQl9CisJCQl9CisJCX0g
ZWxzZSB7CisJCQltb2RlX2xpYi0+dmJhLkRSQU1DbG9ja0NoYW5nZVN1cHBvcnRbMF1bMF0gPSBk
bV9kcmFtX2Nsb2NrX2NoYW5nZV91bnN1cHBvcnRlZDsKKwkJfQorCX0KKwlmb3IgKGsgPSAwOyBr
IDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7IGsrKykKKwkJZm9yIChqID0gMDsgaiA8
IDI7IGorKykKKwkJCW1vZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFtrXVtqXSA9
IG1vZGVfbGliLT52YmEuRFJBTUNsb2NrQ2hhbmdlU3VwcG9ydFswXVswXTsKKworCS8vWEZDIFBh
cmFtZXRlcnM6CisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQ
bGFuZXM7ICsraykgeworCQlpZiAobW9kZV9saWItPnZiYS5YRkNFbmFibGVkW2tdID09IHRydWUp
IHsKKwkJCWRvdWJsZSBUV2FpdDsKKworCQkJbW9kZV9saWItPnZiYS5YRkNTbGF2ZVZVcGRhdGVP
ZmZzZXRba10gPSBtb2RlX2xpYi0+dmJhLlhGQ1RTbHZWdXBkYXRlT2Zmc2V0OworCQkJbW9kZV9s
aWItPnZiYS5YRkNTbGF2ZVZ1cGRhdGVXaWR0aFtrXSA9IG1vZGVfbGliLT52YmEuWEZDVFNsdlZ1
cGRhdGVXaWR0aDsKKwkJCW1vZGVfbGliLT52YmEuWEZDU2xhdmVWUmVhZHlPZmZzZXRba10gPSBt
b2RlX2xpYi0+dmJhLlhGQ1RTbHZWcmVhZHlPZmZzZXQ7CisJCQlUV2FpdCA9IENhbGN1bGF0ZVRX
YWl0KAorCQkJCQltb2RlX2xpYi0+dmJhLlByZWZldGNoTW9kZVttb2RlX2xpYi0+dmJhLlZvbHRh
Z2VMZXZlbF1bbW9kZV9saWItPnZiYS5tYXhNcGNDb21iXSwKKwkJCQkJbW9kZV9saWItPnZiYS5E
UkFNQ2xvY2tDaGFuZ2VMYXRlbmN5LAorCQkJCQltb2RlX2xpYi0+dmJhLlVyZ2VudExhdGVuY3lQ
aXhlbERhdGFPbmx5LAorCQkJCQltb2RlX2xpYi0+dmJhLlNSRW50ZXJQbHVzRXhpdFRpbWUpOwor
CQkJbW9kZV9saWItPnZiYS5YRkNSZW1vdGVTdXJmYWNlRmxpcERlbGF5ID0gQ2FsY3VsYXRlUmVt
b3RlU3VyZmFjZUZsaXBEZWxheSgKKwkJCQkJbW9kZV9saWIsCisJCQkJCW1vZGVfbGliLT52YmEu
VlJhdGlvW2tdLAorCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZW2tdLAorCQkJCQlkbWxf
Y2VpbChtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbERFVFlba10sIDEpLAorCQkJCQltb2RlX2xp
Yi0+dmJhLkhUb3RhbFtrXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSwKKwkJCQkJbW9k
ZV9saWItPnZiYS5YRkNUU2x2VnVwZGF0ZU9mZnNldCwKKwkJCQkJbW9kZV9saWItPnZiYS5YRkNU
U2x2VnVwZGF0ZVdpZHRoLAorCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1RTbHZWcmVhZHlPZmZzZXQs
CisJCQkJCW1vZGVfbGliLT52YmEuWEZDWEJVRkxhdGVuY3lUb2xlcmFuY2UsCisJCQkJCW1vZGVf
bGliLT52YmEuWEZDRmlsbEJXT3ZlcmhlYWQsCisJCQkJCW1vZGVfbGliLT52YmEuWEZDU2x2Q2h1
bmtTaXplLAorCQkJCQltb2RlX2xpYi0+dmJhLlhGQ0J1c1RyYW5zcG9ydFRpbWUsCisJCQkJCW1v
ZGVfbGliLT52YmEuVENhbGMsCisJCQkJCVRXYWl0LAorCQkJCQkmbW9kZV9saWItPnZiYS5TcmNB
Y3RpdmVEcmFpblJhdGUsCisJCQkJCSZtb2RlX2xpYi0+dmJhLlRJbml0WEZpbGwsCisJCQkJCSZt
b2RlX2xpYi0+dmJhLlRzbHZDaGspOworCQkJbW9kZV9saWItPnZiYS5YRkNSZW1vdGVTdXJmYWNl
RmxpcExhdGVuY3lba10gPQorCQkJCQlkbWxfZmxvb3IoCisJCQkJCQkJbW9kZV9saWItPnZiYS5Y
RkNSZW1vdGVTdXJmYWNlRmxpcERlbGF5CisJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLkhUb3Rh
bFtrXQorCQkJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSksCisJCQkJCQkJ
MSk7CisJCQltb2RlX2xpYi0+dmJhLlhGQ1RyYW5zZmVyRGVsYXlba10gPQorCQkJCQlkbWxfY2Vp
bCgKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ0J1c1RyYW5zcG9ydFRpbWUKKwkJCQkJCQkJCS8g
KG1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhl
bENsb2NrW2tdKSwKKwkJCQkJCQkxKTsKKwkJCW1vZGVfbGliLT52YmEuWEZDUHJlY2hhcmdlRGVs
YXlba10gPQorCQkJCQlkbWxfY2VpbCgKKwkJCQkJCQkobW9kZV9saWItPnZiYS5YRkNCdXNUcmFu
c3BvcnRUaW1lCisJCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuVEluaXRYRmlsbAorCQkJCQkJCQkJ
KyBtb2RlX2xpYi0+dmJhLlRzbHZDaGspCisJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLkhUb3Rh
bFtrXQorCQkJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSksCisJCQkJCQkJ
MSk7CisJCQltb2RlX2xpYi0+dmJhLkluaXRGaWxsTGV2ZWwgPSBtb2RlX2xpYi0+dmJhLlhGQ1hC
VUZMYXRlbmN5VG9sZXJhbmNlCisJCQkJCSogbW9kZV9saWItPnZiYS5TcmNBY3RpdmVEcmFpblJh
dGU7CisJCQltb2RlX2xpYi0+dmJhLkZpbmFsRmlsbE1hcmdpbiA9CisJCQkJCShtb2RlX2xpYi0+
dmJhLkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluVkJsYW5rW2tdCisJCQkJCQkJKyBtb2Rl
X2xpYi0+dmJhLkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJblZCbGFua1trXSkKKwkJCQkJ
CQkqIG1vZGVfbGliLT52YmEuSFRvdGFsW2tdCisJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVs
Q2xvY2tba10KKwkJCQkJCQkqIG1vZGVfbGliLT52YmEuU3JjQWN0aXZlRHJhaW5SYXRlCisJCQkJ
CQkJKyBtb2RlX2xpYi0+dmJhLlhGQ0ZpbGxDb25zdGFudDsKKwkJCW1vZGVfbGliLT52YmEuRmlu
YWxGaWxsTGV2ZWwgPSBtb2RlX2xpYi0+dmJhLlhGQ1JlbW90ZVN1cmZhY2VGbGlwRGVsYXkKKwkJ
CQkJKiBtb2RlX2xpYi0+dmJhLlNyY0FjdGl2ZURyYWluUmF0ZQorCQkJCQkrIG1vZGVfbGliLT52
YmEuRmluYWxGaWxsTWFyZ2luOworCQkJbW9kZV9saWItPnZiYS5SZW1haW5pbmdGaWxsTGV2ZWwg
PSBkbWxfbWF4KAorCQkJCQkwLjAsCisJCQkJCW1vZGVfbGliLT52YmEuRmluYWxGaWxsTGV2ZWwg
LSBtb2RlX2xpYi0+dmJhLkluaXRGaWxsTGV2ZWwpOworCQkJbW9kZV9saWItPnZiYS5URmluYWx4
RmlsbCA9IG1vZGVfbGliLT52YmEuUmVtYWluaW5nRmlsbExldmVsCisJCQkJCS8gKG1vZGVfbGli
LT52YmEuU3JjQWN0aXZlRHJhaW5SYXRlCisJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlhGQ0ZpbGxC
V092ZXJoZWFkIC8gMTAwKTsKKwkJCW1vZGVfbGliLT52YmEuWEZDUHJlZmV0Y2hNYXJnaW5ba10g
PQorCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1JlbW90ZVN1cmZhY2VGbGlwRGVsYXkKKwkJCQkJCQkr
IG1vZGVfbGliLT52YmEuVEZpbmFseEZpbGwKKwkJCQkJCQkrIChtb2RlX2xpYi0+dmJhLkRlc3Rp
bmF0aW9uTGluZXNUb1JlcXVlc3RWTUluVkJsYW5rW2tdCisJCQkJCQkJCQkrIG1vZGVfbGliLT52
YmEuRGVzdGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luVkJsYW5rW2tdKQorCQkJCQkJCQkJKiBt
b2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xv
Y2tba107CisJCX0gZWxzZSB7CisJCQltb2RlX2xpYi0+dmJhLlhGQ1NsYXZlVlVwZGF0ZU9mZnNl
dFtrXSA9IDA7CisJCQltb2RlX2xpYi0+dmJhLlhGQ1NsYXZlVnVwZGF0ZVdpZHRoW2tdID0gMDsK
KwkJCW1vZGVfbGliLT52YmEuWEZDU2xhdmVWUmVhZHlPZmZzZXRba10gPSAwOworCQkJbW9kZV9s
aWItPnZiYS5YRkNSZW1vdGVTdXJmYWNlRmxpcExhdGVuY3lba10gPSAwOworCQkJbW9kZV9saWIt
PnZiYS5YRkNQcmVjaGFyZ2VEZWxheVtrXSA9IDA7CisJCQltb2RlX2xpYi0+dmJhLlhGQ1RyYW5z
ZmVyRGVsYXlba10gPSAwOworCQkJbW9kZV9saWItPnZiYS5YRkNQcmVmZXRjaE1hcmdpbltrXSA9
IDA7CisJCX0KKwl9CisJeworCQl1bnNpZ25lZCBpbnQgVlN0YXJ0dXBNYXJnaW4gPSAwOworCQli
b29sIEZpcnN0TWFpblBsYW5lID0gdHJ1ZTsKKworCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5C
bGVuZGluZ0FuZFRpbWluZ1trXSA9PSBrKSB7CisJCQkJdW5zaWduZWQgaW50IE1hcmdpbiA9ICht
b2RlX2xpYi0+dmJhLk1heFZTdGFydHVwTGluZXNba10gLSBtb2RlX2xpYi0+dmJhLlZTdGFydHVw
W2tdKQorCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXSAvIG1vZGVfbGliLT52YmEuUGl4
ZWxDbG9ja1trXTsKKworCQkJCWlmIChGaXJzdE1haW5QbGFuZSkgeworCQkJCQlWU3RhcnR1cE1h
cmdpbiA9IE1hcmdpbjsKKwkJCQkJRmlyc3RNYWluUGxhbmUgPSBmYWxzZTsKKwkJCQl9IGVsc2UK
KwkJCQkJVlN0YXJ0dXBNYXJnaW4gPSBkbWxfbWluKFZTdGFydHVwTWFyZ2luLCBNYXJnaW4pOwor
CQl9CisKKwkJaWYgKG1vZGVfbGliLT52YmEuVXNlTWF4aW11bVZTdGFydHVwKSB7CisJCQlpZiAo
bW9kZV9saWItPnZiYS5WVG90YWxfTWF4W2tdID09IG1vZGVfbGliLT52YmEuVlRvdGFsW2tdKSB7
CisJCQkJLy9vbmx5IHVzZSBtYXggdnN0YXJ0IGlmIGl0IGlzIG5vdCBkcnIgb3IgbGF0ZWZsaXAu
CisJCQkJbW9kZV9saWItPnZiYS5WU3RhcnR1cFtrXSA9IG1vZGVfbGliLT52YmEuTWF4VlN0YXJ0
dXBMaW5lc1ttb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdXTsKKwkJCX0KKwkJfQor
CX0KK30KK30KKworc3RhdGljIHZvaWQgZG1sMjB2Ml9EaXNwbGF5UGlwZUNvbmZpZ3VyYXRpb24o
c3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliKQoreworCWRvdWJsZSBCeXRlUGVyUGl4
REVUWTsKKwlkb3VibGUgQnl0ZVBlclBpeERFVEM7CisJZG91YmxlIFJlYWQyNTZCeXRlc0Jsb2Nr
SGVpZ2h0WTsKKwlkb3VibGUgUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRDOworCWRvdWJsZSBSZWFk
MjU2Qnl0ZXNCbG9ja1dpZHRoWTsKKwlkb3VibGUgUmVhZDI1NkJ5dGVzQmxvY2tXaWR0aEM7CisJ
ZG91YmxlIE1heGltdW1Td2F0aEhlaWdodFk7CisJZG91YmxlIE1heGltdW1Td2F0aEhlaWdodEM7
CisJZG91YmxlIE1pbmltdW1Td2F0aEhlaWdodFk7CisJZG91YmxlIE1pbmltdW1Td2F0aEhlaWdo
dEM7CisJZG91YmxlIFN3YXRoV2lkdGg7CisJZG91YmxlIFN3YXRoV2lkdGhHcmFudWxhcml0eVk7
CisJZG91YmxlIFN3YXRoV2lkdGhHcmFudWxhcml0eUM7CisJZG91YmxlIFJvdW5kZWRVcE1heFN3
YXRoU2l6ZUJ5dGVzWTsKKwlkb3VibGUgUm91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNDOworCXVu
c2lnbmVkIGludCBqLCBrOworCisJZm9yIChrID0gMDsgayA8IG1vZGVfbGliLT52YmEuTnVtYmVy
T2ZBY3RpdmVQbGFuZXM7ICsraykgeworCQlib29sIE1haW5QbGFuZURvZXNPRE1Db21iaW5lID0g
ZmFsc2U7CisKKwkJaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1f
NDQ0XzY0KSB7CisJCQlCeXRlUGVyUGl4REVUWSA9IDg7CisJCQlCeXRlUGVyUGl4REVUQyA9IDA7
CisJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80
NDRfMzIpIHsKKwkJCUJ5dGVQZXJQaXhERVRZID0gNDsKKwkJCUJ5dGVQZXJQaXhERVRDID0gMDsK
KwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0
NF8xNikgeworCQkJQnl0ZVBlclBpeERFVFkgPSAyOworCQkJQnl0ZVBlclBpeERFVEMgPSAwOwor
CQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0
XzgpIHsKKwkJCUJ5dGVQZXJQaXhERVRZID0gMTsKKwkJCUJ5dGVQZXJQaXhERVRDID0gMDsKKwkJ
fSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQyMF84
KSB7CisJCQlCeXRlUGVyUGl4REVUWSA9IDE7CisJCQlCeXRlUGVyUGl4REVUQyA9IDI7CisJCX0g
ZWxzZSB7CisJCQlCeXRlUGVyUGl4REVUWSA9IDQuMCAvIDMuMDsKKwkJCUJ5dGVQZXJQaXhERVRD
ID0gOC4wIC8gMy4wOworCQl9CisKKwkJaWYgKChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9y
bWF0W2tdID09IGRtXzQ0NF82NAorCQkJCXx8IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3Jt
YXRba10gPT0gZG1fNDQ0XzMyCisJCQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1h
dFtrXSA9PSBkbV80NDRfMTYKKwkJCQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0
W2tdID09IGRtXzQ0NF84KSkgeworCQkJaWYgKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1tr
XSA9PSBkbV9zd19saW5lYXIpIHsKKwkJCQlSZWFkMjU2Qnl0ZXNCbG9ja0hlaWdodFkgPSAxOwor
CQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0
NF82NCkgeworCQkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0WSA9IDQ7CisJCQl9IGVsc2UgaWYg
KG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzMyCisJCQkJCXx8
IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzE2KSB7CisJCQkJ
UmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRZID0gODsKKwkJCX0gZWxzZSB7CisJCQkJUmVhZDI1NkJ5
dGVzQmxvY2tIZWlnaHRZID0gMTY7CisJCQl9CisJCQlSZWFkMjU2Qnl0ZXNCbG9ja1dpZHRoWSA9
IDI1NiAvIGRtbF9jZWlsKEJ5dGVQZXJQaXhERVRZLCAxKQorCQkJCQkvIFJlYWQyNTZCeXRlc0Js
b2NrSGVpZ2h0WTsKKwkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0QyA9IDA7CisJCQlSZWFkMjU2
Qnl0ZXNCbG9ja1dpZHRoQyA9IDA7CisJCX0gZWxzZSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5T
dXJmYWNlVGlsaW5nW2tdID09IGRtX3N3X2xpbmVhcikgeworCQkJCVJlYWQyNTZCeXRlc0Jsb2Nr
SGVpZ2h0WSA9IDE7CisJCQkJUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRDID0gMTsKKwkJCX0gZWxz
ZSBpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfOCkgewor
CQkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0WSA9IDE2OworCQkJCVJlYWQyNTZCeXRlc0Jsb2Nr
SGVpZ2h0QyA9IDg7CisJCQl9IGVsc2UgeworCQkJCVJlYWQyNTZCeXRlc0Jsb2NrSGVpZ2h0WSA9
IDg7CisJCQkJUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRDID0gODsKKwkJCX0KKwkJCVJlYWQyNTZC
eXRlc0Jsb2NrV2lkdGhZID0gMjU2IC8gZG1sX2NlaWwoQnl0ZVBlclBpeERFVFksIDEpCisJCQkJ
CS8gUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRZOworCQkJUmVhZDI1NkJ5dGVzQmxvY2tXaWR0aEMg
PSAyNTYgLyBkbWxfY2VpbChCeXRlUGVyUGl4REVUQywgMikKKwkJCQkJLyBSZWFkMjU2Qnl0ZXNC
bG9ja0hlaWdodEM7CisJCX0KKworCQlpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdID09
IGRtX2hvcnopIHsKKwkJCU1heGltdW1Td2F0aEhlaWdodFkgPSBSZWFkMjU2Qnl0ZXNCbG9ja0hl
aWdodFk7CisJCQlNYXhpbXVtU3dhdGhIZWlnaHRDID0gUmVhZDI1NkJ5dGVzQmxvY2tIZWlnaHRD
OworCQl9IGVsc2UgeworCQkJTWF4aW11bVN3YXRoSGVpZ2h0WSA9IFJlYWQyNTZCeXRlc0Jsb2Nr
V2lkdGhZOworCQkJTWF4aW11bVN3YXRoSGVpZ2h0QyA9IFJlYWQyNTZCeXRlc0Jsb2NrV2lkdGhD
OworCQl9CisKKwkJaWYgKChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRt
XzQ0NF82NAorCQkJCXx8IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1f
NDQ0XzMyCisJCQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80
NDRfMTYKKwkJCQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0
NF84KSkgeworCQkJaWYgKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSA9PSBkbV9zd19s
aW5lYXIKKwkJCQkJfHwgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1f
NDQ0XzY0CisJCQkJCQkJJiYgKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXQorCQkJCQkJ
CQkJPT0gZG1fc3dfNGtiX3MKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGlu
Z1trXQorCQkJCQkJCQkJCQk9PSBkbV9zd180a2Jfc194CisJCQkJCQkJCQl8fCBtb2RlX2xpYi0+
dmJhLlN1cmZhY2VUaWxpbmdba10KKwkJCQkJCQkJCQkJPT0gZG1fc3dfNjRrYl9zCisJCQkJCQkJ
CQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10KKwkJCQkJCQkJCQkJPT0gZG1fc3df
NjRrYl9zX3QKKwkJCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXQorCQkJ
CQkJCQkJCQk9PSBkbV9zd182NGtiX3NfeAorCQkJCQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJm
YWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJCT09IGRtX3N3X3Zhcl9zCisJCQkJCQkJCQl8fCBtb2Rl
X2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10KKwkJCQkJCQkJCQkJPT0gZG1fc3dfdmFyX3NfeCkK
KwkJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikpIHsKKwkJ
CQlNaW5pbXVtU3dhdGhIZWlnaHRZID0gTWF4aW11bVN3YXRoSGVpZ2h0WTsKKwkJCX0gZWxzZSBp
ZiAobW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80NDRfOAorCQkJCQkm
JiBtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gIT0gZG1faG9yeikgeworCQkJCU1pbmltdW1T
d2F0aEhlaWdodFkgPSBNYXhpbXVtU3dhdGhIZWlnaHRZOworCQkJfSBlbHNlIHsKKwkJCQlNaW5p
bXVtU3dhdGhIZWlnaHRZID0gTWF4aW11bVN3YXRoSGVpZ2h0WSAvIDIuMDsKKwkJCX0KKwkJCU1p
bmltdW1Td2F0aEhlaWdodEMgPSBNYXhpbXVtU3dhdGhIZWlnaHRDOworCQl9IGVsc2UgeworCQkJ
aWYgKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSA9PSBkbV9zd19saW5lYXIpIHsKKwkJ
CQlNaW5pbXVtU3dhdGhIZWlnaHRZID0gTWF4aW11bVN3YXRoSGVpZ2h0WTsKKwkJCQlNaW5pbXVt
U3dhdGhIZWlnaHRDID0gTWF4aW11bVN3YXRoSGVpZ2h0QzsKKwkJCX0gZWxzZSBpZiAobW9kZV9s
aWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfOAorCQkJCQkmJiBtb2RlX2xp
Yi0+dmJhLlNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikgeworCQkJCU1pbmltdW1Td2F0aEhlaWdo
dFkgPSBNYXhpbXVtU3dhdGhIZWlnaHRZIC8gMi4wOworCQkJCU1pbmltdW1Td2F0aEhlaWdodEMg
PSBNYXhpbXVtU3dhdGhIZWlnaHRDOworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJj
ZVBpeGVsRm9ybWF0W2tdID09IGRtXzQyMF8xMAorCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJj
ZVNjYW5ba10gPT0gZG1faG9yeikgeworCQkJCU1pbmltdW1Td2F0aEhlaWdodEMgPSBNYXhpbXVt
U3dhdGhIZWlnaHRDIC8gMi4wOworCQkJCU1pbmltdW1Td2F0aEhlaWdodFkgPSBNYXhpbXVtU3dh
dGhIZWlnaHRZOworCQkJfSBlbHNlIHsKKwkJCQlNaW5pbXVtU3dhdGhIZWlnaHRZID0gTWF4aW11
bVN3YXRoSGVpZ2h0WTsKKwkJCQlNaW5pbXVtU3dhdGhIZWlnaHRDID0gTWF4aW11bVN3YXRoSGVp
Z2h0QzsKKwkJCX0KKwkJfQorCisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gPT0g
ZG1faG9yeikgeworCQkJU3dhdGhXaWR0aCA9IG1vZGVfbGliLT52YmEuVmlld3BvcnRXaWR0aFtr
XTsKKwkJfSBlbHNlIHsKKwkJCVN3YXRoV2lkdGggPSBtb2RlX2xpYi0+dmJhLlZpZXdwb3J0SGVp
Z2h0W2tdOworCQl9CisKKwkJaWYgKG1vZGVfbGliLT52YmEuT0RNQ29tYmluZUVuYWJsZWRba10g
PT0gdHJ1ZSkgeworCQkJTWFpblBsYW5lRG9lc09ETUNvbWJpbmUgPSB0cnVlOworCQl9CisJCWZv
ciAoaiA9IDA7IGogPCBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzOyArK2opIHsK
KwkJCWlmIChtb2RlX2xpYi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdID09IGoKKwkJCQkJJiYg
bW9kZV9saWItPnZiYS5PRE1Db21iaW5lRW5hYmxlZFtqXSA9PSB0cnVlKSB7CisJCQkJTWFpblBs
YW5lRG9lc09ETUNvbWJpbmUgPSB0cnVlOworCQkJfQorCQl9CisKKwkJaWYgKE1haW5QbGFuZURv
ZXNPRE1Db21iaW5lID09IHRydWUpIHsKKwkJCVN3YXRoV2lkdGggPSBkbWxfbWluKAorCQkJCQlT
d2F0aFdpZHRoLAorCQkJCQltb2RlX2xpYi0+dmJhLkhBY3RpdmVba10gLyAyLjAgKiBtb2RlX2xp
Yi0+dmJhLkhSYXRpb1trXSk7CisJCX0gZWxzZSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5EUFBQ
ZXJQbGFuZVtrXSA9PSAwKQorCQkJCVN3YXRoV2lkdGggPSAwOworCQkJZWxzZQorCQkJCVN3YXRo
V2lkdGggPSBTd2F0aFdpZHRoIC8gbW9kZV9saWItPnZiYS5EUFBQZXJQbGFuZVtrXTsKKwkJfQor
CisJCVN3YXRoV2lkdGhHcmFudWxhcml0eVkgPSAyNTYgLyBkbWxfY2VpbChCeXRlUGVyUGl4REVU
WSwgMSkgLyBNYXhpbXVtU3dhdGhIZWlnaHRZOworCQlSb3VuZGVkVXBNYXhTd2F0aFNpemVCeXRl
c1kgPSAoZG1sX2NlaWwoCisJCQkJKGRvdWJsZSkgKFN3YXRoV2lkdGggLSAxKSwKKwkJCQlTd2F0
aFdpZHRoR3JhbnVsYXJpdHlZKSArIFN3YXRoV2lkdGhHcmFudWxhcml0eVkpICogQnl0ZVBlclBp
eERFVFkKKwkJCQkqIE1heGltdW1Td2F0aEhlaWdodFk7CisJCWlmIChtb2RlX2xpYi0+dmJhLlNv
dXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQyMF8xMCkgeworCQkJUm91bmRlZFVwTWF4U3dhdGhT
aXplQnl0ZXNZID0gZG1sX2NlaWwoUm91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNZLCAyNTYpCisJ
CQkJCSsgMjU2OworCQl9CisJCWlmIChNYXhpbXVtU3dhdGhIZWlnaHRDID4gMCkgeworCQkJU3dh
dGhXaWR0aEdyYW51bGFyaXR5QyA9IDI1Ni4wIC8gZG1sX2NlaWwoQnl0ZVBlclBpeERFVEMsIDIp
CisJCQkJCS8gTWF4aW11bVN3YXRoSGVpZ2h0QzsKKwkJCVJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5
dGVzQyA9IChkbWxfY2VpbCgKKwkJCQkJKGRvdWJsZSkgKFN3YXRoV2lkdGggLyAyLjAgLSAxKSwK
KwkJCQkJU3dhdGhXaWR0aEdyYW51bGFyaXR5QykgKyBTd2F0aFdpZHRoR3JhbnVsYXJpdHlDKQor
CQkJCQkqIEJ5dGVQZXJQaXhERVRDICogTWF4aW11bVN3YXRoSGVpZ2h0QzsKKwkJCWlmIChtb2Rl
X2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQyMF8xMCkgeworCQkJCVJvdW5k
ZWRVcE1heFN3YXRoU2l6ZUJ5dGVzQyA9IGRtbF9jZWlsKAorCQkJCQkJUm91bmRlZFVwTWF4U3dh
dGhTaXplQnl0ZXNDLAorCQkJCQkJMjU2KSArIDI1NjsKKwkJCX0KKwkJfSBlbHNlCisJCQlSb3Vu
ZGVkVXBNYXhTd2F0aFNpemVCeXRlc0MgPSAwLjA7CisKKwkJaWYgKFJvdW5kZWRVcE1heFN3YXRo
U2l6ZUJ5dGVzWSArIFJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5dGVzQworCQkJCTw9IG1vZGVfbGli
LT52YmEuREVUQnVmZmVyU2l6ZUluS0J5dGUgKiAxMDI0LjAgLyAyLjApIHsKKwkJCW1vZGVfbGli
LT52YmEuU3dhdGhIZWlnaHRZW2tdID0gTWF4aW11bVN3YXRoSGVpZ2h0WTsKKwkJCW1vZGVfbGli
LT52YmEuU3dhdGhIZWlnaHRDW2tdID0gTWF4aW11bVN3YXRoSGVpZ2h0QzsKKwkJfSBlbHNlIHsK
KwkJCW1vZGVfbGliLT52YmEuU3dhdGhIZWlnaHRZW2tdID0gTWluaW11bVN3YXRoSGVpZ2h0WTsK
KwkJCW1vZGVfbGliLT52YmEuU3dhdGhIZWlnaHRDW2tdID0gTWluaW11bVN3YXRoSGVpZ2h0QzsK
KwkJfQorCisJCWlmIChtb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSA9PSAwKSB7CisJCQlt
b2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVZW2tdID0gbW9kZV9saWItPnZiYS5ERVRCdWZmZXJT
aXplSW5LQnl0ZSAqIDEwMjQ7CisJCQltb2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVDW2tdID0g
MDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0WVtrXSA8PSBtb2RlX2xp
Yi0+dmJhLlN3YXRoSGVpZ2h0Q1trXSkgeworCQkJbW9kZV9saWItPnZiYS5ERVRCdWZmZXJTaXpl
WVtrXSA9IG1vZGVfbGliLT52YmEuREVUQnVmZmVyU2l6ZUluS0J5dGUKKwkJCQkJKiAxMDI0LjAg
LyAyOworCQkJbW9kZV9saWItPnZiYS5ERVRCdWZmZXJTaXplQ1trXSA9IG1vZGVfbGliLT52YmEu
REVUQnVmZmVyU2l6ZUluS0J5dGUKKwkJCQkJKiAxMDI0LjAgLyAyOworCQl9IGVsc2UgeworCQkJ
bW9kZV9saWItPnZiYS5ERVRCdWZmZXJTaXplWVtrXSA9IG1vZGVfbGliLT52YmEuREVUQnVmZmVy
U2l6ZUluS0J5dGUKKwkJCQkJKiAxMDI0LjAgKiAyIC8gMzsKKwkJCW1vZGVfbGliLT52YmEuREVU
QnVmZmVyU2l6ZUNba10gPSBtb2RlX2xpYi0+dmJhLkRFVEJ1ZmZlclNpemVJbktCeXRlCisJCQkJ
CSogMTAyNC4wIC8gMzsKKwkJfQorCX0KK30KKworc3RhdGljIGRvdWJsZSBDYWxjdWxhdGVUV2Fp
dCgKKwkJdW5zaWduZWQgaW50IFByZWZldGNoTW9kZSwKKwkJZG91YmxlIERSQU1DbG9ja0NoYW5n
ZUxhdGVuY3ksCisJCWRvdWJsZSBVcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seSwKKwkJZG91Ymxl
IFNSRW50ZXJQbHVzRXhpdFRpbWUpCit7CisJaWYgKFByZWZldGNoTW9kZSA9PSAwKSB7CisJCXJl
dHVybiBkbWxfbWF4KAorCQkJCURSQU1DbG9ja0NoYW5nZUxhdGVuY3kgKyBVcmdlbnRMYXRlbmN5
UGl4ZWxEYXRhT25seSwKKwkJCQlkbWxfbWF4KFNSRW50ZXJQbHVzRXhpdFRpbWUsIFVyZ2VudExh
dGVuY3lQaXhlbERhdGFPbmx5KSk7CisJfSBlbHNlIGlmIChQcmVmZXRjaE1vZGUgPT0gMSkgewor
CQlyZXR1cm4gZG1sX21heChTUkVudGVyUGx1c0V4aXRUaW1lLCBVcmdlbnRMYXRlbmN5UGl4ZWxE
YXRhT25seSk7CisJfSBlbHNlIHsKKwkJcmV0dXJuIFVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5
OworCX0KK30KKworc3RhdGljIGRvdWJsZSBDYWxjdWxhdGVSZW1vdGVTdXJmYWNlRmxpcERlbGF5
KAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRvdWJsZSBWUmF0aW8s
CisJCWRvdWJsZSBTd2F0aFdpZHRoLAorCQlkb3VibGUgQnBwLAorCQlkb3VibGUgTGluZVRpbWUs
CisJCWRvdWJsZSBYRkNUU2x2VnVwZGF0ZU9mZnNldCwKKwkJZG91YmxlIFhGQ1RTbHZWdXBkYXRl
V2lkdGgsCisJCWRvdWJsZSBYRkNUU2x2VnJlYWR5T2Zmc2V0LAorCQlkb3VibGUgWEZDWEJVRkxh
dGVuY3lUb2xlcmFuY2UsCisJCWRvdWJsZSBYRkNGaWxsQldPdmVyaGVhZCwKKwkJZG91YmxlIFhG
Q1NsdkNodW5rU2l6ZSwKKwkJZG91YmxlIFhGQ0J1c1RyYW5zcG9ydFRpbWUsCisJCWRvdWJsZSBU
Q2FsYywKKwkJZG91YmxlIFRXYWl0LAorCQlkb3VibGUgKlNyY0FjdGl2ZURyYWluUmF0ZSwKKwkJ
ZG91YmxlICpUSW5pdFhGaWxsLAorCQlkb3VibGUgKlRzbHZDaGspCit7CisJZG91YmxlIFRTbHZT
ZXR1cCwgQXZnZmlsbFJhdGUsIHJlc3VsdDsKKworCSpTcmNBY3RpdmVEcmFpblJhdGUgPSBWUmF0
aW8gKiBTd2F0aFdpZHRoICogQnBwIC8gTGluZVRpbWU7CisJVFNsdlNldHVwID0gWEZDVFNsdlZ1
cGRhdGVPZmZzZXQgKyBYRkNUU2x2VnVwZGF0ZVdpZHRoICsgWEZDVFNsdlZyZWFkeU9mZnNldDsK
KwkqVEluaXRYRmlsbCA9IFhGQ1hCVUZMYXRlbmN5VG9sZXJhbmNlIC8gKDEgKyBYRkNGaWxsQldP
dmVyaGVhZCAvIDEwMCk7CisJQXZnZmlsbFJhdGUgPSAqU3JjQWN0aXZlRHJhaW5SYXRlICogKDEg
KyBYRkNGaWxsQldPdmVyaGVhZCAvIDEwMCk7CisJKlRzbHZDaGsgPSBYRkNTbHZDaHVua1NpemUg
LyBBdmdmaWxsUmF0ZTsKKwlkbWxfcHJpbnQoCisJCQkiRE1MOjpDYWxjdWxhdGVSZW1vdGVTdXJm
YWNlRmxpcERlbGF5OiBTcmNBY3RpdmVEcmFpblJhdGU6ICVmXG4iLAorCQkJKlNyY0FjdGl2ZURy
YWluUmF0ZSk7CisJZG1sX3ByaW50KCJETUw6OkNhbGN1bGF0ZVJlbW90ZVN1cmZhY2VGbGlwRGVs
YXk6IFRTbHZTZXR1cDogJWZcbiIsIFRTbHZTZXR1cCk7CisJZG1sX3ByaW50KCJETUw6OkNhbGN1
bGF0ZVJlbW90ZVN1cmZhY2VGbGlwRGVsYXk6IFRJbml0WEZpbGw6ICVmXG4iLCAqVEluaXRYRmls
bCk7CisJZG1sX3ByaW50KCJETUw6OkNhbGN1bGF0ZVJlbW90ZVN1cmZhY2VGbGlwRGVsYXk6IEF2
Z2ZpbGxSYXRlOiAlZlxuIiwgQXZnZmlsbFJhdGUpOworCWRtbF9wcmludCgiRE1MOjpDYWxjdWxh
dGVSZW1vdGVTdXJmYWNlRmxpcERlbGF5OiBUc2x2Q2hrOiAlZlxuIiwgKlRzbHZDaGspOworCXJl
c3VsdCA9IDIgKiBYRkNCdXNUcmFuc3BvcnRUaW1lICsgVFNsdlNldHVwICsgVENhbGMgKyBUV2Fp
dCArICpUc2x2Q2hrICsgKlRJbml0WEZpbGw7IC8vIFRPRE86IFRoaXMgZG9lc24ndCBzZWVtIHRv
IG1hdGNoIHByb2dyYW1taW5nIGd1aWRlCisJZG1sX3ByaW50KCJETUw6OkNhbGN1bGF0ZVJlbW90
ZVN1cmZhY2VGbGlwRGVsYXk6IFJlbW90ZVN1cmZhY2VGbGlwRGVsYXk6ICVmXG4iLCByZXN1bHQp
OworCXJldHVybiByZXN1bHQ7Cit9CisKK3N0YXRpYyBkb3VibGUgQ2FsY3VsYXRlV3JpdGVCYWNr
RGVsYXkoCisJCWVudW0gc291cmNlX2Zvcm1hdF9jbGFzcyBXcml0ZWJhY2tQaXhlbEZvcm1hdCwK
KwkJZG91YmxlIFdyaXRlYmFja0hSYXRpbywKKwkJZG91YmxlIFdyaXRlYmFja1ZSYXRpbywKKwkJ
dW5zaWduZWQgaW50IFdyaXRlYmFja0x1bWFIVGFwcywKKwkJdW5zaWduZWQgaW50IFdyaXRlYmFj
a0x1bWFWVGFwcywKKwkJdW5zaWduZWQgaW50IFdyaXRlYmFja0Nocm9tYUhUYXBzLAorCQl1bnNp
Z25lZCBpbnQgV3JpdGViYWNrQ2hyb21hVlRhcHMsCisJCXVuc2lnbmVkIGludCBXcml0ZWJhY2tE
ZXN0aW5hdGlvbldpZHRoKQoreworCWRvdWJsZSBDYWxjdWxhdGVXcml0ZUJhY2tEZWxheSA9CisJ
CQlkbWxfbWF4KAorCQkJCQlkbWxfY2VpbChXcml0ZWJhY2tMdW1hSFRhcHMgLyA0LjAsIDEpIC8g
V3JpdGViYWNrSFJhdGlvLAorCQkJCQlXcml0ZWJhY2tMdW1hVlRhcHMgKiBkbWxfY2VpbCgxLjAg
LyBXcml0ZWJhY2tWUmF0aW8sIDEpCisJCQkJCQkJKiBkbWxfY2VpbCgKKwkJCQkJCQkJCVdyaXRl
YmFja0Rlc3RpbmF0aW9uV2lkdGgKKwkJCQkJCQkJCQkJLyA0LjAsCisJCQkJCQkJCQkxKQorCQkJ
CQkJCSsgZG1sX2NlaWwoMS4wIC8gV3JpdGViYWNrVlJhdGlvLCAxKQorCQkJCQkJCQkJKiAoZG1s
X2NlaWwoCisJCQkJCQkJCQkJCVdyaXRlYmFja0x1bWFWVGFwcworCQkJCQkJCQkJCQkJCS8gNC4w
LAorCQkJCQkJCQkJCQkxKSArIDQpKTsKKworCWlmIChXcml0ZWJhY2tQaXhlbEZvcm1hdCAhPSBk
bV80NDRfMzIpIHsKKwkJQ2FsY3VsYXRlV3JpdGVCYWNrRGVsYXkgPQorCQkJCWRtbF9tYXgoCisJ
CQkJCQlDYWxjdWxhdGVXcml0ZUJhY2tEZWxheSwKKwkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCWRt
bF9jZWlsKAorCQkJCQkJCQkJCVdyaXRlYmFja0Nocm9tYUhUYXBzCisJCQkJCQkJCQkJCQkvIDIu
MCwKKwkJCQkJCQkJCQkxKQorCQkJCQkJCQkJCS8gKDIKKwkJCQkJCQkJCQkJCSogV3JpdGViYWNr
SFJhdGlvKSwKKwkJCQkJCQkJV3JpdGViYWNrQ2hyb21hVlRhcHMKKwkJCQkJCQkJCQkqIGRtbF9j
ZWlsKAorCQkJCQkJCQkJCQkJMQorCQkJCQkJCQkJCQkJCQkvICgyCisJCQkJCQkJCQkJCQkJCQkJ
KiBXcml0ZWJhY2tWUmF0aW8pLAorCQkJCQkJCQkJCQkJMSkKKwkJCQkJCQkJCQkqIGRtbF9jZWls
KAorCQkJCQkJCQkJCQkJV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aAorCQkJCQkJCQkJCQkJCQkv
IDIuMAorCQkJCQkJCQkJCQkJCQkvIDIuMCwKKwkJCQkJCQkJCQkJCTEpCisJCQkJCQkJCQkJKyBk
bWxfY2VpbCgKKwkJCQkJCQkJCQkJCTEKKwkJCQkJCQkJCQkJCQkJLyAoMgorCQkJCQkJCQkJCQkJ
CQkJCSogV3JpdGViYWNrVlJhdGlvKSwKKwkJCQkJCQkJCQkJCTEpCisJCQkJCQkJCQkJCQkqIChk
bWxfY2VpbCgKKwkJCQkJCQkJCQkJCQkJV3JpdGViYWNrQ2hyb21hVlRhcHMKKwkJCQkJCQkJCQkJ
CQkJCQkvIDQuMCwKKwkJCQkJCQkJCQkJCQkJMSkKKwkJCQkJCQkJCQkJCQkJKyA0KSkpOworCX0K
KwlyZXR1cm4gQ2FsY3VsYXRlV3JpdGVCYWNrRGVsYXk7Cit9CisKK3N0YXRpYyB2b2lkIENhbGN1
bGF0ZUFjdGl2ZVJvd0JhbmR3aWR0aCgKKwkJYm9vbCBHUFVWTUVuYWJsZSwKKwkJZW51bSBzb3Vy
Y2VfZm9ybWF0X2NsYXNzIFNvdXJjZVBpeGVsRm9ybWF0LAorCQlkb3VibGUgVlJhdGlvLAorCQli
b29sIERDQ0VuYWJsZSwKKwkJZG91YmxlIExpbmVUaW1lLAorCQl1bnNpZ25lZCBpbnQgTWV0YVJv
d0J5dGVMdW1hLAorCQl1bnNpZ25lZCBpbnQgTWV0YVJvd0J5dGVDaHJvbWEsCisJCXVuc2lnbmVk
IGludCBtZXRhX3Jvd19oZWlnaHRfbHVtYSwKKwkJdW5zaWduZWQgaW50IG1ldGFfcm93X2hlaWdo
dF9jaHJvbWEsCisJCXVuc2lnbmVkIGludCBQaXhlbFBURUJ5dGVzUGVyUm93THVtYSwKKwkJdW5z
aWduZWQgaW50IFBpeGVsUFRFQnl0ZXNQZXJSb3dDaHJvbWEsCisJCXVuc2lnbmVkIGludCBkcHRl
X3Jvd19oZWlnaHRfbHVtYSwKKwkJdW5zaWduZWQgaW50IGRwdGVfcm93X2hlaWdodF9jaHJvbWEs
CisJCWRvdWJsZSAqbWV0YV9yb3dfYncsCisJCWRvdWJsZSAqZHB0ZV9yb3dfYncsCisJCWRvdWJs
ZSAqcXVhbF9yb3dfYncpCit7CisJaWYgKERDQ0VuYWJsZSAhPSB0cnVlKSB7CisJCSptZXRhX3Jv
d19idyA9IDA7CisJfSBlbHNlIGlmIChTb3VyY2VQaXhlbEZvcm1hdCA9PSBkbV80MjBfOCB8fCBT
b3VyY2VQaXhlbEZvcm1hdCA9PSBkbV80MjBfMTApIHsKKwkJKm1ldGFfcm93X2J3ID0gVlJhdGlv
ICogTWV0YVJvd0J5dGVMdW1hIC8gKG1ldGFfcm93X2hlaWdodF9sdW1hICogTGluZVRpbWUpCisJ
CQkJKyBWUmF0aW8gLyAyICogTWV0YVJvd0J5dGVDaHJvbWEKKwkJCQkJCS8gKG1ldGFfcm93X2hl
aWdodF9jaHJvbWEgKiBMaW5lVGltZSk7CisJfSBlbHNlIHsKKwkJKm1ldGFfcm93X2J3ID0gVlJh
dGlvICogTWV0YVJvd0J5dGVMdW1hIC8gKG1ldGFfcm93X2hlaWdodF9sdW1hICogTGluZVRpbWUp
OworCX0KKworCWlmIChHUFVWTUVuYWJsZSAhPSB0cnVlKSB7CisJCSpkcHRlX3Jvd19idyA9IDA7
CisJfSBlbHNlIGlmIChTb3VyY2VQaXhlbEZvcm1hdCA9PSBkbV80MjBfOCB8fCBTb3VyY2VQaXhl
bEZvcm1hdCA9PSBkbV80MjBfMTApIHsKKwkJKmRwdGVfcm93X2J3ID0gVlJhdGlvICogUGl4ZWxQ
VEVCeXRlc1BlclJvd0x1bWEgLyAoZHB0ZV9yb3dfaGVpZ2h0X2x1bWEgKiBMaW5lVGltZSkKKwkJ
CQkrIFZSYXRpbyAvIDIgKiBQaXhlbFBURUJ5dGVzUGVyUm93Q2hyb21hCisJCQkJCQkvIChkcHRl
X3Jvd19oZWlnaHRfY2hyb21hICogTGluZVRpbWUpOworCX0gZWxzZSB7CisJCSpkcHRlX3Jvd19i
dyA9IFZSYXRpbyAqIFBpeGVsUFRFQnl0ZXNQZXJSb3dMdW1hIC8gKGRwdGVfcm93X2hlaWdodF9s
dW1hICogTGluZVRpbWUpOworCX0KKworCWlmICgoU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDIw
XzggfHwgU291cmNlUGl4ZWxGb3JtYXQgPT0gZG1fNDIwXzEwKSkgeworCQkqcXVhbF9yb3dfYncg
PSAqbWV0YV9yb3dfYncgKyAqZHB0ZV9yb3dfYnc7CisJfSBlbHNlIHsKKwkJKnF1YWxfcm93X2J3
ID0gMDsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIENhbGN1bGF0ZUZsaXBTY2hlZHVsZSgKKwkJc3Ry
dWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgVXJnZW50RXh0cmFMYXRl
bmN5LAorCQlkb3VibGUgVXJnZW50TGF0ZW5jeVBpeGVsRGF0YU9ubHksCisJCXVuc2lnbmVkIGlu
dCBHUFVWTU1heFBhZ2VUYWJsZUxldmVscywKKwkJYm9vbCBHUFVWTUVuYWJsZSwKKwkJZG91Ymxl
IEJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAsCisJCXVuc2lnbmVkIGludCBUb3RJ
bW1lZGlhdGVGbGlwQnl0ZXMsCisJCWVudW0gc291cmNlX2Zvcm1hdF9jbGFzcyBTb3VyY2VQaXhl
bEZvcm1hdCwKKwkJdW5zaWduZWQgaW50IEltbWVkaWF0ZUZsaXBCeXRlcywKKwkJZG91YmxlIExp
bmVUaW1lLAorCQlkb3VibGUgVlJhdGlvLAorCQlkb3VibGUgVG5vX2J3LAorCQlkb3VibGUgUERF
QW5kTWV0YVBURUJ5dGVzRnJhbWUsCisJCXVuc2lnbmVkIGludCBNZXRhUm93Qnl0ZSwKKwkJdW5z
aWduZWQgaW50IFBpeGVsUFRFQnl0ZXNQZXJSb3csCisJCWJvb2wgRENDRW5hYmxlLAorCQl1bnNp
Z25lZCBpbnQgZHB0ZV9yb3dfaGVpZ2h0LAorCQl1bnNpZ25lZCBpbnQgbWV0YV9yb3dfaGVpZ2h0
LAorCQlkb3VibGUgcXVhbF9yb3dfYncsCisJCWRvdWJsZSAqRGVzdGluYXRpb25MaW5lc1RvUmVx
dWVzdFZNSW5JbW1lZGlhdGVGbGlwLAorCQlkb3VibGUgKkRlc3RpbmF0aW9uTGluZXNUb1JlcXVl
c3RSb3dJbkltbWVkaWF0ZUZsaXAsCisJCWRvdWJsZSAqZmluYWxfZmxpcF9idywKKwkJYm9vbCAq
SW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclBpcGUpCit7CisJZG91YmxlIG1pbl9yb3dfdGltZSA9
IDAuMDsKKworCWlmIChTb3VyY2VQaXhlbEZvcm1hdCA9PSBkbV80MjBfOCB8fCBTb3VyY2VQaXhl
bEZvcm1hdCA9PSBkbV80MjBfMTApIHsKKwkJKkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUlu
SW1tZWRpYXRlRmxpcCA9IDAuMDsKKwkJKkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RSb3dJbklt
bWVkaWF0ZUZsaXAgPSAwLjA7CisJCSpmaW5hbF9mbGlwX2J3ID0gcXVhbF9yb3dfYnc7CisJCSpJ
bW1lZGlhdGVGbGlwU3VwcG9ydGVkRm9yUGlwZSA9IHRydWU7CisJfSBlbHNlIHsKKwkJZG91Ymxl
IFRpbWVGb3JGZXRjaGluZ01ldGFQVEVJbW1lZGlhdGVGbGlwOworCQlkb3VibGUgVGltZUZvckZl
dGNoaW5nUm93SW5WQmxhbmtJbW1lZGlhdGVGbGlwOworCisJCWlmIChHUFVWTUVuYWJsZSA9PSB0
cnVlKSB7CisJCQltb2RlX2xpYi0+dmJhLkltbWVkaWF0ZUZsaXBCV1swXSA9IEJhbmR3aWR0aEF2
YWlsYWJsZUZvckltbWVkaWF0ZUZsaXAKKwkJCQkJKiBJbW1lZGlhdGVGbGlwQnl0ZXMgLyBUb3RJ
bW1lZGlhdGVGbGlwQnl0ZXM7CisJCQlUaW1lRm9yRmV0Y2hpbmdNZXRhUFRFSW1tZWRpYXRlRmxp
cCA9CisJCQkJCWRtbF9tYXgoCisJCQkJCQkJVG5vX2J3CisJCQkJCQkJCQkrIFBERUFuZE1ldGFQ
VEVCeXRlc0ZyYW1lCisJCQkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwQldb
MF0sCisJCQkJCQkJZG1sX21heCgKKwkJCQkJCQkJCVVyZ2VudEV4dHJhTGF0ZW5jeQorCQkJCQkJ
CQkJCQkrIFVyZ2VudExhdGVuY3lQaXhlbERhdGFPbmx5CisJCQkJCQkJCQkJCQkJKiAoR1BVVk1N
YXhQYWdlVGFibGVMZXZlbHMKKwkJCQkJCQkJCQkJCQkJCS0gMSksCisJCQkJCQkJCQlMaW5lVGlt
ZSAvIDQuMCkpOworCQl9IGVsc2UgeworCQkJVGltZUZvckZldGNoaW5nTWV0YVBURUltbWVkaWF0
ZUZsaXAgPSAwOworCQl9CisKKwkJKkRlc3RpbmF0aW9uTGluZXNUb1JlcXVlc3RWTUluSW1tZWRp
YXRlRmxpcCA9IGRtbF9mbG9vcigKKwkJCQk0LjAgKiAoVGltZUZvckZldGNoaW5nTWV0YVBURUlt
bWVkaWF0ZUZsaXAgLyBMaW5lVGltZSArIDAuMTI1KSwKKwkJCQkxKSAvIDQuMDsKKworCQlpZiAo
KEdQVVZNRW5hYmxlID09IHRydWUgfHwgRENDRW5hYmxlID09IHRydWUpKSB7CisJCQltb2RlX2xp
Yi0+dmJhLkltbWVkaWF0ZUZsaXBCV1swXSA9IEJhbmR3aWR0aEF2YWlsYWJsZUZvckltbWVkaWF0
ZUZsaXAKKwkJCQkJKiBJbW1lZGlhdGVGbGlwQnl0ZXMgLyBUb3RJbW1lZGlhdGVGbGlwQnl0ZXM7
CisJCQlUaW1lRm9yRmV0Y2hpbmdSb3dJblZCbGFua0ltbWVkaWF0ZUZsaXAgPSBkbWxfbWF4KAor
CQkJCQkoTWV0YVJvd0J5dGUgKyBQaXhlbFBURUJ5dGVzUGVyUm93KQorCQkJCQkJCS8gbW9kZV9s
aWItPnZiYS5JbW1lZGlhdGVGbGlwQldbMF0sCisJCQkJCWRtbF9tYXgoVXJnZW50TGF0ZW5jeVBp
eGVsRGF0YU9ubHksIExpbmVUaW1lIC8gNC4wKSk7CisJCX0gZWxzZSB7CisJCQlUaW1lRm9yRmV0
Y2hpbmdSb3dJblZCbGFua0ltbWVkaWF0ZUZsaXAgPSAwOworCQl9CisKKwkJKkRlc3RpbmF0aW9u
TGluZXNUb1JlcXVlc3RSb3dJbkltbWVkaWF0ZUZsaXAgPSBkbWxfZmxvb3IoCisJCQkJNC4wICog
KFRpbWVGb3JGZXRjaGluZ1Jvd0luVkJsYW5rSW1tZWRpYXRlRmxpcCAvIExpbmVUaW1lICsgMC4x
MjUpLAorCQkJCTEpIC8gNC4wOworCisJCWlmIChHUFVWTUVuYWJsZSA9PSB0cnVlKSB7CisJCQkq
ZmluYWxfZmxpcF9idyA9CisJCQkJCWRtbF9tYXgoCisJCQkJCQkJUERFQW5kTWV0YVBURUJ5dGVz
RnJhbWUKKwkJCQkJCQkJCS8gKCpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1ZXN0Vk1JbkltbWVkaWF0
ZUZsaXAKKwkJCQkJCQkJCQkJKiBMaW5lVGltZSksCisJCQkJCQkJKE1ldGFSb3dCeXRlICsgUGl4
ZWxQVEVCeXRlc1BlclJvdykKKwkJCQkJCQkJCS8gKFRpbWVGb3JGZXRjaGluZ1Jvd0luVkJsYW5r
SW1tZWRpYXRlRmxpcAorCQkJCQkJCQkJCQkqIExpbmVUaW1lKSk7CisJCX0gZWxzZSBpZiAoTWV0
YVJvd0J5dGUgKyBQaXhlbFBURUJ5dGVzUGVyUm93ID4gMCkgeworCQkJKmZpbmFsX2ZsaXBfYncg
PSAoTWV0YVJvd0J5dGUgKyBQaXhlbFBURUJ5dGVzUGVyUm93KQorCQkJCQkvIChUaW1lRm9yRmV0
Y2hpbmdSb3dJblZCbGFua0ltbWVkaWF0ZUZsaXAgKiBMaW5lVGltZSk7CisJCX0gZWxzZSB7CisJ
CQkqZmluYWxfZmxpcF9idyA9IDA7CisJCX0KKworCQlpZiAoR1BVVk1FbmFibGUgJiYgIURDQ0Vu
YWJsZSkKKwkJCW1pbl9yb3dfdGltZSA9IGRwdGVfcm93X2hlaWdodCAqIExpbmVUaW1lIC8gVlJh
dGlvOworCQllbHNlIGlmICghR1BVVk1FbmFibGUgJiYgRENDRW5hYmxlKQorCQkJbWluX3Jvd190
aW1lID0gbWV0YV9yb3dfaGVpZ2h0ICogTGluZVRpbWUgLyBWUmF0aW87CisJCWVsc2UKKwkJCW1p
bl9yb3dfdGltZSA9IGRtbF9taW4oZHB0ZV9yb3dfaGVpZ2h0LCBtZXRhX3Jvd19oZWlnaHQpICog
TGluZVRpbWUKKwkJCQkJLyBWUmF0aW87CisKKwkJaWYgKCpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1
ZXN0Vk1JbkltbWVkaWF0ZUZsaXAgPj0gOAorCQkJCXx8ICpEZXN0aW5hdGlvbkxpbmVzVG9SZXF1
ZXN0Um93SW5JbW1lZGlhdGVGbGlwID49IDE2CisJCQkJfHwgVGltZUZvckZldGNoaW5nTWV0YVBU
RUltbWVkaWF0ZUZsaXAKKwkJCQkJCSsgMiAqIFRpbWVGb3JGZXRjaGluZ1Jvd0luVkJsYW5rSW1t
ZWRpYXRlRmxpcAorCQkJCQkJPiBtaW5fcm93X3RpbWUpCisJCQkqSW1tZWRpYXRlRmxpcFN1cHBv
cnRlZEZvclBpcGUgPSBmYWxzZTsKKwkJZWxzZQorCQkJKkltbWVkaWF0ZUZsaXBTdXBwb3J0ZWRG
b3JQaXBlID0gdHJ1ZTsKKwl9Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgVHJ1bmNUb1ZhbGlk
QlBQKAorCQlkb3VibGUgRGVjaW1hbEJQUCwKKwkJYm9vbCBEU0NFbmFibGVkLAorCQllbnVtIG91
dHB1dF9lbmNvZGVyX2NsYXNzIE91dHB1dCwKKwkJZW51bSBvdXRwdXRfZm9ybWF0X2NsYXNzIEZv
cm1hdCwKKwkJdW5zaWduZWQgaW50IERTQ0lucHV0Qml0UGVyQ29tcG9uZW50KQoreworCWlmIChP
dXRwdXQgPT0gZG1faGRtaSkgeworCQlpZiAoRm9ybWF0ID09IGRtXzQyMCkgeworCQkJaWYgKERl
Y2ltYWxCUFAgPj0gMTgpCisJCQkJcmV0dXJuIDE4OworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+
PSAxNSkKKwkJCQlyZXR1cm4gMTU7CisJCQllbHNlIGlmIChEZWNpbWFsQlBQID49IDEyKQorCQkJ
CXJldHVybiAxMjsKKwkJCWVsc2UKKwkJCQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCX0gZWxzZSBp
ZiAoRm9ybWF0ID09IGRtXzQ0NCkgeworCQkJaWYgKERlY2ltYWxCUFAgPj0gMzYpCisJCQkJcmV0
dXJuIDM2OworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAzMCkKKwkJCQlyZXR1cm4gMzA7CisJ
CQllbHNlIGlmIChEZWNpbWFsQlBQID49IDI0KQorCQkJCXJldHVybiAyNDsKKwkJCWVsc2UgaWYg
KERlY2ltYWxCUFAgPj0gMTgpCisJCQkJcmV0dXJuIDE4OworCQkJZWxzZQorCQkJCXJldHVybiBC
UFBfSU5WQUxJRDsKKwkJfSBlbHNlIHsKKwkJCWlmIChEZWNpbWFsQlBQIC8gMS41ID49IDI0KQor
CQkJCXJldHVybiAyNDsKKwkJCWVsc2UgaWYgKERlY2ltYWxCUFAgLyAxLjUgPj0gMjApCisJCQkJ
cmV0dXJuIDIwOworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCAvIDEuNSA+PSAxNikKKwkJCQlyZXR1
cm4gMTY7CisJCQllbHNlCisJCQkJcmV0dXJuIEJQUF9JTlZBTElEOworCQl9CisJfSBlbHNlIHsK
KwkJaWYgKERTQ0VuYWJsZWQpIHsKKwkJCWlmIChGb3JtYXQgPT0gZG1fNDIwKSB7CisJCQkJaWYg
KERlY2ltYWxCUFAgPCA2KQorCQkJCQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCQkJZWxzZSBpZiAo
RGVjaW1hbEJQUCA+PSAxLjUgKiBEU0NJbnB1dEJpdFBlckNvbXBvbmVudCAtIDEgLyAxNikKKwkJ
CQkJcmV0dXJuIDEuNSAqIERTQ0lucHV0Qml0UGVyQ29tcG9uZW50IC0gMSAvIDE2OworCQkJCWVs
c2UKKwkJCQkJcmV0dXJuIGRtbF9mbG9vcigxNiAqIERlY2ltYWxCUFAsIDEpIC8gMTY7CisJCQl9
IGVsc2UgaWYgKEZvcm1hdCA9PSBkbV9uNDIyKSB7CisJCQkJaWYgKERlY2ltYWxCUFAgPCA3KQor
CQkJCQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAyICog
RFNDSW5wdXRCaXRQZXJDb21wb25lbnQgLSAxIC8gMTYpCisJCQkJCXJldHVybiAyICogRFNDSW5w
dXRCaXRQZXJDb21wb25lbnQgLSAxIC8gMTY7CisJCQkJZWxzZQorCQkJCQlyZXR1cm4gZG1sX2Zs
b29yKDE2ICogRGVjaW1hbEJQUCwgMSkgLyAxNjsKKwkJCX0gZWxzZSB7CisJCQkJaWYgKERlY2lt
YWxCUFAgPCA4KQorCQkJCQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCQkJZWxzZSBpZiAoRGVjaW1h
bEJQUCA+PSAzICogRFNDSW5wdXRCaXRQZXJDb21wb25lbnQgLSAxIC8gMTYpCisJCQkJCXJldHVy
biAzICogRFNDSW5wdXRCaXRQZXJDb21wb25lbnQgLSAxIC8gMTY7CisJCQkJZWxzZQorCQkJCQly
ZXR1cm4gZG1sX2Zsb29yKDE2ICogRGVjaW1hbEJQUCwgMSkgLyAxNjsKKwkJCX0KKwkJfSBlbHNl
IGlmIChGb3JtYXQgPT0gZG1fNDIwKSB7CisJCQlpZiAoRGVjaW1hbEJQUCA+PSAxOCkKKwkJCQly
ZXR1cm4gMTg7CisJCQllbHNlIGlmIChEZWNpbWFsQlBQID49IDE1KQorCQkJCXJldHVybiAxNTsK
KwkJCWVsc2UgaWYgKERlY2ltYWxCUFAgPj0gMTIpCisJCQkJcmV0dXJuIDEyOworCQkJZWxzZQor
CQkJCXJldHVybiBCUFBfSU5WQUxJRDsKKwkJfSBlbHNlIGlmIChGb3JtYXQgPT0gZG1fczQyMiB8
fCBGb3JtYXQgPT0gZG1fbjQyMikgeworCQkJaWYgKERlY2ltYWxCUFAgPj0gMjQpCisJCQkJcmV0
dXJuIDI0OworCQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAyMCkKKwkJCQlyZXR1cm4gMjA7CisJ
CQllbHNlIGlmIChEZWNpbWFsQlBQID49IDE2KQorCQkJCXJldHVybiAxNjsKKwkJCWVsc2UKKwkJ
CQlyZXR1cm4gQlBQX0lOVkFMSUQ7CisJCX0gZWxzZSB7CisJCQlpZiAoRGVjaW1hbEJQUCA+PSAz
NikKKwkJCQlyZXR1cm4gMzY7CisJCQllbHNlIGlmIChEZWNpbWFsQlBQID49IDMwKQorCQkJCXJl
dHVybiAzMDsKKwkJCWVsc2UgaWYgKERlY2ltYWxCUFAgPj0gMjQpCisJCQkJcmV0dXJuIDI0Owor
CQkJZWxzZSBpZiAoRGVjaW1hbEJQUCA+PSAxOCkKKwkJCQlyZXR1cm4gMTg7CisJCQllbHNlCisJ
CQkJcmV0dXJuIEJQUF9JTlZBTElEOworCQl9CisJfQorfQorCit2b2lkIGRtbDIwdjJfTW9kZVN1
cHBvcnRBbmRTeXN0ZW1Db25maWd1cmF0aW9uRnVsbChzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAq
bW9kZV9saWIpCit7CisJc3RydWN0IHZiYV92YXJzX3N0ICpsb2NhbHMgPSAmbW9kZV9saWItPnZi
YTsKKworCWludCBpOworCXVuc2lnbmVkIGludCBqLCBrLCBtOworCisJLypNT0RFIFNVUFBPUlQs
IFZPTFRBR0UgU1RBVEUgQU5EIFNPQyBDT05GSUdVUkFUSU9OKi8KKworCS8qU2NhbGUgUmF0aW8s
IHRhcHMgU3VwcG9ydCBDaGVjayovCisKKwltb2RlX2xpYi0+dmJhLlNjYWxlUmF0aW9BbmRUYXBz
U3VwcG9ydCA9IHRydWU7CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9m
QWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLlNjYWxlckVuYWJs
ZWRba10gPT0gZmFsc2UKKwkJCQkmJiAoKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRb
a10gIT0gZG1fNDQ0XzY0CisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0
W2tdICE9IGRtXzQ0NF8zMgorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1h
dFtrXSAhPSBkbV80NDRfMTYKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3Jt
YXRba10gIT0gZG1fbW9ub18xNgorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZv
cm1hdFtrXSAhPSBkbV9tb25vXzgpCisJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLkhSYXRpb1trXSAh
PSAxLjAKKwkJCQkJCXx8IG1vZGVfbGliLT52YmEuaHRhcHNba10gIT0gMS4wCisJCQkJCQl8fCBt
b2RlX2xpYi0+dmJhLlZSYXRpb1trXSAhPSAxLjAKKwkJCQkJCXx8IG1vZGVfbGliLT52YmEudnRh
cHNba10gIT0gMS4wKSkgeworCQkJbW9kZV9saWItPnZiYS5TY2FsZVJhdGlvQW5kVGFwc1N1cHBv
cnQgPSBmYWxzZTsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLnZ0YXBzW2tdIDwgMS4wIHx8
IG1vZGVfbGliLT52YmEudnRhcHNba10gPiA4LjAKKwkJCQl8fCBtb2RlX2xpYi0+dmJhLmh0YXBz
W2tdIDwgMS4wIHx8IG1vZGVfbGliLT52YmEuaHRhcHNba10gPiA4LjAKKwkJCQl8fCAobW9kZV9s
aWItPnZiYS5odGFwc1trXSA+IDEuMAorCQkJCQkJJiYgKG1vZGVfbGliLT52YmEuaHRhcHNba10g
JSAyKSA9PSAxKQorCQkJCXx8IG1vZGVfbGliLT52YmEuSFJhdGlvW2tdID4gbW9kZV9saWItPnZi
YS5NYXhIU0NMUmF0aW8KKwkJCQl8fCBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSA+IG1vZGVfbGli
LT52YmEuTWF4VlNDTFJhdGlvCisJCQkJfHwgbW9kZV9saWItPnZiYS5IUmF0aW9ba10gPiBtb2Rl
X2xpYi0+dmJhLmh0YXBzW2tdCisJCQkJfHwgbW9kZV9saWItPnZiYS5WUmF0aW9ba10gPiBtb2Rl
X2xpYi0+dmJhLnZ0YXBzW2tdCisJCQkJfHwgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3Jt
YXRba10gIT0gZG1fNDQ0XzY0CisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9y
bWF0W2tdICE9IGRtXzQ0NF8zMgorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZv
cm1hdFtrXSAhPSBkbV80NDRfMTYKKwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxG
b3JtYXRba10gIT0gZG1fbW9ub18xNgorCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhl
bEZvcm1hdFtrXSAhPSBkbV9tb25vXzgKKwkJCQkJCSYmIChtb2RlX2xpYi0+dmJhLkhSYXRpb1tr
XSAvIDIuMAorCQkJCQkJCQk+IG1vZGVfbGliLT52YmEuSFRBUHNDaHJvbWFba10KKwkJCQkJCQkJ
fHwgbW9kZV9saWItPnZiYS5WUmF0aW9ba10gLyAyLjAKKwkJCQkJCQkJCQk+IG1vZGVfbGliLT52
YmEuVlRBUHNDaHJvbWFba10pKSkgeworCQkJbW9kZV9saWItPnZiYS5TY2FsZVJhdGlvQW5kVGFw
c1N1cHBvcnQgPSBmYWxzZTsKKwkJfQorCX0KKwkvKlNvdXJjZSBGb3JtYXQsIFBpeGVsIEZvcm1h
dCBhbmQgU2NhbiBTdXBwb3J0IENoZWNrKi8KKworCW1vZGVfbGliLT52YmEuU291cmNlRm9ybWF0
UGl4ZWxBbmRTY2FuU3VwcG9ydCA9IHRydWU7CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+
dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmICgobW9kZV9saWItPnZi
YS5TdXJmYWNlVGlsaW5nW2tdID09IGRtX3N3X2xpbmVhcgorCQkJCSYmIG1vZGVfbGliLT52YmEu
U291cmNlU2NhbltrXSAhPSBkbV9ob3J6KQorCQkJCXx8ICgobW9kZV9saWItPnZiYS5TdXJmYWNl
VGlsaW5nW2tdID09IGRtX3N3XzRrYl9kCisJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZhY2VU
aWxpbmdba10gPT0gZG1fc3dfNGtiX2RfeAorCQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJmYWNl
VGlsaW5nW2tdID09IGRtX3N3XzY0a2JfZAorCQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJmYWNl
VGlsaW5nW2tdID09IGRtX3N3XzY0a2JfZF90CisJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZh
Y2VUaWxpbmdba10gPT0gZG1fc3dfNjRrYl9kX3gKKwkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3Vy
ZmFjZVRpbGluZ1trXSA9PSBkbV9zd192YXJfZAorCQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJm
YWNlVGlsaW5nW2tdID09IGRtX3N3X3Zhcl9kX3gpCisJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNv
dXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQ0NF82NCkKKwkJCQl8fCAobW9kZV9saWItPnZiYS5T
dXJmYWNlVGlsaW5nW2tdID09IGRtX3N3XzY0a2Jfcl94CisJCQkJCQkmJiAobW9kZV9saWItPnZi
YS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV9tb25vXzgKKwkJCQkJCQkJfHwgbW9kZV9saWIt
PnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXQorCQkJCQkJCQkJCT09IGRtXzQyMF84CisJCQkJCQkJ
CXx8IG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10KKwkJCQkJCQkJCQk9PSBkbV80
MjBfMTApKQorCQkJCXx8ICgoKG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXSA9PSBkbV9z
d19nZng3XzJkX3RoaW5fZ2wKKwkJCQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1tr
XQorCQkJCQkJCQk9PSBkbV9zd19nZng3XzJkX3RoaW5fbHZwKQorCQkJCQkJJiYgISgobW9kZV9s
aWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXQorCQkJCQkJCQk9PSBkbV80NDRfNjQKKwkJCQkJ
CQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXQorCQkJCQkJCQkJCT09IGRt
XzQ0NF8zMikKKwkJCQkJCQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdCisJCQkJCQkJ
CQkJPT0gZG1faG9yegorCQkJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlN1cHBvcnRHRlg3Q29tcGF0
aWJsZVRpbGluZ0luMzJicHBBbmQ2NGJwcAorCQkJCQkJCQkJCT09IHRydWUKKwkJCQkJCQkJJiYg
bW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10KKwkJCQkJCQkJCQk9PSBmYWxzZSkpCisJCQkJCQl8
fCAobW9kZV9saWItPnZiYS5EQ0NFbmFibGVba10gPT0gdHJ1ZQorCQkJCQkJCQkmJiAobW9kZV9s
aWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJPT0gZG1fc3dfbGluZWFyCisJCQkJ
CQkJCQkJfHwgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXQorCQkJCQkJCQkJCQkJ
PT0gZG1fNDIwXzgKKwkJCQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0
W2tdCisJCQkJCQkJCQkJCQk9PSBkbV80MjBfMTApKSkpIHsKKwkJCW1vZGVfbGliLT52YmEuU291
cmNlRm9ybWF0UGl4ZWxBbmRTY2FuU3VwcG9ydCA9IGZhbHNlOworCQl9CisJfQorCS8qQmFuZHdp
ZHRoIFN1cHBvcnQgQ2hlY2sqLworCisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51
bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJj
ZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF82NCkgeworCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxJ
bkRFVFlba10gPSA4LjA7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSA9IDAuMDsK
KwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0
NF8zMikgeworCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10gPSA0LjA7CisJCQlsb2Nh
bHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSA9IDAuMDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+
dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF8xNgorCQkJCXx8IG1vZGVfbGliLT52
YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fbW9ub18xNikgeworCQkJbG9jYWxzLT5CeXRl
UGVyUGl4ZWxJbkRFVFlba10gPSAyLjA7CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1tr
XSA9IDAuMDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2td
ID09IGRtX21vbm9fOCkgeworCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10gPSAxLjA7
CisJCQlsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSA9IDAuMDsKKwkJfSBlbHNlIGlmICht
b2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQyMF84KSB7CisJCQlsb2Nh
bHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSA9IDEuMDsKKwkJCWxvY2Fscy0+Qnl0ZVBlclBpeGVs
SW5ERVRDW2tdID0gMi4wOworCQl9IGVsc2UgeworCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRF
VFlba10gPSA0LjAgLyAzOworCQkJbG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVENba10gPSA4LjAg
LyAzOworCQl9CisJCWlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikg
eworCQkJbG9jYWxzLT5Td2F0aFdpZHRoWVNpbmdsZURQUFtrXSA9IG1vZGVfbGliLT52YmEuVmll
d3BvcnRXaWR0aFtrXTsKKwkJfSBlbHNlIHsKKwkJCWxvY2Fscy0+U3dhdGhXaWR0aFlTaW5nbGVE
UFBba10gPSBtb2RlX2xpYi0+dmJhLlZpZXdwb3J0SGVpZ2h0W2tdOworCQl9CisJfQorCWZvciAo
ayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykg
eworCQlsb2NhbHMtPlJlYWRCYW5kd2lkdGhMdW1hW2tdID0gbG9jYWxzLT5Td2F0aFdpZHRoWVNp
bmdsZURQUFtrXSAqIGRtbF9jZWlsKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdLCAxLjAp
CisJCQkJLyAobW9kZV9saWItPnZiYS5IVG90YWxba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xv
Y2tba10pICogbW9kZV9saWItPnZiYS5WUmF0aW9ba107CisJCWxvY2Fscy0+UmVhZEJhbmR3aWR0
aENocm9tYVtrXSA9IGxvY2Fscy0+U3dhdGhXaWR0aFlTaW5nbGVEUFBba10gLyAyICogZG1sX2Nl
aWwobG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVENba10sIDIuMCkKKwkJCQkvIChtb2RlX2xpYi0+
dmJhLkhUb3RhbFtrXSAvIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkgKiBtb2RlX2xpYi0+
dmJhLlZSYXRpb1trXSAvIDIuMDsKKwkJbG9jYWxzLT5SZWFkQmFuZHdpZHRoW2tdID0gbG9jYWxz
LT5SZWFkQmFuZHdpZHRoTHVtYVtrXSArIGxvY2Fscy0+UmVhZEJhbmR3aWR0aENocm9tYVtrXTsK
Kwl9CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVz
IC0gMTsgaysrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9PSB0
cnVlCisJCQkJJiYgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSA9PSBkbV80
NDRfMzIpIHsKKwkJCWxvY2Fscy0+V3JpdGVCYW5kd2lkdGhba10gPSBtb2RlX2xpYi0+dmJhLldy
aXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJCQkJKiBtb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0Rlc3RpbmF0aW9uSGVpZ2h0W2tdCisJCQkJCS8gKG1vZGVfbGliLT52YmEuV3JpdGViYWNrU291
cmNlSGVpZ2h0W2tdCisJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCS8g
bW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKSAqIDQuMDsKKwkJfSBlbHNlIGlmIChtb2RlX2xp
Yi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9PSB0cnVlCisJCQkJJiYgbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfMTApIHsKKwkJCWxvY2Fscy0+V3JpdGVC
YW5kd2lkdGhba10gPSBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10K
KwkJCQkJKiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uSGVpZ2h0W2tdCisJCQkJ
CS8gKG1vZGVfbGliLT52YmEuV3JpdGViYWNrU291cmNlSGVpZ2h0W2tdCisJCQkJCQkJKiBtb2Rl
X2xpYi0+dmJhLkhUb3RhbFtrXQorCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2td
KSAqIDMuMDsKKwkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0VuYWJsZVtrXSA9
PSB0cnVlKSB7CisJCQlsb2NhbHMtPldyaXRlQmFuZHdpZHRoW2tdID0gbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoW2tdCisJCQkJCSogbW9kZV9saWItPnZiYS5Xcml0ZWJh
Y2tEZXN0aW5hdGlvbkhlaWdodFtrXQorCQkJCQkvIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja1Nv
dXJjZUhlaWdodFtrXQorCQkJCQkJCSogbW9kZV9saWItPnZiYS5IVG90YWxba10KKwkJCQkJCQkv
IG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSkgKiAxLjU7CisJCX0gZWxzZSB7CisJCQlsb2Nh
bHMtPldyaXRlQmFuZHdpZHRoW2tdID0gMC4wOworCQl9CisJfQorCW1vZGVfbGliLT52YmEuREND
RW5hYmxlZEluQW55UGxhbmUgPSBmYWxzZTsKKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52
YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVfbGliLT52YmEu
RENDRW5hYmxlW2tdID09IHRydWUpIHsKKwkJCW1vZGVfbGliLT52YmEuRENDRW5hYmxlZEluQW55
UGxhbmUgPSB0cnVlOworCQl9CisJfQorCWZvciAoaSA9IDA7IGkgPD0gbW9kZV9saWItPnZiYS5z
b2MubnVtX3N0YXRlczsgaSsrKSB7CisJCWxvY2Fscy0+RmFicmljQW5kRFJBTUJhbmR3aWR0aFBl
clN0YXRlW2ldID0gZG1sX21pbigKKwkJCQltb2RlX2xpYi0+dmJhLkRSQU1TcGVlZFBlclN0YXRl
W2ldICogbW9kZV9saWItPnZiYS5OdW1iZXJPZkNoYW5uZWxzCisJCQkJCQkqIG1vZGVfbGliLT52
YmEuRFJBTUNoYW5uZWxXaWR0aCwKKwkJCQltb2RlX2xpYi0+dmJhLkZhYnJpY0Nsb2NrUGVyU3Rh
dGVbaV0KKwkJCQkJCSogbW9kZV9saWItPnZiYS5GYWJyaWNEYXRhcGF0aFRvRENORGF0YVJldHVy
bikgLyAxMDAwOworCQlsb2NhbHMtPlJldHVybkJXVG9EQ05QZXJTdGF0ZSA9IGRtbF9taW4obG9j
YWxzLT5SZXR1cm5CdXNXaWR0aCAqIGxvY2Fscy0+RENGQ0xLUGVyU3RhdGVbaV0sCisJCQkJbG9j
YWxzLT5GYWJyaWNBbmREUkFNQmFuZHdpZHRoUGVyU3RhdGVbaV0gKiAxMDAwKQorCQkJCSogbG9j
YWxzLT5QZXJjZW50T2ZJZGVhbERSQU1GYWJyaWNBbmRTRFBQb3J0QldSZWNlaXZlZEFmdGVyVXJn
TGF0ZW5jeVBpeGVsRGF0YU9ubHkgLyAxMDA7CisKKwkJbG9jYWxzLT5SZXR1cm5CV1BlclN0YXRl
W2ldID0gbG9jYWxzLT5SZXR1cm5CV1RvRENOUGVyU3RhdGU7CisKKwkJaWYgKGxvY2Fscy0+REND
RW5hYmxlZEluQW55UGxhbmUgPT0gdHJ1ZSAmJiBsb2NhbHMtPlJldHVybkJXVG9EQ05QZXJTdGF0
ZSA+IGxvY2Fscy0+RENGQ0xLUGVyU3RhdGVbaV0gKiBsb2NhbHMtPlJldHVybkJ1c1dpZHRoIC8g
NCkgeworCQkJbG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldID0gZG1sX21pbihsb2NhbHMtPlJl
dHVybkJXUGVyU3RhdGVbaV0sCisJCQkJCWxvY2Fscy0+UmV0dXJuQldUb0RDTlBlclN0YXRlICog
NCAqICgxIC0gbG9jYWxzLT5VcmdlbnRMYXRlbmN5IC8KKwkJCQkJKChsb2NhbHMtPlJPQkJ1ZmZl
clNpemVJbktCeXRlIC0gbG9jYWxzLT5QaXhlbENodW5rU2l6ZUluS0J5dGUpICogMTAyNAorCQkJ
CQkvIChsb2NhbHMtPlJldHVybkJXVG9EQ05QZXJTdGF0ZSAtIGxvY2Fscy0+RENGQ0xLUGVyU3Rh
dGVbaV0KKwkJCQkJKiBsb2NhbHMtPlJldHVybkJ1c1dpZHRoIC8gNCkgKyBsb2NhbHMtPlVyZ2Vu
dExhdGVuY3kpKSk7CisJCX0KKwkJbG9jYWxzLT5Dcml0aWNhbFBvaW50ID0gMiAqIGxvY2Fscy0+
UmV0dXJuQnVzV2lkdGggKiBsb2NhbHMtPkRDRkNMS1BlclN0YXRlW2ldICoKKwkJCQlsb2NhbHMt
PlVyZ2VudExhdGVuY3kgLyAobG9jYWxzLT5SZXR1cm5CV1RvRENOUGVyU3RhdGUgKiBsb2NhbHMt
PlVyZ2VudExhdGVuY3kKKwkJCQkrIChsb2NhbHMtPlJPQkJ1ZmZlclNpemVJbktCeXRlIC0gbG9j
YWxzLT5QaXhlbENodW5rU2l6ZUluS0J5dGUpICogMTAyNCk7CisKKwkJaWYgKGxvY2Fscy0+REND
RW5hYmxlZEluQW55UGxhbmUgJiYgbG9jYWxzLT5Dcml0aWNhbFBvaW50ID4gMSAmJiBsb2NhbHMt
PkNyaXRpY2FsUG9pbnQgPCA0KSB7CisJCQlsb2NhbHMtPlJldHVybkJXUGVyU3RhdGVbaV0gPSBk
bWxfbWluKGxvY2Fscy0+UmV0dXJuQldQZXJTdGF0ZVtpXSwKKwkJCQk0ICogbG9jYWxzLT5SZXR1
cm5CV1RvRENOUGVyU3RhdGUgKgorCQkJCShsb2NhbHMtPlJPQkJ1ZmZlclNpemVJbktCeXRlIC0g
bG9jYWxzLT5QaXhlbENodW5rU2l6ZUluS0J5dGUpICogMTAyNAorCQkJCSogbG9jYWxzLT5SZXR1
cm5CdXNXaWR0aCAqIGxvY2Fscy0+RENGQ0xLUGVyU3RhdGVbaV0gKiBsb2NhbHMtPlVyZ2VudExh
dGVuY3kgLworCQkJCWRtbF9wb3coKGxvY2Fscy0+UmV0dXJuQldUb0RDTlBlclN0YXRlICogbG9j
YWxzLT5VcmdlbnRMYXRlbmN5CisJCQkJKyAobG9jYWxzLT5ST0JCdWZmZXJTaXplSW5LQnl0ZSAt
IGxvY2Fscy0+UGl4ZWxDaHVua1NpemVJbktCeXRlKSAqIDEwMjQpLCAyKSk7CisJCX0KKworCQls
b2NhbHMtPlJldHVybkJXVG9EQ05QZXJTdGF0ZSA9IGRtbF9taW4obG9jYWxzLT5SZXR1cm5CdXNX
aWR0aCAqCisJCQkJbG9jYWxzLT5EQ0ZDTEtQZXJTdGF0ZVtpXSwgbG9jYWxzLT5GYWJyaWNBbmRE
UkFNQmFuZHdpZHRoUGVyU3RhdGVbaV0gKiAxMDAwKTsKKworCQlpZiAobG9jYWxzLT5EQ0NFbmFi
bGVkSW5BbnlQbGFuZSA9PSB0cnVlICYmIGxvY2Fscy0+UmV0dXJuQldUb0RDTlBlclN0YXRlID4g
bG9jYWxzLT5EQ0ZDTEtQZXJTdGF0ZVtpXSAqIGxvY2Fscy0+UmV0dXJuQnVzV2lkdGggLyA0KSB7
CisJCQlsb2NhbHMtPlJldHVybkJXUGVyU3RhdGVbaV0gPSBkbWxfbWluKGxvY2Fscy0+UmV0dXJu
QldQZXJTdGF0ZVtpXSwKKwkJCQkJbG9jYWxzLT5SZXR1cm5CV1RvRENOUGVyU3RhdGUgKiA0ICog
KDEgLSBsb2NhbHMtPlVyZ2VudExhdGVuY3kgLworCQkJCQkoKGxvY2Fscy0+Uk9CQnVmZmVyU2l6
ZUluS0J5dGUgLSBsb2NhbHMtPlBpeGVsQ2h1bmtTaXplSW5LQnl0ZSkgKiAxMDI0CisJCQkJCS8g
KGxvY2Fscy0+UmV0dXJuQldUb0RDTlBlclN0YXRlIC0gbG9jYWxzLT5EQ0ZDTEtQZXJTdGF0ZVtp
XQorCQkJCQkqIGxvY2Fscy0+UmV0dXJuQnVzV2lkdGggLyA0KSArIGxvY2Fscy0+VXJnZW50TGF0
ZW5jeSkpKTsKKwkJfQorCQlsb2NhbHMtPkNyaXRpY2FsUG9pbnQgPSAyICogbG9jYWxzLT5SZXR1
cm5CdXNXaWR0aCAqIGxvY2Fscy0+RENGQ0xLUGVyU3RhdGVbaV0gKgorCQkJCWxvY2Fscy0+VXJn
ZW50TGF0ZW5jeSAvIChsb2NhbHMtPlJldHVybkJXVG9EQ05QZXJTdGF0ZSAqIGxvY2Fscy0+VXJn
ZW50TGF0ZW5jeQorCQkJCSsgKGxvY2Fscy0+Uk9CQnVmZmVyU2l6ZUluS0J5dGUgLSBsb2NhbHMt
PlBpeGVsQ2h1bmtTaXplSW5LQnl0ZSkgKiAxMDI0KTsKKworCQlpZiAobG9jYWxzLT5EQ0NFbmFi
bGVkSW5BbnlQbGFuZSAmJiBsb2NhbHMtPkNyaXRpY2FsUG9pbnQgPiAxICYmIGxvY2Fscy0+Q3Jp
dGljYWxQb2ludCA8IDQpIHsKKwkJCWxvY2Fscy0+UmV0dXJuQldQZXJTdGF0ZVtpXSA9IGRtbF9t
aW4obG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldLAorCQkJCTQgKiBsb2NhbHMtPlJldHVybkJX
VG9EQ05QZXJTdGF0ZSAqCisJCQkJKGxvY2Fscy0+Uk9CQnVmZmVyU2l6ZUluS0J5dGUgLSBsb2Nh
bHMtPlBpeGVsQ2h1bmtTaXplSW5LQnl0ZSkgKiAxMDI0CisJCQkJKiBsb2NhbHMtPlJldHVybkJ1
c1dpZHRoICogbG9jYWxzLT5EQ0ZDTEtQZXJTdGF0ZVtpXSAqIGxvY2Fscy0+VXJnZW50TGF0ZW5j
eSAvCisJCQkJZG1sX3BvdygobG9jYWxzLT5SZXR1cm5CV1RvRENOUGVyU3RhdGUgKiBsb2NhbHMt
PlVyZ2VudExhdGVuY3kKKwkJCQkrIChsb2NhbHMtPlJPQkJ1ZmZlclNpemVJbktCeXRlIC0gbG9j
YWxzLT5QaXhlbENodW5rU2l6ZUluS0J5dGUpICogMTAyNCksIDIpKTsKKwkJfQorCX0KKwkvKldy
aXRlYmFjayBMYXRlbmN5IHN1cHBvcnQgY2hlY2sqLworCisJbW9kZV9saWItPnZiYS5Xcml0ZWJh
Y2tMYXRlbmN5U3VwcG9ydCA9IHRydWU7CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLldy
aXRlYmFja0VuYWJsZVtrXSA9PSB0cnVlKSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJh
Y2tQaXhlbEZvcm1hdFtrXSA9PSBkbV80NDRfMzIpIHsKKwkJCQlpZiAobG9jYWxzLT5Xcml0ZUJh
bmR3aWR0aFtrXQorCQkJCQkJPiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tJbnRlcmZhY2VMdW1h
QnVmZmVyU2l6ZQorCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuV3JpdGViYWNrSW50ZXJmYWNlQ2hy
b21hQnVmZmVyU2l6ZSkKKwkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0xhdGVuY3kp
IHsKKwkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMYXRlbmN5U3VwcG9ydCA9IGZhbHNlOwor
CQkJCX0KKwkJCX0gZWxzZSB7CisJCQkJaWYgKGxvY2Fscy0+V3JpdGVCYW5kd2lkdGhba10KKwkJ
CQkJCT4gMS41CisJCQkJCQkJCSogZG1sX21pbigKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldy
aXRlYmFja0ludGVyZmFjZUx1bWFCdWZmZXJTaXplLAorCQkJCQkJCQkJCTIuMAorCQkJCQkJCQkJ
CQkJKiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0ludGVyZmFjZUNocm9tYUJ1ZmZlclNpemUpCisJ
CQkJCQkJCS8gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMYXRlbmN5KSB7CisJCQkJCW1vZGVfbGli
LT52YmEuV3JpdGViYWNrTGF0ZW5jeVN1cHBvcnQgPSBmYWxzZTsKKwkJCQl9CisJCQl9CisJCX0K
Kwl9CisJLypSZS1vcmRlcmluZyBCdWZmZXIgU3VwcG9ydCBDaGVjayovCisKKwlmb3IgKGkgPSAw
OyBpIDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7IGkrKykgeworCQlsb2NhbHMtPlVy
Z2VudFJvdW5kVHJpcEFuZE91dE9mT3JkZXJMYXRlbmN5UGVyU3RhdGVbaV0gPQorCQkJCShtb2Rl
X2xpYi0+dmJhLlJvdW5kVHJpcFBpbmdMYXRlbmN5Q3ljbGVzICsgMzIuMCkgLyBtb2RlX2xpYi0+
dmJhLkRDRkNMS1BlclN0YXRlW2ldCisJCQkJKyBsb2NhbHMtPlVyZ2VudE91dE9mT3JkZXJSZXR1
cm5QZXJDaGFubmVsICogbW9kZV9saWItPnZiYS5OdW1iZXJPZkNoYW5uZWxzIC8gbG9jYWxzLT5S
ZXR1cm5CV1BlclN0YXRlW2ldOworCQlpZiAoKG1vZGVfbGliLT52YmEuUk9CQnVmZmVyU2l6ZUlu
S0J5dGUgLSBtb2RlX2xpYi0+dmJhLlBpeGVsQ2h1bmtTaXplSW5LQnl0ZSkgKiAxMDI0LjAgLyBs
b2NhbHMtPlJldHVybkJXUGVyU3RhdGVbaV0KKwkJCQk+IGxvY2Fscy0+VXJnZW50Um91bmRUcmlw
QW5kT3V0T2ZPcmRlckxhdGVuY3lQZXJTdGF0ZVtpXSkgeworCQkJbG9jYWxzLT5ST0JTdXBwb3J0
W2ldID0gdHJ1ZTsKKwkJfSBlbHNlIHsKKwkJCWxvY2Fscy0+Uk9CU3VwcG9ydFtpXSA9IGZhbHNl
OworCQl9CisJfQorCS8qV3JpdGViYWNrIE1vZGUgU3VwcG9ydCBDaGVjayovCisKKwltb2RlX2xp
Yi0+dmJhLlRvdGFsTnVtYmVyT2ZBY3RpdmVXcml0ZWJhY2sgPSAwOworCWZvciAoayA9IDA7IGsg
PD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlpZiAo
bW9kZV9saWItPnZiYS5Xcml0ZWJhY2tFbmFibGVba10gPT0gdHJ1ZSkgeworCQkJaWYgKG1vZGVf
bGliLT52YmEuQWN0aXZlV3JpdGViYWNrc1BlclBsYW5lW2tdID09IDApCisJCQkJbW9kZV9saWIt
PnZiYS5BY3RpdmVXcml0ZWJhY2tzUGVyUGxhbmVba10gPSAxOworCQkJbW9kZV9saWItPnZiYS5U
b3RhbE51bWJlck9mQWN0aXZlV3JpdGViYWNrID0KKwkJCQkJbW9kZV9saWItPnZiYS5Ub3RhbE51
bWJlck9mQWN0aXZlV3JpdGViYWNrCisJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLkFjdGl2ZVdyaXRl
YmFja3NQZXJQbGFuZVtrXTsKKwkJfQorCX0KKwltb2RlX2xpYi0+dmJhLldyaXRlYmFja01vZGVT
dXBwb3J0ID0gdHJ1ZTsKKwlpZiAobW9kZV9saWItPnZiYS5Ub3RhbE51bWJlck9mQWN0aXZlV3Jp
dGViYWNrID4gbW9kZV9saWItPnZiYS5NYXhOdW1Xcml0ZWJhY2spIHsKKwkJbW9kZV9saWItPnZi
YS5Xcml0ZWJhY2tNb2RlU3VwcG9ydCA9IGZhbHNlOworCX0KKwlmb3IgKGsgPSAwOyBrIDw9IG1v
ZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVf
bGliLT52YmEuV3JpdGViYWNrRW5hYmxlW2tdID09IHRydWUKKwkJCQkmJiBtb2RlX2xpYi0+dmJh
LldyaXRlYmFjazEwYnBjNDIwU3VwcG9ydGVkICE9IHRydWUKKwkJCQkmJiBtb2RlX2xpYi0+dmJh
LldyaXRlYmFja1BpeGVsRm9ybWF0W2tdID09IGRtXzQyMF8xMCkgeworCQkJbW9kZV9saWItPnZi
YS5Xcml0ZWJhY2tNb2RlU3VwcG9ydCA9IGZhbHNlOworCQl9CisJfQorCS8qV3JpdGViYWNrIFNj
YWxlIFJhdGlvIGFuZCBUYXBzIFN1cHBvcnQgQ2hlY2sqLworCisJbW9kZV9saWItPnZiYS5Xcml0
ZWJhY2tTY2FsZVJhdGlvQW5kVGFwc1N1cHBvcnQgPSB0cnVlOworCWZvciAoayA9IDA7IGsgPD0g
bW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlpZiAobW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tFbmFibGVba10gPT0gdHJ1ZSkgeworCQkJaWYgKG1vZGVfbGli
LT52YmEuV3JpdGViYWNrTHVtYUFuZENocm9tYVNjYWxpbmdTdXBwb3J0ZWQgPT0gZmFsc2UKKwkJ
CQkJJiYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrSFJhdGlvW2tdICE9IDEuMAorCQkJCQkJCXx8
IG1vZGVfbGliLT52YmEuV3JpdGViYWNrVlJhdGlvW2tdICE9IDEuMCkpIHsKKwkJCQltb2RlX2xp
Yi0+dmJhLldyaXRlYmFja1NjYWxlUmF0aW9BbmRUYXBzU3VwcG9ydCA9IGZhbHNlOworCQkJfQor
CQkJaWYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNrSFJhdGlvW2tdID4gbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tNYXhIU0NMUmF0aW8KKwkJCQkJfHwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWUmF0
aW9ba10KKwkJCQkJCQk+IG1vZGVfbGliLT52YmEuV3JpdGViYWNrTWF4VlNDTFJhdGlvCisJCQkJ
CXx8IG1vZGVfbGliLT52YmEuV3JpdGViYWNrSFJhdGlvW2tdCisJCQkJCQkJPCBtb2RlX2xpYi0+
dmJhLldyaXRlYmFja01pbkhTQ0xSYXRpbworCQkJCQl8fCBtb2RlX2xpYi0+dmJhLldyaXRlYmFj
a1ZSYXRpb1trXQorCQkJCQkJCTwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tNaW5WU0NMUmF0aW8K
KwkJCQkJfHwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRhcHNba10KKwkJCQkJCQk+IG1v
ZGVfbGliLT52YmEuV3JpdGViYWNrTWF4SFNDTFRhcHMKKwkJCQkJfHwgbW9kZV9saWItPnZiYS5X
cml0ZWJhY2tMdW1hVlRhcHNba10KKwkJCQkJCQk+IG1vZGVfbGliLT52YmEuV3JpdGViYWNrTWF4
VlNDTFRhcHMKKwkJCQkJfHwgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10KKwkJCQkJ
CQk+IG1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYUhUYXBzW2tdCisJCQkJCXx8IG1vZGVfbGli
LT52YmEuV3JpdGViYWNrVlJhdGlvW2tdCisJCQkJCQkJPiBtb2RlX2xpYi0+dmJhLldyaXRlYmFj
a0x1bWFWVGFwc1trXQorCQkJCQl8fCAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRhcHNb
a10gPiAyLjAKKwkJCQkJCQkmJiAoKG1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYUhUYXBzW2td
ICUgMikKKwkJCQkJCQkJCT09IDEpKQorCQkJCQl8fCAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQ
aXhlbEZvcm1hdFtrXSAhPSBkbV80NDRfMzIKKwkJCQkJCQkmJiAobW9kZV9saWItPnZiYS5Xcml0
ZWJhY2tDaHJvbWFIVGFwc1trXQorCQkJCQkJCQkJPiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja01h
eEhTQ0xUYXBzCisJCQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYVZUYXBz
W2tdCisJCQkJCQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tNYXhWU0NMVGFwcworCQkJ
CQkJCQkJfHwgMi4wCisJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9b
a10KKwkJCQkJCQkJCQkJPiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYUhUYXBzW2tdCisJ
CQkJCQkJCQl8fCAyLjAKKwkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja1ZSYXRp
b1trXQorCQkJCQkJCQkJCQk+IG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hVlRhcHNba10K
KwkJCQkJCQkJCXx8IChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYUhUYXBzW2tdID4gMi4w
CisJCQkJCQkJCQkJJiYgKChtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYUhUYXBzW2tdICUg
MikgPT0gMSkpKSkpIHsKKwkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja1NjYWxlUmF0aW9BbmRU
YXBzU3VwcG9ydCA9IGZhbHNlOworCQkJfQorCQkJaWYgKG1vZGVfbGliLT52YmEuV3JpdGViYWNr
VlJhdGlvW2tdIDwgMS4wKSB7CisJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVkV4dHJh
ID0KKwkJCQkJCWRtbF9tYXgoMS4wIC0gMi4wIC8gZG1sX2NlaWwoMS4wIC8gbW9kZV9saWItPnZi
YS5Xcml0ZWJhY2tWUmF0aW9ba10sIDEuMCksIDAuMCk7CisJCQl9IGVsc2UgeworCQkJCW1vZGVf
bGliLT52YmEuV3JpdGViYWNrTHVtYVZFeHRyYSA9IC0xOworCQkJfQorCQkJaWYgKChtb2RlX2xp
Yi0+dmJhLldyaXRlYmFja1BpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF8zMgorCQkJCQkmJiBtb2Rl
X2xpYi0+dmJhLldyaXRlYmFja0x1bWFWVGFwc1trXQorCQkJCQkJCT4gKG1vZGVfbGliLT52YmEu
V3JpdGViYWNrTGluZUJ1ZmZlckx1bWFCdWZmZXJTaXplCisJCQkJCQkJCQkrIG1vZGVfbGliLT52
YmEuV3JpdGViYWNrTGluZUJ1ZmZlckNocm9tYUJ1ZmZlclNpemUpCisJCQkJCQkJCQkvIDMuMAor
CQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10KKwkJ
CQkJCQkJCS0gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVkV4dHJhKQorCQkJCQl8fCAobW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfOAorCQkJCQkJCSYm
IG1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYVZUYXBzW2tdCisJCQkJCQkJCQk+IG1vZGVfbGli
LT52YmEuV3JpdGViYWNrTGluZUJ1ZmZlckx1bWFCdWZmZXJTaXplCisJCQkJCQkJCQkJCSogOC4w
IC8gMTAuMCAvIG1vZGVfbGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFtrXQorCQkJ
CQkJCQkJCQktIG1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYVZFeHRyYSkKKwkJCQkJfHwgKG1v
ZGVfbGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRba10gPT0gZG1fNDIwXzEwCisJCQkJCQkJ
JiYgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVlRhcHNba10KKwkJCQkJCQkJCT4gbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tMaW5lQnVmZmVyTHVtYUJ1ZmZlclNpemUKKwkJCQkJCQkJCQkJKiA4
LjAgLyAxMC4wCisJCQkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tEZXN0aW5hdGlv
bldpZHRoW2tdCisJCQkJCQkJCQkJCS0gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVkV4dHJh
KSkgeworCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrU2NhbGVSYXRpb0FuZFRhcHNTdXBwb3J0
ID0gZmFsc2U7CisJCQl9CisJCQlpZiAoMi4wICogbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWUmF0
aW9ba10gPCAxKSB7CisJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFWRXh0cmEgPSAw
LjA7CisJCQl9IGVsc2UgeworCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hVkV4dHJh
ID0gLTE7CisJCQl9CisJCQlpZiAoKG1vZGVfbGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRb
a10gPT0gZG1fNDIwXzgKKwkJCQkJJiYgbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFWVGFw
c1trXQorCQkJCQkJCT4gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMaW5lQnVmZmVyQ2hyb21hQnVm
ZmVyU2l6ZQorCQkJCQkJCQkJKiA4LjAgLyAxMC4wIC8gbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tE
ZXN0aW5hdGlvbldpZHRoW2tdCisJCQkJCQkJCQktIG1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hy
b21hVkV4dHJhKQorCQkJCQl8fCAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtr
XSA9PSBkbV80MjBfMTAKKwkJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYVZU
YXBzW2tdCisJCQkJCQkJCQk+IG1vZGVfbGliLT52YmEuV3JpdGViYWNrTGluZUJ1ZmZlckNocm9t
YUJ1ZmZlclNpemUKKwkJCQkJCQkJCQkJKiA4LjAgLyAxMC4wCisJCQkJCQkJCQkJCS8gbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tEZXN0aW5hdGlvbldpZHRoW2tdCisJCQkJCQkJCQkJCS0gbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFWRXh0cmEpKSB7CisJCQkJbW9kZV9saWItPnZiYS5Xcml0
ZWJhY2tTY2FsZVJhdGlvQW5kVGFwc1N1cHBvcnQgPSBmYWxzZTsKKwkJCX0KKwkJfQorCX0KKwkv
Kk1heGltdW0gRElTUENMSy9EUFBDTEsgU3VwcG9ydCBjaGVjayovCisKKwltb2RlX2xpYi0+dmJh
LldyaXRlYmFja1JlcXVpcmVkRElTUENMSyA9IDAuMDsKKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVf
bGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVfbGli
LT52YmEuV3JpdGViYWNrRW5hYmxlW2tdID09IHRydWUpIHsKKwkJCW1vZGVfbGliLT52YmEuV3Jp
dGViYWNrUmVxdWlyZWRESVNQQ0xLID0KKwkJCQkJZG1sX21heCgKKwkJCQkJCQltb2RlX2xpYi0+
dmJhLldyaXRlYmFja1JlcXVpcmVkRElTUENMSywKKwkJCQkJCQlDYWxjdWxhdGVXcml0ZUJhY2tE
SVNQQ0xLKAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tQaXhlbEZvcm1hdFtrXSwK
KwkJCQkJCQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSwKKwkJCQkJCQkJCW1vZGVfbGli
LT52YmEuV3JpdGViYWNrSFJhdGlvW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJh
Y2tWUmF0aW9ba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0x1bWFIVGFwc1tr
XSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTHVtYVZUYXBzW2tdLAorCQkJCQkJ
CQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFIVGFwc1trXSwKKwkJCQkJCQkJCW1vZGVf
bGliLT52YmEuV3JpdGViYWNrQ2hyb21hVlRhcHNba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJh
LldyaXRlYmFja0Rlc3RpbmF0aW9uV2lkdGhba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhU
b3RhbFtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrQ2hyb21hTGluZUJ1ZmZl
cldpZHRoKSk7CisJCX0KKwl9CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJl
ck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWlmIChtb2RlX2xpYi0+dmJhLkhSYXRpb1tr
XSA+IDEuMCkgeworCQkJbG9jYWxzLT5QU0NMX0ZBQ1RPUltrXSA9IGRtbF9taW4oCisJCQkJCW1v
ZGVfbGliLT52YmEuTWF4RENIVUJUb1BTQ0xUaHJvdWdocHV0LAorCQkJCQltb2RlX2xpYi0+dmJh
Lk1heFBTQ0xUb0xCVGhyb3VnaHB1dAorCQkJCQkJCSogbW9kZV9saWItPnZiYS5IUmF0aW9ba10K
KwkJCQkJCQkvIGRtbF9jZWlsKAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5odGFwc1trXQorCQkJ
CQkJCQkJCQkvIDYuMCwKKwkJCQkJCQkJCTEuMCkpOworCQl9IGVsc2UgeworCQkJbG9jYWxzLT5Q
U0NMX0ZBQ1RPUltrXSA9IGRtbF9taW4oCisJCQkJCW1vZGVfbGliLT52YmEuTWF4RENIVUJUb1BT
Q0xUaHJvdWdocHV0LAorCQkJCQltb2RlX2xpYi0+dmJhLk1heFBTQ0xUb0xCVGhyb3VnaHB1dCk7
CisJCX0KKwkJaWYgKGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRDW2tdID09IDAuMCkgeworCQkJ
bG9jYWxzLT5QU0NMX0ZBQ1RPUl9DSFJPTUFba10gPSAwLjA7CisJCQlsb2NhbHMtPk1pbkRQUENM
S1VzaW5nU2luZ2xlRFBQW2tdID0KKwkJCQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdCisJ
CQkJCQkJKiBkbWxfbWF4MygKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEudnRhcHNba10gLyA2LjAK
KwkJCQkJCQkJCQkJKiBkbWxfbWluKAorCQkJCQkJCQkJCQkJCTEuMCwKKwkJCQkJCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLkhSYXRpb1trXSksCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkhSYXRpb1tr
XQorCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuVlJhdGlvW2tdCisJCQkJCQkJCQkJCS8gbG9j
YWxzLT5QU0NMX0ZBQ1RPUltrXSwKKwkJCQkJCQkJCTEuMCk7CisJCQlpZiAoKG1vZGVfbGliLT52
YmEuaHRhcHNba10gPiA2LjAgfHwgbW9kZV9saWItPnZiYS52dGFwc1trXSA+IDYuMCkKKwkJCQkJ
JiYgbG9jYWxzLT5NaW5EUFBDTEtVc2luZ1NpbmdsZURQUFtrXQorCQkJCQkJCTwgMi4wICogbW9k
ZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKSB7CisJCQkJbG9jYWxzLT5NaW5EUFBDTEtVc2luZ1Np
bmdsZURQUFtrXSA9IDIuMAorCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba107CisJ
CQl9CisJCX0gZWxzZSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5IUmF0aW9ba10gLyAyLjAgPiAx
LjApIHsKKwkJCQlsb2NhbHMtPlBTQ0xfRkFDVE9SX0NIUk9NQVtrXSA9CisJCQkJCQlkbWxfbWlu
KAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLk1heERDSFVCVG9QU0NMVGhyb3VnaHB1dCwKKwkJCQkJ
CQkJbW9kZV9saWItPnZiYS5NYXhQU0NMVG9MQlRocm91Z2hwdXQKKwkJCQkJCQkJCQkqIG1vZGVf
bGliLT52YmEuSFJhdGlvW2tdCisJCQkJCQkJCQkJLyAyLjAKKwkJCQkJCQkJCQkvIGRtbF9jZWls
KAorCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IVEFQc0Nocm9tYVtrXQorCQkJCQkJCQkJCQkJ
CQkvIDYuMCwKKwkJCQkJCQkJCQkJCTEuMCkpOworCQkJfSBlbHNlIHsKKwkJCQlsb2NhbHMtPlBT
Q0xfRkFDVE9SX0NIUk9NQVtrXSA9IGRtbF9taW4oCisJCQkJCQltb2RlX2xpYi0+dmJhLk1heERD
SFVCVG9QU0NMVGhyb3VnaHB1dCwKKwkJCQkJCW1vZGVfbGliLT52YmEuTWF4UFNDTFRvTEJUaHJv
dWdocHV0KTsKKwkJCX0KKwkJCWxvY2Fscy0+TWluRFBQQ0xLVXNpbmdTaW5nbGVEUFBba10gPQor
CQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10KKwkJCQkJCQkqIGRtbF9tYXg1KAorCQkJ
CQkJCQkJbW9kZV9saWItPnZiYS52dGFwc1trXSAvIDYuMAorCQkJCQkJCQkJCQkqIGRtbF9taW4o
CisJCQkJCQkJCQkJCQkJMS4wLAorCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuSFJhdGlvW2td
KSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuSFJhdGlvW2tdCisJCQkJCQkJCQkJCSogbW9kZV9s
aWItPnZiYS5WUmF0aW9ba10KKwkJCQkJCQkJCQkJLyBsb2NhbHMtPlBTQ0xfRkFDVE9SW2tdLAor
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5WVEFQc0Nocm9tYVtrXQorCQkJCQkJCQkJCQkvIDYuMAor
CQkJCQkJCQkJCQkqIGRtbF9taW4oCisJCQkJCQkJCQkJCQkJMS4wLAorCQkJCQkJCQkJCQkJCW1v
ZGVfbGliLT52YmEuSFJhdGlvW2tdCisJCQkJCQkJCQkJCQkJCQkvIDIuMCksCisJCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLkhSYXRpb1trXQorCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuVlJhdGlv
W2tdCisJCQkJCQkJCQkJCS8gNC4wCisJCQkJCQkJCQkJCS8gbG9jYWxzLT5QU0NMX0ZBQ1RPUl9D
SFJPTUFba10sCisJCQkJCQkJCQkxLjApOworCQkJaWYgKChtb2RlX2xpYi0+dmJhLmh0YXBzW2td
ID4gNi4wIHx8IG1vZGVfbGliLT52YmEudnRhcHNba10gPiA2LjAKKwkJCQkJfHwgbW9kZV9saWIt
PnZiYS5IVEFQc0Nocm9tYVtrXSA+IDYuMAorCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlZUQVBzQ2hy
b21hW2tdID4gNi4wKQorCQkJCQkmJiBsb2NhbHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2td
CisJCQkJCQkJPCAyLjAgKiBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pIHsKKwkJCQlsb2Nh
bHMtPk1pbkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdID0gMi4wCisJCQkJCQkqIG1vZGVfbGliLT52
YmEuUGl4ZWxDbG9ja1trXTsKKwkJCX0KKwkJfQorCX0KKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVf
bGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJQ2FsY3VsYXRlMjU2
QkJsb2NrU2l6ZXMoCisJCQkJbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSwKKwkJ
CQltb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10sCisJCQkJZG1sX2NlaWwobG9jYWxzLT5C
eXRlUGVyUGl4ZWxJbkRFVFlba10sIDEuMCksCisJCQkJZG1sX2NlaWwobG9jYWxzLT5CeXRlUGVy
UGl4ZWxJbkRFVENba10sIDIuMCksCisJCQkJJmxvY2Fscy0+UmVhZDI1NkJsb2NrSGVpZ2h0WVtr
XSwKKwkJCQkmbG9jYWxzLT5SZWFkMjU2QmxvY2tIZWlnaHRDW2tdLAorCQkJCSZsb2NhbHMtPlJl
YWQyNTZCbG9ja1dpZHRoWVtrXSwKKwkJCQkmbG9jYWxzLT5SZWFkMjU2QmxvY2tXaWR0aENba10p
OworCQlpZiAobW9kZV9saWItPnZiYS5Tb3VyY2VTY2FuW2tdID09IGRtX2hvcnopIHsKKwkJCWxv
Y2Fscy0+TWF4U3dhdGhIZWlnaHRZW2tdID0gbG9jYWxzLT5SZWFkMjU2QmxvY2tIZWlnaHRZW2td
OworCQkJbG9jYWxzLT5NYXhTd2F0aEhlaWdodENba10gPSBsb2NhbHMtPlJlYWQyNTZCbG9ja0hl
aWdodENba107CisJCX0gZWxzZSB7CisJCQlsb2NhbHMtPk1heFN3YXRoSGVpZ2h0WVtrXSA9IGxv
Y2Fscy0+UmVhZDI1NkJsb2NrV2lkdGhZW2tdOworCQkJbG9jYWxzLT5NYXhTd2F0aEhlaWdodENb
a10gPSBsb2NhbHMtPlJlYWQyNTZCbG9ja1dpZHRoQ1trXTsKKwkJfQorCQlpZiAoKG1vZGVfbGli
LT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzY0CisJCQkJfHwgbW9kZV9saWIt
PnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80NDRfMzIKKwkJCQl8fCBtb2RlX2xpYi0+
dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdID09IGRtXzQ0NF8xNgorCQkJCXx8IG1vZGVfbGliLT52
YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fbW9ub18xNgorCQkJCXx8IG1vZGVfbGliLT52
YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fbW9ub184KSkgeworCQkJaWYgKG1vZGVfbGli
LT52YmEuU3VyZmFjZVRpbGluZ1trXSA9PSBkbV9zd19saW5lYXIKKwkJCQkJfHwgKG1vZGVfbGli
LT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gPT0gZG1fNDQ0XzY0CisJCQkJCQkJJiYgKG1vZGVf
bGliLT52YmEuU3VyZmFjZVRpbGluZ1trXQorCQkJCQkJCQkJPT0gZG1fc3dfNGtiX3MKKwkJCQkJ
CQkJCXx8IG1vZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXQorCQkJCQkJCQkJCQk9PSBkbV9z
d180a2Jfc194CisJCQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10KKwkJ
CQkJCQkJCQkJPT0gZG1fc3dfNjRrYl9zCisJCQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZh
Y2VUaWxpbmdba10KKwkJCQkJCQkJCQkJPT0gZG1fc3dfNjRrYl9zX3QKKwkJCQkJCQkJCXx8IG1v
ZGVfbGliLT52YmEuU3VyZmFjZVRpbGluZ1trXQorCQkJCQkJCQkJCQk9PSBkbV9zd182NGtiX3Nf
eAorCQkJCQkJCQkJfHwgbW9kZV9saWItPnZiYS5TdXJmYWNlVGlsaW5nW2tdCisJCQkJCQkJCQkJ
CT09IGRtX3N3X3Zhcl9zCisJCQkJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdb
a10KKwkJCQkJCQkJCQkJPT0gZG1fc3dfdmFyX3NfeCkKKwkJCQkJCQkmJiBtb2RlX2xpYi0+dmJh
LlNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikpIHsKKwkJCQlsb2NhbHMtPk1pblN3YXRoSGVpZ2h0
WVtrXSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRZW2tdOworCQkJfSBlbHNlIHsKKwkJCQlsb2Nh
bHMtPk1pblN3YXRoSGVpZ2h0WVtrXSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRZW2tdCisJCQkJ
CQkvIDIuMDsKKwkJCX0KKwkJCWxvY2Fscy0+TWluU3dhdGhIZWlnaHRDW2tdID0gbG9jYWxzLT5N
YXhTd2F0aEhlaWdodENba107CisJCX0gZWxzZSB7CisJCQlpZiAobW9kZV9saWItPnZiYS5TdXJm
YWNlVGlsaW5nW2tdID09IGRtX3N3X2xpbmVhcikgeworCQkJCWxvY2Fscy0+TWluU3dhdGhIZWln
aHRZW2tdID0gbG9jYWxzLT5NYXhTd2F0aEhlaWdodFlba107CisJCQkJbG9jYWxzLT5NaW5Td2F0
aEhlaWdodENba10gPSBsb2NhbHMtPk1heFN3YXRoSGVpZ2h0Q1trXTsKKwkJCX0gZWxzZSBpZiAo
bW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSA9PSBkbV80MjBfOAorCQkJCQkmJiBt
b2RlX2xpYi0+dmJhLlNvdXJjZVNjYW5ba10gPT0gZG1faG9yeikgeworCQkJCWxvY2Fscy0+TWlu
U3dhdGhIZWlnaHRZW2tdID0gbG9jYWxzLT5NYXhTd2F0aEhlaWdodFlba10KKwkJCQkJCS8gMi4w
OworCQkJCWxvY2Fscy0+TWluU3dhdGhIZWlnaHRDW2tdID0gbG9jYWxzLT5NYXhTd2F0aEhlaWdo
dENba107CisJCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10g
PT0gZG1fNDIwXzEwCisJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlU2NhbltrXSA9PSBkbV9o
b3J6KSB7CisJCQkJbG9jYWxzLT5NaW5Td2F0aEhlaWdodENba10gPSBsb2NhbHMtPk1heFN3YXRo
SGVpZ2h0Q1trXQorCQkJCQkJLyAyLjA7CisJCQkJbG9jYWxzLT5NaW5Td2F0aEhlaWdodFlba10g
PSBsb2NhbHMtPk1heFN3YXRoSGVpZ2h0WVtrXTsKKwkJCX0gZWxzZSB7CisJCQkJbG9jYWxzLT5N
aW5Td2F0aEhlaWdodFlba10gPSBsb2NhbHMtPk1heFN3YXRoSGVpZ2h0WVtrXTsKKwkJCQlsb2Nh
bHMtPk1pblN3YXRoSGVpZ2h0Q1trXSA9IGxvY2Fscy0+TWF4U3dhdGhIZWlnaHRDW2tdOworCQkJ
fQorCQl9CisJCWlmIChtb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxpbmdba10gPT0gZG1fc3dfbGlu
ZWFyKSB7CisJCQltb2RlX2xpYi0+dmJhLk1heGltdW1Td2F0aFdpZHRoU3VwcG9ydCA9IDgxOTIu
MDsKKwkJfSBlbHNlIHsKKwkJCW1vZGVfbGliLT52YmEuTWF4aW11bVN3YXRoV2lkdGhTdXBwb3J0
ID0gNTEyMC4wOworCQl9CisJCW1vZGVfbGliLT52YmEuTWF4aW11bVN3YXRoV2lkdGhJbkRFVEJ1
ZmZlciA9CisJCQkJZG1sX21pbigKKwkJCQkJCW1vZGVfbGliLT52YmEuTWF4aW11bVN3YXRoV2lk
dGhTdXBwb3J0LAorCQkJCQkJbW9kZV9saWItPnZiYS5ERVRCdWZmZXJTaXplSW5LQnl0ZSAqIDEw
MjQuMCAvIDIuMAorCQkJCQkJCQkvIChsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXQorCQkJ
CQkJCQkJCSogbG9jYWxzLT5NaW5Td2F0aEhlaWdodFlba10KKwkJCQkJCQkJCQkrIGxvY2Fscy0+
Qnl0ZVBlclBpeGVsSW5ERVRDW2tdCisJCQkJCQkJCQkJCQkvIDIuMAorCQkJCQkJCQkJCQkJKiBs
b2NhbHMtPk1pblN3YXRoSGVpZ2h0Q1trXSkpOworCQlpZiAobG9jYWxzLT5CeXRlUGVyUGl4ZWxJ
bkRFVENba10gPT0gMC4wKSB7CisJCQltb2RlX2xpYi0+dmJhLk1heGltdW1Td2F0aFdpZHRoSW5M
aW5lQnVmZmVyID0KKwkJCQkJbW9kZV9saWItPnZiYS5MaW5lQnVmZmVyU2l6ZQorCQkJCQkJCSog
ZG1sX21heChtb2RlX2xpYi0+dmJhLkhSYXRpb1trXSwgMS4wKQorCQkJCQkJCS8gbW9kZV9saWIt
PnZiYS5MQkJpdFBlclBpeGVsW2tdCisJCQkJCQkJLyAobW9kZV9saWItPnZiYS52dGFwc1trXQor
CQkJCQkJCQkJKyBkbWxfbWF4KAorCQkJCQkJCQkJCQlkbWxfY2VpbCgKKwkJCQkJCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLlZSYXRpb1trXSwKKwkJCQkJCQkJCQkJCQkxLjApCisJCQkJCQkJCQkJCQkJ
LSAyLAorCQkJCQkJCQkJCQkwLjApKTsKKwkJfSBlbHNlIHsKKwkJCW1vZGVfbGliLT52YmEuTWF4
aW11bVN3YXRoV2lkdGhJbkxpbmVCdWZmZXIgPQorCQkJCQlkbWxfbWluKAorCQkJCQkJCW1vZGVf
bGliLT52YmEuTGluZUJ1ZmZlclNpemUKKwkJCQkJCQkJCSogZG1sX21heCgKKwkJCQkJCQkJCQkJ
bW9kZV9saWItPnZiYS5IUmF0aW9ba10sCisJCQkJCQkJCQkJCTEuMCkKKwkJCQkJCQkJCS8gbW9k
ZV9saWItPnZiYS5MQkJpdFBlclBpeGVsW2tdCisJCQkJCQkJCQkvIChtb2RlX2xpYi0+dmJhLnZ0
YXBzW2tdCisJCQkJCQkJCQkJCSsgZG1sX21heCgKKwkJCQkJCQkJCQkJCQlkbWxfY2VpbCgKKwkJ
CQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCQkJCQkJCQkJCQkJMS4w
KQorCQkJCQkJCQkJCQkJCQkJLSAyLAorCQkJCQkJCQkJCQkJCTAuMCkpLAorCQkJCQkJCTIuMCAq
IG1vZGVfbGliLT52YmEuTGluZUJ1ZmZlclNpemUKKwkJCQkJCQkJCSogZG1sX21heCgKKwkJCQkJ
CQkJCQkJbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJCQkJCQkvIDIuMCwKKwkJCQkJ
CQkJCQkJMS4wKQorCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLkxCQml0UGVyUGl4ZWxba10KKwkJ
CQkJCQkJCS8gKG1vZGVfbGliLT52YmEuVlRBUHNDaHJvbWFba10KKwkJCQkJCQkJCQkJKyBkbWxf
bWF4KAorCQkJCQkJCQkJCQkJCWRtbF9jZWlsKAorCQkJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5WUmF0aW9ba10KKwkJCQkJCQkJCQkJCQkJCQkJLyAyLjAsCisJCQkJCQkJCQkJCQkJCQkxLjAp
CisJCQkJCQkJCQkJCQkJCQktIDIsCisJCQkJCQkJCQkJCQkJMC4wKSkpOworCQl9CisJCWxvY2Fs
cy0+TWF4aW11bVN3YXRoV2lkdGhba10gPSBkbWxfbWluKAorCQkJCW1vZGVfbGliLT52YmEuTWF4
aW11bVN3YXRoV2lkdGhJbkRFVEJ1ZmZlciwKKwkJCQltb2RlX2xpYi0+dmJhLk1heGltdW1Td2F0
aFdpZHRoSW5MaW5lQnVmZmVyKTsKKwl9CisJZm9yIChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJh
LnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJZm9yIChqID0gMDsgaiA8IDI7IGorKykgeworCQkJ
bW9kZV9saWItPnZiYS5NYXhEaXNwY2xrUm91bmRlZERvd25Ub0RGU0dyYW51bGFyaXR5ID0gUm91
bmRUb0RGU0dyYW51bGFyaXR5RG93bigKKwkJCQltb2RlX2xpYi0+dmJhLk1heERpc3BjbGtbaV0s
CisJCQkJbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLVkNPU3BlZWQpOworCQkJbW9kZV9saWIt
PnZiYS5NYXhEcHBjbGtSb3VuZGVkRG93blRvREZTR3JhbnVsYXJpdHkgPSBSb3VuZFRvREZTR3Jh
bnVsYXJpdHlEb3duKAorCQkJCW1vZGVfbGliLT52YmEuTWF4RHBwY2xrW2ldLAorCQkJCW1vZGVf
bGliLT52YmEuRElTUENMS0RQUENMS1ZDT1NwZWVkKTsKKwkJCWxvY2Fscy0+UmVxdWlyZWRESVNQ
Q0xLW2ldW2pdID0gMC4wOworCQkJbG9jYWxzLT5ESVNQQ0xLX0RQUENMS19TdXBwb3J0W2ldW2pd
ID0gdHJ1ZTsKKwkJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2
ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJCW1vZGVfbGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BD
TEtXaXRob3V0T0RNQ29tYmluZSA9CisJCQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10g
KiAoMS4wICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGluZyAv
IDEwMC4wKQorCQkJCQkJCQkqICgxLjAgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtSYW1waW5nTWFy
Z2luIC8gMTAwLjApOworCQkJCWlmIChtb2RlX2xpYi0+dmJhLlBsYW5lUmVxdWlyZWRESVNQQ0xL
V2l0aG91dE9ETUNvbWJpbmUgPj0gbW9kZV9saWItPnZiYS5NYXhEaXNwY2xrW2ldCisJCQkJCQkm
JiBpID09IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXMpCisJCQkJCW1vZGVfbGliLT52YmEu
UGxhbmVSZXF1aXJlZERJU1BDTEtXaXRob3V0T0RNQ29tYmluZSA9IG1vZGVfbGliLT52YmEuUGl4
ZWxDbG9ja1trXQorCQkJCQkJCSogKDEgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0ND
TEtEb3duU3ByZWFkaW5nIC8gMTAwLjApOworCisJCQkJbW9kZV9saWItPnZiYS5QbGFuZVJlcXVp
cmVkRElTUENMS1dpdGhPRE1Db21iaW5lID0gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdIC8g
MgorCQkJCQkqICgxICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVh
ZGluZyAvIDEwMC4wKSAqICgxICsgbW9kZV9saWItPnZiYS5ESVNQQ0xLUmFtcGluZ01hcmdpbiAv
IDEwMC4wKTsKKwkJCQlpZiAobW9kZV9saWItPnZiYS5QbGFuZVJlcXVpcmVkRElTUENMS1dpdGhP
RE1Db21iaW5lID49IG1vZGVfbGliLT52YmEuTWF4RGlzcGNsa1tpXQorCQkJCQkJJiYgaSA9PSBt
b2RlX2xpYi0+dmJhLnNvYy5udW1fc3RhdGVzKQorCQkJCQltb2RlX2xpYi0+dmJhLlBsYW5lUmVx
dWlyZWRESVNQQ0xLV2l0aE9ETUNvbWJpbmUgPSBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10g
LyAyCisJCQkJCQkJKiAoMSArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25T
cHJlYWRpbmcgLyAxMDAuMCk7CisJCQkJaWYgKG1vZGVfbGliLT52YmEuT0RNQ2FwYWJpbGl0eSA9
PSBmYWxzZSB8fCBtb2RlX2xpYi0+dmJhLlBsYW5lUmVxdWlyZWRESVNQQ0xLV2l0aG91dE9ETUNv
bWJpbmUgPD0gbW9kZV9saWItPnZiYS5NYXhEaXNwY2xrUm91bmRlZERvd25Ub0RGU0dyYW51bGFy
aXR5KSB7CisJCQkJCWxvY2Fscy0+T0RNQ29tYmluZUVuYWJsZVBlclN0YXRlW2ldW2tdID0gZmFs
c2U7CisJCQkJCW1vZGVfbGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BDTEsgPSBtb2RlX2xpYi0+
dmJhLlBsYW5lUmVxdWlyZWRESVNQQ0xLV2l0aG91dE9ETUNvbWJpbmU7CisJCQkJfSBlbHNlIHsK
KwkJCQkJbG9jYWxzLT5PRE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbaV1ba10gPSB0cnVlOworCQkJ
CQltb2RlX2xpYi0+dmJhLlBsYW5lUmVxdWlyZWRESVNQQ0xLID0gbW9kZV9saWItPnZiYS5QbGFu
ZVJlcXVpcmVkRElTUENMS1dpdGhPRE1Db21iaW5lOworCQkJCX0KKwkJCQlpZiAobG9jYWxzLT5N
aW5EUFBDTEtVc2luZ1NpbmdsZURQUFtrXSAqICgxLjAgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtE
UFBDTEtEU0NDTEtEb3duU3ByZWFkaW5nIC8gMTAwLjApIDw9IG1vZGVfbGliLT52YmEuTWF4RHBw
Y2xrUm91bmRlZERvd25Ub0RGU0dyYW51bGFyaXR5CisJCQkJCQkmJiBsb2NhbHMtPlN3YXRoV2lk
dGhZU2luZ2xlRFBQW2tdIDw9IGxvY2Fscy0+TWF4aW11bVN3YXRoV2lkdGhba10KKwkJCQkJCSYm
IGxvY2Fscy0+T0RNQ29tYmluZUVuYWJsZVBlclN0YXRlW2ldW2tdID09IGZhbHNlKSB7CisJCQkJ
CWxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXSA9IDE7CisJCQkJCWxvY2Fscy0+UmVxdWlyZWREUFBD
TEtbaV1bal1ba10gPQorCQkJCQkJbG9jYWxzLT5NaW5EUFBDTEtVc2luZ1NpbmdsZURQUFtrXSAq
ICgxLjAgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0NDTEtEb3duU3ByZWFkaW5nIC8g
MTAwLjApOworCQkJCX0gZWxzZSB7CisJCQkJCWxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXSA9IDI7
CisJCQkJCWxvY2Fscy0+UmVxdWlyZWREUFBDTEtbaV1bal1ba10gPQorCQkJCQkJbG9jYWxzLT5N
aW5EUFBDTEtVc2luZ1NpbmdsZURQUFtrXSAqICgxLjAgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtE
UFBDTEtEU0NDTEtEb3duU3ByZWFkaW5nIC8gMTAwLjApIC8gMi4wOworCQkJCX0KKwkJCQlsb2Nh
bHMtPlJlcXVpcmVkRElTUENMS1tpXVtqXSA9IGRtbF9tYXgoCisJCQkJCQlsb2NhbHMtPlJlcXVp
cmVkRElTUENMS1tpXVtqXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BD
TEspOworCQkJCWlmICgobG9jYWxzLT5NaW5EUFBDTEtVc2luZ1NpbmdsZURQUFtrXSAvIGxvY2Fs
cy0+Tm9PZkRQUFtpXVtqXVtrXSAqICgxLjAgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtE
U0NDTEtEb3duU3ByZWFkaW5nIC8gMTAwLjApCisJCQkJCQk+IG1vZGVfbGliLT52YmEuTWF4RHBw
Y2xrUm91bmRlZERvd25Ub0RGU0dyYW51bGFyaXR5KQorCQkJCQkJfHwgKG1vZGVfbGliLT52YmEu
UGxhbmVSZXF1aXJlZERJU1BDTEsgPiBtb2RlX2xpYi0+dmJhLk1heERpc3BjbGtSb3VuZGVkRG93
blRvREZTR3JhbnVsYXJpdHkpKSB7CisJCQkJCWxvY2Fscy0+RElTUENMS19EUFBDTEtfU3VwcG9y
dFtpXVtqXSA9IGZhbHNlOworCQkJCX0KKwkJCX0KKwkJCWxvY2Fscy0+VG90YWxOdW1iZXJPZkFj
dGl2ZURQUFtpXVtqXSA9IDAuMDsKKwkJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5O
dW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykKKwkJCQlsb2NhbHMtPlRvdGFsTnVtYmVyT2ZB
Y3RpdmVEUFBbaV1bal0gPSBsb2NhbHMtPlRvdGFsTnVtYmVyT2ZBY3RpdmVEUFBbaV1bal0gKyBs
b2NhbHMtPk5vT2ZEUFBbaV1bal1ba107CisJCQlpZiAoaiA9PSAxKSB7CisJCQkJd2hpbGUgKGxv
Y2Fscy0+VG90YWxOdW1iZXJPZkFjdGl2ZURQUFtpXVtqXSA8IG1vZGVfbGliLT52YmEuTWF4TnVt
RFBQCisJCQkJCQkmJiBsb2NhbHMtPlRvdGFsTnVtYmVyT2ZBY3RpdmVEUFBbaV1bal0gPCAyICog
bW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcykgeworCQkJCQlkb3VibGUgQldPZk5v
blNwbGl0UGxhbmVPZk1heGltdW1CYW5kd2lkdGg7CisJCQkJCXVuc2lnbmVkIGludCBOdW1iZXJP
Zk5vblNwbGl0UGxhbmVPZk1heGltdW1CYW5kd2lkdGg7CisKKwkJCQkJQldPZk5vblNwbGl0UGxh
bmVPZk1heGltdW1CYW5kd2lkdGggPSAwOworCQkJCQlOdW1iZXJPZk5vblNwbGl0UGxhbmVPZk1h
eGltdW1CYW5kd2lkdGggPSAwOworCQkJCQlmb3IgKGsgPSAwOyBrIDwgbW9kZV9saWItPnZiYS5O
dW1iZXJPZkFjdGl2ZVBsYW5lczsgKytrKSB7CisJCQkJCQlpZiAobG9jYWxzLT5SZWFkQmFuZHdp
ZHRoW2tdID4gQldPZk5vblNwbGl0UGxhbmVPZk1heGltdW1CYW5kd2lkdGggJiYgbG9jYWxzLT5O
b09mRFBQW2ldW2pdW2tdID09IDEpIHsKKwkJCQkJCQlCV09mTm9uU3BsaXRQbGFuZU9mTWF4aW11
bUJhbmR3aWR0aCA9IGxvY2Fscy0+UmVhZEJhbmR3aWR0aFtrXTsKKwkJCQkJCQlOdW1iZXJPZk5v
blNwbGl0UGxhbmVPZk1heGltdW1CYW5kd2lkdGggPSBrOworCQkJCQkJfQorCQkJCQl9CisJCQkJ
CWxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtOdW1iZXJPZk5vblNwbGl0UGxhbmVPZk1heGltdW1CYW5k
d2lkdGhdID0gMjsKKwkJCQkJbG9jYWxzLT5SZXF1aXJlZERQUENMS1tpXVtqXVtOdW1iZXJPZk5v
blNwbGl0UGxhbmVPZk1heGltdW1CYW5kd2lkdGhdID0KKwkJCQkJCWxvY2Fscy0+TWluRFBQQ0xL
VXNpbmdTaW5nbGVEUFBbTnVtYmVyT2ZOb25TcGxpdFBsYW5lT2ZNYXhpbXVtQmFuZHdpZHRoXQor
CQkJCQkJCSogKDEgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0NDTEtEb3duU3ByZWFk
aW5nIC8gMTAwKSAvIDI7CisJCQkJCWxvY2Fscy0+VG90YWxOdW1iZXJPZkFjdGl2ZURQUFtpXVtq
XSA9IGxvY2Fscy0+VG90YWxOdW1iZXJPZkFjdGl2ZURQUFtpXVtqXSArIDE7CisJCQkJfQorCQkJ
fQorCQkJaWYgKGxvY2Fscy0+VG90YWxOdW1iZXJPZkFjdGl2ZURQUFtpXVtqXSA+IG1vZGVfbGli
LT52YmEuTWF4TnVtRFBQKSB7CisJCQkJbG9jYWxzLT5SZXF1aXJlZERJU1BDTEtbaV1bal0gPSAw
LjA7CisJCQkJbG9jYWxzLT5ESVNQQ0xLX0RQUENMS19TdXBwb3J0W2ldW2pdID0gdHJ1ZTsKKwkJ
CQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAx
OyBrKyspIHsKKwkJCQkJbG9jYWxzLT5PRE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbaV1ba10gPSBm
YWxzZTsKKwkJCQkJaWYgKGxvY2Fscy0+U3dhdGhXaWR0aFlTaW5nbGVEUFBba10gPD0gbG9jYWxz
LT5NYXhpbXVtU3dhdGhXaWR0aFtrXSkgeworCQkJCQkJbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2td
ID0gMTsKKwkJCQkJCWxvY2Fscy0+UmVxdWlyZWREUFBDTEtbaV1bal1ba10gPSBsb2NhbHMtPk1p
bkRQUENMS1VzaW5nU2luZ2xlRFBQW2tdCisJCQkJCQkJKiAoMS4wICsgbW9kZV9saWItPnZiYS5E
SVNQQ0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGluZyAvIDEwMC4wKTsKKwkJCQkJfSBlbHNlIHsK
KwkJCQkJCWxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXSA9IDI7CisJCQkJCQlsb2NhbHMtPlJlcXVp
cmVkRFBQQ0xLW2ldW2pdW2tdID0gbG9jYWxzLT5NaW5EUFBDTEtVc2luZ1NpbmdsZURQUFtrXQor
CQkJCQkJCQkJCSogKDEuMCArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25T
cHJlYWRpbmcgLyAxMDAuMCkgLyAyLjA7CisJCQkJCX0KKwkJCQkJaWYgKGkgIT0gbW9kZV9saWIt
PnZiYS5zb2MubnVtX3N0YXRlcykgeworCQkJCQkJbW9kZV9saWItPnZiYS5QbGFuZVJlcXVpcmVk
RElTUENMSyA9CisJCQkJCQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXQorCQkJCQkJCQkJ
CSogKDEuMCArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcg
LyAxMDAuMCkKKwkJCQkJCQkJCQkqICgxLjAgKyBtb2RlX2xpYi0+dmJhLkRJU1BDTEtSYW1waW5n
TWFyZ2luIC8gMTAwLjApOworCQkJCQl9IGVsc2UgeworCQkJCQkJbW9kZV9saWItPnZiYS5QbGFu
ZVJlcXVpcmVkRElTUENMSyA9IG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXQorCQkJCQkJCSog
KDEuMCArIG1vZGVfbGliLT52YmEuRElTUENMS0RQUENMS0RTQ0NMS0Rvd25TcHJlYWRpbmcgLyAx
MDAuMCk7CisJCQkJCX0KKwkJCQkJbG9jYWxzLT5SZXF1aXJlZERJU1BDTEtbaV1bal0gPSBkbWxf
bWF4KAorCQkJCQkJCWxvY2Fscy0+UmVxdWlyZWRESVNQQ0xLW2ldW2pdLAorCQkJCQkJCW1vZGVf
bGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BDTEspOworCQkJCQlpZiAobG9jYWxzLT5NaW5EUFBD
TEtVc2luZ1NpbmdsZURQUFtrXSAvIGxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXSAqICgxLjAgKyBt
b2RlX2xpYi0+dmJhLkRJU1BDTEtEUFBDTEtEU0NDTEtEb3duU3ByZWFkaW5nIC8gMTAwLjApCisJ
CQkJCQkJPiBtb2RlX2xpYi0+dmJhLk1heERwcGNsa1JvdW5kZWREb3duVG9ERlNHcmFudWxhcml0
eQorCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuUGxhbmVSZXF1aXJlZERJU1BDTEsgPiBtb2RlX2xp
Yi0+dmJhLk1heERpc3BjbGtSb3VuZGVkRG93blRvREZTR3JhbnVsYXJpdHkpCisJCQkJCQlsb2Nh
bHMtPkRJU1BDTEtfRFBQQ0xLX1N1cHBvcnRbaV1bal0gPSBmYWxzZTsKKwkJCQl9CisJCQkJbG9j
YWxzLT5Ub3RhbE51bWJlck9mQWN0aXZlRFBQW2ldW2pdID0gMC4wOworCQkJCWZvciAoayA9IDA7
IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykKKwkJCQkJ
bG9jYWxzLT5Ub3RhbE51bWJlck9mQWN0aXZlRFBQW2ldW2pdID0gbG9jYWxzLT5Ub3RhbE51bWJl
ck9mQWN0aXZlRFBQW2ldW2pdICsgbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2tdOworCQkJfQorCQkJ
bG9jYWxzLT5SZXF1aXJlZERJU1BDTEtbaV1bal0gPSBkbWxfbWF4KAorCQkJCQlsb2NhbHMtPlJl
cXVpcmVkRElTUENMS1tpXVtqXSwKKwkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tSZXF1aXJl
ZERJU1BDTEspOworCQkJaWYgKG1vZGVfbGliLT52YmEuTWF4RGlzcGNsa1JvdW5kZWREb3duVG9E
RlNHcmFudWxhcml0eQorCQkJCQk8IG1vZGVfbGliLT52YmEuV3JpdGViYWNrUmVxdWlyZWRESVNQ
Q0xLKSB7CisJCQkJbG9jYWxzLT5ESVNQQ0xLX0RQUENMS19TdXBwb3J0W2ldW2pdID0gZmFsc2U7
CisJCQl9CisJCX0KKwl9CisJLypWaWV3cG9ydCBTaXplIENoZWNrKi8KKworCWZvciAoaSA9IDA7
IGkgPD0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJCWxvY2Fscy0+Vmll
d3BvcnRTaXplU3VwcG9ydFtpXSA9IHRydWU7CisJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJaWYgKGxvY2Fscy0+T0RN
Q29tYmluZUVuYWJsZVBlclN0YXRlW2ldW2tdID09IHRydWUpIHsKKwkJCQlpZiAoZG1sX21pbihs
b2NhbHMtPlN3YXRoV2lkdGhZU2luZ2xlRFBQW2tdLCBkbWxfcm91bmQobW9kZV9saWItPnZiYS5I
QWN0aXZlW2tdIC8gMi4wICogbW9kZV9saWItPnZiYS5IUmF0aW9ba10pKQorCQkJCQkJPiBsb2Nh
bHMtPk1heGltdW1Td2F0aFdpZHRoW2tdKSB7CisJCQkJCWxvY2Fscy0+Vmlld3BvcnRTaXplU3Vw
cG9ydFtpXSA9IGZhbHNlOworCQkJCX0KKwkJCX0gZWxzZSB7CisJCQkJaWYgKGxvY2Fscy0+U3dh
dGhXaWR0aFlTaW5nbGVEUFBba10gLyAyLjAgPiBsb2NhbHMtPk1heGltdW1Td2F0aFdpZHRoW2td
KSB7CisJCQkJCWxvY2Fscy0+Vmlld3BvcnRTaXplU3VwcG9ydFtpXSA9IGZhbHNlOworCQkJCX0K
KwkJCX0KKwkJfQorCX0KKwkvKlRvdGFsIEF2YWlsYWJsZSBQaXBlcyBTdXBwb3J0IENoZWNrKi8K
KworCWZvciAoaSA9IDA7IGkgPD0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlczsgaSsrKSB7
CisJCWZvciAoaiA9IDA7IGogPCAyOyBqKyspIHsKKwkJCWlmIChsb2NhbHMtPlRvdGFsTnVtYmVy
T2ZBY3RpdmVEUFBbaV1bal0gPD0gbW9kZV9saWItPnZiYS5NYXhOdW1EUFApCisJCQkJbG9jYWxz
LT5Ub3RhbEF2YWlsYWJsZVBpcGVzU3VwcG9ydFtpXVtqXSA9IHRydWU7CisJCQllbHNlCisJCQkJ
bG9jYWxzLT5Ub3RhbEF2YWlsYWJsZVBpcGVzU3VwcG9ydFtpXVtqXSA9IGZhbHNlOworCQl9CisJ
fQorCS8qVG90YWwgQXZhaWxhYmxlIE9URyBTdXBwb3J0IENoZWNrKi8KKworCW1vZGVfbGliLT52
YmEuVG90YWxOdW1iZXJPZkFjdGl2ZU9URyA9IDAuMDsKKwlmb3IgKGsgPSAwOyBrIDw9IG1vZGVf
bGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJaWYgKG1vZGVfbGli
LT52YmEuQmxlbmRpbmdBbmRUaW1pbmdba10gPT0gaykgeworCQkJbW9kZV9saWItPnZiYS5Ub3Rh
bE51bWJlck9mQWN0aXZlT1RHID0gbW9kZV9saWItPnZiYS5Ub3RhbE51bWJlck9mQWN0aXZlT1RH
CisJCQkJCSsgMS4wOworCQl9CisJfQorCWlmIChtb2RlX2xpYi0+dmJhLlRvdGFsTnVtYmVyT2ZB
Y3RpdmVPVEcgPD0gbW9kZV9saWItPnZiYS5NYXhOdW1PVEcpIHsKKwkJbW9kZV9saWItPnZiYS5O
dW1iZXJPZk9UR1N1cHBvcnQgPSB0cnVlOworCX0gZWxzZSB7CisJCW1vZGVfbGliLT52YmEuTnVt
YmVyT2ZPVEdTdXBwb3J0ID0gZmFsc2U7CisJfQorCS8qRGlzcGxheSBJTyBhbmQgRFNDIFN1cHBv
cnQgQ2hlY2sqLworCisJbW9kZV9saWItPnZiYS5Ob25zdXBwb3J0ZWREU0NJbnB1dEJQQyA9IGZh
bHNlOworCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5l
cyAtIDE7IGsrKykgeworCQlpZiAoIShtb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9u
ZW50W2tdID09IDEyLjAKKwkJCQl8fCBtb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9u
ZW50W2tdID09IDEwLjAKKwkJCQl8fCBtb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9u
ZW50W2tdID09IDguMCkpIHsKKwkJCW1vZGVfbGliLT52YmEuTm9uc3VwcG9ydGVkRFNDSW5wdXRC
UEMgPSB0cnVlOworCQl9CisJfQorCWZvciAoaSA9IDA7IGkgPD0gbW9kZV9saWItPnZiYS5zb2Mu
bnVtX3N0YXRlczsgaSsrKSB7CisJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1i
ZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJbG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtr
XSA9IDA7CisJCQlsb2NhbHMtPlJlcXVpcmVzRkVDW2ldW2tdID0gMDsKKwkJCWlmIChtb2RlX2xp
Yi0+dmJhLkJsZW5kaW5nQW5kVGltaW5nW2tdID09IGspIHsKKwkJCQlpZiAobW9kZV9saWItPnZi
YS5PdXRwdXRba10gPT0gZG1faGRtaSkgeworCQkJCQlsb2NhbHMtPlJlcXVpcmVzRFNDW2ldW2td
ID0gMDsKKwkJCQkJbG9jYWxzLT5SZXF1aXJlc0ZFQ1tpXVtrXSA9IDA7CisJCQkJCWxvY2Fscy0+
T3V0cHV0QnBwUGVyU3RhdGVbaV1ba10gPSBUcnVuY1RvVmFsaWRCUFAoCisJCQkJCQkJZG1sX21p
big2MDAuMCwgbW9kZV9saWItPnZiYS5QSFlDTEtQZXJTdGF0ZVtpXSkgLyBtb2RlX2xpYi0+dmJh
LlBpeGVsQ2xvY2tCYWNrRW5kW2tdICogMjQsCisJCQkJCQkJZmFsc2UsCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5PdXRwdXRba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10s
CisJCQkJCQkJbW9kZV9saWItPnZiYS5EU0NJbnB1dEJpdFBlckNvbXBvbmVudFtrXSk7CisJCQkJ
fSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLk91dHB1dFtrXSA9PSBkbV9kcAorCQkJCQkJfHwgbW9k
ZV9saWItPnZiYS5PdXRwdXRba10gPT0gZG1fZWRwKSB7CisJCQkJCWlmIChtb2RlX2xpYi0+dmJh
Lk91dHB1dFtrXSA9PSBkbV9lZHApIHsKKwkJCQkJCW1vZGVfbGliLT52YmEuRWZmZWN0aXZlRkVD
T3ZlcmhlYWQgPSAwLjA7CisJCQkJCX0gZWxzZSB7CisJCQkJCQltb2RlX2xpYi0+dmJhLkVmZmVj
dGl2ZUZFQ092ZXJoZWFkID0KKwkJCQkJCQkJbW9kZV9saWItPnZiYS5GRUNPdmVyaGVhZDsKKwkJ
CQkJfQorCQkJCQlpZiAobW9kZV9saWItPnZiYS5QSFlDTEtQZXJTdGF0ZVtpXSA+PSAyNzAuMCkg
eworCQkJCQkJbW9kZV9saWItPnZiYS5PdXRicHAgPSBUcnVuY1RvVmFsaWRCUFAoCisJCQkJCQkJ
CSgxLjAgLSBtb2RlX2xpYi0+dmJhLkRvd25zcHJlYWRpbmcgLyAxMDAuMCkgKiAyNzAuMAorCQkJ
CQkJCQkqIG1vZGVfbGliLT52YmEuT3V0cHV0TGlua0RQTGFuZXNba10gLyBtb2RlX2xpYi0+dmJh
LlBpeGVsQ2xvY2tCYWNrRW5kW2tdICogOC4wLAorCQkJCQkJCQlmYWxzZSwKKwkJCQkJCQkJbW9k
ZV9saWItPnZiYS5PdXRwdXRba10sCisJCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0
W2tdLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9uZW50W2tdKTsK
KwkJCQkJCW1vZGVfbGliLT52YmEuT3V0YnBwRFNDID0gVHJ1bmNUb1ZhbGlkQlBQKAorCQkJCQkJ
CQkoMS4wIC0gbW9kZV9saWItPnZiYS5Eb3duc3ByZWFkaW5nIC8gMTAwLjApICogKDEuMCAtIG1v
ZGVfbGliLT52YmEuRWZmZWN0aXZlRkVDT3ZlcmhlYWQgLyAxMDAuMCkgKiAyNzAuMAorCQkJCQkJ
CQkqIG1vZGVfbGliLT52YmEuT3V0cHV0TGlua0RQTGFuZXNba10gLyBtb2RlX2xpYi0+dmJhLlBp
eGVsQ2xvY2tCYWNrRW5kW2tdICogOC4wLAorCQkJCQkJCQl0cnVlLAorCQkJCQkJCQltb2RlX2xp
Yi0+dmJhLk91dHB1dFtrXSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRba10s
CisJCQkJCQkJCW1vZGVfbGliLT52YmEuRFNDSW5wdXRCaXRQZXJDb21wb25lbnRba10pOworCQkJ
CQkJaWYgKG1vZGVfbGliLT52YmEuRFNDRW5hYmxlZFtrXSA9PSB0cnVlKSB7CisJCQkJCQkJbG9j
YWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9IHRydWU7CisJCQkJCQkJaWYgKG1vZGVfbGliLT52YmEu
T3V0cHV0W2tdID09IGRtX2RwKSB7CisJCQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNGRUNbaV1ba10g
PSB0cnVlOworCQkJCQkJCX0gZWxzZSB7CisJCQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNGRUNbaV1b
a10gPSBmYWxzZTsKKwkJCQkJCQl9CisJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRicHAgPSBtb2Rl
X2xpYi0+dmJhLk91dGJwcERTQzsKKwkJCQkJCX0gZWxzZSB7CisJCQkJCQkJbG9jYWxzLT5SZXF1
aXJlc0RTQ1tpXVtrXSA9IGZhbHNlOworCQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNGRUNbaV1ba10g
PSBmYWxzZTsKKwkJCQkJCX0KKwkJCQkJCWxvY2Fscy0+T3V0cHV0QnBwUGVyU3RhdGVbaV1ba10g
PSBtb2RlX2xpYi0+dmJhLk91dGJwcDsKKwkJCQkJfQorCQkJCQlpZiAobW9kZV9saWItPnZiYS5P
dXRicHAgPT0gQlBQX0lOVkFMSUQgJiYgbW9kZV9saWItPnZiYS5QSFlDTEtQZXJTdGF0ZVtpXSA+
PSA1NDAuMCkgeworCQkJCQkJbW9kZV9saWItPnZiYS5PdXRicHAgPSBUcnVuY1RvVmFsaWRCUFAo
CisJCQkJCQkJCSgxLjAgLSBtb2RlX2xpYi0+dmJhLkRvd25zcHJlYWRpbmcgLyAxMDAuMCkgKiA1
NDAuMAorCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuT3V0cHV0TGlua0RQTGFuZXNba10gLyBtb2Rl
X2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNrRW5kW2tdICogOC4wLAorCQkJCQkJCQkJZmFsc2UsCisJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dFtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEu
T3V0cHV0Rm9ybWF0W2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5EU0NJbnB1dEJpdFBlckNv
bXBvbmVudFtrXSk7CisJCQkJCQltb2RlX2xpYi0+dmJhLk91dGJwcERTQyA9IFRydW5jVG9WYWxp
ZEJQUCgKKwkJCQkJCQkJKDEuMCAtIG1vZGVfbGliLT52YmEuRG93bnNwcmVhZGluZyAvIDEwMC4w
KSAqICgxLjAgLSBtb2RlX2xpYi0+dmJhLkVmZmVjdGl2ZUZFQ092ZXJoZWFkIC8gMTAwLjApICog
NTQwLjAKKwkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLk91dHB1dExpbmtEUExhbmVzW2tdIC8gbW9k
ZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtrXSAqIDguMCwKKwkJCQkJCQkJdHJ1ZSwKKwkJ
CQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRba10sCisJCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0
cHV0Rm9ybWF0W2tdLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9u
ZW50W2tdKTsKKwkJCQkJCWlmIChtb2RlX2xpYi0+dmJhLkRTQ0VuYWJsZWRba10gPT0gdHJ1ZSkg
eworCQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNEU0NbaV1ba10gPSB0cnVlOworCQkJCQkJCWlmICht
b2RlX2xpYi0+dmJhLk91dHB1dFtrXSA9PSBkbV9kcCkgeworCQkJCQkJCQlsb2NhbHMtPlJlcXVp
cmVzRkVDW2ldW2tdID0gdHJ1ZTsKKwkJCQkJCQl9IGVsc2UgeworCQkJCQkJCQlsb2NhbHMtPlJl
cXVpcmVzRkVDW2ldW2tdID0gZmFsc2U7CisJCQkJCQkJfQorCQkJCQkJCW1vZGVfbGliLT52YmEu
T3V0YnBwID0gbW9kZV9saWItPnZiYS5PdXRicHBEU0M7CisJCQkJCQl9IGVsc2UgeworCQkJCQkJ
CWxvY2Fscy0+UmVxdWlyZXNEU0NbaV1ba10gPSBmYWxzZTsKKwkJCQkJCQlsb2NhbHMtPlJlcXVp
cmVzRkVDW2ldW2tdID0gZmFsc2U7CisJCQkJCQl9CisJCQkJCQlsb2NhbHMtPk91dHB1dEJwcFBl
clN0YXRlW2ldW2tdID0gbW9kZV9saWItPnZiYS5PdXRicHA7CisJCQkJCX0KKwkJCQkJaWYgKG1v
ZGVfbGliLT52YmEuT3V0YnBwID09IEJQUF9JTlZBTElECisJCQkJCQkJJiYgbW9kZV9saWItPnZi
YS5QSFlDTEtQZXJTdGF0ZVtpXQorCQkJCQkJCQkJPj0gODEwLjApIHsKKwkJCQkJCW1vZGVfbGli
LT52YmEuT3V0YnBwID0gVHJ1bmNUb1ZhbGlkQlBQKAorCQkJCQkJCQkoMS4wIC0gbW9kZV9saWIt
PnZiYS5Eb3duc3ByZWFkaW5nIC8gMTAwLjApICogODEwLjAKKwkJCQkJCQkJKiBtb2RlX2xpYi0+
dmJhLk91dHB1dExpbmtEUExhbmVzW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0Vu
ZFtrXSAqIDguMCwKKwkJCQkJCQkJZmFsc2UsCisJCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0cHV0
W2tdLAorCQkJCQkJCQltb2RlX2xpYi0+dmJhLk91dHB1dEZvcm1hdFtrXSwKKwkJCQkJCQkJbW9k
ZV9saWItPnZiYS5EU0NJbnB1dEJpdFBlckNvbXBvbmVudFtrXSk7CisJCQkJCQltb2RlX2xpYi0+
dmJhLk91dGJwcERTQyA9IFRydW5jVG9WYWxpZEJQUCgKKwkJCQkJCQkJKDEuMCAtIG1vZGVfbGli
LT52YmEuRG93bnNwcmVhZGluZyAvIDEwMC4wKSAqICgxLjAgLSBtb2RlX2xpYi0+dmJhLkVmZmVj
dGl2ZUZFQ092ZXJoZWFkIC8gMTAwLjApICogODEwLjAKKwkJCQkJCQkJKiBtb2RlX2xpYi0+dmJh
Lk91dHB1dExpbmtEUExhbmVzW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtr
XSAqIDguMCwKKwkJCQkJCQkJdHJ1ZSwKKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRba10s
CisJCQkJCQkJCW1vZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0W2tdLAorCQkJCQkJCQltb2RlX2xp
Yi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9uZW50W2tdKTsKKwkJCQkJCWlmIChtb2RlX2xpYi0+
dmJhLkRTQ0VuYWJsZWRba10gPT0gdHJ1ZSB8fCBtb2RlX2xpYi0+dmJhLk91dGJwcCA9PSBCUFBf
SU5WQUxJRCkgeworCQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNEU0NbaV1ba10gPSB0cnVlOworCQkJ
CQkJCWlmIChtb2RlX2xpYi0+dmJhLk91dHB1dFtrXSA9PSBkbV9kcCkgeworCQkJCQkJCQlsb2Nh
bHMtPlJlcXVpcmVzRkVDW2ldW2tdID0gdHJ1ZTsKKwkJCQkJCQl9IGVsc2UgeworCQkJCQkJCQls
b2NhbHMtPlJlcXVpcmVzRkVDW2ldW2tdID0gZmFsc2U7CisJCQkJCQkJfQorCQkJCQkJCW1vZGVf
bGliLT52YmEuT3V0YnBwID0gbW9kZV9saWItPnZiYS5PdXRicHBEU0M7CisJCQkJCQl9IGVsc2Ug
eworCQkJCQkJCWxvY2Fscy0+UmVxdWlyZXNEU0NbaV1ba10gPSBmYWxzZTsKKwkJCQkJCQlsb2Nh
bHMtPlJlcXVpcmVzRkVDW2ldW2tdID0gZmFsc2U7CisJCQkJCQl9CisJCQkJCQlsb2NhbHMtPk91
dHB1dEJwcFBlclN0YXRlW2ldW2tdID0KKwkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRicHA7CisJ
CQkJCX0KKwkJCQl9CisJCQl9IGVsc2UgeworCQkJCWxvY2Fscy0+T3V0cHV0QnBwUGVyU3RhdGVb
aV1ba10gPSBCUFBfQkxFTkRFRF9QSVBFOworCQkJfQorCQl9CisJfQorCWZvciAoaSA9IDA7IGkg
PD0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJCWxvY2Fscy0+RElPU3Vw
cG9ydFtpXSA9IHRydWU7CisJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJP
ZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJaWYgKGxvY2Fscy0+T3V0cHV0QnBwUGVyU3Rh
dGVbaV1ba10gPT0gQlBQX0lOVkFMSUQKKwkJCQkJfHwgKG1vZGVfbGliLT52YmEuT3V0cHV0Rm9y
bWF0W2tdID09IGRtXzQyMAorCQkJCQkJCSYmIG1vZGVfbGliLT52YmEuSW50ZXJsYWNlW2tdID09
IHRydWUKKwkJCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlByb2dyZXNzaXZlVG9JbnRlcmxhY2VVbml0
SW5PUFAgPT0gdHJ1ZSkpIHsKKwkJCQlsb2NhbHMtPkRJT1N1cHBvcnRbaV0gPSBmYWxzZTsKKwkJ
CX0KKwkJfQorCX0KKwlmb3IgKGkgPSAwOyBpIDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0
ZXM7IGkrKykgeworCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3Rp
dmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCWxvY2Fscy0+RFNDQ0xLUmVxdWlyZWRNb3JlVGhhblN1
cHBvcnRlZFtpXSA9IGZhbHNlOworCQkJaWYgKG1vZGVfbGliLT52YmEuQmxlbmRpbmdBbmRUaW1p
bmdba10gPT0gaykgeworCQkJCWlmICgobW9kZV9saWItPnZiYS5PdXRwdXRba10gPT0gZG1fZHAK
KwkJCQkJCXx8IG1vZGVfbGliLT52YmEuT3V0cHV0W2tdID09IGRtX2VkcCkpIHsKKwkJCQkJaWYg
KG1vZGVfbGliLT52YmEuT3V0cHV0Rm9ybWF0W2tdID09IGRtXzQyMAorCQkJCQkJCXx8IG1vZGVf
bGliLT52YmEuT3V0cHV0Rm9ybWF0W2tdCisJCQkJCQkJCQk9PSBkbV9uNDIyKSB7CisJCQkJCQlt
b2RlX2xpYi0+dmJhLkRTQ0Zvcm1hdEZhY3RvciA9IDI7CisJCQkJCX0gZWxzZSB7CisJCQkJCQlt
b2RlX2xpYi0+dmJhLkRTQ0Zvcm1hdEZhY3RvciA9IDE7CisJCQkJCX0KKwkJCQkJaWYgKGxvY2Fs
cy0+UmVxdWlyZXNEU0NbaV1ba10gPT0gdHJ1ZSkgeworCQkJCQkJaWYgKGxvY2Fscy0+T0RNQ29t
YmluZUVuYWJsZVBlclN0YXRlW2ldW2tdCisJCQkJCQkJCT09IHRydWUpIHsKKwkJCQkJCQlpZiAo
bW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtrXSAvIDYuMCAvIG1vZGVfbGliLT52YmEu
RFNDRm9ybWF0RmFjdG9yCisJCQkJCQkJCQk+ICgxLjAgLSBtb2RlX2xpYi0+dmJhLkRJU1BDTEtE
UFBDTEtEU0NDTEtEb3duU3ByZWFkaW5nIC8gMTAwLjApICogbW9kZV9saWItPnZiYS5NYXhEU0ND
TEtbaV0pIHsKKwkJCQkJCQkJbG9jYWxzLT5EU0NDTEtSZXF1aXJlZE1vcmVUaGFuU3VwcG9ydGVk
W2ldID0KKwkJCQkJCQkJCQl0cnVlOworCQkJCQkJCX0KKwkJCQkJCX0gZWxzZSB7CisJCQkJCQkJ
aWYgKG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja0JhY2tFbmRba10gLyAzLjAgLyBtb2RlX2xpYi0+
dmJhLkRTQ0Zvcm1hdEZhY3RvcgorCQkJCQkJCQkJPiAoMS4wIC0gbW9kZV9saWItPnZiYS5ESVNQ
Q0xLRFBQQ0xLRFNDQ0xLRG93blNwcmVhZGluZyAvIDEwMC4wKSAqIG1vZGVfbGliLT52YmEuTWF4
RFNDQ0xLW2ldKSB7CisJCQkJCQkJCWxvY2Fscy0+RFNDQ0xLUmVxdWlyZWRNb3JlVGhhblN1cHBv
cnRlZFtpXSA9CisJCQkJCQkJCQkJdHJ1ZTsKKwkJCQkJCQl9CisJCQkJCQl9CisJCQkJCX0KKwkJ
CQl9CisJCQl9CisJCX0KKwl9CisJZm9yIChpID0gMDsgaSA8PSBtb2RlX2xpYi0+dmJhLnNvYy5u
dW1fc3RhdGVzOyBpKyspIHsKKwkJbG9jYWxzLT5Ob3RFbm91Z2hEU0NVbml0c1tpXSA9IGZhbHNl
OworCQltb2RlX2xpYi0+dmJhLlRvdGFsRFNDVW5pdHNSZXF1aXJlZCA9IDAuMDsKKwkJZm9yIChr
ID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7
CisJCQlpZiAobG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9PSB0cnVlKSB7CisJCQkJaWYgKGxv
Y2Fscy0+T0RNQ29tYmluZUVuYWJsZVBlclN0YXRlW2ldW2tdID09IHRydWUpIHsKKwkJCQkJbW9k
ZV9saWItPnZiYS5Ub3RhbERTQ1VuaXRzUmVxdWlyZWQgPQorCQkJCQkJCW1vZGVfbGliLT52YmEu
VG90YWxEU0NVbml0c1JlcXVpcmVkICsgMi4wOworCQkJCX0gZWxzZSB7CisJCQkJCW1vZGVfbGli
LT52YmEuVG90YWxEU0NVbml0c1JlcXVpcmVkID0KKwkJCQkJCQltb2RlX2xpYi0+dmJhLlRvdGFs
RFNDVW5pdHNSZXF1aXJlZCArIDEuMDsKKwkJCQl9CisJCQl9CisJCX0KKwkJaWYgKG1vZGVfbGli
LT52YmEuVG90YWxEU0NVbml0c1JlcXVpcmVkID4gbW9kZV9saWItPnZiYS5OdW1iZXJPZkRTQykg
eworCQkJbG9jYWxzLT5Ob3RFbm91Z2hEU0NVbml0c1tpXSA9IHRydWU7CisJCX0KKwl9CisJLypE
U0MgRGVsYXkgcGVyIHN0YXRlKi8KKworCWZvciAoaSA9IDA7IGkgPD0gbW9kZV9saWItPnZiYS5z
b2MubnVtX3N0YXRlczsgaSsrKSB7CisJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5O
dW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJaWYgKG1vZGVfbGliLT52YmEuQmxl
bmRpbmdBbmRUaW1pbmdba10gIT0gaykgeworCQkJCW1vZGVfbGliLT52YmEuc2xpY2VzID0gMDsK
KwkJCX0gZWxzZSBpZiAobG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVtrXSA9PSAwCisJCQkJCXx8IGxv
Y2Fscy0+UmVxdWlyZXNEU0NbaV1ba10gPT0gZmFsc2UpIHsKKwkJCQltb2RlX2xpYi0+dmJhLnNs
aWNlcyA9IDA7CisJCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja0JhY2tFbmRb
a10gPiAzMjAwLjApIHsKKwkJCQltb2RlX2xpYi0+dmJhLnNsaWNlcyA9IGRtbF9jZWlsKAorCQkJ
CQkJbW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtrXSAvIDQwMC4wLAorCQkJCQkJNC4w
KTsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtrXSA+IDEz
NjAuMCkgeworCQkJCW1vZGVfbGliLT52YmEuc2xpY2VzID0gOC4wOworCQkJfSBlbHNlIGlmICht
b2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tCYWNrRW5kW2tdID4gNjgwLjApIHsKKwkJCQltb2RlX2xp
Yi0+dmJhLnNsaWNlcyA9IDQuMDsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5QaXhlbENs
b2NrQmFja0VuZFtrXSA+IDM0MC4wKSB7CisJCQkJbW9kZV9saWItPnZiYS5zbGljZXMgPSAyLjA7
CisJCQl9IGVsc2UgeworCQkJCW1vZGVfbGliLT52YmEuc2xpY2VzID0gMS4wOworCQkJfQorCQkJ
aWYgKGxvY2Fscy0+T3V0cHV0QnBwUGVyU3RhdGVbaV1ba10gPT0gQlBQX0JMRU5ERURfUElQRQor
CQkJCQl8fCBsb2NhbHMtPk91dHB1dEJwcFBlclN0YXRlW2ldW2tdID09IEJQUF9JTlZBTElEKSB7
CisJCQkJbW9kZV9saWItPnZiYS5icHAgPSAwLjA7CisJCQl9IGVsc2UgeworCQkJCW1vZGVfbGli
LT52YmEuYnBwID0gbG9jYWxzLT5PdXRwdXRCcHBQZXJTdGF0ZVtpXVtrXTsKKwkJCX0KKwkJCWlm
IChsb2NhbHMtPlJlcXVpcmVzRFNDW2ldW2tdID09IHRydWUgJiYgbW9kZV9saWItPnZiYS5icHAg
IT0gMC4wKSB7CisJCQkJaWYgKGxvY2Fscy0+T0RNQ29tYmluZUVuYWJsZVBlclN0YXRlW2ldW2td
ID09IGZhbHNlKSB7CisJCQkJCWxvY2Fscy0+RFNDRGVsYXlQZXJTdGF0ZVtpXVtrXSA9CisJCQkJ
CQkJZHNjY2VDb21wdXRlRGVsYXkoCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0
UGVyQ29tcG9uZW50W2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5icHAsCisJCQkJCQkJCQlk
bWxfY2VpbCgKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5IQWN0aXZlW2tdCisJCQkJCQkJCQkJ
CQkJLyBtb2RlX2xpYi0+dmJhLnNsaWNlcywKKwkJCQkJCQkJCQkJMS4wKSwKKwkJCQkJCQkJCW1v
ZGVfbGliLT52YmEuc2xpY2VzLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3JtYXRb
a10pCisJCQkJCQkJCQkrIGRzY0NvbXB1dGVEZWxheSgKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5PdXRwdXRGb3JtYXRba10pOworCQkJCX0gZWxzZSB7CisJCQkJCWxvY2Fscy0+RFNDRGVsYXlQ
ZXJTdGF0ZVtpXVtrXSA9CisJCQkJCQkJMi4wICogKGRzY2NlQ29tcHV0ZURlbGF5KAorCQkJCQkJ
CQkJCQltb2RlX2xpYi0+dmJhLkRTQ0lucHV0Qml0UGVyQ29tcG9uZW50W2tdLAorCQkJCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLmJwcCwKKwkJCQkJCQkJCQkJZG1sX2NlaWwobW9kZV9saWItPnZiYS5I
QWN0aXZlW2tdIC8gbW9kZV9saWItPnZiYS5zbGljZXMsIDEuMCksCisJCQkJCQkJCQkJCW1vZGVf
bGliLT52YmEuc2xpY2VzIC8gMiwKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5PdXRwdXRGb3Jt
YXRba10pCisJCQkJCQkJCQkrIGRzY0NvbXB1dGVEZWxheShtb2RlX2xpYi0+dmJhLk91dHB1dEZv
cm1hdFtrXSkpOworCQkJCX0KKwkJCQlsb2NhbHMtPkRTQ0RlbGF5UGVyU3RhdGVbaV1ba10gPQor
CQkJCQkJbG9jYWxzLT5EU0NEZWxheVBlclN0YXRlW2ldW2tdICogbW9kZV9saWItPnZiYS5QaXhl
bENsb2NrW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrQmFja0VuZFtrXTsKKwkJCX0gZWxz
ZSB7CisJCQkJbG9jYWxzLT5EU0NEZWxheVBlclN0YXRlW2ldW2tdID0gMC4wOworCQkJfQorCQl9
CisJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAt
IDE7IGsrKykgeworCQkJZm9yIChtID0gMDsgbSA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0
aXZlUGxhbmVzIC0gMTsgbSsrKSB7CisJCQkJZm9yIChqID0gMDsgaiA8PSBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaisrKSB7CisJCQkJCWlmIChtb2RlX2xpYi0+dmJh
LkJsZW5kaW5nQW5kVGltaW5nW2tdID09IG0gJiYgbG9jYWxzLT5SZXF1aXJlc0RTQ1tpXVttXSA9
PSB0cnVlKQorCQkJCQkJbG9jYWxzLT5EU0NEZWxheVBlclN0YXRlW2ldW2tdID0gbG9jYWxzLT5E
U0NEZWxheVBlclN0YXRlW2ldW21dOworCQkJCX0KKwkJCX0KKwkJfQorCX0KKworCS8vUHJlZmV0
Y2ggQ2hlY2sKKwlmb3IgKGkgPSAwOyBpIDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7
IGkrKykgeworCQlmb3IgKGogPSAwOyBqIDwgMjsgaisrKSB7CisJCQlmb3IgKGsgPSAwOyBrIDw9
IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQlpZiAo
bG9jYWxzLT5PRE1Db21iaW5lRW5hYmxlUGVyU3RhdGVbaV1ba10gPT0gdHJ1ZSkKKwkJCQkJbG9j
YWxzLT5Td2F0aFdpZHRoWVBlclN0YXRlW2ldW2pdW2tdID0gZG1sX21pbihsb2NhbHMtPlN3YXRo
V2lkdGhZU2luZ2xlRFBQW2tdLCBkbWxfcm91bmQobG9jYWxzLT5IQWN0aXZlW2tdIC8gMiAqIGxv
Y2Fscy0+SFJhdGlvW2tdKSk7CisJCQkJZWxzZQorCQkJCQlsb2NhbHMtPlN3YXRoV2lkdGhZUGVy
U3RhdGVbaV1bal1ba10gPSBsb2NhbHMtPlN3YXRoV2lkdGhZU2luZ2xlRFBQW2tdIC8gbG9jYWxz
LT5Ob09mRFBQW2ldW2pdW2tdOworCQkJCWxvY2Fscy0+U3dhdGhXaWR0aEdyYW51bGFyaXR5WSA9
IDI1NiAgLyBkbWxfY2VpbChsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSwgMSkgLyBsb2Nh
bHMtPk1heFN3YXRoSGVpZ2h0WVtrXTsKKwkJCQlsb2NhbHMtPlJvdW5kZWRVcE1heFN3YXRoU2l6
ZUJ5dGVzWSA9IChkbWxfY2VpbChsb2NhbHMtPlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba10g
LSAxLCBsb2NhbHMtPlN3YXRoV2lkdGhHcmFudWxhcml0eVkpCisJCQkJCQkrIGxvY2Fscy0+U3dh
dGhXaWR0aEdyYW51bGFyaXR5WSkgKiBsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSAqIGxv
Y2Fscy0+TWF4U3dhdGhIZWlnaHRZW2tdOworCQkJCWlmIChsb2NhbHMtPlNvdXJjZVBpeGVsRm9y
bWF0W2tdID09IGRtXzQyMF8xMCkgeworCQkJCQlsb2NhbHMtPlJvdW5kZWRVcE1heFN3YXRoU2l6
ZUJ5dGVzWSA9IGRtbF9jZWlsKGxvY2Fscy0+Um91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNZLCAy
NTYpICsgMjU2OworCQkJCX0KKwkJCQlpZiAobG9jYWxzLT5NYXhTd2F0aEhlaWdodENba10gPiAw
KSB7CisJCQkJCWxvY2Fscy0+U3dhdGhXaWR0aEdyYW51bGFyaXR5QyA9IDI1NiAvIGRtbF9jZWls
KGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRDW2tdLCAyKSAvIGxvY2Fscy0+TWF4U3dhdGhIZWln
aHRDW2tdOworCisJCQkJCWxvY2Fscy0+Um91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNDID0gKGRt
bF9jZWlsKGxvY2Fscy0+U3dhdGhXaWR0aFlQZXJTdGF0ZVtpXVtqXVtrXSAvIDIgLSAxLCBsb2Nh
bHMtPlN3YXRoV2lkdGhHcmFudWxhcml0eUMpCisJCQkJCSsgbG9jYWxzLT5Td2F0aFdpZHRoR3Jh
bnVsYXJpdHlDKSAqIGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRDW2tdICogbG9jYWxzLT5NYXhT
d2F0aEhlaWdodENba107CisJCQkJfQorCQkJCWlmIChsb2NhbHMtPlNvdXJjZVBpeGVsRm9ybWF0
W2tdID09IGRtXzQyMF8xMCkgeworCQkJCQlsb2NhbHMtPlJvdW5kZWRVcE1heFN3YXRoU2l6ZUJ5
dGVzQyA9IGRtbF9jZWlsKGxvY2Fscy0+Um91bmRlZFVwTWF4U3dhdGhTaXplQnl0ZXNDLCAyNTYp
ICArIDI1NjsKKwkJCQl9IGVsc2UgeworCQkJCQlsb2NhbHMtPlJvdW5kZWRVcE1heFN3YXRoU2l6
ZUJ5dGVzQyA9IDA7CisJCQkJfQorCisJCQkJaWYgKGxvY2Fscy0+Um91bmRlZFVwTWF4U3dhdGhT
aXplQnl0ZXNZICsgbG9jYWxzLT5Sb3VuZGVkVXBNYXhTd2F0aFNpemVCeXRlc0MgPD0gbG9jYWxz
LT5ERVRCdWZmZXJTaXplSW5LQnl0ZSAqIDEwMjQgLyAyKSB7CisJCQkJCWxvY2Fscy0+U3dhdGhI
ZWlnaHRZUGVyU3RhdGVbaV1bal1ba10gPSBsb2NhbHMtPk1heFN3YXRoSGVpZ2h0WVtrXTsKKwkJ
CQkJbG9jYWxzLT5Td2F0aEhlaWdodENQZXJTdGF0ZVtpXVtqXVtrXSA9IGxvY2Fscy0+TWF4U3dh
dGhIZWlnaHRDW2tdOworCQkJCX0gZWxzZSB7CisJCQkJCWxvY2Fscy0+U3dhdGhIZWlnaHRZUGVy
U3RhdGVbaV1bal1ba10gPSBsb2NhbHMtPk1pblN3YXRoSGVpZ2h0WVtrXTsKKwkJCQkJbG9jYWxz
LT5Td2F0aEhlaWdodENQZXJTdGF0ZVtpXVtqXVtrXSA9IGxvY2Fscy0+TWluU3dhdGhIZWlnaHRD
W2tdOworCQkJCX0KKworCQkJCWlmIChsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSA9PSAw
KSB7CisJCQkJCWxvY2Fscy0+TGluZXNJbkRFVEx1bWEgPSBsb2NhbHMtPkRFVEJ1ZmZlclNpemVJ
bktCeXRlICogMTAyNCAvIGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdIC8gbG9jYWxzLT5T
d2F0aFdpZHRoWVBlclN0YXRlW2ldW2pdW2tdOworCQkJCQlsb2NhbHMtPkxpbmVzSW5ERVRDaHJv
bWEgPSAwOworCQkJCX0gZWxzZSBpZiAobG9jYWxzLT5Td2F0aEhlaWdodFlQZXJTdGF0ZVtpXVtq
XVtrXSA8PSBsb2NhbHMtPlN3YXRoSGVpZ2h0Q1BlclN0YXRlW2ldW2pdW2tdKSB7CisJCQkJCWxv
Y2Fscy0+TGluZXNJbkRFVEx1bWEgPSBsb2NhbHMtPkRFVEJ1ZmZlclNpemVJbktCeXRlICogMTAy
NCAvIDIgLyBsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSAvCisJCQkJCQkJbG9jYWxzLT5T
d2F0aFdpZHRoWVBlclN0YXRlW2ldW2pdW2tdOworCQkJCQlsb2NhbHMtPkxpbmVzSW5ERVRDaHJv
bWEgPSBsb2NhbHMtPkRFVEJ1ZmZlclNpemVJbktCeXRlICogMTAyNCAvIDIgLyBsb2NhbHMtPkJ5
dGVQZXJQaXhlbEluREVUQ1trXSAvIChsb2NhbHMtPlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1b
a10gLyAyKTsKKwkJCQl9IGVsc2UgeworCQkJCQlsb2NhbHMtPkxpbmVzSW5ERVRMdW1hID0gbG9j
YWxzLT5ERVRCdWZmZXJTaXplSW5LQnl0ZSAqIDEwMjQgKiAyIC8gMyAvIGxvY2Fscy0+Qnl0ZVBl
clBpeGVsSW5ERVRZW2tdIC8gbG9jYWxzLT5Td2F0aFdpZHRoWVBlclN0YXRlW2ldW2pdW2tdOwor
CQkJCQlsb2NhbHMtPkxpbmVzSW5ERVRDaHJvbWEgPSBsb2NhbHMtPkRFVEJ1ZmZlclNpemVJbktC
eXRlICogMTAyNCAvIDMgLyBsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSAvIChsb2NhbHMt
PlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba10gLyAyKTsKKwkJCQl9CisKKwkJCQlsb2NhbHMt
PkVmZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ1NvdXJjZUxpbmVzTHVtYSA9IGRtbF9taW4obG9jYWxz
LT5NYXhMaW5lQnVmZmVyTGluZXMsCisJCQkJCWRtbF9mbG9vcihsb2NhbHMtPkxpbmVCdWZmZXJT
aXplIC8gbG9jYWxzLT5MQkJpdFBlclBpeGVsW2tdIC8gKGxvY2Fscy0+U3dhdGhXaWR0aFlQZXJT
dGF0ZVtpXVtqXVtrXQorCQkJCQkvIGRtbF9tYXgobG9jYWxzLT5IUmF0aW9ba10sIDEpKSwgMSkp
IC0gKGxvY2Fscy0+dnRhcHNba10gLSAxKTsKKworCQkJCWxvY2Fscy0+RWZmZWN0aXZlTEJMYXRl
bmN5SGlkaW5nU291cmNlTGluZXNDaHJvbWEgPSAgZG1sX21pbihsb2NhbHMtPk1heExpbmVCdWZm
ZXJMaW5lcywKKwkJCQkJCWRtbF9mbG9vcihsb2NhbHMtPkxpbmVCdWZmZXJTaXplIC8gbG9jYWxz
LT5MQkJpdFBlclBpeGVsW2tdCisJCQkJCQkvIChsb2NhbHMtPlN3YXRoV2lkdGhZUGVyU3RhdGVb
aV1bal1ba10gLyAyCisJCQkJCQkvIGRtbF9tYXgobG9jYWxzLT5IUmF0aW9ba10gLyAyLCAxKSks
IDEpKSAtIChsb2NhbHMtPlZUQVBzQ2hyb21hW2tdIC0gMSk7CisKKwkJCQlsb2NhbHMtPkVmZmVj
dGl2ZURFVExCTGluZXNMdW1hID0gZG1sX2Zsb29yKGxvY2Fscy0+TGluZXNJbkRFVEx1bWEgKyAg
ZG1sX21pbigKKwkJCQkJCWxvY2Fscy0+TGluZXNJbkRFVEx1bWEgKiBsb2NhbHMtPlJlcXVpcmVk
RElTUENMS1tpXVtqXSAqIGxvY2Fscy0+Qnl0ZVBlclBpeGVsSW5ERVRZW2tdICoKKwkJCQkJCWxv
Y2Fscy0+UFNDTF9GQUNUT1Jba10gLyBsb2NhbHMtPlJldHVybkJXUGVyU3RhdGVbaV0sCisJCQkJ
CQlsb2NhbHMtPkVmZmVjdGl2ZUxCTGF0ZW5jeUhpZGluZ1NvdXJjZUxpbmVzTHVtYSksCisJCQkJ
CQlsb2NhbHMtPlN3YXRoSGVpZ2h0WVBlclN0YXRlW2ldW2pdW2tdKTsKKworCQkJCWxvY2Fscy0+
RWZmZWN0aXZlREVUTEJMaW5lc0Nocm9tYSA9IGRtbF9mbG9vcihsb2NhbHMtPkxpbmVzSW5ERVRD
aHJvbWEgKyBkbWxfbWluKAorCQkJCQkJbG9jYWxzLT5MaW5lc0luREVUQ2hyb21hICogbG9jYWxz
LT5SZXF1aXJlZERJU1BDTEtbaV1bal0gKiBsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1trXSAq
CisJCQkJCQlsb2NhbHMtPlBTQ0xfRkFDVE9SX0NIUk9NQVtrXSAvIGxvY2Fscy0+UmV0dXJuQldQ
ZXJTdGF0ZVtpXSwKKwkJCQkJCWxvY2Fscy0+RWZmZWN0aXZlTEJMYXRlbmN5SGlkaW5nU291cmNl
TGluZXNDaHJvbWEpLAorCQkJCQkJbG9jYWxzLT5Td2F0aEhlaWdodENQZXJTdGF0ZVtpXVtqXVtr
XSk7CisKKwkJCQlpZiAobG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVENba10gPT0gMCkgeworCQkJ
CQlsb2NhbHMtPlVyZ2VudExhdGVuY3lTdXBwb3J0VXNQZXJTdGF0ZVtpXVtqXVtrXSA9IGxvY2Fs
cy0+RWZmZWN0aXZlREVUTEJMaW5lc0x1bWEgKiAobG9jYWxzLT5IVG90YWxba10gLyBsb2NhbHMt
PlBpeGVsQ2xvY2tba10pCisJCQkJCQkJLyBsb2NhbHMtPlZSYXRpb1trXSAtIGxvY2Fscy0+RWZm
ZWN0aXZlREVUTEJMaW5lc0x1bWEgKiBsb2NhbHMtPlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1b
a10gKgorCQkJCQkJCQlkbWxfY2VpbChsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUWVtrXSwgMSkg
LyAobG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldIC8gbG9jYWxzLT5Ob09mRFBQW2ldW2pdW2td
KTsKKwkJCQl9IGVsc2UgeworCQkJCQlsb2NhbHMtPlVyZ2VudExhdGVuY3lTdXBwb3J0VXNQZXJT
dGF0ZVtpXVtqXVtrXSA9IGRtbF9taW4oCisJCQkJCQlsb2NhbHMtPkVmZmVjdGl2ZURFVExCTGlu
ZXNMdW1hICogKGxvY2Fscy0+SFRvdGFsW2tdIC8gbG9jYWxzLT5QaXhlbENsb2NrW2tdKQorCQkJ
CQkJLyBsb2NhbHMtPlZSYXRpb1trXSAtIGxvY2Fscy0+RWZmZWN0aXZlREVUTEJMaW5lc0x1bWEg
KiBsb2NhbHMtPlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba10gKgorCQkJCQkJZG1sX2NlaWwo
bG9jYWxzLT5CeXRlUGVyUGl4ZWxJbkRFVFlba10sIDEpIC8gKGxvY2Fscy0+UmV0dXJuQldQZXJT
dGF0ZVtpXSAvIGxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXSksCisJCQkJCQkJbG9jYWxzLT5FZmZl
Y3RpdmVERVRMQkxpbmVzQ2hyb21hICogKGxvY2Fscy0+SFRvdGFsW2tdIC8gbG9jYWxzLT5QaXhl
bENsb2NrW2tdKSAvIChsb2NhbHMtPlZSYXRpb1trXSAvIDIpIC0KKwkJCQkJCQlsb2NhbHMtPkVm
ZmVjdGl2ZURFVExCTGluZXNDaHJvbWEgKiBsb2NhbHMtPlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1b
al1ba10gLyAyICoKKwkJCQkJCQlkbWxfY2VpbChsb2NhbHMtPkJ5dGVQZXJQaXhlbEluREVUQ1tr
XSwgMikgLyAobG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldIC8gbG9jYWxzLT5Ob09mRFBQW2ld
W2pdW2tdKSk7CisJCQkJfQorCQkJfQorCQl9CisJfQorCisJZm9yIChpID0gMDsgaSA8PSBsb2Nh
bHMtPnNvYy5udW1fc3RhdGVzOyBpKyspIHsKKwkJZm9yIChqID0gMDsgaiA8IDI7IGorKykgewor
CQkJbG9jYWxzLT5VcmdlbnRMYXRlbmN5U3VwcG9ydFtpXVtqXSA9IHRydWU7CisJCQlmb3IgKGsg
PSAwOyBrIDwgbG9jYWxzLT5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgaysrKSB7CisJCQkJaWYgKGxv
Y2Fscy0+VXJnZW50TGF0ZW5jeVN1cHBvcnRVc1BlclN0YXRlW2ldW2pdW2tdIDwgbG9jYWxzLT5V
cmdlbnRMYXRlbmN5KQorCQkJCQlsb2NhbHMtPlVyZ2VudExhdGVuY3lTdXBwb3J0W2ldW2pdID0g
ZmFsc2U7CisJCQl9CisJCX0KKwl9CisKKworCS8qUHJlZmV0Y2ggQ2hlY2sqLworCWZvciAoaSA9
IDA7IGkgPD0gbG9jYWxzLT5zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJCWZvciAoaiA9IDA7IGog
PCAyOyBqKyspIHsKKwkJCWxvY2Fscy0+VG90YWxOdW1iZXJPZkRDQ0FjdGl2ZURQUFtpXVtqXSA9
IDA7CisJCQlmb3IgKGsgPSAwOyBrIDwgbG9jYWxzLT5OdW1iZXJPZkFjdGl2ZVBsYW5lczsgaysr
KSB7CisJCQkJaWYgKGxvY2Fscy0+RENDRW5hYmxlW2tdID09IHRydWUpIHsKKwkJCQkJbG9jYWxz
LT5Ub3RhbE51bWJlck9mRENDQWN0aXZlRFBQW2ldW2pdID0KKwkJCQkJCWxvY2Fscy0+VG90YWxO
dW1iZXJPZkRDQ0FjdGl2ZURQUFtpXVtqXSArIGxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXTsKKwkJ
CQl9CisJCQl9CisJCX0KKwl9CisKKwlDYWxjdWxhdGVNaW5BbmRNYXhQcmVmZXRjaE1vZGUobG9j
YWxzLT5BbGxvd0RSQU1TZWxmUmVmcmVzaE9yRFJBTUNsb2NrQ2hhbmdlSW5WYmxhbmssICZsb2Nh
bHMtPk1pblByZWZldGNoTW9kZSwgJmxvY2Fscy0+TWF4UHJlZmV0Y2hNb2RlKTsKKworCWxvY2Fs
cy0+TWF4VG90YWxWQWN0aXZlUkRCYW5kd2lkdGggPSAwOworCWZvciAoayA9IDA7IGsgPCBsb2Nh
bHMtPk51bWJlck9mQWN0aXZlUGxhbmVzOyBrKyspIHsKKwkJbG9jYWxzLT5NYXhUb3RhbFZBY3Rp
dmVSREJhbmR3aWR0aCA9IGxvY2Fscy0+TWF4VG90YWxWQWN0aXZlUkRCYW5kd2lkdGggKyBsb2Nh
bHMtPlJlYWRCYW5kd2lkdGhba107CisJfQorCisJZm9yIChpID0gMDsgaSA8PSBsb2NhbHMtPnNv
Yy5udW1fc3RhdGVzOyBpKyspIHsKKwkJZm9yIChqID0gMDsgaiA8IDI7IGorKykgeworCQkJZm9y
IChrID0gMDsgayA8IGxvY2Fscy0+TnVtYmVyT2ZBY3RpdmVQbGFuZXM7IGsrKykgeworCQkJCWxv
Y2Fscy0+Tm9PZkRQUFRoaXNTdGF0ZVtrXSA9IGxvY2Fscy0+Tm9PZkRQUFtpXVtqXVtrXTsKKwkJ
CQlsb2NhbHMtPlJlcXVpcmVkRFBQQ0xLVGhpc1N0YXRlW2tdID0gbG9jYWxzLT5SZXF1aXJlZERQ
UENMS1tpXVtqXVtrXTsKKwkJCQlsb2NhbHMtPlN3YXRoSGVpZ2h0WVRoaXNTdGF0ZVtrXSA9IGxv
Y2Fscy0+U3dhdGhIZWlnaHRZUGVyU3RhdGVbaV1bal1ba107CisJCQkJbG9jYWxzLT5Td2F0aEhl
aWdodENUaGlzU3RhdGVba10gPSBsb2NhbHMtPlN3YXRoSGVpZ2h0Q1BlclN0YXRlW2ldW2pdW2td
OworCQkJCWxvY2Fscy0+U3dhdGhXaWR0aFlUaGlzU3RhdGVba10gPSBsb2NhbHMtPlN3YXRoV2lk
dGhZUGVyU3RhdGVbaV1bal1ba107CisJCQkJbW9kZV9saWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtE
ZWVwU2xlZXAgPSBkbWxfbWF4KAorCQkJCQkJbW9kZV9saWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtE
ZWVwU2xlZXAsCisJCQkJCQltb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10gLyAxNi4wKTsKKwkJ
CQlpZiAobW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxJbkRFVENba10gPT0gMC4wKSB7CisJCQkJ
CWlmIChtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSA8PSAxLjApIHsKKwkJCQkJCW1vZGVfbGliLT52
YmEuUHJvamVjdGVkRENGQ0xLRGVlcFNsZWVwID0KKwkJCQkJCQkJZG1sX21heCgKKwkJCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLlByb2plY3RlZERDRkNMS0RlZXBTbGVlcCwKKwkJCQkJCQkJCQkxLjEK
KwkJCQkJCQkJCQkJCSogZG1sX2NlaWwoCisJCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuQnl0
ZVBlclBpeGVsSW5ERVRZW2tdLAorCQkJCQkJCQkJCQkJCQkxLjApCisJCQkJCQkJCQkJCQkvIDY0
LjAKKwkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJCQkJCQkJCQkJCSog
bW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdCisJCQkJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEu
Tm9PZkRQUFtpXVtqXVtrXSk7CisJCQkJCX0gZWxzZSB7CisJCQkJCQltb2RlX2xpYi0+dmJhLlBy
b2plY3RlZERDRkNMS0RlZXBTbGVlcCA9CisJCQkJCQkJCWRtbF9tYXgoCisJCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtEZWVwU2xlZXAsCisJCQkJCQkJCQkJMS4xCisJCQkJ
CQkJCQkJCQkqIGRtbF9jZWlsKAorCQkJCQkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkJ5dGVQZXJQ
aXhlbEluREVUWVtrXSwKKwkJCQkJCQkJCQkJCQkJMS4wKQorCQkJCQkJCQkJCQkJLyA2NC4wCisJ
CQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuUFNDTF9GQUNUT1Jba10KKwkJCQkJCQkJCQkJCSog
bW9kZV9saWItPnZiYS5SZXF1aXJlZERQUENMS1tpXVtqXVtrXSk7CisJCQkJCX0KKwkJCQl9IGVs
c2UgeworCQkJCQlpZiAobW9kZV9saWItPnZiYS5WUmF0aW9ba10gPD0gMS4wKSB7CisJCQkJCQlt
b2RlX2xpYi0+dmJhLlByb2plY3RlZERDRkNMS0RlZXBTbGVlcCA9CisJCQkJCQkJCWRtbF9tYXgo
CisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtEZWVwU2xlZXAsCisJCQkJ
CQkJCQkJMS4xCisJCQkJCQkJCQkJCQkqIGRtbF9jZWlsKAorCQkJCQkJCQkJCQkJCQltb2RlX2xp
Yi0+dmJhLkJ5dGVQZXJQaXhlbEluREVUWVtrXSwKKwkJCQkJCQkJCQkJCQkJMS4wKQorCQkJCQkJ
CQkJCQkJLyAzMi4wCisJCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuSFJhdGlvW2tdCisJCQkJ
CQkJCQkJCQkqIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXQorCQkJCQkJCQkJCQkJLyBtb2Rl
X2xpYi0+dmJhLk5vT2ZEUFBbaV1bal1ba10pOworCQkJCQl9IGVsc2UgeworCQkJCQkJbW9kZV9s
aWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtEZWVwU2xlZXAgPQorCQkJCQkJCQlkbWxfbWF4KAorCQkJ
CQkJCQkJCW1vZGVfbGliLT52YmEuUHJvamVjdGVkRENGQ0xLRGVlcFNsZWVwLAorCQkJCQkJCQkJ
CTEuMQorCQkJCQkJCQkJCQkJKiBkbWxfY2VpbCgKKwkJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5CeXRlUGVyUGl4ZWxJbkRFVFlba10sCisJCQkJCQkJCQkJCQkJCTEuMCkKKwkJCQkJCQkJCQkJ
CS8gMzIuMAorCQkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlBTQ0xfRkFDVE9SW2tdCisJCQkJ
CQkJCQkJCQkqIG1vZGVfbGliLT52YmEuUmVxdWlyZWREUFBDTEtbaV1bal1ba10pOworCQkJCQl9
CisJCQkJCWlmIChtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSAvIDIuMCA8PSAxLjApIHsKKwkJCQkJ
CW1vZGVfbGliLT52YmEuUHJvamVjdGVkRENGQ0xLRGVlcFNsZWVwID0KKwkJCQkJCQkJZG1sX21h
eCgKKwkJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlByb2plY3RlZERDRkNMS0RlZXBTbGVlcCwKKwkJ
CQkJCQkJCQkxLjEKKwkJCQkJCQkJCQkJCSogZG1sX2NlaWwoCisJCQkJCQkJCQkJCQkJCW1vZGVf
bGliLT52YmEuQnl0ZVBlclBpeGVsSW5ERVRDW2tdLAorCQkJCQkJCQkJCQkJCQkyLjApCisJCQkJ
CQkJCQkJCQkvIDMyLjAKKwkJCQkJCQkJCQkJCSogbW9kZV9saWItPnZiYS5IUmF0aW9ba10KKwkJ
CQkJCQkJCQkJCS8gMi4wCisJCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1tr
XQorCQkJCQkJCQkJCQkJLyBtb2RlX2xpYi0+dmJhLk5vT2ZEUFBbaV1bal1ba10pOworCQkJCQl9
IGVsc2UgeworCQkJCQkJbW9kZV9saWItPnZiYS5Qcm9qZWN0ZWREQ0ZDTEtEZWVwU2xlZXAgPQor
CQkJCQkJCQlkbWxfbWF4KAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuUHJvamVjdGVkRENGQ0xL
RGVlcFNsZWVwLAorCQkJCQkJCQkJCTEuMQorCQkJCQkJCQkJCQkJKiBkbWxfY2VpbCgKKwkJCQkJ
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxJbkRFVENba10sCisJCQkJCQkJCQkJ
CQkJCTIuMCkKKwkJCQkJCQkJCQkJCS8gMzIuMAorCQkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJh
LlBTQ0xfRkFDVE9SX0NIUk9NQVtrXQorCQkJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJhLlJlcXVp
cmVkRFBQQ0xLW2ldW2pdW2tdKTsKKwkJCQkJfQorCQkJCX0KKwkJCX0KKwkJCWZvciAoayA9IDA7
IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJ
CW1vZGVfbGliLT52YmEuUERFQW5kTWV0YVBURUJ5dGVzUGVyRnJhbWVZID0gQ2FsY3VsYXRlVk1B
bmRSb3dCeXRlcygKKwkJCQkJCW1vZGVfbGliLAorCQkJCQkJbW9kZV9saWItPnZiYS5EQ0NFbmFi
bGVba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlJlYWQyNTZCbG9ja0hlaWdodFlba10sCisJCQkJ
CQltb2RlX2xpYi0+dmJhLlJlYWQyNTZCbG9ja1dpZHRoWVtrXSwKKwkJCQkJCW1vZGVfbGliLT52
YmEuU291cmNlUGl4ZWxGb3JtYXRba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlN1cmZhY2VUaWxp
bmdba10sCisJCQkJCQlkbWxfY2VpbChtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbEluREVUWVtr
XSwgMS4wKSwKKwkJCQkJCW1vZGVfbGliLT52YmEuU291cmNlU2NhbltrXSwKKwkJCQkJCW1vZGVf
bGliLT52YmEuVmlld3BvcnRXaWR0aFtrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuVmlld3BvcnRI
ZWlnaHRba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1b
a10sCisJCQkJCQltb2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlLAorCQkJCQkJbW9kZV9saWItPnZi
YS5WTU1QYWdlU2l6ZSwKKwkJCQkJCW1vZGVfbGliLT52YmEuUFRFQnVmZmVyU2l6ZUluUmVxdWVz
dHNMdW1hLAorCQkJCQkJbW9kZV9saWItPnZiYS5QREVQcm9jZXNzaW5nQnVmSW42NEtCUmVxcywK
KwkJCQkJCW1vZGVfbGliLT52YmEuUGl0Y2hZW2tdLAorCQkJCQkJbW9kZV9saWItPnZiYS5EQ0NN
ZXRhUGl0Y2hZW2tdLAorCQkJCQkJJm1vZGVfbGliLT52YmEuTWFjcm9UaWxlV2lkdGhZW2tdLAor
CQkJCQkJJm1vZGVfbGliLT52YmEuTWV0YVJvd0J5dGVzWSwKKwkJCQkJCSZtb2RlX2xpYi0+dmJh
LkRQVEVCeXRlc1BlclJvd1ksCisJCQkJCQkmbW9kZV9saWItPnZiYS5QVEVCdWZmZXJTaXplTm90
RXhjZWVkZWRZW2ldW2pdW2tdLAorCQkJCQkJJm1vZGVfbGliLT52YmEuZHB0ZV9yb3dfaGVpZ2h0
W2tdLAorCQkJCQkJJm1vZGVfbGliLT52YmEubWV0YV9yb3dfaGVpZ2h0W2tdKTsKKwkJCQltb2Rl
X2xpYi0+dmJhLlByZWZldGNoTGluZXNZW2tdID0gQ2FsY3VsYXRlUHJlZmV0Y2hTb3VyY2VMaW5l
cygKKwkJCQkJCW1vZGVfbGliLAorCQkJCQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10sCisJCQkJ
CQltb2RlX2xpYi0+dmJhLnZ0YXBzW2tdLAorCQkJCQkJbW9kZV9saWItPnZiYS5JbnRlcmxhY2Vb
a10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlByb2dyZXNzaXZlVG9JbnRlcmxhY2VVbml0SW5PUFAs
CisJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0WVBlclN0YXRlW2ldW2pdW2tdLAorCQkJ
CQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydFlTdGFydFlba10sCisJCQkJCQkmbW9kZV9saWItPnZi
YS5QcmVmaWxsWVtrXSwKKwkJCQkJCSZtb2RlX2xpYi0+dmJhLk1heE51bVN3WVtrXSk7CisJCQkJ
aWYgKChtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQ0NF82NAorCQkJ
CQkJJiYgbW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80NDRfMzIKKwkJ
CQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzE2CisJ
CQkJCQkmJiBtb2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtX21vbm9fMTYK
KwkJCQkJCSYmIG1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fbW9ub184
KSkgeworCQkJCQltb2RlX2xpYi0+dmJhLlBERUFuZE1ldGFQVEVCeXRlc1BlckZyYW1lQyA9IENh
bGN1bGF0ZVZNQW5kUm93Qnl0ZXMoCisJCQkJCQkJbW9kZV9saWIsCisJCQkJCQkJbW9kZV9saWIt
PnZiYS5EQ0NFbmFibGVba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5SZWFkMjU2QmxvY2tIZWln
aHRZW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUmVhZDI1NkJsb2NrV2lkdGhZW2tdLAorCQkJ
CQkJCW1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10sCisJCQkJCQkJbW9kZV9saWIt
PnZiYS5TdXJmYWNlVGlsaW5nW2tdLAorCQkJCQkJCWRtbF9jZWlsKG1vZGVfbGliLT52YmEuQnl0
ZVBlclBpeGVsSW5ERVRDW2tdLCAyLjApLAorCQkJCQkJCW1vZGVfbGliLT52YmEuU291cmNlU2Nh
bltrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0V2lkdGhba10gLyAyLjAsCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5WaWV3cG9ydEhlaWdodFtrXSAvIDIuMCwKKwkJCQkJCQltb2RlX2xp
Yi0+dmJhLlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba10gLyAyLjAsCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5HUFVWTUVuYWJsZSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZNTVBhZ2VTaXplLAor
CQkJCQkJCW1vZGVfbGliLT52YmEuUFRFQnVmZmVyU2l6ZUluUmVxdWVzdHNMdW1hLAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuUERFUHJvY2Vzc2luZ0J1ZkluNjRLQlJlcXMsCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5QaXRjaENba10sCisJCQkJCQkJMC4wLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLk1h
Y3JvVGlsZVdpZHRoQ1trXSwKKwkJCQkJCQkmbW9kZV9saWItPnZiYS5NZXRhUm93Qnl0ZXNDLAor
CQkJCQkJCSZtb2RlX2xpYi0+dmJhLkRQVEVCeXRlc1BlclJvd0MsCisJCQkJCQkJJm1vZGVfbGli
LT52YmEuUFRFQnVmZmVyU2l6ZU5vdEV4Y2VlZGVkQ1tpXVtqXVtrXSwKKwkJCQkJCQkmbW9kZV9s
aWItPnZiYS5kcHRlX3Jvd19oZWlnaHRfY2hyb21hW2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJh
Lm1ldGFfcm93X2hlaWdodF9jaHJvbWFba10pOworCQkJCQltb2RlX2xpYi0+dmJhLlByZWZldGNo
TGluZXNDW2tdID0gQ2FsY3VsYXRlUHJlZmV0Y2hTb3VyY2VMaW5lcygKKwkJCQkJCQltb2RlX2xp
YiwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZSYXRpb1trXSAvIDIuMCwKKwkJCQkJCQltb2RlX2xp
Yi0+dmJhLlZUQVBzQ2hyb21hW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuSW50ZXJsYWNlW2td
LAorCQkJCQkJCW1vZGVfbGliLT52YmEuUHJvZ3Jlc3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCwK
KwkJCQkJCQltb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1BlclN0YXRlW2ldW2pdW2tdLAorCQkJ
CQkJCW1vZGVfbGliLT52YmEuVmlld3BvcnRZU3RhcnRDW2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+
dmJhLlByZWZpbGxDW2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLk1heE51bVN3Q1trXSk7CisJ
CQkJfSBlbHNlIHsKKwkJCQkJbW9kZV9saWItPnZiYS5QREVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFt
ZUMgPSAwLjA7CisJCQkJCW1vZGVfbGliLT52YmEuTWV0YVJvd0J5dGVzQyA9IDAuMDsKKwkJCQkJ
bW9kZV9saWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dDID0gMC4wOworCQkJCQlsb2NhbHMtPlByZWZl
dGNoTGluZXNDW2tdID0gMC4wOworCQkJCQlsb2NhbHMtPlBURUJ1ZmZlclNpemVOb3RFeGNlZWRl
ZENbaV1bal1ba10gPSB0cnVlOworCQkJCQlsb2NhbHMtPlBURUJ1ZmZlclNpemVJblJlcXVlc3Rz
Rm9yTHVtYSA9IG1vZGVfbGliLT52YmEuUFRFQnVmZmVyU2l6ZUluUmVxdWVzdHNMdW1hICsgbW9k
ZV9saWItPnZiYS5QVEVCdWZmZXJTaXplSW5SZXF1ZXN0c0Nocm9tYTsKKwkJCQl9CisJCQkJbG9j
YWxzLT5QREVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFtZVtrXSA9CisJCQkJCQltb2RlX2xpYi0+dmJh
LlBERUFuZE1ldGFQVEVCeXRlc1BlckZyYW1lWSArIG1vZGVfbGliLT52YmEuUERFQW5kTWV0YVBU
RUJ5dGVzUGVyRnJhbWVDOworCQkJCWxvY2Fscy0+TWV0YVJvd0J5dGVzW2tdID0gbW9kZV9saWIt
PnZiYS5NZXRhUm93Qnl0ZXNZICsgbW9kZV9saWItPnZiYS5NZXRhUm93Qnl0ZXNDOworCQkJCWxv
Y2Fscy0+RFBURUJ5dGVzUGVyUm93W2tdID0gbW9kZV9saWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dZ
ICsgbW9kZV9saWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dDOworCisJCQkJQ2FsY3VsYXRlQWN0aXZl
Um93QmFuZHdpZHRoKAorCQkJCQkJbW9kZV9saWItPnZiYS5HUFVWTUVuYWJsZSwKKwkJCQkJCW1v
ZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10sCisJCQkJCQltb2RlX2xpYi0+dmJhLlZS
YXRpb1trXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuRENDRW5hYmxlW2tdLAorCQkJCQkJbW9kZV9s
aWItPnZiYS5IVG90YWxba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10sCisJCQkJCQlt
b2RlX2xpYi0+dmJhLk1ldGFSb3dCeXRlc1ksCisJCQkJCQltb2RlX2xpYi0+dmJhLk1ldGFSb3dC
eXRlc0MsCisJCQkJCQltb2RlX2xpYi0+dmJhLm1ldGFfcm93X2hlaWdodFtrXSwKKwkJCQkJCW1v
ZGVfbGliLT52YmEubWV0YV9yb3dfaGVpZ2h0X2Nocm9tYVtrXSwKKwkJCQkJCW1vZGVfbGliLT52
YmEuRFBURUJ5dGVzUGVyUm93WSwKKwkJCQkJCW1vZGVfbGliLT52YmEuRFBURUJ5dGVzUGVyUm93
QywKKwkJCQkJCW1vZGVfbGliLT52YmEuZHB0ZV9yb3dfaGVpZ2h0W2tdLAorCQkJCQkJbW9kZV9s
aWItPnZiYS5kcHRlX3Jvd19oZWlnaHRfY2hyb21hW2tdLAorCQkJCQkJJm1vZGVfbGliLT52YmEu
bWV0YV9yb3dfYndba10sCisJCQkJCQkmbW9kZV9saWItPnZiYS5kcHRlX3Jvd19id1trXSwKKwkJ
CQkJCSZtb2RlX2xpYi0+dmJhLnF1YWxfcm93X2J3W2tdKTsKKwkJCX0KKwkJCW1vZGVfbGliLT52
YmEuRXh0cmFMYXRlbmN5ID0KKwkJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRSb3VuZFRyaXBBbmRP
dXRPZk9yZGVyTGF0ZW5jeVBlclN0YXRlW2ldCisJCQkJCQkJKyAobW9kZV9saWItPnZiYS5Ub3Rh
bE51bWJlck9mQWN0aXZlRFBQW2ldW2pdCisJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuUGl4ZWxD
aHVua1NpemVJbktCeXRlCisJCQkJCQkJCQkrIG1vZGVfbGliLT52YmEuVG90YWxOdW1iZXJPZkRD
Q0FjdGl2ZURQUFtpXVtqXQorCQkJCQkJCQkJCQkqIG1vZGVfbGliLT52YmEuTWV0YUNodW5rU2l6
ZSkKKwkJCQkJCQkJCSogMTAyNC4wCisJCQkJCQkJCQkvIG1vZGVfbGliLT52YmEuUmV0dXJuQldQ
ZXJTdGF0ZVtpXTsKKwkJCWlmIChtb2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlID09IHRydWUpIHsK
KwkJCQltb2RlX2xpYi0+dmJhLkV4dHJhTGF0ZW5jeSA9IG1vZGVfbGliLT52YmEuRXh0cmFMYXRl
bmN5CisJCQkJCQkrIG1vZGVfbGliLT52YmEuVG90YWxOdW1iZXJPZkFjdGl2ZURQUFtpXVtqXQor
CQkJCQkJCQkqIG1vZGVfbGliLT52YmEuUFRFR3JvdXBTaXplCisJCQkJCQkJCS8gbW9kZV9saWIt
PnZiYS5SZXR1cm5CV1BlclN0YXRlW2ldOworCQkJfQorCQkJbW9kZV9saWItPnZiYS5UaW1lQ2Fs
YyA9IDI0LjAgLyBtb2RlX2xpYi0+dmJhLlByb2plY3RlZERDRkNMS0RlZXBTbGVlcDsKKworCQkJ
Zm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsg
aysrKSB7CisJCQkJaWYgKG1vZGVfbGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdba10gPT0gaykg
eworCQkJCQlpZiAobW9kZV9saWItPnZiYS5Xcml0ZWJhY2tFbmFibGVba10gPT0gdHJ1ZSkgewor
CQkJCQkJbG9jYWxzLT5Xcml0ZWJhY2tEZWxheVtpXVtrXSA9IG1vZGVfbGliLT52YmEuV3JpdGVi
YWNrTGF0ZW5jeQorCQkJCQkJCQkrIENhbGN1bGF0ZVdyaXRlQmFja0RlbGF5KAorCQkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuV3JpdGViYWNrUGl4ZWxGb3JtYXRba10sCisJCQkJCQkJCQkJbW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9ba10sCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0
ZWJhY2tWUmF0aW9ba10sCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRh
cHNba10sCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVlRhcHNba10sCisJ
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFIVGFwc1trXSwKKwkJCQkJCQkJ
CQltb2RlX2xpYi0+dmJhLldyaXRlYmFja0Nocm9tYVZUYXBzW2tdLAorCQkJCQkJCQkJCW1vZGVf
bGliLT52YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFtrXSkgLyBsb2NhbHMtPlJlcXVpcmVk
RElTUENMS1tpXVtqXTsKKwkJCQkJfSBlbHNlIHsKKwkJCQkJCWxvY2Fscy0+V3JpdGViYWNrRGVs
YXlbaV1ba10gPSAwLjA7CisJCQkJCX0KKwkJCQkJZm9yIChtID0gMDsgbSA8PSBtb2RlX2xpYi0+
dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgbSsrKSB7CisJCQkJCQlpZiAobW9kZV9saWIt
PnZiYS5CbGVuZGluZ0FuZFRpbWluZ1ttXSA9PSBrCisJCQkJCQkJCSYmIG1vZGVfbGliLT52YmEu
V3JpdGViYWNrRW5hYmxlW21dCisJCQkJCQkJCQkJPT0gdHJ1ZSkgeworCQkJCQkJCWxvY2Fscy0+
V3JpdGViYWNrRGVsYXlbaV1ba10gPSBkbWxfbWF4KGxvY2Fscy0+V3JpdGViYWNrRGVsYXlbaV1b
a10sCisJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrTGF0ZW5jeSArIENhbGN1bGF0
ZVdyaXRlQmFja0RlbGF5KAorCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuV3JpdGViYWNrUGl4
ZWxGb3JtYXRbbV0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tIUmF0aW9b
bV0sCisJCQkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tWUmF0aW9bbV0sCisJCQkJ
CQkJCQkJCQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hSFRhcHNbbV0sCisJCQkJCQkJCQkJ
CQkJbW9kZV9saWItPnZiYS5Xcml0ZWJhY2tMdW1hVlRhcHNbbV0sCisJCQkJCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5Xcml0ZWJhY2tDaHJvbWFIVGFwc1ttXSwKKwkJCQkJCQkJCQkJCQltb2RlX2xp
Yi0+dmJhLldyaXRlYmFja0Nocm9tYVZUYXBzW21dLAorCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52
YmEuV3JpdGViYWNrRGVzdGluYXRpb25XaWR0aFttXSkgLyBsb2NhbHMtPlJlcXVpcmVkRElTUENM
S1tpXVtqXSk7CisJCQkJCQl9CisJCQkJCX0KKwkJCQl9CisJCQl9CisJCQlmb3IgKGsgPSAwOyBr
IDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQlm
b3IgKG0gPSAwOyBtIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBt
KyspIHsKKwkJCQkJaWYgKG1vZGVfbGliLT52YmEuQmxlbmRpbmdBbmRUaW1pbmdba10gPT0gbSkg
eworCQkJCQkJbG9jYWxzLT5Xcml0ZWJhY2tEZWxheVtpXVtrXSA9IGxvY2Fscy0+V3JpdGViYWNr
RGVsYXlbaV1bbV07CisJCQkJCX0KKwkJCQl9CisJCQl9CisJCQlmb3IgKGsgPSAwOyBrIDw9IG1v
ZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQlmb3IgKG0g
PSAwOyBtIDwgbG9jYWxzLT5OdW1iZXJPZkN1cnNvcnNba107IG0rKykKKwkJCQkJbG9jYWxzLT5j
dXJzb3JfYndba10gPSBsb2NhbHMtPk51bWJlck9mQ3Vyc29yc1trXSAqIGxvY2Fscy0+Q3Vyc29y
V2lkdGhba11bbV0gKiBsb2NhbHMtPkN1cnNvckJQUFtrXVttXQorCQkJCQkJLyA4IC8gKGxvY2Fs
cy0+SFRvdGFsW2tdIC8gbG9jYWxzLT5QaXhlbENsb2NrW2tdKSAqIGxvY2Fscy0+VlJhdGlvW2td
OworCQkJfQorCisJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3Rp
dmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQlsb2NhbHMtPk1heGltdW1WU3RhcnR1cFtrXSA9IG1v
ZGVfbGliLT52YmEuVlRvdGFsW2tdIC0gbW9kZV9saWItPnZiYS5WQWN0aXZlW2tdCisJCQkJCS0g
ZG1sX21heCgxLjAsIGRtbF9jZWlsKGxvY2Fscy0+V3JpdGViYWNrRGVsYXlbaV1ba10gLyAobW9k
ZV9saWItPnZiYS5IVG90YWxba10gLyBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tba10pLCAxLjAp
KTsKKwkJCX0KKworCQkJbW9kZV9saWItPnZiYS5OZXh0UHJlZmV0Y2hNb2RlID0gbW9kZV9saWIt
PnZiYS5NaW5QcmVmZXRjaE1vZGU7CisJCQlkbyB7CisJCQkJbW9kZV9saWItPnZiYS5QcmVmZXRj
aE1vZGVbaV1bal0gPSBtb2RlX2xpYi0+dmJhLk5leHRQcmVmZXRjaE1vZGU7CisJCQkJbW9kZV9s
aWItPnZiYS5OZXh0UHJlZmV0Y2hNb2RlID0gbW9kZV9saWItPnZiYS5OZXh0UHJlZmV0Y2hNb2Rl
ICsgMTsKKworCQkJCW1vZGVfbGliLT52YmEuVFdhaXQgPSBDYWxjdWxhdGVUV2FpdCgKKwkJCQkJ
CW1vZGVfbGliLT52YmEuUHJlZmV0Y2hNb2RlW2ldW2pdLAorCQkJCQkJbW9kZV9saWItPnZiYS5E
UkFNQ2xvY2tDaGFuZ2VMYXRlbmN5LAorCQkJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5
LAorCQkJCQkJbW9kZV9saWItPnZiYS5TUkVudGVyUGx1c0V4aXRUaW1lKTsKKwkJCQlmb3IgKGsg
PSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsK
KworCQkJCQlpZiAobW9kZV9saWItPnZiYS5YRkNFbmFibGVkW2tdID09IHRydWUpIHsKKwkJCQkJ
CW1vZGVfbGliLT52YmEuWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSA9CisJCQkJCQkJCUNhbGN1
bGF0ZVJlbW90ZVN1cmZhY2VGbGlwRGVsYXkoCisJCQkJCQkJCQkJbW9kZV9saWIsCisJCQkJCQkJ
CQkJbW9kZV9saWItPnZiYS5WUmF0aW9ba10sCisJCQkJCQkJCQkJbG9jYWxzLT5Td2F0aFdpZHRo
WVBlclN0YXRlW2ldW2pdW2tdLAorCQkJCQkJCQkJCWRtbF9jZWlsKGxvY2Fscy0+Qnl0ZVBlclBp
eGVsSW5ERVRZW2tdLCAxLjApLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8g
bW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuWEZD
VFNsdlZ1cGRhdGVPZmZzZXQsCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5YRkNUU2x2VnVwZGF0
ZVdpZHRoLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuWEZDVFNsdlZyZWFkeU9mZnNldCwKKwkJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLlhGQ1hCVUZMYXRlbmN5VG9sZXJhbmNlLAorCQkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuWEZDRmlsbEJXT3ZlcmhlYWQsCisJCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5YRkNTbHZDaHVua1NpemUsCisJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5YRkNCdXNUcmFuc3Bv
cnRUaW1lLAorCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuVGltZUNhbGMsCisJCQkJCQkJCQkJbW9k
ZV9saWItPnZiYS5UV2FpdCwKKwkJCQkJCQkJCQkmbW9kZV9saWItPnZiYS5TcmNBY3RpdmVEcmFp
blJhdGUsCisJCQkJCQkJCQkJJm1vZGVfbGliLT52YmEuVEluaXRYRmlsbCwKKwkJCQkJCQkJCQkm
bW9kZV9saWItPnZiYS5Uc2x2Q2hrKTsKKwkJCQkJfSBlbHNlIHsKKwkJCQkJCW1vZGVfbGliLT52
YmEuWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSA9IDAuMDsKKwkJCQkJfQorCisJCQkJCUNhbGN1
bGF0ZURlbGF5QWZ0ZXJTY2FsZXIobW9kZV9saWIsIG1vZGVfbGliLT52YmEuUmV0dXJuQldQZXJT
dGF0ZVtpXSwgbW9kZV9saWItPnZiYS5SZWFkQmFuZHdpZHRoTHVtYVtrXSwgbW9kZV9saWItPnZi
YS5SZWFkQmFuZHdpZHRoQ2hyb21hW2tdLCBtb2RlX2xpYi0+dmJhLk1heFRvdGFsVkFjdGl2ZVJE
QmFuZHdpZHRoLAorCQkJCQkJbW9kZV9saWItPnZiYS5EaXNwbGF5UGlwZUxpbmVEZWxpdmVyeVRp
bWVMdW1hW2tdLCBtb2RlX2xpYi0+dmJhLkRpc3BsYXlQaXBlTGluZURlbGl2ZXJ5VGltZUNocm9t
YVtrXSwKKwkJCQkJCW1vZGVfbGliLT52YmEuUmVxdWlyZWREUFBDTEtbaV1bal1ba10sIG1vZGVf
bGliLT52YmEuUmVxdWlyZWRESVNQQ0xLW2ldW2pdLCBtb2RlX2xpYi0+dmJhLlBpeGVsQ2xvY2tb
a10sIG1vZGVfbGliLT52YmEuRFNDRGVsYXlQZXJTdGF0ZVtpXVtrXSwgbW9kZV9saWItPnZiYS5O
b09mRFBQW2ldW2pdW2tdLCBtb2RlX2xpYi0+dmJhLlNjYWxlckVuYWJsZWRba10sIG1vZGVfbGli
LT52YmEuTnVtYmVyT2ZDdXJzb3JzW2tdLAorCQkJCQkJbW9kZV9saWItPnZiYS5EUFBDTEtEZWxh
eVN1YnRvdGFsLCBtb2RlX2xpYi0+dmJhLkRQUENMS0RlbGF5U0NMLCBtb2RlX2xpYi0+dmJhLkRQ
UENMS0RlbGF5U0NMTEJPbmx5LCBtb2RlX2xpYi0+dmJhLkRQUENMS0RlbGF5Q05WQ0Zvcm1hdGVy
LCBtb2RlX2xpYi0+dmJhLkRQUENMS0RlbGF5Q05WQ0N1cnNvciwgbW9kZV9saWItPnZiYS5ESVNQ
Q0xLRGVsYXlTdWJ0b3RhbCwKKwkJCQkJCW1vZGVfbGliLT52YmEuU3dhdGhXaWR0aFlQZXJTdGF0
ZVtpXVtqXVtrXSAvIG1vZGVfbGliLT52YmEuSFJhdGlvW2tdLCBtb2RlX2xpYi0+dmJhLk91dHB1
dEZvcm1hdFtrXSwgbW9kZV9saWItPnZiYS5IVG90YWxba10sCisJCQkJCQltb2RlX2xpYi0+dmJh
LlN3YXRoV2lkdGhZU2luZ2xlRFBQW2tdLCBtb2RlX2xpYi0+dmJhLkJ5dGVQZXJQaXhlbEluREVU
WVtrXSwgbW9kZV9saWItPnZiYS5CeXRlUGVyUGl4ZWxJbkRFVENba10sIG1vZGVfbGliLT52YmEu
U3dhdGhIZWlnaHRZVGhpc1N0YXRlW2tdLCBtb2RlX2xpYi0+dmJhLlN3YXRoSGVpZ2h0Q1RoaXNT
dGF0ZVtrXSwgbW9kZV9saWItPnZiYS5JbnRlcmxhY2Vba10sIG1vZGVfbGliLT52YmEuUHJvZ3Jl
c3NpdmVUb0ludGVybGFjZVVuaXRJbk9QUCwKKwkJCQkJCSZtb2RlX2xpYi0+dmJhLkRTVFhBZnRl
clNjYWxlcltrXSwgJm1vZGVfbGliLT52YmEuRFNUWUFmdGVyU2NhbGVyW2tdKTsKKworCQkJCQlt
b2RlX2xpYi0+dmJhLklzRXJyb3JSZXN1bHRbaV1bal1ba10gPQorCQkJCQkJCUNhbGN1bGF0ZVBy
ZWZldGNoU2NoZWR1bGUoCisJCQkJCQkJCQltb2RlX2xpYiwKKwkJCQkJCQkJCW1vZGVfbGliLT52
YmEuUmVxdWlyZWREUFBDTEtbaV1bal1ba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlJlcXVp
cmVkRElTUENMS1tpXVtqXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuUGl4ZWxDbG9ja1trXSwK
KwkJCQkJCQkJCW1vZGVfbGliLT52YmEuUHJvamVjdGVkRENGQ0xLRGVlcFNsZWVwLAorCQkJCQkJ
CQkJbW9kZV9saWItPnZiYS5Ob09mRFBQW2ldW2pdW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5OdW1iZXJPZkN1cnNvcnNba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlZUb3RhbFtrXQor
CQkJCQkJCQkJCQktIG1vZGVfbGliLT52YmEuVkFjdGl2ZVtrXSwKKwkJCQkJCQkJCW1vZGVfbGli
LT52YmEuSFRvdGFsW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5NYXhJbnRlckRDTlRpbGVS
ZXBlYXRlcnMsCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLk1heGltdW1WU3RhcnR1cFtrXSwKKwkJ
CQkJCQkJCW1vZGVfbGliLT52YmEuR1BVVk1NYXhQYWdlVGFibGVMZXZlbHMsCisJCQkJCQkJCQlt
b2RlX2xpYi0+dmJhLkdQVVZNRW5hYmxlLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5EeW5hbWlj
TWV0YWRhdGFFbmFibGVba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkR5bmFtaWNNZXRhZGF0
YUxpbmVzQmVmb3JlQWN0aXZlUmVxdWlyZWRba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkR5
bmFtaWNNZXRhZGF0YVRyYW5zbWl0dGVkQnl0ZXNba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJh
LkRDQ0VuYWJsZVtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuVXJnZW50TGF0ZW5jeVBpeGVs
RGF0YU9ubHksCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkV4dHJhTGF0ZW5jeSwKKwkJCQkJCQkJ
CW1vZGVfbGliLT52YmEuVGltZUNhbGMsCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLlBERUFuZE1l
dGFQVEVCeXRlc1BlckZyYW1lW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5NZXRhUm93Qnl0
ZXNba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRQVEVCeXRlc1BlclJvd1trXSwKKwkJCQkJ
CQkJCW1vZGVfbGliLT52YmEuUHJlZmV0Y2hMaW5lc1lba10sCisJCQkJCQkJCQltb2RlX2xpYi0+
dmJhLlN3YXRoV2lkdGhZUGVyU3RhdGVbaV1bal1ba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJh
LkJ5dGVQZXJQaXhlbEluREVUWVtrXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuUHJlZmlsbFlb
a10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLk1heE51bVN3WVtrXSwKKwkJCQkJCQkJCW1vZGVf
bGliLT52YmEuUHJlZmV0Y2hMaW5lc0Nba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkJ5dGVQ
ZXJQaXhlbEluREVUQ1trXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuUHJlZmlsbENba10sCisJ
CQkJCQkJCQltb2RlX2xpYi0+dmJhLk1heE51bVN3Q1trXSwKKwkJCQkJCQkJCW1vZGVfbGliLT52
YmEuU3dhdGhIZWlnaHRZUGVyU3RhdGVbaV1bal1ba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJh
LlN3YXRoSGVpZ2h0Q1BlclN0YXRlW2ldW2pdW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5U
V2FpdCwKKwkJCQkJCQkJCW1vZGVfbGliLT52YmEuWEZDRW5hYmxlZFtrXSwKKwkJCQkJCQkJCW1v
ZGVfbGliLT52YmEuWEZDUmVtb3RlU3VyZmFjZUZsaXBEZWxheSwKKwkJCQkJCQkJCW1vZGVfbGli
LT52YmEuSW50ZXJsYWNlW2tdLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5Qcm9ncmVzc2l2ZVRv
SW50ZXJsYWNlVW5pdEluT1BQLAorCQkJCQkJCQkJbW9kZV9saWItPnZiYS5EU1RYQWZ0ZXJTY2Fs
ZXJba10sCisJCQkJCQkJCQltb2RlX2xpYi0+dmJhLkRTVFlBZnRlclNjYWxlcltrXSwKKwkJCQkJ
CQkJCSZtb2RlX2xpYi0+dmJhLkxpbmVUaW1lc0ZvclByZWZldGNoW2tdLAorCQkJCQkJCQkJJm1v
ZGVfbGliLT52YmEuUHJlZmV0Y2hCV1trXSwKKwkJCQkJCQkJCSZtb2RlX2xpYi0+dmJhLkxpbmVz
Rm9yTWV0YVBURVtrXSwKKwkJCQkJCQkJCSZtb2RlX2xpYi0+dmJhLkxpbmVzRm9yTWV0YUFuZERQ
VEVSb3dba10sCisJCQkJCQkJCQkmbW9kZV9saWItPnZiYS5WUmF0aW9QcmVZW2ldW2pdW2tdLAor
CQkJCQkJCQkJJm1vZGVfbGliLT52YmEuVlJhdGlvUHJlQ1tpXVtqXVtrXSwKKwkJCQkJCQkJCSZt
b2RlX2xpYi0+dmJhLlJlcXVpcmVkUHJlZmV0Y2hQaXhlbERhdGFCV0x1bWFbaV1bal1ba10sCisJ
CQkJCQkJCQkmbW9kZV9saWItPnZiYS5Ubm9fYndba10sCisJCQkJCQkJCQkmbW9kZV9saWItPnZi
YS5WVXBkYXRlT2Zmc2V0UGl4W2tdLAorCQkJCQkJCQkJJm1vZGVfbGliLT52YmEuVlVwZGF0ZVdp
ZHRoUGl4W2tdLAorCQkJCQkJCQkJJm1vZGVfbGliLT52YmEuVlJlYWR5T2Zmc2V0UGl4W2tdKTsK
KwkJCQl9CisJCQkJbW9kZV9saWItPnZiYS5NYXhpbXVtUmVhZEJhbmR3aWR0aFdpdGhvdXRQcmVm
ZXRjaCA9IDAuMDsKKwkJCQltb2RlX2xpYi0+dmJhLk1heGltdW1SZWFkQmFuZHdpZHRoV2l0aFBy
ZWZldGNoID0gMC4wOworCQkJCWxvY2Fscy0+cHJlZmV0Y2hfdm1fYndfdmFsaWQgPSB0cnVlOwor
CQkJCWxvY2Fscy0+cHJlZmV0Y2hfcm93X2J3X3ZhbGlkID0gdHJ1ZTsKKwkJCQlmb3IgKGsgPSAw
OyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJ
CQkJaWYgKGxvY2Fscy0+UERFQW5kTWV0YVBURUJ5dGVzUGVyRnJhbWVba10gPT0gMCkKKwkJCQkJ
CWxvY2Fscy0+cHJlZmV0Y2hfdm1fYndba10gPSAwOworCQkJCQllbHNlIGlmIChsb2NhbHMtPkxp
bmVzRm9yTWV0YVBURVtrXSA+IDApCisJCQkJCQlsb2NhbHMtPnByZWZldGNoX3ZtX2J3W2tdID0g
bG9jYWxzLT5QREVBbmRNZXRhUFRFQnl0ZXNQZXJGcmFtZVtrXQorCQkJCQkJCS8gKGxvY2Fscy0+
TGluZXNGb3JNZXRhUFRFW2tdICogbG9jYWxzLT5IVG90YWxba10gLyBsb2NhbHMtPlBpeGVsQ2xv
Y2tba10pOworCQkJCQllbHNlIHsKKwkJCQkJCWxvY2Fscy0+cHJlZmV0Y2hfdm1fYndba10gPSAw
OworCQkJCQkJbG9jYWxzLT5wcmVmZXRjaF92bV9id192YWxpZCA9IGZhbHNlOworCQkJCQl9CisJ
CQkJCWlmIChsb2NhbHMtPk1ldGFSb3dCeXRlc1trXSArIGxvY2Fscy0+RFBURUJ5dGVzUGVyUm93
W2tdID09IDApCisJCQkJCQlsb2NhbHMtPnByZWZldGNoX3Jvd19id1trXSA9IDA7CisJCQkJCWVs
c2UgaWYgKGxvY2Fscy0+TGluZXNGb3JNZXRhQW5kRFBURVJvd1trXSA+IDApCisJCQkJCQlsb2Nh
bHMtPnByZWZldGNoX3Jvd19id1trXSA9IChsb2NhbHMtPk1ldGFSb3dCeXRlc1trXSArIGxvY2Fs
cy0+RFBURUJ5dGVzUGVyUm93W2tdKQorCQkJCQkJCS8gKGxvY2Fscy0+TGluZXNGb3JNZXRhQW5k
RFBURVJvd1trXSAqIGxvY2Fscy0+SFRvdGFsW2tdIC8gbG9jYWxzLT5QaXhlbENsb2NrW2tdKTsK
KwkJCQkJZWxzZSB7CisJCQkJCQlsb2NhbHMtPnByZWZldGNoX3Jvd19id1trXSA9IDA7CisJCQkJ
CQlsb2NhbHMtPnByZWZldGNoX3Jvd19id192YWxpZCA9IGZhbHNlOworCQkJCQl9CisKKwkJCQkJ
bW9kZV9saWItPnZiYS5NYXhpbXVtUmVhZEJhbmR3aWR0aFdpdGhvdXRQcmVmZXRjaCA9IG1vZGVf
bGliLT52YmEuTWF4aW11bVJlYWRCYW5kd2lkdGhXaXRoUHJlZmV0Y2gKKwkJCQkJCQkrIG1vZGVf
bGliLT52YmEuY3Vyc29yX2J3W2tdICsgbW9kZV9saWItPnZiYS5SZWFkQmFuZHdpZHRoW2tdICsg
bW9kZV9saWItPnZiYS5tZXRhX3Jvd19id1trXSArIG1vZGVfbGliLT52YmEuZHB0ZV9yb3dfYndb
a107CisJCQkJCW1vZGVfbGliLT52YmEuTWF4aW11bVJlYWRCYW5kd2lkdGhXaXRoUHJlZmV0Y2gg
PQorCQkJCQkJCW1vZGVfbGliLT52YmEuTWF4aW11bVJlYWRCYW5kd2lkdGhXaXRoUHJlZmV0Y2gK
KwkJCQkJCQkJCSsgbW9kZV9saWItPnZiYS5jdXJzb3JfYndba10KKwkJCQkJCQkJCSsgZG1sX21h
eDMoCisJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEucHJlZmV0Y2hfdm1fYndba10sCisJCQkJCQkJ
CQkJCW1vZGVfbGliLT52YmEucHJlZmV0Y2hfcm93X2J3W2tdLAorCQkJCQkJCQkJCQlkbWxfbWF4
KG1vZGVfbGliLT52YmEuUmVhZEJhbmR3aWR0aFtrXSwKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZi
YS5SZXF1aXJlZFByZWZldGNoUGl4ZWxEYXRhQldMdW1hW2ldW2pdW2tdKQorCQkJCQkJCQkJCQkr
IG1vZGVfbGliLT52YmEubWV0YV9yb3dfYndba10gKyBtb2RlX2xpYi0+dmJhLmRwdGVfcm93X2J3
W2tdKTsKKwkJCQl9CisJCQkJbG9jYWxzLT5CYW5kd2lkdGhXaXRob3V0UHJlZmV0Y2hTdXBwb3J0
ZWRbaV0gPSB0cnVlOworCQkJCWlmIChtb2RlX2xpYi0+dmJhLk1heGltdW1SZWFkQmFuZHdpZHRo
V2l0aG91dFByZWZldGNoID4gbG9jYWxzLT5SZXR1cm5CV1BlclN0YXRlW2ldKSB7CisJCQkJCWxv
Y2Fscy0+QmFuZHdpZHRoV2l0aG91dFByZWZldGNoU3VwcG9ydGVkW2ldID0gZmFsc2U7CisJCQkJ
fQorCisJCQkJbG9jYWxzLT5QcmVmZXRjaFN1cHBvcnRlZFtpXVtqXSA9IHRydWU7CisJCQkJaWYg
KG1vZGVfbGliLT52YmEuTWF4aW11bVJlYWRCYW5kd2lkdGhXaXRoUHJlZmV0Y2ggPiBsb2NhbHMt
PlJldHVybkJXUGVyU3RhdGVbaV0pIHsKKwkJCQkJbG9jYWxzLT5QcmVmZXRjaFN1cHBvcnRlZFtp
XVtqXSA9IGZhbHNlOworCQkJCX0KKwkJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEu
TnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQkJaWYgKGxvY2Fscy0+TGluZVRp
bWVzRm9yUHJlZmV0Y2hba10gPCAyLjAKKwkJCQkJCQl8fCBsb2NhbHMtPkxpbmVzRm9yTWV0YVBU
RVtrXSA+PSA4LjAKKwkJCQkJCQl8fCBsb2NhbHMtPkxpbmVzRm9yTWV0YUFuZERQVEVSb3dba10g
Pj0gMTYuMAorCQkJCQkJCXx8IG1vZGVfbGliLT52YmEuSXNFcnJvclJlc3VsdFtpXVtqXVtrXSA9
PSB0cnVlKSB7CisJCQkJCQlsb2NhbHMtPlByZWZldGNoU3VwcG9ydGVkW2ldW2pdID0gZmFsc2U7
CisJCQkJCX0KKwkJCQl9CisJCQkJbG9jYWxzLT5WUmF0aW9JblByZWZldGNoU3VwcG9ydGVkW2ld
W2pdID0gdHJ1ZTsKKwkJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZB
Y3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQkJaWYgKGxvY2Fscy0+VlJhdGlvUHJlWVtpXVtq
XVtrXSA+IDQuMAorCQkJCQkJCXx8IGxvY2Fscy0+VlJhdGlvUHJlQ1tpXVtqXVtrXSA+IDQuMAor
CQkJCQkJCXx8IG1vZGVfbGliLT52YmEuSXNFcnJvclJlc3VsdFtpXVtqXVtrXSA9PSB0cnVlKSB7
CisJCQkJCQlsb2NhbHMtPlZSYXRpb0luUHJlZmV0Y2hTdXBwb3J0ZWRbaV1bal0gPSBmYWxzZTsK
KwkJCQkJfQorCQkJCX0KKwkJCX0gd2hpbGUgKChsb2NhbHMtPlByZWZldGNoU3VwcG9ydGVkW2ld
W2pdICE9IHRydWUgfHwgbG9jYWxzLT5WUmF0aW9JblByZWZldGNoU3VwcG9ydGVkW2ldW2pdICE9
IHRydWUpCisJCQkJCSYmIG1vZGVfbGliLT52YmEuTmV4dFByZWZldGNoTW9kZSA8IG1vZGVfbGli
LT52YmEuTWF4UHJlZmV0Y2hNb2RlKTsKKworCQkJaWYgKG1vZGVfbGliLT52YmEuUHJlZmV0Y2hT
dXBwb3J0ZWRbaV1bal0gPT0gdHJ1ZQorCQkJCQkmJiBtb2RlX2xpYi0+dmJhLlZSYXRpb0luUHJl
ZmV0Y2hTdXBwb3J0ZWRbaV1bal0gPT0gdHJ1ZSkgeworCQkJCW1vZGVfbGliLT52YmEuQmFuZHdp
ZHRoQXZhaWxhYmxlRm9ySW1tZWRpYXRlRmxpcCA9CisJCQkJCQltb2RlX2xpYi0+dmJhLlJldHVy
bkJXUGVyU3RhdGVbaV07CisJCQkJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJl
ck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJCW1vZGVfbGliLT52YmEuQmFuZHdpZHRo
QXZhaWxhYmxlRm9ySW1tZWRpYXRlRmxpcCA9CisJCQkJCQkJbW9kZV9saWItPnZiYS5CYW5kd2lk
dGhBdmFpbGFibGVGb3JJbW1lZGlhdGVGbGlwCisJCQkJCQkJCQktIG1vZGVfbGliLT52YmEuY3Vy
c29yX2J3W2tdCisJCQkJCQkJCQktIGRtbF9tYXgoCisJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEu
UmVhZEJhbmR3aWR0aFtrXSArIG1vZGVfbGliLT52YmEucXVhbF9yb3dfYndba10sCisJCQkJCQkJ
CQkJCW1vZGVfbGliLT52YmEuUHJlZmV0Y2hCV1trXSk7CisJCQkJfQorCQkJCWZvciAoayA9IDA7
IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJ
CQltb2RlX2xpYi0+dmJhLkltbWVkaWF0ZUZsaXBCeXRlc1trXSA9IDAuMDsKKwkJCQkJaWYgKCht
b2RlX2xpYi0+dmJhLlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQyMF84CisJCQkJCQkJJiYg
bW9kZV9saWItPnZiYS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80MjBfMTApKSB7CisJCQkJ
CQltb2RlX2xpYi0+dmJhLkltbWVkaWF0ZUZsaXBCeXRlc1trXSA9CisJCQkJCQkJCW1vZGVfbGli
LT52YmEuUERFQW5kTWV0YVBURUJ5dGVzUGVyRnJhbWVba10KKwkJCQkJCQkJCQkrIG1vZGVfbGli
LT52YmEuTWV0YVJvd0J5dGVzW2tdCisJCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLkRQVEVCeXRl
c1BlclJvd1trXTsKKwkJCQkJfQorCQkJCX0KKwkJCQltb2RlX2xpYi0+dmJhLlRvdEltbWVkaWF0
ZUZsaXBCeXRlcyA9IDAuMDsKKwkJCQlmb3IgKGsgPSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVt
YmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsKKwkJCQkJaWYgKChtb2RlX2xpYi0+dmJhLlNv
dXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQyMF84CisJCQkJCQkJJiYgbW9kZV9saWItPnZiYS5T
b3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80MjBfMTApKSB7CisJCQkJCQltb2RlX2xpYi0+dmJh
LlRvdEltbWVkaWF0ZUZsaXBCeXRlcyA9CisJCQkJCQkJCW1vZGVfbGliLT52YmEuVG90SW1tZWRp
YXRlRmxpcEJ5dGVzCisJCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJhLkltbWVkaWF0ZUZsaXBCeXRl
c1trXTsKKwkJCQkJfQorCQkJCX0KKworCQkJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZi
YS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJCQlDYWxjdWxhdGVGbGlwU2No
ZWR1bGUoCisJCQkJCQkJbW9kZV9saWIsCisJCQkJCQkJbW9kZV9saWItPnZiYS5FeHRyYUxhdGVu
Y3ksCisJCQkJCQkJbW9kZV9saWItPnZiYS5VcmdlbnRMYXRlbmN5UGl4ZWxEYXRhT25seSwKKwkJ
CQkJCQltb2RlX2xpYi0+dmJhLkdQVVZNTWF4UGFnZVRhYmxlTGV2ZWxzLAorCQkJCQkJCW1vZGVf
bGliLT52YmEuR1BVVk1FbmFibGUsCisJCQkJCQkJbW9kZV9saWItPnZiYS5CYW5kd2lkdGhBdmFp
bGFibGVGb3JJbW1lZGlhdGVGbGlwLAorCQkJCQkJCW1vZGVfbGliLT52YmEuVG90SW1tZWRpYXRl
RmxpcEJ5dGVzLAorCQkJCQkJCW1vZGVfbGliLT52YmEuU291cmNlUGl4ZWxGb3JtYXRba10sCisJ
CQkJCQkJbW9kZV9saWItPnZiYS5JbW1lZGlhdGVGbGlwQnl0ZXNba10sCisJCQkJCQkJbW9kZV9s
aWItPnZiYS5IVG90YWxba10KKwkJCQkJCQkJCS8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2td
LAorCQkJCQkJCW1vZGVfbGliLT52YmEuVlJhdGlvW2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEu
VG5vX2J3W2tdLAorCQkJCQkJCW1vZGVfbGliLT52YmEuUERFQW5kTWV0YVBURUJ5dGVzUGVyRnJh
bWVba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5NZXRhUm93Qnl0ZXNba10sCisJCQkJCQkJbW9k
ZV9saWItPnZiYS5EUFRFQnl0ZXNQZXJSb3dba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5EQ0NF
bmFibGVba10sCisJCQkJCQkJbW9kZV9saWItPnZiYS5kcHRlX3Jvd19oZWlnaHRba10sCisJCQkJ
CQkJbW9kZV9saWItPnZiYS5tZXRhX3Jvd19oZWlnaHRba10sCisJCQkJCQkJbW9kZV9saWItPnZi
YS5xdWFsX3Jvd19id1trXSwKKwkJCQkJCQkmbW9kZV9saWItPnZiYS5EZXN0aW5hdGlvbkxpbmVz
VG9SZXF1ZXN0Vk1JbkltbWVkaWF0ZUZsaXBba10sCisJCQkJCQkJJm1vZGVfbGliLT52YmEuRGVz
dGluYXRpb25MaW5lc1RvUmVxdWVzdFJvd0luSW1tZWRpYXRlRmxpcFtrXSwKKwkJCQkJCQkmbW9k
ZV9saWItPnZiYS5maW5hbF9mbGlwX2J3W2tdLAorCQkJCQkJCSZtb2RlX2xpYi0+dmJhLkltbWVk
aWF0ZUZsaXBTdXBwb3J0ZWRGb3JQaXBlW2tdKTsKKwkJCQl9CisJCQkJbW9kZV9saWItPnZiYS50
b3RhbF9kY25fcmVhZF9id193aXRoX2ZsaXAgPSAwLjA7CisJCQkJZm9yIChrID0gMDsgayA8PSBt
b2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCQkJCW1vZGVf
bGliLT52YmEudG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwID0KKwkJCQkJCQltb2RlX2xpYi0+
dmJhLnRvdGFsX2Rjbl9yZWFkX2J3X3dpdGhfZmxpcAorCQkJCQkJCQkJKyBtb2RlX2xpYi0+dmJh
LmN1cnNvcl9id1trXQorCQkJCQkJCQkJKyBkbWxfbWF4MygKKwkJCQkJCQkJCQkJbW9kZV9saWIt
PnZiYS5wcmVmZXRjaF92bV9id1trXSwKKwkJCQkJCQkJCQkJbW9kZV9saWItPnZiYS5wcmVmZXRj
aF9yb3dfYndba10sCisJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuZmluYWxfZmxpcF9id1trXQor
CQkJCQkJCQkJCQkJCSsgZG1sX21heCgKKwkJCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuUmVh
ZEJhbmR3aWR0aFtrXSwKKwkJCQkJCQkJCQkJCQkJCW1vZGVfbGliLT52YmEuUmVxdWlyZWRQcmVm
ZXRjaFBpeGVsRGF0YUJXTHVtYVtpXVtqXVtrXSkpOworCQkJCX0KKwkJCQltb2RlX2xpYi0+dmJh
LkltbWVkaWF0ZUZsaXBTdXBwb3J0ZWRGb3JTdGF0ZVtpXVtqXSA9IHRydWU7CisJCQkJaWYgKG1v
ZGVfbGliLT52YmEudG90YWxfZGNuX3JlYWRfYndfd2l0aF9mbGlwCisJCQkJCQk+IG1vZGVfbGli
LT52YmEuUmV0dXJuQldQZXJTdGF0ZVtpXSkgeworCQkJCQltb2RlX2xpYi0+dmJhLkltbWVkaWF0
ZUZsaXBTdXBwb3J0ZWRGb3JTdGF0ZVtpXVtqXSA9IGZhbHNlOworCQkJCX0KKwkJCQlmb3IgKGsg
PSAwOyBrIDw9IG1vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXMgLSAxOyBrKyspIHsK
KwkJCQkJaWYgKG1vZGVfbGliLT52YmEuSW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclBpcGVba10g
PT0gZmFsc2UpIHsKKwkJCQkJCW1vZGVfbGliLT52YmEuSW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZv
clN0YXRlW2ldW2pdID0gZmFsc2U7CisJCQkJCX0KKwkJCQl9CisJCQl9IGVsc2UgeworCQkJCW1v
ZGVfbGliLT52YmEuSW1tZWRpYXRlRmxpcFN1cHBvcnRlZEZvclN0YXRlW2ldW2pdID0gZmFsc2U7
CisJCQl9CisJCX0KKwl9CisKKwkvKlZlcnRpY2FsIEFjdGl2ZSBCVyBzdXBwb3J0Ki8KKwlmb3Ig
KGkgPSAwOyBpIDw9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7IGkrKykgeworCQltb2Rl
X2xpYi0+dmJhLk1heFRvdGFsVmVydGljYWxBY3RpdmVBdmFpbGFibGVCYW5kd2lkdGhbaV0gPSBk
bWxfbWluKG1vZGVfbGliLT52YmEuUmV0dXJuQnVzV2lkdGggKgorCQkJCW1vZGVfbGliLT52YmEu
RENGQ0xLUGVyU3RhdGVbaV0sIG1vZGVfbGliLT52YmEuRmFicmljQW5kRFJBTUJhbmR3aWR0aFBl
clN0YXRlW2ldICogMTAwMCkgKgorCQkJCW1vZGVfbGliLT52YmEuTWF4QXZlcmFnZVBlcmNlbnRP
ZklkZWFsRFJBTUJXRGlzcGxheUNhblVzZUluTm9ybWFsU3lzdGVtT3BlcmF0aW9uIC8gMTAwOwor
CQlpZiAobW9kZV9saWItPnZiYS5NYXhUb3RhbFZBY3RpdmVSREJhbmR3aWR0aCA8PSBtb2RlX2xp
Yi0+dmJhLk1heFRvdGFsVmVydGljYWxBY3RpdmVBdmFpbGFibGVCYW5kd2lkdGhbaV0pCisJCQlt
b2RlX2xpYi0+dmJhLlRvdGFsVmVydGljYWxBY3RpdmVCYW5kd2lkdGhTdXBwb3J0W2ldID0gdHJ1
ZTsKKwkJZWxzZQorCQkJbW9kZV9saWItPnZiYS5Ub3RhbFZlcnRpY2FsQWN0aXZlQmFuZHdpZHRo
U3VwcG9ydFtpXSA9IGZhbHNlOworCX0KKworCS8qUFRFIEJ1ZmZlciBTaXplIENoZWNrKi8KKwor
CWZvciAoaSA9IDA7IGkgPD0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJ
CWZvciAoaiA9IDA7IGogPCAyOyBqKyspIHsKKwkJCWxvY2Fscy0+UFRFQnVmZmVyU2l6ZU5vdEV4
Y2VlZGVkW2ldW2pdID0gdHJ1ZTsKKwkJCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5O
dW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQkJCWlmIChsb2NhbHMtPlBURUJ1ZmZl
clNpemVOb3RFeGNlZWRlZFlbaV1bal1ba10gPT0gZmFsc2UKKwkJCQkJCXx8IGxvY2Fscy0+UFRF
QnVmZmVyU2l6ZU5vdEV4Y2VlZGVkQ1tpXVtqXVtrXSA9PSBmYWxzZSkgeworCQkJCQlsb2NhbHMt
PlBURUJ1ZmZlclNpemVOb3RFeGNlZWRlZFtpXVtqXSA9IGZhbHNlOworCQkJCX0KKwkJCX0KKwkJ
fQorCX0KKwkvKkN1cnNvciBTdXBwb3J0IENoZWNrKi8KKwltb2RlX2xpYi0+dmJhLkN1cnNvclN1
cHBvcnQgPSB0cnVlOworCWZvciAoayA9IDA7IGsgPD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFj
dGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlmb3IgKGogPSAwOyBqIDwgMjsgaisrKSB7CisJCQlp
ZiAobW9kZV9saWItPnZiYS5DdXJzb3JXaWR0aFtrXVtqXSA+IDAuMCkgeworCQkJCWlmIChkbWxf
Zmxvb3IoCisJCQkJCQlkbWxfZmxvb3IoCisJCQkJCQkJCW1vZGVfbGliLT52YmEuQ3Vyc29yQnVm
ZmVyU2l6ZQorCQkJCQkJCQkJCS0gbW9kZV9saWItPnZiYS5DdXJzb3JDaHVua1NpemUsCisJCQkJ
CQkJCW1vZGVfbGliLT52YmEuQ3Vyc29yQ2h1bmtTaXplKSAqIDEwMjQuMAorCQkJCQkJCQkvICht
b2RlX2xpYi0+dmJhLkN1cnNvcldpZHRoW2tdW2pdCisJCQkJCQkJCQkJKiBtb2RlX2xpYi0+dmJh
LkN1cnNvckJQUFtrXVtqXQorCQkJCQkJCQkJCS8gOC4wKSwKKwkJCQkJCTEuMCkKKwkJCQkJCSog
KG1vZGVfbGliLT52YmEuSFRvdGFsW2tdIC8gbW9kZV9saWItPnZiYS5QaXhlbENsb2NrW2tdKQor
CQkJCQkJLyBtb2RlX2xpYi0+dmJhLlZSYXRpb1trXSA8IG1vZGVfbGliLT52YmEuVXJnZW50TGF0
ZW5jeVBpeGVsRGF0YU9ubHkKKwkJCQkJCXx8IChtb2RlX2xpYi0+dmJhLkN1cnNvckJQUFtrXVtq
XSA9PSA2NC4wCisJCQkJCQkJCSYmIG1vZGVfbGliLT52YmEuQ3Vyc29yNjRCcHBTdXBwb3J0ID09
IGZhbHNlKSkgeworCQkJCQltb2RlX2xpYi0+dmJhLkN1cnNvclN1cHBvcnQgPSBmYWxzZTsKKwkJ
CQl9CisJCQl9CisJCX0KKwl9CisJLypWYWxpZCBQaXRjaCBDaGVjayovCisKKwltb2RlX2xpYi0+
dmJhLlBpdGNoU3VwcG9ydCA9IHRydWU7CisJZm9yIChrID0gMDsgayA8PSBtb2RlX2xpYi0+dmJh
Lk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7CisJCWxvY2Fscy0+QWxpZ25lZFlQaXRj
aFtrXSA9IGRtbF9jZWlsKAorCQkJCWRtbF9tYXgobW9kZV9saWItPnZiYS5QaXRjaFlba10sIG1v
ZGVfbGliLT52YmEuVmlld3BvcnRXaWR0aFtrXSksCisJCQkJbG9jYWxzLT5NYWNyb1RpbGVXaWR0
aFlba10pOworCQlpZiAobG9jYWxzLT5BbGlnbmVkWVBpdGNoW2tdID4gbW9kZV9saWItPnZiYS5Q
aXRjaFlba10pIHsKKwkJCW1vZGVfbGliLT52YmEuUGl0Y2hTdXBwb3J0ID0gZmFsc2U7CisJCX0K
KwkJaWYgKG1vZGVfbGliLT52YmEuRENDRW5hYmxlW2tdID09IHRydWUpIHsKKwkJCWxvY2Fscy0+
QWxpZ25lZERDQ01ldGFQaXRjaFtrXSA9IGRtbF9jZWlsKAorCQkJCQlkbWxfbWF4KAorCQkJCQkJ
CW1vZGVfbGliLT52YmEuRENDTWV0YVBpdGNoWVtrXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZp
ZXdwb3J0V2lkdGhba10pLAorCQkJCQk2NC4wICogbG9jYWxzLT5SZWFkMjU2QmxvY2tXaWR0aFlb
a10pOworCQl9IGVsc2UgeworCQkJbG9jYWxzLT5BbGlnbmVkRENDTWV0YVBpdGNoW2tdID0gbW9k
ZV9saWItPnZiYS5EQ0NNZXRhUGl0Y2hZW2tdOworCQl9CisJCWlmIChsb2NhbHMtPkFsaWduZWRE
Q0NNZXRhUGl0Y2hba10gPiBtb2RlX2xpYi0+dmJhLkRDQ01ldGFQaXRjaFlba10pIHsKKwkJCW1v
ZGVfbGliLT52YmEuUGl0Y2hTdXBwb3J0ID0gZmFsc2U7CisJCX0KKwkJaWYgKG1vZGVfbGliLT52
YmEuU291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fNDQ0XzY0CisJCQkJJiYgbW9kZV9saWItPnZi
YS5Tb3VyY2VQaXhlbEZvcm1hdFtrXSAhPSBkbV80NDRfMzIKKwkJCQkmJiBtb2RlX2xpYi0+dmJh
LlNvdXJjZVBpeGVsRm9ybWF0W2tdICE9IGRtXzQ0NF8xNgorCQkJCSYmIG1vZGVfbGliLT52YmEu
U291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fbW9ub18xNgorCQkJCSYmIG1vZGVfbGliLT52YmEu
U291cmNlUGl4ZWxGb3JtYXRba10gIT0gZG1fbW9ub184KSB7CisJCQlsb2NhbHMtPkFsaWduZWRD
UGl0Y2hba10gPSBkbWxfY2VpbCgKKwkJCQkJZG1sX21heCgKKwkJCQkJCQltb2RlX2xpYi0+dmJh
LlBpdGNoQ1trXSwKKwkJCQkJCQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0V2lkdGhba10gLyAyLjAp
LAorCQkJCQlsb2NhbHMtPk1hY3JvVGlsZVdpZHRoQ1trXSk7CisJCX0gZWxzZSB7CisJCQlsb2Nh
bHMtPkFsaWduZWRDUGl0Y2hba10gPSBtb2RlX2xpYi0+dmJhLlBpdGNoQ1trXTsKKwkJfQorCQlp
ZiAobG9jYWxzLT5BbGlnbmVkQ1BpdGNoW2tdID4gbW9kZV9saWItPnZiYS5QaXRjaENba10pIHsK
KwkJCW1vZGVfbGliLT52YmEuUGl0Y2hTdXBwb3J0ID0gZmFsc2U7CisJCX0KKwl9CisJLypNb2Rl
IFN1cHBvcnQsIFZvbHRhZ2UgU3RhdGUgYW5kIFNPQyBDb25maWd1cmF0aW9uKi8KKworCWZvciAo
aSA9IG1vZGVfbGliLT52YmEuc29jLm51bV9zdGF0ZXM7IGkgPj0gMDsgaS0tKSB7CisJCWZvciAo
aiA9IDA7IGogPCAyOyBqKyspIHsKKwkJCWVudW0gZG1fdmFsaWRhdGlvbl9zdGF0dXMgc3RhdHVz
ID0gRE1MX1ZBTElEQVRJT05fT0s7CisKKwkJCWlmIChtb2RlX2xpYi0+dmJhLlNjYWxlUmF0aW9B
bmRUYXBzU3VwcG9ydCAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfU0NBTEVfUkFU
SU9fVEFQOworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLlNvdXJjZUZvcm1hdFBpeGVsQW5k
U2NhblN1cHBvcnQgIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERNTF9GQUlMX1NPVVJDRV9QSVhF
TF9GT1JNQVQ7CisJCQl9IGVsc2UgaWYgKGxvY2Fscy0+Vmlld3BvcnRTaXplU3VwcG9ydFtpXSAh
PSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfVklFV1BPUlRfU0laRTsKKwkJCX0gZWxz
ZSBpZiAobG9jYWxzLT5ESU9TdXBwb3J0W2ldICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxf
RkFJTF9ESU9fU1VQUE9SVDsKKwkJCX0gZWxzZSBpZiAobG9jYWxzLT5Ob3RFbm91Z2hEU0NVbml0
c1tpXSAhPSBmYWxzZSkgeworCQkJCXN0YXR1cyA9IERNTF9GQUlMX05PVF9FTk9VR0hfRFNDOwor
CQkJfSBlbHNlIGlmIChsb2NhbHMtPkRTQ0NMS1JlcXVpcmVkTW9yZVRoYW5TdXBwb3J0ZWRbaV0g
IT0gZmFsc2UpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9EU0NfQ0xLX1JFUVVJUkVEOworCQkJ
fSBlbHNlIGlmIChsb2NhbHMtPlVyZ2VudExhdGVuY3lTdXBwb3J0W2ldW2pdICE9IHRydWUpIHsK
KwkJCQlzdGF0dXMgPSBETUxfRkFJTF9VUkdFTlRfTEFURU5DWTsKKwkJCX0gZWxzZSBpZiAobG9j
YWxzLT5ST0JTdXBwb3J0W2ldICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9SRU9S
REVSSU5HX0JVRkZFUjsKKwkJCX0gZWxzZSBpZiAobG9jYWxzLT5ESVNQQ0xLX0RQUENMS19TdXBw
b3J0W2ldW2pdICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9ESVNQQ0xLX0RQUENM
SzsKKwkJCX0gZWxzZSBpZiAobG9jYWxzLT5Ub3RhbEF2YWlsYWJsZVBpcGVzU3VwcG9ydFtpXVtq
XSAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfVE9UQUxfQVZBSUxBQkxFX1BJUEVT
OworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLk51bWJlck9mT1RHU3VwcG9ydCAhPSB0cnVl
KSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfTlVNX09URzsKKwkJCX0gZWxzZSBpZiAobW9kZV9s
aWItPnZiYS5Xcml0ZWJhY2tNb2RlU3VwcG9ydCAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1M
X0ZBSUxfV1JJVEVCQUNLX01PREU7CisJCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuV3JpdGVi
YWNrTGF0ZW5jeVN1cHBvcnQgIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERNTF9GQUlMX1dSSVRF
QkFDS19MQVRFTkNZOworCQkJfSBlbHNlIGlmIChtb2RlX2xpYi0+dmJhLldyaXRlYmFja1NjYWxl
UmF0aW9BbmRUYXBzU3VwcG9ydCAhPSB0cnVlKSB7CisJCQkJc3RhdHVzID0gRE1MX0ZBSUxfV1JJ
VEVCQUNLX1NDQUxFX1JBVElPX1RBUDsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5DdXJz
b3JTdXBwb3J0ICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9DVVJTT1JfU1VQUE9S
VDsKKwkJCX0gZWxzZSBpZiAobW9kZV9saWItPnZiYS5QaXRjaFN1cHBvcnQgIT0gdHJ1ZSkgewor
CQkJCXN0YXR1cyA9IERNTF9GQUlMX1BJVENIX1NVUFBPUlQ7CisJCQl9IGVsc2UgaWYgKGxvY2Fs
cy0+UHJlZmV0Y2hTdXBwb3J0ZWRbaV1bal0gIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERNTF9G
QUlMX1BSRUZFVENIX1NVUFBPUlQ7CisJCQl9IGVsc2UgaWYgKGxvY2Fscy0+VG90YWxWZXJ0aWNh
bEFjdGl2ZUJhbmR3aWR0aFN1cHBvcnRbaV0gIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERNTF9G
QUlMX1RPVEFMX1ZfQUNUSVZFX0JXOworCQkJfSBlbHNlIGlmIChsb2NhbHMtPlZSYXRpb0luUHJl
ZmV0Y2hTdXBwb3J0ZWRbaV1bal0gIT0gdHJ1ZSkgeworCQkJCXN0YXR1cyA9IERNTF9GQUlMX1Zf
UkFUSU9fUFJFRkVUQ0g7CisJCQl9IGVsc2UgaWYgKGxvY2Fscy0+UFRFQnVmZmVyU2l6ZU5vdEV4
Y2VlZGVkW2ldW2pdICE9IHRydWUpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9QVEVfQlVGRkVS
X1NJWkU7CisJCQl9IGVsc2UgaWYgKG1vZGVfbGliLT52YmEuTm9uc3VwcG9ydGVkRFNDSW5wdXRC
UEMgIT0gZmFsc2UpIHsKKwkJCQlzdGF0dXMgPSBETUxfRkFJTF9EU0NfSU5QVVRfQlBDOworCQkJ
fQorCisJCQlpZiAoc3RhdHVzID09IERNTF9WQUxJREFUSU9OX09LKSB7CisJCQkJbG9jYWxzLT5N
b2RlU3VwcG9ydFtpXVtqXSA9IHRydWU7CisJCQl9IGVsc2UgeworCQkJCWxvY2Fscy0+TW9kZVN1
cHBvcnRbaV1bal0gPSBmYWxzZTsKKwkJCX0KKwkJCWxvY2Fscy0+VmFsaWRhdGlvblN0YXR1c1tp
XSA9IHN0YXR1czsKKwkJfQorCX0KKwl7CisJCXVuc2lnbmVkIGludCBNYXhpbXVtTVBDQ29tYmlu
ZSA9IDA7CisJCW1vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsID0gbW9kZV9saWItPnZiYS5zb2Mu
bnVtX3N0YXRlcyArIDE7CisJCWZvciAoaSA9IG1vZGVfbGliLT52YmEuVm9sdGFnZU92ZXJyaWRl
TGV2ZWw7IGkgPD0gbW9kZV9saWItPnZiYS5zb2MubnVtX3N0YXRlczsgaSsrKSB7CisJCQlpZiAo
bG9jYWxzLT5Nb2RlU3VwcG9ydFtpXVswXSA9PSB0cnVlIHx8IGxvY2Fscy0+TW9kZVN1cHBvcnRb
aV1bMV0gPT0gdHJ1ZSkgeworCQkJCW1vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsID0gaTsKKwkJ
CQlpZiAobG9jYWxzLT5Nb2RlU3VwcG9ydFtpXVsxXSA9PSB0cnVlICYmIChsb2NhbHMtPk1vZGVT
dXBwb3J0W2ldWzBdID09IGZhbHNlCisJCQkJCQl8fCBtb2RlX2xpYi0+dmJhLldoZW5Ub0RvTVBD
Q29tYmluZSA9PSBkbV9tcGNfYWx3YXlzX3doZW5fcG9zc2libGUpKSB7CisJCQkJCU1heGltdW1N
UENDb21iaW5lID0gMTsKKwkJCQl9IGVsc2UgeworCQkJCQlNYXhpbXVtTVBDQ29tYmluZSA9IDA7
CisJCQkJfQorCQkJCWJyZWFrOworCQkJfQorCQl9CisJCW1vZGVfbGliLT52YmEuSW1tZWRpYXRl
RmxpcFN1cHBvcnQgPQorCQkJbG9jYWxzLT5JbW1lZGlhdGVGbGlwU3VwcG9ydGVkRm9yU3RhdGVb
bW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdW01heGltdW1NUENDb21iaW5lXTsKKwkJZm9yIChr
ID0gMDsgayA8PSBtb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzIC0gMTsgaysrKSB7
CisJCQltb2RlX2xpYi0+dmJhLkRQUFBlclBsYW5lW2tdID0gbG9jYWxzLT5Ob09mRFBQW21vZGVf
bGliLT52YmEuVm9sdGFnZUxldmVsXVtNYXhpbXVtTVBDQ29tYmluZV1ba107CisJCQlsb2NhbHMt
PkRQUENMS1trXSA9IGxvY2Fscy0+UmVxdWlyZWREUFBDTEtbbW9kZV9saWItPnZiYS5Wb2x0YWdl
TGV2ZWxdW01heGltdW1NUENDb21iaW5lXVtrXTsKKwkJfQorCQltb2RlX2xpYi0+dmJhLkRJU1BD
TEsgPSBsb2NhbHMtPlJlcXVpcmVkRElTUENMS1ttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF1b
TWF4aW11bU1QQ0NvbWJpbmVdOworCQltb2RlX2xpYi0+dmJhLm1heE1wY0NvbWIgPSBNYXhpbXVt
TVBDQ29tYmluZTsKKwl9CisJbW9kZV9saWItPnZiYS5EQ0ZDTEsgPSBtb2RlX2xpYi0+dmJhLkRD
RkNMS1BlclN0YXRlW21vZGVfbGliLT52YmEuVm9sdGFnZUxldmVsXTsKKwltb2RlX2xpYi0+dmJh
LkRSQU1TcGVlZCA9IG1vZGVfbGliLT52YmEuRFJBTVNwZWVkUGVyU3RhdGVbbW9kZV9saWItPnZi
YS5Wb2x0YWdlTGV2ZWxdOworCW1vZGVfbGliLT52YmEuRmFicmljQ2xvY2sgPSBtb2RlX2xpYi0+
dmJhLkZhYnJpY0Nsb2NrUGVyU3RhdGVbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdOworCW1v
ZGVfbGliLT52YmEuU09DQ0xLID0gbW9kZV9saWItPnZiYS5TT0NDTEtQZXJTdGF0ZVttb2RlX2xp
Yi0+dmJhLlZvbHRhZ2VMZXZlbF07CisJbW9kZV9saWItPnZiYS5SZXR1cm5CVyA9IGxvY2Fscy0+
UmV0dXJuQldQZXJTdGF0ZVttb2RlX2xpYi0+dmJhLlZvbHRhZ2VMZXZlbF07CisJbW9kZV9saWIt
PnZiYS5GYWJyaWNBbmREUkFNQmFuZHdpZHRoID0gbG9jYWxzLT5GYWJyaWNBbmREUkFNQmFuZHdp
ZHRoUGVyU3RhdGVbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdOworCWZvciAoayA9IDA7IGsg
PD0gbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lcyAtIDE7IGsrKykgeworCQlpZiAo
bW9kZV9saWItPnZiYS5CbGVuZGluZ0FuZFRpbWluZ1trXSA9PSBrKSB7CisJCQltb2RlX2xpYi0+
dmJhLk9ETUNvbWJpbmVFbmFibGVkW2tdID0KKwkJCQkJbG9jYWxzLT5PRE1Db21iaW5lRW5hYmxl
UGVyU3RhdGVbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdW2tdOworCQl9IGVsc2UgeworCQkJ
bW9kZV9saWItPnZiYS5PRE1Db21iaW5lRW5hYmxlZFtrXSA9IDA7CisJCX0KKwkJbW9kZV9saWIt
PnZiYS5EU0NFbmFibGVkW2tdID0KKwkJCQlsb2NhbHMtPlJlcXVpcmVzRFNDW21vZGVfbGliLT52
YmEuVm9sdGFnZUxldmVsXVtrXTsKKwkJbW9kZV9saWItPnZiYS5PdXRwdXRCcHBba10gPQorCQkJ
CWxvY2Fscy0+T3V0cHV0QnBwUGVyU3RhdGVbbW9kZV9saWItPnZiYS5Wb2x0YWdlTGV2ZWxdW2td
OworCX0KK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwv
ZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMHYyLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvZG1sL2RjbjIwL2Rpc3BsYXlfbW9kZV92YmFfMjB2Mi5oCm5ldyBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYTk4OWQzY2ExZTk5Ci0tLSAvZGV2L251bGwKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24yMC9kaXNwbGF5X21vZGVfdmJh
XzIwdjIuaApAQCAtMCwwICsxLDMyIEBACisvKgorICogQ29weXJpZ2h0IDIwMTggQWR2YW5jZWQg
TWljcm8gRGV2aWNlcywgSW5jLgorICoKKyAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQs
IGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCisgKiBjb3B5IG9mIHRo
aXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0
d2FyZSIpLAorICogdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwg
aW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgorICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHks
IG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCisgKiBhbmQv
b3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8g
d2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0
aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CisgKgorICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3Rp
Y2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KKyAqIGFs
bCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgorICoKKyAq
IFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFO
WSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVE
IFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEg
UEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFM
TAorICogVEhFIENPUFlSSUdIVCBIT0xERVIoUykgT1IgQVVUSE9SKFMpIEJFIExJQUJMRSBGT1Ig
QU5ZIENMQUlNLCBEQU1BR0VTIE9SCisgKiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4g
QUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwKKyAqIEFSSVNJTkcgRlJPTSwg
T1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgor
ICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgorICoKKyAqIEF1dGhvcnM6IEFNRAor
ICoKKyAqLworCisjaWZuZGVmIF9EQ04yMFYyX0RJU1BMQVlfTU9ERV9WQkFfSF8KKyNkZWZpbmUg
X0RDTjIwVjJfRElTUExBWV9NT0RFX1ZCQV9IXworCit2b2lkIGRtbDIwdjJfcmVjYWxjdWxhdGUo
c3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliKTsKK3ZvaWQgZG1sMjB2Ml9Nb2RlU3Vw
cG9ydEFuZFN5c3RlbUNvbmZpZ3VyYXRpb25GdWxsKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICpt
b2RlX2xpYik7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNw
bGF5L2RjL2RtbC9kY24yMC9kaXNwbGF5X3JxX2RsZ19jYWxjXzIwdjIuYyBiL2RyaXZlcnMvZ3B1
L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGNuMjAvZGlzcGxheV9ycV9kbGdfY2FsY18yMHYyLmMK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5lZDhiZjVmNzIzYzkKLS0t
IC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2RjbjIw
L2Rpc3BsYXlfcnFfZGxnX2NhbGNfMjB2Mi5jCkBAIC0wLDAgKzEsMTcwMSBAQAorLyoKKyAqIENv
cHlyaWdodCAyMDE4IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KKyAqCisgKiBQZXJtaXNz
aW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRh
aW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50
YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJl
IHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAqIHRo
ZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRl
LCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5k
IHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQg
dG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAqIFRo
ZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxs
IGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9m
IHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwg
V0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwgSU5D
TFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJ
VFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VN
RU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9SIEFV
VEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgorICogT1RIRVIgTElB
QklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJ
U0UsCisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNP
RlRXQVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4K
KyAqCisgKiBBdXRob3JzOiBBTUQKKyAqCisgKi8KKworI2luY2x1ZGUgIi4uL2Rpc3BsYXlfbW9k
ZV9saWIuaCIKKyNpbmNsdWRlICIuLi9kaXNwbGF5X21vZGVfdmJhLmgiCisjaW5jbHVkZSAiZGlz
cGxheV9ycV9kbGdfY2FsY18yMHYyLmgiCisKKy8vIEZ1bmN0aW9uOiBkbWwyMHYyX3JxX2RsZ19n
ZXRfcnFfcGFyYW1zCisvLyAgQ2FsY3VsYXRlIHJlcXVlc3RvciByZWxhdGVkIHBhcmFtZXRlcnMg
dGhhdCByZWdpc3RlciBkZWZpbml0aW9uIGFnbm9zdGljCisvLyAgKGkuZS4gdGhpcyBsYXllciBk
b2VzIHRyeSB0byBzZXBhcmF0ZSByZWFsIHZhbHVlcyBmcm9tIHJlZ2lzdGVyIGRlZmluaXRpb24p
CisvLyBJbnB1dDoKKy8vICBwaXBlX3NyY19wYXJhbSAtIHBpcGUgc291cmNlIGNvbmZpZ3VyYXRp
b24gKGUuZy4gdnAsIHBpdGNoLCBldGMuKQorLy8gT3V0cHV0OgorLy8gIHJxX3BhcmFtIC0gdmFs
dWVzIHRoYXQgY2FuIGJlIHVzZWQgdG8gc2V0dXAgUlEgKGUuZy4gc3dhdGhfaGVpZ2h0LCBwbGFu
ZTFfYWRkciwgZXRjLikKKy8vCitzdGF0aWMgdm9pZCBkbWwyMHYyX3JxX2RsZ19nZXRfcnFfcGFy
YW1zKAorCQlzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRpc3BsYXlfcnFf
cGFyYW1zX3N0ICogcnFfcGFyYW0sCisJCWNvbnN0IGRpc3BsYXlfcGlwZV9zb3VyY2VfcGFyYW1z
X3N0IHBpcGVfc3JjX3BhcmFtKTsKKworLy8gRnVuY3Rpb246IGRtbDIwdjJfcnFfZGxnX2dldF9k
bGdfcGFyYW1zCisvLyAgQ2FsY3VsYXRlIGRlYWRsaW5lIHJlbGF0ZWQgcGFyYW1ldGVycworLy8K
K3N0YXRpYyB2b2lkIGRtbDIwdjJfcnFfZGxnX2dldF9kbGdfcGFyYW1zKHN0cnVjdCBkaXNwbGF5
X21vZGVfbGliICptb2RlX2xpYiwKKwkJY29uc3QgZGlzcGxheV9lMmVfcGlwZV9wYXJhbXNfc3Qg
KmUyZV9waXBlX3BhcmFtLAorCQljb25zdCB1bnNpZ25lZCBpbnQgbnVtX3BpcGVzLAorCQljb25z
dCB1bnNpZ25lZCBpbnQgcGlwZV9pZHgsCisJCWRpc3BsYXlfZGxnX3JlZ3Nfc3QgKmRpc3BfZGxn
X3JlZ3MsCisJCWRpc3BsYXlfdHR1X3JlZ3Nfc3QgKmRpc3BfdHR1X3JlZ3MsCisJCWNvbnN0IGRp
c3BsYXlfcnFfZGxnX3BhcmFtc19zdCBycV9kbGdfcGFyYW0sCisJCWNvbnN0IGRpc3BsYXlfZGxn
X3N5c19wYXJhbXNfc3QgZGxnX3N5c19wYXJhbSwKKwkJY29uc3QgYm9vbCBjc3RhdGVfZW4sCisJ
CWNvbnN0IGJvb2wgcHN0YXRlX2VuKTsKKy8qCisgKiBOT1RFOgorICogICBUaGlzIGZpbGUgaXMg
Z2NjLXBhcnNlYWJsZSBIVyBnb3NwZWwsIGNvbWluZyBzdHJhaWdodCBmcm9tIEhXIGVuZ2luZWVy
cy4KKyAqCisgKiBJdCBkb2Vzbid0IGFkaGVyZSB0byBMaW51eCBrZXJuZWwgc3R5bGUgYW5kIHNv
bWV0aW1lcyB3aWxsIGRvIHRoaW5ncyBpbiBvZGQKKyAqIHdheXMuIFVubGVzcyB0aGVyZSBpcyBz
b21ldGhpbmcgY2xlYXJseSB3cm9uZyB3aXRoIGl0IHRoZSBjb2RlIHNob3VsZAorICogcmVtYWlu
IGFzLWlzIGFzIGl0IHByb3ZpZGVzIHVzIHdpdGggYSBndWFyYW50ZWUgZnJvbSBIVyB0aGF0IGl0
IGlzIGNvcnJlY3QuCisgKi8KKworc3RhdGljIHZvaWQgY2FsY3VsYXRlX3R0dV9jdXJzb3Ioc3Ry
dWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkb3VibGUgKnJlZmN5Y19wZXJfcmVx
X2RlbGl2ZXJ5X3ByZV9jdXIsCisJCWRvdWJsZSAqcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfY3Vy
LAorCQlkb3VibGUgcmVmY2xrX2ZyZXFfaW5fbWh6LAorCQlkb3VibGUgcmVmX2ZyZXFfdG9fcGl4
X2ZyZXEsCisJCWRvdWJsZSBoc2NhbGVfcGl4ZWxfcmF0ZV9sLAorCQlkb3VibGUgaHNjbF9yYXRp
bywKKwkJZG91YmxlIHZyYXRpb19wcmVfbCwKKwkJZG91YmxlIHZyYXRpb19sLAorCQl1bnNpZ25l
ZCBpbnQgY3VyX3dpZHRoLAorCQllbnVtIGN1cnNvcl9icHAgY3VyX2JwcCk7CisKKyNpbmNsdWRl
ICIuLi9kbWxfaW5saW5lX2RlZnMuaCIKKworc3RhdGljIHVuc2lnbmVkIGludCBnZXRfYnl0ZXNf
cGVyX2VsZW1lbnQoZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNzIHNvdXJjZV9mb3JtYXQsIGJvb2wg
aXNfY2hyb21hKQoreworCXVuc2lnbmVkIGludCByZXRfdmFsID0gMDsKKworCWlmIChzb3VyY2Vf
Zm9ybWF0ID09IGRtXzQ0NF8xNikgeworCQlpZiAoIWlzX2Nocm9tYSkKKwkJCXJldF92YWwgPSAy
OworCX0gZWxzZSBpZiAoc291cmNlX2Zvcm1hdCA9PSBkbV80NDRfMzIpIHsKKwkJaWYgKCFpc19j
aHJvbWEpCisJCQlyZXRfdmFsID0gNDsKKwl9IGVsc2UgaWYgKHNvdXJjZV9mb3JtYXQgPT0gZG1f
NDQ0XzY0KSB7CisJCWlmICghaXNfY2hyb21hKQorCQkJcmV0X3ZhbCA9IDg7CisJfSBlbHNlIGlm
IChzb3VyY2VfZm9ybWF0ID09IGRtXzQyMF84KSB7CisJCWlmIChpc19jaHJvbWEpCisJCQlyZXRf
dmFsID0gMjsKKwkJZWxzZQorCQkJcmV0X3ZhbCA9IDE7CisJfSBlbHNlIGlmIChzb3VyY2VfZm9y
bWF0ID09IGRtXzQyMF8xMCkgeworCQlpZiAoaXNfY2hyb21hKQorCQkJcmV0X3ZhbCA9IDQ7CisJ
CWVsc2UKKwkJCXJldF92YWwgPSAyOworCX0gZWxzZSBpZiAoc291cmNlX2Zvcm1hdCA9PSBkbV80
NDRfOCkgeworCQlyZXRfdmFsID0gMTsKKwl9CisJcmV0dXJuIHJldF92YWw7Cit9CisKK3N0YXRp
YyBib29sIGlzX2R1YWxfcGxhbmUoZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNzIHNvdXJjZV9mb3Jt
YXQpCit7CisJYm9vbCByZXRfdmFsID0gMDsKKworCWlmICgoc291cmNlX2Zvcm1hdCA9PSBkbV80
MjBfOCkgfHwgKHNvdXJjZV9mb3JtYXQgPT0gZG1fNDIwXzEwKSkKKwkJcmV0X3ZhbCA9IDE7CisK
KwlyZXR1cm4gcmV0X3ZhbDsKK30KKworc3RhdGljIGRvdWJsZSBnZXRfcmVmY3ljX3Blcl9kZWxp
dmVyeShzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRvdWJsZSByZWZjbGtf
ZnJlcV9pbl9taHosCisJCWRvdWJsZSBwY2xrX2ZyZXFfaW5fbWh6LAorCQlib29sIG9kbV9jb21i
aW5lLAorCQl1bnNpZ25lZCBpbnQgcmVjb3V0X3dpZHRoLAorCQl1bnNpZ25lZCBpbnQgaGFjdGl2
ZSwKKwkJZG91YmxlIHZyYXRpbywKKwkJZG91YmxlIGhzY2FsZV9waXhlbF9yYXRlLAorCQl1bnNp
Z25lZCBpbnQgZGVsaXZlcnlfd2lkdGgsCisJCXVuc2lnbmVkIGludCByZXFfcGVyX3N3YXRoX3Vi
KQoreworCWRvdWJsZSByZWZjeWNfcGVyX2RlbGl2ZXJ5ID0gMC4wOworCisJaWYgKHZyYXRpbyA8
PSAxLjApIHsKKwkJaWYgKG9kbV9jb21iaW5lKQorCQkJcmVmY3ljX3Blcl9kZWxpdmVyeSA9IChk
b3VibGUpIHJlZmNsa19mcmVxX2luX21oegorCQkJCQkqIGRtbF9taW4oKGRvdWJsZSkgcmVjb3V0
X3dpZHRoLCAoZG91YmxlKSBoYWN0aXZlIC8gMi4wKQorCQkJCQkvIHBjbGtfZnJlcV9pbl9taHog
LyAoZG91YmxlKSByZXFfcGVyX3N3YXRoX3ViOworCQllbHNlCisJCQlyZWZjeWNfcGVyX2RlbGl2
ZXJ5ID0gKGRvdWJsZSkgcmVmY2xrX2ZyZXFfaW5fbWh6ICogKGRvdWJsZSkgcmVjb3V0X3dpZHRo
CisJCQkJCS8gcGNsa19mcmVxX2luX21oeiAvIChkb3VibGUpIHJlcV9wZXJfc3dhdGhfdWI7CisJ
fSBlbHNlIHsKKwkJcmVmY3ljX3Blcl9kZWxpdmVyeSA9IChkb3VibGUpIHJlZmNsa19mcmVxX2lu
X21oeiAqIChkb3VibGUpIGRlbGl2ZXJ5X3dpZHRoCisJCQkJLyAoZG91YmxlKSBoc2NhbGVfcGl4
ZWxfcmF0ZSAvIChkb3VibGUpIHJlcV9wZXJfc3dhdGhfdWI7CisJfQorCisJZG1sX3ByaW50KCJE
TUxfRExHOiAlczogcmVmY2xrX2ZyZXFfaW5fbWh6ID0gJTMuMmZcbiIsIF9fZnVuY19fLCByZWZj
bGtfZnJlcV9pbl9taHopOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHBjbGtfZnJlcV9pbl9t
aHogICA9ICUzLjJmXG4iLCBfX2Z1bmNfXywgcGNsa19mcmVxX2luX21oeik7CisJZG1sX3ByaW50
KCJETUxfRExHOiAlczogcmVjb3V0X3dpZHRoICAgICAgID0gJWRcbiIsIF9fZnVuY19fLCByZWNv
dXRfd2lkdGgpOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHZyYXRpbyAgICAgICAgICAgICA9
ICUzLjJmXG4iLCBfX2Z1bmNfXywgdnJhdGlvKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBy
ZXFfcGVyX3N3YXRoX3ViICAgPSAlZFxuIiwgX19mdW5jX18sIHJlcV9wZXJfc3dhdGhfdWIpOwor
CWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJlZmN5Y19wZXJfZGVsaXZlcnk9ICUzLjJmXG4iLCBf
X2Z1bmNfXywgcmVmY3ljX3Blcl9kZWxpdmVyeSk7CisKKwlyZXR1cm4gcmVmY3ljX3Blcl9kZWxp
dmVyeTsKKworfQorCitzdGF0aWMgdW5zaWduZWQgaW50IGdldF9ibGtfc2l6ZV9ieXRlcyhjb25z
dCBlbnVtIHNvdXJjZV9tYWNyb190aWxlX3NpemUgdGlsZV9zaXplKQoreworCWlmICh0aWxlX3Np
emUgPT0gZG1fMjU2a190aWxlKQorCQlyZXR1cm4gKDI1NiAqIDEwMjQpOworCWVsc2UgaWYgKHRp
bGVfc2l6ZSA9PSBkbV82NGtfdGlsZSkKKwkJcmV0dXJuICg2NCAqIDEwMjQpOworCWVsc2UKKwkJ
cmV0dXJuICg0ICogMTAyNCk7Cit9CisKK3N0YXRpYyB2b2lkIGV4dHJhY3RfcnFfc2l6aW5nX3Jl
Z3Moc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkaXNwbGF5X2RhdGFfcnFf
cmVnc19zdCAqcnFfcmVncywKKwkJY29uc3QgZGlzcGxheV9kYXRhX3JxX3NpemluZ19wYXJhbXNf
c3QgcnFfc2l6aW5nKQoreworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJxX3NpemluZyBwYXJh
bVxuIiwgX19mdW5jX18pOworCXByaW50X19kYXRhX3JxX3NpemluZ19wYXJhbXNfc3QobW9kZV9s
aWIsIHJxX3NpemluZyk7CisKKwlycV9yZWdzLT5jaHVua19zaXplID0gZG1sX2xvZzIocnFfc2l6
aW5nLmNodW5rX2J5dGVzKSAtIDEwOworCisJaWYgKHJxX3NpemluZy5taW5fY2h1bmtfYnl0ZXMg
PT0gMCkKKwkJcnFfcmVncy0+bWluX2NodW5rX3NpemUgPSAwOworCWVsc2UKKwkJcnFfcmVncy0+
bWluX2NodW5rX3NpemUgPSBkbWxfbG9nMihycV9zaXppbmcubWluX2NodW5rX2J5dGVzKSAtIDgg
KyAxOworCisJcnFfcmVncy0+bWV0YV9jaHVua19zaXplID0gZG1sX2xvZzIocnFfc2l6aW5nLm1l
dGFfY2h1bmtfYnl0ZXMpIC0gMTA7CisJaWYgKHJxX3NpemluZy5taW5fbWV0YV9jaHVua19ieXRl
cyA9PSAwKQorCQlycV9yZWdzLT5taW5fbWV0YV9jaHVua19zaXplID0gMDsKKwllbHNlCisJCXJx
X3JlZ3MtPm1pbl9tZXRhX2NodW5rX3NpemUgPSBkbWxfbG9nMihycV9zaXppbmcubWluX21ldGFf
Y2h1bmtfYnl0ZXMpIC0gNiArIDE7CisKKwlycV9yZWdzLT5kcHRlX2dyb3VwX3NpemUgPSBkbWxf
bG9nMihycV9zaXppbmcuZHB0ZV9ncm91cF9ieXRlcykgLSA2OworCXJxX3JlZ3MtPm1wdGVfZ3Jv
dXBfc2l6ZSA9IGRtbF9sb2cyKHJxX3NpemluZy5tcHRlX2dyb3VwX2J5dGVzKSAtIDY7Cit9CisK
K3N0YXRpYyB2b2lkIGV4dHJhY3RfcnFfcmVncyhzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9k
ZV9saWIsCisJCWRpc3BsYXlfcnFfcmVnc19zdCAqcnFfcmVncywKKwkJY29uc3QgZGlzcGxheV9y
cV9wYXJhbXNfc3QgcnFfcGFyYW0pCit7CisJdW5zaWduZWQgaW50IGRldGlsZV9idWZfc2l6ZV9p
bl9ieXRlcyA9IG1vZGVfbGliLT5pcC5kZXRfYnVmZmVyX3NpemVfa2J5dGVzICogMTAyNDsKKwl1
bnNpZ25lZCBpbnQgZGV0aWxlX2J1Zl9wbGFuZTFfYWRkciA9IDA7CisKKwlleHRyYWN0X3JxX3Np
emluZ19yZWdzKG1vZGVfbGliLCAmKHJxX3JlZ3MtPnJxX3JlZ3NfbCksIHJxX3BhcmFtLnNpemlu
Zy5ycV9sKTsKKworCXJxX3JlZ3MtPnJxX3JlZ3NfbC5wdGVfcm93X2hlaWdodF9saW5lYXIgPSBk
bWxfZmxvb3IoZG1sX2xvZzIocnFfcGFyYW0uZGxnLnJxX2wuZHB0ZV9yb3dfaGVpZ2h0KSwKKwkJ
CTEpIC0gMzsKKworCWlmIChycV9wYXJhbS55dXY0MjApIHsKKwkJZXh0cmFjdF9ycV9zaXppbmdf
cmVncyhtb2RlX2xpYiwgJihycV9yZWdzLT5ycV9yZWdzX2MpLCBycV9wYXJhbS5zaXppbmcucnFf
Yyk7CisJCXJxX3JlZ3MtPnJxX3JlZ3NfYy5wdGVfcm93X2hlaWdodF9saW5lYXIgPSBkbWxfZmxv
b3IoZG1sX2xvZzIocnFfcGFyYW0uZGxnLnJxX2MuZHB0ZV9yb3dfaGVpZ2h0KSwKKwkJCQkxKSAt
IDM7CisJfQorCisJcnFfcmVncy0+cnFfcmVnc19sLnN3YXRoX2hlaWdodCA9IGRtbF9sb2cyKHJx
X3BhcmFtLmRsZy5ycV9sLnN3YXRoX2hlaWdodCk7CisJcnFfcmVncy0+cnFfcmVnc19jLnN3YXRo
X2hlaWdodCA9IGRtbF9sb2cyKHJxX3BhcmFtLmRsZy5ycV9jLnN3YXRoX2hlaWdodCk7CisKKwkv
LyBGSVhNRTogdGFrZSB0aGUgbWF4IGJldHdlZW4gbHVtYSwgY2hyb21hIGNodW5rIHNpemU/CisJ
Ly8gb2theSBmb3Igbm93LCBhcyB3ZSBhcmUgc2V0dGluZyBjaHVua19ieXRlcyB0byA4a2IgYW55
d2F5cworCWlmIChycV9wYXJhbS5zaXppbmcucnFfbC5jaHVua19ieXRlcyA+PSAzMiAqIDEwMjQp
IHsgLy8zMmtiCisJCXJxX3JlZ3MtPmRycV9leHBhbnNpb25fbW9kZSA9IDA7CisJfSBlbHNlIHsK
KwkJcnFfcmVncy0+ZHJxX2V4cGFuc2lvbl9tb2RlID0gMjsKKwl9CisJcnFfcmVncy0+cHJxX2V4
cGFuc2lvbl9tb2RlID0gMTsKKwlycV9yZWdzLT5tcnFfZXhwYW5zaW9uX21vZGUgPSAxOworCXJx
X3JlZ3MtPmNycV9leHBhbnNpb25fbW9kZSA9IDE7CisKKwlpZiAocnFfcGFyYW0ueXV2NDIwKSB7
CisJCWlmICgoZG91YmxlKSBycV9wYXJhbS5taXNjLnJxX2wuc3RvcmVkX3N3YXRoX2J5dGVzCisJ
CQkJLyAoZG91YmxlKSBycV9wYXJhbS5taXNjLnJxX2Muc3RvcmVkX3N3YXRoX2J5dGVzIDw9IDEu
NSkgeworCQkJZGV0aWxlX2J1Zl9wbGFuZTFfYWRkciA9IChkZXRpbGVfYnVmX3NpemVfaW5fYnl0
ZXMgLyAyLjAgLyA2NC4wKTsgLy8gaGFsZiB0byBjaHJvbWEKKwkJfSBlbHNlIHsKKwkJCWRldGls
ZV9idWZfcGxhbmUxX2FkZHIgPSBkbWxfcm91bmRfdG9fbXVsdGlwbGUoKHVuc2lnbmVkIGludCkg
KCgyLjAgKiBkZXRpbGVfYnVmX3NpemVfaW5fYnl0ZXMpIC8gMy4wKSwKKwkJCQkJMjU2LAorCQkJ
CQkwKSAvIDY0LjA7IC8vIDIvMyB0byBjaHJvbWEKKwkJfQorCX0KKwlycV9yZWdzLT5wbGFuZTFf
YmFzZV9hZGRyZXNzID0gZGV0aWxlX2J1Zl9wbGFuZTFfYWRkcjsKK30KKworc3RhdGljIHZvaWQg
aGFuZGxlX2RldF9idWZfc3BsaXQoc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAor
CQlkaXNwbGF5X3JxX3BhcmFtc19zdCAqcnFfcGFyYW0sCisJCWNvbnN0IGRpc3BsYXlfcGlwZV9z
b3VyY2VfcGFyYW1zX3N0IHBpcGVfc3JjX3BhcmFtKQoreworCXVuc2lnbmVkIGludCB0b3RhbF9z
d2F0aF9ieXRlcyA9IDA7CisJdW5zaWduZWQgaW50IHN3YXRoX2J5dGVzX2wgPSAwOworCXVuc2ln
bmVkIGludCBzd2F0aF9ieXRlc19jID0gMDsKKwl1bnNpZ25lZCBpbnQgZnVsbF9zd2F0aF9ieXRl
c19wYWNrZWRfbCA9IDA7CisJdW5zaWduZWQgaW50IGZ1bGxfc3dhdGhfYnl0ZXNfcGFja2VkX2Mg
PSAwOworCWJvb2wgcmVxMTI4X2wgPSAwOworCWJvb2wgcmVxMTI4X2MgPSAwOworCWJvb2wgc3Vy
Zl9saW5lYXIgPSAocGlwZV9zcmNfcGFyYW0uc3dfbW9kZSA9PSBkbV9zd19saW5lYXIpOworCWJv
b2wgc3VyZl92ZXJ0ID0gKHBpcGVfc3JjX3BhcmFtLnNvdXJjZV9zY2FuID09IGRtX3ZlcnQpOwor
CXVuc2lnbmVkIGludCBsb2cyX3N3YXRoX2hlaWdodF9sID0gMDsKKwl1bnNpZ25lZCBpbnQgbG9n
Ml9zd2F0aF9oZWlnaHRfYyA9IDA7CisJdW5zaWduZWQgaW50IGRldGlsZV9idWZfc2l6ZV9pbl9i
eXRlcyA9IG1vZGVfbGliLT5pcC5kZXRfYnVmZmVyX3NpemVfa2J5dGVzICogMTAyNDsKKworCWZ1
bGxfc3dhdGhfYnl0ZXNfcGFja2VkX2wgPSBycV9wYXJhbS0+bWlzYy5ycV9sLmZ1bGxfc3dhdGhf
Ynl0ZXM7CisJZnVsbF9zd2F0aF9ieXRlc19wYWNrZWRfYyA9IHJxX3BhcmFtLT5taXNjLnJxX2Mu
ZnVsbF9zd2F0aF9ieXRlczsKKworCWlmIChycV9wYXJhbS0+eXV2NDIwXzEwYnBjKSB7CisJCWZ1
bGxfc3dhdGhfYnl0ZXNfcGFja2VkX2wgPSBkbWxfcm91bmRfdG9fbXVsdGlwbGUocnFfcGFyYW0t
Pm1pc2MucnFfbC5mdWxsX3N3YXRoX2J5dGVzICogMiAvIDMsCisJCQkJMjU2LAorCQkJCTEpICsg
MjU2OworCQlmdWxsX3N3YXRoX2J5dGVzX3BhY2tlZF9jID0gZG1sX3JvdW5kX3RvX211bHRpcGxl
KHJxX3BhcmFtLT5taXNjLnJxX2MuZnVsbF9zd2F0aF9ieXRlcyAqIDIgLyAzLAorCQkJCTI1NiwK
KwkJCQkxKSArIDI1NjsKKwl9CisKKwlpZiAocnFfcGFyYW0tPnl1djQyMCkgeworCQl0b3RhbF9z
d2F0aF9ieXRlcyA9IDIgKiBmdWxsX3N3YXRoX2J5dGVzX3BhY2tlZF9sICsgMiAqIGZ1bGxfc3dh
dGhfYnl0ZXNfcGFja2VkX2M7CisKKwkJaWYgKHRvdGFsX3N3YXRoX2J5dGVzIDw9IGRldGlsZV9i
dWZfc2l6ZV9pbl9ieXRlcykgeyAvL2Z1bGwgMjU2YiByZXF1ZXN0CisJCQlyZXExMjhfbCA9IDA7
CisJCQlyZXExMjhfYyA9IDA7CisJCQlzd2F0aF9ieXRlc19sID0gZnVsbF9zd2F0aF9ieXRlc19w
YWNrZWRfbDsKKwkJCXN3YXRoX2J5dGVzX2MgPSBmdWxsX3N3YXRoX2J5dGVzX3BhY2tlZF9jOwor
CQl9IGVsc2UgeyAvLzEyOGIgcmVxdWVzdCAoZm9yIGx1bWEgb25seSBmb3IgeXV2NDIwIDhicGMp
CisJCQlyZXExMjhfbCA9IDE7CisJCQlyZXExMjhfYyA9IDA7CisJCQlzd2F0aF9ieXRlc19sID0g
ZnVsbF9zd2F0aF9ieXRlc19wYWNrZWRfbCAvIDI7CisJCQlzd2F0aF9ieXRlc19jID0gZnVsbF9z
d2F0aF9ieXRlc19wYWNrZWRfYzsKKwkJfQorCQkvLyBOb3RlOiBhc3N1bXB0aW9uLCB0aGUgY29u
ZmlnIHRoYXQgcGFzcyBpbiB3aWxsIGZpdCBpbnRvCisJCS8vICAgICAgIHRoZSBkZXRpbGVkIGJ1
ZmZlci4KKwl9IGVsc2UgeworCQl0b3RhbF9zd2F0aF9ieXRlcyA9IDIgKiBmdWxsX3N3YXRoX2J5
dGVzX3BhY2tlZF9sOworCisJCWlmICh0b3RhbF9zd2F0aF9ieXRlcyA8PSBkZXRpbGVfYnVmX3Np
emVfaW5fYnl0ZXMpCisJCQlyZXExMjhfbCA9IDA7CisJCWVsc2UKKwkJCXJlcTEyOF9sID0gMTsK
KworCQlzd2F0aF9ieXRlc19sID0gdG90YWxfc3dhdGhfYnl0ZXM7CisJCXN3YXRoX2J5dGVzX2Mg
PSAwOworCX0KKwlycV9wYXJhbS0+bWlzYy5ycV9sLnN0b3JlZF9zd2F0aF9ieXRlcyA9IHN3YXRo
X2J5dGVzX2w7CisJcnFfcGFyYW0tPm1pc2MucnFfYy5zdG9yZWRfc3dhdGhfYnl0ZXMgPSBzd2F0
aF9ieXRlc19jOworCisJaWYgKHN1cmZfbGluZWFyKSB7CisJCWxvZzJfc3dhdGhfaGVpZ2h0X2wg
PSAwOworCQlsb2cyX3N3YXRoX2hlaWdodF9jID0gMDsKKwl9IGVsc2UgaWYgKCFzdXJmX3ZlcnQp
IHsKKwkJbG9nMl9zd2F0aF9oZWlnaHRfbCA9IGRtbF9sb2cyKHJxX3BhcmFtLT5taXNjLnJxX2wu
YmxrMjU2X2hlaWdodCkgLSByZXExMjhfbDsKKwkJbG9nMl9zd2F0aF9oZWlnaHRfYyA9IGRtbF9s
b2cyKHJxX3BhcmFtLT5taXNjLnJxX2MuYmxrMjU2X2hlaWdodCkgLSByZXExMjhfYzsKKwl9IGVs
c2UgeworCQlsb2cyX3N3YXRoX2hlaWdodF9sID0gZG1sX2xvZzIocnFfcGFyYW0tPm1pc2MucnFf
bC5ibGsyNTZfd2lkdGgpIC0gcmVxMTI4X2w7CisJCWxvZzJfc3dhdGhfaGVpZ2h0X2MgPSBkbWxf
bG9nMihycV9wYXJhbS0+bWlzYy5ycV9jLmJsazI1Nl93aWR0aCkgLSByZXExMjhfYzsKKwl9CisJ
cnFfcGFyYW0tPmRsZy5ycV9sLnN3YXRoX2hlaWdodCA9IDEgPDwgbG9nMl9zd2F0aF9oZWlnaHRf
bDsKKwlycV9wYXJhbS0+ZGxnLnJxX2Muc3dhdGhfaGVpZ2h0ID0gMSA8PCBsb2cyX3N3YXRoX2hl
aWdodF9jOworCisJZG1sX3ByaW50KCJETUxfRExHOiAlczogcmVxMTI4X2wgPSAlMGRcbiIsIF9f
ZnVuY19fLCByZXExMjhfbCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogcmVxMTI4X2MgPSAl
MGRcbiIsIF9fZnVuY19fLCByZXExMjhfYyk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogZnVs
bF9zd2F0aF9ieXRlc19wYWNrZWRfbCA9ICUwZFxuIiwKKwkJCV9fZnVuY19fLAorCQkJZnVsbF9z
d2F0aF9ieXRlc19wYWNrZWRfbCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogZnVsbF9zd2F0
aF9ieXRlc19wYWNrZWRfYyA9ICUwZFxuIiwKKwkJCV9fZnVuY19fLAorCQkJZnVsbF9zd2F0aF9i
eXRlc19wYWNrZWRfYyk7Cit9CisKK3N0YXRpYyB2b2lkIGdldF9tZXRhX2FuZF9wdGVfYXR0cihz
dHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWRpc3BsYXlfZGF0YV9ycV9kbGdf
cGFyYW1zX3N0ICpycV9kbGdfcGFyYW0sCisJCWRpc3BsYXlfZGF0YV9ycV9taXNjX3BhcmFtc19z
dCAqcnFfbWlzY19wYXJhbSwKKwkJZGlzcGxheV9kYXRhX3JxX3NpemluZ19wYXJhbXNfc3QgKnJx
X3NpemluZ19wYXJhbSwKKwkJdW5zaWduZWQgaW50IHZwX3dpZHRoLAorCQl1bnNpZ25lZCBpbnQg
dnBfaGVpZ2h0LAorCQl1bnNpZ25lZCBpbnQgZGF0YV9waXRjaCwKKwkJdW5zaWduZWQgaW50IG1l
dGFfcGl0Y2gsCisJCXVuc2lnbmVkIGludCBzb3VyY2VfZm9ybWF0LAorCQl1bnNpZ25lZCBpbnQg
dGlsaW5nLAorCQl1bnNpZ25lZCBpbnQgbWFjcm9fdGlsZV9zaXplLAorCQl1bnNpZ25lZCBpbnQg
c291cmNlX3NjYW4sCisJCXVuc2lnbmVkIGludCBpc19jaHJvbWEpCit7CisJYm9vbCBzdXJmX2xp
bmVhciA9ICh0aWxpbmcgPT0gZG1fc3dfbGluZWFyKTsKKwlib29sIHN1cmZfdmVydCA9IChzb3Vy
Y2Vfc2NhbiA9PSBkbV92ZXJ0KTsKKworCXVuc2lnbmVkIGludCBieXRlc19wZXJfZWxlbWVudDsK
Kwl1bnNpZ25lZCBpbnQgYnl0ZXNfcGVyX2VsZW1lbnRfeSA9IGdldF9ieXRlc19wZXJfZWxlbWVu
dCgoZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNzKShzb3VyY2VfZm9ybWF0KSwKKwkJCWZhbHNlKTsK
Kwl1bnNpZ25lZCBpbnQgYnl0ZXNfcGVyX2VsZW1lbnRfYyA9IGdldF9ieXRlc19wZXJfZWxlbWVu
dCgoZW51bSBzb3VyY2VfZm9ybWF0X2NsYXNzKShzb3VyY2VfZm9ybWF0KSwKKwkJCXRydWUpOwor
CisJdW5zaWduZWQgaW50IGJsazI1Nl93aWR0aCA9IDA7CisJdW5zaWduZWQgaW50IGJsazI1Nl9o
ZWlnaHQgPSAwOworCisJdW5zaWduZWQgaW50IGJsazI1Nl93aWR0aF95ID0gMDsKKwl1bnNpZ25l
ZCBpbnQgYmxrMjU2X2hlaWdodF95ID0gMDsKKwl1bnNpZ25lZCBpbnQgYmxrMjU2X3dpZHRoX2Mg
PSAwOworCXVuc2lnbmVkIGludCBibGsyNTZfaGVpZ2h0X2MgPSAwOworCXVuc2lnbmVkIGludCBs
b2cyX2J5dGVzX3Blcl9lbGVtZW50OworCXVuc2lnbmVkIGludCBsb2cyX2JsazI1Nl93aWR0aDsK
Kwl1bnNpZ25lZCBpbnQgbG9nMl9ibGsyNTZfaGVpZ2h0OworCXVuc2lnbmVkIGludCBibGtfYnl0
ZXM7CisJdW5zaWduZWQgaW50IGxvZzJfYmxrX2J5dGVzOworCXVuc2lnbmVkIGludCBsb2cyX2Js
a19oZWlnaHQ7CisJdW5zaWduZWQgaW50IGxvZzJfYmxrX3dpZHRoOworCXVuc2lnbmVkIGludCBs
b2cyX21ldGFfcmVxX2J5dGVzOworCXVuc2lnbmVkIGludCBsb2cyX21ldGFfcmVxX2hlaWdodDsK
Kwl1bnNpZ25lZCBpbnQgbG9nMl9tZXRhX3JlcV93aWR0aDsKKwl1bnNpZ25lZCBpbnQgbWV0YV9y
ZXFfd2lkdGg7CisJdW5zaWduZWQgaW50IG1ldGFfcmVxX2hlaWdodDsKKwl1bnNpZ25lZCBpbnQg
bG9nMl9tZXRhX3Jvd19oZWlnaHQ7CisJdW5zaWduZWQgaW50IG1ldGFfcm93X3dpZHRoX3ViOwor
CXVuc2lnbmVkIGludCBsb2cyX21ldGFfY2h1bmtfYnl0ZXM7CisJdW5zaWduZWQgaW50IGxvZzJf
bWV0YV9jaHVua19oZWlnaHQ7CisKKwkvL2Z1bGwgc2l6ZWQgbWV0YSBjaHVuayB3aWR0aCBpbiB1
bml0IG9mIGRhdGEgZWxlbWVudHMKKwl1bnNpZ25lZCBpbnQgbG9nMl9tZXRhX2NodW5rX3dpZHRo
OworCXVuc2lnbmVkIGludCBsb2cyX21pbl9tZXRhX2NodW5rX2J5dGVzOworCXVuc2lnbmVkIGlu
dCBtaW5fbWV0YV9jaHVua193aWR0aDsKKwl1bnNpZ25lZCBpbnQgbWV0YV9jaHVua193aWR0aDsK
Kwl1bnNpZ25lZCBpbnQgbWV0YV9jaHVua19wZXJfcm93X2ludDsKKwl1bnNpZ25lZCBpbnQgbWV0
YV9yb3dfcmVtYWluZGVyOworCXVuc2lnbmVkIGludCBtZXRhX2NodW5rX3RocmVzaG9sZDsKKwl1
bnNpZ25lZCBpbnQgbWV0YV9ibGtfYnl0ZXM7CisJdW5zaWduZWQgaW50IG1ldGFfYmxrX2hlaWdo
dDsKKwl1bnNpZ25lZCBpbnQgbWV0YV9ibGtfd2lkdGg7CisJdW5zaWduZWQgaW50IG1ldGFfc3Vy
ZmFjZV9ieXRlczsKKwl1bnNpZ25lZCBpbnQgdm1wZ19ieXRlczsKKwl1bnNpZ25lZCBpbnQgbWV0
YV9wdGVfcmVxX3Blcl9mcmFtZV91YjsKKwl1bnNpZ25lZCBpbnQgbWV0YV9wdGVfYnl0ZXNfcGVy
X2ZyYW1lX3ViOworCWNvbnN0IHVuc2lnbmVkIGludCBsb2cyX3ZtcGdfYnl0ZXMgPSBkbWxfbG9n
Mihtb2RlX2xpYi0+c29jLnZtbV9wYWdlX3NpemVfYnl0ZXMpOworCWNvbnN0IHVuc2lnbmVkIGlu
dCBkcHRlX2J1Zl9pbl9wdGVfcmVxcyA9IG1vZGVfbGliLT5pcC5kcHRlX2J1ZmZlcl9zaXplX2lu
X3B0ZV9yZXFzX2x1bWE7CisJY29uc3QgdW5zaWduZWQgaW50IHBkZV9wcm9jX2J1ZmZlcl9zaXpl
XzY0a19yZXFzID0KKwkJCW1vZGVfbGliLT5pcC5wZGVfcHJvY19idWZmZXJfc2l6ZV82NGtfcmVx
czsKKworCXVuc2lnbmVkIGludCBsb2cyX3ZtcGdfaGVpZ2h0ID0gMDsKKwl1bnNpZ25lZCBpbnQg
bG9nMl92bXBnX3dpZHRoID0gMDsKKwl1bnNpZ25lZCBpbnQgbG9nMl9kcHRlX3JlcV9oZWlnaHRf
cHRlcyA9IDA7CisJdW5zaWduZWQgaW50IGxvZzJfZHB0ZV9yZXFfaGVpZ2h0ID0gMDsKKwl1bnNp
Z25lZCBpbnQgbG9nMl9kcHRlX3JlcV93aWR0aCA9IDA7CisJdW5zaWduZWQgaW50IGxvZzJfZHB0
ZV9yb3dfaGVpZ2h0X2xpbmVhciA9IDA7CisJdW5zaWduZWQgaW50IGxvZzJfZHB0ZV9yb3dfaGVp
Z2h0ID0gMDsKKwl1bnNpZ25lZCBpbnQgbG9nMl9kcHRlX2dyb3VwX3dpZHRoID0gMDsKKwl1bnNp
Z25lZCBpbnQgZHB0ZV9yb3dfd2lkdGhfdWIgPSAwOworCXVuc2lnbmVkIGludCBkcHRlX3JlcV9o
ZWlnaHQgPSAwOworCXVuc2lnbmVkIGludCBkcHRlX3JlcV93aWR0aCA9IDA7CisJdW5zaWduZWQg
aW50IGRwdGVfZ3JvdXBfd2lkdGggPSAwOworCXVuc2lnbmVkIGludCBsb2cyX2RwdGVfZ3JvdXBf
Ynl0ZXMgPSAwOworCXVuc2lnbmVkIGludCBsb2cyX2RwdGVfZ3JvdXBfbGVuZ3RoID0gMDsKKwl1
bnNpZ25lZCBpbnQgcGRlX2J1Zl9lbnRyaWVzOworCWJvb2wgeXV2NDIwID0gKHNvdXJjZV9mb3Jt
YXQgPT0gZG1fNDIwXzggfHwgc291cmNlX2Zvcm1hdCA9PSBkbV80MjBfMTApOworCisJQ2FsY3Vs
YXRlMjU2QkJsb2NrU2l6ZXMoKGVudW0gc291cmNlX2Zvcm1hdF9jbGFzcykoc291cmNlX2Zvcm1h
dCksCisJCQkoZW51bSBkbV9zd2l6emxlX21vZGUpKHRpbGluZyksCisJCQlieXRlc19wZXJfZWxl
bWVudF95LAorCQkJYnl0ZXNfcGVyX2VsZW1lbnRfYywKKwkJCSZibGsyNTZfaGVpZ2h0X3ksCisJ
CQkmYmxrMjU2X2hlaWdodF9jLAorCQkJJmJsazI1Nl93aWR0aF95LAorCQkJJmJsazI1Nl93aWR0
aF9jKTsKKworCWlmICghaXNfY2hyb21hKSB7CisJCWJsazI1Nl93aWR0aCA9IGJsazI1Nl93aWR0
aF95OworCQlibGsyNTZfaGVpZ2h0ID0gYmxrMjU2X2hlaWdodF95OworCQlieXRlc19wZXJfZWxl
bWVudCA9IGJ5dGVzX3Blcl9lbGVtZW50X3k7CisJfSBlbHNlIHsKKwkJYmxrMjU2X3dpZHRoID0g
YmxrMjU2X3dpZHRoX2M7CisJCWJsazI1Nl9oZWlnaHQgPSBibGsyNTZfaGVpZ2h0X2M7CisJCWJ5
dGVzX3Blcl9lbGVtZW50ID0gYnl0ZXNfcGVyX2VsZW1lbnRfYzsKKwl9CisKKwlsb2cyX2J5dGVz
X3Blcl9lbGVtZW50ID0gZG1sX2xvZzIoYnl0ZXNfcGVyX2VsZW1lbnQpOworCisJZG1sX3ByaW50
KCJETUxfRExHOiAlczogc3VyZl9saW5lYXIgICAgICAgID0gJWRcbiIsIF9fZnVuY19fLCBzdXJm
X2xpbmVhcik7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogc3VyZl92ZXJ0ICAgICAgICAgID0g
JWRcbiIsIF9fZnVuY19fLCBzdXJmX3ZlcnQpOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IGJs
azI1Nl93aWR0aCAgICAgICA9ICVkXG4iLCBfX2Z1bmNfXywgYmxrMjU2X3dpZHRoKTsKKwlkbWxf
cHJpbnQoIkRNTF9ETEc6ICVzOiBibGsyNTZfaGVpZ2h0ICAgICAgPSAlZFxuIiwgX19mdW5jX18s
IGJsazI1Nl9oZWlnaHQpOworCisJbG9nMl9ibGsyNTZfd2lkdGggPSBkbWxfbG9nMigoZG91Ymxl
KSBibGsyNTZfd2lkdGgpOworCWxvZzJfYmxrMjU2X2hlaWdodCA9IGRtbF9sb2cyKChkb3VibGUp
IGJsazI1Nl9oZWlnaHQpOworCWJsa19ieXRlcyA9IHN1cmZfbGluZWFyID8KKwkJCTI1NiA6IGdl
dF9ibGtfc2l6ZV9ieXRlcygoZW51bSBzb3VyY2VfbWFjcm9fdGlsZV9zaXplKSBtYWNyb190aWxl
X3NpemUpOworCWxvZzJfYmxrX2J5dGVzID0gZG1sX2xvZzIoKGRvdWJsZSkgYmxrX2J5dGVzKTsK
Kwlsb2cyX2Jsa19oZWlnaHQgPSAwOworCWxvZzJfYmxrX3dpZHRoID0gMDsKKworCS8vIHJlbWVt
YmVyIGxvZyBydWxlCisJLy8gIisiIGluIGxvZyBpcyBtdWx0aXBseQorCS8vICItIiBpbiBsb2cg
aXMgZGl2aWRlCisJLy8gIi8yIiBpcyBsaWtlIHNxdWFyZSByb290CisJLy8gYmxrIGlzIHZlcnRp
Y2FsIGJpYXNlZAorCWlmICh0aWxpbmcgIT0gZG1fc3dfbGluZWFyKQorCQlsb2cyX2Jsa19oZWln
aHQgPSBsb2cyX2JsazI1Nl9oZWlnaHQKKwkJCQkrIGRtbF9jZWlsKChkb3VibGUpIChsb2cyX2Js
a19ieXRlcyAtIDgpIC8gMi4wLCAxKTsKKwllbHNlCisJCWxvZzJfYmxrX2hlaWdodCA9IDA7ICAv
LyBibGsgaGVpZ2h0IG9mIDEKKworCWxvZzJfYmxrX3dpZHRoID0gbG9nMl9ibGtfYnl0ZXMgLSBs
b2cyX2J5dGVzX3Blcl9lbGVtZW50IC0gbG9nMl9ibGtfaGVpZ2h0OworCisJaWYgKCFzdXJmX3Zl
cnQpIHsKKwkJcnFfZGxnX3BhcmFtLT5zd2F0aF93aWR0aF91YiA9IGRtbF9yb3VuZF90b19tdWx0
aXBsZSh2cF93aWR0aCAtIDEsIGJsazI1Nl93aWR0aCwgMSkKKwkJCQkrIGJsazI1Nl93aWR0aDsK
KwkJcnFfZGxnX3BhcmFtLT5yZXFfcGVyX3N3YXRoX3ViID0gcnFfZGxnX3BhcmFtLT5zd2F0aF93
aWR0aF91YiA+PiBsb2cyX2JsazI1Nl93aWR0aDsKKwl9IGVsc2UgeworCQlycV9kbGdfcGFyYW0t
PnN3YXRoX3dpZHRoX3ViID0gZG1sX3JvdW5kX3RvX211bHRpcGxlKHZwX2hlaWdodCAtIDEsIGJs
azI1Nl9oZWlnaHQsIDEpCisJCQkJKyBibGsyNTZfaGVpZ2h0OworCQlycV9kbGdfcGFyYW0tPnJl
cV9wZXJfc3dhdGhfdWIgPSBycV9kbGdfcGFyYW0tPnN3YXRoX3dpZHRoX3ViID4+IGxvZzJfYmxr
MjU2X2hlaWdodDsKKwl9CisKKwlpZiAoIXN1cmZfdmVydCkKKwkJcnFfbWlzY19wYXJhbS0+ZnVs
bF9zd2F0aF9ieXRlcyA9IHJxX2RsZ19wYXJhbS0+c3dhdGhfd2lkdGhfdWIgKiBibGsyNTZfaGVp
Z2h0CisJCQkJKiBieXRlc19wZXJfZWxlbWVudDsKKwllbHNlCisJCXJxX21pc2NfcGFyYW0tPmZ1
bGxfc3dhdGhfYnl0ZXMgPSBycV9kbGdfcGFyYW0tPnN3YXRoX3dpZHRoX3ViICogYmxrMjU2X3dp
ZHRoCisJCQkJKiBieXRlc19wZXJfZWxlbWVudDsKKworCXJxX21pc2NfcGFyYW0tPmJsazI1Nl9o
ZWlnaHQgPSBibGsyNTZfaGVpZ2h0OworCXJxX21pc2NfcGFyYW0tPmJsazI1Nl93aWR0aCA9IGJs
azI1Nl93aWR0aDsKKworCS8vIC0tLS0tLS0KKwkvLyBtZXRhCisJLy8gLS0tLS0tLQorCWxvZzJf
bWV0YV9yZXFfYnl0ZXMgPSA2OyAvLyBtZXRhIHJlcXVlc3QgaXMgNjRiIGFuZCBpcyA4eDhieXRl
IG1ldGEgZWxlbWVudAorCisJLy8gZWFjaCA2NGIgbWV0YSByZXF1ZXN0IGZvciBkY24gaXMgOHg4
IG1ldGEgZWxlbWVudHMgYW5kCisJLy8gYSBtZXRhIGVsZW1lbnQgY292ZXJzIG9uZSAyNTZiIGJs
b2NrIG9mIHRoZSB0aGUgZGF0YSBzdXJmYWNlLgorCWxvZzJfbWV0YV9yZXFfaGVpZ2h0ID0gbG9n
Ml9ibGsyNTZfaGVpZ2h0ICsgMzsgLy8gbWV0YSByZXEgaXMgOHg4IGJ5dGUsIGVhY2ggYnl0ZSBy
ZXByZXNlbnQgMSBibGsyNTYKKwlsb2cyX21ldGFfcmVxX3dpZHRoID0gbG9nMl9tZXRhX3JlcV9i
eXRlcyArIDggLSBsb2cyX2J5dGVzX3Blcl9lbGVtZW50CisJCQktIGxvZzJfbWV0YV9yZXFfaGVp
Z2h0OworCW1ldGFfcmVxX3dpZHRoID0gMSA8PCBsb2cyX21ldGFfcmVxX3dpZHRoOworCW1ldGFf
cmVxX2hlaWdodCA9IDEgPDwgbG9nMl9tZXRhX3JlcV9oZWlnaHQ7CisJbG9nMl9tZXRhX3Jvd19o
ZWlnaHQgPSAwOworCW1ldGFfcm93X3dpZHRoX3ViID0gMDsKKworCS8vIHRoZSBkaW1lbnNpb25z
IG9mIGEgbWV0YSByb3cgYXJlIG1ldGFfcm93X3dpZHRoIHggbWV0YV9yb3dfaGVpZ2h0IGluIGVs
ZW1lbnRzLgorCS8vIGNhbGN1bGF0ZSB1cHBlciBib3VuZCBvZiB0aGUgbWV0YV9yb3dfd2lkdGgK
KwlpZiAoIXN1cmZfdmVydCkgeworCQlsb2cyX21ldGFfcm93X2hlaWdodCA9IGxvZzJfbWV0YV9y
ZXFfaGVpZ2h0OworCQltZXRhX3Jvd193aWR0aF91YiA9IGRtbF9yb3VuZF90b19tdWx0aXBsZSh2
cF93aWR0aCAtIDEsIG1ldGFfcmVxX3dpZHRoLCAxKQorCQkJCSsgbWV0YV9yZXFfd2lkdGg7CisJ
CXJxX2RsZ19wYXJhbS0+bWV0YV9yZXFfcGVyX3Jvd191YiA9IG1ldGFfcm93X3dpZHRoX3ViIC8g
bWV0YV9yZXFfd2lkdGg7CisJfSBlbHNlIHsKKwkJbG9nMl9tZXRhX3Jvd19oZWlnaHQgPSBsb2cy
X21ldGFfcmVxX3dpZHRoOworCQltZXRhX3Jvd193aWR0aF91YiA9IGRtbF9yb3VuZF90b19tdWx0
aXBsZSh2cF9oZWlnaHQgLSAxLCBtZXRhX3JlcV9oZWlnaHQsIDEpCisJCQkJKyBtZXRhX3JlcV9o
ZWlnaHQ7CisJCXJxX2RsZ19wYXJhbS0+bWV0YV9yZXFfcGVyX3Jvd191YiA9IG1ldGFfcm93X3dp
ZHRoX3ViIC8gbWV0YV9yZXFfaGVpZ2h0OworCX0KKwlycV9kbGdfcGFyYW0tPm1ldGFfYnl0ZXNf
cGVyX3Jvd191YiA9IHJxX2RsZ19wYXJhbS0+bWV0YV9yZXFfcGVyX3Jvd191YiAqIDY0OworCisJ
cnFfZGxnX3BhcmFtLT5tZXRhX3Jvd19oZWlnaHQgPSAxIDw8IGxvZzJfbWV0YV9yb3dfaGVpZ2h0
OworCisJbG9nMl9tZXRhX2NodW5rX2J5dGVzID0gZG1sX2xvZzIocnFfc2l6aW5nX3BhcmFtLT5t
ZXRhX2NodW5rX2J5dGVzKTsKKwlsb2cyX21ldGFfY2h1bmtfaGVpZ2h0ID0gbG9nMl9tZXRhX3Jv
d19oZWlnaHQ7CisKKwkvL2Z1bGwgc2l6ZWQgbWV0YSBjaHVuayB3aWR0aCBpbiB1bml0IG9mIGRh
dGEgZWxlbWVudHMKKwlsb2cyX21ldGFfY2h1bmtfd2lkdGggPSBsb2cyX21ldGFfY2h1bmtfYnl0
ZXMgKyA4IC0gbG9nMl9ieXRlc19wZXJfZWxlbWVudAorCQkJLSBsb2cyX21ldGFfY2h1bmtfaGVp
Z2h0OworCWxvZzJfbWluX21ldGFfY2h1bmtfYnl0ZXMgPSBkbWxfbG9nMihycV9zaXppbmdfcGFy
YW0tPm1pbl9tZXRhX2NodW5rX2J5dGVzKTsKKwltaW5fbWV0YV9jaHVua193aWR0aCA9IDEKKwkJ
CTw8IChsb2cyX21pbl9tZXRhX2NodW5rX2J5dGVzICsgOCAtIGxvZzJfYnl0ZXNfcGVyX2VsZW1l
bnQKKwkJCQkJLSBsb2cyX21ldGFfY2h1bmtfaGVpZ2h0KTsKKwltZXRhX2NodW5rX3dpZHRoID0g
MSA8PCBsb2cyX21ldGFfY2h1bmtfd2lkdGg7CisJbWV0YV9jaHVua19wZXJfcm93X2ludCA9ICh1
bnNpZ25lZCBpbnQpIChtZXRhX3Jvd193aWR0aF91YiAvIG1ldGFfY2h1bmtfd2lkdGgpOworCW1l
dGFfcm93X3JlbWFpbmRlciA9IG1ldGFfcm93X3dpZHRoX3ViICUgbWV0YV9jaHVua193aWR0aDsK
KwltZXRhX2NodW5rX3RocmVzaG9sZCA9IDA7CisJbWV0YV9ibGtfYnl0ZXMgPSA0MDk2OworCW1l
dGFfYmxrX2hlaWdodCA9IGJsazI1Nl9oZWlnaHQgKiA2NDsKKwltZXRhX2Jsa193aWR0aCA9IG1l
dGFfYmxrX2J5dGVzICogMjU2IC8gYnl0ZXNfcGVyX2VsZW1lbnQgLyBtZXRhX2Jsa19oZWlnaHQ7
CisJbWV0YV9zdXJmYWNlX2J5dGVzID0gbWV0YV9waXRjaAorCQkJKiAoZG1sX3JvdW5kX3RvX211
bHRpcGxlKHZwX2hlaWdodCAtIDEsIG1ldGFfYmxrX2hlaWdodCwgMSkgKyBtZXRhX2Jsa19oZWln
aHQpCisJCQkqIGJ5dGVzX3Blcl9lbGVtZW50IC8gMjU2OworCXZtcGdfYnl0ZXMgPSBtb2RlX2xp
Yi0+c29jLnZtbV9wYWdlX3NpemVfYnl0ZXM7CisJbWV0YV9wdGVfcmVxX3Blcl9mcmFtZV91YiA9
IChkbWxfcm91bmRfdG9fbXVsdGlwbGUobWV0YV9zdXJmYWNlX2J5dGVzIC0gdm1wZ19ieXRlcywK
KwkJCTggKiB2bXBnX2J5dGVzLAorCQkJMSkgKyA4ICogdm1wZ19ieXRlcykgLyAoOCAqIHZtcGdf
Ynl0ZXMpOworCW1ldGFfcHRlX2J5dGVzX3Blcl9mcmFtZV91YiA9IG1ldGFfcHRlX3JlcV9wZXJf
ZnJhbWVfdWIgKiA2NDsgLy82NEIgbXB0ZSByZXF1ZXN0CisJcnFfZGxnX3BhcmFtLT5tZXRhX3B0
ZV9ieXRlc19wZXJfZnJhbWVfdWIgPSBtZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWI7CisKKwlk
bWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBtZXRhX2Jsa19oZWlnaHQgICAgICAgICAgICAgPSAlZFxu
IiwgX19mdW5jX18sIG1ldGFfYmxrX2hlaWdodCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczog
bWV0YV9ibGtfd2lkdGggICAgICAgICAgICAgID0gJWRcbiIsIF9fZnVuY19fLCBtZXRhX2Jsa193
aWR0aCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogbWV0YV9zdXJmYWNlX2J5dGVzICAgICAg
ICAgID0gJWRcbiIsIF9fZnVuY19fLCBtZXRhX3N1cmZhY2VfYnl0ZXMpOworCWRtbF9wcmludCgi
RE1MX0RMRzogJXM6IG1ldGFfcHRlX3JlcV9wZXJfZnJhbWVfdWIgICA9ICVkXG4iLAorCQkJX19m
dW5jX18sCisJCQltZXRhX3B0ZV9yZXFfcGVyX2ZyYW1lX3ViKTsKKwlkbWxfcHJpbnQoIkRNTF9E
TEc6ICVzOiBtZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWIgPSAlZFxuIiwKKwkJCV9fZnVuY19f
LAorCQkJbWV0YV9wdGVfYnl0ZXNfcGVyX2ZyYW1lX3ViKTsKKworCWlmICghc3VyZl92ZXJ0KQor
CQltZXRhX2NodW5rX3RocmVzaG9sZCA9IDIgKiBtaW5fbWV0YV9jaHVua193aWR0aCAtIG1ldGFf
cmVxX3dpZHRoOworCWVsc2UKKwkJbWV0YV9jaHVua190aHJlc2hvbGQgPSAyICogbWluX21ldGFf
Y2h1bmtfd2lkdGggLSBtZXRhX3JlcV9oZWlnaHQ7CisKKwlpZiAobWV0YV9yb3dfcmVtYWluZGVy
IDw9IG1ldGFfY2h1bmtfdGhyZXNob2xkKQorCQlycV9kbGdfcGFyYW0tPm1ldGFfY2h1bmtzX3Bl
cl9yb3dfdWIgPSBtZXRhX2NodW5rX3Blcl9yb3dfaW50ICsgMTsKKwllbHNlCisJCXJxX2RsZ19w
YXJhbS0+bWV0YV9jaHVua3NfcGVyX3Jvd191YiA9IG1ldGFfY2h1bmtfcGVyX3Jvd19pbnQgKyAy
OworCisJLy8gLS0tLS0tCisJLy8gZHB0ZQorCS8vIC0tLS0tLQorCWlmIChzdXJmX2xpbmVhcikg
eworCQlsb2cyX3ZtcGdfaGVpZ2h0ID0gMDsgICAvLyBvbmUgbGluZSBoaWdoCisJfSBlbHNlIHsK
KwkJbG9nMl92bXBnX2hlaWdodCA9IChsb2cyX3ZtcGdfYnl0ZXMgLSA4KSAvIDIgKyBsb2cyX2Js
azI1Nl9oZWlnaHQ7CisJfQorCWxvZzJfdm1wZ193aWR0aCA9IGxvZzJfdm1wZ19ieXRlcyAtIGxv
ZzJfYnl0ZXNfcGVyX2VsZW1lbnQgLSBsb2cyX3ZtcGdfaGVpZ2h0OworCisJLy8gb25seSAzIHBv
c3NpYmxlIHNoYXBlcyBmb3IgZHB0ZSByZXF1ZXN0IGluIGRpbWVuc2lvbnMgb2YgcHRlczogOHgx
LCA0eDIsIDJ4NC4KKwlpZiAoc3VyZl9saW5lYXIpIHsgLy9vbmUgNjRCIFBURSByZXF1ZXN0IHJl
dHVybnMgOCBQVEVzCisJCWxvZzJfZHB0ZV9yZXFfaGVpZ2h0X3B0ZXMgPSAwOworCQlsb2cyX2Rw
dGVfcmVxX3dpZHRoID0gbG9nMl92bXBnX3dpZHRoICsgMzsKKwkJbG9nMl9kcHRlX3JlcV9oZWln
aHQgPSAwOworCX0gZWxzZSBpZiAobG9nMl9ibGtfYnl0ZXMgPT0gMTIpIHsgLy80S0IgdGlsZSBt
ZWFucyA0a0IgcGFnZSBzaXplCisJCS8vb25lIDY0QiByZXEgZ2l2ZXMgOHgxIFBURXMgZm9yIDRL
QiB0aWxlCisJCWxvZzJfZHB0ZV9yZXFfaGVpZ2h0X3B0ZXMgPSAwOworCQlsb2cyX2RwdGVfcmVx
X3dpZHRoID0gbG9nMl9ibGtfd2lkdGggKyAzOworCQlsb2cyX2RwdGVfcmVxX2hlaWdodCA9IGxv
ZzJfYmxrX2hlaWdodCArIDA7CisJfSBlbHNlIGlmICgobG9nMl9ibGtfYnl0ZXMgPj0gMTYpICYm
IChsb2cyX3ZtcGdfYnl0ZXMgPT0gMTIpKSB7IC8vIHRpbGUgYmxvY2sgPj0gNjRLQgorCQkvL3R3
byA2NEIgcmVxcyBvZiAyeDQgUFRFcyBnaXZlIDE2IFBURXMgdG8gY292ZXIgNjRLQgorCQlsb2cy
X2RwdGVfcmVxX2hlaWdodF9wdGVzID0gNDsKKwkJbG9nMl9kcHRlX3JlcV93aWR0aCA9IGxvZzJf
YmxrMjU2X3dpZHRoICsgNDsgLy8gbG9nMl82NEtCX3dpZHRoCisJCWxvZzJfZHB0ZV9yZXFfaGVp
Z2h0ID0gbG9nMl9ibGsyNTZfaGVpZ2h0ICsgNDsgLy8gbG9nMl82NEtCX2hlaWdodAorCX0gZWxz
ZSB7IC8vNjRLQiBwYWdlIHNpemUgYW5kIG11c3QgNjRLQiB0aWxlIGJsb2NrCisJCSAvL29uZSA2
NEIgcmVxIGdpdmVzIDh4MSBQVEVzIGZvciA2NEtCIHRpbGUKKwkJbG9nMl9kcHRlX3JlcV9oZWln
aHRfcHRlcyA9IDA7CisJCWxvZzJfZHB0ZV9yZXFfd2lkdGggPSBsb2cyX2Jsa193aWR0aCArIDM7
CisJCWxvZzJfZHB0ZV9yZXFfaGVpZ2h0ID0gbG9nMl9ibGtfaGVpZ2h0ICsgMDsKKwl9CisKKwkv
LyBUaGUgZHB0ZSByZXF1ZXN0IGRpbWVuc2lvbnMgaW4gZGF0YSBlbGVtZW50cyBpcyBkcHRlX3Jl
cV93aWR0aCB4IGRwdGVfcmVxX2hlaWdodAorCS8vIGxvZzJfdm1wZ193aWR0aCBpcyBob3cgbXVj
aCAxIHB0ZSByZXByZXNlbnQsIG5vdyBjYWxjdWxhdGluZyBob3cgbXVjaCBhIDY0YiBwdGUgcmVx
IHJlcHJlc2VudAorCS8vIFRoYXQgZGVwZW5kcyBvbiB0aGUgcHRlIHNoYXBlIChpLmUuIDh4MSwg
NHgyLCAyeDQpCisJLy9sb2cyX2RwdGVfcmVxX2hlaWdodCAgICA9IGxvZzJfdm1wZ19oZWlnaHQg
KyBsb2cyX2RwdGVfcmVxX2hlaWdodF9wdGVzOworCS8vbG9nMl9kcHRlX3JlcV93aWR0aCAgICAg
PSBsb2cyX3ZtcGdfd2lkdGggKyBsb2cyX2RwdGVfcmVxX3dpZHRoX3B0ZXM7CisJZHB0ZV9yZXFf
aGVpZ2h0ID0gMSA8PCBsb2cyX2RwdGVfcmVxX2hlaWdodDsKKwlkcHRlX3JlcV93aWR0aCA9IDEg
PDwgbG9nMl9kcHRlX3JlcV93aWR0aDsKKworCS8vIGNhbGN1bGF0ZSBwaXRjaCBkcHRlIHJvdyBi
dWZmZXIgY2FuIGhvbGQKKwkvLyByb3VuZCB0aGUgcmVzdWx0IGRvd24gdG8gYSBwb3dlciBvZiB0
d28uCisJcGRlX2J1Zl9lbnRyaWVzID0geXV2NDIwID8gKHBkZV9wcm9jX2J1ZmZlcl9zaXplXzY0
a19yZXFzID4+IDEpIDogcGRlX3Byb2NfYnVmZmVyX3NpemVfNjRrX3JlcXM7CisJaWYgKHN1cmZf
bGluZWFyKSB7CisJCXVuc2lnbmVkIGludCBkcHRlX3Jvd19oZWlnaHQ7CisKKwkJbG9nMl9kcHRl
X3Jvd19oZWlnaHRfbGluZWFyID0gZG1sX2Zsb29yKGRtbF9sb2cyKGRtbF9taW4oNjQgKiAxMDI0
ICogcGRlX2J1Zl9lbnRyaWVzCisJCQkJCQkJCQkJLyBieXRlc19wZXJfZWxlbWVudCwKKwkJCQkJ
CQkJZHB0ZV9idWZfaW5fcHRlX3JlcXMKKwkJCQkJCQkJCQkqIGRwdGVfcmVxX3dpZHRoKQorCQkJ
CQkJCQkvIGRhdGFfcGl0Y2gpLAorCQkJCTEpOworCisJCUFTU0VSVChsb2cyX2RwdGVfcm93X2hl
aWdodF9saW5lYXIgPj0gMyk7CisKKwkJaWYgKGxvZzJfZHB0ZV9yb3dfaGVpZ2h0X2xpbmVhciA+
IDcpCisJCQlsb2cyX2RwdGVfcm93X2hlaWdodF9saW5lYXIgPSA3OworCisJCWxvZzJfZHB0ZV9y
b3dfaGVpZ2h0ID0gbG9nMl9kcHRlX3Jvd19oZWlnaHRfbGluZWFyOworCQkvLyBGb3IgbGluZWFy
LCB0aGUgZHB0ZSByb3cgaXMgcGl0Y2ggZGVwZW5kZW50IGFuZCB0aGUgcHRlIHJlcXVlc3RzIHdy
YXAgYXQgdGhlIHBpdGNoIGJvdW5kYXJ5LgorCQkvLyB0aGUgZHB0ZV9yb3dfd2lkdGhfdWIgaXMg
dGhlIHVwcGVyIGJvdW5kIG9mIGRhdGFfcGl0Y2gqZHB0ZV9yb3dfaGVpZ2h0IGluIGVsZW1lbnRz
IHdpdGggdGhpcyB1bmlxdWUgYnVmZmVyaW5nLgorCQlkcHRlX3Jvd19oZWlnaHQgPSAxIDw8IGxv
ZzJfZHB0ZV9yb3dfaGVpZ2h0OworCQlkcHRlX3Jvd193aWR0aF91YiA9IGRtbF9yb3VuZF90b19t
dWx0aXBsZShkYXRhX3BpdGNoICogZHB0ZV9yb3dfaGVpZ2h0IC0gMSwKKwkJCQlkcHRlX3JlcV93
aWR0aCwKKwkJCQkxKSArIGRwdGVfcmVxX3dpZHRoOworCQlycV9kbGdfcGFyYW0tPmRwdGVfcmVx
X3Blcl9yb3dfdWIgPSBkcHRlX3Jvd193aWR0aF91YiAvIGRwdGVfcmVxX3dpZHRoOworCX0gZWxz
ZSB7CisJCS8vIHRoZSB1cHBlciBib3VuZCBvZiB0aGUgZHB0ZV9yb3dfd2lkdGggd2l0aG91dCBk
ZXBlbmRlbmN5IG9uIHZpZXdwb3J0IHBvc2l0aW9uIGZvbGxvd3MuCisJCS8vIGZvciB0aWxlZCBt
b2RlLCByb3cgaGVpZ2h0IGlzIHRoZSBzYW1lIGFzIHJlcSBoZWlnaHQgYW5kIHJvdyBzdG9yZSB1
cCB0byB2cCBzaXplIHVwcGVyIGJvdW5kCisJCWlmICghc3VyZl92ZXJ0KSB7CisJCQlsb2cyX2Rw
dGVfcm93X2hlaWdodCA9IGxvZzJfZHB0ZV9yZXFfaGVpZ2h0OworCQkJZHB0ZV9yb3dfd2lkdGhf
dWIgPSBkbWxfcm91bmRfdG9fbXVsdGlwbGUodnBfd2lkdGggLSAxLCBkcHRlX3JlcV93aWR0aCwg
MSkKKwkJCQkJKyBkcHRlX3JlcV93aWR0aDsKKwkJCXJxX2RsZ19wYXJhbS0+ZHB0ZV9yZXFfcGVy
X3Jvd191YiA9IGRwdGVfcm93X3dpZHRoX3ViIC8gZHB0ZV9yZXFfd2lkdGg7CisJCX0gZWxzZSB7
CisJCQlsb2cyX2RwdGVfcm93X2hlaWdodCA9CisJCQkJCShsb2cyX2Jsa193aWR0aCA8IGxvZzJf
ZHB0ZV9yZXFfd2lkdGgpID8KKwkJCQkJCQlsb2cyX2Jsa193aWR0aCA6IGxvZzJfZHB0ZV9yZXFf
d2lkdGg7CisJCQlkcHRlX3Jvd193aWR0aF91YiA9IGRtbF9yb3VuZF90b19tdWx0aXBsZSh2cF9o
ZWlnaHQgLSAxLCBkcHRlX3JlcV9oZWlnaHQsIDEpCisJCQkJCSsgZHB0ZV9yZXFfaGVpZ2h0Owor
CQkJcnFfZGxnX3BhcmFtLT5kcHRlX3JlcV9wZXJfcm93X3ViID0gZHB0ZV9yb3dfd2lkdGhfdWIg
LyBkcHRlX3JlcV9oZWlnaHQ7CisJCX0KKwl9CisJaWYgKGxvZzJfYmxrX2J5dGVzID49IDE2ICYm
IGxvZzJfdm1wZ19ieXRlcyA9PSAxMikgLy8gdGlsZSBibG9jayA+PSA2NEtCCisJCXJxX2RsZ19w
YXJhbS0+ZHB0ZV9ieXRlc19wZXJfcm93X3ViID0gcnFfZGxnX3BhcmFtLT5kcHRlX3JlcV9wZXJf
cm93X3ViICogMTI4OyAvLzIqNjRCIGRwdGUgcmVxdWVzdAorCWVsc2UKKwkJcnFfZGxnX3BhcmFt
LT5kcHRlX2J5dGVzX3Blcl9yb3dfdWIgPSBycV9kbGdfcGFyYW0tPmRwdGVfcmVxX3Blcl9yb3df
dWIgKiA2NDsgLy82NEIgZHB0ZSByZXF1ZXN0CisKKwlycV9kbGdfcGFyYW0tPmRwdGVfcm93X2hl
aWdodCA9IDEgPDwgbG9nMl9kcHRlX3Jvd19oZWlnaHQ7CisKKwkvLyB0aGUgZHB0ZV9ncm91cF9i
eXRlcyBpcyByZWR1Y2VkIGZvciB0aGUgc3BlY2lmaWMgY2FzZSBvZiB2ZXJ0aWNhbAorCS8vIGFj
Y2VzcyBvZiBhIHRpbGUgc3VyZmFjZSB0aGF0IGhhcyBkcHRlIHJlcXVlc3Qgb2YgOHgxIHB0ZXMu
CisJaWYgKCFzdXJmX2xpbmVhciAmIChsb2cyX2RwdGVfcmVxX2hlaWdodF9wdGVzID09IDApICYg
c3VyZl92ZXJ0KSAvL3JlZHVjZWQsIGluIHRoaXMgY2FzZSwgd2lsbCBoYXZlIHBhZ2UgZmF1bHQg
d2l0aGluIGEgZ3JvdXAKKwkJcnFfc2l6aW5nX3BhcmFtLT5kcHRlX2dyb3VwX2J5dGVzID0gNTEy
OworCWVsc2UKKwkJLy9mdWxsIHNpemUKKwkJcnFfc2l6aW5nX3BhcmFtLT5kcHRlX2dyb3VwX2J5
dGVzID0gMjA0ODsKKworCS8vc2luY2UgcHRlIHJlcXVlc3Qgc2l6ZSBpcyA2NGJ5dGUsIHRoZSBu
dW1iZXIgb2YgZGF0YSBwdGUgcmVxdWVzdHMgcGVyIGZ1bGwgc2l6ZWQgZ3JvdXAgaXMgYXMgZm9s
bG93cy4KKwlsb2cyX2RwdGVfZ3JvdXBfYnl0ZXMgPSBkbWxfbG9nMihycV9zaXppbmdfcGFyYW0t
PmRwdGVfZ3JvdXBfYnl0ZXMpOworCWxvZzJfZHB0ZV9ncm91cF9sZW5ndGggPSBsb2cyX2RwdGVf
Z3JvdXBfYnl0ZXMgLSA2OyAvL2xlbmd0aCBpbiA2NGIgcmVxdWVzdHMKKworCS8vIGZ1bGwgc2l6
ZWQgZGF0YSBwdGUgZ3JvdXAgd2lkdGggaW4gZWxlbWVudHMKKwlpZiAoIXN1cmZfdmVydCkKKwkJ
bG9nMl9kcHRlX2dyb3VwX3dpZHRoID0gbG9nMl9kcHRlX2dyb3VwX2xlbmd0aCArIGxvZzJfZHB0
ZV9yZXFfd2lkdGg7CisJZWxzZQorCQlsb2cyX2RwdGVfZ3JvdXBfd2lkdGggPSBsb2cyX2RwdGVf
Z3JvdXBfbGVuZ3RoICsgbG9nMl9kcHRlX3JlcV9oZWlnaHQ7CisKKwkvL0J1dCBpZiB0aGUgdGls
ZSBibG9jayA+PTY0S0IgYW5kIHRoZSBwYWdlIHNpemUgaXMgNEtCLCB0aGVuIGVhY2ggZFBURSBy
ZXF1ZXN0IGlzIDIqNjRCCisJaWYgKChsb2cyX2Jsa19ieXRlcyA+PSAxNikgJiYgKGxvZzJfdm1w
Z19ieXRlcyA9PSAxMikpIC8vIHRpbGUgYmxvY2sgPj0gNjRLQgorCQlsb2cyX2RwdGVfZ3JvdXBf
d2lkdGggPSBsb2cyX2RwdGVfZ3JvdXBfd2lkdGggLSAxOworCisJZHB0ZV9ncm91cF93aWR0aCA9
IDEgPDwgbG9nMl9kcHRlX2dyb3VwX3dpZHRoOworCisJLy8gc2luY2UgZHB0ZSBncm91cHMgYXJl
IG9ubHkgYWxpZ25lZCB0byBkcHRlX3JlcV93aWR0aCBhbmQgbm90IGRwdGVfZ3JvdXBfd2lkdGgs
CisJLy8gdGhlIHVwcGVyIGJvdW5kIGZvciB0aGUgZHB0ZSBncm91cHMgcGVyIHJvdyBpcyBhcyBm
b2xsb3dzLgorCXJxX2RsZ19wYXJhbS0+ZHB0ZV9ncm91cHNfcGVyX3Jvd191YiA9IGRtbF9jZWls
KChkb3VibGUpIGRwdGVfcm93X3dpZHRoX3ViIC8gZHB0ZV9ncm91cF93aWR0aCwKKwkJCTEpOwor
fQorCitzdGF0aWMgdm9pZCBnZXRfc3VyZl9ycV9wYXJhbShzdHJ1Y3QgZGlzcGxheV9tb2RlX2xp
YiAqbW9kZV9saWIsCisJCWRpc3BsYXlfZGF0YV9ycV9zaXppbmdfcGFyYW1zX3N0ICpycV9zaXpp
bmdfcGFyYW0sCisJCWRpc3BsYXlfZGF0YV9ycV9kbGdfcGFyYW1zX3N0ICpycV9kbGdfcGFyYW0s
CisJCWRpc3BsYXlfZGF0YV9ycV9taXNjX3BhcmFtc19zdCAqcnFfbWlzY19wYXJhbSwKKwkJY29u
c3QgZGlzcGxheV9waXBlX3NvdXJjZV9wYXJhbXNfc3QgcGlwZV9zcmNfcGFyYW0sCisJCWJvb2wg
aXNfY2hyb21hKQoreworCWJvb2wgbW9kZV80MjIgPSAwOworCXVuc2lnbmVkIGludCB2cF93aWR0
aCA9IDA7CisJdW5zaWduZWQgaW50IHZwX2hlaWdodCA9IDA7CisJdW5zaWduZWQgaW50IGRhdGFf
cGl0Y2ggPSAwOworCXVuc2lnbmVkIGludCBtZXRhX3BpdGNoID0gMDsKKwl1bnNpZ25lZCBpbnQg
cHBlID0gbW9kZV80MjIgPyAyIDogMTsKKworCS8vIEZJWE1FIGNoZWNrIGlmIHBwZSBhcHBseSBm
b3IgYm90aCBsdW1hIGFuZCBjaHJvbWEgaW4gNDIyIGNhc2UKKwlpZiAoaXNfY2hyb21hKSB7CisJ
CXZwX3dpZHRoID0gcGlwZV9zcmNfcGFyYW0udmlld3BvcnRfd2lkdGhfYyAvIHBwZTsKKwkJdnBf
aGVpZ2h0ID0gcGlwZV9zcmNfcGFyYW0udmlld3BvcnRfaGVpZ2h0X2M7CisJCWRhdGFfcGl0Y2gg
PSBwaXBlX3NyY19wYXJhbS5kYXRhX3BpdGNoX2M7CisJCW1ldGFfcGl0Y2ggPSBwaXBlX3NyY19w
YXJhbS5tZXRhX3BpdGNoX2M7CisJfSBlbHNlIHsKKwkJdnBfd2lkdGggPSBwaXBlX3NyY19wYXJh
bS52aWV3cG9ydF93aWR0aCAvIHBwZTsKKwkJdnBfaGVpZ2h0ID0gcGlwZV9zcmNfcGFyYW0udmll
d3BvcnRfaGVpZ2h0OworCQlkYXRhX3BpdGNoID0gcGlwZV9zcmNfcGFyYW0uZGF0YV9waXRjaDsK
KwkJbWV0YV9waXRjaCA9IHBpcGVfc3JjX3BhcmFtLm1ldGFfcGl0Y2g7CisJfQorCisJcnFfc2l6
aW5nX3BhcmFtLT5jaHVua19ieXRlcyA9IDgxOTI7CisKKwlpZiAocnFfc2l6aW5nX3BhcmFtLT5j
aHVua19ieXRlcyA9PSA2NCAqIDEwMjQpCisJCXJxX3NpemluZ19wYXJhbS0+bWluX2NodW5rX2J5
dGVzID0gMDsKKwllbHNlCisJCXJxX3NpemluZ19wYXJhbS0+bWluX2NodW5rX2J5dGVzID0gMTAy
NDsKKworCXJxX3NpemluZ19wYXJhbS0+bWV0YV9jaHVua19ieXRlcyA9IDIwNDg7CisJcnFfc2l6
aW5nX3BhcmFtLT5taW5fbWV0YV9jaHVua19ieXRlcyA9IDI1NjsKKworCXJxX3NpemluZ19wYXJh
bS0+bXB0ZV9ncm91cF9ieXRlcyA9IDIwNDg7CisKKwlnZXRfbWV0YV9hbmRfcHRlX2F0dHIobW9k
ZV9saWIsCisJCQlycV9kbGdfcGFyYW0sCisJCQlycV9taXNjX3BhcmFtLAorCQkJcnFfc2l6aW5n
X3BhcmFtLAorCQkJdnBfd2lkdGgsCisJCQl2cF9oZWlnaHQsCisJCQlkYXRhX3BpdGNoLAorCQkJ
bWV0YV9waXRjaCwKKwkJCXBpcGVfc3JjX3BhcmFtLnNvdXJjZV9mb3JtYXQsCisJCQlwaXBlX3Ny
Y19wYXJhbS5zd19tb2RlLAorCQkJcGlwZV9zcmNfcGFyYW0ubWFjcm9fdGlsZV9zaXplLAorCQkJ
cGlwZV9zcmNfcGFyYW0uc291cmNlX3NjYW4sCisJCQlpc19jaHJvbWEpOworfQorCitzdGF0aWMg
dm9pZCBkbWwyMHYyX3JxX2RsZ19nZXRfcnFfcGFyYW1zKHN0cnVjdCBkaXNwbGF5X21vZGVfbGli
ICptb2RlX2xpYiwKKwkJZGlzcGxheV9ycV9wYXJhbXNfc3QgKnJxX3BhcmFtLAorCQljb25zdCBk
aXNwbGF5X3BpcGVfc291cmNlX3BhcmFtc19zdCBwaXBlX3NyY19wYXJhbSkKK3sKKwkvLyBnZXQg
cGFyYW0gZm9yIGx1bWEgc3VyZmFjZQorCXJxX3BhcmFtLT55dXY0MjAgPSBwaXBlX3NyY19wYXJh
bS5zb3VyY2VfZm9ybWF0ID09IGRtXzQyMF84CisJCQl8fCBwaXBlX3NyY19wYXJhbS5zb3VyY2Vf
Zm9ybWF0ID09IGRtXzQyMF8xMDsKKwlycV9wYXJhbS0+eXV2NDIwXzEwYnBjID0gcGlwZV9zcmNf
cGFyYW0uc291cmNlX2Zvcm1hdCA9PSBkbV80MjBfMTA7CisKKwlnZXRfc3VyZl9ycV9wYXJhbSht
b2RlX2xpYiwKKwkJCSYocnFfcGFyYW0tPnNpemluZy5ycV9sKSwKKwkJCSYocnFfcGFyYW0tPmRs
Zy5ycV9sKSwKKwkJCSYocnFfcGFyYW0tPm1pc2MucnFfbCksCisJCQlwaXBlX3NyY19wYXJhbSwK
KwkJCTApOworCisJaWYgKGlzX2R1YWxfcGxhbmUoKGVudW0gc291cmNlX2Zvcm1hdF9jbGFzcyko
cGlwZV9zcmNfcGFyYW0uc291cmNlX2Zvcm1hdCkpKSB7CisJCS8vIGdldCBwYXJhbSBmb3IgY2hy
b21hIHN1cmZhY2UKKwkJZ2V0X3N1cmZfcnFfcGFyYW0obW9kZV9saWIsCisJCQkJJihycV9wYXJh
bS0+c2l6aW5nLnJxX2MpLAorCQkJCSYocnFfcGFyYW0tPmRsZy5ycV9jKSwKKwkJCQkmKHJxX3Bh
cmFtLT5taXNjLnJxX2MpLAorCQkJCXBpcGVfc3JjX3BhcmFtLAorCQkJCTEpOworCX0KKworCS8v
IGNhbGN1bGF0ZSBob3cgdG8gc3BsaXQgdGhlIGRldCBidWZmZXIgc3BhY2UgYmV0d2VlbiBsdW1h
IGFuZCBjaHJvbWEKKwloYW5kbGVfZGV0X2J1Zl9zcGxpdChtb2RlX2xpYiwgcnFfcGFyYW0sIHBp
cGVfc3JjX3BhcmFtKTsKKwlwcmludF9fcnFfcGFyYW1zX3N0KG1vZGVfbGliLCAqcnFfcGFyYW0p
OworfQorCit2b2lkIGRtbDIwdjJfcnFfZGxnX2dldF9ycV9yZWcoc3RydWN0IGRpc3BsYXlfbW9k
ZV9saWIgKm1vZGVfbGliLAorCQlkaXNwbGF5X3JxX3JlZ3Nfc3QgKnJxX3JlZ3MsCisJCWNvbnN0
IGRpc3BsYXlfcGlwZV9wYXJhbXNfc3QgcGlwZV9wYXJhbSkKK3sKKwlkaXNwbGF5X3JxX3BhcmFt
c19zdCBycV9wYXJhbSA9IHswfTsKKworCW1lbXNldChycV9yZWdzLCAwLCBzaXplb2YoKnJxX3Jl
Z3MpKTsKKwlkbWwyMHYyX3JxX2RsZ19nZXRfcnFfcGFyYW1zKG1vZGVfbGliLCAmcnFfcGFyYW0s
IHBpcGVfcGFyYW0uc3JjKTsKKwlleHRyYWN0X3JxX3JlZ3MobW9kZV9saWIsIHJxX3JlZ3MsIHJx
X3BhcmFtKTsKKworCXByaW50X19ycV9yZWdzX3N0KG1vZGVfbGliLCAqcnFfcmVncyk7Cit9CisK
Ky8vIE5vdGU6IGN1cnJlbnRseSB0YWtlbiBpbiBhcyBpcy4KKy8vIE5pY2UgdG8gZGVjb3VwbGUg
Y29kZSBmcm9tIGh3IHJlZ2lzdGVyIGltcGxlbWVudCBhbmQgZXh0cmFjdCBjb2RlIHRoYXQgYXJl
IHJlcGVhdGVkIGZvciBsdW1hIGFuZCBjaHJvbWEuCitzdGF0aWMgdm9pZCBkbWwyMHYyX3JxX2Rs
Z19nZXRfZGxnX3BhcmFtcyhzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIsCisJCWNv
bnN0IGRpc3BsYXlfZTJlX3BpcGVfcGFyYW1zX3N0ICplMmVfcGlwZV9wYXJhbSwKKwkJY29uc3Qg
dW5zaWduZWQgaW50IG51bV9waXBlcywKKwkJY29uc3QgdW5zaWduZWQgaW50IHBpcGVfaWR4LAor
CQlkaXNwbGF5X2RsZ19yZWdzX3N0ICpkaXNwX2RsZ19yZWdzLAorCQlkaXNwbGF5X3R0dV9yZWdz
X3N0ICpkaXNwX3R0dV9yZWdzLAorCQljb25zdCBkaXNwbGF5X3JxX2RsZ19wYXJhbXNfc3QgcnFf
ZGxnX3BhcmFtLAorCQljb25zdCBkaXNwbGF5X2RsZ19zeXNfcGFyYW1zX3N0IGRsZ19zeXNfcGFy
YW0sCisJCWNvbnN0IGJvb2wgY3N0YXRlX2VuLAorCQljb25zdCBib29sIHBzdGF0ZV9lbikKK3sK
Kwljb25zdCBkaXNwbGF5X3BpcGVfc291cmNlX3BhcmFtc19zdCAqc3JjID0gJmUyZV9waXBlX3Bh
cmFtW3BpcGVfaWR4XS5waXBlLnNyYzsKKwljb25zdCBkaXNwbGF5X3BpcGVfZGVzdF9wYXJhbXNf
c3QgKmRzdCA9ICZlMmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0ucGlwZS5kZXN0OworCWNvbnN0IGRp
c3BsYXlfb3V0cHV0X3BhcmFtc19zdCAqZG91dCA9ICZlMmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0u
ZG91dDsKKwljb25zdCBkaXNwbGF5X2Nsb2Nrc19hbmRfY2ZnX3N0ICpjbGtzID0gJmUyZV9waXBl
X3BhcmFtW3BpcGVfaWR4XS5jbGtzX2NmZzsKKwljb25zdCBzY2FsZXJfcmF0aW9fZGVwdGhfc3Qg
KnNjbCA9ICZlMmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0ucGlwZS5zY2FsZV9yYXRpb19kZXB0aDsK
Kwljb25zdCBzY2FsZXJfdGFwc19zdCAqdGFwcyA9ICZlMmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0u
cGlwZS5zY2FsZV90YXBzOworCisJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCS8vIFNl
Y3Rpb24gMS4xNS4yLjE6IE9URyBkZXBlbmRlbnQgUGFyYW1zCisJLy8gLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQorCS8vIFRpbWluZworCXVuc2lnbmVkIGludCBodG90YWwgPSBkc3QtPmh0b3Rh
bDsKKy8vICAgIHVuc2lnbmVkIGludCBoYmxhbmtfc3RhcnQgPSBkc3QuaGJsYW5rX3N0YXJ0OyAv
LyBUT0RPOiBSZW1vdmUKKwl1bnNpZ25lZCBpbnQgaGJsYW5rX2VuZCA9IGRzdC0+aGJsYW5rX2Vu
ZDsKKwl1bnNpZ25lZCBpbnQgdmJsYW5rX3N0YXJ0ID0gZHN0LT52Ymxhbmtfc3RhcnQ7CisJdW5z
aWduZWQgaW50IHZibGFua19lbmQgPSBkc3QtPnZibGFua19lbmQ7CisJdW5zaWduZWQgaW50IG1p
bl92YmxhbmsgPSBtb2RlX2xpYi0+aXAubWluX3ZibGFua19saW5lczsKKworCWRvdWJsZSBkcHBj
bGtfZnJlcV9pbl9taHogPSBjbGtzLT5kcHBjbGtfbWh6OworCWRvdWJsZSBkaXNwY2xrX2ZyZXFf
aW5fbWh6ID0gY2xrcy0+ZGlzcGNsa19taHo7CisJZG91YmxlIHJlZmNsa19mcmVxX2luX21oeiA9
IGNsa3MtPnJlZmNsa19taHo7CisJZG91YmxlIHBjbGtfZnJlcV9pbl9taHogPSBkc3QtPnBpeGVs
X3JhdGVfbWh6OworCWJvb2wgaW50ZXJsYWNlZCA9IGRzdC0+aW50ZXJsYWNlZDsKKworCWRvdWJs
ZSByZWZfZnJlcV90b19waXhfZnJlcSA9IHJlZmNsa19mcmVxX2luX21oeiAvIHBjbGtfZnJlcV9p
bl9taHo7CisKKwlkb3VibGUgbWluX2RjZmNsa19taHo7CisJZG91YmxlIHRfY2FsY191czsKKwlk
b3VibGUgbWluX3R0dV92Ymxhbms7CisKKwlkb3VibGUgbWluX2RzdF95X3R0dV92Ymxhbms7CisJ
dW5zaWduZWQgaW50IGRsZ192Ymxhbmtfc3RhcnQ7CisJYm9vbCBkdWFsX3BsYW5lOworCWJvb2wg
bW9kZV80MjI7CisJdW5zaWduZWQgaW50IGFjY2Vzc19kaXI7CisJdW5zaWduZWQgaW50IHZwX2hl
aWdodF9sOworCXVuc2lnbmVkIGludCB2cF93aWR0aF9sOworCXVuc2lnbmVkIGludCB2cF9oZWln
aHRfYzsKKwl1bnNpZ25lZCBpbnQgdnBfd2lkdGhfYzsKKworCS8vIFNjYWxpbmcKKwl1bnNpZ25l
ZCBpbnQgaHRhcHNfbDsKKwl1bnNpZ25lZCBpbnQgaHRhcHNfYzsKKwlkb3VibGUgaHJhdGlvX2w7
CisJZG91YmxlIGhyYXRpb19jOworCWRvdWJsZSB2cmF0aW9fbDsKKwlkb3VibGUgdnJhdGlvX2M7
CisJYm9vbCBzY2xfZW5hYmxlOworCisJZG91YmxlIGxpbmVfdGltZV9pbl91czsKKwkvLyAgICBk
b3VibGUgdmluaXRfbDsKKwkvLyAgICBkb3VibGUgdmluaXRfYzsKKwkvLyAgICBkb3VibGUgdmlu
aXRfYm90X2w7CisJLy8gICAgZG91YmxlIHZpbml0X2JvdF9jOworCisJLy8gICAgdW5zaWduZWQg
aW50IHN3YXRoX2hlaWdodF9sOworCXVuc2lnbmVkIGludCBzd2F0aF93aWR0aF91Yl9sOworCS8v
ICAgIHVuc2lnbmVkIGludCBkcHRlX2J5dGVzX3Blcl9yb3dfdWJfbDsKKwl1bnNpZ25lZCBpbnQg
ZHB0ZV9ncm91cHNfcGVyX3Jvd191Yl9sOworCS8vICAgIHVuc2lnbmVkIGludCBtZXRhX3B0ZV9i
eXRlc19wZXJfZnJhbWVfdWJfbDsKKwkvLyAgICB1bnNpZ25lZCBpbnQgbWV0YV9ieXRlc19wZXJf
cm93X3ViX2w7CisKKwkvLyAgICB1bnNpZ25lZCBpbnQgc3dhdGhfaGVpZ2h0X2M7CisJdW5zaWdu
ZWQgaW50IHN3YXRoX3dpZHRoX3ViX2M7CisJLy8gICB1bnNpZ25lZCBpbnQgZHB0ZV9ieXRlc19w
ZXJfcm93X3ViX2M7CisJdW5zaWduZWQgaW50IGRwdGVfZ3JvdXBzX3Blcl9yb3dfdWJfYzsKKwor
CXVuc2lnbmVkIGludCBtZXRhX2NodW5rc19wZXJfcm93X3ViX2w7CisJdW5zaWduZWQgaW50IG1l
dGFfY2h1bmtzX3Blcl9yb3dfdWJfYzsKKwl1bnNpZ25lZCBpbnQgdnVwZGF0ZV9vZmZzZXQ7CisJ
dW5zaWduZWQgaW50IHZ1cGRhdGVfd2lkdGg7CisJdW5zaWduZWQgaW50IHZyZWFkeV9vZmZzZXQ7
CisKKwl1bnNpZ25lZCBpbnQgZHBwY2xrX2RlbGF5X3N1YnRvdGFsOworCXVuc2lnbmVkIGludCBk
aXNwY2xrX2RlbGF5X3N1YnRvdGFsOworCXVuc2lnbmVkIGludCBwaXhlbF9yYXRlX2RlbGF5X3N1
YnRvdGFsOworCisJdW5zaWduZWQgaW50IHZzdGFydHVwX3N0YXJ0OworCXVuc2lnbmVkIGludCBk
c3RfeF9hZnRlcl9zY2FsZXI7CisJdW5zaWduZWQgaW50IGRzdF95X2FmdGVyX3NjYWxlcjsKKwlk
b3VibGUgbGluZV93YWl0OworCWRvdWJsZSBkc3RfeV9wcmVmZXRjaDsKKwlkb3VibGUgZHN0X3lf
cGVyX3ZtX3ZibGFuazsKKwlkb3VibGUgZHN0X3lfcGVyX3Jvd192Ymxhbms7CisJZG91YmxlIGRz
dF95X3Blcl92bV9mbGlwOworCWRvdWJsZSBkc3RfeV9wZXJfcm93X2ZsaXA7CisJZG91YmxlIG1p
bl9kc3RfeV9wZXJfdm1fdmJsYW5rOworCWRvdWJsZSBtaW5fZHN0X3lfcGVyX3Jvd192Ymxhbms7
CisJZG91YmxlIGxzdzsKKwlkb3VibGUgdnJhdGlvX3ByZV9sOworCWRvdWJsZSB2cmF0aW9fcHJl
X2M7CisJdW5zaWduZWQgaW50IHJlcV9wZXJfc3dhdGhfdWJfbDsKKwl1bnNpZ25lZCBpbnQgcmVx
X3Blcl9zd2F0aF91Yl9jOworCXVuc2lnbmVkIGludCBtZXRhX3Jvd19oZWlnaHRfbDsKKwl1bnNp
Z25lZCBpbnQgbWV0YV9yb3dfaGVpZ2h0X2M7CisJdW5zaWduZWQgaW50IHN3YXRoX3dpZHRoX3Bp
eGVsc191Yl9sOworCXVuc2lnbmVkIGludCBzd2F0aF93aWR0aF9waXhlbHNfdWJfYzsKKwl1bnNp
Z25lZCBpbnQgc2NhbGVyX3JlY19pbl93aWR0aF9sOworCXVuc2lnbmVkIGludCBzY2FsZXJfcmVj
X2luX3dpZHRoX2M7CisJdW5zaWduZWQgaW50IGRwdGVfcm93X2hlaWdodF9sOworCXVuc2lnbmVk
IGludCBkcHRlX3Jvd19oZWlnaHRfYzsKKwlkb3VibGUgaHNjYWxlX3BpeGVsX3JhdGVfbDsKKwlk
b3VibGUgaHNjYWxlX3BpeGVsX3JhdGVfYzsKKwlkb3VibGUgbWluX2hyYXRpb19mYWN0X2w7CisJ
ZG91YmxlIG1pbl9ocmF0aW9fZmFjdF9jOworCWRvdWJsZSByZWZjeWNfcGVyX2xpbmVfZGVsaXZl
cnlfcHJlX2w7CisJZG91YmxlIHJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfYzsKKwlkb3Vi
bGUgcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2w7CisJZG91YmxlIHJlZmN5Y19wZXJfbGluZV9k
ZWxpdmVyeV9jOworCisJZG91YmxlIHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9sOworCWRv
dWJsZSByZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfYzsKKwlkb3VibGUgcmVmY3ljX3Blcl9y
ZXFfZGVsaXZlcnlfbDsKKwlkb3VibGUgcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfYzsKKworCXVu
c2lnbmVkIGludCBmdWxsX3JlY291dF93aWR0aDsKKwlkb3VibGUgeGZjX3RyYW5zZmVyX2RlbGF5
OworCWRvdWJsZSB4ZmNfcHJlY2hhcmdlX2RlbGF5OworCWRvdWJsZSB4ZmNfcmVtb3RlX3N1cmZh
Y2VfZmxpcF9sYXRlbmN5OworCWRvdWJsZSB4ZmNfZHN0X3lfZGVsdGFfZHJxX2xpbWl0OworCWRv
dWJsZSB4ZmNfcHJlZmV0Y2hfbWFyZ2luOworCWRvdWJsZSByZWZjeWNfcGVyX3JlcV9kZWxpdmVy
eV9wcmVfY3VyMDsKKwlkb3VibGUgcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfY3VyMDsKKwlkb3Vi
bGUgcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1cjE7CisJZG91YmxlIHJlZmN5Y19wZXJf
cmVxX2RlbGl2ZXJ5X2N1cjE7CisKKwltZW1zZXQoZGlzcF9kbGdfcmVncywgMCwgc2l6ZW9mKCpk
aXNwX2RsZ19yZWdzKSk7CisJbWVtc2V0KGRpc3BfdHR1X3JlZ3MsIDAsIHNpemVvZigqZGlzcF90
dHVfcmVncykpOworCisJZG1sX3ByaW50KCJETUxfRExHOiAlczogIGNzdGF0ZV9lbiA9ICVkXG4i
LCBfX2Z1bmNfXywgY3N0YXRlX2VuKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiAgcHN0YXRl
X2VuID0gJWRcbiIsIF9fZnVuY19fLCBwc3RhdGVfZW4pOworCisJZG1sX3ByaW50KCJETUxfRExH
OiAlczogZHBwY2xrX2ZyZXFfaW5fbWh6ICAgICA9ICUzLjJmXG4iLCBfX2Z1bmNfXywgZHBwY2xr
X2ZyZXFfaW5fbWh6KTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBkaXNwY2xrX2ZyZXFfaW5f
bWh6ICAgID0gJTMuMmZcbiIsIF9fZnVuY19fLCBkaXNwY2xrX2ZyZXFfaW5fbWh6KTsKKwlkbWxf
cHJpbnQoIkRNTF9ETEc6ICVzOiByZWZjbGtfZnJlcV9pbl9taHogICAgID0gJTMuMmZcbiIsIF9f
ZnVuY19fLCByZWZjbGtfZnJlcV9pbl9taHopOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHBj
bGtfZnJlcV9pbl9taHogICAgICAgPSAlMy4yZlxuIiwgX19mdW5jX18sIHBjbGtfZnJlcV9pbl9t
aHopOworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IGludGVybGFjZWQgICAgICAgICAgICAgPSAl
ZFxuIiwgX19mdW5jX18sIGludGVybGFjZWQpOworCUFTU0VSVChyZWZfZnJlcV90b19waXhfZnJl
cSA8IDQuMCk7CisKKwlkaXNwX2RsZ19yZWdzLT5yZWZfZnJlcV90b19waXhfZnJlcSA9CisJCQko
dW5zaWduZWQgaW50KSAocmVmX2ZyZXFfdG9fcGl4X2ZyZXEgKiBkbWxfcG93KDIsIDE5KSk7CisJ
ZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9odG90YWwgPSAodW5zaWduZWQgaW50KSAocmVmX2Zy
ZXFfdG9fcGl4X2ZyZXEgKiAoZG91YmxlKSBodG90YWwKKwkJCSogZG1sX3BvdygyLCA4KSk7CisJ
ZGlzcF9kbGdfcmVncy0+ZGxnX3ZibGFua19lbmQgPSBpbnRlcmxhY2VkID8gKHZibGFua19lbmQg
LyAyKSA6IHZibGFua19lbmQ7IC8vIDE1IGJpdHMKKwlkaXNwX2RsZ19yZWdzLT5yZWZjeWNfaF9i
bGFua19lbmQgPSAodW5zaWduZWQgaW50KSAoKGRvdWJsZSkgaGJsYW5rX2VuZAorCQkJKiAoZG91
YmxlKSByZWZfZnJlcV90b19waXhfZnJlcSk7CisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPnJlZmN5
Y19oX2JsYW5rX2VuZCA8ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwgMTMpKTsKKworCW1pbl9k
Y2ZjbGtfbWh6ID0gZGxnX3N5c19wYXJhbS5kZWVwc2xlZXBfZGNmY2xrX21oejsKKwl0X2NhbGNf
dXMgPSBnZXRfdGNhbGMobW9kZV9saWIsIGUyZV9waXBlX3BhcmFtLCBudW1fcGlwZXMpOworCW1p
bl90dHVfdmJsYW5rID0gZ2V0X21pbl90dHVfdmJsYW5rKG1vZGVfbGliLCBlMmVfcGlwZV9wYXJh
bSwgbnVtX3BpcGVzLCBwaXBlX2lkeCk7CisKKwltaW5fZHN0X3lfdHR1X3ZibGFuayA9IG1pbl90
dHVfdmJsYW5rICogcGNsa19mcmVxX2luX21oeiAvIChkb3VibGUpIGh0b3RhbDsKKwlkbGdfdmJs
YW5rX3N0YXJ0ID0gaW50ZXJsYWNlZCA/ICh2Ymxhbmtfc3RhcnQgLyAyKSA6IHZibGFua19zdGFy
dDsKKworCWRpc3BfZGxnX3JlZ3MtPm1pbl9kc3RfeV9uZXh0X3N0YXJ0ID0gKHVuc2lnbmVkIGlu
dCkgKCgoZG91YmxlKSBkbGdfdmJsYW5rX3N0YXJ0CisJCQkrIG1pbl9kc3RfeV90dHVfdmJsYW5r
KSAqIGRtbF9wb3coMiwgMikpOworCUFTU0VSVChkaXNwX2RsZ19yZWdzLT5taW5fZHN0X3lfbmV4
dF9zdGFydCA8ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwgMTgpKTsKKworCWRtbF9wcmludCgi
RE1MX0RMRzogJXM6IG1pbl9kY2ZjbGtfbWh6ICAgICAgICAgICAgICAgICAgICAgICAgID0gJTMu
MmZcbiIsCisJCQlfX2Z1bmNfXywKKwkJCW1pbl9kY2ZjbGtfbWh6KTsKKwlkbWxfcHJpbnQoIkRN
TF9ETEc6ICVzOiBtaW5fdHR1X3ZibGFuayAgICAgICAgICAgICAgICAgICAgICAgICA9ICUzLjJm
XG4iLAorCQkJX19mdW5jX18sCisJCQltaW5fdHR1X3ZibGFuayk7CisJZG1sX3ByaW50KCJETUxf
RExHOiAlczogbWluX2RzdF95X3R0dV92YmxhbmsgICAgICAgICAgICAgICAgICAgPSAlMy4yZlxu
IiwKKwkJCV9fZnVuY19fLAorCQkJbWluX2RzdF95X3R0dV92YmxhbmspOworCWRtbF9wcmludCgi
RE1MX0RMRzogJXM6IHRfY2FsY191cyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gJTMu
MmZcbiIsCisJCQlfX2Z1bmNfXywKKwkJCXRfY2FsY191cyk7CisJZG1sX3ByaW50KCJETUxfRExH
OiAlczogZGlzcF9kbGdfcmVncy0+bWluX2RzdF95X25leHRfc3RhcnQgICAgPSAweCUweFxuIiwK
KwkJCV9fZnVuY19fLAorCQkJZGlzcF9kbGdfcmVncy0+bWluX2RzdF95X25leHRfc3RhcnQpOwor
CWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJlZl9mcmVxX3RvX3BpeF9mcmVxICAgICAgICAgICAg
ICAgICAgID0gJTMuMmZcbiIsCisJCQlfX2Z1bmNfXywKKwkJCXJlZl9mcmVxX3RvX3BpeF9mcmVx
KTsKKworCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKwkvLyBTZWN0aW9uIDEuMTUuMi4y
OiBQcmVmZXRjaCwgQWN0aXZlIGFuZCBUVFUKKwkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CisJLy8gUHJlZmV0Y2ggQ2FsYworCS8vIFNvdXJjZQorLy8gICAgICAgICAgICAgZGNjX2VuICAg
ICAgICAgICAgICA9IHNyYy5kY2M7CisJZHVhbF9wbGFuZSA9IGlzX2R1YWxfcGxhbmUoKGVudW0g
c291cmNlX2Zvcm1hdF9jbGFzcykoc3JjLT5zb3VyY2VfZm9ybWF0KSk7CisJbW9kZV80MjIgPSAw
OyAvLyBGSVhNRQorCWFjY2Vzc19kaXIgPSAoc3JjLT5zb3VyY2Vfc2NhbiA9PSBkbV92ZXJ0KTsg
Ly8gdnAgYWNjZXNzIGRpcmVjdGlvbjogaG9yaXpvbnRhbCBvciB2ZXJ0aWNhbCBhY2Nlc3NlZAor
Ly8gICAgICBieXRlc19wZXJfZWxlbWVudF9sID0gZ2V0X2J5dGVzX3Blcl9lbGVtZW50KHNvdXJj
ZV9mb3JtYXRfY2xhc3Moc3JjLnNvdXJjZV9mb3JtYXQpLCAwKTsKKy8vICAgICAgYnl0ZXNfcGVy
X2VsZW1lbnRfYyA9IGdldF9ieXRlc19wZXJfZWxlbWVudChzb3VyY2VfZm9ybWF0X2NsYXNzKHNy
Yy5zb3VyY2VfZm9ybWF0KSwgMSk7CisJdnBfaGVpZ2h0X2wgPSBzcmMtPnZpZXdwb3J0X2hlaWdo
dDsKKwl2cF93aWR0aF9sID0gc3JjLT52aWV3cG9ydF93aWR0aDsKKwl2cF9oZWlnaHRfYyA9IHNy
Yy0+dmlld3BvcnRfaGVpZ2h0X2M7CisJdnBfd2lkdGhfYyA9IHNyYy0+dmlld3BvcnRfd2lkdGhf
YzsKKworCS8vIFNjYWxpbmcKKwlodGFwc19sID0gdGFwcy0+aHRhcHM7CisJaHRhcHNfYyA9IHRh
cHMtPmh0YXBzX2M7CisJaHJhdGlvX2wgPSBzY2wtPmhzY2xfcmF0aW87CisJaHJhdGlvX2MgPSBz
Y2wtPmhzY2xfcmF0aW9fYzsKKwl2cmF0aW9fbCA9IHNjbC0+dnNjbF9yYXRpbzsKKwl2cmF0aW9f
YyA9IHNjbC0+dnNjbF9yYXRpb19jOworCXNjbF9lbmFibGUgPSBzY2wtPnNjbF9lbmFibGU7CisK
KwlsaW5lX3RpbWVfaW5fdXMgPSAoaHRvdGFsIC8gcGNsa19mcmVxX2luX21oeik7CisvLyAgICAg
dmluaXRfbCAgICAgICAgID0gc2NsLnZpbml0OworLy8gICAgIHZpbml0X2MgICAgICAgICA9IHNj
bC52aW5pdF9jOworLy8gICAgIHZpbml0X2JvdF9sICAgICA9IHNjbC52aW5pdF9ib3Q7CisvLyAg
ICAgdmluaXRfYm90X2MgICAgID0gc2NsLnZpbml0X2JvdF9jOworCisvLyAgICB1bnNpZ25lZCBp
bnQgc3dhdGhfaGVpZ2h0X2wgICAgICAgICAgICAgICAgID0gcnFfZGxnX3BhcmFtLnJxX2wuc3dh
dGhfaGVpZ2h0OworCXN3YXRoX3dpZHRoX3ViX2wgPSBycV9kbGdfcGFyYW0ucnFfbC5zd2F0aF93
aWR0aF91YjsKKy8vICAgIHVuc2lnbmVkIGludCBkcHRlX2J5dGVzX3Blcl9yb3dfdWJfbCAgICAg
ICAgPSBycV9kbGdfcGFyYW0ucnFfbC5kcHRlX2J5dGVzX3Blcl9yb3dfdWI7CisJZHB0ZV9ncm91
cHNfcGVyX3Jvd191Yl9sID0gcnFfZGxnX3BhcmFtLnJxX2wuZHB0ZV9ncm91cHNfcGVyX3Jvd191
YjsKKy8vICAgIHVuc2lnbmVkIGludCBtZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWJfbCAgPSBy
cV9kbGdfcGFyYW0ucnFfbC5tZXRhX3B0ZV9ieXRlc19wZXJfZnJhbWVfdWI7CisvLyAgICB1bnNp
Z25lZCBpbnQgbWV0YV9ieXRlc19wZXJfcm93X3ViX2wgICAgICAgID0gcnFfZGxnX3BhcmFtLnJx
X2wubWV0YV9ieXRlc19wZXJfcm93X3ViOworCisvLyAgICB1bnNpZ25lZCBpbnQgc3dhdGhfaGVp
Z2h0X2MgICAgICAgICAgICAgICAgID0gcnFfZGxnX3BhcmFtLnJxX2Muc3dhdGhfaGVpZ2h0Owor
CXN3YXRoX3dpZHRoX3ViX2MgPSBycV9kbGdfcGFyYW0ucnFfYy5zd2F0aF93aWR0aF91YjsKKwkv
LyAgIGRwdGVfYnl0ZXNfcGVyX3Jvd191Yl9jICAgICAgICA9IHJxX2RsZ19wYXJhbS5ycV9jLmRw
dGVfYnl0ZXNfcGVyX3Jvd191YjsKKwlkcHRlX2dyb3Vwc19wZXJfcm93X3ViX2MgPSBycV9kbGdf
cGFyYW0ucnFfYy5kcHRlX2dyb3Vwc19wZXJfcm93X3ViOworCisJbWV0YV9jaHVua3NfcGVyX3Jv
d191Yl9sID0gcnFfZGxnX3BhcmFtLnJxX2wubWV0YV9jaHVua3NfcGVyX3Jvd191YjsKKwltZXRh
X2NodW5rc19wZXJfcm93X3ViX2MgPSBycV9kbGdfcGFyYW0ucnFfYy5tZXRhX2NodW5rc19wZXJf
cm93X3ViOworCXZ1cGRhdGVfb2Zmc2V0ID0gZHN0LT52dXBkYXRlX29mZnNldDsKKwl2dXBkYXRl
X3dpZHRoID0gZHN0LT52dXBkYXRlX3dpZHRoOworCXZyZWFkeV9vZmZzZXQgPSBkc3QtPnZyZWFk
eV9vZmZzZXQ7CisKKwlkcHBjbGtfZGVsYXlfc3VidG90YWwgPSBtb2RlX2xpYi0+aXAuZHBwY2xr
X2RlbGF5X3N1YnRvdGFsOworCWRpc3BjbGtfZGVsYXlfc3VidG90YWwgPSBtb2RlX2xpYi0+aXAu
ZGlzcGNsa19kZWxheV9zdWJ0b3RhbDsKKworCWlmIChzY2xfZW5hYmxlKQorCQlkcHBjbGtfZGVs
YXlfc3VidG90YWwgKz0gbW9kZV9saWItPmlwLmRwcGNsa19kZWxheV9zY2w7CisJZWxzZQorCQlk
cHBjbGtfZGVsYXlfc3VidG90YWwgKz0gbW9kZV9saWItPmlwLmRwcGNsa19kZWxheV9zY2xfbGJf
b25seTsKKworCWRwcGNsa19kZWxheV9zdWJ0b3RhbCArPSBtb2RlX2xpYi0+aXAuZHBwY2xrX2Rl
bGF5X2NudmNfZm9ybWF0dGVyCisJCQkrIHNyYy0+bnVtX2N1cnNvcnMgKiBtb2RlX2xpYi0+aXAu
ZHBwY2xrX2RlbGF5X2NudmNfY3Vyc29yOworCisJaWYgKGRvdXQtPmRzY19lbmFibGUpIHsKKwkJ
ZG91YmxlIGRzY19kZWxheSA9IGdldF9kc2NfZGVsYXkobW9kZV9saWIsIGUyZV9waXBlX3BhcmFt
LCBudW1fcGlwZXMsIHBpcGVfaWR4KTsKKworCQlkaXNwY2xrX2RlbGF5X3N1YnRvdGFsICs9IGRz
Y19kZWxheTsKKwl9CisKKwlwaXhlbF9yYXRlX2RlbGF5X3N1YnRvdGFsID0gZHBwY2xrX2RlbGF5
X3N1YnRvdGFsICogcGNsa19mcmVxX2luX21oeiAvIGRwcGNsa19mcmVxX2luX21oegorCQkJKyBk
aXNwY2xrX2RlbGF5X3N1YnRvdGFsICogcGNsa19mcmVxX2luX21oeiAvIGRpc3BjbGtfZnJlcV9p
bl9taHo7CisKKwl2c3RhcnR1cF9zdGFydCA9IGRzdC0+dnN0YXJ0dXBfc3RhcnQ7CisJaWYgKGlu
dGVybGFjZWQpIHsKKwkJaWYgKHZzdGFydHVwX3N0YXJ0IC8gMi4wCisJCQkJLSAoZG91YmxlKSAo
dnJlYWR5X29mZnNldCArIHZ1cGRhdGVfd2lkdGggKyB2dXBkYXRlX29mZnNldCkgLyBodG90YWwK
KwkJCQk8PSB2YmxhbmtfZW5kIC8gMi4wKQorCQkJZGlzcF9kbGdfcmVncy0+dnJlYWR5X2FmdGVy
X3Zjb3VudDAgPSAxOworCQllbHNlCisJCQlkaXNwX2RsZ19yZWdzLT52cmVhZHlfYWZ0ZXJfdmNv
dW50MCA9IDA7CisJfSBlbHNlIHsKKwkJaWYgKHZzdGFydHVwX3N0YXJ0CisJCQkJLSAoZG91Ymxl
KSAodnJlYWR5X29mZnNldCArIHZ1cGRhdGVfd2lkdGggKyB2dXBkYXRlX29mZnNldCkgLyBodG90
YWwKKwkJCQk8PSB2YmxhbmtfZW5kKQorCQkJZGlzcF9kbGdfcmVncy0+dnJlYWR5X2FmdGVyX3Zj
b3VudDAgPSAxOworCQllbHNlCisJCQlkaXNwX2RsZ19yZWdzLT52cmVhZHlfYWZ0ZXJfdmNvdW50
MCA9IDA7CisJfQorCisJLy8gVE9ETzogV2hlcmUgaXMgdGhpcyBjb21pbmcgZnJvbT8KKwlpZiAo
aW50ZXJsYWNlZCkKKwkJdnN0YXJ0dXBfc3RhcnQgPSB2c3RhcnR1cF9zdGFydCAvIDI7CisKKwkv
LyBUT0RPOiBXaGF0IGlmIHRoaXMgbWluX3ZibGFuayBkb2Vzbid0IG1hdGNoIHRoZSB2YWx1ZSBp
biB0aGUgZG1sX2NvbmZpZ19zZXR0aW5ncy5jcHA/CisJaWYgKHZzdGFydHVwX3N0YXJ0ID49IG1p
bl92YmxhbmspIHsKKwkJZG1sX3ByaW50KCJXQVJOSU5HOiBETUxfRExHOiAlczogdmJsYW5rX3N0
YXJ0PSVkIHZibGFua19lbmQ9JWRcbiIsCisJCQkJX19mdW5jX18sCisJCQkJdmJsYW5rX3N0YXJ0
LAorCQkJCXZibGFua19lbmQpOworCQlkbWxfcHJpbnQoIldBUk5JTkc6IERNTF9ETEc6ICVzOiB2
c3RhcnR1cF9zdGFydD0lZCBzaG91bGQgYmUgbGVzcyB0aGFuIG1pbl92Ymxhbms9JWRcbiIsCisJ
CQkJX19mdW5jX18sCisJCQkJdnN0YXJ0dXBfc3RhcnQsCisJCQkJbWluX3ZibGFuayk7CisJCW1p
bl92YmxhbmsgPSB2c3RhcnR1cF9zdGFydCArIDE7CisJCWRtbF9wcmludCgiV0FSTklORzogRE1M
X0RMRzogJXM6IHZzdGFydHVwX3N0YXJ0PSVkIHNob3VsZCBiZSBsZXNzIHRoYW4gbWluX3ZibGFu
az0lZFxuIiwKKwkJCQlfX2Z1bmNfXywKKwkJCQl2c3RhcnR1cF9zdGFydCwKKwkJCQltaW5fdmJs
YW5rKTsKKwl9CisKKwlkc3RfeF9hZnRlcl9zY2FsZXIgPSBnZXRfZHN0X3hfYWZ0ZXJfc2NhbGVy
KG1vZGVfbGliLCBlMmVfcGlwZV9wYXJhbSwgbnVtX3BpcGVzLCBwaXBlX2lkeCk7CisJZHN0X3lf
YWZ0ZXJfc2NhbGVyID0gZ2V0X2RzdF95X2FmdGVyX3NjYWxlcihtb2RlX2xpYiwgZTJlX3BpcGVf
cGFyYW0sIG51bV9waXBlcywgcGlwZV9pZHgpOworCisJZG1sX3ByaW50KCJETUxfRExHOiAlczog
aHRvdGFsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAlZFxuIiwgX19mdW5jX18s
IGh0b3RhbCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogcGl4ZWxfcmF0ZV9kZWxheV9zdWJ0
b3RhbCAgICAgICAgICAgICAgPSAlZFxuIiwKKwkJCV9fZnVuY19fLAorCQkJcGl4ZWxfcmF0ZV9k
ZWxheV9zdWJ0b3RhbCk7CisJZG1sX3ByaW50KCJETUxfRExHOiAlczogZHN0X3hfYWZ0ZXJfc2Nh
bGVyICAgICAgICAgICAgICAgICAgICAgPSAlZFxuIiwKKwkJCV9fZnVuY19fLAorCQkJZHN0X3hf
YWZ0ZXJfc2NhbGVyKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBkc3RfeV9hZnRlcl9zY2Fs
ZXIgICAgICAgICAgICAgICAgICAgICA9ICVkXG4iLAorCQkJX19mdW5jX18sCisJCQlkc3RfeV9h
ZnRlcl9zY2FsZXIpOworCisJLy8gTHdhaXQKKwlsaW5lX3dhaXQgPSBtb2RlX2xpYi0+c29jLnVy
Z2VudF9sYXRlbmN5X3VzOworCWlmIChjc3RhdGVfZW4pCisJCWxpbmVfd2FpdCA9IGRtbF9tYXgo
bW9kZV9saWItPnNvYy5zcl9lbnRlcl9wbHVzX2V4aXRfdGltZV91cywgbGluZV93YWl0KTsKKwlp
ZiAocHN0YXRlX2VuKQorCQlsaW5lX3dhaXQgPSBkbWxfbWF4KG1vZGVfbGliLT5zb2MuZHJhbV9j
bG9ja19jaGFuZ2VfbGF0ZW5jeV91cworCQkJCQkJKyBtb2RlX2xpYi0+c29jLnVyZ2VudF9sYXRl
bmN5X3VzLAorCQkJCWxpbmVfd2FpdCk7CisJbGluZV93YWl0ID0gbGluZV93YWl0IC8gbGluZV90
aW1lX2luX3VzOworCisJZHN0X3lfcHJlZmV0Y2ggPSBnZXRfZHN0X3lfcHJlZmV0Y2gobW9kZV9s
aWIsIGUyZV9waXBlX3BhcmFtLCBudW1fcGlwZXMsIHBpcGVfaWR4KTsKKwlkbWxfcHJpbnQoIkRN
TF9ETEc6ICVzOiBkc3RfeV9wcmVmZXRjaCAoYWZ0ZXIgcm5kKSA9ICUzLjJmXG4iLCBfX2Z1bmNf
XywgZHN0X3lfcHJlZmV0Y2gpOworCisJZHN0X3lfcGVyX3ZtX3ZibGFuayA9IGdldF9kc3RfeV9w
ZXJfdm1fdmJsYW5rKG1vZGVfbGliLAorCQkJZTJlX3BpcGVfcGFyYW0sCisJCQludW1fcGlwZXMs
CisJCQlwaXBlX2lkeCk7CisJZHN0X3lfcGVyX3Jvd192YmxhbmsgPSBnZXRfZHN0X3lfcGVyX3Jv
d192YmxhbmsobW9kZV9saWIsCisJCQllMmVfcGlwZV9wYXJhbSwKKwkJCW51bV9waXBlcywKKwkJ
CXBpcGVfaWR4KTsKKwlkc3RfeV9wZXJfdm1fZmxpcCA9IGdldF9kc3RfeV9wZXJfdm1fZmxpcCht
b2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcywgcGlwZV9pZHgpOworCWRzdF95X3Bl
cl9yb3dfZmxpcCA9IGdldF9kc3RfeV9wZXJfcm93X2ZsaXAobW9kZV9saWIsIGUyZV9waXBlX3Bh
cmFtLCBudW1fcGlwZXMsIHBpcGVfaWR4KTsKKworCW1pbl9kc3RfeV9wZXJfdm1fdmJsYW5rID0g
OC4wOworCW1pbl9kc3RfeV9wZXJfcm93X3ZibGFuayA9IDE2LjA7CisKKwkvLyBtYWdpYyEKKwlp
ZiAoaHRvdGFsIDw9IDc1KSB7CisJCW1pbl92YmxhbmsgPSAzMDA7CisJCW1pbl9kc3RfeV9wZXJf
dm1fdmJsYW5rID0gMTAwLjA7CisJCW1pbl9kc3RfeV9wZXJfcm93X3ZibGFuayA9IDEwMC4wOwor
CX0KKworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IGRzdF95X3Blcl92bV92YmxhbmsgICAgPSAl
My4yZlxuIiwgX19mdW5jX18sIGRzdF95X3Blcl92bV92YmxhbmspOworCWRtbF9wcmludCgiRE1M
X0RMRzogJXM6IGRzdF95X3Blcl9yb3dfdmJsYW5rICAgPSAlMy4yZlxuIiwgX19mdW5jX18sIGRz
dF95X3Blcl9yb3dfdmJsYW5rKTsKKworCUFTU0VSVChkc3RfeV9wZXJfdm1fdmJsYW5rIDwgbWlu
X2RzdF95X3Blcl92bV92YmxhbmspOworCUFTU0VSVChkc3RfeV9wZXJfcm93X3ZibGFuayA8IG1p
bl9kc3RfeV9wZXJfcm93X3ZibGFuayk7CisKKwlBU1NFUlQoZHN0X3lfcHJlZmV0Y2ggPiAoZHN0
X3lfcGVyX3ZtX3ZibGFuayArIGRzdF95X3Blcl9yb3dfdmJsYW5rKSk7CisJbHN3ID0gZHN0X3lf
cHJlZmV0Y2ggLSAoZHN0X3lfcGVyX3ZtX3ZibGFuayArIGRzdF95X3Blcl9yb3dfdmJsYW5rKTsK
KworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IGxzdyA9ICUzLjJmXG4iLCBfX2Z1bmNfXywgbHN3
KTsKKworCXZyYXRpb19wcmVfbCA9IGdldF92cmF0aW9fcHJlZmV0Y2hfbChtb2RlX2xpYiwgZTJl
X3BpcGVfcGFyYW0sIG51bV9waXBlcywgcGlwZV9pZHgpOworCXZyYXRpb19wcmVfYyA9IGdldF92
cmF0aW9fcHJlZmV0Y2hfYyhtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcywgcGlw
ZV9pZHgpOworCisJZG1sX3ByaW50KCJETUxfRExHOiAlczogdnJhdGlvX3ByZV9sPSUzLjJmXG4i
LCBfX2Z1bmNfXywgdnJhdGlvX3ByZV9sKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiB2cmF0
aW9fcHJlX2M9JTMuMmZcbiIsIF9fZnVuY19fLCB2cmF0aW9fcHJlX2MpOworCisJLy8gQWN0aXZl
CisJcmVxX3Blcl9zd2F0aF91Yl9sID0gcnFfZGxnX3BhcmFtLnJxX2wucmVxX3Blcl9zd2F0aF91
YjsKKwlyZXFfcGVyX3N3YXRoX3ViX2MgPSBycV9kbGdfcGFyYW0ucnFfYy5yZXFfcGVyX3N3YXRo
X3ViOworCW1ldGFfcm93X2hlaWdodF9sID0gcnFfZGxnX3BhcmFtLnJxX2wubWV0YV9yb3dfaGVp
Z2h0OworCW1ldGFfcm93X2hlaWdodF9jID0gcnFfZGxnX3BhcmFtLnJxX2MubWV0YV9yb3dfaGVp
Z2h0OworCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9sID0gMDsKKwlzd2F0aF93aWR0aF9waXhlbHNf
dWJfYyA9IDA7CisJc2NhbGVyX3JlY19pbl93aWR0aF9sID0gMDsKKwlzY2FsZXJfcmVjX2luX3dp
ZHRoX2MgPSAwOworCWRwdGVfcm93X2hlaWdodF9sID0gcnFfZGxnX3BhcmFtLnJxX2wuZHB0ZV9y
b3dfaGVpZ2h0OworCWRwdGVfcm93X2hlaWdodF9jID0gcnFfZGxnX3BhcmFtLnJxX2MuZHB0ZV9y
b3dfaGVpZ2h0OworCisJaWYgKG1vZGVfNDIyKSB7CisJCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9s
ID0gc3dhdGhfd2lkdGhfdWJfbCAqIDI7ICAvLyAqMiBmb3IgMiBwaXhlbCBwZXIgZWxlbWVudAor
CQlzd2F0aF93aWR0aF9waXhlbHNfdWJfYyA9IHN3YXRoX3dpZHRoX3ViX2MgKiAyOworCX0gZWxz
ZSB7CisJCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9sID0gc3dhdGhfd2lkdGhfdWJfbCAqIDE7CisJ
CXN3YXRoX3dpZHRoX3BpeGVsc191Yl9jID0gc3dhdGhfd2lkdGhfdWJfYyAqIDE7CisJfQorCisJ
aHNjYWxlX3BpeGVsX3JhdGVfbCA9IDAuOworCWhzY2FsZV9waXhlbF9yYXRlX2MgPSAwLjsKKwlt
aW5faHJhdGlvX2ZhY3RfbCA9IDEuMDsKKwltaW5faHJhdGlvX2ZhY3RfYyA9IDEuMDsKKworCWlm
IChodGFwc19sIDw9IDEpCisJCW1pbl9ocmF0aW9fZmFjdF9sID0gMi4wOworCWVsc2UgaWYgKGh0
YXBzX2wgPD0gNikgeworCQlpZiAoKGhyYXRpb19sICogMi4wKSA+IDQuMCkKKwkJCW1pbl9ocmF0
aW9fZmFjdF9sID0gNC4wOworCQllbHNlCisJCQltaW5faHJhdGlvX2ZhY3RfbCA9IGhyYXRpb19s
ICogMi4wOworCX0gZWxzZSB7CisJCWlmIChocmF0aW9fbCA+IDQuMCkKKwkJCW1pbl9ocmF0aW9f
ZmFjdF9sID0gNC4wOworCQllbHNlCisJCQltaW5faHJhdGlvX2ZhY3RfbCA9IGhyYXRpb19sOwor
CX0KKworCWhzY2FsZV9waXhlbF9yYXRlX2wgPSBtaW5faHJhdGlvX2ZhY3RfbCAqIGRwcGNsa19m
cmVxX2luX21oejsKKworCWlmIChodGFwc19jIDw9IDEpCisJCW1pbl9ocmF0aW9fZmFjdF9jID0g
Mi4wOworCWVsc2UgaWYgKGh0YXBzX2MgPD0gNikgeworCQlpZiAoKGhyYXRpb19jICogMi4wKSA+
IDQuMCkKKwkJCW1pbl9ocmF0aW9fZmFjdF9jID0gNC4wOworCQllbHNlCisJCQltaW5faHJhdGlv
X2ZhY3RfYyA9IGhyYXRpb19jICogMi4wOworCX0gZWxzZSB7CisJCWlmIChocmF0aW9fYyA+IDQu
MCkKKwkJCW1pbl9ocmF0aW9fZmFjdF9jID0gNC4wOworCQllbHNlCisJCQltaW5faHJhdGlvX2Zh
Y3RfYyA9IGhyYXRpb19jOworCX0KKworCWhzY2FsZV9waXhlbF9yYXRlX2MgPSBtaW5faHJhdGlv
X2ZhY3RfYyAqIGRwcGNsa19mcmVxX2luX21oejsKKworCXJlZmN5Y19wZXJfbGluZV9kZWxpdmVy
eV9wcmVfbCA9IDAuOworCXJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfYyA9IDAuOworCXJl
ZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9sID0gMC47CisJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5
X2MgPSAwLjsKKworCXJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9sID0gMC47CisJcmVmY3lj
X3Blcl9yZXFfZGVsaXZlcnlfcHJlX2MgPSAwLjsKKwlyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9s
ID0gMC47CisJcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfYyA9IDAuOworCisJZnVsbF9yZWNvdXRf
d2lkdGggPSAwOworCS8vIEluIE9ETQorCWlmIChzcmMtPmlzX2hzcGxpdCkgeworCQkvLyBUaGlz
ICJoYWNrIiAgaXMgb25seSBhbGxvd2VkIChhbmQgdmFsaWQpIGZvciBNUEMgY29tYmluZS4gSW4g
T0RNCisJCS8vIGNvbWJpbmUsIHlvdSBNVVNUIHNwZWNpZnkgdGhlIGZ1bGxfcmVjb3V0X3dpZHRo
Li4uYWNjb3JkaW5nIHRvIE9zd2luCisJCWlmIChkc3QtPmZ1bGxfcmVjb3V0X3dpZHRoID09IDAg
JiYgIWRzdC0+b2RtX2NvbWJpbmUpIHsKKwkJCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IFdhcm5p
bmc6IGZ1bGxfcmVjb3V0X3dpZHRoIG5vdCBzZXQgaW4gaHNwbGl0IG1vZGVcbiIsCisJCQkJCV9f
ZnVuY19fKTsKKwkJCWZ1bGxfcmVjb3V0X3dpZHRoID0gZHN0LT5yZWNvdXRfd2lkdGggKiAyOyAv
LyBhc3N1bWUgaGFsZiBzcGxpdCBmb3IgZGNuMQorCQl9IGVsc2UKKwkJCWZ1bGxfcmVjb3V0X3dp
ZHRoID0gZHN0LT5mdWxsX3JlY291dF93aWR0aDsKKwl9IGVsc2UKKwkJZnVsbF9yZWNvdXRfd2lk
dGggPSBkc3QtPnJlY291dF93aWR0aDsKKworCS8vIEFzIG9mIERDTjIsIG1wY19jb21iaW5lIGFu
ZCBvZG1fY29tYmluZSBhcmUgbXV0dWFsbHkgZXhjbHVzaXZlCisJcmVmY3ljX3Blcl9saW5lX2Rl
bGl2ZXJ5X3ByZV9sID0gZ2V0X3JlZmN5Y19wZXJfZGVsaXZlcnkobW9kZV9saWIsCisJCQlyZWZj
bGtfZnJlcV9pbl9taHosCisJCQlwY2xrX2ZyZXFfaW5fbWh6LAorCQkJZHN0LT5vZG1fY29tYmlu
ZSwKKwkJCWZ1bGxfcmVjb3V0X3dpZHRoLAorCQkJZHN0LT5oYWN0aXZlLAorCQkJdnJhdGlvX3By
ZV9sLAorCQkJaHNjYWxlX3BpeGVsX3JhdGVfbCwKKwkJCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9s
LAorCQkJMSk7IC8vIHBlciBsaW5lCisKKwlyZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfbCA9IGdl
dF9yZWZjeWNfcGVyX2RlbGl2ZXJ5KG1vZGVfbGliLAorCQkJcmVmY2xrX2ZyZXFfaW5fbWh6LAor
CQkJcGNsa19mcmVxX2luX21oeiwKKwkJCWRzdC0+b2RtX2NvbWJpbmUsCisJCQlmdWxsX3JlY291
dF93aWR0aCwKKwkJCWRzdC0+aGFjdGl2ZSwKKwkJCXZyYXRpb19sLAorCQkJaHNjYWxlX3BpeGVs
X3JhdGVfbCwKKwkJCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9sLAorCQkJMSk7IC8vIHBlciBsaW5l
CisKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiBmdWxsX3JlY291dF93aWR0aCAgICAgICAgICAg
ICAgPSAlZFxuIiwKKwkJCV9fZnVuY19fLAorCQkJZnVsbF9yZWNvdXRfd2lkdGgpOworCWRtbF9w
cmludCgiRE1MX0RMRzogJXM6IGhzY2FsZV9waXhlbF9yYXRlX2wgICAgICAgICAgICA9ICUzLjJm
XG4iLAorCQkJX19mdW5jX18sCisJCQloc2NhbGVfcGl4ZWxfcmF0ZV9sKTsKKwlkbWxfcHJpbnQo
IkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2wgPSAlMy4yZlxuIiwK
KwkJCV9fZnVuY19fLAorCQkJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9sKTsKKwlkbWxf
cHJpbnQoIkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfbCAgICAgPSAlMy4y
ZlxuIiwKKwkJCV9fZnVuY19fLAorCQkJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2wpOworCisJ
aWYgKGR1YWxfcGxhbmUpIHsKKwkJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9jID0gZ2V0
X3JlZmN5Y19wZXJfZGVsaXZlcnkobW9kZV9saWIsCisJCQkJcmVmY2xrX2ZyZXFfaW5fbWh6LAor
CQkJCXBjbGtfZnJlcV9pbl9taHosCisJCQkJZHN0LT5vZG1fY29tYmluZSwKKwkJCQlmdWxsX3Jl
Y291dF93aWR0aCwKKwkJCQlkc3QtPmhhY3RpdmUsCisJCQkJdnJhdGlvX3ByZV9jLAorCQkJCWhz
Y2FsZV9waXhlbF9yYXRlX2MsCisJCQkJc3dhdGhfd2lkdGhfcGl4ZWxzX3ViX2MsCisJCQkJMSk7
IC8vIHBlciBsaW5lCisKKwkJcmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X2MgPSBnZXRfcmVmY3lj
X3Blcl9kZWxpdmVyeShtb2RlX2xpYiwKKwkJCQlyZWZjbGtfZnJlcV9pbl9taHosCisJCQkJcGNs
a19mcmVxX2luX21oeiwKKwkJCQlkc3QtPm9kbV9jb21iaW5lLAorCQkJCWZ1bGxfcmVjb3V0X3dp
ZHRoLAorCQkJCWRzdC0+aGFjdGl2ZSwKKwkJCQl2cmF0aW9fYywKKwkJCQloc2NhbGVfcGl4ZWxf
cmF0ZV9jLAorCQkJCXN3YXRoX3dpZHRoX3BpeGVsc191Yl9jLAorCQkJCTEpOyAgLy8gcGVyIGxp
bmUKKworCQlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlf
cHJlX2MgPSAlMy4yZlxuIiwKKwkJCQlfX2Z1bmNfXywKKwkJCQlyZWZjeWNfcGVyX2xpbmVfZGVs
aXZlcnlfcHJlX2MpOworCQlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX2xpbmVf
ZGVsaXZlcnlfYyAgICAgPSAlMy4yZlxuIiwKKwkJCQlfX2Z1bmNfXywKKwkJCQlyZWZjeWNfcGVy
X2xpbmVfZGVsaXZlcnlfYyk7CisJfQorCisJLy8gVFRVIC0gTHVtYSAvIENocm9tYQorCWlmIChh
Y2Nlc3NfZGlyKSB7ICAvLyB2ZXJ0aWNhbCBhY2Nlc3MKKwkJc2NhbGVyX3JlY19pbl93aWR0aF9s
ID0gdnBfaGVpZ2h0X2w7CisJCXNjYWxlcl9yZWNfaW5fd2lkdGhfYyA9IHZwX2hlaWdodF9jOwor
CX0gZWxzZSB7CisJCXNjYWxlcl9yZWNfaW5fd2lkdGhfbCA9IHZwX3dpZHRoX2w7CisJCXNjYWxl
cl9yZWNfaW5fd2lkdGhfYyA9IHZwX3dpZHRoX2M7CisJfQorCisJcmVmY3ljX3Blcl9yZXFfZGVs
aXZlcnlfcHJlX2wgPSBnZXRfcmVmY3ljX3Blcl9kZWxpdmVyeShtb2RlX2xpYiwKKwkJCXJlZmNs
a19mcmVxX2luX21oeiwKKwkJCXBjbGtfZnJlcV9pbl9taHosCisJCQlkc3QtPm9kbV9jb21iaW5l
LAorCQkJZnVsbF9yZWNvdXRfd2lkdGgsCisJCQlkc3QtPmhhY3RpdmUsCisJCQl2cmF0aW9fcHJl
X2wsCisJCQloc2NhbGVfcGl4ZWxfcmF0ZV9sLAorCQkJc2NhbGVyX3JlY19pbl93aWR0aF9sLAor
CQkJcmVxX3Blcl9zd2F0aF91Yl9sKTsgIC8vIHBlciByZXEKKwlyZWZjeWNfcGVyX3JlcV9kZWxp
dmVyeV9sID0gZ2V0X3JlZmN5Y19wZXJfZGVsaXZlcnkobW9kZV9saWIsCisJCQlyZWZjbGtfZnJl
cV9pbl9taHosCisJCQlwY2xrX2ZyZXFfaW5fbWh6LAorCQkJZHN0LT5vZG1fY29tYmluZSwKKwkJ
CWZ1bGxfcmVjb3V0X3dpZHRoLAorCQkJZHN0LT5oYWN0aXZlLAorCQkJdnJhdGlvX2wsCisJCQlo
c2NhbGVfcGl4ZWxfcmF0ZV9sLAorCQkJc2NhbGVyX3JlY19pbl93aWR0aF9sLAorCQkJcmVxX3Bl
cl9zd2F0aF91Yl9sKTsgIC8vIHBlciByZXEKKworCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJl
ZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9sID0gJTMuMmZcbiIsCisJCQlfX2Z1bmNfXywKKwkJ
CXJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9sKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6ICVz
OiByZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9sICAgICA9ICUzLjJmXG4iLAorCQkJX19mdW5jX18s
CisJCQlyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9sKTsKKworCUFTU0VSVChyZWZjeWNfcGVyX3Jl
cV9kZWxpdmVyeV9wcmVfbCA8IGRtbF9wb3coMiwgMTMpKTsKKwlBU1NFUlQocmVmY3ljX3Blcl9y
ZXFfZGVsaXZlcnlfbCA8IGRtbF9wb3coMiwgMTMpKTsKKworCWlmIChkdWFsX3BsYW5lKSB7CisJ
CXJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jID0gZ2V0X3JlZmN5Y19wZXJfZGVsaXZlcnko
bW9kZV9saWIsCisJCQkJcmVmY2xrX2ZyZXFfaW5fbWh6LAorCQkJCXBjbGtfZnJlcV9pbl9taHos
CisJCQkJZHN0LT5vZG1fY29tYmluZSwKKwkJCQlmdWxsX3JlY291dF93aWR0aCwKKwkJCQlkc3Qt
PmhhY3RpdmUsCisJCQkJdnJhdGlvX3ByZV9jLAorCQkJCWhzY2FsZV9waXhlbF9yYXRlX2MsCisJ
CQkJc2NhbGVyX3JlY19pbl93aWR0aF9jLAorCQkJCXJlcV9wZXJfc3dhdGhfdWJfYyk7ICAvLyBw
ZXIgcmVxCisJCXJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2MgPSBnZXRfcmVmY3ljX3Blcl9kZWxp
dmVyeShtb2RlX2xpYiwKKwkJCQlyZWZjbGtfZnJlcV9pbl9taHosCisJCQkJcGNsa19mcmVxX2lu
X21oeiwKKwkJCQlkc3QtPm9kbV9jb21iaW5lLAorCQkJCWZ1bGxfcmVjb3V0X3dpZHRoLAorCQkJ
CWRzdC0+aGFjdGl2ZSwKKwkJCQl2cmF0aW9fYywKKwkJCQloc2NhbGVfcGl4ZWxfcmF0ZV9jLAor
CQkJCXNjYWxlcl9yZWNfaW5fd2lkdGhfYywKKwkJCQlyZXFfcGVyX3N3YXRoX3ViX2MpOyAgLy8g
cGVyIHJlcQorCisJCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJlZmN5Y19wZXJfcmVxX2RlbGl2
ZXJ5X3ByZV9jID0gJTMuMmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJcmVmY3ljX3Blcl9yZXFf
ZGVsaXZlcnlfcHJlX2MpOworCQlkbWxfcHJpbnQoIkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX3Jl
cV9kZWxpdmVyeV9jICAgICA9ICUzLjJmXG4iLAorCQkJCV9fZnVuY19fLAorCQkJCXJlZmN5Y19w
ZXJfcmVxX2RlbGl2ZXJ5X2MpOworCisJCUFTU0VSVChyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9w
cmVfYyA8IGRtbF9wb3coMiwgMTMpKTsKKwkJQVNTRVJUKHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5
X2MgPCBkbWxfcG93KDIsIDEzKSk7CisJfQorCisJLy8gWEZDCisJeGZjX3RyYW5zZmVyX2RlbGF5
ID0gZ2V0X3hmY190cmFuc2Zlcl9kZWxheShtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9w
aXBlcywgcGlwZV9pZHgpOworCXhmY19wcmVjaGFyZ2VfZGVsYXkgPSBnZXRfeGZjX3ByZWNoYXJn
ZV9kZWxheShtb2RlX2xpYiwKKwkJCWUyZV9waXBlX3BhcmFtLAorCQkJbnVtX3BpcGVzLAorCQkJ
cGlwZV9pZHgpOworCXhmY19yZW1vdGVfc3VyZmFjZV9mbGlwX2xhdGVuY3kgPSBnZXRfeGZjX3Jl
bW90ZV9zdXJmYWNlX2ZsaXBfbGF0ZW5jeShtb2RlX2xpYiwKKwkJCWUyZV9waXBlX3BhcmFtLAor
CQkJbnVtX3BpcGVzLAorCQkJcGlwZV9pZHgpOworCXhmY19kc3RfeV9kZWx0YV9kcnFfbGltaXQg
PSB4ZmNfcmVtb3RlX3N1cmZhY2VfZmxpcF9sYXRlbmN5OworCXhmY19wcmVmZXRjaF9tYXJnaW4g
PSBnZXRfeGZjX3ByZWZldGNoX21hcmdpbihtb2RlX2xpYiwKKwkJCWUyZV9waXBlX3BhcmFtLAor
CQkJbnVtX3BpcGVzLAorCQkJcGlwZV9pZHgpOworCisJLy8gVFRVIC0gQ3Vyc29yCisJcmVmY3lj
X3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1cjAgPSAwLjA7CisJcmVmY3ljX3Blcl9yZXFfZGVsaXZl
cnlfY3VyMCA9IDAuMDsKKwlpZiAoc3JjLT5udW1fY3Vyc29ycyA+IDApIHsKKwkJY2FsY3VsYXRl
X3R0dV9jdXJzb3IobW9kZV9saWIsCisJCQkJJnJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9j
dXIwLAorCQkJCSZyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIwLAorCQkJCXJlZmNsa19mcmVx
X2luX21oeiwKKwkJCQlyZWZfZnJlcV90b19waXhfZnJlcSwKKwkJCQloc2NhbGVfcGl4ZWxfcmF0
ZV9sLAorCQkJCXNjbC0+aHNjbF9yYXRpbywKKwkJCQl2cmF0aW9fcHJlX2wsCisJCQkJdnJhdGlv
X2wsCisJCQkJc3JjLT5jdXIwX3NyY193aWR0aCwKKwkJCQkoZW51bSBjdXJzb3JfYnBwKShzcmMt
PmN1cjBfYnBwKSk7CisJfQorCisJcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1cjEgPSAw
LjA7CisJcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfY3VyMSA9IDAuMDsKKwlpZiAoc3JjLT5udW1f
Y3Vyc29ycyA+IDEpIHsKKwkJY2FsY3VsYXRlX3R0dV9jdXJzb3IobW9kZV9saWIsCisJCQkJJnJl
ZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIxLAorCQkJCSZyZWZjeWNfcGVyX3JlcV9kZWxp
dmVyeV9jdXIxLAorCQkJCXJlZmNsa19mcmVxX2luX21oeiwKKwkJCQlyZWZfZnJlcV90b19waXhf
ZnJlcSwKKwkJCQloc2NhbGVfcGl4ZWxfcmF0ZV9sLAorCQkJCXNjbC0+aHNjbF9yYXRpbywKKwkJ
CQl2cmF0aW9fcHJlX2wsCisJCQkJdnJhdGlvX2wsCisJCQkJc3JjLT5jdXIxX3NyY193aWR0aCwK
KwkJCQkoZW51bSBjdXJzb3JfYnBwKShzcmMtPmN1cjFfYnBwKSk7CisJfQorCisJLy8gVFRVIC0g
TWlzYworCS8vIGFsbCBoYXJkLWNvZGVkCisKKwkvLyBBc3NpZ25tZW50IHRvIHJlZ2lzdGVyIHN0
cnVjdHVyZXMKKwlkaXNwX2RsZ19yZWdzLT5kc3RfeV9hZnRlcl9zY2FsZXIgPSBkc3RfeV9hZnRl
cl9zY2FsZXI7IC8vIGluIHRlcm1zIG9mIGxpbmUKKwlkaXNwX2RsZ19yZWdzLT5yZWZjeWNfeF9h
ZnRlcl9zY2FsZXIgPSBkc3RfeF9hZnRlcl9zY2FsZXIgKiByZWZfZnJlcV90b19waXhfZnJlcTsg
Ly8gaW4gdGVybXMgb2YgcmVmY2xrCisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPnJlZmN5Y194X2Fm
dGVyX3NjYWxlciA8ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwgMTMpKTsKKwlkaXNwX2RsZ19y
ZWdzLT5kc3RfeV9wcmVmZXRjaCA9ICh1bnNpZ25lZCBpbnQpIChkc3RfeV9wcmVmZXRjaCAqIGRt
bF9wb3coMiwgMikpOworCWRpc3BfZGxnX3JlZ3MtPmRzdF95X3Blcl92bV92YmxhbmsgPSAodW5z
aWduZWQgaW50KSAoZHN0X3lfcGVyX3ZtX3ZibGFuayAqIGRtbF9wb3coMiwgMikpOworCWRpc3Bf
ZGxnX3JlZ3MtPmRzdF95X3Blcl9yb3dfdmJsYW5rID0gKHVuc2lnbmVkIGludCkgKGRzdF95X3Bl
cl9yb3dfdmJsYW5rICogZG1sX3BvdygyLCAyKSk7CisJZGlzcF9kbGdfcmVncy0+ZHN0X3lfcGVy
X3ZtX2ZsaXAgPSAodW5zaWduZWQgaW50KSAoZHN0X3lfcGVyX3ZtX2ZsaXAgKiBkbWxfcG93KDIs
IDIpKTsKKwlkaXNwX2RsZ19yZWdzLT5kc3RfeV9wZXJfcm93X2ZsaXAgPSAodW5zaWduZWQgaW50
KSAoZHN0X3lfcGVyX3Jvd19mbGlwICogZG1sX3BvdygyLCAyKSk7CisKKwlkaXNwX2RsZ19yZWdz
LT52cmF0aW9fcHJlZmV0Y2ggPSAodW5zaWduZWQgaW50KSAodnJhdGlvX3ByZV9sICogZG1sX3Bv
dygyLCAxOSkpOworCWRpc3BfZGxnX3JlZ3MtPnZyYXRpb19wcmVmZXRjaF9jID0gKHVuc2lnbmVk
IGludCkgKHZyYXRpb19wcmVfYyAqIGRtbF9wb3coMiwgMTkpKTsKKworCWRpc3BfZGxnX3JlZ3Mt
PnJlZmN5Y19wZXJfcHRlX2dyb3VwX3ZibGFua19sID0KKwkJCSh1bnNpZ25lZCBpbnQpIChkc3Rf
eV9wZXJfcm93X3ZibGFuayAqIChkb3VibGUpIGh0b3RhbAorCQkJCQkqIHJlZl9mcmVxX3RvX3Bp
eF9mcmVxIC8gKGRvdWJsZSkgZHB0ZV9ncm91cHNfcGVyX3Jvd191Yl9sKTsKKwlBU1NFUlQoZGlz
cF9kbGdfcmVncy0+cmVmY3ljX3Blcl9wdGVfZ3JvdXBfdmJsYW5rX2wgPCAodW5zaWduZWQgaW50
KSBkbWxfcG93KDIsIDEzKSk7CisKKwlpZiAoZHVhbF9wbGFuZSkgeworCQlkaXNwX2RsZ19yZWdz
LT5yZWZjeWNfcGVyX3B0ZV9ncm91cF92YmxhbmtfYyA9ICh1bnNpZ25lZCBpbnQpIChkc3RfeV9w
ZXJfcm93X3ZibGFuaworCQkJCSogKGRvdWJsZSkgaHRvdGFsICogcmVmX2ZyZXFfdG9fcGl4X2Zy
ZXEKKwkJCQkvIChkb3VibGUpIGRwdGVfZ3JvdXBzX3Blcl9yb3dfdWJfYyk7CisJCUFTU0VSVChk
aXNwX2RsZ19yZWdzLT5yZWZjeWNfcGVyX3B0ZV9ncm91cF92YmxhbmtfYworCQkJCQkJPCAodW5z
aWduZWQgaW50KSBkbWxfcG93KDIsIDEzKSk7CisJfQorCisJZGlzcF9kbGdfcmVncy0+cmVmY3lj
X3Blcl9tZXRhX2NodW5rX3ZibGFua19sID0KKwkJCSh1bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJf
cm93X3ZibGFuayAqIChkb3VibGUpIGh0b3RhbAorCQkJCQkqIHJlZl9mcmVxX3RvX3BpeF9mcmVx
IC8gKGRvdWJsZSkgbWV0YV9jaHVua3NfcGVyX3Jvd191Yl9sKTsKKwlBU1NFUlQoZGlzcF9kbGdf
cmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX3ZibGFua19sIDwgKHVuc2lnbmVkIGludCkgZG1s
X3BvdygyLCAxMykpOworCisJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX3Zi
bGFua19jID0KKwkJCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfbWV0YV9jaHVua192Ymxhbmtf
bDsgLy8gZGNjIGZvciA0OjI6MCBpcyBub3Qgc3VwcG9ydGVkIGluIGRjbjEuMC4gIGFzc2lnbmVk
IHRvIGJlIHRoZSBzYW1lIGFzIF9sIGZvciBub3cKKworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19w
ZXJfcHRlX2dyb3VwX2ZsaXBfbCA9ICh1bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJfcm93X2ZsaXAg
KiBodG90YWwKKwkJCSogcmVmX2ZyZXFfdG9fcGl4X2ZyZXEpIC8gZHB0ZV9ncm91cHNfcGVyX3Jv
d191Yl9sOworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfbWV0YV9jaHVua19mbGlwX2wgPSAo
dW5zaWduZWQgaW50KSAoZHN0X3lfcGVyX3Jvd19mbGlwICogaHRvdGFsCisJCQkqIHJlZl9mcmVx
X3RvX3BpeF9mcmVxKSAvIG1ldGFfY2h1bmtzX3Blcl9yb3dfdWJfbDsKKworCWlmIChkdWFsX3Bs
YW5lKSB7CisJCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dyb3VwX2ZsaXBfYyA9ICh1
bnNpZ25lZCBpbnQpIChkc3RfeV9wZXJfcm93X2ZsaXAKKwkJCQkqIGh0b3RhbCAqIHJlZl9mcmVx
X3RvX3BpeF9mcmVxKSAvIGRwdGVfZ3JvdXBzX3Blcl9yb3dfdWJfYzsKKwkJZGlzcF9kbGdfcmVn
cy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX2ZsaXBfYyA9ICh1bnNpZ25lZCBpbnQpIChkc3RfeV9w
ZXJfcm93X2ZsaXAKKwkJCQkqIGh0b3RhbCAqIHJlZl9mcmVxX3RvX3BpeF9mcmVxKSAvIG1ldGFf
Y2h1bmtzX3Blcl9yb3dfdWJfYzsKKwl9CisKKwlkaXNwX2RsZ19yZWdzLT5kc3RfeV9wZXJfcHRl
X3Jvd19ub21fbCA9ICh1bnNpZ25lZCBpbnQpICgoZG91YmxlKSBkcHRlX3Jvd19oZWlnaHRfbAor
CQkJLyAoZG91YmxlKSB2cmF0aW9fbCAqIGRtbF9wb3coMiwgMikpOworCUFTU0VSVChkaXNwX2Rs
Z19yZWdzLT5kc3RfeV9wZXJfcHRlX3Jvd19ub21fbCA8ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3co
MiwgMTcpKTsKKworCWlmIChkdWFsX3BsYW5lKSB7CisJCWRpc3BfZGxnX3JlZ3MtPmRzdF95X3Bl
cl9wdGVfcm93X25vbV9jID0gKHVuc2lnbmVkIGludCkgKChkb3VibGUpIGRwdGVfcm93X2hlaWdo
dF9jCisJCQkJLyAoZG91YmxlKSB2cmF0aW9fYyAqIGRtbF9wb3coMiwgMikpOworCQlpZiAoZGlz
cF9kbGdfcmVncy0+ZHN0X3lfcGVyX3B0ZV9yb3dfbm9tX2MgPj0gKHVuc2lnbmVkIGludCkgZG1s
X3BvdygyLCAxNykpIHsKKwkJCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IFdhcm5pbmcgZHN0X3lf
cGVyX3B0ZV9yb3dfbm9tX2MgJXUgbGFyZ2VyIHRoYW4gc3VwcG9ydGVkIGJ5IHJlZ2lzdGVyIGZv
cm1hdCBVMTUuMiAldVxuIiwKKwkJCQkJX19mdW5jX18sCisJCQkJCWRpc3BfZGxnX3JlZ3MtPmRz
dF95X3Blcl9wdGVfcm93X25vbV9jLAorCQkJCQkodW5zaWduZWQgaW50KSBkbWxfcG93KDIsIDE3
KSAtIDEpOworCQl9CisJfQorCisJZGlzcF9kbGdfcmVncy0+ZHN0X3lfcGVyX21ldGFfcm93X25v
bV9sID0gKHVuc2lnbmVkIGludCkgKChkb3VibGUpIG1ldGFfcm93X2hlaWdodF9sCisJCQkvIChk
b3VibGUpIHZyYXRpb19sICogZG1sX3BvdygyLCAyKSk7CisJQVNTRVJUKGRpc3BfZGxnX3JlZ3Mt
PmRzdF95X3Blcl9tZXRhX3Jvd19ub21fbCA8ICh1bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwgMTcp
KTsKKworCWRpc3BfZGxnX3JlZ3MtPmRzdF95X3Blcl9tZXRhX3Jvd19ub21fYyA9IGRpc3BfZGxn
X3JlZ3MtPmRzdF95X3Blcl9tZXRhX3Jvd19ub21fbDsgLy8gVE9ETzogZGNjIGZvciA0OjI6MCBp
cyBub3Qgc3VwcG9ydGVkIGluIGRjbjEuMC4gIGFzc2lnbmVkIHRvIGJlIHRoZSBzYW1lIGFzIF9s
IGZvciBub3cKKworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dyb3VwX25vbV9sID0g
KHVuc2lnbmVkIGludCkgKChkb3VibGUpIGRwdGVfcm93X2hlaWdodF9sCisJCQkvIChkb3VibGUp
IHZyYXRpb19sICogKGRvdWJsZSkgaHRvdGFsICogcmVmX2ZyZXFfdG9fcGl4X2ZyZXEKKwkJCS8g
KGRvdWJsZSkgZHB0ZV9ncm91cHNfcGVyX3Jvd191Yl9sKTsKKwlpZiAoZGlzcF9kbGdfcmVncy0+
cmVmY3ljX3Blcl9wdGVfZ3JvdXBfbm9tX2wgPj0gKHVuc2lnbmVkIGludCkgZG1sX3BvdygyLCAy
MykpCisJCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dyb3VwX25vbV9sID0gZG1sX3Bv
dygyLCAyMykgLSAxOworCWRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfbWV0YV9jaHVua19ub21f
bCA9ICh1bnNpZ25lZCBpbnQpICgoZG91YmxlKSBtZXRhX3Jvd19oZWlnaHRfbAorCQkJLyAoZG91
YmxlKSB2cmF0aW9fbCAqIChkb3VibGUpIGh0b3RhbCAqIHJlZl9mcmVxX3RvX3BpeF9mcmVxCisJ
CQkvIChkb3VibGUpIG1ldGFfY2h1bmtzX3Blcl9yb3dfdWJfbCk7CisJaWYgKGRpc3BfZGxnX3Jl
Z3MtPnJlZmN5Y19wZXJfbWV0YV9jaHVua19ub21fbCA+PSAodW5zaWduZWQgaW50KSBkbWxfcG93
KDIsIDIzKSkKKwkJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX25vbV9sID0g
ZG1sX3BvdygyLCAyMykgLSAxOworCisJaWYgKGR1YWxfcGxhbmUpIHsKKwkJZGlzcF9kbGdfcmVn
cy0+cmVmY3ljX3Blcl9wdGVfZ3JvdXBfbm9tX2MgPQorCQkJCSh1bnNpZ25lZCBpbnQpICgoZG91
YmxlKSBkcHRlX3Jvd19oZWlnaHRfYyAvIChkb3VibGUpIHZyYXRpb19jCisJCQkJCQkqIChkb3Vi
bGUpIGh0b3RhbCAqIHJlZl9mcmVxX3RvX3BpeF9mcmVxCisJCQkJCQkvIChkb3VibGUpIGRwdGVf
Z3JvdXBzX3Blcl9yb3dfdWJfYyk7CisJCWlmIChkaXNwX2RsZ19yZWdzLT5yZWZjeWNfcGVyX3B0
ZV9ncm91cF9ub21fYyA+PSAodW5zaWduZWQgaW50KSBkbWxfcG93KDIsIDIzKSkKKwkJCWRpc3Bf
ZGxnX3JlZ3MtPnJlZmN5Y19wZXJfcHRlX2dyb3VwX25vbV9jID0gZG1sX3BvdygyLCAyMykgLSAx
OworCisJCS8vIFRPRE86IElzIHRoaXMgdGhlIHJpZ2h0IGNhbGN1bGF0aW9uPyBEb2VzIGh0b3Rh
bCBuZWVkIHRvIGJlIGhhbHZlZD8KKwkJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2No
dW5rX25vbV9jID0KKwkJCQkodW5zaWduZWQgaW50KSAoKGRvdWJsZSkgbWV0YV9yb3dfaGVpZ2h0
X2MgLyAoZG91YmxlKSB2cmF0aW9fYworCQkJCQkJKiAoZG91YmxlKSBodG90YWwgKiByZWZfZnJl
cV90b19waXhfZnJlcQorCQkJCQkJLyAoZG91YmxlKSBtZXRhX2NodW5rc19wZXJfcm93X3ViX2Mp
OworCQlpZiAoZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9tZXRhX2NodW5rX25vbV9jID49ICh1
bnNpZ25lZCBpbnQpIGRtbF9wb3coMiwgMjMpKQorCQkJZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Bl
cl9tZXRhX2NodW5rX25vbV9jID0gZG1sX3BvdygyLCAyMykgLSAxOworCX0KKworCWRpc3BfZGxn
X3JlZ3MtPnJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfbCA9ICh1bnNpZ25lZCBpbnQpIGRt
bF9mbG9vcihyZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2wsCisJCQkxKTsKKwlkaXNwX2Rs
Z19yZWdzLT5yZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfbCA9ICh1bnNpZ25lZCBpbnQpIGRtbF9m
bG9vcihyZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfbCwKKwkJCTEpOworCUFTU0VSVChkaXNwX2Rs
Z19yZWdzLT5yZWZjeWNfcGVyX2xpbmVfZGVsaXZlcnlfcHJlX2wgPCAodW5zaWduZWQgaW50KSBk
bWxfcG93KDIsIDEzKSk7CisJQVNTRVJUKGRpc3BfZGxnX3JlZ3MtPnJlZmN5Y19wZXJfbGluZV9k
ZWxpdmVyeV9sIDwgKHVuc2lnbmVkIGludCkgZG1sX3BvdygyLCAxMykpOworCisJZGlzcF9kbGdf
cmVncy0+cmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9jID0gKHVuc2lnbmVkIGludCkgZG1s
X2Zsb29yKHJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfYywKKwkJCTEpOworCWRpc3BfZGxn
X3JlZ3MtPnJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9jID0gKHVuc2lnbmVkIGludCkgZG1sX2Zs
b29yKHJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9jLAorCQkJMSk7CisJQVNTRVJUKGRpc3BfZGxn
X3JlZ3MtPnJlZmN5Y19wZXJfbGluZV9kZWxpdmVyeV9wcmVfYyA8ICh1bnNpZ25lZCBpbnQpIGRt
bF9wb3coMiwgMTMpKTsKKwlBU1NFUlQoZGlzcF9kbGdfcmVncy0+cmVmY3ljX3Blcl9saW5lX2Rl
bGl2ZXJ5X2MgPCAodW5zaWduZWQgaW50KSBkbWxfcG93KDIsIDEzKSk7CisKKwlkaXNwX2RsZ19y
ZWdzLT5jaHVua19oZGxfYWRqdXN0X2N1cjAgPSAzOworCWRpc3BfZGxnX3JlZ3MtPmRzdF95X29m
ZnNldF9jdXIwID0gMDsKKwlkaXNwX2RsZ19yZWdzLT5jaHVua19oZGxfYWRqdXN0X2N1cjEgPSAz
OworCWRpc3BfZGxnX3JlZ3MtPmRzdF95X29mZnNldF9jdXIxID0gMDsKKworCWRpc3BfZGxnX3Jl
Z3MtPnhmY19yZWdfdHJhbnNmZXJfZGVsYXkgPSB4ZmNfdHJhbnNmZXJfZGVsYXk7CisJZGlzcF9k
bGdfcmVncy0+eGZjX3JlZ19wcmVjaGFyZ2VfZGVsYXkgPSB4ZmNfcHJlY2hhcmdlX2RlbGF5Owor
CWRpc3BfZGxnX3JlZ3MtPnhmY19yZWdfcmVtb3RlX3N1cmZhY2VfZmxpcF9sYXRlbmN5ID0geGZj
X3JlbW90ZV9zdXJmYWNlX2ZsaXBfbGF0ZW5jeTsKKwlkaXNwX2RsZ19yZWdzLT54ZmNfcmVnX3By
ZWZldGNoX21hcmdpbiA9IGRtbF9jZWlsKHhmY19wcmVmZXRjaF9tYXJnaW4gKiByZWZjbGtfZnJl
cV9pbl9taHosCisJCQkxKTsKKworCS8vIHNsYXZlIGhhcyB0byBoYXZlIHRoaXMgdmFsdWUgYWxz
byBzZXQgdG8gb2ZmCisJaWYgKHNyYy0+eGZjX2VuYWJsZSAmJiAhc3JjLT54ZmNfc2xhdmUpCisJ
CWRpc3BfZGxnX3JlZ3MtPmRzdF95X2RlbHRhX2RycV9saW1pdCA9IGRtbF9jZWlsKHhmY19kc3Rf
eV9kZWx0YV9kcnFfbGltaXQsIDEpOworCWVsc2UKKwkJZGlzcF9kbGdfcmVncy0+ZHN0X3lfZGVs
dGFfZHJxX2xpbWl0ID0gMHg3ZmZmOyAvLyBvZmYKKworCWRpc3BfdHR1X3JlZ3MtPnJlZmN5Y19w
ZXJfcmVxX2RlbGl2ZXJ5X3ByZV9sID0gKHVuc2lnbmVkIGludCkgKHJlZmN5Y19wZXJfcmVxX2Rl
bGl2ZXJ5X3ByZV9sCisJCQkqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9yZWdzLT5yZWZj
eWNfcGVyX3JlcV9kZWxpdmVyeV9sID0gKHVuc2lnbmVkIGludCkgKHJlZmN5Y19wZXJfcmVxX2Rl
bGl2ZXJ5X2wKKwkJCSogZG1sX3BvdygyLCAxMCkpOworCWRpc3BfdHR1X3JlZ3MtPnJlZmN5Y19w
ZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jID0gKHVuc2lnbmVkIGludCkgKHJlZmN5Y19wZXJfcmVxX2Rl
bGl2ZXJ5X3ByZV9jCisJCQkqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9yZWdzLT5yZWZj
eWNfcGVyX3JlcV9kZWxpdmVyeV9jID0gKHVuc2lnbmVkIGludCkgKHJlZmN5Y19wZXJfcmVxX2Rl
bGl2ZXJ5X2MKKwkJCSogZG1sX3BvdygyLCAxMCkpOworCWRpc3BfdHR1X3JlZ3MtPnJlZmN5Y19w
ZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIwID0KKwkJCSh1bnNpZ25lZCBpbnQpIChyZWZjeWNfcGVy
X3JlcV9kZWxpdmVyeV9wcmVfY3VyMCAqIGRtbF9wb3coMiwgMTApKTsKKwlkaXNwX3R0dV9yZWdz
LT5yZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIwID0gKHVuc2lnbmVkIGludCkgKHJlZmN5Y19w
ZXJfcmVxX2RlbGl2ZXJ5X2N1cjAKKwkJCSogZG1sX3BvdygyLCAxMCkpOworCWRpc3BfdHR1X3Jl
Z3MtPnJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIxID0KKwkJCSh1bnNpZ25lZCBpbnQp
IChyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfY3VyMSAqIGRtbF9wb3coMiwgMTApKTsKKwlk
aXNwX3R0dV9yZWdzLT5yZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIxID0gKHVuc2lnbmVkIGlu
dCkgKHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2N1cjEKKwkJCSogZG1sX3BvdygyLCAxMCkpOwor
CWRpc3BfdHR1X3JlZ3MtPnFvc19sZXZlbF9sb3dfd20gPSAwOworCUFTU0VSVChkaXNwX3R0dV9y
ZWdzLT5xb3NfbGV2ZWxfbG93X3dtIDwgZG1sX3BvdygyLCAxNCkpOworCWRpc3BfdHR1X3JlZ3Mt
PnFvc19sZXZlbF9oaWdoX3dtID0gKHVuc2lnbmVkIGludCkgKDQuMCAqIChkb3VibGUpIGh0b3Rh
bAorCQkJKiByZWZfZnJlcV90b19waXhfZnJlcSk7CisJLypBU1NFUlQoZGlzcF90dHVfcmVncy0+
cW9zX2xldmVsX2hpZ2hfd20gPCBkbWxfcG93KDIsIDE0KSk7Ki8KKworCWRpc3BfdHR1X3JlZ3Mt
PnFvc19sZXZlbF9mbGlwID0gMTQ7CisJZGlzcF90dHVfcmVncy0+cW9zX2xldmVsX2ZpeGVkX2wg
PSA4OworCWRpc3BfdHR1X3JlZ3MtPnFvc19sZXZlbF9maXhlZF9jID0gODsKKwlkaXNwX3R0dV9y
ZWdzLT5xb3NfbGV2ZWxfZml4ZWRfY3VyMCA9IDg7CisJZGlzcF90dHVfcmVncy0+cW9zX3JhbXBf
ZGlzYWJsZV9sID0gMDsKKwlkaXNwX3R0dV9yZWdzLT5xb3NfcmFtcF9kaXNhYmxlX2MgPSAwOwor
CWRpc3BfdHR1X3JlZ3MtPnFvc19yYW1wX2Rpc2FibGVfY3VyMCA9IDA7CisKKwlkaXNwX3R0dV9y
ZWdzLT5taW5fdHR1X3ZibGFuayA9IG1pbl90dHVfdmJsYW5rICogcmVmY2xrX2ZyZXFfaW5fbWh6
OworCUFTU0VSVChkaXNwX3R0dV9yZWdzLT5taW5fdHR1X3ZibGFuayA8IGRtbF9wb3coMiwgMjQp
KTsKKworCXByaW50X190dHVfcmVnc19zdChtb2RlX2xpYiwgKmRpc3BfdHR1X3JlZ3MpOworCXBy
aW50X19kbGdfcmVnc19zdChtb2RlX2xpYiwgKmRpc3BfZGxnX3JlZ3MpOworfQorCit2b2lkIGRt
bDIwdjJfcnFfZGxnX2dldF9kbGdfcmVnKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xp
YiwKKwkJZGlzcGxheV9kbGdfcmVnc19zdCAqZGxnX3JlZ3MsCisJCWRpc3BsYXlfdHR1X3JlZ3Nf
c3QgKnR0dV9yZWdzLAorCQlkaXNwbGF5X2UyZV9waXBlX3BhcmFtc19zdCAqZTJlX3BpcGVfcGFy
YW0sCisJCWNvbnN0IHVuc2lnbmVkIGludCBudW1fcGlwZXMsCisJCWNvbnN0IHVuc2lnbmVkIGlu
dCBwaXBlX2lkeCwKKwkJY29uc3QgYm9vbCBjc3RhdGVfZW4sCisJCWNvbnN0IGJvb2wgcHN0YXRl
X2VuLAorCQljb25zdCBib29sIHZtX2VuLAorCQljb25zdCBib29sIGlnbm9yZV92aWV3cG9ydF9w
b3MsCisJCWNvbnN0IGJvb2wgaW1tZWRpYXRlX2ZsaXBfc3VwcG9ydCkKK3sKKwlkaXNwbGF5X3Jx
X3BhcmFtc19zdCBycV9wYXJhbSA9IHswfTsKKwlkaXNwbGF5X2RsZ19zeXNfcGFyYW1zX3N0IGRs
Z19zeXNfcGFyYW0gPSB7MH07CisKKwkvLyBHZXQgd2F0ZXJtYXJrIGFuZCBUZXguCisJZGxnX3N5
c19wYXJhbS50X3VyZ193bV91cyA9IGdldF93bV91cmdlbnQobW9kZV9saWIsIGUyZV9waXBlX3Bh
cmFtLCBudW1fcGlwZXMpOworCWRsZ19zeXNfcGFyYW0uZGVlcHNsZWVwX2RjZmNsa19taHogPSBn
ZXRfY2xrX2RjZl9kZWVwc2xlZXAobW9kZV9saWIsCisJCQllMmVfcGlwZV9wYXJhbSwKKwkJCW51
bV9waXBlcyk7CisJZGxnX3N5c19wYXJhbS50X2V4dHJhX3VzID0gZ2V0X3VyZ2VudF9leHRyYV9s
YXRlbmN5KG1vZGVfbGliLCBlMmVfcGlwZV9wYXJhbSwgbnVtX3BpcGVzKTsKKwlkbGdfc3lzX3Bh
cmFtLm1lbV90cmlwX3VzID0gZ2V0X3dtX21lbW9yeV90cmlwKG1vZGVfbGliLCBlMmVfcGlwZV9w
YXJhbSwgbnVtX3BpcGVzKTsKKwlkbGdfc3lzX3BhcmFtLnRfbWNsa193bV91cyA9IGdldF93bV9k
cmFtX2Nsb2NrX2NoYW5nZShtb2RlX2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcyk7CisJ
ZGxnX3N5c19wYXJhbS50X3NyX3dtX3VzID0gZ2V0X3dtX3N0dXR0ZXJfZW50ZXJfZXhpdChtb2Rl
X2xpYiwgZTJlX3BpcGVfcGFyYW0sIG51bV9waXBlcyk7CisJZGxnX3N5c19wYXJhbS50b3RhbF9m
bGlwX2J3ID0gZ2V0X3RvdGFsX2ltbWVkaWF0ZV9mbGlwX2J3KG1vZGVfbGliLAorCQkJZTJlX3Bp
cGVfcGFyYW0sCisJCQludW1fcGlwZXMpOworCWRsZ19zeXNfcGFyYW0udG90YWxfZmxpcF9ieXRl
cyA9IGdldF90b3RhbF9pbW1lZGlhdGVfZmxpcF9ieXRlcyhtb2RlX2xpYiwKKwkJCWUyZV9waXBl
X3BhcmFtLAorCQkJbnVtX3BpcGVzKTsKKwlkbGdfc3lzX3BhcmFtLnRfc3J4X2RlbGF5X3VzID0g
bW9kZV9saWItPmlwLmRjZmNsa19jc3RhdGVfbGF0ZW5jeQorCQkJLyBkbGdfc3lzX3BhcmFtLmRl
ZXBzbGVlcF9kY2ZjbGtfbWh6OyAvLyBUT0RPOiBEZXByZWNhdGVkCisKKwlwcmludF9fZGxnX3N5
c19wYXJhbXNfc3QobW9kZV9saWIsIGRsZ19zeXNfcGFyYW0pOworCisJLy8gc3lzdGVtIHBhcmFt
ZXRlciBjYWxjdWxhdGlvbiBkb25lCisKKwlkbWxfcHJpbnQoIkRNTF9ETEc6IENhbGN1bGF0aW9u
IGZvciBwaXBlWyVkXSBzdGFydFxuXG4iLCBwaXBlX2lkeCk7CisJZG1sMjB2Ml9ycV9kbGdfZ2V0
X3JxX3BhcmFtcyhtb2RlX2xpYiwgJnJxX3BhcmFtLCBlMmVfcGlwZV9wYXJhbVtwaXBlX2lkeF0u
cGlwZS5zcmMpOworCWRtbDIwdjJfcnFfZGxnX2dldF9kbGdfcGFyYW1zKG1vZGVfbGliLAorCQkJ
ZTJlX3BpcGVfcGFyYW0sCisJCQludW1fcGlwZXMsCisJCQlwaXBlX2lkeCwKKwkJCWRsZ19yZWdz
LAorCQkJdHR1X3JlZ3MsCisJCQlycV9wYXJhbS5kbGcsCisJCQlkbGdfc3lzX3BhcmFtLAorCQkJ
Y3N0YXRlX2VuLAorCQkJcHN0YXRlX2VuKTsKKwlkbWxfcHJpbnQoIkRNTF9ETEc6IENhbGN1bGF0
aW9uIGZvciBwaXBlWyVkXSBlbmRcbiIsIHBpcGVfaWR4KTsKK30KKworc3RhdGljIHZvaWQgY2Fs
Y3VsYXRlX3R0dV9jdXJzb3Ioc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlk
b3VibGUgKnJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIsCisJCWRvdWJsZSAqcmVmY3lj
X3Blcl9yZXFfZGVsaXZlcnlfY3VyLAorCQlkb3VibGUgcmVmY2xrX2ZyZXFfaW5fbWh6LAorCQlk
b3VibGUgcmVmX2ZyZXFfdG9fcGl4X2ZyZXEsCisJCWRvdWJsZSBoc2NhbGVfcGl4ZWxfcmF0ZV9s
LAorCQlkb3VibGUgaHNjbF9yYXRpbywKKwkJZG91YmxlIHZyYXRpb19wcmVfbCwKKwkJZG91Ymxl
IHZyYXRpb19sLAorCQl1bnNpZ25lZCBpbnQgY3VyX3dpZHRoLAorCQllbnVtIGN1cnNvcl9icHAg
Y3VyX2JwcCkKK3sKKwl1bnNpZ25lZCBpbnQgY3VyX3NyY193aWR0aCA9IGN1cl93aWR0aDsKKwl1
bnNpZ25lZCBpbnQgY3VyX3JlcV9zaXplID0gMDsKKwl1bnNpZ25lZCBpbnQgY3VyX3JlcV93aWR0
aCA9IDA7CisJZG91YmxlIGN1cl93aWR0aF91YiA9IDAuMDsKKwlkb3VibGUgY3VyX3JlcV9wZXJf
d2lkdGggPSAwLjA7CisJZG91YmxlIGhhY3RpdmVfY3VyID0gMC4wOworCisJQVNTRVJUKGN1cl9z
cmNfd2lkdGggPD0gMjU2KTsKKworCSpyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfY3VyID0g
MC4wOworCSpyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIgPSAwLjA7CisJaWYgKGN1cl9zcmNf
d2lkdGggPiAwKSB7CisJCXVuc2lnbmVkIGludCBjdXJfYml0X3Blcl9waXhlbCA9IDA7CisKKwkJ
aWYgKGN1cl9icHAgPT0gZG1fY3VyXzJiaXQpIHsKKwkJCWN1cl9yZXFfc2l6ZSA9IDY0OyAvLyBi
eXRlCisJCQljdXJfYml0X3Blcl9waXhlbCA9IDI7CisJCX0gZWxzZSB7IC8vIDMyYml0CisJCQlj
dXJfYml0X3Blcl9waXhlbCA9IDMyOworCQkJaWYgKGN1cl9zcmNfd2lkdGggPj0gMSAmJiBjdXJf
c3JjX3dpZHRoIDw9IDE2KQorCQkJCWN1cl9yZXFfc2l6ZSA9IDY0OworCQkJZWxzZSBpZiAoY3Vy
X3NyY193aWR0aCA+PSAxNyAmJiBjdXJfc3JjX3dpZHRoIDw9IDMxKQorCQkJCWN1cl9yZXFfc2l6
ZSA9IDEyODsKKwkJCWVsc2UKKwkJCQljdXJfcmVxX3NpemUgPSAyNTY7CisJCX0KKworCQljdXJf
cmVxX3dpZHRoID0gKGRvdWJsZSkgY3VyX3JlcV9zaXplIC8gKChkb3VibGUpIGN1cl9iaXRfcGVy
X3BpeGVsIC8gOC4wKTsKKwkJY3VyX3dpZHRoX3ViID0gZG1sX2NlaWwoKGRvdWJsZSkgY3VyX3Ny
Y193aWR0aCAvIChkb3VibGUpIGN1cl9yZXFfd2lkdGgsIDEpCisJCQkJKiAoZG91YmxlKSBjdXJf
cmVxX3dpZHRoOworCQljdXJfcmVxX3Blcl93aWR0aCA9IGN1cl93aWR0aF91YiAvIChkb3VibGUp
IGN1cl9yZXFfd2lkdGg7CisJCWhhY3RpdmVfY3VyID0gKGRvdWJsZSkgY3VyX3NyY193aWR0aCAv
IGhzY2xfcmF0aW87IC8vIEZJWE1FOiBvc3dpbiB0byB0aGluayBhYm91dCB3aGF0IHRvIGRvIGZv
ciBjdXJzb3IKKworCQlpZiAodnJhdGlvX3ByZV9sIDw9IDEuMCkgeworCQkJKnJlZmN5Y19wZXJf
cmVxX2RlbGl2ZXJ5X3ByZV9jdXIgPSBoYWN0aXZlX2N1ciAqIHJlZl9mcmVxX3RvX3BpeF9mcmVx
CisJCQkJCS8gKGRvdWJsZSkgY3VyX3JlcV9wZXJfd2lkdGg7CisJCX0gZWxzZSB7CisJCQkqcmVm
Y3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1ciA9IChkb3VibGUpIHJlZmNsa19mcmVxX2luX21o
egorCQkJCQkqIChkb3VibGUpIGN1cl9zcmNfd2lkdGggLyBoc2NhbGVfcGl4ZWxfcmF0ZV9sCisJ
CQkJCS8gKGRvdWJsZSkgY3VyX3JlcV9wZXJfd2lkdGg7CisJCX0KKworCQlBU1NFUlQoKnJlZmN5
Y19wZXJfcmVxX2RlbGl2ZXJ5X3ByZV9jdXIgPCBkbWxfcG93KDIsIDEzKSk7CisKKwkJaWYgKHZy
YXRpb19sIDw9IDEuMCkgeworCQkJKnJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2N1ciA9IGhhY3Rp
dmVfY3VyICogcmVmX2ZyZXFfdG9fcGl4X2ZyZXEKKwkJCQkJLyAoZG91YmxlKSBjdXJfcmVxX3Bl
cl93aWR0aDsKKwkJfSBlbHNlIHsKKwkJCSpyZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9jdXIgPSAo
ZG91YmxlKSByZWZjbGtfZnJlcV9pbl9taHoKKwkJCQkJKiAoZG91YmxlKSBjdXJfc3JjX3dpZHRo
IC8gaHNjYWxlX3BpeGVsX3JhdGVfbAorCQkJCQkvIChkb3VibGUpIGN1cl9yZXFfcGVyX3dpZHRo
OworCQl9CisKKwkJZG1sX3ByaW50KCJETUxfRExHOiAlczogY3VyX3JlcV93aWR0aCAgICAgICAg
ICAgICAgICAgICAgID0gJWRcbiIsCisJCQkJX19mdW5jX18sCisJCQkJY3VyX3JlcV93aWR0aCk7
CisJCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IGN1cl93aWR0aF91YiAgICAgICAgICAgICAgICAg
ICAgICA9ICUzLjJmXG4iLAorCQkJCV9fZnVuY19fLAorCQkJCWN1cl93aWR0aF91Yik7CisJCWRt
bF9wcmludCgiRE1MX0RMRzogJXM6IGN1cl9yZXFfcGVyX3dpZHRoICAgICAgICAgICAgICAgICA9
ICUzLjJmXG4iLAorCQkJCV9fZnVuY19fLAorCQkJCWN1cl9yZXFfcGVyX3dpZHRoKTsKKwkJZG1s
X3ByaW50KCJETUxfRExHOiAlczogaGFjdGl2ZV9jdXIgICAgICAgICAgICAgICAgICAgICAgID0g
JTMuMmZcbiIsCisJCQkJX19mdW5jX18sCisJCQkJaGFjdGl2ZV9jdXIpOworCQlkbWxfcHJpbnQo
IkRNTF9ETEc6ICVzOiByZWZjeWNfcGVyX3JlcV9kZWxpdmVyeV9wcmVfY3VyICAgPSAlMy4yZlxu
IiwKKwkJCQlfX2Z1bmNfXywKKwkJCQkqcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfcHJlX2N1cik7
CisJCWRtbF9wcmludCgiRE1MX0RMRzogJXM6IHJlZmN5Y19wZXJfcmVxX2RlbGl2ZXJ5X2N1ciAg
ICAgICA9ICUzLjJmXG4iLAorCQkJCV9fZnVuY19fLAorCQkJCSpyZWZjeWNfcGVyX3JlcV9kZWxp
dmVyeV9jdXIpOworCisJCUFTU0VSVCgqcmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlfY3VyIDwgZG1s
X3BvdygyLCAxMykpOworCX0KK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9kYy9kbWwvZGNuMjAvZGlzcGxheV9ycV9kbGdfY2FsY18yMHYyLmggYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2RjbjIwL2Rpc3BsYXlfcnFfZGxnX2NhbGNfMjB2Mi5o
Cm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMDM3ODQwNmJmN2U3Ci0t
LSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RtbC9kY24y
MC9kaXNwbGF5X3JxX2RsZ19jYWxjXzIwdjIuaApAQCAtMCwwICsxLDc0IEBACisvKgorICogQ29w
eXJpZ2h0IDIwMTggQWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5jLgorICoKKyAqIFBlcm1pc3Np
b24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFp
bmluZyBhCisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRh
dGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUg
d2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgorICogdGhl
IHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUs
IHN1YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQg
dG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0
byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CisgKgorICogVGhl
IGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwg
YmUgaW5jbHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2Yg
dGhlIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBX
SVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVELCBJTkNM
VURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElU
WSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1F
TlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIENPUFlSSUdIVCBIT0xERVIoUykgT1IgQVVU
SE9SKFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SCisgKiBPVEhFUiBMSUFC
SUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lT
RSwKKyAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09G
VFdBUkUgT1IgVEhFIFVTRSBPUgorICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgor
ICoKKyAqIEF1dGhvcnM6IEFNRAorICoKKyAqLworCisjaWZuZGVmIF9fRE1MMjBWMl9ESVNQTEFZ
X1JRX0RMR19DQUxDX0hfXworI2RlZmluZSBfX0RNTDIwVjJfRElTUExBWV9SUV9ETEdfQ0FMQ19I
X18KKworI2luY2x1ZGUgIi4uL2RtbF9jb21tb25fZGVmcy5oIgorI2luY2x1ZGUgIi4uL2Rpc3Bs
YXlfcnFfZGxnX2hlbHBlcnMuaCIKKworc3RydWN0IGRpc3BsYXlfbW9kZV9saWI7CisKKworLy8g
RnVuY3Rpb246IGRtbF9ycV9kbGdfZ2V0X3JxX3JlZworLy8gIE1haW4gZW50cnkgcG9pbnQgZm9y
IHRlc3QgdG8gZ2V0IHRoZSByZWdpc3RlciB2YWx1ZXMgb3V0IG9mIHRoaXMgRE1MIGNsYXNzLgor
Ly8gIFRoaXMgZnVuY3Rpb24gY2FsbHMgPGdldF9ycV9wYXJhbT4gYW5kIDxleHRyYWN0X3JxX3Jl
Z3M+IGZ1Y250aW9ucyB0byBjYWxjdWxhdGUKKy8vICBhbmQgdGhlbiBwb3B1bGF0ZSB0aGUgcnFf
cmVncyBzdHJ1Y3QKKy8vIElucHV0OgorLy8gIHBpcGVfc3JjX3BhcmFtIC0gcGlwZSBzb3VyY2Ug
Y29uZmlndXJhdGlvbiAoZS5nLiB2cCwgcGl0Y2gsIGV0Yy4pCisvLyBPdXRwdXQ6CisvLyAgcnFf
cmVncyAtIHN0cnVjdCB0aGF0IGhvbGRzIGFsbCB0aGUgUlEgcmVnaXN0ZXJzIGZpZWxkIHZhbHVl
LgorLy8gICAgICAgICAgICBTZWUgYWxzbzogPGRpc3BsYXlfcnFfcmVnc19zdD4KK3ZvaWQgZG1s
MjB2Ml9ycV9kbGdfZ2V0X3JxX3JlZygKKwkJc3RydWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVf
bGliLAorCQlkaXNwbGF5X3JxX3JlZ3Nfc3QgKnJxX3JlZ3MsCisJCWNvbnN0IGRpc3BsYXlfcGlw
ZV9wYXJhbXNfc3QgcGlwZV9wYXJhbSk7CisKKworLy8gRnVuY3Rpb246IGRtbF9ycV9kbGdfZ2V0
X2RsZ19yZWcKKy8vICAgQ2FsY3VsYXRlIGFuZCByZXR1cm4gRExHIGFuZCBUVFUgcmVnaXN0ZXIg
c3RydWN0IGdpdmVuIHRoZSBzeXN0ZW0gc2V0dGluZworLy8gT3V0cHV0OgorLy8gIGRsZ19yZWdz
IC0gb3V0cHV0IERMRyByZWdpc3RlciBzdHJ1Y3QKKy8vICB0dHVfcmVncyAtIG91dHB1dCBETEcg
VFRVIHJlZ2lzdGVyIHN0cnVjdAorLy8gSW5wdXQ6CisvLyAgZTJlX3BpcGVfcGFyYW0gLSAiY29t
cGFjdGVkIiBhcnJheSBvZiBlMmUgcGlwZSBwYXJhbSBzdHJ1Y3QKKy8vICBudW1fcGlwZXMgLSBu
dW0gb2YgYWN0aXZlICJwaXBlIiBvciAicm91dGUiCisvLyAgcGlwZV9pZHggLSBpbmRleCB0aGF0
IGlkZW50aWZpZXMgdGhlIGUyZV9waXBlX3BhcmFtIHRoYXQgY29ycmVzcG9uZGluZyB0byB0aGlz
IGRsZworLy8gIGNzdGF0ZSAtIDA6IHdoZW4gY2FsY3VsYXRlIG1pbl90dHVfdmJsYW5rIGl0IGlz
IGFzc3VtZWQgY3N0YXRlIGlzIG5vdCByZXF1aXJlZC4gMTogTm9ybWFsIG1vZGUsIGNzdGF0ZSBp
cyBjb25zaWRlcmVkLgorLy8gICAgICAgICAgIEFkZGVkIGZvciBsZWdhY3kgb3IgdW5yZWFsaXN0
aWMgdGltaW5nIHRlc3RzLgordm9pZCBkbWwyMHYyX3JxX2RsZ19nZXRfZGxnX3JlZygKKwkJc3Ry
dWN0IGRpc3BsYXlfbW9kZV9saWIgKm1vZGVfbGliLAorCQlkaXNwbGF5X2RsZ19yZWdzX3N0ICpk
bGdfcmVncywKKwkJZGlzcGxheV90dHVfcmVnc19zdCAqdHR1X3JlZ3MsCisJCWRpc3BsYXlfZTJl
X3BpcGVfcGFyYW1zX3N0ICplMmVfcGlwZV9wYXJhbSwKKwkJY29uc3QgdW5zaWduZWQgaW50IG51
bV9waXBlcywKKwkJY29uc3QgdW5zaWduZWQgaW50IHBpcGVfaWR4LAorCQljb25zdCBib29sIGNz
dGF0ZV9lbiwKKwkJY29uc3QgYm9vbCBwc3RhdGVfZW4sCisJCWNvbnN0IGJvb2wgdm1fZW4sCisJ
CWNvbnN0IGJvb2wgaWdub3JlX3ZpZXdwb3J0X3BvcywKKwkJY29uc3QgYm9vbCBpbW1lZGlhdGVf
ZmxpcF9zdXBwb3J0KTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV9saWIuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
ZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5jCmluZGV4IDkxODEwYzdkNWNmNS4uOTZk
ZmNkOGMzNmJjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1s
L2Rpc3BsYXlfbW9kZV9saWIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMv
ZG1sL2Rpc3BsYXlfbW9kZV9saWIuYwpAQCAtMjgsNiArMjgsOCBAQAogI2lmIGRlZmluZWQoQ09O
RklHX0RSTV9BTURfRENfRENOMl8wKQogI2luY2x1ZGUgImRjbjIwL2Rpc3BsYXlfbW9kZV92YmFf
MjAuaCIKICNpbmNsdWRlICJkY24yMC9kaXNwbGF5X3JxX2RsZ19jYWxjXzIwLmgiCisjaW5jbHVk
ZSAiZGNuMjAvZGlzcGxheV9tb2RlX3ZiYV8yMHYyLmgiCisjaW5jbHVkZSAiZGNuMjAvZGlzcGxh
eV9ycV9kbGdfY2FsY18yMHYyLmgiCiAjZW5kaWYKIAogI2lmIGRlZmluZWQoQ09ORklHX0RSTV9B
TURfRENfRENOMl8wKQpAQCAtMzcsNiArMzksMTMgQEAgY29uc3Qgc3RydWN0IGRtbF9mdW5jcyBk
bWwyMF9mdW5jcyA9IHsKIAkucnFfZGxnX2dldF9kbGdfcmVnID0gZG1sMjBfcnFfZGxnX2dldF9k
bGdfcmVnLAogCS5ycV9kbGdfZ2V0X3JxX3JlZyA9IGRtbDIwX3JxX2RsZ19nZXRfcnFfcmVnCiB9
OworCitjb25zdCBzdHJ1Y3QgZG1sX2Z1bmNzIGRtbDIwdjJfZnVuY3MgPSB7CisJLnZhbGlkYXRl
ID0gZG1sMjB2Ml9Nb2RlU3VwcG9ydEFuZFN5c3RlbUNvbmZpZ3VyYXRpb25GdWxsLAorCS5yZWNh
bGN1bGF0ZSA9IGRtbDIwdjJfcmVjYWxjdWxhdGUsCisJLnJxX2RsZ19nZXRfZGxnX3JlZyA9IGRt
bDIwdjJfcnFfZGxnX2dldF9kbGdfcmVnLAorCS5ycV9kbGdfZ2V0X3JxX3JlZyA9IGRtbDIwdjJf
cnFfZGxnX2dldF9ycV9yZWcKK307CiAjZW5kaWYKIAogdm9pZCBkbWxfaW5pdF9pbnN0YW5jZShz
dHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbGliLApAQCAtNTIsNiArNjEsOSBAQCB2b2lkIGRtbF9p
bml0X2luc3RhbmNlKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICpsaWIsCiAJY2FzZSBETUxfUFJP
SkVDVF9OQVZJMTA6CiAJCWxpYi0+ZnVuY3MgPSBkbWwyMF9mdW5jczsKIAkJYnJlYWs7CisJY2Fz
ZSBETUxfUFJPSkVDVF9OQVZJMTB2MjoKKwkJbGliLT5mdW5jcyA9IGRtbDIwdjJfZnVuY3M7CisJ
CWJyZWFrOwogI2VuZGlmCiAJZGVmYXVsdDoKIAkJYnJlYWs7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV9saWIuaCBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwvZGlzcGxheV9tb2RlX2xpYi5oCmluZGV4IDViZjEz
ZDY3ZjI4OS4uODcwNzE2ZTNjMTMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV9saWIuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV9saWIuaApAQCAtMzYsNiArMzYsNyBAQCBlbnVt
IGRtbF9wcm9qZWN0IHsKIAlETUxfUFJPSkVDVF9SQVZFTjEsCiAjaWZkZWYgQ09ORklHX0RSTV9B
TURfRENfRENOMl8wCiAJRE1MX1BST0pFQ1RfTkFWSTEwLAorCURNTF9QUk9KRUNUX05BVkkxMHYy
LAogI2VuZGlmCiB9OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvZG1sL2Rpc3BsYXlfbW9kZV9zdHJ1Y3RzLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV9zdHJ1Y3RzLmgKaW5kZXggNTY3ODQ3MjU0NmFiLi5hYjM0
ZmQyNjcwMmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kbWwv
ZGlzcGxheV9tb2RlX3N0cnVjdHMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvZG1sL2Rpc3BsYXlfbW9kZV9zdHJ1Y3RzLmgKQEAgLTEwMCw2ICsxMDAsNyBAQCBzdHJ1Y3Qg
X3Zjc19kcGlfc29jX2JvdW5kaW5nX2JveF9zdCB7CiAJdW5zaWduZWQgaW50IHZtbV9wYWdlX3Np
emVfYnl0ZXM7CiAJdW5zaWduZWQgaW50IGhvc3R2bV9taW5fcGFnZV9zaXplX2J5dGVzOwogCWRv
dWJsZSBkcmFtX2Nsb2NrX2NoYW5nZV9sYXRlbmN5X3VzOworCWRvdWJsZSBkdW1teV9wc3RhdGVf
bGF0ZW5jeV91czsKIAlkb3VibGUgd3JpdGViYWNrX2RyYW1fY2xvY2tfY2hhbmdlX2xhdGVuY3lf
dXM7CiAJdW5zaWduZWQgaW50IHJldHVybl9idXNfd2lkdGhfYnl0ZXM7CiAJdW5zaWduZWQgaW50
IHZvbHRhZ2Vfb3ZlcnJpZGU7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvZG1sL2Rpc3BsYXlfbW9kZV92YmEuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxh
eS9kYy9kbWwvZGlzcGxheV9tb2RlX3ZiYS5jCmluZGV4IDRkMmExMjYyZDlkYi4uODhlNjNmMTZm
N2ZjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2Rpc3Bs
YXlfbW9kZV92YmEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZG1sL2Rp
c3BsYXlfbW9kZV92YmEuYwpAQCAtNTY4LDYgKzU2OCw3IEBAIHN0YXRpYyB2b2lkIGZldGNoX3Bp
cGVfcGFyYW1zKHN0cnVjdCBkaXNwbGF5X21vZGVfbGliICptb2RlX2xpYikKIAkJaWYgKHNyYy0+
aXNfaHNwbGl0KSB7CiAJCQlmb3IgKGsgPSBqICsgMTsgayA8IG1vZGVfbGliLT52YmEuY2FjaGVf
bnVtX3BpcGVzOyArK2spIHsKIAkJCQlkaXNwbGF5X3BpcGVfc291cmNlX3BhcmFtc19zdCAqc3Jj
X2sgPSAmcGlwZXNba10ucGlwZS5zcmM7CisJCQkJZGlzcGxheV9waXBlX2Rlc3RfcGFyYW1zX3N0
ICpkc3RfayA9ICZwaXBlc1trXS5waXBlLmRlc3Q7CiAKIAkJCQlpZiAoc3JjX2stPmlzX2hzcGxp
dCAmJiAhdmlzaXRlZFtrXQogCQkJCQkJJiYgc3JjLT5oc3BsaXRfZ3JwID09IHNyY19rLT5oc3Bs
aXRfZ3JwKSB7CkBAIC01NzUsMTIgKzU3NiwxNSBAQCBzdGF0aWMgdm9pZCBmZXRjaF9waXBlX3Bh
cmFtcyhzdHJ1Y3QgZGlzcGxheV9tb2RlX2xpYiAqbW9kZV9saWIpCiAJCQkJCQkJbW9kZV9saWIt
PnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lczsKIAkJCQkJbW9kZV9saWItPnZiYS5EUFBQZXJQbGFu
ZVttb2RlX2xpYi0+dmJhLk51bWJlck9mQWN0aXZlUGxhbmVzXSsrOwogCQkJCQlpZiAobW9kZV9s
aWItPnZiYS5Tb3VyY2VTY2FuW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFuZXNdCi0J
CQkJCQkJPT0gZG1faG9yeikKKwkJCQkJCQk9PSBkbV9ob3J6KSB7CiAJCQkJCQltb2RlX2xpYi0+
dmJhLlZpZXdwb3J0V2lkdGhbbW9kZV9saWItPnZiYS5OdW1iZXJPZkFjdGl2ZVBsYW5lc10gKz0K
IAkJCQkJCQkJc3JjX2stPnZpZXdwb3J0X3dpZHRoOwotCQkJCQllbHNlCisJCQkJCQltb2RlX2xp
Yi0+dmJhLlNjYWxlclJlY291dFdpZHRoW21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3RpdmVQbGFu
ZXNdICs9CisJCQkJCQkJCWRzdF9rLT5yZWNvdXRfd2lkdGg7CisJCQkJCX0gZWxzZSB7CiAJCQkJ
CQltb2RlX2xpYi0+dmJhLlZpZXdwb3J0SGVpZ2h0W21vZGVfbGliLT52YmEuTnVtYmVyT2ZBY3Rp
dmVQbGFuZXNdICs9CiAJCQkJCQkJCXNyY19rLT52aWV3cG9ydF9oZWlnaHQ7CisJCQkJCX0KIAog
CQkJCQl2aXNpdGVkW2tdID0gdHJ1ZTsKIAkJCQl9Ci0tIAoyLjIyLjAKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFt
ZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
