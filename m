Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 502918CDAF5
	for <lists+amd-gfx@lfdr.de>; Thu, 23 May 2024 21:38:36 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9BF8E10EE25;
	Thu, 23 May 2024 19:38:34 +0000 (UTC)
Authentication-Results: gabe.freedesktop.org;
	dkim=pass (1024-bit key; unprotected) header.d=amd.com header.i=@amd.com header.b="4qUgbjce";
	dkim-atps=neutral
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM04-MW2-obe.outbound.protection.outlook.com
 (mail-mw2nam04on2042.outbound.protection.outlook.com [40.107.101.42])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3DB9D10EE25
 for <amd-gfx@lists.freedesktop.org>; Thu, 23 May 2024 19:38:32 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=IrAxeKfNpK+xifxtJvk8BESptXSqFEzzZ1ty4JYVut0wfV+AZqHsf5i6hTwV3QzhwsGeDOwJj5NwFG/867VvxMMxmkg7+Yn/DLN1q0a3UX4FrraElokdoZ1yEhTIC5cdh4lyQwNUxw8DQJojuJNTfjA4KLdMo0z339JkO1Ws2isujjC+sFIvdcsItRiXHSIVRYaap/PbaiSNtRT1Pc35X1pFKCBUfib12djMlmnDNOm4Q+yFbnqhAz33NwFuM38rHM+bDiFRSVbjcP70ZdyJ3xjupFy7aLzwPxcTmqsdSZmd2r6YRD9+ppwMP+/fw7gMnh+0pDjDA5r0RKHi78Jp4A==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=dozEUwCurhBX2KqCr2aeYtWLbVB839yXN/B/hexiEWA=;
 b=Y6bcedXV5Foh/dKqS3ARQSH3v9XMFSAjBEObFIQOiOOm8O6GGF2WamWiwEs4cccrp14qu9L5q0I6Ol8B6mqMeP2P3jaBdZDLAbtLSP8jswyHs9Afsv+roOH+8fJjWB00LI9CNSpXO+yJlOC+I8OVOgcVkJzZ5lUkf4yf0LDkvqI6kOsnxQgt9zTjsrSA4xS9VHzjLGVjloXrTx0EDPnbKkw80kXoM5X9V+zGA/7z68TCCbBKtvv/UsmxIqnh4TmwOOIHdQ6uWKK3WYCyG31TDWz6vHx511o54aL9c+GFrsUSQqFWgNa2nkXgtPbv/XgeCZg0gDy2bKRo48/VJK7Cug==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=amd.com; s=selector1; 
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=dozEUwCurhBX2KqCr2aeYtWLbVB839yXN/B/hexiEWA=;
 b=4qUgbjceLpFBzEqnum87UmJmMB4oucjiPmiGC6WxZu2MKDFa5AWLk0CxkIA9JJ8mG3l4g+7RxMsf0EcqvTzqQvM7B1M9LgvmB/oqHF76SOa7uoK+PqS8gxRXlnyAGSEaAsOINUwzAuzqY8lRn2CcT2i72iLq5vObpG/uFFjST/o=
Received: from CY8PR12MB7099.namprd12.prod.outlook.com (2603:10b6:930:61::17)
 by IA1PR12MB6017.namprd12.prod.outlook.com (2603:10b6:208:3d7::8)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.7587.36; Thu, 23 May
 2024 19:38:27 +0000
Received: from CY8PR12MB7099.namprd12.prod.outlook.com
 ([fe80::314f:877c:8b6f:52d6]) by CY8PR12MB7099.namprd12.prod.outlook.com
 ([fe80::314f:877c:8b6f:52d6%6]) with mapi id 15.20.7611.016; Thu, 23 May 2024
 19:38:27 +0000
From: "Kasiviswanathan, Harish" <Harish.Kasiviswanathan@amd.com>
To: Alex Deucher <alexdeucher@gmail.com>, "Deucher, Alexander"
 <Alexander.Deucher@amd.com>
CC: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: RE: [PATCH] drm/amdgpu: drop MES 10.1 support v2
Thread-Topic: [PATCH] drm/amdgpu: drop MES 10.1 support v2
Thread-Index: AQHaoy3B1UqXE4WLEkmFdoaz9O1f6LGlPG4AgAAMrRA=
Date: Thu, 23 May 2024 19:38:26 +0000
Message-ID: <CY8PR12MB709958A4EC3F0E253B0CCB2B8CF42@CY8PR12MB7099.namprd12.prod.outlook.com>
References: <20240510225909.1957238-1-alexander.deucher@amd.com>
 <CADnq5_NK=KDkrwZ7HQHnZsNj56V3hySQjKXwY6nr6=WUMxJKbw@mail.gmail.com>
In-Reply-To: <CADnq5_NK=KDkrwZ7HQHnZsNj56V3hySQjKXwY6nr6=WUMxJKbw@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
msip_labels: MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_ActionId=a67a1b16-916a-4b7b-98a0-410ac5d9d820;
 MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_ContentBits=0;
 MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_Enabled=true;
 MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_Method=Standard;
 MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_Name=AMD
 Internal Distribution Only;
 MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_SetDate=2024-05-23T19:30:56Z;
 MSIP_Label_dce362fe-1558-4fb5-9f64-8a6240d76441_SiteId=3dd8961f-e488-4e60-8e11-a82d994e183d;
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=amd.com;
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: CY8PR12MB7099:EE_|IA1PR12MB6017:EE_
x-ms-office365-filtering-correlation-id: acffb47c-9d1a-4036-8192-08dc7b5feabf
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0; ARA:13230031|376005|1800799015|366007|38070700009;
x-microsoft-antispam-message-info: =?utf-8?B?VC9rOXlIeHVrVWFsNjJoVjAyQXJiTXlBRkVZQjhVZCtTN3JPeUFMWW05YnFB?=
 =?utf-8?B?UndhZmxUM1JXNTNvUktaNDVRVTVoODBQTVRwOGZhYzdxc1lDUXR6MVRhQ0N6?=
 =?utf-8?B?Nk15c21BQ2xqYTkrR1NRTTF5dXdibUUyT2lNOG94bzh3ejhYVkxDK2EzYTlW?=
 =?utf-8?B?c2x6Y2VCV0RhcFRycW12bzVGYmt4dWpnUnBEQzZmZnlBR2xGUDNIUmdscE5S?=
 =?utf-8?B?Z3hWT29WMXQzV015NVlZcEIvVkZXTGVRbGpRRFh4WDc0K1BpQjB2SDRDL1ZP?=
 =?utf-8?B?c3E4QU85b2FPWWQ5eUpkOUR0MGx3ZGxyUlBocXYxZjNacGZnQW9xU21uY01I?=
 =?utf-8?B?ems1RXd6SzVJZ1h0Vjh1Ukl1d29YSUNqZjNrT2V3NDFnVmRXNFU2dnJ2cUI1?=
 =?utf-8?B?NzRGSWIwWHBnRmRsalJMVWF3STI0aXlLckovUi8zU0wrdVNHWkV4L0gzYzNN?=
 =?utf-8?B?dGhIMHdBUHNDa2oxL01qeERmMS96b05EVlJ1WktyR3JLYTE1NmxCcGg5OWlw?=
 =?utf-8?B?cFJSaCt4bzUxMFlsekRhWDgySGt2d00rSTZKU20xaGhpY3Bkd0p4VWNWdE4v?=
 =?utf-8?B?K1puQjFzOXNORE04d01IYlpGcHcxOUFFVTBYS3ZJRlhhVHV0ZW51ekVOQkpG?=
 =?utf-8?B?d3pXclFPN1RpdzZhZ3ZyeS9ra0Nrbm9XeUFmdTZaeVBlME5SdWg4UmhtMjFu?=
 =?utf-8?B?QmUvR1Y0RkNpOEtLV2JMSlpHZktWR3hTa0RpZ2ppV1J3cW5CWFJTRXFMdmRk?=
 =?utf-8?B?MWFMdkVQRzRUTVpwNm1seE1MQmpJWUU0UitPZFoxaUE2ejVMSVIxWWhjckZs?=
 =?utf-8?B?RTdZQXp5bWZBSS83MDViZmg4VkhHcWpBOUx0L3VIVVZHOGdabCswQm54ZXVw?=
 =?utf-8?B?b0VVa3cyNG5SNFd0d0kzK1FCbi9NR081TWRoYUN0MFBrTU9mVWlheC83STRp?=
 =?utf-8?B?LzN0QXhmTHhTK1MzN2JNU3BMMEtiUHFLSVEzN3NyT29Jek9tQW5iVFpjZUwr?=
 =?utf-8?B?U0dVNW9nN2V6VU1BTW9HYmU2bmR3UDFHQ3hzMkcra1VRVm5maTJwVGFqMmhv?=
 =?utf-8?B?L1U1UHJrMFZMY2UyT2REam5YK0FBcUYwb01QUXdJOElUOTJmRStZK2VUR2Vi?=
 =?utf-8?B?S05RcHRHYkU3K0c0QTJZeXNZVTRYN0N2N2llNE40RnE1SGxjSStpSG1vSmJR?=
 =?utf-8?B?VERHZTQwbGd3cEowMzNySkxETHFLRVZCWGJYWU9SZ1NiVDNCVU1hN2NDRE0v?=
 =?utf-8?B?bTI4NlI3MVR3MmhpWUhkWmxCRHAvSkxnWEdUNHFJVUs3WGs0aHY1cUljbytU?=
 =?utf-8?B?Z0dZWldDMVlNVHlZWnNNdzVIYlZ5WVVLYTNBTStNb0VibWE5ZnZzdVY4eVNM?=
 =?utf-8?B?cHphYmlqbGE2d0tUQzgwUUVualV6TGl3WjRzMVRna3BBbVFKUjRmVVZvODY3?=
 =?utf-8?B?ZE1Zak55ZVRCbnZzWjQzYldYaERKcFg1L2UwM3o3SjM4dDFYUVpOTEttU0w1?=
 =?utf-8?B?akJTN05mb2FRQXZSWGx5QVlBMkFLRzFuaS9Ed3orVUhiN3U2QTZ6TGE3TXpB?=
 =?utf-8?B?dk0zSmpyUGtyQ2dKVGNpOEtyellGZDNBOUVCUnAzQzdaZlJha05EeXIzWUZl?=
 =?utf-8?B?V3JMS09KU29LdUZMbkJsVEJ6S2dkRjVUTFZmTGY1N0xQUUthQ1dzSFIvZXdU?=
 =?utf-8?B?emZWTUYzT1lnT21pRkkzUHJTYUd5ZVg3cjZOOEVDS2xVdUQxRG02czBjcHNC?=
 =?utf-8?B?a1pmdjNzUDY4aWR6ajBDNFhJMXdFdFAvVEV3Yk52VnIvbXFBU1lCYVZaejRZ?=
 =?utf-8?B?WmRSUE4rM05BRjhrY2FLQT09?=
x-forefront-antispam-report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:CY8PR12MB7099.namprd12.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(13230031)(376005)(1800799015)(366007)(38070700009); DIR:OUT; SFP:1101; 
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?dVZkK1RITHlFZW4xWmE4TlU0eGF6d2J4L1d1SGVmZmpubVkwaXZyWFNlS1Vj?=
 =?utf-8?B?KzNpTWN3eXJGem5mbFgyUmJrNGFLUm91anNWWllPZXIrS0k1b2VXOEJZZllC?=
 =?utf-8?B?SUVXNzRnSmpmeVVKU21nbGdnN1BVdS9VVkw2bE4wRGo1M01lRHN5WmQwbm5l?=
 =?utf-8?B?V3lPdHBxQWFLY1pjN0VQN2VZUXA3MEdPZ0s5ZjdzaklpTzlyMWlaRVU0ZG1P?=
 =?utf-8?B?WWt1TU0ycjNHZkc3YWxBMEo5clFYRjN3L2JJN2VmY2hCdGVLRXFFd3FNcGpq?=
 =?utf-8?B?d09uKzRRKzZNWGRlOVRaNm1hUjUrRER1MzhNY004N2MyNElzUlU2bzVCMmlW?=
 =?utf-8?B?a3VuL2VrcUliU1NzUWYxWHB5KzU0QmZVNG5yV08wQ1lpeUJHTEduYVpFamUz?=
 =?utf-8?B?bWJaWVhhc29nZkpiVWpiS3U5bmRCOFdoc3Vha2o3N1VVSkFPK1daUFhDR25O?=
 =?utf-8?B?R3ZhaWhtRlF4VzhWKzNBdGFxTzlBeEV5b2kvSnBmcllSOTRLUE42U0l0ZEh1?=
 =?utf-8?B?bWdnWktZaXZUMFQrWTBJOCswNjd0alI1L3FHTCszbDE1WDBZQnI0TTEvVFJy?=
 =?utf-8?B?dzAwV0lZdzAzU1dNOHdsanJNUS9sd1FPZVRLWHB3U1NpcWQwU2k4MHpsTGV0?=
 =?utf-8?B?OC9kTmlTSEp0eW1RWE9kaTdzK3huZEJGN2FmWTdpQjZaWnNuVk5pQU9NTE5I?=
 =?utf-8?B?VWZjUGtuMG1wNThuK1k1eGhNQ3hicytrZHIwMVVUQys3dzJzclRSQWM3S0tF?=
 =?utf-8?B?VUhvYjdNOFpjdjB4SUVDUE94R1hSVDRMU0tuNVBZUEZ3SFpWelFRR1JybDhi?=
 =?utf-8?B?dlhpbDVZNGtUSUk4YVFFd3UxT2s4RWZkVTVQYk5uNlhvOHp5K2VVREZENmFN?=
 =?utf-8?B?dGJNRWNrbGVraERxK2IrTFRPSmdVRlp2MWlSSlhwSnBOZXFmVGhkR1d2K1dS?=
 =?utf-8?B?a292eEVRdy9tMEYvUFNsQ3AwZlUrajRZYUNhNUh5ckh1NVI0SkhhaXpCZ1hh?=
 =?utf-8?B?aG14Q0pCNkJLWVREUXRJaTVESGQrVlNCNGV5NmxYVEJTYk9ETHlSSmtCbnpR?=
 =?utf-8?B?TDFnMiszV3dPQVJWM0RvRDUxMmlXREJNUDgxUFVIT085aEo0UE1sd1NqVVMw?=
 =?utf-8?B?a2xBeW5wSmpwWUJoU1BPZDEzL08vQWFQd3JXNk5uN3FCNk94WUNWUTZHNmZp?=
 =?utf-8?B?Zi94ZFBPaVlBVGw2OEJvN1pZakxZSG9hNHRHa292YVFlRHpCbCsydVhEdnc0?=
 =?utf-8?B?dmxBOGtzM2JUTUtvczZNNGhRU2xXRFRPdFRieDEyYk02VjFoQ3lnbDc5Rmg1?=
 =?utf-8?B?bksxaHduSStlSWRlRTUraHh4NlduOVUwVjB5WjRqM0NDRjNqaU1nM3UvWmow?=
 =?utf-8?B?VkJWQVNYWEhFZlYvR0FnN2I4RkVYVUVGUU1DalZLL25QZXVoMjM2U0Mvb0Vh?=
 =?utf-8?B?ekRtbzloZjVVUGpJcmFGby90RGtFSmlFWFM2Sk80QjJCdUZUMlJGVytMZ01q?=
 =?utf-8?B?bFNsVHlzdjgzYysrNFZ4OWlRa2R5ZHROV0NiN1k3NHhzSWFZNHEyZksxZ3BE?=
 =?utf-8?B?amRjYmx1QVh0MjlKRmRDM1J2Tldtb2plYVh3U3UvUTdJQzMwUFlQYmpIZ0t0?=
 =?utf-8?B?ais2dkNFenBHc3h2ck9GamtGV3AyWTdLUEJiSzZqWW50SGdHNlRDKzRCRXcx?=
 =?utf-8?B?dVMwVnZKVEJrQndEM1JsK1FUbjNOZ2JhZ0ZJRkVOelZ5U1Nka2ZSUjVVSFRR?=
 =?utf-8?B?dnJKTFZlaUdVUXQ4ZjdSL3Y5MTAzUzgzZmx1NnlUVTN4dHMyUG9CZW8vQkpW?=
 =?utf-8?B?dHhuRmJuZFZjU3czVWNtSStqbTMyekpEM3VRWE1XdjZRZHFZTENpdERKNjJE?=
 =?utf-8?B?eGlqQ3lnK01EOXFLdngvYlRROXc2Q0NpTmlwVWVjMDlnRHBDM21ML3VKVTFw?=
 =?utf-8?B?bjdZYWVLRTFNUDFVREdNTDJjYno0dEJPdWQvN1paMTZPZHlhNEFJbTZrZEha?=
 =?utf-8?B?eFl3d0JlenIzWXpLSGdMYlBKNXBpRnpGNUFwcjVTZjVYOTdHSFJ5UFdWOHp3?=
 =?utf-8?B?NnA0a2IzbmkzdXVDSG1UK3ZJWU5DaVlmL0JBMDEwN3lpdVFuMkVEOHNmd1JT?=
 =?utf-8?Q?UhIk=3D?=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: CY8PR12MB7099.namprd12.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: acffb47c-9d1a-4036-8192-08dc7b5feabf
X-MS-Exchange-CrossTenant-originalarrivaltime: 23 May 2024 19:38:26.9713 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: Ta+4Pz3clgEncDeqNo42Q49HHfIfZD8B3rGgDunJb4bHeHacBZKFJipB+lPqI6BC1lC6X/SJq6WrQCwXn0VMmw==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: IA1PR12MB6017
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

W0FNRCBPZmZpY2lhbCBVc2UgT25seSAtIEFNRCBJbnRlcm5hbCBEaXN0cmlidXRpb24gT25seV0N
Cg0KRmlsZSBtZXNfYXBpX2RlZi5oIGNhbiBhbHNvIGJlIHJlbW92ZWQuIFRoaXMgaXMgZGVmaW5l
ZCBmb3IgZ2Z4MTAuDQpPbmUgbWlub3IgY29tbWVudCBpbmxpbmUuDQoNCg0KLS0tLS1PcmlnaW5h
bCBNZXNzYWdlLS0tLS0NCkZyb206IGFtZC1nZnggPGFtZC1nZngtYm91bmNlc0BsaXN0cy5mcmVl
ZGVza3RvcC5vcmc+IE9uIEJlaGFsZiBPZiBBbGV4IERldWNoZXINClNlbnQ6IFRodXJzZGF5LCBN
YXkgMjMsIDIwMjQgMjo0NiBQTQ0KVG86IERldWNoZXIsIEFsZXhhbmRlciA8QWxleGFuZGVyLkRl
dWNoZXJAYW1kLmNvbT4NCkNjOiBhbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZw0KU3ViamVj
dDogUmU6IFtQQVRDSF0gZHJtL2FtZGdwdTogZHJvcCBNRVMgMTAuMSBzdXBwb3J0IHYyDQoNClBp
bmc/DQoNCk9uIEZyaSwgTWF5IDEwLCAyMDI0IGF0IDc6MzfigK9QTSBBbGV4IERldWNoZXIgPGFs
ZXhhbmRlci5kZXVjaGVyQGFtZC5jb20+IHdyb3RlOg0KPg0KPiBJdCB3YXMgYW4gZW5hYmxlbWVu
dCB2ZWhpY2xlIGZvciBNRVMgMTEgYW5kIHdhcyBuZXZlcg0KPiBwcm9kdWN0aXplZC4gIFJlbW92
ZSBpdC4NCj4NCj4gdjI6IGRyb3AgYWRkaXRpb25hbCBjaGVja3MgaW4gdGhlIEdGWDEwIGNvZGUu
DQo+DQo+IFNpZ25lZC1vZmYtYnk6IEFsZXggRGV1Y2hlciA8YWxleGFuZGVyLmRldWNoZXJAYW1k
LmNvbT4NCj4gLS0tDQo+ICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9NYWtlZmlsZSAgICAg
ICAgICAgfCAgICAxIC0NCj4gIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kaXNj
b3ZlcnkuYyB8ICAgMjAgLQ0KPiAgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3YxMF8w
LmMgICAgICAgIHwgIDI4MSArLS0tDQo+ICBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9tZXNf
djEwXzEuYyAgICAgICAgfCAxMTkwIC0tLS0tLS0tLS0tLS0tLS0tDQo+ICBkcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9tZXNfdjEwXzEuaCAgICAgICAgfCAgIDI5IC0NCj4gIGRyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L252LmMgICAgICAgICAgICAgICB8ICAgIDEgLQ0KPiAgNiBmaWxlcyBj
aGFuZ2VkLCA3MSBpbnNlcnRpb25zKCspLCAxNDUxIGRlbGV0aW9ucygtKQ0KPiAgZGVsZXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L21lc192MTBfMS5jDQo+ICBkZWxl
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbWVzX3YxMF8xLmgNCj4N
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L01ha2VmaWxlIGIvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvTWFrZWZpbGUNCj4gaW5kZXggZGU3Yjc2MzI3ZjViYS4u
NmUxMjM3YTk3YTkxZSAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
TWFrZWZpbGUNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvTWFrZWZpbGUNCj4g
QEAgLTE4Nyw3ICsxODcsNiBAQCBhbWRncHUteSArPSBcDQo+ICAjIGFkZCBNRVMgYmxvY2sNCj4g
IGFtZGdwdS15ICs9IFwNCj4gICAgICAgICBhbWRncHVfbWVzLm8gXA0KPiAtICAgICAgIG1lc192
MTBfMS5vIFwNCj4gICAgICAgICBtZXNfdjExXzAubyBcDQo+ICAgICAgICAgbWVzX3YxMl8wLm8N
Cj4NCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kaXNj
b3ZlcnkuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9kaXNjb3ZlcnkuYw0K
PiBpbmRleCA4MjRkZDViNTdkMGQzLi40N2U0NWUxNzAwMzI2IDEwMDY0NA0KPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZGlzY292ZXJ5LmMNCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rpc2NvdmVyeS5jDQo+IEBAIC05NCw3ICs5NCw2
IEBADQo+ICAjaW5jbHVkZSAidmNuX3Y0XzBfNS5oIg0KPiAgI2luY2x1ZGUgImpwZWdfdjRfMF81
LmgiDQo+ICAjaW5jbHVkZSAiYW1kZ3B1X3ZrbXMuaCINCj4gLSNpbmNsdWRlICJtZXNfdjEwXzEu
aCINCj4gICNpbmNsdWRlICJtZXNfdjExXzAuaCINCj4gICNpbmNsdWRlICJtZXNfdjEyXzAuaCIN
Cj4gICNpbmNsdWRlICJzbXVpb192MTFfMC5oIg0KPiBAQCAtMjIxNSwyNSArMjIxNCw2IEBAIHN0
YXRpYyBpbnQgYW1kZ3B1X2Rpc2NvdmVyeV9zZXRfbW1faXBfYmxvY2tzKHN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2KQ0KPiAgc3RhdGljIGludCBhbWRncHVfZGlzY292ZXJ5X3NldF9tZXNfaXBf
YmxvY2tzKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQ0KPiAgew0KPiAgICAgICAgIHN3aXRj
aCAoYW1kZ3B1X2lwX3ZlcnNpb24oYWRldiwgR0NfSFdJUCwgMCkpIHsNCj4gLSAgICAgICBjYXNl
IElQX1ZFUlNJT04oMTAsIDEsIDEwKToNCj4gLSAgICAgICBjYXNlIElQX1ZFUlNJT04oMTAsIDEs
IDEpOg0KPiAtICAgICAgIGNhc2UgSVBfVkVSU0lPTigxMCwgMSwgMik6DQo+IC0gICAgICAgY2Fz
ZSBJUF9WRVJTSU9OKDEwLCAxLCAzKToNCj4gLSAgICAgICBjYXNlIElQX1ZFUlNJT04oMTAsIDEs
IDQpOg0KPiAtICAgICAgIGNhc2UgSVBfVkVSU0lPTigxMCwgMywgMCk6DQo+IC0gICAgICAgY2Fz
ZSBJUF9WRVJTSU9OKDEwLCAzLCAxKToNCj4gLSAgICAgICBjYXNlIElQX1ZFUlNJT04oMTAsIDMs
IDIpOg0KPiAtICAgICAgIGNhc2UgSVBfVkVSU0lPTigxMCwgMywgMyk6DQo+IC0gICAgICAgY2Fz
ZSBJUF9WRVJTSU9OKDEwLCAzLCA0KToNCj4gLSAgICAgICBjYXNlIElQX1ZFUlNJT04oMTAsIDMs
IDUpOg0KPiAtICAgICAgIGNhc2UgSVBfVkVSU0lPTigxMCwgMywgNik6DQo+IC0gICAgICAgICAg
ICAgICBpZiAoYW1kZ3B1X21lcykgew0KPiAtICAgICAgICAgICAgICAgICAgICAgICBhbWRncHVf
ZGV2aWNlX2lwX2Jsb2NrX2FkZChhZGV2LCAmbWVzX3YxMF8xX2lwX2Jsb2NrKTsNCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgYWRldi0+ZW5hYmxlX21lcyA9IHRydWU7DQo+IC0gICAgICAgICAg
ICAgICAgICAgICAgIGlmIChhbWRncHVfbWVzX2tpcSkNCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBhZGV2LT5lbmFibGVfbWVzX2tpcSA9IHRydWU7DQo+IC0gICAgICAgICAgICAg
ICB9DQo+IC0gICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICBjYXNlIElQX1ZFUlNJT04o
MTEsIDAsIDApOg0KPiAgICAgICAgIGNhc2UgSVBfVkVSU0lPTigxMSwgMCwgMSk6DQo+ICAgICAg
ICAgY2FzZSBJUF9WRVJTSU9OKDExLCAwLCAyKToNCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2dmeF92MTBfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
Z2Z4X3YxMF8wLmMNCj4gaW5kZXggZmNiMGZiZDFhMTEyMi4uMjEyMDhiYmNkNzBlZiAxMDA2NDQN
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3YxMF8wLmMNCj4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ2Z4X3YxMF8wLmMNCj4gQEAgLTM2NjQsMTQgKzM2
NjQsOCBAQCBzdGF0aWMgdm9pZCBnZngxMF9raXFfdW5tYXBfcXVldWVzKHN0cnVjdCBhbWRncHVf
cmluZyAqa2lxX3JpbmcsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51
bSBhbWRncHVfdW5tYXBfcXVldWVzX2FjdGlvbiBhY3Rpb24sDQo+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdTY0IGdwdV9hZGRyLCB1NjQgc2VxKQ0KPiAgew0KPiAtICAgICAg
IHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0ga2lxX3JpbmctPmFkZXY7DQo+ICAgICAgICAg
dWludDMyX3QgZW5nX3NlbCA9IHJpbmctPmZ1bmNzLT50eXBlID09IEFNREdQVV9SSU5HX1RZUEVf
R0ZYID8gNCA6IDA7DQo+DQo+IC0gICAgICAgaWYgKGFkZXYtPmVuYWJsZV9tZXMgJiYgIWFkZXYt
PmdmeC5raXFbMF0ucmluZy5zY2hlZC5yZWFkeSkgew0KPiAtICAgICAgICAgICAgICAgYW1kZ3B1
X21lc191bm1hcF9sZWdhY3lfcXVldWUoYWRldiwgcmluZywgYWN0aW9uLCBncHVfYWRkciwgc2Vx
KTsNCj4gLSAgICAgICAgICAgICAgIHJldHVybjsNCj4gLSAgICAgICB9DQo+IC0NCj4gICAgICAg
ICBhbWRncHVfcmluZ193cml0ZShraXFfcmluZywgUEFDS0VUMyhQQUNLRVQzX1VOTUFQX1FVRVVF
UywgNCkpOw0KPiAgICAgICAgIGFtZGdwdV9yaW5nX3dyaXRlKGtpcV9yaW5nLCAvKiBRX3NlbDog
MCwgdm1pZDogMCwgZW5naW5lOiAwLCBudW1fUTogMSAqLw0KPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFBBQ0tFVDNfVU5NQVBfUVVFVUVTX0FDVElPTihhY3Rpb24pIHwNCj4gQEAgLTM5Mjks
MzMgKzM5MjMsMTggQEAgc3RhdGljIGludCBnZnhfdjEwXzBfcmluZ190ZXN0X2liKHN0cnVjdCBh
bWRncHVfcmluZyAqcmluZywgbG9uZyB0aW1lb3V0KQ0KPg0KPiAgICAgICAgIG1lbXNldCgmaWIs
IDAsIHNpemVvZihpYikpOw0KPg0KPiAtICAgICAgIGlmIChyaW5nLT5pc19tZXNfcXVldWUpIHsN
Cj4gLSAgICAgICAgICAgICAgIHVpbnQzMl90IHBhZGRpbmcsIG9mZnNldDsNCj4gLQ0KPiAtICAg
ICAgICAgICAgICAgb2Zmc2V0ID0gYW1kZ3B1X21lc19jdHhfZ2V0X29mZnMocmluZywgQU1ER1BV
X01FU19DVFhfSUJfT0ZGUyk7DQo+IC0gICAgICAgICAgICAgICBwYWRkaW5nID0gYW1kZ3B1X21l
c19jdHhfZ2V0X29mZnMocmluZywNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBBTURHUFVfTUVTX0NUWF9QQURESU5HX09GRlMpOw0KPiAtDQo+IC0g
ICAgICAgICAgICAgICBpYi5ncHVfYWRkciA9IGFtZGdwdV9tZXNfY3R4X2dldF9vZmZzX2dwdV9h
ZGRyKHJpbmcsIG9mZnNldCk7DQo+IC0gICAgICAgICAgICAgICBpYi5wdHIgPSBhbWRncHVfbWVz
X2N0eF9nZXRfb2Zmc19jcHVfYWRkcihyaW5nLCBvZmZzZXQpOw0KPiAtDQo+IC0gICAgICAgICAg
ICAgICBncHVfYWRkciA9IGFtZGdwdV9tZXNfY3R4X2dldF9vZmZzX2dwdV9hZGRyKHJpbmcsIHBh
ZGRpbmcpOw0KPiAtICAgICAgICAgICAgICAgY3B1X3B0ciA9IGFtZGdwdV9tZXNfY3R4X2dldF9v
ZmZzX2NwdV9hZGRyKHJpbmcsIHBhZGRpbmcpOw0KPiAtICAgICAgICAgICAgICAgKmNwdV9wdHIg
PSBjcHVfdG9fbGUzMigweENBRkVERUFEKTsNCj4gLSAgICAgICB9IGVsc2Ugew0KPiAtICAgICAg
ICAgICAgICAgciA9IGFtZGdwdV9kZXZpY2Vfd2JfZ2V0KGFkZXYsICZpbmRleCk7DQo+IC0gICAg
ICAgICAgICAgICBpZiAocikNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7DQo+
ICsgICAgICAgciA9IGFtZGdwdV9kZXZpY2Vfd2JfZ2V0KGFkZXYsICZpbmRleCk7DQo+ICsgICAg
ICAgaWYgKHIpDQo+ICsgICAgICAgICAgICAgICByZXR1cm4gcjsNCj4NCj4gLSAgICAgICAgICAg
ICAgIGdwdV9hZGRyID0gYWRldi0+d2IuZ3B1X2FkZHIgKyAoaW5kZXggKiA0KTsNCj4gLSAgICAg
ICAgICAgICAgIGFkZXYtPndiLndiW2luZGV4XSA9IGNwdV90b19sZTMyKDB4Q0FGRURFQUQpOw0K
PiAtICAgICAgICAgICAgICAgY3B1X3B0ciA9ICZhZGV2LT53Yi53YltpbmRleF07DQo+ICsgICAg
ICAgZ3B1X2FkZHIgPSBhZGV2LT53Yi5ncHVfYWRkciArIChpbmRleCAqIDQpOw0KPiArICAgICAg
IGFkZXYtPndiLndiW2luZGV4XSA9IGNwdV90b19sZTMyKDB4Q0FGRURFQUQpOw0KPiArICAgICAg
IGNwdV9wdHIgPSAmYWRldi0+d2Iud2JbaW5kZXhdOw0KPg0KPiAtICAgICAgICAgICAgICAgciA9
IGFtZGdwdV9pYl9nZXQoYWRldiwgTlVMTCwgMjAsIEFNREdQVV9JQl9QT09MX0RJUkVDVCwgJmli
KTsNCj4gLSAgICAgICAgICAgICAgIGlmIChyKSB7DQo+IC0gICAgICAgICAgICAgICAgICAgICAg
IERSTV9FUlJPUigiYW1kZ3B1OiBmYWlsZWQgdG8gZ2V0IGliICglbGQpLlxuIiwgcik7DQo+IC0g
ICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyMTsNCj4gLSAgICAgICAgICAgICAgIH0NCj4g
KyAgICAgICByID0gYW1kZ3B1X2liX2dldChhZGV2LCBOVUxMLCAyMCwgQU1ER1BVX0lCX1BPT0xf
RElSRUNULCAmaWIpOw0KPiArICAgICAgIGlmIChyKSB7DQo+ICsgICAgICAgICAgICAgICBEUk1f
RVJST1IoImFtZGdwdTogZmFpbGVkIHRvIGdldCBpYiAoJWxkKS5cbiIsIHIpOw0KPiArICAgICAg
ICAgICAgICAgZ290byBlcnIxOw0KPiAgICAgICAgIH0NCj4NCj4gICAgICAgICBpYi5wdHJbMF0g
PSBQQUNLRVQzKFBBQ0tFVDNfV1JJVEVfREFUQSwgMyk7DQo+IEBAIC0zOTgyLDEyICszOTYxLDEw
IEBAIHN0YXRpYyBpbnQgZ2Z4X3YxMF8wX3JpbmdfdGVzdF9pYihzdHJ1Y3QgYW1kZ3B1X3Jpbmcg
KnJpbmcsIGxvbmcgdGltZW91dCkNCj4gICAgICAgICBlbHNlDQo+ICAgICAgICAgICAgICAgICBy
ID0gLUVJTlZBTDsNCj4gIGVycjI6DQo+IC0gICAgICAgaWYgKCFyaW5nLT5pc19tZXNfcXVldWUp
DQo+IC0gICAgICAgICAgICAgICBhbWRncHVfaWJfZnJlZShhZGV2LCAmaWIsIE5VTEwpOw0KPiAr
ICAgICAgIGFtZGdwdV9pYl9mcmVlKGFkZXYsICZpYiwgTlVMTCk7DQo+ICAgICAgICAgZG1hX2Zl
bmNlX3B1dChmKTsNCj4gIGVycjE6DQo+IC0gICAgICAgaWYgKCFyaW5nLT5pc19tZXNfcXVldWUp
DQo+IC0gICAgICAgICAgICAgICBhbWRncHVfZGV2aWNlX3diX2ZyZWUoYWRldiwgaW5kZXgpOw0K
PiArICAgICAgIGFtZGdwdV9kZXZpY2Vfd2JfZnJlZShhZGV2LCBpbmRleCk7DQo+ICAgICAgICAg
cmV0dXJuIHI7DQo+ICB9DQo+DQo+IEBAIC00NzM1LDE4ICs0NzEyLDE2IEBAIHN0YXRpYyBpbnQg
Z2Z4X3YxMF8wX3N3X2luaXQodm9pZCAqaGFuZGxlKQ0KPiAgICAgICAgICAgICAgICAgfQ0KPiAg
ICAgICAgIH0NCj4NCj4gLSAgICAgICBpZiAoIWFkZXYtPmVuYWJsZV9tZXNfa2lxKSB7DQo+IC0g
ICAgICAgICAgICAgICByID0gYW1kZ3B1X2dmeF9raXFfaW5pdChhZGV2LCBHRlgxMF9NRUNfSFBE
X1NJWkUsIDApOw0KPiAtICAgICAgICAgICAgICAgaWYgKHIpIHsNCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgRFJNX0VSUk9SKCJGYWlsZWQgdG8gaW5pdCBLSVEgQk9zIVxuIik7DQo+IC0gICAg
ICAgICAgICAgICAgICAgICAgIHJldHVybiByOw0KPiAtICAgICAgICAgICAgICAgfQ0KPiAtDQo+
IC0gICAgICAgICAgICAgICByID0gYW1kZ3B1X2dmeF9raXFfaW5pdF9yaW5nKGFkZXYsIHhjY19p
ZCk7DQo+IC0gICAgICAgICAgICAgICBpZiAocikNCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuIHI7DQo+ICsgICAgICAgciA9IGFtZGdwdV9nZnhfa2lxX2luaXQoYWRldiwgR0ZYMTBf
TUVDX0hQRF9TSVpFLCAwKTsNCj4gKyAgICAgICBpZiAocikgew0KPiArICAgICAgICAgICAgICAg
RFJNX0VSUk9SKCJGYWlsZWQgdG8gaW5pdCBLSVEgQk9zIVxuIik7DQo+ICsgICAgICAgICAgICAg
ICByZXR1cm4gcjsNCj4gICAgICAgICB9DQo+DQo+ICsgICAgICAgciA9IGFtZGdwdV9nZnhfa2lx
X2luaXRfcmluZyhhZGV2LCB4Y2NfaWQpOw0KPiArICAgICAgIGlmIChyKQ0KPiArICAgICAgICAg
ICAgICAgcmV0dXJuIHI7DQo+ICsNCj4gICAgICAgICByID0gYW1kZ3B1X2dmeF9tcWRfc3dfaW5p
dChhZGV2LCBzaXplb2Yoc3RydWN0IHYxMF9jb21wdXRlX21xZCksIDApOw0KPiAgICAgICAgIGlm
IChyKQ0KPiAgICAgICAgICAgICAgICAgcmV0dXJuIHI7DQo+IEBAIC00ODAwLDEwICs0Nzc1LDgg
QEAgc3RhdGljIGludCBnZnhfdjEwXzBfc3dfZmluaSh2b2lkICpoYW5kbGUpDQo+DQo+ICAgICAg
ICAgYW1kZ3B1X2dmeF9tcWRfc3dfZmluaShhZGV2LCAwKTsNCj4NCj4gLSAgICAgICBpZiAoIWFk
ZXYtPmVuYWJsZV9tZXNfa2lxKSB7DQo+IC0gICAgICAgICAgICAgICBhbWRncHVfZ2Z4X2tpcV9m
cmVlX3JpbmcoJmFkZXYtPmdmeC5raXFbMF0ucmluZyk7DQo+IC0gICAgICAgICAgICAgICBhbWRn
cHVfZ2Z4X2tpcV9maW5pKGFkZXYsIDApOw0KPiAtICAgICAgIH0NCj4gKyAgICAgICBhbWRncHVf
Z2Z4X2tpcV9mcmVlX3JpbmcoJmFkZXYtPmdmeC5raXFbMF0ucmluZyk7DQo+ICsgICAgICAgYW1k
Z3B1X2dmeF9raXFfZmluaShhZGV2LCAwKTsNCj4NCj4gICAgICAgICBnZnhfdjEwXzBfcGZwX2Zp
bmkoYWRldik7DQo+ICAgICAgICAgZ2Z4X3YxMF8wX2NlX2ZpbmkoYWRldik7DQo+IEBAIC03MDEy
LDEwICs2OTg1LDcgQEAgc3RhdGljIGludCBnZnhfdjEwXzBfY3BfcmVzdW1lKHN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2KQ0KPiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjsNCj4g
ICAgICAgICB9DQo+DQo+IC0gICAgICAgaWYgKGFkZXYtPmVuYWJsZV9tZXNfa2lxICYmIGFkZXYt
Pm1lcy5raXFfaHdfaW5pdCkNCj4gLSAgICAgICAgICAgICAgIHIgPSBhbWRncHVfbWVzX2tpcV9o
d19pbml0KGFkZXYpOw0KPiAtICAgICAgIGVsc2UNCj4gLSAgICAgICAgICAgICAgIHIgPSBnZnhf
djEwXzBfa2lxX3Jlc3VtZShhZGV2KTsNCj4gKyAgICAgICByID0gZ2Z4X3YxMF8wX2tpcV9yZXN1
bWUoYWRldik7DQo+ICAgICAgICAgaWYgKHIpDQo+ICAgICAgICAgICAgICAgICByZXR1cm4gcjsN
Cj4NCj4gQEAgLTgzMjcsNDUgKzgyOTcsMTcgQEAgc3RhdGljIHU2NCBnZnhfdjEwXzBfcmluZ19n
ZXRfd3B0cl9nZngoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQ0KPiAgc3RhdGljIHZvaWQgZ2Z4
X3YxMF8wX3Jpbmdfc2V0X3dwdHJfZ2Z4KHN0cnVjdCBhbWRncHVfcmluZyAqcmluZykNCj4gIHsN
Cj4gICAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IHJpbmctPmFkZXY7DQo+IC0g
ICAgICAgdWludDMyX3QgKndwdHJfc2F2ZWQ7DQo+IC0gICAgICAgdWludDMyX3QgKmlzX3F1ZXVl
X3VubWFwOw0KPiAtICAgICAgIHVpbnQ2NF90IGFnZ3JlZ2F0ZWRfZGJfaW5kZXg7DQo+IC0gICAg
ICAgdWludDMyX3QgbXFkX3NpemUgPSBhZGV2LT5tcWRzW0FNREdQVV9IV19JUF9HRlhdLm1xZF9z
aXplOw0KPiAtICAgICAgIHVpbnQ2NF90IHdwdHJfdG1wOw0KPiAtDQo+IC0gICAgICAgaWYgKHJp
bmctPmlzX21lc19xdWV1ZSkgew0KPiAtICAgICAgICAgICAgICAgd3B0cl9zYXZlZCA9ICh1aW50
MzJfdCAqKShyaW5nLT5tcWRfcHRyICsgbXFkX3NpemUpOw0KPiAtICAgICAgICAgICAgICAgaXNf
cXVldWVfdW5tYXAgPSAodWludDMyX3QgKikocmluZy0+bXFkX3B0ciArIG1xZF9zaXplICsNCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZih1aW50
MzJfdCkpOw0KPiAtICAgICAgICAgICAgICAgYWdncmVnYXRlZF9kYl9pbmRleCA9DQo+IC0gICAg
ICAgICAgICAgICAgICAgICAgIGFtZGdwdV9tZXNfZ2V0X2FnZ3JlZ2F0ZWRfZG9vcmJlbGxfaW5k
ZXgoYWRldiwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgQU1ER1BVX01FU19QUklPUklUWV9M
RVZFTF9OT1JNQUwpOw0KPiAtDQo+IC0gICAgICAgICAgICAgICB3cHRyX3RtcCA9IHJpbmctPndw
dHIgJiByaW5nLT5idWZfbWFzazsNCj4gLSAgICAgICAgICAgICAgIGF0b21pYzY0X3NldCgoYXRv
bWljNjRfdCAqKXJpbmctPndwdHJfY3B1X2FkZHIsIHdwdHJfdG1wKTsNCj4gLSAgICAgICAgICAg
ICAgICp3cHRyX3NhdmVkID0gd3B0cl90bXA7DQo+IC0gICAgICAgICAgICAgICAvKiBhc3N1bWUg
ZG9vcmJlbGwgYWx3YXlzIGJlaW5nIHVzZWQgYnkgbWVzIG1hcHBlZCBxdWV1ZSAqLw0KPiAtICAg
ICAgICAgICAgICAgaWYgKCppc19xdWV1ZV91bm1hcCkgew0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICBXRE9PUkJFTEw2NChhZ2dyZWdhdGVkX2RiX2luZGV4LCB3cHRyX3RtcCk7DQo+IC0gICAg
ICAgICAgICAgICAgICAgICAgIFdET09SQkVMTDY0KHJpbmctPmRvb3JiZWxsX2luZGV4LCB3cHRy
X3RtcCk7DQo+IC0gICAgICAgICAgICAgICB9IGVsc2Ugew0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICBXRE9PUkJFTEw2NChyaW5nLT5kb29yYmVsbF9pbmRleCwgd3B0cl90bXApOw0KPg0KPiAt
ICAgICAgICAgICAgICAgICAgICAgICBpZiAoKmlzX3F1ZXVlX3VubWFwKQ0KPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFdET09SQkVMTDY0KGFnZ3JlZ2F0ZWRfZGJfaW5kZXgsIHdw
dHJfdG1wKTsNCj4gLSAgICAgICAgICAgICAgIH0NCj4gKyAgICAgICBpZiAocmluZy0+dXNlX2Rv
b3JiZWxsKSB7DQo+ICsgICAgICAgICAgICAgICAvKiBYWFggY2hlY2sgaWYgc3dhcHBpbmcgaXMg
bmVjZXNzYXJ5IG9uIEJFICovDQo+ICsgICAgICAgICAgICAgICBhdG9taWM2NF9zZXQoKGF0b21p
YzY0X3QgKilyaW5nLT53cHRyX2NwdV9hZGRyLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHJpbmctPndwdHIpOw0KPiArICAgICAgICAgICAgICAgV0RPT1JCRUxMNjQocmluZy0+ZG9v
cmJlbGxfaW5kZXgsIHJpbmctPndwdHIpOw0KPiAgICAgICAgIH0gZWxzZSB7DQo+IC0gICAgICAg
ICAgICAgICBpZiAocmluZy0+dXNlX2Rvb3JiZWxsKSB7DQo+IC0gICAgICAgICAgICAgICAgICAg
ICAgIC8qIFhYWCBjaGVjayBpZiBzd2FwcGluZyBpcyBuZWNlc3Nhcnkgb24gQkUgKi8NCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgYXRvbWljNjRfc2V0KChhdG9taWM2NF90ICopcmluZy0+d3B0
cl9jcHVfYWRkciwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpbmct
PndwdHIpOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBXRE9PUkJFTEw2NChyaW5nLT5kb29y
YmVsbF9pbmRleCwgcmluZy0+d3B0cik7DQo+IC0gICAgICAgICAgICAgICB9IGVsc2Ugew0KPiAt
ICAgICAgICAgICAgICAgICAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfUkIwX1dQVFIs
DQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb3dlcl8zMl9iaXRzKHJp
bmctPndwdHIpKTsNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgV1JFRzMyX1NPQzE1KEdDLCAw
LCBtbUNQX1JCMF9XUFRSX0hJLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdXBwZXJfMzJfYml0cyhyaW5nLT53cHRyKSk7DQo+IC0gICAgICAgICAgICAgICB9DQo+ICsg
ICAgICAgICAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfUkIwX1dQVFIsDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJfMzJfYml0cyhyaW5nLT53cHRyKSk7DQo+ICsg
ICAgICAgICAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfUkIwX1dQVFJfSEksDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJfMzJfYml0cyhyaW5nLT53cHRyKSk7DQo+
ICAgICAgICAgfQ0KPiAgfQ0KPg0KPiBAQCAtODM5MCw0MiArODMzMiwxMyBAQCBzdGF0aWMgdTY0
IGdmeF92MTBfMF9yaW5nX2dldF93cHRyX2NvbXB1dGUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5n
KQ0KPiAgc3RhdGljIHZvaWQgZ2Z4X3YxMF8wX3Jpbmdfc2V0X3dwdHJfY29tcHV0ZShzdHJ1Y3Qg
YW1kZ3B1X3JpbmcgKnJpbmcpDQo+ICB7DQo+ICAgICAgICAgc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYgPSByaW5nLT5hZGV2Ow0KPiAtICAgICAgIHVpbnQzMl90ICp3cHRyX3NhdmVkOw0KPiAt
ICAgICAgIHVpbnQzMl90ICppc19xdWV1ZV91bm1hcDsNCj4gLSAgICAgICB1aW50NjRfdCBhZ2dy
ZWdhdGVkX2RiX2luZGV4Ow0KPiAtICAgICAgIHVpbnQzMl90IG1xZF9zaXplID0gYWRldi0+bXFk
c1tBTURHUFVfSFdfSVBfQ09NUFVURV0ubXFkX3NpemU7DQo+IC0gICAgICAgdWludDY0X3Qgd3B0
cl90bXA7DQo+IC0NCj4gLSAgICAgICBpZiAocmluZy0+aXNfbWVzX3F1ZXVlKSB7DQo+IC0gICAg
ICAgICAgICAgICB3cHRyX3NhdmVkID0gKHVpbnQzMl90ICopKHJpbmctPm1xZF9wdHIgKyBtcWRf
c2l6ZSk7DQo+IC0gICAgICAgICAgICAgICBpc19xdWV1ZV91bm1hcCA9ICh1aW50MzJfdCAqKShy
aW5nLT5tcWRfcHRyICsgbXFkX3NpemUgKw0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc2l6ZW9mKHVpbnQzMl90KSk7DQo+IC0gICAgICAgICAgICAgICBh
Z2dyZWdhdGVkX2RiX2luZGV4ID0NCj4gLSAgICAgICAgICAgICAgICAgICAgICAgYW1kZ3B1X21l
c19nZXRfYWdncmVnYXRlZF9kb29yYmVsbF9pbmRleChhZGV2LA0KPiAtICAgICAgICAgICAgICAg
ICAgICAgICBBTURHUFVfTUVTX1BSSU9SSVRZX0xFVkVMX05PUk1BTCk7DQo+IC0NCj4gLSAgICAg
ICAgICAgICAgIHdwdHJfdG1wID0gcmluZy0+d3B0ciAmIHJpbmctPmJ1Zl9tYXNrOw0KPiAtICAg
ICAgICAgICAgICAgYXRvbWljNjRfc2V0KChhdG9taWM2NF90ICopcmluZy0+d3B0cl9jcHVfYWRk
ciwgd3B0cl90bXApOw0KPiAtICAgICAgICAgICAgICAgKndwdHJfc2F2ZWQgPSB3cHRyX3RtcDsN
Cj4gLSAgICAgICAgICAgICAgIC8qIGFzc3VtZSBkb29yYmVsbCBhbHdheXMgdXNlZCBieSBtZXMg
bWFwcGVkIHF1ZXVlICovDQo+IC0gICAgICAgICAgICAgICBpZiAoKmlzX3F1ZXVlX3VubWFwKSB7
DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIFdET09SQkVMTDY0KGFnZ3JlZ2F0ZWRfZGJfaW5k
ZXgsIHdwdHJfdG1wKTsNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgV0RPT1JCRUxMNjQocmlu
Zy0+ZG9vcmJlbGxfaW5kZXgsIHdwdHJfdG1wKTsNCj4gLSAgICAgICAgICAgICAgIH0gZWxzZSB7
DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIFdET09SQkVMTDY0KHJpbmctPmRvb3JiZWxsX2lu
ZGV4LCB3cHRyX3RtcCk7DQo+DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICgqaXNfcXVl
dWVfdW5tYXApDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV0RPT1JCRUxMNjQo
YWdncmVnYXRlZF9kYl9pbmRleCwgd3B0cl90bXApOw0KPiAtICAgICAgICAgICAgICAgfQ0KPiAr
ICAgICAgIGlmIChyaW5nLT51c2VfZG9vcmJlbGwpIHsNCj4gKyAgICAgICAgICAgICAgIGF0b21p
YzY0X3NldCgoYXRvbWljNjRfdCAqKXJpbmctPndwdHJfY3B1X2FkZHIsDQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcmluZy0+d3B0cik7DQo+ICsgICAgICAgICAgICAgICBXRE9PUkJF
TEw2NChyaW5nLT5kb29yYmVsbF9pbmRleCwgcmluZy0+d3B0cik7DQo+ICAgICAgICAgfSBlbHNl
IHsNCj4gLSAgICAgICAgICAgICAgIC8qIFhYWCBjaGVjayBpZiBzd2FwcGluZyBpcyBuZWNlc3Nh
cnkgb24gQkUgKi8NCj4gLSAgICAgICAgICAgICAgIGlmIChyaW5nLT51c2VfZG9vcmJlbGwpIHsN
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgYXRvbWljNjRfc2V0KChhdG9taWM2NF90ICopcmlu
Zy0+d3B0cl9jcHVfYWRkciwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHJpbmctPndwdHIpOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBXRE9PUkJFTEw2NChyaW5n
LT5kb29yYmVsbF9pbmRleCwgcmluZy0+d3B0cik7DQo+IC0gICAgICAgICAgICAgICB9IGVsc2Ug
ew0KPiAtICAgICAgICAgICAgICAgICAgICAgICBCVUcoKTsgLyogb25seSBET09SQkVMTCBtZXRo
b2Qgc3VwcG9ydGVkIG9uIGdmeDEwIG5vdyAqLw0KPiAtICAgICAgICAgICAgICAgfQ0KPiArICAg
ICAgICAgICAgICAgQlVHKCk7IC8qIG9ubHkgRE9PUkJFTEwgbWV0aG9kIHN1cHBvcnRlZCBvbiBn
ZngxMCBub3cgKi8NCj4gICAgICAgICB9DQo+ICB9DQo+DQo+IEBAIC04NDg0LDEwICs4Mzk3LDYg
QEAgc3RhdGljIHZvaWQgZ2Z4X3YxMF8wX3JpbmdfZW1pdF9pYl9nZngoc3RydWN0IGFtZGdwdV9y
aW5nICpyaW5nLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIWFtZGdw
dV9zcmlvdl92ZihyaW5nLT5hZGV2KSAmJiBmbGFncyAmIEFNREdQVV9JQl9QUkVFTVBURUQpID8g
dHJ1ZSA6IGZhbHNlKTsNCj4gICAgICAgICB9DQo+DQo+IC0gICAgICAgaWYgKHJpbmctPmlzX21l
c19xdWV1ZSkNCj4gLSAgICAgICAgICAgICAgIC8qIGluaGVyaXQgdm1pZCBmcm9tIG1xZCAqLw0K
PiAtICAgICAgICAgICAgICAgY29udHJvbCB8PSAweDQwMDAwMDsNCj4gLQ0KPiAgICAgICAgIGFt
ZGdwdV9yaW5nX3dyaXRlKHJpbmcsIGhlYWRlcik7DQo+ICAgICAgICAgQlVHX09OKGliLT5ncHVf
YWRkciAmIDB4Myk7IC8qIER3b3JkIGFsaWduICovDQo+ICAgICAgICAgYW1kZ3B1X3Jpbmdfd3Jp
dGUocmluZywNCj4gQEAgLTg1MDcsMTAgKzg0MTYsNiBAQCBzdGF0aWMgdm9pZCBnZnhfdjEwXzBf
cmluZ19lbWl0X2liX2NvbXB1dGUoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nLA0KPiAgICAgICAg
IHVuc2lnbmVkIGludCB2bWlkID0gQU1ER1BVX0pPQl9HRVRfVk1JRChqb2IpOw0KPiAgICAgICAg
IHUzMiBjb250cm9sID0gSU5ESVJFQ1RfQlVGRkVSX1ZBTElEIHwgaWItPmxlbmd0aF9kdyB8ICh2
bWlkIDw8IDI0KTsNCj4NCj4gLSAgICAgICBpZiAocmluZy0+aXNfbWVzX3F1ZXVlKQ0KPiAtICAg
ICAgICAgICAgICAgLyogaW5oZXJpdCB2bWlkIGZyb20gbXFkICovDQo+IC0gICAgICAgICAgICAg
ICBjb250cm9sIHw9IDB4NDAwMDAwMDA7DQo+IC0NCj4gICAgICAgICAvKiBDdXJyZW50bHksIHRo
ZXJlIGlzIGEgaGlnaCBwb3NzaWJpbGl0eSB0byBnZXQgd2F2ZSBJRCBtaXNtYXRjaA0KPiAgICAg
ICAgICAqIGJldHdlZW4gTUUgYW5kIEdEUywgbGVhZGluZyB0byBhIGh3IGRlYWRsb2NrLCBiZWNh
dXNlIE1FIGdlbmVyYXRlcw0KPiAgICAgICAgICAqIGRpZmZlcmVudCB3YXZlIElEcyB0aGFuIHRo
ZSBHRFMgZXhwZWN0cy4gVGhpcyBzaXR1YXRpb24gaGFwcGVucw0KPiBAQCAtODU2OCw4ICs4NDcz
LDcgQEAgc3RhdGljIHZvaWQgZ2Z4X3YxMF8wX3JpbmdfZW1pdF9mZW5jZShzdHJ1Y3QgYW1kZ3B1
X3JpbmcgKnJpbmcsIHU2NCBhZGRyLA0KPiAgICAgICAgIGFtZGdwdV9yaW5nX3dyaXRlKHJpbmcs
IHVwcGVyXzMyX2JpdHMoYWRkcikpOw0KPiAgICAgICAgIGFtZGdwdV9yaW5nX3dyaXRlKHJpbmcs
IGxvd2VyXzMyX2JpdHMoc2VxKSk7DQo+ICAgICAgICAgYW1kZ3B1X3Jpbmdfd3JpdGUocmluZywg
dXBwZXJfMzJfYml0cyhzZXEpKTsNCj4gLSAgICAgICBhbWRncHVfcmluZ193cml0ZShyaW5nLCBy
aW5nLT5pc19tZXNfcXVldWUgPw0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgKHJpbmctPmh3
X3F1ZXVlX2lkIHwgQU1ER1BVX0ZFTkNFX01FU19RVUVVRV9GTEFHKSA6IDApOw0KPiArICAgICAg
IGFtZGdwdV9yaW5nX3dyaXRlKHJpbmcsIDApOw0KPiAgfQ0KPg0KPiAgc3RhdGljIHZvaWQgZ2Z4
X3YxMF8wX3JpbmdfZW1pdF9waXBlbGluZV9zeW5jKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZykN
Cj4gQEAgLTg1OTcsMTAgKzg1MDEsNyBAQCBzdGF0aWMgdm9pZCBnZnhfdjEwXzBfcmluZ19pbnZh
bGlkYXRlX3RsYnMoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nLA0KPiAgc3RhdGljIHZvaWQgZ2Z4
X3YxMF8wX3JpbmdfZW1pdF92bV9mbHVzaChzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsDQo+ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHZtaWQs
IHVpbnQ2NF90IHBkX2FkZHIpDQo+ICB7DQo+IC0gICAgICAgaWYgKHJpbmctPmlzX21lc19xdWV1
ZSkNCj4gLSAgICAgICAgICAgICAgIGdmeF92MTBfMF9yaW5nX2ludmFsaWRhdGVfdGxicyhyaW5n
LCAwLCAwLCBmYWxzZSwgMCk7DQoNCmdmeF92MTBfMF9yaW5nX2ludmFsaWRhdGVfdGxicyA6IGZ1
bmN0aW9uIGNhbiBiZSByZW1vdmVkLg0KDQo+IC0gICAgICAgZWxzZQ0KPiAtICAgICAgICAgICAg
ICAgYW1kZ3B1X2dtY19lbWl0X2ZsdXNoX2dwdV90bGIocmluZywgdm1pZCwgcGRfYWRkcik7DQo+
ICsgICAgICAgYW1kZ3B1X2dtY19lbWl0X2ZsdXNoX2dwdV90bGIocmluZywgdm1pZCwgcGRfYWRk
cik7DQo+DQo+ICAgICAgICAgLyogY29tcHV0ZSBkb2Vzbid0IGhhdmUgUEZQICovDQo+ICAgICAg
ICAgaWYgKHJpbmctPmZ1bmNzLT50eXBlID09IEFNREdQVV9SSU5HX1RZUEVfR0ZYKSB7DQo+IEBA
IC04NzUxLDE5ICs4NjUyLDkgQEAgc3RhdGljIHZvaWQgZ2Z4X3YxMF8wX3JpbmdfZW1pdF9jZV9t
ZXRhKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZywgYm9vbCByZXN1bWUpDQo+DQo+ICAgICAgICAg
Y250ID0gKHNpemVvZihjZV9wYXlsb2FkKSA+PiAyKSArIDQgLSAyOw0KPg0KPiAtICAgICAgIGlm
IChyaW5nLT5pc19tZXNfcXVldWUpIHsNCj4gLSAgICAgICAgICAgICAgIG9mZnNldCA9IG9mZnNl
dG9mKHN0cnVjdCBhbWRncHVfbWVzX2N0eF9tZXRhX2RhdGEsDQo+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBnZnhbMF0uZ2Z4X21ldGFfZGF0YSkgKw0KPiAtICAgICAgICAgICAg
ICAgICAgICAgICBvZmZzZXRvZihzdHJ1Y3QgdjEwX2dmeF9tZXRhX2RhdGEsIGNlX3BheWxvYWQp
Ow0KPiAtICAgICAgICAgICAgICAgY2VfcGF5bG9hZF9ncHVfYWRkciA9DQo+IC0gICAgICAgICAg
ICAgICAgICAgICAgIGFtZGdwdV9tZXNfY3R4X2dldF9vZmZzX2dwdV9hZGRyKHJpbmcsIG9mZnNl
dCk7DQo+IC0gICAgICAgICAgICAgICBjZV9wYXlsb2FkX2NwdV9hZGRyID0NCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgYW1kZ3B1X21lc19jdHhfZ2V0X29mZnNfY3B1X2FkZHIocmluZywgb2Zm
c2V0KTsNCj4gLSAgICAgICB9IGVsc2Ugew0KPiAtICAgICAgICAgICAgICAgb2Zmc2V0ID0gb2Zm
c2V0b2Yoc3RydWN0IHYxMF9nZnhfbWV0YV9kYXRhLCBjZV9wYXlsb2FkKTsNCj4gLSAgICAgICAg
ICAgICAgIGNlX3BheWxvYWRfZ3B1X2FkZHIgPSBhbWRncHVfY3NhX3ZhZGRyKHJpbmctPmFkZXYp
ICsgb2Zmc2V0Ow0KPiAtICAgICAgICAgICAgICAgY2VfcGF5bG9hZF9jcHVfYWRkciA9IGFkZXYt
PnZpcnQuY3NhX2NwdV9hZGRyICsgb2Zmc2V0Ow0KPiAtICAgICAgIH0NCj4gKyAgICAgICBvZmZz
ZXQgPSBvZmZzZXRvZihzdHJ1Y3QgdjEwX2dmeF9tZXRhX2RhdGEsIGNlX3BheWxvYWQpOw0KPiAr
ICAgICAgIGNlX3BheWxvYWRfZ3B1X2FkZHIgPSBhbWRncHVfY3NhX3ZhZGRyKHJpbmctPmFkZXYp
ICsgb2Zmc2V0Ow0KPiArICAgICAgIGNlX3BheWxvYWRfY3B1X2FkZHIgPSBhZGV2LT52aXJ0LmNz
YV9jcHVfYWRkciArIG9mZnNldDsNCj4NCj4gICAgICAgICBhbWRncHVfcmluZ193cml0ZShyaW5n
LCBQQUNLRVQzKFBBQ0tFVDNfV1JJVEVfREFUQSwgY250KSk7DQo+ICAgICAgICAgYW1kZ3B1X3Jp
bmdfd3JpdGUocmluZywgKFdSSVRFX0RBVEFfRU5HSU5FX1NFTCgyKSB8DQo+IEBAIC04Nzg5LDI4
ICs4NjgwLDEzIEBAIHN0YXRpYyB2b2lkIGdmeF92MTBfMF9yaW5nX2VtaXRfZGVfbWV0YShzdHJ1
Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsIGJvb2wgcmVzdW1lKQ0KPiAgICAgICAgIHZvaWQgKmRlX3Bh
eWxvYWRfY3B1X2FkZHI7DQo+ICAgICAgICAgaW50IGNudDsNCj4NCj4gLSAgICAgICBpZiAocmlu
Zy0+aXNfbWVzX3F1ZXVlKSB7DQo+IC0gICAgICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXRvZihz
dHJ1Y3QgYW1kZ3B1X21lc19jdHhfbWV0YV9kYXRhLA0KPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZ2Z4WzBdLmdmeF9tZXRhX2RhdGEpICsNCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgb2Zmc2V0b2Yoc3RydWN0IHYxMF9nZnhfbWV0YV9kYXRhLCBkZV9wYXlsb2FkKTsNCj4g
LSAgICAgICAgICAgICAgIGRlX3BheWxvYWRfZ3B1X2FkZHIgPQ0KPiAtICAgICAgICAgICAgICAg
ICAgICAgICBhbWRncHVfbWVzX2N0eF9nZXRfb2Zmc19ncHVfYWRkcihyaW5nLCBvZmZzZXQpOw0K
PiAtICAgICAgICAgICAgICAgZGVfcGF5bG9hZF9jcHVfYWRkciA9DQo+IC0gICAgICAgICAgICAg
ICAgICAgICAgIGFtZGdwdV9tZXNfY3R4X2dldF9vZmZzX2NwdV9hZGRyKHJpbmcsIG9mZnNldCk7
DQo+IC0NCj4gLSAgICAgICAgICAgICAgIG9mZnNldCA9IG9mZnNldG9mKHN0cnVjdCBhbWRncHVf
bWVzX2N0eF9tZXRhX2RhdGEsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
ZnhbMF0uZ2RzX2JhY2t1cCkgKw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRvZihz
dHJ1Y3QgdjEwX2dmeF9tZXRhX2RhdGEsIGRlX3BheWxvYWQpOw0KPiAtICAgICAgICAgICAgICAg
Z2RzX2FkZHIgPSBhbWRncHVfbWVzX2N0eF9nZXRfb2Zmc19ncHVfYWRkcihyaW5nLCBvZmZzZXQp
Ow0KPiAtICAgICAgIH0gZWxzZSB7DQo+IC0gICAgICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXRv
ZihzdHJ1Y3QgdjEwX2dmeF9tZXRhX2RhdGEsIGRlX3BheWxvYWQpOw0KPiAtICAgICAgICAgICAg
ICAgZGVfcGF5bG9hZF9ncHVfYWRkciA9IGFtZGdwdV9jc2FfdmFkZHIocmluZy0+YWRldikgKyBv
ZmZzZXQ7DQo+IC0gICAgICAgICAgICAgICBkZV9wYXlsb2FkX2NwdV9hZGRyID0gYWRldi0+dmly
dC5jc2FfY3B1X2FkZHIgKyBvZmZzZXQ7DQo+ICsgICAgICAgb2Zmc2V0ID0gb2Zmc2V0b2Yoc3Ry
dWN0IHYxMF9nZnhfbWV0YV9kYXRhLCBkZV9wYXlsb2FkKTsNCj4gKyAgICAgICBkZV9wYXlsb2Fk
X2dwdV9hZGRyID0gYW1kZ3B1X2NzYV92YWRkcihyaW5nLT5hZGV2KSArIG9mZnNldDsNCj4gKyAg
ICAgICBkZV9wYXlsb2FkX2NwdV9hZGRyID0gYWRldi0+dmlydC5jc2FfY3B1X2FkZHIgKyBvZmZz
ZXQ7DQo+DQo+IC0gICAgICAgICAgICAgICBnZHNfYWRkciA9IEFMSUdOKGFtZGdwdV9jc2FfdmFk
ZHIocmluZy0+YWRldikgKw0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBTURH
UFVfQ1NBX1NJWkUgLSBhZGV2LT5nZHMuZ2RzX3NpemUsDQo+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFBBR0VfU0laRSk7DQo+IC0gICAgICAgfQ0KPiArICAgICAgIGdkc19hZGRy
ID0gQUxJR04oYW1kZ3B1X2NzYV92YWRkcihyaW5nLT5hZGV2KSArDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICBBTURHUFVfQ1NBX1NJWkUgLSBhZGV2LT5nZHMuZ2RzX3NpemUsDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICBQQUdFX1NJWkUpOw0KPg0KPiAgICAgICAgIGRlX3BheWxvYWQu
Z2RzX2JhY2t1cF9hZGRybG8gPSBsb3dlcl8zMl9iaXRzKGdkc19hZGRyKTsNCj4gICAgICAgICBk
ZV9wYXlsb2FkLmdkc19iYWNrdXBfYWRkcmhpID0gdXBwZXJfMzJfYml0cyhnZHNfYWRkcik7DQo+
IEBAIC05MDYyLDQ5ICs4OTM4LDM0IEBAIHN0YXRpYyBpbnQgZ2Z4X3YxMF8wX2VvcF9pcnEoc3Ry
dWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQo+ICAgICAgICAgaW50IGk7DQo+ICAgICAgICAgdTgg
bWVfaWQsIHBpcGVfaWQsIHF1ZXVlX2lkOw0KPiAgICAgICAgIHN0cnVjdCBhbWRncHVfcmluZyAq
cmluZzsNCj4gLSAgICAgICB1aW50MzJfdCBtZXNfcXVldWVfaWQgPSBlbnRyeS0+c3JjX2RhdGFb
MF07DQo+DQo+ICAgICAgICAgRFJNX0RFQlVHKCJJSDogQ1AgRU9QXG4iKTsNCj4NCj4gLSAgICAg
ICBpZiAoYWRldi0+ZW5hYmxlX21lcyAmJiAobWVzX3F1ZXVlX2lkICYgQU1ER1BVX0ZFTkNFX01F
U19RVUVVRV9GTEFHKSkgew0KPiAtICAgICAgICAgICAgICAgc3RydWN0IGFtZGdwdV9tZXNfcXVl
dWUgKnF1ZXVlOw0KPiAtDQo+IC0gICAgICAgICAgICAgICBtZXNfcXVldWVfaWQgJj0gQU1ER1BV
X0ZFTkNFX01FU19RVUVVRV9JRF9NQVNLOw0KPiAtDQo+IC0gICAgICAgICAgICAgICBzcGluX2xv
Y2soJmFkZXYtPm1lcy5xdWV1ZV9pZF9sb2NrKTsNCj4gLSAgICAgICAgICAgICAgIHF1ZXVlID0g
aWRyX2ZpbmQoJmFkZXYtPm1lcy5xdWV1ZV9pZF9pZHIsIG1lc19xdWV1ZV9pZCk7DQo+IC0gICAg
ICAgICAgICAgICBpZiAocXVldWUpIHsNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgRFJNX0RF
QlVHKCJwcm9jZXNzIG1lcyBxdWV1ZSBpZCA9ICVkXG4iLCBtZXNfcXVldWVfaWQpOw0KPiAtICAg
ICAgICAgICAgICAgICAgICAgICBhbWRncHVfZmVuY2VfcHJvY2VzcyhxdWV1ZS0+cmluZyk7DQo+
IC0gICAgICAgICAgICAgICB9DQo+IC0gICAgICAgICAgICAgICBzcGluX3VubG9jaygmYWRldi0+
bWVzLnF1ZXVlX2lkX2xvY2spOw0KPiAtICAgICAgIH0gZWxzZSB7DQo+IC0gICAgICAgICAgICAg
ICBtZV9pZCA9IChlbnRyeS0+cmluZ19pZCAmIDB4MGMpID4+IDI7DQo+IC0gICAgICAgICAgICAg
ICBwaXBlX2lkID0gKGVudHJ5LT5yaW5nX2lkICYgMHgwMykgPj4gMDsNCj4gLSAgICAgICAgICAg
ICAgIHF1ZXVlX2lkID0gKGVudHJ5LT5yaW5nX2lkICYgMHg3MCkgPj4gNDsNCj4gKyAgICAgICBt
ZV9pZCA9IChlbnRyeS0+cmluZ19pZCAmIDB4MGMpID4+IDI7DQo+ICsgICAgICAgcGlwZV9pZCA9
IChlbnRyeS0+cmluZ19pZCAmIDB4MDMpID4+IDA7DQo+ICsgICAgICAgcXVldWVfaWQgPSAoZW50
cnktPnJpbmdfaWQgJiAweDcwKSA+PiA0Ow0KPg0KPiAtICAgICAgICAgICAgICAgc3dpdGNoICht
ZV9pZCkgew0KPiAtICAgICAgICAgICAgICAgY2FzZSAwOg0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICBpZiAocGlwZV9pZCA9PSAwKQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGFtZGdwdV9mZW5jZV9wcm9jZXNzKCZhZGV2LT5nZnguZ2Z4X3JpbmdbMF0pOw0KPiAtICAgICAg
ICAgICAgICAgICAgICAgICBlbHNlDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YW1kZ3B1X2ZlbmNlX3Byb2Nlc3MoJmFkZXYtPmdmeC5nZnhfcmluZ1sxXSk7DQo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAtICAgICAgICAgICAgICAgY2FzZSAxOg0KPiAtICAg
ICAgICAgICAgICAgY2FzZSAyOg0KPiAtICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAw
OyBpIDwgYWRldi0+Z2Z4Lm51bV9jb21wdXRlX3JpbmdzOyBpKyspIHsNCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICByaW5nID0gJmFkZXYtPmdmeC5jb21wdXRlX3JpbmdbaV07DQo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogUGVyLXF1ZXVlIGludGVycnVwdCBp
cyBzdXBwb3J0ZWQgZm9yIE1FQyBzdGFydGluZyBmcm9tIFZJLg0KPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAqIFRoZSBpbnRlcnJ1cHQgY2FuIG9ubHkgYmUgZW5hYmxlZC9kaXNh
YmxlZCBwZXIgcGlwZSBpbnN0ZWFkDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICogb2YgcGVyIHF1ZXVlLg0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLw0K
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocmluZy0+bWUgPT0gbWVfaWQp
ICYmDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyaW5nLT5waXBlID09
IHBpcGVfaWQpICYmDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyaW5n
LT5xdWV1ZSA9PSBxdWV1ZV9pZCkpDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBhbWRncHVfZmVuY2VfcHJvY2VzcyhyaW5nKTsNCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgfQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gKyAgICAgICBzd2l0
Y2ggKG1lX2lkKSB7DQo+ICsgICAgICAgY2FzZSAwOg0KPiArICAgICAgICAgICAgICAgaWYgKHBp
cGVfaWQgPT0gMCkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgYW1kZ3B1X2ZlbmNlX3Byb2Nl
c3MoJmFkZXYtPmdmeC5nZnhfcmluZ1swXSk7DQo+ICsgICAgICAgICAgICAgICBlbHNlDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGFtZGdwdV9mZW5jZV9wcm9jZXNzKCZhZGV2LT5nZnguZ2Z4
X3JpbmdbMV0pOw0KPiArICAgICAgICAgICAgICAgYnJlYWs7DQo+ICsgICAgICAgY2FzZSAxOg0K
PiArICAgICAgIGNhc2UgMjoNCj4gKyAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBhZGV2
LT5nZngubnVtX2NvbXB1dGVfcmluZ3M7IGkrKykgew0KPiArICAgICAgICAgICAgICAgICAgICAg
ICByaW5nID0gJmFkZXYtPmdmeC5jb21wdXRlX3JpbmdbaV07DQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIC8qIFBlci1xdWV1ZSBpbnRlcnJ1cHQgaXMgc3VwcG9ydGVkIGZvciBNRUMgc3RhcnRp
bmcgZnJvbSBWSS4NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICogVGhlIGludGVycnVwdCBj
YW4gb25seSBiZSBlbmFibGVkL2Rpc2FibGVkIHBlciBwaXBlIGluc3RlYWQNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICogb2YgcGVyIHF1ZXVlLg0KPiArICAgICAgICAgICAgICAgICAgICAg
ICAgKi8NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKChyaW5nLT5tZSA9PSBtZV9pZCkg
JiYNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIChyaW5nLT5waXBlID09IHBpcGVfaWQp
ICYmDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAocmluZy0+cXVldWUgPT0gcXVldWVf
aWQpKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtZGdwdV9mZW5jZV9wcm9j
ZXNzKHJpbmcpOw0KPiAgICAgICAgICAgICAgICAgfQ0KPiArICAgICAgICAgICAgICAgYnJlYWs7
DQo+ICAgICAgICAgfQ0KPg0KPiAgICAgICAgIHJldHVybiAwOw0KPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2FtZC9hbWRncHUvbWVzX3YxMF8xLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9tZXNfdjEwXzEuYw0KPiBkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQNCj4gaW5kZXgg
MDEzYWE2OTAyOTllYy4uMDAwMDAwMDAwMDAwMA0KPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9tZXNfdjEwXzEuYw0KPiArKysgL2Rldi9udWxsDQo+IEBAIC0xLDExOTAgKzAsMCBA
QA0KPiAtLyoNCj4gLSAqIENvcHlyaWdodCAyMDE5IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIElu
Yy4NCj4gLSAqDQo+IC0gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNo
YXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQ0KPiAtICogY29weSBvZiB0aGlzIHNvZnR3
YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwN
Cj4gLSAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1
ZGluZyB3aXRob3V0IGxpbWl0YXRpb24NCj4gLSAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBt
b2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLA0KPiAtICogYW5k
L29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRv
IHdob20gdGhlDQo+IC0gKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3Qg
dG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOg0KPiAtICoNCj4gLSAqIFRoZSBhYm92ZSBjb3B5
cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVk
IGluDQo+IC0gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0
d2FyZS4NCj4gLSAqDQo+IC0gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lU
SE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUg0KPiAtICogSU1QTElFRCwgSU5D
TFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJ
VFksDQo+IC0gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklO
R0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwNCj4gLSAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMp
IE9SIEFVVEhPUihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUg0KPiAtICog
T1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBP
UiBPVEhFUldJU0UsDQo+IC0gKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9O
IFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1INCj4gLSAqIE9USEVSIERFQUxJTkdTIElO
IFRIRSBTT0ZUV0FSRS4NCj4gLSAqDQo+IC0gKi8NCj4gLQ0KPiAtI2luY2x1ZGUgPGxpbnV4L2Zp
cm13YXJlLmg+DQo+IC0jaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+DQo+IC0jaW5jbHVkZSAiYW1k
Z3B1LmgiDQo+IC0jaW5jbHVkZSAiYW1kZ3B1X3Jlc2V0LmgiDQo+IC0jaW5jbHVkZSAic29jMTVf
Y29tbW9uLmgiDQo+IC0jaW5jbHVkZSAibnYuaCINCj4gLSNpbmNsdWRlICJnYy9nY18xMF8xXzBf
b2Zmc2V0LmgiDQo+IC0jaW5jbHVkZSAiZ2MvZ2NfMTBfMV8wX3NoX21hc2suaCINCj4gLSNpbmNs
dWRlICJnYy9nY18xMF8xXzBfZGVmYXVsdC5oIg0KPiAtI2luY2x1ZGUgInYxMF9zdHJ1Y3RzLmgi
DQo+IC0jaW5jbHVkZSAibWVzX2FwaV9kZWYuaCINCj4gLQ0KPiAtI2RlZmluZSBtbUNQX01FU19J
Q19PUF9DTlRMX1NpZW5uYV9DaWNobGlkICAgICAgICAgICAgICAgMHgyODIwDQo+IC0jZGVmaW5l
IG1tQ1BfTUVTX0lDX09QX0NOVExfU2llbm5hX0NpY2hsaWRfQkFTRV9JRFggICAgICAxDQo+IC0j
ZGVmaW5lIG1tUkxDX0NQX1NDSEVEVUxFUlNfU2llbm5hX0NpY2hsaWQgICAgICAgICAgICAgMHg0
Y2ExDQo+IC0jZGVmaW5lIG1tUkxDX0NQX1NDSEVEVUxFUlNfU2llbm5hX0NpY2hsaWRfQkFTRV9J
RFggICAgMQ0KPiAtDQo+IC1NT0RVTEVfRklSTVdBUkUoImFtZGdwdS9uYXZpMTBfbWVzLmJpbiIp
Ow0KPiAtTU9EVUxFX0ZJUk1XQVJFKCJhbWRncHUvc2llbm5hX2NpY2hsaWRfbWVzLmJpbiIpOw0K
PiAtTU9EVUxFX0ZJUk1XQVJFKCJhbWRncHUvc2llbm5hX2NpY2hsaWRfbWVzMS5iaW4iKTsNCj4g
LQ0KPiAtc3RhdGljIGludCBtZXNfdjEwXzFfaHdfZmluaSh2b2lkICpoYW5kbGUpOw0KPiAtc3Rh
dGljIGludCBtZXNfdjEwXzFfa2lxX2h3X2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYp
Ow0KPiAtDQo+IC0jZGVmaW5lIE1FU19FT1BfU0laRSAgIDIwNDgNCj4gLQ0KPiAtc3RhdGljIHZv
aWQgbWVzX3YxMF8xX3Jpbmdfc2V0X3dwdHIoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQ0KPiAt
ew0KPiAtICAgICAgIHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gcmluZy0+YWRldjsNCj4g
LQ0KPiAtICAgICAgIGlmIChyaW5nLT51c2VfZG9vcmJlbGwpIHsNCj4gLSAgICAgICAgICAgICAg
IGF0b21pYzY0X3NldCgoYXRvbWljNjRfdCAqKXJpbmctPndwdHJfY3B1X2FkZHIsDQo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcmluZy0+d3B0cik7DQo+IC0gICAgICAgICAgICAgICBX
RE9PUkJFTEw2NChyaW5nLT5kb29yYmVsbF9pbmRleCwgcmluZy0+d3B0cik7DQo+IC0gICAgICAg
fSBlbHNlIHsNCj4gLSAgICAgICAgICAgICAgIEJVRygpOw0KPiAtICAgICAgIH0NCj4gLX0NCj4g
LQ0KPiAtc3RhdGljIHU2NCBtZXNfdjEwXzFfcmluZ19nZXRfcnB0cihzdHJ1Y3QgYW1kZ3B1X3Jp
bmcgKnJpbmcpDQo+IC17DQo+IC0gICAgICAgcmV0dXJuICpyaW5nLT5ycHRyX2NwdV9hZGRyOw0K
PiAtfQ0KPiAtDQo+IC1zdGF0aWMgdTY0IG1lc192MTBfMV9yaW5nX2dldF93cHRyKHN0cnVjdCBh
bWRncHVfcmluZyAqcmluZykNCj4gLXsNCj4gLSAgICAgICB1NjQgd3B0cjsNCj4gLQ0KPiAtICAg
ICAgIGlmIChyaW5nLT51c2VfZG9vcmJlbGwpDQo+IC0gICAgICAgICAgICAgICB3cHRyID0gYXRv
bWljNjRfcmVhZCgoYXRvbWljNjRfdCAqKXJpbmctPndwdHJfY3B1X2FkZHIpOw0KPiAtICAgICAg
IGVsc2UNCj4gLSAgICAgICAgICAgICAgIEJVRygpOw0KPiAtICAgICAgIHJldHVybiB3cHRyOw0K
PiAtfQ0KPiAtDQo+IC1zdGF0aWMgY29uc3Qgc3RydWN0IGFtZGdwdV9yaW5nX2Z1bmNzIG1lc192
MTBfMV9yaW5nX2Z1bmNzID0gew0KPiAtICAgICAgIC50eXBlID0gQU1ER1BVX1JJTkdfVFlQRV9N
RVMsDQo+IC0gICAgICAgLmFsaWduX21hc2sgPSAxLA0KPiAtICAgICAgIC5ub3AgPSAwLA0KPiAt
ICAgICAgIC5zdXBwb3J0XzY0Yml0X3B0cnMgPSB0cnVlLA0KPiAtICAgICAgIC5nZXRfcnB0ciA9
IG1lc192MTBfMV9yaW5nX2dldF9ycHRyLA0KPiAtICAgICAgIC5nZXRfd3B0ciA9IG1lc192MTBf
MV9yaW5nX2dldF93cHRyLA0KPiAtICAgICAgIC5zZXRfd3B0ciA9IG1lc192MTBfMV9yaW5nX3Nl
dF93cHRyLA0KPiAtICAgICAgIC5pbnNlcnRfbm9wID0gYW1kZ3B1X3JpbmdfaW5zZXJ0X25vcCwN
Cj4gLX07DQo+IC0NCj4gLXN0YXRpYyBpbnQgbWVzX3YxMF8xX3N1Ym1pdF9wa3RfYW5kX3BvbGxf
Y29tcGxldGlvbihzdHJ1Y3QgYW1kZ3B1X21lcyAqbWVzLA0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqcGt0LCBpbnQgc2l6ZSwNCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBh
cGlfc3RhdHVzX29mZikNCj4gLXsNCj4gLSAgICAgICBpbnQgbmR3ID0gc2l6ZSAvIDQ7DQo+IC0g
ICAgICAgc2lnbmVkIGxvbmcgcjsNCj4gLSAgICAgICB1bmlvbiBNRVNBUElfX0FERF9RVUVVRSAq
eF9wa3QgPSBwa3Q7DQo+IC0gICAgICAgc3RydWN0IE1FU19BUElfU1RBVFVTICphcGlfc3RhdHVz
Ow0KPiAtICAgICAgIHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gbWVzLT5hZGV2Ow0KPiAt
ICAgICAgIHN0cnVjdCBhbWRncHVfcmluZyAqcmluZyA9ICZtZXMtPnJpbmc7DQo+IC0gICAgICAg
dW5zaWduZWQgbG9uZyBmbGFnczsNCj4gLQ0KPiAtICAgICAgIEJVR19PTihzaXplICUgNCAhPSAw
KTsNCj4gLQ0KPiAtICAgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZtZXMtPnJpbmdfbG9jaywgZmxh
Z3MpOw0KPiAtICAgICAgIGlmIChhbWRncHVfcmluZ19hbGxvYyhyaW5nLCBuZHcpKSB7DQo+IC0g
ICAgICAgICAgICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZtZXMtPnJpbmdfbG9jaywgZmxh
Z3MpOw0KPiAtICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07DQo+IC0gICAgICAgfQ0KPiAt
DQo+IC0gICAgICAgYXBpX3N0YXR1cyA9IChzdHJ1Y3QgTUVTX0FQSV9TVEFUVVMgKikoKGNoYXIg
Kilwa3QgKyBhcGlfc3RhdHVzX29mZik7DQo+IC0gICAgICAgYXBpX3N0YXR1cy0+YXBpX2NvbXBs
ZXRpb25fZmVuY2VfYWRkciA9IG1lcy0+cmluZy5mZW5jZV9kcnYuZ3B1X2FkZHI7DQo+IC0gICAg
ICAgYXBpX3N0YXR1cy0+YXBpX2NvbXBsZXRpb25fZmVuY2VfdmFsdWUgPSArK21lcy0+cmluZy5m
ZW5jZV9kcnYuc3luY19zZXE7DQo+IC0NCj4gLSAgICAgICBhbWRncHVfcmluZ193cml0ZV9tdWx0
aXBsZShyaW5nLCBwa3QsIG5kdyk7DQo+IC0gICAgICAgYW1kZ3B1X3JpbmdfY29tbWl0KHJpbmcp
Ow0KPiAtICAgICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJm1lcy0+cmluZ19sb2NrLCBmbGFn
cyk7DQo+IC0NCj4gLSAgICAgICBEUk1fREVCVUcoIk1FUyBtc2c9JWQgd2FzIGVtaXR0ZWRcbiIs
IHhfcGt0LT5oZWFkZXIub3Bjb2RlKTsNCj4gLQ0KPiAtICAgICAgIHIgPSBhbWRncHVfZmVuY2Vf
d2FpdF9wb2xsaW5nKHJpbmcsIHJpbmctPmZlbmNlX2Rydi5zeW5jX3NlcSwNCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGV2LT51c2VjX3RpbWVvdXQpOw0KPiAtICAg
ICAgIGlmIChyIDwgMSkgew0KPiAtICAgICAgICAgICAgICAgRFJNX0VSUk9SKCJNRVMgZmFpbGVk
IHRvIHJlc3BvbnNlIG1zZz0lZFxuIiwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICB4X3Br
dC0+aGVhZGVyLm9wY29kZSk7DQo+IC0NCj4gLSAgICAgICAgICAgICAgIHdoaWxlIChoYWx0X2lm
X2h3c19oYW5nKQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZSgpOw0KPiAtDQo+
IC0gICAgICAgICAgICAgICByZXR1cm4gLUVUSU1FRE9VVDsNCj4gLSAgICAgICB9DQo+IC0NCj4g
LSAgICAgICByZXR1cm4gMDsNCj4gLX0NCj4gLQ0KPiAtc3RhdGljIGludCBjb252ZXJ0X3RvX21l
c19xdWV1ZV90eXBlKGludCBxdWV1ZV90eXBlKQ0KPiAtew0KPiAtICAgICAgIGlmIChxdWV1ZV90
eXBlID09IEFNREdQVV9SSU5HX1RZUEVfR0ZYKQ0KPiAtICAgICAgICAgICAgICAgcmV0dXJuIE1F
U19RVUVVRV9UWVBFX0dGWDsNCj4gLSAgICAgICBlbHNlIGlmIChxdWV1ZV90eXBlID09IEFNREdQ
VV9SSU5HX1RZUEVfQ09NUFVURSkNCj4gLSAgICAgICAgICAgICAgIHJldHVybiBNRVNfUVVFVUVf
VFlQRV9DT01QVVRFOw0KPiAtICAgICAgIGVsc2UgaWYgKHF1ZXVlX3R5cGUgPT0gQU1ER1BVX1JJ
TkdfVFlQRV9TRE1BKQ0KPiAtICAgICAgICAgICAgICAgcmV0dXJuIE1FU19RVUVVRV9UWVBFX1NE
TUE7DQo+IC0gICAgICAgZWxzZQ0KPiAtICAgICAgICAgICAgICAgQlVHKCk7DQo+IC0gICAgICAg
cmV0dXJuIC0xOw0KPiAtfQ0KPiAtDQo+IC1zdGF0aWMgaW50IG1lc192MTBfMV9hZGRfaHdfcXVl
dWUoc3RydWN0IGFtZGdwdV9tZXMgKm1lcywNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBtZXNfYWRkX3F1ZXVlX2lucHV0ICppbnB1dCkNCj4gLXsNCj4gLSAgICAg
ICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IG1lcy0+YWRldjsNCj4gLSAgICAgICB1bmlv
biBNRVNBUElfX0FERF9RVUVVRSBtZXNfYWRkX3F1ZXVlX3BrdDsNCj4gLSAgICAgICBzdHJ1Y3Qg
YW1kZ3B1X3ZtaHViICpodWIgPSAmYWRldi0+dm1odWJbQU1ER1BVX0dGWEhVQigwKV07DQo+IC0g
ICAgICAgdWludDMyX3Qgdm1fY250eF9jbnRsID0gaHViLT52bV9jbnR4X2NudGw7DQo+IC0NCj4g
LSAgICAgICBtZW1zZXQoJm1lc19hZGRfcXVldWVfcGt0LCAwLCBzaXplb2YobWVzX2FkZF9xdWV1
ZV9wa3QpKTsNCj4gLQ0KPiAtICAgICAgIG1lc19hZGRfcXVldWVfcGt0LmhlYWRlci50eXBlID0g
TUVTX0FQSV9UWVBFX1NDSEVEVUxFUjsNCj4gLSAgICAgICBtZXNfYWRkX3F1ZXVlX3BrdC5oZWFk
ZXIub3Bjb2RlID0gTUVTX1NDSF9BUElfQUREX1FVRVVFOw0KPiAtICAgICAgIG1lc19hZGRfcXVl
dWVfcGt0LmhlYWRlci5kd3NpemUgPSBBUElfRlJBTUVfU0laRV9JTl9EV09SRFM7DQo+IC0NCj4g
LSAgICAgICBtZXNfYWRkX3F1ZXVlX3BrdC5wcm9jZXNzX2lkID0gaW5wdXQtPnByb2Nlc3NfaWQ7
DQo+IC0gICAgICAgbWVzX2FkZF9xdWV1ZV9wa3QucGFnZV90YWJsZV9iYXNlX2FkZHIgPSBpbnB1
dC0+cGFnZV90YWJsZV9iYXNlX2FkZHI7DQo+IC0gICAgICAgbWVzX2FkZF9xdWV1ZV9wa3QucHJv
Y2Vzc192YV9zdGFydCA9IGlucHV0LT5wcm9jZXNzX3ZhX3N0YXJ0Ow0KPiAtICAgICAgIG1lc19h
ZGRfcXVldWVfcGt0LnByb2Nlc3NfdmFfZW5kID0gaW5wdXQtPnByb2Nlc3NfdmFfZW5kOw0KPiAt
ICAgICAgIG1lc19hZGRfcXVldWVfcGt0LnByb2Nlc3NfcXVhbnR1bSA9IGlucHV0LT5wcm9jZXNz
X3F1YW50dW07DQo+IC0gICAgICAgbWVzX2FkZF9xdWV1ZV9wa3QucHJvY2Vzc19jb250ZXh0X2Fk
ZHIgPSBpbnB1dC0+cHJvY2Vzc19jb250ZXh0X2FkZHI7DQo+IC0gICAgICAgbWVzX2FkZF9xdWV1
ZV9wa3QuZ2FuZ19xdWFudHVtID0gaW5wdXQtPmdhbmdfcXVhbnR1bTsNCj4gLSAgICAgICBtZXNf
YWRkX3F1ZXVlX3BrdC5nYW5nX2NvbnRleHRfYWRkciA9IGlucHV0LT5nYW5nX2NvbnRleHRfYWRk
cjsNCj4gLSAgICAgICBtZXNfYWRkX3F1ZXVlX3BrdC5pbnByb2Nlc3NfZ2FuZ19wcmlvcml0eSA9
DQo+IC0gICAgICAgICAgICAgICBpbnB1dC0+aW5wcm9jZXNzX2dhbmdfcHJpb3JpdHk7DQo+IC0g
ICAgICAgbWVzX2FkZF9xdWV1ZV9wa3QuZ2FuZ19nbG9iYWxfcHJpb3JpdHlfbGV2ZWwgPQ0KPiAt
ICAgICAgICAgICAgICAgaW5wdXQtPmdhbmdfZ2xvYmFsX3ByaW9yaXR5X2xldmVsOw0KPiAtICAg
ICAgIG1lc19hZGRfcXVldWVfcGt0LmRvb3JiZWxsX29mZnNldCA9IGlucHV0LT5kb29yYmVsbF9v
ZmZzZXQ7DQo+IC0gICAgICAgbWVzX2FkZF9xdWV1ZV9wa3QubXFkX2FkZHIgPSBpbnB1dC0+bXFk
X2FkZHI7DQo+IC0gICAgICAgbWVzX2FkZF9xdWV1ZV9wa3Qud3B0cl9hZGRyID0gaW5wdXQtPndw
dHJfYWRkcjsNCj4gLSAgICAgICBtZXNfYWRkX3F1ZXVlX3BrdC5xdWV1ZV90eXBlID0NCj4gLSAg
ICAgICAgICAgICAgIGNvbnZlcnRfdG9fbWVzX3F1ZXVlX3R5cGUoaW5wdXQtPnF1ZXVlX3R5cGUp
Ow0KPiAtICAgICAgIG1lc19hZGRfcXVldWVfcGt0LnBhZ2luZyA9IGlucHV0LT5wYWdpbmc7DQo+
IC0gICAgICAgbWVzX2FkZF9xdWV1ZV9wa3Qudm1fY29udGV4dF9jbnRsID0gdm1fY250eF9jbnRs
Ow0KPiAtICAgICAgIG1lc19hZGRfcXVldWVfcGt0Lmd3c19iYXNlID0gaW5wdXQtPmd3c19iYXNl
Ow0KPiAtICAgICAgIG1lc19hZGRfcXVldWVfcGt0Lmd3c19zaXplID0gaW5wdXQtPmd3c19zaXpl
Ow0KPiAtICAgICAgIG1lc19hZGRfcXVldWVfcGt0LnRyYXBfaGFuZGxlcl9hZGRyID0gaW5wdXQt
PnRiYV9hZGRyOw0KPiAtDQo+IC0gICAgICAgcmV0dXJuIG1lc192MTBfMV9zdWJtaXRfcGt0X2Fu
ZF9wb2xsX2NvbXBsZXRpb24obWVzLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAmbWVzX2Fk
ZF9xdWV1ZV9wa3QsIHNpemVvZihtZXNfYWRkX3F1ZXVlX3BrdCksDQo+IC0gICAgICAgICAgICAg
ICAgICAgICAgIG9mZnNldG9mKHVuaW9uIE1FU0FQSV9fQUREX1FVRVVFLCBhcGlfc3RhdHVzKSk7
DQo+IC19DQo+IC0NCj4gLXN0YXRpYyBpbnQgbWVzX3YxMF8xX3JlbW92ZV9od19xdWV1ZShzdHJ1
Y3QgYW1kZ3B1X21lcyAqbWVzLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IG1lc19yZW1vdmVfcXVldWVfaW5wdXQgKmlucHV0KQ0KPiAtew0KPiAtICAgICAg
IHVuaW9uIE1FU0FQSV9fUkVNT1ZFX1FVRVVFIG1lc19yZW1vdmVfcXVldWVfcGt0Ow0KPiAtDQo+
IC0gICAgICAgbWVtc2V0KCZtZXNfcmVtb3ZlX3F1ZXVlX3BrdCwgMCwgc2l6ZW9mKG1lc19yZW1v
dmVfcXVldWVfcGt0KSk7DQo+IC0NCj4gLSAgICAgICBtZXNfcmVtb3ZlX3F1ZXVlX3BrdC5oZWFk
ZXIudHlwZSA9IE1FU19BUElfVFlQRV9TQ0hFRFVMRVI7DQo+IC0gICAgICAgbWVzX3JlbW92ZV9x
dWV1ZV9wa3QuaGVhZGVyLm9wY29kZSA9IE1FU19TQ0hfQVBJX1JFTU9WRV9RVUVVRTsNCj4gLSAg
ICAgICBtZXNfcmVtb3ZlX3F1ZXVlX3BrdC5oZWFkZXIuZHdzaXplID0gQVBJX0ZSQU1FX1NJWkVf
SU5fRFdPUkRTOw0KPiAtDQo+IC0gICAgICAgbWVzX3JlbW92ZV9xdWV1ZV9wa3QuZG9vcmJlbGxf
b2Zmc2V0ID0gaW5wdXQtPmRvb3JiZWxsX29mZnNldDsNCj4gLSAgICAgICBtZXNfcmVtb3ZlX3F1
ZXVlX3BrdC5nYW5nX2NvbnRleHRfYWRkciA9IGlucHV0LT5nYW5nX2NvbnRleHRfYWRkcjsNCj4g
LQ0KPiAtICAgICAgIHJldHVybiBtZXNfdjEwXzFfc3VibWl0X3BrdF9hbmRfcG9sbF9jb21wbGV0
aW9uKG1lcywNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgJm1lc19yZW1vdmVfcXVldWVfcGt0
LCBzaXplb2YobWVzX3JlbW92ZV9xdWV1ZV9wa3QpLA0KPiAtICAgICAgICAgICAgICAgICAgICAg
ICBvZmZzZXRvZih1bmlvbiBNRVNBUElfX1JFTU9WRV9RVUVVRSwgYXBpX3N0YXR1cykpOw0KPiAt
fQ0KPiAtDQo+IC1zdGF0aWMgaW50IG1lc192MTBfMV91bm1hcF9sZWdhY3lfcXVldWUoc3RydWN0
IGFtZGdwdV9tZXMgKm1lcywNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IG1lc191bm1hcF9sZWdhY3lfcXVldWVfaW5wdXQgKmlucHV0KQ0KPiAtew0KPiAtICAgICAg
IHVuaW9uIE1FU0FQSV9fUkVNT1ZFX1FVRVVFIG1lc19yZW1vdmVfcXVldWVfcGt0Ow0KPiAtDQo+
IC0gICAgICAgbWVtc2V0KCZtZXNfcmVtb3ZlX3F1ZXVlX3BrdCwgMCwgc2l6ZW9mKG1lc19yZW1v
dmVfcXVldWVfcGt0KSk7DQo+IC0NCj4gLSAgICAgICBtZXNfcmVtb3ZlX3F1ZXVlX3BrdC5oZWFk
ZXIudHlwZSA9IE1FU19BUElfVFlQRV9TQ0hFRFVMRVI7DQo+IC0gICAgICAgbWVzX3JlbW92ZV9x
dWV1ZV9wa3QuaGVhZGVyLm9wY29kZSA9IE1FU19TQ0hfQVBJX1JFTU9WRV9RVUVVRTsNCj4gLSAg
ICAgICBtZXNfcmVtb3ZlX3F1ZXVlX3BrdC5oZWFkZXIuZHdzaXplID0gQVBJX0ZSQU1FX1NJWkVf
SU5fRFdPUkRTOw0KPiAtDQo+IC0gICAgICAgbWVzX3JlbW92ZV9xdWV1ZV9wa3QuZG9vcmJlbGxf
b2Zmc2V0ID0gaW5wdXQtPmRvb3JiZWxsX29mZnNldDsNCj4gLSAgICAgICBtZXNfcmVtb3ZlX3F1
ZXVlX3BrdC5nYW5nX2NvbnRleHRfYWRkciA9IDA7DQo+IC0NCj4gLSAgICAgICBtZXNfcmVtb3Zl
X3F1ZXVlX3BrdC5waXBlX2lkID0gaW5wdXQtPnBpcGVfaWQ7DQo+IC0gICAgICAgbWVzX3JlbW92
ZV9xdWV1ZV9wa3QucXVldWVfaWQgPSBpbnB1dC0+cXVldWVfaWQ7DQo+IC0NCj4gLSAgICAgICBp
ZiAoaW5wdXQtPmFjdGlvbiA9PSBQUkVFTVBUX1FVRVVFU19OT19VTk1BUCkgew0KPiAtICAgICAg
ICAgICAgICAgbWVzX3JlbW92ZV9xdWV1ZV9wa3QucHJlZW1wdF9sZWdhY3lfZ2Z4X3F1ZXVlID0g
MTsNCj4gLSAgICAgICAgICAgICAgIG1lc19yZW1vdmVfcXVldWVfcGt0LnRmX2FkZHIgPSBpbnB1
dC0+dHJhaWxfZmVuY2VfYWRkcjsNCj4gLSAgICAgICAgICAgICAgIG1lc19yZW1vdmVfcXVldWVf
cGt0LnRmX2RhdGEgPQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICBsb3dlcl8zMl9iaXRzKGlu
cHV0LT50cmFpbF9mZW5jZV9kYXRhKTsNCj4gLSAgICAgICB9IGVsc2Ugew0KPiAtICAgICAgICAg
ICAgICAgaWYgKGlucHV0LT5xdWV1ZV90eXBlID09IEFNREdQVV9SSU5HX1RZUEVfR0ZYKQ0KPiAt
ICAgICAgICAgICAgICAgICAgICAgICBtZXNfcmVtb3ZlX3F1ZXVlX3BrdC51bm1hcF9sZWdhY3lf
Z2Z4X3F1ZXVlID0gMTsNCj4gLSAgICAgICAgICAgICAgIGVsc2UNCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgbWVzX3JlbW92ZV9xdWV1ZV9wa3QudW5tYXBfa2lxX3V0aWxpdHlfcXVldWUgPSAx
Ow0KPiAtICAgICAgIH0NCj4gLQ0KPiAtICAgICAgIHJldHVybiBtZXNfdjEwXzFfc3VibWl0X3Br
dF9hbmRfcG9sbF9jb21wbGV0aW9uKG1lcywNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgJm1l
c19yZW1vdmVfcXVldWVfcGt0LCBzaXplb2YobWVzX3JlbW92ZV9xdWV1ZV9wa3QpLA0KPiAtICAg
ICAgICAgICAgICAgICAgICAgICBvZmZzZXRvZih1bmlvbiBNRVNBUElfX1JFTU9WRV9RVUVVRSwg
YXBpX3N0YXR1cykpOw0KPiAtfQ0KPiAtDQo+IC1zdGF0aWMgaW50IG1lc192MTBfMV9zdXNwZW5k
X2dhbmcoc3RydWN0IGFtZGdwdV9tZXMgKm1lcywNCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBtZXNfc3VzcGVuZF9nYW5nX2lucHV0ICppbnB1dCkNCj4gLXsNCj4g
LSAgICAgICByZXR1cm4gMDsNCj4gLX0NCj4gLQ0KPiAtc3RhdGljIGludCBtZXNfdjEwXzFfcmVz
dW1lX2dhbmcoc3RydWN0IGFtZGdwdV9tZXMgKm1lcywNCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IG1lc19yZXN1bWVfZ2FuZ19pbnB1dCAqaW5wdXQpDQo+IC17DQo+
IC0gICAgICAgcmV0dXJuIDA7DQo+IC19DQo+IC0NCj4gLXN0YXRpYyBpbnQgbWVzX3YxMF8xX3F1
ZXJ5X3NjaGVkX3N0YXR1cyhzdHJ1Y3QgYW1kZ3B1X21lcyAqbWVzKQ0KPiAtew0KPiAtICAgICAg
IHVuaW9uIE1FU0FQSV9fUVVFUllfTUVTX1NUQVRVUyBtZXNfc3RhdHVzX3BrdDsNCj4gLQ0KPiAt
ICAgICAgIG1lbXNldCgmbWVzX3N0YXR1c19wa3QsIDAsIHNpemVvZihtZXNfc3RhdHVzX3BrdCkp
Ow0KPiAtDQo+IC0gICAgICAgbWVzX3N0YXR1c19wa3QuaGVhZGVyLnR5cGUgPSBNRVNfQVBJX1RZ
UEVfU0NIRURVTEVSOw0KPiAtICAgICAgIG1lc19zdGF0dXNfcGt0LmhlYWRlci5vcGNvZGUgPSBN
RVNfU0NIX0FQSV9RVUVSWV9TQ0hFRFVMRVJfU1RBVFVTOw0KPiAtICAgICAgIG1lc19zdGF0dXNf
cGt0LmhlYWRlci5kd3NpemUgPSBBUElfRlJBTUVfU0laRV9JTl9EV09SRFM7DQo+IC0NCj4gLSAg
ICAgICByZXR1cm4gbWVzX3YxMF8xX3N1Ym1pdF9wa3RfYW5kX3BvbGxfY29tcGxldGlvbihtZXMs
DQo+IC0gICAgICAgICAgICAgICAgICAgICAgICZtZXNfc3RhdHVzX3BrdCwgc2l6ZW9mKG1lc19z
dGF0dXNfcGt0KSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0b2YodW5pb24gTUVT
QVBJX19RVUVSWV9NRVNfU1RBVFVTLCBhcGlfc3RhdHVzKSk7DQo+IC19DQo+IC0NCj4gLXN0YXRp
YyBpbnQgbWVzX3YxMF8xX3NldF9od19yZXNvdXJjZXMoc3RydWN0IGFtZGdwdV9tZXMgKm1lcykN
Cj4gLXsNCj4gLSAgICAgICBpbnQgaTsNCj4gLSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldiA9IG1lcy0+YWRldjsNCj4gLSAgICAgICB1bmlvbiBNRVNBUElfU0VUX0hXX1JFU09VUkNF
UyBtZXNfc2V0X2h3X3Jlc19wa3Q7DQo+IC0NCj4gLSAgICAgICBtZW1zZXQoJm1lc19zZXRfaHdf
cmVzX3BrdCwgMCwgc2l6ZW9mKG1lc19zZXRfaHdfcmVzX3BrdCkpOw0KPiAtDQo+IC0gICAgICAg
bWVzX3NldF9od19yZXNfcGt0LmhlYWRlci50eXBlID0gTUVTX0FQSV9UWVBFX1NDSEVEVUxFUjsN
Cj4gLSAgICAgICBtZXNfc2V0X2h3X3Jlc19wa3QuaGVhZGVyLm9wY29kZSA9IE1FU19TQ0hfQVBJ
X1NFVF9IV19SU1JDOw0KPiAtICAgICAgIG1lc19zZXRfaHdfcmVzX3BrdC5oZWFkZXIuZHdzaXpl
ID0gQVBJX0ZSQU1FX1NJWkVfSU5fRFdPUkRTOw0KPiAtDQo+IC0gICAgICAgbWVzX3NldF9od19y
ZXNfcGt0LnZtaWRfbWFza19tbWh1YiA9IG1lcy0+dm1pZF9tYXNrX21taHViOw0KPiAtICAgICAg
IG1lc19zZXRfaHdfcmVzX3BrdC52bWlkX21hc2tfZ2Z4aHViID0gbWVzLT52bWlkX21hc2tfZ2Z4
aHViOw0KPiAtICAgICAgIG1lc19zZXRfaHdfcmVzX3BrdC5nZHNfc2l6ZSA9IGFkZXYtPmdkcy5n
ZHNfc2l6ZTsNCj4gLSAgICAgICBtZXNfc2V0X2h3X3Jlc19wa3QucGFnaW5nX3ZtaWQgPSAwOw0K
PiAtICAgICAgIG1lc19zZXRfaHdfcmVzX3BrdC5nX3NjaF9jdHhfZ3B1X21jX3B0ciA9IG1lcy0+
c2NoX2N0eF9ncHVfYWRkcjsNCj4gLSAgICAgICBtZXNfc2V0X2h3X3Jlc19wa3QucXVlcnlfc3Rh
dHVzX2ZlbmNlX2dwdV9tY19wdHIgPQ0KPiAtICAgICAgICAgICAgICAgbWVzLT5xdWVyeV9zdGF0
dXNfZmVuY2VfZ3B1X2FkZHI7DQo+IC0NCj4gLSAgICAgICBmb3IgKGkgPSAwOyBpIDwgTUFYX0NP
TVBVVEVfUElQRVM7IGkrKykNCj4gLSAgICAgICAgICAgICAgIG1lc19zZXRfaHdfcmVzX3BrdC5j
b21wdXRlX2hxZF9tYXNrW2ldID0NCj4gLSAgICAgICAgICAgICAgICAgICAgICAgbWVzLT5jb21w
dXRlX2hxZF9tYXNrW2ldOw0KPiAtDQo+IC0gICAgICAgZm9yIChpID0gMDsgaSA8IE1BWF9HRlhf
UElQRVM7IGkrKykNCj4gLSAgICAgICAgICAgICAgIG1lc19zZXRfaHdfcmVzX3BrdC5nZnhfaHFk
X21hc2tbaV0gPSBtZXMtPmdmeF9ocWRfbWFza1tpXTsNCj4gLQ0KPiAtICAgICAgIGZvciAoaSA9
IDA7IGkgPCBNQVhfU0RNQV9QSVBFUzsgaSsrKQ0KPiAtICAgICAgICAgICAgICAgbWVzX3NldF9o
d19yZXNfcGt0LnNkbWFfaHFkX21hc2tbaV0gPSBtZXMtPnNkbWFfaHFkX21hc2tbaV07DQo+IC0N
Cj4gLSAgICAgICBmb3IgKGkgPSAwOyBpIDwgQU1EX1BSSU9SSVRZX05VTV9MRVZFTFM7IGkrKykN
Cj4gLSAgICAgICAgICAgICAgIG1lc19zZXRfaHdfcmVzX3BrdC5hZ2dyZWdhdGVkX2Rvb3JiZWxs
c1tpXSA9DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG1lcy0+YWdncmVnYXRlZF9kb29yYmVs
bHNbaV07DQo+IC0NCj4gLSAgICAgICBmb3IgKGkgPSAwOyBpIDwgNTsgaSsrKSB7DQo+IC0gICAg
ICAgICAgICAgICBtZXNfc2V0X2h3X3Jlc19wa3QuZ2NfYmFzZVtpXSA9IGFkZXYtPnJlZ19vZmZz
ZXRbR0NfSFdJUF1bMF1baV07DQo+IC0gICAgICAgICAgICAgICBtZXNfc2V0X2h3X3Jlc19wa3Qu
bW1odWJfYmFzZVtpXSA9DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGFkZXYtPnJlZ19vZmZz
ZXRbTU1IVUJfSFdJUF1bMF1baV07DQo+IC0gICAgICAgICAgICAgICBtZXNfc2V0X2h3X3Jlc19w
a3Qub3Nzc3lzX2Jhc2VbaV0gPQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICBhZGV2LT5yZWdf
b2Zmc2V0W09TU1NZU19IV0lQXVswXVtpXTsNCj4gLSAgICAgICB9DQo+IC0NCj4gLSAgICAgICBt
ZXNfc2V0X2h3X3Jlc19wa3QuZGlzYWJsZV9yZXNldCA9IDE7DQo+IC0gICAgICAgbWVzX3NldF9o
d19yZXNfcGt0LmRpc2FibGVfbWVzX2xvZyA9IDE7DQo+IC0gICAgICAgbWVzX3NldF9od19yZXNf
cGt0LnVzZV9kaWZmZXJlbnRfdm1pZF9jb21wdXRlID0gMTsNCj4gLQ0KPiAtICAgICAgIHJldHVy
biBtZXNfdjEwXzFfc3VibWl0X3BrdF9hbmRfcG9sbF9jb21wbGV0aW9uKG1lcywNCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgJm1lc19zZXRfaHdfcmVzX3BrdCwgc2l6ZW9mKG1lc19zZXRfaHdf
cmVzX3BrdCksDQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG9mZnNldG9mKHVuaW9uIE1FU0FQ
SV9TRVRfSFdfUkVTT1VSQ0VTLCBhcGlfc3RhdHVzKSk7DQo+IC19DQo+IC0NCj4gLXN0YXRpYyB2
b2lkIG1lc192MTBfMV9pbml0X2FnZ3JlZ2F0ZWRfZG9vcmJlbGwoc3RydWN0IGFtZGdwdV9tZXMg
Km1lcykNCj4gLXsNCj4gLSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IG1lcy0+
YWRldjsNCj4gLSAgICAgICB1aW50MzJfdCBkYXRhOw0KPiAtDQo+IC0gICAgICAgZGF0YSA9IFJS
RUczMl9TT0MxNShHQywgMCwgbW1DUF9NRVNfRE9PUkJFTExfQ09OVFJPTDEpOw0KPiAtICAgICAg
IGRhdGEgJj0gfihDUF9NRVNfRE9PUkJFTExfQ09OVFJPTDFfX0RPT1JCRUxMX09GRlNFVF9NQVNL
IHwNCj4gLSAgICAgICAgICAgICAgICAgQ1BfTUVTX0RPT1JCRUxMX0NPTlRST0wxX19ET09SQkVM
TF9FTl9NQVNLIHwNCj4gLSAgICAgICAgICAgICAgICAgQ1BfTUVTX0RPT1JCRUxMX0NPTlRST0wx
X19ET09SQkVMTF9ISVRfTUFTSyk7DQo+IC0gICAgICAgZGF0YSB8PSBtZXMtPmFnZ3JlZ2F0ZWRf
ZG9vcmJlbGxzW0FNREdQVV9NRVNfUFJJT1JJVFlfTEVWRUxfTE9XXSA8PA0KPiAtICAgICAgICAg
ICAgICAgQ1BfTUVTX0RPT1JCRUxMX0NPTlRST0wxX19ET09SQkVMTF9PRkZTRVRfX1NISUZUOw0K
PiAtICAgICAgIGRhdGEgfD0gMSA8PCBDUF9NRVNfRE9PUkJFTExfQ09OVFJPTDFfX0RPT1JCRUxM
X0VOX19TSElGVDsNCj4gLSAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfTUVTX0RPT1JC
RUxMX0NPTlRST0wxLCBkYXRhKTsNCj4gLQ0KPiAtICAgICAgIGRhdGEgPSBSUkVHMzJfU09DMTUo
R0MsIDAsIG1tQ1BfTUVTX0RPT1JCRUxMX0NPTlRST0wyKTsNCj4gLSAgICAgICBkYXRhICY9IH4o
Q1BfTUVTX0RPT1JCRUxMX0NPTlRST0wyX19ET09SQkVMTF9PRkZTRVRfTUFTSyB8DQo+IC0gICAg
ICAgICAgICAgICAgIENQX01FU19ET09SQkVMTF9DT05UUk9MMl9fRE9PUkJFTExfRU5fTUFTSyB8
DQo+IC0gICAgICAgICAgICAgICAgIENQX01FU19ET09SQkVMTF9DT05UUk9MMl9fRE9PUkJFTExf
SElUX01BU0spOw0KPiAtICAgICAgIGRhdGEgfD0gbWVzLT5hZ2dyZWdhdGVkX2Rvb3JiZWxsc1tB
TURHUFVfTUVTX1BSSU9SSVRZX0xFVkVMX05PUk1BTF0gPDwNCj4gLSAgICAgICAgICAgICAgIENQ
X01FU19ET09SQkVMTF9DT05UUk9MMl9fRE9PUkJFTExfT0ZGU0VUX19TSElGVDsNCj4gLSAgICAg
ICBkYXRhIHw9IDEgPDwgQ1BfTUVTX0RPT1JCRUxMX0NPTlRST0wyX19ET09SQkVMTF9FTl9fU0hJ
RlQ7DQo+IC0gICAgICAgV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX01FU19ET09SQkVMTF9DT05U
Uk9MMiwgZGF0YSk7DQo+IC0NCj4gLSAgICAgICBkYXRhID0gUlJFRzMyX1NPQzE1KEdDLCAwLCBt
bUNQX01FU19ET09SQkVMTF9DT05UUk9MMyk7DQo+IC0gICAgICAgZGF0YSAmPSB+KENQX01FU19E
T09SQkVMTF9DT05UUk9MM19fRE9PUkJFTExfT0ZGU0VUX01BU0sgfA0KPiAtICAgICAgICAgICAg
ICAgICBDUF9NRVNfRE9PUkJFTExfQ09OVFJPTDNfX0RPT1JCRUxMX0VOX01BU0sgfA0KPiAtICAg
ICAgICAgICAgICAgICBDUF9NRVNfRE9PUkJFTExfQ09OVFJPTDNfX0RPT1JCRUxMX0hJVF9NQVNL
KTsNCj4gLSAgICAgICBkYXRhIHw9IG1lcy0+YWdncmVnYXRlZF9kb29yYmVsbHNbQU1ER1BVX01F
U19QUklPUklUWV9MRVZFTF9NRURJVU1dIDw8DQo+IC0gICAgICAgICAgICAgICBDUF9NRVNfRE9P
UkJFTExfQ09OVFJPTDNfX0RPT1JCRUxMX09GRlNFVF9fU0hJRlQ7DQo+IC0gICAgICAgZGF0YSB8
PSAxIDw8IENQX01FU19ET09SQkVMTF9DT05UUk9MM19fRE9PUkJFTExfRU5fX1NISUZUOw0KPiAt
ICAgICAgIFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9NRVNfRE9PUkJFTExfQ09OVFJPTDMsIGRh
dGEpOw0KPiAtDQo+IC0gICAgICAgZGF0YSA9IFJSRUczMl9TT0MxNShHQywgMCwgbW1DUF9NRVNf
RE9PUkJFTExfQ09OVFJPTDQpOw0KPiAtICAgICAgIGRhdGEgJj0gfihDUF9NRVNfRE9PUkJFTExf
Q09OVFJPTDRfX0RPT1JCRUxMX09GRlNFVF9NQVNLIHwNCj4gLSAgICAgICAgICAgICAgICAgQ1Bf
TUVTX0RPT1JCRUxMX0NPTlRST0w0X19ET09SQkVMTF9FTl9NQVNLIHwNCj4gLSAgICAgICAgICAg
ICAgICAgQ1BfTUVTX0RPT1JCRUxMX0NPTlRST0w0X19ET09SQkVMTF9ISVRfTUFTSyk7DQo+IC0g
ICAgICAgZGF0YSB8PSBtZXMtPmFnZ3JlZ2F0ZWRfZG9vcmJlbGxzW0FNREdQVV9NRVNfUFJJT1JJ
VFlfTEVWRUxfSElHSF0gPDwNCj4gLSAgICAgICAgICAgICAgIENQX01FU19ET09SQkVMTF9DT05U
Uk9MNF9fRE9PUkJFTExfT0ZGU0VUX19TSElGVDsNCj4gLSAgICAgICBkYXRhIHw9IDEgPDwgQ1Bf
TUVTX0RPT1JCRUxMX0NPTlRST0w0X19ET09SQkVMTF9FTl9fU0hJRlQ7DQo+IC0gICAgICAgV1JF
RzMyX1NPQzE1KEdDLCAwLCBtbUNQX01FU19ET09SQkVMTF9DT05UUk9MNCwgZGF0YSk7DQo+IC0N
Cj4gLSAgICAgICBkYXRhID0gUlJFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX01FU19ET09SQkVMTF9D
T05UUk9MNSk7DQo+IC0gICAgICAgZGF0YSAmPSB+KENQX01FU19ET09SQkVMTF9DT05UUk9MNV9f
RE9PUkJFTExfT0ZGU0VUX01BU0sgfA0KPiAtICAgICAgICAgICAgICAgICBDUF9NRVNfRE9PUkJF
TExfQ09OVFJPTDVfX0RPT1JCRUxMX0VOX01BU0sgfA0KPiAtICAgICAgICAgICAgICAgICBDUF9N
RVNfRE9PUkJFTExfQ09OVFJPTDVfX0RPT1JCRUxMX0hJVF9NQVNLKTsNCj4gLSAgICAgICBkYXRh
IHw9IG1lcy0+YWdncmVnYXRlZF9kb29yYmVsbHNbQU1ER1BVX01FU19QUklPUklUWV9MRVZFTF9S
RUFMVElNRV0gPDwNCj4gLSAgICAgICAgICAgICAgIENQX01FU19ET09SQkVMTF9DT05UUk9MNV9f
RE9PUkJFTExfT0ZGU0VUX19TSElGVDsNCj4gLSAgICAgICBkYXRhIHw9IDEgPDwgQ1BfTUVTX0RP
T1JCRUxMX0NPTlRST0w1X19ET09SQkVMTF9FTl9fU0hJRlQ7DQo+IC0gICAgICAgV1JFRzMyX1NP
QzE1KEdDLCAwLCBtbUNQX01FU19ET09SQkVMTF9DT05UUk9MNSwgZGF0YSk7DQo+IC0NCj4gLSAg
ICAgICBkYXRhID0gMSA8PCBDUF9IUURfR0ZYX0NPTlRST0xfX0RCX1VQREFURURfTVNHX0VOX19T
SElGVDsNCj4gLSAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfSFFEX0dGWF9DT05UUk9M
LCBkYXRhKTsNCj4gLX0NCj4gLQ0KPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBhbWRncHVfbWVzX2Z1
bmNzIG1lc192MTBfMV9mdW5jcyA9IHsNCj4gLSAgICAgICAuYWRkX2h3X3F1ZXVlID0gbWVzX3Yx
MF8xX2FkZF9od19xdWV1ZSwNCj4gLSAgICAgICAucmVtb3ZlX2h3X3F1ZXVlID0gbWVzX3YxMF8x
X3JlbW92ZV9od19xdWV1ZSwNCj4gLSAgICAgICAudW5tYXBfbGVnYWN5X3F1ZXVlID0gbWVzX3Yx
MF8xX3VubWFwX2xlZ2FjeV9xdWV1ZSwNCj4gLSAgICAgICAuc3VzcGVuZF9nYW5nID0gbWVzX3Yx
MF8xX3N1c3BlbmRfZ2FuZywNCj4gLSAgICAgICAucmVzdW1lX2dhbmcgPSBtZXNfdjEwXzFfcmVz
dW1lX2dhbmcsDQo+IC19Ow0KPiAtDQo+IC1zdGF0aWMgaW50IG1lc192MTBfMV9hbGxvY2F0ZV91
Y29kZV9idWZmZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQo+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGFkbWdwdV9tZXNfcGlwZSBwaXBlKQ0K
PiAtew0KPiAtICAgICAgIGludCByOw0KPiAtICAgICAgIGNvbnN0IHN0cnVjdCBtZXNfZmlybXdh
cmVfaGVhZGVyX3YxXzAgKm1lc19oZHI7DQo+IC0gICAgICAgY29uc3QgX19sZTMyICpmd19kYXRh
Ow0KPiAtICAgICAgIHVuc2lnbmVkIGZ3X3NpemU7DQo+IC0NCj4gLSAgICAgICBtZXNfaGRyID0g
KGNvbnN0IHN0cnVjdCBtZXNfZmlybXdhcmVfaGVhZGVyX3YxXzAgKikNCj4gLSAgICAgICAgICAg
ICAgIGFkZXYtPm1lcy5md1twaXBlXS0+ZGF0YTsNCj4gLQ0KPiAtICAgICAgIGZ3X2RhdGEgPSAo
Y29uc3QgX19sZTMyICopKGFkZXYtPm1lcy5md1twaXBlXS0+ZGF0YSArDQo+IC0gICAgICAgICAg
ICAgICAgICBsZTMyX3RvX2NwdShtZXNfaGRyLT5tZXNfdWNvZGVfb2Zmc2V0X2J5dGVzKSk7DQo+
IC0gICAgICAgZndfc2l6ZSA9IGxlMzJfdG9fY3B1KG1lc19oZHItPm1lc191Y29kZV9zaXplX2J5
dGVzKTsNCj4gLQ0KPiAtICAgICAgIHIgPSBhbWRncHVfYm9fY3JlYXRlX3Jlc2VydmVkKGFkZXYs
IGZ3X3NpemUsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUEFHRV9T
SVpFLCBBTURHUFVfR0VNX0RPTUFJTl9HVFQsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgJmFkZXYtPm1lcy51Y29kZV9md19vYmpbcGlwZV0sDQo+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkZXYtPm1lcy51Y29kZV9md19ncHVfYWRkcltw
aXBlXSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodm9pZCAqKikm
YWRldi0+bWVzLnVjb2RlX2Z3X3B0cltwaXBlXSk7DQo+IC0gICAgICAgaWYgKHIpIHsNCj4gLSAg
ICAgICAgICAgICAgIGRldl9lcnIoYWRldi0+ZGV2LCAiKCVkKSBmYWlsZWQgdG8gY3JlYXRlIG1l
cyBmdyBib1xuIiwgcik7DQo+IC0gICAgICAgICAgICAgICByZXR1cm4gcjsNCj4gLSAgICAgICB9
DQo+IC0NCj4gLSAgICAgICBtZW1jcHkoYWRldi0+bWVzLnVjb2RlX2Z3X3B0cltwaXBlXSwgZndf
ZGF0YSwgZndfc2l6ZSk7DQo+IC0NCj4gLSAgICAgICBhbWRncHVfYm9fa3VubWFwKGFkZXYtPm1l
cy51Y29kZV9md19vYmpbcGlwZV0pOw0KPiAtICAgICAgIGFtZGdwdV9ib191bnJlc2VydmUoYWRl
di0+bWVzLnVjb2RlX2Z3X29ialtwaXBlXSk7DQo+IC0NCj4gLSAgICAgICByZXR1cm4gMDsNCj4g
LX0NCj4gLQ0KPiAtc3RhdGljIGludCBtZXNfdjEwXzFfYWxsb2NhdGVfdWNvZGVfZGF0YV9idWZm
ZXIoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsDQo+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGVudW0gYWRtZ3B1X21lc19waXBlIHBpcGUpDQo+IC17
DQo+IC0gICAgICAgaW50IHI7DQo+IC0gICAgICAgY29uc3Qgc3RydWN0IG1lc19maXJtd2FyZV9o
ZWFkZXJfdjFfMCAqbWVzX2hkcjsNCj4gLSAgICAgICBjb25zdCBfX2xlMzIgKmZ3X2RhdGE7DQo+
IC0gICAgICAgdW5zaWduZWQgZndfc2l6ZTsNCj4gLQ0KPiAtICAgICAgIG1lc19oZHIgPSAoY29u
c3Qgc3RydWN0IG1lc19maXJtd2FyZV9oZWFkZXJfdjFfMCAqKQ0KPiAtICAgICAgICAgICAgICAg
YWRldi0+bWVzLmZ3W3BpcGVdLT5kYXRhOw0KPiAtDQo+IC0gICAgICAgZndfZGF0YSA9IChjb25z
dCBfX2xlMzIgKikoYWRldi0+bWVzLmZ3W3BpcGVdLT5kYXRhICsNCj4gLSAgICAgICAgICAgICAg
ICAgIGxlMzJfdG9fY3B1KG1lc19oZHItPm1lc191Y29kZV9kYXRhX29mZnNldF9ieXRlcykpOw0K
PiAtICAgICAgIGZ3X3NpemUgPSBsZTMyX3RvX2NwdShtZXNfaGRyLT5tZXNfdWNvZGVfZGF0YV9z
aXplX2J5dGVzKTsNCj4gLQ0KPiAtICAgICAgIHIgPSBhbWRncHVfYm9fY3JlYXRlX3Jlc2VydmVk
KGFkZXYsIGZ3X3NpemUsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
NjQgKiAxMDI0LCBBTURHUFVfR0VNX0RPTUFJTl9HVFQsDQo+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgJmFkZXYtPm1lcy5kYXRhX2Z3X29ialtwaXBlXSwNCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmYWRldi0+bWVzLmRhdGFfZndfZ3B1X2Fk
ZHJbcGlwZV0sDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZvaWQg
KiopJmFkZXYtPm1lcy5kYXRhX2Z3X3B0cltwaXBlXSk7DQo+IC0gICAgICAgaWYgKHIpIHsNCj4g
LSAgICAgICAgICAgICAgIGRldl9lcnIoYWRldi0+ZGV2LCAiKCVkKSBmYWlsZWQgdG8gY3JlYXRl
IG1lcyBkYXRhIGZ3IGJvXG4iLCByKTsNCj4gLSAgICAgICAgICAgICAgIHJldHVybiByOw0KPiAt
ICAgICAgIH0NCj4gLQ0KPiAtICAgICAgIG1lbWNweShhZGV2LT5tZXMuZGF0YV9md19wdHJbcGlw
ZV0sIGZ3X2RhdGEsIGZ3X3NpemUpOw0KPiAtDQo+IC0gICAgICAgYW1kZ3B1X2JvX2t1bm1hcChh
ZGV2LT5tZXMuZGF0YV9md19vYmpbcGlwZV0pOw0KPiAtICAgICAgIGFtZGdwdV9ib191bnJlc2Vy
dmUoYWRldi0+bWVzLmRhdGFfZndfb2JqW3BpcGVdKTsNCj4gLQ0KPiAtICAgICAgIHJldHVybiAw
Ow0KPiAtfQ0KPiAtDQo+IC1zdGF0aWMgdm9pZCBtZXNfdjEwXzFfZnJlZV91Y29kZV9idWZmZXJz
KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGVudW0gYWRtZ3B1X21lc19waXBlIHBpcGUpDQo+IC17DQo+IC0gICAg
ICAgYW1kZ3B1X2JvX2ZyZWVfa2VybmVsKCZhZGV2LT5tZXMuZGF0YV9md19vYmpbcGlwZV0sDQo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICZhZGV2LT5tZXMuZGF0YV9md19ncHVfYWRk
cltwaXBlXSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZvaWQgKiopJmFkZXYt
Pm1lcy5kYXRhX2Z3X3B0cltwaXBlXSk7DQo+IC0NCj4gLSAgICAgICBhbWRncHVfYm9fZnJlZV9r
ZXJuZWwoJmFkZXYtPm1lcy51Y29kZV9md19vYmpbcGlwZV0sDQo+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICZhZGV2LT5tZXMudWNvZGVfZndfZ3B1X2FkZHJbcGlwZV0sDQo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICh2b2lkICoqKSZhZGV2LT5tZXMudWNvZGVfZndfcHRy
W3BpcGVdKTsNCj4gLX0NCj4gLQ0KPiAtc3RhdGljIHZvaWQgbWVzX3YxMF8xX2VuYWJsZShzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgYm9vbCBlbmFibGUpDQo+IC17DQo+IC0gICAgICAgdWlu
dDMyX3QgcGlwZSwgZGF0YSA9IDA7DQo+IC0NCj4gLSAgICAgICBpZiAoZW5hYmxlKSB7DQo+IC0g
ICAgICAgICAgICAgICBkYXRhID0gUlJFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX01FU19DTlRMKTsN
Cj4gLSAgICAgICAgICAgICAgIGRhdGEgPSBSRUdfU0VUX0ZJRUxEKGRhdGEsIENQX01FU19DTlRM
LCBNRVNfUElQRTBfUkVTRVQsIDEpOw0KPiAtICAgICAgICAgICAgICAgZGF0YSA9IFJFR19TRVRf
RklFTEQoZGF0YSwgQ1BfTUVTX0NOVEwsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
TUVTX1BJUEUxX1JFU0VULCBhZGV2LT5lbmFibGVfbWVzX2tpcSA/IDEgOiAwKTsNCj4gLSAgICAg
ICAgICAgICAgIFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9NRVNfQ05UTCwgZGF0YSk7DQo+IC0N
Cj4gLSAgICAgICAgICAgICAgIG11dGV4X2xvY2soJmFkZXYtPnNyYm1fbXV0ZXgpOw0KPiAtICAg
ICAgICAgICAgICAgZm9yIChwaXBlID0gMDsgcGlwZSA8IEFNREdQVV9NQVhfTUVTX1BJUEVTOyBw
aXBlKyspIHsNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhZGV2LT5lbmFibGVfbWVz
X2tpcSAmJg0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgcGlwZSA9PSBBTURHUFVfTUVT
X0tJUV9QSVBFKQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0K
PiAtDQo+IC0gICAgICAgICAgICAgICAgICAgICAgIG52X2dyYm1fc2VsZWN0KGFkZXYsIDMsIHBp
cGUsIDAsIDApOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAs
IG1tQ1BfTUVTX1BSR1JNX0NOVFJfU1RBUlQsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgKHVpbnQzMl90KShhZGV2LT5tZXMudWNfc3RhcnRfYWRkcltwaXBlXSkgPj4gMik7DQo+IC0g
ICAgICAgICAgICAgICB9DQo+IC0gICAgICAgICAgICAgICBudl9ncmJtX3NlbGVjdChhZGV2LCAw
LCAwLCAwLCAwKTsNCj4gLSAgICAgICAgICAgICAgIG11dGV4X3VubG9jaygmYWRldi0+c3JibV9t
dXRleCk7DQo+IC0NCj4gLSAgICAgICAgICAgICAgIC8qIGNsZWFyIEJZUEFTU19VTkNBQ0hFRCB0
byBhdm9pZCBoYW5ncyBhZnRlciBpbnRlcnJ1cHQuICovDQo+IC0gICAgICAgICAgICAgICBkYXRh
ID0gUlJFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX01FU19EQ19PUF9DTlRMKTsNCj4gLSAgICAgICAg
ICAgICAgIGRhdGEgPSBSRUdfU0VUX0ZJRUxEKGRhdGEsIENQX01FU19EQ19PUF9DTlRMLA0KPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQllQQVNTX1VOQ0FDSEVELCAwKTsN
Cj4gLSAgICAgICAgICAgICAgIFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9NRVNfRENfT1BfQ05U
TCwgZGF0YSk7DQo+IC0NCj4gLSAgICAgICAgICAgICAgIC8qIHVuaGFsdCBNRVMgYW5kIGFjdGl2
YXRlIHBpcGUwICovDQo+IC0gICAgICAgICAgICAgICBkYXRhID0gUkVHX1NFVF9GSUVMRCgwLCBD
UF9NRVNfQ05UTCwgTUVTX1BJUEUwX0FDVElWRSwgMSk7DQo+IC0gICAgICAgICAgICAgICBkYXRh
ID0gUkVHX1NFVF9GSUVMRChkYXRhLCBDUF9NRVNfQ05UTCwgTUVTX1BJUEUxX0FDVElWRSwNCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZXYtPmVuYWJsZV9tZXNfa2lx
ID8gMSA6IDApOw0KPiAtICAgICAgICAgICAgICAgV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX01F
U19DTlRMLCBkYXRhKTsNCj4gLSAgICAgICAgICAgICAgIHVkZWxheSgxMDApOw0KPiAtICAgICAg
IH0gZWxzZSB7DQo+IC0gICAgICAgICAgICAgICBkYXRhID0gUlJFRzMyX1NPQzE1KEdDLCAwLCBt
bUNQX01FU19DTlRMKTsNCj4gLSAgICAgICAgICAgICAgIGRhdGEgPSBSRUdfU0VUX0ZJRUxEKGRh
dGEsIENQX01FU19DTlRMLCBNRVNfUElQRTBfQUNUSVZFLCAwKTsNCj4gLSAgICAgICAgICAgICAg
IGRhdGEgPSBSRUdfU0VUX0ZJRUxEKGRhdGEsIENQX01FU19DTlRMLCBNRVNfUElQRTFfQUNUSVZF
LCAwKTsNCj4gLSAgICAgICAgICAgICAgIGRhdGEgPSBSRUdfU0VUX0ZJRUxEKGRhdGEsIENQX01F
U19DTlRMLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTUVTX0lOVkFM
SURBVEVfSUNBQ0hFLCAxKTsNCj4gLSAgICAgICAgICAgICAgIGRhdGEgPSBSRUdfU0VUX0ZJRUxE
KGRhdGEsIENQX01FU19DTlRMLCBNRVNfUElQRTBfUkVTRVQsIDEpOw0KPiAtICAgICAgICAgICAg
ICAgZGF0YSA9IFJFR19TRVRfRklFTEQoZGF0YSwgQ1BfTUVTX0NOVEwsIE1FU19QSVBFMV9SRVNF
VCwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZXYtPmVuYWJsZV9t
ZXNfa2lxID8gMSA6IDApOw0KPiAtICAgICAgICAgICAgICAgZGF0YSA9IFJFR19TRVRfRklFTEQo
ZGF0YSwgQ1BfTUVTX0NOVEwsIE1FU19IQUxULCAxKTsNCj4gLSAgICAgICAgICAgICAgIFdSRUcz
Ml9TT0MxNShHQywgMCwgbW1DUF9NRVNfQ05UTCwgZGF0YSk7DQo+IC0gICAgICAgfQ0KPiAtfQ0K
PiAtDQo+IC0vKiBUaGlzIGZ1bmN0aW9uIGlzIGZvciBiYWNrZG9vciBNRVMgZmlybXdhcmUgKi8N
Cj4gLXN0YXRpYyBpbnQgbWVzX3YxMF8xX2xvYWRfbWljcm9jb2RlKHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGFk
bWdwdV9tZXNfcGlwZSBwaXBlKQ0KPiAtew0KPiAtICAgICAgIGludCByOw0KPiAtICAgICAgIHVp
bnQzMl90IGRhdGE7DQo+IC0NCj4gLSAgICAgICBtZXNfdjEwXzFfZW5hYmxlKGFkZXYsIGZhbHNl
KTsNCj4gLQ0KPiAtICAgICAgIGlmICghYWRldi0+bWVzLmZ3W3BpcGVdKQ0KPiAtICAgICAgICAg
ICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+IC0NCj4gLSAgICAgICByID0gbWVzX3YxMF8xX2FsbG9j
YXRlX3Vjb2RlX2J1ZmZlcihhZGV2LCBwaXBlKTsNCj4gLSAgICAgICBpZiAocikNCj4gLSAgICAg
ICAgICAgICAgIHJldHVybiByOw0KPiAtDQo+IC0gICAgICAgciA9IG1lc192MTBfMV9hbGxvY2F0
ZV91Y29kZV9kYXRhX2J1ZmZlcihhZGV2LCBwaXBlKTsNCj4gLSAgICAgICBpZiAocikgew0KPiAt
ICAgICAgICAgICAgICAgbWVzX3YxMF8xX2ZyZWVfdWNvZGVfYnVmZmVycyhhZGV2LCBwaXBlKTsN
Cj4gLSAgICAgICAgICAgICAgIHJldHVybiByOw0KPiAtICAgICAgIH0NCj4gLQ0KPiAtICAgICAg
IFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9NRVNfSUNfQkFTRV9DTlRMLCAwKTsNCj4gLQ0KPiAt
ICAgICAgIG11dGV4X2xvY2soJmFkZXYtPnNyYm1fbXV0ZXgpOw0KPiAtICAgICAgIC8qIG1lPTMs
IHBpcGU9MCwgcXVldWU9MCAqLw0KPiAtICAgICAgIG52X2dyYm1fc2VsZWN0KGFkZXYsIDMsIHBp
cGUsIDAsIDApOw0KPiAtDQo+IC0gICAgICAgLyogc2V0IHVjb2RlIHN0YXJ0IGFkZHJlc3MgKi8N
Cj4gLSAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfTUVTX1BSR1JNX0NOVFJfU1RBUlQs
DQo+IC0gICAgICAgICAgICAgICAgICAgICh1aW50MzJfdCkoYWRldi0+bWVzLnVjX3N0YXJ0X2Fk
ZHJbcGlwZV0pID4+IDIpOw0KPiAtDQo+IC0gICAgICAgLyogc2V0IHVjb2RlIGZpbXJ3YXJlIGFk
ZHJlc3MgKi8NCj4gLSAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfTUVTX0lDX0JBU0Vf
TE8sDQo+IC0gICAgICAgICAgICAgICAgICAgIGxvd2VyXzMyX2JpdHMoYWRldi0+bWVzLnVjb2Rl
X2Z3X2dwdV9hZGRyW3BpcGVdKSk7DQo+IC0gICAgICAgV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQ
X01FU19JQ19CQVNFX0hJLA0KPiAtICAgICAgICAgICAgICAgICAgICB1cHBlcl8zMl9iaXRzKGFk
ZXYtPm1lcy51Y29kZV9md19ncHVfYWRkcltwaXBlXSkpOw0KPiAtDQo+IC0gICAgICAgLyogc2V0
IHVjb2RlIGluc3RydWN0aW9uIGNhY2hlIGJvdW5kYXJ5IHRvIDJNLTEgKi8NCj4gLSAgICAgICBX
UkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfTUVTX01JQk9VTkRfTE8sIDB4MUZGRkZGKTsNCj4gLQ0K
PiAtICAgICAgIC8qIHNldCB1Y29kZSBkYXRhIGZpcm13YXJlIGFkZHJlc3MgKi8NCj4gLSAgICAg
ICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfTUVTX01EQkFTRV9MTywNCj4gLSAgICAgICAgICAg
ICAgICAgICAgbG93ZXJfMzJfYml0cyhhZGV2LT5tZXMuZGF0YV9md19ncHVfYWRkcltwaXBlXSkp
Ow0KPiAtICAgICAgIFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9NRVNfTURCQVNFX0hJLA0KPiAt
ICAgICAgICAgICAgICAgICAgICB1cHBlcl8zMl9iaXRzKGFkZXYtPm1lcy5kYXRhX2Z3X2dwdV9h
ZGRyW3BpcGVdKSk7DQo+IC0NCj4gLSAgICAgICAvKiBTZXQgMHgzRkZGRiAoMjU2Sy0xKSB0byBD
UF9NRVNfTURCT1VORF9MTyAqLw0KPiAtICAgICAgIFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9N
RVNfTURCT1VORF9MTywgMHgzRkZGRik7DQo+IC0NCj4gLSAgICAgICAvKiBpbnZhbGlkYXRlIElD
QUNIRSAqLw0KPiAtICAgICAgIHN3aXRjaCAoYW1kZ3B1X2lwX3ZlcnNpb24oYWRldiwgR0NfSFdJ
UCwgMCkpIHsNCj4gLSAgICAgICBjYXNlIElQX1ZFUlNJT04oMTAsIDMsIDApOg0KPiAtICAgICAg
ICAgICAgICAgZGF0YSA9IFJSRUczMl9TT0MxNShHQywgMCwgbW1DUF9NRVNfSUNfT1BfQ05UTF9T
aWVubmFfQ2ljaGxpZCk7DQo+IC0gICAgICAgICAgICAgICBicmVhazsNCj4gLSAgICAgICBkZWZh
dWx0Og0KPiAtICAgICAgICAgICAgICAgZGF0YSA9IFJSRUczMl9TT0MxNShHQywgMCwgbW1DUF9N
RVNfSUNfT1BfQ05UTCk7DQo+IC0gICAgICAgICAgICAgICBicmVhazsNCj4gLSAgICAgICB9DQo+
IC0gICAgICAgZGF0YSA9IFJFR19TRVRfRklFTEQoZGF0YSwgQ1BfTUVTX0lDX09QX0NOVEwsIFBS
SU1FX0lDQUNIRSwgMCk7DQo+IC0gICAgICAgZGF0YSA9IFJFR19TRVRfRklFTEQoZGF0YSwgQ1Bf
TUVTX0lDX09QX0NOVEwsIElOVkFMSURBVEVfQ0FDSEUsIDEpOw0KPiAtICAgICAgIHN3aXRjaCAo
YW1kZ3B1X2lwX3ZlcnNpb24oYWRldiwgR0NfSFdJUCwgMCkpIHsNCj4gLSAgICAgICBjYXNlIElQ
X1ZFUlNJT04oMTAsIDMsIDApOg0KPiAtICAgICAgICAgICAgICAgV1JFRzMyX1NPQzE1KEdDLCAw
LCBtbUNQX01FU19JQ19PUF9DTlRMX1NpZW5uYV9DaWNobGlkLCBkYXRhKTsNCj4gLSAgICAgICAg
ICAgICAgIGJyZWFrOw0KPiAtICAgICAgIGRlZmF1bHQ6DQo+IC0gICAgICAgICAgICAgICBXUkVH
MzJfU09DMTUoR0MsIDAsIG1tQ1BfTUVTX0lDX09QX0NOVEwsIGRhdGEpOw0KPiAtICAgICAgICAg
ICAgICAgYnJlYWs7DQo+IC0gICAgICAgfQ0KPiAtDQo+IC0gICAgICAgLyogcHJpbWUgdGhlIElD
QUNIRS4gKi8NCj4gLSAgICAgICBzd2l0Y2ggKGFtZGdwdV9pcF92ZXJzaW9uKGFkZXYsIEdDX0hX
SVAsIDApKSB7DQo+IC0gICAgICAgY2FzZSBJUF9WRVJTSU9OKDEwLCAzLCAwKToNCj4gLSAgICAg
ICAgICAgICAgIGRhdGEgPSBSUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfTUVTX0lDX09QX0NOVExf
U2llbm5hX0NpY2hsaWQpOw0KPiAtICAgICAgICAgICAgICAgYnJlYWs7DQo+IC0gICAgICAgZGVm
YXVsdDoNCj4gLSAgICAgICAgICAgICAgIGRhdGEgPSBSUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1Bf
TUVTX0lDX09QX0NOVEwpOw0KPiAtICAgICAgICAgICAgICAgYnJlYWs7DQo+IC0gICAgICAgfQ0K
PiAtICAgICAgIGRhdGEgPSBSRUdfU0VUX0ZJRUxEKGRhdGEsIENQX01FU19JQ19PUF9DTlRMLCBQ
UklNRV9JQ0FDSEUsIDEpOw0KPiAtICAgICAgIHN3aXRjaCAoYW1kZ3B1X2lwX3ZlcnNpb24oYWRl
diwgR0NfSFdJUCwgMCkpIHsNCj4gLSAgICAgICBjYXNlIElQX1ZFUlNJT04oMTAsIDMsIDApOg0K
PiAtICAgICAgICAgICAgICAgV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX01FU19JQ19PUF9DTlRM
X1NpZW5uYV9DaWNobGlkLCBkYXRhKTsNCj4gLSAgICAgICAgICAgICAgIGJyZWFrOw0KPiAtICAg
ICAgIGRlZmF1bHQ6DQo+IC0gICAgICAgICAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1Bf
TUVTX0lDX09QX0NOVEwsIGRhdGEpOw0KPiAtICAgICAgICAgICAgICAgYnJlYWs7DQo+IC0gICAg
ICAgfQ0KPiAtDQo+IC0gICAgICAgbnZfZ3JibV9zZWxlY3QoYWRldiwgMCwgMCwgMCwgMCk7DQo+
IC0gICAgICAgbXV0ZXhfdW5sb2NrKCZhZGV2LT5zcmJtX211dGV4KTsNCj4gLQ0KPiAtICAgICAg
IHJldHVybiAwOw0KPiAtfQ0KPiAtDQo+IC1zdGF0aWMgaW50IG1lc192MTBfMV9hbGxvY2F0ZV9l
b3BfYnVmKHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGVudW0gYWRtZ3B1X21lc19waXBlIHBpcGUpDQo+IC17DQo+IC0g
ICAgICAgaW50IHI7DQo+IC0gICAgICAgdTMyICplb3A7DQo+IC0NCj4gLSAgICAgICByID0gYW1k
Z3B1X2JvX2NyZWF0ZV9yZXNlcnZlZChhZGV2LCBNRVNfRU9QX1NJWkUsIFBBR0VfU0laRSwNCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQU1ER1BVX0dFTV9ET01BSU5fR1RULA0KPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmYWRldi0+bWVzLmVvcF9ncHVfb2JqW3BpcGVd
LA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmYWRldi0+bWVzLmVvcF9ncHVfYWRk
cltwaXBlXSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZvaWQgKiopJmVvcCk7
DQo+IC0gICAgICAgaWYgKHIpIHsNCj4gLSAgICAgICAgICAgICAgIGRldl93YXJuKGFkZXYtPmRl
diwgIiglZCkgY3JlYXRlIEVPUCBibyBmYWlsZWRcbiIsIHIpOw0KPiAtICAgICAgICAgICAgICAg
cmV0dXJuIHI7DQo+IC0gICAgICAgfQ0KPiAtDQo+IC0gICAgICAgbWVtc2V0KGVvcCwgMCwgYWRl
di0+bWVzLmVvcF9ncHVfb2JqW3BpcGVdLT50Ym8uYmFzZS5zaXplKTsNCj4gLQ0KPiAtICAgICAg
IGFtZGdwdV9ib19rdW5tYXAoYWRldi0+bWVzLmVvcF9ncHVfb2JqW3BpcGVdKTsNCj4gLSAgICAg
ICBhbWRncHVfYm9fdW5yZXNlcnZlKGFkZXYtPm1lcy5lb3BfZ3B1X29ialtwaXBlXSk7DQo+IC0N
Cj4gLSAgICAgICByZXR1cm4gMDsNCj4gLX0NCj4gLQ0KPiAtc3RhdGljIGludCBtZXNfdjEwXzFf
bXFkX2luaXQoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQ0KPiAtew0KPiAtICAgICAgIHN0cnVj
dCB2MTBfY29tcHV0ZV9tcWQgKm1xZCA9IHJpbmctPm1xZF9wdHI7DQo+IC0gICAgICAgdWludDY0
X3QgaHFkX2dwdV9hZGRyLCB3Yl9ncHVfYWRkciwgZW9wX2Jhc2VfYWRkcjsNCj4gLSAgICAgICB1
aW50MzJfdCB0bXA7DQo+IC0NCj4gLSAgICAgICBtZW1zZXQobXFkLCAwLCBzaXplb2YoKm1xZCkp
Ow0KPiAtDQo+IC0gICAgICAgbXFkLT5oZWFkZXIgPSAweEMwMzEwODAwOw0KPiAtICAgICAgIG1x
ZC0+Y29tcHV0ZV9waXBlbGluZXN0YXRfZW5hYmxlID0gMHgwMDAwMDAwMTsNCj4gLSAgICAgICBt
cWQtPmNvbXB1dGVfc3RhdGljX3RocmVhZF9tZ210X3NlMCA9IDB4ZmZmZmZmZmY7DQo+IC0gICAg
ICAgbXFkLT5jb21wdXRlX3N0YXRpY190aHJlYWRfbWdtdF9zZTEgPSAweGZmZmZmZmZmOw0KPiAt
ICAgICAgIG1xZC0+Y29tcHV0ZV9zdGF0aWNfdGhyZWFkX21nbXRfc2UyID0gMHhmZmZmZmZmZjsN
Cj4gLSAgICAgICBtcWQtPmNvbXB1dGVfc3RhdGljX3RocmVhZF9tZ210X3NlMyA9IDB4ZmZmZmZm
ZmY7DQo+IC0gICAgICAgbXFkLT5jb21wdXRlX21pc2NfcmVzZXJ2ZWQgPSAweDAwMDAwMDAzOw0K
PiAtDQo+IC0gICAgICAgZW9wX2Jhc2VfYWRkciA9IHJpbmctPmVvcF9ncHVfYWRkciA+PiA4Ow0K
PiAtDQo+IC0gICAgICAgLyogc2V0IHRoZSBFT1Agc2l6ZSwgcmVnaXN0ZXIgdmFsdWUgaXMgMl4o
RU9QX1NJWkUrMSkgZHdvcmRzICovDQo+IC0gICAgICAgdG1wID0gbW1DUF9IUURfRU9QX0NPTlRS
T0xfREVGQVVMVDsNCj4gLSAgICAgICB0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgQ1BfSFFEX0VP
UF9DT05UUk9MLCBFT1BfU0laRSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgKG9yZGVyX2Jh
c2VfMihNRVNfRU9QX1NJWkUgLyA0KSAtIDEpKTsNCj4gLQ0KPiAtICAgICAgIG1xZC0+Y3BfaHFk
X2VvcF9iYXNlX2FkZHJfbG8gPSBsb3dlcl8zMl9iaXRzKGVvcF9iYXNlX2FkZHIpOw0KPiAtICAg
ICAgIG1xZC0+Y3BfaHFkX2VvcF9iYXNlX2FkZHJfaGkgPSB1cHBlcl8zMl9iaXRzKGVvcF9iYXNl
X2FkZHIpOw0KPiAtICAgICAgIG1xZC0+Y3BfaHFkX2VvcF9jb250cm9sID0gdG1wOw0KPiAtDQo+
IC0gICAgICAgLyogZGlzYWJsZSB0aGUgcXVldWUgaWYgaXQncyBhY3RpdmUgKi8NCj4gLSAgICAg
ICByaW5nLT53cHRyID0gMDsNCj4gLSAgICAgICBtcWQtPmNwX2hxZF9wcV9ycHRyID0gMDsNCj4g
LSAgICAgICBtcWQtPmNwX2hxZF9wcV93cHRyX2xvID0gMDsNCj4gLSAgICAgICBtcWQtPmNwX2hx
ZF9wcV93cHRyX2hpID0gMDsNCj4gLQ0KPiAtICAgICAgIC8qIHNldCB0aGUgcG9pbnRlciB0byB0
aGUgTVFEICovDQo+IC0gICAgICAgbXFkLT5jcF9tcWRfYmFzZV9hZGRyX2xvID0gcmluZy0+bXFk
X2dwdV9hZGRyICYgMHhmZmZmZmZmYzsNCj4gLSAgICAgICBtcWQtPmNwX21xZF9iYXNlX2FkZHJf
aGkgPSB1cHBlcl8zMl9iaXRzKHJpbmctPm1xZF9ncHVfYWRkcik7DQo+IC0NCj4gLSAgICAgICAv
KiBzZXQgTVFEIHZtaWQgdG8gMCAqLw0KPiAtICAgICAgIHRtcCA9IG1tQ1BfTVFEX0NPTlRST0xf
REVGQVVMVDsNCj4gLSAgICAgICB0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgQ1BfTVFEX0NPTlRS
T0wsIFZNSUQsIDApOw0KPiAtICAgICAgIG1xZC0+Y3BfbXFkX2NvbnRyb2wgPSB0bXA7DQo+IC0N
Cj4gLSAgICAgICAvKiBzZXQgdGhlIHBvaW50ZXIgdG8gdGhlIEhRRCwgdGhpcyBpcyBzaW1pbGFy
IENQX1JCMF9CQVNFL19ISSAqLw0KPiAtICAgICAgIGhxZF9ncHVfYWRkciA9IHJpbmctPmdwdV9h
ZGRyID4+IDg7DQo+IC0gICAgICAgbXFkLT5jcF9ocWRfcHFfYmFzZV9sbyA9IGxvd2VyXzMyX2Jp
dHMoaHFkX2dwdV9hZGRyKTsNCj4gLSAgICAgICBtcWQtPmNwX2hxZF9wcV9iYXNlX2hpID0gdXBw
ZXJfMzJfYml0cyhocWRfZ3B1X2FkZHIpOw0KPiAtDQo+IC0gICAgICAgLyogc2V0IHRoZSB3YiBh
ZGRyZXNzIHdoZXRoZXIgaXQncyBlbmFibGVkIG9yIG5vdCAqLw0KPiAtICAgICAgIHdiX2dwdV9h
ZGRyID0gcmluZy0+cnB0cl9ncHVfYWRkcjsNCj4gLSAgICAgICBtcWQtPmNwX2hxZF9wcV9ycHRy
X3JlcG9ydF9hZGRyX2xvID0gd2JfZ3B1X2FkZHIgJiAweGZmZmZmZmZjOw0KPiAtICAgICAgIG1x
ZC0+Y3BfaHFkX3BxX3JwdHJfcmVwb3J0X2FkZHJfaGkgPQ0KPiAtICAgICAgICAgICAgICAgdXBw
ZXJfMzJfYml0cyh3Yl9ncHVfYWRkcikgJiAweGZmZmY7DQo+IC0NCj4gLSAgICAgICAvKiBvbmx5
IHVzZWQgaWYgQ1BfUFFfV1BUUl9QT0xMX0NOVEwuQ1BfUFFfV1BUUl9QT0xMX0NOVExfX0VOX01B
U0s9MSAqLw0KPiAtICAgICAgIHdiX2dwdV9hZGRyID0gcmluZy0+d3B0cl9ncHVfYWRkcjsNCj4g
LSAgICAgICBtcWQtPmNwX2hxZF9wcV93cHRyX3BvbGxfYWRkcl9sbyA9IHdiX2dwdV9hZGRyICYg
MHhmZmZmZmZmODsNCj4gLSAgICAgICBtcWQtPmNwX2hxZF9wcV93cHRyX3BvbGxfYWRkcl9oaSA9
IHVwcGVyXzMyX2JpdHMod2JfZ3B1X2FkZHIpICYgMHhmZmZmOw0KPiAtDQo+IC0gICAgICAgLyog
c2V0IHVwIHRoZSBIUUQsIHRoaXMgaXMgc2ltaWxhciB0byBDUF9SQjBfQ05UTCAqLw0KPiAtICAg
ICAgIHRtcCA9IG1tQ1BfSFFEX1BRX0NPTlRST0xfREVGQVVMVDsNCj4gLSAgICAgICB0bXAgPSBS
RUdfU0VUX0ZJRUxEKHRtcCwgQ1BfSFFEX1BRX0NPTlRST0wsIFFVRVVFX1NJWkUsDQo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAob3JkZXJfYmFzZV8yKHJpbmctPnJpbmdfc2l6ZSAvIDQp
IC0gMSkpOw0KPiAtICAgICAgIHRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBDUF9IUURfUFFfQ09O
VFJPTCwgUlBUUl9CTE9DS19TSVpFLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgKChv
cmRlcl9iYXNlXzIoQU1ER1BVX0dQVV9QQUdFX1NJWkUgLyA0KSAtIDEpIDw8IDgpKTsNCj4gLSNp
ZmRlZiBfX0JJR19FTkRJQU4NCj4gLSAgICAgICB0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgQ1Bf
SFFEX1BRX0NPTlRST0wsIEVORElBTl9TV0FQLCAxKTsNCj4gLSNlbmRpZg0KPiAtICAgICAgIHRt
cCA9IFJFR19TRVRfRklFTEQodG1wLCBDUF9IUURfUFFfQ09OVFJPTCwgVU5PUkRfRElTUEFUQ0gs
IDEpOw0KPiAtICAgICAgIHRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBDUF9IUURfUFFfQ09OVFJP
TCwgVFVOTkVMX0RJU1BBVENILCAwKTsNCj4gLSAgICAgICB0bXAgPSBSRUdfU0VUX0ZJRUxEKHRt
cCwgQ1BfSFFEX1BRX0NPTlRST0wsIFBSSVZfU1RBVEUsIDEpOw0KPiAtICAgICAgIHRtcCA9IFJF
R19TRVRfRklFTEQodG1wLCBDUF9IUURfUFFfQ09OVFJPTCwgS01EX1FVRVVFLCAxKTsNCj4gLSAg
ICAgICB0bXAgPSBSRUdfU0VUX0ZJRUxEKHRtcCwgQ1BfSFFEX1BRX0NPTlRST0wsIE5PX1VQREFU
RV9SUFRSLCAxKTsNCj4gLSAgICAgICBtcWQtPmNwX2hxZF9wcV9jb250cm9sID0gdG1wOw0KPiAt
DQo+IC0gICAgICAgLyogZW5hYmxlIGRvb3JiZWxsPyAqLw0KPiAtICAgICAgIHRtcCA9IDA7DQo+
IC0gICAgICAgaWYgKHJpbmctPnVzZV9kb29yYmVsbCkgew0KPiAtICAgICAgICAgICAgICAgdG1w
ID0gUkVHX1NFVF9GSUVMRCh0bXAsIENQX0hRRF9QUV9ET09SQkVMTF9DT05UUk9MLA0KPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBET09SQkVMTF9PRkZTRVQsIHJpbmctPmRv
b3JiZWxsX2luZGV4KTsNCj4gLSAgICAgICAgICAgICAgIHRtcCA9IFJFR19TRVRfRklFTEQodG1w
LCBDUF9IUURfUFFfRE9PUkJFTExfQ09OVFJPTCwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgRE9PUkJFTExfRU4sIDEpOw0KPiAtICAgICAgICAgICAgICAgdG1wID0gUkVH
X1NFVF9GSUVMRCh0bXAsIENQX0hRRF9QUV9ET09SQkVMTF9DT05UUk9MLA0KPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBET09SQkVMTF9TT1VSQ0UsIDApOw0KPiAtICAgICAg
ICAgICAgICAgdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIENQX0hRRF9QUV9ET09SQkVMTF9DT05U
Uk9MLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBET09SQkVMTF9ISVQs
IDApOw0KPiAtICAgICAgIH0NCj4gLSAgICAgICBlbHNlDQo+IC0gICAgICAgICAgICAgICB0bXAg
PSBSRUdfU0VUX0ZJRUxEKHRtcCwgQ1BfSFFEX1BRX0RPT1JCRUxMX0NPTlRST0wsDQo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERPT1JCRUxMX0VOLCAwKTsNCj4gLSAgICAg
ICBtcWQtPmNwX2hxZF9wcV9kb29yYmVsbF9jb250cm9sID0gdG1wOw0KPiAtDQo+IC0gICAgICAg
bXFkLT5jcF9ocWRfdm1pZCA9IDA7DQo+IC0gICAgICAgLyogYWN0aXZhdGUgdGhlIHF1ZXVlICov
DQo+IC0gICAgICAgbXFkLT5jcF9ocWRfYWN0aXZlID0gMTsNCj4gLSAgICAgICBtcWQtPmNwX2hx
ZF9wZXJzaXN0ZW50X3N0YXRlID0gbW1DUF9IUURfUEVSU0lTVEVOVF9TVEFURV9ERUZBVUxUOw0K
PiAtICAgICAgIG1xZC0+Y3BfaHFkX2liX2NvbnRyb2wgPSBtbUNQX0hRRF9JQl9DT05UUk9MX0RF
RkFVTFQ7DQo+IC0gICAgICAgbXFkLT5jcF9ocWRfaXFfdGltZXIgPSBtbUNQX0hRRF9JUV9USU1F
Ul9ERUZBVUxUOw0KPiAtICAgICAgIG1xZC0+Y3BfaHFkX3F1YW50dW0gPSBtbUNQX0hRRF9RVUFO
VFVNX0RFRkFVTFQ7DQo+IC0NCj4gLSAgICAgICB0bXAgPSBtbUNQX0hRRF9HRlhfQ09OVFJPTF9E
RUZBVUxUOw0KPiAtICAgICAgIHRtcCA9IFJFR19TRVRfRklFTEQodG1wLCBDUF9IUURfR0ZYX0NP
TlRST0wsIERCX1VQREFURURfTVNHX0VOLCAxKTsNCj4gLSAgICAgICAvKiBvZmZzZXQ6IDE4NCAt
IHRoaXMgaXMgdXNlZCBmb3IgQ1BfSFFEX0dGWF9DT05UUk9MICovDQo+IC0gICAgICAgbXFkLT5j
cF9ocWRfc3VzcGVuZF9jbnRsX3N0YWNrX29mZnNldCA9IHRtcDsNCj4gLQ0KPiAtICAgICAgIGFt
ZGdwdV9kZXZpY2VfZmx1c2hfaGRwKHJpbmctPmFkZXYsIE5VTEwpOw0KPiAtICAgICAgIHJldHVy
biAwOw0KPiAtfQ0KPiAtDQo+IC0jaWYgMA0KPiAtc3RhdGljIHZvaWQgbWVzX3YxMF8xX3F1ZXVl
X2luaXRfcmVnaXN0ZXIoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQ0KPiAtew0KPiAtICAgICAg
IHN0cnVjdCB2MTBfY29tcHV0ZV9tcWQgKm1xZCA9IHJpbmctPm1xZF9wdHI7DQo+IC0gICAgICAg
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSByaW5nLT5hZGV2Ow0KPiAtICAgICAgIHVpbnQz
Ml90IGRhdGEgPSAwOw0KPiAtDQo+IC0gICAgICAgbXV0ZXhfbG9jaygmYWRldi0+c3JibV9tdXRl
eCk7DQo+IC0gICAgICAgbnZfZ3JibV9zZWxlY3QoYWRldiwgMywgcmluZy0+cGlwZSwgMCwgMCk7
DQo+IC0NCj4gLSAgICAgICAvKiBzZXQgQ1BfSFFEX1ZNSUQuVk1JRCA9IDAuICovDQo+IC0gICAg
ICAgZGF0YSA9IFJSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfVk1JRCk7DQo+IC0gICAgICAg
ZGF0YSA9IFJFR19TRVRfRklFTEQoZGF0YSwgQ1BfSFFEX1ZNSUQsIFZNSUQsIDApOw0KPiAtICAg
ICAgIFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfVk1JRCwgZGF0YSk7DQo+IC0NCj4gLSAg
ICAgICAvKiBzZXQgQ1BfSFFEX1BRX0RPT1JCRUxMX0NPTlRST0wuRE9PUkJFTExfRU49MCAqLw0K
PiAtICAgICAgIGRhdGEgPSBSUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfSFFEX1BRX0RPT1JCRUxM
X0NPTlRST0wpOw0KPiAtICAgICAgIGRhdGEgPSBSRUdfU0VUX0ZJRUxEKGRhdGEsIENQX0hRRF9Q
UV9ET09SQkVMTF9DT05UUk9MLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgIERPT1JC
RUxMX0VOLCAwKTsNCj4gLSAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfSFFEX1BRX0RP
T1JCRUxMX0NPTlRST0wsIGRhdGEpOw0KPiAtDQo+IC0gICAgICAgLyogc2V0IENQX01RRF9CQVNF
X0FERFIvSEkgd2l0aCB0aGUgTVFEIGJhc2UgYWRkcmVzcyAqLw0KPiAtICAgICAgIFdSRUczMl9T
T0MxNShHQywgMCwgbW1DUF9NUURfQkFTRV9BRERSLCBtcWQtPmNwX21xZF9iYXNlX2FkZHJfbG8p
Ow0KPiAtICAgICAgIFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9NUURfQkFTRV9BRERSX0hJLCBt
cWQtPmNwX21xZF9iYXNlX2FkZHJfaGkpOw0KPiAtDQo+IC0gICAgICAgLyogc2V0IENQX01RRF9D
T05UUk9MLlZNSUQ9MCAqLw0KPiAtICAgICAgIGRhdGEgPSBSUkVHMzJfU09DMTUoR0MsIDAsIG1t
Q1BfTVFEX0NPTlRST0wpOw0KPiAtICAgICAgIGRhdGEgPSBSRUdfU0VUX0ZJRUxEKGRhdGEsIENQ
X01RRF9DT05UUk9MLCBWTUlELCAwKTsNCj4gLSAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1t
Q1BfTVFEX0NPTlRST0wsIDApOw0KPiAtDQo+IC0gICAgICAgLyogc2V0IENQX0hRRF9QUV9CQVNF
L0hJIHdpdGggdGhlIHJpbmcgYnVmZmVyIGJhc2UgYWRkcmVzcyAqLw0KPiAtICAgICAgIFdSRUcz
Ml9TT0MxNShHQywgMCwgbW1DUF9IUURfUFFfQkFTRSwgbXFkLT5jcF9ocWRfcHFfYmFzZV9sbyk7
DQo+IC0gICAgICAgV1JFRzMyX1NPQzE1KEdDLCAwLCBtbUNQX0hRRF9QUV9CQVNFX0hJLCBtcWQt
PmNwX2hxZF9wcV9iYXNlX2hpKTsNCj4gLQ0KPiAtICAgICAgIC8qIHNldCBDUF9IUURfUFFfUlBU
Ul9SRVBPUlRfQUREUi9ISSAqLw0KPiAtICAgICAgIFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9I
UURfUFFfUlBUUl9SRVBPUlRfQUREUiwNCj4gLSAgICAgICAgICAgICAgICAgICAgbXFkLT5jcF9o
cWRfcHFfcnB0cl9yZXBvcnRfYWRkcl9sbyk7DQo+IC0gICAgICAgV1JFRzMyX1NPQzE1KEdDLCAw
LCBtbUNQX0hRRF9QUV9SUFRSX1JFUE9SVF9BRERSX0hJLA0KPiAtICAgICAgICAgICAgICAgICAg
ICBtcWQtPmNwX2hxZF9wcV9ycHRyX3JlcG9ydF9hZGRyX2hpKTsNCj4gLQ0KPiAtICAgICAgIC8q
IHNldCBDUF9IUURfUFFfQ09OVFJPTCAqLw0KPiAtICAgICAgIFdSRUczMl9TT0MxNShHQywgMCwg
bW1DUF9IUURfUFFfQ09OVFJPTCwgbXFkLT5jcF9ocWRfcHFfY29udHJvbCk7DQo+IC0NCj4gLSAg
ICAgICAvKiBzZXQgQ1BfSFFEX1BRX1dQVFJfUE9MTF9BRERSL0hJICovDQo+IC0gICAgICAgV1JF
RzMyX1NPQzE1KEdDLCAwLCBtbUNQX0hRRF9QUV9XUFRSX1BPTExfQUREUiwNCj4gLSAgICAgICAg
ICAgICAgICAgICAgbXFkLT5jcF9ocWRfcHFfd3B0cl9wb2xsX2FkZHJfbG8pOw0KPiAtICAgICAg
IFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9QT0xMX0FERFJfSEksDQo+IC0g
ICAgICAgICAgICAgICAgICAgIG1xZC0+Y3BfaHFkX3BxX3dwdHJfcG9sbF9hZGRyX2hpKTsNCj4g
LQ0KPiAtICAgICAgIC8qIHNldCBDUF9IUURfUFFfRE9PUkJFTExfQ09OVFJPTCAqLw0KPiAtICAg
ICAgIFdSRUczMl9TT0MxNShHQywgMCwgbW1DUF9IUURfUFFfRE9PUkJFTExfQ09OVFJPTCwNCj4g
LSAgICAgICAgICAgICAgICAgICAgbXFkLT5jcF9ocWRfcHFfZG9vcmJlbGxfY29udHJvbCk7DQo+
IC0NCj4gLSAgICAgICAvKiBzZXQgQ1BfSFFEX1BFUlNJU1RFTlRfU1RBVEUuUFJFTE9BRF9TSVpF
PTB4NTMgKi8NCj4gLSAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1tQ1BfSFFEX1BFUlNJU1RF
TlRfU1RBVEUsIG1xZC0+Y3BfaHFkX3BlcnNpc3RlbnRfc3RhdGUpOw0KPiAtDQo+IC0gICAgICAg
Lyogc2V0IENQX0hRRF9BQ1RJVkUuQUNUSVZFPTEgKi8NCj4gLSAgICAgICBXUkVHMzJfU09DMTUo
R0MsIDAsIG1tQ1BfSFFEX0FDVElWRSwgbXFkLT5jcF9ocWRfYWN0aXZlKTsNCj4gLQ0KPiAtICAg
ICAgIG52X2dyYm1fc2VsZWN0KGFkZXYsIDAsIDAsIDAsIDApOw0KPiAtICAgICAgIG11dGV4X3Vu
bG9jaygmYWRldi0+c3JibV9tdXRleCk7DQo+IC19DQo+IC0jZW5kaWYNCj4gLQ0KPiAtc3RhdGlj
IGludCBtZXNfdjEwXzFfa2lxX2VuYWJsZV9xdWV1ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
dikNCj4gLXsNCj4gLSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2tpcSAqa2lxID0gJmFkZXYtPmdmeC5r
aXFbMF07DQo+IC0gICAgICAgc3RydWN0IGFtZGdwdV9yaW5nICpraXFfcmluZyA9ICZhZGV2LT5n
Zngua2lxWzBdLnJpbmc7DQo+IC0gICAgICAgaW50IHI7DQo+IC0NCj4gLSAgICAgICBpZiAoIWtp
cS0+cG1mIHx8ICFraXEtPnBtZi0+a2lxX21hcF9xdWV1ZXMpDQo+IC0gICAgICAgICAgICAgICBy
ZXR1cm4gLUVJTlZBTDsNCj4gLQ0KPiAtICAgICAgIHIgPSBhbWRncHVfcmluZ19hbGxvYyhraXFf
cmluZywga2lxLT5wbWYtPm1hcF9xdWV1ZXNfc2l6ZSk7DQo+IC0gICAgICAgaWYgKHIpIHsNCj4g
LSAgICAgICAgICAgICAgIERSTV9FUlJPUigiRmFpbGVkIHRvIGxvY2sgS0lRICglZCkuXG4iLCBy
KTsNCj4gLSAgICAgICAgICAgICAgIHJldHVybiByOw0KPiAtICAgICAgIH0NCj4gLQ0KPiAtICAg
ICAgIGtpcS0+cG1mLT5raXFfbWFwX3F1ZXVlcyhraXFfcmluZywgJmFkZXYtPm1lcy5yaW5nKTsN
Cj4gLQ0KPiAtICAgICAgIHJldHVybiBhbWRncHVfcmluZ190ZXN0X2hlbHBlcihraXFfcmluZyk7
DQo+IC19DQo+IC0NCj4gLXN0YXRpYyBpbnQgbWVzX3YxMF8xX3F1ZXVlX2luaXQoc3RydWN0IGFt
ZGdwdV9kZXZpY2UgKmFkZXYpDQo+IC17DQo+IC0gICAgICAgaW50IHI7DQo+IC0NCj4gLSAgICAg
ICByID0gbWVzX3YxMF8xX21xZF9pbml0KCZhZGV2LT5tZXMucmluZyk7DQo+IC0gICAgICAgaWYg
KHIpDQo+IC0gICAgICAgICAgICAgICByZXR1cm4gcjsNCj4gLQ0KPiAtICAgICAgIHIgPSBtZXNf
djEwXzFfa2lxX2VuYWJsZV9xdWV1ZShhZGV2KTsNCj4gLSAgICAgICBpZiAocikNCj4gLSAgICAg
ICAgICAgICAgIHJldHVybiByOw0KPiAtDQo+IC0gICAgICAgcmV0dXJuIDA7DQo+IC19DQo+IC0N
Cj4gLXN0YXRpYyBpbnQgbWVzX3YxMF8xX3JpbmdfaW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAq
YWRldikNCj4gLXsNCj4gLSAgICAgICBzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmc7DQo+IC0NCj4g
LSAgICAgICByaW5nID0gJmFkZXYtPm1lcy5yaW5nOw0KPiAtDQo+IC0gICAgICAgcmluZy0+ZnVu
Y3MgPSAmbWVzX3YxMF8xX3JpbmdfZnVuY3M7DQo+IC0NCj4gLSAgICAgICByaW5nLT5tZSA9IDM7
DQo+IC0gICAgICAgcmluZy0+cGlwZSA9IDA7DQo+IC0gICAgICAgcmluZy0+cXVldWUgPSAwOw0K
PiAtDQo+IC0gICAgICAgcmluZy0+cmluZ19vYmogPSBOVUxMOw0KPiAtICAgICAgIHJpbmctPnVz
ZV9kb29yYmVsbCA9IHRydWU7DQo+IC0gICAgICAgcmluZy0+ZG9vcmJlbGxfaW5kZXggPSBhZGV2
LT5kb29yYmVsbF9pbmRleC5tZXNfcmluZzAgPDwgMTsNCj4gLSAgICAgICByaW5nLT5lb3BfZ3B1
X2FkZHIgPSBhZGV2LT5tZXMuZW9wX2dwdV9hZGRyW0FNREdQVV9NRVNfU0NIRURfUElQRV07DQo+
IC0gICAgICAgcmluZy0+bm9fc2NoZWR1bGVyID0gdHJ1ZTsNCj4gLSAgICAgICBzcHJpbnRmKHJp
bmctPm5hbWUsICJtZXNfJWQuJWQuJWQiLCByaW5nLT5tZSwgcmluZy0+cGlwZSwgcmluZy0+cXVl
dWUpOw0KPiAtDQo+IC0gICAgICAgcmV0dXJuIGFtZGdwdV9yaW5nX2luaXQoYWRldiwgcmluZywg
MTAyNCwgTlVMTCwgMCwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBTURHUFVf
UklOR19QUklPX0RFRkFVTFQsIE5VTEwpOw0KPiAtfQ0KPiAtDQo+IC1zdGF0aWMgaW50IG1lc192
MTBfMV9raXFfcmluZ19pbml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQ0KPiAtew0KPiAt
ICAgICAgIHN0cnVjdCBhbWRncHVfcmluZyAqcmluZzsNCj4gLQ0KPiAtICAgICAgIHNwaW5fbG9j
a19pbml0KCZhZGV2LT5nZngua2lxWzBdLnJpbmdfbG9jayk7DQo+IC0NCj4gLSAgICAgICByaW5n
ID0gJmFkZXYtPmdmeC5raXFbMF0ucmluZzsNCj4gLQ0KPiAtICAgICAgIHJpbmctPm1lID0gMzsN
Cj4gLSAgICAgICByaW5nLT5waXBlID0gMTsNCj4gLSAgICAgICByaW5nLT5xdWV1ZSA9IDA7DQo+
IC0NCj4gLSAgICAgICByaW5nLT5hZGV2ID0gTlVMTDsNCj4gLSAgICAgICByaW5nLT5yaW5nX29i
aiA9IE5VTEw7DQo+IC0gICAgICAgcmluZy0+dXNlX2Rvb3JiZWxsID0gdHJ1ZTsNCj4gLSAgICAg
ICByaW5nLT5kb29yYmVsbF9pbmRleCA9IGFkZXYtPmRvb3JiZWxsX2luZGV4Lm1lc19yaW5nMSA8
PCAxOw0KPiAtICAgICAgIHJpbmctPmVvcF9ncHVfYWRkciA9IGFkZXYtPm1lcy5lb3BfZ3B1X2Fk
ZHJbQU1ER1BVX01FU19LSVFfUElQRV07DQo+IC0gICAgICAgcmluZy0+bm9fc2NoZWR1bGVyID0g
dHJ1ZTsNCj4gLSAgICAgICBzcHJpbnRmKHJpbmctPm5hbWUsICJtZXNfa2lxXyVkLiVkLiVkIiwN
Cj4gLSAgICAgICAgICAgICAgIHJpbmctPm1lLCByaW5nLT5waXBlLCByaW5nLT5xdWV1ZSk7DQo+
IC0NCj4gLSAgICAgICByZXR1cm4gYW1kZ3B1X3JpbmdfaW5pdChhZGV2LCByaW5nLCAxMDI0LCBO
VUxMLCAwLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFNREdQVV9SSU5HX1BS
SU9fREVGQVVMVCwgTlVMTCk7DQo+IC19DQo+IC0NCj4gLXN0YXRpYyBpbnQgbWVzX3YxMF8xX21x
ZF9zd19pbml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LA0KPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBlbnVtIGFkbWdwdV9tZXNfcGlwZSBwaXBlKQ0KPiAtew0KPiAtICAg
ICAgIGludCByLCBtcWRfc2l6ZSA9IHNpemVvZihzdHJ1Y3QgdjEwX2NvbXB1dGVfbXFkKTsNCj4g
LSAgICAgICBzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmc7DQo+IC0NCj4gLSAgICAgICBpZiAocGlw
ZSA9PSBBTURHUFVfTUVTX0tJUV9QSVBFKQ0KPiAtICAgICAgICAgICAgICAgcmluZyA9ICZhZGV2
LT5nZngua2lxWzBdLnJpbmc7DQo+IC0gICAgICAgZWxzZSBpZiAocGlwZSA9PSBBTURHUFVfTUVT
X1NDSEVEX1BJUEUpDQo+IC0gICAgICAgICAgICAgICByaW5nID0gJmFkZXYtPm1lcy5yaW5nOw0K
PiAtICAgICAgIGVsc2UNCj4gLSAgICAgICAgICAgICAgIEJVRygpOw0KPiAtDQo+IC0gICAgICAg
aWYgKHJpbmctPm1xZF9vYmopDQo+IC0gICAgICAgICAgICAgICByZXR1cm4gMDsNCj4gLQ0KPiAt
ICAgICAgIHIgPSBhbWRncHVfYm9fY3JlYXRlX2tlcm5lbChhZGV2LCBtcWRfc2l6ZSwgUEFHRV9T
SVpFLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBTURHUFVfR0VNX0RP
TUFJTl9WUkFNIHwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQU1ER1BV
X0dFTV9ET01BSU5fR1RULCAmcmluZy0+bXFkX29iaiwNCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJnJpbmctPm1xZF9ncHVfYWRkciwgJnJpbmctPm1xZF9wdHIpOw0KPiAt
ICAgICAgIGlmIChyKSB7DQo+IC0gICAgICAgICAgICAgICBkZXZfd2FybihhZGV2LT5kZXYsICJm
YWlsZWQgdG8gY3JlYXRlIHJpbmcgbXFkIGJvICglZCkiLCByKTsNCj4gLSAgICAgICAgICAgICAg
IHJldHVybiByOw0KPiAtICAgICAgIH0NCj4gLSAgICAgICBtZW1zZXQocmluZy0+bXFkX3B0ciwg
MCwgbXFkX3NpemUpOw0KPiAtDQo+IC0gICAgICAgLyogcHJlcGFyZSBNUUQgYmFja3VwICovDQo+
IC0gICAgICAgYWRldi0+bWVzLm1xZF9iYWNrdXBbcGlwZV0gPSBrbWFsbG9jKG1xZF9zaXplLCBH
RlBfS0VSTkVMKTsNCj4gLSAgICAgICBpZiAoIWFkZXYtPm1lcy5tcWRfYmFja3VwW3BpcGVdKSB7
DQo+IC0gICAgICAgICAgICAgICBkZXZfd2FybihhZGV2LT5kZXYsDQo+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAibm8gbWVtb3J5IHRvIGNyZWF0ZSBNUUQgYmFja3VwIGZvciByaW5nICVzXG4i
LA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgcmluZy0+bmFtZSk7DQo+IC0gICAgICAgICAg
ICAgICByZXR1cm4gLUVOT01FTTsNCj4gLSAgICAgICB9DQo+IC0NCj4gLSAgICAgICByZXR1cm4g
MDsNCj4gLX0NCj4gLQ0KPiAtc3RhdGljIGludCBtZXNfdjEwXzFfc3dfaW5pdCh2b2lkICpoYW5k
bGUpDQo+IC17DQo+IC0gICAgICAgc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYgPSAoc3RydWN0
IGFtZGdwdV9kZXZpY2UgKiloYW5kbGU7DQo+IC0gICAgICAgaW50IHBpcGUsIHI7DQo+IC0NCj4g
LSAgICAgICBhZGV2LT5tZXMuZnVuY3MgPSAmbWVzX3YxMF8xX2Z1bmNzOw0KPiAtICAgICAgIGFk
ZXYtPm1lcy5raXFfaHdfaW5pdCA9ICZtZXNfdjEwXzFfa2lxX2h3X2luaXQ7DQo+IC0NCj4gLSAg
ICAgICByID0gYW1kZ3B1X21lc19pbml0KGFkZXYpOw0KPiAtICAgICAgIGlmIChyKQ0KPiAtICAg
ICAgICAgICAgICAgcmV0dXJuIHI7DQo+IC0NCj4gLSAgICAgICBmb3IgKHBpcGUgPSAwOyBwaXBl
IDwgQU1ER1BVX01BWF9NRVNfUElQRVM7IHBpcGUrKykgew0KPiAtICAgICAgICAgICAgICAgaWYg
KCFhZGV2LT5lbmFibGVfbWVzX2tpcSAmJiBwaXBlID09IEFNREdQVV9NRVNfS0lRX1BJUEUpDQo+
IC0gICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KPiAtDQo+IC0gICAgICAgICAgICAg
ICByID0gbWVzX3YxMF8xX2FsbG9jYXRlX2VvcF9idWYoYWRldiwgcGlwZSk7DQo+IC0gICAgICAg
ICAgICAgICBpZiAocikNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7DQo+IC0N
Cj4gLSAgICAgICAgICAgICAgIHIgPSBtZXNfdjEwXzFfbXFkX3N3X2luaXQoYWRldiwgcGlwZSk7
DQo+IC0gICAgICAgICAgICAgICBpZiAocikNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIHI7DQo+IC0gICAgICAgfQ0KPiAtDQo+IC0gICAgICAgaWYgKGFkZXYtPmVuYWJsZV9tZXNf
a2lxKSB7DQo+IC0gICAgICAgICAgICAgICByID0gbWVzX3YxMF8xX2tpcV9yaW5nX2luaXQoYWRl
dik7DQo+IC0gICAgICAgICAgICAgICBpZiAocikNCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuIHI7DQo+IC0gICAgICAgfQ0KPiAtDQo+IC0gICAgICAgciA9IG1lc192MTBfMV9yaW5n
X2luaXQoYWRldik7DQo+IC0gICAgICAgaWYgKHIpDQo+IC0gICAgICAgICAgICAgICByZXR1cm4g
cjsNCj4gLQ0KPiAtICAgICAgIHJldHVybiAwOw0KPiAtfQ0KPiAtDQo+IC1zdGF0aWMgaW50IG1l
c192MTBfMV9zd19maW5pKHZvaWQgKmhhbmRsZSkNCj4gLXsNCj4gLSAgICAgICBzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhhbmRsZTsNCj4gLSAg
ICAgICBpbnQgcGlwZTsNCj4gLQ0KPiAtICAgICAgIGFtZGdwdV9kZXZpY2Vfd2JfZnJlZShhZGV2
LCBhZGV2LT5tZXMuc2NoX2N0eF9vZmZzKTsNCj4gLSAgICAgICBhbWRncHVfZGV2aWNlX3diX2Zy
ZWUoYWRldiwgYWRldi0+bWVzLnF1ZXJ5X3N0YXR1c19mZW5jZV9vZmZzKTsNCj4gLQ0KPiAtICAg
ICAgIGZvciAocGlwZSA9IDA7IHBpcGUgPCBBTURHUFVfTUFYX01FU19QSVBFUzsgcGlwZSsrKSB7
DQo+IC0gICAgICAgICAgICAgICBrZnJlZShhZGV2LT5tZXMubXFkX2JhY2t1cFtwaXBlXSk7DQo+
IC0NCj4gLSAgICAgICAgICAgICAgIGFtZGdwdV9ib19mcmVlX2tlcm5lbCgmYWRldi0+bWVzLmVv
cF9ncHVfb2JqW3BpcGVdLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICZhZGV2LT5tZXMuZW9wX2dwdV9hZGRyW3BpcGVdLA0KPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIE5VTEwpOw0KPiAtICAgICAgICAgICAgICAgYW1kZ3B1X3Vjb2RlX3Jl
bGVhc2UoJmFkZXYtPm1lcy5md1twaXBlXSk7DQo+IC0gICAgICAgfQ0KPiAtDQo+IC0gICAgICAg
YW1kZ3B1X2JvX2ZyZWVfa2VybmVsKCZhZGV2LT5nZngua2lxWzBdLnJpbmcubXFkX29iaiwNCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkZXYtPmdmeC5raXFbMF0ucmluZy5tcWRf
Z3B1X2FkZHIsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICZhZGV2LT5nZngua2lx
WzBdLnJpbmcubXFkX3B0cik7DQo+IC0NCj4gLSAgICAgICBhbWRncHVfYm9fZnJlZV9rZXJuZWwo
JmFkZXYtPm1lcy5yaW5nLm1xZF9vYmosDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICZhZGV2LT5tZXMucmluZy5tcWRfZ3B1X2FkZHIsDQo+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICZhZGV2LT5tZXMucmluZy5tcWRfcHRyKTsNCj4gLQ0KPiAtICAgICAgIGFtZGdwdV9y
aW5nX2ZpbmkoJmFkZXYtPmdmeC5raXFbMF0ucmluZyk7DQo+IC0gICAgICAgYW1kZ3B1X3Jpbmdf
ZmluaSgmYWRldi0+bWVzLnJpbmcpOw0KPiAtDQo+IC0gICAgICAgYW1kZ3B1X21lc19maW5pKGFk
ZXYpOw0KPiAtICAgICAgIHJldHVybiAwOw0KPiAtfQ0KPiAtDQo+IC1zdGF0aWMgdm9pZCBtZXNf
djEwXzFfa2lxX3NldHRpbmcoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nKQ0KPiAtew0KPiAtICAg
ICAgIHVpbnQzMl90IHRtcDsNCj4gLSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9
IHJpbmctPmFkZXY7DQo+IC0NCj4gLSAgICAgICAvKiB0ZWxsIFJMQyB3aGljaCBpcyBLSVEgcXVl
dWUgKi8NCj4gLSAgICAgICBzd2l0Y2ggKGFtZGdwdV9pcF92ZXJzaW9uKGFkZXYsIEdDX0hXSVAs
IDApKSB7DQo+IC0gICAgICAgY2FzZSBJUF9WRVJTSU9OKDEwLCAzLCAwKToNCj4gLSAgICAgICBj
YXNlIElQX1ZFUlNJT04oMTAsIDMsIDIpOg0KPiAtICAgICAgIGNhc2UgSVBfVkVSU0lPTigxMCwg
MywgMSk6DQo+IC0gICAgICAgY2FzZSBJUF9WRVJTSU9OKDEwLCAzLCA0KToNCj4gLSAgICAgICAg
ICAgICAgIHRtcCA9IFJSRUczMl9TT0MxNShHQywgMCwgbW1STENfQ1BfU0NIRURVTEVSU19TaWVu
bmFfQ2ljaGxpZCk7DQo+IC0gICAgICAgICAgICAgICB0bXAgJj0gMHhmZmZmZmYwMDsNCj4gLSAg
ICAgICAgICAgICAgIHRtcCB8PSAocmluZy0+bWUgPDwgNSkgfCAocmluZy0+cGlwZSA8PCAzKSB8
IChyaW5nLT5xdWV1ZSk7DQo+IC0gICAgICAgICAgICAgICBXUkVHMzJfU09DMTUoR0MsIDAsIG1t
UkxDX0NQX1NDSEVEVUxFUlNfU2llbm5hX0NpY2hsaWQsIHRtcCk7DQo+IC0gICAgICAgICAgICAg
ICB0bXAgfD0gMHg4MDsNCj4gLSAgICAgICAgICAgICAgIFdSRUczMl9TT0MxNShHQywgMCwgbW1S
TENfQ1BfU0NIRURVTEVSU19TaWVubmFfQ2ljaGxpZCwgdG1wKTsNCj4gLSAgICAgICAgICAgICAg
IGJyZWFrOw0KPiAtICAgICAgIGRlZmF1bHQ6DQo+IC0gICAgICAgICAgICAgICB0bXAgPSBSUkVH
MzJfU09DMTUoR0MsIDAsIG1tUkxDX0NQX1NDSEVEVUxFUlMpOw0KPiAtICAgICAgICAgICAgICAg
dG1wICY9IDB4ZmZmZmZmMDA7DQo+IC0gICAgICAgICAgICAgICB0bXAgfD0gKHJpbmctPm1lIDw8
IDUpIHwgKHJpbmctPnBpcGUgPDwgMykgfCAocmluZy0+cXVldWUpOw0KPiAtICAgICAgICAgICAg
ICAgV1JFRzMyX1NPQzE1KEdDLCAwLCBtbVJMQ19DUF9TQ0hFRFVMRVJTLCB0bXApOw0KPiAtICAg
ICAgICAgICAgICAgdG1wIHw9IDB4ODA7DQo+IC0gICAgICAgICAgICAgICBXUkVHMzJfU09DMTUo
R0MsIDAsIG1tUkxDX0NQX1NDSEVEVUxFUlMsIHRtcCk7DQo+IC0gICAgICAgICAgICAgICBicmVh
azsNCj4gLSAgICAgICB9DQo+IC19DQo+IC0NCj4gLXN0YXRpYyBpbnQgbWVzX3YxMF8xX2tpcV9o
d19pbml0KHN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2KQ0KPiAtew0KPiAtICAgICAgIGludCBy
ID0gMDsNCj4gLQ0KPiAtICAgICAgIGlmIChhZGV2LT5maXJtd2FyZS5sb2FkX3R5cGUgPT0gQU1E
R1BVX0ZXX0xPQURfRElSRUNUKSB7DQo+IC0gICAgICAgICAgICAgICByID0gbWVzX3YxMF8xX2xv
YWRfbWljcm9jb2RlKGFkZXYsIEFNREdQVV9NRVNfS0lRX1BJUEUpOw0KPiAtICAgICAgICAgICAg
ICAgaWYgKHIpIHsNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgRFJNX0VSUk9SKCJmYWlsZWQg
dG8gbG9hZCBNRVMga2lxIGZ3LCByPSVkXG4iLCByKTsNCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIHI7DQo+IC0gICAgICAgICAgICAgICB9DQo+IC0NCj4gLSAgICAgICAgICAgICAg
IHIgPSBtZXNfdjEwXzFfbG9hZF9taWNyb2NvZGUoYWRldiwgQU1ER1BVX01FU19TQ0hFRF9QSVBF
KTsNCj4gLSAgICAgICAgICAgICAgIGlmIChyKSB7DQo+IC0gICAgICAgICAgICAgICAgICAgICAg
IERSTV9FUlJPUigiZmFpbGVkIHRvIGxvYWQgTUVTIGZ3LCByPSVkXG4iLCByKTsNCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7DQo+IC0gICAgICAgICAgICAgICB9DQo+IC0gICAg
ICAgfQ0KPiAtDQo+IC0gICAgICAgbWVzX3YxMF8xX2VuYWJsZShhZGV2LCB0cnVlKTsNCj4gLQ0K
PiAtICAgICAgIG1lc192MTBfMV9raXFfc2V0dGluZygmYWRldi0+Z2Z4LmtpcVswXS5yaW5nKTsN
Cj4gLQ0KPiAtICAgICAgIHIgPSBtZXNfdjEwXzFfcXVldWVfaW5pdChhZGV2KTsNCj4gLSAgICAg
ICBpZiAocikNCj4gLSAgICAgICAgICAgICAgIGdvdG8gZmFpbHVyZTsNCj4gLQ0KPiAtICAgICAg
IHJldHVybiByOw0KPiAtDQo+IC1mYWlsdXJlOg0KPiAtICAgICAgIG1lc192MTBfMV9od19maW5p
KGFkZXYpOw0KPiAtICAgICAgIHJldHVybiByOw0KPiAtfQ0KPiAtDQo+IC1zdGF0aWMgaW50IG1l
c192MTBfMV9od19pbml0KHZvaWQgKmhhbmRsZSkNCj4gLXsNCj4gLSAgICAgICBpbnQgcjsNCj4g
LSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqKWhhbmRsZTsNCj4gLQ0KPiAtICAgICAgIGlmICghYWRldi0+ZW5hYmxlX21lc19raXEpIHsN
Cj4gLSAgICAgICAgICAgICAgIGlmIChhZGV2LT5maXJtd2FyZS5sb2FkX3R5cGUgPT0gQU1ER1BV
X0ZXX0xPQURfRElSRUNUKSB7DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIHIgPSBtZXNfdjEw
XzFfbG9hZF9taWNyb2NvZGUoYWRldiwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgQU1ER1BVX01FU19TQ0hFRF9QSVBFKTsNCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKHIpIHsNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEUk1f
RVJST1IoImZhaWxlZCB0byBNRVMgZncsIHI9JWRcbiIsIHIpOw0KPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHJldHVybiByOw0KPiAtICAgICAgICAgICAgICAgICAgICAgICB9DQo+
IC0gICAgICAgICAgICAgICB9DQo+IC0NCj4gLSAgICAgICAgICAgICAgIG1lc192MTBfMV9lbmFi
bGUoYWRldiwgdHJ1ZSk7DQo+IC0gICAgICAgfQ0KPiAtDQo+IC0gICAgICAgciA9IG1lc192MTBf
MV9xdWV1ZV9pbml0KGFkZXYpOw0KPiAtICAgICAgIGlmIChyKQ0KPiAtICAgICAgICAgICAgICAg
Z290byBmYWlsdXJlOw0KPiAtDQo+IC0gICAgICAgciA9IG1lc192MTBfMV9zZXRfaHdfcmVzb3Vy
Y2VzKCZhZGV2LT5tZXMpOw0KPiAtICAgICAgIGlmIChyKQ0KPiAtICAgICAgICAgICAgICAgZ290
byBmYWlsdXJlOw0KPiAtDQo+IC0gICAgICAgbWVzX3YxMF8xX2luaXRfYWdncmVnYXRlZF9kb29y
YmVsbCgmYWRldi0+bWVzKTsNCj4gLQ0KPiAtICAgICAgIHIgPSBtZXNfdjEwXzFfcXVlcnlfc2No
ZWRfc3RhdHVzKCZhZGV2LT5tZXMpOw0KPiAtICAgICAgIGlmIChyKSB7DQo+IC0gICAgICAgICAg
ICAgICBEUk1fRVJST1IoIk1FUyBpcyBidXN5XG4iKTsNCj4gLSAgICAgICAgICAgICAgIGdvdG8g
ZmFpbHVyZTsNCj4gLSAgICAgICB9DQo+IC0NCj4gLSAgICAgICAvKg0KPiAtICAgICAgICAqIERp
c2FibGUgS0lRIHJpbmcgdXNhZ2UgZnJvbSB0aGUgZHJpdmVyIG9uY2UgTUVTIGlzIGVuYWJsZWQu
DQo+IC0gICAgICAgICogTUVTIHVzZXMgS0lRIHJpbmcgZXhjbHVzaXZlbHkgc28gZHJpdmVyIGNh
bm5vdCBhY2Nlc3MgS0lRIHJpbmcNCj4gLSAgICAgICAgKiB3aXRoIE1FUyBlbmFibGVkLg0KPiAt
ICAgICAgICAqLw0KPiAtICAgICAgIGFkZXYtPmdmeC5raXFbMF0ucmluZy5zY2hlZC5yZWFkeSA9
IGZhbHNlOw0KPiAtICAgICAgIGFkZXYtPm1lcy5yaW5nLnNjaGVkLnJlYWR5ID0gdHJ1ZTsNCj4g
LQ0KPiAtICAgICAgIHJldHVybiAwOw0KPiAtDQo+IC1mYWlsdXJlOg0KPiAtICAgICAgIG1lc192
MTBfMV9od19maW5pKGFkZXYpOw0KPiAtICAgICAgIHJldHVybiByOw0KPiAtfQ0KPiAtDQo+IC1z
dGF0aWMgaW50IG1lc192MTBfMV9od19maW5pKHZvaWQgKmhhbmRsZSkNCj4gLXsNCj4gLSAgICAg
ICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqKWhh
bmRsZTsNCj4gLQ0KPiAtICAgICAgIGFkZXYtPm1lcy5yaW5nLnNjaGVkLnJlYWR5ID0gZmFsc2U7
DQo+IC0NCj4gLSAgICAgICBtZXNfdjEwXzFfZW5hYmxlKGFkZXYsIGZhbHNlKTsNCj4gLQ0KPiAt
ICAgICAgIGlmIChhZGV2LT5maXJtd2FyZS5sb2FkX3R5cGUgPT0gQU1ER1BVX0ZXX0xPQURfRElS
RUNUKSB7DQo+IC0gICAgICAgICAgICAgICBtZXNfdjEwXzFfZnJlZV91Y29kZV9idWZmZXJzKGFk
ZXYsIEFNREdQVV9NRVNfS0lRX1BJUEUpOw0KPiAtICAgICAgICAgICAgICAgbWVzX3YxMF8xX2Zy
ZWVfdWNvZGVfYnVmZmVycyhhZGV2LCBBTURHUFVfTUVTX1NDSEVEX1BJUEUpOw0KPiAtICAgICAg
IH0NCj4gLQ0KPiAtICAgICAgIHJldHVybiAwOw0KPiAtfQ0KPiAtDQo+IC1zdGF0aWMgaW50IG1l
c192MTBfMV9zdXNwZW5kKHZvaWQgKmhhbmRsZSkNCj4gLXsNCj4gLSAgICAgICBpbnQgcjsNCj4g
LSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqKWhhbmRsZTsNCj4gLQ0KPiAtICAgICAgIHIgPSBhbWRncHVfbWVzX3N1c3BlbmQoYWRldik7
DQo+IC0gICAgICAgaWYgKHIpDQo+IC0gICAgICAgICAgICAgICByZXR1cm4gcjsNCj4gLQ0KPiAt
ICAgICAgIHJldHVybiBtZXNfdjEwXzFfaHdfZmluaShhZGV2KTsNCj4gLX0NCj4gLQ0KPiAtc3Rh
dGljIGludCBtZXNfdjEwXzFfcmVzdW1lKHZvaWQgKmhhbmRsZSkNCj4gLXsNCj4gLSAgICAgICBp
bnQgcjsNCj4gLSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1k
Z3B1X2RldmljZSAqKWhhbmRsZTsNCj4gLQ0KPiAtICAgICAgIHIgPSBtZXNfdjEwXzFfaHdfaW5p
dChhZGV2KTsNCj4gLSAgICAgICBpZiAocikNCj4gLSAgICAgICAgICAgICAgIHJldHVybiByOw0K
PiAtDQo+IC0gICAgICAgcmV0dXJuIGFtZGdwdV9tZXNfcmVzdW1lKGFkZXYpOw0KPiAtfQ0KPiAt
DQo+IC1zdGF0aWMgaW50IG1lc192MTBfMF9lYXJseV9pbml0KHZvaWQgKmhhbmRsZSkNCj4gLXsN
Cj4gLSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqKWhhbmRsZTsNCj4gLSAgICAgICBpbnQgcGlwZSwgcjsNCj4gLQ0KPiAtICAgICAgIGZv
ciAocGlwZSA9IDA7IHBpcGUgPCBBTURHUFVfTUFYX01FU19QSVBFUzsgcGlwZSsrKSB7DQo+IC0g
ICAgICAgICAgICAgICBpZiAoIWFkZXYtPmVuYWJsZV9tZXNfa2lxICYmIHBpcGUgPT0gQU1ER1BV
X01FU19LSVFfUElQRSkNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQo+IC0g
ICAgICAgICAgICAgICByID0gYW1kZ3B1X21lc19pbml0X21pY3JvY29kZShhZGV2LCBwaXBlKTsN
Cj4gLSAgICAgICAgICAgICAgIGlmIChyKQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICByZXR1
cm4gcjsNCj4gLSAgICAgICB9DQo+IC0NCj4gLSAgICAgICByZXR1cm4gMDsNCj4gLX0NCj4gLQ0K
PiAtc3RhdGljIGludCBtZXNfdjEwXzBfbGF0ZV9pbml0KHZvaWQgKmhhbmRsZSkNCj4gLXsNCj4g
LSAgICAgICBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IChzdHJ1Y3QgYW1kZ3B1X2Rldmlj
ZSAqKWhhbmRsZTsNCj4gLQ0KPiAtICAgICAgIGlmICghYW1kZ3B1X2luX3Jlc2V0KGFkZXYpKQ0K
PiAtICAgICAgICAgICAgICAgYW1kZ3B1X21lc19zZWxmX3Rlc3QoYWRldik7DQo+IC0NCj4gLSAg
ICAgICByZXR1cm4gMDsNCj4gLX0NCj4gLQ0KPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBhbWRfaXBf
ZnVuY3MgbWVzX3YxMF8xX2lwX2Z1bmNzID0gew0KPiAtICAgICAgIC5uYW1lID0gIm1lc192MTBf
MSIsDQo+IC0gICAgICAgLmVhcmx5X2luaXQgPSBtZXNfdjEwXzBfZWFybHlfaW5pdCwNCj4gLSAg
ICAgICAubGF0ZV9pbml0ID0gbWVzX3YxMF8wX2xhdGVfaW5pdCwNCj4gLSAgICAgICAuc3dfaW5p
dCA9IG1lc192MTBfMV9zd19pbml0LA0KPiAtICAgICAgIC5zd19maW5pID0gbWVzX3YxMF8xX3N3
X2ZpbmksDQo+IC0gICAgICAgLmh3X2luaXQgPSBtZXNfdjEwXzFfaHdfaW5pdCwNCj4gLSAgICAg
ICAuaHdfZmluaSA9IG1lc192MTBfMV9od19maW5pLA0KPiAtICAgICAgIC5zdXNwZW5kID0gbWVz
X3YxMF8xX3N1c3BlbmQsDQo+IC0gICAgICAgLnJlc3VtZSA9IG1lc192MTBfMV9yZXN1bWUsDQo+
IC0gICAgICAgLmR1bXBfaXBfc3RhdGUgPSBOVUxMLA0KPiAtICAgICAgIC5wcmludF9pcF9zdGF0
ZSA9IE5VTEwsDQo+IC19Ow0KPiAtDQo+IC1jb25zdCBzdHJ1Y3QgYW1kZ3B1X2lwX2Jsb2NrX3Zl
cnNpb24gbWVzX3YxMF8xX2lwX2Jsb2NrID0gew0KPiAtICAgICAgIC50eXBlID0gQU1EX0lQX0JM
T0NLX1RZUEVfTUVTLA0KPiAtICAgICAgIC5tYWpvciA9IDEwLA0KPiAtICAgICAgIC5taW5vciA9
IDEsDQo+IC0gICAgICAgLnJldiA9IDAsDQo+IC0gICAgICAgLmZ1bmNzID0gJm1lc192MTBfMV9p
cF9mdW5jcywNCj4gLX07DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9tZXNfdjEwXzEuaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L21lc192MTBfMS5oDQo+
IGRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NA0KPiBpbmRleCA5YWZkNmRkYjAxZTljLi4wMDAwMDAw
MDAwMDAwDQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L21lc192MTBfMS5oDQo+
ICsrKyAvZGV2L251bGwNCj4gQEAgLTEsMjkgKzAsMCBAQA0KPiAtLyoNCj4gLSAqIENvcHlyaWdo
dCAyMDE5IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4NCj4gLSAqDQo+IC0gKiBQZXJtaXNz
aW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRh
aW5pbmcgYQ0KPiAtICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3Vt
ZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwNCj4gLSAqIHRvIGRlYWwgaW4gdGhlIFNv
ZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24N
Cj4gLSAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBk
aXN0cmlidXRlLCBzdWJsaWNlbnNlLA0KPiAtICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBT
b2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlDQo+IC0gKiBTb2Z0d2Fy
ZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRp
b25zOg0KPiAtICoNCj4gLSAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBl
cm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluDQo+IC0gKiBhbGwgY29waWVzIG9y
IHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4NCj4gLSAqDQo+IC0gKiBUSEUg
U09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lO
RCwgRVhQUkVTUyBPUg0KPiAtICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBU
TyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksDQo+IC0gKiBGSVRORVNTIEZPUiBB
IFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hB
TEwNCj4gLSAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9SIEFVVEhPUihTKSBCRSBMSUFCTEUg
Rk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUg0KPiAtICogT1RIRVIgTElBQklMSVRZLCBXSEVUSEVS
IElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsDQo+IC0gKiBBUklT
SU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRI
RSBVU0UgT1INCj4gLSAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4NCj4gLSAqDQo+
IC0gKi8NCj4gLQ0KPiAtI2lmbmRlZiBfX01FU19WMTBfMV9IX18NCj4gLSNkZWZpbmUgX19NRVNf
VjEwXzFfSF9fDQo+IC0NCj4gLWV4dGVybiBjb25zdCBzdHJ1Y3QgYW1kZ3B1X2lwX2Jsb2NrX3Zl
cnNpb24gbWVzX3YxMF8xX2lwX2Jsb2NrOw0KPiAtDQo+IC0jZW5kaWYNCj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L252LmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9udi5jDQo+IGluZGV4IDdlMzBhODlmZTAzZWYuLjQ5MzhlNmIzNDBlOWUgMTAwNjQ0DQo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L252LmMNCj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvbnYuYw0KPiBAQCAtNTksNyArNTksNiBAQA0KPiAgI2luY2x1ZGUg
InZjbl92M18wLmgiDQo+ICAjaW5jbHVkZSAianBlZ192M18wLmgiDQo+ICAjaW5jbHVkZSAiYW1k
Z3B1X3ZrbXMuaCINCj4gLSNpbmNsdWRlICJtZXNfdjEwXzEuaCINCj4gICNpbmNsdWRlICJteGdw
dV9udi5oIg0KPiAgI2luY2x1ZGUgInNtdWlvX3YxMV8wLmgiDQo+ICAjaW5jbHVkZSAic211aW9f
djExXzBfNi5oIg0KPiAtLQ0KPiAyLjQ1LjANCj4NCg==
