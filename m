Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 22A064EF9C
	for <lists+amd-gfx@lfdr.de>; Fri, 21 Jun 2019 21:48:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 06F826E91C;
	Fri, 21 Jun 2019 19:48:03 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM03-DM3-obe.outbound.protection.outlook.com
 (mail-eopbgr800085.outbound.protection.outlook.com [40.107.80.85])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 109C36E91C
 for <amd-gfx@lists.freedesktop.org>; Fri, 21 Jun 2019 19:48:01 +0000 (UTC)
Received: from DM6PR12MB3947.namprd12.prod.outlook.com (10.255.174.156) by
 DM6PR12MB3705.namprd12.prod.outlook.com (10.255.172.26) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2008.16; Fri, 21 Jun 2019 19:47:56 +0000
Received: from DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::5964:8c3c:1b5b:c480]) by DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::5964:8c3c:1b5b:c480%2]) with mapi id 15.20.2008.014; Fri, 21 Jun 2019
 19:47:56 +0000
From: "Kuehling, Felix" <Felix.Kuehling@amd.com>
To: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 1/1] drm/amdkfd: Add queue status indicator to HQD dump
Thread-Topic: [PATCH 1/1] drm/amdkfd: Add queue status indicator to HQD dump
Thread-Index: AQHVKGo4hraCzBsLlEmDeTvd8c+eVw==
Date: Fri, 21 Jun 2019 19:47:56 +0000
Message-ID: <20190621194740.20332-1-Felix.Kuehling@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [165.204.55.251]
x-mailer: git-send-email 2.17.1
x-clientproxiedby: YTXPR0101CA0061.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:1::38) To DM6PR12MB3947.namprd12.prod.outlook.com
 (2603:10b6:5:1cb::28)
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 34de1ff4-6c9e-4071-0168-08d6f6815b44
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);
 SRVR:DM6PR12MB3705; 
x-ms-traffictypediagnostic: DM6PR12MB3705:
x-microsoft-antispam-prvs: <DM6PR12MB3705EDE9B26A45D668A9DA2A92E70@DM6PR12MB3705.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:773;
x-forefront-prvs: 0075CB064E
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(376002)(136003)(39860400002)(396003)(346002)(366004)(199004)(189003)(25786009)(2351001)(316002)(2501003)(6506007)(68736007)(386003)(102836004)(2906002)(7736002)(4326008)(52116002)(305945005)(36756003)(26005)(8936002)(478600001)(53936002)(3846002)(6116002)(476003)(8676002)(2616005)(53946003)(71190400001)(71200400001)(66066001)(66556008)(73956011)(66446008)(66476007)(64756008)(186003)(30864003)(6916009)(6486002)(50226002)(81166006)(6512007)(14454004)(72206003)(66946007)(14444005)(256004)(5660300002)(99286004)(81156014)(86362001)(5640700003)(486006)(6436002)(1076003);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM6PR12MB3705;
 H:DM6PR12MB3947.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: 91cqZddTKcyf5hVdZmiZb9hnqb/sHMq0d0OoTab31CUYevdgGu8jN9o9IJELd8L/KL6GrGlG80PaTpRs+O1dTUkY6X8j2JJpGGhK/I8sMbPyJMNLxjJOk5WlVqVD9WhaQXx5lO7S4GUVTCnzNUq0sVkgTAZ/mF0QD6F7aq7127ezTaRj7MDIK9fhqK4qAZNZaMqTWoWoflxEbEVfWy1KI9LMtGL3TbOUiJ4l7076PyoNOtGsiOYuDPcnNNf4XWcwToh8NBl8xTz5msmCDn2aZ1v58fkqbl610FVQlH5LCjV0tZ2I14bocd3BrFxCGicewZWg5PY7+Z8QmGYrzdyvqPa7+7dzgyrfbOCvzIeIgoL0KT/EoBvjeIdwf5asvfLZytg9gRu+ZQc3ue/cijIOYU8yR/JmdMJSpjTRScx8dqc=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 34de1ff4-6c9e-4071-0168-08d6f6815b44
X-MS-Exchange-CrossTenant-originalarrivaltime: 21 Jun 2019 19:47:56.6238 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: fkuehlin@amd.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB3705
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=fyVexJEG8H1rGh4WOlmUh9c3SuKP9FbtlG0JFz4fp14=;
 b=jYoEyK41guJ5twGxT3laEbRNB/h4zYJHr4CzFlBExuh3h08LaiBcdOcn0JkLfxucG6W1k7wE1Mj84TH6wyR9vEsEg7IYFM9hCiUypiASAt9ma0M5tVKtg9FK9xZW0ZQQfjjFeueAM3hmgABh59ubKwE0yU6SVuGRnlbGMOXSprQ=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Felix.Kuehling@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Kuehling, Felix" <Felix.Kuehling@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

TWFrZSBpdCBlYXN5IHRvIGRpc3Rpbmd1aXNoIHVubWFwcGVkLCBpZGxlIGFuZCBidXN5IHF1ZXVl
cyBpbiB0aGUNCkhRRCBkdW1wLg0KDQpBbHNvIHJlbW92ZSBDVSBtYXNrIGZyb20gdGhlIEhRRCBk
dW1wIGJlY2F1c2UgdGhlc2UgcmVnaXN0ZXJzIGFyZQ0Kbm90IHBlci1xdWV1ZSwgYnV0IHBlciBw
aXBlLg0KDQpTaWduZWQtb2ZmLWJ5OiBGZWxpeCBLdWVobGluZyA8RmVsaXguS3VlaGxpbmdAYW1k
LmNvbT4NCi0tLQ0KIC4uLi9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2ZkX2dmeF92MTAuYyAg
ICB8IDM1ICsrKysrKysrKysrKysrLS0NCiAuLi4vZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9h
bWRrZmRfZ2Z4X3Y3LmMgfCAzOSArKysrKysrKysrKysrLS0tLS0NCiAuLi4vZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y4LmMgfCAzOSArKysrKysrKysrKysrLS0tLS0NCiAu
Li4vZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y5LmMgfCAzNSArKysrKysr
KysrKysrKy0tDQogLi4uL2RybS9hbWQvYW1ka2ZkL2tmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5j
IHwgNDAgKysrKysrKysrKystLS0tLS0tLQ0KIC4uLi9ncHUvZHJtL2FtZC9pbmNsdWRlL2tnZF9r
ZmRfaW50ZXJmYWNlLmggICB8IDE1ICsrKysrKy0NCiA2IGZpbGVzIGNoYW5nZWQsIDE1NyBpbnNl
cnRpb25zKCspLCA0NiBkZWxldGlvbnMoLSkNCg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3YxMC5jIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjEwLmMNCmluZGV4IDM5ZmZiMDc4YmViNC4uNDg4
MmI0MTEyYTdhIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2FtZGtmZF9nZnhfdjEwLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9hbWRrZmRfZ2Z4X3YxMC5jDQpAQCAtNjgsMTIgKzY4LDE0IEBAIHN0YXRpYyBpbnQga2dkX2hx
ZF9sb2FkKHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQgKm1xZCwgdWludDMyX3QgcGlwZV9pZCwN
CiAJCQlzdHJ1Y3QgbW1fc3RydWN0ICptbSk7DQogc3RhdGljIGludCBrZ2RfaHFkX2R1bXAoc3Ry
dWN0IGtnZF9kZXYgKmtnZCwNCiAJCQl1aW50MzJfdCBwaXBlX2lkLCB1aW50MzJfdCBxdWV1ZV9p
ZCwNCi0JCQl1aW50MzJfdCAoKipkdW1wKVsyXSwgdWludDMyX3QgKm5fcmVncyk7DQorCQkJdWlu
dDMyX3QgKCoqZHVtcClbMl0sIHVpbnQzMl90ICpuX3JlZ3MsDQorCQkJZW51bSBrZmRfcXVldWVf
c3RhdHVzICpzdGF0dXMpOw0KIHN0YXRpYyBpbnQga2dkX2hxZF9zZG1hX2xvYWQoc3RydWN0IGtn
ZF9kZXYgKmtnZCwgdm9pZCAqbXFkLA0KIAkJCSAgICAgdWludDMyX3QgX191c2VyICp3cHRyLCBz
dHJ1Y3QgbW1fc3RydWN0ICptbSk7DQogc3RhdGljIGludCBrZ2RfaHFkX3NkbWFfZHVtcChzdHJ1
Y3Qga2dkX2RldiAqa2dkLA0KIAkJCSAgICAgdWludDMyX3QgZW5naW5lX2lkLCB1aW50MzJfdCBx
dWV1ZV9pZCwNCi0JCQkgICAgIHVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJfdCAqbl9yZWdz
KTsNCisJCQkgICAgIHVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJfdCAqbl9yZWdzLA0KKwkJ
CSAgICAgZW51bSBrZmRfcXVldWVfc3RhdHVzICpzdGF0dXMpOw0KIHN0YXRpYyBib29sIGtnZF9o
cWRfaXNfb2NjdXBpZWQoc3RydWN0IGtnZF9kZXYgKmtnZCwgdWludDY0X3QgcXVldWVfYWRkcmVz
cywNCiAJCXVpbnQzMl90IHBpcGVfaWQsIHVpbnQzMl90IHF1ZXVlX2lkKTsNCiBzdGF0aWMgYm9v
bCBrZ2RfaHFkX3NkbWFfaXNfb2NjdXBpZWQoc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFk
KTsNCkBAIC00NTQsOSArNDU2LDE3IEBAIHN0YXRpYyBpbnQga2dkX2hxZF9sb2FkKHN0cnVjdCBr
Z2RfZGV2ICprZ2QsIHZvaWQgKm1xZCwgdWludDMyX3QgcGlwZV9pZCwNCiANCiBzdGF0aWMgaW50
IGtnZF9ocWRfZHVtcChzdHJ1Y3Qga2dkX2RldiAqa2dkLA0KIAkJCXVpbnQzMl90IHBpcGVfaWQs
IHVpbnQzMl90IHF1ZXVlX2lkLA0KLQkJCXVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJfdCAq
bl9yZWdzKQ0KKwkJCXVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJfdCAqbl9yZWdzLA0KKwkJ
CWVudW0ga2ZkX3F1ZXVlX3N0YXR1cyAqc3RhdHVzKQ0KIHsNCiAJc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYgPSBnZXRfYW1kZ3B1X2RldmljZShrZ2QpOw0KKwljb25zdCB1aW50MzJfdA0KKwkJ
aHFkX2FjdGl2ZSA9IChTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbUNQX0hRRF9BQ1RJVkUpIC0N
CisJCQkgICAgICBTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbUNQX01RRF9CQVNFX0FERFIpKSwN
CisJCWhxZF9wcV9ycHRyID0gKFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tQ1BfSFFEX1BRX1JQ
VFIpIC0NCisJCQkgICAgICAgU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9NUURfQkFTRV9B
RERSKSksDQorCQlocWRfcHFfd3B0ciA9IChTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbUNQX0hR
RF9QUV9XUFRSX0xPKSAtDQorCQkJICAgICAgIFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tQ1Bf
TVFEX0JBU0VfQUREUikpOw0KIAl1aW50MzJfdCBpID0gMCwgcmVnOw0KICNkZWZpbmUgSFFEX05f
UkVHUyA1Ng0KICNkZWZpbmUgRFVNUF9SRUcoYWRkcikgZG8gewkJCQlcDQpAQCAtNDgxLDYgKzQ5
MSwxMiBAQCBzdGF0aWMgaW50IGtnZF9ocWRfZHVtcChzdHJ1Y3Qga2dkX2RldiAqa2dkLA0KIAlX
QVJOX09OX09OQ0UoaSAhPSBIUURfTl9SRUdTKTsNCiAJKm5fcmVncyA9IGk7DQogDQorCWlmICgh
KCpkdW1wKVtocWRfYWN0aXZlXVsxXSkNCisJCSpzdGF0dXMgPSBLRkRfUVVFVUVfVU5NQVBQRUQ7
DQorCWVsc2UNCisJCSpzdGF0dXMgPSAoKmR1bXApW2hxZF9wcV9ycHRyXVsxXSA9PSAoKmR1bXAp
W2hxZF9wcV93cHRyXVsxXSA/DQorCQkJS0ZEX1FVRVVFX0lETEUgOiBLRkRfUVVFVUVfQlVTWTsN
CisNCiAJcmV0dXJuIDA7DQogfQ0KIA0KQEAgLTU2MSw5ICs1NzcsMTQgQEAgc3RhdGljIGludCBr
Z2RfaHFkX3NkbWFfbG9hZChzdHJ1Y3Qga2dkX2RldiAqa2dkLCB2b2lkICptcWQsDQogDQogc3Rh
dGljIGludCBrZ2RfaHFkX3NkbWFfZHVtcChzdHJ1Y3Qga2dkX2RldiAqa2dkLA0KIAkJCSAgICAg
dWludDMyX3QgZW5naW5lX2lkLCB1aW50MzJfdCBxdWV1ZV9pZCwNCi0JCQkgICAgIHVpbnQzMl90
ICgqKmR1bXApWzJdLCB1aW50MzJfdCAqbl9yZWdzKQ0KKwkJCSAgICAgdWludDMyX3QgKCoqZHVt
cClbMl0sIHVpbnQzMl90ICpuX3JlZ3MsDQorCQkJICAgICBlbnVtIGtmZF9xdWV1ZV9zdGF0dXMg
KnN0YXR1cykNCiB7DQogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gZ2V0X2FtZGdwdV9k
ZXZpY2Uoa2dkKTsNCisJY29uc3QgdWludDMyX3QNCisJCXJsY19kb29yYmVsbCA9IG1tU0RNQTBf
UkxDMF9ET09SQkVMTCAtIG1tU0RNQTBfUkxDMF9SQl9DTlRMLA0KKwkJcmxjX3JiX3JwdHIgPSBt
bVNETUEwX1JMQzBfUkJfUlBUUiAtIG1tU0RNQTBfUkxDMF9SQl9DTlRMLA0KKwkJcmxjX3JiX3dw
dHIgPSBtbVNETUEwX1JMQzBfUkJfV1BUUiAtIG1tU0RNQTBfUkxDMF9SQl9DTlRMOw0KIAl1aW50
MzJfdCBzZG1hX2Jhc2VfYWRkciA9IGdldF9zZG1hX2Jhc2VfYWRkcihhZGV2LCBlbmdpbmVfaWQs
IHF1ZXVlX2lkKTsNCiAJdWludDMyX3QgaSA9IDAsIHJlZzsNCiAjdW5kZWYgSFFEX05fUkVHUw0K
QEAgLTU5MCw2ICs2MTEsMTIgQEAgc3RhdGljIGludCBrZ2RfaHFkX3NkbWFfZHVtcChzdHJ1Y3Qg
a2dkX2RldiAqa2dkLA0KIAlXQVJOX09OX09OQ0UoaSAhPSBIUURfTl9SRUdTKTsNCiAJKm5fcmVn
cyA9IGk7DQogDQorCWlmICghKCpkdW1wKVtybGNfZG9vcmJlbGxdWzFdKQ0KKwkJKnN0YXR1cyA9
IEtGRF9RVUVVRV9VTk1BUFBFRDsNCisJZWxzZQ0KKwkJKnN0YXR1cyA9ICgqZHVtcClbcmxjX3Ji
X3JwdHJdWzFdID09ICgqZHVtcClbcmxjX3JiX3dwdHJdWzFdID8NCisJCQlLRkRfUVVFVUVfSURM
RSA6IEtGRF9RVUVVRV9CVVNZOw0KKw0KIAlyZXR1cm4gMDsNCiB9DQogDQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjcuYyBiL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y3LmMNCmluZGV4IGM2YWJj
ZjcyZTgyMi4uMTBiMGVjOGNhODUyIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjcuYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjcuYw0KQEAgLTEwNCwxMiArMTA0LDE0IEBAIHN0YXRp
YyBpbnQga2dkX2hxZF9sb2FkKHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQgKm1xZCwgdWludDMy
X3QgcGlwZV9pZCwNCiAJCQlzdHJ1Y3QgbW1fc3RydWN0ICptbSk7DQogc3RhdGljIGludCBrZ2Rf
aHFkX2R1bXAoc3RydWN0IGtnZF9kZXYgKmtnZCwNCiAJCQl1aW50MzJfdCBwaXBlX2lkLCB1aW50
MzJfdCBxdWV1ZV9pZCwNCi0JCQl1aW50MzJfdCAoKipkdW1wKVsyXSwgdWludDMyX3QgKm5fcmVn
cyk7DQorCQkJdWludDMyX3QgKCoqZHVtcClbMl0sIHVpbnQzMl90ICpuX3JlZ3MsDQorCQkJZW51
bSBrZmRfcXVldWVfc3RhdHVzICpzdGF0dXMpOw0KIHN0YXRpYyBpbnQga2dkX2hxZF9zZG1hX2xv
YWQoc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFkLA0KIAkJCSAgICAgdWludDMyX3QgX191
c2VyICp3cHRyLCBzdHJ1Y3QgbW1fc3RydWN0ICptbSk7DQogc3RhdGljIGludCBrZ2RfaHFkX3Nk
bWFfZHVtcChzdHJ1Y3Qga2dkX2RldiAqa2dkLA0KIAkJCSAgICAgdWludDMyX3QgZW5naW5lX2lk
LCB1aW50MzJfdCBxdWV1ZV9pZCwNCi0JCQkgICAgIHVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50
MzJfdCAqbl9yZWdzKTsNCisJCQkgICAgIHVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJfdCAq
bl9yZWdzLA0KKwkJCSAgICAgZW51bSBrZmRfcXVldWVfc3RhdHVzICpzdGF0dXMpOw0KIHN0YXRp
YyBib29sIGtnZF9ocWRfaXNfb2NjdXBpZWQoc3RydWN0IGtnZF9kZXYgKmtnZCwgdWludDY0X3Qg
cXVldWVfYWRkcmVzcywNCiAJCQkJdWludDMyX3QgcGlwZV9pZCwgdWludDMyX3QgcXVldWVfaWQp
Ow0KIA0KQEAgLTM3MywxMSArMzc1LDE2IEBAIHN0YXRpYyBpbnQga2dkX2hxZF9sb2FkKHN0cnVj
dCBrZ2RfZGV2ICprZ2QsIHZvaWQgKm1xZCwgdWludDMyX3QgcGlwZV9pZCwNCiANCiBzdGF0aWMg
aW50IGtnZF9ocWRfZHVtcChzdHJ1Y3Qga2dkX2RldiAqa2dkLA0KIAkJCXVpbnQzMl90IHBpcGVf
aWQsIHVpbnQzMl90IHF1ZXVlX2lkLA0KLQkJCXVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJf
dCAqbl9yZWdzKQ0KKwkJCXVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJfdCAqbl9yZWdzLA0K
KwkJCWVudW0ga2ZkX3F1ZXVlX3N0YXR1cyAqc3RhdHVzKQ0KIHsNCiAJc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYgPSBnZXRfYW1kZ3B1X2RldmljZShrZ2QpOw0KKwljb25zdCB1aW50MzJfdA0K
KwkJaHFkX2FjdGl2ZSA9IG1tQ1BfSFFEX0FDVElWRSAtIG1tQ1BfTVFEX0JBU0VfQUREUiwNCisJ
CWhxZF9wcV9ycHRyID0gbW1DUF9IUURfUFFfUlBUUiAtIG1tQ1BfTVFEX0JBU0VfQUREUiwNCisJ
CWhxZF9wcV93cHRyID0gbW1DUF9IUURfUFFfV1BUUiAtIG1tQ1BfTVFEX0JBU0VfQUREUjsNCiAJ
dWludDMyX3QgaSA9IDAsIHJlZzsNCi0jZGVmaW5lIEhRRF9OX1JFR1MgKDM1KzQpDQorI2RlZmlu
ZSBIUURfTl9SRUdTIDM1DQogI2RlZmluZSBEVU1QX1JFRyhhZGRyKSBkbyB7CQkJCVwNCiAJCWlm
IChXQVJOX09OX09OQ0UoaSA+PSBIUURfTl9SRUdTKSkJXA0KIAkJCWJyZWFrOwkJCQlcDQpAQCAt
MzkxLDExICszOTgsNiBAQCBzdGF0aWMgaW50IGtnZF9ocWRfZHVtcChzdHJ1Y3Qga2dkX2RldiAq
a2dkLA0KIA0KIAlhY3F1aXJlX3F1ZXVlKGtnZCwgcGlwZV9pZCwgcXVldWVfaWQpOw0KIA0KLQlE
VU1QX1JFRyhtbUNPTVBVVEVfU1RBVElDX1RIUkVBRF9NR01UX1NFMCk7DQotCURVTVBfUkVHKG1t
Q09NUFVURV9TVEFUSUNfVEhSRUFEX01HTVRfU0UxKTsNCi0JRFVNUF9SRUcobW1DT01QVVRFX1NU
QVRJQ19USFJFQURfTUdNVF9TRTIpOw0KLQlEVU1QX1JFRyhtbUNPTVBVVEVfU1RBVElDX1RIUkVB
RF9NR01UX1NFMyk7DQotDQogCWZvciAocmVnID0gbW1DUF9NUURfQkFTRV9BRERSOyByZWcgPD0g
bW1DUF9NUURfQ09OVFJPTDsgcmVnKyspDQogCQlEVU1QX1JFRyhyZWcpOw0KIA0KQEAgLTQwNCw2
ICs0MDYsMTIgQEAgc3RhdGljIGludCBrZ2RfaHFkX2R1bXAoc3RydWN0IGtnZF9kZXYgKmtnZCwN
CiAJV0FSTl9PTl9PTkNFKGkgIT0gSFFEX05fUkVHUyk7DQogCSpuX3JlZ3MgPSBpOw0KIA0KKwlp
ZiAoISgqZHVtcClbaHFkX2FjdGl2ZV1bMV0pDQorCQkqc3RhdHVzID0gS0ZEX1FVRVVFX1VOTUFQ
UEVEOw0KKwllbHNlDQorCQkqc3RhdHVzID0gKCpkdW1wKVtocWRfcHFfcnB0cl1bMV0gPT0gKCpk
dW1wKVtocWRfcHFfd3B0cl1bMV0gPw0KKwkJCUtGRF9RVUVVRV9JRExFIDogS0ZEX1FVRVVFX0JV
U1k7DQorDQogCXJldHVybiAwOw0KIH0NCiANCkBAIC00NzMsOSArNDgxLDE0IEBAIHN0YXRpYyBp
bnQga2dkX2hxZF9zZG1hX2xvYWQoc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFkLA0KIA0K
IHN0YXRpYyBpbnQga2dkX2hxZF9zZG1hX2R1bXAoc3RydWN0IGtnZF9kZXYgKmtnZCwNCiAJCQkg
ICAgIHVpbnQzMl90IGVuZ2luZV9pZCwgdWludDMyX3QgcXVldWVfaWQsDQotCQkJICAgICB1aW50
MzJfdCAoKipkdW1wKVsyXSwgdWludDMyX3QgKm5fcmVncykNCisJCQkgICAgIHVpbnQzMl90ICgq
KmR1bXApWzJdLCB1aW50MzJfdCAqbl9yZWdzLA0KKwkJCSAgICAgZW51bSBrZmRfcXVldWVfc3Rh
dHVzICpzdGF0dXMpDQogew0KIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGdldF9hbWRn
cHVfZGV2aWNlKGtnZCk7DQorCWNvbnN0IHVpbnQzMl90DQorCQlybGNfZG9vcmJlbGwgPSBtbVNE
TUEwX1JMQzBfRE9PUkJFTEwgLSBtbVNETUEwX1JMQzBfUkJfQ05UTCwNCisJCXJsY19yYl9ycHRy
ID0gbW1TRE1BMF9STEMwX1JCX1JQVFIgLSBtbVNETUEwX1JMQzBfUkJfQ05UTCwNCisJCXJsY19y
Yl93cHRyID0gbW1TRE1BMF9STEMwX1JCX1dQVFIgLSBtbVNETUEwX1JMQzBfUkJfQ05UTDsNCiAJ
dWludDMyX3Qgc2RtYV9vZmZzZXQgPSBlbmdpbmVfaWQgKiBTRE1BMV9SRUdJU1RFUl9PRkZTRVQg
Kw0KIAkJcXVldWVfaWQgKiBLRkRfQ0lLX1NETUFfUVVFVUVfT0ZGU0VUOw0KIAl1aW50MzJfdCBp
ID0gMCwgcmVnOw0KQEAgLTQ5NSw2ICs1MDgsMTIgQEAgc3RhdGljIGludCBrZ2RfaHFkX3NkbWFf
ZHVtcChzdHJ1Y3Qga2dkX2RldiAqa2dkLA0KIAlXQVJOX09OX09OQ0UoaSAhPSBIUURfTl9SRUdT
KTsNCiAJKm5fcmVncyA9IGk7DQogDQorCWlmICghKCpkdW1wKVtybGNfZG9vcmJlbGxdWzFdKQ0K
KwkJKnN0YXR1cyA9IEtGRF9RVUVVRV9VTk1BUFBFRDsNCisJZWxzZQ0KKwkJKnN0YXR1cyA9ICgq
ZHVtcClbcmxjX3JiX3JwdHJdWzFdID09ICgqZHVtcClbcmxjX3JiX3dwdHJdWzFdID8NCisJCQlL
RkRfUVVFVUVfSURMRSA6IEtGRF9RVUVVRV9CVVNZOw0KKw0KIAlyZXR1cm4gMDsNCiB9DQogDQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhf
djguYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ2Z4X3Y4LmMN
CmluZGV4IDRlOGI0ZTk0OTkyNi4uNWQ5NThiYTljNTI0IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjguYw0KKysrIGIvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjguYw0KQEAgLTYxLDEyICs2MSwx
NCBAQCBzdGF0aWMgaW50IGtnZF9ocWRfbG9hZChzdHJ1Y3Qga2dkX2RldiAqa2dkLCB2b2lkICpt
cWQsIHVpbnQzMl90IHBpcGVfaWQsDQogCQkJc3RydWN0IG1tX3N0cnVjdCAqbW0pOw0KIHN0YXRp
YyBpbnQga2dkX2hxZF9kdW1wKHN0cnVjdCBrZ2RfZGV2ICprZ2QsDQogCQkJdWludDMyX3QgcGlw
ZV9pZCwgdWludDMyX3QgcXVldWVfaWQsDQotCQkJdWludDMyX3QgKCoqZHVtcClbMl0sIHVpbnQz
Ml90ICpuX3JlZ3MpOw0KKwkJCXVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJfdCAqbl9yZWdz
LA0KKwkJCWVudW0ga2ZkX3F1ZXVlX3N0YXR1cyAqc3RhdHVzKTsNCiBzdGF0aWMgaW50IGtnZF9o
cWRfc2RtYV9sb2FkKHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQgKm1xZCwNCiAJCQkgICAgIHVp
bnQzMl90IF9fdXNlciAqd3B0ciwgc3RydWN0IG1tX3N0cnVjdCAqbW0pOw0KIHN0YXRpYyBpbnQg
a2dkX2hxZF9zZG1hX2R1bXAoc3RydWN0IGtnZF9kZXYgKmtnZCwNCiAJCQkgICAgIHVpbnQzMl90
IGVuZ2luZV9pZCwgdWludDMyX3QgcXVldWVfaWQsDQotCQkJICAgICB1aW50MzJfdCAoKipkdW1w
KVsyXSwgdWludDMyX3QgKm5fcmVncyk7DQorCQkJICAgICB1aW50MzJfdCAoKipkdW1wKVsyXSwg
dWludDMyX3QgKm5fcmVncywNCisJCQkgICAgIGVudW0ga2ZkX3F1ZXVlX3N0YXR1cyAqc3RhdHVz
KTsNCiBzdGF0aWMgYm9vbCBrZ2RfaHFkX2lzX29jY3VwaWVkKHN0cnVjdCBrZ2RfZGV2ICprZ2Qs
IHVpbnQ2NF90IHF1ZXVlX2FkZHJlc3MsDQogCQl1aW50MzJfdCBwaXBlX2lkLCB1aW50MzJfdCBx
dWV1ZV9pZCk7DQogc3RhdGljIGJvb2wga2dkX2hxZF9zZG1hX2lzX29jY3VwaWVkKHN0cnVjdCBr
Z2RfZGV2ICprZ2QsIHZvaWQgKm1xZCk7DQpAQCAtMzU4LDExICszNjAsMTYgQEAgc3RhdGljIGlu
dCBrZ2RfaHFkX2xvYWQoc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFkLCB1aW50MzJfdCBw
aXBlX2lkLA0KIA0KIHN0YXRpYyBpbnQga2dkX2hxZF9kdW1wKHN0cnVjdCBrZ2RfZGV2ICprZ2Qs
DQogCQkJdWludDMyX3QgcGlwZV9pZCwgdWludDMyX3QgcXVldWVfaWQsDQotCQkJdWludDMyX3Qg
KCoqZHVtcClbMl0sIHVpbnQzMl90ICpuX3JlZ3MpDQorCQkJdWludDMyX3QgKCoqZHVtcClbMl0s
IHVpbnQzMl90ICpuX3JlZ3MsDQorCQkJZW51bSBrZmRfcXVldWVfc3RhdHVzICpzdGF0dXMpDQog
ew0KIAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGdldF9hbWRncHVfZGV2aWNlKGtnZCk7
DQorCWNvbnN0IHVpbnQzMl90DQorCQlocWRfYWN0aXZlID0gbW1DUF9IUURfQUNUSVZFIC0gbW1D
UF9NUURfQkFTRV9BRERSLA0KKwkJaHFkX3BxX3JwdHIgPSBtbUNQX0hRRF9QUV9SUFRSIC0gbW1D
UF9NUURfQkFTRV9BRERSLA0KKwkJaHFkX3BxX3dwdHIgPSBtbUNQX0hRRF9QUV9XUFRSIC0gbW1D
UF9NUURfQkFTRV9BRERSOw0KIAl1aW50MzJfdCBpID0gMCwgcmVnOw0KLSNkZWZpbmUgSFFEX05f
UkVHUyAoNTQrNCkNCisjZGVmaW5lIEhRRF9OX1JFR1MgNTQNCiAjZGVmaW5lIERVTVBfUkVHKGFk
ZHIpIGRvIHsJCQkJXA0KIAkJaWYgKFdBUk5fT05fT05DRShpID49IEhRRF9OX1JFR1MpKQlcDQog
CQkJYnJlYWs7CQkJCVwNCkBAIC0zNzYsMTEgKzM4Myw2IEBAIHN0YXRpYyBpbnQga2dkX2hxZF9k
dW1wKHN0cnVjdCBrZ2RfZGV2ICprZ2QsDQogDQogCWFjcXVpcmVfcXVldWUoa2dkLCBwaXBlX2lk
LCBxdWV1ZV9pZCk7DQogDQotCURVTVBfUkVHKG1tQ09NUFVURV9TVEFUSUNfVEhSRUFEX01HTVRf
U0UwKTsNCi0JRFVNUF9SRUcobW1DT01QVVRFX1NUQVRJQ19USFJFQURfTUdNVF9TRTEpOw0KLQlE
VU1QX1JFRyhtbUNPTVBVVEVfU1RBVElDX1RIUkVBRF9NR01UX1NFMik7DQotCURVTVBfUkVHKG1t
Q09NUFVURV9TVEFUSUNfVEhSRUFEX01HTVRfU0UzKTsNCi0NCiAJZm9yIChyZWcgPSBtbUNQX01R
RF9CQVNFX0FERFI7IHJlZyA8PSBtbUNQX0hRRF9FT1BfRE9ORVM7IHJlZysrKQ0KIAkJRFVNUF9S
RUcocmVnKTsNCiANCkBAIC0zODksNiArMzkxLDEyIEBAIHN0YXRpYyBpbnQga2dkX2hxZF9kdW1w
KHN0cnVjdCBrZ2RfZGV2ICprZ2QsDQogCVdBUk5fT05fT05DRShpICE9IEhRRF9OX1JFR1MpOw0K
IAkqbl9yZWdzID0gaTsNCiANCisJaWYgKCEoKmR1bXApW2hxZF9hY3RpdmVdWzFdKQ0KKwkJKnN0
YXR1cyA9IEtGRF9RVUVVRV9VTk1BUFBFRDsNCisJZWxzZQ0KKwkJKnN0YXR1cyA9ICgqZHVtcClb
aHFkX3BxX3JwdHJdWzFdID09ICgqZHVtcClbaHFkX3BxX3dwdHJdWzFdID8NCisJCQlLRkRfUVVF
VUVfSURMRSA6IEtGRF9RVUVVRV9CVVNZOw0KKw0KIAlyZXR1cm4gMDsNCiB9DQogDQpAQCAtNDU3
LDkgKzQ2NSwxNCBAQCBzdGF0aWMgaW50IGtnZF9ocWRfc2RtYV9sb2FkKHN0cnVjdCBrZ2RfZGV2
ICprZ2QsIHZvaWQgKm1xZCwNCiANCiBzdGF0aWMgaW50IGtnZF9ocWRfc2RtYV9kdW1wKHN0cnVj
dCBrZ2RfZGV2ICprZ2QsDQogCQkJICAgICB1aW50MzJfdCBlbmdpbmVfaWQsIHVpbnQzMl90IHF1
ZXVlX2lkLA0KLQkJCSAgICAgdWludDMyX3QgKCoqZHVtcClbMl0sIHVpbnQzMl90ICpuX3JlZ3Mp
DQorCQkJICAgICB1aW50MzJfdCAoKipkdW1wKVsyXSwgdWludDMyX3QgKm5fcmVncywNCisJCQkg
ICAgIGVudW0ga2ZkX3F1ZXVlX3N0YXR1cyAqc3RhdHVzKQ0KIHsNCiAJc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYgPSBnZXRfYW1kZ3B1X2RldmljZShrZ2QpOw0KKwljb25zdCB1aW50MzJfdA0K
KwkJcmxjX2Rvb3JiZWxsID0gbW1TRE1BMF9STEMwX0RPT1JCRUxMIC0gbW1TRE1BMF9STEMwX1JC
X0NOVEwsDQorCQlybGNfcmJfcnB0ciA9IG1tU0RNQTBfUkxDMF9SQl9SUFRSIC0gbW1TRE1BMF9S
TEMwX1JCX0NOVEwsDQorCQlybGNfcmJfd3B0ciA9IG1tU0RNQTBfUkxDMF9SQl9XUFRSIC0gbW1T
RE1BMF9STEMwX1JCX0NOVEw7DQogCXVpbnQzMl90IHNkbWFfb2Zmc2V0ID0gZW5naW5lX2lkICog
U0RNQTFfUkVHSVNURVJfT0ZGU0VUICsNCiAJCXF1ZXVlX2lkICogS0ZEX1ZJX1NETUFfUVVFVUVf
T0ZGU0VUOw0KIAl1aW50MzJfdCBpID0gMCwgcmVnOw0KQEAgLTQ4OCw2ICs1MDEsMTIgQEAgc3Rh
dGljIGludCBrZ2RfaHFkX3NkbWFfZHVtcChzdHJ1Y3Qga2dkX2RldiAqa2dkLA0KIAlXQVJOX09O
X09OQ0UoaSAhPSBIUURfTl9SRUdTKTsNCiAJKm5fcmVncyA9IGk7DQogDQorCWlmICghKCpkdW1w
KVtybGNfZG9vcmJlbGxdWzFdKQ0KKwkJKnN0YXR1cyA9IEtGRF9RVUVVRV9VTk1BUFBFRDsNCisJ
ZWxzZQ0KKwkJKnN0YXR1cyA9ICgqZHVtcClbcmxjX3JiX3JwdHJdWzFdID09ICgqZHVtcClbcmxj
X3JiX3dwdHJdWzFdID8NCisJCQlLRkRfUVVFVUVfSURMRSA6IEtGRF9RVUVVRV9CVVNZOw0KKw0K
IAlyZXR1cm4gMDsNCiB9DQogDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2FtZGtmZF9nZnhfdjkuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9hbWRrZmRfZ2Z4X3Y5LmMNCmluZGV4IGQ1YWY0MTE0M2QxMi4uMmUxYTM3YzQ2OWM0IDEw
MDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhf
djkuYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9nZnhf
djkuYw0KQEAgLTc1LDEyICs3NSwxNCBAQCBzdGF0aWMgaW50IGtnZF9ocWRfbG9hZChzdHJ1Y3Qg
a2dkX2RldiAqa2dkLCB2b2lkICptcWQsIHVpbnQzMl90IHBpcGVfaWQsDQogCQkJc3RydWN0IG1t
X3N0cnVjdCAqbW0pOw0KIHN0YXRpYyBpbnQga2dkX2hxZF9kdW1wKHN0cnVjdCBrZ2RfZGV2ICpr
Z2QsDQogCQkJdWludDMyX3QgcGlwZV9pZCwgdWludDMyX3QgcXVldWVfaWQsDQotCQkJdWludDMy
X3QgKCoqZHVtcClbMl0sIHVpbnQzMl90ICpuX3JlZ3MpOw0KKwkJCXVpbnQzMl90ICgqKmR1bXAp
WzJdLCB1aW50MzJfdCAqbl9yZWdzLA0KKwkJCWVudW0ga2ZkX3F1ZXVlX3N0YXR1cyAqc3RhdHVz
KTsNCiBzdGF0aWMgaW50IGtnZF9ocWRfc2RtYV9sb2FkKHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZv
aWQgKm1xZCwNCiAJCQkgICAgIHVpbnQzMl90IF9fdXNlciAqd3B0ciwgc3RydWN0IG1tX3N0cnVj
dCAqbW0pOw0KIHN0YXRpYyBpbnQga2dkX2hxZF9zZG1hX2R1bXAoc3RydWN0IGtnZF9kZXYgKmtn
ZCwNCiAJCQkgICAgIHVpbnQzMl90IGVuZ2luZV9pZCwgdWludDMyX3QgcXVldWVfaWQsDQotCQkJ
ICAgICB1aW50MzJfdCAoKipkdW1wKVsyXSwgdWludDMyX3QgKm5fcmVncyk7DQorCQkJICAgICB1
aW50MzJfdCAoKipkdW1wKVsyXSwgdWludDMyX3QgKm5fcmVncywNCisJCQkgICAgIGVudW0ga2Zk
X3F1ZXVlX3N0YXR1cyAqc3RhdHVzKTsNCiBzdGF0aWMgYm9vbCBrZ2RfaHFkX2lzX29jY3VwaWVk
KHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHVpbnQ2NF90IHF1ZXVlX2FkZHJlc3MsDQogCQl1aW50MzJf
dCBwaXBlX2lkLCB1aW50MzJfdCBxdWV1ZV9pZCk7DQogc3RhdGljIGJvb2wga2dkX2hxZF9zZG1h
X2lzX29jY3VwaWVkKHN0cnVjdCBrZ2RfZGV2ICprZ2QsIHZvaWQgKm1xZCk7DQpAQCAtNDQwLDkg
KzQ0MiwxNyBAQCBzdGF0aWMgaW50IGtnZF9ocWRfbG9hZChzdHJ1Y3Qga2dkX2RldiAqa2dkLCB2
b2lkICptcWQsIHVpbnQzMl90IHBpcGVfaWQsDQogDQogc3RhdGljIGludCBrZ2RfaHFkX2R1bXAo
c3RydWN0IGtnZF9kZXYgKmtnZCwNCiAJCQl1aW50MzJfdCBwaXBlX2lkLCB1aW50MzJfdCBxdWV1
ZV9pZCwNCi0JCQl1aW50MzJfdCAoKipkdW1wKVsyXSwgdWludDMyX3QgKm5fcmVncykNCisJCQl1
aW50MzJfdCAoKipkdW1wKVsyXSwgdWludDMyX3QgKm5fcmVncywNCisJCQllbnVtIGtmZF9xdWV1
ZV9zdGF0dXMgKnN0YXR1cykNCiB7DQogCXN0cnVjdCBhbWRncHVfZGV2aWNlICphZGV2ID0gZ2V0
X2FtZGdwdV9kZXZpY2Uoa2dkKTsNCisJY29uc3QgdWludDMyX3QNCisJCWhxZF9hY3RpdmUgPSAo
U09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9IUURfQUNUSVZFKSAtDQorCQkJICAgICAgU09D
MTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9NUURfQkFTRV9BRERSKSksDQorCQlocWRfcHFfcnB0
ciA9IChTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbUNQX0hRRF9QUV9SUFRSKSAtDQorCQkJICAg
ICAgIFNPQzE1X1JFR19PRkZTRVQoR0MsIDAsIG1tQ1BfTVFEX0JBU0VfQUREUikpLA0KKwkJaHFk
X3BxX3dwdHIgPSAoU09DMTVfUkVHX09GRlNFVChHQywgMCwgbW1DUF9IUURfUFFfV1BUUl9MTykg
LQ0KKwkJCSAgICAgICBTT0MxNV9SRUdfT0ZGU0VUKEdDLCAwLCBtbUNQX01RRF9CQVNFX0FERFIp
KTsNCiAJdWludDMyX3QgaSA9IDAsIHJlZzsNCiAjZGVmaW5lIEhRRF9OX1JFR1MgNTYNCiAjZGVm
aW5lIERVTVBfUkVHKGFkZHIpIGRvIHsJCQkJXA0KQEAgLTQ2Nyw2ICs0NzcsMTIgQEAgc3RhdGlj
IGludCBrZ2RfaHFkX2R1bXAoc3RydWN0IGtnZF9kZXYgKmtnZCwNCiAJV0FSTl9PTl9PTkNFKGkg
IT0gSFFEX05fUkVHUyk7DQogCSpuX3JlZ3MgPSBpOw0KIA0KKwlpZiAoISgqZHVtcClbaHFkX2Fj
dGl2ZV1bMV0pDQorCQkqc3RhdHVzID0gS0ZEX1FVRVVFX1VOTUFQUEVEOw0KKwllbHNlDQorCQkq
c3RhdHVzID0gKCpkdW1wKVtocWRfcHFfcnB0cl1bMV0gPT0gKCpkdW1wKVtocWRfcHFfd3B0cl1b
MV0gPw0KKwkJCUtGRF9RVUVVRV9JRExFIDogS0ZEX1FVRVVFX0JVU1k7DQorDQogCXJldHVybiAw
Ow0KIH0NCiANCkBAIC01NDYsOSArNTYyLDE0IEBAIHN0YXRpYyBpbnQga2dkX2hxZF9zZG1hX2xv
YWQoc3RydWN0IGtnZF9kZXYgKmtnZCwgdm9pZCAqbXFkLA0KIA0KIHN0YXRpYyBpbnQga2dkX2hx
ZF9zZG1hX2R1bXAoc3RydWN0IGtnZF9kZXYgKmtnZCwNCiAJCQkgICAgIHVpbnQzMl90IGVuZ2lu
ZV9pZCwgdWludDMyX3QgcXVldWVfaWQsDQotCQkJICAgICB1aW50MzJfdCAoKipkdW1wKVsyXSwg
dWludDMyX3QgKm5fcmVncykNCisJCQkgICAgIHVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJf
dCAqbl9yZWdzLA0KKwkJCSAgICAgZW51bSBrZmRfcXVldWVfc3RhdHVzICpzdGF0dXMpDQogew0K
IAlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGdldF9hbWRncHVfZGV2aWNlKGtnZCk7DQor
CWNvbnN0IHVpbnQzMl90DQorCQlybGNfZG9vcmJlbGwgPSBtbVNETUEwX1JMQzBfRE9PUkJFTEwg
LSBtbVNETUEwX1JMQzBfUkJfQ05UTCwNCisJCXJsY19yYl9ycHRyID0gbW1TRE1BMF9STEMwX1JC
X1JQVFIgLSBtbVNETUEwX1JMQzBfUkJfQ05UTCwNCisJCXJsY19yYl93cHRyID0gbW1TRE1BMF9S
TEMwX1JCX1dQVFIgLSBtbVNETUEwX1JMQzBfUkJfQ05UTDsNCiAJdWludDMyX3Qgc2RtYV9iYXNl
X2FkZHIgPSBnZXRfc2RtYV9iYXNlX2FkZHIoYWRldiwgZW5naW5lX2lkLCBxdWV1ZV9pZCk7DQog
CXVpbnQzMl90IGkgPSAwLCByZWc7DQogI3VuZGVmIEhRRF9OX1JFR1MNCkBAIC01NzIsNiArNTkz
LDEyIEBAIHN0YXRpYyBpbnQga2dkX2hxZF9zZG1hX2R1bXAoc3RydWN0IGtnZF9kZXYgKmtnZCwN
CiAJV0FSTl9PTl9PTkNFKGkgIT0gSFFEX05fUkVHUyk7DQogCSpuX3JlZ3MgPSBpOw0KIA0KKwlp
ZiAoISgqZHVtcClbcmxjX2Rvb3JiZWxsXVsxXSkNCisJCSpzdGF0dXMgPSBLRkRfUVVFVUVfVU5N
QVBQRUQ7DQorCWVsc2UNCisJCSpzdGF0dXMgPSAoKmR1bXApW3JsY19yYl9ycHRyXVsxXSA9PSAo
KmR1bXApW3JsY19yYl93cHRyXVsxXSA/DQorCQkJS0ZEX1FVRVVFX0lETEUgOiBLRkRfUVVFVUVf
QlVTWTsNCisNCiAJcmV0dXJuIDA7DQogfQ0KIA0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9hbWQvYW1ka2ZkL2tmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5jIGIvZHJpdmVycy9ncHUvZHJt
L2FtZC9hbWRrZmQva2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmMNCmluZGV4IDlmZmRkYTU3ZTdm
MC4uMDdkM2I5NGMzMzE5IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRrZmQv
a2ZkX2RldmljZV9xdWV1ZV9tYW5hZ2VyLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
a2ZkL2tmZF9kZXZpY2VfcXVldWVfbWFuYWdlci5jDQpAQCAtMTg3NCwyMiArMTg3NCwyOCBAQCBz
dGF0aWMgdm9pZCBzZXFfcmVnX2R1bXAoc3RydWN0IHNlcV9maWxlICptLA0KIA0KIGludCBkcW1f
ZGVidWdmc19ocWRzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkNCiB7DQorCXN0YXRp
YyBjb25zdCBjaGFyICogY29uc3Qgc3RhdHVzX3N0cmluZ1tdID0gew0KKwkJW0tGRF9RVUVVRV9V
Tk1BUFBFRF0gPSAidW5tYXBwZWQiLA0KKwkJW0tGRF9RVUVVRV9JRExFXSA9ICJpZGxlIiwNCisJ
CVtLRkRfUVVFVUVfQlVTWV0gPSAiYnVzeSINCisJfTsNCiAJc3RydWN0IGRldmljZV9xdWV1ZV9t
YW5hZ2VyICpkcW0gPSBkYXRhOw0KIAl1aW50MzJfdCAoKmR1bXApWzJdLCBuX3JlZ3M7DQorCWVu
dW0ga2ZkX3F1ZXVlX3N0YXR1cyBzdGF0dXM7DQogCWludCBwaXBlLCBxdWV1ZTsNCiAJaW50IHIg
PSAwOw0KIA0KLSAgICAgICAgciA9IGRxbS0+ZGV2LT5rZmQya2dkLT5ocWRfZHVtcChkcW0tPmRl
di0+a2dkLA0KLSAgICAgICAgICAgICAgICBLRkRfQ0lLX0hJUV9QSVBFLCBLRkRfQ0lLX0hJUV9R
VUVVRSwgJmR1bXAsICZuX3JlZ3MpOw0KLSAgICAgICAgaWYgKCFyKSB7DQotICAgICAgICAgICAg
ICAgIHNlcV9wcmludGYobSwgIiAgSElRIG9uIE1FQyAlZCBQaXBlICVkIFF1ZXVlICVkXG4iLA0K
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgS0ZEX0NJS19ISVFfUElQRS9nZXRfcGlw
ZXNfcGVyX21lYyhkcW0pKzEsDQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBLRkRf
Q0lLX0hJUV9QSVBFJWdldF9waXBlc19wZXJfbWVjKGRxbSksDQotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBLRkRfQ0lLX0hJUV9RVUVVRSk7DQotICAgICAgICAgICAgICAgIHNlcV9y
ZWdfZHVtcChtLCBkdW1wLCBuX3JlZ3MpOw0KKwlyID0gZHFtLT5kZXYtPmtmZDJrZ2QtPmhxZF9k
dW1wKGRxbS0+ZGV2LT5rZ2QsDQorCQlLRkRfQ0lLX0hJUV9QSVBFLCBLRkRfQ0lLX0hJUV9RVUVV
RSwgJmR1bXAsICZuX3JlZ3MsICZzdGF0dXMpOw0KKwlpZiAoIXIpIHsNCisJCXNlcV9wcmludGYo
bSwgIiAgSElRIG9uIE1FQyAlZCBQaXBlICVkIFF1ZXVlICVkICglcylcbiIsDQorCQkJCUtGRF9D
SUtfSElRX1BJUEUvZ2V0X3BpcGVzX3Blcl9tZWMoZHFtKSsxLA0KKwkJCQlLRkRfQ0lLX0hJUV9Q
SVBFJWdldF9waXBlc19wZXJfbWVjKGRxbSksDQorCQkJCUtGRF9DSUtfSElRX1FVRVVFLCBzdGF0
dXNfc3RyaW5nW3N0YXR1c10pOw0KKwkJc2VxX3JlZ19kdW1wKG0sIGR1bXAsIG5fcmVncyk7DQog
DQotICAgICAgICAgICAgICAgIGtmcmVlKGR1bXApOw0KLSAgICAgICAgfQ0KKwkJa2ZyZWUoZHVt
cCk7DQorCX0NCiANCiAJZm9yIChwaXBlID0gMDsgcGlwZSA8IGdldF9waXBlc19wZXJfbWVjKGRx
bSk7IHBpcGUrKykgew0KIAkJaW50IHBpcGVfb2Zmc2V0ID0gcGlwZSAqIGdldF9xdWV1ZXNfcGVy
X3BpcGUoZHFtKTsNCkBAIC0xOTAwLDEyICsxOTA2LDEzIEBAIGludCBkcW1fZGVidWdmc19ocWRz
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkNCiAJCQkJY29udGludWU7DQogDQogCQkJ
ciA9IGRxbS0+ZGV2LT5rZmQya2dkLT5ocWRfZHVtcCgNCi0JCQkJZHFtLT5kZXYtPmtnZCwgcGlw
ZSwgcXVldWUsICZkdW1wLCAmbl9yZWdzKTsNCisJCQkJZHFtLT5kZXYtPmtnZCwgcGlwZSwgcXVl
dWUsICZkdW1wLCAmbl9yZWdzLA0KKwkJCQkmc3RhdHVzKTsNCiAJCQlpZiAocikNCiAJCQkJYnJl
YWs7DQogDQotCQkJc2VxX3ByaW50ZihtLCAiICBDUCBQaXBlICVkLCBRdWV1ZSAlZFxuIiwNCi0J
CQkJICBwaXBlLCBxdWV1ZSk7DQorCQkJc2VxX3ByaW50ZihtLCAiICBDUCBQaXBlICVkLCBRdWV1
ZSAlZCAoJXMpXG4iLA0KKwkJCQkgIHBpcGUsIHF1ZXVlLCBzdGF0dXNfc3RyaW5nW3N0YXR1c10p
Ow0KIAkJCXNlcV9yZWdfZHVtcChtLCBkdW1wLCBuX3JlZ3MpOw0KIA0KIAkJCWtmcmVlKGR1bXAp
Ow0KQEAgLTE5MTcsMTIgKzE5MjQsMTMgQEAgaW50IGRxbV9kZWJ1Z2ZzX2hxZHMoc3RydWN0IHNl
cV9maWxlICptLCB2b2lkICpkYXRhKQ0KIAkJICAgICBxdWV1ZSA8IGRxbS0+ZGV2LT5kZXZpY2Vf
aW5mby0+bnVtX3NkbWFfcXVldWVzX3Blcl9lbmdpbmU7DQogCQkgICAgIHF1ZXVlKyspIHsNCiAJ
CQlyID0gZHFtLT5kZXYtPmtmZDJrZ2QtPmhxZF9zZG1hX2R1bXAoDQotCQkJCWRxbS0+ZGV2LT5r
Z2QsIHBpcGUsIHF1ZXVlLCAmZHVtcCwgJm5fcmVncyk7DQorCQkJCWRxbS0+ZGV2LT5rZ2QsIHBp
cGUsIHF1ZXVlLCAmZHVtcCwgJm5fcmVncywNCisJCQkJJnN0YXR1cyk7DQogCQkJaWYgKHIpDQog
CQkJCWJyZWFrOw0KIA0KLQkJCXNlcV9wcmludGYobSwgIiAgU0RNQSBFbmdpbmUgJWQsIFJMQyAl
ZFxuIiwNCi0JCQkJICBwaXBlLCBxdWV1ZSk7DQorCQkJc2VxX3ByaW50ZihtLCAiICBTRE1BIEVu
Z2luZSAlZCwgUkxDICVkICglcylcbiIsDQorCQkJCSAgcGlwZSwgcXVldWUsIHN0YXR1c19zdHJp
bmdbc3RhdHVzXSk7DQogCQkJc2VxX3JlZ19kdW1wKG0sIGR1bXAsIG5fcmVncyk7DQogDQogCQkJ
a2ZyZWUoZHVtcCk7DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9pbmNsdWRlL2tn
ZF9rZmRfaW50ZXJmYWNlLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2luY2x1ZGUva2dkX2tmZF9p
bnRlcmZhY2UuaA0KaW5kZXggOThiOTUzM2U2NzJiLi5iYzRhY2EzNDljNGMgMTAwNjQ0DQotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2luY2x1ZGUva2dkX2tmZF9pbnRlcmZhY2UuaA0KKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2FtZC9pbmNsdWRlL2tnZF9rZmRfaW50ZXJmYWNlLmgNCkBAIC0xODcs
NiArMTg3LDE1IEBAIHN0cnVjdCB0aWxlX2NvbmZpZyB7DQogI2RlZmluZSBBTExPQ19NRU1fRkxB
R1NfQVFMX1FVRVVFX01FTQkoMSA8PCAyNykNCiAjZGVmaW5lIEFMTE9DX01FTV9GTEFHU19DT0hF
UkVOVAkoMSA8PCAyNikgLyogRm9yIEdGWHY5IG9yIGxhdGVyICovDQogDQorLyoNCisgKiBRdWV1
ZSBzdGF0dXMgZm9yIEhRRCBkdW1wDQorICovDQorZW51bSBrZmRfcXVldWVfc3RhdHVzIHsNCisJ
S0ZEX1FVRVVFX1VOTUFQUEVELCAvKiBRdWV1ZSBpcyBub3QgbWFwcGVkICovDQorCUtGRF9RVUVV
RV9JRExFLCAgICAgLyogUXVldWUgaXMgZW5hYmxlZCBidXQgY3VycmVudGx5IGlkbGUgKi8NCisJ
S0ZEX1FVRVVFX0JVU1kgICAgICAvKiBRdWV1ZSBpcyBlbmFibGVkIGFuZCBoYXMgd29yayBwZW5k
aW5nICovDQorfTsNCisNCiAvKioNCiAgKiBzdHJ1Y3Qga2ZkMmtnZF9jYWxscw0KICAqDQpAQCAt
MjYxLDExICsyNzAsMTMgQEAgc3RydWN0IGtmZDJrZ2RfY2FsbHMgew0KIA0KIAlpbnQgKCpocWRf
ZHVtcCkoc3RydWN0IGtnZF9kZXYgKmtnZCwNCiAJCQl1aW50MzJfdCBwaXBlX2lkLCB1aW50MzJf
dCBxdWV1ZV9pZCwNCi0JCQl1aW50MzJfdCAoKipkdW1wKVsyXSwgdWludDMyX3QgKm5fcmVncyk7
DQorCQkJdWludDMyX3QgKCoqZHVtcClbMl0sIHVpbnQzMl90ICpuX3JlZ3MsDQorCQkJZW51bSBr
ZmRfcXVldWVfc3RhdHVzICpzdGF0dXMpOw0KIA0KIAlpbnQgKCpocWRfc2RtYV9kdW1wKShzdHJ1
Y3Qga2dkX2RldiAqa2dkLA0KIAkJCSAgICAgdWludDMyX3QgZW5naW5lX2lkLCB1aW50MzJfdCBx
dWV1ZV9pZCwNCi0JCQkgICAgIHVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJfdCAqbl9yZWdz
KTsNCisJCQkgICAgIHVpbnQzMl90ICgqKmR1bXApWzJdLCB1aW50MzJfdCAqbl9yZWdzLA0KKwkJ
CSAgICAgZW51bSBrZmRfcXVldWVfc3RhdHVzICpzdGF0dXMpOw0KIA0KIAlib29sICgqaHFkX2lz
X29jY3VwaWVkKShzdHJ1Y3Qga2dkX2RldiAqa2dkLCB1aW50NjRfdCBxdWV1ZV9hZGRyZXNzLA0K
IAkJCQl1aW50MzJfdCBwaXBlX2lkLCB1aW50MzJfdCBxdWV1ZV9pZCk7DQotLSANCjIuMTcuMQ0K
DQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4
IG1haWxpbmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZng=
