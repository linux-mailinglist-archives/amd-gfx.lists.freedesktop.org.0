Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2C517FE350
	for <lists+amd-gfx@lfdr.de>; Fri, 15 Nov 2019 17:51:08 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 581726E996;
	Fri, 15 Nov 2019 16:51:06 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qk1-x743.google.com (mail-qk1-x743.google.com
 [IPv6:2607:f8b0:4864:20::743])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 174F36E958
 for <amd-gfx@lists.freedesktop.org>; Fri, 15 Nov 2019 16:51:01 +0000 (UTC)
Received: by mail-qk1-x743.google.com with SMTP id m125so8612153qkd.8
 for <amd-gfx@lists.freedesktop.org>; Fri, 15 Nov 2019 08:51:01 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=CDWn7KU/K4RcjXitYmHoOH9t0M50HF9fD6HpitNErzo=;
 b=SSDqWVWh/gaEF6sGGmyOnH/XY4u9b+2xsKoK0lYCMbjKKoB/EVtAV5pdKWAHZg/6d9
 3okwft+u29/2m4byw9REaPAy3wA0XTFAkVadfLrVvfgwv3bsR0O/tudeOO+qbtDobkHA
 siX4tE6bUtZ87cCgiSM/AzZAvIMywFBnD7MXAzCXi4oep5cFsqjLCArnNDBUydo3y0OC
 RSwPUwuN2j0PEYJsS4nHeryLlouKHIwgv5KvoNkQAEPCACusST3OY4F0SjRnbsim8D63
 VTV2IuTn7Y4zEP6jWu5HZGhW/8CyLBi6kdrvFAkdO1gGg06bMLhffWRLtiWkANDUedAG
 Vi/w==
X-Gm-Message-State: APjAAAUe6WkqtuKbmokW6oywpmJ2aRLIsR10K6tHUBNkqa17YkYL6kor
 QmDwEBwFU/l5sd5MNVrS0Er9OhCY
X-Google-Smtp-Source: APXvYqwyaIsQDs/wY+au+kCoQ6K4ddrmDvvP7tibzWSCMS7EZ9Vtp2LzBpNSe0Bi6s15SvmKHHuCQg==
X-Received: by 2002:a37:4bd7:: with SMTP id y206mr13640828qka.18.1573836659873; 
 Fri, 15 Nov 2019 08:50:59 -0800 (PST)
Received: from localhost.localdomain ([71.219.59.120])
 by smtp.gmail.com with ESMTPSA id r29sm5610331qtb.63.2019.11.15.08.50.59
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 15 Nov 2019 08:50:59 -0800 (PST)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org, alsa-devel@alsa-project.org, tiwai@suse.de,
 lukas@wunner.de
Subject: [PATCH 13/20] drm/amdgpu: start to disentangle boco from runtime pm
Date: Fri, 15 Nov 2019 11:50:31 -0500
Message-Id: <20191115165038.56646-14-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191115165038.56646-1-alexander.deucher@amd.com>
References: <20191115165038.56646-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=CDWn7KU/K4RcjXitYmHoOH9t0M50HF9fD6HpitNErzo=;
 b=CvfXnzBwzDl2u2i7TQOR0KpcvHMBQo34bskci8wta04UPOnoJj2kkGFEqklgKmZ1WA
 7S2aj4BZG2McshYWd6vTzZNKxjNFwHYRe/qR07Q4JNrWiBJOY54l2H0B7ImV4VsLZs6Q
 Hk3dG+gkaGEmRSAGtKEm6WBlcJPJ8H1+NFpHTEtZQj9dKvpT12ISglfJptTyCpbWORdf
 ig5CrYspiGf7RltJygSXXyVwcik//8dlJAlBGQaWeyW4C5PyJpxddW3BKGb7XGFd0EjY
 Fup3DHwtZYRg15VEEfM1KjGQPzI04DitX92cVOUnuSNHZAUjNbYwAh+jvjb7k4+Ew0uc
 hM/A==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>, Evan Quan <evan.quan@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

QkFDTyAtIEJ1cyBBY3RpdmUsIENoaXAgT2ZmCkJPQ08gLSBCdXMgT2ZmLCBDaGlwIE9mZgoKV2Ug
b3JpZ2luYWxseSBvbmx5IHN1cHBvcnRlZCBydW50aW1lIHBtIG9uIFBYL0hHCmxhcHRvcHMgc28g
bW9zdCBvZiB0aGUgcnVudGltZSBwbSBjb2RlIGxvb2tzIGZvciB0aGlzLgpBZGQgYSBuZXcgZmxh
ZyB0byBjaGVjayBmb3IgcnVudGltZSBwbSBlbmFibGVtZW50IGFuZAp1c2UgdGhpcyByYXRoZXIg
dGhhbiBjaGVja2luZyBmb3IgUFgvSEcuCgpSZXZpZXdlZC1ieTogRXZhbiBRdWFuIDxldmFuLnF1
YW5AYW1kLmNvbT4KU2lnbmVkLW9mZi1ieTogQWxleCBEZXVjaGVyIDxhbGV4YW5kZXIuZGV1Y2hl
ckBhbWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5oICAgICB8
ICAyICsrCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHJ2LmMgfCAgOSArKysr
KystLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYyB8IDEzICsrKysr
KysrLS0tLS0KIDMgZmlsZXMgY2hhbmdlZCwgMTYgaW5zZXJ0aW9ucygrKSwgOCBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdS5oCmluZGV4IDY0YmM1NzcxYjM0Zi4uOGY2
Yzk5NWZkMmVjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHUuaApAQCAtOTg4LDYgKzk4
OCw4IEBAIHN0cnVjdCBhbWRncHVfZGV2aWNlIHsKIAogCS8qIGRldmljZSBwc3RhdGUgKi8KIAlp
bnQJCQkJcHN0YXRlOworCS8qIGVuYWJsZSBydW50aW1lIHBtIG9uIHRoZSBkZXZpY2UgKi8KKwli
b29sICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bnBtOwogfTsKIAogc3RhdGljIGlubGlu
ZSBzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYW1kZ3B1X3R0bV9hZGV2KHN0cnVjdCB0dG1fYm9fZGV2
aWNlICpiZGV2KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1
X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rydi5jCmluZGV4IDdi
NTQzN2E4N2IwMS4uZWE3NjNiYzViMjMzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2Rydi5jCkBAIC0xMjEzLDkgKzEyMTMsMTAgQEAgc3RhdGljIGludCBhbWRncHVfcG1vcHNf
cnVudGltZV9zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3QgcGNpX2RldiAq
cGRldiA9IHRvX3BjaV9kZXYoZGV2KTsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZHJtX2RldiA9IHBj
aV9nZXRfZHJ2ZGF0YShwZGV2KTsKKwlzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiA9IGRybV9k
ZXYtPmRldl9wcml2YXRlOwogCWludCByZXQ7CiAKLQlpZiAoIWFtZGdwdV9kZXZpY2Vfc3VwcG9y
dHNfYm9jbyhkcm1fZGV2KSkgeworCWlmICghYWRldi0+cnVucG0pIHsKIAkJcG1fcnVudGltZV9m
b3JiaWQoZGV2KTsKIAkJcmV0dXJuIC1FQlVTWTsKIAl9CkBAIC0xMjQ1LDkgKzEyNDYsMTAgQEAg
c3RhdGljIGludCBhbWRncHVfcG1vcHNfcnVudGltZV9yZXN1bWUoc3RydWN0IGRldmljZSAqZGV2
KQogewogCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gdG9fcGNpX2RldihkZXYpOwogCXN0cnVjdCBk
cm1fZGV2aWNlICpkcm1fZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBkZXYpOworCXN0cnVjdCBhbWRn
cHVfZGV2aWNlICphZGV2ID0gZHJtX2Rldi0+ZGV2X3ByaXZhdGU7CiAJaW50IHJldDsKIAotCWlm
ICghYW1kZ3B1X2RldmljZV9zdXBwb3J0c19ib2NvKGRybV9kZXYpKQorCWlmICghYWRldi0+cnVu
cG0pCiAJCXJldHVybiAtRUlOVkFMOwogCiAJaWYgKGFtZGdwdV9kZXZpY2Vfc3VwcG9ydHNfYm9j
byhkcm1fZGV2KSkgewpAQCAtMTI3NCw5ICsxMjc2LDEwIEBAIHN0YXRpYyBpbnQgYW1kZ3B1X3Bt
b3BzX3J1bnRpbWVfcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikKIHN0YXRpYyBpbnQgYW1kZ3B1
X3Btb3BzX3J1bnRpbWVfaWRsZShzdHJ1Y3QgZGV2aWNlICpkZXYpCiB7CiAJc3RydWN0IGRybV9k
ZXZpY2UgKmRybV9kZXYgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwlzdHJ1Y3QgYW1kZ3B1X2Rl
dmljZSAqYWRldiA9IGRybV9kZXYtPmRldl9wcml2YXRlOwogCXN0cnVjdCBkcm1fY3J0YyAqY3J0
YzsKIAotCWlmICghYW1kZ3B1X2RldmljZV9zdXBwb3J0c19ib2NvKGRybV9kZXYpKSB7CisJaWYg
KCFhZGV2LT5ydW5wbSkgewogCQlwbV9ydW50aW1lX2ZvcmJpZChkZXYpOwogCQlyZXR1cm4gLUVC
VVNZOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9r
bXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9rbXMuYwppbmRleCA0MDkz
YWY2ZTU3NWEuLjg5YjAyMWM1NGI5MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2ttcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdw
dV9rbXMuYwpAQCAtOTEsNyArOTEsNyBAQCB2b2lkIGFtZGdwdV9kcml2ZXJfdW5sb2FkX2ttcyhz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogCWlmIChhbWRncHVfc3Jpb3ZfdmYoYWRldikpCiAJCWFt
ZGdwdV92aXJ0X3JlcXVlc3RfZnVsbF9ncHUoYWRldiwgZmFsc2UpOwogCi0JaWYgKGFtZGdwdV9k
ZXZpY2Vfc3VwcG9ydHNfYm9jbyhkZXYpKSB7CisJaWYgKGFkZXYtPnJ1bnBtKSB7CiAJCXBtX3J1
bnRpbWVfZ2V0X3N5bmMoZGV2LT5kZXYpOwogCQlwbV9ydW50aW1lX2ZvcmJpZChkZXYtPmRldik7
CiAJfQpAQCAtMTUwLDE0ICsxNTAsMTcgQEAgaW50IGFtZGdwdV9kcml2ZXJfbG9hZF9rbXMoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgbG9uZyBmbGFncykKIAl9CiAJZGV2LT5kZXZf
cHJpdmF0ZSA9ICh2b2lkICopYWRldjsKIAotCWlmICgoYW1kZ3B1X3J1bnRpbWVfcG0gIT0gMCkg
JiYKLQkgICAgYW1kZ3B1X2hhc19hdHB4KCkgJiYKKwlpZiAoYW1kZ3B1X2hhc19hdHB4KCkgJiYK
IAkgICAgKGFtZGdwdV9pc19hdHB4X2h5YnJpZCgpIHx8CiAJICAgICBhbWRncHVfaGFzX2F0cHhf
ZGdwdV9wb3dlcl9jbnRsKCkpICYmCiAJICAgICgoZmxhZ3MgJiBBTURfSVNfQVBVKSA9PSAwKSAm
JgogCSAgICAhcGNpX2lzX3RodW5kZXJib2x0X2F0dGFjaGVkKGRldi0+cGRldikpCiAJCWZsYWdz
IHw9IEFNRF9JU19QWDsKIAorCWlmICgoYW1kZ3B1X3J1bnRpbWVfcG0gIT0gMCkgJiYKKwkgICAg
KGZsYWdzICYgQU1EX0lTX1BYKSkKKwkJYWRldi0+cnVucG0gPSB0cnVlOworCiAJLyogYW1kZ3B1
X2RldmljZV9pbml0IHNob3VsZCByZXBvcnQgb25seSBmYXRhbCBlcnJvcgogCSAqIGxpa2UgbWVt
b3J5IGFsbG9jYXRpb24gZmFpbHVyZSBvciBpb21hcHBpbmcgZmFpbHVyZSwKIAkgKiBvciBtZW1v
cnkgbWFuYWdlciBpbml0aWFsaXphdGlvbiBmYWlsdXJlLCBpdCBtdXN0CkBAIC0xODAsNyArMTgz
LDcgQEAgaW50IGFtZGdwdV9kcml2ZXJfbG9hZF9rbXMoc3RydWN0IGRybV9kZXZpY2UgKmRldiwg
dW5zaWduZWQgbG9uZyBmbGFncykKIAkJCQkiRXJyb3IgZHVyaW5nIEFDUEkgbWV0aG9kcyBjYWxs
XG4iKTsKIAl9CiAKLQlpZiAoYW1kZ3B1X2RldmljZV9zdXBwb3J0c19ib2NvKGRldikpIHsKKwlp
ZiAoYWRldi0+cnVucG0pIHsKIAkJZGV2X3BtX3NldF9kcml2ZXJfZmxhZ3MoZGV2LT5kZXYsIERQ
TV9GTEFHX05FVkVSX1NLSVApOwogCQlwbV9ydW50aW1lX3VzZV9hdXRvc3VzcGVuZChkZXYtPmRl
dik7CiAJCXBtX3J1bnRpbWVfc2V0X2F1dG9zdXNwZW5kX2RlbGF5KGRldi0+ZGV2LCA1MDAwKTsK
QEAgLTE5Myw3ICsxOTYsNyBAQCBpbnQgYW1kZ3B1X2RyaXZlcl9sb2FkX2ttcyhzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIGZsYWdzKQogb3V0OgogCWlmIChyKSB7CiAJCS8q
IGJhbGFuY2UgcG1fcnVudGltZV9nZXRfc3luYyBpbiBhbWRncHVfZHJpdmVyX3VubG9hZF9rbXMg
Ki8KLQkJaWYgKGFkZXYtPnJtbWlvICYmIGFtZGdwdV9kZXZpY2Vfc3VwcG9ydHNfYm9jbyhkZXYp
KQorCQlpZiAoYWRldi0+cm1taW8gJiYgYWRldi0+cnVucG0pCiAJCQlwbV9ydW50aW1lX3B1dF9u
b2lkbGUoZGV2LT5kZXYpOwogCQlhbWRncHVfZHJpdmVyX3VubG9hZF9rbXMoZGV2KTsKIAl9Ci0t
IAoyLjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
CmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
