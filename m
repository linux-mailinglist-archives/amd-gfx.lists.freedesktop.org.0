Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4898C790AB
	for <lists+amd-gfx@lfdr.de>; Mon, 29 Jul 2019 18:20:19 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C3D71899D6;
	Mon, 29 Jul 2019 16:20:17 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from netline-mail3.netline.ch (mail.netline.ch [148.251.143.178])
 by gabe.freedesktop.org (Postfix) with ESMTP id 7CA58899D6
 for <amd-gfx@lists.freedesktop.org>; Mon, 29 Jul 2019 16:20:16 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by netline-mail3.netline.ch (Postfix) with ESMTP id ADD802A6046
 for <amd-gfx@lists.freedesktop.org>; Mon, 29 Jul 2019 18:20:15 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at netline-mail3.netline.ch
Received: from netline-mail3.netline.ch ([127.0.0.1])
 by localhost (netline-mail3.netline.ch [127.0.0.1]) (amavisd-new, port 10024)
 with LMTP id oM2RH8ILTB_M for <amd-gfx@lists.freedesktop.org>;
 Mon, 29 Jul 2019 18:20:15 +0200 (CEST)
Received: from kaveri (116.245.63.188.dynamic.wline.res.cust.swisscom.ch
 [188.63.245.116])
 by netline-mail3.netline.ch (Postfix) with ESMTPSA id 1FE2C2A6042
 for <amd-gfx@lists.freedesktop.org>; Mon, 29 Jul 2019 18:20:15 +0200 (CEST)
Received: from daenzer by kaveri with local (Exim 4.92)
 (envelope-from <michel@daenzer.net>) id 1hs8Ni-0002Tb-NI
 for amd-gfx@lists.freedesktop.org; Mon, 29 Jul 2019 18:20:14 +0200
From: =?UTF-8?q?Michel=20D=C3=A4nzer?= <michel@daenzer.net>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH] drm/amdgpu: Update pitch on page flips without DC as well
Date: Mon, 29 Jul 2019 18:20:14 +0200
Message-Id: <20190729162014.9476-1-michel@daenzer.net>
X-Mailer: git-send-email 2.22.0
MIME-Version: 1.0
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogTWljaGVsIETDpG56ZXIgPG1pY2hlbC5kYWVuemVyQGFtZC5jb20+CgpEQyBhbHJlYWR5
IGhhbmRsZXMgdGhpcyBjb3JyZWN0bHkgc2luY2UgYW1kZ3B1IG1pbm9yIHZlcnNpb24gMzEuIEJ1
bXAKdGhlIG1pbm9yIHZlcnNpb24gYWdhaW4gc28gdGhhdCB4Zjg2LXZpZGVvLWFtZGdwdSBjYW4g
dGFrZSBhZHZhbnRhZ2Ugb2YKdGhpcyB3b3JraW5nIHdpdGhvdXQgREMgYXMgd2VsbCBub3cuCgpT
aWduZWQtb2ZmLWJ5OiBNaWNoZWwgRMOkbnplciA8bWljaGVsLmRhZW56ZXJAYW1kLmNvbT4KLS0t
CgpTZWUgaHR0cHM6Ly9naXRsYWIuZnJlZWRlc2t0b3Aub3JnL3hvcmcvZHJpdmVyL3hmODYtdmlk
ZW8tYW1kZ3B1L21lcmdlX3JlcXVlc3RzLzM5CmZvciB0aGUgY29ycmVzcG9uZGluZyB4Zjg2LXZp
ZGVvLWFtZGdwdSBjaGFuZ2UuCgogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Ry
di5jIHwgMyArKy0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2RjZV92MTBfMC5jICB8IDQg
KysrKwogZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZGNlX3YxMV8wLmMgIHwgNCArKysrCiBk
cml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9kY2VfdjZfMC5jICAgfCA0ICsrKysKIGRyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2RjZV92OF8wLmMgICB8IDQgKysrKwogNSBmaWxlcyBjaGFuZ2Vk
LCAxOCBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvYW1kZ3B1X2Rydi5jCmluZGV4IDgwMGQwY2ViMTRiNC4uY2YzMzRjNDY1ODA1IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfZHJ2LmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2Rydi5jCkBAIC03Nyw5ICs3NywxMCBAQAogICog
LSAzLjMxLjAgLSBBZGQgc3VwcG9ydCBmb3IgcGVyLWZsaXAgdGlsaW5nIGF0dHJpYnV0ZSBjaGFu
Z2VzIHdpdGggREMKICAqIC0gMy4zMi4wIC0gQWRkIHN5bmNvYmogdGltZWxpbmUgc3VwcG9ydCB0
byBBTURHUFVfQ1MuCiAgKiAtIDMuMzMuMCAtIEZpeGVzIGZvciBHRFMgRU5PTUVNIGZhaWx1cmVz
IGluIEFNREdQVV9DUy4KKyAqIC0gMy4zNC4wIC0gTm9uLURDIGNhbiBmbGlwIGNvcnJlY3RseSBi
ZXR3ZWVuIGJ1ZmZlcnMgd2l0aCBkaWZmZXJlbnQgcGl0Y2hlcwogICovCiAjZGVmaW5lIEtNU19E
UklWRVJfTUFKT1IJMwotI2RlZmluZSBLTVNfRFJJVkVSX01JTk9SCTMzCisjZGVmaW5lIEtNU19E
UklWRVJfTUlOT1IJMzQKICNkZWZpbmUgS01TX0RSSVZFUl9QQVRDSExFVkVMCTAKIAogI2RlZmlu
ZSBBTURHUFVfTUFYX1RJTUVPVVRfUEFSQU1fTEVOVEgJMjU2CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9kY2VfdjEwXzAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2RjZV92MTBfMC5jCmluZGV4IDFmMDQyNmQyZmMyYS4uYzYwOWI3YWYwYjZiIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9kY2VfdjEwXzAuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9kY2VfdjEwXzAuYwpAQCAtMjMzLDYgKzIzMyw3IEBAIHN0YXRp
YyB2b2lkIGRjZV92MTBfMF9wYWdlX2ZsaXAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJ
CQkJaW50IGNydGNfaWQsIHU2NCBjcnRjX2Jhc2UsIGJvb2wgYXN5bmMpCiB7CiAJc3RydWN0IGFt
ZGdwdV9jcnRjICphbWRncHVfY3J0YyA9IGFkZXYtPm1vZGVfaW5mby5jcnRjc1tjcnRjX2lkXTsK
KwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IGFtZGdwdV9jcnRjLT5iYXNlLnByaW1hcnkt
PmZiOwogCXUzMiB0bXA7CiAKIAkvKiBmbGlwIGF0IGhzeW5jIGZvciBhc3luYywgZGVmYXVsdCBp
cyB2c3luYyAqLwpAQCAtMjQwLDYgKzI0MSw5IEBAIHN0YXRpYyB2b2lkIGRjZV92MTBfMF9wYWdl
X2ZsaXAoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJdG1wID0gUkVHX1NFVF9GSUVMRCh0
bXAsIEdSUEhfRkxJUF9DT05UUk9MLAogCQkJICAgIEdSUEhfU1VSRkFDRV9VUERBVEVfSF9SRVRS
QUNFX0VOLCBhc3luYyA/IDEgOiAwKTsKIAlXUkVHMzIobW1HUlBIX0ZMSVBfQ09OVFJPTCArIGFt
ZGdwdV9jcnRjLT5jcnRjX29mZnNldCwgdG1wKTsKKwkvKiB1cGRhdGUgcGl0Y2ggKi8KKwlXUkVH
MzIobW1HUlBIX1BJVENIICsgYW1kZ3B1X2NydGMtPmNydGNfb2Zmc2V0LAorCSAgICAgICBmYi0+
cGl0Y2hlc1swXSAvIGZiLT5mb3JtYXQtPmNwcFswXSk7CiAJLyogdXBkYXRlIHRoZSBwcmltYXJ5
IHNjYW5vdXQgYWRkcmVzcyAqLwogCVdSRUczMihtbUdSUEhfUFJJTUFSWV9TVVJGQUNFX0FERFJF
U1NfSElHSCArIGFtZGdwdV9jcnRjLT5jcnRjX29mZnNldCwKIAkgICAgICAgdXBwZXJfMzJfYml0
cyhjcnRjX2Jhc2UpKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Rj
ZV92MTFfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZGNlX3YxMV8wLmMKaW5kZXgg
MjI4MGI5NzFkNzU4Li43MTlkYjA1OGIzMDYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2RjZV92MTFfMC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Rj
ZV92MTFfMC5jCkBAIC0yNTEsNiArMjUxLDcgQEAgc3RhdGljIHZvaWQgZGNlX3YxMV8wX3BhZ2Vf
ZmxpcChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCQlpbnQgY3J0Y19pZCwgdTY0IGNy
dGNfYmFzZSwgYm9vbCBhc3luYykKIHsKIAlzdHJ1Y3QgYW1kZ3B1X2NydGMgKmFtZGdwdV9jcnRj
ID0gYWRldi0+bW9kZV9pbmZvLmNydGNzW2NydGNfaWRdOworCXN0cnVjdCBkcm1fZnJhbWVidWZm
ZXIgKmZiID0gYW1kZ3B1X2NydGMtPmJhc2UucHJpbWFyeS0+ZmI7CiAJdTMyIHRtcDsKIAogCS8q
IGZsaXAgaW1tZWRpYXRlIGZvciBhc3luYywgZGVmYXVsdCBpcyB2c3luYyAqLwpAQCAtMjU4LDYg
KzI1OSw5IEBAIHN0YXRpYyB2b2lkIGRjZV92MTFfMF9wYWdlX2ZsaXAoc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYsCiAJdG1wID0gUkVHX1NFVF9GSUVMRCh0bXAsIEdSUEhfRkxJUF9DT05UUk9M
LAogCQkJICAgIEdSUEhfU1VSRkFDRV9VUERBVEVfSU1NRURJQVRFX0VOLCBhc3luYyA/IDEgOiAw
KTsKIAlXUkVHMzIobW1HUlBIX0ZMSVBfQ09OVFJPTCArIGFtZGdwdV9jcnRjLT5jcnRjX29mZnNl
dCwgdG1wKTsKKwkvKiB1cGRhdGUgcGl0Y2ggKi8KKwlXUkVHMzIobW1HUlBIX1BJVENIICsgYW1k
Z3B1X2NydGMtPmNydGNfb2Zmc2V0LAorCSAgICAgICBmYi0+cGl0Y2hlc1swXSAvIGZiLT5mb3Jt
YXQtPmNwcFswXSk7CiAJLyogdXBkYXRlIHRoZSBzY2Fub3V0IGFkZHJlc3NlcyAqLwogCVdSRUcz
MihtbUdSUEhfUFJJTUFSWV9TVVJGQUNFX0FERFJFU1NfSElHSCArIGFtZGdwdV9jcnRjLT5jcnRj
X29mZnNldCwKIAkgICAgICAgdXBwZXJfMzJfYml0cyhjcnRjX2Jhc2UpKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2RjZV92Nl8wLmMgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2FtZGdwdS9kY2VfdjZfMC5jCmluZGV4IGJlYTMyZjA3NmI5MS4uOGVlOTk2NTFkMDFhIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9kY2VfdjZfMC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2RjZV92Nl8wLmMKQEAgLTE4NiwxMCArMTg2LDE0IEBA
IHN0YXRpYyB2b2lkIGRjZV92Nl8wX3BhZ2VfZmxpcChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwKIAkJCSAgICAgICBpbnQgY3J0Y19pZCwgdTY0IGNydGNfYmFzZSwgYm9vbCBhc3luYykKIHsK
IAlzdHJ1Y3QgYW1kZ3B1X2NydGMgKmFtZGdwdV9jcnRjID0gYWRldi0+bW9kZV9pbmZvLmNydGNz
W2NydGNfaWRdOworCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gYW1kZ3B1X2NydGMtPmJh
c2UucHJpbWFyeS0+ZmI7CiAKIAkvKiBmbGlwIGF0IGhzeW5jIGZvciBhc3luYywgZGVmYXVsdCBp
cyB2c3luYyAqLwogCVdSRUczMihtbUdSUEhfRkxJUF9DT05UUk9MICsgYW1kZ3B1X2NydGMtPmNy
dGNfb2Zmc2V0LCBhc3luYyA/CiAJICAgICAgIEdSUEhfRkxJUF9DT05UUk9MX19HUlBIX1NVUkZB
Q0VfVVBEQVRFX0hfUkVUUkFDRV9FTl9NQVNLIDogMCk7CisJLyogdXBkYXRlIHBpdGNoICovCisJ
V1JFRzMyKG1tR1JQSF9QSVRDSCArIGFtZGdwdV9jcnRjLT5jcnRjX29mZnNldCwKKwkgICAgICAg
ZmItPnBpdGNoZXNbMF0gLyBmYi0+Zm9ybWF0LT5jcHBbMF0pOwogCS8qIHVwZGF0ZSB0aGUgc2Nh
bm91dCBhZGRyZXNzZXMgKi8KIAlXUkVHMzIobW1HUlBIX1BSSU1BUllfU1VSRkFDRV9BRERSRVNT
X0hJR0ggKyBhbWRncHVfY3J0Yy0+Y3J0Y19vZmZzZXQsCiAJICAgICAgIHVwcGVyXzMyX2JpdHMo
Y3J0Y19iYXNlKSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9kY2Vf
djhfMC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZGNlX3Y4XzAuYwppbmRleCAxM2Rh
OTE1OTkxZGQuLjcwMzdlMDE2NDkzYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvZGNlX3Y4XzAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9kY2Vfdjhf
MC5jCkBAIC0xODEsMTAgKzE4MSwxNCBAQCBzdGF0aWMgdm9pZCBkY2VfdjhfMF9wYWdlX2ZsaXAo
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJCQkgICAgICAgaW50IGNydGNfaWQsIHU2NCBj
cnRjX2Jhc2UsIGJvb2wgYXN5bmMpCiB7CiAJc3RydWN0IGFtZGdwdV9jcnRjICphbWRncHVfY3J0
YyA9IGFkZXYtPm1vZGVfaW5mby5jcnRjc1tjcnRjX2lkXTsKKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpmYiA9IGFtZGdwdV9jcnRjLT5iYXNlLnByaW1hcnktPmZiOwogCiAJLyogZmxpcCBhdCBo
c3luYyBmb3IgYXN5bmMsIGRlZmF1bHQgaXMgdnN5bmMgKi8KIAlXUkVHMzIobW1HUlBIX0ZMSVBf
Q09OVFJPTCArIGFtZGdwdV9jcnRjLT5jcnRjX29mZnNldCwgYXN5bmMgPwogCSAgICAgICBHUlBI
X0ZMSVBfQ09OVFJPTF9fR1JQSF9TVVJGQUNFX1VQREFURV9IX1JFVFJBQ0VfRU5fTUFTSyA6IDAp
OworCS8qIHVwZGF0ZSBwaXRjaCAqLworCVdSRUczMihtbUdSUEhfUElUQ0ggKyBhbWRncHVfY3J0
Yy0+Y3J0Y19vZmZzZXQsCisJICAgICAgIGZiLT5waXRjaGVzWzBdIC8gZmItPmZvcm1hdC0+Y3Bw
WzBdKTsKIAkvKiB1cGRhdGUgdGhlIHByaW1hcnkgc2Nhbm91dCBhZGRyZXNzZXMgKi8KIAlXUkVH
MzIobW1HUlBIX1BSSU1BUllfU1VSRkFDRV9BRERSRVNTX0hJR0ggKyBhbWRncHVfY3J0Yy0+Y3J0
Y19vZmZzZXQsCiAJICAgICAgIHVwcGVyXzMyX2JpdHMoY3J0Y19iYXNlKSk7Ci0tIAoyLjIyLjAK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZngg
bWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
