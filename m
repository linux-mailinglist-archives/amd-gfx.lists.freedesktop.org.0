Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 54CD548FED
	for <lists+amd-gfx@lfdr.de>; Mon, 17 Jun 2019 21:46:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8B9B789DFA;
	Mon, 17 Jun 2019 19:46:26 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mail-qt1-x82c.google.com (mail-qt1-x82c.google.com
 [IPv6:2607:f8b0:4864:20::82c])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0A17989DC1
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 19:46:24 +0000 (UTC)
Received: by mail-qt1-x82c.google.com with SMTP id s15so12274083qtk.9
 for <amd-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 12:46:23 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=8W6heUfdzmb0jnde4uM11L031lD46NobUBkJKuwGuRw=;
 b=U61A/xMAuOM8wJUi4RX5RskA/QJo0VCIGvup7ISikV9SLBaFU1XJx828xMUkIfx0xH
 Kl8uomEg2UbwSvZqFeZNoHxiqdXl0/9kMNVwMo8kPIZ2eUTsud3JPuvpked8n/RUkdOz
 2ABSMwJEafFXJlLJ1tkM3kkJXeIu1JGpSXa3JslpLpBWit8+qXwK/0GcJOIRY0w1Wdas
 HbVhHCXXVz/BrhhBl1BbPOe9NrSXIO10xvzhRHxcsFSOgmr+6sg644BDn+d7joWotxTh
 DwfcCni1sTvHScp2Qicqp27sn8EofpLzN7qJUhhcOForxF6RknVXD2J2nuQgosZvnpmf
 6HkQ==
X-Gm-Message-State: APjAAAVWC4FUfePwOZ8Es+wDz3bCeRWQHkSj5ZBU0tZHS+GQbQKZjoD4
 +m8wvOsXwsc7A8sI+C7eXq4euJf78aI=
X-Google-Smtp-Source: APXvYqwutJD2+5PpXKL3KLqsX/Chp7gqd+Lg0YT8bULYN09Da2bH12Tix8JgeslPbilGgrOncrEAnA==
X-Received: by 2002:a0c:929b:: with SMTP id b27mr22672810qvb.193.1560800782298; 
 Mon, 17 Jun 2019 12:46:22 -0700 (PDT)
Received: from localhost.localdomain ([71.219.5.136])
 by smtp.gmail.com with ESMTPSA id u4sm6559420qkb.16.2019.06.17.12.46.20
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 12:46:21 -0700 (PDT)
From: Alex Deucher <alexdeucher@gmail.com>
X-Google-Original-From: Alex Deucher <alexander.deucher@amd.com>
To: amd-gfx@lists.freedesktop.org
Subject: [PATCH 328/459] drm/amd/display: Add DCN2 HUBP and HUBBUB
Date: Mon, 17 Jun 2019 14:44:29 -0500
Message-Id: <20190617194540.18497-29-alexander.deucher@amd.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617194540.18497-1-alexander.deucher@amd.com>
References: <20190617194540.18497-1-alexander.deucher@amd.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=8W6heUfdzmb0jnde4uM11L031lD46NobUBkJKuwGuRw=;
 b=O7OlJyNB7AAVe1RoU3J8nbPTJLWa8WaO1/5wwknZD1AERm2uFG97VCv+aUlXZHH008
 R0n84ox8TNaziKbU8zKuVQTpS7MBw5ka91TVY6WfnOCySsg0yeCYId2Se2mtf2tQbaCW
 lwxRYxK1MlClIxivHHeP2ib+vCBs0F6Yg2EIQEjcCr7e4xx+kTqvL/TuXJqGwHQD1f9g
 MnJxIQopanDtqqHbbJAndFyMWE2y4q+vo4MBFxGKGAch1NgWyjSU4Ra/RGCW9u8nzlSR
 4hGp/j19RJn5AjtS1KecLmbexyL1eXocl/YGGO5wflaGWFbd6cZmnzFqQWDBniLA/3Hg
 fGUg==
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Alex Deucher <alexander.deucher@amd.com>,
 Harry Wentland <harry.wentland@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RnJvbTogSGFycnkgV2VudGxhbmQgPGhhcnJ5LndlbnRsYW5kQGFtZC5jb20+CgpBZGQgc3VwcG9y
dCB0byBwcm9ncmFtIHRoZSBEQ04yIEhVQlAgKERpc3BsYXkgdG8gZGF0YSBmYWJyaWMgaW50ZXJm
YWNlCnBpcGUpIGFuZCBIVUJCVUIgKERDTiBtZW1vcnkgSFVCIGludGVyZmFjZSkKCkhXIEJsb2Nr
czoKCiArLS0tLS0tLS0rKy0tLS0tLSsKIHwgSFVCQlVCIHx8IEhVQlAgfAogKy0tLS0tLS0tKyst
LS0tLS0rCiAgICAgICAgfAogICAgICAgIHYKICAgICstLS0tLS0tLSsKICAgIHwgIERQUCAgIHwK
ICAgICstLS0tLS0tLSsKICAgICAgICB8CiAgICAgICAgdgogICAgKy0tLS0tLS0tKwogICAgfCAg
TVBDICAgfAogICAgKy0tLS0tLS0tKwogICAgICAgIHwKICAgICAgICB2CiAgICArLS0tLS0tLSsK
ICAgIHwgIE9QUCAgfAogICAgKy0tLS0tLS0rCiAgICAgICAgfAogICAgICAgIHYKICAgICstLS0t
LS0tLSsKICAgIHwgIE9QVEMgIHwKICAgICstLS0tLS0tLSsKICAgICAgICB8CiAgICAgICAgdgog
ICAgKy0tLS0tLS0tKyAgICAgICArLS0tLS0tLS0rCiAgICB8ICBESU8gICB8ICAgICAgIHwgIERD
Q0cgIHwKICAgICstLS0tLS0tLSsgICAgICAgKy0tLS0tLS0tKwoKU2lnbmVkLW9mZi1ieTogSGFy
cnkgV2VudGxhbmQgPGhhcnJ5LndlbnRsYW5kQGFtZC5jb20+ClNpZ25lZC1vZmYtYnk6IEFsZXgg
RGV1Y2hlciA8YWxleGFuZGVyLmRldWNoZXJAYW1kLmNvbT4KLS0tCiAuLi4vZHJtL2FtZC9kaXNw
bGF5L2RjL2RjbjEwL2RjbjEwX2h1YmJ1Yi5jICAgfCAgNDUgKy0KIC4uLi9ncHUvZHJtL2FtZC9k
aXNwbGF5L2RjL2RjbjEwL2RjbjEwX2h1YnAuYyB8ICAyNyArCiAuLi4vZ3B1L2RybS9hbWQvZGlz
cGxheS9kYy9kY24xMC9kY24xMF9odWJwLmggfCAgIDggKwogLi4uL2RybS9hbWQvZGlzcGxheS9k
Yy9kY24yMC9kY24yMF9odWJidWIuYyAgIHwgNTIzICsrKysrKysrKysrKysKIC4uLi9kcm0vYW1k
L2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHViYnViLmggICB8IDEwOCArKysKIC4uLi9ncHUvZHJt
L2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h1YnAuYyB8IDY5OSArKysrKysrKysrKysrKysr
KysKIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h1YnAuaCB8IDI0NCAr
KysrKysKIC4uLi9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9ody9kY2h1YmJ1Yi5oICB8ICA2
MiArKwogZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2luYy9ody9odWJwLmggIHwgIDI1
ICsKIDkgZmlsZXMgY2hhbmdlZCwgMTczOSBpbnNlcnRpb25zKCspLCAyIGRlbGV0aW9ucygtKQog
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9k
Y24yMF9odWJidWIuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9hbWQvZGlz
cGxheS9kYy9kY24yMC9kY24yMF9odWJidWIuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMv
Z3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9odWJwLmMKIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHVicC5oCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX2h1
YmJ1Yi5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX2h1YmJ1
Yi5jCmluZGV4IGJmOTc4ODMxYmIwZS4uZGFhMjI5Yjk3ZmNmIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfaHViYnViLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX2h1YmJ1Yi5jCkBAIC0xNDUsNiAr
MTQ1LDcgQEAgYm9vbCBodWJidWIxX3ZlcmlmeV9hbGxvd19wc3RhdGVfY2hhbmdlX2hpZ2goCiAJ
CWZvcmNlZF9wc3RhdGVfYWxsb3cgPSBmYWxzZTsKIAl9CiAKKyNpZmRlZiBDT05GSUdfRFJNX0FN
RF9EQ19EQ04xXzAxCiAJLyogUlYyOgogCSAqIGRjaHViYnViZGVidWdpbmQsIGF0OiAweEIKIAkg
KiBkZXNjcmlwdGlvbgpAQCAtMTgwLDggKzE4MSw0NiBAQCBib29sIGh1YmJ1YjFfdmVyaWZ5X2Fs
bG93X3BzdGF0ZV9jaGFuZ2VfaGlnaCgKIAkgKiAyOTogICAgV0IxIEFsbG93IFBzdGF0ZSBDaGFu
Z2UKIAkgKiAzMDogICAgQXJiaXRlcidzIGFsbG93X3BzdGF0ZV9jaGFuZ2UKIAkgKiAzMTogICAg
U09DIHBzdGF0ZSBjaGFuZ2UgcmVxdWVzdCIKLQkgKgotCSAqIFJWMToKKwkgKi8KKyNlbHNlCisj
aWZkZWYgQ09ORklHX0RSTV9BTURfRENfRENOMl8wCisJLypEQ04yLng6CisJSFVCQlVCOkRDSFVC
QlVCX1RFU1RfQVJCX0RFQlVHMTAgRENIVUJCVUJERUJVR0lORDoweEIKKwkwOiBQaXBlMCBQbGFu
ZTAgQWxsb3cgUC1zdGF0ZSBDaGFuZ2UKKwkxOiBQaXBlMCBQbGFuZTEgQWxsb3cgUC1zdGF0ZSBD
aGFuZ2UKKwkyOiBQaXBlMCBDdXJzb3IwIEFsbG93IFAtc3RhdGUgQ2hhbmdlCisJMzogUGlwZTAg
Q3Vyc29yMSBBbGxvdyBQLXN0YXRlIENoYW5nZQorCTQ6IFBpcGUxIFBsYW5lMCBBbGxvdyBQLXN0
YXRlIENoYW5nZQorCTU6IFBpcGUxIFBsYW5lMSBBbGxvdyBQLXN0YXRlIENoYW5nZQorCTY6IFBp
cGUxIEN1cnNvcjAgQWxsb3cgUC1zdGF0ZSBDaGFuZ2UKKwk3OiBQaXBlMSBDdXJzb3IxIEFsbG93
IFAtc3RhdGUgQ2hhbmdlCisJODogUGlwZTIgUGxhbmUwIEFsbG93IFAtc3RhdGUgQ2hhbmdlCisJ
OTogUGlwZTIgUGxhbmUxIEFsbG93IFAtc3RhdGUgQ2hhbmdlCisJMTA6IFBpcGUyIEN1cnNvcjAg
QWxsb3cgUC1zdGF0ZSBDaGFuZ2UKKwkxMTogUGlwZTIgQ3Vyc29yMSBBbGxvdyBQLXN0YXRlIENo
YW5nZQorCTEyOiBQaXBlMyBQbGFuZTAgQWxsb3cgUC1zdGF0ZSBDaGFuZ2UKKwkxMzogUGlwZTMg
UGxhbmUxIEFsbG93IFAtc3RhdGUgQ2hhbmdlCisJMTQ6IFBpcGUzIEN1cnNvcjAgQWxsb3cgUC1z
dGF0ZSBDaGFuZ2UKKwkxNTogUGlwZTMgQ3Vyc29yMSBBbGxvdyBQLXN0YXRlIENoYW5nZQorCTE2
OiBQaXBlNCBQbGFuZTAgQWxsb3cgUC1zdGF0ZSBDaGFuZ2UKKwkxNzogUGlwZTQgUGxhbmUxIEFs
bG93IFAtc3RhdGUgQ2hhbmdlCisJMTg6IFBpcGU0IEN1cnNvcjAgQWxsb3cgUC1zdGF0ZSBDaGFu
Z2UKKwkxOTogUGlwZTQgQ3Vyc29yMSBBbGxvdyBQLXN0YXRlIENoYW5nZQorCTIwOiBQaXBlNSBQ
bGFuZTAgQWxsb3cgUC1zdGF0ZSBDaGFuZ2UKKwkyMTogUGlwZTUgUGxhbmUxIEFsbG93IFAtc3Rh
dGUgQ2hhbmdlCisJMjI6IFBpcGU1IEN1cnNvcjAgQWxsb3cgUC1zdGF0ZSBDaGFuZ2UKKwkyMzog
UGlwZTUgQ3Vyc29yMSBBbGxvdyBQLXN0YXRlIENoYW5nZQorCTI0OiBQaXBlNiBQbGFuZTAgQWxs
b3cgUC1zdGF0ZSBDaGFuZ2UKKwkyNTogUGlwZTYgUGxhbmUxIEFsbG93IFAtc3RhdGUgQ2hhbmdl
CisJMjY6IFBpcGU2IEN1cnNvcjAgQWxsb3cgUC1zdGF0ZSBDaGFuZ2UKKwkyNzogUGlwZTYgQ3Vy
c29yMSBBbGxvdyBQLXN0YXRlIENoYW5nZQorCTI4OiBXQjAgQWxsb3cgUC1zdGF0ZSBDaGFuZ2UK
KwkyOTogV0IxIEFsbG93IFAtc3RhdGUgQ2hhbmdlCisJMzA6IEFyYml0ZXJgcyBBbGxvdyBQLXN0
YXRlIENoYW5nZQorCTMxOiBTT0MgUC1zdGF0ZSBDaGFuZ2UgcmVxdWVzdAorCSovCisjZWxzZQor
CS8qIFJWMToKIAkgKiBkY2h1YmJ1YmRlYnVnaW5kLCBhdDogMHg3CiAJICogZGVzY3JpcHRpb24g
IjMtMDogICBQaXBlMCBjdXJzb3IwIFFPUwogCSAqIDctNDogICBQaXBlMSBjdXJzb3IwIFFPUwpA
QCAtMjA0LDYgKzI0Myw4IEBAIGJvb2wgaHViYnViMV92ZXJpZnlfYWxsb3dfcHN0YXRlX2NoYW5n
ZV9oaWdoKAogCSAqIDMwOiAgICBBcmJpdGVyJ3MgYWxsb3dfcHN0YXRlX2NoYW5nZQogCSAqIDMx
OiAgICBTT0MgcHN0YXRlIGNoYW5nZSByZXF1ZXN0CiAJICovCisjZW5kaWYKKyNlbmRpZgogCiAJ
UkVHX1dSSVRFKERDSFVCQlVCX1RFU1RfREVCVUdfSU5ERVgsIGh1YmJ1YjEtPmRlYnVnX3Rlc3Rf
aW5kZXhfcHN0YXRlKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2RjbjEwL2RjbjEwX2h1YnAuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
Y24xMC9kY24xMF9odWJwLmMKaW5kZXggNTRiMjE5YTcxMGQ4Li4zZjlhZDA5NzY5YjEgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9odWJwLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjEwL2RjbjEwX2h1YnAuYwpA
QCAtMzA2LDYgKzMwNiwyOCBAQCB2b2lkIGh1YnAxX3Byb2dyYW1fcGl4ZWxfZm9ybWF0KAogCQlS
RUdfVVBEQVRFKERDU1VSRl9TVVJGQUNFX0NPTkZJRywKIAkJCQlTVVJGQUNFX1BJWEVMX0ZPUk1B
VCwgMTIpOwogCQlicmVhazsKKyNpZiBkZWZpbmVkKENPTkZJR19EUk1fQU1EX0RDX0RDTjJfMCkK
KwljYXNlIFNVUkZBQ0VfUElYRUxfRk9STUFUX0dSUEhfUkdCMTExMTEwX0ZJWDoKKwkJUkVHX1VQ
REFURShEQ1NVUkZfU1VSRkFDRV9DT05GSUcsCisJCQkJU1VSRkFDRV9QSVhFTF9GT1JNQVQsIDEx
Mik7CisJCWJyZWFrOworCWNhc2UgU1VSRkFDRV9QSVhFTF9GT1JNQVRfR1JQSF9CR1IxMDExMTFf
RklYOgorCQlSRUdfVVBEQVRFKERDU1VSRl9TVVJGQUNFX0NPTkZJRywKKwkJCQlTVVJGQUNFX1BJ
WEVMX0ZPUk1BVCwgMTEzKTsKKwkJYnJlYWs7CisJY2FzZSBTVVJGQUNFX1BJWEVMX0ZPUk1BVF9W
SURFT19BQ3JZQ2IyMTAxMDEwOgorCQlSRUdfVVBEQVRFKERDU1VSRl9TVVJGQUNFX0NPTkZJRywK
KwkJCQlTVVJGQUNFX1BJWEVMX0ZPUk1BVCwgMTE0KTsKKwkJYnJlYWs7CisJY2FzZSBTVVJGQUNF
X1BJWEVMX0ZPUk1BVF9HUlBIX1JHQjExMTExMF9GTE9BVDoKKwkJUkVHX1VQREFURShEQ1NVUkZf
U1VSRkFDRV9DT05GSUcsCisJCQkJU1VSRkFDRV9QSVhFTF9GT1JNQVQsIDExOCk7CisJCWJyZWFr
OworCWNhc2UgU1VSRkFDRV9QSVhFTF9GT1JNQVRfR1JQSF9CR1IxMDExMTFfRkxPQVQ6CisJCVJF
R19VUERBVEUoRENTVVJGX1NVUkZBQ0VfQ09ORklHLAorCQkJCVNVUkZBQ0VfUElYRUxfRk9STUFU
LCAxMTkpOworCQlicmVhazsKKyNlbmRpZgogCWRlZmF1bHQ6CiAJCUJSRUFLX1RPX0RFQlVHR0VS
KCk7CiAJCWJyZWFrOwpAQCAtMTIwNiw2ICsxMjI4LDExIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qg
aHVicF9mdW5jcyBkY24xMF9odWJwX2Z1bmNzID0gewogCS5odWJwX2Rpc2FibGVfY29udHJvbCA9
ICBodWJwMV9kaXNhYmxlX2NvbnRyb2wsCiAJLmh1YnBfZ2V0X3VuZGVyZmxvd19zdGF0dXMgPSBo
dWJwMV9nZXRfdW5kZXJmbG93X3N0YXR1cywKIAkuaHVicF9pbml0ID0gaHVicDFfaW5pdCwKKwor
I2lmIGRlZmluZWQoQ09ORklHX0RSTV9BTURfRENfRENOMl8wKQorCS5kbWRhdGFfc2V0X2F0dHJp
YnV0ZXMgPSBOVUxMLAorCS5kbWRhdGFfbG9hZCA9IE5VTEwsCisjZW5kaWYKIH07CiAKIC8qKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24xMC9kY24xMF9odWJwLmggYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMTAvZGNuMTBfaHVicC5oCmluZGV4IDk5ZDJiN2UyYTU3
OC4uYjhhNGJmY2RiZWIyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvZGNuMTAvZGNuMTBfaHVicC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9k
Yy9kY24xMC9kY24xMF9odWJwLmgKQEAgLTcxNSw2ICs3MTUsMTQgQEAgdm9pZCBodWJwMV9kY2Nf
Y29udHJvbChzdHJ1Y3QgaHVicCAqaHVicCwKIAkJYm9vbCBlbmFibGUsCiAJCWJvb2wgaW5kZXBl
bmRlbnRfNjRiX2Jsa3MpOwogCisjaWZkZWYgQ09ORklHX0RSTV9BTURfRENfRENOMl8wCitib29s
IGh1YnAxX3Byb2dyYW1fc3VyZmFjZV9mbGlwX2FuZF9hZGRyKAorCXN0cnVjdCBodWJwICpodWJw
LAorCWNvbnN0IHN0cnVjdCBkY19wbGFuZV9hZGRyZXNzICphZGRyZXNzLAorCWJvb2wgZmxpcF9p
bW1lZGlhdGUsCisJdWludDhfdCB2bWlkKTsKKworI2VuZGlmCiBib29sIGh1YnAxX2lzX2ZsaXBf
cGVuZGluZyhzdHJ1Y3QgaHVicCAqaHVicCk7CiAKIHZvaWQgaHVicDFfY3Vyc29yX3NldF9hdHRy
aWJ1dGVzKApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIw
L2RjbjIwX2h1YmJ1Yi5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2Rj
bjIwX2h1YmJ1Yi5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMDll
OGQxMGE3YTAxCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2RjbjIwL2RjbjIwX2h1YmJ1Yi5jCkBAIC0wLDAgKzEsNTIzIEBACisvKgorICogQ29weXJp
Z2h0IDIwMTYgQWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5jLgorICoKKyAqIFBlcm1pc3Npb24g
aXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmlu
ZyBhCisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlv
biBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0
aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgorICogdGhlIHJp
Z2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1
YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8g
cGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBk
byBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CisgKgorICogVGhlIGFi
b3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUg
aW5jbHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhl
IFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRI
T1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVELCBJTkNMVURJ
TkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwK
KyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQu
ICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIENPUFlSSUdIVCBIT0xERVIoUykgT1IgQVVUSE9S
KFMpIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SCisgKiBPVEhFUiBMSUFCSUxJ
VFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwK
KyAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdB
UkUgT1IgVEhFIFVTRSBPUgorICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgorICoK
KyAqIEF1dGhvcnM6IEFNRAorICoKKyAqLworCisKKyNpbmNsdWRlICJkY24yMF9odWJidWIuaCIK
KyNpbmNsdWRlICJyZWdfaGVscGVyLmgiCisKKyNkZWZpbmUgUkVHKHJlZylcCisJaHViYnViMS0+
cmVncy0+cmVnCisKKyNkZWZpbmUgQ1RYIFwKKwlodWJidWIxLT5iYXNlLmN0eAorCisjdW5kZWYg
Rk4KKyNkZWZpbmUgRk4ocmVnX25hbWUsIGZpZWxkX25hbWUpIFwKKwlodWJidWIxLT5zaGlmdHMt
PmZpZWxkX25hbWUsIGh1YmJ1YjEtPm1hc2tzLT5maWVsZF9uYW1lCisKKyNkZWZpbmUgUkVHKHJl
ZylcCisJaHViYnViMS0+cmVncy0+cmVnCisKKyNkZWZpbmUgQ1RYIFwKKwlodWJidWIxLT5iYXNl
LmN0eAorCisjdW5kZWYgRk4KKyNkZWZpbmUgRk4ocmVnX25hbWUsIGZpZWxkX25hbWUpIFwKKwlo
dWJidWIxLT5zaGlmdHMtPmZpZWxkX25hbWUsIGh1YmJ1YjEtPm1hc2tzLT5maWVsZF9uYW1lCisK
K2Jvb2wgaHViYnViMl9kY2Nfc3VwcG9ydF9zd2l6emxlKAorCQllbnVtIHN3aXp6bGVfbW9kZV92
YWx1ZXMgc3dpenpsZSwKKwkJdW5zaWduZWQgaW50IGJ5dGVzX3Blcl9lbGVtZW50LAorCQllbnVt
IHNlZ21lbnRfb3JkZXIgKnNlZ21lbnRfb3JkZXJfaG9yeiwKKwkJZW51bSBzZWdtZW50X29yZGVy
ICpzZWdtZW50X29yZGVyX3ZlcnQpCit7CisJYm9vbCBzdGFuZGFyZF9zd2l6emxlID0gZmFsc2U7
CisJYm9vbCBkaXNwbGF5X3N3aXp6bGUgPSBmYWxzZTsKKwlib29sIHJlbmRlcl9zd2l6emxlID0g
ZmFsc2U7CisKKwlzd2l0Y2ggKHN3aXp6bGUpIHsKKwljYXNlIERDX1NXXzRLQl9TOgorCWNhc2Ug
RENfU1dfNjRLQl9TOgorCWNhc2UgRENfU1dfVkFSX1M6CisJY2FzZSBEQ19TV180S0JfU19YOgor
CWNhc2UgRENfU1dfNjRLQl9TX1g6CisJY2FzZSBEQ19TV19WQVJfU19YOgorCQlzdGFuZGFyZF9z
d2l6emxlID0gdHJ1ZTsKKwkJYnJlYWs7CisJY2FzZSBEQ19TV182NEtCX1JfWDoKKwkJcmVuZGVy
X3N3aXp6bGUgPSB0cnVlOworCQlicmVhazsKKwljYXNlIERDX1NXXzRLQl9EOgorCWNhc2UgRENf
U1dfNjRLQl9EOgorCWNhc2UgRENfU1dfVkFSX0Q6CisJY2FzZSBEQ19TV180S0JfRF9YOgorCWNh
c2UgRENfU1dfNjRLQl9EX1g6CisJY2FzZSBEQ19TV19WQVJfRF9YOgorCQlkaXNwbGF5X3N3aXp6
bGUgPSB0cnVlOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlicmVhazsKKwl9CisKKwlpZiAoc3Rh
bmRhcmRfc3dpenpsZSkgeworCQlpZiAoYnl0ZXNfcGVyX2VsZW1lbnQgPT0gMSkgeworCQkJKnNl
Z21lbnRfb3JkZXJfaG9yeiA9IHNlZ21lbnRfb3JkZXJfX2NvbnRpZ3VvdXM7CisJCQkqc2VnbWVu
dF9vcmRlcl92ZXJ0ID0gc2VnbWVudF9vcmRlcl9fbmE7CisJCQlyZXR1cm4gdHJ1ZTsKKwkJfQor
CQlpZiAoYnl0ZXNfcGVyX2VsZW1lbnQgPT0gMikgeworCQkJKnNlZ21lbnRfb3JkZXJfaG9yeiA9
IHNlZ21lbnRfb3JkZXJfX25vbl9jb250aWd1b3VzOworCQkJKnNlZ21lbnRfb3JkZXJfdmVydCA9
IHNlZ21lbnRfb3JkZXJfX2NvbnRpZ3VvdXM7CisJCQlyZXR1cm4gdHJ1ZTsKKwkJfQorCQlpZiAo
Ynl0ZXNfcGVyX2VsZW1lbnQgPT0gNCkgeworCQkJKnNlZ21lbnRfb3JkZXJfaG9yeiA9IHNlZ21l
bnRfb3JkZXJfX25vbl9jb250aWd1b3VzOworCQkJKnNlZ21lbnRfb3JkZXJfdmVydCA9IHNlZ21l
bnRfb3JkZXJfX2NvbnRpZ3VvdXM7CisJCQlyZXR1cm4gdHJ1ZTsKKwkJfQorCQlpZiAoYnl0ZXNf
cGVyX2VsZW1lbnQgPT0gOCkgeworCQkJKnNlZ21lbnRfb3JkZXJfaG9yeiA9IHNlZ21lbnRfb3Jk
ZXJfX25hOworCQkJKnNlZ21lbnRfb3JkZXJfdmVydCA9IHNlZ21lbnRfb3JkZXJfX2NvbnRpZ3Vv
dXM7CisJCQlyZXR1cm4gdHJ1ZTsKKwkJfQorCX0KKwlpZiAocmVuZGVyX3N3aXp6bGUpIHsKKwkJ
aWYgKGJ5dGVzX3Blcl9lbGVtZW50ID09IDIpIHsKKwkJCSpzZWdtZW50X29yZGVyX2hvcnogPSBz
ZWdtZW50X29yZGVyX19jb250aWd1b3VzOworCQkJKnNlZ21lbnRfb3JkZXJfdmVydCA9IHNlZ21l
bnRfb3JkZXJfX2NvbnRpZ3VvdXM7CisJCQlyZXR1cm4gdHJ1ZTsKKwkJfQorCQlpZiAoYnl0ZXNf
cGVyX2VsZW1lbnQgPT0gNCkgeworCQkJKnNlZ21lbnRfb3JkZXJfaG9yeiA9IHNlZ21lbnRfb3Jk
ZXJfX25vbl9jb250aWd1b3VzOworCQkJKnNlZ21lbnRfb3JkZXJfdmVydCA9IHNlZ21lbnRfb3Jk
ZXJfX2NvbnRpZ3VvdXM7CisJCQlyZXR1cm4gdHJ1ZTsKKwkJfQorCQlpZiAoYnl0ZXNfcGVyX2Vs
ZW1lbnQgPT0gOCkgeworCQkJKnNlZ21lbnRfb3JkZXJfaG9yeiA9IHNlZ21lbnRfb3JkZXJfX2Nv
bnRpZ3VvdXM7CisJCQkqc2VnbWVudF9vcmRlcl92ZXJ0ID0gc2VnbWVudF9vcmRlcl9fbm9uX2Nv
bnRpZ3VvdXM7CisJCQlyZXR1cm4gdHJ1ZTsKKwkJfQorCX0KKwlpZiAoZGlzcGxheV9zd2l6emxl
ICYmIGJ5dGVzX3Blcl9lbGVtZW50ID09IDgpIHsKKwkJKnNlZ21lbnRfb3JkZXJfaG9yeiA9IHNl
Z21lbnRfb3JkZXJfX2NvbnRpZ3VvdXM7CisJCSpzZWdtZW50X29yZGVyX3ZlcnQgPSBzZWdtZW50
X29yZGVyX19ub25fY29udGlndW91czsKKwkJcmV0dXJuIHRydWU7CisJfQorCisJcmV0dXJuIGZh
bHNlOworfQorCitib29sIGh1YmJ1YjJfZGNjX3N1cHBvcnRfcGl4ZWxfZm9ybWF0KAorCQllbnVt
IHN1cmZhY2VfcGl4ZWxfZm9ybWF0IGZvcm1hdCwKKwkJdW5zaWduZWQgaW50ICpieXRlc19wZXJf
ZWxlbWVudCkKK3sKKwkvKiBETUw6IGdldF9ieXRlc19wZXJfZWxlbWVudCAqLworCXN3aXRjaCAo
Zm9ybWF0KSB7CisJY2FzZSBTVVJGQUNFX1BJWEVMX0ZPUk1BVF9HUlBIX0FSR0IxNTU1OgorCWNh
c2UgU1VSRkFDRV9QSVhFTF9GT1JNQVRfR1JQSF9SR0I1NjU6CisJCSpieXRlc19wZXJfZWxlbWVu
dCA9IDI7CisJCXJldHVybiB0cnVlOworCWNhc2UgU1VSRkFDRV9QSVhFTF9GT1JNQVRfR1JQSF9B
UkdCODg4ODoKKwljYXNlIFNVUkZBQ0VfUElYRUxfRk9STUFUX0dSUEhfQUJHUjg4ODg6CisJY2Fz
ZSBTVVJGQUNFX1BJWEVMX0ZPUk1BVF9HUlBIX0FSR0IyMTAxMDEwOgorCWNhc2UgU1VSRkFDRV9Q
SVhFTF9GT1JNQVRfR1JQSF9BQkdSMjEwMTAxMDoKKwljYXNlIFNVUkZBQ0VfUElYRUxfRk9STUFU
X0dSUEhfUkdCMTExMTEwX0ZJWDoKKwljYXNlIFNVUkZBQ0VfUElYRUxfRk9STUFUX0dSUEhfQkdS
MTAxMTExX0ZJWDoKKwljYXNlIFNVUkZBQ0VfUElYRUxfRk9STUFUX0dSUEhfUkdCMTExMTEwX0ZM
T0FUOgorCWNhc2UgU1VSRkFDRV9QSVhFTF9GT1JNQVRfR1JQSF9CR1IxMDExMTFfRkxPQVQ6CisJ
CSpieXRlc19wZXJfZWxlbWVudCA9IDQ7CisJCXJldHVybiB0cnVlOworCWNhc2UgU1VSRkFDRV9Q
SVhFTF9GT1JNQVRfR1JQSF9BUkdCMTYxNjE2MTY6CisJY2FzZSBTVVJGQUNFX1BJWEVMX0ZPUk1B
VF9HUlBIX0FSR0IxNjE2MTYxNkY6CisJY2FzZSBTVVJGQUNFX1BJWEVMX0ZPUk1BVF9HUlBIX0FC
R1IxNjE2MTYxNkY6CisJCSpieXRlc19wZXJfZWxlbWVudCA9IDg7CisJCXJldHVybiB0cnVlOwor
CWRlZmF1bHQ6CisJCXJldHVybiBmYWxzZTsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIGh1YmJ1YjJf
Z2V0X2JsazI1Nl9zaXplKHVuc2lnbmVkIGludCAqYmxrMjU2X3dpZHRoLCB1bnNpZ25lZCBpbnQg
KmJsazI1Nl9oZWlnaHQsCisJCXVuc2lnbmVkIGludCBieXRlc19wZXJfZWxlbWVudCkKK3sKKwkv
KiBjb3BpZWQgZnJvbSBETUwuICBtaWdodCB3YW50IHRvIHJlZmFjdG9yIERNTCB0byBsZXZlcmFn
ZSBmcm9tIERNTCAqLworCS8qIERNTCA6IGdldF9ibGsyNTZfc2l6ZSAqLworCWlmIChieXRlc19w
ZXJfZWxlbWVudCA9PSAxKSB7CisJCSpibGsyNTZfd2lkdGggPSAxNjsKKwkJKmJsazI1Nl9oZWln
aHQgPSAxNjsKKwl9IGVsc2UgaWYgKGJ5dGVzX3Blcl9lbGVtZW50ID09IDIpIHsKKwkJKmJsazI1
Nl93aWR0aCA9IDE2OworCQkqYmxrMjU2X2hlaWdodCA9IDg7CisJfSBlbHNlIGlmIChieXRlc19w
ZXJfZWxlbWVudCA9PSA0KSB7CisJCSpibGsyNTZfd2lkdGggPSA4OworCQkqYmxrMjU2X2hlaWdo
dCA9IDg7CisJfSBlbHNlIGlmIChieXRlc19wZXJfZWxlbWVudCA9PSA4KSB7CisJCSpibGsyNTZf
d2lkdGggPSA4OworCQkqYmxrMjU2X2hlaWdodCA9IDQ7CisJfQorfQorCitzdGF0aWMgdm9pZCBo
dWJidWIyX2RldF9yZXF1ZXN0X3NpemUoCisJCXVuc2lnbmVkIGludCBoZWlnaHQsCisJCXVuc2ln
bmVkIGludCB3aWR0aCwKKwkJdW5zaWduZWQgaW50IGJwZSwKKwkJYm9vbCAqcmVxMTI4X2hvcnpf
d2MsCisJCWJvb2wgKnJlcTEyOF92ZXJ0X3djKQoreworCXVuc2lnbmVkIGludCBkZXRpbGVfYnVm
X3NpemUgPSAxNjQgKiAxMDI0OyAgLyogMTY0S0IgZm9yIERDTjEuMCAqLworCisJdW5zaWduZWQg
aW50IGJsazI1Nl9oZWlnaHQgPSAwOworCXVuc2lnbmVkIGludCBibGsyNTZfd2lkdGggPSAwOwor
CXVuc2lnbmVkIGludCBzd2F0aF9ieXRlc19ob3J6X3djLCBzd2F0aF9ieXRlc192ZXJ0X3djOwor
CisJaHViYnViMl9nZXRfYmxrMjU2X3NpemUoJmJsazI1Nl93aWR0aCwgJmJsazI1Nl9oZWlnaHQs
IGJwZSk7CisKKwlzd2F0aF9ieXRlc19ob3J6X3djID0gaGVpZ2h0ICogYmxrMjU2X2hlaWdodCAq
IGJwZTsKKwlzd2F0aF9ieXRlc192ZXJ0X3djID0gd2lkdGggKiBibGsyNTZfd2lkdGggKiBicGU7
CisKKwkqcmVxMTI4X2hvcnpfd2MgPSAoMiAqIHN3YXRoX2J5dGVzX2hvcnpfd2MgPD0gZGV0aWxl
X2J1Zl9zaXplKSA/CisJCQlmYWxzZSA6IC8qIGZ1bGwgMjU2QiByZXF1ZXN0ICovCisJCQl0cnVl
OyAvKiBoYWxmIDEyOGIgcmVxdWVzdCAqLworCisJKnJlcTEyOF92ZXJ0X3djID0gKDIgKiBzd2F0
aF9ieXRlc192ZXJ0X3djIDw9IGRldGlsZV9idWZfc2l6ZSkgPworCQkJZmFsc2UgOiAvKiBmdWxs
IDI1NkIgcmVxdWVzdCAqLworCQkJdHJ1ZTsgLyogaGFsZiAxMjhiIHJlcXVlc3QgKi8KK30KKwor
Ym9vbCBodWJidWIyX2dldF9kY2NfY29tcHJlc3Npb25fY2FwKHN0cnVjdCBodWJidWIgKmh1YmJ1
YiwKKwkJY29uc3Qgc3RydWN0IGRjX2RjY19zdXJmYWNlX3BhcmFtICppbnB1dCwKKwkJc3RydWN0
IGRjX3N1cmZhY2VfZGNjX2NhcCAqb3V0cHV0KQoreworCXN0cnVjdCBkYyAqZGMgPSBodWJidWIt
PmN0eC0+ZGM7CisJLyogaW1wbGVtZW50IHNlY3Rpb24gMS42LjIuMSBvZiBEQ04xX1Byb2dyYW1t
aW5nX0d1aWRlLmRvY3ggKi8KKwllbnVtIGRjY19jb250cm9sIGRjY19jb250cm9sOworCXVuc2ln
bmVkIGludCBicGU7CisJZW51bSBzZWdtZW50X29yZGVyIHNlZ21lbnRfb3JkZXJfaG9yeiwgc2Vn
bWVudF9vcmRlcl92ZXJ0OworCWJvb2wgcmVxMTI4X2hvcnpfd2MsIHJlcTEyOF92ZXJ0X3djOwor
CisJbWVtc2V0KG91dHB1dCwgMCwgc2l6ZW9mKCpvdXRwdXQpKTsKKworCWlmIChkYy0+ZGVidWcu
ZGlzYWJsZV9kY2MgPT0gRENDX0RJU0FCTEUpCisJCXJldHVybiBmYWxzZTsKKworCWlmICghaHVi
YnViLT5mdW5jcy0+ZGNjX3N1cHBvcnRfcGl4ZWxfZm9ybWF0KGlucHV0LT5mb3JtYXQsCisJCQkm
YnBlKSkKKwkJcmV0dXJuIGZhbHNlOworCisJaWYgKCFodWJidWItPmZ1bmNzLT5kY2Nfc3VwcG9y
dF9zd2l6emxlKGlucHV0LT5zd2l6emxlX21vZGUsIGJwZSwKKwkJCSZzZWdtZW50X29yZGVyX2hv
cnosICZzZWdtZW50X29yZGVyX3ZlcnQpKQorCQlyZXR1cm4gZmFsc2U7CisKKwlodWJidWIyX2Rl
dF9yZXF1ZXN0X3NpemUoaW5wdXQtPnN1cmZhY2Vfc2l6ZS5oZWlnaHQsICBpbnB1dC0+c3VyZmFj
ZV9zaXplLndpZHRoLAorCQkJYnBlLCAmcmVxMTI4X2hvcnpfd2MsICZyZXExMjhfdmVydF93Yyk7
CisKKwlpZiAoIXJlcTEyOF9ob3J6X3djICYmICFyZXExMjhfdmVydF93YykgeworCQlkY2NfY29u
dHJvbCA9IGRjY19jb250cm9sX18yNTZfMjU2X3h4eDsKKwl9IGVsc2UgaWYgKGlucHV0LT5zY2Fu
ID09IFNDQU5fRElSRUNUSU9OX0hPUklaT05UQUwpIHsKKwkJaWYgKCFyZXExMjhfaG9yel93YykK
KwkJCWRjY19jb250cm9sID0gZGNjX2NvbnRyb2xfXzI1Nl8yNTZfeHh4OworCQllbHNlIGlmIChz
ZWdtZW50X29yZGVyX2hvcnogPT0gc2VnbWVudF9vcmRlcl9fY29udGlndW91cykKKwkJCWRjY19j
b250cm9sID0gZGNjX2NvbnRyb2xfXzEyOF8xMjhfeHh4OworCQllbHNlCisJCQlkY2NfY29udHJv
bCA9IGRjY19jb250cm9sX18yNTZfNjRfNjQ7CisJfSBlbHNlIGlmIChpbnB1dC0+c2NhbiA9PSBT
Q0FOX0RJUkVDVElPTl9WRVJUSUNBTCkgeworCQlpZiAoIXJlcTEyOF92ZXJ0X3djKQorCQkJZGNj
X2NvbnRyb2wgPSBkY2NfY29udHJvbF9fMjU2XzI1Nl94eHg7CisJCWVsc2UgaWYgKHNlZ21lbnRf
b3JkZXJfdmVydCA9PSBzZWdtZW50X29yZGVyX19jb250aWd1b3VzKQorCQkJZGNjX2NvbnRyb2wg
PSBkY2NfY29udHJvbF9fMTI4XzEyOF94eHg7CisJCWVsc2UKKwkJCWRjY19jb250cm9sID0gZGNj
X2NvbnRyb2xfXzI1Nl82NF82NDsKKwl9IGVsc2UgeworCQlpZiAoKHJlcTEyOF9ob3J6X3djICYm
CisJCQlzZWdtZW50X29yZGVyX2hvcnogPT0gc2VnbWVudF9vcmRlcl9fbm9uX2NvbnRpZ3VvdXMp
IHx8CisJCQkocmVxMTI4X3ZlcnRfd2MgJiYKKwkJCXNlZ21lbnRfb3JkZXJfdmVydCA9PSBzZWdt
ZW50X29yZGVyX19ub25fY29udGlndW91cykpCisJCQkvKiBhY2Nlc3NfZGlyIG5vdCBrbm93biwg
bXVzdCB1c2UgbW9zdCBjb25zdHJhaW5pbmcgKi8KKwkJCWRjY19jb250cm9sID0gZGNjX2NvbnRy
b2xfXzI1Nl82NF82NDsKKwkJZWxzZQorCQkJLyogcmVnMTI4IGlzIHRydWUgZm9yIGVpdGhlciBo
b3J6IGFuZCB2ZXJ0CisJCQkgKiBidXQgc2VnbWVudF9vcmRlciBpcyBjb250aWd1b3VzCisJCQkg
Ki8KKwkJCWRjY19jb250cm9sID0gZGNjX2NvbnRyb2xfXzEyOF8xMjhfeHh4OworCX0KKworCS8q
IEV4Y2VwdGlvbiBmb3IgNjRLQl9SX1ggKi8KKwlpZiAoKGJwZSA9PSAyKSAmJiAoaW5wdXQtPnN3
aXp6bGVfbW9kZSA9PSBEQ19TV182NEtCX1JfWCkpCisJCWRjY19jb250cm9sID0gZGNjX2NvbnRy
b2xfXzEyOF8xMjhfeHh4OworCisJaWYgKGRjLT5kZWJ1Zy5kaXNhYmxlX2RjYyA9PSBEQ0NfSEFM
Rl9SRVFfRElTQUxCRSAmJgorCQlkY2NfY29udHJvbCAhPSBkY2NfY29udHJvbF9fMjU2XzI1Nl94
eHgpCisJCXJldHVybiBmYWxzZTsKKworCXN3aXRjaCAoZGNjX2NvbnRyb2wpIHsKKwljYXNlIGRj
Y19jb250cm9sX18yNTZfMjU2X3h4eDoKKwkJb3V0cHV0LT5ncnBoLnJnYi5tYXhfdW5jb21wcmVz
c2VkX2Jsa19zaXplID0gMjU2OworCQlvdXRwdXQtPmdycGgucmdiLm1heF9jb21wcmVzc2VkX2Js
a19zaXplID0gMjU2OworCQlvdXRwdXQtPmdycGgucmdiLmluZGVwZW5kZW50XzY0Yl9ibGtzID0g
ZmFsc2U7CisJCWJyZWFrOworCWNhc2UgZGNjX2NvbnRyb2xfXzEyOF8xMjhfeHh4OgorCQlvdXRw
dXQtPmdycGgucmdiLm1heF91bmNvbXByZXNzZWRfYmxrX3NpemUgPSAxMjg7CisJCW91dHB1dC0+
Z3JwaC5yZ2IubWF4X2NvbXByZXNzZWRfYmxrX3NpemUgPSAxMjg7CisJCW91dHB1dC0+Z3JwaC5y
Z2IuaW5kZXBlbmRlbnRfNjRiX2Jsa3MgPSBmYWxzZTsKKwkJYnJlYWs7CisJY2FzZSBkY2NfY29u
dHJvbF9fMjU2XzY0XzY0OgorCQlvdXRwdXQtPmdycGgucmdiLm1heF91bmNvbXByZXNzZWRfYmxr
X3NpemUgPSAyNTY7CisJCW91dHB1dC0+Z3JwaC5yZ2IubWF4X2NvbXByZXNzZWRfYmxrX3NpemUg
PSA2NDsKKwkJb3V0cHV0LT5ncnBoLnJnYi5pbmRlcGVuZGVudF82NGJfYmxrcyA9IHRydWU7CisJ
CWJyZWFrOworCX0KKwlvdXRwdXQtPmNhcGFibGUgPSB0cnVlOworCW91dHB1dC0+Y29uc3RfY29s
b3Jfc3VwcG9ydCA9IHRydWU7CisKKwlyZXR1cm4gdHJ1ZTsKK30KKworc3RhdGljIHZvaWQgaHVi
YnViMl9zZXR1cF92bWlkX3B0YihzdHJ1Y3QgaHViYnViICpodWJidWIsCisJCXVpbnQ2NF90IHB0
YiwKKwkJdWludDhfdCB2bWlkKQoreworCXN0cnVjdCBkY24yMF9odWJidWIgKmh1YmJ1YjEgPSBU
T19EQ04yMF9IVUJCVUIoaHViYnViKTsKKworCWRjbjIwX3ZtaWRfc2V0X3B0YigmaHViYnViMS0+
dm1pZFt2bWlkXSwgcHRiKTsKK30KKworCit2b2lkIGh1YmJ1YjJfaW5pdF9kY2h1YihzdHJ1Y3Qg
aHViYnViICpodWJidWIsCisJCXN0cnVjdCBodWJidWJfYWRkcl9jb25maWcgKmNvbmZpZykKK3sK
KwlpbnQgaTsKKwlzdHJ1Y3QgZGNuMjBfaHViYnViICpodWJidWIxID0gVE9fRENOMjBfSFVCQlVC
KGh1YmJ1Yik7CisJc3RydWN0IGRjbl92bWlkX3BhZ2VfdGFibGVfY29uZmlnIHBoeXNfY29uZmln
OworCXN0cnVjdCBkY25fdm1pZF9wYWdlX3RhYmxlX2NvbmZpZyB2aXJ0X2NvbmZpZzsKKworCXBo
eXNfY29uZmlnLmRlcHRoID0gMDsgLy8gRGVwdGggMQorCXBoeXNfY29uZmlnLmJsb2NrX3NpemUg
PSAwOyAvLyBCbG9jayBzaXplIDRLQgorCXBoeXNfY29uZmlnLnBhZ2VfdGFibGVfc3RhcnRfYWRk
ciA9IGNvbmZpZy0+cGFfY29uZmlnLmdhcnRfY29uZmlnLnBhZ2VfdGFibGVfc3RhcnRfYWRkcjsK
KwlwaHlzX2NvbmZpZy5wYWdlX3RhYmxlX2VuZF9hZGRyID0gY29uZmlnLT5wYV9jb25maWcuZ2Fy
dF9jb25maWcucGFnZV90YWJsZV9lbmRfYWRkcjsKKworCVJFR19TRVQoRENOX1ZNX0ZCX0xPQ0FU
SU9OX0JBU0UsIDAsCisJCQlGQl9CQVNFLCBjb25maWctPnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1
cmUuZmJfYmFzZSk7CisJUkVHX1NFVChEQ05fVk1fRkJfTE9DQVRJT05fVE9QLCAwLAorCQkJRkJf
VE9QLCBjb25maWctPnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuZmJfdG9wKTsKKwlSRUdfU0VU
KERDTl9WTV9GQl9PRkZTRVQsIDAsCisJCQlGQl9PRkZTRVQsIGNvbmZpZy0+cGFfY29uZmlnLnN5
c3RlbV9hcGVydHVyZS5mYl9vZmZzZXQpOworCVJFR19TRVQoRENOX1ZNX0FHUF9CT1QsIDAsCisJ
CQlBR1BfQk9ULCBjb25maWctPnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuYWdwX2JvdCk7CisJ
UkVHX1NFVChEQ05fVk1fQUdQX1RPUCwgMCwKKwkJCUFHUF9UT1AsIGNvbmZpZy0+cGFfY29uZmln
LnN5c3RlbV9hcGVydHVyZS5hZ3BfdG9wKTsKKwlSRUdfU0VUKERDTl9WTV9BR1BfQkFTRSwgMCwK
KwkJCUFHUF9CQVNFLCBjb25maWctPnBhX2NvbmZpZy5zeXN0ZW1fYXBlcnR1cmUuYWdwX2Jhc2Up
OworCisJLy8gSW5pdCBWTUlEIDAgYmFzZWQgb24gUEEgY29uZmlnCisJZGNuMjBfdm1pZF9zZXR1
cCgmaHViYnViMS0+dm1pZFswXSwgJnBoeXNfY29uZmlnKTsKKwlkY24yMF92bWlkX3NldF9wdGIo
Jmh1YmJ1YjEtPnZtaWRbMF0sIGNvbmZpZy0+cGFfY29uZmlnLmdhcnRfY29uZmlnLnBhZ2VfdGFi
bGVfYmFzZV9hZGRyKTsKKworCS8vIEluaXQgVk1JRCAxLTE1IGJhc2VkIG9uIFZBIGNvbmZpZwor
CWZvciAoaSA9IDE7IGkgPCAxNjsgaSsrKSB7CisJCXZpcnRfY29uZmlnLnBhZ2VfdGFibGVfc3Rh
cnRfYWRkciA9IGNvbmZpZy0+dmFfY29uZmlnLnBhZ2VfdGFibGVfc3RhcnRfYWRkcjsKKwkJdmly
dF9jb25maWcucGFnZV90YWJsZV9lbmRfYWRkciA9IGNvbmZpZy0+dmFfY29uZmlnLnBhZ2VfdGFi
bGVfZW5kX2FkZHI7CisJCXZpcnRfY29uZmlnLmRlcHRoID0gY29uZmlnLT52YV9jb25maWcucGFn
ZV90YWJsZV9kZXB0aDsKKwkJdmlydF9jb25maWcuYmxvY2tfc2l6ZSA9IGNvbmZpZy0+dmFfY29u
ZmlnLnBhZ2VfdGFibGVfYmxvY2tfc2l6ZTsKKworCQlkY24yMF92bWlkX3NldHVwKCZodWJidWIx
LT52bWlkW2ldLCAmdmlydF9jb25maWcpOworCX0KK30KKwordm9pZCBodWJidWIyX3VwZGF0ZV9k
Y2h1YihzdHJ1Y3QgaHViYnViICpodWJidWIsCisJCXN0cnVjdCBkY2h1Yl9pbml0X2RhdGEgKmRo
X2RhdGEpCit7CisJc3RydWN0IGRjbjIwX2h1YmJ1YiAqaHViYnViMSA9IFRPX0RDTjIwX0hVQkJV
QihodWJidWIpOworCisJaWYgKFJFRyhEQ0hVQkJVQl9TRFBJRl9GQl9UT1ApID09IDApIHsKKwkJ
QVNTRVJUKGZhbHNlKTsKKwkJLypzaG91bGQgbm90IGNvbWUgaGVyZSovCisJCXJldHVybjsKKwl9
CisJLyogVE9ETzogcG9ydCBjb2RlIGZyb20gZGFsMiAqLworCXN3aXRjaCAoZGhfZGF0YS0+ZmJf
bW9kZSkgeworCWNhc2UgRlJBTUVfQlVGRkVSX01PREVfWkZCX09OTFk6CisJCS8qRm9yIFpGQiBj
YXNlIG5lZWQgdG8gcHV0IERDSFVCIEZCIEJBU0UgYW5kIFRPUCB1cHNpZGUgZG93biB0byBpbmRp
Y2F0ZSBaRkIgbW9kZSovCisJCVJFR19VUERBVEUoRENIVUJCVUJfU0RQSUZfRkJfVE9QLAorCQkJ
CVNEUElGX0ZCX1RPUCwgMCk7CisKKwkJUkVHX1VQREFURShEQ0hVQkJVQl9TRFBJRl9GQl9CQVNF
LAorCQkJCVNEUElGX0ZCX0JBU0UsIDB4MEZGRkYpOworCisJCVJFR19VUERBVEUoRENIVUJCVUJf
U0RQSUZfQUdQX0JBU0UsCisJCQkJU0RQSUZfQUdQX0JBU0UsIGRoX2RhdGEtPnpmYl9waHlzX2Fk
ZHJfYmFzZSA+PiAyMik7CisKKwkJUkVHX1VQREFURShEQ0hVQkJVQl9TRFBJRl9BR1BfQk9ULAor
CQkJCVNEUElGX0FHUF9CT1QsIGRoX2RhdGEtPnpmYl9tY19iYXNlX2FkZHIgPj4gMjIpOworCisJ
CVJFR19VUERBVEUoRENIVUJCVUJfU0RQSUZfQUdQX1RPUCwKKwkJCQlTRFBJRl9BR1BfVE9QLCAo
ZGhfZGF0YS0+emZiX21jX2Jhc2VfYWRkciArCisJCQkJCQlkaF9kYXRhLT56ZmJfc2l6ZV9pbl9i
eXRlIC0gMSkgPj4gMjIpOworCQlicmVhazsKKwljYXNlIEZSQU1FX0JVRkZFUl9NT0RFX01JWEVE
X1pGQl9BTkRfTE9DQUw6CisJCS8qU2hvdWxkIG5vdCB0b3VjaCBGQiBMT0NBVElPTiAoZG9uZSBi
eSBWQklPUyBvbiBBc2ljSW5pdCB0YWJsZSkqLworCisJCVJFR19VUERBVEUoRENIVUJCVUJfU0RQ
SUZfQUdQX0JBU0UsCisJCQkJU0RQSUZfQUdQX0JBU0UsIGRoX2RhdGEtPnpmYl9waHlzX2FkZHJf
YmFzZSA+PiAyMik7CisKKwkJUkVHX1VQREFURShEQ0hVQkJVQl9TRFBJRl9BR1BfQk9ULAorCQkJ
CVNEUElGX0FHUF9CT1QsIGRoX2RhdGEtPnpmYl9tY19iYXNlX2FkZHIgPj4gMjIpOworCisJCVJF
R19VUERBVEUoRENIVUJCVUJfU0RQSUZfQUdQX1RPUCwKKwkJCQlTRFBJRl9BR1BfVE9QLCAoZGhf
ZGF0YS0+emZiX21jX2Jhc2VfYWRkciArCisJCQkJCQlkaF9kYXRhLT56ZmJfc2l6ZV9pbl9ieXRl
IC0gMSkgPj4gMjIpOworCQlicmVhazsKKwljYXNlIEZSQU1FX0JVRkZFUl9NT0RFX0xPQ0FMX09O
TFk6CisJCS8qU2hvdWxkIG5vdCB0b3VjaCBGQiBMT0NBVElPTiAoZG9uZSBieSBWQklPUyBvbiBB
c2ljSW5pdCB0YWJsZSkqLworCQlSRUdfVVBEQVRFKERDSFVCQlVCX1NEUElGX0FHUF9CQVNFLAor
CQkJCVNEUElGX0FHUF9CQVNFLCAwKTsKKworCQlSRUdfVVBEQVRFKERDSFVCQlVCX1NEUElGX0FH
UF9CT1QsCisJCQkJU0RQSUZfQUdQX0JPVCwgMFgwM0ZGRkYpOworCisJCVJFR19VUERBVEUoRENI
VUJCVUJfU0RQSUZfQUdQX1RPUCwKKwkJCQlTRFBJRl9BR1BfVE9QLCAwKTsKKwkJYnJlYWs7CisJ
ZGVmYXVsdDoKKwkJYnJlYWs7CisJfQorCisJZGhfZGF0YS0+ZGNodWJfaW5pdGlhbHppZWQgPSB0
cnVlOworCWRoX2RhdGEtPmRjaHViX2luZm9fdmFsaWQgPSBmYWxzZTsKK30KKwordm9pZCBodWJi
dWIyX3dtX3JlYWRfc3RhdGUoc3RydWN0IGh1YmJ1YiAqaHViYnViLAorCQlzdHJ1Y3QgZGNuX2h1
YmJ1Yl93bSAqd20pCit7CisJc3RydWN0IGRjbjIwX2h1YmJ1YiAqaHViYnViMSA9IFRPX0RDTjIw
X0hVQkJVQihodWJidWIpOworCisJc3RydWN0IGRjbl9odWJidWJfd21fc2V0ICpzOworCisJbWVt
c2V0KHdtLCAwLCBzaXplb2Yoc3RydWN0IGRjbl9odWJidWJfd20pKTsKKworCXMgPSAmd20tPnNl
dHNbMF07CisJcy0+d21fc2V0ID0gMDsKKwlzLT5kYXRhX3VyZ2VudCA9IFJFR19SRUFEKERDSFVC
QlVCX0FSQl9EQVRBX1VSR0VOQ1lfV0FURVJNQVJLX0EpOworCWlmIChSRUcoRENIVUJCVUJfQVJC
X1BURV9NRVRBX1VSR0VOQ1lfV0FURVJNQVJLX0EpKQorCQlzLT5wdGVfbWV0YV91cmdlbnQgPSBS
RUdfUkVBRChEQ0hVQkJVQl9BUkJfUFRFX01FVEFfVVJHRU5DWV9XQVRFUk1BUktfQSk7CisJaWYg
KFJFRyhEQ0hVQkJVQl9BUkJfQUxMT1dfU1JfRU5URVJfV0FURVJNQVJLX0EpKSB7CisJCXMtPnNy
X2VudGVyID0gUkVHX1JFQUQoRENIVUJCVUJfQVJCX0FMTE9XX1NSX0VOVEVSX1dBVEVSTUFSS19B
KTsKKwkJcy0+c3JfZXhpdCA9IFJFR19SRUFEKERDSFVCQlVCX0FSQl9BTExPV19TUl9FWElUX1dB
VEVSTUFSS19BKTsKKwl9CisJcy0+ZHJhbV9jbGtfY2hhbmFnZSA9IFJFR19SRUFEKERDSFVCQlVC
X0FSQl9BTExPV19EUkFNX0NMS19DSEFOR0VfV0FURVJNQVJLX0EpOworCisJcyA9ICZ3bS0+c2V0
c1sxXTsKKwlzLT53bV9zZXQgPSAxOworCXMtPmRhdGFfdXJnZW50ID0gUkVHX1JFQUQoRENIVUJC
VUJfQVJCX0RBVEFfVVJHRU5DWV9XQVRFUk1BUktfQik7CisJaWYgKFJFRyhEQ0hVQkJVQl9BUkJf
UFRFX01FVEFfVVJHRU5DWV9XQVRFUk1BUktfQikpCisJCXMtPnB0ZV9tZXRhX3VyZ2VudCA9IFJF
R19SRUFEKERDSFVCQlVCX0FSQl9QVEVfTUVUQV9VUkdFTkNZX1dBVEVSTUFSS19CKTsKKwlpZiAo
UkVHKERDSFVCQlVCX0FSQl9BTExPV19TUl9FTlRFUl9XQVRFUk1BUktfQikpIHsKKwkJcy0+c3Jf
ZW50ZXIgPSBSRUdfUkVBRChEQ0hVQkJVQl9BUkJfQUxMT1dfU1JfRU5URVJfV0FURVJNQVJLX0Ip
OworCQlzLT5zcl9leGl0ID0gUkVHX1JFQUQoRENIVUJCVUJfQVJCX0FMTE9XX1NSX0VYSVRfV0FU
RVJNQVJLX0IpOworCX0KKwlzLT5kcmFtX2Nsa19jaGFuYWdlID0gUkVHX1JFQUQoRENIVUJCVUJf
QVJCX0FMTE9XX0RSQU1fQ0xLX0NIQU5HRV9XQVRFUk1BUktfQik7CisKKwlzID0gJndtLT5zZXRz
WzJdOworCXMtPndtX3NldCA9IDI7CisJcy0+ZGF0YV91cmdlbnQgPSBSRUdfUkVBRChEQ0hVQkJV
Ql9BUkJfREFUQV9VUkdFTkNZX1dBVEVSTUFSS19DKTsKKwlpZiAoUkVHKERDSFVCQlVCX0FSQl9Q
VEVfTUVUQV9VUkdFTkNZX1dBVEVSTUFSS19DKSkKKwkJcy0+cHRlX21ldGFfdXJnZW50ID0gUkVH
X1JFQUQoRENIVUJCVUJfQVJCX1BURV9NRVRBX1VSR0VOQ1lfV0FURVJNQVJLX0MpOworCWlmIChS
RUcoRENIVUJCVUJfQVJCX0FMTE9XX1NSX0VOVEVSX1dBVEVSTUFSS19DKSkgeworCQlzLT5zcl9l
bnRlciA9IFJFR19SRUFEKERDSFVCQlVCX0FSQl9BTExPV19TUl9FTlRFUl9XQVRFUk1BUktfQyk7
CisJCXMtPnNyX2V4aXQgPSBSRUdfUkVBRChEQ0hVQkJVQl9BUkJfQUxMT1dfU1JfRVhJVF9XQVRF
Uk1BUktfQyk7CisJfQorCXMtPmRyYW1fY2xrX2NoYW5hZ2UgPSBSRUdfUkVBRChEQ0hVQkJVQl9B
UkJfQUxMT1dfRFJBTV9DTEtfQ0hBTkdFX1dBVEVSTUFSS19DKTsKKworCXMgPSAmd20tPnNldHNb
M107CisJcy0+d21fc2V0ID0gMzsKKwlzLT5kYXRhX3VyZ2VudCA9IFJFR19SRUFEKERDSFVCQlVC
X0FSQl9EQVRBX1VSR0VOQ1lfV0FURVJNQVJLX0QpOworCWlmIChSRUcoRENIVUJCVUJfQVJCX1BU
RV9NRVRBX1VSR0VOQ1lfV0FURVJNQVJLX0QpKQorCQlzLT5wdGVfbWV0YV91cmdlbnQgPSBSRUdf
UkVBRChEQ0hVQkJVQl9BUkJfUFRFX01FVEFfVVJHRU5DWV9XQVRFUk1BUktfRCk7CisJaWYgKFJF
RyhEQ0hVQkJVQl9BUkJfQUxMT1dfU1JfRU5URVJfV0FURVJNQVJLX0QpKSB7CisJCXMtPnNyX2Vu
dGVyID0gUkVHX1JFQUQoRENIVUJCVUJfQVJCX0FMTE9XX1NSX0VOVEVSX1dBVEVSTUFSS19EKTsK
KwkJcy0+c3JfZXhpdCA9IFJFR19SRUFEKERDSFVCQlVCX0FSQl9BTExPV19TUl9FWElUX1dBVEVS
TUFSS19EKTsKKwl9CisJcy0+ZHJhbV9jbGtfY2hhbmFnZSA9IFJFR19SRUFEKERDSFVCQlVCX0FS
Ql9BTExPV19EUkFNX0NMS19DSEFOR0VfV0FURVJNQVJLX0QpOworfQorCit2b2lkIGh1YmJ1YjJf
Z2V0X2RjaHViX3JlZl9mcmVxKHN0cnVjdCBodWJidWIgKmh1YmJ1YiwKKwkJdW5zaWduZWQgaW50
IGRjY2dfcmVmX2ZyZXFfaW5LaHosCisJCXVuc2lnbmVkIGludCAqZGNodWJfcmVmX2ZyZXFfaW5L
aHopCit7CisJc3RydWN0IGRjbjIwX2h1YmJ1YiAqaHViYnViMSA9IFRPX0RDTjIwX0hVQkJVQiho
dWJidWIpOworCXVpbnQzMl90IHJlZl9kaXYgPSAwOworCXVpbnQzMl90IHJlZl9lbiA9IDA7CisK
KwlSRUdfR0VUXzIoRENIVUJCVUJfR0xPQkFMX1RJTUVSX0NOVEwsIERDSFVCQlVCX0dMT0JBTF9U
SU1FUl9SRUZESVYsICZyZWZfZGl2LAorCQkJRENIVUJCVUJfR0xPQkFMX1RJTUVSX0VOQUJMRSwg
JnJlZl9lbik7CisKKwlpZiAocmVmX2VuKSB7CisJCWlmIChyZWZfZGl2ID09IDIpCisJCQkqZGNo
dWJfcmVmX2ZyZXFfaW5LaHogPSBkY2NnX3JlZl9mcmVxX2luS2h6IC8gMjsKKwkJZWxzZQorCQkJ
KmRjaHViX3JlZl9mcmVxX2luS2h6ID0gZGNjZ19yZWZfZnJlcV9pbktoejsKKworCQkvLyBEQyBo
dWIgcmVmZXJlbmNlIGZyZXF1ZW5jeSBtdXN0IGJlIGFyb3VuZCA1ME1oeiwgb3RoZXJ3aXNlIHRo
ZXJlIG1heSBiZQorCQkvLyBvdmVyZmxvdy91bmRlcmZsb3cgaXNzdWVzIHdoZW4gZG9pbmcgSFVC
QlVCIHByb2dyYW1taW5nCisJCWlmICgqZGNodWJfcmVmX2ZyZXFfaW5LaHogPCA0MDAwMCB8fCAq
ZGNodWJfcmVmX2ZyZXFfaW5LaHogPiA2MDAwMCkKKwkJCUFTU0VSVF9DUklUSUNBTChmYWxzZSk7
CisKKwkJcmV0dXJuOworCX0gZWxzZSB7CisJCSpkY2h1Yl9yZWZfZnJlcV9pbktoeiA9IGRjY2df
cmVmX2ZyZXFfaW5LaHo7CisKKwkJLy8gSFVCQlVCIGdsb2JhbCB0aW1lciBtdXN0IGJlIGVuYWJs
ZWQuCisJCUFTU0VSVF9DUklUSUNBTChmYWxzZSk7CisJCXJldHVybjsKKwl9Cit9CisKK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgaHViYnViX2Z1bmNzIGh1YmJ1YjJfZnVuY3MgPSB7CisJLnVwZGF0ZV9k
Y2h1YiA9IGh1YmJ1YjJfdXBkYXRlX2RjaHViLAorCS5pbml0X2RjaHViID0gaHViYnViMl9pbml0
X2RjaHViLAorCS5zZXR1cF92bWlkX3B0YiA9IGh1YmJ1YjJfc2V0dXBfdm1pZF9wdGIsCisJLmRj
Y19zdXBwb3J0X3N3aXp6bGUgPSBodWJidWIyX2RjY19zdXBwb3J0X3N3aXp6bGUsCisJLmRjY19z
dXBwb3J0X3BpeGVsX2Zvcm1hdCA9IGh1YmJ1YjJfZGNjX3N1cHBvcnRfcGl4ZWxfZm9ybWF0LAor
CS5nZXRfZGNjX2NvbXByZXNzaW9uX2NhcCA9IGh1YmJ1YjJfZ2V0X2RjY19jb21wcmVzc2lvbl9j
YXAsCisJLndtX3JlYWRfc3RhdGUgPSBodWJidWIyX3dtX3JlYWRfc3RhdGUsCisJLmdldF9kY2h1
Yl9yZWZfZnJlcSA9IGh1YmJ1YjJfZ2V0X2RjaHViX3JlZl9mcmVxLAorCS5wcm9ncmFtX3dhdGVy
bWFya3MgPSBodWJidWIxX3Byb2dyYW1fd2F0ZXJtYXJrcywKK307CisKK3ZvaWQgaHViYnViMl9j
b25zdHJ1Y3Qoc3RydWN0IGRjbjIwX2h1YmJ1YiAqaHViYnViLAorCXN0cnVjdCBkY19jb250ZXh0
ICpjdHgsCisJY29uc3Qgc3RydWN0IGRjbl9odWJidWJfcmVnaXN0ZXJzICpodWJidWJfcmVncywK
Kwljb25zdCBzdHJ1Y3QgZGNuX2h1YmJ1Yl9zaGlmdCAqaHViYnViX3NoaWZ0LAorCWNvbnN0IHN0
cnVjdCBkY25faHViYnViX21hc2sgKmh1YmJ1Yl9tYXNrKQoreworCWh1YmJ1Yi0+YmFzZS5jdHgg
PSBjdHg7CisKKwlodWJidWItPmJhc2UuZnVuY3MgPSAmaHViYnViMl9mdW5jczsKKworCWh1YmJ1
Yi0+cmVncyA9IGh1YmJ1Yl9yZWdzOworCWh1YmJ1Yi0+c2hpZnRzID0gaHViYnViX3NoaWZ0Owor
CWh1YmJ1Yi0+bWFza3MgPSBodWJidWJfbWFzazsKKworCWh1YmJ1Yi0+ZGVidWdfdGVzdF9pbmRl
eF9wc3RhdGUgPSAweEI7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvZGNuMjAvZGNuMjBfaHViYnViLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvZGNuMjAvZGNuMjBfaHViYnViLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi42M2Q1MWFiNTcxMDMKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
YW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHViYnViLmgKQEAgLTAsMCArMSwxMDggQEAKKy8q
CisgKiBDb3B5cmlnaHQgMjAxNiBBZHZhbmNlZCBNaWNybyBEZXZpY2VzLCBJbmMuCisgKgorICog
UGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJz
b24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBk
b2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRoZSBT
b2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9u
CisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlz
dHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdh
cmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMgZnVy
bmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKyAq
CisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGlj
ZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgorICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0
aW9ucyBvZiB0aGUgU29mdHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJB
UyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyAqIElNUExJ
RUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hB
TlRBQklMSVRZLAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklO
RlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUgQ09QWVJJR0hUIEhPTERFUihT
KSBPUiBBVVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IKKyAqIE9U
SEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Ig
T1RIRVJXSVNFLAorICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRI
IFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SCisgKiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09G
VFdBUkUuCisgKgorICogQXV0aG9yczogQU1ECisgKgorICovCisKKyNpZm5kZWYgX19EQ19IVUJC
VUJfRENOMjBfSF9fCisjZGVmaW5lIF9fRENfSFVCQlVCX0RDTjIwX0hfXworCisjaW5jbHVkZSAi
ZGNuMTAvZGNuMTBfaHViYnViLmgiCisjaW5jbHVkZSAiZGNuMjBfdm1pZC5oIgorCisjZGVmaW5l
IFRPX0RDTjIwX0hVQkJVQihodWJidWIpXAorCWNvbnRhaW5lcl9vZihodWJidWIsIHN0cnVjdCBk
Y24yMF9odWJidWIsIGJhc2UpCisKKyNkZWZpbmUgVE9fRENOMjBfSFVCQlVCKGh1YmJ1YilcCisJ
Y29udGFpbmVyX29mKGh1YmJ1Yiwgc3RydWN0IGRjbjIwX2h1YmJ1YiwgYmFzZSkKKworI2RlZmlu
ZSBIVUJCVUJfUkVHX0xJU1RfRENOMjAoaWQpXAorCUhVQkJVQl9SRUdfTElTVF9EQ05fQ09NTU9O
KCksIFwKKwlIVUJCVUJfVk1fUkVHX0xJU1QoKSwgXAorCUhVQkJVQl9TUl9XQVRFUk1BUktfUkVH
X0xJU1QoKSwgXAorCVNSKERDSFVCQlVCX0NSQ19DVFJMKSwgXAorCVNSKERDTl9WTV9GQl9MT0NB
VElPTl9CQVNFKSxcCisJU1IoRENOX1ZNX0ZCX0xPQ0FUSU9OX1RPUCksXAorCVNSKERDTl9WTV9G
Ql9PRkZTRVQpLFwKKwlTUihEQ05fVk1fQUdQX0JPVCksXAorCVNSKERDTl9WTV9BR1BfVE9QKSxc
CisJU1IoRENOX1ZNX0FHUF9CQVNFKQorCisjZGVmaW5lIEhVQkJVQl9NQVNLX1NIX0xJU1RfRENO
MjAobWFza19zaClcCisJSFVCQlVCX01BU0tfU0hfTElTVF9EQ05fQ09NTU9OKG1hc2tfc2gpLCBc
CisJSFVCQlVCX01BU0tfU0hfTElTVF9TVFVUVEVSKG1hc2tfc2gpLCBcCisJSFVCQlVCX1NGKERD
SFVCQlVCX0dMT0JBTF9USU1FUl9DTlRMLCBEQ0hVQkJVQl9HTE9CQUxfVElNRVJfUkVGRElWLCBt
YXNrX3NoKSwgXAorCUhVQkJVQl9TRihEQ05fVk1fRkJfTE9DQVRJT05fQkFTRSwgRkJfQkFTRSwg
bWFza19zaCksIFwKKwlIVUJCVUJfU0YoRENOX1ZNX0ZCX0xPQ0FUSU9OX1RPUCwgRkJfVE9QLCBt
YXNrX3NoKSwgXAorCUhVQkJVQl9TRihEQ05fVk1fRkJfT0ZGU0VULCBGQl9PRkZTRVQsIG1hc2tf
c2gpLCBcCisJSFVCQlVCX1NGKERDTl9WTV9BR1BfQk9ULCBBR1BfQk9ULCBtYXNrX3NoKSwgXAor
CUhVQkJVQl9TRihEQ05fVk1fQUdQX1RPUCwgQUdQX1RPUCwgbWFza19zaCksIFwKKwlIVUJCVUJf
U0YoRENOX1ZNX0FHUF9CQVNFLCBBR1BfQkFTRSwgbWFza19zaCkKKworc3RydWN0IGRjbjIwX2h1
YmJ1YiB7CisJc3RydWN0IGh1YmJ1YiBiYXNlOworCWNvbnN0IHN0cnVjdCBkY25faHViYnViX3Jl
Z2lzdGVycyAqcmVnczsKKwljb25zdCBzdHJ1Y3QgZGNuX2h1YmJ1Yl9zaGlmdCAqc2hpZnRzOwor
CWNvbnN0IHN0cnVjdCBkY25faHViYnViX21hc2sgKm1hc2tzOworCXVuc2lnbmVkIGludCBkZWJ1
Z190ZXN0X2luZGV4X3BzdGF0ZTsKKwlzdHJ1Y3QgZGNuX3dhdGVybWFya19zZXQgd2F0ZXJtYXJr
czsKKwlzdHJ1Y3QgZGNuMjBfdm1pZCB2bWlkWzE2XTsKK307CisKK3ZvaWQgaHViYnViMl9jb25z
dHJ1Y3Qoc3RydWN0IGRjbjIwX2h1YmJ1YiAqaHViYnViLAorCXN0cnVjdCBkY19jb250ZXh0ICpj
dHgsCisJY29uc3Qgc3RydWN0IGRjbl9odWJidWJfcmVnaXN0ZXJzICpodWJidWJfcmVncywKKwlj
b25zdCBzdHJ1Y3QgZGNuX2h1YmJ1Yl9zaGlmdCAqaHViYnViX3NoaWZ0LAorCWNvbnN0IHN0cnVj
dCBkY25faHViYnViX21hc2sgKmh1YmJ1Yl9tYXNrKTsKKworYm9vbCBodWJidWIyX2RjY19zdXBw
b3J0X3N3aXp6bGUoCisJCWVudW0gc3dpenpsZV9tb2RlX3ZhbHVlcyBzd2l6emxlLAorCQl1bnNp
Z25lZCBpbnQgYnl0ZXNfcGVyX2VsZW1lbnQsCisJCWVudW0gc2VnbWVudF9vcmRlciAqc2VnbWVu
dF9vcmRlcl9ob3J6LAorCQllbnVtIHNlZ21lbnRfb3JkZXIgKnNlZ21lbnRfb3JkZXJfdmVydCk7
CisKK2Jvb2wgaHViYnViMl9kY2Nfc3VwcG9ydF9waXhlbF9mb3JtYXQoCisJCWVudW0gc3VyZmFj
ZV9waXhlbF9mb3JtYXQgZm9ybWF0LAorCQl1bnNpZ25lZCBpbnQgKmJ5dGVzX3Blcl9lbGVtZW50
KTsKKworYm9vbCBodWJidWIyX2dldF9kY2NfY29tcHJlc3Npb25fY2FwKHN0cnVjdCBodWJidWIg
Kmh1YmJ1YiwKKwkJY29uc3Qgc3RydWN0IGRjX2RjY19zdXJmYWNlX3BhcmFtICppbnB1dCwKKwkJ
c3RydWN0IGRjX3N1cmZhY2VfZGNjX2NhcCAqb3V0cHV0KTsKKworYm9vbCBodWJidWIyX2luaXRp
YWxpemVfdm1pZHMoc3RydWN0IGh1YmJ1YiAqaHViYnViLAorCQljb25zdCBzdHJ1Y3QgZGNfZGNj
X3N1cmZhY2VfcGFyYW0gKmlucHV0LAorCQlzdHJ1Y3QgZGNfc3VyZmFjZV9kY2NfY2FwICpvdXRw
dXQpOworCit2b2lkIGh1YmJ1YjJfaW5pdF9kY2h1YihzdHJ1Y3QgaHViYnViICpodWJidWIsCisJ
CXN0cnVjdCBodWJidWJfYWRkcl9jb25maWcgKmNvbmZpZyk7CisKK3ZvaWQgaHViYnViMl91cGRh
dGVfZGNodWIoc3RydWN0IGh1YmJ1YiAqaHViYnViLAorCQlzdHJ1Y3QgZGNodWJfaW5pdF9kYXRh
ICpkaF9kYXRhKTsKKwordm9pZCBodWJidWIyX2dldF9kY2h1Yl9yZWZfZnJlcShzdHJ1Y3QgaHVi
YnViICpodWJidWIsCisJCXVuc2lnbmVkIGludCBkY2NnX3JlZl9mcmVxX2luS2h6LAorCQl1bnNp
Z25lZCBpbnQgKmRjaHViX3JlZl9mcmVxX2luS2h6KTsKKwordm9pZCBodWJidWIyX3dtX3JlYWRf
c3RhdGUoc3RydWN0IGh1YmJ1YiAqaHViYnViLAorCQlzdHJ1Y3QgZGNuX2h1YmJ1Yl93bSAqd20p
OworCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9k
Y24yMC9kY24yMF9odWJwLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAv
ZGNuMjBfaHVicC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uY2Fi
ZDA3MGJjNjU5Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9kaXNwbGF5
L2RjL2RjbjIwL2RjbjIwX2h1YnAuYwpAQCAtMCwwICsxLDY5OSBAQAorLyoKKyAqIENvcHlyaWdo
dCAyMDEyLTE3IEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4KKyAqCisgKiBQZXJtaXNzaW9u
IGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5p
bmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRp
b24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdp
dGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAqIHRoZSBy
aWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBz
dWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRv
IHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8g
ZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAqIFRoZSBh
Ym92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJl
IGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRo
ZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lU
SE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwgSU5DTFVE
SU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFks
CisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5U
LiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBDT1BZUklHSFQgSE9MREVSKFMpIE9SIEFVVEhP
UihTKSBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUgorICogT1RIRVIgTElBQklM
SVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0Us
CisgKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRX
QVJFIE9SIFRIRSBVU0UgT1IKKyAqIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KKyAq
CisgKiBBdXRob3JzOiBBTUQKKyAqCisgKi8KKworI2luY2x1ZGUgImRjbjIwX2h1YnAuaCIKKwor
I2luY2x1ZGUgImRtX3NlcnZpY2VzLmgiCisjaW5jbHVkZSAiZGNlX2NhbGNzLmgiCisjaW5jbHVk
ZSAicmVnX2hlbHBlci5oIgorI2luY2x1ZGUgImJhc2ljcy9jb252ZXJzaW9uLmgiCisKKyNkZWZp
bmUgUkVHKHJlZylcCisJaHVicDItPmh1YnBfcmVncy0+cmVnCisKKyNkZWZpbmUgQ1RYIFwKKwlo
dWJwMi0+YmFzZS5jdHgKKworI3VuZGVmIEZOCisjZGVmaW5lIEZOKHJlZ19uYW1lLCBmaWVsZF9u
YW1lKSBcCisJaHVicDItPmh1YnBfc2hpZnQtPmZpZWxkX25hbWUsIGh1YnAyLT5odWJwX21hc2st
PmZpZWxkX25hbWUKKwordm9pZCBodWJwMl91cGRhdGVfZGNodWIoCisJc3RydWN0IGh1YnAgKmh1
YnAsCisJc3RydWN0IGRjaHViX2luaXRfZGF0YSAqZGhfZGF0YSkKK3sKKwlzdHJ1Y3QgZGNuMjBf
aHVicCAqaHVicDIgPSBUT19EQ04yMF9IVUJQKGh1YnApOworCWlmIChSRUcoRENOX1ZNX0ZCX0xP
Q0FUSU9OX1RPUCkgPT0gMCkKKwkJcmV0dXJuOworCisJc3dpdGNoIChkaF9kYXRhLT5mYl9tb2Rl
KSB7CisJY2FzZSBGUkFNRV9CVUZGRVJfTU9ERV9aRkJfT05MWToKKwkJLypGb3IgWkZCIGNhc2Ug
bmVlZCB0byBwdXQgRENIVUIgRkIgQkFTRSBhbmQgVE9QIHVwc2lkZSBkb3duIHRvIGluZGljYXRl
IFpGQiBtb2RlKi8KKwkJUkVHX1VQREFURShEQ05fVk1fRkJfTE9DQVRJT05fVE9QLAorCQkJCUZC
X1RPUCwgMCk7CisKKwkJUkVHX1VQREFURShEQ05fVk1fRkJfTE9DQVRJT05fQkFTRSwKKwkJCQlG
Ql9CQVNFLCAweEZGRkZGRik7CisKKwkJLypUaGlzIGZpZWxkIGRlZmluZXMgdGhlIDI0IE1TQnMs
IGJpdHMgWzQ3OjI0XSBvZiB0aGUgNDggYml0IEFHUCBCYXNlKi8KKwkJUkVHX1VQREFURShEQ05f
Vk1fQUdQX0JBU0UsCisJCQkJQUdQX0JBU0UsIGRoX2RhdGEtPnpmYl9waHlzX2FkZHJfYmFzZSA+
PiAyNCk7CisKKwkJLypUaGlzIGZpZWxkIGRlZmluZXMgdGhlIGJvdHRvbSByYW5nZSBvZiB0aGUg
QUdQIGFwZXJ0dXJlIGFuZCByZXByZXNlbnRzIHRoZSAyNCovCisJCS8qTVNCcywgYml0cyBbNDc6
MjRdIG9mIHRoZSA0OCBhZGRyZXNzIGJpdHMqLworCQlSRUdfVVBEQVRFKERDTl9WTV9BR1BfQk9U
LAorCQkJCUFHUF9CT1QsIGRoX2RhdGEtPnpmYl9tY19iYXNlX2FkZHIgPj4gMjQpOworCisJCS8q
VGhpcyBmaWVsZCBkZWZpbmVzIHRoZSB0b3AgcmFuZ2Ugb2YgdGhlIEFHUCBhcGVydHVyZSBhbmQg
cmVwcmVzZW50cyB0aGUgMjQqLworCQkvKk1TQnMsIGJpdHMgWzQ3OjI0XSBvZiB0aGUgNDggYWRk
cmVzcyBiaXRzKi8KKwkJUkVHX1VQREFURShEQ05fVk1fQUdQX1RPUCwKKwkJCQlBR1BfVE9QLCAo
ZGhfZGF0YS0+emZiX21jX2Jhc2VfYWRkciArCisJCQkJCQlkaF9kYXRhLT56ZmJfc2l6ZV9pbl9i
eXRlIC0gMSkgPj4gMjQpOworCQlicmVhazsKKwljYXNlIEZSQU1FX0JVRkZFUl9NT0RFX01JWEVE
X1pGQl9BTkRfTE9DQUw6CisJCS8qU2hvdWxkIG5vdCB0b3VjaCBGQiBMT0NBVElPTiAoZG9uZSBi
eSBWQklPUyBvbiBBc2ljSW5pdCB0YWJsZSkqLworCisJCS8qVGhpcyBmaWVsZCBkZWZpbmVzIHRo
ZSAyNCBNU0JzLCBiaXRzIFs0NzoyNF0gb2YgdGhlIDQ4IGJpdCBBR1AgQmFzZSovCisJCVJFR19V
UERBVEUoRENOX1ZNX0FHUF9CQVNFLAorCQkJCUFHUF9CQVNFLCBkaF9kYXRhLT56ZmJfcGh5c19h
ZGRyX2Jhc2UgPj4gMjQpOworCisJCS8qVGhpcyBmaWVsZCBkZWZpbmVzIHRoZSBib3R0b20gcmFu
Z2Ugb2YgdGhlIEFHUCBhcGVydHVyZSBhbmQgcmVwcmVzZW50cyB0aGUgMjQqLworCQkvKk1TQnMs
IGJpdHMgWzQ3OjI0XSBvZiB0aGUgNDggYWRkcmVzcyBiaXRzKi8KKwkJUkVHX1VQREFURShEQ05f
Vk1fQUdQX0JPVCwKKwkJCQlBR1BfQk9ULCBkaF9kYXRhLT56ZmJfbWNfYmFzZV9hZGRyID4+IDI0
KTsKKworCQkvKlRoaXMgZmllbGQgZGVmaW5lcyB0aGUgdG9wIHJhbmdlIG9mIHRoZSBBR1AgYXBl
cnR1cmUgYW5kIHJlcHJlc2VudHMgdGhlIDI0Ki8KKwkJLypNU0JzLCBiaXRzIFs0NzoyNF0gb2Yg
dGhlIDQ4IGFkZHJlc3MgYml0cyovCisJCVJFR19VUERBVEUoRENOX1ZNX0FHUF9UT1AsCisJCQkJ
QUdQX1RPUCwgKGRoX2RhdGEtPnpmYl9tY19iYXNlX2FkZHIgKworCQkJCQkJZGhfZGF0YS0+emZi
X3NpemVfaW5fYnl0ZSAtIDEpID4+IDI0KTsKKwkJYnJlYWs7CisJY2FzZSBGUkFNRV9CVUZGRVJf
TU9ERV9MT0NBTF9PTkxZOgorCQkvKlNob3VsZCBub3QgdG91Y2ggRkIgTE9DQVRJT04gKHNob3Vs
ZCBiZSBkb25lIGJ5IFZCSU9TKSovCisKKwkJLypUaGlzIGZpZWxkIGRlZmluZXMgdGhlIDI0IE1T
QnMsIGJpdHMgWzQ3OjI0XSBvZiB0aGUgNDggYml0IEFHUCBCYXNlKi8KKwkJUkVHX1VQREFURShE
Q05fVk1fQUdQX0JBU0UsCisJCQkJQUdQX0JBU0UsIDApOworCisJCS8qVGhpcyBmaWVsZCBkZWZp
bmVzIHRoZSBib3R0b20gcmFuZ2Ugb2YgdGhlIEFHUCBhcGVydHVyZSBhbmQgcmVwcmVzZW50cyB0
aGUgMjQqLworCQkvKk1TQnMsIGJpdHMgWzQ3OjI0XSBvZiB0aGUgNDggYWRkcmVzcyBiaXRzKi8K
KwkJUkVHX1VQREFURShEQ05fVk1fQUdQX0JPVCwKKwkJCQlBR1BfQk9ULCAweEZGRkZGRik7CisK
KwkJLypUaGlzIGZpZWxkIGRlZmluZXMgdGhlIHRvcCByYW5nZSBvZiB0aGUgQUdQIGFwZXJ0dXJl
IGFuZCByZXByZXNlbnRzIHRoZSAyNCovCisJCS8qTVNCcywgYml0cyBbNDc6MjRdIG9mIHRoZSA0
OCBhZGRyZXNzIGJpdHMqLworCQlSRUdfVVBEQVRFKERDTl9WTV9BR1BfVE9QLAorCQkJCUFHUF9U
T1AsIDApOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlicmVhazsKKwl9CisKKwlkaF9kYXRhLT5k
Y2h1Yl9pbml0aWFsemllZCA9IHRydWU7CisJZGhfZGF0YS0+ZGNodWJfaW5mb192YWxpZCA9IGZh
bHNlOworfQorCit2b2lkIGh1YnAyX3NldF92bV9zeXN0ZW1fYXBlcnR1cmVfc2V0dGluZ3Moc3Ry
dWN0IGh1YnAgKmh1YnAsCisJCXN0cnVjdCB2bV9zeXN0ZW1fYXBlcnR1cmVfcGFyYW0gKmFwdCkK
K3sKKwlzdHJ1Y3QgZGNuMjBfaHVicCAqaHVicDIgPSBUT19EQ04yMF9IVUJQKGh1YnApOworCisJ
UEhZU0lDQUxfQUREUkVTU19MT0MgbWNfdm1fYXB0X2RlZmF1bHQ7CisJUEhZU0lDQUxfQUREUkVT
U19MT0MgbWNfdm1fYXB0X2xvdzsKKwlQSFlTSUNBTF9BRERSRVNTX0xPQyBtY192bV9hcHRfaGln
aDsKKworCS8vIFRoZSBmb3JtYXQgb2YgZGVmYXVsdCBhZGRyIGlzIDQ4OjEyIG9mIHRoZSA0OCBi
aXQgYWRkcgorCW1jX3ZtX2FwdF9kZWZhdWx0LnF1YWRfcGFydCA9IGFwdC0+c3lzX2RlZmF1bHQu
cXVhZF9wYXJ0ID4+IDEyOworCisJLy8gVGhlIGZvcm1hdCBvZiBoaWdoL2xvdyBhcmUgNDg6MTgg
b2YgdGhlIDQ4IGJpdCBhZGRyCisJbWNfdm1fYXB0X2xvdy5xdWFkX3BhcnQgPSBhcHQtPnN5c19s
b3cucXVhZF9wYXJ0ID4+IDE4OworCW1jX3ZtX2FwdF9oaWdoLnF1YWRfcGFydCA9IGFwdC0+c3lz
X2hpZ2gucXVhZF9wYXJ0ID4+IDE4OworCisJUkVHX1VQREFURV8yKERDTl9WTV9TWVNURU1fQVBF
UlRVUkVfREVGQVVMVF9BRERSX01TQiwKKwkJRENOX1ZNX1NZU1RFTV9BUEVSVFVSRV9ERUZBVUxU
X1NZU1RFTSwgMSwgLyogMSA9IHN5c3RlbSBwaHlzaWNhbCBtZW1vcnkgKi8KKwkJRENOX1ZNX1NZ
U1RFTV9BUEVSVFVSRV9ERUZBVUxUX0FERFJfTVNCLCBtY192bV9hcHRfZGVmYXVsdC5oaWdoX3Bh
cnQpOworCisJUkVHX1NFVChEQ05fVk1fU1lTVEVNX0FQRVJUVVJFX0RFRkFVTFRfQUREUl9MU0Is
IDAsCisJCQlEQ05fVk1fU1lTVEVNX0FQRVJUVVJFX0RFRkFVTFRfQUREUl9MU0IsIG1jX3ZtX2Fw
dF9kZWZhdWx0Lmxvd19wYXJ0KTsKKworCVJFR19TRVQoRENOX1ZNX1NZU1RFTV9BUEVSVFVSRV9M
T1dfQUREUiwgMCwKKwkJCU1DX1ZNX1NZU1RFTV9BUEVSVFVSRV9MT1dfQUREUiwgbWNfdm1fYXB0
X2xvdy5xdWFkX3BhcnQpOworCisJUkVHX1NFVChEQ05fVk1fU1lTVEVNX0FQRVJUVVJFX0hJR0hf
QUREUiwgMCwKKwkJCU1DX1ZNX1NZU1RFTV9BUEVSVFVSRV9ISUdIX0FERFIsIG1jX3ZtX2FwdF9o
aWdoLnF1YWRfcGFydCk7CisKKwlSRUdfU0VUXzIoRENOX1ZNX01YX0wxX1RMQl9DTlRMLCAwLAor
CQkJRU5BQkxFX0wxX1RMQiwgMSwKKwkJCVNZU1RFTV9BQ0NFU1NfTU9ERSwgMHgzKTsKK30KKwor
c3RhdGljIHZvaWQgaHVicDJfcHJvZ3JhbV9kZWFkbGluZSgKKwkJc3RydWN0IGh1YnAgKmh1YnAs
CisJCXN0cnVjdCBfdmNzX2RwaV9kaXNwbGF5X2RsZ19yZWdzX3N0ICpkbGdfYXR0ciwKKwkJc3Ry
dWN0IF92Y3NfZHBpX2Rpc3BsYXlfdHR1X3JlZ3Nfc3QgKnR0dV9hdHRyKQoreworCXN0cnVjdCBk
Y24yMF9odWJwICpodWJwMiA9IFRPX0RDTjIwX0hVQlAoaHVicCk7CisKKwlodWJwMV9wcm9ncmFt
X2RlYWRsaW5lKGh1YnAsIGRsZ19hdHRyLCB0dHVfYXR0cik7CisKKwlSRUdfU0VUKEZMSVBfUEFS
QU1FVEVSU18xLCAwLAorCQlSRUZDWUNfUEVSX1BURV9HUk9VUF9GTElQX0wsIGRsZ19hdHRyLT5y
ZWZjeWNfcGVyX3B0ZV9ncm91cF9mbGlwX2wpOworfQorCit2b2lkIGh1YnAyX3ZyZWFkeV9hdF9v
cl9BZnRlcl92c3luYyhzdHJ1Y3QgaHVicCAqaHVicCwKKwkJc3RydWN0IF92Y3NfZHBpX2Rpc3Bs
YXlfcGlwZV9kZXN0X3BhcmFtc19zdCAqcGlwZV9kZXN0KQoreworCXVpbnQzMl90IHZhbHVlID0g
MDsKKwlzdHJ1Y3QgZGNuMjBfaHVicCAqaHVicDIgPSBUT19EQ04yMF9IVUJQKGh1YnApOworCS8q
IGRpc2FibGVfZGxnX3Rlc3RfbW9kZSBTZXQgOXRoIGJpdCB0byAxIHRvIGRpc2FibGUgImR2IiBt
b2RlICovCisJUkVHX1dSSVRFKEhVQlBSRVFfREVCVUdfREIsIDEgPDwgOCk7CisJLyoKKwlpZiAo
VlNUQVJUVVBfU1RBUlQgLSAoVlJFQURZX09GRlNFVCtWVVBEQVRFX1dJRFRIK1ZVUERBVEVfT0ZG
U0VUKS9odG90YWwpCisJPD0gT1RHX1ZfQkxBTktfRU5ECisJCVNldCBIVUJQX1ZSRUFEWV9BVF9P
Ul9BRlRFUl9WU1lOQyA9IDEKKwllbHNlCisJCVNldCBIVUJQX1ZSRUFEWV9BVF9PUl9BRlRFUl9W
U1lOQyA9IDAKKwkqLworCWlmICgocGlwZV9kZXN0LT52c3RhcnR1cF9zdGFydCAtIChwaXBlX2Rl
c3QtPnZyZWFkeV9vZmZzZXQrcGlwZV9kZXN0LT52dXBkYXRlX3dpZHRoCisJCSsgcGlwZV9kZXN0
LT52dXBkYXRlX29mZnNldCkgLyBwaXBlX2Rlc3QtPmh0b3RhbCkgPD0gcGlwZV9kZXN0LT52Ymxh
bmtfZW5kKSB7CisJCXZhbHVlID0gMTsKKwl9IGVsc2UKKwkJdmFsdWUgPSAwOworCVJFR19VUERB
VEUoRENIVUJQX0NOVEwsIEhVQlBfVlJFQURZX0FUX09SX0FGVEVSX1ZTWU5DLCB2YWx1ZSk7Cit9
CisKK3N0YXRpYyB2b2lkIGh1YnAyX3NldHVwKAorCQlzdHJ1Y3QgaHVicCAqaHVicCwKKwkJc3Ry
dWN0IF92Y3NfZHBpX2Rpc3BsYXlfZGxnX3JlZ3Nfc3QgKmRsZ19hdHRyLAorCQlzdHJ1Y3QgX3Zj
c19kcGlfZGlzcGxheV90dHVfcmVnc19zdCAqdHR1X2F0dHIsCisJCXN0cnVjdCBfdmNzX2RwaV9k
aXNwbGF5X3JxX3JlZ3Nfc3QgKnJxX3JlZ3MsCisJCXN0cnVjdCBfdmNzX2RwaV9kaXNwbGF5X3Bp
cGVfZGVzdF9wYXJhbXNfc3QgKnBpcGVfZGVzdCkKK3sKKwkvKiBvdGcgaXMgbG9ja2VkIHdoZW4g
dGhpcyBmdW5jIGlzIGNhbGxlZC4gUmVnaXN0ZXIgYXJlIGRvdWJsZSBidWZmZXJlZC4KKwkgKiBk
aXNhYmxlIHRoZSByZXF1ZXN0b3JzIGlzIG5vdCBuZWVkZWQKKwkgKi8KKworCWh1YnAyX3ZyZWFk
eV9hdF9vcl9BZnRlcl92c3luYyhodWJwLCBwaXBlX2Rlc3QpOworCWh1YnAxX3Byb2dyYW1fcmVx
dWVzdG9yKGh1YnAsIHJxX3JlZ3MpOworCWh1YnAyX3Byb2dyYW1fZGVhZGxpbmUoaHVicCwgZGxn
X2F0dHIsIHR0dV9hdHRyKTsKKworfQorCit2b2lkIGh1YnAyX3NldHVwX2ludGVyZGVwZW5kZW50
KAorCQlzdHJ1Y3QgaHVicCAqaHVicCwKKwkJc3RydWN0IF92Y3NfZHBpX2Rpc3BsYXlfZGxnX3Jl
Z3Nfc3QgKmRsZ19hdHRyLAorCQlzdHJ1Y3QgX3Zjc19kcGlfZGlzcGxheV90dHVfcmVnc19zdCAq
dHR1X2F0dHIpCit7CisJc3RydWN0IGRjbjIwX2h1YnAgKmh1YnAyID0gVE9fRENOMjBfSFVCUCho
dWJwKTsKKworCVJFR19TRVRfMihQUkVGRVRDSF9TRVRUSU5HUywgMCwKKwkJCURTVF9ZX1BSRUZF
VENILCBkbGdfYXR0ci0+ZHN0X3lfcHJlZmV0Y2gsCisJCQlWUkFUSU9fUFJFRkVUQ0gsIGRsZ19h
dHRyLT52cmF0aW9fcHJlZmV0Y2gpOworCisJUkVHX1NFVChQUkVGRVRDSF9TRVRUSU5HU19DLCAw
LAorCQkJVlJBVElPX1BSRUZFVENIX0MsIGRsZ19hdHRyLT52cmF0aW9fcHJlZmV0Y2hfYyk7CisK
KwlSRUdfU0VUXzIoVkJMQU5LX1BBUkFNRVRFUlNfMCwgMCwKKwkJRFNUX1lfUEVSX1ZNX1ZCTEFO
SywgZGxnX2F0dHItPmRzdF95X3Blcl92bV92YmxhbmssCisJCURTVF9ZX1BFUl9ST1dfVkJMQU5L
LCBkbGdfYXR0ci0+ZHN0X3lfcGVyX3Jvd192YmxhbmspOworCisJUkVHX1NFVF8yKEZMSVBfUEFS
QU1FVEVSU18wLCAwLAorCQlEU1RfWV9QRVJfVk1fRkxJUCwgZGxnX2F0dHItPmRzdF95X3Blcl92
bV9mbGlwLAorCQlEU1RfWV9QRVJfUk9XX0ZMSVAsIGRsZ19hdHRyLT5kc3RfeV9wZXJfcm93X2Zs
aXApOworCisJUkVHX1NFVChWQkxBTktfUEFSQU1FVEVSU18zLCAwLAorCQlSRUZDWUNfUEVSX01F
VEFfQ0hVTktfVkJMQU5LX0wsIGRsZ19hdHRyLT5yZWZjeWNfcGVyX21ldGFfY2h1bmtfdmJsYW5r
X2wpOworCisJUkVHX1NFVChWQkxBTktfUEFSQU1FVEVSU180LCAwLAorCQlSRUZDWUNfUEVSX01F
VEFfQ0hVTktfVkJMQU5LX0MsIGRsZ19hdHRyLT5yZWZjeWNfcGVyX21ldGFfY2h1bmtfdmJsYW5r
X2MpOworCisJUkVHX1NFVChGTElQX1BBUkFNRVRFUlNfMiwgMCwKKwkJUkVGQ1lDX1BFUl9NRVRB
X0NIVU5LX0ZMSVBfTCwgZGxnX2F0dHItPnJlZmN5Y19wZXJfbWV0YV9jaHVua19mbGlwX2wpOwor
CisJUkVHX1NFVF8yKFBFUl9MSU5FX0RFTElWRVJZX1BSRSwgMCwKKwkJUkVGQ1lDX1BFUl9MSU5F
X0RFTElWRVJZX1BSRV9MLCBkbGdfYXR0ci0+cmVmY3ljX3Blcl9saW5lX2RlbGl2ZXJ5X3ByZV9s
LAorCQlSRUZDWUNfUEVSX0xJTkVfREVMSVZFUllfUFJFX0MsIGRsZ19hdHRyLT5yZWZjeWNfcGVy
X2xpbmVfZGVsaXZlcnlfcHJlX2MpOworCisJUkVHX1NFVChEQ05fU1VSRjBfVFRVX0NOVEwxLCAw
LAorCQlSRUZDWUNfUEVSX1JFUV9ERUxJVkVSWV9QUkUsCisJCXR0dV9hdHRyLT5yZWZjeWNfcGVy
X3JlcV9kZWxpdmVyeV9wcmVfbCk7CisJUkVHX1NFVChEQ05fU1VSRjFfVFRVX0NOVEwxLCAwLAor
CQlSRUZDWUNfUEVSX1JFUV9ERUxJVkVSWV9QUkUsCisJCXR0dV9hdHRyLT5yZWZjeWNfcGVyX3Jl
cV9kZWxpdmVyeV9wcmVfYyk7CisJUkVHX1NFVChEQ05fQ1VSMF9UVFVfQ05UTDEsIDAsCisJCVJF
RkNZQ19QRVJfUkVRX0RFTElWRVJZX1BSRSwgdHR1X2F0dHItPnJlZmN5Y19wZXJfcmVxX2RlbGl2
ZXJ5X3ByZV9jdXIwKTsKKwlSRUdfU0VUKERDTl9DVVIxX1RUVV9DTlRMMSwgMCwKKwkJUkVGQ1lD
X1BFUl9SRVFfREVMSVZFUllfUFJFLCB0dHVfYXR0ci0+cmVmY3ljX3Blcl9yZXFfZGVsaXZlcnlf
cHJlX2N1cjEpOworCisJUkVHX1NFVF8yKERDTl9HTE9CQUxfVFRVX0NOVEwsIDAsCisJCU1JTl9U
VFVfVkJMQU5LLCB0dHVfYXR0ci0+bWluX3R0dV92YmxhbmssCisJCVFvU19MRVZFTF9GTElQLCB0
dHVfYXR0ci0+cW9zX2xldmVsX2ZsaXApOworfQorCisvKiBEQ04yIChHRlgxMCksIHRoZSBmb2xs
b3dpbmcgR0ZYIGZpZWxkcyBhcmUgZGVwcmVjYXRlZC4gVGhleSBjYW4gYmUgc2V0IGJ1dCB0aGV5
IHdpbGwgbm90IGJlIHVzZWQ6CisgKglOVU1fQkFOS1MKKyAqCU5VTV9TRQorICoJTlVNX1JCX1BF
Ul9TRQorICoJUkJfQUxJR05FRAorICogT3RoZXIgdGhpbmdzIGNhbiBiZSBkZWZhdWx0ZWQsIHNp
bmNlIHRoZXkgbmV2ZXIgY2hhbmdlOgorICoJUElQRV9BTElHTkVEID0gMAorICoJTUVUQV9MSU5F
QVIgPSAwCisgKiBJbiBHRlgxMCwgb25seSB0aGVzZSBhcHBseToKKyAqCVBJUEVfSU5URVJMRUFW
RQorICoJTlVNX1BJUEVTCisgKglNQVhfQ09NUFJFU1NFRF9GUkFHUworICoJU1dfTU9ERQorICov
CitzdGF0aWMgdm9pZCBodWJwMl9wcm9ncmFtX3RpbGluZygKKwlzdHJ1Y3QgZGNuMjBfaHVicCAq
aHVicDIsCisJY29uc3QgdW5pb24gZGNfdGlsaW5nX2luZm8gKmluZm8sCisJY29uc3QgZW51bSBz
dXJmYWNlX3BpeGVsX2Zvcm1hdCBwaXhlbF9mb3JtYXQpCit7CisJUkVHX1VQREFURV8zKERDU1VS
Rl9BRERSX0NPTkZJRywKKwkJCU5VTV9QSVBFUywgbG9nXzIoaW5mby0+Z2Z4OS5udW1fcGlwZXMp
LAorCQkJUElQRV9JTlRFUkxFQVZFLCBpbmZvLT5nZng5LnBpcGVfaW50ZXJsZWF2ZSwKKwkJCU1B
WF9DT01QUkVTU0VEX0ZSQUdTLCBsb2dfMihpbmZvLT5nZng5Lm1heF9jb21wcmVzc2VkX2ZyYWdz
KSk7CisKKwlSRUdfVVBEQVRFXzQoRENTVVJGX1RJTElOR19DT05GSUcsCisJCQlTV19NT0RFLCBp
bmZvLT5nZng5LnN3aXp6bGUsCisJCQlNRVRBX0xJTkVBUiwgMCwKKwkJCVJCX0FMSUdORUQsIDAs
CisJCQlQSVBFX0FMSUdORUQsIDApOworfQorCit2b2lkIGh1YnAyX3Byb2dyYW1fc3VyZmFjZV9j
b25maWcoCisJc3RydWN0IGh1YnAgKmh1YnAsCisJZW51bSBzdXJmYWNlX3BpeGVsX2Zvcm1hdCBm
b3JtYXQsCisJdW5pb24gZGNfdGlsaW5nX2luZm8gKnRpbGluZ19pbmZvLAorCXVuaW9uIHBsYW5l
X3NpemUgKnBsYW5lX3NpemUsCisJZW51bSBkY19yb3RhdGlvbl9hbmdsZSByb3RhdGlvbiwKKwlz
dHJ1Y3QgZGNfcGxhbmVfZGNjX3BhcmFtICpkY2MsCisJYm9vbCBob3Jpem9udGFsX21pcnJvciwK
Kwl1bnNpZ25lZCBpbnQgY29tcGF0X2xldmVsKQoreworCXN0cnVjdCBkY24yMF9odWJwICpodWJw
MiA9IFRPX0RDTjIwX0hVQlAoaHVicCk7CisKKwlodWJwMV9kY2NfY29udHJvbChodWJwLCBkY2Mt
PmVuYWJsZSwgZGNjLT5ncnBoLmluZGVwZW5kZW50XzY0Yl9ibGtzKTsKKwlodWJwMl9wcm9ncmFt
X3RpbGluZyhodWJwMiwgdGlsaW5nX2luZm8sIGZvcm1hdCk7CisJaHVicDFfcHJvZ3JhbV9zaXpl
KGh1YnAsIGZvcm1hdCwgcGxhbmVfc2l6ZSwgZGNjKTsKKwlodWJwMV9wcm9ncmFtX3JvdGF0aW9u
KGh1YnAsIHJvdGF0aW9uLCBob3Jpem9udGFsX21pcnJvcik7CisJaHVicDFfcHJvZ3JhbV9waXhl
bF9mb3JtYXQoaHVicCwgZm9ybWF0KTsKK30KKworZW51bSBjdXJzb3JfbGluZXNfcGVyX2NodW5r
IGh1YnAyX2dldF9saW5lc19wZXJfY2h1bmsoCisJdW5zaWduZWQgaW50IGN1cnNvcl93aWR0aCwK
KwllbnVtIGRjX2N1cnNvcl9jb2xvcl9mb3JtYXQgY3Vyc29yX21vZGUpCit7CisJZW51bSBjdXJz
b3JfbGluZXNfcGVyX2NodW5rIGxpbmVfcGVyX2NodW5rID0gQ1VSU09SX0xJTkVfUEVSX0NIVU5L
XzE2OworCisJaWYgKGN1cnNvcl9tb2RlID09IENVUlNPUl9NT0RFX01PTk8pCisJCWxpbmVfcGVy
X2NodW5rID0gQ1VSU09SX0xJTkVfUEVSX0NIVU5LXzE2OworCWVsc2UgaWYgKGN1cnNvcl9tb2Rl
ID09IENVUlNPUl9NT0RFX0NPTE9SXzFCSVRfQU5EIHx8CisJCSBjdXJzb3JfbW9kZSA9PSBDVVJT
T1JfTU9ERV9DT0xPUl9QUkVfTVVMVElQTElFRF9BTFBIQSB8fAorCQkgY3Vyc29yX21vZGUgPT0g
Q1VSU09SX01PREVfQ09MT1JfVU5fUFJFX01VTFRJUExJRURfQUxQSEEpIHsKKwkJaWYgKGN1cnNv
cl93aWR0aCA+PSAxICAgJiYgY3Vyc29yX3dpZHRoIDw9IDMyKQorCQkJbGluZV9wZXJfY2h1bmsg
PSBDVVJTT1JfTElORV9QRVJfQ0hVTktfMTY7CisJCWVsc2UgaWYgKGN1cnNvcl93aWR0aCA+PSAz
MyAgJiYgY3Vyc29yX3dpZHRoIDw9IDY0KQorCQkJbGluZV9wZXJfY2h1bmsgPSBDVVJTT1JfTElO
RV9QRVJfQ0hVTktfODsKKwkJZWxzZSBpZiAoY3Vyc29yX3dpZHRoID49IDY1ICAmJiBjdXJzb3Jf
d2lkdGggPD0gMTI4KQorCQkJbGluZV9wZXJfY2h1bmsgPSBDVVJTT1JfTElORV9QRVJfQ0hVTktf
NDsKKwkJZWxzZSBpZiAoY3Vyc29yX3dpZHRoID49IDEyOSAmJiBjdXJzb3Jfd2lkdGggPD0gMjU2
KQorCQkJbGluZV9wZXJfY2h1bmsgPSBDVVJTT1JfTElORV9QRVJfQ0hVTktfMjsKKwl9IGVsc2Ug
aWYgKGN1cnNvcl9tb2RlID09IENVUlNPUl9NT0RFX0NPTE9SXzY0QklUX0ZQX1BSRV9NVUxUSVBM
SUVEIHx8CisJCSAgIGN1cnNvcl9tb2RlID09IENVUlNPUl9NT0RFX0NPTE9SXzY0QklUX0ZQX1VO
X1BSRV9NVUxUSVBMSUVEKSB7CisJCWlmIChjdXJzb3Jfd2lkdGggPj0gMSAgICYmIGN1cnNvcl93
aWR0aCA8PSAxNikKKwkJCWxpbmVfcGVyX2NodW5rID0gQ1VSU09SX0xJTkVfUEVSX0NIVU5LXzE2
OworCQllbHNlIGlmIChjdXJzb3Jfd2lkdGggPj0gMTcgICYmIGN1cnNvcl93aWR0aCA8PSAzMikK
KwkJCWxpbmVfcGVyX2NodW5rID0gQ1VSU09SX0xJTkVfUEVSX0NIVU5LXzg7CisJCWVsc2UgaWYg
KGN1cnNvcl93aWR0aCA+PSAzMyAgJiYgY3Vyc29yX3dpZHRoIDw9IDY0KQorCQkJbGluZV9wZXJf
Y2h1bmsgPSBDVVJTT1JfTElORV9QRVJfQ0hVTktfNDsKKwkJZWxzZSBpZiAoY3Vyc29yX3dpZHRo
ID49IDY1ICYmIGN1cnNvcl93aWR0aCA8PSAxMjgpCisJCQlsaW5lX3Blcl9jaHVuayA9IENVUlNP
Ul9MSU5FX1BFUl9DSFVOS18yOworCQllbHNlIGlmIChjdXJzb3Jfd2lkdGggPj0gMTI5ICYmIGN1
cnNvcl93aWR0aCA8PSAyNTYpCisJCQlsaW5lX3Blcl9jaHVuayA9IENVUlNPUl9MSU5FX1BFUl9D
SFVOS18xOworCX0KKworCXJldHVybiBsaW5lX3Blcl9jaHVuazsKK30KKwordm9pZCBodWJwMl9j
dXJzb3Jfc2V0X2F0dHJpYnV0ZXMoCisJCXN0cnVjdCBodWJwICpodWJwLAorCQljb25zdCBzdHJ1
Y3QgZGNfY3Vyc29yX2F0dHJpYnV0ZXMgKmF0dHIpCit7CisJc3RydWN0IGRjbjIwX2h1YnAgKmh1
YnAyID0gVE9fRENOMjBfSFVCUChodWJwKTsKKwllbnVtIGN1cnNvcl9waXRjaCBod19waXRjaCA9
IGh1YnAxX2dldF9jdXJzb3JfcGl0Y2goYXR0ci0+cGl0Y2gpOworCWVudW0gY3Vyc29yX2xpbmVz
X3Blcl9jaHVuayBscGMgPSBodWJwMl9nZXRfbGluZXNfcGVyX2NodW5rKAorCQkJYXR0ci0+d2lk
dGgsIGF0dHItPmNvbG9yX2Zvcm1hdCk7CisKKwlodWJwLT5jdXJzX2F0dHIgPSAqYXR0cjsKKwor
CVJFR19VUERBVEUoQ1VSU09SX1NVUkZBQ0VfQUREUkVTU19ISUdILAorCQkJQ1VSU09SX1NVUkZB
Q0VfQUREUkVTU19ISUdILCBhdHRyLT5hZGRyZXNzLmhpZ2hfcGFydCk7CisJUkVHX1VQREFURShD
VVJTT1JfU1VSRkFDRV9BRERSRVNTLAorCQkJQ1VSU09SX1NVUkZBQ0VfQUREUkVTUywgYXR0ci0+
YWRkcmVzcy5sb3dfcGFydCk7CisKKwlSRUdfVVBEQVRFXzIoQ1VSU09SX1NJWkUsCisJCQlDVVJT
T1JfV0lEVEgsIGF0dHItPndpZHRoLAorCQkJQ1VSU09SX0hFSUdIVCwgYXR0ci0+aGVpZ2h0KTsK
KworCVJFR19VUERBVEVfNChDVVJTT1JfQ09OVFJPTCwKKwkJCUNVUlNPUl9NT0RFLCBhdHRyLT5j
b2xvcl9mb3JtYXQsCisJCQlDVVJTT1JfMlhfTUFHTklGWSwgYXR0ci0+YXR0cmlidXRlX2ZsYWdz
LmJpdHMuRU5BQkxFX01BR05JRklDQVRJT04sCisJCQlDVVJTT1JfUElUQ0gsIGh3X3BpdGNoLAor
CQkJQ1VSU09SX0xJTkVTX1BFUl9DSFVOSywgbHBjKTsKKworCVJFR19TRVRfMihDVVJTT1JfU0VU
VElOR1MsIDAsCisJCQkvKiBubyBzaGlmdCBvZiB0aGUgY3Vyc29yIEhETCBzY2hlZHVsZSAqLwor
CQkJQ1VSU09SMF9EU1RfWV9PRkZTRVQsIDAsCisJCQkgLyogdXNlZCB0byBzaGlmdCB0aGUgY3Vy
c29yIGNodW5rIHJlcXVlc3QgZGVhZGxpbmUgKi8KKwkJCUNVUlNPUjBfQ0hVTktfSERMX0FESlVT
VCwgMyk7Cit9CisKK3ZvaWQgaHVicDJfZG1kYXRhX3NldF9hdHRyaWJ1dGVzKAorCQlzdHJ1Y3Qg
aHVicCAqaHVicCwKKwkJY29uc3Qgc3RydWN0IGRjX2RtZGF0YV9hdHRyaWJ1dGVzICphdHRyKQor
eworCXN0cnVjdCBkY24yMF9odWJwICpodWJwMiA9IFRPX0RDTjIwX0hVQlAoaHVicCk7CisKKwlp
ZiAoYXR0ci0+ZG1kYXRhX21vZGUgPT0gRE1EQVRBX0hXX01PREUpIHsKKwkJLyogc2V0IHRvIEhX
IG1vZGUgKi8KKwkJUkVHX1VQREFURShETURBVEFfQ05UTCwKKwkJCQlETURBVEFfTU9ERSwgMSk7
CisKKwkJLyogZm9yIERNREFUQSBmbGlwLCBuZWVkIHRvIHVzZSBTVVJGQUNFX1VQREFURV9MT0NL
ICovCisJCVJFR19VUERBVEUoRENTVVJGX0ZMSVBfQ09OVFJPTCwgU1VSRkFDRV9VUERBVEVfTE9D
SywgMSk7CisKKwkJLyogdG9nZ2xlIERNREFUQV9VUERBVEVEIGFuZCBzZXQgcmVwZWF0IGFuZCBz
aXplICovCisJCVJFR19VUERBVEUoRE1EQVRBX0NOVEwsCisJCQkJRE1EQVRBX1VQREFURUQsIDAp
OworCQlSRUdfVVBEQVRFXzMoRE1EQVRBX0NOVEwsCisJCQkJRE1EQVRBX1VQREFURUQsIDEsCisJ
CQkJRE1EQVRBX1JFUEVBVCwgYXR0ci0+ZG1kYXRhX3JlcGVhdCwKKwkJCQlETURBVEFfU0laRSwg
YXR0ci0+ZG1kYXRhX3NpemUpOworCisJCS8qIHNldCBETURBVEEgYWRkcmVzcyAqLworCQlSRUdf
V1JJVEUoRE1EQVRBX0FERFJFU1NfTE9XLCBhdHRyLT5hZGRyZXNzLmxvd19wYXJ0KTsKKwkJUkVH
X1VQREFURShETURBVEFfQUREUkVTU19ISUdILAorCQkJCURNREFUQV9BRERSRVNTX0hJR0gsIGF0
dHItPmFkZHJlc3MuaGlnaF9wYXJ0KTsKKworCQlSRUdfVVBEQVRFKERDU1VSRl9GTElQX0NPTlRS
T0wsIFNVUkZBQ0VfVVBEQVRFX0xPQ0ssIDApOworCisJfSBlbHNlIHsKKwkJLyogc2V0IHRvIFNX
IG1vZGUgYmVmb3JlIGxvYWRpbmcgZGF0YSAqLworCQlSRUdfU0VUKERNREFUQV9DTlRMLCAwLAor
CQkJCURNREFUQV9NT0RFLCAwKTsKKwkJLyogdG9nZ2xlIERNREFUQV9TV19VUERBVEVEIHRvIHN0
YXJ0IGxvYWRpbmcgc2VxdWVuY2UgKi8KKwkJUkVHX1VQREFURShETURBVEFfU1dfQ05UTCwKKwkJ
CQlETURBVEFfU1dfVVBEQVRFRCwgMCk7CisJCVJFR19VUERBVEVfMyhETURBVEFfU1dfQ05UTCwK
KwkJCQlETURBVEFfU1dfVVBEQVRFRCwgMSwKKwkJCQlETURBVEFfU1dfUkVQRUFULCBhdHRyLT5k
bWRhdGFfcmVwZWF0LAorCQkJCURNREFUQV9TV19TSVpFLCBhdHRyLT5kbWRhdGFfc2l6ZSk7CisJ
CS8qIGxvYWQgZGF0YSBpbnRvIGh1YnAgZG1kYXRhIGJ1ZmZlciAqLworCQlodWJwMl9kbWRhdGFf
bG9hZChodWJwLCBhdHRyLT5kbWRhdGFfc2l6ZSwgYXR0ci0+ZG1kYXRhX3N3X2RhdGEpOworCX0K
KworCS8qIE5vdGUgdGhhdCBETF9ERUxUQSBtdXN0IGJlIHByb2dyYW1tZWQgaWYgd2Ugd2FudCB0
byB1c2UgVFRVIG1vZGUgKi8KKwlSRUdfU0VUXzMoRE1EQVRBX1FPU19DTlRMLCAwLAorCQkJRE1E
QVRBX1FPU19NT0RFLCBhdHRyLT5kbWRhdGFfcW9zX21vZGUsCisJCQlETURBVEFfUU9TX0xFVkVM
LCBhdHRyLT5kbWRhdGFfcW9zX2xldmVsLAorCQkJRE1EQVRBX0RMX0RFTFRBLCBhdHRyLT5kbWRh
dGFfZGxfZGVsdGEpOworfQorCit2b2lkIGh1YnAyX2RtZGF0YV9sb2FkKAorCQlzdHJ1Y3QgaHVi
cCAqaHVicCwKKwkJdWludDMyX3QgZG1kYXRhX3N3X3NpemUsCisJCWNvbnN0IHVpbnQzMl90ICpk
bWRhdGFfc3dfZGF0YSkKK3sKKwlpbnQgaTsKKwlzdHJ1Y3QgZGNuMjBfaHVicCAqaHVicDIgPSBU
T19EQ04yMF9IVUJQKGh1YnApOworCisJLyogbG9hZCBkbWRhdGEgaW50byBIVUJQIGJ1ZmZlciBp
biBTVyBtb2RlICovCisJZm9yIChpID0gMDsgaSA8IGRtZGF0YV9zd19zaXplIC8gNDsgaSsrKQor
CQlSRUdfV1JJVEUoRE1EQVRBX1NXX0RBVEEsIGRtZGF0YV9zd19kYXRhW2ldKTsKK30KKworYm9v
bCBodWJwMl9kbWRhdGFfc3RhdHVzX2RvbmUoc3RydWN0IGh1YnAgKmh1YnApCit7CisJdWludDMy
X3Qgc3RhdHVzOworCXN0cnVjdCBkY24yMF9odWJwICpodWJwMiA9IFRPX0RDTjIwX0hVQlAoaHVi
cCk7CisKKwlSRUdfR0VUKERNREFUQV9TVEFUVVMsIERNREFUQV9ET05FLCAmc3RhdHVzKTsKKwly
ZXR1cm4gKHN0YXR1cyA9PSAxKTsKK30KKworYm9vbCBodWJwMl9wcm9ncmFtX3N1cmZhY2VfZmxp
cF9hbmRfYWRkcigKKwlzdHJ1Y3QgaHVicCAqaHVicCwKKwljb25zdCBzdHJ1Y3QgZGNfcGxhbmVf
YWRkcmVzcyAqYWRkcmVzcywKKwlib29sIGZsaXBfaW1tZWRpYXRlLAorCXVpbnQ4X3Qgdm1pZCkK
K3sKKwlzdHJ1Y3QgZGNuMjBfaHVicCAqaHVicDIgPSBUT19EQ04yMF9IVUJQKGh1YnApOworCisJ
Ly9wcm9ncmFtIGZsaXAgdHlwZQorCVJFR19VUERBVEUoRENTVVJGX0ZMSVBfQ09OVFJPTCwKKwkJ
CVNVUkZBQ0VfRkxJUF9UWVBFLCBmbGlwX2ltbWVkaWF0ZSk7CisKKwkvLyBQcm9ncmFtIFZNSUQg
cmVnCisJUkVHX1VQREFURShWTUlEX1NFVFRJTkdTXzAsCisJCQlWTUlELCB2bWlkKTsKKworCWlm
IChhZGRyZXNzLT50eXBlID09IFBMTl9BRERSX1RZUEVfR1JQSF9TVEVSRU8pIHsKKwkJUkVHX1VQ
REFURShEQ1NVUkZfRkxJUF9DT05UUk9MLCBTVVJGQUNFX0ZMSVBfTU9ERV9GT1JfU1RFUkVPU1lO
QywgMHgxKTsKKwkJUkVHX1VQREFURShEQ1NVUkZfRkxJUF9DT05UUk9MLCBTVVJGQUNFX0ZMSVBf
SU5fU1RFUkVPU1lOQywgMHgxKTsKKworCX0gZWxzZSB7CisJCS8vIHR1cm4gb2ZmIHN0ZXJlbyBp
ZiBub3QgaW4gc3RlcmVvCisJCVJFR19VUERBVEUoRENTVVJGX0ZMSVBfQ09OVFJPTCwgU1VSRkFD
RV9GTElQX01PREVfRk9SX1NURVJFT1NZTkMsIDB4MCk7CisJCVJFR19VUERBVEUoRENTVVJGX0ZM
SVBfQ09OVFJPTCwgU1VSRkFDRV9GTElQX0lOX1NURVJFT1NZTkMsIDB4MCk7CisJfQorCisKKwor
CS8qIEhXIGF1dG9tYXRpY2FsbHkgbGF0Y2ggcmVzdCBvZiBhZGRyZXNzIHJlZ2lzdGVyIG9uIHdy
aXRlIHRvCisJICogRENTVVJGX1BSSU1BUllfU1VSRkFDRV9BRERSRVNTIGlmIFNVUkZBQ0VfVVBE
QVRFX0xPQ0sgaXMgbm90IHVzZWQKKwkgKgorCSAqIHByb2dyYW0gaGlnaCBmaXJzdCBhbmQgdGhl
biB0aGUgbG93IGFkZHIsIG9yZGVyIG1hdHRlcnMhCisJICovCisJc3dpdGNoIChhZGRyZXNzLT50
eXBlKSB7CisJY2FzZSBQTE5fQUREUl9UWVBFX0dSQVBISUNTOgorCQkvKiBEQ04xLjAgZG9lcyBu
b3Qgc3VwcG9ydCBjb25zdCBjb2xvcgorCQkgKiBUT0RPOiBwcm9ncmFtIERDSFVCQlVCX1JFVF9Q
QVRIX0RDQ19DRkd4XzAvMQorCQkgKiBiYXNlIG9uIGFkZHJlc3MtPmdycGguZGNjX2NvbnN0X2Nv
bG9yCisJCSAqIHggPSAwLCAyLCA0LCA2IGZvciBwaXBlIDAsIDEsIDIsIDMgZm9yIHJnYiBhbmQg
bHVtYQorCQkgKiB4ID0gMSwgMywgNSwgNyBmb3IgcGlwZSAwLCAxLCAyLCAzIGZvciBjaHJvbWEK
KwkJICovCisKKwkJaWYgKGFkZHJlc3MtPmdycGguYWRkci5xdWFkX3BhcnQgPT0gMCkKKwkJCWJy
ZWFrOworCisJCVJFR19VUERBVEVfMihEQ1NVUkZfU1VSRkFDRV9DT05UUk9MLAorCQkJCVBSSU1B
UllfU1VSRkFDRV9UTVosIGFkZHJlc3MtPnRtel9zdXJmYWNlLAorCQkJCVBSSU1BUllfTUVUQV9T
VVJGQUNFX1RNWiwgYWRkcmVzcy0+dG16X3N1cmZhY2UpOworCisJCWlmIChhZGRyZXNzLT5ncnBo
Lm1ldGFfYWRkci5xdWFkX3BhcnQgIT0gMCkgeworCQkJUkVHX1NFVChEQ1NVUkZfUFJJTUFSWV9N
RVRBX1NVUkZBQ0VfQUREUkVTU19ISUdILCAwLAorCQkJCQlQUklNQVJZX01FVEFfU1VSRkFDRV9B
RERSRVNTX0hJR0gsCisJCQkJCWFkZHJlc3MtPmdycGgubWV0YV9hZGRyLmhpZ2hfcGFydCk7CisK
KwkJCVJFR19TRVQoRENTVVJGX1BSSU1BUllfTUVUQV9TVVJGQUNFX0FERFJFU1MsIDAsCisJCQkJ
CVBSSU1BUllfTUVUQV9TVVJGQUNFX0FERFJFU1MsCisJCQkJCWFkZHJlc3MtPmdycGgubWV0YV9h
ZGRyLmxvd19wYXJ0KTsKKwkJfQorCisJCVJFR19TRVQoRENTVVJGX1BSSU1BUllfU1VSRkFDRV9B
RERSRVNTX0hJR0gsIDAsCisJCQkJUFJJTUFSWV9TVVJGQUNFX0FERFJFU1NfSElHSCwKKwkJCQlh
ZGRyZXNzLT5ncnBoLmFkZHIuaGlnaF9wYXJ0KTsKKworCQlSRUdfU0VUKERDU1VSRl9QUklNQVJZ
X1NVUkZBQ0VfQUREUkVTUywgMCwKKwkJCQlQUklNQVJZX1NVUkZBQ0VfQUREUkVTUywKKwkJCQlh
ZGRyZXNzLT5ncnBoLmFkZHIubG93X3BhcnQpOworCQlicmVhazsKKwljYXNlIFBMTl9BRERSX1RZ
UEVfVklERU9fUFJPR1JFU1NJVkU6CisJCWlmIChhZGRyZXNzLT52aWRlb19wcm9ncmVzc2l2ZS5s
dW1hX2FkZHIucXVhZF9wYXJ0ID09IDAKKwkJCQl8fCBhZGRyZXNzLT52aWRlb19wcm9ncmVzc2l2
ZS5jaHJvbWFfYWRkci5xdWFkX3BhcnQgPT0gMCkKKwkJCWJyZWFrOworCisJCVJFR19VUERBVEVf
NChEQ1NVUkZfU1VSRkFDRV9DT05UUk9MLAorCQkJCVBSSU1BUllfU1VSRkFDRV9UTVosIGFkZHJl
c3MtPnRtel9zdXJmYWNlLAorCQkJCVBSSU1BUllfU1VSRkFDRV9UTVpfQywgYWRkcmVzcy0+dG16
X3N1cmZhY2UsCisJCQkJUFJJTUFSWV9NRVRBX1NVUkZBQ0VfVE1aLCBhZGRyZXNzLT50bXpfc3Vy
ZmFjZSwKKwkJCQlQUklNQVJZX01FVEFfU1VSRkFDRV9UTVpfQywgYWRkcmVzcy0+dG16X3N1cmZh
Y2UpOworCisJCWlmIChhZGRyZXNzLT52aWRlb19wcm9ncmVzc2l2ZS5sdW1hX21ldGFfYWRkci5x
dWFkX3BhcnQgIT0gMCkgeworCQkJUkVHX1NFVChEQ1NVUkZfUFJJTUFSWV9NRVRBX1NVUkZBQ0Vf
QUREUkVTU19ISUdIX0MsIDAsCisJCQkJCVBSSU1BUllfTUVUQV9TVVJGQUNFX0FERFJFU1NfSElH
SF9DLAorCQkJCQlhZGRyZXNzLT52aWRlb19wcm9ncmVzc2l2ZS5jaHJvbWFfbWV0YV9hZGRyLmhp
Z2hfcGFydCk7CisKKwkJCVJFR19TRVQoRENTVVJGX1BSSU1BUllfTUVUQV9TVVJGQUNFX0FERFJF
U1NfQywgMCwKKwkJCQkJUFJJTUFSWV9NRVRBX1NVUkZBQ0VfQUREUkVTU19DLAorCQkJCQlhZGRy
ZXNzLT52aWRlb19wcm9ncmVzc2l2ZS5jaHJvbWFfbWV0YV9hZGRyLmxvd19wYXJ0KTsKKworCQkJ
UkVHX1NFVChEQ1NVUkZfUFJJTUFSWV9NRVRBX1NVUkZBQ0VfQUREUkVTU19ISUdILCAwLAorCQkJ
CQlQUklNQVJZX01FVEFfU1VSRkFDRV9BRERSRVNTX0hJR0gsCisJCQkJCWFkZHJlc3MtPnZpZGVv
X3Byb2dyZXNzaXZlLmx1bWFfbWV0YV9hZGRyLmhpZ2hfcGFydCk7CisKKwkJCVJFR19TRVQoRENT
VVJGX1BSSU1BUllfTUVUQV9TVVJGQUNFX0FERFJFU1MsIDAsCisJCQkJCVBSSU1BUllfTUVUQV9T
VVJGQUNFX0FERFJFU1MsCisJCQkJCWFkZHJlc3MtPnZpZGVvX3Byb2dyZXNzaXZlLmx1bWFfbWV0
YV9hZGRyLmxvd19wYXJ0KTsKKwkJfQorCisJCVJFR19TRVQoRENTVVJGX1BSSU1BUllfU1VSRkFD
RV9BRERSRVNTX0hJR0hfQywgMCwKKwkJCQlQUklNQVJZX1NVUkZBQ0VfQUREUkVTU19ISUdIX0Ms
CisJCQkJYWRkcmVzcy0+dmlkZW9fcHJvZ3Jlc3NpdmUuY2hyb21hX2FkZHIuaGlnaF9wYXJ0KTsK
KworCQlSRUdfU0VUKERDU1VSRl9QUklNQVJZX1NVUkZBQ0VfQUREUkVTU19DLCAwLAorCQkJCVBS
SU1BUllfU1VSRkFDRV9BRERSRVNTX0MsCisJCQkJYWRkcmVzcy0+dmlkZW9fcHJvZ3Jlc3NpdmUu
Y2hyb21hX2FkZHIubG93X3BhcnQpOworCisJCVJFR19TRVQoRENTVVJGX1BSSU1BUllfU1VSRkFD
RV9BRERSRVNTX0hJR0gsIDAsCisJCQkJUFJJTUFSWV9TVVJGQUNFX0FERFJFU1NfSElHSCwKKwkJ
CQlhZGRyZXNzLT52aWRlb19wcm9ncmVzc2l2ZS5sdW1hX2FkZHIuaGlnaF9wYXJ0KTsKKworCQlS
RUdfU0VUKERDU1VSRl9QUklNQVJZX1NVUkZBQ0VfQUREUkVTUywgMCwKKwkJCQlQUklNQVJZX1NV
UkZBQ0VfQUREUkVTUywKKwkJCQlhZGRyZXNzLT52aWRlb19wcm9ncmVzc2l2ZS5sdW1hX2FkZHIu
bG93X3BhcnQpOworCQlicmVhazsKKwljYXNlIFBMTl9BRERSX1RZUEVfR1JQSF9TVEVSRU86CisJ
CWlmIChhZGRyZXNzLT5ncnBoX3N0ZXJlby5sZWZ0X2FkZHIucXVhZF9wYXJ0ID09IDApCisJCQli
cmVhazsKKwkJaWYgKGFkZHJlc3MtPmdycGhfc3RlcmVvLnJpZ2h0X2FkZHIucXVhZF9wYXJ0ID09
IDApCisJCQlicmVhazsKKworCQlSRUdfVVBEQVRFXzgoRENTVVJGX1NVUkZBQ0VfQ09OVFJPTCwK
KwkJCQlQUklNQVJZX1NVUkZBQ0VfVE1aLCBhZGRyZXNzLT50bXpfc3VyZmFjZSwKKwkJCQlQUklN
QVJZX1NVUkZBQ0VfVE1aX0MsIGFkZHJlc3MtPnRtel9zdXJmYWNlLAorCQkJCVBSSU1BUllfTUVU
QV9TVVJGQUNFX1RNWiwgYWRkcmVzcy0+dG16X3N1cmZhY2UsCisJCQkJUFJJTUFSWV9NRVRBX1NV
UkZBQ0VfVE1aX0MsIGFkZHJlc3MtPnRtel9zdXJmYWNlLAorCQkJCVNFQ09OREFSWV9TVVJGQUNF
X1RNWiwgYWRkcmVzcy0+dG16X3N1cmZhY2UsCisJCQkJU0VDT05EQVJZX1NVUkZBQ0VfVE1aX0Ms
IGFkZHJlc3MtPnRtel9zdXJmYWNlLAorCQkJCVNFQ09OREFSWV9NRVRBX1NVUkZBQ0VfVE1aLCBh
ZGRyZXNzLT50bXpfc3VyZmFjZSwKKwkJCQlTRUNPTkRBUllfTUVUQV9TVVJGQUNFX1RNWl9DLCBh
ZGRyZXNzLT50bXpfc3VyZmFjZSk7CisKKwkJaWYgKGFkZHJlc3MtPmdycGhfc3RlcmVvLnJpZ2h0
X21ldGFfYWRkci5xdWFkX3BhcnQgIT0gMCkgeworCisJCQlSRUdfU0VUKERDU1VSRl9TRUNPTkRB
UllfTUVUQV9TVVJGQUNFX0FERFJFU1NfSElHSCwgMCwKKwkJCQkJU0VDT05EQVJZX01FVEFfU1VS
RkFDRV9BRERSRVNTX0hJR0gsCisJCQkJCWFkZHJlc3MtPmdycGhfc3RlcmVvLnJpZ2h0X21ldGFf
YWRkci5oaWdoX3BhcnQpOworCisJCQlSRUdfU0VUKERDU1VSRl9TRUNPTkRBUllfTUVUQV9TVVJG
QUNFX0FERFJFU1MsIDAsCisJCQkJCVNFQ09OREFSWV9NRVRBX1NVUkZBQ0VfQUREUkVTUywKKwkJ
CQkJYWRkcmVzcy0+Z3JwaF9zdGVyZW8ucmlnaHRfbWV0YV9hZGRyLmxvd19wYXJ0KTsKKwkJfQor
CQlpZiAoYWRkcmVzcy0+Z3JwaF9zdGVyZW8ubGVmdF9tZXRhX2FkZHIucXVhZF9wYXJ0ICE9IDAp
IHsKKworCQkJUkVHX1NFVChEQ1NVUkZfUFJJTUFSWV9NRVRBX1NVUkZBQ0VfQUREUkVTU19ISUdI
LCAwLAorCQkJCQlQUklNQVJZX01FVEFfU1VSRkFDRV9BRERSRVNTX0hJR0gsCisJCQkJCWFkZHJl
c3MtPmdycGhfc3RlcmVvLmxlZnRfbWV0YV9hZGRyLmhpZ2hfcGFydCk7CisKKwkJCVJFR19TRVQo
RENTVVJGX1BSSU1BUllfTUVUQV9TVVJGQUNFX0FERFJFU1MsIDAsCisJCQkJCVBSSU1BUllfTUVU
QV9TVVJGQUNFX0FERFJFU1MsCisJCQkJCWFkZHJlc3MtPmdycGhfc3RlcmVvLmxlZnRfbWV0YV9h
ZGRyLmxvd19wYXJ0KTsKKwkJfQorCisJCVJFR19TRVQoRENTVVJGX1NFQ09OREFSWV9TVVJGQUNF
X0FERFJFU1NfSElHSCwgMCwKKwkJCQlTRUNPTkRBUllfU1VSRkFDRV9BRERSRVNTX0hJR0gsCisJ
CQkJYWRkcmVzcy0+Z3JwaF9zdGVyZW8ucmlnaHRfYWRkci5oaWdoX3BhcnQpOworCisJCVJFR19T
RVQoRENTVVJGX1NFQ09OREFSWV9TVVJGQUNFX0FERFJFU1MsIDAsCisJCQkJU0VDT05EQVJZX1NV
UkZBQ0VfQUREUkVTUywKKwkJCQlhZGRyZXNzLT5ncnBoX3N0ZXJlby5yaWdodF9hZGRyLmxvd19w
YXJ0KTsKKworCQlSRUdfU0VUKERDU1VSRl9QUklNQVJZX1NVUkZBQ0VfQUREUkVTU19ISUdILCAw
LAorCQkJCVBSSU1BUllfU1VSRkFDRV9BRERSRVNTX0hJR0gsCisJCQkJYWRkcmVzcy0+Z3JwaF9z
dGVyZW8ubGVmdF9hZGRyLmhpZ2hfcGFydCk7CisKKwkJUkVHX1NFVChEQ1NVUkZfUFJJTUFSWV9T
VVJGQUNFX0FERFJFU1MsIDAsCisJCQkJUFJJTUFSWV9TVVJGQUNFX0FERFJFU1MsCisJCQkJYWRk
cmVzcy0+Z3JwaF9zdGVyZW8ubGVmdF9hZGRyLmxvd19wYXJ0KTsKKwkJYnJlYWs7CisJZGVmYXVs
dDoKKwkJQlJFQUtfVE9fREVCVUdHRVIoKTsKKwkJYnJlYWs7CisJfQorCisJaHVicC0+cmVxdWVz
dF9hZGRyZXNzID0gKmFkZHJlc3M7CisKKwlyZXR1cm4gdHJ1ZTsKK30KKwordm9pZCBodWJwMl9l
bmFibGVfdHJpcGxlYnVmZmVyKAorCXN0cnVjdCBodWJwICpodWJwLAorCWJvb2wgZW5hYmxlKQor
eworCXN0cnVjdCBkY24yMF9odWJwICpodWJwMiA9IFRPX0RDTjIwX0hVQlAoaHVicCk7CisJdWlu
dDMyX3QgdHJpcGxlX2J1ZmZlcl9lbiA9IDA7CisJYm9vbCB0cmlfYnVmZmVyX2VuOworCisJUkVH
X0dFVChEQ1NVUkZfRkxJUF9DT05UUk9MMiwgU1VSRkFDRV9UUklQTEVfQlVGRkVSX0VOQUJMRSwg
JnRyaXBsZV9idWZmZXJfZW4pOworCXRyaV9idWZmZXJfZW4gPSAodHJpcGxlX2J1ZmZlcl9lbiA9
PSAxKTsKKwlpZiAodHJpX2J1ZmZlcl9lbiAhPSBlbmFibGUpIHsKKwkJUkVHX1VQREFURShEQ1NV
UkZfRkxJUF9DT05UUk9MMiwKKwkJCVNVUkZBQ0VfVFJJUExFX0JVRkZFUl9FTkFCTEUsIGVuYWJs
ZSA/IERDX1RSSVBMRUJVRkZFUl9FTkFCTEUgOiBEQ19UUklQTEVCVUZGRVJfRElTQUJMRSk7CisJ
fQorfQorCitib29sIGh1YnAyX2lzX3RyaXBsZWJ1ZmZlcl9lbmFibGVkKAorCXN0cnVjdCBodWJw
ICpodWJwKQoreworCXN0cnVjdCBkY24yMF9odWJwICpodWJwMiA9IFRPX0RDTjIwX0hVQlAoaHVi
cCk7CisJdWludDMyX3QgdHJpcGxlX2J1ZmZlcl9lbiA9IDA7CisKKwlSRUdfR0VUKERDU1VSRl9G
TElQX0NPTlRST0wyLCBTVVJGQUNFX1RSSVBMRV9CVUZGRVJfRU5BQkxFLCAmdHJpcGxlX2J1ZmZl
cl9lbik7CisKKwlyZXR1cm4gKGJvb2wpdHJpcGxlX2J1ZmZlcl9lbjsKK30KKwordm9pZCBodWJw
Ml9zZXRfZmxpcF9jb250cm9sX3N1cmZhY2VfZ3NsKHN0cnVjdCBodWJwICpodWJwLCBib29sIGVu
YWJsZSkKK3sKKwlzdHJ1Y3QgZGNuMjBfaHVicCAqaHVicDIgPSBUT19EQ04yMF9IVUJQKGh1YnAp
OworCisJUkVHX1VQREFURShEQ1NVUkZfRkxJUF9DT05UUk9MMiwgU1VSRkFDRV9HU0xfRU5BQkxF
LCBlbmFibGUgPyAxIDogMCk7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgaHVicF9mdW5jcyBkY24yMF9o
dWJwX2Z1bmNzID0geworCS5odWJwX2VuYWJsZV90cmlwbGVCdWZmZXIgPSBodWJwMl9lbmFibGVf
dHJpcGxlYnVmZmVyLAorCS5odWJwX2lzX3RyaXBsZWJ1ZmZlcl9lbmFibGVkID0gaHVicDJfaXNf
dHJpcGxlYnVmZmVyX2VuYWJsZWQsCisJLmh1YnBfcHJvZ3JhbV9zdXJmYWNlX2ZsaXBfYW5kX2Fk
ZHIgPSBodWJwMl9wcm9ncmFtX3N1cmZhY2VfZmxpcF9hbmRfYWRkciwKKwkuaHVicF9wcm9ncmFt
X3N1cmZhY2VfY29uZmlnID0gaHVicDJfcHJvZ3JhbV9zdXJmYWNlX2NvbmZpZywKKwkuaHVicF9p
c19mbGlwX3BlbmRpbmcgPSBodWJwMV9pc19mbGlwX3BlbmRpbmcsCisJLmh1YnBfc2V0dXAgPSBo
dWJwMl9zZXR1cCwKKwkuaHVicF9zZXR1cF9pbnRlcmRlcGVuZGVudCA9IGh1YnAyX3NldHVwX2lu
dGVyZGVwZW5kZW50LAorCS5odWJwX3NldF92bV9zeXN0ZW1fYXBlcnR1cmVfc2V0dGluZ3MgPSBo
dWJwMl9zZXRfdm1fc3lzdGVtX2FwZXJ0dXJlX3NldHRpbmdzLAorCS5zZXRfYmxhbmsgPSBodWJw
MV9zZXRfYmxhbmssCisJLmRjY19jb250cm9sID0gaHVicDFfZGNjX2NvbnRyb2wsCisJLmh1YnBf
dXBkYXRlX2RjaHViID0gaHVicDJfdXBkYXRlX2RjaHViLAorCS5tZW1fcHJvZ3JhbV92aWV3cG9y
dCA9IG1pbl9zZXRfdmlld3BvcnQsCisJLnNldF9jdXJzb3JfYXR0cmlidXRlcwk9IGh1YnAyX2N1
cnNvcl9zZXRfYXR0cmlidXRlcywKKwkuc2V0X2N1cnNvcl9wb3NpdGlvbgk9IGh1YnAxX2N1cnNv
cl9zZXRfcG9zaXRpb24sCisJLmh1YnBfY2xrX2NudGwgPSBodWJwMV9jbGtfY250bCwKKwkuaHVi
cF92dGdfc2VsID0gaHVicDFfdnRnX3NlbCwKKwkuZG1kYXRhX3NldF9hdHRyaWJ1dGVzID0gaHVi
cDJfZG1kYXRhX3NldF9hdHRyaWJ1dGVzLAorCS5kbWRhdGFfbG9hZCA9IGh1YnAyX2RtZGF0YV9s
b2FkLAorCS5kbWRhdGFfc3RhdHVzX2RvbmUgPSBodWJwMl9kbWRhdGFfc3RhdHVzX2RvbmUsCisJ
Lmh1YnBfcmVhZF9zdGF0ZSA9IGh1YnAxX3JlYWRfc3RhdGUsCisJLmh1YnBfY2xlYXJfdW5kZXJm
bG93ID0gaHVicDFfY2xlYXJfdW5kZXJmbG93LAorCS5odWJwX3NldF9mbGlwX2NvbnRyb2xfc3Vy
ZmFjZV9nc2wgPSBodWJwMl9zZXRfZmxpcF9jb250cm9sX3N1cmZhY2VfZ3NsCit9OworCitib29s
IGh1YnAyX2NvbnN0cnVjdCgKKwlzdHJ1Y3QgZGNuMjBfaHVicCAqaHVicDIsCisJc3RydWN0IGRj
X2NvbnRleHQgKmN0eCwKKwl1aW50MzJfdCBpbnN0LAorCWNvbnN0IHN0cnVjdCBkY25faHVicDJf
cmVnaXN0ZXJzICpodWJwX3JlZ3MsCisJY29uc3Qgc3RydWN0IGRjbl9odWJwMl9zaGlmdCAqaHVi
cF9zaGlmdCwKKwljb25zdCBzdHJ1Y3QgZGNuX2h1YnAyX21hc2sgKmh1YnBfbWFzaykKK3sKKwlo
dWJwMi0+YmFzZS5mdW5jcyA9ICZkY24yMF9odWJwX2Z1bmNzOworCWh1YnAyLT5iYXNlLmN0eCA9
IGN0eDsKKwlodWJwMi0+aHVicF9yZWdzID0gaHVicF9yZWdzOworCWh1YnAyLT5odWJwX3NoaWZ0
ID0gaHVicF9zaGlmdDsKKwlodWJwMi0+aHVicF9tYXNrID0gaHVicF9tYXNrOworCWh1YnAyLT5i
YXNlLmluc3QgPSBpbnN0OworCWh1YnAyLT5iYXNlLm9wcF9pZCA9IDB4ZjsKKwlodWJwMi0+YmFz
ZS5tcGNjX2lkID0gMHhmOworCisJcmV0dXJuIHRydWU7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvZGNuMjAvZGNuMjBfaHVicC5oIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9kaXNwbGF5L2RjL2RjbjIwL2RjbjIwX2h1YnAuaApuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwMDAwMDAuLmFjN2VmMDI0NTBlNQotLS0gL2Rldi9udWxsCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9kY24yMC9kY24yMF9odWJwLmgKQEAgLTAsMCAr
MSwyNDQgQEAKKy8qCisgKiBDb3B5cmlnaHQgMjAxMi0xNyBBZHZhbmNlZCBNaWNybyBEZXZpY2Vz
LCBJbmMuCisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFy
Z2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBh
bmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0
byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0
aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJn
ZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGll
cyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQorICog
U29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcg
Y29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBw
ZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgorICogYWxsIGNvcGllcyBvciBz
dWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJF
IElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJF
U1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJB
TlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAorICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBV
UlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMCisgKiBUSEUgQ09Q
WVJJR0hUIEhPTERFUihTKSBPUiBBVVRIT1IoUykgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERB
TUFHRVMgT1IKKyAqIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09O
VFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAorICogQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4g
Q09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SCisgKiBPVEhFUiBERUFM
SU5HUyBJTiBUSEUgU09GVFdBUkUuCisgKgorICogQXV0aG9yczogQU1ECisgKgorICovCisKKyNp
Zm5kZWYgX19EQ19NRU1fSU5QVVRfRENOMjBfSF9fCisjZGVmaW5lIF9fRENfTUVNX0lOUFVUX0RD
TjIwX0hfXworCisjaW5jbHVkZSAiLi4vZGNuMTAvZGNuMTBfaHVicC5oIgorCisjZGVmaW5lIFRP
X0RDTjIwX0hVQlAoaHVicClcCisJY29udGFpbmVyX29mKGh1YnAsIHN0cnVjdCBkY24yMF9odWJw
LCBiYXNlKQorCisjZGVmaW5lIEhVQlBfUkVHX0xJU1RfRENOMjAoaWQpXAorCUhVQlBfUkVHX0xJ
U1RfRENOKGlkKSxcCisJSFVCUF9SRUdfTElTVF9EQ05fVk0oaWQpLFwKKwlTUkkoUFJFRkVUQ0hf
U0VUVElOR1MsIEhVQlBSRVEsIGlkKSxcCisJU1JJKFBSRUZFVENIX1NFVFRJTkdTX0MsIEhVQlBS
RVEsIGlkKSxcCisJU1JJKERDTl9WTV9TWVNURU1fQVBFUlRVUkVfTE9XX0FERFIsIEhVQlBSRVEs
IGlkKSxcCisJU1JJKERDTl9WTV9TWVNURU1fQVBFUlRVUkVfSElHSF9BRERSLCBIVUJQUkVRLCBp
ZCksXAorCVNSKERDTl9WTV9GQl9MT0NBVElPTl9UT1ApLFwKKwlTUihEQ05fVk1fRkJfTE9DQVRJ
T05fQkFTRSksXAorCVNSKERDTl9WTV9GQl9PRkZTRVQpLFwKKwlTUihEQ05fVk1fQUdQX0JBU0Up
LFwKKwlTUihEQ05fVk1fQUdQX0JPVCksXAorCVNSKERDTl9WTV9BR1BfVE9QKSxcCisJU1JJKENV
UlNPUl9TRVRUSU5HUywgSFVCUFJFUSwgaWQpLCBcCisJU1JJKENVUlNPUl9TVVJGQUNFX0FERFJF
U1NfSElHSCwgQ1VSU09SMF8sIGlkKSwgXAorCVNSSShDVVJTT1JfU1VSRkFDRV9BRERSRVNTLCBD
VVJTT1IwXywgaWQpLCBcCisJU1JJKENVUlNPUl9TSVpFLCBDVVJTT1IwXywgaWQpLCBcCisJU1JJ
KENVUlNPUl9DT05UUk9MLCBDVVJTT1IwXywgaWQpLCBcCisJU1JJKENVUlNPUl9QT1NJVElPTiwg
Q1VSU09SMF8sIGlkKSwgXAorCVNSSShDVVJTT1JfSE9UX1NQT1QsIENVUlNPUjBfLCBpZCksIFwK
KwlTUkkoQ1VSU09SX0RTVF9PRkZTRVQsIENVUlNPUjBfLCBpZCksIFwKKwlTUkkoRE1EQVRBX0FE
RFJFU1NfSElHSCwgQ1VSU09SMF8sIGlkKSwgXAorCVNSSShETURBVEFfQUREUkVTU19MT1csIENV
UlNPUjBfLCBpZCksIFwKKwlTUkkoRE1EQVRBX0NOVEwsIENVUlNPUjBfLCBpZCksIFwKKwlTUkko
RE1EQVRBX1NXX0NOVEwsIENVUlNPUjBfLCBpZCksIFwKKwlTUkkoRE1EQVRBX1FPU19DTlRMLCBD
VVJTT1IwXywgaWQpLCBcCisJU1JJKERNREFUQV9TV19EQVRBLCBDVVJTT1IwXywgaWQpLCBcCisJ
U1JJKERNREFUQV9TVEFUVVMsIENVUlNPUjBfLCBpZCksXAorCVNSSShGTElQX1BBUkFNRVRFUlNf
MCwgSFVCUFJFUSwgaWQpLFwKKwlTUkkoRkxJUF9QQVJBTUVURVJTXzEsIEhVQlBSRVEsIGlkKSxc
CisJU1JJKEZMSVBfUEFSQU1FVEVSU18yLCBIVUJQUkVRLCBpZCksXAorCVNSSShEQ05fQ1VSMV9U
VFVfQ05UTDEsIEhVQlBSRVEsIGlkKSxcCisJU1JJKERDU1VSRl9GTElQX0NPTlRST0wyLCBIVUJQ
UkVRLCBpZCksIFwKKwlTUkkoVk1JRF9TRVRUSU5HU18wLCBIVUJQUkVRLCBpZCksXAorCVNSKERD
Tl9WTV9TWVNURU1fQVBFUlRVUkVfREVGQVVMVF9BRERSX01TQiksXAorCVNSKERDTl9WTV9TWVNU
RU1fQVBFUlRVUkVfREVGQVVMVF9BRERSX0xTQikKKworI2RlZmluZSBIVUJQX01BU0tfU0hfTElT
VF9EQ04yMChtYXNrX3NoKVwKKwlIVUJQX01BU0tfU0hfTElTVF9EQ04obWFza19zaCksXAorCUhV
QlBfTUFTS19TSF9MSVNUX0RDTl9WTShtYXNrX3NoKSxcCisJSFVCUF9TRihIVUJQMF9EQ1NVUkZf
U1VSRkFDRV9DT05GSUcsIFJPVEFUSU9OX0FOR0xFLCBtYXNrX3NoKSxcCisJSFVCUF9TRihIVUJQ
MF9EQ1NVUkZfU1VSRkFDRV9DT05GSUcsIEhfTUlSUk9SX0VOLCBtYXNrX3NoKSxcCisJSFVCUF9T
RihIVUJQUkVRMF9QUkVGRVRDSF9TRVRUSU5HUywgRFNUX1lfUFJFRkVUQ0gsIG1hc2tfc2gpLFwK
KwlIVUJQX1NGKEhVQlBSRVEwX1BSRUZFVENIX1NFVFRJTkdTLCBWUkFUSU9fUFJFRkVUQ0gsIG1h
c2tfc2gpLFwKKwlIVUJQX1NGKEhVQlBSRVEwX1BSRUZFVENIX1NFVFRJTkdTX0MsIFZSQVRJT19Q
UkVGRVRDSF9DLCBtYXNrX3NoKSxcCisJSFVCUF9TRihIVUJQUkVRMF9EQ05fVk1fU1lTVEVNX0FQ
RVJUVVJFX0xPV19BRERSLCBNQ19WTV9TWVNURU1fQVBFUlRVUkVfTE9XX0FERFIsIG1hc2tfc2gp
LFwKKwlIVUJQX1NGKEhVQlBSRVEwX0RDTl9WTV9TWVNURU1fQVBFUlRVUkVfSElHSF9BRERSLCBN
Q19WTV9TWVNURU1fQVBFUlRVUkVfSElHSF9BRERSLCBtYXNrX3NoKSxcCisJSFVCUF9TRihEQ05f
Vk1fRkJfTE9DQVRJT05fVE9QLCBGQl9UT1AsIG1hc2tfc2gpLFwKKwlIVUJQX1NGKERDTl9WTV9G
Ql9MT0NBVElPTl9CQVNFLCBGQl9CQVNFLCBtYXNrX3NoKSxcCisJSFVCUF9TRihEQ05fVk1fRkJf
T0ZGU0VULCBGQl9PRkZTRVQsIG1hc2tfc2gpLFwKKwlIVUJQX1NGKERDTl9WTV9BR1BfQkFTRSwg
QUdQX0JBU0UsIG1hc2tfc2gpLFwKKwlIVUJQX1NGKERDTl9WTV9BR1BfQk9ULCBBR1BfQk9ULCBt
YXNrX3NoKSxcCisJSFVCUF9TRihEQ05fVk1fQUdQX1RPUCwgQUdQX1RPUCwgbWFza19zaCksXAor
CUhVQlBfU0YoSFVCUFJFUTBfQ1VSU09SX1NFVFRJTkdTLCBDVVJTT1IwX0RTVF9ZX09GRlNFVCwg
bWFza19zaCksIFwKKwlIVUJQX1NGKEhVQlBSRVEwX0NVUlNPUl9TRVRUSU5HUywgQ1VSU09SMF9D
SFVOS19IRExfQURKVVNULCBtYXNrX3NoKSwgXAorCUhVQlBfU0YoQ1VSU09SMF8wX0NVUlNPUl9T
VVJGQUNFX0FERFJFU1NfSElHSCwgQ1VSU09SX1NVUkZBQ0VfQUREUkVTU19ISUdILCBtYXNrX3No
KSwgXAorCUhVQlBfU0YoQ1VSU09SMF8wX0NVUlNPUl9TVVJGQUNFX0FERFJFU1MsIENVUlNPUl9T
VVJGQUNFX0FERFJFU1MsIG1hc2tfc2gpLCBcCisJSFVCUF9TRihDVVJTT1IwXzBfQ1VSU09SX1NJ
WkUsIENVUlNPUl9XSURUSCwgbWFza19zaCksIFwKKwlIVUJQX1NGKENVUlNPUjBfMF9DVVJTT1Jf
U0laRSwgQ1VSU09SX0hFSUdIVCwgbWFza19zaCksIFwKKwlIVUJQX1NGKENVUlNPUjBfMF9DVVJT
T1JfQ09OVFJPTCwgQ1VSU09SX01PREUsIG1hc2tfc2gpLCBcCisJSFVCUF9TRihDVVJTT1IwXzBf
Q1VSU09SX0NPTlRST0wsIENVUlNPUl8yWF9NQUdOSUZZLCBtYXNrX3NoKSwgXAorCUhVQlBfU0Yo
Q1VSU09SMF8wX0NVUlNPUl9DT05UUk9MLCBDVVJTT1JfUElUQ0gsIG1hc2tfc2gpLCBcCisJSFVC
UF9TRihDVVJTT1IwXzBfQ1VSU09SX0NPTlRST0wsIENVUlNPUl9MSU5FU19QRVJfQ0hVTkssIG1h
c2tfc2gpLCBcCisJSFVCUF9TRihDVVJTT1IwXzBfQ1VSU09SX0NPTlRST0wsIENVUlNPUl9FTkFC
TEUsIG1hc2tfc2gpLCBcCisJSFVCUF9TRihDVVJTT1IwXzBfQ1VSU09SX1BPU0lUSU9OLCBDVVJT
T1JfWF9QT1NJVElPTiwgbWFza19zaCksIFwKKwlIVUJQX1NGKENVUlNPUjBfMF9DVVJTT1JfUE9T
SVRJT04sIENVUlNPUl9ZX1BPU0lUSU9OLCBtYXNrX3NoKSwgXAorCUhVQlBfU0YoQ1VSU09SMF8w
X0NVUlNPUl9IT1RfU1BPVCwgQ1VSU09SX0hPVF9TUE9UX1gsIG1hc2tfc2gpLCBcCisJSFVCUF9T
RihDVVJTT1IwXzBfQ1VSU09SX0hPVF9TUE9ULCBDVVJTT1JfSE9UX1NQT1RfWSwgbWFza19zaCks
IFwKKwlIVUJQX1NGKENVUlNPUjBfMF9DVVJTT1JfRFNUX09GRlNFVCwgQ1VSU09SX0RTVF9YX09G
RlNFVCwgbWFza19zaCksIFwKKwlIVUJQX1NGKENVUlNPUjBfMF9ETURBVEFfQUREUkVTU19ISUdI
LCBETURBVEFfQUREUkVTU19ISUdILCBtYXNrX3NoKSwgXAorCUhVQlBfU0YoQ1VSU09SMF8wX0RN
REFUQV9DTlRMLCBETURBVEFfTU9ERSwgbWFza19zaCksIFwKKwlIVUJQX1NGKENVUlNPUjBfMF9E
TURBVEFfQ05UTCwgRE1EQVRBX1VQREFURUQsIG1hc2tfc2gpLCBcCisJSFVCUF9TRihDVVJTT1Iw
XzBfRE1EQVRBX0NOVEwsIERNREFUQV9SRVBFQVQsIG1hc2tfc2gpLCBcCisJSFVCUF9TRihDVVJT
T1IwXzBfRE1EQVRBX0NOVEwsIERNREFUQV9TSVpFLCBtYXNrX3NoKSwgXAorCUhVQlBfU0YoQ1VS
U09SMF8wX0RNREFUQV9TV19DTlRMLCBETURBVEFfU1dfVVBEQVRFRCwgbWFza19zaCksIFwKKwlI
VUJQX1NGKENVUlNPUjBfMF9ETURBVEFfU1dfQ05UTCwgRE1EQVRBX1NXX1JFUEVBVCwgbWFza19z
aCksIFwKKwlIVUJQX1NGKENVUlNPUjBfMF9ETURBVEFfU1dfQ05UTCwgRE1EQVRBX1NXX1NJWkUs
IG1hc2tfc2gpLCBcCisJSFVCUF9TRihDVVJTT1IwXzBfRE1EQVRBX1FPU19DTlRMLCBETURBVEFf
UU9TX01PREUsIG1hc2tfc2gpLCBcCisJSFVCUF9TRihDVVJTT1IwXzBfRE1EQVRBX1FPU19DTlRM
LCBETURBVEFfUU9TX0xFVkVMLCBtYXNrX3NoKSwgXAorCUhVQlBfU0YoQ1VSU09SMF8wX0RNREFU
QV9RT1NfQ05UTCwgRE1EQVRBX0RMX0RFTFRBLCBtYXNrX3NoKSwgXAorCUhVQlBfU0YoQ1VSU09S
MF8wX0RNREFUQV9TVEFUVVMsIERNREFUQV9ET05FLCBtYXNrX3NoKSxcCisJSFVCUF9TRihIVUJQ
UkVRMF9GTElQX1BBUkFNRVRFUlNfMCwgRFNUX1lfUEVSX1ZNX0ZMSVAsIG1hc2tfc2gpLFwKKwlI
VUJQX1NGKEhVQlBSRVEwX0ZMSVBfUEFSQU1FVEVSU18wLCBEU1RfWV9QRVJfUk9XX0ZMSVAsIG1h
c2tfc2gpLFwKKwlIVUJQX1NGKEhVQlBSRVEwX0ZMSVBfUEFSQU1FVEVSU18xLCBSRUZDWUNfUEVS
X1BURV9HUk9VUF9GTElQX0wsIG1hc2tfc2gpLFwKKwlIVUJQX1NGKEhVQlBSRVEwX0ZMSVBfUEFS
QU1FVEVSU18yLCBSRUZDWUNfUEVSX01FVEFfQ0hVTktfRkxJUF9MLCBtYXNrX3NoKSxcCisJSFVC
UF9TRihIVUJQMF9EQ0hVQlBfQ05UTCwgSFVCUF9WUkVBRFlfQVRfT1JfQUZURVJfVlNZTkMsIG1h
c2tfc2gpLFwKKwlIVUJQX1NGKEhVQlAwX0RDSFVCUF9DTlRMLCBIVUJQX0RJU0FCTEVfU1RPUF9E
QVRBX0RVUklOR19WTSwgbWFza19zaCksXAorCUhVQlBfU0YoSFVCUFJFUTBfRENTVVJGX0ZMSVBf
Q09OVFJPTCwgSFVCUFJFUV9NQVNURVJfVVBEQVRFX0xPQ0tfU1RBVFVTLCBtYXNrX3NoKSxcCisJ
SFVCUF9TRihIVUJQUkVRMF9EQ1NVUkZfRkxJUF9DT05UUk9MMiwgU1VSRkFDRV9HU0xfRU5BQkxF
LCBtYXNrX3NoKSxcCisJSFVCUF9TRihIVUJQUkVRMF9EQ1NVUkZfRkxJUF9DT05UUk9MMiwgU1VS
RkFDRV9UUklQTEVfQlVGRkVSX0VOQUJMRSwgbWFza19zaCksXAorCUhVQlBfU0YoSFVCUFJFUTBf
Vk1JRF9TRVRUSU5HU18wLCBWTUlELCBtYXNrX3NoKSxcCisJSFVCUF9TRihEQ05fVk1fU1lTVEVN
X0FQRVJUVVJFX0RFRkFVTFRfQUREUl9NU0IsIERDTl9WTV9TWVNURU1fQVBFUlRVUkVfREVGQVVM
VF9TWVNURU0sIG1hc2tfc2gpLFwKKwlIVUJQX1NGKERDTl9WTV9TWVNURU1fQVBFUlRVUkVfREVG
QVVMVF9BRERSX01TQiwgRENOX1ZNX1NZU1RFTV9BUEVSVFVSRV9ERUZBVUxUX0FERFJfTVNCLCBt
YXNrX3NoKSxcCisJSFVCUF9TRihEQ05fVk1fU1lTVEVNX0FQRVJUVVJFX0RFRkFVTFRfQUREUl9M
U0IsIERDTl9WTV9TWVNURU1fQVBFUlRVUkVfREVGQVVMVF9BRERSX0xTQiwgbWFza19zaCkKKwor
CisjZGVmaW5lIERDTjJfSFVCUF9SRUdfQ09NTU9OX1ZBUklBQkxFX0xJU1QgXAorCUhVQlBfQ09N
TU9OX1JFR19WQVJJQUJMRV9MSVNUOyBcCisJdWludDMyX3QgRE1EQVRBX0FERFJFU1NfSElHSDsg
XAorCXVpbnQzMl90IERNREFUQV9BRERSRVNTX0xPVzsgXAorCXVpbnQzMl90IERNREFUQV9DTlRM
OyBcCisJdWludDMyX3QgRE1EQVRBX1NXX0NOVEw7IFwKKwl1aW50MzJfdCBETURBVEFfUU9TX0NO
VEw7IFwKKwl1aW50MzJfdCBETURBVEFfU1dfREFUQTsgXAorCXVpbnQzMl90IERNREFUQV9TVEFU
VVM7XAorCXVpbnQzMl90IERDU1VSRl9GTElQX0NPTlRST0wyO1wKKwl1aW50MzJfdCBGTElQX1BB
UkFNRVRFUlNfMDtcCisJdWludDMyX3QgRkxJUF9QQVJBTUVURVJTXzE7XAorCXVpbnQzMl90IEZM
SVBfUEFSQU1FVEVSU18yO1wKKwl1aW50MzJfdCBEQ05fQ1VSMV9UVFVfQ05UTDE7XAorCXVpbnQz
Ml90IFZNSURfU0VUVElOR1NfMAorCisjZGVmaW5lIERDTjJfSFVCUF9SRUdfRklFTERfVkFSSUFC
TEVfTElTVCh0eXBlKSBcCisJRENOX0hVQlBfUkVHX0ZJRUxEX0xJU1QodHlwZSk7IFwKKwl0eXBl
IERNREFUQV9BRERSRVNTX0hJR0g7XAorCXR5cGUgRE1EQVRBX01PREU7XAorCXR5cGUgRE1EQVRB
X1VQREFURUQ7XAorCXR5cGUgRE1EQVRBX1JFUEVBVDtcCisJdHlwZSBETURBVEFfU0laRTtcCisJ
dHlwZSBETURBVEFfU1dfVVBEQVRFRDtcCisJdHlwZSBETURBVEFfU1dfUkVQRUFUO1wKKwl0eXBl
IERNREFUQV9TV19TSVpFO1wKKwl0eXBlIERNREFUQV9RT1NfTU9ERTtcCisJdHlwZSBETURBVEFf
UU9TX0xFVkVMO1wKKwl0eXBlIERNREFUQV9ETF9ERUxUQTtcCisJdHlwZSBETURBVEFfRE9ORTtc
CisJdHlwZSBEU1RfWV9QRVJfVk1fRkxJUDtcCisJdHlwZSBEU1RfWV9QRVJfUk9XX0ZMSVA7XAor
CXR5cGUgUkVGQ1lDX1BFUl9QVEVfR1JPVVBfRkxJUF9MO1wKKwl0eXBlIFJFRkNZQ19QRVJfTUVU
QV9DSFVOS19GTElQX0w7XAorCXR5cGUgSFVCUF9WUkVBRFlfQVRfT1JfQUZURVJfVlNZTkM7XAor
CXR5cGUgSFVCUF9ESVNBQkxFX1NUT1BfREFUQV9EVVJJTkdfVk07XAorCXR5cGUgSFVCUFJFUV9N
QVNURVJfVVBEQVRFX0xPQ0tfU1RBVFVTO1wKKwl0eXBlIFNVUkZBQ0VfR1NMX0VOQUJMRTtcCisJ
dHlwZSBTVVJGQUNFX1RSSVBMRV9CVUZGRVJfRU5BQkxFO1wKKwl0eXBlIFZNSUQKKworc3RydWN0
IGRjbl9odWJwMl9yZWdpc3RlcnMgeworCURDTjJfSFVCUF9SRUdfQ09NTU9OX1ZBUklBQkxFX0xJ
U1Q7Cit9OworCitzdHJ1Y3QgZGNuX2h1YnAyX3NoaWZ0IHsKKwlEQ04yX0hVQlBfUkVHX0ZJRUxE
X1ZBUklBQkxFX0xJU1QodWludDhfdCk7Cit9OworCitzdHJ1Y3QgZGNuX2h1YnAyX21hc2sgewor
CURDTjJfSFVCUF9SRUdfRklFTERfVkFSSUFCTEVfTElTVCh1aW50MzJfdCk7Cit9OworCitzdHJ1
Y3QgZGNuMjBfaHVicCB7CisJc3RydWN0IGh1YnAgYmFzZTsKKwlzdHJ1Y3QgZGNuX2h1YnBfc3Rh
dGUgc3RhdGU7CisJY29uc3Qgc3RydWN0IGRjbl9odWJwMl9yZWdpc3RlcnMgKmh1YnBfcmVnczsK
Kwljb25zdCBzdHJ1Y3QgZGNuX2h1YnAyX3NoaWZ0ICpodWJwX3NoaWZ0OworCWNvbnN0IHN0cnVj
dCBkY25faHVicDJfbWFzayAqaHVicF9tYXNrOworfTsKKworYm9vbCBodWJwMl9jb25zdHJ1Y3Qo
CisJCXN0cnVjdCBkY24yMF9odWJwICpodWJwMiwKKwkJc3RydWN0IGRjX2NvbnRleHQgKmN0eCwK
KwkJdWludDMyX3QgaW5zdCwKKwkJY29uc3Qgc3RydWN0IGRjbl9odWJwMl9yZWdpc3RlcnMgKmh1
YnBfcmVncywKKwkJY29uc3Qgc3RydWN0IGRjbl9odWJwMl9zaGlmdCAqaHVicF9zaGlmdCwKKwkJ
Y29uc3Qgc3RydWN0IGRjbl9odWJwMl9tYXNrICpodWJwX21hc2spOworCit2b2lkIGh1YnAyX3Nl
dHVwX2ludGVyZGVwZW5kZW50KAorCQlzdHJ1Y3QgaHVicCAqaHVicCwKKwkJc3RydWN0IF92Y3Nf
ZHBpX2Rpc3BsYXlfZGxnX3JlZ3Nfc3QgKmRsZ19hdHRyLAorCQlzdHJ1Y3QgX3Zjc19kcGlfZGlz
cGxheV90dHVfcmVnc19zdCAqdHR1X2F0dHIpOworCit2b2lkIGh1YnAyX3ZyZWFkeV9hdF9vcl9B
ZnRlcl92c3luYyhzdHJ1Y3QgaHVicCAqaHVicCwKKwkJc3RydWN0IF92Y3NfZHBpX2Rpc3BsYXlf
cGlwZV9kZXN0X3BhcmFtc19zdCAqcGlwZV9kZXN0KTsKKwordm9pZCBodWJwMl91cGRhdGVfZGNo
dWIoCisJCXN0cnVjdCBodWJwICpodWJwLAorCQlzdHJ1Y3QgZGNodWJfaW5pdF9kYXRhICpkaF9k
YXRhKTsKKwordm9pZCBodWJwMl9jdXJzb3Jfc2V0X2F0dHJpYnV0ZXMoCisJCXN0cnVjdCBodWJw
ICpodWJwLAorCQljb25zdCBzdHJ1Y3QgZGNfY3Vyc29yX2F0dHJpYnV0ZXMgKmF0dHIpOworCit2
b2lkIGh1YnAyX3NldF92bV9zeXN0ZW1fYXBlcnR1cmVfc2V0dGluZ3Moc3RydWN0IGh1YnAgKmh1
YnAsCisJCXN0cnVjdCB2bV9zeXN0ZW1fYXBlcnR1cmVfcGFyYW0gKmFwdCk7CisKK2VudW0gY3Vy
c29yX2xpbmVzX3Blcl9jaHVuayBodWJwMl9nZXRfbGluZXNfcGVyX2NodW5rKAorCQl1bnNpZ25l
ZCBpbnQgY3Vyc29yX3dpZHRoLAorCQllbnVtIGRjX2N1cnNvcl9jb2xvcl9mb3JtYXQgY3Vyc29y
X21vZGUpOworCit2b2lkIGh1YnAyX2RtZGF0YV9zZXRfYXR0cmlidXRlcygKKwkJc3RydWN0IGh1
YnAgKmh1YnAsCisJCWNvbnN0IHN0cnVjdCBkY19kbWRhdGFfYXR0cmlidXRlcyAqYXR0cik7CisK
K3ZvaWQgaHVicDJfZG1kYXRhX2xvYWQoCisJCXN0cnVjdCBodWJwICpodWJwLAorCQl1aW50MzJf
dCBkbWRhdGFfc3dfc2l6ZSwKKwkJY29uc3QgdWludDMyX3QgKmRtZGF0YV9zd19kYXRhKTsKKwor
Ym9vbCBodWJwMl9kbWRhdGFfc3RhdHVzX2RvbmUoc3RydWN0IGh1YnAgKmh1YnApOworCit2b2lk
IGh1YnAyX2VuYWJsZV90cmlwbGVidWZmZXIoCisJCXN0cnVjdCBodWJwICpodWJwLAorCQlib29s
IGVuYWJsZSk7CisKK2Jvb2wgaHVicDJfaXNfdHJpcGxlYnVmZmVyX2VuYWJsZWQoCisJCXN0cnVj
dCBodWJwICpodWJwKTsKKwordm9pZCBodWJwMl9zZXRfZmxpcF9jb250cm9sX3N1cmZhY2VfZ3Ns
KHN0cnVjdCBodWJwICpodWJwLCBib29sIGVuYWJsZSk7CisKKyNlbmRpZiAvKiBfX0RDX01FTV9J
TlBVVF9EQ04yMF9IX18gKi8KKworCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rp
c3BsYXkvZGMvaW5jL2h3L2RjaHViYnViLmggYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkv
ZGMvaW5jL2h3L2RjaHViYnViLmgKaW5kZXggOTM2NjdlOGIyM2IzLi5kNTZmZDdkODdiYmMgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHcvZGNodWJidWIu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3L2RjaHViYnViLmgK
QEAgLTUyLDExICs1Miw3MyBAQCBzdHJ1Y3QgZGNuX2h1YmJ1Yl93bSB7CiAJc3RydWN0IGRjbl9o
dWJidWJfd21fc2V0IHNldHNbNF07CiB9OwogCisjaWZkZWYgQ09ORklHX0RSTV9BTURfRENfRENO
Ml8wCitlbnVtIGRjbl9odWJidWJfcGFnZV90YWJsZV9kZXB0aCB7CisJRENOX1BBR0VfVEFCTEVf
REVQVEhfMV9MRVZFTCwKKwlEQ05fUEFHRV9UQUJMRV9ERVBUSF8yX0xFVkVMLAorCURDTl9QQUdF
X1RBQkxFX0RFUFRIXzNfTEVWRUwsCisJRENOX1BBR0VfVEFCTEVfREVQVEhfNF9MRVZFTAorfTsK
KworZW51bSBkY25faHViYnViX3BhZ2VfdGFibGVfYmxvY2tfc2l6ZSB7CisJRENOX1BBR0VfVEFC
TEVfQkxPQ0tfU0laRV80S0IsCisJRENOX1BBR0VfVEFCTEVfQkxPQ0tfU0laRV82NEtCCit9Owor
CitzdHJ1Y3QgZGNuX2h1YmJ1Yl9waHlzX2FkZHJfY29uZmlnIHsKKwlzdHJ1Y3QgeworCQl1aW50
NjRfdCBmYl90b3A7CisJCXVpbnQ2NF90IGZiX29mZnNldDsKKwkJdWludDY0X3QgZmJfYmFzZTsK
KwkJdWludDY0X3QgYWdwX3RvcDsKKwkJdWludDY0X3QgYWdwX2JvdDsKKwkJdWludDY0X3QgYWdw
X2Jhc2U7CisJfSBzeXN0ZW1fYXBlcnR1cmU7CisKKwlzdHJ1Y3QgeworCQl1aW50NjRfdCBwYWdl
X3RhYmxlX3N0YXJ0X2FkZHI7CisJCXVpbnQ2NF90IHBhZ2VfdGFibGVfZW5kX2FkZHI7CisJCXVp
bnQ2NF90IHBhZ2VfdGFibGVfYmFzZV9hZGRyOworCX0gZ2FydF9jb25maWc7Cit9OworCitzdHJ1
Y3QgZGNuX2h1YmJ1Yl92aXJ0X2FkZHJfY29uZmlnIHsKKwl1aW50NjRfdAkJCQlwYWdlX3RhYmxl
X3N0YXJ0X2FkZHI7CisJdWludDY0X3QJCQkJcGFnZV90YWJsZV9lbmRfYWRkcjsKKwllbnVtIGRj
bl9odWJidWJfcGFnZV90YWJsZV9ibG9ja19zaXplCXBhZ2VfdGFibGVfYmxvY2tfc2l6ZTsKKwll
bnVtIGRjbl9odWJidWJfcGFnZV90YWJsZV9kZXB0aAlwYWdlX3RhYmxlX2RlcHRoOworfTsKKwor
c3RydWN0IGh1YmJ1Yl9hZGRyX2NvbmZpZyB7CisJc3RydWN0IGRjbl9odWJidWJfcGh5c19hZGRy
X2NvbmZpZyBwYV9jb25maWc7CisJc3RydWN0IGRjbl9odWJidWJfdmlydF9hZGRyX2NvbmZpZyB2
YV9jb25maWc7CisJc3RydWN0IHsKKwkJdWludDY0X3QgYXBlcnR1cmVfY2hlY2tfZmF1bHQ7CisJ
CXVpbnQ2NF90IGdlbmVyaWNfZmF1bHQ7CisJfSBkZWZhdWx0X2FkZHJzOworfTsKKworI2VuZGlm
CiBzdHJ1Y3QgaHViYnViX2Z1bmNzIHsKIAl2b2lkICgqdXBkYXRlX2RjaHViKSgKIAkJCXN0cnVj
dCBodWJidWIgKmh1YmJ1YiwKIAkJCXN0cnVjdCBkY2h1Yl9pbml0X2RhdGEgKmRoX2RhdGEpOwog
CisjaWZkZWYgQ09ORklHX0RSTV9BTURfRENfRENOMl8wCisJdm9pZCAoKmluaXRfZGNodWIpKAor
CQkJc3RydWN0IGh1YmJ1YiAqaHViYnViLAorCQkJc3RydWN0IGh1YmJ1Yl9hZGRyX2NvbmZpZyAq
Y29uZmlnKTsKKwl2b2lkICgqc2V0dXBfdm1pZF9wdGIpKAorCQkJc3RydWN0IGh1YmJ1YiAqaHVi
YnViLAorCQkJdWludDY0X3QgcHRiLAorCQkJdWludDhfdCB2bWlkKTsKKworCXZvaWQgKCpzZXRf
cHRiKSgKKwkJCXN0cnVjdCBodWJidWIgKmh1YmJ1YiwKKwkJCXVpbnQ4X3Qgdm1pZCwKKwkJCXVp
bnQ2NF90IGJhc2VfYWRkcik7CisKKyNlbmRpZgogCWJvb2wgKCpnZXRfZGNjX2NvbXByZXNzaW9u
X2NhcCkoc3RydWN0IGh1YmJ1YiAqaHViYnViLAogCQkJY29uc3Qgc3RydWN0IGRjX2RjY19zdXJm
YWNlX3BhcmFtICppbnB1dCwKIAkJCXN0cnVjdCBkY19zdXJmYWNlX2RjY19jYXAgKm91dHB1dCk7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3BsYXkvZGMvaW5jL2h3L2h1YnAu
aCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvZGlzcGxheS9kYy9pbmMvaHcvaHVicC5oCmluZGV4IDQ1
NWRmNDk5OTc5Ny4uZTdhMjFmYzk4NDViIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1k
L2Rpc3BsYXkvZGMvaW5jL2h3L2h1YnAuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Rpc3Bs
YXkvZGMvaW5jL2h3L2h1YnAuaApAQCAtMzYsNiArMzYsOSBAQCBlbnVtIGN1cnNvcl9waXRjaCB7
CiB9OwogCiBlbnVtIGN1cnNvcl9saW5lc19wZXJfY2h1bmsgeworI2lmIGRlZmluZWQoQ09ORklH
X0RSTV9BTURfRENfRENOMl8wKQorCUNVUlNPUl9MSU5FX1BFUl9DSFVOS18xID0gMCwgLyogbmV3
IGZvciBEQ04yICovCisjZW5kaWYKIAlDVVJTT1JfTElORV9QRVJfQ0hVTktfMiA9IDEsCiAJQ1VS
U09SX0xJTkVfUEVSX0NIVU5LXzQsCiAJQ1VSU09SX0xJTkVfUEVSX0NIVU5LXzgsCkBAIC0xMzIs
NiArMTM1LDI4IEBAIHN0cnVjdCBodWJwX2Z1bmNzIHsKIAl1bnNpZ25lZCBpbnQgKCpodWJwX2dl
dF91bmRlcmZsb3dfc3RhdHVzKShzdHJ1Y3QgaHVicCAqaHVicCk7CiAJdm9pZCAoKmh1YnBfaW5p
dCkoc3RydWN0IGh1YnAgKmh1YnApOwogCisjaWYgZGVmaW5lZChDT05GSUdfRFJNX0FNRF9EQ19E
Q04yXzApCisJdm9pZCAoKmRtZGF0YV9zZXRfYXR0cmlidXRlcykoCisJCQlzdHJ1Y3QgaHVicCAq
aHVicCwKKwkJCWNvbnN0IHN0cnVjdCBkY19kbWRhdGFfYXR0cmlidXRlcyAqYXR0cik7CisKKwl2
b2lkICgqZG1kYXRhX2xvYWQpKAorCQkJc3RydWN0IGh1YnAgKmh1YnAsCisJCQl1aW50MzJfdCBk
bWRhdGFfc3dfc2l6ZSwKKwkJCWNvbnN0IHVpbnQzMl90ICpkbWRhdGFfc3dfZGF0YSk7CisJYm9v
bCAoKmRtZGF0YV9zdGF0dXNfZG9uZSkoc3RydWN0IGh1YnAgKmh1YnApOworCXZvaWQoKmh1YnBf
ZW5hYmxlX3RyaXBsZUJ1ZmZlcikoCisJCXN0cnVjdCBodWJwICpodWJwLAorCQlib29sIGVuYWJs
ZSk7CisKKwlib29sKCpodWJwX2lzX3RyaXBsZWJ1ZmZlcl9lbmFibGVkKSgKKwkJc3RydWN0IGh1
YnAgKmh1YnApOworCisJdm9pZCAoKmh1YnBfc2V0X2ZsaXBfY29udHJvbF9zdXJmYWNlX2dzbCko
CisJCXN0cnVjdCBodWJwICpodWJwLAorCQlib29sIGVuYWJsZSk7CisjZW5kaWYKKwogfTsKIAog
I2VuZGlmCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vYW1kLWdm
eA==
