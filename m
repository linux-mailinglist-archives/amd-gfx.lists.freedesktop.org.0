Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id BEC0C63FB5
	for <lists+amd-gfx@lfdr.de>; Wed, 10 Jul 2019 05:52:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4056089951;
	Wed, 10 Jul 2019 03:52:44 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from NAM02-CY1-obe.outbound.protection.outlook.com
 (mail-eopbgr760084.outbound.protection.outlook.com [40.107.76.84])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 07A6089951
 for <amd-gfx@lists.freedesktop.org>; Wed, 10 Jul 2019 03:52:42 +0000 (UTC)
Received: from DM6PR12MB3947.namprd12.prod.outlook.com (10.255.174.156) by
 DM6PR12MB3196.namprd12.prod.outlook.com (20.179.105.15) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2052.18; Wed, 10 Jul 2019 03:52:39 +0000
Received: from DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::91a2:f9e7:8c86:f927]) by DM6PR12MB3947.namprd12.prod.outlook.com
 ([fe80::91a2:f9e7:8c86:f927%7]) with mapi id 15.20.2052.020; Wed, 10 Jul 2019
 03:52:39 +0000
From: "Kuehling, Felix" <Felix.Kuehling@amd.com>
To: "amd-gfx@lists.freedesktop.org" <amd-gfx@lists.freedesktop.org>
Subject: [PATCH 1/1] drm/amdgpu: Dump PDEs and PTEs on VM faults
Thread-Topic: [PATCH 1/1] drm/amdgpu: Dump PDEs and PTEs on VM faults
Thread-Index: AQHVNtLrBRwIA9f76k+TZZijbAwlHg==
Date: Wed, 10 Jul 2019 03:52:39 +0000
Message-ID: <20190710035220.26733-1-Felix.Kuehling@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [165.204.55.251]
x-mailer: git-send-email 2.17.1
x-clientproxiedby: YTXPR0101CA0053.CANPRD01.PROD.OUTLOOK.COM
 (2603:10b6:b00:1::30) To DM6PR12MB3947.namprd12.prod.outlook.com
 (2603:10b6:5:1cb::28)
x-ms-exchange-messagesentrepresentingtype: 1
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: af9604f0-3231-4c08-4e5a-08d704ea0dcb
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);
 SRVR:DM6PR12MB3196; 
x-ms-traffictypediagnostic: DM6PR12MB3196:
x-microsoft-antispam-prvs: <DM6PR12MB3196D21962ACCA8AFAA29B1892F00@DM6PR12MB3196.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:369;
x-forefront-prvs: 0094E3478A
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(376002)(346002)(396003)(136003)(39860400002)(366004)(199004)(189003)(81156014)(81166006)(186003)(99286004)(68736007)(6506007)(476003)(386003)(2616005)(256004)(36756003)(2501003)(6916009)(50226002)(305945005)(486006)(52116002)(53936002)(14444005)(7736002)(64756008)(66556008)(66446008)(5660300002)(66946007)(102836004)(66476007)(14454004)(26005)(8676002)(8936002)(5640700003)(86362001)(6486002)(6436002)(6116002)(66066001)(3846002)(1076003)(6512007)(71200400001)(71190400001)(2351001)(2906002)(316002)(478600001)(25786009)(4326008);
 DIR:OUT; SFP:1101; SCL:1; SRVR:DM6PR12MB3196;
 H:DM6PR12MB3947.namprd12.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: wYUXaK6JuTydX79CzY/5n/LzXYPOdmnbglAnV7k1FTakjPwy9kaKkxBQM39Mg7w+RRPGYp5Qx/i0FM9u+54mIuCSaBdSdsPeo/zLJ5QQmcrzUQZzitFnRMud0J0TknUH3r/4m/RQyronODZiyzOULgV0fMrkkEKqP0d04AmqrYbKDxdMcYYC8kOQ2wJRdn/mkucn3DQ+HrkmsAhXx+mr60Zps8yB/wUtpMSWDjoxe+6OO4ywI0SEbCy10paJ6AsPx9egGo3hLIW2lrJqebRrrICzuup4rzk+1HW4VJ5KUSVJurb4P32dF/W1OGiJ83dS6kiq+yhRLaRqpYfKEcT0fe04xSB27IK7Zq3SsMO+XncuwMTkGEXpfObem+g9NrGdo3U6IZxxEbSMU/ArfK2cJQvRq2t8rfD/cPdoliNws9k=
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: af9604f0-3231-4c08-4e5a-08d704ea0dcb
X-MS-Exchange-CrossTenant-originalarrivaltime: 10 Jul 2019 03:52:39.7959 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: fkuehlin@amd.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB3196
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=pmhJNtTAvWaBiPUfdEt6Kc8FQYjQkz/ZWjrZDu5wep4=;
 b=c1rTeMqnCJOn7n6rgebgdT+GDyVo07miMJjI6eFvPxfwXQ5kIQiX0m29BUfCNxKnsOWlDcirtqSVYWz/H0pDx8zfopt6v6/tZZHCvmOpQvyQ/qOQB1G3LVX9cOsxTWkl5q4F76vYWgzsc5CQfxLUwRz745iw0nrnjlmkjs2R49I=
X-Mailman-Original-Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=Felix.Kuehling@amd.com; 
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Kuehling, Felix" <Felix.Kuehling@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

V2FsayBwYWdlIHRhYmxlIGZvciB0aGUgZmF1bHRpbmcgYWRkcmVzcyBhbmQgZHVtcCBQREVzIGFu
ZCBQVEVzIGF0CmFsbCBsZXZlbHMuIEFsc28gZmxhZyBkaXNjcmVwYW5jaWVzIHdoZXJlIGEgUERF
IHBvaW50cyB0byBhIGRpZmZlcmVudAphZGRyZXNzIHRoYW4gdGhlIG5leHQgbGV2ZWwgUERCIG9y
IFBUQiBCTy4KClNpZ25lZC1vZmYtYnk6IEZlbGl4IEt1ZWhsaW5nIDxGZWxpeC5LdWVobGluZ0Bh
bWQuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYyB8ICA1
ICstCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmggfCAgMiArCiBkcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYyAgfCA3NCArKysrKysrKysrKysrKysr
KysrKysrKystCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uaCAgfCAgNyAr
Ky0KIGRyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OF8wLmMgICB8ICA1ICstCiBkcml2
ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjlfMC5jICAgfCAgNSArLQogNiBmaWxlcyBjaGFu
Z2VkLCA4OSBpbnNlcnRpb25zKCspLCA5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV90dG0uYwppbmRleCBiYmJmMDY5ZWZiNzcuLjc4NDQwNzQ4Yzg3ZiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X3R0bS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uYwpAQCAtMTUwNSw5ICsxNTA1LDgg
QEAgc3RhdGljIGJvb2wgYW1kZ3B1X3R0bV9ib19ldmljdGlvbl92YWx1YWJsZShzdHJ1Y3QgdHRt
X2J1ZmZlcl9vYmplY3QgKmJvLAogICogVGhpcyBpcyB1c2VkIHRvIGFjY2VzcyBWUkFNIHRoYXQg
YmFja3MgYSBidWZmZXIgb2JqZWN0IHZpYSBNTUlPCiAgKiBhY2Nlc3MgZm9yIGRlYnVnZ2luZyBw
dXJwb3Nlcy4KICAqLwotc3RhdGljIGludCBhbWRncHVfdHRtX2FjY2Vzc19tZW1vcnkoc3RydWN0
IHR0bV9idWZmZXJfb2JqZWN0ICpibywKLQkJCQkgICAgdW5zaWduZWQgbG9uZyBvZmZzZXQsCi0J
CQkJICAgIHZvaWQgKmJ1ZiwgaW50IGxlbiwgaW50IHdyaXRlKQoraW50IGFtZGdwdV90dG1fYWNj
ZXNzX21lbW9yeShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLCB1bnNpZ25lZCBsb25nIG9m
ZnNldCwKKwkJCSAgICAgdm9pZCAqYnVmLCBpbnQgbGVuLCBpbnQgd3JpdGUpCiB7CiAJc3RydWN0
IGFtZGdwdV9ibyAqYWJvID0gdHRtX3RvX2FtZGdwdV9ibyhibyk7CiAJc3RydWN0IGFtZGdwdV9k
ZXZpY2UgKmFkZXYgPSBhbWRncHVfdHRtX2FkZXYoYWJvLT50Ym8uYmRldik7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmggYi9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmgKaW5kZXggYmNjYjhjNDllNTk3Li5jZmZiYWZmZmE5
ZDcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV90dG0uaAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdHRtLmgKQEAgLTgzLDYgKzgz
LDggQEAgdm9pZCBhbWRncHVfdHRtX2Zpbmkoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYpOwog
dm9pZCBhbWRncHVfdHRtX3NldF9idWZmZXJfZnVuY3Nfc3RhdHVzKHN0cnVjdCBhbWRncHVfZGV2
aWNlICphZGV2LAogCQkJCQlib29sIGVuYWJsZSk7CiAKK2ludCBhbWRncHVfdHRtX2FjY2Vzc19t
ZW1vcnkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgdW5zaWduZWQgbG9uZyBvZmZzZXQs
CisJCQkgICAgIHZvaWQgKmJ1ZiwgaW50IGxlbiwgaW50IHdyaXRlKTsKIGludCBhbWRncHVfY29w
eV9idWZmZXIoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nLCB1aW50NjRfdCBzcmNfb2Zmc2V0LAog
CQkgICAgICAgdWludDY0X3QgZHN0X29mZnNldCwgdWludDMyX3QgYnl0ZV9jb3VudCwKIAkJICAg
ICAgIHN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YsCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV92bS5jCmluZGV4IDE5NTFmMmFiYmRiYy4uMTU1MWMxMjUyYTZiIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYwpAQCAtNTQ0LDYgKzU0NCw3MyBAQCBzdGF0
aWMgdm9pZCBhbWRncHVfdm1fcHRfbmV4dF9kZnMoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYs
CiAJICAgICBhbWRncHVfdm1fcHRfY29udGludWVfZGZzKChzdGFydCksIChlbnRyeSkpOwkJCVwK
IAkgICAgIChlbnRyeSkgPSAoY3Vyc29yKS5lbnRyeSwgYW1kZ3B1X3ZtX3B0X25leHRfZGZzKChh
ZGV2KSwgJihjdXJzb3IpKSkKIAorLyoqCisgKiBhbWRncHVfdm1fZHVtcF9wdGUgLSBkdW1wIFBU
RXMgYWxvbmcgYSBwYWdlIHRhYmxlIHdhbGsKKyAqCisgKiBAYWRldjogYW1kZ3B1IGRldmljZSBw
b2ludGVyCisgKiBAdm06IFZNIGFkZHJlc3Mgc3BhY2UKKyAqIEBhZGRyOiB2aXJ0dWFsIGFkZHJl
c3MKKyAqCisgKiBXYWxrcyB0aGUgcGFnZSB0YWJsZSBvZiBAdm0gYXQgdGhlIGdpdmVuIEBhZGRy
IGFuZCBwcmludHMgdGhlIFBERXMKKyAqIGFuZCBQVEVzIGFsb25nIHRoZSB3YXkgb24gYSBzaW5n
bGUgbGluZS4KKyAqLwordm9pZCBhbWRncHVfdm1fZHVtcF9wdGUoc3RydWN0IGFtZGdwdV9kZXZp
Y2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtLAorCQkJdWludDY0X3QgYWRkcikKK3sKKwlz
dGF0aWMgY29uc3QgY2hhciAqbGV2ZWxbNF0gPSB7IlBERTIiLCAiUERFMSIsICJQREUwIiwgIlBU
RSJ9OworCXVpbnQ2NF90IGxhc3RfYWRkciA9IHZtLT5yb290LmJhc2UuYm8tPnRiby5vZmZzZXQg
LQorCQlhZGV2LT5nbWMudnJhbV9zdGFydDsKKwlzdHJ1Y3QgYW1kZ3B1X3ZtX3B0X2N1cnNvciBj
dXJzb3I7CisJY2hhciBidWZbMTI4XTsKKwlpbnQgaSA9IDA7CisKKwlhbWRncHVfdm1fcHRfc3Rh
cnQoYWRldiwgdm0sIGFkZHIgPj4gUEFHRV9TSElGVCwgJmN1cnNvcik7CisKKwlkbyB7CisJCXVu
c2lnbmVkIGludCBtYXNrLCBzaGlmdCwgaWR4OworCQlzdHJ1Y3QgYW1kZ3B1X2JvICpibzsKKwkJ
dWludDY0X3QgcHRlOworCisJCW1hc2sgPSBhbWRncHVfdm1fZW50cmllc19tYXNrKGFkZXYsIGN1
cnNvci5sZXZlbCk7CisJCXNoaWZ0ID0gYW1kZ3B1X3ZtX2xldmVsX3NoaWZ0KGFkZXYsIGN1cnNv
ci5sZXZlbCk7CisJCWlkeCA9IChjdXJzb3IucGZuID4+IHNoaWZ0KSAmIG1hc2s7CisKKwkJYm8g
PSBjdXJzb3IuZW50cnktPmJhc2UuYm87CisJCWlmIChibykgeworCQkJLyogRmxhZyBkaXNjcmVw
YW5jeSBiZXR3ZWVuIHByZXZpb3VzIGxldmVsIFBERQorCQkJICogYW5kIHRoZSBhY3R1YWwgYWRk
cmVzcyBvZiB0aGlzIFBUQiBvciBQREIuCisJCQkgKi8KKwkJCWlmIChiby0+dGJvLm9mZnNldCAt
IGFkZXYtPmdtYy52cmFtX3N0YXJ0ICE9IGxhc3RfYWRkcikKKwkJCQlpICs9IHNucHJpbnRmKGJ1
ZiArIGksIHNpemVvZihidWYpIC0gaSwgIiEiKTsKKworCQkJYW1kZ3B1X3R0bV9hY2Nlc3NfbWVt
b3J5KCZiby0+dGJvLCBpZHggKiBzaXplb2YocHRlKSwKKwkJCQkJCSAmcHRlLCBzaXplb2YocHRl
KSwgZmFsc2UpOworCQkJaSArPSBzbnByaW50ZihidWYgKyBpLCBzaXplb2YoYnVmKSAtIGksCisJ
CQkJICAgICAgIiVzWyVkXTogMHglbGx4ICIsCisJCQkJICAgICAgbGV2ZWxbY3Vyc29yLmxldmVs
XSwgaWR4LCBwdGUpOworCQkJbGFzdF9hZGRyID0gKHB0ZSAmIEFNREdQVV9QVEVfVkFMSUQpID8K
KwkJCQkocHRlICYgMHhmZmZmZmZmZjAwMCkgOiAwOworCQl9IGVsc2UgeworCQkJLyogRmxhZyBk
aXNjcmVwYW5jeSBpZiBwcmV2aW91cyBsZXZlbCBQREUgaGFkCisJCQkgKiBhIHZhbGlkIGVudHJ5
IGJ1dCB0aGVyZSBpcyBubyBQVEIgb3IgUERCIEJPLgorCQkJICovCisJCQlpZiAobGFzdF9hZGRy
KQorCQkJCWkgKz0gc25wcmludGYoYnVmICsgaSwgc2l6ZW9mKGJ1ZikgLSBpLCAiISIpOworCQkJ
aSArPSBzbnByaW50ZihidWYgKyBpLCBzaXplb2YoYnVmKSAtIGksCisJCQkJICAgICAgIiVzWyVk
XTogbm8gYm8gIiwKKwkJCQkgICAgICBsZXZlbFtjdXJzb3IubGV2ZWxdLCBpZHgpOworCQkJbGFz
dF9hZGRyID0gMDsKKwkJfQorCisJCSsrY3Vyc29yLmxldmVsOworCQljdXJzb3IucGFyZW50ID0g
Y3Vyc29yLmVudHJ5OworCQlpZiAoIWN1cnNvci5lbnRyeS0+ZW50cmllcykKKwkJCWJyZWFrOwor
CQljdXJzb3IuZW50cnkgPSAmY3Vyc29yLmVudHJ5LT5lbnRyaWVzW2lkeF07CisJfSB3aGlsZSAo
Y3Vyc29yLmVudHJ5KTsKKwlkZXZfZXJyKGFkZXYtPmRldiwgIiVzIiwgYnVmKTsKK30KKwogLyoq
CiAgKiBhbWRncHVfdm1fZ2V0X3BkX2JvIC0gYWRkIHRoZSBWTSBQRCB0byBhIHZhbGlkYXRpb24g
bGlzdAogICoKQEAgLTMwODEsOCArMzE0OCw5IEBAIGludCBhbWRncHVfdm1faW9jdGwoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwgc3RydWN0IGRybV9maWxlICpmaWxwKQogICog
QHBhc2lkOiBQQVNJRCBpZGVudGlmaWVyIGZvciBWTQogICogQHRhc2tfaW5mbzogdGFza19pbmZv
IHRvIGZpbGwuCiAgKi8KLXZvaWQgYW1kZ3B1X3ZtX2dldF90YXNrX2luZm8oc3RydWN0IGFtZGdw
dV9kZXZpY2UgKmFkZXYsIHVuc2lnbmVkIGludCBwYXNpZCwKLQkJCSBzdHJ1Y3QgYW1kZ3B1X3Rh
c2tfaW5mbyAqdGFza19pbmZvKQorc3RydWN0IGFtZGdwdV92bSAqYW1kZ3B1X3ZtX2dldF90YXNr
X2luZm8oc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCisJCQkJCSAgdW5zaWduZWQgaW50IHBh
c2lkLAorCQkJCQkgIHN0cnVjdCBhbWRncHVfdGFza19pbmZvICp0YXNrX2luZm8pCiB7CiAJc3Ry
dWN0IGFtZGdwdV92bSAqdm07CiAJdW5zaWduZWQgbG9uZyBmbGFnczsKQEAgLTMwOTQsNiArMzE2
Miw4IEBAIHZvaWQgYW1kZ3B1X3ZtX2dldF90YXNrX2luZm8oc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYsIHVuc2lnbmVkIGludCBwYXNpZCwKIAkJKnRhc2tfaW5mbyA9IHZtLT50YXNrX2luZm87
CiAKIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZhZGV2LT52bV9tYW5hZ2VyLnBhc2lkX2xvY2ss
IGZsYWdzKTsKKworCXJldHVybiB2bTsKIH0KIAogLyoqCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uaCBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1
L2FtZGdwdV92bS5oCmluZGV4IDQ4OWExNjJjYTYyMC4uNmE4YjgzM2QxODBlIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uaAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uaApAQCAtMzQ4LDYgKzM0OCw4IEBAIGludCBhbWRn
cHVfdm1faW5pdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwgc3RydWN0IGFtZGdwdV92bSAq
dm0sCiBpbnQgYW1kZ3B1X3ZtX21ha2VfY29tcHV0ZShzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwgc3RydWN0IGFtZGdwdV92bSAqdm0sIHVuc2lnbmVkIGludCBwYXNpZCk7CiB2b2lkIGFtZGdw
dV92bV9yZWxlYXNlX2NvbXB1dGUoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHN0cnVjdCBh
bWRncHVfdm0gKnZtKTsKIHZvaWQgYW1kZ3B1X3ZtX2Zpbmkoc3RydWN0IGFtZGdwdV9kZXZpY2Ug
KmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtKTsKK3ZvaWQgYW1kZ3B1X3ZtX2R1bXBfcHRlKHN0
cnVjdCBhbWRncHVfZGV2aWNlICphZGV2LCBzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwKKwkJCXVpbnQ2
NF90IGFkZHIpOwogdm9pZCBhbWRncHVfdm1fZ2V0X3BkX2JvKHN0cnVjdCBhbWRncHVfdm0gKnZt
LAogCQkJIHN0cnVjdCBsaXN0X2hlYWQgKnZhbGlkYXRlZCwKIAkJCSBzdHJ1Y3QgYW1kZ3B1X2Jv
X2xpc3RfZW50cnkgKmVudHJ5KTsKQEAgLTQwMSw4ICs0MDMsOSBAQCBib29sIGFtZGdwdV92bV9u
ZWVkX3BpcGVsaW5lX3N5bmMoc3RydWN0IGFtZGdwdV9yaW5nICpyaW5nLAogCQkJCSAgc3RydWN0
IGFtZGdwdV9qb2IgKmpvYik7CiB2b2lkIGFtZGdwdV92bV9jaGVja19jb21wdXRlX2J1ZyhzdHJ1
Y3QgYW1kZ3B1X2RldmljZSAqYWRldik7CiAKLXZvaWQgYW1kZ3B1X3ZtX2dldF90YXNrX2luZm8o
c3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHVuc2lnbmVkIGludCBwYXNpZCwKLQkJCSAgICAg
c3RydWN0IGFtZGdwdV90YXNrX2luZm8gKnRhc2tfaW5mbyk7CitzdHJ1Y3QgYW1kZ3B1X3ZtICph
bWRncHVfdm1fZ2V0X3Rhc2tfaW5mbyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKKwkJCQkJ
ICB1bnNpZ25lZCBpbnQgcGFzaWQsCisJCQkJCSAgc3RydWN0IGFtZGdwdV90YXNrX2luZm8gKnRh
c2tfaW5mbyk7CiAKIHZvaWQgYW1kZ3B1X3ZtX3NldF90YXNrX2luZm8oc3RydWN0IGFtZGdwdV92
bSAqdm0pOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjhf
MC5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvZ21jX3Y4XzAuYwppbmRleCA4YmYyYmEz
MTBmZDkuLjFhNTU4MjQwNWE4NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRn
cHUvZ21jX3Y4XzAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjhfMC5j
CkBAIC0xNDQ4LDkgKzE0NDgsMTAgQEAgc3RhdGljIGludCBnbWNfdjhfMF9wcm9jZXNzX2ludGVy
cnVwdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAogCWlmIChwcmludGtfcmF0ZWxpbWl0
KCkpIHsKIAkJc3RydWN0IGFtZGdwdV90YXNrX2luZm8gdGFza19pbmZvOworCQlzdHJ1Y3QgYW1k
Z3B1X3ZtICp2bTsKIAogCQltZW1zZXQoJnRhc2tfaW5mbywgMCwgc2l6ZW9mKHN0cnVjdCBhbWRn
cHVfdGFza19pbmZvKSk7Ci0JCWFtZGdwdV92bV9nZXRfdGFza19pbmZvKGFkZXYsIGVudHJ5LT5w
YXNpZCwgJnRhc2tfaW5mbyk7CisJCXZtID0gYW1kZ3B1X3ZtX2dldF90YXNrX2luZm8oYWRldiwg
ZW50cnktPnBhc2lkLCAmdGFza19pbmZvKTsKIAogCQlkZXZfZXJyKGFkZXYtPmRldiwgIkdQVSBm
YXVsdCBkZXRlY3RlZDogJWQgMHglMDh4IGZvciBwcm9jZXNzICVzIHBpZCAlZCB0aHJlYWQgJXMg
cGlkICVkXG4iLAogCQkJZW50cnktPnNyY19pZCwgZW50cnktPnNyY19kYXRhWzBdLCB0YXNrX2lu
Zm8ucHJvY2Vzc19uYW1lLApAQCAtMTQ2MSw2ICsxNDYyLDggQEAgc3RhdGljIGludCBnbWNfdjhf
MF9wcm9jZXNzX2ludGVycnVwdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRldiwKIAkJCXN0YXR1
cyk7CiAJCWdtY192OF8wX3ZtX2RlY29kZV9mYXVsdChhZGV2LCBzdGF0dXMsIGFkZHIsIG1jX2Ns
aWVudCwKIAkJCQkJIGVudHJ5LT5wYXNpZCk7CisJCWlmICh2bSkKKwkJCWFtZGdwdV92bV9kdW1w
X3B0ZShhZGV2LCB2bSwgYWRkcik7CiAJfQogCiAJdm1pZCA9IFJFR19HRVRfRklFTEQoc3RhdHVz
LCBWTV9DT05URVhUMV9QUk9URUNUSU9OX0ZBVUxUX1NUQVRVUywKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2Ft
ZGdwdS9nbWNfdjlfMC5jCmluZGV4IGJkNWQzNjk0NDQ4MS4uZjI3ZTg4YWY0MDE2IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9nbWNfdjlfMC5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2dtY192OV8wLmMKQEAgLTMzMSw5ICszMzEsMTAgQEAgc3RhdGlj
IGludCBnbWNfdjlfMF9wcm9jZXNzX2ludGVycnVwdChzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwKIAogCWlmIChwcmludGtfcmF0ZWxpbWl0KCkpIHsKIAkJc3RydWN0IGFtZGdwdV90YXNrX2lu
Zm8gdGFza19pbmZvOworCQlzdHJ1Y3QgYW1kZ3B1X3ZtICp2bTsKIAogCQltZW1zZXQoJnRhc2tf
aW5mbywgMCwgc2l6ZW9mKHN0cnVjdCBhbWRncHVfdGFza19pbmZvKSk7Ci0JCWFtZGdwdV92bV9n
ZXRfdGFza19pbmZvKGFkZXYsIGVudHJ5LT5wYXNpZCwgJnRhc2tfaW5mbyk7CisJCXZtID0gYW1k
Z3B1X3ZtX2dldF90YXNrX2luZm8oYWRldiwgZW50cnktPnBhc2lkLCAmdGFza19pbmZvKTsKIAog
CQlkZXZfZXJyKGFkZXYtPmRldiwKIAkJCSJbJXNdICVzIHBhZ2UgZmF1bHQgKHNyY19pZDoldSBy
aW5nOiV1IHZtaWQ6JXUgIgpAQCAtMzQ5LDYgKzM1MCw4IEBAIHN0YXRpYyBpbnQgZ21jX3Y5XzBf
cHJvY2Vzc19pbnRlcnJ1cHQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsCiAJCQlkZXZfZXJy
KGFkZXYtPmRldiwKIAkJCQkiVk1fTDJfUFJPVEVDVElPTl9GQVVMVF9TVEFUVVM6MHglMDhYXG4i
LAogCQkJCXN0YXR1cyk7CisJCWlmICh2bSkKKwkJCWFtZGdwdV92bV9kdW1wX3B0ZShhZGV2LCB2
bSwgYWRkcik7CiAJfQogCiAJcmV0dXJuIDA7Ci0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmFtZC1nZnggbWFpbGluZyBsaXN0CmFtZC1n
ZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vYW1kLWdmeA==
