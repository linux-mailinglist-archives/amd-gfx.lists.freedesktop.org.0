Return-Path: <amd-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+amd-gfx@lfdr.de
Delivered-To: lists+amd-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6C2A52F4599
	for <lists+amd-gfx@lfdr.de>; Wed, 13 Jan 2021 08:57:35 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7C0F689F07;
	Wed, 13 Jan 2021 07:57:33 +0000 (UTC)
X-Original-To: amd-gfx@lists.freedesktop.org
Delivered-To: amd-gfx@lists.freedesktop.org
Received: from mx1.molgen.mpg.de (mx3.molgen.mpg.de [141.14.17.11])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6821189F01
 for <amd-gfx@lists.freedesktop.org>; Wed, 13 Jan 2021 07:57:31 +0000 (UTC)
Received: from [192.168.0.6] (ip5f5aecd1.dynamic.kabel-deutschland.de
 [95.90.236.209])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested) (Authenticated sender: pmenzel)
 by mx.molgen.mpg.de (Postfix) with ESMTPSA id 4A99420225BD3;
 Wed, 13 Jan 2021 08:57:29 +0100 (CET)
Subject: Re: [PATCH] drm/amdgpu: change the fence ring wait timeout
To: Roy Sun <Roy.Sun@amd.com>
References: <20210113063612.31468-1-Roy.Sun@amd.com>
From: Paul Menzel <pmenzel@molgen.mpg.de>
Message-ID: <50eaa794-5405-1acd-e581-8dc1a7cf5de8@molgen.mpg.de>
Date: Wed, 13 Jan 2021 08:57:28 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101
 Thunderbird/78.6.0
MIME-Version: 1.0
In-Reply-To: <20210113063612.31468-1-Roy.Sun@amd.com>
Content-Language: en-US
X-BeenThere: amd-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Discussion list for AMD gfx <amd-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/amd-gfx>
List-Post: <mailto:amd-gfx@lists.freedesktop.org>
List-Help: <mailto:amd-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/amd-gfx>,
 <mailto:amd-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: amd-gfx@lists.freedesktop.org
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: amd-gfx-bounces@lists.freedesktop.org
Sender: "amd-gfx" <amd-gfx-bounces@lists.freedesktop.org>

RGVhciBSb3ksCgoKQW0gMTMuMDEuMjEgdW0gMDc6MzYgc2NocmllYiBSb3kgU3VuOgo+IFRoaXMg
Zml4IGJ1ZyB3aGVyZSB3aGVuIHRoZSBlbmdpbmUgaGFuZywgdGhlIGZlbmNlIHJpbmcgd2lsbCB3
YWl0IHdpdGhvdXQgcXVpdCBhbmQgY2F1c2Uga2VybmVsIGNyYXNoCgpQbGVhc2Ugd3JhcCBjb21t
aXQgbWVzc2FnZSBib2R5IGFmdGVyIDc1IGNoYXJhY3RlcnMuIChjaGVja3BhdGNoLnBsIApzaG91
bGQgaGF2ZSBzaG93biB5b3UgdGhhdC4pCgpTb21lIHR5cG9zOgoKMS4gIGZpeCplcyoKMi4gIGhh
bmcqcyoKMy4gIFBsZWFzZSBhZGQgYSBkb3QvcGVyaW9kIGF0IHRoZSBlbmQgb2Ygc2VudGVuY2Vz
LgoKSWYgdGhlcmUgaXMgYSBMaW51eCBrZXJuZWwgY3Jhc2gsIHBsZWFzZSBhZGQgdGhlIHRyYWNl
LgoKUGxlYXNlIGVsYWJvcmF0ZSBhbHNvLiBXaGVyZSBhbmQgd2h5IGRvZXMgdGhlIExpbnV4IGtl
cm5lbCBjcmFzaCwgYW5kIApob3cgZG9lcyB5b3VyIHBhdGNoIGZpeCB0aGlzLgoKSG93IGNhbiB0
aGUgYnVnIGJlIHJlcHJvZHVjZWQ/IE9uIHdoYXQgaGFyZHdhcmUgZGlkIHlvdSBzZWUgaXQ/Cgo+
IFNpZ25lZC1vZmYtYnk6IFJveSBTdW4gPFJveS5TdW5AYW1kLmNvbT4KPiAtLS0KPiAgIGRyaXZl
cnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9mZW5jZS5jIHwgNDggKysrKysrKysrKysrKysr
KysrKystLS0KPiAgIDEgZmlsZSBjaGFuZ2VkLCA0MyBpbnNlcnRpb25zKCspLCA1IGRlbGV0aW9u
cygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVf
ZmVuY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9mZW5jZS5jCj4gaW5k
ZXggNmIwYWVlZTYxYjhiLi43MzhlYTY1MDc3ZWEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2ZlbmNlLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGdwdS9hbWRncHVfZmVuY2UuYwo+IEBAIC00MSw2ICs0MSw4IEBACj4gICAjaW5jbHVkZSAi
YW1kZ3B1LmgiCj4gICAjaW5jbHVkZSAiYW1kZ3B1X3RyYWNlLmgiCj4gICAKPiArI2RlZmluZSBB
TURHUFVfRkVOQ0VfVElNRU9VVCAgbXNlY3NfdG9famlmZmllcygxMDAwKQo+ICsjZGVmaW5lIEFN
REdQVV9GRU5DRV9HRlhfWEdNSV9USU1FT1VUIG1zZWNzX3RvX2ppZmZpZXMoMjAwMCkKCldoZXJl
IGRpZCB5b3UgZ2V0IHRoZSB2YWx1ZXMgZnJvbSwgb3Igd2h5IGRpZCB5b3UgY2hvb3NlIHRoZW0u
Cgo+ICAgLyoKPiAgICAqIEZlbmNlcwo+ICAgICogRmVuY2VzIG1hcmsgYW4gZXZlbnQgaW4gdGhl
IEdQVXMgcGlwZWxpbmUgYW5kIGFyZSB1c2VkCj4gQEAgLTEwNCw2ICsxMDYsMzggQEAgc3RhdGlj
IHZvaWQgYW1kZ3B1X2ZlbmNlX3dyaXRlKHN0cnVjdCBhbWRncHVfcmluZyAqcmluZywgdTMyIHNl
cSkKPiAgIAkJKmRydi0+Y3B1X2FkZHIgPSBjcHVfdG9fbGUzMihzZXEpOwo+ICAgfQo+ICAgCj4g
Ky8qKgo+ICsgKiBhbWRncHVfZmVuY2Vfd2FpdF90aW1lb3V0IC0gZ2V0IHRoZSBmZW5jZSB3YWl0
IHRpbWVvdXQKPiArICoKPiArICogQHJpbmc6IHJpbmcgdGhlIGZlbmNlIGlzIGFzc29jaWF0ZWQg
d2l0aAo+ICsgKgo+ICsgKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgZmVuY2Ugd2FpdCB0aW1l
b3V0Lgo+ICsgKi8KPiArbG9uZyBhbWRncHVfZmVuY2Vfd2FpdF90aW1lb3V0KHN0cnVjdCBhbWRn
cHVfcmluZyAqcmluZykKClNlZSBiZWxvdywgYnV0IGl0IHNob3VsZCBiZSBgc2lnbmVkIGxvbmdg
LgoKPiArewo+ICsJbG9uZyB0bW9fZ2Z4LCB0bW9fbW0sIHRtbzsKPiArCXN0cnVjdCBhbWRncHVf
ZGV2aWNlICphZGV2ID0gcmluZy0+YWRldjsKPiArCXRtb19tbSA9IHRtb19nZnggPSBBTURHUFVf
RkVOQ0VfVElNRU9VVDsKPiArCWlmIChhbWRncHVfc3Jpb3ZfdmYoYWRldikpIHsKPiArCQl0bW9f
bW0gPSA4ICogQU1ER1BVX0ZFTkNFX1RJTUVPVVQ7Cj4gKwl9CgpTZWUgY29kaW5nIHN0eWxlLiBO
byB7fSBuZWVkZWQgZm9yIG9uZSBsaW5lIHN0YXRlbWVudHMuCgo+ICsJaWYgKGFtZGdwdV9zcmlv
dl9ydW50aW1lKGFkZXYpKSB7Cj4gKwkJdG1vX2dmeCA9IDggKiBBTURHUFVfRkVOQ0VfVElNRU9V
VDsKClNvIHdoeSBub3QgZGVmaW5lIGEgc3BlY2lhbCBTUklPViBtYWNybyB0b28uIEJ1dCBhZGQg
YSBjb21tZW50LCB3aHkgaXQgCnNob3VsZCBiZSBlaWdodCB0aW1lcyB0aGF0LgoKPiArCX0gZWxz
ZSBpZiAoYWRldi0+Z21jLnhnbWkuaGl2ZV9pZCkgewo+ICsJCXRtb19nZnggPSBBTURHUFVfRkVO
Q0VfR0ZYX1hHTUlfVElNRU9VVDsKPiArCX0KCkRpdHRvLgoKPiArCWlmIChyaW5nLT5mdW5jcy0+
dHlwZSA9PSBBTURHUFVfUklOR19UWVBFX1VWRCB8fAo+ICsJCXJpbmctPmZ1bmNzLT50eXBlID09
IEFNREdQVV9SSU5HX1RZUEVfVkNFIHx8Cj4gKwkJcmluZy0+ZnVuY3MtPnR5cGUgPT0gQU1ER1BV
X1JJTkdfVFlQRV9VVkRfRU5DIHx8Cj4gKwkJcmluZy0+ZnVuY3MtPnR5cGUgPT0gQU1ER1BVX1JJ
TkdfVFlQRV9WQ05fREVDIHx8Cj4gKwkJcmluZy0+ZnVuY3MtPnR5cGUgPT0gQU1ER1BVX1JJTkdf
VFlQRV9WQ05fRU5DIHx8Cj4gKwkJcmluZy0+ZnVuY3MtPnR5cGUgPT0gQU1ER1BVX1JJTkdfVFlQ
RV9WQ05fSlBFRykKCkFsaWduIG9uIGByaW5nYD8KCj4gKwkJdG1vID0gdG1vX21tOwo+ICsJZWxz
ZQo+ICsJCXRtbyA9IHRtb19nZng7Cj4gKwlyZXR1cm4gdG1vOwoKVGhlIHJldHVybiBjb3VsZCBo
YXBwZW4gaW4gdGhlIGJyYW5jaGVzLgoKPiArfQo+ICsKPiAgIC8qKgo+ICAgICogYW1kZ3B1X2Zl
bmNlX3JlYWQgLSByZWFkIGEgZmVuY2UgdmFsdWUKPiAgICAqCj4gQEAgLTE2NiwxMCArMjAwLDEy
IEBAIGludCBhbWRncHVfZmVuY2VfZW1pdChzdHJ1Y3QgYW1kZ3B1X3JpbmcgKnJpbmcsIHN0cnVj
dCBkbWFfZmVuY2UgKipmLAo+ICAgCQlyY3VfcmVhZF91bmxvY2soKTsKPiAgIAo+ICAgCQlpZiAo
b2xkKSB7Cj4gLQkJCXIgPSBkbWFfZmVuY2Vfd2FpdChvbGQsIGZhbHNlKTsKPiArCQkJbG9uZyB0
aW1lb3V0Owo+ICsJCQl0aW1lb3V0ID0gYW1kZ3B1X2ZlbmNlX3dhaXRfdGltZW91dChyaW5nKTsK
PiArCQkJciA9IGRtYV9mZW5jZV93YWl0X3RpbWVvdXQob2xkLCBmYWxzZSwgdGltZW91dCk7CgpU
aGUgc2lnbmF0dXJlIGlzIGBzaWduZWQgbG9uZ2AgYXMgZmFyIGFzIEkgc2VlLgoKPiAgIAkJCWRt
YV9mZW5jZV9wdXQob2xkKTsKPiAgIAkJCWlmIChyKQo+IC0JCQkJcmV0dXJuIHI7Cj4gKwkJCQly
ZXR1cm4gciA8IDAgPyByIDogMDsKPiAgIAkJfQo+ICAgCX0KPiAgIAo+IEBAIC0zNDMsMTAgKzM3
OSwxMiBAQCBpbnQgYW1kZ3B1X2ZlbmNlX3dhaXRfZW1wdHkoc3RydWN0IGFtZGdwdV9yaW5nICpy
aW5nKQo+ICAgCQlyZXR1cm4gMDsKPiAgIAl9Cj4gICAJcmN1X3JlYWRfdW5sb2NrKCk7Cj4gLQo+
IC0JciA9IGRtYV9mZW5jZV93YWl0KGZlbmNlLCBmYWxzZSk7Cj4gKwkKPiArCWxvbmcgdGltZW91
dDsKPiArCXRpbWVvdXQgPSBhbWRncHVfZmVuY2Vfd2FpdF90aW1lb3V0KHJpbmcpOwo+ICsJciA9
IGRtYV9mZW5jZV93YWl0X3RpbWVvdXQoZmVuY2UsIGZhbHNlLCB0aW1lb3V0KTsKPiAgIAlkbWFf
ZmVuY2VfcHV0KGZlbmNlKTsKPiAtCXJldHVybiByOwo+ICsJcmV0dXJuIHIgPCAwID8gciA6IDA7
Cj4gICB9Cj4gICAKPiAgIC8qKgo+IAoKSXQgbG9va3MgbGlrZSB0aGlzIGlzIHlvdXIgZmlyc3Qg
cGF0Y2ggc3VibWlzc2lvbiwgc28gd2VsY29tZSB0byB0aGUgCkxpbnV4IGtlcm5lbCBjb21tdW5p
dHkuIFBsZWFzZSBrZWVwIGluIG1pbmQsIHRoYXQgcmV2aWV3ZXIgdGltZSBpcyAKcHJlY2lvdXMg
YW5kIHNjYXJjZSwgYW5kIHRoYXQgZm9ybWFsIGFuZCBzaW1wbGUgbWlzdGFrZXMgc2hvdWxkIG5v
dCAKaGFwcGVuLiBObyBpZGVhLCBpZiBBTUQgaGFzIHNvbWUga2luZCBvZiDigJxvbmJvYXJkaW5n
4oCdIHByb2Nlc3MgZm9yIHRoZWlyIApuZXdseSBlbXBsb3llZCBMaW51eCBrZXJuZWwgY29udHJp
YnV0b3JzLgoKSSBhbSBsb29raW5nIGZvcndhcmQgdG8geW91ciB0aGUgcGF0Y2ggaXRlcmF0aW9u
IGFuZCB5b3VyIG5leHQgCmNvbnRyaWJ1dGlvbnMuCgoKS2luZCByZWdhcmRzLAoKUGF1bApfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwphbWQtZ2Z4IG1haWxp
bmcgbGlzdAphbWQtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2FtZC1nZngK
